(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const K_=!1,J_=(t,e)=>t===e,Do=Symbol("solid-proxy"),b1=typeof Proxy=="function",Ip=Symbol("solid-track"),uh={equals:J_};let _1=$1;const Oa=1,dh=2,w1={owned:null,cleanups:null,context:null,owner:null};var Qr=null;let Nf=null,Q_=null,fn=null,xi=null,Ts=null,Vh=0;function cu(t,e){const r=fn,n=Qr,i=t.length===0,o=e===void 0?n:e,s=i?w1:{owned:null,cleanups:null,context:o?o.context:null,owner:o},a=i?t:()=>t(()=>to(()=>xu(s)));Qr=s,fn=null;try{return Ba(a,!0)}finally{fn=r,Qr=n}}function $e(t,e){e=e?Object.assign({},uh,e):uh;const r={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},n=i=>(typeof i=="function"&&(i=i(r.value)),I1(r,i));return[C1.bind(r),n]}function we(t,e,r){const n=Im(t,e,!1,Oa);Vu(n)}function vo(t,e,r){_1=tw;const n=Im(t,e,!1,Oa);n.user=!0,Ts?Ts.push(n):Vu(n)}function Tt(t,e,r){r=r?Object.assign({},uh,r):uh;const n=Im(t,e,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=r.equals||void 0,Vu(n),C1.bind(n)}function S1(t){return Ba(t,!1)}function to(t){if(fn===null)return t();const e=fn;fn=null;try{return t()}finally{fn=e}}function xm(t,e,r){const n=Array.isArray(t);let i,o=r&&r.defer;return s=>{let a;if(n){a=Array(t.length);for(let u=0;u<t.length;u++)a[u]=t[u]()}else a=t();if(o)return o=!1,s;const c=to(()=>e(a,i,s));return i=a,c}}function Rn(t){vo(()=>to(t))}function Pc(t){return Qr===null||(Qr.cleanups===null?Qr.cleanups=[t]:Qr.cleanups.push(t)),t}function $p(){return fn}function P1(){return Qr}function x1(t,e){const r=Qr,n=fn;Qr=t,fn=null;try{return Ba(e,!0)}catch(i){$m(i)}finally{Qr=r,fn=n}}function X_(t){const e=fn,r=Qr;return Promise.resolve().then(()=>{fn=e,Qr=r;let n;return Ba(t,!1),fn=Qr=null,n?n.done:void 0})}const[tR,rR]=$e(!1);function A1(t,e){const r=Symbol("context");return{id:r,Provider:nw(r),defaultValue:t}}function Am(t){let e;return Qr&&Qr.context&&(e=Qr.context[t.id])!==void 0?e:t.defaultValue}function Cm(t){const e=Tt(t),r=Tt(()=>Ep(e()));return r.toArray=()=>{const n=r();return Array.isArray(n)?n:n!=null?[n]:[]},r}function C1(){if(this.sources&&this.state)if(this.state===Oa)Vu(this);else{const t=xi;xi=null,Ba(()=>fh(this),!1),xi=t}if(fn){const t=this.observers?this.observers.length:0;fn.sources?(fn.sources.push(this),fn.sourceSlots.push(t)):(fn.sources=[this],fn.sourceSlots=[t]),this.observers?(this.observers.push(fn),this.observerSlots.push(fn.sources.length-1)):(this.observers=[fn],this.observerSlots=[fn.sources.length-1])}return this.value}function I1(t,e,r){let n=t.value;return(!t.comparator||!t.comparator(n,e))&&(t.value=e,t.observers&&t.observers.length&&Ba(()=>{for(let i=0;i<t.observers.length;i+=1){const o=t.observers[i],s=Nf&&Nf.running;s&&Nf.disposed.has(o),(s?!o.tState:!o.state)&&(o.pure?xi.push(o):Ts.push(o),o.observers&&E1(o)),s||(o.state=Oa)}if(xi.length>1e6)throw xi=[],new Error},!1)),e}function Vu(t){if(!t.fn)return;xu(t);const e=Vh;Z_(t,t.value,e)}function Z_(t,e,r){let n;const i=Qr,o=fn;fn=Qr=t;try{n=t.fn(e)}catch(s){return t.pure&&(t.state=Oa,t.owned&&t.owned.forEach(xu),t.owned=null),t.updatedAt=r+1,$m(s)}finally{fn=o,Qr=i}(!t.updatedAt||t.updatedAt<=r)&&(t.updatedAt!=null&&"observers"in t?I1(t,n):t.value=n,t.updatedAt=r)}function Im(t,e,r,n=Oa,i){const o={fn:t,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:Qr,context:Qr?Qr.context:null,pure:r};return Qr===null||Qr!==w1&&(Qr.owned?Qr.owned.push(o):Qr.owned=[o]),o}function hh(t){if(t.state===0)return;if(t.state===dh)return fh(t);if(t.suspense&&to(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<Vh);)t.state&&e.push(t);for(let r=e.length-1;r>=0;r--)if(t=e[r],t.state===Oa)Vu(t);else if(t.state===dh){const n=xi;xi=null,Ba(()=>fh(t,e[0]),!1),xi=n}}function Ba(t,e){if(xi)return t();let r=!1;e||(xi=[]),Ts?r=!0:Ts=[],Vh++;try{const n=t();return ew(r),n}catch(n){r||(Ts=null),xi=null,$m(n)}}function ew(t){if(xi&&($1(xi),xi=null),t)return;const e=Ts;Ts=null,e.length&&Ba(()=>_1(e),!1)}function $1(t){for(let e=0;e<t.length;e++)hh(t[e])}function tw(t){let e,r=0;for(e=0;e<t.length;e++){const n=t[e];n.user?t[r++]=n:hh(n)}for(e=0;e<r;e++)hh(t[e])}function fh(t,e){t.state=0;for(let r=0;r<t.sources.length;r+=1){const n=t.sources[r];if(n.sources){const i=n.state;i===Oa?n!==e&&(!n.updatedAt||n.updatedAt<Vh)&&hh(n):i===dh&&fh(n,e)}}}function E1(t){for(let e=0;e<t.observers.length;e+=1){const r=t.observers[e];r.state||(r.state=dh,r.pure?xi.push(r):Ts.push(r),r.observers&&E1(r))}}function xu(t){let e;if(t.sources)for(;t.sources.length;){const r=t.sources.pop(),n=t.sourceSlots.pop(),i=r.observers;if(i&&i.length){const o=i.pop(),s=r.observerSlots.pop();n<i.length&&(o.sourceSlots[s]=n,i[n]=o,r.observerSlots[n]=s)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)xu(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)xu(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function rw(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function $m(t,e=Qr){throw rw(t)}function Ep(t){if(typeof t=="function"&&!t.length)return Ep(t());if(Array.isArray(t)){const e=[];for(let r=0;r<t.length;r++){const n=Ep(t[r]);Array.isArray(n)?e.push.apply(e,n):e.push(n)}return e}return t}function nw(t,e){return function(n){let i;return we(()=>i=to(()=>(Qr.context={...Qr.context,[t]:n.value},Cm(()=>n.children))),void 0),i}}const iw=Symbol("fallback");function pg(t){for(let e=0;e<t.length;e++)t[e]()}function ow(t,e,r={}){let n=[],i=[],o=[],s=0,a=e.length>1?[]:null;return Pc(()=>pg(o)),()=>{let c=t()||[],u=c.length,h,y;return c[Ip],to(()=>{let p,C,S,w,x,V,ne,X,Q;if(u===0)s!==0&&(pg(o),o=[],n=[],i=[],s=0,a&&(a=[])),r.fallback&&(n=[iw],i[0]=cu(ee=>(o[0]=ee,r.fallback())),s=1);else if(s===0){for(i=new Array(u),y=0;y<u;y++)n[y]=c[y],i[y]=cu(g);s=u}else{for(S=new Array(u),w=new Array(u),a&&(x=new Array(u)),V=0,ne=Math.min(s,u);V<ne&&n[V]===c[V];V++);for(ne=s-1,X=u-1;ne>=V&&X>=V&&n[ne]===c[X];ne--,X--)S[X]=i[ne],w[X]=o[ne],a&&(x[X]=a[ne]);for(p=new Map,C=new Array(X+1),y=X;y>=V;y--)Q=c[y],h=p.get(Q),C[y]=h===void 0?-1:h,p.set(Q,y);for(h=V;h<=ne;h++)Q=n[h],y=p.get(Q),y!==void 0&&y!==-1?(S[y]=i[h],w[y]=o[h],a&&(x[y]=a[h]),y=C[y],p.set(Q,y)):o[h]();for(y=V;y<u;y++)y in S?(i[y]=S[y],o[y]=w[y],a&&(a[y]=x[y],a[y](y))):i[y]=cu(g);i=i.slice(0,s=u),n=c.slice(0)}return i});function g(p){if(o[y]=p,a){const[C,S]=$e(y);return a[y]=S,e(c[y],C)}return e(c[y])}}}function B(t,e){return to(()=>t(e||{}))}function Ad(){return!0}const kp={get(t,e,r){return e===Do?r:t.get(e)},has(t,e){return e===Do?!0:t.has(e)},set:Ad,deleteProperty:Ad,getOwnPropertyDescriptor(t,e){return{configurable:!0,enumerable:!0,get(){return t.get(e)},set:Ad,deleteProperty:Ad}},ownKeys(t){return t.keys()}};function Lf(t){return(t=typeof t=="function"?t():t)?t:{}}function sw(){for(let t=0,e=this.length;t<e;++t){const r=this[t]();if(r!==void 0)return r}}function Tp(...t){let e=!1;for(let s=0;s<t.length;s++){const a=t[s];e=e||!!a&&Do in a,t[s]=typeof a=="function"?(e=!0,Tt(a)):a}if(b1&&e)return new Proxy({get(s){for(let a=t.length-1;a>=0;a--){const c=Lf(t[a])[s];if(c!==void 0)return c}},has(s){for(let a=t.length-1;a>=0;a--)if(s in Lf(t[a]))return!0;return!1},keys(){const s=[];for(let a=0;a<t.length;a++)s.push(...Object.keys(Lf(t[a])));return[...new Set(s)]}},kp);const r={},n=Object.create(null);for(let s=t.length-1;s>=0;s--){const a=t[s];if(!a)continue;const c=Object.getOwnPropertyNames(a);for(let u=c.length-1;u>=0;u--){const h=c[u];if(h==="__proto__"||h==="constructor")continue;const y=Object.getOwnPropertyDescriptor(a,h);if(!n[h])n[h]=y.get?{enumerable:!0,configurable:!0,get:sw.bind(r[h]=[y.get.bind(a)])}:y.value!==void 0?y:void 0;else{const g=r[h];g&&(y.get?g.push(y.get.bind(a)):y.value!==void 0&&g.push(()=>y.value))}}}const i={},o=Object.keys(n);for(let s=o.length-1;s>=0;s--){const a=o[s],c=n[a];c&&c.get?Object.defineProperty(i,a,c):i[a]=c?c.value:void 0}return i}function aw(t,...e){if(b1&&Do in t){const i=new Set(e.length>1?e.flat():e[0]),o=e.map(s=>new Proxy({get(a){return s.includes(a)?t[a]:void 0},has(a){return s.includes(a)&&a in t},keys(){return s.filter(a=>a in t)}},kp));return o.push(new Proxy({get(s){return i.has(s)?void 0:t[s]},has(s){return i.has(s)?!1:s in t},keys(){return Object.keys(t).filter(s=>!i.has(s))}},kp)),o}const r={},n=e.map(()=>({}));for(const i of Object.getOwnPropertyNames(t)){const o=Object.getOwnPropertyDescriptor(t,i),s=!o.get&&!o.set&&o.enumerable&&o.writable&&o.configurable;let a=!1,c=0;for(const u of e)u.includes(i)&&(a=!0,s?n[c][i]=o.value:Object.defineProperty(n[c],i,o)),++c;a||(s?r[i]=o.value:Object.defineProperty(r,i,o))}return[...n,r]}const lw=t=>`Stale read from <${t}>.`;function Ut(t){const e="fallback"in t&&{fallback:()=>t.fallback};return Tt(ow(()=>t.each,t.children,e||void 0))}function Ge(t){const e=t.keyed,r=Tt(()=>t.when,void 0,void 0),n=e?r:Tt(r,void 0,{equals:(i,o)=>!i==!o});return Tt(()=>{const i=n();if(i){const o=t.children;return typeof o=="function"&&o.length>0?to(()=>o(e?i:()=>{if(!to(n))throw lw("Show");return r()})):o}return t.fallback},void 0,void 0)}const cw=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],uw=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline",...cw]),dw=new Set(["innerHTML","textContent","innerText","children"]),hw=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),fw=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}});function pw(t,e){const r=fw[t];return typeof r=="object"?r[e]?r.$:void 0:r}const mw=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),Te=t=>Tt(()=>t());function yw(t,e,r){let n=r.length,i=e.length,o=n,s=0,a=0,c=e[i-1].nextSibling,u=null;for(;s<i||a<o;){if(e[s]===r[a]){s++,a++;continue}for(;e[i-1]===r[o-1];)i--,o--;if(i===s){const h=o<n?a?r[a-1].nextSibling:r[o-a]:c;for(;a<o;)t.insertBefore(r[a++],h)}else if(o===a)for(;s<i;)(!u||!u.has(e[s]))&&e[s].remove(),s++;else if(e[s]===r[o-1]&&r[a]===e[i-1]){const h=e[--i].nextSibling;t.insertBefore(r[a++],e[s++].nextSibling),t.insertBefore(r[--o],h),e[i]=r[o]}else{if(!u){u=new Map;let y=a;for(;y<o;)u.set(r[y],y++)}const h=u.get(e[s]);if(h!=null)if(a<h&&h<o){let y=s,g=1,p;for(;++y<i&&y<o&&!((p=u.get(e[y]))==null||p!==h+g);)g++;if(g>h-a){const C=e[s];for(;a<h;)t.insertBefore(r[a++],C)}else t.replaceChild(r[a++],e[s++])}else s++;else e[s++].remove()}}}const mg="_$DX_DELEGATE";function gw(t,e,r,n={}){let i;return cu(o=>{i=o,e===document?t():l(e,t(),e.firstChild?null:void 0,r)},n.owner),()=>{i(),e.textContent=""}}function de(t,e,r,n){let i;const o=()=>{const a=n?document.createElementNS("http://www.w3.org/1998/Math/MathML","template"):document.createElement("template");return a.innerHTML=t,r?a.content.firstChild.firstChild:n?a.firstChild:a.content.firstChild},s=e?()=>to(()=>document.importNode(i||(i=o()),!0)):()=>(i||(i=o())).cloneNode(!0);return s.cloneNode=s,s}function dr(t,e=window.document){const r=e[mg]||(e[mg]=new Set);for(let n=0,i=t.length;n<i;n++){const o=t[n];r.has(o)||(r.add(o),e.addEventListener(o,xw))}}function Yt(t,e,r){r==null?t.removeAttribute(e):t.setAttribute(e,r)}function vw(t,e,r){r?t.setAttribute(e,""):t.removeAttribute(e)}function Em(t,e){e==null?t.removeAttribute("class"):t.className=e}function as(t,e,r,n){if(n)Array.isArray(r)?(t[`$$${e}`]=r[0],t[`$$${e}Data`]=r[1]):t[`$$${e}`]=r;else if(Array.isArray(r)){const i=r[0];t.addEventListener(e,r[0]=o=>i.call(t,r[1],o))}else t.addEventListener(e,r,typeof r!="function"&&r)}function bw(t,e,r={}){const n=Object.keys(e||{}),i=Object.keys(r);let o,s;for(o=0,s=i.length;o<s;o++){const a=i[o];!a||a==="undefined"||e[a]||(yg(t,a,!1),delete r[a])}for(o=0,s=n.length;o<s;o++){const a=n[o],c=!!e[a];!a||a==="undefined"||r[a]===c||!c||(yg(t,a,!0),r[a]=c)}return r}function m(t,e,r){if(!e)return r?Yt(t,"style"):e;const n=t.style;if(typeof e=="string")return n.cssText=e;typeof r=="string"&&(n.cssText=r=void 0),r||(r={}),e||(e={});let i,o;for(o in r)e[o]==null&&n.removeProperty(o),delete r[o];for(o in e)i=e[o],i!==r[o]&&(n.setProperty(o,i),r[o]=i);return r}function _w(t,e={},r,n){const i={};return we(()=>i.children=Au(t,e.children,i.children)),we(()=>typeof e.ref=="function"&&ww(e.ref,t)),we(()=>Sw(t,e,r,!0,i,!0)),i}function ww(t,e,r){return to(()=>t(e,r))}function l(t,e,r,n){if(r!==void 0&&!n&&(n=[]),typeof e!="function")return Au(t,e,n,r);we(i=>Au(t,e(),i,r),n)}function Sw(t,e,r,n,i={},o=!1){e||(e={});for(const s in i)if(!(s in e)){if(s==="children")continue;i[s]=gg(t,s,null,i[s],r,o,e)}for(const s in e){if(s==="children")continue;const a=e[s];i[s]=gg(t,s,a,i[s],r,o,e)}}function Pw(t){return t.toLowerCase().replace(/-([a-z])/g,(e,r)=>r.toUpperCase())}function yg(t,e,r){const n=e.trim().split(/\s+/);for(let i=0,o=n.length;i<o;i++)t.classList.toggle(n[i],r)}function gg(t,e,r,n,i,o,s){let a,c,u,h,y;if(e==="style")return m(t,r,n);if(e==="classList")return bw(t,r,n);if(r===n)return n;if(e==="ref")o||r(t);else if(e.slice(0,3)==="on:"){const g=e.slice(3);n&&t.removeEventListener(g,n,typeof n!="function"&&n),r&&t.addEventListener(g,r,typeof r!="function"&&r)}else if(e.slice(0,10)==="oncapture:"){const g=e.slice(10);n&&t.removeEventListener(g,n,!0),r&&t.addEventListener(g,r,!0)}else if(e.slice(0,2)==="on"){const g=e.slice(2).toLowerCase(),p=mw.has(g);if(!p&&n){const C=Array.isArray(n)?n[0]:n;t.removeEventListener(g,C)}(p||r)&&(as(t,g,r,p),p&&dr([g]))}else e.slice(0,5)==="attr:"?Yt(t,e.slice(5),r):e.slice(0,5)==="bool:"?vw(t,e.slice(5),r):(y=e.slice(0,5)==="prop:")||(u=dw.has(e))||(h=pw(e,t.tagName))||(c=uw.has(e))||(a=t.nodeName.includes("-")||"is"in s)?(y&&(e=e.slice(5),c=!0),e==="class"||e==="className"?Em(t,r):a&&!c&&!u?t[Pw(e)]=r:t[h||e]=r):Yt(t,hw[e]||e,r);return r}function xw(t){let e=t.target;const r=`$$${t.type}`,n=t.target,i=t.currentTarget,o=c=>Object.defineProperty(t,"target",{configurable:!0,value:c}),s=()=>{const c=e[r];if(c&&!e.disabled){const u=e[`${r}Data`];if(u!==void 0?c.call(e,u,t):c.call(e,t),t.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(t.target)&&o(e.host),!0},a=()=>{for(;s()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return e||document}}),t.composedPath){const c=t.composedPath();o(c[0]);for(let u=0;u<c.length-2&&(e=c[u],!!s());u++){if(e._$host){e=e._$host,a();break}if(e.parentNode===i)break}}else a();o(n)}function Au(t,e,r,n,i){for(;typeof r=="function";)r=r();if(e===r)return r;const o=typeof e,s=n!==void 0;if(t=s&&r[0]&&r[0].parentNode||t,o==="string"||o==="number"){if(o==="number"&&(e=e.toString(),e===r))return r;if(s){let a=r[0];a&&a.nodeType===3?a.data!==e&&(a.data=e):a=document.createTextNode(e),r=Yl(t,r,n,a)}else r!==""&&typeof r=="string"?r=t.firstChild.data=e:r=t.textContent=e}else if(e==null||o==="boolean")r=Yl(t,r,n);else{if(o==="function")return we(()=>{let a=e();for(;typeof a=="function";)a=a();r=Au(t,a,r,n)}),()=>r;if(Array.isArray(e)){const a=[],c=r&&Array.isArray(r);if(Np(a,e,r,i))return we(()=>r=Au(t,a,r,n,!0)),()=>r;if(a.length===0){if(r=Yl(t,r,n),s)return r}else c?r.length===0?vg(t,a,n):yw(t,r,a):(r&&Yl(t),vg(t,a));r=a}else if(e.nodeType){if(Array.isArray(r)){if(s)return r=Yl(t,r,n,e);Yl(t,r,null,e)}else r==null||r===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);r=e}}return r}function Np(t,e,r,n){let i=!1;for(let o=0,s=e.length;o<s;o++){let a=e[o],c=r&&r[t.length],u;if(!(a==null||a===!0||a===!1))if((u=typeof a)=="object"&&a.nodeType)t.push(a);else if(Array.isArray(a))i=Np(t,a,c)||i;else if(u==="function")if(n){for(;typeof a=="function";)a=a();i=Np(t,Array.isArray(a)?a:[a],Array.isArray(c)?c:[c])||i}else t.push(a),i=!0;else{const h=String(a);c&&c.nodeType===3&&c.data===h?t.push(c):t.push(document.createTextNode(h))}}return i}function vg(t,e,r=null){for(let n=0,i=e.length;n<i;n++)t.insertBefore(e[n],r)}function Yl(t,e,r,n){if(r===void 0)return t.textContent="";const i=n||document.createTextNode("");if(e.length){let o=!1;for(let s=e.length-1;s>=0;s--){const a=e[s];if(i!==a){const c=a.parentNode===t;!o&&!s?c?t.replaceChild(i,a):t.insertBefore(i,r):c&&a.remove()}else o=!0}}else t.insertBefore(i,r);return[i]}const Aw=!1;function k1(){let t=new Set;function e(i){return t.add(i),()=>t.delete(i)}let r=!1;function n(i,o){if(r)return!(r=!1);const s={to:i,options:o,defaultPrevented:!1,preventDefault:()=>s.defaultPrevented=!0};for(const a of t)a.listener({...s,from:a.location,retry:c=>{c&&(r=!0),a.navigate(i,{...o,resolve:!1})}});return!s.defaultPrevented}return{subscribe:e,confirm:n}}let Lp;function km(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),Lp=window.history.state._depth}km();function Cw(t){return{...t,_depth:window.history.state&&window.history.state._depth}}function Iw(t,e){let r=!1;return()=>{const n=Lp;km();const i=n==null?null:Lp-n;if(r){r=!1;return}i&&e(i)?(r=!0,window.history.go(-i)):t()}}const $w=/^(?:[a-z0-9]+:)?\/\//i,Ew=/^\/+|(\/)\/+$/g,T1="http://sr";function yl(t,e=!1){const r=t.replace(Ew,"$1");return r?e||/^[?#]/.test(r)?r:"/"+r:""}function Kd(t,e,r){if($w.test(e))return;const n=yl(t),i=r&&yl(r);let o="";return!i||e.startsWith("/")?o=n:i.toLowerCase().indexOf(n.toLowerCase())!==0?o=n+i:o=i,(o||"/")+yl(e,!o)}function kw(t,e){if(t==null)throw new Error(e);return t}function Tw(t,e){return yl(t).replace(/\/*(\*.*)?$/g,"")+yl(e)}function N1(t){const e={};return t.searchParams.forEach((r,n)=>{n in e?Array.isArray(e[n])?e[n].push(r):e[n]=[e[n],r]:e[n]=r}),e}function Nw(t,e,r){const[n,i]=t.split("/*",2),o=n.split("/").filter(Boolean),s=o.length;return a=>{const c=a.split("/").filter(Boolean),u=c.length-s;if(u<0||u>0&&i===void 0&&!e)return null;const h={path:s?"":"/",params:{}},y=g=>r===void 0?void 0:r[g];for(let g=0;g<s;g++){const p=o[g],C=p[0]===":",S=C?c[g]:c[g].toLowerCase(),w=C?p.slice(1):p.toLowerCase();if(C&&Df(S,y(w)))h.params[w]=S;else if(C||!Df(S,w))return null;h.path+=`/${S}`}if(i){const g=u?c.slice(-u).join("/"):"";if(Df(g,y(i)))h.params[i]=g;else return null}return h}}function Df(t,e){const r=n=>n===t;return e===void 0?!0:typeof e=="string"?r(e):typeof e=="function"?e(t):Array.isArray(e)?e.some(r):e instanceof RegExp?e.test(t):!1}function Lw(t){const[e,r]=t.pattern.split("/*",2),n=e.split("/").filter(Boolean);return n.reduce((i,o)=>i+(o.startsWith(":")?2:3),n.length-(r===void 0?0:1))}function L1(t){const e=new Map,r=P1();return new Proxy({},{get(n,i){return e.has(i)||x1(r,()=>e.set(i,Tt(()=>t()[i]))),e.get(i)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(t())}})}function D1(t){let e=/(\/?\:[^\/]+)\?/.exec(t);if(!e)return[t];let r=t.slice(0,e.index),n=t.slice(e.index+e[0].length);const i=[r,r+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(n);)i.push(r+=e[1]),n=n.slice(e[0].length);return D1(n).reduce((o,s)=>[...o,...i.map(a=>a+s)],[])}const Dw=100,R1=A1(),Tm=A1(),qu=()=>kw(Am(R1),"<A> and 'use' router primitives can be only used inside a Route."),Rw=()=>Am(Tm)||qu().base,Mw=t=>{const e=Rw();return Tt(()=>e.resolvePath(t()))},Fw=t=>{const e=qu();return Tt(()=>{const r=t();return r!==void 0?e.renderPath(r):r})},Nm=()=>qu().navigatorFactory(),Ow=()=>qu().location,Bw=()=>qu().params;function jw(t,e=""){const{component:r,preload:n,load:i,children:o,info:s}=t,a=!o||Array.isArray(o)&&!o.length,c={key:t,component:r,preload:n||i,info:s};return M1(t.path).reduce((u,h)=>{for(const y of D1(h)){const g=Tw(e,y);let p=a?g:g.split("/*",1)[0];p=p.split("/").map(C=>C.startsWith(":")||C.startsWith("*")?C:encodeURIComponent(C)).join("/"),u.push({...c,originalPath:h,pattern:p,matcher:Nw(p,!a,t.matchFilters)})}return u},[])}function Vw(t,e=0){return{routes:t,score:Lw(t[t.length-1])*1e4-e,matcher(r){const n=[];for(let i=t.length-1;i>=0;i--){const o=t[i],s=o.matcher(r);if(!s)return null;n.unshift({...s,route:o})}return n}}}function M1(t){return Array.isArray(t)?t:[t]}function F1(t,e="",r=[],n=[]){const i=M1(t);for(let o=0,s=i.length;o<s;o++){const a=i[o];if(a&&typeof a=="object"){a.hasOwnProperty("path")||(a.path="");const c=jw(a,e);for(const u of c){r.push(u);const h=Array.isArray(a.children)&&a.children.length===0;if(a.children&&!h)F1(a.children,u.pattern,r,n);else{const y=Vw([...r],n.length);n.push(y)}r.pop()}}}return r.length?n:n.sort((o,s)=>s.score-o.score)}function Rf(t,e){for(let r=0,n=t.length;r<n;r++){const i=t[r].matcher(e);if(i)return i}return[]}function qw(t,e,r){const n=new URL(T1),i=Tt(h=>{const y=t();try{return new URL(y,n)}catch{return console.error(`Invalid path ${y}`),h}},n,{equals:(h,y)=>h.href===y.href}),o=Tt(()=>i().pathname),s=Tt(()=>i().search,!0),a=Tt(()=>i().hash),c=()=>"",u=xm(s,()=>N1(i()));return{get pathname(){return o()},get search(){return s()},get hash(){return a()},get state(){return e()},get key(){return c()},query:r?r(u):L1(u)}}let ll;function zw(){return ll}function Uw(t,e,r,n={}){const{signal:[i,o],utils:s={}}=t,a=s.parsePath||(G=>G),c=s.renderPath||(G=>G),u=s.beforeLeave||k1(),h=Kd("",n.base||"");if(h===void 0)throw new Error(`${h} is not a valid base path`);h&&!i().value&&o({value:h,replace:!0,scroll:!1});const[y,g]=$e(!1);let p;const C=(G,ie)=>{ie.value===S()&&ie.state===x()||(p===void 0&&g(!0),ll=G,p=ie,X_(()=>{p===ie&&(w(p.value),V(p.state),Q[1](F=>F.filter(W=>W.pending)))}).finally(()=>{p===ie&&S1(()=>{ll=void 0,G==="navigate"&&I(p),g(!1),p=void 0})}))},[S,w]=$e(i().value),[x,V]=$e(i().state),ne=qw(S,x,s.queryWrapper),X=[],Q=$e([]),ee=Tt(()=>typeof n.transformUrl=="function"?Rf(e(),n.transformUrl(ne.pathname)):Rf(e(),ne.pathname)),E=()=>{const G=ee(),ie={};for(let F=0;F<G.length;F++)Object.assign(ie,G[F].params);return ie},A=s.paramsWrapper?s.paramsWrapper(E,e):L1(E),T={pattern:h,path:()=>h,outlet:()=>null,resolvePath(G){return Kd(h,G)}};return we(xm(i,G=>C("native",G),{defer:!0})),{base:T,location:ne,params:A,isRouting:y,renderPath:c,parsePath:a,navigatorFactory:_,matches:ee,beforeLeave:u,preloadRoute:b,singleFlight:n.singleFlight===void 0?!0:n.singleFlight,submissions:Q};function R(G,ie,F){to(()=>{if(typeof ie=="number"){ie&&(s.go?s.go(ie):console.warn("Router integration does not support relative routing"));return}const W=!ie||ie[0]==="?",{replace:z,resolve:O,scroll:k,state:re}={replace:!1,resolve:!W,scroll:!0,...F},$=O?G.resolvePath(ie):Kd(W&&ne.pathname||"",ie);if($===void 0)throw new Error(`Path '${ie}' is not a routable path`);if(X.length>=Dw)throw new Error("Too many redirects");const D=S();($!==D||re!==x())&&(Aw||u.confirm($,F)&&(X.push({value:D,replace:z,scroll:k,state:x()}),C("navigate",{value:$,state:re})))})}function _(G){return G=G||Am(Tm)||T,(ie,F)=>R(G,ie,F)}function I(G){const ie=X[0];ie&&(o({...G,replace:ie.replace,scroll:ie.scroll}),X.length=0)}function b(G,ie){const F=Rf(e(),G.pathname),W=ll;ll="preload";for(let z in F){const{route:O,params:k}=F[z];O.component&&O.component.preload&&O.component.preload();const{preload:re}=O;ie&&re&&x1(r(),()=>re({params:k,location:{pathname:G.pathname,search:G.search,hash:G.hash,query:N1(G),state:null,key:""},intent:"preload"}))}ll=W}}function Hw(t,e,r,n){const{base:i,location:o,params:s}=t,{pattern:a,component:c,preload:u}=n().route,h=Tt(()=>n().path);c&&c.preload&&c.preload();const y=u?u({params:s,location:o,intent:ll||"initial"}):void 0;return{parent:e,pattern:a,path:h,outlet:()=>c?B(c,{params:s,location:o,data:y,get children(){return r()}}):r(),resolvePath(p){return Kd(i.path(),p,h())}}}const Ww=t=>e=>{const{base:r}=e,n=Cm(()=>e.children),i=Tt(()=>F1(n(),e.base||""));let o;const s=Uw(t,i,()=>o,{base:r,singleFlight:e.singleFlight,transformUrl:e.transformUrl});return t.create&&t.create(s),B(R1.Provider,{value:s,get children(){return B(Gw,{routerState:s,get root(){return e.root},get preload(){return e.rootPreload||e.rootLoad},get children(){return[Te(()=>(o=P1())&&null),B(Yw,{routerState:s,get branches(){return i()}})]}})}})};function Gw(t){const e=t.routerState.location,r=t.routerState.params,n=Tt(()=>t.preload&&to(()=>{t.preload({params:r,location:e,intent:zw()||"initial"})}));return B(Ge,{get when(){return t.root},keyed:!0,get fallback(){return t.children},children:i=>B(i,{params:r,location:e,get data(){return n()},get children(){return t.children}})})}function Yw(t){const e=[];let r;const n=Tt(xm(t.routerState.matches,(i,o,s)=>{let a=o&&i.length===o.length;const c=[];for(let u=0,h=i.length;u<h;u++){const y=o&&o[u],g=i[u];s&&y&&g.route.key===y.route.key?c[u]=s[u]:(a=!1,e[u]&&e[u](),cu(p=>{e[u]=p,c[u]=Hw(t.routerState,c[u-1]||t.routerState.base,bg(()=>n()[u+1]),()=>t.routerState.matches()[u])}))}return e.splice(i.length).forEach(u=>u()),s&&a?s:(r=c[0],c)}));return bg(()=>n()&&r)()}const bg=t=>()=>B(Ge,{get when(){return t()},keyed:!0,children:e=>B(Tm.Provider,{value:e,get children(){return e.outlet()}})}),fo=t=>{const e=Cm(()=>t.children);return Tp(t,{get children(){return e()}})};function Kw([t,e],r,n){return[t,n?i=>e(n(i)):e]}function Jw(t){let e=!1;const r=i=>typeof i=="string"?{value:i}:i,n=Kw($e(r(t.get()),{equals:(i,o)=>i.value===o.value&&i.state===o.state}),void 0,i=>(!e&&t.set(i),i));return t.init&&Pc(t.init((i=t.get())=>{e=!0,n[1](r(i)),e=!1})),Ww({signal:n,create:t.create,utils:t.utils})}function Qw(t,e,r){return t.addEventListener(e,r),()=>t.removeEventListener(e,r)}function Xw(t,e){const r=t&&document.getElementById(t);r?r.scrollIntoView():e&&window.scrollTo(0,0)}const Zw=new Map;function eS(t=!0,e=!1,r="/_server",n){return i=>{const o=i.base.path(),s=i.navigatorFactory(i.base);let a,c;function u(S){return S.namespaceURI==="http://www.w3.org/2000/svg"}function h(S){if(S.defaultPrevented||S.button!==0||S.metaKey||S.altKey||S.ctrlKey||S.shiftKey)return;const w=S.composedPath().find(ee=>ee instanceof Node&&ee.nodeName.toUpperCase()==="A");if(!w||e&&!w.hasAttribute("link"))return;const x=u(w),V=x?w.href.baseVal:w.href;if((x?w.target.baseVal:w.target)||!V&&!w.hasAttribute("state"))return;const X=(w.getAttribute("rel")||"").split(/\s+/);if(w.hasAttribute("download")||X&&X.includes("external"))return;const Q=x?new URL(V,document.baseURI):new URL(V);if(!(Q.origin!==window.location.origin||o&&Q.pathname&&!Q.pathname.toLowerCase().startsWith(o.toLowerCase())))return[w,Q]}function y(S){const w=h(S);if(!w)return;const[x,V]=w,ne=i.parsePath(V.pathname+V.search+V.hash),X=x.getAttribute("state");S.preventDefault(),s(ne,{resolve:!1,replace:x.hasAttribute("replace"),scroll:!x.hasAttribute("noscroll"),state:X?JSON.parse(X):void 0})}function g(S){const w=h(S);if(!w)return;const[x,V]=w;i.preloadRoute(V,x.getAttribute("preload")!=="false")}function p(S){clearTimeout(a);const w=h(S);if(!w)return c=null;const[x,V]=w;c!==x&&(a=setTimeout(()=>{i.preloadRoute(V,x.getAttribute("preload")!=="false"),c=x},20))}function C(S){if(S.defaultPrevented)return;let w=S.submitter&&S.submitter.hasAttribute("formaction")?S.submitter.getAttribute("formaction"):S.target.getAttribute("action");if(!w)return;if(!w.startsWith("https://action/")){const V=new URL(w,T1);if(w=i.parsePath(V.pathname+V.search),!w.startsWith(r))return}if(S.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const x=Zw.get(w);if(x){S.preventDefault();const V=new FormData(S.target,S.submitter);x.call({r:i,f:S.target},S.target.enctype==="multipart/form-data"?V:new URLSearchParams(V))}}dr(["click","submit"]),document.addEventListener("click",y),t&&(document.addEventListener("mousemove",p,{passive:!0}),document.addEventListener("focusin",g,{passive:!0}),document.addEventListener("touchstart",g,{passive:!0})),document.addEventListener("submit",C),Pc(()=>{document.removeEventListener("click",y),t&&(document.removeEventListener("mousemove",p),document.removeEventListener("focusin",g),document.removeEventListener("touchstart",g)),document.removeEventListener("submit",C)})}}function tS(t){const e=t.replace(/^.*?#/,"");if(!e.startsWith("/")){const[,r="/"]=window.location.hash.split("#",2);return`${r}#${e}`}return e}function rS(t){const e=()=>window.location.hash.slice(1),r=k1();return Jw({get:e,set({value:n,replace:i,scroll:o,state:s}){i?window.history.replaceState(Cw(s),"","#"+n):window.history.pushState(s,"","#"+n);const a=n.indexOf("#"),c=a>=0?n.slice(a+1):"";Xw(c,o),km()},init:n=>Qw(window,"hashchange",Iw(n,i=>!r.confirm(i&&i<0?i:e()))),create:eS(t.preload,t.explicitLinks,t.actionBase),utils:{go:n=>window.history.go(n),renderPath:n=>`#${n}`,parsePath:tS,beforeLeave:r}})(t)}var nS=de("<a>");function tc(t){t=Tp({inactiveClass:"inactive",activeClass:"active"},t);const[,e]=aw(t,["href","state","class","activeClass","inactiveClass","end"]),r=Mw(()=>t.href),n=Fw(r),i=Ow(),o=Tt(()=>{const s=r();if(s===void 0)return[!1,!1];const a=yl(s.split(/[?#]/,1)[0]).toLowerCase(),c=decodeURI(yl(i.pathname).toLowerCase());return[t.end?a===c:c.startsWith(a+"/")||c===a,a===c]});return(()=>{var s=nS();return _w(s,Tp(e,{get href(){return n()||t.href},get state(){return JSON.stringify(t.state)},get classList(){return{...t.class&&{[t.class]:!0},[t.inactiveClass]:!o()[0],[t.activeClass]:o()[0],...e.classList}},link:"",get"aria-current"(){return o()[1]?"page":void 0}}),!1),s})()}const Dp=Symbol("store-raw"),lc=Symbol("store-node"),Cs=Symbol("store-has"),O1=Symbol("store-self");function B1(t){let e=t[Do];if(!e&&(Object.defineProperty(t,Do,{value:e=new Proxy(t,sS)}),!Array.isArray(t))){const r=Object.keys(t),n=Object.getOwnPropertyDescriptors(t);for(let i=0,o=r.length;i<o;i++){const s=r[i];n[s].get&&Object.defineProperty(t,s,{enumerable:n[s].enumerable,get:n[s].get.bind(e)})}}return e}function ph(t){let e;return t!=null&&typeof t=="object"&&(t[Do]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function Cu(t,e=new Set){let r,n,i,o;if(r=t!=null&&t[Dp])return r;if(!ph(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let s=0,a=t.length;s<a;s++)i=t[s],(n=Cu(i,e))!==i&&(t[s]=n)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const s=Object.keys(t),a=Object.getOwnPropertyDescriptors(t);for(let c=0,u=s.length;c<u;c++)o=s[c],!a[o].get&&(i=t[o],(n=Cu(i,e))!==i&&(t[o]=n))}return t}function mh(t,e){let r=t[e];return r||Object.defineProperty(t,e,{value:r=Object.create(null)}),r}function Iu(t,e,r){if(t[e])return t[e];const[n,i]=$e(r,{equals:!1,internal:!0});return n.$=i,t[e]=n}function iS(t,e){const r=Reflect.getOwnPropertyDescriptor(t,e);return!r||r.get||!r.configurable||e===Do||e===lc||(delete r.value,delete r.writable,r.get=()=>t[Do][e]),r}function j1(t){$p()&&Iu(mh(t,lc),O1)()}function oS(t){return j1(t),Reflect.ownKeys(t)}const sS={get(t,e,r){if(e===Dp)return t;if(e===Do)return r;if(e===Ip)return j1(t),r;const n=mh(t,lc),i=n[e];let o=i?i():t[e];if(e===lc||e===Cs||e==="__proto__")return o;if(!i){const s=Object.getOwnPropertyDescriptor(t,e);$p()&&(typeof o!="function"||t.hasOwnProperty(e))&&!(s&&s.get)&&(o=Iu(n,e,o)())}return ph(o)?B1(o):o},has(t,e){return e===Dp||e===Do||e===Ip||e===lc||e===Cs||e==="__proto__"?!0:($p()&&Iu(mh(t,Cs),e)(),e in t)},set(){return!0},deleteProperty(){return!0},ownKeys:oS,getOwnPropertyDescriptor:iS};function yh(t,e,r,n=!1){if(!n&&t[e]===r)return;const i=t[e],o=t.length;r===void 0?(delete t[e],t[Cs]&&t[Cs][e]&&i!==void 0&&t[Cs][e].$()):(t[e]=r,t[Cs]&&t[Cs][e]&&i===void 0&&t[Cs][e].$());let s=mh(t,lc),a;if((a=Iu(s,e,i))&&a.$(()=>r),Array.isArray(t)&&t.length!==o){for(let c=t.length;c<o;c++)(a=s[c])&&a.$();(a=Iu(s,"length",o))&&a.$(t.length)}(a=s[O1])&&a.$()}function V1(t,e){const r=Object.keys(e);for(let n=0;n<r.length;n+=1){const i=r[n];yh(t,i,e[i])}}function aS(t,e){if(typeof e=="function"&&(e=e(t)),e=Cu(e),Array.isArray(e)){if(t===e)return;let r=0,n=e.length;for(;r<n;r++){const i=e[r];t[r]!==i&&yh(t,r,i)}yh(t,"length",n)}else V1(t,e)}function ru(t,e,r=[]){let n,i=t;if(e.length>1){n=e.shift();const s=typeof n,a=Array.isArray(t);if(Array.isArray(n)){for(let c=0;c<n.length;c++)ru(t,[n[c]].concat(e),r);return}else if(a&&s==="function"){for(let c=0;c<t.length;c++)n(t[c],c)&&ru(t,[c].concat(e),r);return}else if(a&&s==="object"){const{from:c=0,to:u=t.length-1,by:h=1}=n;for(let y=c;y<=u;y+=h)ru(t,[y].concat(e),r);return}else if(e.length>1){ru(t[n],e,[n].concat(r));return}i=t[n],r=[n].concat(r)}let o=e[0];typeof o=="function"&&(o=o(i,r),o===i)||n===void 0&&o==null||(o=Cu(o),n===void 0||ph(i)&&ph(o)&&!Array.isArray(o)?V1(i,o):yh(t,n,o))}function qh(...[t,e]){const r=Cu(t||{}),n=Array.isArray(r),i=B1(r);function o(...s){S1(()=>{n&&s.length===1?aS(r,s[0]):ru(r,s)})}return[i,o]}const Jr=(t=300+Math.random()*700)=>new Promise(e=>setTimeout(e,t)),tl=(t="")=>`${t}${Date.now()}-${Math.random().toString(36).substr(2,9)}`;let Ft={products:[{id:"prod-001",name:"Wireless Headphones",sku:"WH-001",productCode:"WH-001",productName:"Wireless Headphones",description:"High-quality wireless bluetooth headphones",category:"Electronics",unitOfMeasure:"pcs",unitCost:45,sellingPrice:89.99,minStockLevel:10,maxStockLevel:100,isActive:!0,createdDate:"2024-01-15T10:00:00Z",lastModified:"2024-01-15T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-002",name:"USB-C Cable",sku:"USB-001",description:"3ft USB-C charging cable",category:"Accessories",unitOfMeasure:"pcs",unitCost:8.5,sellingPrice:19.99,minStockLevel:25,maxStockLevel:200,isActive:!0,createdDate:"2024-01-16T10:00:00Z",lastModified:"2024-01-16T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-003",name:"Laptop Stand",sku:"LS-001",description:"Adjustable aluminum laptop stand",category:"Office",unitOfMeasure:"pcs",unitCost:25,sellingPrice:49.99,minStockLevel:5,maxStockLevel:50,isActive:!0,createdDate:"2024-01-17T10:00:00Z",lastModified:"2024-01-17T10:00:00Z",businessId:"YB100423253156428"}],locations:[{id:"loc-001",name:"Main Warehouse",code:"WH-001",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-002",name:"Retail Store - Downtown",code:"ST-001",type:"store",address:"456 Main St, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-003",name:"Retail Store - Mall",code:"ST-002",type:"store",address:"789 Mall Blvd, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"}],movements:[{id:"mov-001",productId:"prod-001",productName:"Wireless Headphones",productSku:"WH-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:50,unitCost:45,totalCost:2250,referenceNumber:"PO-001",notes:"Initial stock purchase",createdBy:"admin",createdDate:"2024-01-15T10:00:00Z",invoiceId:"INV-1000001"},{id:"mov-002",productId:"prod-002",productName:"USB-C Cable",productSku:"USB-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:100,unitCost:8.5,totalCost:850,referenceNumber:"PO-001",notes:"Bulk purchase",createdBy:"admin",createdDate:"2024-01-15T10:05:00Z",invoiceId:"INV-1000001"}],accounts:[{id:"acc-001",accountNumber:"1000",accountName:"Cash",accountType:"asset",category:"currentAssets",balance:5e4,parentAccountId:null,description:"Cash and cash equivalents",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"},{id:"acc-002",accountNumber:"1100",accountName:"Accounts Receivable",accountType:"asset",category:"currentAssets",balance:25e3,parentAccountId:null,description:"Money owed by customers",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"}],journalEntries:[{id:"je-001",entryNumber:"JE-001",date:"2024-01-15",description:"Initial cash deposit",reference:"DEP-001",status:"posted",createdBy:"admin",createdAt:"2024-01-15T10:00:00Z",postedAt:"2024-01-15T10:05:00Z",lines:[{id:"jel-001",accountId:"acc-001",accountName:"Cash",description:"Initial deposit",debitAmount:5e4,creditAmount:0},{id:"jel-002",accountId:"acc-003",accountName:"Owner Equity",description:"Initial capital",debitAmount:0,creditAmount:5e4}]}]};const On=(t=.05)=>Math.random()<t,Bn=()=>{const t=["Network timeout","Connection refused","Server temporarily unavailable","Invalid request"];throw new Error(t[Math.floor(Math.random()*t.length)])},li={products:{async getAll(t,e){await Jr(),On()&&Bn();let r=[...Ft.products];if(t&&t.trim()){const n=t.toLowerCase();r=r.filter(i=>i.name.toLowerCase().includes(n)||i.sku.toLowerCase().includes(n)||i.category.toLowerCase().includes(n)||i.description.toLowerCase().includes(n))}return e?.category&&(r=r.filter(n=>n.category===e.category)),e?.isActive!==void 0&&(r=r.filter(n=>n.isActive===e.isActive)),r},async getById(t){return await Jr(),On()&&Bn(),Ft.products.find(e=>e.id===t)||null},async create(t){if(await Jr(),On()&&Bn(),Ft.products.some(r=>r.sku===t.sku))throw new Error("SKU already exists");const e={...t,id:tl("prod-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return Ft.products.push(e),e},async update(t,e){await Jr(),On()&&Bn();const r=Ft.products.findIndex(i=>i.id===t);if(r===-1)throw new Error("Product not found");if(e.sku&&Ft.products.some(i=>i.id!==t&&i.sku===e.sku))throw new Error("SKU already exists");const n={...Ft.products[r],...e,lastModified:new Date().toISOString()};return Ft.products[r]=n,n},async delete(t){await Jr(),On()&&Bn();const e=Ft.products.findIndex(n=>n.id===t);if(e===-1)throw new Error("Product not found");return Ft.movements.some(n=>n.productId===t)?{success:!1,message:"Cannot delete product with existing movements"}:(Ft.products.splice(e,1),{success:!0,message:"Product deleted successfully"})}},locations:{async getAll(t){await Jr(),On()&&Bn();let e=[...Ft.locations];return t?.type&&(e=e.filter(r=>r.type===t.type)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await Jr(),Ft.locations.find(e=>e.id===t)||null},async create(t){if(await Jr(),On()&&Bn(),Ft.locations.some(r=>r.code===t.code))throw new Error("Location code already exists");const e={...t,id:tl("loc-"),createdDate:new Date().toISOString()};return Ft.locations.push(e),e},async update(t,e){await Jr(),On()&&Bn();const r=Ft.locations.findIndex(n=>n.id===t);if(r===-1)throw new Error("Location not found");if(e.code&&Ft.locations.some(n=>n.id!==t&&n.code===e.code))throw new Error("Location code already exists");return Ft.locations[r]={...Ft.locations[r],...e},Ft.locations[r]}},movements:{async getAll(t){await Jr(),On()&&Bn();let e=[...Ft.movements];if(t?.productId&&(e=e.filter(r=>r.productId===t.productId)),t?.locationId&&(e=e.filter(r=>r.locationId===t.locationId)),t?.movementType&&(e=e.filter(r=>r.movementType===t.movementType)),t?.dateFrom&&(e=e.filter(r=>r.createdDate>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.createdDate<=t.dateTo)),t?.search){const r=t.search.toLowerCase();e=e.filter(n=>n.productName.toLowerCase().includes(r)||n.productSku.toLowerCase().includes(r)||n.referenceNumber.toLowerCase().includes(r)||n.notes.toLowerCase().includes(r))}return e.sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime()),e},async getById(t){return await Jr(),Ft.movements.find(e=>e.id===t)||null},async create(t){if(await Jr(),On()&&Bn(),!Ft.products.find(i=>i.id===t.productId))throw new Error("Product not found");if(!Ft.locations.find(i=>i.id===t.locationId))throw new Error("Location not found");if(t.movementType==="out"){const i=await this.getStockLevel(t.productId,t.locationId);if(i<t.quantity)throw new Error(`Insufficient stock. Available: ${i}, Requested: ${t.quantity}`)}const n={...t,id:tl("mov-"),createdDate:new Date().toISOString()};return Ft.movements.push(n),n},async update(t,e){await Jr(),On()&&Bn();const r=Ft.movements.findIndex(i=>i.id===t);if(r===-1)throw new Error("Movement not found");const n={...Ft.movements[r],...e,lastModified:new Date().toISOString()};return Ft.movements[r]=n,n},async delete(t){await Jr(),On()&&Bn();const e=Ft.movements.findIndex(r=>r.id===t);if(e===-1)throw new Error("Movement not found");return Ft.movements.splice(e,1),{success:!0,message:"Movement deleted successfully"}},async createBulk(t){await Jr(),On()&&Bn();const e=[],r=[],n=new Date().toISOString(),i=Ft.locations.find(o=>o.id===t.locationId);if(!i)return{success:!1,movements:[],errors:["Invalid location"]};for(let o=0;o<t.items.length;o++){const s=t.items[o],a=Ft.products.find(h=>h.id===s.productId);if(!a){e.push(`Item ${o+1}: Product not found`);continue}if(s.quantity<=0){e.push(`Item ${o+1}: Quantity must be greater than 0`);continue}if(t.movementType==="out"){const h=await this.getStockLevel(s.productId,t.locationId);if(s.quantity>h){e.push(`Item ${o+1}: Insufficient stock. Available: ${h}, Requested: ${s.quantity}`);continue}}const c=s.unitCost||a.unitCost,u={id:tl("mov-"),productId:a.id,productName:a.name,productSku:a.sku,locationId:t.locationId,locationName:i.name,movementType:t.movementType,quantity:s.quantity,unitCost:c,totalCost:s.quantity*c,referenceNumber:t.referenceNumber,notes:s.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:t.fromLocationId?Ft.locations.find(h=>h.id===t.fromLocationId)?.name:void 0};r.push(u)}return e.length>0?{success:!1,movements:[],errors:e}:(Ft.movements.push(...r),{success:!0,movements:r,errors:[]})},async getStockLevel(t,e){return await Jr(50),Ft.movements.filter(r=>r.productId===t&&r.locationId===e).reduce((r,n)=>{switch(n.movementType){case"in":case"adjustment":return r+n.quantity;case"out":return r-n.quantity;case"transfer":return n.locationId===e?r+n.quantity:r;default:return r}},0)},async getStockLevels(){await Jr();const t=new Map;for(const e of Ft.movements){const r=`${e.productId}-${e.locationId}`;let n=t.get(r);switch(n||(n={id:r,productId:e.productId,locationId:e.locationId,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType){case"in":case"adjustment":n.quantity+=e.quantity;break;case"out":n.quantity-=e.quantity;break;case"transfer":e.locationId===e.locationId&&(n.quantity+=e.quantity);break}new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost,n.availableQuantity=n.quantity-n.reservedQuantity}return Array.from(t.values())}},accounts:{async getAll(t){await Jr(),On()&&Bn();let e=[...Ft.accounts];return t?.accountType&&(e=e.filter(r=>r.accountType===t.accountType)),t?.category&&(e=e.filter(r=>r.category===t.category)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await Jr(),Ft.accounts.find(e=>e.id===t)||null},async create(t){if(await Jr(),On()&&Bn(),Ft.accounts.some(r=>r.accountNumber===t.accountNumber))throw new Error("Account number already exists");const e={...t,id:tl("acc-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return Ft.accounts.push(e),e},async update(t,e){await Jr(),On()&&Bn();const r=Ft.accounts.findIndex(n=>n.id===t);if(r===-1)throw new Error("Account not found");if(e.accountNumber&&Ft.accounts.some(n=>n.id!==t&&n.accountNumber===e.accountNumber))throw new Error("Account number already exists");return Ft.accounts[r]={...Ft.accounts[r],...e,lastModified:new Date().toISOString()},Ft.accounts[r]}},journal:{async getAll(t){await Jr(),On()&&Bn();let e=[...Ft.journalEntries];return t?.status&&(e=e.filter(r=>r.status===t.status)),t?.accountId&&(e=e.filter(r=>r.lines.some(n=>n.accountId===t.accountId))),t?.dateFrom&&(e=e.filter(r=>r.date>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.date<=t.dateTo)),e.sort((r,n)=>new Date(n.createdAt).getTime()-new Date(r.createdAt).getTime())},async getById(t){return await Jr(),Ft.journalEntries.find(e=>e.id===t)||null},async create(t){await Jr(),On()&&Bn();const e=t.lines.reduce((a,c)=>a+(c.debitAmount||0),0),r=t.lines.reduce((a,c)=>a+(c.creditAmount||0),0);if(Math.abs(e-r)>.01)throw new Error(`Entry is not balanced. Debit: ${e}, Credit: ${r}`);const n=Ft.journalEntries.sort((a,c)=>c.entryNumber.localeCompare(a.entryNumber))[0],o=`JE-${((n?parseInt(n.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`,s={...t,id:tl("je-"),entryNumber:o,createdAt:new Date().toISOString(),lines:t.lines.map(a=>({...a,id:tl("jel-")}))};return Ft.journalEntries.push(s),s},async update(t,e){await Jr(),On()&&Bn();const r=Ft.journalEntries.findIndex(n=>n.id===t);if(r===-1)throw new Error("Journal entry not found");if(Ft.journalEntries[r].status==="posted")throw new Error("Cannot modify posted entries");return Ft.journalEntries[r]={...Ft.journalEntries[r],...e},Ft.journalEntries[r]},async post(t){await Jr(),On()&&Bn();const e=Ft.journalEntries.findIndex(o=>o.id===t);if(e===-1)throw new Error("Journal entry not found");const r=Ft.journalEntries[e];if(r.status==="posted")throw new Error("Entry is already posted");const n=r.lines.reduce((o,s)=>o+(s.debitAmount||0),0),i=r.lines.reduce((o,s)=>o+(s.creditAmount||0),0);if(Math.abs(n-i)>.01)throw new Error("Entry must be balanced before posting");return Ft.journalEntries[e]={...r,status:"posted",postedAt:new Date().toISOString()},r.lines.forEach(o=>{const s=Ft.accounts.findIndex(a=>a.id===o.accountId);if(s!==-1){const a=Ft.accounts[s],c=o.debitAmount||0,u=o.creditAmount||0;["asset","expense"].includes(a.accountType)?a.balance+=c-u:a.balance+=u-c}}),Ft.journalEntries[e]}},utils:{async getNextEntryNumber(){await Jr(100);const t=Ft.journalEntries.sort((r,n)=>n.entryNumber.localeCompare(r.entryNumber))[0];return`JE-${((t?parseInt(t.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`},async getNextProductCode(t){await Jr(100);const e=t.toUpperCase().slice(0,3),r=Ft.products.filter(i=>i.productCode?.startsWith(e)).sort((i,o)=>(o.productCode||"").localeCompare(i.productCode||""));if(r.length===0)return`${e}001`;const n=parseInt(r[0].productCode?.slice(-3)||"0");return`${e}${(n+1).toString().padStart(3,"0")}`},async healthCheck(){return await Jr(50),{status:"healthy",timestamp:new Date().toISOString(),version:"1.0.0"}},async resetDatabase(){return await Jr(200),Ft={products:[...Ft.products.slice(0,3)],locations:[...Ft.locations.slice(0,3)],movements:[...Ft.movements.slice(0,2)],accounts:[...Ft.accounts.slice(0,2)],journalEntries:[...Ft.journalEntries.slice(0,1)]},{success:!0,message:"Database reset to initial state"}},async getStats(){return await Jr(100),{products:Ft.products.length,locations:Ft.locations.length,movements:Ft.movements.length,accounts:Ft.accounts.length,journalEntries:Ft.journalEntries.length,totalStockValue:Ft.movements.reduce((t,e)=>e.movementType==="in"?t+e.totalCost:e.movementType==="out"?t-e.totalCost:t,0)}}}},Lm=t=>t===null||typeof t!="object"?t:t instanceof Date?new Date(t.getTime()):Array.isArray(t)?t.map(e=>Lm(e)):JSON.parse(JSON.stringify(t)),Dm=(t=16)=>{const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},_g=(t=16)=>{const e="123456789";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},lS=(t=4)=>{const e="0123456789BCDFGKSY";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},uu=t=>typeof t=="string"&&t.trim().length>0,qi=async t=>{const n=await fetch("https://qvamarkets.com/gql_api",{method:"POST",headers:{"Content-Type":"application/json","Accept-Encoding":"gzip, deflate, br",Authorization:"eyJhbGciOiJSUzI1NiIsImtpZCI6IjhlOGZjOGU1NTZmN2E3NmQwOGQzNTgyOWQ2ZjkwYWUyZTEyY2ZkMGQiLCJ0eXAiOiJKV1QifQ"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const i=await n.json();if(i.errors)throw new Error(i.errors[0]?.message||"GraphQL error");return console.log(JSON.stringify(t)),console.log(i),i.data},cS=t=>({ENTRY:"in",in:"in",TRANSFER:"transfer",transfer:"transfer",SALES:"out",out:"out",adjustment:"adjustment"})[t],Rp=t=>({ENTRY:"ENTRY",in:"ENTRY",TRANSFER:"TRANSFER",transfer:"TRANSFER",SALES:"SALES",out:"SALES",adjustment:"adjustment"})[t];function Mp(t){var e=[];return t&&Object.keys(t).map(r=>{e.push(t[r])}),e}function uS(t){if(!/^[a-z0-9+/]+={0,2}$/i.test(t)||t.length%4!=0)throw Error("Not base64 string");for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r,n,i,o,s,a,c,u,h=[],y=0;y<t.length;y+=4)o=e.indexOf(t.charAt(y)),s=e.indexOf(t.charAt(y+1)),a=e.indexOf(t.charAt(y+2)),c=e.indexOf(t.charAt(y+3)),u=o<<18|s<<12|a<<6|c,r=u>>>16&255,n=u>>>8&255,i=u&255,h[y/4]=String.fromCharCode(r,n,i),c==64&&(h[y/4]=String.fromCharCode(r,n)),a==64&&(h[y/4]=String.fromCharCode(r));return t=h.join(""),t}const dS=async()=>({}),hS=()=>(typeof window<"u"&&localStorage.getItem("hrmfinance-api-mode"),"real");let cl=hS();const $u={getMode(){return cl},setMode(t){cl=t,typeof window<"u"&&localStorage.setItem("hrmfinance-api-mode",t)},isFakeMode(){return cl==="fake"},isRealMode(){return cl==="real"},isHybridMode(){return cl==="hybrid"}},Pi=async(t,e,r=!0)=>{if(cl==="fake")return e();if(cl==="real")return t();try{return await t()}catch(n){if(console.warn("Real API failed, falling back to fake server:",n),r)return e();throw n}},wg={async getAll(t,e){const r=await qi({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:{businessId:"YB100423253156428",":search0":"produ"}});return Mp(r)},async getById(t){return Pi(async()=>(await this.getAll()).find(r=>r.id===t)||null,()=>li.products.getById(t))},async create(t){return Pi(async()=>{throw console.log("Creating product via real API:",t),new Error("Real API not implemented yet")},()=>li.products.create(t))},async update(t,e){return Pi(async()=>{throw console.log("Updating product via real API:",t,e),new Error("Real API not implemented yet")},()=>li.products.update(t,e))},async delete(t){return Pi(async()=>{throw console.log("Deleting product via real API:",t),new Error("Real API not implemented yet")},()=>li.products.delete(t))}},Ai={async getInventory(t,e){if(!(t&&t?.trim()))return[];let r={businessId:"YB100423253156428"};return t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())}),await qi({query:"getScanYabaInventory",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async getProducts(t){if(!(t&&t?.trim()))return[];let e={businessId:"YB100423253156428"};return t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())}),await qi({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async getConsigee(t){if(!(t&&t?.trim()))return[];let e={businessId:"all"};return t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())}),await qi({query:"getScanConsigneeYabaExpress",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async getShipper(t){if(!(t&&t?.trim()))return[];let e={businessId:"all"};return t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())}),await qi({query:"getScanShipperYabaExpress",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async getInvoice(t,e){if(!(t&&t?.trim()))return[];let r={businessId:"YB100423253156428"};t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())});let n={query:"getScanYabaSalesOrders",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r};const i=await qi(n);return console.log(n),console.log(i),i},async addInventory(t){return await qi({query:"addYabaInventory",params:{businessId:"YB100423253156428"},form:t})},async updInventory(t){return await dS()},async addInvoice(t){return await qi({query:"addYabaSalesOrders",params:{businessId:"YB100423253156428"},form:t})},async getHBLS(t,e){if(!(t&&t?.trim()))return[];let r={businessId:"YB100423253156428"};e?.search,e?.guia&&e.guia!=="all"&&(r.guia=e.guia),t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())});let n={query:"getScanYabaHbls",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4 AND guia = guia",params:r};console.log(n);const i=await qi(n);return console.log(n),console.log(i),i}},Rm={async getAll(t){return Ai.getInventory("ref")},async getById(t){return Pi(async()=>{throw console.log("Getting movement by ID via real API:",t),new Error("Real API not implemented yet")},()=>li.movements.getById(t))},async create(t){return Pi(async()=>{throw console.log("Creating movement via real API:",t),new Error("Real API not implemented yet")},()=>li.movements.create(t))},async update(t,e){return Pi(async()=>{throw console.log("Updating movement via real API:",t,e),new Error("Real API not implemented yet")},()=>li.movements.update(t,e))},async createBulk(t){return Pi(async()=>{throw console.log("Creating bulk movements via real API:",t),new Error("Real API not implemented yet")},()=>li.movements.createBulk(t))},async getStockLevels(t){return await qi({query:"calculateInventoryStock",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:t})},async calcStockLevels(){return[]}},Sg={async getAll(t){return Pi(async()=>{throw console.log("Getting accounts via real API:",t),new Error("Real API not implemented yet")},()=>li.accounts.getAll(t))},async getById(t){return Pi(async()=>{throw console.log("Getting account by ID via real API:",t),new Error("Real API not implemented yet")},()=>li.accounts.getById(t))},async create(t){return Pi(async()=>{throw console.log("Creating account via real API:",t),new Error("Real API not implemented yet")},()=>li.accounts.create(t))},async update(t,e){return Pi(async()=>{throw console.log("Updating account via real API:",t,e),new Error("Real API not implemented yet")},()=>li.accounts.update(t,e))}},Pg={async getNextEntryNumber(){return Pi(async()=>{throw console.log("Getting next entry number via real API"),new Error("Real API not implemented yet")},()=>li.utils.getNextEntryNumber())},async getNextProductCode(t){return Pi(async()=>{throw console.log("Getting next product code via real API:",t),new Error("Real API not implemented yet")},()=>li.utils.getNextProductCode(t))},async healthCheck(){return Pi(async()=>{const t=await fetch("/api/health");if(!t.ok)throw new Error("Health check failed");return t.json()},()=>li.utils.healthCheck())},async getStats(){return Pi(async()=>{throw console.log("Getting stats via real API"),new Error("Real API not implemented yet")},()=>li.utils.getStats())}},fS=()=>{$u.setMode("real"),console.log(" HRM Finance initialized in REAL API mode for production")};fS();const pS=()=>{};var xg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q1=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},mS=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[r++];e[n++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=t[r++],s=t[r++],a=t[r++],c=((i&7)<<18|(o&63)<<12|(s&63)<<6|a&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const o=t[r++],s=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(o&63)<<6|s&63)}}return e.join("")},z1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const o=t[i],s=i+1<t.length,a=s?t[i+1]:0,c=i+2<t.length,u=c?t[i+2]:0,h=o>>2,y=(o&3)<<4|a>>4;let g=(a&15)<<2|u>>6,p=u&63;c||(p=64,s||(g=64)),n.push(r[h],r[y],r[g],r[p])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(q1(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):mS(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const o=r[t.charAt(i++)],a=i<t.length?r[t.charAt(i)]:0;++i;const u=i<t.length?r[t.charAt(i)]:64;++i;const y=i<t.length?r[t.charAt(i)]:64;if(++i,o==null||a==null||u==null||y==null)throw new yS;const g=o<<2|a>>4;if(n.push(g),u!==64){const p=a<<4&240|u>>2;if(n.push(p),y!==64){const C=u<<6&192|y;n.push(C)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class yS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const gS=function(t){const e=q1(t);return z1.encodeByteArray(e,!0)},gh=function(t){return gS(t).replace(/\./g,"")},U1=function(t){try{return z1.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bS=()=>vS().__FIREBASE_DEFAULTS__,_S=()=>{if(typeof process>"u"||typeof xg>"u")return;const t=xg.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},wS=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&U1(t[1]);return e&&JSON.parse(e)},zh=()=>{try{return pS()||bS()||_S()||wS()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},H1=t=>zh()?.emulatorHosts?.[t],SS=t=>{const e=H1(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},W1=()=>zh()?.config,G1=t=>zh()?.[`_${t}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PS{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xc(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Y1(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xS(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...t};return[gh(JSON.stringify(r)),gh(JSON.stringify(s)),""].join(".")}const du={};function AS(){const t={prod:[],emulator:[]};for(const e of Object.keys(du))du[e]?t.emulator.push(e):t.prod.push(e);return t}function CS(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let Ag=!1;function K1(t,e){if(typeof window>"u"||typeof document>"u"||!xc(window.location.host)||du[t]===e||du[t]||Ag)return;du[t]=e;function r(g){return`__firebase__banner__${g}`}const n="__firebase__banner",o=AS().prod.length>0;function s(){const g=document.getElementById(n);g&&g.remove()}function a(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function c(g,p){g.setAttribute("width","24"),g.setAttribute("id",p),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function u(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{Ag=!0,s()},g}function h(g,p){g.setAttribute("id",p),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function y(){const g=CS(n),p=r("text"),C=document.getElementById(p)||document.createElement("span"),S=r("learnmore"),w=document.getElementById(S)||document.createElement("a"),x=r("preprendIcon"),V=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const ne=g.element;a(ne),h(w,S);const X=u();c(V,x),ne.append(V,C,w,X),document.body.appendChild(ne)}o?(C.innerText="Preview backend disconnected.",V.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(V.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,C.innerText="Preview backend running in this workspace."),C.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ci(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function IS(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ci())}function $S(){const t=zh()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ES(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function kS(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function TS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function NS(){const t=Ci();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function LS(){return!$S()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function DS(){try{return typeof indexedDB=="object"}catch{return!1}}function RS(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MS="FirebaseError";class Bs extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=MS,Object.setPrototypeOf(this,Bs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,zu.prototype.create)}}class zu{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,o=this.errors[e],s=o?FS(o,n):"Error",a=`${this.serviceName}: ${s} (${i}).`;return new Bs(i,a,n)}}function FS(t,e){return t.replace(OS,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const OS=/\{\$([^}]+)}/g;function BS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Sl(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const o=t[i],s=e[i];if(Cg(o)&&Cg(s)){if(!Sl(o,s))return!1}else if(o!==s)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function Cg(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uu(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function jS(t,e){const r=new VS(t,e);return r.subscribe.bind(r)}class VS{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");qS(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=Mf),i.error===void 0&&(i.error=Mf),i.complete===void 0&&(i.complete=Mf);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function qS(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Mf(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ui(t){return t&&t._delegate?t._delegate:t}class Pl{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zS{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new PS;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(HS(e))try{this.getOrInitializeService({instanceIdentifier:sl})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:i});n.resolve(o)}catch{}}}}clearInstance(e=sl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=sl){return this.instances.has(e)}getOptions(e=sl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[o,s]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(o);n===a&&s.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const o=this.instances.get(n);return o&&e(o,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:US(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=sl){return this.component?this.component.multipleInstances?e:sl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function US(t){return t===sl?void 0:t}function HS(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new zS(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dr;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Dr||(Dr={}));const GS={debug:Dr.DEBUG,verbose:Dr.VERBOSE,info:Dr.INFO,warn:Dr.WARN,error:Dr.ERROR,silent:Dr.SILENT},YS=Dr.INFO,KS={[Dr.DEBUG]:"log",[Dr.VERBOSE]:"log",[Dr.INFO]:"info",[Dr.WARN]:"warn",[Dr.ERROR]:"error"},JS=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=KS[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Mm{constructor(e){this.name=e,this._logLevel=YS,this._logHandler=JS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Dr))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?GS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Dr.DEBUG,...e),this._logHandler(this,Dr.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Dr.VERBOSE,...e),this._logHandler(this,Dr.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Dr.INFO,...e),this._logHandler(this,Dr.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Dr.WARN,...e),this._logHandler(this,Dr.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Dr.ERROR,...e),this._logHandler(this,Dr.ERROR,...e)}}const QS=(t,e)=>e.some(r=>t instanceof r);let Ig,$g;function XS(){return Ig||(Ig=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ZS(){return $g||($g=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const J1=new WeakMap,Fp=new WeakMap,Q1=new WeakMap,Ff=new WeakMap,Fm=new WeakMap;function eP(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",s)},o=()=>{r(Pa(t.result)),i()},s=()=>{n(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",s)});return e.then(r=>{r instanceof IDBCursor&&J1.set(r,t)}).catch(()=>{}),Fm.set(e,t),e}function tP(t){if(Fp.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",s),t.removeEventListener("abort",s)},o=()=>{r(),i()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",s),t.addEventListener("abort",s)});Fp.set(t,e)}let Op={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Fp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Q1.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Pa(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function rP(t){Op=t(Op)}function nP(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Of(this),e,...r);return Q1.set(n,e.sort?e.sort():[e]),Pa(n)}:ZS().includes(t)?function(...e){return t.apply(Of(this),e),Pa(J1.get(this))}:function(...e){return Pa(t.apply(Of(this),e))}}function iP(t){return typeof t=="function"?nP(t):(t instanceof IDBTransaction&&tP(t),QS(t,XS())?new Proxy(t,Op):t)}function Pa(t){if(t instanceof IDBRequest)return eP(t);if(Ff.has(t))return Ff.get(t);const e=iP(t);return e!==t&&(Ff.set(t,e),Fm.set(e,t)),e}const Of=t=>Fm.get(t);function oP(t,e,{blocked:r,upgrade:n,blocking:i,terminated:o}={}){const s=indexedDB.open(t,e),a=Pa(s);return n&&s.addEventListener("upgradeneeded",c=>{n(Pa(s.result),c.oldVersion,c.newVersion,Pa(s.transaction),c)}),r&&s.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),a.then(c=>{o&&c.addEventListener("close",()=>o()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const sP=["get","getKey","getAll","getAllKeys","count"],aP=["put","add","delete","clear"],Bf=new Map;function Eg(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Bf.get(e))return Bf.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=aP.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||sP.includes(r)))return;const o=async function(s,...a){const c=this.transaction(s,i?"readwrite":"readonly");let u=c.store;return n&&(u=u.index(a.shift())),(await Promise.all([u[r](...a),i&&c.done]))[0]};return Bf.set(e,o),o}rP(t=>({...t,get:(e,r,n)=>Eg(e,r)||t.get(e,r,n),has:(e,r)=>!!Eg(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lP{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(cP(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function cP(t){return t.getComponent()?.type==="VERSION"}const Bp="@firebase/app",kg="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ls=new Mm("@firebase/app"),uP="@firebase/app-compat",dP="@firebase/analytics-compat",hP="@firebase/analytics",fP="@firebase/app-check-compat",pP="@firebase/app-check",mP="@firebase/auth",yP="@firebase/auth-compat",gP="@firebase/database",vP="@firebase/data-connect",bP="@firebase/database-compat",_P="@firebase/functions",wP="@firebase/functions-compat",SP="@firebase/installations",PP="@firebase/installations-compat",xP="@firebase/messaging",AP="@firebase/messaging-compat",CP="@firebase/performance",IP="@firebase/performance-compat",$P="@firebase/remote-config",EP="@firebase/remote-config-compat",kP="@firebase/storage",TP="@firebase/storage-compat",NP="@firebase/firestore",LP="@firebase/ai",DP="@firebase/firestore-compat",RP="firebase",MP="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jp="[DEFAULT]",FP={[Bp]:"fire-core",[uP]:"fire-core-compat",[hP]:"fire-analytics",[dP]:"fire-analytics-compat",[pP]:"fire-app-check",[fP]:"fire-app-check-compat",[mP]:"fire-auth",[yP]:"fire-auth-compat",[gP]:"fire-rtdb",[vP]:"fire-data-connect",[bP]:"fire-rtdb-compat",[_P]:"fire-fn",[wP]:"fire-fn-compat",[SP]:"fire-iid",[PP]:"fire-iid-compat",[xP]:"fire-fcm",[AP]:"fire-fcm-compat",[CP]:"fire-perf",[IP]:"fire-perf-compat",[$P]:"fire-rc",[EP]:"fire-rc-compat",[kP]:"fire-gcs",[TP]:"fire-gcs-compat",[NP]:"fire-fst",[DP]:"fire-fst-compat",[LP]:"fire-vertex","fire-js":"fire-js",[RP]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vh=new Map,OP=new Map,Vp=new Map;function Tg(t,e){try{t.container.addComponent(e)}catch(r){Ls.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function mc(t){const e=t.name;if(Vp.has(e))return Ls.debug(`There were multiple attempts to register component ${e}.`),!1;Vp.set(e,t);for(const r of vh.values())Tg(r,t);for(const r of OP.values())Tg(r,t);return!0}function Om(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function yo(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},xa=new zu("app","Firebase",BP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jP{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Pl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw xa.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ac=MP;function X1(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:jp,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw xa.create("bad-app-name",{appName:String(i)});if(r||(r=W1()),!r)throw xa.create("no-options");const o=vh.get(i);if(o){if(Sl(r,o.options)&&Sl(n,o.config))return o;throw xa.create("duplicate-app",{appName:i})}const s=new WS(i);for(const c of Vp.values())s.addComponent(c);const a=new jP(r,n,s);return vh.set(i,a),a}function Z1(t=jp){const e=vh.get(t);if(!e&&t===jp&&W1())return X1();if(!e)throw xa.create("no-app",{appName:t});return e}function Aa(t,e,r){let n=FP[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const s=[`Unable to register library "${n}" with version "${e}":`];i&&s.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&o&&s.push("and"),o&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ls.warn(s.join(" "));return}mc(new Pl(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VP="firebase-heartbeat-database",qP=1,Eu="firebase-heartbeat-store";let jf=null;function eb(){return jf||(jf=oP(VP,qP,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Eu)}catch(r){console.warn(r)}}}}).catch(t=>{throw xa.create("idb-open",{originalErrorMessage:t.message})})),jf}async function zP(t){try{const r=(await eb()).transaction(Eu),n=await r.objectStore(Eu).get(tb(t));return await r.done,n}catch(e){if(e instanceof Bs)Ls.warn(e.message);else{const r=xa.create("idb-get",{originalErrorMessage:e?.message});Ls.warn(r.message)}}}async function Ng(t,e){try{const n=(await eb()).transaction(Eu,"readwrite");await n.objectStore(Eu).put(e,tb(t)),await n.done}catch(r){if(r instanceof Bs)Ls.warn(r.message);else{const n=xa.create("idb-set",{originalErrorMessage:r?.message});Ls.warn(n.message)}}}function tb(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UP=1024,HP=30;class WP{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new YP(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Lg();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>HP){const i=KP(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Ls.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Lg(),{heartbeatsToSend:r,unsentEntries:n}=GP(this._heartbeatsCache.heartbeats),i=gh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Ls.warn(e),""}}}function Lg(){return new Date().toISOString().substring(0,10)}function GP(t,e=UP){const r=[];let n=t.slice();for(const i of t){const o=r.find(s=>s.agent===i.agent);if(o){if(o.dates.push(i.date),Dg(r)>e){o.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),Dg(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class YP{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return DS()?RS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await zP(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Ng(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Ng(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Dg(t){return gh(JSON.stringify({version:2,heartbeats:t})).length}function KP(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JP(t){mc(new Pl("platform-logger",e=>new lP(e),"PRIVATE")),mc(new Pl("heartbeat",e=>new WP(e),"PRIVATE")),Aa(Bp,kg,t),Aa(Bp,kg,"esm2020"),Aa("fire-js","")}JP("");function rb(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const QP=rb,nb=new zu("auth","Firebase",rb());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bh=new Mm("@firebase/auth");function XP(t,...e){bh.logLevel<=Dr.WARN&&bh.warn(`Auth (${Ac}): ${t}`,...e)}function Jd(t,...e){bh.logLevel<=Dr.ERROR&&bh.error(`Auth (${Ac}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function os(t,...e){throw jm(t,...e)}function Lo(t,...e){return jm(t,...e)}function Bm(t,e,r){const n={...QP(),[e]:r};return new zu("auth","Firebase",n).create(e,{appName:t.name})}function Ca(t){return Bm(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ib(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&os(t,"argument-error"),Bm(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function jm(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return nb.create(t,...e)}function hr(t,e,...r){if(!t)throw jm(e,...r)}function Is(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Jd(e),new Error(e)}function Ds(t,e){t||Is(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qp(){return typeof self<"u"&&self.location?.href||""}function ZP(){return Rg()==="http:"||Rg()==="https:"}function Rg(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ex(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(ZP()||kS()||"connection"in navigator)?navigator.onLine:!0}function tx(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hu{constructor(e,r){this.shortDelay=e,this.longDelay=r,Ds(r>e,"Short delay should be less than long delay!"),this.isMobile=IS()||TS()}get(){return ex()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vm(t,e){Ds(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ob{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Is("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Is("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Is("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rx={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nx=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],ix=new Hu(3e4,6e4);function qm(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Cc(t,e,r,n,i={}){return sb(t,i,async()=>{let o={},s={};n&&(e==="GET"?s=n:o={body:JSON.stringify(n)});const a=Uu({key:t.config.apiKey,...s}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:c,...o};return ES()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&xc(t.emulatorConfig.host)&&(u.credentials="include"),ob.fetch()(await ab(t,t.config.apiHost,r,a),u)})}async function sb(t,e,r){t._canInitEmulator=!1;const n={...rx,...e};try{const i=new sx(t),o=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const s=await o.json();if("needConfirmation"in s)throw Cd(t,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{const a=o.ok?s.errorMessage:s.error.message,[c,u]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Cd(t,"credential-already-in-use",s);if(c==="EMAIL_EXISTS")throw Cd(t,"email-already-in-use",s);if(c==="USER_DISABLED")throw Cd(t,"user-disabled",s);const h=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw Bm(t,h,u);os(t,h)}}catch(i){if(i instanceof Bs)throw i;os(t,"network-request-failed",{message:String(i)})}}async function ox(t,e,r,n,i={}){const o=await Cc(t,e,r,n,i);return"mfaPendingCredential"in o&&os(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function ab(t,e,r,n){const i=`${e}${r}?${n}`,o=t,s=o.config.emulator?Vm(t.config,i):`${t.config.apiScheme}://${i}`;return nx.includes(r)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(s).toString():s}class sx{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Lo(this.auth,"network-request-failed")),ix.get())})}}function Cd(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Lo(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ax(t,e){return Cc(t,"POST","/v1/accounts:delete",e)}async function _h(t,e){return Cc(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function lx(t,e=!1){const r=ui(t),n=await r.getIdToken(e),i=zm(n);hr(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,s=o?.sign_in_provider;return{claims:i,token:n,authTime:hu(Vf(i.auth_time)),issuedAtTime:hu(Vf(i.iat)),expirationTime:hu(Vf(i.exp)),signInProvider:s||null,signInSecondFactor:o?.sign_in_second_factor||null}}function Vf(t){return Number(t)*1e3}function zm(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Jd("JWT malformed, contained fewer than 3 sections"),null;try{const i=U1(r);return i?JSON.parse(i):(Jd("Failed to decode base64 JWT payload"),null)}catch(i){return Jd("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Mg(t){const e=zm(t);return hr(e,"internal-error"),hr(typeof e.exp<"u","internal-error"),hr(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ku(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Bs&&cx(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function cx({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ux{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zp{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=hu(this.lastLoginAt),this.creationTime=hu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wh(t){const e=t.auth,r=await t.getIdToken(),n=await ku(t,_h(e,{idToken:r}));hr(n?.users.length,e,"internal-error");const i=n.users[0];t._notifyReloadListener(i);const o=i.providerUserInfo?.length?lb(i.providerUserInfo):[],s=hx(t.providerData,o),a=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!s?.length,u=a?c:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new zp(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function dx(t){const e=ui(t);await wh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function hx(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function lb(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fx(t,e){const r=await sb(t,{},async()=>{const n=Uu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=t.config,s=await ab(t,i,"/v1/token",`key=${o}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:n};return t.emulatorConfig&&xc(t.emulatorConfig.host)&&(c.credentials="include"),ob.fetch()(s,c)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function px(t,e){return Cc(t,"POST","/v2/accounts:revokeToken",qm(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){hr(e.idToken,"internal-error"),hr(typeof e.idToken<"u","internal-error"),hr(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Mg(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){hr(e.length!==0,"internal-error");const r=Mg(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(hr(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:o}=await fx(e,r);this.updateTokensAndExpiration(n,i,Number(o))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:o}=r,s=new cc;return n&&(hr(typeof n=="string","internal-error",{appName:e}),s.refreshToken=n),i&&(hr(typeof i=="string","internal-error",{appName:e}),s.accessToken=i),o&&(hr(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new cc,this.toJSON())}_performRefresh(){return Is("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ca(t,e){hr(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class No{constructor({uid:e,auth:r,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new ux(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new zp(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await ku(this,this.stsTokenManager.getToken(this.auth,e));return hr(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return lx(this,e)}reload(){return dx(this)}_assign(e){this!==e&&(hr(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new No({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){hr(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await wh(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(yo(this.auth.app))return Promise.reject(Ca(this.auth));const e=await this.getIdToken();return await ku(this,ax(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,i=r.email??void 0,o=r.phoneNumber??void 0,s=r.photoURL??void 0,a=r.tenantId??void 0,c=r._redirectEventId??void 0,u=r.createdAt??void 0,h=r.lastLoginAt??void 0,{uid:y,emailVerified:g,isAnonymous:p,providerData:C,stsTokenManager:S}=r;hr(y&&S,e,"internal-error");const w=cc.fromJSON(this.name,S);hr(typeof y=="string",e,"internal-error"),ca(n,e.name),ca(i,e.name),hr(typeof g=="boolean",e,"internal-error"),hr(typeof p=="boolean",e,"internal-error"),ca(o,e.name),ca(s,e.name),ca(a,e.name),ca(c,e.name),ca(u,e.name),ca(h,e.name);const x=new No({uid:y,auth:e,email:i,emailVerified:g,displayName:n,isAnonymous:p,photoURL:s,phoneNumber:o,tenantId:a,stsTokenManager:w,createdAt:u,lastLoginAt:h});return C&&Array.isArray(C)&&(x.providerData=C.map(V=>({...V}))),c&&(x._redirectEventId=c),x}static async _fromIdTokenResponse(e,r,n=!1){const i=new cc;i.updateFromServerResponse(r);const o=new No({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await wh(o),o}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];hr(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?lb(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!o?.length,a=new cc;a.updateFromIdToken(n);const c=new No({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:s}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new zp(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fg=new Map;function $s(t){Ds(t instanceof Function,"Expected a class definition");let e=Fg.get(t);return e?(Ds(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Fg.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cb{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}cb.type="NONE";const Og=cb;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qd(t,e,r){return`firebase:${t}:${e}:${r}`}class uc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:o}=this.auth;this.fullUserKey=Qd(this.userKey,i.apiKey,o),this.fullPersistenceKey=Qd("persistence",i.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await _h(this.auth,{idToken:e}).catch(()=>{});return r?No._fromGetAccountInfoResponse(this.auth,r,e):null}return No._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new uc($s(Og),e,n);const i=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let o=i[0]||$s(Og);const s=Qd(n,e.config.apiKey,e.name);let a=null;for(const u of r)try{const h=await u._get(s);if(h){let y;if(typeof h=="string"){const g=await _h(e,{idToken:h}).catch(()=>{});if(!g)break;y=await No._fromGetAccountInfoResponse(e,g,h)}else y=No._fromJSON(e,h);u!==o&&(a=y),o=u;break}}catch{}const c=i.filter(u=>u._shouldAllowMigration);return!o._shouldAllowMigration||!c.length?new uc(o,e,n):(o=c[0],a&&await o._set(s,a.toJSON()),await Promise.all(r.map(async u=>{if(u!==o)try{await u._remove(s)}catch{}})),new uc(o,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bg(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(fb(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ub(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(mb(e))return"Blackberry";if(yb(e))return"Webos";if(db(e))return"Safari";if((e.includes("chrome/")||hb(e))&&!e.includes("edge/"))return"Chrome";if(pb(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function ub(t=Ci()){return/firefox\//i.test(t)}function db(t=Ci()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function hb(t=Ci()){return/crios\//i.test(t)}function fb(t=Ci()){return/iemobile/i.test(t)}function pb(t=Ci()){return/android/i.test(t)}function mb(t=Ci()){return/blackberry/i.test(t)}function yb(t=Ci()){return/webos/i.test(t)}function Um(t=Ci()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function mx(t=Ci()){return Um(t)&&!!window.navigator?.standalone}function yx(){return NS()&&document.documentMode===10}function gb(t=Ci()){return Um(t)||pb(t)||yb(t)||mb(t)||/windows phone/i.test(t)||fb(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vb(t,e=[]){let r;switch(t){case"Browser":r=Bg(Ci());break;case"Worker":r=`${Bg(Ci())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Ac}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gx{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=o=>new Promise((s,a)=>{try{const c=e(o);s(c)}catch(c){a(c)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vx(t,e={}){return Cc(t,"GET","/v2/passwordPolicy",qm(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bx=6;class _x{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??bx,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wx{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new jg(this),this.idTokenSubscription=new jg(this),this.beforeStateQueue=new gx(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=nb,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=$s(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await uc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await _h(this,{idToken:e}),n=await No._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(yo(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(s,s))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=this.redirectUser?._redirectEventId,s=n?._redirectEventId,a=await this.tryRedirectSignIn(e);(!o||o===s)&&a?.user&&(n=a.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return hr(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await wh(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=tx()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(yo(this.app))return Promise.reject(Ca(this));const r=e?ui(e):null;return r&&hr(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&hr(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return yo(this.app)?Promise.reject(Ca(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return yo(this.app)?Promise.reject(Ca(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence($s(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await vx(this),r=new _x(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new zu("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await px(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&$s(e)||this._popupRedirectResolver;hr(r,this,"argument-error"),this.redirectPersistenceManager=await uc.create(this,[$s(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const o=typeof r=="function"?r:r.next.bind(r);let s=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(hr(a,this,"internal-error"),a.then(()=>{s||o(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,i);return()=>{s=!0,c()}}else{const c=e.addObserver(r);return()=>{s=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return hr(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=vb(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(yo(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&XP(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Il(t){return ui(t)}class jg{constructor(e){this.auth=e,this.observer=null,this.addObserver=jS(r=>this.observer=r)}get next(){return hr(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Sx(t){Hm=t}function Px(t){return Hm.loadJS(t)}function xx(){return Hm.gapiScript}function Ax(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cx(t,e){const r=Om(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),o=r.getOptions();if(Sl(o,e??{}))return i;os(i,"already-initialized")}return r.initialize({options:e})}function Ix(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map($s);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function $x(t,e,r){const n=Il(t);hr(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,o=bb(e),{host:s,port:a}=Ex(e),c=a===null?"":`:${a}`,u={url:`${o}//${s}${c}/`},h=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){hr(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),hr(Sl(u,n.config.emulator)&&Sl(h,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=u,n.emulatorConfig=h,n.settings.appVerificationDisabledForTesting=!0,xc(s)?(Y1(`${o}//${s}${c}`),K1("Auth",!0)):kx()}function bb(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Ex(t){const e=bb(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const o=i[1];return{host:o,port:Vg(n.substr(o.length+1))}}else{const[o,s]=n.split(":");return{host:o,port:Vg(s)}}}function Vg(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function kx(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _b{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Is("not implemented")}_getIdTokenResponse(e){return Is("not implemented")}_linkToIdToken(e,r){return Is("not implemented")}_getReauthenticationResolver(e){return Is("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dc(t,e){return ox(t,"POST","/v1/accounts:signInWithIdp",qm(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tx="http://localhost";class xl extends _b{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new xl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):os("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...o}=r;if(!n||!i)return null;const s=new xl(n,i);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(e){const r=this.buildRequest();return dc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,dc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,dc(e,r)}buildRequest(){const e={requestUri:Tx,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Uu(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu extends Uh{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya extends Wu{constructor(){super("facebook.com")}static credential(e){return xl._fromParams({providerId:ya.PROVIDER_ID,signInMethod:ya.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ya.credentialFromTaggedObject(e)}static credentialFromError(e){return ya.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ya.credential(e.oauthAccessToken)}catch{return null}}}ya.FACEBOOK_SIGN_IN_METHOD="facebook.com";ya.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo extends Wu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return xl._fromParams({providerId:Jo.PROVIDER_ID,signInMethod:Jo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Jo.credentialFromTaggedObject(e)}static credentialFromError(e){return Jo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Jo.credential(r,n)}catch{return null}}}Jo.GOOGLE_SIGN_IN_METHOD="google.com";Jo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga extends Wu{constructor(){super("github.com")}static credential(e){return xl._fromParams({providerId:ga.PROVIDER_ID,signInMethod:ga.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ga.credentialFromTaggedObject(e)}static credentialFromError(e){return ga.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ga.credential(e.oauthAccessToken)}catch{return null}}}ga.GITHUB_SIGN_IN_METHOD="github.com";ga.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va extends Wu{constructor(){super("twitter.com")}static credential(e,r){return xl._fromParams({providerId:va.PROVIDER_ID,signInMethod:va.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return va.credentialFromTaggedObject(e)}static credentialFromError(e){return va.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return va.credential(r,n)}catch{return null}}}va.TWITTER_SIGN_IN_METHOD="twitter.com";va.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const o=await No._fromIdTokenResponse(e,n,i),s=qg(n);return new yc({user:o,providerId:s,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=qg(n);return new yc({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function qg(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sh extends Bs{constructor(e,r,n,i){super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Sh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new Sh(e,r,n,i)}}function wb(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Sh._fromErrorAndOperation(t,o,e,n):o})}async function Nx(t,e,r=!1){const n=await ku(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return yc._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lx(t,e,r=!1){const{auth:n}=t;if(yo(n.app))return Promise.reject(Ca(n));const i="reauthenticate";try{const o=await ku(t,wb(n,i,e,t),r);hr(o.idToken,n,"internal-error");const s=zm(o.idToken);hr(s,n,"internal-error");const{sub:a}=s;return hr(t.uid===a,n,"user-mismatch"),yc._forOperation(t,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&os(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sb(t,e,r=!1){if(yo(t.app))return Promise.reject(Ca(t));const n="signIn",i=await wb(t,n,e),o=await yc._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(o.user),o}async function Dx(t,e){return Sb(Il(t),e)}function Rx(t,e,r,n){return ui(t).onIdTokenChanged(e,r,n)}function Mx(t,e,r){return ui(t).beforeAuthStateChanged(e,r)}function Fx(t,e,r,n){return ui(t).onAuthStateChanged(e,r,n)}function Ox(t){return ui(t).signOut()}const Ph="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pb{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Ph,"1"),this.storage.removeItem(Ph),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bx=1e3,jx=10;class xb extends Pb{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=gb(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((s,a,c)=>{this.notifyListeners(s,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const s=this.storage.getItem(n);!r&&this.localCache[n]===s||this.notifyListeners(n,s)},o=this.storage.getItem(n);yx()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,jx):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},Bx)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}xb.type="LOCAL";const Vx=xb;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ab extends Pb{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}Ab.type="SESSION";const Cb=Ab;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qx(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new Hh(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:o}=r.data,s=this.handlersMap[i];if(!s?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const a=Array.from(s).map(async u=>u(r.origin,o)),c=await qx(a);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Hh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wm(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zx{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,s;return new Promise((a,c)=>{const u=Wm("",20);i.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},n);s={messageChannel:i,onMessage(y){const g=y;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(h),o=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),a(g.data.response);break;default:clearTimeout(h),clearTimeout(o),c(new Error("invalid_response"));break}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:u,data:r},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xo(){return window}function Ux(t){Xo().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ib(){return typeof Xo().WorkerGlobalScope<"u"&&typeof Xo().importScripts=="function"}async function Hx(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Wx(){return navigator?.serviceWorker?.controller||null}function Gx(){return Ib()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $b="firebaseLocalStorageDb",Yx=1,xh="firebaseLocalStorage",Eb="fbase_key";class Gu{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Wh(t,e){return t.transaction([xh],e?"readwrite":"readonly").objectStore(xh)}function Kx(){const t=indexedDB.deleteDatabase($b);return new Gu(t).toPromise()}function Up(){const t=indexedDB.open($b,Yx);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(xh,{keyPath:Eb})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(xh)?e(n):(n.close(),await Kx(),e(await Up()))})})}async function zg(t,e,r){const n=Wh(t,!0).put({[Eb]:e,value:r});return new Gu(n).toPromise()}async function Jx(t,e){const r=Wh(t,!1).get(e),n=await new Gu(r).toPromise();return n===void 0?null:n.value}function Ug(t,e){const r=Wh(t,!0).delete(e);return new Gu(r).toPromise()}const Qx=800,Xx=3;class kb{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Up(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>Xx)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ib()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Hh._getInstance(Gx()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await Hx(),!this.activeServiceWorker)return;this.sender=new zx(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Wx()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Up();return await zg(e,Ph,"1"),await Ug(e,Ph),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>zg(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>Jx(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>Ug(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=Wh(i,!1).getAll();return new Gu(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Qx)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}kb.type="LOCAL";const Zx=kb;new Hu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gm(t,e){return e?$s(e):(hr(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ym extends _b{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return dc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return dc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return dc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function eA(t){return Sb(t.auth,new Ym(t),t.bypassAuthState)}function tA(t){const{auth:e,user:r}=t;return hr(r,e,"internal-error"),Lx(r,new Ym(t),t.bypassAuthState)}async function rA(t){const{auth:e,user:r}=t;return hr(r,e,"internal-error"),Nx(r,new Ym(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tb{constructor(e,r,n,i,o=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:o,error:s,type:a}=e;if(s){this.reject(s);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return eA;case"linkViaPopup":case"linkViaRedirect":return rA;case"reauthViaPopup":case"reauthViaRedirect":return tA;default:os(this.auth,"internal-error")}}resolve(e){Ds(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ds(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nA=new Hu(2e3,1e4);async function iA(t,e,r){if(yo(t.app))return Promise.reject(Lo(t,"operation-not-supported-in-this-environment"));const n=Il(t);ib(t,e,Uh);const i=Gm(n,r);return new fl(n,"signInViaPopup",e,i).executeNotNull()}class fl extends Tb{constructor(e,r,n,i,o){super(e,r,i,o),this.provider=n,this.authWindow=null,this.pollId=null,fl.currentPopupAction&&fl.currentPopupAction.cancel(),fl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return hr(e,this.auth,"internal-error"),e}async onExecution(){Ds(this.filter.length===1,"Popup operations only handle one event");const e=Wm();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Lo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Lo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,fl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Lo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,nA.get())};e()}}fl.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oA="pendingRedirect",Xd=new Map;class sA extends Tb{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Xd.get(this.auth._key());if(!e){try{const n=await aA(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Xd.set(this.auth._key(),e)}return this.bypassAuthState||Xd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function aA(t,e){const r=Lb(e),n=Nb(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}async function lA(t,e){return Nb(t)._set(Lb(e),"true")}function cA(t,e){Xd.set(t._key(),e)}function Nb(t){return $s(t._redirectPersistence)}function Lb(t){return Qd(oA,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uA(t,e,r){return dA(t,e,r)}async function dA(t,e,r){if(yo(t.app))return Promise.reject(Ca(t));const n=Il(t);ib(t,e,Uh),await n._initializationPromise;const i=Gm(n,r);return await lA(i,n),i._openRedirect(n,e,"signInViaRedirect")}async function hA(t,e){return await Il(t)._initializationPromise,Db(t,e,!1)}async function Db(t,e,r=!1){if(yo(t.app))return Promise.reject(Ca(t));const n=Il(t),i=Gm(n,e),s=await new sA(n,i,r).execute();return s&&!r&&(delete s.user._redirectEventId,await n._persistUserIfCurrent(s.user),await n._setRedirectUser(null,e)),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fA=10*60*1e3;class pA{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!mA(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!Rb(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(Lo(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=fA&&this.cachedEventUids.clear(),this.cachedEventUids.has(Hg(e))}saveEventToCache(e){this.cachedEventUids.add(Hg(e)),this.lastProcessedEventTime=Date.now()}}function Hg(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Rb({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function mA(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Rb(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yA(t,e={}){return Cc(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gA=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,vA=/^https?/;async function bA(t){if(t.config.emulator)return;const{authorizedDomains:e}=await yA(t);for(const r of e)try{if(_A(r))return}catch{}os(t,"unauthorized-domain")}function _A(t){const e=qp(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const s=new URL(t);return s.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&s.hostname===n}if(!vA.test(r))return!1;if(gA.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wA=new Hu(3e4,6e4);function Wg(){const t=Xo().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function SA(t){return new Promise((e,r)=>{function n(){Wg(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Wg(),r(Lo(t,"network-request-failed"))},timeout:wA.get()})}if(Xo().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Xo().gapi?.load)n();else{const i=Ax("iframefcb");return Xo()[i]=()=>{gapi.load?n():r(Lo(t,"network-request-failed"))},Px(`${xx()}?onload=${i}`).catch(o=>r(o))}}).catch(e=>{throw Zd=null,e})}let Zd=null;function PA(t){return Zd=Zd||SA(t),Zd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xA=new Hu(5e3,15e3),AA="__/auth/iframe",CA="emulator/auth/iframe",IA={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},$A=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function EA(t){const e=t.config;hr(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Vm(e,CA):`https://${t.config.authDomain}/${AA}`,n={apiKey:e.apiKey,appName:t.name,v:Ac},i=$A.get(t.config.apiHost);i&&(n.eid=i);const o=t._getFrameworks();return o.length&&(n.fw=o.join(",")),`${r}?${Uu(n).slice(1)}`}async function kA(t){const e=await PA(t),r=Xo().gapi;return hr(r,t,"internal-error"),e.open({where:document.body,url:EA(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:IA,dontclear:!0},n=>new Promise(async(i,o)=>{await n.restyle({setHideOnLeave:!1});const s=Lo(t,"network-request-failed"),a=Xo().setTimeout(()=>{o(s)},xA.get());function c(){Xo().clearTimeout(a),i(n)}n.ping(c).then(c,()=>{o(s)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TA={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},NA=500,LA=600,DA="_blank",RA="http://localhost";class Gg{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function MA(t,e,r,n=NA,i=LA){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-n)/2,0).toString();let a="";const c={...TA,width:n.toString(),height:i.toString(),top:o,left:s},u=Ci().toLowerCase();r&&(a=hb(u)?DA:r),ub(u)&&(e=e||RA,c.scrollbars="yes");const h=Object.entries(c).reduce((g,[p,C])=>`${g}${p}=${C},`,"");if(mx(u)&&a!=="_self")return FA(e||"",a),new Gg(null);const y=window.open(e||"",a,h);hr(y,t,"popup-blocked");try{y.focus()}catch{}return new Gg(y)}function FA(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OA="__/auth/handler",BA="emulator/auth/handler",jA=encodeURIComponent("fac");async function Yg(t,e,r,n,i,o){hr(t.config.authDomain,t,"auth-domain-config-required"),hr(t.config.apiKey,t,"invalid-api-key");const s={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Ac,eventId:i};if(e instanceof Uh){e.setDefaultLanguage(t.languageCode),s.providerId=e.providerId||"",BS(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,y]of Object.entries({}))s[h]=y}if(e instanceof Wu){const h=e.getScopes().filter(y=>y!=="");h.length>0&&(s.scopes=h.join(","))}t.tenantId&&(s.tid=t.tenantId);const a=s;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const c=await t._getAppCheckToken(),u=c?`#${jA}=${encodeURIComponent(c)}`:"";return`${VA(t)}?${Uu(a).slice(1)}${u}`}function VA({config:t}){return t.emulator?Vm(t,BA):`https://${t.authDomain}/${OA}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qf="webStorageSupport";class qA{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Cb,this._completeRedirectFn=Db,this._overrideRedirectResult=cA}async _openPopup(e,r,n,i){Ds(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const o=await Yg(e,r,n,qp(),i);return MA(e,o,Wm())}async _openRedirect(e,r,n,i){await this._originValidation(e);const o=await Yg(e,r,n,qp(),i);return Ux(o),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:o}=this.eventManagers[r];return i?Promise.resolve(i):(Ds(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await kA(e),n=new pA(e);return r.register("authEvent",i=>(hr(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(qf,{type:qf},i=>{const o=i?.[0]?.[qf];o!==void 0&&r(!!o),os(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=bA(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return gb()||db()||Um()}}const zA=qA;var Kg="@firebase/auth",Jg="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UA{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){hr(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HA(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function WA(t){mc(new Pl("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=n.options;hr(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:s,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:vb(t)},u=new wx(n,i,o,c);return Ix(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),mc(new Pl("auth-internal",e=>{const r=Il(e.getProvider("auth").getImmediate());return(n=>new UA(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Aa(Kg,Jg,HA(t)),Aa(Kg,Jg,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GA=5*60,YA=G1("authIdTokenMaxAge")||GA;let Qg=null;const KA=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>YA)return;const i=r?.token;Qg!==i&&(Qg=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function JA(t=Z1()){const e=Om(t,"auth");if(e.isInitialized())return e.getImmediate();const r=Cx(t,{popupRedirectResolver:zA,persistence:[Zx,Vx,Cb]}),n=G1("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const s=KA(o.toString());Mx(r,s,()=>s(r.currentUser)),Rx(r,a=>s(a))}}const i=H1("auth");return i&&$x(r,`http://${i}`),r}function QA(){return document.getElementsByTagName("head")?.[0]??document}Sx({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const o=Lo("internal-error");o.customData=i,r(o)},n.type="text/javascript",n.charset="UTF-8",QA().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});WA("Browser");var XA="firebase",ZA="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Aa(XA,ZA,"app");var Xg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ia,Mb;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,A){function T(){}T.prototype=A.prototype,E.D=A.prototype,E.prototype=new T,E.prototype.constructor=E,E.C=function(R,_,I){for(var b=Array(arguments.length-2),G=2;G<arguments.length;G++)b[G-2]=arguments[G];return A.prototype[_].apply(R,b)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,A,T){T||(T=0);var R=Array(16);if(typeof A=="string")for(var _=0;16>_;++_)R[_]=A.charCodeAt(T++)|A.charCodeAt(T++)<<8|A.charCodeAt(T++)<<16|A.charCodeAt(T++)<<24;else for(_=0;16>_;++_)R[_]=A[T++]|A[T++]<<8|A[T++]<<16|A[T++]<<24;A=E.g[0],T=E.g[1],_=E.g[2];var I=E.g[3],b=A+(I^T&(_^I))+R[0]+3614090360&4294967295;A=T+(b<<7&4294967295|b>>>25),b=I+(_^A&(T^_))+R[1]+3905402710&4294967295,I=A+(b<<12&4294967295|b>>>20),b=_+(T^I&(A^T))+R[2]+606105819&4294967295,_=I+(b<<17&4294967295|b>>>15),b=T+(A^_&(I^A))+R[3]+3250441966&4294967295,T=_+(b<<22&4294967295|b>>>10),b=A+(I^T&(_^I))+R[4]+4118548399&4294967295,A=T+(b<<7&4294967295|b>>>25),b=I+(_^A&(T^_))+R[5]+1200080426&4294967295,I=A+(b<<12&4294967295|b>>>20),b=_+(T^I&(A^T))+R[6]+2821735955&4294967295,_=I+(b<<17&4294967295|b>>>15),b=T+(A^_&(I^A))+R[7]+4249261313&4294967295,T=_+(b<<22&4294967295|b>>>10),b=A+(I^T&(_^I))+R[8]+1770035416&4294967295,A=T+(b<<7&4294967295|b>>>25),b=I+(_^A&(T^_))+R[9]+2336552879&4294967295,I=A+(b<<12&4294967295|b>>>20),b=_+(T^I&(A^T))+R[10]+4294925233&4294967295,_=I+(b<<17&4294967295|b>>>15),b=T+(A^_&(I^A))+R[11]+2304563134&4294967295,T=_+(b<<22&4294967295|b>>>10),b=A+(I^T&(_^I))+R[12]+1804603682&4294967295,A=T+(b<<7&4294967295|b>>>25),b=I+(_^A&(T^_))+R[13]+4254626195&4294967295,I=A+(b<<12&4294967295|b>>>20),b=_+(T^I&(A^T))+R[14]+2792965006&4294967295,_=I+(b<<17&4294967295|b>>>15),b=T+(A^_&(I^A))+R[15]+1236535329&4294967295,T=_+(b<<22&4294967295|b>>>10),b=A+(_^I&(T^_))+R[1]+4129170786&4294967295,A=T+(b<<5&4294967295|b>>>27),b=I+(T^_&(A^T))+R[6]+3225465664&4294967295,I=A+(b<<9&4294967295|b>>>23),b=_+(A^T&(I^A))+R[11]+643717713&4294967295,_=I+(b<<14&4294967295|b>>>18),b=T+(I^A&(_^I))+R[0]+3921069994&4294967295,T=_+(b<<20&4294967295|b>>>12),b=A+(_^I&(T^_))+R[5]+3593408605&4294967295,A=T+(b<<5&4294967295|b>>>27),b=I+(T^_&(A^T))+R[10]+38016083&4294967295,I=A+(b<<9&4294967295|b>>>23),b=_+(A^T&(I^A))+R[15]+3634488961&4294967295,_=I+(b<<14&4294967295|b>>>18),b=T+(I^A&(_^I))+R[4]+3889429448&4294967295,T=_+(b<<20&4294967295|b>>>12),b=A+(_^I&(T^_))+R[9]+568446438&4294967295,A=T+(b<<5&4294967295|b>>>27),b=I+(T^_&(A^T))+R[14]+3275163606&4294967295,I=A+(b<<9&4294967295|b>>>23),b=_+(A^T&(I^A))+R[3]+4107603335&4294967295,_=I+(b<<14&4294967295|b>>>18),b=T+(I^A&(_^I))+R[8]+1163531501&4294967295,T=_+(b<<20&4294967295|b>>>12),b=A+(_^I&(T^_))+R[13]+2850285829&4294967295,A=T+(b<<5&4294967295|b>>>27),b=I+(T^_&(A^T))+R[2]+4243563512&4294967295,I=A+(b<<9&4294967295|b>>>23),b=_+(A^T&(I^A))+R[7]+1735328473&4294967295,_=I+(b<<14&4294967295|b>>>18),b=T+(I^A&(_^I))+R[12]+2368359562&4294967295,T=_+(b<<20&4294967295|b>>>12),b=A+(T^_^I)+R[5]+4294588738&4294967295,A=T+(b<<4&4294967295|b>>>28),b=I+(A^T^_)+R[8]+2272392833&4294967295,I=A+(b<<11&4294967295|b>>>21),b=_+(I^A^T)+R[11]+1839030562&4294967295,_=I+(b<<16&4294967295|b>>>16),b=T+(_^I^A)+R[14]+4259657740&4294967295,T=_+(b<<23&4294967295|b>>>9),b=A+(T^_^I)+R[1]+2763975236&4294967295,A=T+(b<<4&4294967295|b>>>28),b=I+(A^T^_)+R[4]+1272893353&4294967295,I=A+(b<<11&4294967295|b>>>21),b=_+(I^A^T)+R[7]+4139469664&4294967295,_=I+(b<<16&4294967295|b>>>16),b=T+(_^I^A)+R[10]+3200236656&4294967295,T=_+(b<<23&4294967295|b>>>9),b=A+(T^_^I)+R[13]+681279174&4294967295,A=T+(b<<4&4294967295|b>>>28),b=I+(A^T^_)+R[0]+3936430074&4294967295,I=A+(b<<11&4294967295|b>>>21),b=_+(I^A^T)+R[3]+3572445317&4294967295,_=I+(b<<16&4294967295|b>>>16),b=T+(_^I^A)+R[6]+76029189&4294967295,T=_+(b<<23&4294967295|b>>>9),b=A+(T^_^I)+R[9]+3654602809&4294967295,A=T+(b<<4&4294967295|b>>>28),b=I+(A^T^_)+R[12]+3873151461&4294967295,I=A+(b<<11&4294967295|b>>>21),b=_+(I^A^T)+R[15]+530742520&4294967295,_=I+(b<<16&4294967295|b>>>16),b=T+(_^I^A)+R[2]+3299628645&4294967295,T=_+(b<<23&4294967295|b>>>9),b=A+(_^(T|~I))+R[0]+4096336452&4294967295,A=T+(b<<6&4294967295|b>>>26),b=I+(T^(A|~_))+R[7]+1126891415&4294967295,I=A+(b<<10&4294967295|b>>>22),b=_+(A^(I|~T))+R[14]+2878612391&4294967295,_=I+(b<<15&4294967295|b>>>17),b=T+(I^(_|~A))+R[5]+4237533241&4294967295,T=_+(b<<21&4294967295|b>>>11),b=A+(_^(T|~I))+R[12]+1700485571&4294967295,A=T+(b<<6&4294967295|b>>>26),b=I+(T^(A|~_))+R[3]+2399980690&4294967295,I=A+(b<<10&4294967295|b>>>22),b=_+(A^(I|~T))+R[10]+4293915773&4294967295,_=I+(b<<15&4294967295|b>>>17),b=T+(I^(_|~A))+R[1]+2240044497&4294967295,T=_+(b<<21&4294967295|b>>>11),b=A+(_^(T|~I))+R[8]+1873313359&4294967295,A=T+(b<<6&4294967295|b>>>26),b=I+(T^(A|~_))+R[15]+4264355552&4294967295,I=A+(b<<10&4294967295|b>>>22),b=_+(A^(I|~T))+R[6]+2734768916&4294967295,_=I+(b<<15&4294967295|b>>>17),b=T+(I^(_|~A))+R[13]+1309151649&4294967295,T=_+(b<<21&4294967295|b>>>11),b=A+(_^(T|~I))+R[4]+4149444226&4294967295,A=T+(b<<6&4294967295|b>>>26),b=I+(T^(A|~_))+R[11]+3174756917&4294967295,I=A+(b<<10&4294967295|b>>>22),b=_+(A^(I|~T))+R[2]+718787259&4294967295,_=I+(b<<15&4294967295|b>>>17),b=T+(I^(_|~A))+R[9]+3951481745&4294967295,E.g[0]=E.g[0]+A&4294967295,E.g[1]=E.g[1]+(_+(b<<21&4294967295|b>>>11))&4294967295,E.g[2]=E.g[2]+_&4294967295,E.g[3]=E.g[3]+I&4294967295}n.prototype.u=function(E,A){A===void 0&&(A=E.length);for(var T=A-this.blockSize,R=this.B,_=this.h,I=0;I<A;){if(_==0)for(;I<=T;)i(this,E,I),I+=this.blockSize;if(typeof E=="string"){for(;I<A;)if(R[_++]=E.charCodeAt(I++),_==this.blockSize){i(this,R),_=0;break}}else for(;I<A;)if(R[_++]=E[I++],_==this.blockSize){i(this,R),_=0;break}}this.h=_,this.o+=A},n.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var A=1;A<E.length-8;++A)E[A]=0;var T=8*this.o;for(A=E.length-8;A<E.length;++A)E[A]=T&255,T/=256;for(this.u(E),E=Array(16),A=T=0;4>A;++A)for(var R=0;32>R;R+=8)E[T++]=this.g[A]>>>R&255;return E};function o(E,A){var T=a;return Object.prototype.hasOwnProperty.call(T,E)?T[E]:T[E]=A(E)}function s(E,A){this.h=A;for(var T=[],R=!0,_=E.length-1;0<=_;_--){var I=E[_]|0;R&&I==A||(T[_]=I,R=!1)}this.g=T}var a={};function c(E){return-128<=E&&128>E?o(E,function(A){return new s([A|0],0>A?-1:0)}):new s([E|0],0>E?-1:0)}function u(E){if(isNaN(E)||!isFinite(E))return y;if(0>E)return w(u(-E));for(var A=[],T=1,R=0;E>=T;R++)A[R]=E/T|0,T*=4294967296;return new s(A,0)}function h(E,A){if(E.length==0)throw Error("number format error: empty string");if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(E.charAt(0)=="-")return w(h(E.substring(1),A));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var T=u(Math.pow(A,8)),R=y,_=0;_<E.length;_+=8){var I=Math.min(8,E.length-_),b=parseInt(E.substring(_,_+I),A);8>I?(I=u(Math.pow(A,I)),R=R.j(I).add(u(b))):(R=R.j(T),R=R.add(u(b)))}return R}var y=c(0),g=c(1),p=c(16777216);t=s.prototype,t.m=function(){if(S(this))return-w(this).m();for(var E=0,A=1,T=0;T<this.g.length;T++){var R=this.i(T);E+=(0<=R?R:4294967296+R)*A,A*=4294967296}return E},t.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(C(this))return"0";if(S(this))return"-"+w(this).toString(E);for(var A=u(Math.pow(E,6)),T=this,R="";;){var _=X(T,A).g;T=x(T,_.j(A));var I=((0<T.g.length?T.g[0]:T.h)>>>0).toString(E);if(T=_,C(T))return I+R;for(;6>I.length;)I="0"+I;R=I+R}},t.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function C(E){if(E.h!=0)return!1;for(var A=0;A<E.g.length;A++)if(E.g[A]!=0)return!1;return!0}function S(E){return E.h==-1}t.l=function(E){return E=x(this,E),S(E)?-1:C(E)?0:1};function w(E){for(var A=E.g.length,T=[],R=0;R<A;R++)T[R]=~E.g[R];return new s(T,~E.h).add(g)}t.abs=function(){return S(this)?w(this):this},t.add=function(E){for(var A=Math.max(this.g.length,E.g.length),T=[],R=0,_=0;_<=A;_++){var I=R+(this.i(_)&65535)+(E.i(_)&65535),b=(I>>>16)+(this.i(_)>>>16)+(E.i(_)>>>16);R=b>>>16,I&=65535,b&=65535,T[_]=b<<16|I}return new s(T,T[T.length-1]&-2147483648?-1:0)};function x(E,A){return E.add(w(A))}t.j=function(E){if(C(this)||C(E))return y;if(S(this))return S(E)?w(this).j(w(E)):w(w(this).j(E));if(S(E))return w(this.j(w(E)));if(0>this.l(p)&&0>E.l(p))return u(this.m()*E.m());for(var A=this.g.length+E.g.length,T=[],R=0;R<2*A;R++)T[R]=0;for(R=0;R<this.g.length;R++)for(var _=0;_<E.g.length;_++){var I=this.i(R)>>>16,b=this.i(R)&65535,G=E.i(_)>>>16,ie=E.i(_)&65535;T[2*R+2*_]+=b*ie,V(T,2*R+2*_),T[2*R+2*_+1]+=I*ie,V(T,2*R+2*_+1),T[2*R+2*_+1]+=b*G,V(T,2*R+2*_+1),T[2*R+2*_+2]+=I*G,V(T,2*R+2*_+2)}for(R=0;R<A;R++)T[R]=T[2*R+1]<<16|T[2*R];for(R=A;R<2*A;R++)T[R]=0;return new s(T,0)};function V(E,A){for(;(E[A]&65535)!=E[A];)E[A+1]+=E[A]>>>16,E[A]&=65535,A++}function ne(E,A){this.g=E,this.h=A}function X(E,A){if(C(A))throw Error("division by zero");if(C(E))return new ne(y,y);if(S(E))return A=X(w(E),A),new ne(w(A.g),w(A.h));if(S(A))return A=X(E,w(A)),new ne(w(A.g),A.h);if(30<E.g.length){if(S(E)||S(A))throw Error("slowDivide_ only works with positive integers.");for(var T=g,R=A;0>=R.l(E);)T=Q(T),R=Q(R);var _=ee(T,1),I=ee(R,1);for(R=ee(R,2),T=ee(T,2);!C(R);){var b=I.add(R);0>=b.l(E)&&(_=_.add(T),I=b),R=ee(R,1),T=ee(T,1)}return A=x(E,_.j(A)),new ne(_,A)}for(_=y;0<=E.l(A);){for(T=Math.max(1,Math.floor(E.m()/A.m())),R=Math.ceil(Math.log(T)/Math.LN2),R=48>=R?1:Math.pow(2,R-48),I=u(T),b=I.j(A);S(b)||0<b.l(E);)T-=R,I=u(T),b=I.j(A);C(I)&&(I=g),_=_.add(I),E=x(E,b)}return new ne(_,E)}t.A=function(E){return X(this,E).h},t.and=function(E){for(var A=Math.max(this.g.length,E.g.length),T=[],R=0;R<A;R++)T[R]=this.i(R)&E.i(R);return new s(T,this.h&E.h)},t.or=function(E){for(var A=Math.max(this.g.length,E.g.length),T=[],R=0;R<A;R++)T[R]=this.i(R)|E.i(R);return new s(T,this.h|E.h)},t.xor=function(E){for(var A=Math.max(this.g.length,E.g.length),T=[],R=0;R<A;R++)T[R]=this.i(R)^E.i(R);return new s(T,this.h^E.h)};function Q(E){for(var A=E.g.length+1,T=[],R=0;R<A;R++)T[R]=E.i(R)<<1|E.i(R-1)>>>31;return new s(T,E.h)}function ee(E,A){var T=A>>5;A%=32;for(var R=E.g.length-T,_=[],I=0;I<R;I++)_[I]=0<A?E.i(I+T)>>>A|E.i(I+T+1)<<32-A:E.i(I+T);return new s(_,E.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Mb=n,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=u,s.fromString=h,Ia=s}).apply(typeof Xg<"u"?Xg:typeof self<"u"?self:typeof window<"u"?window:{});var Id=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Fb,nu,Ob,eh,Hp,Bb,jb,Vb;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,M,se){return f==Array.prototype||f==Object.prototype||(f[M]=se.value),f};function r(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof Id=="object"&&Id];for(var M=0;M<f.length;++M){var se=f[M];if(se&&se.Math==Math)return se}throw Error("Cannot find global object")}var n=r(this);function i(f,M){if(M)e:{var se=n;f=f.split(".");for(var be=0;be<f.length-1;be++){var Ve=f[be];if(!(Ve in se))break e;se=se[Ve]}f=f[f.length-1],be=se[f],M=M(be),M!=be&&M!=null&&e(se,f,{configurable:!0,writable:!0,value:M})}}function o(f,M){f instanceof String&&(f+="");var se=0,be=!1,Ve={next:function(){if(!be&&se<f.length){var Qe=se++;return{value:M(Qe,f[Qe]),done:!1}}return be=!0,{done:!0,value:void 0}}};return Ve[Symbol.iterator]=function(){return Ve},Ve}i("Array.prototype.values",function(f){return f||function(){return o(this,function(M,se){return se})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},a=this||self;function c(f){var M=typeof f;return M=M!="object"?M:f?Array.isArray(f)?"array":M:"null",M=="array"||M=="object"&&typeof f.length=="number"}function u(f){var M=typeof f;return M=="object"&&f!=null||M=="function"}function h(f,M,se){return f.call.apply(f.bind,arguments)}function y(f,M,se){if(!f)throw Error();if(2<arguments.length){var be=Array.prototype.slice.call(arguments,2);return function(){var Ve=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Ve,be),f.apply(M,Ve)}}return function(){return f.apply(M,arguments)}}function g(f,M,se){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:y,g.apply(null,arguments)}function p(f,M){var se=Array.prototype.slice.call(arguments,1);return function(){var be=se.slice();return be.push.apply(be,arguments),f.apply(this,be)}}function C(f,M){function se(){}se.prototype=M.prototype,f.aa=M.prototype,f.prototype=new se,f.prototype.constructor=f,f.Qb=function(be,Ve,Qe){for(var It=Array(arguments.length-2),gr=2;gr<arguments.length;gr++)It[gr-2]=arguments[gr];return M.prototype[Ve].apply(be,It)}}function S(f){const M=f.length;if(0<M){const se=Array(M);for(let be=0;be<M;be++)se[be]=f[be];return se}return[]}function w(f,M){for(let se=1;se<arguments.length;se++){const be=arguments[se];if(c(be)){const Ve=f.length||0,Qe=be.length||0;f.length=Ve+Qe;for(let It=0;It<Qe;It++)f[Ve+It]=be[It]}else f.push(be)}}class x{constructor(M,se){this.i=M,this.j=se,this.h=0,this.g=null}get(){let M;return 0<this.h?(this.h--,M=this.g,this.g=M.next,M.next=null):M=this.i(),M}}function V(f){return/^[\s\xa0]*$/.test(f)}function ne(){var f=a.navigator;return f&&(f=f.userAgent)?f:""}function X(f){return X[" "](f),f}X[" "]=function(){};var Q=ne().indexOf("Gecko")!=-1&&!(ne().toLowerCase().indexOf("webkit")!=-1&&ne().indexOf("Edge")==-1)&&!(ne().indexOf("Trident")!=-1||ne().indexOf("MSIE")!=-1)&&ne().indexOf("Edge")==-1;function ee(f,M,se){for(const be in f)M.call(se,f[be],be,f)}function E(f,M){for(const se in f)M.call(void 0,f[se],se,f)}function A(f){const M={};for(const se in f)M[se]=f[se];return M}const T="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(f,M){let se,be;for(let Ve=1;Ve<arguments.length;Ve++){be=arguments[Ve];for(se in be)f[se]=be[se];for(let Qe=0;Qe<T.length;Qe++)se=T[Qe],Object.prototype.hasOwnProperty.call(be,se)&&(f[se]=be[se])}}function _(f){var M=1;f=f.split(":");const se=[];for(;0<M&&f.length;)se.push(f.shift()),M--;return f.length&&se.push(f.join(":")),se}function I(f){a.setTimeout(()=>{throw f},0)}function b(){var f=O;let M=null;return f.g&&(M=f.g,f.g=f.g.next,f.g||(f.h=null),M.next=null),M}class G{constructor(){this.h=this.g=null}add(M,se){const be=ie.get();be.set(M,se),this.h?this.h.next=be:this.g=be,this.h=be}}var ie=new x(()=>new F,f=>f.reset());class F{constructor(){this.next=this.g=this.h=null}set(M,se){this.h=M,this.g=se,this.next=null}reset(){this.next=this.g=this.h=null}}let W,z=!1,O=new G,k=()=>{const f=a.Promise.resolve(void 0);W=()=>{f.then(re)}};var re=()=>{for(var f;f=b();){try{f.h.call(f.g)}catch(se){I(se)}var M=ie;M.j(f),100>M.h&&(M.h++,f.next=M.g,M.g=f)}z=!1};function $(){this.s=this.s,this.C=this.C}$.prototype.s=!1,$.prototype.ma=function(){this.s||(this.s=!0,this.N())},$.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(f,M){this.type=f,this.g=this.target=M,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var H=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var f=!1,M=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const se=()=>{};a.addEventListener("test",se,M),a.removeEventListener("test",se,M)}catch{}return f}();function L(f,M){if(D.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var se=this.type=f.type,be=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=M,M=f.relatedTarget){if(Q){e:{try{X(M.nodeName);var Ve=!0;break e}catch{}Ve=!1}Ve||(M=null)}}else se=="mouseover"?M=f.fromElement:se=="mouseout"&&(M=f.toElement);this.relatedTarget=M,be?(this.clientX=be.clientX!==void 0?be.clientX:be.pageX,this.clientY=be.clientY!==void 0?be.clientY:be.pageY,this.screenX=be.screenX||0,this.screenY=be.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:j[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&L.aa.h.call(this)}}C(L,D);var j={2:"touch",3:"pen",4:"mouse"};L.prototype.h=function(){L.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var oe="closure_listenable_"+(1e6*Math.random()|0),K=0;function Z(f,M,se,be,Ve){this.listener=f,this.proxy=null,this.src=M,this.type=se,this.capture=!!be,this.ha=Ve,this.key=++K,this.da=this.fa=!1}function J(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function Y(f){this.src=f,this.g={},this.h=0}Y.prototype.add=function(f,M,se,be,Ve){var Qe=f.toString();f=this.g[Qe],f||(f=this.g[Qe]=[],this.h++);var It=ae(f,M,be,Ve);return-1<It?(M=f[It],se||(M.fa=!1)):(M=new Z(M,this.src,Qe,!!be,Ve),M.fa=se,f.push(M)),M};function U(f,M){var se=M.type;if(se in f.g){var be=f.g[se],Ve=Array.prototype.indexOf.call(be,M,void 0),Qe;(Qe=0<=Ve)&&Array.prototype.splice.call(be,Ve,1),Qe&&(J(M),f.g[se].length==0&&(delete f.g[se],f.h--))}}function ae(f,M,se,be){for(var Ve=0;Ve<f.length;++Ve){var Qe=f[Ve];if(!Qe.da&&Qe.listener==M&&Qe.capture==!!se&&Qe.ha==be)return Ve}return-1}var ue="closure_lm_"+(1e6*Math.random()|0),le={};function q(f,M,se,be,Ve){if(Array.isArray(M)){for(var Qe=0;Qe<M.length;Qe++)q(f,M[Qe],se,be,Ve);return null}return se=ke(se),f&&f[oe]?f.K(M,se,u(be)?!!be.capture:!1,Ve):ce(f,M,se,!1,be,Ve)}function ce(f,M,se,be,Ve,Qe){if(!M)throw Error("Invalid event type");var It=u(Ve)?!!Ve.capture:!!Ve,gr=ve(f);if(gr||(f[ue]=gr=new Y(f)),se=gr.add(M,se,be,It,Qe),se.proxy)return se;if(be=Se(),se.proxy=be,be.src=f,be.listener=se,f.addEventListener)H||(Ve=It),Ve===void 0&&(Ve=!1),f.addEventListener(M.toString(),be,Ve);else if(f.attachEvent)f.attachEvent(xe(M.toString()),be);else if(f.addListener&&f.removeListener)f.addListener(be);else throw Error("addEventListener and attachEvent are unavailable.");return se}function Se(){function f(se){return M.call(f.src,f.listener,se)}const M=he;return f}function me(f,M,se,be,Ve){if(Array.isArray(M))for(var Qe=0;Qe<M.length;Qe++)me(f,M[Qe],se,be,Ve);else be=u(be)?!!be.capture:!!be,se=ke(se),f&&f[oe]?(f=f.i,M=String(M).toString(),M in f.g&&(Qe=f.g[M],se=ae(Qe,se,be,Ve),-1<se&&(J(Qe[se]),Array.prototype.splice.call(Qe,se,1),Qe.length==0&&(delete f.g[M],f.h--)))):f&&(f=ve(f))&&(M=f.g[M.toString()],f=-1,M&&(f=ae(M,se,be,Ve)),(se=-1<f?M[f]:null)&&Pe(se))}function Pe(f){if(typeof f!="number"&&f&&!f.da){var M=f.src;if(M&&M[oe])U(M.i,f);else{var se=f.type,be=f.proxy;M.removeEventListener?M.removeEventListener(se,be,f.capture):M.detachEvent?M.detachEvent(xe(se),be):M.addListener&&M.removeListener&&M.removeListener(be),(se=ve(M))?(U(se,f),se.h==0&&(se.src=null,M[ue]=null)):J(f)}}}function xe(f){return f in le?le[f]:le[f]="on"+f}function he(f,M){if(f.da)f=!0;else{M=new L(M,this);var se=f.listener,be=f.ha||f.src;f.fa&&Pe(f),f=se.call(be,M)}return f}function ve(f){return f=f[ue],f instanceof Y?f:null}var De="__closure_events_fn_"+(1e9*Math.random()>>>0);function ke(f){return typeof f=="function"?f:(f[De]||(f[De]=function(M){return f.handleEvent(M)}),f[De])}function Ce(){$.call(this),this.i=new Y(this),this.M=this,this.F=null}C(Ce,$),Ce.prototype[oe]=!0,Ce.prototype.removeEventListener=function(f,M,se,be){me(this,f,M,se,be)};function Le(f,M){var se,be=f.F;if(be)for(se=[];be;be=be.F)se.push(be);if(f=f.M,be=M.type||M,typeof M=="string")M=new D(M,f);else if(M instanceof D)M.target=M.target||f;else{var Ve=M;M=new D(be,f),R(M,Ve)}if(Ve=!0,se)for(var Qe=se.length-1;0<=Qe;Qe--){var It=M.g=se[Qe];Ve=Ie(It,be,!0,M)&&Ve}if(It=M.g=f,Ve=Ie(It,be,!0,M)&&Ve,Ve=Ie(It,be,!1,M)&&Ve,se)for(Qe=0;Qe<se.length;Qe++)It=M.g=se[Qe],Ve=Ie(It,be,!1,M)&&Ve}Ce.prototype.N=function(){if(Ce.aa.N.call(this),this.i){var f=this.i,M;for(M in f.g){for(var se=f.g[M],be=0;be<se.length;be++)J(se[be]);delete f.g[M],f.h--}}this.F=null},Ce.prototype.K=function(f,M,se,be){return this.i.add(String(f),M,!1,se,be)},Ce.prototype.L=function(f,M,se,be){return this.i.add(String(f),M,!0,se,be)};function Ie(f,M,se,be){if(M=f.i.g[String(M)],!M)return!0;M=M.concat();for(var Ve=!0,Qe=0;Qe<M.length;++Qe){var It=M[Qe];if(It&&!It.da&&It.capture==se){var gr=It.listener,Nr=It.ha||It.src;It.fa&&U(f.i,It),Ve=gr.call(Nr,be)!==!1&&Ve}}return Ve&&!be.defaultPrevented}function Re(f,M,se){if(typeof f=="function")se&&(f=g(f,se));else if(f&&typeof f.handleEvent=="function")f=g(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(M)?-1:a.setTimeout(f,M||0)}function He(f){f.g=Re(()=>{f.g=null,f.i&&(f.i=!1,He(f))},f.l);const M=f.h;f.h=null,f.m.apply(null,M)}class Me extends ${constructor(M,se){super(),this.m=M,this.l=se,this.h=null,this.i=!1,this.g=null}j(M){this.h=arguments,this.g?this.i=!0:He(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ze(f){$.call(this),this.h=f,this.g={}}C(Ze,$);var Ye=[];function ut(f){ee(f.g,function(M,se){this.g.hasOwnProperty(se)&&Pe(M)},f),f.g={}}Ze.prototype.N=function(){Ze.aa.N.call(this),ut(this)},Ze.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var rt=a.JSON.stringify,We=a.JSON.parse,ct=class{stringify(f){return a.JSON.stringify(f,void 0)}parse(f){return a.JSON.parse(f,void 0)}};function pt(){}pt.prototype.h=null;function _t(f){return f.h||(f.h=f.i())}function Et(){}var et={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ue(){D.call(this,"d")}C(Ue,D);function ot(){D.call(this,"c")}C(ot,D);var Xe={},at=null;function St(){return at=at||new Ce}Xe.La="serverreachability";function $t(f){D.call(this,Xe.La,f)}C($t,D);function qt(f){const M=St();Le(M,new $t(M))}Xe.STAT_EVENT="statevent";function Gt(f,M){D.call(this,Xe.STAT_EVENT,f),this.stat=M}C(Gt,D);function ht(f){const M=St();Le(M,new Gt(M,f))}Xe.Ma="timingevent";function Kt(f,M){D.call(this,Xe.Ma,f),this.size=M}C(Kt,D);function Rt(f,M){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){f()},M)}function Qt(){this.g=!0}Qt.prototype.xa=function(){this.g=!1};function sr(f,M,se,be,Ve,Qe){f.info(function(){if(f.g)if(Qe)for(var It="",gr=Qe.split("&"),Nr=0;Nr<gr.length;Nr++){var vr=gr[Nr].split("=");if(1<vr.length){var Zr=vr[0];vr=vr[1];var un=Zr.split("_");It=2<=un.length&&un[1]=="type"?It+(Zr+"="+vr+"&"):It+(Zr+"=redacted&")}}else It=null;else It=Qe;return"XMLHTTP REQ ("+be+") [attempt "+Ve+"]: "+M+`
`+se+`
`+It})}function mt(f,M,se,be,Ve,Qe,It){f.info(function(){return"XMLHTTP RESP ("+be+") [ attempt "+Ve+"]: "+M+`
`+se+`
`+Qe+" "+It})}function At(f,M,se,be){f.info(function(){return"XMLHTTP TEXT ("+M+"): "+Jt(f,se)+(be?" "+be:"")})}function Ot(f,M){f.info(function(){return"TIMEOUT: "+M})}Qt.prototype.info=function(){};function Jt(f,M){if(!f.g)return M;if(!M)return null;try{var se=JSON.parse(M);if(se){for(f=0;f<se.length;f++)if(Array.isArray(se[f])){var be=se[f];if(!(2>be.length)){var Ve=be[1];if(Array.isArray(Ve)&&!(1>Ve.length)){var Qe=Ve[0];if(Qe!="noop"&&Qe!="stop"&&Qe!="close")for(var It=1;It<Ve.length;It++)Ve[It]=""}}}}return rt(se)}catch{return M}}var Zt={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ht={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},tt;function jt(){}C(jt,pt),jt.prototype.g=function(){return new XMLHttpRequest},jt.prototype.i=function(){return{}},tt=new jt;function yt(f,M,se,be){this.j=f,this.i=M,this.l=se,this.R=be||1,this.U=new Ze(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ar}function ar(){this.i=null,this.g="",this.h=!1}var Wr={},pr={};function wr(f,M,se){f.L=1,f.v=Yn(fr(M)),f.m=se,f.P=!0,$r(f,null)}function $r(f,M){f.F=Date.now(),tn(f),f.A=fr(f.v);var se=f.A,be=f.R;Array.isArray(be)||(be=[String(be)]),nr(se.i,"t",be),f.C=0,se=f.j.J,f.h=new ar,f.g=fe(f.j,se?M:null,!f.m),0<f.O&&(f.M=new Me(g(f.Y,f,f.g),f.O)),M=f.U,se=f.g,be=f.ca;var Ve="readystatechange";Array.isArray(Ve)||(Ve&&(Ye[0]=Ve.toString()),Ve=Ye);for(var Qe=0;Qe<Ve.length;Qe++){var It=q(se,Ve[Qe],be||M.handleEvent,!1,M.h||M);if(!It)break;M.g[It.key]=It}M=f.H?A(f.H):{},f.m?(f.u||(f.u="POST"),M["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,M)):(f.u="GET",f.g.ea(f.A,f.u,null,M)),qt(),sr(f.i,f.u,f.A,f.l,f.R,f.m)}yt.prototype.ca=function(f){f=f.target;const M=this.M;M&&zn(f)==3?M.j():this.Y(f)},yt.prototype.Y=function(f){try{if(f==this.g)e:{const un=zn(this.g);var M=this.g.Ba();const xo=this.g.Z();if(!(3>un)&&(un!=3||this.g&&(this.h.h||this.g.oa()||Ll(this.g)))){this.J||un!=4||M==7||(M==8||0>=xo?qt(3):qt(2)),Sr(this);var se=this.g.Z();this.X=se;t:if(lr(this)){var be=Ll(this.g);f="";var Ve=be.length,Qe=zn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){jr(this),Cr(this);var It="";break t}this.h.i=new a.TextDecoder}for(M=0;M<Ve;M++)this.h.h=!0,f+=this.h.i.decode(be[M],{stream:!(Qe&&M==Ve-1)});be.length=0,this.h.g+=f,this.C=0,It=this.h.g}else It=this.g.oa();if(this.o=se==200,mt(this.i,this.u,this.A,this.l,this.R,un,se),this.o){if(this.T&&!this.K){t:{if(this.g){var gr,Nr=this.g;if((gr=Nr.g?Nr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!V(gr)){var vr=gr;break t}}vr=null}if(se=vr)At(this.i,this.l,se,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,kr(this,se);else{this.o=!1,this.s=3,ht(12),jr(this),Cr(this);break e}}if(this.P){se=!0;let ni;for(;!this.J&&this.C<It.length;)if(ni=Br(this,It),ni==pr){un==4&&(this.s=4,ht(14),se=!1),At(this.i,this.l,null,"[Incomplete Response]");break}else if(ni==Wr){this.s=4,ht(15),At(this.i,this.l,It,"[Invalid Chunk]"),se=!1;break}else At(this.i,this.l,ni,null),kr(this,ni);if(lr(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),un!=4||It.length!=0||this.h.h||(this.s=1,ht(16),se=!1),this.o=this.o&&se,!se)At(this.i,this.l,It,"[Invalid Chunked Response]"),jr(this),Cr(this);else if(0<It.length&&!this.W){this.W=!0;var Zr=this.j;Zr.g==this&&Zr.ba&&!Zr.M&&(Zr.j.info("Great, no buffering proxy detected. Bytes received: "+It.length),Ks(Zr),Zr.M=!0,ht(11))}}else At(this.i,this.l,It,null),kr(this,It);un==4&&jr(this),this.o&&!this.J&&(un==4?qo(this.j,this):(this.o=!1,tn(this)))}else jo(this.g),se==400&&0<It.indexOf("Unknown SID")?(this.s=3,ht(12)):(this.s=0,ht(13)),jr(this),Cr(this)}}}catch{}finally{}};function lr(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function Br(f,M){var se=f.C,be=M.indexOf(`
`,se);return be==-1?pr:(se=Number(M.substring(se,be)),isNaN(se)?Wr:(be+=1,be+se>M.length?pr:(M=M.slice(be,be+se),f.C=be+se,M)))}yt.prototype.cancel=function(){this.J=!0,jr(this)};function tn(f){f.S=Date.now()+f.I,kt(f,f.I)}function kt(f,M){if(f.B!=null)throw Error("WatchDog timer not null");f.B=Rt(g(f.ba,f),M)}function Sr(f){f.B&&(a.clearTimeout(f.B),f.B=null)}yt.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(Ot(this.i,this.A),this.L!=2&&(qt(),ht(17)),jr(this),this.s=2,Cr(this)):kt(this,this.S-f)};function Cr(f){f.j.G==0||f.J||qo(f.j,f)}function jr(f){Sr(f);var M=f.M;M&&typeof M.ma=="function"&&M.ma(),f.M=null,ut(f.U),f.g&&(M=f.g,f.g=null,M.abort(),M.ma())}function kr(f,M){try{var se=f.j;if(se.G!=0&&(se.g==f||_n(se.h,f))){if(!f.K&&_n(se.h,f)&&se.G==3){try{var be=se.Da.g.parse(M)}catch{be=null}if(Array.isArray(be)&&be.length==3){var Ve=be;if(Ve[0]==0){e:if(!se.u){if(se.g)if(se.g.F+3e3<f.F)Po(se),Hs(se);else break e;fs(se),ht(18)}}else se.za=Ve[1],0<se.za-se.T&&37500>Ve[2]&&se.F&&se.v==0&&!se.C&&(se.C=Rt(g(se.Za,se),6e3));if(1>=ln(se.h)&&se.ca){try{se.ca()}catch{}se.ca=void 0}}else fi(se,11)}else if((f.K||se.g==f)&&Po(se),!V(M))for(Ve=se.Da.g.parse(M),M=0;M<Ve.length;M++){let vr=Ve[M];if(se.T=vr[0],vr=vr[1],se.G==2)if(vr[0]=="c"){se.K=vr[1],se.ia=vr[2];const Zr=vr[3];Zr!=null&&(se.la=Zr,se.j.info("VER="+se.la));const un=vr[4];un!=null&&(se.Aa=un,se.j.info("SVER="+se.Aa));const xo=vr[5];xo!=null&&typeof xo=="number"&&0<xo&&(be=1.5*xo,se.L=be,se.j.info("backChannelRequestTimeoutMs_="+be)),be=se;const ni=f.g;if(ni){const zo=ni.g?ni.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(zo){var Qe=be.h;Qe.g||zo.indexOf("spdy")==-1&&zo.indexOf("quic")==-1&&zo.indexOf("h2")==-1||(Qe.j=Qe.l,Qe.g=new Set,Qe.h&&(Ir(Qe,Qe.h),Qe.h=null))}if(be.D){const Uo=ni.g?ni.g.getResponseHeader("X-HTTP-Session-Id"):null;Uo&&(be.ya=Uo,Pr(be.I,be.D,Uo))}}se.G=3,se.l&&se.l.ua(),se.ba&&(se.R=Date.now()-f.F,se.j.info("Handshake RTT: "+se.R+"ms")),be=se;var It=f;if(be.qa=P(be,be.J?be.ia:null,be.W),It.K){wn(be.h,It);var gr=It,Nr=be.L;Nr&&(gr.I=Nr),gr.B&&(Sr(gr),tn(gr)),be.g=It}else Ys(be);0<se.i.length&&Ws(se)}else vr[0]!="stop"&&vr[0]!="close"||fi(se,7);else se.G==3&&(vr[0]=="stop"||vr[0]=="close"?vr[0]=="stop"?fi(se,7):So(se):vr[0]!="noop"&&se.l&&se.l.ta(vr),se.v=0)}}qt(4)}catch{}}var Yr=class{constructor(f,M){this.g=f,this.map=M}};function rn(f){this.l=f||10,a.PerformanceNavigationTiming?(f=a.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function yr(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function ln(f){return f.h?1:f.g?f.g.size:0}function _n(f,M){return f.h?f.h==M:f.g?f.g.has(M):!1}function Ir(f,M){f.g?f.g.add(M):f.h=M}function wn(f,M){f.h&&f.h==M?f.h=null:f.g&&f.g.has(M)&&f.g.delete(M)}rn.prototype.cancel=function(){if(this.i=Cn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function Cn(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let M=f.i;for(const se of f.g.values())M=M.concat(se.D);return M}return S(f.i)}function Li(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(c(f)){for(var M=[],se=f.length,be=0;be<se;be++)M.push(f[be]);return M}M=[],se=0;for(be in f)M[se++]=f[be];return M}function tr(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(c(f)||typeof f=="string"){var M=[];f=f.length;for(var se=0;se<f;se++)M.push(se);return M}M=[],se=0;for(const be in f)M[se++]=be;return M}}}function Tr(f,M){if(f.forEach&&typeof f.forEach=="function")f.forEach(M,void 0);else if(c(f)||typeof f=="string")Array.prototype.forEach.call(f,M,void 0);else for(var se=tr(f),be=Li(f),Ve=be.length,Qe=0;Qe<Ve;Qe++)M.call(void 0,be[Qe],se&&se[Qe],f)}var qr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function bt(f,M){if(f){f=f.split("&");for(var se=0;se<f.length;se++){var be=f[se].indexOf("="),Ve=null;if(0<=be){var Qe=f[se].substring(0,be);Ve=f[se].substring(be+1)}else Qe=f[se];M(Qe,Ve?decodeURIComponent(Ve.replace(/\+/g," ")):"")}}}function rr(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof rr){this.h=f.h,Gr(this,f.j),this.o=f.o,this.g=f.g,Fr(this,f.s),this.l=f.l;var M=f.i,se=new no;se.i=M.i,M.g&&(se.g=new Map(M.g),se.h=M.h),pn(this,se),this.m=f.m}else f&&(M=String(f).match(qr))?(this.h=!1,Gr(this,M[1]||"",!0),this.o=Pn(M[2]||""),this.g=Pn(M[3]||"",!0),Fr(this,M[4]),this.l=Pn(M[5]||"",!0),pn(this,M[6]||"",!0),this.m=Pn(M[7]||"")):(this.h=!1,this.i=new no(null,this.h))}rr.prototype.toString=function(){var f=[],M=this.j;M&&f.push(Zn(M,hi,!0),":");var se=this.g;return(se||M=="file")&&(f.push("//"),(M=this.o)&&f.push(Zn(M,hi,!0),"@"),f.push(encodeURIComponent(String(se)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),se=this.s,se!=null&&f.push(":",String(se))),(se=this.l)&&(this.g&&se.charAt(0)!="/"&&f.push("/"),f.push(Zn(se,se.charAt(0)=="/"?In:ei,!0))),(se=this.i.toString())&&f.push("?",se),(se=this.m)&&f.push("#",Zn(se,Di)),f.join("")};function fr(f){return new rr(f)}function Gr(f,M,se){f.j=se?Pn(M,!0):M,f.j&&(f.j=f.j.replace(/:$/,""))}function Fr(f,M){if(M){if(M=Number(M),isNaN(M)||0>M)throw Error("Bad port number "+M);f.s=M}else f.s=null}function pn(f,M,se){M instanceof no?(f.i=M,qa(f.i,f.h)):(se||(M=Zn(M,ti)),f.i=new no(M,f.h))}function Pr(f,M,se){f.i.set(M,se)}function Yn(f){return Pr(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function Pn(f,M){return f?M?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function Zn(f,M,se){return typeof f=="string"?(f=encodeURI(f).replace(M,Wi),se&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function Wi(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var hi=/[#\/\?@]/g,ei=/[#\?:]/g,In=/[#\?]/g,ti=/[#\?@]/g,Di=/#/g;function no(f,M){this.h=this.g=null,this.i=f||null,this.j=!!M}function cn(f){f.g||(f.g=new Map,f.h=0,f.i&&bt(f.i,function(M,se){f.add(decodeURIComponent(M.replace(/\+/g," ")),se)}))}t=no.prototype,t.add=function(f,M){cn(this),this.i=null,f=io(this,f);var se=this.g.get(f);return se||this.g.set(f,se=[]),se.push(M),this.h+=1,this};function js(f,M){cn(f),M=io(f,M),f.g.has(M)&&(f.i=null,f.h-=f.g.get(M).length,f.g.delete(M))}function bo(f,M){return cn(f),M=io(f,M),f.g.has(M)}t.forEach=function(f,M){cn(this),this.g.forEach(function(se,be){se.forEach(function(Ve){f.call(M,Ve,be,this)},this)},this)},t.na=function(){cn(this);const f=Array.from(this.g.values()),M=Array.from(this.g.keys()),se=[];for(let be=0;be<M.length;be++){const Ve=f[be];for(let Qe=0;Qe<Ve.length;Qe++)se.push(M[be])}return se},t.V=function(f){cn(this);let M=[];if(typeof f=="string")bo(this,f)&&(M=M.concat(this.g.get(io(this,f))));else{f=Array.from(this.g.values());for(let se=0;se<f.length;se++)M=M.concat(f[se])}return M},t.set=function(f,M){return cn(this),this.i=null,f=io(this,f),bo(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[M]),this.h+=1,this},t.get=function(f,M){return f?(f=this.V(f),0<f.length?String(f[0]):M):M};function nr(f,M,se){js(f,M),0<se.length&&(f.i=null,f.g.set(io(f,M),S(se)),f.h+=se.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],M=Array.from(this.g.keys());for(var se=0;se<M.length;se++){var be=M[se];const Qe=encodeURIComponent(String(be)),It=this.V(be);for(be=0;be<It.length;be++){var Ve=Qe;It[be]!==""&&(Ve+="="+encodeURIComponent(String(It[be]))),f.push(Ve)}}return this.i=f.join("&")};function io(f,M){return M=String(M),f.j&&(M=M.toLowerCase()),M}function qa(f,M){M&&!f.j&&(cn(f),f.i=null,f.g.forEach(function(se,be){var Ve=be.toLowerCase();be!=Ve&&(js(this,be),nr(this,Ve,se))},f)),f.j=M}function Ri(f,M){const se=new Qt;if(a.Image){const be=new Image;be.onload=p(Ii,se,"TestLoadImage: loaded",!0,M,be),be.onerror=p(Ii,se,"TestLoadImage: error",!1,M,be),be.onabort=p(Ii,se,"TestLoadImage: abort",!1,M,be),be.ontimeout=p(Ii,se,"TestLoadImage: timeout",!1,M,be),a.setTimeout(function(){be.ontimeout&&be.ontimeout()},1e4),be.src=f}else M(!1)}function Vs(f,M){const se=new Qt,be=new AbortController,Ve=setTimeout(()=>{be.abort(),Ii(se,"TestPingServer: timeout",!1,M)},1e4);fetch(f,{signal:be.signal}).then(Qe=>{clearTimeout(Ve),Qe.ok?Ii(se,"TestPingServer: ok",!0,M):Ii(se,"TestPingServer: server error",!1,M)}).catch(()=>{clearTimeout(Ve),Ii(se,"TestPingServer: error",!1,M)})}function Ii(f,M,se,be,Ve){try{Ve&&(Ve.onload=null,Ve.onerror=null,Ve.onabort=null,Ve.ontimeout=null),be(se)}catch{}}function Oo(){this.g=new ct}function cs(f,M,se){const be=se||"";try{Tr(f,function(Ve,Qe){let It=Ve;u(Ve)&&(It=rt(Ve)),M.push(be+Qe+"="+encodeURIComponent(It))})}catch(Ve){throw M.push(be+"type="+encodeURIComponent("_badmap")),Ve}}function Bo(f){this.l=f.Ub||null,this.j=f.eb||!1}C(Bo,pt),Bo.prototype.g=function(){return new qs(this.l,this.j)},Bo.prototype.i=function(f){return function(){return f}}({});function qs(f,M){Ce.call(this),this.D=f,this.o=M,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}C(qs,Ce),t=qs.prototype,t.open=function(f,M){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=M,this.readyState=1,Gi(this)},t.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const M={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(M.body=f),(this.D||a).fetch(new Request(this.A,M)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,_o(this)),this.readyState=0},t.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,Gi(this)),this.g&&(this.readyState=3,Gi(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Nl(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function Nl(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}t.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var M=f.value?f.value:new Uint8Array(0);(M=this.v.decode(M,{stream:!f.done}))&&(this.response=this.responseText+=M)}f.done?_o(this):Gi(this),this.readyState==3&&Nl(this)}},t.Ra=function(f){this.g&&(this.response=this.responseText=f,_o(this))},t.Qa=function(f){this.g&&(this.response=f,_o(this))},t.ga=function(){this.g&&_o(this)};function _o(f){f.readyState=4,f.l=null,f.j=null,f.v=null,Gi(f)}t.setRequestHeader=function(f,M){this.u.append(f,M)},t.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],M=this.h.entries();for(var se=M.next();!se.done;)se=se.value,f.push(se[0]+": "+se[1]),se=M.next();return f.join(`\r
`)};function Gi(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(qs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function wo(f){let M="";return ee(f,function(se,be){M+=be,M+=":",M+=se,M+=`\r
`}),M}function za(f,M,se){e:{for(be in se){var be=!1;break e}be=!0}be||(se=wo(se),typeof f=="string"?se!=null&&encodeURIComponent(String(se)):Pr(f,M,se))}function Xr(f){Ce.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}C(Xr,Ce);var Ua=/^https?$/i,zs=["POST","PUT"];t=Xr.prototype,t.Ha=function(f){this.J=f},t.ea=function(f,M,se,be){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);M=M?M.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():tt.g(),this.v=this.o?_t(this.o):_t(tt),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(M,String(f),!0),this.B=!1}catch(Qe){Ha(this,Qe);return}if(f=se||"",se=new Map(this.headers),be)if(Object.getPrototypeOf(be)===Object.prototype)for(var Ve in be)se.set(Ve,be[Ve]);else if(typeof be.keys=="function"&&typeof be.get=="function")for(const Qe of be.keys())se.set(Qe,be.get(Qe));else throw Error("Unknown input type for opt_headers: "+String(be));be=Array.from(se.keys()).find(Qe=>Qe.toLowerCase()=="content-type"),Ve=a.FormData&&f instanceof a.FormData,!(0<=Array.prototype.indexOf.call(zs,M,void 0))||be||Ve||se.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Qe,It]of se)this.g.setRequestHeader(Qe,It);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Yi(this),this.u=!0,this.g.send(f),this.u=!1}catch(Qe){Ha(this,Qe)}};function Ha(f,M){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=M,f.m=5,Wa(f),us(f)}function Wa(f){f.A||(f.A=!0,Le(f,"complete"),Le(f,"error"))}t.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,Le(this,"complete"),Le(this,"abort"),us(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),us(this,!0)),Xr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Ga(this):this.bb())},t.bb=function(){Ga(this)};function Ga(f){if(f.h&&typeof s<"u"&&(!f.v[1]||zn(f)!=4||f.Z()!=2)){if(f.u&&zn(f)==4)Re(f.Ea,0,f);else if(Le(f,"readystatechange"),zn(f)==4){f.h=!1;try{const It=f.Z();e:switch(It){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var M=!0;break e;default:M=!1}var se;if(!(se=M)){var be;if(be=It===0){var Ve=String(f.D).match(qr)[1]||null;!Ve&&a.self&&a.self.location&&(Ve=a.self.location.protocol.slice(0,-1)),be=!Ua.test(Ve?Ve.toLowerCase():"")}se=be}if(se)Le(f,"complete"),Le(f,"success");else{f.m=6;try{var Qe=2<zn(f)?f.g.statusText:""}catch{Qe=""}f.l=Qe+" ["+f.Z()+"]",Wa(f)}}finally{us(f)}}}}function us(f,M){if(f.g){Yi(f);const se=f.g,be=f.v[0]?()=>{}:null;f.g=null,f.v=null,M||Le(f,"ready");try{se.onreadystatechange=be}catch{}}}function Yi(f){f.I&&(a.clearTimeout(f.I),f.I=null)}t.isActive=function(){return!!this.g};function zn(f){return f.g?f.g.readyState:0}t.Z=function(){try{return 2<zn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(f){if(this.g){var M=this.g.responseText;return f&&M.indexOf(f)==0&&(M=M.substring(f.length)),We(M)}};function Ll(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function jo(f){const M={};f=(f.g&&2<=zn(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let be=0;be<f.length;be++){if(V(f[be]))continue;var se=_(f[be]);const Ve=se[0];if(se=se[1],typeof se!="string")continue;se=se.trim();const Qe=M[Ve]||[];M[Ve]=Qe,Qe.push(se)}E(M,function(be){return be.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ri(f,M,se){return se&&se.internalChannelParams&&se.internalChannelParams[f]||M}function Us(f){this.Aa=0,this.i=[],this.j=new Qt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ri("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ri("baseRetryDelayMs",5e3,f),this.cb=ri("retryDelaySeedMs",1e4,f),this.Wa=ri("forwardChannelMaxRetries",2,f),this.wa=ri("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new rn(f&&f.concurrentRequestLimit),this.Da=new Oo,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Us.prototype,t.la=8,t.G=1,t.connect=function(f,M,se,be){ht(0),this.W=f,this.H=M||{},se&&be!==void 0&&(this.H.OSID=se,this.H.OAID=be),this.F=this.X,this.I=P(this,null,this.W),Ws(this)};function So(f){if(ds(f),f.G==3){var M=f.U++,se=fr(f.I);if(Pr(se,"SID",f.K),Pr(se,"RID",M),Pr(se,"TYPE","terminate"),Vo(f,se),M=new yt(f,f.j,M),M.L=2,M.v=Yn(fr(se)),se=!1,a.navigator&&a.navigator.sendBeacon)try{se=a.navigator.sendBeacon(M.v.toString(),"")}catch{}!se&&a.Image&&(new Image().src=M.v,se=!0),se||(M.g=fe(M.j,null),M.g.ea(M.v)),M.F=Date.now(),tn(M)}Qs(f)}function Hs(f){f.g&&(Ks(f),f.g.cancel(),f.g=null)}function ds(f){Hs(f),f.u&&(a.clearTimeout(f.u),f.u=null),Po(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&a.clearTimeout(f.s),f.s=null)}function Ws(f){if(!yr(f.h)&&!f.s){f.s=!0;var M=f.Ga;W||k(),z||(W(),z=!0),O.add(M,f),f.B=0}}function Ya(f,M){return ln(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=M.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=Rt(g(f.Ga,f,M),Js(f,f.B)),f.B++,!0)}t.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const Ve=new yt(this,this.j,f);let Qe=this.o;if(this.S&&(Qe?(Qe=A(Qe),R(Qe,this.S)):Qe=this.S),this.m!==null||this.O||(Ve.H=Qe,Qe=null),this.P)e:{for(var M=0,se=0;se<this.i.length;se++){t:{var be=this.i[se];if("__data__"in be.map&&(be=be.map.__data__,typeof be=="string")){be=be.length;break t}be=void 0}if(be===void 0)break;if(M+=be,4096<M){M=se;break e}if(M===4096||se===this.i.length-1){M=se+1;break e}}M=1e3}else M=1e3;M=hs(this,Ve,M),se=fr(this.I),Pr(se,"RID",f),Pr(se,"CVER",22),this.D&&Pr(se,"X-HTTP-Session-Id",this.D),Vo(this,se),Qe&&(this.O?M="headers="+encodeURIComponent(String(wo(Qe)))+"&"+M:this.m&&za(se,this.m,Qe)),Ir(this.h,Ve),this.Ua&&Pr(se,"TYPE","init"),this.P?(Pr(se,"$req",M),Pr(se,"SID","null"),Ve.T=!0,wr(Ve,se,null)):wr(Ve,se,M),this.G=2}}else this.G==3&&(f?Gs(this,f):this.i.length==0||yr(this.h)||Gs(this))};function Gs(f,M){var se;M?se=M.l:se=f.U++;const be=fr(f.I);Pr(be,"SID",f.K),Pr(be,"RID",se),Pr(be,"AID",f.T),Vo(f,be),f.m&&f.o&&za(be,f.m,f.o),se=new yt(f,f.j,se,f.B+1),f.m===null&&(se.H=f.o),M&&(f.i=M.D.concat(f.i)),M=hs(f,se,1e3),se.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),Ir(f.h,se),wr(se,be,M)}function Vo(f,M){f.H&&ee(f.H,function(se,be){Pr(M,be,se)}),f.l&&Tr({},function(se,be){Pr(M,be,se)})}function hs(f,M,se){se=Math.min(f.i.length,se);var be=f.l?g(f.l.Na,f.l,f):null;e:{var Ve=f.i;let Qe=-1;for(;;){const It=["count="+se];Qe==-1?0<se?(Qe=Ve[0].g,It.push("ofs="+Qe)):Qe=0:It.push("ofs="+Qe);let gr=!0;for(let Nr=0;Nr<se;Nr++){let vr=Ve[Nr].g;const Zr=Ve[Nr].map;if(vr-=Qe,0>vr)Qe=Math.max(0,Ve[Nr].g-100),gr=!1;else try{cs(Zr,It,"req"+vr+"_")}catch{be&&be(Zr)}}if(gr){be=It.join("&");break e}}}return f=f.i.splice(0,se),M.D=f,be}function Ys(f){if(!f.g&&!f.u){f.Y=1;var M=f.Fa;W||k(),z||(W(),z=!0),O.add(M,f),f.v=0}}function fs(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=Rt(g(f.Fa,f),Js(f,f.v)),f.v++,!0)}t.Fa=function(){if(this.u=null,Dl(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=Rt(g(this.ab,this),f)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ht(10),Hs(this),Dl(this))};function Ks(f){f.A!=null&&(a.clearTimeout(f.A),f.A=null)}function Dl(f){f.g=new yt(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var M=fr(f.qa);Pr(M,"RID","rpc"),Pr(M,"SID",f.K),Pr(M,"AID",f.T),Pr(M,"CI",f.F?"0":"1"),!f.F&&f.ja&&Pr(M,"TO",f.ja),Pr(M,"TYPE","xmlhttp"),Vo(f,M),f.m&&f.o&&za(M,f.m,f.o),f.L&&(f.g.I=f.L);var se=f.g;f=f.ia,se.L=1,se.v=Yn(fr(M)),se.m=null,se.P=!0,$r(se,f)}t.Za=function(){this.C!=null&&(this.C=null,Hs(this),fs(this),ht(19))};function Po(f){f.C!=null&&(a.clearTimeout(f.C),f.C=null)}function qo(f,M){var se=null;if(f.g==M){Po(f),Ks(f),f.g=null;var be=2}else if(_n(f.h,M))se=M.D,wn(f.h,M),be=1;else return;if(f.G!=0){if(M.o)if(be==1){se=M.m?M.m.length:0,M=Date.now()-M.F;var Ve=f.B;be=St(),Le(be,new Kt(be,se)),Ws(f)}else Ys(f);else if(Ve=M.s,Ve==3||Ve==0&&0<M.X||!(be==1&&Ya(f,M)||be==2&&fs(f)))switch(se&&0<se.length&&(M=f.h,M.i=M.i.concat(se)),Ve){case 1:fi(f,5);break;case 4:fi(f,10);break;case 3:fi(f,6);break;default:fi(f,2)}}}function Js(f,M){let se=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(se*=2),se*M}function fi(f,M){if(f.j.info("Error code "+M),M==2){var se=g(f.fb,f),be=f.Xa;const Ve=!be;be=new rr(be||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Gr(be,"https"),Yn(be),Ve?Ri(be.toString(),se):Vs(be.toString(),se)}else ht(2);f.G=0,f.l&&f.l.sa(M),Qs(f),ds(f)}t.fb=function(f){f?(this.j.info("Successfully pinged google.com"),ht(2)):(this.j.info("Failed to ping google.com"),ht(1))};function Qs(f){if(f.G=0,f.ka=[],f.l){const M=Cn(f.h);(M.length!=0||f.i.length!=0)&&(w(f.ka,M),w(f.ka,f.i),f.h.i.length=0,S(f.i),f.i.length=0),f.l.ra()}}function P(f,M,se){var be=se instanceof rr?fr(se):new rr(se);if(be.g!="")M&&(be.g=M+"."+be.g),Fr(be,be.s);else{var Ve=a.location;be=Ve.protocol,M=M?M+"."+Ve.hostname:Ve.hostname,Ve=+Ve.port;var Qe=new rr(null);be&&Gr(Qe,be),M&&(Qe.g=M),Ve&&Fr(Qe,Ve),se&&(Qe.l=se),be=Qe}return se=f.D,M=f.ya,se&&M&&Pr(be,se,M),Pr(be,"VER",f.la),Vo(f,be),be}function fe(f,M,se){if(M&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return M=f.Ca&&!f.pa?new Xr(new Bo({eb:se})):new Xr(f.pa),M.Ha(f.J),M}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ne(){}t=Ne.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Fe(){}Fe.prototype.g=function(f,M){return new qe(f,M)};function qe(f,M){Ce.call(this),this.g=new Us(M),this.l=f,this.h=M&&M.messageUrlParams||null,f=M&&M.messageHeaders||null,M&&M.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=M&&M.initMessageHeaders||null,M&&M.messageContentType&&(f?f["X-WebChannel-Content-Type"]=M.messageContentType:f={"X-WebChannel-Content-Type":M.messageContentType}),M&&M.va&&(f?f["X-WebChannel-Client-Profile"]=M.va:f={"X-WebChannel-Client-Profile":M.va}),this.g.S=f,(f=M&&M.Sb)&&!V(f)&&(this.g.m=f),this.v=M&&M.supportsCrossDomainXhr||!1,this.u=M&&M.sendRawJson||!1,(M=M&&M.httpSessionIdParam)&&!V(M)&&(this.g.D=M,f=this.h,f!==null&&M in f&&(f=this.h,M in f&&delete f[M])),this.j=new Dt(this)}C(qe,Ce),qe.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},qe.prototype.close=function(){So(this.g)},qe.prototype.o=function(f){var M=this.g;if(typeof f=="string"){var se={};se.__data__=f,f=se}else this.u&&(se={},se.__data__=rt(f),f=se);M.i.push(new Yr(M.Ya++,f)),M.G==3&&Ws(M)},qe.prototype.N=function(){this.g.l=null,delete this.j,So(this.g),delete this.g,qe.aa.N.call(this)};function it(f){Ue.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var M=f.__sm__;if(M){e:{for(const se in M){f=se;break e}f=void 0}(this.i=f)&&(f=this.i,M=M!==null&&f in M?M[f]:void 0),this.data=M}else this.data=f}C(it,Ue);function Ct(){ot.call(this),this.status=1}C(Ct,ot);function Dt(f){this.g=f}C(Dt,Ne),Dt.prototype.ua=function(){Le(this.g,"a")},Dt.prototype.ta=function(f){Le(this.g,new it(f))},Dt.prototype.sa=function(f){Le(this.g,new Ct)},Dt.prototype.ra=function(){Le(this.g,"b")},Fe.prototype.createWebChannel=Fe.prototype.g,qe.prototype.send=qe.prototype.o,qe.prototype.open=qe.prototype.m,qe.prototype.close=qe.prototype.close,Vb=function(){return new Fe},jb=function(){return St()},Bb=Xe,Hp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Zt.NO_ERROR=0,Zt.TIMEOUT=8,Zt.HTTP_ERROR=6,eh=Zt,Ht.COMPLETE="complete",Ob=Ht,Et.EventType=et,et.OPEN="a",et.CLOSE="b",et.ERROR="c",et.MESSAGE="d",Ce.prototype.listen=Ce.prototype.K,nu=Et,Xr.prototype.listenOnce=Xr.prototype.L,Xr.prototype.getLastError=Xr.prototype.Ka,Xr.prototype.getLastErrorCode=Xr.prototype.Ba,Xr.prototype.getStatus=Xr.prototype.Z,Xr.prototype.getResponseJson=Xr.prototype.Oa,Xr.prototype.getResponseText=Xr.prototype.oa,Xr.prototype.send=Xr.prototype.ea,Xr.prototype.setWithCredentials=Xr.prototype.Ha,Fb=Xr}).apply(typeof Id<"u"?Id:typeof self<"u"?self:typeof window<"u"?window:{});const Zg="@firebase/firestore",ev="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}_i.UNAUTHENTICATED=new _i(null),_i.GOOGLE_CREDENTIALS=new _i("google-credentials-uid"),_i.FIRST_PARTY=new _i("first-party-uid"),_i.MOCK_USER=new _i("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ic="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Al=new Mm("@firebase/firestore");function rc(){return Al.logLevel}function zt(t,...e){if(Al.logLevel<=Dr.DEBUG){const r=e.map(Km);Al.debug(`Firestore (${Ic}): ${t}`,...r)}}function Rs(t,...e){if(Al.logLevel<=Dr.ERROR){const r=e.map(Km);Al.error(`Firestore (${Ic}): ${t}`,...r)}}function gc(t,...e){if(Al.logLevel<=Dr.WARN){const r=e.map(Km);Al.warn(`Firestore (${Ic}): ${t}`,...r)}}function Km(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ur(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,qb(t,n,r)}function qb(t,e,r){let n=`FIRESTORE (${Ic}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Rs(n),new Error(n)}function en(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||qb(e,i,n)}function _r(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Bt extends Bs{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zb{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class eC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(_i.UNAUTHENTICATED))}shutdown(){}}class tC{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class rC{constructor(e){this.t=e,this.currentUser=_i.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){en(this.o===void 0,42304);let n=this.i;const i=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let o=new Ns;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Ns,e.enqueueRetryable(()=>i(this.currentUser))};const s=()=>{const c=o;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},a=c=>{zt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(zt("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Ns)}},0),s()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(zt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(en(typeof n.accessToken=="string",31837,{l:n}),new zb(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return en(e===null||typeof e=="string",2055,{h:e}),new _i(e)}}class nC{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=_i.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class iC{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new nC(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(_i.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class tv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class oC{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,yo(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){en(this.o===void 0,3512);const n=o=>{o.error!=null&&zt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const s=o.token!==this.m;return this.m=o.token,zt("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?r(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>n(o))};const i=o=>{zt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):zt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new tv(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(en(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new tv(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sC(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jm{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=sC(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<r&&(n+=e.charAt(i[o]%62))}return n}}function Rr(t,e){return t<e?-1:t>e?1:0}function Wp(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const i=t.charAt(n),o=e.charAt(n);if(i!==o)return zf(i)===zf(o)?Rr(i,o):zf(i)?1:-1}return Rr(t.length,e.length)}const aC=55296,lC=57343;function zf(t){const e=t.charCodeAt(0);return e>=aC&&e<=lC}function vc(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rv="__name__";class Ko{constructor(e,r,n){r===void 0?r=0:r>e.length&&ur(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&ur(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Ko.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Ko?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const o=Ko.compareSegments(e.get(i),r.get(i));if(o!==0)return o}return Rr(e.length,r.length)}static compareSegments(e,r){const n=Ko.isNumericId(e),i=Ko.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?Ko.extractNumericId(e).compare(Ko.extractNumericId(r)):Wp(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ia.fromString(e.substring(4,e.length-2))}}class gn extends Ko{construct(e,r,n){return new gn(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Bt(dt.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new gn(r)}static emptyPath(){return new gn([])}}const cC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ai extends Ko{construct(e,r,n){return new ai(e,r,n)}static isValidIdentifier(e){return cC.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ai.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===rv}static keyField(){return new ai([rv])}static fromServerFormat(e){const r=[];let n="",i=0;const o=()=>{if(n.length===0)throw new Bt(dt.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let s=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new Bt(dt.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Bt(dt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else a==="`"?(s=!s,i++):a!=="."||s?(n+=a,i++):(o(),i++)}if(o(),s)throw new Bt(dt.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ai(r)}static emptyPath(){return new ai([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e){this.path=e}static fromPath(e){return new Xt(gn.fromString(e))}static fromName(e){return new Xt(gn.fromString(e).popFirst(5))}static empty(){return new Xt(gn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&gn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return gn.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Xt(new gn(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ub(t,e,r){if(!r)throw new Bt(dt.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function uC(t,e,r,n){if(e===!0&&n===!0)throw new Bt(dt.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function nv(t){if(!Xt.isDocumentKey(t))throw new Bt(dt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function iv(t){if(Xt.isDocumentKey(t))throw new Bt(dt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Hb(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Gh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ur(12329,{type:typeof t})}function Ms(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Bt(dt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Gh(t);throw new Bt(dt.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qn(t,e){const r={typeString:t};return e&&(r.value=e),r}function Yu(t,e){if(!Hb(t))throw new Bt(dt.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const s=t[n];if(i&&typeof s!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(o!==void 0&&s!==o.value){r=`Expected '${n}' field to equal '${o.value}'`;break}}if(r)throw new Bt(dt.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ov=-62135596800,sv=1e6;class vn{static now(){return vn.fromMillis(Date.now())}static fromDate(e){return vn.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*sv);return new vn(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Bt(dt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Bt(dt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<ov)throw new Bt(dt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Bt(dt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/sv}_compareTo(e){return this.seconds===e.seconds?Rr(this.nanoseconds,e.nanoseconds):Rr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:vn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Yu(e,vn._jsonSchema))return new vn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-ov;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}vn._jsonSchemaVersion="firestore/timestamp/1.0",vn._jsonSchema={type:qn("string",vn._jsonSchemaVersion),seconds:qn("number"),nanoseconds:qn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr{static fromTimestamp(e){return new mr(e)}static min(){return new mr(new vn(0,0))}static max(){return new mr(new vn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tu=-1;function dC(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=mr.fromTimestamp(n===1e9?new vn(r+1,0):new vn(r,n));return new ka(i,Xt.empty(),e)}function hC(t){return new ka(t.readTime,t.key,Tu)}class ka{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new ka(mr.min(),Xt.empty(),Tu)}static max(){return new ka(mr.max(),Xt.empty(),Tu)}}function fC(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Xt.comparator(t.documentKey,e.documentKey),r!==0?r:Rr(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class mC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $c(t){if(t.code!==dt.FAILED_PRECONDITION||t.message!==pC)throw t;zt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&ur(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new wt((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(r,o).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof wt?r:wt.resolve(r)}catch(r){return wt.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):wt.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):wt.reject(r)}static resolve(e){return new wt((r,n)=>{r(e)})}static reject(e){return new wt((r,n)=>{n(e)})}static waitFor(e){return new wt((r,n)=>{let i=0,o=0,s=!1;e.forEach(a=>{++i,a.next(()=>{++o,s&&o===i&&r()},c=>n(c))}),s=!0,o===i&&r()})}static or(e){let r=wt.resolve(!1);for(const n of e)r=r.next(i=>i?wt.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,o)=>{n.push(r.call(this,i,o))}),this.waitFor(n)}static mapArray(e,r){return new wt((n,i)=>{const o=e.length,s=new Array(o);let a=0;for(let c=0;c<o;c++){const u=c;r(e[u]).next(h=>{s[u]=h,++a,a===o&&n(s)},h=>i(h))}})}static doWhile(e,r){return new wt((n,i)=>{const o=()=>{e()===!0?r().next(()=>{o()},i):n()};o()})}}function yC(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Ec(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Yh.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qm=-1;function Kh(t){return t==null}function Ah(t){return t===0&&1/t==-1/0}function gC(t){return typeof t=="number"&&Number.isInteger(t)&&!Ah(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wb="";function vC(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=av(e)),e=bC(t.get(r),e);return av(e)}function bC(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const o=t.charAt(i);switch(o){case"\0":r+="";break;case Wb:r+="";break;default:r+=o}}return r}function av(t){return t+Wb+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lv(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function ja(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function Gb(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e,r){this.comparator=e,this.root=r||si.EMPTY}insert(e,r){return new Sn(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,si.BLACK,null,null))}remove(e){return new Sn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,si.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new $d(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new $d(this.root,e,this.comparator,!1)}getReverseIterator(){return new $d(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new $d(this.root,e,this.comparator,!0)}}class $d{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=r?n(e.key,r):1,r&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class si{constructor(e,r,n,i,o){this.key=e,this.value=r,this.color=n??si.RED,this.left=i??si.EMPTY,this.right=o??si.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,o){return new si(e??this.key,r??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const o=n(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,r,n),null):o===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return si.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return si.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,si.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,si.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ur(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ur(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ur(27949);return e+(this.isRed()?0:1)}}si.EMPTY=null,si.RED=!0,si.BLACK=!1;si.EMPTY=new class{constructor(){this.size=0}get key(){throw ur(57766)}get value(){throw ur(16141)}get color(){throw ur(16727)}get left(){throw ur(29726)}get right(){throw ur(36894)}copy(e,r,n,i,o){return this}insert(e,r,n){return new si(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e){this.comparator=e,this.data=new Sn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new cv(this.data.getIterator())}getIteratorFrom(e){return new cv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Gn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Gn(this.comparator);return r.data=e,r}}class cv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e){this.fields=e,e.sort(ai.comparator)}static empty(){return new Zi([])}unionWith(e){let r=new Gn(ai.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Zi(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return vc(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yb extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Yb("Invalid base64 string: "+o):o}}(e);return new di(r)}static fromUint8Array(e){const r=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(e);return new di(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Rr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}di.EMPTY_BYTE_STRING=new di("");const _C=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ta(t){if(en(!!t,39018),typeof t=="string"){let e=0;const r=_C.exec(t);if(en(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:kn(t.seconds),nanos:kn(t.nanos)}}function kn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Na(t){return typeof t=="string"?di.fromBase64String(t):di.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kb="server_timestamp",Jb="__type__",Qb="__previous_value__",Xb="__local_write_time__";function Xm(t){return(t?.mapValue?.fields||{})[Jb]?.stringValue===Kb}function Jh(t){const e=t.mapValue.fields[Qb];return Xm(e)?Jh(e):e}function Nu(t){const e=Ta(t.mapValue.fields[Xb].timestampValue);return new vn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{constructor(e,r,n,i,o,s,a,c,u,h){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=h}}const Ch="(default)";class Lu{constructor(e,r){this.projectId=e,this.database=r||Ch}static empty(){return new Lu("","")}get isDefaultDatabase(){return this.database===Ch}isEqual(e){return e instanceof Lu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zb="__type__",SC="__max__",Ed={mapValue:{}},e2="__vector__",Ih="value";function La(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Xm(t)?4:xC(t)?9007199254740991:PC(t)?10:11:ur(28295,{value:t})}function ss(t,e){if(t===e)return!0;const r=La(t);if(r!==La(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Nu(t).isEqual(Nu(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const s=Ta(i.timestampValue),a=Ta(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,o){return Na(i.bytesValue).isEqual(Na(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,o){return kn(i.geoPointValue.latitude)===kn(o.geoPointValue.latitude)&&kn(i.geoPointValue.longitude)===kn(o.geoPointValue.longitude)}(t,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return kn(i.integerValue)===kn(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const s=kn(i.doubleValue),a=kn(o.doubleValue);return s===a?Ah(s)===Ah(a):isNaN(s)&&isNaN(a)}return!1}(t,e);case 9:return vc(t.arrayValue.values||[],e.arrayValue.values||[],ss);case 10:case 11:return function(i,o){const s=i.mapValue.fields||{},a=o.mapValue.fields||{};if(lv(s)!==lv(a))return!1;for(const c in s)if(s.hasOwnProperty(c)&&(a[c]===void 0||!ss(s[c],a[c])))return!1;return!0}(t,e);default:return ur(52216,{left:t})}}function Du(t,e){return(t.values||[]).find(r=>ss(r,e))!==void 0}function bc(t,e){if(t===e)return 0;const r=La(t),n=La(e);if(r!==n)return Rr(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Rr(t.booleanValue,e.booleanValue);case 2:return function(o,s){const a=kn(o.integerValue||o.doubleValue),c=kn(s.integerValue||s.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return uv(t.timestampValue,e.timestampValue);case 4:return uv(Nu(t),Nu(e));case 5:return Wp(t.stringValue,e.stringValue);case 6:return function(o,s){const a=Na(o),c=Na(s);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(o,s){const a=o.split("/"),c=s.split("/");for(let u=0;u<a.length&&u<c.length;u++){const h=Rr(a[u],c[u]);if(h!==0)return h}return Rr(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,s){const a=Rr(kn(o.latitude),kn(s.latitude));return a!==0?a:Rr(kn(o.longitude),kn(s.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return dv(t.arrayValue,e.arrayValue);case 10:return function(o,s){const a=o.fields||{},c=s.fields||{},u=a[Ih]?.arrayValue,h=c[Ih]?.arrayValue,y=Rr(u?.values?.length||0,h?.values?.length||0);return y!==0?y:dv(u,h)}(t.mapValue,e.mapValue);case 11:return function(o,s){if(o===Ed.mapValue&&s===Ed.mapValue)return 0;if(o===Ed.mapValue)return 1;if(s===Ed.mapValue)return-1;const a=o.fields||{},c=Object.keys(a),u=s.fields||{},h=Object.keys(u);c.sort(),h.sort();for(let y=0;y<c.length&&y<h.length;++y){const g=Wp(c[y],h[y]);if(g!==0)return g;const p=bc(a[c[y]],u[h[y]]);if(p!==0)return p}return Rr(c.length,h.length)}(t.mapValue,e.mapValue);default:throw ur(23264,{he:r})}}function uv(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Rr(t,e);const r=Ta(t),n=Ta(e),i=Rr(r.seconds,n.seconds);return i!==0?i:Rr(r.nanos,n.nanos)}function dv(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const o=bc(r[i],n[i]);if(o)return o}return Rr(r.length,n.length)}function _c(t){return Gp(t)}function Gp(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Ta(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Na(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Xt.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const o of r.values||[])i?i=!1:n+=",",n+=Gp(o);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const s of n)o?o=!1:i+=",",i+=`${s}:${Gp(r.fields[s])}`;return i+"}"}(t.mapValue):ur(61005,{value:t})}function th(t){switch(La(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Jh(t);return e?16+th(e):16;case 5:return 2*t.stringValue.length;case 6:return Na(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,o)=>i+th(o),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return ja(n.fields,(o,s)=>{i+=o.length+th(s)}),i}(t.mapValue);default:throw ur(13486,{value:t})}}function hv(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Yp(t){return!!t&&"integerValue"in t}function Zm(t){return!!t&&"arrayValue"in t}function fv(t){return!!t&&"nullValue"in t}function pv(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function rh(t){return!!t&&"mapValue"in t}function PC(t){return(t?.mapValue?.fields||{})[Zb]?.stringValue===e2}function fu(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return ja(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=fu(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=fu(t.arrayValue.values[r]);return e}return{...t}}function xC(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===SC}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui{constructor(e){this.value=e}static empty(){return new Ui({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!rh(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=fu(r)}setAll(e){let r=ai.emptyPath(),n={},i=[];e.forEach((s,a)=>{if(!r.isImmediateParentOf(a)){const c=this.getFieldsMap(r);this.applyChanges(c,n,i),n={},i=[],r=a.popLast()}s?n[a.lastSegment()]=fu(s):i.push(a.lastSegment())});const o=this.getFieldsMap(r);this.applyChanges(o,n,i)}delete(e){const r=this.field(e.popLast());rh(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return ss(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];rh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){ja(r,(i,o)=>e[i]=o);for(const i of n)delete e[i]}clone(){return new Ui(fu(this.value))}}function t2(t){const e=[];return ja(t.fields,(r,n)=>{const i=new ai([r]);if(rh(n)){const o=t2(n.mapValue).fields;if(o.length===0)e.push(i);else for(const s of o)e.push(i.child(s))}else e.push(i)}),new Zi(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(e,r,n,i,o,s,a){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new wi(e,0,mr.min(),mr.min(),mr.min(),Ui.empty(),0)}static newFoundDocument(e,r,n,i){return new wi(e,1,r,mr.min(),n,i,0)}static newNoDocument(e,r){return new wi(e,2,r,mr.min(),mr.min(),Ui.empty(),0)}static newUnknownDocument(e,r){return new wi(e,3,r,mr.min(),mr.min(),Ui.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(mr.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ui.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ui.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=mr.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof wi&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new wi(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h{constructor(e,r){this.position=e,this.inclusive=r}}function mv(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const o=e[i],s=t.position[i];if(o.field.isKeyField()?n=Xt.comparator(Xt.fromName(s.referenceValue),r.key):n=bc(s,r.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function yv(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!ss(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru{constructor(e,r="asc"){this.field=e,this.dir=r}}function AC(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r2{}class Vn extends r2{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new IC(e,r,n):r==="array-contains"?new kC(e,n):r==="in"?new TC(e,n):r==="not-in"?new NC(e,n):r==="array-contains-any"?new LC(e,n):new Vn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new $C(e,n):new EC(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(bc(r,this.value)):r!==null&&La(this.value)===La(r)&&this.matchesComparison(bc(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ur(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ro extends r2{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Ro(e,r)}matches(e){return n2(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function n2(t){return t.op==="and"}function i2(t){return CC(t)&&n2(t)}function CC(t){for(const e of t.filters)if(e instanceof Ro)return!1;return!0}function Kp(t){if(t instanceof Vn)return t.field.canonicalString()+t.op.toString()+_c(t.value);if(i2(t))return t.filters.map(e=>Kp(e)).join(",");{const e=t.filters.map(r=>Kp(r)).join(",");return`${t.op}(${e})`}}function o2(t,e){return t instanceof Vn?function(n,i){return i instanceof Vn&&n.op===i.op&&n.field.isEqual(i.field)&&ss(n.value,i.value)}(t,e):t instanceof Ro?function(n,i){return i instanceof Ro&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((o,s,a)=>o&&o2(s,i.filters[a]),!0):!1}(t,e):void ur(19439)}function s2(t){return t instanceof Vn?function(r){return`${r.field.canonicalString()} ${r.op} ${_c(r.value)}`}(t):t instanceof Ro?function(r){return r.op.toString()+" {"+r.getFilters().map(s2).join(" ,")+"}"}(t):"Filter"}class IC extends Vn{constructor(e,r,n){super(e,r,n),this.key=Xt.fromName(n.referenceValue)}matches(e){const r=Xt.comparator(e.key,this.key);return this.matchesComparison(r)}}class $C extends Vn{constructor(e,r){super(e,"in",r),this.keys=a2("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class EC extends Vn{constructor(e,r){super(e,"not-in",r),this.keys=a2("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function a2(t,e){return(e.arrayValue?.values||[]).map(r=>Xt.fromName(r.referenceValue))}class kC extends Vn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Zm(r)&&Du(r.arrayValue,this.value)}}class TC extends Vn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Du(this.value.arrayValue,r)}}class NC extends Vn{constructor(e,r){super(e,"not-in",r)}matches(e){if(Du(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!Du(this.value.arrayValue,r)}}class LC extends Vn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Zm(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Du(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(e,r=null,n=[],i=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.Te=null}}function gv(t,e=null,r=[],n=[],i=null,o=null,s=null){return new DC(t,e,r,n,i,o,s)}function ey(t){const e=_r(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Kp(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(o){return o.field.canonicalString()+o.dir}(n)).join(","),Kh(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>_c(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>_c(n)).join(",")),e.Te=r}return e.Te}function ty(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!AC(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!o2(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!yv(t.startAt,e.startAt)&&yv(t.endAt,e.endAt)}function Jp(t){return Xt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kc{constructor(e,r=null,n=[],i=[],o=null,s="F",a=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function RC(t,e,r,n,i,o,s,a){return new kc(t,e,r,n,i,o,s,a)}function ry(t){return new kc(t)}function vv(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function l2(t){return t.collectionGroup!==null}function pu(t){const e=_r(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),r.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Gn(ai.comparator);return s.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(o=>{r.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new Ru(o,n))}),r.has(ai.keyField().canonicalString())||e.Ie.push(new Ru(ai.keyField(),n))}return e.Ie}function Zo(t){const e=_r(t);return e.Ee||(e.Ee=MC(e,pu(t))),e.Ee}function MC(t,e){if(t.limitType==="F")return gv(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const o=i.dir==="desc"?"asc":"desc";return new Ru(i.field,o)});const r=t.endAt?new $h(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new $h(t.startAt.position,t.startAt.inclusive):null;return gv(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Qp(t,e){const r=t.filters.concat([e]);return new kc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function Xp(t,e,r){return new kc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Qh(t,e){return ty(Zo(t),Zo(e))&&t.limitType===e.limitType}function c2(t){return`${ey(Zo(t))}|lt:${t.limitType}`}function nc(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>s2(i)).join(", ")}]`),Kh(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>_c(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>_c(i)).join(",")),`Target(${n})`}(Zo(t))}; limitType=${t.limitType})`}function Xh(t,e){return e.isFoundDocument()&&function(n,i){const o=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):Xt.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(t,e)&&function(n,i){for(const o of pu(n))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const o of n.filters)if(!o.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(s,a,c){const u=mv(s,a,c);return s.inclusive?u<=0:u<0}(n.startAt,pu(n),i)||n.endAt&&!function(s,a,c){const u=mv(s,a,c);return s.inclusive?u>=0:u>0}(n.endAt,pu(n),i))}(t,e)}function FC(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function u2(t){return(e,r)=>{let n=!1;for(const i of pu(t)){const o=OC(i,e,r);if(o!==0)return o;n=n||i.field.isKeyField()}return 0}}function OC(t,e,r){const n=t.field.isKeyField()?Xt.comparator(e.key,r.key):function(o,s,a){const c=s.data.field(o),u=a.data.field(o);return c!==null&&u!==null?bc(c,u):ur(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return ur(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,o]of n)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ja(this.inner,(r,n)=>{for(const[i,o]of n)e(i,o)})}isEmpty(){return Gb(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BC=new Sn(Xt.comparator);function Fs(){return BC}const d2=new Sn(Xt.comparator);function iu(...t){let e=d2;for(const r of t)e=e.insert(r.key,r);return e}function h2(t){let e=d2;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function pl(){return mu()}function f2(){return mu()}function mu(){return new $l(t=>t.toString(),(t,e)=>t.isEqual(e))}const jC=new Sn(Xt.comparator),VC=new Gn(Xt.comparator);function Mr(...t){let e=VC;for(const r of t)e=e.add(r);return e}const qC=new Gn(Rr);function zC(){return qC}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ny(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ah(e)?"-0":e}}function p2(t){return{integerValue:""+t}}function UC(t,e){return gC(e)?p2(e):ny(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zh{constructor(){this._=void 0}}function HC(t,e,r){return t instanceof Eh?function(i,o){const s={fields:{[Jb]:{stringValue:Kb},[Xb]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Xm(o)&&(o=Jh(o)),o&&(s.fields[Qb]=o),{mapValue:s}}(r,e):t instanceof Mu?y2(t,e):t instanceof Fu?g2(t,e):function(i,o){const s=m2(i,o),a=bv(s)+bv(i.Ae);return Yp(s)&&Yp(i.Ae)?p2(a):ny(i.serializer,a)}(t,e)}function WC(t,e,r){return t instanceof Mu?y2(t,e):t instanceof Fu?g2(t,e):r}function m2(t,e){return t instanceof kh?function(n){return Yp(n)||function(o){return!!o&&"doubleValue"in o}(n)}(e)?e:{integerValue:0}:null}class Eh extends Zh{}class Mu extends Zh{constructor(e){super(),this.elements=e}}function y2(t,e){const r=v2(e);for(const n of t.elements)r.some(i=>ss(i,n))||r.push(n);return{arrayValue:{values:r}}}class Fu extends Zh{constructor(e){super(),this.elements=e}}function g2(t,e){let r=v2(e);for(const n of t.elements)r=r.filter(i=>!ss(i,n));return{arrayValue:{values:r}}}class kh extends Zh{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function bv(t){return kn(t.integerValue||t.doubleValue)}function v2(t){return Zm(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function GC(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof Mu&&i instanceof Mu||n instanceof Fu&&i instanceof Fu?vc(n.elements,i.elements,ss):n instanceof kh&&i instanceof kh?ss(n.Ae,i.Ae):n instanceof Eh&&i instanceof Eh}(t.transform,e.transform)}class YC{constructor(e,r){this.version=e,this.transformResults=r}}class es{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new es}static exists(e){return new es(void 0,e)}static updateTime(e){return new es(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function nh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ef{}function b2(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new w2(t.key,es.none()):new Ku(t.key,t.data,es.none());{const r=t.data,n=Ui.empty();let i=new Gn(ai.comparator);for(let o of e.fields)if(!i.has(o)){let s=r.field(o);s===null&&o.length>1&&(o=o.popLast(),s=r.field(o)),s===null?n.delete(o):n.set(o,s),i=i.add(o)}return new Va(t.key,n,new Zi(i.toArray()),es.none())}}function KC(t,e,r){t instanceof Ku?function(i,o,s){const a=i.value.clone(),c=wv(i.fieldTransforms,o,s.transformResults);a.setAll(c),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(t,e,r):t instanceof Va?function(i,o,s){if(!nh(i.precondition,o))return void o.convertToUnknownDocument(s.version);const a=wv(i.fieldTransforms,o,s.transformResults),c=o.data;c.setAll(_2(i)),c.setAll(a),o.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(t,e,r):function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,r)}function yu(t,e,r,n){return t instanceof Ku?function(o,s,a,c){if(!nh(o.precondition,s))return a;const u=o.value.clone(),h=Sv(o.fieldTransforms,c,s);return u.setAll(h),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),null}(t,e,r,n):t instanceof Va?function(o,s,a,c){if(!nh(o.precondition,s))return a;const u=Sv(o.fieldTransforms,c,s),h=s.data;return h.setAll(_2(o)),h.setAll(u),s.convertToFoundDocument(s.version,h).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(y=>y.field))}(t,e,r,n):function(o,s,a){return nh(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a}(t,e,r)}function JC(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),o=m2(n.transform,i||null);o!=null&&(r===null&&(r=Ui.empty()),r.set(n.field,o))}return r||null}function _v(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&vc(n,i,(o,s)=>GC(o,s))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ku extends ef{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Va extends ef{constructor(e,r,n,i,o=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function _2(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function wv(t,e,r){const n=new Map;en(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let i=0;i<r.length;i++){const o=t[i],s=o.transform,a=e.data.field(o.field);n.set(o.field,WC(s,a,r[i]))}return n}function Sv(t,e,r){const n=new Map;for(const i of t){const o=i.transform,s=r.data.field(i.field);n.set(i.field,HC(o,s,e))}return n}class w2 extends ef{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class QC extends ef{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XC{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&KC(o,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=yu(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=yu(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=f2();return this.mutations.forEach(i=>{const o=e.get(i.key),s=o.overlayedDocument;let a=this.applyToLocalView(s,o.mutatedFields);a=r.has(i.key)?null:a;const c=b2(s,a);c!==null&&n.set(i.key,c),s.isValidDocument()||s.convertToNoDocument(mr.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Mr())}isEqual(e){return this.batchId===e.batchId&&vc(this.mutations,e.mutations,(r,n)=>_v(r,n))&&vc(this.baseMutations,e.baseMutations,(r,n)=>_v(r,n))}}class iy{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){en(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=function(){return jC}();const o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,n[s].version);return new iy(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e4{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var jn,Vr;function t4(t){switch(t){case dt.OK:return ur(64938);case dt.CANCELLED:case dt.UNKNOWN:case dt.DEADLINE_EXCEEDED:case dt.RESOURCE_EXHAUSTED:case dt.INTERNAL:case dt.UNAVAILABLE:case dt.UNAUTHENTICATED:return!1;case dt.INVALID_ARGUMENT:case dt.NOT_FOUND:case dt.ALREADY_EXISTS:case dt.PERMISSION_DENIED:case dt.FAILED_PRECONDITION:case dt.ABORTED:case dt.OUT_OF_RANGE:case dt.UNIMPLEMENTED:case dt.DATA_LOSS:return!0;default:return ur(15467,{code:t})}}function S2(t){if(t===void 0)return Rs("GRPC error has no .code"),dt.UNKNOWN;switch(t){case jn.OK:return dt.OK;case jn.CANCELLED:return dt.CANCELLED;case jn.UNKNOWN:return dt.UNKNOWN;case jn.DEADLINE_EXCEEDED:return dt.DEADLINE_EXCEEDED;case jn.RESOURCE_EXHAUSTED:return dt.RESOURCE_EXHAUSTED;case jn.INTERNAL:return dt.INTERNAL;case jn.UNAVAILABLE:return dt.UNAVAILABLE;case jn.UNAUTHENTICATED:return dt.UNAUTHENTICATED;case jn.INVALID_ARGUMENT:return dt.INVALID_ARGUMENT;case jn.NOT_FOUND:return dt.NOT_FOUND;case jn.ALREADY_EXISTS:return dt.ALREADY_EXISTS;case jn.PERMISSION_DENIED:return dt.PERMISSION_DENIED;case jn.FAILED_PRECONDITION:return dt.FAILED_PRECONDITION;case jn.ABORTED:return dt.ABORTED;case jn.OUT_OF_RANGE:return dt.OUT_OF_RANGE;case jn.UNIMPLEMENTED:return dt.UNIMPLEMENTED;case jn.DATA_LOSS:return dt.DATA_LOSS;default:return ur(39323,{code:t})}}(Vr=jn||(jn={}))[Vr.OK=0]="OK",Vr[Vr.CANCELLED=1]="CANCELLED",Vr[Vr.UNKNOWN=2]="UNKNOWN",Vr[Vr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Vr[Vr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Vr[Vr.NOT_FOUND=5]="NOT_FOUND",Vr[Vr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Vr[Vr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Vr[Vr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Vr[Vr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Vr[Vr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Vr[Vr.ABORTED=10]="ABORTED",Vr[Vr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Vr[Vr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Vr[Vr.INTERNAL=13]="INTERNAL",Vr[Vr.UNAVAILABLE=14]="UNAVAILABLE",Vr[Vr.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r4(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n4=new Ia([4294967295,4294967295],0);function Pv(t){const e=r4().encode(t),r=new Mb;return r.update(e),new Uint8Array(r.digest())}function xv(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Ia([r,n],0),new Ia([i,o],0)]}class oy{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new ou(`Invalid padding: ${r}`);if(n<0)throw new ou(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new ou(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new ou(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Ia.fromNumber(this.ge)}ye(e,r,n){let i=e.add(r.multiply(Ia.fromNumber(n)));return i.compare(n4)===1&&(i=new Ia([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=Pv(e),[n,i]=xv(r);for(let o=0;o<this.hashCount;o++){const s=this.ye(n,i,o);if(!this.we(s))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new oy(o,i,r);return n.forEach(a=>s.insert(a)),s}insert(e){if(this.ge===0)return;const r=Pv(e),[n,i]=xv(r);for(let o=0;o<this.hashCount;o++){const s=this.ye(n,i,o);this.Se(s)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class ou extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(e,r,n,i,o){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,Ju.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new tf(mr.min(),i,new Sn(Rr),Fs(),Mr())}}class Ju{constructor(e,r,n,i,o){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Ju(n,r,Mr(),Mr(),Mr())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ih{constructor(e,r,n,i){this.be=e,this.removedTargetIds=r,this.key=n,this.De=i}}class P2{constructor(e,r){this.targetId=e,this.Ce=r}}class x2{constructor(e,r,n=di.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class Av{constructor(){this.ve=0,this.Fe=Cv(),this.Me=di.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Mr(),r=Mr(),n=Mr();return this.Fe.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:ur(38017,{changeType:o})}}),new Ju(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=Cv()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,en(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class i4{constructor(e){this.Ge=e,this.ze=new Map,this.je=Fs(),this.Je=kd(),this.He=kd(),this.Ye=new Sn(Rr)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:ur(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,i)=>{this.rt(i)&&r(i)})}st(e){const r=e.targetId,n=e.Ce.count,i=this.ot(r);if(i){const o=i.target;if(Jp(o))if(n===0){const s=new Xt(o.path);this.et(r,s,wi.newNoDocument(s,mr.min()))}else en(n===1,20013,{expectedCount:n});else{const s=this._t(r);if(s!==n){const a=this.ut(e),c=a?this.ct(a,e,s):1;if(c!==0){this.it(r);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,u)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:o=0}=r;let s,a;try{s=Na(n).toUint8Array()}catch(c){if(c instanceof Yb)return gc("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new oy(s,i,o)}catch(c){return gc(c instanceof ou?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.ge===0?null:a}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let i=0;return n.forEach(o=>{const s=this.Ge.ht(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.et(r,o,null),i++)}),i}Tt(e){const r=new Map;this.ze.forEach((o,s)=>{const a=this.ot(s);if(a){if(o.current&&Jp(a.target)){const c=new Xt(a.target.path);this.It(c).has(s)||this.Et(s,c)||this.et(s,c,wi.newNoDocument(c,e))}o.Be&&(r.set(s,o.ke()),o.qe())}});let n=Mr();this.He.forEach((o,s)=>{let a=!0;s.forEachWhile(c=>{const u=this.ot(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(n=n.add(o))}),this.je.forEach((o,s)=>s.setReadTime(e));const i=new tf(e,r,this.Ye,this.je,n);return this.je=Fs(),this.Je=kd(),this.He=kd(),this.Ye=new Sn(Rr),i}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,r)?i.Qe(r,1):i.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new Av,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new Gn(Rr),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new Gn(Rr),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||zt("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Av),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function kd(){return new Sn(Xt.comparator)}function Cv(){return new Sn(Xt.comparator)}const o4={asc:"ASCENDING",desc:"DESCENDING"},s4={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},a4={and:"AND",or:"OR"};class l4{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Zp(t,e){return t.useProto3Json||Kh(e)?e:{value:e}}function Th(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function A2(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function c4(t,e){return Th(t,e.toTimestamp())}function ts(t){return en(!!t,49232),mr.fromTimestamp(function(r){const n=Ta(r);return new vn(n.seconds,n.nanos)}(t))}function sy(t,e){return em(t,e).canonicalString()}function em(t,e){const r=function(i){return new gn(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function C2(t){const e=gn.fromString(t);return en(T2(e),10190,{key:e.toString()}),e}function tm(t,e){return sy(t.databaseId,e.path)}function Uf(t,e){const r=C2(e);if(r.get(1)!==t.databaseId.projectId)throw new Bt(dt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Bt(dt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Xt($2(r))}function I2(t,e){return sy(t.databaseId,e)}function u4(t){const e=C2(t);return e.length===4?gn.emptyPath():$2(e)}function rm(t){return new gn(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function $2(t){return en(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Iv(t,e,r){return{name:tm(t,e),fields:r.value.mapValue.fields}}function d4(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:ur(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(u,h){return u.useProto3Json?(en(h===void 0||typeof h=="string",58123),di.fromBase64String(h||"")):(en(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),di.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&function(u){const h=u.code===void 0?dt.UNKNOWN:S2(u.code);return new Bt(h,u.message||"")}(s);r=new x2(n,i,o,a||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Uf(t,n.document.name),o=ts(n.document.updateTime),s=n.document.createTime?ts(n.document.createTime):mr.min(),a=new Ui({mapValue:{fields:n.document.fields}}),c=wi.newFoundDocument(i,o,s,a),u=n.targetIds||[],h=n.removedTargetIds||[];r=new ih(u,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Uf(t,n.document),o=n.readTime?ts(n.readTime):mr.min(),s=wi.newNoDocument(i,o),a=n.removedTargetIds||[];r=new ih([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Uf(t,n.document),o=n.removedTargetIds||[];r=new ih([],o,i,null)}else{if(!("filter"in e))return ur(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:o}=n,s=new e4(i,o),a=n.targetId;r=new P2(a,s)}}return r}function h4(t,e){let r;if(e instanceof Ku)r={update:Iv(t,e.key,e.value)};else if(e instanceof w2)r={delete:tm(t,e.key)};else if(e instanceof Va)r={update:Iv(t,e.key,e.data),updateMask:w4(e.fieldMask)};else{if(!(e instanceof QC))return ur(16599,{Vt:e.type});r={verify:tm(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(o,s){const a=s.transform;if(a instanceof Eh)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Mu)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Fu)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof kh)return{fieldPath:s.field.canonicalString(),increment:a.Ae};throw ur(20930,{transform:s.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:c4(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:ur(27497)}(t,e.precondition)),r}function f4(t,e){return t&&t.length>0?(en(e!==void 0,14353),t.map(r=>function(i,o){let s=i.updateTime?ts(i.updateTime):ts(o);return s.isEqual(mr.min())&&(s=ts(o)),new YC(s,i.transformResults||[])}(r,e))):[]}function p4(t,e){return{documents:[I2(t,e.path)]}}function m4(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=I2(t,i);const o=function(u){if(u.length!==0)return k2(Ro.create(u,"and"))}(e.filters);o&&(r.structuredQuery.where=o);const s=function(u){if(u.length!==0)return u.map(h=>function(g){return{field:ic(g.field),direction:v4(g.dir)}}(h))}(e.orderBy);s&&(r.structuredQuery.orderBy=s);const a=Zp(t,e.limit);return a!==null&&(r.structuredQuery.limit=a),e.startAt&&(r.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:r,parent:i}}function y4(t){let e=u4(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){en(n===1,65062);const h=r.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let o=[];r.where&&(o=function(y){const g=E2(y);return g instanceof Ro&&i2(g)?g.getFilters():[g]}(r.where));let s=[];r.orderBy&&(s=function(y){return y.map(g=>function(C){return new Ru(oc(C.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(C.direction))}(g))}(r.orderBy));let a=null;r.limit&&(a=function(y){let g;return g=typeof y=="object"?y.value:y,Kh(g)?null:g}(r.limit));let c=null;r.startAt&&(c=function(y){const g=!!y.before,p=y.values||[];return new $h(p,g)}(r.startAt));let u=null;return r.endAt&&(u=function(y){const g=!y.before,p=y.values||[];return new $h(p,g)}(r.endAt)),RC(e,i,s,o,a,"F",c,u)}function g4(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ur(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function E2(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=oc(r.unaryFilter.field);return Vn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=oc(r.unaryFilter.field);return Vn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=oc(r.unaryFilter.field);return Vn.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=oc(r.unaryFilter.field);return Vn.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ur(61313);default:return ur(60726)}}(t):t.fieldFilter!==void 0?function(r){return Vn.create(oc(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ur(58110);default:return ur(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Ro.create(r.compositeFilter.filters.map(n=>E2(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ur(1026)}}(r.compositeFilter.op))}(t):ur(30097,{filter:t})}function v4(t){return o4[t]}function b4(t){return s4[t]}function _4(t){return a4[t]}function ic(t){return{fieldPath:t.canonicalString()}}function oc(t){return ai.fromServerFormat(t.fieldPath)}function k2(t){return t instanceof Vn?function(r){if(r.op==="=="){if(pv(r.value))return{unaryFilter:{field:ic(r.field),op:"IS_NAN"}};if(fv(r.value))return{unaryFilter:{field:ic(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(pv(r.value))return{unaryFilter:{field:ic(r.field),op:"IS_NOT_NAN"}};if(fv(r.value))return{unaryFilter:{field:ic(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ic(r.field),op:b4(r.op),value:r.value}}}(t):t instanceof Ro?function(r){const n=r.getFilters().map(i=>k2(i));return n.length===1?n[0]:{compositeFilter:{op:_4(r.op),filters:n}}}(t):ur(54877,{filter:t})}function w4(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function T2(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(e,r,n,i,o=mr.min(),s=mr.min(),a=di.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new _a(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new _a(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new _a(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new _a(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S4{constructor(e){this.yt=e}}function P4(t){const e=y4({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Xp(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x4{constructor(){this.Cn=new A4}addToCollectionParentIndex(e,r){return this.Cn.add(r),wt.resolve()}getCollectionParents(e,r){return wt.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return wt.resolve()}deleteFieldIndex(e,r){return wt.resolve()}deleteAllFieldIndexes(e){return wt.resolve()}createTargetIndexes(e,r){return wt.resolve()}getDocumentsMatchingTarget(e,r){return wt.resolve(null)}getIndexType(e,r){return wt.resolve(0)}getFieldIndexes(e,r){return wt.resolve([])}getNextCollectionGroupToUpdate(e){return wt.resolve(null)}getMinOffset(e,r){return wt.resolve(ka.min())}getMinOffsetFromCollectionGroup(e,r){return wt.resolve(ka.min())}updateCollectionGroup(e,r,n){return wt.resolve()}updateIndexEntries(e,r){return wt.resolve()}}class A4{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Gn(gn.comparator),o=!i.has(n);return this.index[r]=i.add(n),o}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Gn(gn.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $v={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},N2=41943040;class zi{static withCacheSize(e){return new zi(e,zi.DEFAULT_COLLECTION_PERCENTILE,zi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */zi.DEFAULT_COLLECTION_PERCENTILE=10,zi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,zi.DEFAULT=new zi(N2,zi.DEFAULT_COLLECTION_PERCENTILE,zi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),zi.DISABLED=new zi(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new wc(0)}static cr(){return new wc(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ev="LruGarbageCollector",C4=1048576;function kv([t,e],[r,n]){const i=Rr(t,r);return i===0?Rr(e,n):i}class I4{constructor(e){this.Ir=e,this.buffer=new Gn(kv),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();kv(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class $4{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){zt(Ev,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Ec(r)?zt(Ev,"Ignoring IndexedDB error during garbage collection: ",r):await $c(r)}await this.Vr(3e5)})}}class E4{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return wt.resolve(Yh.ce);const n=new I4(r);return this.mr.forEachTarget(e,i=>n.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>n.Ar(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(zt("LruGarbageCollector","Garbage collection skipped; disabled"),wt.resolve($v)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(zt("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),$v):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,i,o,s,a,c,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(y=>(y>this.params.maximumSequenceNumbersToCollect?(zt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),i=this.params.maximumSequenceNumbersToCollect):i=y,s=Date.now(),this.nthSequenceNumber(e,i))).next(y=>(n=y,a=Date.now(),this.removeTargets(e,n,r))).next(y=>(o=y,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(y=>(u=Date.now(),rc()<=Dr.DEBUG&&zt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-h}ms
	Determined least recently used ${i} in `+(a-s)+`ms
	Removed ${o} targets in `+(c-a)+`ms
	Removed ${y} documents in `+(u-c)+`ms
Total Duration: ${u-h}ms`),wt.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:y})))}}function k4(t,e){return new E4(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T4{constructor(){this.changes=new $l(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,wi.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?wt.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N4{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L4{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&yu(n.mutation,i,Zi.empty(),vn.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Mr()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Mr()){const i=pl();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(o=>{let s=iu();return o.forEach((a,c)=>{s=s.insert(a,c.overlayedDocument)}),s}))}getOverlayedDocuments(e,r){const n=pl();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Mr()))}populateOverlays(e,r,n){const i=[];return n.forEach(o=>{r.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,a)=>{r.set(s,a)})})}computeViews(e,r,n,i){let o=Fs();const s=mu(),a=function(){return mu()}();return r.forEach((c,u)=>{const h=n.get(u.key);i.has(u.key)&&(h===void 0||h.mutation instanceof Va)?o=o.insert(u.key,u):h!==void 0?(s.set(u.key,h.mutation.getFieldMask()),yu(h.mutation,u,h.mutation.getFieldMask(),vn.now())):s.set(u.key,Zi.empty())}),this.recalculateAndSaveOverlays(e,o).next(c=>(c.forEach((u,h)=>s.set(u,h)),r.forEach((u,h)=>a.set(u,new N4(h,s.get(u)??null))),a))}recalculateAndSaveOverlays(e,r){const n=mu();let i=new Sn((s,a)=>s-a),o=Mr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(s=>{for(const a of s)a.keys().forEach(c=>{const u=r.get(c);if(u===null)return;let h=n.get(c)||Zi.empty();h=a.applyToLocalView(u,h),n.set(c,h);const y=(i.get(a.batchId)||Mr()).add(c);i=i.insert(a.batchId,y)})}).next(()=>{const s=[],a=i.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),u=c.key,h=c.value,y=f2();h.forEach(g=>{if(!o.has(g)){const p=b2(r.get(g),n.get(g));p!==null&&y.set(g,p),o=o.add(g)}}),s.push(this.documentOverlayCache.saveOverlays(e,u,y))}return wt.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(s){return Xt.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):l2(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(o=>{const s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-o.size):wt.resolve(pl());let a=Tu,c=o;return s.next(u=>wt.forEach(u,(h,y)=>(a<y.largestBatchId&&(a=y.largestBatchId),o.get(h)?wt.resolve():this.remoteDocumentCache.getEntry(e,h).next(g=>{c=c.insert(h,g)}))).next(()=>this.populateOverlays(e,u,o)).next(()=>this.computeViews(e,c,u,Mr())).next(h=>({batchId:a,changes:h2(h)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Xt(r)).next(n=>{let i=iu();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const o=r.collectionGroup;let s=iu();return this.indexManager.getCollectionParents(e,o).next(a=>wt.forEach(a,c=>{const u=function(y,g){return new kc(g,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)}(r,c.child(o));return this.getDocumentsMatchingCollectionQuery(e,u,n,i).next(h=>{h.forEach((y,g)=>{s=s.insert(y,g)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,r,n,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,o,i))).next(s=>{o.forEach((c,u)=>{const h=u.getKey();s.get(h)===null&&(s=s.insert(h,wi.newInvalidDocument(h)))});let a=iu();return s.forEach((c,u)=>{const h=o.get(c);h!==void 0&&yu(h.mutation,u,Zi.empty(),vn.now()),Xh(r,u)&&(a=a.insert(c,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D4{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return wt.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:ts(i.createTime)}}(r)),wt.resolve()}getNamedQuery(e,r){return wt.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(i){return{name:i.name,query:P4(i.bundledQuery),readTime:ts(i.readTime)}}(r)),wt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R4{constructor(){this.overlays=new Sn(Xt.comparator),this.qr=new Map}getOverlay(e,r){return wt.resolve(this.overlays.get(r))}getOverlays(e,r){const n=pl();return wt.forEach(r,i=>this.getOverlay(e,i).next(o=>{o!==null&&n.set(i,o)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,o)=>{this.St(e,r,o)}),wt.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.qr.delete(n)),wt.resolve()}getOverlaysForCollection(e,r,n){const i=pl(),o=r.length+1,s=new Xt(r.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){const c=a.getNext().value,u=c.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===o&&c.largestBatchId>n&&i.set(c.getKey(),c)}return wt.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let o=new Sn((u,h)=>u-h);const s=this.overlays.getIterator();for(;s.hasNext();){const u=s.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let h=o.get(u.largestBatchId);h===null&&(h=pl(),o=o.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const a=pl(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,h)=>a.set(u,h)),!(a.size()>=i)););return wt.resolve(a)}St(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const s=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(n.key,new ZC(r,n));let o=this.qr.get(r);o===void 0&&(o=Mr(),this.qr.set(r,o)),this.qr.set(r,o.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{constructor(){this.sessionToken=di.EMPTY_BYTE_STRING}getSessionToken(e){return wt.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,wt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay{constructor(){this.Qr=new Gn(Qn.$r),this.Ur=new Gn(Qn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new Qn(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new Qn(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new Xt(new gn([])),n=new Qn(r,e),i=new Qn(r,e+1),o=[];return this.Ur.forEachInRange([n,i],s=>{this.Gr(s),o.push(s.key)}),o}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new Xt(new gn([])),n=new Qn(r,e),i=new Qn(r,e+1);let o=Mr();return this.Ur.forEachInRange([n,i],s=>{o=o.add(s.key)}),o}containsKey(e){const r=new Qn(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Qn{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return Xt.comparator(e.key,r.key)||Rr(e.Yr,r.Yr)}static Kr(e,r){return Rr(e.Yr,r.Yr)||Xt.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F4{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new Gn(Qn.$r)}checkEmpty(e){return wt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new XC(o,r,n,i);this.mutationQueue.push(s);for(const a of i)this.Zr=this.Zr.add(new Qn(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return wt.resolve(s)}lookupMutationBatch(e,r){return wt.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.ei(n),o=i<0?0:i;return wt.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return wt.resolve(this.mutationQueue.length===0?Qm:this.tr-1)}getAllMutationBatches(e){return wt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Qn(r,0),i=new Qn(r,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([n,i],s=>{const a=this.Xr(s.Yr);o.push(a)}),wt.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Gn(Rr);return r.forEach(i=>{const o=new Qn(i,0),s=new Qn(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,s],a=>{n=n.add(a.Yr)})}),wt.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let o=n;Xt.isDocumentKey(o)||(o=o.child(""));const s=new Qn(new Xt(o),0);let a=new Gn(Rr);return this.Zr.forEachWhile(c=>{const u=c.key.path;return!!n.isPrefixOf(u)&&(u.length===i&&(a=a.add(c.Yr)),!0)},s),wt.resolve(this.ti(a))}ti(e){const r=[];return e.forEach(n=>{const i=this.Xr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){en(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return wt.forEach(r.mutations,i=>{const o=new Qn(i.key,r.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new Qn(r,0),i=this.Zr.firstAfterOrEqual(n);return wt.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,wt.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O4{constructor(e){this.ri=e,this.docs=function(){return new Sn(Xt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),o=i?i.size:0,s=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return wt.resolve(n?n.document.mutableCopy():wi.newInvalidDocument(r))}getEntries(e,r){let n=Fs();return r.forEach(i=>{const o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():wi.newInvalidDocument(i))}),wt.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let o=Fs();const s=r.path,a=new Xt(s.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:u,value:{document:h}}=c.getNext();if(!s.isPrefixOf(u.path))break;u.path.length>s.length+1||fC(hC(h),n)<=0||(i.has(h.key)||Xh(r,h))&&(o=o.insert(h.key,h.mutableCopy()))}return wt.resolve(o)}getAllFromCollectionGroup(e,r,n,i){ur(9500)}ii(e,r){return wt.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new B4(this)}getSize(e){return wt.resolve(this.size)}}class B4 extends T4{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)}),wt.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j4{constructor(e){this.persistence=e,this.si=new $l(r=>ey(r),ty),this.lastRemoteSnapshotVersion=mr.min(),this.highestTargetId=0,this.oi=0,this._i=new ay,this.targetCount=0,this.ai=wc.ur()}forEachTarget(e,r){return this.si.forEach((n,i)=>r(i)),wt.resolve()}getLastRemoteSnapshotVersion(e){return wt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return wt.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),wt.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),wt.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new wc(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,wt.resolve()}updateTargetData(e,r){return this.Pr(r),wt.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,wt.resolve()}removeTargets(e,r,n){let i=0;const o=[];return this.si.forEach((s,a)=>{a.sequenceNumber<=r&&n.get(a.targetId)===null&&(this.si.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),wt.waitFor(o).next(()=>i)}getTargetCount(e){return wt.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return wt.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),wt.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const i=this.persistence.referenceDelegate,o=[];return i&&r.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),wt.waitFor(o)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),wt.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return wt.resolve(n)}containsKey(e,r){return wt.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L2{constructor(e,r){this.ui={},this.overlays={},this.ci=new Yh(0),this.li=!1,this.li=!0,this.hi=new M4,this.referenceDelegate=e(this),this.Pi=new j4(this),this.indexManager=new x4,this.remoteDocumentCache=function(i){return new O4(i)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new S4(r),this.Ii=new D4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new R4,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new F4(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){zt("MemoryPersistence","Starting transaction:",e);const i=new V4(this.ci.next());return this.referenceDelegate.Ei(),n(i).next(o=>this.referenceDelegate.di(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ai(e,r){return wt.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class V4 extends mC{constructor(e){super(),this.currentSequenceNumber=e}}class ly{constructor(e){this.persistence=e,this.Ri=new ay,this.Vi=null}static mi(e){return new ly(e)}get fi(){if(this.Vi)return this.Vi;throw ur(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),wt.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),wt.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),wt.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(i=>this.fi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(o=>this.fi.add(o.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return wt.forEach(this.fi,n=>{const i=Xt.fromPath(n);return this.gi(e,i).next(o=>{o||r.removeEntry(i,mr.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return wt.or([()=>wt.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class Nh{constructor(e,r){this.persistence=e,this.pi=new $l(n=>vC(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=k4(this,r)}static mi(e,r){return new Nh(e,r)}Ei(){}di(e){return wt.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return wt.forEach(this.pi,(n,i)=>this.br(e,n,i).next(o=>o?wt.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ii(e,s=>this.br(e,s,r).next(a=>{a||(n++,o.removeEntry(s,mr.min()))})).next(()=>o.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),wt.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),wt.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),wt.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),wt.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=th(e.data.value)),r}br(e,r,n){return wt.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.pi.get(r);return wt.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cy{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=i}static As(e,r){let n=Mr(),i=Mr();for(const o of r.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new cy(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q4{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z4{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return LS()?8:yC(Ci())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,i){const o={result:null};return this.ys(e,r).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.ws(e,r,i,n).next(s=>{o.result=s})}).next(()=>{if(o.result)return;const s=new q4;return this.Ss(e,r,s).next(a=>{if(o.result=a,this.Vs)return this.bs(e,r,s,a.size)})}).next(()=>o.result)}bs(e,r,n,i){return n.documentReadCount<this.fs?(rc()<=Dr.DEBUG&&zt("QueryEngine","SDK will not create cache indexes for query:",nc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),wt.resolve()):(rc()<=Dr.DEBUG&&zt("QueryEngine","Query:",nc(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(rc()<=Dr.DEBUG&&zt("QueryEngine","The SDK decides to create cache indexes for query:",nc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Zo(r))):wt.resolve())}ys(e,r){if(vv(r))return wt.resolve(null);let n=Zo(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=Xp(r,null,"F"),n=Zo(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(o=>{const s=Mr(...o);return this.ps.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,n).next(c=>{const u=this.Ds(r,a);return this.Cs(r,u,s,c.readTime)?this.ys(e,Xp(r,null,"F")):this.vs(e,u,r,c)}))})))}ws(e,r,n,i){return vv(r)||i.isEqual(mr.min())?wt.resolve(null):this.ps.getDocuments(e,n).next(o=>{const s=this.Ds(r,o);return this.Cs(r,s,n,i)?wt.resolve(null):(rc()<=Dr.DEBUG&&zt("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),nc(r)),this.vs(e,s,r,dC(i,Tu)).next(a=>a))})}Ds(e,r){let n=new Gn(u2(e));return r.forEach((i,o)=>{Xh(e,o)&&(n=n.add(o))}),n}Cs(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const o=e.limitType==="F"?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Ss(e,r,n){return rc()<=Dr.DEBUG&&zt("QueryEngine","Using full collection scan to execute query:",nc(r)),this.ps.getDocumentsMatchingQuery(e,r,ka.min(),n)}vs(e,r,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next(o=>(r.forEach(s=>{o=o.insert(s.key,s)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uy="LocalStore",U4=3e8;class H4{constructor(e,r,n,i){this.persistence=e,this.Fs=r,this.serializer=i,this.Ms=new Sn(Rr),this.xs=new $l(o=>ey(o),ty),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new L4(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function W4(t,e,r,n){return new H4(t,e,r,n)}async function D2(t,e){const r=_r(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(o=>(i=o,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(o=>{const s=[],a=[];let c=Mr();for(const u of i){s.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}for(const u of o){a.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}return r.localDocuments.getDocuments(n,c).next(u=>({Ls:u,removedBatchIds:s,addedBatchIds:a}))})})}function G4(t,e){const r=_r(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),o=r.Ns.newChangeBuffer({trackRemovals:!0});return function(a,c,u,h){const y=u.batch,g=y.keys();let p=wt.resolve();return g.forEach(C=>{p=p.next(()=>h.getEntry(c,C)).next(S=>{const w=u.docVersions.get(C);en(w!==null,48541),S.version.compareTo(w)<0&&(y.applyToRemoteDocument(S,u),S.isValidDocument()&&(S.setReadTime(u.commitVersion),h.addEntry(S)))})}),p.next(()=>a.mutationQueue.removeMutationBatch(c,y))}(r,n,e,o).next(()=>o.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(a){let c=Mr();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function R2(t){const e=_r(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function Y4(t,e){const r=_r(t),n=e.snapshotVersion;let i=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const s=r.Ns.newChangeBuffer({trackRemovals:!0});i=r.Ms;const a=[];e.targetChanges.forEach((h,y)=>{const g=i.get(y);if(!g)return;a.push(r.Pi.removeMatchingKeys(o,h.removedDocuments,y).next(()=>r.Pi.addMatchingKeys(o,h.addedDocuments,y)));let p=g.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(y)!==null?p=p.withResumeToken(di.EMPTY_BYTE_STRING,mr.min()).withLastLimboFreeSnapshotVersion(mr.min()):h.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(h.resumeToken,n)),i=i.insert(y,p),function(S,w,x){return S.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=U4?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(g,p,h)&&a.push(r.Pi.updateTargetData(o,p))});let c=Fs(),u=Mr();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(r.persistence.referenceDelegate.updateLimboDocument(o,h))}),a.push(K4(o,s,e.documentUpdates).next(h=>{c=h.ks,u=h.qs})),!n.isEqual(mr.min())){const h=r.Pi.getLastRemoteSnapshotVersion(o).next(y=>r.Pi.setTargetsMetadata(o,o.currentSequenceNumber,n));a.push(h)}return wt.waitFor(a).next(()=>s.apply(o)).next(()=>r.localDocuments.getLocalViewOfDocuments(o,c,u)).next(()=>c)}).then(o=>(r.Ms=i,o))}function K4(t,e,r){let n=Mr(),i=Mr();return r.forEach(o=>n=n.add(o)),e.getEntries(t,n).next(o=>{let s=Fs();return r.forEach((a,c)=>{const u=o.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(mr.min())?(e.removeEntry(a,c.readTime),s=s.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),s=s.insert(a,c)):zt(uy,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{ks:s,qs:i}})}function J4(t,e){const r=_r(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Qm),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function Q4(t,e){const r=_r(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Pi.getTargetData(n,e).next(o=>o?(i=o,wt.resolve(i)):r.Pi.allocateTargetId(n).next(s=>(i=new _a(e,s,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function nm(t,e,r){const n=_r(t),i=n.Ms.get(e),o=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",o,s=>n.persistence.referenceDelegate.removeTarget(s,i))}catch(s){if(!Ec(s))throw s;zt(uy,`Failed to update sequence numbers for target ${e}: ${s}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function Tv(t,e,r){const n=_r(t);let i=mr.min(),o=Mr();return n.persistence.runTransaction("Execute query","readwrite",s=>function(c,u,h){const y=_r(c),g=y.xs.get(h);return g!==void 0?wt.resolve(y.Ms.get(g)):y.Pi.getTargetData(u,h)}(n,s,Zo(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(s,a.targetId).next(c=>{o=c})}).next(()=>n.Fs.getDocumentsMatchingQuery(s,e,r?i:mr.min(),r?o:Mr())).next(a=>(X4(n,FC(e),a),{documents:a,Qs:o})))}function X4(t,e,r){let n=t.Os.get(e)||mr.min();r.forEach((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)}),t.Os.set(e,n)}class Nv{constructor(){this.activeTargetIds=zC()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Z4{constructor(){this.Mo=new Nv,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Nv,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e3{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lv="ConnectivityMonitor";class Dv{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){zt(Lv,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){zt(Lv,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Td=null;function im(){return Td===null?Td=function(){return 268435456+Math.round(2147483648*Math.random())}():Td++,"0x"+Td.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hf="RestConnection",t3={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class r3{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===Ch?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,r,n,i,o){const s=im(),a=this.zo(e,r.toUriEncodedString());zt(Hf,`Sending RPC '${e}' ${s}:`,a,n);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,i,o);const{host:u}=new URL(a),h=xc(u);return this.Jo(e,a,c,n,h).then(y=>(zt(Hf,`Received RPC '${e}' ${s}: `,y),y),y=>{throw gc(Hf,`RPC '${e}' ${s} failed with error: `,y,"url: ",a,"request:",n),y})}Ho(e,r,n,i,o,s){return this.Go(e,r,n,i,o)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ic}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>e[o]=i),n&&n.headers.forEach((i,o)=>e[o]=i)}zo(e,r){const n=t3[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n3{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pi="WebChannelConnection";class i3 extends r3{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,i,o){const s=im();return new Promise((a,c)=>{const u=new Fb;u.setWithCredentials(!0),u.listenOnce(Ob.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case eh.NO_ERROR:const y=u.getResponseJson();zt(pi,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(y)),a(y);break;case eh.TIMEOUT:zt(pi,`RPC '${e}' ${s} timed out`),c(new Bt(dt.DEADLINE_EXCEEDED,"Request time out"));break;case eh.HTTP_ERROR:const g=u.getStatus();if(zt(pi,`RPC '${e}' ${s} failed with status:`,g,"response text:",u.getResponseText()),g>0){let p=u.getResponseJson();Array.isArray(p)&&(p=p[0]);const C=p?.error;if(C&&C.status&&C.message){const S=function(x){const V=x.toLowerCase().replace(/_/g,"-");return Object.values(dt).indexOf(V)>=0?V:dt.UNKNOWN}(C.status);c(new Bt(S,C.message))}else c(new Bt(dt.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new Bt(dt.UNAVAILABLE,"Connection failed."));break;default:ur(9055,{l_:e,streamId:s,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{zt(pi,`RPC '${e}' ${s} completed.`)}});const h=JSON.stringify(i);zt(pi,`RPC '${e}' ${s} sending request:`,i),u.send(r,"POST",h,n,15)})}T_(e,r,n){const i=im(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Vb(),a=jb(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const h=o.join("");zt(pi,`Creating RPC '${e}' stream ${i}: ${h}`,c);const y=s.createWebChannel(h,c);this.I_(y);let g=!1,p=!1;const C=new n3({Yo:w=>{p?zt(pi,`Not sending because RPC '${e}' stream ${i} is closed:`,w):(g||(zt(pi,`Opening RPC '${e}' stream ${i} transport.`),y.open(),g=!0),zt(pi,`RPC '${e}' stream ${i} sending:`,w),y.send(w))},Zo:()=>y.close()}),S=(w,x,V)=>{w.listen(x,ne=>{try{V(ne)}catch(X){setTimeout(()=>{throw X},0)}})};return S(y,nu.EventType.OPEN,()=>{p||(zt(pi,`RPC '${e}' stream ${i} transport opened.`),C.o_())}),S(y,nu.EventType.CLOSE,()=>{p||(p=!0,zt(pi,`RPC '${e}' stream ${i} transport closed`),C.a_(),this.E_(y))}),S(y,nu.EventType.ERROR,w=>{p||(p=!0,gc(pi,`RPC '${e}' stream ${i} transport errored. Name:`,w.name,"Message:",w.message),C.a_(new Bt(dt.UNAVAILABLE,"The operation could not be completed")))}),S(y,nu.EventType.MESSAGE,w=>{if(!p){const x=w.data[0];en(!!x,16349);const V=x,ne=V?.error||V[0]?.error;if(ne){zt(pi,`RPC '${e}' stream ${i} received error:`,ne);const X=ne.status;let Q=function(A){const T=jn[A];if(T!==void 0)return S2(T)}(X),ee=ne.message;Q===void 0&&(Q=dt.INTERNAL,ee="Unknown error status: "+X+" with message "+ne.message),p=!0,C.a_(new Bt(Q,ee)),y.close()}else zt(pi,`RPC '${e}' stream ${i} received:`,x),C.u_(x)}}),S(a,Bb.STAT_EVENT,w=>{w.stat===Hp.PROXY?zt(pi,`RPC '${e}' stream ${i} detected buffering proxy`):w.stat===Hp.NOPROXY&&zt(pi,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{C.__()},0),C}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function Wf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rf(t){return new l4(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M2{constructor(e,r,n=1e3,i=1.5,o=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=i,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,r-n);i>0&&zt("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rv="PersistentStream";class F2{constructor(e,r,n,i,o,s,a,c){this.Mi=e,this.S_=n,this.b_=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new M2(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===dt.RESOURCE_EXHAUSTED?(Rs(r.toString()),Rs("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===dt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.D_===r&&this.G_(n,i)},n=>{e(()=>{const i=new Bt(dt.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{n(()=>this.z_(i))}),this.stream.onMessage(i=>{n(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return zt(Rv,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(zt(Rv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class o3 extends F2{constructor(e,r,n,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,s),this.serializer=o}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=d4(this.serializer,e),n=function(o){if(!("targetChange"in o))return mr.min();const s=o.targetChange;return s.targetIds&&s.targetIds.length?mr.min():s.readTime?ts(s.readTime):mr.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=rm(this.serializer),r.addTarget=function(o,s){let a;const c=s.target;if(a=Jp(c)?{documents:p4(o,c)}:{query:m4(o,c).ft},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=A2(o,s.resumeToken);const u=Zp(o,s.expectedCount);u!==null&&(a.expectedCount=u)}else if(s.snapshotVersion.compareTo(mr.min())>0){a.readTime=Th(o,s.snapshotVersion.toTimestamp());const u=Zp(o,s.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const n=g4(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=rm(this.serializer),r.removeTarget=e,this.q_(r)}}class s3 extends F2{constructor(e,r,n,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,s),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return en(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,en(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){en(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=f4(e.writeResults,e.commitTime),n=ts(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=rm(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>h4(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a3{}class l3 extends a3{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Bt(dt.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Go(e,em(r,n),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===dt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Bt(dt.UNKNOWN,o.toString())})}Ho(e,r,n,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Ho(e,em(r,n),i,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===dt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Bt(dt.UNKNOWN,s.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class c3{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Rs(r),this.aa=!1):zt("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cl="RemoteStore";class u3{constructor(e,r,n,i,o){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo(s=>{n.enqueueAndForget(async()=>{El(this)&&(zt(Cl,"Restarting streams for network reachability change."),await async function(c){const u=_r(c);u.Ea.add(4),await Qu(u),u.Ra.set("Unknown"),u.Ea.delete(4),await nf(u)}(this))})}),this.Ra=new c3(n,i)}}async function nf(t){if(El(t))for(const e of t.da)await e(!0)}async function Qu(t){for(const e of t.da)await e(!1)}function O2(t,e){const r=_r(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),py(r)?fy(r):Tc(r).O_()&&hy(r,e))}function dy(t,e){const r=_r(t),n=Tc(r);r.Ia.delete(e),n.O_()&&B2(r,e),r.Ia.size===0&&(n.O_()?n.L_():El(r)&&r.Ra.set("Unknown"))}function hy(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(mr.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Tc(t).Y_(e)}function B2(t,e){t.Va.Ue(e),Tc(t).Z_(e)}function fy(t){t.Va=new i4({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Tc(t).start(),t.Ra.ua()}function py(t){return El(t)&&!Tc(t).x_()&&t.Ia.size>0}function El(t){return _r(t).Ea.size===0}function j2(t){t.Va=void 0}async function d3(t){t.Ra.set("Online")}async function h3(t){t.Ia.forEach((e,r)=>{hy(t,e)})}async function f3(t,e){j2(t),py(t)?(t.Ra.ha(e),fy(t)):t.Ra.set("Unknown")}async function p3(t,e,r){if(t.Ra.set("Online"),e instanceof x2&&e.state===2&&e.cause)try{await async function(i,o){const s=o.cause;for(const a of o.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,s),i.Ia.delete(a),i.Va.removeTarget(a))}(t,e)}catch(n){zt(Cl,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Lh(t,n)}else if(e instanceof ih?t.Va.Ze(e):e instanceof P2?t.Va.st(e):t.Va.tt(e),!r.isEqual(mr.min()))try{const n=await R2(t.localStore);r.compareTo(n)>=0&&await function(o,s){const a=o.Va.Tt(s);return a.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const h=o.Ia.get(u);h&&o.Ia.set(u,h.withResumeToken(c.resumeToken,s))}}),a.targetMismatches.forEach((c,u)=>{const h=o.Ia.get(c);if(!h)return;o.Ia.set(c,h.withResumeToken(di.EMPTY_BYTE_STRING,h.snapshotVersion)),B2(o,c);const y=new _a(h.target,c,u,h.sequenceNumber);hy(o,y)}),o.remoteSyncer.applyRemoteEvent(a)}(t,r)}catch(n){zt(Cl,"Failed to raise snapshot:",n),await Lh(t,n)}}async function Lh(t,e,r){if(!Ec(e))throw e;t.Ea.add(1),await Qu(t),t.Ra.set("Offline"),r||(r=()=>R2(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{zt(Cl,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await nf(t)})}function V2(t,e){return e().catch(r=>Lh(t,r,e))}async function of(t){const e=_r(t),r=Da(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Qm;for(;m3(e);)try{const i=await J4(e.localStore,n);if(i===null){e.Ta.length===0&&r.L_();break}n=i.batchId,y3(e,i)}catch(i){await Lh(e,i)}q2(e)&&z2(e)}function m3(t){return El(t)&&t.Ta.length<10}function y3(t,e){t.Ta.push(e);const r=Da(t);r.O_()&&r.X_&&r.ea(e.mutations)}function q2(t){return El(t)&&!Da(t).x_()&&t.Ta.length>0}function z2(t){Da(t).start()}async function g3(t){Da(t).ra()}async function v3(t){const e=Da(t);for(const r of t.Ta)e.ea(r.mutations)}async function b3(t,e,r){const n=t.Ta.shift(),i=iy.from(n,e,r);await V2(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await of(t)}async function _3(t,e){e&&Da(t).X_&&await async function(n,i){if(function(s){return t4(s)&&s!==dt.ABORTED}(i.code)){const o=n.Ta.shift();Da(n).B_(),await V2(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,i)),await of(n)}}(t,e),q2(t)&&z2(t)}async function Mv(t,e){const r=_r(t);r.asyncQueue.verifyOperationInProgress(),zt(Cl,"RemoteStore received new credentials");const n=El(r);r.Ea.add(3),await Qu(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await nf(r)}async function w3(t,e){const r=_r(t);e?(r.Ea.delete(2),await nf(r)):e||(r.Ea.add(2),await Qu(r),r.Ra.set("Unknown"))}function Tc(t){return t.ma||(t.ma=function(r,n,i){const o=_r(r);return o.sa(),new o3(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Xo:d3.bind(null,t),t_:h3.bind(null,t),r_:f3.bind(null,t),H_:p3.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),py(t)?fy(t):t.Ra.set("Unknown")):(await t.ma.stop(),j2(t))})),t.ma}function Da(t){return t.fa||(t.fa=function(r,n,i){const o=_r(r);return o.sa(),new s3(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:g3.bind(null,t),r_:_3.bind(null,t),ta:v3.bind(null,t),na:b3.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await of(t)):(await t.fa.stop(),t.Ta.length>0&&(zt(Cl,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class my{constructor(e,r,n,i,o){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new Ns,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,o){const s=Date.now()+n,a=new my(e,r,s,i,o);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Bt(dt.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function yy(t,e){if(Rs("AsyncQueue",`${e}: ${t}`),Ec(t))return new Bt(dt.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hc{static emptySet(e){return new hc(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||Xt.comparator(r.key,n.key):(r,n)=>Xt.comparator(r.key,n.key),this.keyedMap=iu(),this.sortedSet=new Sn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof hc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new hc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(){this.ga=new Sn(Xt.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):ur(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class Sc{constructor(e,r,n,i,o,s,a,c,u){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,r,n,i,o){const s=[];return r.forEach(a=>{s.push({type:0,doc:a})}),new Sc(e,r,hc.emptySet(r),s,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Qh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S3{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class P3{constructor(){this.queries=Ov(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const i=_r(r),o=i.queries;i.queries=Ov(),o.forEach((s,a)=>{for(const c of a.Sa)c.onError(n)})})(this,new Bt(dt.ABORTED,"Firestore shutting down"))}}function Ov(){return new $l(t=>c2(t),Qh)}async function U2(t,e){const r=_r(t);let n=3;const i=e.query;let o=r.queries.get(i);o?!o.ba()&&e.Da()&&(n=2):(o=new S3,n=e.Da()?0:1);try{switch(n){case 0:o.wa=await r.onListen(i,!0);break;case 1:o.wa=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(s){const a=yy(s,`Initialization of query '${nc(e.query)}' failed`);return void e.onError(a)}r.queries.set(i,o),o.Sa.push(e),e.va(r.onlineState),o.wa&&e.Fa(o.wa)&&gy(r)}async function H2(t,e){const r=_r(t),n=e.query;let i=3;const o=r.queries.get(n);if(o){const s=o.Sa.indexOf(e);s>=0&&(o.Sa.splice(s,1),o.Sa.length===0?i=e.Da()?0:1:!o.ba()&&e.Da()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function x3(t,e){const r=_r(t);let n=!1;for(const i of e){const o=i.query,s=r.queries.get(o);if(s){for(const a of s.Sa)a.Fa(i)&&(n=!0);s.wa=i}}n&&gy(r)}function A3(t,e,r){const n=_r(t),i=n.queries.get(e);if(i)for(const o of i.Sa)o.onError(r);n.queries.delete(e)}function gy(t){t.Ca.forEach(e=>{e.next()})}var om,Bv;(Bv=om||(om={})).Ma="default",Bv.Cache="cache";class W2{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Sc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=Sc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==om.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G2{constructor(e){this.key=e}}class Y2{constructor(e){this.key=e}}class C3{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Mr(),this.mutatedKeys=Mr(),this.eu=u2(e),this.tu=new hc(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new Fv,i=r?r.tu:this.tu;let o=r?r.mutatedKeys:this.mutatedKeys,s=i,a=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,y)=>{const g=i.get(h),p=Xh(this.query,y)?y:null,C=!!g&&this.mutatedKeys.has(g.key),S=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let w=!1;g&&p?g.data.isEqual(p.data)?C!==S&&(n.track({type:3,doc:p}),w=!0):this.su(g,p)||(n.track({type:2,doc:p}),w=!0,(c&&this.eu(p,c)>0||u&&this.eu(p,u)<0)&&(a=!0)):!g&&p?(n.track({type:0,doc:p}),w=!0):g&&!p&&(n.track({type:1,doc:g}),w=!0,(c||u)&&(a=!0)),w&&(p?(s=s.add(p),o=S?o.add(h):o.delete(h)):(s=s.delete(h),o=o.delete(h)))}),this.query.limit!==null)for(;s.size>this.query.limit;){const h=this.query.limitType==="F"?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),n.track({type:1,doc:h})}return{tu:s,iu:n,Cs:a,mutatedKeys:o}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort((h,y)=>function(p,C){const S=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ur(20277,{Rt:w})}};return S(p)-S(C)}(h.type,y.type)||this.eu(h.doc,y.doc)),this.ou(n),i=i??!1;const a=r&&!i?this._u():[],c=this.Xa.size===0&&this.current&&!i?1:0,u=c!==this.Za;return this.Za=c,s.length!==0||u?{snapshot:new Sc(this.query,e.tu,o,s,e.mutatedKeys,c===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Fv,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Mr(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new Y2(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new G2(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=Mr();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return Sc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const vy="SyncEngine";class I3{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class $3{constructor(e){this.key=e,this.hu=!1}}class E3{constructor(e,r,n,i,o,s){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new $l(a=>c2(a),Qh),this.Iu=new Map,this.Eu=new Set,this.du=new Sn(Xt.comparator),this.Au=new Map,this.Ru=new ay,this.Vu={},this.mu=new Map,this.fu=wc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function k3(t,e,r=!0){const n=e5(t);let i;const o=n.Tu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await K2(n,e,r,!0),i}async function T3(t,e){const r=e5(t);await K2(r,e,!0,!1)}async function K2(t,e,r,n){const i=await Q4(t.localStore,Zo(e)),o=i.targetId,s=t.sharedClientState.addLocalQueryTarget(o,r);let a;return n&&(a=await N3(t,e,o,s==="current",i.resumeToken)),t.isPrimaryClient&&r&&O2(t.remoteStore,i),a}async function N3(t,e,r,n,i){t.pu=(y,g,p)=>async function(S,w,x,V){let ne=w.view.ru(x);ne.Cs&&(ne=await Tv(S.localStore,w.query,!1).then(({documents:E})=>w.view.ru(E,ne)));const X=V&&V.targetChanges.get(w.targetId),Q=V&&V.targetMismatches.get(w.targetId)!=null,ee=w.view.applyChanges(ne,S.isPrimaryClient,X,Q);return Vv(S,w.targetId,ee.au),ee.snapshot}(t,y,g,p);const o=await Tv(t.localStore,e,!0),s=new C3(e,o.Qs),a=s.ru(o.documents),c=Ju.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),u=s.applyChanges(a,t.isPrimaryClient,c);Vv(t,r,u.au);const h=new I3(e,r,s);return t.Tu.set(e,h),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),u.snapshot}async function L3(t,e,r){const n=_r(t),i=n.Tu.get(e),o=n.Iu.get(i.targetId);if(o.length>1)return n.Iu.set(i.targetId,o.filter(s=>!Qh(s,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await nm(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&dy(n.remoteStore,i.targetId),sm(n,i.targetId)}).catch($c)):(sm(n,i.targetId),await nm(n.localStore,i.targetId,!0))}async function D3(t,e){const r=_r(t),n=r.Tu.get(e),i=r.Iu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),dy(r.remoteStore,n.targetId))}async function R3(t,e,r){const n=q3(t);try{const i=await function(s,a){const c=_r(s),u=vn.now(),h=a.reduce((p,C)=>p.add(C.key),Mr());let y,g;return c.persistence.runTransaction("Locally write mutations","readwrite",p=>{let C=Fs(),S=Mr();return c.Ns.getEntries(p,h).next(w=>{C=w,C.forEach((x,V)=>{V.isValidDocument()||(S=S.add(x))})}).next(()=>c.localDocuments.getOverlayedDocuments(p,C)).next(w=>{y=w;const x=[];for(const V of a){const ne=JC(V,y.get(V.key).overlayedDocument);ne!=null&&x.push(new Va(V.key,ne,t2(ne.value.mapValue),es.exists(!0)))}return c.mutationQueue.addMutationBatch(p,u,x,a)}).next(w=>{g=w;const x=w.applyToLocalDocumentSet(y,S);return c.documentOverlayCache.saveOverlays(p,w.batchId,x)})}).then(()=>({batchId:g.batchId,changes:h2(y)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(s,a,c){let u=s.Vu[s.currentUser.toKey()];u||(u=new Sn(Rr)),u=u.insert(a,c),s.Vu[s.currentUser.toKey()]=u}(n,i.batchId,r),await Xu(n,i.changes),await of(n.remoteStore)}catch(i){const o=yy(i,"Failed to persist write");r.reject(o)}}async function J2(t,e){const r=_r(t);try{const n=await Y4(r.localStore,e);e.targetChanges.forEach((i,o)=>{const s=r.Au.get(o);s&&(en(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?s.hu=!0:i.modifiedDocuments.size>0?en(s.hu,14607):i.removedDocuments.size>0&&(en(s.hu,42227),s.hu=!1))}),await Xu(r,n,e)}catch(n){await $c(n)}}function jv(t,e,r){const n=_r(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Tu.forEach((o,s)=>{const a=s.view.va(e);a.snapshot&&i.push(a.snapshot)}),function(s,a){const c=_r(s);c.onlineState=a;let u=!1;c.queries.forEach((h,y)=>{for(const g of y.Sa)g.va(a)&&(u=!0)}),u&&gy(c)}(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function M3(t,e,r){const n=_r(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Au.get(e),o=i&&i.key;if(o){let s=new Sn(Xt.comparator);s=s.insert(o,wi.newNoDocument(o,mr.min()));const a=Mr().add(o),c=new tf(mr.min(),new Map,new Sn(Rr),s,a);await J2(n,c),n.du=n.du.remove(o),n.Au.delete(e),by(n)}else await nm(n.localStore,e,!1).then(()=>sm(n,e,r)).catch($c)}async function F3(t,e){const r=_r(t),n=e.batch.batchId;try{const i=await G4(r.localStore,e);X2(r,n,null),Q2(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Xu(r,i)}catch(i){await $c(i)}}async function O3(t,e,r){const n=_r(t);try{const i=await function(s,a){const c=_r(s);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return c.mutationQueue.lookupMutationBatch(u,a).next(y=>(en(y!==null,37113),h=y.keys(),c.mutationQueue.removeMutationBatch(u,y))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,h,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>c.localDocuments.getDocuments(u,h))})}(n.localStore,e);X2(n,e,r),Q2(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Xu(n,i)}catch(i){await $c(i)}}function Q2(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function X2(t,e,r){const n=_r(t);let i=n.Vu[n.currentUser.toKey()];if(i){const o=i.get(e);o&&(r?o.reject(r):o.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function sm(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||Z2(t,n)})}function Z2(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(dy(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),by(t))}function Vv(t,e,r){for(const n of r)n instanceof G2?(t.Ru.addReference(n.key,e),B3(t,n)):n instanceof Y2?(zt(vy,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||Z2(t,n.key)):ur(19791,{wu:n})}function B3(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(zt(vy,"New document in limbo: "+r),t.Eu.add(n),by(t))}function by(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new Xt(gn.fromString(e)),n=t.fu.next();t.Au.set(n,new $3(r)),t.du=t.du.insert(r,n),O2(t.remoteStore,new _a(Zo(ry(r.path)),n,"TargetPurposeLimboResolution",Yh.ce))}}async function Xu(t,e,r){const n=_r(t),i=[],o=[],s=[];n.Tu.isEmpty()||(n.Tu.forEach((a,c)=>{s.push(n.pu(c,e,r).then(u=>{if((u||r)&&n.isPrimaryClient){const h=u?!u.fromCache:r?.targetChanges.get(c.targetId)?.current;n.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(u){i.push(u);const h=cy.As(c.targetId,u);o.push(h)}}))}),await Promise.all(s),n.Pu.H_(i),await async function(c,u){const h=_r(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>wt.forEach(u,g=>wt.forEach(g.Es,p=>h.persistence.referenceDelegate.addReference(y,g.targetId,p)).next(()=>wt.forEach(g.ds,p=>h.persistence.referenceDelegate.removeReference(y,g.targetId,p)))))}catch(y){if(!Ec(y))throw y;zt(uy,"Failed to update sequence numbers: "+y)}for(const y of u){const g=y.targetId;if(!y.fromCache){const p=h.Ms.get(g),C=p.snapshotVersion,S=p.withLastLimboFreeSnapshotVersion(C);h.Ms=h.Ms.insert(g,S)}}}(n.localStore,o))}async function j3(t,e){const r=_r(t);if(!r.currentUser.isEqual(e)){zt(vy,"User change. New user:",e.toKey());const n=await D2(r.localStore,e);r.currentUser=e,function(o,s){o.mu.forEach(a=>{a.forEach(c=>{c.reject(new Bt(dt.CANCELLED,s))})}),o.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Xu(r,n.Ls)}}function V3(t,e){const r=_r(t),n=r.Au.get(e);if(n&&n.hu)return Mr().add(n.key);{let i=Mr();const o=r.Iu.get(e);if(!o)return i;for(const s of o){const a=r.Tu.get(s);i=i.unionWith(a.view.nu)}return i}}function e5(t){const e=_r(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=J2.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=V3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=M3.bind(null,e),e.Pu.H_=x3.bind(null,e.eventManager),e.Pu.yu=A3.bind(null,e.eventManager),e}function q3(t){const e=_r(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=F3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=O3.bind(null,e),e}class Dh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=rf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return W4(this.persistence,new z4,e.initialUser,this.serializer)}Cu(e){return new L2(ly.mi,this.serializer)}Du(e){return new Z4}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Dh.provider={build:()=>new Dh};class z3 extends Dh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){en(this.persistence.referenceDelegate instanceof Nh,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new $4(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?zi.withCacheSize(this.cacheSizeBytes):zi.DEFAULT;return new L2(n=>Nh.mi(n,r),this.serializer)}}class am{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>jv(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=j3.bind(null,this.syncEngine),await w3(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new P3}()}createDatastore(e){const r=rf(e.databaseInfo.databaseId),n=function(o){return new i3(o)}(e.databaseInfo);return function(o,s,a,c){return new l3(o,s,a,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,o,s,a){return new u3(n,i,o,s,a)}(this.localStore,this.datastore,e.asyncQueue,r=>jv(this.syncEngine,r,0),function(){return Dv.v()?new Dv:new e3}())}createSyncEngine(e,r){return function(i,o,s,a,c,u,h){const y=new E3(i,o,s,a,c,u);return h&&(y.gu=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await async function(r){const n=_r(r);zt(Cl,"RemoteStore shutting down."),n.Ea.add(5),await Qu(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}am.provider={build:()=>new am};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t5{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Rs("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ra="FirestoreClient";class U3{constructor(e,r,n,i,o){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=_i.UNAUTHENTICATED,this.clientId=Jm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,async s=>{zt(Ra,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(n,s=>(zt(Ra,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ns;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=yy(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Gf(t,e){t.asyncQueue.verifyOperationInProgress(),zt(Ra,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await D2(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function qv(t,e){t.asyncQueue.verifyOperationInProgress();const r=await H3(t);zt(Ra,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>Mv(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>Mv(e.remoteStore,i)),t._onlineComponents=e}async function H3(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){zt(Ra,"Using user provided OfflineComponentProvider");try{await Gf(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===dt.FAILED_PRECONDITION||i.code===dt.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;gc("Error using user provided cache. Falling back to memory cache: "+r),await Gf(t,new Dh)}}else zt(Ra,"Using default OfflineComponentProvider"),await Gf(t,new z3(void 0));return t._offlineComponents}async function r5(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(zt(Ra,"Using user provided OnlineComponentProvider"),await qv(t,t._uninitializedComponentsProvider._online)):(zt(Ra,"Using default OnlineComponentProvider"),await qv(t,new am))),t._onlineComponents}function W3(t){return r5(t).then(e=>e.syncEngine)}async function n5(t){const e=await r5(t),r=e.eventManager;return r.onListen=k3.bind(null,e.syncEngine),r.onUnlisten=L3.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=T3.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=D3.bind(null,e.syncEngine),r}function G3(t,e,r={}){const n=new Ns;return t.asyncQueue.enqueueAndForget(async()=>function(o,s,a,c,u){const h=new t5({next:g=>{h.Nu(),s.enqueueAndForget(()=>H2(o,y));const p=g.docs.has(a);!p&&g.fromCache?u.reject(new Bt(dt.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&g.fromCache&&c&&c.source==="server"?u.reject(new Bt(dt.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),y=new W2(ry(a.path),h,{includeMetadataChanges:!0,qa:!0});return U2(o,y)}(await n5(t),t.asyncQueue,e,r,n)),n.promise}function Y3(t,e,r={}){const n=new Ns;return t.asyncQueue.enqueueAndForget(async()=>function(o,s,a,c,u){const h=new t5({next:g=>{h.Nu(),s.enqueueAndForget(()=>H2(o,y)),g.fromCache&&c.source==="server"?u.reject(new Bt(dt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),y=new W2(a,h,{includeMetadataChanges:!0,qa:!0});return U2(o,y)}(await n5(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i5(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zv=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o5="firestore.googleapis.com",Uv=!0;class Hv{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Bt(dt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=o5,this.ssl=Uv}else this.host=e.host,this.ssl=e.ssl??Uv;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=N2;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<C4)throw new Bt(dt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}uC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=i5(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Bt(dt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Bt(dt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Bt(dt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class sf{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Hv({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Bt(dt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Bt(dt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Hv(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new eC;switch(n.type){case"firstParty":return new iC(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Bt(dt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=zv.get(r);n&&(zt("ComponentProvider","Removing Datastore"),zv.delete(r),n.terminate())}(this),Promise.resolve()}}function K3(t,e,r,n={}){t=Ms(t,sf);const i=xc(e),o=t._getSettings(),s={...o,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${r}`;i&&(Y1(`https://${a}`),K1("Firestore",!0)),o.host!==o5&&o.host!==a&&gc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...o,host:a,ssl:i,emulatorOptions:n};if(!Sl(c,s)&&(t._setSettings(c),n.mockUserToken)){let u,h;if(typeof n.mockUserToken=="string")u=n.mockUserToken,h=_i.MOCK_USER;else{u=xS(n.mockUserToken,t._app?.options.projectId);const y=n.mockUserToken.sub||n.mockUserToken.user_id;if(!y)throw new Bt(dt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new _i(y)}t._authCredentials=new tC(new zb(u,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new kl(this.firestore,e,this._query)}}class Dn{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new $a(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Dn(this.firestore,e,this._key)}toJSON(){return{type:Dn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(Yu(r,Dn._jsonSchema))return new Dn(e,n||null,new Xt(gn.fromString(r.referencePath)))}}Dn._jsonSchemaVersion="firestore/documentReference/1.0",Dn._jsonSchema={type:qn("string",Dn._jsonSchemaVersion),referencePath:qn("string")};class $a extends kl{constructor(e,r,n){super(e,r,ry(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Dn(this.firestore,null,new Xt(e))}withConverter(e){return new $a(this.firestore,e,this._path)}}function J3(t,e,...r){if(t=ui(t),Ub("collection","path",e),t instanceof sf){const n=gn.fromString(e,...r);return iv(n),new $a(t,null,n)}{if(!(t instanceof Dn||t instanceof $a))throw new Bt(dt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(gn.fromString(e,...r));return iv(n),new $a(t.firestore,null,n)}}function s5(t,e,...r){if(t=ui(t),arguments.length===1&&(e=Jm.newId()),Ub("doc","path",e),t instanceof sf){const n=gn.fromString(e,...r);return nv(n),new Dn(t,null,new Xt(n))}{if(!(t instanceof Dn||t instanceof $a))throw new Bt(dt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(gn.fromString(e,...r));return nv(n),new Dn(t.firestore,t instanceof $a?t.converter:null,new Xt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wv="AsyncQueue";class Gv{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new M2(this,"async_queue_retry"),this._c=()=>{const n=Wf();n&&zt(Wv,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=Wf();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=Wf();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new Ns;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ec(e))throw e;zt(Wv,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,Rs("INTERNAL UNHANDLED ERROR: ",Yv(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const i=my.createAndSchedule(this,e,r,n,o=>this.hc(o));return this.tc.push(i),i}uc(){this.nc&&ur(47125,{Pc:Yv(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function Yv(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Zu extends sf{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new Gv,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Gv(e),this._firestoreClient=void 0,await e}}}function Q3(t,e){const r=typeof t=="object"?t:Z1(),n=typeof t=="string"?t:Ch,i=Om(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const o=SS("firestore");o&&K3(i,...o)}return i}function _y(t){if(t._terminated)throw new Bt(dt.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||X3(t),t._firestoreClient}function X3(t){const e=t._freezeSettings(),r=function(i,o,s,a){return new wC(i,o,s,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,i5(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator)}(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new U3(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(i){const o=i?._online.build();return{_offline:i?._offline.build(o),_online:o}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(e){this._byteString=e}static fromBase64String(e){try{return new go(di.fromBase64String(e))}catch(r){throw new Bt(dt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new go(di.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:go._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Yu(e,go._jsonSchema))return go.fromBase64String(e.bytes)}}go._jsonSchemaVersion="firestore/bytes/1.0",go._jsonSchema={type:qn("string",go._jsonSchemaVersion),bytes:qn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class af{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Bt(dt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ai(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Bt(dt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Bt(dt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Rr(this._lat,e._lat)||Rr(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:rs._jsonSchemaVersion}}static fromJSON(e){if(Yu(e,rs._jsonSchema))return new rs(e.latitude,e.longitude)}}rs._jsonSchemaVersion="firestore/geoPoint/1.0",rs._jsonSchema={type:qn("string",rs._jsonSchemaVersion),latitude:qn("number"),longitude:qn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==i[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ns._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Yu(e,ns._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new ns(e.vectorValues);throw new Bt(dt.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ns._jsonSchemaVersion="firestore/vectorValue/1.0",ns._jsonSchema={type:qn("string",ns._jsonSchemaVersion),vectorValues:qn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z3=/^__.*__$/;class eI{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Va(e,this.data,this.fieldMask,r,this.fieldTransforms):new Ku(e,this.data,r,this.fieldTransforms)}}class a5{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Va(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function l5(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ur(40011,{Ac:t})}}class Sy{constructor(e,r,n,i,o,s){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Sy({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Rh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(l5(this.Ac)&&Z3.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class tI{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||rf(e)}Cc(e,r,n,i=!1){return new Sy({Ac:e,methodName:r,Dc:n,path:ai.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Py(t){const e=t._freezeSettings(),r=rf(t._databaseId);return new tI(t._databaseId,!!e.ignoreUndefinedProperties,r)}function rI(t,e,r,n,i,o={}){const s=t.Cc(o.merge||o.mergeFields?2:0,e,r,i);xy("Data must be an object, but it was:",s,n);const a=c5(n,s);let c,u;if(o.merge)c=new Zi(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){const h=[];for(const y of o.mergeFields){const g=lm(e,y,r);if(!s.contains(g))throw new Bt(dt.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);d5(h,g)||h.push(g)}c=new Zi(h),u=s.fieldTransforms.filter(y=>c.covers(y.field))}else c=null,u=s.fieldTransforms;return new eI(new Ui(a),c,u)}class lf extends wy{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof lf}}function nI(t,e,r,n){const i=t.Cc(1,e,r);xy("Data must be an object, but it was:",i,n);const o=[],s=Ui.empty();ja(n,(c,u)=>{const h=Ay(e,c,r);u=ui(u);const y=i.yc(h);if(u instanceof lf)o.push(h);else{const g=ed(u,y);g!=null&&(o.push(h),s.set(h,g))}});const a=new Zi(o);return new a5(s,a,i.fieldTransforms)}function iI(t,e,r,n,i,o){const s=t.Cc(1,e,r),a=[lm(e,n,r)],c=[i];if(o.length%2!=0)throw new Bt(dt.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<o.length;g+=2)a.push(lm(e,o[g])),c.push(o[g+1]);const u=[],h=Ui.empty();for(let g=a.length-1;g>=0;--g)if(!d5(u,a[g])){const p=a[g];let C=c[g];C=ui(C);const S=s.yc(p);if(C instanceof lf)u.push(p);else{const w=ed(C,S);w!=null&&(u.push(p),h.set(p,w))}}const y=new Zi(u);return new a5(h,y,s.fieldTransforms)}function oI(t,e,r,n=!1){return ed(r,t.Cc(n?4:3,e))}function ed(t,e){if(u5(t=ui(t)))return xy("Unsupported field value:",e,t),c5(t,e);if(t instanceof wy)return function(n,i){if(!l5(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,i){const o=[];let s=0;for(const a of n){let c=ed(a,i.wc(s));c==null&&(c={nullValue:"NULL_VALUE"}),o.push(c),s++}return{arrayValue:{values:o}}}(t,e)}return function(n,i){if((n=ui(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return UC(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=vn.fromDate(n);return{timestampValue:Th(i.serializer,o)}}if(n instanceof vn){const o=new vn(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Th(i.serializer,o)}}if(n instanceof rs)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof go)return{bytesValue:A2(i.serializer,n._byteString)};if(n instanceof Dn){const o=i.databaseId,s=n.firestore._databaseId;if(!s.isEqual(o))throw i.Sc(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:sy(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof ns)return function(s,a){return{mapValue:{fields:{[Zb]:{stringValue:e2},[Ih]:{arrayValue:{values:s.toArray().map(u=>{if(typeof u!="number")throw a.Sc("VectorValues must only contain numeric values.");return ny(a.serializer,u)})}}}}}}(n,i);throw i.Sc(`Unsupported field value: ${Gh(n)}`)}(t,e)}function c5(t,e){const r={};return Gb(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ja(t,(n,i)=>{const o=ed(i,e.mc(n));o!=null&&(r[n]=o)}),{mapValue:{fields:r}}}function u5(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof vn||t instanceof rs||t instanceof go||t instanceof Dn||t instanceof wy||t instanceof ns)}function xy(t,e,r){if(!u5(r)||!Hb(r)){const n=Gh(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function lm(t,e,r){if((e=ui(e))instanceof af)return e._internalPath;if(typeof e=="string")return Ay(t,e);throw Rh("Field path arguments must be of type string or ",t,!1,void 0,r)}const sI=new RegExp("[~\\*/\\[\\]]");function Ay(t,e,r){if(e.search(sI)>=0)throw Rh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new af(...e.split("."))._internalPath}catch{throw Rh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Rh(t,e,r,n,i){const o=n&&!n.isEmpty(),s=i!==void 0;let a=`Function ${e}() called with invalid data`;r&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=` in field ${n}`),s&&(c+=` in document ${i}`),c+=")"),new Bt(dt.INVALID_ARGUMENT,a+t+c)}function d5(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h5{constructor(e,r,n,i,o){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Dn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new aI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Cy("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class aI extends h5{data(){return super.data()}}function Cy(t,e){return typeof e=="string"?Ay(t,e):e instanceof af?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lI(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Bt(dt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Iy{}class f5 extends Iy{}function cI(t,e,...r){let n=[];e instanceof Iy&&n.push(e),n=n.concat(r),function(o){const s=o.filter(c=>c instanceof Ey).length,a=o.filter(c=>c instanceof $y).length;if(s>1||s>0&&a>0)throw new Bt(dt.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)t=i._apply(t);return t}class $y extends f5{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new $y(e,r,n)}_apply(e){const r=this._parse(e);return p5(e._query,r),new kl(e.firestore,e.converter,Qp(e._query,r))}_parse(e){const r=Py(e.firestore);return function(o,s,a,c,u,h,y){let g;if(u.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new Bt(dt.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){Jv(y,h);const C=[];for(const S of y)C.push(Kv(c,o,S));g={arrayValue:{values:C}}}else g=Kv(c,o,y)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||Jv(y,h),g=oI(a,s,y,h==="in"||h==="not-in");return Vn.create(u,h,g)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}class Ey extends Iy{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new Ey(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Ro.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(i,o){let s=i;const a=o.getFlattenedFilters();for(const c of a)p5(s,c),s=Qp(s,c)}(e._query,r),new kl(e.firestore,e.converter,Qp(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class ky extends f5{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new ky(e,r)}_apply(e){const r=function(i,o,s){if(i.startAt!==null)throw new Bt(dt.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Bt(dt.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ru(o,s)}(e._query,this._field,this._direction);return new kl(e.firestore,e.converter,function(i,o){const s=i.explicitOrderBy.concat([o]);return new kc(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}function uI(t,e="asc"){const r=e,n=Cy("orderBy",t);return ky._create(n,r)}function Kv(t,e,r){if(typeof(r=ui(r))=="string"){if(r==="")throw new Bt(dt.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!l2(e)&&r.indexOf("/")!==-1)throw new Bt(dt.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(gn.fromString(r));if(!Xt.isDocumentKey(n))throw new Bt(dt.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return hv(t,new Xt(n))}if(r instanceof Dn)return hv(t,r._key);throw new Bt(dt.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Gh(r)}.`)}function Jv(t,e){if(!Array.isArray(t)||t.length===0)throw new Bt(dt.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function p5(t,e){const r=function(i,o){for(const s of i)for(const a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Bt(dt.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Bt(dt.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class dI{convertValue(e,r="none"){switch(La(e)){case 0:return null;case 1:return e.booleanValue;case 2:return kn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Na(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw ur(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return ja(e,(i,o)=>{n[i]=this.convertValue(o,r)}),n}convertVectorValue(e){const r=e.fields?.[Ih].arrayValue?.values?.map(n=>kn(n.doubleValue));return new ns(r)}convertGeoPoint(e){return new rs(kn(e.latitude),kn(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Jh(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Nu(e));default:return null}}convertTimestamp(e){const r=Ta(e);return new vn(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=gn.fromString(e);en(T2(n),9688,{name:e});const i=new Lu(n.get(1),n.get(3)),o=new Xt(n.popFirst(5));return i.isEqual(r)||Rs(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hI(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class su{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class gl extends h5{constructor(e,r,n,i,o,s){super(e,r,n,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new oh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Cy("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Bt(dt.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=gl._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}gl._jsonSchemaVersion="firestore/documentSnapshot/1.0",gl._jsonSchema={type:qn("string",gl._jsonSchemaVersion),bundleSource:qn("string","DocumentSnapshot"),bundleName:qn("string"),bundle:qn("string")};class oh extends gl{data(e={}){return super.data(e)}}class fc{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new su(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new oh(this._firestore,this._userDataWriter,n.key,n,new su(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Bt(dt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(a=>{const c=new oh(i._firestore,i._userDataWriter,a.doc.key,a.doc,new su(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{const c=new oh(i._firestore,i._userDataWriter,a.doc.key,a.doc,new su(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,h=-1;return a.type!==0&&(u=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),h=s.indexOf(a.doc.key)),{type:fI(a.type),doc:c,oldIndex:u,newIndex:h}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Bt(dt.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=fc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Jm.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(r.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function fI(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ur(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pI(t){t=Ms(t,Dn);const e=Ms(t.firestore,Zu);return G3(_y(e),t._key).then(r=>gI(e,t,r))}fc._jsonSchemaVersion="firestore/querySnapshot/1.0",fc._jsonSchema={type:qn("string",fc._jsonSchemaVersion),bundleSource:qn("string","QuerySnapshot"),bundleName:qn("string"),bundle:qn("string")};class m5 extends dI{constructor(e){super(),this.firestore=e}convertBytes(e){return new go(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Dn(this.firestore,null,r)}}function mI(t){t=Ms(t,kl);const e=Ms(t.firestore,Zu),r=_y(e),n=new m5(e);return lI(t._query),Y3(r,t._query).then(i=>new fc(e,n,t,i))}function yI(t,e,r){t=Ms(t,Dn);const n=Ms(t.firestore,Zu),i=hI(t.converter,e);return g5(n,[rI(Py(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,es.none())])}function y5(t,e,r,...n){t=Ms(t,Dn);const i=Ms(t.firestore,Zu),o=Py(i);let s;return s=typeof(e=ui(e))=="string"||e instanceof af?iI(o,"updateDoc",t._key,e,r,n):nI(o,"updateDoc",t._key,e),g5(i,[s.toMutation(t._key,es.exists(!0))])}function g5(t,e){return function(n,i){const o=new Ns;return n.asyncQueue.enqueueAndForget(async()=>R3(await W3(n),i,o)),o.promise}(_y(t),e)}function gI(t,e,r){const n=r.docs.get(e._key),i=new m5(t);return new gl(t,i,e._key,n,new su(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){Ic=i})(Ac),mc(new Pl("firestore",(n,{instanceIdentifier:i,options:o})=>{const s=n.getProvider("app").getImmediate(),a=new Zu(new rC(n.getProvider("auth-internal")),new oC(s,n.getProvider("app-check-internal")),function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Bt(dt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Lu(u.options.projectId,h)}(s,i),s);return o={useFetchStreams:r,...o},a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),Aa(Zg,ev,e),Aa(Zg,ev,"esm2020")})();let vI="eyAiYXBpS2V5IjogIkFJemFTeUJBbGN2WlRMMXRsQ05LRExENEJpTWJhR01iTnhCRjQtTSIsICAiYXV0aERvbWFpbiI6ICJocm0tMTEyOC5maXJlYmFzZWFwcC5jb20iLCAgImRhdGFiYXNlVVJMIjogImh0dHBzOi8vaHJtLTExMjguZmlyZWJhc2Vpby5jb20iLCAgInByb2plY3RJZCI6ICJocm0tMTEyOCIsICAic3RvcmFnZUJ1Y2tldCI6ICJocm0tMTEyOC5hcHBzcG90LmNvbSIsICAibWVzc2FnaW5nU2VuZGVySWQiOiAiMTA0OTI1MDU4NTI0NSIsICAiYXBwSWQiOiAiMToxMDQ5MjUwNTg1MjQ1OndlYjowZGFkMDAyMDI3MjM1MTRjY2M1Mjc0In0=";const v5=X1(JSON.parse(uS(vI))),ul=JA(v5),Mh=new Jo,cm=Q3(v5);Mh.addScope("profile");Mh.addScope("email");class au extends Error{}au.prototype.name="InvalidTokenError";function bI(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function _I(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return bI(e)}catch{return atob(e)}}function wI(t,e){if(typeof t!="string")throw new au("Invalid token specified: must be a string");e||(e={});const r=e.header===!0?0:1,n=t.split(".")[r];if(typeof n!="string")throw new au(`Invalid token specified: missing part #${r+1}`);let i;try{i=_I(n)}catch(o){throw new au(`Invalid token specified: invalid base64 for part #${r+1} (${o.message})`)}try{return JSON.parse(i)}catch(o){throw new au(`Invalid token specified: invalid json for part #${r+1} (${o.message})`)}}const SI={clientId:"195275085181-8ccjpgp8v1g80qhnlk6v4lpgid7n81gr.apps.googleusercontent.com"},PI=t=>{const e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.onload=()=>{window.google&&window.google.accounts.id.initialize({client_id:SI.clientId,callback:r=>{t(r.credential)},auto_select:!1,cancel_on_tap_outside:!0})},document.head.appendChild(e)},xI=t=>wI(t),AI=()=>{window.google&&window.google.accounts.id.disableAutoSelect()},[CI,II]=qh({}),$I=async()=>{const e=await qi({query:"qcm42351987"});if(e&&!e.error){let n=Object.assign({},{},e);II(n)}return 1},EI=async t=>{let e=CI?.[992002];e&&(e.params={tkn:t})},[Kl,bi]=qh({user:null,loading:!0,error:null,authMethod:null}),[b5,Qv]=$e(null);Fx(ul,t=>{t?bi({user:t,loading:!1,error:null,authMethod:"firebase"}):b5()||bi({user:null,loading:!1,error:null,authMethod:null})});hA(ul).then(t=>{t&&bi({user:t.user,loading:!1,error:null,authMethod:"firebase"})}).catch(t=>{console.error("Redirect sign-in error:",t),bi({loading:!1,error:t.message})});const Ar={get state(){return Kl},async getUserProfile(t){try{const e=s5(cm,"users",t),r=await pI(e);if(r.exists()){bi("profile",r.data());let n={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1},i=r.data(),o={};return Object.keys(n).map(s=>{let a=n?.[s];i.hasOwnProperty(s)||(o[s]=a)}),Object.keys(o).length>0&&y5(e,o),r.data()}else{let n=Ar?.state?.user,i={uid:n?.uid,email:n?.email,displayName:n?.displayName,createdAt:new Date,stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1};return await yI(e,i),console.log("No such user profile!"),null}}catch(e){return console.error("Error fetching user profile:",e),null}},hasPermission:t=>{const e=Ar.state?.profile;return e?.isAdmin?!0:e?e?.[t]===!0:!1},async signInWithGoogle(){try{bi("loading",!0),bi("error",null);try{const t=await iA(ul,Mh);bi({user:t.user,loading:!1,error:null,authMethod:"firebase"});try{Ar.getUserProfile(t.user.uid)}catch(e){console.error("firestore error:",e)}}catch(t){if(t.code==="auth/popup-blocked")await uA(ul,Mh);else throw t}}catch(t){console.error("Sign-in error:",t),bi({loading:!1,error:t.message||"Failed to sign in with Google"})}},async signInWithGoogleP(t){const r=await qi({params:{id_token:t},query:"getGoogleUserbyToken"});if(r&&r){let n=new Date().getTime(),i=new Date(n+6e4*60*24*365),o="hrm_tkn_acc";document.cookie=`${o}=${r.data}; expires=${i}; path=/;g_state = {"i_l":1,"i_p":${i}}; ssgl_access_tkn = ${t}`,document.cookie=`ssgl_access_tkn = ${t}; expires=${i};`,await $I(),EI(r.data)}},async signInWithGoogleCloud(t){try{bi("loading",!0),bi("error",null);const e=xI(t),r={uid:e.sub,email:e.email,displayName:e.name,photoURL:e.picture};Qv(r);const n={uid:r.uid,email:r.email,displayName:r.displayName,photoURL:r.photoURL,emailVerified:!0};bi({user:n,loading:!1,error:null,authMethod:"google-cloud"});try{const i=Jo.credential(t);await Dx(ul,i)}catch{console.log("Firebase sign-in optional, continuing with Google Cloud auth")}}catch(e){console.error("Google Cloud sign-in error:",e),bi({loading:!1,error:e.message||"Failed to sign in with Google Cloud"})}},async signOut(){try{bi("loading",!0),(Kl.authMethod==="firebase"||ul.currentUser)&&await Ox(ul),Kl.authMethod==="google-cloud"&&(AI(),Qv(null)),bi({user:null,loading:!1,error:null,authMethod:null})}catch(t){console.error("Sign-out error:",t),bi({loading:!1,error:t.message||"Failed to sign out"})}},get isAuthenticated(){return!!Kl.user||!!b5()},get currentUser(){return Kl.user},get authMethod(){return Kl.authMethod}};var kI=de("<p>"),TI=de('<div><div><div><h1>HRM Finance</h1><p>Complete Business Management Solution</p><div><div><button><svg width=24 height=24 viewBox="0 0 24 24"><path fill=#4285F4 d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"></path><path fill=#34A853 d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"></path><path fill=#FBBC05 d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"></path><path fill=#EA4335 d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"></path></svg></button><p>Firebase Authentication</p></div></div></div><div><div><div></div><h3>Financial Management</h3><p>Complete chart of accounts, balance sheets, journal entries, and invoice management in one place.</p></div><div><div></div><h3>HR Management</h3><p>Track employees, manage onboarding, and monitor your workforce with powerful analytics.</p></div><div><div></div><h3>Inventory Control</h3><p>Real-time inventory tracking, product management, and movement history across multiple locations.</p></div><div><div></div><h3>Banking Integration</h3><p>Streamline bank reconciliation with CSV imports and automated consolidation features.</p></div><div><div></div><h3>Real-time Analytics</h3><p>Get instant insights with dashboards showing revenue, cash flow, and business performance.</p></div><div><div></div><h3>Multi-language Support</h3><p>Available in multiple languages to support your global business operations.</p></div></div><div><p>Secure authentication powered by Google  Your data is encrypted and protected</p><p>Choose your preferred authentication method above');const NI=()=>{Rn(()=>{PI(w=>{Ar.signInWithGoogleP(w)}),setTimeout(()=>{},100)});const t={"min-height":"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},e={background:"white","border-radius":"1rem","box-shadow":"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","max-width":"1200px",width:"100%",overflow:"hidden"},r={padding:"3rem","text-align":"center","border-bottom":"1px solid #e2e8f0"},n={"font-size":"2.5rem","font-weight":"800",color:"#1a202c","margin-bottom":"1rem"},i={"font-size":"1.125rem",color:"#718096","margin-bottom":"2rem"},o={display:"flex","flex-direction":"column",gap:"1rem","align-items":"center","margin-bottom":"1rem"},s={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"2rem",padding:"3rem"},a={"text-align":"center",padding:"2rem","border-radius":"0.5rem",background:"#f7fafc",transition:"transform 0.2s",cursor:"default"},c={"font-size":"3rem","margin-bottom":"1rem"},u={"font-size":"1.25rem","font-weight":"600",color:"#2d3748","margin-bottom":"0.5rem"},h={color:"#718096","line-height":"1.6"},y={display:"inline-flex","align-items":"center",gap:"0.75rem",background:"white",color:"#4285f4",border:"2px solid #4285f4",padding:"0.75rem 2rem","font-size":"1.125rem","font-weight":"500","border-radius":"0.5rem",cursor:"pointer",transition:"all 0.2s","min-width":"250px","justify-content":"center"},g={color:"#e53e3e","margin-top":"1rem","font-size":"0.875rem"},p={background:"#f7fafc",padding:"2rem","text-align":"center",color:"#718096","font-size":"0.875rem"},C={"font-size":"0.75rem",color:"#718096","margin-top":"0.25rem","font-style":"italic"},S=()=>{Ar.signInWithGoogle()};return(()=>{var w=TI(),x=w.firstChild,V=x.firstChild,ne=V.firstChild,X=ne.nextSibling,Q=X.nextSibling,ee=Q.firstChild,E=ee.firstChild;E.firstChild;var A=E.nextSibling,T=V.nextSibling,R=T.firstChild,_=R.firstChild,I=_.nextSibling,b=I.nextSibling,G=R.nextSibling,ie=G.firstChild,F=ie.nextSibling,W=F.nextSibling,z=G.nextSibling,O=z.firstChild,k=O.nextSibling,re=k.nextSibling,$=z.nextSibling,D=$.firstChild,H=D.nextSibling,L=H.nextSibling,j=$.nextSibling,oe=j.firstChild,K=oe.nextSibling,Z=K.nextSibling,J=j.nextSibling,Y=J.firstChild,U=Y.nextSibling,ae=U.nextSibling,ue=T.nextSibling,le=ue.firstChild,q=le.nextSibling;return m(w,t),m(x,e),m(V,r),m(ne,n),m(X,i),m(Q,o),E.addEventListener("mouseleave",ce=>{ce.currentTarget.style.background="white",ce.currentTarget.style.color="#4285f4"}),E.addEventListener("mouseenter",ce=>{ce.currentTarget.style.background="#4285f4",ce.currentTarget.style.color="white"}),E.$$click=S,m(E,y),l(E,B(Ge,{get when(){return Ar.state.loading},fallback:"Sign in with Google",children:"Signing in..."}),null),m(A,C),l(V,B(Ge,{get when(){return Ar.state.error},get children(){var ce=kI();return m(ce,g),l(ce,()=>Ar.state.error),ce}}),null),m(T,s),m(ue,p),q.style.setProperty("margin-top","0.5rem"),q.style.setProperty("font-size","0.75rem"),we(ce=>{var Se=Ar.state.loading,me=a,Pe=c,xe=u,he=h,ve=a,De=c,ke=u,Ce=h,Le=a,Ie=c,Re=u,He=h,Me=a,Ze=c,Ye=u,ut=h,rt=a,We=c,ct=u,pt=h,_t=a,Et=c,et=u,Ue=h;return Se!==ce.e&&(E.disabled=ce.e=Se),ce.t=m(R,me,ce.t),ce.a=m(_,Pe,ce.a),ce.o=m(I,xe,ce.o),ce.i=m(b,he,ce.i),ce.n=m(G,ve,ce.n),ce.s=m(ie,De,ce.s),ce.h=m(F,ke,ce.h),ce.r=m(W,Ce,ce.r),ce.d=m(z,Le,ce.d),ce.l=m(O,Ie,ce.l),ce.u=m(k,Re,ce.u),ce.c=m(re,He,ce.c),ce.w=m($,Me,ce.w),ce.m=m(D,Ze,ce.m),ce.f=m(H,Ye,ce.f),ce.y=m(L,ut,ce.y),ce.g=m(j,rt,ce.g),ce.p=m(oe,We,ce.p),ce.b=m(K,ct,ce.b),ce.T=m(Z,pt,ce.T),ce.A=m(J,_t,ce.A),ce.O=m(Y,Et,ce.O),ce.I=m(U,et,ce.I),ce.S=m(ae,Ue,ce.S),ce},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0}),w})()};dr(["click"]);var LI=de("<div><div>");const DI=t=>{const e={"min-height":"100vh",display:"flex","align-items":"center","justify-content":"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},r={width:"50px",height:"50px",border:"3px solid rgba(255, 255, 255, 0.3)","border-top-color":"white","border-radius":"50%",animation:"spin 1s linear infinite"},n=document.createElement("style");return n.textContent=`
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  `,document.head.appendChild(n),vo(async()=>{Ar.state?.user?.uid&&Ar.getUserProfile(Ar.state?.user?.uid)}),Rn(()=>{}),B(Ge,{get when(){return!Ar.state.loading},get fallback(){return(()=>{var i=LI(),o=i.firstChild;return m(i,e),m(o,r),i})()},get children(){return B(Ge,{get when(){return Ar.isAuthenticated},get fallback(){return B(NI,{})},get children(){return t.children}})}})};var RI=de("<button>");const xt=t=>{const e=()=>{const r={"font-family":"inherit",cursor:t.disabled?"not-allowed":"pointer",border:"none","border-radius":"var(--border-radius-sm)","font-weight":"500",transition:"all 0.2s ease","text-decoration":"none",display:"inline-flex","align-items":"center","justify-content":"center",gap:"0.5rem",opacity:t.disabled?"0.6":"1"},n={sm:{padding:"0.5rem 1rem","font-size":"0.875rem"},md:{padding:"0.75rem 1.5rem","font-size":"1rem"},lg:{padding:"1rem 2rem","font-size":"1.125rem"}},i={primary:{background:"linear-gradient(135deg, var(--primary-color), var(--primary-dark))",color:"white","box-shadow":"var(--shadow-sm)"},secondary:{background:"var(--surface-color)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},outline:{background:"transparent",color:"var(--primary-color)",border:"1px solid var(--primary-color)"}};return{...r,...n[t.size||"md"],...i[t.variant||"primary"]}};return(()=>{var r=RI();return as(r,"click",t.onClick,!0),l(r,()=>t.children),we(n=>{var i=e(),o=t.disabled,s=t.type||"button",a=`btn btn-${t.variant||"primary"} ${t.className||""}`;return n.e=m(r,i,n.e),o!==n.t&&(r.disabled=n.t=o),s!==n.a&&Yt(r,"type",n.a=s),a!==n.o&&Em(r,n.o=a),n},{e:void 0,t:void 0,a:void 0,o:void 0}),r})()};dr(["click"]);var MI=de("<div><div><div><h2></h2><button></button></div><div>");const Xn=t=>{const e={position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","z-index":"1000"},r={background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)","max-width":"920px",width:"90%","max-height":"80vh",overflow:"auto",position:"relative"},n={padding:"1.5rem","border-bottom":"1px solid var(--border-color)",display:"flex","justify-content":"space-between","align-items":"center"},i={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},o={background:"none",border:"none","font-size":"1.5rem",cursor:"pointer",color:"var(--text-muted)",padding:"0.5rem","border-radius":"var(--border-radius-sm)"},s={padding:"1.5rem"},a=c=>{c.target===c.currentTarget&&t.onClose()};return B(Ge,{get when(){return t.isOpen},get children(){var c=MI(),u=c.firstChild,h=u.firstChild,y=h.firstChild,g=y.nextSibling,p=h.nextSibling;return c.$$click=a,m(h,n),m(y,i),l(y,()=>t.title),g.addEventListener("mouseleave",C=>C.target.style.background="none"),g.addEventListener("mouseenter",C=>C.target.style.background="var(--background-color)"),as(g,"click",t.onClose,!0),m(g,o),m(p,s),l(p,()=>t.children),we(C=>{var S=e,w=r;return C.e=m(c,S,C.e),C.t=m(u,w,C.t),C},{e:void 0,t:void 0}),c}})};dr(["click"]);var Xv=de("<div>"),FI=de("<h3>"),OI=de("<p>");const Nt=t=>{const e={background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"1.5rem","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",transition:"all 0.2s ease",cursor:t.onClick?"pointer":"default",margin:"9px"},r={"margin-bottom":"1rem"},n={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0 0 0.5rem 0"},i={"font-size":"0.875rem",color:"var(--text-muted)",margin:"0"};return(()=>{var o=Xv();return as(o,"click",t.onClick,!0),l(o,(()=>{var s=Te(()=>!!(t.title||t.subtitle));return()=>s()&&(()=>{var a=Xv();return m(a,r),l(a,(()=>{var c=Te(()=>!!t.title);return()=>c()&&(()=>{var u=FI();return m(u,n),l(u,()=>t.title),u})()})(),null),l(a,(()=>{var c=Te(()=>!!t.subtitle);return()=>c()&&(()=>{var u=OI();return m(u,i),l(u,()=>t.subtitle),u})()})(),null),a})()})(),null),l(o,()=>t.children,null),we(s=>{var a=e,c=`card ${t.className||""}`;return s.e=m(o,a,s.e),c!==s.t&&Em(o,s.t=c),s},{e:void 0,t:void 0}),o})()};dr(["click"]);var BI=de("<div><label></label><input>"),jI=de("<span>*");const Or=t=>{const e={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},r={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},n={"margin-bottom":"1rem"};return(()=>{var i=BI(),o=i.firstChild,s=o.nextSibling;return m(i,n),m(o,e),l(o,()=>t.label,null),l(o,(()=>{var a=Te(()=>!!t.required);return()=>a()&&(()=>{var c=jI();return c.style.setProperty("color","var(--primary-color)"),c})()})(),null),s.addEventListener("blur",a=>a.target.style.borderColor="var(--border-color)"),s.addEventListener("focus",a=>a.target.style.borderColor="var(--primary-color)"),s.$$input=a=>t.onChange(a.target.value),m(s,r),we(a=>{var c=t.type||"text",u=t.placeholder,h=t.required,y=t.disabled;return c!==a.e&&Yt(s,"type",a.e=c),u!==a.t&&Yt(s,"placeholder",a.t=u),h!==a.a&&(s.required=a.a=h),y!==a.o&&(s.disabled=a.o=y),a},{e:void 0,t:void 0,a:void 0,o:void 0}),we(()=>s.value=t.value),i})()};dr(["input"]);const VI={en:{common:{save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",close:"Close",search:"Search",filter:"Filter",reset:"Reset",back:"Back",next:"Next",previous:"Previous",yes:"Yes",no:"No",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",confirm:"Confirm",actions:"Actions",status:"Status",active:"Active",inactive:"Inactive",date:"Date",time:"Time",description:"Description",notes:"Notes",amount:"Amount",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Language",english:"English",spanish:"Spanish",noDataFound:"No data found",required:"Required",optional:"Optional",all:"All",none:"None",select:"Select",clear:"Clear",searching:"Searching...",refresh:"Refresh",showAll:"Show All",products:"products",filtered:"Filtered",view:"View",suggested:"Suggested",clearFilters:"Clear Filters",enhanced:"Enhanced",legacy:"Legacy",email:"Email",phone:"Phone",address:"Address",name:"Name",code:"Code",category:"Category",type:"Type",quantity:"Quantity",price:"Price",cost:"Cost",value:"Value",balance:"Balance",created:"Created",modified:"Modified",details:"Details",summary:"Summary",history:"History",new:"New",addNew:"Add New",unknown:"Unknown",notAvailable:"N/A",remove:"Remove",startDate:"Start Date",endDate:"End Date",from:"From",invoice:"Invoice",invoices:"invoices",reference:"Reference",createdBy:"Created By",units:"units",invoiceDocumentId:"Invoice/Document ID",referenceNumber:"Reference Number",referenceNumberPlaceholder:"Enter reference number...",generalNotes:"General Notes",auto:"Auto",optionalNotes:"Optional notes...",showPerPage:"Show per page",first:"First",last:"Last",store:"Store",orderId:"Order ID",tax:"Tax",paymentMethods:"Payment Methods",cash:"Cash",creditCard:"Credit Card",shipping:"Shipping",air:"Air",sea:"Sea",thankYouBusiness:"Thank you for your business!",thankForChoosingUs:"Thank you for choosing us!",taxExemptNote:"Tax exempted on cash payment.",youSaved:"You saved",generatedOn:"Generated on",printSavePDF:"Print / Save as PDF",pageOfPages:"Page {{current}} of {{total}}",showingXofY:"Showing {{start}}-{{end}} of {{total}}",page:"Page",of:"of",print:"Print",export:"Export",pending:"Pending",completed:"Completed",customer:"Customer",location:"Location",reservations:"Reservations",backToDashboard:"Back to Dashboard",lbs:"pounds"},navigation:{dashboard:"Dashboard",accounts:"Chart of Accounts",balanceSheet:"Balance Sheet",inventory:"Inventory",employees:"Employees",entryBooks:"Entry Books",consolidate:"Bank Consolidation",reports:"Reports",settings:"Settings"},dashboard:{title:"Dashboard",welcome:"Welcome to HRM Finance",totalRevenue:"Total Revenue",overview:"Overview",recentActivity:"Recent Activity",quickActions:"Quick Actions",employeeCount:"Employee Count",pendingInvoices:"Pending Invoices",cashBalance:"Cash Balance",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalExpenses:"Total Expenses",netIncome:"Net Income",netLoss:"Net Loss",monthlyPayroll:"Monthly Payroll",current:"Current",newHires:"+3 new hires",outstanding:"Outstanding",totalOutstanding:"$23,450 total",lastUpdatedToday:"Last updated today",commonTasks:"Common tasks",generateReport:"Generate Report",latestUpdates:"Latest updates",invoicePaid:"Invoice #1234 paid",hoursAgo:"2 hours ago",newEmployeeOnboarded:"New employee onboarded",dayAgo:"1 day ago",monthlyReportGenerated:"Monthly report generated",daysAgo:"2 days ago"},accounts:{title:"Chart of Accounts",accountNumber:"Account Number",accountName:"Account Name",accountType:"Account Type",category:"Category",balance:"Balance",parentAccount:"Parent Account",subAccounts:"Sub-accounts",addAccount:"Add Account",editAccount:"Edit Account",deleteAccount:"Delete Account",accountDetails:"Account Details",transactions:"Transactions",accountHistory:"Account History",backToAccounts:"Back to Accounts",accountNotFound:"Account not found",accountInformation:"Account Information",accountPurpose:"Account purpose",transactionHistory:"Transaction History",noTransactions:"No transactions found for this account",createdDate:"Created Date",lastModified:"Last Modified",noDescription:"No description provided.",totalCount:"Total count",basicDetails:"Basic details",currentBalance:"Current balance",classification:"Classification",allTransactions:"All account transactions",reference:"Reference",allAccounts:"All Accounts",types:{asset:"Asset",liability:"Liability",equity:"Equity",revenue:"Revenue",expense:"Expense"},categories:{currentAssets:"Current Assets",fixedAssets:"Fixed Assets",currentLiabilities:"Current Liabilities",longTermLiabilities:"Long-term Liabilities",ownersEquity:"Owner's Equity",operatingRevenue:"Operating Revenue",operatingExpenses:"Operating Expenses"}},inventory:{title:"Inventory Management",overview:"Overview",products:"Products & Stock",movements:"Movements",locations:"Locations",bulkMovement:"Bulk Movement",addMovement:"Add Movement",addProduct:"Add Product",addLocation:"Add Location",singleMovement:"Add Single Movement",addNewItem:"Add New Item",activeProducts:"Active Products",lowStockAlert:"Low Stock Items",totalValue:"Total Stock Value",activeLocations:"Active Locations",productsNeedRestocking:"products need restocking",recentMovements:"Recent Movements",noProducts:"No products at this location",productName:"Product Name",productCode:"Product Code",sku:"SKU",unitOfMeasure:"Unit of Measure",unitCost:"Unit Cost",minStockLevel:"Min Stock Level",maxStockLevel:"Max Stock Level",locationName:"Location Name",locationType:"Location Type",locationCode:"Location Code",movementType:"Movement Type",referenceNumber:"Reference Number",invoiceNumber:"Invoice Number",fromLocation:"From Location",toLocation:"To Location",stockIn:"Stock In",stockOut:"Stock Out",transfer:"Transfer",adjustment:"Adjustment",inStock:"In Stock",lowStock:"Low Stock",outOfStock:"Out of Stock",stockLevels:"Stock Levels",stockByLocation:"Stock by Location",searchProducts:"Search products by name, SKU, or category...",searchProductsStock:"Search products and check stock levels...",searchResult:"Search Result",searchResults:"Search Results",searchFallback:"Showing local results",tryDifferentTerm:"Try a different search term or check spelling.",showingTopResults:"Showing top {{count}} results",searchLocations:"Search locations...",noMovements:"No movements found",productDetails:"Product Details",locationDetails:"Location Details",movementDetails:"Movement Details",totalProducts:"Total Products",totalLocations:"Total Locations",lastSeen:"Last seen",warehouseType:"Warehouse",storeType:"Store",supplierType:"Supplier",customerType:"Customer",currentlyManaged:"Currently managed",needAttention:"Need attention",currentWorth:"Current worth",warehousesStores:"Warehouses & stores",thisMonth:"This Month",latestActivities:"Latest inventory activities",searchMovements:"Search Movements",countingSheet:"Counting Sheet",physicalCount:"Physical Count",physicalInventoryCount:"Physical Inventory Count",setupPhysicalCount:"Setup Physical Inventory Count",setupDescription:"Configure your physical inventory count settings and begin the counting process.",countWillInclude:"This count will include {{count}} products from {{location}} in {{category}} category.",startCounting:"Start Physical Count",counted:"Counted",remaining:"Remaining",variances:"Variances",complete:"Complete",systemQty:"System Qty",variance:"Variance",addNotes:"Add notes...",reviewAndConfirm:"Review and Confirm Adjustments",reviewDescription:"Review the inventory adjustments below and confirm to update your system.",stockIncreases:"Stock Increases",stockDecreases:"Stock Decreases",totalAdjustments:"Total Adjustments",confirmAdjustments:"Confirm Adjustments",perfectCount:"Perfect Count!",noVariances:"No variances found. Your physical count matches the system exactly.",physicalCountAdjustment:"Physical count adjustment",inventoryCountingSheetTitle:"INVENTORY COUNTING SHEET",location:"Location",allCategories:"All Categories",countedBy:"Counted by",verifiedBy:"Verified by",instructions:"Instructions",countInstructions:["Count all items physically present at this location",'Write the actual count in the "Physical Count" column',"Leave blank if item is not found",'Note any discrepancies in the "Notes" column',"Sign and date when complete"],productName:"Product Name",unit:"Unit",totalProductsListed:"Total Products Listed",itemsCounted:"Items Counted",summaryFor:"SUMMARY FOR",discrepanciesFound:"Discrepancies Found",counterSignature:"Counter Signature",supervisorSignature:"Supervisor Signature",downloadCSV:"Download CSV",noAdjustmentsToDownload:"No adjustments to download",stockIncrease:"Stock Increase",stockDecrease:"Stock Decrease",purchaseReceive:"Purchase/Receive",saleIssue:"Sale/Issue",transfer:"Transfer",adjustment:"Adjustment",movementType:"Movement Type",fromLocation:"From Location",toLocation:"To Location",searchSourceLocation:"Search source location...",searchDestinationLocation:"Search destination location...",searchLocation:"Search location...",addProduct:"Add Product",searchProduct:"Search product...",unitCost:"Unit Cost",noProductsAdded:'No products added yet. Click "Add Product" to get started.',createMovement:"Create Movement",generalNotesPlaceholder:"Enter general notes for this movement...",sortBy:"Sort By",allLocations:"All Locations",searchByProduct:"Search by product, location, reference, notes, invoice...",allProducts:"All Products",bulkMovementReport:"Bulk Movement Report",movementDetails:"Movement Details",referenceNumber:"Reference Number",invoiceId:"Invoice ID",totalItems:"Total Items",totalQuantity:"Total Quantity",estimatedValue:"Estimated Value",viewHistoricalReports:"View Historical Reports",noBulkReportsFound:"No bulk movement reports found",bulkReportsAppearHere:"Bulk movement reports will appear here after you create bulk movements",allTypes:"All Types",startDate:"Start Date",endDate:"End Date",totalMovements:"Total Movements",totalItems:"Total Items",adjustMovements:"Try adjusting your filters or check back later.",inventoryMovements:"Inventory Movements",createdBy:"Created By",view:"View",enhanced:"Enhanced",legacy:"Legacy",addSingleMovement:"Add Single Movement",inStockSubtitle:"In stock",itemsBelowThreshold:"Items below threshold",inventoryWorth:"Inventory worth",quantity:"Quantity",units:"units",normal:"Normal",productsAndStock:"Products & Stock",lowStockItems:"Low Stock Items",totalStockValue:"Total Stock Value",warehousesAndStores:"Warehouses & stores",andMore:"...and {count} more",latestInventoryActivities:"Latest inventory activities",min:"Min",max:"Max",cost:"Cost",noProductsFound:"No products found matching your search.",noProductsAvailable:"No products available.",noLocationsFound:"No locations found matching your search.",noLocationsAvailable:"No locations available.",searchPlaceholder:"Search by product, location, reference, notes, invoice...",noMovementsFound:"No movements found",tryAdjustingFilters:"Try adjusting your filters or check back later.",transfers:"Transfers",adjustments:"Adjustments",bulk:"Bulk",product:"Product",location:"Location",store:"Store",supplier:"Supplier",warehouse:"Warehouse",movement:"Movement",editMovement:"Edit Movement",updateMovement:"Update Movement",movementInformation:"Movement Information",locationInformation:"Location Information",searchProductsImages:"Search products to view images...",searchForProducts:"Search for Products",startTypingToSearch:"Start typing to search and view product images",tryDifferentSearch:"Try a different search term"},employees:{title:"Employee Management",employeeList:"Employee List",addEmployee:"Add Employee",editEmployee:"Edit Employee",employeeDetails:"Employee Details",personalInfo:"Personal Information",employmentInfo:"Employment Information",payrollInfo:"Payroll Information",firstName:"First Name",lastName:"Last Name",fullName:"Full Name",email:"Email",phone:"Phone",address:"Address",dateOfBirth:"Date of Birth",employeeId:"Employee ID",department:"Department",position:"Position",hireDate:"Hire Date",employmentStatus:"Employment Status",salary:"Salary",payFrequency:"Pay Frequency",taxId:"Tax ID",bankAccount:"Bank Account",emergencyContact:"Emergency Contact",activeEmployees:"Active Employees",inactiveEmployees:"Inactive Employees",totalPayroll:"Total Payroll",searchEmployees:"Search employees...",enterFullName:"Enter employee's full name",enterPosition:"Enter job position",enterEmail:"Enter email address",enterPhone:"Enter phone number",enterSalary:"Enter annual salary",departments:{engineering:"Engineering",product:"Product",design:"Design",marketing:"Marketing",sales:"Sales",humanResources:"Human Resources",finance:"Finance",operations:"Operations",analytics:"Analytics"}},entryBooks:{title:"Entry Books",bookName:"Book Name",bookType:"Book Type",createBook:"Create Book",editBook:"Edit Book",salesBook:"Sales Book",purchaseBook:"Purchase Book",cashBook:"Cash Book",generalBook:"General Book",entries:"Entries",addEntry:"Add Entry",period:"Period",startDate:"Start Date",endDate:"End Date",bookBalance:"Book Balance",reconciledBalance:"Reconciled Balance",difference:"Difference",reconcile:"Reconcile",isReconciled:"Is Reconciled",noBooks:"No entry books found",createFirst:"Create your first entry book to get started",bookDetails:"Book Details",entriesCount:"entries",bookOverview:"Book overview and details",bookEntries:"Book Entries",allEntries:"All entries in this book",noEntries:"No entries found",addFirst:"Add your first entry to this book",entryDate:"Entry Date",entryDescription:"Entry Description",entryAmount:"Entry Amount",entryReference:"Entry Reference",subtitle:"Manage accounting entries and general ledger records",viewReconciliation:"View Reconciliation",totalEntries:"Total Entries",allJournalEntries:"All journal entries",postedEntriesOnly:"Posted entries only",fromPostedEntries:"From {count} posted entries",needBankReconciliation:"Need bank reconciliation",allReconciled:"All reconciled",sortBy:"Sort By",fromDate:"From Date",toDate:"To Date",order:"Order",newest:"Newest",oldest:"Oldest",resetFilters:"Reset Filters",activeFilters:"Active filters",from:"From",to:"To",entriesFound:"{count} entries found",noJournalEntries:"No Journal Entries",startByCreating:"Start by creating your first entry",noEntriesMatch:"No journal entries match your current filters.",createFirstEntry:"Create First Entry",void:"Void",confirmVoid:"Are you sure you want to void this journal entry?",entryBookRecords:"Entry Book Records"},banking:{title:"Bank Consolidation",bankAccount:"Bank Account",statementDate:"Statement Date",beginningBalance:"Beginning Balance",endingBalance:"Ending Balance",deposits:"Deposits",withdrawals:"Withdrawals",bankCharges:"Bank Charges",interest:"Interest",reconcile:"Reconcile",matched:"Matched",unmatched:"Unmatched",importStatement:"Import Statement",manualEntry:"Manual Entry",autoMatch:"Auto Match",clearAll:"Clear All",reconciliationStatus:"Reconciliation Status",difference:"Difference",bookBalance:"Book Balance",statementBalance:"Statement Balance",outstandingChecks:"Outstanding Checks",depositsInTransit:"Deposits in Transit",reconciled:"Reconciled",notReconciled:"Not Reconciled",unreconciled:"Unreconciled",reconciliation:"Reconciliation",compareStatements:"Compare bank statements with entry book records",importCSV:"Import CSV",startNewReconciliation:"Start New Reconciliation",bankAccountInfo:"Bank Account Info",currentAccountDetails:"Current account details",lastReconciled:"Last reconciled",bankTransactions:"Bank Transactions",selectedPeriod:"Selected period",pending:"pending",bookEntriesForComparison:"Book entries for comparison",reconciliationRate:"Reconciliation Rate",completionStatus:"Completion status",recentReconciliationSessions:"Recent Reconciliation Sessions",latestActivity:"Latest activity",noRecentSessions:"No recent reconciliation sessions found.",startFirstReconciliation:"Start First Reconciliation",entryBookRecords:"Entry Book Records",pleaseUploadCSV:"Please upload a CSV file",csvRequiresHeaderAndData:"CSV file must have at least a header and one data row",successfullyParsed:"Successfully parsed {count} rows",errorParsingCSV:"Error parsing CSV file. Please check the format.",dateDescriptionRequired:"Date and Description columns are required",importedTransaction:"Imported transaction",successfullyImported:"Successfully imported {count} bank transactions",errorImportingTransactions:"Error importing transactions. Please check your data.",importBankStatementCSV:"Import Bank Statement CSV",dropCSVHere:"Drop CSV file here",clickToUploadCSV:"Click to upload or drag and drop CSV file",supportedFormat:"Supported format: CSV with Date, Description, and Amount columns",mapCSVColumns:"Map CSV Columns",dateColumn:"Date Column",selectColumn:"Select column...",descriptionColumn:"Description Column",referenceColumn:"Reference Column",amountDebitColumn:"Amount/Debit Column",creditColumn:"Credit Column",balanceColumn:"Balance Column",andMoreRows:"... and {count} more rows",importing:"Importing...",importTransactions:"Import {count} Transactions",reconciliationComparison:"Reconciliation Comparison",bankStatements:"Bank Statements",totalTransactions:"Total transactions",totalEntries:"Total entries",unreconciledBank:"Unreconciled Bank",unreconciledBooks:"Unreconciled Books",needAttention:"Need attention",unreconcile:"Unreconcile",clickToReconcile:"Click to reconcile",potentialMatchesFound:"Potential Matches Found",clickRecordToReconcile:"Click on a record below to reconcile",exactMatch:"Exact Match",possibleMatch:"Possible Match",selected:"Selected",clearSelection:"Clear Selection"},journal:{title:"Journal Entries",entryNumber:"Entry Number",entryDate:"Entry Date",debit:"Debit",credit:"Credit",account:"Account",memo:"Memo",reference:"Reference",createEntry:"Create Entry",editEntry:"Edit Entry",deleteEntry:"Delete Entry",posted:"Posted",draft:"Draft",reversed:"Reversed",recurringEntry:"Recurring Entry",attachments:"Attachments",totalDebits:"Total Debits",totalCredits:"Total Credits",outOfBalance:"Out of Balance",balanced:"Balanced",addEntry:"Add Journal Entry",allEntries:"All Entries",totalDebit:"Total Debit",totalCredit:"Total Credit",debitShort:"Dr.",creditShort:"Cr.",noReference:"No reference",createdBy:"By",totalAmount:"Total Amount",lines:"Lines",entryNotBalancedShort:"Entry is not balanced",accountLines:"Account Lines",noDescription:"No description",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryLines:"Journal Entry Lines",addLine:"Add Line",lineDescription:"Line description",notBalanced:"Not Balanced",updateEntry:"Update Entry",saveAsDraft:"Save as Draft",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",editEntryTooltip:"Edit this journal entry",post:"Post",entryMustBeBalanced:"Entry must be balanced to post",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",journalLines:"Journal Lines",balanceStatus:"Balance Status",unbalanced:"Unbalanced",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",postEntry:"Post Entry",fixBalance:"Fix Balance",voidEntry:"Void Entry",draftEntry:"Draft Entry",draftEntryDescription:"This entry can be edited and posted.",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",postedEntry:"Posted Entry",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",minTwoLinesRequired:"At least 2 line items are required",entryNotBalanced:"Entry is not balanced. Debit: ${debit}, Credit: ${credit}",lineAccountRequired:"Line {lineNumber}: Account is required",lineAmountRequired:"Line {lineNumber}: Either debit or credit amount must be provided",lineBothAmounts:"Line {lineNumber}: Cannot have both debit and credit amounts",enterEntryDescription:"Enter journal entry description",enterReferenceNumber:"Enter reference number"},invoices:{title:"Invoice Dashboard",invoice:"Invoice",invoices:"Invoices",invoiceNumber:"Invoice Number",invoiceDetails:"Invoice Details",customerInformation:"Customer Information",customerName:"Customer Name",legalName:"Legal Name",contactInformation:"Contact Information",idPassport:"ID/Passport",phoneNumber:"Phone Number",altPhone:"Alt Phone",address:"Address",between:"Between",and:"and",products:"Products",reservations:"Reservations",unitPrice:"Unit Price",total:"Total",subtotal:"Subtotal",totalRevenue:"Total Revenue",totalProducts:"Total Products",totalReservations:"Total Reservations",aranceles:"Aranceles (Customs)",uniqueCustomers:"Unique Customers",averageInvoice:"Average Invoice",completed:"Completed",pending:"Pending",storesActive:"Stores Active",topProducts:"Top Products",mostSoldProducts:"Most sold products by quantity",reservationsByType:"Reservations by Type",distributionOfCategories:"Distribution of reservation categories",recentInvoices:"Recent Invoices",showingInvoices:"Showing {{count}} invoices",date:"Date",customer:"Customer",store:"Store",actions:"Actions",view:"View",status:"Status",printInvoice:"Print Invoice",exportPdf:"Export PDF",backToDashboard:"Back to Dashboard",fromInvoices:"From {{count}} invoices",value:"value",activeCustomers:"Active customers",perInvoiceValue:"Per invoice value",locations:"Locations",mostRecentActivity:"Most recent activity",storeLocation:"Store Location",allStores:"All Stores",fromDate:"From Date",toDate:"To Date",clearFilters:"Clear Filters",search:"Search",searchPlaceholder:"Search by invoice #, customer, store...",customsFees:"Total customs fees",salesType:"SALES",packagesOrder:"Packages Order",businessId:"Business ID",orderKey:"Order Key",reservationType:"Reservation Type",arancel:"Arancel",key:"Key",noInvoicesFound:"No invoices found",loadingInvoices:"Loading invoices...",errorLoadingInvoices:"Error loading invoices",refreshData:"Refresh Data",currentStockValue:"Current Stock Value",filterByStore:"Filter by store",filterByDate:"Filter by date range",totalCustomsFees:"Total customs fees",averageValue:"Average value",senderInformation:"Sender Information",receiptInformation:"Receipt Information",productsSubtotal:"Products Subtotal",reservationsSubtotal:"Reservations Subtotal",code:"Code",description:"Description",qty:"Qty",type:"Type",id:"ID",passport:"Passport",createNew:"Create New Invoice",totalOutstanding:"Total Outstanding",unpaidInvoices:"Unpaid invoices",thisMonth:"This Month",revenueCollected:"Revenue collected",overdue:"Overdue",pastDueInvoices:"Past due invoices",latestBillingActivity:"Latest billing activity",paid:"Paid"},forms:{requiredField:"This field is required",invalidEmail:"Invalid email address",invalidNumber:"Invalid number",invalidDate:"Invalid date",selectOption:"Please select an option",enterValue:"Please enter a value",confirmDelete:"Are you sure you want to delete this item?",unsavedChanges:"You have unsaved changes. Do you want to continue?",saveSuccess:"Saved successfully",saveError:"Error saving data",deleteSuccess:"Deleted successfully",deleteError:"Error deleting item",duplicateAccountNumber:"Account number already exists",descriptionRequired:"Description is required",errorOccurred:"An error occurred",errorPostingEntry:"An error occurred while posting the entry",referenceNumberRequired:"Reference number is required",locationRequired:"Location is required",fromLocationRequired:"From location is required for transfers",atLeastOneProduct:"At least one product is required",itemProductRequired:"Product is required for item {{index}}",itemQuantityRequired:"Quantity must be greater than 0 for item {{index}}"},modals:{addInventory:"Add Inventory Movement",bulkMovement:"Bulk Inventory Movement",addProduct:"Add New Product",addLocation:"Add New Location",inventoryDetail:"Inventory Item Details",quickAdd:"Quick Add",selectProduct:"Select Product",selectLocation:"Select Location",enterQuantity:"Enter quantity",enterCost:"Enter unit cost",enterReference:"Enter reference number",addNotes:"Add notes (optional)",generalInformation:"General Information",stockInformation:"Stock Information",locationInformation:"Location Information",movementInformation:"Movement Information",addToInventory:"Add to Inventory",createProduct:"Create Product",createLocation:"Create Location",processing:"Processing...",addingMovement:"Adding movement...",creatingProduct:"Creating product...",creatingLocation:"Creating location..."},products:{title:"Products",addNew:"Add New Product",totalProducts:"Total Products",inCatalog:"In catalog",activeProducts:"Active Products",currentlyAvailable:"Currently available",outOfStock:"Out of Stock",needsRestock:"Needs restock",productCatalog:"Product Catalog",manageYourProducts:"Manage your products and pricing",inStock:"In Stock",furniture:"Furniture",electronics:"Electronics",supplies:"Supplies",lighting:"Lighting",searchPlaceholder:"Search products by name, SKU, or category...",allCategories:"All Categories",clearFilters:"Clear filters",noResults:"No products found matching your criteria.",noProducts:"No products available.",showing:"Showing",filtered:"Filtered results",allProducts:"All products",searchResult:"Search Result",stock:"Stock",lowStock:"Low Stock"},unauthorized:{title:"Access Restricted",accessDenied:"Access Denied",noPermission:"You don't have permission to access",thisFeature:"this feature",whySeeing:"Why am I seeing this?",explanation:"Your account doesn't have the necessary permissions to view this content.",requiredPermission:"Required permission:",goToDashboard:"Go to Dashboard",goBack:"Go Back",featuresCanAccess:"Features you can access:",dashboardAccess:"Dashboard and overview statistics",profileAccess:"Your profile and settings",roleBasedAccess:"Features enabled for your role",needAccess:"Need access? Contact your administrator or manager to request the appropriate permissions.",permissions:{accountAccess:"Account Management Access",inventoryAccess:"Inventory Access",employeeAccess:"HR Access",bankingAccess:"Banking Access",journalAccess:"Journal Entry Access",adminAccess:"Administrative Access",financialReporting:"Financial Reporting Access",invoiceManagement:"Invoice Management Access",productManagement:"Product Management Access"}}},es:{common:{save:"Guardar",cancel:"Cancelar",delete:"Eliminar",edit:"Editar",add:"Agregar",close:"Cerrar",search:"Buscar",filter:"Filtrar",reset:"Restablecer",back:"Atrs",next:"Siguiente",previous:"Anterior",yes:"S",no:"No",loading:"Cargando...",error:"Error",success:"xito",warning:"Advertencia",info:"Informacin",confirm:"Confirmar",actions:"Acciones",status:"Estado",active:"Activo",inactive:"Inactivo",date:"Fecha",time:"Hora",description:"Descripcin",notes:"Notas",amount:"Monto",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Idioma",english:"Ingls",spanish:"Espaol",noDataFound:"No se encontraron datos",required:"Requerido",optional:"Opcional",all:"Todos",none:"Ninguno",select:"Seleccionar",clear:"Limpiar",view:"Ver",suggested:"Sugerido",clearFilters:"Limpiar Filtros",enhanced:"Mejorado",legacy:"Clsico",email:"Correo Electrnico",phone:"Telfono",address:"Direccin",name:"Nombre",code:"Cdigo",category:"Categora",type:"Tipo",quantity:"Cantidad",price:"Precio",cost:"Costo",value:"Valor",balance:"Saldo",created:"Creado",modified:"Modificado",details:"Detalles",summary:"Resumen",history:"Historial",new:"Nuevo",addNew:"Agregar Nuevo",unknown:"Desconocido",notAvailable:"N/A",remove:"Remover",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",from:"De",invoice:"Factura",invoices:"facturas",reference:"Referencia",createdBy:"Creado Por",units:"unidades",invoiceDocumentId:"ID de Factura/Documento",referenceNumber:"Nmero de Referencia",referenceNumberPlaceholder:"Ingrese nmero de referencia...",generalNotes:"Notas Generales",auto:"Auto",optionalNotes:"Notas opcionales...",showPerPage:"Mostrar por pgina",first:"Primera",last:"ltima",store:"Tienda",orderId:"ID de Orden",tax:"Impuesto",paymentMethods:"Mtodos de Pago",cash:"Efectivo",creditCard:"Tarjeta de Crdito",shipping:"Envo",air:"Areo",sea:"Martimo",thankYouBusiness:"Gracias por su negocio!",thankForChoosingUs:"Gracias por elejirnos!",taxExemptNote:"Impuesto exento en pago en efectivo.",youSaved:"Usted ahorr",generatedOn:"Generado el",printSavePDF:"Imprimir / Guardar como PDF",pageOfPages:"Pgina {{current}} de {{total}}",showingXofY:"Mostrando {{start}}-{{end}} de {{total}}",page:"Pgina",of:"de",lbs:"libras"},navigation:{dashboard:"Panel de Control",accounts:"Plan de Cuentas",balanceSheet:"Balance General",inventory:"Inventario",employees:"Empleados",entryBooks:"Libros de Entrada",consolidate:"Consolidacin Bancaria",reports:"Reportes",settings:"Configuracin"},dashboard:{title:"Panel de Control",welcome:"Bienvenido a HRM Finance",totalRevenue:"Ingresos Totales",overview:"Resumen",recentActivity:"Actividad Reciente",quickActions:"Acciones Rpidas",employeeCount:"Nmero de Empleados",pendingInvoices:"Facturas Pendientes",cashBalance:"Saldo en Efectivo",totalAssets:"Activos Totales",totalLiabilities:"Pasivos Totales",totalExpenses:"Gastos Totales",netIncome:"Ingreso Neto",netLoss:"Prdida Neta",monthlyPayroll:"Nmina Mensual",current:"Actual",newHires:"+3 nuevas contrataciones",outstanding:"Pendiente",totalOutstanding:"$23,450 total",lastUpdatedToday:"ltima actualizacin hoy",commonTasks:"Tareas comunes",generateReport:"Generar Reporte",latestUpdates:"ltimas actualizaciones",invoicePaid:"Factura #1234 pagada",hoursAgo:"hace 2 horas",newEmployeeOnboarded:"Nuevo empleado incorporado",dayAgo:"hace 1 da",monthlyReportGenerated:"Reporte mensual generado",daysAgo:"hace 2 das"},accounts:{title:"Plan de Cuentas",accountNumber:"Nmero de Cuenta",accountName:"Nombre de Cuenta",accountType:"Tipo de Cuenta",category:"Categora",balance:"Saldo",parentAccount:"Cuenta Padre",subAccounts:"Subcuentas",addAccount:"Agregar Cuenta",editAccount:"Editar Cuenta",deleteAccount:"Eliminar Cuenta",accountDetails:"Detalles de Cuenta",transactions:"Transacciones",accountHistory:"Historial de Cuenta",backToAccounts:"Volver a Cuentas",accountNotFound:"Cuenta no encontrada",accountInformation:"Informacin de Cuenta",accountPurpose:"Propsito de la cuenta",transactionHistory:"Historial de Transacciones",noTransactions:"No se encontraron transacciones para esta cuenta",createdDate:"Fecha de Creacin",lastModified:"ltima Modificacin",noDescription:"No se proporcion descripcin.",totalCount:"Conteo total",basicDetails:"Detalles bsicos",currentBalance:"Saldo actual",classification:"Clasificacin",allTransactions:"Todas las transacciones de la cuenta",reference:"Referencia",types:{asset:"Activo",liability:"Pasivo",equity:"Patrimonio",revenue:"Ingreso",expense:"Gasto"},categories:{currentAssets:"Activos Corrientes",fixedAssets:"Activos Fijos",currentLiabilities:"Pasivos Corrientes",longTermLiabilities:"Pasivos a Largo Plazo",ownersEquity:"Patrimonio del Propietario",operatingRevenue:"Ingresos Operacionales",operatingExpenses:"Gastos Operacionales"}},inventory:{title:"Gestin de Inventario",overview:"Resumen",products:"Productos y Stock",movements:"Movimientos",locations:"Ubicaciones",bulkMovement:"Movimiento Masivo",addMovement:"Agregar Movimiento",addProduct:"Agregar Producto",addLocation:"Agregar Ubicacin",singleMovement:"Agregar Movimiento Individual",addNewItem:"Agregar Nuevo Artculo",activeProducts:"Productos Activos",lowStockAlert:"Artculos con Stock Bajo",totalValue:"Valor Total del Stock",activeLocations:"Ubicaciones Activas",productsNeedRestocking:"productos necesitan reabastecimiento",recentMovements:"Movimientos Recientes",noProducts:"No hay productos en esta ubicacin",productName:"Nombre del Producto",productCode:"Cdigo del Producto",sku:"SKU",category:"Categoria",unitOfMeasure:"Unidad de Medida",unitCost:"Costo Unitario",minStockLevel:"Nivel Mnimo de Stock",maxStockLevel:"Nivel Mximo de Stock",locationName:"Nombre de Ubicacin",locationType:"Tipo de Ubicacin",locationCode:"Cdigo de Ubicacin",movementType:"Tipo de Movimiento",referenceNumber:"Nmero de Referencia",invoiceNumber:"Nmero de Factura",fromLocation:"Desde Ubicacin",toLocation:"Hacia Ubicacin",stockIn:"Entrada de Stock",stockOut:"Salida de Stock",transfer:"Transferencia",adjustment:"Ajuste",inStock:"En Stock",lowStock:"Stock Bajo",outOfStock:"Sin Stock",stockLevels:"Niveles de Stock",stockByLocation:"Stock por Ubicacin",searchProducts:"Buscar productos...",searchLocations:"Buscar ubicaciones...",noMovements:"No se encontraron movimientos",productDetails:"Detalles del Producto",locationDetails:"Detalles de Ubicacin",movementDetails:"Detalles del Movimiento",totalProducts:"Total de Productos",totalLocations:"Total de Ubicaciones",lastSeen:"Visto por ltima vez",warehouseType:"Almacn",storeType:"Tienda",supplierType:"Proveedor",customerType:"Cliente",currentlyManaged:"Gestionados actualmente",needAttention:"Necesitan atencin",currentWorth:"Valor actual",warehousesStores:"Almacenes y tiendas",thisMonth:"Este Mes",latestActivities:"ltimas actividades de inventario",searchMovements:"Buscar Movimientos",countingSheet:"Hoja de Conteo",physicalCount:"Conteo Fsico",physicalInventoryCount:"Conteo Fsico de Inventario",setupPhysicalCount:"Configurar Conteo Fsico de Inventario",setupDescription:"Configure los ajustes de su conteo fsico de inventario y comience el proceso de conteo.",countWillInclude:"Este conteo incluir {{count}} productos de {{location}} en la categora {{category}}.",startCounting:"Iniciar Conteo Fsico",counted:"Contado",remaining:"Restante",variances:"Variaciones",complete:"Completo",systemQty:"Cant. Sistema",variance:"Variacin",addNotes:"Agregar notas...",reviewAndConfirm:"Revisar y Confirmar Ajustes",reviewDescription:"Revise los ajustes de inventario a continuacin y confirme para actualizar su sistema.",stockIncreases:"Aumentos de Stock",stockDecreases:"Disminuciones de Stock",totalAdjustments:"Ajustes Totales",confirmAdjustments:"Confirmar Ajustes",adjustment:"Ajuste",perfectCount:"Conteo Perfecto!",noVariances:"No se encontraron variaciones. Su conteo fsico coincide exactamente con el sistema.",physicalCountAdjustment:"Ajuste de conteo fsico",inventoryCountingSheetTitle:"HOJA DE CONTEO DE INVENTARIO",location:"Ubicacin",allCategories:"Todas las Categoras",countedBy:"Contado por",verifiedBy:"Verificado por",instructions:"Instrucciones",countInstructions:["Contar todos los artculos fsicamente presentes en esta ubicacin",'Escribir el conteo real en la columna "Conteo Fsico"',"Dejar en blanco si el artculo no se encuentra",'Anotar cualquier discrepancia en la columna "Notas"',"Firmar y fechar cuando est completo"],productName:"Nombre del Producto",unit:"Unidad",totalProductsListed:"Total de Productos Listados",itemsCounted:"Artculos Contados",summaryFor:"RESUMEN PARA",discrepanciesFound:"Discrepancias Encontradas",counterSignature:"Firma del Contador",supervisorSignature:"Firma del Supervisor",downloadCSV:"Descargar CSV",noAdjustmentsToDownload:"No hay ajustes para descargar",stockIncrease:"Aumento de Stock",stockDecrease:"Disminucin de Stock",purchaseReceive:"Compra/Recepcin",saleIssue:"Venta/Emisin",transfer:"Transferencia",adjustment:"Ajuste",movementType:"Tipo de Movimiento",fromLocation:"Ubicacin de Origen",toLocation:"Ubicacin de Destino",searchSourceLocation:"Buscar ubicacin de origen...",searchDestinationLocation:"Buscar ubicacin de destino...",searchLocation:"Buscar ubicacin...",addProduct:"Agregar Producto",searchProduct:"Buscar producto...",unitCost:"Costo Unitario",noProductsAdded:'No se han agregado productos an. Haga clic en "Agregar Producto" para comenzar.',createMovement:"Crear Movimiento",generalNotesPlaceholder:"Ingrese notas generales para este movimiento...",sortBy:"Ordenar Por",allLocations:"Todas las Ubicaciones",searchByProduct:"Buscar por producto, ubicacin, referencia, notas, factura...",allProducts:"Todos los Productos",bulkMovementReport:"Reporte de Movimiento en Lote",movementDetails:"Detalles del Movimiento",referenceNumber:"Nmero de Referencia",invoiceId:"ID de Factura",totalItems:"Total de Artculos",totalQuantity:"Cantidad Total",estimatedValue:"Valor Estimado",viewHistoricalReports:"Ver Reportes Histricos",noBulkReportsFound:"No se encontraron reportes de movimientos en lote",bulkReportsAppearHere:"Los reportes de movimientos en lote aparecern aqu despus de crear movimientos en lote",allTypes:"Todos los Tipos",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",totalMovements:"Movimientos Totales",totalItems:"Artculos Totales",adjustMovements:"Intenta ajustar tus filtros o revisa ms tarde.",inventoryMovements:"Movimientos de Inventario",createdBy:"Creado Por",view:"Ver",enhanced:"Mejorado",legacy:"Clsico",addSingleMovement:"Agregar Movimiento Individual",inStockSubtitle:"En stock",itemsBelowThreshold:"Artculos bajo el umbral",inventoryWorth:"Valor del inventario",quantity:"Cantidad",units:"unidades",normal:"Normal",productsAndStock:"Productos y Stock",lowStockItems:"Artculos con Stock Bajo",totalStockValue:"Valor Total del Stock",warehousesAndStores:"Almacenes y tiendas",andMore:"...y {count} ms",latestInventoryActivities:"ltimas actividades de inventario",min:"Mn",max:"Mx",cost:"Costo",noProductsFound:"No se encontraron productos que coincidan con su bsqueda.",noProductsAvailable:"No hay productos disponibles.",noLocationsFound:"No se encontraron ubicaciones que coincidan con su bsqueda.",noLocationsAvailable:"No hay ubicaciones disponibles.",searchPlaceholder:"Buscar por producto, ubicacin, referencia, notas, factura...",noMovementsFound:"No se encontraron movimientos",tryAdjustingFilters:"Intenta ajustar tus filtros o revisa ms tarde.",transfers:"Transferencias",adjustments:"Ajustes",bulk:"Masivo",product:"Producto",location:"Ubicacin",store:"Tienda",supplier:"Proveedor",warehouse:"Almacn",movement:"Movimiento",editMovement:"Editar Movimiento",updateMovement:"Actualizar Movimiento",movementInformation:"Informacin del Movimiento",locationInformation:"Informacin de Ubicacin",searchProductsImages:"Buscar productos para ver imgenes...",searchForProducts:"Buscar Productos",startTypingToSearch:"Comienza a escribir para buscar y ver imgenes de productos",tryDifferentSearch:"Prueba con un trmino de bsqueda diferente"},employees:{title:"Gestin de Empleados",employeeList:"Lista de Empleados",addEmployee:"Agregar Empleado",editEmployee:"Editar Empleado",employeeDetails:"Detalles del Empleado",personalInfo:"Informacin Personal",employmentInfo:"Informacin Laboral",payrollInfo:"Informacin de Nmina",firstName:"Nombre",lastName:"Apellido",fullName:"Nombre Completo",email:"Correo Electrnico",phone:"Telfono",address:"Direccin",dateOfBirth:"Fecha de Nacimiento",employeeId:"ID de Empleado",department:"Departamento",position:"Puesto",hireDate:"Fecha de Contratacin",employmentStatus:"Estado Laboral",salary:"Salario",payFrequency:"Frecuencia de Pago",taxId:"ID Fiscal",bankAccount:"Cuenta Bancaria",emergencyContact:"Contacto de Emergencia",activeEmployees:"Empleados Activos",inactiveEmployees:"Empleados Inactivos",totalPayroll:"Nmina Total",searchEmployees:"Buscar empleados...",enterFullName:"Ingrese el nombre completo del empleado",enterPosition:"Ingrese el puesto de trabajo",enterEmail:"Ingrese la direccin de correo electrnico",enterPhone:"Ingrese el nmero de telfono",enterSalary:"Ingrese el salario anual",departments:{engineering:"Ingeniera",product:"Producto",design:"Diseo",marketing:"Marketing",sales:"Ventas",humanResources:"Recursos Humanos",finance:"Finanzas",operations:"Operaciones",analytics:"Analtica"}},entryBooks:{title:"Libros de Entrada",bookName:"Nombre del Libro",bookType:"Tipo de Libro",createBook:"Crear Libro",editBook:"Editar Libro",salesBook:"Libro de Ventas",purchaseBook:"Libro de Compras",cashBook:"Libro de Caja",generalBook:"Libro General",entries:"Entradas",addEntry:"Agregar Entrada",period:"Perodo",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",bookBalance:"Saldo del Libro",reconciledBalance:"Saldo Conciliado",difference:"Diferencia",reconcile:"Conciliar",isReconciled:"Est Conciliado",noBooks:"No se encontraron libros de entrada",createFirst:"Crea tu primer libro de entrada para comenzar",bookDetails:"Detalles del Libro",entriesCount:"entradas",bookOverview:"Resumen y detalles del libro",bookEntries:"Entradas del Libro",allEntries:"Todas las entradas en este libro",noEntries:"No se encontraron entradas",addFirst:"Agrega tu primera entrada a este libro",entryDate:"Fecha de Entrada",entryDescription:"Descripcin de Entrada",entryAmount:"Monto de Entrada",entryReference:"Referencia de Entrada"},banking:{title:"Consolidacin Bancaria",bankAccount:"Cuenta Bancaria",statementDate:"Fecha del Estado",beginningBalance:"Saldo Inicial",endingBalance:"Saldo Final",deposits:"Depsitos",withdrawals:"Retiros",bankCharges:"Cargos Bancarios",interest:"Intereses",reconcile:"Conciliar",matched:"Conciliado",unmatched:"No Conciliado",importStatement:"Importar Estado",manualEntry:"Entrada Manual",autoMatch:"Coincidencia Automtica",clearAll:"Limpiar Todo",reconciliationStatus:"Estado de Conciliacin",difference:"Diferencia",bookBalance:"Saldo en Libros",statementBalance:"Saldo del Estado",outstandingChecks:"Cheques Pendientes",depositsInTransit:"Depsitos en Trnsito",reconciled:"Conciliado",notReconciled:"No Conciliado",unreconciled:"No Conciliado",reconciliation:"Conciliacin",compareStatements:"Comparar estados bancarios con registros de libros de entrada",importCSV:"Importar CSV",startNewReconciliation:"Iniciar Nueva Conciliacin",bankAccountInfo:"Informacin de Cuenta Bancaria",currentAccountDetails:"Detalles de cuenta actual",lastReconciled:"ltima conciliacin",bankTransactions:"Transacciones Bancarias",selectedPeriod:"Perodo seleccionado",pending:"pendiente",bookEntriesForComparison:"Entradas de libros para comparacin",reconciliationRate:"Tasa de Conciliacin",completionStatus:"Estado de finalizacin",recentReconciliationSessions:"Sesiones de Conciliacin Recientes",latestActivity:"Actividad reciente",noRecentSessions:"No se encontraron sesiones de conciliacin recientes.",startFirstReconciliation:"Iniciar Primera Conciliacin",entryBookRecords:"Registros de Libros de Entrada",pleaseUploadCSV:"Por favor suba un archivo CSV",csvRequiresHeaderAndData:"El archivo CSV debe tener al menos un encabezado y una fila de datos",successfullyParsed:"Se analizaron exitosamente {count} filas",errorParsingCSV:"Error al analizar el archivo CSV. Verifique el formato.",dateDescriptionRequired:"Las columnas de Fecha y Descripcin son requeridas",importedTransaction:"Transaccin importada",successfullyImported:"Se importaron exitosamente {count} transacciones bancarias",errorImportingTransactions:"Error al importar transacciones. Verifique sus datos.",importBankStatementCSV:"Importar CSV de Estado Bancario",dropCSVHere:"Suelte el archivo CSV aqu",clickToUploadCSV:"Haga clic para cargar o arrastre y suelte el archivo CSV",supportedFormat:"Formato soportado: CSV con columnas de Fecha, Descripcin y Monto",mapCSVColumns:"Mapear Columnas CSV",dateColumn:"Columna de Fecha",selectColumn:"Seleccionar columna...",descriptionColumn:"Columna de Descripcin",referenceColumn:"Columna de Referencia",amountDebitColumn:"Columna de Monto/Dbito",creditColumn:"Columna de Crdito",balanceColumn:"Columna de Saldo",andMoreRows:"... y {count} filas ms",importing:"Importando...",importTransactions:"Importar {count} Transacciones",reconciliationComparison:"Comparacin de Conciliacin",bankStatements:"Estados Bancarios",totalTransactions:"Transacciones totales",totalEntries:"Entradas totales",unreconciledBank:"Banco No Conciliado",unreconciledBooks:"Libros No Conciliados",needAttention:"Necesitan atencin",unreconcile:"Desconciliar",clickToReconcile:"Hacer clic para conciliar",potentialMatchesFound:"Coincidencias Potenciales Encontradas",clickRecordToReconcile:"Haga clic en un registro a continuacin para conciliar",exactMatch:"Coincidencia Exacta",possibleMatch:"Posible Coincidencia",selected:"Seleccionado",clearSelection:"Limpiar Seleccin"},journal:{title:"Asientos Contables",entryNumber:"Nmero de Asiento",entryDate:"Fecha del Asiento",debit:"Dbito",credit:"Crdito",account:"Cuenta",memo:"Memo",reference:"Referencia",createEntry:"Crear Asiento",editEntry:"Editar Asiento",deleteEntry:"Eliminar Asiento",posted:"Registrado",draft:"Borrador",reversed:"Revertido",recurringEntry:"Asiento Recurrente",attachments:"Adjuntos",totalDebits:"Dbitos Totales",totalCredits:"Crditos Totales",outOfBalance:"Desbalanceado",balanced:"Balanceado"},forms:{requiredField:"Este campo es requerido",invalidEmail:"Direccin de correo invlida",invalidNumber:"Nmero invlido",invalidDate:"Fecha invlida",selectOption:"Por favor seleccione una opcin",enterValue:"Por favor ingrese un valor",confirmDelete:"Est seguro de que desea eliminar este elemento?",unsavedChanges:"Tiene cambios sin guardar. Desea continuar?",saveSuccess:"Guardado exitosamente",saveError:"Error al guardar datos",deleteSuccess:"Eliminado exitosamente",deleteError:"Error al eliminar elemento",duplicateAccountNumber:"El nmero de cuenta ya existe",referenceNumberRequired:"El nmero de referencia es requerido",locationRequired:"La ubicacin es requerida",fromLocationRequired:"La ubicacin de origen es requerida para transferencias",atLeastOneProduct:"Al menos un producto es requerido",itemProductRequired:"El producto es requerido para el artculo {{index}}",itemQuantityRequired:"La cantidad debe ser mayor que 0 para el artculo {{index}}"},modals:{addInventory:"Agregar Movimiento de Inventario",bulkMovement:"Movimiento Masivo de Inventario",addProduct:"Agregar Nuevo Producto",addLocation:"Agregar Nueva Ubicacin",inventoryDetail:"Detalles del Artculo de Inventario",quickAdd:"Agregar Rpido",selectProduct:"Seleccionar Producto",selectLocation:"Seleccionar Ubicacin",enterQuantity:"Ingresar cantidad",enterCost:"Ingresar costo unitario",enterReference:"Ingresar nmero de referencia",addNotes:"Agregar notas (opcional)",generalInformation:"Informacin General",stockInformation:"Informacin de Stock",locationInformation:"Informacin de Ubicacin",movementInformation:"Informacin de Movimiento",addToInventory:"Agregar al Inventario",createProduct:"Crear Producto",createLocation:"Crear Ubicacin",processing:"Procesando...",addingMovement:"Agregando movimiento...",creatingProduct:"Creando producto...",creatingLocation:"Creando ubicacin..."},products:{title:"Productos",addNew:"Agregar Nuevo Producto",totalProducts:"Total de Productos",inCatalog:"En catlogo",activeProducts:"Productos Activos",currentlyAvailable:"Actualmente disponibles",outOfStock:"Sin Stock",needsRestock:"Necesita reabastecimiento",productCatalog:"Catlogo de Productos",manageYourProducts:"Gestiona tus productos y precios",inStock:"En Stock",furniture:"Muebles",electronics:"Electrnicos",supplies:"Suministros",lighting:"Iluminacin"},invoices:{title:"Panel de Facturas",invoice:"Factura",invoices:"Facturas",invoiceNumber:"Nmero de Factura",invoiceDetails:"Detalles de Factura",customerInformation:"Informacin del Cliente",customerName:"Nombre del Cliente",legalName:"Nombre Legal",contactInformation:"Informacin de Contacto",idPassport:"ID/Pasaporte",phoneNumber:"Nmero de Telfono",altPhone:"Telfono Alt.",address:"Direccin",between:"Entre",and:"y",products:"Productos",reservations:"Reservaciones",unitPrice:"Precio Unitario",total:"Total",subtotal:"Subtotal",category:"Categoria",totalRevenue:"Ingresos Totales",totalProducts:"Total de Productos",totalReservations:"Total de Reservaciones",aranceles:"Aranceles (Aduanas)",uniqueCustomers:"Clientes nicos",averageInvoice:"Factura Promedio",completed:"Completada",pending:"Pendiente",storesActive:"Tiendas Activas",topProducts:"Productos Principales",mostSoldProducts:"Productos ms vendidos por cantidad",reservationsByType:"Reservaciones por Tipo",distributionOfCategories:"Distribucin de categoras de reservaciones",recentInvoices:"Facturas Recientes",showingInvoices:"Mostrando {{count}} facturas",date:"Fecha",customer:"Cliente",store:"Tienda",actions:"Acciones",view:"Ver",status:"Estado",printInvoice:"Imprimir Factura",exportPdf:"Exportar PDF",backToDashboard:"Volver al Panel",fromInvoices:"De {{count}} facturas",value:"valor",activeCustomers:"Clientes activos",perInvoiceValue:"Valor por factura",locations:"Ubicaciones",mostRecentActivity:"Actividad ms reciente",storeLocation:"Ubicacin de Tienda",allStores:"Todas las Tiendas",fromDate:"Fecha Desde",toDate:"Fecha Hasta",clearFilters:"Limpiar Filtros",search:"Buscar",searchPlaceholder:"Buscar por # factura, cliente, tienda...",customsFees:"Aranceles totales",salesType:"VENTAS",packagesOrder:"Orden de Paquetes",businessId:"ID de Negocio",orderKey:"Clave de Orden",reservationType:"Tipo de Reservacin",arancel:"Arancel",key:"Clave",noInvoicesFound:"No se encontraron facturas",loadingInvoices:"Cargando facturas...",errorLoadingInvoices:"Error al cargar facturas",refreshData:"Actualizar Datos",currentStockValue:"Valor de Stock Actual",filterByStore:"Filtrar por tienda",filterByDate:"Filtrar por rango de fechas",totalCustomsFees:"Aranceles totales",averageValue:"Valor promedio",senderInformation:"Informacin del Remitente",receiptInformation:"Informacin del Destinatario",productsSubtotal:"Subtotal de Productos",reservationsSubtotal:"Subtotal de Reservaciones",code:"Cdigo",description:"Descripcin",qty:"Cant.",type:"Tipo",id:"ID",passport:"Pasaporte"},unauthorized:{title:"Acceso Restringido",accessDenied:"Acceso Denegado",noPermission:"No tienes permisos para acceder a",thisFeature:"esta funcionalidad",whySeeing:"Por qu veo esto?",explanation:"Tu cuenta no tiene los permisos necesarios para ver este contenido.",requiredPermission:"Permiso requerido:",goToDashboard:"Ir al Panel de Control",goBack:"Regresar",featuresCanAccess:"Funcionalidades a las que puedes acceder:",dashboardAccess:"Panel de control y estadsticas generales",profileAccess:"Tu perfil y configuraciones",roleBasedAccess:"Funcionalidades habilitadas para tu rol",needAccess:"Necesitas acceso? Contacta a tu administrador o gerente para solicitar los permisos apropiados.",permissions:{accountAccess:"Acceso a Gestin de Cuentas",inventoryAccess:"Acceso a Inventario",employeeAccess:"Acceso a Recursos Humanos",bankingAccess:"Acceso Bancario",journalAccess:"Acceso a Asientos Contables",adminAccess:"Acceso Administrativo",financialReporting:"Acceso a Reportes Financieros",invoiceManagement:"Acceso a Gestin de Facturas",productManagement:"Acceso a Gestin de Productos"}}}},qI=()=>{if(typeof window<"u"){const t=localStorage.getItem("hrmfinance-language");if(t&&["en","es"].includes(t))return t}return"en"},[Zv,zI]=$e(qI()),er=()=>({t:(n,i,o)=>{const s=Zv(),a=n.split(".");let c=VI[s];for(const h of a)if(c&&typeof c=="object"&&h in c)c=c[h];else return i||n;let u=typeof c=="string"?c:i||n;return o&&typeof u=="string"&&Object.keys(o).forEach(h=>{const y=o[h],g=`{{${h}}}`;u=u.replace(new RegExp(g,"g"),String(y))}),u},language:()=>Zv(),setLanguage:n=>{zI(n),typeof window<"u"&&localStorage.setItem("hrmfinance-language",n)}});var UI=de("<div><label></label><select><option value>"),HI=de("<span>*"),WI=de("<option>");const ci=t=>{const{t:e}=er(),r={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},n={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},i={"margin-bottom":"1rem"};return(()=>{var o=UI(),s=o.firstChild,a=s.nextSibling,c=a.firstChild;return m(o,i),m(s,r),l(s,()=>t.label,null),l(s,(()=>{var u=Te(()=>!!t.required);return()=>u()&&(()=>{var h=HI();return h.style.setProperty("color","var(--primary-color)"),h})()})(),null),a.addEventListener("blur",u=>u.target.style.borderColor="var(--border-color)"),a.addEventListener("focus",u=>u.target.style.borderColor="var(--primary-color)"),a.addEventListener("change",u=>t.onChange(u.target.value)),m(a,n),l(c,()=>e("forms.selectOption")),l(a,()=>t.options.map(u=>(()=>{var h=WI();return l(h,()=>u.label),we(()=>h.value=u.value),h})()),null),we(u=>{var h=t.required,y=t.disabled;return h!==u.e&&(a.required=u.e=h),y!==u.t&&(a.disabled=u.t=y),u},{e:void 0,t:void 0}),we(()=>a.value=t.value),o})()};var GI=de("<main><div>"),YI=de("<header><h1>");const ro=t=>{const e={"min-height":"100vh",background:"var(--background-color)"},r={"max-width":"1200px",margin:"0 auto",padding:"2rem"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},i={"font-size":"2rem","font-weight":"700",color:"var(--text-primary)",margin:"0"};return(()=>{var o=GI(),s=o.firstChild;return m(o,e),m(s,r),l(s,(()=>{var a=Te(()=>!!t.title);return()=>a()&&(()=>{var c=YI(),u=c.firstChild;return m(c,n),m(u,i),l(u,()=>t.title),c})()})(),null),l(s,()=>t.children,null),o})()};var KI=de("<div><span></span><select><option value=en> </option><option value=es> ");const JI=()=>{const{t,language:e,setLanguage:r}=er(),n={display:"flex","align-items":"center",gap:"0.5rem","margin-left":"auto"},i={padding:"0.5rem 1rem","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",background:"var(--surface-color)",color:"var(--text-primary)",cursor:"pointer","font-size":"0.875rem","font-weight":"500",transition:"all 0.2s ease","min-width":"120px"},o={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},s=a=>{const c=a.target;r(c.value)};return(()=>{var a=KI(),c=a.firstChild,u=c.nextSibling,h=u.firstChild;h.firstChild;var y=h.nextSibling;return y.firstChild,m(a,n),m(c,o),u.addEventListener("change",s),m(u,i),l(h,()=>t("common.english"),null),l(y,()=>t("common.spanish"),null),we(()=>u.value=e()),a})()};var e0=de('<img alt="User avatar">'),QI=de("<div class=user-info-desktop><span>"),XI=de("<button class=sign-out-desktop>Sign Out"),ZI=de("<div><div><span></span></div><button>Sign Out"),e$=de(`<nav><div><div class=desktop-nav></div><div><button class=mobile-menu-button><svg width=24 height=24 viewBox="0 0 24 24"fill=currentColor><path></path></svg></button></div></div><div class=mobile-nav></div><style>
        .nav-active {
          background: linear-gradient(135deg, var(--primary-color), var(--primary-dark)) !important;
          color: white !important;
          box-shadow: var(--shadow-sm);
        }
        
        .desktop-nav a:hover:not(.nav-active),
        .nav-group button:hover {
          background: var(--background-color);
          color: var(--text-primary);
        }
        
        .mobile-nav a:hover:not(.nav-active) {
          background: var(--background-color);
          color: var(--text-primary);
        }

        /* Create invisible bridge to prevent gap issues */
        .nav-group::before {
          content: '';
          position: absolute;
          top: 100%;
          left: 0;
          right: 0;
          height: 0.5rem;
          z-index: 9;
        }
        
        @media (max-width: 768px) {
          .desktop-nav {
            display: none !important;
          }
          
          .mobile-menu-button {
            display: block !important;
          }
          
          .user-info-desktop,
          .sign-out-desktop {
            display: none !important;
          }
          
          nav > div:first-child {
            padding: 1rem;
          }
        }
        
        @media (min-width: 769px) {
          .mobile-nav {
            display: none !important;
          }
        }
      `),t$=de("<div class=nav-group><button> <span></span></button><div>"),r$=de("<div>"),n$=de("<div><div><span> </span><span>");const i$=()=>{const{t}=er(),[e,r]=$e(!1),[n,i]=$e(null),[o,s]=$e(null),a={background:"var(--surface-color)","border-bottom":"1px solid var(--border-color)","box-shadow":"var(--shadow-sm)","backdrop-filter":"blur(10px)",position:"sticky",top:"0","z-index":"100"},c={display:"flex","align-items":"center","justify-content":"space-between",padding:"1rem 2rem",margin:"0 auto",position:"relative"},u={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","text-decoration":"none"},h={display:"flex",gap:"1rem","align-items":"center",flex:"1","margin-left":"2rem"},y={display:"none",position:"absolute",top:"100%",left:"0",right:"0",background:"var(--surface-color)","border-top":"1px solid var(--border-color)","box-shadow":"var(--shadow-md)","max-height":"70vh","overflow-y":"auto"},g={position:"relative",display:"flex","align-items":"center"},p={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem",background:"transparent",border:"none",color:"var(--text-secondary)","font-weight":"500","font-size":"0.875rem",cursor:"pointer","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease","white-space":"nowrap"},C={position:"absolute",top:"100%",left:"0",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)","min-width":"200px","margin-top":"0.25rem","z-index":"10",display:"none","padding-top":"0.25rem"},S={"border-bottom":"1px solid var(--border-color)"},w={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",cursor:"pointer","font-weight":"600",color:"var(--text-primary)"},x={display:"block","text-decoration":"none",color:"var(--text-secondary)",padding:"0.75rem 1rem","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease","white-space":"nowrap"},V={...x,padding:"0.75rem 1.5rem","border-bottom":"1px solid var(--border-light)"},ne={display:"none",background:"transparent",border:"none",padding:"0.5rem",cursor:"pointer",color:"var(--text-primary)"},X={display:"flex","align-items":"center",gap:"1rem"},Q={display:"flex","align-items":"center",gap:"0.75rem",padding:"0.5rem 1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",color:"var(--text-primary)"},ee={width:"32px",height:"32px","border-radius":"50%","object-fit":"cover"},E={...x,cursor:"pointer",border:"1px solid var(--border-color)",background:"transparent","border-radius":"var(--border-radius-sm)"},A=()=>{Ar.signOut()},T=F=>{const W=Ar.state?.profile;return W?W[F]===!0||W.isAdmin===!0:!1},R=()=>{r(!e())},_=F=>{i(n()===F?null:F)},I=F=>{const W=o();W&&(clearTimeout(W),s(null)),i(F)},b=()=>{const F=setTimeout(()=>{i(null)},300);s(F)},G=[{name:"Finance",icon:"",items:[{path:"/accounts",label:t("navigation.accounts"),permission:"AccountAccess",icon:""},{path:"/entry-books",label:t("navigation.entryBooks"),permission:"JournalAccess",icon:""},{path:"/balance-sheet",label:t("navigation.balanceSheet"),permission:"AccountAccess",icon:""},{path:"/bank-consolidations",label:t("navigation.consolidate"),permission:"BankingAccess",icon:""}]},{name:"Operations",icon:"",items:[{path:"/inventory",label:t("navigation.inventory"),permission:"InventoryAccess",icon:""},{path:"/invoices",label:t("invoices.invoices"),permission:"invoiceAccess",icon:""},{path:"/hbl",label:t("navigation.hbl"),permission:"HBLAccess",icon:""}]},{name:"Management",icon:"",items:[{path:"/employees",label:t("navigation.employees"),permission:"EmployeeAccess",icon:""},{path:"/admin/users",label:"Admin",permission:"isAdmin",icon:"",adminOnly:!0}]}],ie=()=>G.map(F=>({...F,items:F.items.filter(W=>W.adminOnly?Ar.state?.profile?.isAdmin:T(W.permission))})).filter(F=>F.items.length>0);return(()=>{var F=e$(),W=F.firstChild,z=W.firstChild,O=z.nextSibling,k=O.firstChild,re=k.firstChild,$=re.firstChild,D=W.nextSibling;return l(W,B(tc,{href:"/",style:u,children:"HRM Finance"}),z),m(z,h),l(z,B(tc,{href:"/",style:x,activeClass:"nav-active",get children(){return[" ",Te(()=>t("navigation.dashboard"))]}}),null),l(z,B(Ut,{get each(){return ie()},children:H=>(()=>{var L=t$(),j=L.firstChild,oe=j.firstChild,K=oe.nextSibling,Z=j.nextSibling;return L.addEventListener("mouseleave",b),L.addEventListener("mouseenter",()=>I(H.name)),l(j,()=>H.icon,oe),l(j,()=>H.name,K),K.style.setProperty("font-size","0.75rem"),Z.addEventListener("mouseleave",b),Z.addEventListener("mouseenter",()=>I(H.name)),l(Z,B(Ut,{get each(){return H.items},children:J=>B(tc,{get href(){return J.path},style:x,activeClass:"nav-active",onClick:()=>i(null),get children(){return[Te(()=>J.icon)," ",Te(()=>J.label)]}})})),we(J=>{var Y=g,U=p,ae={...C,display:n()===H.name?"block":"none"};return J.e=m(L,Y,J.e),J.t=m(j,U,J.t),J.a=m(Z,ae,J.a),J},{e:void 0,t:void 0,a:void 0}),L})()}),null),m(O,X),l(O,B(JI,{}),k),l(O,B(Ge,{get when(){return Ar.currentUser},get children(){return[(()=>{var H=QI(),L=H.firstChild;return l(H,B(Ge,{get when(){return Ar.currentUser?.photoURL},get children(){var j=e0();return we(oe=>{var K=Ar.currentUser.photoURL,Z=ee;return K!==oe.e&&Yt(j,"src",oe.e=K),oe.t=m(j,Z,oe.t),oe},{e:void 0,t:void 0}),j}}),L),l(L,()=>Ar.currentUser?.displayName||Ar.currentUser?.email),we(j=>m(H,Q,j)),H})(),(()=>{var H=XI();return H.addEventListener("mouseleave",L=>{L.currentTarget.style.background="transparent",L.currentTarget.style.color="var(--text-secondary)"}),H.addEventListener("mouseenter",L=>{L.currentTarget.style.background="var(--background-color)",L.currentTarget.style.color="var(--text-primary)"}),H.$$click=A,we(L=>m(H,E,L)),H})()]}}),k),k.$$click=R,m(k,ne),l(D,B(tc,{href:"/",style:V,activeClass:"nav-active",onClick:()=>r(!1),get children(){return[" ",Te(()=>t("navigation.dashboard"))]}}),null),l(D,B(Ut,{get each(){return ie()},children:H=>(()=>{var L=n$(),j=L.firstChild,oe=j.firstChild,K=oe.firstChild,Z=oe.nextSibling;return m(L,S),j.$$click=()=>_(H.name),m(j,w),l(oe,()=>H.icon,K),l(oe,()=>H.name,null),Z.style.setProperty("transition","transform 0.2s"),l(L,B(Ge,{get when(){return n()===H.name},get children(){var J=r$();return J.style.setProperty("background","var(--background-color)"),l(J,B(Ut,{get each(){return H.items},children:Y=>B(tc,{get href(){return Y.path},get style(){return{...V,"padding-left":"3rem"}},activeClass:"nav-active",onClick:()=>r(!1),get children(){return[Te(()=>Y.icon)," ",Te(()=>Y.label)]}})})),J}}),null),we(J=>(J=n()===H.name?"rotate(180deg)":"none")!=null?Z.style.setProperty("transform",J):Z.style.removeProperty("transform")),L})()}),null),l(D,B(Ge,{get when(){return Ar.currentUser},get children(){var H=ZI(),L=H.firstChild,j=L.firstChild,oe=L.nextSibling;return H.style.setProperty("padding","1rem"),H.style.setProperty("border-top","2px solid var(--border-color)"),l(L,B(Ge,{get when(){return Ar.currentUser?.photoURL},get children(){var K=e0();return we(Z=>{var J=Ar.currentUser.photoURL,Y=ee;return J!==Z.e&&Yt(K,"src",Z.e=J),Z.t=m(K,Y,Z.t),Z},{e:void 0,t:void 0}),K}}),j),l(j,()=>Ar.currentUser?.displayName||Ar.currentUser?.email),oe.$$click=()=>{A(),r(!1)},we(K=>{var Z={...Q,"margin-bottom":"1rem"},J={...E,width:"100%"};return K.e=m(L,Z,K.e),K.t=m(oe,J,K.t),K},{e:void 0,t:void 0}),H}}),null),we(H=>{var L=a,j=c,oe=e()?"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z":"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z",K={...y,display:e()?"block":"none"};return H.e=m(F,L,H.e),H.t=m(W,j,H.t),oe!==H.a&&Yt($,"d",H.a=oe),H.o=m(D,K,H.o),H},{e:void 0,t:void 0,a:void 0,o:void 0}),F})()};dr(["click"]);var o$=de("<div><div><div></div><h1></h1><p>.</p><div><p><strong></strong><br></p></div><div><button></button></div><div><h3></h3><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div></div><div><p>"),t0=de("<br>"),s$=de("<strong>");const a$=t=>{const{t:e}=er(),r={"min-height":"calc(100vh - 200px)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},n={"text-align":"center","max-width":"600px",width:"100%"},i={"font-size":"5rem",color:"#e53e3e","margin-bottom":"2rem"},o={"font-size":"2.5rem","font-weight":"700",color:"#1a202c","margin-bottom":"1rem"},s={"font-size":"1.25rem",color:"#718096","margin-bottom":"2rem","line-height":"1.6"},a={background:"#f7fafc",border:"1px solid #e2e8f0","border-radius":"0.5rem",padding:"1.5rem","margin-bottom":"2rem"},c={color:"#4a5568","font-size":"1rem","line-height":"1.6"},u={display:"flex",gap:"1rem","justify-content":"center","flex-wrap":"wrap"},h={padding:"0.75rem 2rem","border-radius":"0.5rem","text-decoration":"none","font-weight":"500",transition:"all 0.2s",display:"inline-block"},y={...h,background:"var(--primary-color)",color:"white",border:"2px solid var(--primary-color)"},g={...h,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},p={"text-align":"left","margin-top":"2rem",padding:"0 2rem"},C={display:"flex","align-items":"center",gap:"0.75rem","margin-bottom":"1rem",color:"#4a5568"},S={color:"#48bb78","font-size":"1.25rem"};return B(ro,{get title(){return e("unauthorized.title")},get children(){var w=o$(),x=w.firstChild,V=x.firstChild,ne=V.nextSibling,X=ne.nextSibling,Q=X.firstChild,ee=X.nextSibling,E=ee.firstChild,A=E.firstChild;A.nextSibling;var T=ee.nextSibling,R=T.firstChild,_=T.nextSibling,I=_.firstChild,b=I.nextSibling,G=b.firstChild,ie=G.nextSibling,F=b.nextSibling,W=F.firstChild,z=W.nextSibling,O=F.nextSibling,k=O.firstChild,re=k.nextSibling,$=_.nextSibling,D=$.firstChild;return m(w,r),m(x,n),m(V,i),m(ne,o),l(ne,()=>e("unauthorized.accessDenied")),m(X,s),l(X,()=>e("unauthorized.noPermission"),Q),l(X,(()=>{var H=Te(()=>!!t.featureName);return()=>H()?` ${t.featureName}`:` ${e("unauthorized.thisFeature")}`})(),Q),m(ee,a),m(E,c),l(A,()=>e("unauthorized.whySeeing")),l(E,()=>e("unauthorized.explanation"),null),l(E,(()=>{var H=Te(()=>!!t.requiredPermission);return()=>H()&&[t0(),t0(),(()=>{var L=s$();return l(L,()=>e("unauthorized.requiredPermission")),L})()," ",Te(()=>t.requiredPermission)]})(),null),m(T,u),l(T,B(tc,{href:"/",style:y,get children(){return e("unauthorized.goToDashboard")}}),R),R.$$click=()=>window.history.back(),l(R,()=>e("unauthorized.goBack")),m(_,p),I.style.setProperty("margin-bottom","1rem"),I.style.setProperty("color","#2d3748"),l(I,()=>e("unauthorized.featuresCanAccess")),l(ie,()=>e("unauthorized.dashboardAccess")),l(z,()=>e("unauthorized.profileAccess")),l(re,()=>e("unauthorized.roleBasedAccess")),$.style.setProperty("margin-top","3rem"),$.style.setProperty("padding","1.5rem"),$.style.setProperty("background","#edf2f7"),$.style.setProperty("border-radius","0.5rem"),D.style.setProperty("color","#4a5568"),D.style.setProperty("font-size","0.875rem"),l(D,()=>e("unauthorized.needAccess")),we(H=>{var L=g,j=C,oe=S,K=C,Z=S,J=C,Y=S;return H.e=m(R,L,H.e),H.t=m(b,j,H.t),H.a=m(G,oe,H.a),H.o=m(F,K,H.o),H.i=m(W,Z,H.i),H.n=m(O,J,H.n),H.s=m(k,Y,H.s),H},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),w}})};dr(["click"]);const Io=t=>{const{t:e}=er(),r=()=>{if(!t.permission)return!0;const i=Ar.state?.profile;if(!i)return!1;if(i.isAdmin)return!0;switch(t.permission){case"AccountAccess":return i.AccountAccess===!0;case"InventoryAccess":return i.InventoryAccess===!0;case"EmployeeAccess":return i.EmployeeAccess===!0;case"BankingAccess":return i.BankingAccess===!0;case"JournalAccess":return i.JournalAccess===!0;case"AdminAccess":return i.isAdmin===!0;default:return i[t.permission]===!0}},n=()=>{if(t.requiredPermission)return t.requiredPermission;switch(t.permission){case"AccountAccess":return e("unauthorized.permissions.accountAccess");case"InventoryAccess":return e("unauthorized.permissions.inventoryAccess");case"EmployeeAccess":return e("unauthorized.permissions.employeeAccess");case"BankingAccess":return e("unauthorized.permissions.bankingAccess");case"JournalAccess":return e("unauthorized.permissions.journalAccess");case"AdminAccess":return e("unauthorized.permissions.adminAccess");default:return t.permission}};return B(Ge,{get when(){return r()},get fallback(){return t.fallback||B(a$,{get featureName(){return t.featureName},get requiredPermission(){return n()}})},get children(){return t.children}})};var l$=de('<button title="Open Dev Tools">'),c$=de("<span>(<!>)"),u$=de("<div><span></span><span>"),r0=de("<div>"),d$=de("<div>Database reset only available in fake mode"),h$=de("<div><div>Loading..."),f$=de("<div><div><h3> Dev Tools</h3><button></button></div><div><div>API Mode</div><div><button>Fake Server</button><button>Real API</button><button>Hybrid</button></div><div>Current: <strong></strong></div></div><div><div>Health Status</div></div><div><div>Database Stats</div></div><div><div>Actions</div><div><button> Refresh Stats</button><button> Health Check</button></div><div><button> Reset DB</button></div></div><div><div>Info</div><div> <strong>Fake Server:</strong> Uses local mock data<br> <strong>Real API:</strong> Connects to actual backend<br> <strong>Hybrid:</strong> Real API with fake fallback<br> Settings are saved in localStorage"),p$=de("<div>Loading..."),m$=de("<div><span>:</span><span>");const y$=()=>{const[t,e]=$e(!1),[r,n]=$e($u.getMode()),[i,o]=$e({}),[s,a]=$e(null),[c,u]=$e(!1);Rn(async()=>{await h(),await y()});const h=async()=>{try{const E=await Pg.getStats();o(E)}catch(E){console.error("Failed to load stats:",E)}},y=async()=>{try{const E=await Pg.healthCheck();a(E)}catch(E){console.error("Health check failed:",E),a({status:"error",error:E.message})}},g=async E=>{u(!0);try{$u.setMode(E),n(E),await h(),await y()}catch(A){console.error("Failed to change API mode:",A)}finally{u(!1)}},p=async()=>{if(confirm("Are you sure you want to reset the fake database to its initial state?")){u(!0);try{const E=await li.utils.resetDatabase();alert(E.message),await h()}catch(E){console.error("Failed to reset database:",E),alert("Failed to reset database")}finally{u(!1)}}},C={position:"fixed",bottom:"20px",right:"20px","z-index":"10000","font-family":"monospace"},S={background:"#1a1a1a",color:"#fff",border:"1px solid #333","border-radius":"8px",padding:"16px","min-width":"300px","max-width":"400px","box-shadow":"0 4px 20px rgba(0,0,0,0.3)"},w={background:"#007acc",color:"#fff",border:"none","border-radius":"50%",width:"50px",height:"50px",cursor:"pointer","font-size":"20px","box-shadow":"0 2px 10px rgba(0,0,0,0.2)",display:"flex","align-items":"center","justify-content":"center"},x={background:"#333",color:"#fff",border:"1px solid #555","border-radius":"4px",padding:"6px 12px",cursor:"pointer","font-size":"12px","margin-right":"8px","margin-bottom":"8px"},V={...x,background:"#007acc","border-color":"#007acc"},ne={"margin-bottom":"16px","padding-bottom":"12px","border-bottom":"1px solid #333"},X={"font-size":"14px","font-weight":"bold","margin-bottom":"8px",color:"#007acc"},Q={display:"flex","justify-content":"space-between","font-size":"12px","margin-bottom":"4px"},ee=E=>({display:"inline-block",width:"8px",height:"8px","border-radius":"50%","margin-right":"8px",background:E==="healthy"?"#00ff00":E==="error"?"#ff0000":"#ffff00"});return(()=>{var E=r0();return l(E,B(Ge,{get when(){return!t()},get children(){var A=l$();return A.$$click=()=>e(!0),m(A,w),A}}),null),l(E,B(Ge,{get when(){return t()},get children(){var A=f$(),T=A.firstChild,R=T.firstChild,_=R.nextSibling,I=T.nextSibling,b=I.firstChild,G=b.nextSibling,ie=G.firstChild,F=ie.nextSibling,W=F.nextSibling,z=G.nextSibling,O=z.firstChild,k=O.nextSibling,re=I.nextSibling,$=re.firstChild,D=re.nextSibling,H=D.firstChild,L=D.nextSibling,j=L.firstChild,oe=j.nextSibling,K=oe.firstChild,Z=K.nextSibling,J=oe.nextSibling,Y=J.firstChild,U=L.nextSibling,ae=U.firstChild,ue=ae.nextSibling;return m(A,S),T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),T.style.setProperty("margin-bottom","16px"),R.style.setProperty("margin","0"),R.style.setProperty("color","#007acc"),R.style.setProperty("font-size","16px"),_.$$click=()=>e(!1),ie.$$click=()=>g("fake"),F.$$click=()=>g("real"),W.$$click=()=>g("hybrid"),z.style.setProperty("font-size","11px"),z.style.setProperty("color","#888"),z.style.setProperty("margin-top","4px"),l(k,r),l(z,()=>r()==="fake"&&" (Using fake server)",null),l(z,()=>r()==="real"&&" (Using real API)",null),l(z,()=>r()==="hybrid"&&" (Real API with fallback)",null),l(re,B(Ge,{get when(){return s()},get fallback(){return(()=>{var le=p$();return le.style.setProperty("font-size","12px"),le})()},get children(){return[(()=>{var le=u$(),q=le.firstChild,ce=q.nextSibling;return le.style.setProperty("display","flex"),le.style.setProperty("align-items","center"),le.style.setProperty("font-size","12px"),l(ce,()=>s()?.status||"Unknown"),l(le,B(Ge,{get when(){return s()?.timestamp},get children(){var Se=c$(),me=Se.firstChild,Pe=me.nextSibling;return Pe.nextSibling,Se.style.setProperty("margin-left","8px"),Se.style.setProperty("color","#888"),l(Se,()=>new Date(s().timestamp).toLocaleTimeString(),Pe),Se}}),null),we(Se=>m(q,ee(s()?.status||"unknown"),Se)),le})(),B(Ge,{get when(){return s()?.error},get children(){var le=r0();return le.style.setProperty("font-size","11px"),le.style.setProperty("color","#ff6666"),le.style.setProperty("margin-top","4px"),l(le,()=>s().error),le}})]}}),null),l(D,B(Ut,{get each(){return Object.entries(i())},children:([le,q])=>(()=>{var ce=m$(),Se=ce.firstChild,me=Se.firstChild,Pe=Se.nextSibling;return m(ce,Q),Se.style.setProperty("text-transform","capitalize"),l(Se,le,me),Pe.style.setProperty("color","#00ff00"),l(Pe,q),ce})()}),null),K.$$click=h,Z.$$click=y,J.style.setProperty("margin-top","8px"),Y.$$click=p,l(L,B(Ge,{get when(){return r()!=="fake"},get children(){var le=d$();return le.style.setProperty("font-size","11px"),le.style.setProperty("color","#888"),le.style.setProperty("margin-top","4px"),le}}),null),ue.style.setProperty("font-size","11px"),ue.style.setProperty("color","#888"),ue.style.setProperty("line-height","1.4"),l(A,B(Ge,{get when(){return c()},get children(){var le=h$(),q=le.firstChild;return le.style.setProperty("position","absolute"),le.style.setProperty("top","0"),le.style.setProperty("left","0"),le.style.setProperty("right","0"),le.style.setProperty("bottom","0"),le.style.setProperty("background","rgba(0,0,0,0.7)"),le.style.setProperty("display","flex"),le.style.setProperty("align-items","center"),le.style.setProperty("justify-content","center"),le.style.setProperty("border-radius","8px"),q.style.setProperty("color","#fff"),q.style.setProperty("font-size","14px"),le}}),null),we(le=>{var q={...x,padding:"4px 8px"},ce=ne,Se=X,me=r()==="fake"?V:x,Pe=c(),xe=r()==="real"?V:x,he=c(),ve=r()==="hybrid"?V:x,De=c(),ke=ne,Ce=X,Le=ne,Ie=X,Re=ne,He=X,Me=x,Ze=c(),Ye=x,ut=c(),rt={...x,background:"#cc4400","border-color":"#cc4400"},We=c()||r()!=="fake",ct=X;return le.e=m(_,q,le.e),le.t=m(I,ce,le.t),le.a=m(b,Se,le.a),le.o=m(ie,me,le.o),Pe!==le.i&&(ie.disabled=le.i=Pe),le.n=m(F,xe,le.n),he!==le.s&&(F.disabled=le.s=he),le.h=m(W,ve,le.h),De!==le.r&&(W.disabled=le.r=De),le.d=m(re,ke,le.d),le.l=m($,Ce,le.l),le.u=m(D,Le,le.u),le.c=m(H,Ie,le.c),le.w=m(L,Re,le.w),le.m=m(j,He,le.m),le.f=m(K,Me,le.f),Ze!==le.y&&(K.disabled=le.y=Ze),le.g=m(Z,Ye,le.g),ut!==le.p&&(Z.disabled=le.p=ut),le.b=m(Y,rt,le.b),We!==le.T&&(Y.disabled=le.T=We),le.A=m(ae,ct,le.A),le},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),A}}),null),we(A=>m(E,C,A)),E})()};dr(["click"]);const g$=[{id:"1",accountNumber:"1000",name:"Cash and Cash Equivalents",type:"Asset",category:"Current Assets",description:"Cash on hand and in bank accounts",balance:45230.5,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1001",accountNumber:"1001",name:"Petty Cash",type:"Asset",category:"Current Assets",description:"Small amounts of cash for minor expenses",balance:500,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1002",accountNumber:"1002",name:"Bank - Checking Account",type:"Asset",category:"Current Assets",description:"Main operating checking account",balance:32730.5,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1003",accountNumber:"1003",name:"Bank - Savings Account",type:"Asset",category:"Current Assets",description:"Interest-bearing savings account",balance:12e3,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"2",accountNumber:"1100",name:"Accounts Receivable",type:"Asset",category:"Current Assets",description:"Money owed by customers",balance:23450.75,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2001",accountNumber:"1101",name:"Trade Receivables",type:"Asset",category:"Current Assets",description:"Receivables from regular customers",balance:18450.75,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2002",accountNumber:"1102",name:"Employee Advances",type:"Asset",category:"Current Assets",description:"Money advanced to employees",balance:5e3,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"3",accountNumber:"1200",name:"Inventory",type:"Asset",category:"Current Assets",description:"Products held for sale",balance:78920.25,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-13"},{id:"4",accountNumber:"1500",name:"Equipment",type:"Asset",category:"Fixed Assets",description:"Office equipment and machinery",balance:125e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-12"},{id:"5",accountNumber:"2000",name:"Accounts Payable",type:"Liability",category:"Current Liabilities",description:"Money owed to suppliers",balance:15670.3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-11"},{id:"6",accountNumber:"2100",name:"Accrued Expenses",type:"Liability",category:"Current Liabilities",description:"Expenses incurred but not yet paid",balance:8945.6,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-10"},{id:"7",accountNumber:"2500",name:"Long-term Debt",type:"Liability",category:"Long-term Liabilities",description:"Long-term loans and mortgages",balance:85e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-09"},{id:"8",accountNumber:"3000",name:"Owner's Equity",type:"Equity",category:"Owner's Equity",description:"Owner's investment in the business",balance:15e4,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-08"},{id:"9",accountNumber:"3100",name:"Retained Earnings",type:"Equity",category:"Owner's Equity",description:"Accumulated profits retained in business",balance:32450.8,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-07"},{id:"10",accountNumber:"4000",name:"Sales Revenue",type:"Revenue",category:"Operating Revenue",description:"Revenue from product sales",balance:245678.9,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-06"},{id:"11",accountNumber:"4100",name:"Service Revenue",type:"Revenue",category:"Operating Revenue",description:"Revenue from services provided",balance:89432.15,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-05"},{id:"12",accountNumber:"5000",name:"Cost of Goods Sold",type:"Expense",category:"Operating Expenses",description:"Direct costs of producing goods",balance:125678.45,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-04"},{id:"13",accountNumber:"5100",name:"Salaries Expense",type:"Expense",category:"Operating Expenses",description:"Employee salary expenses",balance:98765.32,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-03"},{id:"14",accountNumber:"5200",name:"Rent Expense",type:"Expense",category:"Operating Expenses",description:"Office rent expenses",balance:24e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-02"}],v$=[{id:"1",accountId:"1",date:"2024-01-15",description:"Customer payment received",debitAmount:5e3,creditAmount:0,reference:"INV-2024-001",type:"debit"},{id:"2",accountId:"2",date:"2024-01-15",description:"Customer payment received",debitAmount:0,creditAmount:5e3,reference:"INV-2024-001",type:"credit"},{id:"3",accountId:"5",date:"2024-01-14",description:"Office supplies purchased",debitAmount:0,creditAmount:1250,reference:"PO-2024-001",type:"credit"}],[Wo,Nd]=$e(g$),[Yf,b$]=$e(v$),Er={get accounts(){return Wo()},get transactions(){return Yf()},fetchAllAccount(t){const e={...t,id:Date.now().toString(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return Nd([...Wo(),e]),e},addAccount(t){const e={...t,id:Date.now().toString(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return Nd([...Wo(),e]),e},updateAccount(t,e){Nd(Wo().map(r=>r.id===t?{...r,...e,lastModified:new Date().toISOString().split("T")[0]}:r))},deleteAccount(t){Nd(Wo().filter(e=>e.id!==t))},getAccountById(t){return Wo().find(e=>e.id===t)},getAccountsByType(t){return Wo().filter(e=>e.type===t)},getAccountTransactions(t){return Yf().filter(e=>e.accountId===t)},addTransaction(t){const e={...t,id:Date.now().toString()};b$([...Yf(),e]);const r=this.getAccountById(t.accountId);if(r){const n=t.type==="debit"?t.debitAmount:-t.creditAmount;this.updateAccount(t.accountId,{balance:r.balance+n})}return e},getTotalByType(t){return Wo().filter(e=>e.type===t&&e.isActive).reduce((e,r)=>e+r.balance,0)},getAccountCategories(t){const e=this.getAccountsByType(t);return[...new Set(e.map(r=>r.category))]},getSubAccounts(t){return Wo().filter(e=>e.parentAccountId===t)},getParentAccounts(){return Wo().filter(t=>!t.parentAccountId)},getAccountHierarchy(){return this.getParentAccounts().map(e=>({...e,subAccounts:this.getSubAccounts(e.id)}))},getAccountWithSubAccounts(t){const e=this.getAccountById(t);return e?{...e,subAccounts:this.getSubAccounts(t),parentAccount:e.parentAccountId?this.getAccountById(e.parentAccountId):null}:null},getAccountPath(t){const e=this.getAccountById(t);if(!e)return[];const r=[e];let n=e;for(;n.parentAccountId;){const i=this.getAccountById(n.parentAccountId);if(i)r.unshift(i),n=i;else break}return r},getTotalBalanceWithSubAccounts(t){const e=this.getAccountById(t);if(!e)return 0;const n=this.getSubAccounts(t).reduce((i,o)=>i+this.getTotalBalanceWithSubAccounts(o.id),0);return e.balance+n},canDeleteAccount(t){const e=this.getSubAccounts(t);if(e.length>0)return{canDelete:!1,reason:`Account has ${e.length} sub-account(s). Delete or move sub-accounts first.`};const r=this.getAccountTransactions(t);return r.length>0?{canDelete:!1,reason:`Account has ${r.length} transaction(s). Cannot delete account with transaction history.`}:{canDelete:!0}}};var ua=de("<div>"),Wc=de("<div> ");const _$=()=>{const{t}=er(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},n={"font-size":"0.875rem",color:"var(--text-muted)"},i=S=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(S),o=Er.getTotalByType("Asset"),s=Er.getTotalByType("Liability"),a=Er.getTotalByType("Equity"),c=Er.getTotalByType("Revenue"),u=Er.getTotalByType("Expense"),h=Er.getAccountsByType("Asset").length,y=Er.getAccountsByType("Liability").length,g=Er.getAccountsByType("Equity").length,p=Er.getAccountsByType("Revenue").length,C=Er.getAccountsByType("Expense").length;return(()=>{var S=ua();return m(S,e),l(S,B(Nt,{get title(){return t("dashboard.totalAssets")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var w=ua();return l(w,()=>i(o)),we(x=>m(w,r,x)),w})(),(()=>{var w=Wc(),x=w.firstChild;return l(w,h,x),l(w,()=>t("navigation.accounts"),null),we(V=>m(w,n,V)),w})()]}}),null),l(S,B(Nt,{get title(){return t("dashboard.totalLiabilities")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var w=ua();return l(w,()=>i(s)),we(x=>m(w,r,x)),w})(),(()=>{var w=Wc(),x=w.firstChild;return l(w,y,x),l(w,()=>t("navigation.accounts"),null),we(V=>m(w,n,V)),w})()]}}),null),l(S,B(Nt,{get title(){return t("dashboard.totalEquity")},get subtitle(){return t("accounts.categories.ownersEquity")},get children(){return[(()=>{var w=ua();return l(w,()=>i(a)),we(x=>m(w,r,x)),w})(),(()=>{var w=Wc(),x=w.firstChild;return l(w,g,x),l(w,()=>t("navigation.accounts"),null),we(V=>m(w,n,V)),w})()]}}),null),l(S,B(Nt,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("accounts.categories.operatingRevenue")},get children(){return[(()=>{var w=ua();return l(w,()=>i(c)),we(x=>m(w,r,x)),w})(),(()=>{var w=Wc(),x=w.firstChild;return l(w,p,x),l(w,()=>t("navigation.accounts"),null),we(V=>m(w,n,V)),w})()]}}),null),l(S,B(Nt,{get title(){return t("dashboard.totalExpenses")},get subtitle(){return t("accounts.categories.operatingExpenses")},get children(){return[(()=>{var w=ua();return l(w,()=>i(u)),we(x=>m(w,r,x)),w})(),(()=>{var w=Wc(),x=w.firstChild;return l(w,C,x),l(w,()=>t("navigation.accounts"),null),we(V=>m(w,n,V)),w})()]}}),null),l(S,B(Nt,{get title(){return t("dashboard.netIncome")},get subtitle(){return`${t("dashboard.totalRevenue")} - ${t("dashboard.totalExpenses")}`},get children(){return[(()=>{var w=ua();return l(w,()=>i(c-u)),we(x=>m(w,{...r,color:c-u>=0?"#4caf50":"#f44336"},x)),w})(),(()=>{var w=ua();return l(w,()=>c-u>=0?t("dashboard.netIncome"):t("dashboard.netLoss")),we(x=>m(w,n,x)),w})()]}}),null),S})()};var w$=de("<div><div></div><div>"),S$=de("<h3>"),Gc=de("<div>");const P$=t=>{const{t:e}=er();Nm();const r={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},i={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"},o={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},s={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},a={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem"},c={"font-size":"0.875rem",color:"var(--text-secondary)","line-height":"1.4"},u=g=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[g]||{bg:"#f5f5f5",color:"#666"},h=g=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(g),y=u(t.account.type);return B(Nt,{get children(){return[(()=>{var g=w$(),p=g.firstChild,C=p.nextSibling;return m(g,n),m(p,i),l(p,()=>t.account.accountNumber),l(C,()=>e(`accounts.types.${t.account.type.toLowerCase()}`)),we(S=>m(C,{...o,background:y.bg,color:y.color},S)),g})(),(()=>{var g=S$();return g.style.setProperty("margin","0 0 0.5rem 0"),g.style.setProperty("font-size","1.1rem"),l(g,()=>t.account.name),g})(),(()=>{var g=Gc();return m(g,a),l(g,()=>t.account.category),g})(),(()=>{var g=Gc();return m(g,s),l(g,()=>h(t.account.balance)),g})(),(()=>{var g=Gc();return m(g,c),l(g,()=>t.account.description),g})(),Te(()=>Te(()=>!t.account.isActive)()&&(()=>{var g=Gc();return g.style.setProperty("margin-top","0.5rem"),g.style.setProperty("padding","0.25rem 0.75rem"),g.style.setProperty("border-radius","9999px"),g.style.setProperty("font-size","0.75rem"),g.style.setProperty("font-weight","500"),g.style.setProperty("background","#ffebee"),g.style.setProperty("color","#d32f2f"),g.style.setProperty("text-align","center"),l(g,()=>e("common.inactive")),g})()),(()=>{var g=Gc();return m(g,r),l(g,B(xt,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.account),get children(){return[Te(()=>e("common.view"))," ",Te(()=>e("accounts.accountDetails"))]}})),g})()]}})};var x$=de("<div><div><div><div></div><h3></h3></div></div><div><div></div><div>"),A$=de("<div>"),C$=de("<button>"),I$=de("<div><h4> (<!>)"),$$=de("<div><div><div></div><div>  </div></div><div>");const E$=t=>{const{t:e}=er(),r=Nm(),[n,i]=$e(!0),o={"margin-bottom":"1rem"},s={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},a={display:"flex","align-items":"center",gap:"1rem"},c={background:"none",border:"none",cursor:"pointer","font-size":"1.2rem",color:"var(--text-muted)",padding:"0.25rem","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease"},u={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},h={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},y={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},g={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},p={"margin-left":"1rem","border-left":"2px solid var(--border-color)","padding-left":"1rem","margin-top":"1rem"},C={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem","margin-bottom":"0.5rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},S={flex:"1"},w={"font-weight":"500","margin-bottom":"0.25rem"},x={"font-size":"0.875rem",color:"var(--text-muted)"},V={"font-weight":"600",color:"var(--primary-color)"},ne={display:"flex",gap:"0.5rem"},X=R=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[R]||{bg:"#f5f5f5",color:"#666"},Q=R=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(R),ee=R=>{t.onViewDetails?t.onViewDetails(R):r(`/accounts/${R.id}`)},E=()=>{t.onAddSubAccount&&t.onAddSubAccount(t.account)},A=t.account.balance+t.account.subAccounts.reduce((R,_)=>R+_.balance,0),T=X(t.account.type);return B(Nt,{className:"account-hierarchy-card",style:o,get children(){return[(()=>{var R=x$(),_=R.firstChild,I=_.firstChild,b=I.firstChild,G=b.nextSibling,ie=_.nextSibling,F=ie.firstChild,W=F.nextSibling;return m(R,s),m(_,a),l(_,(()=>{var z=Te(()=>t.account.subAccounts.length>0);return()=>z()&&(()=>{var O=C$();return O.addEventListener("mouseleave",k=>k.target.style.background="none"),O.addEventListener("mouseenter",k=>k.target.style.background="var(--background-color)"),O.$$click=()=>i(!n()),m(O,c),l(O,()=>n()?"":""),O})()})(),I),I.$$click=()=>ee(t.account),I.style.setProperty("cursor","pointer"),m(b,u),l(b,()=>t.account.accountNumber),m(G,h),l(G,()=>t.account.name),ie.style.setProperty("text-align","right"),m(F,y),l(F,()=>Q(A)),l(W,()=>e(`accounts.types.${t.account.type.toLowerCase()}`)),we(z=>m(W,{...g,background:T.bg,color:T.color},z)),R})(),(()=>{var R=A$();return m(R,ne),l(R,B(xt,{variant:"secondary",size:"sm",onClick:()=>ee(t.account),get children(){return[Te(()=>e("common.view"))," ",Te(()=>e("accounts.accountDetails"))]}}),null),l(R,B(xt,{variant:"outline",size:"sm",onClick:E,get children(){return[Te(()=>e("common.add"))," ",Te(()=>e("accounts.subAccounts"))]}}),null),R})(),Te(()=>Te(()=>!!(n()&&t.account.subAccounts.length>0))()&&(()=>{var R=I$(),_=R.firstChild,I=_.firstChild,b=I.nextSibling;return b.nextSibling,m(R,p),_.style.setProperty("margin","0 0 1rem 0"),_.style.setProperty("font-size","1rem"),_.style.setProperty("color","var(--text-muted)"),l(_,()=>e("accounts.subAccounts"),I),l(_,()=>t.account.subAccounts.length,b),l(R,()=>t.account.subAccounts.map(G=>(()=>{var ie=$$(),F=ie.firstChild,W=F.firstChild,z=W.nextSibling,O=z.firstChild,k=F.nextSibling;return ie.addEventListener("mouseleave",re=>{re.currentTarget.style.background="var(--background-color)",re.currentTarget.style.transform="translateY(0)"}),ie.addEventListener("mouseenter",re=>{re.currentTarget.style.background="var(--surface-color)",re.currentTarget.style.transform="translateY(-1px)"}),ie.$$click=()=>ee(G),m(ie,C),m(F,S),m(W,w),l(W,()=>G.name),m(z,x),l(z,()=>G.accountNumber,O),l(z,()=>G.description,null),m(k,V),l(k,()=>Q(G.balance)),ie})()),null),R})())]}})};dr(["click"]);var k$=de("<form><div>");const T$=t=>{const{t:e}=er(),[r,n]=$e({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),i=[{value:"Asset",label:e("accounts.types.asset"),type:"debit",classification:"real"},{value:"Liability",label:e("accounts.types.liability"),type:"credit",classification:"real"},{value:"Equity",label:e("accounts.types.equity"),type:"credit",classification:"real"},{value:"Revenue",label:e("accounts.types.revenue"),type:"credit",classification:"nominal"},{value:"Expense",label:e("accounts.types.expense"),type:"debit",classification:"nominal"}],o=()=>{const h=r().type;return h?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")},{value:"Sales Revenue",label:e("accounts.categories.salesRevenue")},{value:"Service Revenue",label:e("accounts.categories.servicesRevenue")},{value:"Subscription Revenue",label:e("accounts.categories.subscriptionRevenue")},{value:"Rental Revenue",label:e("accounts.categories.rentalRevenue")},{value:"Commission Revenue",label:e("accounts.categories.commissionRevenue")},{value:"Franchise Revenue",label:e("accounts.categories.franchiseRevenue")},{value:"Licensing Revenue",label:e("accounts.categories.licensingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[h]||[]:[]},s=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],a={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},c=h=>{h.preventDefault();const y=r();if(!y.accountNumber||!y.name||!y.type||!y.category){alert(e("forms.requiredField"));return}if(Er.accounts.find(C=>C.accountNumber===y.accountNumber)){alert(e("forms.duplicateAccountNumber"));return}const p={accountNumber:y.accountNumber,name:y.name,type:y.type,category:y.category,description:y.description,balance:parseFloat(y.balance)||0,isActive:y.isActive==="true"};Er.addAccount(p),n({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},u=(h,y)=>{n(g=>{const p={...g,[h]:y};return h==="type"&&(p.category=""),p})};return B(Xn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.addAccount")},get children(){var h=k$(),y=h.firstChild;return h.addEventListener("submit",c),l(h,B(Or,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:g=>u("accountNumber",g),get placeholder(){return e("accounts.accountNumber")},required:!0}),y),l(h,B(Or,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:g=>u("name",g),get placeholder(){return e("accounts.accountName")},required:!0}),y),l(h,B(ci,{get label(){return e("accounts.accountType")},get value(){return r().type},onChange:g=>u("type",g),options:i,required:!0}),y),l(h,B(ci,{get label(){return e("accounts.category")},get value(){return r().category},onChange:g=>u("category",g),get options(){return o()},required:!0}),y),l(h,B(Or,{get label(){return e("common.description")},get value(){return r().description},onChange:g=>u("description",g),get placeholder(){return e("common.description")}}),y),l(h,B(Or,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:g=>u("balance",g),get placeholder(){return e("accounts.balance")}}),y),l(h,B(ci,{get label(){return e("common.status")},get value(){return r().isActive},onChange:g=>u("isActive",g),options:s,required:!0}),y),m(y,a),l(y,B(xt,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),l(y,B(xt,{variant:"primary",type:"submit",get children(){return e("accounts.addAccount")}}),null),h}})};var N$=de("<form><div>"),L$=de("<div><div></div><div> - </div><div>  ");const D$=t=>{const{t:e}=er(),[r,n]=$e({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),i=()=>t.parentAccount?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[t.parentAccount.type]||[]:[],o=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],s={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},a={background:"var(--background-color)",padding:"1rem","border-radius":"var(--border-radius-sm)","margin-bottom":"1.5rem",border:"1px solid var(--border-color)"},c={"font-size":"0.875rem","font-weight":"500",color:"var(--text-muted)","margin-bottom":"0.5rem"},u={"font-weight":"600",color:"var(--text-primary)"},h={"font-size":"0.875rem",color:"var(--text-secondary)"},y=S=>{S.preventDefault();const w=r();if(!w.accountNumber||!w.name||!w.category||!t.parentAccount){alert(e("forms.requiredField"));return}if(Er.accounts.find(ne=>ne.accountNumber===w.accountNumber)){alert(e("forms.duplicateAccountNumber"));return}const V={accountNumber:w.accountNumber,name:w.name,type:t.parentAccount.type,category:w.category,description:w.description,balance:parseFloat(w.balance)||0,isActive:w.isActive==="true",parentAccountId:t.parentAccount.id};Er.addAccount(V),n({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},g=(S,w)=>{n(x=>({...x,[S]:w}))},p=()=>{if(!t.parentAccount)return"";const S=t.parentAccount.accountNumber,x=Er.getSubAccounts(t.parentAccount.id).length+1;return(parseInt(S)+x).toString()},C=()=>r().accountNumber===""&&t.parentAccount?p():r().accountNumber;return B(Xn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return`${e("common.add")} ${e("accounts.subAccounts")}`},get children(){return[Te(()=>Te(()=>!!t.parentAccount)()&&(()=>{var S=L$(),w=S.firstChild,x=w.nextSibling,V=x.firstChild,ne=x.nextSibling,X=ne.firstChild;return m(S,a),m(w,c),l(w,()=>e("accounts.parentAccount")),m(x,u),l(x,()=>t.parentAccount.accountNumber,V),l(x,()=>t.parentAccount.name,null),m(ne,h),l(ne,()=>e(`accounts.types.${t.parentAccount.type.toLowerCase()}`),X),l(ne,()=>t.parentAccount.category,null),S})()),(()=>{var S=N$(),w=S.firstChild;return S.addEventListener("submit",y),l(S,B(Or,{get label(){return e("accounts.accountNumber")},get value(){return C()},onChange:x=>g("accountNumber",x),get placeholder(){return`${e("common.suggested")}: ${p()}`},required:!0}),w),l(S,B(Or,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:x=>g("name",x),get placeholder(){return e("accounts.accountName")},required:!0}),w),l(S,B(ci,{get label(){return e("accounts.category")},get value(){return r().category},onChange:x=>g("category",x),get options(){return i()},required:!0}),w),l(S,B(Or,{get label(){return e("common.description")},get value(){return r().description},onChange:x=>g("description",x),get placeholder(){return e("common.description")}}),w),l(S,B(Or,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:x=>g("balance",x),get placeholder(){return e("accounts.balance")}}),w),l(S,B(ci,{get label(){return e("common.status")},get value(){return r().isActive},onChange:x=>g("isActive",x),options:o,required:!0}),w),m(w,s),l(w,B(xt,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),l(w,B(xt,{variant:"primary",type:"submit",get children(){return[Te(()=>e("common.add"))," ",Te(()=>e("accounts.subAccounts"))]}}),null),S})()]}})};var R$=de("<form><div>"),M$=de("<div>");const F$=t=>{const{t:e}=er(),[r,n]=$e({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),[i,o]=$e(null);vo(()=>{t.account&&(n({accountNumber:t.account.accountNumber,name:t.account.name,type:t.account.type,category:t.account.category,description:t.account.description,balance:t.account.balance.toString(),isActive:t.account.isActive.toString()}),o(null))});const s=[{value:"Asset",label:e("accounts.types.asset")},{value:"Liability",label:e("accounts.types.liability")},{value:"Equity",label:e("accounts.types.equity")},{value:"Revenue",label:e("accounts.types.revenue")},{value:"Expense",label:e("accounts.types.expense")}],a=()=>{const p=r().type;return p?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[p]||[]:[]},c=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],u={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},h=p=>{if(p.preventDefault(),o(null),!t.account)return;const C=r();if(!C.accountNumber||!C.name||!C.type||!C.category){o(e("forms.requiredField"));return}if(Er.accounts.find(x=>x.accountNumber===C.accountNumber&&x.id!==t.account.id)){o(e("forms.duplicateAccountNumber"));return}const w={accountNumber:C.accountNumber,name:C.name,type:C.type,category:C.category,description:C.description,balance:parseFloat(C.balance)||0,isActive:C.isActive==="true"};try{Er.updateAccount(t.account.id,w),t.onClose()}catch(x){o(x instanceof Error?x.message:e("forms.saveError"))}},y=()=>{if(!t.account)return;const p=Er.canDeleteAccount(t.account.id);if(!p.canDelete){o(p.reason||e("forms.deleteError"));return}const C=e("forms.confirmDelete");if(confirm(C))try{Er.deleteAccount(t.account.id),t.onClose()}catch(S){o(S instanceof Error?S.message:e("forms.deleteError"))}},g=(p,C)=>{n(S=>{const w={...S,[p]:C};return p==="type"&&(w.category=""),w}),i()&&o(null)};return t.account?B(Xn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.editAccount")},get children(){var p=R$(),C=p.firstChild;return p.addEventListener("submit",h),l(p,B(Or,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:S=>g("accountNumber",S),get placeholder(){return e("accounts.accountNumber")},required:!0}),C),l(p,B(Or,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:S=>g("name",S),get placeholder(){return e("accounts.accountName")},required:!0}),C),l(p,B(ci,{get label(){return e("accounts.accountType")},get value(){return r().type},onChange:S=>g("type",S),options:s,required:!0}),C),l(p,B(ci,{get label(){return e("accounts.category")},get value(){return r().category},onChange:S=>g("category",S),get options(){return a()},required:!0}),C),l(p,B(Or,{get label(){return e("common.description")},get value(){return r().description},onChange:S=>g("description",S),get placeholder(){return e("common.description")}}),C),l(p,B(Or,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:S=>g("balance",S),get placeholder(){return e("accounts.balance")}}),C),l(p,B(ci,{get label(){return e("common.status")},get value(){return r().isActive},onChange:S=>g("isActive",S),options:c,required:!0}),C),l(p,(()=>{var S=Te(()=>!!i());return()=>S()&&(()=>{var w=M$();return w.style.setProperty("padding","1rem"),w.style.setProperty("border-radius","var(--border-radius-sm)"),w.style.setProperty("margin-top","1rem"),w.style.setProperty("background","#f8d7da"),w.style.setProperty("color","#721c24"),w.style.setProperty("border","1px solid #f5c6cb"),l(w,i),w})()})(),C),m(C,u),l(C,B(xt,{variant:"outline",type:"button",onClick:y,style:{color:"#dc3545","border-color":"#dc3545","margin-right":"auto"},get children(){return e("accounts.deleteAccount")}}),null),l(C,B(xt,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),l(C,B(xt,{variant:"primary",type:"submit",get children(){return e("common.save")}}),null),p}}):null};var O$=de("<div><div></div><div></div><div></div><div>"),B$=de("<div><div></div><div></div><div>"),j$=de("<div><button></button><button> (<!>)"),Kf=de("<div>"),V$=de("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),q$=de("<div><div><div></div><div>  </div></div><div>");const z$=t=>{const{t:e}=er(),[r,n]=$e("details"),[i,o]=$e(!1),s=Tt(()=>t.account?Er.getAccountById(t.account.id)||t.account:null),a={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},c={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},u={"font-weight":"600",color:"var(--text-primary)"},h={"text-align":"center","margin-bottom":"2rem"},y={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},g={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},p={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem"},C={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},S=T=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:T?"var(--primary-color)":"var(--text-muted)","border-bottom":T?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),w={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},x={flex:"1"},V={"font-size":"0.875rem",color:"var(--text-muted)"},ne={"font-weight":"500","margin-bottom":"0.25rem"},X=T=>({"font-weight":"600",color:T==="debit"?"#4caf50":"#f44336"}),Q={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},ee=T=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[T]||{bg:"#f5f5f5",color:"#666"},E=T=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(T),A=T=>new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return B(Xn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.accountDetails")},get children(){return[Te(()=>Te(()=>!s())()?(()=>{var T=O$(),R=T.firstChild,_=R.nextSibling,I=_.nextSibling,b=I.nextSibling;return T.style.setProperty("text-align","center"),T.style.setProperty("padding","3rem"),T.style.setProperty("color","var(--text-muted)"),R.style.setProperty("font-size","1.5rem"),R.style.setProperty("margin-bottom","1rem"),_.style.setProperty("font-size","1.1rem"),_.style.setProperty("margin-bottom","0.5rem"),l(_,()=>e("common.error")),I.style.setProperty("font-size","0.875rem"),l(I,()=>e("common.noDataFound")),b.style.setProperty("margin-top","2rem"),l(b,B(xt,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),T})():(()=>{const T=Tt(()=>ee(s().type)),R=Tt(()=>Er.getAccountTransactions(s().id));return[(()=>{var _=B$(),I=_.firstChild,b=I.nextSibling,G=b.nextSibling;return m(_,h),m(I,y),l(I,()=>s().name),m(b,g),l(b,()=>E(s().balance)),l(G,()=>e(`accounts.types.${s().type.toLowerCase()}`)),we(ie=>m(G,{...p,background:T().bg,color:T().color},ie)),_})(),(()=>{var _=j$(),I=_.firstChild,b=I.nextSibling,G=b.firstChild,ie=G.nextSibling;return ie.nextSibling,m(_,C),I.$$click=()=>n("details"),l(I,()=>e("accounts.accountDetails")),b.$$click=()=>n("transactions"),l(b,()=>e("accounts.transactions"),G),l(b,()=>R().length,ie),we(F=>{var W=S(r()==="details"),z=S(r()==="transactions");return F.e=m(I,W,F.e),F.t=m(b,z,F.t),F},{e:void 0,t:void 0}),_})(),Te(()=>Te(()=>r()==="details")()&&(()=>{var _=V$(),I=_.firstChild,b=I.firstChild,G=b.nextSibling,ie=I.nextSibling,F=ie.firstChild,W=F.nextSibling,z=ie.nextSibling,O=z.firstChild,k=O.nextSibling,re=z.nextSibling,$=re.firstChild,D=$.nextSibling,H=re.nextSibling,L=H.firstChild,j=L.nextSibling,oe=H.nextSibling,K=oe.firstChild,Z=K.nextSibling;return l(b,()=>e("accounts.accountNumber")),l(G,()=>s().accountNumber),l(F,()=>e("accounts.category")),l(W,()=>s().category),l(O,()=>e("common.description")),l(k,()=>s().description),l($,()=>e("common.status")),l(D,(()=>{var J=Te(()=>!!s().isActive);return()=>J()?e("common.active"):e("common.inactive")})()),l(L,()=>e("accounts.createdDate")),l(j,()=>A(s().createdDate)),l(K,()=>e("accounts.lastModified")),l(Z,()=>A(s().lastModified)),we(J=>{var Y=a,U=c,ae=u,ue=a,le=c,q=u,ce=a,Se=c,me=u,Pe=a,xe=c,he=u,ve=a,De=c,ke=u,Ce=a,Le=c,Ie=u;return J.e=m(I,Y,J.e),J.t=m(b,U,J.t),J.a=m(G,ae,J.a),J.o=m(ie,ue,J.o),J.i=m(F,le,J.i),J.n=m(W,q,J.n),J.s=m(z,ce,J.s),J.h=m(O,Se,J.h),J.r=m(k,me,J.r),J.d=m(re,Pe,J.d),J.l=m($,xe,J.l),J.u=m(D,he,J.u),J.c=m(H,ve,J.c),J.w=m(L,De,J.w),J.m=m(j,ke,J.m),J.f=m(oe,Ce,J.f),J.y=m(K,Le,J.y),J.g=m(Z,Ie,J.g),J},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),_})()),Te(()=>Te(()=>r()==="transactions")()&&(()=>{var _=Kf();return l(_,(()=>{var I=Te(()=>R().length===0);return()=>I()?(()=>{var b=Kf();return b.style.setProperty("text-align","center"),b.style.setProperty("color","var(--text-muted)"),b.style.setProperty("padding","2rem"),l(b,()=>e("common.noDataFound")),b})():R().map(b=>(()=>{var G=q$(),ie=G.firstChild,F=ie.firstChild,W=F.nextSibling,z=W.firstChild,O=ie.nextSibling;return m(G,w),m(ie,x),m(F,ne),l(F,()=>b.description),m(W,V),l(W,()=>A(b.date),z),l(W,()=>b.reference,null),l(O,()=>b.type==="debit"?"+":"-",null),l(O,()=>E(b.type==="debit"?b.debitAmount:b.creditAmount),null),we(k=>m(O,X(b.type),k)),G})())})()),_})()),(()=>{var _=Kf();return m(_,Q),l(_,B(xt,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),l(_,B(xt,{variant:"primary",onClick:()=>o(!0),get children(){return e("accounts.editAccount")}}),null),_})()]})()),Te(()=>Te(()=>!!s())()&&B(F$,{get isOpen(){return i()},onClose:()=>{o(!1)},get account(){return s()}}))]}})};dr(["click"]);const U$="https://qvamarkets.com/gql_api",[H$,n0]=$e(!1),[W$,Jf]=$e(null);class G${baseUrl;constructor(e=U$){this.baseUrl=e}async request(e,r,n,i){n0(!0),Jf(null);try{const o=r.startsWith("http")?r:`${this.baseUrl}${r}`,s={method:e,headers:{"Content-Type":"application/json",Accept:"application/json",...i}};n&&(e==="POST"||e==="PUT"||e==="PATCH")&&(s.body=JSON.stringify(n));const a=await fetch(o,s);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const c=await a.json();if(c.errors&&c.errors.length>0)throw new Error(c.errors[0].message);return c.data||c}catch(o){const s=o instanceof Error?o.message:"Unknown error occurred";throw Jf(s),o}finally{n0(!1)}}async graphql(e){return this.request("POST","",e)}async get(e,r){return this.request("GET",e,void 0,r)}async post(e,r,n){return this.request("POST",e,r,n)}async put(e,r,n){return this.request("PUT",e,r,n)}async patch(e,r,n){return this.request("PATCH",e,r,n)}async delete(e,r){return this.request("DELETE",e,void 0,r)}getLoadingState(){return H$()}getErrorState(){return W$()}clearError(){Jf(null)}}const Ld=new G$,Ty=`
  fragment AccountFields on Account {
    id
    accountNumber
    name
    type
    category
    description
    balance
    isActive
    parentAccountId
    createdDate
    lastModified
  }
`,Y$=`
  query GetAccountById($id: ID!) {
    account(id: $id) {
      ...AccountFields
    }
  }
  ${Ty}
`,K$=`
  mutation CreateAccount($input: CreateAccountInput!) {
    createAccount(input: $input) {
      ...AccountFields
    }
  }
  ${Ty}
`,J$=`
  mutation UpdateAccount($id: ID!, $input: UpdateAccountInput!) {
    updateAccount(id: $id, input: $input) {
      ...AccountFields
    }
  }
  ${Ty}
`,Q$=`
  mutation DeleteAccount($id: ID!) {
    deleteAccount(id: $id) {
      success
      message
    }
  }
`;class X${async getAccounts(e,r){try{if($u.isFakeMode())return await Sg.getAll(e);const n=await qi({query:"getAllYabaProducts",params:{businessId:"YB100423253156428"}});return console.log("Real API accounts response:",n),n?.accounts||[]}catch(n){if(console.error("Error fetching accounts:",n),$u.isHybridMode())return console.warn("Falling back to fake API for accounts"),await Sg.getAll(e);throw n}}async getAccountById(e){try{return(await Ld.graphql({query:Y$,variables:{id:e}})).account}catch(r){throw console.error("Error fetching account:",r),r}}async createAccount(e){try{return(await Ld.graphql({query:K$,variables:{input:e}})).createAccount}catch(r){throw console.error("Error creating account:",r),r}}async updateAccount(e,r){try{return(await Ld.graphql({query:J$,variables:{id:e,input:r}})).updateAccount}catch(n){throw console.error("Error updating account:",n),n}}async deleteAccount(e){try{return(await Ld.graphql({query:Q$,variables:{id:e}})).deleteAccount}catch(r){throw console.error("Error deleting account:",r),r}}async getAccountsByType(e){return this.getAccounts({type:e})}async getAccountHierarchy(){const e=await this.getAccounts();return this.buildHierarchy(e)}buildHierarchy(e){const r=new Map,n=[];return e.forEach(i=>{r.set(i.id,{...i,subAccounts:[]})}),e.forEach(i=>{const o=r.get(i.id);if(i.parentAccountId){const s=r.get(i.parentAccountId);s&&(s.subAccounts=s.subAccounts||[],s.subAccounts.push(o))}else n.push(o)}),n}async getAccountBalance(e){const r=await this.getAccountById(e);return r?r.balance:0}async searchAccounts(e){return this.getAccounts({search:e})}}const Z$=new X$;var eE=de("<div><h2></h2><div><span>:</span><button></button><button>"),tE=de("<div><span>:"),i0=de("<div>"),rE=de("<button>");const nE=()=>{const{t}=er(),[e,r]=$e(!1),[n,i]=$e(!1),[o,s]=$e(!1),[a,c]=$e(null),[u,h]=$e(null),[y,g]=$e("All"),[p,C]=$e("hierarchy"),S=A=>{c(A),s(!0)},w=A=>{h(A),i(!0)},x=()=>y()==="All"?p()==="hierarchy"?Er.getAccountHierarchy():Er.accounts:p()==="hierarchy"?Er.getAccountHierarchy().filter(A=>A.type===y()):Er.getAccountsByType(y()),V={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(350px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},ne={display:"flex",gap:"1rem","margin-bottom":"2rem","align-items":"center"},X=A=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:A?"var(--primary-color)":"var(--surface-color)",color:A?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500",transition:"all 0.2s ease"}),Q={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},ee={display:"flex",gap:"0.5rem","align-items":"center","margin-left":"auto","margin-right":"1rem"},E=A=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:A?"var(--primary-color)":"var(--surface-color)",color:A?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"});return B(ro,{get title(){return t("accounts.title")},get children(){return[B(_$,{}),(()=>{var A=eE(),T=A.firstChild,R=T.nextSibling,_=R.firstChild,I=_.firstChild,b=_.nextSibling,G=b.nextSibling;return m(A,Q),T.style.setProperty("margin","0"),T.style.setProperty("font-size","1.5rem"),l(T,()=>t("accounts.title")),m(R,ee),_.style.setProperty("font-weight","500"),_.style.setProperty("color","var(--text-muted)"),_.style.setProperty("font-size","0.875rem"),l(_,()=>t("common.view"),I),b.$$click=()=>C("hierarchy"),l(b,()=>t("accounts.accountHierarchy")),G.$$click=()=>{C("flat"),Z$.getAccounts()},l(G,()=>t("common.all")),l(A,B(xt,{variant:"primary",onClick:()=>r(!0),get children(){return t("accounts.addAccount")}}),null),we(ie=>{var F=E(p()==="hierarchy"),W=E(p()==="flat");return ie.e=m(b,F,ie.e),ie.t=m(G,W,ie.t),ie},{e:void 0,t:void 0}),A})(),(()=>{var A=tE(),T=A.firstChild,R=T.firstChild;return m(A,ne),T.style.setProperty("font-weight","500"),T.style.setProperty("color","var(--text-muted)"),l(T,()=>t("common.filter"),R),l(A,()=>[t("common.all"),t("accounts.types.asset"),t("accounts.types.liability"),t("accounts.types.equity"),t("accounts.types.revenue"),t("accounts.types.expense")].map((_,I)=>{const G=["All","Asset","Liability","Equity","Revenue","Expense"][I];return(()=>{var ie=rE();return ie.$$click=()=>g(G),l(ie,_),we(F=>m(ie,X(y()===G),F)),ie})()}),null),A})(),(()=>{var A=i0();return l(A,(()=>{var T=Te(()=>p()==="hierarchy");return()=>T()?x().map(R=>B(E$,{account:R,onAddSubAccount:w,onViewDetails:S})):x().map(R=>B(P$,{account:R,onViewDetails:S}))})()),we(T=>m(A,p()==="hierarchy"?{display:"flex","flex-direction":"column",gap:"1rem"}:V,T)),A})(),Te(()=>Te(()=>x().length===0)()&&(()=>{var A=i0();return A.style.setProperty("text-align","center"),A.style.setProperty("color","var(--text-muted)"),A.style.setProperty("padding","3rem"),A.style.setProperty("font-size","1.1rem"),l(A,()=>t("common.noDataFound")),A})()),B(T$,{get isOpen(){return e()},onClose:()=>r(!1)}),B(D$,{get isOpen(){return n()},onClose:()=>i(!1),get parentAccount(){return u()}}),B(z$,{get isOpen(){return o()},onClose:()=>s(!1),get account(){return a()}})]}})};dr(["click"]);var iE=de("<div><h2>"),Jl=de("<div>"),oE=de("<div><div><div></div><h1></h1><div></div></div><div>"),sE=de("<div><button></button><button> (<!>)"),Dd=de("<div><span></span><span>"),aE=de("<p>"),lE=de("<div><div></div><div>"),cE=de("<div><div><div></div><div>  </div></div><div>");const uE=()=>{const{t}=er(),e=Bw(),r=Nm(),[n,i]=$e(null),[o,s]=$e("overview");Rn(()=>{const b=Er.getAccountById(e.id);b?i(b):r("/accounts")});const a={display:"flex","align-items":"center",gap:"0.5rem","margin-bottom":"1rem"},c={display:"flex","align-items":"center",gap:"1rem","margin-bottom":"2rem"},u={"font-size":"1rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},h={"font-size":"2.5rem","font-weight":"700",color:"var(--primary-color)"},y={padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},g={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},p=b=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:b?"var(--primary-color)":"var(--text-muted)","border-bottom":b?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),C={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},S={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},w={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},x={"font-weight":"500",color:"var(--text-muted)"},V={"font-weight":"600",color:"var(--text-primary)"},ne={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},X={flex:"1"},Q={"font-weight":"500","margin-bottom":"0.25rem"},ee={"font-size":"0.875rem",color:"var(--text-muted)"},E=b=>({"font-weight":"600",color:b==="debit"?"#4caf50":"#f44336"});if(!n())return B(ro,{get title(){return t("accounts.accountDetails")},get children(){var b=iE(),G=b.firstChild;return b.style.setProperty("text-align","center"),b.style.setProperty("padding","3rem"),l(G,()=>t("common.error")),l(b,B(xt,{variant:"primary",onClick:()=>r("/accounts"),get children(){return[Te(()=>t("common.back"))," ",Te(()=>t("navigation.accounts"))]}}),null),b}});const A=b=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[b]||{bg:"#f5f5f5",color:"#666"},T=b=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(b),R=b=>new Date(b).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),_=A(n().type),I=Er.getAccountTransactions(n().id);return B(ro,{get title(){return n().name},get children(){return[(()=>{var b=Jl();return m(b,a),l(b,B(xt,{variant:"secondary",onClick:()=>r("/accounts"),get children(){return[" ",Te(()=>t("common.back"))," ",Te(()=>t("navigation.accounts"))]}})),b})(),(()=>{var b=oE(),G=b.firstChild,ie=G.firstChild,F=ie.nextSibling,W=F.nextSibling,z=G.nextSibling;return m(b,c),m(ie,u),l(ie,()=>n().accountNumber),F.style.setProperty("margin","0.5rem 0"),F.style.setProperty("font-size","2rem"),l(F,()=>n().name),m(W,h),l(W,()=>T(n().balance)),l(z,()=>n().type),we(O=>m(z,{...y,background:_.bg,color:_.color},O)),b})(),(()=>{var b=sE(),G=b.firstChild,ie=G.nextSibling,F=ie.firstChild,W=F.nextSibling;return W.nextSibling,m(b,g),G.$$click=()=>s("overview"),l(G,()=>t("dashboard.overview")),ie.$$click=()=>s("transactions"),l(ie,()=>t("accounts.transactions"),F),l(ie,()=>I.length,W),we(z=>{var O=p(o()==="overview"),k=p(o()==="transactions");return z.e=m(G,O,z.e),z.t=m(ie,k,z.t),z},{e:void 0,t:void 0}),b})(),Te(()=>Te(()=>o()==="overview")()&&(()=>{var b=lE(),G=b.firstChild,ie=G.nextSibling;return m(G,C),l(G,B(Nt,{get title(){return t("accounts.balance")},get subtitle(){return t("dashboard.overview")},get children(){var F=Jl();return F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("color","var(--primary-color)"),l(F,()=>T(n().balance)),F}}),null),l(G,B(Nt,{get title(){return t("accounts.accountType")},get subtitle(){return t("accounts.category")},get children(){var F=Jl();return F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("color","var(--primary-color)"),l(F,()=>t(`accounts.types.${n().type.toLowerCase()}`)),F}}),null),l(G,B(Nt,{get title(){return t("common.status")},get subtitle(){return t("accounts.accountDetails")},get children(){var F=Jl();return F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","600"),l(F,(()=>{var W=Te(()=>!!n().isActive);return()=>W()?t("common.active"):t("common.inactive")})()),we(W=>(W=n().isActive?"#4caf50":"#f44336")!=null?F.style.setProperty("color",W):F.style.removeProperty("color")),F}}),null),l(G,B(Nt,{get title(){return t("accounts.transactions")},get subtitle(){return t("common.total")},get children(){var F=Jl();return F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("color","var(--primary-color)"),l(F,()=>I.length),F}}),null),m(ie,S),l(ie,B(Nt,{get title(){return t("accounts.accountDetails")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var F=Dd(),W=F.firstChild,z=W.nextSibling;return l(W,()=>t("accounts.accountNumber")),l(z,()=>n().accountNumber),we(O=>{var k=w,re=x,$=V;return O.e=m(F,k,O.e),O.t=m(W,re,O.t),O.a=m(z,$,O.a),O},{e:void 0,t:void 0,a:void 0}),F})(),(()=>{var F=Dd(),W=F.firstChild,z=W.nextSibling;return l(W,()=>t("accounts.category")),l(z,()=>n().category),we(O=>{var k=w,re=x,$=V;return O.e=m(F,k,O.e),O.t=m(W,re,O.t),O.a=m(z,$,O.a),O},{e:void 0,t:void 0,a:void 0}),F})(),(()=>{var F=Dd(),W=F.firstChild,z=W.nextSibling;return l(W,()=>t("common.date")),l(z,()=>R(n().createdDate)),we(O=>{var k=w,re=x,$=V;return O.e=m(F,k,O.e),O.t=m(W,re,O.t),O.a=m(z,$,O.a),O},{e:void 0,t:void 0,a:void 0}),F})(),(()=>{var F=Dd(),W=F.firstChild,z=W.nextSibling;return l(W,()=>t("common.date")),l(z,()=>R(n().lastModified)),we(O=>{var k=w,re=x,$=V;return O.e=m(F,k,O.e),O.t=m(W,re,O.t),O.a=m(z,$,O.a),O},{e:void 0,t:void 0,a:void 0}),F})()]}}),null),l(ie,B(Nt,{get title(){return t("common.description")},get subtitle(){return t("accounts.accountDetails")},get children(){var F=aE();return F.style.setProperty("margin","0"),F.style.setProperty("color","var(--text-secondary)"),l(F,()=>n().description||t("common.noDataFound")),F}}),null),b})()),Te(()=>Te(()=>o()==="transactions")()&&B(Nt,{get title(){return t("accounts.accountHistory")},get subtitle(){return t("accounts.transactions")},get children(){return Te(()=>I.length===0)()?(()=>{var b=Jl();return b.style.setProperty("text-align","center"),b.style.setProperty("color","var(--text-muted)"),b.style.setProperty("padding","2rem"),l(b,()=>t("common.noDataFound")),b})():I.map(b=>(()=>{var G=cE(),ie=G.firstChild,F=ie.firstChild,W=F.nextSibling,z=W.firstChild,O=ie.nextSibling;return m(G,ne),m(ie,X),m(F,Q),l(F,()=>b.description),m(W,ee),l(W,()=>R(b.date),z),l(W,()=>b.reference,null),l(O,()=>b.type==="debit"?"+":"-",null),l(O,()=>T(b.type==="debit"?b.debitAmount:b.creditAmount),null),we(k=>m(O,E(b.type),k)),G})())}}))]}})};dr(["click"]);var dE=de("<div><div><h1></h1><p> </p></div><div><input type=date>"),ws=de("<div><span></span><span>"),hE=de("<div><div></div><div>"),fE=de("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),pE=de("<div><div> (<!> = <!> + <!>)</div><div> = "),mE=de("<span>(<!>: <!>)");const yE=()=>{const{t}=er(),[e,r]=$e(new Date().toISOString().split("T")[0]),[n,i]=$e(0),[o,s]=$e(0),[a,c]=$e(0);Rn(()=>{u()});const u=()=>{const C=Er.getAccountsByType("Asset"),S=Er.getAccountsByType("Liability"),w=Er.getAccountsByType("Equity"),x=C.reduce((X,Q)=>X+Q.balance,0),V=S.reduce((X,Q)=>X+Q.balance,0),ne=w.reduce((X,Q)=>X+Q.balance,0);i(x),s(V),c(ne)},h=C=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(C),y={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},g={"margin-bottom":"2rem"},p={"font-weight":"bold","font-size":"1.1rem","border-top":"2px solid var(--border-color)","padding-top":"0.5rem","margin-top":"1rem"};return B(ro,{get title(){return t("balanceSheet.title")},get children(){return[(()=>{var C=dE(),S=C.firstChild,w=S.firstChild,x=w.nextSibling,V=x.firstChild,ne=S.nextSibling,X=ne.firstChild;return m(C,y),w.style.setProperty("margin","0"),l(w,()=>t("balanceSheet.title")),x.style.setProperty("margin","0.5rem 0 0 0"),x.style.setProperty("color","var(--text-muted)"),l(x,()=>t("balanceSheet.asOf"),V),l(x,()=>new Date(e()).toLocaleDateString(),null),ne.style.setProperty("display","flex"),ne.style.setProperty("gap","1rem"),X.addEventListener("change",Q=>r(Q.target.value)),X.style.setProperty("padding","0.5rem"),X.style.setProperty("border","1px solid var(--border-color)"),X.style.setProperty("border-radius","var(--border-radius-sm)"),l(ne,B(xt,{variant:"primary",onClick:u,get children(){return t("balanceSheet.generateReport")}}),null),we(()=>X.value=e()),C})(),(()=>{var C=hE(),S=C.firstChild,w=S.nextSibling;return C.style.setProperty("display","grid"),C.style.setProperty("grid-template-columns","1fr 1fr"),C.style.setProperty("gap","2rem"),l(S,B(Nt,{get title(){return t("balanceSheet.assets")},style:g,get children(){return[(()=>{var x=ws(),V=x.firstChild,ne=V.nextSibling;return x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),l(V,()=>t("balanceSheet.currentAssets")),l(ne,()=>h(n()*.6)),x})(),(()=>{var x=ws(),V=x.firstChild,ne=V.nextSibling;return x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),l(V,()=>t("balanceSheet.nonCurrentAssets")),l(ne,()=>h(n()*.4)),x})(),(()=>{var x=ws(),V=x.firstChild,ne=V.nextSibling;return l(V,()=>t("balanceSheet.totalAssets")),l(ne,()=>h(n())),we(X=>m(x,{...p,display:"flex","justify-content":"space-between"},X)),x})()]}})),l(w,B(Nt,{get title(){return t("balanceSheet.liabilities")},style:g,get children(){return[(()=>{var x=ws(),V=x.firstChild,ne=V.nextSibling;return x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),l(V,()=>t("balanceSheet.currentLiabilities")),l(ne,()=>h(o()*.7)),x})(),(()=>{var x=ws(),V=x.firstChild,ne=V.nextSibling;return x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),l(V,()=>t("balanceSheet.nonCurrentLiabilities")),l(ne,()=>h(o()*.3)),x})(),(()=>{var x=ws(),V=x.firstChild,ne=V.nextSibling;return l(V,()=>t("balanceSheet.totalLiabilities")),l(ne,()=>h(o())),we(X=>m(x,{...p,display:"flex","justify-content":"space-between"},X)),x})()]}}),null),l(w,B(Nt,{get title(){return t("balanceSheet.equity")},get children(){return[(()=>{var x=ws(),V=x.firstChild,ne=V.nextSibling;return x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),l(V,()=>t("balanceSheet.commonStock")),l(ne,()=>h(a()*.8)),x})(),(()=>{var x=ws(),V=x.firstChild,ne=V.nextSibling;return x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),l(V,()=>t("balanceSheet.retainedEarnings")),l(ne,()=>h(a()*.2)),x})(),(()=>{var x=ws(),V=x.firstChild,ne=V.nextSibling;return l(V,()=>t("balanceSheet.totalEquity")),l(ne,()=>h(a())),we(X=>m(x,{...p,display:"flex","justify-content":"space-between"},X)),x})()]}}),null),C})(),B(Nt,{get title(){return t("dashboard.overview")},style:{"margin-top":"2rem"},get children(){return[(()=>{var C=fE(),S=C.firstChild,w=S.firstChild,x=w.nextSibling,V=S.nextSibling,ne=V.firstChild,X=ne.nextSibling,Q=V.nextSibling,ee=Q.firstChild,E=ee.nextSibling;return C.style.setProperty("display","grid"),C.style.setProperty("grid-template-columns","repeat(3, 1fr)"),C.style.setProperty("gap","2rem"),S.style.setProperty("text-align","center"),w.style.setProperty("font-size","0.875rem"),w.style.setProperty("color","var(--text-muted)"),w.style.setProperty("margin-bottom","0.5rem"),l(w,()=>t("balanceSheet.totalAssets")),x.style.setProperty("font-size","1.5rem"),x.style.setProperty("font-weight","bold"),x.style.setProperty("color","var(--primary-color)"),l(x,()=>h(n())),V.style.setProperty("text-align","center"),ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("color","var(--text-muted)"),ne.style.setProperty("margin-bottom","0.5rem"),l(ne,()=>t("balanceSheet.totalLiabilities")),X.style.setProperty("font-size","1.5rem"),X.style.setProperty("font-weight","bold"),X.style.setProperty("color","#f44336"),l(X,()=>h(o())),Q.style.setProperty("text-align","center"),ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-muted)"),ee.style.setProperty("margin-bottom","0.5rem"),l(ee,()=>t("balanceSheet.totalEquity")),E.style.setProperty("font-size","1.5rem"),E.style.setProperty("font-weight","bold"),E.style.setProperty("color","#4caf50"),l(E,()=>h(a())),C})(),(()=>{var C=pE(),S=C.firstChild,w=S.firstChild,x=w.nextSibling,V=x.nextSibling,ne=V.nextSibling,X=ne.nextSibling,Q=X.nextSibling;Q.nextSibling;var ee=S.nextSibling,E=ee.firstChild;return C.style.setProperty("margin-top","2rem"),C.style.setProperty("text-align","center"),S.style.setProperty("font-size","0.875rem"),S.style.setProperty("color","var(--text-muted)"),S.style.setProperty("margin-bottom","0.5rem"),l(S,()=>t("common.total"),w),l(S,()=>t("balanceSheet.totalAssets"),x),l(S,()=>t("balanceSheet.totalLiabilities"),ne),l(S,()=>t("balanceSheet.totalEquity"),Q),ee.style.setProperty("font-size","1.2rem"),ee.style.setProperty("font-weight","bold"),l(ee,()=>h(n()),E),l(ee,()=>h(o()+a()),null),l(ee,(()=>{var A=Te(()=>Math.abs(n()-(o()+a()))>.01);return()=>A()&&(()=>{var T=mE(),R=T.firstChild,_=R.nextSibling,I=_.nextSibling,b=I.nextSibling;return b.nextSibling,T.style.setProperty("font-size","0.875rem"),T.style.setProperty("color","#f44336"),T.style.setProperty("display","block"),l(T,()=>t("common.error"),_),l(T,()=>h(n()-(o()+a())),b),T})()})(),null),we(A=>(A=Math.abs(n()-(o()+a()))<.01?"#4caf50":"#f44336")!=null?ee.style.setProperty("color",A):ee.style.removeProperty("color")),C})()]}})]}})};dr(["click"]);const gE="modulepreload",vE=function(t){return"/"+t},o0={},Ni=function(e,r,n){let i=Promise.resolve();if(r&&r.length>0){let s=function(u){return Promise.all(u.map(h=>Promise.resolve(h).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),c=a?.nonce||a?.getAttribute("nonce");i=s(r.map(u=>{if(u=vE(u),u in o0)return;o0[u]=!0;const h=u.endsWith(".css"),y=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${y}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":gE,h||(g.as="script"),g.crossOrigin="",g.href=u,c&&g.setAttribute("nonce",c),document.head.appendChild(g),h)return new Promise((p,C)=>{g.addEventListener("load",p),g.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${u}`)))})}))}function o(s){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s}return i.then(s=>{for(const a of s||[])a.status==="rejected"&&o(a.reason);return e().catch(o)})},bE=[{id:"YY_8802",code:"YY_8802",name:"CENTER",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8803",code:"YY_8803",name:"BISSONNET",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8804",code:"YY_8804",name:"IRVIN",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8805",code:"YY_8805",name:"KATTY",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8816",code:"YY_8816",type:"store",name:"YABA GLOBAL",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8818",code:"YY_8818",type:"store",name:"YABASURAUSTIN",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8847",code:"YY_8847",type:"store",name:"YABAOFICINA AZ",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_3251",code:"YY_3251",type:"store",name:"YABA FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_32",code:"YY_32",type:"store",name:"YABA MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_76",code:"YY_76",type:"store",name:"YABA DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_79",code:"YY_79",type:"warehouse",name:"ALMACEN DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8635",code:"YY_8635",type:"store",name:"FASHION MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8665",code:"YY_8665",name:"IRVIN FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,type:"store",createdDate:"2024-01-01"},{id:"YY_8901",code:"YY_8901",name:"ALMACEN CENTRAL YABA",bussinesId:"YB100423253156428",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01"}],_E=[{id:"1",name:'MacBook Pro 16"',price:2399,quantity:75,category:"Electronics",description:"Apple MacBook Pro 16-inch with M2 Pro chip",sku:"MBP-16-M2P",supplier:"Apple Inc.",minStock:10,location:"Warehouse A",lastUpdated:"2024-01-15"},{id:"2",name:'Dell Monitor 27"',price:299,quantity:35,category:"Electronics",description:"Dell 27-inch 4K UHD Monitor",sku:"DELL-MON-27-4K",supplier:"Dell Technologies",minStock:15,location:"Warehouse B",lastUpdated:"2024-01-14"},{id:"3",name:"Wireless Mouse",price:49.99,quantity:12,category:"Accessories",description:"Ergonomic wireless mouse with precision tracking",sku:"MOUSE-WL-001",supplier:"Logitech",minStock:25,location:"Warehouse A",lastUpdated:"2024-01-13"}],Rd=()=>{const t=new Map;return ji().forEach(e=>{const r=`${e.productId}-${e.locationId}`;let n=lt.getLocationById(e.locationId),i=t.get(r);i||(i={id:r,productId:e.productId,locationId:e.locationId,locationName:n?.name,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,i)),e.movementType==="in"||e.movementType==="transfer"?(e.locationId===e.toLocationId||e.movementType==="in")&&(i.quantity+=e.quantity*1):e.movementType==="out"?i.quantity-=e.quantity*1:e.movementType==="adjustment"&&(i.quantity=e.quantity*1),new Date(e.createdDate)>new Date(i.lastMovementDate)&&(i.lastMovementDate=e.createdDate,i.lastMovementType=e.movementType),i.averageCost=e.unitCost*1,i.availableQuantity=i.quantity*1-i.reservedQuantity*1}),Array.from(t.values())},[rl,Qf]=$e([]),[nl,s0]=$e(bE),[ji,Md]=$e([]),[da,Yc]=$e([]),[Fd,Xf]=$e(_E),wE={TRANSFER:1,transfer:1},a0=173442384e4,lt={get products(){return rl()},get locations(){return nl()},get movements(){return ji()},get stockLevels(){return da()},parseInventoryData:t=>{const e=Object.keys(t).slice(0,900),r=[],n=i=>{let o=t;o[i]?.products&&o[i]?.products?.map(s=>{let a=cS(o[i]?.type),c=s?.price*1||s?.unitCost*1,u=s?.qty*1||s?.quantity*1;c=isNaN(c)?0:c,u=isNaN(u)?0:u;let h={id:o[i]?.ssg_inventory_key,productId:s?.product?.id,productName:s?.product?.label,productSku:s?.product?.code,locationId:o[i]?.store,locationName:o[i]?.store,location:o[i]?.store,movementType:a,quantity:u,unitCost:c,totalCost:c*1*u,minStock:10,referenceNumber:"PO-001",notes:o[i]?.description||o[i]?.notes,createdBy:"admin",createdDate:o[i]?.createDate?new Date(o[i]?.createDate).toISOString():new Date(a0).toISOString(),invoiceId:o[i]?.invoice};if(r.push(h),wE[o[i].movementType]&&o[i]?.fromLocationId){let y=lt.getLocationById(o[i]?.fromLocationId);const g={id:o[i]?.ssg_inventory_key,productId:s?.product?.id,productName:s?.product?.label,productSku:s?.product?.code,locationId:o[i]?.fromLocationId,locationName:y?.name||"",movementType:"out",quantity:u*-1,unitCost:c,totalCost:c*-1*u,minStock:10,referenceNumber:o[i]?.referenceNumber,notes:`Transfer to ${o[i]?.locationName}`+(o[i].notes?` - ${o[i].notes}`:""),createdBy:o[i].createdBy,createdDate:o[i]?.createDate?new Date(o[i]?.createDate).toISOString():new Date(a0).toISOString(),invoiceId:o[i]?.invoiceId,toLocationId:o[i]?.locationId,toLocationName:o[i]?.locationName};r.push(g)}})};return e.map(n),r},fecthInventory:async t=>{const e=await Ai.getInventory(t),r=lt.parseInventoryData(e);lt.updMovements(r)},getStockLevels:async t=>{const e=await Rm.getStockLevels(t);Yc(e)},fecthProduct:async t=>{const e=await Ai.getProducts(t),r=Object.keys(e),n=o=>{let s=e;return{id:o,name:s[o].name,businessId:s[o].businessId,sku:s[o].code,UPC:s[o].UPC,numCode:s[o].codeN,category:s[o].category,unitCost:s[o].unitCost||0,unitOfMeasure:s[o].unitOfMeasure||s[o].unit,minStockLevel:s[o].minStockLevel,maxStockLevel:s[o].maxStockLevel,isActive:s[o].isActive,productImageUrl:s[o].productImageUrl,description:s[o].description||"",createdDate:s[o].createdAt||new Date().toISOString(),lastModified:s[o].updatedAt||new Date().toISOString()}},i=r.map(n);return lt.updProduct(i),i},getProductById:t=>rl().find(e=>e.id===t),updProduct:t=>{Qf(t)},getProductsBySku:t=>rl().filter(e=>e.sku.toLowerCase().includes(t.toLowerCase())),getProductsByCategory:t=>rl().filter(e=>e.category===t),getActiveProducts:()=>rl().filter(t=>t.name),getLocationById:t=>nl().find(e=>e.id===t),getLocationsByType:t=>nl().filter(e=>e.type===t),getActiveLocations:()=>{let t=Ar?.state?.profile?.stores;return nl().filter(e=>t?.[e?.id])},getMovementsByProduct:t=>ji().filter(e=>e.productId===t),updMovements:t=>{Md([...t]),Yc(Rd())},getMovementsByLocation:t=>ji()?.filter(e=>e.locationId===t),getMovementsByDateRange:(t,e)=>ji()?.filter(r=>r.createdDate>=t&&r.createdDate<=e),getStockByProduct:t=>da()?.filter(e=>e.productId===t),getStockByLocation:t=>da()?.filter(e=>e.locationId===t),getStockByProductAndLocation:(t,e)=>da()?.find(r=>r.productId===t&&r.locationId===e),getTotalStockByProduct:t=>da()?.filter(e=>e.productId===t).reduce((e,r)=>e*1+r.quantity*1,0),getLastLocationByProduct:t=>{const e=ji()?.filter(r=>r.productId===t).sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime());if(e.length>0)return nl().find(r=>r.id===e[0].locationId)},getLowStockProducts:()=>(rl()||[])?.map(t=>{const e=da()?.filter(r=>r.productId===t.id).reduce((r,n)=>r+n.quantity,0)||0;return{...t,currentStock:e}}).filter(t=>t.currentStock<=t.minStockLevel),generateMovementInvoice:async(t,e,r,n="compact")=>{try{const{getUserLanguage:i}=await Ni(async()=>{const{getUserLanguage:h}=await import("./languageUtils-BVmHbHaj.js");return{getUserLanguage:h}},[]),o=r||i();let s;switch(n){case"compact":const{generateCompactModernInvoicePDF:h}=await Ni(async()=>{const{generateCompactModernInvoicePDF:p}=await import("./compactModernInvoicePdfGenerator-CmItV-KG.js");return{generateCompactModernInvoicePDF:p}},[]);s=h;break;case"modern":const{generateModernMovementInvoicePDF:y}=await Ni(async()=>{const{generateModernMovementInvoicePDF:p}=await import("./modernMovementInvoicePdfGenerator-BM3PDOyO.js");return{generateModernMovementInvoicePDF:p}},[]);s=y;break;case"classic":default:const{generateMovementInvoicePDF:g}=await Ni(async()=>{const{generateMovementInvoicePDF:p}=await import("./movementInvoicePdfGenerator-h0E0XewQ.js");return{generateMovementInvoicePDF:p}},[]);s=g;break}const a=ji().filter(h=>h.invoiceId===t||h.id===t);if(a.length===0)throw new Error(`No movements found with ID: ${t}`);const c=a.reduce((h,y)=>{const g=y.invoiceId||y.id;return h[g]||(h[g]={invoiceId:g,movementType:y.movementType,referenceNumber:y.referenceNumber,createdBy:y.createdBy,createdDate:y.createdDate,locationName:y.locationName,fromLocationName:y.fromLocationName,toLocationName:y.toLocationName,notes:y.notes,items:[]}),h[g].items.push({productSku:y.productSku,productName:y.productName,quantity:y.quantity,unitCost:y.unitCost,totalCost:y.totalCost,receivedQuantity:y.movementType==="transfer"?null:void 0}),h},{}),u=[];for(const[h,y]of Object.entries(c)){const g=await s(y,e,o);u.push(g)}return u}catch(i){throw console.error("Error generating movement invoice:",i),i}},getMovementsByInvoiceId:t=>ji().filter(e=>e.invoiceId===t),generateCompactMovementInvoice:async(t,e,r)=>lt.generateMovementInvoice(t,e,r,"compact"),generateModernMovementInvoice:async(t,e,r)=>lt.generateMovementInvoice(t,e,r,"modern"),generateClassicMovementInvoice:async(t,e,r)=>lt.generateMovementInvoice(t,e,r,"classic"),getMovementInvoiceData:t=>{const e=ji().filter(i=>i.invoiceId===t||i.id===t);if(e.length===0)return null;const r=e[0],n=e.reduce((i,o)=>i+(o.totalCost||o.quantity*o.unitCost),0);return{invoiceId:r.invoiceId||r.id,movementType:r.movementType,referenceNumber:r.referenceNumber,createdBy:r.createdBy,createdDate:r.createdDate,locationName:r.locationName,fromLocationName:r.fromLocationName,toLocationName:r.toLocationName,notes:r.notes,totalValue:n,itemCount:e.length,items:e.map(i=>({productSku:i.productSku,productName:i.productName,quantity:i.quantity,unitCost:i.unitCost,totalCost:i.totalCost||i.quantity*i.unitCost}))}},addInventoryMovement:t=>{const e={...t,id:`mov-${Date.now()}`,createdDate:new Date().toISOString()};Md(r=>[...r,e]),Yc(Rd())},addBulkInventoryMovements:async t=>{const e=[],r=[],n=new Date().toISOString(),i=nl().find(a=>a.id===t.locationId);if(!i)return{success:!1,errors:["Invalid location"]};let o;if(t.movementType==="transfer"){if(!t.fromLocationId)return{success:!1,errors:["From location required for transfers"]};if(o=nl().find(a=>a.id===t.fromLocationId),!o)return{success:!1,errors:["Invalid from location"]};if(t.fromLocationId===t.locationId)return{success:!1,errors:["From and to locations cannot be the same"]}}if(t.items.forEach((a,c)=>{const u=rl().find(p=>p.id===a.productId);if(!u){e.push(`Item ${c+1}: Product not found`);return}if(a.quantity<=0){e.push(`Item ${c+1}: Quantity must be greater than 0`);return}if(t.movementType==="out"){const p=da().filter(C=>C.productId===a.productId&&C.locationId===t.locationId).reduce((C,S)=>C+S.quantity,0);if(a.quantity>p){e.push(`Item ${c+1}: Insufficient stock. Available: ${p}, Requested: ${a.quantity}`);return}}if(t.movementType==="transfer"){const p=da().filter(C=>C.productId===a.productId&&C.locationId===t.fromLocationId).reduce((C,S)=>C+S.quantity,0);if(a.quantity>p){e.push(`Item ${c+1}: Insufficient stock at ${o?.name}. Available: ${p}, Requested: ${a.quantity}`);return}}const h=a.unitCost||u.unitCost,y=a.quantity*h,g={id:`mov-${Date.now()}-${c}`,productId:u.id,productName:u.name,productSku:u.sku,locationId:t.locationId,locationName:i.name,movementType:t.movementType,quantity:a.quantity,unitCost:h,totalCost:y,minStock:10,referenceNumber:t.referenceNumber||"",notes:a.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:o?.name};if(r.push(g),t.movementType==="transfer"&&o){const p={id:`mov-${Date.now()}-${c}-out`,productId:u.id,productName:u.name,productSku:u.sku,locationId:t.fromLocationId,locationName:o.name,movementType:"out",quantity:a.quantity,unitCost:h,totalCost:y,minStock:10,referenceNumber:t.referenceNumber||"",notes:`Transfer to ${i.name}`+(a.notes?` - ${a.notes}`:""),createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,toLocationId:t.locationId,toLocationName:i.name};r.push(p)}}),e.length>0)return{success:!1,errors:e};Md(a=>[...a,...r]),Yc(Rd()),console.log({bulkRequest:t});const s=await Ai.addInventory(t);return console.log({prodResults:s}),{success:!0,errors:[]}},getMovementsByInvoice:t=>ji().filter(e=>e.invoiceId===t),getInvoiceSummary:t=>{const e=ji().filter(o=>o.invoiceId===t);if(e.length===0)return null;const r=e.reduce((o,s)=>o+s.totalCost,0),n=new Set(e.map(o=>o.productId)).size,i=e[0];return{invoiceId:t,referenceNumber:i.referenceNumber,movementType:i.movementType,location:i.locationName,fromLocation:i.fromLocationName,productCount:n,totalItems:e.reduce((o,s)=>o+s.quantity,0),totalValue:r,createdDate:i.createdDate,createdBy:i.createdBy}},addProduct:t=>{const e={...t,id:`prod-${Date.now()}`,createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};Qf(r=>[...r,e])},addLocation:t=>{const e={...t,id:`loc-${Date.now()}`,createdDate:new Date().toISOString()};s0(r=>[...r,e])},updateProduct:(t,e)=>{Qf(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n))},updateLocation:(t,e)=>{s0(r=>r.map(n=>n.id===t?{...n,...e}:n))},updateMovement:(t,e)=>{Md(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n)),Yc(Rd())},get inventory(){return Fd()},addItem(t){const e={...t,id:Date.now().toString(),lastUpdated:new Date().toISOString().split("T")[0]};return Xf([...Fd(),e]),e},updateItem(t,e){Xf(Fd().map(r=>r.id===t?{...r,...e,lastUpdated:new Date().toISOString().split("T")[0]}:r))},deleteItem(t){Xf(Fd().filter(e=>e.id!==t))},getItemById(t){return ji().find(e=>e.id===t)},getLowStockItems(){return ji().filter(t=>t.quantity*1<=t.minStock*1)},getTotalValue(){return ji().reduce((t,e)=>t*1+e.unitCost*1*e.quantity*1,0)}};var l0=de("<div>"),SE=de("<div><div><input type=text autocomplete=off>"),PE=de("<button type=button>+"),xE=de("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div>");const cf=t=>{const{t:e}=er(),[r,n]=$e(!1),[i,o]=$e(""),[s,a]=$e(-1),c=Tt(()=>t.value?lt.getProductById(t.value):null),u=Tt(()=>{const ie=i().toLowerCase();return ie?lt.getActiveProducts().filter(F=>F.name.toLowerCase().includes(ie)||F.sku.toLowerCase().includes(ie)||F?.UPC?.toLowerCase().includes(ie)||F.category.toLowerCase().includes(ie)):lt.getActiveProducts()}),h=()=>{n(!0),o(""),a(-1)},y=ie=>{const F=ie.target;o(F.value),n(!0),a(-1)},g=ie=>{t.onChange(ie),n(!1),o(""),a(-1)},p=ie=>{const F=u();switch(ie.key){case"ArrowDown":ie.preventDefault(),a(W=>Math.min(W+1,F.length-1));break;case"ArrowUp":ie.preventDefault(),a(W=>Math.max(W-1,-1));break;case"Enter":ie.preventDefault(),s()>=0&&F[s()]&&g(F[s()]);break;case"Escape":n(!1),o(""),a(-1);break}},C=ie=>{setTimeout(()=>{n(!1),o(""),a(-1)},150)},S=ie=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ie),w=ie=>lt.stockLevels.filter(F=>F.productId===ie).reduce((F,W)=>F+W.quantity,0),x={position:"relative",width:"100%",...t.style},V={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},ne={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},X=ie=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid "+ie?"var(--primary-color)":"var(--border-color)",background:ie?"var(--strip-color)":"transparent",color:ie?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),Q={display:"flex","justify-content":"space-between","align-items":"center"},ee={flex:"1"},E={"font-weight":"500","margin-bottom":"0.25rem"},A={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},T={"text-align":"right","font-size":"0.875rem"},R={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},_=()=>r()&&i()?i():c()?`${c().name} (${c().sku})`:"",I={display:"flex","align-items":"stretch",width:"100%"},b={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},G={...V,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"};return(()=>{var ie=SE(),F=ie.firstChild,W=F.firstChild;return m(F,I),W.addEventListener("blur",C),W.$$keydown=p,W.$$click=h,W.$$input=y,l(F,(()=>{var z=Te(()=>!!t.onAddNew);return()=>z()&&(()=>{var O=PE();return O.addEventListener("mouseleave",k=>{k.currentTarget.style.background="var(--surface-color)",k.currentTarget.style.color="var(--primary-color)"}),O.addEventListener("mouseenter",k=>{k.currentTarget.style.background="var(--primary-color)",k.currentTarget.style.color="white"}),as(O,"click",t.onAddNew,!0),m(O,b),we(()=>Yt(O,"title",e("inventory.addProduct","Add new product"))),O})()})(),null),l(ie,B(Ge,{get when(){return r()},get children(){var z=l0();return l(z,B(Ge,{get when(){return u().length>0},get fallback(){return(()=>{var O=l0();return m(O,R),l(O,(()=>{var k=Te(()=>!!i());return()=>k()?e("inventory.noProductsFound","No products found matching your search."):e("inventory.noProductsAvailable","No products available.")})()),O})()},get children(){return B(Ut,{get each(){return u()},children:(O,k)=>{const re=w(O.id),$=re<=O.minStockLevel;return(()=>{var D=xE(),H=D.firstChild,L=H.firstChild,j=L.firstChild,oe=j.nextSibling,K=oe.firstChild,Z=K.firstChild,J=K.nextSibling,Y=J.nextSibling,U=Y.nextSibling,ae=U.nextSibling,ue=L.nextSibling,le=ue.firstChild,q=le.firstChild,ce=le.nextSibling;return D.addEventListener("mouseenter",()=>a(k())),D.$$click=()=>g(O),m(H,Q),m(L,ee),m(j,E),l(j,()=>O.name),m(oe,A),l(K,()=>e("inventory.sku","SKU"),Z),l(K,()=>O.sku,null),l(Y,()=>O.category),l(ae,()=>S(O.unitCost)),m(ue,T),le.style.setProperty("font-weight","600"),($?"#f44336":"var(--text-primary)")!=null?le.style.setProperty("color",$?"#f44336":"var(--text-primary)"):le.style.removeProperty("color"),l(le,re,q),l(le,()=>O.unitOfMeasure,null),ce.style.setProperty("color","var(--text-muted)"),l(ce,()=>$?e("inventory.lowStock","Low Stock"):e("inventory.inStock","In Stock")),we(Se=>m(D,X(k()===s()),Se)),D})()}})}})),we(O=>m(z,ne,O)),z}}),null),we(z=>{var O=x,k=G,re=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),$=t.disabled,D=t.required;return z.e=m(ie,O,z.e),z.t=m(W,k,z.t),re!==z.a&&Yt(W,"placeholder",z.a=re),$!==z.o&&(W.disabled=z.o=$),D!==z.i&&(W.required=z.i=D),z},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),we(()=>W.value=_()),ie})()};dr(["input","click","keydown"]);var c0=de("<div>"),AE=de("<div><div><input type=text autocomplete=off>"),CE=de("<button type=button>+"),IE=de("<div><div><div><div> </div><div><span>: </span><span></span></div><div>");const Ou=t=>{const{t:e}=er(),[r,n]=$e(!1),[i,o]=$e(""),[s,a]=$e(-1),c=Tt(()=>t.value?lt.getLocationById(t.value):null),u=Tt(()=>{let ie=lt.getActiveLocations();t.filterType&&(ie=ie.filter(W=>W.type===t.filterType));const F=i().toLowerCase();return F?ie.filter(W=>W.name.toLowerCase().includes(F)||W?.code?.toLowerCase().includes(F)||W?.type?.toLowerCase().includes(F)||W?.address?.toLowerCase().includes(F)):ie}),h=()=>{n(!0),o(""),a(-1)},y=ie=>{const F=ie.target;o(F.value),n(!0),a(-1)},g=ie=>{t.onChange(ie.id),n(!1),o(""),a(-1)},p=ie=>{const F=u();switch(ie.key){case"ArrowDown":ie.preventDefault(),a(W=>Math.min(W+1,F.length-1));break;case"ArrowUp":ie.preventDefault(),a(W=>Math.max(W-1,-1));break;case"Enter":ie.preventDefault(),s()>=0&&F[s()]&&g(F[s()]);break;case"Escape":n(!1),o(""),a(-1);break}},C=ie=>{setTimeout(()=>{n(!1),o(""),a(-1)},150)},S=ie=>({warehouse:"",store:"",supplier:"",customer:""})[ie]||"",w=ie=>({warehouse:"#2196F3",store:"#4CAF50",supplier:"#FF9800",customer:"#9C27B0"})[ie]||"#757575",x={position:"relative",width:"100%",...t.style},V={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},ne={display:"flex","align-items":"stretch",width:"100%"},X={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},Q={...V,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"},ee={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},E=ie=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:ie?"var(--strip-color)":"transparent",color:ie?"var(--primary-dark)":"var(--text-primary)",transition:"all 0.2s ease"}),A={display:"flex","justify-content":"space-between","align-items":"center"},T={flex:"1"},R={"font-weight":"500","margin-bottom":"0.25rem"},_={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem","align-items":"center"},I=ie=>({padding:"0.2rem 0.5rem","border-radius":"var(--border-radius-sm)","font-size":"0.7rem","font-weight":"500",background:w(ie),color:"white","text-transform":"uppercase"}),b={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},G=()=>r()&&i()?i():c()?`${c().name} (${c().code})`:"";return(()=>{var ie=AE(),F=ie.firstChild,W=F.firstChild;return m(F,ne),W.addEventListener("blur",C),W.$$keydown=p,W.$$click=h,W.$$input=y,l(F,(()=>{var z=Te(()=>!!t.onAddNew);return()=>z()&&(()=>{var O=CE();return O.addEventListener("mouseleave",k=>{k.currentTarget.style.background="var(--surface-color)",k.currentTarget.style.color="var(--primary-color)"}),O.addEventListener("mouseenter",k=>{k.currentTarget.style.background="var(--primary-color)",k.currentTarget.style.color="white"}),as(O,"click",t.onAddNew,!0),m(O,X),we(()=>Yt(O,"title",e("inventory.addLocation","Add new location"))),O})()})(),null),l(ie,B(Ge,{get when(){return r()},get children(){var z=c0();return l(z,B(Ge,{get when(){return u().length>0},get fallback(){return(()=>{var O=c0();return m(O,b),l(O,(()=>{var k=Te(()=>!!i());return()=>k()?e("inventory.noLocationsFound","No locations found matching your search."):e("inventory.noLocationsAvailable","No locations available.")})()),O})()},get children(){return B(Ut,{get each(){return u()},children:(O,k)=>(()=>{var re=IE(),$=re.firstChild,D=$.firstChild,H=D.firstChild,L=H.firstChild,j=H.nextSibling,oe=j.firstChild,K=oe.firstChild,Z=oe.nextSibling,J=j.nextSibling;return re.addEventListener("mouseenter",()=>a(k())),re.$$click=()=>g(O),m($,A),m(D,T),m(H,R),l(H,()=>S(O.type),L),l(H,()=>O.name,null),m(j,_),l(oe,()=>e("inventory.locationCode","Code"),K),l(oe,()=>O.code,null),l(Z,()=>O.type),J.style.setProperty("font-size","0.75rem"),J.style.setProperty("color","var(--text-muted)"),J.style.setProperty("margin-top","0.25rem"),l(J,()=>O.address),we(Y=>{var U=E(k()===s()),ae=I(O.type);return Y.e=m(re,U,Y.e),Y.t=m(Z,ae,Y.t),Y},{e:void 0,t:void 0}),re})()})}})),we(O=>m(z,ee,O)),z}}),null),we(z=>{var O=x,k=Q,re=t.placeholder||e("inventory.searchLocations","Search locations by name, code, or type..."),$=t.disabled,D=t.required;return z.e=m(ie,O,z.e),z.t=m(W,k,z.t),re!==z.a&&Yt(W,"placeholder",z.a=re),$!==z.o&&(W.disabled=z.o=$),D!==z.i&&(W.required=z.i=D),z},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),we(()=>W.value=G()),ie})()};dr(["input","click","keydown"]);var $E=de("<form><div><label> *</label><input type=text required></div><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text list=categories required><datalist id=categories><option value=Electronics></option><option value=Accessories></option><option value=Office></option><option value=Furniture></option><option value=Software></option><option value=Hardware></option></datalist></div></div><div><label></label><textarea></textarea></div><div><div><label></label><select><option value=pcs></option><option value=kg></option><option value=lbs></option><option value=m></option><option value=ft></option><option value=l></option><option value=gal></option><option value=box></option><option value=pack></option></select></div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div></div><div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div><div></div></div><div><div><label></label><input type=number min=0 step=1></div><div><label></label><input type=number min=1 step=1></div></div><div>"),EE=de("<div>");const Ny=t=>{const{t:e}=er(),[r,n]=$e(""),[i,o]=$e(""),[s,a]=$e(""),[c,u]=$e(""),[h,y]=$e("pcs"),[g,p]=$e(0),[C,S]=$e(0),[w,x]=$e(10),[V,ne]=$e(100),[X,Q]=$e(""),ee=()=>{n(""),o(""),a(""),u(""),y("pcs"),p(0),S(0),x(10),ne(100),Q("")},E=F=>{if(F.preventDefault(),Q(""),!r().trim()){Q(e("forms.productNameRequired"));return}if(!i().trim()){Q(e("forms.skuRequired"));return}if(!c().trim()){Q(e("forms.categoryRequired"));return}if(g()<0){Q(e("forms.unitCostNotNegative"));return}if(C()<0){Q(e("forms.sellingPriceNotNegative"));return}if(w()<0){Q(e("forms.minStockNotNegative"));return}if(V()<=w()){Q(e("forms.maxStockGreaterThanMin"));return}if(lt.getProductsBySku(i()).length>0){Q(e("forms.skuAlreadyExists"));return}const z={name:r().trim(),sku:i().trim().toUpperCase(),description:s().trim(),category:c().trim(),unitOfMeasure:h(),unitCost:g(),sellingPrice:C(),minStockLevel:w(),maxStockLevel:V(),isActive:!0,businessId:"default-business"};lt.addProduct(z);const O=`prod-${Date.now()}`;t.onProductAdded&&t.onProductAdded(O),ee(),t.onClose()},A=()=>{ee(),t.onClose()},T={"margin-bottom":"1.5rem"},R={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},_={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},I={..._,cursor:"pointer"},b={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},G={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},ie={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"};return B(Xn,{get isOpen(){return t.isOpen},onClose:A,get title(){return e("inventory.addNewProduct")},get children(){var F=$E(),W=F.firstChild,z=W.firstChild,O=z.firstChild,k=z.nextSibling,re=W.nextSibling,$=re.firstChild,D=$.firstChild,H=D.firstChild,L=D.nextSibling,j=$.nextSibling,oe=j.firstChild,K=oe.firstChild,Z=oe.nextSibling,J=re.nextSibling,Y=J.firstChild,U=Y.nextSibling,ae=J.nextSibling,ue=ae.firstChild,le=ue.firstChild,q=le.nextSibling,ce=q.firstChild,Se=ce.nextSibling,me=Se.nextSibling,Pe=me.nextSibling,xe=Pe.nextSibling,he=xe.nextSibling,ve=he.nextSibling,De=ve.nextSibling,ke=De.nextSibling,Ce=ue.nextSibling,Le=Ce.firstChild,Ie=Le.nextSibling,Re=ae.nextSibling,He=Re.firstChild,Me=He.firstChild,Ze=Me.nextSibling,Ye=Re.nextSibling,ut=Ye.firstChild,rt=ut.firstChild,We=rt.nextSibling,ct=ut.nextSibling,pt=ct.firstChild,_t=pt.nextSibling,Et=Ye.nextSibling;return F.addEventListener("submit",E),l(z,()=>e("inventory.productName"),O),k.addEventListener("change",et=>n(et.target.value)),l(D,()=>e("inventory.sku"),H),L.addEventListener("change",et=>o(et.target.value)),l(oe,()=>e("inventory.category"),K),Z.addEventListener("change",et=>u(et.target.value)),l(Y,()=>e("common.description")),U.addEventListener("change",et=>a(et.target.value)),l(le,()=>e("inventory.unitOfMeasure")),q.addEventListener("change",et=>y(et.target.value)),l(ce,()=>e("inventory.pieces")),l(Se,()=>e("inventory.kilograms")),l(me,()=>e("inventory.pounds")),l(Pe,()=>e("inventory.meters")),l(xe,()=>e("inventory.feet")),l(he,()=>e("inventory.liters")),l(ve,()=>e("inventory.gallons")),l(De,()=>e("inventory.boxes")),l(ke,()=>e("inventory.packs")),l(Le,()=>e("inventory.unitCost")),Ie.addEventListener("change",et=>p(Number(et.target.value))),l(Me,()=>e("inventory.sellingPrice")),Ze.addEventListener("change",et=>S(Number(et.target.value))),l(rt,()=>e("inventory.minimumStockLevel")),We.addEventListener("change",et=>x(Number(et.target.value))),l(pt,()=>e("inventory.maximumStockLevel")),_t.addEventListener("change",et=>ne(Number(et.target.value))),l(F,(()=>{var et=Te(()=>!!X());return()=>et()&&(()=>{var Ue=EE();return m(Ue,b),l(Ue,X),Ue})()})(),Et),m(Et,G),l(Et,B(xt,{variant:"secondary",type:"button",onClick:A,get children(){return e("common.cancel")}}),null),l(Et,B(xt,{variant:"primary",type:"submit",get children(){return e("inventory.addProduct")}}),null),we(et=>{var Ue=T,ot=R,Xe=_,at=e("inventory.enterProductName"),St=ie,$t=R,qt=_,Gt=e("inventory.enterSkuCode"),ht=R,Kt=_,Rt=e("inventory.enterCategory"),Qt=T,sr=R,mt={..._,"min-height":"80px",resize:"vertical"},At=e("inventory.enterProductDescription"),Ot=ie,Jt=R,Zt=I,Ht=R,tt=_,jt=ie,yt=R,ar=_,Wr=ie,pr=R,wr=_,$r=R,lr=_;return et.e=m(W,Ue,et.e),et.t=m(z,ot,et.t),et.a=m(k,Xe,et.a),at!==et.o&&Yt(k,"placeholder",et.o=at),et.i=m(re,St,et.i),et.n=m(D,$t,et.n),et.s=m(L,qt,et.s),Gt!==et.h&&Yt(L,"placeholder",et.h=Gt),et.r=m(oe,ht,et.r),et.d=m(Z,Kt,et.d),Rt!==et.l&&Yt(Z,"placeholder",et.l=Rt),et.u=m(J,Qt,et.u),et.c=m(Y,sr,et.c),et.w=m(U,mt,et.w),At!==et.m&&Yt(U,"placeholder",et.m=At),et.f=m(ae,Ot,et.f),et.y=m(le,Jt,et.y),et.g=m(q,Zt,et.g),et.p=m(Le,Ht,et.p),et.b=m(Ie,tt,et.b),et.T=m(Re,jt,et.T),et.A=m(Me,yt,et.A),et.O=m(Ze,ar,et.O),et.I=m(Ye,Wr,et.I),et.S=m(rt,pr,et.S),et.W=m(We,wr,et.W),et.C=m(pt,$r,et.C),et.B=m(_t,lr,et.B),et},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),we(()=>k.value=r()),we(()=>L.value=i()),we(()=>Z.value=c()),we(()=>U.value=s()),we(()=>q.value=h()),we(()=>Ie.value=g()),we(()=>Ze.value=C()),we(()=>We.value=w()),we(()=>_t.value=V()),F}})};var kE=de('<form><div><label> *</label><input type=text required></div><div><div><label> *<button type=button title="Generate code automatically"></button></label><input type=text required><div></div></div><div><label> *</label><select required><option value=warehouse> </option><option value=store> </option><option value=supplier> </option><option value=customer> </option></select><div></div></div></div><div><label> *</label><textarea required></textarea></div><div>'),TE=de("<div><div>:</div><div><span></span><div><div></div><div>"),NE=de("<div>");const Ly=t=>{const{t:e}=er(),[r,n]=$e(""),[i,o]=$e(""),[s,a]=$e("warehouse"),[c,u]=$e(""),[h,y]=$e(""),g=()=>{n(""),o(""),a("warehouse"),u(""),y("")},p=()=>{if(r()){const _=s()==="warehouse"?"WH":s()==="store"?"ST":s()==="supplier"?"SUP":"CUST",I=r().toUpperCase().replace(/[^A-Z0-9]/g,"").substring(0,3),b=String(Math.floor(Math.random()*1e3)).padStart(3,"0");o(`${_}-${I}-${b}`)}},C=_=>{if(_.preventDefault(),y(""),!r().trim()){y(e("forms.locationNameRequired"));return}if(!i().trim()){y(e("forms.locationCodeRequired"));return}if(!c().trim()){y(e("forms.addressRequired"));return}if(lt.locations.filter(ie=>ie.code.toLowerCase()===i().toLowerCase()).length>0){y(e("forms.locationCodeExists"));return}const b={name:r().trim(),code:i().trim().toUpperCase(),type:s(),address:c().trim(),isActive:!0};lt.addLocation(b);const G=`loc-${Date.now()}`;t.onLocationAdded&&t.onLocationAdded(G),g(),t.onClose()},S=()=>{g(),t.onClose()},w={"margin-bottom":"1.5rem"},x={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},V={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},ne={...V,cursor:"pointer"},X={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},Q={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},ee={display:"grid","grid-template-columns":"2fr 1fr",gap:"1rem"},E={"font-size":"0.875rem",color:"var(--text-muted)","margin-top":"0.25rem"},A={padding:"0.25rem 0.5rem","font-size":"0.75rem","margin-left":"0.5rem",background:"var(--background-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",color:"var(--text-muted)"},T=_=>({warehouse:"",store:"",supplier:"",customer:""})[_]||"",R=_=>({warehouse:e("inventory.warehouseDescription"),store:e("inventory.storeDescription"),supplier:e("inventory.supplierDescription"),customer:e("inventory.customerDescription")})[_]||"";return B(Xn,{get isOpen(){return t.isOpen},onClose:S,get title(){return e("inventory.addNewLocation")},get children(){var _=kE(),I=_.firstChild,b=I.firstChild,G=b.firstChild,ie=b.nextSibling,F=I.nextSibling,W=F.firstChild,z=W.firstChild,O=z.firstChild,k=O.nextSibling,re=z.nextSibling,$=re.nextSibling,D=W.nextSibling,H=D.firstChild,L=H.firstChild,j=H.nextSibling,oe=j.firstChild,K=oe.firstChild,Z=oe.nextSibling,J=Z.firstChild,Y=Z.nextSibling,U=Y.firstChild,ae=Y.nextSibling,ue=ae.firstChild,le=j.nextSibling,q=F.nextSibling,ce=q.firstChild,Se=ce.firstChild,me=ce.nextSibling,Pe=q.nextSibling;return _.addEventListener("submit",C),l(b,()=>e("inventory.locationName"),G),ie.addEventListener("change",xe=>n(xe.target.value)),m(F,ee),l(z,()=>e("inventory.locationCode"),O),k.$$click=p,m(k,A),l(k,()=>e("common.generate")),re.addEventListener("change",xe=>o(xe.target.value)),l($,()=>e("inventory.uniqueIdentifierHelp")),l(H,()=>e("inventory.locationType"),L),j.addEventListener("change",xe=>a(xe.target.value)),l(oe,()=>T("warehouse"),K),l(oe,()=>e("inventory.warehouse"),null),l(Z,()=>T("store"),J),l(Z,()=>e("inventory.store"),null),l(Y,()=>T("supplier"),U),l(Y,()=>e("inventory.supplier"),null),l(ae,()=>T("customer"),ue),l(ae,()=>e("inventory.customer"),null),l(le,()=>R(s())),l(ce,()=>e("common.address"),Se),me.addEventListener("change",xe=>u(xe.target.value)),l(_,(()=>{var xe=Te(()=>!!r());return()=>xe()&&(()=>{var he=TE(),ve=he.firstChild,De=ve.firstChild,ke=ve.nextSibling,Ce=ke.firstChild,Le=Ce.nextSibling,Ie=Le.firstChild,Re=Ie.nextSibling;return he.style.setProperty("padding","1rem"),he.style.setProperty("background","var(--background-color)"),he.style.setProperty("border-radius","var(--border-radius-sm)"),he.style.setProperty("border","1px solid var(--border-color)"),he.style.setProperty("margin-bottom","1rem"),ve.style.setProperty("font-weight","500"),ve.style.setProperty("margin-bottom","0.5rem"),l(ve,()=>e("common.preview"),De),ke.style.setProperty("display","flex"),ke.style.setProperty("align-items","center"),ke.style.setProperty("gap","0.5rem"),Ce.style.setProperty("font-size","1.2rem"),l(Ce,()=>T(s())),Ie.style.setProperty("font-weight","600"),l(Ie,r),Re.style.setProperty("font-size","0.875rem"),Re.style.setProperty("color","var(--text-muted)"),l(Re,(()=>{var He=Te(()=>!!i());return()=>He()&&`${i()}  `})(),null),l(Re,s,null),he})()})(),Pe),l(_,(()=>{var xe=Te(()=>!!h());return()=>xe()&&(()=>{var he=NE();return m(he,X),l(he,h),he})()})(),Pe),m(Pe,Q),l(Pe,B(xt,{variant:"secondary",type:"button",onClick:S,get children(){return e("common.cancel")}}),null),l(Pe,B(xt,{variant:"primary",type:"submit",get children(){return e("inventory.addLocation")}}),null),we(xe=>{var he=w,ve=x,De=V,ke=e("inventory.enterLocationName"),Ce=x,Le=V,Ie=e("inventory.enterUniqueCode"),Re=E,He=x,Me=ne,Ze=E,Ye=w,ut=x,rt={...V,"min-height":"100px",resize:"vertical"},We=e("inventory.enterCompleteAddress");return xe.e=m(I,he,xe.e),xe.t=m(b,ve,xe.t),xe.a=m(ie,De,xe.a),ke!==xe.o&&Yt(ie,"placeholder",xe.o=ke),xe.i=m(z,Ce,xe.i),xe.n=m(re,Le,xe.n),Ie!==xe.s&&Yt(re,"placeholder",xe.s=Ie),xe.h=m($,Re,xe.h),xe.r=m(H,He,xe.r),xe.d=m(j,Me,xe.d),xe.l=m(le,Ze,xe.l),xe.u=m(q,Ye,xe.u),xe.c=m(ce,ut,xe.c),xe.w=m(me,rt,xe.w),We!==xe.m&&Yt(me,"placeholder",xe.m=We),xe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),we(()=>ie.value=r()),we(()=>re.value=i()),we(()=>j.value=s()),we(()=>me.value=c()),_}})};dr(["click"]);var LE=de("<form><div>"),u0=de("<div><label> *"),DE=de("<div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment>"),RE=de("<div><label>"),ME=de("<div><label> *</label><input type=number min=0 step=1 required>"),FE=de("<div><label></label><input type=number min=0 step=0.01>"),OE=de("<div><label></label><input type=text>"),BE=de("<div><label></label><textarea>"),jE=de("<div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span>:</span><span> "),VE=de("<div><div><span>:</span><span>"),qE=de("<div>");const zE=t=>{const{t:e}=er(),[r,n]=$e({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""}),[i,o]=$e(""),[s,a]=$e(""),[c,u]=$e("in"),[h,y]=$e(0),[g,p]=$e(0),[C,S]=$e(""),[w,x]=$e(""),[V,ne]=$e(""),[X,Q]=$e(""),[ee,E]=$e(!1),[A,T]=$e(!1),R=()=>t.mode==="movement",_=Tt(()=>i()?lt.getProductById(i()):null),I=Tt(()=>s()?lt.getLocationById(s()):null),b=Tt(()=>V()?lt.getLocationById(V()):null),G=Tt(()=>h()*g()),ie=Tt(()=>!i()||!s()?0:lt.getStockByProductAndLocation(i(),s())?.quantity||0),F=[{value:"Electronics",label:"Electronics"},{value:"Accessories",label:"Accessories"},{value:"Furniture",label:"Furniture"},{value:"Office Supplies",label:"Office Supplies"},{value:"Software",label:"Software"},{value:"Hardware",label:"Hardware"},{value:"Consumables",label:"Consumables"}],W=[{value:"Warehouse A",label:"Warehouse A"},{value:"Warehouse B",label:"Warehouse B"},{value:"Warehouse C",label:"Warehouse C"},{value:"Storage Room",label:"Storage Room"},{value:"Main Office",label:"Main Office"}],z={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},O=()=>{o(""),a(""),u("in"),y(0),p(0),S(""),x(""),ne(""),Q("")},k=()=>{n({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""})},re=ae=>{if(ae.preventDefault(),R()){if(Q(""),!i()){Q(e("forms.selectProduct"));return}if(!s()){Q(e("forms.selectLocation"));return}if(h()<=0){Q(e("forms.quantityGreaterThanZero"));return}if(g()<0){Q(e("forms.unitCostNotNegative"));return}if(c()==="transfer"&&!V()){Q(e("forms.selectFromLocation"));return}if(c()==="transfer"&&V()===s()){Q(e("forms.sameLocationError"));return}if(c()==="out"&&h()>ie()){Q(e("forms.insufficientStock",{currentStock:ie()}));return}const ue=_(),le=I(),q={productId:ue.id,productName:ue.name,productSku:ue.sku,locationId:le.id,locationName:le.name,movementType:c(),quantity:h(),unitCost:g()||ue.unitCost,totalCost:G()||h()*ue.unitCost,referenceNumber:C()||`AUTO-${Date.now()}`,notes:w(),createdBy:"admin",fromLocationId:c()==="transfer"?V():void 0,fromLocationName:c()==="transfer"?b()?.name:void 0};lt.addInventoryMovement(q),O()}else{const ue=r();if(!ue.name||!ue.price||!ue.quantity||!ue.category||!ue.sku||!ue.supplier||!ue.minStock||!ue.location){alert(e("forms.fillAllRequired"));return}const le={name:ue.name,price:parseFloat(ue.price),quantity:parseInt(ue.quantity),category:ue.category,description:ue.description,sku:ue.sku,supplier:ue.supplier,minStock:parseInt(ue.minStock),location:ue.location};lt.addItem(le),k()}t.onClose()},$=(ae,ue)=>{n(le=>({...le,[ae]:ue}))},D=()=>{R()?O():k(),t.onClose()},H=ae=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ae),L={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},j={...L,cursor:"pointer"},oe={color:"#f44336","font-size":"0.875rem","margin-top":"0.5rem"},K={padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},Z={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},J={"font-weight":"500",color:"var(--text-muted)"},Y={"font-weight":"600",color:"var(--text-primary)"},U=()=>R()?e("inventory.addMovement"):e("inventory.addNewItem");return B(Xn,{get isOpen(){return t.isOpen},onClose:D,get title(){return U()},get children(){return[(()=>{var ae=LE(),ue=ae.firstChild;return ae.addEventListener("submit",re),l(ae,(()=>{var le=Te(()=>!!R());return()=>le()?[(()=>{var q=u0(),ce=q.firstChild,Se=ce.firstChild;return q.style.setProperty("margin-bottom","1.5rem"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),l(ce,()=>e("inventory.product"),Se),l(q,B(cf,{get value(){return i()},onChange:me=>{o(me);const Pe=lt.getProductById(me);Pe&&p(Pe.unitCost)},get placeholder(){return e("inventory.searchProductsPlaceholder")},onAddNew:()=>E(!0),required:!0}),null),q})(),(()=>{var q=DE(),ce=q.firstChild,Se=ce.firstChild,me=ce.nextSibling,Pe=me.firstChild,xe=Pe.nextSibling,he=xe.nextSibling,ve=he.nextSibling;return q.style.setProperty("margin-bottom","1.5rem"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),l(ce,()=>e("inventory.movementType"),Se),me.addEventListener("change",De=>u(De.target.value)),l(Pe,()=>e("inventory.stockInPurchase")),l(xe,()=>e("inventory.stockOutSale")),l(he,()=>e("inventory.transferBetween")),l(ve,()=>e("inventory.stockAdjustment")),we(De=>m(me,j,De)),we(()=>me.value=c()),q})(),Te(()=>Te(()=>c()==="transfer")()&&(()=>{var q=u0(),ce=q.firstChild,Se=ce.firstChild;return q.style.setProperty("margin-bottom","1.5rem"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),l(ce,()=>e("inventory.fromLocation"),Se),l(q,B(Ou,{get value(){return V()},onChange:me=>ne(me),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>T(!0),required:!0}),null),q})()),(()=>{var q=RE(),ce=q.firstChild;return q.style.setProperty("margin-bottom","1.5rem"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),l(ce,(()=>{var Se=Te(()=>c()==="transfer");return()=>Se()?e("inventory.toLocation")+" *":e("inventory.locationName")+" *"})()),l(q,B(Ou,{get value(){return s()},onChange:Se=>a(Se),get placeholder(){return Te(()=>c()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>T(!0),required:!0}),null),q})(),Te(()=>Te(()=>!!(_()&&I()))()&&(()=>{var q=jE(),ce=q.firstChild,Se=ce.firstChild,me=Se.firstChild,Pe=Se.nextSibling,xe=Pe.firstChild,he=ce.nextSibling,ve=he.firstChild,De=ve.firstChild,ke=ve.nextSibling,Ce=he.nextSibling,Le=Ce.firstChild,Ie=Le.firstChild,Re=Le.nextSibling,He=Re.firstChild;return l(Se,()=>e("inventory.currentStockAt",{location:I()?.name}),me),l(Pe,ie,xe),l(Pe,()=>_()?.unitOfMeasure,null),l(ve,()=>e("inventory.productCost"),De),l(ke,()=>H(_()?.unitCost||0)),l(Le,()=>e("inventory.minStockLevel"),Ie),l(Re,()=>_()?.minStockLevel,He),l(Re,()=>_()?.unitOfMeasure,null),we(Me=>{var Ze=K,Ye=Z,ut=J,rt=Y,We=Z,ct=J,pt=Y,_t=Z,Et=J,et=Y;return Me.e=m(q,Ze,Me.e),Me.t=m(ce,Ye,Me.t),Me.a=m(Se,ut,Me.a),Me.o=m(Pe,rt,Me.o),Me.i=m(he,We,Me.i),Me.n=m(ve,ct,Me.n),Me.s=m(ke,pt,Me.s),Me.h=m(Ce,_t,Me.h),Me.r=m(Le,Et,Me.r),Me.d=m(Re,et,Me.d),Me},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),q})()),(()=>{var q=ME(),ce=q.firstChild,Se=ce.firstChild,me=ce.nextSibling;return q.style.setProperty("margin-bottom","1.5rem"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),l(ce,()=>e("inventory.quantity"),Se),me.addEventListener("change",Pe=>y(Number(Pe.target.value))),we(Pe=>m(me,L,Pe)),we(()=>me.value=h()),q})(),(()=>{var q=FE(),ce=q.firstChild,Se=ce.nextSibling;return q.style.setProperty("margin-bottom","1.5rem"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),l(ce,()=>e("inventory.unitCost")),Se.addEventListener("change",me=>p(Number(me.target.value))),we(me=>{var Pe=L,xe=e("inventory.willUseDefaultCost");return me.e=m(Se,Pe,me.e),xe!==me.t&&Yt(Se,"placeholder",me.t=xe),me},{e:void 0,t:void 0}),we(()=>Se.value=g()),q})(),Te(()=>Te(()=>h()>0&&g()>0)()&&(()=>{var q=VE(),ce=q.firstChild,Se=ce.firstChild,me=Se.firstChild,Pe=Se.nextSibling;return l(Se,()=>e("inventory.totalCost"),me),l(Pe,()=>H(G())),we(xe=>{var he=K,ve=Z,De=J,ke={...Y,"font-size":"1.2rem",color:"var(--primary-color)"};return xe.e=m(q,he,xe.e),xe.t=m(ce,ve,xe.t),xe.a=m(Se,De,xe.a),xe.o=m(Pe,ke,xe.o),xe},{e:void 0,t:void 0,a:void 0,o:void 0}),q})()),(()=>{var q=OE(),ce=q.firstChild,Se=ce.nextSibling;return q.style.setProperty("margin-bottom","1.5rem"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),l(ce,()=>e("common.referenceNumber")),Se.addEventListener("change",me=>S(me.target.value)),we(me=>{var Pe=L,xe=e("common.referenceNumberPlaceholder");return me.e=m(Se,Pe,me.e),xe!==me.t&&Yt(Se,"placeholder",me.t=xe),me},{e:void 0,t:void 0}),we(()=>Se.value=C()),q})(),(()=>{var q=BE(),ce=q.firstChild,Se=ce.nextSibling;return q.style.setProperty("margin-bottom","1.5rem"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),l(ce,()=>e("common.notes")),Se.addEventListener("change",me=>x(me.target.value)),we(me=>{var Pe={...L,"min-height":"100px",resize:"vertical"},xe=e("inventory.additionalNotesPlaceholder");return me.e=m(Se,Pe,me.e),xe!==me.t&&Yt(Se,"placeholder",me.t=xe),me},{e:void 0,t:void 0}),we(()=>Se.value=w()),q})(),Te(()=>Te(()=>!!X())()&&(()=>{var q=qE();return m(q,oe),l(q,X),q})())]:[B(Or,{get label(){return e("inventory.itemName")},get value(){return r().name},onChange:q=>$("name",q),get placeholder(){return e("inventory.enterItemName")},required:!0}),B(Or,{get label(){return e("inventory.sku")},get value(){return r().sku},onChange:q=>$("sku",q),get placeholder(){return e("inventory.enterSkuCode")},required:!0}),B(ci,{get label(){return e("inventory.category")},get value(){return r().category},onChange:q=>$("category",q),options:F,required:!0}),B(Or,{get label(){return e("common.description")},get value(){return r().description},onChange:q=>$("description",q),get placeholder(){return e("inventory.enterItemDescription")}}),B(Or,{get label(){return e("common.price")},type:"number",get value(){return r().price},onChange:q=>$("price",q),get placeholder(){return e("common.enterPrice")},required:!0}),B(Or,{get label(){return e("inventory.quantity")},type:"number",get value(){return r().quantity},onChange:q=>$("quantity",q),get placeholder(){return e("inventory.enterQuantity")},required:!0}),B(Or,{get label(){return e("inventory.minimumStock")},type:"number",get value(){return r().minStock},onChange:q=>$("minStock",q),get placeholder(){return e("inventory.enterMinStockLevel")},required:!0}),B(Or,{get label(){return e("inventory.supplier")},get value(){return r().supplier},onChange:q=>$("supplier",q),get placeholder(){return e("inventory.enterSupplierName")},required:!0}),B(ci,{get label(){return e("inventory.location")},get value(){return r().location},onChange:q=>$("location",q),options:W,required:!0})]})(),ue),m(ue,z),l(ue,B(xt,{variant:"secondary",type:"button",onClick:D,get children(){return e("common.cancel")}}),null),l(ue,B(xt,{variant:"primary",type:"submit",get children(){return Te(()=>!!R())()?e("inventory.addMovement"):e("inventory.addItem")}}),null),ae})(),B(Ny,{get isOpen(){return ee()},onClose:()=>E(!1),onProductAdded:ae=>{o(ae),E(!1)}}),B(Ly,{get isOpen(){return A()},onClose:()=>T(!1),onLocationAdded:ae=>{c()==="transfer"&&!V()?ne(ae):a(ae),T(!1)}})]}})};dr(["input","keydown"]);var UE=de("<form><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text required></div></div><div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><div><label></label></div></div><div><div><h3></h3></div></div><div><label></label><textarea></textarea></div><div>"),HE=de("<div><label> *"),WE=de("<div><div></div><div></div><div></div><div></div><div>"),Zf=de("<div>"),GE=de("<div><input type=number min=0 step=1 required><input type=number min=0 step=0.01><input type=text>"),YE=de("<div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span>"),KE=de("<div> ");const JE=t=>{const{t:e}=er(),[r,n]=$e(`INV-${Date.now()}`),[i,o]=$e(""),[s,a]=$e("in"),[c,u]=$e(""),[h,y]=$e(""),[g,p]=$e(""),[C,S]=$e([]),[w,x]=$e([]),[V,ne]=$e(!1),[X,Q]=$e(!1),ee=()=>{S(K=>[...K,{productId:"",quantity:0,unitCost:0,notes:""}])},E=K=>{S(Z=>Z.filter((J,Y)=>Y!==K))},A=(K,Z,J)=>{S(Y=>Y.map((U,ae)=>ae===K?{...U,[Z]:J}:U))},T=()=>{n(`INV-${Date.now()}`),o(""),a("in"),u(""),y(""),p(""),S([]),x([])},R=async K=>{K.preventDefault(),x([]);const Z=[];if(i()||Z.push(e("forms.referenceNumberRequired")),c()||Z.push(e("forms.locationRequired")),s()==="transfer"&&!h()&&Z.push(e("forms.fromLocationRequired")),C().length===0&&Z.push(e("forms.atLeastOneProduct")),C().forEach((U,ae)=>{U.productId||Z.push(e("forms.itemProductRequired","Product is required for item {{index}}",{index:ae+1})),U.quantity<=0&&Z.push(e("forms.itemQuantityRequired","Quantity must be greater than 0 for item {{index}}",{index:ae+1}))}),Z.length>0){x(Z);return}const J={ssg_inventory_key:Dm(),invoiceId:r(),referenceNumber:i(),movementType:s(),type:Rp(s()),locationId:c(),fromLocationId:s()==="transfer"?h():void 0,items:C(),products:C(),generalNotes:g(),description:g(),invoice:i(),store:c(),createdBy:"admin",createDate:new Date().toISOString()};console.log(J);const Y=await lt.addBulkInventoryMovements(J);console.log(Y),Y.success?t.onMovementComplete?t.onMovementComplete(i()):(T(),t.onClose()):x(Y.errors)},_=()=>{T(),t.onClose()},I=Tt(()=>C().reduce((K,Z)=>{const J=lt.getProductById(Z.productId),Y=Z.unitCost||J?.unitCost||0;return K+Z.quantity*Y},0)),b=Tt(()=>C().reduce((K,Z)=>K+Z.quantity,0)),G={"margin-bottom":"1.5rem"},ie={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},F={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},W={...F,cursor:"pointer"},z={display:"grid",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},O={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},k={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem","padding-left":"0.75rem"},re={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},$={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},D={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},H={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},L=K=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(K),j=K=>({in:e("inventory.purchaseReceive"),out:e("inventory.saleIssue"),transfer:e("inventory.transfer"),adjustment:e("inventory.adjustment")})[K]||K,oe=async K=>{await lt.fecthInventory(K),await lt.fecthProduct(K)};return Rn(()=>{oe("prod")}),B(Xn,{get isOpen(){return t.isOpen},onClose:_,get title(){return e("inventory.bulkMovement")},get children(){return[(()=>{var K=UE(),Z=K.firstChild,J=Z.firstChild,Y=J.firstChild,U=Y.firstChild,ae=Y.nextSibling,ue=J.nextSibling,le=ue.firstChild,q=le.firstChild,ce=le.nextSibling,Se=Z.nextSibling,me=Se.firstChild,Pe=me.firstChild,xe=me.nextSibling,he=xe.firstChild,ve=he.nextSibling,De=ve.nextSibling,ke=De.nextSibling,Ce=Se.nextSibling,Le=Ce.firstChild,Ie=Le.firstChild,Re=Ce.nextSibling,He=Re.firstChild,Me=He.firstChild,Ze=Re.nextSibling,Ye=Ze.firstChild,ut=Ye.nextSibling,rt=Ze.nextSibling;return K.addEventListener("submit",R),Z.style.setProperty("display","grid"),Z.style.setProperty("grid-template-columns","1fr 1fr"),Z.style.setProperty("gap","1rem"),Z.style.setProperty("margin-bottom","1.5rem"),l(Y,()=>e("common.invoiceDocumentId"),U),ae.addEventListener("change",We=>n(We.target.value)),l(le,()=>e("common.referenceNumber"),q),ce.addEventListener("change",We=>o(We.target.value)),l(me,()=>e("inventory.movementType"),Pe),xe.addEventListener("change",We=>a(We.target.value)),l(he,()=>e("inventory.purchaseReceive")),l(ve,()=>e("inventory.saleIssue")),l(De,()=>e("inventory.transfer")),l(ke,()=>e("inventory.adjustment")),Ce.style.setProperty("display","grid"),Ce.style.setProperty("gap","1rem"),Ce.style.setProperty("margin-bottom","1.5rem"),l(Ce,(()=>{var We=Te(()=>s()==="transfer");return()=>We()&&(()=>{var ct=HE(),pt=ct.firstChild,_t=pt.firstChild;return l(pt,()=>e("inventory.fromLocation"),_t),l(ct,B(Ou,{get value(){return h()},onChange:Et=>y(Et),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>Q(!0),required:!0}),null),we(Et=>m(pt,ie,Et)),ct})()})(),Le),l(Ie,(()=>{var We=Te(()=>s()==="transfer");return()=>We()?e("inventory.toLocation")+" *":e("inventory.location")+" *"})()),l(Le,B(Ou,{get value(){return c()},onChange:We=>u(We),get placeholder(){return Te(()=>s()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>Q(!0),required:!0}),null),He.style.setProperty("display","flex"),He.style.setProperty("justify-content","space-between"),He.style.setProperty("align-items","center"),He.style.setProperty("margin-bottom","1rem"),Me.style.setProperty("margin","0"),Me.style.setProperty("font-size","1.1rem"),l(Me,()=>e("inventory.products")),l(He,B(xt,{variant:"outline",type:"button",onClick:ee,get children(){return e("inventory.addProduct")}}),null),l(Re,(()=>{var We=Te(()=>C().length>0);return()=>We()&&[(()=>{var ct=WE(),pt=ct.firstChild,_t=pt.nextSibling,Et=_t.nextSibling,et=Et.nextSibling;return m(ct,k),l(pt,()=>e("inventory.product")),l(_t,()=>e("inventory.quantity")),l(Et,()=>e("inventory.unitCost")),l(et,()=>e("common.notes")),ct})(),B(Ut,{get each(){return C()},children:(ct,pt)=>[(()=>{var _t=Zf();return m(_t,z),l(_t,B(cf,{get value(){return ct.productId},onChange:Et=>{A(pt(),"productId",Et.id);let et={id:Et.id,label:Et.name,code:Et.sku};A(pt(),"product",et);const Ue=lt.getProductById(Et.id);Ue&&!ct.unitCost&&A(pt(),"unitCost",Ue.unitCost)},get placeholder(){return e("inventory.searchProduct")},onAddNew:()=>ne(!0),required:!0})),_t})(),(()=>{var _t=GE(),Et=_t.firstChild,et=Et.nextSibling,Ue=et.nextSibling;return m(_t,O),Et.addEventListener("change",ot=>A(pt(),"quantity",Number(ot.target.value))),et.addEventListener("change",ot=>A(pt(),"unitCost",Number(ot.target.value))),Ue.addEventListener("change",ot=>A(pt(),"notes",ot.target.value)),l(_t,B(xt,{variant:"outline",size:"sm",type:"button",onClick:()=>E(pt()),style:{color:"#f44336","border-color":"#f44336"},get children(){return e("common.remove")}}),null),we(ot=>{var Xe=F,at=F,St=e("common.auto"),$t=F,qt=e("common.optionalNotes");return ot.e=m(Et,Xe,ot.e),ot.t=m(et,at,ot.t),St!==ot.a&&Yt(et,"placeholder",ot.a=St),ot.o=m(Ue,$t,ot.o),qt!==ot.i&&Yt(Ue,"placeholder",ot.i=qt),ot},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),we(()=>Et.value=ct.quantity),we(()=>et.value=ct.unitCost),we(()=>Ue.value=ct.notes),_t})()]})]})(),null),l(Re,(()=>{var We=Te(()=>C().length===0);return()=>We()&&(()=>{var ct=Zf();return ct.style.setProperty("text-align","center"),ct.style.setProperty("padding","2rem"),ct.style.setProperty("background","var(--background-color)"),ct.style.setProperty("border-radius","var(--border-radius-sm)"),ct.style.setProperty("border","1px solid var(--border-color)"),ct.style.setProperty("color","var(--text-muted)"),l(ct,()=>e("inventory.noProductsAdded")),ct})()})(),null),l(K,(()=>{var We=Te(()=>C().length>0);return()=>We()&&(()=>{var ct=YE(),pt=ct.firstChild,_t=pt.nextSibling,Et=_t.firstChild,et=Et.firstChild,Ue=Et.nextSibling,ot=_t.nextSibling,Xe=ot.firstChild,at=Xe.firstChild,St=Xe.nextSibling,$t=ot.nextSibling,qt=$t.firstChild,Gt=qt.firstChild,ht=qt.nextSibling,Kt=$t.nextSibling,Rt=Kt.firstChild,Qt=Rt.firstChild,sr=Rt.nextSibling;return m(ct,re),pt.style.setProperty("margin","0 0 1rem 0"),pt.style.setProperty("font-size","1rem"),l(pt,()=>e("common.summary")),l(Et,()=>e("inventory.totalProducts"),et),Ue.style.setProperty("font-weight","600"),l(Ue,()=>C().length),l(Xe,()=>e("inventory.totalItems"),at),St.style.setProperty("font-weight","600"),l(St,b),l(qt,()=>e("inventory.totalValue"),Gt),ht.style.setProperty("font-weight","600"),ht.style.setProperty("color","var(--primary-color)"),l(ht,()=>L(I())),l(Rt,()=>e("inventory.movementType"),Qt),sr.style.setProperty("font-weight","600"),l(sr,()=>j(s())),we(mt=>{var At=$,Ot=$,Jt=$,Zt=$;return mt.e=m(_t,At,mt.e),mt.t=m(ot,Ot,mt.t),mt.a=m($t,Jt,mt.a),mt.o=m(Kt,Zt,mt.o),mt},{e:void 0,t:void 0,a:void 0,o:void 0}),ct})()})(),Ze),l(Ye,()=>e("common.generalNotes")),ut.addEventListener("change",We=>p(We.target.value)),l(K,(()=>{var We=Te(()=>w().length>0);return()=>We()&&(()=>{var ct=Zf();return m(ct,D),l(ct,B(Ut,{get each(){return w()},children:pt=>(()=>{var _t=KE();return _t.firstChild,l(_t,pt,null),_t})()})),ct})()})(),rt),m(rt,H),l(rt,B(xt,{variant:"secondary",type:"button",onClick:_,get children(){return e("common.cancel")}}),null),l(rt,B(xt,{variant:"primary",type:"submit",get children(){return e("inventory.createMovement")}}),null),we(We=>{var ct=ie,pt=F,_t=ie,Et=F,et=e("common.referenceNumberPlaceholder"),Ue=G,ot=ie,Xe=W,at=s()==="transfer"?"1fr 1fr":"1fr",St=ie,$t=G,qt=G,Gt=ie,ht={...F,"min-height":"80px",resize:"vertical"},Kt=e("inventory.generalNotesPlaceholder");return We.e=m(Y,ct,We.e),We.t=m(ae,pt,We.t),We.a=m(le,_t,We.a),We.o=m(ce,Et,We.o),et!==We.i&&Yt(ce,"placeholder",We.i=et),We.n=m(Se,Ue,We.n),We.s=m(me,ot,We.s),We.h=m(xe,Xe,We.h),at!==We.r&&((We.r=at)!=null?Ce.style.setProperty("grid-template-columns",at):Ce.style.removeProperty("grid-template-columns")),We.d=m(Ie,St,We.d),We.l=m(Re,$t,We.l),We.u=m(Ze,qt,We.u),We.c=m(Ye,Gt,We.c),We.w=m(ut,ht,We.w),Kt!==We.m&&Yt(ut,"placeholder",We.m=Kt),We},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),we(()=>ae.value=r()),we(()=>ce.value=i()),we(()=>xe.value=s()),we(()=>ut.value=g()),K})(),B(Ny,{get isOpen(){return V()},onClose:()=>ne(!1),onProductAdded:K=>{ne(!1)}}),B(Ly,{get isOpen(){return X()},onClose:()=>Q(!1),onLocationAdded:K=>{s()==="transfer"&&!h()?y(K):u(K),Q(!1)}})]}})};var QE=de("<button>"),XE=de("<div><h3></h3><button> "),ZE=de("<div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> "),ep=de("<div><strong>:</strong> "),ek=de("<div>"),tk=de("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),rk=de("<div><div><h2></h2><div><select><option value=date></option><option value=quantity></option><option value=value></option></select></div></div><div>"),nk=de("<div><div><h3></h3><div></div></div><div><span></span><div>"),ik=de("<div><div><strong>:</strong> "),ok=de("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),sk=de("<div><button></button><button>"),ak=de("<tr><td></td><td></td><td></td><td></td><td></td><td>");const _5=t=>{const{t:e}=er(),[r,n]=$e(null),[i,o]=$e("date"),s=Tt(()=>{const g=t.movements||lt.movements,p=new Map;return g.forEach(C=>{const S=C.referenceNumber||C.ssg_inventory_key||C.invoiceId||"UNKNOWN";if(!p.has(S)){const V=lt.getLocationById(C.locationId);p.set(S,{referenceNumber:C.referenceNumber||"",invoiceId:C.invoiceId||"",ssg_inventory_key:C.ssg_inventory_key||"",movementType:C.movementType||"unknown",locationId:C.locationId||"",locationName:V?.name||"Unknown Location",totalItems:0,totalQuantity:0,createDate:C.createDate||new Date().toISOString(),description:C.description||"",generalNotes:C.generalNotes||"",movements:[],totalValue:0})}const w=p.get(S);w.movements.push(C),w.totalItems++,w.totalQuantity+=Math.abs(C.quantity||0);const x=lt.getProductById(C.productId);x&&x.unitCost&&(w.totalValue+=Math.abs(C.quantity||0)*x.unitCost)}),Array.from(p.values()).sort((C,S)=>{switch(i()){case"quantity":return S.totalQuantity-C.totalQuantity;case"value":return S.totalValue-C.totalValue;case"date":default:return new Date(S.createDate).getTime()-new Date(C.createDate).getTime()}})}),a=g=>new Date(g).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),c=g=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(g),u=g=>{switch(g.toLowerCase()){case"in":case"stock_in":return"#22c55e";case"out":case"stock_out":return"#ef4444";case"transfer":return"#3b82f6";case"adjustment":return"#f59e0b";default:return"#6b7280"}},h=g=>{switch(g.toLowerCase()){case"in":case"stock_in":return"";case"out":case"stock_out":return"";case"transfer":return"";case"adjustment":return"";default:return""}},y=g=>{const p=g||r();if(!p)return;const C=window.open("","_blank");if(!C)return;const S=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Bulk Movement Report - ${p.referenceNumber||p.invoiceId}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          .header { text-align: center; border-bottom: 2px solid #333; padding-bottom: 10px; margin-bottom: 20px; }
          .group-info { background: #f8f9fa; padding: 15px; margin-bottom: 20px; border-radius: 5px; }
          .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
          table { width: 100%; border-collapse: collapse; margin-top: 15px; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background-color: #f2f2f2; font-weight: bold; }
          .summary { background: #e8f4fd; padding: 15px; margin-top: 20px; border-radius: 5px; }
          @media print { body { margin: 0; } }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>BULK MOVEMENT REPORT</h1>
          <h2>${p.referenceNumber||p.invoiceId}</h2>
          <p>Generated: ${a(new Date().toISOString())}</p>
        </div>
        
        <div class="group-info">
          <div class="info-grid">
            <div>
              <strong>Reference Number:</strong> ${p.referenceNumber||"N/A"}<br>
              <strong>Invoice ID:</strong> ${p.invoiceId||"N/A"}<br>
              <strong>Movement Type:</strong> ${p.movementType.toUpperCase()}<br>
              <strong>Location:</strong> ${p.locationName}
            </div>
            <div>
              <strong>Date:</strong> ${a(p.createDate)}<br>
              <strong>Total Items:</strong> ${p.totalItems}<br>
              <strong>Total Quantity:</strong> ${p.totalQuantity}<br>
              <strong>Estimated Value:</strong> ${c(p.totalValue)}
            </div>
          </div>
          ${p.description?`<p><strong>Description:</strong> ${p.description}</p>`:""}
          ${p.generalNotes?`<p><strong>Notes:</strong> ${p.generalNotes}</p>`:""}
        </div>
        
        <table>
          <thead>
            <tr>
              <th>Product Code</th>
              <th>Product Name</th>
              <th>Quantity</th>
              <th>Unit Cost</th>
              <th>Total Value</th>
              <th>Notes</th>
            </tr>
          </thead>
          <tbody>
            ${p.movements.map(w=>{const x=lt.getProductById(w.productId),V=x?.unitCost||0,ne=Math.abs(w.quantity||0)*V;return`
                <tr>
                  <td>${x?.code||w.productId}</td>
                  <td>${x?.name||"Unknown Product"}</td>
                  <td>${w.quantity||0}</td>
                  <td>${c(V)}</td>
                  <td>${c(ne)}</td>
                  <td>${w.notes||"-"}</td>
                </tr>
              `}).join("")}
          </tbody>
        </table>
        
        <div class="summary">
          <h3>SUMMARY</h3>
          <p><strong>Total Products:</strong> ${p.totalItems}</p>
          <p><strong>Total Quantity Moved:</strong> ${p.totalQuantity}</p>
          <p><strong>Total Estimated Value:</strong> ${c(p.totalValue)}</p>
          <p><strong>Movement Impact:</strong> ${p.movementType==="in"?"Increased":p.movementType==="out"?"Decreased":"Adjusted"} inventory</p>
        </div>
      </body>
      </html>
    `;C.document.write(S),C.document.close(),C.print()};return(()=>{var g=rk(),p=g.firstChild,C=p.firstChild,S=C.nextSibling,w=S.firstChild,x=w.firstChild,V=x.nextSibling,ne=V.nextSibling,X=p.nextSibling;return g.style.setProperty("padding","1rem"),p.style.setProperty("display","flex"),p.style.setProperty("justify-content","space-between"),p.style.setProperty("align-items","center"),p.style.setProperty("margin-bottom","2rem"),l(C,()=>e("inventory.bulkMovementReport","Bulk Movement Report")),S.style.setProperty("display","flex"),S.style.setProperty("gap","1rem"),w.addEventListener("change",Q=>o(Q.currentTarget.value)),w.style.setProperty("padding","0.5rem"),l(x,()=>e("common.sortByDate","Sort by Date")),l(V,()=>e("common.sortByQuantity","Sort by Quantity")),l(ne,()=>e("common.sortByValue","Sort by Value")),l(S,B(Ge,{get when(){return t.onClose},get children(){var Q=QE();return as(Q,"click",t.onClose,!0),Q.style.setProperty("padding","0.5rem 1rem"),Q.style.setProperty("background","#6c757d"),Q.style.setProperty("color","white"),Q.style.setProperty("border","none"),Q.style.setProperty("border-radius","var(--border-radius-sm)"),Q.style.setProperty("cursor","pointer"),l(Q,()=>e("common.close","Close")),Q}}),null),X.style.setProperty("display","grid"),X.style.setProperty("grid-template-columns","repeat(auto-fill, minmax(400px, 1fr))"),X.style.setProperty("gap","1rem"),X.style.setProperty("margin-bottom","2rem"),l(X,B(Ut,{get each(){return s()},children:Q=>B(Nt,{get style(){return{cursor:"pointer",border:r()===Q?"2px solid var(--primary-color)":"1px solid #e9ecef",transition:"all 0.2s"}},onClick:()=>n(Q),get children(){return[(()=>{var ee=nk(),E=ee.firstChild,A=E.firstChild,T=A.nextSibling,R=E.nextSibling,_=R.firstChild,I=_.nextSibling;return ee.style.setProperty("display","flex"),ee.style.setProperty("justify-content","space-between"),ee.style.setProperty("align-items","flex-start"),ee.style.setProperty("margin-bottom","1rem"),A.style.setProperty("margin","0 0 0.5rem 0"),A.style.setProperty("font-size","1.1rem"),l(A,()=>Q.referenceNumber||Q.invoiceId||"No Reference"),T.style.setProperty("font-size","0.875rem"),T.style.setProperty("color","#6c757d"),l(T,()=>a(Q.createDate)),R.style.setProperty("text-align","center"),_.style.setProperty("font-size","1.5rem"),l(_,()=>h(Q.movementType)),I.style.setProperty("font-size","0.75rem"),I.style.setProperty("font-weight","bold"),l(I,()=>Q.movementType.toUpperCase()),we(b=>(b=u(Q.movementType))!=null?I.style.setProperty("color",b):I.style.removeProperty("color")),ee})(),(()=>{var ee=ik(),E=ee.firstChild,A=E.firstChild,T=A.firstChild;return A.nextSibling,ee.style.setProperty("margin-bottom","1rem"),E.style.setProperty("font-size","0.875rem"),E.style.setProperty("margin-bottom","0.25rem"),l(A,()=>e("inventory.location","Location"),T),l(E,()=>Q.locationName,null),l(ee,B(Ge,{get when(){return Q.description},get children(){var R=ep(),_=R.firstChild,I=_.firstChild;return _.nextSibling,R.style.setProperty("font-size","0.875rem"),R.style.setProperty("margin-bottom","0.25rem"),l(_,()=>e("common.description","Description"),I),l(R,()=>Q.description,null),R}}),null),ee})(),(()=>{var ee=ok(),E=ee.firstChild,A=E.firstChild,T=A.nextSibling,R=E.nextSibling,_=R.firstChild,I=_.nextSibling,b=R.nextSibling,G=b.firstChild,ie=G.nextSibling;return ee.style.setProperty("display","grid"),ee.style.setProperty("grid-template-columns","repeat(3, 1fr)"),ee.style.setProperty("gap","0.5rem"),ee.style.setProperty("margin-bottom","1rem"),E.style.setProperty("text-align","center"),E.style.setProperty("padding","0.5rem"),E.style.setProperty("background","#f8f9fa"),E.style.setProperty("border-radius","var(--border-radius-sm)"),A.style.setProperty("font-weight","bold"),A.style.setProperty("color","#3b82f6"),l(A,()=>Q.totalItems),T.style.setProperty("font-size","0.75rem"),T.style.setProperty("color","#6c757d"),l(T,()=>e("inventory.items","Items")),R.style.setProperty("text-align","center"),R.style.setProperty("padding","0.5rem"),R.style.setProperty("background","#f8f9fa"),R.style.setProperty("border-radius","var(--border-radius-sm)"),_.style.setProperty("font-weight","bold"),_.style.setProperty("color","#22c55e"),l(_,()=>Q.totalQuantity),I.style.setProperty("font-size","0.75rem"),I.style.setProperty("color","#6c757d"),l(I,()=>e("inventory.quantity","Quantity")),b.style.setProperty("text-align","center"),b.style.setProperty("padding","0.5rem"),b.style.setProperty("background","#f8f9fa"),b.style.setProperty("border-radius","var(--border-radius-sm)"),G.style.setProperty("font-weight","bold"),G.style.setProperty("color","#f59e0b"),l(G,()=>c(Q.totalValue)),ie.style.setProperty("font-size","0.75rem"),ie.style.setProperty("color","#6c757d"),l(ie,()=>e("common.value","Value")),ee})(),(()=>{var ee=sk(),E=ee.firstChild,A=E.nextSibling;return ee.style.setProperty("display","flex"),ee.style.setProperty("gap","0.5rem"),E.$$click=T=>{T.stopPropagation(),n(Q)},E.style.setProperty("flex","1"),E.style.setProperty("padding","0.5rem"),E.style.setProperty("background","var(--primary-color)"),E.style.setProperty("color","white"),E.style.setProperty("border","none"),E.style.setProperty("border-radius","var(--border-radius-sm)"),E.style.setProperty("cursor","pointer"),E.style.setProperty("font-size","0.875rem"),l(E,()=>e("common.viewDetails","View Details")),A.$$click=T=>{T.stopPropagation(),y(Q)},A.style.setProperty("padding","0.5rem"),A.style.setProperty("background","#22c55e"),A.style.setProperty("color","white"),A.style.setProperty("border","none"),A.style.setProperty("border-radius","var(--border-radius-sm)"),A.style.setProperty("cursor","pointer"),A.style.setProperty("font-size","0.875rem"),ee})()]}})})),l(g,B(Ge,{get when(){return r()},get children(){return B(Nt,{get children(){return[(()=>{var Q=XE(),ee=Q.firstChild,E=ee.nextSibling;return E.firstChild,Q.style.setProperty("display","flex"),Q.style.setProperty("justify-content","space-between"),Q.style.setProperty("align-items","center"),Q.style.setProperty("margin-bottom","1rem"),l(ee,()=>e("inventory.movementDetails","Movement Details")),E.$$click=()=>y(),E.style.setProperty("padding","0.5rem 1rem"),E.style.setProperty("background","#22c55e"),E.style.setProperty("color","white"),E.style.setProperty("border","none"),E.style.setProperty("border-radius","var(--border-radius-sm)"),E.style.setProperty("cursor","pointer"),l(E,()=>e("common.print","Print Report"),null),Q})(),(()=>{var Q=ZE(),ee=Q.firstChild,E=ee.firstChild,A=E.firstChild,T=A.firstChild;A.nextSibling;var R=E.nextSibling,_=R.firstChild,I=_.firstChild;_.nextSibling;var b=R.nextSibling,G=b.firstChild,ie=G.firstChild;G.nextSibling;var F=b.nextSibling,W=F.firstChild,z=W.firstChild;W.nextSibling;var O=ee.nextSibling,k=O.firstChild,re=k.firstChild,$=re.firstChild;re.nextSibling;var D=k.nextSibling,H=D.firstChild,L=H.firstChild;H.nextSibling;var j=D.nextSibling,oe=j.firstChild,K=oe.firstChild;oe.nextSibling;var Z=j.nextSibling,J=Z.firstChild,Y=J.firstChild;return J.nextSibling,Q.style.setProperty("display","grid"),Q.style.setProperty("grid-template-columns","repeat(2, 1fr)"),Q.style.setProperty("gap","1rem"),Q.style.setProperty("margin-bottom","2rem"),Q.style.setProperty("padding","1rem"),Q.style.setProperty("background","#f8f9fa"),Q.style.setProperty("border-radius","var(--border-radius-sm)"),l(A,()=>e("inventory.referenceNumber","Reference"),T),l(E,()=>r()?.referenceNumber||"N/A",null),l(_,()=>e("inventory.invoiceId","Invoice ID"),I),l(R,()=>r()?.invoiceId||"N/A",null),l(G,()=>e("inventory.movementType","Type"),ie),l(b,()=>r()?.movementType.toUpperCase(),null),l(W,()=>e("inventory.location","Location"),z),l(F,()=>r()?.locationName,null),l(re,()=>e("common.date","Date"),$),l(k,(()=>{var U=Te(()=>!!r());return()=>U()?a(r().createDate):""})(),null),l(H,()=>e("inventory.totalItems","Total Items"),L),l(D,()=>r()?.totalItems,null),l(oe,()=>e("inventory.totalQuantity","Total Quantity"),K),l(j,()=>r()?.totalQuantity,null),l(J,()=>e("common.estimatedValue","Estimated Value"),Y),l(Z,(()=>{var U=Te(()=>!!r());return()=>U()?c(r().totalValue):""})(),null),Q})(),B(Ge,{get when(){return r()?.description||r()?.generalNotes},get children(){var Q=ek();return Q.style.setProperty("margin-bottom","2rem"),Q.style.setProperty("padding","1rem"),Q.style.setProperty("background","#e8f4fd"),Q.style.setProperty("border-radius","var(--border-radius-sm)"),l(Q,B(Ge,{get when(){return r()?.description},get children(){var ee=ep(),E=ee.firstChild,A=E.firstChild;return E.nextSibling,l(E,()=>e("common.description","Description"),A),l(ee,()=>r()?.description,null),ee}}),null),l(Q,B(Ge,{get when(){return r()?.generalNotes},get children(){var ee=ep(),E=ee.firstChild,A=E.firstChild;return E.nextSibling,l(E,()=>e("common.notes","Notes"),A),l(ee,()=>r()?.generalNotes,null),ee}}),null),Q}}),(()=>{var Q=tk(),ee=Q.firstChild,E=ee.firstChild,A=E.firstChild,T=A.firstChild,R=T.nextSibling,_=R.nextSibling,I=_.nextSibling,b=I.nextSibling,G=b.nextSibling,ie=E.nextSibling;return Q.style.setProperty("overflow-x","auto"),ee.style.setProperty("width","100%"),ee.style.setProperty("border-collapse","collapse"),A.style.setProperty("border-bottom","2px solid #dee2e6"),T.style.setProperty("padding","0.75rem"),T.style.setProperty("text-align","left"),l(T,()=>e("inventory.productCode","Code")),R.style.setProperty("padding","0.75rem"),R.style.setProperty("text-align","left"),l(R,()=>e("inventory.productName","Product")),_.style.setProperty("padding","0.75rem"),_.style.setProperty("text-align","center"),l(_,()=>e("inventory.quantity","Quantity")),I.style.setProperty("padding","0.75rem"),I.style.setProperty("text-align","right"),l(I,()=>e("inventory.unitCost","Unit Cost")),b.style.setProperty("padding","0.75rem"),b.style.setProperty("text-align","right"),l(b,()=>e("common.totalValue","Total Value")),G.style.setProperty("padding","0.75rem"),G.style.setProperty("text-align","left"),l(G,()=>e("common.notes","Notes")),l(ie,B(Ut,{get each(){return r()?.movements||[]},children:F=>{const W=lt.getProductById(F.productId),z=W?.unitCost||0,O=Math.abs(F.quantity||0)*z;return(()=>{var k=ak(),re=k.firstChild,$=re.nextSibling,D=$.nextSibling,H=D.nextSibling,L=H.nextSibling,j=L.nextSibling;return k.style.setProperty("border-bottom","1px solid #dee2e6"),re.style.setProperty("padding","0.75rem"),re.style.setProperty("font-family","monospace"),l(re,()=>W?.code||F.productId),$.style.setProperty("padding","0.75rem"),l($,()=>W?.name||"Unknown Product"),D.style.setProperty("padding","0.75rem"),D.style.setProperty("text-align","center"),D.style.setProperty("font-weight","bold"),l(D,()=>F.quantity||0),H.style.setProperty("padding","0.75rem"),H.style.setProperty("text-align","right"),l(H,()=>c(z)),L.style.setProperty("padding","0.75rem"),L.style.setProperty("text-align","right"),L.style.setProperty("font-weight","bold"),l(L,()=>c(O)),j.style.setProperty("padding","0.75rem"),j.style.setProperty("font-size","0.875rem"),j.style.setProperty("color","#6c757d"),l(j,()=>F.notes||"-"),we(oe=>(oe=(F.quantity||0)>=0?"#22c55e":"#ef4444")!=null?D.style.setProperty("color",oe):D.style.removeProperty("color")),k})()}})),Q})()]}})}}),null),we(()=>w.value=i()),g})()};dr(["click"]);var lk=de("<div><div><div><h2>Bulk Movement Report - </h2><button></button></div><div>");const ck=t=>{const[e,r]=$e(!0),[n,i]=$e(!1),[o,s]=$e([]),[a,c]=$e(""),u=g=>{const p=lt.movements.filter(C=>C.referenceNumber===g||C.invoiceId===g||C.ssg_inventory_key===g);s(p),c(g),r(!1),i(!0)},h=()=>{r(!1),t.onClose()},y=()=>{i(!1),t.onClose()};return[B(Ge,{get when(){return e()},get children(){return B(JE,{get isOpen(){return Te(()=>!!t.isOpen)()&&e()},onClose:h,onMovementComplete:u})}}),B(Ge,{get when(){return n()},get children(){var g=lk(),p=g.firstChild,C=p.firstChild,S=C.firstChild;S.firstChild;var w=S.nextSibling,x=C.nextSibling;return g.style.setProperty("position","fixed"),g.style.setProperty("top","0"),g.style.setProperty("left","0"),g.style.setProperty("right","0"),g.style.setProperty("bottom","0"),g.style.setProperty("background","rgba(0, 0, 0, 0.5)"),g.style.setProperty("z-index","1000"),g.style.setProperty("display","flex"),g.style.setProperty("align-items","center"),g.style.setProperty("justify-content","center"),g.style.setProperty("padding","2rem"),p.style.setProperty("background","white"),p.style.setProperty("border-radius","var(--border-radius)"),p.style.setProperty("width","95%"),p.style.setProperty("max-width","1200px"),p.style.setProperty("max-height","90vh"),p.style.setProperty("overflow-y","auto"),p.style.setProperty("position","relative"),C.style.setProperty("padding","1rem 2rem"),C.style.setProperty("border-bottom","1px solid #e9ecef"),C.style.setProperty("display","flex"),C.style.setProperty("justify-content","space-between"),C.style.setProperty("align-items","center"),C.style.setProperty("background","#f8f9fa"),S.style.setProperty("margin","0"),l(S,a,null),w.$$click=y,w.style.setProperty("background","none"),w.style.setProperty("border","none"),w.style.setProperty("font-size","1.5rem"),w.style.setProperty("cursor","pointer"),w.style.setProperty("padding","0.5rem"),w.style.setProperty("line-height","1"),x.style.setProperty("padding","1rem"),l(x,B(_5,{get movements(){return o()},onClose:y})),g}})]};dr(["click"]);var uk=de("<div><div></div><div></div><div></div><div>"),dk=de("<div><strong>:</strong> "),hk=de("<div><div><span></span><span></span></div><div><span></span><span> </span></div><div><span></span><span> </span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),fk=de("<div>");const pk=t=>{const{t:e}=er(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},i={"font-weight":"600",color:"var(--text-primary)"},o={"text-align":"center","margin-bottom":"2rem"},s={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},a={color:"var(--text-muted)","font-size":"1rem"},c={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"1rem"},u=(S,w)=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:S>w?"#d4edda":"#f8d7da",color:S>w?"#155724":"#721c24"}),h={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},y={"margin-bottom":"1.5rem",padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",color:"var(--text-secondary)"};if(!t.item)return null;const g=S=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(S),p=S=>new Date(S).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),C=t.item.price*t.item.quantity;return B(Xn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.itemDetails")},get children(){return[(()=>{var S=uk(),w=S.firstChild,x=w.nextSibling,V=x.nextSibling,ne=V.nextSibling;return m(S,o),m(w,s),l(w,()=>t.item.name),m(x,a),l(x,()=>t.item.category),m(V,c),l(V,()=>g(t.item.price)),l(ne,(()=>{var X=Te(()=>t.item.quantity>t.item.minStock);return()=>X()?e("inventory.inStock"):e("inventory.lowStockAlert")})()),we(X=>m(ne,u(t.item.quantity,t.item.minStock),X)),S})(),(()=>{var S=dk(),w=S.firstChild,x=w.firstChild;return w.nextSibling,m(S,y),l(w,()=>e("common.description"),x),l(S,()=>t.item.description,null),S})(),(()=>{var S=hk(),w=S.firstChild,x=w.firstChild,V=x.nextSibling,ne=w.nextSibling,X=ne.firstChild,Q=X.nextSibling,ee=Q.firstChild,E=ne.nextSibling,A=E.firstChild,T=A.nextSibling,R=T.firstChild,_=E.nextSibling,I=_.firstChild,b=I.nextSibling,G=_.nextSibling,ie=G.firstChild,F=ie.nextSibling,W=G.nextSibling,z=W.firstChild,O=z.nextSibling,k=W.nextSibling,re=k.firstChild,$=re.nextSibling;return l(x,()=>e("inventory.sku")),l(V,()=>t.item.sku),l(X,()=>e("inventory.quantity")),l(Q,()=>t.item.quantity,ee),l(Q,()=>e("common.units"),null),l(A,()=>e("inventory.minimumStock")),l(T,()=>t.item.minStock,R),l(T,()=>e("common.units"),null),l(I,()=>e("inventory.totalValue")),l(b,()=>g(C)),l(ie,()=>e("inventory.supplier")),l(F,()=>t.item.supplier),l(z,()=>e("inventory.location")),l(O,()=>t.item.location),l(re,()=>e("common.lastUpdated")),l($,()=>p(t.item.lastUpdated)),we(D=>{var H=r,L=n,j=i,oe=r,K=n,Z=i,J=r,Y=n,U=i,ae=r,ue=n,le=i,q=r,ce=n,Se=i,me=r,Pe=n,xe=i,he=r,ve=n,De=i;return D.e=m(w,H,D.e),D.t=m(x,L,D.t),D.a=m(V,j,D.a),D.o=m(ne,oe,D.o),D.i=m(X,K,D.i),D.n=m(Q,Z,D.n),D.s=m(E,J,D.s),D.h=m(A,Y,D.h),D.r=m(T,U,D.r),D.d=m(_,ae,D.d),D.l=m(I,ue,D.l),D.u=m(b,le,D.u),D.c=m(G,q,D.c),D.w=m(ie,ce,D.w),D.m=m(F,Se,D.m),D.f=m(W,me,D.f),D.y=m(z,Pe,D.y),D.g=m(O,xe,D.g),D.p=m(k,he,D.p),D.b=m(re,ve,D.b),D.T=m($,De,D.T),D},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),S})(),(()=>{var S=fk();return m(S,h),l(S,B(xt,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),l(S,B(xt,{variant:"primary",onClick:()=>{console.log("Edit item:",t.item.id)},get children(){return e("common.editItem")}}),null),S})()]}})};var mk=de("<div>"),yk=de("<button type=button>"),gk=de("<div> "),d0=de("<div>"),vk=de("<div><div><input type=text autocomplete=off>"),bk=de("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div>"),_k=de("<span> ");const wk=t=>{const{t:e}=er(),[r,n]=$e(""),[i,o]=$e(!1),[s,a]=$e(null),[c,u]=$e([]),[h,y]=$e(!1),[g,p]=$e(-1),[C,S]=$e(null),w=t.searchDelay||300;t.maxResults;const x=async H=>{if(!H.trim()||H.trim().length<3){u([]),t.onSearchResults?.([]);return}try{o(!0),a(null);try{console.log("apiResults",H),t.onSearchResults?.(H)}catch(L){console.warn("API search failed, using local fallback:",L),a("API search failed, showing local results")}}catch(L){const j=L instanceof Error?L.message:"Search failed";a(j),u([]),t.onSearchResults?.([])}finally{o(!1)}},V=H=>{const j=H.target.value;n(j),a(null),console.log(),t.showResults,C()&&clearTimeout(C());const oe=setTimeout(()=>{x(j)},w);S(oe)},ne=H=>{n(H.name),y(!1),p(-1),t.onInventorySelect?.(H)},X=H=>{if(!(!h()||c().length===0))switch(H.key){case"ArrowDown":H.preventDefault(),p(L=>Math.min(L+1,c().length-1));break;case"ArrowUp":H.preventDefault(),p(L=>Math.max(L-1,-1));break;case"Enter":H.preventDefault(),g()>=0&&c()[g()]&&ne(c()[g()]);break;case"Escape":y(!1),p(-1);break}},Q=()=>{t.showResults!==!1&&c().length>0&&y(!0)},ee=()=>{setTimeout(()=>{y(!1),p(-1)},150)},E=()=>{n(""),u([]),a(null),y(!1),p(-1),t.onSearchResults?.([]),C()&&(clearTimeout(C()),S(null))},A=H=>lt.stockLevels.filter(L=>L.inventoryId===H).reduce((L,j)=>L+j.quantity,0),T=H=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(H),R={position:"relative",width:"100%",...t.style},_={position:"relative",display:"flex","align-items":"center"},I={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},b={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},G={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},ie={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},F=H=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:H?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),W={display:"flex","justify-content":"space-between","align-items":"center"},z={flex:"1"},O={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},k={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},re={"text-align":"right","font-size":"0.875rem"},$={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},D={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var H=vk(),L=H.firstChild,j=L.firstChild;return j.addEventListener("blur",ee),j.addEventListener("focus",Q),j.$$keydown=X,j.$$input=V,l(L,B(Ge,{get when(){return i()},get children(){var oe=mk();return we(K=>m(oe,G,K)),oe}}),null),l(L,B(Ge,{get when(){return Te(()=>!!r())()&&!i()},get children(){var oe=yk();return oe.addEventListener("mouseleave",K=>{K.currentTarget.style.background="none",K.currentTarget.style.color="var(--text-muted)"}),oe.addEventListener("mouseenter",K=>{K.currentTarget.style.background="var(--border-color)",K.currentTarget.style.color="var(--text-primary)"}),oe.$$click=E,we(K=>{var Z=b,J=e("common.clear","Clear search");return K.e=m(oe,Z,K.e),J!==K.t&&Yt(oe,"title",K.t=J),K},{e:void 0,t:void 0}),oe}}),null),l(H,B(Ge,{get when(){return h()&&t.showResults!==!1},get children(){var oe=d0();return l(oe,B(Ge,{get when(){return s()},get children(){var K=gk();return K.firstChild,m(K,D),l(K,s,null),K}}),null),l(oe,B(Ge,{get when(){return c().length>0},get fallback(){return Te(()=>!!(r()&&!i()))()&&(()=>{var K=d0();return m(K,$),l(K,()=>e("inventory.noInventorysFound","No inventorys found matching your search.")),K})()},get children(){return B(Ut,{get each(){return c()},children:(K,Z)=>{const J=A(K.id),Y=J<=K.minStockLevel;return(()=>{var U=bk(),ae=U.firstChild,ue=ae.firstChild,le=ue.firstChild,q=le.nextSibling,ce=q.firstChild,Se=ce.firstChild,me=ce.nextSibling,Pe=me.nextSibling,xe=Pe.nextSibling,he=xe.nextSibling,ve=ue.nextSibling,De=ve.firstChild,ke=De.firstChild,Ce=De.nextSibling;return U.addEventListener("mouseenter",()=>p(Z())),U.$$click=()=>ne(K),m(ae,W),m(ue,z),m(le,O),l(le,()=>K.name),m(q,k),l(ce,()=>e("inventory.sku","SKU"),Se),l(ce,()=>K.sku,null),l(Pe,()=>K.category),l(he,()=>T(K.unitCost)),m(ve,re),De.style.setProperty("font-weight","600"),(Y?"#f44336":"var(--text-primary)")!=null?De.style.setProperty("color",Y?"#f44336":"var(--text-primary)"):De.style.removeProperty("color"),l(De,J,ke),l(De,()=>K.unitOfMeasure,null),Ce.style.setProperty("color","var(--text-muted)"),l(Ce,()=>Y?(()=>{var Le=_k();return Le.firstChild,Le.style.setProperty("color","#f44336"),l(Le,()=>e("inventory.lowStock","Low Stock"),null),Le})():e("inventory.inStock","In Stock")),we(Le=>m(U,F(Z()===g()),Le)),U})()}})}}),null),we(K=>m(oe,ie,K)),oe}}),null),we(oe=>{var K=R,Z=_,J=I,Y=t.placeholder||e("inventory.searchInventorys","Search inventorys by name, SKU, or category..."),U=t.disabled;return oe.e=m(H,K,oe.e),oe.t=m(L,Z,oe.t),oe.a=m(j,J,oe.a),Y!==oe.o&&Yt(j,"placeholder",oe.o=Y),U!==oe.i&&(j.disabled=oe.i=U),oe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),we(()=>j.value=r()),H})()};dr(["input","keydown","click"]);var Sk=de("<div>"),tp=de("<div><span>:</span><span>"),Pk=de("<div><button> "),xk=de("<div><div><div><h3></h3><div>: </div></div><div><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span> <!>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span>");const Ak=t=>{const{t:e}=er(),r=p=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(p),n=p=>new Date(p).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),i=p=>({in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}})[p]||{bg:"#f5f5f5",color:"#666"},o=p=>({in:"",out:"",transfer:"",adjustment:""})[p]||"",s=()=>t.movement,a={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},c={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},u={"font-weight":"600",color:"var(--text-primary)","text-align":"right"},h={"margin-bottom":"1.5rem"},y={"font-weight":"600","margin-bottom":"0.75rem","padding-bottom":"0.5rem","border-bottom":"2px solid var(--border-color)"},g=p=>({display:"inline-flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"600","text-transform":"uppercase","letter-spacing":"0.5px",background:i(p).bg,color:i(p).color});return B(Xn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.movementDetails")},size:"lg",get children(){return B(Ge,{get when(){return s()},get fallback(){return(()=>{var p=Sk();return l(p,()=>e("common.noDataFound")),p})()},children:p=>(()=>{var C=xk(),S=C.firstChild,w=S.firstChild,x=w.firstChild,V=x.nextSibling,ne=V.firstChild,X=w.nextSibling,Q=X.firstChild,ee=S.nextSibling,E=ee.firstChild,A=E.nextSibling,T=A.firstChild,R=T.firstChild,_=T.nextSibling,I=A.nextSibling,b=I.firstChild,G=b.firstChild,ie=b.nextSibling,F=ie.firstChild,W=I.nextSibling,z=W.firstChild,O=z.firstChild,k=z.nextSibling,re=W.nextSibling,$=re.firstChild,D=$.firstChild,H=D.nextSibling;H.nextSibling;var L=$.nextSibling,j=ee.nextSibling,oe=j.firstChild,K=oe.nextSibling,Z=K.firstChild,J=Z.firstChild,Y=Z.nextSibling,U=j.nextSibling,ae=U.firstChild,ue=ae.nextSibling,le=ue.firstChild,q=le.firstChild,ce=le.nextSibling,Se=ue.nextSibling,me=Se.firstChild,Pe=me.firstChild,xe=me.nextSibling;return S.style.setProperty("display","flex"),S.style.setProperty("justify-content","space-between"),S.style.setProperty("align-items","center"),S.style.setProperty("margin-bottom","1.5rem"),S.style.setProperty("padding-bottom","1rem"),S.style.setProperty("border-bottom","2px solid var(--border-color)"),x.style.setProperty("margin","0 0 0.5rem 0"),x.style.setProperty("font-size","1.25rem"),l(x,()=>p().productName),V.style.setProperty("font-size","0.875rem"),V.style.setProperty("color","var(--text-muted)"),l(V,()=>e("inventory.sku"),ne),l(V,()=>p().productSku,null),X.$$click=()=>lt.generateMovementInvoice(p().id,e),Q.style.setProperty("font-size","1.2rem"),l(Q,()=>o(p().movementType)),l(X,()=>p().movementType,null),l(E,()=>e("inventory.movementInformation")),l(T,()=>e("inventory.referenceNumber"),R),l(_,()=>p().referenceNumber),l(b,()=>e("common.quantity"),G),l(ie,()=>p().quantity,F),l(ie,()=>e("common.units"),null),l(z,()=>e("inventory.unitCost"),O),l(k,()=>r(p().unitCost)),l($,()=>e("common.total"),D),l($,()=>e("common.value"),H),l(L,()=>r(p().totalCost)),l(oe,()=>e("inventory.locationInformation")),l(Z,()=>e("inventory.location"),J),l(Y,()=>p().locationName),l(j,B(Ge,{get when(){return p().fromLocationName},get children(){var he=tp(),ve=he.firstChild,De=ve.firstChild,ke=ve.nextSibling;return l(ve,()=>e("common.from"),De),l(ke,()=>p().fromLocationName),we(Ce=>{var Le=a,Ie=c,Re=u;return Ce.e=m(he,Le,Ce.e),Ce.t=m(ve,Ie,Ce.t),Ce.a=m(ke,Re,Ce.a),Ce},{e:void 0,t:void 0,a:void 0}),he}}),null),l(j,B(Ge,{get when(){return p().invoiceId},get children(){var he=tp(),ve=he.firstChild,De=ve.firstChild,ke=ve.nextSibling;return l(ve,()=>e("common.invoice"),De),l(ke,()=>p().invoiceId),we(Ce=>{var Le=a,Ie=c,Re={...u,color:"var(--primary-color)"};return Ce.e=m(he,Le,Ce.e),Ce.t=m(ve,Ie,Ce.t),Ce.a=m(ke,Re,Ce.a),Ce},{e:void 0,t:void 0,a:void 0}),he}}),null),l(ae,()=>e("common.details")),l(le,()=>e("common.createdBy"),q),l(ce,()=>p().createdBy),l(me,()=>e("common.created"),Pe),l(xe,()=>n(p().createdDate)),l(U,B(Ge,{get when(){return p().notes},get children(){var he=tp(),ve=he.firstChild,De=ve.firstChild,ke=ve.nextSibling;return l(ve,()=>e("common.notes"),De),l(ke,()=>p().notes),we(Ce=>{var Le={...a,"border-bottom":"none"},Ie=c,Re={...u,"font-style":"italic","max-width":"60%","white-space":"pre-wrap"};return Ce.e=m(he,Le,Ce.e),Ce.t=m(ve,Ie,Ce.t),Ce.a=m(ke,Re,Ce.a),Ce},{e:void 0,t:void 0,a:void 0}),he}}),null),l(C,B(Ge,{get when(){return t.onEdit},get children(){var he=Pk(),ve=he.firstChild,De=ve.firstChild;return he.style.setProperty("display","flex"),he.style.setProperty("justify-content","flex-end"),he.style.setProperty("margin-top","1.5rem"),he.style.setProperty("padding-top","1rem"),he.style.setProperty("border-top","1px solid var(--border-color)"),ve.addEventListener("mouseleave",ke=>{ke.currentTarget.style.transform="translateY(0)",ke.currentTarget.style.boxShadow="none"}),ve.addEventListener("mouseenter",ke=>{ke.currentTarget.style.transform="translateY(-1px)",ke.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)"}),ve.$$click=()=>t.onEdit?.(p()),ve.style.setProperty("padding","0.5rem 1.5rem"),ve.style.setProperty("border-radius","var(--border-radius-sm)"),ve.style.setProperty("border","1px solid var(--primary-color)"),ve.style.setProperty("background","var(--primary-color)"),ve.style.setProperty("color","white"),ve.style.setProperty("cursor","pointer"),ve.style.setProperty("font-weight","500"),ve.style.setProperty("transition","all 0.2s ease"),l(ve,()=>e("common.edit"),De),l(ve,()=>e("inventory.movement"),null),he}}),null),we(he=>{var ve=g(p().movementType),De=h,ke=y,Ce=a,Le=c,Ie=u,Re=a,He=c,Me={...u,"font-size":"1.1rem",color:"var(--primary-color)"},Ze=a,Ye=c,ut=u,rt=a,We=c,ct={...u,"font-size":"1.1rem",color:"var(--primary-color)"},pt=h,_t=y,Et=a,et=c,Ue=u,ot=h,Xe=y,at=a,St=c,$t=u,qt=a,Gt=c,ht=u;return he.e=m(X,ve,he.e),he.t=m(ee,De,he.t),he.a=m(E,ke,he.a),he.o=m(A,Ce,he.o),he.i=m(T,Le,he.i),he.n=m(_,Ie,he.n),he.s=m(I,Re,he.s),he.h=m(b,He,he.h),he.r=m(ie,Me,he.r),he.d=m(W,Ze,he.d),he.l=m(z,Ye,he.l),he.u=m(k,ut,he.u),he.c=m(re,rt,he.c),he.w=m($,We,he.w),he.m=m(L,ct,he.m),he.f=m(j,pt,he.f),he.y=m(oe,_t,he.y),he.g=m(K,Et,he.g),he.p=m(Z,et,he.p),he.b=m(Y,Ue,he.b),he.T=m(U,ot,he.T),he.A=m(ae,Xe,he.A),he.O=m(ue,at,he.O),he.I=m(le,St,he.I),he.S=m(ce,$t,he.S),he.W=m(Se,qt,he.W),he.C=m(me,Gt,he.C),he.B=m(xe,ht,he.B),he},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),C})()})}})};dr(["click"]);var il=de("<div>"),Ck=de("<div><label></label><select><option value>"),Ik=de("<div><div><span>:</span><span>$"),$k=de("<form><div><label></label><select><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><input type=number min=0.01 step=0.01></div><div><label></label><input type=number min=0 step=0.01></div><div><label></label><input type=text></div><div><label> (<!>)</label><input type=text></div><div><label> (<!>)</label><textarea></textarea></div><div><button type=button></button><button type=submit>"),h0=de("<option> (<!>)");const Ek=t=>{const{t:e}=er(),[r,n]=$e("in"),[i,o]=$e(""),[s,a]=$e(""),[c,u]=$e(""),[h,y]=$e(""),[g,p]=$e(""),[C,S]=$e(""),[w,x]=$e(""),[V,ne]=$e(!1),[X,Q]=$e({});vo(()=>{const G=t.movement;G&&t.isOpen&&(n(G.movementType),o(G.quantity.toString()),a(G.unitCost.toString()),u(G.referenceNumber),y(G.notes),S(G.locationId),p(G.fromLocationId||""),x(G.invoiceId||""),Q({}))});const ee=()=>{const G={};return(!i()||parseFloat(i())<=0)&&(G.quantity=e("forms.requiredField")),(!s()||parseFloat(s())<0)&&(G.unitCost=e("forms.requiredField")),c().trim()||(G.referenceNumber=e("forms.requiredField")),C()||(G.locationId=e("forms.requiredField")),r()==="transfer"&&!g()&&(G.fromLocationId=e("forms.requiredField")),Q(G),Object.keys(G).length===0},E=async G=>{if(G.preventDefault(),!(!ee()||!t.movement)){ne(!0);try{const ie=t.movement,F=lt.getProductById(ie.productId),W=lt.getLocationById(C()),z=g()?lt.getLocationById(g()):null;if(!F||!W)throw new Error("Product or location not found");const O={...ie,movementType:r(),quantity:parseFloat(i()),unitCost:parseFloat(s()),totalCost:parseFloat(i())*parseFloat(s()),referenceNumber:c().trim(),notes:h().trim(),locationId:C(),locationName:W.name,fromLocationId:g()||void 0,fromLocationName:z?.name,invoiceId:w().trim()||void 0,lastModified:new Date().toISOString()};lt.updateMovement(ie.id,O),t.onMovementUpdated?.(),t.onClose(),A()}catch(ie){console.error("Error updating movement:",ie),Q({submit:e("forms.saveError")})}finally{ne(!1)}}},A=()=>{n("in"),o(""),a(""),u(""),y(""),p(""),S(""),x(""),Q({})},T=()=>{A(),t.onClose()},R={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",transition:"border-color 0.2s ease"},_={display:"block","margin-bottom":"0.25rem","font-weight":"500","font-size":"0.875rem"},I={color:"#d32f2f","font-size":"0.75rem","margin-top":"0.25rem"},b={"margin-bottom":"1rem"};return B(Xn,{get isOpen(){return t.isOpen},onClose:T,get title(){return e("inventory.editMovement","Edit Movement")},get children(){return B(Ge,{get when(){return t.movement},get fallback(){return(()=>{var G=il();return l(G,()=>e("common.loading")),G})()},get children(){var G=$k(),ie=G.firstChild,F=ie.firstChild,W=F.nextSibling,z=W.firstChild,O=z.nextSibling,k=O.nextSibling,re=k.nextSibling,$=ie.nextSibling,D=$.firstChild,H=D.nextSibling,L=H.firstChild,j=$.nextSibling,oe=j.firstChild,K=oe.nextSibling,Z=j.nextSibling,J=Z.firstChild,Y=J.nextSibling,U=Z.nextSibling,ae=U.firstChild,ue=ae.nextSibling,le=U.nextSibling,q=le.firstChild,ce=q.firstChild,Se=ce.nextSibling;Se.nextSibling;var me=q.nextSibling,Pe=le.nextSibling,xe=Pe.firstChild,he=xe.firstChild,ve=he.nextSibling;ve.nextSibling;var De=xe.nextSibling,ke=Pe.nextSibling,Ce=ke.firstChild,Le=Ce.nextSibling;return G.addEventListener("submit",E),l(F,()=>e("inventory.movementType")),W.addEventListener("change",Ie=>n(Ie.target.value)),l(z,()=>e("inventory.stockIn")),l(O,()=>e("inventory.stockOut")),l(k,()=>e("inventory.transfer")),l(re,()=>e("inventory.adjustment")),l(D,(()=>{var Ie=Te(()=>r()==="transfer");return()=>Ie()?e("inventory.toLocation"):e("inventory.location")})()),H.addEventListener("change",Ie=>S(Ie.target.value)),l(L,()=>e("modals.selectLocation")),l(H,B(Ut,{get each(){return lt.getActiveLocations()},children:Ie=>(()=>{var Re=h0(),He=Re.firstChild,Me=He.nextSibling;return Me.nextSibling,l(Re,()=>Ie.name,He),l(Re,()=>Ie.type,Me),we(()=>Re.value=Ie.id),Re})()}),null),l($,B(Ge,{get when(){return X().locationId},get children(){var Ie=il();return l(Ie,()=>X().locationId),we(Re=>m(Ie,I,Re)),Ie}}),null),l(G,B(Ge,{get when(){return r()==="transfer"},get children(){var Ie=Ck(),Re=Ie.firstChild,He=Re.nextSibling,Me=He.firstChild;return l(Re,()=>e("inventory.fromLocation")),He.addEventListener("change",Ze=>p(Ze.target.value)),l(Me,()=>e("modals.selectLocation")),l(He,B(Ut,{get each(){return lt.getActiveLocations().filter(Ze=>Ze.id!==C())},children:Ze=>(()=>{var Ye=h0(),ut=Ye.firstChild,rt=ut.nextSibling;return rt.nextSibling,l(Ye,()=>Ze.name,ut),l(Ye,()=>Ze.type,rt),we(()=>Ye.value=Ze.id),Ye})()}),null),l(Ie,B(Ge,{get when(){return X().fromLocationId},get children(){var Ze=il();return l(Ze,()=>X().fromLocationId),we(Ye=>m(Ze,I,Ye)),Ze}}),null),we(Ze=>{var Ye=b,ut=_,rt={...R,"border-color":X().fromLocationId?"#d32f2f":"var(--border-color)"},We=V();return Ze.e=m(Ie,Ye,Ze.e),Ze.t=m(Re,ut,Ze.t),Ze.a=m(He,rt,Ze.a),We!==Ze.o&&(He.disabled=Ze.o=We),Ze},{e:void 0,t:void 0,a:void 0,o:void 0}),we(()=>He.value=g()),Ie}}),j),l(oe,()=>e("common.quantity")),K.$$input=Ie=>o(Ie.target.value),l(j,B(Ge,{get when(){return X().quantity},get children(){var Ie=il();return l(Ie,()=>X().quantity),we(Re=>m(Ie,I,Re)),Ie}}),null),l(J,()=>e("inventory.unitCost")),Y.$$input=Ie=>a(Ie.target.value),l(Z,B(Ge,{get when(){return X().unitCost},get children(){var Ie=il();return l(Ie,()=>X().unitCost),we(Re=>m(Ie,I,Re)),Ie}}),null),l(G,B(Ge,{get when(){return Te(()=>!!i())()&&s()},get children(){var Ie=Ik(),Re=Ie.firstChild,He=Re.firstChild,Me=He.firstChild,Ze=He.nextSibling;return Ze.firstChild,Re.style.setProperty("display","flex"),Re.style.setProperty("justify-content","space-between"),He.style.setProperty("font-weight","500"),l(He,()=>e("common.total"),Me),Ze.style.setProperty("font-weight","600"),Ze.style.setProperty("color","var(--primary-color)"),l(Ze,()=>(parseFloat(i()||"0")*parseFloat(s()||"0")).toFixed(2),null),we(Ye=>m(Ie,{...b,padding:"0.75rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)"},Ye)),Ie}}),U),l(ae,()=>e("inventory.referenceNumber")),ue.$$input=Ie=>u(Ie.target.value),l(U,B(Ge,{get when(){return X().referenceNumber},get children(){var Ie=il();return l(Ie,()=>X().referenceNumber),we(Re=>m(Ie,I,Re)),Ie}}),null),l(q,()=>e("inventory.invoiceNumber"),ce),l(q,()=>e("common.optional"),Se),me.$$input=Ie=>x(Ie.target.value),l(xe,()=>e("common.notes"),he),l(xe,()=>e("common.optional"),ve),De.$$input=Ie=>y(Ie.target.value),l(G,B(Ge,{get when(){return X().submit},get children(){var Ie=il();return l(Ie,()=>X().submit),we(Re=>m(Ie,{...I,"margin-bottom":"1rem"},Re)),Ie}}),ke),ke.style.setProperty("display","flex"),ke.style.setProperty("gap","1rem"),ke.style.setProperty("justify-content","flex-end"),Ce.$$click=T,Ce.style.setProperty("padding","0.5rem 1rem"),Ce.style.setProperty("border","1px solid var(--border-color)"),Ce.style.setProperty("border-radius","var(--border-radius-sm)"),Ce.style.setProperty("background","white"),Ce.style.setProperty("cursor","pointer"),l(Ce,()=>e("common.cancel")),Le.style.setProperty("padding","0.5rem 1rem"),Le.style.setProperty("border","none"),Le.style.setProperty("border-radius","var(--border-radius-sm)"),Le.style.setProperty("background","var(--primary-color)"),Le.style.setProperty("color","white"),Le.style.setProperty("cursor","pointer"),Le.style.setProperty("font-weight","500"),l(Le,(()=>{var Ie=Te(()=>!!V());return()=>Ie()?e("modals.processing"):e("inventory.updateMovement","Update Movement")})()),we(Ie=>{var Re=b,He=_,Me=R,Ze=V(),Ye=b,ut=_,rt={...R,"border-color":X().locationId?"#d32f2f":"var(--border-color)"},We=V(),ct=b,pt=_,_t={...R,"border-color":X().quantity?"#d32f2f":"var(--border-color)"},Et=e("modals.enterQuantity"),et=V(),Ue=b,ot=_,Xe={...R,"border-color":X().unitCost?"#d32f2f":"var(--border-color)"},at=e("modals.enterCost"),St=V(),$t=b,qt=_,Gt={...R,"border-color":X().referenceNumber?"#d32f2f":"var(--border-color)"},ht=e("modals.enterReference"),Kt=V(),Rt=b,Qt=_,sr=R,mt=e("inventory.invoiceNumber"),At=V(),Ot=b,Jt=_,Zt={...R,resize:"vertical","min-height":"80px"},Ht=e("modals.addNotes"),tt=V(),jt=V(),yt=V();return Ie.e=m(ie,Re,Ie.e),Ie.t=m(F,He,Ie.t),Ie.a=m(W,Me,Ie.a),Ze!==Ie.o&&(W.disabled=Ie.o=Ze),Ie.i=m($,Ye,Ie.i),Ie.n=m(D,ut,Ie.n),Ie.s=m(H,rt,Ie.s),We!==Ie.h&&(H.disabled=Ie.h=We),Ie.r=m(j,ct,Ie.r),Ie.d=m(oe,pt,Ie.d),Ie.l=m(K,_t,Ie.l),Et!==Ie.u&&Yt(K,"placeholder",Ie.u=Et),et!==Ie.c&&(K.disabled=Ie.c=et),Ie.w=m(Z,Ue,Ie.w),Ie.m=m(J,ot,Ie.m),Ie.f=m(Y,Xe,Ie.f),at!==Ie.y&&Yt(Y,"placeholder",Ie.y=at),St!==Ie.g&&(Y.disabled=Ie.g=St),Ie.p=m(U,$t,Ie.p),Ie.b=m(ae,qt,Ie.b),Ie.T=m(ue,Gt,Ie.T),ht!==Ie.A&&Yt(ue,"placeholder",Ie.A=ht),Kt!==Ie.O&&(ue.disabled=Ie.O=Kt),Ie.I=m(le,Rt,Ie.I),Ie.S=m(q,Qt,Ie.S),Ie.W=m(me,sr,Ie.W),mt!==Ie.C&&Yt(me,"placeholder",Ie.C=mt),At!==Ie.B&&(me.disabled=Ie.B=At),Ie.v=m(Pe,Ot,Ie.v),Ie.k=m(xe,Jt,Ie.k),Ie.x=m(De,Zt,Ie.x),Ht!==Ie.j&&Yt(De,"placeholder",Ie.j=Ht),tt!==Ie.q&&(De.disabled=Ie.q=tt),jt!==Ie.z&&(Ce.disabled=Ie.z=jt),yt!==Ie.P&&(Le.disabled=Ie.P=yt),Ie},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0,x:void 0,j:void 0,q:void 0,z:void 0,P:void 0}),we(()=>W.value=r()),we(()=>H.value=C()),we(()=>K.value=i()),we(()=>Y.value=s()),we(()=>ue.value=c()),we(()=>me.value=w()),we(()=>De.value=h()),G}})}})};dr(["input","click"]);var kk=de("<div><div></div><div><div><label></label><select><option value=all></option><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),Tk=de("<div><h2>"),Nk=de("<div><label>"),Lk=de("<div><label></label><select><option value>"),Dk=de("<option>"),Rk=de("<div><div></div><div></div><div>"),Mk=de("<div><div><div><div><span></span><h3></h3><span></span></div><div>  </div></div><div><div></div><div> <!> @ </div></div></div><div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div><span>:</span><span>"),Fk=de("<span>"),Ok=de("<span> <!>: "),f0=de("<div><span>:</span><span>"),Bk=de("<div><div><span>:</span><select><option value=10>10</option><option value=25>25</option><option value=50>50</option><option value=100>100</option></select><span></span></div><div><div><span>:</span><input type=number min=1><span> "),jk=de("<span>..."),Vk=de("<button>");const qk=t=>{const{t:e}=er(),[r,n]=$e(""),[i,o]=$e(""),[s,a]=$e("all"),[c,u]=$e({start:"",end:""}),[h,y]=$e(""),[g,p]=$e(""),[C,S]=$e(1),[w,x]=$e(25),[V,ne]=$e(null),[X,Q]=$e(!1),[ee,E]=$e(!1),A=Tt(()=>{let me=lt.movements;if(t.filterBy==="product"&&t.filterId?me=me.filter(Pe=>Pe.productId===t.filterId):t.filterBy==="location"&&t.filterId&&(me=me.filter(Pe=>Pe.locationId===t.filterId)),r()&&(me=me.filter(Pe=>Pe.productId===r())),i()&&(me=me.filter(Pe=>Pe.locationId===i())),s()!=="all"&&(me=me.filter(Pe=>Pe.movementType===s())),c().start&&(me=me.filter(Pe=>Pe.createdDate>=c().start)),c().end&&(me=me.filter(Pe=>Pe.createdDate<=c().end+"T23:59:59Z")),h()){const Pe=h().toLowerCase();me=me.filter(xe=>xe.productName.toLowerCase().includes(Pe)||xe.productSku.toLowerCase().includes(Pe)||xe.locationName.toLowerCase().includes(Pe)||xe.referenceNumber.toLowerCase().includes(Pe)||xe.notes.toLowerCase().includes(Pe)||xe.createdBy.toLowerCase().includes(Pe)||xe.invoiceId&&xe.invoiceId.toLowerCase().includes(Pe)||xe.fromLocationName&&xe.fromLocationName.toLowerCase().includes(Pe)||xe.movementType.toLowerCase().includes(Pe))}return me.sort((Pe,xe)=>new Date(xe.createdDate).getTime()-new Date(Pe.createdDate).getTime())});vo(()=>{r(),i(),s(),c(),h(),S(1)});const T=Tt(()=>{const me=(C()-1)*w(),Pe=me+w();return A().slice(me,Pe)}),R=Tt(()=>Math.ceil(A().length/w())),_=Tt(()=>{const me=A();return{total:me.length,stockIn:me.filter(Pe=>Pe.movementType==="in").length,stockOut:me.filter(Pe=>Pe.movementType==="out").length,transfers:me.filter(Pe=>Pe.movementType==="transfer").length,adjustments:me.filter(Pe=>Pe.movementType==="adjustment").length,totalValue:me.reduce((Pe,xe)=>Pe+xe.totalCost,0)}}),I={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},b={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},G={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)",cursor:"pointer"},ie={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},F={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem","margin-bottom":"2rem"},W={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","text-align":"center"},z={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},O={"font-size":"0.875rem",color:"var(--text-muted)","font-weight":"500"},k={padding:"1.5rem","margin-bottom":"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",transition:"all 0.2s ease"},re={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"1rem"};function $(me){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[me]||{bg:"#f5f5f5",color:"#666"}}const D=me=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:$(me).bg,color:$(me).color}),H={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"1rem"},L={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.5rem 0","border-bottom":"1px solid var(--border-color)"},j={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},oe={"font-weight":"600",color:"var(--text-primary)"},K={display:"flex","justify-content":"space-between","align-items":"center","margin-top":"2rem",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},Z=me=>({padding:"0.25rem 0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:me?"var(--primary-color)":"var(--surface-color)",color:me?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),J=me=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(me),Y=me=>new Date(me).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),U=me=>({in:"",out:"",transfer:"",adjustment:""})[me]||"",ae=()=>{n(""),o(""),a("all"),u({start:"",end:""}),y(""),S(1)},ue=me=>{ne(me),Q(!0)},le=me=>{ne(me),Q(!1),E(!0)},q=()=>{E(!1),ne(null)},ce=async me=>{i()&&(me+=" "+i()),Rp(s())&&(me+=" "+Rp(s()));const Pe=await Ai.getInventory(me),xe=lt.parseInventoryData(Pe);lt.updMovements(xe)},Se=()=>{};return(()=>{var me=kk(),Pe=me.firstChild,xe=Pe.nextSibling,he=xe.firstChild,ve=he.firstChild,De=ve.nextSibling,ke=De.firstChild,Ce=ke.nextSibling,Le=Ce.nextSibling,Ie=Le.nextSibling,Re=Ie.nextSibling,He=he.nextSibling,Me=He.firstChild,Ze=Me.nextSibling,Ye=He.nextSibling,ut=Ye.firstChild,rt=ut.nextSibling,We=xe.nextSibling,ct=We.firstChild,pt=ct.firstChild,_t=pt.nextSibling,Et=ct.nextSibling,et=Et.firstChild,Ue=et.nextSibling,ot=Et.nextSibling,Xe=ot.firstChild,at=Xe.nextSibling,St=ot.nextSibling,$t=St.firstChild,qt=$t.nextSibling,Gt=St.nextSibling,ht=Gt.firstChild,Kt=ht.nextSibling,Rt=Gt.nextSibling,Qt=Rt.firstChild,sr=Qt.nextSibling;return l(me,(()=>{var mt=Te(()=>!t.filterBy);return()=>mt()&&(()=>{var At=Tk(),Ot=At.firstChild;return m(At,I),Ot.style.setProperty("margin","0"),Ot.style.setProperty("font-size","1.5rem"),l(Ot,()=>e("inventory.movements")),l(At,B(xt,{variant:"outline",onClick:ae,get children(){return e("common.clearFilters")}}),null),At})()})(),Pe),l(me,B(wk,{filters:{selectedLocation:i,movementType:s},onSearchResults:mt=>{p(mt),ce(mt)},get placeholder(){return e("inventory.searchProductsStock","Search inventories...")},showResults:!1,maxResults:20}),Pe),Pe.style.setProperty("margin","20px"),m(xe,b),l(xe,(()=>{var mt=Te(()=>!t.filterBy);return()=>mt()&&[(()=>{var At=Nk(),Ot=At.firstChild;return Ot.style.setProperty("display","block"),Ot.style.setProperty("margin-bottom","0.5rem"),Ot.style.setProperty("font-weight","500"),l(Ot,()=>e("inventory.product")),l(At,B(cf,{onChange:Jt=>{console.log(Jt),n(Jt.id)},get placeholder(){return e("inventory.searchProductsImages","Search products to view images...")}}),null),At})(),(()=>{var At=Lk(),Ot=At.firstChild,Jt=Ot.nextSibling,Zt=Jt.firstChild;return Ot.style.setProperty("display","block"),Ot.style.setProperty("margin-bottom","0.5rem"),Ot.style.setProperty("font-weight","500"),l(Ot,()=>e("inventory.location")),Jt.addEventListener("change",Ht=>o(Ht.target.value)),l(Zt,()=>e("inventory.allLocations")),l(Jt,B(Ut,{get each(){return lt.locations},children:Ht=>(()=>{var tt=Dk();return l(tt,()=>Ht.name),we(()=>tt.value=Ht.id),tt})()}),null),we(Ht=>m(Jt,G,Ht)),we(()=>Jt.value=i()),At})()]})(),he),ve.style.setProperty("display","block"),ve.style.setProperty("margin-bottom","0.5rem"),ve.style.setProperty("font-weight","500"),l(ve,()=>e("inventory.movementType")),De.addEventListener("change",mt=>{a(mt.target.value),ce(g())}),l(ke,()=>e("inventory.allTypes")),l(Ce,()=>e("inventory.stockIn")),l(Le,()=>e("inventory.stockOut")),l(Ie,()=>e("inventory.transfer")),l(Re,()=>e("inventory.adjustment")),Me.style.setProperty("display","block"),Me.style.setProperty("margin-bottom","0.5rem"),Me.style.setProperty("font-weight","500"),l(Me,()=>e("common.startDate")),Ze.addEventListener("change",mt=>u(At=>({...At,start:mt.target.value}))),ut.style.setProperty("display","block"),ut.style.setProperty("margin-bottom","0.5rem"),ut.style.setProperty("font-weight","500"),l(ut,()=>e("common.endDate")),rt.addEventListener("change",mt=>u(At=>({...At,end:mt.target.value}))),m(We,F),l(pt,()=>_().total),l(_t,()=>e("inventory.totalMovements")),l(et,()=>_().stockIn),l(Ue,()=>e("inventory.stockIn")),l(Xe,()=>_().stockOut),l(at,()=>e("inventory.stockOut")),l($t,()=>_().transfers),l(qt,()=>e("inventory.transfers")),l(ht,()=>_().adjustments),l(Kt,()=>e("inventory.adjustments")),Qt.$$click=Se,l(Qt,()=>J(_().totalValue)),l(sr,()=>e("inventory.totalValue")),l(me,(()=>{var mt=Te(()=>T().length===0);return()=>mt()?(()=>{var At=Rk(),Ot=At.firstChild,Jt=Ot.nextSibling,Zt=Jt.nextSibling;return At.style.setProperty("text-align","center"),At.style.setProperty("padding","3rem"),At.style.setProperty("color","var(--text-muted)"),At.style.setProperty("background","var(--surface-color)"),At.style.setProperty("border-radius","var(--border-radius)"),At.style.setProperty("border","1px solid var(--border-color)"),Ot.style.setProperty("font-size","1.5rem"),Ot.style.setProperty("margin-bottom","1rem"),Jt.style.setProperty("font-size","1.1rem"),Jt.style.setProperty("margin-bottom","0.5rem"),l(Jt,()=>e("inventory.noMovementsFound")),Zt.style.setProperty("font-size","0.875rem"),l(Zt,()=>e("inventory.tryAdjustingFilters")),At})():[B(Ut,{get each(){return T()},children:At=>(()=>{var Ot=Mk(),Jt=Ot.firstChild,Zt=Jt.firstChild,Ht=Zt.firstChild,tt=Ht.firstChild,jt=tt.nextSibling,yt=jt.nextSibling,ar=Ht.nextSibling,Wr=ar.firstChild,pr=Zt.nextSibling,wr=pr.firstChild,$r=wr.nextSibling,lr=$r.firstChild,Br=lr.nextSibling;Br.nextSibling;var tn=Jt.nextSibling,kt=tn.firstChild,Sr=kt.firstChild,Cr=Sr.firstChild,jr=Cr.firstChild,kr=Cr.nextSibling,Yr=Sr.nextSibling,rn=Yr.firstChild,yr=rn.firstChild,ln=rn.nextSibling,_n=kt.nextSibling,Ir=_n.firstChild,wn=Ir.firstChild,Cn=wn.firstChild,Li=wn.nextSibling;return Ot.addEventListener("mouseleave",tr=>{tr.currentTarget.style.transform="translateY(0)",tr.currentTarget.style.boxShadow="none"}),Ot.addEventListener("mouseenter",tr=>{tr.currentTarget.style.transform="translateY(-2px)",tr.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),Ot.$$click=()=>ue(At),m(Jt,re),Ht.style.setProperty("display","flex"),Ht.style.setProperty("align-items","center"),Ht.style.setProperty("gap","0.5rem"),Ht.style.setProperty("margin-bottom","0.5rem"),tt.style.setProperty("font-size","1.2rem"),l(tt,()=>U(At.movementType)),jt.style.setProperty("margin","0"),jt.style.setProperty("font-size","1.1rem"),l(jt,()=>At.productName),l(yt,()=>At.movementType),l(Ht,(()=>{var tr=Te(()=>!!At.invoiceId);return()=>tr()&&(()=>{var Tr=Fk();return Tr.style.setProperty("padding","0.2rem 0.5rem"),Tr.style.setProperty("border-radius","var(--border-radius-sm)"),Tr.style.setProperty("font-size","0.7rem"),Tr.style.setProperty("font-weight","500"),Tr.style.setProperty("background","var(--primary-color)"),Tr.style.setProperty("color","white"),l(Tr,()=>e("inventory.bulk")),Tr})()})(),null),ar.style.setProperty("font-size","0.875rem"),ar.style.setProperty("color","var(--text-muted)"),l(ar,()=>At.productSku,Wr),l(ar,()=>Y(At.createdDate),null),l(ar,(()=>{var tr=Te(()=>!!At.invoiceId);return()=>tr()&&(()=>{var Tr=Ok(),qr=Tr.firstChild,bt=qr.nextSibling;return bt.nextSibling,Tr.style.setProperty("margin-left","0.5rem"),Tr.style.setProperty("font-weight","500"),l(Tr,()=>e("common.invoice"),bt),l(Tr,()=>At.invoiceId,null),Tr})()})(),null),pr.style.setProperty("text-align","right"),wr.style.setProperty("font-size","1.25rem"),wr.style.setProperty("font-weight","700"),wr.style.setProperty("color","var(--primary-color)"),l(wr,()=>J(At.totalCost)),$r.style.setProperty("font-size","0.875rem"),$r.style.setProperty("color","var(--text-muted)"),l($r,()=>At.quantity,lr),l($r,()=>e("common.units"),Br),l($r,()=>J(At.unitCost),null),m(tn,H),l(Cr,()=>e("inventory.location"),jr),l(kr,()=>At.locationName),l(kt,(()=>{var tr=Te(()=>!!At.fromLocationName);return()=>tr()&&(()=>{var Tr=f0(),qr=Tr.firstChild,bt=qr.firstChild,rr=qr.nextSibling;return l(qr,()=>e("common.from"),bt),l(rr,()=>At.fromLocationName),we(fr=>{var Gr=L,Fr=j,pn=oe;return fr.e=m(Tr,Gr,fr.e),fr.t=m(qr,Fr,fr.t),fr.a=m(rr,pn,fr.a),fr},{e:void 0,t:void 0,a:void 0}),Tr})()})(),Yr),l(rn,()=>e("common.reference"),yr),l(ln,()=>At.referenceNumber),l(wn,()=>e("common.createdBy"),Cn),l(Li,()=>At.createdBy),l(_n,(()=>{var tr=Te(()=>!!At.notes);return()=>tr()&&(()=>{var Tr=f0(),qr=Tr.firstChild,bt=qr.firstChild,rr=qr.nextSibling;return l(qr,()=>e("common.notes"),bt),l(rr,()=>At.notes),we(fr=>{var Gr={...L,"border-bottom":"none"},Fr=j,pn={...oe,"max-width":"200px","text-align":"right","font-style":"italic"};return fr.e=m(Tr,Gr,fr.e),fr.t=m(qr,Fr,fr.t),fr.a=m(rr,pn,fr.a),fr},{e:void 0,t:void 0,a:void 0}),Tr})()})(),null),we(tr=>{var Tr={...k,"border-left":At.invoiceId?"4px solid var(--primary-color)":"1px solid var(--border-color)",cursor:"pointer"},qr=D(At.movementType),bt=L,rr=j,fr=oe,Gr=L,Fr=j,pn=oe,Pr=L,Yn=j,Pn=oe;return tr.e=m(Ot,Tr,tr.e),tr.t=m(yt,qr,tr.t),tr.a=m(Sr,bt,tr.a),tr.o=m(Cr,rr,tr.o),tr.i=m(kr,fr,tr.i),tr.n=m(Yr,Gr,tr.n),tr.s=m(rn,Fr,tr.s),tr.h=m(ln,pn,tr.h),tr.r=m(Ir,Pr,tr.r),tr.d=m(wn,Yn,tr.d),tr.l=m(Li,Pn,tr.l),tr},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),Ot})()}),Te(()=>Te(()=>R()>1)()&&(()=>{var At=Bk(),Ot=At.firstChild,Jt=Ot.firstChild,Zt=Jt.firstChild,Ht=Jt.nextSibling,tt=Ht.nextSibling,jt=Ot.nextSibling,yt=jt.firstChild,ar=yt.firstChild,Wr=ar.firstChild,pr=ar.nextSibling,wr=pr.nextSibling,$r=wr.firstChild;return m(At,K),Ot.style.setProperty("display","flex"),Ot.style.setProperty("align-items","center"),Ot.style.setProperty("gap","0.5rem"),Jt.style.setProperty("font-size","0.875rem"),Jt.style.setProperty("color","var(--text-muted)"),l(Jt,()=>e("common.showPerPage","Show per page"),Zt),Ht.addEventListener("change",lr=>{x(Number(lr.target.value)),S(1)}),Ht.style.setProperty("padding","0.25rem 0.5rem"),Ht.style.setProperty("border","1px solid var(--border-color)"),Ht.style.setProperty("border-radius","var(--border-radius-sm)"),Ht.style.setProperty("background","var(--surface-color)"),Ht.style.setProperty("cursor","pointer"),Ht.style.setProperty("font-size","0.875rem"),tt.style.setProperty("font-size","0.875rem"),tt.style.setProperty("color","var(--text-muted)"),tt.style.setProperty("margin-left","1rem"),l(tt,()=>e("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:(C()-1)*w()+1,end:Math.min(C()*w(),A().length),total:A().length})),jt.style.setProperty("display","flex"),jt.style.setProperty("align-items","center"),jt.style.setProperty("gap","0.5rem"),l(jt,B(xt,{variant:"outline",size:"sm",onClick:()=>S(1),get disabled(){return C()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.first","First")}}),yt),l(jt,B(xt,{variant:"outline",size:"sm",onClick:()=>S(lr=>Math.max(1,lr-1)),get disabled(){return C()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.previous")}}),yt),l(jt,()=>{const lr=[],Br=R(),tn=C();if(Br<=7)for(let kt=1;kt<=Br;kt++)lr.push(kt);else{lr.push(1),tn>3&&lr.push("...");for(let kt=Math.max(2,tn-1);kt<=Math.min(Br-1,tn+1);kt++)lr.includes(kt)||lr.push(kt);tn<Br-2&&lr.push("..."),lr.includes(Br)||lr.push(Br)}return B(Ut,{each:lr,children:kt=>kt==="..."?(()=>{var Sr=jk();return Sr.style.setProperty("padding","0 0.5rem"),Sr.style.setProperty("color","var(--text-muted)"),Sr})():(()=>{var Sr=Vk();return Sr.$$click=()=>S(kt),l(Sr,kt),we(Cr=>m(Sr,Z(kt===C()),Cr)),Sr})()})},yt),l(jt,B(xt,{variant:"outline",size:"sm",onClick:()=>S(lr=>Math.min(R(),lr+1)),get disabled(){return C()===R()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.next")}}),yt),l(jt,B(xt,{variant:"outline",size:"sm",onClick:()=>S(R()),get disabled(){return C()===R()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.last","Last")}}),yt),yt.style.setProperty("display","flex"),yt.style.setProperty("align-items","center"),yt.style.setProperty("gap","0.5rem"),yt.style.setProperty("margin-left","1rem"),ar.style.setProperty("font-size","0.875rem"),ar.style.setProperty("color","var(--text-muted)"),l(ar,()=>e("common.page","Page"),Wr),pr.addEventListener("change",lr=>{const Br=Number(lr.target.value);Br>=1&&Br<=R()&&S(Br)}),pr.style.setProperty("width","4rem"),pr.style.setProperty("padding","0.25rem 0.5rem"),pr.style.setProperty("border","1px solid var(--border-color)"),pr.style.setProperty("border-radius","var(--border-radius-sm)"),pr.style.setProperty("background","var(--surface-color)"),pr.style.setProperty("text-align","center"),pr.style.setProperty("font-size","0.875rem"),wr.style.setProperty("font-size","0.875rem"),wr.style.setProperty("color","var(--text-muted)"),l(wr,()=>e("common.of","of"),$r),l(wr,R,null),we(()=>Yt(pr,"max",R())),we(()=>Ht.value=w()),we(()=>pr.value=C()),At})())]})(),null),l(me,B(Ak,{get isOpen(){return X()},onClose:()=>{Q(!1),ne(null)},get movement(){return V()},onEdit:le}),null),l(me,B(Ge,{get when(){return Ar.hasPermission("read_write")},get children(){return B(Ek,{get isOpen(){return ee()},onClose:()=>{E(!1),ne(null)},get movement(){return V()},onMovementUpdated:q})}}),null),we(mt=>{var At=G,Ot=ie,Jt=ie,Zt=W,Ht=z,tt=O,jt=W,yt={...z,color:"#2d7d32"},ar=O,Wr=W,pr={...z,color:"#d32f2f"},wr=O,$r=W,lr={...z,color:"#1976d2"},Br=O,tn=W,kt={...z,color:"#f57c00"},Sr=O,Cr=W,jr=z,kr=O;return mt.e=m(De,At,mt.e),mt.t=m(Ze,Ot,mt.t),mt.a=m(rt,Jt,mt.a),mt.o=m(ct,Zt,mt.o),mt.i=m(pt,Ht,mt.i),mt.n=m(_t,tt,mt.n),mt.s=m(Et,jt,mt.s),mt.h=m(et,yt,mt.h),mt.r=m(Ue,ar,mt.r),mt.d=m(ot,Wr,mt.d),mt.l=m(Xe,pr,mt.l),mt.u=m(at,wr,mt.u),mt.c=m(St,$r,mt.c),mt.w=m($t,lr,mt.w),mt.m=m(qt,Br,mt.m),mt.f=m(Gt,tn,mt.f),mt.y=m(ht,kt,mt.y),mt.g=m(Kt,Sr,mt.g),mt.p=m(Rt,Cr,mt.p),mt.b=m(Qt,jr,mt.b),mt.T=m(sr,kr,mt.T),mt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),we(()=>De.value=s()),we(()=>Ze.value=c().start),we(()=>rt.value=c().end),me})()};dr(["click"]);var zk=de("<div><p> "),Uk=de("<div>"),Hk=de("<div><div></div><h3></h3><p></p><div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=name></option><option value=sku></option><option value=category>"),Wk=de("<div><div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div>%</div><div></div></div></div><div></div><div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),Gk=de("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),Yk=de("<div><div></div><h3></h3><p>"),Kk=de("<div><div><h3> </h3><p></p></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div></div><div>"),Jk=de("<div><div><div><h2> </h2><button>"),p0=de("<option>"),Qk=de("<div>..."),Xk=de("<tr><td><div></div><div>  </div></td><td><div></div></td><td><div></div></td><td><div></div></td><td><div>"),Zk=de("<tr><td><div></div></td><td><div></div><div>  <!>  </div></td><td><div></div></td><td><input type=number placeholder=0 min=0 step=0.01></td><td><div></div></td><td><input type=text>");const eT=t=>{const{t:e}=er(),[r,n]=$e([]),[i,o]=$e(!1),[s,a]=$e(!1),[c,u]=$e("all"),[h,y]=$e("all"),[g,p]=$e("name"),[C,S]=$e([]),[w,x]=$e("setup"),V=async()=>{try{o(!0);const O=await Ai.getProducts("prod");if(!O||typeof O!="object"){console.warn("No API results, using local store"),n(lt.products);return}const k=Object.keys(O),re=D=>{let L=O[D];return{id:D,name:L.name||"Unknown Product",businessId:L.businessId||"",sku:L.code||L.sku||"",UPC:L.UPC||"",numCode:L.codeN||"",category:L.category||"General",unitCost:L.unitCost||0,unitOfMeasure:L.unitOfMeasure||"pcs",minStockLevel:L.minStockLevel||0,maxStockLevel:L.maxStockLevel||100,isActive:L.isActive!==!1,description:L.description||"",createdDate:L.createdAt||new Date().toISOString(),lastModified:L.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(L.sellingPrice||L.price||"0")}},$=k.map(re);n($)}catch(O){console.error("Failed to load products from API:",O),n(lt.products)}finally{o(!1)}},ne=Tt(()=>[...new Set(r().map(k=>k.category).filter(k=>k))].sort()),X=Tt(()=>{let O=r().filter(k=>k.isActive);return h()!=="all"&&(O=O.filter(k=>k.category===h())),O.sort((k,re)=>{switch(g()){case"name":return k.name.localeCompare(re.name);case"sku":return k.sku.localeCompare(re.sku);case"category":return k.category.localeCompare(re.category)||k.name.localeCompare(re.name);default:return 0}}),O}),Q=Tt(()=>lt.getActiveLocations()),ee=(O,k)=>k&&k!=="all"?lt.getStockByProductAndLocation(O,k)?.quantity||0:lt.getTotalStockByProduct(O),E=()=>{const O=X().map(k=>{const re=ee(k.id,c()!=="all"?c():void 0);return{productId:k.id,systemQuantity:re,physicalCount:null,notes:"",variance:0,product:k}});S(O),x("counting")},A=(O,k)=>{S(re=>re.map($=>{if($.productId===O){const D=k,H=D!==null?D-$.systemQuantity:0;return{...$,physicalCount:D,variance:H}}return $}))},T=(O,k)=>{S(re=>re.map($=>$.productId===O?{...$,notes:k}:$))},R=Tt(()=>{const O=C(),k=O.length,re=O.filter(L=>L.physicalCount!==null).length,$=O.filter(L=>L.variance!==0).length,D=O.filter(L=>L.variance>0).length,H=O.filter(L=>L.variance<0).length;return{totalProducts:k,countedProducts:re,remainingProducts:k-re,variances:$,positiveVariances:D,negativeVariances:H,isComplete:re===k}}),_=()=>{const O=C().filter(D=>D.physicalCount!==null&&D.variance!==0);if(O.length===0)return null;const k=[e("inventory.product","Product"),e("inventory.sku","SKU"),e("inventory.category","Category"),e("inventory.location","Location"),e("inventory.systemQty","System Qty"),e("inventory.physicalCount","Physical Count"),e("inventory.variance","Variance"),e("inventory.adjustment","Adjustment"),e("common.notes","Notes"),e("common.date","Date")],re=O.map(D=>[`"${D.product.name}"`,`"${D.product.sku}"`,`"${D.product.category}"`,`"${G()}"`,D.systemQuantity,D.physicalCount,D.variance,D.variance>0?e("inventory.stockIncrease","Stock Increase"):e("inventory.stockDecrease","Stock Decrease"),`"${D.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")}"`,`"${ie()}"`]);return[k.join(","),...re.map(D=>D.join(","))].join(`
`)},I=()=>{const O=_();if(!O){alert(e("inventory.noAdjustmentsToDownload","No adjustments to download"));return}const k=new Blob([O],{type:"text/csv;charset=utf-8;"}),re=document.createElement("a");if(re.download!==void 0){const $=URL.createObjectURL(k);re.setAttribute("href",$),re.setAttribute("download",`inventory-adjustments-${ie().replace(/[/:,\s]/g,"-")}.csv`),re.style.visibility="hidden",document.body.appendChild(re),re.click(),document.body.removeChild(re)}},b=async(O=!0)=>{try{a(!0),console.log(C());const k=j=>{let oe=lt.getProductById(j.productId),K=lt.getStockByProductAndLocation(j.productId,c()),Z=parseFloat(K?.averageCost+""),J=parseFloat(K?.quantity+"");return{product:{id:j.productId,label:oe?.name,code:oe?.code},productId:j?.productId,reason:"Physical Count Adjustment",notes:j?.notes||"Physical inventory adjustment",quantity:j?.variance,unitCost:Z}},re=C().filter(j=>j.physicalCount!==null&&j.variance!==0).map(k);let $="ADJ_"+_g();const D=new Date().toISOString(),H={ssg_inventory_key:Dm(),invoiceId:$,referenceNumber:_g(),movementType:"adjustment",type:"adjustment",locationId:c(),items:re,products:re,generalNotes:"Physical inventory adjustment",description:"Physical Count Adjustment",invoice:$,store:c(),createdBy:"admin",createDate:D};console.log("Saving inventory bulkRequest:",H);const L=await Ai.addInventory(H);O&&re.length>0&&I(),console.log("Saving inventory adjustments:",re),await new Promise(j=>setTimeout(j,1e3)),t.onClose()}catch(k){console.error("Failed to save inventory adjustments:",k)}finally{a(!1)}},G=Tt(()=>c()==="all"?"All Locations":Q().find(k=>k.id===c())?.name||"Unknown Location"),ie=()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),F=async()=>{await lt.fecthInventory("prod"),await V()};Rn(async()=>{t.selectedLocationId&&u(t.selectedLocationId),F()});const W=()=>{const O=window.open("","_blank");if(!O){alert("Please allow pop-ups to print the counting sheet");return}const k=z();O.document.write(k),O.document.close(),O.onload=()=>{O.print(),O.onafterprint=()=>{O.close()}}},z=()=>{const O=X().map((k,re)=>{const $=ee(k.id,c()!=="all"?c():void 0);return`
        <tr>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${re+1}</td>
          <td style="border: 1px solid #000; padding: 8px; font-family: monospace;">${k.sku}</td>
          <td style="border: 1px solid #000; padding: 8px;">
            <div style="font-weight: 500;">${k.name}</div>
            ${k.UPC?`<div style="font-size: 0.8em; color: #666;">UPC: ${k.UPC}</div>`:""}
          </td>
         
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${k.unitOfMeasure}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">${$}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; background-color: #f9f9f9;"></td>
          <td style="border: 1px solid #000; padding: 8px;"></td>
        </tr>
      `}).join("");return`
      <!DOCTYPE html>
      <html>
      <head>
        <title> ${G()}_${h()}_${e("inventory.countingSheet","Inventory Counting Sheet")} - ${ie()}</title>
        <style>
          @page {
            size: letter;
            margin: 0.5in 0.8in 0.5in 0.8in;
            @top-center {
              content: "${G()} | ${h()==="all"?e("inventory.allCategories","All Categories"):h()} | Page " counter(page);
              font-size: 10px;
              font-weight: bold;
              border-bottom: 1px solid #ccc;
              padding-bottom: 5px;
            }
          }
          body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            margin: 0;
            padding: 0;
            position: relative;
          }
          .page-identifier {
            position: fixed;
            left: 5px;
            top: 50%;
            transform: rotate(-90deg) translateX(-50%);
            transform-origin: left center;
            background: #f0f0f0;
            padding: 5px 15px;
            border: 1px solid #ccc;
            font-weight: bold;
            font-size: 10px;
            color: #333;
            z-index: 100;
          }
          .page-identifier-right {
            position: fixed;
            right: 5px;
            top: 50%;
            transform: rotate(90deg) translateX(50%);
            transform-origin: right center;
            background: #f0f0f0;
            padding: 5px 15px;
            border: 1px solid #ccc;
            font-weight: bold;
            font-size: 10px;
            color: #333;
            z-index: 100;
          }
          h1 {
            text-align: center;
            margin: 0 0 10px 0;
            font-size: 22px;
            page-break-after: avoid;
          }
          .header-info {
            text-align: center;
            margin-bottom: 20px;
            background: #f8f8f8;
            padding: 10px;
            border: 2px solid #333;
            page-break-after: avoid;
          }
          .page-header {
            display: none;
            text-align: center;
            background: #e0e0e0;
            padding: 8px;
            border: 1px solid #333;
            margin-bottom: 10px;
            font-weight: bold;
            font-size: 11px;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
          }
          th {
            background-color: #333;
            color: white;
            padding: 8px;
            text-align: left;
            font-weight: bold;
            border: 1px solid #000;
          }
          .summary-table {
            width: 50%;
            margin: 20px auto;
            /*page-break-before: auto;*/
          }
          .signature-section {
            margin-top: 40px;
            display: flex;
            justify-content: space-between;
            page-break-before: auto;
          }
          .signature-box {
            width: 45%;
            text-align: center;
          }
          .signature-line {
            border-bottom: 1px solid #000;
            margin-bottom: 5px;
            height: 30px;
          }
          @media print {
            body { margin: 0; }
            .page-identifier, .page-identifier-right { display: block; }
            .page-header { display: block; }
            tr { page-break-inside: avoid; }
            thead { display: table-header-group; }
            tfoot { display: table-footer-group; }
            .header-info { page-break-after: avoid; }
            h1 { page-break-after: avoid; }
            table { page-break-before: auto; }
            /*.summary-table { page-break-before: always; }*/
            .signature-section { page-break-before: avoid; }
            
            /* Repeat headers on each page */
            @page :first {
              @top-center { content: none; }
            }
            
            /* Force page headers to show on continuation pages */
            tbody::before {
              content: "";
              display: block;
              height: 0;
            }
          }
        </style>
      </head>
      <body>
        <!-- Page identifiers for multi-page documents -->
        <div class="page-identifier-right">
          ${G()} - ${h()==="all"?e("inventory.allCategories","All Categories"):h()} - ${ie()} 
        </div>
       
        
        <h1>${e("inventory.inventoryCountingSheetTitle","INVENTORY COUNTING SHEET")}</h1>
        <div class="header-info">
          <p><strong>${e("inventory.location","Location")}:</strong> ${G()}</p>
          <p><strong>${e("common.category","Category")}:</strong> ${h()==="all"?e("inventory.allCategories","All Categories"):h()}</p>
          <p><strong>${e("common.date","Date")}:</strong> ${ie()}</p>
          <p style="margin-top: 10px;">
            <span style="margin-right: 30px;">${e("inventory.countedBy","Counted by")}: _________________________</span>
            <span>${e("inventory.verifiedBy","Verified by")}: _________________________</span>
          </p>
        </div>

        <!-- Page header for continuation pages (hidden on first page) -->
        <div class="page-header">
          ${G()} | ${h()==="all"?e("inventory.allCategories","All Categories"):h()} | ${ie()} 
        </div>

        <table>
          <thead>
            <tr>
              <th style="width: 5%; text-align: center;">#</th>
              <th style="width: 12%;">${e("inventory.sku","SKU")}</th>
              <th style="width: 25%;">${e("inventory.productName","Product Name")}</th>
              <th style="width: 8%; text-align: center;">${e("inventory.unit","Unit")}</th>
              <th style="width: 10%; text-align: center;">${e("inventory.systemQty","System Qty")}</th>
              <th style="width: 12%; text-align: center; background-color: #f0f0f0;">${e("inventory.physicalCount","Physical Count")}</th>
              <th style="width: 28%;">${e("common.notes","Notes")}</th>
            </tr>
            <!-- Repeat header info row for clarity -->
            <tr style="background-color: #f8f8f8; font-size: 10px;">
              <td colspan="8" style="text-align: center; padding: 4px; border: 1px solid #000; font-weight: bold;">
                 ${G()} |  ${h()==="all"?e("inventory.allCategories","All Categories"):h()} |  ${ie()}
              </td>
            </tr>
          </thead>
          <tbody>
            ${O}
          </tbody>
        </table>
        
        <!-- Summary section with location/category context -->
        <div style="margin: 30px 0; padding: 15px; background: #f8f8f8;">
          <h3 style="text-align: center; margin: 0 0 15px 0; font-size: 16px;">
            ${e("inventory.summaryFor","SUMMARY FOR")}: ${G()} - ${h()==="all"?e("inventory.allCategories","All Categories"):h()}
          </h3>
          
          <table class="summary-table">
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.totalProductsListed","Total Products Listed")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">
                ${X().length}
              </td>
            </tr>
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.itemsCounted","Items Counted")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center;">
                ___________
              </td>
            </tr>
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.discrepanciesFound","Discrepancies Found")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center;">
                ___________
              </td>
            </tr>
          </table>
        </div>
        
        <div class="signature-section">
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.counterSignature","Counter Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.supervisorSignature","Supervisor Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
        </div>
      </body>
      </html>
    `};return B(Ge,{get when(){return t.isOpen},get children(){var O=Jk(),k=O.firstChild,re=k.firstChild,$=re.firstChild;$.firstChild;var D=$.nextSibling;return O.style.setProperty("position","fixed"),O.style.setProperty("top","0"),O.style.setProperty("left","0"),O.style.setProperty("right","0"),O.style.setProperty("bottom","0"),O.style.setProperty("background","rgba(0, 0, 0, 0.5)"),O.style.setProperty("z-index","1000"),O.style.setProperty("display","flex"),O.style.setProperty("align-items","center"),O.style.setProperty("justify-content","center"),k.style.setProperty("background","white"),k.style.setProperty("border-radius","var(--border-radius)"),k.style.setProperty("padding","2rem"),k.style.setProperty("width","95%"),k.style.setProperty("height","95%"),k.style.setProperty("max-width","1400px"),k.style.setProperty("overflow-y","auto"),k.style.setProperty("position","relative"),re.style.setProperty("display","flex"),re.style.setProperty("justify-content","space-between"),re.style.setProperty("align-items","center"),re.style.setProperty("margin-bottom","2rem"),re.style.setProperty("border-bottom","1px solid var(--border-color)"),re.style.setProperty("padding-bottom","1rem"),$.style.setProperty("margin","0"),$.style.setProperty("font-size","1.5rem"),l($,()=>e("inventory.physicalInventoryCount","Physical Inventory Count"),null),as(D,"click",t.onClose,!0),D.style.setProperty("background","none"),D.style.setProperty("border","none"),D.style.setProperty("font-size","1.5rem"),D.style.setProperty("cursor","pointer"),D.style.setProperty("padding","0.5rem"),l(k,B(Ge,{get when(){return w()==="setup"},get children(){var H=Hk(),L=H.firstChild,j=L.nextSibling,oe=j.nextSibling,K=oe.nextSibling,Z=K.firstChild,J=Z.firstChild,Y=J.firstChild,U=J.nextSibling,ae=U.firstChild,ue=Z.nextSibling,le=ue.firstChild,q=le.firstChild,ce=le.nextSibling,Se=ce.firstChild,me=ue.nextSibling,Pe=me.firstChild,xe=Pe.firstChild,he=Pe.nextSibling,ve=he.firstChild,De=ve.nextSibling,ke=De.nextSibling;return H.style.setProperty("text-align","center"),H.style.setProperty("padding","2rem"),H.style.setProperty("max-width","600px"),H.style.setProperty("margin","0 auto"),L.style.setProperty("font-size","3rem"),L.style.setProperty("margin-bottom","1rem"),j.style.setProperty("margin-bottom","1rem"),l(j,()=>e("inventory.setupPhysicalCount","Setup Physical Inventory Count")),oe.style.setProperty("margin-bottom","2rem"),oe.style.setProperty("color","var(--text-muted)"),l(oe,()=>e("inventory.setupDescription","Configure your physical inventory count settings and begin the counting process.")),K.style.setProperty("display","grid"),K.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),K.style.setProperty("gap","1rem"),K.style.setProperty("margin-bottom","2rem"),K.style.setProperty("padding","1rem"),K.style.setProperty("background","var(--surface-color)"),K.style.setProperty("border-radius","var(--border-radius)"),K.style.setProperty("text-align","left"),J.style.setProperty("display","block"),J.style.setProperty("margin-bottom","0.5rem"),J.style.setProperty("font-weight","500"),l(J,()=>e("inventory.location","Location"),Y),U.addEventListener("change",Ce=>u(Ce.target.value)),U.style.setProperty("width","100%"),U.style.setProperty("padding","0.5rem"),U.style.setProperty("border","1px solid var(--border-color)"),U.style.setProperty("border-radius","var(--border-radius-sm)"),l(ae,()=>e("inventory.allLocations","All Locations")),l(U,B(Ut,{get each(){return Q()},children:Ce=>(()=>{var Le=p0();return l(Le,()=>Ce.name),we(()=>Le.value=Ce.id),Le})()}),null),le.style.setProperty("display","block"),le.style.setProperty("margin-bottom","0.5rem"),le.style.setProperty("font-weight","500"),l(le,()=>e("inventory.category","Category"),q),ce.addEventListener("change",Ce=>y(Ce.target.value)),ce.style.setProperty("width","100%"),ce.style.setProperty("padding","0.5rem"),ce.style.setProperty("border","1px solid var(--border-color)"),ce.style.setProperty("border-radius","var(--border-radius-sm)"),l(Se,()=>e("products.allCategories","All Categories")),l(ce,B(Ut,{get each(){return ne()},children:Ce=>(()=>{var Le=p0();return Le.value=Ce,l(Le,Ce),Le})()}),null),Pe.style.setProperty("display","block"),Pe.style.setProperty("margin-bottom","0.5rem"),Pe.style.setProperty("font-weight","500"),l(Pe,()=>e("inventory.sortBy","Sort By"),xe),he.addEventListener("change",Ce=>p(Ce.target.value)),he.style.setProperty("width","100%"),he.style.setProperty("padding","0.5rem"),he.style.setProperty("border","1px solid var(--border-color)"),he.style.setProperty("border-radius","var(--border-radius-sm)"),l(ve,()=>e("inventory.productName","Product Name")),l(De,()=>e("inventory.sku","SKU")),l(ke,()=>e("inventory.category","Category")),l(H,B(Ge,{get when(){return!i()},get fallback(){return(()=>{var Ce=Qk(),Le=Ce.firstChild;return Ce.style.setProperty("padding","2rem"),l(Ce,()=>e("common.loading","Loading"),Le),Ce})()},get children(){return[(()=>{var Ce=zk(),Le=Ce.firstChild;return Le.firstChild,Ce.style.setProperty("padding","1rem"),Ce.style.setProperty("background","#fff3cd"),Ce.style.setProperty("border-radius","var(--border-radius-sm)"),Ce.style.setProperty("margin-bottom","2rem"),Le.style.setProperty("margin","0"),Le.style.setProperty("color","#856404"),l(Le,()=>e("inventory.countWillInclude","This count will include {{count}} products from {{location}} in {{category}} category.",{count:X().length,location:G(),category:h()==="all"?e("inventory.allCategories","all categories"):h()}),null),Ce})(),B(Ge,{get when(){return Te(()=>h()!=="all")()&&c()!=="all"},get children(){var Ce=Uk();return Ce.style.setProperty("display","grid"),Ce.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),Ce.style.setProperty("gap","1rem"),Ce.style.setProperty("margin-bottom","2rem"),Ce.style.setProperty("padding","1rem"),Ce.style.setProperty("background","var(--surface-color)"),Ce.style.setProperty("border-radius","var(--border-radius)"),l(Ce,B(Ge,{get when(){return Ar.hasPermission("physicalInventoryCountingForm")},get children(){return B(xt,{variant:"primary",size:"large",onClick:E,get disabled(){return i()||X().length===0},get children(){return[" ",Te(()=>e("inventory.startCounting","Start Physical Count"))]}})}}),null),l(Ce,B(xt,{variant:"primary",onClick:W,get disabled(){return i()},get children(){return[" ",Te(()=>e("common.print","Print"))]}}),null),Ce}})]}}),null),we(()=>U.value=c()),we(()=>ce.value=h()),we(()=>he.value=g()),H}}),null),l(k,B(Ge,{get when(){return w()==="counting"},get children(){var H=Wk(),L=H.firstChild,j=L.nextSibling,oe=j.firstChild,K=oe.firstChild,Z=K.nextSibling,J=oe.nextSibling,Y=J.firstChild,U=Y.nextSibling,ae=J.nextSibling,ue=ae.firstChild,le=ue.nextSibling,q=ae.nextSibling,ce=q.firstChild,Se=ce.firstChild,me=ce.nextSibling,Pe=j.nextSibling,xe=Pe.nextSibling,he=xe.firstChild,ve=he.firstChild,De=ve.firstChild,ke=De.firstChild,Ce=ke.nextSibling,Le=Ce.nextSibling,Ie=Le.nextSibling,Re=Ie.nextSibling,He=Re.nextSibling,Me=ve.nextSibling;return L.style.setProperty("display","grid"),L.style.setProperty("grid-template-columns","repeat(auto-fit)"),L.style.setProperty("gap","1rem"),L.style.setProperty("margin-bottom","2rem"),L.style.setProperty("padding","1rem"),L.style.setProperty("background","var(--surface-color)"),L.style.setProperty("border-radius","var(--border-radius)"),l(L,G),j.style.setProperty("display","grid"),j.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),j.style.setProperty("gap","1rem"),j.style.setProperty("margin-bottom","2rem"),j.style.setProperty("padding","1rem"),j.style.setProperty("background","var(--surface-color)"),j.style.setProperty("border-radius","var(--border-radius)"),oe.style.setProperty("text-align","center"),K.style.setProperty("font-size","1.5rem"),K.style.setProperty("font-weight","700"),K.style.setProperty("color","var(--primary-color)"),l(K,()=>R().countedProducts),Z.style.setProperty("font-size","0.875rem"),Z.style.setProperty("color","var(--text-muted)"),l(Z,()=>e("inventory.counted","Counted")),J.style.setProperty("text-align","center"),Y.style.setProperty("font-size","1.5rem"),Y.style.setProperty("font-weight","700"),Y.style.setProperty("color","#ff9800"),l(Y,()=>R().remainingProducts),U.style.setProperty("font-size","0.875rem"),U.style.setProperty("color","var(--text-muted)"),l(U,()=>e("inventory.remaining","Remaining")),ae.style.setProperty("text-align","center"),ue.style.setProperty("font-size","1.5rem"),ue.style.setProperty("font-weight","700"),ue.style.setProperty("color","#f44336"),l(ue,()=>R().variances),le.style.setProperty("font-size","0.875rem"),le.style.setProperty("color","var(--text-muted)"),l(le,()=>e("inventory.variances","Variances")),q.style.setProperty("text-align","center"),ce.style.setProperty("font-size","1.5rem"),ce.style.setProperty("font-weight","700"),l(ce,()=>Math.round(R().countedProducts/R().totalProducts*100),Se),me.style.setProperty("font-size","0.875rem"),me.style.setProperty("color","var(--text-muted)"),l(me,()=>e("inventory.complete","Complete")),Pe.style.setProperty("display","flex"),Pe.style.setProperty("gap","1rem"),Pe.style.setProperty("margin-bottom","2rem"),Pe.style.setProperty("justify-content","center"),l(Pe,B(xt,{variant:"outline",onClick:()=>x("setup"),get children(){return[" ",Te(()=>e("common.back","Back to Setup"))]}}),null),l(Pe,B(xt,{variant:"primary",onClick:()=>x("review"),get children(){return[" ",Te(()=>e("inventory.reviewAdjustments","Review Adjustments"))]}}),null),xe.style.setProperty("border","1px solid var(--border-color)"),xe.style.setProperty("border-radius","var(--border-radius)"),xe.style.setProperty("overflow-x","auto"),he.style.setProperty("width","100%"),he.style.setProperty("border-collapse","collapse"),De.style.setProperty("background","var(--surface-color)"),ke.style.setProperty("padding","1rem"),ke.style.setProperty("text-align","left"),ke.style.setProperty("border-bottom","1px solid var(--border-color)"),l(ke,()=>e("inventory.no","No")),Ce.style.setProperty("padding","1rem"),Ce.style.setProperty("text-align","left"),Ce.style.setProperty("border-bottom","1px solid var(--border-color)"),l(Ce,()=>e("inventory.product","Product")),Le.style.setProperty("padding","1rem"),Le.style.setProperty("text-align","center"),Le.style.setProperty("border-bottom","1px solid var(--border-color)"),l(Le,()=>e("inventory.systemQty","System Qty")),Ie.style.setProperty("padding","1rem"),Ie.style.setProperty("text-align","center"),Ie.style.setProperty("border-bottom","1px solid var(--border-color)"),l(Ie,()=>e("inventory.physicalCount","Physical Count")),Re.style.setProperty("padding","1rem"),Re.style.setProperty("text-align","center"),Re.style.setProperty("border-bottom","1px solid var(--border-color)"),l(Re,()=>e("inventory.variance","Variance")),He.style.setProperty("padding","1rem"),He.style.setProperty("text-align","left"),He.style.setProperty("border-bottom","1px solid var(--border-color)"),l(He,()=>e("common.notes","Notes")),l(Me,B(Ut,{get each(){return C()},children:(Ze,Ye)=>B(tT,{get index(){return Ye()},updatePhysicalCount:A,entry:Ze,updateNotes:T})})),we(Ze=>(Ze=R().isComplete?"#4caf50":"#ff9800")!=null?ce.style.setProperty("color",Ze):ce.style.removeProperty("color")),H}}),null),l(k,B(Ge,{get when(){return w()==="review"},get children(){var H=Kk(),L=H.firstChild,j=L.firstChild;j.firstChild;var oe=j.nextSibling,K=L.nextSibling,Z=K.firstChild,J=Z.firstChild,Y=J.nextSibling,U=Z.nextSibling,ae=U.firstChild,ue=ae.nextSibling,le=U.nextSibling,q=le.firstChild,ce=q.nextSibling,Se=K.nextSibling;return L.style.setProperty("text-align","center"),L.style.setProperty("margin-bottom","2rem"),j.style.setProperty("margin-bottom","1rem"),l(j,()=>e("inventory.reviewAndConfirm","Review and Confirm Adjustments"),null),oe.style.setProperty("color","var(--text-muted)"),l(oe,()=>e("inventory.reviewDescription","Review the inventory adjustments below and confirm to update your system.")),K.style.setProperty("display","grid"),K.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),K.style.setProperty("gap","1rem"),K.style.setProperty("margin-bottom","2rem"),K.style.setProperty("padding","1rem"),K.style.setProperty("background","var(--surface-color)"),K.style.setProperty("border-radius","var(--border-radius)"),Z.style.setProperty("text-align","center"),J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","700"),J.style.setProperty("color","#4caf50"),l(J,()=>R().positiveVariances),Y.style.setProperty("font-size","0.875rem"),Y.style.setProperty("color","var(--text-muted)"),l(Y,()=>e("inventory.stockIncreases","Stock Increases")),U.style.setProperty("text-align","center"),ae.style.setProperty("font-size","1.5rem"),ae.style.setProperty("font-weight","700"),ae.style.setProperty("color","#f44336"),l(ae,()=>R().negativeVariances),ue.style.setProperty("font-size","0.875rem"),ue.style.setProperty("color","var(--text-muted)"),l(ue,()=>e("inventory.stockDecreases","Stock Decreases")),le.style.setProperty("text-align","center"),q.style.setProperty("font-size","1.5rem"),q.style.setProperty("font-weight","700"),q.style.setProperty("color","var(--primary-color)"),l(q,()=>R().variances),ce.style.setProperty("font-size","0.875rem"),ce.style.setProperty("color","var(--text-muted)"),l(ce,()=>e("inventory.totalAdjustments","Total Adjustments")),Se.style.setProperty("display","flex"),Se.style.setProperty("gap","1rem"),Se.style.setProperty("margin-bottom","2rem"),Se.style.setProperty("justify-content","center"),Se.style.setProperty("flex-wrap","wrap"),l(Se,B(xt,{variant:"outline",onClick:()=>x("counting"),get children(){return[" ",Te(()=>e("common.back","Back to Counting"))]}}),null),l(Se,B(xt,{variant:"outline",onClick:I,get disabled(){return R().variances===0},get children(){return[" ",Te(()=>e("inventory.downloadCSV","Download CSV"))]}}),null),l(Se,B(xt,{variant:"primary",onClick:b,get disabled(){return s()||R().variances===0},get children(){return Te(()=>!!s())()?" "+e("common.saving","Saving")+"...":" "+e("inventory.confirmAdjustments","Confirm Adjustments")}}),null),l(H,B(Ge,{get when(){return R().variances>0},get children(){var me=Gk(),Pe=me.firstChild,xe=Pe.firstChild,he=xe.firstChild,ve=he.firstChild,De=ve.nextSibling,ke=De.nextSibling,Ce=ke.nextSibling,Le=Ce.nextSibling,Ie=xe.nextSibling;return me.style.setProperty("border","1px solid var(--border-color)"),me.style.setProperty("border-radius","var(--border-radius)"),me.style.setProperty("overflow-x","auto"),Pe.style.setProperty("width","100%"),Pe.style.setProperty("border-collapse","collapse"),he.style.setProperty("background","var(--surface-color)"),ve.style.setProperty("padding","1rem"),ve.style.setProperty("text-align","left"),ve.style.setProperty("border-bottom","1px solid var(--border-color)"),l(ve,()=>e("inventory.product","Product")),De.style.setProperty("padding","1rem"),De.style.setProperty("text-align","center"),De.style.setProperty("border-bottom","1px solid var(--border-color)"),l(De,()=>e("inventory.systemQty","System Qty")),ke.style.setProperty("padding","1rem"),ke.style.setProperty("text-align","center"),ke.style.setProperty("border-bottom","1px solid var(--border-color)"),l(ke,()=>e("inventory.physicalCount","Physical Count")),Ce.style.setProperty("padding","1rem"),Ce.style.setProperty("text-align","center"),Ce.style.setProperty("border-bottom","1px solid var(--border-color)"),l(Ce,()=>e("inventory.adjustment","Adjustment")),Le.style.setProperty("padding","1rem"),Le.style.setProperty("text-align","left"),Le.style.setProperty("border-bottom","1px solid var(--border-color)"),l(Le,()=>e("common.notes","Notes")),l(Ie,B(Ut,{get each(){return C().filter(Re=>Re.variance!==0)},children:Re=>(()=>{var He=Xk(),Me=He.firstChild,Ze=Me.firstChild,Ye=Ze.nextSibling,ut=Ye.firstChild,rt=Me.nextSibling,We=rt.firstChild,ct=rt.nextSibling,pt=ct.firstChild,_t=ct.nextSibling,Et=_t.firstChild,et=_t.nextSibling,Ue=et.firstChild;return He.style.setProperty("border-bottom","1px solid var(--border-color)"),Me.style.setProperty("padding","1rem"),Ze.style.setProperty("font-weight","500"),l(Ze,()=>Re.product.name),Ye.style.setProperty("font-size","0.875rem"),Ye.style.setProperty("color","var(--text-muted)"),l(Ye,()=>Re.product.sku,ut),l(Ye,()=>Re.product.category,null),rt.style.setProperty("padding","1rem"),rt.style.setProperty("text-align","center"),We.style.setProperty("font-weight","600"),l(We,()=>Re.systemQuantity),ct.style.setProperty("padding","1rem"),ct.style.setProperty("text-align","center"),pt.style.setProperty("font-weight","600"),l(pt,()=>Re.physicalCount),_t.style.setProperty("padding","1rem"),_t.style.setProperty("text-align","center"),Et.style.setProperty("font-weight","700"),l(Et,()=>Re.variance>0?"+":"",null),l(Et,()=>Re.variance,null),et.style.setProperty("padding","1rem"),Ue.style.setProperty("font-size","0.875rem"),l(Ue,()=>Re.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")),we(ot=>{var Xe=Re.variance>0?"#d4edda":"#f8d7da",at=Re.variance>0?"#4caf50":"#f44336";return Xe!==ot.e&&((ot.e=Xe)!=null?He.style.setProperty("background",Xe):He.style.removeProperty("background")),at!==ot.t&&((ot.t=at)!=null?Et.style.setProperty("color",at):Et.style.removeProperty("color")),ot},{e:void 0,t:void 0}),He})()})),me}}),null),l(H,B(Ge,{get when(){return R().variances===0},get children(){var me=Yk(),Pe=me.firstChild,xe=Pe.nextSibling,he=xe.nextSibling;return me.style.setProperty("text-align","center"),me.style.setProperty("padding","3rem"),me.style.setProperty("background","var(--surface-color)"),me.style.setProperty("border-radius","var(--border-radius)"),Pe.style.setProperty("font-size","3rem"),Pe.style.setProperty("margin-bottom","1rem"),xe.style.setProperty("margin-bottom","0.5rem"),l(xe,()=>e("inventory.perfectCount","Perfect Count!")),he.style.setProperty("color","var(--text-muted)"),l(he,()=>e("inventory.noVariances","No variances found. Your physical count matches the system exactly.")),me}}),null),H}}),null),O}})},tT=t=>{const{t:e}=er(),[r,n]=$e(""),[i,o]=$e("");let{entry:s,updatePhysicalCount:a,updateNotes:c,index:u}=t;Rn(()=>{o(s?.notes),n(s?.physicalCount)});const h=()=>{let y=document.getElementById(`physicalCountInput_${u+2}`);if(console.log(uu(r()),!y),uu(r())&&!y){a(s?.productId,r()===""?null:parseFloat(r()));return}if(uu(r())&&y){y.focus(),a(s?.productId,r()===""?null:parseFloat(r()));return}};return(()=>{var y=Zk(),g=y.firstChild,p=g.firstChild,C=g.nextSibling,S=C.firstChild,w=S.nextSibling,x=w.firstChild,V=x.nextSibling;V.nextSibling;var ne=C.nextSibling,X=ne.firstChild,Q=ne.nextSibling,ee=Q.firstChild,E=Q.nextSibling,A=E.firstChild,T=E.nextSibling,R=T.firstChild;return y.style.setProperty("border-bottom","1px solid var(--border-color)"),g.style.setProperty("padding","1rem"),g.style.setProperty("text-align","center"),p.style.setProperty("font-weight","600"),l(p,u+1),C.style.setProperty("padding","1rem"),S.style.setProperty("font-weight","500"),l(S,()=>s?.product.name),w.style.setProperty("font-size","0.875rem"),w.style.setProperty("color","var(--text-muted)"),l(w,()=>s?.product.sku,x),l(w,()=>s?.product.category,V),l(w,()=>s?.product.unitOfMeasure,null),ne.style.setProperty("padding","1rem"),ne.style.setProperty("text-align","center"),X.style.setProperty("font-weight","600"),l(X,()=>s?.systemQuantity),Q.style.setProperty("padding","1rem"),Q.style.setProperty("text-align","center"),ee.addEventListener("blur",()=>{h()}),ee.$$keydown=_=>{_.keyCode===13&&h(),_.keyCode===27&&h(),_.keyCode},ee.$$input=_=>{const I=_.target.value;n(I)},Yt(ee,"id",`physicalCountInput_${u+1}`),Yt(ee,"tabindex",u),ee.style.setProperty("width","100px"),ee.style.setProperty("padding","0.5rem"),ee.style.setProperty("border","1px solid var(--border-color)"),ee.style.setProperty("border-radius","var(--border-radius-sm)"),ee.style.setProperty("text-align","center"),E.style.setProperty("padding","1rem"),E.style.setProperty("text-align","center"),A.style.setProperty("font-weight","600"),l(A,()=>s?.variance>0?"+":"",null),l(A,()=>s?.variance||"",null),T.style.setProperty("padding","1rem"),R.addEventListener("blur",_=>{c(s?.productId,i())}),R.$$keydown=_=>{_.keyCode===13&&c(s?.productId,i()),_.keyCode===27&&c(s?.productId,i()),_.keyCode===9&&c(s?.productId,i())},R.$$input=_=>{const I=_.target.value;o(I)},R.style.setProperty("width","200px"),R.style.setProperty("padding","0.5rem"),R.style.setProperty("border","1px solid var(--border-color)"),R.style.setProperty("border-radius","var(--border-radius-sm)"),we(_=>{var I=s?.physicalCount!==null?s?.variance!==0?"#fff3cd":"#d4edda":"transparent",b=s?.variance>0?"#4caf50":s?.variance<0?"#f44336":"var(--text-muted)",G=e("inventory.addNotes","Add notes...");return I!==_.e&&((_.e=I)!=null?y.style.setProperty("background",I):y.style.removeProperty("background")),b!==_.t&&((_.t=b)!=null?A.style.setProperty("color",b):A.style.removeProperty("color")),G!==_.a&&Yt(R,"placeholder",_.a=G),_},{e:void 0,t:void 0,a:void 0}),we(()=>ee.value=r()||""),we(()=>R.value=i()||""),y})()};dr(["click","input","keydown"]);function rT(t,e=300,r=!1){let n,i;const o=()=>{n!==void 0&&(clearTimeout(n),n=void 0),i=void 0},s=()=>{n!==void 0&&i!==void 0&&(clearTimeout(n),n=void 0,t(...i),i=void 0)},a=(...c)=>{i=c,n!==void 0&&clearTimeout(n),r&&n===void 0&&t(...c),n=window.setTimeout(()=>{r||t(...c),n=void 0,i=void 0},e)};return Pc(()=>{o()}),{debounced:a,cancel:o,flush:s}}function nT(t,e=300){const[r,n]=$e(!1);let i;const o=async u=>{if(i&&i.abort(),!u.trim()){n(!1);return}i=new AbortController,n(!0);try{await t(u)}catch(h){h instanceof Error&&h.name!=="AbortError"&&console.error("Search error:",h)}finally{i.signal.aborted||n(!1)}},{debounced:s,cancel:a}=rT(o,e,!1),c=()=>{a(),i&&i.abort(),n(!1)};return Pc(()=>{c()}),{search:s,isSearching:r,cancel:c}}var m0=de("<div>"),iT=de("<div><h3></h3><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),oT=de("<div><h3></h3><div><div><div><span></span><span></span></div><div><span></span><span></span></div></div><div><div><span></span><span></span></div><div><span></span><span>%"),sT=de("<div><h4>"),aT=de("<div><h3></h3><div><div><div><span></span><span> </span></div><div><span></span><span> </span></div></div><div><div><span></span><span> </span></div><div><span></span><span>"),lT=de("<div><h3></h3><div><span></span><span></span></div><div><span></span><span>"),y0=de("<div><h3>"),cT=de("<div><div><div><h2></h2><div>SKU: <!>  </div></div><div></div></div><div><button></button><button></button><button></button></div><div>"),uT=de("<span> "),dT=de("<span> "),hT=de("<div><div><span><span>  </span></span><span> </span></div><div>: <!>  <!>: "),fT=de("<div> "),pT=de("<div>Ref: "),mT=de("<div><div><div><span></span><span></span><span></span></div><div><span></span></div></div><div><div> </div><div>"),yT=de("<div><h4></h4><div></div><div>"),gT=de("<div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div> <!>  </div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div>Min: <!>  Max: ");const vT=t=>{const{t:e}=er(),[r,n]=$e("details"),i=Tt(()=>{if(!t.product)return null;const T=lt.getTotalStockByProduct(t.product.id),R=lt.getStockByProduct(t.product.id),_=T<=t.product.minStockLevel,I=T===0,b=T>=t.product.maxStockLevel;return{total:T,byLocation:R,status:I?"out":_?"low":b?"over":"good",statusText:I?e("products.outOfStock","Out of Stock"):_?e("products.lowStock","Low Stock"):b?e("products.overStock","Over Stock"):e("products.inStock","In Stock")}}),o=T=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(T),s=T=>new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),a=Tt(()=>!t.product||t.product.unitCost===0?0:((t.product.sellingPrice-t.product.unitCost)/t.product.unitCost*100).toFixed(2)),c=Tt(()=>t.product?lt.movements.filter(T=>T.productId===t.product.id).sort((T,R)=>new Date(R.createdDate).getTime()-new Date(T.createdDate).getTime()):[]),u=Tt(()=>{if(!t.product)return null;const T=c(),R=i(),_=new Date;_.setDate(_.getDate()-30);const I=T.filter(G=>new Date(G.createdDate)>=_),b=T.reduce((G,ie)=>{const F=ie.productId===t.product.id?ie:null;return G+(F?F.quantity*F.unitCost:0)},0);return{recentMovements:T.length,movements30Days:I.length,totalValue:(R?.total||0)*t.product.unitCost,averageMovementValue:T.length>0?b/T.length:0,lastMovementDate:T.length>0?T[0].createdDate:null}}),h={"margin-bottom":"2rem"},y={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},g={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},p={"font-weight":"400",color:"var(--text-primary)","font-size":"1rem"},C=T=>({in:"",out:"",transfer:"",adjustment:""})[T]||"";function S(T){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[T]||{bg:"#f5f5f5",color:"#666"}}const w=T=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:S(T).bg,color:S(T).color}),x=T=>{const R={good:{background:"#d4edda",color:"#155724"},low:{background:"#fff3cd",color:"#856404"},out:{background:"#f8d7da",color:"#721c24"},over:{background:"#cce5ff",color:"#004085"}};return{display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500",...R[T]||R.good}},V={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"},ne={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1rem","margin-bottom":"0.75rem"},X={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1.5rem","padding-bottom":"1rem","border-bottom":"2px solid var(--border-color)"},Q={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},ee=T=>({padding:"0.75rem 1.5rem",background:"none",border:"none","border-bottom":T?"2px solid var(--primary-color)":"2px solid transparent",color:T?"var(--primary-color)":"var(--text-muted)","font-weight":T?"600":"400",cursor:"pointer",transition:"all 0.2s","font-size":"0.875rem"}),E={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-bottom":"0.5rem"},A={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1.5rem","margin-bottom":"1rem"};return B(Xn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("products.productDetails","Product Details")},size:"large",get children(){return B(Ge,{get when(){return t.product},get fallback(){return(()=>{var T=m0();return T.style.setProperty("text-align","center"),T.style.setProperty("padding","2rem"),T.style.setProperty("color","var(--text-muted)"),l(T,()=>e("products.noProductSelected","No product selected")),T})()},children:T=>(()=>{var R=cT(),_=R.firstChild,I=_.firstChild,b=I.firstChild,G=b.nextSibling,ie=G.firstChild,F=ie.nextSibling;F.nextSibling;var W=I.nextSibling,z=_.nextSibling,O=z.firstChild,k=O.nextSibling,re=k.nextSibling,$=z.nextSibling;return l(R,()=>JSON.stringify(T),_),m(_,X),b.style.setProperty("margin","0"),b.style.setProperty("font-size","1.5rem"),b.style.setProperty("margin-bottom","0.25rem"),l(b,()=>T().name),G.style.setProperty("color","var(--text-muted)"),l(G,()=>T().sku,F),l(G,()=>T().category,null),l(W,()=>i()?.statusText),m(z,Q),O.$$click=()=>n("details"),l(O,()=>e("products.details","Details")),k.$$click=()=>n("movements"),l(k,()=>e("products.movements","Movements")),re.$$click=()=>n("analytics"),l(re,()=>e("products.analytics","Analytics")),l(R,B(Ge,{get when(){return r()==="details"},get children(){return[(()=>{var D=iT(),H=D.firstChild,L=H.nextSibling,j=L.firstChild,oe=j.nextSibling,K=L.nextSibling,Z=K.firstChild,J=Z.nextSibling,Y=K.nextSibling,U=Y.firstChild,ae=U.nextSibling;return H.style.setProperty("margin-bottom","1rem"),H.style.setProperty("font-size","1.1rem"),l(H,()=>e("products.basicInformation","Basic Information")),l(j,()=>e("products.description","Description")),l(oe,()=>T().description||e("common.notAvailable","N/A")),l(Z,()=>e("products.unitOfMeasure","Unit of Measure")),l(J,()=>T().unitOfMeasure),l(U,()=>e("products.status","Status")),l(ae,(()=>{var ue=Te(()=>!!T().isActive);return()=>ue()?(()=>{var le=uT();return le.firstChild,le.style.setProperty("color","#2e7d32"),l(le,()=>e("common.active","Active"),null),le})():(()=>{var le=dT();return le.firstChild,le.style.setProperty("color","#d32f2f"),l(le,()=>e("common.inactive","Inactive"),null),le})()})()),we(ue=>{var le=h,q=y,ce=g,Se=p,me=y,Pe=g,xe=p,he=y,ve=g,De=p;return ue.e=m(D,le,ue.e),ue.t=m(L,q,ue.t),ue.a=m(j,ce,ue.a),ue.o=m(oe,Se,ue.o),ue.i=m(K,me,ue.i),ue.n=m(Z,Pe,ue.n),ue.s=m(J,xe,ue.s),ue.h=m(Y,he,ue.h),ue.r=m(U,ve,ue.r),ue.d=m(ae,De,ue.d),ue},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),D})(),(()=>{var D=oT(),H=D.firstChild,L=H.nextSibling,j=L.firstChild,oe=j.firstChild,K=oe.firstChild,Z=K.nextSibling,J=oe.nextSibling,Y=J.firstChild,U=Y.nextSibling,ae=j.nextSibling,ue=ae.firstChild,le=ue.firstChild,q=le.nextSibling,ce=ue.nextSibling,Se=ce.firstChild,me=Se.nextSibling,Pe=me.firstChild;return H.style.setProperty("margin-bottom","1rem"),H.style.setProperty("font-size","1.1rem"),l(H,()=>e("products.pricingInformation","Pricing Information")),l(K,()=>e("products.unitCost","Unit Cost")),l(Z,()=>o(T().unitCost)),l(Y,()=>e("products.sellingPrice","Selling Price")),l(U,()=>o(T().sellingPrice)),l(le,()=>e("products.profit","Profit")),l(q,()=>o(T().sellingPrice-T().unitCost)),l(Se,()=>e("products.profitMargin","Profit Margin")),l(me,a,Pe),we(xe=>{var he=h,ve=V,De=y,ke=g,Ce=p,Le=y,Ie=g,Re=p,He=y,Me=g,Ze=p,Ye=y,ut=g,rt=p;return xe.e=m(D,he,xe.e),xe.t=m(L,ve,xe.t),xe.a=m(oe,De,xe.a),xe.o=m(K,ke,xe.o),xe.i=m(Z,Ce,xe.i),xe.n=m(J,Le,xe.n),xe.s=m(Y,Ie,xe.s),xe.h=m(U,Re,xe.h),xe.r=m(ue,He,xe.r),xe.d=m(le,Me,xe.d),xe.l=m(q,Ze,xe.l),xe.u=m(ce,Ye,xe.u),xe.c=m(Se,ut,xe.c),xe.w=m(me,rt,xe.w),xe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),D})(),(()=>{var D=aT(),H=D.firstChild,L=H.nextSibling,j=L.firstChild,oe=j.firstChild,K=oe.firstChild,Z=K.nextSibling,J=Z.firstChild,Y=oe.nextSibling,U=Y.firstChild,ae=U.nextSibling,ue=ae.firstChild,le=j.nextSibling,q=le.firstChild,ce=q.firstChild,Se=ce.nextSibling,me=Se.firstChild,Pe=q.nextSibling,xe=Pe.firstChild,he=xe.nextSibling;return H.style.setProperty("margin-bottom","1rem"),H.style.setProperty("font-size","1.1rem"),l(H,()=>e("products.stockInformation","Stock Information")),l(K,()=>e("products.totalStock","Total Stock")),l(Z,()=>i()?.total||0,J),l(Z,()=>T().unitOfMeasure,null),l(U,()=>e("products.minStockLevel","Min Stock Level")),l(ae,()=>T().minStockLevel,ue),l(ae,()=>T().unitOfMeasure,null),l(ce,()=>e("products.maxStockLevel","Max Stock Level")),l(Se,()=>T().maxStockLevel,me),l(Se,()=>T().unitOfMeasure,null),l(xe,()=>e("products.stockValue","Stock Value")),l(he,()=>o((i()?.total||0)*T().unitCost)),l(D,B(Ge,{get when(){return Te(()=>!!i()?.byLocation)()&&i().byLocation.length>0},get children(){var ve=sT(),De=ve.firstChild;return ve.style.setProperty("margin-top","1.5rem"),De.style.setProperty("margin-bottom","1rem"),De.style.setProperty("font-size","1rem"),l(De,()=>e("products.stockByLocation","Stock by Location")),l(ve,()=>i().byLocation.map(ke=>(()=>{var Ce=hT(),Le=Ce.firstChild,Ie=Le.firstChild,Re=Ie.firstChild;Re.firstChild;var He=Ie.nextSibling,Me=He.firstChild,Ze=Le.nextSibling,Ye=Ze.firstChild,ut=Ye.nextSibling,rt=ut.nextSibling,We=rt.nextSibling;return We.nextSibling,m(Ce,ne),Le.style.setProperty("display","flex"),Le.style.setProperty("justify-content","space-between"),Le.style.setProperty("align-items","center"),Ie.style.setProperty("font-weight","500"),Ie.style.setProperty("color","var(--primary-color)"),l(Ie,()=>ke.locationId,Re),Re.style.setProperty("font-weight","500"),Re.style.setProperty("color","var(--text-muted)"),l(Re,()=>ke.locationName,null),He.style.setProperty("font-weight","600"),l(He,()=>ke.quantity,Me),l(He,()=>T().unitOfMeasure,null),Ze.style.setProperty("margin-top","0.5rem"),Ze.style.setProperty("font-size","0.875rem"),Ze.style.setProperty("color","var(--text-muted)"),l(Ze,()=>e("products.available","Available"),Ye),l(Ze,()=>ke.availableQuantity,ut),l(Ze,()=>e("products.reserved","Reserved"),We),l(Ze,()=>ke.reservedQuantity,null),we(ct=>(ct=ke.quantity>0?"var(--primary-color)":"var(--text-muted)")!=null?He.style.setProperty("color",ct):He.style.removeProperty("color")),Ce})()),null),ve}}),null),we(ve=>{var De=h,ke=V,Ce=y,Le=g,Ie=p,Re=y,He=g,Me=p,Ze=y,Ye=g,ut=p,rt=y,We=g,ct=p;return ve.e=m(D,De,ve.e),ve.t=m(L,ke,ve.t),ve.a=m(oe,Ce,ve.a),ve.o=m(K,Le,ve.o),ve.i=m(Z,Ie,ve.i),ve.n=m(Y,Re,ve.n),ve.s=m(U,He,ve.s),ve.h=m(ae,Me,ve.h),ve.r=m(q,Ze,ve.r),ve.d=m(ce,Ye,ve.d),ve.l=m(Se,ut,ve.l),ve.u=m(Pe,rt,ve.u),ve.c=m(xe,We,ve.c),ve.w=m(he,ct,ve.w),ve},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),D})(),(()=>{var D=lT(),H=D.firstChild,L=H.nextSibling,j=L.firstChild,oe=j.nextSibling,K=L.nextSibling,Z=K.firstChild,J=Z.nextSibling;return H.style.setProperty("margin-bottom","1rem"),H.style.setProperty("font-size","1.1rem"),l(H,()=>e("products.timestamps","Timestamps")),l(j,()=>e("common.createdDate","Created Date")),l(oe,()=>s(T().createdDate)),l(Z,()=>e("common.lastModified","Last Modified")),l(J,()=>s(T().lastModified)),we(Y=>{var U=h,ae=y,ue=g,le=p,q=y,ce=g,Se=p;return Y.e=m(D,U,Y.e),Y.t=m(L,ae,Y.t),Y.a=m(j,ue,Y.a),Y.o=m(oe,le,Y.o),Y.i=m(K,q,Y.i),Y.n=m(Z,ce,Y.n),Y.s=m(J,Se,Y.s),Y},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),D})()]}}),$),l(R,B(Ge,{get when(){return r()==="movements"},get children(){var D=y0(),H=D.firstChild;return H.style.setProperty("margin-bottom","1rem"),H.style.setProperty("font-size","1.1rem"),l(H,()=>e("products.recentMovements","Recent Movements")),l(D,B(Ge,{get when(){return c().length>0},get fallback(){return(()=>{var L=fT();return L.firstChild,L.style.setProperty("text-align","center"),L.style.setProperty("padding","2rem"),L.style.setProperty("color","var(--text-muted)"),L.style.setProperty("background","var(--surface-color)"),L.style.setProperty("border-radius","var(--border-radius-sm)"),L.style.setProperty("border","1px solid var(--border-color)"),l(L,()=>e("products.noMovements","No movements found for this product"),null),L})()},get children(){return B(Ut,{get each(){return c()},children:L=>{const j=L.productId===T().id?L:null;if(!j)return null;let oe=lt.getLocationById(L.locationId);return(()=>{var K=mT(),Z=K.firstChild,J=Z.firstChild,Y=J.firstChild,U=Y.nextSibling,ae=U.nextSibling,ue=J.nextSibling,le=ue.firstChild,q=Z.nextSibling,ce=q.firstChild,Se=ce.firstChild,me=ce.nextSibling;return m(K,E),J.style.setProperty("font-weight","600"),J.style.setProperty("margin-bottom","0.25rem"),Y.style.setProperty("font-size","1.2rem"),l(Y,()=>C(L.movementType)),U.style.setProperty("padding","0 6px"),l(ae,()=>L.movementType),ue.style.setProperty("font-size","0.875rem"),ue.style.setProperty("color","var(--text-muted)"),l(ue,()=>` ${s(L?.createdDate)}  `,le),le.style.setProperty("font-size","0.875rem"),le.style.setProperty("font-weight","600"),le.style.setProperty("color","var(--primary-color)"),l(le,()=>L?.locationId),l(ue,()=>`  ${oe?.name}`,null),l(Z,B(Ge,{get when(){return L.referenceNumber},get children(){var Pe=pT();return Pe.firstChild,Pe.style.setProperty("font-size","0.75rem"),Pe.style.setProperty("color","var(--text-muted)"),Pe.style.setProperty("margin-top","0.25rem"),l(Pe,()=>L?.referenceNumber,null),Pe}}),null),q.style.setProperty("text-align","right"),ce.style.setProperty("font-weight","600"),ce.style.setProperty("font-size","1rem"),l(ce,()=>L?.movementType==="in"?"+":"",Se),l(ce,()=>j.quantity,Se),l(ce,()=>T().unitOfMeasure,null),me.style.setProperty("font-size","0.875rem"),me.style.setProperty("color","var(--text-muted)"),l(me,()=>o(j.unitCost)),we(Pe=>{var xe=w(L.movementType),he=L?.movementType==="in"?"#2e7d32":"#d32f2f";return Pe.e=m(ae,xe,Pe.e),he!==Pe.t&&((Pe.t=he)!=null?ce.style.setProperty("color",he):ce.style.removeProperty("color")),Pe},{e:void 0,t:void 0}),K})()}})}}),null),we(L=>m(D,h,L)),D}}),$),l(R,B(Ge,{get when(){return r()==="analytics"},get children(){var D=y0(),H=D.firstChild;return H.style.setProperty("margin-bottom","1rem"),H.style.setProperty("font-size","1.1rem"),l(H,()=>e("products.analytics","Analytics")),l(D,B(Ge,{get when(){return u()},get fallback(){return(()=>{var L=m0();return L.style.setProperty("text-align","center"),L.style.setProperty("padding","2rem"),L.style.setProperty("color","var(--text-muted)"),l(L,()=>e("products.noAnalytics","No analytics data available")),L})()},children:L=>(()=>{var j=gT(),oe=j.firstChild,K=oe.firstChild,Z=K.nextSibling,J=Z.nextSibling,Y=oe.nextSibling,U=Y.firstChild,ae=U.nextSibling,ue=ae.nextSibling,le=Y.nextSibling,q=le.firstChild,ce=q.nextSibling,Se=ce.nextSibling,me=Se.firstChild,Pe=me.nextSibling;Pe.nextSibling;var xe=le.nextSibling,he=xe.firstChild,ve=he.nextSibling,De=ve.nextSibling,ke=xe.nextSibling,Ce=ke.firstChild,Le=Ce.nextSibling,Ie=Le.nextSibling,Re=Ie.firstChild,He=Re.nextSibling;return He.nextSibling,K.style.setProperty("margin","0 0 0.5rem 0"),K.style.setProperty("color","var(--primary-color)"),l(K,()=>e("products.totalMovements","Total Movements")),Z.style.setProperty("font-size","1.5rem"),Z.style.setProperty("font-weight","600"),l(Z,()=>L().recentMovements),J.style.setProperty("font-size","0.875rem"),J.style.setProperty("color","var(--text-muted)"),J.style.setProperty("margin-top","0.25rem"),l(J,()=>e("products.allTime","All time")),U.style.setProperty("margin","0 0 0.5rem 0"),U.style.setProperty("color","var(--primary-color)"),l(U,()=>e("products.last30Days","Last 30 Days")),ae.style.setProperty("font-size","1.5rem"),ae.style.setProperty("font-weight","600"),l(ae,()=>L().movements30Days),ue.style.setProperty("font-size","0.875rem"),ue.style.setProperty("color","var(--text-muted)"),ue.style.setProperty("margin-top","0.25rem"),l(ue,()=>e("products.movements","movements")),q.style.setProperty("margin","0 0 0.5rem 0"),q.style.setProperty("color","var(--primary-color)"),l(q,()=>e("products.currentValue","Current Stock Value")),ce.style.setProperty("font-size","1.5rem"),ce.style.setProperty("font-weight","600"),l(ce,()=>o(L().totalValue)),Se.style.setProperty("font-size","0.875rem"),Se.style.setProperty("color","var(--text-muted)"),Se.style.setProperty("margin-top","0.25rem"),l(Se,()=>i()?.total||0,me),l(Se,()=>T().unitOfMeasure,Pe),l(Se,()=>o(T().unitCost),null),he.style.setProperty("margin","0 0 0.5rem 0"),he.style.setProperty("color","var(--primary-color)"),l(he,()=>e("products.avgMovementValue","Avg Movement Value")),ve.style.setProperty("font-size","1.5rem"),ve.style.setProperty("font-weight","600"),l(ve,()=>o(L().averageMovementValue)),De.style.setProperty("font-size","0.875rem"),De.style.setProperty("color","var(--text-muted)"),De.style.setProperty("margin-top","0.25rem"),l(De,()=>e("products.perMovement","per movement")),l(j,B(Ge,{get when(){return L().lastMovementDate},get children(){var Me=yT(),Ze=Me.firstChild,Ye=Ze.nextSibling,ut=Ye.nextSibling;return Ze.style.setProperty("margin","0 0 0.5rem 0"),Ze.style.setProperty("color","var(--primary-color)"),l(Ze,()=>e("products.lastMovement","Last Movement")),Ye.style.setProperty("font-size","1.25rem"),Ye.style.setProperty("font-weight","600"),l(Ye,()=>s(L().lastMovementDate)),ut.style.setProperty("font-size","0.875rem"),ut.style.setProperty("color","var(--text-muted)"),ut.style.setProperty("margin-top","0.25rem"),l(ut,()=>e("products.mostRecent","Most recent activity")),we(rt=>m(Me,A,rt)),Me}}),ke),Ce.style.setProperty("margin","0 0 0.5rem 0"),Ce.style.setProperty("color","var(--primary-color)"),l(Ce,()=>e("products.stockStatus","Stock Status")),Le.style.setProperty("font-size","1.25rem"),Le.style.setProperty("font-weight","600"),l(Le,()=>i()?.statusText),Ie.style.setProperty("font-size","0.875rem"),Ie.style.setProperty("color","var(--text-muted)"),Ie.style.setProperty("margin-top","0.25rem"),l(Ie,()=>T().minStockLevel,He),l(Ie,()=>T().maxStockLevel,null),we(Me=>{var Ze=V,Ye=A,ut=A,rt=A,We=A,ct=A;return Me.e=m(j,Ze,Me.e),Me.t=m(oe,Ye,Me.t),Me.a=m(Y,ut,Me.a),Me.o=m(le,rt,Me.o),Me.i=m(xe,We,Me.i),Me.n=m(ke,ct,Me.n),Me},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),j})()}),null),we(L=>m(D,h,L)),D}}),$),$.style.setProperty("display","flex"),$.style.setProperty("gap","1rem"),$.style.setProperty("justify-content","flex-end"),$.style.setProperty("margin-top","2rem"),l($,B(xt,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close","Close")}}),null),l($,B(Ge,{get when(){return t.onEdit},get children(){return B(xt,{variant:"primary",get onClick(){return t.onEdit},get children(){return e("common.edit","Edit")}})}}),null),we(D=>{var H=x(i()?.status||"good"),L=ee(r()==="details"),j=ee(r()==="movements"),oe=ee(r()==="analytics");return D.e=m(W,H,D.e),D.t=m(O,L,D.t),D.a=m(k,j,D.a),D.o=m(re,oe,D.o),D},{e:void 0,t:void 0,a:void 0,o:void 0}),R})()})}})};dr(["click"]);var bT=de("<div>"),_T=de("<button type=button>"),wT=de("<div> "),g0=de("<div>"),ST=de("<div><div><input type=text autocomplete=off>"),PT=de("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div>"),xT=de("<span> ");const AT=t=>{const{t:e}=er(),[r,n]=$e(""),[i,o]=$e(!1),[s,a]=$e(null),[c,u]=$e([]),[h,y]=$e(!1),[g,p]=$e(-1),[C,S]=$e(null),w=t.searchDelay||300,x=t.maxResults||900,V=async L=>{if(!L.trim()||L.trim().length<3){u([]),t.onSearchResults?.([]);return}try{o(!0),a(null);try{const j=await Ai.getProducts(L),oe=Object.keys(j),K=J=>{let Y=j;return{id:J,name:Y[J].name,businessId:Y[J].businessId,sku:Y[J].code,UPC:Y[J].UPC,numCode:Y[J].codeN,category:Y[J].category,unitCost:Y[J].unitCost||0,unitOfMeasure:Y[J].unitOfMeasure,minStockLevel:Y[J].minStockLevel,maxStockLevel:Y[J].maxStockLevel,isActive:Y[J].isActive,description:Y[J].description||"",createdDate:Y[J].createdAt||new Date().toISOString(),lastModified:Y[J].updatedAt||new Date().toISOString()}},Z=oe.map(K);u(Z),lt.updProduct(Z),t.onSearchResults?.(Z)}catch(j){console.warn("API search failed, using local fallback:",j),a("API search failed, showing local results");const oe=lt.getActiveProducts().filter(K=>K.name.toLowerCase().includes(L.toLowerCase())||K.sku.toLowerCase().includes(L.toLowerCase())||K.category.toLowerCase().includes(L.toLowerCase())).slice(0,x);u(oe),t.onSearchResults?.(oe)}}catch(j){const oe=j instanceof Error?j.message:"Search failed";a(oe),u([]),t.onSearchResults?.([])}finally{o(!1)}},ne=L=>{const oe=L.target.value;n(oe),a(null),t.showResults!==!1&&y(!0),C()&&clearTimeout(C());const K=setTimeout(()=>{V(oe)},w);S(K)},X=L=>{n(L.name),y(!1),p(-1),t.onProductSelect?.(L)},Q=L=>{if(!(!h()||c().length===0))switch(L.key){case"ArrowDown":L.preventDefault(),p(j=>Math.min(j+1,c().length-1));break;case"ArrowUp":L.preventDefault(),p(j=>Math.max(j-1,-1));break;case"Enter":L.preventDefault(),g()>=0&&c()[g()]&&X(c()[g()]);break;case"Escape":y(!1),p(-1);break}},ee=()=>{t.showResults!==!1&&c().length>0&&y(!0)},E=()=>{setTimeout(()=>{y(!1),p(-1)},150)},A=()=>{n(""),u([]),a(null),y(!1),p(-1),t.onSearchResults?.([]),C()&&(clearTimeout(C()),S(null))},T=L=>lt.stockLevels.filter(j=>j.productId===L).reduce((j,oe)=>j+oe.quantity,0),R=L=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(L),_={position:"relative",width:"100%",...t.style},I={position:"relative",display:"flex","align-items":"center"},b={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},G={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},ie={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},F={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},W=L=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:L?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),z={display:"flex","justify-content":"space-between","align-items":"center"},O={flex:"1"},k={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},re={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},$={"text-align":"right","font-size":"0.875rem"},D={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},H={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var L=ST(),j=L.firstChild,oe=j.firstChild;return oe.addEventListener("blur",E),oe.addEventListener("focus",ee),oe.$$keydown=Q,oe.$$input=ne,l(j,B(Ge,{get when(){return i()},get children(){var K=bT();return we(Z=>m(K,ie,Z)),K}}),null),l(j,B(Ge,{get when(){return Te(()=>!!r())()&&!i()},get children(){var K=_T();return K.addEventListener("mouseleave",Z=>{Z.currentTarget.style.background="none",Z.currentTarget.style.color="var(--text-muted)"}),K.addEventListener("mouseenter",Z=>{Z.currentTarget.style.background="var(--border-color)",Z.currentTarget.style.color="var(--text-primary)"}),K.$$click=A,we(Z=>{var J=G,Y=e("common.clear","Clear search");return Z.e=m(K,J,Z.e),Y!==Z.t&&Yt(K,"title",Z.t=Y),Z},{e:void 0,t:void 0}),K}}),null),l(L,B(Ge,{get when(){return h()&&t.showResults!==!1},get children(){var K=g0();return l(K,B(Ge,{get when(){return s()},get children(){var Z=wT();return Z.firstChild,m(Z,H),l(Z,s,null),Z}}),null),l(K,B(Ge,{get when(){return c().length>0},get fallback(){return Te(()=>!!(r()&&!i()))()&&(()=>{var Z=g0();return m(Z,D),l(Z,()=>e("inventory.noProductsFound","No products found matching your search.")),Z})()},get children(){return B(Ut,{get each(){return c()},children:(Z,J)=>{const Y=T(Z.id),U=Y<=Z.minStockLevel;return(()=>{var ae=PT(),ue=ae.firstChild,le=ue.firstChild,q=le.firstChild,ce=q.nextSibling,Se=ce.firstChild,me=Se.firstChild,Pe=Se.nextSibling,xe=Pe.nextSibling,he=xe.nextSibling,ve=he.nextSibling,De=le.nextSibling,ke=De.firstChild,Ce=ke.firstChild,Le=ke.nextSibling;return ae.addEventListener("mouseenter",()=>p(J())),ae.$$click=()=>X(Z),m(ue,z),m(le,O),m(q,k),l(q,()=>Z.name),m(ce,re),l(Se,()=>e("inventory.sku","SKU"),me),l(Se,()=>Z.sku,null),l(xe,()=>Z.category),l(ve,()=>R(Z.unitCost)),m(De,$),ke.style.setProperty("font-weight","600"),(U?"#f44336":"var(--text-primary)")!=null?ke.style.setProperty("color",U?"#f44336":"var(--text-primary)"):ke.style.removeProperty("color"),l(ke,Y,Ce),l(ke,()=>Z.unitOfMeasure,null),Le.style.setProperty("color","var(--text-muted)"),l(Le,()=>U?(()=>{var Ie=xT();return Ie.firstChild,Ie.style.setProperty("color","#f44336"),l(Ie,()=>e("inventory.lowStock","Low Stock"),null),Ie})():e("inventory.inStock","In Stock")),we(Ie=>m(ae,W(J()===g()),Ie)),ae})()}})}}),null),we(Z=>m(K,F,Z)),K}}),null),we(K=>{var Z=_,J=I,Y=b,U=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),ae=t.disabled;return K.e=m(L,Z,K.e),K.t=m(j,J,K.t),K.a=m(oe,Y,K.a),U!==K.o&&Yt(oe,"placeholder",K.o=U),ae!==K.i&&(oe.disabled=K.i=ae),K},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),we(()=>oe.value=r()),L})()};dr(["input","keydown","click"]);var CT=de("<div><div><h2></h2><div><div>"),IT=de("<div><span>"),$T=de("<span> "),ET=de("<div><div><div><div><h3></h3><span></span></div><div></div><div>: </div></div><div><div></div><div>  <!>: </div><div>: "),kT=de("<div><div>:</div><div>"),TT=de("<div>: "),NT=de("<div><div><span>:</span><select><option value=10>10</option><option value=20>20</option><option value=50>50</option><option value=100>100</option></select></div><div><div><span></span><input type=number min=1><span> </span></div></div><div>");const w5=()=>{const{t}=er(),[e,r]=$e(""),[n,i]=$e(""),[o,s]=$e([]),[a,c]=$e(!1),[u,h]=$e(null),[y,g]=$e(!1),[p,C]=$e(!1),[S,w]=$e(!1),[x,V]=$e(null),[ne,X]=$e(!1),[Q,ee]=$e([]),[E,A]=$e(!1),[T,R]=$e(1),[_,I]=$e(20);Rn(async()=>{await b()});const b=async()=>{try{c(!0),h(null);try{const L=await wg.getAll();s(L.map(j=>({id:j.id||`prod-${Date.now()}-${Math.random()}`,name:j.productName||j.name||"Unknown Product",sku:j.sku||j.productCode||"",description:j.description||"",category:j.category||"General",unitOfMeasure:j.unitOfMeasure||"pcs",unitCost:parseFloat(j.unitCost||j.cost||"0"),sellingPrice:parseFloat(j.sellingPrice||j.price||"0"),minStockLevel:parseInt(j.minStockLevel||"0"),maxStockLevel:parseInt(j.maxStockLevel||"100"),isActive:j.isActive!==!1,createdDate:j.createdDate||new Date().toISOString(),lastModified:j.lastModified||new Date().toISOString(),businessId:j.businessId||"YB100423253156428"})))}catch(L){console.warn("API failed, using local store:",L),s(lt.products)}}catch(L){h(L instanceof Error?L.message:"Failed to load products")}finally{c(!1)}},G=async()=>{try{c(!0),h(null);try{const L=await Ai.getProducts("prod"),j=Object.keys(L),oe=Z=>{let Y=L[Z];return{id:Y.id,name:Y.name,businessId:Y.businessId,sku:Y.code,numCode:Y.codeN,category:Y.category,unitCost:Y.unitCost||0,unitOfMeasure:Y.unitOfMeasure,minStockLevel:Y.minStockLevel,maxStockLevel:Y.maxStockLevel,isActive:Y.isActive,description:Y.description||"",createdDate:Y.createdAt||new Date().toISOString(),lastModified:Y.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(Y.sellingPrice||Y.price||"0")}},K=j.map(oe);s(K)}catch(L){console.warn("API failed, using local store:",L),s(lt.products)}}catch(L){h(L instanceof Error?L.message:"Failed to load products")}finally{c(!1)}},{cancel:ie}=nT(async L=>{if(!L.trim()){await b();return}try{h(null);const j=await wg.getAll(L);s(j.map(oe=>({id:oe.id||`prod-${Date.now()}-${Math.random()}`,name:oe.productName||oe.name||"Unknown Product",sku:oe.sku||oe.productCode||"",description:oe.description||"",category:oe.category||"General",unitOfMeasure:oe.unitOfMeasure||"pcs",unitCost:parseFloat(oe.unitCost||oe.cost||"0"),sellingPrice:parseFloat(oe.sellingPrice||oe.price||"0"),minStockLevel:parseInt(oe.minStockLevel||"0"),maxStockLevel:parseInt(oe.maxStockLevel||"100"),isActive:oe.isActive!==!1,createdDate:oe.createdDate||new Date().toISOString(),lastModified:oe.lastModified||new Date().toISOString(),businessId:oe.businessId||"YB100423253156428"})))}catch(j){h(j instanceof Error?j.message:"Search failed");const oe=lt.products.filter(K=>K.name.toLowerCase().includes(L.toLowerCase())||K.sku.toLowerCase().includes(L.toLowerCase())||K.category.toLowerCase().includes(L.toLowerCase()));s(oe)}},300);Pc(()=>{ie()}),Tt(()=>{let L=o();return n()&&(L=L.filter(j=>j.category===n())),L}),Tt(()=>[...new Set(o().map(j=>j.category))].sort()),Tt(()=>{const L=o().filter(K=>K.isActive),j=o().length,oe=o().filter(K=>lt.getTotalStockByProduct(K.id)===0);return{total:j,active:L.length,outOfStock:oe.length}});const F=L=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(L),W={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},z={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},O=L=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:L?"#ffebee":"#e8f5e8",color:L?"#d32f2f":"#2d7d32"});Tt(()=>{const L=lt.products||[],j=lt.movements||[],oe=lt.stockLevels||[],K=lt.getLowStockProducts(),Z=L?.length||0,J=L?.filter(ae=>ae.isActive).length,Y=oe.reduce((ae,ue)=>ae*1+ue.quantity*1*ue.averageCost*1,0),U=j?.filter(ae=>{const ue=new Date(ae.createdDate),le=new Date;return ue.getMonth()===le.getMonth()&&ue.getFullYear()===le.getFullYear()}).length;return{totalProducts:Z,activeProducts:J,lowStockProducts:K.length,totalStockValue:Y,totalMovementsThisMonth:U,totalLocations:lt.locations.length,activeLocations:lt.getActiveLocations().length}});const k=Tt(()=>lt.products.map(L=>{const j=lt.getStockByProduct(L.id),oe=lt.getTotalStockByProduct(L.id),K=lt.getLastLocationByProduct(L.id);return{...L,totalStock:oe,stockByLocation:j,lastLocation:K,isLowStock:oe<=L.minStockLevel}})),re=Tt(()=>Q().map(L=>{const j=lt.getStockByProduct(L.id),oe=lt.getTotalStockByProduct(L.id),K=lt.getLastLocationByProduct(L.id);return{...L,totalStock:oe,stockByLocation:j,lastLocation:K,isLowStock:oe<=L.minStockLevel}})),$=Tt(()=>{const L=E()?re():k(),j=(T()-1)*_(),oe=j+_();return L.slice(j,oe)}),D=Tt(()=>{const L=E()?re():k();return Math.ceil(L.length/_())}),H=L=>{V(L),C(!0)};return B(ro,{get title(){return t("products.title","Products")},get children(){return[(()=>{var L=CT(),j=L.firstChild,oe=j.firstChild,K=oe.nextSibling,Z=K.firstChild;return L.style.setProperty("display","flex"),L.style.setProperty("justify-content","space-between"),L.style.setProperty("align-items","flex-start"),L.style.setProperty("margin-bottom","1.5rem"),L.style.setProperty("flex-wrap","wrap"),L.style.setProperty("gap","1rem"),j.style.setProperty("flex","1"),j.style.setProperty("min-width","300px"),oe.style.setProperty("margin","0 0 1rem 0"),oe.style.setProperty("font-size","1.5rem"),l(oe,()=>t("inventory.products")),K.style.setProperty("display","flex"),K.style.setProperty("gap","1rem"),K.style.setProperty("align-items","center"),K.style.setProperty("flex-wrap","wrap"),Z.style.setProperty("flex","1"),Z.style.setProperty("min-width","250px"),l(Z,B(AT,{onSearchResults:J=>{ee(J),A(J.length>0)},get placeholder(){return t("inventory.searchProductsStock","Search products and check stock levels...")},showResults:!1,maxResults:20})),l(K,B(xt,{variant:"outline",onClick:()=>{G(),A(!1)},get children(){return[" ",Te(()=>t("common.showAll","Show All"))]}}),null),l(L,B(Ge,{get when(){return Ar.hasPermission("read_write")},get children(){return B(xt,{variant:"primary",onClick:()=>X(!0),get children(){return[" ",Te(()=>t("inventory.addProduct"))]}})}}),null),L})(),(()=>{var L=IT(),j=L.firstChild;return L.style.setProperty("margin-bottom","1rem"),L.style.setProperty("font-size","0.875rem"),L.style.setProperty("color","var(--text-muted)"),L.style.setProperty("display","flex"),L.style.setProperty("justify-content","space-between"),L.style.setProperty("align-items","center"),l(j,(()=>{var oe=Te(()=>!!E());return()=>oe()?`${t("inventory.searchResults","Search Results")}: ${re().length} ${t("common.products","products")}`:`${t("inventory.totalProducts","Total Products")}: ${k().length} ${t("common.products","products")}`})()),l(L,(()=>{var oe=Te(()=>!!E());return()=>oe()&&(()=>{var K=$T();return K.firstChild,K.style.setProperty("color","var(--primary-color)"),l(K,()=>t("inventory.filtered","Filtered view"),null),K})()})(),null),L})(),B(Ut,{get each(){return $()},children:L=>(()=>{var j=ET(),oe=j.firstChild,K=oe.firstChild,Z=K.firstChild,J=Z.firstChild,Y=J.nextSibling,U=Z.nextSibling,ae=U.nextSibling,ue=ae.firstChild,le=K.nextSibling,q=le.firstChild,ce=q.nextSibling,Se=ce.firstChild,me=Se.nextSibling;me.nextSibling;var Pe=ce.nextSibling,xe=Pe.firstChild;return j.$$click=()=>H(L),j.addEventListener("mouseleave",he=>{he.currentTarget.style.transform="translateY(0)",he.currentTarget.style.boxShadow="none"}),j.addEventListener("mouseenter",he=>{he.currentTarget.style.transform="translateY(-2px)",he.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),m(j,W),m(oe,z),Z.style.setProperty("display","flex"),Z.style.setProperty("align-items","center"),Z.style.setProperty("gap","0.5rem"),Z.style.setProperty("margin-bottom","0.5rem"),J.style.setProperty("margin","0"),J.style.setProperty("font-size","1.1rem"),l(J,()=>L.name),l(Y,(()=>{var he=Te(()=>!!L.isLowStock);return()=>he()?t("inventory.lowStockAlert"):t("inventory.inStock")})()),U.style.setProperty("font-size","0.875rem"),U.style.setProperty("color","var(--text-muted)"),l(U,()=>L.sku,null),l(U,()=>L.UPC?"  "+L.UPC:"",null),l(U,()=>L.category?"  "+L.category:"",null),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),l(ae,()=>t("inventory.lastSeen"),ue),l(ae,()=>L.lastLocation?.name||t("inventory.noMovements"),null),le.style.setProperty("text-align","right"),q.style.setProperty("font-size","1.25rem"),q.style.setProperty("font-weight","700"),q.style.setProperty("color","var(--primary-color)"),l(q,()=>L.totalStock),ce.style.setProperty("font-size","0.875rem"),ce.style.setProperty("color","var(--text-muted)"),l(ce,()=>L.unitOfMeasure,Se),l(ce,()=>t("inventory.min"),me),l(ce,()=>L.minStockLevel,null),Pe.style.setProperty("font-size","0.875rem"),Pe.style.setProperty("color","var(--text-muted)"),l(Pe,()=>t("inventory.cost"),xe),l(Pe,()=>F(L.unitCost),null),l(j,(()=>{var he=Te(()=>L?.stockByLocation?.length>0);return()=>he()&&(()=>{var ve=kT(),De=ve.firstChild,ke=De.firstChild,Ce=De.nextSibling;return ve.style.setProperty("margin-top","1rem"),De.style.setProperty("font-weight","500"),De.style.setProperty("margin-bottom","0.5rem"),De.style.setProperty("font-size","0.875rem"),l(De,()=>t("inventory.stockByLocation"),ke),Ce.style.setProperty("display","flex"),Ce.style.setProperty("flex-wrap","wrap"),Ce.style.setProperty("gap","0.5rem"),l(Ce,B(Ut,{get each(){return L.stockByLocation},children:Le=>{const Ie=lt.getLocationById(Le.locationId);return(()=>{var Re=TT(),He=Re.firstChild;return Re.style.setProperty("padding","0.25rem 0.5rem"),Re.style.setProperty("background","var(--background-color)"),Re.style.setProperty("border-radius","var(--border-radius-sm)"),Re.style.setProperty("font-size","0.75rem"),Re.style.setProperty("border","1px solid var(--border-color)"),l(Re,()=>Ie?.name,He),l(Re,()=>Le.quantity,null),Re})()}})),ve})()})(),null),we(he=>m(Y,O(L.isLowStock),he)),j})()}),Te(()=>Te(()=>D()>1)()&&(()=>{var L=NT(),j=L.firstChild,oe=j.firstChild,K=oe.firstChild,Z=oe.nextSibling,J=j.nextSibling,Y=J.firstChild,U=Y.firstChild,ae=U.nextSibling,ue=ae.nextSibling,le=ue.firstChild,q=J.nextSibling;return L.style.setProperty("display","flex"),L.style.setProperty("justify-content","space-between"),L.style.setProperty("align-items","center"),L.style.setProperty("margin-top","2rem"),L.style.setProperty("padding","1rem"),L.style.setProperty("background","var(--surface-color)"),L.style.setProperty("border-radius","var(--border-radius)"),L.style.setProperty("border","1px solid var(--border-color)"),j.style.setProperty("display","flex"),j.style.setProperty("align-items","center"),j.style.setProperty("gap","0.5rem"),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),l(oe,()=>t("common.showPerPage","Show per page"),K),Z.addEventListener("change",ce=>{I(parseInt(ce.target.value)),R(1)}),Z.style.setProperty("padding","0.25rem 0.5rem"),Z.style.setProperty("border","1px solid var(--border-color)"),Z.style.setProperty("border-radius","var(--border-radius-sm)"),Z.style.setProperty("background","var(--background-color)"),Z.style.setProperty("cursor","pointer"),J.style.setProperty("display","flex"),J.style.setProperty("align-items","center"),J.style.setProperty("gap","0.5rem"),l(J,B(xt,{variant:"outline",size:"sm",onClick:()=>R(1),get disabled(){return T()===1},get children(){return t("common.first","First")}}),Y),l(J,B(xt,{variant:"outline",size:"sm",onClick:()=>R(ce=>Math.max(1,ce-1)),get disabled(){return T()===1},get children(){return t("common.previous","Previous")}}),Y),Y.style.setProperty("display","flex"),Y.style.setProperty("align-items","center"),Y.style.setProperty("gap","0.25rem"),U.style.setProperty("font-size","0.875rem"),l(U,()=>t("common.page","Page")),ae.addEventListener("change",ce=>{const Se=parseInt(ce.target.value);Se>=1&&Se<=D()&&R(Se)}),ae.style.setProperty("width","60px"),ae.style.setProperty("padding","0.25rem 0.5rem"),ae.style.setProperty("border","1px solid var(--border-color)"),ae.style.setProperty("border-radius","var(--border-radius-sm)"),ae.style.setProperty("text-align","center"),ae.style.setProperty("font-size","0.875rem"),ue.style.setProperty("font-size","0.875rem"),l(ue,()=>t("common.of","of"),le),l(ue,D,null),l(J,B(xt,{variant:"outline",size:"sm",onClick:()=>R(ce=>Math.min(D(),ce+1)),get disabled(){return T()===D()},get children(){return t("common.next","Next")}}),null),l(J,B(xt,{variant:"outline",size:"sm",onClick:()=>R(D()),get disabled(){return T()===D()},get children(){return t("common.last","Last")}}),null),q.style.setProperty("font-size","0.875rem"),q.style.setProperty("color","var(--text-muted)"),l(q,()=>{const ce=E()?re():k(),Se=(T()-1)*_()+1,me=Math.min(T()*_(),ce.length);return t("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:Se,end:me,total:ce.length})}),we(()=>Yt(ae,"max",D())),we(()=>Z.value=_()),we(()=>ae.value=T()),L})()),B(Ny,{get isOpen(){return y()},onClose:()=>g(!1),onProductAdded:()=>{b()}}),B(vT,{get isOpen(){return p()},onClose:()=>{C(!1),V(null)},get product(){return x()},onEdit:()=>{C(!1),w(!0)}})]}})};dr(["click"]);var LT=de("<div><div></div><div>"),DT=de("<div><div><img></div><div>X</div><div><div><h2></h2><div></div></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),RT=de("<div>"),MT=de("<div><div></div><h3></h3><p>"),FT=de("<div><div>"),OT=de("<div>"),BT=de("<div><div><img loading=lazy></div><div><div></div><div>  </div><div></div><div>",!0,!1,!1);const jT=t=>{const{t:e}=er(),[r,n]=$e(null),[i,o]=$e([]),[s,a]=$e(!1),c=W=>{n(W),t.onProductSelect?.(W)},u=()=>{n(null),t.onProductSelect?.(null),o([]),a(!1)},h=W=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(W),y=()=>"YABABYSSolution",g=()=>"https://qvamarkets.s3.us-east-2.amazonaws.com/V2_images/7258/",p=W=>{if(W.productImageUrl)return g()+y()+"/"+W?.productImageUrl;const z={Electronics:"https://via.placeholder.com/400x300/4F46E5/FFFFFF?text=Electronics",Furniture:"https://via.placeholder.com/400x300/059669/FFFFFF?text=Furniture",Food:"https://via.placeholder.com/400x300/DC2626/FFFFFF?text=Food",Clothing:"https://via.placeholder.com/400x300/7C3AED/FFFFFF?text=Clothing",Tools:"https://via.placeholder.com/400x300/EA580C/FFFFFF?text=Tools",General:"https://via.placeholder.com/400x300/6B7280/FFFFFF?text=Product"};return z[W.category]||z.General},C={padding:"2rem"},S={"max-width":"600px",margin:"0 auto 2rem",position:"relative"},w={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},x={background:"var(--surface-color)","border-radius":"var(--border-radius)",overflow:"hidden","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.3s ease"},V={position:"relative",width:"100%",height:"200px",overflow:"hidden",background:"#f5f5f5"},ne={width:"100%",height:"100%","object-fit":"cover",transition:"transform 0.3s ease"},X={padding:"1rem"},Q={"font-size":"1rem","font-weight":"600","margin-bottom":"0.5rem",color:"var(--text-primary)",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},ee={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.25rem"},E={"font-size":"1.25rem","font-weight":"700",color:"var(--primary-color)","margin-top":"0.5rem"},A={display:"flex",gap:"2rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"2rem","box-shadow":"var(--shadow-md)","margin-bottom":"2rem",position:"relative"},T={width:"400px",height:"300px","border-radius":"var(--border-radius)",overflow:"hidden",background:"#f5f5f5"},R={flex:"1",display:"flex","flex-direction":"column",gap:"1rem"},_={display:"flex","justify-content":"space-between","padding-bottom":"0.5rem","border-bottom":"1px solid var(--border-light)"},I={"font-weight":"500",color:"var(--text-muted)"},b={"font-weight":"600",color:"var(--text-primary)"},G=W=>({display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"600",background:"#d4edda",color:"#155724"}),ie={"text-align":"center",padding:"4rem 2rem",color:"var(--text-muted)"},F={"font-size":"3rem","margin-bottom":"1rem",opacity:"0.5"};return(()=>{var W=FT(),z=W.firstChild;return m(W,C),l(z,B(cf,{onChange:O=>{console.log(O);let k=O;a(!0),c(k)},get placeholder(){return e("inventory.searchProductsImages","Search products to view images...")}})),l(W,B(Ge,{get when(){return r()&&t.showDetails!==!1},get children(){var O=DT(),k=O.firstChild,re=k.firstChild,$=k.nextSibling,D=$.nextSibling,H=D.firstChild,L=H.firstChild,j=L.nextSibling,oe=H.nextSibling,K=oe.firstChild,Z=K.nextSibling,J=oe.nextSibling,Y=J.firstChild,U=Y.nextSibling,ae=J.nextSibling,ue=ae.firstChild,le=ue.nextSibling,q=ae.nextSibling,ce=q.firstChild,Se=ce.nextSibling,me=q.nextSibling,Pe=me.firstChild,xe=Pe.nextSibling;return m(O,A),m(k,T),re.style.setProperty("width","100%"),re.style.setProperty("height","100%"),re.style.setProperty("object-fit","contain"),re.style.setProperty("aspect-ratio","1 / 1"),$.$$click=()=>{u()},$.style.setProperty("position","absolute"),$.style.setProperty("top","0.5rem"),$.style.setProperty("right","0.5rem"),$.style.setProperty("color","#3d3d3d"),$.style.setProperty("border-radius","50%"),$.style.setProperty("width","2rem"),$.style.setProperty("height","2rem"),$.style.setProperty("display","flex"),$.style.setProperty("align-items","center"),$.style.setProperty("justify-content","center"),$.style.setProperty("font-size","1.25rem"),$.style.setProperty("box-shadow","var(--shadow-sm)"),$.style.setProperty("cursor","pointer"),m(D,R),L.style.setProperty("margin","0 0 0.5rem 0"),L.style.setProperty("font-size","1.5rem"),l(L,()=>r().name),l(j,()=>e("products.inStock","In Stock")),l(K,()=>e("products.sku","SKU")),l(Z,()=>r().sku),l(Y,()=>e("inventory.category","Category")),l(U,()=>r().category),l(ue,()=>e("inventory.unitOfMeasure","Unit")),l(le,()=>r().unitOfMeasure),l(ce,()=>e("inventory.unitCost","Cost")),l(Se,()=>h(r().unitCost)),l(Pe,()=>e("inventory.UPC","UPC")),l(xe,()=>r().UPC),l(D,B(Ge,{get when(){return r().description},get children(){var he=LT(),ve=he.firstChild,De=ve.nextSibling;return he.style.setProperty("margin-top","1rem"),l(ve,()=>e("common.description","Description")),De.style.setProperty("margin-top","0.5rem"),De.style.setProperty("color","var(--text-primary)"),l(De,()=>r().description),we(ke=>m(ve,I,ke)),he}}),null),we(he=>{var ve=p(r()),De=r().name,ke=G(),Ce=_,Le=I,Ie=b,Re=_,He=I,Me=b,Ze=_,Ye=I,ut=b,rt=_,We=I,ct=b,pt=_,_t=I,Et=b;return ve!==he.e&&Yt(re,"src",he.e=ve),De!==he.t&&Yt(re,"alt",he.t=De),he.a=m(j,ke,he.a),he.o=m(oe,Ce,he.o),he.i=m(K,Le,he.i),he.n=m(Z,Ie,he.n),he.s=m(J,Re,he.s),he.h=m(Y,He,he.h),he.r=m(U,Me,he.r),he.d=m(ae,Ze,he.d),he.l=m(ue,Ye,he.l),he.u=m(le,ut,he.u),he.c=m(q,rt,he.c),he.w=m(ce,We,he.w),he.m=m(Se,ct,he.m),he.f=m(me,pt,he.f),he.y=m(Pe,_t,he.y),he.g=m(xe,Et,he.g),he},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),O}}),null),l(W,B(Ge,{get when(){return i().length>0},get children(){var O=RT();return m(O,w),l(O,B(Ut,{get each(){return i()},children:k=>(()=>{var re=BT(),$=re.firstChild,D=$.firstChild,H=$.nextSibling,L=H.firstChild,j=L.nextSibling,oe=j.firstChild,K=j.nextSibling,Z=K.nextSibling;return re.addEventListener("mouseleave",J=>{J.currentTarget.style.transform="translateY(0)",J.currentTarget.style.boxShadow="var(--shadow-sm)";const Y=J.currentTarget.querySelector("img");Y&&(Y.style.transform="scale(1)")}),re.addEventListener("mouseenter",J=>{J.currentTarget.style.transform="translateY(-4px)",J.currentTarget.style.boxShadow="var(--shadow-lg)";const Y=J.currentTarget.querySelector("img");Y&&(Y.style.transform="scale(1.05)")}),re.$$click=()=>c(k),m(re,x),l($,B(Ge,{get when(){return k===r()},get children(){var J=OT();return J.style.setProperty("position","absolute"),J.style.setProperty("top","0.5rem"),J.style.setProperty("right","0.5rem"),J.style.setProperty("background","var(--primary-color)"),J.style.setProperty("color","white"),J.style.setProperty("border-radius","50%"),J.style.setProperty("width","2rem"),J.style.setProperty("height","2rem"),J.style.setProperty("display","flex"),J.style.setProperty("align-items","center"),J.style.setProperty("justify-content","center"),J.style.setProperty("font-size","1.25rem"),J}}),null),m(H,X),l(L,()=>k.name),l(j,()=>k.sku,oe),l(j,()=>k.category,null),l(K,()=>k.unitOfMeasure),m(Z,E),l(Z,()=>h(k.sellingPrice)),we(J=>{var Y=V,U=p(k),ae=k.name,ue=ne,le=Q,q=k.name,ce=ee,Se=ee;return J.e=m($,Y,J.e),U!==J.t&&Yt(D,"src",J.t=U),ae!==J.a&&Yt(D,"alt",J.a=ae),J.o=m(D,ue,J.o),J.i=m(L,le,J.i),q!==J.n&&Yt(L,"title",J.n=q),J.s=m(j,ce,J.s),J.h=m(K,Se,J.h),J},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),re})()})),O}}),null),l(W,B(Ge,{get when(){return!r()},get children(){var O=MT(),k=O.firstChild,re=k.nextSibling,$=re.nextSibling;return m(k,F),re.style.setProperty("margin-bottom","0.5rem"),l(re,()=>e("inventory.noProductsFound","No Products Found")),l($,()=>e("inventory.tryDifferentSearch","Try a different search term")),we(D=>m(O,ie,D)),O}}),null),we(O=>m(z,S,O)),W})()};dr(["click"]);var VT=de("<div><div></div><div></div><div>"),v0=de("<div>"),qT=de("<div><div><div><h2> - </h2><button></button></div><div>"),zT=de("<div><div><div><div><h3></h3><span></span></div><div></div></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>");const UT=t=>{const{t:e}=er(),[r,n]=$e(""),[i,o]=$e(!1),s=Tt(()=>{const C=lt.movements,S=new Map;return C.forEach(w=>{const x=w.referenceNumber||w.invoiceId||w.ssg_inventory_key||"UNKNOWN";S.has(x)||S.set(x,{referenceNumber:x,movements:[],totalItems:0,totalValue:0,createdDate:w.createdDate,movementType:w.movementType});const V=S.get(x);V.movements.push(w),V.totalItems+=w.quantity,V.totalValue+=w.totalCost,new Date(w.createdDate)<new Date(V.createdDate)&&(V.createdDate=w.createdDate)}),Array.from(S.values()).filter(w=>w.movements.length>1).sort((w,x)=>new Date(x.createdDate).getTime()-new Date(w.createdDate).getTime())}),a=Tt(()=>{const C=s().find(S=>S.referenceNumber===r());return C?C.movements:[]}),c=C=>{n(C),o(!0)},u=()=>{o(!1),n("")},h=C=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(C),y=C=>new Date(C).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),g=C=>({in:e("inventory.purchaseReceive"),out:e("inventory.saleIssue"),transfer:e("inventory.transfer"),adjustment:e("inventory.adjustment")})[C]||C,p=C=>({in:"#4caf50",out:"#f44336",transfer:"#2196f3",adjustment:"#ff9800"})[C]||"#666";return[B(Xn,{get isOpen(){return Te(()=>!!t.isOpen)()&&!i()},get onClose(){return t.onClose},get title(){return e("inventory.viewHistoricalReports")},size:"large",get children(){var C=v0();return C.style.setProperty("max-height","70vh"),C.style.setProperty("overflow-y","auto"),l(C,B(Ge,{get when(){return s().length===0},get children(){var S=VT(),w=S.firstChild,x=w.nextSibling,V=x.nextSibling;return S.style.setProperty("text-align","center"),S.style.setProperty("padding","3rem"),S.style.setProperty("color","var(--text-muted)"),w.style.setProperty("font-size","2rem"),w.style.setProperty("margin-bottom","1rem"),x.style.setProperty("font-size","1.1rem"),x.style.setProperty("margin-bottom","0.5rem"),l(x,()=>e("inventory.noBulkReportsFound","No bulk movement reports found")),V.style.setProperty("font-size","0.9rem"),l(V,()=>e("inventory.bulkReportsAppearHere","Bulk movement reports will appear here after you create bulk movements")),S}}),null),l(C,B(Ge,{get when(){return s().length>0},get children(){var S=v0();return S.style.setProperty("display","grid"),S.style.setProperty("gap","1rem"),l(S,B(Ut,{get each(){return s()},children:w=>(()=>{var x=zT(),V=x.firstChild,ne=V.firstChild,X=ne.firstChild,Q=X.firstChild,ee=Q.nextSibling,E=X.nextSibling,A=V.nextSibling,T=A.firstChild,R=T.firstChild,_=R.nextSibling,I=T.nextSibling,b=I.firstChild,G=b.nextSibling,ie=I.nextSibling,F=ie.firstChild,W=F.nextSibling;return x.style.setProperty("padding","1.5rem"),x.style.setProperty("border","1px solid var(--border-color)"),x.style.setProperty("border-radius","var(--border-radius)"),x.style.setProperty("background","var(--surface-color)"),x.style.setProperty("transition","all 0.2s ease"),V.style.setProperty("display","flex"),V.style.setProperty("justify-content","space-between"),V.style.setProperty("align-items","flex-start"),V.style.setProperty("margin-bottom","1rem"),ne.style.setProperty("flex","1"),X.style.setProperty("display","flex"),X.style.setProperty("align-items","center"),X.style.setProperty("gap","1rem"),X.style.setProperty("margin-bottom","0.5rem"),Q.style.setProperty("margin","0"),Q.style.setProperty("font-size","1.1rem"),Q.style.setProperty("color","var(--text-primary)"),l(Q,()=>w.referenceNumber),ee.style.setProperty("padding","0.25rem 0.75rem"),ee.style.setProperty("border-radius","1rem"),ee.style.setProperty("font-size","0.75rem"),ee.style.setProperty("font-weight","500"),l(ee,()=>g(w.movementType)),E.style.setProperty("color","var(--text-muted)"),E.style.setProperty("font-size","0.875rem"),l(E,()=>y(w.createdDate)),l(V,B(xt,{variant:"outline",size:"sm",onClick:()=>c(w.referenceNumber),get children(){return e("common.view")}}),null),A.style.setProperty("display","grid"),A.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),A.style.setProperty("gap","1rem"),A.style.setProperty("margin-bottom","1rem"),R.style.setProperty("font-size","0.75rem"),R.style.setProperty("font-weight","500"),R.style.setProperty("text-transform","uppercase"),R.style.setProperty("color","var(--text-muted)"),R.style.setProperty("margin-bottom","0.25rem"),l(R,()=>e("inventory.totalProducts")),_.style.setProperty("font-size","1.25rem"),_.style.setProperty("font-weight","600"),_.style.setProperty("color","var(--primary-color)"),l(_,()=>w.movements.length),b.style.setProperty("font-size","0.75rem"),b.style.setProperty("font-weight","500"),b.style.setProperty("text-transform","uppercase"),b.style.setProperty("color","var(--text-muted)"),b.style.setProperty("margin-bottom","0.25rem"),l(b,()=>e("inventory.totalItems")),G.style.setProperty("font-size","1.25rem"),G.style.setProperty("font-weight","600"),G.style.setProperty("color","var(--primary-color)"),l(G,()=>w.totalItems),F.style.setProperty("font-size","0.75rem"),F.style.setProperty("font-weight","500"),F.style.setProperty("text-transform","uppercase"),F.style.setProperty("color","var(--text-muted)"),F.style.setProperty("margin-bottom","0.25rem"),l(F,()=>e("inventory.estimatedValue")),W.style.setProperty("font-size","1.25rem"),W.style.setProperty("font-weight","600"),W.style.setProperty("color","var(--primary-color)"),l(W,()=>h(w.totalValue)),we(z=>{var O=p(w.movementType)+"20",k=p(w.movementType);return O!==z.e&&((z.e=O)!=null?ee.style.setProperty("background",O):ee.style.removeProperty("background")),k!==z.t&&((z.t=k)!=null?ee.style.setProperty("color",k):ee.style.removeProperty("color")),z},{e:void 0,t:void 0}),x})()})),S}}),null),C}}),B(Ge,{get when(){return i()},get children(){var C=qT(),S=C.firstChild,w=S.firstChild,x=w.firstChild,V=x.firstChild,ne=x.nextSibling,X=w.nextSibling;return C.style.setProperty("position","fixed"),C.style.setProperty("top","0"),C.style.setProperty("left","0"),C.style.setProperty("right","0"),C.style.setProperty("bottom","0"),C.style.setProperty("background","rgba(0, 0, 0, 0.5)"),C.style.setProperty("z-index","1000"),C.style.setProperty("display","flex"),C.style.setProperty("align-items","center"),C.style.setProperty("justify-content","center"),C.style.setProperty("padding","2rem"),S.style.setProperty("background","white"),S.style.setProperty("border-radius","var(--border-radius)"),S.style.setProperty("width","95%"),S.style.setProperty("max-width","1200px"),S.style.setProperty("max-height","90vh"),S.style.setProperty("overflow-y","auto"),S.style.setProperty("position","relative"),w.style.setProperty("padding","1rem 2rem"),w.style.setProperty("border-bottom","1px solid #e9ecef"),w.style.setProperty("display","flex"),w.style.setProperty("justify-content","space-between"),w.style.setProperty("align-items","center"),w.style.setProperty("background","#f8f9fa"),x.style.setProperty("margin","0"),l(x,()=>e("inventory.bulkMovementReport"),V),l(x,r,null),ne.$$click=u,ne.style.setProperty("background","none"),ne.style.setProperty("border","none"),ne.style.setProperty("font-size","1.5rem"),ne.style.setProperty("cursor","pointer"),ne.style.setProperty("padding","0.5rem"),ne.style.setProperty("line-height","1"),X.style.setProperty("padding","1rem"),l(X,B(_5,{get movements(){return a()},onClose:u})),C}})]};dr(["click"]);var HT=de("<div><h1></h1><div>"),Ti=de("<div>"),WT=de("<div><h3></h3><div>"),GT=de("<div>: <!> "),YT=de("<div><button></button><button></button><button></button><button>"),KT=de("<div><div>"),JT=de("<div><span> (<!>)</span><span> / <!> "),QT=de("<div><div><h2></h2></div><div>"),XT=de("<div><div><div><span></span><h3></h3></div><div>  </div><div></div></div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div>:"),ZT=de("<div><div><div><div></div><div></div></div><div><div> </div><div></div><div>Min: "),e6=de("<span> LOW");const t6=()=>{const{t}=er(),[e,r]=$e(!1),[n,i]=$e(!1),[o,s]=$e(!1),[a,c]=$e(null),[u,h]=$e("overview"),[y,g]=$e("new"),[p,C]=$e([]),[S,w]=$e(!1),[x,V]=$e(!1),[ne,X]=$e(!1),[Q,ee]=$e(!1),[E,A]=$e(1),T=K=>{c(K),s(!0)},R=Tt(()=>{const K=lt.products||[],Z=lt.movements||[],J=lt.stockLevels||[],Y=lt.getLowStockProducts(),U=K?.length||0,ae=K?.filter(q=>q.isActive).length,ue=J.reduce((q,ce)=>q*1+ce.quantity*1*ce.averageCost*1,0),le=Z?.filter(q=>{const ce=new Date(q.createdDate),Se=new Date;return ce.getMonth()===Se.getMonth()&&ce.getFullYear()===Se.getFullYear()}).length;return{totalProducts:U,activeProducts:ae,lowStockProducts:Y.length,totalStockValue:ue,totalMovementsThisMonth:le,totalLocations:lt.locations.length,activeLocations:lt.getActiveLocations().length}});Tt(()=>lt.products.map(K=>{const Z=lt.getStockByProduct(K.id),J=lt.getTotalStockByProduct(K.id),Y=lt.getLastLocationByProduct(K.id);return{...K,totalStock:J,stockByLocation:Z,lastLocation:Y,isLowStock:J<=K.minStockLevel}})),Tt(()=>{S(),A(1)});const _=(K,Z)=>K<=Z?t("inventory.lowStockAlert"):K<=Z*2?t("inventory.normalStock"):t("inventory.inStock"),I=K=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(K),b=K=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(K),G=K=>{switch(K){case"warehouse":return t("inventory.warehouse");case"store":return t("inventory.store");case"supplier":return t("inventory.supplier");case"customer":return t("inventory.customer");default:return K}},ie={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},F={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},W=K=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500",background:K>50?"#d4edda":K>20?"#fff3cd":"#f8d7da",color:K>50?"#155724":K>20?"#856404":"#721c24"}),z={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},O={color:"var(--text-muted)","font-size":"0.875rem"},k={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},re={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},$={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},D=K=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:K?"var(--primary-color)":"var(--text-muted)","border-bottom":K?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),H={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem","margin-bottom":"2rem"},L={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},j=Tt(()=>{const K=lt.movements;return{total:K.length,stockIn:K.filter(Z=>Z.movementType==="in").length,stockOut:K.filter(Z=>Z.movementType==="out").length,transfers:K.filter(Z=>Z.movementType==="transfer").length,adjustments:K.filter(Z=>Z.movementType==="adjustment").length,totalValue:K.reduce((Z,J)=>Z+J.totalCost,0)}}),oe=async()=>{let K=Ar.state?.profile?.businessId;setTimeout(async()=>{await lt.getStockLevels("YY_")},2300),Rm.calcStockLevels(),await lt.fecthProduct(K),await lt.fecthInventory(K)};return Rn(()=>{oe()}),B(ro,{get title(){return t("inventory.title")},get children(){return[(()=>{var K=HT(),Z=K.firstChild,J=Z.nextSibling;return m(K,re),Z.style.setProperty("margin","0"),Z.style.setProperty("font-size","1.75rem"),J.style.setProperty("display","flex"),J.style.setProperty("align-items","center"),J.style.setProperty("gap","1rem"),l(J,(()=>{var Y=Te(()=>y()==="new");return()=>Y()&&B(xt,{variant:"outline",onClick:()=>X(!0),get children(){return[" ",Te(()=>t("inventory.physicalCount","Physical Count"))]}})})(),null),l(J,B(Ge,{get when(){return Ar.hasPermission("read_write")},get children(){return[B(xt,{variant:"outline",onClick:()=>ee(!0),get children(){return[" ",Te(()=>t("inventory.viewHistoricalReports"))]}}),B(xt,{variant:"primary",onClick:()=>i(!0),get children(){return Te(()=>y()==="new")()?t("inventory.addMovement"):t("common.add")}})]}}),null),K})(),B(jT,{}),B(Ge,{get when(){return Ar.hasPermission("inventoryDownsection")},get children(){return Te(()=>y()==="legacy")()?[(()=>{var K=Ti();return l(K,B(Nt,{get title(){return t("inventory.totalItems")},get subtitle(){return t("inventory.inStock")},get children(){var Z=Ti();return Z.style.setProperty("font-size","1.5rem"),Z.style.setProperty("font-weight","600"),Z.style.setProperty("color","var(--primary-color)"),l(Z,()=>lt.inventory.length),Z}}),null),l(K,B(Nt,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.itemsBelowThreshold")},get children(){var Z=Ti();return Z.style.setProperty("font-size","1.5rem"),Z.style.setProperty("font-weight","600"),Z.style.setProperty("color","var(--primary-color)"),l(Z,()=>lt.getLowStockItems().length),Z}}),null),l(K,B(Nt,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.inventoryWorth")},get children(){var Z=Ti();return Z.style.setProperty("font-size","1.5rem"),Z.style.setProperty("font-weight","600"),Z.style.setProperty("color","var(--primary-color)"),l(Z,()=>I(lt.getTotalValue())),Z}}),null),we(Z=>m(K,k,Z)),K})(),(()=>{var K=Ti();return m(K,ie),l(K,B(Ut,{get each(){return lt.inventory},children:Z=>{const J=_(Z.quantity,Z.minStock),Y=Z.quantity<=Z.minStock?8:Z.quantity<=Z.minStock*2?35:75;return B(Nt,{onClick:()=>T(Z),get children(){return[(()=>{var U=WT(),ae=U.firstChild,ue=ae.nextSibling;return m(U,F),ae.style.setProperty("margin","0"),ae.style.setProperty("font-size","1.1rem"),l(ae,()=>Z.name),l(ue,J),we(le=>m(ue,W(Y),le)),U})(),(()=>{var U=Ti();return m(U,z),l(U,()=>I(Z.price)),U})(),(()=>{var U=GT(),ae=U.firstChild,ue=ae.nextSibling;return ue.nextSibling,m(U,O),l(U,()=>t("inventory.quantity"),ae),l(U,()=>Z.quantity,ue),l(U,()=>t("common.units"),null),U})()]}})}})),K})()]:[(()=>{var K=YT(),Z=K.firstChild,J=Z.nextSibling,Y=J.nextSibling,U=Y.nextSibling;return m(K,$),Z.$$click=()=>h("overview"),l(Z,()=>t("inventory.overview")),J.$$click=()=>h("products"),l(J,()=>t("inventory.products")),Y.$$click=()=>h("movements"),l(Y,()=>t("inventory.movements")),U.$$click=()=>h("locations"),l(U,()=>t("inventory.locations")),we(ae=>{var ue=D(u()==="overview"),le=D(u()==="products"),q=D(u()==="movements"),ce=D(u()==="locations");return ae.e=m(Z,ue,ae.e),ae.t=m(J,le,ae.t),ae.a=m(Y,q,ae.a),ae.o=m(U,ce,ae.o),ae},{e:void 0,t:void 0,a:void 0,o:void 0}),K})(),Te(()=>Te(()=>u()==="overview")()&&(()=>{var K=KT(),Z=K.firstChild;return l(Z,B(Nt,{get title(){return t("inventory.activeProducts")},get subtitle(){return t("inventory.currentlyManaged")},get children(){var J=Ti();return J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("color","var(--primary-color)"),l(J,()=>R().activeProducts),J}}),null),l(Z,B(Nt,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.needAttention")},get children(){var J=Ti();return J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("color","#d32f2f"),l(J,()=>R().lowStockProducts),J}}),null),l(Z,B(Nt,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.currentWorth")},get children(){var J=Ti();return J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("color","var(--primary-color)"),l(J,()=>b(j().totalValue)),J}}),null),l(Z,B(Nt,{get title(){return t("inventory.movements")},get subtitle(){return t("inventory.thisMonth")},get children(){var J=Ti();return J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("color","var(--primary-color)"),l(J,()=>R().totalMovementsThisMonth),J}}),null),l(Z,B(Nt,{get title(){return t("inventory.activeLocations")},get subtitle(){return t("inventory.warehousesStores")},get children(){var J=Ti();return J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("color","var(--primary-color)"),l(J,()=>R().activeLocations),J}}),null),l(K,(()=>{var J=Te(()=>R().lowStockProducts>0);return()=>J()&&B(Nt,{get title(){return` ${t("inventory.lowStockAlert")}`},get subtitle(){return`${R().lowStockProducts} ${t("inventory.productsNeedRestocking")}`},style:{"margin-bottom":"2rem","border-color":"#ffcdd2",background:"#ffebee"},get children(){var Y=Ti();return Y.style.setProperty("margin-top","1rem"),l(Y,B(Ut,{get each(){return lt.getLowStockProducts().slice(0,9)},children:U=>(()=>{var ae=JT(),ue=ae.firstChild,le=ue.firstChild,q=le.nextSibling;q.nextSibling;var ce=ue.nextSibling,Se=ce.firstChild,me=Se.nextSibling;return me.nextSibling,ae.style.setProperty("display","flex"),ae.style.setProperty("justify-content","space-between"),ae.style.setProperty("margin-bottom","0.5rem"),ae.style.setProperty("font-size","0.875rem"),l(ue,()=>U.name,le),l(ue,()=>U?.sku,q),ce.style.setProperty("color","#d32f2f"),ce.style.setProperty("font-weight","600"),l(ce,()=>U.currentStock,Se),l(ce,()=>U.minStockLevel,me),l(ce,()=>t("inventory.min"),null),ae})()}),null),l(Y,(()=>{var U=Te(()=>lt.getLowStockProducts().length>5);return()=>U()&&(()=>{var ae=Ti();return ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),ae.style.setProperty("font-style","italic"),l(ae,()=>t("common.andMore",{count:lt.getLowStockProducts().length-9})),ae})()})(),null),Y}})})(),null),we(J=>m(Z,k,J)),K})()),Te(()=>Te(()=>u()==="products")()&&B(w5,{})),Te(()=>Te(()=>u()==="movements")()&&B(qk,{})),Te(()=>Te(()=>u()==="locations")()&&(()=>{var K=QT(),Z=K.firstChild,J=Z.firstChild,Y=Z.nextSibling;return Z.style.setProperty("display","flex"),Z.style.setProperty("justify-content","space-between"),Z.style.setProperty("align-items","center"),Z.style.setProperty("margin-bottom","1.5rem"),J.style.setProperty("margin","0"),J.style.setProperty("font-size","1.5rem"),l(J,()=>t("inventory.locations")),l(Z,B(Ge,{get when(){return Ar.hasPermission("read_write")},get children(){return B(xt,{variant:"primary",onClick:()=>V(!0),get children(){return[" ",Te(()=>t("inventory.addLocation"))]}})}}),null),m(Y,H),l(Y,B(Ut,{get each(){return lt.getActiveLocations()},children:U=>{const ae=lt.getStockByLocation(U.id),ue=ae?.length,le=ae?.reduce((ce,Se)=>ce*1+Se.quantity*1,0),q=ae?.reduce((ce,Se)=>(lt?.getProductById(Se.productId),ce+(Se?.averageCost||0)),0);return(()=>{var ce=XT(),Se=ce.firstChild,me=Se.firstChild,Pe=me.firstChild,xe=Pe.nextSibling,he=me.nextSibling,ve=he.firstChild,De=he.nextSibling,ke=Se.nextSibling,Ce=ke.firstChild,Le=Ce.firstChild,Ie=Le.firstChild,Re=Le.nextSibling,He=Ce.nextSibling,Me=He.firstChild,Ze=Me.firstChild,Ye=Me.nextSibling,ut=He.nextSibling,rt=ut.firstChild,We=rt.firstChild,ct=rt.nextSibling,pt=ke.nextSibling,_t=pt.firstChild,Et=_t.firstChild;return Se.style.setProperty("margin-bottom","1rem"),Se.style.setProperty("padding-bottom","1rem"),Se.style.setProperty("border-bottom","1px solid var(--border-color)"),me.style.setProperty("display","flex"),me.style.setProperty("align-items","center"),me.style.setProperty("gap","0.5rem"),me.style.setProperty("margin-bottom","0.5rem"),Pe.style.setProperty("font-size","1.2rem"),l(Pe,()=>U.type==="warehouse"?"":U.type==="store"?"":U.type==="supplier"?"":""),xe.style.setProperty("margin","0"),xe.style.setProperty("font-size","1.1rem"),l(xe,()=>U.name),he.style.setProperty("font-size","0.875rem"),he.style.setProperty("color","var(--text-muted)"),l(he,()=>U.code,ve),l(he,()=>G(U.type),null),De.style.setProperty("font-size","0.75rem"),De.style.setProperty("color","var(--text-muted)"),De.style.setProperty("margin-top","0.25rem"),l(De,()=>U.address),ke.style.setProperty("margin-bottom","1rem"),Ce.style.setProperty("display","flex"),Ce.style.setProperty("justify-content","space-between"),Ce.style.setProperty("margin-bottom","0.5rem"),Le.style.setProperty("font-size","0.875rem"),Le.style.setProperty("font-weight","500"),l(Le,()=>t("inventory.products"),Ie),Re.style.setProperty("font-weight","600"),l(Re,ue),He.style.setProperty("display","flex"),He.style.setProperty("justify-content","space-between"),He.style.setProperty("margin-bottom","0.5rem"),Me.style.setProperty("font-size","0.875rem"),Me.style.setProperty("font-weight","500"),l(Me,()=>t("inventory.totalItems"),Ze),Ye.style.setProperty("font-weight","600"),Ye.style.setProperty("color","var(--primary-color)"),l(Ye,le),ut.style.setProperty("display","flex"),ut.style.setProperty("justify-content","space-between"),ut.style.setProperty("margin-bottom","1rem"),rt.style.setProperty("font-size","0.875rem"),rt.style.setProperty("font-weight","500"),l(rt,()=>t("inventory.totalValue"),We),ct.style.setProperty("font-weight","600"),ct.style.setProperty("color","var(--primary-color)"),l(ct,()=>b(q)),_t.style.setProperty("font-weight","600"),_t.style.setProperty("margin-bottom","0.75rem"),_t.style.setProperty("font-size","0.875rem"),_t.style.setProperty("color","var(--text-primary)"),_t.style.setProperty("border-bottom","1px solid var(--border-color)"),_t.style.setProperty("padding-bottom","0.5rem"),l(_t,()=>t("inventory.productDetails"),Et),l(pt,(()=>{var et=Te(()=>ae?.length===0);return()=>et()?(()=>{var Ue=Ti();return Ue.style.setProperty("text-align","center"),Ue.style.setProperty("color","var(--text-muted)"),Ue.style.setProperty("font-style","italic"),Ue.style.setProperty("padding","1rem"),l(Ue,()=>t("inventory.noProducts")),Ue})():(()=>{var Ue=Ti();return Ue.style.setProperty("max-height","200px"),Ue.style.setProperty("overflow-y","auto"),Ue.style.setProperty("border","1px solid var(--border-color)"),Ue.style.setProperty("border-radius","var(--border-radius-sm)"),l(Ue,B(Ut,{each:ae,children:ot=>{const Xe=lt.getProductById(ot.productId);if(!Xe)return null;const at=ot.quantity<=Xe.minStockLevel,St=ot.averageCost;return ot.quantity?(()=>{var $t=ZT(),qt=$t.firstChild,Gt=qt.firstChild,ht=Gt.firstChild,Kt=ht.nextSibling,Rt=Gt.nextSibling,Qt=Rt.firstChild,sr=Qt.firstChild,mt=Qt.nextSibling,At=mt.nextSibling;return At.firstChild,$t.style.setProperty("padding","0.75rem"),$t.style.setProperty("border-bottom","1px solid var(--border-color)"),(at?"#fff5f5":"transparent")!=null?$t.style.setProperty("background",at?"#fff5f5":"transparent"):$t.style.removeProperty("background"),$t.style.setProperty("transition","background-color 0.2s ease"),qt.style.setProperty("display","flex"),qt.style.setProperty("justify-content","space-between"),qt.style.setProperty("align-items","flex-start"),qt.style.setProperty("margin-bottom","0.25rem"),Gt.style.setProperty("flex","1"),ht.style.setProperty("font-weight","500"),ht.style.setProperty("font-size","0.875rem"),(at?"#d32f2f":"var(--text-primary)")!=null?ht.style.setProperty("color",at?"#d32f2f":"var(--text-primary)"):ht.style.removeProperty("color"),l(ht,()=>Xe.name,null),l(ht,at&&(()=>{var Ot=e6();return Ot.style.setProperty("margin-left","0.5rem"),Ot.style.setProperty("font-size","0.7rem"),Ot.style.setProperty("color","#d32f2f"),Ot})(),null),Kt.style.setProperty("font-size","0.75rem"),Kt.style.setProperty("color","var(--text-muted)"),Kt.style.setProperty("margin-top","0.1rem"),l(Kt,()=>Xe.sku,null),l(Kt,()=>Xe.UPC?"  "+Xe.UPC:"",null),l(Kt,()=>Xe.category?"  "+Xe.category:"",null),Rt.style.setProperty("text-align","right"),Qt.style.setProperty("font-weight","600"),Qt.style.setProperty("font-size","0.875rem"),(at?"#d32f2f":"var(--primary-color)")!=null?Qt.style.setProperty("color",at?"#d32f2f":"var(--primary-color)"):Qt.style.removeProperty("color"),l(Qt,()=>ot.quantity,sr),l(Qt,()=>Xe.unitOfMeasure,null),mt.style.setProperty("font-size","0.75rem"),mt.style.setProperty("color","var(--text-muted)"),l(mt,()=>b(St)),At.style.setProperty("font-size","0.7rem"),At.style.setProperty("color","var(--text-muted)"),At.style.setProperty("margin-top","0.1rem"),l(At,()=>Xe.minStockLevel,null),$t})():null}})),Ue})()})(),null),we(et=>m(ce,{...L,"min-height":"400px"},et)),ce})()}})),K})())]}}),B(Ge,{get when(){return Ar.hasPermission("read_write")},get children(){return[B(zE,{get isOpen(){return e()},onClose:()=>r(!1),get mode(){return y()==="new"?"movement":"legacy"}}),B(ck,{get isOpen(){return n()},onClose:()=>i(!1)}),B(pk,{get isOpen(){return o()},onClose:()=>s(!1),get item(){return a()}}),B(Ly,{get isOpen(){return x()},onClose:()=>V(!1),onLocationAdded:()=>{V(!1)}})]}}),B(eT,{get isOpen(){return ne()},onClose:()=>X(!1)}),B(UT,{get isOpen(){return Q()},onClose:()=>ee(!1)})]}})};dr(["click"]);const r6=[{id:"1",name:"John Doe",position:"Software Engineer",salary:85e3,email:"john.doe@company.com",phone:"+1 (555) 123-4567",department:"Engineering",startDate:"2023-01-15"},{id:"2",name:"Jane Smith",position:"Product Manager",salary:95e3,email:"jane.smith@company.com",phone:"+1 (555) 234-5678",department:"Product",startDate:"2022-08-20"},{id:"3",name:"Mike Brown",position:"Designer",salary:7e4,email:"mike.brown@company.com",phone:"+1 (555) 345-6789",department:"Design",startDate:"2023-03-10"},{id:"4",name:"Sarah Kim",position:"HR Manager",salary:78e3,email:"sarah.kim@company.com",phone:"+1 (555) 456-7890",department:"Human Resources",startDate:"2022-11-05"},{id:"5",name:"Alex Lee",position:"Data Analyst",salary:72e3,email:"alex.lee@company.com",phone:"+1 (555) 567-8901",department:"Analytics",startDate:"2023-02-28"},{id:"6",name:"Emma Wilson",position:"Marketing Manager",salary:82e3,email:"emma.wilson@company.com",phone:"+1 (555) 678-9012",department:"Marketing",startDate:"2022-09-15"}],[Kc,rp]=$e(r6),S5={get employees(){return Kc()},addEmployee(t){const e={...t,id:Date.now().toString()};return rp([...Kc(),e]),e},updateEmployee(t,e){rp(Kc().map(r=>r.id===t?{...r,...e}:r))},deleteEmployee(t){rp(Kc().filter(e=>e.id!==t))},getEmployeeById(t){return Kc().find(e=>e.id===t)}};var n6=de("<form><div>");const i6=t=>{const{t:e}=er(),[r,n]=$e({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),i=[{value:"Engineering",label:e("employees.departments.engineering","Engineering")},{value:"Product",label:e("employees.departments.product","Product")},{value:"Design",label:e("employees.departments.design","Design")},{value:"Marketing",label:e("employees.departments.marketing","Marketing")},{value:"Sales",label:e("employees.departments.sales","Sales")},{value:"Human Resources",label:e("employees.departments.humanResources","Human Resources")},{value:"Finance",label:e("employees.departments.finance","Finance")},{value:"Operations",label:e("employees.departments.operations","Operations")},{value:"Analytics",label:e("employees.departments.analytics","Analytics")}],o={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},s=c=>{c.preventDefault();const u=r();if(!u.name||!u.position||!u.salary||!u.email||!u.department||!u.startDate){alert(e("forms.requiredField"));return}const h={name:u.name,position:u.position,salary:parseFloat(u.salary),email:u.email,phone:u.phone,department:u.department,startDate:u.startDate};S5.addEmployee(h),n({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),t.onClose()},a=(c,u)=>{n(h=>({...h,[c]:u}))};return B(Xn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.addEmployee")},get children(){var c=n6(),u=c.firstChild;return c.addEventListener("submit",s),l(c,B(Or,{get label(){return e("employees.fullName")},get value(){return r().name},onChange:h=>a("name",h),get placeholder(){return e("employees.enterFullName","Enter employee's full name")},required:!0}),u),l(c,B(Or,{get label(){return e("employees.position")},get value(){return r().position},onChange:h=>a("position",h),get placeholder(){return e("employees.enterPosition","Enter job position")},required:!0}),u),l(c,B(ci,{get label(){return e("employees.department")},get value(){return r().department},onChange:h=>a("department",h),options:i,required:!0}),u),l(c,B(Or,{get label(){return e("employees.email")},type:"email",get value(){return r().email},onChange:h=>a("email",h),get placeholder(){return e("employees.enterEmail","Enter email address")},required:!0}),u),l(c,B(Or,{get label(){return e("employees.phone")},type:"tel",get value(){return r().phone},onChange:h=>a("phone",h),get placeholder(){return e("employees.enterPhone","Enter phone number")}}),u),l(c,B(Or,{get label(){return e("employees.salary")},type:"number",get value(){return r().salary},onChange:h=>a("salary",h),get placeholder(){return e("employees.enterSalary","Enter annual salary")},required:!0}),u),l(c,B(Or,{get label(){return e("employees.hireDate")},type:"date",get value(){return r().startDate},onChange:h=>a("startDate",h),required:!0}),u),m(u,o),l(u,B(xt,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),l(u,B(xt,{variant:"primary",type:"submit",get children(){return e("employees.addEmployee")}}),null),c}})};var o6=de("<div><div></div><div></div><div>"),s6=de("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),a6=de("<div>");const l6=t=>{const{t:e}=er(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},i={"font-weight":"600",color:"var(--text-primary)"},o={width:"80px",height:"80px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.5rem",margin:"0 auto 1.5rem auto"},s={"text-align":"center","margin-bottom":"2rem"},a={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},c={color:"var(--text-muted)","font-size":"1rem"},u={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"};if(!t.employee)return null;const h=p=>p.split(" ").map(C=>C[0]).join("").toUpperCase(),y=p=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(p),g=p=>new Date(p).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return B(Xn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.employeeDetails")},get children(){return[(()=>{var p=o6(),C=p.firstChild,S=C.nextSibling,w=S.nextSibling;return m(p,s),m(C,o),l(C,()=>h(t.employee.name)),m(S,a),l(S,()=>t.employee.name),m(w,c),l(w,()=>t.employee.position),p})(),(()=>{var p=s6(),C=p.firstChild,S=C.firstChild,w=S.nextSibling,x=C.nextSibling,V=x.firstChild,ne=V.nextSibling,X=x.nextSibling,Q=X.firstChild,ee=Q.nextSibling,E=X.nextSibling,A=E.firstChild,T=A.nextSibling,R=E.nextSibling,_=R.firstChild,I=_.nextSibling,b=R.nextSibling,G=b.firstChild,ie=G.nextSibling;return l(S,()=>e("employees.employeeId")),l(w,()=>t.employee.id),l(V,()=>e("employees.department")),l(ne,()=>t.employee.department),l(Q,()=>e("employees.email")),l(ee,()=>t.employee.email),l(A,()=>e("employees.phone")),l(T,()=>t.employee.phone),l(_,()=>e("employees.salary")),l(I,()=>y(t.employee.salary)),l(G,()=>e("employees.hireDate")),l(ie,()=>g(t.employee.startDate)),we(F=>{var W=r,z=n,O=i,k=r,re=n,$=i,D=r,H=n,L=i,j=r,oe=n,K=i,Z=r,J=n,Y=i,U=r,ae=n,ue=i;return F.e=m(C,W,F.e),F.t=m(S,z,F.t),F.a=m(w,O,F.a),F.o=m(x,k,F.o),F.i=m(V,re,F.i),F.n=m(ne,$,F.n),F.s=m(X,D,F.s),F.h=m(Q,H,F.h),F.r=m(ee,L,F.r),F.d=m(E,j,F.d),F.l=m(A,oe,F.l),F.u=m(T,K,F.u),F.c=m(R,Z,F.c),F.w=m(_,J,F.w),F.m=m(I,Y,F.m),F.f=m(b,U,F.f),F.y=m(G,ae,F.y),F.g=m(ie,ue,F.g),F},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),p})(),(()=>{var p=a6();return m(p,u),l(p,B(xt,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),l(p,B(xt,{variant:"primary",onClick:()=>{console.log("Edit employee:",t.employee.id)},get children(){return e("employees.editEmployee")}}),null),p})()]}})};var b0=de("<div>"),c6=de("<div><div></div><div><div></div><div></div><div>/year");const u6=()=>{const{t}=er(),[e,r]=$e(!1),[n,i]=$e(!1),[o,s]=$e(null),a=S=>{s(S),i(!0)},c={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},u={display:"flex","align-items":"center",gap:"1rem"},h={width:"60px",height:"60px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.2rem"},y={flex:"1"},g={"font-weight":"600","margin-bottom":"0.25rem"},p={color:"var(--text-muted)","font-size":"0.875rem","margin-bottom":"0.5rem"},C={color:"var(--primary-color)","font-weight":"500"};return B(ro,{get title(){return t("employees.title")},get children(){return[(()=>{var S=b0();return S.style.setProperty("margin-bottom","2rem"),l(S,B(xt,{variant:"primary",onClick:()=>r(!0),get children(){return t("employees.addEmployee")}})),S})(),(()=>{var S=b0();return m(S,c),l(S,()=>S5.employees.map(w=>{const x=ne=>ne.split(" ").map(X=>X[0]).join("").toUpperCase(),V=ne=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ne);return B(Nt,{onClick:()=>a(w),get children(){var ne=c6(),X=ne.firstChild,Q=X.nextSibling,ee=Q.firstChild,E=ee.nextSibling,A=E.nextSibling,T=A.firstChild;return m(ne,u),m(X,h),l(X,()=>x(w.name)),m(Q,y),m(ee,g),l(ee,()=>w.name),m(E,p),l(E,()=>w.position),m(A,C),l(A,()=>V(w.salary),T),ne}})})),S})(),B(i6,{get isOpen(){return e()},onClose:()=>r(!1)}),B(l6,{get isOpen(){return n()},onClose:()=>i(!1),get employee(){return o()}})]}})},d6=[{id:"1",accountId:"1002",bankName:"First National Bank",accountNumber:"****1234",accountType:"checking",currency:"USD",currentBalance:32730.5,lastReconciledDate:"2024-01-01",lastReconciledBalance:3e4,isActive:!0},{id:"2",accountId:"1003",bankName:"First National Bank",accountNumber:"****5678",accountType:"savings",currency:"USD",currentBalance:12e3,lastReconciledDate:"2024-01-01",lastReconciledBalance:1e4,isActive:!0}],h6=[{id:"1",accountId:"1002",date:"2024-01-15",description:"Customer Payment - ABC Corp",reference:"CHK001234",debitAmount:5e3,creditAmount:0,balance:35730.5,category:"Customer Payment",isReconciled:!0,reconciledWith:"eb1",importedAt:"2024-01-16",source:"csv_import"},{id:"2",accountId:"1002",date:"2024-01-14",description:"Office Supplies - Staples",reference:"CHK001235",debitAmount:0,creditAmount:250,balance:30730.5,category:"Office Expenses",isReconciled:!0,reconciledWith:"eb2",importedAt:"2024-01-16",source:"csv_import"},{id:"3",accountId:"1002",date:"2024-01-13",description:"Monthly Rent Payment",reference:"CHK001236",debitAmount:0,creditAmount:2e3,balance:28730.5,category:"Rent",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"},{id:"4",accountId:"1002",date:"2024-01-12",description:"Wire Transfer In",reference:"WIRE001",debitAmount:1e4,creditAmount:0,balance:38730.5,category:"Wire Transfer",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"}],f6=[{id:"eb1",accountId:"1002",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",debitAmount:5e3,creditAmount:0,category:"Accounts Receivable",isReconciled:!0,reconciledWith:"1",createdAt:"2024-01-15"},{id:"eb2",accountId:"1002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",debitAmount:0,creditAmount:250,category:"Office Expenses",isReconciled:!0,reconciledWith:"2",createdAt:"2024-01-14"},{id:"eb3",accountId:"1002",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",debitAmount:0,creditAmount:3500,category:"Salary Expense",isReconciled:!1,createdAt:"2024-01-11"}],p6=[{id:"1",bankAccountId:"1",periodStart:"2024-01-01",periodEnd:"2024-01-15",startingBalance:3e4,endingBalance:35730.5,status:"in_progress",totalBankTransactions:4,totalEntryBookRecords:3,reconciledTransactions:2,unreconciledTransactions:2,discrepancyAmount:1500,createdAt:"2024-01-16",notes:"Wire transfer and rent payment need investigation"}],[Od,_0]=$e(d6),[ha,np]=$e(h6),[Jc,w0]=$e(f6),[Bd,S0]=$e(p6),Hn={get bankAccounts(){return Od()},addBankAccount(t){const e={...t,id:Date.now().toString()};return _0([...Od(),e]),e},updateBankAccount(t,e){_0(Od().map(r=>r.id===t?{...r,...e}:r))},getBankAccountById(t){return Od().find(e=>e.id===t)},get bankStatements(){return ha()},addBankStatement(t){const e={...t,id:Date.now().toString(),importedAt:new Date().toISOString()};return np([...ha(),e]),e},addBankStatementsFromCSV(t){const e=t.map(r=>({...r,id:`csv_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,importedAt:new Date().toISOString(),source:"csv_import",isReconciled:!1}));return np([...ha(),...e]),e},updateBankStatement(t,e){np(ha().map(r=>r.id===t?{...r,...e}:r))},getBankStatementsByAccount(t){return ha().filter(e=>e.accountId===t)},getUnreconciledBankStatements(t){return(t?this.getBankStatementsByAccount(t):ha()).filter(r=>!r.isReconciled)},get entryBookRecords(){return Jc()},addEntryBookRecord(t){const e={...t,id:Date.now().toString(),createdAt:new Date().toISOString()};return w0([...Jc(),e]),e},updateEntryBookRecord(t,e){w0(Jc().map(r=>r.id===t?{...r,...e}:r))},getEntryBookRecordsByAccount(t){return Jc().filter(e=>e.accountId===t)},getUnreconciledEntryBookRecords(t){return(t?this.getEntryBookRecordsByAccount(t):Jc()).filter(r=>!r.isReconciled)},reconcileTransaction(t,e){this.updateBankStatement(t,{isReconciled:!0,reconciledWith:e}),this.updateEntryBookRecord(e,{isReconciled:!0,reconciledWith:t})},unreconciledTransaction(t){const e=ha().find(r=>r.id===t);e?.reconciledWith&&this.updateEntryBookRecord(e.reconciledWith,{isReconciled:!1,reconciledWith:void 0}),this.updateBankStatement(t,{isReconciled:!1,reconciledWith:void 0})},findPotentialMatches(t){const e=ha().find(n=>n.id===t);return e?this.getUnreconciledEntryBookRecords(e.accountId).filter(n=>{const i=Math.abs(e.debitAmount-n.debitAmount)<.01||Math.abs(e.creditAmount-n.creditAmount)<.01,o=new Date(e.date),s=new Date(n.date),c=Math.abs((o.getTime()-s.getTime())/(1e3*60*60*24))<=3,u=e.reference===n.reference||e.description.toLowerCase().includes(n.description.toLowerCase())||n.description.toLowerCase().includes(e.description.toLowerCase());return i&&(c||u)}).sort((n,i)=>{const o=(n.date===e.date?2:0)+(n.reference===e.reference?1:0);return(i.date===e.date?2:0)+(i.reference===e.reference?1:0)-o}):[]},get reconciliationSessions(){return Bd()},startReconciliationSession(t,e,r){const n=this.getBankStatementsByAccount(t).filter(u=>u.date>=e&&u.date<=r),i=this.getEntryBookRecordsByAccount(t).filter(u=>u.date>=e&&u.date<=r),o=n.filter(u=>u.isReconciled).length,s=this.getBankAccountById(t)?.lastReconciledBalance||0,a=this.getBankAccountById(t)?.currentBalance||0,c={id:Date.now().toString(),bankAccountId:t,periodStart:e,periodEnd:r,startingBalance:s,endingBalance:a,status:"in_progress",totalBankTransactions:n.length,totalEntryBookRecords:i.length,reconciledTransactions:o,unreconciledTransactions:n.length-o,discrepancyAmount:0,createdAt:new Date().toISOString()};return S0([...Bd(),c]),c},updateReconciliationSession(t,e){S0(Bd().map(r=>r.id===t?{...r,...e}:r))},getReconciliationSessionsByAccount(t){return Bd().filter(e=>e.bankAccountId===t)}};var ip=de("<div>"),m6=de("<div><strong>:</strong> <!> - "),y6=de("<div><div><div></div><div></div><div></div></div><input id=csvFileInput type=file accept=.csv>"),g6=de("<div><h4></h4><div><div><label> *</label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><select><option value>"),Ql=de("<option>"),v6=de("<div><table><thead><tr></tr></thead><tbody>"),b6=de("<th>"),_6=de("<tr>"),w6=de("<td>");const S6=t=>{const{t:e}=er(),[r,n]=$e(!1),[i,o]=$e(!1),[s,a]=$e(null),[c,u]=$e([]),[h,y]=$e({date:"",description:"",reference:"",debit:"",credit:"",balance:""}),g={border:`2px dashed ${r()?"var(--primary-color)":"var(--border-color)"}`,"border-radius":"var(--border-radius)",padding:"2rem","text-align":"center","background-color":r()?"var(--background-color)":"transparent",transition:"all 0.2s ease",cursor:"pointer"},p={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem","margin-top":"1.5rem"},C={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-family":"inherit"},S={"max-height":"200px","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},w={width:"100%","border-collapse":"collapse","font-size":"0.875rem"},x={padding:"0.5rem","border-bottom":"1px solid var(--border-color)","text-align":"left"},V={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},ne=I=>{I.preventDefault(),n(!0)},X=I=>{I.preventDefault(),n(!1)},Q=I=>{I.preventDefault(),n(!1);const b=I.dataTransfer?.files;b&&b.length>0&&E(b[0])},ee=I=>{const b=I.target;b.files&&b.files.length>0&&E(b.files[0])},E=I=>{if(!I.name.toLowerCase().endsWith(".csv")){a({success:!1,message:e("banking.pleaseUploadCSV")});return}o(!0);const b=new FileReader;b.onload=G=>{try{const F=(G.target?.result).split(`
`).filter(k=>k.trim());if(F.length<2){a({success:!1,message:e("banking.csvRequiresHeaderAndData")}),o(!1);return}const W=F[0].split(",").map(k=>k.trim().replace(/[\"\']/g,"")),z=F.slice(1).map(k=>{const re=k.split(",").map(D=>D.trim().replace(/[\"\']/g,"")),$={};return W.forEach((D,H)=>{$[D]=re[H]||""}),$});u(z),a({success:!0,message:e("banking.successfullyParsed").replace("{count}",z.length.toString()),count:z.length});const O={...h()};W.forEach(k=>{const re=k.toLowerCase();re.includes("date")&&(O.date=k),(re.includes("description")||re.includes("memo"))&&(O.description=k),(re.includes("reference")||re.includes("check")||re.includes("ref"))&&(O.reference=k),(re.includes("debit")||re.includes("deposit"))&&(O.debit=k),(re.includes("credit")||re.includes("withdrawal")||re.includes("amount"))&&(O.debit?O.credit=k:O.debit=k),re.includes("balance")&&(O.balance=k)}),y(O)}catch{a({success:!1,message:e("banking.errorParsingCSV")})}o(!1)},b.readAsText(I)},A=(I,b)=>{y(G=>({...G,[I]:b}))},T=()=>c().length===0?[]:Object.keys(c()[0]),R=()=>{if(!t.bankAccount||c().length===0)return;const I=h();if(!I.date||!I.description){a({success:!1,message:e("banking.dateDescriptionRequired")});return}o(!0);try{const b=c().map(ie=>{const F=k=>k&&parseFloat(k.replace(/[^0-9.-]/g,""))||0,W=k=>{const re=new Date(k);if(isNaN(re.getTime())){const $=k.split("/");if($.length===3)return new Date(parseInt($[2]),parseInt($[0])-1,parseInt($[1])).toISOString().split("T")[0]}return re.toISOString().split("T")[0]};let z=0,O=0;if(I.debit&&I.credit)z=F(ie[I.debit]),O=F(ie[I.credit]);else if(I.debit){const k=F(ie[I.debit]);k>0?z=k:O=Math.abs(k)}return{accountId:t.bankAccount.accountId,date:W(ie[I.date]),description:ie[I.description]||e("banking.importedTransaction"),reference:ie[I.reference]||"",debitAmount:z,creditAmount:O,balance:I.balance?F(ie[I.balance]):0,isReconciled:!1}}),G=Hn.addBankStatementsFromCSV(b);a({success:!0,message:e("banking.successfullyImported").replace("{count}",G.length.toString()),count:G.length}),u([]),y({date:"",description:"",reference:"",debit:"",credit:"",balance:""})}catch{a({success:!1,message:e("banking.errorImportingTransactions")})}o(!1)},_=()=>{u([]),a(null),y({date:"",description:"",reference:"",debit:"",credit:"",balance:""})};return B(Xn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("banking.importBankStatementCSV")},get children(){return[Te(()=>Te(()=>!!t.bankAccount)()&&(()=>{var I=m6(),b=I.firstChild,G=b.firstChild,ie=b.nextSibling,F=ie.nextSibling;return F.nextSibling,I.style.setProperty("margin-bottom","1.5rem"),I.style.setProperty("padding","1rem"),I.style.setProperty("background","var(--background-color)"),I.style.setProperty("border-radius","var(--border-radius-sm)"),I.style.setProperty("border","1px solid var(--border-color)"),l(b,()=>e("banking.bankAccount"),G),l(I,()=>t.bankAccount.bankName,F),l(I,()=>t.bankAccount.accountNumber,null),I})()),Te(()=>Te(()=>c().length===0)()?(()=>{var I=y6(),b=I.firstChild,G=b.firstChild,ie=G.nextSibling,F=ie.nextSibling,W=b.nextSibling;return b.$$click=()=>document.getElementById("csvFileInput")?.click(),b.addEventListener("drop",Q),b.addEventListener("dragleave",X),b.addEventListener("dragover",ne),G.style.setProperty("font-size","2rem"),G.style.setProperty("margin-bottom","1rem"),ie.style.setProperty("font-weight","500"),ie.style.setProperty("margin-bottom","0.5rem"),l(ie,(()=>{var z=Te(()=>!!r());return()=>z()?e("banking.dropCSVHere"):e("banking.clickToUploadCSV")})()),F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-muted)"),l(F,()=>e("banking.supportedFormat")),W.addEventListener("change",ee),W.style.setProperty("display","none"),we(z=>m(b,g,z)),I})():(()=>{var I=g6(),b=I.firstChild,G=b.nextSibling,ie=G.firstChild,F=ie.firstChild,W=F.firstChild,z=F.nextSibling,O=z.firstChild,k=ie.nextSibling,re=k.firstChild,$=re.firstChild,D=re.nextSibling,H=D.firstChild,L=k.nextSibling,j=L.firstChild,oe=j.nextSibling,K=oe.firstChild,Z=L.nextSibling,J=Z.firstChild,Y=J.firstChild,U=J.nextSibling,ae=U.firstChild,ue=Z.nextSibling,le=ue.firstChild,q=le.nextSibling,ce=q.firstChild,Se=ue.nextSibling,me=Se.firstChild,Pe=me.nextSibling,xe=Pe.firstChild;return b.style.setProperty("margin","0 0 1rem 0"),l(b,()=>e("banking.mapCSVColumns")),m(G,p),F.style.setProperty("display","block"),F.style.setProperty("margin-bottom","0.5rem"),F.style.setProperty("font-weight","500"),l(F,()=>e("banking.dateColumn"),W),z.addEventListener("change",he=>A("date",he.target.value)),l(O,()=>e("banking.selectColumn")),l(z,()=>T().map(he=>(()=>{var ve=Ql();return ve.value=he,l(ve,he),ve})()),null),re.style.setProperty("display","block"),re.style.setProperty("margin-bottom","0.5rem"),re.style.setProperty("font-weight","500"),l(re,()=>e("banking.descriptionColumn"),$),D.addEventListener("change",he=>A("description",he.target.value)),l(H,()=>e("banking.selectColumn")),l(D,()=>T().map(he=>(()=>{var ve=Ql();return ve.value=he,l(ve,he),ve})()),null),j.style.setProperty("display","block"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("font-weight","500"),l(j,()=>e("banking.referenceColumn")),oe.addEventListener("change",he=>A("reference",he.target.value)),l(K,()=>e("banking.selectColumn")),l(oe,()=>T().map(he=>(()=>{var ve=Ql();return ve.value=he,l(ve,he),ve})()),null),J.style.setProperty("display","block"),J.style.setProperty("margin-bottom","0.5rem"),J.style.setProperty("font-weight","500"),l(J,()=>e("banking.amountDebitColumn"),Y),U.addEventListener("change",he=>A("debit",he.target.value)),l(ae,()=>e("banking.selectColumn")),l(U,()=>T().map(he=>(()=>{var ve=Ql();return ve.value=he,l(ve,he),ve})()),null),le.style.setProperty("display","block"),le.style.setProperty("margin-bottom","0.5rem"),le.style.setProperty("font-weight","500"),l(le,()=>e("banking.creditColumn")),q.addEventListener("change",he=>A("credit",he.target.value)),l(ce,()=>e("banking.selectColumn")),l(q,()=>T().map(he=>(()=>{var ve=Ql();return ve.value=he,l(ve,he),ve})()),null),me.style.setProperty("display","block"),me.style.setProperty("margin-bottom","0.5rem"),me.style.setProperty("font-weight","500"),l(me,()=>e("banking.balanceColumn")),Pe.addEventListener("change",he=>A("balance",he.target.value)),l(xe,()=>e("banking.selectColumn")),l(Pe,()=>T().map(he=>(()=>{var ve=Ql();return ve.value=he,l(ve,he),ve})()),null),l(I,(()=>{var he=Te(()=>c().length>0);return()=>he()&&(()=>{var ve=v6(),De=ve.firstChild,ke=De.firstChild,Ce=ke.firstChild,Le=ke.nextSibling;return m(ve,S),Ce.style.setProperty("background-color","var(--background-color)"),l(Ce,()=>T().slice(0,6).map(Ie=>(()=>{var Re=b6();return l(Re,Ie),we(He=>m(Re,x,He)),Re})())),l(Le,()=>c().slice(0,3).map(Ie=>(()=>{var Re=_6();return l(Re,()=>T().slice(0,6).map(He=>(()=>{var Me=w6();return l(Me,()=>Ie[He]),we(Ze=>m(Me,x,Ze)),Me})())),Re})())),l(ve,(()=>{var Ie=Te(()=>c().length>3);return()=>Ie()&&(()=>{var Re=ip();return Re.style.setProperty("padding","0.5rem"),Re.style.setProperty("text-align","center"),Re.style.setProperty("color","var(--text-muted)"),l(Re,()=>e("banking.andMoreRows").replace("{count}",(c().length-3).toString())),Re})()})(),null),we(Ie=>m(De,w,Ie)),ve})()})(),null),we(he=>{var ve=C,De=C,ke=C,Ce=C,Le=C,Ie=C;return he.e=m(z,ve,he.e),he.t=m(D,De,he.t),he.a=m(oe,ke,he.a),he.o=m(U,Ce,he.o),he.i=m(q,Le,he.i),he.n=m(Pe,Ie,he.n),he},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),we(()=>z.value=h().date),we(()=>D.value=h().description),we(()=>oe.value=h().reference),we(()=>U.value=h().debit),we(()=>q.value=h().credit),we(()=>Pe.value=h().balance),I})()),Te(()=>Te(()=>!!s())()&&(()=>{var I=ip();return I.style.setProperty("padding","1rem"),I.style.setProperty("border-radius","var(--border-radius-sm)"),I.style.setProperty("margin-top","1rem"),l(I,()=>s().message),we(b=>{var G=s().success?"#d4edda":"#f8d7da",ie=s().success?"#155724":"#721c24",F=`1px solid ${s().success?"#c3e6cb":"#f5c6cb"}`;return G!==b.e&&((b.e=G)!=null?I.style.setProperty("background",G):I.style.removeProperty("background")),ie!==b.t&&((b.t=ie)!=null?I.style.setProperty("color",ie):I.style.removeProperty("color")),F!==b.a&&((b.a=F)!=null?I.style.setProperty("border",F):I.style.removeProperty("border")),b},{e:void 0,t:void 0,a:void 0}),I})()),(()=>{var I=ip();return m(I,V),l(I,B(xt,{variant:"secondary",onClick:()=>{_(),t.onClose()},get children(){return e("common.cancel")}}),null),l(I,(()=>{var b=Te(()=>c().length>0);return()=>b()&&B(xt,{variant:"outline",onClick:_,get children(){return e("common.reset")}})})(),null),l(I,(()=>{var b=Te(()=>c().length>0);return()=>b()&&B(xt,{variant:"primary",onClick:R,get disabled(){return i()||!h().date||!h().description},get children(){return Te(()=>!!i())()?e("banking.importing"):e("banking.importTransactions").replace("{count}",c().length.toString())}})})(),null),I})()]}})};dr(["click"]);var P0=de("<span>"),jd=de("<div>"),x0=de("<div> "),P6=de("<div><div><h3></h3><div><button></button><button></button><button></button></div></div><div></div><div><div><h4></h4><div></div></div><div><h4></h4><div>"),x6=de("<div><div><div></div><div>  </div></div><div><div>"),op=de("<span> "),A6=de("<span>(<!>)"),C6=de("<div><strong>:</strong> "),A0=de("<div><div><div></div><div>  </div></div><div>"),I6=de("<div><div>:</div><div></div><div>");const $6=t=>{const{t:e}=er(),[r,n]=$e([]),[i,o]=$e([]),[s,a]=$e(null),[c,u]=$e([]),[h,y]=$e("unreconciled");vo(()=>{const F=Hn.getBankAccountById(t.bankAccountId);if(F){const W=Hn.getBankStatementsByAccount(F.accountId).filter(O=>O.date>=t.selectedPeriod.start&&O.date<=t.selectedPeriod.end),z=Hn.getEntryBookRecordsByAccount(F.accountId).filter(O=>O.date>=t.selectedPeriod.start&&O.date<=t.selectedPeriod.end);n(W),o(z)}});const g=()=>{const F=r();switch(h()){case"reconciled":return F.filter(W=>W.isReconciled);case"unreconciled":return F.filter(W=>!W.isReconciled);default:return F}},p=()=>{const F=i();switch(h()){case"reconciled":return F.filter(W=>W.isReconciled);case"unreconciled":return F.filter(W=>!W.isReconciled);default:return F}},C=F=>{if(a(F),F.isReconciled)u([]);else{const W=Hn.findPotentialMatches(F.id);u(W)}},S=F=>{const W=s();if(W){Hn.reconcileTransaction(W.id,F.id);const z=Hn.getBankAccountById(t.bankAccountId);if(z){const O=Hn.getBankStatementsByAccount(z.accountId).filter(re=>re.date>=t.selectedPeriod.start&&re.date<=t.selectedPeriod.end),k=Hn.getEntryBookRecordsByAccount(z.accountId).filter(re=>re.date>=t.selectedPeriod.start&&re.date<=t.selectedPeriod.end);n(O),o(k)}a(null),u([])}},w=F=>{Hn.unreconciledTransaction(F.id);const W=Hn.getBankAccountById(t.bankAccountId);if(W){const z=Hn.getBankStatementsByAccount(W.accountId).filter(k=>k.date>=t.selectedPeriod.start&&k.date<=t.selectedPeriod.end),O=Hn.getEntryBookRecordsByAccount(W.accountId).filter(k=>k.date>=t.selectedPeriod.start&&k.date<=t.selectedPeriod.end);n(z),o(O)}},x={display:"grid","grid-template-columns":"1fr 1fr",gap:"2rem","margin-top":"2rem"},V={height:"600px","overflow-y":"auto"},ne={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},X=F=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:F?"var(--primary-color)":"var(--surface-color)",color:F?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),Q=(F,W)=>({display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem","margin-bottom":"0.5rem",background:F?"var(--primary-color)":W?"#e8f5e8":"var(--surface-color)",color:F?"white":"var(--text-primary)","border-radius":"var(--border-radius-sm)",border:`1px solid ${F?"var(--primary-color)":W?"#c3e6cb":"var(--border-color)"}`,cursor:"pointer",transition:"all 0.2s ease"}),ee={flex:"1"},E={"font-weight":"500","margin-bottom":"0.25rem"},A={"font-size":"0.875rem",opacity:"0.8"},T=F=>({"font-weight":"600",color:F?"#4caf50":"#f44336"}),R={padding:"0.25rem 0.5rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","margin-left":"0.5rem"},_=F=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(F),I=F=>new Date(F).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),b=F=>{if(!s())return null;const W=s();return(Math.abs(W.debitAmount-F.debitAmount)<.01||Math.abs(W.creditAmount-F.creditAmount)<.01)&&W.date===F.date?(()=>{var k=P0();return l(k,()=>e("banking.exactMatch")),we(re=>m(k,{...R,background:"#d4edda",color:"#155724"},re)),k})():c().includes(F)?(()=>{var k=P0();return l(k,()=>e("banking.possibleMatch")),we(re=>m(k,{...R,background:"#fff3cd",color:"#856404"},re)),k})():null},ie=(()=>{const F=r(),W=i(),z=F.filter(k=>k.isReconciled).length,O=W.filter(k=>k.isReconciled).length;return{totalStatements:F.length,totalRecords:W.length,reconciledStatements:z,reconciledRecords:O,unreconciledStatements:F.length-z,unreconciledRecords:W.length-O}})();return(()=>{var F=P6(),W=F.firstChild,z=W.firstChild,O=z.nextSibling,k=O.firstChild,re=k.nextSibling,$=re.nextSibling,D=W.nextSibling,H=D.nextSibling,L=H.firstChild,j=L.firstChild,oe=j.nextSibling,K=L.nextSibling,Z=K.firstChild,J=Z.nextSibling;return m(W,ne),z.style.setProperty("margin","0"),z.style.setProperty("font-size","1.25rem"),l(z,()=>e("banking.reconciliationComparison")),O.style.setProperty("display","flex"),O.style.setProperty("gap","0.5rem"),k.$$click=()=>y("all"),l(k,()=>e("common.all")),re.$$click=()=>y("unreconciled"),l(re,()=>e("banking.unreconciled")),$.$$click=()=>y("reconciled"),l($,()=>e("banking.reconciled")),D.style.setProperty("display","grid"),D.style.setProperty("grid-template-columns","repeat(4, 1fr)"),D.style.setProperty("gap","1rem"),D.style.setProperty("margin-bottom","2rem"),l(D,B(Nt,{get title(){return e("banking.bankStatements")},get subtitle(){return e("banking.totalTransactions")},get children(){return[(()=>{var Y=jd();return Y.style.setProperty("font-size","1.5rem"),Y.style.setProperty("font-weight","600"),Y.style.setProperty("color","var(--primary-color)"),l(Y,()=>ie.totalStatements),Y})(),(()=>{var Y=x0(),U=Y.firstChild;return Y.style.setProperty("font-size","0.875rem"),Y.style.setProperty("color","var(--text-muted)"),l(Y,()=>ie.reconciledStatements,U),l(Y,()=>e("banking.reconciled"),null),Y})()]}}),null),l(D,B(Nt,{get title(){return e("banking.entryBookRecords")},get subtitle(){return e("banking.totalEntries")},get children(){return[(()=>{var Y=jd();return Y.style.setProperty("font-size","1.5rem"),Y.style.setProperty("font-weight","600"),Y.style.setProperty("color","var(--primary-color)"),l(Y,()=>ie.totalRecords),Y})(),(()=>{var Y=x0(),U=Y.firstChild;return Y.style.setProperty("font-size","0.875rem"),Y.style.setProperty("color","var(--text-muted)"),l(Y,()=>ie.reconciledRecords,U),l(Y,()=>e("banking.reconciled"),null),Y})()]}}),null),l(D,B(Nt,{get title(){return e("banking.unreconciledBank")},get subtitle(){return e("banking.needAttention")},get children(){var Y=jd();return Y.style.setProperty("font-size","1.5rem"),Y.style.setProperty("font-weight","600"),Y.style.setProperty("color","#f44336"),l(Y,()=>ie.unreconciledStatements),Y}}),null),l(D,B(Nt,{get title(){return e("banking.unreconciledBooks")},get subtitle(){return e("banking.needAttention")},get children(){var Y=jd();return Y.style.setProperty("font-size","1.5rem"),Y.style.setProperty("font-weight","600"),Y.style.setProperty("color","#f44336"),l(Y,()=>ie.unreconciledRecords),Y}}),null),m(H,x),j.style.setProperty("margin","0 0 1rem 0"),l(j,()=>e("banking.bankStatements")),l(oe,()=>g().map(Y=>(()=>{var U=x6(),ae=U.firstChild,ue=ae.firstChild,le=ue.nextSibling,q=le.firstChild,ce=ae.nextSibling,Se=ce.firstChild;return U.$$click=()=>C(Y),l(ue,()=>Y.description),l(le,()=>I(Y.date),q),l(le,()=>Y.reference,null),l(le,(()=>{var me=Te(()=>!!Y.isReconciled);return()=>me()&&(()=>{var Pe=op();return Pe.firstChild,Pe.style.setProperty("color","#4caf50"),Pe.style.setProperty("margin-left","0.5rem"),l(Pe,()=>e("banking.reconciled"),null),Pe})()})(),null),l(Se,()=>Y.debitAmount>0?"+":"-",null),l(Se,()=>_(Y.debitAmount||Y.creditAmount),null),l(ce,(()=>{var me=Te(()=>!!Y.isReconciled);return()=>me()&&B(xt,{variant:"outline",size:"sm",onClick:Pe=>{Pe.stopPropagation(),w(Y)},style:{"margin-top":"0.5rem"},get children(){return e("banking.unreconcile")}})})(),null),we(me=>{var Pe=Q(s()?.id===Y.id,Y.isReconciled),xe=ee,he=E,ve=A,De=T(Y.debitAmount>0);return me.e=m(U,Pe,me.e),me.t=m(ae,xe,me.t),me.a=m(ue,he,me.a),me.o=m(le,ve,me.o),me.i=m(Se,De,me.i),me},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),U})())),Z.style.setProperty("margin","0 0 1rem 0"),l(Z,()=>e("banking.entryBookRecords"),null),l(Z,(()=>{var Y=Te(()=>!!(s()&&!s().isReconciled));return()=>Y()&&(()=>{var U=A6(),ae=U.firstChild,ue=ae.nextSibling;return ue.nextSibling,U.style.setProperty("font-weight","400"),U.style.setProperty("color","var(--text-muted)"),U.style.setProperty("margin-left","0.5rem"),l(U,()=>e("banking.clickToReconcile"),ue),U})()})(),null),l(J,(()=>{var Y=Te(()=>!!(s()&&!s().isReconciled));return()=>Y()?[Te(()=>Te(()=>c().length>0)()&&(()=>{var U=C6(),ae=U.firstChild,ue=ae.firstChild;return ae.nextSibling,U.style.setProperty("margin-bottom","1rem"),U.style.setProperty("padding","0.75rem"),U.style.setProperty("background","#fff3cd"),U.style.setProperty("border-radius","var(--border-radius-sm)"),l(ae,()=>e("banking.potentialMatchesFound"),ue),l(U,()=>e("banking.clickRecordToReconcile"),null),U})()),Te(()=>p().map(U=>(c().includes(U),(()=>{var ae=A0(),ue=ae.firstChild,le=ue.firstChild,q=le.nextSibling,ce=q.firstChild,Se=ue.nextSibling;return ae.$$click=()=>{U.isReconciled||S(U)},l(le,()=>U.description,null),l(le,()=>b(U),null),l(q,()=>I(U.date),ce),l(q,()=>U.reference,null),l(q,(()=>{var me=Te(()=>!!U.isReconciled);return()=>me()&&(()=>{var Pe=op();return Pe.firstChild,Pe.style.setProperty("color","#4caf50"),Pe.style.setProperty("margin-left","0.5rem"),l(Pe,()=>e("banking.reconciled"),null),Pe})()})(),null),l(Se,()=>U.debitAmount>0?"+":"-",null),l(Se,()=>_(U.debitAmount||U.creditAmount),null),we(me=>{var Pe={...Q(!1,U.isReconciled),opacity:U.isReconciled?.6:1,cursor:U.isReconciled?"not-allowed":"pointer"},xe=ee,he=E,ve=A,De=T(U.debitAmount>0);return me.e=m(ae,Pe,me.e),me.t=m(ue,xe,me.t),me.a=m(le,he,me.a),me.o=m(q,ve,me.o),me.i=m(Se,De,me.i),me},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ae})())))]:p().map(U=>(()=>{var ae=A0(),ue=ae.firstChild,le=ue.firstChild,q=le.nextSibling,ce=q.firstChild,Se=ue.nextSibling;return l(le,()=>U.description),l(q,()=>I(U.date),ce),l(q,()=>U.reference,null),l(q,(()=>{var me=Te(()=>!!U.isReconciled);return()=>me()&&(()=>{var Pe=op();return Pe.firstChild,Pe.style.setProperty("color","#4caf50"),Pe.style.setProperty("margin-left","0.5rem"),l(Pe,()=>e("banking.reconciled"),null),Pe})()})(),null),l(Se,()=>U.debitAmount>0?"+":"-",null),l(Se,()=>_(U.debitAmount||U.creditAmount),null),we(me=>{var Pe=Q(!1,U.isReconciled),xe=ee,he=E,ve=A,De=T(U.debitAmount>0);return me.e=m(ae,Pe,me.e),me.t=m(ue,xe,me.t),me.a=m(le,he,me.a),me.o=m(q,ve,me.o),me.i=m(Se,De,me.i),me},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ae})())})()),l(F,(()=>{var Y=Te(()=>!!(s()&&!s().isReconciled));return()=>Y()&&(()=>{var U=I6(),ae=U.firstChild,ue=ae.firstChild,le=ae.nextSibling,q=le.nextSibling;return U.style.setProperty("position","fixed"),U.style.setProperty("bottom","2rem"),U.style.setProperty("right","2rem"),U.style.setProperty("background","var(--surface-color)"),U.style.setProperty("padding","1rem"),U.style.setProperty("border-radius","var(--border-radius)"),U.style.setProperty("box-shadow","var(--shadow-lg)"),U.style.setProperty("border","1px solid var(--border-color)"),U.style.setProperty("max-width","300px"),ae.style.setProperty("font-weight","500"),ae.style.setProperty("margin-bottom","0.5rem"),l(ae,()=>e("banking.selected"),ue),le.style.setProperty("font-size","0.875rem"),le.style.setProperty("margin-bottom","0.5rem"),l(le,()=>s().description),q.style.setProperty("font-weight","600"),q.style.setProperty("color","var(--primary-color)"),l(q,()=>_(s().debitAmount||s().creditAmount)),l(U,B(xt,{variant:"secondary",size:"sm",onClick:()=>{a(null),u([])},style:{"margin-top":"0.5rem"},get children(){return e("banking.clearSelection")}}),null),U})()})(),null),we(Y=>{var U=X(h()==="all"),ae=X(h()==="unreconciled"),ue=X(h()==="reconciled"),le=V,q=V;return Y.e=m(k,U,Y.e),Y.t=m(re,ae,Y.t),Y.a=m($,ue,Y.a),Y.o=m(oe,le,Y.o),Y.i=m(J,q,Y.i),Y},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),F})()};dr(["click"]);var E6=de("<div><div><h2></h2><p></p></div><div>"),k6=de("<div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date>"),T6=de("<div><button></button><button>"),N6=de("<div><br>"),Qc=de("<div>"),L6=de("<div><div></div><div>  </div><div>"),D6=de("<div>: "),R6=de("<div> <!>  <!> "),M6=de("<div>%"),F6=de("<div> of <!> transactions");const O6=()=>{const{t}=er(),[e,r]=$e(null),[n,i]=$e({start:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[o,s]=$e(!1),[a,c]=$e("overview");vo(()=>{!e()&&Hn.bankAccounts.length>0&&r(Hn.bankAccounts[0])});const u={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},h={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},y={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},g=ne=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:ne?"var(--primary-color)":"var(--text-muted)","border-bottom":ne?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),p={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},C=ne=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ne),S=ne=>new Date(ne).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),w=()=>Hn.bankAccounts.map(ne=>({value:ne.id,label:`${ne.bankName} - ${ne.accountNumber} (${ne.accountType})`})),V=(()=>{if(!e())return null;const ne=Hn.getBankStatementsByAccount(e().accountId).filter(ee=>ee.date>=n().start&&ee.date<=n().end),X=Hn.getEntryBookRecordsByAccount(e().accountId).filter(ee=>ee.date>=n().start&&ee.date<=n().end),Q=ne.filter(ee=>ee.isReconciled).length;return X.filter(ee=>ee.isReconciled).length,{totalBankTransactions:ne.length,totalEntryBookRecords:X.length,reconciledTransactions:Q,unreconciledTransactions:ne.length-Q,reconciliationRate:ne.length>0?Q/ne.length*100:0}})();return B(ro,{get title(){return t("banking.title")},get children(){return[(()=>{var ne=E6(),X=ne.firstChild,Q=X.firstChild,ee=Q.nextSibling,E=X.nextSibling;return m(ne,u),Q.style.setProperty("margin","0 0 0.5rem 0"),Q.style.setProperty("font-size","1.5rem"),l(Q,()=>t("banking.reconciliation")),ee.style.setProperty("margin","0"),ee.style.setProperty("color","var(--text-muted)"),l(ee,()=>t("banking.compareStatements")),E.style.setProperty("display","flex"),E.style.setProperty("gap","1rem"),l(E,B(xt,{variant:"secondary",onClick:()=>s(!0),get disabled(){return!e()},get children(){return t("banking.importCSV")}}),null),l(E,B(xt,{variant:"primary",get children(){return t("banking.startNewReconciliation")}}),null),ne})(),(()=>{var ne=k6(),X=ne.firstChild,Q=X.firstChild,ee=X.nextSibling,E=ee.firstChild,A=E.nextSibling,T=ee.nextSibling,R=T.firstChild,_=R.nextSibling;return m(ne,h),X.style.setProperty("flex","1"),Q.style.setProperty("display","block"),Q.style.setProperty("margin-bottom","0.5rem"),Q.style.setProperty("font-weight","500"),l(Q,()=>t("banking.bankAccount")),l(X,B(ci,{label:"",get value(){return e()?.id||""},onChange:I=>{const b=Hn.getBankAccountById(I);r(b||null)},get options(){return w()}}),null),E.style.setProperty("display","block"),E.style.setProperty("margin-bottom","0.5rem"),E.style.setProperty("font-weight","500"),l(E,()=>t("entryBooks.startDate")),A.addEventListener("change",I=>i(b=>({...b,start:I.target.value}))),A.style.setProperty("padding","0.75rem"),A.style.setProperty("border","1px solid var(--border-color)"),A.style.setProperty("border-radius","var(--border-radius-sm)"),A.style.setProperty("font-family","inherit"),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),l(R,()=>t("entryBooks.endDate")),_.addEventListener("change",I=>i(b=>({...b,end:I.target.value}))),_.style.setProperty("padding","0.75rem"),_.style.setProperty("border","1px solid var(--border-color)"),_.style.setProperty("border-radius","var(--border-radius-sm)"),_.style.setProperty("font-family","inherit"),we(()=>A.value=n().start),we(()=>_.value=n().end),ne})(),(()=>{var ne=T6(),X=ne.firstChild,Q=X.nextSibling;return m(ne,y),X.$$click=()=>c("overview"),l(X,()=>t("common.overview")),Q.$$click=()=>c("reconciliation"),l(Q,()=>t("banking.reconciliation")),we(ee=>{var E=g(a()==="overview"),A=g(a()==="reconciliation");return ee.e=m(X,E,ee.e),ee.t=m(Q,A,ee.t),ee},{e:void 0,t:void 0}),ne})(),Te(()=>Te(()=>a()==="overview")()&&(()=>{var ne=Qc();return l(ne,(()=>{var X=Te(()=>!!e());return()=>X()&&(()=>{var Q=Qc();return m(Q,p),l(Q,B(Nt,{get title(){return t("banking.bankAccountInfo")},get subtitle(){return t("banking.currentAccountDetails")},get children(){return[(()=>{var ee=L6(),E=ee.firstChild,A=E.nextSibling,T=A.firstChild,R=A.nextSibling;return ee.style.setProperty("margin-bottom","1rem"),E.style.setProperty("font-weight","600"),E.style.setProperty("margin-bottom","0.5rem"),l(E,()=>e().bankName),A.style.setProperty("color","var(--text-muted)"),A.style.setProperty("margin-bottom","0.5rem"),l(A,()=>e().accountNumber,T),l(A,()=>e().accountType,null),R.style.setProperty("font-size","1.25rem"),R.style.setProperty("font-weight","600"),R.style.setProperty("color","var(--primary-color)"),l(R,()=>C(e().currentBalance)),ee})(),Te(()=>Te(()=>!!e().lastReconciledDate)()&&(()=>{var ee=D6(),E=ee.firstChild;return ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-muted)"),l(ee,()=>t("banking.lastReconciled"),E),l(ee,()=>S(e().lastReconciledDate),null),ee})())]}}),null),l(Q,V&&[B(Nt,{get title(){return t("banking.bankTransactions")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var ee=Qc();return ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","600"),ee.style.setProperty("color","var(--primary-color)"),ee.style.setProperty("margin-bottom","0.5rem"),l(ee,()=>V.totalBankTransactions),ee})(),(()=>{var ee=R6(),E=ee.firstChild,A=E.nextSibling,T=A.nextSibling,R=T.nextSibling;return R.nextSibling,ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-muted)"),l(ee,()=>V.reconciledTransactions,E),l(ee,()=>t("banking.reconciled"),A),l(ee,()=>V.unreconciledTransactions,R),l(ee,()=>t("banking.pending"),null),ee})()]}}),B(Nt,{get title(){return t("entryBooks.entryBookRecords")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var ee=Qc();return ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","600"),ee.style.setProperty("color","var(--primary-color)"),ee.style.setProperty("margin-bottom","0.5rem"),l(ee,()=>V.totalEntryBookRecords),ee})(),(()=>{var ee=Qc();return ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-muted)"),l(ee,()=>t("banking.bookEntriesForComparison")),ee})()]}}),B(Nt,{get title(){return t("banking.reconciliationRate")},get subtitle(){return t("banking.completionStatus")},get children(){return[(()=>{var ee=M6(),E=ee.firstChild;return ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","600"),ee.style.setProperty("margin-bottom","0.5rem"),l(ee,()=>Math.round(V.reconciliationRate),E),we(A=>(A=V.reconciliationRate>80?"#4caf50":V.reconciliationRate>50?"#ff9800":"#f44336")!=null?ee.style.setProperty("color",A):ee.style.removeProperty("color")),ee})(),(()=>{var ee=F6(),E=ee.firstChild,A=E.nextSibling;return A.nextSibling,ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-muted)"),l(ee,()=>V.reconciledTransactions,E),l(ee,()=>V.totalBankTransactions,A),ee})()]}})],null),Q})()})(),null),l(ne,B(Nt,{get title(){return t("banking.recentReconciliationSessions")},get subtitle(){return t("banking.latestActivity")},get children(){var X=N6(),Q=X.firstChild;return X.style.setProperty("text-align","center"),X.style.setProperty("color","var(--text-muted)"),X.style.setProperty("padding","2rem"),l(X,()=>t("banking.noRecentSessions"),Q),l(X,B(xt,{variant:"primary",style:{"margin-top":"1rem"},onClick:()=>c("reconciliation"),get children(){return t("banking.startFirstReconciliation")}}),null),X}}),null),ne})()),Te(()=>Te(()=>!!(a()==="reconciliation"&&e()))()&&B($6,{get bankAccountId(){return e().id},get selectedPeriod(){return n()}})),B(S6,{get isOpen(){return o()},onClose:()=>s(!1),get bankAccount(){return e()}})]}})};dr(["click"]);dr(["input","click"]);var B6=de("<h2>Upload Bank Statement CSV"),j6=de("<input type=file accept=.csv>"),V6=de("<h3>Filters"),q6=de('<div><input type=text placeholder="Search transactions..."><input type=date placeholder="Start Date"><input type=date placeholder="End Date"><button>Download Detailed Report'),z6=de("<div><button>Summary</button><button>Deposits</button><button>Payments</button><button>Timeline"),U6=de("<h3>Total Deposits"),Vd=de("<p>"),C0=de("<p> transactions"),H6=de("<h3>Total Payments"),W6=de("<h3>Net Cash Flow"),G6=de("<h3>Check Payments"),Y6=de("<p> checks"),Xc=de("<div>"),K6=de("<h3>Accounts & Payment Methods Used"),J6=de("<h3>Monthly Cash Flow Trend"),Q6=de("<div><table><thead><tr><th>Month</th><th>Deposits</th><th>Payments</th><th>Net</th></tr></thead><tbody>"),X6=de("<h2>Deposits by Type"),Z6=de("<h2>Top Depositors"),eN=de("<div><table><thead><tr><th>Depositor</th><th>Total Amount</th><th>Count</th><th>Actions</th></tr></thead><tbody>"),tN=de("<h2>Payments by Category"),rN=de("<h2>Top Payees"),nN=de("<div><table><thead><tr><th>Payee</th><th>Category</th><th>Total Amount</th><th>Count</th></tr></thead><tbody>"),iN=de("<h2>Transaction Timeline"),oN=de("<div><h1>Detailed Bank Statement Analyzer"),sN=de("<span>"),aN=de("<tr><td></td><td></td><td></td><td>"),I0=de("<div><h4></h4><p></p><p> transactions"),lN=de("<tr><td></td><td></td><td></td><td><details><summary>View</summary><div>"),cN=de("<div> - "),uN=de("<tr><td></td><td><span></span></td><td></td><td>"),dN=de("<div><div><div></div><div>  </div></div><div><div>");const hN=()=>{const[t,e]=$e(""),[r,n]=$e("summary"),[i,o]=$e(""),[s,a]=$e({start:"",end:""}),[c,u]=qh({list:[]}),h={Utilities:["AT&T","METRO BY T-MOBILE","COMCAST","STREAM ENERGY","NETFLIX","SPECTRUM"],checks:["CHECK"],JPM:["JPM","POVBR"],Transportation:["DRIVE AWAY","TRANPORT","QUICKQUACK","EXXON","SHELL","CHEVRON","UBER","LYFT","U-HAUL","UHAL","LOVE'S"],Lodging:["HOLIDAY INN","MARRIOTT","HILTON","AIRBNB","HOTEL","MOTEL"],"Food & Dining":["GOLDEN CORRAL","MOCTEZUMA","CHINA STAR","RESTAURANT","CAFE","STARBUCKS","BUFFET","GRILL","MARKET","SEAFOOD"],Shopping:["BURLINGTON","WALMART","TARGET","AMAZON","ROSS","KROGER","PUBLIC","AMZN","AMZ"],Financial:["AMERICANFIRSTFIN","LOAN","CREDIT"],Insurance:["INSURANCE","GEICO","STATE FARM"],Rent:["SHAFAII INVESTME"],Medical:["PHARMACY","CVS","WALGREENS","HOSPITAL","CLINIC"],Entertainment:["CINEMA","THEATER","CONCERT"],"Other Services":["BARBER","SALON","SPA","GYM"],Return:["RETURN ITEM "]},y=X=>{const Q=X.toUpperCase();for(const[ee,E]of Object.entries(h))for(const A of E)if(Q.includes(A.toUpperCase()))return ee;return"Other"},g=X=>{const Q=X.match(/Zelle payment from ([^0-9]+)/i);if(Q)return Q[1].trim().replace(/[A-Z0-9]{10,}$/,"").trim();if(X.includes("CHECK"))return"Check Payment";const ee=X.match(/^([^0-9]+)/);return ee?ee[1].trim():X.substring(0,30)},p=X=>{const Q=X.trim().split(`
`),ee=[];console.log(Q);for(let E=1;E<Q.length;E++){const A=Q[E].split(",");if(console.log(A),A.length>=3){const T=parseFloat(A[2]);let R={postingDate:A[0],description:A[1],amount:T};ee.push(R)}}return console.log({transactions:ee}),u("list",ee),ee};Tt(()=>t()?p(t()):[]);const C=Tt(()=>{let X=c?.list;if((s().start||s().end)&&(X=X.filter(Q=>{const ee=new Date(Q.postingDate),E=s().start?new Date(s().start):new Date("2024-01-01"),A=s().end?new Date(s().end):new Date("2024-12-31");return ee>=E&&ee<=A})),i()){const Q=i().toLowerCase();X=X.filter(ee=>ee.description.toLowerCase().includes(Q)||Math.abs(ee.amount).toString().includes(Q))}return X}),S=Tt(()=>{const X={deposits:{total:0,count:0,byType:new Map,byPayee:new Map},payments:{total:0,count:0,byType:new Map,byPayee:new Map},checks:{total:0,count:0,transactions:[]},transfers:{total:0,count:0,transactions:[]},dailyBalances:new Map,accountsAffected:new Set};return C().forEach(Q=>{const ee=g(Q.description);if(console.log({transaction:Q}),X.dailyBalances.set(Q.postingDate,Q.amount),(Q.description.includes("ZELLE")||Q.description.includes("QUICKPAY"))&&X.accountsAffected.add("Zelle Account"),Q.description.includes("ACH")&&X.accountsAffected.add("ACH Network"),Q?.description.includes("DEBIT_CARD")&&X.accountsAffected.add("Debit Card"),Q?.description.includes("CHECK")&&X.accountsAffected.add("Checking Account"),Q?.description.includes("TRANSFER")&&X.accountsAffected.add("Savings Account"),Q.amount>0){X.deposits.total+=Q.amount,X.deposits.count++,X.deposits.byType.has(Q.description)||X.deposits.byType.set(Q.description,{total:0,count:0,transactions:[]});const E=X.deposits.byType.get(Q.description);E.total+=Q.amount,E.count++,E.transactions.push(Q),X.deposits.byPayee.has(ee)||X.deposits.byPayee.set(ee,{name:ee,totalAmount:0,transactionCount:0,transactions:[]});const A=X.deposits.byPayee.get(ee);A.totalAmount+=Q.amount,A.transactionCount++,A.transactions.push(Q)}if(Q.amount<0){X.payments.total+=Math.abs(Q.amount),X.payments.count++,X.payments.byType.has(Q.description)||X.payments.byType.set(Q.description,{total:0,count:0,transactions:[]});const E=X.payments.byType.get(Q.description);E.total+=Math.abs(Q.amount),E.count++,E.transactions.push(Q);const A=y(Q.description);X.payments.byPayee.has(ee)||X.payments.byPayee.set(ee,{name:ee,totalAmount:0,transactionCount:0,transactions:[],category:A});const T=X.payments.byPayee.get(ee);T.totalAmount+=Math.abs(Q.amount),T.transactionCount++,T.transactions.push(Q)}(Q.type==="CHECK_PAID"||Q.checkNumber)&&(X.checks.total+=Math.abs(Q.amount),X.checks.count++,X.checks.transactions.push(Q)),(Q.description.includes("TRANSFER")||Q.description==="ACCT_XFER")&&(X.transfers.total+=Math.abs(Q.amount),X.transfers.count++,X.transfers.transactions.push(Q))}),console.log(X),X}),w=Tt(()=>{const X=new Map;return C().forEach(Q=>{const ee=Q.postingDate.substring(0,7);X.has(ee)||X.set(ee,{deposits:0,payments:0,net:0});const E=X.get(ee);Q.amount>0?E.deposits+=Q.amount:E.payments+=Math.abs(Q.amount),E.net=E.deposits-E.payments}),Array.from(X.entries()).sort((Q,ee)=>Q[0].localeCompare(ee[0]))}),x=X=>{const ee=X.target.files?.[0];if(ee){const E=new FileReader;E.onload=A=>{console.log(A.target?.result),p(A.target?.result)},E.readAsText(ee)}},V=()=>{const X=S();let Q=`# DETAILED BANK STATEMENT ANALYSIS
`;Q+=`Generated: ${new Date().toLocaleDateString()}

`,Q+=`## EXECUTIVE SUMMARY

`,Q+=`- **Total Deposits:** $${X.deposits.total.toFixed(2)} (${X.deposits.count} transactions)
`,Q+=`- **Total Payments:** $${X.payments.total.toFixed(2)} (${X.payments.count} transactions)
`,Q+=`- **Net Cash Flow:** $${(X.deposits.total-X.payments.total).toFixed(2)}
`,Q+=`- **Check Payments:** $${X.checks.total.toFixed(2)} (${X.checks.count} checks)
`,Q+=`- **Transfers:** $${X.transfers.total.toFixed(2)} (${X.transfers.count} transfers)

`,Q+=`## ACCOUNTS AFFECTED

`,X.accountsAffected.forEach(I=>{Q+=`- ${I}
`}),Q+=`
`,Q+=`## DEPOSITS DETAIL

`,Q+=`### By Type
`,X.deposits.byType.forEach((I,b)=>{Q+=`- **${b}**: $${I.total.toFixed(2)} (${I.count} transactions)
`}),Q+=`
### Top Depositors
`,Array.from(X.deposits.byPayee.entries()).sort((I,b)=>b[1].totalAmount-I[1].totalAmount).slice(0,20).forEach(([I,b])=>{Q+=`- **${I}**: $${b.totalAmount.toFixed(2)} (${b.transactionCount} transactions)
`}),Q+=`
## PAYMENTS DETAIL

`,Q+=`### By Type
`,X.payments.byType.forEach((I,b)=>{Q+=`- **${b}**: $${I.total.toFixed(2)} (${I.count} transactions)
`}),Q+=`
### By Category
`;const E=new Map;X.payments.byPayee.forEach(I=>{const b=I.category||"Other";E.set(b,(E.get(b)||0)+I.totalAmount)}),Array.from(E.entries()).sort((I,b)=>b[1]-I[1]).forEach(([I,b])=>{Q+=`- **${I}**: $${b.toFixed(2)}
`}),Q+=`
### Top Payees
`,Array.from(X.payments.byPayee.entries()).sort((I,b)=>b[1].totalAmount-I[1].totalAmount).slice(0,20).forEach(([I,b])=>{Q+=`- **${I}** (${b.category}): $${b.totalAmount.toFixed(2)} (${b.transactionCount} transactions)
`}),Q+=`
## MONTHLY CASH FLOW TREND

`,w().forEach(([I,b])=>{Q+=`- **${I}**: Deposits: $${b.deposits.toFixed(2)} | Payments: $${b.payments.toFixed(2)} | Net: $${b.net.toFixed(2)}
`}),X.checks.transactions.length>0&&(Q+=`
## CHECK PAYMENTS DETAIL

`,X.checks.transactions.forEach(I=>{Q+=`- Check #${I.checkNumber||"N/A"} - ${I.postingDate} - $${Math.abs(I.amount).toFixed(2)}
`}));const T=new Blob([Q],{type:"text/markdown"}),R=URL.createObjectURL(T),_=document.createElement("a");_.href=R,_.download=`detailed_bank_analysis_${new Date().toISOString().split("T")[0]}.md`,_.click(),URL.revokeObjectURL(R)},ne=X=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(X);return(()=>{var X=oN(),Q=X.firstChild;return X.style.setProperty("padding","2rem"),Q.style.setProperty("margin-bottom","2rem"),l(X,B(Nt,{style:{"margin-bottom":"2rem"},get children(){return[B6(),(()=>{var ee=j6();return ee.addEventListener("change",x),ee.style.setProperty("margin-top","1rem"),ee})()]}}),null),l(X,B(Ge,{get when(){return c?.list},get children(){return[B(Nt,{style:{"margin-bottom":"2rem"},get children(){return[V6(),(()=>{var ee=q6(),E=ee.firstChild,A=E.nextSibling,T=A.nextSibling,R=T.nextSibling;return ee.style.setProperty("display","flex"),ee.style.setProperty("gap","1rem"),ee.style.setProperty("margin-top","1rem"),ee.style.setProperty("flex-wrap","wrap"),E.$$input=_=>o(_.currentTarget.value),E.style.setProperty("flex","1"),E.style.setProperty("min-width","200px"),E.style.setProperty("padding","0.5rem"),A.$$input=_=>a({...s(),start:_.currentTarget.value}),T.$$input=_=>a({...s(),end:_.currentTarget.value}),R.$$click=V,R.style.setProperty("padding","0.5rem 1rem"),R.style.setProperty("background","var(--primary-color)"),R.style.setProperty("color","white"),R.style.setProperty("border","none"),R.style.setProperty("border-radius","var(--border-radius-sm)"),R.style.setProperty("cursor","pointer"),we(()=>E.value=i()),we(()=>A.value=s().start),we(()=>T.value=s().end),ee})()]}}),(()=>{var ee=z6(),E=ee.firstChild,A=E.nextSibling,T=A.nextSibling,R=T.nextSibling;return ee.style.setProperty("display","flex"),ee.style.setProperty("gap","1rem"),ee.style.setProperty("margin-bottom","2rem"),E.$$click=()=>n("summary"),E.style.setProperty("padding","0.5rem 1rem"),E.style.setProperty("border","none"),E.style.setProperty("border-radius","var(--border-radius-sm)"),E.style.setProperty("cursor","pointer"),A.$$click=()=>n("deposits"),A.style.setProperty("padding","0.5rem 1rem"),A.style.setProperty("border","none"),A.style.setProperty("border-radius","var(--border-radius-sm)"),A.style.setProperty("cursor","pointer"),T.$$click=()=>n("payments"),T.style.setProperty("padding","0.5rem 1rem"),T.style.setProperty("border","none"),T.style.setProperty("border-radius","var(--border-radius-sm)"),T.style.setProperty("cursor","pointer"),R.$$click=()=>n("timeline"),R.style.setProperty("padding","0.5rem 1rem"),R.style.setProperty("border","none"),R.style.setProperty("border-radius","var(--border-radius-sm)"),R.style.setProperty("cursor","pointer"),we(_=>{var I=r()==="summary"?"var(--primary-color)":"#e9ecef",b=r()==="summary"?"white":"black",G=r()==="deposits"?"var(--primary-color)":"#e9ecef",ie=r()==="deposits"?"white":"black",F=r()==="payments"?"var(--primary-color)":"#e9ecef",W=r()==="payments"?"white":"black",z=r()==="timeline"?"var(--primary-color)":"#e9ecef",O=r()==="timeline"?"white":"black";return I!==_.e&&((_.e=I)!=null?E.style.setProperty("background",I):E.style.removeProperty("background")),b!==_.t&&((_.t=b)!=null?E.style.setProperty("color",b):E.style.removeProperty("color")),G!==_.a&&((_.a=G)!=null?A.style.setProperty("background",G):A.style.removeProperty("background")),ie!==_.o&&((_.o=ie)!=null?A.style.setProperty("color",ie):A.style.removeProperty("color")),F!==_.i&&((_.i=F)!=null?T.style.setProperty("background",F):T.style.removeProperty("background")),W!==_.n&&((_.n=W)!=null?T.style.setProperty("color",W):T.style.removeProperty("color")),z!==_.s&&((_.s=z)!=null?R.style.setProperty("background",z):R.style.removeProperty("background")),O!==_.h&&((_.h=O)!=null?R.style.setProperty("color",O):R.style.removeProperty("color")),_},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),ee})(),B(Ge,{get when(){return r()==="summary"},get children(){return[(()=>{var ee=Xc();return ee.style.setProperty("display","grid"),ee.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),ee.style.setProperty("gap","1rem"),ee.style.setProperty("margin-bottom","2rem"),l(ee,B(Nt,{get children(){return[U6(),(()=>{var E=Vd();return E.style.setProperty("font-size","2rem"),E.style.setProperty("font-weight","bold"),E.style.setProperty("color","#22c55e"),l(E,()=>ne(S().deposits.total)),E})(),(()=>{var E=C0(),A=E.firstChild;return E.style.setProperty("color","#6c757d"),l(E,()=>S().deposits.count,A),E})()]}}),null),l(ee,B(Nt,{get children(){return[H6(),(()=>{var E=Vd();return E.style.setProperty("font-size","2rem"),E.style.setProperty("font-weight","bold"),E.style.setProperty("color","#ef4444"),l(E,()=>ne(S().payments.total)),E})(),(()=>{var E=C0(),A=E.firstChild;return E.style.setProperty("color","#6c757d"),l(E,()=>S().payments.count,A),E})()]}}),null),l(ee,B(Nt,{get children(){return[W6(),(()=>{var E=Vd();return E.style.setProperty("font-size","2rem"),E.style.setProperty("font-weight","bold"),l(E,()=>ne(S().deposits.total-S().payments.total)),we(A=>(A=S().deposits.total-S().payments.total>=0?"#22c55e":"#ef4444")!=null?E.style.setProperty("color",A):E.style.removeProperty("color")),E})()]}}),null),l(ee,B(Nt,{get children(){return[G6(),(()=>{var E=Vd();return E.style.setProperty("font-size","2rem"),E.style.setProperty("font-weight","bold"),E.style.setProperty("color","#3b82f6"),l(E,()=>ne(S().checks.total)),E})(),(()=>{var E=Y6(),A=E.firstChild;return E.style.setProperty("color","#6c757d"),l(E,()=>S().checks.count,A),E})()]}}),null),ee})(),B(Nt,{style:{"margin-bottom":"2rem"},get children(){return[K6(),(()=>{var ee=Xc();return ee.style.setProperty("display","flex"),ee.style.setProperty("flex-wrap","wrap"),ee.style.setProperty("gap","0.5rem"),ee.style.setProperty("margin-top","1rem"),l(ee,B(Ut,{get each(){return Array.from(S().accountsAffected)},children:E=>(()=>{var A=sN();return A.style.setProperty("padding","0.25rem 0.75rem"),A.style.setProperty("background","#e9ecef"),A.style.setProperty("border-radius","9999px"),A.style.setProperty("font-size","0.875rem"),l(A,E),A})()})),ee})()]}}),B(Nt,{get children(){return[J6(),(()=>{var ee=Q6(),E=ee.firstChild,A=E.firstChild,T=A.firstChild,R=T.firstChild,_=R.nextSibling,I=_.nextSibling,b=I.nextSibling,G=A.nextSibling;return ee.style.setProperty("overflow-x","auto"),E.style.setProperty("width","100%"),E.style.setProperty("border-collapse","collapse"),E.style.setProperty("margin-top","1rem"),T.style.setProperty("border-bottom","2px solid #dee2e6"),R.style.setProperty("padding","0.75rem"),R.style.setProperty("text-align","left"),_.style.setProperty("padding","0.75rem"),_.style.setProperty("text-align","right"),I.style.setProperty("padding","0.75rem"),I.style.setProperty("text-align","right"),b.style.setProperty("padding","0.75rem"),b.style.setProperty("text-align","right"),l(G,B(Ut,{get each(){return w()},children:([ie,F])=>(()=>{var W=aN(),z=W.firstChild,O=z.nextSibling,k=O.nextSibling,re=k.nextSibling;return W.style.setProperty("border-bottom","1px solid #dee2e6"),z.style.setProperty("padding","0.75rem"),l(z,ie),O.style.setProperty("padding","0.75rem"),O.style.setProperty("text-align","right"),O.style.setProperty("color","#22c55e"),l(O,()=>ne(isNaN(F.deposits)?0:F.deposits)),k.style.setProperty("padding","0.75rem"),k.style.setProperty("text-align","right"),k.style.setProperty("color","#ef4444"),l(k,()=>ne(isNaN(F.payments)?0:F.payments)),re.style.setProperty("padding","0.75rem"),re.style.setProperty("text-align","right"),re.style.setProperty("font-weight","bold"),l(re,()=>ne(F.net)),we($=>($=F.net>=0?"#22c55e":"#ef4444")!=null?re.style.setProperty("color",$):re.style.removeProperty("color")),W})()})),ee})()]}})]}}),B(Ge,{get when(){return r()==="deposits"},get children(){return[B(Nt,{style:{"margin-bottom":"2rem"},get children(){return[X6(),(()=>{var ee=Xc();return ee.style.setProperty("display","grid"),ee.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(300px, 1fr))"),ee.style.setProperty("gap","1rem"),ee.style.setProperty("margin-top","1rem"),l(ee,B(Ut,{get each(){return Array.from(S().deposits.byType.entries())},children:([E,A])=>(()=>{var T=I0(),R=T.firstChild,_=R.nextSibling,I=_.nextSibling,b=I.firstChild;return T.style.setProperty("padding","1rem"),T.style.setProperty("background","#f8f9fa"),T.style.setProperty("border-radius","var(--border-radius-sm)"),T.style.setProperty("border","1px solid #e9ecef"),l(R,E),_.style.setProperty("font-size","1.5rem"),_.style.setProperty("font-weight","bold"),_.style.setProperty("color","#22c55e"),l(_,()=>ne(A.total)),I.style.setProperty("color","#6c757d"),l(I,()=>A.count,b),T})()})),ee})()]}}),B(Nt,{get children(){return[Z6(),(()=>{var ee=eN(),E=ee.firstChild,A=E.firstChild,T=A.firstChild,R=T.firstChild,_=R.nextSibling,I=_.nextSibling,b=I.nextSibling,G=A.nextSibling;return ee.style.setProperty("overflow-x","auto"),E.style.setProperty("width","100%"),E.style.setProperty("border-collapse","collapse"),E.style.setProperty("margin-top","1rem"),T.style.setProperty("border-bottom","2px solid #dee2e6"),R.style.setProperty("padding","0.75rem"),R.style.setProperty("text-align","left"),_.style.setProperty("padding","0.75rem"),_.style.setProperty("text-align","right"),I.style.setProperty("padding","0.75rem"),I.style.setProperty("text-align","center"),b.style.setProperty("padding","0.75rem"),b.style.setProperty("text-align","center"),l(G,B(Ut,{get each(){return Array.from(S().deposits.byPayee.entries()).sort((ie,F)=>F[1].totalAmount-ie[1].totalAmount).slice(0,20)},children:([ie,F])=>(()=>{var W=lN(),z=W.firstChild,O=z.nextSibling,k=O.nextSibling,re=k.nextSibling,$=re.firstChild,D=$.firstChild,H=D.nextSibling;return W.style.setProperty("border-bottom","1px solid #dee2e6"),z.style.setProperty("padding","0.75rem"),l(z,ie),O.style.setProperty("padding","0.75rem"),O.style.setProperty("text-align","right"),O.style.setProperty("color","#22c55e"),O.style.setProperty("font-weight","bold"),l(O,()=>ne(F.totalAmount)),k.style.setProperty("padding","0.75rem"),k.style.setProperty("text-align","center"),l(k,()=>F.transactionCount),re.style.setProperty("padding","0.75rem"),re.style.setProperty("text-align","center"),D.style.setProperty("cursor","pointer"),H.style.setProperty("margin-top","0.5rem"),H.style.setProperty("font-size","0.875rem"),l(H,B(Ut,{get each(){return F.transactions.slice(0,5)},children:L=>(()=>{var j=cN(),oe=j.firstChild;return j.style.setProperty("padding","0.25rem"),l(j,()=>L.postingDate,oe),l(j,()=>ne(L.amount),null),j})()})),W})()})),ee})()]}})]}}),B(Ge,{get when(){return r()==="payments"},get children(){return[B(Nt,{style:{"margin-bottom":"2rem"},get children(){return[tN(),(()=>{var ee=Xc();return ee.style.setProperty("display","grid"),ee.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),ee.style.setProperty("gap","1rem"),ee.style.setProperty("margin-top","1rem"),l(ee,()=>{const E=new Map;return S().payments.byPayee.forEach(A=>{const T=A.category||"Other";E.has(T)||E.set(T,{total:0,count:0});const R=E.get(T);R.total+=A.totalAmount,R.count+=A.transactionCount}),Array.from(E.entries()).sort((A,T)=>T[1].total-A[1].total).map(([A,T])=>(()=>{var R=I0(),_=R.firstChild,I=_.nextSibling,b=I.nextSibling,G=b.firstChild;return R.style.setProperty("padding","1rem"),R.style.setProperty("background","#f8f9fa"),R.style.setProperty("border-radius","var(--border-radius-sm)"),R.style.setProperty("border","1px solid #e9ecef"),l(_,A),I.style.setProperty("font-size","1.5rem"),I.style.setProperty("font-weight","bold"),I.style.setProperty("color","#ef4444"),l(I,()=>ne(T.total)),b.style.setProperty("color","#6c757d"),l(b,()=>T.count,G),R})())}),ee})()]}}),B(Nt,{get children(){return[rN(),(()=>{var ee=nN(),E=ee.firstChild,A=E.firstChild,T=A.firstChild,R=T.firstChild,_=R.nextSibling,I=_.nextSibling,b=I.nextSibling,G=A.nextSibling;return ee.style.setProperty("overflow-x","auto"),E.style.setProperty("width","100%"),E.style.setProperty("border-collapse","collapse"),E.style.setProperty("margin-top","1rem"),T.style.setProperty("border-bottom","2px solid #dee2e6"),R.style.setProperty("padding","0.75rem"),R.style.setProperty("text-align","left"),_.style.setProperty("padding","0.75rem"),_.style.setProperty("text-align","left"),I.style.setProperty("padding","0.75rem"),I.style.setProperty("text-align","right"),b.style.setProperty("padding","0.75rem"),b.style.setProperty("text-align","center"),l(G,B(Ut,{get each(){return Array.from(S().payments.byPayee.entries()).sort((ie,F)=>F[1].totalAmount-ie[1].totalAmount).slice(0,130)},children:([ie,F])=>(()=>{var W=uN(),z=W.firstChild,O=z.nextSibling,k=O.firstChild,re=O.nextSibling,$=re.nextSibling;return W.style.setProperty("border-bottom","1px solid #dee2e6"),z.style.setProperty("padding","0.75rem"),l(z,ie),O.style.setProperty("padding","0.75rem"),k.style.setProperty("padding","0.25rem 0.5rem"),k.style.setProperty("background","#e9ecef"),k.style.setProperty("border-radius","4px"),k.style.setProperty("font-size","0.875rem"),l(k,()=>F.category),re.style.setProperty("padding","0.75rem"),re.style.setProperty("text-align","right"),re.style.setProperty("color","#ef4444"),re.style.setProperty("font-weight","bold"),l(re,()=>ne(F.totalAmount)),$.style.setProperty("padding","0.75rem"),$.style.setProperty("text-align","center"),l($,()=>F.transactionCount),W})()})),ee})()]}})]}}),B(Ge,{get when(){return r()==="timeline"},get children(){return B(Nt,{get children(){return[iN(),(()=>{var ee=Xc();return ee.style.setProperty("max-height","600px"),ee.style.setProperty("overflow-y","auto"),ee.style.setProperty("margin-top","1rem"),l(ee,B(Ut,{get each(){return C().slice(0,100)},children:E=>(()=>{var A=dN(),T=A.firstChild,R=T.firstChild,_=R.nextSibling,I=_.firstChild,b=T.nextSibling,G=b.firstChild;return A.style.setProperty("padding","1rem"),A.style.setProperty("border-bottom","1px solid #e9ecef"),A.style.setProperty("display","flex"),A.style.setProperty("justify-content","space-between"),A.style.setProperty("align-items","center"),T.style.setProperty("flex","1"),R.style.setProperty("font-weight","bold"),l(R,()=>E.description),_.style.setProperty("font-size","0.875rem"),_.style.setProperty("color","#6c757d"),l(_,()=>E.postingDate,I),l(_,()=>E.type,null),l(_,()=>E.checkNumber&&`  Check #${E.checkNumber}`,null),b.style.setProperty("text-align","right"),G.style.setProperty("font-weight","bold"),G.style.setProperty("font-size","1.1rem"),l(G,()=>ne(Math.abs(E.amount)),null),l(G,()=>E.amount>=0?" ":" ",null),we(ie=>(ie=E.amount>=0?"#22c55e":"#ef4444")!=null?G.style.setProperty("color",ie):G.style.removeProperty("color")),A})()})),ee})()]}})}})]}}),null),X})()};dr(["input","click"]);var fN=de("<div><div></div><div>"),sp=de("<div>"),pN=de("<div>  <!>  <!> "),mN=de("<div><div><div></div><div></div></div><div><div></div><div>"),yN=de("<div><div>:"),gN=de("<div> <!>: <!> <!>, <!> "),vN=de("<div><div><div></div><div></div></div><div>"),$0=de("<div> "),bN=de("<div> ");const _N=t=>{const{t:e}=er(),r={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},n={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},i={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},o={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)","margin-bottom":"0.5rem"},s={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"1rem"},a={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},c={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},u={"max-height":"100px","overflow-y":"auto","border-top":"1px solid var(--border-color)","padding-top":"1rem"},h={display:"flex","justify-content":"space-between","align-items":"center","font-size":"0.875rem","margin-bottom":"0.5rem"},y={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},g=x=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[x],p=x=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(x),C=x=>new Date(x).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),S=g(t.entry.status),w=Math.abs(t.entry.totalDebit-t.entry.totalCredit)<.01;return B(Nt,{get children(){return[(()=>{var x=fN(),V=x.firstChild,ne=V.nextSibling;return m(x,r),m(V,n),l(V,()=>t.entry.entryNumber),l(ne,()=>t.entry.status),we(X=>m(ne,{...i,background:S.bg,color:S.color},X)),x})(),(()=>{var x=sp();return m(x,o),l(x,()=>t.entry.description),x})(),(()=>{var x=pN(),V=x.firstChild,ne=V.nextSibling,X=ne.nextSibling,Q=X.nextSibling;return Q.nextSibling,m(x,s),l(x,()=>C(t.entry.date),V),l(x,()=>t.entry.reference||e("journal.noReference","No reference"),ne),l(x,()=>e("journal.createdBy","By"),Q),l(x,()=>t.entry.createdBy,null),x})(),(()=>{var x=mN(),V=x.firstChild,ne=V.firstChild,X=ne.nextSibling,Q=V.nextSibling,ee=Q.firstChild,E=ee.nextSibling;return m(x,a),ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("color","var(--text-muted)"),l(ne,()=>e("journal.totalAmount","Total Amount")),m(X,c),l(X,()=>p(t.entry.totalDebit)),Q.style.setProperty("text-align","right"),ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-muted)"),l(ee,()=>e("journal.lines","Lines")),E.style.setProperty("font-weight","600"),l(E,()=>t.entry.lines.length),x})(),Te(()=>!w&&(()=>{var x=gN(),V=x.firstChild,ne=V.nextSibling,X=ne.nextSibling,Q=X.nextSibling,ee=Q.nextSibling,E=ee.nextSibling,A=E.nextSibling,T=A.nextSibling;return T.nextSibling,x.style.setProperty("padding","0.5rem"),x.style.setProperty("border-radius","var(--border-radius-sm)"),x.style.setProperty("background","#f8d7da"),x.style.setProperty("color","#721c24"),x.style.setProperty("font-size","0.875rem"),x.style.setProperty("margin-bottom","1rem"),l(x,()=>e("journal.entryNotBalancedShort","Entry is not balanced"),ne),l(x,()=>e("journal.debit"),Q),l(x,()=>p(t.entry.totalDebit),E),l(x,()=>e("journal.credit"),T),l(x,()=>p(t.entry.totalCredit),null),x})()),(()=>{var x=yN(),V=x.firstChild,ne=V.firstChild;return m(x,u),V.style.setProperty("font-weight","500"),V.style.setProperty("margin-bottom","0.5rem"),V.style.setProperty("font-size","0.875rem"),l(V,()=>e("journal.accountLines","Account Lines"),ne),l(x,()=>t.entry.lines.slice(0,3).map(X=>(()=>{var Q=vN(),ee=Q.firstChild,E=ee.firstChild,A=E.nextSibling,T=ee.nextSibling;return m(Q,h),ee.style.setProperty("flex","1"),E.style.setProperty("font-weight","500"),l(E,()=>X.accountName),A.style.setProperty("font-size","0.75rem"),A.style.setProperty("color","var(--text-muted)"),l(A,()=>X.description||e("journal.noDescription","No description")),T.style.setProperty("text-align","right"),l(T,(()=>{var R=Te(()=>X.debitAmount>0);return()=>R()&&(()=>{var _=$0(),I=_.firstChild;return _.style.setProperty("color","#4caf50"),_.style.setProperty("font-weight","500"),l(_,()=>e("journal.debitShort","Dr."),I),l(_,()=>p(X.debitAmount),null),_})()})(),null),l(T,(()=>{var R=Te(()=>X.creditAmount>0);return()=>R()&&(()=>{var _=$0(),I=_.firstChild;return _.style.setProperty("color","#f44336"),_.style.setProperty("font-weight","500"),l(_,()=>e("journal.creditShort","Cr."),I),l(_,()=>p(X.creditAmount),null),_})()})(),null),l(T,(()=>{var R=Te(()=>!!X.reconciled);return()=>R()&&(()=>{var _=bN();return _.firstChild,_.style.setProperty("font-size","0.75rem"),_.style.setProperty("color","#4caf50"),l(_,()=>e("banking.reconciled","Reconciled"),null),_})()})(),null),Q})()),null),l(x,(()=>{var X=Te(()=>t.entry.lines.length>3);return()=>X()&&(()=>{var Q=sp();return Q.style.setProperty("text-align","center"),Q.style.setProperty("color","var(--text-muted)"),Q.style.setProperty("font-size","0.875rem"),l(Q,()=>e("journal.andMoreLines","... and {count} more lines").replace("{count}",(t.entry.lines.length-3).toString())),Q})()})(),null),x})(),(()=>{var x=sp();return m(x,y),l(x,B(xt,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.entry),get children(){return e("journal.viewDetails","View Details")}})),x})()]}})},wN=[{id:"je1",entryNumber:"JE-2024-001",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",status:"posted",createdBy:"John Doe",createdAt:"2024-01-15T09:00:00Z",postedAt:"2024-01-15T09:05:00Z",totalDebit:5e3,totalCredit:5e3,lines:[{id:"jel1",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment from ABC Corp",debitAmount:5e3,creditAmount:0,reconciled:!0,reconciledWith:"eb1"},{id:"jel2",accountId:"2001",accountName:"Trade Receivables",description:"Payment received for INV-2024-001",debitAmount:0,creditAmount:5e3}]},{id:"je2",entryNumber:"JE-2024-002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",status:"posted",createdBy:"Jane Smith",createdAt:"2024-01-14T10:00:00Z",postedAt:"2024-01-14T10:15:00Z",totalDebit:250,totalCredit:250,lines:[{id:"jel3",accountId:"5200",accountName:"Office Expenses",description:"Office supplies from Staples",debitAmount:250,creditAmount:0},{id:"jel4",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment to Staples",debitAmount:0,creditAmount:250,reconciled:!0,reconciledWith:"eb2"}]},{id:"je3",entryNumber:"JE-2024-003",date:"2024-01-13",description:"Monthly Rent Payment",reference:"RENT-2024-01",status:"posted",createdBy:"John Doe",createdAt:"2024-01-13T08:00:00Z",postedAt:"2024-01-13T08:30:00Z",totalDebit:2e3,totalCredit:2e3,lines:[{id:"jel5",accountId:"5200",accountName:"Rent Expense",description:"January office rent",debitAmount:2e3,creditAmount:0},{id:"jel6",accountId:"1002",accountName:"Bank - Checking Account",description:"Rent payment",debitAmount:0,creditAmount:2e3,reconciled:!1}]},{id:"je4",entryNumber:"JE-2024-004",date:"2024-01-12",description:"Wire Transfer - Capital Investment",reference:"WIRE-001",status:"posted",createdBy:"Admin",createdAt:"2024-01-12T14:00:00Z",postedAt:"2024-01-12T14:30:00Z",totalDebit:1e4,totalCredit:1e4,lines:[{id:"jel7",accountId:"1002",accountName:"Bank - Checking Account",description:"Wire transfer received",debitAmount:1e4,creditAmount:0,reconciled:!1},{id:"jel8",accountId:"8",accountName:"Owner's Equity",description:"Capital investment",debitAmount:0,creditAmount:1e4}]},{id:"je5",entryNumber:"JE-2024-005",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",status:"posted",createdBy:"HR Manager",createdAt:"2024-01-11T16:00:00Z",postedAt:"2024-01-11T16:30:00Z",totalDebit:3500,totalCredit:3500,lines:[{id:"jel9",accountId:"13",accountName:"Salaries Expense",description:"Monthly salary - John Doe",debitAmount:3500,creditAmount:0},{id:"jel10",accountId:"1002",accountName:"Bank - Checking Account",description:"Salary payment",debitAmount:0,creditAmount:3500,reconciled:!1}]},{id:"je6",entryNumber:"JE-2024-006",date:"2024-01-10",description:"Product Sales - Multiple Customers",reference:"SALES-2024-010",status:"posted",createdBy:"Sales Manager",createdAt:"2024-01-10T11:00:00Z",postedAt:"2024-01-10T11:30:00Z",totalDebit:8500,totalCredit:8500,lines:[{id:"jel11",accountId:"1001",accountName:"Petty Cash",description:"Cash sales",debitAmount:1500,creditAmount:0},{id:"jel12",accountId:"2001",accountName:"Trade Receivables",description:"Credit sales",debitAmount:7e3,creditAmount:0},{id:"jel13",accountId:"10",accountName:"Sales Revenue",description:"Product sales revenue",debitAmount:0,creditAmount:8500}]},{id:"je7",entryNumber:"JE-2024-007",date:"2024-01-09",description:"Inventory Purchase",reference:"PO-2024-002",status:"draft",createdBy:"Warehouse Manager",createdAt:"2024-01-09T15:00:00Z",totalDebit:15e3,totalCredit:15e3,lines:[{id:"jel14",accountId:"3",accountName:"Inventory",description:"Product inventory purchase",debitAmount:15e3,creditAmount:0},{id:"jel15",accountId:"5",accountName:"Accounts Payable",description:"Amount owed to supplier",debitAmount:0,creditAmount:15e3}]},{id:"je8",entryNumber:"JE-2024-008",date:"2024-01-08",description:"Utility Bills Payment",reference:"UTIL-2024-01",status:"posted",createdBy:"Admin",createdAt:"2024-01-08T09:00:00Z",postedAt:"2024-01-08T09:30:00Z",totalDebit:450,totalCredit:450,lines:[{id:"jel16",accountId:"14",accountName:"Operating Expenses",description:"Electricity and water bills",debitAmount:450,creditAmount:0},{id:"jel17",accountId:"1003",accountName:"Bank - Savings Account",description:"Utility payment",debitAmount:0,creditAmount:450}]}],[Xi,ap]=$e(wN),E0=()=>Xi().filter(e=>e.status==="posted").flatMap(e=>e.lines.filter(r=>["1001","1002","1003"].includes(r.accountId))).map(e=>{const r=Xi().find(n=>n.lines.some(i=>i.id===e.id));return r?{id:`eb_${e.id}`,accountId:e.accountId,date:r.date,description:r.description,reference:r.reference,debitAmount:e.debitAmount,creditAmount:e.creditAmount,category:e.accountName,isReconciled:e.reconciled||!1,reconciledWith:e.reconciledWith,createdAt:r.createdAt}:null}).filter(e=>e!==null),Es={get journalEntries(){return Xi()},addJournalEntry(t){const e={...t,id:Date.now().toString()};return ap([...Xi(),e]),e},updateJournalEntry(t,e){ap(Xi().map(r=>r.id===t?{...r,...e}:r))},deleteJournalEntry(t){const e=Xi().find(r=>r.id===t);if(e&&e.status==="posted")throw new Error("Cannot delete posted journal entries. Void them instead.");ap(Xi().filter(r=>r.id!==t))},voidJournalEntry(t){this.updateJournalEntry(t,{status:"void"})},postJournalEntry(t){const e=Xi().find(r=>r.id===t);if(!e)throw new Error("Journal entry not found");if(Math.abs(e.totalDebit-e.totalCredit)>.01)throw new Error("Journal entry is not balanced. Debits must equal credits.");this.updateJournalEntry(t,{status:"posted",postedAt:new Date().toISOString()}),E0()},getJournalEntryById(t){return Xi().find(e=>e.id===t)},getJournalEntriesByStatus(t){return Xi().filter(e=>e.status===t)},getJournalEntriesByDateRange(t,e){return Xi().filter(r=>r.date>=t&&r.date<=e)},getJournalEntriesByAccount(t){return Xi().filter(e=>e.lines.some(r=>r.accountId===t))},getNextEntryNumber(){const t=new Date().getFullYear(),r=Xi().filter(n=>n.entryNumber.includes(t.toString())).reduce((n,i)=>{const o=parseInt(i.entryNumber.split("-").pop()||"0");return o>n?o:n},0);return`JE-${t}-${String(r+1).padStart(3,"0")}`},validateJournalEntry(t){const e=[];if(t.date||e.push("Date is required"),t.description||e.push("Description is required"),(!t.lines||t.lines.length===0)&&e.push("At least one line item is required"),t.lines){const r=t.lines.reduce((i,o)=>i+(o.debitAmount||0),0),n=t.lines.reduce((i,o)=>i+(o.creditAmount||0),0);Math.abs(r-n)>.01&&e.push(`Entry is not balanced. Debit: ${r}, Credit: ${n}`),t.lines.forEach((i,o)=>{i.accountId||e.push(`Line ${o+1}: Account is required`),i.debitAmount===0&&i.creditAmount===0&&e.push(`Line ${o+1}: Either debit or credit amount must be provided`),i.debitAmount>0&&i.creditAmount>0&&e.push(`Line ${o+1}: Cannot have both debit and credit amounts`)})}return{isValid:e.length===0,errors:e}},getBankRelatedEntries(){return E0()}};var SN=de("<form><div></div><div><div><h4></h4></div><div><div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div></div></div><div><div><strong>: </strong></div><div><strong>: </strong></div><div></div></div></div><div>"),k0=de("<div>");const P5=t=>{const{t:e}=er(),[r,n]=$e({entryNumber:"",date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),[i,o]=$e([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),[s,a]=$e(null);vo(()=>{if(t.isOpen){if(t.editEntry)n({entryNumber:t.editEntry.entryNumber,date:t.editEntry.date,description:t.editEntry.description,reference:t.editEntry.reference,createdBy:t.editEntry.createdBy}),o(t.editEntry.lines.map((X,Q)=>({...X,tempId:`line_${Date.now()}_${Q}`})));else{const X=Es.getNextEntryNumber();n({entryNumber:X,date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),o([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])}a(null)}});const c={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},u={display:"grid","grid-template-columns":"2fr 2fr 1fr 1fr 1fr",gap:"1rem","align-items":"end","margin-bottom":"1rem",padding:"1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},h={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},y=()=>Er.accounts.map(X=>({value:X.id,label:`${X.accountNumber} - ${X.name}`})),g=(X,Q)=>{n(ee=>({...ee,[X]:Q}))},p=(X,Q,ee)=>{o(E=>E.map(A=>{if(A.tempId===X){const T={...A,[Q]:ee};if(Q==="accountId"&&typeof ee=="string"){const R=Er.getAccountById(ee);R&&(T.accountName=R.name)}return T}return A}))},C=()=>{o(X=>[...X,{tempId:`line_${Date.now()}_${X.length}`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])},S=X=>{i().length>2&&o(Q=>Q.filter(ee=>ee.tempId!==X))},w=()=>{const X=i().reduce((ee,E)=>ee+(E.debitAmount||0),0),Q=i().reduce((ee,E)=>ee+(E.creditAmount||0),0);return{totalDebit:X,totalCredit:Q,isBalanced:Math.abs(X-Q)<.01}},x=X=>{X.preventDefault(),a(null);const Q=r(),ee=i(),{totalDebit:E,totalCredit:A,isBalanced:T}=w();if(!Q.description){a(e("forms.descriptionRequired","Description is required"));return}if(ee.length<2){a(e("journal.minTwoLinesRequired","At least 2 line items are required"));return}if(!T){a(e("journal.entryNotBalanced","Entry is not balanced. Debit: ${debit}, Credit: ${credit}").replace("${debit}",`$${E.toFixed(2)}`).replace("${credit}",`$${A.toFixed(2)}`));return}for(let _=0;_<ee.length;_++){const I=ee[_];if(!I.accountId){a(e("journal.lineAccountRequired","Line {lineNumber}: Account is required").replace("{lineNumber}",(_+1).toString()));return}if(I.debitAmount===0&&I.creditAmount===0){a(e("journal.lineAmountRequired","Line {lineNumber}: Either debit or credit amount must be provided").replace("{lineNumber}",(_+1).toString()));return}if((I.debitAmount||0)>0&&(I.creditAmount||0)>0){a(e("journal.lineBothAmounts","Line {lineNumber}: Cannot have both debit and credit amounts").replace("{lineNumber}",(_+1).toString()));return}}const R={entryNumber:Q.entryNumber,date:Q.date,description:Q.description,reference:Q.reference,status:"draft",createdBy:Q.createdBy,createdAt:new Date().toISOString(),totalDebit:E,totalCredit:A,lines:ee.map((_,I)=>{const{tempId:b,...G}=_;return{id:`jel_${Date.now()}_${I}`,...G}})};try{t.editEntry?Es.updateJournalEntry(t.editEntry.id,R):Es.addJournalEntry(R),n({entryNumber:Es.getNextEntryNumber(),date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),o([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),t.onClose()}catch(_){a(_ instanceof Error?_.message:e("forms.errorOccurred","An error occurred"))}},V=X=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(X),ne=w();return B(Xn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return Te(()=>!!t.editEntry)()?e("journal.editEntry"):e("journal.addEntry","Add Journal Entry")},get children(){var X=SN(),Q=X.firstChild,ee=Q.nextSibling,E=ee.firstChild,A=E.firstChild,T=E.nextSibling,R=T.firstChild,_=R.firstChild,I=_.firstChild,b=_.nextSibling,G=b.firstChild,ie=b.nextSibling,F=ie.firstChild,W=ie.nextSibling,z=W.firstChild,O=W.nextSibling,k=O.firstChild,re=T.nextSibling,$=re.firstChild,D=$.firstChild,H=D.firstChild,L=$.nextSibling,j=L.firstChild,oe=j.firstChild,K=L.nextSibling,Z=ee.nextSibling;return X.addEventListener("submit",x),Q.style.setProperty("display","grid"),Q.style.setProperty("grid-template-columns","1fr 1fr"),Q.style.setProperty("gap","1rem"),l(Q,B(Or,{get label(){return e("journal.entryNumber")},get value(){return r().entryNumber},onChange:J=>g("entryNumber",J),get disabled(){return!!t.editEntry},required:!0}),null),l(Q,B(Or,{get label(){return e("common.date")},type:"date",get value(){return r().date},onChange:J=>g("date",J),required:!0}),null),l(X,B(Or,{get label(){return e("common.description")},get value(){return r().description},onChange:J=>g("description",J),get placeholder(){return e("journal.enterEntryDescription","Enter journal entry description")},required:!0}),ee),l(X,B(Or,{get label(){return e("journal.reference")},get value(){return r().reference},onChange:J=>g("reference",J),get placeholder(){return e("journal.enterReferenceNumber","Enter reference number")}}),ee),ee.style.setProperty("margin-top","2rem"),E.style.setProperty("display","flex"),E.style.setProperty("justify-content","space-between"),E.style.setProperty("align-items","center"),E.style.setProperty("margin-bottom","1rem"),A.style.setProperty("margin","0"),l(A,()=>e("journal.entryLines","Journal Entry Lines")),l(E,B(xt,{type:"button",variant:"secondary",size:"sm",onClick:C,get children(){return e("journal.addLine","Add Line")}}),null),T.style.setProperty("margin-bottom","1rem"),T.style.setProperty("font-size","0.875rem"),T.style.setProperty("color","var(--text-muted)"),R.style.setProperty("display","grid"),R.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1fr"),R.style.setProperty("gap","1rem"),l(I,()=>e("journal.account")),l(G,()=>e("common.description")),l(F,()=>e("journal.debit")),l(z,()=>e("journal.credit")),l(k,()=>e("common.actions")),l(ee,B(Ut,{get each(){return i()},children:J=>(()=>{var Y=k0();return m(Y,u),l(Y,B(ci,{label:"",get value(){return J.accountId||""},onChange:U=>p(J.tempId,"accountId",U),get options(){return y()}}),null),l(Y,B(Or,{label:"",get value(){return J.description||""},onChange:U=>p(J.tempId,"description",U),get placeholder(){return e("journal.lineDescription","Line description")}}),null),l(Y,B(Or,{label:"",type:"number",get value(){return J.debitAmount?.toString()||"0"},onChange:U=>{p(J.tempId,"debitAmount",parseFloat(U)||0),parseFloat(U)>0&&p(J.tempId,"creditAmount",0)},placeholder:"0.00"}),null),l(Y,B(Or,{label:"",type:"number",get value(){return J.creditAmount?.toString()||"0"},onChange:U=>{p(J.tempId,"creditAmount",parseFloat(U)||0),parseFloat(U)>0&&p(J.tempId,"debitAmount",0)},placeholder:"0.00"}),null),l(Y,B(xt,{type:"button",variant:"outline",size:"sm",onClick:()=>S(J.tempId),get disabled(){return i().length<=2},get children(){return e("common.remove","Remove")}}),null),Y})()}),re),m(re,h),l(D,()=>e("journal.totalDebit","Total Debit"),H),l(D,()=>V(ne.totalDebit),null),l(j,()=>e("journal.totalCredit","Total Credit"),oe),l(j,()=>V(ne.totalCredit),null),K.style.setProperty("font-weight","600"),l(K,(()=>{var J=Te(()=>!!ne.isBalanced);return()=>J()?` ${e("journal.balanced")}`:` ${e("journal.notBalanced","Not Balanced")}`})()),l(X,(()=>{var J=Te(()=>!!s());return()=>J()&&(()=>{var Y=k0();return Y.style.setProperty("padding","1rem"),Y.style.setProperty("border-radius","var(--border-radius-sm)"),Y.style.setProperty("margin-top","1rem"),Y.style.setProperty("background","#f8d7da"),Y.style.setProperty("color","#721c24"),Y.style.setProperty("border","1px solid #f5c6cb"),l(Y,s),Y})()})(),Z),m(Z,c),l(Z,B(xt,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),l(Z,B(xt,{variant:"primary",type:"submit",get disabled(){return!ne.isBalanced},get children(){return Te(()=>!!t.editEntry)()?e("journal.updateEntry","Update Entry"):e("journal.saveAsDraft","Save as Draft")}}),null),we(J=>(J=ne.isBalanced?"#4caf50":"#f44336")!=null?K.style.setProperty("color",J):K.style.removeProperty("color")),X}})};var PN=de("<div><div></div><div></div><div></div><div>"),xN=de("<div><div></div><div></div><div></div><div></div><div>"),AN=de("<div><button></button><button> (<!>)</button><button> (<!>/<!>)"),T0=de("<div>"),CN=de("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><div><h4></h4><div></div></div><div>"),lp=de("<div><span></span><span>"),cp=de("<div><strong>:</strong> "),IN=de("<div><div><div></div><div></div><div></div><div></div><div></div></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div></div></div><div><div><strong> Reconciliation Summary</strong></div><div><div><div><strong>Total Lines:</strong> </div><div><strong>Reconciled:</strong> </div><div><strong>Unreconciled:</strong> </div></div><div><div><strong>Bank Accounts:</strong> </div><div><strong>Bank Reconciled:</strong> "),$N=de("<div><div><div></div><div></div></div><div></div><div></div><div></div><div>"),EN=de("<div><span> "),kN=de("<span>(<!>)"),TN=de("<div><strong>Bank Pending:</strong> "),NN=de("<div><div>Reconciled Lines:"),LN=de("<div><div> Pending Bank Reconciliation:</div><div>Visit Bank Consolidations to reconcile these transactions"),DN=de("<div><div><div><span></span><h3></h3></div><div><div><div></div><div>Total Lines</div></div><div><div></div><div>Reconciled</div></div><div><div></div><div>Pending"),RN=de("<div><h4> Reconciled Lines (<!>)"),MN=de("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div> Matched"),FN=de("<div> "),ON=de("<div><h4> Unreconciled Lines (<!>)"),BN=de("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div> Pending"),jN=de("<div>Bank account"),VN=de("<div><div> Reconciliation Tip</div><div>This entry has unreconciled bank account transactions. Visit <strong>Bank Consolidations</strong> to match these with bank statements.");const qN=t=>{const{t:e}=er(),[r,n]=$e("details"),[i,o]=$e(!1),s=Tt(()=>t.entryId?Es.getJournalEntryById(t.entryId):null),a={"text-align":"center","margin-bottom":"2rem",position:"relative"},c={position:"absolute",top:"0",right:"0",display:"flex",gap:"0.5rem"},u={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","margin-bottom":"0.5rem"},h={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},y={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},g={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem",display:"inline-block"},p={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},C={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},S={"font-weight":"600",color:"var(--text-primary)"},w={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},x=b=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:b?"var(--primary-color)":"var(--text-muted)","border-bottom":b?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),V={display:"grid","grid-template-columns":"2fr 2.5fr 1fr 1fr 1.5fr",gap:"1rem",padding:"1rem 0","border-bottom":"1px solid var(--border-color)","align-items":"center"},ne={...V,"font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","border-bottom":"2px solid var(--border-color)"},X={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},Q={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},ee=b=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[b],E=b=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(b),A=b=>new Date(b).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),T=b=>new Date(b).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),R=()=>{entry.status==="posted"&&!confirm(e("journal.confirmEditPosted","This entry has been posted. Editing will create a new draft copy. Continue?"))||o(!0)},_=()=>{if(s()&&confirm(e("journal.confirmPost","Are you sure you want to post this journal entry? This action cannot be undone.")))try{Es.postJournalEntry(s().id)}catch(b){alert(b instanceof Error?b.message:e("forms.errorPostingEntry","An error occurred while posting the entry"))}},I=()=>{s()&&confirm(e("journal.confirmVoid","Are you sure you want to void this journal entry?"))&&Es.voidJournalEntry(s().id)};return[B(Xn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.entryDetails","Journal Entry Details")},get children(){return Te(()=>!s())()?(()=>{var b=PN(),G=b.firstChild,ie=G.nextSibling,F=ie.nextSibling,W=F.nextSibling;return b.style.setProperty("text-align","center"),b.style.setProperty("padding","3rem"),b.style.setProperty("color","var(--text-muted)"),G.style.setProperty("font-size","1.5rem"),G.style.setProperty("margin-bottom","1rem"),ie.style.setProperty("font-size","1.1rem"),ie.style.setProperty("margin-bottom","0.5rem"),l(ie,()=>e("journal.entryNotFound","Entry Not Found")),F.style.setProperty("font-size","0.875rem"),l(F,()=>e("journal.entryNotFoundMessage","The journal entry you're looking for could not be found or may have been deleted.")),W.style.setProperty("margin-top","2rem"),l(W,B(xt,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),b})():(()=>{const b=s(),G=ee(b.status),ie=Math.abs(b.totalDebit-b.totalCredit)<.01;return[(()=>{var F=xN(),W=F.firstChild,z=W.nextSibling,O=z.nextSibling,k=O.nextSibling,re=k.nextSibling;return m(F,a),l(W,B(xt,{variant:"outline",size:"sm",onClick:R,get title(){return e("journal.editEntryTooltip","Edit this journal entry")},get children(){return e("common.edit")}}),null),l(W,(()=>{var $=Te(()=>b.status==="draft");return()=>$()&&B(xt,{variant:"primary",size:"sm",onClick:_,disabled:!ie,get title(){return ie?e("journal.postEntryTooltip","Post this journal entry"):e("journal.entryMustBeBalanced","Entry must be balanced to post")},get children(){return e("journal.post","Post")}})})(),null),l(W,(()=>{var $=Te(()=>b.status==="posted");return()=>$()&&B(xt,{variant:"outline",size:"sm",onClick:I,style:{color:"#dc3545","border-color":"#dc3545"},get title(){return e("journal.voidEntryTooltip","Void this journal entry")},get children(){return e("entryBooks.void","Void")}})})(),null),m(z,u),l(z,()=>b.entryNumber),m(O,h),l(O,()=>b.description),m(k,y),l(k,()=>E(b.totalDebit)),l(re,()=>b.status),we($=>{var D=c,H={...g,background:G.bg,color:G.color};return $.e=m(W,D,$.e),$.t=m(re,H,$.t),$},{e:void 0,t:void 0}),F})(),(()=>{var F=AN(),W=F.firstChild,z=W.nextSibling,O=z.firstChild,k=O.nextSibling;k.nextSibling;var re=z.nextSibling,$=re.firstChild,D=$.nextSibling,H=D.nextSibling,L=H.nextSibling;return L.nextSibling,m(F,w),W.$$click=()=>n("details"),l(W,()=>e("common.details")),z.$$click=()=>n("lines"),l(z,()=>e("journal.journalLines","Journal Lines"),O),l(z,()=>b.lines.length,k),re.$$click=()=>n("reconciliation"),l(re,()=>e("banking.reconciliation","Reconciliation"),$),l(re,()=>b.lines.filter(j=>j.reconciled).length,D),l(re,()=>b.lines.length,L),we(j=>{var oe=x(r()==="details"),K=x(r()==="lines"),Z=x(r()==="reconciliation");return j.e=m(W,oe,j.e),j.t=m(z,K,j.t),j.a=m(re,Z,j.a),j},{e:void 0,t:void 0,a:void 0}),F})(),Te(()=>Te(()=>r()==="details")()&&(()=>{var F=CN(),W=F.firstChild,z=W.firstChild,O=z.nextSibling,k=W.nextSibling,re=k.firstChild,$=re.nextSibling,D=k.nextSibling,H=D.firstChild,L=H.nextSibling,j=D.nextSibling,oe=j.firstChild,K=oe.nextSibling,Z=j.nextSibling,J=Z.firstChild,Y=J.nextSibling,U=Z.nextSibling,ae=U.firstChild,ue=ae.nextSibling,le=U.nextSibling,q=le.firstChild,ce=q.nextSibling,Se=le.nextSibling,me=Se.firstChild,Pe=me.firstChild,xe=Pe.nextSibling,he=me.nextSibling;return l(z,()=>e("common.date")),l(O,()=>A(b.date)),l(re,()=>e("journal.reference")),l($,()=>b.reference||e("common.notAvailable","N/A")),l(H,()=>e("journal.totalDebit")),l(L,()=>E(b.totalDebit)),l(oe,()=>e("journal.totalCredit")),l(K,()=>E(b.totalCredit)),l(J,()=>e("journal.balanceStatus","Balance Status")),l(Y,()=>ie?`${e("journal.balanced")} `:`${e("journal.unbalanced","Unbalanced")} (${E(Math.abs(b.totalDebit-b.totalCredit))} ${e("journal.difference","difference")})`),l(ae,()=>e("journal.createdBy")),l(ue,()=>b.createdBy),l(q,()=>e("journal.createdAt","Created At")),l(ce,()=>T(b.createdAt)),l(F,(()=>{var ve=Te(()=>!!b.postedAt);return()=>ve()&&(()=>{var De=lp(),ke=De.firstChild,Ce=ke.nextSibling;return l(ke,()=>e("journal.postedAt","Posted At")),l(Ce,()=>T(b.postedAt)),we(Le=>{var Ie=p,Re=C,He=S;return Le.e=m(De,Ie,Le.e),Le.t=m(ke,Re,Le.t),Le.a=m(Ce,He,Le.a),Le},{e:void 0,t:void 0,a:void 0}),De})()})(),Se),Se.style.setProperty("margin-top","2rem"),Se.style.setProperty("padding-top","1rem"),Se.style.setProperty("border-top","2px solid var(--border-color)"),me.style.setProperty("display","flex"),me.style.setProperty("justify-content","space-between"),me.style.setProperty("align-items","center"),me.style.setProperty("margin-bottom","1rem"),Pe.style.setProperty("margin","0"),Pe.style.setProperty("font-size","1rem"),l(Pe,()=>e("journal.quickActions","Quick Actions")),xe.style.setProperty("display","flex"),xe.style.setProperty("gap","0.5rem"),l(xe,B(xt,{variant:"primary",size:"sm",onClick:R,get children(){return[" ",Te(()=>e("journal.editEntry"))]}}),null),l(xe,(()=>{var ve=Te(()=>b.status==="draft");return()=>ve()&&B(xt,{variant:"outline",size:"sm",onClick:_,disabled:!ie,style:{"border-color":ie?"#4caf50":"#f44336",color:ie?"#4caf50":"#f44336"},get children(){return ie?` ${e("journal.postEntry","Post Entry")}`:` ${e("journal.fixBalance","Fix Balance")}`}})})(),null),l(xe,(()=>{var ve=Te(()=>b.status==="posted");return()=>ve()&&B(xt,{variant:"outline",size:"sm",onClick:I,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return[" ",Te(()=>e("journal.voidEntry","Void Entry"))]}})})(),null),he.style.setProperty("padding","1rem"),he.style.setProperty("border-radius","var(--border-radius-sm)"),he.style.setProperty("font-size","0.875rem"),l(he,(()=>{var ve=Te(()=>b.status==="draft");return()=>ve()&&(()=>{var De=cp(),ke=De.firstChild,Ce=ke.firstChild;return ke.nextSibling,l(ke,()=>e("journal.draftEntry","Draft Entry"),Ce),l(De,()=>e("journal.draftEntryDescription","This entry can be edited and posted."),null),l(De,()=>!ie&&`  ${e("journal.entryMustBeBalancedBeforePosting","Entry must be balanced before posting.")}`,null),De})()})(),null),l(he,(()=>{var ve=Te(()=>b.status==="posted");return()=>ve()&&(()=>{var De=cp(),ke=De.firstChild,Ce=ke.firstChild;return ke.nextSibling,l(ke,()=>e("journal.postedEntry","Posted Entry"),Ce),l(De,()=>e("journal.postedEntryDescription","This entry has been posted to the general ledger. Editing will create a new draft copy."),null),De})()})(),null),l(he,(()=>{var ve=Te(()=>b.status==="void");return()=>ve()&&(()=>{var De=cp(),ke=De.firstChild,Ce=ke.firstChild;return ke.nextSibling,l(ke,()=>e("journal.voidEntry"),Ce),l(De,()=>e("journal.voidEntryDescription","This entry has been voided and cannot be modified."),null),De})()})(),null),we(ve=>{var De=p,ke=C,Ce=S,Le=p,Ie=C,Re=S,He=p,Me=C,Ze=S,Ye=p,ut=C,rt=S,We=p,ct=C,pt={...S,color:ie?"#4caf50":"#f44336"},_t=p,Et=C,et=S,Ue=p,ot=C,Xe=S,at=b.status==="draft"?"#fff3cd":b.status==="posted"?"#d4edda":"#f8d7da";return ve.e=m(W,De,ve.e),ve.t=m(z,ke,ve.t),ve.a=m(O,Ce,ve.a),ve.o=m(k,Le,ve.o),ve.i=m(re,Ie,ve.i),ve.n=m($,Re,ve.n),ve.s=m(D,He,ve.s),ve.h=m(H,Me,ve.h),ve.r=m(L,Ze,ve.r),ve.d=m(j,Ye,ve.d),ve.l=m(oe,ut,ve.l),ve.u=m(K,rt,ve.u),ve.c=m(Z,We,ve.c),ve.w=m(J,ct,ve.w),ve.m=m(Y,pt,ve.m),ve.f=m(U,_t,ve.f),ve.y=m(ae,Et,ve.y),ve.g=m(ue,et,ve.g),ve.p=m(le,Ue,ve.p),ve.b=m(q,ot,ve.b),ve.T=m(ce,Xe,ve.T),at!==ve.A&&((ve.A=at)!=null?he.style.setProperty("background",at):he.style.removeProperty("background")),ve},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),F})()),Te(()=>Te(()=>r()==="lines")()&&(()=>{var F=IN(),W=F.firstChild,z=W.firstChild,O=z.nextSibling,k=O.nextSibling,re=k.nextSibling,$=re.nextSibling,D=W.nextSibling,H=D.firstChild,L=H.firstChild,j=L.firstChild;L.nextSibling;var oe=H.nextSibling,K=oe.firstChild,Z=K.firstChild;K.nextSibling;var J=oe.nextSibling,Y=D.nextSibling,U=Y.firstChild,ae=U.nextSibling,ue=ae.firstChild,le=ue.firstChild,q=le.firstChild;q.nextSibling;var ce=le.nextSibling,Se=ce.firstChild;Se.nextSibling;var me=ce.nextSibling,Pe=me.firstChild;Pe.nextSibling;var xe=ue.nextSibling,he=xe.firstChild,ve=he.firstChild;ve.nextSibling;var De=he.nextSibling,ke=De.firstChild;return ke.nextSibling,l(z,()=>e("journal.account")),l(O,()=>e("common.description")),l(k,()=>e("journal.debit")),l(re,()=>e("journal.credit")),l($,()=>e("banking.reconciliation")),l(F,B(Ut,{get each(){return b.lines},children:Ce=>(()=>{var Le=$N(),Ie=Le.firstChild,Re=Ie.firstChild,He=Re.nextSibling,Me=Ie.nextSibling,Ze=Me.nextSibling,Ye=Ze.nextSibling,ut=Ye.nextSibling;return Re.style.setProperty("font-weight","500"),l(Re,()=>Ce.accountName),He.style.setProperty("font-size","0.75rem"),He.style.setProperty("color","var(--text-muted)"),l(He,()=>Er.getAccountById(Ce.accountId)?.accountNumber||Ce.accountId),Me.style.setProperty("font-size","0.875rem"),l(Me,()=>Ce.description||"-"),Ze.style.setProperty("font-weight","600"),l(Ze,(()=>{var rt=Te(()=>Ce.debitAmount>0);return()=>rt()?E(Ce.debitAmount):"-"})()),Ye.style.setProperty("font-weight","600"),l(Ye,(()=>{var rt=Te(()=>Ce.creditAmount>0);return()=>rt()?E(Ce.creditAmount):"-"})()),l(ut,(()=>{var rt=Te(()=>!!Ce.reconciled);return()=>rt()?(()=>{var We=EN(),ct=We.firstChild;return ct.firstChild,We.style.setProperty("display","flex"),We.style.setProperty("align-items","center"),We.style.setProperty("gap","0.5rem"),We.style.setProperty("color","#4caf50"),We.style.setProperty("font-size","0.875rem"),ct.style.setProperty("font-weight","600"),l(ct,()=>e("banking.reconciled"),null),l(We,(()=>{var pt=Te(()=>!!Ce.reconciledWith);return()=>pt()&&(()=>{var _t=kN(),Et=_t.firstChild,et=Et.nextSibling;return et.nextSibling,_t.style.setProperty("font-size","0.75rem"),_t.style.setProperty("color","var(--text-muted)"),_t.style.setProperty("font-style","italic"),l(_t,()=>Ce.reconciledWith,et),_t})()})(),null),We})():(()=>{var We=T0();return We.style.setProperty("color","var(--text-muted)"),We.style.setProperty("font-size","0.875rem"),l(We,()=>e("banking.notReconciled","Not Reconciled")),We})()})()),we(rt=>{var We=V,ct=Ce.debitAmount>0?"#4caf50":"var(--text-muted)",pt=Ce.creditAmount>0?"#f44336":"var(--text-muted)";return rt.e=m(Le,We,rt.e),ct!==rt.t&&((rt.t=ct)!=null?Ze.style.setProperty("color",ct):Ze.style.removeProperty("color")),pt!==rt.a&&((rt.a=pt)!=null?Ye.style.setProperty("color",pt):Ye.style.removeProperty("color")),rt},{e:void 0,t:void 0,a:void 0}),Le})()}),D),m(D,X),l(L,()=>e("journal.totalDebit"),j),l(H,()=>E(b.totalDebit),null),l(K,()=>e("journal.totalCredit"),Z),l(oe,()=>E(b.totalCredit),null),(ie?"#4caf50":"#f44336")!=null?J.style.setProperty("color",ie?"#4caf50":"#f44336"):J.style.removeProperty("color"),J.style.setProperty("font-weight","600"),l(J,()=>ie?` ${e("journal.balanced")}`:` ${e("journal.notBalanced","Not Balanced")}`),Y.style.setProperty("margin-top","1rem"),Y.style.setProperty("padding","1rem"),Y.style.setProperty("border-radius","var(--border-radius-sm)"),Y.style.setProperty("font-size","0.875rem"),U.style.setProperty("margin-bottom","0.5rem"),ae.style.setProperty("display","grid"),ae.style.setProperty("grid-template-columns","1fr 1fr"),ae.style.setProperty("gap","1rem"),le.style.setProperty("margin-bottom","0.25rem"),l(le,()=>b.lines.length,null),ce.style.setProperty("margin-bottom","0.25rem"),ce.style.setProperty("color","#4caf50"),l(ce,()=>b.lines.filter(Ce=>Ce.reconciled).length,null),me.style.setProperty("color","#f44336"),l(me,()=>b.lines.filter(Ce=>!Ce.reconciled).length,null),he.style.setProperty("margin-bottom","0.25rem"),l(he,()=>b.lines.filter(Ce=>["1001","1002","1003"].includes(Ce.accountId)).length,null),De.style.setProperty("margin-bottom","0.25rem"),De.style.setProperty("color","#4caf50"),l(De,()=>b.lines.filter(Ce=>["1001","1002","1003"].includes(Ce.accountId)&&Ce.reconciled).length,null),l(xe,(()=>{var Ce=Te(()=>b.lines.filter(Le=>["1001","1002","1003"].includes(Le.accountId)&&!Le.reconciled).length>0);return()=>Ce()&&(()=>{var Le=TN(),Ie=Le.firstChild;return Ie.nextSibling,Le.style.setProperty("color","#f44336"),l(Le,()=>b.lines.filter(Re=>["1001","1002","1003"].includes(Re.accountId)&&!Re.reconciled).length,null),Le})()})(),null),l(Y,(()=>{var Ce=Te(()=>b.lines.filter(Le=>Le.reconciled).length>0);return()=>Ce()&&(()=>{var Le=NN(),Ie=Le.firstChild;return Le.style.setProperty("margin-top","0.75rem"),Le.style.setProperty("padding-top","0.75rem"),Le.style.setProperty("border-top","1px solid var(--border-color)"),Ie.style.setProperty("margin-bottom","0.5rem"),Ie.style.setProperty("font-weight","500"),l(Le,()=>b.lines.filter(Re=>Re.reconciled).map(Re=>(()=>{var He=lp(),Me=He.firstChild,Ze=Me.nextSibling;return He.style.setProperty("display","flex"),He.style.setProperty("justify-content","space-between"),He.style.setProperty("margin-bottom","0.25rem"),He.style.setProperty("font-size","0.8rem"),l(Me,()=>Re.accountName),Ze.style.setProperty("color","var(--text-muted)"),l(Ze,()=>Re.reconciledWith?` ${Re.reconciledWith}`:"Manual"),He})()),null),Le})()})(),null),l(Y,(()=>{var Ce=Te(()=>b.lines.filter(Le=>!Le.reconciled&&["1001","1002","1003"].includes(Le.accountId)).length>0);return()=>Ce()&&(()=>{var Le=LN(),Ie=Le.firstChild,Re=Ie.nextSibling;return Le.style.setProperty("margin-top","0.75rem"),Le.style.setProperty("padding-top","0.75rem"),Le.style.setProperty("border-top","1px solid var(--border-color)"),Ie.style.setProperty("margin-bottom","0.5rem"),Ie.style.setProperty("font-weight","500"),Ie.style.setProperty("color","#f44336"),l(Le,()=>b.lines.filter(He=>!He.reconciled&&["1001","1002","1003"].includes(He.accountId)).map(He=>(()=>{var Me=lp(),Ze=Me.firstChild,Ye=Ze.nextSibling;return Me.style.setProperty("display","flex"),Me.style.setProperty("justify-content","space-between"),Me.style.setProperty("margin-bottom","0.25rem"),Me.style.setProperty("font-size","0.8rem"),Me.style.setProperty("color","#f44336"),l(Ze,()=>He.accountName),l(Ye,()=>E(He.debitAmount||He.creditAmount)),Me})()),Re),Re.style.setProperty("margin-top","0.5rem"),Re.style.setProperty("font-size","0.75rem"),Re.style.setProperty("color","var(--text-muted)"),Re.style.setProperty("font-style","italic"),Le})()})(),null),we(Ce=>{var Le=ne,Ie=b.lines.some(Re=>Re.reconciled)?"#e8f5e8":"#fff3cd";return Ce.e=m(W,Le,Ce.e),Ie!==Ce.t&&((Ce.t=Ie)!=null?Y.style.setProperty("background",Ie):Y.style.removeProperty("background")),Ce},{e:void 0,t:void 0}),F})()),Te(()=>Te(()=>r()==="reconciliation")()&&(()=>{var F=DN(),W=F.firstChild,z=W.firstChild,O=z.firstChild,k=O.nextSibling,re=z.nextSibling,$=re.firstChild,D=$.firstChild,H=D.nextSibling,L=$.nextSibling,j=L.firstChild,oe=j.nextSibling,K=L.nextSibling,Z=K.firstChild,J=Z.nextSibling;return W.style.setProperty("margin-bottom","1.5rem"),W.style.setProperty("padding","1rem"),W.style.setProperty("border-radius","var(--border-radius)"),W.style.setProperty("border","1px solid var(--border-color)"),z.style.setProperty("display","flex"),z.style.setProperty("align-items","center"),z.style.setProperty("gap","0.5rem"),z.style.setProperty("margin-bottom","1rem"),O.style.setProperty("font-size","1.5rem"),l(O,(()=>{var Y=Te(()=>!!b.lines.every(U=>U.reconciled));return()=>Y()?"":b.lines.some(U=>U.reconciled)?"":""})()),k.style.setProperty("margin","0"),k.style.setProperty("font-size","1.2rem"),l(k,(()=>{var Y=Te(()=>!!b.lines.every(U=>U.reconciled));return()=>Y()?"Fully Reconciled":b.lines.some(U=>U.reconciled)?"Partially Reconciled":"Unreconciled"})()),re.style.setProperty("display","grid"),re.style.setProperty("grid-template-columns","1fr 1fr 1fr"),re.style.setProperty("gap","1rem"),$.style.setProperty("text-align","center"),D.style.setProperty("font-size","2rem"),D.style.setProperty("font-weight","700"),D.style.setProperty("color","var(--primary-color)"),l(D,()=>b.lines.length),H.style.setProperty("font-size","0.875rem"),H.style.setProperty("color","var(--text-muted)"),L.style.setProperty("text-align","center"),j.style.setProperty("font-size","2rem"),j.style.setProperty("font-weight","700"),j.style.setProperty("color","#4caf50"),l(j,()=>b.lines.filter(Y=>Y.reconciled).length),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),K.style.setProperty("text-align","center"),Z.style.setProperty("font-size","2rem"),Z.style.setProperty("font-weight","700"),Z.style.setProperty("color","#f44336"),l(Z,()=>b.lines.filter(Y=>!Y.reconciled).length),J.style.setProperty("font-size","0.875rem"),J.style.setProperty("color","var(--text-muted)"),l(F,(()=>{var Y=Te(()=>b.lines.filter(U=>U.reconciled).length>0);return()=>Y()&&(()=>{var U=RN(),ae=U.firstChild,ue=ae.firstChild,le=ue.nextSibling;return le.nextSibling,U.style.setProperty("margin-bottom","1.5rem"),ae.style.setProperty("margin","0 0 1rem 0"),ae.style.setProperty("font-size","1.1rem"),ae.style.setProperty("color","#4caf50"),ae.style.setProperty("display","flex"),ae.style.setProperty("align-items","center"),ae.style.setProperty("gap","0.5rem"),l(ae,()=>b.lines.filter(q=>q.reconciled).length,le),l(U,()=>b.lines.filter(q=>q.reconciled).map(q=>(()=>{var ce=MN(),Se=ce.firstChild,me=Se.firstChild,Pe=me.nextSibling,xe=Se.nextSibling,he=xe.nextSibling,ve=he.nextSibling,De=ve.nextSibling,ke=De.firstChild;return ce.style.setProperty("display","grid"),ce.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),ce.style.setProperty("gap","1rem"),ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("background","#f0f9f0"),ce.style.setProperty("border-radius","var(--border-radius-sm)"),ce.style.setProperty("align-items","center"),ce.style.setProperty("font-size","0.875rem"),me.style.setProperty("font-weight","500"),l(me,()=>q.accountName),Pe.style.setProperty("font-size","0.75rem"),Pe.style.setProperty("color","var(--text-muted)"),l(Pe,()=>Er.getAccountById(q.accountId)?.accountNumber),xe.style.setProperty("color","var(--text-muted)"),l(xe,()=>q.description||"No description"),he.style.setProperty("font-weight","600"),l(he,(()=>{var Ce=Te(()=>q.debitAmount>0);return()=>Ce()?E(q.debitAmount):"-"})()),ve.style.setProperty("font-weight","600"),l(ve,(()=>{var Ce=Te(()=>q.creditAmount>0);return()=>Ce()?E(q.creditAmount):"-"})()),De.style.setProperty("color","#4caf50"),ke.style.setProperty("font-weight","500"),l(De,(()=>{var Ce=Te(()=>!!q.reconciledWith);return()=>Ce()&&(()=>{var Le=FN();return Le.firstChild,Le.style.setProperty("font-size","0.75rem"),Le.style.setProperty("font-style","italic"),l(Le,()=>q.reconciledWith,null),Le})()})(),null),we(Ce=>{var Le=q.debitAmount>0?"#4caf50":"var(--text-muted)",Ie=q.creditAmount>0?"#f44336":"var(--text-muted)";return Le!==Ce.e&&((Ce.e=Le)!=null?he.style.setProperty("color",Le):he.style.removeProperty("color")),Ie!==Ce.t&&((Ce.t=Ie)!=null?ve.style.setProperty("color",Ie):ve.style.removeProperty("color")),Ce},{e:void 0,t:void 0}),ce})()),null),U})()})(),null),l(F,(()=>{var Y=Te(()=>b.lines.filter(U=>!U.reconciled).length>0);return()=>Y()&&(()=>{var U=ON(),ae=U.firstChild,ue=ae.firstChild,le=ue.nextSibling;return le.nextSibling,U.style.setProperty("margin-bottom","1.5rem"),ae.style.setProperty("margin","0 0 1rem 0"),ae.style.setProperty("font-size","1.1rem"),ae.style.setProperty("color","#f44336"),ae.style.setProperty("display","flex"),ae.style.setProperty("align-items","center"),ae.style.setProperty("gap","0.5rem"),l(ae,()=>b.lines.filter(q=>!q.reconciled).length,le),l(U,()=>b.lines.filter(q=>!q.reconciled).map(q=>(()=>{var ce=BN(),Se=ce.firstChild,me=Se.firstChild,Pe=me.nextSibling,xe=Se.nextSibling,he=xe.nextSibling,ve=he.nextSibling,De=ve.nextSibling,ke=De.firstChild;return ce.style.setProperty("display","grid"),ce.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),ce.style.setProperty("gap","1rem"),ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("background","#fff9f0"),ce.style.setProperty("border-radius","var(--border-radius-sm)"),ce.style.setProperty("align-items","center"),ce.style.setProperty("font-size","0.875rem"),ce.style.setProperty("border","1px solid #ffe0b3"),me.style.setProperty("font-weight","500"),l(me,()=>q.accountName),Pe.style.setProperty("font-size","0.75rem"),Pe.style.setProperty("color","var(--text-muted)"),l(Pe,()=>Er.getAccountById(q.accountId)?.accountNumber),xe.style.setProperty("color","var(--text-muted)"),l(xe,()=>q.description||"No description"),he.style.setProperty("font-weight","600"),l(he,(()=>{var Ce=Te(()=>q.debitAmount>0);return()=>Ce()?E(q.debitAmount):"-"})()),ve.style.setProperty("font-weight","600"),l(ve,(()=>{var Ce=Te(()=>q.creditAmount>0);return()=>Ce()?E(q.creditAmount):"-"})()),De.style.setProperty("color","#f44336"),ke.style.setProperty("font-weight","500"),l(De,(()=>{var Ce=Te(()=>!!["1001","1002","1003"].includes(q.accountId));return()=>Ce()&&(()=>{var Le=jN();return Le.style.setProperty("font-size","0.75rem"),Le.style.setProperty("font-style","italic"),Le})()})(),null),we(Ce=>{var Le=q.debitAmount>0?"#4caf50":"var(--text-muted)",Ie=q.creditAmount>0?"#f44336":"var(--text-muted)";return Le!==Ce.e&&((Ce.e=Le)!=null?he.style.setProperty("color",Le):he.style.removeProperty("color")),Ie!==Ce.t&&((Ce.t=Ie)!=null?ve.style.setProperty("color",Ie):ve.style.removeProperty("color")),Ce},{e:void 0,t:void 0}),ce})()),null),l(U,(()=>{var q=Te(()=>b.lines.filter(ce=>!ce.reconciled&&["1001","1002","1003"].includes(ce.accountId)).length>0);return()=>q()&&(()=>{var ce=VN(),Se=ce.firstChild,me=Se.nextSibling;return ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("background","#ffebee"),ce.style.setProperty("border-radius","var(--border-radius-sm)"),ce.style.setProperty("margin-top","1rem"),ce.style.setProperty("border","1px solid #ffcdd2"),Se.style.setProperty("font-weight","500"),Se.style.setProperty("margin-bottom","0.5rem"),Se.style.setProperty("color","#f44336"),me.style.setProperty("font-size","0.875rem"),me.style.setProperty("color","var(--text-muted)"),ce})()})(),null),U})()})(),null),we(Y=>(Y=b.lines.every(U=>U.reconciled)?"#e8f5e8":b.lines.some(U=>U.reconciled)?"#fff3cd":"#ffebee")!=null?W.style.setProperty("background",Y):W.style.removeProperty("background")),F})()),(()=>{var F=T0();return m(F,Q),l(F,B(xt,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),l(F,B(xt,{variant:"primary",onClick:R,get children(){return e("journal.editEntry")}}),null),l(F,(()=>{var W=Te(()=>b.status==="draft");return()=>W()&&B(xt,{variant:"outline",onClick:_,disabled:!ie,style:{"border-color":"#4caf50",color:ie?"#4caf50":"var(--text-muted)"},get children(){return ie?e("journal.postEntry","Post Entry"):e("journal.entryNotBalanced","Entry Not Balanced")}})})(),null),l(F,(()=>{var W=Te(()=>b.status==="posted");return()=>W()&&B(xt,{variant:"outline",onClick:I,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return e("journal.voidEntry","Void Entry")}})})(),null),F})()]})()}}),Te(()=>Te(()=>!!s())()&&B(P5,{get isOpen(){return i()},onClose:()=>{o(!1)},get editEntry(){return s()}}))]};dr(["click"]);var zN=de("<div><div><h2></h2><p></p></div><div>"),Ss=de("<div>"),UN=de("<div> <!>  <!> "),HN=de("<div><div><label></label></div><div><label></label></div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label></div><div>"),WN=de("<div><span>:</span><span> "),qd=de("<span>: "),GN=de("<div><br>");const YN=()=>{const{t}=er(),[e,r]=$e(!1),[n,i]=$e(null),[o,s]=$e(!1),[a,c]=$e(null),[u,h]=$e("all"),[y,g]=$e("all"),[p,C]=$e(""),[S,w]=$e(""),[x,V]=$e("date"),[ne,X]=$e("desc"),Q={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},ee={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)","flex-wrap":"wrap"},E={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem"},A={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(400px, 1fr))",gap:"1.5rem"},T=()=>[{value:"all",label:t("journal.allEntries","All Entries")},{value:"draft",label:t("journal.draft")},{value:"posted",label:t("journal.posted")},{value:"void",label:t("entryBooks.void","Void")}],R=()=>[{value:"all",label:t("accounts.allAccounts","All Accounts")},...Er.accounts.map(k=>({value:k.id,label:`${k.accountNumber} - ${k.name}`}))],_=()=>[{value:"date",label:t("common.date")},{value:"entryNumber",label:t("journal.entryNumber")},{value:"amount",label:t("common.amount")}],I=()=>{let k=Es.journalEntries;return u()!=="all"&&(k=k.filter(re=>re.status===u())),y()!=="all"&&(k=k.filter(re=>re.lines.some($=>$.accountId===y()))),p()&&(k=k.filter(re=>re.date>=p())),S()&&(k=k.filter(re=>re.date<=S())),k=[...k].sort((re,$)=>{let D=0;switch(x()){case"date":D=new Date(re.date).getTime()-new Date($.date).getTime();break;case"entryNumber":D=re.entryNumber.localeCompare($.entryNumber);break;case"amount":D=re.totalDebit-$.totalDebit;break}return ne()==="asc"?D:-D}),k},b=()=>{const k=Es.journalEntries,re=k.filter(oe=>oe.status==="draft"),$=k.filter(oe=>oe.status==="posted"),D=k.filter(oe=>oe.status==="void"),H=$.reduce((oe,K)=>oe+K.totalDebit,0),L=$.reduce((oe,K)=>oe+K.totalCredit,0),j=k.filter(oe=>oe.lines.some(K=>["1001","1002","1003"].includes(K.accountId)&&!K.reconciled)).length;return{totalEntries:k.length,draftEntries:re.length,postedEntries:$.length,voidEntries:D.length,totalDebit:H,totalCredit:L,unreconciledEntries:j}},G=k=>{c(k.id),s(!0)},ie=()=>{i(null),r(!0)},F=()=>{r(!1),i(null)},W=k=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(k),z=b(),O=I();return B(ro,{get title(){return t("entryBooks.title")},get children(){return[(()=>{var k=zN(),re=k.firstChild,$=re.firstChild,D=$.nextSibling,H=re.nextSibling;return m(k,Q),$.style.setProperty("margin","0 0 0.5rem 0"),$.style.setProperty("font-size","1.5rem"),l($,()=>t("journal.title")),D.style.setProperty("margin","0"),D.style.setProperty("color","var(--text-muted)"),l(D,()=>t("entryBooks.subtitle","Manage accounting entries and general ledger records")),H.style.setProperty("display","flex"),H.style.setProperty("gap","1rem"),l(H,B(xt,{variant:"secondary",onClick:()=>window.location.href="/bank-consolidations",get children(){return t("entryBooks.viewReconciliation","View Reconciliation")}}),null),l(H,B(xt,{variant:"primary",onClick:ie,get children(){return t("journal.addEntry","Add Journal Entry")}}),null),k})(),(()=>{var k=Ss();return m(k,E),l(k,B(Nt,{get title(){return t("entryBooks.totalEntries","Total Entries")},get subtitle(){return t("entryBooks.allJournalEntries","All journal entries")},get children(){return[(()=>{var re=Ss();return re.style.setProperty("font-size","1.5rem"),re.style.setProperty("font-weight","600"),re.style.setProperty("color","var(--primary-color)"),re.style.setProperty("margin-bottom","0.5rem"),l(re,()=>z.totalEntries),re})(),(()=>{var re=UN(),$=re.firstChild,D=$.nextSibling,H=D.nextSibling,L=H.nextSibling;return L.nextSibling,re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),l(re,()=>z.postedEntries,$),l(re,()=>t("journal.posted").toLowerCase(),D),l(re,()=>z.draftEntries,L),l(re,()=>t("journal.draft").toLowerCase(),null),l(re,(()=>{var j=Te(()=>z.voidEntries>0);return()=>j()&&`  ${z.voidEntries} ${t("entryBooks.void","void").toLowerCase()}`})(),null),re})()]}}),null),l(k,B(Nt,{get title(){return t("journal.totalDebits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var re=Ss();return re.style.setProperty("font-size","1.5rem"),re.style.setProperty("font-weight","600"),re.style.setProperty("color","#4caf50"),re.style.setProperty("margin-bottom","0.5rem"),l(re,()=>W(z.totalDebit)),re})(),(()=>{var re=Ss();return re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),l(re,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",z.postedEntries.toString())),re})()]}}),null),l(k,B(Nt,{get title(){return t("journal.totalCredits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var re=Ss();return re.style.setProperty("font-size","1.5rem"),re.style.setProperty("font-weight","600"),re.style.setProperty("color","#f44336"),re.style.setProperty("margin-bottom","0.5rem"),l(re,()=>W(z.totalCredit)),re})(),(()=>{var re=Ss();return re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),l(re,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",z.postedEntries.toString())),re})()]}}),null),l(k,B(Nt,{get title(){return t("banking.unreconciled","Unreconciled")},get subtitle(){return t("banking.title")},get children(){return[(()=>{var re=Ss();return re.style.setProperty("font-size","1.5rem"),re.style.setProperty("font-weight","600"),re.style.setProperty("margin-bottom","0.5rem"),l(re,()=>z.unreconciledEntries),we($=>($=z.unreconciledEntries>0?"#ff9800":"#4caf50")!=null?re.style.setProperty("color",$):re.style.removeProperty("color")),re})(),(()=>{var re=Ss();return re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),l(re,(()=>{var $=Te(()=>z.unreconciledEntries>0);return()=>$()?t("entryBooks.needBankReconciliation","Need bank reconciliation"):t("entryBooks.allReconciled","All reconciled")})()),re})()]}}),null),k})(),(()=>{var k=HN(),re=k.firstChild,$=re.firstChild,D=re.nextSibling,H=D.firstChild,L=D.nextSibling,j=L.firstChild,oe=L.nextSibling,K=oe.firstChild,Z=K.nextSibling,J=oe.nextSibling,Y=J.firstChild,U=Y.nextSibling,ae=J.nextSibling,ue=ae.firstChild,le=ae.nextSibling;return m(k,ee),re.style.setProperty("min-width","150px"),$.style.setProperty("display","block"),$.style.setProperty("margin-bottom","0.5rem"),$.style.setProperty("font-weight","500"),$.style.setProperty("font-size","0.875rem"),l($,()=>t("common.status")),l(re,B(ci,{label:"",get value(){return u()},onChange:h,get options(){return T()}}),null),D.style.setProperty("min-width","200px"),H.style.setProperty("display","block"),H.style.setProperty("margin-bottom","0.5rem"),H.style.setProperty("font-weight","500"),H.style.setProperty("font-size","0.875rem"),l(H,()=>t("journal.account")),l(D,B(ci,{label:"",get value(){return y()},onChange:g,get options(){return R()}}),null),L.style.setProperty("min-width","120px"),j.style.setProperty("display","block"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("font-weight","500"),j.style.setProperty("font-size","0.875rem"),l(j,()=>t("entryBooks.sortBy","Sort By")),l(L,B(ci,{label:"",get value(){return x()},onChange:V,get options(){return _()}}),null),oe.style.setProperty("min-width","130px"),K.style.setProperty("display","block"),K.style.setProperty("margin-bottom","0.5rem"),K.style.setProperty("font-weight","500"),K.style.setProperty("font-size","0.875rem"),l(K,()=>t("entryBooks.fromDate","From Date")),Z.addEventListener("change",q=>C(q.target.value)),Z.style.setProperty("padding","0.75rem"),Z.style.setProperty("border","1px solid var(--border-color)"),Z.style.setProperty("border-radius","var(--border-radius-sm)"),Z.style.setProperty("font-family","inherit"),Z.style.setProperty("width","100%"),J.style.setProperty("min-width","130px"),Y.style.setProperty("display","block"),Y.style.setProperty("margin-bottom","0.5rem"),Y.style.setProperty("font-weight","500"),Y.style.setProperty("font-size","0.875rem"),l(Y,()=>t("entryBooks.toDate","To Date")),U.addEventListener("change",q=>w(q.target.value)),U.style.setProperty("padding","0.75rem"),U.style.setProperty("border","1px solid var(--border-color)"),U.style.setProperty("border-radius","var(--border-radius-sm)"),U.style.setProperty("font-family","inherit"),U.style.setProperty("width","100%"),ae.style.setProperty("min-width","100px"),ue.style.setProperty("display","block"),ue.style.setProperty("margin-bottom","0.5rem"),ue.style.setProperty("font-weight","500"),ue.style.setProperty("font-size","0.875rem"),l(ue,()=>t("entryBooks.order","Order")),l(ae,B(ci,{label:"",get value(){return ne()},onChange:X,get options(){return[{value:"desc",label:t("entryBooks.newest","Newest")},{value:"asc",label:t("entryBooks.oldest","Oldest")}]}}),null),le.style.setProperty("display","flex"),le.style.setProperty("align-items","end"),le.style.setProperty("gap","0.5rem"),l(le,B(xt,{variant:"outline",size:"sm",onClick:()=>{h("all"),g("all"),C(""),w(""),V("date"),X("desc")},get children(){return t("entryBooks.resetFilters","Reset Filters")}})),we(()=>Z.value=p()),we(()=>U.value=S()),k})(),Te(()=>Te(()=>!!(u()!=="all"||y()!=="all"||p()||S()))()&&(()=>{var k=WN(),re=k.firstChild,$=re.firstChild,D=re.nextSibling,H=D.firstChild;return k.style.setProperty("display","flex"),k.style.setProperty("gap","0.5rem"),k.style.setProperty("align-items","center"),k.style.setProperty("margin-bottom","1rem"),k.style.setProperty("padding","0.75rem"),k.style.setProperty("background","var(--surface-color)"),k.style.setProperty("border-radius","var(--border-radius-sm)"),k.style.setProperty("border","1px solid var(--border-color)"),re.style.setProperty("font-size","0.875rem"),re.style.setProperty("font-weight","500"),l(re,()=>t("entryBooks.activeFilters","Active filters"),$),l(k,(()=>{var L=Te(()=>u()!=="all");return()=>L()&&(()=>{var j=qd(),oe=j.firstChild;return j.style.setProperty("padding","0.25rem 0.5rem"),j.style.setProperty("background","var(--primary-color)"),j.style.setProperty("color","white"),j.style.setProperty("border-radius","12px"),j.style.setProperty("font-size","0.75rem"),l(j,()=>t("common.status"),oe),l(j,u,null),j})()})(),D),l(k,(()=>{var L=Te(()=>y()!=="all");return()=>L()&&(()=>{var j=qd(),oe=j.firstChild;return j.style.setProperty("padding","0.25rem 0.5rem"),j.style.setProperty("background","var(--primary-color)"),j.style.setProperty("color","white"),j.style.setProperty("border-radius","12px"),j.style.setProperty("font-size","0.75rem"),l(j,()=>t("journal.account"),oe),l(j,()=>Er.getAccountById(y())?.name||t("common.unknown","Unknown"),null),j})()})(),D),l(k,(()=>{var L=Te(()=>!!p());return()=>L()&&(()=>{var j=qd(),oe=j.firstChild;return j.style.setProperty("padding","0.25rem 0.5rem"),j.style.setProperty("background","var(--primary-color)"),j.style.setProperty("color","white"),j.style.setProperty("border-radius","12px"),j.style.setProperty("font-size","0.75rem"),l(j,()=>t("entryBooks.from","From"),oe),l(j,p,null),j})()})(),D),l(k,(()=>{var L=Te(()=>!!S());return()=>L()&&(()=>{var j=qd(),oe=j.firstChild;return j.style.setProperty("padding","0.25rem 0.5rem"),j.style.setProperty("background","var(--primary-color)"),j.style.setProperty("color","white"),j.style.setProperty("border-radius","12px"),j.style.setProperty("font-size","0.75rem"),l(j,()=>t("entryBooks.to","To"),oe),l(j,S,null),j})()})(),D),D.style.setProperty("margin-left","auto"),D.style.setProperty("font-size","0.875rem"),D.style.setProperty("color","var(--text-muted)"),l(D,()=>O.length,H),l(D,()=>t("entryBooks.entriesFound","{count} entries found").replace("{count}",O.length.toString()),null),k})()),Te(()=>Te(()=>O.length===0)()?B(Nt,{get title(){return t("entryBooks.noJournalEntries","No Journal Entries")},get subtitle(){return t("entryBooks.startByCreating","Start by creating your first entry")},get children(){var k=GN(),re=k.firstChild;return k.style.setProperty("text-align","center"),k.style.setProperty("color","var(--text-muted)"),k.style.setProperty("padding","2rem"),l(k,()=>t("entryBooks.noEntriesMatch","No journal entries match your current filters."),re),l(k,B(xt,{variant:"primary",style:{"margin-top":"1rem"},onClick:ie,get children(){return t("entryBooks.createFirstEntry","Create First Entry")}}),null),k}}):(()=>{var k=Ss();return m(k,A),l(k,B(Ut,{each:O,children:re=>B(_N,{entry:re,onViewDetails:G})})),k})()),B(P5,{get isOpen(){return e()},onClose:F,get editEntry(){return n()}}),B(qN,{get isOpen(){return o()},onClose:()=>{s(!1),c(null)},get entryId(){return a()}})]}})};function sn(t){"@babel/helpers - typeof";return sn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sn(t)}var Si=Uint8Array,eo=Uint16Array,Dy=Int32Array,uf=new Si([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),df=new Si([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),um=new Si([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),x5=function(t,e){for(var r=new eo(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var i=new Dy(r[30]),n=1;n<30;++n)for(var o=r[n];o<r[n+1];++o)i[o]=o-r[n]<<5|n;return{b:r,r:i}},A5=x5(uf,2),C5=A5.b,dm=A5.r;C5[28]=258,dm[258]=28;var I5=x5(df,0),KN=I5.b,N0=I5.r,hm=new eo(32768);for(var bn=0;bn<32768;++bn){var fa=(bn&43690)>>1|(bn&21845)<<1;fa=(fa&52428)>>2|(fa&13107)<<2,fa=(fa&61680)>>4|(fa&3855)<<4,hm[bn]=((fa&65280)>>8|(fa&255)<<8)>>1}var is=function(t,e,r){for(var n=t.length,i=0,o=new eo(e);i<n;++i)t[i]&&++o[t[i]-1];var s=new eo(e);for(i=1;i<e;++i)s[i]=s[i-1]+o[i-1]<<1;var a;if(r){a=new eo(1<<e);var c=15-e;for(i=0;i<n;++i)if(t[i])for(var u=i<<4|t[i],h=e-t[i],y=s[t[i]-1]++<<h,g=y|(1<<h)-1;y<=g;++y)a[hm[y]>>c]=u}else for(a=new eo(n),i=0;i<n;++i)t[i]&&(a[i]=hm[s[t[i]-1]++]>>15-t[i]);return a},Ma=new Si(288);for(var bn=0;bn<144;++bn)Ma[bn]=8;for(var bn=144;bn<256;++bn)Ma[bn]=9;for(var bn=256;bn<280;++bn)Ma[bn]=7;for(var bn=280;bn<288;++bn)Ma[bn]=8;var Bu=new Si(32);for(var bn=0;bn<32;++bn)Bu[bn]=5;var JN=is(Ma,9,0),QN=is(Ma,9,1),XN=is(Bu,5,0),ZN=is(Bu,5,1),up=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},$o=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},dp=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},Ry=function(t){return(t+7)/8|0},$5=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new Si(t.subarray(e,r))},e7=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],To=function(t,e,r){var n=new Error(e||e7[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,To),!r)throw n;return n},t7=function(t,e,r,n){var i=t.length,o=0;if(!i||e.f&&!e.l)return r||new Si(0);var s=!r,a=s||e.i!=2,c=e.i;s&&(r=new Si(i*3));var u=function(Y){var U=r.length;if(Y>U){var ae=new Si(Math.max(U*2,Y));ae.set(r),r=ae}},h=e.f||0,y=e.p||0,g=e.b||0,p=e.l,C=e.d,S=e.m,w=e.n,x=i*8;do{if(!p){h=$o(t,y,1);var V=$o(t,y+1,3);if(y+=3,V)if(V==1)p=QN,C=ZN,S=9,w=5;else if(V==2){var ee=$o(t,y,31)+257,E=$o(t,y+10,15)+4,A=ee+$o(t,y+5,31)+1;y+=14;for(var T=new Si(A),R=new Si(19),_=0;_<E;++_)R[um[_]]=$o(t,y+_*3,7);y+=E*3;for(var I=up(R),b=(1<<I)-1,G=is(R,I,1),_=0;_<A;){var ie=G[$o(t,y,b)];y+=ie&15;var ne=ie>>4;if(ne<16)T[_++]=ne;else{var F=0,W=0;for(ne==16?(W=3+$o(t,y,3),y+=2,F=T[_-1]):ne==17?(W=3+$o(t,y,7),y+=3):ne==18&&(W=11+$o(t,y,127),y+=7);W--;)T[_++]=F}}var z=T.subarray(0,ee),O=T.subarray(ee);S=up(z),w=up(O),p=is(z,S,1),C=is(O,w,1)}else To(1);else{var ne=Ry(y)+4,X=t[ne-4]|t[ne-3]<<8,Q=ne+X;if(Q>i){c&&To(0);break}a&&u(g+X),r.set(t.subarray(ne,Q),g),e.b=g+=X,e.p=y=Q*8,e.f=h;continue}if(y>x){c&&To(0);break}}a&&u(g+131072);for(var k=(1<<S)-1,re=(1<<w)-1,$=y;;$=y){var F=p[dp(t,y)&k],D=F>>4;if(y+=F&15,y>x){c&&To(0);break}if(F||To(2),D<256)r[g++]=D;else if(D==256){$=y,p=null;break}else{var H=D-254;if(D>264){var _=D-257,L=uf[_];H=$o(t,y,(1<<L)-1)+C5[_],y+=L}var j=C[dp(t,y)&re],oe=j>>4;j||To(3),y+=j&15;var O=KN[oe];if(oe>3){var L=df[oe];O+=dp(t,y)&(1<<L)-1,y+=L}if(y>x){c&&To(0);break}a&&u(g+131072);var K=g+H;if(g<O){var Z=o-O,J=Math.min(O,K);for(Z+g<0&&To(3);g<J;++g)r[g]=n[Z+g]}for(;g<K;++g)r[g]=r[g-O]}}e.l=p,e.p=$,e.b=g,e.f=h,p&&(h=1,e.m=S,e.d=C,e.n=w)}while(!h);return g!=r.length&&s?$5(r,0,g):r.subarray(0,g)},Ps=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},Zc=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},hp=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var i=r.length,o=r.slice();if(!i)return{t:k5,l:0};if(i==1){var s=new Si(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(Q,ee){return Q.f-ee.f}),r.push({s:-1,f:25001});var a=r[0],c=r[1],u=0,h=1,y=2;for(r[0]={s:-1,f:a.f+c.f,l:a,r:c};h!=i-1;)a=r[r[u].f<r[y].f?u++:y++],c=r[u!=h&&r[u].f<r[y].f?u++:y++],r[h++]={s:-1,f:a.f+c.f,l:a,r:c};for(var g=o[0].s,n=1;n<i;++n)o[n].s>g&&(g=o[n].s);var p=new eo(g+1),C=fm(r[h-1],p,0);if(C>e){var n=0,S=0,w=C-e,x=1<<w;for(o.sort(function(ee,E){return p[E.s]-p[ee.s]||ee.f-E.f});n<i;++n){var V=o[n].s;if(p[V]>e)S+=x-(1<<C-p[V]),p[V]=e;else break}for(S>>=w;S>0;){var ne=o[n].s;p[ne]<e?S-=1<<e-p[ne]++-1:++n}for(;n>=0&&S;--n){var X=o[n].s;p[X]==e&&(--p[X],++S)}C=e}return{t:new Si(p),l:C}},fm=function(t,e,r){return t.s==-1?Math.max(fm(t.l,e,r+1),fm(t.r,e,r+1)):e[t.s]=r},L0=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new eo(++e),n=0,i=t[0],o=1,s=function(c){r[n++]=c},a=1;a<=e;++a)if(t[a]==i&&a!=e)++o;else{if(!i&&o>2){for(;o>138;o-=138)s(32754);o>2&&(s(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(s(i),--o;o>6;o-=6)s(8304);o>2&&(s(o-3<<5|8208),o=0)}for(;o--;)s(i);o=1,i=t[a]}return{c:r.subarray(0,n),n:e}},eu=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},E5=function(t,e,r){var n=r.length,i=Ry(e+2);t[i]=n&255,t[i+1]=n>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var o=0;o<n;++o)t[i+o+4]=r[o];return(i+4+n)*8},D0=function(t,e,r,n,i,o,s,a,c,u,h){Ps(e,h++,r),++i[256];for(var y=hp(i,15),g=y.t,p=y.l,C=hp(o,15),S=C.t,w=C.l,x=L0(g),V=x.c,ne=x.n,X=L0(S),Q=X.c,ee=X.n,E=new eo(19),A=0;A<V.length;++A)++E[V[A]&31];for(var A=0;A<Q.length;++A)++E[Q[A]&31];for(var T=hp(E,7),R=T.t,_=T.l,I=19;I>4&&!R[um[I-1]];--I);var b=u+5<<3,G=eu(i,Ma)+eu(o,Bu)+s,ie=eu(i,g)+eu(o,S)+s+14+3*I+eu(E,R)+2*E[16]+3*E[17]+7*E[18];if(c>=0&&b<=G&&b<=ie)return E5(e,h,t.subarray(c,c+u));var F,W,z,O;if(Ps(e,h,1+(ie<G)),h+=2,ie<G){F=is(g,p,0),W=g,z=is(S,w,0),O=S;var k=is(R,_,0);Ps(e,h,ne-257),Ps(e,h+5,ee-1),Ps(e,h+10,I-4),h+=14;for(var A=0;A<I;++A)Ps(e,h+3*A,R[um[A]]);h+=3*I;for(var re=[V,Q],$=0;$<2;++$)for(var D=re[$],A=0;A<D.length;++A){var H=D[A]&31;Ps(e,h,k[H]),h+=R[H],H>15&&(Ps(e,h,D[A]>>5&127),h+=D[A]>>12)}}else F=JN,W=Ma,z=XN,O=Bu;for(var A=0;A<a;++A){var L=n[A];if(L>255){var H=L>>18&31;Zc(e,h,F[H+257]),h+=W[H+257],H>7&&(Ps(e,h,L>>23&31),h+=uf[H]);var j=L&31;Zc(e,h,z[j]),h+=O[j],j>3&&(Zc(e,h,L>>5&8191),h+=df[j])}else Zc(e,h,F[L]),h+=W[L]}return Zc(e,h,F[256]),h+W[256]},r7=new Dy([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),k5=new Si(0),n7=function(t,e,r,n,i,o){var s=o.z||t.length,a=new Si(n+s+5*(1+Math.ceil(s/7e3))+i),c=a.subarray(n,a.length-i),u=o.l,h=(o.r||0)&7;if(e){h&&(c[0]=o.r>>3);for(var y=r7[e-1],g=y>>13,p=y&8191,C=(1<<r)-1,S=o.p||new eo(32768),w=o.h||new eo(C+1),x=Math.ceil(r/3),V=2*x,ne=function(ue){return(t[ue]^t[ue+1]<<x^t[ue+2]<<V)&C},X=new Dy(25e3),Q=new eo(288),ee=new eo(32),E=0,A=0,T=o.i||0,R=0,_=o.w||0,I=0;T+2<s;++T){var b=ne(T),G=T&32767,ie=w[b];if(S[G]=ie,w[b]=G,_<=T){var F=s-T;if((E>7e3||R>24576)&&(F>423||!u)){h=D0(t,c,0,X,Q,ee,A,R,I,T-I,h),R=E=A=0,I=T;for(var W=0;W<286;++W)Q[W]=0;for(var W=0;W<30;++W)ee[W]=0}var z=2,O=0,k=p,re=G-ie&32767;if(F>2&&b==ne(T-re))for(var $=Math.min(g,F)-1,D=Math.min(32767,T),H=Math.min(258,F);re<=D&&--k&&G!=ie;){if(t[T+z]==t[T+z-re]){for(var L=0;L<H&&t[T+L]==t[T+L-re];++L);if(L>z){if(z=L,O=re,L>$)break;for(var j=Math.min(re,L-2),oe=0,W=0;W<j;++W){var K=T-re+W&32767,Z=S[K],J=K-Z&32767;J>oe&&(oe=J,ie=K)}}}G=ie,ie=S[G],re+=G-ie&32767}if(O){X[R++]=268435456|dm[z]<<18|N0[O];var Y=dm[z]&31,U=N0[O]&31;A+=uf[Y]+df[U],++Q[257+Y],++ee[U],_=T+z,++E}else X[R++]=t[T],++Q[t[T]]}}for(T=Math.max(T,_);T<s;++T)X[R++]=t[T],++Q[t[T]];h=D0(t,c,u,X,Q,ee,A,R,I,T-I,h),u||(o.r=h&7|c[h/8|0]<<3,h-=7,o.h=w,o.p=S,o.i=T,o.w=_)}else{for(var T=o.w||0;T<s+u;T+=65535){var ae=T+65535;ae>=s&&(c[h/8|0]=u,ae=s),h=E5(c,h+1,t.subarray(T,ae))}o.i=s}return $5(a,0,n+Ry(h)+i)},T5=function(){var t=1,e=0;return{p:function(r){for(var n=t,i=e,o=r.length|0,s=0;s!=o;){for(var a=Math.min(s+2655,o);s<a;++s)i+=n+=r[s];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}t=n,e=i},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},i7=function(t,e,r,n,i){if(!i&&(i={l:1},e.dictionary)){var o=e.dictionary.subarray(-32768),s=new Si(o.length+t.length);s.set(o),s.set(t,o.length),t=s,i.w=o.length}return n7(t,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,i)},N5=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},o7=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var i=T5();i.p(e.dictionary),N5(t,2,i.d())}},s7=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&To(6,"invalid zlib data"),(t[1]>>5&1)==1&&To(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function pm(t,e){e||(e={});var r=T5();r.p(t);var n=i7(t,e,e.dictionary?6:2,4);return o7(n,e),N5(n,n.length-4,r.d()),n}function a7(t,e){return t7(t.subarray(s7(t),-4),{i:2},e,e)}var l7=typeof TextDecoder<"u"&&new TextDecoder,c7=0;try{l7.decode(k5,{stream:!0}),c7=1}catch{}var cr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function fp(){cr.console&&typeof cr.console.log=="function"&&cr.console.log.apply(cr.console,arguments)}var hn={log:fp,warn:function(t){cr.console&&(typeof cr.console.warn=="function"?cr.console.warn.apply(cr.console,arguments):fp.call(null,arguments))},error:function(t){cr.console&&(typeof cr.console.error=="function"?cr.console.error.apply(cr.console,arguments):fp(t))}};function pp(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){al(n.response,e,r)},n.onerror=function(){hn.error("could not download file")},n.send()}function R0(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function zd(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var gu,mm,al=cr.saveAs||((typeof window>"u"?"undefined":sn(window))!=="object"||window!==cr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=cr.URL||cr.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener",typeof t=="string"?(i.href=t,i.origin!==location.origin?R0(i.href)?pp(t,e,r):zd(i,i.target="_blank"):zd(i)):(i.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){zd(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(R0(t))pp(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){zd(n)})}else navigator.msSaveOrOpenBlob(function(i,o){return o===void 0?o={autoBom:!1}:sn(o)!=="object"&&(hn.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return pp(t,e,r);var i=t.type==="application/octet-stream",o=/constructor/i.test(cr.HTMLElement)||cr.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||i&&o)&&(typeof FileReader>"u"?"undefined":sn(FileReader))==="object"){var a=new FileReader;a.onloadend=function(){var h=a.result;h=s?h:h.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=h:location=h,n=null},a.readAsDataURL(t)}else{var c=cr.URL||cr.webkitURL,u=c.createObjectURL(t);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function L5(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,o=r[n].process,s=i.exec(t);s&&(e=o(s),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var a=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return a.length==1&&(a="0"+a),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+a+c+u}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function mp(t,e){var r=t[0],n=t[1],i=t[2],o=t[3];r=mi(r,n,i,o,e[0],7,-680876936),o=mi(o,r,n,i,e[1],12,-389564586),i=mi(i,o,r,n,e[2],17,606105819),n=mi(n,i,o,r,e[3],22,-1044525330),r=mi(r,n,i,o,e[4],7,-176418897),o=mi(o,r,n,i,e[5],12,1200080426),i=mi(i,o,r,n,e[6],17,-1473231341),n=mi(n,i,o,r,e[7],22,-45705983),r=mi(r,n,i,o,e[8],7,1770035416),o=mi(o,r,n,i,e[9],12,-1958414417),i=mi(i,o,r,n,e[10],17,-42063),n=mi(n,i,o,r,e[11],22,-1990404162),r=mi(r,n,i,o,e[12],7,1804603682),o=mi(o,r,n,i,e[13],12,-40341101),i=mi(i,o,r,n,e[14],17,-1502002290),r=yi(r,n=mi(n,i,o,r,e[15],22,1236535329),i,o,e[1],5,-165796510),o=yi(o,r,n,i,e[6],9,-1069501632),i=yi(i,o,r,n,e[11],14,643717713),n=yi(n,i,o,r,e[0],20,-373897302),r=yi(r,n,i,o,e[5],5,-701558691),o=yi(o,r,n,i,e[10],9,38016083),i=yi(i,o,r,n,e[15],14,-660478335),n=yi(n,i,o,r,e[4],20,-405537848),r=yi(r,n,i,o,e[9],5,568446438),o=yi(o,r,n,i,e[14],9,-1019803690),i=yi(i,o,r,n,e[3],14,-187363961),n=yi(n,i,o,r,e[8],20,1163531501),r=yi(r,n,i,o,e[13],5,-1444681467),o=yi(o,r,n,i,e[2],9,-51403784),i=yi(i,o,r,n,e[7],14,1735328473),r=gi(r,n=yi(n,i,o,r,e[12],20,-1926607734),i,o,e[5],4,-378558),o=gi(o,r,n,i,e[8],11,-2022574463),i=gi(i,o,r,n,e[11],16,1839030562),n=gi(n,i,o,r,e[14],23,-35309556),r=gi(r,n,i,o,e[1],4,-1530992060),o=gi(o,r,n,i,e[4],11,1272893353),i=gi(i,o,r,n,e[7],16,-155497632),n=gi(n,i,o,r,e[10],23,-1094730640),r=gi(r,n,i,o,e[13],4,681279174),o=gi(o,r,n,i,e[0],11,-358537222),i=gi(i,o,r,n,e[3],16,-722521979),n=gi(n,i,o,r,e[6],23,76029189),r=gi(r,n,i,o,e[9],4,-640364487),o=gi(o,r,n,i,e[12],11,-421815835),i=gi(i,o,r,n,e[15],16,530742520),r=vi(r,n=gi(n,i,o,r,e[2],23,-995338651),i,o,e[0],6,-198630844),o=vi(o,r,n,i,e[7],10,1126891415),i=vi(i,o,r,n,e[14],15,-1416354905),n=vi(n,i,o,r,e[5],21,-57434055),r=vi(r,n,i,o,e[12],6,1700485571),o=vi(o,r,n,i,e[3],10,-1894986606),i=vi(i,o,r,n,e[10],15,-1051523),n=vi(n,i,o,r,e[1],21,-2054922799),r=vi(r,n,i,o,e[8],6,1873313359),o=vi(o,r,n,i,e[15],10,-30611744),i=vi(i,o,r,n,e[6],15,-1560198380),n=vi(n,i,o,r,e[13],21,1309151649),r=vi(r,n,i,o,e[4],6,-145523070),o=vi(o,r,n,i,e[11],10,-1120210379),i=vi(i,o,r,n,e[2],15,718787259),n=vi(n,i,o,r,e[9],21,-343485551),t[0]=wa(r,t[0]),t[1]=wa(n,t[1]),t[2]=wa(i,t[2]),t[3]=wa(o,t[3])}function hf(t,e,r,n,i,o){return e=wa(wa(e,t),wa(n,o)),wa(e<<i|e>>>32-i,r)}function mi(t,e,r,n,i,o,s){return hf(e&r|~e&n,t,e,i,o,s)}function yi(t,e,r,n,i,o,s){return hf(e&n|r&~n,t,e,i,o,s)}function gi(t,e,r,n,i,o,s){return hf(e^r^n,t,e,i,o,s)}function vi(t,e,r,n,i,o,s){return hf(r^(e|~n),t,e,i,o,s)}function D5(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)mp(n,u7(t.substring(e-64,e)));t=t.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(mp(n,i),e=0;e<16;e++)i[e]=0;return i[14]=8*r,mp(n,i),n}function u7(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}gu=cr.atob.bind(cr),mm=cr.btoa.bind(cr);var M0="0123456789abcdef".split("");function d7(t){for(var e="",r=0;r<4;r++)e+=M0[t>>8*r+4&15]+M0[t>>8*r&15];return e}function h7(t){return String.fromCharCode((255&t)>>0,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function ym(t){return D5(t).map(h7).join("")}var f7=function(t){for(var e=0;e<t.length;e++)t[e]=d7(t[e]);return t.join("")}(D5("hello"))!="5d41402abc4b2a76b9719d911017c592";function wa(t,e){if(f7){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function gm(t,e){var r,n,i,o;if(t!==r){for(var s=(i=t,o=1+(256/t.length>>0),new Array(o+1).join(i)),a=[],c=0;c<256;c++)a[c]=c;var u=0;for(c=0;c<256;c++){var h=a[c];u=(u+h+s.charCodeAt(c))%256,a[c]=a[u],a[u]=h}r=t,n=a}else a=n;var y=e.length,g=0,p=0,C="";for(c=0;c<y;c++)p=(p+(h=a[g=(g+1)%256]))%256,a[g]=a[p],a[p]=h,s=a[(a[g]+a[p])%256],C+=String.fromCharCode(e.charCodeAt(c)^s);return C}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var F0={print:4,modify:8,copy:16,"annot-forms":32};function sc(t,e,r,n){this.v=1,this.r=2;var i=192;t.forEach(function(a){if(F0.perm!==void 0)throw new Error("Invalid permission: "+a);i+=F0[a]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var o=(e+this.padding).substr(0,32),s=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(o,s),this.P=-(1+(255^i)),this.encryptionKey=ym(o+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=gm(this.encryptionKey,this.padding)}function ac(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var i=t.charCodeAt(n);i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?e+="#"+("0"+i.toString(16)).slice(-2):e+=t[n]}return e}function O0(t){if(sn(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var o=Math.random().toString(35);return e[r][o]=[n,!!i],o},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var o in e[r]){var s=e[r][o];try{s[0].apply(t,n)}catch(a){cr.console&&hn.error("jsPDF PubSub Error",a.message,a)}s[1]&&i.push(o)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function ju(t){if(!(this instanceof ju))return new ju(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function R5(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function ba(t,e,r,n,i){if(!(this instanceof ba))return new ba(t,e,r,n,i);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,R5.call(this,n,i)}function ml(t,e,r,n,i){if(!(this instanceof ml))return new ml(t,e,r,n,i);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,R5.call(this,n,i)}function or(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],o=arguments[3],s=[],a=1,c=16,u="S",h=null;sn(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,i=t.format||i,o=t.compress||t.compressPdf||o,(h=t.encryption||null)!==null&&(h.userPassword=h.userPassword||"",h.ownerPassword=h.ownerPassword||"",h.userPermissions=h.userPermissions||[]),a=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),u=t.defaultPathOperation||"S"),s=t.filters||(o===!0?["FlateEncode"]:s),n=n||"mm",r=(""+(r||"P")).toLowerCase();var y=t.putOnlyUsedFonts||!1,g={},p={internal:{},__private__:{}};p.__private__.PubSub=O0;var C="1.3",S=p.__private__.getPdfVersion=function(){return C};p.__private__.setPdfVersion=function(P){C=P};var w={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};p.__private__.getPageFormats=function(){return w};var x=p.__private__.getPageFormat=function(P){return w[P]};i=i||"a4";var V={COMPAT:"compat",ADVANCED:"advanced"},ne=V.COMPAT;function X(){this.saveGraphicsState(),q(new ht(Me,0,0,-Me,0,fi()*Me).toString()+" cm"),this.setFontSize(this.getFontSize()/Me),u="n",ne=V.ADVANCED}function Q(){this.restoreGraphicsState(),u="S",ne=V.COMPAT}var ee=p.__private__.combineFontStyleAndFontWeight=function(P,fe){if(P=="bold"&&fe=="normal"||P=="bold"&&fe==400||P=="normal"&&fe=="italic"||P=="bold"&&fe=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return fe&&(P=fe==400||fe==="normal"?P==="italic"?"italic":"normal":fe!=700&&fe!=="bold"||P!=="normal"?(fe==700?"bold":fe)+""+P:"bold"),P};p.advancedAPI=function(P){var fe=ne===V.COMPAT;return fe&&X.call(this),typeof P!="function"||(P(this),fe&&Q.call(this)),this},p.compatAPI=function(P){var fe=ne===V.ADVANCED;return fe&&Q.call(this),typeof P!="function"||(P(this),fe&&X.call(this)),this},p.isAdvancedAPI=function(){return ne===V.ADVANCED};var E,A=function(P){if(ne!==V.ADVANCED)throw new Error(P+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},T=p.roundToPrecision=p.__private__.roundToPrecision=function(P,fe){var Ne=e||fe;if(isNaN(P)||isNaN(Ne))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return P.toFixed(Ne).replace(/0+$/,"")};E=p.hpf=p.__private__.hpf=typeof c=="number"?function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.hpf");return T(P,c)}:c==="smart"?function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.hpf");return T(P,P>-1&&P<1?16:5)}:function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.hpf");return T(P,16)};var R=p.f2=p.__private__.f2=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.f2");return T(P,2)},_=p.__private__.f3=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.f3");return T(P,3)},I=p.scale=p.__private__.scale=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.scale");return ne===V.COMPAT?P*Me:ne===V.ADVANCED?P:void 0},b=function(P){return ne===V.COMPAT?fi()-P:ne===V.ADVANCED?P:void 0},G=function(P){return I(b(P))};p.__private__.setPrecision=p.setPrecision=function(P){typeof parseInt(P,10)=="number"&&(e=parseInt(P,10))};var ie,F="00000000000000000000000000000000",W=p.__private__.getFileId=function(){return F},z=p.__private__.setFileId=function(P){return F=P!==void 0&&/^[a-fA-F0-9]{32}$/.test(P)?P.toUpperCase():F.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),h!==null&&(cn=new sc(h.userPermissions,h.userPassword,h.ownerPassword,F)),F};p.setFileId=function(P){return z(P),this},p.getFileId=function(){return W()};var O=p.__private__.convertDateToPDFDate=function(P){var fe=P.getTimezoneOffset(),Ne=fe<0?"+":"-",Fe=Math.floor(Math.abs(fe/60)),qe=Math.abs(fe%60),it=[Ne,H(Fe),"'",H(qe),"'"].join("");return["D:",P.getFullYear(),H(P.getMonth()+1),H(P.getDate()),H(P.getHours()),H(P.getMinutes()),H(P.getSeconds()),it].join("")},k=p.__private__.convertPDFDateToDate=function(P){var fe=parseInt(P.substr(2,4),10),Ne=parseInt(P.substr(6,2),10)-1,Fe=parseInt(P.substr(8,2),10),qe=parseInt(P.substr(10,2),10),it=parseInt(P.substr(12,2),10),Ct=parseInt(P.substr(14,2),10);return new Date(fe,Ne,Fe,qe,it,Ct,0)},re=p.__private__.setCreationDate=function(P){var fe;if(P===void 0&&(P=new Date),P instanceof Date)fe=O(P);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(P))throw new Error("Invalid argument passed to jsPDF.setCreationDate");fe=P}return ie=fe},$=p.__private__.getCreationDate=function(P){var fe=ie;return P==="jsDate"&&(fe=k(ie)),fe};p.setCreationDate=function(P){return re(P),this},p.getCreationDate=function(P){return $(P)};var D,H=p.__private__.padd2=function(P){return("0"+parseInt(P)).slice(-2)},L=p.__private__.padd2Hex=function(P){return("00"+(P=P.toString())).substr(P.length)},j=0,oe=[],K=[],Z=0,J=[],Y=[],U=!1,ae=K,ue=function(){j=0,Z=0,K=[],oe=[],J=[],Jt=mt(),Zt=mt()};p.__private__.setCustomOutputDestination=function(P){U=!0,ae=P};var le=function(P){U||(ae=P)};p.__private__.resetCustomOutputDestination=function(){U=!1,ae=K};var q=p.__private__.out=function(P){return P=P.toString(),Z+=P.length+1,ae.push(P),ae},ce=p.__private__.write=function(P){return q(arguments.length===1?P.toString():Array.prototype.join.call(arguments," "))},Se=p.__private__.getArrayBuffer=function(P){for(var fe=P.length,Ne=new ArrayBuffer(fe),Fe=new Uint8Array(Ne);fe--;)Fe[fe]=P.charCodeAt(fe);return Ne},me=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];p.__private__.getStandardFonts=function(){return me};var Pe=t.fontSize||16;p.__private__.setFontSize=p.setFontSize=function(P){return Pe=ne===V.ADVANCED?P/Me:P,this};var xe,he=p.__private__.getFontSize=p.getFontSize=function(){return ne===V.COMPAT?Pe:Pe*Me},ve=t.R2L||!1;p.__private__.setR2L=p.setR2L=function(P){return ve=P,this},p.__private__.getR2L=p.getR2L=function(){return ve};var De,ke=p.__private__.setZoomMode=function(P){var fe=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(P))xe=P;else if(isNaN(P)){if(fe.indexOf(P)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+P+'" is not recognized.');xe=P}else xe=parseInt(P,10)};p.__private__.getZoomMode=function(){return xe};var Ce,Le=p.__private__.setPageMode=function(P){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(P)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+P+'" is not recognized.');De=P};p.__private__.getPageMode=function(){return De};var Ie=p.__private__.setLayoutMode=function(P){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(P)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+P+'" is not recognized.');Ce=P};p.__private__.getLayoutMode=function(){return Ce},p.__private__.setDisplayMode=p.setDisplayMode=function(P,fe,Ne){return ke(P),Ie(fe),Le(Ne),this};var Re={title:"",subject:"",author:"",keywords:"",creator:""};p.__private__.getDocumentProperty=function(P){if(Object.keys(Re).indexOf(P)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Re[P]},p.__private__.getDocumentProperties=function(){return Re},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(P){for(var fe in Re)Re.hasOwnProperty(fe)&&P[fe]&&(Re[fe]=P[fe]);return this},p.__private__.setDocumentProperty=function(P,fe){if(Object.keys(Re).indexOf(P)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Re[P]=fe};var He,Me,Ze,Ye,ut,rt={},We={},ct=[],pt={},_t={},Et={},et={},Ue=null,ot=0,Xe=[],at=new O0(p),St=t.hotfixes||[],$t={},qt={},Gt=[],ht=function P(fe,Ne,Fe,qe,it,Ct){if(!(this instanceof P))return new P(fe,Ne,Fe,qe,it,Ct);isNaN(fe)&&(fe=1),isNaN(Ne)&&(Ne=0),isNaN(Fe)&&(Fe=0),isNaN(qe)&&(qe=1),isNaN(it)&&(it=0),isNaN(Ct)&&(Ct=0),this._matrix=[fe,Ne,Fe,qe,it,Ct]};Object.defineProperty(ht.prototype,"sx",{get:function(){return this._matrix[0]},set:function(P){this._matrix[0]=P}}),Object.defineProperty(ht.prototype,"shy",{get:function(){return this._matrix[1]},set:function(P){this._matrix[1]=P}}),Object.defineProperty(ht.prototype,"shx",{get:function(){return this._matrix[2]},set:function(P){this._matrix[2]=P}}),Object.defineProperty(ht.prototype,"sy",{get:function(){return this._matrix[3]},set:function(P){this._matrix[3]=P}}),Object.defineProperty(ht.prototype,"tx",{get:function(){return this._matrix[4]},set:function(P){this._matrix[4]=P}}),Object.defineProperty(ht.prototype,"ty",{get:function(){return this._matrix[5]},set:function(P){this._matrix[5]=P}}),Object.defineProperty(ht.prototype,"a",{get:function(){return this._matrix[0]},set:function(P){this._matrix[0]=P}}),Object.defineProperty(ht.prototype,"b",{get:function(){return this._matrix[1]},set:function(P){this._matrix[1]=P}}),Object.defineProperty(ht.prototype,"c",{get:function(){return this._matrix[2]},set:function(P){this._matrix[2]=P}}),Object.defineProperty(ht.prototype,"d",{get:function(){return this._matrix[3]},set:function(P){this._matrix[3]=P}}),Object.defineProperty(ht.prototype,"e",{get:function(){return this._matrix[4]},set:function(P){this._matrix[4]=P}}),Object.defineProperty(ht.prototype,"f",{get:function(){return this._matrix[5]},set:function(P){this._matrix[5]=P}}),Object.defineProperty(ht.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(ht.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(ht.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(ht.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),ht.prototype.join=function(P){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(E).join(P)},ht.prototype.multiply=function(P){var fe=P.sx*this.sx+P.shy*this.shx,Ne=P.sx*this.shy+P.shy*this.sy,Fe=P.shx*this.sx+P.sy*this.shx,qe=P.shx*this.shy+P.sy*this.sy,it=P.tx*this.sx+P.ty*this.shx+this.tx,Ct=P.tx*this.shy+P.ty*this.sy+this.ty;return new ht(fe,Ne,Fe,qe,it,Ct)},ht.prototype.decompose=function(){var P=this.sx,fe=this.shy,Ne=this.shx,Fe=this.sy,qe=this.tx,it=this.ty,Ct=Math.sqrt(P*P+fe*fe),Dt=(P/=Ct)*Ne+(fe/=Ct)*Fe;Ne-=P*Dt,Fe-=fe*Dt;var f=Math.sqrt(Ne*Ne+Fe*Fe);return Dt/=f,P*(Fe/=f)<fe*(Ne/=f)&&(P=-P,fe=-fe,Dt=-Dt,Ct=-Ct),{scale:new ht(Ct,0,0,f,0,0),translate:new ht(1,0,0,1,qe,it),rotate:new ht(P,fe,-fe,P,0,0),skew:new ht(1,0,Dt,1,0,0)}},ht.prototype.toString=function(P){return this.join(" ")},ht.prototype.inversed=function(){var P=this.sx,fe=this.shy,Ne=this.shx,Fe=this.sy,qe=this.tx,it=this.ty,Ct=1/(P*Fe-fe*Ne),Dt=Fe*Ct,f=-fe*Ct,M=-Ne*Ct,se=P*Ct;return new ht(Dt,f,M,se,-Dt*qe-M*it,-f*qe-se*it)},ht.prototype.applyToPoint=function(P){var fe=P.x*this.sx+P.y*this.shx+this.tx,Ne=P.x*this.shy+P.y*this.sy+this.ty;return new hs(fe,Ne)},ht.prototype.applyToRectangle=function(P){var fe=this.applyToPoint(P),Ne=this.applyToPoint(new hs(P.x+P.w,P.y+P.h));return new Ys(fe.x,fe.y,Ne.x-fe.x,Ne.y-fe.y)},ht.prototype.clone=function(){var P=this.sx,fe=this.shy,Ne=this.shx,Fe=this.sy,qe=this.tx,it=this.ty;return new ht(P,fe,Ne,Fe,qe,it)},p.Matrix=ht;var Kt=p.matrixMult=function(P,fe){return fe.multiply(P)},Rt=new ht(1,0,0,1,0,0);p.unitMatrix=p.identityMatrix=Rt;var Qt=function(P,fe){if(!_t[P]){var Ne=(fe instanceof ba?"Sh":"P")+(Object.keys(pt).length+1).toString(10);fe.id=Ne,_t[P]=Ne,pt[Ne]=fe,at.publish("addPattern",fe)}};p.ShadingPattern=ba,p.TilingPattern=ml,p.addShadingPattern=function(P,fe){return A("addShadingPattern()"),Qt(P,fe),this},p.beginTilingPattern=function(P){A("beginTilingPattern()"),Ks(P.boundingBox[0],P.boundingBox[1],P.boundingBox[2]-P.boundingBox[0],P.boundingBox[3]-P.boundingBox[1],P.matrix)},p.endTilingPattern=function(P,fe){A("endTilingPattern()"),fe.stream=Y[D].join(`
`),Qt(P,fe),at.publish("endTilingPattern",fe),Gt.pop().restore()};var sr=p.__private__.newObject=function(){var P=mt();return At(P,!0),P},mt=p.__private__.newObjectDeferred=function(){return j++,oe[j]=function(){return Z},j},At=function(P,fe){return fe=typeof fe=="boolean"&&fe,oe[P]=Z,fe&&q(P+" 0 obj"),P},Ot=p.__private__.newAdditionalObject=function(){var P={objId:mt(),content:""};return J.push(P),P},Jt=mt(),Zt=mt(),Ht=p.__private__.decodeColorString=function(P){var fe=P.split(" ");if(fe.length!==2||fe[1]!=="g"&&fe[1]!=="G")fe.length===5&&(fe[4]==="k"||fe[4]==="K")&&(fe=[(1-fe[0])*(1-fe[3]),(1-fe[1])*(1-fe[3]),(1-fe[2])*(1-fe[3]),"r"]);else{var Ne=parseFloat(fe[0]);fe=[Ne,Ne,Ne,"r"]}for(var Fe="#",qe=0;qe<3;qe++)Fe+=("0"+Math.floor(255*parseFloat(fe[qe])).toString(16)).slice(-2);return Fe},tt=p.__private__.encodeColorString=function(P){var fe;typeof P=="string"&&(P={ch1:P});var Ne=P.ch1,Fe=P.ch2,qe=P.ch3,it=P.ch4,Ct=P.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Ne=="string"&&Ne.charAt(0)!=="#"){var Dt=new L5(Ne);if(Dt.ok)Ne=Dt.toHex();else if(!/^\d*\.?\d*$/.test(Ne))throw new Error('Invalid color "'+Ne+'" passed to jsPDF.encodeColorString.')}if(typeof Ne=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Ne)&&(Ne="#"+Ne[1]+Ne[1]+Ne[2]+Ne[2]+Ne[3]+Ne[3]),typeof Ne=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Ne)){var f=parseInt(Ne.substr(1),16);Ne=f>>16&255,Fe=f>>8&255,qe=255&f}if(Fe===void 0||it===void 0&&Ne===Fe&&Fe===qe)if(typeof Ne=="string")fe=Ne+" "+Ct[0];else switch(P.precision){case 2:fe=R(Ne/255)+" "+Ct[0];break;case 3:default:fe=_(Ne/255)+" "+Ct[0]}else if(it===void 0||sn(it)==="object"){if(it&&!isNaN(it.a)&&it.a===0)return fe=["1.","1.","1.",Ct[1]].join(" ");if(typeof Ne=="string")fe=[Ne,Fe,qe,Ct[1]].join(" ");else switch(P.precision){case 2:fe=[R(Ne/255),R(Fe/255),R(qe/255),Ct[1]].join(" ");break;default:case 3:fe=[_(Ne/255),_(Fe/255),_(qe/255),Ct[1]].join(" ")}}else if(typeof Ne=="string")fe=[Ne,Fe,qe,it,Ct[2]].join(" ");else switch(P.precision){case 2:fe=[R(Ne),R(Fe),R(qe),R(it),Ct[2]].join(" ");break;case 3:default:fe=[_(Ne),_(Fe),_(qe),_(it),Ct[2]].join(" ")}return fe},jt=p.__private__.getFilters=function(){return s},yt=p.__private__.putStream=function(P){var fe=(P=P||{}).data||"",Ne=P.filters||jt(),Fe=P.alreadyAppliedFilters||[],qe=P.addLength1||!1,it=fe.length,Ct=P.objectId,Dt=function(gr){return gr};if(h!==null&&Ct===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");h!==null&&(Dt=cn.encryptor(Ct,0));var f={};Ne===!0&&(Ne=["FlateEncode"]);var M=P.additionalKeyValues||[],se=(f=or.API.processDataByFilters!==void 0?or.API.processDataByFilters(fe,Ne):{data:fe,reverseChain:[]}).reverseChain+(Array.isArray(Fe)?Fe.join(" "):Fe.toString());if(f.data.length!==0&&(M.push({key:"Length",value:f.data.length}),qe===!0&&M.push({key:"Length1",value:it})),se.length!=0)if(se.split("/").length-1==1)M.push({key:"Filter",value:se});else{M.push({key:"Filter",value:"["+se+"]"});for(var be=0;be<M.length;be+=1)if(M[be].key==="DecodeParms"){for(var Ve=[],Qe=0;Qe<f.reverseChain.split("/").length-1;Qe+=1)Ve.push("null");Ve.push(M[be].value),M[be].value="["+Ve.join(" ")+"]"}}q("<<");for(var It=0;It<M.length;It++)q("/"+M[It].key+" "+M[It].value);q(">>"),f.data.length!==0&&(q("stream"),q(Dt(f.data)),q("endstream"))},ar=p.__private__.putPage=function(P){var fe=P.number,Ne=P.data,Fe=P.objId,qe=P.contentsObjId;At(Fe,!0),q("<</Type /Page"),q("/Parent "+P.rootDictionaryObjId+" 0 R"),q("/Resources "+P.resourceDictionaryObjId+" 0 R"),q("/MediaBox ["+parseFloat(E(P.mediaBox.bottomLeftX))+" "+parseFloat(E(P.mediaBox.bottomLeftY))+" "+E(P.mediaBox.topRightX)+" "+E(P.mediaBox.topRightY)+"]"),P.cropBox!==null&&q("/CropBox ["+E(P.cropBox.bottomLeftX)+" "+E(P.cropBox.bottomLeftY)+" "+E(P.cropBox.topRightX)+" "+E(P.cropBox.topRightY)+"]"),P.bleedBox!==null&&q("/BleedBox ["+E(P.bleedBox.bottomLeftX)+" "+E(P.bleedBox.bottomLeftY)+" "+E(P.bleedBox.topRightX)+" "+E(P.bleedBox.topRightY)+"]"),P.trimBox!==null&&q("/TrimBox ["+E(P.trimBox.bottomLeftX)+" "+E(P.trimBox.bottomLeftY)+" "+E(P.trimBox.topRightX)+" "+E(P.trimBox.topRightY)+"]"),P.artBox!==null&&q("/ArtBox ["+E(P.artBox.bottomLeftX)+" "+E(P.artBox.bottomLeftY)+" "+E(P.artBox.topRightX)+" "+E(P.artBox.topRightY)+"]"),typeof P.userUnit=="number"&&P.userUnit!==1&&q("/UserUnit "+P.userUnit),at.publish("putPage",{objId:Fe,pageContext:Xe[fe],pageNumber:fe,page:Ne}),q("/Contents "+qe+" 0 R"),q(">>"),q("endobj");var it=Ne.join(`
`);return ne===V.ADVANCED&&(it+=`
Q`),At(qe,!0),yt({data:it,filters:jt(),objectId:qe}),q("endobj"),Fe},Wr=p.__private__.putPages=function(){var P,fe,Ne=[];for(P=1;P<=ot;P++)Xe[P].objId=mt(),Xe[P].contentsObjId=mt();for(P=1;P<=ot;P++)Ne.push(ar({number:P,data:Y[P],objId:Xe[P].objId,contentsObjId:Xe[P].contentsObjId,mediaBox:Xe[P].mediaBox,cropBox:Xe[P].cropBox,bleedBox:Xe[P].bleedBox,trimBox:Xe[P].trimBox,artBox:Xe[P].artBox,userUnit:Xe[P].userUnit,rootDictionaryObjId:Jt,resourceDictionaryObjId:Zt}));At(Jt,!0),q("<</Type /Pages");var Fe="/Kids [";for(fe=0;fe<ot;fe++)Fe+=Ne[fe]+" 0 R ";q(Fe+"]"),q("/Count "+ot),q(">>"),q("endobj"),at.publish("postPutPages")},pr=function(P){at.publish("putFont",{font:P,out:q,newObject:sr,putStream:yt}),P.isAlreadyPutted!==!0&&(P.objectNumber=sr(),q("<<"),q("/Type /Font"),q("/BaseFont /"+ac(P.postScriptName)),q("/Subtype /Type1"),typeof P.encoding=="string"&&q("/Encoding /"+P.encoding),q("/FirstChar 32"),q("/LastChar 255"),q(">>"),q("endobj"))},wr=function(){for(var P in rt)rt.hasOwnProperty(P)&&(y===!1||y===!0&&g.hasOwnProperty(P))&&pr(rt[P])},$r=function(P){P.objectNumber=sr();var fe=[];fe.push({key:"Type",value:"/XObject"}),fe.push({key:"Subtype",value:"/Form"}),fe.push({key:"BBox",value:"["+[E(P.x),E(P.y),E(P.x+P.width),E(P.y+P.height)].join(" ")+"]"}),fe.push({key:"Matrix",value:"["+P.matrix.toString()+"]"});var Ne=P.pages[1].join(`
`);yt({data:Ne,additionalKeyValues:fe,objectId:P.objectNumber}),q("endobj")},lr=function(){for(var P in $t)$t.hasOwnProperty(P)&&$r($t[P])},Br=function(P,fe){var Ne,Fe=[],qe=1/(fe-1);for(Ne=0;Ne<1;Ne+=qe)Fe.push(Ne);if(Fe.push(1),P[0].offset!=0){var it={offset:0,color:P[0].color};P.unshift(it)}if(P[P.length-1].offset!=1){var Ct={offset:1,color:P[P.length-1].color};P.push(Ct)}for(var Dt="",f=0,M=0;M<Fe.length;M++){for(Ne=Fe[M];Ne>P[f+1].offset;)f++;var se=P[f].offset,be=(Ne-se)/(P[f+1].offset-se),Ve=P[f].color,Qe=P[f+1].color;Dt+=L(Math.round((1-be)*Ve[0]+be*Qe[0]).toString(16))+L(Math.round((1-be)*Ve[1]+be*Qe[1]).toString(16))+L(Math.round((1-be)*Ve[2]+be*Qe[2]).toString(16))}return Dt.trim()},tn=function(P,fe){fe||(fe=21);var Ne=sr(),Fe=Br(P.colors,fe),qe=[];qe.push({key:"FunctionType",value:"0"}),qe.push({key:"Domain",value:"[0.0 1.0]"}),qe.push({key:"Size",value:"["+fe+"]"}),qe.push({key:"BitsPerSample",value:"8"}),qe.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),qe.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),yt({data:Fe,additionalKeyValues:qe,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Ne}),q("endobj"),P.objectNumber=sr(),q("<< /ShadingType "+P.type),q("/ColorSpace /DeviceRGB");var it="/Coords ["+E(parseFloat(P.coords[0]))+" "+E(parseFloat(P.coords[1]))+" ";P.type===2?it+=E(parseFloat(P.coords[2]))+" "+E(parseFloat(P.coords[3])):it+=E(parseFloat(P.coords[2]))+" "+E(parseFloat(P.coords[3]))+" "+E(parseFloat(P.coords[4]))+" "+E(parseFloat(P.coords[5])),q(it+="]"),P.matrix&&q("/Matrix ["+P.matrix.toString()+"]"),q("/Function "+Ne+" 0 R"),q("/Extend [true true]"),q(">>"),q("endobj")},kt=function(P,fe){var Ne=mt(),Fe=sr();fe.push({resourcesOid:Ne,objectOid:Fe}),P.objectNumber=Fe;var qe=[];qe.push({key:"Type",value:"/Pattern"}),qe.push({key:"PatternType",value:"1"}),qe.push({key:"PaintType",value:"1"}),qe.push({key:"TilingType",value:"1"}),qe.push({key:"BBox",value:"["+P.boundingBox.map(E).join(" ")+"]"}),qe.push({key:"XStep",value:E(P.xStep)}),qe.push({key:"YStep",value:E(P.yStep)}),qe.push({key:"Resources",value:Ne+" 0 R"}),P.matrix&&qe.push({key:"Matrix",value:"["+P.matrix.toString()+"]"}),yt({data:P.stream,additionalKeyValues:qe,objectId:P.objectNumber}),q("endobj")},Sr=function(P){var fe;for(fe in pt)pt.hasOwnProperty(fe)&&(pt[fe]instanceof ba?tn(pt[fe]):pt[fe]instanceof ml&&kt(pt[fe],P))},Cr=function(P){for(var fe in P.objectNumber=sr(),q("<<"),P)switch(fe){case"opacity":q("/ca "+R(P[fe]));break;case"stroke-opacity":q("/CA "+R(P[fe]))}q(">>"),q("endobj")},jr=function(){var P;for(P in Et)Et.hasOwnProperty(P)&&Cr(Et[P])},kr=function(){for(var P in q("/XObject <<"),$t)$t.hasOwnProperty(P)&&$t[P].objectNumber>=0&&q("/"+P+" "+$t[P].objectNumber+" 0 R");at.publish("putXobjectDict"),q(">>")},Yr=function(){cn.oid=sr(),q("<<"),q("/Filter /Standard"),q("/V "+cn.v),q("/R "+cn.r),q("/U <"+cn.toHexString(cn.U)+">"),q("/O <"+cn.toHexString(cn.O)+">"),q("/P "+cn.P),q(">>"),q("endobj")},rn=function(){for(var P in q("/Font <<"),rt)rt.hasOwnProperty(P)&&(y===!1||y===!0&&g.hasOwnProperty(P))&&q("/"+P+" "+rt[P].objectNumber+" 0 R");q(">>")},yr=function(){if(Object.keys(pt).length>0){for(var P in q("/Shading <<"),pt)pt.hasOwnProperty(P)&&pt[P]instanceof ba&&pt[P].objectNumber>=0&&q("/"+P+" "+pt[P].objectNumber+" 0 R");at.publish("putShadingPatternDict"),q(">>")}},ln=function(P){if(Object.keys(pt).length>0){for(var fe in q("/Pattern <<"),pt)pt.hasOwnProperty(fe)&&pt[fe]instanceof p.TilingPattern&&pt[fe].objectNumber>=0&&pt[fe].objectNumber<P&&q("/"+fe+" "+pt[fe].objectNumber+" 0 R");at.publish("putTilingPatternDict"),q(">>")}},_n=function(){if(Object.keys(Et).length>0){var P;for(P in q("/ExtGState <<"),Et)Et.hasOwnProperty(P)&&Et[P].objectNumber>=0&&q("/"+P+" "+Et[P].objectNumber+" 0 R");at.publish("putGStateDict"),q(">>")}},Ir=function(P){At(P.resourcesOid,!0),q("<<"),q("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),rn(),yr(),ln(P.objectOid),_n(),kr(),q(">>"),q("endobj")},wn=function(){var P=[];wr(),jr(),lr(),Sr(P),at.publish("putResources"),P.forEach(Ir),Ir({resourcesOid:Zt,objectOid:Number.MAX_SAFE_INTEGER}),at.publish("postPutResources")},Cn=function(){at.publish("putAdditionalObjects");for(var P=0;P<J.length;P++){var fe=J[P];At(fe.objId,!0),q(fe.content),q("endobj")}at.publish("postPutAdditionalObjects")},Li=function(P){We[P.fontName]=We[P.fontName]||{},We[P.fontName][P.fontStyle]=P.id},tr=function(P,fe,Ne,Fe,qe){var it={id:"F"+(Object.keys(rt).length+1).toString(10),postScriptName:P,fontName:fe,fontStyle:Ne,encoding:Fe,isStandardFont:qe||!1,metadata:{}};return at.publish("addFont",{font:it,instance:this}),rt[it.id]=it,Li(it),it.id},Tr=function(P){for(var fe=0,Ne=me.length;fe<Ne;fe++){var Fe=tr.call(this,P[fe][0],P[fe][1],P[fe][2],me[fe][3],!0);y===!1&&(g[Fe]=!0);var qe=P[fe][0].split("-");Li({id:Fe,fontName:qe[0],fontStyle:qe[1]||""})}at.publish("addFonts",{fonts:rt,dictionary:We})},qr=function(P){return P.foo=function(){try{return P.apply(this,arguments)}catch(Fe){var fe=Fe.stack||"";~fe.indexOf(" at ")&&(fe=fe.split(" at ")[1]);var Ne="Error in function "+fe.split(`
`)[0].split("<")[0]+": "+Fe.message;if(!cr.console)throw new Error(Ne);cr.console.error(Ne,Fe),cr.alert&&alert(Ne)}},P.foo.bar=P,P.foo},bt=function(P,fe){var Ne,Fe,qe,it,Ct,Dt,f,M,se;if(qe=(fe=fe||{}).sourceEncoding||"Unicode",Ct=fe.outputEncoding,(fe.autoencode||Ct)&&rt[He].metadata&&rt[He].metadata[qe]&&rt[He].metadata[qe].encoding&&(it=rt[He].metadata[qe].encoding,!Ct&&rt[He].encoding&&(Ct=rt[He].encoding),!Ct&&it.codePages&&(Ct=it.codePages[0]),typeof Ct=="string"&&(Ct=it[Ct]),Ct)){for(f=!1,Dt=[],Ne=0,Fe=P.length;Ne<Fe;Ne++)(M=Ct[P.charCodeAt(Ne)])?Dt.push(String.fromCharCode(M)):Dt.push(P[Ne]),Dt[Ne].charCodeAt(0)>>8&&(f=!0);P=Dt.join("")}for(Ne=P.length;f===void 0&&Ne!==0;)P.charCodeAt(Ne-1)>>8&&(f=!0),Ne--;if(!f)return P;for(Dt=fe.noBOM?[]:[254,255],Ne=0,Fe=P.length;Ne<Fe;Ne++){if((se=(M=P.charCodeAt(Ne))>>8)>>8)throw new Error("Character at position "+Ne+" of string '"+P+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Dt.push(se),Dt.push(M-(se<<8))}return String.fromCharCode.apply(void 0,Dt)},rr=p.__private__.pdfEscape=p.pdfEscape=function(P,fe){return bt(P,fe).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},fr=p.__private__.beginPage=function(P){Y[++ot]=[],Xe[ot]={objId:0,contentsObjId:0,userUnit:Number(a),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(P[0]),topRightY:Number(P[1])}},pn(ot),le(Y[D])},Gr=function(P,fe){var Ne,Fe,qe;switch(r=fe||r,typeof P=="string"&&(Ne=x(P.toLowerCase()),Array.isArray(Ne)&&(Fe=Ne[0],qe=Ne[1])),Array.isArray(P)&&(Fe=P[0]*Me,qe=P[1]*Me),isNaN(Fe)&&(Fe=i[0],qe=i[1]),(Fe>14400||qe>14400)&&(hn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Fe=Math.min(14400,Fe),qe=Math.min(14400,qe)),i=[Fe,qe],r.substr(0,1)){case"l":qe>Fe&&(i=[qe,Fe]);break;case"p":Fe>qe&&(i=[qe,Fe])}fr(i),Ha(Ua),q(ri),Ya!==0&&q(Ya+" J"),Gs!==0&&q(Gs+" j"),at.publish("addPage",{pageNumber:ot})},Fr=function(P){P>0&&P<=ot&&(Y.splice(P,1),Xe.splice(P,1),ot--,D>ot&&(D=ot),this.setPage(D))},pn=function(P){P>0&&P<=ot&&(D=P)},Pr=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return Y.length-1},Yn=function(P,fe,Ne){var Fe,qe=void 0;return Ne=Ne||{},P=P!==void 0?P:rt[He].fontName,fe=fe!==void 0?fe:rt[He].fontStyle,Fe=P.toLowerCase(),We[Fe]!==void 0&&We[Fe][fe]!==void 0?qe=We[Fe][fe]:We[P]!==void 0&&We[P][fe]!==void 0?qe=We[P][fe]:Ne.disableWarning===!1&&hn.warn("Unable to look up font label for font '"+P+"', '"+fe+"'. Refer to getFontList() for available fonts."),qe||Ne.noFallback||(qe=We.times[fe])==null&&(qe=We.times.normal),qe},Pn=p.__private__.putInfo=function(){var P=sr(),fe=function(Fe){return Fe};for(var Ne in h!==null&&(fe=cn.encryptor(P,0)),q("<<"),q("/Producer ("+rr(fe("jsPDF "+or.version))+")"),Re)Re.hasOwnProperty(Ne)&&Re[Ne]&&q("/"+Ne.substr(0,1).toUpperCase()+Ne.substr(1)+" ("+rr(fe(Re[Ne]))+")");q("/CreationDate ("+rr(fe(ie))+")"),q(">>"),q("endobj")},Zn=p.__private__.putCatalog=function(P){var fe=(P=P||{}).rootDictionaryObjId||Jt;switch(sr(),q("<<"),q("/Type /Catalog"),q("/Pages "+fe+" 0 R"),xe||(xe="fullwidth"),xe){case"fullwidth":q("/OpenAction [3 0 R /FitH null]");break;case"fullheight":q("/OpenAction [3 0 R /FitV null]");break;case"fullpage":q("/OpenAction [3 0 R /Fit]");break;case"original":q("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Ne=""+xe;Ne.substr(Ne.length-1)==="%"&&(xe=parseInt(xe)/100),typeof xe=="number"&&q("/OpenAction [3 0 R /XYZ null null "+R(xe)+"]")}switch(Ce||(Ce="continuous"),Ce){case"continuous":q("/PageLayout /OneColumn");break;case"single":q("/PageLayout /SinglePage");break;case"two":case"twoleft":q("/PageLayout /TwoColumnLeft");break;case"tworight":q("/PageLayout /TwoColumnRight")}De&&q("/PageMode /"+De),at.publish("putCatalog"),q(">>"),q("endobj")},Wi=p.__private__.putTrailer=function(){q("trailer"),q("<<"),q("/Size "+(j+1)),q("/Root "+j+" 0 R"),q("/Info "+(j-1)+" 0 R"),h!==null&&q("/Encrypt "+cn.oid+" 0 R"),q("/ID [ <"+F+"> <"+F+"> ]"),q(">>")},hi=p.__private__.putHeader=function(){q("%PDF-"+C),q("%")},ei=p.__private__.putXRef=function(){var P="0000000000";q("xref"),q("0 "+(j+1)),q("0000000000 65535 f ");for(var fe=1;fe<=j;fe++)typeof oe[fe]=="function"?q((P+oe[fe]()).slice(-10)+" 00000 n "):oe[fe]!==void 0?q((P+oe[fe]).slice(-10)+" 00000 n "):q("0000000000 00000 n ")},In=p.__private__.buildDocument=function(){ue(),le(K),at.publish("buildDocument"),hi(),Wr(),Cn(),wn(),h!==null&&Yr(),Pn(),Zn();var P=Z;return ei(),Wi(),q("startxref"),q(""+P),q("%%EOF"),le(Y[D]),K.join(`
`)},ti=p.__private__.getBlob=function(P){return new Blob([Se(P)],{type:"application/pdf"})},Di=p.output=p.__private__.output=qr(function(P,fe){switch(typeof(fe=fe||{})=="string"?fe={filename:fe}:fe.filename=fe.filename||"generated.pdf",P){case void 0:return In();case"save":p.save(fe.filename);break;case"arraybuffer":return Se(In());case"blob":return ti(In());case"bloburi":case"bloburl":if(cr.URL!==void 0&&typeof cr.URL.createObjectURL=="function")return cr.URL&&cr.URL.createObjectURL(ti(In()))||void 0;hn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Ne="",Fe=In();try{Ne=mm(Fe)}catch{Ne=mm(unescape(encodeURIComponent(Fe)))}return"data:application/pdf;filename="+fe.filename+";base64,"+Ne;case"pdfobjectnewwindow":if(Object.prototype.toString.call(cr)==="[object Window]"){var qe="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",it=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';fe.pdfObjectUrl&&(qe=fe.pdfObjectUrl,it="");var Ct='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+qe+'"'+it+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(fe)+");<\/script></body></html>",Dt=cr.open();return Dt!==null&&Dt.document.write(Ct),Dt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(cr)==="[object Window]"){var f='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(fe.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+fe.filename+'" width="500px" height="400px" /></body></html>',M=cr.open();if(M!==null){M.document.write(f);var se=this;M.document.documentElement.querySelector("#pdfViewer").onload=function(){M.document.title=fe.filename,M.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(se.output("bloburl"))}}return M}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(cr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var be='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",fe)+'"></iframe></body></html>',Ve=cr.open();if(Ve!==null&&(Ve.document.write(be),Ve.document.title=fe.filename),Ve||typeof safari>"u")return Ve;break;case"datauri":case"dataurl":return cr.document.location.href=this.output("datauristring",fe);default:return null}}),no=function(P){return Array.isArray(St)===!0&&St.indexOf(P)>-1};switch(n){case"pt":Me=1;break;case"mm":Me=72/25.4;break;case"cm":Me=72/2.54;break;case"in":Me=72;break;case"px":Me=no("px_scaling")==1?.75:96/72;break;case"pc":case"em":Me=12;break;case"ex":Me=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Me=n}var cn=null;re(),z();var js=function(P){return h!==null?cn.encryptor(P,0):function(fe){return fe}},bo=p.__private__.getPageInfo=p.getPageInfo=function(P){if(isNaN(P)||P%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Xe[P].objId,pageNumber:P,pageContext:Xe[P]}},nr=p.__private__.getPageInfoByObjId=function(P){if(isNaN(P)||P%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var fe in Xe)if(Xe[fe].objId===P)break;return bo(fe)},io=p.__private__.getCurrentPageInfo=p.getCurrentPageInfo=function(){return{objId:Xe[D].objId,pageNumber:D,pageContext:Xe[D]}};p.addPage=function(){return Gr.apply(this,arguments),this},p.setPage=function(){return pn.apply(this,arguments),le.call(this,Y[D]),this},p.insertPage=function(P){return this.addPage(),this.movePage(D,P),this},p.movePage=function(P,fe){var Ne,Fe;if(P>fe){Ne=Y[P],Fe=Xe[P];for(var qe=P;qe>fe;qe--)Y[qe]=Y[qe-1],Xe[qe]=Xe[qe-1];Y[fe]=Ne,Xe[fe]=Fe,this.setPage(fe)}else if(P<fe){Ne=Y[P],Fe=Xe[P];for(var it=P;it<fe;it++)Y[it]=Y[it+1],Xe[it]=Xe[it+1];Y[fe]=Ne,Xe[fe]=Fe,this.setPage(fe)}return this},p.deletePage=function(){return Fr.apply(this,arguments),this},p.__private__.text=p.text=function(P,fe,Ne,Fe,qe){var it,Ct,Dt,f,M,se,be,Ve,Qe,It=(Fe=Fe||{}).scope||this;if(typeof P=="number"&&typeof fe=="number"&&(typeof Ne=="string"||Array.isArray(Ne))){var gr=Ne;Ne=fe,fe=P,P=gr}if(arguments[3]instanceof ht?(A("The transform parameter of text() with a Matrix value"),Qe=qe):(Dt=arguments[4],f=arguments[5],sn(be=arguments[3])==="object"&&be!==null||(typeof Dt=="string"&&(f=Dt,Dt=null),typeof be=="string"&&(f=be,be=null),typeof be=="number"&&(Dt=be,be=null),Fe={flags:be,angle:Dt,align:f})),isNaN(fe)||isNaN(Ne)||P==null)throw new Error("Invalid arguments passed to jsPDF.text");if(P.length===0)return It;var Nr="",vr=!1,Zr=typeof Fe.lineHeightFactor=="number"?Fe.lineHeightFactor:Xr,un=It.internal.scaleFactor;function xo(mn){return mn=mn.split("	").join(Array(Fe.TabLen||9).join(" ")),rr(mn,be)}function ni(mn){for(var yn,En=mn.concat(),Un=[],gs=En.length;gs--;)typeof(yn=En.shift())=="string"?Un.push(yn):Array.isArray(mn)&&(yn.length===1||yn[1]===void 0&&yn[2]===void 0)?Un.push(yn[0]):Un.push([yn[0],yn[1],yn[2]]);return Un}function zo(mn,yn){var En;if(typeof mn=="string")En=yn(mn)[0];else if(Array.isArray(mn)){for(var Un,gs,Bc=mn.concat(),zl=[],od=Bc.length;od--;)typeof(Un=Bc.shift())=="string"?zl.push(yn(Un)[0]):Array.isArray(Un)&&typeof Un[0]=="string"&&(gs=yn(Un[0],Un[1],Un[2]),zl.push([gs[0],gs[1],gs[2]]));En=zl}return En}var Uo=!1,Nc=!0;if(typeof P=="string")Uo=!0;else if(Array.isArray(P)){var Lc=P.concat();Ct=[];for(var Rl,ii=Lc.length;ii--;)(typeof(Rl=Lc.shift())!="string"||Array.isArray(Rl)&&typeof Rl[0]!="string")&&(Nc=!1);Uo=Nc}if(Uo===!1)throw new Error('Type of text must be string or Array. "'+P+'" is not recognized.');typeof P=="string"&&(P=P.match(/[\r?\n]/)?P.split(/\r\n|\r|\n/g):[P]);var Ml=Pe/It.internal.scaleFactor,Fl=Ml*(Zr-1);switch(Fe.baseline){case"bottom":Ne-=Fl;break;case"top":Ne+=Ml-Fl;break;case"hanging":Ne+=Ml-2*Fl;break;case"middle":Ne+=Ml/2-Fl}if((se=Fe.maxWidth||0)>0&&(typeof P=="string"?P=It.splitTextToSize(P,se):Object.prototype.toString.call(P)==="[object Array]"&&(P=P.reduce(function(mn,yn){return mn.concat(It.splitTextToSize(yn,se))},[]))),it={text:P,x:fe,y:Ne,options:Fe,mutex:{pdfEscape:rr,activeFontKey:He,fonts:rt,activeFontSize:Pe}},at.publish("preProcessText",it),P=it.text,Dt=(Fe=it.options).angle,!(Qe instanceof ht)&&Dt&&typeof Dt=="number"){Dt*=Math.PI/180,Fe.rotationDirection===0&&(Dt=-Dt),ne===V.ADVANCED&&(Dt=-Dt);var Ol=Math.cos(Dt),Dc=Math.sin(Dt);Qe=new ht(Ol,Dc,-Dc,Ol,0,0)}else Dt&&Dt instanceof ht&&(Qe=Dt);ne!==V.ADVANCED||Qe||(Qe=Rt),(M=Fe.charSpace||ds)!==void 0&&(Nr+=E(I(M))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Ve=Fe.horizontalScale)!==void 0&&(Nr+=E(100*Ve)+` Tz
`),Fe.lang;var Mi=-1,pf=Fe.renderingMode!==void 0?Fe.renderingMode:Fe.stroke,Rc=It.internal.getCurrentPageInfo().pageContext;switch(pf){case 0:case!1:case"fill":Mi=0;break;case 1:case!0:case"stroke":Mi=1;break;case 2:case"fillThenStroke":Mi=2;break;case 3:case"invisible":Mi=3;break;case 4:case"fillAndAddForClipping":Mi=4;break;case 5:case"strokeAndAddPathForClipping":Mi=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Mi=6;break;case 7:case"addToPathForClipping":Mi=7}var td=Rc.usedRenderingMode!==void 0?Rc.usedRenderingMode:-1;Mi!==-1?Nr+=Mi+` Tr
`:td!==-1&&(Nr+=`0 Tr
`),Mi!==-1&&(Rc.usedRenderingMode=Mi),f=Fe.align||"left";var oo,Bl=Pe*Zr,rd=It.internal.pageSize.getWidth(),nd=rt[He];M=Fe.charSpace||ds,se=Fe.maxWidth||0,be=Object.assign({autoencode:!0,noBOM:!0},Fe.flags);var Xs=[],Ka=function(mn){return It.getStringUnitWidth(mn,{font:nd,charSpace:M,fontSize:Pe,doKerning:!1})*Pe/un};if(Object.prototype.toString.call(P)==="[object Array]"){var Fi;Ct=ni(P),f!=="left"&&(oo=Ct.map(Ka));var $i,Zs=0;if(f==="right"){fe-=oo[0],P=[],ii=Ct.length;for(var ps=0;ps<ii;ps++)ps===0?($i=Yi(fe),Fi=zn(Ne)):($i=I(Zs-oo[ps]),Fi=-Bl),P.push([Ct[ps],$i,Fi]),Zs=oo[ps]}else if(f==="center"){fe-=oo[0]/2,P=[],ii=Ct.length;for(var ms=0;ms<ii;ms++)ms===0?($i=Yi(fe),Fi=zn(Ne)):($i=I((Zs-oo[ms])/2),Fi=-Bl),P.push([Ct[ms],$i,Fi]),Zs=oo[ms]}else if(f==="left"){P=[],ii=Ct.length;for(var jl=0;jl<ii;jl++)P.push(Ct[jl])}else if(f==="justify"&&nd.encoding==="Identity-H"){P=[],ii=Ct.length,se=se!==0?se:rd;for(var ys=0,$n=0;$n<ii;$n++)if(Fi=$n===0?zn(Ne):-Bl,$i=$n===0?Yi(fe):ys,$n<ii-1){var Mc=I((se-oo[$n])/(Ct[$n].split(" ").length-1)),Ei=Ct[$n].split(" ");P.push([Ei[0]+" ",$i,Fi]),ys=0;for(var so=1;so<Ei.length;so++){var Vl=(Ka(Ei[so-1]+" "+Ei[so])-Ka(Ei[so]))*un+Mc;so==Ei.length-1?P.push([Ei[so],Vl,0]):P.push([Ei[so]+" ",Vl,0]),ys-=Vl}}else P.push([Ct[$n],$i,Fi]);P.push(["",ys,0])}else{if(f!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(P=[],ii=Ct.length,se=se!==0?se:rd,$n=0;$n<ii;$n++)Fi=$n===0?zn(Ne):-Bl,$i=$n===0?Yi(fe):0,$n<ii-1?Xs.push(E(I((se-oo[$n])/(Ct[$n].split(" ").length-1)))):Xs.push(0),P.push([Ct[$n],$i,Fi])}}var id=typeof Fe.R2L=="boolean"?Fe.R2L:ve;id===!0&&(P=zo(P,function(mn,yn,En){return[mn.split("").reverse().join(""),yn,En]})),it={text:P,x:fe,y:Ne,options:Fe,mutex:{pdfEscape:rr,activeFontKey:He,fonts:rt,activeFontSize:Pe}},at.publish("postProcessText",it),P=it.text,vr=it.mutex.isHex||!1;var Fc=rt[He].encoding;Fc!=="WinAnsiEncoding"&&Fc!=="StandardEncoding"||(P=zo(P,function(mn,yn,En){return[xo(mn),yn,En]})),Ct=ni(P),P=[];for(var Ja,Qa,ea,Xa=0,ql=1,Za=Array.isArray(Ct[0])?ql:Xa,ta="",Oc=function(mn,yn,En){var Un="";return En instanceof ht?(En=typeof Fe.angle=="number"?Kt(En,new ht(1,0,0,1,mn,yn)):Kt(new ht(1,0,0,1,mn,yn),En),ne===V.ADVANCED&&(En=Kt(new ht(1,0,0,-1,0,0),En)),Un=En.join(" ")+` Tm
`):Un=E(mn)+" "+E(yn)+` Td
`,Un},ao=0;ao<Ct.length;ao++){switch(ta="",Za){case ql:ea=(vr?"<":"(")+Ct[ao][0]+(vr?">":")"),Ja=parseFloat(Ct[ao][1]),Qa=parseFloat(Ct[ao][2]);break;case Xa:ea=(vr?"<":"(")+Ct[ao]+(vr?">":")"),Ja=Yi(fe),Qa=zn(Ne)}Xs!==void 0&&Xs[ao]!==void 0&&(ta=Xs[ao]+` Tw
`),ao===0?P.push(ta+Oc(Ja,Qa,Qe)+ea):Za===Xa?P.push(ta+ea):Za===ql&&P.push(ta+Oc(Ja,Qa,Qe)+ea)}P=Za===Xa?P.join(` Tj
T* `):P.join(` Tj
`),P+=` Tj
`;var lo=`BT
/`;return lo+=He+" "+Pe+` Tf
`,lo+=E(Pe*Zr)+` TL
`,lo+=So+`
`,lo+=Nr,lo+=P,q(lo+="ET"),g[He]=!0,It};var qa=p.__private__.clip=p.clip=function(P){return q(P==="evenodd"?"W*":"W"),this};p.clipEvenOdd=function(){return qa("evenodd")},p.__private__.discardPath=p.discardPath=function(){return q("n"),this};var Ri=p.__private__.isValidStyle=function(P){var fe=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(P)!==-1&&(fe=!0),fe};p.__private__.setDefaultPathOperation=p.setDefaultPathOperation=function(P){return Ri(P)&&(u=P),this};var Vs=p.__private__.getStyle=p.getStyle=function(P){var fe=u;switch(P){case"D":case"S":fe="S";break;case"F":fe="f";break;case"FD":case"DF":fe="B";break;case"f":case"f*":case"B":case"B*":fe=P}return fe},Ii=p.close=function(){return q("h"),this};p.stroke=function(){return q("S"),this},p.fill=function(P){return Oo("f",P),this},p.fillEvenOdd=function(P){return Oo("f*",P),this},p.fillStroke=function(P){return Oo("B",P),this},p.fillStrokeEvenOdd=function(P){return Oo("B*",P),this};var Oo=function(P,fe){sn(fe)==="object"?qs(fe,P):q(P)},cs=function(P){P===null||ne===V.ADVANCED&&P===void 0||(P=Vs(P),q(P))};function Bo(P,fe,Ne,Fe,qe){var it=new ml(fe||this.boundingBox,Ne||this.xStep,Fe||this.yStep,this.gState,qe||this.matrix);it.stream=this.stream;var Ct=P+"$$"+this.cloneIndex+++"$$";return Qt(Ct,it),it}var qs=function(P,fe){var Ne=_t[P.key],Fe=pt[Ne];if(Fe instanceof ba)q("q"),q(Nl(fe)),Fe.gState&&p.setGState(Fe.gState),q(P.matrix.toString()+" cm"),q("/"+Ne+" sh"),q("Q");else if(Fe instanceof ml){var qe=new ht(1,0,0,-1,0,fi());P.matrix&&(qe=qe.multiply(P.matrix||Rt),Ne=Bo.call(Fe,P.key,P.boundingBox,P.xStep,P.yStep,qe).id),q("q"),q("/Pattern cs"),q("/"+Ne+" scn"),Fe.gState&&p.setGState(Fe.gState),q(fe),q("Q")}},Nl=function(P){switch(P){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},_o=p.moveTo=function(P,fe){return q(E(I(P))+" "+E(G(fe))+" m"),this},Gi=p.lineTo=function(P,fe){return q(E(I(P))+" "+E(G(fe))+" l"),this},wo=p.curveTo=function(P,fe,Ne,Fe,qe,it){return q([E(I(P)),E(G(fe)),E(I(Ne)),E(G(Fe)),E(I(qe)),E(G(it)),"c"].join(" ")),this};p.__private__.line=p.line=function(P,fe,Ne,Fe,qe){if(isNaN(P)||isNaN(fe)||isNaN(Ne)||isNaN(Fe)||!Ri(qe))throw new Error("Invalid arguments passed to jsPDF.line");return ne===V.COMPAT?this.lines([[Ne-P,Fe-fe]],P,fe,[1,1],qe||"S"):this.lines([[Ne-P,Fe-fe]],P,fe,[1,1]).stroke()},p.__private__.lines=p.lines=function(P,fe,Ne,Fe,qe,it){var Ct,Dt,f,M,se,be,Ve,Qe,It,gr,Nr,vr;if(typeof P=="number"&&(vr=Ne,Ne=fe,fe=P,P=vr),Fe=Fe||[1,1],it=it||!1,isNaN(fe)||isNaN(Ne)||!Array.isArray(P)||!Array.isArray(Fe)||!Ri(qe)||typeof it!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(_o(fe,Ne),Ct=Fe[0],Dt=Fe[1],M=P.length,gr=fe,Nr=Ne,f=0;f<M;f++)(se=P[f]).length===2?(gr=se[0]*Ct+gr,Nr=se[1]*Dt+Nr,Gi(gr,Nr)):(be=se[0]*Ct+gr,Ve=se[1]*Dt+Nr,Qe=se[2]*Ct+gr,It=se[3]*Dt+Nr,gr=se[4]*Ct+gr,Nr=se[5]*Dt+Nr,wo(be,Ve,Qe,It,gr,Nr));return it&&Ii(),cs(qe),this},p.path=function(P){for(var fe=0;fe<P.length;fe++){var Ne=P[fe],Fe=Ne.c;switch(Ne.op){case"m":_o(Fe[0],Fe[1]);break;case"l":Gi(Fe[0],Fe[1]);break;case"c":wo.apply(this,Fe);break;case"h":Ii()}}return this},p.__private__.rect=p.rect=function(P,fe,Ne,Fe,qe){if(isNaN(P)||isNaN(fe)||isNaN(Ne)||isNaN(Fe)||!Ri(qe))throw new Error("Invalid arguments passed to jsPDF.rect");return ne===V.COMPAT&&(Fe=-Fe),q([E(I(P)),E(G(fe)),E(I(Ne)),E(I(Fe)),"re"].join(" ")),cs(qe),this},p.__private__.triangle=p.triangle=function(P,fe,Ne,Fe,qe,it,Ct){if(isNaN(P)||isNaN(fe)||isNaN(Ne)||isNaN(Fe)||isNaN(qe)||isNaN(it)||!Ri(Ct))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Ne-P,Fe-fe],[qe-Ne,it-Fe],[P-qe,fe-it]],P,fe,[1,1],Ct,!0),this},p.__private__.roundedRect=p.roundedRect=function(P,fe,Ne,Fe,qe,it,Ct){if(isNaN(P)||isNaN(fe)||isNaN(Ne)||isNaN(Fe)||isNaN(qe)||isNaN(it)||!Ri(Ct))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Dt=4/3*(Math.SQRT2-1);return qe=Math.min(qe,.5*Ne),it=Math.min(it,.5*Fe),this.lines([[Ne-2*qe,0],[qe*Dt,0,qe,it-it*Dt,qe,it],[0,Fe-2*it],[0,it*Dt,-qe*Dt,it,-qe,it],[2*qe-Ne,0],[-qe*Dt,0,-qe,-it*Dt,-qe,-it],[0,2*it-Fe],[0,-it*Dt,qe*Dt,-it,qe,-it]],P+qe,fe,[1,1],Ct,!0),this},p.__private__.ellipse=p.ellipse=function(P,fe,Ne,Fe,qe){if(isNaN(P)||isNaN(fe)||isNaN(Ne)||isNaN(Fe)||!Ri(qe))throw new Error("Invalid arguments passed to jsPDF.ellipse");var it=4/3*(Math.SQRT2-1)*Ne,Ct=4/3*(Math.SQRT2-1)*Fe;return _o(P+Ne,fe),wo(P+Ne,fe-Ct,P+it,fe-Fe,P,fe-Fe),wo(P-it,fe-Fe,P-Ne,fe-Ct,P-Ne,fe),wo(P-Ne,fe+Ct,P-it,fe+Fe,P,fe+Fe),wo(P+it,fe+Fe,P+Ne,fe+Ct,P+Ne,fe),cs(qe),this},p.__private__.circle=p.circle=function(P,fe,Ne,Fe){if(isNaN(P)||isNaN(fe)||isNaN(Ne)||!Ri(Fe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(P,fe,Ne,Ne,Fe)},p.setFont=function(P,fe,Ne){return Ne&&(fe=ee(fe,Ne)),He=Yn(P,fe,{disableWarning:!1}),this};var za=p.__private__.getFont=p.getFont=function(){return rt[Yn.apply(p,arguments)]};p.__private__.getFontList=p.getFontList=function(){var P,fe,Ne={};for(P in We)if(We.hasOwnProperty(P))for(fe in Ne[P]=[],We[P])We[P].hasOwnProperty(fe)&&Ne[P].push(fe);return Ne},p.addFont=function(P,fe,Ne,Fe,qe){var it=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&it.indexOf(arguments[3])!==-1?qe=arguments[3]:arguments[3]&&it.indexOf(arguments[3])==-1&&(Ne=ee(Ne,Fe)),qe=qe||"Identity-H",tr.call(this,P,fe,Ne,qe)};var Xr,Ua=t.lineWidth||.200025,zs=p.__private__.getLineWidth=p.getLineWidth=function(){return Ua},Ha=p.__private__.setLineWidth=p.setLineWidth=function(P){return Ua=P,q(E(I(P))+" w"),this};p.__private__.setLineDash=or.API.setLineDash=or.API.setLineDashPattern=function(P,fe){if(P=P||[],fe=fe||0,isNaN(fe)||!Array.isArray(P))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return P=P.map(function(Ne){return E(I(Ne))}).join(" "),fe=E(I(fe)),q("["+P+"] "+fe+" d"),this};var Wa=p.__private__.getLineHeight=p.getLineHeight=function(){return Pe*Xr};p.__private__.getLineHeight=p.getLineHeight=function(){return Pe*Xr};var Ga=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(P){return typeof(P=P||1.15)=="number"&&(Xr=P),this},us=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return Xr};Ga(t.lineHeight);var Yi=p.__private__.getHorizontalCoordinate=function(P){return I(P)},zn=p.__private__.getVerticalCoordinate=function(P){return ne===V.ADVANCED?P:Xe[D].mediaBox.topRightY-Xe[D].mediaBox.bottomLeftY-I(P)},Ll=p.__private__.getHorizontalCoordinateString=p.getHorizontalCoordinateString=function(P){return E(Yi(P))},jo=p.__private__.getVerticalCoordinateString=p.getVerticalCoordinateString=function(P){return E(zn(P))},ri=t.strokeColor||"0 G";p.__private__.getStrokeColor=p.getDrawColor=function(){return Ht(ri)},p.__private__.setStrokeColor=p.setDrawColor=function(P,fe,Ne,Fe){return ri=tt({ch1:P,ch2:fe,ch3:Ne,ch4:Fe,pdfColorType:"draw",precision:2}),q(ri),this};var Us=t.fillColor||"0 g";p.__private__.getFillColor=p.getFillColor=function(){return Ht(Us)},p.__private__.setFillColor=p.setFillColor=function(P,fe,Ne,Fe){return Us=tt({ch1:P,ch2:fe,ch3:Ne,ch4:Fe,pdfColorType:"fill",precision:2}),q(Us),this};var So=t.textColor||"0 g",Hs=p.__private__.getTextColor=p.getTextColor=function(){return Ht(So)};p.__private__.setTextColor=p.setTextColor=function(P,fe,Ne,Fe){return So=tt({ch1:P,ch2:fe,ch3:Ne,ch4:Fe,pdfColorType:"text",precision:3}),this};var ds=t.charSpace,Ws=p.__private__.getCharSpace=p.getCharSpace=function(){return parseFloat(ds||0)};p.__private__.setCharSpace=p.setCharSpace=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return ds=P,this};var Ya=0;p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},p.__private__.setLineCap=p.setLineCap=function(P){var fe=p.CapJoinStyles[P];if(fe===void 0)throw new Error("Line cap style of '"+P+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ya=fe,q(fe+" J"),this};var Gs=0;p.__private__.setLineJoin=p.setLineJoin=function(P){var fe=p.CapJoinStyles[P];if(fe===void 0)throw new Error("Line join style of '"+P+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Gs=fe,q(fe+" j"),this},p.__private__.setLineMiterLimit=p.__private__.setMiterLimit=p.setLineMiterLimit=p.setMiterLimit=function(P){if(P=P||0,isNaN(P))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return q(E(I(P))+" M"),this},p.GState=ju,p.setGState=function(P){(P=typeof P=="string"?Et[et[P]]:Vo(null,P)).equals(Ue)||(q("/"+P.id+" gs"),Ue=P)};var Vo=function(P,fe){if(!P||!et[P]){var Ne=!1;for(var Fe in Et)if(Et.hasOwnProperty(Fe)&&Et[Fe].equals(fe)){Ne=!0;break}if(Ne)fe=Et[Fe];else{var qe="GS"+(Object.keys(Et).length+1).toString(10);Et[qe]=fe,fe.id=qe}return P&&(et[P]=fe.id),at.publish("addGState",fe),fe}};p.addGState=function(P,fe){return Vo(P,fe),this},p.saveGraphicsState=function(){return q("q"),ct.push({key:He,size:Pe,color:So}),this},p.restoreGraphicsState=function(){q("Q");var P=ct.pop();return He=P.key,Pe=P.size,So=P.color,Ue=null,this},p.setCurrentTransformationMatrix=function(P){return q(P.toString()+" cm"),this},p.comment=function(P){return q("#"+P),this};var hs=function(P,fe){var Ne=P||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Ne},set:function(it){isNaN(it)||(Ne=parseFloat(it))}});var Fe=fe||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Fe},set:function(it){isNaN(it)||(Fe=parseFloat(it))}});var qe="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return qe},set:function(it){qe=it.toString()}}),this},Ys=function(P,fe,Ne,Fe){hs.call(this,P,fe),this.type="rect";var qe=Ne||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return qe},set:function(Ct){isNaN(Ct)||(qe=parseFloat(Ct))}});var it=Fe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return it},set:function(Ct){isNaN(Ct)||(it=parseFloat(Ct))}}),this},fs=function(){this.page=ot,this.currentPage=D,this.pages=Y.slice(0),this.pagesContext=Xe.slice(0),this.x=Ze,this.y=Ye,this.matrix=ut,this.width=qo(D),this.height=fi(D),this.outputDestination=ae,this.id="",this.objectNumber=-1};fs.prototype.restore=function(){ot=this.page,D=this.currentPage,Xe=this.pagesContext,Y=this.pages,Ze=this.x,Ye=this.y,ut=this.matrix,Js(D,this.width),Qs(D,this.height),ae=this.outputDestination};var Ks=function(P,fe,Ne,Fe,qe){Gt.push(new fs),ot=D=0,Y=[],Ze=P,Ye=fe,ut=qe,fr([Ne,Fe])},Dl=function(P){if(qt[P])Gt.pop().restore();else{var fe=new fs,Ne="Xo"+(Object.keys($t).length+1).toString(10);fe.id=Ne,qt[P]=Ne,$t[Ne]=fe,at.publish("addFormObject",fe),Gt.pop().restore()}};for(var Po in p.beginFormObject=function(P,fe,Ne,Fe,qe){return Ks(P,fe,Ne,Fe,qe),this},p.endFormObject=function(P){return Dl(P),this},p.doFormObject=function(P,fe){var Ne=$t[qt[P]];return q("q"),q(fe.toString()+" cm"),q("/"+Ne.id+" Do"),q("Q"),this},p.getFormObject=function(P){var fe=$t[qt[P]];return{x:fe.x,y:fe.y,width:fe.width,height:fe.height,matrix:fe.matrix}},p.save=function(P,fe){return P=P||"generated.pdf",(fe=fe||{}).returnPromise=fe.returnPromise||!1,fe.returnPromise===!1?(al(ti(In()),P),typeof al.unload=="function"&&cr.setTimeout&&setTimeout(al.unload,911),this):new Promise(function(Ne,Fe){try{var qe=al(ti(In()),P);typeof al.unload=="function"&&cr.setTimeout&&setTimeout(al.unload,911),Ne(qe)}catch(it){Fe(it.message)}})},or.API)or.API.hasOwnProperty(Po)&&(Po==="events"&&or.API.events.length?function(P,fe){var Ne,Fe,qe;for(qe=fe.length-1;qe!==-1;qe--)Ne=fe[qe][0],Fe=fe[qe][1],P.subscribe.apply(P,[Ne].concat(typeof Fe=="function"?[Fe]:Fe))}(at,or.API.events):p[Po]=or.API[Po]);var qo=p.getPageWidth=function(P){return(Xe[P=P||D].mediaBox.topRightX-Xe[P].mediaBox.bottomLeftX)/Me},Js=p.setPageWidth=function(P,fe){Xe[P].mediaBox.topRightX=fe*Me+Xe[P].mediaBox.bottomLeftX},fi=p.getPageHeight=function(P){return(Xe[P=P||D].mediaBox.topRightY-Xe[P].mediaBox.bottomLeftY)/Me},Qs=p.setPageHeight=function(P,fe){Xe[P].mediaBox.topRightY=fe*Me+Xe[P].mediaBox.bottomLeftY};return p.internal={pdfEscape:rr,getStyle:Vs,getFont:za,getFontSize:he,getCharSpace:Ws,getTextColor:Hs,getLineHeight:Wa,getLineHeightFactor:us,getLineWidth:zs,write:ce,getHorizontalCoordinate:Yi,getVerticalCoordinate:zn,getCoordinateString:Ll,getVerticalCoordinateString:jo,collections:{},newObject:sr,newAdditionalObject:Ot,newObjectDeferred:mt,newObjectDeferredBegin:At,getFilters:jt,putStream:yt,events:at,scaleFactor:Me,pageSize:{getWidth:function(){return qo(D)},setWidth:function(P){Js(D,P)},getHeight:function(){return fi(D)},setHeight:function(P){Qs(D,P)}},encryptionOptions:h,encryption:cn,getEncryptor:js,output:Di,getNumberOfPages:Pr,pages:Y,out:q,f2:R,f3:_,getPageInfo:bo,getPageInfoByObjId:nr,getCurrentPageInfo:io,getPDFVersion:S,Point:hs,Rectangle:Ys,Matrix:ht,hasHotfix:no},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return qo(D)},set:function(P){Js(D,P)},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return fi(D)},set:function(P){Qs(D,P)},enumerable:!0,configurable:!0}),Tr.call(p,me),He="F1",Gr(i,r),at.publish("initialized"),p}sc.prototype.lsbFirstWord=function(t){return String.fromCharCode(t>>0&255,t>>8&255,t>>16&255,t>>24&255)},sc.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},sc.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},sc.prototype.processOwnerPassword=function(t,e){return gm(ym(e).substr(0,5),t)},sc.prototype.encryptor=function(t,e){var r=ym(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return gm(r,n)}},ju.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||sn(t)!==sn(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},or.API={events:[]},or.version="3.0.1";var An=or.API,My=1,Tl=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Xl=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},br=function(t){return t.toFixed(2)},pa=function(t){return t.toFixed(5)};An.__acroform__={};var Hi=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},B0=function(t){return t*My},Yo=function(t){var e=new F5,r=Wt.internal.getHeight(t)||0,n=Wt.internal.getWidth(t)||0;return e.BBox=[0,0,Number(br(n)),Number(br(r))],e},p7=An.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|=1<<e},m7=An.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&=~(1<<e)},y7=An.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return(t&1<<e)==0?0:1},Tn=An.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return y7(t,e-1)},Nn=An.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return p7(t,e-1)},Ln=An.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return m7(t,e-1)},g7=An.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,i=t[0],o=t[1],s=t[2],a=t[3],c={};return c.lowerLeft_X=r(i)||0,c.lowerLeft_Y=n(o+a)||0,c.upperRight_X=r(i+s)||0,c.upperRight_Y=n(o)||0,[Number(br(c.lowerLeft_X)),Number(br(c.lowerLeft_Y)),Number(br(c.upperRight_X)),Number(br(c.upperRight_Y))]},v7=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=vm(t,r),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+i+" "+br(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var o=Yo(t);return o.scope=t.scope,o.stream=e.join(`
`),o}},vm=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=t.multiline?i.map(function(_){return _.split(`
`)}):i.map(function(_){return[_]});var o=r,s=Wt.internal.getHeight(t)||0;s=s<0?-s:s;var a=Wt.internal.getWidth(t)||0;a=a<0?-a:a;var c=function(_,I,b){if(_+1<i.length){var G=I+" "+i[_+1][0];return Ud(G,t,b).width<=a-4}return!1};o++;e:for(;o>0;){e="",o--;var u,h,y=Ud("3",t,o).height,g=t.multiline?s-o:(s-y)/2,p=g+=2,C=0,S=0,w=0;if(o<=0){e=`(...) Tj
`,e+="% Width of Text: "+Ud(e,t,o=12).width+", FieldWidth:"+a+`
`;break}for(var x="",V=0,ne=0;ne<i.length;ne++)if(i.hasOwnProperty(ne)){var X=!1;if(i[ne].length!==1&&w!==i[ne].length-1){if((y+2)*(V+2)+2>s)continue e;x+=i[ne][w],X=!0,S=ne,ne--}else{x=(x+=i[ne][w]+" ").substr(x.length-1)==" "?x.substr(0,x.length-1):x;var Q=parseInt(ne),ee=c(Q,x,o),E=ne>=i.length-1;if(ee&&!E){x+=" ",w=0;continue}if(ee||E){if(E)S=Q;else if(t.multiline&&(y+2)*(V+2)+2>s)continue e}else{if(!t.multiline||(y+2)*(V+2)+2>s)continue e;S=Q}}for(var A="",T=C;T<=S;T++){var R=i[T];if(t.multiline){if(T===S){A+=R[w]+" ",w=(w+1)%R.length;continue}if(T===C){A+=R[R.length-1]+" ";continue}}A+=R[0]+" "}switch(A=A.substr(A.length-1)==" "?A.substr(0,A.length-1):A,h=Ud(A,t,o).width,t.textAlign){case"right":u=a-h-2;break;case"center":u=(a-h)/2;break;case"left":default:u=2}e+=br(u)+" "+br(p)+` Td
`,e+="("+Tl(A)+`) Tj
`,e+=-br(u)+` 0 Td
`,p=-(o+2),h=0,C=X?S:S+1,V++,x=""}break}return n.text=e,n.fontSize=o,n},Ud=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},b7={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},_7=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},w7=function(t,e){for(var r in t)if(t.hasOwnProperty(r)){var n=r,i=t[r];e.internal.newObjectDeferredBegin(i.objId,!0),sn(i)==="object"&&typeof i.putStream=="function"&&i.putStream(),delete t[n]}},S7=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Mo.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(b7)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");My=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new O5,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var o=n[i];o.objId=void 0,o.hasAnnotation&&_7(o,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,i){var o=!n;for(var s in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var a=n[s],c=[],u=a.Rect;if(a.Rect&&(a.Rect=g7(a.Rect,i)),i.internal.newObjectDeferredBegin(a.objId,!0),a.DA=Wt.createDefaultAppearanceStream(a),sn(a)==="object"&&typeof a.getKeyValueListForStream=="function"&&(c=a.getKeyValueListForStream()),a.Rect=u,a.hasAppearanceStream&&!a.appearanceStreamContent){var h=v7(a);c.push({key:"AP",value:"<</N "+h+">>"}),i.internal.acroformPlugin.xForms.push(h)}if(a.appearanceStreamContent){var y="";for(var g in a.appearanceStreamContent)if(a.appearanceStreamContent.hasOwnProperty(g)){var p=a.appearanceStreamContent[g];if(y+="/"+g+" ",y+="<<",Object.keys(p).length>=1||Array.isArray(p)){for(var s in p)if(p.hasOwnProperty(s)){var C=p[s];typeof C=="function"&&(C=C.call(i,a)),y+="/"+s+" "+C+" ",i.internal.acroformPlugin.xForms.indexOf(C)>=0||i.internal.acroformPlugin.xForms.push(C)}}else typeof(C=p)=="function"&&(C=C.call(i,a)),y+="/"+s+" "+C,i.internal.acroformPlugin.xForms.indexOf(C)>=0||i.internal.acroformPlugin.xForms.push(C);y+=">>"}c.push({key:"AP",value:`<<
`+y+">>"})}i.internal.putStream({additionalKeyValues:c,objectId:a.objId}),i.internal.out("endobj")}o&&w7(i.internal.acroformPlugin.xForms,i)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},M5=An.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(s){return s};if(Array.isArray(t)){for(var i="[",o=0;o<t.length;o++)switch(o!==0&&(i+=" "),sn(t[o])){case"boolean":case"number":case"object":i+=t[o].toString();break;case"string":t[o].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),i+="("+Tl(n(t[o].toString()))+")"):i+=t[o].toString()}return i+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},yp=function(t,e,r){var n=function(i){return i};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),t="("+Tl(n(t))+")"},Qo=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Qo.prototype.toString=function(){return this.objId+" 0 R"},Qo.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},Qo.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(o){return o!="content"&&o!="appearanceStreamContent"&&o!="scope"&&o!="objId"&&o.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],i=this[n];i&&(Array.isArray(i)?t.push({key:n,value:M5(i,this.objId,this.scope)}):i instanceof Qo?(i.scope=this.scope,t.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&t.push({key:n,value:i}))}return t};var F5=function(){Qo.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};Hi(F5,Qo);var O5=function(){Qo.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Tl(r(t))+")"}},set:function(r){t=r}})};Hi(O5,Qo);var Mo=function t(){Qo.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute F supplied.');e=x}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Tn(e,3)},set:function(x){x?this.F=Nn(e,3):this.F=Ln(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute Ff supplied.');r=x}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(x){n=x!==void 0?x:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(x){n[0]=x}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(x){n[1]=x}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(x){n[2]=x}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(x){n[3]=x}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(x){switch(x){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=x;break;default:throw new Error('Invalid value "'+x+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof Fh)return;o="FieldObject"+t.FieldNum++}var x=function(V){return V};return this.scope&&(x=this.scope.internal.getEncryptor(this.objId)),"("+Tl(x(o))+")"},set:function(x){o=x.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(x){o=x}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(x){s=x}});var a="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return a},set:function(x){a=x}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(x){c=x}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/My:u},set:function(x){u=x}});var h="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return h},set:function(x){h=x}});var y="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!y||this instanceof Fh||this instanceof Ea))return yp(y,this.objId,this.scope)},set:function(x){x=x.toString(),y=x}});var g=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof Wn?g:yp(g,this.objId,this.scope)},set:function(x){x=x.toString(),g=this instanceof Wn?x:x.substr(0,1)==="("?Xl(x.substr(1,x.length-2)):Xl(x)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Wn?Xl(g.substr(1,g.length-1)):g},set:function(x){x=x.toString(),g=this instanceof Wn?"/"+x:x}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(x){this.V=x}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Wn?p:yp(p,this.objId,this.scope)},set:function(x){x=x.toString(),p=this instanceof Wn?x:x.substr(0,1)==="("?Xl(x.substr(1,x.length-2)):Xl(x)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Wn?Xl(p.substr(1,p.length-1)):p},set:function(x){x=x.toString(),p=this instanceof Wn?"/"+x:x}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var C,S=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return S},set:function(x){x=!!x,S=x}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(C)return C},set:function(x){C=x}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,1)},set:function(x){x?this.Ff=Nn(this.Ff,1):this.Ff=Ln(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,2)},set:function(x){x?this.Ff=Nn(this.Ff,2):this.Ff=Ln(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,3)},set:function(x){x?this.Ff=Nn(this.Ff,3):this.Ff=Ln(this.Ff,3)}});var w=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(w!==null)return w},set:function(x){if([0,1,2].indexOf(x)===-1)throw new Error('Invalid value "'+x+'" for attribute Q supplied.');w=x}}),Object.defineProperty(this,"textAlign",{get:function(){var x;switch(w){case 0:default:x="left";break;case 1:x="center";break;case 2:x="right"}return x},configurable:!0,enumerable:!0,set:function(x){switch(x){case"right":case 2:w=2;break;case"center":case 1:w=1;break;case"left":case 0:default:w=0}}})};Hi(Mo,Qo);var vl=function(){Mo.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return M5(e,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=function(o,s,a){a||(a=1);for(var c,u=[];c=s.exec(o);)u.push(c[a]);return u}(n,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,18)},set:function(r){r?this.Ff=Nn(this.Ff,18):this.Ff=Ln(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Nn(this.Ff,19):this.Ff=Ln(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,20)},set:function(r){r?(this.Ff=Nn(this.Ff,20),e.sort()):this.Ff=Ln(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,22)},set:function(r){r?this.Ff=Nn(this.Ff,22):this.Ff=Ln(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,23)},set:function(r){r?this.Ff=Nn(this.Ff,23):this.Ff=Ln(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,27)},set:function(r){r?this.Ff=Nn(this.Ff,27):this.Ff=Ln(this.Ff,27)}}),this.hasAppearanceStream=!1};Hi(vl,Mo);var bl=function(){vl.call(this),this.fontName="helvetica",this.combo=!1};Hi(bl,vl);var _l=function(){bl.call(this),this.combo=!0};Hi(_l,bl);var vu=function(){_l.call(this),this.edit=!0};Hi(vu,_l);var Wn=function(){Mo.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,15)},set:function(r){r?this.Ff=Nn(this.Ff,15):this.Ff=Ln(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,16)},set:function(r){r?this.Ff=Nn(this.Ff,16):this.Ff=Ln(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,17)},set:function(r){r?this.Ff=Nn(this.Ff,17):this.Ff=Ln(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,26)},set:function(r){r?this.Ff=Nn(this.Ff,26):this.Ff=Ln(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(o){return o};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,i=[];for(n in i.push("<<"),e)i.push("/"+n+" ("+Tl(r(e[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){sn(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};Hi(Wn,Mo);var bu=function(){Wn.call(this),this.pushButton=!0};Hi(bu,Wn);var wl=function(){Wn.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};Hi(wl,Wn);var Fh=function(){var t,e;Mo.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(a){return a};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var o,s=[];for(o in s.push("<<"),n)s.push("/"+o+" ("+Tl(i(n[o]))+")");return s.push(">>"),s.join(`
`)},set:function(i){sn(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Wt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Hi(Fh,Mo),wl.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},wl.prototype.createOption=function(t){var e=new Fh;return e.Parent=this,e.optionName=t,this.Kids.push(e),P7.call(this.scope,e),e};var _u=function(){Wn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Wt.CheckBox.createAppearanceStream()};Hi(_u,Wn);var Ea=function(){Mo.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,13)},set:function(e){e?this.Ff=Nn(this.Ff,13):this.Ff=Ln(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,21)},set:function(e){e?this.Ff=Nn(this.Ff,21):this.Ff=Ln(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,23)},set:function(e){e?this.Ff=Nn(this.Ff,23):this.Ff=Ln(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,24)},set:function(e){e?this.Ff=Nn(this.Ff,24):this.Ff=Ln(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,25)},set:function(e){e?this.Ff=Nn(this.Ff,25):this.Ff=Ln(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,26)},set:function(e){e?this.Ff=Nn(this.Ff,26):this.Ff=Ln(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Hi(Ea,Mo);var wu=function(){Ea.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,14)},set:function(t){t?this.Ff=Nn(this.Ff,14):this.Ff=Ln(this.Ff,14)}}),this.password=!0};Hi(wu,Ea);var Wt={CheckBox:{createAppearanceStream:function(){return{N:{On:Wt.CheckBox.YesNormal},D:{On:Wt.CheckBox.YesPushDown,Off:Wt.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Yo(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),o=vm(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+br(Wt.internal.getWidth(t))+" "+br(Wt.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+br(o.fontSize)+" Tf "+i),r.push("BT"),r.push(o.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=Yo(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),i=[],o=Wt.internal.getHeight(t),s=Wt.internal.getWidth(t),a=vm(t,t.caption);return i.push("1 g"),i.push("0 0 "+br(s)+" "+br(o)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+br(s-1)+" "+br(o-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+br(a.fontSize)+" Tf "+n),i.push(a.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=Yo(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+br(Wt.internal.getWidth(t))+" "+br(Wt.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:Wt.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=Wt.RadioButton.Circle.YesNormal,e.D[t]=Wt.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Yo(t);e.scope=t.scope;var r=[],n=Wt.internal.getWidth(t)<=Wt.internal.getHeight(t)?Wt.internal.getWidth(t)/4:Wt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Wt.internal.Bezier_C,o=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+pa(Wt.internal.getWidth(t)/2)+" "+pa(Wt.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Yo(t);e.scope=t.scope;var r=[],n=Wt.internal.getWidth(t)<=Wt.internal.getHeight(t)?Wt.internal.getWidth(t)/4:Wt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),o=Number((i*Wt.internal.Bezier_C).toFixed(5)),s=Number((n*Wt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+pa(Wt.internal.getWidth(t)/2)+" "+pa(Wt.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),r.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),r.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),r.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+pa(Wt.internal.getWidth(t)/2)+" "+pa(Wt.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=Yo(t);e.scope=t.scope;var r=[],n=Wt.internal.getWidth(t)<=Wt.internal.getHeight(t)?Wt.internal.getWidth(t)/4:Wt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),o=Number((i*Wt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+pa(Wt.internal.getWidth(t)/2)+" "+pa(Wt.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),r.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),r.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),r.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:Wt.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=Wt.RadioButton.Cross.YesNormal,e.D[t]=Wt.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Yo(t);e.scope=t.scope;var r=[],n=Wt.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+br(Wt.internal.getWidth(t)-2)+" "+br(Wt.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(br(n.x1.x)+" "+br(n.x1.y)+" m"),r.push(br(n.x2.x)+" "+br(n.x2.y)+" l"),r.push(br(n.x4.x)+" "+br(n.x4.y)+" m"),r.push(br(n.x3.x)+" "+br(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Yo(t);e.scope=t.scope;var r=Wt.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+br(Wt.internal.getWidth(t))+" "+br(Wt.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+br(Wt.internal.getWidth(t)-2)+" "+br(Wt.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(br(r.x1.x)+" "+br(r.x1.y)+" m"),n.push(br(r.x2.x)+" "+br(r.x2.y)+" l"),n.push(br(r.x4.x)+" "+br(r.x4.y)+" m"),n.push(br(r.x3.x)+" "+br(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=Yo(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+br(Wt.internal.getWidth(t))+" "+br(Wt.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};Wt.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=Wt.internal.getWidth(t),r=Wt.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},Wt.internal.getWidth=function(t){var e=0;return sn(t)==="object"&&(e=B0(t.Rect[2])),e},Wt.internal.getHeight=function(t){var e=0;return sn(t)==="object"&&(e=B0(t.Rect[3])),e};var P7=An.addField=function(t){if(S7(this,t),!(t instanceof Mo))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};An.AcroFormChoiceField=vl,An.AcroFormListBox=bl,An.AcroFormComboBox=_l,An.AcroFormEditBox=vu,An.AcroFormButton=Wn,An.AcroFormPushButton=bu,An.AcroFormRadioButton=wl,An.AcroFormCheckBox=_u,An.AcroFormTextField=Ea,An.AcroFormPasswordField=wu,An.AcroFormAppearance=Wt,An.AcroForm={ChoiceField:vl,ListBox:bl,ComboBox:_l,EditBox:vu,Button:Wn,PushButton:bu,RadioButton:wl,CheckBox:_u,TextField:Ea,PasswordField:wu,Appearance:Wt},or.AcroForm={ChoiceField:vl,ListBox:bl,ComboBox:_l,EditBox:vu,Button:Wn,PushButton:bu,RadioButton:wl,CheckBox:_u,TextField:Ea,PasswordField:wu,Appearance:Wt};var x7=or.AcroForm;function B5(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){t.__addimage__={};var e="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=t.__addimage__.getImageFileTypeByImageData=function(_,I){var b,G,ie,F,W,z=e;if((I=I||e)==="RGBA"||_.data!==void 0&&_.data instanceof Uint8ClampedArray&&"height"in _&&"width"in _)return"RGBA";if(ee(_))for(W in r)for(ie=r[W],b=0;b<ie.length;b+=1){for(F=!0,G=0;G<ie[b].length;G+=1)if(ie[b][G]!==void 0&&ie[b][G]!==_[G]){F=!1;break}if(F===!0){z=W;break}}else for(W in r)for(ie=r[W],b=0;b<ie.length;b+=1){for(F=!0,G=0;G<ie[b].length;G+=1)if(ie[b][G]!==void 0&&ie[b][G]!==_.charCodeAt(G)){F=!1;break}if(F===!0){z=W;break}}return z===e&&I!==e&&(z=I),z},i=function _(I){for(var b=this.internal.write,G=this.internal.putStream,ie=(0,this.internal.getFilters)();ie.indexOf("FlateEncode")!==-1;)ie.splice(ie.indexOf("FlateEncode"),1);I.objectId=this.internal.newObject();var F=[];if(F.push({key:"Type",value:"/XObject"}),F.push({key:"Subtype",value:"/Image"}),F.push({key:"Width",value:I.width}),F.push({key:"Height",value:I.height}),I.colorSpace===w.INDEXED?F.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(I.palette.length/3-1)+" "+("sMask"in I&&I.sMask!==void 0?I.objectId+2:I.objectId+1)+" 0 R]"}):(F.push({key:"ColorSpace",value:"/"+I.colorSpace}),I.colorSpace===w.DEVICE_CMYK&&F.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),F.push({key:"BitsPerComponent",value:I.bitsPerComponent}),"decodeParameters"in I&&I.decodeParameters!==void 0&&F.push({key:"DecodeParms",value:"<<"+I.decodeParameters+">>"}),"transparency"in I&&Array.isArray(I.transparency)){for(var W="",z=0,O=I.transparency.length;z<O;z++)W+=I.transparency[z]+" "+I.transparency[z]+" ";F.push({key:"Mask",value:"["+W+"]"})}I.sMask!==void 0&&F.push({key:"SMask",value:I.objectId+1+" 0 R"});var k=I.filter!==void 0?["/"+I.filter]:void 0;if(G({data:I.data,additionalKeyValues:F,alreadyAppliedFilters:k,objectId:I.objectId}),b("endobj"),"sMask"in I&&I.sMask!==void 0){var re="/Predictor "+I.predictor+" /Colors 1 /BitsPerComponent "+I.bitsPerComponent+" /Columns "+I.width,$={width:I.width,height:I.height,colorSpace:"DeviceGray",bitsPerComponent:I.bitsPerComponent,decodeParameters:re,data:I.sMask};"filter"in I&&($.filter=I.filter),_.call(this,$)}if(I.colorSpace===w.INDEXED){var D=this.internal.newObject();G({data:A(new Uint8Array(I.palette)),objectId:D}),b("endobj")}},o=function(){var _=this.internal.collections.addImage_images;for(var I in _)i.call(this,_[I])},s=function(){var _,I=this.internal.collections.addImage_images,b=this.internal.write;for(var G in I)b("/I"+(_=I[G]).index,_.objectId,"0","R")},a=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",s))},c=function(){var _=this.internal.collections.addImage_images;return a.call(this),_},u=function(){return Object.keys(this.internal.collections.addImage_images).length},h=function(_){return typeof t["process"+_.toUpperCase()]=="function"},y=function(_){return sn(_)==="object"&&_.nodeType===1},g=function(_,I){if(_.nodeName==="IMG"&&_.hasAttribute("src")){var b=""+_.getAttribute("src");if(b.indexOf("data:image/")===0)return gu(unescape(b).split("base64,").pop());var G=t.loadFile(b,!0);if(G!==void 0)return G}if(_.nodeName==="CANVAS"){if(_.width===0||_.height===0)throw new Error("Given canvas must have data. Canvas width: "+_.width+", height: "+_.height);var ie;switch(I){case"PNG":ie="image/png";break;case"WEBP":ie="image/webp";break;case"JPEG":case"JPG":default:ie="image/jpeg"}return gu(_.toDataURL(ie,1).split("base64,").pop())}},p=function(_){var I=this.internal.collections.addImage_images;if(I){for(var b in I)if(_===I[b].alias)return I[b]}},C=function(_,I,b){return _||I||(_=-96,I=-96),_<0&&(_=-1*b.width*72/_/this.internal.scaleFactor),I<0&&(I=-1*b.height*72/I/this.internal.scaleFactor),_===0&&(_=I*b.width/b.height),I===0&&(I=_*b.height/b.width),[_,I]},S=function(_,I,b,G,ie,F){var W=C.call(this,b,G,ie),z=this.internal.getCoordinateString,O=this.internal.getVerticalCoordinateString,k=c.call(this);if(b=W[0],G=W[1],k[ie.index]=ie,F){F*=Math.PI/180;var re=Math.cos(F),$=Math.sin(F),D=function(L){return L.toFixed(4)},H=[D(re),D($),D(-1*$),D(re),0,0,"cm"]}this.internal.write("q"),F?(this.internal.write([1,"0","0",1,z(_),O(I+G),"cm"].join(" ")),this.internal.write(H.join(" ")),this.internal.write([z(b),"0","0",z(G),"0","0","cm"].join(" "))):this.internal.write([z(b),"0","0",z(G),z(_),O(I+G),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ie.index+" Do"),this.internal.write("Q")},w=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var x=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},V=t.__addimage__.sHashCode=function(_){var I,b,G=0;if(typeof _=="string")for(b=_.length,I=0;I<b;I++)G=(G<<5)-G+_.charCodeAt(I),G|=0;else if(ee(_))for(b=_.byteLength/2,I=0;I<b;I++)G=(G<<5)-G+_[I],G|=0;return G},ne=t.__addimage__.validateStringAsBase64=function(_){(_=_||"").toString().trim();var I=!0;return _.length===0&&(I=!1),_.length%4!=0&&(I=!1),/^[A-Za-z0-9+/]+$/.test(_.substr(0,_.length-2))===!1&&(I=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(_.substr(-2))===!1&&(I=!1),I},X=t.__addimage__.extractImageFromDataUrl=function(_){if(_==null||!(_=_.trim()).startsWith("data:"))return null;var I=_.indexOf(",");return I<0?null:_.substring(0,I).trim().endsWith("base64")?_.substring(I+1):null},Q=t.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};t.__addimage__.isArrayBuffer=function(_){return Q()&&_ instanceof ArrayBuffer};var ee=t.__addimage__.isArrayBufferView=function(_){return Q()&&typeof Uint32Array<"u"&&(_ instanceof Int8Array||_ instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&_ instanceof Uint8ClampedArray||_ instanceof Int16Array||_ instanceof Uint16Array||_ instanceof Int32Array||_ instanceof Uint32Array||_ instanceof Float32Array||_ instanceof Float64Array)},E=t.__addimage__.binaryStringToUint8Array=function(_){for(var I=_.length,b=new Uint8Array(I),G=0;G<I;G++)b[G]=_.charCodeAt(G);return b},A=t.__addimage__.arrayBufferToBinaryString=function(_){for(var I="",b=ee(_)?_:new Uint8Array(_),G=0;G<b.length;G+=8192)I+=String.fromCharCode.apply(null,b.subarray(G,G+8192));return I};t.addImage=function(){var _,I,b,G,ie,F,W,z,O;if(typeof arguments[1]=="number"?(I=e,b=arguments[1],G=arguments[2],ie=arguments[3],F=arguments[4],W=arguments[5],z=arguments[6],O=arguments[7]):(I=arguments[1],b=arguments[2],G=arguments[3],ie=arguments[4],F=arguments[5],W=arguments[6],z=arguments[7],O=arguments[8]),sn(_=arguments[0])==="object"&&!y(_)&&"imageData"in _){var k=_;_=k.imageData,I=k.format||I||e,b=k.x||b||0,G=k.y||G||0,ie=k.w||k.width||ie,F=k.h||k.height||F,W=k.alias||W,z=k.compression||z,O=k.rotation||k.angle||O}var re=this.internal.getFilters();if(z===void 0&&re.indexOf("FlateEncode")!==-1&&(z="SLOW"),isNaN(b)||isNaN(G))throw new Error("Invalid coordinates passed to jsPDF.addImage");a.call(this);var $=T.call(this,_,I,W,z);return S.call(this,b,G,ie,F,$,O),this};var T=function(_,I,b,G){var ie,F,W;if(typeof _=="string"&&n(_)===e){_=unescape(_);var z=R(_,!1);(z!==""||(z=t.loadFile(_,!0))!==void 0)&&(_=z)}if(y(_)&&(_=g(_,I)),I=n(_,I),!h(I))throw new Error("addImage does not support files of type '"+I+"', please ensure that a plugin for '"+I+"' support is added.");if(((W=b)==null||W.length===0)&&(b=function(O){return typeof O=="string"||ee(O)?V(O):ee(O.data)?V(O.data):null}(_)),(ie=p.call(this,b))||(Q()&&(_ instanceof Uint8Array||I==="RGBA"||(F=_,_=E(_))),ie=this["process"+I.toUpperCase()](_,u.call(this),b,function(O){return O&&typeof O=="string"&&(O=O.toUpperCase()),O in t.image_compression?O:x.NONE}(G),F)),!ie)throw new Error("An unknown error occurred whilst processing the image.");return ie},R=t.__addimage__.convertBase64ToBinaryString=function(_,I){I=typeof I!="boolean"||I;var b,G="";if(typeof _=="string"){var ie;b=(ie=X(_))!==null&&ie!==void 0?ie:_;try{G=gu(b)}catch(F){if(I)throw ne(b)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+F.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return G};t.getImageProperties=function(_){var I,b,G="";if(y(_)&&(_=g(_)),typeof _=="string"&&n(_)===e&&((G=R(_,!1))===""&&(G=t.loadFile(_)||""),_=G),b=n(_),!h(b))throw new Error("addImage does not support files of type '"+b+"', please ensure that a plugin for '"+b+"' support is added.");if(!Q()||_ instanceof Uint8Array||(_=E(_)),!(I=this["process"+b.toUpperCase()](_)))throw new Error("An unknown error occurred whilst processing the image");return I.fileType=b,I}})(or.API),function(t){var e=function(r){if(r!==void 0&&r!="")return!0};or.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,i,o,s=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,h=!1,y=0;y<u.length&&!h;y++)switch((n=u[y]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(h=!0);break;case"reference":case"text":case"freetext":h=!0}if(h!=0){this.internal.write("/Annots [");for(var g=0;g<u.length;g++){n=u[g];var p=this.internal.pdfEscape,C=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var S=this.internal.newAdditionalObject(),w=this.internal.newAdditionalObject(),x=this.internal.getEncryptor(S.objId),V=n.title||"Note";o="<</Type /Annot /Subtype /Text "+(i="/Rect ["+s(n.bounds.x)+" "+a(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+a(n.bounds.y)+"] ")+"/Contents ("+p(x(n.contents))+")",o+=" /Popup "+w.objId+" 0 R",o+=" /P "+c.objId+" 0 R",o+=" /T ("+p(x(V))+") >>",S.content=o;var ne=S.objId+" 0 R";o="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+s(n.bounds.x+30)+" "+a(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+a(n.bounds.y)+"] ")+" /Parent "+ne,n.open&&(o+=" /Open true"),o+=" >>",w.content=o,this.internal.write(S.objId,"0 R",w.objId,"0 R");break;case"freetext":i="/Rect ["+s(n.bounds.x)+" "+a(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+a(n.bounds.y+n.bounds.h)+"] ";var X=n.color||"#000000";o="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+p(C(n.contents))+")",o+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+X+")",o+=" /Border [0 0 0]",o+=" >>",this.internal.write(o);break;case"link":if(n.options.name){var Q=this.annotations._nameMap[n.options.name];n.options.pageNumber=Q.page,n.options.top=Q.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",o="",n.options.url)o="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+p(C(n.options.url))+") >>";else if(n.options.pageNumber)switch(o="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":o+=" /Fit]";break;case"FitH":o+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,o+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var ee=a(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),o+=" /XYZ "+n.options.left+" "+ee+" "+n.options.zoom+"]"}o!=""&&(o+=" >>",this.internal.write(o))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,i,o,s){var a=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;a.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+i),h:u(n+o)},options:s,type:"link"})},t.textWithLink=function(r,n,i,o){var s,a,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(o.maxWidth!==void 0){a=o.maxWidth;var h=this.splitTextToSize(r,a).length;s=Math.ceil(u*h)}else a=c,s=u;return this.text(r,n,i,o),i+=.2*u,o.align==="center"&&(n-=c/2),o.align==="right"&&(n-=c),this.link(n,i-u,a,s,o),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(or.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var o=t.__arabicParser__.isInArabicSubstitutionA=function(S){return e[S.charCodeAt(0)]!==void 0},s=t.__arabicParser__.isArabicLetter=function(S){return typeof S=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(S)},a=t.__arabicParser__.isArabicEndLetter=function(S){return s(S)&&o(S)&&e[S.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(S){return s(S)&&i.indexOf(S.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(S){return s(S)&&o(S)&&e[S.charCodeAt(0)].length>=1};var u=t.__arabicParser__.arabicLetterHasFinalForm=function(S){return s(S)&&o(S)&&e[S.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(S){return s(S)&&o(S)&&e[S.charCodeAt(0)].length>=3};var h=t.__arabicParser__.arabicLetterHasMedialForm=function(S){return s(S)&&o(S)&&e[S.charCodeAt(0)].length==4},y=t.__arabicParser__.resolveLigatures=function(S){var w=0,x=r,V="",ne=0;for(w=0;w<S.length;w+=1)x[S.charCodeAt(w)]!==void 0?(ne++,typeof(x=x[S.charCodeAt(w)])=="number"&&(V+=String.fromCharCode(x),x=r,ne=0),w===S.length-1&&(x=r,V+=S.charAt(w-(ne-1)),w-=ne-1,ne=0)):(x=r,V+=S.charAt(w-ne),w-=ne,ne=0);return V};t.__arabicParser__.isArabicDiacritic=function(S){return S!==void 0&&n[S.charCodeAt(0)]!==void 0};var g=t.__arabicParser__.getCorrectForm=function(S,w,x){return s(S)?o(S)===!1?-1:!u(S)||!s(w)&&!s(x)||!s(x)&&a(w)||a(S)&&!s(w)||a(S)&&c(w)||a(S)&&a(w)?0:h(S)&&s(w)&&!a(w)&&s(x)&&u(x)?3:a(S)||!s(x)?1:2:-1},p=function(S){var w=0,x=0,V=0,ne="",X="",Q="",ee=(S=S||"").split("\\s+"),E=[];for(w=0;w<ee.length;w+=1){for(E.push(""),x=0;x<ee[w].length;x+=1)ne=ee[w][x],X=ee[w][x-1],Q=ee[w][x+1],s(ne)?(V=g(ne,X,Q),E[w]+=V!==-1?String.fromCharCode(e[ne.charCodeAt(0)][V]):ne):E[w]+=ne;E[w]=y(E[w])}return E.join(" ")},C=t.__arabicParser__.processArabic=t.processArabic=function(){var S,w=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,x=[];if(Array.isArray(w)){var V=0;for(x=[],V=0;V<w.length;V+=1)Array.isArray(w[V])?x.push([p(w[V][0]),w[V][1],w[V][2]]):x.push([p(w[V])]);S=x}else S=p(w);return typeof arguments[0]=="string"?S:(arguments[0].text=S,arguments[0])};t.events.push(["preProcessText",C])}(or.API),or.API.autoPrint=function(t){var e;switch((t=t||{}).variant=t.variant||"non-conform",t.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(a){r=a}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(a){n=isNaN(a)||Number.isInteger(a)===!1||a<0?150:a,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(a){i=isNaN(a)||Number.isInteger(a)===!1||a<0?300:a,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var o=[];Object.defineProperty(this,"childNodes",{get:function(){return o},set:function(a){o=a}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(a){s=a}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(or.API),function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(S){c=S}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(S){u=S}});var h=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return h},set:function(S){h=S}});var y=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return y},set:function(S){y=S}});var g=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return g},set:function(S){g=S}});var p=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return p},set:function(S){p=S}});var C=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return C},set:function(S){C=S}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,u){n.call(this);var h=(u=u||{}).fontSize||this.getFontSize(),y=u.font||this.getFont(),g=u.scaleFactor||this.internal.scaleFactor,p=0,C=0,S=0,w=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var x=u.maxWidth;x>0?typeof c=="string"?c=this.splitTextToSize(c,x):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(ne,X){return ne.concat(w.splitTextToSize(X,x))},[])):c=Array.isArray(c)?c:[c];for(var V=0;V<c.length;V++)p<(S=this.getStringUnitWidth(c[V],{font:y})*h)&&(p=S);return p!==0&&(C=c.length),{w:p/=g,h:Math.max((C*h*this.getLineHeightFactor()-h*(this.getLineHeightFactor()-1))/g,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new o(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=t.cell=function(){var c;c=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var u=this.internal.__cell__.lastCell,h=this.internal.__cell__.padding,y=this.internal.__cell__.margins||e,g=this.internal.__cell__.tableHeaderRow,p=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+y.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=y.top,p&&g&&(this.printHeaderRow(c.lineNumber,!0),c.y+=g[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-h,c.y+h,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+h,{align:"center",baseline:"top",maxWidth:c.width-h-h}):this.text(c.text,c.x+h,c.y+h,{align:"left",baseline:"top",maxWidth:c.width-h-h})),this.internal.__cell__.lastCell=c,this};t.table=function(c,u,h,y,g){if(n.call(this),!h)throw new Error("No data for PDF table.");var p,C,S,w,x=[],V=[],ne=[],X={},Q={},ee=[],E=[],A=(g=g||{}).autoSize||!1,T=g.printHeaders!==!1,R=g.css&&g.css["font-size"]!==void 0?16*g.css["font-size"]:g.fontSize||12,_=g.margins||Object.assign({width:this.getPageWidth()},e),I=typeof g.padding=="number"?g.padding:3,b=g.headerBackgroundColor||"#c8c8c8",G=g.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=T,this.internal.__cell__.margins=_,this.internal.__cell__.table_font_size=R,this.internal.__cell__.padding=I,this.internal.__cell__.headerBackgroundColor=b,this.internal.__cell__.headerTextColor=G,this.setFontSize(R),y==null)V=x=Object.keys(h[0]),ne=x.map(function(){return"left"});else if(Array.isArray(y)&&sn(y[0])==="object")for(x=y.map(function(k){return k.name}),V=y.map(function(k){return k.prompt||k.name||""}),ne=y.map(function(k){return k.align||"left"}),p=0;p<y.length;p+=1)Q[y[p].name]=y[p].width*(19.049976/25.4);else Array.isArray(y)&&typeof y[0]=="string"&&(V=x=y,ne=x.map(function(){return"left"}));if(A||Array.isArray(y)&&typeof y[0]=="string")for(p=0;p<x.length;p+=1){for(X[w=x[p]]=h.map(function(k){return k[w]}),this.setFont(void 0,"bold"),ee.push(this.getTextDimensions(V[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),C=X[w],this.setFont(void 0,"normal"),S=0;S<C.length;S+=1)ee.push(this.getTextDimensions(C[S],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);Q[w]=Math.max.apply(null,ee)+I+I,ee=[]}if(T){var ie={};for(p=0;p<x.length;p+=1)ie[x[p]]={},ie[x[p]].text=V[p],ie[x[p]].align=ne[p];var F=a.call(this,ie,Q);E=x.map(function(k){return new o(c,u,Q[k],F,ie[k].text,void 0,ie[k].align)}),this.setTableHeaderRow(E),this.printHeaderRow(1,!1)}var W=y.reduce(function(k,re){return k[re.name]=re.align,k},{});for(p=0;p<h.length;p+=1){"rowStart"in g&&g.rowStart instanceof Function&&g.rowStart({row:p,data:h[p]},this);var z=a.call(this,h[p],Q);for(S=0;S<x.length;S+=1){var O=h[p][x[S]];"cellStart"in g&&g.cellStart instanceof Function&&g.cellStart({row:p,col:S,data:O},this),s.call(this,new o(c,u,Q[x[S]],z,O,p+2,W[x[S]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var a=function(c,u){var h=this.internal.__cell__.padding,y=this.internal.__cell__.table_font_size,g=this.internal.scaleFactor;return Object.keys(c).map(function(p){var C=c[p];return this.splitTextToSize(C.hasOwnProperty("text")?C.text:C,u[p]-h-h)},this).map(function(p){return this.getLineHeightFactor()*p.length*y/g+h+h},this).reduce(function(p,C){return Math.max(p,C)},0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var h;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var y=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(y[0],y[1],y[2],y[3],void 0,-1)}this.setFont(void 0,"bold");for(var g=[],p=0;p<this.internal.__cell__.tableHeaderRow.length;p+=1){h=this.internal.__cell__.tableHeaderRow[p].clone(),u&&(h.y=this.internal.__cell__.margins.top||0,g.push(h)),h.lineNumber=c;var C=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,h),this.setTextColor(C)}g.length>0&&this.setTableHeaderRow(g),this.setFont(void 0,"normal"),r=!1}}(or.API);var j5={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},V5=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],bm=B5(V5),q5=[100,200,300,400,500,600,700,800,900],A7=B5(q5);function _m(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=function(o){return j5[o=o||"normal"]?o:"normal"}(t.style),n=function(o){if(!o)return 400;if(typeof o=="number")return o>=100&&o<=900&&o%100==0?o:400;if(/^\d00$/.test(o))return parseInt(o);switch(o){case"bold":return 700;case"normal":default:return 400}}(t.weight),i=function(o){return typeof bm[o=o||"normal"]=="number"?o:"normal"}(t.stretch);return{family:e,style:r,weight:n,stretch:i,src:t.src||[],ref:t.ref||{name:e,style:[i,r,n].join(" ")}}}function j0(t,e,r,n){var i;for(i=r;i>=0&&i<e.length;i+=n)if(t[e[i]])return t[e[i]];for(i=r;i>=0&&i<e.length;i-=n)if(t[e[i]])return t[e[i]]}var C7={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},V0={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function q0(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function I7(t,e,r){for(var n=(r=r||{}).defaultFontFamily||"times",i=Object.assign({},C7,r.genericFontFamilies||{}),o=null,s=null,a=0;a<e.length;++a)if(i[(o=_m(e[a])).family]&&(o.family=i[o.family]),t.hasOwnProperty(o.family)){s=t[o.family];break}if(!(s=s||t[n]))throw new Error("Could not find a font-family for the rule '"+q0(o)+"' and default family '"+n+"'.");if(s=function(c,u){if(u[c])return u[c];var h=bm[c],y=h<=bm.normal?-1:1,g=j0(u,V5,h,y);if(!g)throw new Error("Could not find a matching font-stretch value for "+c);return g}(o.stretch,s),s=function(c,u){if(u[c])return u[c];for(var h=j5[c],y=0;y<h.length;++y)if(u[h[y]])return u[h[y]];throw new Error("Could not find a matching font-style for "+c)}(o.style,s),!(s=function(c,u){if(u[c])return u[c];if(c===400&&u[500])return u[500];if(c===500&&u[400])return u[400];var h=A7[c],y=j0(u,q5,h,c<400?-1:1);if(!y)throw new Error("Could not find a matching font-weight for value "+c);return y}(o.weight,s)))throw new Error("Failed to resolve a font for the rule '"+q0(o)+"'.");return s}function z0(t){return t.trimLeft()}function $7(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function E7(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var Hd,U0,H0,gp=["times"];(function(t){var e,r,n,i,o,s,a,c,u,h=function($){return $=$||{},this.isStrokeTransparent=$.isStrokeTransparent||!1,this.strokeOpacity=$.strokeOpacity||1,this.strokeStyle=$.strokeStyle||"#000000",this.fillStyle=$.fillStyle||"#000000",this.isFillTransparent=$.isFillTransparent||!1,this.fillOpacity=$.fillOpacity||1,this.font=$.font||"10px sans-serif",this.textBaseline=$.textBaseline||"alphabetic",this.textAlign=$.textAlign||"left",this.lineWidth=$.lineWidth||1,this.lineJoin=$.lineJoin||"miter",this.lineCap=$.lineCap||"butt",this.path=$.path||[],this.transform=$.transform!==void 0?$.transform.clone():new c,this.globalCompositeOperation=$.globalCompositeOperation||"normal",this.globalAlpha=$.globalAlpha||1,this.clip_path=$.clip_path||[],this.currentPoint=$.currentPoint||new s,this.miterLimit=$.miterLimit||10,this.lastPoint=$.lastPoint||new s,this.lineDashOffset=$.lineDashOffset||0,this.lineDash=$.lineDash||[],this.margin=$.margin||[0,0,0,0],this.prevPageLastElemOffset=$.prevPageLastElemOffset||0,this.ignoreClearRect=typeof $.ignoreClearRect!="boolean"||$.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new y(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,s=this.internal.Point,a=this.internal.Rectangle,c=this.internal.Matrix,u=new h}]);var y=function($){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var D=$;Object.defineProperty(this,"pdf",{get:function(){return D}});var H=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return H},set:function(le){H=!!le}});var L=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return L},set:function(le){L=!!le}});var j=0;Object.defineProperty(this,"posX",{get:function(){return j},set:function(le){isNaN(le)||(j=le)}});var oe=0;Object.defineProperty(this,"posY",{get:function(){return oe},set:function(le){isNaN(le)||(oe=le)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(le){var q;typeof le=="number"?q=[le,le,le,le]:((q=new Array(4))[0]=le[0],q[1]=le.length>=2?le[1]:q[0],q[2]=le.length>=3?le[2]:q[0],q[3]=le.length>=4?le[3]:q[1]),u.margin=q}});var K=!1;Object.defineProperty(this,"autoPaging",{get:function(){return K},set:function(le){K=le}});var Z=0;Object.defineProperty(this,"lastBreak",{get:function(){return Z},set:function(le){Z=le}});var J=[];Object.defineProperty(this,"pageBreaks",{get:function(){return J},set:function(le){J=le}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(le){le instanceof h&&(u=le)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(le){u.path=le}});var Y=[];Object.defineProperty(this,"ctxStack",{get:function(){return Y},set:function(le){Y=le}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(le){var q;q=g(le),this.ctx.fillStyle=q.style,this.ctx.isFillTransparent=q.a===0,this.ctx.fillOpacity=q.a,this.pdf.setFillColor(q.r,q.g,q.b,{a:q.a}),this.pdf.setTextColor(q.r,q.g,q.b,{a:q.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(le){var q=g(le);this.ctx.strokeStyle=q.style,this.ctx.isStrokeTransparent=q.a===0,this.ctx.strokeOpacity=q.a,q.a===0?this.pdf.setDrawColor(255,255,255):(q.a,this.pdf.setDrawColor(q.r,q.g,q.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(le){["butt","round","square"].indexOf(le)!==-1&&(this.ctx.lineCap=le,this.pdf.setLineCap(le))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(le){isNaN(le)||(this.ctx.lineWidth=le,this.pdf.setLineWidth(le))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(le){["bevel","round","miter"].indexOf(le)!==-1&&(this.ctx.lineJoin=le,this.pdf.setLineJoin(le))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(le){isNaN(le)||(this.ctx.miterLimit=le,this.pdf.setMiterLimit(le))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(le){this.ctx.textBaseline=le}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(le){["right","end","center","left","start"].indexOf(le)!==-1&&(this.ctx.textAlign=le)}});var U=null;function ae(le,q){if(U===null){var ce=function(Se){var me=[];return Object.keys(Se).forEach(function(Pe){Se[Pe].forEach(function(xe){var he=null;switch(xe){case"bold":he={family:Pe,weight:"bold"};break;case"italic":he={family:Pe,style:"italic"};break;case"bolditalic":he={family:Pe,weight:"bold",style:"italic"};break;case"":case"normal":he={family:Pe}}he!==null&&(he.ref={name:Pe,style:xe},me.push(he))})}),me}(le.getFontList());U=function(Se){for(var me={},Pe=0;Pe<Se.length;++Pe){var xe=_m(Se[Pe]),he=xe.family,ve=xe.stretch,De=xe.style,ke=xe.weight;me[he]=me[he]||{},me[he][ve]=me[he][ve]||{},me[he][ve][De]=me[he][ve][De]||{},me[he][ve][De][ke]=xe}return me}(ce.concat(q))}return U}var ue=null;Object.defineProperty(this,"fontFaces",{get:function(){return ue},set:function(le){U=null,ue=le}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(le){var q;if(this.ctx.font=le,(q=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(le))!==null){var ce=q[1];q[2];var Se=q[3],me=q[4];q[5];var Pe=q[6],xe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(me)[2];me=Math.floor(xe==="px"?parseFloat(me)*this.pdf.internal.scaleFactor:xe==="em"?parseFloat(me)*this.pdf.getFontSize():parseFloat(me)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(me);var he=function(Re){var He,Me,Ze=[],Ye=Re.trim();if(Ye==="")return gp;if(Ye in V0)return[V0[Ye]];for(;Ye!=="";){switch(Me=null,He=(Ye=z0(Ye)).charAt(0)){case'"':case"'":Me=$7(Ye.substring(1),He);break;default:Me=E7(Ye)}if(Me===null||(Ze.push(Me[0]),(Ye=z0(Me[1]))!==""&&Ye.charAt(0)!==","))return gp;Ye=Ye.replace(/^,/,"")}return Ze}(Pe);if(this.fontFaces){var ve=I7(ae(this.pdf,this.fontFaces),he.map(function(Re){return{family:Re,stretch:"normal",weight:Se,style:ce}}));this.pdf.setFont(ve.ref.name,ve.ref.style)}else{var De="";(Se==="bold"||parseInt(Se,10)>=700||ce==="bold")&&(De="bold"),ce==="italic"&&(De+="italic"),De.length===0&&(De="normal");for(var ke="",Ce={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Le=0;Le<he.length;Le++){if(this.pdf.internal.getFont(he[Le],De,{noFallback:!0,disableWarning:!0})!==void 0){ke=he[Le];break}if(De==="bolditalic"&&this.pdf.internal.getFont(he[Le],"bold",{noFallback:!0,disableWarning:!0})!==void 0)ke=he[Le],De="bold";else if(this.pdf.internal.getFont(he[Le],"normal",{noFallback:!0,disableWarning:!0})!==void 0){ke=he[Le],De="normal";break}}if(ke===""){for(var Ie=0;Ie<he.length;Ie++)if(Ce[he[Ie]]){ke=Ce[he[Ie]];break}}ke=ke===""?"Times":ke,this.pdf.setFont(ke,De)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(le){this.ctx.globalCompositeOperation=le}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(le){this.ctx.globalAlpha=le}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(le){this.ctx.lineDashOffset=le,re.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(le){this.ctx.lineDash=le,re.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(le){this.ctx.ignoreClearRect=!!le}})};y.prototype.setLineDash=function($){this.lineDash=$},y.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},y.prototype.fill=function(){X.call(this,"fill",!1)},y.prototype.stroke=function(){X.call(this,"stroke",!1)},y.prototype.beginPath=function(){this.path=[{type:"begin"}]},y.prototype.moveTo=function($,D){if(isNaN($)||isNaN(D))throw hn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var H=this.ctx.transform.applyToPoint(new s($,D));this.path.push({type:"mt",x:H.x,y:H.y}),this.ctx.lastPoint=new s($,D)},y.prototype.closePath=function(){var $=new s(0,0),D=0;for(D=this.path.length-1;D!==-1;D--)if(this.path[D].type==="begin"&&sn(this.path[D+1])==="object"&&typeof this.path[D+1].x=="number"){$=new s(this.path[D+1].x,this.path[D+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s($.x,$.y)},y.prototype.lineTo=function($,D){if(isNaN($)||isNaN(D))throw hn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var H=this.ctx.transform.applyToPoint(new s($,D));this.path.push({type:"lt",x:H.x,y:H.y}),this.ctx.lastPoint=new s(H.x,H.y)},y.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),X.call(this,null,!0)},y.prototype.quadraticCurveTo=function($,D,H,L){if(isNaN(H)||isNaN(L)||isNaN($)||isNaN(D))throw hn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var j=this.ctx.transform.applyToPoint(new s(H,L)),oe=this.ctx.transform.applyToPoint(new s($,D));this.path.push({type:"qct",x1:oe.x,y1:oe.y,x:j.x,y:j.y}),this.ctx.lastPoint=new s(j.x,j.y)},y.prototype.bezierCurveTo=function($,D,H,L,j,oe){if(isNaN(j)||isNaN(oe)||isNaN($)||isNaN(D)||isNaN(H)||isNaN(L))throw hn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var K=this.ctx.transform.applyToPoint(new s(j,oe)),Z=this.ctx.transform.applyToPoint(new s($,D)),J=this.ctx.transform.applyToPoint(new s(H,L));this.path.push({type:"bct",x1:Z.x,y1:Z.y,x2:J.x,y2:J.y,x:K.x,y:K.y}),this.ctx.lastPoint=new s(K.x,K.y)},y.prototype.arc=function($,D,H,L,j,oe){if(isNaN($)||isNaN(D)||isNaN(H)||isNaN(L)||isNaN(j))throw hn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(oe=!!oe,!this.ctx.transform.isIdentity){var K=this.ctx.transform.applyToPoint(new s($,D));$=K.x,D=K.y;var Z=this.ctx.transform.applyToPoint(new s(0,H)),J=this.ctx.transform.applyToPoint(new s(0,0));H=Math.sqrt(Math.pow(Z.x-J.x,2)+Math.pow(Z.y-J.y,2))}Math.abs(j-L)>=2*Math.PI&&(L=0,j=2*Math.PI),this.path.push({type:"arc",x:$,y:D,radius:H,startAngle:L,endAngle:j,counterclockwise:oe})},y.prototype.arcTo=function($,D,H,L,j){throw new Error("arcTo not implemented.")},y.prototype.rect=function($,D,H,L){if(isNaN($)||isNaN(D)||isNaN(H)||isNaN(L))throw hn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo($,D),this.lineTo($+H,D),this.lineTo($+H,D+L),this.lineTo($,D+L),this.lineTo($,D),this.lineTo($+H,D),this.lineTo($,D)},y.prototype.fillRect=function($,D,H,L){if(isNaN($)||isNaN(D)||isNaN(H)||isNaN(L))throw hn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!p.call(this)){var j={};this.lineCap!=="butt"&&(j.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(j.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect($,D,H,L),this.fill(),j.hasOwnProperty("lineCap")&&(this.lineCap=j.lineCap),j.hasOwnProperty("lineJoin")&&(this.lineJoin=j.lineJoin)}},y.prototype.strokeRect=function($,D,H,L){if(isNaN($)||isNaN(D)||isNaN(H)||isNaN(L))throw hn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");C.call(this)||(this.beginPath(),this.rect($,D,H,L),this.stroke())},y.prototype.clearRect=function($,D,H,L){if(isNaN($)||isNaN(D)||isNaN(H)||isNaN(L))throw hn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect($,D,H,L))},y.prototype.save=function($){$=typeof $!="boolean"||$;for(var D=this.pdf.internal.getCurrentPageInfo().pageNumber,H=0;H<this.pdf.internal.getNumberOfPages();H++)this.pdf.setPage(H+1),this.pdf.internal.out("q");if(this.pdf.setPage(D),$){this.ctx.fontSize=this.pdf.internal.getFontSize();var L=new h(this.ctx);this.ctxStack.push(this.ctx),this.ctx=L}},y.prototype.restore=function($){$=typeof $!="boolean"||$;for(var D=this.pdf.internal.getCurrentPageInfo().pageNumber,H=0;H<this.pdf.internal.getNumberOfPages();H++)this.pdf.setPage(H+1),this.pdf.internal.out("Q");this.pdf.setPage(D),$&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},y.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var g=function($){var D,H,L,j;if($.isCanvasGradient===!0&&($=$.getColor()),!$)return{r:0,g:0,b:0,a:0,style:$};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test($))D=0,H=0,L=0,j=0;else{var oe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec($);if(oe!==null)D=parseInt(oe[1]),H=parseInt(oe[2]),L=parseInt(oe[3]),j=1;else if((oe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec($))!==null)D=parseInt(oe[1]),H=parseInt(oe[2]),L=parseInt(oe[3]),j=parseFloat(oe[4]);else{if(j=1,typeof $=="string"&&$.charAt(0)!=="#"){var K=new L5($);$=K.ok?K.toHex():"#000000"}$.length===4?(D=$.substring(1,2),D+=D,H=$.substring(2,3),H+=H,L=$.substring(3,4),L+=L):(D=$.substring(1,3),H=$.substring(3,5),L=$.substring(5,7)),D=parseInt(D,16),H=parseInt(H,16),L=parseInt(L,16)}}return{r:D,g:H,b:L,a:j,style:$}},p=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},C=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};y.prototype.fillText=function($,D,H,L){if(isNaN(D)||isNaN(H)||typeof $!="string")throw hn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(L=isNaN(L)?void 0:L,!p.call(this)){var j=z(this.ctx.transform.rotation),oe=this.ctx.transform.scaleX;I.call(this,{text:$,x:D,y:H,scale:oe,angle:j,align:this.textAlign,maxWidth:L})}},y.prototype.strokeText=function($,D,H,L){if(isNaN(D)||isNaN(H)||typeof $!="string")throw hn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!C.call(this)){L=isNaN(L)?void 0:L;var j=z(this.ctx.transform.rotation),oe=this.ctx.transform.scaleX;I.call(this,{text:$,x:D,y:H,scale:oe,renderingMode:"stroke",angle:j,align:this.textAlign,maxWidth:L})}},y.prototype.measureText=function($){if(typeof $!="string")throw hn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var D=this.pdf,H=this.pdf.internal.scaleFactor,L=D.internal.getFontSize(),j=D.getStringUnitWidth($)*L/D.internal.scaleFactor,oe=function(K){var Z=(K=K||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Z}}),this};return new oe({width:j*=Math.round(96*H/72*1e4)/1e4})},y.prototype.scale=function($,D){if(isNaN($)||isNaN(D))throw hn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var H=new c($,0,0,D,0,0);this.ctx.transform=this.ctx.transform.multiply(H)},y.prototype.rotate=function($){if(isNaN($))throw hn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var D=new c(Math.cos($),Math.sin($),-Math.sin($),Math.cos($),0,0);this.ctx.transform=this.ctx.transform.multiply(D)},y.prototype.translate=function($,D){if(isNaN($)||isNaN(D))throw hn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var H=new c(1,0,0,1,$,D);this.ctx.transform=this.ctx.transform.multiply(H)},y.prototype.transform=function($,D,H,L,j,oe){if(isNaN($)||isNaN(D)||isNaN(H)||isNaN(L)||isNaN(j)||isNaN(oe))throw hn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var K=new c($,D,H,L,j,oe);this.ctx.transform=this.ctx.transform.multiply(K)},y.prototype.setTransform=function($,D,H,L,j,oe){$=isNaN($)?1:$,D=isNaN(D)?0:D,H=isNaN(H)?0:H,L=isNaN(L)?1:L,j=isNaN(j)?0:j,oe=isNaN(oe)?0:oe,this.ctx.transform=new c($,D,H,L,j,oe)};var S=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};y.prototype.drawImage=function($,D,H,L,j,oe,K,Z,J){var Y=this.pdf.getImageProperties($),U=1,ae=1,ue=1,le=1;L!==void 0&&Z!==void 0&&(ue=Z/L,le=J/j,U=Y.width/L*Z/L,ae=Y.height/j*J/j),oe===void 0&&(oe=D,K=H,D=0,H=0),L!==void 0&&Z===void 0&&(Z=L,J=j),L===void 0&&Z===void 0&&(Z=Y.width,J=Y.height);for(var q,ce=this.ctx.transform.decompose(),Se=z(ce.rotate.shx),me=new c,Pe=(me=(me=(me=me.multiply(ce.translate)).multiply(ce.skew)).multiply(ce.scale)).applyToRectangle(new a(oe-D*ue,K-H*le,L*U,j*ae)),xe=w.call(this,Pe),he=[],ve=0;ve<xe.length;ve+=1)he.indexOf(xe[ve])===-1&&he.push(xe[ve]);if(ne(he),this.autoPaging)for(var De=he[0],ke=he[he.length-1],Ce=De;Ce<ke+1;Ce++){this.pdf.setPage(Ce);var Le=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ie=Ce===1?this.posY+this.margin[0]:this.margin[0],Re=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],He=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Me=Ce===1?0:Re+(Ce-2)*He;if(this.ctx.clip_path.length!==0){var Ze=this.path;q=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=V(q,this.posX+this.margin[3],-Me+Ie+this.ctx.prevPageLastElemOffset),Q.call(this,"fill",!0),this.path=Ze}var Ye=JSON.parse(JSON.stringify(Pe));Ye=V([Ye],this.posX+this.margin[3],-Me+Ie+this.ctx.prevPageLastElemOffset)[0];var ut=(Ce>De||Ce<ke)&&S.call(this);ut&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Le,He,null).clip().discardPath()),this.pdf.addImage($,"JPEG",Ye.x,Ye.y,Ye.w,Ye.h,null,null,Se),ut&&this.pdf.restoreGraphicsState()}else this.pdf.addImage($,"JPEG",Pe.x,Pe.y,Pe.w,Pe.h,null,null,Se)};var w=function($,D,H){var L=[];D=D||this.pdf.internal.pageSize.width,H=H||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var j=this.posY+this.ctx.prevPageLastElemOffset;switch($.type){default:case"mt":case"lt":L.push(Math.floor(($.y+j)/H)+1);break;case"arc":L.push(Math.floor(($.y+j-$.radius)/H)+1),L.push(Math.floor(($.y+j+$.radius)/H)+1);break;case"qct":var oe=O(this.ctx.lastPoint.x,this.ctx.lastPoint.y,$.x1,$.y1,$.x,$.y);L.push(Math.floor((oe.y+j)/H)+1),L.push(Math.floor((oe.y+oe.h+j)/H)+1);break;case"bct":var K=k(this.ctx.lastPoint.x,this.ctx.lastPoint.y,$.x1,$.y1,$.x2,$.y2,$.x,$.y);L.push(Math.floor((K.y+j)/H)+1),L.push(Math.floor((K.y+K.h+j)/H)+1);break;case"rect":L.push(Math.floor(($.y+j)/H)+1),L.push(Math.floor(($.y+$.h+j)/H)+1)}for(var Z=0;Z<L.length;Z+=1)for(;this.pdf.internal.getNumberOfPages()<L[Z];)x.call(this);return L},x=function(){var $=this.fillStyle,D=this.strokeStyle,H=this.font,L=this.lineCap,j=this.lineWidth,oe=this.lineJoin;this.pdf.addPage(),this.fillStyle=$,this.strokeStyle=D,this.font=H,this.lineCap=L,this.lineWidth=j,this.lineJoin=oe},V=function($,D,H){for(var L=0;L<$.length;L++)switch($[L].type){case"bct":$[L].x2+=D,$[L].y2+=H;case"qct":$[L].x1+=D,$[L].y1+=H;case"mt":case"lt":case"arc":default:$[L].x+=D,$[L].y+=H}return $},ne=function($){return $.sort(function(D,H){return D-H})},X=function($,D){for(var H,L,j=this.fillStyle,oe=this.strokeStyle,K=this.lineCap,Z=this.lineWidth,J=Math.abs(Z*this.ctx.transform.scaleX),Y=this.lineJoin,U=JSON.parse(JSON.stringify(this.path)),ae=JSON.parse(JSON.stringify(this.path)),ue=[],le=0;le<ae.length;le++)if(ae[le].x!==void 0)for(var q=w.call(this,ae[le]),ce=0;ce<q.length;ce+=1)ue.indexOf(q[ce])===-1&&ue.push(q[ce]);for(var Se=0;Se<ue.length;Se++)for(;this.pdf.internal.getNumberOfPages()<ue[Se];)x.call(this);if(ne(ue),this.autoPaging)for(var me=ue[0],Pe=ue[ue.length-1],xe=me;xe<Pe+1;xe++){this.pdf.setPage(xe),this.fillStyle=j,this.strokeStyle=oe,this.lineCap=K,this.lineWidth=J,this.lineJoin=Y;var he=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ve=xe===1?this.posY+this.margin[0]:this.margin[0],De=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ke=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ce=xe===1?0:De+(xe-2)*ke;if(this.ctx.clip_path.length!==0){var Le=this.path;H=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=V(H,this.posX+this.margin[3],-Ce+ve+this.ctx.prevPageLastElemOffset),Q.call(this,$,!0),this.path=Le}if(L=JSON.parse(JSON.stringify(U)),this.path=V(L,this.posX+this.margin[3],-Ce+ve+this.ctx.prevPageLastElemOffset),D===!1||xe===0){var Ie=(xe>me||xe<Pe)&&S.call(this);Ie&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],he,ke,null).clip().discardPath()),Q.call(this,$,D),Ie&&this.pdf.restoreGraphicsState()}this.lineWidth=Z}else this.lineWidth=J,Q.call(this,$,D),this.lineWidth=Z;this.path=U},Q=function($,D){if(($!=="stroke"||D||!C.call(this))&&($==="stroke"||D||!p.call(this))){for(var H,L,j=[],oe=this.path,K=0;K<oe.length;K++){var Z=oe[K];switch(Z.type){case"begin":j.push({begin:!0});break;case"close":j.push({close:!0});break;case"mt":j.push({start:Z,deltas:[],abs:[]});break;case"lt":var J=j.length;if(oe[K-1]&&!isNaN(oe[K-1].x)&&(H=[Z.x-oe[K-1].x,Z.y-oe[K-1].y],J>0)){for(;J>=0;J--)if(j[J-1].close!==!0&&j[J-1].begin!==!0){j[J-1].deltas.push(H),j[J-1].abs.push(Z);break}}break;case"bct":H=[Z.x1-oe[K-1].x,Z.y1-oe[K-1].y,Z.x2-oe[K-1].x,Z.y2-oe[K-1].y,Z.x-oe[K-1].x,Z.y-oe[K-1].y],j[j.length-1].deltas.push(H);break;case"qct":var Y=oe[K-1].x+2/3*(Z.x1-oe[K-1].x),U=oe[K-1].y+2/3*(Z.y1-oe[K-1].y),ae=Z.x+2/3*(Z.x1-Z.x),ue=Z.y+2/3*(Z.y1-Z.y),le=Z.x,q=Z.y;H=[Y-oe[K-1].x,U-oe[K-1].y,ae-oe[K-1].x,ue-oe[K-1].y,le-oe[K-1].x,q-oe[K-1].y],j[j.length-1].deltas.push(H);break;case"arc":j.push({deltas:[],abs:[],arc:!0}),Array.isArray(j[j.length-1].abs)&&j[j.length-1].abs.push(Z)}}L=D?null:$==="stroke"?"stroke":"fill";for(var ce=!1,Se=0;Se<j.length;Se++)if(j[Se].arc)for(var me=j[Se].abs,Pe=0;Pe<me.length;Pe++){var xe=me[Pe];xe.type==="arc"?A.call(this,xe.x,xe.y,xe.radius,xe.startAngle,xe.endAngle,xe.counterclockwise,void 0,D,!ce):b.call(this,xe.x,xe.y),ce=!0}else if(j[Se].close===!0)this.pdf.internal.out("h"),ce=!1;else if(j[Se].begin!==!0){var he=j[Se].start.x,ve=j[Se].start.y;G.call(this,j[Se].deltas,he,ve),ce=!0}L&&T.call(this,L),D&&R.call(this)}},ee=function($){var D=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,H=D*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return $-H;case"top":return $+D-H;case"hanging":return $+D-2*H;case"middle":return $+D/2-H;case"ideographic":return $;case"alphabetic":default:return $}},E=function($){return $+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};y.prototype.createLinearGradient=function(){var $=function(){};return $.colorStops=[],$.addColorStop=function(D,H){this.colorStops.push([D,H])},$.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},$.isCanvasGradient=!0,$},y.prototype.createPattern=function(){return this.createLinearGradient()},y.prototype.createRadialGradient=function(){return this.createLinearGradient()};var A=function($,D,H,L,j,oe,K,Z,J){for(var Y=F.call(this,H,L,j,oe),U=0;U<Y.length;U++){var ae=Y[U];U===0&&(J?_.call(this,ae.x1+$,ae.y1+D):b.call(this,ae.x1+$,ae.y1+D)),ie.call(this,$,D,ae.x2,ae.y2,ae.x3,ae.y3,ae.x4,ae.y4)}Z?R.call(this):T.call(this,K)},T=function($){switch($){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},R=function(){this.pdf.clip(),this.pdf.discardPath()},_=function($,D){this.pdf.internal.out(r($)+" "+n(D)+" m")},I=function($){var D;switch($.align){case"right":case"end":D="right";break;case"center":D="center";break;case"left":case"start":default:D="left"}var H=this.pdf.getTextDimensions($.text),L=ee.call(this,$.y),j=E.call(this,L)-H.h,oe=this.ctx.transform.applyToPoint(new s($.x,L)),K=this.ctx.transform.decompose(),Z=new c;Z=(Z=(Z=Z.multiply(K.translate)).multiply(K.skew)).multiply(K.scale);for(var J,Y,U,ae=this.ctx.transform.applyToRectangle(new a($.x,L,H.w,H.h)),ue=Z.applyToRectangle(new a($.x,j,H.w,H.h)),le=w.call(this,ue),q=[],ce=0;ce<le.length;ce+=1)q.indexOf(le[ce])===-1&&q.push(le[ce]);if(ne(q),this.autoPaging)for(var Se=q[0],me=q[q.length-1],Pe=Se;Pe<me+1;Pe++){this.pdf.setPage(Pe);var xe=Pe===1?this.posY+this.margin[0]:this.margin[0],he=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ve=this.pdf.internal.pageSize.height-this.margin[2],De=ve-this.margin[0],ke=this.pdf.internal.pageSize.width-this.margin[1],Ce=ke-this.margin[3],Le=Pe===1?0:he+(Pe-2)*De;if(this.ctx.clip_path.length!==0){var Ie=this.path;J=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=V(J,this.posX+this.margin[3],-1*Le+xe),Q.call(this,"fill",!0),this.path=Ie}var Re=V([JSON.parse(JSON.stringify(ue))],this.posX+this.margin[3],-Le+xe+this.ctx.prevPageLastElemOffset)[0];$.scale>=.01&&(Y=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Y*$.scale),U=this.lineWidth,this.lineWidth=U*$.scale);var He=this.autoPaging!=="text";if(He||Re.y+Re.h<=ve){if(He||Re.y>=xe&&Re.x<=ke){var Me=He?$.text:this.pdf.splitTextToSize($.text,$.maxWidth||ke-Re.x)[0],Ze=V([JSON.parse(JSON.stringify(ae))],this.posX+this.margin[3],-Le+xe+this.ctx.prevPageLastElemOffset)[0],Ye=He&&(Pe>Se||Pe<me)&&S.call(this);Ye&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ce,De,null).clip().discardPath()),this.pdf.text(Me,Ze.x,Ze.y,{angle:$.angle,align:D,renderingMode:$.renderingMode}),Ye&&this.pdf.restoreGraphicsState()}}else Re.y<ve&&(this.ctx.prevPageLastElemOffset+=ve-Re.y);$.scale>=.01&&(this.pdf.setFontSize(Y),this.lineWidth=U)}else $.scale>=.01&&(Y=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Y*$.scale),U=this.lineWidth,this.lineWidth=U*$.scale),this.pdf.text($.text,oe.x+this.posX,oe.y+this.posY,{angle:$.angle,align:D,renderingMode:$.renderingMode,maxWidth:$.maxWidth}),$.scale>=.01&&(this.pdf.setFontSize(Y),this.lineWidth=U)},b=function($,D,H,L){H=H||0,L=L||0,this.pdf.internal.out(r($+H)+" "+n(D+L)+" l")},G=function($,D,H){return this.pdf.lines($,D,H,null,null)},ie=function($,D,H,L,j,oe,K,Z){this.pdf.internal.out([e(i(H+$)),e(o(L+D)),e(i(j+$)),e(o(oe+D)),e(i(K+$)),e(o(Z+D)),"c"].join(" "))},F=function($,D,H,L){for(var j=2*Math.PI,oe=Math.PI/2;D>H;)D-=j;var K=Math.abs(H-D);K<j&&L&&(K=j-K);for(var Z=[],J=L?-1:1,Y=D;K>1e-5;){var U=Y+J*Math.min(K,oe);Z.push(W.call(this,$,Y,U)),K-=Math.abs(U-Y),Y=U}return Z},W=function($,D,H){var L=(H-D)/2,j=$*Math.cos(L),oe=$*Math.sin(L),K=j,Z=-oe,J=K*K+Z*Z,Y=J+K*j+Z*oe,U=4/3*(Math.sqrt(2*J*Y)-Y)/(K*oe-Z*j),ae=K-U*Z,ue=Z+U*K,le=ae,q=-ue,ce=L+D,Se=Math.cos(ce),me=Math.sin(ce);return{x1:$*Math.cos(D),y1:$*Math.sin(D),x2:ae*Se-ue*me,y2:ae*me+ue*Se,x3:le*Se-q*me,y3:le*me+q*Se,x4:$*Math.cos(H),y4:$*Math.sin(H)}},z=function($){return 180*$/Math.PI},O=function($,D,H,L,j,oe){var K=$+.5*(H-$),Z=D+.5*(L-D),J=j+.5*(H-j),Y=oe+.5*(L-oe),U=Math.min($,j,K,J),ae=Math.max($,j,K,J),ue=Math.min(D,oe,Z,Y),le=Math.max(D,oe,Z,Y);return new a(U,ue,ae-U,le-ue)},k=function($,D,H,L,j,oe,K,Z){var J,Y,U,ae,ue,le,q,ce,Se,me,Pe,xe,he,ve,De=H-$,ke=L-D,Ce=j-H,Le=oe-L,Ie=K-j,Re=Z-oe;for(Y=0;Y<41;Y++)Se=(q=(U=$+(J=Y/40)*De)+J*((ue=H+J*Ce)-U))+J*(ue+J*(j+J*Ie-ue)-q),me=(ce=(ae=D+J*ke)+J*((le=L+J*Le)-ae))+J*(le+J*(oe+J*Re-le)-ce),Y==0?(Pe=Se,xe=me,he=Se,ve=me):(Pe=Math.min(Pe,Se),xe=Math.min(xe,me),he=Math.max(he,Se),ve=Math.max(ve,me));return new a(Math.round(Pe),Math.round(xe),Math.round(he-Pe),Math.round(ve-xe))},re=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var $,D,H=($=this.ctx.lineDash,D=this.ctx.lineDashOffset,JSON.stringify({lineDash:$,lineDashOffset:D}));this.prevLineDash!==H&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=H)}}})(or.API),function(t){var e=function(o){var s,a,c,u,h,y,g,p,C,S;for(a=[],c=0,u=(o+=s="\0\0\0\0".slice(o.length%4||4)).length;u>c;c+=4)(h=(o.charCodeAt(c)<<24)+(o.charCodeAt(c+1)<<16)+(o.charCodeAt(c+2)<<8)+o.charCodeAt(c+3))!==0?(y=(h=((h=((h=((h=(h-(S=h%85))/85)-(C=h%85))/85)-(p=h%85))/85)-(g=h%85))/85)%85,a.push(y+33,g+33,p+33,C+33,S+33)):a.push(122);return function(w,x){for(var V=x;V>0;V--)w.pop()}(a,s.length),String.fromCharCode.apply(String,a)+"~>"},r=function(o){var s,a,c,u,h,y=String,g="length",p=255,C="charCodeAt",S="slice",w="replace";for(o[S](-2),o=o[S](0,-2)[w](/\s/g,"")[w]("z","!!!!!"),c=[],u=0,h=(o+=s="uuuuu"[S](o[g]%5||5))[g];h>u;u+=5)a=52200625*(o[C](u)-33)+614125*(o[C](u+1)-33)+7225*(o[C](u+2)-33)+85*(o[C](u+3)-33)+(o[C](u+4)-33),c.push(p&a>>24,p&a>>16,p&a>>8,p&a);return function(x,V){for(var ne=V;ne>0;ne--)x.pop()}(c,s[g]),y.fromCharCode.apply(y,c)},n=function(o){var s=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),s.test(o)===!1)return"";for(var a="",c=0;c<o.length;c+=2)a+=String.fromCharCode("0x"+(o[c]+o[c+1]));return a},i=function(o){for(var s=new Uint8Array(o.length),a=o.length;a--;)s[a]=o.charCodeAt(a);return o=(s=pm(s)).reduce(function(c,u){return c+String.fromCharCode(u)},"")};t.processDataByFilters=function(o,s){var a=0,c=o||"",u=[];for(typeof(s=s||[])=="string"&&(s=[s]),a=0;a<s.length;a+=1)switch(s[a]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=e(c),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=n(c),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map(function(h){return("0"+h.charCodeAt().toString(16)).slice(-2)}).join("")+">",u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=i(c),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+s[a]+'" is not implemented')}return{data:c,reverseChain:u.reverse().join(" ")}}}(or.API),function(t){t.loadFile=function(e,r,n){return function(i,o,s){o=o!==!1,s=typeof s=="function"?s:function(){};var a=void 0;try{a=function(c,u,h){var y=new XMLHttpRequest,g=0,p=function(C){var S=C.length,w=[],x=String.fromCharCode;for(g=0;g<S;g+=1)w.push(x(255&C.charCodeAt(g)));return w.join("")};if(y.open("GET",c,!u),y.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(y.onload=function(){y.status===200?h(p(this.responseText)):h(void 0)}),y.send(null),u&&y.status===200)return p(y.responseText)}(i,o,s)}catch{}return a}(e,r,n)},t.loadImageFile=t.loadFile}(or.API),function(t){function e(){return(cr.html2canvas?Promise.resolve(cr.html2canvas):Ni(()=>import("./html2canvas.esm-BfxBtG_O.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load html2canvas: "+s))}).then(function(s){return s.default?s.default:s})}function r(){return(cr.DOMPurify?Promise.resolve(cr.DOMPurify):Ni(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load dompurify: "+s))}).then(function(s){return s.default?s.default:s})}var n=function(s){var a=sn(s);return a==="undefined"?"undefined":a==="string"||s instanceof String?"string":a==="number"||s instanceof Number?"number":a==="function"||s instanceof Function?"function":s&&s.constructor===Array?"array":s&&s.nodeType===1?"element":a==="object"?"object":"unknown"},i=function(s,a){var c=document.createElement(s);for(var u in a.className&&(c.className=a.className),a.innerHTML&&a.dompurify&&(c.innerHTML=a.dompurify.sanitize(a.innerHTML)),a.style)c.style[u]=a.style[u];return c},o=function s(a){var c=Object.assign(s.convert(Promise.resolve()),JSON.parse(JSON.stringify(s.template))),u=s.convert(Promise.resolve(),c);return u=(u=u.setProgress(1,s,1,[s])).set(a)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(s,a){return s.__proto__=a||o.prototype,s},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(s,a){return this.then(function(){switch(a=a||function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(s)){case"string":return this.then(r).then(function(c){return this.set({src:i("div",{innerHTML:s,dompurify:c})})});case"element":return this.set({src:s});case"canvas":return this.set({canvas:s});case"img":return this.set({img:s});default:return this.error("Unknown source type.")}})},o.prototype.to=function(s){switch(s){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var s={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},a=function c(u,h){for(var y=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),g=u.firstChild;g;g=g.nextSibling)h!==!0&&g.nodeType===1&&g.nodeName==="SCRIPT"||y.appendChild(c(g,h));return u.nodeType===1&&(u.nodeName==="CANVAS"?(y.width=u.width,y.height=u.height,y.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(y.value=u.value),y.addEventListener("load",function(){y.scrollTop=u.scrollTop,y.scrollLeft=u.scrollLeft},!0)),y}(this.prop.src,this.opt.html2canvas.javascriptEnabled);a.tagName==="BODY"&&(s.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:s}),this.prop.container.appendChild(a),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(e).then(function(a){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,a(this.prop.container,c)}).then(function(a){(this.opt.html2canvas.onrendered||function(){})(a),this.prop.canvas=a,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(e).then(function(a){var c=this.opt.jsPDF,u=this.opt.fontFaces,h=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,y=Object.assign({async:!0,allowTaint:!0,scale:h,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete y.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=u,u)for(var g=0;g<u.length;++g){var p=u[g],C=p.src.find(function(S){return S.format==="truetype"});C&&c.addFont(C.url,p.ref.name,p.ref.style)}return y.windowHeight=y.windowHeight||0,y.windowHeight=y.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):y.windowHeight,c.context2d.save(!0),a(this.prop.container,y)}).then(function(a){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(a),this.prop.canvas=a,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var s=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=s})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(s,a,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(s,a):this.outputPdf(s,a)},o.prototype.outputPdf=function(s,a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(s,a)})},o.prototype.outputImg=function(s){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(s){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+s+'" is not supported.'}})},o.prototype.save=function(s){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(s?{filename:s}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(s){if(n(s)!=="object")return this;var a=Object.keys(s||{}).map(function(c){if(c in o.template.prop)return function(){this.prop[c]=s[c]};switch(c){case"margin":return this.setMargin.bind(this,s.margin);case"jsPDF":return function(){return this.opt.jsPDF=s.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,s.pageSize);default:return function(){this.opt[c]=s[c]}}},this);return this.then(function(){return this.thenList(a)})},o.prototype.get=function(s,a){return this.then(function(){var c=s in o.template.prop?this.prop[s]:this.opt[s];return a?a(c):c})},o.prototype.setMargin=function(s){return this.then(function(){switch(n(s)){case"number":s=[s,s,s,s];case"array":if(s.length===2&&(s=[s[0],s[1],s[0],s[1]]),s.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=s}).then(this.setPageSize)},o.prototype.setPageSize=function(s){function a(c,u){return Math.floor(c*u/72*96)}return this.then(function(){(s=s||or.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(s.inner={width:s.width-this.opt.margin[1]-this.opt.margin[3],height:s.height-this.opt.margin[0]-this.opt.margin[2]},s.inner.px={width:a(s.inner.width,s.k),height:a(s.inner.height,s.k)},s.inner.ratio=s.inner.height/s.inner.width),this.prop.pageSize=s})},o.prototype.setProgress=function(s,a,c,u){return s!=null&&(this.progress.val=s),a!=null&&(this.progress.state=a),c!=null&&(this.progress.n=c),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(s,a,c,u){return this.setProgress(s?this.progress.val+s:null,a||null,c?this.progress.n+c:null,u?this.progress.stack.concat(u):null)},o.prototype.then=function(s,a){var c=this;return this.thenCore(s,a,function(u,h){return c.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(y){return c.updateProgress(null,u),y}).then(u,h).then(function(y){return c.updateProgress(1),y})})},o.prototype.thenCore=function(s,a,c){c=c||Promise.prototype.then,s&&(s=s.bind(this)),a&&(a=a.bind(this));var u=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:o.convert(Object.assign({},this),Promise.prototype),h=c.call(u,s,a);return o.convert(h,this.__proto__)},o.prototype.thenExternal=function(s,a){return Promise.prototype.then.call(this,s,a)},o.prototype.thenList=function(s){var a=this;return s.forEach(function(c){a=a.thenCore(c)}),a},o.prototype.catch=function(s){s&&(s=s.bind(this));var a=Promise.prototype.catch.call(this,s);return o.convert(a,this)},o.prototype.catchExternal=function(s){return Promise.prototype.catch.call(this,s)},o.prototype.error=function(s){return this.then(function(){throw new Error(s)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,or.getPageSize=function(s,a,c){if(sn(s)==="object"){var u=s;s=u.orientation,a=u.unit||a,c=u.format||c}a=a||"mm",c=c||"a4",s=(""+(s||"P")).toLowerCase();var h,y=(""+c).toLowerCase(),g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(a){case"pt":h=1;break;case"mm":h=72/25.4;break;case"cm":h=72/2.54;break;case"in":h=72;break;case"px":h=.75;break;case"pc":case"em":h=12;break;case"ex":h=6;break;default:throw"Invalid unit: "+a}var p,C=0,S=0;if(g.hasOwnProperty(y))C=g[y][1]/h,S=g[y][0]/h;else try{C=c[1],S=c[0]}catch{throw new Error("Invalid format: "+c)}if(s==="p"||s==="portrait")s="p",S>C&&(p=S,S=C,C=p);else{if(s!=="l"&&s!=="landscape")throw"Invalid orientation: "+s;s="l",C>S&&(p=S,S=C,C=p)}return{width:S,height:C,unit:a,k:h,orientation:s}},t.html=function(s,a){(a=a||{}).callback=a.callback||function(){},a.html2canvas=a.html2canvas||{},a.html2canvas.canvas=a.html2canvas.canvas||this.canvas,a.jsPDF=a.jsPDF||this,a.fontFaces=a.fontFaces?a.fontFaces.map(_m):null;var c=new o(a);return a.worker?c:c.from(s).doCallback()}}(or.API),or.API.addJS=function(t){return H0=t,this.internal.events.subscribe("postPutResources",function(){Hd=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Hd+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),U0=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+H0+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Hd!==void 0&&U0!==void 0&&this.internal.out("/Names <</JavaScript "+Hd+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),o=0;o<i.length;o++){var s=i[o],a=n.exec(s);if(a!=null){var c=a[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(s)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,h=[];for(o=0;o<u;o++){var y=r.internal.newObject();h.push(y);var g=r.internal.getPageInfo(o+1);r.internal.write("<< /D["+g.objId+" 0 R /XYZ null null null]>> endobj")}var p=r.internal.newObject();for(r.internal.write("<< /Names [ "),o=0;o<h.length;o++)r.internal.write("(page_"+(o+1)+")"+h[o]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+p+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,o){var s={title:i,options:o,children:[]};return n==null&&(n=this.root),n.children.push(s),s},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,o=0;o<n.children.length;o++){var s=n.children[o];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),o>0&&this.line("/Prev "+this.makeRef(n.children[o-1])),o<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[o+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var a=this.count=this.count_r({count:0},s);if(a>0&&this.line("/Count "+a),s.options&&s.options.pageNumber){var c=r.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var o=0;o<i.children.length;o++)n.count++,this.count_r(n,i.children[o]);return n.count}}])}(or.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,i,o,s,a){var c,u=this.decode.DCT_DECODE,h=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=s||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(c=function(y){for(var g,p=256*y.charCodeAt(4)+y.charCodeAt(5),C=y.length,S={width:0,height:0,numcomponents:1},w=4;w<C;w+=2){if(w+=p,e.indexOf(y.charCodeAt(w+1))!==-1){g=256*y.charCodeAt(w+5)+y.charCodeAt(w+6),S={width:256*y.charCodeAt(w+7)+y.charCodeAt(w+8),height:g,numcomponents:y.charCodeAt(w+9)};break}p=256*y.charCodeAt(w+2)+y.charCodeAt(w+3)}return S}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:a=this.color_spaces.DEVICE_GRAY;break;case 4:a=this.color_spaces.DEVICE_CMYK;break;case 3:a=this.color_spaces.DEVICE_RGB}h={data:r,width:c.width,height:c.height,colorSpace:a,bitsPerComponent:8,filter:u,index:n,alias:i}}return h}}(or.API);var Zl,Wd,W0,G0,Y0,k7=function(){var t,e,r;function n(o){var s,a,c,u,h,y,g,p,C,S,w,x,V,ne;for(this.data=o,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},y=null;;){switch(s=this.readUInt32(),C=function(){var X,Q;for(Q=[],X=0;X<4;++X)Q.push(String.fromCharCode(this.data[this.pos++]));return Q}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(s);break;case"fcTL":y&&this.animation.frames.push(y),this.pos+=4,y={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},h=this.readUInt16(),u=this.readUInt16()||100,y.delay=1e3*h/u,y.disposeOp=this.data[this.pos++],y.blendOp=this.data[this.pos++],y.data=[];break;case"IDAT":case"fdAT":for(C==="fdAT"&&(this.pos+=4,s-=4),o=y?.data||this.imgData,x=0;0<=s?x<s:x>s;0<=s?++x:--x)o.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(s),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((S=c-this.transparency.indexed.length)>0)for(V=0;0<=S?V<S:V>S;0<=S?++V:--V)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(s)[0];break;case 2:this.transparency.rgb=this.read(s)}break;case"tEXt":g=(w=this.read(s)).indexOf(0),p=String.fromCharCode.apply(String,w.slice(0,g)),this.text[p]=String.fromCharCode.apply(String,w.slice(g+1));break;case"IEND":return y&&this.animation.frames.push(y),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=(ne=this.colorType)===4||ne===6,a=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*a,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=s}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(o){var s,a;for(a=[],s=0;0<=o?s<o:s>o;0<=o?++s:--s)a.push(this.data[this.pos++]);return a},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(o){var s=this.pixelBitlength/8,a=new Uint8Array(this.width*this.height*s),c=0,u=this;if(o==null&&(o=this.imgData),o.length===0)return new Uint8Array(0);function h(y,g,p,C){var S,w,x,V,ne,X,Q,ee,E,A,T,R,_,I,b,G,ie,F,W,z,O,k=Math.ceil((u.width-y)/p),re=Math.ceil((u.height-g)/C),$=u.width==k&&u.height==re;for(I=s*k,R=$?a:new Uint8Array(I*re),X=o.length,_=0,w=0;_<re&&c<X;){switch(o[c++]){case 0:for(V=ie=0;ie<I;V=ie+=1)R[w++]=o[c++];break;case 1:for(V=F=0;F<I;V=F+=1)S=o[c++],ne=V<s?0:R[w-s],R[w++]=(S+ne)%256;break;case 2:for(V=W=0;W<I;V=W+=1)S=o[c++],x=(V-V%s)/s,b=_&&R[(_-1)*I+x*s+V%s],R[w++]=(b+S)%256;break;case 3:for(V=z=0;z<I;V=z+=1)S=o[c++],x=(V-V%s)/s,ne=V<s?0:R[w-s],b=_&&R[(_-1)*I+x*s+V%s],R[w++]=(S+Math.floor((ne+b)/2))%256;break;case 4:for(V=O=0;O<I;V=O+=1)S=o[c++],x=(V-V%s)/s,ne=V<s?0:R[w-s],_===0?b=G=0:(b=R[(_-1)*I+x*s+V%s],G=x&&R[(_-1)*I+(x-1)*s+V%s]),Q=ne+b-G,ee=Math.abs(Q-ne),A=Math.abs(Q-b),T=Math.abs(Q-G),E=ee<=A&&ee<=T?ne:A<=T?b:G,R[w++]=(S+E)%256;break;default:throw new Error("Invalid filter algorithm: "+o[c-1])}if(!$){var D=((g+_*C)*u.width+y)*s,H=_*I;for(V=0;V<k;V+=1){for(var L=0;L<s;L+=1)a[D++]=R[H++];D+=(p-1)*s}}_++}}return o=a7(o),u.interlaceMethod==1?(h(0,0,8,8),h(4,0,8,8),h(0,4,4,8),h(2,0,4,4),h(0,2,2,4),h(1,0,2,2),h(0,1,1,2)):h(0,0,1,1),a},n.prototype.decodePalette=function(){var o,s,a,c,u,h,y,g,p;for(a=this.palette,h=this.transparency.indexed||[],u=new Uint8Array((h.length||0)+a.length),c=0,o=0,s=y=0,g=a.length;y<g;s=y+=3)u[c++]=a[s],u[c++]=a[s+1],u[c++]=a[s+2],u[c++]=(p=h[o++])!=null?p:255;return u},n.prototype.copyToImageData=function(o,s){var a,c,u,h,y,g,p,C,S,w,x;if(c=this.colors,S=null,a=this.hasAlphaChannel,this.palette.length&&(S=(x=this._decodedPalette)!=null?x:this._decodedPalette=this.decodePalette(),c=4,a=!0),C=(u=o.data||o).length,y=S||s,h=g=0,c===1)for(;h<C;)p=S?4*s[h/4]:g,w=y[p++],u[h++]=w,u[h++]=w,u[h++]=w,u[h++]=a?y[p++]:255,g=p;else for(;h<C;)p=S?4*s[h/4]:g,u[h++]=y[p++],u[h++]=y[p++],u[h++]=y[p++],u[h++]=a?y[p++]:255,g=p},n.prototype.decode=function(){var o;return o=new Uint8Array(this.width*this.height*4),this.copyToImageData(o,this.decodePixels()),o};var i=function(){if(Object.prototype.toString.call(cr)==="[object Window]"){try{e=cr.document.createElement("canvas"),r=e.getContext("2d")}catch{return!1}return!0}return!1};return i(),t=function(o){var s;if(i()===!0)return r.width=o.width,r.height=o.height,r.clearRect(0,0,o.width,o.height),r.putImageData(o,0,0),(s=new Image).src=e.toDataURL(),s;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(o){var s,a,c,u,h,y,g,p;if(this.animation){for(p=[],a=h=0,y=(g=this.animation.frames).length;h<y;a=++h)s=g[a],c=o.createImageData(s.width,s.height),u=this.decodePixels(new Uint8Array(s.data)),this.copyToImageData(c,u),s.imageData=c,p.push(s.image=t(c));return p}},n.prototype.renderFrame=function(o,s){var a,c,u;return a=(c=this.animation.frames)[s],u=c[s-1],s===0&&o.clearRect(0,0,this.width,this.height),u?.disposeOp===1?o.clearRect(u.xOffset,u.yOffset,u.width,u.height):u?.disposeOp===2&&o.putImageData(u.imageData,u.xOffset,u.yOffset),a.blendOp===0&&o.clearRect(a.xOffset,a.yOffset,a.width,a.height),o.drawImage(a.image,a.xOffset,a.yOffset)},n.prototype.animate=function(o){var s,a,c,u,h,y,g=this;return a=0,y=this.animation,u=y.numFrames,c=y.frames,h=y.numPlays,(s=function(){var p,C;if(p=a++%u,C=c[p],g.renderFrame(o,p),u>1&&a/u<h)return g.animation._timeout=setTimeout(s,C.delay)})()},n.prototype.stopAnimation=function(){var o;return clearTimeout((o=this.animation)!=null?o._timeout:void 0)},n.prototype.render=function(o){var s,a;return o._png&&o._png.stopAnimation(),o._png=this,o.width=this.width,o.height=this.height,s=o.getContext("2d"),this.animation?(this.decodeFrames(s),this.animate(s)):(a=s.createImageData(this.width,this.height),this.copyToImageData(a,this.decodePixels()),s.putImageData(a,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function T7(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,i=t[e++],o=i>>7,s=1<<(7&i)+1;t[e++],t[e++];var a=null,c=null;o&&(a=e,c=s,e+=3*s);var u=!0,h=[],y=0,g=null,p=0,C=null;for(this.width=r,this.height=n;u&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,C=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((_=t[e++])>=0))throw Error("Invalid block size");if(_===0)break;e+=_}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var S=t[e++];y=t[e++]|t[e++]<<8,g=t[e++],(1&S)==0&&(g=null),p=S>>2&7,e++;break;case 254:for(;;){if(!((_=t[e++])>=0))throw Error("Invalid block size");if(_===0)break;e+=_}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var w=t[e++]|t[e++]<<8,x=t[e++]|t[e++]<<8,V=t[e++]|t[e++]<<8,ne=t[e++]|t[e++]<<8,X=t[e++],Q=X>>6&1,ee=1<<(7&X)+1,E=a,A=c,T=!1;X>>7&&(T=!0,E=e,A=ee,e+=3*ee);var R=e;for(e++;;){var _;if(!((_=t[e++])>=0))throw Error("Invalid block size");if(_===0)break;e+=_}h.push({x:w,y:x,width:V,height:ne,has_local_palette:T,palette_offset:E,palette_size:A,data_offset:R,data_length:e-R,transparent_index:g,interlaced:!!Q,delay:y,disposal:p});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return h.length},this.loopCount=function(){return C},this.frameInfo=function(I){if(I<0||I>=h.length)throw new Error("Frame index out of range.");return h[I]},this.decodeAndBlitFrameBGRA=function(I,b){var G=this.frameInfo(I),ie=G.width*G.height,F=new Uint8Array(ie);K0(t,G.data_offset,F,ie);var W=G.palette_offset,z=G.transparent_index;z===null&&(z=256);var O=G.width,k=r-O,re=O,$=4*(G.y*r+G.x),D=4*((G.y+G.height)*r+G.x),H=$,L=4*k;G.interlaced===!0&&(L+=4*r*7);for(var j=8,oe=0,K=F.length;oe<K;++oe){var Z=F[oe];if(re===0&&(re=O,(H+=L)>=D&&(L=4*k+4*r*(j-1),H=$+(O+k)*(j<<1),j>>=1)),Z===z)H+=4;else{var J=t[W+3*Z],Y=t[W+3*Z+1],U=t[W+3*Z+2];b[H++]=U,b[H++]=Y,b[H++]=J,b[H++]=255}--re}},this.decodeAndBlitFrameRGBA=function(I,b){var G=this.frameInfo(I),ie=G.width*G.height,F=new Uint8Array(ie);K0(t,G.data_offset,F,ie);var W=G.palette_offset,z=G.transparent_index;z===null&&(z=256);var O=G.width,k=r-O,re=O,$=4*(G.y*r+G.x),D=4*((G.y+G.height)*r+G.x),H=$,L=4*k;G.interlaced===!0&&(L+=4*r*7);for(var j=8,oe=0,K=F.length;oe<K;++oe){var Z=F[oe];if(re===0&&(re=O,(H+=L)>=D&&(L=4*k+4*r*(j-1),H=$+(O+k)*(j<<1),j>>=1)),Z===z)H+=4;else{var J=t[W+3*Z],Y=t[W+3*Z+1],U=t[W+3*Z+2];b[H++]=J,b[H++]=Y,b[H++]=U,b[H++]=255}--re}}}function K0(t,e,r,n){for(var i=t[e++],o=1<<i,s=o+1,a=s+1,c=i+1,u=(1<<c)-1,h=0,y=0,g=0,p=t[e++],C=new Int32Array(4096),S=null;;){for(;h<16&&p!==0;)y|=t[e++]<<h,h+=8,p===1?p=t[e++]:--p;if(h<c)break;var w=y&u;if(y>>=c,h-=c,w!==o){if(w===s)break;for(var x=w<a?w:S,V=0,ne=x;ne>o;)ne=C[ne]>>8,++V;var X=ne;if(g+V+(x!==w?1:0)>n)return void hn.log("Warning, gif stream longer than expected.");r[g++]=X;var Q=g+=V;for(x!==w&&(r[g++]=X),ne=x;V--;)ne=C[ne],r[--Q]=255&ne,ne>>=8;S!==null&&a<4096&&(C[a++]=S<<8|X,a>=u+1&&c<12&&(++c,u=u<<1|1)),S=w}else a=s+1,u=(1<<(c=i+1))-1,S=null}return g!==n&&hn.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function vp(t){var e,r,n,i,o,s=Math.floor,a=new Array(64),c=new Array(64),u=new Array(64),h=new Array(64),y=new Array(65535),g=new Array(65535),p=new Array(64),C=new Array(64),S=[],w=0,x=7,V=new Array(64),ne=new Array(64),X=new Array(64),Q=new Array(256),ee=new Array(2048),E=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],A=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],T=[0,1,2,3,4,5,6,7,8,9,10,11],R=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],_=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],I=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],b=[0,1,2,3,4,5,6,7,8,9,10,11],G=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ie=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function F($,D){for(var H=0,L=0,j=new Array,oe=1;oe<=16;oe++){for(var K=1;K<=$[oe];K++)j[D[L]]=[],j[D[L]][0]=H,j[D[L]][1]=oe,L++,H++;H*=2}return j}function W($){for(var D=$[0],H=$[1]-1;H>=0;)D&1<<H&&(w|=1<<x),H--,--x<0&&(w==255?(z(255),z(0)):z(w),x=7,w=0)}function z($){S.push($)}function O($){z($>>8&255),z(255&$)}function k($,D,H,L,j){for(var oe,K=j[0],Z=j[240],J=function(me,Pe){var xe,he,ve,De,ke,Ce,Le,Ie,Re,He,Me=0;for(Re=0;Re<8;++Re){xe=me[Me],he=me[Me+1],ve=me[Me+2],De=me[Me+3],ke=me[Me+4],Ce=me[Me+5],Le=me[Me+6];var Ze=xe+(Ie=me[Me+7]),Ye=xe-Ie,ut=he+Le,rt=he-Le,We=ve+Ce,ct=ve-Ce,pt=De+ke,_t=De-ke,Et=Ze+pt,et=Ze-pt,Ue=ut+We,ot=ut-We;me[Me]=Et+Ue,me[Me+4]=Et-Ue;var Xe=.707106781*(ot+et);me[Me+2]=et+Xe,me[Me+6]=et-Xe;var at=.382683433*((Et=_t+ct)-(ot=rt+Ye)),St=.5411961*Et+at,$t=1.306562965*ot+at,qt=.707106781*(Ue=ct+rt),Gt=Ye+qt,ht=Ye-qt;me[Me+5]=ht+St,me[Me+3]=ht-St,me[Me+1]=Gt+$t,me[Me+7]=Gt-$t,Me+=8}for(Me=0,Re=0;Re<8;++Re){xe=me[Me],he=me[Me+8],ve=me[Me+16],De=me[Me+24],ke=me[Me+32],Ce=me[Me+40],Le=me[Me+48];var Kt=xe+(Ie=me[Me+56]),Rt=xe-Ie,Qt=he+Le,sr=he-Le,mt=ve+Ce,At=ve-Ce,Ot=De+ke,Jt=De-ke,Zt=Kt+Ot,Ht=Kt-Ot,tt=Qt+mt,jt=Qt-mt;me[Me]=Zt+tt,me[Me+32]=Zt-tt;var yt=.707106781*(jt+Ht);me[Me+16]=Ht+yt,me[Me+48]=Ht-yt;var ar=.382683433*((Zt=Jt+At)-(jt=sr+Rt)),Wr=.5411961*Zt+ar,pr=1.306562965*jt+ar,wr=.707106781*(tt=At+sr),$r=Rt+wr,lr=Rt-wr;me[Me+40]=lr+Wr,me[Me+24]=lr-Wr,me[Me+8]=$r+pr,me[Me+56]=$r-pr,Me++}for(Re=0;Re<64;++Re)He=me[Re]*Pe[Re],p[Re]=He>0?He+.5|0:He-.5|0;return p}($,D),Y=0;Y<64;++Y)C[E[Y]]=J[Y];var U=C[0]-H;H=C[0],U==0?W(L[0]):(W(L[g[oe=32767+U]]),W(y[oe]));for(var ae=63;ae>0&&C[ae]==0;)ae--;if(ae==0)return W(K),H;for(var ue,le=1;le<=ae;){for(var q=le;C[le]==0&&le<=ae;)++le;var ce=le-q;if(ce>=16){ue=ce>>4;for(var Se=1;Se<=ue;++Se)W(Z);ce&=15}oe=32767+C[le],W(j[(ce<<4)+g[oe]]),W(y[oe]),le++}return ae!=63&&W(K),H}function re($){$=Math.min(Math.max($,1),100),o!=$&&(function(D){for(var H=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],L=0;L<64;L++){var j=s((H[L]*D+50)/100);j=Math.min(Math.max(j,1),255),a[E[L]]=j}for(var oe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],K=0;K<64;K++){var Z=s((oe[K]*D+50)/100);Z=Math.min(Math.max(Z,1),255),c[E[K]]=Z}for(var J=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Y=0,U=0;U<8;U++)for(var ae=0;ae<8;ae++)u[Y]=1/(a[E[Y]]*J[U]*J[ae]*8),h[Y]=1/(c[E[Y]]*J[U]*J[ae]*8),Y++}($<50?Math.floor(5e3/$):Math.floor(200-2*$)),o=$)}this.encode=function($,D){D&&re(D),S=new Array,w=0,x=7,O(65496),O(65504),O(16),z(74),z(70),z(73),z(70),z(0),z(1),z(1),z(0),O(1),O(1),z(0),z(0),function(){O(65499),O(132),z(0);for(var he=0;he<64;he++)z(a[he]);z(1);for(var ve=0;ve<64;ve++)z(c[ve])}(),function(he,ve){O(65472),O(17),z(8),O(ve),O(he),z(3),z(1),z(17),z(0),z(2),z(17),z(1),z(3),z(17),z(1)}($.width,$.height),function(){O(65476),O(418),z(0);for(var he=0;he<16;he++)z(A[he+1]);for(var ve=0;ve<=11;ve++)z(T[ve]);z(16);for(var De=0;De<16;De++)z(R[De+1]);for(var ke=0;ke<=161;ke++)z(_[ke]);z(1);for(var Ce=0;Ce<16;Ce++)z(I[Ce+1]);for(var Le=0;Le<=11;Le++)z(b[Le]);z(17);for(var Ie=0;Ie<16;Ie++)z(G[Ie+1]);for(var Re=0;Re<=161;Re++)z(ie[Re])}(),O(65498),O(12),z(3),z(1),z(0),z(2),z(17),z(3),z(17),z(0),z(63),z(0);var H=0,L=0,j=0;w=0,x=7,this.encode.displayName="_encode_";for(var oe,K,Z,J,Y,U,ae,ue,le,q=$.data,ce=$.width,Se=$.height,me=4*ce,Pe=0;Pe<Se;){for(oe=0;oe<me;){for(Y=me*Pe+oe,ae=-1,ue=0,le=0;le<64;le++)U=Y+(ue=le>>3)*me+(ae=4*(7&le)),Pe+ue>=Se&&(U-=me*(Pe+1+ue-Se)),oe+ae>=me&&(U-=oe+ae-me+4),K=q[U++],Z=q[U++],J=q[U++],V[le]=(ee[K]+ee[Z+256>>0]+ee[J+512>>0]>>16)-128,ne[le]=(ee[K+768>>0]+ee[Z+1024>>0]+ee[J+1280>>0]>>16)-128,X[le]=(ee[K+1280>>0]+ee[Z+1536>>0]+ee[J+1792>>0]>>16)-128;H=k(V,u,H,e,n),L=k(ne,h,L,r,i),j=k(X,h,j,r,i),oe+=32}Pe+=8}if(x>=0){var xe=[];xe[1]=x+1,xe[0]=(1<<x+1)-1,W(xe)}return O(65497),new Uint8Array(S)},t=t||50,function(){for(var $=String.fromCharCode,D=0;D<256;D++)Q[D]=$(D)}(),e=F(A,T),r=F(I,b),n=F(R,_),i=F(G,ie),function(){for(var $=1,D=2,H=1;H<=15;H++){for(var L=$;L<D;L++)g[32767+L]=H,y[32767+L]=[],y[32767+L][1]=H,y[32767+L][0]=L;for(var j=-(D-1);j<=-$;j++)g[32767+j]=H,y[32767+j]=[],y[32767+j][1]=H,y[32767+j][0]=D-1+j;$<<=1,D<<=1}}(),function(){for(var $=0;$<256;$++)ee[$]=19595*$,ee[$+256>>0]=38470*$,ee[$+512>>0]=7471*$+32768,ee[$+768>>0]=-11059*$,ee[$+1024>>0]=-21709*$,ee[$+1280>>0]=32768*$+8421375,ee[$+1536>>0]=-27439*$,ee[$+1792>>0]=-5329*$}(),re(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Eo(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function J0(t){function e(A){if(!A)throw Error("assert :P")}function r(A,T,R){for(var _=0;4>_;_++)if(A[T+_]!=R.charCodeAt(_))return!0;return!1}function n(A,T,R,_,I){for(var b=0;b<I;b++)A[T+b]=R[_+b]}function i(A,T,R,_){for(var I=0;I<_;I++)A[T+I]=R}function o(A){return new Int32Array(A)}function s(A,T){for(var R=[],_=0;_<A;_++)R.push(new T);return R}function a(A,T){var R=[];return function _(I,b,G){for(var ie=G[b],F=0;F<ie&&(I.push(G.length>b+1?[]:new T),!(G.length<b+1));F++)_(I[F],b+1,G)}(R,0,A),R}var c=function(){var A=this;function T(d,v){for(var N=1<<v-1>>>0;d&N;)N>>>=1;return N?(d&N-1)+N:d}function R(d,v,N,te,pe){e(!(te%N));do d[v+(te-=N)]=pe;while(0<te)}function _(d,v,N,te,pe){if(e(2328>=pe),512>=pe)var ye=o(512);else if((ye=o(pe))==null)return 0;return function(ge,_e,Ae,Ee,Oe,Ke){var Je,ze,vt=_e,nt=1<<Ae,Be=o(16),je=o(16);for(e(Oe!=0),e(Ee!=null),e(ge!=null),e(0<Ae),ze=0;ze<Oe;++ze){if(15<Ee[ze])return 0;++Be[Ee[ze]]}if(Be[0]==Oe)return 0;for(je[1]=0,Je=1;15>Je;++Je){if(Be[Je]>1<<Je)return 0;je[Je+1]=je[Je]+Be[Je]}for(ze=0;ze<Oe;++ze)Je=Ee[ze],0<Ee[ze]&&(Ke[je[Je]++]=ze);if(je[15]==1)return(Ee=new I).g=0,Ee.value=Ke[0],R(ge,vt,1,nt,Ee),nt;var ft,Pt=-1,gt=nt-1,Vt=0,Lt=1,ir=1,Mt=1<<Ae;for(ze=0,Je=1,Oe=2;Je<=Ae;++Je,Oe<<=1){if(Lt+=ir<<=1,0>(ir-=Be[Je]))return 0;for(;0<Be[Je];--Be[Je])(Ee=new I).g=Je,Ee.value=Ke[ze++],R(ge,vt+Vt,Oe,Mt,Ee),Vt=T(Vt,Je)}for(Je=Ae+1,Oe=2;15>=Je;++Je,Oe<<=1){if(Lt+=ir<<=1,0>(ir-=Be[Je]))return 0;for(;0<Be[Je];--Be[Je]){if(Ee=new I,(Vt&gt)!=Pt){for(vt+=Mt,ft=1<<(Pt=Je)-Ae;15>Pt&&!(0>=(ft-=Be[Pt]));)++Pt,ft<<=1;nt+=Mt=1<<(ft=Pt-Ae),ge[_e+(Pt=Vt&gt)].g=ft+Ae,ge[_e+Pt].value=vt-_e-Pt}Ee.g=Je-Ae,Ee.value=Ke[ze++],R(ge,vt+(Vt>>Ae),Oe,Mt,Ee),Vt=T(Vt,Je)}}return Lt!=2*je[15]-1?0:nt}(d,v,N,te,pe,ye)}function I(){this.value=this.g=0}function b(){this.value=this.g=0}function G(){this.G=s(5,I),this.H=o(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(ii,b)}function ie(d,v,N,te){e(d!=null),e(v!=null),e(2147483648>te),d.Ca=254,d.I=0,d.b=-8,d.Ka=0,d.oa=v,d.pa=N,d.Jd=v,d.Yc=N+te,d.Zc=4<=te?N+te-4+1:N,oe(d)}function F(d,v){for(var N=0;0<v--;)N|=Z(d,128)<<v;return N}function W(d,v){var N=F(d,v);return K(d)?-N:N}function z(d,v,N,te){var pe,ye=0;for(e(d!=null),e(v!=null),e(4294967288>te),d.Sb=te,d.Ra=0,d.u=0,d.h=0,4<te&&(te=4),pe=0;pe<te;++pe)ye+=v[N+pe]<<8*pe;d.Ra=ye,d.bb=te,d.oa=v,d.pa=N}function O(d){for(;8<=d.u&&d.bb<d.Sb;)d.Ra>>>=8,d.Ra+=d.oa[d.pa+d.bb]<<Ol-8>>>0,++d.bb,d.u-=8;H(d)&&(d.h=1,d.u=0)}function k(d,v){if(e(0<=v),!d.h&&v<=Fl){var N=D(d)&Ml[v];return d.u+=v,O(d),N}return d.h=1,d.u=0}function re(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function $(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function D(d){return d.Ra>>>(d.u&Ol-1)>>>0}function H(d){return e(d.bb<=d.Sb),d.h||d.bb==d.Sb&&d.u>Ol}function L(d,v){d.u=v,d.h=H(d)}function j(d){d.u>=Dc&&(e(d.u>=Dc),O(d))}function oe(d){e(d!=null&&d.oa!=null),d.pa<d.Zc?(d.I=(d.oa[d.pa++]|d.I<<8)>>>0,d.b+=8):(e(d!=null&&d.oa!=null),d.pa<d.Yc?(d.b+=8,d.I=d.oa[d.pa++]|d.I<<8):d.Ka?d.b=0:(d.I<<=8,d.b+=8,d.Ka=1))}function K(d){return F(d,1)}function Z(d,v){var N=d.Ca;0>d.b&&oe(d);var te=d.b,pe=N*v>>>8,ye=(d.I>>>te>pe)+0;for(ye?(N-=pe,d.I-=pe+1<<te>>>0):N=pe+1,te=N,pe=0;256<=te;)pe+=8,te>>=8;return te=7^pe+Mi[te],d.b-=te,d.Ca=(N<<te)-1,ye}function J(d,v,N){d[v+0]=N>>24&255,d[v+1]=N>>16&255,d[v+2]=N>>8&255,d[v+3]=N>>0&255}function Y(d,v){return d[v+0]<<0|d[v+1]<<8}function U(d,v){return Y(d,v)|d[v+2]<<16}function ae(d,v){return Y(d,v)|Y(d,v+2)<<16}function ue(d,v){var N=1<<v;return e(d!=null),e(0<v),d.X=o(N),d.X==null?0:(d.Mb=32-v,d.Xa=v,1)}function le(d,v){e(d!=null),e(v!=null),e(d.Xa==v.Xa),n(v.X,0,d.X,0,1<<v.Xa)}function q(){this.X=[],this.Xa=this.Mb=0}function ce(d,v,N,te){e(N!=null),e(te!=null);var pe=N[0],ye=te[0];return pe==0&&(pe=(d*ye+v/2)/v),ye==0&&(ye=(v*pe+d/2)/d),0>=pe||0>=ye?0:(N[0]=pe,te[0]=ye,1)}function Se(d,v){return d+(1<<v)-1>>>v}function me(d,v){return((4278255360&d)+(4278255360&v)>>>0&4278255360)+((16711935&d)+(16711935&v)>>>0&16711935)>>>0}function Pe(d,v){A[v]=function(N,te,pe,ye,ge,_e,Ae){var Ee;for(Ee=0;Ee<ge;++Ee){var Oe=A[d](_e[Ae+Ee-1],pe,ye+Ee);_e[Ae+Ee]=me(N[te+Ee],Oe)}}}function xe(){this.ud=this.hd=this.jd=0}function he(d,v){return((4278124286&(d^v))>>>1)+(d&v)>>>0}function ve(d){return 0<=d&&256>d?d:0>d?0:255<d?255:void 0}function De(d,v){return ve(d+(d-v+.5>>1))}function ke(d,v,N){return Math.abs(v-N)-Math.abs(d-N)}function Ce(d,v,N,te,pe,ye,ge){for(te=ye[ge-1],N=0;N<pe;++N)ye[ge+N]=te=me(d[v+N],te)}function Le(d,v,N,te,pe){var ye;for(ye=0;ye<N;++ye){var ge=d[v+ye],_e=ge>>8&255,Ae=16711935&(Ae=(Ae=16711935&ge)+((_e<<16)+_e));te[pe+ye]=(4278255360&ge)+Ae>>>0}}function Ie(d,v){v.jd=d>>0&255,v.hd=d>>8&255,v.ud=d>>16&255}function Re(d,v,N,te,pe,ye){var ge;for(ge=0;ge<te;++ge){var _e=v[N+ge],Ae=_e>>>8,Ee=_e,Oe=255&(Oe=(Oe=_e>>>16)+((d.jd<<24>>24)*(Ae<<24>>24)>>>5));Ee=255&(Ee=(Ee=Ee+((d.hd<<24>>24)*(Ae<<24>>24)>>>5))+((d.ud<<24>>24)*(Oe<<24>>24)>>>5)),pe[ye+ge]=(4278255360&_e)+(Oe<<16)+Ee}}function He(d,v,N,te,pe){A[v]=function(ye,ge,_e,Ae,Ee,Oe,Ke,Je,ze){for(Ae=Ke;Ae<Je;++Ae)for(Ke=0;Ke<ze;++Ke)Ee[Oe++]=pe(_e[te(ye[ge++])])},A[d]=function(ye,ge,_e,Ae,Ee,Oe,Ke){var Je=8>>ye.b,ze=ye.Ea,vt=ye.K[0],nt=ye.w;if(8>Je)for(ye=(1<<ye.b)-1,nt=(1<<Je)-1;ge<_e;++ge){var Be,je=0;for(Be=0;Be<ze;++Be)Be&ye||(je=te(Ae[Ee++])),Oe[Ke++]=pe(vt[je&nt]),je>>=Je}else A["VP8LMapColor"+N](Ae,Ee,vt,nt,Oe,Ke,ge,_e,ze)}}function Me(d,v,N,te,pe){for(N=v+N;v<N;){var ye=d[v++];te[pe++]=ye>>16&255,te[pe++]=ye>>8&255,te[pe++]=ye>>0&255}}function Ze(d,v,N,te,pe){for(N=v+N;v<N;){var ye=d[v++];te[pe++]=ye>>16&255,te[pe++]=ye>>8&255,te[pe++]=ye>>0&255,te[pe++]=ye>>24&255}}function Ye(d,v,N,te,pe){for(N=v+N;v<N;){var ye=(ge=d[v++])>>16&240|ge>>12&15,ge=ge>>0&240|ge>>28&15;te[pe++]=ye,te[pe++]=ge}}function ut(d,v,N,te,pe){for(N=v+N;v<N;){var ye=(ge=d[v++])>>16&248|ge>>13&7,ge=ge>>5&224|ge>>3&31;te[pe++]=ye,te[pe++]=ge}}function rt(d,v,N,te,pe){for(N=v+N;v<N;){var ye=d[v++];te[pe++]=ye>>0&255,te[pe++]=ye>>8&255,te[pe++]=ye>>16&255}}function We(d,v,N,te,pe,ye){if(ye==0)for(N=v+N;v<N;)J(te,((ye=d[v++])[0]>>24|ye[1]>>8&65280|ye[2]<<8&16711680|ye[3]<<24)>>>0),pe+=32;else n(te,pe,d,v,N)}function ct(d,v){A[v][0]=A[d+"0"],A[v][1]=A[d+"1"],A[v][2]=A[d+"2"],A[v][3]=A[d+"3"],A[v][4]=A[d+"4"],A[v][5]=A[d+"5"],A[v][6]=A[d+"6"],A[v][7]=A[d+"7"],A[v][8]=A[d+"8"],A[v][9]=A[d+"9"],A[v][10]=A[d+"10"],A[v][11]=A[d+"11"],A[v][12]=A[d+"12"],A[v][13]=A[d+"13"],A[v][14]=A[d+"0"],A[v][15]=A[d+"0"]}function pt(d){return d==gf||d==vf||d==dd||d==bf}function _t(){this.eb=[],this.size=this.A=this.fb=0}function Et(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function et(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new _t,this.f.kb=new Et,this.sd=null}function Ue(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function ot(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Xe(d){return alert("todo:WebPSamplerProcessPlane"),d.T}function at(d,v){var N=d.T,te=v.ba.f.RGBA,pe=te.eb,ye=te.fb+d.ka*te.A,ge=uo[v.ba.S],_e=d.y,Ae=d.O,Ee=d.f,Oe=d.N,Ke=d.ea,Je=d.W,ze=v.cc,vt=v.dc,nt=v.Mc,Be=v.Nc,je=d.ka,ft=d.ka+d.T,Pt=d.U,gt=Pt+1>>1;for(je==0?ge(_e,Ae,null,null,Ee,Oe,Ke,Je,Ee,Oe,Ke,Je,pe,ye,null,null,Pt):(ge(v.ec,v.fc,_e,Ae,ze,vt,nt,Be,Ee,Oe,Ke,Je,pe,ye-te.A,pe,ye,Pt),++N);je+2<ft;je+=2)ze=Ee,vt=Oe,nt=Ke,Be=Je,Oe+=d.Rc,Je+=d.Rc,ye+=2*te.A,ge(_e,(Ae+=2*d.fa)-d.fa,_e,Ae,ze,vt,nt,Be,Ee,Oe,Ke,Je,pe,ye-te.A,pe,ye,Pt);return Ae+=d.fa,d.j+ft<d.o?(n(v.ec,v.fc,_e,Ae,Pt),n(v.cc,v.dc,Ee,Oe,gt),n(v.Mc,v.Nc,Ke,Je,gt),N--):1&ft||ge(_e,Ae,null,null,Ee,Oe,Ke,Je,Ee,Oe,Ke,Je,pe,ye+te.A,null,null,Pt),N}function St(d,v,N){var te=d.F,pe=[d.J];if(te!=null){var ye=d.U,ge=v.ba.S,_e=ge==ud||ge==dd;v=v.ba.f.RGBA;var Ae=[0],Ee=d.ka;Ae[0]=d.T,d.Kb&&(Ee==0?--Ae[0]:(--Ee,pe[0]-=d.width),d.j+d.ka+d.T==d.o&&(Ae[0]=d.o-d.j-Ee));var Oe=v.eb;Ee=v.fb+Ee*v.A,d=yn(te,pe[0],d.width,ye,Ae,Oe,Ee+(_e?0:3),v.A),e(N==Ae),d&&pt(ge)&&lo(Oe,Ee,_e,ye,Ae,v.A)}return 0}function $t(d){var v=d.ma,N=v.ba.S,te=11>N,pe=N==ld||N==cd||N==ud||N==yf||N==12||pt(N);if(v.memory=null,v.Ib=null,v.Jb=null,v.Nd=null,!Nc(v.Oa,d,pe?11:12))return 0;if(pe&&pt(N)&&Ct(),d.da)alert("todo:use_scaling");else{if(te){if(v.Ib=Xe,d.Kb){if(N=d.U+1>>1,v.memory=o(d.U+2*N),v.memory==null)return 0;v.ec=v.memory,v.fc=0,v.cc=v.ec,v.dc=v.fc+d.U,v.Mc=v.cc,v.Nc=v.dc+N,v.Ib=at,Ct()}}else alert("todo:EmitYUV");pe&&(v.Jb=St,te&&qe())}if(te&&!Jy){for(d=0;256>d;++d)k_[d]=89858*(d-128)+fd>>hd,L_[d]=-22014*(d-128)+fd,N_[d]=-45773*(d-128),T_[d]=113618*(d-128)+fd>>hd;for(d=Vc;d<Sf;++d)v=76283*(d-16)+fd>>hd,D_[d-Vc]=Zr(v,255),R_[d-Vc]=Zr(v+8>>4,15);Jy=1}return 1}function qt(d){var v=d.ma,N=d.U,te=d.T;return e(!(1&d.ka)),0>=N||0>=te?0:(N=v.Ib(d,v),v.Jb!=null&&v.Jb(d,v,N),v.Dc+=N,1)}function Gt(d){d.ma.memory=null}function ht(d,v,N,te){return k(d,8)!=47?0:(v[0]=k(d,14)+1,N[0]=k(d,14)+1,te[0]=k(d,1),k(d,3)!=0?0:!d.h)}function Kt(d,v){if(4>d)return d+1;var N=d-2>>1;return(2+(1&d)<<N)+k(v,N)+1}function Rt(d,v){return 120<v?v-120:1<=(N=((N=y_[v-1])>>4)*d+(8-(15&N)))?N:1;var N}function Qt(d,v,N){var te=D(N),pe=d[v+=255&te].g-8;return 0<pe&&(L(N,N.u+8),te=D(N),v+=d[v].value,v+=te&(1<<pe)-1),L(N,N.u+d[v].g),d[v].value}function sr(d,v,N){return N.g+=d.g,N.value+=d.value<<v>>>0,e(8>=N.g),d.g}function mt(d,v,N){var te=d.xc;return e((v=te==0?0:d.vc[d.md*(N>>te)+(v>>te)])<d.Wb),d.Ya[v]}function At(d,v,N,te){var pe=d.ab,ye=d.c*v,ge=d.C;v=ge+v;var _e=N,Ae=te;for(te=d.Ta,N=d.Ua;0<pe--;){var Ee=d.gc[pe],Oe=ge,Ke=v,Je=_e,ze=Ae,vt=(Ae=te,_e=N,Ee.Ea);switch(e(Oe<Ke),e(Ke<=Ee.nc),Ee.hc){case 2:td(Je,ze,(Ke-Oe)*vt,Ae,_e);break;case 0:var nt=Oe,Be=Ke,je=Ae,ft=_e,Pt=(Mt=Ee).Ea;nt==0&&(pf(Je,ze,null,null,1,je,ft),Ce(Je,ze+1,0,0,Pt-1,je,ft+1),ze+=Pt,ft+=Pt,++nt);for(var gt=1<<Mt.b,Vt=gt-1,Lt=Se(Pt,Mt.b),ir=Mt.K,Mt=Mt.w+(nt>>Mt.b)*Lt;nt<Be;){var Kr=ir,nn=Mt,zr=1;for(Rc(Je,ze,je,ft-Pt,1,je,ft);zr<Pt;){var Lr=(zr&~Vt)+gt;Lr>Pt&&(Lr=Pt),(0,Xs[Kr[nn++]>>8&15])(Je,ze+ +zr,je,ft+zr-Pt,Lr-zr,je,ft+zr),zr=Lr}ze+=Pt,ft+=Pt,++nt&Vt||(Mt+=Lt)}Ke!=Ee.nc&&n(Ae,_e-vt,Ae,_e+(Ke-Oe-1)*vt,vt);break;case 1:for(vt=Je,Be=ze,Pt=(Je=Ee.Ea)-(ft=Je&~(je=(ze=1<<Ee.b)-1)),nt=Se(Je,Ee.b),gt=Ee.K,Ee=Ee.w+(Oe>>Ee.b)*nt;Oe<Ke;){for(Vt=gt,Lt=Ee,ir=new xe,Mt=Be+ft,Kr=Be+Je;Be<Mt;)Ie(Vt[Lt++],ir),Ka(ir,vt,Be,ze,Ae,_e),Be+=ze,_e+=ze;Be<Kr&&(Ie(Vt[Lt++],ir),Ka(ir,vt,Be,Pt,Ae,_e),Be+=Pt,_e+=Pt),++Oe&je||(Ee+=nt)}break;case 3:if(Je==Ae&&ze==_e&&0<Ee.b){for(Be=Ae,Je=vt=_e+(Ke-Oe)*vt-(ft=(Ke-Oe)*Se(Ee.Ea,Ee.b)),ze=Ae,je=_e,nt=[],ft=(Pt=ft)-1;0<=ft;--ft)nt[ft]=ze[je+ft];for(ft=Pt-1;0<=ft;--ft)Be[Je+ft]=nt[ft];oo(Ee,Oe,Ke,Ae,vt,Ae,_e)}else oo(Ee,Oe,Ke,Je,ze,Ae,_e)}_e=te,Ae=N}Ae!=N&&n(te,N,_e,Ae,ye)}function Ot(d,v){var N=d.V,te=d.Ba+d.c*d.C,pe=v-d.C;if(e(v<=d.l.o),e(16>=pe),0<pe){var ye=d.l,ge=d.Ta,_e=d.Ua,Ae=ye.width;if(At(d,pe,N,te),pe=_e=[_e],e((N=d.C)<(te=v)),e(ye.v<ye.va),te>ye.o&&(te=ye.o),N<ye.j){var Ee=ye.j-N;N=ye.j,pe[0]+=Ee*Ae}if(N>=te?N=0:(pe[0]+=4*ye.v,ye.ka=N-ye.j,ye.U=ye.va-ye.v,ye.T=te-N,N=1),N){if(_e=_e[0],11>(N=d.ca).S){var Oe=N.f.RGBA,Ke=(te=N.S,pe=ye.U,ye=ye.T,Ee=Oe.eb,Oe.A),Je=ye;for(Oe=Oe.fb+d.Ma*Oe.A;0<Je--;){var ze=ge,vt=_e,nt=pe,Be=Ee,je=Oe;switch(te){case ad:Fi(ze,vt,nt,Be,je);break;case ld:$i(ze,vt,nt,Be,je);break;case gf:$i(ze,vt,nt,Be,je),lo(Be,je,0,nt,1,0);break;case Vy:ms(ze,vt,nt,Be,je);break;case cd:We(ze,vt,nt,Be,je,1);break;case vf:We(ze,vt,nt,Be,je,1),lo(Be,je,0,nt,1,0);break;case ud:We(ze,vt,nt,Be,je,0);break;case dd:We(ze,vt,nt,Be,je,0),lo(Be,je,1,nt,1,0);break;case yf:Zs(ze,vt,nt,Be,je);break;case bf:Zs(ze,vt,nt,Be,je),mn(Be,je,nt,1,0);break;case qy:ps(ze,vt,nt,Be,je);break;default:e(0)}_e+=Ae,Oe+=Ke}d.Ma+=ye}else alert("todo:EmitRescaledRowsYUVA");e(d.Ma<=N.height)}}d.C=v,e(d.C<=d.i)}function Jt(d){var v;if(0<d.ua)return 0;for(v=0;v<d.Wb;++v){var N=d.Ya[v].G,te=d.Ya[v].H;if(0<N[1][te[1]+0].g||0<N[2][te[2]+0].g||0<N[3][te[3]+0].g)return 0}return 1}function Zt(d,v,N,te,pe,ye){if(d.Z!=0){var ge=d.qd,_e=d.rd;for(e(na[d.Z]!=null);v<N;++v)na[d.Z](ge,_e,te,pe,te,pe,ye),ge=te,_e=pe,pe+=ye;d.qd=ge,d.rd=_e}}function Ht(d,v){var N=d.l.ma,te=N.Z==0||N.Z==1?d.l.j:d.C;if(te=d.C<te?te:d.C,e(v<=d.l.o),v>te){var pe=d.l.width,ye=N.ca,ge=N.tb+pe*te,_e=d.V,Ae=d.Ba+d.c*te,Ee=d.gc;e(d.ab==1),e(Ee[0].hc==3),rd(Ee[0],te,v,_e,Ae,ye,ge),Zt(N,te,v,ye,ge,pe)}d.C=d.Ma=v}function tt(d,v,N,te,pe,ye,ge){var _e=d.$/te,Ae=d.$%te,Ee=d.m,Oe=d.s,Ke=N+d.$,Je=Ke;pe=N+te*pe;var ze=N+te*ye,vt=280+Oe.ua,nt=d.Pb?_e:16777216,Be=0<Oe.ua?Oe.Wa:null,je=Oe.wc,ft=Ke<ze?mt(Oe,Ae,_e):null;e(d.C<ye),e(ze<=pe);var Pt=!1;e:for(;;){for(;Pt||Ke<ze;){var gt=0;if(_e>=nt){var Vt=Ke-N;e((nt=d).Pb),nt.wd=nt.m,nt.xd=Vt,0<nt.s.ua&&le(nt.s.Wa,nt.s.vb),nt=_e+v_}if(Ae&je||(ft=mt(Oe,Ae,_e)),e(ft!=null),ft.Qb&&(v[Ke]=ft.qb,Pt=!0),!Pt)if(j(Ee),ft.jc){gt=Ee,Vt=v;var Lt=Ke,ir=ft.pd[D(gt)&ii-1];e(ft.jc),256>ir.g?(L(gt,gt.u+ir.g),Vt[Lt]=ir.value,gt=0):(L(gt,gt.u+ir.g-256),e(256<=ir.value),gt=ir.value),gt==0&&(Pt=!0)}else gt=Qt(ft.G[0],ft.H[0],Ee);if(Ee.h)break;if(Pt||256>gt){if(!Pt)if(ft.nd)v[Ke]=(ft.qb|gt<<8)>>>0;else{if(j(Ee),Pt=Qt(ft.G[1],ft.H[1],Ee),j(Ee),Vt=Qt(ft.G[2],ft.H[2],Ee),Lt=Qt(ft.G[3],ft.H[3],Ee),Ee.h)break;v[Ke]=(Lt<<24|Pt<<16|gt<<8|Vt)>>>0}if(Pt=!1,++Ke,++Ae>=te&&(Ae=0,++_e,ge!=null&&_e<=ye&&!(_e%16)&&ge(d,_e),Be!=null))for(;Je<Ke;)gt=v[Je++],Be.X[(506832829*gt&4294967295)>>>Be.Mb]=gt}else if(280>gt){if(gt=Kt(gt-256,Ee),Vt=Qt(ft.G[4],ft.H[4],Ee),j(Ee),Vt=Rt(te,Vt=Kt(Vt,Ee)),Ee.h)break;if(Ke-N<Vt||pe-Ke<gt)break e;for(Lt=0;Lt<gt;++Lt)v[Ke+Lt]=v[Ke+Lt-Vt];for(Ke+=gt,Ae+=gt;Ae>=te;)Ae-=te,++_e,ge!=null&&_e<=ye&&!(_e%16)&&ge(d,_e);if(e(Ke<=pe),Ae&je&&(ft=mt(Oe,Ae,_e)),Be!=null)for(;Je<Ke;)gt=v[Je++],Be.X[(506832829*gt&4294967295)>>>Be.Mb]=gt}else{if(!(gt<vt))break e;for(Pt=gt-280,e(Be!=null);Je<Ke;)gt=v[Je++],Be.X[(506832829*gt&4294967295)>>>Be.Mb]=gt;gt=Ke,e(!(Pt>>>(Vt=Be).Xa)),v[gt]=Vt.X[Pt],Pt=!0}Pt||e(Ee.h==H(Ee))}if(d.Pb&&Ee.h&&Ke<pe)e(d.m.h),d.a=5,d.m=d.wd,d.$=d.xd,0<d.s.ua&&le(d.s.vb,d.s.Wa);else{if(Ee.h)break e;ge?.(d,_e>ye?ye:_e),d.a=0,d.$=Ke-N}return 1}return d.a=3,0}function jt(d){e(d!=null),d.vc=null,d.yc=null,d.Ya=null;var v=d.Wa;v!=null&&(v.X=null),d.vb=null,e(d!=null)}function yt(){var d=new Dl;return d==null?null:(d.a=0,d.xb=Hy,ct("Predictor","VP8LPredictors"),ct("Predictor","VP8LPredictors_C"),ct("PredictorAdd","VP8LPredictorsAdd"),ct("PredictorAdd","VP8LPredictorsAdd_C"),td=Le,Ka=Re,Fi=Me,$i=Ze,Zs=Ye,ps=ut,ms=rt,A.VP8LMapColor32b=Bl,A.VP8LMapColor8b=nd,d)}function ar(d,v,N,te,pe){var ye=1,ge=[d],_e=[v],Ae=te.m,Ee=te.s,Oe=null,Ke=0;e:for(;;){if(N)for(;ye&&k(Ae,1);){var Je=ge,ze=_e,vt=te,nt=1,Be=vt.m,je=vt.gc[vt.ab],ft=k(Be,2);if(vt.Oc&1<<ft)ye=0;else{switch(vt.Oc|=1<<ft,je.hc=ft,je.Ea=Je[0],je.nc=ze[0],je.K=[null],++vt.ab,e(4>=vt.ab),ft){case 0:case 1:je.b=k(Be,3)+2,nt=ar(Se(je.Ea,je.b),Se(je.nc,je.b),0,vt,je.K),je.K=je.K[0];break;case 3:var Pt,gt=k(Be,8)+1,Vt=16<gt?0:4<gt?1:2<gt?2:3;if(Je[0]=Se(je.Ea,Vt),je.b=Vt,Pt=nt=ar(gt,1,0,vt,je.K)){var Lt,ir=gt,Mt=je,Kr=1<<(8>>Mt.b),nn=o(Kr);if(nn==null)Pt=0;else{var zr=Mt.K[0],Lr=Mt.w;for(nn[0]=Mt.K[0][0],Lt=1;Lt<1*ir;++Lt)nn[Lt]=me(zr[Lr+Lt],nn[Lt-1]);for(;Lt<4*Kr;++Lt)nn[Lt]=0;Mt.K[0]=null,Mt.K[0]=nn,Pt=1}}nt=Pt;break;case 2:break;default:e(0)}ye=nt}}if(ge=ge[0],_e=_e[0],ye&&k(Ae,1)&&!(ye=1<=(Ke=k(Ae,4))&&11>=Ke)){te.a=3;break e}var dn;if(dn=ye)t:{var an,xr,Mn,Oi=te,Fn=ge,Bi=_e,on=Ke,Ji=N,Qi=Oi.m,Kn=Oi.s,oi=[null],ki=1,ho=0,Ho=g_[on];r:for(;;){if(Ji&&k(Qi,1)){var Jn=k(Qi,3)+2,bs=Se(Fn,Jn),el=Se(Bi,Jn),Ul=bs*el;if(!ar(bs,el,0,Oi,oi))break r;for(oi=oi[0],Kn.xc=Jn,an=0;an<Ul;++an){var ia=oi[an]>>8&65535;oi[an]=ia,ia>=ki&&(ki=ia+1)}}if(Qi.h)break r;for(xr=0;5>xr;++xr){var xn=zy[xr];!xr&&0<on&&(xn+=1<<on),ho<xn&&(ho=xn)}var Pf=s(ki*Ho,I),Zy=ki,eg=s(Zy,G);if(eg==null)var md=null;else e(65536>=Zy),md=eg;var qc=o(ho);if(md==null||qc==null||Pf==null){Oi.a=1;break r}var yd=Pf;for(an=Mn=0;an<ki;++an){var Co=md[an],Hl=Co.G,Wl=Co.H,tg=0,gd=1,rg=0;for(xr=0;5>xr;++xr){xn=zy[xr],Hl[xr]=yd,Wl[xr]=Mn,!xr&&0<on&&(xn+=1<<on);i:{var vd,xf=xn,bd=Oi,zc=qc,O_=yd,B_=Mn,Af=0,oa=bd.m,j_=k(oa,1);if(i(zc,0,0,xf),j_){var V_=k(oa,1)+1,q_=k(oa,1),ng=k(oa,q_==0?1:8);zc[ng]=1,V_==2&&(zc[ng=k(oa,8)]=1);var _d=1}else{var ig=o(19),og=k(oa,4)+4;if(19<og){bd.a=3;var wd=0;break i}for(vd=0;vd<og;++vd)ig[m_[vd]]=k(oa,3);var Cf=void 0,Uc=void 0,sg=bd,z_=ig,Sd=xf,ag=zc,If=0,sa=sg.m,lg=8,cg=s(128,I);n:for(;_(cg,0,7,z_,19);){if(k(sa,1)){var U_=2+2*k(sa,3);if((Cf=2+k(sa,U_))>Sd)break n}else Cf=Sd;for(Uc=0;Uc<Sd&&Cf--;){j(sa);var ug=cg[0+(127&D(sa))];L(sa,sa.u+ug.g);var Gl=ug.value;if(16>Gl)ag[Uc++]=Gl,Gl!=0&&(lg=Gl);else{var H_=Gl==16,dg=Gl-16,W_=f_[dg],hg=k(sa,h_[dg])+W_;if(Uc+hg>Sd)break n;for(var G_=H_?lg:0;0<hg--;)ag[Uc++]=G_}}If=1;break n}If||(sg.a=3),_d=If}(_d=_d&&!oa.h)&&(Af=_(O_,B_,8,zc,xf)),_d&&Af!=0?wd=Af:(bd.a=3,wd=0)}if(wd==0)break r;if(gd&&p_[xr]==1&&(gd=yd[Mn].g==0),tg+=yd[Mn].g,Mn+=wd,3>=xr){var Hc,$f=qc[0];for(Hc=1;Hc<xn;++Hc)qc[Hc]>$f&&($f=qc[Hc]);rg+=$f}}if(Co.nd=gd,Co.Qb=0,gd&&(Co.qb=(Hl[3][Wl[3]+0].value<<24|Hl[1][Wl[1]+0].value<<16|Hl[2][Wl[2]+0].value)>>>0,tg==0&&256>Hl[0][Wl[0]+0].value&&(Co.Qb=1,Co.qb+=Hl[0][Wl[0]+0].value<<8)),Co.jc=!Co.Qb&&6>rg,Co.jc){var Pd,_s=Co;for(Pd=0;Pd<ii;++Pd){var aa=Pd,la=_s.pd[aa],xd=_s.G[0][_s.H[0]+aa];256<=xd.value?(la.g=xd.g+256,la.value=xd.value):(la.g=0,la.value=0,aa>>=sr(xd,8,la),aa>>=sr(_s.G[1][_s.H[1]+aa],16,la),aa>>=sr(_s.G[2][_s.H[2]+aa],0,la),sr(_s.G[3][_s.H[3]+aa],24,la))}}}Kn.vc=oi,Kn.Wb=ki,Kn.Ya=md,Kn.yc=Pf,dn=1;break t}dn=0}if(!(ye=dn)){te.a=3;break e}if(0<Ke){if(Ee.ua=1<<Ke,!ue(Ee.Wa,Ke)){te.a=1,ye=0;break e}}else Ee.ua=0;var Ef=te,fg=ge,Y_=_e,kf=Ef.s,Tf=kf.xc;if(Ef.c=fg,Ef.i=Y_,kf.md=Se(fg,Tf),kf.wc=Tf==0?-1:(1<<Tf)-1,N){te.xb=A_;break e}if((Oe=o(ge*_e))==null){te.a=1,ye=0;break e}ye=(ye=tt(te,Oe,0,ge,_e,_e,null))&&!Ae.h;break e}return ye?(pe!=null?pe[0]=Oe:(e(Oe==null),e(N)),te.$=0,N||jt(Ee)):jt(Ee),ye}function Wr(d,v){var N=d.c*d.i,te=N+v+16*v;return e(d.c<=v),d.V=o(te),d.V==null?(d.Ta=null,d.Ua=0,d.a=1,0):(d.Ta=d.V,d.Ua=d.Ba+N+v,1)}function pr(d,v){var N=d.C,te=v-N,pe=d.V,ye=d.Ba+d.c*N;for(e(v<=d.l.o);0<te;){var ge=16<te?16:te,_e=d.l.ma,Ae=d.l.width,Ee=Ae*ge,Oe=_e.ca,Ke=_e.tb+Ae*N,Je=d.Ta,ze=d.Ua;At(d,ge,pe,ye),En(Je,ze,Oe,Ke,Ee),Zt(_e,N,N+ge,Oe,Ke,Ae),te-=ge,pe+=ge*d.c,N+=ge}e(N==v),d.C=d.Ma=v}function wr(){this.ub=this.yd=this.td=this.Rb=0}function $r(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function lr(){this.Fb=this.Bb=this.Cb=0,this.Zb=o(4),this.Lb=o(4)}function Br(){this.Yb=function(){var d=[];return function v(N,te,pe){for(var ye=pe[te],ge=0;ge<ye&&(N.push(pe.length>te+1?[]:0),!(pe.length<te+1));ge++)v(N[ge],te+1,pe)}(d,0,[3,11]),d}()}function tn(){this.jb=o(3),this.Wc=a([4,8],Br),this.Xc=a([4,17],Br)}function kt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new o(4),this.od=new o(4)}function Sr(){this.ld=this.La=this.dd=this.tc=0}function Cr(){this.Na=this.la=0}function jr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function kr(){this.ad=o(384),this.Za=0,this.Ob=o(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Yr(){this.uc=this.M=this.Nb=0,this.wa=Array(new Sr),this.Y=0,this.ya=Array(new kr),this.aa=0,this.l=new ln}function rn(){this.y=o(16),this.f=o(8),this.ea=o(8)}function yr(){this.cb=this.a=0,this.sc="",this.m=new re,this.Od=new wr,this.Kc=new $r,this.ed=new kt,this.Qa=new lr,this.Ic=this.$c=this.Aa=0,this.D=new Yr,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,re),this.ia=0,this.pb=s(4,jr),this.Pa=new tn,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new rn),this.Hd=0,this.rb=Array(new Cr),this.sb=0,this.wa=Array(new Sr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new kr),this.L=this.aa=0,this.gd=a([4,2],Sr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ln(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function _n(){var d=new yr;return d!=null&&(d.a=0,d.sc="OK",d.cb=0,d.Xb=0,jc||(jc=Li)),d}function Ir(d,v,N){return d.a==0&&(d.a=v,d.sc=N,d.cb=0),0}function wn(d,v,N){return 3<=N&&d[v+0]==157&&d[v+1]==1&&d[v+2]==42}function Cn(d,v){if(d==null)return 0;if(d.a=0,d.sc="OK",v==null)return Ir(d,2,"null VP8Io passed to VP8GetHeaders()");var N=v.data,te=v.w,pe=v.ha;if(4>pe)return Ir(d,7,"Truncated header.");var ye=N[te+0]|N[te+1]<<8|N[te+2]<<16,ge=d.Od;if(ge.Rb=!(1&ye),ge.td=ye>>1&7,ge.yd=ye>>4&1,ge.ub=ye>>5,3<ge.td)return Ir(d,3,"Incorrect keyframe parameters.");if(!ge.yd)return Ir(d,4,"Frame not displayable.");te+=3,pe-=3;var _e=d.Kc;if(ge.Rb){if(7>pe)return Ir(d,7,"cannot parse picture header");if(!wn(N,te,pe))return Ir(d,3,"Bad code word");_e.c=16383&(N[te+4]<<8|N[te+3]),_e.Td=N[te+4]>>6,_e.i=16383&(N[te+6]<<8|N[te+5]),_e.Ud=N[te+6]>>6,te+=7,pe-=7,d.za=_e.c+15>>4,d.Ub=_e.i+15>>4,v.width=_e.c,v.height=_e.i,v.Da=0,v.j=0,v.v=0,v.va=v.width,v.o=v.height,v.da=0,v.ib=v.width,v.hb=v.height,v.U=v.width,v.T=v.height,i((ye=d.Pa).jb,0,255,ye.jb.length),e((ye=d.Qa)!=null),ye.Cb=0,ye.Bb=0,ye.Fb=1,i(ye.Zb,0,0,ye.Zb.length),i(ye.Lb,0,0,ye.Lb)}if(ge.ub>pe)return Ir(d,7,"bad partition length");ie(ye=d.m,N,te,ge.ub),te+=ge.ub,pe-=ge.ub,ge.Rb&&(_e.Ld=K(ye),_e.Kd=K(ye)),_e=d.Qa;var Ae,Ee=d.Pa;if(e(ye!=null),e(_e!=null),_e.Cb=K(ye),_e.Cb){if(_e.Bb=K(ye),K(ye)){for(_e.Fb=K(ye),Ae=0;4>Ae;++Ae)_e.Zb[Ae]=K(ye)?W(ye,7):0;for(Ae=0;4>Ae;++Ae)_e.Lb[Ae]=K(ye)?W(ye,6):0}if(_e.Bb)for(Ae=0;3>Ae;++Ae)Ee.jb[Ae]=K(ye)?F(ye,8):255}else _e.Bb=0;if(ye.Ka)return Ir(d,3,"cannot parse segment header");if((_e=d.ed).zd=K(ye),_e.Tb=F(ye,6),_e.wb=F(ye,3),_e.Pc=K(ye),_e.Pc&&K(ye)){for(Ee=0;4>Ee;++Ee)K(ye)&&(_e.vd[Ee]=W(ye,6));for(Ee=0;4>Ee;++Ee)K(ye)&&(_e.od[Ee]=W(ye,6))}if(d.L=_e.Tb==0?0:_e.zd?1:2,ye.Ka)return Ir(d,3,"cannot parse filter header");var Oe=pe;if(pe=Ae=te,te=Ae+Oe,_e=Oe,d.Xb=(1<<F(d.m,2))-1,Oe<3*(Ee=d.Xb))N=7;else{for(Ae+=3*Ee,_e-=3*Ee,Oe=0;Oe<Ee;++Oe){var Ke=N[pe+0]|N[pe+1]<<8|N[pe+2]<<16;Ke>_e&&(Ke=_e),ie(d.Jc[+Oe],N,Ae,Ke),Ae+=Ke,_e-=Ke,pe+=3}ie(d.Jc[+Ee],N,Ae,_e),N=Ae<te?0:5}if(N!=0)return Ir(d,N,"cannot parse partitions");for(N=F(Ae=d.m,7),pe=K(Ae)?W(Ae,4):0,te=K(Ae)?W(Ae,4):0,_e=K(Ae)?W(Ae,4):0,Ee=K(Ae)?W(Ae,4):0,Ae=K(Ae)?W(Ae,4):0,Oe=d.Qa,Ke=0;4>Ke;++Ke){if(Oe.Cb){var Je=Oe.Zb[Ke];Oe.Fb||(Je+=N)}else{if(0<Ke){d.pb[Ke]=d.pb[0];continue}Je=N}var ze=d.pb[Ke];ze.Sc[0]=_f[Zr(Je+pe,127)],ze.Sc[1]=wf[Zr(Je+0,127)],ze.Eb[0]=2*_f[Zr(Je+te,127)],ze.Eb[1]=101581*wf[Zr(Je+_e,127)]>>16,8>ze.Eb[1]&&(ze.Eb[1]=8),ze.Qc[0]=_f[Zr(Je+Ee,117)],ze.Qc[1]=wf[Zr(Je+Ae,127)],ze.lc=Je+Ae}if(!ge.Rb)return Ir(d,4,"Not a key frame.");for(K(ye),ge=d.Pa,N=0;4>N;++N){for(pe=0;8>pe;++pe)for(te=0;3>te;++te)for(_e=0;11>_e;++_e)Ee=Z(ye,P_[N][pe][te][_e])?F(ye,8):w_[N][pe][te][_e],ge.Wc[N][pe].Yb[te][_e]=Ee;for(pe=0;17>pe;++pe)ge.Xc[N][pe]=ge.Wc[N][x_[pe]]}return d.kc=K(ye),d.kc&&(d.Bd=F(ye,8)),d.cb=1}function Li(d,v,N,te,pe,ye,ge){var _e=v[pe].Yb[N];for(N=0;16>pe;++pe){if(!Z(d,_e[N+0]))return pe;for(;!Z(d,_e[N+1]);)if(_e=v[++pe].Yb[0],N=0,pe==16)return 16;var Ae=v[pe+1].Yb;if(Z(d,_e[N+2])){var Ee=d,Oe=0;if(Z(Ee,(Je=_e)[(Ke=N)+3]))if(Z(Ee,Je[Ke+6])){for(_e=0,Ke=2*(Oe=Z(Ee,Je[Ke+8]))+(Je=Z(Ee,Je[Ke+9+Oe])),Oe=0,Je=b_[Ke];Je[_e];++_e)Oe+=Oe+Z(Ee,Je[_e]);Oe+=3+(8<<Ke)}else Z(Ee,Je[Ke+7])?(Oe=7+2*Z(Ee,165),Oe+=Z(Ee,145)):Oe=5+Z(Ee,159);else Oe=Z(Ee,Je[Ke+4])?3+Z(Ee,Je[Ke+5]):2;_e=Ae[2]}else Oe=1,_e=Ae[1];Ae=ge+__[pe],0>(Ee=d).b&&oe(Ee);var Ke,Je=Ee.b,ze=(Ke=Ee.Ca>>1)-(Ee.I>>Je)>>31;--Ee.b,Ee.Ca+=ze,Ee.Ca|=1,Ee.I-=(Ke+1&ze)<<Je,ye[Ae]=((Oe^ze)-ze)*te[(0<pe)+0]}return 16}function tr(d){var v=d.rb[d.sb-1];v.la=0,v.Na=0,i(d.zc,0,0,d.zc.length),d.ja=0}function Tr(d,v){if(d==null)return 0;if(v==null)return Ir(d,2,"NULL VP8Io parameter in VP8Decode().");if(!d.cb&&!Cn(d,v))return 0;if(e(d.cb),v.ac==null||v.ac(v)){v.ob&&(d.L=0);var N=pd[d.L];if(d.L==2?(d.yb=0,d.zb=0):(d.yb=v.v-N>>4,d.zb=v.j-N>>4,0>d.yb&&(d.yb=0),0>d.zb&&(d.zb=0)),d.Va=v.o+15+N>>4,d.Hb=v.va+15+N>>4,d.Hb>d.za&&(d.Hb=d.za),d.Va>d.Ub&&(d.Va=d.Ub),0<d.L){var te=d.ed;for(N=0;4>N;++N){var pe;if(d.Qa.Cb){var ye=d.Qa.Lb[N];d.Qa.Fb||(ye+=te.Tb)}else ye=te.Tb;for(pe=0;1>=pe;++pe){var ge=d.gd[N][pe],_e=ye;if(te.Pc&&(_e+=te.vd[0],pe&&(_e+=te.od[0])),0<(_e=0>_e?0:63<_e?63:_e)){var Ae=_e;0<te.wb&&(Ae=4<te.wb?Ae>>2:Ae>>1)>9-te.wb&&(Ae=9-te.wb),1>Ae&&(Ae=1),ge.dd=Ae,ge.tc=2*_e+Ae,ge.ld=40<=_e?2:15<=_e?1:0}else ge.tc=0;ge.La=pe}}}N=0}else Ir(d,6,"Frame setup failed"),N=d.a;if(N=N==0){if(N){d.$c=0,0<d.Aa||(d.Ic=F_);e:{N=d.Ic,te=4*(Ae=d.za);var Ee=32*Ae,Oe=Ae+1,Ke=0<d.L?Ae*(0<d.Aa?2:1):0,Je=(d.Aa==2?2:1)*Ae;if((ge=te+832+(pe=3*(16*N+pd[d.L])/2*Ee)+(ye=d.Fa!=null&&0<d.Fa.length?d.Kc.c*d.Kc.i:0))!=ge)N=0;else{if(ge>d.Vb){if(d.Vb=0,d.Ec=o(ge),d.Fc=0,d.Ec==null){N=Ir(d,1,"no memory during frame initialization.");break e}d.Vb=ge}ge=d.Ec,_e=d.Fc,d.Ac=ge,d.Bc=_e,_e+=te,d.Gd=s(Ee,rn),d.Hd=0,d.rb=s(Oe+1,Cr),d.sb=1,d.wa=Ke?s(Ke,Sr):null,d.Y=0,d.D.Nb=0,d.D.wa=d.wa,d.D.Y=d.Y,0<d.Aa&&(d.D.Y+=Ae),e(!0),d.oc=ge,d.pc=_e,_e+=832,d.ya=s(Je,kr),d.aa=0,d.D.ya=d.ya,d.D.aa=d.aa,d.Aa==2&&(d.D.aa+=Ae),d.R=16*Ae,d.B=8*Ae,Ae=(Ee=pd[d.L])*d.R,Ee=Ee/2*d.B,d.sa=ge,d.ta=_e+Ae,d.qa=d.sa,d.ra=d.ta+16*N*d.R+Ee,d.Ha=d.qa,d.Ia=d.ra+8*N*d.B+Ee,d.$c=0,_e+=pe,d.mb=ye?ge:null,d.nb=ye?_e:null,e(_e+ye<=d.Fc+d.Vb),tr(d),i(d.Ac,d.Bc,0,te),N=1}}if(N){if(v.ka=0,v.y=d.sa,v.O=d.ta,v.f=d.qa,v.N=d.ra,v.ea=d.Ha,v.Vd=d.Ia,v.fa=d.R,v.Rc=d.B,v.F=null,v.J=0,!od){for(N=-255;255>=N;++N)Un[255+N]=0>N?-N:N;for(N=-1020;1020>=N;++N)gs[1020+N]=-128>N?-128:127<N?127:N;for(N=-112;112>=N;++N)Bc[112+N]=-16>N?-16:15<N?15:N;for(N=-255;510>=N;++N)zl[255+N]=0>N?0:255<N?255:N;od=1}jl=Pn,ys=Fr,Mc=pn,Ei=Pr,so=Yn,$n=Gr,Vl=Us,id=So,Fc=Ws,Ja=Ya,Qa=Hs,ea=ds,Xa=Gs,ql=Vo,Za=us,ta=Yi,Oc=zn,ao=Ll,Ao[0]=Ri,Ao[1]=Wi,Ao[2]=io,Ao[3]=qa,Ao[4]=Vs,Ao[5]=Oo,Ao[6]=Ii,Ao[7]=cs,Ao[8]=qs,Ao[9]=Bo,ra[0]=no,ra[1]=ei,ra[2]=In,ra[3]=ti,ra[4]=cn,ra[5]=js,ra[6]=bo,vs[0]=wo,vs[1]=hi,vs[2]=Nl,vs[3]=_o,vs[4]=Xr,vs[5]=za,vs[6]=Ua,N=1}else N=0}N&&(N=function(ze,vt){for(ze.M=0;ze.M<ze.Va;++ze.M){var nt,Be=ze.Jc[ze.M&ze.Xb],je=ze.m,ft=ze;for(nt=0;nt<ft.za;++nt){var Pt=je,gt=ft,Vt=gt.Ac,Lt=gt.Bc+4*nt,ir=gt.zc,Mt=gt.ya[gt.aa+nt];if(gt.Qa.Bb?Mt.$b=Z(Pt,gt.Pa.jb[0])?2+Z(Pt,gt.Pa.jb[2]):Z(Pt,gt.Pa.jb[1]):Mt.$b=0,gt.kc&&(Mt.Ad=Z(Pt,gt.Bd)),Mt.Za=!Z(Pt,145)+0,Mt.Za){var Kr=Mt.Ob,nn=0;for(gt=0;4>gt;++gt){var zr,Lr=ir[0+gt];for(zr=0;4>zr;++zr){Lr=S_[Vt[Lt+zr]][Lr];for(var dn=Uy[Z(Pt,Lr[0])];0<dn;)dn=Uy[2*dn+Z(Pt,Lr[dn])];Lr=-dn,Vt[Lt+zr]=Lr}n(Kr,nn,Vt,Lt,4),nn+=4,ir[0+gt]=Lr}}else Lr=Z(Pt,156)?Z(Pt,128)?1:3:Z(Pt,163)?2:0,Mt.Ob[0]=Lr,i(Vt,Lt,Lr,4),i(ir,0,Lr,4);Mt.Dd=Z(Pt,142)?Z(Pt,114)?Z(Pt,183)?1:3:2:0}if(ft.m.Ka)return Ir(ze,7,"Premature end-of-partition0 encountered.");for(;ze.ja<ze.za;++ze.ja){if(ft=Be,Pt=(je=ze).rb[je.sb-1],Vt=je.rb[je.sb+je.ja],nt=je.ya[je.aa+je.ja],Lt=je.kc?nt.Ad:0)Pt.la=Vt.la=0,nt.Za||(Pt.Na=Vt.Na=0),nt.Hc=0,nt.Gc=0,nt.ia=0;else{var an,xr;if(Pt=Vt,Vt=ft,Lt=je.Pa.Xc,ir=je.ya[je.aa+je.ja],Mt=je.pb[ir.$b],gt=ir.ad,Kr=0,nn=je.rb[je.sb-1],Lr=zr=0,i(gt,Kr,0,384),ir.Za)var Mn=0,Oi=Lt[3];else{dn=o(16);var Fn=Pt.Na+nn.Na;if(Fn=jc(Vt,Lt[1],Fn,Mt.Eb,0,dn,0),Pt.Na=nn.Na=(0<Fn)+0,1<Fn)jl(dn,0,gt,Kr);else{var Bi=dn[0]+3>>3;for(dn=0;256>dn;dn+=16)gt[Kr+dn]=Bi}Mn=1,Oi=Lt[0]}var on=15&Pt.la,Ji=15&nn.la;for(dn=0;4>dn;++dn){var Qi=1&Ji;for(Bi=xr=0;4>Bi;++Bi)on=on>>1|(Qi=(Fn=jc(Vt,Oi,Fn=Qi+(1&on),Mt.Sc,Mn,gt,Kr))>Mn)<<7,xr=xr<<2|(3<Fn?3:1<Fn?2:gt[Kr+0]!=0),Kr+=16;on>>=4,Ji=Ji>>1|Qi<<7,zr=(zr<<8|xr)>>>0}for(Oi=on,Mn=Ji>>4,an=0;4>an;an+=2){for(xr=0,on=Pt.la>>4+an,Ji=nn.la>>4+an,dn=0;2>dn;++dn){for(Qi=1&Ji,Bi=0;2>Bi;++Bi)Fn=Qi+(1&on),on=on>>1|(Qi=0<(Fn=jc(Vt,Lt[2],Fn,Mt.Qc,0,gt,Kr)))<<3,xr=xr<<2|(3<Fn?3:1<Fn?2:gt[Kr+0]!=0),Kr+=16;on>>=2,Ji=Ji>>1|Qi<<5}Lr|=xr<<4*an,Oi|=on<<4<<an,Mn|=(240&Ji)<<an}Pt.la=Oi,nn.la=Mn,ir.Hc=zr,ir.Gc=Lr,ir.ia=43690&Lr?0:Mt.ia,Lt=!(zr|Lr)}if(0<je.L&&(je.wa[je.Y+je.ja]=je.gd[nt.$b][nt.Za],je.wa[je.Y+je.ja].La|=!Lt),ft.Ka)return Ir(ze,7,"Premature end-of-file encountered.")}if(tr(ze),je=vt,ft=1,nt=(Be=ze).D,Pt=0<Be.L&&Be.M>=Be.zb&&Be.M<=Be.Va,Be.Aa==0)e:{if(nt.M=Be.M,nt.uc=Pt,zo(Be,nt),ft=1,nt=(xr=Be.D).Nb,Pt=(Lr=pd[Be.L])*Be.R,Vt=Lr/2*Be.B,dn=16*nt*Be.R,Bi=8*nt*Be.B,Lt=Be.sa,ir=Be.ta-Pt+dn,Mt=Be.qa,gt=Be.ra-Vt+Bi,Kr=Be.Ha,nn=Be.Ia-Vt+Bi,Ji=(on=xr.M)==0,zr=on>=Be.Va-1,Be.Aa==2&&zo(Be,xr),xr.uc)for(Qi=(Fn=Be).D.M,e(Fn.D.uc),xr=Fn.yb;xr<Fn.Hb;++xr){Mn=xr,Oi=Qi;var Kn=(oi=(xn=Fn).D).Nb;an=xn.R;var oi=oi.wa[oi.Y+Mn],ki=xn.sa,ho=xn.ta+16*Kn*an+16*Mn,Ho=oi.dd,Jn=oi.tc;if(Jn!=0)if(e(3<=Jn),xn.L==1)0<Mn&&ta(ki,ho,an,Jn+4),oi.La&&ao(ki,ho,an,Jn),0<Oi&&Za(ki,ho,an,Jn+4),oi.La&&Oc(ki,ho,an,Jn);else{var bs=xn.B,el=xn.qa,Ul=xn.ra+8*Kn*bs+8*Mn,ia=xn.Ha,xn=xn.Ia+8*Kn*bs+8*Mn;Kn=oi.ld,0<Mn&&(id(ki,ho,an,Jn+4,Ho,Kn),Ja(el,Ul,ia,xn,bs,Jn+4,Ho,Kn)),oi.La&&(ea(ki,ho,an,Jn,Ho,Kn),ql(el,Ul,ia,xn,bs,Jn,Ho,Kn)),0<Oi&&(Vl(ki,ho,an,Jn+4,Ho,Kn),Fc(el,Ul,ia,xn,bs,Jn+4,Ho,Kn)),oi.La&&(Qa(ki,ho,an,Jn,Ho,Kn),Xa(el,Ul,ia,xn,bs,Jn,Ho,Kn))}}if(Be.ia&&alert("todo:DitherRow"),je.put!=null){if(xr=16*on,on=16*(on+1),Ji?(je.y=Be.sa,je.O=Be.ta+dn,je.f=Be.qa,je.N=Be.ra+Bi,je.ea=Be.Ha,je.W=Be.Ia+Bi):(xr-=Lr,je.y=Lt,je.O=ir,je.f=Mt,je.N=gt,je.ea=Kr,je.W=nn),zr||(on-=Lr),on>je.o&&(on=je.o),je.F=null,je.J=null,Be.Fa!=null&&0<Be.Fa.length&&xr<on&&(je.J=Qs(Be,je,xr,on-xr),je.F=Be.mb,je.F==null&&je.F.length==0)){ft=Ir(Be,3,"Could not decode alpha data.");break e}xr<je.j&&(Lr=je.j-xr,xr=je.j,e(!(1&Lr)),je.O+=Be.R*Lr,je.N+=Be.B*(Lr>>1),je.W+=Be.B*(Lr>>1),je.F!=null&&(je.J+=je.width*Lr)),xr<on&&(je.O+=je.v,je.N+=je.v>>1,je.W+=je.v>>1,je.F!=null&&(je.J+=je.v),je.ka=xr-je.j,je.U=je.va-je.v,je.T=on-xr,ft=je.put(je))}nt+1!=Be.Ic||zr||(n(Be.sa,Be.ta-Pt,Lt,ir+16*Be.R,Pt),n(Be.qa,Be.ra-Vt,Mt,gt+8*Be.B,Vt),n(Be.Ha,Be.Ia-Vt,Kr,nn+8*Be.B,Vt))}if(!ft)return Ir(ze,6,"Output aborted.")}return 1}(d,v)),v.bc!=null&&v.bc(v),N&=1}return N?(d.cb=0,N):0}function qr(d,v,N,te,pe){pe=d[v+N+32*te]+(pe>>3),d[v+N+32*te]=-256&pe?0>pe?0:255:pe}function bt(d,v,N,te,pe,ye){qr(d,v,0,N,te+pe),qr(d,v,1,N,te+ye),qr(d,v,2,N,te-ye),qr(d,v,3,N,te-pe)}function rr(d){return(20091*d>>16)+d}function fr(d,v,N,te){var pe,ye=0,ge=o(16);for(pe=0;4>pe;++pe){var _e=d[v+0]+d[v+8],Ae=d[v+0]-d[v+8],Ee=(35468*d[v+4]>>16)-rr(d[v+12]),Oe=rr(d[v+4])+(35468*d[v+12]>>16);ge[ye+0]=_e+Oe,ge[ye+1]=Ae+Ee,ge[ye+2]=Ae-Ee,ge[ye+3]=_e-Oe,ye+=4,v++}for(pe=ye=0;4>pe;++pe)_e=(d=ge[ye+0]+4)+ge[ye+8],Ae=d-ge[ye+8],Ee=(35468*ge[ye+4]>>16)-rr(ge[ye+12]),qr(N,te,0,0,_e+(Oe=rr(ge[ye+4])+(35468*ge[ye+12]>>16))),qr(N,te,1,0,Ae+Ee),qr(N,te,2,0,Ae-Ee),qr(N,te,3,0,_e-Oe),ye++,te+=32}function Gr(d,v,N,te){var pe=d[v+0]+4,ye=35468*d[v+4]>>16,ge=rr(d[v+4]),_e=35468*d[v+1]>>16;bt(N,te,0,pe+ge,d=rr(d[v+1]),_e),bt(N,te,1,pe+ye,d,_e),bt(N,te,2,pe-ye,d,_e),bt(N,te,3,pe-ge,d,_e)}function Fr(d,v,N,te,pe){fr(d,v,N,te),pe&&fr(d,v+16,N,te+4)}function pn(d,v,N,te){ys(d,v+0,N,te,1),ys(d,v+32,N,te+128,1)}function Pr(d,v,N,te){var pe;for(d=d[v+0]+4,pe=0;4>pe;++pe)for(v=0;4>v;++v)qr(N,te,v,pe,d)}function Yn(d,v,N,te){d[v+0]&&Ei(d,v+0,N,te),d[v+16]&&Ei(d,v+16,N,te+4),d[v+32]&&Ei(d,v+32,N,te+128),d[v+48]&&Ei(d,v+48,N,te+128+4)}function Pn(d,v,N,te){var pe,ye=o(16);for(pe=0;4>pe;++pe){var ge=d[v+0+pe]+d[v+12+pe],_e=d[v+4+pe]+d[v+8+pe],Ae=d[v+4+pe]-d[v+8+pe],Ee=d[v+0+pe]-d[v+12+pe];ye[0+pe]=ge+_e,ye[8+pe]=ge-_e,ye[4+pe]=Ee+Ae,ye[12+pe]=Ee-Ae}for(pe=0;4>pe;++pe)ge=(d=ye[0+4*pe]+3)+ye[3+4*pe],_e=ye[1+4*pe]+ye[2+4*pe],Ae=ye[1+4*pe]-ye[2+4*pe],Ee=d-ye[3+4*pe],N[te+0]=ge+_e>>3,N[te+16]=Ee+Ae>>3,N[te+32]=ge-_e>>3,N[te+48]=Ee-Ae>>3,te+=64}function Zn(d,v,N){var te,pe=v-32,ye=Ki,ge=255-d[pe-1];for(te=0;te<N;++te){var _e,Ae=ye,Ee=ge+d[v-1];for(_e=0;_e<N;++_e)d[v+_e]=Ae[Ee+d[pe+_e]];v+=32}}function Wi(d,v){Zn(d,v,4)}function hi(d,v){Zn(d,v,8)}function ei(d,v){Zn(d,v,16)}function In(d,v){var N;for(N=0;16>N;++N)n(d,v+32*N,d,v-32,16)}function ti(d,v){var N;for(N=16;0<N;--N)i(d,v,d[v-1],16),v+=32}function Di(d,v,N){var te;for(te=0;16>te;++te)i(v,N+32*te,d,16)}function no(d,v){var N,te=16;for(N=0;16>N;++N)te+=d[v-1+32*N]+d[v+N-32];Di(te>>5,d,v)}function cn(d,v){var N,te=8;for(N=0;16>N;++N)te+=d[v-1+32*N];Di(te>>4,d,v)}function js(d,v){var N,te=8;for(N=0;16>N;++N)te+=d[v+N-32];Di(te>>4,d,v)}function bo(d,v){Di(128,d,v)}function nr(d,v,N){return d+2*v+N+2>>2}function io(d,v){var N,te=v-32;for(te=new Uint8Array([nr(d[te-1],d[te+0],d[te+1]),nr(d[te+0],d[te+1],d[te+2]),nr(d[te+1],d[te+2],d[te+3]),nr(d[te+2],d[te+3],d[te+4])]),N=0;4>N;++N)n(d,v+32*N,te,0,te.length)}function qa(d,v){var N=d[v-1],te=d[v-1+32],pe=d[v-1+64],ye=d[v-1+96];J(d,v+0,16843009*nr(d[v-1-32],N,te)),J(d,v+32,16843009*nr(N,te,pe)),J(d,v+64,16843009*nr(te,pe,ye)),J(d,v+96,16843009*nr(pe,ye,ye))}function Ri(d,v){var N,te=4;for(N=0;4>N;++N)te+=d[v+N-32]+d[v-1+32*N];for(te>>=3,N=0;4>N;++N)i(d,v+32*N,te,4)}function Vs(d,v){var N=d[v-1+0],te=d[v-1+32],pe=d[v-1+64],ye=d[v-1-32],ge=d[v+0-32],_e=d[v+1-32],Ae=d[v+2-32],Ee=d[v+3-32];d[v+0+96]=nr(te,pe,d[v-1+96]),d[v+1+96]=d[v+0+64]=nr(N,te,pe),d[v+2+96]=d[v+1+64]=d[v+0+32]=nr(ye,N,te),d[v+3+96]=d[v+2+64]=d[v+1+32]=d[v+0+0]=nr(ge,ye,N),d[v+3+64]=d[v+2+32]=d[v+1+0]=nr(_e,ge,ye),d[v+3+32]=d[v+2+0]=nr(Ae,_e,ge),d[v+3+0]=nr(Ee,Ae,_e)}function Ii(d,v){var N=d[v+1-32],te=d[v+2-32],pe=d[v+3-32],ye=d[v+4-32],ge=d[v+5-32],_e=d[v+6-32],Ae=d[v+7-32];d[v+0+0]=nr(d[v+0-32],N,te),d[v+1+0]=d[v+0+32]=nr(N,te,pe),d[v+2+0]=d[v+1+32]=d[v+0+64]=nr(te,pe,ye),d[v+3+0]=d[v+2+32]=d[v+1+64]=d[v+0+96]=nr(pe,ye,ge),d[v+3+32]=d[v+2+64]=d[v+1+96]=nr(ye,ge,_e),d[v+3+64]=d[v+2+96]=nr(ge,_e,Ae),d[v+3+96]=nr(_e,Ae,Ae)}function Oo(d,v){var N=d[v-1+0],te=d[v-1+32],pe=d[v-1+64],ye=d[v-1-32],ge=d[v+0-32],_e=d[v+1-32],Ae=d[v+2-32],Ee=d[v+3-32];d[v+0+0]=d[v+1+64]=ye+ge+1>>1,d[v+1+0]=d[v+2+64]=ge+_e+1>>1,d[v+2+0]=d[v+3+64]=_e+Ae+1>>1,d[v+3+0]=Ae+Ee+1>>1,d[v+0+96]=nr(pe,te,N),d[v+0+64]=nr(te,N,ye),d[v+0+32]=d[v+1+96]=nr(N,ye,ge),d[v+1+32]=d[v+2+96]=nr(ye,ge,_e),d[v+2+32]=d[v+3+96]=nr(ge,_e,Ae),d[v+3+32]=nr(_e,Ae,Ee)}function cs(d,v){var N=d[v+0-32],te=d[v+1-32],pe=d[v+2-32],ye=d[v+3-32],ge=d[v+4-32],_e=d[v+5-32],Ae=d[v+6-32],Ee=d[v+7-32];d[v+0+0]=N+te+1>>1,d[v+1+0]=d[v+0+64]=te+pe+1>>1,d[v+2+0]=d[v+1+64]=pe+ye+1>>1,d[v+3+0]=d[v+2+64]=ye+ge+1>>1,d[v+0+32]=nr(N,te,pe),d[v+1+32]=d[v+0+96]=nr(te,pe,ye),d[v+2+32]=d[v+1+96]=nr(pe,ye,ge),d[v+3+32]=d[v+2+96]=nr(ye,ge,_e),d[v+3+64]=nr(ge,_e,Ae),d[v+3+96]=nr(_e,Ae,Ee)}function Bo(d,v){var N=d[v-1+0],te=d[v-1+32],pe=d[v-1+64],ye=d[v-1+96];d[v+0+0]=N+te+1>>1,d[v+2+0]=d[v+0+32]=te+pe+1>>1,d[v+2+32]=d[v+0+64]=pe+ye+1>>1,d[v+1+0]=nr(N,te,pe),d[v+3+0]=d[v+1+32]=nr(te,pe,ye),d[v+3+32]=d[v+1+64]=nr(pe,ye,ye),d[v+3+64]=d[v+2+64]=d[v+0+96]=d[v+1+96]=d[v+2+96]=d[v+3+96]=ye}function qs(d,v){var N=d[v-1+0],te=d[v-1+32],pe=d[v-1+64],ye=d[v-1+96],ge=d[v-1-32],_e=d[v+0-32],Ae=d[v+1-32],Ee=d[v+2-32];d[v+0+0]=d[v+2+32]=N+ge+1>>1,d[v+0+32]=d[v+2+64]=te+N+1>>1,d[v+0+64]=d[v+2+96]=pe+te+1>>1,d[v+0+96]=ye+pe+1>>1,d[v+3+0]=nr(_e,Ae,Ee),d[v+2+0]=nr(ge,_e,Ae),d[v+1+0]=d[v+3+32]=nr(N,ge,_e),d[v+1+32]=d[v+3+64]=nr(te,N,ge),d[v+1+64]=d[v+3+96]=nr(pe,te,N),d[v+1+96]=nr(ye,pe,te)}function Nl(d,v){var N;for(N=0;8>N;++N)n(d,v+32*N,d,v-32,8)}function _o(d,v){var N;for(N=0;8>N;++N)i(d,v,d[v-1],8),v+=32}function Gi(d,v,N){var te;for(te=0;8>te;++te)i(v,N+32*te,d,8)}function wo(d,v){var N,te=8;for(N=0;8>N;++N)te+=d[v+N-32]+d[v-1+32*N];Gi(te>>4,d,v)}function za(d,v){var N,te=4;for(N=0;8>N;++N)te+=d[v+N-32];Gi(te>>3,d,v)}function Xr(d,v){var N,te=4;for(N=0;8>N;++N)te+=d[v-1+32*N];Gi(te>>3,d,v)}function Ua(d,v){Gi(128,d,v)}function zs(d,v,N){var te=d[v-N],pe=d[v+0],ye=3*(pe-te)+mf[1020+d[v-2*N]-d[v+N]],ge=sd[112+(ye+4>>3)];d[v-N]=Ki[255+te+sd[112+(ye+3>>3)]],d[v+0]=Ki[255+pe-ge]}function Ha(d,v,N,te){var pe=d[v+0],ye=d[v+N];return co[255+d[v-2*N]-d[v-N]]>te||co[255+ye-pe]>te}function Wa(d,v,N,te){return 4*co[255+d[v-N]-d[v+0]]+co[255+d[v-2*N]-d[v+N]]<=te}function Ga(d,v,N,te,pe){var ye=d[v-3*N],ge=d[v-2*N],_e=d[v-N],Ae=d[v+0],Ee=d[v+N],Oe=d[v+2*N],Ke=d[v+3*N];return 4*co[255+_e-Ae]+co[255+ge-Ee]>te?0:co[255+d[v-4*N]-ye]<=pe&&co[255+ye-ge]<=pe&&co[255+ge-_e]<=pe&&co[255+Ke-Oe]<=pe&&co[255+Oe-Ee]<=pe&&co[255+Ee-Ae]<=pe}function us(d,v,N,te){var pe=2*te+1;for(te=0;16>te;++te)Wa(d,v+te,N,pe)&&zs(d,v+te,N)}function Yi(d,v,N,te){var pe=2*te+1;for(te=0;16>te;++te)Wa(d,v+te*N,1,pe)&&zs(d,v+te*N,1)}function zn(d,v,N,te){var pe;for(pe=3;0<pe;--pe)us(d,v+=4*N,N,te)}function Ll(d,v,N,te){var pe;for(pe=3;0<pe;--pe)Yi(d,v+=4,N,te)}function jo(d,v,N,te,pe,ye,ge,_e){for(ye=2*ye+1;0<pe--;){if(Ga(d,v,N,ye,ge))if(Ha(d,v,N,_e))zs(d,v,N);else{var Ae=d,Ee=v,Oe=N,Ke=Ae[Ee-2*Oe],Je=Ae[Ee-Oe],ze=Ae[Ee+0],vt=Ae[Ee+Oe],nt=Ae[Ee+2*Oe],Be=27*(ft=mf[1020+3*(ze-Je)+mf[1020+Ke-vt]])+63>>7,je=18*ft+63>>7,ft=9*ft+63>>7;Ae[Ee-3*Oe]=Ki[255+Ae[Ee-3*Oe]+ft],Ae[Ee-2*Oe]=Ki[255+Ke+je],Ae[Ee-Oe]=Ki[255+Je+Be],Ae[Ee+0]=Ki[255+ze-Be],Ae[Ee+Oe]=Ki[255+vt-je],Ae[Ee+2*Oe]=Ki[255+nt-ft]}v+=te}}function ri(d,v,N,te,pe,ye,ge,_e){for(ye=2*ye+1;0<pe--;){if(Ga(d,v,N,ye,ge))if(Ha(d,v,N,_e))zs(d,v,N);else{var Ae=d,Ee=v,Oe=N,Ke=Ae[Ee-Oe],Je=Ae[Ee+0],ze=Ae[Ee+Oe],vt=sd[112+((nt=3*(Je-Ke))+4>>3)],nt=sd[112+(nt+3>>3)],Be=vt+1>>1;Ae[Ee-2*Oe]=Ki[255+Ae[Ee-2*Oe]+Be],Ae[Ee-Oe]=Ki[255+Ke+nt],Ae[Ee+0]=Ki[255+Je-vt],Ae[Ee+Oe]=Ki[255+ze-Be]}v+=te}}function Us(d,v,N,te,pe,ye){jo(d,v,N,1,16,te,pe,ye)}function So(d,v,N,te,pe,ye){jo(d,v,1,N,16,te,pe,ye)}function Hs(d,v,N,te,pe,ye){var ge;for(ge=3;0<ge;--ge)ri(d,v+=4*N,N,1,16,te,pe,ye)}function ds(d,v,N,te,pe,ye){var ge;for(ge=3;0<ge;--ge)ri(d,v+=4,1,N,16,te,pe,ye)}function Ws(d,v,N,te,pe,ye,ge,_e){jo(d,v,pe,1,8,ye,ge,_e),jo(N,te,pe,1,8,ye,ge,_e)}function Ya(d,v,N,te,pe,ye,ge,_e){jo(d,v,1,pe,8,ye,ge,_e),jo(N,te,1,pe,8,ye,ge,_e)}function Gs(d,v,N,te,pe,ye,ge,_e){ri(d,v+4*pe,pe,1,8,ye,ge,_e),ri(N,te+4*pe,pe,1,8,ye,ge,_e)}function Vo(d,v,N,te,pe,ye,ge,_e){ri(d,v+4,1,pe,8,ye,ge,_e),ri(N,te+4,1,pe,8,ye,ge,_e)}function hs(){this.ba=new et,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new ot,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Ys(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function fs(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Ks(){this.ua=0,this.Wa=new q,this.vb=new q,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new G,this.yc=new I}function Dl(){this.xb=this.a=0,this.l=new ln,this.ca=new et,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new $,this.Pb=0,this.wd=new $,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Ks,this.ab=0,this.gc=s(4,fs),this.Oc=0}function Po(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new ln,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function qo(d,v,N,te,pe,ye,ge){for(d=d==null?0:d[v+0],v=0;v<ge;++v)pe[ye+v]=d+N[te+v]&255,d=pe[ye+v]}function Js(d,v,N,te,pe,ye,ge){var _e;if(d==null)qo(null,null,N,te,pe,ye,ge);else for(_e=0;_e<ge;++_e)pe[ye+_e]=d[v+_e]+N[te+_e]&255}function fi(d,v,N,te,pe,ye,ge){if(d==null)qo(null,null,N,te,pe,ye,ge);else{var _e,Ae=d[v+0],Ee=Ae,Oe=Ae;for(_e=0;_e<ge;++_e)Ee=Oe+(Ae=d[v+_e])-Ee,Oe=N[te+_e]+(-256&Ee?0>Ee?0:255:Ee)&255,Ee=Ae,pe[ye+_e]=Oe}}function Qs(d,v,N,te){var pe=v.width,ye=v.o;if(e(d!=null&&v!=null),0>N||0>=te||N+te>ye)return null;if(!d.Cc){if(d.ga==null){var ge;if(d.ga=new Po,(ge=d.ga==null)||(ge=v.width*v.o,e(d.Gb.length==0),d.Gb=o(ge),d.Uc=0,d.Gb==null?ge=0:(d.mb=d.Gb,d.nb=d.Uc,d.rc=null,ge=1),ge=!ge),!ge){ge=d.ga;var _e=d.Fa,Ae=d.P,Ee=d.qc,Oe=d.mb,Ke=d.nb,Je=Ae+1,ze=Ee-1,vt=ge.l;if(e(_e!=null&&Oe!=null&&v!=null),na[0]=null,na[1]=qo,na[2]=Js,na[3]=fi,ge.ca=Oe,ge.tb=Ke,ge.c=v.width,ge.i=v.height,e(0<ge.c&&0<ge.i),1>=Ee)v=0;else if(ge.$a=_e[Ae+0]>>0&3,ge.Z=_e[Ae+0]>>2&3,ge.Lc=_e[Ae+0]>>4&3,Ae=_e[Ae+0]>>6&3,0>ge.$a||1<ge.$a||4<=ge.Z||1<ge.Lc||Ae)v=0;else if(vt.put=qt,vt.ac=$t,vt.bc=Gt,vt.ma=ge,vt.width=v.width,vt.height=v.height,vt.Da=v.Da,vt.v=v.v,vt.va=v.va,vt.j=v.j,vt.o=v.o,ge.$a)e:{e(ge.$a==1),v=yt();t:for(;;){if(v==null){v=0;break e}if(e(ge!=null),ge.mc=v,v.c=ge.c,v.i=ge.i,v.l=ge.l,v.l.ma=ge,v.l.width=ge.c,v.l.height=ge.i,v.a=0,z(v.m,_e,Je,ze),!ar(ge.c,ge.i,1,v,null)||(v.ab==1&&v.gc[0].hc==3&&Jt(v.s)?(ge.ic=1,_e=v.c*v.i,v.Ta=null,v.Ua=0,v.V=o(_e),v.Ba=0,v.V==null?(v.a=1,v=0):v=1):(ge.ic=0,v=Wr(v,ge.c)),!v))break t;v=1;break e}ge.mc=null,v=0}else v=ze>=ge.c*ge.i;ge=!v}if(ge)return null;d.ga.Lc!=1?d.Ga=0:te=ye-N}e(d.ga!=null),e(N+te<=ye);e:{if(v=(_e=d.ga).c,ye=_e.l.o,_e.$a==0){if(Je=d.rc,ze=d.Vc,vt=d.Fa,Ae=d.P+1+N*v,Ee=d.mb,Oe=d.nb+N*v,e(Ae<=d.P+d.qc),_e.Z!=0)for(e(na[_e.Z]!=null),ge=0;ge<te;++ge)na[_e.Z](Je,ze,vt,Ae,Ee,Oe,v),Je=Ee,ze=Oe,Oe+=v,Ae+=v;else for(ge=0;ge<te;++ge)n(Ee,Oe,vt,Ae,v),Je=Ee,ze=Oe,Oe+=v,Ae+=v;d.rc=Je,d.Vc=ze}else{if(e(_e.mc!=null),v=N+te,e((ge=_e.mc)!=null),e(v<=ge.i),ge.C>=v)v=1;else if(_e.ic||qe(),_e.ic){_e=ge.V,Je=ge.Ba,ze=ge.c;var nt=ge.i,Be=(vt=1,Ae=ge.$/ze,Ee=ge.$%ze,Oe=ge.m,Ke=ge.s,ge.$),je=ze*nt,ft=ze*v,Pt=Ke.wc,gt=Be<ft?mt(Ke,Ee,Ae):null;e(Be<=je),e(v<=nt),e(Jt(Ke));t:for(;;){for(;!Oe.h&&Be<ft;){if(Ee&Pt||(gt=mt(Ke,Ee,Ae)),e(gt!=null),j(Oe),256>(nt=Qt(gt.G[0],gt.H[0],Oe)))_e[Je+Be]=nt,++Be,++Ee>=ze&&(Ee=0,++Ae<=v&&!(Ae%16)&&Ht(ge,Ae));else{if(!(280>nt)){vt=0;break t}nt=Kt(nt-256,Oe);var Vt,Lt=Qt(gt.G[4],gt.H[4],Oe);if(j(Oe),!(Be>=(Lt=Rt(ze,Lt=Kt(Lt,Oe)))&&je-Be>=nt)){vt=0;break t}for(Vt=0;Vt<nt;++Vt)_e[Je+Be+Vt]=_e[Je+Be+Vt-Lt];for(Be+=nt,Ee+=nt;Ee>=ze;)Ee-=ze,++Ae<=v&&!(Ae%16)&&Ht(ge,Ae);Be<ft&&Ee&Pt&&(gt=mt(Ke,Ee,Ae))}e(Oe.h==H(Oe))}Ht(ge,Ae>v?v:Ae);break t}!vt||Oe.h&&Be<je?(vt=0,ge.a=Oe.h?5:3):ge.$=Be,v=vt}else v=tt(ge,ge.V,ge.Ba,ge.c,ge.i,v,pr);if(!v){te=0;break e}}N+te>=ye&&(d.Cc=1),te=1}if(!te)return null;if(d.Cc&&((te=d.ga)!=null&&(te.mc=null),d.ga=null,0<d.Ga))return alert("todo:WebPDequantizeLevels"),null}return d.nb+N*pe}function P(d,v,N,te,pe,ye){for(;0<pe--;){var ge,_e=d,Ae=v+(N?1:0),Ee=d,Oe=v+(N?0:3);for(ge=0;ge<te;++ge){var Ke=Ee[Oe+4*ge];Ke!=255&&(Ke*=32897,_e[Ae+4*ge+0]=_e[Ae+4*ge+0]*Ke>>23,_e[Ae+4*ge+1]=_e[Ae+4*ge+1]*Ke>>23,_e[Ae+4*ge+2]=_e[Ae+4*ge+2]*Ke>>23)}v+=ye}}function fe(d,v,N,te,pe){for(;0<te--;){var ye;for(ye=0;ye<N;++ye){var ge=d[v+2*ye+0],_e=15&(Ee=d[v+2*ye+1]),Ae=4369*_e,Ee=(240&Ee|Ee>>4)*Ae>>16;d[v+2*ye+0]=(240&ge|ge>>4)*Ae>>16&240|(15&ge|ge<<4)*Ae>>16>>4&15,d[v+2*ye+1]=240&Ee|_e}v+=pe}}function Ne(d,v,N,te,pe,ye,ge,_e){var Ae,Ee,Oe=255;for(Ee=0;Ee<pe;++Ee){for(Ae=0;Ae<te;++Ae){var Ke=d[v+Ae];ye[ge+4*Ae]=Ke,Oe&=Ke}v+=N,ge+=_e}return Oe!=255}function Fe(d,v,N,te,pe){var ye;for(ye=0;ye<pe;++ye)N[te+ye]=d[v+ye]>>8}function qe(){lo=P,mn=fe,yn=Ne,En=Fe}function it(d,v,N){A[d]=function(te,pe,ye,ge,_e,Ae,Ee,Oe,Ke,Je,ze,vt,nt,Be,je,ft,Pt){var gt,Vt=Pt-1>>1,Lt=_e[Ae+0]|Ee[Oe+0]<<16,ir=Ke[Je+0]|ze[vt+0]<<16;e(te!=null);var Mt=3*Lt+ir+131074>>2;for(v(te[pe+0],255&Mt,Mt>>16,nt,Be),ye!=null&&(Mt=3*ir+Lt+131074>>2,v(ye[ge+0],255&Mt,Mt>>16,je,ft)),gt=1;gt<=Vt;++gt){var Kr=_e[Ae+gt]|Ee[Oe+gt]<<16,nn=Ke[Je+gt]|ze[vt+gt]<<16,zr=Lt+Kr+ir+nn+524296,Lr=zr+2*(Kr+ir)>>3;Mt=Lr+Lt>>1,Lt=(zr=zr+2*(Lt+nn)>>3)+Kr>>1,v(te[pe+2*gt-1],255&Mt,Mt>>16,nt,Be+(2*gt-1)*N),v(te[pe+2*gt-0],255&Lt,Lt>>16,nt,Be+(2*gt-0)*N),ye!=null&&(Mt=zr+ir>>1,Lt=Lr+nn>>1,v(ye[ge+2*gt-1],255&Mt,Mt>>16,je,ft+(2*gt-1)*N),v(ye[ge+2*gt+0],255&Lt,Lt>>16,je,ft+(2*gt+0)*N)),Lt=Kr,ir=nn}1&Pt||(Mt=3*Lt+ir+131074>>2,v(te[pe+Pt-1],255&Mt,Mt>>16,nt,Be+(Pt-1)*N),ye!=null&&(Mt=3*ir+Lt+131074>>2,v(ye[ge+Pt-1],255&Mt,Mt>>16,je,ft+(Pt-1)*N)))}}function Ct(){uo[ad]=C_,uo[ld]=Wy,uo[Vy]=I_,uo[cd]=Gy,uo[ud]=Yy,uo[yf]=Ky,uo[qy]=$_,uo[gf]=Wy,uo[vf]=Gy,uo[dd]=Yy,uo[bf]=Ky}function Dt(d){return d&-16384?0>d?0:255:d>>E_}function f(d,v){return Dt((19077*d>>8)+(26149*v>>8)-14234)}function M(d,v,N){return Dt((19077*d>>8)-(6419*v>>8)-(13320*N>>8)+8708)}function se(d,v){return Dt((19077*d>>8)+(33050*v>>8)-17685)}function be(d,v,N,te,pe){te[pe+0]=f(d,N),te[pe+1]=M(d,v,N),te[pe+2]=se(d,v)}function Ve(d,v,N,te,pe){te[pe+0]=se(d,v),te[pe+1]=M(d,v,N),te[pe+2]=f(d,N)}function Qe(d,v,N,te,pe){var ye=M(d,v,N);v=ye<<3&224|se(d,v)>>3,te[pe+0]=248&f(d,N)|ye>>5,te[pe+1]=v}function It(d,v,N,te,pe){var ye=240&se(d,v)|15;te[pe+0]=240&f(d,N)|M(d,v,N)>>4,te[pe+1]=ye}function gr(d,v,N,te,pe){te[pe+0]=255,be(d,v,N,te,pe+1)}function Nr(d,v,N,te,pe){Ve(d,v,N,te,pe),te[pe+3]=255}function vr(d,v,N,te,pe){be(d,v,N,te,pe),te[pe+3]=255}function Zr(d,v){return 0>d?0:d>v?v:d}function un(d,v,N){A[d]=function(te,pe,ye,ge,_e,Ae,Ee,Oe,Ke){for(var Je=Oe+(-2&Ke)*N;Oe!=Je;)v(te[pe+0],ye[ge+0],_e[Ae+0],Ee,Oe),v(te[pe+1],ye[ge+0],_e[Ae+0],Ee,Oe+N),pe+=2,++ge,++Ae,Oe+=2*N;1&Ke&&v(te[pe+0],ye[ge+0],_e[Ae+0],Ee,Oe)}}function xo(d,v,N){return N==0?d==0?v==0?6:5:v==0?4:0:N}function ni(d,v,N,te,pe){switch(d>>>30){case 3:ys(v,N,te,pe,0);break;case 2:$n(v,N,te,pe);break;case 1:Ei(v,N,te,pe)}}function zo(d,v){var N,te,pe=v.M,ye=v.Nb,ge=d.oc,_e=d.pc+40,Ae=d.oc,Ee=d.pc+584,Oe=d.oc,Ke=d.pc+600;for(N=0;16>N;++N)ge[_e+32*N-1]=129;for(N=0;8>N;++N)Ae[Ee+32*N-1]=129,Oe[Ke+32*N-1]=129;for(0<pe?ge[_e-1-32]=Ae[Ee-1-32]=Oe[Ke-1-32]=129:(i(ge,_e-32-1,127,21),i(Ae,Ee-32-1,127,9),i(Oe,Ke-32-1,127,9)),te=0;te<d.za;++te){var Je=v.ya[v.aa+te];if(0<te){for(N=-1;16>N;++N)n(ge,_e+32*N-4,ge,_e+32*N+12,4);for(N=-1;8>N;++N)n(Ae,Ee+32*N-4,Ae,Ee+32*N+4,4),n(Oe,Ke+32*N-4,Oe,Ke+32*N+4,4)}var ze=d.Gd,vt=d.Hd+te,nt=Je.ad,Be=Je.Hc;if(0<pe&&(n(ge,_e-32,ze[vt].y,0,16),n(Ae,Ee-32,ze[vt].f,0,8),n(Oe,Ke-32,ze[vt].ea,0,8)),Je.Za){var je=ge,ft=_e-32+16;for(0<pe&&(te>=d.za-1?i(je,ft,ze[vt].y[15],4):n(je,ft,ze[vt+1].y,0,4)),N=0;4>N;N++)je[ft+128+N]=je[ft+256+N]=je[ft+384+N]=je[ft+0+N];for(N=0;16>N;++N,Be<<=2)je=ge,ft=_e+Qy[N],Ao[Je.Ob[N]](je,ft),ni(Be,nt,16*+N,je,ft)}else if(je=xo(te,pe,Je.Ob[0]),ra[je](ge,_e),Be!=0)for(N=0;16>N;++N,Be<<=2)ni(Be,nt,16*+N,ge,_e+Qy[N]);for(N=Je.Gc,je=xo(te,pe,Je.Dd),vs[je](Ae,Ee),vs[je](Oe,Ke),Be=nt,je=Ae,ft=Ee,255&(Je=N>>0)&&(170&Je?Mc(Be,256,je,ft):so(Be,256,je,ft)),Je=Oe,Be=Ke,255&(N>>=8)&&(170&N?Mc(nt,320,Je,Be):so(nt,320,Je,Be)),pe<d.Ub-1&&(n(ze[vt].y,0,ge,_e+480,16),n(ze[vt].f,0,Ae,Ee+224,8),n(ze[vt].ea,0,Oe,Ke+224,8)),N=8*ye*d.B,ze=d.sa,vt=d.ta+16*te+16*ye*d.R,nt=d.qa,Je=d.ra+8*te+N,Be=d.Ha,je=d.Ia+8*te+N,N=0;16>N;++N)n(ze,vt+N*d.R,ge,_e+32*N,16);for(N=0;8>N;++N)n(nt,Je+N*d.B,Ae,Ee+32*N,8),n(Be,je+N*d.B,Oe,Ke+32*N,8)}}function Uo(d,v,N,te,pe,ye,ge,_e,Ae){var Ee=[0],Oe=[0],Ke=0,Je=Ae!=null?Ae.kd:0,ze=Ae??new Ys;if(d==null||12>N)return 7;ze.data=d,ze.w=v,ze.ha=N,v=[v],N=[N],ze.gb=[ze.gb];e:{var vt=v,nt=N,Be=ze.gb;if(e(d!=null),e(nt!=null),e(Be!=null),Be[0]=0,12<=nt[0]&&!r(d,vt[0],"RIFF")){if(r(d,vt[0]+8,"WEBP")){Be=3;break e}var je=ae(d,vt[0]+4);if(12>je||4294967286<je){Be=3;break e}if(Je&&je>nt[0]-8){Be=7;break e}Be[0]=je,vt[0]+=12,nt[0]-=12}Be=0}if(Be!=0)return Be;for(je=0<ze.gb[0],N=N[0];;){e:{var ft=d;nt=v,Be=N;var Pt=Ee,gt=Oe,Vt=vt=[0];if((Mt=Ke=[Ke])[0]=0,8>Be[0])Be=7;else{if(!r(ft,nt[0],"VP8X")){if(ae(ft,nt[0]+4)!=10){Be=3;break e}if(18>Be[0]){Be=7;break e}var Lt=ae(ft,nt[0]+8),ir=1+U(ft,nt[0]+12);if(2147483648<=ir*(ft=1+U(ft,nt[0]+15))){Be=3;break e}Vt!=null&&(Vt[0]=Lt),Pt!=null&&(Pt[0]=ir),gt!=null&&(gt[0]=ft),nt[0]+=18,Be[0]-=18,Mt[0]=1}Be=0}}if(Ke=Ke[0],vt=vt[0],Be!=0)return Be;if(nt=!!(2&vt),!je&&Ke)return 3;if(ye!=null&&(ye[0]=!!(16&vt)),ge!=null&&(ge[0]=nt),_e!=null&&(_e[0]=0),ge=Ee[0],vt=Oe[0],Ke&&nt&&Ae==null){Be=0;break}if(4>N){Be=7;break}if(je&&Ke||!je&&!Ke&&!r(d,v[0],"ALPH")){N=[N],ze.na=[ze.na],ze.P=[ze.P],ze.Sa=[ze.Sa];e:{Lt=d,Be=v,je=N;var Mt=ze.gb;Pt=ze.na,gt=ze.P,Vt=ze.Sa,ir=22,e(Lt!=null),e(je!=null),ft=Be[0];var Kr=je[0];for(e(Pt!=null),e(Vt!=null),Pt[0]=null,gt[0]=null,Vt[0]=0;;){if(Be[0]=ft,je[0]=Kr,8>Kr){Be=7;break e}var nn=ae(Lt,ft+4);if(4294967286<nn){Be=3;break e}var zr=8+nn+1&-2;if(ir+=zr,0<Mt&&ir>Mt){Be=3;break e}if(!r(Lt,ft,"VP8 ")||!r(Lt,ft,"VP8L")){Be=0;break e}if(Kr[0]<zr){Be=7;break e}r(Lt,ft,"ALPH")||(Pt[0]=Lt,gt[0]=ft+8,Vt[0]=nn),ft+=zr,Kr-=zr}}if(N=N[0],ze.na=ze.na[0],ze.P=ze.P[0],ze.Sa=ze.Sa[0],Be!=0)break}N=[N],ze.Ja=[ze.Ja],ze.xa=[ze.xa];e:if(Mt=d,Be=v,je=N,Pt=ze.gb[0],gt=ze.Ja,Vt=ze.xa,Lt=Be[0],ft=!r(Mt,Lt,"VP8 "),ir=!r(Mt,Lt,"VP8L"),e(Mt!=null),e(je!=null),e(gt!=null),e(Vt!=null),8>je[0])Be=7;else{if(ft||ir){if(Mt=ae(Mt,Lt+4),12<=Pt&&Mt>Pt-12){Be=3;break e}if(Je&&Mt>je[0]-8){Be=7;break e}gt[0]=Mt,Be[0]+=8,je[0]-=8,Vt[0]=ir}else Vt[0]=5<=je[0]&&Mt[Lt+0]==47&&!(Mt[Lt+4]>>5),gt[0]=je[0];Be=0}if(N=N[0],ze.Ja=ze.Ja[0],ze.xa=ze.xa[0],v=v[0],Be!=0)break;if(4294967286<ze.Ja)return 3;if(_e==null||nt||(_e[0]=ze.xa?2:1),ge=[ge],vt=[vt],ze.xa){if(5>N){Be=7;break}_e=ge,Je=vt,nt=ye,d==null||5>N?d=0:5<=N&&d[v+0]==47&&!(d[v+4]>>5)?(je=[0],Mt=[0],Pt=[0],z(gt=new $,d,v,N),ht(gt,je,Mt,Pt)?(_e!=null&&(_e[0]=je[0]),Je!=null&&(Je[0]=Mt[0]),nt!=null&&(nt[0]=Pt[0]),d=1):d=0):d=0}else{if(10>N){Be=7;break}_e=vt,d==null||10>N||!wn(d,v+3,N-3)?d=0:(Je=d[v+0]|d[v+1]<<8|d[v+2]<<16,nt=16383&(d[v+7]<<8|d[v+6]),d=16383&(d[v+9]<<8|d[v+8]),1&Je||3<(Je>>1&7)||!(Je>>4&1)||Je>>5>=ze.Ja||!nt||!d?d=0:(ge&&(ge[0]=nt),_e&&(_e[0]=d),d=1))}if(!d||(ge=ge[0],vt=vt[0],Ke&&(Ee[0]!=ge||Oe[0]!=vt)))return 3;Ae!=null&&(Ae[0]=ze,Ae.offset=v-Ae.w,e(4294967286>v-Ae.w),e(Ae.offset==Ae.ha-N));break}return Be==0||Be==7&&Ke&&Ae==null?(ye!=null&&(ye[0]|=ze.na!=null&&0<ze.na.length),te!=null&&(te[0]=ge),pe!=null&&(pe[0]=vt),0):Be}function Nc(d,v,N){var te=v.width,pe=v.height,ye=0,ge=0,_e=te,Ae=pe;if(v.Da=d!=null&&0<d.Da,v.Da&&(_e=d.cd,Ae=d.bd,ye=d.v,ge=d.j,11>N||(ye&=-2,ge&=-2),0>ye||0>ge||0>=_e||0>=Ae||ye+_e>te||ge+Ae>pe))return 0;if(v.v=ye,v.j=ge,v.va=ye+_e,v.o=ge+Ae,v.U=_e,v.T=Ae,v.da=d!=null&&0<d.da,v.da){if(!ce(_e,Ae,N=[d.ib],ye=[d.hb]))return 0;v.ib=N[0],v.hb=ye[0]}return v.ob=d!=null&&d.ob,v.Kb=d==null||!d.Sd,v.da&&(v.ob=v.ib<3*te/4&&v.hb<3*pe/4,v.Kb=0),1}function Lc(d){if(d==null)return 2;if(11>d.S){var v=d.f.RGBA;v.fb+=(d.height-1)*v.A,v.A=-v.A}else v=d.f.kb,d=d.height,v.O+=(d-1)*v.fa,v.fa=-v.fa,v.N+=(d-1>>1)*v.Ab,v.Ab=-v.Ab,v.W+=(d-1>>1)*v.Db,v.Db=-v.Db,v.F!=null&&(v.J+=(d-1)*v.lb,v.lb=-v.lb);return 0}function Rl(d,v,N,te){if(te==null||0>=d||0>=v)return 2;if(N!=null){if(N.Da){var pe=N.cd,ye=N.bd,ge=-2&N.v,_e=-2&N.j;if(0>ge||0>_e||0>=pe||0>=ye||ge+pe>d||_e+ye>v)return 2;d=pe,v=ye}if(N.da){if(!ce(d,v,pe=[N.ib],ye=[N.hb]))return 2;d=pe[0],v=ye[0]}}te.width=d,te.height=v;e:{var Ae=te.width,Ee=te.height;if(d=te.S,0>=Ae||0>=Ee||!(d>=ad&&13>d))d=2;else{if(0>=te.Rd&&te.sd==null){ge=ye=pe=v=0;var Oe=(_e=Ae*Xy[d])*Ee;if(11>d||(ye=(Ee+1)/2*(v=(Ae+1)/2),d==12&&(ge=(pe=Ae)*Ee)),(Ee=o(Oe+2*ye+ge))==null){d=1;break e}te.sd=Ee,11>d?((Ae=te.f.RGBA).eb=Ee,Ae.fb=0,Ae.A=_e,Ae.size=Oe):((Ae=te.f.kb).y=Ee,Ae.O=0,Ae.fa=_e,Ae.Fd=Oe,Ae.f=Ee,Ae.N=0+Oe,Ae.Ab=v,Ae.Cd=ye,Ae.ea=Ee,Ae.W=0+Oe+ye,Ae.Db=v,Ae.Ed=ye,d==12&&(Ae.F=Ee,Ae.J=0+Oe+2*ye),Ae.Tc=ge,Ae.lb=pe)}if(v=1,pe=te.S,ye=te.width,ge=te.height,pe>=ad&&13>pe)if(11>pe)d=te.f.RGBA,v&=(_e=Math.abs(d.A))*(ge-1)+ye<=d.size,v&=_e>=ye*Xy[pe],v&=d.eb!=null;else{d=te.f.kb,_e=(ye+1)/2,Oe=(ge+1)/2,Ae=Math.abs(d.fa),Ee=Math.abs(d.Ab);var Ke=Math.abs(d.Db),Je=Math.abs(d.lb),ze=Je*(ge-1)+ye;v&=Ae*(ge-1)+ye<=d.Fd,v&=Ee*(Oe-1)+_e<=d.Cd,v=(v&=Ke*(Oe-1)+_e<=d.Ed)&Ae>=ye&Ee>=_e&Ke>=_e,v&=d.y!=null,v&=d.f!=null,v&=d.ea!=null,pe==12&&(v&=Je>=ye,v&=ze<=d.Tc,v&=d.F!=null)}else v=0;d=v?0:2}}return d!=0||N!=null&&N.fd&&(d=Lc(te)),d}var ii=64,Ml=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Fl=24,Ol=32,Dc=8,Mi=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Pe("Predictor0","PredictorAdd0"),A.Predictor0=function(){return 4278190080},A.Predictor1=function(d){return d},A.Predictor2=function(d,v,N){return v[N+0]},A.Predictor3=function(d,v,N){return v[N+1]},A.Predictor4=function(d,v,N){return v[N-1]},A.Predictor5=function(d,v,N){return he(he(d,v[N+1]),v[N+0])},A.Predictor6=function(d,v,N){return he(d,v[N-1])},A.Predictor7=function(d,v,N){return he(d,v[N+0])},A.Predictor8=function(d,v,N){return he(v[N-1],v[N+0])},A.Predictor9=function(d,v,N){return he(v[N+0],v[N+1])},A.Predictor10=function(d,v,N){return he(he(d,v[N-1]),he(v[N+0],v[N+1]))},A.Predictor11=function(d,v,N){var te=v[N+0];return 0>=ke(te>>24&255,d>>24&255,(v=v[N-1])>>24&255)+ke(te>>16&255,d>>16&255,v>>16&255)+ke(te>>8&255,d>>8&255,v>>8&255)+ke(255&te,255&d,255&v)?te:d},A.Predictor12=function(d,v,N){var te=v[N+0];return(ve((d>>24&255)+(te>>24&255)-((v=v[N-1])>>24&255))<<24|ve((d>>16&255)+(te>>16&255)-(v>>16&255))<<16|ve((d>>8&255)+(te>>8&255)-(v>>8&255))<<8|ve((255&d)+(255&te)-(255&v)))>>>0},A.Predictor13=function(d,v,N){var te=v[N-1];return(De((d=he(d,v[N+0]))>>24&255,te>>24&255)<<24|De(d>>16&255,te>>16&255)<<16|De(d>>8&255,te>>8&255)<<8|De(d>>0&255,te>>0&255))>>>0};var pf=A.PredictorAdd0;A.PredictorAdd1=Ce,Pe("Predictor2","PredictorAdd2"),Pe("Predictor3","PredictorAdd3"),Pe("Predictor4","PredictorAdd4"),Pe("Predictor5","PredictorAdd5"),Pe("Predictor6","PredictorAdd6"),Pe("Predictor7","PredictorAdd7"),Pe("Predictor8","PredictorAdd8"),Pe("Predictor9","PredictorAdd9"),Pe("Predictor10","PredictorAdd10"),Pe("Predictor11","PredictorAdd11"),Pe("Predictor12","PredictorAdd12"),Pe("Predictor13","PredictorAdd13");var Rc=A.PredictorAdd2;He("ColorIndexInverseTransform","MapARGB","32b",function(d){return d>>8&255},function(d){return d}),He("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(d){return d},function(d){return d>>8&255});var td,oo=A.ColorIndexInverseTransform,Bl=A.MapARGB,rd=A.VP8LColorIndexInverseTransformAlpha,nd=A.MapAlpha,Xs=A.VP8LPredictorsAdd=[];Xs.length=16,(A.VP8LPredictors=[]).length=16,(A.VP8LPredictorsAdd_C=[]).length=16,(A.VP8LPredictors_C=[]).length=16;var Ka,Fi,$i,Zs,ps,ms,jl,ys,$n,Mc,Ei,so,Vl,id,Fc,Ja,Qa,ea,Xa,ql,Za,ta,Oc,ao,lo,mn,yn,En,Un=o(511),gs=o(2041),Bc=o(225),zl=o(767),od=0,mf=gs,sd=Bc,Ki=zl,co=Un,ad=0,ld=1,Vy=2,cd=3,ud=4,yf=5,qy=6,gf=7,vf=8,dd=9,bf=10,h_=[2,3,7],f_=[3,3,11],zy=[280,256,256,256,40],p_=[0,1,1,1,0],m_=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],y_=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],g_=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],v_=8,_f=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],wf=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],jc=null,b_=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],__=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Uy=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],w_=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],S_=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],P_=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],x_=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ra=[],Ao=[],vs=[],A_=1,Hy=2,na=[],uo=[];it("UpsampleRgbLinePair",be,3),it("UpsampleBgrLinePair",Ve,3),it("UpsampleRgbaLinePair",vr,4),it("UpsampleBgraLinePair",Nr,4),it("UpsampleArgbLinePair",gr,4),it("UpsampleRgba4444LinePair",It,2),it("UpsampleRgb565LinePair",Qe,2);var C_=A.UpsampleRgbLinePair,I_=A.UpsampleBgrLinePair,Wy=A.UpsampleRgbaLinePair,Gy=A.UpsampleBgraLinePair,Yy=A.UpsampleArgbLinePair,Ky=A.UpsampleRgba4444LinePair,$_=A.UpsampleRgb565LinePair,hd=16,fd=1<<hd-1,Vc=-227,Sf=482,E_=6,Jy=0,k_=o(256),T_=o(256),N_=o(256),L_=o(256),D_=o(Sf-Vc),R_=o(Sf-Vc);un("YuvToRgbRow",be,3),un("YuvToBgrRow",Ve,3),un("YuvToRgbaRow",vr,4),un("YuvToBgraRow",Nr,4),un("YuvToArgbRow",gr,4),un("YuvToRgba4444Row",It,2),un("YuvToRgb565Row",Qe,2);var Qy=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],pd=[0,2,8],M_=[8,7,6,4,4,2,2,2,1,1,1,1],F_=1;this.WebPDecodeRGBA=function(d,v,N,te,pe){var ye=ld,ge=new hs,_e=new et;ge.ba=_e,_e.S=ye,_e.width=[_e.width],_e.height=[_e.height];var Ae=_e.width,Ee=_e.height,Oe=new Ue;if(Oe==null||d==null)var Ke=2;else e(Oe!=null),Ke=Uo(d,v,N,Oe.width,Oe.height,Oe.Pd,Oe.Qd,Oe.format,null);if(Ke!=0?Ae=0:(Ae!=null&&(Ae[0]=Oe.width[0]),Ee!=null&&(Ee[0]=Oe.height[0]),Ae=1),Ae){_e.width=_e.width[0],_e.height=_e.height[0],te!=null&&(te[0]=_e.width),pe!=null&&(pe[0]=_e.height);e:{if(te=new ln,(pe=new Ys).data=d,pe.w=v,pe.ha=N,pe.kd=1,v=[0],e(pe!=null),((d=Uo(pe.data,pe.w,pe.ha,null,null,null,v,null,pe))==0||d==7)&&v[0]&&(d=4),(v=d)==0){if(e(ge!=null),te.data=pe.data,te.w=pe.w+pe.offset,te.ha=pe.ha-pe.offset,te.put=qt,te.ac=$t,te.bc=Gt,te.ma=ge,pe.xa){if((d=yt())==null){ge=1;break e}if(function(Je,ze){var vt=[0],nt=[0],Be=[0];t:for(;;){if(Je==null)return 0;if(ze==null)return Je.a=2,0;if(Je.l=ze,Je.a=0,z(Je.m,ze.data,ze.w,ze.ha),!ht(Je.m,vt,nt,Be)){Je.a=3;break t}if(Je.xb=Hy,ze.width=vt[0],ze.height=nt[0],!ar(vt[0],nt[0],1,Je,null))break t;return 1}return e(Je.a!=0),0}(d,te)){if(te=(v=Rl(te.width,te.height,ge.Oa,ge.ba))==0){t:{te=d;r:for(;;){if(te==null){te=0;break t}if(e(te.s.yc!=null),e(te.s.Ya!=null),e(0<te.s.Wb),e((N=te.l)!=null),e((pe=N.ma)!=null),te.xb!=0){if(te.ca=pe.ba,te.tb=pe.tb,e(te.ca!=null),!Nc(pe.Oa,N,cd)){te.a=2;break r}if(!Wr(te,N.width)||N.da)break r;if((N.da||pt(te.ca.S))&&qe(),11>te.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),te.ca.f.kb.F!=null&&qe()),te.Pb&&0<te.s.ua&&te.s.vb.X==null&&!ue(te.s.vb,te.s.Wa.Xa)){te.a=1;break r}te.xb=0}if(!tt(te,te.V,te.Ba,te.c,te.i,N.o,Ot))break r;pe.Dc=te.Ma,te=1;break t}e(te.a!=0),te=0}te=!te}te&&(v=d.a)}else v=d.a}else{if((d=new _n)==null){ge=1;break e}if(d.Fa=pe.na,d.P=pe.P,d.qc=pe.Sa,Cn(d,te)){if((v=Rl(te.width,te.height,ge.Oa,ge.ba))==0){if(d.Aa=0,N=ge.Oa,e((pe=d)!=null),N!=null){if(0<(Ae=0>(Ae=N.Md)?0:100<Ae?255:255*Ae/100)){for(Ee=Oe=0;4>Ee;++Ee)12>(Ke=pe.pb[Ee]).lc&&(Ke.ia=Ae*M_[0>Ke.lc?0:Ke.lc]>>3),Oe|=Ke.ia;Oe&&(alert("todo:VP8InitRandom"),pe.ia=1)}pe.Ga=N.Id,100<pe.Ga?pe.Ga=100:0>pe.Ga&&(pe.Ga=0)}Tr(d,te)||(v=d.a)}}else v=d.a}v==0&&ge.Oa!=null&&ge.Oa.fd&&(v=Lc(ge.ba))}ge=v}ye=ge!=0?null:11>ye?_e.f.RGBA.eb:_e.f.kb.y}else ye=null;return ye};var Xy=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(A,T){for(var R="",_=0;_<4;_++)R+=String.fromCharCode(A[T++]);return R}function h(A,T){return(A[T+0]<<0|A[T+1]<<8|A[T+2]<<16)>>>0}function y(A,T){return(A[T+0]<<0|A[T+1]<<8|A[T+2]<<16|A[T+3]<<24)>>>0}new c;var g=[0],p=[0],C=[],S=new c,w=t,x=function(A,T){var R={},_=0,I=!1,b=0,G=0;if(R.frames=[],!function(D,H,L,j){for(var oe=0;oe<j;oe++)if(D[H+oe]!=L.charCodeAt(oe))return!0;return!1}(A,T,"RIFF",4)){for(y(A,T+=4),T+=8;T<A.length;){var ie=u(A,T),F=y(A,T+=4);T+=4;var W=F+(1&F);switch(ie){case"VP8 ":case"VP8L":R.frames[_]===void 0&&(R.frames[_]={}),(k=R.frames[_]).src_off=I?G:T-8,k.src_size=b+F+8,_++,I&&(I=!1,b=0,G=0);break;case"VP8X":(k=R.header={}).feature_flags=A[T];var z=T+4;k.canvas_width=1+h(A,z),z+=3,k.canvas_height=1+h(A,z),z+=3;break;case"ALPH":I=!0,b=W+8,G=T-8;break;case"ANIM":(k=R.header).bgcolor=y(A,T),z=T+4,k.loop_count=(re=A)[($=z)+0]<<0|re[$+1]<<8,z+=2;break;case"ANMF":var O,k;(k=R.frames[_]={}).offset_x=2*h(A,T),T+=3,k.offset_y=2*h(A,T),T+=3,k.width=1+h(A,T),T+=3,k.height=1+h(A,T),T+=3,k.duration=h(A,T),T+=3,O=A[T++],k.dispose=1&O,k.blend=O>>1&1}ie!="ANMF"&&(T+=W)}var re,$;return R}}(w,0);x.response=w,x.rgbaoutput=!0,x.dataurl=!1;var V=x.header?x.header:null,ne=x.frames?x.frames:null;if(V){V.loop_counter=V.loop_count,g=[V.canvas_height],p=[V.canvas_width];for(var X=0;X<ne.length&&ne[X].blend!=0;X++);}var Q=ne[0],ee=S.WebPDecodeRGBA(w,Q.src_off,Q.src_size,p,g);Q.rgba=ee,Q.imgwidth=p[0],Q.imgheight=g[0];for(var E=0;E<p[0]*g[0]*4;E++)C[E]=ee[E];return this.width=p,this.height=g,this.data=C,this}(function(t){var e=function(){return typeof pm=="function"},r=function(g,p,C,S){var w=4,x=s;switch(S){case t.image_compression.FAST:w=1,x=o;break;case t.image_compression.MEDIUM:w=6,x=a;break;case t.image_compression.SLOW:w=9,x=c}g=n(g,p,C,x);var V=pm(g,{level:w});return t.__addimage__.arrayBufferToBinaryString(V)},n=function(g,p,C,S){for(var w,x,V,ne=g.length/p,X=new Uint8Array(g.length+ne),Q=h(),ee=0;ee<ne;ee+=1){if(V=ee*p,w=g.subarray(V,V+p),S)X.set(S(w,C,x),V+ee);else{for(var E,A=Q.length,T=[];E<A;E+=1)T[E]=Q[E](w,C,x);var R=y(T.concat());X.set(T[R],V+ee)}x=w}return X},i=function(g){var p=Array.apply([],g);return p.unshift(0),p},o=function(g,p){var C,S=[],w=g.length;S[0]=1;for(var x=0;x<w;x+=1)C=g[x-p]||0,S[x+1]=g[x]-C+256&255;return S},s=function(g,p,C){var S,w=[],x=g.length;w[0]=2;for(var V=0;V<x;V+=1)S=C&&C[V]||0,w[V+1]=g[V]-S+256&255;return w},a=function(g,p,C){var S,w,x=[],V=g.length;x[0]=3;for(var ne=0;ne<V;ne+=1)S=g[ne-p]||0,w=C&&C[ne]||0,x[ne+1]=g[ne]+256-(S+w>>>1)&255;return x},c=function(g,p,C){var S,w,x,V,ne=[],X=g.length;ne[0]=4;for(var Q=0;Q<X;Q+=1)S=g[Q-p]||0,w=C&&C[Q]||0,x=C&&C[Q-p]||0,V=u(S,w,x),ne[Q+1]=g[Q]-V+256&255;return ne},u=function(g,p,C){if(g===p&&p===C)return g;var S=Math.abs(p-C),w=Math.abs(g-C),x=Math.abs(g+p-C-C);return S<=w&&S<=x?g:w<=x?p:C},h=function(){return[i,o,s,a,c]},y=function(g){var p=g.map(function(C){return C.reduce(function(S,w){return S+Math.abs(w)},0)});return p.indexOf(Math.min.apply(null,p))};t.processPNG=function(g,p,C,S){var w,x,V,ne,X,Q,ee,E,A,T,R,_,I,b,G,ie=this.decode.FLATE_DECODE,F="";if(this.__addimage__.isArrayBuffer(g)&&(g=new Uint8Array(g)),this.__addimage__.isArrayBufferView(g)){if(g=(V=new k7(g)).imgData,x=V.bits,w=V.colorSpace,X=V.colors,[4,6].indexOf(V.colorType)!==-1){if(V.bits===8){A=(E=V.pixelBitlength==32?new Uint32Array(V.decodePixels().buffer):V.pixelBitlength==16?new Uint16Array(V.decodePixels().buffer):new Uint8Array(V.decodePixels().buffer)).length,R=new Uint8Array(A*V.colors),T=new Uint8Array(A);var W,z=V.pixelBitlength-V.bits;for(b=0,G=0;b<A;b++){for(I=E[b],W=0;W<z;)R[G++]=I>>>W&255,W+=V.bits;T[b]=I>>>W&255}}if(V.bits===16){A=(E=new Uint32Array(V.decodePixels().buffer)).length,R=new Uint8Array(A*(32/V.pixelBitlength)*V.colors),T=new Uint8Array(A*(32/V.pixelBitlength)),_=V.colors>1,b=0,G=0;for(var O=0;b<A;)I=E[b++],R[G++]=I>>>0&255,_&&(R[G++]=I>>>16&255,I=E[b++],R[G++]=I>>>0&255),T[O++]=I>>>16&255;x=8}S!==t.image_compression.NONE&&e()?(g=r(R,V.width*V.colors,V.colors,S),ee=r(T,V.width,1,S)):(g=R,ee=T,ie=void 0)}if(V.colorType===3&&(w=this.color_spaces.INDEXED,Q=V.palette,V.transparency.indexed)){var k=V.transparency.indexed,re=0;for(b=0,A=k.length;b<A;++b)re+=k[b];if((re/=255)===A-1&&k.indexOf(0)!==-1)ne=[k.indexOf(0)];else if(re!==A){for(E=V.decodePixels(),T=new Uint8Array(E.length),b=0,A=E.length;b<A;b++)T[b]=k[E[b]];ee=r(T,V.width,1)}}var $=function(D){var H;switch(D){case t.image_compression.FAST:H=11;break;case t.image_compression.MEDIUM:H=13;break;case t.image_compression.SLOW:H=14;break;default:H=12}return H}(S);return ie===this.decode.FLATE_DECODE&&(F="/Predictor "+$+" "),F+="/Colors "+X+" /BitsPerComponent "+x+" /Columns "+V.width,(this.__addimage__.isArrayBuffer(g)||this.__addimage__.isArrayBufferView(g))&&(g=this.__addimage__.arrayBufferToBinaryString(g)),(ee&&this.__addimage__.isArrayBuffer(ee)||this.__addimage__.isArrayBufferView(ee))&&(ee=this.__addimage__.arrayBufferToBinaryString(ee)),{alias:C,data:g,index:p,filter:ie,decodeParameters:F,transparency:ne,palette:Q,sMask:ee,predictor:$,width:V.width,height:V.height,bitsPerComponent:x,colorSpace:w}}}})(or.API),function(t){t.processGIF89A=function(e,r,n,i){var o=new T7(e),s=o.width,a=o.height,c=[];o.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:s,height:a},h=new vp(100).encode(u,100);return t.processJPEG.call(this,h,r,n,i)},t.processGIF87A=t.processGIF89A}(or.API),Eo.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:n,blue:r,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Eo.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){hn.log("bit decode error:"+r)}},Eo.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,i=0;i<e;i++)for(var o=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*i*4,a=0;a<8&&8*i+a<this.width;a++){var c=this.palette[o>>7-a&1];this.data[s+4*a]=c.blue,this.data[s+4*a+1]=c.green,this.data[s+4*a+2]=c.red,this.data[s+4*a+3]=255}r!==0&&(this.pos+=4-r)}},Eo.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<t;i++){var o=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*i*4,a=o>>4,c=15&o,u=this.palette[a];if(this.data[s]=u.blue,this.data[s+1]=u.green,this.data[s+2]=u.red,this.data[s+3]=255,2*i+1>=this.width)break;u=this.palette[c],this.data[s+4]=u.blue,this.data[s+4+1]=u.green,this.data[s+4+2]=u.red,this.data[s+4+3]=255}e!==0&&(this.pos+=4-e)}},Eo.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+4*n;if(i<this.palette.length){var s=this.palette[i];this.data[o]=s.red,this.data[o+1]=s.green,this.data[o+2]=s.blue,this.data[o+3]=255}else this.data[o]=255,this.data[o+1]=255,this.data[o+2]=255,this.data[o+3]=255}t!==0&&(this.pos+=4-t)}},Eo.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(o&e)/e*255|0,a=(o>>5&e)/e*255|0,c=(o>>10&e)/e*255|0,u=o>>15?255:0,h=n*this.width*4+4*i;this.data[h]=c,this.data[h+1]=a,this.data[h+2]=s,this.data[h+3]=u}this.pos+=t}},Eo.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,o=0;o<this.width;o++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(s&e)/e*255|0,c=(s>>5&r)/r*255|0,u=(s>>11)/e*255|0,h=i*this.width*4+4*o;this.data[h]=u,this.data[h+1]=c,this.data[h+2]=a,this.data[h+3]=255}this.pos+=t}},Eo.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*r;this.data[s]=o,this.data[s+1]=i,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},Eo.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*r;this.data[a]=o,this.data[a+1]=i,this.data[a+2]=n,this.data[a+3]=s}},Eo.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,r,n,i){var o=new Eo(e,!1),s=o.width,a=o.height,c={data:o.getData(),width:s,height:a},u=new vp(100).encode(c,100);return t.processJPEG.call(this,u,r,n,i)}}(or.API),J0.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,r,n,i){var o=new J0(e),s=o.width,a=o.height,c={data:o.getData(),width:s,height:a},u=new vp(100).encode(c,100);return t.processJPEG.call(this,u,r,n,i)}}(or.API),or.API.processRGBA=function(t,e,r){for(var n=t.data,i=n.length,o=new Uint8Array(i/4*3),s=new Uint8Array(i/4),a=0,c=0,u=0;u<i;u+=4){var h=n[u],y=n[u+1],g=n[u+2],p=n[u+3];o[a++]=h,o[a++]=y,o[a++]=g,s[c++]=p}var C=this.__addimage__.arrayBufferToBinaryString(o);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:C,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},or.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Zl=or.API,Wd=Zl.getCharWidthsArray=function(t,e){var r,n,i=(e=e||{}).font||this.internal.getFont(),o=e.fontSize||this.internal.getFontSize(),s=e.charSpace||this.internal.getCharSpace(),a=e.widths?e.widths:i.metadata.Unicode.widths,c=a.fof?a.fof:1,u=e.kerning?e.kerning:i.metadata.Unicode.kerning,h=u.fof?u.fof:1,y=e.doKerning!==!1,g=0,p=t.length,C=0,S=a[0]||c,w=[];for(r=0;r<p;r++)n=t.charCodeAt(r),typeof i.metadata.widthOfString=="function"?w.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+s*(1e3/o)||0)/1e3):(g=y&&sn(u[n])==="object"&&!isNaN(parseInt(u[n][C],10))?u[n][C]/h:0,w.push((a[n]||S)/c+g)),C=n;return w},W0=Zl.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return Zl.processArabic&&(t=Zl.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,i)/r:Wd.apply(this,arguments).reduce(function(o,s){return o+s},0)},G0=function(t,e,r,n){for(var i=[],o=0,s=t.length,a=0;o!==s&&a+e[o]<r;)a+=e[o],o++;i.push(t.slice(0,o));var c=o;for(a=0;o!==s;)a+e[o]>n&&(i.push(t.slice(c,o)),a=0,c=o),a+=e[o],o++;return c!==o&&i.push(t.slice(c,o)),i},Y0=function(t,e,r){r||(r={});var n,i,o,s,a,c,u,h=[],y=[h],g=r.textIndent||0,p=0,C=0,S=t.split(" "),w=Wd.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?S[0].length+2:r.lineIndent||0){var x=Array(c).join(" "),V=[];S.map(function(X){(X=X.split(/\s*\n/)).length>1?V=V.concat(X.map(function(Q,ee){return(ee&&Q.length?`
`:"")+Q})):V.push(X[0])}),S=V,c=W0.apply(this,[x,r])}for(o=0,s=S.length;o<s;o++){var ne=0;if(n=S[o],c&&n[0]==`
`&&(n=n.substr(1),ne=1),g+p+(C=(i=Wd.apply(this,[n,r])).reduce(function(X,Q){return X+Q},0))>e||ne){if(C>e){for(a=G0.apply(this,[n,i,e-(g+p),e]),h.push(a.shift()),h=[a.pop()];a.length;)y.push([a.shift()]);C=i.slice(n.length-(h[0]?h[0].length:0)).reduce(function(X,Q){return X+Q},0)}else h=[n];y.push(h),g=C+c,p=w}else h.push(n),g+=p+C,p=w}return u=c?function(X,Q){return(Q?x:"")+X.join(" ")}:function(X){return X.join(" ")},y.map(u)},Zl.splitTextToSize=function(t,e,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),o=function(h){if(h.widths&&h.kerning)return{widths:h.widths,kerning:h.kerning};var y=this.internal.getFont(h.fontName,h.fontStyle);return y.metadata.Unicode?{widths:y.metadata.Unicode.widths||{0:1},kerning:y.metadata.Unicode.kerning||{}}:{font:y.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var s=1*this.internal.scaleFactor*e/i;o.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,o.lineIndent=r.lineIndent;var a,c,u=[];for(a=0,c=n.length;a<c;a++)u=u.concat(Y0.apply(this,[n[a],s,o]));return u},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",r={},n={},i=0;i<e.length;i++)r[e[i]]="0123456789abcdef"[i],n["0123456789abcdef"[i]]=e[i];var o=function(y){return"0x"+parseInt(y,10).toString(16)},s=t.__fontmetrics__.compress=function(y){var g,p,C,S,w=["{"];for(var x in y){if(g=y[x],isNaN(parseInt(x,10))?p="'"+x+"'":(x=parseInt(x,10),p=(p=o(x).slice(2)).slice(0,-1)+n[p.slice(-1)]),typeof g=="number")g<0?(C=o(g).slice(3),S="-"):(C=o(g).slice(2),S=""),C=S+C.slice(0,-1)+n[C.slice(-1)];else{if(sn(g)!=="object")throw new Error("Don't know what to do with value type "+sn(g)+".");C=s(g)}w.push(p+C)}return w.push("}"),w.join("")},a=t.__fontmetrics__.uncompress=function(y){if(typeof y!="string")throw new Error("Invalid argument passed to uncompress.");for(var g,p,C,S,w={},x=1,V=w,ne=[],X="",Q="",ee=y.length-1,E=1;E<ee;E+=1)(S=y[E])=="'"?g?(C=g.join(""),g=void 0):g=[]:g?g.push(S):S=="{"?(ne.push([V,C]),V={},C=void 0):S=="}"?((p=ne.pop())[0][p[1]]=V,C=void 0,V=p[0]):S=="-"?x=-1:C===void 0?r.hasOwnProperty(S)?(X+=r[S],C=parseInt(X,16)*x,x=1,X=""):X+=S:r.hasOwnProperty(S)?(Q+=r[S],V[C]=parseInt(Q,16)*x,x=1,C=void 0,Q=""):Q+=S;return w},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:a("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},h={Unicode:{"Courier-Oblique":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":a("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":a("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":a("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:a("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:a("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":a("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:a("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":a("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":a("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":a("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(y){var g=y.font,p=h.Unicode[g.postScriptName];p&&(g.metadata.Unicode={},g.metadata.Unicode.widths=p.widths,g.metadata.Unicode.kerning=p.kerning);var C=u.Unicode[g.postScriptName];C&&(g.metadata.Unicode.encoding=C,g.encoding=C.codePages[0])}])}(or.API),function(t){var e=function(r){for(var n=r.length,i=new Uint8Array(n),o=0;o<n;o++)i[o]=r.charCodeAt(o);return i};t.API.events.push(["addFont",function(r){var n=void 0,i=r.font,o=r.instance;if(!i.isStandardFont){if(o===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=o.existsFileInVFS(i.postScriptName)===!1?o.loadFile(i.postScriptName):o.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(s,a){a=/^\x00\x01\x00\x00/.test(a)?e(a):e(gu(a)),s.metadata=t.API.TTFFont.open(a),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(i,n)}}])}(or),function(t){function e(){return(cr.canvg?Promise.resolve(cr.canvg):Ni(()=>import("./index.es-aAHJMyqM.js"),[])).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}or.API.addSvgAsImage=function(r,n,i,o,s,a,c,u){if(isNaN(n)||isNaN(i))throw hn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(o)||isNaN(s))throw hn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var h=document.createElement("canvas");h.width=o,h.height=s;var y=h.getContext("2d");y.fillStyle="#fff",y.fillRect(0,0,h.width,h.height);var g={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},p=this;return e().then(function(C){return C.fromString(y,r,g)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(C){return C.render(g)}).then(function(){p.addImage(h.toDataURL("image/jpeg",1),n,i,o,s,c,u)})}}(),or.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(e,r);return this},or.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,i,o,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},a=Object.keys(s),c=[],u=0,h=0,y=0;function g(C,S){var w,x=!1;for(w=0;w<C.length;w+=1)C[w]===S&&(x=!0);return x}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var p=a.length;for(y=0;y<p;y+=1)r[a[y]].value=r[a[y]].defaultValue,r[a[y]].explicitSet=!1}if(sn(t)==="object"){for(i in t)if(o=t[i],g(a,i)&&o!==void 0){if(r[i].type==="boolean"&&typeof o=="boolean")r[i].value=o;else if(r[i].type==="name"&&g(r[i].valueSet,o))r[i].value=o;else if(r[i].type==="integer"&&Number.isInteger(o))r[i].value=o;else if(r[i].type==="array"){for(u=0;u<o.length;u+=1)if(n=!0,o[u].length===1&&typeof o[u][0]=="number")c.push(String(o[u]-1));else if(o[u].length>1){for(h=0;h<o[u].length;h+=1)typeof o[u][h]!="number"&&(n=!1);n===!0&&c.push([o[u][0]-1,o[u][1]-1].join(" "))}r[i].value="["+c.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var C,S=[];for(C in r)r[C].explicitSet===!0&&(r[C].type==="name"?S.push("/"+C+" /"+r[C].value):S.push("/"+C+" "+r[C].value));S.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+S.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),o=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),a=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=o.length+s.length+a.length+i.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(i+o+s+a+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}}(or.API),function(t){var e=t.API,r=e.pdfEscape16=function(o,s){for(var a,c=s.metadata.Unicode.widths,u=["","0","00","000","0000"],h=[""],y=0,g=o.length;y<g;++y){if(a=s.metadata.characterToGlyph(o.charCodeAt(y)),s.metadata.glyIdsUsed.push(a),s.metadata.toUnicode[a]=o.charCodeAt(y),c.indexOf(a)==-1&&(c.push(a),c.push([parseInt(s.metadata.widthOfGlyph(a),10)])),a=="0")return h.join("");a=a.toString(16),h.push(u[4-a.length],a)}return h.join("")},n=function(o){var s,a,c,u,h,y,g;for(h=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],y=0,g=(a=Object.keys(o).sort(function(p,C){return p-C})).length;y<g;y++)s=a[y],c.length>=100&&(h+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),o[s]!==void 0&&o[s]!==null&&typeof o[s].toString=="function"&&(u=("0000"+o[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),c.push("<"+s+"><"+u+">"));return c.length&&(h+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),h+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(o){(function(s){var a=s.font,c=s.out,u=s.newObject,h=s.putStream;if(a.metadata instanceof t.API.TTFFont&&a.encoding==="Identity-H"){for(var y=a.metadata.Unicode.widths,g=a.metadata.subset.encode(a.metadata.glyIdsUsed,1),p="",C=0;C<g.length;C++)p+=String.fromCharCode(g[C]);var S=u();h({data:p,addLength1:!0,objectId:S}),c("endobj");var w=u();h({data:n(a.metadata.toUnicode),addLength1:!0,objectId:w}),c("endobj");var x=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+ac(a.fontName)),c("/FontFile2 "+S+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(a.metadata.bbox)),c("/Flags "+a.metadata.flags),c("/StemV "+a.metadata.stemV),c("/ItalicAngle "+a.metadata.italicAngle),c("/Ascent "+a.metadata.ascender),c("/Descent "+a.metadata.decender),c("/CapHeight "+a.metadata.capHeight),c(">>"),c("endobj");var V=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+ac(a.fontName)),c("/FontDescriptor "+x+" 0 R"),c("/W "+t.API.PDFObject.convert(y)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+a.encoding+")"),c(">>"),c(">>"),c("endobj"),a.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+w+" 0 R"),c("/BaseFont /"+ac(a.fontName)),c("/Encoding /"+a.encoding),c("/DescendantFonts ["+V+" 0 R]"),c(">>"),c("endobj"),a.isAlreadyPutted=!0}})(o)}]),e.events.push(["putFont",function(o){(function(s){var a=s.font,c=s.out,u=s.newObject,h=s.putStream;if(a.metadata instanceof t.API.TTFFont&&a.encoding==="WinAnsiEncoding"){for(var y=a.metadata.rawData,g="",p=0;p<y.length;p++)g+=String.fromCharCode(y[p]);var C=u();h({data:g,addLength1:!0,objectId:C}),c("endobj");var S=u();h({data:n(a.metadata.toUnicode),addLength1:!0,objectId:S}),c("endobj");var w=u();c("<<"),c("/Descent "+a.metadata.decender),c("/CapHeight "+a.metadata.capHeight),c("/StemV "+a.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+C+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(a.metadata.bbox)),c("/FontName /"+ac(a.fontName)),c("/ItalicAngle "+a.metadata.italicAngle),c("/Ascent "+a.metadata.ascender),c(">>"),c("endobj"),a.objectNumber=u();for(var x=0;x<a.metadata.hmtx.widths.length;x++)a.metadata.hmtx.widths[x]=parseInt(a.metadata.hmtx.widths[x]*(1e3/a.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+S+" 0 R/BaseFont/"+ac(a.fontName)+"/FontDescriptor "+w+" 0 R/Encoding/"+a.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(a.metadata.hmtx.widths)+">>"),c("endobj"),a.isAlreadyPutted=!0}})(o)}]);var i=function(o){var s,a=o.text||"",c=o.x,u=o.y,h=o.options||{},y=o.mutex||{},g=y.pdfEscape,p=y.activeFontKey,C=y.fonts,S=p,w="",x=0,V="",ne=C[S].encoding;if(C[S].encoding!=="Identity-H")return{text:a,x:c,y:u,options:h,mutex:y};for(V=a,S=p,Array.isArray(a)&&(V=a[0]),x=0;x<V.length;x+=1)C[S].metadata.hasOwnProperty("cmap")&&(s=C[S].metadata.cmap.unicode.codeMap[V[x].charCodeAt(0)]),s||V[x].charCodeAt(0)<256&&C[S].metadata.hasOwnProperty("Unicode")?w+=V[x]:w+="";var X="";return parseInt(S.slice(1))<14||ne==="WinAnsiEncoding"?X=g(w,S).split("").map(function(Q){return Q.charCodeAt(0).toString(16)}).join(""):ne==="Identity-H"&&(X=r(w,C[S])),y.isHex=!0,{text:X,x:c,y:u,options:h,mutex:y}};e.events.push(["postProcessText",function(o){var s=o.text||"",a=[],c={text:s,x:o.x,y:o.y,options:o.options,mutex:o.mutex};if(Array.isArray(s)){var u=0;for(u=0;u<s.length;u+=1)Array.isArray(s[u])&&s[u].length===3?a.push([i(Object.assign({},c,{text:s[u][0]})).text,s[u][1],s[u][2]]):a.push(i(Object.assign({},c,{text:s[u]})).text);o.text=a}else o.text=i(Object.assign({},c,{text:s})).text}])}(or),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(or.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var i,o,s,a,c,u,h,y=e,g=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],p=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],C={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},S={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},w=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],x=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),V=!1,ne=0;this.__bidiEngine__={};var X=function(_){var I=_.charCodeAt(),b=I>>8,G=S[b];return G!==void 0?y[256*G+(255&I)]:b===252||b===253?"AL":x.test(b)?"L":b===8?"R":"N"},Q=function(_){for(var I,b=0;b<_.length;b++){if((I=X(_.charAt(b)))==="L")return!1;if(I==="R")return!0}return!1},ee=function(_,I,b,G){var ie,F,W,z,O=I[G];switch(O){case"L":case"R":V=!1;break;case"N":case"AN":break;case"EN":V&&(O="AN");break;case"AL":V=!0,O="R";break;case"WS":O="N";break;case"CS":G<1||G+1>=I.length||(ie=b[G-1])!=="EN"&&ie!=="AN"||(F=I[G+1])!=="EN"&&F!=="AN"?O="N":V&&(F="AN"),O=F===ie?F:"N";break;case"ES":O=(ie=G>0?b[G-1]:"B")==="EN"&&G+1<I.length&&I[G+1]==="EN"?"EN":"N";break;case"ET":if(G>0&&b[G-1]==="EN"){O="EN";break}if(V){O="N";break}for(W=G+1,z=I.length;W<z&&I[W]==="ET";)W++;O=W<z&&I[W]==="EN"?"EN":"N";break;case"NSM":if(s&&!a){for(z=I.length,W=G+1;W<z&&I[W]==="NSM";)W++;if(W<z){var k=_[G],re=k>=1425&&k<=2303||k===64286;if(ie=I[W],re&&(ie==="R"||ie==="AL")){O="R";break}}}O=G<1||(ie=I[G-1])==="B"?"N":b[G-1];break;case"B":V=!1,i=!0,O=ne;break;case"S":o=!0,O="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":V=!1;break;case"BN":O="N"}return O},E=function(_,I,b){var G=_.split("");return b&&A(G,b,{hiLevel:ne}),G.reverse(),I&&I.reverse(),G.join("")},A=function(_,I,b){var G,ie,F,W,z,O=-1,k=_.length,re=0,$=[],D=ne?p:g,H=[];for(V=!1,i=!1,o=!1,ie=0;ie<k;ie++)H[ie]=X(_[ie]);for(F=0;F<k;F++){if(z=re,$[F]=ee(_,H,$,F),G=240&(re=D[z][C[$[F]]]),re&=15,I[F]=W=D[re][5],G>0)if(G===16){for(ie=O;ie<F;ie++)I[ie]=1;O=-1}else O=-1;if(D[re][6])O===-1&&(O=F);else if(O>-1){for(ie=O;ie<F;ie++)I[ie]=W;O=-1}H[F]==="B"&&(I[F]=0),b.hiLevel|=W}o&&function(L,j,oe){for(var K=0;K<oe;K++)if(L[K]==="S"){j[K]=ne;for(var Z=K-1;Z>=0&&L[Z]==="WS";Z--)j[Z]=ne}}(H,I,k)},T=function(_,I,b,G,ie){if(!(ie.hiLevel<_)){if(_===1&&ne===1&&!i)return I.reverse(),void(b&&b.reverse());for(var F,W,z,O,k=I.length,re=0;re<k;){if(G[re]>=_){for(z=re+1;z<k&&G[z]>=_;)z++;for(O=re,W=z-1;O<W;O++,W--)F=I[O],I[O]=I[W],I[W]=F,b&&(F=b[O],b[O]=b[W],b[W]=F);re=z}re++}}},R=function(_,I,b){var G=_.split(""),ie={hiLevel:ne};return b||(b=[]),A(G,b,ie),function(F,W,z){if(z.hiLevel!==0&&h)for(var O,k=0;k<F.length;k++)W[k]===1&&(O=w.indexOf(F[k]))>=0&&(F[k]=w[O+1])}(G,b,ie),T(2,G,I,b,ie),T(1,G,I,b,ie),G.join("")};return this.__bidiEngine__.doBidiReorder=function(_,I,b){if(function(ie,F){if(F)for(var W=0;W<ie.length;W++)F[W]=W;a===void 0&&(a=Q(ie)),u===void 0&&(u=Q(ie))}(_,I),s||!c||u)if(s&&c&&a^u)ne=a?1:0,_=E(_,I,b);else if(!s&&c&&u)ne=a?1:0,_=R(_,I,b),_=E(_,I);else if(!s||a||c||u){if(s&&!c&&a^u)_=E(_,I),a?(ne=0,_=R(_,I,b)):(ne=1,_=R(_,I,b),_=E(_,I));else if(s&&a&&!c&&u)ne=1,_=R(_,I,b),_=E(_,I);else if(!s&&!c&&a^u){var G=h;a?(ne=1,_=R(_,I,b),ne=0,h=!1,_=R(_,I,b),h=G):(ne=0,_=R(_,I,b),_=E(_,I),ne=1,h=!1,_=R(_,I,b),h=G,_=E(_,I))}}else ne=0,_=R(_,I,b);else ne=a?1:0,_=R(_,I,b);return _},this.__bidiEngine__.setOptions=function(_){_&&(s=_.isInputVisual,c=_.isOutputVisual,a=_.isInputRtl,u=_.isOutputRtl,h=_.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var i=n.text;n.x,n.y;var o=n.options||{};n.mutex,o.lang;var s=[];if(o.isInputVisual=typeof o.isInputVisual!="boolean"||o.isInputVisual,r.setOptions(o),Object.prototype.toString.call(i)==="[object Array]"){var a=0;for(s=[],a=0;a<i.length;a+=1)Object.prototype.toString.call(i[a])==="[object Array]"?s.push([r.doBidiReorder(i[a][0]),i[a][1],i[a][2]]):s.push([r.doBidiReorder(i[a])]);n.text=s}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])}(or),or.API.TTFFont=function(){function t(e){var r;if(this.rawData=e,r=this.contents=new Fa(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new W7(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new N7(this.contents),this.head=new D7(this),this.name=new B7(this),this.cmap=new z5(this),this.toUnicode={},this.hhea=new R7(this),this.maxp=new j7(this),this.hmtx=new V7(this),this.post=new F7(this),this.os2=new M7(this),this.loca=new H7(this),this.glyf=new q7(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,i,o;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var s,a,c,u;for(u=[],s=0,a=(c=this.bbox).length;s<a;s++)e=c[s],u.push(Math.round(e*this.scaleFactor));return u}.call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),(32768&(r=i>>16))!=0&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(o=this.familyClass)===1||o===2||o===3||o===4||o===5||o===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var i,o,s,a;for(s=0,o=0,a=(e=""+e).length;0<=a?o<a:o>a;o=0<=a?++o:--o)i=e.charCodeAt(o),s+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return s*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t}();var Fo,Fa=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,i;for(i=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(e.charCodeAt(r)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,i,o,s,a,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),o=this.readByte(),s=this.readByte(),a=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^o)+65536*(255^s)+256*(255^a)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*i+16777216*o+65536*s+256*a+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,i,o;for(o=[],n=0,i=e.length;n<i;n++)r=e[n],o.push(this.writeByte(r));return o},t}(),N7=function(){var t;function e(r){var n,i,o;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,o=this.tableCount;0<=o?i<o:i>o;i=0<=o?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,i,o,s,a,c,u,h,y,g,p,C,S;for(S in p=Object.keys(r).length,c=Math.log(2),y=16*Math.floor(Math.log(p)/c),s=Math.floor(y/c),h=16*p-y,(i=new Fa).writeInt(this.scalarType),i.writeShort(p),i.writeShort(y),i.writeShort(s),i.writeShort(h),o=16*p,u=i.pos+o,a=null,C=[],r)for(g=r[S],i.writeString(S),i.writeInt(t(g)),i.writeInt(u),i.writeInt(g.length),C=C.concat(g),S==="head"&&(a=u),u+=g.length;u%4;)C.push(0),u++;return i.write(C),n=2981146554-t(i.data),i.pos=a+8,i.writeUInt32(n),i.data},t=function(r){var n,i,o,s;for(r=U5.call(r);r.length%4;)r.push(0);for(o=new Fa(r),i=0,n=0,s=r.length;n<s;n=n+=4)i+=o.readUInt32();return 4294967295&i},e}(),L7={}.hasOwnProperty,ls=function(t,e){for(var r in e)L7.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Fo=function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var D7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Fo),e.prototype.tag="head",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},e.prototype.encode=function(r){var n;return(n=new Fa).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(r),n.writeShort(this.glyphDataFormat),n.data},e}(),Q0=function(){function t(e,r){var n,i,o,s,a,c,u,h,y,g,p,C,S,w,x,V,ne;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),y=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(p=e.readUInt16(),g=p/2,e.pos+=6,o=function(){var X,Q;for(Q=[],c=X=0;0<=g?X<g:X>g;c=0<=g?++X:--X)Q.push(e.readUInt16());return Q}(),e.pos+=2,S=function(){var X,Q;for(Q=[],c=X=0;0<=g?X<g:X>g;c=0<=g?++X:--X)Q.push(e.readUInt16());return Q}(),u=function(){var X,Q;for(Q=[],c=X=0;0<=g?X<g:X>g;c=0<=g?++X:--X)Q.push(e.readUInt16());return Q}(),h=function(){var X,Q;for(Q=[],c=X=0;0<=g?X<g:X>g;c=0<=g?++X:--X)Q.push(e.readUInt16());return Q}(),i=(this.length-e.pos+this.offset)/2,a=function(){var X,Q;for(Q=[],c=X=0;0<=i?X<i:X>i;c=0<=i?++X:--X)Q.push(e.readUInt16());return Q}(),c=x=0,ne=o.length;x<ne;c=++x)for(w=o[c],n=V=C=S[c];C<=w?V<=w:V>=w;n=C<=w?++V:--V)h[c]===0?s=n+u[c]:(s=a[h[c]/2+(n-C)-(g-c)]||0)!==0&&(s+=u[c]),this.codeMap[n]=65535&s}e.pos=y}return t.encode=function(e,r){var n,i,o,s,a,c,u,h,y,g,p,C,S,w,x,V,ne,X,Q,ee,E,A,T,R,_,I,b,G,ie,F,W,z,O,k,re,$,D,H,L,j,oe,K,Z,J,Y,U;switch(G=new Fa,s=Object.keys(e).sort(function(ae,ue){return ae-ue}),r){case"macroman":for(S=0,w=function(){var ae=[];for(C=0;C<256;++C)ae.push(0);return ae}(),V={0:0},o={},ie=0,O=s.length;ie<O;ie++)V[Z=e[i=s[ie]]]==null&&(V[Z]=++S),o[i]={old:e[i],new:V[e[i]]},w[i]=V[e[i]];return G.writeUInt16(1),G.writeUInt16(0),G.writeUInt32(12),G.writeUInt16(0),G.writeUInt16(262),G.writeUInt16(0),G.write(w),{charMap:o,subtable:G.data,maxGlyphID:S+1};case"unicode":for(I=[],y=[],ne=0,V={},n={},x=u=null,F=0,k=s.length;F<k;F++)V[Q=e[i=s[F]]]==null&&(V[Q]=++ne),n[i]={old:Q,new:V[Q]},a=V[Q]-i,x!=null&&a===u||(x&&y.push(x),I.push(i),u=a),x=i;for(x&&y.push(x),y.push(65535),I.push(65535),R=2*(T=I.length),A=2*Math.pow(Math.log(T)/Math.LN2,2),g=Math.log(A/2)/Math.LN2,E=2*T-A,c=[],ee=[],p=[],C=W=0,re=I.length;W<re;C=++W){if(_=I[C],h=y[C],_===65535){c.push(0),ee.push(0);break}if(_-(b=n[_].new)>=32768)for(c.push(0),ee.push(2*(p.length+T-C)),i=z=_;_<=h?z<=h:z>=h;i=_<=h?++z:--z)p.push(n[i].new);else c.push(b-_),ee.push(0)}for(G.writeUInt16(3),G.writeUInt16(1),G.writeUInt32(12),G.writeUInt16(4),G.writeUInt16(16+8*T+2*p.length),G.writeUInt16(0),G.writeUInt16(R),G.writeUInt16(A),G.writeUInt16(g),G.writeUInt16(E),oe=0,$=y.length;oe<$;oe++)i=y[oe],G.writeUInt16(i);for(G.writeUInt16(0),K=0,D=I.length;K<D;K++)i=I[K],G.writeUInt16(i);for(J=0,H=c.length;J<H;J++)a=c[J],G.writeUInt16(a);for(Y=0,L=ee.length;Y<L;Y++)X=ee[Y],G.writeUInt16(X);for(U=0,j=p.length;U<j;U++)S=p[U],G.writeUInt16(S);return{charMap:n,subtable:G.data,maxGlyphID:ne+1}}},t}(),z5=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Fo),e.prototype.tag="cmap",e.prototype.parse=function(r){var n,i,o;for(r.pos=this.offset,this.version=r.readUInt16(),o=r.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=o?i<o:i>o;i=0<=o?++i:--i)n=new Q0(r,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},e.encode=function(r,n){var i,o;return n==null&&(n="macroman"),i=Q0.encode(r,n),(o=new Fa).writeUInt16(0),o.writeUInt16(1),i.table=o.data.concat(i.subtable),i},e}(),R7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Fo),e.prototype.tag="hhea",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},e}(),M7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Fo),e.prototype.tag="OS/2",e.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var n,i;for(i=[],n=0;n<10;++n)i.push(r.readByte());return i}(),this.charRange=function(){var n,i;for(i=[],n=0;n<4;++n)i.push(r.readInt());return i}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var n,i;for(i=[],n=0;n<2;n=++n)i.push(r.readInt());return i}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},e}(),F7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Fo),e.prototype.tag="post",e.prototype.parse=function(r){var n,i,o;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var s;for(i=r.readUInt16(),this.glyphNameIndex=[],s=0;0<=i?s<i:s>i;s=0<=i?++s:--s)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],o=[];r.pos<this.offset+this.length;)n=r.readByte(),o.push(this.names.push(r.readString(n)));return o;case 151552:return i=r.readUInt16(),this.offsets=r.read(i);case 196608:break;case 262144:return this.map=function(){var a,c,u;for(u=[],s=a=0,c=this.file.maxp.numGlyphs;0<=c?a<c:a>c;s=0<=c?++a:--a)u.push(r.readUInt32());return u}.call(this)}},e}(),O7=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},B7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Fo),e.prototype.tag="name",e.prototype.parse=function(r){var n,i,o,s,a,c,u,h,y,g,p;for(r.pos=this.offset,r.readShort(),n=r.readShort(),c=r.readShort(),i=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)i.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+c+r.readShort()});for(u={},s=y=0,g=i.length;y<g;s=++y)o=i[s],r.pos=o.offset,h=r.readString(o.length),a=new O7(h,o),u[p=o.nameID]==null&&(u[p]=[]),u[o.nameID].push(a);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},e}(),j7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Fo),e.prototype.tag="maxp",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},e}(),V7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Fo),e.prototype.tag="hmtx",e.prototype.parse=function(r){var n,i,o,s,a,c,u;for(r.pos=this.offset,this.metrics=[],n=0,c=this.file.hhea.numberOfMetrics;0<=c?n<c:n>c;n=0<=c?++n:--n)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(o=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var h,y;for(y=[],n=h=0;0<=o?h<o:h>o;n=0<=o?++h:--h)y.push(r.readInt16());return y}(),this.widths=function(){var h,y,g,p;for(p=[],h=0,y=(g=this.metrics).length;h<y;h++)s=g[h],p.push(s.advance);return p}.call(this),i=this.widths[this.widths.length-1],u=[],n=a=0;0<=o?a<o:a>o;n=0<=o?++a:--a)u.push(this.widths.push(i));return u},e.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},e}(),U5=[].slice,q7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Fo),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(r){var n,i,o,s,a,c,u,h,y,g;return r in this.cache?this.cache[r]:(s=this.file.loca,n=this.file.contents,i=s.indexOf(r),(o=s.lengthOf(r))===0?this.cache[r]=null:(n.pos=this.offset+i,a=(c=new Fa(n.read(o))).readShort(),h=c.readShort(),g=c.readShort(),u=c.readShort(),y=c.readShort(),this.cache[r]=a===-1?new U7(c,h,g,u,y):new z7(c,a,h,g,u,y),this.cache[r]))},e.prototype.encode=function(r,n,i){var o,s,a,c,u;for(a=[],s=[],c=0,u=n.length;c<u;c++)o=r[n[c]],s.push(a.length),o&&(a=a.concat(o.encode(i)));return s.push(a.length),{table:a,offsets:s}},e}(),z7=function(){function t(e,r,n,i,o,s){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=o,this.yMax=s,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),U7=function(){function t(e,r,n,i,o){var s,a;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=o,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;a=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&a;)s.pos+=1&a?4:2,128&a?s.pos+=8:64&a?s.pos+=4:8&a&&(s.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new Fa(U5.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t}(),H7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Fo),e.prototype.tag="loca",e.prototype.parse=function(r){var n,i;return r.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?function(){var o,s;for(s=[],i=0,o=this.length;i<o;i+=2)s.push(2*r.readUInt16());return s}.call(this):function(){var o,s;for(s=[],i=0,o=this.length;i<o;i+=4)s.push(r.readUInt32());return s}.call(this)},e.prototype.indexOf=function(r){return this.offsets[r]},e.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},e.prototype.encode=function(r,n){for(var i=new Uint32Array(this.offsets.length),o=0,s=0,a=0;a<i.length;++a)if(i[a]=o,s<n.length&&n[s]==a){++s,i[a]=o;var c=this.offsets[a],u=this.offsets[a+1]-c;u>0&&(o+=u)}for(var h=new Array(4*i.length),y=0;y<i.length;++y)h[4*y+3]=255&i[y],h[4*y+2]=(65280&i[y])>>8,h[4*y+1]=(16711680&i[y])>>16,h[4*y]=(4278190080&i[y])>>24;return h},e}(),W7=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,i,o;for(r in i=this.font.cmap.tables[0].codeMap,e={},o=this.subset)n=o[r],e[r]=i[n];return e},t.prototype.glyphsFor=function(e){var r,n,i,o,s,a,c;for(i={},s=0,a=e.length;s<a;s++)i[o=e[s]]=this.font.glyf.glyphFor(o);for(o in r=[],i)(n=i[o])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(o in c=this.glyphsFor(r))n=c[o],i[o]=n;return i},t.prototype.encode=function(e,r){var n,i,o,s,a,c,u,h,y,g,p,C,S,w,x;for(i in n=z5.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(e),p={0:0},x=n.charMap)p[(c=x[i]).old]=c.new;for(C in g=n.maxGlyphID,s)C in p||(p[C]=g++);return h=function(V){var ne,X;for(ne in X={},V)X[V[ne]]=ne;return X}(p),y=Object.keys(h).sort(function(V,ne){return V-ne}),S=function(){var V,ne,X;for(X=[],V=0,ne=y.length;V<ne;V++)a=y[V],X.push(h[a]);return X}(),o=this.font.glyf.encode(s,S,p),u=this.font.loca.encode(o.offsets,S),w={cmap:this.font.cmap.raw(),glyf:o.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(w["OS/2"]=this.font.os2.raw()),this.font.directory.encode(w)},t}();or.API.PDFObject=function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,i,o,s;if(Array.isArray(r))return"["+function(){var a,c,u;for(u=[],a=0,c=r.length;a<c;a++)n=r[a],u.push(e.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in o=["<<"],r)s=r[i],o.push("/"+i+" "+e.convert(s));return o.push(">>"),o.join(`
`)}return""+r},e}();const H5=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:x7,AcroFormAppearance:Wt,AcroFormButton:Wn,AcroFormCheckBox:_u,AcroFormChoiceField:vl,AcroFormComboBox:_l,AcroFormEditBox:vu,AcroFormListBox:bl,AcroFormPasswordField:wu,AcroFormPushButton:bu,AcroFormRadioButton:wl,AcroFormTextField:Ea,GState:ju,ShadingPattern:ba,TilingPattern:ml,default:or,jsPDF:or},Symbol.toStringTag,{value:"Module"}));function W5(t,e,r,n,i){n=n||{};var o=1.15,s=i.internal.scaleFactor,a=i.internal.getFontSize()/s,c=i.getLineHeightFactor?i.getLineHeightFactor():o,u=a*c,h=/\r\n|\r|\n/g,y="",g=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(y=typeof t=="string"?t.split(h):t,g=y.length||1),r+=a*(2-o),n.valign==="middle"?r-=g/2*u:n.valign==="bottom"&&(r-=g*u),n.halign==="center"||n.halign==="right"){var p=a;if(n.halign==="center"&&(p*=.5),y&&g>=1){for(var C=0;C<y.length;C++)i.text(y[C],e-i.getStringUnitWidth(y[C])*p,r),r+=u;return i}e-=i.getStringUnitWidth(t)*p}return n.halign==="justify"?i.text(t,e,r,{maxWidth:n.maxWidth||100,align:"justify"}):i.text(t,e,r),i}var X0={},pc=function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=e:X0=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,r){var n,i,o;r===void 0&&(r=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var s=this.jsPDFDocument.internal.getFont(),a=s.fontStyle,c=s.fontName;if(e.font&&(c=e.font),e.fontStyle){a=e.fontStyle;var u=this.getFontList()[c];u&&u.indexOf(a)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(u[0]),a=u[0])}if(this.jsPDFDocument.setFont(c,a),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!r){var h=t.unifyColor(e.fillColor);h&&(n=this.jsPDFDocument).setFillColor.apply(n,h),h=t.unifyColor(e.textColor),h&&(i=this.jsPDFDocument).setTextColor.apply(i,h),h=t.unifyColor(e.lineColor),h&&(o=this.jsPDFDocument).setDrawColor.apply(o,h),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,r,n){return this.jsPDFDocument.splitTextToSize(e,r,n)},t.prototype.rect=function(e,r,n,i,o){return this.jsPDFDocument.rect(e,r,n,i,o)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return X0||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t}(),wm=function(t,e){return wm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},wm(t,e)};function G5(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");wm(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Y5=function(t){G5(e,t);function e(r){var n=t.call(this)||this;return n._element=r,n}return e}(Array);function G7(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function Y7(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function Oh(t,e,r){r.applyStyles(e,!0);var n=Array.isArray(t)?t:[t],i=n.map(function(o){return r.getTextWidth(o)}).reduce(function(o,s){return Math.max(o,s)},0);return i}function K5(t,e,r,n){var i=e.settings.tableLineWidth,o=e.settings.tableLineColor;t.applyStyles({lineWidth:i,lineColor:o});var s=J5(i,!1);s&&t.rect(r.x,r.y,e.getWidth(t.pageSize().width),n.y-r.y,s)}function J5(t,e){var r=t>0,n=e||e===0;return r&&n?"DF":r?"S":n?"F":null}function ff(t,e){var r,n,i,o;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(r=t.left)!==null&&r!==void 0?r:e,top:(n=t.top)!==null&&n!==void 0?n:e,right:(i=t.right)!==null&&i!==void 0?i:e,bottom:(o=t.bottom)!==null&&o!==void 0?o:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function Q5(t,e){var r=ff(e.settings.margin,0);return t.pageSize().width-(r.left+r.right)}function K7(t,e,r,n,i){var o={},s=1.3333333333333333,a=bp(e,function(ne){return i.getComputedStyle(ne).backgroundColor});a!=null&&(o.fillColor=a);var c=bp(e,function(ne){return i.getComputedStyle(ne).color});c!=null&&(o.textColor=c);var u=Q7(n,r);u&&(o.cellPadding=u);var h="borderTopColor",y=s*r,g=n.borderTopWidth;if(n.borderBottomWidth===g&&n.borderRightWidth===g&&n.borderLeftWidth===g){var p=(parseFloat(g)||0)/y;p&&(o.lineWidth=p)}else o.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/y,right:(parseFloat(n.borderRightWidth)||0)/y,bottom:(parseFloat(n.borderBottomWidth)||0)/y,left:(parseFloat(n.borderLeftWidth)||0)/y},o.lineWidth.top||(o.lineWidth.right?h="borderRightColor":o.lineWidth.bottom?h="borderBottomColor":o.lineWidth.left&&(h="borderLeftColor"));var C=bp(e,function(ne){return i.getComputedStyle(ne)[h]});C!=null&&(o.lineColor=C);var S=["left","right","center","justify"];S.indexOf(n.textAlign)!==-1&&(o.halign=n.textAlign),S=["middle","bottom","top"],S.indexOf(n.verticalAlign)!==-1&&(o.valign=n.verticalAlign);var w=parseInt(n.fontSize||"");isNaN(w)||(o.fontSize=w/s);var x=J7(n);x&&(o.fontStyle=x);var V=(n.fontFamily||"").toLowerCase();return t.indexOf(V)!==-1&&(o.font=V),o}function J7(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function bp(t,e){var r=X5(t,e);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var i=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],o=parseInt(n[4]);return o===0||isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:i}function X5(t,e){var r=e(t);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?t.parentElement==null?null:X5(t.parentElement,e):r}function Q7(t,e){var r=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],n=96/(72/e),i=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,o=r.map(function(a){return parseInt(a||"0")/n}),s=ff(o,0);return i>s.top&&(s.top=i),i>s.bottom&&(s.bottom=i),s}function Z5(t,e,r,n,i){var o,s;n===void 0&&(n=!1),i===void 0&&(i=!1);var a;typeof e=="string"?a=r.document.querySelector(e):a=e;var c=Object.keys(t.getFontList()),u=t.scaleFactor(),h=[],y=[],g=[];if(!a)return console.error("Html table could not be found with input: ",e),{head:h,body:y,foot:g};for(var p=0;p<a.rows.length;p++){var C=a.rows[p],S=(s=(o=C?.parentElement)===null||o===void 0?void 0:o.tagName)===null||s===void 0?void 0:s.toLowerCase(),w=X7(c,u,r,C,n,i);w&&(S==="thead"?h.push(w):S==="tfoot"?g.push(w):y.push(w))}return{head:h,body:y,foot:g}}function X7(t,e,r,n,i,o){for(var s=new Y5(n),a=0;a<n.cells.length;a++){var c=n.cells[a],u=r.getComputedStyle(c);if(i||u.display!=="none"){var h=void 0;o&&(h=K7(t,c,e,u,r)),s.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:h,_element:c,content:Z7(c)})}}var y=r.getComputedStyle(n);if(s.length>0&&(i||y.display!=="none"))return s}function Z7(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),e.innerText||e.textContent||""}function eL(t,e,r){for(var n=0,i=[t,e,r];n<i.length;n++){var o=i[n];o&&typeof o!="object"&&console.error("The options parameter should be of type object, is: "+typeof o),o.startY&&typeof o.startY!="number"&&(console.error("Invalid value for startY option",o.startY),delete o.startY)}}function ks(t,e,r,n,i){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(t),s=1;s<arguments.length;s++){var a=arguments[s];if(a!=null)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(o[c]=a[c])}return o}function e_(t,e){var r=new pc(t),n=r.getDocumentOptions(),i=r.getGlobalOptions();eL(i,n,e);var o=ks({},i,n,e),s;typeof window<"u"&&(s=window);var a=tL(i,n,e),c=rL(i,n,e),u=nL(r,o),h=oL(r,o,s);return{id:e.tableId,content:h,hooks:c,styles:a,settings:u}}function tL(t,e,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},i=function(c){if(c==="columnStyles"){var u=t[c],h=e[c],y=r[c];n.columnStyles=ks({},u,h,y)}else{var g=[t,e,r],p=g.map(function(C){return C[c]||{}});n[c]=ks({},p[0],p[1],p[2])}},o=0,s=Object.keys(n);o<s.length;o++){var a=s[o];i(a)}return n}function rL(t,e,r){for(var n=[t,e,r],i={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},o=0,s=n;o<s.length;o++){var a=s[o];a.didParseCell&&i.didParseCell.push(a.didParseCell),a.willDrawCell&&i.willDrawCell.push(a.willDrawCell),a.didDrawCell&&i.didDrawCell.push(a.didDrawCell),a.willDrawPage&&i.willDrawPage.push(a.willDrawPage),a.didDrawPage&&i.didDrawPage.push(a.didDrawPage)}return i}function nL(t,e){var r,n,i,o,s,a,c,u,h,y,g,p,C=ff(e.margin,40/t.scaleFactor()),S=(r=iL(t,e.startY))!==null&&r!==void 0?r:C.top,w;e.showFoot===!0?w="everyPage":e.showFoot===!1?w="never":w=(n=e.showFoot)!==null&&n!==void 0?n:"everyPage";var x;e.showHead===!0?x="everyPage":e.showHead===!1?x="never":x=(i=e.showHead)!==null&&i!==void 0?i:"everyPage";var V=(o=e.useCss)!==null&&o!==void 0?o:!1,ne=e.theme||(V?"plain":"striped"),X=!!e.horizontalPageBreak,Q=(s=e.horizontalPageBreakRepeat)!==null&&s!==void 0?s:null;return{includeHiddenHtml:(a=e.includeHiddenHtml)!==null&&a!==void 0?a:!1,useCss:V,theme:ne,startY:S,margin:C,pageBreak:(c=e.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(u=e.rowPageBreak)!==null&&u!==void 0?u:"auto",tableWidth:(h=e.tableWidth)!==null&&h!==void 0?h:"auto",showHead:x,showFoot:w,tableLineWidth:(y=e.tableLineWidth)!==null&&y!==void 0?y:0,tableLineColor:(g=e.tableLineColor)!==null&&g!==void 0?g:200,horizontalPageBreak:X,horizontalPageBreakRepeat:Q,horizontalPageBreakBehaviour:(p=e.horizontalPageBreakBehaviour)!==null&&p!==void 0?p:"afterAllRows"}}function iL(t,e){var r=t.getLastAutoTable(),n=t.scaleFactor(),i=t.pageNumber(),o=!1;if(r&&r.startPageNumber){var s=r.startPageNumber+r.pageNumber-1;o=s===i}return typeof e=="number"?e:(e==null||e===!1)&&o&&r?.finalY!=null?r.finalY+20/n:null}function oL(t,e,r){var n=e.head||[],i=e.body||[],o=e.foot||[];if(e.html){var s=e.includeHiddenHtml;if(r){var a=Z5(t,e.html,r,s,e.useCss)||{};n=a.head||n,i=a.body||n,o=a.foot||n}else console.error("Cannot parse html in non browser environment")}var c=e.columns||sL(n,i,o);return{columns:c,head:n,body:i,foot:o}}function sL(t,e,r){var n=t[0]||e[0]||r[0]||[],i=[];return Object.keys(n).filter(function(o){return o!=="_element"}).forEach(function(o){var s=1,a;Array.isArray(n)?a=n[parseInt(o)]:a=n[o],typeof a=="object"&&!Array.isArray(a)&&(s=a?.colSpan||1);for(var c=0;c<s;c++){var u=void 0;Array.isArray(n)?u=i.length:u=o+(c>0?"_".concat(c):"");var h={dataKey:u};i.push(h)}}),i}var Sm=function(){function t(e,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=e.getDocument()}return t}(),aL=function(t){G5(e,t);function e(r,n,i,o,s,a){var c=t.call(this,r,n,a)||this;return c.cell=i,c.row=o,c.column=s,c.section=o.section,c}return e}(Sm),lL=function(){function t(e,r){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,r,n,i,o,s){for(var a=0,c=r;a<c.length;a++){var u=c[a],h=new aL(e,this,n,i,o,s),y=u(h)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],y)return!1}return!0},t.prototype.callEndPageHooks=function(e,r){e.applyStyles(e.userStyles);for(var n=0,i=this.hooks.didDrawPage;n<i.length;n++){var o=i[n];o(new Sm(e,this,r))}},t.prototype.callWillDrawPageHooks=function(e,r){for(var n=0,i=this.hooks.willDrawPage;n<i.length;n++){var o=i[n];o(new Sm(e,this,r))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(i,o){return i+o.wrappedWidth},0);return r}else{var n=this.settings.margin;return e-n.left-n.right}},t}(),t_=function(){function t(e,r,n,i,o){o===void 0&&(o=!1),this.height=0,this.raw=e,e instanceof Y5&&(this.raw=e._element,this.element=e._element),this.index=r,this.section=n,this.cells=i,this.spansMultiplePages=o}return t.prototype.getMaxCellHeight=function(e){var r=this;return e.reduce(function(n,i){var o;return Math.max(n,((o=r.cells[i.index])===null||o===void 0?void 0:o.height)||0)},0)},t.prototype.hasRowSpan=function(e){var r=this;return e.filter(function(n){var i=r.cells[n.index];return i?i.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,r){return this.getMaxCellHeight(r)<=e},t.prototype.getMinimumRowHeight=function(e,r){var n=this;return e.reduce(function(i,o){var s=n.cells[o.index];if(!s)return 0;var a=r.getLineHeight(s.styles.fontSize),c=s.padding("vertical"),u=c+a;return u>i?u:i},0)},t}(),r_=function(){function t(e,r,n){var i;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=e;var o=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,o=(i=e.content)!==null&&i!==void 0?i:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var s=o!=null?""+o:"",a=/\r\n|\r|\n/g;this.text=s.split(a)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");e=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var i=this.width-this.padding("horizontal");n=this.x+i/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:e}},t.prototype.getContentHeight=function(e,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,i=this.styles.fontSize/e*r,o=n*i+this.padding("vertical");return Math.max(o,this.styles.minCellHeight)},t.prototype.padding=function(e){var r=ff(this.styles.cellPadding,0);return e==="vertical"?r.top+r.bottom:e==="horizontal"?r.left+r.right:r[e]},t}(),cL=function(){function t(e,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=r,this.index=n}return t.prototype.getMaxCustomCellWidth=function(e){for(var r=0,n=0,i=e.allRows();n<i.length;n++){var o=i[n],s=o.cells[this.index];s&&typeof s.styles.cellWidth=="number"&&(r=Math.max(r,s.styles.cellWidth))}return r},t}();function uL(t,e){dL(t,e);var r=[],n=0;e.columns.forEach(function(o){var s=o.getMaxCustomCellWidth(e);s?o.width=s:(o.width=o.wrappedWidth,r.push(o)),n+=o.width});var i=e.getWidth(t.pageSize().width)-n;i&&(i=Pm(r,i,function(o){return Math.max(o.minReadableWidth,o.minWidth)})),i&&(i=Pm(r,i,function(o){return o.minWidth})),i=Math.abs(i),!e.settings.horizontalPageBreak&&i>.1/t.scaleFactor()&&(i=i<1?i:Math.round(i),console.warn("Of the table content, ".concat(i," units width could not fit page"))),fL(e),pL(e,t),hL(e)}function dL(t,e){var r=t.scaleFactor(),n=e.settings.horizontalPageBreak,i=Q5(t,e);e.allRows().forEach(function(o){for(var s=0,a=e.columns;s<a.length;s++){var c=a[s],u=o.cells[c.index];if(u){var h=e.hooks.didParseCell;e.callCellHooks(t,h,u,o,c,null);var y=u.padding("horizontal");u.contentWidth=Oh(u.text,u.styles,t)+y;var g=Oh(u.text.join(" ").split(/[^\S\u00A0]+/),u.styles,t);if(u.minReadableWidth=g+u.padding("horizontal"),typeof u.styles.cellWidth=="number")u.minWidth=u.styles.cellWidth,u.wrappedWidth=u.styles.cellWidth;else if(u.styles.cellWidth==="wrap"||n===!0)u.contentWidth>i?(u.minWidth=i,u.wrappedWidth=i):(u.minWidth=u.contentWidth,u.wrappedWidth=u.contentWidth);else{var p=10/r;u.minWidth=u.styles.minCellWidth||p,u.wrappedWidth=u.contentWidth,u.minWidth>u.wrappedWidth&&(u.wrappedWidth=u.minWidth)}}}}),e.allRows().forEach(function(o){for(var s=0,a=e.columns;s<a.length;s++){var c=a[s],u=o.cells[c.index];if(u&&u.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,u.wrappedWidth),c.minWidth=Math.max(c.minWidth,u.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,u.minReadableWidth);else{var h=e.styles.columnStyles[c.dataKey]||e.styles.columnStyles[c.index]||{},y=h.cellWidth||h.minCellWidth;y&&typeof y=="number"&&(c.minWidth=y,c.wrappedWidth=y)}u&&(u.colSpan>1&&!c.minWidth&&(c.minWidth=u.minWidth),u.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=u.minWidth))}})}function Pm(t,e,r){for(var n=e,i=t.reduce(function(p,C){return p+C.wrappedWidth},0),o=0;o<t.length;o++){var s=t[o],a=s.wrappedWidth/i,c=n*a,u=s.width+c,h=r(s),y=u<h?h:u;e-=y-s.width,s.width=y}if(e=Math.round(e*1e10)/1e10,e){var g=t.filter(function(p){return e<0?p.width>r(p):!0});g.length&&(e=Pm(g,e,r))}return e}function hL(t){for(var e={},r=1,n=t.allRows(),i=0;i<n.length;i++)for(var o=n[i],s=0,a=t.columns;s<a.length;s++){var c=a[s],u=e[c.index];if(r>1)r--,delete o.cells[c.index];else if(u)u.cell.height+=o.height,r=u.cell.colSpan,delete o.cells[c.index],u.left--,u.left<=1&&delete e[c.index];else{var h=o.cells[c.index];if(!h)continue;if(h.height=o.height,h.rowSpan>1){var y=n.length-i,g=h.rowSpan>y?y:h.rowSpan;e[c.index]={cell:h,left:g,row:o}}}}}function fL(t){for(var e=t.allRows(),r=0;r<e.length;r++)for(var n=e[r],i=null,o=0,s=0,a=0;a<t.columns.length;a++){var c=t.columns[a];if(s-=1,s>1&&t.columns[a+1])o+=c.width,delete n.cells[c.index];else if(i){var u=i;delete n.cells[c.index],i=null,u.width=c.width+o}else{var u=n.cells[c.index];if(!u)continue;if(s=u.colSpan,o=0,u.colSpan>1){i=u,o+=c.width;continue}u.width=c.width+o}}}function pL(t,e){for(var r={count:0,height:0},n=0,i=t.allRows();n<i.length;n++){for(var o=i[n],s=0,a=t.columns;s<a.length;s++){var c=a[s],u=o.cells[c.index];if(u){e.applyStyles(u.styles,!0);var h=u.width-u.padding("horizontal");if(u.styles.overflow==="linebreak")u.text=e.splitTextToSize(u.text,h+1/e.scaleFactor(),{fontSize:u.styles.fontSize});else if(u.styles.overflow==="ellipsize")u.text=Z0(u.text,h,u.styles,e,"...");else if(u.styles.overflow==="hidden")u.text=Z0(u.text,h,u.styles,e,"");else if(typeof u.styles.overflow=="function"){var y=u.styles.overflow(u.text,h);typeof y=="string"?u.text=[y]:u.text=y}u.contentHeight=u.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var g=u.contentHeight/u.rowSpan;u.rowSpan>1&&r.count*r.height<g*u.rowSpan?r={height:g,count:u.rowSpan}:r&&r.count>0&&r.height>g&&(g=r.height),g>o.height&&(o.height=g)}}r.count--}}function Z0(t,e,r,n,i){return t.map(function(o){return mL(o,e,r,n,i)})}function mL(t,e,r,n,i){var o=1e4*n.scaleFactor();if(e=Math.ceil(e*o)/o,e>=Oh(t,r,n))return t;for(;e<Oh(t+i,r,n)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+i}function n_(t,e){var r=new pc(t),n=yL(e,r.scaleFactor()),i=new lL(e,n);return uL(r,i),r.applyStyles(r.userStyles),i}function yL(t,e){var r=t.content,n=vL(r.columns);if(r.head.length===0){var i=e1(n,"head");i&&r.head.push(i)}if(r.foot.length===0){var i=e1(n,"foot");i&&r.foot.push(i)}var o=t.settings.theme,s=t.styles;return{columns:n,head:_p("head",r.head,n,s,o,e),body:_p("body",r.body,n,s,o,e),foot:_p("foot",r.foot,n,s,o,e)}}function _p(t,e,r,n,i,o){var s={},a=e.map(function(c,u){for(var h=0,y={},g=0,p=0,C=0,S=r;C<S.length;C++){var w=S[C];if(s[w.index]==null||s[w.index].left===0)if(p===0){var x=void 0;Array.isArray(c)?x=c[w.index-g-h]:x=c[w.dataKey];var V={};typeof x=="object"&&!Array.isArray(x)&&(V=x?.styles||{});var ne=bL(t,w,u,i,n,o,V),X=new r_(x,ne,t);y[w.dataKey]=X,y[w.index]=X,p=X.colSpan-1,s[w.index]={left:X.rowSpan-1,times:p}}else p--,g++;else s[w.index].left--,p=s[w.index].times,h++}return new t_(c,u,t,y)});return a}function e1(t,e){var r={};return t.forEach(function(n){if(n.raw!=null){var i=gL(e,n.raw);i!=null&&(r[n.dataKey]=i)}}),Object.keys(r).length>0?r:null}function gL(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function vL(t){return t.map(function(e,r){var n,i;return typeof e=="object"?i=(n=e.dataKey)!==null&&n!==void 0?n:r:i=r,new cL(i,e,r)})}function bL(t,e,r,n,i,o,s){var a=Y7(n),c;t==="head"?c=i.headStyles:t==="body"?c=i.bodyStyles:t==="foot"&&(c=i.footStyles);var u=ks({},a.table,a[t],i.styles,c),h=i.columnStyles[e.dataKey]||i.columnStyles[e.index]||{},y=t==="body"?h:{},g=t==="body"&&r%2===0?ks({},a.alternateRow,i.alternateRowStyles):{},p=G7(o),C=ks({},p,u,g,y);return ks(C,s)}function _L(t,e,r){var n;r===void 0&&(r={});var i=Q5(t,e),o=new Map,s=[],a=[],c=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?c=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(c=[e.settings.horizontalPageBreakRepeat]),c.forEach(function(g){var p=e.columns.find(function(C){return C.dataKey===g||C.index===g});p&&!o.has(p.index)&&(o.set(p.index,!0),s.push(p.index),a.push(e.columns[p.index]),i-=p.wrappedWidth)});for(var u=!0,h=(n=r?.start)!==null&&n!==void 0?n:0;h<e.columns.length;){if(o.has(h)){h++;continue}var y=e.columns[h].wrappedWidth;if(u||i>=y)u=!1,s.push(h),a.push(e.columns[h]),i-=y;else break;h++}return{colIndexes:s,columns:a,lastIndex:h-1}}function wL(t,e){for(var r=[],n=0;n<e.columns.length;n++){var i=_L(t,e,{start:n});i.columns.length&&(r.push(i),n=i.lastIndex)}return r}function i_(t,e){var r=e.settings,n=r.startY,i=r.margin,o={x:i.left,y:n},s=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),a=n+i.bottom+s;if(r.pageBreak==="avoid"){var c=e.body,u=c.reduce(function(g,p){return g+p.height},0);a+=u}var h=new pc(t);(r.pageBreak==="always"||r.startY!=null&&a>h.pageSize().height)&&(s_(h),o.y=i.top),e.callWillDrawPageHooks(h,o);var y=ks({},o);e.startPageNumber=h.pageNumber(),r.horizontalPageBreak?SL(h,e,y,o):(h.applyStyles(h.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&e.head.forEach(function(g){return Os(h,e,g,o,e.columns)}),h.applyStyles(h.userStyles),e.body.forEach(function(g,p){var C=p===e.body.length-1;Bh(h,e,g,C,y,o,e.columns)}),h.applyStyles(h.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&e.foot.forEach(function(g){return Os(h,e,g,o,e.columns)})),K5(h,e,y,o),e.callEndPageHooks(h,o),e.finalY=o.y,t.lastAutoTable=e,h.applyStyles(h.userStyles)}function SL(t,e,r,n){var i=wL(t,e),o=e.settings;if(o.horizontalPageBreakBehaviour==="afterAllRows")i.forEach(function(u,h){t.applyStyles(t.userStyles),h>0?Su(t,e,r,n,u.columns,!0):t1(t,e,n,u.columns),PL(t,e,r,n,u.columns),wp(t,e,n,u.columns)});else for(var s=-1,a=i[0],c=function(){var u=s;if(a){t.applyStyles(t.userStyles);var h=a.columns;s>=0?Su(t,e,r,n,h,!0):t1(t,e,n,h),u=r1(t,e,s+1,n,h),wp(t,e,n,h)}var y=u-s;i.slice(1).forEach(function(g){t.applyStyles(t.userStyles),Su(t,e,r,n,g.columns,!0),r1(t,e,s+1,n,g.columns,y),wp(t,e,n,g.columns)}),s=u};s<e.body.length-1;)c()}function t1(t,e,r,n){var i=e.settings;t.applyStyles(t.userStyles),(i.showHead==="firstPage"||i.showHead==="everyPage")&&e.head.forEach(function(o){return Os(t,e,o,r,n)})}function PL(t,e,r,n,i){t.applyStyles(t.userStyles),e.body.forEach(function(o,s){var a=s===e.body.length-1;Bh(t,e,o,a,r,n,i)})}function r1(t,e,r,n,i,o){t.applyStyles(t.userStyles),o=o??e.body.length;var s=Math.min(r+o,e.body.length),a=-1;return e.body.slice(r,s).forEach(function(c,u){var h=r+u===e.body.length-1,y=o_(t,e,h,n);c.canEntireRowFit(y,i)&&(Os(t,e,c,n,i),a=r+u)}),a}function wp(t,e,r,n){var i=e.settings;t.applyStyles(t.userStyles),(i.showFoot==="lastPage"||i.showFoot==="everyPage")&&e.foot.forEach(function(o){return Os(t,e,o,r,n)})}function xL(t,e,r){var n=r.getLineHeight(t.styles.fontSize),i=t.padding("vertical"),o=Math.floor((e-i)/n);return Math.max(0,o)}function AL(t,e,r,n){var i={};t.spansMultiplePages=!0,t.height=0;for(var o=0,s=0,a=r.columns;s<a.length;s++){var c=a[s],u=t.cells[c.index];if(u){Array.isArray(u.text)||(u.text=[u.text]);var h=new r_(u.raw,u.styles,u.section);h=ks(h,u),h.text=[];var y=xL(u,e,n);u.text.length>y&&(h.text=u.text.splice(y,u.text.length));var g=n.scaleFactor(),p=n.getLineHeightFactor();u.contentHeight=u.getContentHeight(g,p),u.contentHeight>=e&&(u.contentHeight=e,h.styles.minCellHeight-=e),u.contentHeight>t.height&&(t.height=u.contentHeight),h.contentHeight=h.getContentHeight(g,p),h.contentHeight>o&&(o=h.contentHeight),i[c.index]=h}}var C=new t_(t.raw,-1,t.section,i,!0);C.height=o;for(var S=0,w=r.columns;S<w.length;S++){var c=w[S],h=C.cells[c.index];h&&(h.height=C.height);var u=t.cells[c.index];u&&(u.height=t.height)}return C}function CL(t,e,r,n){var i=t.pageSize().height,o=n.settings.margin,s=o.top+o.bottom,a=i-s;e.section==="body"&&(a-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=e.getMinimumRowHeight(n.columns,t),u=c<r;if(c>a)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!u)return!1;var h=e.hasRowSpan(n.columns),y=e.getMaxCellHeight(n.columns)>a;return y?(h&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(h||n.settings.rowPageBreak==="avoid")}function Bh(t,e,r,n,i,o,s){var a=o_(t,e,n,o);if(r.canEntireRowFit(a,s))Os(t,e,r,o,s);else if(CL(t,r,a,e)){var c=AL(r,a,e,t);Os(t,e,r,o,s),Su(t,e,i,o,s),Bh(t,e,c,n,i,o,s)}else Su(t,e,i,o,s),Bh(t,e,r,n,i,o,s)}function Os(t,e,r,n,i){n.x=e.settings.margin.left;for(var o=0,s=i;o<s.length;o++){var a=s[o],c=r.cells[a.index];if(!c){n.x+=a.width;continue}t.applyStyles(c.styles),c.x=n.x,c.y=n.y;var u=e.callCellHooks(t,e.hooks.willDrawCell,c,r,a,n);if(u===!1){n.x+=a.width;continue}IL(t,c,n);var h=c.getTextPos();W5(c.text,h.x,h.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,c,r,a,n),n.x+=a.width}n.y+=r.height}function IL(t,e,r){var n=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof n.lineWidth=="number"){var i=J5(n.lineWidth,n.fillColor);i&&t.rect(e.x,r.y,e.width,e.height,i)}else typeof n.lineWidth=="object"&&(n.fillColor&&t.rect(e.x,r.y,e.width,e.height,"F"),$L(t,e,r,n.lineWidth))}function $L(t,e,r,n){var i,o,s,a;n.top&&(i=r.x,o=r.y,s=r.x+e.width,a=r.y,n.right&&(s+=.5*n.right),n.left&&(i-=.5*n.left),c(n.top,i,o,s,a)),n.bottom&&(i=r.x,o=r.y+e.height,s=r.x+e.width,a=r.y+e.height,n.right&&(s+=.5*n.right),n.left&&(i-=.5*n.left),c(n.bottom,i,o,s,a)),n.left&&(i=r.x,o=r.y,s=r.x,a=r.y+e.height,n.top&&(o-=.5*n.top),n.bottom&&(a+=.5*n.bottom),c(n.left,i,o,s,a)),n.right&&(i=r.x+e.width,o=r.y,s=r.x+e.width,a=r.y+e.height,n.top&&(o-=.5*n.top),n.bottom&&(a+=.5*n.bottom),c(n.right,i,o,s,a));function c(u,h,y,g,p){t.getDocument().setLineWidth(u),t.getDocument().line(h,y,g,p,"S")}}function o_(t,e,r,n){var i=e.settings.margin.bottom,o=e.settings.showFoot;return(o==="everyPage"||o==="lastPage"&&r)&&(i+=e.getFootHeight(e.columns)),t.pageSize().height-n.y-i}function Su(t,e,r,n,i,o){i===void 0&&(i=[]),o===void 0&&(o=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!o&&e.foot.forEach(function(a){return Os(t,e,a,n,i)}),e.callEndPageHooks(t,n);var s=e.settings.margin;K5(t,e,r,n),s_(t),e.pageNumber++,n.x=s.left,n.y=s.top,r.y=s.top,e.callWillDrawPageHooks(t,n),e.settings.showHead==="everyPage"&&(e.head.forEach(function(a){return Os(t,e,a,n,i)}),t.applyStyles(t.userStyles))}function s_(t){var e=t.pageNumber();t.setPage(e+1);var r=t.pageNumber();return r===e?(t.addPage(),!0):!1}function EL(t){t.API.autoTable=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=e[0],i=e_(this,n),o=n_(this,i);return i_(this,o),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,r,n,i){W5(e,r,n,i,this)},t.API.autoTableSetDefaults=function(e){return pc.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,r){pc.setDefaults(e,r)},t.API.autoTableHtmlToJson=function(e,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var i=new pc(this),o=Z5(i,e,window,r,!1),s=o.head,a=o.body,c=((n=s[0])===null||n===void 0?void 0:n.map(function(u){return u.content}))||[];return{columns:c,rows:a,data:a}}}var Sp;function iR(t,e){var r=e_(t,e),n=n_(t,r);i_(t,n)}try{if(typeof window<"u"&&window){var n1=window,i1=n1.jsPDF||((Sp=n1.jspdf)===null||Sp===void 0?void 0:Sp.jsPDF);i1&&EL(i1)}}catch(t){console.error("Could not apply autoTable plugin",t)}var kL=de("<div><div><label></label><select><option value=all></option></select></div><div><label></label><select><option value=all></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label></label></div><div><label></label></div><div><label></label><select><option value=all>"),TL=de("<div><div><div></div></div><div><div> <!> <!> <!> </div><div>"),NL=de("<div><div>"),Gd=de("<option>"),LL=de("<option> "),DL=de("<div><div><div><div></div><div></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div></div><div><div></div><div></div></div></div><div><div><span>: </span><span></span></div><div><span>: </span><span></span></div><div><span>: </span><span></span></div><div><span>: </span><span> kg</span></div><div><span>: </span><span></span></div><div><span>: </span><span>");const RL=t=>{const{t:e}=er(),[r,n]=$e(""),[i,o]=$e("all"),[s,a]=$e({start:"",end:""}),[c,u]=$e(""),[h,y]=$e(""),[g,p]=$e(!1),[C,S]=$e("all"),[w,x]=$e("all"),V=Tt(()=>{let G=t.hbls;var ie="";if(r()&&(ie+=r().toLowerCase()),r()){const F=r().toLowerCase();G=G.filter(W=>W.hbl.toLowerCase().includes(F)||W.idairguide.toLowerCase().includes(F)||W.nameshipper.toLowerCase().includes(F)||W.consigneeName.toLowerCase().includes(F)||W.namegood.toLowerCase().includes(F)||W.bagnumber.toLowerCase().includes(F)||W.cidentity.toLowerCase().includes(F))}return i()!=="all"&&(G=G.filter(F=>F.idguidestate===i())),C()!=="all"&&(G=G.filter(F=>F.idclasification===C())),(s().start||s().end)&&(G=G.filter(F=>{const W=new Date(F.datereserve),z=s().start?new Date(s().start):new Date("1900-01-01"),O=s().end?new Date(s().end):new Date("2100-12-31");return W>=z&&W<=O})),c()&&(G=G.filter(F=>F.nameshipper.toLowerCase().includes(c().toLowerCase()))),h()&&(G=G.filter(F=>F.consigneeName.toLowerCase().includes(h().toLowerCase()))),w()!=="all"&&(G=G.filter(F=>F.guia===w())),G=G.sort((F,W)=>new Date(W.datereserve).getTime()-new Date(F.datereserve).getTime()),t.onFilterChange?.(G),G}),ne=Tt(()=>{const G=new Set(t.hbls.map(ie=>ie.nameshipper));return Array.from(G).sort()}),X=Tt(()=>{const G=new Set(t.hbls.map(ie=>ie.consigneeName));return Array.from(G).sort()}),Q=Tt(()=>{const G=new Set(t.hbls.map(ie=>ie.idguidestate));return Array.from(G).sort()}),ee=Tt(()=>{const G=new Set(t.hbls.map(ie=>ie.idclasification));return Array.from(G).sort()}),E=Tt(()=>{const G=new Set(t.hbls.map(ie=>ie.guia));return Array.from(G).sort((ie,F)=>parseInt(ie)-parseInt(F))}),A=()=>{n(""),o("all"),a({start:"",end:""}),u(""),y(""),S("all"),x("all")},T=()=>{const G=["HBL Number","Air Guide","Status","Classification","Shipper","Consignee","Identity","Phone","City","Commodity","Weight (kg)","Quantity","Bag Number","Reserve Date"],ie=V().map(k=>[k.hbl,k.idairguide,k.idguidestate,k.idclasification,k.nameshipper,k.consigneeName,k.cidentity,k.phoneshipper,k.address.city,k.namegood,k.weight,k.quantity,k.bagnumber,new Date(k.datereserve).toLocaleDateString()]),F=[G.join(","),...ie.map(k=>k.map(re=>`"${re}"`).join(","))].join(`
`),W=new Blob([F],{type:"text/csv"}),z=URL.createObjectURL(W),O=document.createElement("a");O.href=z,O.download=`HBL_List_${new Date().toISOString().split("T")[0]}.csv`,O.click(),URL.revokeObjectURL(z)},R=()=>{const G=["HBL Number","Air Guide","Air Number","Status","Classification","Shipper","Consignee","Identity","Shipper Phone","Consignee Phone","Street","City","State","Commodity","Weight (kg)","Quantity","Bag Number","Agency","Guide","Reserve Date"];V().map(k=>[k.hbl,k.idairguide,k.idairnumber,k.idguidestate,k.idclasification,k.nameshipper,k.consigneeName,k.cidentity,k.phoneshipper,k.ctelephone,k.street,k.address.city,k.address.estate,k.namegood,k.weight,k.quantity,k.bagnumber,k.agency,k.guia,new Date(k.datereserve).toLocaleDateString()]);const ie=V().map(k=>[k.hbl,k.idairguide,k.idairnumber,k.idguidestate,k.idclasification,k.nameshipper,k.consigneeName,k.cidentity,k.phoneshipper,k.ctelephone,k.street,k.address.city,k.address.estate,k.namegood,k.weight,k.quantity,k.bagnumber,k.agency,k.guia,new Date(k.datereserve).toLocaleDateString()]),F=[G.join("	"),...ie.map(k=>k.join("	"))].join(`
`),W=new Blob([F],{type:"application/vnd.ms-excel"}),z=URL.createObjectURL(W),O=document.createElement("a");O.href=z,O.download=`HBL_List_${new Date().toISOString().split("T")[0]}.xls`,O.click(),URL.revokeObjectURL(z)},_=()=>{const G=new or;G.setFontSize(16),G.text("House Bill of Lading List",14,15),G.setFontSize(10),G.text(`Generated: ${new Date().toLocaleString()}`,14,25),G.setFontSize(10);let ie=35;r()&&(G.text(`Search: ${r()}`,14,ie),ie+=5),i()!=="all"&&(G.text(`Status: ${i()}`,14,ie),ie+=5);const F=["HBL#","Status","Shipper","Consignee","City","Weight","Commodity"],W=V().map(z=>[z.hbl,z.idguidestate,z.nameshipper.substring(0,20)+(z.nameshipper.length>20?"...":""),z.consigneeName.substring(0,20)+(z.consigneeName.length>20?"...":""),z.address.city,z.weight+" kg",z.namegood.substring(0,15)+(z.namegood.length>15?"...":"")]);G.autoTable({head:[F],body:W,startY:ie+5,styles:{fontSize:8},headStyles:{fillColor:[0,123,255]}}),G.save(`HBL_List_${new Date().toISOString().split("T")[0]}.pdf`)},I=G=>G?new Date(G).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-",b=G=>({"EN BODEGA":"#17a2b8",ENVIADO:"#007bff",ENTREGADO:"#28a745",CANCELADO:"#dc3545",PENDIENTE:"#ffc107"})[G]||"#6c757d";return(()=>{var G=NL(),ie=G.firstChild;return l(G,B(Nt,{get children(){var F=TL(),W=F.firstChild,z=W.firstChild,O=W.nextSibling,k=O.firstChild,re=k.firstChild,$=re.nextSibling,D=$.nextSibling,H=D.nextSibling,L=H.nextSibling,j=L.nextSibling;j.nextSibling;var oe=k.nextSibling;return F.style.setProperty("padding","1rem"),W.style.setProperty("display","grid"),W.style.setProperty("grid-template-columns","1fr auto"),W.style.setProperty("gap","1rem"),W.style.setProperty("margin-bottom","1rem"),l(W,B(Or,{type:"text",get placeholder(){return e("hbl.searchPlaceholder","Search by HBL#, air guide, shipper, consignee, commodity, bag#, identity...")},get value(){return r()},onInput:K=>n(K.currentTarget.value)}),z),z.style.setProperty("display","flex"),z.style.setProperty("gap","0.5rem"),l(z,B(xt,{variant:"outline",size:"sm",onClick:()=>p(!g()),get children(){return Te(()=>!!g())()?e("common.hideFilters","Hide Filters"):e("common.showFilters","Show Filters")}}),null),l(z,B(xt,{variant:"outline",size:"sm",onClick:A,get children(){return e("common.clearFilters","Clear Filters")}}),null),l(F,B(Ge,{get when(){return g()},get children(){var K=kL(),Z=K.firstChild,J=Z.firstChild,Y=J.nextSibling,U=Y.firstChild,ae=Z.nextSibling,ue=ae.firstChild,le=ue.nextSibling,q=le.firstChild,ce=ae.nextSibling,Se=ce.firstChild,me=Se.nextSibling,Pe=me.firstChild,xe=ce.nextSibling,he=xe.firstChild,ve=he.nextSibling,De=ve.firstChild,ke=xe.nextSibling,Ce=ke.firstChild,Le=ke.nextSibling,Ie=Le.firstChild,Re=Le.nextSibling,He=Re.firstChild,Me=He.nextSibling,Ze=Me.firstChild;return K.style.setProperty("display","grid"),K.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),K.style.setProperty("gap","1rem"),K.style.setProperty("margin-bottom","1rem"),K.style.setProperty("padding","1rem"),K.style.setProperty("background","var(--background-color)"),K.style.setProperty("border-radius","var(--border-radius-sm)"),J.style.setProperty("display","block"),J.style.setProperty("margin-bottom","0.25rem"),J.style.setProperty("font-size","0.875rem"),J.style.setProperty("color","var(--text-muted)"),l(J,()=>e("common.status","Status")),Y.addEventListener("change",Ye=>o(Ye.currentTarget.value)),Y.style.setProperty("width","100%"),Y.style.setProperty("padding","0.5rem"),Y.style.setProperty("border","1px solid var(--border-color)"),Y.style.setProperty("border-radius","var(--border-radius-sm)"),Y.style.setProperty("background","var(--surface-color)"),l(U,()=>e("common.all","All")),l(Y,B(Ut,{get each(){return Q()},children:Ye=>(()=>{var ut=Gd();return ut.value=Ye,l(ut,Ye),ut})()}),null),ue.style.setProperty("display","block"),ue.style.setProperty("margin-bottom","0.25rem"),ue.style.setProperty("font-size","0.875rem"),ue.style.setProperty("color","var(--text-muted)"),l(ue,()=>e("hbl.classification","Classification")),le.addEventListener("change",Ye=>S(Ye.currentTarget.value)),le.style.setProperty("width","100%"),le.style.setProperty("padding","0.5rem"),le.style.setProperty("border","1px solid var(--border-color)"),le.style.setProperty("border-radius","var(--border-radius-sm)"),le.style.setProperty("background","var(--surface-color)"),l(q,()=>e("common.all","All")),l(le,B(Ut,{get each(){return ee()},children:Ye=>(()=>{var ut=Gd();return ut.value=Ye,l(ut,Ye),ut})()}),null),Se.style.setProperty("display","block"),Se.style.setProperty("margin-bottom","0.25rem"),Se.style.setProperty("font-size","0.875rem"),Se.style.setProperty("color","var(--text-muted)"),l(Se,()=>e("hbl.shipper","Shipper")),me.addEventListener("change",Ye=>u(Ye.currentTarget.value)),me.style.setProperty("width","100%"),me.style.setProperty("padding","0.5rem"),me.style.setProperty("border","1px solid var(--border-color)"),me.style.setProperty("border-radius","var(--border-radius-sm)"),me.style.setProperty("background","var(--surface-color)"),l(Pe,()=>e("common.all","All")),l(me,B(Ut,{get each(){return ne()},children:Ye=>(()=>{var ut=Gd();return ut.value=Ye,l(ut,Ye),ut})()}),null),he.style.setProperty("display","block"),he.style.setProperty("margin-bottom","0.25rem"),he.style.setProperty("font-size","0.875rem"),he.style.setProperty("color","var(--text-muted)"),l(he,()=>e("hbl.consignee","Consignee")),ve.addEventListener("change",Ye=>y(Ye.currentTarget.value)),ve.style.setProperty("width","100%"),ve.style.setProperty("padding","0.5rem"),ve.style.setProperty("border","1px solid var(--border-color)"),ve.style.setProperty("border-radius","var(--border-radius-sm)"),ve.style.setProperty("background","var(--surface-color)"),l(De,()=>e("common.all","All")),l(ve,B(Ut,{get each(){return X()},children:Ye=>(()=>{var ut=Gd();return ut.value=Ye,l(ut,Ye),ut})()}),null),Ce.style.setProperty("display","block"),Ce.style.setProperty("margin-bottom","0.25rem"),Ce.style.setProperty("font-size","0.875rem"),Ce.style.setProperty("color","var(--text-muted)"),l(Ce,()=>e("common.dateFrom","Date From")),l(ke,B(Or,{type:"date",get value(){return s().start},onInput:Ye=>a({...s(),start:Ye.currentTarget.value})}),null),Ie.style.setProperty("display","block"),Ie.style.setProperty("margin-bottom","0.25rem"),Ie.style.setProperty("font-size","0.875rem"),Ie.style.setProperty("color","var(--text-muted)"),l(Ie,()=>e("common.dateTo","Date To")),l(Le,B(Or,{type:"date",get value(){return s().end},onInput:Ye=>a({...s(),end:Ye.currentTarget.value})}),null),He.style.setProperty("display","block"),He.style.setProperty("margin-bottom","0.25rem"),He.style.setProperty("font-size","0.875rem"),He.style.setProperty("color","var(--text-muted)"),l(He,()=>e("hbl.guideNumber","Guide Number")),Me.addEventListener("change",Ye=>x(Ye.currentTarget.value)),Me.style.setProperty("width","100%"),Me.style.setProperty("padding","0.5rem"),Me.style.setProperty("border","1px solid var(--border-color)"),Me.style.setProperty("border-radius","var(--border-radius-sm)"),Me.style.setProperty("background","var(--surface-color)"),l(Ze,()=>e("common.all","All")),l(Me,B(Ut,{get each(){return E()},children:Ye=>(()=>{var ut=LL(),rt=ut.firstChild;return ut.value=Ye,l(ut,()=>e("hbl.guideNo","Guide No."),rt),l(ut,Ye,null),ut})()}),null),we(()=>Y.value=i()),we(()=>le.value=C()),we(()=>me.value=c()),we(()=>ve.value=h()),we(()=>Me.value=w()),K}}),O),O.style.setProperty("display","flex"),O.style.setProperty("justify-content","space-between"),O.style.setProperty("align-items","center"),O.style.setProperty("margin-bottom","1rem"),k.style.setProperty("font-size","0.875rem"),k.style.setProperty("color","var(--text-muted)"),l(k,()=>e("common.showing","Showing"),re),l(k,()=>V().length,$),l(k,()=>e("common.of","of"),H),l(k,()=>t.hbls.length,j),l(k,()=>e("hbl.records","records"),null),oe.style.setProperty("display","flex"),oe.style.setProperty("gap","0.5rem"),l(oe,B(xt,{variant:"outline",size:"sm",onClick:_,get children(){return e("common.print","Print")}}),null),l(oe,B(xt,{variant:"outline",size:"sm",onClick:T,get children(){return e("common.exportCSV","Export CSV")}}),null),l(oe,B(xt,{variant:"outline",size:"sm",onClick:R,get children(){return e("common.exportExcel","Export Excel")}}),null),F}}),ie),ie.style.setProperty("margin-top","1rem"),l(ie,B(Ut,{get each(){return V()},children:F=>B(Nt,{style:{"margin-bottom":"0.5rem"},get children(){var W=DL(),z=W.firstChild,O=z.firstChild,k=O.firstChild,re=k.nextSibling,$=O.nextSibling,D=$.firstChild,H=D.firstChild,L=H.nextSibling,j=D.nextSibling,oe=j.firstChild,K=oe.nextSibling,Z=$.nextSibling,J=Z.firstChild,Y=J.nextSibling,U=z.nextSibling,ae=U.firstChild,ue=ae.firstChild,le=ue.firstChild,q=ue.nextSibling,ce=ae.nextSibling,Se=ce.firstChild,me=Se.firstChild,Pe=Se.nextSibling,xe=ce.nextSibling,he=xe.firstChild,ve=he.firstChild,De=he.nextSibling,ke=xe.nextSibling,Ce=ke.firstChild,Le=Ce.firstChild,Ie=Ce.nextSibling,Re=Ie.firstChild,He=ke.nextSibling,Me=He.firstChild,Ze=Me.firstChild,Ye=Me.nextSibling,ut=He.nextSibling,rt=ut.firstChild,We=rt.firstChild,ct=rt.nextSibling;return W.addEventListener("mouseleave",pt=>{pt.currentTarget.style.backgroundColor="transparent"}),W.addEventListener("mouseenter",pt=>{pt.currentTarget.style.backgroundColor="var(--strip-color)"}),W.$$click=()=>t.onHBLSelect?.(F),W.style.setProperty("padding","1rem"),W.style.setProperty("cursor","pointer"),W.style.setProperty("transition","background-color 0.2s"),z.style.setProperty("display","grid"),z.style.setProperty("grid-template-columns","150px 1fr auto"),z.style.setProperty("gap","1rem"),z.style.setProperty("align-items","center"),k.style.setProperty("font-weight","600"),k.style.setProperty("color","var(--primary-color)"),l(k,()=>F.hbl),re.style.setProperty("font-size","0.75rem"),re.style.setProperty("color","var(--text-muted)"),l(re,()=>F.idairguide),$.style.setProperty("display","grid"),$.style.setProperty("grid-template-columns","1fr 1fr"),$.style.setProperty("gap","1rem"),H.style.setProperty("font-size","0.75rem"),H.style.setProperty("color","var(--text-muted)"),l(H,()=>e("hbl.shipper","Shipper")),L.style.setProperty("font-weight","500"),l(L,()=>F.nameshipper),oe.style.setProperty("font-size","0.75rem"),oe.style.setProperty("color","var(--text-muted)"),l(oe,()=>e("hbl.consignee","Consignee")),K.style.setProperty("font-weight","500"),l(K,()=>F.consigneeName),Z.style.setProperty("text-align","right"),J.style.setProperty("display","inline-block"),J.style.setProperty("padding","0.25rem 0.75rem"),J.style.setProperty("border-radius","var(--border-radius-sm)"),J.style.setProperty("font-size","0.75rem"),J.style.setProperty("font-weight","500"),J.style.setProperty("color","white"),l(J,()=>F.idguidestate),Y.style.setProperty("font-size","0.75rem"),Y.style.setProperty("color","var(--text-muted)"),Y.style.setProperty("margin-top","0.25rem"),l(Y,()=>I(F.datereserve)),U.style.setProperty("margin-top","0.75rem"),U.style.setProperty("display","grid"),U.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),U.style.setProperty("gap","0.5rem"),U.style.setProperty("font-size","0.875rem"),ue.style.setProperty("color","var(--text-muted)"),l(ue,()=>e("hbl.city","City"),le),q.style.setProperty("font-weight","500"),l(q,()=>F.address.city),Se.style.setProperty("color","var(--text-muted)"),l(Se,()=>e("hbl.classification","Class"),me),Pe.style.setProperty("font-weight","500"),l(Pe,()=>F.idclasification),he.style.setProperty("color","var(--text-muted)"),l(he,()=>e("hbl.commodity","Commodity"),ve),De.style.setProperty("font-weight","500"),l(De,()=>F.namegood),Ce.style.setProperty("color","var(--text-muted)"),l(Ce,()=>e("hbl.weight","Weight"),Le),Ie.style.setProperty("font-weight","500"),l(Ie,()=>F.weight,Re),Me.style.setProperty("color","var(--text-muted)"),l(Me,()=>e("hbl.bagNumber","Bag#"),Ze),Ye.style.setProperty("font-weight","500"),l(Ye,()=>F.bagnumber),rt.style.setProperty("color","var(--text-muted)"),l(rt,()=>e("hbl.guideNo","Guide No."),We),ct.style.setProperty("font-weight","500"),l(ct,()=>F.guia),we(pt=>(pt=b(F.idguidestate))!=null?J.style.setProperty("background-color",pt):J.style.removeProperty("background-color")),W}})})),G})()};dr(["click"]);var ML=de("<div><div><h2>HBL: </h2><button></button></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong><span></span></div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> <!>, </div><div><strong>:</strong> </div><div><strong>:</strong> <!> kg</div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> "),FL=de("<div>"),OL=de("<div><div><h1></h1><button>");const BL=[{idreserve:"144245",idreservestate:"",idairnumber:"175-24013802 AVCENTR18",idairguide:"175-24013802",idclasification:"ENVIO",datereserve:"2025-07-15",hbl:"230144600",cidentity:"51030502941",street:"CALLE 21 # 5608 e/ AVE 56 y 58, CIENFUEGOS, CIENFUEGOS",ctelephone:"59448095",nameshipper:"LISET MANZANO",quantity:"1",weight:"10.09",idguidestate:"EN BODEGA",namegood:"MICELANEAS",bagnumber:"YAC17062",agency:"2",guia:"2518",consigneeName:"RUBEN RAYA REYES",phoneshipper:"8323783469",address:{estate:"CIENFUEGOS",city:"CIENFUEGOS",streetName:"21",streetNo:"5608",betwen:"AVE 56 Y 58"},referenceHId:"6sstbpt3tqg2lcw6_1752688667657"},{idreserve:"144246",idreservestate:"",idairnumber:"175-24013803 AVCENTR18",idairguide:"175-24013803",idclasification:"ENVIO",datereserve:"2025-07-16",hbl:"230144601",cidentity:"52040603852",street:"CALLE 45 # 2310 e/ 23 y 25, LA HABANA, LA HABANA",ctelephone:"53178234",nameshipper:"MARIA GONZALEZ",quantity:"2",weight:"15.50",idguidestate:"ENVIADO",namegood:"ROPA Y ZAPATOS",bagnumber:"YAC17063",agency:"2",guia:"2518",consigneeName:"JUAN PEREZ GARCIA",phoneshipper:"7863456789",address:{estate:"LA HABANA",city:"LA HABANA",streetName:"45",streetNo:"2310",betwen:"23 Y 25"},referenceHId:"6sstbpt3tqg2lcw7_1752688667658"},{idreserve:"144247",idreservestate:"",idairnumber:"175-24013804 AVCENTR18",idairguide:"175-24013804",idclasification:"PAQUETE",datereserve:"2025-07-14",hbl:"230144602",cidentity:"49120704963",street:"AVE 31 # 1802 e/ 18 y 20, MATANZAS, MATANZAS",ctelephone:"45267890",nameshipper:"CARLOS RODRIGUEZ",quantity:"3",weight:"25.00",idguidestate:"ENTREGADO",namegood:"ELECTRODOMESTICOS",bagnumber:"YAC17064",agency:"3",guia:"2519",consigneeName:"ANA MARTINEZ LOPEZ",phoneshipper:"3054567890",address:{estate:"MATANZAS",city:"MATANZAS",streetName:"31",streetNo:"1802",betwen:"18 Y 20"},referenceHId:"6sstbpt3tqg2lcw8_1752688667659"},{idreserve:"144248",idreservestate:"",idairnumber:"175-24013805 AVCENTR18",idairguide:"175-24013805",idclasification:"ENVIO",datereserve:"2025-07-17",hbl:"230144603",cidentity:"53050805074",street:"CALLE B # 567 e/ 5ta y 7ma, SANTIAGO DE CUBA, SANTIAGO DE CUBA",ctelephone:"22654321",nameshipper:"PEDRO SANCHEZ",quantity:"1",weight:"8.75",idguidestate:"EN BODEGA",namegood:"MEDICINA Y ALIMENTOS",bagnumber:"YAC17065",agency:"1",guia:"2519",consigneeName:"LUCIA FERNANDEZ DIAZ",phoneshipper:"9543210987",address:{estate:"SANTIAGO DE CUBA",city:"SANTIAGO DE CUBA",streetName:"B",streetNo:"567",betwen:"5TA Y 7MA"},referenceHId:"6sstbpt3tqg2lcw9_1752688667660"},{idreserve:"144249",idreservestate:"",idairnumber:"175-24013806 AVCENTR18",idairguide:"175-24013806",idclasification:"PAQUETE",datereserve:"2025-07-18",hbl:"230144604",cidentity:"48030906185",street:"CALLE 100 # 4512 e/ 45 y 47, CAMAGUEY, CAMAGUEY",ctelephone:"32123456",nameshipper:"ELENA RAMIREZ",quantity:"2",weight:"12.30",idguidestate:"PENDIENTE",namegood:"HERRAMIENTAS Y REPUESTOS",bagnumber:"YAC17066",agency:"2",guia:"2520",consigneeName:"ROBERTO JIMENEZ CASTRO",phoneshipper:"7542345678",address:{estate:"CAMAGUEY",city:"CAMAGUEY",streetName:"100",streetNo:"4512",betwen:"45 Y 47"},referenceHId:"6sstbpt3tqg2lcw10_1752688667661"}],jL=()=>{const{t}=er(),[e,r]=$e(BL),[n,i]=$e(null),[o,s]=$e([]),a=h=>{i(h)},c=h=>{s(h)},u=async()=>{let h=await Ai.getHBLS("230",{guia:2518});console.log(h);let y=` 
    230150072, 230150073
 
230147414, 230147415, 230147416,230145206, 230145255, 230146292, 230146293, 230146294, 230146295, 230146296, 230146297, 230145207, 230145388, 230146568, 230145831,230145369.
 
230147481, 230147482,230147483, 230144933, 230144934, 230145642, 230145401, 230144904, 230147442, 230147478, 230147479, 230147480, 230147484, 230145378, 230144624, 230144851, 230146777, 230146778, 230146779, 230145407, 230145408, 230145409, 230144863.
 
230145809, 230147055, 230147056, 230145623, 230145624, 230145625, 230145626, 230144958, 230146218, 230144650, 230144869, 230145443, 230144807, 230147487, 230145035, 230144930, 230144931, 230144932, 230146515, 230145000, 230145629, 230145630, 230145631, 230147469, 230147470, 230147471, 230144621, 230144620, 230144619, 230145654, 230144612, 230145382, 230145383, 230144605,230144649, 230144926, 230144927, 230144928, 230145656, 230145639, 230145640, 230145641, 230144860, 230144861, 230144905, 230145290, 230145291, 230145292, 230145293, 230145294, 230147464, 230147465, 230144604, 230145387, 230144822, 230145390, 230147488, 230145008, 230144816, 230144823, 230144811, 230144812, 230144813, 230144814, 230144815.
`,g=[];Object.values(h).map(p=>{console.log(p.hbl),y.indexOf(p.hbl)>=0&&g.push(p)}),r(g)};return Rn(()=>{u()}),(()=>{var h=OL(),y=h.firstChild,g=y.firstChild,p=g.nextSibling;return h.style.setProperty("padding","1rem"),y.style.setProperty("margin-bottom","2rem"),y.style.setProperty("display","flex"),y.style.setProperty("justify-content","space-between"),y.style.setProperty("align-items","center"),g.style.setProperty("font-size","1.5rem"),g.style.setProperty("font-weight","600"),g.style.setProperty("color","var(--text-primary)"),l(g,()=>t("hbl.title","House Bill of Lading Management")),p.style.setProperty("padding","0.75rem 1.5rem"),p.style.setProperty("background","var(--primary-color)"),p.style.setProperty("color","white"),p.style.setProperty("border","none"),p.style.setProperty("border-radius","var(--border-radius-sm)"),p.style.setProperty("cursor","pointer"),p.style.setProperty("font-weight","500"),l(p,()=>t("hbl.addNew","Add New HBL")),l(h,B(RL,{get hbls(){return e()},onFilterChange:c,onHBLSelect:a}),null),l(h,B(Ge,{get when(){return n()},get children(){var C=FL();return C.style.setProperty("position","fixed"),C.style.setProperty("top","0"),C.style.setProperty("left","0"),C.style.setProperty("right","0"),C.style.setProperty("bottom","0"),C.style.setProperty("background","rgba(0, 0, 0, 0.5)"),C.style.setProperty("display","flex"),C.style.setProperty("align-items","center"),C.style.setProperty("justify-content","center"),C.style.setProperty("z-index","1000"),l(C,B(Nt,{style:{width:"90%","max-width":"600px","max-height":"90vh","overflow-y":"auto"},get children(){var S=ML(),w=S.firstChild,x=w.firstChild;x.firstChild;var V=x.nextSibling,ne=w.nextSibling,X=ne.firstChild,Q=X.firstChild,ee=Q.firstChild;Q.nextSibling;var E=X.nextSibling,A=E.firstChild,T=A.firstChild;A.nextSibling;var R=E.nextSibling,_=R.firstChild,I=_.firstChild,b=_.nextSibling,G=R.nextSibling,ie=G.firstChild,F=ie.firstChild;ie.nextSibling;var W=G.nextSibling,z=W.firstChild,O=z.firstChild;z.nextSibling;var k=W.nextSibling,re=k.firstChild,$=re.firstChild;re.nextSibling;var D=k.nextSibling,H=D.firstChild,L=H.firstChild;H.nextSibling;var j=D.nextSibling,oe=j.firstChild,K=oe.firstChild;oe.nextSibling;var Z=j.nextSibling,J=Z.firstChild,Y=J.firstChild;J.nextSibling;var U=Z.nextSibling,ae=U.firstChild,ue=ae.firstChild;ae.nextSibling;var le=U.nextSibling,q=le.firstChild,ce=q.firstChild,Se=q.nextSibling,me=Se.nextSibling;me.nextSibling;var Pe=le.nextSibling,xe=Pe.firstChild,he=xe.firstChild;xe.nextSibling;var ve=Pe.nextSibling,De=ve.firstChild,ke=De.firstChild,Ce=De.nextSibling,Le=Ce.nextSibling;Le.nextSibling;var Ie=ve.nextSibling,Re=Ie.firstChild,He=Re.firstChild;Re.nextSibling;var Me=Ie.nextSibling,Ze=Me.firstChild,Ye=Ze.firstChild;Ze.nextSibling;var ut=Me.nextSibling,rt=ut.firstChild,We=rt.firstChild;rt.nextSibling;var ct=ut.nextSibling,pt=ct.firstChild,_t=pt.firstChild;pt.nextSibling;var Et=ct.nextSibling,et=Et.firstChild,Ue=et.firstChild;return et.nextSibling,S.style.setProperty("padding","2rem"),w.style.setProperty("display","flex"),w.style.setProperty("justify-content","space-between"),w.style.setProperty("align-items","center"),w.style.setProperty("margin-bottom","1.5rem"),x.style.setProperty("font-size","1.25rem"),x.style.setProperty("font-weight","600"),l(x,()=>n().hbl,null),V.$$click=()=>i(null),V.style.setProperty("background","none"),V.style.setProperty("border","none"),V.style.setProperty("font-size","1.5rem"),V.style.setProperty("cursor","pointer"),V.style.setProperty("color","var(--text-muted)"),ne.style.setProperty("display","grid"),ne.style.setProperty("gap","1rem"),l(Q,()=>t("hbl.airGuide","Air Guide"),ee),l(X,()=>n().idairguide,null),l(A,()=>t("hbl.airNumber","Air Number"),T),l(E,()=>n().idairnumber,null),l(_,()=>t("hbl.status","Status"),I),b.style.setProperty("margin-left","0.5rem"),b.style.setProperty("padding","0.25rem 0.75rem"),b.style.setProperty("border-radius","var(--border-radius-sm)"),b.style.setProperty("font-size","0.875rem"),b.style.setProperty("color","white"),l(b,()=>n().idguidestate),l(ie,()=>t("hbl.classification","Classification"),F),l(G,()=>n().idclasification,null),l(z,()=>t("hbl.shipper","Shipper"),O),l(W,()=>n().nameshipper,null),l(re,()=>t("hbl.shipperPhone","Shipper Phone"),$),l(k,()=>n().phoneshipper,null),l(H,()=>t("hbl.consignee","Consignee"),L),l(D,()=>n().consigneeName,null),l(oe,()=>t("hbl.consigneePhone","Consignee Phone"),K),l(j,()=>n().ctelephone,null),l(J,()=>t("hbl.identity","Identity"),Y),l(Z,()=>n().cidentity,null),l(ae,()=>t("hbl.address","Address"),ue),l(U,()=>n().street,null),l(q,()=>t("hbl.city","City"),ce),l(le,()=>n().address.city,me),l(le,()=>n().address.estate,null),l(xe,()=>t("hbl.commodity","Commodity"),he),l(Pe,()=>n().namegood,null),l(De,()=>t("hbl.weight","Weight"),ke),l(ve,()=>n().weight,Le),l(Re,()=>t("hbl.quantity","Quantity"),He),l(Ie,()=>n().quantity,null),l(Ze,()=>t("hbl.bagNumber","Bag Number"),Ye),l(Me,()=>n().bagnumber,null),l(rt,()=>t("hbl.agency","Agency"),We),l(ut,()=>n().agency,null),l(pt,()=>t("hbl.guide","Guide"),_t),l(ct,()=>n().guia,null),l(et,()=>t("hbl.reserveDate","Reserve Date"),Ue),l(Et,()=>new Date(n().datereserve).toLocaleDateString(),null),we(ot=>(ot=n().idguidestate==="ENTREGADO"?"#28a745":n().idguidestate==="ENVIADO"?"#17a2b8":n().idguidestate==="EN BODEGA"?"#007bff":"#6c757d")!=null?b.style.setProperty("background-color",ot):b.style.removeProperty("background-color")),S}})),C}}),null),h})()};dr(["click"]);var VL=de("<div>$124,350"),qL=de("<div>+12% from last month"),zL=de("<div>247"),ec=de("<div>"),UL=de("<div>18"),HL=de("<div>$89,250"),WL=de("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>");const GL=()=>{const{t}=er(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},n={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)",margin:"0.5rem 0"},i={"font-size":"0.875rem",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"};return B(ro,{get title(){return t("dashboard.title")},get children(){return[(()=>{var o=ec();return m(o,e),l(o,B(Nt,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var s=VL();return we(a=>m(s,n,a)),s})(),(()=>{var s=qL();return we(a=>m(s,i,a)),s})()]}}),null),l(o,B(Nt,{get title(){return t("dashboard.employeeCount")},get subtitle(){return t("dashboard.current")},get children(){return[(()=>{var s=zL();return we(a=>m(s,n,a)),s})(),(()=>{var s=ec();return l(s,()=>t("dashboard.newHires")),we(a=>m(s,i,a)),s})()]}}),null),l(o,B(Nt,{get title(){return t("dashboard.pendingInvoices")},get subtitle(){return t("dashboard.outstanding")},get children(){return[(()=>{var s=UL();return we(a=>m(s,n,a)),s})(),(()=>{var s=ec();return l(s,()=>t("dashboard.totalOutstanding")),we(a=>m(s,i,a)),s})()]}}),null),l(o,B(Nt,{get title(){return t("dashboard.cashBalance")},get subtitle(){return t("accounts.title")},get children(){return[(()=>{var s=HL();return we(a=>m(s,n,a)),s})(),(()=>{var s=ec();return l(s,()=>t("dashboard.lastUpdatedToday")),we(a=>m(s,i,a)),s})()]}}),null),o})(),(()=>{var o=ec();return m(o,r),l(o,B(Nt,{get title(){return t("dashboard.quickActions")},get subtitle(){return t("dashboard.commonTasks")},get children(){var s=ec();return s.style.setProperty("display","flex"),s.style.setProperty("flex-direction","column"),s.style.setProperty("gap","1rem"),l(s,B(xt,{variant:"primary",get children(){return t("invoices.createNew")}}),null),l(s,B(xt,{variant:"secondary",get children(){return t("employees.addEmployee")}}),null),l(s,B(xt,{variant:"outline",get children(){return t("dashboard.generateReport")}}),null),s}}),null),l(o,B(Nt,{get title(){return t("dashboard.recentActivity")},get subtitle(){return t("dashboard.latestUpdates")},get children(){var s=WL(),a=s.firstChild,c=a.firstChild,u=c.nextSibling,h=a.nextSibling,y=h.firstChild,g=y.nextSibling,p=h.nextSibling,C=p.firstChild,S=C.nextSibling;return s.style.setProperty("display","flex"),s.style.setProperty("flex-direction","column"),s.style.setProperty("gap","0.75rem"),a.style.setProperty("border-bottom","1px solid var(--border-color)"),a.style.setProperty("padding-bottom","0.5rem"),c.style.setProperty("font-weight","500"),l(c,()=>t("dashboard.invoicePaid")),u.style.setProperty("font-size","0.875rem"),u.style.setProperty("color","var(--text-muted)"),l(u,()=>t("dashboard.hoursAgo")),h.style.setProperty("border-bottom","1px solid var(--border-color)"),h.style.setProperty("padding-bottom","0.5rem"),y.style.setProperty("font-weight","500"),l(y,()=>t("dashboard.newEmployeeOnboarded")),g.style.setProperty("font-size","0.875rem"),g.style.setProperty("color","var(--text-muted)"),l(g,()=>t("dashboard.dayAgo")),C.style.setProperty("font-weight","500"),l(C,()=>t("dashboard.monthlyReportGenerated")),S.style.setProperty("font-size","0.875rem"),S.style.setProperty("color","var(--text-muted)"),l(S,()=>t("dashboard.daysAgo")),s}}),null),o})(),B(Ge,{get when(){return Ar.hasPermission("invoiceAccess")},get children(){return B(hN,{})}})]}})};var o1=de("<div>"),YL=de("<div><div><div><strong>Display Name:</strong> </div><div><strong>UID:</strong> </div></div><div><strong>Created:</strong> "),KL=de("<div><h3>Store Access</h3><div></div><div>No store access granted"),JL=de("<div><h3>Permissions</h3><div>"),QL=de('<div><div><input type=text placeholder="Search users..."></div><div>'),XL=de("<div> You need administrator privileges to access this page."),ZL=de("<div>Loading users..."),e8=de("<div><div></div><div></div><div> stores"),t8=de("<div>Select a user to view and edit their profile"),r8=de("<div><input type=checkbox><label>"),n8=de("<div><input type=checkbox><div><div></div><div>");const i8=()=>{const[t,e]=$e([]),[r,n]=$e(null),[i,o]=$e(!1),[s,a]=$e(!1),[c,u]=$e(""),[h,y]=$e(null),g=[{id:"YY_8802",name:"Store 8802"},{id:"YY_8803",name:"Store 8803"},{id:"YY_8804",name:"Store 8804"},{id:"YY_8805",name:"Store 8805"},{id:"YY_8816",name:"Store 8816"},{id:"YY_8818",name:"Store 8818"},{id:"YY_8847",name:"Store 8847"},{id:"YY_3251",name:"Store 3251"},{id:"YY_32",name:"Store 32"},{id:"YY_76",name:"Store 76"},{id:"YY_79",name:"Store 79"},{id:"YY_8635",name:"Store 8635"},{id:"YY_8665",name:"Store 8665"},{id:"YY_8901",name:"Store 8901"}],p=[{key:"AccountAccess",label:"Account Access",description:"Access to accounting features"},{key:"BankingAccess",label:"Banking Access",description:"Access to banking operations"},{key:"InventoryAccess",label:"Inventory Access",description:"Access to inventory management"},{key:"JournalAccess",label:"Journal Access",description:"Access to journal entries"},{key:"invoiceAccess",label:"invoice Access",description:"Access to Invoices"},{key:"inventoryDownsection",label:"Inventory Downsection",description:"Access to inventory downsection"},{key:"onlyRead",label:"Read Only",description:"Limited to read-only access"},{key:"read_write",label:"Read/Write",description:"Full read and write permissions"},{key:"isAdmin",label:"Administrator",description:"Full system administration rights"}];let C={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,invoiceAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1};Rn(async()=>{await S()});const S=async()=>{try{o(!0);const b=J3(cm,"users"),G=cI(b,uI("createdAt","desc")),ie=await mI(G),F=[];ie.forEach(W=>{let z=W.data();Object.keys(C).map(O=>{let k=C?.[O];z.hasOwnProperty(O)||(z[O]=k)}),F.push({uid:W.id,...z})}),e(F)}catch(b){console.error("Error loading users:",b),y({type:"error",text:"Failed to load users"})}finally{o(!1)}},w=Tt(()=>{const b=c().toLowerCase();return b?t().filter(G=>G.email?.toLowerCase().includes(b)||G.displayName?.toLowerCase().includes(b)||G.uid?.toLowerCase().includes(b)):t()}),x=b=>{r()&&n(G=>({...G,stores:{...G.stores,[b]:!G.stores[b]}}))},V=b=>{r()&&n(G=>({...G,[b]:!G[b]}))};Tt(()=>r()?r().stores&&Object.values(r().stores).some(b=>b):!1);const ne=async()=>{if(r())try{a(!0),y(null);const b=s5(cm,"users",r().uid);let G={stores:r().stores,AccountAccess:r().AccountAccess,BankingAccess:r().BankingAccess,InventoryAccess:r().InventoryAccess,invoiceAccess:r().invoiceAccess,JournalAccess:r().JournalAccess,inventoryDownsection:r().inventoryDownsection,onlyRead:r().onlyRead,read_write:r().read_write,isAdmin:r().isAdmin||!1};await y5(b,G),e(ie=>ie.map(F=>F.uid===r().uid?r():F)),y({type:"success",text:"User profile updated successfully"})}catch(b){console.error("Error saving user profile:",b),y({type:"error",text:"Failed to save user profile"})}finally{a(!1)}},X={display:"grid","grid-template-columns":"350px 1fr",gap:"2rem",height:"calc(100vh - 200px)"},Q={"max-height":"100%","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)",background:"var(--surface-color)"},ee=b=>({padding:"1rem","border-bottom":"1px solid var(--border-color)",cursor:"pointer",background:b?"var(--primary-color-light)":"transparent",transition:"background 0.2s"}),E={padding:"0.75rem",border:"none","border-bottom":"1px solid var(--border-color)",background:"var(--surface-color)",width:"100%","font-size":"1rem"},A={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1rem"},T={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(200px, 1fr))",gap:"0.75rem"},R={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",transition:"all 0.2s"},_=b=>({padding:"1rem","margin-bottom":"1rem","border-radius":"var(--border-radius)",background:b==="success"?"#d4edda":"#f8d7da",color:b==="success"?"#155724":"#721c24",border:`1px solid ${b==="success"?"#c3e6cb":"#f5c6cb"}`}),I=Tt(()=>Ar.state.profile?.isAdmin===!0);return B(ro,{title:"User Profile Administration",get children(){return B(Ge,{get when(){return I()},get fallback(){return B(Nt,{get children(){var b=XL();return b.style.setProperty("text-align","center"),b.style.setProperty("padding","2rem"),b.style.setProperty("color","var(--text-muted)"),b}})},get children(){var b=QL(),G=b.firstChild,ie=G.firstChild,F=G.nextSibling;return m(b,X),m(G,Q),ie.$$input=W=>u(W.currentTarget.value),m(ie,E),l(G,B(Ge,{get when(){return!i()},get fallback(){return(()=>{var W=ZL();return W.style.setProperty("padding","2rem"),W.style.setProperty("text-align","center"),W})()},get children(){return B(Ut,{get each(){return w()},children:W=>(()=>{var z=e8(),O=z.firstChild,k=O.nextSibling,re=k.nextSibling,$=re.firstChild;return z.$$click=()=>n(W),O.style.setProperty("font-weight","600"),l(O,()=>W.displayName||"No Name"),k.style.setProperty("font-size","0.875rem"),k.style.setProperty("color","var(--text-muted)"),l(k,()=>W.email),re.style.setProperty("font-size","0.75rem"),re.style.setProperty("color","var(--text-muted)"),re.style.setProperty("margin-top","0.25rem"),l(re,()=>W.isAdmin&&" Admin  ",$),l(re,()=>Object.values(W.stores||{}).filter(Boolean).length,$),we(D=>m(z,ee(r()?.uid===W.uid),D)),z})()})}}),null),l(F,B(Ge,{get when(){return r()},get fallback(){return B(Nt,{get children(){var W=t8();return W.style.setProperty("text-align","center"),W.style.setProperty("padding","2rem"),W.style.setProperty("color","var(--text-muted)"),W}})},get children(){return[B(Ge,{get when(){return h()},get children(){var W=o1();return l(W,()=>h().text),we(z=>m(W,_(h().type),z)),W}}),B(Nt,{title:"User Information",get subtitle(){return r().email},get children(){return[(()=>{var W=YL(),z=W.firstChild,O=z.firstChild,k=O.firstChild;k.nextSibling;var re=O.nextSibling,$=re.firstChild;$.nextSibling;var D=z.nextSibling,H=D.firstChild;return H.nextSibling,W.style.setProperty("margin-bottom","2rem"),z.style.setProperty("display","flex"),z.style.setProperty("justify-content","space-between"),z.style.setProperty("margin-bottom","1rem"),l(O,()=>r().displayName||"Not set",null),l(re,()=>r().uid,null),l(D,()=>new Date(r().createdAt?.toDate?.()||r().createdAt).toLocaleDateString(),null),W})(),(()=>{var W=KL(),z=W.firstChild,O=z.nextSibling,k=O.nextSibling;return W.style.setProperty("margin-bottom","2rem"),z.style.setProperty("margin-bottom","1rem"),m(O,T),l(O,B(Ut,{each:g,children:re=>{let $=lt.getLocationById(re?.id);return(()=>{var D=r8(),H=D.firstChild,L=H.nextSibling;return D.$$click=()=>x(re?.id),H.style.setProperty("cursor","pointer"),L.style.setProperty("cursor","pointer"),L.style.setProperty("user-select","none"),l(L,()=>$?.name),we(j=>m(D,{...R,background:r().stores?.[re?.id]?"var(--primary-color-light)":"transparent"},j)),we(()=>H.checked=r().stores?.[re?.id]||!1),D})()}})),k.style.setProperty("margin-top","0.5rem"),k.style.setProperty("font-size","0.875rem"),k.style.setProperty("color","var(--text-muted)"),W})(),(()=>{var W=JL(),z=W.firstChild,O=z.nextSibling;return W.style.setProperty("margin-bottom","2rem"),z.style.setProperty("margin-bottom","1rem"),m(O,A),l(O,B(Ut,{each:p,children:k=>(()=>{var re=n8(),$=re.firstChild,D=$.nextSibling,H=D.firstChild,L=H.nextSibling;return re.$$click=()=>V(k.key),$.style.setProperty("cursor","pointer"),D.style.setProperty("flex","1"),D.style.setProperty("cursor","pointer"),D.style.setProperty("user-select","none"),H.style.setProperty("font-weight","500"),l(H,()=>k.label),L.style.setProperty("font-size","0.75rem"),L.style.setProperty("color","var(--text-muted)"),l(L,()=>k.description),we(j=>m(re,{...R,background:r()[k.key]?"var(--primary-color-light)":"transparent"},j)),we(()=>$.checked=!!r()[k.key]),re})()})),W})(),(()=>{var W=o1();return W.style.setProperty("display","flex"),W.style.setProperty("gap","1rem"),W.style.setProperty("justify-content","flex-end"),l(W,B(xt,{variant:"secondary",onClick:()=>n(null),children:"Cancel"}),null),l(W,B(xt,{variant:"primary",onClick:ne,get disabled(){return s()},get children(){return s()?"Saving...":"Save Changes"}}),null),W})()]}})]}})),we(()=>ie.value=c()),b}})}})};dr(["input","click"]);const o8=async()=>{try{console.log("Testing PDF generation...");const e=(await Ni(()=>Promise.resolve().then(()=>H5),void 0)).default;console.log("jsPDF imported successfully");const r=new e;console.log("PDF document created"),r.setFontSize(20),r.text("Test PDF",20,20),r.setFontSize(12),r.text("This is a test PDF to verify the library works.",20,40),console.log("Text added to PDF"),r.save("test.pdf"),console.log("PDF saved successfully"),alert("Test PDF generated successfully!")}catch(t){console.error("Test PDF generation failed:",t),alert(`Test PDF failed: ${t.message}`)}},s1=(t,e)=>{try{console.log("Generating printable PDF..."),console.log(t);const r=window.open("","_blank","width=800,height=600");if(!r){alert("Please allow popups to generate PDF");return}const n=t.shipper_consignee||{};let i=lt.getLocationById(t?.store);const o=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Invoice ${t.invoice||"N/A"}</title>
        <style>
          body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
          }
          .header {
            display: flex;
            justify-content: space-between;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
            margin-bottom: 20px;
          }
          .company {
            font-size: 24px;
            font-weight: bold;
            color: #2563eb;
          }
          .invoice-info {
            text-align: right;
          }
          .section {
            margin: 20px 0;
          }
          .section-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
          }
          .customer-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
             font-size: 13px;
          }
          .flex{
            display: flex;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
          }
          th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
          }
          th {
            background-color: #f2f2f2;
            font-weight: bold;
            font-size: 13px;
          }
          td{
           font-size: 12px;
          }
          .total-row {
            font-weight: bold;
            font-size: 16px;
            background-color: #e8f4fd;
          }
          .certification-section {
            page-break-inside: avoid;
            break-inside: avoid;
            orphans: 3;
            widows: 3;
          }
          .page-break-before {
            page-break-before: always;
            break-before: page;
          }
          @media print {
            body { margin: 0; }
            .no-print { display: none; }
            .certification-section {
              page-break-inside: avoid !important;
              break-inside: avoid !important;
              orphans: 3;
              widows: 3;
            }
            .page-break-before {
              page-break-before: always !important;
              break-before: page !important;
            }
            /* Force page break if certification section would be split */
            @page {
              margin: 0.5in;
              orphans: 3;
              widows: 3;
            }
          }
        </style>
      </head>
      <body>
        <div class="header">
          <div>
            <div class="company">HRM FINANCE</div>
            <div>${e("common.store")}: ${i?.name||t?.store||"N/A"}</div>
            <div>${e("common.orderId")}: ${t.ssg_sorder_key||"N/A"}</div>
            ${t.shippingMethod?`<div>${e("common.shipping")}: ${t.shippingMethod==="aereo"?e("common.air"):e("common.sea")}</div>`:""}
          </div>
          <div class="invoice-info">
            <div style="font-size: 18px; font-weight: bold;">${e("common.invoice").toUpperCase()}</div>
            <div style="font-size: 16px; margin: 5px 0;">${t.invoice||"N/A"}</div>
            <div>${t.createDate?new Date(t.createDate).toLocaleDateString():"N/A"}</div>
            <div style="margin-top: 10px;">
              <span style="padding: 4px 8px; background: ${t.isCompleted?"#d4edda":"#fff3cd"}; border-radius: 10px; font-size: 12px;">
                ${t.isCompleted?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase()}
              </span>
            </div>
          </div>
        </div>

        <div class="section">
          <div class="section-title">${e("invoices.customerInformation")}</div>
          <div class="customer-info">
            <div><strong>${e("invoices.senderInformation")}:</strong> ${n.name||"N/A"}</div>
            <div><strong>${e("invoices.receiptInformation")}:</strong> ${[n.firstName,n.middleName,n.lastName,n.lastName2].filter(Boolean).join(" ")||"N/A"}</div>
            <div><strong>${e("invoices.phoneNumber")}:</strong> ${n.phoneNumber||"N/A"}</div>
            <div><strong>${e("invoices.id")}:</strong> ${n.cid||"N/A"}</div>
            ${n.passport?`<div><strong>${e("invoices.passport")}:</strong> ${n.passport}</div>`:""}
            ${n.address?`<div><strong>${e("invoices.address")}:</strong> ${n.address}</div>`:""}
          </div>
        </div>

        ${t.products&&t.products.length>0?`
        <div class="section">
          <div class="section-title">${e("invoices.products")}</div>
          <table>
            <thead>
              <tr>
                <th>${e("invoices.code")}</th>
                <th>${e("invoices.description")}</th>
                <th>${e("invoices.qty")}</th>
                <th>${e("invoices.unitPrice")}</th>
                <th>${e("invoices.total")}</th>
              </tr>
            </thead>
            <tbody>
              ${t.products.map(s=>`
                <tr>
                  <td>${s.product?.code||"N/A"}</td>
                  <td>${s.product?.label||"N/A"}</td>
                  <td>${Math.abs(s.qty||0)}</td>
                  <td>$${parseFloat(s.salePrice||0).toFixed(2)}</td>
                  <td>$${(s.total||Math.abs(s.qty||0)*parseFloat(s.salePrice||0)).toFixed(2)}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
        </div>
        `:""}

        ${t.reservas&&t.reservas.length>0?`
        <div class="section">
          <div class="section-title">${e("invoices.reservations")}</div>
          <table>
            <thead>
              <tr>
                <th>${e("invoices.type")}</th>
                <th>${e("invoices.qty")}</th>
                <th>${e("invoices.unitPrice")}</th>
                <th>${e("invoices.arancel")}</th>
                <th>${e("invoices.total")}</th>
              </tr>
            </thead>
            <tbody>
              ${t.reservas.map(s=>{const a=parseFloat(s.qty||0),c=parseFloat(s.price||0),u=parseFloat(s.arancel||0),h=s.total||a*c+u;return`
                  <tr>
                    <td>${s.type||"N/A"}</td>
                    <td>${a.toFixed(2)}</td>
                    <td>$${c.toFixed(2)}</td>
                    <td>$${u.toFixed(2)}</td>
                    <td>$${h.toFixed(2)}</td>
                  </tr>
                `}).join("")}
            </tbody>
          </table>
        </div>
        `:""}

        <div class="section flex">
          ${t.paymentMethods?`
        <div class="section" style="margin-right: auto; width: 48%">
          <div class="section-title">${e("common.paymentMethods")}</div>
          <div class="customer-info">
            ${t.paymentMethods.cash>0?`<div><strong> ${e("common.cash")}:</strong> $${t.paymentMethods.cash.toFixed(2)}</div>`:""}
            ${t.paymentMethods.zelle>0?`<div><strong> Zelle:</strong> $${t.paymentMethods.zelle.toFixed(2)}</div>`:""}
            ${t.paymentMethods.creditCard>0?`<div><strong> ${e("common.creditCard")}:</strong> $${t.paymentMethods.creditCard.toFixed(2)}</div>`:""}
            ${t.paymentMethods.exemptTaxOnCash&&t.paymentMethods.cash>0&&t.taxSavings>0?`
              <div style="margin-top: 10px; padding: 8px; background-color: #e7f5ff; border-radius: 4px; font-size: 12px; font-style: italic;">
                * ${e("common.taxExemptNote")} ${e("common.youSaved")} $${t.taxSavings.toFixed(2)}!
              </div>
            `:""}
          </div>
        </div>
        `:""}
        <div class="section ">
          <table style="margin-left: auto; width: width: 48%">
            ${t.productSubtotal?`
            <tr>
              <td><strong>${e("invoices.productsSubtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${t.productSubtotal.toFixed(2)}</strong></td>
            </tr>
            `:""}
            ${t.reservaSubtotal?`
            <tr>
              <td><strong>${e("invoices.reservationsSubtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${t.reservaSubtotal.toFixed(2)}</strong></td>
            </tr>
            `:""}
            ${t.taxAmount&&t.taxAmount>0?`
            <tr>
              <td><strong>${e("common.subtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${(t.subtotalBeforeTax||0).toFixed(2)}</strong></td>
            </tr>
            <tr>
              <td><strong>${e("common.tax")} (${t.paymentMethods?.taxPercent||7}%):</strong></td>
              <td style="text-align: right;"><strong>$${t.taxAmount.toFixed(2)}</strong></td>
            </tr>
            `:""}
            <tr class="total-row">
              <td><strong>${e("invoices.total").toUpperCase()}:</strong></td>
              <td style="text-align: right;"><strong>$${(t.total||0).toFixed(2)}</strong></td>
            </tr>
          </table>
        </div>
        </div>
        
       

        <!-- Certification Section -->
        <div class="certification-section" style="margin-top: 40px; padding: 20px; border: 2px solid #333; background: #f9f9f9;">
          <div style="text-align: center; font-weight: bold; font-size: 14px; margin-bottom: 15px; text-transform: uppercase;">
            CERTIFICACIN DEL EMBARCADOR
          </div>
          <div style="font-size: 11px; line-height: 1.4; text-align: justify; margin-bottom: 20px;">
            <p><strong>Certifico que no envo sustancias ni productos prohibidos por las leyes y las aduanas de USA y Cuba, como por ejemplo:</strong> drogas, armas, explosivos, cigarrillos electrnicos, drones profesionales, joyas, prendas, dinero en efectivo, semillas, narcticos, frmacos controlados, productos agrcolas de tipo herbicidas o antifngicidas, ningn tipo de producto perecedero que necesite refrigeracin.</p>
            
            <p><strong>Entiendo que al llenar este formulario, al enviar alguna de las sustancias o productos antes descritos mi carga puede ser decamisada completa o parcialmente por las aduanas de Cuba o USA sin derecho a reclamo ni compensacin,</strong> de parte ma como embarcador, ni de la persona a quien envo (consignatario).</p>
            
           </div>
          
          <!-- Signature Section -->
          <div style="display: flex; justify-content: space-between; margin-top: 30px;">
            <div style="width: 45%; text-align: center;">
              <div style="border-bottom: 2px solid #333; margin-bottom: 10px; height: 40px;"></div>
              <div style="font-size: 10px; font-weight: bold;">FIRMA DEL EMBARCADOR / SHIPPER SIGNATURE</div>
              <div style="font-size: 10px; margin-top: 5px;">${n.name||"N/A"}</div>
            </div>
            <div style="width: 45%; text-align: center;">
              <div style="border-bottom: 2px solid #333; margin-bottom: 10px; height: 40px;"></div>
              <div style="font-size: 10px; font-weight: bold;">FECHA / DATE</div>
              <div style="font-size: 10px; margin-top: 5px;">${new Date().toLocaleDateString()}</div>
            </div>
          </div>
        </div>

        <div style="margin-top: 40px; text-align: center; color: #666; font-size: 12px;">
          <p>${e("common.thankForChoosingUs")}</p>
          <p>${e("common.generatedOn")} ${new Date().toLocaleDateString()}</p>
        </div>

        <script>
          // Check if certification section needs page break
          function checkCertificationPageBreak() {
            const certSection = document.querySelector('.certification-section');
            if (!certSection) return;
            
            // Reset any previous page break class to get accurate measurements
            certSection.classList.remove('page-break-before');
            
            // Force a layout recalculation
            certSection.offsetHeight;
            
            const rect = certSection.getBoundingClientRect();
            const certHeight = rect.height;
            const certTop = rect.top;
            
            // Estimate print page height (assuming standard letter size at 96 DPI)
            // Standard letter: 11 inches - 1 inch margins = 10 inches usable
            // At 96 DPI: 10 * 96 = 960px usable height per page
            const printPageHeight = 960;
            const pageMargin = 48; // 0.5 inch margins
            
            // Calculate current position on the page
            const currentPagePosition = certTop % printPageHeight;
            const remainingPageSpace = printPageHeight - currentPagePosition - pageMargin;
            
            // Add some buffer space (50px) to ensure comfortable fit
            const requiredSpace = certHeight + 50;
            
            console.log('Certification section analysis:', {
              certHeight,
              certTop,
              currentPagePosition,
              remainingPageSpace,
              requiredSpace,
              needsPageBreak: requiredSpace > remainingPageSpace
            });
            
            // Only add page break if certification truly won't fit
            if (requiredSpace > remainingPageSpace && remainingPageSpace < printPageHeight * 0.4) {
              console.log('Adding page break for certification section');
              certSection.classList.add('page-break-before');
            }
          }
          
          // Run check when page loads and before printing
          document.addEventListener('DOMContentLoaded', function() {
            // Delay to ensure all content is rendered
            setTimeout(checkCertificationPageBreak, 100);
          });
          window.addEventListener('beforeprint', checkCertificationPageBreak);
        <\/script>

        <div class="no-print" style="margin-top: 30px; text-align: center;">
          <button onclick="window.print()" style="padding: 10px 20px; font-size: 16px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">
            ${e("common.printSavePDF")}
          </button>
          <button onclick="window.close()" style="padding: 10px 20px; font-size: 16px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer; margin-left: 10px;">
            ${e("common.close")}
          </button>
        </div>
      </body>
      </html>
    `;r.document.write(o),r.document.close(),r.focus(),console.log("Printable PDF window opened")}catch(r){console.error("Error generating printable PDF:",r),alert("Error generating printable PDF: "+r.message)}},s8=async(t,e)=>{try{console.log("Starting professional PDF generation...");const n=(await Ni(()=>Promise.resolve().then(()=>H5),void 0)).default,i=new n,o=210,s=297,a=15,c=o-a*2,u={r:180,g:180,b:180},h={r:80,g:80,b:80},y={r:130,g:130,b:130},g={r:248,g:248,b:248},p={r:252,g:252,b:252},C={r:120,g:120,b:120},S={r:150,g:150,b:150};let w=a;const x=U=>{i.setTextColor(U.r,U.g,U.b)},V=U=>{i.setFillColor(U.r,U.g,U.b)},ne=(U,ae,ue,le,q,ce=!1)=>{i.roundedRect(U,ae,ue,le,q,q,ce?"F":"S")};V(p),i.rect(0,0,o,50,"F"),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.5),i.line(0,50,o,50),x(h),i.setFontSize(32),i.setFont("helvetica","bold"),i.text("HRM",a,25),x(y),i.setFontSize(32),i.setFont("helvetica","normal");const X=i.getTextWidth("HRM ");i.text("FINANCE",a+X,25),x(y),i.setFontSize(9),i.setFont("helvetica","normal"),i.text("Professional Business Solutions",a,35);const Q=70,ee=o-a-Q;i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.5),ne(ee,12,Q,26,2,!1),x(h),i.setFontSize(14),i.setFont("helvetica","bold");const E=e("common.invoice").toUpperCase(),A=i.getTextWidth(E);i.text(E,ee+(Q-A)/2,22),i.setFontSize(11),i.setFont("helvetica","normal");const T=t.invoice||"N/A",R=i.getTextWidth(T);i.text(T,ee+(Q-R)/2,32),w=60,V(p),i.rect(0,50,o,20,"F");const _=t.isCompleted,I=_?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase();x(_?h:y),i.setFontSize(8),i.setFont("helvetica","bold"),i.text(`STATUS: ${I}`,a,58),x(y),i.setFontSize(9),i.setFont("helvetica","normal");const G=t.createDate?new Date(t.createDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A";i.text(G,o-a-i.getTextWidth(G),58),w=58,i.text(`${e("common.store")}: ${t.store||"N/A"}`,a+60,w),w+=5,i.text(`${e("common.orderId")}: ${t.ssg_sorder_key||"N/A"}`,a+60,w),t.shippingMethod&&i.text(`${e("common.shipping")}: ${t.shippingMethod==="aereo"?e("common.air"):e("common.sea")}`,o-a-50,w),w=80,x(h),i.setFontSize(14),i.setFont("helvetica","bold"),i.text(e("invoices.customerInformation"),a,w),w+=10;const ie=45,F=10,W=(c-F)/2;V(p),ne(a,w,W,ie,3,!0),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),ne(a,w,W,ie,3);const z=t.shipper_consignee||{};let O=w+8;x(y),i.setFontSize(9),i.text(e("invoices.senderInformation"),a+5,O),O+=7,x(h),i.setFontSize(11),i.setFont("helvetica","bold"),i.text(z.name||"N/A",a+5,O),z.phoneNumberS&&(O+=6,i.setFont("helvetica","normal"),i.setFontSize(9),x(y),i.text(`${e("invoices.altPhone")}: ${z.phoneNumberS}`,a+5,O)),V(p),ne(a+W+F,w,W,ie,3,!0),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),ne(a+W+F,w,W,ie,3),O=w+8,x(y),i.setFontSize(9),i.text(e("invoices.receiptInformation"),a+W+F+5,O),O+=7;const k=[z.firstName,z.middleName,z.lastName,z.lastName2].filter(Boolean).join(" ")||"N/A";if(x(h),i.setFontSize(11),i.setFont("helvetica","bold"),i.text(k,a+W+F+5,O),O+=6,i.setFont("helvetica","normal"),i.setFontSize(9),x(y),i.text(`${e("invoices.phoneNumber")}: ${z.phoneNumber||"N/A"}`,a+W+F+5,O),console.log(z),O+=5,i.text(`${e("invoices.id")}: ${z.cid||"N/A"}`,a+W+F+5,O),z.address)O+=5,z.address.split(",").map(ae=>ae.trim()).forEach((ae,ue)=>{ue<2&&ae&&(i.text(ae,a+W+F+5,O),O+=5)});else{let U=`${z.ybstreet||""} #${z.ybstreetNo||""} ${e("invoices.between")} ${z.ybbetwen1||""} ${e("invoices.and")} ${z.ybbetwen2||""}`,ae=`${z.ybreparto||""}, ${z.ybcity||""}, ${z.ybestate||""}`;O+=5,i.text(U,a+W+F+5,O),O+=5,i.text(ae,a+W+F+5,O)}if(w+=ie+15,t?.products&&t?.products?.length>0){x(h),i.setFontSize(14),i.setFont("helvetica","bold"),i.text(e("invoices.products"),a,w),w+=10,V(g),i.rect(a,w-6,c,10,"F"),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),i.line(a,w+4,o-a,w+4),i.setFontSize(9),i.setFont("helvetica","bold"),x(h);const U={code:a+5,description:a+35,qty:a+115,price:a+135,total:a+160};i.text(e("invoices.code"),U.code,w),i.text(e("invoices.description"),U.description,w),i.text(e("invoices.qty"),U.qty,w),i.text(e("invoices.unitPrice"),U.price,w),i.text(e("invoices.total"),U.total,w),w+=10,i.setFont("helvetica","normal"),i.setFontSize(9),t.products.forEach((ae,ue)=>{w>250&&(i.addPage(),w=a),ue%2===0&&(V(p),i.rect(a,w-4,c,8,"F")),x(h),i.text(ae.product?.code||"N/A",U.code,w);let le=ae.product?.label||"N/A";i.getTextWidth(le)>70&&(le=le.substring(0,40)+"..."),i.text(le,U.description,w);const q=Math.abs(ae.qty||0),ce=parseFloat(ae.salePrice||0),Se=ae.total||q*ce;i.text(q.toString(),U.qty,w),i.text(`$${ce.toFixed(2)}`,U.price,w),i.setFont("helvetica","bold"),i.text(`$${Se.toFixed(2)}`,U.total,w),i.setFont("helvetica","normal"),w+=8}),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),i.line(a,w,o-a,w),w+=15}if(t.reservas&&t.reservas.length>0){w>200&&(i.addPage(),w=a),x(h),i.setFontSize(14),i.setFont("helvetica","bold"),i.text(e("invoices.reservations"),a,w),w+=10,V(g),i.rect(a,w-6,c,10,"F"),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),i.line(a,w+4,o-a,w+4),i.setFontSize(9),i.setFont("helvetica","bold"),x(h);const U={type:a+5,qty:a+65,price:a+95,arancel:a+125,total:a+160};i.text(e("invoices.type"),U.type,w),i.text(e("invoices.qty"),U.qty,w),i.text(e("invoices.unitPrice"),U.price,w),i.text(e("invoices.arancel"),U.arancel,w),i.text(e("invoices.total"),U.total,w),w+=10,i.setFont("helvetica","normal"),i.setFontSize(9),t.reservas.forEach((ae,ue)=>{w>250&&(i.addPage(),w=a),ue%2===0&&(V(p),i.rect(a,w-4,c,8,"F")),x(h),i.text(ae.type||"N/A",U.type,w);const le=parseFloat(ae.qty||0),q=parseFloat(ae.price||0),ce=parseFloat(ae.arancel||0),Se=ae.total||le*q+ce;i.text(le.toString(),U.qty,w),i.text(`$${q.toFixed(2)}`,U.price,w),i.text(`$${ce.toFixed(2)}`,U.arancel,w),i.setFont("helvetica","bold"),i.text(`$${Se.toFixed(2)}`,U.total,w),i.setFont("helvetica","normal"),w+=8}),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),i.line(a,w,o-a,w),w+=15}w>210&&(i.addPage(),w=a);const re=o-a-80,$=80;let D=60;t.taxAmount&&t.taxAmount>0&&(D+=16),V(p),ne(re-10,w,$+10,D,3,!0),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),ne(re-10,w,$+10,D,3);let H=w+10;if(i.setFontSize(10),x(y),t.productSubtotal!==void 0&&t.productSubtotal>0&&(i.text(e("invoices.productsSubtotal"),re,H),i.text(`$${t.productSubtotal.toFixed(2)}`,re+$-15,H,{align:"right"}),H+=8),t.reservaSubtotal!==void 0&&t.reservaSubtotal>0&&(i.text(e("invoices.reservationsSubtotal"),re,H),i.text(`$${t.reservaSubtotal.toFixed(2)}`,re+$-15,H,{align:"right"}),H+=8),t.taxAmount&&t.taxAmount>0){i.text(e("common.subtotal"),re,H),i.text(`$${(t.subtotalBeforeTax||0).toFixed(2)}`,re+$-15,H,{align:"right"}),H+=8;const U=t.paymentMethods?.taxPercent||7;i.text(`${e("common.tax")} (${U}%)`,re,H),i.text(`$${t.taxAmount.toFixed(2)}`,re+$-15,H,{align:"right"}),H+=8}if(i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),i.line(re,H+2,re+$-10,H+2),H+=10,i.setFontSize(14),i.setFont("helvetica","bold"),x(h),i.text(e("invoices.total"),re,H),i.text(`$${(t.total||0).toFixed(2)}`,re+$-15,H,{align:"right"}),t.paymentMethods){w+=D+20,x(h),i.setFontSize(12),i.setFont("helvetica","bold"),i.text(e("common.paymentMethods"),a,w),w+=10,i.setFontSize(10),i.setFont("helvetica","normal"),x(y);const U=t.paymentMethods;let ae=w;U.cash&&U.cash>0&&(i.text(`${e("common.cash")}:`,a+5,ae),i.text(`$${U.cash.toFixed(2)}`,a+50,ae),ae+=6),U.zelle&&U.zelle>0&&(i.text("Zelle:",a+5,ae),i.text(`$${U.zelle.toFixed(2)}`,a+50,ae),ae+=6),U.creditCard&&U.creditCard>0&&(i.text(`${e("common.creditCard")}:`,a+5,ae),i.text(`$${U.creditCard.toFixed(2)}`,a+50,ae),ae+=6),U.exemptTaxOnCash&&U.cash>0&&t.taxSavings>0&&(ae+=4,i.setFontSize(9),i.setFont("helvetica","italic"),i.text(`* Tax exempted on cash payment. You saved $${t.taxSavings.toFixed(2)}!`,a+5,ae)),w=ae+10}w=s-30,V(p),i.rect(0,w-10,o,40,"F"),i.setFontSize(12),i.setFont("helvetica","italic"),x(y);const L=e("common.thankYouBusiness"),j=i.getTextWidth(L);i.text(L,(o-j)/2,w),w+=8,i.setFontSize(9),i.setFont("helvetica","normal");const oe="www.hrmfinance.com | info@hrmfinance.com | +1 (555) 123-4567",K=i.getTextWidth(oe);i.text(oe,(o-K)/2,w),w+=8,i.setFontSize(8);const Z=`Generated on ${new Date().toLocaleString("en-US")}`,J=i.getTextWidth(Z);i.text(Z,(o-J)/2,w);const Y=`invoice-${t.invoice||"unknown"}.pdf`;i.save(Y),console.log("Professional PDF saved successfully:",Y)}catch(r){throw console.error("Error in generateProfessionalInvoicePDF:",r),r}},Sa=t=>parseFloat(t?.toString()||"0")||0,a8=t=>{if(t?.includes("/")){const[e,r,n]=t.split("/");return`${n}-${e.padStart(2,"0")}-${r.padStart(2,"0")}`}if(t?.includes("-")){const[e,r,n]=t.split("-");return`${n}-${e.padStart(2,"0")}-${r.padStart(2,"0")}`}return t},l8=t=>{const e=[];return t.ybstreet&&(e.push(t.ybstreet),t.ybstreetNo&&e.push(`# ${t.ybstreetNo}`)),t.ybbetwen1&&t.ybbetwen2&&e.push(`/ ${t.ybbetwen1} y ${t.ybbetwen2}`),t.ybreparto&&e.push(`, Rpto ${t.ybreparto}`),t.ybcity&&e.push(`, ${t.ybcity}`),t.ybestate&&e.push(`, ${t.ybestate}`),e.join(" ")},a1=t=>{const e=Sa(t.qty),r=Sa(t.price),n=Sa(t.arancel);return t.onlyTariff?n:e*r+n},l1=t=>{const e=Math.abs(t.qty),r=Sa(t.salePrice);return e*r},c8=(t,e)=>{const r=t.split("-");if(r.length>=3){const n=r[0];return{YY_8803:"BISSONNET"}[n]||e}return e},u8=t=>{console.log(t);const e=t?.products?.reduce((w,x)=>w+l1(x),0),r=t?.reservas?.reduce((w,x)=>w+a1(x),0),n=e+r,i=7,o=.93,a=n*(1-o)*(i/100),c=n*i/100-a,u=n+a,y=(t?.products||[])?.map((w,x)=>({id:Date.now().toString()+x,product:{id:w.product.id,code:w.product.code,label:w.product.label,price:0},qty:Math.abs(w.qty),salePrice:Sa(w.salePrice),total:l1(w)})),g=t?.reservas?.map((w,x)=>({id:Date.now().toString()+x+1e3,type:w.type,qty:Sa(w.qty),price:Sa(w.price),arancel:Sa(w.arancel),total:a1(w)})),p={name:t.shipper_consignee.name,firstName:t.shipper_consignee.firstName,middleName:t.shipper_consignee.middleName||"",lastName:t.shipper_consignee.lastName,lastName2:t.shipper_consignee.lastName2||"",phoneNumber:t.shipper_consignee.phoneNumber,cid:t.shipper_consignee.cid,passport:t.shipper_consignee.passport||"",address:l8(t.shipper_consignee),phoneNumberS:t.shipper_consignee.phoneNumberS,dob:a8(t.shipper_consignee.dob)},C=c8(t.invoice,t.store),S=t.shipper_consignee.shipping?.toLowerCase()==="aereo"?"aereo":"maritimo";return{invoice:t.invoice,description:t.description||"",store:C,shipper_consignee:p,products:y,reservas:g,packagesOrder:t.packagesOrder,shippingMethod:S,paymentMethods:t?.paymentMethods,type:t.type,ssg_inventory_key:t.ssg_inventory_key,ssg_sorder_key:t.ssg_sorder_key,createDate:t.createDate,businessId:t.businessId,isCompleted:t.isCompleted,productSubtotal:e,reservaSubtotal:r,subtotalBeforeTax:n,taxAmount:a,taxSavings:c,total:u,taxCalculationMethod:"subtotal",cashPaymentRatio:o}},[tu,Ur]=qh({invoices:[],selectedInvoice:null,loading:!1,error:null,lastUpdated:null}),[d8,po]=$e({fetchAll:!1,fetchById:!1,create:!1,update:!1,delete:!1,generatePDF:!1}),Vi={get state(){return tu},get loadingStates(){return d8()},async fetchInvoices(t){try{po(s=>({...s,fetchAll:!0})),Ur("loading",!0),Ur("error",null);let e="SALES";if(t?.search&&(e+=" "+t.search),t?.store&&t.store!=="all")e+=" "+t.store;else if(!Ar.state?.profile?.isAdmin)return e+=" "+Dm(32),Ur("invoices",[]),Ur("lastUpdated",new Date),[];t?.status&&t.status!=="all"&&(e+=" "+t.status);const r=e.toString(),n=await Ai.getInvoice(r);let i=[];if(t?.dateFrom&&t?.dateTo){const s=a=>{let c=new Date(n[a].createDate).getTime(),u=new Date(t?.dateFrom).getTime(),h=new Date(t?.dateTo).getTime();c>=u&&c<=h&&i.push(n[a])};Object.keys(n).map(s)}else i=Mp(n);const o=Array.isArray(i)?i:i||[];return console.log(o),Ur("invoices",o),Ur("lastUpdated",new Date),o}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoices";throw Ur("error",r),console.error("Error fetching invoices:",e),e}finally{Ur("loading",!1),po(e=>({...e,fetchAll:!1}))}},fecthInventory:async t=>{},async fetchInvoiceById(t){try{po(n=>({...n,fetchById:!0})),Ur("error",null);const e=await Ai.getInvoice(t),r=Mp(e);return Ur("selectedInvoice",r[0]),r}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoice";throw Ur("error",r),console.error("Error fetching invoice:",e),e}finally{po(e=>({...e,fetchById:!1}))}},async createInvoice(t){try{po(r=>({...r,create:!0})),Ur("error",null);const e={type:t.type||"SALES",invoice:t.invoice,description:t.description||"",store:t.store||"",ssg_inventory_key:t.ssg_inventory_key||`INV-${Date.now()}`,ssg_sorder_key:t.ssg_sorder_key||`SO-${Date.now()}`,createDate:t.createDate||Date.now(),shipper_consignee:t.shipper_consignee,packagesOrder:t.packagesOrder||!1,businessId:t.businessId||"YB100423253156428",userId:t.userId||"current-user",reservas:t.reservas||[],products:t.products||[],isCompleted:t.isCompleted||!0};return e.products&&e.products.length>0&&(e.productSubtotal=e.products.reduce((r,n)=>r+n.qty*n.salePrice,0)),e.reservas&&e.reservas.length>0&&(e.reservaSubtotal=e.reservas.reduce((r,n)=>r+n.total,0)),e.total=(e.productSubtotal||0)+(e.reservaSubtotal||0),Ur("invoices",r=>[e,...r]),Ur("lastUpdated",new Date),e}catch(e){const r=e instanceof Error?e.message:"Failed to create invoice";throw Ur("error",r),console.error("Error creating invoice:",e),e}finally{po(e=>({...e,create:!1}))}},async generateInvoicePDF(t,e="compact",r="es"){try{po(a=>({...a,generatePDF:!0})),Ur("error",null);const n=tu.invoices.find(a=>a.invoice===t);if(!n)throw new Error("Invoice not found");let i;switch(e){case"compact":const{generateCompactModernInvoicePDF:a}=await Ni(async()=>{const{generateCompactModernInvoicePDF:h}=await import("./compactModernInvoicePdfGenerator-CmItV-KG.js");return{generateCompactModernInvoicePDF:h}},[]);i=a;break;case"modern":const{generateModernMovementInvoicePDF:c}=await Ni(async()=>{const{generateModernMovementInvoicePDF:h}=await import("./modernMovementInvoicePdfGenerator-BM3PDOyO.js");return{generateModernMovementInvoicePDF:h}},[]);i=c;break;case"classic":default:const{generateWorkingInvoicePDF:u}=await Ni(async()=>{const{generateWorkingInvoicePDF:h}=await import("./workingPdfGenerator-CArlAW4i.js");return{generateWorkingInvoicePDF:h}},[]);i=u;break}const o={...n,movementType:"sales",items:n.products||[],invoiceId:n.invoice,id:n.invoice};return await i(o,null,r)}catch(n){const i=n instanceof Error?n.message:"Failed to generate PDF";throw Ur("error",i),console.error("Error generating invoice PDF:",n),n}finally{po(n=>({...n,generatePDF:!1}))}},async updateInvoice(t,e){try{po(n=>({...n,update:!0})),Ur("error",null);const r={};return Ur("invoices",n=>n.map(i=>i.invoice===t?r:i)),tu.selectedInvoice?.invoice===t&&Ur("selectedInvoice",r),Ur("lastUpdated",new Date),r}catch(r){const n=r instanceof Error?r.message:"Failed to update invoice";throw Ur("error",n),console.error("Error updating invoice:",r),r}finally{po(r=>({...r,update:!1}))}},async deleteInvoice(t){try{po(i=>({...i,delete:!0})),Ur("error",null),Ur("invoices",i=>i.filter(o=>o.invoice!==t)),tu.selectedInvoice?.invoice===t&&Ur("selectedInvoice",null),Ur("lastUpdated",new Date);const n=await qi({query:"deleteYabaSalesOrders",params:{businessId:"YB100423253156428",id:t}});return console.log(n),!0}catch(e){const r=e instanceof Error?e.message:"Failed to delete invoice";throw Ur("error",r),console.error("Error deleting invoice:",e),e}finally{po(e=>({...e,delete:!1}))}},async fetchInvoiceStats(t){try{Ur("error",null);const e=new URLSearchParams;t?.store&&t.store!=="all"&&e.append("store",t.store),t?.dateFrom&&e.append("dateFrom",t.dateFrom),t?.dateTo&&e.append("dateTo",t.dateTo);const r=e.toString();return[]}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoice statistics";throw Ur("error",r),console.error("Error fetching invoice stats:",e),e}},async fetchStores(){try{return Ur("error",null),[]}catch(t){const e=t instanceof Error?t.message:"Failed to fetch stores";throw Ur("error",e),console.error("Error fetching stores:",t),t}},setSelectedInvoice(t){Ur("selectedInvoice",t)},clearError(){Ur("error",null)},getFilteredInvoices(t){let e=tu.invoices;if(t.store&&t.store!=="all"&&(e=e.filter(r=>r.store===t.store)),t.dateFrom){const r=new Date(t.dateFrom).getTime();e=e.filter(n=>n.createDate>=r)}if(t.dateTo){const r=new Date(t.dateTo).setHours(23,59,59,999);e=e.filter(n=>n.createDate<=r)}if(t.status&&t.status!=="all"){const r=t.status==="completed";e=e.filter(n=>n.isCompleted===r)}return e},calculateSummary(t){let e=t.length,r=t.filter(g=>g.isCompleted).length,n=0,i=0,o=0,s=0,a=0,c=0,u=new Set,h=new Set;t?.forEach(g=>{u.add(g?.shipper_consignee?.cid),h.add(g.store),g?.products?.length>0&&g?.products?.forEach(p=>{const C=Math.abs(p?.qty);n+=C,o+=C*(parseFloat(p?.salePrice)||1)}),g?.reservas?.length>0&&g?.reservas?.forEach(p=>{let C=parseInt(p?.qty);isNaN(C)&&(C=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[p.type]||p?.onlyTariff?(C=parseFloat(p.arancel)||parseFloat(p.qty)*parseFloat(p.price),c+=C):(p?.arancel&&(a+=parseFloat(p?.arancel)),i+=C,s+=C*parseFloat(p?.price))})});const y=o+s+c;return{totalInvoices:e,completedInvoices:r,pendingInvoices:e-r,totalProducts:n,totalReservas:i,totalProductAmount:o,totalReservaAmount:s,totalAranceles:a,grandTotal:y,totalOther:c,uniqueCustomers:u.size,uniqueStores:h.size,avgInvoiceValue:e>0?y/e:0}},async refreshData(t){return this.fetchInvoices(t)}};var h8=de("<br>"),c1=de("<div><h3></h3><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),u1=de("<div><span>:</span><span>"),f8=de("<button>remove"),p8=de("<div class=invoice-display><div><div><div>:<span></span></div><div>: <span></span></div></div><div><div></div><h2></h2><div></div><div></div></div></div><div><h3></h3><div><div><div></div><div></div></div></div><div></div><h3></h3><div><div><div></div><div> <!> <!> </div><div></div><div></div><div></div><div></div></div><div><div></div><div></div><div></div><div></div><div> #<br> <!> <!> <br>, <br>, </div></div></div></div><div><div><div><span>:</span><span></span></div></div></div><div></div><div><button> </button><button> Test PDF</button><button> </button></div><style>"),d1=de("<tr><td></td><td></td><td></td><td></td><td>");const m8=t=>{const{t:e}=er(),[r,n]=$e(""),[i,o]=$e(!1),s=z=>new Date(z).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),a=z=>{const O=typeof z=="string"?parseFloat(z):z;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(O)},c=Tt(()=>{let z=0,O=0,k=0,re=0;t.invoice?.products?.forEach(L=>{const j=Math.abs(L?.qty),oe=parseFloat(L?.salePrice?.toString())||1;z+=j*oe}),t.invoice?.reservas?.forEach(L=>{let j=parseFloat(L?.qty?.toString());isNaN(j)&&(j=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[L.type]||L?.onlyTariff?(j=parseFloat(L.arancel?.toString())||parseFloat(L.qty?.toString())*parseFloat(L.price?.toString()),k+=j):(L?.arancel&&(re+=parseFloat(L?.arancel?.toString())),O+=j*parseFloat(L?.price?.toString()))});const $=z+O+re+k,D=0,H=$+D;return{productSubtotal:z,reservaSubtotal:O,tariffSubtotal:re,subtotal:$,tax:D,total:H}}),u={"max-width":"800px",margin:"0 auto",padding:"2rem",background:"white","box-shadow":"0 0 20px rgba(0,0,0,0.1)","border-radius":"var(--border-radius)"},h={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"2rem","padding-bottom":"2rem","border-bottom":"2px solid #e0e0e0"},y={"text-align":"right",flex:"1"},g={display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"600","text-transform":"uppercase",background:t.invoice.isCompleted?"#d4edda":"#fff3cd",color:t.invoice.isCompleted?"#155724":"#856404","margin-bottom":"0.5rem"},p={"margin-bottom":"2rem"},C={"font-size":"1.1rem","font-weight":"600","margin-bottom":"1rem",color:"#333"},S={display:"grid","grid-template-columns":"1fr 1fr",gap:"1.5rem"},w={background:"#f8f9fa",padding:"1rem","border-radius":"var(--border-radius-sm)",border:"1px solid #e9ecef"},x={"font-size":"0.875rem",color:"#666","margin-bottom":"0.25rem"},V={"font-size":"1rem",color:"#333","font-weight":"500"},ne={width:"100%","border-collapse":"collapse","margin-top":"1rem"},X={"text-align":"left",padding:"0.75rem","border-bottom":"2px solid #dee2e6","font-weight":"600",color:"#495057","font-size":"0.875rem","text-transform":"uppercase"},Q={padding:"0.75rem","border-bottom":"1px solid #dee2e6",color:"#212529"},ee={"font-weight":"600","font-size":"1.1rem"},E={display:"flex",gap:"1rem","justify-content":"center","margin-top":"2rem","padding-top":"2rem","border-top":"2px solid #e0e0e0"},A={padding:"0.75rem 1.5rem","border-radius":"var(--border-radius-sm)",border:"none","font-weight":"500",cursor:"pointer",transition:"all 0.2s",display:"flex","align-items":"center",gap:"0.5rem"},T={...A,background:"var(--primary-color)",color:"white"},R={...A,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},_=Tt(()=>lt.getLocationById(t.invoice.store)),I=async()=>{console.log("Starting PDF export...");try{if(!t.invoice){console.error("No invoice data available"),alert("No invoice data available");return}console.log("Invoice data:",t.invoice),console.log("Store info:",_()),console.log("Totals:",c());const z={...t.invoice,storeName:_()?.name||t.invoice.store,storeType:_()?.type,productSubtotal:c().productSubtotal,reservaSubtotal:c().reservaSubtotal,total:c().total};let O=u8(t.invoice);console.log("Prepared invoice data:",O),console.log(JSON.stringify(O,null,4)),console.log("Using minimal ink PDF generator...");try{s1(O,e),await s8(O,e),console.log("Minimal ink PDF generation completed successfully")}catch(k){console.error("PDF generation failed:",k),console.log("Trying printable PDF fallback..."),s1(O,e),console.log("Printable PDF fallback completed")}}catch(z){console.error("Error in handleExportPDF:",z),console.error("Error stack:",z.stack),alert(`Error generating PDF: ${z.message}`)}},b=z=>parseFloat(z?.toString())||0,G=z=>{Vi.deleteInvoice(t.invoice.ssg_sorder_key),t.goBack()},ie=z=>{let O=b(z.qty),k=b(z.price),re=b(z.arancel);return`${(O*k+re)?.toFixed(2)}`},F=z=>{let O=Math.abs(z.qty),k=b(z.salePrice);return`${(O*k)?.toFixed(2)}`},W=async()=>{if(t.invoice){o(!0);try{const{generateEnhancedInvoicePDF:z}=await Ni(async()=>{const{generateEnhancedInvoicePDF:re}=await import("./enhancedInvoicePdfGenerator-Unlnz4KK.js");return{generateEnhancedInvoicePDF:re}},[]);let O=Lm(t.invoice);if(!(O?.paymentMethods&&O?.productSubtotal&&O?.total)){let re=0;O?.reservas.forEach(D=>{re+=parseFloat(ie(D))});let $=0;O?.products?.forEach(D=>{$+=parseFloat(F(D))}),O.reservaSubtotal=re.toFixed(2),O.productSubtotal=$.toFixed(2),O.subtotalBeforeTax=($+re).toFixed(2),O.total=O.subtotalBeforeTax,console.log(O)}const k=await z(O,"es","modern")}catch(z){console.log(z)}finally{o(!1)}}};return(()=>{var z=p8(),O=z.firstChild,k=O.firstChild,re=k.firstChild,$=re.firstChild,D=$.nextSibling,H=re.nextSibling,L=H.firstChild,j=L.nextSibling,oe=k.nextSibling,K=oe.firstChild,Z=K.nextSibling,J=Z.nextSibling,Y=J.nextSibling,U=O.nextSibling,ae=U.firstChild,ue=ae.nextSibling,le=ue.firstChild,q=le.firstChild,ce=q.nextSibling,Se=ue.nextSibling,me=Se.nextSibling,Pe=me.nextSibling,xe=Pe.firstChild,he=xe.firstChild,ve=he.nextSibling,De=ve.firstChild,ke=De.nextSibling,Ce=ke.nextSibling,Le=Ce.nextSibling;Le.nextSibling;var Ie=ve.nextSibling,Re=Ie.nextSibling,He=Re.nextSibling,Me=He.nextSibling,Ze=xe.nextSibling,Ye=Ze.firstChild,ut=Ye.nextSibling,rt=ut.nextSibling,We=rt.nextSibling,ct=We.nextSibling,pt=ct.firstChild,_t=pt.nextSibling,Et=_t.nextSibling,et=Et.nextSibling,Ue=et.nextSibling,ot=Ue.nextSibling,Xe=ot.nextSibling,at=Xe.nextSibling,St=at.nextSibling,$t=St.nextSibling,qt=$t.nextSibling,Gt=U.nextSibling,ht=Gt.firstChild,Kt=ht.firstChild,Rt=Kt.firstChild,Qt=Rt.firstChild,sr=Rt.nextSibling,mt=Gt.nextSibling,At=mt.nextSibling,Ot=At.firstChild;Ot.firstChild;var Jt=Ot.nextSibling,Zt=Jt.nextSibling;Zt.firstChild;var Ht=At.nextSibling;return m(z,u),m(O,h),re.style.setProperty("color","#666"),re.style.setProperty("margin-top","0.25rem"),l(re,()=>e(`inventory.${_()?.type}Type`),$),D.style.setProperty("font-size","1.1rem"),D.style.setProperty("font-weight","600"),D.style.setProperty("color","#444"),l(D,()=>_()?.name),H.style.setProperty("font-size",".91rem"),H.style.setProperty("font-weight","400"),H.style.setProperty("color","#666"),l(H,()=>e("invoices.id"),L),j.style.setProperty("font-size","1.1rem"),j.style.setProperty("font-weight","600"),j.style.setProperty("color","#444"),l(j,()=>t.invoice.ssg_sorder_key),m(oe,y),l(K,(()=>{var tt=Te(()=>!!t.invoice.isCompleted);return()=>tt()?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase()})()),Z.style.setProperty("margin","0 0 0.5rem 0"),Z.style.setProperty("font-size","1.5rem"),l(Z,()=>e("common.invoice").toUpperCase()),J.style.setProperty("font-size","1.1rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("color","#333"),l(J,()=>t.invoice.invoice),Y.style.setProperty("color","#666"),Y.style.setProperty("margin-top","0.5rem"),l(Y,()=>s(t.invoice.createDate)),l(ae,()=>e("invoices.senderInformation")),l(q,()=>e("invoices.customerName")),l(ce,()=>t.invoice.shipper_consignee.name),l(le,B(Ge,{get when(){return t.invoice.shipper_consignee.phoneNumberS},get children(){return[h8(),Te(()=>e("invoices.altPhone")),": ",Te(()=>t.invoice.shipper_consignee.phoneNumberS)]}}),null),Se.style.setProperty("margin","20px"),l(me,()=>e("invoices.receiptInformation")),l(he,()=>e("invoices.customerName")),l(ve,()=>t.invoice.shipper_consignee.firstName,De),l(ve,()=>t.invoice.shipper_consignee.middleName,ke),l(ve,()=>t.invoice.shipper_consignee.lastName,Le),l(ve,()=>t.invoice.shipper_consignee.lastName2,null),l(Ie,()=>e("invoices.id")),l(Re,()=>t.invoice.shipper_consignee.cid),l(He,()=>e("invoices.passport")),l(Me,()=>t.invoice.shipper_consignee.passport),l(Ye,()=>e("invoices.contactInformation")),l(ut,()=>e("invoices.phoneNumber")),l(rt,()=>t.invoice.shipper_consignee.phoneNumber),l(We,()=>e("invoices.address")),l(ct,()=>t.invoice.shipper_consignee.ybstreet,pt),l(ct,()=>t.invoice.shipper_consignee.ybstreetNo,_t),l(ct,()=>e("invoices.between"),Et),l(ct,()=>t.invoice.shipper_consignee.ybbetwen1,et),l(ct,()=>e("invoices.and"),ot),l(ct,()=>t.invoice.shipper_consignee.ybbetwen2,at),l(ct,()=>t.invoice.shipper_consignee.ybreparto,St),l(ct,()=>t.invoice.shipper_consignee.ybcity,$t),l(ct,()=>t.invoice.shipper_consignee.ybestate,qt),l(ct,()=>t.invoice.shipper_consignee.nacionality,null),l(z,B(Ge,{get when(){return t.invoice?.products?.length>0},get children(){var tt=c1(),jt=tt.firstChild,yt=jt.nextSibling,ar=yt.firstChild,Wr=ar.firstChild,pr=Wr.firstChild,wr=pr.nextSibling,$r=wr.nextSibling,lr=$r.nextSibling,Br=lr.nextSibling,tn=ar.nextSibling;return l(jt,()=>e("invoices.products")),l(pr,()=>e("invoices.code")),l(wr,()=>e("invoices.description")),l($r,()=>e("invoices.qty")),l(lr,()=>e("invoices.unitPrice")),l(Br,()=>e("invoices.total")),l(tn,B(Ut,{get each(){return t.invoice?.products},children:kt=>(()=>{var Sr=d1(),Cr=Sr.firstChild,jr=Cr.nextSibling,kr=jr.nextSibling,Yr=kr.nextSibling,rn=Yr.nextSibling;return l(Cr,()=>kt.product.code),l(jr,()=>kt.product.label),l(kr,()=>Math.abs(kt.qty)),l(Yr,()=>a(kt.salePrice)),l(rn,()=>a(Math.abs(kt.qty)*parseFloat(kt.salePrice))),we(yr=>{var ln=Q,_n=Q,Ir={...Q,"text-align":"center"},wn={...Q,"text-align":"right"},Cn={...Q,"text-align":"right"};return yr.e=m(Cr,ln,yr.e),yr.t=m(jr,_n,yr.t),yr.a=m(kr,Ir,yr.a),yr.o=m(Yr,wn,yr.o),yr.i=m(rn,Cn,yr.i),yr},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Sr})()})),we(kt=>{var Sr=p,Cr=C,jr=ne,kr=X,Yr=X,rn={...X,"text-align":"center"},yr={...X,"text-align":"right"},ln={...X,"text-align":"right"};return kt.e=m(tt,Sr,kt.e),kt.t=m(jt,Cr,kt.t),kt.a=m(yt,jr,kt.a),kt.o=m(pr,kr,kt.o),kt.i=m(wr,Yr,kt.i),kt.n=m($r,rn,kt.n),kt.s=m(lr,yr,kt.s),kt.h=m(Br,ln,kt.h),kt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),tt}}),Gt),l(z,B(Ge,{get when(){return t.invoice?.reservas?.length>0},get children(){var tt=c1(),jt=tt.firstChild,yt=jt.nextSibling,ar=yt.firstChild,Wr=ar.firstChild,pr=Wr.firstChild,wr=pr.nextSibling,$r=wr.nextSibling,lr=$r.nextSibling,Br=lr.nextSibling,tn=ar.nextSibling;return l(jt,()=>e("invoices.reservations")),l(pr,()=>e("invoices.type")),l(wr,()=>e("invoices.qty")),l($r,()=>e("invoices.unitPrice")),l(lr,()=>e("invoices.arancel")),l(Br,()=>e("invoices.total")),l(tn,B(Ut,{get each(){return t.invoice?.reservas},children:kt=>(()=>{var Sr=d1(),Cr=Sr.firstChild,jr=Cr.nextSibling,kr=jr.nextSibling,Yr=kr.nextSibling,rn=Yr.nextSibling;return l(Cr,()=>kt.type),l(jr,()=>kt.qty),l(kr,()=>a(kt.price)),l(Yr,()=>kt.arancel||"-"),l(rn,()=>a(parseInt(kt.qty)*parseFloat(kt.price)+(kt.arancel?parseFloat(kt.arancel):0))),we(yr=>{var ln=Q,_n={...Q,"text-align":"center"},Ir={...Q,"text-align":"right"},wn={...Q,"text-align":"right"},Cn={...Q,"text-align":"right"};return yr.e=m(Cr,ln,yr.e),yr.t=m(jr,_n,yr.t),yr.a=m(kr,Ir,yr.a),yr.o=m(Yr,wn,yr.o),yr.i=m(rn,Cn,yr.i),yr},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Sr})()})),we(kt=>{var Sr=p,Cr=C,jr=ne,kr=X,Yr={...X,"text-align":"center"},rn={...X,"text-align":"right"},yr={...X,"text-align":"right"},ln={...X,"text-align":"right"};return kt.e=m(tt,Sr,kt.e),kt.t=m(jt,Cr,kt.t),kt.a=m(yt,jr,kt.a),kt.o=m(pr,kr,kt.o),kt.i=m(wr,Yr,kt.i),kt.n=m($r,rn,kt.n),kt.s=m(lr,yr,kt.s),kt.h=m(Br,ln,kt.h),kt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),tt}}),Gt),ht.style.setProperty("display","inline-block"),ht.style.setProperty("min-width","250px"),l(ht,B(Ge,{get when(){return t.invoice?.products?.length>0},get children(){var tt=u1(),jt=tt.firstChild,yt=jt.firstChild,ar=jt.nextSibling;return tt.style.setProperty("display","flex"),tt.style.setProperty("justify-content","space-between"),tt.style.setProperty("margin-bottom","0.5rem"),l(jt,()=>e("invoices.productsSubtotal"),yt),l(ar,()=>a(c().productSubtotal)),tt}}),Kt),l(ht,B(Ge,{get when(){return t.invoice?.reservas?.length>0},get children(){var tt=u1(),jt=tt.firstChild,yt=jt.firstChild,ar=jt.nextSibling;return tt.style.setProperty("display","flex"),tt.style.setProperty("justify-content","space-between"),tt.style.setProperty("margin-bottom","0.5rem"),l(jt,()=>e("invoices.subtotal"),yt),l(ar,()=>a(c().reservaSubtotal)),tt}}),Kt),l(Rt,()=>e("invoices.total"),Qt),sr.style.setProperty("color","var(--primary-color)"),l(sr,()=>a(c().total)),Ot.addEventListener("mouseleave",tt=>tt.currentTarget.style.opacity="1"),Ot.addEventListener("mouseenter",tt=>tt.currentTarget.style.opacity="0.9"),Ot.$$click=W,l(Ot,()=>e("invoices.printInvoice"),null),as(Jt,"click",o8,!0),Zt.addEventListener("mouseleave",tt=>{tt.currentTarget.style.background="white",tt.currentTarget.style.color="var(--primary-color)"}),Zt.addEventListener("mouseenter",tt=>{tt.currentTarget.style.background="var(--primary-color)",tt.currentTarget.style.color="white"}),Zt.$$click=I,l(Zt,()=>e("invoices.exportPdf"),null),l(At,B(Ge,{get when(){return Ar.state?.profile?.isAdmin},get children(){var tt=f8();return tt.$$click=G,tt.addEventListener("mouseleave",jt=>jt.currentTarget.style.opacity="1"),tt.addEventListener("mouseenter",jt=>jt.currentTarget.style.opacity="0.9"),we(jt=>m(tt,T,jt)),tt}}),null),l(Ht,`
        @media print {
          .invoice-display {
            box-shadow: none !important;
            padding: 0 !important;
          }
          
          ${E} {
            display: none !important;
          }
        }
      `),we(tt=>{var jt=g,yt=p,ar=C,Wr=S,pr=w,wr=x,$r=V,lr=C,Br=S,tn=w,kt=x,Sr=V,Cr={...x,"margin-top":"0.75rem"},jr=V,kr={...x,"margin-top":"0.75rem"},Yr=V,rn=w,yr=x,ln={...x,"margin-top":"0.75rem"},_n=V,Ir={...x,"margin-top":"0.75rem"},wn=V,Cn={...p,"text-align":"right"},Li={...ee,display:"flex","justify-content":"space-between","padding-top":"0.75rem","border-top":"2px solid #dee2e6"},tr={...p,"text-align":"center",color:"#666","font-size":"0.875rem"},Tr=E,qr=T,bt={...T,background:"#28a745"},rr=R;return tt.e=m(K,jt,tt.e),tt.t=m(U,yt,tt.t),tt.a=m(ae,ar,tt.a),tt.o=m(ue,Wr,tt.o),tt.i=m(le,pr,tt.i),tt.n=m(q,wr,tt.n),tt.s=m(ce,$r,tt.s),tt.h=m(me,lr,tt.h),tt.r=m(Pe,Br,tt.r),tt.d=m(xe,tn,tt.d),tt.l=m(he,kt,tt.l),tt.u=m(ve,Sr,tt.u),tt.c=m(Ie,Cr,tt.c),tt.w=m(Re,jr,tt.w),tt.m=m(He,kr,tt.m),tt.f=m(Me,Yr,tt.f),tt.y=m(Ze,rn,tt.y),tt.g=m(Ye,yr,tt.g),tt.p=m(ut,ln,tt.p),tt.b=m(rt,_n,tt.b),tt.T=m(We,Ir,tt.T),tt.A=m(ct,wn,tt.A),tt.O=m(Gt,Cn,tt.O),tt.I=m(Kt,Li,tt.I),tt.S=m(mt,tr,tt.S),tt.W=m(At,Tr,tt.W),tt.C=m(Ot,qr,tt.C),tt.B=m(Jt,bt,tt.B),tt.v=m(Zt,rr,tt.v),tt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0}),z})()};dr(["click"]);const lu={invoice:"",description:"",store:"",shipper_consignee:{name:"",firstName:"",middleName:"",lastName:"",lastName2:"",phoneNumber:"",cid:"",passport:"",address:""},products:[],reservas:[],packagesOrder:!1,shippingMethod:"",paymentMethods:{taxOnTotal:!1,taxPercent:0,exemptTaxOnCash:!1,cash:0,zelle:0,creditCard:0}},Fy="invoice_styled_form_draft",y8=()=>{try{const t=localStorage.getItem(Fy);if(t){const e=JSON.parse(t),r={...lu,...e,shipper_consignee:{...lu.shipper_consignee,...e.shipper_consignee||{}},paymentMethods:{...lu.paymentMethods,...e.paymentMethods||{}},products:e.products||[],reservas:e.reservas||[]};return console.log("Loaded styled form data from storage:",r),r}}catch(t){console.warn("Failed to load styled invoice form from storage:",t)}return console.log("No saved data found, using default form data"),{...lu}},Oy=t=>{try{localStorage.setItem(Fy,JSON.stringify(t))}catch(e){console.warn("Failed to save styled invoice form to storage:",e)}},h1=()=>{try{localStorage.removeItem(Fy)}catch(t){console.warn("Failed to clear styled invoice form from storage:",t)}},[dl,Go]=$e(y8()),[a_,mo]=$e(!1),[g8,sh]=$e(null);let Pp=null;const xs=()=>{Pp&&clearTimeout(Pp),Pp=setTimeout(()=>{const t=dl();Oy(t),sh(new Date),console.log("Styled invoice form auto-saved at",new Date().toLocaleTimeString())},1e3)},Hr={formData:dl,get isDirty(){return a_()},get lastSaved(){return g8()},updateForm:t=>{Go(e=>{const r={...e,...t};return mo(!0),xs(),r})},updateShipperConsignee:t=>{Go(e=>{const r={...e,shipper_consignee:{...e.shipper_consignee,...t}};return mo(!0),xs(),r})},updatePaymentMethods:t=>{Go(e=>{const r={...e,paymentMethods:{...e.paymentMethods,...t}};return mo(!0),xs(),r})},addProduct:t=>{Go(e=>{const r={...e,products:[...e.products,t]};return mo(!0),xs(),r})},updateProduct:(t,e)=>{Go(r=>{const n=[...r.products];n[t]={...n[t],...e};const i={...r,products:n};return mo(!0),xs(),i})},removeProduct:t=>{Go(e=>{const r=e.products.filter((i,o)=>o!==t),n={...e,products:r};return mo(!0),xs(),n})},addReserva:t=>{Go(e=>{const r={...e,reservas:[...e.reservas,t]};return mo(!0),xs(),r})},updateReserva:(t,e)=>{Go(r=>{const n=[...r.reservas];n[t]={...n[t],...e};const i={...r,reservas:n};return mo(!0),xs(),i})},removeReserva:t=>{Go(e=>{const r=e.reservas.filter((i,o)=>o!==t),n={...e,reservas:r};return mo(!0),xs(),n})},clearForm:()=>{Go({...lu}),mo(!1),h1(),sh(null)},markCompleted:()=>{h1(),mo(!1),sh(null)},forceSave:()=>{Oy(dl()),sh(new Date),mo(!1)},hasData:()=>{const t=dl();return t.invoice!==""||t.description!==""||t.store!==""||t.shipper_consignee.name!==""||t.shipper_consignee.firstName!==""||t.shipper_consignee.cid!==""||t.products.length>0||t.reservas.length>0||t.paymentMethods.cash>0||t.paymentMethods.zelle>0||t.paymentMethods.creditCard>0},isValid:()=>{const t=dl();return t.invoice.trim()!==""&&t.shipper_consignee.firstName.trim()!==""&&t.shipper_consignee.lastName.trim()!==""&&t.shipper_consignee.cid.trim()!==""&&(t.products.length>0||t.reservas.length>0)},getFormData:()=>dl()};typeof window<"u"&&window.addEventListener("beforeunload",t=>{if(a_()&&(Oy(dl()),Hr.hasData()))return t.preventDefault(),t.returnValue="You have unsaved changes in your invoice. Are you sure you want to leave?",t.returnValue});var v8=de("<div> "),b8=de("<div> <div>"),_8=de("<div><span></span><span>"),Yd=de("<div>"),w8=de("<div><div><div><input type=text autocomplete=off>"),S8=de("<button type=button>+"),P8=de("<div><div></div><div>"),x8=de("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div></div><div>: "),A8=de("<span>"),C8=de("<span> ");const I8=t=>{const{t:e}=er(),[r,n]=$e(!1),[i,o]=$e(""),[s,a]=$e(-1),[c,u]=$e(!1),[h,y]=$e(null),[g,p]=$e([]),[C,S]=$e(null),w=t.searchDelay||300,x=t.maxResults||40,V=Tt(()=>{if(!t.value)return null;const Z=g().find(J=>J.id===t.value);return Z||lt.getProductById(t.value)}),ne=async Z=>{if(!Z.trim()){p([]);return}u(!0),y(null);const J=lt.getActiveProducts().filter(Y=>Y.name.toLowerCase().includes(Z.toLowerCase())||Y.sku.toLowerCase().includes(Z.toLowerCase())||Y?.UPC?.toLowerCase().includes(Z?.toLowerCase())||Y.category.toLowerCase().includes(Z.toLowerCase())).slice(0,x);p(J),u(!1)},X=Tt(()=>i().toLowerCase()?g():lt.getActiveProducts().slice(0,10)),Q=()=>{n(!0),o(""),a(-1),y(null),i()||p(lt.getActiveProducts().slice(0,10))},ee=Z=>{const Y=Z.target.value;o(Y),n(!0),a(-1),y(null),C()&&clearTimeout(C());const U=setTimeout(()=>{ne(Y)},w);S(U)},E=Z=>{t.onChange(Z.id),n(!1),o(""),a(-1),y(null),C()&&(clearTimeout(C()),S(null))},A=Z=>{const J=X();switch(Z.key){case"ArrowDown":Z.preventDefault(),a(Y=>Math.min(Y+1,J.length-1));break;case"ArrowUp":Z.preventDefault(),a(Y=>Math.max(Y-1,-1));break;case"Enter":Z.preventDefault(),s()>=0&&J[s()]&&E(J[s()]);break;case"Escape":n(!1),o(""),a(-1),y(null),C()&&(clearTimeout(C()),S(null));break}},T=Z=>{setTimeout(()=>{n(!1),o(""),a(-1),C()&&(clearTimeout(C()),S(null))},150)},R=Z=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Z),_=Z=>lt.stockLevels.filter(J=>J.productId===Z).reduce((J,Y)=>J+Y.quantity,0);Rn(()=>()=>{C()&&clearTimeout(C())});const I={position:"relative",width:"100%",...t.style},b={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},G={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"400px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},ie=Z=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:Z?"var(--strip-color)":"transparent",color:Z?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),F={display:"flex","justify-content":"space-between","align-items":"center"},W={flex:"1"},z={"font-weight":"500","margin-bottom":"0.25rem"},O={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem","flex-wrap":"wrap"},k={"text-align":"right","font-size":"0.875rem"},re={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},$={padding:"1rem","text-align":"center",color:"var(--text-muted)",display:"flex","align-items":"center","justify-content":"center",gap:"0.5rem"},D={padding:"1rem","text-align":"center",color:"#d32f2f",background:"#ffebee","border-radius":"var(--border-radius-sm)",margin:"0.5rem","font-size":"0.875rem"},H=()=>r()&&i()?i():V()?`${V().name} (${V().sku})`:"",L={display:"flex","align-items":"stretch",width:"100%"},j={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},oe={...b,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"},K={position:"absolute",right:t.onAddNew?"50px":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)","pointer-events":"none"};return(()=>{var Z=w8(),J=Z.firstChild,Y=J.firstChild,U=Y.firstChild;return m(J,L),Y.style.setProperty("position","relative"),Y.style.setProperty("flex","1"),U.addEventListener("blur",T),U.$$keydown=A,U.$$click=Q,U.$$input=ee,l(Y,B(Ge,{get when(){return c()},get children(){var ae=v8();return ae.firstChild,l(ae,()=>e("common.searching","Searching..."),null),we(ue=>m(ae,K,ue)),ae}}),null),l(J,(()=>{var ae=Te(()=>!!t.onAddNew);return()=>ae()&&(()=>{var ue=S8();return ue.addEventListener("mouseleave",le=>{le.currentTarget.style.background="var(--surface-color)",le.currentTarget.style.color="var(--primary-color)"}),ue.addEventListener("mouseenter",le=>{le.currentTarget.style.background="var(--primary-color)",le.currentTarget.style.color="white"}),as(ue,"click",t.onAddNew,!0),m(ue,j),we(()=>Yt(ue,"title",e("inventory.addProduct","Add new product"))),ue})()})(),null),l(Z,B(Ge,{get when(){return r()},get children(){var ae=Yd();return l(ae,B(Ge,{get when(){return h()},get children(){var ue=b8(),le=ue.firstChild,q=le.nextSibling;return m(ue,D),l(ue,h,q),q.style.setProperty("margin-top","0.5rem"),q.style.setProperty("font-size","0.75rem"),l(q,()=>e("inventory.searchFallback","Showing local results")),ue}}),null),l(ae,B(Ge,{get when(){return c()},get children(){var ue=_8(),le=ue.firstChild,q=le.nextSibling;return m(ue,$),l(q,()=>e("common.searching","Searching products...")),ue}}),null),l(ae,B(Ge,{get when(){return Te(()=>!c())()&&X().length>0},get fallback(){return Te(()=>!c())()&&(()=>{var ue=Yd();return m(ue,re),l(ue,(()=>{var le=Te(()=>!!i());return()=>le()?(()=>{var q=P8(),ce=q.firstChild,Se=ce.nextSibling;return l(ce,()=>e("inventory.noProductsFound","No products found matching your search.")),Se.style.setProperty("margin-top","0.5rem"),Se.style.setProperty("font-size","0.75rem"),l(Se,()=>e("inventory.tryDifferentTerm","Try a different search term or check spelling.")),q})():e("inventory.noProductsAvailable","No products available.")})()),ue})()},get children(){return[B(Ut,{get each(){return X()},children:(ue,le)=>{const q=_(ue.id),ce=q<=ue.minStockLevel;return(()=>{var Se=x8(),me=Se.firstChild,Pe=me.firstChild,xe=Pe.firstChild,he=xe.nextSibling,ve=he.firstChild,De=ve.firstChild,ke=ve.nextSibling,Ce=ke.nextSibling,Le=Ce.nextSibling,Ie=Le.nextSibling,Re=Pe.nextSibling,He=Re.firstChild,Me=He.firstChild,Ze=He.nextSibling,Ye=Ze.nextSibling,ut=Ye.firstChild;return Se.addEventListener("mouseenter",()=>a(le())),Se.$$click=()=>E(ue),m(me,F),m(Pe,W),m(xe,z),l(xe,()=>ue.name,null),l(xe,(()=>{var rt=Te(()=>!!i());return()=>rt()&&(()=>{var We=A8();return We.style.setProperty("margin-left","0.5rem"),We.style.setProperty("font-size","0.75rem"),We.style.setProperty("color","var(--primary-color)"),We.style.setProperty("font-weight","normal"),l(We,()=>g().includes(ue)?" API":" Local"),We})()})(),null),m(he,O),l(ve,()=>e("inventory.sku","SKU"),De),l(ve,()=>ue.sku,null),l(Ce,()=>ue.category),l(Ie,()=>R(ue.unitCost)),l(Pe,(()=>{var rt=Te(()=>!!ue.description);return()=>rt()&&(()=>{var We=Yd();return We.style.setProperty("font-size","0.75rem"),We.style.setProperty("color","var(--text-muted)"),We.style.setProperty("margin-top","0.25rem"),We.style.setProperty("font-style","italic"),l(We,(()=>{var ct=Te(()=>ue.description.length>60);return()=>ct()?`${ue.description.substring(0,60)}...`:ue.description})()),We})()})(),null),m(Re,k),He.style.setProperty("font-weight","600"),(ce?"#f44336":"var(--text-primary)")!=null?He.style.setProperty("color",ce?"#f44336":"var(--text-primary)"):He.style.removeProperty("color"),l(He,q,Me),l(He,()=>ue.unitOfMeasure,null),Ze.style.setProperty("color","var(--text-muted)"),l(Ze,()=>ce?(()=>{var rt=C8();return rt.firstChild,rt.style.setProperty("color","#f44336"),l(rt,()=>e("inventory.lowStock","Low Stock"),null),rt})():e("inventory.inStock","In Stock")),Ye.style.setProperty("font-size","0.75rem"),Ye.style.setProperty("color","var(--text-muted)"),Ye.style.setProperty("margin-top","0.25rem"),l(Ye,()=>e("inventory.min","Min"),ut),l(Ye,()=>ue.minStockLevel,null),we(rt=>m(Se,ie(le()===s()),rt)),Se})()}}),Te(()=>Te(()=>X().length===x)()&&(()=>{var ue=Yd();return ue.style.setProperty("padding","0.5rem"),ue.style.setProperty("text-align","center"),ue.style.setProperty("font-size","0.75rem"),ue.style.setProperty("color","var(--text-muted)"),ue.style.setProperty("border-top","1px solid var(--border-color)"),ue.style.setProperty("font-style","italic"),l(ue,()=>e("inventory.showingTopResults","Showing top {{count}} results",{count:x})),ue})())]}}),null),we(ue=>m(ae,G,ue)),ae}}),null),we(ae=>{var ue=I,le=oe,q=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),ce=t.disabled,Se=t.required;return ae.e=m(Z,ue,ae.e),ae.t=m(U,le,ae.t),q!==ae.a&&Yt(U,"placeholder",ae.a=q),ce!==ae.o&&(U.disabled=ae.o=ce),Se!==ae.i&&(U.required=ae.i=Se),ae},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),we(()=>U.value=H()),Z})()};dr(["input","click","keydown"]);var $8=de("<label>"),xp=de("<div>"),E8=de("<div><span></span><span>"),k8=de("<div><input type=text autocomplete=off>"),T8=de("<span> "),N8=de("<span> "),L8=de("<span> "),D8=de("<div><div><div><div> </div><div>");const R8=t=>{const{t:e}=er(),[r,n]=$e(!1),[i,o]=$e(""),[s,a]=$e(-1),[c,u]=$e(!1),[h,y]=$e([]),[g,p]=$e(null),C=async W=>{if(!W.trim()||W.trim().length<6){y([]);return}try{u(!0);const z=await Ai.getConsigee(W);console.log(z);const O=Object.values(z).map(k=>({id:k.consigneeId,firstName:k.firstName+(k.middleName?" "+k.middleName:""),fullName:k.firstName+(k.middleName?" "+k.middleName:"")+" "+k.lastName+" "+k.lastName2,lastName:k.lastName+" "+k.lastName2,cid:k.cid,phoneNumber:k.phoneNumber,ybbetwen1:k.ybbetwen1,ybcity:k.ybcity,ybestate:k.ybestate,ybreparto:k.ybreparto,ybstreet:k.ybstreet,ybstreetNo:k.ybstreetNo,address:`Calle ${k.ybstreet}${k.ybstreetNo?" # "+k.ybstreetNo:""}${k.ybbetwen1?" / "+k.ybbetwen1:""}${k.ybbetwen2?" y "+k.ybbetwen2:""}${k.ybreparto?", Rpto "+k.ybreparto:""}, ${k.ybcity?k.ybcity:""}, ${k.ybestate?k.ybestate:""}`}));y(O)}catch(z){console.warn("API search failed, falling back to local search:",z)}finally{u(!1)}},S=()=>{n(!0),o(""),a(-1),i()||C("")},w=W=>{const O=W.target.value;o(O),n(!0),a(-1),g()&&clearTimeout(g());const k=setTimeout(()=>{C(O)},600);p(k)},x=W=>{t.onChange(W),n(!1),o(""),a(-1),g()&&(clearTimeout(g()),p(null))},V=W=>{const z=h();switch(W.key){case"ArrowDown":W.preventDefault(),a(O=>Math.min(O+1,z.length-1));break;case"ArrowUp":W.preventDefault(),a(O=>Math.max(O-1,-1));break;case"Enter":W.preventDefault(),s()>=0&&z[s()]&&x(z[s()]);break;case"Escape":n(!1),o(""),a(-1),g()&&(clearTimeout(g()),p(null));break}},ne=W=>{setTimeout(()=>{n(!1),o(""),a(-1),g()&&(clearTimeout(g()),p(null))},150)},X=()=>r()&&i()?i():t.value?t.value.cid:"";Rn(()=>(C(""),()=>{g()&&clearTimeout(g())}));const Q={position:"relative",width:"100%",...t.style},ee={display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.25rem"},E={"font-size":"0.75rem",color:"var(--text-muted)","margin-bottom":"0.5rem","font-style":"italic"},A={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},T={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},R=W=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:W?"var(--strip-color)":"transparent",color:W?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),_={display:"flex","justify-content":"space-between","align-items":"flex-start"},I={flex:"1"},b={"font-weight":"500","margin-bottom":"0.25rem"},G={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex","flex-direction":"column",gap:"0.125rem"},ie={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},F={padding:"1rem","text-align":"center",color:"var(--text-muted)",display:"flex","align-items":"center","justify-content":"center",gap:"0.5rem"};return(()=>{var W=k8(),z=W.firstChild;return l(W,B(Ge,{get when(){return t.label},get children(){var O=$8();return m(O,ee),l(O,()=>t.label),O}}),z),l(W,B(Ge,{get when(){return t.description},get children(){var O=xp();return m(O,E),l(O,()=>t.description),O}}),z),z.addEventListener("blur",ne),z.$$keydown=V,z.$$click=S,z.$$input=w,l(W,B(Ge,{get when(){return r()},get children(){var O=xp();return l(O,B(Ge,{get when(){return c()},get children(){var k=E8(),re=k.firstChild,$=re.nextSibling;return m(k,F),l($,()=>e("common.searching","Buscando clientes...")),k}}),null),l(O,B(Ge,{get when(){return Te(()=>!c())()&&h().length>0},get fallback(){return Te(()=>!c())()&&(()=>{var k=xp();return m(k,ie),l(k,(()=>{var re=Te(()=>!!i());return()=>re()?e("customer.noCustomersFound","No se encontraron clientes. Puede crear un nuevo cliente llenando el formulario."):e("customer.noCustomersAvailable","No se encontraron clientes previos. Se crear un nuevo cliente.")})()),k})()},get children(){return B(Ut,{get each(){return h()},children:(k,re)=>(()=>{var $=D8(),D=$.firstChild,H=D.firstChild,L=H.firstChild;L.firstChild;var j=L.nextSibling;return $.addEventListener("mouseenter",()=>a(re())),$.$$click=()=>x(k),m(D,_),m(H,I),m(L,b),l(L,()=>k.fullName,null),m(j,G),l(j,B(Ge,{get when(){return k.phoneNumber},get children(){var oe=T8();return oe.firstChild,l(oe,()=>k.phoneNumber,null),oe}}),null),l(j,B(Ge,{get when(){return k.cid},get children(){var oe=N8();return oe.firstChild,l(oe,()=>k.cid,null),oe}}),null),l(j,B(Ge,{get when(){return k.email},get children(){var oe=L8();return oe.firstChild,l(oe,()=>k.email,null),oe}}),null),we(oe=>m($,R(re()===s()),oe)),$})()})}}),null),we(k=>m(O,T,k)),O}}),null),we(O=>{var k=Q,re=A,$=t.placeholder||e("customer.searchPlaceholder","Buscar clientes por nombre, telfono, ID..."),D=t.disabled,H=t.required;return O.e=m(W,k,O.e),O.t=m(z,re,O.t),$!==O.a&&Yt(z,"placeholder",O.a=$),D!==O.o&&(z.disabled=O.o=D),H!==O.i&&(z.required=O.i=H),O},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),we(()=>z.value=X()),W})()};dr(["input","click","keydown"]);var M8=de("<label>"),Ap=de("<div>"),F8=de("<div><span></span><span>"),O8=de("<div><input type=text autocomplete=off>"),B8=de("<span> "),j8=de("<div><div><div><div> </div><div>");const V8=t=>{const{t:e}=er(),[r,n]=$e(!1),[i,o]=$e(""),[s,a]=$e(-1),[c,u]=$e(!1),[h,y]=$e([]),[g,p]=$e(null),C=600,S=async z=>{if(!z.trim()||z.trim().length<6){y([]);return}try{u(!0);const O=await Ai.getShipper(z),k=Object.values(O).map(re=>({id:re.shipperId,name:re.name,dob:re.dob,phoneNumberS:re.phoneNumber}));y(k)}catch(O){console.warn("API search failed, falling back to local search:",O)}finally{u(!1)}},w=z=>{const k=z.target.value;o(k),n(!0),a(-1),g()&&clearTimeout(g());const re=setTimeout(()=>{S(k)},C);p(re)},x=()=>{n(!0),o(""),a(-1),i()||S("")},V=z=>{t.onChange(z),n(!1),o(""),a(-1),g()&&(clearTimeout(g()),p(null))},ne=z=>{const O=h();switch(z.key){case"ArrowDown":z.preventDefault(),a(k=>Math.min(k+1,O.length-1));break;case"ArrowUp":z.preventDefault(),a(k=>Math.max(k-1,-1));break;case"Enter":z.preventDefault(),s()>=0&&O[s()]&&V(O[s()]);break;case"Escape":n(!1),o(""),a(-1),g()&&(clearTimeout(g()),p(null));break}},X=z=>{setTimeout(()=>{n(!1),o(""),a(-1),g()&&(clearTimeout(g()),p(null))},150)},Q=()=>r()&&i()?i():t.value?t.value.name:"";Rn(()=>(S(""),()=>{g()&&clearTimeout(g())}));const ee={position:"relative",width:"100%",...t.style},E={display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.25rem"},A={"font-size":"0.75rem",color:"var(--text-muted)","margin-bottom":"0.5rem","font-style":"italic"},T={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},R={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},_=z=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:z?"var(--strip-color)":"transparent",color:z?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),I={display:"flex","justify-content":"space-between","align-items":"flex-start"},b={flex:"1"},G={"font-weight":"500","margin-bottom":"0.25rem"},ie={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex","flex-direction":"column",gap:"0.125rem"},F={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},W={padding:"1rem","text-align":"center",color:"var(--text-muted)",display:"flex","align-items":"center","justify-content":"center",gap:"0.5rem"};return(()=>{var z=O8(),O=z.firstChild;return l(z,B(Ge,{get when(){return t.label},get children(){var k=M8();return m(k,E),l(k,()=>t.label),k}}),O),l(z,B(Ge,{get when(){return t.description},get children(){var k=Ap();return m(k,A),l(k,()=>t.description),k}}),O),O.addEventListener("blur",X),O.$$keydown=ne,O.$$click=x,O.$$input=w,l(z,B(Ge,{get when(){return r()},get children(){var k=Ap();return l(k,B(Ge,{get when(){return c()},get children(){var re=F8(),$=re.firstChild,D=$.nextSibling;return m(re,W),l(D,()=>e("common.searching","Buscando clientes...")),re}}),null),l(k,B(Ge,{get when(){return Te(()=>!c())()&&h().length>0},get fallback(){return Te(()=>!c())()&&(()=>{var re=Ap();return m(re,F),l(re,(()=>{var $=Te(()=>!!i());return()=>$()?e("customer.noShippersFound","No se encontraron clientes. Puede crear un nuevo cliente llenando el formulario."):e("customer.noShippersAvailable","No se encontraron clientes previos. Se crear un nuevo cliente.")})()),re})()},get children(){return B(Ut,{get each(){return h()},children:(re,$)=>(()=>{var D=j8(),H=D.firstChild,L=H.firstChild,j=L.firstChild;j.firstChild;var oe=j.nextSibling;return D.addEventListener("mouseenter",()=>a($())),D.$$click=()=>V(re),m(H,I),m(L,b),m(j,G),l(j,()=>re.name,null),m(oe,ie),l(oe,B(Ge,{get when(){return re.phoneNumberS},get children(){var K=B8();return K.firstChild,l(K,()=>re.phoneNumberS,null),K}})),we(K=>m(D,_($()===s()),K)),D})()})}}),null),we(re=>m(k,R,re)),k}}),null),we(k=>{var re=ee,$=T,D=t.placeholder||e("customer.searchPlaceholder","Buscar clientes por nombre, telfono, ID..."),H=t.disabled,L=t.required;return k.e=m(z,re,k.e),k.t=m(O,$,k.t),D!==k.a&&Yt(O,"placeholder",k.a=D),H!==k.o&&(O.disabled=k.o=H),L!==k.i&&(O.required=k.i=L),k},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),we(()=>O.value=Q()),z})()};dr(["input","click","keydown"]);var q8=de("<div> "),jh=de("<div>"),z8=de('<div><h3> Informacin del Cliente</h3><div></div><div><div><label>Nombre del Cliente/Empresa *</label><input type=text placeholder="ej., Juan Prez o Empresa ABC"required></div><div><label>Nmero de Telfono Principal</label><input type=tel placeholder="ej., +53-5-123-4567">'),U8=de('<div><h3> Informacin del Destinatario</h3><div></div><div><label>Primer Nombre</label><input type=text placeholder="ej., Juan"></div><div><label>Apellido</label><input type=text placeholder="ej., Prez"></div><div><label>Nmero de Identificacin</label><input type=text placeholder="ej., 12345678901 o A1234567"></div><div><label>Nmero de Pasaporte</label><input type=text placeholder="ej., AB1234567"></div><div><label>Nmero de Telfono Principal</label><input type=tel placeholder="ej., +53-5-123-4567"></div><div><label>Direccin de Entrega/Facturacin</label><textarea placeholder="ej., Calle 23 #456, Apto 4B, Vedado, La Habana, 10400">'),f1=de("<div><strong>Subtotal: $"),H8=de("<div><div><span> Reservas y Servicios</span><button> Agregar Servicio/Reserva"),W8=de("<div><div><span> Productos y Artculos</span></div><div><label>Agregar Productos a la Factura"),G8=de("<span> Sin impuesto"),Y8=de("<div><div>Vista previa del clculo:</div><div>Subtotal: $</div><div> Del Subtotal: $<!>(Total: $<!>)</div><div> Del Total: $<!>(Total: $<!>)"),K8=de("<div><div> Beneficio por Pago en Efectivo:</div><div>Efectivo: $<!> (<!>% del pago)</div><div>Ahorro en impuestos: $</div><div>Impuesto original: $<!>  Impuesto final: $"),J8=de("<div><label><input type=checkbox><span> Exencin de Impuesto por Pago en Efectivo</span></label><div>Los pagos en efectivo estarn exentos de impuestos. Mientras mayor sea el porcentaje pagado en efectivo, mayor ser la exencin."),Q8=de('<div><div><span> Mtodos de Pago</span></div><div>Distribuya el pago total entre los diferentes mtodos de pago disponibles.</div><div><button type=button> Todo Efectivo</button><button type=button title="Pagar todo por Zelle"> Todo Zelle</button><button type=button title="Pagar todo con tarjeta"> Todo Tarjeta</button><button type=button title="Limpiar todos los pagos"> Limpiar</button></div><div><div><label> Efectivo</label><input type=text placeholder=0.00 min=0 step=0.01></div><div><label> Zelle</label><input type=text placeholder=0.00 min=0 step=0.01></div></div><div><label> Tarjeta de Crdito</label><input type=text placeholder=0.00 min=0 step=0.01></div><div><div><div>Total de Pagos: <strong>$</strong></div><div>Balance: <strong>$</strong></div></div><div><div>Total a Pagar: <strong>$</strong></div><div></div></div></div><div><label>Impuesto (%)</label><div>Porcentaje de impuesto. Puede aplicarse sobre el subtotal o como porcentaje del total final.</div><input type=number placeholder=0 min=0 max=99 step=0.01><div><div><label><input type=radio name=taxMethod><span>Del Subtotal (tradicional)</span></label><div>Impuesto = Subtotal  <!>%</div><label><input type=radio name=taxMethod><span>Del Total Final</span></label><div>El impuesto representa el <!>% del total final'),X8=de("<span>(Ahorro: $<!>)"),Z8=de("<div>Impuesto (<!>% <!>): $"),eD=de("<div>Envo: "),tD=de("<div><div>Productos: $</div><div>Reservas: $</div><div>Subtotal: $</div><div>Total: $"),rD=de("<span><span></span>Auto-guardando cambios..."),nD=de("<span><span></span>Guardado: "),iD=de("<button>Limpiar Formulario"),oD=de("<div><div>"),sD=de("<button>"),aD=de("<div><button></button><button> Nueva Factura"),lD=de('<div><h2> Crear Nueva Factura</h2><div><div><div><h3> Informacin de Factura</h3><div><div><label>Nmero de Factura *</label><input type=text></div><div><label>Ubicacin de Tienda *</label></div></div><div><div><label>Mtodo de Envo</label><div>Seleccione el mtodo de transporte para esta orden.</div><select><option value>Seleccionar mtodo...</option><option value=AEREO> Areo (Avin)</option><option value=SEA> Martimo (Barco)</option></select></div><div><label>fecha</label><div>Seleccione una fecha si es diferente al dia de hoy.</div><input type=date></div></div><div><label>Descripcin de Factura</label><textarea placeholder="ej., Venta regular, pedido mayorista, descuento especial aplicado..."></textarea></div><label><input type=checkbox><div><span>Orden de Paquete/Envo</span><div>Marque esto si esta factura incluye servicios de envo o manejo de paquetes.</div></div></label></div></div><div>'),p1=de("<span> ($<!>)"),cD=de("<div>(<!><!>+<!>)"),uD=de("<div><div><button></button></div><div><div><label>Cant (lbs)</label></div><div><label>Precio</label></div><div><label>Arancel</label></div><div>$"),dD=de("<div><div><div><div></div><div></div></div><button></button></div><div><div>$"),hD=de("<input step=0.01>"),fD=de("<div><div><input type=text autocomplete=off><div>");const m1=[" Ropa"," Zapatos"," Ventilador"," tiles del Hogar"," TV"," Telfono Mvil"," Computadora/Laptop"," Audfonos"," Reloj"," Joyera"," Productos de Belleza"," Medicamentos"," Alimentos"," Juguetes"," Libros"," Videojuegos"," Herramientas"," Repuestos de Auto"," Artculos Deportivos"," Instrumentos Musicales"," Electrnicos"," Maletas"," Lentes"," Cables y Accesorios"," Equipos Mdicos"," Materiales de Arte"," Cmaras"," Bateras"," Productos de Limpieza"," Artculos para el Hogar","Transportacion","Cajas","Servicio de Rapeado"],pD={padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--background-color)"},st={container:{padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)"},header:{"font-size":"1.5rem","font-weight":"700",color:"var(--text-primary)","margin-bottom":"1.5rem"},grid:{display:"grid","grid-template-columns":"repeat(auto-fit, minmax(350px, 1fr))",gap:"1.5rem"},section:{background:"var(--background-color)",padding:"1.25rem","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},sectionTitle:{"font-size":"1.125rem","font-weight":"600",color:"var(--text-primary)","margin-bottom":"1rem",display:"flex","align-items":"center",gap:"0.5rem"},formGroup:{"margin-bottom":"1rem"},label:{display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.25rem"},fieldDescription:{"font-size":"0.75rem",color:"var(--text-muted)","margin-bottom":"0.5rem","line-height":"1.4","font-style":"italic"},input:{width:"100%",padding:"0.625rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",background:"var(--surface-color)",transition:"border-color 0.2s",outline:"none"},textarea:{width:"100%",padding:"0.625rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",background:"var(--surface-color)",resize:"vertical","min-height":"60px"},button:{padding:"0.625rem 1.25rem",border:"none","border-radius":"var(--border-radius-sm)","font-size":"0.875rem","font-weight":"500",cursor:"pointer",transition:"all 0.2s",display:"inline-flex","align-items":"center",gap:"0.5rem"},primaryButton:{background:"var(--primary-color)",color:"white"},secondaryButton:{background:"var(--secondary-color)",color:"white"},successButton:{background:"#4CAF50",color:"white"},alert:{padding:"0.75rem 1rem","border-radius":"var(--border-radius-sm)","margin-bottom":"1rem","font-size":"0.875rem",display:"flex","align-items":"center",gap:"0.5rem"},errorAlert:{background:"#ffebee",border:"1px solid #ffcdd2",color:"#d32f2f"},successAlert:{background:"#e8f5e9",border:"1px solid #c8e6c9",color:"#2e7d32"},productWrapItem:{padding:"0.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"0.5rem"},productItem:{display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem","margin-bottom":"0.5rem"},smallInput:{width:"70px",padding:"0.375rem 0.5rem","font-size":"0.8125rem"},removeButton:{background:"none",border:"none",color:"#f44336",cursor:"pointer","font-size":"1.25rem",padding:"0.25rem"},totalSection:{background:"var(--primary-color)",color:"white",padding:"1rem","border-radius":"var(--border-radius-sm)","text-align":"right"},gridTwo:{display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"}},mD=()=>{const{t}=er(),e=Hr.formData,r=U=>Hr.updateForm(U),[n,i]=$e(null),[o,s]=$e(""),[a,c]=$e(""),[u,h]=$e(null);Rn(()=>{console.log("Styled invoice form mounted, loaded data:",e()),Hr.hasData()&&(w("Form data restored from previous session"),setTimeout(()=>w(""),3e3))});const[y,g]=$e(!1),[p,C]=$e(""),[S,w]=$e(""),[x,V]=$e(""),[ne,X]=$e(!1),Q=U=>{if(!U)return"";const ae=lt.getLocationById(U),ue=ae?.code||ae?.name?.substring(0,3).toUpperCase()||"INV",q=new Date().toISOString().slice(0,10).replace(/-/g,"");return`${lS(6)}-${ue}-${q}`};vo(()=>{const U=o();if(U&&!e().invoice.trim()){const ae=Q(U);c(ae),r({invoice:ae})}}),vo(()=>{const U=n();U&&Hr.updateShipperConsignee({name:U.name,firstName:U.firstName||"",lastName:U.lastName||"",phoneNumber:U.phoneNumber||"",cid:U.cid||"",passport:U.passport||"",address:U.address||""})}),vo(()=>{});const ee=U=>{const ae=lt.getProductById(U);if(!ae)return;const ue={id:Date.now().toString(),product:{id:ae.id,code:ae.sku||"",label:ae.name||"",price:ae.unitCost||0},qty:1,salePrice:ae.unitCost||0,total:ae.unitCost||0};Hr.addProduct(ue)},E=U=>{s(U),r({store:U})},A=U=>{i(ae=>({...ae,...U}))},T=U=>{h({name:U?.name}),i(ae=>({...ae,phoneNumberS:U?.phoneNumberS,name:U?.name,dob:U?.dob}))},R=(U,ae,ue)=>{const le=e().products,q=le.findIndex(ce=>ce.id===U);if(q!==-1){const ce={...le[q],[ae]:ue};ce.total=ce.qty*ce.salePrice,Hr.updateProduct(q,ce)}},_=U=>{const ae=e().products.findIndex(ue=>ue.id===U);ae!==-1&&Hr.removeProduct(ae)},I=()=>{const U={id:Date.now().toString(),type:"",qty:1,price:0,arancel:0,total:0};Hr.addReserva(U)},b=(U,ae,ue)=>{const le=e().reservas,q=le.findIndex(ce=>ce.id===U);if(q!==-1){const ce={...le[q],[ae]:ue};(ae==="qty"||ae==="price"||ae==="arancel")&&(ce.total=Number(ce.qty)*Number(ce.price)+Number(ce.arancel)),Hr.updateReserva(q,ce)}},G=U=>{const ae=e().reservas.findIndex(ue=>ue.id===U);ae!==-1&&Hr.removeReserva(ae)},ie=()=>e().products.reduce((U,ae)=>U+ae.total,0),F=()=>e().reservas.reduce((U,ae)=>U+ae.total,0),W=()=>ie()+F(),z=()=>{if(e()?.paymentMethods.taxPercent===0)return 0;if(e()?.paymentMethods.exemptTaxOnCash){const U=re()>0?e().paymentMethods.cash/re():0,ae=Math.min(U,1);let ue;return e()?.paymentMethods.taxOnTotal?ue=W()/(1-e()?.paymentMethods.taxPercent/100)-W():ue=W()*(e()?.paymentMethods.taxPercent/100),ue*(1-ae)}return e()?.paymentMethods.taxOnTotal?W()/(1-e()?.paymentMethods?.taxPercent/100)-W():W()*(e()?.paymentMethods?.taxPercent/100)},O=()=>{if(!e()?.paymentMethods.exemptTaxOnCash||e()?.paymentMethods.taxPercent===0)return 0;const U=re()>0?e().paymentMethods.cash/re():0,ae=Math.min(U,1);let ue;return e()?.paymentMethods.taxOnTotal?ue=W()/(1-e()?.paymentMethods?.taxPercent/100)-W():ue=W()*(e()?.paymentMethods?.taxPercent/100),ue*ae},k=()=>W()+z(),re=()=>{const U=e().paymentMethods;return U.cash+U.zelle+U.creditCard},$=()=>k()-re(),D=(U,ae)=>{Hr.updatePaymentMethods({[U]:ae})},H=(U,ae)=>{Hr.updatePaymentMethods({[U]:ae})},L=U=>{const ae=k();Hr.updatePaymentMethods({cash:U==="cash"?ae:0,zelle:U==="zelle"?ae:0,creditCard:U==="creditCard"?ae:0})},j=()=>{Hr.updatePaymentMethods({cash:0,zelle:0,creditCard:0})},oe=async()=>{g(!0),C(""),w("");try{if(!e().invoice.trim())throw new Error("Nmero de factura es requerido");if(!e().shipper_consignee.name.trim())throw new Error("Nombre del cliente es requerido");if(e().products.length===0&&e().reservas.length===0)throw new Error("Al menos un producto o reserva es requerido");if(Math.round($())>.01)throw new Error(`El total de pagos (${re().toFixed()}) no coincide con el total de la factura (${k().toFixed()})`);const U={...e(),type:"SALES",ssg_inventory_key:`INVOICE-${Date.now()}`,ssg_sorder_key:`SO-${Date.now()}`,createDate:e().createDate||Date.now(),businessId:"YB100423253156428",isCompleted:!0,productSubtotal:ie(),reservaSubtotal:F(),subtotalBeforeTax:W(),taxAmount:z(),taxSavings:O(),total:k(),shippingMethod:e().shippingMethod,taxCalculationMethod:e()?.paymentMethods.taxOnTotal?"total":"subtotal",cashPaymentRatio:re()>0?e().paymentMethods.cash/re():0,paymentMethods:e().paymentMethods};console.log("createInvoice",JSON.stringify(U,null,4));const ae=await Ai.addInventory(U);Ai.addInvoice(ae),V(ae.data),w(" Invoice created successfully! You can now generate a PDF."),Hr.markCompleted(),Z()}catch(U){C(U.message||"Error creating invoice")}finally{g(!1)}},K=async()=>{if(x()){X(!0),C("");try{const{generateEnhancedInvoicePDF:U}=await Ni(async()=>{const{generateEnhancedInvoicePDF:q}=await import("./enhancedInvoicePdfGenerator-Unlnz4KK.js");return{generateEnhancedInvoicePDF:q}},[]);console.log(JSON.stringify(e()));const ue={invoiceId:x(),shippingMethod:e().shippingMethod,taxPercent:e()?.paymentMethods.taxPercent,taxOnTotal:e()?.paymentMethods.taxOnTotal,exemptTaxOnCash:e()?.paymentMethods.exemptTaxOnCash,paymentMethods:e().paymentMethods,productSubtotal:ie(),reservaSubtotal:F(),subtotalBeforeTax:W(),taxAmount:z(),taxSavings:e()?.paymentMethods.exemptTaxOnCash?W()*e()?.paymentMethods.taxPercent/100-z():0,total:k(),cashPaymentRatio:re()>0?e().paymentMethods.cash/re():0};console.log(JSON.stringify(ue));const le=await U({...e(),...ue},"es","modern");w(` PDF generated successfully: ${le}`)}catch(U){C(U.message||"Error generating PDF")}finally{X(!1)}}},Z=()=>{Hr.clearForm(),V(""),w(""),C("")},J=()=>Hr.hasData()&&Hr.isDirty,Y=()=>{J()?confirm("Are you sure you want to clear the form? All unsaved changes will be lost.")&&Z():Z()};return Rn(()=>{}),(()=>{var U=lD(),ae=U.firstChild,ue=ae.nextSibling,le=ue.firstChild,q=le.firstChild,ce=q.firstChild,Se=ce.nextSibling,me=Se.firstChild,Pe=me.firstChild,xe=Pe.nextSibling,he=me.nextSibling,ve=he.firstChild,De=Se.nextSibling,ke=De.firstChild,Ce=ke.firstChild,Le=Ce.nextSibling,Ie=Le.nextSibling,Re=ke.nextSibling,He=Re.firstChild,Me=He.nextSibling,Ze=Me.nextSibling,Ye=De.nextSibling,ut=Ye.firstChild,rt=ut.nextSibling,We=Ye.nextSibling,ct=We.firstChild,pt=ct.nextSibling,_t=pt.firstChild,Et=_t.nextSibling,et=le.nextSibling;return l(U,B(Ge,{get when(){return p()},get children(){var Ue=q8();return Ue.firstChild,l(Ue,p,null),we(ot=>m(Ue,{...st.alert,...st.errorAlert},ot)),Ue}}),ue),l(U,B(Ge,{get when(){return S()},get children(){var Ue=jh();return l(Ue,S),we(ot=>m(Ue,{...st.alert,...st.successAlert},ot)),Ue}}),ue),xe.$$input=Ue=>r({invoice:Ue.target.value}),l(he,B(Ou,{get value(){return o()},onChange:E,get placeholder(){return t("inventory.selectStoreLocation","Buscar y seleccionar ubicacin de tienda...")},filterType:"store",required:!0}),null),Ie.addEventListener("change",Ue=>r({shippingMethod:Ue.currentTarget.value})),Ze.addEventListener("change",Ue=>r({createDate:Ue.currentTarget.value})),m(Ze,pD),rt.$$input=Ue=>r({description:Ue.target.value}),ct.addEventListener("change",Ue=>r({packagesOrder:Ue.target.checked})),l(le,B(Ge,{get when(){return Te(()=>!!(e().shippingMethod&&e().invoice))()&&o()},get children(){return[(()=>{var Ue=z8(),ot=Ue.firstChild,Xe=ot.nextSibling,at=Xe.nextSibling,St=at.firstChild,$t=St.firstChild,qt=$t.nextSibling,Gt=St.nextSibling,ht=Gt.firstChild,Kt=ht.nextSibling;return l(Xe,B(V8,{get value(){return u()},onChange:T,label:"Buscar Cliente Existente",description:"Busque clientes existentes por nombre, telfono o ID. Si no se encuentra, complete el formulario a continuacin para crear un nuevo cliente.",placeholder:"Escriba nombre del cliente, nmero de telfono o ID para buscar..."})),qt.$$input=Rt=>Hr.updateShipperConsignee({name:Rt.target.value}),Kt.$$input=Rt=>Hr.updateShipperConsignee({phoneNumber:Rt.target.value}),we(Rt=>{var Qt={...st.section,"margin-top":"1rem"},sr=st.sectionTitle,mt=st.formGroup,At=st.gridTwo,Ot=st.formGroup,Jt=st.label,Zt=st.input,Ht=st.formGroup,tt=st.label,jt=st.input;return Rt.e=m(Ue,Qt,Rt.e),Rt.t=m(ot,sr,Rt.t),Rt.a=m(Xe,mt,Rt.a),Rt.o=m(at,At,Rt.o),Rt.i=m(St,Ot,Rt.i),Rt.n=m($t,Jt,Rt.n),Rt.s=m(qt,Zt,Rt.s),Rt.h=m(Gt,Ht,Rt.h),Rt.r=m(ht,tt,Rt.r),Rt.d=m(Kt,jt,Rt.d),Rt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),we(()=>qt.value=e().shipper_consignee.name),we(()=>Kt.value=e().shipper_consignee.phoneNumber||""),Ue})(),(()=>{var Ue=U8(),ot=Ue.firstChild,Xe=ot.nextSibling,at=Xe.nextSibling,St=at.firstChild,$t=St.nextSibling,qt=at.nextSibling,Gt=qt.firstChild,ht=Gt.nextSibling,Kt=qt.nextSibling,Rt=Kt.firstChild,Qt=Rt.nextSibling,sr=Kt.nextSibling,mt=sr.firstChild,At=mt.nextSibling,Ot=sr.nextSibling,Jt=Ot.firstChild,Zt=Jt.nextSibling,Ht=Ot.nextSibling,tt=Ht.firstChild,jt=tt.nextSibling;return l(Xe,B(R8,{get value(){return n()},onChange:A,label:"Buscar Destinatario Existente",description:"Busque Destinatario existentes por telfono o ID. Si no se encuentra, complete el formulario a continuacin para crear un nuevo destinatario.",placeholder:"Escriba nombre del destinatario, nmero de telfono o ID para buscar..."})),$t.$$input=yt=>Hr.updateShipperConsignee({firstName:yt.target.value}),ht.$$input=yt=>Hr.updateShipperConsignee({lastName:yt.target.value}),Qt.$$input=yt=>Hr.updateShipperConsignee({cid:yt.target.value}),At.$$input=yt=>Hr.updateShipperConsignee({passport:yt.target.value}),Zt.$$input=yt=>Hr.updateShipperConsignee({phoneNumber:yt.target.value}),jt.$$input=yt=>Hr.updateShipperConsignee({address:yt.target.value}),we(yt=>{var ar={...st.section,"margin-top":"1rem"},Wr=st.sectionTitle,pr=st.formGroup,wr=st.formGroup,$r=st.label,lr=st.input,Br=st.formGroup,tn=st.label,kt=st.input,Sr=st.formGroup,Cr=st.label,jr=st.input,kr=st.formGroup,Yr=st.label,rn=st.input,yr=st.formGroup,ln=st.label,_n=st.input,Ir=st.formGroup,wn=st.label,Cn=st.textarea;return yt.e=m(Ue,ar,yt.e),yt.t=m(ot,Wr,yt.t),yt.a=m(Xe,pr,yt.a),yt.o=m(at,wr,yt.o),yt.i=m(St,$r,yt.i),yt.n=m($t,lr,yt.n),yt.s=m(qt,Br,yt.s),yt.h=m(Gt,tn,yt.h),yt.r=m(ht,kt,yt.r),yt.d=m(Kt,Sr,yt.d),yt.l=m(Rt,Cr,yt.l),yt.u=m(Qt,jr,yt.u),yt.c=m(sr,kr,yt.c),yt.w=m(mt,Yr,yt.w),yt.m=m(At,rn,yt.m),yt.f=m(Ot,yr,yt.f),yt.y=m(Jt,ln,yt.y),yt.g=m(Zt,_n,yt.g),yt.p=m(Ht,Ir,yt.p),yt.b=m(tt,wn,yt.b),yt.T=m(jt,Cn,yt.T),yt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),we(()=>$t.value=e().shipper_consignee.firstName||""),we(()=>ht.value=e().shipper_consignee.lastName||""),we(()=>Qt.value=e().shipper_consignee.cid||""),we(()=>At.value=e().shipper_consignee.passport||""),we(()=>Zt.value=e().shipper_consignee.phoneNumber||""),we(()=>jt.value=e().shipper_consignee.address||""),Ue})()]}}),null),l(et,B(Ge,{get when(){return Te(()=>!!(e().shippingMethod&&e().invoice&&e().shipper_consignee?.cid))()&&e().shipper_consignee?.name},get children(){return[(()=>{var Ue=H8(),ot=Ue.firstChild,Xe=ot.firstChild,at=Xe.nextSibling;return at.$$click=I,l(Ue,B(Ut,{get each(){return e().reservas},children:St=>B(yD,{updateReserva:b,reserva:St,removeReserva:G})}),null),l(Ue,B(Ge,{get when(){return e().reservas.length>0},get children(){var St=f1(),$t=St.firstChild;return $t.firstChild,St.style.setProperty("margin-top","0.75rem"),St.style.setProperty("padding-top","0.75rem"),St.style.setProperty("border-top","1px solid var(--border-color)"),St.style.setProperty("text-align","right"),l($t,()=>F().toFixed(),null),St}}),null),we(St=>{var $t={...st.section,"margin-top":"1rem"},qt={...st.sectionTitle,"justify-content":"space-between"},Gt={...st.button,...st.successButton};return St.e=m(Ue,$t,St.e),St.t=m(ot,qt,St.t),St.a=m(at,Gt,St.a),St},{e:void 0,t:void 0,a:void 0}),Ue})(),(()=>{var Ue=W8(),ot=Ue.firstChild,Xe=ot.nextSibling,at=Xe.firstChild;return l(Xe,B(I8,{value:"",onChange:ee,get placeholder(){return t("inventory.searchProductsToAdd","Buscar productos por nombre, SKU o categora para agregar a la factura...")},searchDelay:300,maxResults:15}),null),l(Ue,B(Ut,{get each(){return e().products},children:St=>B(gD,{product:St,updateProduct:R,removeProduct:_})}),null),l(Ue,B(Ge,{get when(){return e().products.length>0},get children(){var St=f1(),$t=St.firstChild;return $t.firstChild,St.style.setProperty("margin-top","0.75rem"),St.style.setProperty("padding-top","0.75rem"),St.style.setProperty("border-top","1px solid var(--border-color)"),St.style.setProperty("text-align","right"),l($t,()=>ie().toFixed(),null),St}}),null),we(St=>{var $t={...st.section,"margin-top":"1rem"},qt={...st.sectionTitle,"justify-content":"space-between"},Gt=st.formGroup,ht=st.label;return St.e=m(Ue,$t,St.e),St.t=m(ot,qt,St.t),St.a=m(Xe,Gt,St.a),St.o=m(at,ht,St.o),St},{e:void 0,t:void 0,a:void 0,o:void 0}),Ue})(),(()=>{var Ue=Q8(),ot=Ue.firstChild,Xe=ot.nextSibling,at=Xe.nextSibling,St=at.firstChild;St.firstChild;var $t=St.nextSibling,qt=$t.nextSibling,Gt=qt.nextSibling,ht=at.nextSibling,Kt=ht.firstChild,Rt=Kt.firstChild,Qt=Rt.nextSibling,sr=Kt.nextSibling,mt=sr.firstChild,At=mt.nextSibling,Ot=ht.nextSibling,Jt=Ot.firstChild,Zt=Jt.nextSibling,Ht=Ot.nextSibling,tt=Ht.firstChild,jt=tt.firstChild,yt=jt.firstChild,ar=yt.nextSibling;ar.firstChild;var Wr=jt.nextSibling,pr=Wr.firstChild,wr=pr.nextSibling;wr.firstChild;var $r=tt.nextSibling,lr=$r.firstChild,Br=lr.firstChild,tn=Br.nextSibling;tn.firstChild;var kt=lr.nextSibling,Sr=Ht.nextSibling,Cr=Sr.firstChild,jr=Cr.nextSibling,kr=jr.nextSibling,Yr=kr.nextSibling,rn=Yr.firstChild,yr=rn.firstChild,ln=yr.firstChild,_n=yr.nextSibling,Ir=_n.firstChild,wn=Ir.nextSibling;wn.nextSibling;var Cn=_n.nextSibling,Li=Cn.firstChild,tr=Cn.nextSibling,Tr=tr.firstChild,qr=Tr.nextSibling;return qr.nextSibling,at.style.setProperty("display","flex"),at.style.setProperty("gap","0.5rem"),at.style.setProperty("margin-bottom","1rem"),at.style.setProperty("flex-wrap","wrap"),St.$$click=()=>L("cash"),l(St,B(Ge,{get when(){return Te(()=>!!e()?.paymentMethods.exemptTaxOnCash)()&&e()?.paymentMethods.taxPercent>0},get children(){var bt=G8();return bt.style.setProperty("font-size","0.6rem"),bt.style.setProperty("display","block"),bt.style.setProperty("line-height","1"),bt}}),null),$t.$$click=()=>L("zelle"),qt.$$click=()=>L("creditCard"),Gt.$$click=j,Qt.$$input=bt=>D("cash",parseFloat(bt.target.value)||0),At.$$input=bt=>D("zelle",parseFloat(bt.target.value)||0),Zt.$$input=bt=>D("creditCard",parseFloat(bt.target.value)||0),Ht.style.setProperty("margin-top","1rem"),Ht.style.setProperty("padding-top","1rem"),Ht.style.setProperty("border-top","1px solid var(--border-color)"),Ht.style.setProperty("display","grid"),Ht.style.setProperty("grid-template-columns","1fr 1fr"),Ht.style.setProperty("gap","1rem"),Ht.style.setProperty("font-size","0.875rem"),l(ar,()=>re().toFixed(),null),l(wr,()=>$().toFixed(),null),$r.style.setProperty("text-align","right"),l(tn,()=>k().toFixed(),null),kt.style.setProperty("font-weight","500"),l(kt,(()=>{var bt=Te(()=>Math.round($())===0);return()=>bt()?" Pagado Completo":$()>0?"Falta Pagar":"Sobrepago"})()),l(Sr,B(Ge,{get when(){return Te(()=>e()?.paymentMethods.taxPercent>0)()&&W()>0},get children(){var bt=Y8(),rr=bt.firstChild,fr=rr.nextSibling;fr.firstChild;var Gr=fr.nextSibling,Fr=Gr.firstChild,pn=Fr.nextSibling,Pr=pn.nextSibling,Yn=Pr.nextSibling;Yn.nextSibling;var Pn=Gr.nextSibling,Zn=Pn.firstChild,Wi=Zn.nextSibling,hi=Wi.nextSibling,ei=hi.nextSibling;return ei.nextSibling,bt.style.setProperty("margin-top","0.5rem"),bt.style.setProperty("padding","0.5rem"),bt.style.setProperty("background","var(--strip-color)"),bt.style.setProperty("border-radius","var(--border-radius-sm)"),bt.style.setProperty("font-size","0.75rem"),bt.style.setProperty("border","1px solid var(--border-color)"),rr.style.setProperty("font-weight","500"),rr.style.setProperty("margin-bottom","0.25rem"),l(fr,()=>W().toFixed(2),null),l(Gr,()=>(W()*e()?.paymentMethods?.taxPercent/100).toFixed(2),pn),l(Gr,()=>(W()+W()*e()?.paymentMethods?.taxPercent/100).toFixed(2),Yn),l(Pn,()=>z().toFixed(2),Wi),l(Pn,()=>k().toFixed(2),ei),we(In=>{var ti=e()?.paymentMethods?.taxOnTotal?"var(--primary-color)":"var(--text-muted)",Di=e()?.paymentMethods?.taxOnTotal?"var(--text-muted)":"var(--primary-color)";return ti!==In.e&&((In.e=ti)!=null?Gr.style.setProperty("color",ti):Gr.style.removeProperty("color")),Di!==In.t&&((In.t=Di)!=null?Pn.style.setProperty("color",Di):Pn.style.removeProperty("color")),In},{e:void 0,t:void 0}),bt}}),kr),kr.$$input=bt=>D("taxPercent",parseFloat(bt.target.value)||0),Yr.style.setProperty("margin-top","0.5rem"),Yr.style.setProperty("align-items","center"),Yr.style.setProperty("gap","0.5rem"),rn.style.setProperty("margin-top","0.5rem"),ln.addEventListener("change",()=>D("taxOnTotal",!1)),l(_n,()=>e()?.paymentMethods?.taxPercent,wn),l(_n,(()=>{var bt=Te(()=>e()?.paymentMethods?.taxPercent>0&&!e()?.paymentMethods?.taxOnTotal);return()=>bt()&&(()=>{var rr=p1(),fr=rr.firstChild,Gr=fr.nextSibling;return Gr.nextSibling,rr.style.setProperty("color","var(--primary-color)"),l(rr,()=>(W()*e()?.paymentMethods?.taxPercent/100).toFixed(2),Gr),rr})()})(),null),Li.addEventListener("change",()=>D("taxOnTotal",!0)),l(tr,()=>e()?.paymentMethods?.taxPercent,qr),l(tr,(()=>{var bt=Te(()=>!!(e()?.paymentMethods?.taxPercent>0&&e()?.paymentMethods?.taxOnTotal));return()=>bt()&&(()=>{var rr=p1(),fr=rr.firstChild,Gr=fr.nextSibling;return Gr.nextSibling,rr.style.setProperty("color","var(--primary-color)"),l(rr,()=>z().toFixed(2),Gr),rr})()})(),null),l(Yr,B(Ge,{get when(){return e()?.paymentMethods?.taxPercent>0},get children(){var bt=J8(),rr=bt.firstChild,fr=rr.firstChild,Gr=rr.nextSibling;return bt.style.setProperty("margin-top","1rem"),bt.style.setProperty("padding-top","1rem"),bt.style.setProperty("border-top","1px solid var(--border-color)"),fr.addEventListener("change",Fr=>H("exemptTaxOnCash",Fr.target.checked)),l(bt,B(Ge,{get when(){return Te(()=>!!e()?.paymentMethods?.exemptTaxOnCash)()&&re()>0},get children(){var Fr=K8(),pn=Fr.firstChild,Pr=pn.nextSibling,Yn=Pr.firstChild,Pn=Yn.nextSibling,Zn=Pn.nextSibling,Wi=Zn.nextSibling;Wi.nextSibling;var hi=Pr.nextSibling;hi.firstChild;var ei=hi.nextSibling,In=ei.firstChild,ti=In.nextSibling;return ti.nextSibling,Fr.style.setProperty("margin-top","0.5rem"),Fr.style.setProperty("padding","0.75rem"),Fr.style.setProperty("background","#e8f5e9"),Fr.style.setProperty("border-radius","var(--border-radius-sm)"),Fr.style.setProperty("font-size","0.875rem"),Fr.style.setProperty("border","1px solid #c8e6c9"),pn.style.setProperty("font-weight","500"),pn.style.setProperty("color","#2e7d32"),pn.style.setProperty("margin-bottom","0.5rem"),l(Pr,()=>e().paymentMethods.cash.toFixed(2),Pn),l(Pr,()=>(e().paymentMethods.cash/re()*100).toFixed(1),Wi),hi.style.setProperty("color","#4CAF50"),hi.style.setProperty("font-weight","500"),l(hi,()=>O().toFixed(2),null),ei.style.setProperty("font-size","0.8rem"),ei.style.setProperty("color","#666"),ei.style.setProperty("margin-top","0.25rem"),l(ei,()=>(z()+O()).toFixed(2),ti),l(ei,()=>z().toFixed(2),null),Fr}}),null),we(Fr=>{var pn={...st.label,display:"flex","align-items":"center",gap:"0.5rem","margin-bottom":"0.5rem"},Pr=st.fieldDescription;return Fr.e=m(rr,pn,Fr.e),Fr.t=m(Gr,Pr,Fr.t),Fr},{e:void 0,t:void 0}),we(()=>fr.checked=e()?.paymentMethods?.exemptTaxOnCash),bt}}),null),we(bt=>{var rr={...st.section,"margin-top":"1rem"},fr=st.sectionTitle,Gr=st.fieldDescription,Fr={...st.button,...e()?.paymentMethods.exemptTaxOnCash&&e()?.paymentMethods.taxPercent>0?{background:"#4CAF50",color:"white"}:st.secondaryButton,"font-size":"0.75rem",padding:"0.5rem 0.75rem",position:"relative"},pn=e()?.paymentMethods.exemptTaxOnCash&&e()?.paymentMethods.taxPercent>0?`Pagar todo en efectivo (Ahorro: $${(W()*e()?.paymentMethods.taxPercent/100).toFixed(2)})`:"Pagar todo en efectivo",Pr={...st.button,...st.secondaryButton,"font-size":"0.75rem",padding:"0.5rem 0.75rem"},Yn={...st.button,...st.secondaryButton,"font-size":"0.75rem",padding:"0.5rem 0.75rem"},Pn={...st.button,background:"#f44336",color:"white","font-size":"0.75rem",padding:"0.5rem 0.75rem"},Zn=st.gridTwo,Wi=st.formGroup,hi=st.label,ei=st.input,In=st.formGroup,ti=st.label,Di=st.input,no=st.formGroup,cn=st.label,js=st.input,bo=parseFloat($().toFixed())===0?"#4CAF50":$()>0?"#f44336":"#FF9800",nr=parseFloat($().toFixed())===0?"#4CAF50":"#f44336",io=st.formGroup,qa=st.label,Ri=st.fieldDescription,Vs=st.input,Ii={...st.label,display:"flex","align-items":"center",gap:"0.5rem","font-size":"0.8rem","margin-bottom":"0.25rem"},Oo={...st.fieldDescription,"margin-left":"1.5rem","margin-bottom":"0.5rem"},cs={...st.label,display:"flex","align-items":"center",gap:"0.5rem","font-size":"0.8rem","margin-bottom":"0.25rem"},Bo={...st.fieldDescription,"margin-left":"1.5rem"};return bt.e=m(Ue,rr,bt.e),bt.t=m(ot,fr,bt.t),bt.a=m(Xe,Gr,bt.a),bt.o=m(St,Fr,bt.o),pn!==bt.i&&Yt(St,"title",bt.i=pn),bt.n=m($t,Pr,bt.n),bt.s=m(qt,Yn,bt.s),bt.h=m(Gt,Pn,bt.h),bt.r=m(ht,Zn,bt.r),bt.d=m(Kt,Wi,bt.d),bt.l=m(Rt,hi,bt.l),bt.u=m(Qt,ei,bt.u),bt.c=m(sr,In,bt.c),bt.w=m(mt,ti,bt.w),bt.m=m(At,Di,bt.m),bt.f=m(Ot,no,bt.f),bt.y=m(Jt,cn,bt.y),bt.g=m(Zt,js,bt.g),bo!==bt.p&&((bt.p=bo)!=null?Wr.style.setProperty("color",bo):Wr.style.removeProperty("color")),nr!==bt.b&&((bt.b=nr)!=null?kt.style.setProperty("color",nr):kt.style.removeProperty("color")),bt.T=m(Sr,io,bt.T),bt.A=m(Cr,qa,bt.A),bt.O=m(jr,Ri,bt.O),bt.I=m(kr,Vs,bt.I),bt.S=m(yr,Ii,bt.S),bt.W=m(_n,Oo,bt.W),bt.C=m(Cn,cs,bt.C),bt.B=m(tr,Bo,bt.B),bt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),we(()=>Qt.value=e().paymentMethods.cash),we(()=>At.value=e().paymentMethods.zelle),we(()=>Zt.value=e().paymentMethods.creditCard),we(()=>kr.value=e()?.paymentMethods?.taxPercent),we(()=>ln.checked=!e()?.paymentMethods?.taxOnTotal),we(()=>Li.checked=e()?.paymentMethods?.taxOnTotal),Ue})(),(()=>{var Ue=tD(),ot=Ue.firstChild;ot.firstChild;var Xe=ot.nextSibling;Xe.firstChild;var at=Xe.nextSibling;at.firstChild;var St=at.nextSibling;return St.firstChild,ot.style.setProperty("font-size","0.875rem"),ot.style.setProperty("opacity","0.9"),l(ot,()=>ie().toFixed(),null),Xe.style.setProperty("font-size","0.875rem"),Xe.style.setProperty("opacity","0.9"),l(Xe,()=>F().toFixed(),null),at.style.setProperty("font-size","0.875rem"),at.style.setProperty("opacity","0.9"),at.style.setProperty("border-top","1px solid rgba(255,255,255,0.2)"),at.style.setProperty("padding-top","0.5rem"),at.style.setProperty("margin-top","0.5rem"),l(at,()=>W().toFixed(2),null),l(Ue,B(Ge,{get when(){return e()?.paymentMethods?.taxPercent>0},get children(){var $t=Z8(),qt=$t.firstChild,Gt=qt.nextSibling,ht=Gt.nextSibling,Kt=ht.nextSibling;return Kt.nextSibling,$t.style.setProperty("font-size","0.875rem"),$t.style.setProperty("opacity","0.9"),l($t,()=>e()?.paymentMethods?.taxPercent,Gt),l($t,()=>e()?.paymentMethods?.taxOnTotal?"del total":"del subtotal",Kt),l($t,()=>z().toFixed(2),null),l($t,B(Ge,{get when(){return Te(()=>!!e()?.paymentMethods?.exemptTaxOnCash)()&&O()>0},get children(){var Rt=X8(),Qt=Rt.firstChild,sr=Qt.nextSibling;return sr.nextSibling,Rt.style.setProperty("color","#4CAF50"),Rt.style.setProperty("margin-left","0.5rem"),l(Rt,()=>O().toFixed(2),sr),Rt}}),null),$t}}),St),l(Ue,B(Ge,{get when(){return e().shippingMethod},get children(){var $t=eD();return $t.firstChild,$t.style.setProperty("font-size","0.875rem"),$t.style.setProperty("opacity","0.9"),l($t,()=>e().shippingMethod==="aereo"?" Areo":" Martimo",null),$t}}),St),St.style.setProperty("font-size","1.5rem"),St.style.setProperty("font-weight","700"),St.style.setProperty("margin-top","0.5rem"),St.style.setProperty("border-top","1px solid rgba(255,255,255,0.3)"),St.style.setProperty("padding-top","0.5rem"),l(St,()=>k().toFixed(0),null),we($t=>m(Ue,st.totalSection,$t)),Ue})(),B(Ge,{get when(){return Hr.isDirty||Hr.lastSaved},get children(){var Ue=oD(),ot=Ue.firstChild;return Ue.style.setProperty("margin-top","1rem"),Ue.style.setProperty("background","rgba(76, 175, 80, 0.1)"),Ue.style.setProperty("border","1px solid rgba(76, 175, 80, 0.3)"),Ue.style.setProperty("border-radius","var(--border-radius-sm)"),Ue.style.setProperty("padding","0.75rem"),ot.style.setProperty("display","flex"),ot.style.setProperty("align-items","center"),ot.style.setProperty("justify-content","space-between"),ot.style.setProperty("font-size","0.875rem"),l(ot,B(Ge,{get when(){return Hr.isDirty},get children(){var Xe=rD(),at=Xe.firstChild;return Xe.style.setProperty("color","#4CAF50"),Xe.style.setProperty("display","flex"),Xe.style.setProperty("align-items","center"),Xe.style.setProperty("gap","0.5rem"),at.style.setProperty("width","8px"),at.style.setProperty("height","8px"),at.style.setProperty("background","#4CAF50"),at.style.setProperty("border-radius","50%"),at.style.setProperty("display","inline-block"),at.style.setProperty("animation","pulse 2s infinite"),Xe}}),null),l(ot,B(Ge,{get when(){return!Hr.isDirty&&Hr.lastSaved},get children(){var Xe=nD(),at=Xe.firstChild;return at.nextSibling,Xe.style.setProperty("color","#4CAF50"),Xe.style.setProperty("display","flex"),Xe.style.setProperty("align-items","center"),Xe.style.setProperty("gap","0.5rem"),at.style.setProperty("width","8px"),at.style.setProperty("height","8px"),at.style.setProperty("background","#4CAF50"),at.style.setProperty("border-radius","50%"),at.style.setProperty("display","inline-block"),l(Xe,()=>Hr.lastSaved?.toLocaleTimeString(),null),Xe}}),null),l(ot,B(Ge,{get when(){return J()},get children(){var Xe=iD();return Xe.$$click=Y,Xe.style.setProperty("background","none"),Xe.style.setProperty("border","none"),Xe.style.setProperty("color","#f44336"),Xe.style.setProperty("cursor","pointer"),Xe.style.setProperty("font-size","0.75rem"),Xe.style.setProperty("text-decoration","underline"),Xe}}),null),Ue}}),(()=>{var Ue=jh();return Ue.style.setProperty("margin-top","1rem"),l(Ue,B(Ge,{get when(){return!x()},get children(){var ot=sD();return ot.$$click=oe,l(ot,()=>y()?" Creando Factura...":" Crear Factura"),we(Xe=>{var at=y()||!e().invoice.trim()||!e().shipper_consignee.name.trim()||Math.round($())>.01,St={...st.button,...st.primaryButton,width:"100%","justify-content":"center",padding:"0.875rem","font-size":"1rem",opacity:y()||!e().invoice.trim()||!e().shipper_consignee.name.trim()||Math.round($())>.01?"0.6":"1"},$t=e().invoice.trim()?e().shipper_consignee.name.trim()?Math.abs($())>.01?`El balance de pago debe ser $0.00 (actual: $${$().toFixed(2)})`:"Crear esta factura":"Por favor ingrese el nombre del cliente":"Por favor ingrese un nmero de factura";return at!==Xe.e&&(ot.disabled=Xe.e=at),Xe.t=m(ot,St,Xe.t),$t!==Xe.a&&Yt(ot,"title",Xe.a=$t),Xe},{e:void 0,t:void 0,a:void 0}),ot}}),null),l(Ue,B(Ge,{get when(){return x()},get children(){var ot=aD(),Xe=ot.firstChild,at=Xe.nextSibling;return ot.style.setProperty("display","grid"),ot.style.setProperty("grid-template-columns","1fr 1fr"),ot.style.setProperty("gap","0.75rem"),Xe.$$click=K,l(Xe,()=>ne()?" Generando...":" Generar PDF"),at.$$click=Y,we(St=>{var $t=ne(),qt={...st.button,...st.successButton,"justify-content":"center",opacity:ne()?"0.6":"1"},Gt={...st.button,...st.secondaryButton,"justify-content":"center"};return $t!==St.e&&(Xe.disabled=St.e=$t),St.t=m(Xe,qt,St.t),St.a=m(at,Gt,St.a),St},{e:void 0,t:void 0,a:void 0}),ot}}),null),Ue})()]}})),we(Ue=>{var ot=st.container,Xe=st.header,at=st.grid,St=st.section,$t=st.sectionTitle,qt=st.gridTwo,Gt=st.formGroup,ht=st.label,Kt=st.input,Rt=a()||"INV-20241201-1234",Qt=st.formGroup,sr=st.label,mt=st.gridTwo,At=st.formGroup,Ot=st.label,Jt=st.fieldDescription,Zt=st.input,Ht=st.formGroup,tt=st.label,jt=st.fieldDescription,yt=st.formGroup,ar=st.label,Wr=st.textarea,pr={...st.label,display:"flex","align-items":"center",gap:"0.5rem"},wr=st.fieldDescription;return Ue.e=m(U,ot,Ue.e),Ue.t=m(ae,Xe,Ue.t),Ue.a=m(ue,at,Ue.a),Ue.o=m(q,St,Ue.o),Ue.i=m(ce,$t,Ue.i),Ue.n=m(Se,qt,Ue.n),Ue.s=m(me,Gt,Ue.s),Ue.h=m(Pe,ht,Ue.h),Ue.r=m(xe,Kt,Ue.r),Rt!==Ue.d&&Yt(xe,"placeholder",Ue.d=Rt),Ue.l=m(he,Qt,Ue.l),Ue.u=m(ve,sr,Ue.u),Ue.c=m(De,mt,Ue.c),Ue.w=m(ke,At,Ue.w),Ue.m=m(Ce,Ot,Ue.m),Ue.f=m(Le,Jt,Ue.f),Ue.y=m(Ie,Zt,Ue.y),Ue.g=m(Re,Ht,Ue.g),Ue.p=m(He,tt,Ue.p),Ue.b=m(Me,jt,Ue.b),Ue.T=m(Ye,yt,Ue.T),Ue.A=m(ut,ar,Ue.A),Ue.O=m(rt,Wr,Ue.O),Ue.I=m(We,pr,Ue.I),Ue.S=m(Et,wr,Ue.S),Ue},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0}),we(()=>xe.value=e().invoice),we(()=>Ie.value=e().shippingMethod),we(()=>Ze.value=e().createDate),we(()=>rt.value=e().description),we(()=>ct.checked=e().packagesOrder),U})()},yD=t=>{let{reserva:e,updateReserva:r,removeReserva:n}=t;return(()=>{var i=uD(),o=i.firstChild,s=o.firstChild,a=o.nextSibling,c=a.firstChild,u=c.firstChild,h=c.nextSibling,y=h.firstChild,g=h.nextSibling,p=g.firstChild,C=g.nextSibling;return C.firstChild,l(o,B(vD,{get value(){return e.type},onChange:S=>r(e.id,"type",S),placeholder:"ej., Ropa, Zapatos, TV, tiles del Hogar...",width:"80%",index:1}),s),s.$$click=()=>n(e.id),l(c,B(Pu,{type:"number",get value(){return e.qty},update:S=>r(e.id,"qty",parseFloat(S)||0),get style(){return{...st.input,...st.smallInput,width:"60px"}},placeholder:"Cant",min:"1",step:"0.01",index:2}),null),l(h,B(Pu,{type:"number",get value(){return e.price},update:S=>r(e.id,"price",parseFloat(S)||0),get style(){return{...st.input,...st.smallInput}},placeholder:"Precio",step:"0.01",index:3}),null),l(g,B(Pu,{type:"number",get value(){return e.arancel},update:S=>r(e.id,"arancel",parseFloat(S)||0),get style(){return{...st.input,...st.smallInput}},placeholder:"Arancel",step:"0.01",index:4}),null),C.style.setProperty("width","80px"),C.style.setProperty("text-align","right"),C.style.setProperty("font-weight","500"),l(C,()=>e.total?.toFixed(2)||"0.00",null),l(C,B(Ge,{get when(){return!1},get children(){var S=cD(),w=S.firstChild,x=w.nextSibling,V=x.nextSibling,ne=V.nextSibling,X=ne.nextSibling,Q=X.nextSibling;return Q.nextSibling,S.style.setProperty("font-size","0.6rem"),S.style.setProperty("color","var(--text-muted)"),l(S,()=>e.qty,x),l(S,()=>e.price,ne),l(S,()=>e.arancel,Q),S}}),null),we(S=>{var w=st.productWrapItem,x={...st.productItem,"justify-content":"space-around"},V=st.removeButton,ne=st.productItem,X=st.formGroup,Q=st.label,ee=st.formGroup,E=st.label,A=st.formGroup,T=st.label;return S.e=m(i,w,S.e),S.t=m(o,x,S.t),S.a=m(s,V,S.a),S.o=m(a,ne,S.o),S.i=m(c,X,S.i),S.n=m(u,Q,S.n),S.s=m(h,ee,S.s),S.h=m(y,E,S.h),S.r=m(g,A,S.r),S.d=m(p,T,S.d),S},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),i})()},gD=t=>{let{product:e,updateProduct:r,removeProduct:n}=t;return(()=>{var i=dD(),o=i.firstChild,s=o.firstChild,a=s.firstChild,c=a.nextSibling,u=s.nextSibling,h=o.nextSibling,y=h.firstChild;return y.firstChild,s.style.setProperty("flex","1"),a.style.setProperty("font-weight","500"),a.style.setProperty("font-size","0.875rem"),l(a,()=>e?.product.label),c.style.setProperty("font-size","0.75rem"),c.style.setProperty("color","var(--text-muted)"),l(c,()=>e?.product.code),u.$$click=()=>n(e?.id),l(h,B(Pu,{type:"number",get value(){return e?.qty},placeholder:"Cant",update:g=>r(e?.id,"qty",parseFloat(g)||0)}),y),l(h,B(Pu,{type:"number",get value(){return e?.salePrice},placeholder:"Precio",update:g=>r(e?.id,"salePrice",parseFloat(g)||0)}),y),y.style.setProperty("width","80px"),y.style.setProperty("text-align","right"),y.style.setProperty("font-weight","500"),l(y,()=>e?.total.toFixed(2),null),we(g=>{var p=st.productWrapItem,C=st.productItem,S=st.removeButton,w=st.productItem;return g.e=m(i,p,g.e),g.t=m(o,C,g.t),g.a=m(u,S,g.a),g.o=m(h,w,g.o),g},{e:void 0,t:void 0,a:void 0,o:void 0}),i})()},Pu=t=>{const[e,r]=$e("");Rn(()=>{t?.value!==void 0&&r(t.value.toString())});const n=o=>{(o.key==="Enter"||o.key==="Escape"||o.key==="Tab")&&t.update&&uu(e())&&t.update(e())},i=()=>{t.update&&uu(e())&&t.update(e())};return(()=>{var o=hD();return o.addEventListener("blur",i),o.$$keydown=n,o.$$input=s=>r(s.target.value),we(s=>{var a=t?.type,c={...st.input,...st.smallInput,width:t?.width||"90px"},u=t.placeholder,h=t.title,y=t?.index;return a!==s.e&&Yt(o,"type",s.e=a),s.t=m(o,c,s.t),u!==s.a&&Yt(o,"placeholder",s.a=u),h!==s.o&&Yt(o,"title",s.o=h),y!==s.i&&Yt(o,"tabindex",s.i=y),s},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),we(()=>o.value=e()),o})()},vD=t=>{const[e,r]=$e(!1),[n,i]=$e(""),[o,s]=$e(-1),a=()=>{const ne=n().toLowerCase();if(!ne)return m1;const X=m1.filter(Q=>Q.toLowerCase().includes(ne));return X.length===0&&ne.length>0?[` Agregar "${n()}"`]:X},c=()=>{r(!0),i(""),s(-1)},u=ne=>{const Q=ne.target.value;i(Q),r(Q.length>0),s(-1)},h=ne=>{let X;ne.startsWith(" Agregar")?X=n():X=ne.replace(/^[\u{1F000}-\u{1F9FF}\u{2600}-\u{27BF}]\s*/u,""),t.onChange(X),r(!1),i(""),s(-1)},y=ne=>{const X=a();switch(ne.key){case"ArrowDown":ne.preventDefault(),s(Q=>Math.min(Q+1,X.length-1));break;case"ArrowUp":ne.preventDefault(),s(Q=>Math.max(Q-1,-1));break;case"Enter":ne.preventDefault(),o()>=0&&X[o()]?h(X[o()]):(t.onChange(n()||t.value),r(!1));break;case"Escape":r(!1),i(""),s(-1);break}},g=()=>{setTimeout(()=>{n()&&n()!==t.value&&t.onChange(n()),r(!1),i(""),s(-1)},150)},p=()=>e()&&n()?n():t.value||"",C={position:"relative",width:t.width||"100%",flex:t.width?void 0:"1"},S={...st.input,width:"100%","padding-right":"2rem"},w={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"200px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},x=ne=>({padding:"0.5rem 0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:ne?"var(--strip-color)":"transparent",color:ne?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease","font-size":"0.875rem"}),V={position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)","pointer-events":"none",color:"var(--text-muted)","font-size":"0.75rem"};return(()=>{var ne=fD(),X=ne.firstChild,Q=X.firstChild,ee=Q.nextSibling;return X.style.setProperty("position","relative"),Q.addEventListener("blur",g),Q.$$keydown=y,Q.$$click=c,Q.$$input=u,l(ee,()=>e()?"":""),l(ne,B(Ge,{get when(){return Te(()=>!!e())()&&a().length>0},get children(){var E=jh();return l(E,B(Ut,{get each(){return a()},children:(A,T)=>{const R=A.startsWith(" Agregar");return(()=>{var _=jh();return _.addEventListener("mouseenter",()=>s(T())),_.$$click=()=>h(A),l(_,A),we(I=>m(_,{...x(T()===o()),...R&&{"font-style":"italic","border-left":"3px solid var(--primary-color)",background:T()===o()?"var(--primary-color)":"#f0f8ff",color:T()===o()?"white":"var(--primary-color)"}},I)),_})()}})),we(A=>m(E,w,A)),E}}),null),we(E=>{var A=C,T=S,R=t.placeholder,_=t?.index,I=V;return E.e=m(ne,A,E.e),E.t=m(Q,T,E.t),R!==E.a&&Yt(Q,"placeholder",E.a=R),_!==E.o&&Yt(Q,"tabindex",E.o=_),E.i=m(ee,I,E.i),E},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),we(()=>Q.value=p()),ne})()};dr(["input","click","keydown"]);var bD=de("<div><div><label>Store Location</label><select><option value=all>All Stores</option></select></div><div><label>From Date</label><input type=date></div><div><label>To Date</label><input type=date></div><div><label>Payment Method</label><select><option value=all>All Methods</option><option value=cash>Cash</option><option value=zelle>Zelle</option><option value=other>Other</option></select></div><div><label>Shipping Type</label><select><option value=all>All Types</option><option value=SEA> Maritimo</option><option value=AEREO> Aereo"),_D=de("<div><div><strong>Total Invoices:</strong> </div><div><strong>Date Range:</strong> <!> to </div><div><strong>Store:</strong> </div><div><strong>Shipping Type:</strong> "),wD=de("<div><div><strong>Cash:</strong> </div><div><strong>Zelle:</strong> </div><div><strong>Other:</strong> </div><div><strong>Total:</strong> "),SD=de("<div><div><strong>Transport:</strong> </div><div><strong>Aranceles:</strong> </div><div><strong>Tax:</strong> "),y1=de("<div>"),PD=de("<div><table><thead><tr><th>Product Type</th><th>Quantity</th><th>Total Value</th><th>Avg Price</th></tr></thead><tbody>"),xD=de("<div><table><thead><tr><th>Reserva Type</th><th>Total Qty (lbs)</th><th>Price Groups (Price  Qty)</th><th>Total</th></tr></thead><tbody>"),AD=de("<div><table><thead><tr><th>Service Type</th><th>Total</th></tr></thead><tbody><tr><td colspan=4><strong>Total Other Services:</strong></td><td>"),CD=de("<div><div><div>Products Total</div><div></div></div><div><div>Reservas Total</div><div></div></div><div><div>Transport & Services</div><div></div></div><div><div>GRAND TOTAL</div><div>"),ID=de("<div><div>Generating report..."),$D=de("<div><div><div><h3>Invoice References</h3><button></button></div><div><div>Type: <strong></strong></div><div>Price per pound: <strong></strong></div><div>Total invoices: <strong></strong></div></div><div><div>Invoice Numbers:</div><div></div></div><div>"),ED=de("<div><div class=print-only><h1>Invoice Resume Report</h1><div></div><div>Generated on: </div></div><div class=no-print><h1>Invoice Resume Report</h1><div>"),kD=de("<option>"),TD=de("<tr><td></td><td></td><td></td><td>"),ND=de("<tr><td></td><td></td><td><div></div></td><td>"),LD=de("<div><span>  <!> lbs</span><button> <!> invoice"),DD=de("<tr><td><div><span></span></div></td><td>");const RD=t=>{const[e,r]=$e(!1),[n,i]=$e(""),[o,s]=$e(""),[a,c]=$e("all"),[u,h]=$e("all"),[y,g]=$e("all"),[p,C]=$e("all"),[S,w]=$e(null),[x,V]=$e([]),[ne,X]=$e(!1),[Q,ee]=$e(null);Rn(async()=>{await A()});const E=()=>lt.getActiveLocations(),A=async()=>{r(!0);try{let G=a()!=="all"?a():void 0;const ie={store:G,dateFrom:n()||void 0,dateTo:o()||void 0};G&&(await Vi.fetchInvoices(ie),T())}catch(G){console.error("Error loading report data:",G)}finally{r(!1)}},T=()=>{let G=Vi.getFilteredInvoices({store:a(),dateFrom:n(),dateTo:o()});p()!=="all"&&(G=G.filter(j=>j.shippingType===p()||!j.shippingType&&p()==="SEA")),V(G);let ie=0,F=0,W=0,z=new Map,O=new Map,k=new Map,re=0,$=0,D=0;G.forEach(j=>{const oe=u_(j),K=parseFloat(oe.total),Z=Math.random();Z<.6?ie+=K:Z<.9?F+=K:W+=K,j.products?.forEach(J=>{const Y=J.product.label,U=Math.abs(J.qty),ae=parseFloat(c_(J));if(z.has(Y)){const ue=z.get(Y);z.set(Y,{qty:ue.qty+U,total:ue.total+ae})}else z.set(Y,{qty:U,total:ae})}),j.reservas?.forEach(J=>{const Y=J.type,U=parseInt(J.qty)||0,ae=parseFloat(J.price)||0,ue=parseFloat(J.arancel)||0,le=parseFloat(l_(J));if(["TRANSPORTACION","OTROS SERVICIO","OTROS","SERVICIO DE RAPEADO","CAJAS"].includes(Y)||U===0)if(re+=le,k.has(Y)){const ce=k.get(Y);k.set(Y,{qty:ce.qty+U,price:ce.price,arancel:ce.arancel+ue,total:ce.total+le})}else k.set(Y,{qty:U,price:ae,arancel:ue,total:le});else{const ce=Y;if(O.has(ce)){const Se=O.get(ce);O.set(ce,{qty:Se.qty+U,price:Se.price,total:Se.total+le,priceGroups:Se.priceGroups});const me=Se.priceGroups.get(ae)||{qty:0,invoices:[]};me.qty+=U,me.invoices.includes(j.invoice)||me.invoices.push(j.invoice),Se.priceGroups.set(ae,me)}else{const Se=new Map;Se.set(ae,{qty:U,invoices:[j.invoice]}),O.set(ce,{qty:U,price:ae,arancel:ue,total:le,priceGroups:Se})}}$+=ue})});const H=ie+F+W;D=H*.1;const L={dateRange:{from:n(),to:o()},store:a(),shippingType:p(),totalInvoices:G.length,paymentMethods:{cash:ie,zelle:F,other:W,total:ie+F+W},productsByType:z,reservasByTypeAndPrice:O,otherServicesByType:k,transportTotal:re,arancelesTotal:$,taxTotal:D,grandTotal:H+D};w(L)},R=G=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(G),_=()=>{document.body.classList.add("printing"),setTimeout(()=>{window.print(),document.body.classList.remove("printing")},100)},I=async()=>{try{const G=b();if(G){X(!0);const{generateInvoiceResumePDF:ie}=await Ni(async()=>{const{generateInvoiceResumePDF:W}=await import("./invoiceResumePdfGenerator-Xltzu4T7.js");return{generateInvoiceResumePDF:W}},[]),F=`invoice-resume-report-${new Date().toISOString().split("T")[0]}.pdf`;await ie(G,F),console.log(`PDF generated successfully: ${F}`)}}catch(G){console.error("Error generating PDF:",G),alert("PDF generation failed. Using print instead."),_()}finally{X(!1)}},b=Tt(()=>S());return(()=>{var G=ED(),ie=G.firstChild,F=ie.firstChild,W=F.nextSibling,z=W.nextSibling;z.firstChild;var O=ie.nextSibling,k=O.firstChild,re=k.nextSibling;return G.style.setProperty("padding","2rem"),G.style.setProperty("max-width","1200px"),G.style.setProperty("margin","0 auto"),ie.style.setProperty("text-align","center"),ie.style.setProperty("margin-bottom","2rem"),ie.style.setProperty("border-bottom","2px solid #333"),ie.style.setProperty("padding-bottom","1rem"),W.style.setProperty("font-size","12pt"),W.style.setProperty("margin-top","0.5rem"),W.style.setProperty("color","#666"),l(W,B(Ge,{get when(){return Te(()=>!!b()?.dateRange?.from)()&&b()?.dateRange?.to},get children(){return["Report Period: ",Te(()=>b()?.dateRange?.from)," to ",Te(()=>b()?.dateRange?.to)]}}),null),l(W,B(Ge,{get when(){return!b()?.dateRange?.from||!b()?.dateRange?.to},children:"All Time Report"}),null),z.style.setProperty("font-size","10pt"),z.style.setProperty("margin-top","0.5rem"),l(z,()=>new Date().toLocaleDateString(),null),O.style.setProperty("display","flex"),O.style.setProperty("justify-content","space-between"),O.style.setProperty("align-items","center"),O.style.setProperty("margin-bottom","2rem"),k.style.setProperty("font-size","1.75rem"),k.style.setProperty("font-weight","bold"),re.style.setProperty("display","flex"),re.style.setProperty("gap","1rem"),l(re,B(xt,{variant:"outline",onClick:_,children:" Print"}),null),l(re,B(xt,{variant:"outline",onClick:I,get disabled(){return ne()},get children(){return ne()?" Generating...":" Export PDF"}}),null),l(re,B(Ge,{get when(){return t.onClose},get children(){return B(xt,{variant:"secondary",get onClick(){return t.onClose},children:"Close"})}}),null),l(G,B(Nt,{title:"Filters",style:{"margin-bottom":"2rem"},class:"no-print",get children(){var $=bD(),D=$.firstChild,H=D.firstChild,L=H.nextSibling;L.firstChild;var j=D.nextSibling,oe=j.firstChild,K=oe.nextSibling,Z=j.nextSibling,J=Z.firstChild,Y=J.nextSibling,U=Z.nextSibling,ae=U.firstChild,ue=ae.nextSibling,le=U.nextSibling,q=le.firstChild,ce=q.nextSibling;return $.style.setProperty("display","grid"),$.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),$.style.setProperty("gap","1rem"),$.style.setProperty("align-items","end"),H.style.setProperty("display","block"),H.style.setProperty("margin-bottom","0.5rem"),H.style.setProperty("font-weight","500"),L.addEventListener("change",Se=>c(Se.currentTarget.value)),L.style.setProperty("width","100%"),L.style.setProperty("padding","0.75rem"),L.style.setProperty("border","1px solid var(--border-color)"),L.style.setProperty("border-radius","var(--border-radius-sm)"),l(L,B(Ut,{get each(){return E()},children:Se=>(()=>{var me=kD();return l(me,()=>Se.name),we(()=>me.value=Se.id),me})()}),null),oe.style.setProperty("display","block"),oe.style.setProperty("margin-bottom","0.5rem"),oe.style.setProperty("font-weight","500"),K.addEventListener("change",Se=>i(Se.currentTarget.value)),K.style.setProperty("width","100%"),K.style.setProperty("padding","0.75rem"),K.style.setProperty("border","1px solid var(--border-color)"),K.style.setProperty("border-radius","var(--border-radius-sm)"),J.style.setProperty("display","block"),J.style.setProperty("margin-bottom","0.5rem"),J.style.setProperty("font-weight","500"),Y.addEventListener("change",Se=>s(Se.currentTarget.value)),Y.style.setProperty("width","100%"),Y.style.setProperty("padding","0.75rem"),Y.style.setProperty("border","1px solid var(--border-color)"),Y.style.setProperty("border-radius","var(--border-radius-sm)"),ae.style.setProperty("display","block"),ae.style.setProperty("margin-bottom","0.5rem"),ae.style.setProperty("font-weight","500"),ue.addEventListener("change",Se=>g(Se.currentTarget.value)),ue.style.setProperty("width","100%"),ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("border","1px solid var(--border-color)"),ue.style.setProperty("border-radius","var(--border-radius-sm)"),q.style.setProperty("display","block"),q.style.setProperty("margin-bottom","0.5rem"),q.style.setProperty("font-weight","500"),ce.addEventListener("change",Se=>C(Se.currentTarget.value)),ce.style.setProperty("width","100%"),ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("border","1px solid var(--border-color)"),ce.style.setProperty("border-radius","var(--border-radius-sm)"),l($,B(Ge,{get when(){return a()!=="all"},get children(){return B(xt,{variant:"primary",onClick:A,get disabled(){return Te(()=>a()==="all")()&&e()},get children(){return e()?"Loading...":"Generate Report"}})}}),null),we(()=>L.value=a()),we(()=>K.value=n()),we(()=>Y.value=o()),we(()=>ue.value=y()),we(()=>ce.value=p()),$}}),null),l(G,B(Ge,{get when(){return Te(()=>!!(a()!=="all"&&b()))()&&!e()},get children(){return[(()=>{var $=y1();return $.style.setProperty("display","grid"),$.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),$.style.setProperty("gap","1.5rem"),$.style.setProperty("margin-bottom","2rem"),l($,B(Nt,{title:"Invoice Summary",get children(){var D=_D(),H=D.firstChild,L=H.firstChild;L.nextSibling;var j=H.nextSibling,oe=j.firstChild,K=oe.nextSibling,Z=K.nextSibling;Z.nextSibling;var J=j.nextSibling,Y=J.firstChild;Y.nextSibling;var U=J.nextSibling,ae=U.firstChild;return ae.nextSibling,D.style.setProperty("padding","1rem"),H.style.setProperty("margin-bottom","0.5rem"),l(H,()=>b().totalInvoices,null),j.style.setProperty("margin-bottom","0.5rem"),l(j,()=>b().dateRange.from||"All",Z),l(j,()=>b().dateRange.to||"All",null),J.style.setProperty("margin-bottom","0.5rem"),l(J,(()=>{var ue=Te(()=>b().store==="all");return()=>ue()?"All Stores":b().store})(),null),l(U,(()=>{var ue=Te(()=>b().shippingType==="all");return()=>ue()?"All Types":Te(()=>b().shippingType==="SEA")()?" Maritimo":b().shippingType==="AEREO"?" Aereo":"Not Set"})(),null),D}}),null),l($,B(Nt,{title:"Payment Methods",get children(){var D=wD(),H=D.firstChild,L=H.firstChild;L.nextSibling;var j=H.nextSibling,oe=j.firstChild;oe.nextSibling;var K=j.nextSibling,Z=K.firstChild;Z.nextSibling;var J=K.nextSibling,Y=J.firstChild;return Y.nextSibling,D.style.setProperty("padding","1rem"),H.style.setProperty("margin-bottom","0.5rem"),l(H,()=>R(b().paymentMethods.cash),null),j.style.setProperty("margin-bottom","0.5rem"),l(j,()=>R(b().paymentMethods.zelle),null),K.style.setProperty("margin-bottom","0.5rem"),l(K,()=>R(b().paymentMethods.other),null),J.style.setProperty("border-top","1px solid var(--border-color)"),J.style.setProperty("padding-top","0.5rem"),J.style.setProperty("font-weight","bold"),l(J,()=>R(b().paymentMethods.total),null),D}}),null),l($,B(Nt,{title:"Additional Charges",get children(){var D=SD(),H=D.firstChild,L=H.firstChild;L.nextSibling;var j=H.nextSibling,oe=j.firstChild;oe.nextSibling;var K=j.nextSibling,Z=K.firstChild;return Z.nextSibling,D.style.setProperty("padding","1rem"),H.style.setProperty("margin-bottom","0.5rem"),l(H,()=>R(b().transportTotal),null),j.style.setProperty("margin-bottom","0.5rem"),l(j,()=>R(b().arancelesTotal),null),K.style.setProperty("margin-bottom","0.5rem"),l(K,()=>R(b().taxTotal),null),D}}),null),$})(),B(Ge,{get when(){return b().productsByType?.size>0},get children(){return B(Nt,{title:"Products Summary",style:{"margin-bottom":"2rem"},get children(){var $=PD(),D=$.firstChild,H=D.firstChild,L=H.firstChild,j=L.firstChild,oe=j.nextSibling,K=oe.nextSibling,Z=K.nextSibling,J=H.nextSibling;return $.style.setProperty("overflow-x","auto"),D.style.setProperty("width","100%"),D.style.setProperty("border-collapse","collapse"),L.style.setProperty("background","var(--background-color)"),j.style.setProperty("padding","1rem"),j.style.setProperty("text-align","left"),j.style.setProperty("border-bottom","2px solid var(--border-color)"),oe.style.setProperty("padding","1rem"),oe.style.setProperty("text-align","right"),oe.style.setProperty("border-bottom","2px solid var(--border-color)"),K.style.setProperty("padding","1rem"),K.style.setProperty("text-align","right"),K.style.setProperty("border-bottom","2px solid var(--border-color)"),Z.style.setProperty("padding","1rem"),Z.style.setProperty("text-align","right"),Z.style.setProperty("border-bottom","2px solid var(--border-color)"),l(J,B(Ut,{get each(){return Array.from(b().productsByType.entries()).sort((Y,U)=>U[1].total-Y[1].total)},children:([Y,U])=>(()=>{var ae=TD(),ue=ae.firstChild,le=ue.nextSibling,q=le.nextSibling,ce=q.nextSibling;return ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("border-bottom","1px solid var(--border-color)"),l(ue,Y),le.style.setProperty("padding","0.75rem"),le.style.setProperty("text-align","right"),le.style.setProperty("border-bottom","1px solid var(--border-color)"),l(le,()=>U.qty),q.style.setProperty("padding","0.75rem"),q.style.setProperty("text-align","right"),q.style.setProperty("border-bottom","1px solid var(--border-color)"),q.style.setProperty("font-weight","600"),l(q,()=>R(U.total)),ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("text-align","right"),ce.style.setProperty("border-bottom","1px solid var(--border-color)"),l(ce,()=>R(U.total/U.qty)),ae})()})),$}})}}),B(Ge,{get when(){return b().reservasByTypeAndPrice?.size>0},get children(){return B(Nt,{title:"Reservas Summary (Grouped by Price)",style:{"margin-bottom":"2rem"},get children(){var $=xD(),D=$.firstChild,H=D.firstChild,L=H.firstChild,j=L.firstChild,oe=j.nextSibling,K=oe.nextSibling,Z=K.nextSibling,J=H.nextSibling;return $.style.setProperty("overflow-x","auto"),D.style.setProperty("width","100%"),D.style.setProperty("border-collapse","collapse"),L.style.setProperty("background","var(--background-color)"),j.style.setProperty("padding","1rem"),j.style.setProperty("text-align","left"),j.style.setProperty("border-bottom","2px solid var(--border-color)"),oe.style.setProperty("padding","1rem"),oe.style.setProperty("text-align","right"),oe.style.setProperty("border-bottom","2px solid var(--border-color)"),K.style.setProperty("padding","1rem"),K.style.setProperty("text-align","left"),K.style.setProperty("border-bottom","2px solid var(--border-color)"),Z.style.setProperty("padding","1rem"),Z.style.setProperty("text-align","right"),Z.style.setProperty("border-bottom","2px solid var(--border-color)"),l(J,B(Ut,{get each(){return Array.from(b().reservasByTypeAndPrice.entries()).sort((Y,U)=>U[1].total-Y[1].total)},children:([Y,U])=>(()=>{var ae=ND(),ue=ae.firstChild,le=ue.nextSibling,q=le.nextSibling,ce=q.firstChild,Se=q.nextSibling;return ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("border-bottom","1px solid var(--border-color)"),l(ue,Y),le.style.setProperty("padding","0.75rem"),le.style.setProperty("text-align","right"),le.style.setProperty("border-bottom","1px solid var(--border-color)"),le.style.setProperty("font-weight","600"),l(le,()=>U.qty),q.style.setProperty("padding","0.75rem"),q.style.setProperty("border-bottom","1px solid var(--border-color)"),ce.style.setProperty("font-size","0.875rem"),l(ce,B(Ut,{get each(){return Array.from(U.priceGroups.entries()).sort((me,Pe)=>me[0]-Pe[0])},children:([me,Pe])=>(()=>{var xe=LD(),he=xe.firstChild,ve=he.firstChild,De=ve.nextSibling;De.nextSibling;var ke=he.nextSibling,Ce=ke.firstChild,Le=Ce.nextSibling;return Le.nextSibling,xe.style.setProperty("margin-bottom","0.5rem"),xe.style.setProperty("display","flex"),xe.style.setProperty("align-items","center"),xe.style.setProperty("gap","0.5rem"),l(he,()=>R(me),ve),l(he,()=>Pe.qty,De),ke.addEventListener("mouseleave",Ie=>Ie.currentTarget.style.background="#3498db"),ke.addEventListener("mouseenter",Ie=>Ie.currentTarget.style.background="#2980b9"),ke.$$click=()=>ee({price:me,invoices:Pe.invoices,type:Y}),ke.style.setProperty("background","#3498db"),ke.style.setProperty("color","white"),ke.style.setProperty("border","none"),ke.style.setProperty("border-radius","4px"),ke.style.setProperty("padding","0.25rem 0.5rem"),ke.style.setProperty("font-size","0.75rem"),ke.style.setProperty("cursor","pointer"),ke.style.setProperty("transition","background 0.2s"),l(ke,()=>Pe.invoices.length,Le),l(ke,()=>Pe.invoices.length>1?"s":"",null),xe})()})),Se.style.setProperty("padding","0.75rem"),Se.style.setProperty("text-align","right"),Se.style.setProperty("border-bottom","1px solid var(--border-color)"),Se.style.setProperty("font-weight","600"),l(Se,()=>R(U.total)),ae})()})),$}})}}),B(Ge,{get when(){return b().otherServicesByType?.size>0},get children(){return B(Nt,{title:"Other Services & Charges",style:{"margin-bottom":"2rem"},get children(){var $=AD(),D=$.firstChild,H=D.firstChild,L=H.firstChild,j=L.firstChild,oe=j.nextSibling,K=H.nextSibling,Z=K.firstChild,J=Z.firstChild,Y=J.nextSibling;return $.style.setProperty("overflow-x","auto"),D.style.setProperty("width","100%"),D.style.setProperty("border-collapse","collapse"),L.style.setProperty("background","var(--background-color)"),j.style.setProperty("padding","1rem"),j.style.setProperty("text-align","left"),j.style.setProperty("border-bottom","2px solid var(--border-color)"),oe.style.setProperty("padding","1rem"),oe.style.setProperty("text-align","right"),oe.style.setProperty("border-bottom","2px solid var(--border-color)"),l(K,B(Ut,{get each(){return Array.from(b().otherServicesByType.entries()).sort((U,ae)=>ae[1].total-U[1].total)},children:([U,ae])=>(()=>{var ue=DD(),le=ue.firstChild,q=le.firstChild,ce=q.firstChild,Se=le.nextSibling;return le.style.setProperty("padding","0.75rem"),le.style.setProperty("border-bottom","1px solid var(--border-color)"),q.style.setProperty("display","flex"),q.style.setProperty("align-items","center"),q.style.setProperty("gap","0.5rem"),(U==="TRANSPORTACION"?"#e3f2fd":U==="CAJAS"?"#f3e5f5":"#fff3e0")!=null?ce.style.setProperty("background",U==="TRANSPORTACION"?"#e3f2fd":U==="CAJAS"?"#f3e5f5":"#fff3e0"):ce.style.removeProperty("background"),(U==="TRANSPORTACION"?"#1976d2":U==="CAJAS"?"#7b1fa2":"#f57c00")!=null?ce.style.setProperty("color",U==="TRANSPORTACION"?"#1976d2":U==="CAJAS"?"#7b1fa2":"#f57c00"):ce.style.removeProperty("color"),ce.style.setProperty("padding","0.25rem 0.5rem"),ce.style.setProperty("border-radius","4px"),ce.style.setProperty("font-size","0.75rem"),ce.style.setProperty("font-weight","600"),l(ce,U==="TRANSPORTACION"?"":U==="CAJAS"?"":U==="SERVICIO DE RAPEADO"?"":""),l(q,U,null),Se.style.setProperty("padding","0.75rem"),Se.style.setProperty("text-align","right"),Se.style.setProperty("border-bottom","1px solid var(--border-color)"),Se.style.setProperty("font-weight","600"),l(Se,()=>R(ae.total)),ue})()}),Z),Z.style.setProperty("background","var(--strip-color)"),Z.style.setProperty("font-weight","bold"),J.style.setProperty("padding","0.75rem"),J.style.setProperty("text-align","right"),J.style.setProperty("border-top","2px solid var(--border-color)"),Y.style.setProperty("padding","0.75rem"),Y.style.setProperty("text-align","right"),Y.style.setProperty("border-top","2px solid var(--border-color)"),Y.style.setProperty("font-weight","700"),l(Y,()=>R(b().transportTotal)),$}})}}),B(Nt,{title:"Total Summary",get children(){var $=CD(),D=$.firstChild,H=D.firstChild,L=H.nextSibling,j=D.nextSibling,oe=j.firstChild,K=oe.nextSibling,Z=j.nextSibling,J=Z.firstChild,Y=J.nextSibling,U=Z.nextSibling,ae=U.firstChild,ue=ae.nextSibling;return $.style.setProperty("display","grid"),$.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),$.style.setProperty("gap","2rem"),$.style.setProperty("padding","2rem"),D.style.setProperty("text-align","center"),H.style.setProperty("font-size","0.875rem"),H.style.setProperty("color","var(--text-secondary)"),H.style.setProperty("margin-bottom","0.5rem"),L.style.setProperty("font-size","1.5rem"),L.style.setProperty("font-weight","bold"),L.style.setProperty("color","var(--primary-color)"),l(L,()=>R(Array.from(b().productsByType.values()).reduce((le,q)=>le+q.total,0))),j.style.setProperty("text-align","center"),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-secondary)"),oe.style.setProperty("margin-bottom","0.5rem"),K.style.setProperty("font-size","1.5rem"),K.style.setProperty("font-weight","bold"),K.style.setProperty("color","var(--primary-color)"),l(K,()=>R(Array.from(b().reservasByTypeAndPrice.values()).reduce((le,q)=>le+q.total,0))),Z.style.setProperty("text-align","center"),J.style.setProperty("font-size","0.875rem"),J.style.setProperty("color","var(--text-secondary)"),J.style.setProperty("margin-bottom","0.5rem"),Y.style.setProperty("font-size","1.5rem"),Y.style.setProperty("font-weight","bold"),Y.style.setProperty("color","var(--primary-color)"),l(Y,()=>R(b().transportTotal)),U.style.setProperty("text-align","center"),U.style.setProperty("border-left","2px solid var(--primary-color)"),U.style.setProperty("padding-left","2rem"),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-secondary)"),ae.style.setProperty("margin-bottom","0.5rem"),ue.style.setProperty("font-size","2rem"),ue.style.setProperty("font-weight","bold"),ue.style.setProperty("color","var(--primary-color)"),l(ue,()=>R(b().paymentMethods.total)),$}})]}}),null),l(G,B(Ge,{get when(){return e()},get children(){var $=ID(),D=$.firstChild;return $.style.setProperty("text-align","center"),$.style.setProperty("padding","3rem"),D.style.setProperty("font-size","1.25rem"),D.style.setProperty("margin-bottom","1rem"),$}}),null),l(G,B(Ge,{get when(){return Q()},get children(){var $=$D(),D=$.firstChild,H=D.firstChild,L=H.firstChild,j=L.nextSibling,oe=H.nextSibling,K=oe.firstChild,Z=K.firstChild,J=Z.nextSibling,Y=K.nextSibling,U=Y.firstChild,ae=U.nextSibling,ue=Y.nextSibling,le=ue.firstChild,q=le.nextSibling,ce=oe.nextSibling,Se=ce.firstChild,me=Se.nextSibling,Pe=ce.nextSibling;return $.$$click=()=>ee(null),$.style.setProperty("position","fixed"),$.style.setProperty("top","0"),$.style.setProperty("left","0"),$.style.setProperty("right","0"),$.style.setProperty("bottom","0"),$.style.setProperty("background","rgba(0, 0, 0, 0.5)"),$.style.setProperty("display","flex"),$.style.setProperty("align-items","center"),$.style.setProperty("justify-content","center"),$.style.setProperty("z-index","1000"),D.$$click=xe=>xe.stopPropagation(),D.style.setProperty("background","white"),D.style.setProperty("padding","2rem"),D.style.setProperty("border-radius","var(--border-radius)"),D.style.setProperty("max-width","600px"),D.style.setProperty("max-height","80vh"),D.style.setProperty("overflow-y","auto"),D.style.setProperty("box-shadow","var(--shadow-lg)"),H.style.setProperty("display","flex"),H.style.setProperty("justify-content","space-between"),H.style.setProperty("align-items","center"),H.style.setProperty("margin-bottom","1.5rem"),L.style.setProperty("font-size","1.25rem"),L.style.setProperty("font-weight","bold"),j.$$click=()=>ee(null),j.style.setProperty("background","none"),j.style.setProperty("border","none"),j.style.setProperty("font-size","1.5rem"),j.style.setProperty("cursor","pointer"),j.style.setProperty("color","#666"),oe.style.setProperty("margin-bottom","1rem"),K.style.setProperty("font-size","0.875rem"),K.style.setProperty("color","var(--text-secondary)"),l(J,()=>Q().type),Y.style.setProperty("font-size","0.875rem"),Y.style.setProperty("color","var(--text-secondary)"),l(ae,()=>R(Q().price)),ue.style.setProperty("font-size","0.875rem"),ue.style.setProperty("color","var(--text-secondary)"),l(q,()=>Q().invoices.length),ce.style.setProperty("border","1px solid var(--border-color)"),ce.style.setProperty("border-radius","var(--border-radius-sm)"),ce.style.setProperty("padding","1rem"),ce.style.setProperty("background","var(--background-color)"),Se.style.setProperty("font-weight","600"),Se.style.setProperty("margin-bottom","0.75rem"),me.style.setProperty("display","grid"),me.style.setProperty("grid-template-columns","repeat(auto-fill, minmax(120px, 1fr))"),me.style.setProperty("gap","0.5rem"),l(me,B(Ut,{get each(){return Q().invoices},children:xe=>(()=>{var he=y1();return he.$$click=()=>{const ve=x().find(De=>De.invoice===xe);ve&&console.log("Invoice details:",ve)},he.addEventListener("mouseleave",ve=>{ve.currentTarget.style.background="white",ve.currentTarget.style.borderColor="var(--border-color)"}),he.addEventListener("mouseenter",ve=>{ve.currentTarget.style.background="#e3f2fd",ve.currentTarget.style.borderColor="#2196f3"}),he.style.setProperty("padding","0.5rem"),he.style.setProperty("background","white"),he.style.setProperty("border","1px solid var(--border-color)"),he.style.setProperty("border-radius","var(--border-radius-sm)"),he.style.setProperty("font-family","monospace"),he.style.setProperty("font-size","0.875rem"),he.style.setProperty("text-align","center"),he.style.setProperty("transition","all 0.2s"),he.style.setProperty("cursor","pointer"),l(he,xe),he})()})),Pe.style.setProperty("margin-top","1.5rem"),Pe.style.setProperty("display","flex"),Pe.style.setProperty("justify-content","flex-end"),Pe.style.setProperty("gap","1rem"),l(Pe,B(xt,{variant:"outline",onClick:()=>{const xe=Q().invoices.join(", ");navigator.clipboard.writeText(xe).then(()=>{alert("Invoice numbers copied to clipboard!")})},children:" Copy Invoice Numbers"}),null),l(Pe,B(xt,{variant:"primary",onClick:()=>ee(null),children:"Close"}),null),$}}),null),G})()};dr(["click"]);var MD=de("<div><div>"),FD=de("<div> "),OD=de("<div><div><label></label><select><option value=all></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label><input type=text>"),BD=de("<div><button></button><button></button><button> Crear Nueva Factura</button><button> Resume Report"),ol=de("<div>"),jD=de("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),VD=de("<button> "),qD=de("<option>"),zD=de("<div><div></div><div></div><div></div><div>"),g1=de("<div><span></span><span> "),UD=de("<div><span></span><span> $"),HD=de("<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td><span></span></td><td><button>");const ah=t=>parseFloat(t?.toString())||0,l_=t=>{let e=ah(t.qty),r=ah(t.price),n=ah(t.arancel);return`${(e*r+n)?.toFixed(2)}`},c_=t=>{let e=Math.abs(t.qty),r=ah(t.salePrice);return`${(e*r)?.toFixed(2)}`},u_=t=>{let e=0;t?.reservas?.forEach(i=>{e+=parseFloat(l_(i))});let r=0;t?.products?.forEach(i=>{r+=parseFloat(c_(i))});let n={};return n.reservaSubtotal=e.toFixed(2),n.productSubtotal=r.toFixed(2),n.subtotalBeforeTax=(r+e).toFixed(2),n.total=n.subtotalBeforeTax,n},WD=t=>{const{t:e}=er(),[r,n]=$e(!1),[i,o]=$e("all"),[s,a]=$e(""),[c,u]=$e(""),[h,y]=$e(null),[g,p]=$e("dashboard"),[C,S]=$e([]),[w,x]=$e(""),[V,ne]=$e("overview");Rn(async()=>{try{t.invoices;try{const J=await Vi.fetchStores();let Y=Array.isArray(J)?J:Object.keys(J)||[]}catch{const Y=Vi.state.invoices||t.invoices,U=[...new Set(Y.map(ae=>ae.store))];S(U.sort())}}catch(J){console.error("Error loading dashboard data:",J)}}),Tt(()=>Vi.state.invoices||t.invoices);const X=Tt(()=>{let J;return t.invoices?J=Vi.getFilteredInvoices({store:i(),dateFrom:s(),dateTo:c()}):J=Vi.getFilteredInvoices({store:i(),dateFrom:s(),dateTo:c()}),J}),Q=async()=>{try{t.invoices,n(!0),await Vi.refreshData({store:i()!=="all"?i():void 0,dateFrom:s()||void 0,dateTo:c()||void 0,search:w()}),n(!1)}catch(J){console.error("Error refreshing data:",J)}},ee=Tt(()=>{r();const J=X(),Y=Vi.calculateSummary(J);let U=new Map,ae=new Map,ue=new Map;return J.forEach(le=>{le?.products?.length>0&&le?.products?.forEach(q=>{const ce=Math.abs(q.qty),Se=q.product.label;U.set(Se,(U.get(Se)||0)+ce)}),le?.reservas?.length>0&&le?.reservas?.forEach(q=>{let ce=parseInt(q.qty);isNaN(ce)&&(ce=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[q.type]||q?.onlyTariff?(ce=parseFloat(q.arancel)||parseFloat(q.qty)*parseFloat(q.price),ue.set(q.type,(ae.get(q.type)||0)+ce)):ae.set(q.type,(ae.get(q.type)||0)+ce)})}),{...Y,productsByCategory:U,reservasByType:ae,othersByType:ue}}),E=J=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(J),A=J=>new Date(J).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),T={padding:"2rem"},R={display:"flex",gap:"1rem","align-items":"flex-end","margin-bottom":"2rem","flex-wrap":"wrap",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)"},_={display:"flex","flex-direction":"column",gap:"0.5rem",flex:"1","min-width":"200px"},I={"font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)"},b={padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--background-color)"},G={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(280px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},ie={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)"},F={width:"48px",height:"48px","border-radius":"12px",display:"flex","align-items":"center","justify-content":"center","font-size":"1.5rem","margin-bottom":"1rem"},W={"font-size":"0.875rem",color:"var(--text-secondary)","margin-bottom":"0.5rem"},z={"font-size":"1.75rem","font-weight":"700",color:"var(--text-primary)","margin-bottom":"0.25rem"},O={"font-size":"0.75rem",color:"var(--text-muted)"},k={width:"100%",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)",overflow:"hidden"},re={padding:"1rem","text-align":"left",background:"var(--background-color)","font-weight":"600",color:"var(--text-secondary)","font-size":"0.875rem","border-bottom":"2px solid var(--border-color)"},$={padding:"1rem","border-bottom":"1px solid var(--border-color)"},D={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},H=J=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:J?"var(--primary-color)":"var(--text-muted)","border-bottom":J?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),L={padding:"0.5rem 1rem",background:"var(--primary-color)",color:"white",border:"none","border-radius":"var(--border-radius-sm)",cursor:"pointer","font-size":"0.875rem",transition:"opacity 0.2s"},j={padding:"0.75rem 1.5rem",background:"var(--secondary-color)",color:"white",border:"none","border-radius":"var(--border-radius-sm)",cursor:"pointer","margin-bottom":"1rem",display:"flex","align-items":"center",gap:"0.5rem"},oe=()=>[{title:e("invoices.totalRevenue"),value:ee().grandTotal,icon:"",color:"#4CAF50",subtext:`${e("common.of")} ${ee().totalInvoices} ${e("common.invoice")} `},{title:e("invoices.totalProducts"),value:ee().totalProducts,icon:"",color:"#2196F3",subtext:`${E(ee().totalProductAmount)} ${e("invoices.value")}`,isNumber:!0},{title:e("invoices.totalReservations"),value:ee().totalReservas,icon:"",color:"#FF9800",subtext:`${E(ee().totalReservaAmount)} ${e("invoices.value")}`,isNumber:!0},{title:e("invoices.aranceles"),value:ee().totalAranceles,icon:"",color:"#9C27B0",subtext:e("invoices.customsFees")},{title:e("invoices.uniqueCustomers"),value:ee().uniqueCustomers,icon:"",color:"#00BCD4",subtext:e("invoices.activeCustomers"),isNumber:!0},{title:e("invoices.averageInvoice"),value:ee().avgInvoiceValue,icon:"",color:"#FF5722",subtext:e("invoices.perInvoiceValue")},{title:e("invoices.completed"),value:ee().completedInvoices,icon:"",color:"#4CAF50",subtext:`${ee().pendingInvoices} ${e("invoices.pending")}`,isNumber:!0},{title:e("invoices.storesActive"),value:C().length,icon:"",color:"#795548",subtext:e("invoices.locations"),isNumber:!0}],K=()=>lt.getActiveLocations();vo(()=>{});const Z=async()=>{let J="YB1";Rm.calcStockLevels(),await lt.fecthProduct(J),await lt.fecthInventory(J)};return Rn(()=>{Z()}),B(ro,{get title(){return e("invoices.title")},get children(){var J=ol();return m(J,T),l(J,B(Ge,{get when(){return g()==="dashboard"},get children(){return[B(Ge,{get when(){return!t.invoices&&Vi.state.loading},get children(){var Y=MD(),U=Y.firstChild;return Y.style.setProperty("text-align","center"),Y.style.setProperty("padding","2rem"),U.style.setProperty("font-size","1.25rem"),U.style.setProperty("margin-bottom","1rem"),l(U,()=>e("invoices.loadingInvoices")),Y}}),B(Ge,{get when(){return Vi.state.error},get children(){var Y=FD();return Y.firstChild,Y.style.setProperty("padding","1rem"),Y.style.setProperty("margin-bottom","1rem"),Y.style.setProperty("background","#ffebee"),Y.style.setProperty("border","1px solid #ffcdd2"),Y.style.setProperty("border-radius","var(--border-radius)"),Y.style.setProperty("color","#d32f2f"),l(Y,()=>Vi.state.error,null),l(Y,B(xt,{variant:"outline",size:"sm",onClick:Q,style:{"margin-left":"1rem"},get children(){return e("invoices.refreshData")}}),null),Y}}),(()=>{var Y=OD(),U=Y.firstChild,ae=U.firstChild,ue=ae.nextSibling,le=ue.firstChild,q=U.nextSibling,ce=q.firstChild,Se=ce.nextSibling,me=q.nextSibling,Pe=me.firstChild,xe=Pe.nextSibling,he=me.nextSibling,ve=he.firstChild,De=ve.nextSibling;return m(Y,R),l(ae,()=>e("invoices.storeLocation")),ue.addEventListener("change",ke=>o(ke.currentTarget.value)),l(le,()=>e("invoices.allStores")),l(ue,B(Ut,{get each(){return K()},children:ke=>(()=>{var Ce=qD();return l(Ce,()=>ke.name),we(()=>Ce.value=ke.id),Ce})()}),null),l(ce,()=>e("invoices.fromDate")),Se.addEventListener("change",ke=>a(ke.currentTarget.value)),l(Pe,()=>e("invoices.toDate")),xe.addEventListener("change",ke=>u(ke.currentTarget.value)),l(ve,()=>e("invoices.search")),De.addEventListener("change",ke=>x(ke.currentTarget.value)),l(Y,B(xt,{variant:"secondary",onClick:()=>{o("all"),a(""),u(""),x("")},get children(){return e("invoices.clearFilters")}}),null),l(Y,B(xt,{variant:"primary",onClick:Q,get disabled(){return!t.invoices&&Vi.state.loading},get children(){return[" ",Te(()=>e("invoices.refreshData"))]}}),null),we(ke=>{var Ce=_,Le=I,Ie=b,Re=_,He=I,Me=b,Ze=_,Ye=I,ut=b,rt=_,We=I,ct=b,pt=e("invoices.searchPlaceholder");return ke.e=m(U,Ce,ke.e),ke.t=m(ae,Le,ke.t),ke.a=m(ue,Ie,ke.a),ke.o=m(q,Re,ke.o),ke.i=m(ce,He,ke.i),ke.n=m(Se,Me,ke.n),ke.s=m(me,Ze,ke.s),ke.h=m(Pe,Ye,ke.h),ke.r=m(xe,ut,ke.r),ke.d=m(he,rt,ke.d),ke.l=m(ve,We,ke.l),ke.u=m(De,ct,ke.u),pt!==ke.c&&Yt(De,"placeholder",ke.c=pt),ke},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0}),we(()=>ue.value=i()),we(()=>Se.value=s()),we(()=>xe.value=c()),we(()=>De.value=w()),Y})(),(()=>{var Y=BD(),U=Y.firstChild,ae=U.nextSibling,ue=ae.nextSibling,le=ue.nextSibling;return m(Y,D),U.$$click=()=>ne("overview"),l(U,()=>e("inventory.overview")),ae.$$click=()=>ne("invoices"),l(ae,()=>e("invoices.invoices")),ue.$$click=()=>ne("add"),le.$$click=()=>ne("report"),we(q=>{var ce=H(V()==="overview"),Se=H(V()==="invoices"),me=H(V()==="add"),Pe=H(V()==="report");return q.e=m(U,ce,q.e),q.t=m(ae,Se,q.t),q.a=m(ue,me,q.a),q.o=m(le,Pe,q.o),q},{e:void 0,t:void 0,a:void 0,o:void 0}),Y})(),B(Ge,{get when(){return V()==="overview"},get children(){return[(()=>{var Y=ol();return m(Y,G),l(Y,B(Ut,{get each(){return oe()},children:U=>(()=>{var ae=zD(),ue=ae.firstChild,le=ue.nextSibling,q=le.nextSibling,ce=q.nextSibling;return m(ae,ie),l(ue,()=>U?.icon),m(le,W),l(le,()=>U?.title),m(q,z),l(q,(()=>{var Se=Te(()=>!!U.isNumber);return()=>Se()?U.value:E(U.value)})()),m(ce,O),l(ce,()=>U.subtext),we(Se=>m(ue,{...F,background:`${U?.color}20`,color:U?.color},Se)),ae})()})),Y})(),B(Ge,{get when(){return ee()?.productsByCategory?.size>0},get children(){return B(Nt,{get title(){return e("invoices.topProducts")},get subtitle(){return e("invoices.mostSoldProducts")},get children(){var Y=ol();return Y.style.setProperty("max-height","300px"),Y.style.setProperty("overflow-y","auto"),l(Y,()=>Array.from(ee().productsByCategory.entries()).sort((U,ae)=>ae[1]-U[1]).slice(0,10).map(([U,ae])=>(()=>{var ue=g1(),le=ue.firstChild,q=le.nextSibling,ce=q.firstChild;return ue.style.setProperty("display","flex"),ue.style.setProperty("justify-content","space-between"),ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("border-bottom","1px solid var(--border-color)"),l(le,U),q.style.setProperty("font-weight","600"),l(q,ae,ce),l(q,()=>e("common.units"),null),ue})())),Y}})}}),(()=>{var Y=ol();return Y.style.setProperty("margin","19px"),Y})(),B(Ge,{get when(){return ee()?.reservasByType?.size>0},get children(){return B(Nt,{get title(){return e("invoices.reservationsByType")},get subtitle(){return e("invoices.distributionOfCategories")},style:{"margin-top":"1.5rem"},get children(){var Y=ol();return Y.style.setProperty("max-height","300px"),Y.style.setProperty("overflow-y","auto"),l(Y,()=>Array.from(ee().reservasByType.entries()).sort((U,ae)=>ae[1]-U[1]).map(([U,ae])=>(()=>{var ue=g1(),le=ue.firstChild,q=le.nextSibling,ce=q.firstChild;return ue.style.setProperty("display","flex"),ue.style.setProperty("justify-content","space-between"),ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("border-bottom","1px solid var(--border-color)"),l(le,U),q.style.setProperty("font-weight","600"),l(q,ae,ce),l(q,()=>e("common.lbs"),null),ue})())),Y}})}}),(()=>{var Y=ol();return Y.style.setProperty("margin","19px"),Y})(),B(Ge,{get when(){return ee()?.othersByType?.size>0},get children(){return B(Nt,{title:"Aranceles y otros servicios",get subtitle(){return e("invoices.distributionOfCategories")},style:{"margin-top":"1.5rem"},get children(){var Y=ol();return Y.style.setProperty("max-height","300px"),Y.style.setProperty("overflow-y","auto"),l(Y,()=>Array.from(ee().othersByType.entries()).sort((U,ae)=>ae[1]-U[1]).map(([U,ae])=>(()=>{var ue=UD(),le=ue.firstChild,q=le.nextSibling,ce=q.firstChild;return ue.style.setProperty("display","flex"),ue.style.setProperty("justify-content","space-between"),ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("border-bottom","1px solid var(--border-color)"),l(le,U),q.style.setProperty("font-weight","600"),l(q,ae,ce),ue})())),Y}})}})]}})]}}),null),l(J,B(Ge,{get when(){return V()==="invoices"},get children(){return[B(Ge,{get when(){return g()!=="detail"},get children(){return B(Nt,{get title(){return e("invoices.recentInvoices")},get subtitle(){return`Mostrando ${X().length} facturas`},style:{"margin-top":"1.5rem"},get children(){var Y=jD(),U=Y.firstChild,ae=U.firstChild,ue=ae.firstChild,le=ue.firstChild,q=le.nextSibling,ce=q.nextSibling,Se=ce.nextSibling,me=Se.nextSibling,Pe=me.nextSibling,xe=Pe.nextSibling,he=xe.nextSibling,ve=he.nextSibling,De=ae.nextSibling;return Y.style.setProperty("overflow-x","auto"),m(U,k),l(le,()=>e("invoices.invoiceNumber")),l(q,()=>e("invoices.date")),l(ce,()=>e("invoices.customer")),l(Se,()=>e("invoices.store")),l(me,()=>e("invoices.products")),l(Pe,()=>e("invoices.reservations")),l(xe,()=>e("invoices.total")),l(he,()=>e("invoices.status")),l(ve,()=>e("invoices.actions")),l(De,B(Ut,{get each(){return X().slice(0,50)},children:ke=>{const Ce=()=>{let Le=u_(Lm(ke)),Ie=Le.productSubtotal,Re=Le.reservaSubtotal;return{total:Le.total,totalProductAmount:Ie,totalReservaAmount:Re,totalOther:0}};return(()=>{var Le=HD(),Ie=Le.firstChild,Re=Ie.nextSibling,He=Re.nextSibling,Me=He.nextSibling,Ze=Me.nextSibling,Ye=Ze.nextSibling,ut=Ye.nextSibling,rt=ut.nextSibling,We=rt.firstChild,ct=rt.nextSibling,pt=ct.firstChild;return l(Ie,()=>ke?.invoice),l(Re,()=>A(ke?.createDate)),l(He,()=>ke?.shipper_consignee?.name),l(Me,()=>ke?.store),l(Ze,()=>Ce()?.totalProductAmount),l(Ye,()=>Ce()?.totalReservaAmount),l(ut,()=>E(Ce()?.total)),We.style.setProperty("padding","0.25rem 0.75rem"),We.style.setProperty("border-radius","9999px"),We.style.setProperty("font-size","0.75rem"),We.style.setProperty("font-weight","600"),l(We,(()=>{var _t=Te(()=>!!ke.isCompleted);return()=>_t()?e("invoices.completed"):e("invoices.pending")})()),pt.addEventListener("mouseleave",_t=>_t.currentTarget.style.opacity="1"),pt.addEventListener("mouseenter",_t=>_t.currentTarget.style.opacity="0.8"),pt.$$click=()=>{y(ke),p("detail")},m(pt,L),l(pt,()=>e("invoices.view")),we(_t=>{var Et=$,et=$,Ue=$,ot=$,Xe=$,at=$,St={...$,"text-align":"right","font-weight":"600"},$t=$,qt=ke.isCompleted?"#d4edda":"#fff3cd",Gt=ke.isCompleted?"#155724":"#856404",ht=$;return _t.e=m(Ie,Et,_t.e),_t.t=m(Re,et,_t.t),_t.a=m(He,Ue,_t.a),_t.o=m(Me,ot,_t.o),_t.i=m(Ze,Xe,_t.i),_t.n=m(Ye,at,_t.n),_t.s=m(ut,St,_t.s),_t.h=m(rt,$t,_t.h),qt!==_t.r&&((_t.r=qt)!=null?We.style.setProperty("background",qt):We.style.removeProperty("background")),Gt!==_t.d&&((_t.d=Gt)!=null?We.style.setProperty("color",Gt):We.style.removeProperty("color")),_t.l=m(ct,ht,_t.l),_t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),Le})()}})),we(ke=>{var Ce=re,Le=re,Ie=re,Re=re,He=re,Me=re,Ze={...re,"text-align":"right"},Ye=re,ut=re;return ke.e=m(le,Ce,ke.e),ke.t=m(q,Le,ke.t),ke.a=m(ce,Ie,ke.a),ke.o=m(Se,Re,ke.o),ke.i=m(me,He,ke.i),ke.n=m(Pe,Me,ke.n),ke.s=m(xe,Ze,ke.s),ke.h=m(he,Ye,ke.h),ke.r=m(ve,ut,ke.r),ke},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),Y}})}}),B(Ge,{get when(){return Te(()=>g()==="detail")()&&h()},get children(){return[(()=>{var Y=VD();return Y.firstChild,Y.$$click=()=>{p("dashboard"),y(null)},m(Y,j),l(Y,()=>e("invoices.backToDashboard"),null),Y})(),B(m8,{get invoice(){return h()},onPrint:()=>window.print(),goBack:()=>{p("dashboard"),y(null)}})]}})]}}),null),l(J,B(Ge,{get when(){return V()==="add"},get children(){return B(mD,{})}}),null),l(J,B(Ge,{get when(){return V()==="report"},get children(){return B(RD,{})}}),null),J}})};dr(["click"]);const GD=()=>B(WD,{invoices:[{type:"SALES",invoice:"20255FK6S4B43SSS",description:"",store:"YY_8816",ssg_inventory_key:"JqdrRwGBpdBfRCim",ssg_sorder_key:"JqdrRwGBpdBfRCim",createDate:1736132690425,shipper_consignee:{name:"Yudith Perez Medero",phoneNumberS:"5022408378",dob:"1982-07-23",firstName:"RAUL",lastName:"BATISTA",lastName2:"ESPOSITO",middleName:"",email:"",phoneNumber:"52393232",altPhoneNumber:"",cid:"48121007305",ybstreetNo:"9",ybstreet:"10",ybbetwen1:"CARRALERO",ybbetwen2:"3RA",ybapt:"",ybreparto:"PUEBLO NUEVO",consigneeId:"26144",ssg_consignee_key:"26144",passport:"NA",nacionality:"CUB",ybcity:"HOLGUIN",ybestate:"HOLGUIN",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534800",reservas:[{type:"UTILES DEL HOGAR",qty:"15",arancel:"10",price:"5",key:"1GB16SD80"},{type:"MISCELANEAS",qty:"19",arancel:"",price:"4",key:"0DS6K14Y2"}],products:[{product:{id:"CmrhMfVjLR9HxT6P",label:"FOGONES ELECTRICO DOBLE RESISTENCIA DE ALAMBRE",code:"978Y82K94"},qty:-1,price:23.696296296296296,salePrice:"34"},{product:{id:"ov56aPYGbXIq4XGy",label:"Caramelos",code:"C852CSKB5"},qty:-2,price:5.990000000000001,salePrice:"10"}],isCompleted:!0},{type:"SALES",invoice:"20255FK6S4B43TTT",description:"",store:"YY_8803",ssg_inventory_key:"JqdrRwGBpdBfRCin",ssg_sorder_key:"JqdrRwGBpdBfRCin",createDate:1736032690425,shipper_consignee:{name:"Maria Rodriguez Santos",phoneNumberS:"5024567890",dob:"1990-03-15",firstName:"MARIA",lastName:"RODRIGUEZ",lastName2:"SANTOS",middleName:"ELENA",email:"maria@email.com",phoneNumber:"52987654",altPhoneNumber:"",cid:"90031507890",ybstreetNo:"15",ybstreet:"23",ybbetwen1:"MARTI",ybbetwen2:"CESPEDES",ybapt:"2A",ybreparto:"CENTRO",consigneeId:"26145",ssg_consignee_key:"26145",passport:"A1234567",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534801",reservas:[{type:"ELECTRONICOS",qty:"5",arancel:"15",price:"12",key:"2GB16SD81"},{type:"ROPA Y CALZADO",qty:"8",arancel:"8",price:"7",key:"0DS6K14Y3"}],products:[{product:{id:"XmrhMfVjLR9HxT6Q",label:"TELEVISOR LED 32 PULGADAS",code:"TV32LED01"},qty:-1,price:150.5,salePrice:"220"},{product:{id:"Yv56aPYGbXIq4XGz",label:"Zapatos Deportivos Nike",code:"ZAP001"},qty:-1,price:45.99,salePrice:"75"}],isCompleted:!1},{type:"SALES",invoice:"20255FK6S4B43UUU",description:"",store:"YY_8816",ssg_inventory_key:"JqdrRwGBpdBfRCio",ssg_sorder_key:"JqdrRwGBpdBfRCio",createDate:1735932690425,shipper_consignee:{name:"Carlos Mendez Perez",phoneNumberS:"5025678901",dob:"1975-12-08",firstName:"CARLOS",lastName:"MENDEZ",lastName2:"PEREZ",middleName:"ANTONIO",email:"",phoneNumber:"52876543",altPhoneNumber:"",cid:"75120878901",ybstreetNo:"7",ybstreet:"45",ybbetwen1:"LINEA",ybbetwen2:"PASEO",ybapt:"",ybreparto:"VEDADO",consigneeId:"26146",ssg_consignee_key:"26146",passport:"NA",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534802",reservas:[{type:"ALIMENTOS",qty:"25",arancel:"5",price:"3",key:"3GB16SD82"}],products:[{product:{id:"ZmrhMfVjLR9HxT6R",label:"ARROZ ESPECIAL 5LB",code:"ARZ005"},qty:-5,price:2.5,salePrice:"4"},{product:{id:"Av56aPYGbXIq4XG1",label:"ACEITE DE COCINA 1L",code:"ACE001"},qty:-3,price:3.75,salePrice:"6"}],isCompleted:!0},{type:"SALES",invoice:"20255FK6S4B43VVV",description:"",store:"YY_8802",ssg_inventory_key:"JqdrRwGBpdBfRCip",ssg_sorder_key:"JqdrRwGBpdBfRCip",createDate:1735832690425,shipper_consignee:{name:"Ana Lucia Fernandez",phoneNumberS:"5026789012",dob:"1988-06-20",firstName:"ANA",lastName:"FERNANDEZ",lastName2:"LOPEZ",middleName:"LUCIA",email:"ana.lucia@email.com",phoneNumber:"52765432",altPhoneNumber:"52111222",cid:"88062076789",ybstreetNo:"12",ybstreet:"18",ybbetwen1:"CALZADA",ybbetwen2:"SAN LAZARO",ybapt:"3B",ybreparto:"CENTRO HABANA",consigneeId:"26147",ssg_consignee_key:"26147",passport:"B9876543",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:"Entrega en horario de oficina"},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534803",reservas:[{type:"MEDICINA Y SALUD",qty:"10",arancel:"12",price:"8",key:"4GB16SD83"},{type:"UTILES DEL HOGAR",qty:"6",arancel:"6",price:"4",key:"5GB16SD84"}],products:[{product:{id:"BmrhMfVjLR9HxT6S",label:"VITAMINAS MULTIPLES 60 CAP",code:"VIT001"},qty:-2,price:12.5,salePrice:"18"}],isCompleted:!0}]}),lh={invoice:"",description:"",store:"",shipper_consignee:{name:"",firstName:"",middleName:"",lastName:"",lastName2:"",phoneNumber:"",cid:"",passport:"",address:""},products:[],reservas:[],packagesOrder:!1,shippingType:"SEA"},By="invoice_form_draft",YD=()=>{try{const t=localStorage.getItem(By);if(t){const e=JSON.parse(t),r={...lh,...e,shipper_consignee:{...lh.shipper_consignee,...e.shipper_consignee||{}},products:e.products||[],reservas:e.reservas||[]};return console.log("Loaded form data from storage:",r),r}}catch(t){console.warn("Failed to load invoice form from storage:",t)}return console.log("No saved data found, using default form data"),{...lh}},jy=t=>{try{localStorage.setItem(By,JSON.stringify(t))}catch(e){console.warn("Failed to save invoice form to storage:",e)}},v1=()=>{try{localStorage.removeItem(By)}catch(t){console.warn("Failed to clear invoice form from storage:",t)}},[hl,As]=$e(YD()),[d_,ko]=$e(!1),[KD,ch]=$e(null);let Cp=null;const ma=()=>{Cp&&clearTimeout(Cp),Cp=setTimeout(()=>{const t=hl();jy(t),ch(new Date),console.log("Invoice form auto-saved at",new Date().toLocaleTimeString())},1e3)},JD={formData:hl,get isDirty(){return d_()},get lastSaved(){return KD()},updateForm:t=>{As(e=>{const r={...e,...t};return ko(!0),ma(),r})},updateShipperConsignee:t=>{As(e=>{const r={...e,shipper_consignee:{...e.shipper_consignee,...t}};return ko(!0),ma(),r})},addProduct:t=>{As(e=>{const r={...e,products:[...e.products,t]};return ko(!0),ma(),r})},updateProduct:(t,e)=>{As(r=>{const n=[...r.products];n[t]={...n[t],...e};const i={...r,products:n};return ko(!0),ma(),i})},removeProduct:t=>{As(e=>{const r=e.products.filter((i,o)=>o!==t),n={...e,products:r};return ko(!0),ma(),n})},addReserva:t=>{As(e=>{const r={...e,reservas:[...e.reservas,t]};return ko(!0),ma(),r})},updateReserva:(t,e)=>{As(r=>{const n=[...r.reservas];n[t]={...n[t],...e};const i={...r,reservas:n};return ko(!0),ma(),i})},removeReserva:t=>{As(e=>{const r=e.reservas.filter((i,o)=>o!==t),n={...e,reservas:r};return ko(!0),ma(),n})},clearForm:()=>{As({...lh}),ko(!1),v1(),ch(null)},markCompleted:()=>{v1(),ko(!1),ch(null)},forceSave:()=>{jy(hl()),ch(new Date),ko(!1)},hasData:()=>{const t=hl();return t.invoice!==""||t.description!==""||t.store!==""||t.shipper_consignee.name!==""||t.shipper_consignee.firstName!==""||t.shipper_consignee.cid!==""||t.products.length>0||t.reservas.length>0},isValid:()=>{const t=hl();return t.invoice.trim()!==""&&t.shipper_consignee.firstName.trim()!==""&&t.shipper_consignee.lastName.trim()!==""&&t.shipper_consignee.cid.trim()!==""&&(t.products.length>0||t.reservas.length>0)},getFormData:()=>hl()};typeof window<"u"&&window.addEventListener("beforeunload",t=>{if(d_()&&(jy(hl()),JD.hasData()))return t.preventDefault(),t.returnValue="You have unsaved changes in your invoice. Are you sure you want to leave?",t.returnValue});var QD=de("<div><main>");const XD=t=>[B(i$,{}),Te(()=>t.children)],ZD=()=>B(DI,{get children(){var t=QD(),e=t.firstChild;return l(e,B(rS,{root:XD,get children(){return[B(fo,{path:"/",component:GL}),B(fo,{path:"/accounts",component:()=>B(Io,{permission:"AccountAccess",featureName:"Accounts",get children(){return B(nE,{})}})}),B(fo,{path:"/accounts/:id",component:()=>B(Io,{permission:"AccountAccess",featureName:"Account Details",get children(){return B(uE,{})}})}),B(fo,{path:"/entry-books",component:()=>B(Io,{permission:"JournalAccess",featureName:"Entry Books",get children(){return B(YN,{})}})}),B(fo,{path:"/employees",component:()=>B(Io,{permission:"EmployeeAccess",featureName:"Employee Management",get children(){return B(u6,{})}})}),B(fo,{path:"/bank-consolidations",component:()=>B(Io,{permission:"BankingAccess",featureName:"Bank Consolidations",get children(){return B(O6,{})}})}),B(fo,{path:"/balance-sheet",component:()=>B(Io,{permission:"AccountAccess",featureName:"Balance Sheet",get children(){return B(yE,{})}})}),B(fo,{path:"/invoices",component:()=>B(Io,{permission:"invoiceAccess",featureName:"Invoices",get children(){return B(GD,{})}})}),B(fo,{path:"/inventory",component:()=>B(Io,{permission:"InventoryAccess",featureName:"Inventory Management",get children(){return B(t6,{})}})}),B(fo,{path:"/products",component:()=>B(Io,{permission:"InventoryAccess",featureName:"Product Management",get children(){return B(w5,{})}})}),B(fo,{path:"/hbl",component:()=>B(Io,{permission:"HBLAccess",featureName:"HBL Management",get children(){return B(jL,{})}})}),B(fo,{path:"/admin/users",component:()=>B(Io,{permission:"isAdmin",featureName:"User Administration",get children(){return B(i8,{})}})})]}})),l(t,(()=>{var r=Te(()=>!1);return()=>r()&&B(y$,{})})(),null),t}}),eR=document.getElementById("root");gw(()=>B(ZD,{}),eR);export{or as E,Ni as _,sn as a,iR as b,H5 as j};
