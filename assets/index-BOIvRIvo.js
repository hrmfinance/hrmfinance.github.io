(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const cg=!1,ug=(t,e)=>t===e,Gr=Symbol("solid-proxy"),Kh=typeof Proxy=="function",kl=Symbol("solid-track"),Zs={equals:ug};let Qh=im;const Zn=1,ea=2,Jh={owned:null,cleanups:null,context:null,owner:null};var It=null;let el=null,dg=null,Mt=null,wr=null,Pn=null,xa=0;function Do(t,e){const r=Mt,n=It,i=t.length===0,o=e===void 0?n:e,a=i?Jh:{owned:null,cleanups:null,context:o?o.context:null,owner:o},c=i?t:()=>t(()=>Fr(()=>Uo(a)));It=a,Mt=null;try{return ti(c,!0)}finally{Mt=r,It=n}}function ye(t,e){e=e?Object.assign({},Zs,e):Zs;const r={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},n=i=>(typeof i=="function"&&(i=i(r.value)),nm(r,i));return[rm.bind(r),n]}function se(t,e,r){const n=fc(t,e,!1,Zn);ts(n)}function ei(t,e,r){Qh=yg;const n=fc(t,e,!1,Zn);n.user=!0,Pn?Pn.push(n):ts(n)}function ze(t,e,r){r=r?Object.assign({},Zs,r):Zs;const n=fc(t,e,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=r.equals||void 0,ts(n),rm.bind(n)}function Xh(t){return ti(t,!1)}function Fr(t){if(Mt===null)return t();const e=Mt;Mt=null;try{return t()}finally{Mt=e}}function dc(t,e,r){const n=Array.isArray(t);let i,o=r&&r.defer;return a=>{let c;if(n){c=Array(t.length);for(let h=0;h<t.length;h++)c[h]=t[h]()}else c=t();if(o)return o=!1,a;const u=Fr(()=>e(c,i,a));return i=c,u}}function un(t){ei(()=>Fr(t))}function ro(t){return It===null||(It.cleanups===null?It.cleanups=[t]:It.cleanups.push(t)),t}function Rl(){return Mt}function Zh(){return It}function em(t,e){const r=It,n=Mt;It=t,Mt=null;try{return ti(e,!0)}catch(i){yc(i)}finally{It=r,Mt=n}}function hg(t){const e=Mt,r=It;return Promise.resolve().then(()=>{Mt=e,It=r;let n;return ti(t,!1),Mt=It=null,n?n.done:void 0})}const[Cx,Ax]=ye(!1);function tm(t,e){const r=Symbol("context");return{id:r,Provider:pg(r),defaultValue:t}}function hc(t){let e;return It&&It.context&&(e=It.context[t.id])!==void 0?e:t.defaultValue}function mc(t){const e=ze(t),r=ze(()=>Dl(e()));return r.toArray=()=>{const n=r();return Array.isArray(n)?n:n!=null?[n]:[]},r}function rm(){if(this.sources&&this.state)if(this.state===Zn)ts(this);else{const t=wr;wr=null,ti(()=>ra(this),!1),wr=t}if(Mt){const t=this.observers?this.observers.length:0;Mt.sources?(Mt.sources.push(this),Mt.sourceSlots.push(t)):(Mt.sources=[this],Mt.sourceSlots=[t]),this.observers?(this.observers.push(Mt),this.observerSlots.push(Mt.sources.length-1)):(this.observers=[Mt],this.observerSlots=[Mt.sources.length-1])}return this.value}function nm(t,e,r){let n=t.value;return(!t.comparator||!t.comparator(n,e))&&(t.value=e,t.observers&&t.observers.length&&ti(()=>{for(let i=0;i<t.observers.length;i+=1){const o=t.observers[i],a=el&&el.running;a&&el.disposed.has(o),(a?!o.tState:!o.state)&&(o.pure?wr.push(o):Pn.push(o),o.observers&&om(o)),a||(o.state=Zn)}if(wr.length>1e6)throw wr=[],new Error},!1)),e}function ts(t){if(!t.fn)return;Uo(t);const e=xa;mg(t,t.value,e)}function mg(t,e,r){let n;const i=It,o=Mt;Mt=It=t;try{n=t.fn(e)}catch(a){return t.pure&&(t.state=Zn,t.owned&&t.owned.forEach(Uo),t.owned=null),t.updatedAt=r+1,yc(a)}finally{Mt=o,It=i}(!t.updatedAt||t.updatedAt<=r)&&(t.updatedAt!=null&&"observers"in t?nm(t,n):t.value=n,t.updatedAt=r)}function fc(t,e,r,n=Zn,i){const o={fn:t,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:It,context:It?It.context:null,pure:r};return It===null||It!==Jh&&(It.owned?It.owned.push(o):It.owned=[o]),o}function ta(t){if(t.state===0)return;if(t.state===ea)return ra(t);if(t.suspense&&Fr(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<xa);)t.state&&e.push(t);for(let r=e.length-1;r>=0;r--)if(t=e[r],t.state===Zn)ts(t);else if(t.state===ea){const n=wr;wr=null,ti(()=>ra(t,e[0]),!1),wr=n}}function ti(t,e){if(wr)return t();let r=!1;e||(wr=[]),Pn?r=!0:Pn=[],xa++;try{const n=t();return fg(r),n}catch(n){r||(Pn=null),wr=null,yc(n)}}function fg(t){if(wr&&(im(wr),wr=null),t)return;const e=Pn;Pn=null,e.length&&ti(()=>Qh(e),!1)}function im(t){for(let e=0;e<t.length;e++)ta(t[e])}function yg(t){let e,r=0;for(e=0;e<t.length;e++){const n=t[e];n.user?t[r++]=n:ta(n)}for(e=0;e<r;e++)ta(t[e])}function ra(t,e){t.state=0;for(let r=0;r<t.sources.length;r+=1){const n=t.sources[r];if(n.sources){const i=n.state;i===Zn?n!==e&&(!n.updatedAt||n.updatedAt<xa)&&ta(n):i===ea&&ra(n,e)}}}function om(t){for(let e=0;e<t.observers.length;e+=1){const r=t.observers[e];r.state||(r.state=ea,r.pure?wr.push(r):Pn.push(r),r.observers&&om(r))}}function Uo(t){let e;if(t.sources)for(;t.sources.length;){const r=t.sources.pop(),n=t.sourceSlots.pop(),i=r.observers;if(i&&i.length){const o=i.pop(),a=r.observerSlots.pop();n<i.length&&(o.sourceSlots[a]=n,i[n]=o,r.observerSlots[n]=a)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)Uo(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)Uo(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function gg(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function yc(t,e=It){throw gg(t)}function Dl(t){if(typeof t=="function"&&!t.length)return Dl(t());if(Array.isArray(t)){const e=[];for(let r=0;r<t.length;r++){const n=Dl(t[r]);Array.isArray(n)?e.push.apply(e,n):e.push(n)}return e}return t}function pg(t,e){return function(n){let i;return se(()=>i=Fr(()=>(It.context={...It.context,[t]:n.value},mc(()=>n.children))),void 0),i}}const vg=Symbol("fallback");function Bu(t){for(let e=0;e<t.length;e++)t[e]()}function bg(t,e,r={}){let n=[],i=[],o=[],a=0,c=e.length>1?[]:null;return ro(()=>Bu(o)),()=>{let u=t()||[],h=u.length,f,p;return u[kl],Fr(()=>{let C,R,E,x,T,W,te,Q,de;if(h===0)a!==0&&(Bu(o),o=[],n=[],i=[],a=0,c&&(c=[])),r.fallback&&(n=[vg],i[0]=Do(ae=>(o[0]=ae,r.fallback())),a=1);else if(a===0){for(i=new Array(h),p=0;p<h;p++)n[p]=u[p],i[p]=Do(b);a=h}else{for(E=new Array(h),x=new Array(h),c&&(T=new Array(h)),W=0,te=Math.min(a,h);W<te&&n[W]===u[W];W++);for(te=a-1,Q=h-1;te>=W&&Q>=W&&n[te]===u[Q];te--,Q--)E[Q]=i[te],x[Q]=o[te],c&&(T[Q]=c[te]);for(C=new Map,R=new Array(Q+1),p=Q;p>=W;p--)de=u[p],f=C.get(de),R[p]=f===void 0?-1:f,C.set(de,p);for(f=W;f<=te;f++)de=n[f],p=C.get(de),p!==void 0&&p!==-1?(E[p]=i[f],x[p]=o[f],c&&(T[p]=c[f]),p=R[p],C.set(de,p)):o[f]();for(p=W;p<h;p++)p in E?(i[p]=E[p],o[p]=x[p],c&&(c[p]=T[p],c[p](p))):i[p]=Do(b);i=i.slice(0,a=h),n=u.slice(0)}return i});function b(C){if(o[p]=C,c){const[R,E]=ye(p);return c[p]=E,e(u[p],R)}return e(u[p])}}}function S(t,e){return Fr(()=>t(e||{}))}function Cs(){return!0}const Nl={get(t,e,r){return e===Gr?r:t.get(e)},has(t,e){return e===Gr?!0:t.has(e)},set:Cs,deleteProperty:Cs,getOwnPropertyDescriptor(t,e){return{configurable:!0,enumerable:!0,get(){return t.get(e)},set:Cs,deleteProperty:Cs}},ownKeys(t){return t.keys()}};function tl(t){return(t=typeof t=="function"?t():t)?t:{}}function _g(){for(let t=0,e=this.length;t<e;++t){const r=this[t]();if(r!==void 0)return r}}function Ll(...t){let e=!1;for(let a=0;a<t.length;a++){const c=t[a];e=e||!!c&&Gr in c,t[a]=typeof c=="function"?(e=!0,ze(c)):c}if(Kh&&e)return new Proxy({get(a){for(let c=t.length-1;c>=0;c--){const u=tl(t[c])[a];if(u!==void 0)return u}},has(a){for(let c=t.length-1;c>=0;c--)if(a in tl(t[c]))return!0;return!1},keys(){const a=[];for(let c=0;c<t.length;c++)a.push(...Object.keys(tl(t[c])));return[...new Set(a)]}},Nl);const r={},n=Object.create(null);for(let a=t.length-1;a>=0;a--){const c=t[a];if(!c)continue;const u=Object.getOwnPropertyNames(c);for(let h=u.length-1;h>=0;h--){const f=u[h];if(f==="__proto__"||f==="constructor")continue;const p=Object.getOwnPropertyDescriptor(c,f);if(!n[f])n[f]=p.get?{enumerable:!0,configurable:!0,get:_g.bind(r[f]=[p.get.bind(c)])}:p.value!==void 0?p:void 0;else{const b=r[f];b&&(p.get?b.push(p.get.bind(c)):p.value!==void 0&&b.push(()=>p.value))}}}const i={},o=Object.keys(n);for(let a=o.length-1;a>=0;a--){const c=o[a],u=n[c];u&&u.get?Object.defineProperty(i,c,u):i[c]=u?u.value:void 0}return i}function Sg(t,...e){if(Kh&&Gr in t){const i=new Set(e.length>1?e.flat():e[0]),o=e.map(a=>new Proxy({get(c){return a.includes(c)?t[c]:void 0},has(c){return a.includes(c)&&c in t},keys(){return a.filter(c=>c in t)}},Nl));return o.push(new Proxy({get(a){return i.has(a)?void 0:t[a]},has(a){return i.has(a)?!1:a in t},keys(){return Object.keys(t).filter(a=>!i.has(a))}},Nl)),o}const r={},n=e.map(()=>({}));for(const i of Object.getOwnPropertyNames(t)){const o=Object.getOwnPropertyDescriptor(t,i),a=!o.get&&!o.set&&o.enumerable&&o.writable&&o.configurable;let c=!1,u=0;for(const h of e)h.includes(i)&&(c=!0,a?n[u][i]=o.value:Object.defineProperty(n[u],i,o)),++u;c||(a?r[i]=o.value:Object.defineProperty(r,i,o))}return[...n,r]}const Pg=t=>`Stale read from <${t}>.`;function Ot(t){const e="fallback"in t&&{fallback:()=>t.fallback};return ze(bg(()=>t.each,t.children,e||void 0))}function Ve(t){const e=t.keyed,r=ze(()=>t.when,void 0,void 0),n=e?r:ze(r,void 0,{equals:(i,o)=>!i==!o});return ze(()=>{const i=n();if(i){const o=t.children;return typeof o=="function"&&o.length>0?Fr(()=>o(e?i:()=>{if(!Fr(n))throw Pg("Show");return r()})):o}return t.fallback},void 0,void 0)}const wg=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],Cg=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline",...wg]),Ag=new Set(["innerHTML","textContent","innerText","children"]),Ig=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),Eg=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}});function xg(t,e){const r=Eg[t];return typeof r=="object"?r[e]?r.$:void 0:r}const Tg=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),me=t=>ze(()=>t());function $g(t,e,r){let n=r.length,i=e.length,o=n,a=0,c=0,u=e[i-1].nextSibling,h=null;for(;a<i||c<o;){if(e[a]===r[c]){a++,c++;continue}for(;e[i-1]===r[o-1];)i--,o--;if(i===a){const f=o<n?c?r[c-1].nextSibling:r[o-c]:u;for(;c<o;)t.insertBefore(r[c++],f)}else if(o===c)for(;a<i;)(!h||!h.has(e[a]))&&e[a].remove(),a++;else if(e[a]===r[o-1]&&r[c]===e[i-1]){const f=e[--i].nextSibling;t.insertBefore(r[c++],e[a++].nextSibling),t.insertBefore(r[--o],f),e[i]=r[o]}else{if(!h){h=new Map;let p=c;for(;p<o;)h.set(r[p],p++)}const f=h.get(e[a]);if(f!=null)if(c<f&&f<o){let p=a,b=1,C;for(;++p<i&&p<o&&!((C=h.get(e[p]))==null||C!==f+b);)b++;if(b>f-c){const R=e[a];for(;c<f;)t.insertBefore(r[c++],R)}else t.replaceChild(r[c++],e[a++])}else a++;else e[a++].remove()}}}const Fu="_$DX_DELEGATE";function kg(t,e,r,n={}){let i;return Do(o=>{i=o,e===document?t():s(e,t(),e.firstChild?null:void 0,r)},n.owner),()=>{i(),e.textContent=""}}function H(t,e,r,n){let i;const o=()=>{const c=document.createElement("template");return c.innerHTML=t,c.content.firstChild},a=()=>(i||(i=o())).cloneNode(!0);return a.cloneNode=a,a}function wt(t,e=window.document){const r=e[Fu]||(e[Fu]=new Set);for(let n=0,i=t.length;n<i;n++){const o=t[n];r.has(o)||(r.add(o),e.addEventListener(o,Vg))}}function ct(t,e,r){r==null?t.removeAttribute(e):t.setAttribute(e,r)}function Rg(t,e,r){r?t.setAttribute(e,""):t.removeAttribute(e)}function gc(t,e){e==null?t.removeAttribute("class"):t.className=e}function Ci(t,e,r,n){if(n)Array.isArray(r)?(t[`$$${e}`]=r[0],t[`$$${e}Data`]=r[1]):t[`$$${e}`]=r;else if(Array.isArray(r)){const i=r[0];t.addEventListener(e,r[0]=o=>i.call(t,r[1],o))}else t.addEventListener(e,r,typeof r!="function"&&r)}function Dg(t,e,r={}){const n=Object.keys(e||{}),i=Object.keys(r);let o,a;for(o=0,a=i.length;o<a;o++){const c=i[o];!c||c==="undefined"||e[c]||(Uu(t,c,!1),delete r[c])}for(o=0,a=n.length;o<a;o++){const c=n[o],u=!!e[c];!c||c==="undefined"||r[c]===u||!u||(Uu(t,c,!0),r[c]=u)}return r}function d(t,e,r){if(!e)return r?ct(t,"style"):e;const n=t.style;if(typeof e=="string")return n.cssText=e;typeof r=="string"&&(n.cssText=r=void 0),r||(r={}),e||(e={});let i,o;for(o in r)e[o]==null&&n.removeProperty(o),delete r[o];for(o in e)i=e[o],i!==r[o]&&(n.setProperty(o,i),r[o]=i);return r}function Ng(t,e={},r,n){const i={};return se(()=>i.children=jo(t,e.children,i.children)),se(()=>typeof e.ref=="function"&&Lg(e.ref,t)),se(()=>Mg(t,e,r,!0,i,!0)),i}function Lg(t,e,r){return Fr(()=>t(e,r))}function s(t,e,r,n){if(r!==void 0&&!n&&(n=[]),typeof e!="function")return jo(t,e,n,r);se(i=>jo(t,e(),i,r),n)}function Mg(t,e,r,n,i={},o=!1){e||(e={});for(const a in i)if(!(a in e)){if(a==="children")continue;i[a]=ju(t,a,null,i[a],r,o,e)}for(const a in e){if(a==="children")continue;const c=e[a];i[a]=ju(t,a,c,i[a],r,o,e)}}function Og(t){return t.toLowerCase().replace(/-([a-z])/g,(e,r)=>r.toUpperCase())}function Uu(t,e,r){const n=e.trim().split(/\s+/);for(let i=0,o=n.length;i<o;i++)t.classList.toggle(n[i],r)}function ju(t,e,r,n,i,o,a){let c,u,h,f,p;if(e==="style")return d(t,r,n);if(e==="classList")return Dg(t,r,n);if(r===n)return n;if(e==="ref")o||r(t);else if(e.slice(0,3)==="on:"){const b=e.slice(3);n&&t.removeEventListener(b,n,typeof n!="function"&&n),r&&t.addEventListener(b,r,typeof r!="function"&&r)}else if(e.slice(0,10)==="oncapture:"){const b=e.slice(10);n&&t.removeEventListener(b,n,!0),r&&t.addEventListener(b,r,!0)}else if(e.slice(0,2)==="on"){const b=e.slice(2).toLowerCase(),C=Tg.has(b);if(!C&&n){const R=Array.isArray(n)?n[0]:n;t.removeEventListener(b,R)}(C||r)&&(Ci(t,b,r,C),C&&wt([b]))}else e.slice(0,5)==="attr:"?ct(t,e.slice(5),r):e.slice(0,5)==="bool:"?Rg(t,e.slice(5),r):(p=e.slice(0,5)==="prop:")||(h=Ag.has(e))||(f=xg(e,t.tagName))||(u=Cg.has(e))||(c=t.nodeName.includes("-")||"is"in a)?(p&&(e=e.slice(5),u=!0),e==="class"||e==="className"?gc(t,r):c&&!u&&!h?t[Og(e)]=r:t[f||e]=r):ct(t,Ig[e]||e,r);return r}function Vg(t){let e=t.target;const r=`$$${t.type}`,n=t.target,i=t.currentTarget,o=u=>Object.defineProperty(t,"target",{configurable:!0,value:u}),a=()=>{const u=e[r];if(u&&!e.disabled){const h=e[`${r}Data`];if(h!==void 0?u.call(e,h,t):u.call(e,t),t.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(t.target)&&o(e.host),!0},c=()=>{for(;a()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return e||document}}),t.composedPath){const u=t.composedPath();o(u[0]);for(let h=0;h<u.length-2&&(e=u[h],!!a());h++){if(e._$host){e=e._$host,c();break}if(e.parentNode===i)break}}else c();o(n)}function jo(t,e,r,n,i){for(;typeof r=="function";)r=r();if(e===r)return r;const o=typeof e,a=n!==void 0;if(t=a&&r[0]&&r[0].parentNode||t,o==="string"||o==="number"){if(o==="number"&&(e=e.toString(),e===r))return r;if(a){let c=r[0];c&&c.nodeType===3?c.data!==e&&(c.data=e):c=document.createTextNode(e),r=Ni(t,r,n,c)}else r!==""&&typeof r=="string"?r=t.firstChild.data=e:r=t.textContent=e}else if(e==null||o==="boolean")r=Ni(t,r,n);else{if(o==="function")return se(()=>{let c=e();for(;typeof c=="function";)c=c();r=jo(t,c,r,n)}),()=>r;if(Array.isArray(e)){const c=[],u=r&&Array.isArray(r);if(Ml(c,e,r,i))return se(()=>r=jo(t,c,r,n,!0)),()=>r;if(c.length===0){if(r=Ni(t,r,n),a)return r}else u?r.length===0?zu(t,c,n):$g(t,r,c):(r&&Ni(t),zu(t,c));r=c}else if(e.nodeType){if(Array.isArray(r)){if(a)return r=Ni(t,r,n,e);Ni(t,r,null,e)}else r==null||r===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);r=e}}return r}function Ml(t,e,r,n){let i=!1;for(let o=0,a=e.length;o<a;o++){let c=e[o],u=r&&r[t.length],h;if(!(c==null||c===!0||c===!1))if((h=typeof c)=="object"&&c.nodeType)t.push(c);else if(Array.isArray(c))i=Ml(t,c,u)||i;else if(h==="function")if(n){for(;typeof c=="function";)c=c();i=Ml(t,Array.isArray(c)?c:[c],Array.isArray(u)?u:[u])||i}else t.push(c),i=!0;else{const f=String(c);u&&u.nodeType===3&&u.data===f?t.push(u):t.push(document.createTextNode(f))}}return i}function zu(t,e,r=null){for(let n=0,i=e.length;n<i;n++)t.insertBefore(e[n],r)}function Ni(t,e,r,n){if(r===void 0)return t.textContent="";const i=n||document.createTextNode("");if(e.length){let o=!1;for(let a=e.length-1;a>=0;a--){const c=e[a];if(i!==c){const u=c.parentNode===t;!o&&!a?u?t.replaceChild(i,c):t.insertBefore(i,r):u&&c.remove()}else o=!0}}else t.insertBefore(i,r);return[i]}const Bg=!1;function sm(){let t=new Set;function e(i){return t.add(i),()=>t.delete(i)}let r=!1;function n(i,o){if(r)return!(r=!1);const a={to:i,options:o,defaultPrevented:!1,preventDefault:()=>a.defaultPrevented=!0};for(const c of t)c.listener({...a,from:c.location,retry:u=>{u&&(r=!0),c.navigate(i,{...o,resolve:!1})}});return!a.defaultPrevented}return{subscribe:e,confirm:n}}let Ol;function pc(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),Ol=window.history.state._depth}pc();function Fg(t){return{...t,_depth:window.history.state&&window.history.state._depth}}function Ug(t,e){let r=!1;return()=>{const n=Ol;pc();const i=n==null?null:Ol-n;if(r){r=!1;return}i&&e(i)?(r=!0,window.history.go(-i)):t()}}const jg=/^(?:[a-z0-9]+:)?\/\//i,zg=/^\/+|(\/)\/+$/g,am="http://sr";function gi(t,e=!1){const r=t.replace(zg,"$1");return r?e||/^[?#]/.test(r)?r:"/"+r:""}function Us(t,e,r){if(jg.test(e))return;const n=gi(t),i=r&&gi(r);let o="";return!i||e.startsWith("/")?o=n:i.toLowerCase().indexOf(n.toLowerCase())!==0?o=n+i:o=i,(o||"/")+gi(e,!o)}function qg(t,e){if(t==null)throw new Error(e);return t}function Hg(t,e){return gi(t).replace(/\/*(\*.*)?$/g,"")+gi(e)}function lm(t){const e={};return t.searchParams.forEach((r,n)=>{n in e?Array.isArray(e[n])?e[n].push(r):e[n]=[e[n],r]:e[n]=r}),e}function Wg(t,e,r){const[n,i]=t.split("/*",2),o=n.split("/").filter(Boolean),a=o.length;return c=>{const u=c.split("/").filter(Boolean),h=u.length-a;if(h<0||h>0&&i===void 0&&!e)return null;const f={path:a?"":"/",params:{}},p=b=>r===void 0?void 0:r[b];for(let b=0;b<a;b++){const C=o[b],R=C[0]===":",E=R?u[b]:u[b].toLowerCase(),x=R?C.slice(1):C.toLowerCase();if(R&&rl(E,p(x)))f.params[x]=E;else if(R||!rl(E,x))return null;f.path+=`/${E}`}if(i){const b=h?u.slice(-h).join("/"):"";if(rl(b,p(i)))f.params[i]=b;else return null}return f}}function rl(t,e){const r=n=>n===t;return e===void 0?!0:typeof e=="string"?r(e):typeof e=="function"?e(t):Array.isArray(e)?e.some(r):e instanceof RegExp?e.test(t):!1}function Gg(t){const[e,r]=t.pattern.split("/*",2),n=e.split("/").filter(Boolean);return n.reduce((i,o)=>i+(o.startsWith(":")?2:3),n.length-(r===void 0?0:1))}function cm(t){const e=new Map,r=Zh();return new Proxy({},{get(n,i){return e.has(i)||em(r,()=>e.set(i,ze(()=>t()[i]))),e.get(i)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(t())}})}function um(t){let e=/(\/?\:[^\/]+)\?/.exec(t);if(!e)return[t];let r=t.slice(0,e.index),n=t.slice(e.index+e[0].length);const i=[r,r+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(n);)i.push(r+=e[1]),n=n.slice(e[0].length);return um(n).reduce((o,a)=>[...o,...i.map(c=>c+a)],[])}const Yg=100,dm=tm(),vc=tm(),rs=()=>qg(hc(dm),"<A> and 'use' router primitives can be only used inside a Route."),Kg=()=>hc(vc)||rs().base,Qg=t=>{const e=Kg();return ze(()=>e.resolvePath(t()))},Jg=t=>{const e=rs();return ze(()=>{const r=t();return r!==void 0?e.renderPath(r):r})},bc=()=>rs().navigatorFactory(),Xg=()=>rs().location,Zg=()=>rs().params;function ep(t,e=""){const{component:r,preload:n,load:i,children:o,info:a}=t,c=!o||Array.isArray(o)&&!o.length,u={key:t,component:r,preload:n||i,info:a};return hm(t.path).reduce((h,f)=>{for(const p of um(f)){const b=Hg(e,p);let C=c?b:b.split("/*",1)[0];C=C.split("/").map(R=>R.startsWith(":")||R.startsWith("*")?R:encodeURIComponent(R)).join("/"),h.push({...u,originalPath:f,pattern:C,matcher:Wg(C,!c,t.matchFilters)})}return h},[])}function tp(t,e=0){return{routes:t,score:Gg(t[t.length-1])*1e4-e,matcher(r){const n=[];for(let i=t.length-1;i>=0;i--){const o=t[i],a=o.matcher(r);if(!a)return null;n.unshift({...a,route:o})}return n}}}function hm(t){return Array.isArray(t)?t:[t]}function mm(t,e="",r=[],n=[]){const i=hm(t);for(let o=0,a=i.length;o<a;o++){const c=i[o];if(c&&typeof c=="object"){c.hasOwnProperty("path")||(c.path="");const u=ep(c,e);for(const h of u){r.push(h);const f=Array.isArray(c.children)&&c.children.length===0;if(c.children&&!f)mm(c.children,h.pattern,r,n);else{const p=tp([...r],n.length);n.push(p)}r.pop()}}}return r.length?n:n.sort((o,a)=>a.score-o.score)}function nl(t,e){for(let r=0,n=t.length;r<n;r++){const i=t[r].matcher(e);if(i)return i}return[]}function rp(t,e,r){const n=new URL(am),i=ze(f=>{const p=t();try{return new URL(p,n)}catch{return console.error(`Invalid path ${p}`),f}},n,{equals:(f,p)=>f.href===p.href}),o=ze(()=>i().pathname),a=ze(()=>i().search,!0),c=ze(()=>i().hash),u=()=>"",h=dc(a,()=>lm(i()));return{get pathname(){return o()},get search(){return a()},get hash(){return c()},get state(){return e()},get key(){return u()},query:r?r(h):cm(h)}}let di;function np(){return di}function ip(t,e,r,n={}){const{signal:[i,o],utils:a={}}=t,c=a.parsePath||(he=>he),u=a.renderPath||(he=>he),h=a.beforeLeave||sm(),f=Us("",n.base||"");if(f===void 0)throw new Error(`${f} is not a valid base path`);f&&!i().value&&o({value:f,replace:!0,scroll:!1});const[p,b]=ye(!1);let C;const R=(he,G)=>{G.value===E()&&G.state===T()||(C===void 0&&b(!0),di=he,C=G,hg(()=>{C===G&&(x(C.value),W(C.state),de[1](k=>k.filter(Z=>Z.pending)))}).finally(()=>{C===G&&Xh(()=>{di=void 0,he==="navigate"&&A(C),b(!1),C=void 0})}))},[E,x]=ye(i().value),[T,W]=ye(i().state),te=rp(E,T,a.queryWrapper),Q=[],de=ye([]),ae=ze(()=>typeof n.transformUrl=="function"?nl(e(),n.transformUrl(te.pathname)):nl(e(),te.pathname)),I=()=>{const he=ae(),G={};for(let k=0;k<he.length;k++)Object.assign(G,he[k].params);return G},_=a.paramsWrapper?a.paramsWrapper(I,e):cm(I),v={pattern:f,path:()=>f,outlet:()=>null,resolvePath(he){return Us(f,he)}};return se(dc(i,he=>R("native",he),{defer:!0})),{base:v,location:te,params:_,isRouting:p,renderPath:u,parsePath:c,navigatorFactory:w,matches:ae,beforeLeave:h,preloadRoute:y,singleFlight:n.singleFlight===void 0?!0:n.singleFlight,submissions:de};function P(he,G,k){Fr(()=>{if(typeof G=="number"){G&&(a.go?a.go(G):console.warn("Router integration does not support relative routing"));return}const Z=!G||G[0]==="?",{replace:U,resolve:F,scroll:N,state:V}={replace:!1,resolve:!Z,scroll:!0,...k},fe=F?he.resolvePath(G):Us(Z&&te.pathname||"",G);if(fe===void 0)throw new Error(`Path '${G}' is not a routable path`);if(Q.length>=Yg)throw new Error("Too many redirects");const z=E();(fe!==z||V!==T())&&(Bg||h.confirm(fe,k)&&(Q.push({value:z,replace:U,scroll:N,state:T()}),R("navigate",{value:fe,state:V})))})}function w(he){return he=he||hc(vc)||v,(G,k)=>P(he,G,k)}function A(he){const G=Q[0];G&&(o({...he,replace:G.replace,scroll:G.scroll}),Q.length=0)}function y(he,G){const k=nl(e(),he.pathname),Z=di;di="preload";for(let U in k){const{route:F,params:N}=k[U];F.component&&F.component.preload&&F.component.preload();const{preload:V}=F;G&&V&&em(r(),()=>V({params:N,location:{pathname:he.pathname,search:he.search,hash:he.hash,query:lm(he),state:null,key:""},intent:"preload"}))}di=Z}}function op(t,e,r,n){const{base:i,location:o,params:a}=t,{pattern:c,component:u,preload:h}=n().route,f=ze(()=>n().path);u&&u.preload&&u.preload();const p=h?h({params:a,location:o,intent:di||"initial"}):void 0;return{parent:e,pattern:c,path:f,outlet:()=>u?S(u,{params:a,location:o,data:p,get children(){return r()}}):r(),resolvePath(C){return Us(i.path(),C,f())}}}const sp=t=>e=>{const{base:r}=e,n=mc(()=>e.children),i=ze(()=>mm(n(),e.base||""));let o;const a=ip(t,i,()=>o,{base:r,singleFlight:e.singleFlight,transformUrl:e.transformUrl});return t.create&&t.create(a),S(dm.Provider,{value:a,get children(){return S(ap,{routerState:a,get root(){return e.root},get preload(){return e.rootPreload||e.rootLoad},get children(){return[me(()=>(o=Zh())&&null),S(lp,{routerState:a,get branches(){return i()}})]}})}})};function ap(t){const e=t.routerState.location,r=t.routerState.params,n=ze(()=>t.preload&&Fr(()=>{t.preload({params:r,location:e,intent:np()||"initial"})}));return S(Ve,{get when(){return t.root},keyed:!0,get fallback(){return t.children},children:i=>S(i,{params:r,location:e,get data(){return n()},get children(){return t.children}})})}function lp(t){const e=[];let r;const n=ze(dc(t.routerState.matches,(i,o,a)=>{let c=o&&i.length===o.length;const u=[];for(let h=0,f=i.length;h<f;h++){const p=o&&o[h],b=i[h];a&&p&&b.route.key===p.route.key?u[h]=a[h]:(c=!1,e[h]&&e[h](),Do(C=>{e[h]=C,u[h]=op(t.routerState,u[h-1]||t.routerState.base,qu(()=>n()[h+1]),()=>t.routerState.matches()[h])}))}return e.splice(i.length).forEach(h=>h()),a&&c?a:(r=u[0],u)}));return qu(()=>n()&&r)()}const qu=t=>()=>S(Ve,{get when(){return t()},keyed:!0,children:e=>S(vc.Provider,{value:e,get children(){return e.outlet()}})}),Qr=t=>{const e=mc(()=>t.children);return Ll(t,{get children(){return e()}})};function cp([t,e],r,n){return[t,n?i=>e(n(i)):e]}function up(t){let e=!1;const r=i=>typeof i=="string"?{value:i}:i,n=cp(ye(r(t.get()),{equals:(i,o)=>i.value===o.value&&i.state===o.state}),void 0,i=>(!e&&t.set(i),i));return t.init&&ro(t.init((i=t.get())=>{e=!0,n[1](r(i)),e=!1})),sp({signal:n,create:t.create,utils:t.utils})}function dp(t,e,r){return t.addEventListener(e,r),()=>t.removeEventListener(e,r)}function hp(t,e){const r=t&&document.getElementById(t);r?r.scrollIntoView():e&&window.scrollTo(0,0)}const mp=new Map;function fp(t=!0,e=!1,r="/_server",n){return i=>{const o=i.base.path(),a=i.navigatorFactory(i.base);let c,u;function h(E){return E.namespaceURI==="http://www.w3.org/2000/svg"}function f(E){if(E.defaultPrevented||E.button!==0||E.metaKey||E.altKey||E.ctrlKey||E.shiftKey)return;const x=E.composedPath().find(ae=>ae instanceof Node&&ae.nodeName.toUpperCase()==="A");if(!x||e&&!x.hasAttribute("link"))return;const T=h(x),W=T?x.href.baseVal:x.href;if((T?x.target.baseVal:x.target)||!W&&!x.hasAttribute("state"))return;const Q=(x.getAttribute("rel")||"").split(/\s+/);if(x.hasAttribute("download")||Q&&Q.includes("external"))return;const de=T?new URL(W,document.baseURI):new URL(W);if(!(de.origin!==window.location.origin||o&&de.pathname&&!de.pathname.toLowerCase().startsWith(o.toLowerCase())))return[x,de]}function p(E){const x=f(E);if(!x)return;const[T,W]=x,te=i.parsePath(W.pathname+W.search+W.hash),Q=T.getAttribute("state");E.preventDefault(),a(te,{resolve:!1,replace:T.hasAttribute("replace"),scroll:!T.hasAttribute("noscroll"),state:Q?JSON.parse(Q):void 0})}function b(E){const x=f(E);if(!x)return;const[T,W]=x;i.preloadRoute(W,T.getAttribute("preload")!=="false")}function C(E){clearTimeout(c);const x=f(E);if(!x)return u=null;const[T,W]=x;u!==T&&(c=setTimeout(()=>{i.preloadRoute(W,T.getAttribute("preload")!=="false"),u=T},20))}function R(E){if(E.defaultPrevented)return;let x=E.submitter&&E.submitter.hasAttribute("formaction")?E.submitter.getAttribute("formaction"):E.target.getAttribute("action");if(!x)return;if(!x.startsWith("https://action/")){const W=new URL(x,am);if(x=i.parsePath(W.pathname+W.search),!x.startsWith(r))return}if(E.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const T=mp.get(x);if(T){E.preventDefault();const W=new FormData(E.target,E.submitter);T.call({r:i,f:E.target},E.target.enctype==="multipart/form-data"?W:new URLSearchParams(W))}}wt(["click","submit"]),document.addEventListener("click",p),t&&(document.addEventListener("mousemove",C,{passive:!0}),document.addEventListener("focusin",b,{passive:!0}),document.addEventListener("touchstart",b,{passive:!0})),document.addEventListener("submit",R),ro(()=>{document.removeEventListener("click",p),t&&(document.removeEventListener("mousemove",C),document.removeEventListener("focusin",b),document.removeEventListener("touchstart",b)),document.removeEventListener("submit",R)})}}function yp(t){const e=t.replace(/^.*?#/,"");if(!e.startsWith("/")){const[,r="/"]=window.location.hash.split("#",2);return`${r}#${e}`}return e}function gp(t){const e=()=>window.location.hash.slice(1),r=sm();return up({get:e,set({value:n,replace:i,scroll:o,state:a}){i?window.history.replaceState(Fg(a),"","#"+n):window.history.pushState(a,"","#"+n);const c=n.indexOf("#"),u=c>=0?n.slice(c+1):"";hp(u,o),pc()},init:n=>dp(window,"hashchange",Ug(n,i=>!r.confirm(i&&i<0?i:e()))),create:fp(t.preload,t.explicitLinks,t.actionBase),utils:{go:n=>window.history.go(n),renderPath:n=>`#${n}`,parsePath:yp,beforeLeave:r}})(t)}var pp=H("<a>");function pn(t){t=Ll({inactiveClass:"inactive",activeClass:"active"},t);const[,e]=Sg(t,["href","state","class","activeClass","inactiveClass","end"]),r=Qg(()=>t.href),n=Jg(r),i=Xg(),o=ze(()=>{const a=r();if(a===void 0)return[!1,!1];const c=gi(a.split(/[?#]/,1)[0]).toLowerCase(),u=decodeURI(gi(i.pathname).toLowerCase());return[t.end?c===u:u.startsWith(c+"/")||u===c,c===u]});return(()=>{var a=pp();return Ng(a,Ll(e,{get href(){return n()||t.href},get state(){return JSON.stringify(t.state)},get classList(){return{...t.class&&{[t.class]:!0},[t.inactiveClass]:!o()[0],[t.activeClass]:o()[0],...e.classList}},link:"",get"aria-current"(){return o()[1]?"page":void 0}}),!1),a})()}const Vl=Symbol("store-raw"),zi=Symbol("store-node"),vn=Symbol("store-has"),fm=Symbol("store-self");function ym(t){let e=t[Gr];if(!e&&(Object.defineProperty(t,Gr,{value:e=new Proxy(t,_p)}),!Array.isArray(t))){const r=Object.keys(t),n=Object.getOwnPropertyDescriptors(t);for(let i=0,o=r.length;i<o;i++){const a=r[i];n[a].get&&Object.defineProperty(t,a,{enumerable:n[a].enumerable,get:n[a].get.bind(e)})}}return e}function na(t){let e;return t!=null&&typeof t=="object"&&(t[Gr]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function zo(t,e=new Set){let r,n,i,o;if(r=t!=null&&t[Vl])return r;if(!na(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let a=0,c=t.length;a<c;a++)i=t[a],(n=zo(i,e))!==i&&(t[a]=n)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const a=Object.keys(t),c=Object.getOwnPropertyDescriptors(t);for(let u=0,h=a.length;u<h;u++)o=a[u],!c[o].get&&(i=t[o],(n=zo(i,e))!==i&&(t[o]=n))}return t}function ia(t,e){let r=t[e];return r||Object.defineProperty(t,e,{value:r=Object.create(null)}),r}function qo(t,e,r){if(t[e])return t[e];const[n,i]=ye(r,{equals:!1,internal:!0});return n.$=i,t[e]=n}function vp(t,e){const r=Reflect.getOwnPropertyDescriptor(t,e);return!r||r.get||!r.configurable||e===Gr||e===zi||(delete r.value,delete r.writable,r.get=()=>t[Gr][e]),r}function gm(t){Rl()&&qo(ia(t,zi),fm)()}function bp(t){return gm(t),Reflect.ownKeys(t)}const _p={get(t,e,r){if(e===Vl)return t;if(e===Gr)return r;if(e===kl)return gm(t),r;const n=ia(t,zi),i=n[e];let o=i?i():t[e];if(e===zi||e===vn||e==="__proto__")return o;if(!i){const a=Object.getOwnPropertyDescriptor(t,e);Rl()&&(typeof o!="function"||t.hasOwnProperty(e))&&!(a&&a.get)&&(o=qo(n,e,o)())}return na(o)?ym(o):o},has(t,e){return e===Vl||e===Gr||e===kl||e===zi||e===vn||e==="__proto__"?!0:(Rl()&&qo(ia(t,vn),e)(),e in t)},set(){return!0},deleteProperty(){return!0},ownKeys:bp,getOwnPropertyDescriptor:vp};function oa(t,e,r,n=!1){if(!n&&t[e]===r)return;const i=t[e],o=t.length;r===void 0?(delete t[e],t[vn]&&t[vn][e]&&i!==void 0&&t[vn][e].$()):(t[e]=r,t[vn]&&t[vn][e]&&i===void 0&&t[vn][e].$());let a=ia(t,zi),c;if((c=qo(a,e,i))&&c.$(()=>r),Array.isArray(t)&&t.length!==o){for(let u=t.length;u<o;u++)(c=a[u])&&c.$();(c=qo(a,"length",o))&&c.$(t.length)}(c=a[fm])&&c.$()}function pm(t,e){const r=Object.keys(e);for(let n=0;n<r.length;n+=1){const i=r[n];oa(t,i,e[i])}}function Sp(t,e){if(typeof e=="function"&&(e=e(t)),e=zo(e),Array.isArray(e)){if(t===e)return;let r=0,n=e.length;for(;r<n;r++){const i=e[r];t[r]!==i&&oa(t,r,i)}oa(t,"length",n)}else pm(t,e)}function Io(t,e,r=[]){let n,i=t;if(e.length>1){n=e.shift();const a=typeof n,c=Array.isArray(t);if(Array.isArray(n)){for(let u=0;u<n.length;u++)Io(t,[n[u]].concat(e),r);return}else if(c&&a==="function"){for(let u=0;u<t.length;u++)n(t[u],u)&&Io(t,[u].concat(e),r);return}else if(c&&a==="object"){const{from:u=0,to:h=t.length-1,by:f=1}=n;for(let p=u;p<=h;p+=f)Io(t,[p].concat(e),r);return}else if(e.length>1){Io(t[n],e,[n].concat(r));return}i=t[n],r=[n].concat(r)}let o=e[0];typeof o=="function"&&(o=o(i,r),o===i)||n===void 0&&o==null||(o=zo(o),n===void 0||na(i)&&na(o)&&!Array.isArray(o)?pm(i,o):oa(t,n,o))}function vm(...[t,e]){const r=zo(t||{}),n=Array.isArray(r),i=ym(r);function o(...a){Xh(()=>{n&&a.length===1?Sp(r,a[0]):Io(r,a)})}return[i,o]}const At=(t=300+Math.random()*700)=>new Promise(e=>setTimeout(e,t)),si=(t="")=>`${t}${Date.now()}-${Math.random().toString(36).substr(2,9)}`;let Be={products:[{id:"prod-001",name:"Wireless Headphones",sku:"WH-001",productCode:"WH-001",productName:"Wireless Headphones",description:"High-quality wireless bluetooth headphones",category:"Electronics",unitOfMeasure:"pcs",unitCost:45,sellingPrice:89.99,minStockLevel:10,maxStockLevel:100,isActive:!0,createdDate:"2024-01-15T10:00:00Z",lastModified:"2024-01-15T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-002",name:"USB-C Cable",sku:"USB-001",description:"3ft USB-C charging cable",category:"Accessories",unitOfMeasure:"pcs",unitCost:8.5,sellingPrice:19.99,minStockLevel:25,maxStockLevel:200,isActive:!0,createdDate:"2024-01-16T10:00:00Z",lastModified:"2024-01-16T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-003",name:"Laptop Stand",sku:"LS-001",description:"Adjustable aluminum laptop stand",category:"Office",unitOfMeasure:"pcs",unitCost:25,sellingPrice:49.99,minStockLevel:5,maxStockLevel:50,isActive:!0,createdDate:"2024-01-17T10:00:00Z",lastModified:"2024-01-17T10:00:00Z",businessId:"YB100423253156428"}],locations:[{id:"loc-001",name:"Main Warehouse",code:"WH-001",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-002",name:"Retail Store - Downtown",code:"ST-001",type:"store",address:"456 Main St, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-003",name:"Retail Store - Mall",code:"ST-002",type:"store",address:"789 Mall Blvd, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"}],movements:[{id:"mov-001",productId:"prod-001",productName:"Wireless Headphones",productSku:"WH-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:50,unitCost:45,totalCost:2250,referenceNumber:"PO-001",notes:"Initial stock purchase",createdBy:"admin",createdDate:"2024-01-15T10:00:00Z",invoiceId:"INV-1000001"},{id:"mov-002",productId:"prod-002",productName:"USB-C Cable",productSku:"USB-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:100,unitCost:8.5,totalCost:850,referenceNumber:"PO-001",notes:"Bulk purchase",createdBy:"admin",createdDate:"2024-01-15T10:05:00Z",invoiceId:"INV-1000001"}],accounts:[{id:"acc-001",accountNumber:"1000",accountName:"Cash",accountType:"asset",category:"currentAssets",balance:5e4,parentAccountId:null,description:"Cash and cash equivalents",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"},{id:"acc-002",accountNumber:"1100",accountName:"Accounts Receivable",accountType:"asset",category:"currentAssets",balance:25e3,parentAccountId:null,description:"Money owed by customers",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"}],journalEntries:[{id:"je-001",entryNumber:"JE-001",date:"2024-01-15",description:"Initial cash deposit",reference:"DEP-001",status:"posted",createdBy:"admin",createdAt:"2024-01-15T10:00:00Z",postedAt:"2024-01-15T10:05:00Z",lines:[{id:"jel-001",accountId:"acc-001",accountName:"Cash",description:"Initial deposit",debitAmount:5e4,creditAmount:0},{id:"jel-002",accountId:"acc-003",accountName:"Owner Equity",description:"Initial capital",debitAmount:0,creditAmount:5e4}]}]};const Xt=(t=.05)=>Math.random()<t,Zt=()=>{const t=["Network timeout","Connection refused","Server temporarily unavailable","Invalid request"];throw new Error(t[Math.floor(Math.random()*t.length)])},Rr={products:{async getAll(t,e){await At(),Xt()&&Zt();let r=[...Be.products];if(t&&t.trim()){const n=t.toLowerCase();r=r.filter(i=>i.name.toLowerCase().includes(n)||i.sku.toLowerCase().includes(n)||i.category.toLowerCase().includes(n)||i.description.toLowerCase().includes(n))}return e?.category&&(r=r.filter(n=>n.category===e.category)),e?.isActive!==void 0&&(r=r.filter(n=>n.isActive===e.isActive)),r},async getById(t){return await At(),Xt()&&Zt(),Be.products.find(e=>e.id===t)||null},async create(t){if(await At(),Xt()&&Zt(),Be.products.some(r=>r.sku===t.sku))throw new Error("SKU already exists");const e={...t,id:si("prod-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return Be.products.push(e),e},async update(t,e){await At(),Xt()&&Zt();const r=Be.products.findIndex(i=>i.id===t);if(r===-1)throw new Error("Product not found");if(e.sku&&Be.products.some(i=>i.id!==t&&i.sku===e.sku))throw new Error("SKU already exists");const n={...Be.products[r],...e,lastModified:new Date().toISOString()};return Be.products[r]=n,n},async delete(t){await At(),Xt()&&Zt();const e=Be.products.findIndex(n=>n.id===t);if(e===-1)throw new Error("Product not found");return Be.movements.some(n=>n.productId===t)?{success:!1,message:"Cannot delete product with existing movements"}:(Be.products.splice(e,1),{success:!0,message:"Product deleted successfully"})}},locations:{async getAll(t){await At(),Xt()&&Zt();let e=[...Be.locations];return t?.type&&(e=e.filter(r=>r.type===t.type)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await At(),Be.locations.find(e=>e.id===t)||null},async create(t){if(await At(),Xt()&&Zt(),Be.locations.some(r=>r.code===t.code))throw new Error("Location code already exists");const e={...t,id:si("loc-"),createdDate:new Date().toISOString()};return Be.locations.push(e),e},async update(t,e){await At(),Xt()&&Zt();const r=Be.locations.findIndex(n=>n.id===t);if(r===-1)throw new Error("Location not found");if(e.code&&Be.locations.some(n=>n.id!==t&&n.code===e.code))throw new Error("Location code already exists");return Be.locations[r]={...Be.locations[r],...e},Be.locations[r]}},movements:{async getAll(t){await At(),Xt()&&Zt();let e=[...Be.movements];if(t?.productId&&(e=e.filter(r=>r.productId===t.productId)),t?.locationId&&(e=e.filter(r=>r.locationId===t.locationId)),t?.movementType&&(e=e.filter(r=>r.movementType===t.movementType)),t?.dateFrom&&(e=e.filter(r=>r.createdDate>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.createdDate<=t.dateTo)),t?.search){const r=t.search.toLowerCase();e=e.filter(n=>n.productName.toLowerCase().includes(r)||n.productSku.toLowerCase().includes(r)||n.referenceNumber.toLowerCase().includes(r)||n.notes.toLowerCase().includes(r))}return e.sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime()),e},async getById(t){return await At(),Be.movements.find(e=>e.id===t)||null},async create(t){if(await At(),Xt()&&Zt(),!Be.products.find(i=>i.id===t.productId))throw new Error("Product not found");if(!Be.locations.find(i=>i.id===t.locationId))throw new Error("Location not found");if(t.movementType==="out"){const i=await this.getStockLevel(t.productId,t.locationId);if(i<t.quantity)throw new Error(`Insufficient stock. Available: ${i}, Requested: ${t.quantity}`)}const n={...t,id:si("mov-"),createdDate:new Date().toISOString()};return Be.movements.push(n),n},async update(t,e){await At(),Xt()&&Zt();const r=Be.movements.findIndex(i=>i.id===t);if(r===-1)throw new Error("Movement not found");const n={...Be.movements[r],...e,lastModified:new Date().toISOString()};return Be.movements[r]=n,n},async delete(t){await At(),Xt()&&Zt();const e=Be.movements.findIndex(r=>r.id===t);if(e===-1)throw new Error("Movement not found");return Be.movements.splice(e,1),{success:!0,message:"Movement deleted successfully"}},async createBulk(t){await At(),Xt()&&Zt();const e=[],r=[],n=new Date().toISOString(),i=Be.locations.find(o=>o.id===t.locationId);if(!i)return{success:!1,movements:[],errors:["Invalid location"]};for(let o=0;o<t.items.length;o++){const a=t.items[o],c=Be.products.find(f=>f.id===a.productId);if(!c){e.push(`Item ${o+1}: Product not found`);continue}if(a.quantity<=0){e.push(`Item ${o+1}: Quantity must be greater than 0`);continue}if(t.movementType==="out"){const f=await this.getStockLevel(a.productId,t.locationId);if(a.quantity>f){e.push(`Item ${o+1}: Insufficient stock. Available: ${f}, Requested: ${a.quantity}`);continue}}const u=a.unitCost||c.unitCost,h={id:si("mov-"),productId:c.id,productName:c.name,productSku:c.sku,locationId:t.locationId,locationName:i.name,movementType:t.movementType,quantity:a.quantity,unitCost:u,totalCost:a.quantity*u,referenceNumber:t.referenceNumber,notes:a.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:t.fromLocationId?Be.locations.find(f=>f.id===t.fromLocationId)?.name:void 0};r.push(h)}return e.length>0?{success:!1,movements:[],errors:e}:(Be.movements.push(...r),{success:!0,movements:r,errors:[]})},async getStockLevel(t,e){return await At(50),Be.movements.filter(r=>r.productId===t&&r.locationId===e).reduce((r,n)=>{switch(n.movementType){case"in":case"adjustment":return r+n.quantity;case"out":return r-n.quantity;case"transfer":return n.locationId===e?r+n.quantity:r;default:return r}},0)},async getStockLevels(){await At();const t=new Map;for(const e of Be.movements){const r=`${e.productId}-${e.locationId}`;let n=t.get(r);switch(n||(n={id:r,productId:e.productId,locationId:e.locationId,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType){case"in":case"adjustment":n.quantity+=e.quantity;break;case"out":n.quantity-=e.quantity;break;case"transfer":e.locationId===e.locationId&&(n.quantity+=e.quantity);break}new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost,n.availableQuantity=n.quantity-n.reservedQuantity}return Array.from(t.values())}},accounts:{async getAll(t){await At(),Xt()&&Zt();let e=[...Be.accounts];return t?.accountType&&(e=e.filter(r=>r.accountType===t.accountType)),t?.category&&(e=e.filter(r=>r.category===t.category)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await At(),Be.accounts.find(e=>e.id===t)||null},async create(t){if(await At(),Xt()&&Zt(),Be.accounts.some(r=>r.accountNumber===t.accountNumber))throw new Error("Account number already exists");const e={...t,id:si("acc-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return Be.accounts.push(e),e},async update(t,e){await At(),Xt()&&Zt();const r=Be.accounts.findIndex(n=>n.id===t);if(r===-1)throw new Error("Account not found");if(e.accountNumber&&Be.accounts.some(n=>n.id!==t&&n.accountNumber===e.accountNumber))throw new Error("Account number already exists");return Be.accounts[r]={...Be.accounts[r],...e,lastModified:new Date().toISOString()},Be.accounts[r]}},journal:{async getAll(t){await At(),Xt()&&Zt();let e=[...Be.journalEntries];return t?.status&&(e=e.filter(r=>r.status===t.status)),t?.accountId&&(e=e.filter(r=>r.lines.some(n=>n.accountId===t.accountId))),t?.dateFrom&&(e=e.filter(r=>r.date>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.date<=t.dateTo)),e.sort((r,n)=>new Date(n.createdAt).getTime()-new Date(r.createdAt).getTime())},async getById(t){return await At(),Be.journalEntries.find(e=>e.id===t)||null},async create(t){await At(),Xt()&&Zt();const e=t.lines.reduce((c,u)=>c+(u.debitAmount||0),0),r=t.lines.reduce((c,u)=>c+(u.creditAmount||0),0);if(Math.abs(e-r)>.01)throw new Error(`Entry is not balanced. Debit: ${e}, Credit: ${r}`);const n=Be.journalEntries.sort((c,u)=>u.entryNumber.localeCompare(c.entryNumber))[0],o=`JE-${((n?parseInt(n.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`,a={...t,id:si("je-"),entryNumber:o,createdAt:new Date().toISOString(),lines:t.lines.map(c=>({...c,id:si("jel-")}))};return Be.journalEntries.push(a),a},async update(t,e){await At(),Xt()&&Zt();const r=Be.journalEntries.findIndex(n=>n.id===t);if(r===-1)throw new Error("Journal entry not found");if(Be.journalEntries[r].status==="posted")throw new Error("Cannot modify posted entries");return Be.journalEntries[r]={...Be.journalEntries[r],...e},Be.journalEntries[r]},async post(t){await At(),Xt()&&Zt();const e=Be.journalEntries.findIndex(o=>o.id===t);if(e===-1)throw new Error("Journal entry not found");const r=Be.journalEntries[e];if(r.status==="posted")throw new Error("Entry is already posted");const n=r.lines.reduce((o,a)=>o+(a.debitAmount||0),0),i=r.lines.reduce((o,a)=>o+(a.creditAmount||0),0);if(Math.abs(n-i)>.01)throw new Error("Entry must be balanced before posting");return Be.journalEntries[e]={...r,status:"posted",postedAt:new Date().toISOString()},r.lines.forEach(o=>{const a=Be.accounts.findIndex(c=>c.id===o.accountId);if(a!==-1){const c=Be.accounts[a],u=o.debitAmount||0,h=o.creditAmount||0;["asset","expense"].includes(c.accountType)?c.balance+=u-h:c.balance+=h-u}}),Be.journalEntries[e]}},utils:{async getNextEntryNumber(){await At(100);const t=Be.journalEntries.sort((r,n)=>n.entryNumber.localeCompare(r.entryNumber))[0];return`JE-${((t?parseInt(t.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`},async getNextProductCode(t){await At(100);const e=t.toUpperCase().slice(0,3),r=Be.products.filter(i=>i.productCode?.startsWith(e)).sort((i,o)=>(o.productCode||"").localeCompare(i.productCode||""));if(r.length===0)return`${e}001`;const n=parseInt(r[0].productCode?.slice(-3)||"0");return`${e}${(n+1).toString().padStart(3,"0")}`},async healthCheck(){return await At(50),{status:"healthy",timestamp:new Date().toISOString(),version:"1.0.0"}},async resetDatabase(){return await At(200),Be={products:[...Be.products.slice(0,3)],locations:[...Be.locations.slice(0,3)],movements:[...Be.movements.slice(0,2)],accounts:[...Be.accounts.slice(0,2)],journalEntries:[...Be.journalEntries.slice(0,1)]},{success:!0,message:"Database reset to initial state"}},async getStats(){return await At(100),{products:Be.products.length,locations:Be.locations.length,movements:Be.movements.length,accounts:Be.accounts.length,journalEntries:Be.journalEntries.length,totalStockValue:Be.movements.reduce((t,e)=>e.movementType==="in"?t+e.totalCost:e.movementType==="out"?t-e.totalCost:t,0)}}}},bm=t=>t===null||typeof t!="object"?t:t instanceof Date?new Date(t.getTime()):Array.isArray(t)?t.map(e=>bm(e)):JSON.parse(JSON.stringify(t)),js=(t=16)=>{const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},Bn=async t=>{const n=await fetch("https://qvamarkets.com/gql_api",{method:"POST",headers:{"Content-Type":"application/json","Accept-Encoding":"gzip, deflate, br",Authorization:"eyJhbGciOiJSUzI1NiIsImtpZCI6IjhlOGZjOGU1NTZmN2E3NmQwOGQzNTgyOWQ2ZjkwYWUyZTEyY2ZkMGQiLCJ0eXAiOiJKV1QifQ"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const i=await n.json();if(i.errors)throw new Error(i.errors[0]?.message||"GraphQL error");return i.data},Pp=t=>({ENTRY:"in",in:"in",TRANSFER:"transfer",transfer:"transfer",SALES:"out",out:"out",adjustment:"adjustment"})[t],Bl=t=>({ENTRY:"ENTRY",in:"ENTRY",TRANSFER:"TRANSFER",transfer:"TRANSFER",SALES:"SALES",out:"SALES",adjustment:"adjustment"})[t];function wp(t){var e=[];return t&&Object.keys(t).map(r=>{e.push(t[r])}),e}function Cp(t){if(!/^[a-z0-9+/]+={0,2}$/i.test(t)||t.length%4!=0)throw Error("Not base64 string");for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r,n,i,o,a,c,u,h,f=[],p=0;p<t.length;p+=4)o=e.indexOf(t.charAt(p)),a=e.indexOf(t.charAt(p+1)),c=e.indexOf(t.charAt(p+2)),u=e.indexOf(t.charAt(p+3)),h=o<<18|a<<12|c<<6|u,r=h>>>16&255,n=h>>>8&255,i=h&255,f[p/4]=String.fromCharCode(r,n,i),u==64&&(f[p/4]=String.fromCharCode(r,n)),c==64&&(f[p/4]=String.fromCharCode(r));return t=f.join(""),t}const Ap=async()=>({}),Ip=()=>(typeof window<"u"&&localStorage.getItem("hrmfinance-api-mode"),"real");let hi=Ip();const Ho={getMode(){return hi},setMode(t){hi=t,typeof window<"u"&&localStorage.setItem("hrmfinance-api-mode",t)},isFakeMode(){return hi==="fake"},isRealMode(){return hi==="real"},isHybridMode(){return hi==="hybrid"}},Br=async(t,e,r=!0)=>{if(hi==="fake")return e();if(hi==="real")return t();try{return await t()}catch(n){if(console.warn("Real API failed, falling back to fake server:",n),r)return e();throw n}},Hu={async getAll(t,e){const r=await Bn({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:{businessId:"YB100423253156428",":search0":"produ"}});return wp(r)},async getById(t){return Br(async()=>(await this.getAll()).find(r=>r.id===t)||null,()=>Rr.products.getById(t))},async create(t){return Br(async()=>{throw console.log("Creating product via real API:",t),new Error("Real API not implemented yet")},()=>Rr.products.create(t))},async update(t,e){return Br(async()=>{throw console.log("Updating product via real API:",t,e),new Error("Real API not implemented yet")},()=>Rr.products.update(t,e))},async delete(t){return Br(async()=>{throw console.log("Deleting product via real API:",t),new Error("Real API not implemented yet")},()=>Rr.products.delete(t))}},Fn={async getInventory(t,e){if(!(t&&t?.trim()))return[];let r={businessId:"YB100423253156428"};return t&&t.split(" ").map((o,a)=>{o&&(r[":search"+a]=o.trim())}),await Bn({query:"getScanYabaInventory",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async getProducts(t){if(!(t&&t?.trim()))return[];let e={businessId:"YB100423253156428"};return t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())}),await Bn({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async addInventory(t){let r={query:"addYabaInventory",params:{businessId:"YB100423253156428"},form:t};const n=await Bn(r);return console.log(r),console.log(n),n},async updInventory(t){return await Ap()}},Wu={async getAll(t){return Br(async()=>{throw console.log("Getting accounts via real API:",t),new Error("Real API not implemented yet")},()=>Rr.accounts.getAll(t))},async getById(t){return Br(async()=>{throw console.log("Getting account by ID via real API:",t),new Error("Real API not implemented yet")},()=>Rr.accounts.getById(t))},async create(t){return Br(async()=>{throw console.log("Creating account via real API:",t),new Error("Real API not implemented yet")},()=>Rr.accounts.create(t))},async update(t,e){return Br(async()=>{throw console.log("Updating account via real API:",t,e),new Error("Real API not implemented yet")},()=>Rr.accounts.update(t,e))}},Gu={async getNextEntryNumber(){return Br(async()=>{throw console.log("Getting next entry number via real API"),new Error("Real API not implemented yet")},()=>Rr.utils.getNextEntryNumber())},async getNextProductCode(t){return Br(async()=>{throw console.log("Getting next product code via real API:",t),new Error("Real API not implemented yet")},()=>Rr.utils.getNextProductCode(t))},async healthCheck(){return Br(async()=>{const t=await fetch("/api/health");if(!t.ok)throw new Error("Health check failed");return t.json()},()=>Rr.utils.healthCheck())},async getStats(){return Br(async()=>{throw console.log("Getting stats via real API"),new Error("Real API not implemented yet")},()=>Rr.utils.getStats())}},Ep=()=>{Ho.setMode("real"),console.log("🚀 HRM Finance initialized in REAL API mode for production")};Ep();const xp=()=>{};var Yu={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _m=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},Tp=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[r++];e[n++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=t[r++],a=t[r++],c=t[r++],u=((i&7)<<18|(o&63)<<12|(a&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const o=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return e.join("")},Sm={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const o=t[i],a=i+1<t.length,c=a?t[i+1]:0,u=i+2<t.length,h=u?t[i+2]:0,f=o>>2,p=(o&3)<<4|c>>4;let b=(c&15)<<2|h>>6,C=h&63;u||(C=64,a||(b=64)),n.push(r[f],r[p],r[b],r[C])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(_m(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Tp(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const o=r[t.charAt(i++)],c=i<t.length?r[t.charAt(i)]:0;++i;const h=i<t.length?r[t.charAt(i)]:64;++i;const p=i<t.length?r[t.charAt(i)]:64;if(++i,o==null||c==null||h==null||p==null)throw new $p;const b=o<<2|c>>4;if(n.push(b),h!==64){const C=c<<4&240|h>>2;if(n.push(C),p!==64){const R=h<<6&192|p;n.push(R)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class $p extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const kp=function(t){const e=_m(t);return Sm.encodeByteArray(e,!0)},sa=function(t){return kp(t).replace(/\./g,"")},Pm=function(t){try{return Sm.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rp(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dp=()=>Rp().__FIREBASE_DEFAULTS__,Np=()=>{if(typeof process>"u"||typeof Yu>"u")return;const t=Yu.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Lp=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Pm(t[1]);return e&&JSON.parse(e)},Ta=()=>{try{return xp()||Dp()||Np()||Lp()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},wm=t=>Ta()?.emulatorHosts?.[t],Mp=t=>{const e=wm(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},Cm=()=>Ta()?.config,Am=t=>Ta()?.[`_${t}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Op{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function no(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Im(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vp(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...t};return[sa(JSON.stringify(r)),sa(JSON.stringify(a)),""].join(".")}const No={};function Bp(){const t={prod:[],emulator:[]};for(const e of Object.keys(No))No[e]?t.emulator.push(e):t.prod.push(e);return t}function Fp(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let Ku=!1;function Em(t,e){if(typeof window>"u"||typeof document>"u"||!no(window.location.host)||No[t]===e||No[t]||Ku)return;No[t]=e;function r(b){return`__firebase__banner__${b}`}const n="__firebase__banner",o=Bp().prod.length>0;function a(){const b=document.getElementById(n);b&&b.remove()}function c(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function u(b,C){b.setAttribute("width","24"),b.setAttribute("id",C),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function h(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{Ku=!0,a()},b}function f(b,C){b.setAttribute("id",C),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function p(){const b=Fp(n),C=r("text"),R=document.getElementById(C)||document.createElement("span"),E=r("learnmore"),x=document.getElementById(E)||document.createElement("a"),T=r("preprendIcon"),W=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const te=b.element;c(te),f(x,E);const Q=h();u(W,T),te.append(W,R,x,Q),document.body.appendChild(te)}o?(R.innerText="Preview backend disconnected.",W.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(W.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,R.innerText="Preview backend running in this workspace."),R.setAttribute("id",C)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Up(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Cr())}function jp(){const t=Ta()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function zp(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function qp(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Hp(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Wp(){const t=Cr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Gp(){return!jp()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Yp(){try{return typeof indexedDB=="object"}catch{return!1}}function Kp(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qp="FirebaseError";class En extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=Qp,Object.setPrototypeOf(this,En.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ns.prototype.create)}}class ns{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,o=this.errors[e],a=o?Jp(o,n):"Error",c=`${this.serviceName}: ${a} (${i}).`;return new En(i,c,n)}}function Jp(t,e){return t.replace(Xp,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const Xp=/\{\$([^}]+)}/g;function Zp(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function vi(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const o=t[i],a=e[i];if(Qu(o)&&Qu(a)){if(!vi(o,a))return!1}else if(o!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function Qu(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function is(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function ev(t,e){const r=new tv(t,e);return r.subscribe.bind(r)}class tv{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");rv(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=il),i.error===void 0&&(i.error=il),i.complete===void 0&&(i.complete=il);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function rv(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function il(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Er(t){return t&&t._delegate?t._delegate:t}class bi{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ui="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new Op;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(ov(e))try{this.getOrInitializeService({instanceIdentifier:ui})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:i});n.resolve(o)}catch{}}}}clearInstance(e=ui){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ui){return this.instances.has(e)}getOptions(e=ui){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[o,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(o);n===c&&a.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const o=this.instances.get(n);return o&&e(o,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:iv(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ui){return this.component?this.component.multipleInstances?e:ui:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function iv(t){return t===ui?void 0:t}function ov(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new nv(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ht;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ht||(ht={}));const av={debug:ht.DEBUG,verbose:ht.VERBOSE,info:ht.INFO,warn:ht.WARN,error:ht.ERROR,silent:ht.SILENT},lv=ht.INFO,cv={[ht.DEBUG]:"log",[ht.VERBOSE]:"log",[ht.INFO]:"info",[ht.WARN]:"warn",[ht.ERROR]:"error"},uv=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=cv[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class _c{constructor(e){this.name=e,this._logLevel=lv,this._logHandler=uv,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ht))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?av[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ht.DEBUG,...e),this._logHandler(this,ht.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ht.VERBOSE,...e),this._logHandler(this,ht.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ht.INFO,...e),this._logHandler(this,ht.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ht.WARN,...e),this._logHandler(this,ht.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ht.ERROR,...e),this._logHandler(this,ht.ERROR,...e)}}const dv=(t,e)=>e.some(r=>t instanceof r);let Ju,Xu;function hv(){return Ju||(Ju=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function mv(){return Xu||(Xu=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const xm=new WeakMap,Fl=new WeakMap,Tm=new WeakMap,ol=new WeakMap,Sc=new WeakMap;function fv(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",a)},o=()=>{r(Un(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&xm.set(r,t)}).catch(()=>{}),Sc.set(e,t),e}function yv(t){if(Fl.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",a),t.removeEventListener("abort",a)},o=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",a),t.addEventListener("abort",a)});Fl.set(t,e)}let Ul={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Fl.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Tm.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Un(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function gv(t){Ul=t(Ul)}function pv(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(sl(this),e,...r);return Tm.set(n,e.sort?e.sort():[e]),Un(n)}:mv().includes(t)?function(...e){return t.apply(sl(this),e),Un(xm.get(this))}:function(...e){return Un(t.apply(sl(this),e))}}function vv(t){return typeof t=="function"?pv(t):(t instanceof IDBTransaction&&yv(t),dv(t,hv())?new Proxy(t,Ul):t)}function Un(t){if(t instanceof IDBRequest)return fv(t);if(ol.has(t))return ol.get(t);const e=vv(t);return e!==t&&(ol.set(t,e),Sc.set(e,t)),e}const sl=t=>Sc.get(t);function bv(t,e,{blocked:r,upgrade:n,blocking:i,terminated:o}={}){const a=indexedDB.open(t,e),c=Un(a);return n&&a.addEventListener("upgradeneeded",u=>{n(Un(a.result),u.oldVersion,u.newVersion,Un(a.transaction),u)}),r&&a.addEventListener("blocked",u=>r(u.oldVersion,u.newVersion,u)),c.then(u=>{o&&u.addEventListener("close",()=>o()),i&&u.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const _v=["get","getKey","getAll","getAllKeys","count"],Sv=["put","add","delete","clear"],al=new Map;function Zu(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(al.get(e))return al.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=Sv.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||_v.includes(r)))return;const o=async function(a,...c){const u=this.transaction(a,i?"readwrite":"readonly");let h=u.store;return n&&(h=h.index(c.shift())),(await Promise.all([h[r](...c),i&&u.done]))[0]};return al.set(e,o),o}gv(t=>({...t,get:(e,r,n)=>Zu(e,r)||t.get(e,r,n),has:(e,r)=>!!Zu(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pv{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(wv(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function wv(t){return t.getComponent()?.type==="VERSION"}const jl="@firebase/app",ed="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wn=new _c("@firebase/app"),Cv="@firebase/app-compat",Av="@firebase/analytics-compat",Iv="@firebase/analytics",Ev="@firebase/app-check-compat",xv="@firebase/app-check",Tv="@firebase/auth",$v="@firebase/auth-compat",kv="@firebase/database",Rv="@firebase/data-connect",Dv="@firebase/database-compat",Nv="@firebase/functions",Lv="@firebase/functions-compat",Mv="@firebase/installations",Ov="@firebase/installations-compat",Vv="@firebase/messaging",Bv="@firebase/messaging-compat",Fv="@firebase/performance",Uv="@firebase/performance-compat",jv="@firebase/remote-config",zv="@firebase/remote-config-compat",qv="@firebase/storage",Hv="@firebase/storage-compat",Wv="@firebase/firestore",Gv="@firebase/ai",Yv="@firebase/firestore-compat",Kv="firebase",Qv="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zl="[DEFAULT]",Jv={[jl]:"fire-core",[Cv]:"fire-core-compat",[Iv]:"fire-analytics",[Av]:"fire-analytics-compat",[xv]:"fire-app-check",[Ev]:"fire-app-check-compat",[Tv]:"fire-auth",[$v]:"fire-auth-compat",[kv]:"fire-rtdb",[Rv]:"fire-data-connect",[Dv]:"fire-rtdb-compat",[Nv]:"fire-fn",[Lv]:"fire-fn-compat",[Mv]:"fire-iid",[Ov]:"fire-iid-compat",[Vv]:"fire-fcm",[Bv]:"fire-fcm-compat",[Fv]:"fire-perf",[Uv]:"fire-perf-compat",[jv]:"fire-rc",[zv]:"fire-rc-compat",[qv]:"fire-gcs",[Hv]:"fire-gcs-compat",[Wv]:"fire-fst",[Yv]:"fire-fst-compat",[Gv]:"fire-vertex","fire-js":"fire-js",[Kv]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aa=new Map,Xv=new Map,ql=new Map;function td(t,e){try{t.container.addComponent(e)}catch(r){wn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Yi(t){const e=t.name;if(ql.has(e))return wn.debug(`There were multiple attempts to register component ${e}.`),!1;ql.set(e,t);for(const r of aa.values())td(r,t);for(const r of Xv.values())td(r,t);return!0}function Pc(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Or(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zv={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},jn=new ns("app","Firebase",Zv);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eb{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new bi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw jn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const io=Qv;function $m(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:zl,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw jn.create("bad-app-name",{appName:String(i)});if(r||(r=Cm()),!r)throw jn.create("no-options");const o=aa.get(i);if(o){if(vi(r,o.options)&&vi(n,o.config))return o;throw jn.create("duplicate-app",{appName:i})}const a=new sv(i);for(const u of ql.values())a.addComponent(u);const c=new eb(r,n,a);return aa.set(i,c),c}function km(t=zl){const e=aa.get(t);if(!e&&t===zl&&Cm())return $m();if(!e)throw jn.create("no-app",{appName:t});return e}function zn(t,e,r){let n=Jv[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${n}" with version "${e}":`];i&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),wn.warn(a.join(" "));return}Yi(new bi(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tb="firebase-heartbeat-database",rb=1,Wo="firebase-heartbeat-store";let ll=null;function Rm(){return ll||(ll=bv(tb,rb,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Wo)}catch(r){console.warn(r)}}}}).catch(t=>{throw jn.create("idb-open",{originalErrorMessage:t.message})})),ll}async function nb(t){try{const r=(await Rm()).transaction(Wo),n=await r.objectStore(Wo).get(Dm(t));return await r.done,n}catch(e){if(e instanceof En)wn.warn(e.message);else{const r=jn.create("idb-get",{originalErrorMessage:e?.message});wn.warn(r.message)}}}async function rd(t,e){try{const n=(await Rm()).transaction(Wo,"readwrite");await n.objectStore(Wo).put(e,Dm(t)),await n.done}catch(r){if(r instanceof En)wn.warn(r.message);else{const n=jn.create("idb-set",{originalErrorMessage:r?.message});wn.warn(n.message)}}}function Dm(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ib=1024,ob=30;class sb{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new lb(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=nd();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>ob){const i=cb(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){wn.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=nd(),{heartbeatsToSend:r,unsentEntries:n}=ab(this._heartbeatsCache.heartbeats),i=sa(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return wn.warn(e),""}}}function nd(){return new Date().toISOString().substring(0,10)}function ab(t,e=ib){const r=[];let n=t.slice();for(const i of t){const o=r.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),id(r)>e){o.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),id(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class lb{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Yp()?Kp().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await nb(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return rd(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return rd(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function id(t){return sa(JSON.stringify({version:2,heartbeats:t})).length}function cb(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ub(t){Yi(new bi("platform-logger",e=>new Pv(e),"PRIVATE")),Yi(new bi("heartbeat",e=>new sb(e),"PRIVATE")),zn(jl,ed,t),zn(jl,ed,"esm2020"),zn("fire-js","")}ub("");function Nm(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const db=Nm,Lm=new ns("auth","Firebase",Nm());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const la=new _c("@firebase/auth");function hb(t,...e){la.logLevel<=ht.WARN&&la.warn(`Auth (${io}): ${t}`,...e)}function zs(t,...e){la.logLevel<=ht.ERROR&&la.error(`Auth (${io}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function an(t,...e){throw Cc(t,...e)}function Wr(t,...e){return Cc(t,...e)}function wc(t,e,r){const n={...db(),[e]:r};return new ns("auth","Firebase",n).create(e,{appName:t.name})}function qn(t){return wc(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Mm(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&an(t,"argument-error"),wc(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Cc(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return Lm.create(t,...e)}function tt(t,e,...r){if(!t)throw Cc(e,...r)}function bn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw zs(e),new Error(e)}function Cn(t,e){t||bn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hl(){return typeof self<"u"&&self.location?.href||""}function mb(){return od()==="http:"||od()==="https:"}function od(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fb(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(mb()||qp()||"connection"in navigator)?navigator.onLine:!0}function yb(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(e,r){this.shortDelay=e,this.longDelay=r,Cn(r>e,"Short delay should be less than long delay!"),this.isMobile=Up()||Hp()}get(){return fb()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ac(t,e){Cn(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Om{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;bn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;bn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;bn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gb={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pb=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],vb=new os(3e4,6e4);function Ic(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function oo(t,e,r,n,i={}){return Vm(t,i,async()=>{let o={},a={};n&&(e==="GET"?a=n:o={body:JSON.stringify(n)});const c=is({key:t.config.apiKey,...a}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const h={method:e,headers:u,...o};return zp()||(h.referrerPolicy="no-referrer"),t.emulatorConfig&&no(t.emulatorConfig.host)&&(h.credentials="include"),Om.fetch()(await Bm(t,t.config.apiHost,r,c),h)})}async function Vm(t,e,r){t._canInitEmulator=!1;const n={...gb,...e};try{const i=new _b(t),o=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await o.json();if("needConfirmation"in a)throw As(t,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{const c=o.ok?a.errorMessage:a.error.message,[u,h]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw As(t,"credential-already-in-use",a);if(u==="EMAIL_EXISTS")throw As(t,"email-already-in-use",a);if(u==="USER_DISABLED")throw As(t,"user-disabled",a);const f=n[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw wc(t,f,h);an(t,f)}}catch(i){if(i instanceof En)throw i;an(t,"network-request-failed",{message:String(i)})}}async function bb(t,e,r,n,i={}){const o=await oo(t,e,r,n,i);return"mfaPendingCredential"in o&&an(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function Bm(t,e,r,n){const i=`${e}${r}?${n}`,o=t,a=o.config.emulator?Ac(t.config,i):`${t.config.apiScheme}://${i}`;return pb.includes(r)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(a).toString():a}class _b{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Wr(this.auth,"network-request-failed")),vb.get())})}}function As(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Wr(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sb(t,e){return oo(t,"POST","/v1/accounts:delete",e)}async function ca(t,e){return oo(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lo(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Pb(t,e=!1){const r=Er(t),n=await r.getIdToken(e),i=Ec(n);tt(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,a=o?.sign_in_provider;return{claims:i,token:n,authTime:Lo(cl(i.auth_time)),issuedAtTime:Lo(cl(i.iat)),expirationTime:Lo(cl(i.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}}function cl(t){return Number(t)*1e3}function Ec(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return zs("JWT malformed, contained fewer than 3 sections"),null;try{const i=Pm(r);return i?JSON.parse(i):(zs("Failed to decode base64 JWT payload"),null)}catch(i){return zs("Caught error parsing JWT payload as JSON",i?.toString()),null}}function sd(t){const e=Ec(t);return tt(e,"internal-error"),tt(typeof e.exp<"u","internal-error"),tt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Go(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof En&&wb(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function wb({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cb{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wl{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Lo(this.lastLoginAt),this.creationTime=Lo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ua(t){const e=t.auth,r=await t.getIdToken(),n=await Go(t,ca(e,{idToken:r}));tt(n?.users.length,e,"internal-error");const i=n.users[0];t._notifyReloadListener(i);const o=i.providerUserInfo?.length?Fm(i.providerUserInfo):[],a=Ib(t.providerData,o),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!a?.length,h=c?u:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Wl(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(t,f)}async function Ab(t){const e=Er(t);await ua(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Ib(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function Fm(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Eb(t,e){const r=await Vm(t,{},async()=>{const n=is({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=t.config,a=await Bm(t,i,"/v1/token",`key=${o}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:n};return t.emulatorConfig&&no(t.emulatorConfig.host)&&(u.credentials="include"),Om.fetch()(a,u)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function xb(t,e){return oo(t,"POST","/v2/accounts:revokeToken",Ic(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){tt(e.idToken,"internal-error"),tt(typeof e.idToken<"u","internal-error"),tt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):sd(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){tt(e.length!==0,"internal-error");const r=sd(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(tt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:o}=await Eb(e,r);this.updateTokensAndExpiration(n,i,Number(o))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:o}=r,a=new qi;return n&&(tt(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(tt(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),o&&(tt(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new qi,this.toJSON())}_performRefresh(){return bn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kn(t,e){tt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Hr{constructor({uid:e,auth:r,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new Cb(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Wl(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await Go(this,this.stsTokenManager.getToken(this.auth,e));return tt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return Pb(this,e)}reload(){return Ab(this)}_assign(e){this!==e&&(tt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Hr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){tt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await ua(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Or(this.auth.app))return Promise.reject(qn(this.auth));const e=await this.getIdToken();return await Go(this,Sb(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,i=r.email??void 0,o=r.phoneNumber??void 0,a=r.photoURL??void 0,c=r.tenantId??void 0,u=r._redirectEventId??void 0,h=r.createdAt??void 0,f=r.lastLoginAt??void 0,{uid:p,emailVerified:b,isAnonymous:C,providerData:R,stsTokenManager:E}=r;tt(p&&E,e,"internal-error");const x=qi.fromJSON(this.name,E);tt(typeof p=="string",e,"internal-error"),kn(n,e.name),kn(i,e.name),tt(typeof b=="boolean",e,"internal-error"),tt(typeof C=="boolean",e,"internal-error"),kn(o,e.name),kn(a,e.name),kn(c,e.name),kn(u,e.name),kn(h,e.name),kn(f,e.name);const T=new Hr({uid:p,auth:e,email:i,emailVerified:b,displayName:n,isAnonymous:C,photoURL:a,phoneNumber:o,tenantId:c,stsTokenManager:x,createdAt:h,lastLoginAt:f});return R&&Array.isArray(R)&&(T.providerData=R.map(W=>({...W}))),u&&(T._redirectEventId=u),T}static async _fromIdTokenResponse(e,r,n=!1){const i=new qi;i.updateFromServerResponse(r);const o=new Hr({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await ua(o),o}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];tt(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?Fm(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!o?.length,c=new qi;c.updateFromIdToken(n);const u=new Hr({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:a}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Wl(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(u,h),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ad=new Map;function _n(t){Cn(t instanceof Function,"Expected a class definition");let e=ad.get(t);return e?(Cn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,ad.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Um{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}Um.type="NONE";const ld=Um;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qs(t,e,r){return`firebase:${t}:${e}:${r}`}class Hi{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:o}=this.auth;this.fullUserKey=qs(this.userKey,i.apiKey,o),this.fullPersistenceKey=qs("persistence",i.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await ca(this.auth,{idToken:e}).catch(()=>{});return r?Hr._fromGetAccountInfoResponse(this.auth,r,e):null}return Hr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Hi(_n(ld),e,n);const i=(await Promise.all(r.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let o=i[0]||_n(ld);const a=qs(n,e.config.apiKey,e.name);let c=null;for(const h of r)try{const f=await h._get(a);if(f){let p;if(typeof f=="string"){const b=await ca(e,{idToken:f}).catch(()=>{});if(!b)break;p=await Hr._fromGetAccountInfoResponse(e,b,f)}else p=Hr._fromJSON(e,f);h!==o&&(c=p),o=h;break}}catch{}const u=i.filter(h=>h._shouldAllowMigration);return!o._shouldAllowMigration||!u.length?new Hi(o,e,n):(o=u[0],c&&await o._set(a,c.toJSON()),await Promise.all(r.map(async h=>{if(h!==o)try{await h._remove(a)}catch{}})),new Hi(o,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cd(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Hm(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(jm(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Gm(e))return"Blackberry";if(Ym(e))return"Webos";if(zm(e))return"Safari";if((e.includes("chrome/")||qm(e))&&!e.includes("edge/"))return"Chrome";if(Wm(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function jm(t=Cr()){return/firefox\//i.test(t)}function zm(t=Cr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function qm(t=Cr()){return/crios\//i.test(t)}function Hm(t=Cr()){return/iemobile/i.test(t)}function Wm(t=Cr()){return/android/i.test(t)}function Gm(t=Cr()){return/blackberry/i.test(t)}function Ym(t=Cr()){return/webos/i.test(t)}function xc(t=Cr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Tb(t=Cr()){return xc(t)&&!!window.navigator?.standalone}function $b(){return Wp()&&document.documentMode===10}function Km(t=Cr()){return xc(t)||Wm(t)||Ym(t)||Gm(t)||/windows phone/i.test(t)||Hm(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qm(t,e=[]){let r;switch(t){case"Browser":r=cd(Cr());break;case"Worker":r=`${cd(Cr())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${io}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kb{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=o=>new Promise((a,c)=>{try{const u=e(o);a(u)}catch(u){c(u)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rb(t,e={}){return oo(t,"GET","/v2/passwordPolicy",Ic(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Db=6;class Nb{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??Db,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lb{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ud(this),this.idTokenSubscription=new ud(this),this.beforeStateQueue=new kb(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Lm,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=_n(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Hi.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await ca(this,{idToken:e}),n=await Hr._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Or(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=this.redirectUser?._redirectEventId,a=n?._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(n=c.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return tt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await ua(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=yb()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Or(this.app))return Promise.reject(qn(this));const r=e?Er(e):null;return r&&tt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&tt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Or(this.app)?Promise.reject(qn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Or(this.app)?Promise.reject(qn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(_n(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Rb(this),r=new Nb(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ns("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await xb(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&_n(e)||this._popupRedirectResolver;tt(r,this,"argument-error"),this.redirectPersistenceManager=await Hi.create(this,[_n(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const o=typeof r=="function"?r:r.next.bind(r);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(tt(c,this,"internal-error"),c.then(()=>{a||o(this.currentUser)}),typeof r=="function"){const u=e.addObserver(r,n,i);return()=>{a=!0,u()}}else{const u=e.addObserver(r);return()=>{a=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return tt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Qm(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(Or(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&hb(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Ai(t){return Er(t)}class ud{constructor(e){this.auth=e,this.observer=null,this.addObserver=ev(r=>this.observer=r)}get next(){return tt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Mb(t){Tc=t}function Ob(t){return Tc.loadJS(t)}function Vb(){return Tc.gapiScript}function Bb(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fb(t,e){const r=Pc(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),o=r.getOptions();if(vi(o,e??{}))return i;an(i,"already-initialized")}return r.initialize({options:e})}function Ub(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(_n);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function jb(t,e,r){const n=Ai(t);tt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,o=Jm(e),{host:a,port:c}=zb(e),u=c===null?"":`:${c}`,h={url:`${o}//${a}${u}/`},f=Object.freeze({host:a,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){tt(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),tt(vi(h,n.config.emulator)&&vi(f,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=h,n.emulatorConfig=f,n.settings.appVerificationDisabledForTesting=!0,no(a)?(Im(`${o}//${a}${u}`),Em("Auth",!0)):qb()}function Jm(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function zb(t){const e=Jm(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const o=i[1];return{host:o,port:dd(n.substr(o.length+1))}}else{const[o,a]=n.split(":");return{host:o,port:dd(a)}}}function dd(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function qb(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xm{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return bn("not implemented")}_getIdTokenResponse(e){return bn("not implemented")}_linkToIdToken(e,r){return bn("not implemented")}_getReauthenticationResolver(e){return bn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wi(t,e){return bb(t,"POST","/v1/accounts:signInWithIdp",Ic(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hb="http://localhost";class _i extends Xm{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new _i(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):an("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...o}=r;if(!n||!i)return null;const a=new _i(n,i);return a.idToken=o.idToken||void 0,a.accessToken=o.accessToken||void 0,a.secret=o.secret,a.nonce=o.nonce,a.pendingToken=o.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return Wi(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Wi(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Wi(e,r)}buildRequest(){const e={requestUri:Hb,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=is(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss extends $a{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln extends ss{constructor(){super("facebook.com")}static credential(e){return _i._fromParams({providerId:Ln.PROVIDER_ID,signInMethod:Ln.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ln.credentialFromTaggedObject(e)}static credentialFromError(e){return Ln.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ln.credential(e.oauthAccessToken)}catch{return null}}}Ln.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ln.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr extends ss{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return _i._fromParams({providerId:Zr.PROVIDER_ID,signInMethod:Zr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Zr.credentialFromTaggedObject(e)}static credentialFromError(e){return Zr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Zr.credential(r,n)}catch{return null}}}Zr.GOOGLE_SIGN_IN_METHOD="google.com";Zr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn extends ss{constructor(){super("github.com")}static credential(e){return _i._fromParams({providerId:Mn.PROVIDER_ID,signInMethod:Mn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Mn.credentialFromTaggedObject(e)}static credentialFromError(e){return Mn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Mn.credential(e.oauthAccessToken)}catch{return null}}}Mn.GITHUB_SIGN_IN_METHOD="github.com";Mn.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On extends ss{constructor(){super("twitter.com")}static credential(e,r){return _i._fromParams({providerId:On.PROVIDER_ID,signInMethod:On.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return On.credentialFromTaggedObject(e)}static credentialFromError(e){return On.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return On.credential(r,n)}catch{return null}}}On.TWITTER_SIGN_IN_METHOD="twitter.com";On.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const o=await Hr._fromIdTokenResponse(e,n,i),a=hd(n);return new Ki({user:o,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=hd(n);return new Ki({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function hd(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da extends En{constructor(e,r,n,i){super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,da.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new da(e,r,n,i)}}function Zm(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?da._fromErrorAndOperation(t,o,e,n):o})}async function Wb(t,e,r=!1){const n=await Go(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Ki._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gb(t,e,r=!1){const{auth:n}=t;if(Or(n.app))return Promise.reject(qn(n));const i="reauthenticate";try{const o=await Go(t,Zm(n,i,e,t),r);tt(o.idToken,n,"internal-error");const a=Ec(o.idToken);tt(a,n,"internal-error");const{sub:c}=a;return tt(t.uid===c,n,"user-mismatch"),Ki._forOperation(t,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&an(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ef(t,e,r=!1){if(Or(t.app))return Promise.reject(qn(t));const n="signIn",i=await Zm(t,n,e),o=await Ki._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(o.user),o}async function Yb(t,e){return ef(Ai(t),e)}function Kb(t,e,r,n){return Er(t).onIdTokenChanged(e,r,n)}function Qb(t,e,r){return Er(t).beforeAuthStateChanged(e,r)}function Jb(t,e,r,n){return Er(t).onAuthStateChanged(e,r,n)}function Xb(t){return Er(t).signOut()}const ha="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(ha,"1"),this.storage.removeItem(ha),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zb=1e3,e0=10;class rf extends tf{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Km(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,c,u)=>{this.notifyListeners(a,u)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},o=this.storage.getItem(n);$b()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,e0):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},Zb)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}rf.type="LOCAL";const t0=rf;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf extends tf{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}nf.type="SESSION";const of=nf;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r0(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new ka(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:o}=r.data,a=this.handlersMap[i];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const c=Array.from(a).map(async h=>h(r.origin,o)),u=await r0(c);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:u})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ka.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $c(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n0{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,a;return new Promise((c,u)=>{const h=$c("",20);i.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(p){const b=p;if(b.data.eventId===h)switch(b.data.status){case"ack":clearTimeout(f),o=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),c(b.data.response);break;default:clearTimeout(f),clearTimeout(o),u(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:h,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function en(){return window}function i0(t){en().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sf(){return typeof en().WorkerGlobalScope<"u"&&typeof en().importScripts=="function"}async function o0(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function s0(){return navigator?.serviceWorker?.controller||null}function a0(){return sf()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const af="firebaseLocalStorageDb",l0=1,ma="firebaseLocalStorage",lf="fbase_key";class as{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Ra(t,e){return t.transaction([ma],e?"readwrite":"readonly").objectStore(ma)}function c0(){const t=indexedDB.deleteDatabase(af);return new as(t).toPromise()}function Gl(){const t=indexedDB.open(af,l0);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(ma,{keyPath:lf})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(ma)?e(n):(n.close(),await c0(),e(await Gl()))})})}async function md(t,e,r){const n=Ra(t,!0).put({[lf]:e,value:r});return new as(n).toPromise()}async function u0(t,e){const r=Ra(t,!1).get(e),n=await new as(r).toPromise();return n===void 0?null:n.value}function fd(t,e){const r=Ra(t,!0).delete(e);return new as(r).toPromise()}const d0=800,h0=3;class cf{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Gl(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>h0)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return sf()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ka._getInstance(a0()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await o0(),!this.activeServiceWorker)return;this.sender=new n0(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||s0()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Gl();return await md(e,ha,"1"),await fd(e,ha),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>md(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>u0(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>fd(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=Ra(i,!1).getAll();return new as(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),d0)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}cf.type="LOCAL";const m0=cf;new os(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kc(t,e){return e?_n(e):(tt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rc extends Xm{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Wi(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Wi(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Wi(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function f0(t){return ef(t.auth,new Rc(t),t.bypassAuthState)}function y0(t){const{auth:e,user:r}=t;return tt(r,e,"internal-error"),Gb(r,new Rc(t),t.bypassAuthState)}async function g0(t){const{auth:e,user:r}=t;return tt(r,e,"internal-error"),Wb(r,new Rc(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(e,r,n,i,o=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:o,error:a,type:c}=e;if(a){this.reject(a);return}const u={auth:this.auth,requestUri:r,sessionId:n,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return f0;case"linkViaPopup":case"linkViaRedirect":return g0;case"reauthViaPopup":case"reauthViaRedirect":return y0;default:an(this.auth,"internal-error")}}resolve(e){Cn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Cn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p0=new os(2e3,1e4);async function v0(t,e,r){if(Or(t.app))return Promise.reject(Wr(t,"operation-not-supported-in-this-environment"));const n=Ai(t);Mm(t,e,$a);const i=kc(n,r);return new fi(n,"signInViaPopup",e,i).executeNotNull()}class fi extends uf{constructor(e,r,n,i,o){super(e,r,i,o),this.provider=n,this.authWindow=null,this.pollId=null,fi.currentPopupAction&&fi.currentPopupAction.cancel(),fi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return tt(e,this.auth,"internal-error"),e}async onExecution(){Cn(this.filter.length===1,"Popup operations only handle one event");const e=$c();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Wr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Wr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,fi.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Wr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,p0.get())};e()}}fi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b0="pendingRedirect",Hs=new Map;class _0 extends uf{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Hs.get(this.auth._key());if(!e){try{const n=await S0(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Hs.set(this.auth._key(),e)}return this.bypassAuthState||Hs.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function S0(t,e){const r=hf(e),n=df(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}async function P0(t,e){return df(t)._set(hf(e),"true")}function w0(t,e){Hs.set(t._key(),e)}function df(t){return _n(t._redirectPersistence)}function hf(t){return qs(b0,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C0(t,e,r){return A0(t,e,r)}async function A0(t,e,r){if(Or(t.app))return Promise.reject(qn(t));const n=Ai(t);Mm(t,e,$a),await n._initializationPromise;const i=kc(n,r);return await P0(i,n),i._openRedirect(n,e,"signInViaRedirect")}async function I0(t,e){return await Ai(t)._initializationPromise,mf(t,e,!1)}async function mf(t,e,r=!1){if(Or(t.app))return Promise.reject(qn(t));const n=Ai(t),i=kc(n,e),a=await new _0(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E0=10*60*1e3;class x0{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!T0(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!ff(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(Wr(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=E0&&this.cachedEventUids.clear(),this.cachedEventUids.has(yd(e))}saveEventToCache(e){this.cachedEventUids.add(yd(e)),this.lastProcessedEventTime=Date.now()}}function yd(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function ff({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function T0(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ff(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $0(t,e={}){return oo(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k0=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,R0=/^https?/;async function D0(t){if(t.config.emulator)return;const{authorizedDomains:e}=await $0(t);for(const r of e)try{if(N0(r))return}catch{}an(t,"unauthorized-domain")}function N0(t){const e=Hl(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!R0.test(r))return!1;if(k0.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L0=new os(3e4,6e4);function gd(){const t=en().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function M0(t){return new Promise((e,r)=>{function n(){gd(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{gd(),r(Wr(t,"network-request-failed"))},timeout:L0.get()})}if(en().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(en().gapi?.load)n();else{const i=Bb("iframefcb");return en()[i]=()=>{gapi.load?n():r(Wr(t,"network-request-failed"))},Ob(`${Vb()}?onload=${i}`).catch(o=>r(o))}}).catch(e=>{throw Ws=null,e})}let Ws=null;function O0(t){return Ws=Ws||M0(t),Ws}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V0=new os(5e3,15e3),B0="__/auth/iframe",F0="emulator/auth/iframe",U0={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},j0=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function z0(t){const e=t.config;tt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Ac(e,F0):`https://${t.config.authDomain}/${B0}`,n={apiKey:e.apiKey,appName:t.name,v:io},i=j0.get(t.config.apiHost);i&&(n.eid=i);const o=t._getFrameworks();return o.length&&(n.fw=o.join(",")),`${r}?${is(n).slice(1)}`}async function q0(t){const e=await O0(t),r=en().gapi;return tt(r,t,"internal-error"),e.open({where:document.body,url:z0(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:U0,dontclear:!0},n=>new Promise(async(i,o)=>{await n.restyle({setHideOnLeave:!1});const a=Wr(t,"network-request-failed"),c=en().setTimeout(()=>{o(a)},V0.get());function u(){en().clearTimeout(c),i(n)}n.ping(u).then(u,()=>{o(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H0={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},W0=500,G0=600,Y0="_blank",K0="http://localhost";class pd{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Q0(t,e,r,n=W0,i=G0){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const u={...H0,width:n.toString(),height:i.toString(),top:o,left:a},h=Cr().toLowerCase();r&&(c=qm(h)?Y0:r),jm(h)&&(e=e||K0,u.scrollbars="yes");const f=Object.entries(u).reduce((b,[C,R])=>`${b}${C}=${R},`,"");if(Tb(h)&&c!=="_self")return J0(e||"",c),new pd(null);const p=window.open(e||"",c,f);tt(p,t,"popup-blocked");try{p.focus()}catch{}return new pd(p)}function J0(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X0="__/auth/handler",Z0="emulator/auth/handler",e_=encodeURIComponent("fac");async function vd(t,e,r,n,i,o){tt(t.config.authDomain,t,"auth-domain-config-required"),tt(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:io,eventId:i};if(e instanceof $a){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",Zp(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))a[f]=p}if(e instanceof ss){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const c=a;for(const f of Object.keys(c))c[f]===void 0&&delete c[f];const u=await t._getAppCheckToken(),h=u?`#${e_}=${encodeURIComponent(u)}`:"";return`${t_(t)}?${is(c).slice(1)}${h}`}function t_({config:t}){return t.emulator?Ac(t,Z0):`https://${t.authDomain}/${X0}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ul="webStorageSupport";class r_{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=of,this._completeRedirectFn=mf,this._overrideRedirectResult=w0}async _openPopup(e,r,n,i){Cn(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const o=await vd(e,r,n,Hl(),i);return Q0(e,o,$c())}async _openRedirect(e,r,n,i){await this._originValidation(e);const o=await vd(e,r,n,Hl(),i);return i0(o),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:o}=this.eventManagers[r];return i?Promise.resolve(i):(Cn(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await q0(e),n=new x0(e);return r.register("authEvent",i=>(tt(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(ul,{type:ul},i=>{const o=i?.[0]?.[ul];o!==void 0&&r(!!o),an(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=D0(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return Km()||zm()||xc()}}const n_=r_;var bd="@firebase/auth",_d="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i_{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){tt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o_(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function s_(t){Yi(new bi("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=n.options;tt(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const u={apiKey:a,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Qm(t)},h=new Lb(n,i,o,u);return Ub(h,r),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Yi(new bi("auth-internal",e=>{const r=Ai(e.getProvider("auth").getImmediate());return(n=>new i_(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),zn(bd,_d,o_(t)),zn(bd,_d,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a_=5*60,l_=Am("authIdTokenMaxAge")||a_;let Sd=null;const c_=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>l_)return;const i=r?.token;Sd!==i&&(Sd=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function u_(t=km()){const e=Pc(t,"auth");if(e.isInitialized())return e.getImmediate();const r=Fb(t,{popupRedirectResolver:n_,persistence:[m0,t0,of]}),n=Am("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const a=c_(o.toString());Qb(r,a,()=>a(r.currentUser)),Kb(r,c=>a(c))}}const i=wm("auth");return i&&jb(r,`http://${i}`),r}function d_(){return document.getElementsByTagName("head")?.[0]??document}Mb({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const o=Wr("internal-error");o.customData=i,r(o)},n.type="text/javascript",n.charset="UTF-8",d_().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});s_("Browser");var h_="firebase",m_="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */zn(h_,m_,"app");var Pd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Hn,yf;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,_){function v(){}v.prototype=_.prototype,I.D=_.prototype,I.prototype=new v,I.prototype.constructor=I,I.C=function(P,w,A){for(var y=Array(arguments.length-2),he=2;he<arguments.length;he++)y[he-2]=arguments[he];return _.prototype[w].apply(P,y)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,_,v){v||(v=0);var P=Array(16);if(typeof _=="string")for(var w=0;16>w;++w)P[w]=_.charCodeAt(v++)|_.charCodeAt(v++)<<8|_.charCodeAt(v++)<<16|_.charCodeAt(v++)<<24;else for(w=0;16>w;++w)P[w]=_[v++]|_[v++]<<8|_[v++]<<16|_[v++]<<24;_=I.g[0],v=I.g[1],w=I.g[2];var A=I.g[3],y=_+(A^v&(w^A))+P[0]+3614090360&4294967295;_=v+(y<<7&4294967295|y>>>25),y=A+(w^_&(v^w))+P[1]+3905402710&4294967295,A=_+(y<<12&4294967295|y>>>20),y=w+(v^A&(_^v))+P[2]+606105819&4294967295,w=A+(y<<17&4294967295|y>>>15),y=v+(_^w&(A^_))+P[3]+3250441966&4294967295,v=w+(y<<22&4294967295|y>>>10),y=_+(A^v&(w^A))+P[4]+4118548399&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(w^_&(v^w))+P[5]+1200080426&4294967295,A=_+(y<<12&4294967295|y>>>20),y=w+(v^A&(_^v))+P[6]+2821735955&4294967295,w=A+(y<<17&4294967295|y>>>15),y=v+(_^w&(A^_))+P[7]+4249261313&4294967295,v=w+(y<<22&4294967295|y>>>10),y=_+(A^v&(w^A))+P[8]+1770035416&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(w^_&(v^w))+P[9]+2336552879&4294967295,A=_+(y<<12&4294967295|y>>>20),y=w+(v^A&(_^v))+P[10]+4294925233&4294967295,w=A+(y<<17&4294967295|y>>>15),y=v+(_^w&(A^_))+P[11]+2304563134&4294967295,v=w+(y<<22&4294967295|y>>>10),y=_+(A^v&(w^A))+P[12]+1804603682&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(w^_&(v^w))+P[13]+4254626195&4294967295,A=_+(y<<12&4294967295|y>>>20),y=w+(v^A&(_^v))+P[14]+2792965006&4294967295,w=A+(y<<17&4294967295|y>>>15),y=v+(_^w&(A^_))+P[15]+1236535329&4294967295,v=w+(y<<22&4294967295|y>>>10),y=_+(w^A&(v^w))+P[1]+4129170786&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^w&(_^v))+P[6]+3225465664&4294967295,A=_+(y<<9&4294967295|y>>>23),y=w+(_^v&(A^_))+P[11]+643717713&4294967295,w=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(w^A))+P[0]+3921069994&4294967295,v=w+(y<<20&4294967295|y>>>12),y=_+(w^A&(v^w))+P[5]+3593408605&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^w&(_^v))+P[10]+38016083&4294967295,A=_+(y<<9&4294967295|y>>>23),y=w+(_^v&(A^_))+P[15]+3634488961&4294967295,w=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(w^A))+P[4]+3889429448&4294967295,v=w+(y<<20&4294967295|y>>>12),y=_+(w^A&(v^w))+P[9]+568446438&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^w&(_^v))+P[14]+3275163606&4294967295,A=_+(y<<9&4294967295|y>>>23),y=w+(_^v&(A^_))+P[3]+4107603335&4294967295,w=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(w^A))+P[8]+1163531501&4294967295,v=w+(y<<20&4294967295|y>>>12),y=_+(w^A&(v^w))+P[13]+2850285829&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^w&(_^v))+P[2]+4243563512&4294967295,A=_+(y<<9&4294967295|y>>>23),y=w+(_^v&(A^_))+P[7]+1735328473&4294967295,w=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(w^A))+P[12]+2368359562&4294967295,v=w+(y<<20&4294967295|y>>>12),y=_+(v^w^A)+P[5]+4294588738&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^w)+P[8]+2272392833&4294967295,A=_+(y<<11&4294967295|y>>>21),y=w+(A^_^v)+P[11]+1839030562&4294967295,w=A+(y<<16&4294967295|y>>>16),y=v+(w^A^_)+P[14]+4259657740&4294967295,v=w+(y<<23&4294967295|y>>>9),y=_+(v^w^A)+P[1]+2763975236&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^w)+P[4]+1272893353&4294967295,A=_+(y<<11&4294967295|y>>>21),y=w+(A^_^v)+P[7]+4139469664&4294967295,w=A+(y<<16&4294967295|y>>>16),y=v+(w^A^_)+P[10]+3200236656&4294967295,v=w+(y<<23&4294967295|y>>>9),y=_+(v^w^A)+P[13]+681279174&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^w)+P[0]+3936430074&4294967295,A=_+(y<<11&4294967295|y>>>21),y=w+(A^_^v)+P[3]+3572445317&4294967295,w=A+(y<<16&4294967295|y>>>16),y=v+(w^A^_)+P[6]+76029189&4294967295,v=w+(y<<23&4294967295|y>>>9),y=_+(v^w^A)+P[9]+3654602809&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^w)+P[12]+3873151461&4294967295,A=_+(y<<11&4294967295|y>>>21),y=w+(A^_^v)+P[15]+530742520&4294967295,w=A+(y<<16&4294967295|y>>>16),y=v+(w^A^_)+P[2]+3299628645&4294967295,v=w+(y<<23&4294967295|y>>>9),y=_+(w^(v|~A))+P[0]+4096336452&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~w))+P[7]+1126891415&4294967295,A=_+(y<<10&4294967295|y>>>22),y=w+(_^(A|~v))+P[14]+2878612391&4294967295,w=A+(y<<15&4294967295|y>>>17),y=v+(A^(w|~_))+P[5]+4237533241&4294967295,v=w+(y<<21&4294967295|y>>>11),y=_+(w^(v|~A))+P[12]+1700485571&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~w))+P[3]+2399980690&4294967295,A=_+(y<<10&4294967295|y>>>22),y=w+(_^(A|~v))+P[10]+4293915773&4294967295,w=A+(y<<15&4294967295|y>>>17),y=v+(A^(w|~_))+P[1]+2240044497&4294967295,v=w+(y<<21&4294967295|y>>>11),y=_+(w^(v|~A))+P[8]+1873313359&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~w))+P[15]+4264355552&4294967295,A=_+(y<<10&4294967295|y>>>22),y=w+(_^(A|~v))+P[6]+2734768916&4294967295,w=A+(y<<15&4294967295|y>>>17),y=v+(A^(w|~_))+P[13]+1309151649&4294967295,v=w+(y<<21&4294967295|y>>>11),y=_+(w^(v|~A))+P[4]+4149444226&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~w))+P[11]+3174756917&4294967295,A=_+(y<<10&4294967295|y>>>22),y=w+(_^(A|~v))+P[2]+718787259&4294967295,w=A+(y<<15&4294967295|y>>>17),y=v+(A^(w|~_))+P[9]+3951481745&4294967295,I.g[0]=I.g[0]+_&4294967295,I.g[1]=I.g[1]+(w+(y<<21&4294967295|y>>>11))&4294967295,I.g[2]=I.g[2]+w&4294967295,I.g[3]=I.g[3]+A&4294967295}n.prototype.u=function(I,_){_===void 0&&(_=I.length);for(var v=_-this.blockSize,P=this.B,w=this.h,A=0;A<_;){if(w==0)for(;A<=v;)i(this,I,A),A+=this.blockSize;if(typeof I=="string"){for(;A<_;)if(P[w++]=I.charCodeAt(A++),w==this.blockSize){i(this,P),w=0;break}}else for(;A<_;)if(P[w++]=I[A++],w==this.blockSize){i(this,P),w=0;break}}this.h=w,this.o+=_},n.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var _=1;_<I.length-8;++_)I[_]=0;var v=8*this.o;for(_=I.length-8;_<I.length;++_)I[_]=v&255,v/=256;for(this.u(I),I=Array(16),_=v=0;4>_;++_)for(var P=0;32>P;P+=8)I[v++]=this.g[_]>>>P&255;return I};function o(I,_){var v=c;return Object.prototype.hasOwnProperty.call(v,I)?v[I]:v[I]=_(I)}function a(I,_){this.h=_;for(var v=[],P=!0,w=I.length-1;0<=w;w--){var A=I[w]|0;P&&A==_||(v[w]=A,P=!1)}this.g=v}var c={};function u(I){return-128<=I&&128>I?o(I,function(_){return new a([_|0],0>_?-1:0)}):new a([I|0],0>I?-1:0)}function h(I){if(isNaN(I)||!isFinite(I))return p;if(0>I)return x(h(-I));for(var _=[],v=1,P=0;I>=v;P++)_[P]=I/v|0,v*=4294967296;return new a(_,0)}function f(I,_){if(I.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(I.charAt(0)=="-")return x(f(I.substring(1),_));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=h(Math.pow(_,8)),P=p,w=0;w<I.length;w+=8){var A=Math.min(8,I.length-w),y=parseInt(I.substring(w,w+A),_);8>A?(A=h(Math.pow(_,A)),P=P.j(A).add(h(y))):(P=P.j(v),P=P.add(h(y)))}return P}var p=u(0),b=u(1),C=u(16777216);t=a.prototype,t.m=function(){if(E(this))return-x(this).m();for(var I=0,_=1,v=0;v<this.g.length;v++){var P=this.i(v);I+=(0<=P?P:4294967296+P)*_,_*=4294967296}return I},t.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(R(this))return"0";if(E(this))return"-"+x(this).toString(I);for(var _=h(Math.pow(I,6)),v=this,P="";;){var w=Q(v,_).g;v=T(v,w.j(_));var A=((0<v.g.length?v.g[0]:v.h)>>>0).toString(I);if(v=w,R(v))return A+P;for(;6>A.length;)A="0"+A;P=A+P}},t.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function R(I){if(I.h!=0)return!1;for(var _=0;_<I.g.length;_++)if(I.g[_]!=0)return!1;return!0}function E(I){return I.h==-1}t.l=function(I){return I=T(this,I),E(I)?-1:R(I)?0:1};function x(I){for(var _=I.g.length,v=[],P=0;P<_;P++)v[P]=~I.g[P];return new a(v,~I.h).add(b)}t.abs=function(){return E(this)?x(this):this},t.add=function(I){for(var _=Math.max(this.g.length,I.g.length),v=[],P=0,w=0;w<=_;w++){var A=P+(this.i(w)&65535)+(I.i(w)&65535),y=(A>>>16)+(this.i(w)>>>16)+(I.i(w)>>>16);P=y>>>16,A&=65535,y&=65535,v[w]=y<<16|A}return new a(v,v[v.length-1]&-2147483648?-1:0)};function T(I,_){return I.add(x(_))}t.j=function(I){if(R(this)||R(I))return p;if(E(this))return E(I)?x(this).j(x(I)):x(x(this).j(I));if(E(I))return x(this.j(x(I)));if(0>this.l(C)&&0>I.l(C))return h(this.m()*I.m());for(var _=this.g.length+I.g.length,v=[],P=0;P<2*_;P++)v[P]=0;for(P=0;P<this.g.length;P++)for(var w=0;w<I.g.length;w++){var A=this.i(P)>>>16,y=this.i(P)&65535,he=I.i(w)>>>16,G=I.i(w)&65535;v[2*P+2*w]+=y*G,W(v,2*P+2*w),v[2*P+2*w+1]+=A*G,W(v,2*P+2*w+1),v[2*P+2*w+1]+=y*he,W(v,2*P+2*w+1),v[2*P+2*w+2]+=A*he,W(v,2*P+2*w+2)}for(P=0;P<_;P++)v[P]=v[2*P+1]<<16|v[2*P];for(P=_;P<2*_;P++)v[P]=0;return new a(v,0)};function W(I,_){for(;(I[_]&65535)!=I[_];)I[_+1]+=I[_]>>>16,I[_]&=65535,_++}function te(I,_){this.g=I,this.h=_}function Q(I,_){if(R(_))throw Error("division by zero");if(R(I))return new te(p,p);if(E(I))return _=Q(x(I),_),new te(x(_.g),x(_.h));if(E(_))return _=Q(I,x(_)),new te(x(_.g),_.h);if(30<I.g.length){if(E(I)||E(_))throw Error("slowDivide_ only works with positive integers.");for(var v=b,P=_;0>=P.l(I);)v=de(v),P=de(P);var w=ae(v,1),A=ae(P,1);for(P=ae(P,2),v=ae(v,2);!R(P);){var y=A.add(P);0>=y.l(I)&&(w=w.add(v),A=y),P=ae(P,1),v=ae(v,1)}return _=T(I,w.j(_)),new te(w,_)}for(w=p;0<=I.l(_);){for(v=Math.max(1,Math.floor(I.m()/_.m())),P=Math.ceil(Math.log(v)/Math.LN2),P=48>=P?1:Math.pow(2,P-48),A=h(v),y=A.j(_);E(y)||0<y.l(I);)v-=P,A=h(v),y=A.j(_);R(A)&&(A=b),w=w.add(A),I=T(I,y)}return new te(w,I)}t.A=function(I){return Q(this,I).h},t.and=function(I){for(var _=Math.max(this.g.length,I.g.length),v=[],P=0;P<_;P++)v[P]=this.i(P)&I.i(P);return new a(v,this.h&I.h)},t.or=function(I){for(var _=Math.max(this.g.length,I.g.length),v=[],P=0;P<_;P++)v[P]=this.i(P)|I.i(P);return new a(v,this.h|I.h)},t.xor=function(I){for(var _=Math.max(this.g.length,I.g.length),v=[],P=0;P<_;P++)v[P]=this.i(P)^I.i(P);return new a(v,this.h^I.h)};function de(I){for(var _=I.g.length+1,v=[],P=0;P<_;P++)v[P]=I.i(P)<<1|I.i(P-1)>>>31;return new a(v,I.h)}function ae(I,_){var v=_>>5;_%=32;for(var P=I.g.length-v,w=[],A=0;A<P;A++)w[A]=0<_?I.i(A+v)>>>_|I.i(A+v+1)<<32-_:I.i(A+v);return new a(w,I.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,yf=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=f,Hn=a}).apply(typeof Pd<"u"?Pd:typeof self<"u"?self:typeof window<"u"?window:{});var Is=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var gf,Eo,pf,Gs,Yl,vf,bf,_f;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,m,g){return l==Array.prototype||l==Object.prototype||(l[m]=g.value),l};function r(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Is=="object"&&Is];for(var m=0;m<l.length;++m){var g=l[m];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var n=r(this);function i(l,m){if(m)e:{var g=n;l=l.split(".");for(var L=0;L<l.length-1;L++){var Se=l[L];if(!(Se in g))break e;g=g[Se]}l=l[l.length-1],L=g[l],m=m(L),m!=L&&m!=null&&e(g,l,{configurable:!0,writable:!0,value:m})}}function o(l,m){l instanceof String&&(l+="");var g=0,L=!1,Se={next:function(){if(!L&&g<l.length){var Ce=g++;return{value:m(Ce,l[Ce]),done:!1}}return L=!0,{done:!0,value:void 0}}};return Se[Symbol.iterator]=function(){return Se},Se}i("Array.prototype.values",function(l){return l||function(){return o(this,function(m,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},c=this||self;function u(l){var m=typeof l;return m=m!="object"?m:l?Array.isArray(l)?"array":m:"null",m=="array"||m=="object"&&typeof l.length=="number"}function h(l){var m=typeof l;return m=="object"&&l!=null||m=="function"}function f(l,m,g){return l.call.apply(l.bind,arguments)}function p(l,m,g){if(!l)throw Error();if(2<arguments.length){var L=Array.prototype.slice.call(arguments,2);return function(){var Se=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Se,L),l.apply(m,Se)}}return function(){return l.apply(m,arguments)}}function b(l,m,g){return b=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,b.apply(null,arguments)}function C(l,m){var g=Array.prototype.slice.call(arguments,1);return function(){var L=g.slice();return L.push.apply(L,arguments),l.apply(this,L)}}function R(l,m){function g(){}g.prototype=m.prototype,l.aa=m.prototype,l.prototype=new g,l.prototype.constructor=l,l.Qb=function(L,Se,Ce){for(var Ne=Array(arguments.length-2),Lt=2;Lt<arguments.length;Lt++)Ne[Lt-2]=arguments[Lt];return m.prototype[Se].apply(L,Ne)}}function E(l){const m=l.length;if(0<m){const g=Array(m);for(let L=0;L<m;L++)g[L]=l[L];return g}return[]}function x(l,m){for(let g=1;g<arguments.length;g++){const L=arguments[g];if(u(L)){const Se=l.length||0,Ce=L.length||0;l.length=Se+Ce;for(let Ne=0;Ne<Ce;Ne++)l[Se+Ne]=L[Ne]}else l.push(L)}}class T{constructor(m,g){this.i=m,this.j=g,this.h=0,this.g=null}get(){let m;return 0<this.h?(this.h--,m=this.g,this.g=m.next,m.next=null):m=this.i(),m}}function W(l){return/^[\s\xa0]*$/.test(l)}function te(){var l=c.navigator;return l&&(l=l.userAgent)?l:""}function Q(l){return Q[" "](l),l}Q[" "]=function(){};var de=te().indexOf("Gecko")!=-1&&!(te().toLowerCase().indexOf("webkit")!=-1&&te().indexOf("Edge")==-1)&&!(te().indexOf("Trident")!=-1||te().indexOf("MSIE")!=-1)&&te().indexOf("Edge")==-1;function ae(l,m,g){for(const L in l)m.call(g,l[L],L,l)}function I(l,m){for(const g in l)m.call(void 0,l[g],g,l)}function _(l){const m={};for(const g in l)m[g]=l[g];return m}const v="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function P(l,m){let g,L;for(let Se=1;Se<arguments.length;Se++){L=arguments[Se];for(g in L)l[g]=L[g];for(let Ce=0;Ce<v.length;Ce++)g=v[Ce],Object.prototype.hasOwnProperty.call(L,g)&&(l[g]=L[g])}}function w(l){var m=1;l=l.split(":");const g=[];for(;0<m&&l.length;)g.push(l.shift()),m--;return l.length&&g.push(l.join(":")),g}function A(l){c.setTimeout(()=>{throw l},0)}function y(){var l=F;let m=null;return l.g&&(m=l.g,l.g=l.g.next,l.g||(l.h=null),m.next=null),m}class he{constructor(){this.h=this.g=null}add(m,g){const L=G.get();L.set(m,g),this.h?this.h.next=L:this.g=L,this.h=L}}var G=new T(()=>new k,l=>l.reset());class k{constructor(){this.next=this.g=this.h=null}set(m,g){this.h=m,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let Z,U=!1,F=new he,N=()=>{const l=c.Promise.resolve(void 0);Z=()=>{l.then(V)}};var V=()=>{for(var l;l=y();){try{l.h.call(l.g)}catch(g){A(g)}var m=G;m.j(l),100>m.h&&(m.h++,l.next=m.g,m.g=l)}U=!1};function fe(){this.s=this.s,this.C=this.C}fe.prototype.s=!1,fe.prototype.ma=function(){this.s||(this.s=!0,this.N())},fe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function z(l,m){this.type=l,this.g=this.target=m,this.defaultPrevented=!1}z.prototype.h=function(){this.defaultPrevented=!0};var ge=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var l=!1,m=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const g=()=>{};c.addEventListener("test",g,m),c.removeEventListener("test",g,m)}catch{}return l}();function $(l,m){if(z.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var g=this.type=l.type,L=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=m,m=l.relatedTarget){if(de){e:{try{Q(m.nodeName);var Se=!0;break e}catch{}Se=!1}Se||(m=null)}}else g=="mouseover"?m=l.fromElement:g=="mouseout"&&(m=l.toElement);this.relatedTarget=m,L?(this.clientX=L.clientX!==void 0?L.clientX:L.pageX,this.clientY=L.clientY!==void 0?L.clientY:L.pageY,this.screenX=L.screenX||0,this.screenY=L.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:O[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&$.aa.h.call(this)}}R($,z);var O={2:"touch",3:"pen",4:"mouse"};$.prototype.h=function(){$.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var X="closure_listenable_"+(1e6*Math.random()|0),Y=0;function ue(l,m,g,L,Se){this.listener=l,this.proxy=null,this.src=m,this.type=g,this.capture=!!L,this.ha=Se,this.key=++Y,this.da=this.fa=!1}function re(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function M(l){this.src=l,this.g={},this.h=0}M.prototype.add=function(l,m,g,L,Se){var Ce=l.toString();l=this.g[Ce],l||(l=this.g[Ce]=[],this.h++);var Ne=pe(l,m,L,Se);return-1<Ne?(m=l[Ne],g||(m.fa=!1)):(m=new ue(m,this.src,Ce,!!L,Se),m.fa=g,l.push(m)),m};function oe(l,m){var g=m.type;if(g in l.g){var L=l.g[g],Se=Array.prototype.indexOf.call(L,m,void 0),Ce;(Ce=0<=Se)&&Array.prototype.splice.call(L,Se,1),Ce&&(re(m),l.g[g].length==0&&(delete l.g[g],l.h--))}}function pe(l,m,g,L){for(var Se=0;Se<l.length;++Se){var Ce=l[Se];if(!Ce.da&&Ce.listener==m&&Ce.capture==!!g&&Ce.ha==L)return Se}return-1}var be="closure_lm_"+(1e6*Math.random()|0),ne={};function le(l,m,g,L,Se){if(Array.isArray(m)){for(var Ce=0;Ce<m.length;Ce++)le(l,m[Ce],g,L,Se);return null}return g=we(g),l&&l[X]?l.K(m,g,h(L)?!!L.capture:!1,Se):j(l,m,g,!1,L,Se)}function j(l,m,g,L,Se,Ce){if(!m)throw Error("Invalid event type");var Ne=h(Se)?!!Se.capture:!!Se,Lt=B(l);if(Lt||(l[be]=Lt=new M(l)),g=Lt.add(m,g,L,Ne,Ce),g.proxy)return g;if(L=ce(),g.proxy=L,L.src=l,L.listener=g,l.addEventListener)ge||(Se=Ne),Se===void 0&&(Se=!1),l.addEventListener(m.toString(),L,Se);else if(l.attachEvent)l.attachEvent(ee(m.toString()),L);else if(l.addListener&&l.removeListener)l.addListener(L);else throw Error("addEventListener and attachEvent are unavailable.");return g}function ce(){function l(g){return m.call(l.src,l.listener,g)}const m=q;return l}function D(l,m,g,L,Se){if(Array.isArray(m))for(var Ce=0;Ce<m.length;Ce++)D(l,m[Ce],g,L,Se);else L=h(L)?!!L.capture:!!L,g=we(g),l&&l[X]?(l=l.i,m=String(m).toString(),m in l.g&&(Ce=l.g[m],g=pe(Ce,g,L,Se),-1<g&&(re(Ce[g]),Array.prototype.splice.call(Ce,g,1),Ce.length==0&&(delete l.g[m],l.h--)))):l&&(l=B(l))&&(m=l.g[m.toString()],l=-1,m&&(l=pe(m,g,L,Se)),(g=-1<l?m[l]:null)&&J(g))}function J(l){if(typeof l!="number"&&l&&!l.da){var m=l.src;if(m&&m[X])oe(m.i,l);else{var g=l.type,L=l.proxy;m.removeEventListener?m.removeEventListener(g,L,l.capture):m.detachEvent?m.detachEvent(ee(g),L):m.addListener&&m.removeListener&&m.removeListener(L),(g=B(m))?(oe(g,l),g.h==0&&(g.src=null,m[be]=null)):re(l)}}}function ee(l){return l in ne?ne[l]:ne[l]="on"+l}function q(l,m){if(l.da)l=!0;else{m=new $(m,this);var g=l.listener,L=l.ha||l.src;l.fa&&J(l),l=g.call(L,m)}return l}function B(l){return l=l[be],l instanceof M?l:null}var _e="__closure_events_fn_"+(1e9*Math.random()>>>0);function we(l){return typeof l=="function"?l:(l[_e]||(l[_e]=function(m){return l.handleEvent(m)}),l[_e])}function ie(){fe.call(this),this.i=new M(this),this.M=this,this.F=null}R(ie,fe),ie.prototype[X]=!0,ie.prototype.removeEventListener=function(l,m,g,L){D(this,l,m,g,L)};function ve(l,m){var g,L=l.F;if(L)for(g=[];L;L=L.F)g.push(L);if(l=l.M,L=m.type||m,typeof m=="string")m=new z(m,l);else if(m instanceof z)m.target=m.target||l;else{var Se=m;m=new z(L,l),P(m,Se)}if(Se=!0,g)for(var Ce=g.length-1;0<=Ce;Ce--){var Ne=m.g=g[Ce];Se=K(Ne,L,!0,m)&&Se}if(Ne=m.g=l,Se=K(Ne,L,!0,m)&&Se,Se=K(Ne,L,!1,m)&&Se,g)for(Ce=0;Ce<g.length;Ce++)Ne=m.g=g[Ce],Se=K(Ne,L,!1,m)&&Se}ie.prototype.N=function(){if(ie.aa.N.call(this),this.i){var l=this.i,m;for(m in l.g){for(var g=l.g[m],L=0;L<g.length;L++)re(g[L]);delete l.g[m],l.h--}}this.F=null},ie.prototype.K=function(l,m,g,L){return this.i.add(String(l),m,!1,g,L)},ie.prototype.L=function(l,m,g,L){return this.i.add(String(l),m,!0,g,L)};function K(l,m,g,L){if(m=l.i.g[String(m)],!m)return!0;m=m.concat();for(var Se=!0,Ce=0;Ce<m.length;++Ce){var Ne=m[Ce];if(Ne&&!Ne.da&&Ne.capture==g){var Lt=Ne.listener,ur=Ne.ha||Ne.src;Ne.fa&&oe(l.i,Ne),Se=Lt.call(ur,L)!==!1&&Se}}return Se&&!L.defaultPrevented}function Pe(l,m,g){if(typeof l=="function")g&&(l=b(l,g));else if(l&&typeof l.handleEvent=="function")l=b(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(m)?-1:c.setTimeout(l,m||0)}function Te(l){l.g=Pe(()=>{l.g=null,l.i&&(l.i=!1,Te(l))},l.l);const m=l.h;l.h=null,l.m.apply(null,m)}class xe extends fe{constructor(m,g){super(),this.m=m,this.l=g,this.h=null,this.i=!1,this.g=null}j(m){this.h=arguments,this.g?this.i=!0:Te(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $e(l){fe.call(this),this.h=l,this.g={}}R($e,fe);var Oe=[];function Qe(l){ae(l.g,function(m,g){this.g.hasOwnProperty(g)&&J(m)},l),l.g={}}$e.prototype.N=function(){$e.aa.N.call(this),Qe(this)},$e.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ue=c.JSON.stringify,Ie=c.JSON.parse,Me=class{stringify(l){return c.JSON.stringify(l,void 0)}parse(l){return c.JSON.parse(l,void 0)}};function qe(){}qe.prototype.h=null;function He(l){return l.h||(l.h=l.i())}function Ge(){}var Ae={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ot(){z.call(this,"d")}R(ot,z);function et(){z.call(this,"c")}R(et,z);var pt={},yt=null;function xt(){return yt=yt||new ie}pt.La="serverreachability";function Yt(l){z.call(this,pt.La,l)}R(Yt,z);function kt(l){const m=xt();ve(m,new Yt(m))}pt.STAT_EVENT="statevent";function Qt(l,m){z.call(this,pt.STAT_EVENT,l),this.stat=m}R(Qt,z);function st(l){const m=xt();ve(m,new Qt(m,l))}pt.Ma="timingevent";function ar(l,m){z.call(this,pt.Ma,l),this.size=m}R(ar,z);function Ht(l,m){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){l()},m)}function Rt(){this.g=!0}Rt.prototype.xa=function(){this.g=!1};function Fe(l,m,g,L,Se,Ce){l.info(function(){if(l.g)if(Ce)for(var Ne="",Lt=Ce.split("&"),ur=0;ur<Lt.length;ur++){var St=Lt[ur].split("=");if(1<St.length){var pr=St[0];St=St[1];var vr=pr.split("_");Ne=2<=vr.length&&vr[1]=="type"?Ne+(pr+"="+St+"&"):Ne+(pr+"=redacted&")}}else Ne=null;else Ne=Ce;return"XMLHTTP REQ ("+L+") [attempt "+Se+"]: "+m+`
`+g+`
`+Ne})}function Le(l,m,g,L,Se,Ce,Ne){l.info(function(){return"XMLHTTP RESP ("+L+") [ attempt "+Se+"]: "+m+`
`+g+`
`+Ce+" "+Ne})}function Ye(l,m,g,L){l.info(function(){return"XMLHTTP TEXT ("+m+"): "+Tt(l,g)+(L?" "+L:"")})}function lt(l,m){l.info(function(){return"TIMEOUT: "+m})}Rt.prototype.info=function(){};function Tt(l,m){if(!l.g)return m;if(!m)return null;try{var g=JSON.parse(m);if(g){for(l=0;l<g.length;l++)if(Array.isArray(g[l])){var L=g[l];if(!(2>L.length)){var Se=L[1];if(Array.isArray(Se)&&!(1>Se.length)){var Ce=Se[0];if(Ce!="noop"&&Ce!="stop"&&Ce!="close")for(var Ne=1;Ne<Se.length;Ne++)Se[Ne]=""}}}}return Ue(g)}catch{return m}}var Xe={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},bt={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},dt;function gt(){}R(gt,qe),gt.prototype.g=function(){return new XMLHttpRequest},gt.prototype.i=function(){return{}},dt=new gt;function Ct(l,m,g,L){this.j=l,this.i=m,this.l=g,this.R=L||1,this.U=new $e(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new rr}function rr(){this.i=null,this.g="",this.h=!1}var jt={},Ft={};function Wt(l,m,g){l.L=1,l.v=$i(Ar(m)),l.m=g,l.P=!0,_t(l,null)}function _t(l,m){l.F=Date.now(),Ut(l),l.A=Ar(l.v);var g=l.A,L=l.R;Array.isArray(L)||(L=[String(L)]),pu(g.i,"t",L),l.C=0,g=l.j.J,l.h=new rr,l.g=Lu(l.j,g?m:null,!l.m),0<l.O&&(l.M=new xe(b(l.Y,l,l.g),l.O)),m=l.U,g=l.g,L=l.ca;var Se="readystatechange";Array.isArray(Se)||(Se&&(Oe[0]=Se.toString()),Se=Oe);for(var Ce=0;Ce<Se.length;Ce++){var Ne=le(g,Se[Ce],L||m.handleEvent,!1,m.h||m);if(!Ne)break;m.g[Ne.key]=Ne}m=l.H?_(l.H):{},l.m?(l.u||(l.u="POST"),m["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,m)):(l.u="GET",l.g.ea(l.A,l.u,null,m)),kt(),Fe(l.i,l.u,l.A,l.l,l.R,l.m)}Ct.prototype.ca=function(l){l=l.target;const m=this.M;m&&mn(l)==3?m.j():this.Y(l)},Ct.prototype.Y=function(l){try{if(l==this.g)e:{const vr=mn(this.g);var m=this.g.Ba();const Di=this.g.Z();if(!(3>vr)&&(vr!=3||this.g&&(this.h.h||this.g.oa()||Cu(this.g)))){this.J||vr!=4||m==7||(m==8||0>=Di?kt(3):kt(2)),Nr(this);var g=this.g.Z();this.X=g;t:if(Jt(this)){var L=Cu(this.g);l="";var Se=L.length,Ce=mn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Lr(this),dn(this);var Ne="";break t}this.h.i=new c.TextDecoder}for(m=0;m<Se;m++)this.h.h=!0,l+=this.h.i.decode(L[m],{stream:!(Ce&&m==Se-1)});L.length=0,this.h.g+=l,this.C=0,Ne=this.h.g}else Ne=this.g.oa();if(this.o=g==200,Le(this.i,this.u,this.A,this.l,this.R,vr,g),this.o){if(this.T&&!this.K){t:{if(this.g){var Lt,ur=this.g;if((Lt=ur.g?ur.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(Lt)){var St=Lt;break t}}St=null}if(g=St)Ye(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ii(this,g);else{this.o=!1,this.s=3,st(12),Lr(this),dn(this);break e}}if(this.P){g=!0;let qr;for(;!this.J&&this.C<Ne.length;)if(qr=jr(this,Ne),qr==Ft){vr==4&&(this.s=4,st(14),g=!1),Ye(this.i,this.l,null,"[Incomplete Response]");break}else if(qr==jt){this.s=4,st(15),Ye(this.i,this.l,Ne,"[Invalid Chunk]"),g=!1;break}else Ye(this.i,this.l,qr,null),ii(this,qr);if(Jt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),vr!=4||Ne.length!=0||this.h.h||(this.s=1,st(16),g=!1),this.o=this.o&&g,!g)Ye(this.i,this.l,Ne,"[Invalid Chunked Response]"),Lr(this),dn(this);else if(0<Ne.length&&!this.W){this.W=!0;var pr=this.j;pr.g==this&&pr.ba&&!pr.M&&(pr.j.info("Great, no buffering proxy detected. Bytes received: "+Ne.length),Xa(pr),pr.M=!0,st(11))}}else Ye(this.i,this.l,Ne,null),ii(this,Ne);vr==4&&Lr(this),this.o&&!this.J&&(vr==4?ku(this.j,this):(this.o=!1,Ut(this)))}else ag(this.g),g==400&&0<Ne.indexOf("Unknown SID")?(this.s=3,st(12)):(this.s=0,st(13)),Lr(this),dn(this)}}}catch{}finally{}};function Jt(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function jr(l,m){var g=l.C,L=m.indexOf(`
`,g);return L==-1?Ft:(g=Number(m.substring(g,L)),isNaN(g)?jt:(L+=1,L+g>m.length?Ft:(m=m.slice(L,L+g),l.C=L+g,m)))}Ct.prototype.cancel=function(){this.J=!0,Lr(this)};function Ut(l){l.S=Date.now()+l.I,cr(l,l.I)}function cr(l,m){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Ht(b(l.ba,l),m)}function Nr(l){l.B&&(c.clearTimeout(l.B),l.B=null)}Ct.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(lt(this.i,this.A),this.L!=2&&(kt(),st(17)),Lr(this),this.s=2,dn(this)):cr(this,this.S-l)};function dn(l){l.j.G==0||l.J||ku(l.j,l)}function Lr(l){Nr(l);var m=l.M;m&&typeof m.ma=="function"&&m.ma(),l.M=null,Qe(l.U),l.g&&(m=l.g,l.g=null,m.abort(),m.ma())}function ii(l,m){try{var g=l.j;if(g.G!=0&&(g.g==l||Ti(g.h,l))){if(!l.K&&Ti(g.h,l)&&g.G==3){try{var L=g.Da.g.parse(m)}catch{L=null}if(Array.isArray(L)&&L.length==3){var Se=L;if(Se[0]==0){e:if(!g.u){if(g.g)if(g.g.F+3e3<l.F)Ss(g),bs(g);else break e;Ja(g),st(18)}}else g.za=Se[1],0<g.za-g.T&&37500>Se[2]&&g.F&&g.v==0&&!g.C&&(g.C=Ht(b(g.Za,g),6e3));if(1>=ho(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else oi(g,11)}else if((l.K||g.g==l)&&Ss(g),!W(m))for(Se=g.Da.g.parse(m),m=0;m<Se.length;m++){let St=Se[m];if(g.T=St[0],St=St[1],g.G==2)if(St[0]=="c"){g.K=St[1],g.ia=St[2];const pr=St[3];pr!=null&&(g.la=pr,g.j.info("VER="+g.la));const vr=St[4];vr!=null&&(g.Aa=vr,g.j.info("SVER="+g.Aa));const Di=St[5];Di!=null&&typeof Di=="number"&&0<Di&&(L=1.5*Di,g.L=L,g.j.info("backChannelRequestTimeoutMs_="+L)),L=g;const qr=l.g;if(qr){const ws=qr.g?qr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ws){var Ce=L.h;Ce.g||ws.indexOf("spdy")==-1&&ws.indexOf("quic")==-1&&ws.indexOf("h2")==-1||(Ce.j=Ce.l,Ce.g=new Set,Ce.h&&(xn(Ce,Ce.h),Ce.h=null))}if(L.D){const Za=qr.g?qr.g.getResponseHeader("X-HTTP-Session-Id"):null;Za&&(L.ya=Za,Nt(L.I,L.D,Za))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-l.F,g.j.info("Handshake RTT: "+g.R+"ms")),L=g;var Ne=l;if(L.qa=Nu(L,L.J?L.ia:null,L.W),Ne.K){fs(L.h,Ne);var Lt=Ne,ur=L.L;ur&&(Lt.I=ur),Lt.B&&(Nr(Lt),Ut(Lt)),L.g=Ne}else Tu(L);0<g.i.length&&_s(g)}else St[0]!="stop"&&St[0]!="close"||oi(g,7);else g.G==3&&(St[0]=="stop"||St[0]=="close"?St[0]=="stop"?oi(g,7):Qa(g):St[0]!="noop"&&g.l&&g.l.ta(St),g.v=0)}}kt(4)}catch{}}var xi=class{constructor(l,m){this.g=l,this.map=m}};function ms(l){this.l=l||10,c.PerformanceNavigationTiming?(l=c.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function uo(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function ho(l){return l.h?1:l.g?l.g.size:0}function Ti(l,m){return l.h?l.h==m:l.g?l.g.has(m):!1}function xn(l,m){l.g?l.g.add(m):l.h=m}function fs(l,m){l.h&&l.h==m?l.h=null:l.g&&l.g.has(m)&&l.g.delete(m)}ms.prototype.cancel=function(){if(this.i=mo(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function mo(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let m=l.i;for(const g of l.g.values())m=m.concat(g.D);return m}return E(l.i)}function at(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(u(l)){for(var m=[],g=l.length,L=0;L<g;L++)m.push(l[L]);return m}m=[],g=0;for(L in l)m[g++]=l[L];return m}function Dt(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(u(l)||typeof l=="string"){var m=[];l=l.length;for(var g=0;g<l;g++)m.push(g);return m}m=[],g=0;for(const L in l)m[g++]=L;return m}}}function gr(l,m){if(l.forEach&&typeof l.forEach=="function")l.forEach(m,void 0);else if(u(l)||typeof l=="string")Array.prototype.forEach.call(l,m,void 0);else for(var g=Dt(l),L=at(l),Se=L.length,Ce=0;Ce<Se;Ce++)m.call(void 0,L[Ce],g&&g[Ce],l)}var zr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function hn(l,m){if(l){l=l.split("&");for(var g=0;g<l.length;g++){var L=l[g].indexOf("="),Se=null;if(0<=L){var Ce=l[g].substring(0,L);Se=l[g].substring(L+1)}else Ce=l[g];m(Ce,Se?decodeURIComponent(Se.replace(/\+/g," ")):"")}}}function Vt(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Vt){this.h=l.h,Yr(this,l.j),this.o=l.o,this.g=l.g,Kr(this,l.s),this.l=l.l;var m=l.i,g=new go;g.i=m.i,m.g&&(g.g=new Map(m.g),g.h=m.h),ys(this,g),this.m=l.m}else l&&(m=String(l).match(zr))?(this.h=!1,Yr(this,m[1]||"",!0),this.o=fo(m[2]||""),this.g=fo(m[3]||"",!0),Kr(this,m[4]),this.l=fo(m[5]||"",!0),ys(this,m[6]||"",!0),this.m=fo(m[7]||"")):(this.h=!1,this.i=new go(null,this.h))}Vt.prototype.toString=function(){var l=[],m=this.j;m&&l.push(yo(m,fu,!0),":");var g=this.g;return(g||m=="file")&&(l.push("//"),(m=this.o)&&l.push(yo(m,fu,!0),"@"),l.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&l.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&l.push("/"),l.push(yo(g,g.charAt(0)=="/"?Jy:Qy,!0))),(g=this.i.toString())&&l.push("?",g),(g=this.m)&&l.push("#",yo(g,Zy)),l.join("")};function Ar(l){return new Vt(l)}function Yr(l,m,g){l.j=g?fo(m,!0):m,l.j&&(l.j=l.j.replace(/:$/,""))}function Kr(l,m){if(m){if(m=Number(m),isNaN(m)||0>m)throw Error("Bad port number "+m);l.s=m}else l.s=null}function ys(l,m,g){m instanceof go?(l.i=m,eg(l.i,l.h)):(g||(m=yo(m,Xy)),l.i=new go(m,l.h))}function Nt(l,m,g){l.i.set(m,g)}function $i(l){return Nt(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function fo(l,m){return l?m?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function yo(l,m,g){return typeof l=="string"?(l=encodeURI(l).replace(m,Ky),g&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function Ky(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var fu=/[#\/\?@]/g,Qy=/[#\?:]/g,Jy=/[#\?]/g,Xy=/[#\?@]/g,Zy=/#/g;function go(l,m){this.h=this.g=null,this.i=l||null,this.j=!!m}function Tn(l){l.g||(l.g=new Map,l.h=0,l.i&&hn(l.i,function(m,g){l.add(decodeURIComponent(m.replace(/\+/g," ")),g)}))}t=go.prototype,t.add=function(l,m){Tn(this),this.i=null,l=ki(this,l);var g=this.g.get(l);return g||this.g.set(l,g=[]),g.push(m),this.h+=1,this};function yu(l,m){Tn(l),m=ki(l,m),l.g.has(m)&&(l.i=null,l.h-=l.g.get(m).length,l.g.delete(m))}function gu(l,m){return Tn(l),m=ki(l,m),l.g.has(m)}t.forEach=function(l,m){Tn(this),this.g.forEach(function(g,L){g.forEach(function(Se){l.call(m,Se,L,this)},this)},this)},t.na=function(){Tn(this);const l=Array.from(this.g.values()),m=Array.from(this.g.keys()),g=[];for(let L=0;L<m.length;L++){const Se=l[L];for(let Ce=0;Ce<Se.length;Ce++)g.push(m[L])}return g},t.V=function(l){Tn(this);let m=[];if(typeof l=="string")gu(this,l)&&(m=m.concat(this.g.get(ki(this,l))));else{l=Array.from(this.g.values());for(let g=0;g<l.length;g++)m=m.concat(l[g])}return m},t.set=function(l,m){return Tn(this),this.i=null,l=ki(this,l),gu(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[m]),this.h+=1,this},t.get=function(l,m){return l?(l=this.V(l),0<l.length?String(l[0]):m):m};function pu(l,m,g){yu(l,m),0<g.length&&(l.i=null,l.g.set(ki(l,m),E(g)),l.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],m=Array.from(this.g.keys());for(var g=0;g<m.length;g++){var L=m[g];const Ce=encodeURIComponent(String(L)),Ne=this.V(L);for(L=0;L<Ne.length;L++){var Se=Ce;Ne[L]!==""&&(Se+="="+encodeURIComponent(String(Ne[L]))),l.push(Se)}}return this.i=l.join("&")};function ki(l,m){return m=String(m),l.j&&(m=m.toLowerCase()),m}function eg(l,m){m&&!l.j&&(Tn(l),l.i=null,l.g.forEach(function(g,L){var Se=L.toLowerCase();L!=Se&&(yu(this,L),pu(this,Se,g))},l)),l.j=m}function tg(l,m){const g=new Rt;if(c.Image){const L=new Image;L.onload=C($n,g,"TestLoadImage: loaded",!0,m,L),L.onerror=C($n,g,"TestLoadImage: error",!1,m,L),L.onabort=C($n,g,"TestLoadImage: abort",!1,m,L),L.ontimeout=C($n,g,"TestLoadImage: timeout",!1,m,L),c.setTimeout(function(){L.ontimeout&&L.ontimeout()},1e4),L.src=l}else m(!1)}function rg(l,m){const g=new Rt,L=new AbortController,Se=setTimeout(()=>{L.abort(),$n(g,"TestPingServer: timeout",!1,m)},1e4);fetch(l,{signal:L.signal}).then(Ce=>{clearTimeout(Se),Ce.ok?$n(g,"TestPingServer: ok",!0,m):$n(g,"TestPingServer: server error",!1,m)}).catch(()=>{clearTimeout(Se),$n(g,"TestPingServer: error",!1,m)})}function $n(l,m,g,L,Se){try{Se&&(Se.onload=null,Se.onerror=null,Se.onabort=null,Se.ontimeout=null),L(g)}catch{}}function ng(){this.g=new Me}function ig(l,m,g){const L=g||"";try{gr(l,function(Se,Ce){let Ne=Se;h(Se)&&(Ne=Ue(Se)),m.push(L+Ce+"="+encodeURIComponent(Ne))})}catch(Se){throw m.push(L+"type="+encodeURIComponent("_badmap")),Se}}function gs(l){this.l=l.Ub||null,this.j=l.eb||!1}R(gs,qe),gs.prototype.g=function(){return new ps(this.l,this.j)},gs.prototype.i=function(l){return function(){return l}}({});function ps(l,m){ie.call(this),this.D=l,this.o=m,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}R(ps,ie),t=ps.prototype,t.open=function(l,m){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=m,this.readyState=1,vo(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const m={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(m.body=l),(this.D||c).fetch(new Request(this.A,m)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,po(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,vo(this)),this.g&&(this.readyState=3,vo(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;vu(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function vu(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var m=l.value?l.value:new Uint8Array(0);(m=this.v.decode(m,{stream:!l.done}))&&(this.response=this.responseText+=m)}l.done?po(this):vo(this),this.readyState==3&&vu(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,po(this))},t.Qa=function(l){this.g&&(this.response=l,po(this))},t.ga=function(){this.g&&po(this)};function po(l){l.readyState=4,l.l=null,l.j=null,l.v=null,vo(l)}t.setRequestHeader=function(l,m){this.u.append(l,m)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],m=this.h.entries();for(var g=m.next();!g.done;)g=g.value,l.push(g[0]+": "+g[1]),g=m.next();return l.join(`\r
`)};function vo(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(ps.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function bu(l){let m="";return ae(l,function(g,L){m+=L,m+=":",m+=g,m+=`\r
`}),m}function Ka(l,m,g){e:{for(L in g){var L=!1;break e}L=!0}L||(g=bu(g),typeof l=="string"?g!=null&&encodeURIComponent(String(g)):Nt(l,m,g))}function Gt(l){ie.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}R(Gt,ie);var og=/^https?$/i,sg=["POST","PUT"];t=Gt.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,m,g,L){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);m=m?m.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():dt.g(),this.v=this.o?He(this.o):He(dt),this.g.onreadystatechange=b(this.Ea,this);try{this.B=!0,this.g.open(m,String(l),!0),this.B=!1}catch(Ce){_u(this,Ce);return}if(l=g||"",g=new Map(this.headers),L)if(Object.getPrototypeOf(L)===Object.prototype)for(var Se in L)g.set(Se,L[Se]);else if(typeof L.keys=="function"&&typeof L.get=="function")for(const Ce of L.keys())g.set(Ce,L.get(Ce));else throw Error("Unknown input type for opt_headers: "+String(L));L=Array.from(g.keys()).find(Ce=>Ce.toLowerCase()=="content-type"),Se=c.FormData&&l instanceof c.FormData,!(0<=Array.prototype.indexOf.call(sg,m,void 0))||L||Se||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ce,Ne]of g)this.g.setRequestHeader(Ce,Ne);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{wu(this),this.u=!0,this.g.send(l),this.u=!1}catch(Ce){_u(this,Ce)}};function _u(l,m){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=m,l.m=5,Su(l),vs(l)}function Su(l){l.A||(l.A=!0,ve(l,"complete"),ve(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,ve(this,"complete"),ve(this,"abort"),vs(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),vs(this,!0)),Gt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Pu(this):this.bb())},t.bb=function(){Pu(this)};function Pu(l){if(l.h&&typeof a<"u"&&(!l.v[1]||mn(l)!=4||l.Z()!=2)){if(l.u&&mn(l)==4)Pe(l.Ea,0,l);else if(ve(l,"readystatechange"),mn(l)==4){l.h=!1;try{const Ne=l.Z();e:switch(Ne){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var m=!0;break e;default:m=!1}var g;if(!(g=m)){var L;if(L=Ne===0){var Se=String(l.D).match(zr)[1]||null;!Se&&c.self&&c.self.location&&(Se=c.self.location.protocol.slice(0,-1)),L=!og.test(Se?Se.toLowerCase():"")}g=L}if(g)ve(l,"complete"),ve(l,"success");else{l.m=6;try{var Ce=2<mn(l)?l.g.statusText:""}catch{Ce=""}l.l=Ce+" ["+l.Z()+"]",Su(l)}}finally{vs(l)}}}}function vs(l,m){if(l.g){wu(l);const g=l.g,L=l.v[0]?()=>{}:null;l.g=null,l.v=null,m||ve(l,"ready");try{g.onreadystatechange=L}catch{}}}function wu(l){l.I&&(c.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function mn(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<mn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var m=this.g.responseText;return l&&m.indexOf(l)==0&&(m=m.substring(l.length)),Ie(m)}};function Cu(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function ag(l){const m={};l=(l.g&&2<=mn(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let L=0;L<l.length;L++){if(W(l[L]))continue;var g=w(l[L]);const Se=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const Ce=m[Se]||[];m[Se]=Ce,Ce.push(g)}I(m,function(L){return L.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function bo(l,m,g){return g&&g.internalChannelParams&&g.internalChannelParams[l]||m}function Au(l){this.Aa=0,this.i=[],this.j=new Rt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=bo("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=bo("baseRetryDelayMs",5e3,l),this.cb=bo("retryDelaySeedMs",1e4,l),this.Wa=bo("forwardChannelMaxRetries",2,l),this.wa=bo("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new ms(l&&l.concurrentRequestLimit),this.Da=new ng,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Au.prototype,t.la=8,t.G=1,t.connect=function(l,m,g,L){st(0),this.W=l,this.H=m||{},g&&L!==void 0&&(this.H.OSID=g,this.H.OAID=L),this.F=this.X,this.I=Nu(this,null,this.W),_s(this)};function Qa(l){if(Iu(l),l.G==3){var m=l.U++,g=Ar(l.I);if(Nt(g,"SID",l.K),Nt(g,"RID",m),Nt(g,"TYPE","terminate"),_o(l,g),m=new Ct(l,l.j,m),m.L=2,m.v=$i(Ar(g)),g=!1,c.navigator&&c.navigator.sendBeacon)try{g=c.navigator.sendBeacon(m.v.toString(),"")}catch{}!g&&c.Image&&(new Image().src=m.v,g=!0),g||(m.g=Lu(m.j,null),m.g.ea(m.v)),m.F=Date.now(),Ut(m)}Du(l)}function bs(l){l.g&&(Xa(l),l.g.cancel(),l.g=null)}function Iu(l){bs(l),l.u&&(c.clearTimeout(l.u),l.u=null),Ss(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&c.clearTimeout(l.s),l.s=null)}function _s(l){if(!uo(l.h)&&!l.s){l.s=!0;var m=l.Ga;Z||N(),U||(Z(),U=!0),F.add(m,l),l.B=0}}function lg(l,m){return ho(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=m.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Ht(b(l.Ga,l,m),Ru(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const Se=new Ct(this,this.j,l);let Ce=this.o;if(this.S&&(Ce?(Ce=_(Ce),P(Ce,this.S)):Ce=this.S),this.m!==null||this.O||(Se.H=Ce,Ce=null),this.P)e:{for(var m=0,g=0;g<this.i.length;g++){t:{var L=this.i[g];if("__data__"in L.map&&(L=L.map.__data__,typeof L=="string")){L=L.length;break t}L=void 0}if(L===void 0)break;if(m+=L,4096<m){m=g;break e}if(m===4096||g===this.i.length-1){m=g+1;break e}}m=1e3}else m=1e3;m=xu(this,Se,m),g=Ar(this.I),Nt(g,"RID",l),Nt(g,"CVER",22),this.D&&Nt(g,"X-HTTP-Session-Id",this.D),_o(this,g),Ce&&(this.O?m="headers="+encodeURIComponent(String(bu(Ce)))+"&"+m:this.m&&Ka(g,this.m,Ce)),xn(this.h,Se),this.Ua&&Nt(g,"TYPE","init"),this.P?(Nt(g,"$req",m),Nt(g,"SID","null"),Se.T=!0,Wt(Se,g,null)):Wt(Se,g,m),this.G=2}}else this.G==3&&(l?Eu(this,l):this.i.length==0||uo(this.h)||Eu(this))};function Eu(l,m){var g;m?g=m.l:g=l.U++;const L=Ar(l.I);Nt(L,"SID",l.K),Nt(L,"RID",g),Nt(L,"AID",l.T),_o(l,L),l.m&&l.o&&Ka(L,l.m,l.o),g=new Ct(l,l.j,g,l.B+1),l.m===null&&(g.H=l.o),m&&(l.i=m.D.concat(l.i)),m=xu(l,g,1e3),g.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),xn(l.h,g),Wt(g,L,m)}function _o(l,m){l.H&&ae(l.H,function(g,L){Nt(m,L,g)}),l.l&&gr({},function(g,L){Nt(m,L,g)})}function xu(l,m,g){g=Math.min(l.i.length,g);var L=l.l?b(l.l.Na,l.l,l):null;e:{var Se=l.i;let Ce=-1;for(;;){const Ne=["count="+g];Ce==-1?0<g?(Ce=Se[0].g,Ne.push("ofs="+Ce)):Ce=0:Ne.push("ofs="+Ce);let Lt=!0;for(let ur=0;ur<g;ur++){let St=Se[ur].g;const pr=Se[ur].map;if(St-=Ce,0>St)Ce=Math.max(0,Se[ur].g-100),Lt=!1;else try{ig(pr,Ne,"req"+St+"_")}catch{L&&L(pr)}}if(Lt){L=Ne.join("&");break e}}}return l=l.i.splice(0,g),m.D=l,L}function Tu(l){if(!l.g&&!l.u){l.Y=1;var m=l.Fa;Z||N(),U||(Z(),U=!0),F.add(m,l),l.v=0}}function Ja(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Ht(b(l.Fa,l),Ru(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,$u(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Ht(b(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,st(10),bs(this),$u(this))};function Xa(l){l.A!=null&&(c.clearTimeout(l.A),l.A=null)}function $u(l){l.g=new Ct(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var m=Ar(l.qa);Nt(m,"RID","rpc"),Nt(m,"SID",l.K),Nt(m,"AID",l.T),Nt(m,"CI",l.F?"0":"1"),!l.F&&l.ja&&Nt(m,"TO",l.ja),Nt(m,"TYPE","xmlhttp"),_o(l,m),l.m&&l.o&&Ka(m,l.m,l.o),l.L&&(l.g.I=l.L);var g=l.g;l=l.ia,g.L=1,g.v=$i(Ar(m)),g.m=null,g.P=!0,_t(g,l)}t.Za=function(){this.C!=null&&(this.C=null,bs(this),Ja(this),st(19))};function Ss(l){l.C!=null&&(c.clearTimeout(l.C),l.C=null)}function ku(l,m){var g=null;if(l.g==m){Ss(l),Xa(l),l.g=null;var L=2}else if(Ti(l.h,m))g=m.D,fs(l.h,m),L=1;else return;if(l.G!=0){if(m.o)if(L==1){g=m.m?m.m.length:0,m=Date.now()-m.F;var Se=l.B;L=xt(),ve(L,new ar(L,g)),_s(l)}else Tu(l);else if(Se=m.s,Se==3||Se==0&&0<m.X||!(L==1&&lg(l,m)||L==2&&Ja(l)))switch(g&&0<g.length&&(m=l.h,m.i=m.i.concat(g)),Se){case 1:oi(l,5);break;case 4:oi(l,10);break;case 3:oi(l,6);break;default:oi(l,2)}}}function Ru(l,m){let g=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(g*=2),g*m}function oi(l,m){if(l.j.info("Error code "+m),m==2){var g=b(l.fb,l),L=l.Xa;const Se=!L;L=new Vt(L||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Yr(L,"https"),$i(L),Se?tg(L.toString(),g):rg(L.toString(),g)}else st(2);l.G=0,l.l&&l.l.sa(m),Du(l),Iu(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),st(2)):(this.j.info("Failed to ping google.com"),st(1))};function Du(l){if(l.G=0,l.ka=[],l.l){const m=mo(l.h);(m.length!=0||l.i.length!=0)&&(x(l.ka,m),x(l.ka,l.i),l.h.i.length=0,E(l.i),l.i.length=0),l.l.ra()}}function Nu(l,m,g){var L=g instanceof Vt?Ar(g):new Vt(g);if(L.g!="")m&&(L.g=m+"."+L.g),Kr(L,L.s);else{var Se=c.location;L=Se.protocol,m=m?m+"."+Se.hostname:Se.hostname,Se=+Se.port;var Ce=new Vt(null);L&&Yr(Ce,L),m&&(Ce.g=m),Se&&Kr(Ce,Se),g&&(Ce.l=g),L=Ce}return g=l.D,m=l.ya,g&&m&&Nt(L,g,m),Nt(L,"VER",l.la),_o(l,L),L}function Lu(l,m,g){if(m&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return m=l.Ca&&!l.pa?new Gt(new gs({eb:g})):new Gt(l.pa),m.Ha(l.J),m}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Mu(){}t=Mu.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Ps(){}Ps.prototype.g=function(l,m){return new $r(l,m)};function $r(l,m){ie.call(this),this.g=new Au(m),this.l=l,this.h=m&&m.messageUrlParams||null,l=m&&m.messageHeaders||null,m&&m.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=m&&m.initMessageHeaders||null,m&&m.messageContentType&&(l?l["X-WebChannel-Content-Type"]=m.messageContentType:l={"X-WebChannel-Content-Type":m.messageContentType}),m&&m.va&&(l?l["X-WebChannel-Client-Profile"]=m.va:l={"X-WebChannel-Client-Profile":m.va}),this.g.S=l,(l=m&&m.Sb)&&!W(l)&&(this.g.m=l),this.v=m&&m.supportsCrossDomainXhr||!1,this.u=m&&m.sendRawJson||!1,(m=m&&m.httpSessionIdParam)&&!W(m)&&(this.g.D=m,l=this.h,l!==null&&m in l&&(l=this.h,m in l&&delete l[m])),this.j=new Ri(this)}R($r,ie),$r.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},$r.prototype.close=function(){Qa(this.g)},$r.prototype.o=function(l){var m=this.g;if(typeof l=="string"){var g={};g.__data__=l,l=g}else this.u&&(g={},g.__data__=Ue(l),l=g);m.i.push(new xi(m.Ya++,l)),m.G==3&&_s(m)},$r.prototype.N=function(){this.g.l=null,delete this.j,Qa(this.g),delete this.g,$r.aa.N.call(this)};function Ou(l){ot.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var m=l.__sm__;if(m){e:{for(const g in m){l=g;break e}l=void 0}(this.i=l)&&(l=this.i,m=m!==null&&l in m?m[l]:void 0),this.data=m}else this.data=l}R(Ou,ot);function Vu(){et.call(this),this.status=1}R(Vu,et);function Ri(l){this.g=l}R(Ri,Mu),Ri.prototype.ua=function(){ve(this.g,"a")},Ri.prototype.ta=function(l){ve(this.g,new Ou(l))},Ri.prototype.sa=function(l){ve(this.g,new Vu)},Ri.prototype.ra=function(){ve(this.g,"b")},Ps.prototype.createWebChannel=Ps.prototype.g,$r.prototype.send=$r.prototype.o,$r.prototype.open=$r.prototype.m,$r.prototype.close=$r.prototype.close,_f=function(){return new Ps},bf=function(){return xt()},vf=pt,Yl={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Xe.NO_ERROR=0,Xe.TIMEOUT=8,Xe.HTTP_ERROR=6,Gs=Xe,bt.COMPLETE="complete",pf=bt,Ge.EventType=Ae,Ae.OPEN="a",Ae.CLOSE="b",Ae.ERROR="c",Ae.MESSAGE="d",ie.prototype.listen=ie.prototype.K,Eo=Ge,Gt.prototype.listenOnce=Gt.prototype.L,Gt.prototype.getLastError=Gt.prototype.Ka,Gt.prototype.getLastErrorCode=Gt.prototype.Ba,Gt.prototype.getStatus=Gt.prototype.Z,Gt.prototype.getResponseJson=Gt.prototype.Oa,Gt.prototype.getResponseText=Gt.prototype.oa,Gt.prototype.send=Gt.prototype.ea,Gt.prototype.setWithCredentials=Gt.prototype.Ha,gf=Gt}).apply(typeof Is<"u"?Is:typeof self<"u"?self:typeof window<"u"?window:{});const wd="@firebase/firestore",Cd="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Sr.UNAUTHENTICATED=new Sr(null),Sr.GOOGLE_CREDENTIALS=new Sr("google-credentials-uid"),Sr.FIRST_PARTY=new Sr("first-party-uid"),Sr.MOCK_USER=new Sr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let so="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Si=new _c("@firebase/firestore");function Bi(){return Si.logLevel}function je(t,...e){if(Si.logLevel<=ht.DEBUG){const r=e.map(Dc);Si.debug(`Firestore (${so}): ${t}`,...r)}}function An(t,...e){if(Si.logLevel<=ht.ERROR){const r=e.map(Dc);Si.error(`Firestore (${so}): ${t}`,...r)}}function Qi(t,...e){if(Si.logLevel<=ht.WARN){const r=e.map(Dc);Si.warn(`Firestore (${so}): ${t}`,...r)}}function Dc(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ze(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,Sf(t,n,r)}function Sf(t,e,r){let n=`FIRESTORE (${so}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw An(n),new Error(n)}function Et(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||Sf(e,i,n)}function nt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ke={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class We extends En{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pf{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class f_{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Sr.UNAUTHENTICATED))}shutdown(){}}class y_{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class g_{constructor(e){this.t=e,this.currentUser=Sr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Et(this.o===void 0,42304);let n=this.i;const i=u=>this.i!==n?(n=this.i,r(u)):Promise.resolve();let o=new Wn;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Wn,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const u=o;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},c=u=>{je("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(je("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Wn)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(je("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Et(typeof n.accessToken=="string",31837,{l:n}),new Pf(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Et(e===null||typeof e=="string",2055,{h:e}),new Sr(e)}}class p_{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Sr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class v_{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new p_(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(Sr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Ad{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class b_{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Or(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Et(this.o===void 0,3512);const n=o=>{o.error!=null&&je("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const a=o.token!==this.m;return this.m=o.token,je("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>n(o))};const i=o=>{je("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):je("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Ad(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Et(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new Ad(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nc{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=__(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<r&&(n+=e.charAt(i[o]%62))}return n}}function mt(t,e){return t<e?-1:t>e?1:0}function Kl(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const i=t.charAt(n),o=e.charAt(n);if(i!==o)return dl(i)===dl(o)?mt(i,o):dl(i)?1:-1}return mt(t.length,e.length)}const S_=55296,P_=57343;function dl(t){const e=t.charCodeAt(0);return e>=S_&&e<=P_}function Ji(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Id="__name__";class Xr{constructor(e,r,n){r===void 0?r=0:r>e.length&&Ze(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&Ze(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Xr.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Xr?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const o=Xr.compareSegments(e.get(i),r.get(i));if(o!==0)return o}return mt(e.length,r.length)}static compareSegments(e,r){const n=Xr.isNumericId(e),i=Xr.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?Xr.extractNumericId(e).compare(Xr.extractNumericId(r)):Kl(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Hn.fromString(e.substring(4,e.length-2))}}class zt extends Xr{construct(e,r,n){return new zt(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new We(ke.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new zt(r)}static emptyPath(){return new zt([])}}const w_=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class hr extends Xr{construct(e,r,n){return new hr(e,r,n)}static isValidIdentifier(e){return w_.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),hr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Id}static keyField(){return new hr([Id])}static fromServerFormat(e){const r=[];let n="",i=0;const o=()=>{if(n.length===0)throw new We(ke.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new We(ke.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new We(ke.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,i+=2}else c==="`"?(a=!a,i++):c!=="."||a?(n+=c,i++):(o(),i++)}if(o(),a)throw new We(ke.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new hr(r)}static emptyPath(){return new hr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{constructor(e){this.path=e}static fromPath(e){return new Je(zt.fromString(e))}static fromName(e){return new Je(zt.fromString(e).popFirst(5))}static empty(){return new Je(zt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&zt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return zt.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Je(new zt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C_(t,e,r){if(!r)throw new We(ke.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function A_(t,e,r,n){if(e===!0&&n===!0)throw new We(ke.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function Ed(t){if(!Je.isDocumentKey(t))throw new We(ke.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function wf(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Lc(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ze(12329,{type:typeof t})}function Pi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new We(ke.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Lc(t);throw new We(ke.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tr(t,e){const r={typeString:t};return e&&(r.value=e),r}function ls(t,e){if(!wf(t))throw new We(ke.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const a=t[n];if(i&&typeof a!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(o!==void 0&&a!==o.value){r=`Expected '${n}' field to equal '${o.value}'`;break}}if(r)throw new We(ke.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xd=-62135596800,Td=1e6;class Bt{static now(){return Bt.fromMillis(Date.now())}static fromDate(e){return Bt.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*Td);return new Bt(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new We(ke.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new We(ke.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<xd)throw new We(ke.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new We(ke.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Td}_compareTo(e){return this.seconds===e.seconds?mt(this.nanoseconds,e.nanoseconds):mt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Bt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ls(e,Bt._jsonSchema))return new Bt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-xd;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Bt._jsonSchemaVersion="firestore/timestamp/1.0",Bt._jsonSchema={type:tr("string",Bt._jsonSchemaVersion),seconds:tr("number"),nanoseconds:tr("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{static fromTimestamp(e){return new rt(e)}static min(){return new rt(new Bt(0,0))}static max(){return new rt(new Bt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yo=-1;function I_(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=rt.fromTimestamp(n===1e9?new Bt(r+1,0):new Bt(r,n));return new Gn(i,Je.empty(),e)}function E_(t){return new Gn(t.readTime,t.key,Yo)}class Gn{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Gn(rt.min(),Je.empty(),Yo)}static max(){return new Gn(rt.max(),Je.empty(),Yo)}}function x_(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Je.comparator(t.documentKey,e.documentKey),r!==0?r:mt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T_="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class $_{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ao(t){if(t.code!==ke.FAILED_PRECONDITION||t.message!==T_)throw t;je("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ee{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Ze(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Ee((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(r,o).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Ee?r:Ee.resolve(r)}catch(r){return Ee.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Ee.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Ee.reject(r)}static resolve(e){return new Ee((r,n)=>{r(e)})}static reject(e){return new Ee((r,n)=>{n(e)})}static waitFor(e){return new Ee((r,n)=>{let i=0,o=0,a=!1;e.forEach(c=>{++i,c.next(()=>{++o,a&&o===i&&r()},u=>n(u))}),a=!0,o===i&&r()})}static or(e){let r=Ee.resolve(!1);for(const n of e)r=r.next(i=>i?Ee.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,o)=>{n.push(r.call(this,i,o))}),this.waitFor(n)}static mapArray(e,r){return new Ee((n,i)=>{const o=e.length,a=new Array(o);let c=0;for(let u=0;u<o;u++){const h=u;r(e[h]).next(f=>{a[h]=f,++c,c===o&&n(a)},f=>i(f))}})}static doWhile(e,r){return new Ee((n,i)=>{const o=()=>{e()===!0?r().next(()=>{o()},i):n()};o()})}}function k_(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function lo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Da.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mc=-1;function Na(t){return t==null}function fa(t){return t===0&&1/t==-1/0}function R_(t){return typeof t=="number"&&Number.isInteger(t)&&!fa(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cf="";function D_(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=$d(e)),e=N_(t.get(r),e);return $d(e)}function N_(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const o=t.charAt(i);switch(o){case"\0":r+="";break;case Cf:r+="";break;default:r+=o}}return r}function $d(t){return t+Cf+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kd(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function ri(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function Af(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(e,r){this.comparator=e,this.root=r||dr.EMPTY}insert(e,r){return new qt(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,dr.BLACK,null,null))}remove(e){return new qt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,dr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Es(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Es(this.root,e,this.comparator,!1)}getReverseIterator(){return new Es(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Es(this.root,e,this.comparator,!0)}}class Es{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=r?n(e.key,r):1,r&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class dr{constructor(e,r,n,i,o){this.key=e,this.value=r,this.color=n??dr.RED,this.left=i??dr.EMPTY,this.right=o??dr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,o){return new dr(e??this.key,r??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const o=n(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,r,n),null):o===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return dr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return dr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,dr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,dr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ze(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ze(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ze(27949);return e+(this.isRed()?0:1)}}dr.EMPTY=null,dr.RED=!0,dr.BLACK=!1;dr.EMPTY=new class{constructor(){this.size=0}get key(){throw Ze(57766)}get value(){throw Ze(16141)}get color(){throw Ze(16727)}get left(){throw Ze(29726)}get right(){throw Ze(36894)}copy(e,r,n,i,o){return this}insert(e,r,n){return new dr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e){this.comparator=e,this.data=new qt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new Rd(this.data.getIterator())}getIteratorFrom(e){return new Rd(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof sr)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new sr(this.comparator);return r.data=e,r}}class Rd{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e){this.fields=e,e.sort(hr.comparator)}static empty(){return new Dr([])}unionWith(e){let r=new sr(hr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Dr(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Ji(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new If("Invalid base64 string: "+o):o}}(e);return new fr(r)}static fromUint8Array(e){const r=function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o}(e);return new fr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return mt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}fr.EMPTY_BYTE_STRING=new fr("");const L_=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Yn(t){if(Et(!!t,39018),typeof t=="string"){let e=0;const r=L_.exec(t);if(Et(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Kt(t.seconds),nanos:Kt(t.nanos)}}function Kt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Kn(t){return typeof t=="string"?fr.fromBase64String(t):fr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ef="server_timestamp",xf="__type__",Tf="__previous_value__",$f="__local_write_time__";function Oc(t){return(t?.mapValue?.fields||{})[xf]?.stringValue===Ef}function La(t){const e=t.mapValue.fields[Tf];return Oc(e)?La(e):e}function Ko(t){const e=Yn(t.mapValue.fields[$f].timestampValue);return new Bt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M_{constructor(e,r,n,i,o,a,c,u,h,f){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=f}}const ya="(default)";class Qo{constructor(e,r){this.projectId=e,this.database=r||ya}static empty(){return new Qo("","")}get isDefaultDatabase(){return this.database===ya}isEqual(e){return e instanceof Qo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kf="__type__",O_="__max__",xs={mapValue:{}},Rf="__vector__",ga="value";function Qn(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Oc(t)?4:B_(t)?9007199254740991:V_(t)?10:11:Ze(28295,{value:t})}function ln(t,e){if(t===e)return!0;const r=Qn(t);if(r!==Qn(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ko(t).isEqual(Ko(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const a=Yn(i.timestampValue),c=Yn(o.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,o){return Kn(i.bytesValue).isEqual(Kn(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,o){return Kt(i.geoPointValue.latitude)===Kt(o.geoPointValue.latitude)&&Kt(i.geoPointValue.longitude)===Kt(o.geoPointValue.longitude)}(t,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return Kt(i.integerValue)===Kt(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const a=Kt(i.doubleValue),c=Kt(o.doubleValue);return a===c?fa(a)===fa(c):isNaN(a)&&isNaN(c)}return!1}(t,e);case 9:return Ji(t.arrayValue.values||[],e.arrayValue.values||[],ln);case 10:case 11:return function(i,o){const a=i.mapValue.fields||{},c=o.mapValue.fields||{};if(kd(a)!==kd(c))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(c[u]===void 0||!ln(a[u],c[u])))return!1;return!0}(t,e);default:return Ze(52216,{left:t})}}function Jo(t,e){return(t.values||[]).find(r=>ln(r,e))!==void 0}function Xi(t,e){if(t===e)return 0;const r=Qn(t),n=Qn(e);if(r!==n)return mt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return mt(t.booleanValue,e.booleanValue);case 2:return function(o,a){const c=Kt(o.integerValue||o.doubleValue),u=Kt(a.integerValue||a.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return Dd(t.timestampValue,e.timestampValue);case 4:return Dd(Ko(t),Ko(e));case 5:return Kl(t.stringValue,e.stringValue);case 6:return function(o,a){const c=Kn(o),u=Kn(a);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(o,a){const c=o.split("/"),u=a.split("/");for(let h=0;h<c.length&&h<u.length;h++){const f=mt(c[h],u[h]);if(f!==0)return f}return mt(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,a){const c=mt(Kt(o.latitude),Kt(a.latitude));return c!==0?c:mt(Kt(o.longitude),Kt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Nd(t.arrayValue,e.arrayValue);case 10:return function(o,a){const c=o.fields||{},u=a.fields||{},h=c[ga]?.arrayValue,f=u[ga]?.arrayValue,p=mt(h?.values?.length||0,f?.values?.length||0);return p!==0?p:Nd(h,f)}(t.mapValue,e.mapValue);case 11:return function(o,a){if(o===xs.mapValue&&a===xs.mapValue)return 0;if(o===xs.mapValue)return 1;if(a===xs.mapValue)return-1;const c=o.fields||{},u=Object.keys(c),h=a.fields||{},f=Object.keys(h);u.sort(),f.sort();for(let p=0;p<u.length&&p<f.length;++p){const b=Kl(u[p],f[p]);if(b!==0)return b;const C=Xi(c[u[p]],h[f[p]]);if(C!==0)return C}return mt(u.length,f.length)}(t.mapValue,e.mapValue);default:throw Ze(23264,{he:r})}}function Dd(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return mt(t,e);const r=Yn(t),n=Yn(e),i=mt(r.seconds,n.seconds);return i!==0?i:mt(r.nanos,n.nanos)}function Nd(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const o=Xi(r[i],n[i]);if(o)return o}return mt(r.length,n.length)}function Zi(t){return Ql(t)}function Ql(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Yn(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Kn(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Je.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const o of r.values||[])i?i=!1:n+=",",n+=Ql(o);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const a of n)o?o=!1:i+=",",i+=`${a}:${Ql(r.fields[a])}`;return i+"}"}(t.mapValue):Ze(61005,{value:t})}function Ys(t){switch(Qn(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=La(t);return e?16+Ys(e):16;case 5:return 2*t.stringValue.length;case 6:return Kn(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,o)=>i+Ys(o),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return ri(n.fields,(o,a)=>{i+=o.length+Ys(a)}),i}(t.mapValue);default:throw Ze(13486,{value:t})}}function Jl(t){return!!t&&"integerValue"in t}function Vc(t){return!!t&&"arrayValue"in t}function Ld(t){return!!t&&"nullValue"in t}function Md(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ks(t){return!!t&&"mapValue"in t}function V_(t){return(t?.mapValue?.fields||{})[kf]?.stringValue===Rf}function Mo(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return ri(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Mo(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Mo(t.arrayValue.values[r]);return e}return{...t}}function B_(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===O_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e){this.value=e}static empty(){return new Tr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Ks(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Mo(r)}setAll(e){let r=hr.emptyPath(),n={},i=[];e.forEach((a,c)=>{if(!r.isImmediateParentOf(c)){const u=this.getFieldsMap(r);this.applyChanges(u,n,i),n={},i=[],r=c.popLast()}a?n[c.lastSegment()]=Mo(a):i.push(c.lastSegment())});const o=this.getFieldsMap(r);this.applyChanges(o,n,i)}delete(e){const r=this.field(e.popLast());Ks(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return ln(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];Ks(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){ri(r,(i,o)=>e[i]=o);for(const i of n)delete e[i]}clone(){return new Tr(Mo(this.value))}}function Df(t){const e=[];return ri(t.fields,(r,n)=>{const i=new hr([r]);if(Ks(n)){const o=Df(n.mapValue).fields;if(o.length===0)e.push(i);else for(const a of o)e.push(i.child(a))}else e.push(i)}),new Dr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e,r,n,i,o,a,c){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=o,this.data=a,this.documentState=c}static newInvalidDocument(e){return new Pr(e,0,rt.min(),rt.min(),rt.min(),Tr.empty(),0)}static newFoundDocument(e,r,n,i){return new Pr(e,1,r,rt.min(),n,i,0)}static newNoDocument(e,r){return new Pr(e,2,r,rt.min(),rt.min(),Tr.empty(),0)}static newUnknownDocument(e,r){return new Pr(e,3,r,rt.min(),rt.min(),Tr.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(rt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Tr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Tr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=rt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Pr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Pr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa{constructor(e,r){this.position=e,this.inclusive=r}}function Od(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const o=e[i],a=t.position[i];if(o.field.isKeyField()?n=Je.comparator(Je.fromName(a.referenceValue),r.key):n=Xi(a,r.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function Vd(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!ln(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(e,r="asc"){this.field=e,this.dir=r}}function F_(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{}class ir extends Nf{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new j_(e,r,n):r==="array-contains"?new H_(e,n):r==="in"?new W_(e,n):r==="not-in"?new G_(e,n):r==="array-contains-any"?new Y_(e,n):new ir(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new z_(e,n):new q_(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(Xi(r,this.value)):r!==null&&Qn(this.value)===Qn(r)&&this.matchesComparison(Xi(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ze(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class cn extends Nf{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new cn(e,r)}matches(e){return Lf(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Lf(t){return t.op==="and"}function Mf(t){return U_(t)&&Lf(t)}function U_(t){for(const e of t.filters)if(e instanceof cn)return!1;return!0}function Xl(t){if(t instanceof ir)return t.field.canonicalString()+t.op.toString()+Zi(t.value);if(Mf(t))return t.filters.map(e=>Xl(e)).join(",");{const e=t.filters.map(r=>Xl(r)).join(",");return`${t.op}(${e})`}}function Of(t,e){return t instanceof ir?function(n,i){return i instanceof ir&&n.op===i.op&&n.field.isEqual(i.field)&&ln(n.value,i.value)}(t,e):t instanceof cn?function(n,i){return i instanceof cn&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((o,a,c)=>o&&Of(a,i.filters[c]),!0):!1}(t,e):void Ze(19439)}function Vf(t){return t instanceof ir?function(r){return`${r.field.canonicalString()} ${r.op} ${Zi(r.value)}`}(t):t instanceof cn?function(r){return r.op.toString()+" {"+r.getFilters().map(Vf).join(" ,")+"}"}(t):"Filter"}class j_ extends ir{constructor(e,r,n){super(e,r,n),this.key=Je.fromName(n.referenceValue)}matches(e){const r=Je.comparator(e.key,this.key);return this.matchesComparison(r)}}class z_ extends ir{constructor(e,r){super(e,"in",r),this.keys=Bf("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class q_ extends ir{constructor(e,r){super(e,"not-in",r),this.keys=Bf("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function Bf(t,e){return(e.arrayValue?.values||[]).map(r=>Je.fromName(r.referenceValue))}class H_ extends ir{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Vc(r)&&Jo(r.arrayValue,this.value)}}class W_ extends ir{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Jo(this.value.arrayValue,r)}}class G_ extends ir{constructor(e,r){super(e,"not-in",r)}matches(e){if(Jo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!Jo(this.value.arrayValue,r)}}class Y_ extends ir{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Vc(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Jo(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{constructor(e,r=null,n=[],i=[],o=null,a=null,c=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=a,this.endAt=c,this.Te=null}}function Bd(t,e=null,r=[],n=[],i=null,o=null,a=null){return new K_(t,e,r,n,i,o,a)}function Bc(t){const e=nt(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Xl(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(o){return o.field.canonicalString()+o.dir}(n)).join(","),Na(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Zi(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Zi(n)).join(",")),e.Te=r}return e.Te}function Fc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!F_(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!Of(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Vd(t.startAt,e.startAt)&&Vd(t.endAt,e.endAt)}function Zl(t){return Je.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(e,r=null,n=[],i=[],o=null,a="F",c=null,u=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=a,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Q_(t,e,r,n,i,o,a,c){return new Ma(t,e,r,n,i,o,a,c)}function Uc(t){return new Ma(t)}function Fd(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function J_(t){return t.collectionGroup!==null}function Oo(t){const e=nt(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),r.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new sr(hr.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(c=c.add(h.field))})}),c})(e).forEach(o=>{r.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new va(o,n))}),r.has(hr.keyField().canonicalString())||e.Ie.push(new va(hr.keyField(),n))}return e.Ie}function tn(t){const e=nt(t);return e.Ee||(e.Ee=X_(e,Oo(t))),e.Ee}function X_(t,e){if(t.limitType==="F")return Bd(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const o=i.dir==="desc"?"asc":"desc";return new va(i.field,o)});const r=t.endAt?new pa(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new pa(t.startAt.position,t.startAt.inclusive):null;return Bd(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function ec(t,e,r){return new Ma(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Oa(t,e){return Fc(tn(t),tn(e))&&t.limitType===e.limitType}function Ff(t){return`${Bc(tn(t))}|lt:${t.limitType}`}function Fi(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>Vf(i)).join(", ")}]`),Na(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>Zi(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>Zi(i)).join(",")),`Target(${n})`}(tn(t))}; limitType=${t.limitType})`}function Va(t,e){return e.isFoundDocument()&&function(n,i){const o=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):Je.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(t,e)&&function(n,i){for(const o of Oo(n))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const o of n.filters)if(!o.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,c,u){const h=Od(a,c,u);return a.inclusive?h<=0:h<0}(n.startAt,Oo(n),i)||n.endAt&&!function(a,c,u){const h=Od(a,c,u);return a.inclusive?h>=0:h>0}(n.endAt,Oo(n),i))}(t,e)}function Z_(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Uf(t){return(e,r)=>{let n=!1;for(const i of Oo(t)){const o=eS(i,e,r);if(o!==0)return o;n=n||i.field.isKeyField()}return 0}}function eS(t,e,r){const n=t.field.isKeyField()?Je.comparator(e.key,r.key):function(o,a,c){const u=a.data.field(o),h=c.data.field(o);return u!==null&&h!==null?Xi(u,h):Ze(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Ze(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,o]of n)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ri(this.inner,(r,n)=>{for(const[i,o]of n)e(i,o)})}isEmpty(){return Af(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tS=new qt(Je.comparator);function In(){return tS}const jf=new qt(Je.comparator);function xo(...t){let e=jf;for(const r of t)e=e.insert(r.key,r);return e}function zf(t){let e=jf;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function yi(){return Vo()}function qf(){return Vo()}function Vo(){return new Ii(t=>t.toString(),(t,e)=>t.isEqual(e))}const rS=new qt(Je.comparator),nS=new sr(Je.comparator);function ft(...t){let e=nS;for(const r of t)e=e.add(r);return e}const iS=new sr(mt);function oS(){return iS}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jc(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:fa(e)?"-0":e}}function Hf(t){return{integerValue:""+t}}function sS(t,e){return R_(e)?Hf(e):jc(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ba{constructor(){this._=void 0}}function aS(t,e,r){return t instanceof ba?function(i,o){const a={fields:{[xf]:{stringValue:Ef},[$f]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Oc(o)&&(o=La(o)),o&&(a.fields[Tf]=o),{mapValue:a}}(r,e):t instanceof Xo?Gf(t,e):t instanceof Zo?Yf(t,e):function(i,o){const a=Wf(i,o),c=Ud(a)+Ud(i.Ae);return Jl(a)&&Jl(i.Ae)?Hf(c):jc(i.serializer,c)}(t,e)}function lS(t,e,r){return t instanceof Xo?Gf(t,e):t instanceof Zo?Yf(t,e):r}function Wf(t,e){return t instanceof _a?function(n){return Jl(n)||function(o){return!!o&&"doubleValue"in o}(n)}(e)?e:{integerValue:0}:null}class ba extends Ba{}class Xo extends Ba{constructor(e){super(),this.elements=e}}function Gf(t,e){const r=Kf(e);for(const n of t.elements)r.some(i=>ln(i,n))||r.push(n);return{arrayValue:{values:r}}}class Zo extends Ba{constructor(e){super(),this.elements=e}}function Yf(t,e){let r=Kf(e);for(const n of t.elements)r=r.filter(i=>!ln(i,n));return{arrayValue:{values:r}}}class _a extends Ba{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function Ud(t){return Kt(t.integerValue||t.doubleValue)}function Kf(t){return Vc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function cS(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof Xo&&i instanceof Xo||n instanceof Zo&&i instanceof Zo?Ji(n.elements,i.elements,ln):n instanceof _a&&i instanceof _a?ln(n.Ae,i.Ae):n instanceof ba&&i instanceof ba}(t.transform,e.transform)}class uS{constructor(e,r){this.version=e,this.transformResults=r}}class rn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new rn}static exists(e){return new rn(void 0,e)}static updateTime(e){return new rn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Qs(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Fa{}function Qf(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Xf(t.key,rn.none()):new cs(t.key,t.data,rn.none());{const r=t.data,n=Tr.empty();let i=new sr(hr.comparator);for(let o of e.fields)if(!i.has(o)){let a=r.field(o);a===null&&o.length>1&&(o=o.popLast(),a=r.field(o)),a===null?n.delete(o):n.set(o,a),i=i.add(o)}return new ni(t.key,n,new Dr(i.toArray()),rn.none())}}function dS(t,e,r){t instanceof cs?function(i,o,a){const c=i.value.clone(),u=zd(i.fieldTransforms,o,a.transformResults);c.setAll(u),o.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,r):t instanceof ni?function(i,o,a){if(!Qs(i.precondition,o))return void o.convertToUnknownDocument(a.version);const c=zd(i.fieldTransforms,o,a.transformResults),u=o.data;u.setAll(Jf(i)),u.setAll(c),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,r):function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function Bo(t,e,r,n){return t instanceof cs?function(o,a,c,u){if(!Qs(o.precondition,a))return c;const h=o.value.clone(),f=qd(o.fieldTransforms,u,a);return h.setAll(f),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(t,e,r,n):t instanceof ni?function(o,a,c,u){if(!Qs(o.precondition,a))return c;const h=qd(o.fieldTransforms,u,a),f=a.data;return f.setAll(Jf(o)),f.setAll(h),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),c===null?null:c.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(p=>p.field))}(t,e,r,n):function(o,a,c){return Qs(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(t,e,r)}function hS(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),o=Wf(n.transform,i||null);o!=null&&(r===null&&(r=Tr.empty()),r.set(n.field,o))}return r||null}function jd(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Ji(n,i,(o,a)=>cS(o,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class cs extends Fa{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ni extends Fa{constructor(e,r,n,i,o=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function Jf(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function zd(t,e,r){const n=new Map;Et(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let i=0;i<r.length;i++){const o=t[i],a=o.transform,c=e.data.field(o.field);n.set(o.field,lS(a,c,r[i]))}return n}function qd(t,e,r){const n=new Map;for(const i of t){const o=i.transform,a=r.data.field(i.field);n.set(i.field,aS(o,a,e))}return n}class Xf extends Fa{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class mS extends Fa{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&dS(o,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Bo(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Bo(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=qf();return this.mutations.forEach(i=>{const o=e.get(i.key),a=o.overlayedDocument;let c=this.applyToLocalView(a,o.mutatedFields);c=r.has(i.key)?null:c;const u=Qf(a,c);u!==null&&n.set(i.key,u),a.isValidDocument()||a.convertToNoDocument(rt.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),ft())}isEqual(e){return this.batchId===e.batchId&&Ji(this.mutations,e.mutations,(r,n)=>jd(r,n))&&Ji(this.baseMutations,e.baseMutations,(r,n)=>jd(r,n))}}class zc{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Et(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=function(){return rS}();const o=e.mutations;for(let a=0;a<o.length;a++)i=i.insert(o[a].key,n[a].version);return new zc(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yS{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gS{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var er,vt;function pS(t){switch(t){case ke.OK:return Ze(64938);case ke.CANCELLED:case ke.UNKNOWN:case ke.DEADLINE_EXCEEDED:case ke.RESOURCE_EXHAUSTED:case ke.INTERNAL:case ke.UNAVAILABLE:case ke.UNAUTHENTICATED:return!1;case ke.INVALID_ARGUMENT:case ke.NOT_FOUND:case ke.ALREADY_EXISTS:case ke.PERMISSION_DENIED:case ke.FAILED_PRECONDITION:case ke.ABORTED:case ke.OUT_OF_RANGE:case ke.UNIMPLEMENTED:case ke.DATA_LOSS:return!0;default:return Ze(15467,{code:t})}}function Zf(t){if(t===void 0)return An("GRPC error has no .code"),ke.UNKNOWN;switch(t){case er.OK:return ke.OK;case er.CANCELLED:return ke.CANCELLED;case er.UNKNOWN:return ke.UNKNOWN;case er.DEADLINE_EXCEEDED:return ke.DEADLINE_EXCEEDED;case er.RESOURCE_EXHAUSTED:return ke.RESOURCE_EXHAUSTED;case er.INTERNAL:return ke.INTERNAL;case er.UNAVAILABLE:return ke.UNAVAILABLE;case er.UNAUTHENTICATED:return ke.UNAUTHENTICATED;case er.INVALID_ARGUMENT:return ke.INVALID_ARGUMENT;case er.NOT_FOUND:return ke.NOT_FOUND;case er.ALREADY_EXISTS:return ke.ALREADY_EXISTS;case er.PERMISSION_DENIED:return ke.PERMISSION_DENIED;case er.FAILED_PRECONDITION:return ke.FAILED_PRECONDITION;case er.ABORTED:return ke.ABORTED;case er.OUT_OF_RANGE:return ke.OUT_OF_RANGE;case er.UNIMPLEMENTED:return ke.UNIMPLEMENTED;case er.DATA_LOSS:return ke.DATA_LOSS;default:return Ze(39323,{code:t})}}(vt=er||(er={}))[vt.OK=0]="OK",vt[vt.CANCELLED=1]="CANCELLED",vt[vt.UNKNOWN=2]="UNKNOWN",vt[vt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",vt[vt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",vt[vt.NOT_FOUND=5]="NOT_FOUND",vt[vt.ALREADY_EXISTS=6]="ALREADY_EXISTS",vt[vt.PERMISSION_DENIED=7]="PERMISSION_DENIED",vt[vt.UNAUTHENTICATED=16]="UNAUTHENTICATED",vt[vt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",vt[vt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",vt[vt.ABORTED=10]="ABORTED",vt[vt.OUT_OF_RANGE=11]="OUT_OF_RANGE",vt[vt.UNIMPLEMENTED=12]="UNIMPLEMENTED",vt[vt.INTERNAL=13]="INTERNAL",vt[vt.UNAVAILABLE=14]="UNAVAILABLE",vt[vt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vS(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bS=new Hn([4294967295,4294967295],0);function Hd(t){const e=vS().encode(t),r=new yf;return r.update(e),new Uint8Array(r.digest())}function Wd(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Hn([r,n],0),new Hn([i,o],0)]}class qc{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new To(`Invalid padding: ${r}`);if(n<0)throw new To(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new To(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new To(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Hn.fromNumber(this.ge)}ye(e,r,n){let i=e.add(r.multiply(Hn.fromNumber(n)));return i.compare(bS)===1&&(i=new Hn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=Hd(e),[n,i]=Wd(r);for(let o=0;o<this.hashCount;o++){const a=this.ye(n,i,o);if(!this.we(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new qc(o,i,r);return n.forEach(c=>a.insert(c)),a}insert(e){if(this.ge===0)return;const r=Hd(e),[n,i]=Wd(r);for(let o=0;o<this.hashCount;o++){const a=this.ye(n,i,o);this.Se(a)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class To extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e,r,n,i,o){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,us.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Ua(rt.min(),i,new qt(mt),In(),ft())}}class us{constructor(e,r,n,i,o){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new us(n,r,ft(),ft(),ft())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js{constructor(e,r,n,i){this.be=e,this.removedTargetIds=r,this.key=n,this.De=i}}class ey{constructor(e,r){this.targetId=e,this.Ce=r}}class ty{constructor(e,r,n=fr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class Gd{constructor(){this.ve=0,this.Fe=Yd(),this.Me=fr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ft(),r=ft(),n=ft();return this.Fe.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:Ze(38017,{changeType:o})}}),new us(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=Yd()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Et(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class _S{constructor(e){this.Ge=e,this.ze=new Map,this.je=In(),this.Je=Ts(),this.He=Ts(),this.Ye=new qt(mt)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:Ze(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,i)=>{this.rt(i)&&r(i)})}st(e){const r=e.targetId,n=e.Ce.count,i=this.ot(r);if(i){const o=i.target;if(Zl(o))if(n===0){const a=new Je(o.path);this.et(r,a,Pr.newNoDocument(a,rt.min()))}else Et(n===1,20013,{expectedCount:n});else{const a=this._t(r);if(a!==n){const c=this.ut(e),u=c?this.ct(c,e,a):1;if(u!==0){this.it(r);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,h)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:o=0}=r;let a,c;try{a=Kn(n).toUint8Array()}catch(u){if(u instanceof If)return Qi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new qc(a,i,o)}catch(u){return Qi(u instanceof To?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let i=0;return n.forEach(o=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(c)||(this.et(r,o,null),i++)}),i}Tt(e){const r=new Map;this.ze.forEach((o,a)=>{const c=this.ot(a);if(c){if(o.current&&Zl(c.target)){const u=new Je(c.target.path);this.It(u).has(a)||this.Et(a,u)||this.et(a,u,Pr.newNoDocument(u,e))}o.Be&&(r.set(a,o.ke()),o.qe())}});let n=ft();this.He.forEach((o,a)=>{let c=!0;a.forEachWhile(u=>{const h=this.ot(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(n=n.add(o))}),this.je.forEach((o,a)=>a.setReadTime(e));const i=new Ua(e,r,this.Ye,this.je,n);return this.je=In(),this.Je=Ts(),this.He=Ts(),this.Ye=new qt(mt),i}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,r)?i.Qe(r,1):i.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new Gd,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new sr(mt),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new sr(mt),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||je("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Gd),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function Ts(){return new qt(Je.comparator)}function Yd(){return new qt(Je.comparator)}const SS={asc:"ASCENDING",desc:"DESCENDING"},PS={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},wS={and:"AND",or:"OR"};class CS{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function tc(t,e){return t.useProto3Json||Na(e)?e:{value:e}}function Sa(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ry(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function AS(t,e){return Sa(t,e.toTimestamp())}function nn(t){return Et(!!t,49232),rt.fromTimestamp(function(r){const n=Yn(r);return new Bt(n.seconds,n.nanos)}(t))}function Hc(t,e){return rc(t,e).canonicalString()}function rc(t,e){const r=function(i){return new zt(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function ny(t){const e=zt.fromString(t);return Et(ly(e),10190,{key:e.toString()}),e}function nc(t,e){return Hc(t.databaseId,e.path)}function hl(t,e){const r=ny(e);if(r.get(1)!==t.databaseId.projectId)throw new We(ke.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new We(ke.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Je(oy(r))}function iy(t,e){return Hc(t.databaseId,e)}function IS(t){const e=ny(t);return e.length===4?zt.emptyPath():oy(e)}function ic(t){return new zt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function oy(t){return Et(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Kd(t,e,r){return{name:nc(t,e),fields:r.value.mapValue.fields}}function ES(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:Ze(39313,{state:h})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(h,f){return h.useProto3Json?(Et(f===void 0||typeof f=="string",58123),fr.fromBase64String(f||"")):(Et(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),fr.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(h){const f=h.code===void 0?ke.UNKNOWN:Zf(h.code);return new We(f,h.message||"")}(a);r=new ty(n,i,o,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=hl(t,n.document.name),o=nn(n.document.updateTime),a=n.document.createTime?nn(n.document.createTime):rt.min(),c=new Tr({mapValue:{fields:n.document.fields}}),u=Pr.newFoundDocument(i,o,a,c),h=n.targetIds||[],f=n.removedTargetIds||[];r=new Js(h,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=hl(t,n.document),o=n.readTime?nn(n.readTime):rt.min(),a=Pr.newNoDocument(i,o),c=n.removedTargetIds||[];r=new Js([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=hl(t,n.document),o=n.removedTargetIds||[];r=new Js([],o,i,null)}else{if(!("filter"in e))return Ze(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:o}=n,a=new gS(i,o),c=n.targetId;r=new ey(c,a)}}return r}function xS(t,e){let r;if(e instanceof cs)r={update:Kd(t,e.key,e.value)};else if(e instanceof Xf)r={delete:nc(t,e.key)};else if(e instanceof ni)r={update:Kd(t,e.key,e.data),updateMask:OS(e.fieldMask)};else{if(!(e instanceof mS))return Ze(16599,{Vt:e.type});r={verify:nc(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(o,a){const c=a.transform;if(c instanceof ba)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Xo)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Zo)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof _a)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw Ze(20930,{transform:a.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:AS(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Ze(27497)}(t,e.precondition)),r}function TS(t,e){return t&&t.length>0?(Et(e!==void 0,14353),t.map(r=>function(i,o){let a=i.updateTime?nn(i.updateTime):nn(o);return a.isEqual(rt.min())&&(a=nn(o)),new uS(a,i.transformResults||[])}(r,e))):[]}function $S(t,e){return{documents:[iy(t,e.path)]}}function kS(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=iy(t,i);const o=function(h){if(h.length!==0)return ay(cn.create(h,"and"))}(e.filters);o&&(r.structuredQuery.where=o);const a=function(h){if(h.length!==0)return h.map(f=>function(b){return{field:Ui(b.field),direction:NS(b.dir)}}(f))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const c=tc(t,e.limit);return c!==null&&(r.structuredQuery.limit=c),e.startAt&&(r.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{ft:r,parent:i}}function RS(t){let e=IS(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Et(n===1,65062);const f=r.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let o=[];r.where&&(o=function(p){const b=sy(p);return b instanceof cn&&Mf(b)?b.getFilters():[b]}(r.where));let a=[];r.orderBy&&(a=function(p){return p.map(b=>function(R){return new va(ji(R.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(b))}(r.orderBy));let c=null;r.limit&&(c=function(p){let b;return b=typeof p=="object"?p.value:p,Na(b)?null:b}(r.limit));let u=null;r.startAt&&(u=function(p){const b=!!p.before,C=p.values||[];return new pa(C,b)}(r.startAt));let h=null;return r.endAt&&(h=function(p){const b=!p.before,C=p.values||[];return new pa(C,b)}(r.endAt)),Q_(e,i,a,o,c,"F",u,h)}function DS(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ze(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function sy(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=ji(r.unaryFilter.field);return ir.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=ji(r.unaryFilter.field);return ir.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=ji(r.unaryFilter.field);return ir.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=ji(r.unaryFilter.field);return ir.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ze(61313);default:return Ze(60726)}}(t):t.fieldFilter!==void 0?function(r){return ir.create(ji(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ze(58110);default:return Ze(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return cn.create(r.compositeFilter.filters.map(n=>sy(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ze(1026)}}(r.compositeFilter.op))}(t):Ze(30097,{filter:t})}function NS(t){return SS[t]}function LS(t){return PS[t]}function MS(t){return wS[t]}function Ui(t){return{fieldPath:t.canonicalString()}}function ji(t){return hr.fromServerFormat(t.fieldPath)}function ay(t){return t instanceof ir?function(r){if(r.op==="=="){if(Md(r.value))return{unaryFilter:{field:Ui(r.field),op:"IS_NAN"}};if(Ld(r.value))return{unaryFilter:{field:Ui(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(Md(r.value))return{unaryFilter:{field:Ui(r.field),op:"IS_NOT_NAN"}};if(Ld(r.value))return{unaryFilter:{field:Ui(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ui(r.field),op:LS(r.op),value:r.value}}}(t):t instanceof cn?function(r){const n=r.getFilters().map(i=>ay(i));return n.length===1?n[0]:{compositeFilter:{op:MS(r.op),filters:n}}}(t):Ze(54877,{filter:t})}function OS(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function ly(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e,r,n,i,o=rt.min(),a=rt.min(),c=fr.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Vn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Vn(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Vn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Vn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VS{constructor(e){this.yt=e}}function BS(t){const e=RS({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?ec(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FS{constructor(){this.Cn=new US}addToCollectionParentIndex(e,r){return this.Cn.add(r),Ee.resolve()}getCollectionParents(e,r){return Ee.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return Ee.resolve()}deleteFieldIndex(e,r){return Ee.resolve()}deleteAllFieldIndexes(e){return Ee.resolve()}createTargetIndexes(e,r){return Ee.resolve()}getDocumentsMatchingTarget(e,r){return Ee.resolve(null)}getIndexType(e,r){return Ee.resolve(0)}getFieldIndexes(e,r){return Ee.resolve([])}getNextCollectionGroupToUpdate(e){return Ee.resolve(null)}getMinOffset(e,r){return Ee.resolve(Gn.min())}getMinOffsetFromCollectionGroup(e,r){return Ee.resolve(Gn.min())}updateCollectionGroup(e,r,n){return Ee.resolve()}updateIndexEntries(e,r){return Ee.resolve()}}class US{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new sr(zt.comparator),o=!i.has(n);return this.index[r]=i.add(n),o}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new sr(zt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qd={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},cy=41943040;class xr{static withCacheSize(e){return new xr(e,xr.DEFAULT_COLLECTION_PERCENTILE,xr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */xr.DEFAULT_COLLECTION_PERCENTILE=10,xr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,xr.DEFAULT=new xr(cy,xr.DEFAULT_COLLECTION_PERCENTILE,xr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),xr.DISABLED=new xr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new eo(0)}static cr(){return new eo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jd="LruGarbageCollector",jS=1048576;function Xd([t,e],[r,n]){const i=mt(t,r);return i===0?mt(e,n):i}class zS{constructor(e){this.Ir=e,this.buffer=new sr(Xd),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();Xd(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class qS{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){je(Jd,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){lo(r)?je(Jd,"Ignoring IndexedDB error during garbage collection: ",r):await ao(r)}await this.Vr(3e5)})}}class HS{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return Ee.resolve(Da.ce);const n=new zS(r);return this.mr.forEachTarget(e,i=>n.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>n.Ar(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(je("LruGarbageCollector","Garbage collection skipped; disabled"),Ee.resolve(Qd)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(je("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Qd):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,i,o,a,c,u,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(je("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,a=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(n=p,c=Date.now(),this.removeTargets(e,n,r))).next(p=>(o=p,u=Date.now(),this.removeOrphanedDocuments(e,n))).next(p=>(h=Date.now(),Bi()<=ht.DEBUG&&je("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-f}ms
	Determined least recently used ${i} in `+(c-a)+`ms
	Removed ${o} targets in `+(u-c)+`ms
	Removed ${p} documents in `+(h-u)+`ms
Total Duration: ${h-f}ms`),Ee.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:p})))}}function WS(t,e){return new HS(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(){this.changes=new Ii(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Pr.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Ee.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YS{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Bo(n.mutation,i,Dr.empty(),Bt.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,ft()).next(()=>n))}getLocalViewOfDocuments(e,r,n=ft()){const i=yi();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(o=>{let a=xo();return o.forEach((c,u)=>{a=a.insert(c,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=yi();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,ft()))}populateOverlays(e,r,n){const i=[];return n.forEach(o=>{r.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((a,c)=>{r.set(a,c)})})}computeViews(e,r,n,i){let o=In();const a=Vo(),c=function(){return Vo()}();return r.forEach((u,h)=>{const f=n.get(h.key);i.has(h.key)&&(f===void 0||f.mutation instanceof ni)?o=o.insert(h.key,h):f!==void 0?(a.set(h.key,f.mutation.getFieldMask()),Bo(f.mutation,h,f.mutation.getFieldMask(),Bt.now())):a.set(h.key,Dr.empty())}),this.recalculateAndSaveOverlays(e,o).next(u=>(u.forEach((h,f)=>a.set(h,f)),r.forEach((h,f)=>c.set(h,new YS(f,a.get(h)??null))),c))}recalculateAndSaveOverlays(e,r){const n=Vo();let i=new qt((a,c)=>a-c),o=ft();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const c of a)c.keys().forEach(u=>{const h=r.get(u);if(h===null)return;let f=n.get(u)||Dr.empty();f=c.applyToLocalView(h,f),n.set(u,f);const p=(i.get(c.batchId)||ft()).add(u);i=i.insert(c.batchId,p)})}).next(()=>{const a=[],c=i.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),h=u.key,f=u.value,p=qf();f.forEach(b=>{if(!o.has(b)){const C=Qf(r.get(b),n.get(b));C!==null&&p.set(b,C),o=o.add(b)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,p))}return Ee.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return Je.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):J_(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(o=>{const a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-o.size):Ee.resolve(yi());let c=Yo,u=o;return a.next(h=>Ee.forEach(h,(f,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),o.get(f)?Ee.resolve():this.remoteDocumentCache.getEntry(e,f).next(b=>{u=u.insert(f,b)}))).next(()=>this.populateOverlays(e,h,o)).next(()=>this.computeViews(e,u,h,ft())).next(f=>({batchId:c,changes:zf(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Je(r)).next(n=>{let i=xo();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const o=r.collectionGroup;let a=xo();return this.indexManager.getCollectionParents(e,o).next(c=>Ee.forEach(c,u=>{const h=function(p,b){return new Ma(b,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(r,u.child(o));return this.getDocumentsMatchingCollectionQuery(e,h,n,i).next(f=>{f.forEach((p,b)=>{a=a.insert(p,b)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,o,i))).next(a=>{o.forEach((u,h)=>{const f=h.getKey();a.get(f)===null&&(a=a.insert(f,Pr.newInvalidDocument(f)))});let c=xo();return a.forEach((u,h)=>{const f=o.get(u);f!==void 0&&Bo(f.mutation,h,Dr.empty(),Bt.now()),Va(r,h)&&(c=c.insert(u,h))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return Ee.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:nn(i.createTime)}}(r)),Ee.resolve()}getNamedQuery(e,r){return Ee.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(i){return{name:i.name,query:BS(i.bundledQuery),readTime:nn(i.readTime)}}(r)),Ee.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(){this.overlays=new qt(Je.comparator),this.qr=new Map}getOverlay(e,r){return Ee.resolve(this.overlays.get(r))}getOverlays(e,r){const n=yi();return Ee.forEach(r,i=>this.getOverlay(e,i).next(o=>{o!==null&&n.set(i,o)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,o)=>{this.St(e,r,o)}),Ee.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.qr.delete(n)),Ee.resolve()}getOverlaysForCollection(e,r,n){const i=yi(),o=r.length+1,a=new Je(r.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const u=c.getNext().value,h=u.getKey();if(!r.isPrefixOf(h.path))break;h.path.length===o&&u.largestBatchId>n&&i.set(u.getKey(),u)}return Ee.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let o=new qt((h,f)=>h-f);const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===r&&h.largestBatchId>n){let f=o.get(h.largestBatchId);f===null&&(f=yi(),o=o.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const c=yi(),u=o.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,f)=>c.set(h,f)),!(c.size()>=i)););return Ee.resolve(c)}St(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new yS(r,n));let o=this.qr.get(r);o===void 0&&(o=ft(),this.qr.set(r,o)),this.qr.set(r,o.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XS{constructor(){this.sessionToken=fr.EMPTY_BYTE_STRING}getSessionToken(e){return Ee.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Ee.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wc{constructor(){this.Qr=new sr(lr.$r),this.Ur=new sr(lr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new lr(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new lr(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new Je(new zt([])),n=new lr(r,e),i=new lr(r,e+1),o=[];return this.Ur.forEachInRange([n,i],a=>{this.Gr(a),o.push(a.key)}),o}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new Je(new zt([])),n=new lr(r,e),i=new lr(r,e+1);let o=ft();return this.Ur.forEachInRange([n,i],a=>{o=o.add(a.key)}),o}containsKey(e){const r=new lr(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class lr{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return Je.comparator(e.key,r.key)||mt(e.Yr,r.Yr)}static Kr(e,r){return mt(e.Yr,r.Yr)||Je.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new sr(lr.$r)}checkEmpty(e){return Ee.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new fS(o,r,n,i);this.mutationQueue.push(a);for(const c of i)this.Zr=this.Zr.add(new lr(c.key,o)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return Ee.resolve(a)}lookupMutationBatch(e,r){return Ee.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.ei(n),o=i<0?0:i;return Ee.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return Ee.resolve(this.mutationQueue.length===0?Mc:this.tr-1)}getAllMutationBatches(e){return Ee.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new lr(r,0),i=new lr(r,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([n,i],a=>{const c=this.Xr(a.Yr);o.push(c)}),Ee.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new sr(mt);return r.forEach(i=>{const o=new lr(i,0),a=new lr(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,a],c=>{n=n.add(c.Yr)})}),Ee.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let o=n;Je.isDocumentKey(o)||(o=o.child(""));const a=new lr(new Je(o),0);let c=new sr(mt);return this.Zr.forEachWhile(u=>{const h=u.key.path;return!!n.isPrefixOf(h)&&(h.length===i&&(c=c.add(u.Yr)),!0)},a),Ee.resolve(this.ti(c))}ti(e){const r=[];return e.forEach(n=>{const i=this.Xr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){Et(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return Ee.forEach(r.mutations,i=>{const o=new lr(i.key,r.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new lr(r,0),i=this.Zr.firstAfterOrEqual(n);return Ee.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ee.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1{constructor(e){this.ri=e,this.docs=function(){return new qt(Je.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),o=i?i.size:0,a=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Ee.resolve(n?n.document.mutableCopy():Pr.newInvalidDocument(r))}getEntries(e,r){let n=In();return r.forEach(i=>{const o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():Pr.newInvalidDocument(i))}),Ee.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let o=In();const a=r.path,c=new Je(a.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:h,value:{document:f}}=u.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||x_(E_(f),n)<=0||(i.has(f.key)||Va(r,f))&&(o=o.insert(f.key,f.mutableCopy()))}return Ee.resolve(o)}getAllFromCollectionGroup(e,r,n,i){Ze(9500)}ii(e,r){return Ee.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new t1(this)}getSize(e){return Ee.resolve(this.size)}}class t1 extends GS{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)}),Ee.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r1{constructor(e){this.persistence=e,this.si=new Ii(r=>Bc(r),Fc),this.lastRemoteSnapshotVersion=rt.min(),this.highestTargetId=0,this.oi=0,this._i=new Wc,this.targetCount=0,this.ai=eo.ur()}forEachTarget(e,r){return this.si.forEach((n,i)=>r(i)),Ee.resolve()}getLastRemoteSnapshotVersion(e){return Ee.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ee.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Ee.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),Ee.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new eo(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,Ee.resolve()}updateTargetData(e,r){return this.Pr(r),Ee.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,Ee.resolve()}removeTargets(e,r,n){let i=0;const o=[];return this.si.forEach((a,c)=>{c.sequenceNumber<=r&&n.get(c.targetId)===null&&(this.si.delete(a),o.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),Ee.waitFor(o).next(()=>i)}getTargetCount(e){return Ee.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return Ee.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),Ee.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const i=this.persistence.referenceDelegate,o=[];return i&&r.forEach(a=>{o.push(i.markPotentiallyOrphaned(e,a))}),Ee.waitFor(o)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),Ee.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return Ee.resolve(n)}containsKey(e,r){return Ee.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uy{constructor(e,r){this.ui={},this.overlays={},this.ci=new Da(0),this.li=!1,this.li=!0,this.hi=new XS,this.referenceDelegate=e(this),this.Pi=new r1(this),this.indexManager=new FS,this.remoteDocumentCache=function(i){return new e1(i)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new VS(r),this.Ii=new QS(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new JS,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new ZS(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){je("MemoryPersistence","Starting transaction:",e);const i=new n1(this.ci.next());return this.referenceDelegate.Ei(),n(i).next(o=>this.referenceDelegate.di(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ai(e,r){return Ee.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class n1 extends $_{constructor(e){super(),this.currentSequenceNumber=e}}class Gc{constructor(e){this.persistence=e,this.Ri=new Wc,this.Vi=null}static mi(e){return new Gc(e)}get fi(){if(this.Vi)return this.Vi;throw Ze(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),Ee.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),Ee.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),Ee.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(i=>this.fi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(o=>this.fi.add(o.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ee.forEach(this.fi,n=>{const i=Je.fromPath(n);return this.gi(e,i).next(o=>{o||r.removeEntry(i,rt.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return Ee.or([()=>Ee.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class Pa{constructor(e,r){this.persistence=e,this.pi=new Ii(n=>D_(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=WS(this,r)}static mi(e,r){return new Pa(e,r)}Ei(){}di(e){return Ee.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return Ee.forEach(this.pi,(n,i)=>this.br(e,n,i).next(o=>o?Ee.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ii(e,a=>this.br(e,a,r).next(c=>{c||(n++,o.removeEntry(a,rt.min()))})).next(()=>o.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),Ee.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Ee.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Ee.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),Ee.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=Ys(e.data.value)),r}br(e,r,n){return Ee.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.pi.get(r);return Ee.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=i}static As(e,r){let n=ft(),i=ft();for(const o of r.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new Yc(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i1{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return Gp()?8:k_(Cr())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,i){const o={result:null};return this.ys(e,r).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.ws(e,r,i,n).next(a=>{o.result=a})}).next(()=>{if(o.result)return;const a=new i1;return this.Ss(e,r,a).next(c=>{if(o.result=c,this.Vs)return this.bs(e,r,a,c.size)})}).next(()=>o.result)}bs(e,r,n,i){return n.documentReadCount<this.fs?(Bi()<=ht.DEBUG&&je("QueryEngine","SDK will not create cache indexes for query:",Fi(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Ee.resolve()):(Bi()<=ht.DEBUG&&je("QueryEngine","Query:",Fi(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(Bi()<=ht.DEBUG&&je("QueryEngine","The SDK decides to create cache indexes for query:",Fi(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,tn(r))):Ee.resolve())}ys(e,r){if(Fd(r))return Ee.resolve(null);let n=tn(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=ec(r,null,"F"),n=tn(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(o=>{const a=ft(...o);return this.ps.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,n).next(u=>{const h=this.Ds(r,c);return this.Cs(r,h,a,u.readTime)?this.ys(e,ec(r,null,"F")):this.vs(e,h,r,u)}))})))}ws(e,r,n,i){return Fd(r)||i.isEqual(rt.min())?Ee.resolve(null):this.ps.getDocuments(e,n).next(o=>{const a=this.Ds(r,o);return this.Cs(r,a,n,i)?Ee.resolve(null):(Bi()<=ht.DEBUG&&je("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Fi(r)),this.vs(e,a,r,I_(i,Yo)).next(c=>c))})}Ds(e,r){let n=new sr(Uf(e));return r.forEach((i,o)=>{Va(e,o)&&(n=n.add(o))}),n}Cs(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const o=e.limitType==="F"?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Ss(e,r,n){return Bi()<=ht.DEBUG&&je("QueryEngine","Using full collection scan to execute query:",Fi(r)),this.ps.getDocumentsMatchingQuery(e,r,Gn.min(),n)}vs(e,r,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next(o=>(r.forEach(a=>{o=o.insert(a.key,a)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kc="LocalStore",s1=3e8;class a1{constructor(e,r,n,i){this.persistence=e,this.Fs=r,this.serializer=i,this.Ms=new qt(mt),this.xs=new Ii(o=>Bc(o),Fc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new KS(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function l1(t,e,r,n){return new a1(t,e,r,n)}async function dy(t,e){const r=nt(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(o=>(i=o,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(o=>{const a=[],c=[];let u=ft();for(const h of i){a.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}for(const h of o){c.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}return r.localDocuments.getDocuments(n,u).next(h=>({Ls:h,removedBatchIds:a,addedBatchIds:c}))})})}function c1(t,e){const r=nt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),o=r.Ns.newChangeBuffer({trackRemovals:!0});return function(c,u,h,f){const p=h.batch,b=p.keys();let C=Ee.resolve();return b.forEach(R=>{C=C.next(()=>f.getEntry(u,R)).next(E=>{const x=h.docVersions.get(R);Et(x!==null,48541),E.version.compareTo(x)<0&&(p.applyToRemoteDocument(E,h),E.isValidDocument()&&(E.setReadTime(h.commitVersion),f.addEntry(E)))})}),C.next(()=>c.mutationQueue.removeMutationBatch(u,p))}(r,n,e,o).next(()=>o.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(c){let u=ft();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(u=u.add(c.batch.mutations[h].key));return u}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function hy(t){const e=nt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function u1(t,e){const r=nt(t),n=e.snapshotVersion;let i=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const a=r.Ns.newChangeBuffer({trackRemovals:!0});i=r.Ms;const c=[];e.targetChanges.forEach((f,p)=>{const b=i.get(p);if(!b)return;c.push(r.Pi.removeMatchingKeys(o,f.removedDocuments,p).next(()=>r.Pi.addMatchingKeys(o,f.addedDocuments,p)));let C=b.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(p)!==null?C=C.withResumeToken(fr.EMPTY_BYTE_STRING,rt.min()).withLastLimboFreeSnapshotVersion(rt.min()):f.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(f.resumeToken,n)),i=i.insert(p,C),function(E,x,T){return E.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=s1?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(b,C,f)&&c.push(r.Pi.updateTargetData(o,C))});let u=In(),h=ft();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&c.push(r.persistence.referenceDelegate.updateLimboDocument(o,f))}),c.push(d1(o,a,e.documentUpdates).next(f=>{u=f.ks,h=f.qs})),!n.isEqual(rt.min())){const f=r.Pi.getLastRemoteSnapshotVersion(o).next(p=>r.Pi.setTargetsMetadata(o,o.currentSequenceNumber,n));c.push(f)}return Ee.waitFor(c).next(()=>a.apply(o)).next(()=>r.localDocuments.getLocalViewOfDocuments(o,u,h)).next(()=>u)}).then(o=>(r.Ms=i,o))}function d1(t,e,r){let n=ft(),i=ft();return r.forEach(o=>n=n.add(o)),e.getEntries(t,n).next(o=>{let a=In();return r.forEach((c,u)=>{const h=o.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(rt.min())?(e.removeEntry(c,u.readTime),a=a.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),a=a.insert(c,u)):je(Kc,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)}),{ks:a,qs:i}})}function h1(t,e){const r=nt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Mc),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function m1(t,e){const r=nt(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Pi.getTargetData(n,e).next(o=>o?(i=o,Ee.resolve(i)):r.Pi.allocateTargetId(n).next(a=>(i=new Vn(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function oc(t,e,r){const n=nt(t),i=n.Ms.get(e),o=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",o,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!lo(a))throw a;je(Kc,`Failed to update sequence numbers for target ${e}: ${a}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function Zd(t,e,r){const n=nt(t);let i=rt.min(),o=ft();return n.persistence.runTransaction("Execute query","readwrite",a=>function(u,h,f){const p=nt(u),b=p.xs.get(f);return b!==void 0?Ee.resolve(p.Ms.get(b)):p.Pi.getTargetData(h,f)}(n,a,tn(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(a,c.targetId).next(u=>{o=u})}).next(()=>n.Fs.getDocumentsMatchingQuery(a,e,r?i:rt.min(),r?o:ft())).next(c=>(f1(n,Z_(e),c),{documents:c,Qs:o})))}function f1(t,e,r){let n=t.Os.get(e)||rt.min();r.forEach((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)}),t.Os.set(e,n)}class eh{constructor(){this.activeTargetIds=oS()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class y1{constructor(){this.Mo=new eh,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new eh,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g1{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const th="ConnectivityMonitor";class rh{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){je(th,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){je(th,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $s=null;function sc(){return $s===null?$s=function(){return 268435456+Math.round(2147483648*Math.random())}():$s++,"0x"+$s.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ml="RestConnection",p1={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class v1{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===ya?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,r,n,i,o){const a=sc(),c=this.zo(e,r.toUriEncodedString());je(ml,`Sending RPC '${e}' ${a}:`,c,n);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,o);const{host:h}=new URL(c),f=no(h);return this.Jo(e,c,u,n,f).then(p=>(je(ml,`Received RPC '${e}' ${a}: `,p),p),p=>{throw Qi(ml,`RPC '${e}' ${a} failed with error: `,p,"url: ",c,"request:",n),p})}Ho(e,r,n,i,o,a){return this.Go(e,r,n,i,o)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+so}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>e[o]=i),n&&n.headers.forEach((i,o)=>e[o]=i)}zo(e,r){const n=p1[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b1{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const br="WebChannelConnection";class _1 extends v1{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,i,o){const a=sc();return new Promise((c,u)=>{const h=new gf;h.setWithCredentials(!0),h.listenOnce(pf.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Gs.NO_ERROR:const p=h.getResponseJson();je(br,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(p)),c(p);break;case Gs.TIMEOUT:je(br,`RPC '${e}' ${a} timed out`),u(new We(ke.DEADLINE_EXCEEDED,"Request time out"));break;case Gs.HTTP_ERROR:const b=h.getStatus();if(je(br,`RPC '${e}' ${a} failed with status:`,b,"response text:",h.getResponseText()),b>0){let C=h.getResponseJson();Array.isArray(C)&&(C=C[0]);const R=C?.error;if(R&&R.status&&R.message){const E=function(T){const W=T.toLowerCase().replace(/_/g,"-");return Object.values(ke).indexOf(W)>=0?W:ke.UNKNOWN}(R.status);u(new We(E,R.message))}else u(new We(ke.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new We(ke.UNAVAILABLE,"Connection failed."));break;default:Ze(9055,{l_:e,streamId:a,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{je(br,`RPC '${e}' ${a} completed.`)}});const f=JSON.stringify(i);je(br,`RPC '${e}' ${a} sending request:`,i),h.send(r,"POST",f,n,15)})}T_(e,r,n){const i=sc(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=_f(),c=bf(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,r,n),u.encodeInitMessageHeaders=!0;const f=o.join("");je(br,`Creating RPC '${e}' stream ${i}: ${f}`,u);const p=a.createWebChannel(f,u);this.I_(p);let b=!1,C=!1;const R=new b1({Yo:x=>{C?je(br,`Not sending because RPC '${e}' stream ${i} is closed:`,x):(b||(je(br,`Opening RPC '${e}' stream ${i} transport.`),p.open(),b=!0),je(br,`RPC '${e}' stream ${i} sending:`,x),p.send(x))},Zo:()=>p.close()}),E=(x,T,W)=>{x.listen(T,te=>{try{W(te)}catch(Q){setTimeout(()=>{throw Q},0)}})};return E(p,Eo.EventType.OPEN,()=>{C||(je(br,`RPC '${e}' stream ${i} transport opened.`),R.o_())}),E(p,Eo.EventType.CLOSE,()=>{C||(C=!0,je(br,`RPC '${e}' stream ${i} transport closed`),R.a_(),this.E_(p))}),E(p,Eo.EventType.ERROR,x=>{C||(C=!0,Qi(br,`RPC '${e}' stream ${i} transport errored. Name:`,x.name,"Message:",x.message),R.a_(new We(ke.UNAVAILABLE,"The operation could not be completed")))}),E(p,Eo.EventType.MESSAGE,x=>{if(!C){const T=x.data[0];Et(!!T,16349);const W=T,te=W?.error||W[0]?.error;if(te){je(br,`RPC '${e}' stream ${i} received error:`,te);const Q=te.status;let de=function(_){const v=er[_];if(v!==void 0)return Zf(v)}(Q),ae=te.message;de===void 0&&(de=ke.INTERNAL,ae="Unknown error status: "+Q+" with message "+te.message),C=!0,R.a_(new We(de,ae)),p.close()}else je(br,`RPC '${e}' stream ${i} received:`,T),R.u_(T)}}),E(c,vf.STAT_EVENT,x=>{x.stat===Yl.PROXY?je(br,`RPC '${e}' stream ${i} detected buffering proxy`):x.stat===Yl.NOPROXY&&je(br,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{R.__()},0),R}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function fl(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ja(t){return new CS(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class my{constructor(e,r,n=1e3,i=1.5,o=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=i,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,r-n);i>0&&je("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nh="PersistentStream";class fy{constructor(e,r,n,i,o,a,c,u){this.Mi=e,this.S_=n,this.b_=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new my(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===ke.RESOURCE_EXHAUSTED?(An(r.toString()),An("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===ke.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.D_===r&&this.G_(n,i)},n=>{e(()=>{const i=new We(ke.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{n(()=>this.z_(i))}),this.stream.onMessage(i=>{n(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return je(nh,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(je(nh,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class S1 extends fy{constructor(e,r,n,i,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=o}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=ES(this.serializer,e),n=function(o){if(!("targetChange"in o))return rt.min();const a=o.targetChange;return a.targetIds&&a.targetIds.length?rt.min():a.readTime?nn(a.readTime):rt.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=ic(this.serializer),r.addTarget=function(o,a){let c;const u=a.target;if(c=Zl(u)?{documents:$S(o,u)}:{query:kS(o,u).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=ry(o,a.resumeToken);const h=tc(o,a.expectedCount);h!==null&&(c.expectedCount=h)}else if(a.snapshotVersion.compareTo(rt.min())>0){c.readTime=Sa(o,a.snapshotVersion.toTimestamp());const h=tc(o,a.expectedCount);h!==null&&(c.expectedCount=h)}return c}(this.serializer,e);const n=DS(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=ic(this.serializer),r.removeTarget=e,this.q_(r)}}class P1 extends fy{constructor(e,r,n,i,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Et(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Et(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Et(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=TS(e.writeResults,e.commitTime),n=nn(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=ic(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>xS(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1{}class C1 extends w1{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new We(ke.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Go(e,rc(r,n),i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===ke.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new We(ke.UNKNOWN,o.toString())})}Ho(e,r,n,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Ho(e,rc(r,n),i,a,c,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ke.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new We(ke.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class A1{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(An(r),this.aa=!1):je("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wi="RemoteStore";class I1{constructor(e,r,n,i,o){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo(a=>{n.enqueueAndForget(async()=>{Ei(this)&&(je(wi,"Restarting streams for network reachability change."),await async function(u){const h=nt(u);h.Ea.add(4),await ds(h),h.Ra.set("Unknown"),h.Ea.delete(4),await za(h)}(this))})}),this.Ra=new A1(n,i)}}async function za(t){if(Ei(t))for(const e of t.da)await e(!0)}async function ds(t){for(const e of t.da)await e(!1)}function yy(t,e){const r=nt(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),Zc(r)?Xc(r):co(r).O_()&&Jc(r,e))}function Qc(t,e){const r=nt(t),n=co(r);r.Ia.delete(e),n.O_()&&gy(r,e),r.Ia.size===0&&(n.O_()?n.L_():Ei(r)&&r.Ra.set("Unknown"))}function Jc(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(rt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}co(t).Y_(e)}function gy(t,e){t.Va.Ue(e),co(t).Z_(e)}function Xc(t){t.Va=new _S({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),co(t).start(),t.Ra.ua()}function Zc(t){return Ei(t)&&!co(t).x_()&&t.Ia.size>0}function Ei(t){return nt(t).Ea.size===0}function py(t){t.Va=void 0}async function E1(t){t.Ra.set("Online")}async function x1(t){t.Ia.forEach((e,r)=>{Jc(t,e)})}async function T1(t,e){py(t),Zc(t)?(t.Ra.ha(e),Xc(t)):t.Ra.set("Unknown")}async function $1(t,e,r){if(t.Ra.set("Online"),e instanceof ty&&e.state===2&&e.cause)try{await async function(i,o){const a=o.cause;for(const c of o.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,a),i.Ia.delete(c),i.Va.removeTarget(c))}(t,e)}catch(n){je(wi,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await wa(t,n)}else if(e instanceof Js?t.Va.Ze(e):e instanceof ey?t.Va.st(e):t.Va.tt(e),!r.isEqual(rt.min()))try{const n=await hy(t.localStore);r.compareTo(n)>=0&&await function(o,a){const c=o.Va.Tt(a);return c.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const f=o.Ia.get(h);f&&o.Ia.set(h,f.withResumeToken(u.resumeToken,a))}}),c.targetMismatches.forEach((u,h)=>{const f=o.Ia.get(u);if(!f)return;o.Ia.set(u,f.withResumeToken(fr.EMPTY_BYTE_STRING,f.snapshotVersion)),gy(o,u);const p=new Vn(f.target,u,h,f.sequenceNumber);Jc(o,p)}),o.remoteSyncer.applyRemoteEvent(c)}(t,r)}catch(n){je(wi,"Failed to raise snapshot:",n),await wa(t,n)}}async function wa(t,e,r){if(!lo(e))throw e;t.Ea.add(1),await ds(t),t.Ra.set("Offline"),r||(r=()=>hy(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{je(wi,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await za(t)})}function vy(t,e){return e().catch(r=>wa(t,r,e))}async function qa(t){const e=nt(t),r=Jn(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Mc;for(;k1(e);)try{const i=await h1(e.localStore,n);if(i===null){e.Ta.length===0&&r.L_();break}n=i.batchId,R1(e,i)}catch(i){await wa(e,i)}by(e)&&_y(e)}function k1(t){return Ei(t)&&t.Ta.length<10}function R1(t,e){t.Ta.push(e);const r=Jn(t);r.O_()&&r.X_&&r.ea(e.mutations)}function by(t){return Ei(t)&&!Jn(t).x_()&&t.Ta.length>0}function _y(t){Jn(t).start()}async function D1(t){Jn(t).ra()}async function N1(t){const e=Jn(t);for(const r of t.Ta)e.ea(r.mutations)}async function L1(t,e,r){const n=t.Ta.shift(),i=zc.from(n,e,r);await vy(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await qa(t)}async function M1(t,e){e&&Jn(t).X_&&await async function(n,i){if(function(a){return pS(a)&&a!==ke.ABORTED}(i.code)){const o=n.Ta.shift();Jn(n).B_(),await vy(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,i)),await qa(n)}}(t,e),by(t)&&_y(t)}async function ih(t,e){const r=nt(t);r.asyncQueue.verifyOperationInProgress(),je(wi,"RemoteStore received new credentials");const n=Ei(r);r.Ea.add(3),await ds(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await za(r)}async function O1(t,e){const r=nt(t);e?(r.Ea.delete(2),await za(r)):e||(r.Ea.add(2),await ds(r),r.Ra.set("Unknown"))}function co(t){return t.ma||(t.ma=function(r,n,i){const o=nt(r);return o.sa(),new S1(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Xo:E1.bind(null,t),t_:x1.bind(null,t),r_:T1.bind(null,t),H_:$1.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Zc(t)?Xc(t):t.Ra.set("Unknown")):(await t.ma.stop(),py(t))})),t.ma}function Jn(t){return t.fa||(t.fa=function(r,n,i){const o=nt(r);return o.sa(),new P1(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:D1.bind(null,t),r_:M1.bind(null,t),ta:N1.bind(null,t),na:L1.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await qa(t)):(await t.fa.stop(),t.Ta.length>0&&(je(wi,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu{constructor(e,r,n,i,o){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new Wn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,o){const a=Date.now()+n,c=new eu(e,r,a,i,o);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new We(ke.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function tu(t,e){if(An("AsyncQueue",`${e}: ${t}`),lo(t))return new We(ke.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi{static emptySet(e){return new Gi(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||Je.comparator(r.key,n.key):(r,n)=>Je.comparator(r.key,n.key),this.keyedMap=xo(),this.sortedSet=new qt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Gi)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Gi;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oh{constructor(){this.ga=new qt(Je.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):Ze(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class to{constructor(e,r,n,i,o,a,c,u,h){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,r,n,i,o){const a=[];return r.forEach(c=>{a.push({type:0,doc:c})}),new to(e,r,Gi.emptySet(r),a,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Oa(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class B1{constructor(){this.queries=sh(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const i=nt(r),o=i.queries;i.queries=sh(),o.forEach((a,c)=>{for(const u of c.Sa)u.onError(n)})})(this,new We(ke.ABORTED,"Firestore shutting down"))}}function sh(){return new Ii(t=>Ff(t),Oa)}async function F1(t,e){const r=nt(t);let n=3;const i=e.query;let o=r.queries.get(i);o?!o.ba()&&e.Da()&&(n=2):(o=new V1,n=e.Da()?0:1);try{switch(n){case 0:o.wa=await r.onListen(i,!0);break;case 1:o.wa=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const c=tu(a,`Initialization of query '${Fi(e.query)}' failed`);return void e.onError(c)}r.queries.set(i,o),o.Sa.push(e),e.va(r.onlineState),o.wa&&e.Fa(o.wa)&&ru(r)}async function U1(t,e){const r=nt(t),n=e.query;let i=3;const o=r.queries.get(n);if(o){const a=o.Sa.indexOf(e);a>=0&&(o.Sa.splice(a,1),o.Sa.length===0?i=e.Da()?0:1:!o.ba()&&e.Da()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function j1(t,e){const r=nt(t);let n=!1;for(const i of e){const o=i.query,a=r.queries.get(o);if(a){for(const c of a.Sa)c.Fa(i)&&(n=!0);a.wa=i}}n&&ru(r)}function z1(t,e,r){const n=nt(t),i=n.queries.get(e);if(i)for(const o of i.Sa)o.onError(r);n.queries.delete(e)}function ru(t){t.Ca.forEach(e=>{e.next()})}var ac,ah;(ah=ac||(ac={})).Ma="default",ah.Cache="cache";class q1{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new to(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=to.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==ac.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sy{constructor(e){this.key=e}}class Py{constructor(e){this.key=e}}class H1{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ft(),this.mutatedKeys=ft(),this.eu=Uf(e),this.tu=new Gi(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new oh,i=r?r.tu:this.tu;let o=r?r.mutatedKeys:this.mutatedKeys,a=i,c=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,p)=>{const b=i.get(f),C=Va(this.query,p)?p:null,R=!!b&&this.mutatedKeys.has(b.key),E=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let x=!1;b&&C?b.data.isEqual(C.data)?R!==E&&(n.track({type:3,doc:C}),x=!0):this.su(b,C)||(n.track({type:2,doc:C}),x=!0,(u&&this.eu(C,u)>0||h&&this.eu(C,h)<0)&&(c=!0)):!b&&C?(n.track({type:0,doc:C}),x=!0):b&&!C&&(n.track({type:1,doc:b}),x=!0,(u||h)&&(c=!0)),x&&(C?(a=a.add(C),o=E?o.add(f):o.delete(f)):(a=a.delete(f),o=o.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),o=o.delete(f.key),n.track({type:1,doc:f})}return{tu:a,iu:n,Cs:c,mutatedKeys:o}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((f,p)=>function(C,R){const E=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ze(20277,{Rt:x})}};return E(C)-E(R)}(f.type,p.type)||this.eu(f.doc,p.doc)),this.ou(n),i=i??!1;const c=r&&!i?this._u():[],u=this.Xa.size===0&&this.current&&!i?1:0,h=u!==this.Za;return this.Za=u,a.length!==0||h?{snapshot:new to(this.query,e.tu,o,a,e.mutatedKeys,u===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new oh,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=ft(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new Py(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new Sy(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=ft();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return to.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const nu="SyncEngine";class W1{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class G1{constructor(e){this.key=e,this.hu=!1}}class Y1{constructor(e,r,n,i,o,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Ii(c=>Ff(c),Oa),this.Iu=new Map,this.Eu=new Set,this.du=new qt(Je.comparator),this.Au=new Map,this.Ru=new Wc,this.Vu={},this.mu=new Map,this.fu=eo.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function K1(t,e,r=!0){const n=xy(t);let i;const o=n.Tu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await wy(n,e,r,!0),i}async function Q1(t,e){const r=xy(t);await wy(r,e,!0,!1)}async function wy(t,e,r,n){const i=await m1(t.localStore,tn(e)),o=i.targetId,a=t.sharedClientState.addLocalQueryTarget(o,r);let c;return n&&(c=await J1(t,e,o,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&yy(t.remoteStore,i),c}async function J1(t,e,r,n,i){t.pu=(p,b,C)=>async function(E,x,T,W){let te=x.view.ru(T);te.Cs&&(te=await Zd(E.localStore,x.query,!1).then(({documents:I})=>x.view.ru(I,te)));const Q=W&&W.targetChanges.get(x.targetId),de=W&&W.targetMismatches.get(x.targetId)!=null,ae=x.view.applyChanges(te,E.isPrimaryClient,Q,de);return ch(E,x.targetId,ae.au),ae.snapshot}(t,p,b,C);const o=await Zd(t.localStore,e,!0),a=new H1(e,o.Qs),c=a.ru(o.documents),u=us.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),h=a.applyChanges(c,t.isPrimaryClient,u);ch(t,r,h.au);const f=new W1(e,r,a);return t.Tu.set(e,f),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),h.snapshot}async function X1(t,e,r){const n=nt(t),i=n.Tu.get(e),o=n.Iu.get(i.targetId);if(o.length>1)return n.Iu.set(i.targetId,o.filter(a=>!Oa(a,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await oc(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Qc(n.remoteStore,i.targetId),lc(n,i.targetId)}).catch(ao)):(lc(n,i.targetId),await oc(n.localStore,i.targetId,!0))}async function Z1(t,e){const r=nt(t),n=r.Tu.get(e),i=r.Iu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Qc(r.remoteStore,n.targetId))}async function eP(t,e,r){const n=aP(t);try{const i=await function(a,c){const u=nt(a),h=Bt.now(),f=c.reduce((C,R)=>C.add(R.key),ft());let p,b;return u.persistence.runTransaction("Locally write mutations","readwrite",C=>{let R=In(),E=ft();return u.Ns.getEntries(C,f).next(x=>{R=x,R.forEach((T,W)=>{W.isValidDocument()||(E=E.add(T))})}).next(()=>u.localDocuments.getOverlayedDocuments(C,R)).next(x=>{p=x;const T=[];for(const W of c){const te=hS(W,p.get(W.key).overlayedDocument);te!=null&&T.push(new ni(W.key,te,Df(te.value.mapValue),rn.exists(!0)))}return u.mutationQueue.addMutationBatch(C,h,T,c)}).next(x=>{b=x;const T=x.applyToLocalDocumentSet(p,E);return u.documentOverlayCache.saveOverlays(C,x.batchId,T)})}).then(()=>({batchId:b.batchId,changes:zf(p)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,c,u){let h=a.Vu[a.currentUser.toKey()];h||(h=new qt(mt)),h=h.insert(c,u),a.Vu[a.currentUser.toKey()]=h}(n,i.batchId,r),await hs(n,i.changes),await qa(n.remoteStore)}catch(i){const o=tu(i,"Failed to persist write");r.reject(o)}}async function Cy(t,e){const r=nt(t);try{const n=await u1(r.localStore,e);e.targetChanges.forEach((i,o)=>{const a=r.Au.get(o);a&&(Et(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?Et(a.hu,14607):i.removedDocuments.size>0&&(Et(a.hu,42227),a.hu=!1))}),await hs(r,n,e)}catch(n){await ao(n)}}function lh(t,e,r){const n=nt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Tu.forEach((o,a)=>{const c=a.view.va(e);c.snapshot&&i.push(c.snapshot)}),function(a,c){const u=nt(a);u.onlineState=c;let h=!1;u.queries.forEach((f,p)=>{for(const b of p.Sa)b.va(c)&&(h=!0)}),h&&ru(u)}(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function tP(t,e,r){const n=nt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Au.get(e),o=i&&i.key;if(o){let a=new qt(Je.comparator);a=a.insert(o,Pr.newNoDocument(o,rt.min()));const c=ft().add(o),u=new Ua(rt.min(),new Map,new qt(mt),a,c);await Cy(n,u),n.du=n.du.remove(o),n.Au.delete(e),iu(n)}else await oc(n.localStore,e,!1).then(()=>lc(n,e,r)).catch(ao)}async function rP(t,e){const r=nt(t),n=e.batch.batchId;try{const i=await c1(r.localStore,e);Iy(r,n,null),Ay(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await hs(r,i)}catch(i){await ao(i)}}async function nP(t,e,r){const n=nt(t);try{const i=await function(a,c){const u=nt(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let f;return u.mutationQueue.lookupMutationBatch(h,c).next(p=>(Et(p!==null,37113),f=p.keys(),u.mutationQueue.removeMutationBatch(h,p))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,f,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f)).next(()=>u.localDocuments.getDocuments(h,f))})}(n.localStore,e);Iy(n,e,r),Ay(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await hs(n,i)}catch(i){await ao(i)}}function Ay(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function Iy(t,e,r){const n=nt(t);let i=n.Vu[n.currentUser.toKey()];if(i){const o=i.get(e);o&&(r?o.reject(r):o.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function lc(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||Ey(t,n)})}function Ey(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(Qc(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),iu(t))}function ch(t,e,r){for(const n of r)n instanceof Sy?(t.Ru.addReference(n.key,e),iP(t,n)):n instanceof Py?(je(nu,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||Ey(t,n.key)):Ze(19791,{wu:n})}function iP(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(je(nu,"New document in limbo: "+r),t.Eu.add(n),iu(t))}function iu(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new Je(zt.fromString(e)),n=t.fu.next();t.Au.set(n,new G1(r)),t.du=t.du.insert(r,n),yy(t.remoteStore,new Vn(tn(Uc(r.path)),n,"TargetPurposeLimboResolution",Da.ce))}}async function hs(t,e,r){const n=nt(t),i=[],o=[],a=[];n.Tu.isEmpty()||(n.Tu.forEach((c,u)=>{a.push(n.pu(u,e,r).then(h=>{if((h||r)&&n.isPrimaryClient){const f=h?!h.fromCache:r?.targetChanges.get(u.targetId)?.current;n.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(h){i.push(h);const f=Yc.As(u.targetId,h);o.push(f)}}))}),await Promise.all(a),n.Pu.H_(i),await async function(u,h){const f=nt(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>Ee.forEach(h,b=>Ee.forEach(b.Es,C=>f.persistence.referenceDelegate.addReference(p,b.targetId,C)).next(()=>Ee.forEach(b.ds,C=>f.persistence.referenceDelegate.removeReference(p,b.targetId,C)))))}catch(p){if(!lo(p))throw p;je(Kc,"Failed to update sequence numbers: "+p)}for(const p of h){const b=p.targetId;if(!p.fromCache){const C=f.Ms.get(b),R=C.snapshotVersion,E=C.withLastLimboFreeSnapshotVersion(R);f.Ms=f.Ms.insert(b,E)}}}(n.localStore,o))}async function oP(t,e){const r=nt(t);if(!r.currentUser.isEqual(e)){je(nu,"User change. New user:",e.toKey());const n=await dy(r.localStore,e);r.currentUser=e,function(o,a){o.mu.forEach(c=>{c.forEach(u=>{u.reject(new We(ke.CANCELLED,a))})}),o.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await hs(r,n.Ls)}}function sP(t,e){const r=nt(t),n=r.Au.get(e);if(n&&n.hu)return ft().add(n.key);{let i=ft();const o=r.Iu.get(e);if(!o)return i;for(const a of o){const c=r.Tu.get(a);i=i.unionWith(c.view.nu)}return i}}function xy(t){const e=nt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Cy.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=sP.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=tP.bind(null,e),e.Pu.H_=j1.bind(null,e.eventManager),e.Pu.yu=z1.bind(null,e.eventManager),e}function aP(t){const e=nt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=rP.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=nP.bind(null,e),e}class Ca{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ja(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return l1(this.persistence,new o1,e.initialUser,this.serializer)}Cu(e){return new uy(Gc.mi,this.serializer)}Du(e){return new y1}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ca.provider={build:()=>new Ca};class lP extends Ca{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Et(this.persistence.referenceDelegate instanceof Pa,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new qS(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?xr.withCacheSize(this.cacheSizeBytes):xr.DEFAULT;return new uy(n=>Pa.mi(n,r),this.serializer)}}class cc{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>lh(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=oP.bind(null,this.syncEngine),await O1(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new B1}()}createDatastore(e){const r=ja(e.databaseInfo.databaseId),n=function(o){return new _1(o)}(e.databaseInfo);return function(o,a,c,u){return new C1(o,a,c,u)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,o,a,c){return new I1(n,i,o,a,c)}(this.localStore,this.datastore,e.asyncQueue,r=>lh(this.syncEngine,r,0),function(){return rh.v()?new rh:new g1}())}createSyncEngine(e,r){return function(i,o,a,c,u,h,f){const p=new Y1(i,o,a,c,u,h);return f&&(p.gu=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await async function(r){const n=nt(r);je(wi,"RemoteStore shutting down."),n.Ea.add(5),await ds(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}cc.provider={build:()=>new cc};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cP{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):An("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xn="FirestoreClient";class uP{constructor(e,r,n,i,o){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Sr.UNAUTHENTICATED,this.clientId=Nc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,async a=>{je(Xn,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(je(Xn,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Wn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=tu(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function yl(t,e){t.asyncQueue.verifyOperationInProgress(),je(Xn,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await dy(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function uh(t,e){t.asyncQueue.verifyOperationInProgress();const r=await dP(t);je(Xn,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>ih(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>ih(e.remoteStore,i)),t._onlineComponents=e}async function dP(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){je(Xn,"Using user provided OfflineComponentProvider");try{await yl(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===ke.FAILED_PRECONDITION||i.code===ke.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Qi("Error using user provided cache. Falling back to memory cache: "+r),await yl(t,new Ca)}}else je(Xn,"Using default OfflineComponentProvider"),await yl(t,new lP(void 0));return t._offlineComponents}async function Ty(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(je(Xn,"Using user provided OnlineComponentProvider"),await uh(t,t._uninitializedComponentsProvider._online)):(je(Xn,"Using default OnlineComponentProvider"),await uh(t,new cc))),t._onlineComponents}function hP(t){return Ty(t).then(e=>e.syncEngine)}async function mP(t){const e=await Ty(t),r=e.eventManager;return r.onListen=K1.bind(null,e.syncEngine),r.onUnlisten=X1.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=Q1.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=Z1.bind(null,e.syncEngine),r}function fP(t,e,r={}){const n=new Wn;return t.asyncQueue.enqueueAndForget(async()=>function(o,a,c,u,h){const f=new cP({next:b=>{f.Nu(),a.enqueueAndForget(()=>U1(o,p));const C=b.docs.has(c);!C&&b.fromCache?h.reject(new We(ke.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&b.fromCache&&u&&u.source==="server"?h.reject(new We(ke.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(b)},error:b=>h.reject(b)}),p=new q1(Uc(c.path),f,{includeMetadataChanges:!0,qa:!0});return F1(o,p)}(await mP(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $y(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dh=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ky="firestore.googleapis.com",hh=!0;class mh{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new We(ke.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=ky,this.ssl=hh}else this.host=e.host,this.ssl=e.ssl??hh;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=cy;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<jS)throw new We(ke.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}A_("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=$y(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new We(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new We(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new We(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ou{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new mh({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new We(ke.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new We(ke.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new mh(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new f_;switch(n.type){case"firstParty":return new v_(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new We(ke.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=dh.get(r);n&&(je("ComponentProvider","Removing Datastore"),dh.delete(r),n.terminate())}(this),Promise.resolve()}}function yP(t,e,r,n={}){t=Pi(t,ou);const i=no(e),o=t._getSettings(),a={...o,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${r}`;i&&(Im(`https://${c}`),Em("Firestore",!0)),o.host!==ky&&o.host!==c&&Qi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...o,host:c,ssl:i,emulatorOptions:n};if(!vi(u,a)&&(t._setSettings(u),n.mockUserToken)){let h,f;if(typeof n.mockUserToken=="string")h=n.mockUserToken,f=Sr.MOCK_USER;else{h=Vp(n.mockUserToken,t._app?.options.projectId);const p=n.mockUserToken.sub||n.mockUserToken.user_id;if(!p)throw new We(ke.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Sr(p)}t._authCredentials=new y_(new Pf(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new su(this.firestore,e,this._query)}}class or{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new es(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new or(this.firestore,e,this._key)}toJSON(){return{type:or._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(ls(r,or._jsonSchema))return new or(e,n||null,new Je(zt.fromString(r.referencePath)))}}or._jsonSchemaVersion="firestore/documentReference/1.0",or._jsonSchema={type:tr("string",or._jsonSchemaVersion),referencePath:tr("string")};class es extends su{constructor(e,r,n){super(e,r,Uc(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new or(this.firestore,null,new Je(e))}withConverter(e){return new es(this.firestore,e,this._path)}}function gP(t,e,...r){if(t=Er(t),arguments.length===1&&(e=Nc.newId()),C_("doc","path",e),t instanceof ou){const n=zt.fromString(e,...r);return Ed(n),new or(t,null,new Je(n))}{if(!(t instanceof or||t instanceof es))throw new We(ke.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(zt.fromString(e,...r));return Ed(n),new or(t.firestore,t instanceof es?t.converter:null,new Je(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fh="AsyncQueue";class yh{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new my(this,"async_queue_retry"),this._c=()=>{const n=fl();n&&je(fh,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=fl();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=fl();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new Wn;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!lo(e))throw e;je(fh,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,An("INTERNAL UNHANDLED ERROR: ",gh(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const i=eu.createAndSchedule(this,e,r,n,o=>this.hc(o));return this.tc.push(i),i}uc(){this.nc&&Ze(47125,{Pc:gh(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function gh(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Ha extends ou{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new yh,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new yh(e),this._firestoreClient=void 0,await e}}}function pP(t,e){const r=typeof t=="object"?t:km(),n=typeof t=="string"?t:ya,i=Pc(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const o=Mp("firestore");o&&yP(i,...o)}return i}function Ry(t){if(t._terminated)throw new We(ke.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||vP(t),t._firestoreClient}function vP(t){const e=t._freezeSettings(),r=function(i,o,a,c){return new M_(i,o,a,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,$y(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)}(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new uP(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(i){const o=i?._online.build();return{_offline:i?._offline.build(o),_online:o}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Vr(fr.fromBase64String(e))}catch(r){throw new We(ke.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Vr(fr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Vr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ls(e,Vr._jsonSchema))return Vr.fromBase64String(e.bytes)}}Vr._jsonSchemaVersion="firestore/bytes/1.0",Vr._jsonSchema={type:tr("string",Vr._jsonSchemaVersion),bytes:tr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new We(ke.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new hr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class au{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new We(ke.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new We(ke.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return mt(this._lat,e._lat)||mt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:on._jsonSchemaVersion}}static fromJSON(e){if(ls(e,on._jsonSchema))return new on(e.latitude,e.longitude)}}on._jsonSchemaVersion="firestore/geoPoint/1.0",on._jsonSchema={type:tr("string",on._jsonSchemaVersion),latitude:tr("number"),longitude:tr("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==i[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:sn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ls(e,sn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new sn(e.vectorValues);throw new We(ke.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}sn._jsonSchemaVersion="firestore/vectorValue/1.0",sn._jsonSchema={type:tr("string",sn._jsonSchemaVersion),vectorValues:tr("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bP=/^__.*__$/;class _P{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new ni(e,this.data,this.fieldMask,r,this.fieldTransforms):new cs(e,this.data,r,this.fieldTransforms)}}class Dy{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new ni(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function Ny(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ze(40011,{Ac:t})}}class lu{constructor(e,r,n,i,o,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new lu({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Aa(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Ny(this.Ac)&&bP.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class SP{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||ja(e)}Cc(e,r,n,i=!1){return new lu({Ac:e,methodName:r,Dc:n,path:hr.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ly(t){const e=t._freezeSettings(),r=ja(t._databaseId);return new SP(t._databaseId,!!e.ignoreUndefinedProperties,r)}function PP(t,e,r,n,i,o={}){const a=t.Cc(o.merge||o.mergeFields?2:0,e,r,i);cu("Data must be an object, but it was:",a,n);const c=My(n,a);let u,h;if(o.merge)u=new Dr(a.fieldMask),h=a.fieldTransforms;else if(o.mergeFields){const f=[];for(const p of o.mergeFields){const b=uc(e,p,r);if(!a.contains(b))throw new We(ke.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);Vy(f,b)||f.push(b)}u=new Dr(f),h=a.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,h=a.fieldTransforms;return new _P(new Tr(c),u,h)}class Ga extends au{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ga}}function wP(t,e,r,n){const i=t.Cc(1,e,r);cu("Data must be an object, but it was:",i,n);const o=[],a=Tr.empty();ri(n,(u,h)=>{const f=uu(e,u,r);h=Er(h);const p=i.yc(f);if(h instanceof Ga)o.push(f);else{const b=Ya(h,p);b!=null&&(o.push(f),a.set(f,b))}});const c=new Dr(o);return new Dy(a,c,i.fieldTransforms)}function CP(t,e,r,n,i,o){const a=t.Cc(1,e,r),c=[uc(e,n,r)],u=[i];if(o.length%2!=0)throw new We(ke.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let b=0;b<o.length;b+=2)c.push(uc(e,o[b])),u.push(o[b+1]);const h=[],f=Tr.empty();for(let b=c.length-1;b>=0;--b)if(!Vy(h,c[b])){const C=c[b];let R=u[b];R=Er(R);const E=a.yc(C);if(R instanceof Ga)h.push(C);else{const x=Ya(R,E);x!=null&&(h.push(C),f.set(C,x))}}const p=new Dr(h);return new Dy(f,p,a.fieldTransforms)}function Ya(t,e){if(Oy(t=Er(t)))return cu("Unsupported field value:",e,t),My(t,e);if(t instanceof au)return function(n,i){if(!Ny(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,i){const o=[];let a=0;for(const c of n){let u=Ya(c,i.wc(a));u==null&&(u={nullValue:"NULL_VALUE"}),o.push(u),a++}return{arrayValue:{values:o}}}(t,e)}return function(n,i){if((n=Er(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return sS(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=Bt.fromDate(n);return{timestampValue:Sa(i.serializer,o)}}if(n instanceof Bt){const o=new Bt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Sa(i.serializer,o)}}if(n instanceof on)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Vr)return{bytesValue:ry(i.serializer,n._byteString)};if(n instanceof or){const o=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(o))throw i.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Hc(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof sn)return function(a,c){return{mapValue:{fields:{[kf]:{stringValue:Rf},[ga]:{arrayValue:{values:a.toArray().map(h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return jc(c.serializer,h)})}}}}}}(n,i);throw i.Sc(`Unsupported field value: ${Lc(n)}`)}(t,e)}function My(t,e){const r={};return Af(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ri(t,(n,i)=>{const o=Ya(i,e.mc(n));o!=null&&(r[n]=o)}),{mapValue:{fields:r}}}function Oy(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Bt||t instanceof on||t instanceof Vr||t instanceof or||t instanceof au||t instanceof sn)}function cu(t,e,r){if(!Oy(r)||!wf(r)){const n=Lc(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function uc(t,e,r){if((e=Er(e))instanceof Wa)return e._internalPath;if(typeof e=="string")return uu(t,e);throw Aa("Field path arguments must be of type string or ",t,!1,void 0,r)}const AP=new RegExp("[~\\*/\\[\\]]");function uu(t,e,r){if(e.search(AP)>=0)throw Aa(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Wa(...e.split("."))._internalPath}catch{throw Aa(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Aa(t,e,r,n,i){const o=n&&!n.isEmpty(),a=i!==void 0;let c=`Function ${e}() called with invalid data`;r&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(o||a)&&(u+=" (found",o&&(u+=` in field ${n}`),a&&(u+=` in document ${i}`),u+=")"),new We(ke.INVALID_ARGUMENT,c+t+u)}function Vy(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class By{constructor(e,r,n,i,o){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new or(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new IP(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Fy("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class IP extends By{data(){return super.data()}}function Fy(t,e){return typeof e=="string"?uu(t,e):e instanceof Wa?e._internalPath:e._delegate._internalPath}class EP{convertValue(e,r="none"){switch(Qn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Kt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Kn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Ze(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return ri(e,(i,o)=>{n[i]=this.convertValue(o,r)}),n}convertVectorValue(e){const r=e.fields?.[ga].arrayValue?.values?.map(n=>Kt(n.doubleValue));return new sn(r)}convertGeoPoint(e){return new on(Kt(e.latitude),Kt(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=La(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Ko(e));default:return null}}convertTimestamp(e){const r=Yn(e);return new Bt(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=zt.fromString(e);Et(ly(n),9688,{name:e});const i=new Qo(n.get(1),n.get(3)),o=new Je(n.popFirst(5));return i.isEqual(r)||An(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xP(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class $o{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class pi extends By{constructor(e,r,n,i,o,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Xs(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Fy("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new We(ke.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=pi._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}pi._jsonSchemaVersion="firestore/documentSnapshot/1.0",pi._jsonSchema={type:tr("string",pi._jsonSchemaVersion),bundleSource:tr("string","DocumentSnapshot"),bundleName:tr("string"),bundle:tr("string")};class Xs extends pi{data(e={}){return super.data(e)}}class Fo{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new $o(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Xs(this._firestore,this._userDataWriter,n.key,n,new $o(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new We(ke.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(c=>{const u=new Xs(i._firestore,i._userDataWriter,c.doc.key,c.doc,new $o(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>o||c.type!==3).map(c=>{const u=new Xs(i._firestore,i._userDataWriter,c.doc.key,c.doc,new $o(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,f=-1;return c.type!==0&&(h=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),f=a.indexOf(c.doc.key)),{type:TP(c.type),doc:u,oldIndex:h,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new We(ke.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Fo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Nc.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(r.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function TP(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ze(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $P(t){t=Pi(t,or);const e=Pi(t.firestore,Ha);return fP(Ry(e),t._key).then(r=>NP(e,t,r))}Fo._jsonSchemaVersion="firestore/querySnapshot/1.0",Fo._jsonSchema={type:tr("string",Fo._jsonSchemaVersion),bundleSource:tr("string","QuerySnapshot"),bundleName:tr("string"),bundle:tr("string")};class kP extends EP{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vr(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new or(this.firestore,null,r)}}function RP(t,e,r){t=Pi(t,or);const n=Pi(t.firestore,Ha),i=xP(t.converter,e);return Uy(n,[PP(Ly(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,rn.none())])}function DP(t,e,r,...n){t=Pi(t,or);const i=Pi(t.firestore,Ha),o=Ly(i);let a;return a=typeof(e=Er(e))=="string"||e instanceof Wa?CP(o,"updateDoc",t._key,e,r,n):wP(o,"updateDoc",t._key,e),Uy(i,[a.toMutation(t._key,rn.exists(!0))])}function Uy(t,e){return function(n,i){const o=new Wn;return n.asyncQueue.enqueueAndForget(async()=>eP(await hP(n),i,o)),o.promise}(Ry(t),e)}function NP(t,e,r){const n=r.docs.get(e._key),i=new kP(t);return new pi(t,i,e._key,n,new $o(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){so=i})(io),Yi(new bi("firestore",(n,{instanceIdentifier:i,options:o})=>{const a=n.getProvider("app").getImmediate(),c=new Ha(new g_(n.getProvider("auth-internal")),new b_(a,n.getProvider("app-check-internal")),function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new We(ke.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Qo(h.options.projectId,f)}(a,i),a);return o={useFetchStreams:r,...o},c._setSettings(o),c},"PUBLIC").setMultipleInstances(!0)),zn(wd,Cd,e),zn(wd,Cd,"esm2020")})();let LP="eyAiYXBpS2V5IjogIkFJemFTeUJBbGN2WlRMMXRsQ05LRExENEJpTWJhR01iTnhCRjQtTSIsICAiYXV0aERvbWFpbiI6ICJocm0tMTEyOC5maXJlYmFzZWFwcC5jb20iLCAgImRhdGFiYXNlVVJMIjogImh0dHBzOi8vaHJtLTExMjguZmlyZWJhc2Vpby5jb20iLCAgInByb2plY3RJZCI6ICJocm0tMTEyOCIsICAic3RvcmFnZUJ1Y2tldCI6ICJocm0tMTEyOC5hcHBzcG90LmNvbSIsICAibWVzc2FnaW5nU2VuZGVySWQiOiAiMTA0OTI1MDU4NTI0NSIsICAiYXBwSWQiOiAiMToxMDQ5MjUwNTg1MjQ1OndlYjowZGFkMDAyMDI3MjM1MTRjY2M1Mjc0In0=";const jy=$m(JSON.parse(Cp(LP))),mi=u_(jy),Ia=new Zr,MP=pP(jy);Ia.addScope("profile");Ia.addScope("email");class ko extends Error{}ko.prototype.name="InvalidTokenError";function OP(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function VP(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return OP(e)}catch{return atob(e)}}function BP(t,e){if(typeof t!="string")throw new ko("Invalid token specified: must be a string");e||(e={});const r=e.header===!0?0:1,n=t.split(".")[r];if(typeof n!="string")throw new ko(`Invalid token specified: missing part #${r+1}`);let i;try{i=VP(n)}catch(o){throw new ko(`Invalid token specified: invalid base64 for part #${r+1} (${o.message})`)}try{return JSON.parse(i)}catch(o){throw new ko(`Invalid token specified: invalid json for part #${r+1} (${o.message})`)}}const FP={clientId:"195275085181-8ccjpgp8v1g80qhnlk6v4lpgid7n81gr.apps.googleusercontent.com"},UP=t=>{const e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.onload=()=>{window.google&&window.google.accounts.id.initialize({client_id:FP.clientId,callback:r=>{t(r.credential)},auto_select:!1,cancel_on_tap_outside:!0})},document.head.appendChild(e)},jP=t=>BP(t),zP=()=>{window.google&&window.google.accounts.id.disableAutoSelect()},[qP,HP]=vm({}),WP=async()=>{const e=await Bn({query:"qcm42351987"});if(e&&!e.error){let n=Object.assign({},{},e);HP(n)}return 1},GP=async t=>{let e=qP?.[992002];e&&(e.params={tkn:t},await Bn(e))},[Li,_r]=vm({user:null,loading:!0,error:null,authMethod:null}),[zy,ph]=ye(null);Jb(mi,t=>{t?_r({user:t,loading:!1,error:null,authMethod:"firebase"}):zy()||_r({user:null,loading:!1,error:null,authMethod:null})});I0(mi).then(t=>{t&&_r({user:t.user,loading:!1,error:null,authMethod:"firebase"})}).catch(t=>{console.error("Redirect sign-in error:",t),_r({loading:!1,error:t.message})});const $t={get state(){return Li},async getUserProfile(t){try{const e=gP(MP,"users",t),r=await $P(e);if(r.exists()){_r("profile",r.data());let n={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1},i=r.data(),o={};return Object.keys(n).map(a=>{let c=n?.[a];i.hasOwnProperty(a)||(o[a]=c)}),Object.keys(o).length>0&&DP(e,o),r.data()}else{let n=$t?.state?.user,i={uid:n?.uid,email:n?.email,displayName:n?.displayName,createdAt:new Date,stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1};return await RP(e,i),console.log("No such user profile!"),null}}catch(e){return console.error("Error fetching user profile:",e),null}},hasPermission:t=>{const e=$t.state?.profile;return e.isAdmin?!0:e?e[t]===!0:!1},async signInWithGoogle(){try{_r("loading",!0),_r("error",null);try{const t=await v0(mi,Ia);_r({user:t.user,loading:!1,error:null,authMethod:"firebase"});try{$t.getUserProfile(t.user.uid)}catch(e){console.error("firestore error:",e)}}catch(t){if(t.code==="auth/popup-blocked")await C0(mi,Ia);else throw t}}catch(t){console.error("Sign-in error:",t),_r({loading:!1,error:t.message||"Failed to sign in with Google"})}},async signInWithGoogleP(t){const r=await Bn({params:{id_token:t},query:"getGoogleUserbyToken"});if(r&&r){let n=new Date().getTime(),i=new Date(n+6e4*60*24*365),o="hrm_tkn_acc";document.cookie=`${o}=${r.data}; expires=${i}; path=/;g_state = {"i_l":1,"i_p":${i}}; ssgl_access_tkn = ${t}`,document.cookie=`ssgl_access_tkn = ${t}; expires=${i};`,await WP(),GP(r.data)}},async signInWithGoogleCloud(t){try{_r("loading",!0),_r("error",null);const e=jP(t),r={uid:e.sub,email:e.email,displayName:e.name,photoURL:e.picture};ph(r);const n={uid:r.uid,email:r.email,displayName:r.displayName,photoURL:r.photoURL,emailVerified:!0};_r({user:n,loading:!1,error:null,authMethod:"google-cloud"});try{const i=Zr.credential(t);await Yb(mi,i)}catch{console.log("Firebase sign-in optional, continuing with Google Cloud auth")}}catch(e){console.error("Google Cloud sign-in error:",e),_r({loading:!1,error:e.message||"Failed to sign in with Google Cloud"})}},async signOut(){try{_r("loading",!0),(Li.authMethod==="firebase"||mi.currentUser)&&await Xb(mi),Li.authMethod==="google-cloud"&&(zP(),ph(null)),_r({user:null,loading:!1,error:null,authMethod:null})}catch(t){console.error("Sign-out error:",t),_r({loading:!1,error:t.message||"Failed to sign out"})}},get isAuthenticated(){return!!Li.user||!!zy()},get currentUser(){return Li.user},get authMethod(){return Li.authMethod}};var YP=H("<p>"),KP=H('<div><div><div><h1>HRM Finance</h1><p>Complete Business Management Solution</p><div><div><button><svg width=24 height=24 viewBox="0 0 24 24"><path fill=#4285F4 d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"></path><path fill=#34A853 d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"></path><path fill=#FBBC05 d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"></path><path fill=#EA4335 d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"></path></svg></button><p>Firebase Authentication</p></div></div></div><div><div><div>💰</div><h3>Financial Management</h3><p>Complete chart of accounts, balance sheets, journal entries, and invoice management in one place.</p></div><div><div>👥</div><h3>HR Management</h3><p>Track employees, manage onboarding, and monitor your workforce with powerful analytics.</p></div><div><div>📦</div><h3>Inventory Control</h3><p>Real-time inventory tracking, product management, and movement history across multiple locations.</p></div><div><div>🏦</div><h3>Banking Integration</h3><p>Streamline bank reconciliation with CSV imports and automated consolidation features.</p></div><div><div>📊</div><h3>Real-time Analytics</h3><p>Get instant insights with dashboards showing revenue, cash flow, and business performance.</p></div><div><div>🌐</div><h3>Multi-language Support</h3><p>Available in multiple languages to support your global business operations.</p></div></div><div><p>Secure authentication powered by Google • Your data is encrypted and protected</p><p>Choose your preferred authentication method above');const QP=()=>{un(()=>{UP(x=>{$t.signInWithGoogleP(x)}),setTimeout(()=>{},100)});const t={"min-height":"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},e={background:"white","border-radius":"1rem","box-shadow":"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","max-width":"1200px",width:"100%",overflow:"hidden"},r={padding:"3rem","text-align":"center","border-bottom":"1px solid #e2e8f0"},n={"font-size":"2.5rem","font-weight":"800",color:"#1a202c","margin-bottom":"1rem"},i={"font-size":"1.125rem",color:"#718096","margin-bottom":"2rem"},o={display:"flex","flex-direction":"column",gap:"1rem","align-items":"center","margin-bottom":"1rem"},a={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"2rem",padding:"3rem"},c={"text-align":"center",padding:"2rem","border-radius":"0.5rem",background:"#f7fafc",transition:"transform 0.2s",cursor:"default"},u={"font-size":"3rem","margin-bottom":"1rem"},h={"font-size":"1.25rem","font-weight":"600",color:"#2d3748","margin-bottom":"0.5rem"},f={color:"#718096","line-height":"1.6"},p={display:"inline-flex","align-items":"center",gap:"0.75rem",background:"white",color:"#4285f4",border:"2px solid #4285f4",padding:"0.75rem 2rem","font-size":"1.125rem","font-weight":"500","border-radius":"0.5rem",cursor:"pointer",transition:"all 0.2s","min-width":"250px","justify-content":"center"},b={color:"#e53e3e","margin-top":"1rem","font-size":"0.875rem"},C={background:"#f7fafc",padding:"2rem","text-align":"center",color:"#718096","font-size":"0.875rem"},R={"font-size":"0.75rem",color:"#718096","margin-top":"0.25rem","font-style":"italic"},E=()=>{$t.signInWithGoogle()};return(()=>{var x=KP(),T=x.firstChild,W=T.firstChild,te=W.firstChild,Q=te.nextSibling,de=Q.nextSibling,ae=de.firstChild,I=ae.firstChild;I.firstChild;var _=I.nextSibling,v=W.nextSibling,P=v.firstChild,w=P.firstChild,A=w.nextSibling,y=A.nextSibling,he=P.nextSibling,G=he.firstChild,k=G.nextSibling,Z=k.nextSibling,U=he.nextSibling,F=U.firstChild,N=F.nextSibling,V=N.nextSibling,fe=U.nextSibling,z=fe.firstChild,ge=z.nextSibling,$=ge.nextSibling,O=fe.nextSibling,X=O.firstChild,Y=X.nextSibling,ue=Y.nextSibling,re=O.nextSibling,M=re.firstChild,oe=M.nextSibling,pe=oe.nextSibling,be=v.nextSibling,ne=be.firstChild,le=ne.nextSibling;return d(x,t),d(T,e),d(W,r),d(te,n),d(Q,i),d(de,o),I.addEventListener("mouseleave",j=>{j.currentTarget.style.background="white",j.currentTarget.style.color="#4285f4"}),I.addEventListener("mouseenter",j=>{j.currentTarget.style.background="#4285f4",j.currentTarget.style.color="white"}),I.$$click=E,d(I,p),s(I,S(Ve,{get when(){return $t.state.loading},fallback:"Sign in with Google",children:"Signing in..."}),null),d(_,R),s(W,S(Ve,{get when(){return $t.state.error},get children(){var j=YP();return d(j,b),s(j,()=>$t.state.error),j}}),null),d(v,a),d(be,C),le.style.setProperty("margin-top","0.5rem"),le.style.setProperty("font-size","0.75rem"),se(j=>{var ce=$t.state.loading,D=c,J=u,ee=h,q=f,B=c,_e=u,we=h,ie=f,ve=c,K=u,Pe=h,Te=f,xe=c,$e=u,Oe=h,Qe=f,Ue=c,Ie=u,Me=h,qe=f,He=c,Ge=u,Ae=h,ot=f;return ce!==j.e&&(I.disabled=j.e=ce),j.t=d(P,D,j.t),j.a=d(w,J,j.a),j.o=d(A,ee,j.o),j.i=d(y,q,j.i),j.n=d(he,B,j.n),j.s=d(G,_e,j.s),j.h=d(k,we,j.h),j.r=d(Z,ie,j.r),j.d=d(U,ve,j.d),j.l=d(F,K,j.l),j.u=d(N,Pe,j.u),j.c=d(V,Te,j.c),j.w=d(fe,xe,j.w),j.m=d(z,$e,j.m),j.f=d(ge,Oe,j.f),j.y=d($,Qe,j.y),j.g=d(O,Ue,j.g),j.p=d(X,Ie,j.p),j.b=d(Y,Me,j.b),j.T=d(ue,qe,j.T),j.A=d(re,He,j.A),j.O=d(M,Ge,j.O),j.I=d(oe,Ae,j.I),j.S=d(pe,ot,j.S),j},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0}),x})()};wt(["click"]);var JP=H("<div><div>");const XP=t=>{const e={"min-height":"100vh",display:"flex","align-items":"center","justify-content":"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},r={width:"50px",height:"50px",border:"3px solid rgba(255, 255, 255, 0.3)","border-top-color":"white","border-radius":"50%",animation:"spin 1s linear infinite"},n=document.createElement("style");return n.textContent=`
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  `,document.head.appendChild(n),ei(()=>{$t.state?.user?.uid&&$t.getUserProfile($t.state?.user?.uid)}),un(()=>{}),S(Ve,{get when(){return!$t.state.loading},get fallback(){return(()=>{var i=JP(),o=i.firstChild;return d(i,e),d(o,r),i})()},get children(){return S(Ve,{get when(){return $t.isAuthenticated},get fallback(){return S(QP,{})},get children(){return t.children}})}})};var ZP=H("<button>");const De=t=>{const e=()=>{const r={"font-family":"inherit",cursor:t.disabled?"not-allowed":"pointer",border:"none","border-radius":"var(--border-radius-sm)","font-weight":"500",transition:"all 0.2s ease","text-decoration":"none",display:"inline-flex","align-items":"center","justify-content":"center",gap:"0.5rem",opacity:t.disabled?"0.6":"1"},n={sm:{padding:"0.5rem 1rem","font-size":"0.875rem"},md:{padding:"0.75rem 1.5rem","font-size":"1rem"},lg:{padding:"1rem 2rem","font-size":"1.125rem"}},i={primary:{background:"linear-gradient(135deg, var(--primary-color), var(--primary-dark))",color:"white","box-shadow":"var(--shadow-sm)"},secondary:{background:"var(--surface-color)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},outline:{background:"transparent",color:"var(--primary-color)",border:"1px solid var(--primary-color)"}};return{...r,...n[t.size||"md"],...i[t.variant||"primary"]}};return(()=>{var r=ZP();return Ci(r,"click",t.onClick,!0),s(r,()=>t.children),se(n=>{var i=e(),o=t.disabled,a=t.type||"button",c=`btn btn-${t.variant||"primary"} ${t.className||""}`;return n.e=d(r,i,n.e),o!==n.t&&(r.disabled=n.t=o),a!==n.a&&ct(r,"type",n.a=a),c!==n.o&&gc(r,n.o=c),n},{e:void 0,t:void 0,a:void 0,o:void 0}),r})()};wt(["click"]);var ew=H("<div><div><div><h2></h2><button>×</button></div><div>");const yr=t=>{const e={position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","z-index":"1000"},r={background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)","max-width":"920px",width:"90%","max-height":"80vh",overflow:"auto",position:"relative"},n={padding:"1.5rem","border-bottom":"1px solid var(--border-color)",display:"flex","justify-content":"space-between","align-items":"center"},i={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},o={background:"none",border:"none","font-size":"1.5rem",cursor:"pointer",color:"var(--text-muted)",padding:"0.5rem","border-radius":"var(--border-radius-sm)"},a={padding:"1.5rem"},c=u=>{u.target===u.currentTarget&&t.onClose()};return S(Ve,{get when(){return t.isOpen},get children(){var u=ew(),h=u.firstChild,f=h.firstChild,p=f.firstChild,b=p.nextSibling,C=f.nextSibling;return u.$$click=c,d(f,n),d(p,i),s(p,()=>t.title),b.addEventListener("mouseleave",R=>R.target.style.background="none"),b.addEventListener("mouseenter",R=>R.target.style.background="var(--background-color)"),Ci(b,"click",t.onClose,!0),d(b,o),d(C,a),s(C,()=>t.children),se(R=>{var E=e,x=r;return R.e=d(u,E,R.e),R.t=d(h,x,R.t),R},{e:void 0,t:void 0}),u}})};wt(["click"]);var vh=H("<div>"),tw=H("<h3>"),rw=H("<p>");const Ke=t=>{const e={background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"1.5rem","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",transition:"all 0.2s ease",cursor:t.onClick?"pointer":"default"},r={"margin-bottom":"1rem"},n={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0 0 0.5rem 0"},i={"font-size":"0.875rem",color:"var(--text-muted)",margin:"0"};return(()=>{var o=vh();return Ci(o,"click",t.onClick,!0),s(o,(()=>{var a=me(()=>!!(t.title||t.subtitle));return()=>a()&&(()=>{var c=vh();return d(c,r),s(c,(()=>{var u=me(()=>!!t.title);return()=>u()&&(()=>{var h=tw();return d(h,n),s(h,()=>t.title),h})()})(),null),s(c,(()=>{var u=me(()=>!!t.subtitle);return()=>u()&&(()=>{var h=rw();return d(h,i),s(h,()=>t.subtitle),h})()})(),null),c})()})(),null),s(o,()=>t.children,null),se(a=>{var c=e,u=`card ${t.className||""}`;return a.e=d(o,c,a.e),u!==a.t&&gc(o,a.t=u),a},{e:void 0,t:void 0}),o})()};wt(["click"]);var nw=H("<div><label></label><input>"),iw=H("<span>*");const Pt=t=>{const e={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},r={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},n={"margin-bottom":"1rem"};return(()=>{var i=nw(),o=i.firstChild,a=o.nextSibling;return d(i,n),d(o,e),s(o,()=>t.label,null),s(o,(()=>{var c=me(()=>!!t.required);return()=>c()&&(()=>{var u=iw();return u.style.setProperty("color","var(--primary-color)"),u})()})(),null),a.addEventListener("blur",c=>c.target.style.borderColor="var(--border-color)"),a.addEventListener("focus",c=>c.target.style.borderColor="var(--primary-color)"),a.$$input=c=>t.onChange(c.target.value),d(a,r),se(c=>{var u=t.type||"text",h=t.placeholder,f=t.required,p=t.disabled;return u!==c.e&&ct(a,"type",c.e=u),h!==c.t&&ct(a,"placeholder",c.t=h),f!==c.a&&(a.required=c.a=f),p!==c.o&&(a.disabled=c.o=p),c},{e:void 0,t:void 0,a:void 0,o:void 0}),se(()=>a.value=t.value),i})()};wt(["input"]);const ow={en:{common:{save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",close:"Close",search:"Search",filter:"Filter",reset:"Reset",back:"Back",next:"Next",previous:"Previous",yes:"Yes",no:"No",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",confirm:"Confirm",actions:"Actions",status:"Status",active:"Active",inactive:"Inactive",date:"Date",time:"Time",description:"Description",notes:"Notes",amount:"Amount",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Language",english:"English",spanish:"Spanish",noDataFound:"No data found",required:"Required",optional:"Optional",all:"All",none:"None",select:"Select",clear:"Clear",searching:"Searching...",refresh:"Refresh",showAll:"Show All",products:"products",filtered:"Filtered",view:"View",suggested:"Suggested",clearFilters:"Clear Filters",enhanced:"Enhanced",legacy:"Legacy",email:"Email",phone:"Phone",address:"Address",name:"Name",code:"Code",category:"Category",type:"Type",quantity:"Quantity",price:"Price",cost:"Cost",value:"Value",balance:"Balance",created:"Created",modified:"Modified",details:"Details",summary:"Summary",history:"History",new:"New",addNew:"Add New",unknown:"Unknown",notAvailable:"N/A",remove:"Remove",startDate:"Start Date",endDate:"End Date",from:"From",invoice:"Invoice",reference:"Reference",createdBy:"Created By",units:"units",invoiceDocumentId:"Invoice/Document ID",referenceNumber:"Reference Number",referenceNumberPlaceholder:"Enter reference number...",generalNotes:"General Notes",auto:"Auto",optionalNotes:"Optional notes...",showPerPage:"Show per page",first:"First",last:"Last",pageOfPages:"Page {{current}} of {{total}}",showingXofY:"Showing {{start}}-{{end}} of {{total}}",page:"Page",of:"of"},forms:{referenceNumberRequired:"Reference number is required",locationRequired:"Location is required",fromLocationRequired:"From location is required for transfers",atLeastOneProduct:"At least one product is required",itemProductRequired:"Product is required for item {{index}}",itemQuantityRequired:"Quantity must be greater than 0 for item {{index}}"},navigation:{dashboard:"Dashboard",accounts:"Chart of Accounts",balanceSheet:"Balance Sheet",inventory:"Inventory",employees:"Employees",entryBooks:"Entry Books",consolidate:"Bank Consolidation",reports:"Reports",settings:"Settings"},dashboard:{title:"Dashboard",welcome:"Welcome to HRM Finance",totalRevenue:"Total Revenue",overview:"Overview",recentActivity:"Recent Activity",quickActions:"Quick Actions",employeeCount:"Employee Count",pendingInvoices:"Pending Invoices",cashBalance:"Cash Balance",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalExpenses:"Total Expenses",netIncome:"Net Income",netLoss:"Net Loss",monthlyPayroll:"Monthly Payroll",current:"Current",newHires:"+3 new hires",outstanding:"Outstanding",totalOutstanding:"$23,450 total",lastUpdatedToday:"Last updated today",commonTasks:"Common tasks",generateReport:"Generate Report",latestUpdates:"Latest updates",invoicePaid:"Invoice #1234 paid",hoursAgo:"2 hours ago",newEmployeeOnboarded:"New employee onboarded",dayAgo:"1 day ago",monthlyReportGenerated:"Monthly report generated",daysAgo:"2 days ago"},accounts:{title:"Chart of Accounts",accountNumber:"Account Number",accountName:"Account Name",accountType:"Account Type",category:"Category",balance:"Balance",parentAccount:"Parent Account",subAccounts:"Sub-accounts",addAccount:"Add Account",editAccount:"Edit Account",deleteAccount:"Delete Account",accountDetails:"Account Details",transactions:"Transactions",accountHistory:"Account History",backToAccounts:"Back to Accounts",accountNotFound:"Account not found",accountInformation:"Account Information",accountPurpose:"Account purpose",transactionHistory:"Transaction History",noTransactions:"No transactions found for this account",createdDate:"Created Date",lastModified:"Last Modified",noDescription:"No description provided.",totalCount:"Total count",basicDetails:"Basic details",currentBalance:"Current balance",classification:"Classification",allTransactions:"All account transactions",reference:"Reference",allAccounts:"All Accounts",types:{asset:"Asset",liability:"Liability",equity:"Equity",revenue:"Revenue",expense:"Expense"},categories:{currentAssets:"Current Assets",fixedAssets:"Fixed Assets",currentLiabilities:"Current Liabilities",longTermLiabilities:"Long-term Liabilities",ownersEquity:"Owner's Equity",operatingRevenue:"Operating Revenue",operatingExpenses:"Operating Expenses"}},inventory:{title:"Inventory Management",overview:"Overview",products:"Products & Stock",movements:"Movements",locations:"Locations",bulkMovement:"Bulk Movement",addMovement:"Add Movement",addProduct:"Add Product",addLocation:"Add Location",singleMovement:"Add Single Movement",addNewItem:"Add New Item",activeProducts:"Active Products",lowStockAlert:"Low Stock Items",totalValue:"Total Stock Value",activeLocations:"Active Locations",productsNeedRestocking:"products need restocking",recentMovements:"Recent Movements",noProducts:"No products at this location",productName:"Product Name",productCode:"Product Code",sku:"SKU",unitOfMeasure:"Unit of Measure",unitCost:"Unit Cost",minStockLevel:"Min Stock Level",maxStockLevel:"Max Stock Level",locationName:"Location Name",locationType:"Location Type",locationCode:"Location Code",movementType:"Movement Type",referenceNumber:"Reference Number",invoiceNumber:"Invoice Number",fromLocation:"From Location",toLocation:"To Location",stockIn:"Stock In",stockOut:"Stock Out",transfer:"Transfer",adjustment:"Adjustment",inStock:"In Stock",lowStock:"Low Stock",outOfStock:"Out of Stock",stockLevels:"Stock Levels",stockByLocation:"Stock by Location",searchProducts:"Search products by name, SKU, or category...",searchProductsStock:"Search products and check stock levels...",searchResult:"Search Result",searchResults:"Search Results",searchFallback:"Showing local results",tryDifferentTerm:"Try a different search term or check spelling.",showingTopResults:"Showing top {{count}} results",searchLocations:"Search locations...",noMovements:"No movements found",productDetails:"Product Details",locationDetails:"Location Details",movementDetails:"Movement Details",totalProducts:"Total Products",totalLocations:"Total Locations",lastSeen:"Last seen",warehouseType:"Warehouse",storeType:"Store",supplierType:"Supplier",customerType:"Customer",currentlyManaged:"Currently managed",needAttention:"Need attention",currentWorth:"Current worth",warehousesStores:"Warehouses & stores",thisMonth:"This Month",latestActivities:"Latest inventory activities",searchMovements:"Search Movements",countingSheet:"Counting Sheet",physicalCount:"Physical Count",physicalInventoryCount:"Physical Inventory Count",setupPhysicalCount:"Setup Physical Inventory Count",setupDescription:"Configure your physical inventory count settings and begin the counting process.",countWillInclude:"This count will include {{count}} products from {{location}} in {{category}} category.",startCounting:"Start Physical Count",counted:"Counted",remaining:"Remaining",variances:"Variances",complete:"Complete",systemQty:"System Qty",variance:"Variance",addNotes:"Add notes...",reviewAndConfirm:"Review and Confirm Adjustments",reviewDescription:"Review the inventory adjustments below and confirm to update your system.",stockIncreases:"Stock Increases",stockDecreases:"Stock Decreases",totalAdjustments:"Total Adjustments",confirmAdjustments:"Confirm Adjustments",perfectCount:"Perfect Count!",noVariances:"No variances found. Your physical count matches the system exactly.",physicalCountAdjustment:"Physical count adjustment",inventoryCountingSheetTitle:"INVENTORY COUNTING SHEET",location:"Location",allCategories:"All Categories",countedBy:"Counted by",verifiedBy:"Verified by",instructions:"Instructions",countInstructions:["Count all items physically present at this location",'Write the actual count in the "Physical Count" column',"Leave blank if item is not found",'Note any discrepancies in the "Notes" column',"Sign and date when complete"],productName:"Product Name",unit:"Unit",totalProductsListed:"Total Products Listed",itemsCounted:"Items Counted",discrepanciesFound:"Discrepancies Found",counterSignature:"Counter Signature",supervisorSignature:"Supervisor Signature",downloadCSV:"Download CSV",noAdjustmentsToDownload:"No adjustments to download",stockIncrease:"Stock Increase",stockDecrease:"Stock Decrease",purchaseReceive:"Purchase/Receive",saleIssue:"Sale/Issue",transfer:"Transfer",adjustment:"Adjustment",movementType:"Movement Type",fromLocation:"From Location",toLocation:"To Location",searchSourceLocation:"Search source location...",searchDestinationLocation:"Search destination location...",searchLocation:"Search location...",addProduct:"Add Product",searchProduct:"Search product...",unitCost:"Unit Cost",noProductsAdded:'No products added yet. Click "Add Product" to get started.',createMovement:"Create Movement",generalNotesPlaceholder:"Enter general notes for this movement...",sortBy:"Sort By",allLocations:"All Locations",searchByProduct:"Search by product, location, reference, notes, invoice...",allProducts:"All Products",allTypes:"All Types",startDate:"Start Date",endDate:"End Date",totalMovements:"Total Movements",totalItems:"Total Items",adjustMovements:"Try adjusting your filters or check back later.",inventoryMovements:"Inventory Movements",createdBy:"Created By",view:"View",enhanced:"Enhanced",legacy:"Legacy",addSingleMovement:"Add Single Movement",inStockSubtitle:"In stock",itemsBelowThreshold:"Items below threshold",inventoryWorth:"Inventory worth",quantity:"Quantity",units:"units",normal:"Normal",productsAndStock:"Products & Stock",lowStockItems:"Low Stock Items",totalStockValue:"Total Stock Value",warehousesAndStores:"Warehouses & stores",andMore:"...and {count} more",latestInventoryActivities:"Latest inventory activities",min:"Min",max:"Max",cost:"Cost",noProductsFound:"No products found matching your search.",noProductsAvailable:"No products available.",noLocationsFound:"No locations found matching your search.",noLocationsAvailable:"No locations available.",searchPlaceholder:"Search by product, location, reference, notes, invoice...",noMovementsFound:"No movements found",tryAdjustingFilters:"Try adjusting your filters or check back later.",transfers:"Transfers",adjustments:"Adjustments",bulk:"Bulk",product:"Product",location:"Location",store:"Store",supplier:"Supplier",warehouse:"Warehouse",movement:"Movement",editMovement:"Edit Movement",updateMovement:"Update Movement",movementInformation:"Movement Information",locationInformation:"Location Information"},employees:{title:"Employee Management",employeeList:"Employee List",addEmployee:"Add Employee",editEmployee:"Edit Employee",employeeDetails:"Employee Details",personalInfo:"Personal Information",employmentInfo:"Employment Information",payrollInfo:"Payroll Information",firstName:"First Name",lastName:"Last Name",fullName:"Full Name",email:"Email",phone:"Phone",address:"Address",dateOfBirth:"Date of Birth",employeeId:"Employee ID",department:"Department",position:"Position",hireDate:"Hire Date",employmentStatus:"Employment Status",salary:"Salary",payFrequency:"Pay Frequency",taxId:"Tax ID",bankAccount:"Bank Account",emergencyContact:"Emergency Contact",activeEmployees:"Active Employees",inactiveEmployees:"Inactive Employees",totalPayroll:"Total Payroll",searchEmployees:"Search employees...",enterFullName:"Enter employee's full name",enterPosition:"Enter job position",enterEmail:"Enter email address",enterPhone:"Enter phone number",enterSalary:"Enter annual salary",departments:{engineering:"Engineering",product:"Product",design:"Design",marketing:"Marketing",sales:"Sales",humanResources:"Human Resources",finance:"Finance",operations:"Operations",analytics:"Analytics"}},entryBooks:{title:"Entry Books",bookName:"Book Name",bookType:"Book Type",createBook:"Create Book",editBook:"Edit Book",salesBook:"Sales Book",purchaseBook:"Purchase Book",cashBook:"Cash Book",generalBook:"General Book",entries:"Entries",addEntry:"Add Entry",period:"Period",startDate:"Start Date",endDate:"End Date",bookBalance:"Book Balance",reconciledBalance:"Reconciled Balance",difference:"Difference",reconcile:"Reconcile",isReconciled:"Is Reconciled",noBooks:"No entry books found",createFirst:"Create your first entry book to get started",bookDetails:"Book Details",entriesCount:"entries",bookOverview:"Book overview and details",bookEntries:"Book Entries",allEntries:"All entries in this book",noEntries:"No entries found",addFirst:"Add your first entry to this book",entryDate:"Entry Date",entryDescription:"Entry Description",entryAmount:"Entry Amount",entryReference:"Entry Reference",subtitle:"Manage accounting entries and general ledger records",viewReconciliation:"View Reconciliation",totalEntries:"Total Entries",allJournalEntries:"All journal entries",postedEntriesOnly:"Posted entries only",fromPostedEntries:"From {count} posted entries",needBankReconciliation:"Need bank reconciliation",allReconciled:"All reconciled",sortBy:"Sort By",fromDate:"From Date",toDate:"To Date",order:"Order",newest:"Newest",oldest:"Oldest",resetFilters:"Reset Filters",activeFilters:"Active filters",from:"From",to:"To",entriesFound:"{count} entries found",noJournalEntries:"No Journal Entries",startByCreating:"Start by creating your first entry",noEntriesMatch:"No journal entries match your current filters.",createFirstEntry:"Create First Entry",void:"Void",confirmVoid:"Are you sure you want to void this journal entry?",entryBookRecords:"Entry Book Records"},banking:{title:"Bank Consolidation",bankAccount:"Bank Account",statementDate:"Statement Date",beginningBalance:"Beginning Balance",endingBalance:"Ending Balance",deposits:"Deposits",withdrawals:"Withdrawals",bankCharges:"Bank Charges",interest:"Interest",reconcile:"Reconcile",matched:"Matched",unmatched:"Unmatched",importStatement:"Import Statement",manualEntry:"Manual Entry",autoMatch:"Auto Match",clearAll:"Clear All",reconciliationStatus:"Reconciliation Status",difference:"Difference",bookBalance:"Book Balance",statementBalance:"Statement Balance",outstandingChecks:"Outstanding Checks",depositsInTransit:"Deposits in Transit",reconciled:"Reconciled",notReconciled:"Not Reconciled",unreconciled:"Unreconciled",reconciliation:"Reconciliation",compareStatements:"Compare bank statements with entry book records",importCSV:"Import CSV",startNewReconciliation:"Start New Reconciliation",bankAccountInfo:"Bank Account Info",currentAccountDetails:"Current account details",lastReconciled:"Last reconciled",bankTransactions:"Bank Transactions",selectedPeriod:"Selected period",pending:"pending",bookEntriesForComparison:"Book entries for comparison",reconciliationRate:"Reconciliation Rate",completionStatus:"Completion status",recentReconciliationSessions:"Recent Reconciliation Sessions",latestActivity:"Latest activity",noRecentSessions:"No recent reconciliation sessions found.",startFirstReconciliation:"Start First Reconciliation",entryBookRecords:"Entry Book Records",pleaseUploadCSV:"Please upload a CSV file",csvRequiresHeaderAndData:"CSV file must have at least a header and one data row",successfullyParsed:"Successfully parsed {count} rows",errorParsingCSV:"Error parsing CSV file. Please check the format.",dateDescriptionRequired:"Date and Description columns are required",importedTransaction:"Imported transaction",successfullyImported:"Successfully imported {count} bank transactions",errorImportingTransactions:"Error importing transactions. Please check your data.",importBankStatementCSV:"Import Bank Statement CSV",dropCSVHere:"Drop CSV file here",clickToUploadCSV:"Click to upload or drag and drop CSV file",supportedFormat:"Supported format: CSV with Date, Description, and Amount columns",mapCSVColumns:"Map CSV Columns",dateColumn:"Date Column",selectColumn:"Select column...",descriptionColumn:"Description Column",referenceColumn:"Reference Column",amountDebitColumn:"Amount/Debit Column",creditColumn:"Credit Column",balanceColumn:"Balance Column",andMoreRows:"... and {count} more rows",importing:"Importing...",importTransactions:"Import {count} Transactions",reconciliationComparison:"Reconciliation Comparison",bankStatements:"Bank Statements",totalTransactions:"Total transactions",totalEntries:"Total entries",unreconciledBank:"Unreconciled Bank",unreconciledBooks:"Unreconciled Books",needAttention:"Need attention",unreconcile:"Unreconcile",clickToReconcile:"Click to reconcile",potentialMatchesFound:"Potential Matches Found",clickRecordToReconcile:"Click on a record below to reconcile",exactMatch:"Exact Match",possibleMatch:"Possible Match",selected:"Selected",clearSelection:"Clear Selection"},journal:{title:"Journal Entries",entryNumber:"Entry Number",entryDate:"Entry Date",debit:"Debit",credit:"Credit",account:"Account",memo:"Memo",reference:"Reference",createEntry:"Create Entry",editEntry:"Edit Entry",deleteEntry:"Delete Entry",posted:"Posted",draft:"Draft",reversed:"Reversed",recurringEntry:"Recurring Entry",attachments:"Attachments",totalDebits:"Total Debits",totalCredits:"Total Credits",outOfBalance:"Out of Balance",balanced:"Balanced",addEntry:"Add Journal Entry",allEntries:"All Entries",totalDebit:"Total Debit",totalCredit:"Total Credit",debitShort:"Dr.",creditShort:"Cr.",noReference:"No reference",createdBy:"By",totalAmount:"Total Amount",lines:"Lines",entryNotBalancedShort:"Entry is not balanced",accountLines:"Account Lines",noDescription:"No description",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryLines:"Journal Entry Lines",addLine:"Add Line",lineDescription:"Line description",notBalanced:"Not Balanced",updateEntry:"Update Entry",saveAsDraft:"Save as Draft",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",editEntryTooltip:"Edit this journal entry",post:"Post",entryMustBeBalanced:"Entry must be balanced to post",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",journalLines:"Journal Lines",balanceStatus:"Balance Status",unbalanced:"Unbalanced",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",postEntry:"Post Entry",fixBalance:"Fix Balance",voidEntry:"Void Entry",draftEntry:"Draft Entry",draftEntryDescription:"This entry can be edited and posted.",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",postedEntry:"Posted Entry",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",minTwoLinesRequired:"At least 2 line items are required",entryNotBalanced:"Entry is not balanced. Debit: ${debit}, Credit: ${credit}",lineAccountRequired:"Line {lineNumber}: Account is required",lineAmountRequired:"Line {lineNumber}: Either debit or credit amount must be provided",lineBothAmounts:"Line {lineNumber}: Cannot have both debit and credit amounts",enterEntryDescription:"Enter journal entry description",enterReferenceNumber:"Enter reference number"},forms:{requiredField:"This field is required",invalidEmail:"Invalid email address",invalidNumber:"Invalid number",invalidDate:"Invalid date",selectOption:"Please select an option",enterValue:"Please enter a value",confirmDelete:"Are you sure you want to delete this item?",unsavedChanges:"You have unsaved changes. Do you want to continue?",saveSuccess:"Saved successfully",saveError:"Error saving data",deleteSuccess:"Deleted successfully",deleteError:"Error deleting item",duplicateAccountNumber:"Account number already exists",descriptionRequired:"Description is required",errorOccurred:"An error occurred",errorPostingEntry:"An error occurred while posting the entry"},modals:{addInventory:"Add Inventory Movement",bulkMovement:"Bulk Inventory Movement",addProduct:"Add New Product",addLocation:"Add New Location",inventoryDetail:"Inventory Item Details",quickAdd:"Quick Add",selectProduct:"Select Product",selectLocation:"Select Location",enterQuantity:"Enter quantity",enterCost:"Enter unit cost",enterReference:"Enter reference number",addNotes:"Add notes (optional)",generalInformation:"General Information",stockInformation:"Stock Information",locationInformation:"Location Information",movementInformation:"Movement Information",addToInventory:"Add to Inventory",createProduct:"Create Product",createLocation:"Create Location",processing:"Processing...",addingMovement:"Adding movement...",creatingProduct:"Creating product...",creatingLocation:"Creating location..."},products:{title:"Products",addNew:"Add New Product",totalProducts:"Total Products",inCatalog:"In catalog",activeProducts:"Active Products",currentlyAvailable:"Currently available",outOfStock:"Out of Stock",needsRestock:"Needs restock",productCatalog:"Product Catalog",manageYourProducts:"Manage your products and pricing",inStock:"In Stock",furniture:"Furniture",electronics:"Electronics",supplies:"Supplies",lighting:"Lighting",searchPlaceholder:"Search products by name, SKU, or category...",allCategories:"All Categories",clearFilters:"Clear filters",noResults:"No products found matching your criteria.",noProducts:"No products available.",showing:"Showing",filtered:"Filtered results",allProducts:"All products",searchResult:"Search Result",stock:"Stock",lowStock:"Low Stock"},invoices:{title:"Invoices",createNew:"Create New Invoice",totalOutstanding:"Total Outstanding",unpaidInvoices:"Unpaid invoices",thisMonth:"This Month",revenueCollected:"Revenue collected",overdue:"Overdue",pastDueInvoices:"Past due invoices",recentInvoices:"Recent Invoices",latestBillingActivity:"Latest billing activity",paid:"Paid",pending:"Pending"},unauthorized:{title:"Access Restricted",accessDenied:"Access Denied",noPermission:"You don't have permission to access",thisFeature:"this feature",whySeeing:"Why am I seeing this?",explanation:"Your account doesn't have the necessary permissions to view this content.",requiredPermission:"Required permission:",goToDashboard:"Go to Dashboard",goBack:"Go Back",featuresCanAccess:"Features you can access:",dashboardAccess:"Dashboard and overview statistics",profileAccess:"Your profile and settings",roleBasedAccess:"Features enabled for your role",needAccess:"Need access? Contact your administrator or manager to request the appropriate permissions.",permissions:{accountAccess:"Account Management Access",inventoryAccess:"Inventory Access",employeeAccess:"HR Access",bankingAccess:"Banking Access",journalAccess:"Journal Entry Access",adminAccess:"Administrative Access",financialReporting:"Financial Reporting Access",invoiceManagement:"Invoice Management Access",productManagement:"Product Management Access"}}},es:{common:{save:"Guardar",cancel:"Cancelar",delete:"Eliminar",edit:"Editar",add:"Agregar",close:"Cerrar",search:"Buscar",filter:"Filtrar",reset:"Restablecer",back:"Atrás",next:"Siguiente",previous:"Anterior",yes:"Sí",no:"No",loading:"Cargando...",error:"Error",success:"Éxito",warning:"Advertencia",info:"Información",confirm:"Confirmar",actions:"Acciones",status:"Estado",active:"Activo",inactive:"Inactivo",date:"Fecha",time:"Hora",description:"Descripción",notes:"Notas",amount:"Monto",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Idioma",english:"Inglés",spanish:"Español",noDataFound:"No se encontraron datos",required:"Requerido",optional:"Opcional",all:"Todos",none:"Ninguno",select:"Seleccionar",clear:"Limpiar",view:"Ver",suggested:"Sugerido",clearFilters:"Limpiar Filtros",enhanced:"Mejorado",legacy:"Clásico",email:"Correo Electrónico",phone:"Teléfono",address:"Dirección",name:"Nombre",code:"Código",category:"Categoría",type:"Tipo",quantity:"Cantidad",price:"Precio",cost:"Costo",value:"Valor",balance:"Saldo",created:"Creado",modified:"Modificado",details:"Detalles",summary:"Resumen",history:"Historial",new:"Nuevo",addNew:"Agregar Nuevo",unknown:"Desconocido",notAvailable:"N/A",remove:"Remover",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",from:"De",invoice:"Factura",reference:"Referencia",createdBy:"Creado Por",units:"unidades",invoiceDocumentId:"ID de Factura/Documento",referenceNumber:"Número de Referencia",referenceNumberPlaceholder:"Ingrese número de referencia...",generalNotes:"Notas Generales",auto:"Auto",optionalNotes:"Notas opcionales...",showPerPage:"Mostrar por página",first:"Primera",last:"Última",pageOfPages:"Página {{current}} de {{total}}",showingXofY:"Mostrando {{start}}-{{end}} de {{total}}",page:"Página",of:"de"},forms:{referenceNumberRequired:"El número de referencia es requerido",locationRequired:"La ubicación es requerida",fromLocationRequired:"La ubicación de origen es requerida para transferencias",atLeastOneProduct:"Al menos un producto es requerido",itemProductRequired:"El producto es requerido para el artículo {{index}}",itemQuantityRequired:"La cantidad debe ser mayor que 0 para el artículo {{index}}"},navigation:{dashboard:"Panel de Control",accounts:"Plan de Cuentas",balanceSheet:"Balance General",inventory:"Inventario",employees:"Empleados",entryBooks:"Libros de Entrada",consolidate:"Consolidación Bancaria",reports:"Reportes",settings:"Configuración"},dashboard:{title:"Panel de Control",welcome:"Bienvenido a HRM Finance",totalRevenue:"Ingresos Totales",overview:"Resumen",recentActivity:"Actividad Reciente",quickActions:"Acciones Rápidas",employeeCount:"Número de Empleados",pendingInvoices:"Facturas Pendientes",cashBalance:"Saldo en Efectivo",totalAssets:"Activos Totales",totalLiabilities:"Pasivos Totales",totalExpenses:"Gastos Totales",netIncome:"Ingreso Neto",netLoss:"Pérdida Neta",monthlyPayroll:"Nómina Mensual",current:"Actual",newHires:"+3 nuevas contrataciones",outstanding:"Pendiente",totalOutstanding:"$23,450 total",lastUpdatedToday:"Última actualización hoy",commonTasks:"Tareas comunes",generateReport:"Generar Reporte",latestUpdates:"Últimas actualizaciones",invoicePaid:"Factura #1234 pagada",hoursAgo:"hace 2 horas",newEmployeeOnboarded:"Nuevo empleado incorporado",dayAgo:"hace 1 día",monthlyReportGenerated:"Reporte mensual generado",daysAgo:"hace 2 días"},accounts:{title:"Plan de Cuentas",accountNumber:"Número de Cuenta",accountName:"Nombre de Cuenta",accountType:"Tipo de Cuenta",category:"Categoría",balance:"Saldo",parentAccount:"Cuenta Padre",subAccounts:"Subcuentas",addAccount:"Agregar Cuenta",editAccount:"Editar Cuenta",deleteAccount:"Eliminar Cuenta",accountDetails:"Detalles de Cuenta",transactions:"Transacciones",accountHistory:"Historial de Cuenta",backToAccounts:"Volver a Cuentas",accountNotFound:"Cuenta no encontrada",accountInformation:"Información de Cuenta",accountPurpose:"Propósito de la cuenta",transactionHistory:"Historial de Transacciones",noTransactions:"No se encontraron transacciones para esta cuenta",createdDate:"Fecha de Creación",lastModified:"Última Modificación",noDescription:"No se proporcionó descripción.",totalCount:"Conteo total",basicDetails:"Detalles básicos",currentBalance:"Saldo actual",classification:"Clasificación",allTransactions:"Todas las transacciones de la cuenta",reference:"Referencia",types:{asset:"Activo",liability:"Pasivo",equity:"Patrimonio",revenue:"Ingreso",expense:"Gasto"},categories:{currentAssets:"Activos Corrientes",fixedAssets:"Activos Fijos",currentLiabilities:"Pasivos Corrientes",longTermLiabilities:"Pasivos a Largo Plazo",ownersEquity:"Patrimonio del Propietario",operatingRevenue:"Ingresos Operacionales",operatingExpenses:"Gastos Operacionales"}},inventory:{title:"Gestión de Inventario",overview:"Resumen",products:"Productos y Stock",movements:"Movimientos",locations:"Ubicaciones",bulkMovement:"Movimiento Masivo",addMovement:"Agregar Movimiento",addProduct:"Agregar Producto",addLocation:"Agregar Ubicación",singleMovement:"Agregar Movimiento Individual",addNewItem:"Agregar Nuevo Artículo",activeProducts:"Productos Activos",lowStockAlert:"Artículos con Stock Bajo",totalValue:"Valor Total del Stock",activeLocations:"Ubicaciones Activas",productsNeedRestocking:"productos necesitan reabastecimiento",recentMovements:"Movimientos Recientes",noProducts:"No hay productos en esta ubicación",productName:"Nombre del Producto",productCode:"Código del Producto",sku:"SKU",unitOfMeasure:"Unidad de Medida",unitCost:"Costo Unitario",minStockLevel:"Nivel Mínimo de Stock",maxStockLevel:"Nivel Máximo de Stock",locationName:"Nombre de Ubicación",locationType:"Tipo de Ubicación",locationCode:"Código de Ubicación",movementType:"Tipo de Movimiento",referenceNumber:"Número de Referencia",invoiceNumber:"Número de Factura",fromLocation:"Desde Ubicación",toLocation:"Hacia Ubicación",stockIn:"Entrada de Stock",stockOut:"Salida de Stock",transfer:"Transferencia",adjustment:"Ajuste",inStock:"En Stock",lowStock:"Stock Bajo",outOfStock:"Sin Stock",stockLevels:"Niveles de Stock",stockByLocation:"Stock por Ubicación",searchProducts:"Buscar productos...",searchLocations:"Buscar ubicaciones...",noMovements:"No se encontraron movimientos",productDetails:"Detalles del Producto",locationDetails:"Detalles de Ubicación",movementDetails:"Detalles del Movimiento",totalProducts:"Total de Productos",totalLocations:"Total de Ubicaciones",lastSeen:"Visto por última vez",warehouseType:"Almacén",storeType:"Tienda",supplierType:"Proveedor",customerType:"Cliente",currentlyManaged:"Gestionados actualmente",needAttention:"Necesitan atención",currentWorth:"Valor actual",warehousesStores:"Almacenes y tiendas",thisMonth:"Este Mes",latestActivities:"Últimas actividades de inventario",searchMovements:"Buscar Movimientos",countingSheet:"Hoja de Conteo",physicalCount:"Conteo Físico",physicalInventoryCount:"Conteo Físico de Inventario",setupPhysicalCount:"Configurar Conteo Físico de Inventario",setupDescription:"Configure los ajustes de su conteo físico de inventario y comience el proceso de conteo.",countWillInclude:"Este conteo incluirá {{count}} productos de {{location}} en la categoría {{category}}.",startCounting:"Iniciar Conteo Físico",counted:"Contado",remaining:"Restante",variances:"Variaciones",complete:"Completo",systemQty:"Cant. Sistema",variance:"Variación",addNotes:"Agregar notas...",reviewAndConfirm:"Revisar y Confirmar Ajustes",reviewDescription:"Revise los ajustes de inventario a continuación y confirme para actualizar su sistema.",stockIncreases:"Aumentos de Stock",stockDecreases:"Disminuciones de Stock",totalAdjustments:"Ajustes Totales",confirmAdjustments:"Confirmar Ajustes",adjustment:"Ajuste",perfectCount:"¡Conteo Perfecto!",noVariances:"No se encontraron variaciones. Su conteo físico coincide exactamente con el sistema.",physicalCountAdjustment:"Ajuste de conteo físico",inventoryCountingSheetTitle:"HOJA DE CONTEO DE INVENTARIO",location:"Ubicación",allCategories:"Todas las Categorías",countedBy:"Contado por",verifiedBy:"Verificado por",instructions:"Instrucciones",countInstructions:["Contar todos los artículos físicamente presentes en esta ubicación",'Escribir el conteo real en la columna "Conteo Físico"',"Dejar en blanco si el artículo no se encuentra",'Anotar cualquier discrepancia en la columna "Notas"',"Firmar y fechar cuando esté completo"],productName:"Nombre del Producto",unit:"Unidad",totalProductsListed:"Total de Productos Listados",itemsCounted:"Artículos Contados",discrepanciesFound:"Discrepancias Encontradas",counterSignature:"Firma del Contador",supervisorSignature:"Firma del Supervisor",downloadCSV:"Descargar CSV",noAdjustmentsToDownload:"No hay ajustes para descargar",stockIncrease:"Aumento de Stock",stockDecrease:"Disminución de Stock",purchaseReceive:"Compra/Recepción",saleIssue:"Venta/Emisión",transfer:"Transferencia",adjustment:"Ajuste",movementType:"Tipo de Movimiento",fromLocation:"Ubicación de Origen",toLocation:"Ubicación de Destino",searchSourceLocation:"Buscar ubicación de origen...",searchDestinationLocation:"Buscar ubicación de destino...",searchLocation:"Buscar ubicación...",addProduct:"Agregar Producto",searchProduct:"Buscar producto...",unitCost:"Costo Unitario",noProductsAdded:'No se han agregado productos aún. Haga clic en "Agregar Producto" para comenzar.',createMovement:"Crear Movimiento",generalNotesPlaceholder:"Ingrese notas generales para este movimiento...",sortBy:"Ordenar Por",allLocations:"Todas las Ubicaciones",searchByProduct:"Buscar por producto, ubicación, referencia, notas, factura...",allProducts:"Todos los Productos",allTypes:"Todos los Tipos",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",totalMovements:"Movimientos Totales",totalItems:"Artículos Totales",adjustMovements:"Intenta ajustar tus filtros o revisa más tarde.",inventoryMovements:"Movimientos de Inventario",createdBy:"Creado Por",view:"Ver",enhanced:"Mejorado",legacy:"Clásico",addSingleMovement:"Agregar Movimiento Individual",inStockSubtitle:"En stock",itemsBelowThreshold:"Artículos bajo el umbral",inventoryWorth:"Valor del inventario",quantity:"Cantidad",units:"unidades",normal:"Normal",productsAndStock:"Productos y Stock",lowStockItems:"Artículos con Stock Bajo",totalStockValue:"Valor Total del Stock",warehousesAndStores:"Almacenes y tiendas",andMore:"...y {count} más",latestInventoryActivities:"Últimas actividades de inventario",min:"Mín",max:"Máx",cost:"Costo",noProductsFound:"No se encontraron productos que coincidan con su búsqueda.",noProductsAvailable:"No hay productos disponibles.",noLocationsFound:"No se encontraron ubicaciones que coincidan con su búsqueda.",noLocationsAvailable:"No hay ubicaciones disponibles.",searchPlaceholder:"Buscar por producto, ubicación, referencia, notas, factura...",noMovementsFound:"No se encontraron movimientos",tryAdjustingFilters:"Intenta ajustar tus filtros o revisa más tarde.",transfers:"Transferencias",adjustments:"Ajustes",bulk:"Masivo",product:"Producto",location:"Ubicación",store:"Tienda",supplier:"Proveedor",warehouse:"Almacén",movement:"Movimiento",editMovement:"Editar Movimiento",updateMovement:"Actualizar Movimiento",movementInformation:"Información del Movimiento",locationInformation:"Información de Ubicación"},employees:{title:"Gestión de Empleados",employeeList:"Lista de Empleados",addEmployee:"Agregar Empleado",editEmployee:"Editar Empleado",employeeDetails:"Detalles del Empleado",personalInfo:"Información Personal",employmentInfo:"Información Laboral",payrollInfo:"Información de Nómina",firstName:"Nombre",lastName:"Apellido",fullName:"Nombre Completo",email:"Correo Electrónico",phone:"Teléfono",address:"Dirección",dateOfBirth:"Fecha de Nacimiento",employeeId:"ID de Empleado",department:"Departamento",position:"Puesto",hireDate:"Fecha de Contratación",employmentStatus:"Estado Laboral",salary:"Salario",payFrequency:"Frecuencia de Pago",taxId:"ID Fiscal",bankAccount:"Cuenta Bancaria",emergencyContact:"Contacto de Emergencia",activeEmployees:"Empleados Activos",inactiveEmployees:"Empleados Inactivos",totalPayroll:"Nómina Total",searchEmployees:"Buscar empleados...",enterFullName:"Ingrese el nombre completo del empleado",enterPosition:"Ingrese el puesto de trabajo",enterEmail:"Ingrese la dirección de correo electrónico",enterPhone:"Ingrese el número de teléfono",enterSalary:"Ingrese el salario anual",departments:{engineering:"Ingeniería",product:"Producto",design:"Diseño",marketing:"Marketing",sales:"Ventas",humanResources:"Recursos Humanos",finance:"Finanzas",operations:"Operaciones",analytics:"Analítica"}},entryBooks:{title:"Libros de Entrada",bookName:"Nombre del Libro",bookType:"Tipo de Libro",createBook:"Crear Libro",editBook:"Editar Libro",salesBook:"Libro de Ventas",purchaseBook:"Libro de Compras",cashBook:"Libro de Caja",generalBook:"Libro General",entries:"Entradas",addEntry:"Agregar Entrada",period:"Período",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",bookBalance:"Saldo del Libro",reconciledBalance:"Saldo Conciliado",difference:"Diferencia",reconcile:"Conciliar",isReconciled:"Está Conciliado",noBooks:"No se encontraron libros de entrada",createFirst:"Crea tu primer libro de entrada para comenzar",bookDetails:"Detalles del Libro",entriesCount:"entradas",bookOverview:"Resumen y detalles del libro",bookEntries:"Entradas del Libro",allEntries:"Todas las entradas en este libro",noEntries:"No se encontraron entradas",addFirst:"Agrega tu primera entrada a este libro",entryDate:"Fecha de Entrada",entryDescription:"Descripción de Entrada",entryAmount:"Monto de Entrada",entryReference:"Referencia de Entrada"},banking:{title:"Consolidación Bancaria",bankAccount:"Cuenta Bancaria",statementDate:"Fecha del Estado",beginningBalance:"Saldo Inicial",endingBalance:"Saldo Final",deposits:"Depósitos",withdrawals:"Retiros",bankCharges:"Cargos Bancarios",interest:"Intereses",reconcile:"Conciliar",matched:"Conciliado",unmatched:"No Conciliado",importStatement:"Importar Estado",manualEntry:"Entrada Manual",autoMatch:"Coincidencia Automática",clearAll:"Limpiar Todo",reconciliationStatus:"Estado de Conciliación",difference:"Diferencia",bookBalance:"Saldo en Libros",statementBalance:"Saldo del Estado",outstandingChecks:"Cheques Pendientes",depositsInTransit:"Depósitos en Tránsito",reconciled:"Conciliado",notReconciled:"No Conciliado",unreconciled:"No Conciliado",reconciliation:"Conciliación",compareStatements:"Comparar estados bancarios con registros de libros de entrada",importCSV:"Importar CSV",startNewReconciliation:"Iniciar Nueva Conciliación",bankAccountInfo:"Información de Cuenta Bancaria",currentAccountDetails:"Detalles de cuenta actual",lastReconciled:"Última conciliación",bankTransactions:"Transacciones Bancarias",selectedPeriod:"Período seleccionado",pending:"pendiente",bookEntriesForComparison:"Entradas de libros para comparación",reconciliationRate:"Tasa de Conciliación",completionStatus:"Estado de finalización",recentReconciliationSessions:"Sesiones de Conciliación Recientes",latestActivity:"Actividad reciente",noRecentSessions:"No se encontraron sesiones de conciliación recientes.",startFirstReconciliation:"Iniciar Primera Conciliación",entryBookRecords:"Registros de Libros de Entrada",pleaseUploadCSV:"Por favor suba un archivo CSV",csvRequiresHeaderAndData:"El archivo CSV debe tener al menos un encabezado y una fila de datos",successfullyParsed:"Se analizaron exitosamente {count} filas",errorParsingCSV:"Error al analizar el archivo CSV. Verifique el formato.",dateDescriptionRequired:"Las columnas de Fecha y Descripción son requeridas",importedTransaction:"Transacción importada",successfullyImported:"Se importaron exitosamente {count} transacciones bancarias",errorImportingTransactions:"Error al importar transacciones. Verifique sus datos.",importBankStatementCSV:"Importar CSV de Estado Bancario",dropCSVHere:"Suelte el archivo CSV aquí",clickToUploadCSV:"Haga clic para cargar o arrastre y suelte el archivo CSV",supportedFormat:"Formato soportado: CSV con columnas de Fecha, Descripción y Monto",mapCSVColumns:"Mapear Columnas CSV",dateColumn:"Columna de Fecha",selectColumn:"Seleccionar columna...",descriptionColumn:"Columna de Descripción",referenceColumn:"Columna de Referencia",amountDebitColumn:"Columna de Monto/Débito",creditColumn:"Columna de Crédito",balanceColumn:"Columna de Saldo",andMoreRows:"... y {count} filas más",importing:"Importando...",importTransactions:"Importar {count} Transacciones",reconciliationComparison:"Comparación de Conciliación",bankStatements:"Estados Bancarios",totalTransactions:"Transacciones totales",totalEntries:"Entradas totales",unreconciledBank:"Banco No Conciliado",unreconciledBooks:"Libros No Conciliados",needAttention:"Necesitan atención",unreconcile:"Desconciliar",clickToReconcile:"Hacer clic para conciliar",potentialMatchesFound:"Coincidencias Potenciales Encontradas",clickRecordToReconcile:"Haga clic en un registro a continuación para conciliar",exactMatch:"Coincidencia Exacta",possibleMatch:"Posible Coincidencia",selected:"Seleccionado",clearSelection:"Limpiar Selección"},journal:{title:"Asientos Contables",entryNumber:"Número de Asiento",entryDate:"Fecha del Asiento",debit:"Débito",credit:"Crédito",account:"Cuenta",memo:"Memo",reference:"Referencia",createEntry:"Crear Asiento",editEntry:"Editar Asiento",deleteEntry:"Eliminar Asiento",posted:"Registrado",draft:"Borrador",reversed:"Revertido",recurringEntry:"Asiento Recurrente",attachments:"Adjuntos",totalDebits:"Débitos Totales",totalCredits:"Créditos Totales",outOfBalance:"Desbalanceado",balanced:"Balanceado"},forms:{requiredField:"Este campo es requerido",invalidEmail:"Dirección de correo inválida",invalidNumber:"Número inválido",invalidDate:"Fecha inválida",selectOption:"Por favor seleccione una opción",enterValue:"Por favor ingrese un valor",confirmDelete:"¿Está seguro de que desea eliminar este elemento?",unsavedChanges:"Tiene cambios sin guardar. ¿Desea continuar?",saveSuccess:"Guardado exitosamente",saveError:"Error al guardar datos",deleteSuccess:"Eliminado exitosamente",deleteError:"Error al eliminar elemento",duplicateAccountNumber:"El número de cuenta ya existe"},modals:{addInventory:"Agregar Movimiento de Inventario",bulkMovement:"Movimiento Masivo de Inventario",addProduct:"Agregar Nuevo Producto",addLocation:"Agregar Nueva Ubicación",inventoryDetail:"Detalles del Artículo de Inventario",quickAdd:"Agregar Rápido",selectProduct:"Seleccionar Producto",selectLocation:"Seleccionar Ubicación",enterQuantity:"Ingresar cantidad",enterCost:"Ingresar costo unitario",enterReference:"Ingresar número de referencia",addNotes:"Agregar notas (opcional)",generalInformation:"Información General",stockInformation:"Información de Stock",locationInformation:"Información de Ubicación",movementInformation:"Información de Movimiento",addToInventory:"Agregar al Inventario",createProduct:"Crear Producto",createLocation:"Crear Ubicación",processing:"Procesando...",addingMovement:"Agregando movimiento...",creatingProduct:"Creando producto...",creatingLocation:"Creando ubicación..."},products:{title:"Productos",addNew:"Agregar Nuevo Producto",totalProducts:"Total de Productos",inCatalog:"En catálogo",activeProducts:"Productos Activos",currentlyAvailable:"Actualmente disponibles",outOfStock:"Sin Stock",needsRestock:"Necesita reabastecimiento",productCatalog:"Catálogo de Productos",manageYourProducts:"Gestiona tus productos y precios",inStock:"En Stock",furniture:"Muebles",electronics:"Electrónicos",supplies:"Suministros",lighting:"Iluminación"},invoices:{title:"Facturas",createNew:"Crear Nueva Factura",totalOutstanding:"Total Pendiente",unpaidInvoices:"Facturas no pagadas",thisMonth:"Este Mes",revenueCollected:"Ingresos recaudados",overdue:"Vencidas",pastDueInvoices:"Facturas vencidas",recentInvoices:"Facturas Recientes",latestBillingActivity:"Actividad de facturación reciente",paid:"Pagado",pending:"Pendiente"},unauthorized:{title:"Acceso Restringido",accessDenied:"Acceso Denegado",noPermission:"No tienes permisos para acceder a",thisFeature:"esta funcionalidad",whySeeing:"¿Por qué veo esto?",explanation:"Tu cuenta no tiene los permisos necesarios para ver este contenido.",requiredPermission:"Permiso requerido:",goToDashboard:"Ir al Panel de Control",goBack:"Regresar",featuresCanAccess:"Funcionalidades a las que puedes acceder:",dashboardAccess:"Panel de control y estadísticas generales",profileAccess:"Tu perfil y configuraciones",roleBasedAccess:"Funcionalidades habilitadas para tu rol",needAccess:"¿Necesitas acceso? Contacta a tu administrador o gerente para solicitar los permisos apropiados.",permissions:{accountAccess:"Acceso a Gestión de Cuentas",inventoryAccess:"Acceso a Inventario",employeeAccess:"Acceso a Recursos Humanos",bankingAccess:"Acceso Bancario",journalAccess:"Acceso a Asientos Contables",adminAccess:"Acceso Administrativo",financialReporting:"Acceso a Reportes Financieros",invoiceManagement:"Acceso a Gestión de Facturas",productManagement:"Acceso a Gestión de Productos"}}}},sw=()=>{if(typeof window<"u"){const t=localStorage.getItem("hrmfinance-language");if(t&&["en","es"].includes(t))return t}return"en"},[bh,aw]=ye(sw()),it=()=>({t:(n,i,o)=>{const a=bh(),c=n.split(".");let u=ow[a];for(const f of c)if(u&&typeof u=="object"&&f in u)u=u[f];else return i||n;let h=typeof u=="string"?u:i||n;return o&&typeof h=="string"&&Object.keys(o).forEach(f=>{const p=o[f],b=`{{${f}}}`;h=h.replace(new RegExp(b,"g"),String(p))}),h},language:()=>bh(),setLanguage:n=>{aw(n),typeof window<"u"&&localStorage.setItem("hrmfinance-language",n)}});var lw=H("<div><label></label><select><option value>"),cw=H("<span>*"),uw=H("<option>");const mr=t=>{const{t:e}=it(),r={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},n={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},i={"margin-bottom":"1rem"};return(()=>{var o=lw(),a=o.firstChild,c=a.nextSibling,u=c.firstChild;return d(o,i),d(a,r),s(a,()=>t.label,null),s(a,(()=>{var h=me(()=>!!t.required);return()=>h()&&(()=>{var f=cw();return f.style.setProperty("color","var(--primary-color)"),f})()})(),null),c.addEventListener("blur",h=>h.target.style.borderColor="var(--border-color)"),c.addEventListener("focus",h=>h.target.style.borderColor="var(--primary-color)"),c.addEventListener("change",h=>t.onChange(h.target.value)),d(c,n),s(u,()=>e("forms.selectOption")),s(c,()=>t.options.map(h=>(()=>{var f=uw();return s(f,()=>h.label),se(()=>f.value=h.value),f})()),null),se(h=>{var f=t.required,p=t.disabled;return f!==h.e&&(c.required=h.e=f),p!==h.t&&(c.disabled=h.t=p),h},{e:void 0,t:void 0}),se(()=>c.value=t.value),o})()};var dw=H("<div><span></span><select><option value=en>🇺🇸 </option><option value=es>🇪🇸 ");const qy=()=>{const{t,language:e,setLanguage:r}=it(),n={display:"flex","align-items":"center",gap:"0.5rem","margin-left":"auto"},i={padding:"0.5rem 1rem","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",background:"var(--surface-color)",color:"var(--text-primary)",cursor:"pointer","font-size":"0.875rem","font-weight":"500",transition:"all 0.2s ease","min-width":"120px"},o={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},a=c=>{const u=c.target;r(u.value)};return(()=>{var c=dw(),u=c.firstChild,h=u.nextSibling,f=h.firstChild;f.firstChild;var p=f.nextSibling;return p.firstChild,d(c,n),d(u,o),h.addEventListener("change",a),d(h,i),s(f,()=>t("common.english"),null),s(p,()=>t("common.spanish"),null),se(()=>h.value=e()),c})()};var hw=H("<main><div>"),mw=H("<header><h1>");const Ur=t=>{const e={"min-height":"100vh",background:"var(--background-color)"},r={"max-width":"1200px",margin:"0 auto",padding:"2rem"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},i={"font-size":"2rem","font-weight":"700",color:"var(--text-primary)",margin:"0"};return(()=>{var o=hw(),a=o.firstChild;return d(o,e),d(a,r),s(a,(()=>{var c=me(()=>!!t.title);return()=>c()&&(()=>{var u=mw(),h=u.firstChild;return d(u,n),d(h,i),s(h,()=>t.title),s(u,S(qy,{}),null),u})()})(),null),s(a,()=>t.children,null),o})()};var fw=H('<img alt="User avatar">'),yw=H("<div><span>"),gw=H("<button>Sign Out"),pw=H(`<nav><div><div><div></div></div><div></div></div><style>
        .nav-active {
          background: linear-gradient(135deg, var(--primary-color), var(--primary-dark)) !important;
          color: white !important;
          box-shadow: var(--shadow-sm);
        }
        
        nav a:hover:not(.nav-active) {
          background: var(--background-color);
          color: var(--text-primary);
        }
        
        @media (max-width: 768px) {
          nav div:first-child {
            flex-direction: column;
            gap: 1rem;
            padding: 1rem;
          }
          
          nav div:last-child {
            flex-wrap: wrap;
            justify-content: center;
          }
        }
      `);const vw=()=>{const{t}=it(),e={background:"var(--surface-color)","border-bottom":"1px solid var(--border-color)","box-shadow":"var(--shadow-sm)","backdrop-filter":"blur(10px)",position:"sticky",top:"0","z-index":"100"},r={display:"flex","align-items":"center","justify-content":"space-between",padding:"1rem 2rem",margin:"0 auto"},n={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","text-decoration":"none","margin-right":"2rem"},i={display:"flex",gap:"0.5rem","align-items":"center"},o={"text-decoration":"none",color:"var(--text-secondary)",padding:"0.5rem 1rem","border-radius":"var(--border-radius-sm)","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease","white-space":"nowrap"},a={display:"flex","align-items":"center",gap:"1rem"},c={display:"flex","align-items":"center",gap:"0.75rem",padding:"0.5rem 1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",color:"var(--text-primary)"},u={width:"32px",height:"32px","border-radius":"50%","object-fit":"cover"},h={...o,cursor:"pointer",border:"1px solid var(--border-color)",background:"transparent"},f=()=>{$t.signOut()},p=b=>{const C=$t.state?.profile;return C?C[b]===!0:!1};return(()=>{var b=pw(),C=b.firstChild,R=C.firstChild,E=R.firstChild,x=R.nextSibling;return d(C,r),R.style.setProperty("display","flex"),R.style.setProperty("align-items","center"),R.style.setProperty("flex","1"),s(R,S(pn,{href:"/",style:n,children:"HRM Finance"}),E),d(E,i),s(E,S(pn,{href:"/",style:o,activeClass:"nav-active",get children(){return t("navigation.dashboard")}}),null),s(E,S(Ve,{get when(){return p("AccountAccess")},get children(){return S(pn,{href:"/accounts",style:o,activeClass:"nav-active",get children(){return t("navigation.accounts")}})}}),null),s(E,S(Ve,{get when(){return p("JournalAccess")},get children(){return S(pn,{href:"/entry-books",style:o,activeClass:"nav-active",get children(){return t("navigation.entryBooks")}})}}),null),s(E,S(Ve,{get when(){return p("EmployeeAccess")},get children(){return S(pn,{href:"/employees",style:o,activeClass:"nav-active",get children(){return t("navigation.employees")}})}}),null),s(E,S(Ve,{get when(){return p("BankingAccess")},get children(){return S(pn,{href:"/bank-consolidations",style:o,activeClass:"nav-active",get children(){return t("navigation.consolidate")}})}}),null),s(E,S(Ve,{get when(){return p("AccountAccess")},get children(){return S(pn,{href:"/balance-sheet",style:o,activeClass:"nav-active",get children(){return t("navigation.balanceSheet")}})}}),null),s(E,S(Ve,{get when(){return p("InventoryAccess")},get children(){return S(pn,{href:"/inventory",style:o,activeClass:"nav-active",get children(){return t("navigation.inventory")}})}}),null),d(x,a),s(x,S(qy,{}),null),s(x,S(Ve,{get when(){return $t.currentUser},get children(){return[(()=>{var T=yw(),W=T.firstChild;return d(T,c),s(T,S(Ve,{get when(){return $t.currentUser?.photoURL},get children(){var te=fw();return se(Q=>{var de=$t.currentUser.photoURL,ae=u;return de!==Q.e&&ct(te,"src",Q.e=de),Q.t=d(te,ae,Q.t),Q},{e:void 0,t:void 0}),te}}),W),T})(),(()=>{var T=gw();return T.addEventListener("mouseleave",W=>{W.currentTarget.style.background="transparent",W.currentTarget.style.color="var(--text-secondary)"}),T.addEventListener("mouseenter",W=>{W.currentTarget.style.background="var(--background-color)",W.currentTarget.style.color="var(--text-primary)"}),T.$$click=f,se(W=>d(T,h,W)),T})()]}}),null),se(T=>d(b,e,T)),b})()};wt(["click"]);var bw=H("<div><div><div>🔒</div><h1></h1><p>.</p><div><p><strong></strong><br></p></div><div><button></button></div><div><h3></h3><div><span>✓</span><span></span></div><div><span>✓</span><span></span></div><div><span>✓</span><span></span></div></div><div><p>"),_h=H("<br>"),_w=H("<strong>");const Sw=t=>{const{t:e}=it(),r={"min-height":"calc(100vh - 200px)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},n={"text-align":"center","max-width":"600px",width:"100%"},i={"font-size":"5rem",color:"#e53e3e","margin-bottom":"2rem"},o={"font-size":"2.5rem","font-weight":"700",color:"#1a202c","margin-bottom":"1rem"},a={"font-size":"1.25rem",color:"#718096","margin-bottom":"2rem","line-height":"1.6"},c={background:"#f7fafc",border:"1px solid #e2e8f0","border-radius":"0.5rem",padding:"1.5rem","margin-bottom":"2rem"},u={color:"#4a5568","font-size":"1rem","line-height":"1.6"},h={display:"flex",gap:"1rem","justify-content":"center","flex-wrap":"wrap"},f={padding:"0.75rem 2rem","border-radius":"0.5rem","text-decoration":"none","font-weight":"500",transition:"all 0.2s",display:"inline-block"},p={...f,background:"var(--primary-color)",color:"white",border:"2px solid var(--primary-color)"},b={...f,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},C={"text-align":"left","margin-top":"2rem",padding:"0 2rem"},R={display:"flex","align-items":"center",gap:"0.75rem","margin-bottom":"1rem",color:"#4a5568"},E={color:"#48bb78","font-size":"1.25rem"};return S(Ur,{get title(){return e("unauthorized.title")},get children(){var x=bw(),T=x.firstChild,W=T.firstChild,te=W.nextSibling,Q=te.nextSibling,de=Q.firstChild,ae=Q.nextSibling,I=ae.firstChild,_=I.firstChild;_.nextSibling;var v=ae.nextSibling,P=v.firstChild,w=v.nextSibling,A=w.firstChild,y=A.nextSibling,he=y.firstChild,G=he.nextSibling,k=y.nextSibling,Z=k.firstChild,U=Z.nextSibling,F=k.nextSibling,N=F.firstChild,V=N.nextSibling,fe=w.nextSibling,z=fe.firstChild;return d(x,r),d(T,n),d(W,i),d(te,o),s(te,()=>e("unauthorized.accessDenied")),d(Q,a),s(Q,()=>e("unauthorized.noPermission"),de),s(Q,(()=>{var ge=me(()=>!!t.featureName);return()=>ge()?` ${t.featureName}`:` ${e("unauthorized.thisFeature")}`})(),de),d(ae,c),d(I,u),s(_,()=>e("unauthorized.whySeeing")),s(I,()=>e("unauthorized.explanation"),null),s(I,(()=>{var ge=me(()=>!!t.requiredPermission);return()=>ge()&&[_h(),_h(),(()=>{var $=_w();return s($,()=>e("unauthorized.requiredPermission")),$})()," ",me(()=>t.requiredPermission)]})(),null),d(v,h),s(v,S(pn,{href:"/",style:p,get children(){return e("unauthorized.goToDashboard")}}),P),P.$$click=()=>window.history.back(),s(P,()=>e("unauthorized.goBack")),d(w,C),A.style.setProperty("margin-bottom","1rem"),A.style.setProperty("color","#2d3748"),s(A,()=>e("unauthorized.featuresCanAccess")),s(G,()=>e("unauthorized.dashboardAccess")),s(U,()=>e("unauthorized.profileAccess")),s(V,()=>e("unauthorized.roleBasedAccess")),fe.style.setProperty("margin-top","3rem"),fe.style.setProperty("padding","1.5rem"),fe.style.setProperty("background","#edf2f7"),fe.style.setProperty("border-radius","0.5rem"),z.style.setProperty("color","#4a5568"),z.style.setProperty("font-size","0.875rem"),s(z,()=>e("unauthorized.needAccess")),se(ge=>{var $=b,O=R,X=E,Y=R,ue=E,re=R,M=E;return ge.e=d(P,$,ge.e),ge.t=d(y,O,ge.t),ge.a=d(he,X,ge.a),ge.o=d(k,Y,ge.o),ge.i=d(Z,ue,ge.i),ge.n=d(F,re,ge.n),ge.s=d(N,M,ge.s),ge},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),x}})};wt(["click"]);const fn=t=>{const{t:e}=it(),r=()=>{if(!t.permission)return!0;const i=$t.state?.profile;if(!i)return!1;switch(t.permission){case"AccountAccess":return i.AccountAccess===!0;case"InventoryAccess":return i.InventoryAccess===!0;case"EmployeeAccess":return i.EmployeeAccess===!0;case"BankingAccess":return i.BankingAccess===!0;case"JournalAccess":return i.JournalAccess===!0;case"AdminAccess":return i.isAdmin===!0;default:return i[t.permission]===!0}},n=()=>{if(t.requiredPermission)return t.requiredPermission;switch(t.permission){case"AccountAccess":return e("unauthorized.permissions.accountAccess");case"InventoryAccess":return e("unauthorized.permissions.inventoryAccess");case"EmployeeAccess":return e("unauthorized.permissions.employeeAccess");case"BankingAccess":return e("unauthorized.permissions.bankingAccess");case"JournalAccess":return e("unauthorized.permissions.journalAccess");case"AdminAccess":return e("unauthorized.permissions.adminAccess");default:return t.permission}};return S(Ve,{get when(){return r()},get fallback(){return t.fallback||S(Sw,{get featureName(){return t.featureName},get requiredPermission(){return n()}})},get children(){return t.children}})};var Pw=H('<button title="Open Dev Tools">🛠️'),ww=H("<span>(<!>)"),Cw=H("<div><span></span><span>"),Sh=H("<div>"),Aw=H("<div>Database reset only available in fake mode"),Iw=H("<div><div>Loading..."),Ew=H("<div><div><h3>🛠️ Dev Tools</h3><button>✕</button></div><div><div>API Mode</div><div><button>Fake Server</button><button>Real API</button><button>Hybrid</button></div><div>Current: <strong></strong></div></div><div><div>Health Status</div></div><div><div>Database Stats</div></div><div><div>Actions</div><div><button>🔄 Refresh Stats</button><button>💊 Health Check</button></div><div><button>🗑️ Reset DB</button></div></div><div><div>Info</div><div>• <strong>Fake Server:</strong> Uses local mock data<br>• <strong>Real API:</strong> Connects to actual backend<br>• <strong>Hybrid:</strong> Real API with fake fallback<br>• Settings are saved in localStorage"),xw=H("<div>Loading..."),Tw=H("<div><span>:</span><span>");const $w=()=>{const[t,e]=ye(!1),[r,n]=ye(Ho.getMode()),[i,o]=ye({}),[a,c]=ye(null),[u,h]=ye(!1);un(async()=>{await f(),await p()});const f=async()=>{try{const I=await Gu.getStats();o(I)}catch(I){console.error("Failed to load stats:",I)}},p=async()=>{try{const I=await Gu.healthCheck();c(I)}catch(I){console.error("Health check failed:",I),c({status:"error",error:I.message})}},b=async I=>{h(!0);try{Ho.setMode(I),n(I),await f(),await p()}catch(_){console.error("Failed to change API mode:",_)}finally{h(!1)}},C=async()=>{if(confirm("Are you sure you want to reset the fake database to its initial state?")){h(!0);try{const I=await Rr.utils.resetDatabase();alert(I.message),await f()}catch(I){console.error("Failed to reset database:",I),alert("Failed to reset database")}finally{h(!1)}}},R={position:"fixed",bottom:"20px",right:"20px","z-index":"10000","font-family":"monospace"},E={background:"#1a1a1a",color:"#fff",border:"1px solid #333","border-radius":"8px",padding:"16px","min-width":"300px","max-width":"400px","box-shadow":"0 4px 20px rgba(0,0,0,0.3)"},x={background:"#007acc",color:"#fff",border:"none","border-radius":"50%",width:"50px",height:"50px",cursor:"pointer","font-size":"20px","box-shadow":"0 2px 10px rgba(0,0,0,0.2)",display:"flex","align-items":"center","justify-content":"center"},T={background:"#333",color:"#fff",border:"1px solid #555","border-radius":"4px",padding:"6px 12px",cursor:"pointer","font-size":"12px","margin-right":"8px","margin-bottom":"8px"},W={...T,background:"#007acc","border-color":"#007acc"},te={"margin-bottom":"16px","padding-bottom":"12px","border-bottom":"1px solid #333"},Q={"font-size":"14px","font-weight":"bold","margin-bottom":"8px",color:"#007acc"},de={display:"flex","justify-content":"space-between","font-size":"12px","margin-bottom":"4px"},ae=I=>({display:"inline-block",width:"8px",height:"8px","border-radius":"50%","margin-right":"8px",background:I==="healthy"?"#00ff00":I==="error"?"#ff0000":"#ffff00"});return(()=>{var I=Sh();return s(I,S(Ve,{get when(){return!t()},get children(){var _=Pw();return _.$$click=()=>e(!0),d(_,x),_}}),null),s(I,S(Ve,{get when(){return t()},get children(){var _=Ew(),v=_.firstChild,P=v.firstChild,w=P.nextSibling,A=v.nextSibling,y=A.firstChild,he=y.nextSibling,G=he.firstChild,k=G.nextSibling,Z=k.nextSibling,U=he.nextSibling,F=U.firstChild,N=F.nextSibling,V=A.nextSibling,fe=V.firstChild,z=V.nextSibling,ge=z.firstChild,$=z.nextSibling,O=$.firstChild,X=O.nextSibling,Y=X.firstChild,ue=Y.nextSibling,re=X.nextSibling,M=re.firstChild,oe=$.nextSibling,pe=oe.firstChild,be=pe.nextSibling;return d(_,E),v.style.setProperty("display","flex"),v.style.setProperty("justify-content","space-between"),v.style.setProperty("align-items","center"),v.style.setProperty("margin-bottom","16px"),P.style.setProperty("margin","0"),P.style.setProperty("color","#007acc"),P.style.setProperty("font-size","16px"),w.$$click=()=>e(!1),G.$$click=()=>b("fake"),k.$$click=()=>b("real"),Z.$$click=()=>b("hybrid"),U.style.setProperty("font-size","11px"),U.style.setProperty("color","#888"),U.style.setProperty("margin-top","4px"),s(N,r),s(U,()=>r()==="fake"&&" (Using fake server)",null),s(U,()=>r()==="real"&&" (Using real API)",null),s(U,()=>r()==="hybrid"&&" (Real API with fallback)",null),s(V,S(Ve,{get when(){return a()},get fallback(){return(()=>{var ne=xw();return ne.style.setProperty("font-size","12px"),ne})()},get children(){return[(()=>{var ne=Cw(),le=ne.firstChild,j=le.nextSibling;return ne.style.setProperty("display","flex"),ne.style.setProperty("align-items","center"),ne.style.setProperty("font-size","12px"),s(j,()=>a()?.status||"Unknown"),s(ne,S(Ve,{get when(){return a()?.timestamp},get children(){var ce=ww(),D=ce.firstChild,J=D.nextSibling;return J.nextSibling,ce.style.setProperty("margin-left","8px"),ce.style.setProperty("color","#888"),s(ce,()=>new Date(a().timestamp).toLocaleTimeString(),J),ce}}),null),se(ce=>d(le,ae(a()?.status||"unknown"),ce)),ne})(),S(Ve,{get when(){return a()?.error},get children(){var ne=Sh();return ne.style.setProperty("font-size","11px"),ne.style.setProperty("color","#ff6666"),ne.style.setProperty("margin-top","4px"),s(ne,()=>a().error),ne}})]}}),null),s(z,S(Ot,{get each(){return Object.entries(i())},children:([ne,le])=>(()=>{var j=Tw(),ce=j.firstChild,D=ce.firstChild,J=ce.nextSibling;return d(j,de),ce.style.setProperty("text-transform","capitalize"),s(ce,ne,D),J.style.setProperty("color","#00ff00"),s(J,le),j})()}),null),Y.$$click=f,ue.$$click=p,re.style.setProperty("margin-top","8px"),M.$$click=C,s($,S(Ve,{get when(){return r()!=="fake"},get children(){var ne=Aw();return ne.style.setProperty("font-size","11px"),ne.style.setProperty("color","#888"),ne.style.setProperty("margin-top","4px"),ne}}),null),be.style.setProperty("font-size","11px"),be.style.setProperty("color","#888"),be.style.setProperty("line-height","1.4"),s(_,S(Ve,{get when(){return u()},get children(){var ne=Iw(),le=ne.firstChild;return ne.style.setProperty("position","absolute"),ne.style.setProperty("top","0"),ne.style.setProperty("left","0"),ne.style.setProperty("right","0"),ne.style.setProperty("bottom","0"),ne.style.setProperty("background","rgba(0,0,0,0.7)"),ne.style.setProperty("display","flex"),ne.style.setProperty("align-items","center"),ne.style.setProperty("justify-content","center"),ne.style.setProperty("border-radius","8px"),le.style.setProperty("color","#fff"),le.style.setProperty("font-size","14px"),ne}}),null),se(ne=>{var le={...T,padding:"4px 8px"},j=te,ce=Q,D=r()==="fake"?W:T,J=u(),ee=r()==="real"?W:T,q=u(),B=r()==="hybrid"?W:T,_e=u(),we=te,ie=Q,ve=te,K=Q,Pe=te,Te=Q,xe=T,$e=u(),Oe=T,Qe=u(),Ue={...T,background:"#cc4400","border-color":"#cc4400"},Ie=u()||r()!=="fake",Me=Q;return ne.e=d(w,le,ne.e),ne.t=d(A,j,ne.t),ne.a=d(y,ce,ne.a),ne.o=d(G,D,ne.o),J!==ne.i&&(G.disabled=ne.i=J),ne.n=d(k,ee,ne.n),q!==ne.s&&(k.disabled=ne.s=q),ne.h=d(Z,B,ne.h),_e!==ne.r&&(Z.disabled=ne.r=_e),ne.d=d(V,we,ne.d),ne.l=d(fe,ie,ne.l),ne.u=d(z,ve,ne.u),ne.c=d(ge,K,ne.c),ne.w=d($,Pe,ne.w),ne.m=d(O,Te,ne.m),ne.f=d(Y,xe,ne.f),$e!==ne.y&&(Y.disabled=ne.y=$e),ne.g=d(ue,Oe,ne.g),Qe!==ne.p&&(ue.disabled=ne.p=Qe),ne.b=d(M,Ue,ne.b),Ie!==ne.T&&(M.disabled=ne.T=Ie),ne.A=d(pe,Me,ne.A),ne},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),_}}),null),se(_=>d(I,R,_)),I})()};wt(["click"]);var kw=H("<div>$124,350"),Rw=H("<div>+12% from last month"),Dw=H("<div>247"),Mi=H("<div>"),Nw=H("<div>18"),Lw=H("<div>$89,250"),Mw=H("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>");const Ow=()=>{const{t}=it(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},n={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)",margin:"0.5rem 0"},i={"font-size":"0.875rem",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"};return S(Ur,{get title(){return t("dashboard.title")},get children(){return[(()=>{var o=Mi();return d(o,e),s(o,S(Ke,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var a=kw();return se(c=>d(a,n,c)),a})(),(()=>{var a=Rw();return se(c=>d(a,i,c)),a})()]}}),null),s(o,S(Ke,{get title(){return t("dashboard.employeeCount")},get subtitle(){return t("dashboard.current")},get children(){return[(()=>{var a=Dw();return se(c=>d(a,n,c)),a})(),(()=>{var a=Mi();return s(a,()=>t("dashboard.newHires")),se(c=>d(a,i,c)),a})()]}}),null),s(o,S(Ke,{get title(){return t("dashboard.pendingInvoices")},get subtitle(){return t("dashboard.outstanding")},get children(){return[(()=>{var a=Nw();return se(c=>d(a,n,c)),a})(),(()=>{var a=Mi();return s(a,()=>t("dashboard.totalOutstanding")),se(c=>d(a,i,c)),a})()]}}),null),s(o,S(Ke,{get title(){return t("dashboard.cashBalance")},get subtitle(){return t("accounts.title")},get children(){return[(()=>{var a=Lw();return se(c=>d(a,n,c)),a})(),(()=>{var a=Mi();return s(a,()=>t("dashboard.lastUpdatedToday")),se(c=>d(a,i,c)),a})()]}}),null),o})(),(()=>{var o=Mi();return d(o,r),s(o,S(Ke,{get title(){return t("dashboard.quickActions")},get subtitle(){return t("dashboard.commonTasks")},get children(){var a=Mi();return a.style.setProperty("display","flex"),a.style.setProperty("flex-direction","column"),a.style.setProperty("gap","1rem"),s(a,S(De,{variant:"primary",get children(){return t("invoices.createNew")}}),null),s(a,S(De,{variant:"secondary",get children(){return t("employees.addEmployee")}}),null),s(a,S(De,{variant:"outline",get children(){return t("dashboard.generateReport")}}),null),a}}),null),s(o,S(Ke,{get title(){return t("dashboard.recentActivity")},get subtitle(){return t("dashboard.latestUpdates")},get children(){var a=Mw(),c=a.firstChild,u=c.firstChild,h=u.nextSibling,f=c.nextSibling,p=f.firstChild,b=p.nextSibling,C=f.nextSibling,R=C.firstChild,E=R.nextSibling;return a.style.setProperty("display","flex"),a.style.setProperty("flex-direction","column"),a.style.setProperty("gap","0.75rem"),c.style.setProperty("border-bottom","1px solid var(--border-color)"),c.style.setProperty("padding-bottom","0.5rem"),u.style.setProperty("font-weight","500"),s(u,()=>t("dashboard.invoicePaid")),h.style.setProperty("font-size","0.875rem"),h.style.setProperty("color","var(--text-muted)"),s(h,()=>t("dashboard.hoursAgo")),f.style.setProperty("border-bottom","1px solid var(--border-color)"),f.style.setProperty("padding-bottom","0.5rem"),p.style.setProperty("font-weight","500"),s(p,()=>t("dashboard.newEmployeeOnboarded")),b.style.setProperty("font-size","0.875rem"),b.style.setProperty("color","var(--text-muted)"),s(b,()=>t("dashboard.dayAgo")),R.style.setProperty("font-weight","500"),s(R,()=>t("dashboard.monthlyReportGenerated")),E.style.setProperty("font-size","0.875rem"),E.style.setProperty("color","var(--text-muted)"),s(E,()=>t("dashboard.daysAgo")),a}}),null),o})()]}})},Vw=[{id:"1",accountNumber:"1000",name:"Cash and Cash Equivalents",type:"Asset",category:"Current Assets",description:"Cash on hand and in bank accounts",balance:45230.5,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1001",accountNumber:"1001",name:"Petty Cash",type:"Asset",category:"Current Assets",description:"Small amounts of cash for minor expenses",balance:500,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1002",accountNumber:"1002",name:"Bank - Checking Account",type:"Asset",category:"Current Assets",description:"Main operating checking account",balance:32730.5,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1003",accountNumber:"1003",name:"Bank - Savings Account",type:"Asset",category:"Current Assets",description:"Interest-bearing savings account",balance:12e3,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"2",accountNumber:"1100",name:"Accounts Receivable",type:"Asset",category:"Current Assets",description:"Money owed by customers",balance:23450.75,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2001",accountNumber:"1101",name:"Trade Receivables",type:"Asset",category:"Current Assets",description:"Receivables from regular customers",balance:18450.75,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2002",accountNumber:"1102",name:"Employee Advances",type:"Asset",category:"Current Assets",description:"Money advanced to employees",balance:5e3,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"3",accountNumber:"1200",name:"Inventory",type:"Asset",category:"Current Assets",description:"Products held for sale",balance:78920.25,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-13"},{id:"4",accountNumber:"1500",name:"Equipment",type:"Asset",category:"Fixed Assets",description:"Office equipment and machinery",balance:125e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-12"},{id:"5",accountNumber:"2000",name:"Accounts Payable",type:"Liability",category:"Current Liabilities",description:"Money owed to suppliers",balance:15670.3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-11"},{id:"6",accountNumber:"2100",name:"Accrued Expenses",type:"Liability",category:"Current Liabilities",description:"Expenses incurred but not yet paid",balance:8945.6,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-10"},{id:"7",accountNumber:"2500",name:"Long-term Debt",type:"Liability",category:"Long-term Liabilities",description:"Long-term loans and mortgages",balance:85e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-09"},{id:"8",accountNumber:"3000",name:"Owner's Equity",type:"Equity",category:"Owner's Equity",description:"Owner's investment in the business",balance:15e4,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-08"},{id:"9",accountNumber:"3100",name:"Retained Earnings",type:"Equity",category:"Owner's Equity",description:"Accumulated profits retained in business",balance:32450.8,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-07"},{id:"10",accountNumber:"4000",name:"Sales Revenue",type:"Revenue",category:"Operating Revenue",description:"Revenue from product sales",balance:245678.9,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-06"},{id:"11",accountNumber:"4100",name:"Service Revenue",type:"Revenue",category:"Operating Revenue",description:"Revenue from services provided",balance:89432.15,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-05"},{id:"12",accountNumber:"5000",name:"Cost of Goods Sold",type:"Expense",category:"Operating Expenses",description:"Direct costs of producing goods",balance:125678.45,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-04"},{id:"13",accountNumber:"5100",name:"Salaries Expense",type:"Expense",category:"Operating Expenses",description:"Employee salary expenses",balance:98765.32,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-03"},{id:"14",accountNumber:"5200",name:"Rent Expense",type:"Expense",category:"Operating Expenses",description:"Office rent expenses",balance:24e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-02"}],Bw=[{id:"1",accountId:"1",date:"2024-01-15",description:"Customer payment received",debitAmount:5e3,creditAmount:0,reference:"INV-2024-001",type:"debit"},{id:"2",accountId:"2",date:"2024-01-15",description:"Customer payment received",debitAmount:0,creditAmount:5e3,reference:"INV-2024-001",type:"credit"},{id:"3",accountId:"5",date:"2024-01-14",description:"Office supplies purchased",debitAmount:0,creditAmount:1250,reference:"PO-2024-001",type:"credit"}],[Jr,ks]=ye(Vw),[gl,Fw]=ye(Bw),ut={get accounts(){return Jr()},get transactions(){return gl()},fetchAllAccount(t){const e={...t,id:Date.now().toString(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return ks([...Jr(),e]),e},addAccount(t){const e={...t,id:Date.now().toString(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return ks([...Jr(),e]),e},updateAccount(t,e){ks(Jr().map(r=>r.id===t?{...r,...e,lastModified:new Date().toISOString().split("T")[0]}:r))},deleteAccount(t){ks(Jr().filter(e=>e.id!==t))},getAccountById(t){return Jr().find(e=>e.id===t)},getAccountsByType(t){return Jr().filter(e=>e.type===t)},getAccountTransactions(t){return gl().filter(e=>e.accountId===t)},addTransaction(t){const e={...t,id:Date.now().toString()};Fw([...gl(),e]);const r=this.getAccountById(t.accountId);if(r){const n=t.type==="debit"?t.debitAmount:-t.creditAmount;this.updateAccount(t.accountId,{balance:r.balance+n})}return e},getTotalByType(t){return Jr().filter(e=>e.type===t&&e.isActive).reduce((e,r)=>e+r.balance,0)},getAccountCategories(t){const e=this.getAccountsByType(t);return[...new Set(e.map(r=>r.category))]},getSubAccounts(t){return Jr().filter(e=>e.parentAccountId===t)},getParentAccounts(){return Jr().filter(t=>!t.parentAccountId)},getAccountHierarchy(){return this.getParentAccounts().map(e=>({...e,subAccounts:this.getSubAccounts(e.id)}))},getAccountWithSubAccounts(t){const e=this.getAccountById(t);return e?{...e,subAccounts:this.getSubAccounts(t),parentAccount:e.parentAccountId?this.getAccountById(e.parentAccountId):null}:null},getAccountPath(t){const e=this.getAccountById(t);if(!e)return[];const r=[e];let n=e;for(;n.parentAccountId;){const i=this.getAccountById(n.parentAccountId);if(i)r.unshift(i),n=i;else break}return r},getTotalBalanceWithSubAccounts(t){const e=this.getAccountById(t);if(!e)return 0;const n=this.getSubAccounts(t).reduce((i,o)=>i+this.getTotalBalanceWithSubAccounts(o.id),0);return e.balance+n},canDeleteAccount(t){const e=this.getSubAccounts(t);if(e.length>0)return{canDelete:!1,reason:`Account has ${e.length} sub-account(s). Delete or move sub-accounts first.`};const r=this.getAccountTransactions(t);return r.length>0?{canDelete:!1,reason:`Account has ${r.length} transaction(s). Cannot delete account with transaction history.`}:{canDelete:!0}}};var Rn=H("<div>"),So=H("<div> ");const Uw=()=>{const{t}=it(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},n={"font-size":"0.875rem",color:"var(--text-muted)"},i=E=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(E),o=ut.getTotalByType("Asset"),a=ut.getTotalByType("Liability"),c=ut.getTotalByType("Equity"),u=ut.getTotalByType("Revenue"),h=ut.getTotalByType("Expense"),f=ut.getAccountsByType("Asset").length,p=ut.getAccountsByType("Liability").length,b=ut.getAccountsByType("Equity").length,C=ut.getAccountsByType("Revenue").length,R=ut.getAccountsByType("Expense").length;return(()=>{var E=Rn();return d(E,e),s(E,S(Ke,{get title(){return t("dashboard.totalAssets")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var x=Rn();return s(x,()=>i(o)),se(T=>d(x,r,T)),x})(),(()=>{var x=So(),T=x.firstChild;return s(x,f,T),s(x,()=>t("navigation.accounts"),null),se(W=>d(x,n,W)),x})()]}}),null),s(E,S(Ke,{get title(){return t("dashboard.totalLiabilities")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var x=Rn();return s(x,()=>i(a)),se(T=>d(x,r,T)),x})(),(()=>{var x=So(),T=x.firstChild;return s(x,p,T),s(x,()=>t("navigation.accounts"),null),se(W=>d(x,n,W)),x})()]}}),null),s(E,S(Ke,{get title(){return t("dashboard.totalEquity")},get subtitle(){return t("accounts.categories.ownersEquity")},get children(){return[(()=>{var x=Rn();return s(x,()=>i(c)),se(T=>d(x,r,T)),x})(),(()=>{var x=So(),T=x.firstChild;return s(x,b,T),s(x,()=>t("navigation.accounts"),null),se(W=>d(x,n,W)),x})()]}}),null),s(E,S(Ke,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("accounts.categories.operatingRevenue")},get children(){return[(()=>{var x=Rn();return s(x,()=>i(u)),se(T=>d(x,r,T)),x})(),(()=>{var x=So(),T=x.firstChild;return s(x,C,T),s(x,()=>t("navigation.accounts"),null),se(W=>d(x,n,W)),x})()]}}),null),s(E,S(Ke,{get title(){return t("dashboard.totalExpenses")},get subtitle(){return t("accounts.categories.operatingExpenses")},get children(){return[(()=>{var x=Rn();return s(x,()=>i(h)),se(T=>d(x,r,T)),x})(),(()=>{var x=So(),T=x.firstChild;return s(x,R,T),s(x,()=>t("navigation.accounts"),null),se(W=>d(x,n,W)),x})()]}}),null),s(E,S(Ke,{get title(){return t("dashboard.netIncome")},get subtitle(){return`${t("dashboard.totalRevenue")} - ${t("dashboard.totalExpenses")}`},get children(){return[(()=>{var x=Rn();return s(x,()=>i(u-h)),se(T=>d(x,{...r,color:u-h>=0?"#4caf50":"#f44336"},T)),x})(),(()=>{var x=Rn();return s(x,()=>u-h>=0?t("dashboard.netIncome"):t("dashboard.netLoss")),se(T=>d(x,n,T)),x})()]}}),null),E})()};var jw=H("<div><div></div><div>"),zw=H("<h3>"),Po=H("<div>");const qw=t=>{const{t:e}=it();bc();const r={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},i={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"},o={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},a={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},c={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem"},u={"font-size":"0.875rem",color:"var(--text-secondary)","line-height":"1.4"},h=b=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[b]||{bg:"#f5f5f5",color:"#666"},f=b=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(b),p=h(t.account.type);return S(Ke,{get children(){return[(()=>{var b=jw(),C=b.firstChild,R=C.nextSibling;return d(b,n),d(C,i),s(C,()=>t.account.accountNumber),s(R,()=>e(`accounts.types.${t.account.type.toLowerCase()}`)),se(E=>d(R,{...o,background:p.bg,color:p.color},E)),b})(),(()=>{var b=zw();return b.style.setProperty("margin","0 0 0.5rem 0"),b.style.setProperty("font-size","1.1rem"),s(b,()=>t.account.name),b})(),(()=>{var b=Po();return d(b,c),s(b,()=>t.account.category),b})(),(()=>{var b=Po();return d(b,a),s(b,()=>f(t.account.balance)),b})(),(()=>{var b=Po();return d(b,u),s(b,()=>t.account.description),b})(),me(()=>me(()=>!t.account.isActive)()&&(()=>{var b=Po();return b.style.setProperty("margin-top","0.5rem"),b.style.setProperty("padding","0.25rem 0.75rem"),b.style.setProperty("border-radius","9999px"),b.style.setProperty("font-size","0.75rem"),b.style.setProperty("font-weight","500"),b.style.setProperty("background","#ffebee"),b.style.setProperty("color","#d32f2f"),b.style.setProperty("text-align","center"),s(b,()=>e("common.inactive")),b})()),(()=>{var b=Po();return d(b,r),s(b,S(De,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.account),get children(){return[me(()=>e("common.view"))," ",me(()=>e("accounts.accountDetails"))]}})),b})()]}})};var Hw=H("<div><div><div><div></div><h3></h3></div></div><div><div></div><div>"),Ww=H("<div>"),Gw=H("<button>"),Yw=H("<div><h4> (<!>)"),Kw=H("<div><div><div></div><div> • </div></div><div>");const Qw=t=>{const{t:e}=it(),r=bc(),[n,i]=ye(!0),o={"margin-bottom":"1rem"},a={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},c={display:"flex","align-items":"center",gap:"1rem"},u={background:"none",border:"none",cursor:"pointer","font-size":"1.2rem",color:"var(--text-muted)",padding:"0.25rem","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease"},h={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},f={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},p={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},b={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},C={"margin-left":"1rem","border-left":"2px solid var(--border-color)","padding-left":"1rem","margin-top":"1rem"},R={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem","margin-bottom":"0.5rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},E={flex:"1"},x={"font-weight":"500","margin-bottom":"0.25rem"},T={"font-size":"0.875rem",color:"var(--text-muted)"},W={"font-weight":"600",color:"var(--primary-color)"},te={display:"flex",gap:"0.5rem"},Q=P=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[P]||{bg:"#f5f5f5",color:"#666"},de=P=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(P),ae=P=>{t.onViewDetails?t.onViewDetails(P):r(`/accounts/${P.id}`)},I=()=>{t.onAddSubAccount&&t.onAddSubAccount(t.account)},_=t.account.balance+t.account.subAccounts.reduce((P,w)=>P+w.balance,0),v=Q(t.account.type);return S(Ke,{className:"account-hierarchy-card",style:o,get children(){return[(()=>{var P=Hw(),w=P.firstChild,A=w.firstChild,y=A.firstChild,he=y.nextSibling,G=w.nextSibling,k=G.firstChild,Z=k.nextSibling;return d(P,a),d(w,c),s(w,(()=>{var U=me(()=>t.account.subAccounts.length>0);return()=>U()&&(()=>{var F=Gw();return F.addEventListener("mouseleave",N=>N.target.style.background="none"),F.addEventListener("mouseenter",N=>N.target.style.background="var(--background-color)"),F.$$click=()=>i(!n()),d(F,u),s(F,()=>n()?"▼":"▶"),F})()})(),A),A.$$click=()=>ae(t.account),A.style.setProperty("cursor","pointer"),d(y,h),s(y,()=>t.account.accountNumber),d(he,f),s(he,()=>t.account.name),G.style.setProperty("text-align","right"),d(k,p),s(k,()=>de(_)),s(Z,()=>e(`accounts.types.${t.account.type.toLowerCase()}`)),se(U=>d(Z,{...b,background:v.bg,color:v.color},U)),P})(),(()=>{var P=Ww();return d(P,te),s(P,S(De,{variant:"secondary",size:"sm",onClick:()=>ae(t.account),get children(){return[me(()=>e("common.view"))," ",me(()=>e("accounts.accountDetails"))]}}),null),s(P,S(De,{variant:"outline",size:"sm",onClick:I,get children(){return[me(()=>e("common.add"))," ",me(()=>e("accounts.subAccounts"))]}}),null),P})(),me(()=>me(()=>!!(n()&&t.account.subAccounts.length>0))()&&(()=>{var P=Yw(),w=P.firstChild,A=w.firstChild,y=A.nextSibling;return y.nextSibling,d(P,C),w.style.setProperty("margin","0 0 1rem 0"),w.style.setProperty("font-size","1rem"),w.style.setProperty("color","var(--text-muted)"),s(w,()=>e("accounts.subAccounts"),A),s(w,()=>t.account.subAccounts.length,y),s(P,()=>t.account.subAccounts.map(he=>(()=>{var G=Kw(),k=G.firstChild,Z=k.firstChild,U=Z.nextSibling,F=U.firstChild,N=k.nextSibling;return G.addEventListener("mouseleave",V=>{V.currentTarget.style.background="var(--background-color)",V.currentTarget.style.transform="translateY(0)"}),G.addEventListener("mouseenter",V=>{V.currentTarget.style.background="var(--surface-color)",V.currentTarget.style.transform="translateY(-1px)"}),G.$$click=()=>ae(he),d(G,R),d(k,E),d(Z,x),s(Z,()=>he.name),d(U,T),s(U,()=>he.accountNumber,F),s(U,()=>he.description,null),d(N,W),s(N,()=>de(he.balance)),G})()),null),P})())]}})};wt(["click"]);var Jw=H("<form><div>");const Xw=t=>{const{t:e}=it(),[r,n]=ye({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),i=[{value:"Asset",label:e("accounts.types.asset"),type:"debit",classification:"real"},{value:"Liability",label:e("accounts.types.liability"),type:"credit",classification:"real"},{value:"Equity",label:e("accounts.types.equity"),type:"credit",classification:"real"},{value:"Revenue",label:e("accounts.types.revenue"),type:"credit",classification:"nominal"},{value:"Expense",label:e("accounts.types.expense"),type:"debit",classification:"nominal"}],o=()=>{const f=r().type;return f?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")},{value:"Sales Revenue",label:e("accounts.categories.salesRevenue")},{value:"Service Revenue",label:e("accounts.categories.servicesRevenue")},{value:"Subscription Revenue",label:e("accounts.categories.subscriptionRevenue")},{value:"Rental Revenue",label:e("accounts.categories.rentalRevenue")},{value:"Commission Revenue",label:e("accounts.categories.commissionRevenue")},{value:"Franchise Revenue",label:e("accounts.categories.franchiseRevenue")},{value:"Licensing Revenue",label:e("accounts.categories.licensingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[f]||[]:[]},a=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],c={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},u=f=>{f.preventDefault();const p=r();if(!p.accountNumber||!p.name||!p.type||!p.category){alert(e("forms.requiredField"));return}if(ut.accounts.find(R=>R.accountNumber===p.accountNumber)){alert(e("forms.duplicateAccountNumber"));return}const C={accountNumber:p.accountNumber,name:p.name,type:p.type,category:p.category,description:p.description,balance:parseFloat(p.balance)||0,isActive:p.isActive==="true"};ut.addAccount(C),n({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},h=(f,p)=>{n(b=>{const C={...b,[f]:p};return f==="type"&&(C.category=""),C})};return S(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.addAccount")},get children(){var f=Jw(),p=f.firstChild;return f.addEventListener("submit",u),s(f,S(Pt,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:b=>h("accountNumber",b),get placeholder(){return e("accounts.accountNumber")},required:!0}),p),s(f,S(Pt,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:b=>h("name",b),get placeholder(){return e("accounts.accountName")},required:!0}),p),s(f,S(mr,{get label(){return e("accounts.accountType")},get value(){return r().type},onChange:b=>h("type",b),options:i,required:!0}),p),s(f,S(mr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:b=>h("category",b),get options(){return o()},required:!0}),p),s(f,S(Pt,{get label(){return e("common.description")},get value(){return r().description},onChange:b=>h("description",b),get placeholder(){return e("common.description")}}),p),s(f,S(Pt,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:b=>h("balance",b),get placeholder(){return e("accounts.balance")}}),p),s(f,S(mr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:b=>h("isActive",b),options:a,required:!0}),p),d(p,c),s(p,S(De,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(p,S(De,{variant:"primary",type:"submit",get children(){return e("accounts.addAccount")}}),null),f}})};var Zw=H("<form><div>"),eC=H("<div><div></div><div> - </div><div> • ");const tC=t=>{const{t:e}=it(),[r,n]=ye({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),i=()=>t.parentAccount?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[t.parentAccount.type]||[]:[],o=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],a={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},c={background:"var(--background-color)",padding:"1rem","border-radius":"var(--border-radius-sm)","margin-bottom":"1.5rem",border:"1px solid var(--border-color)"},u={"font-size":"0.875rem","font-weight":"500",color:"var(--text-muted)","margin-bottom":"0.5rem"},h={"font-weight":"600",color:"var(--text-primary)"},f={"font-size":"0.875rem",color:"var(--text-secondary)"},p=E=>{E.preventDefault();const x=r();if(!x.accountNumber||!x.name||!x.category||!t.parentAccount){alert(e("forms.requiredField"));return}if(ut.accounts.find(te=>te.accountNumber===x.accountNumber)){alert(e("forms.duplicateAccountNumber"));return}const W={accountNumber:x.accountNumber,name:x.name,type:t.parentAccount.type,category:x.category,description:x.description,balance:parseFloat(x.balance)||0,isActive:x.isActive==="true",parentAccountId:t.parentAccount.id};ut.addAccount(W),n({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},b=(E,x)=>{n(T=>({...T,[E]:x}))},C=()=>{if(!t.parentAccount)return"";const E=t.parentAccount.accountNumber,T=ut.getSubAccounts(t.parentAccount.id).length+1;return(parseInt(E)+T).toString()},R=()=>r().accountNumber===""&&t.parentAccount?C():r().accountNumber;return S(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return`${e("common.add")} ${e("accounts.subAccounts")}`},get children(){return[me(()=>me(()=>!!t.parentAccount)()&&(()=>{var E=eC(),x=E.firstChild,T=x.nextSibling,W=T.firstChild,te=T.nextSibling,Q=te.firstChild;return d(E,c),d(x,u),s(x,()=>e("accounts.parentAccount")),d(T,h),s(T,()=>t.parentAccount.accountNumber,W),s(T,()=>t.parentAccount.name,null),d(te,f),s(te,()=>e(`accounts.types.${t.parentAccount.type.toLowerCase()}`),Q),s(te,()=>t.parentAccount.category,null),E})()),(()=>{var E=Zw(),x=E.firstChild;return E.addEventListener("submit",p),s(E,S(Pt,{get label(){return e("accounts.accountNumber")},get value(){return R()},onChange:T=>b("accountNumber",T),get placeholder(){return`${e("common.suggested")}: ${C()}`},required:!0}),x),s(E,S(Pt,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:T=>b("name",T),get placeholder(){return e("accounts.accountName")},required:!0}),x),s(E,S(mr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:T=>b("category",T),get options(){return i()},required:!0}),x),s(E,S(Pt,{get label(){return e("common.description")},get value(){return r().description},onChange:T=>b("description",T),get placeholder(){return e("common.description")}}),x),s(E,S(Pt,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:T=>b("balance",T),get placeholder(){return e("accounts.balance")}}),x),s(E,S(mr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:T=>b("isActive",T),options:o,required:!0}),x),d(x,a),s(x,S(De,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(x,S(De,{variant:"primary",type:"submit",get children(){return[me(()=>e("common.add"))," ",me(()=>e("accounts.subAccounts"))]}}),null),E})()]}})};var rC=H("<form><div>"),nC=H("<div>");const iC=t=>{const{t:e}=it(),[r,n]=ye({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),[i,o]=ye(null);ei(()=>{t.account&&(n({accountNumber:t.account.accountNumber,name:t.account.name,type:t.account.type,category:t.account.category,description:t.account.description,balance:t.account.balance.toString(),isActive:t.account.isActive.toString()}),o(null))});const a=[{value:"Asset",label:e("accounts.types.asset")},{value:"Liability",label:e("accounts.types.liability")},{value:"Equity",label:e("accounts.types.equity")},{value:"Revenue",label:e("accounts.types.revenue")},{value:"Expense",label:e("accounts.types.expense")}],c=()=>{const C=r().type;return C?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[C]||[]:[]},u=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],h={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},f=C=>{if(C.preventDefault(),o(null),!t.account)return;const R=r();if(!R.accountNumber||!R.name||!R.type||!R.category){o(e("forms.requiredField"));return}if(ut.accounts.find(T=>T.accountNumber===R.accountNumber&&T.id!==t.account.id)){o(e("forms.duplicateAccountNumber"));return}const x={accountNumber:R.accountNumber,name:R.name,type:R.type,category:R.category,description:R.description,balance:parseFloat(R.balance)||0,isActive:R.isActive==="true"};try{ut.updateAccount(t.account.id,x),t.onClose()}catch(T){o(T instanceof Error?T.message:e("forms.saveError"))}},p=()=>{if(!t.account)return;const C=ut.canDeleteAccount(t.account.id);if(!C.canDelete){o(C.reason||e("forms.deleteError"));return}const R=e("forms.confirmDelete");if(confirm(R))try{ut.deleteAccount(t.account.id),t.onClose()}catch(E){o(E instanceof Error?E.message:e("forms.deleteError"))}},b=(C,R)=>{n(E=>{const x={...E,[C]:R};return C==="type"&&(x.category=""),x}),i()&&o(null)};return t.account?S(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.editAccount")},get children(){var C=rC(),R=C.firstChild;return C.addEventListener("submit",f),s(C,S(Pt,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:E=>b("accountNumber",E),get placeholder(){return e("accounts.accountNumber")},required:!0}),R),s(C,S(Pt,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:E=>b("name",E),get placeholder(){return e("accounts.accountName")},required:!0}),R),s(C,S(mr,{get label(){return e("accounts.accountType")},get value(){return r().type},onChange:E=>b("type",E),options:a,required:!0}),R),s(C,S(mr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:E=>b("category",E),get options(){return c()},required:!0}),R),s(C,S(Pt,{get label(){return e("common.description")},get value(){return r().description},onChange:E=>b("description",E),get placeholder(){return e("common.description")}}),R),s(C,S(Pt,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:E=>b("balance",E),get placeholder(){return e("accounts.balance")}}),R),s(C,S(mr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:E=>b("isActive",E),options:u,required:!0}),R),s(C,(()=>{var E=me(()=>!!i());return()=>E()&&(()=>{var x=nC();return x.style.setProperty("padding","1rem"),x.style.setProperty("border-radius","var(--border-radius-sm)"),x.style.setProperty("margin-top","1rem"),x.style.setProperty("background","#f8d7da"),x.style.setProperty("color","#721c24"),x.style.setProperty("border","1px solid #f5c6cb"),s(x,i),x})()})(),R),d(R,h),s(R,S(De,{variant:"outline",type:"button",onClick:p,style:{color:"#dc3545","border-color":"#dc3545","margin-right":"auto"},get children(){return e("accounts.deleteAccount")}}),null),s(R,S(De,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(R,S(De,{variant:"primary",type:"submit",get children(){return e("common.save")}}),null),C}}):null};var oC=H("<div><div>⚠️</div><div></div><div></div><div>"),sC=H("<div><div></div><div></div><div>"),aC=H("<div><button></button><button> (<!>)"),pl=H("<div>"),lC=H("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),cC=H("<div><div><div></div><div> • </div></div><div>");const uC=t=>{const{t:e}=it(),[r,n]=ye("details"),[i,o]=ye(!1),a=ze(()=>t.account?ut.getAccountById(t.account.id)||t.account:null),c={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},u={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},h={"font-weight":"600",color:"var(--text-primary)"},f={"text-align":"center","margin-bottom":"2rem"},p={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},b={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},C={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem"},R={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},E=v=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:v?"var(--primary-color)":"var(--text-muted)","border-bottom":v?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),x={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},T={flex:"1"},W={"font-size":"0.875rem",color:"var(--text-muted)"},te={"font-weight":"500","margin-bottom":"0.25rem"},Q=v=>({"font-weight":"600",color:v==="debit"?"#4caf50":"#f44336"}),de={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},ae=v=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[v]||{bg:"#f5f5f5",color:"#666"},I=v=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(v),_=v=>new Date(v).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return S(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.accountDetails")},get children(){return[me(()=>me(()=>!a())()?(()=>{var v=oC(),P=v.firstChild,w=P.nextSibling,A=w.nextSibling,y=A.nextSibling;return v.style.setProperty("text-align","center"),v.style.setProperty("padding","3rem"),v.style.setProperty("color","var(--text-muted)"),P.style.setProperty("font-size","1.5rem"),P.style.setProperty("margin-bottom","1rem"),w.style.setProperty("font-size","1.1rem"),w.style.setProperty("margin-bottom","0.5rem"),s(w,()=>e("common.error")),A.style.setProperty("font-size","0.875rem"),s(A,()=>e("common.noDataFound")),y.style.setProperty("margin-top","2rem"),s(y,S(De,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),v})():(()=>{const v=ze(()=>ae(a().type)),P=ze(()=>ut.getAccountTransactions(a().id));return[(()=>{var w=sC(),A=w.firstChild,y=A.nextSibling,he=y.nextSibling;return d(w,f),d(A,p),s(A,()=>a().name),d(y,b),s(y,()=>I(a().balance)),s(he,()=>e(`accounts.types.${a().type.toLowerCase()}`)),se(G=>d(he,{...C,background:v().bg,color:v().color},G)),w})(),(()=>{var w=aC(),A=w.firstChild,y=A.nextSibling,he=y.firstChild,G=he.nextSibling;return G.nextSibling,d(w,R),A.$$click=()=>n("details"),s(A,()=>e("accounts.accountDetails")),y.$$click=()=>n("transactions"),s(y,()=>e("accounts.transactions"),he),s(y,()=>P().length,G),se(k=>{var Z=E(r()==="details"),U=E(r()==="transactions");return k.e=d(A,Z,k.e),k.t=d(y,U,k.t),k},{e:void 0,t:void 0}),w})(),me(()=>me(()=>r()==="details")()&&(()=>{var w=lC(),A=w.firstChild,y=A.firstChild,he=y.nextSibling,G=A.nextSibling,k=G.firstChild,Z=k.nextSibling,U=G.nextSibling,F=U.firstChild,N=F.nextSibling,V=U.nextSibling,fe=V.firstChild,z=fe.nextSibling,ge=V.nextSibling,$=ge.firstChild,O=$.nextSibling,X=ge.nextSibling,Y=X.firstChild,ue=Y.nextSibling;return s(y,()=>e("accounts.accountNumber")),s(he,()=>a().accountNumber),s(k,()=>e("accounts.category")),s(Z,()=>a().category),s(F,()=>e("common.description")),s(N,()=>a().description),s(fe,()=>e("common.status")),s(z,(()=>{var re=me(()=>!!a().isActive);return()=>re()?e("common.active"):e("common.inactive")})()),s($,()=>e("accounts.createdDate")),s(O,()=>_(a().createdDate)),s(Y,()=>e("accounts.lastModified")),s(ue,()=>_(a().lastModified)),se(re=>{var M=c,oe=u,pe=h,be=c,ne=u,le=h,j=c,ce=u,D=h,J=c,ee=u,q=h,B=c,_e=u,we=h,ie=c,ve=u,K=h;return re.e=d(A,M,re.e),re.t=d(y,oe,re.t),re.a=d(he,pe,re.a),re.o=d(G,be,re.o),re.i=d(k,ne,re.i),re.n=d(Z,le,re.n),re.s=d(U,j,re.s),re.h=d(F,ce,re.h),re.r=d(N,D,re.r),re.d=d(V,J,re.d),re.l=d(fe,ee,re.l),re.u=d(z,q,re.u),re.c=d(ge,B,re.c),re.w=d($,_e,re.w),re.m=d(O,we,re.m),re.f=d(X,ie,re.f),re.y=d(Y,ve,re.y),re.g=d(ue,K,re.g),re},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),w})()),me(()=>me(()=>r()==="transactions")()&&(()=>{var w=pl();return s(w,(()=>{var A=me(()=>P().length===0);return()=>A()?(()=>{var y=pl();return y.style.setProperty("text-align","center"),y.style.setProperty("color","var(--text-muted)"),y.style.setProperty("padding","2rem"),s(y,()=>e("common.noDataFound")),y})():P().map(y=>(()=>{var he=cC(),G=he.firstChild,k=G.firstChild,Z=k.nextSibling,U=Z.firstChild,F=G.nextSibling;return d(he,x),d(G,T),d(k,te),s(k,()=>y.description),d(Z,W),s(Z,()=>_(y.date),U),s(Z,()=>y.reference,null),s(F,()=>y.type==="debit"?"+":"-",null),s(F,()=>I(y.type==="debit"?y.debitAmount:y.creditAmount),null),se(N=>d(F,Q(y.type),N)),he})())})()),w})()),(()=>{var w=pl();return d(w,de),s(w,S(De,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(w,S(De,{variant:"primary",onClick:()=>o(!0),get children(){return e("accounts.editAccount")}}),null),w})()]})()),me(()=>me(()=>!!a())()&&S(iC,{get isOpen(){return i()},onClose:()=>{o(!1)},get account(){return a()}}))]}})};wt(["click"]);const dC="https://qvamarkets.com/gql_api",[hC,Ph]=ye(!1),[mC,vl]=ye(null);class fC{baseUrl;constructor(e=dC){this.baseUrl=e}async request(e,r,n,i){Ph(!0),vl(null);try{const o=r.startsWith("http")?r:`${this.baseUrl}${r}`,a={method:e,headers:{"Content-Type":"application/json",Accept:"application/json",...i}};n&&(e==="POST"||e==="PUT"||e==="PATCH")&&(a.body=JSON.stringify(n));const c=await fetch(o,a);if(!c.ok)throw new Error(`HTTP error! status: ${c.status}`);const u=await c.json();if(u.errors&&u.errors.length>0)throw new Error(u.errors[0].message);return u.data||u}catch(o){const a=o instanceof Error?o.message:"Unknown error occurred";throw vl(a),o}finally{Ph(!1)}}async graphql(e){return this.request("POST","",e)}async get(e,r){return this.request("GET",e,void 0,r)}async post(e,r,n){return this.request("POST",e,r,n)}async put(e,r,n){return this.request("PUT",e,r,n)}async patch(e,r,n){return this.request("PATCH",e,r,n)}async delete(e,r){return this.request("DELETE",e,void 0,r)}getLoadingState(){return hC()}getErrorState(){return mC()}clearError(){vl(null)}}const Rs=new fC,du=`
  fragment AccountFields on Account {
    id
    accountNumber
    name
    type
    category
    description
    balance
    isActive
    parentAccountId
    createdDate
    lastModified
  }
`,yC=`
  query GetAccountById($id: ID!) {
    account(id: $id) {
      ...AccountFields
    }
  }
  ${du}
`,gC=`
  mutation CreateAccount($input: CreateAccountInput!) {
    createAccount(input: $input) {
      ...AccountFields
    }
  }
  ${du}
`,pC=`
  mutation UpdateAccount($id: ID!, $input: UpdateAccountInput!) {
    updateAccount(id: $id, input: $input) {
      ...AccountFields
    }
  }
  ${du}
`,vC=`
  mutation DeleteAccount($id: ID!) {
    deleteAccount(id: $id) {
      success
      message
    }
  }
`;class bC{async getAccounts(e,r){try{if(Ho.isFakeMode())return await Wu.getAll(e);const n=await Bn({query:"getAllYabaProducts",params:{businessId:"YB100423253156428"}});return console.log("Real API accounts response:",n),n?.accounts||[]}catch(n){if(console.error("Error fetching accounts:",n),Ho.isHybridMode())return console.warn("Falling back to fake API for accounts"),await Wu.getAll(e);throw n}}async getAccountById(e){try{return(await Rs.graphql({query:yC,variables:{id:e}})).account}catch(r){throw console.error("Error fetching account:",r),r}}async createAccount(e){try{return(await Rs.graphql({query:gC,variables:{input:e}})).createAccount}catch(r){throw console.error("Error creating account:",r),r}}async updateAccount(e,r){try{return(await Rs.graphql({query:pC,variables:{id:e,input:r}})).updateAccount}catch(n){throw console.error("Error updating account:",n),n}}async deleteAccount(e){try{return(await Rs.graphql({query:vC,variables:{id:e}})).deleteAccount}catch(r){throw console.error("Error deleting account:",r),r}}async getAccountsByType(e){return this.getAccounts({type:e})}async getAccountHierarchy(){const e=await this.getAccounts();return this.buildHierarchy(e)}buildHierarchy(e){const r=new Map,n=[];return e.forEach(i=>{r.set(i.id,{...i,subAccounts:[]})}),e.forEach(i=>{const o=r.get(i.id);if(i.parentAccountId){const a=r.get(i.parentAccountId);a&&(a.subAccounts=a.subAccounts||[],a.subAccounts.push(o))}else n.push(o)}),n}async getAccountBalance(e){const r=await this.getAccountById(e);return r?r.balance:0}async searchAccounts(e){return this.getAccounts({search:e})}}const _C=new bC;var SC=H("<div><h2></h2><div><span>:</span><button></button><button>"),PC=H("<div><span>:"),wh=H("<div>"),wC=H("<button>");const CC=()=>{const{t}=it(),[e,r]=ye(!1),[n,i]=ye(!1),[o,a]=ye(!1),[c,u]=ye(null),[h,f]=ye(null),[p,b]=ye("All"),[C,R]=ye("hierarchy"),E=_=>{u(_),a(!0)},x=_=>{f(_),i(!0)},T=()=>p()==="All"?C()==="hierarchy"?ut.getAccountHierarchy():ut.accounts:C()==="hierarchy"?ut.getAccountHierarchy().filter(_=>_.type===p()):ut.getAccountsByType(p()),W={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(350px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},te={display:"flex",gap:"1rem","margin-bottom":"2rem","align-items":"center"},Q=_=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:_?"var(--primary-color)":"var(--surface-color)",color:_?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500",transition:"all 0.2s ease"}),de={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},ae={display:"flex",gap:"0.5rem","align-items":"center","margin-left":"auto","margin-right":"1rem"},I=_=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:_?"var(--primary-color)":"var(--surface-color)",color:_?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"});return S(Ur,{get title(){return t("accounts.title")},get children(){return[S(Uw,{}),(()=>{var _=SC(),v=_.firstChild,P=v.nextSibling,w=P.firstChild,A=w.firstChild,y=w.nextSibling,he=y.nextSibling;return d(_,de),v.style.setProperty("margin","0"),v.style.setProperty("font-size","1.5rem"),s(v,()=>t("accounts.title")),d(P,ae),w.style.setProperty("font-weight","500"),w.style.setProperty("color","var(--text-muted)"),w.style.setProperty("font-size","0.875rem"),s(w,()=>t("common.view"),A),y.$$click=()=>R("hierarchy"),s(y,()=>t("accounts.accountHierarchy")),he.$$click=()=>{R("flat"),_C.getAccounts()},s(he,()=>t("common.all")),s(_,S(De,{variant:"primary",onClick:()=>r(!0),get children(){return t("accounts.addAccount")}}),null),se(G=>{var k=I(C()==="hierarchy"),Z=I(C()==="flat");return G.e=d(y,k,G.e),G.t=d(he,Z,G.t),G},{e:void 0,t:void 0}),_})(),(()=>{var _=PC(),v=_.firstChild,P=v.firstChild;return d(_,te),v.style.setProperty("font-weight","500"),v.style.setProperty("color","var(--text-muted)"),s(v,()=>t("common.filter"),P),s(_,()=>[t("common.all"),t("accounts.types.asset"),t("accounts.types.liability"),t("accounts.types.equity"),t("accounts.types.revenue"),t("accounts.types.expense")].map((w,A)=>{const he=["All","Asset","Liability","Equity","Revenue","Expense"][A];return(()=>{var G=wC();return G.$$click=()=>b(he),s(G,w),se(k=>d(G,Q(p()===he),k)),G})()}),null),_})(),(()=>{var _=wh();return s(_,(()=>{var v=me(()=>C()==="hierarchy");return()=>v()?T().map(P=>S(Qw,{account:P,onAddSubAccount:x,onViewDetails:E})):T().map(P=>S(qw,{account:P,onViewDetails:E}))})()),se(v=>d(_,C()==="hierarchy"?{display:"flex","flex-direction":"column",gap:"1rem"}:W,v)),_})(),me(()=>me(()=>T().length===0)()&&(()=>{var _=wh();return _.style.setProperty("text-align","center"),_.style.setProperty("color","var(--text-muted)"),_.style.setProperty("padding","3rem"),_.style.setProperty("font-size","1.1rem"),s(_,()=>t("common.noDataFound")),_})()),S(Xw,{get isOpen(){return e()},onClose:()=>r(!1)}),S(tC,{get isOpen(){return n()},onClose:()=>i(!1),get parentAccount(){return h()}}),S(uC,{get isOpen(){return o()},onClose:()=>a(!1),get account(){return c()}})]}})};wt(["click"]);var AC=H("<div><h2>"),Oi=H("<div>"),IC=H("<div><div><div></div><h1></h1><div></div></div><div>"),EC=H("<div><button></button><button> (<!>)"),Ds=H("<div><span></span><span>"),xC=H("<p>"),TC=H("<div><div></div><div>"),$C=H("<div><div><div></div><div> • </div></div><div>");const kC=()=>{const{t}=it(),e=Zg(),r=bc(),[n,i]=ye(null),[o,a]=ye("overview");un(()=>{const y=ut.getAccountById(e.id);y?i(y):r("/accounts")});const c={display:"flex","align-items":"center",gap:"0.5rem","margin-bottom":"1rem"},u={display:"flex","align-items":"center",gap:"1rem","margin-bottom":"2rem"},h={"font-size":"1rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},f={"font-size":"2.5rem","font-weight":"700",color:"var(--primary-color)"},p={padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},b={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},C=y=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:y?"var(--primary-color)":"var(--text-muted)","border-bottom":y?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),R={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},E={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},x={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},T={"font-weight":"500",color:"var(--text-muted)"},W={"font-weight":"600",color:"var(--text-primary)"},te={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},Q={flex:"1"},de={"font-weight":"500","margin-bottom":"0.25rem"},ae={"font-size":"0.875rem",color:"var(--text-muted)"},I=y=>({"font-weight":"600",color:y==="debit"?"#4caf50":"#f44336"});if(!n())return S(Ur,{get title(){return t("accounts.accountDetails")},get children(){var y=AC(),he=y.firstChild;return y.style.setProperty("text-align","center"),y.style.setProperty("padding","3rem"),s(he,()=>t("common.error")),s(y,S(De,{variant:"primary",onClick:()=>r("/accounts"),get children(){return[me(()=>t("common.back"))," ",me(()=>t("navigation.accounts"))]}}),null),y}});const _=y=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[y]||{bg:"#f5f5f5",color:"#666"},v=y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(y),P=y=>new Date(y).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),w=_(n().type),A=ut.getAccountTransactions(n().id);return S(Ur,{get title(){return n().name},get children(){return[(()=>{var y=Oi();return d(y,c),s(y,S(De,{variant:"secondary",onClick:()=>r("/accounts"),get children(){return["← ",me(()=>t("common.back"))," ",me(()=>t("navigation.accounts"))]}})),y})(),(()=>{var y=IC(),he=y.firstChild,G=he.firstChild,k=G.nextSibling,Z=k.nextSibling,U=he.nextSibling;return d(y,u),d(G,h),s(G,()=>n().accountNumber),k.style.setProperty("margin","0.5rem 0"),k.style.setProperty("font-size","2rem"),s(k,()=>n().name),d(Z,f),s(Z,()=>v(n().balance)),s(U,()=>n().type),se(F=>d(U,{...p,background:w.bg,color:w.color},F)),y})(),(()=>{var y=EC(),he=y.firstChild,G=he.nextSibling,k=G.firstChild,Z=k.nextSibling;return Z.nextSibling,d(y,b),he.$$click=()=>a("overview"),s(he,()=>t("dashboard.overview")),G.$$click=()=>a("transactions"),s(G,()=>t("accounts.transactions"),k),s(G,()=>A.length,Z),se(U=>{var F=C(o()==="overview"),N=C(o()==="transactions");return U.e=d(he,F,U.e),U.t=d(G,N,U.t),U},{e:void 0,t:void 0}),y})(),me(()=>me(()=>o()==="overview")()&&(()=>{var y=TC(),he=y.firstChild,G=he.nextSibling;return d(he,R),s(he,S(Ke,{get title(){return t("accounts.balance")},get subtitle(){return t("dashboard.overview")},get children(){var k=Oi();return k.style.setProperty("font-size","1.5rem"),k.style.setProperty("font-weight","600"),k.style.setProperty("color","var(--primary-color)"),s(k,()=>v(n().balance)),k}}),null),s(he,S(Ke,{get title(){return t("accounts.accountType")},get subtitle(){return t("accounts.category")},get children(){var k=Oi();return k.style.setProperty("font-size","1.5rem"),k.style.setProperty("font-weight","600"),k.style.setProperty("color","var(--primary-color)"),s(k,()=>t(`accounts.types.${n().type.toLowerCase()}`)),k}}),null),s(he,S(Ke,{get title(){return t("common.status")},get subtitle(){return t("accounts.accountDetails")},get children(){var k=Oi();return k.style.setProperty("font-size","1.5rem"),k.style.setProperty("font-weight","600"),s(k,(()=>{var Z=me(()=>!!n().isActive);return()=>Z()?t("common.active"):t("common.inactive")})()),se(Z=>(Z=n().isActive?"#4caf50":"#f44336")!=null?k.style.setProperty("color",Z):k.style.removeProperty("color")),k}}),null),s(he,S(Ke,{get title(){return t("accounts.transactions")},get subtitle(){return t("common.total")},get children(){var k=Oi();return k.style.setProperty("font-size","1.5rem"),k.style.setProperty("font-weight","600"),k.style.setProperty("color","var(--primary-color)"),s(k,()=>A.length),k}}),null),d(G,E),s(G,S(Ke,{get title(){return t("accounts.accountDetails")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var k=Ds(),Z=k.firstChild,U=Z.nextSibling;return s(Z,()=>t("accounts.accountNumber")),s(U,()=>n().accountNumber),se(F=>{var N=x,V=T,fe=W;return F.e=d(k,N,F.e),F.t=d(Z,V,F.t),F.a=d(U,fe,F.a),F},{e:void 0,t:void 0,a:void 0}),k})(),(()=>{var k=Ds(),Z=k.firstChild,U=Z.nextSibling;return s(Z,()=>t("accounts.category")),s(U,()=>n().category),se(F=>{var N=x,V=T,fe=W;return F.e=d(k,N,F.e),F.t=d(Z,V,F.t),F.a=d(U,fe,F.a),F},{e:void 0,t:void 0,a:void 0}),k})(),(()=>{var k=Ds(),Z=k.firstChild,U=Z.nextSibling;return s(Z,()=>t("common.date")),s(U,()=>P(n().createdDate)),se(F=>{var N=x,V=T,fe=W;return F.e=d(k,N,F.e),F.t=d(Z,V,F.t),F.a=d(U,fe,F.a),F},{e:void 0,t:void 0,a:void 0}),k})(),(()=>{var k=Ds(),Z=k.firstChild,U=Z.nextSibling;return s(Z,()=>t("common.date")),s(U,()=>P(n().lastModified)),se(F=>{var N=x,V=T,fe=W;return F.e=d(k,N,F.e),F.t=d(Z,V,F.t),F.a=d(U,fe,F.a),F},{e:void 0,t:void 0,a:void 0}),k})()]}}),null),s(G,S(Ke,{get title(){return t("common.description")},get subtitle(){return t("accounts.accountDetails")},get children(){var k=xC();return k.style.setProperty("margin","0"),k.style.setProperty("color","var(--text-secondary)"),s(k,()=>n().description||t("common.noDataFound")),k}}),null),y})()),me(()=>me(()=>o()==="transactions")()&&S(Ke,{get title(){return t("accounts.accountHistory")},get subtitle(){return t("accounts.transactions")},get children(){return me(()=>A.length===0)()?(()=>{var y=Oi();return y.style.setProperty("text-align","center"),y.style.setProperty("color","var(--text-muted)"),y.style.setProperty("padding","2rem"),s(y,()=>t("common.noDataFound")),y})():A.map(y=>(()=>{var he=$C(),G=he.firstChild,k=G.firstChild,Z=k.nextSibling,U=Z.firstChild,F=G.nextSibling;return d(he,te),d(G,Q),d(k,de),s(k,()=>y.description),d(Z,ae),s(Z,()=>P(y.date),U),s(Z,()=>y.reference,null),s(F,()=>y.type==="debit"?"+":"-",null),s(F,()=>v(y.type==="debit"?y.debitAmount:y.creditAmount),null),se(N=>d(F,I(y.type),N)),he})())}}))]}})};wt(["click"]);var RC=H("<div><div><h1></h1><p> </p></div><div><input type=date>"),yn=H("<div><span></span><span>"),DC=H("<div><div></div><div>"),NC=H("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),LC=H("<div><div> (<!> = <!> + <!>)</div><div> = "),MC=H("<span>(<!>: <!>)");const OC=()=>{const{t}=it(),[e,r]=ye(new Date().toISOString().split("T")[0]),[n,i]=ye(0),[o,a]=ye(0),[c,u]=ye(0);un(()=>{h()});const h=()=>{const R=ut.getAccountsByType("Asset"),E=ut.getAccountsByType("Liability"),x=ut.getAccountsByType("Equity"),T=R.reduce((Q,de)=>Q+de.balance,0),W=E.reduce((Q,de)=>Q+de.balance,0),te=x.reduce((Q,de)=>Q+de.balance,0);i(T),a(W),u(te)},f=R=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(R),p={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},b={"margin-bottom":"2rem"},C={"font-weight":"bold","font-size":"1.1rem","border-top":"2px solid var(--border-color)","padding-top":"0.5rem","margin-top":"1rem"};return S(Ur,{get title(){return t("balanceSheet.title")},get children(){return[(()=>{var R=RC(),E=R.firstChild,x=E.firstChild,T=x.nextSibling,W=T.firstChild,te=E.nextSibling,Q=te.firstChild;return d(R,p),x.style.setProperty("margin","0"),s(x,()=>t("balanceSheet.title")),T.style.setProperty("margin","0.5rem 0 0 0"),T.style.setProperty("color","var(--text-muted)"),s(T,()=>t("balanceSheet.asOf"),W),s(T,()=>new Date(e()).toLocaleDateString(),null),te.style.setProperty("display","flex"),te.style.setProperty("gap","1rem"),Q.addEventListener("change",de=>r(de.target.value)),Q.style.setProperty("padding","0.5rem"),Q.style.setProperty("border","1px solid var(--border-color)"),Q.style.setProperty("border-radius","var(--border-radius-sm)"),s(te,S(De,{variant:"primary",onClick:h,get children(){return t("balanceSheet.generateReport")}}),null),se(()=>Q.value=e()),R})(),(()=>{var R=DC(),E=R.firstChild,x=E.nextSibling;return R.style.setProperty("display","grid"),R.style.setProperty("grid-template-columns","1fr 1fr"),R.style.setProperty("gap","2rem"),s(E,S(Ke,{get title(){return t("balanceSheet.assets")},style:b,get children(){return[(()=>{var T=yn(),W=T.firstChild,te=W.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),s(W,()=>t("balanceSheet.currentAssets")),s(te,()=>f(n()*.6)),T})(),(()=>{var T=yn(),W=T.firstChild,te=W.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),s(W,()=>t("balanceSheet.nonCurrentAssets")),s(te,()=>f(n()*.4)),T})(),(()=>{var T=yn(),W=T.firstChild,te=W.nextSibling;return s(W,()=>t("balanceSheet.totalAssets")),s(te,()=>f(n())),se(Q=>d(T,{...C,display:"flex","justify-content":"space-between"},Q)),T})()]}})),s(x,S(Ke,{get title(){return t("balanceSheet.liabilities")},style:b,get children(){return[(()=>{var T=yn(),W=T.firstChild,te=W.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),s(W,()=>t("balanceSheet.currentLiabilities")),s(te,()=>f(o()*.7)),T})(),(()=>{var T=yn(),W=T.firstChild,te=W.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),s(W,()=>t("balanceSheet.nonCurrentLiabilities")),s(te,()=>f(o()*.3)),T})(),(()=>{var T=yn(),W=T.firstChild,te=W.nextSibling;return s(W,()=>t("balanceSheet.totalLiabilities")),s(te,()=>f(o())),se(Q=>d(T,{...C,display:"flex","justify-content":"space-between"},Q)),T})()]}}),null),s(x,S(Ke,{get title(){return t("balanceSheet.equity")},get children(){return[(()=>{var T=yn(),W=T.firstChild,te=W.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),s(W,()=>t("balanceSheet.commonStock")),s(te,()=>f(c()*.8)),T})(),(()=>{var T=yn(),W=T.firstChild,te=W.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),s(W,()=>t("balanceSheet.retainedEarnings")),s(te,()=>f(c()*.2)),T})(),(()=>{var T=yn(),W=T.firstChild,te=W.nextSibling;return s(W,()=>t("balanceSheet.totalEquity")),s(te,()=>f(c())),se(Q=>d(T,{...C,display:"flex","justify-content":"space-between"},Q)),T})()]}}),null),R})(),S(Ke,{get title(){return t("dashboard.overview")},style:{"margin-top":"2rem"},get children(){return[(()=>{var R=NC(),E=R.firstChild,x=E.firstChild,T=x.nextSibling,W=E.nextSibling,te=W.firstChild,Q=te.nextSibling,de=W.nextSibling,ae=de.firstChild,I=ae.nextSibling;return R.style.setProperty("display","grid"),R.style.setProperty("grid-template-columns","repeat(3, 1fr)"),R.style.setProperty("gap","2rem"),E.style.setProperty("text-align","center"),x.style.setProperty("font-size","0.875rem"),x.style.setProperty("color","var(--text-muted)"),x.style.setProperty("margin-bottom","0.5rem"),s(x,()=>t("balanceSheet.totalAssets")),T.style.setProperty("font-size","1.5rem"),T.style.setProperty("font-weight","bold"),T.style.setProperty("color","var(--primary-color)"),s(T,()=>f(n())),W.style.setProperty("text-align","center"),te.style.setProperty("font-size","0.875rem"),te.style.setProperty("color","var(--text-muted)"),te.style.setProperty("margin-bottom","0.5rem"),s(te,()=>t("balanceSheet.totalLiabilities")),Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","bold"),Q.style.setProperty("color","#f44336"),s(Q,()=>f(o())),de.style.setProperty("text-align","center"),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),ae.style.setProperty("margin-bottom","0.5rem"),s(ae,()=>t("balanceSheet.totalEquity")),I.style.setProperty("font-size","1.5rem"),I.style.setProperty("font-weight","bold"),I.style.setProperty("color","#4caf50"),s(I,()=>f(c())),R})(),(()=>{var R=LC(),E=R.firstChild,x=E.firstChild,T=x.nextSibling,W=T.nextSibling,te=W.nextSibling,Q=te.nextSibling,de=Q.nextSibling;de.nextSibling;var ae=E.nextSibling,I=ae.firstChild;return R.style.setProperty("margin-top","2rem"),R.style.setProperty("text-align","center"),E.style.setProperty("font-size","0.875rem"),E.style.setProperty("color","var(--text-muted)"),E.style.setProperty("margin-bottom","0.5rem"),s(E,()=>t("common.total"),x),s(E,()=>t("balanceSheet.totalAssets"),T),s(E,()=>t("balanceSheet.totalLiabilities"),te),s(E,()=>t("balanceSheet.totalEquity"),de),ae.style.setProperty("font-size","1.2rem"),ae.style.setProperty("font-weight","bold"),s(ae,()=>f(n()),I),s(ae,()=>f(o()+c()),null),s(ae,(()=>{var _=me(()=>Math.abs(n()-(o()+c()))>.01);return()=>_()&&(()=>{var v=MC(),P=v.firstChild,w=P.nextSibling,A=w.nextSibling,y=A.nextSibling;return y.nextSibling,v.style.setProperty("font-size","0.875rem"),v.style.setProperty("color","#f44336"),v.style.setProperty("display","block"),s(v,()=>t("common.error"),w),s(v,()=>f(n()-(o()+c())),y),v})()})(),null),se(_=>(_=Math.abs(n()-(o()+c()))<.01?"#4caf50":"#f44336")!=null?ae.style.setProperty("color",_):ae.style.removeProperty("color")),R})()]}})]}})};wt(["click"]);const VC=[{id:"YY_8802",code:"YY_8802",name:"CENTER",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8803",code:"YY_8803",name:"BISONET",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8804",code:"YY_8804",name:"IRVIN",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8805",code:"YY_8805",name:"KATTY",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8816",code:"YY_8816",name:"YABA GLOBAL",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8818",code:"YY_8818",name:"YABASURAUSTIN",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8847",code:"YY_8847",name:"YABAOFICINA AZ",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_3251",code:"YY_3251",name:"YABA FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_32",code:"YY_32",name:"YABA MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_76",code:"YY_76",name:"YABA DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_79",code:"YY_79",name:"ALMACEN DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8635",code:"YY_8635",name:"FASHION MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8665",code:"YY_8665",name:"IRVIN FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8901",code:"YY_8901",name:"ALMACEN CENTRAL YABA",bussinesId:"YB100423253156428",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01"}],BC=[{id:"1",name:'MacBook Pro 16"',price:2399,quantity:75,category:"Electronics",description:"Apple MacBook Pro 16-inch with M2 Pro chip",sku:"MBP-16-M2P",supplier:"Apple Inc.",minStock:10,location:"Warehouse A",lastUpdated:"2024-01-15"},{id:"2",name:'Dell Monitor 27"',price:299,quantity:35,category:"Electronics",description:"Dell 27-inch 4K UHD Monitor",sku:"DELL-MON-27-4K",supplier:"Dell Technologies",minStock:15,location:"Warehouse B",lastUpdated:"2024-01-14"},{id:"3",name:"Wireless Mouse",price:49.99,quantity:12,category:"Accessories",description:"Ergonomic wireless mouse with precision tracking",sku:"MOUSE-WL-001",supplier:"Logitech",minStock:25,location:"Warehouse A",lastUpdated:"2024-01-13"}],Ns=()=>{const t=new Map;return Mr().forEach(e=>{const r=`${e.productId}-${e.locationId}`;let n=Re.getLocationById(e.locationId),i=t.get(r);i||(i={id:r,productId:e.productId,locationId:e.locationId,locationName:n?.name,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,i)),e.movementType==="in"||e.movementType==="transfer"?(e.locationId===e.toLocationId||e.movementType==="in")&&(i.quantity+=e.quantity*1):e.movementType==="out"?i.quantity-=e.quantity*1:e.movementType==="adjustment"&&(i.quantity=e.quantity*1),new Date(e.createdDate)>new Date(i.lastMovementDate)&&(i.lastMovementDate=e.createdDate,i.lastMovementType=e.movementType),i.averageCost=e.unitCost*1,i.availableQuantity=i.quantity*1-i.reservedQuantity*1}),Array.from(t.values())},[ai,bl]=ye([]),[li,Ch]=ye(VC),[Mr,Ls]=ye([]),[Dn,Ro]=ye([]),FC=()=>{const t=new Map;return Mr().forEach(e=>{const r=`${e.productId}-${e.locationId}`;let n=t.get(r),i=Re.getLocationById(e.locationId);n||(n={id:r,productId:e.productId,locationId:e.locationId,locationName:i?.name,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType==="in"||e.movementType==="transfer"?(e.locationId===e.toLocationId||e.movementType==="in")&&(n.quantity+=e.quantity*1):e.movementType==="out"?n.quantity-=e.quantity*1:e.movementType==="adjustment"&&(n.quantity=e.quantity*1),new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost*1,n.availableQuantity=n.quantity*1-n.reservedQuantity*1}),Array.from(t.values())};Ro(FC());const[Ms,_l]=ye(BC),UC={TRANSFER:1,transfer:1},Ah=173442384e4,Re={get products(){return ai()},get locations(){return li()},get movements(){return Mr()},get stockLevels(){return Dn()},parseInventoryData:t=>{const e=Object.keys(t).slice(0,900),r=[],n=i=>{let o=t;o[i]?.products&&o[i]?.products?.map(a=>{let c=Pp(o[i]?.type),u=a?.price*1||a?.unitCost*1,h=a?.qty*1||a?.quantity*1;u=isNaN(u)?0:u,h=isNaN(h)?0:h;let f={id:o[i]?.ssg_inventory_key,productId:a?.product?.id,productName:a?.product?.label,productSku:a?.product?.code,locationId:o[i]?.store,locationName:o[i]?.store,location:o[i]?.store,movementType:c,quantity:h,unitCost:u,totalCost:u*1*h,minStock:10,referenceNumber:"PO-001",notes:o[i]?.description||o[i]?.notes,createdBy:"admin",createdDate:o[i]?.createDate?new Date(o[i]?.createDate).toISOString():new Date(Ah).toISOString(),invoiceId:o[i]?.invoice};if(r.push(f),UC[o[i].movementType]&&o[i]?.fromLocationId){let p=Re.getLocationById(o[i]?.fromLocationId);const b={id:o[i]?.ssg_inventory_key,productId:a?.product?.id,productName:a?.product?.label,productSku:a?.product?.code,locationId:o[i]?.fromLocationId,locationName:p?.name||"",movementType:"out",quantity:h*-1,unitCost:u,totalCost:u*-1*h,minStock:10,referenceNumber:o[i]?.referenceNumber,notes:`Transfer to ${o[i]?.locationName}`+(o[i].notes?` - ${o[i].notes}`:""),createdBy:o[i].createdBy,createdDate:o[i]?.createDate?new Date(o[i]?.createDate).toISOString():new Date(Ah).toISOString(),invoiceId:o[i]?.invoiceId,toLocationId:o[i]?.locationId,toLocationName:o[i]?.locationName};r.push(b)}})};return e.map(n),r},fecthInventory:async t=>{const e=await Fn.getInventory(t),r=Re.parseInventoryData(e);Re.updMovements(r)},fecthProduct:async t=>{const e=await Fn.getProducts(t),r=Object.keys(e),n=o=>{let a=e;return{id:o,name:a[o].name,businessId:a[o].businessId,sku:a[o].code,UPC:a[o].UPC,numCode:a[o].codeN,category:a[o].category,unitCost:a[o].unitCost||0,unitOfMeasure:a[o].unitOfMeasure||a[o].unit,minStockLevel:a[o].minStockLevel,maxStockLevel:a[o].maxStockLevel,isActive:a[o].isActive,description:a[o].description||"",createdDate:a[o].createdAt||new Date().toISOString(),lastModified:a[o].updatedAt||new Date().toISOString()}},i=r.map(n);return Re.updProduct(i),i},getProductById:t=>ai().find(e=>e.id===t),updProduct:t=>{bl(t)},getProductsBySku:t=>ai().filter(e=>e.sku.toLowerCase().includes(t.toLowerCase())),getProductsByCategory:t=>ai().filter(e=>e.category===t),getActiveProducts:()=>ai().filter(t=>t.name),getLocationById:t=>li().find(e=>e.id===t),getLocationsByType:t=>li().filter(e=>e.type===t),getActiveLocations:()=>{let t=$t.state.profile.stores;return li().filter(e=>t?.[e?.id])},getMovementsByProduct:t=>Mr().filter(e=>e.productId===t),updMovements:t=>{Ls([...t]),Ro(Ns())},getMovementsByLocation:t=>Mr().filter(e=>e.locationId===t),getMovementsByDateRange:(t,e)=>Mr().filter(r=>r.createdDate>=t&&r.createdDate<=e),getStockByProduct:t=>Dn().filter(e=>e.productId===t),getStockByLocation:t=>Dn().filter(e=>e.locationId===t),getStockByProductAndLocation:(t,e)=>Dn().find(r=>r.productId===t&&r.locationId===e),getTotalStockByProduct:t=>Dn().filter(e=>e.productId===t).reduce((e,r)=>e*1+r.quantity*1,0),getLastLocationByProduct:t=>{const e=Mr().filter(r=>r.productId===t).sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime());if(e.length>0)return li().find(r=>r.id===e[0].locationId)},getLowStockProducts:()=>(ai()||[])?.map(t=>{const e=Dn().filter(r=>r.productId===t.id).reduce((r,n)=>r+n.quantity,0);return{...t,currentStock:e}}).filter(t=>t.currentStock<=t.minStockLevel),addInventoryMovement:t=>{const e={...t,id:`mov-${Date.now()}`,createdDate:new Date().toISOString()};Ls(r=>[...r,e]),Ro(Ns())},addBulkInventoryMovements:async t=>{const e=[],r=[],n=new Date().toISOString(),i=li().find(c=>c.id===t.locationId);if(!i)return{success:!1,errors:["Invalid location"]};let o;if(t.movementType==="transfer"){if(!t.fromLocationId)return{success:!1,errors:["From location required for transfers"]};if(o=li().find(c=>c.id===t.fromLocationId),!o)return{success:!1,errors:["Invalid from location"]};if(t.fromLocationId===t.locationId)return{success:!1,errors:["From and to locations cannot be the same"]}}if(t.items.forEach((c,u)=>{const h=ai().find(C=>C.id===c.productId);if(!h){e.push(`Item ${u+1}: Product not found`);return}if(c.quantity<=0){e.push(`Item ${u+1}: Quantity must be greater than 0`);return}if(t.movementType==="out"){const C=Dn().filter(R=>R.productId===c.productId&&R.locationId===t.locationId).reduce((R,E)=>R+E.quantity,0);if(c.quantity>C){e.push(`Item ${u+1}: Insufficient stock. Available: ${C}, Requested: ${c.quantity}`);return}}if(t.movementType==="transfer"){const C=Dn().filter(R=>R.productId===c.productId&&R.locationId===t.fromLocationId).reduce((R,E)=>R+E.quantity,0);if(c.quantity>C){e.push(`Item ${u+1}: Insufficient stock at ${o?.name}. Available: ${C}, Requested: ${c.quantity}`);return}}const f=c.unitCost||h.unitCost,p=c.quantity*f,b={id:`mov-${Date.now()}-${u}`,productId:h.id,productName:h.name,productSku:h.sku,locationId:t.locationId,locationName:i.name,movementType:t.movementType,quantity:c.quantity,unitCost:f,totalCost:p,minStock:10,referenceNumber:t.referenceNumber||"",notes:c.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:o?.name};if(r.push(b),t.movementType==="transfer"&&o){const C={id:`mov-${Date.now()}-${u}-out`,productId:h.id,productName:h.name,productSku:h.sku,locationId:t.fromLocationId,locationName:o.name,movementType:"out",quantity:c.quantity,unitCost:f,totalCost:p,minStock:10,referenceNumber:t.referenceNumber||"",notes:`Transfer to ${i.name}`+(c.notes?` - ${c.notes}`:""),createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,toLocationId:t.locationId,toLocationName:i.name};r.push(C)}}),e.length>0)return{success:!1,errors:e};Ls(c=>[...c,...r]),Ro(Ns()),console.log({bulkRequest:t});const a=await Fn.addInventory(t);return console.log({prodResults:a}),{success:!0,errors:[]}},getMovementsByInvoice:t=>Mr().filter(e=>e.invoiceId===t),getInvoiceSummary:t=>{const e=Mr().filter(o=>o.invoiceId===t);if(e.length===0)return null;const r=e.reduce((o,a)=>o+a.totalCost,0),n=new Set(e.map(o=>o.productId)).size,i=e[0];return{invoiceId:t,referenceNumber:i.referenceNumber,movementType:i.movementType,location:i.locationName,fromLocation:i.fromLocationName,productCount:n,totalItems:e.reduce((o,a)=>o+a.quantity,0),totalValue:r,createdDate:i.createdDate,createdBy:i.createdBy}},addProduct:t=>{const e={...t,id:`prod-${Date.now()}`,createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};bl(r=>[...r,e])},addLocation:t=>{const e={...t,id:`loc-${Date.now()}`,createdDate:new Date().toISOString()};Ch(r=>[...r,e])},updateProduct:(t,e)=>{bl(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n))},updateLocation:(t,e)=>{Ch(r=>r.map(n=>n.id===t?{...n,...e}:n))},updateMovement:(t,e)=>{Ls(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n)),Ro(Ns())},get inventory(){return Ms()},addItem(t){const e={...t,id:Date.now().toString(),lastUpdated:new Date().toISOString().split("T")[0]};return _l([...Ms(),e]),e},updateItem(t,e){_l(Ms().map(r=>r.id===t?{...r,...e,lastUpdated:new Date().toISOString().split("T")[0]}:r))},deleteItem(t){_l(Ms().filter(e=>e.id!==t))},getItemById(t){return Mr().find(e=>e.id===t)},getLowStockItems(){return Mr().filter(t=>t.quantity*1<=t.minStock*1)},getTotalValue(){return Mr().reduce((t,e)=>t*1+e.unitCost*1*e.quantity*1,0)}};var Ih=H("<div>"),jC=H("<div><div><input type=text autocomplete=off>"),zC=H("<button type=button>+"),qC=H("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>");const Hy=t=>{const{t:e}=it(),[r,n]=ye(!1),[i,o]=ye(""),[a,c]=ye(-1),u=ze(()=>t.value?Re.getProductById(t.value):null),h=ze(()=>{const G=i().toLowerCase();return G?Re.getActiveProducts().filter(k=>k.name.toLowerCase().includes(G)||k.sku.toLowerCase().includes(G)||k.category.toLowerCase().includes(G)):Re.getActiveProducts()}),f=()=>{n(!0),o(""),c(-1)},p=G=>{const k=G.target;o(k.value),n(!0),c(-1)},b=G=>{t.onChange(G),n(!1),o(""),c(-1)},C=G=>{const k=h();switch(G.key){case"ArrowDown":G.preventDefault(),c(Z=>Math.min(Z+1,k.length-1));break;case"ArrowUp":G.preventDefault(),c(Z=>Math.max(Z-1,-1));break;case"Enter":G.preventDefault(),a()>=0&&k[a()]&&b(k[a()]);break;case"Escape":n(!1),o(""),c(-1);break}},R=G=>{setTimeout(()=>{n(!1),o(""),c(-1)},150)},E=G=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(G),x=G=>Re.stockLevels.filter(k=>k.productId===G).reduce((k,Z)=>k+Z.quantity,0),T={position:"relative",width:"100%",...t.style},W={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},te={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},Q=G=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid "+G?"var(--primary-color)":"var(--border-color)",background:G?"var(--strip-color)":"transparent",color:G?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),de={display:"flex","justify-content":"space-between","align-items":"center"},ae={flex:"1"},I={"font-weight":"500","margin-bottom":"0.25rem"},_={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},v={"text-align":"right","font-size":"0.875rem"},P={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},w=()=>r()&&i()?i():u()?`${u().name} (${u().sku})`:"",A={display:"flex","align-items":"stretch",width:"100%"},y={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},he={...W,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"};return(()=>{var G=jC(),k=G.firstChild,Z=k.firstChild;return d(k,A),Z.addEventListener("blur",R),Z.$$keydown=C,Z.$$click=f,Z.$$input=p,s(k,(()=>{var U=me(()=>!!t.onAddNew);return()=>U()&&(()=>{var F=zC();return F.addEventListener("mouseleave",N=>{N.currentTarget.style.background="var(--surface-color)",N.currentTarget.style.color="var(--primary-color)"}),F.addEventListener("mouseenter",N=>{N.currentTarget.style.background="var(--primary-color)",N.currentTarget.style.color="white"}),Ci(F,"click",t.onAddNew,!0),d(F,y),se(()=>ct(F,"title",e("inventory.addProduct","Add new product"))),F})()})(),null),s(G,S(Ve,{get when(){return r()},get children(){var U=Ih();return s(U,S(Ve,{get when(){return h().length>0},get fallback(){return(()=>{var F=Ih();return d(F,P),s(F,(()=>{var N=me(()=>!!i());return()=>N()?e("inventory.noProductsFound","No products found matching your search."):e("inventory.noProductsAvailable","No products available.")})()),F})()},get children(){return S(Ot,{get each(){return h()},children:(F,N)=>{const V=x(F.id),fe=V<=F.minStockLevel;return(()=>{var z=qC(),ge=z.firstChild,$=ge.firstChild,O=$.firstChild,X=O.nextSibling,Y=X.firstChild,ue=Y.firstChild,re=Y.nextSibling,M=re.nextSibling,oe=M.nextSibling,pe=oe.nextSibling,be=$.nextSibling,ne=be.firstChild,le=ne.firstChild,j=ne.nextSibling;return z.addEventListener("mouseenter",()=>c(N())),z.$$click=()=>b(F),d(ge,de),d($,ae),d(O,I),s(O,()=>F.name),d(X,_),s(Y,()=>e("inventory.sku","SKU"),ue),s(Y,()=>F.sku,null),s(M,()=>F.category),s(pe,()=>E(F.unitCost)),d(be,v),ne.style.setProperty("font-weight","600"),(fe?"#f44336":"var(--text-primary)")!=null?ne.style.setProperty("color",fe?"#f44336":"var(--text-primary)"):ne.style.removeProperty("color"),s(ne,V,le),s(ne,()=>F.unitOfMeasure,null),j.style.setProperty("color","var(--text-muted)"),s(j,()=>fe?e("inventory.lowStock","Low Stock"):e("inventory.inStock","In Stock")),se(ce=>d(z,Q(N()===a()),ce)),z})()}})}})),se(F=>d(U,te,F)),U}}),null),se(U=>{var F=T,N=he,V=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),fe=t.disabled,z=t.required;return U.e=d(G,F,U.e),U.t=d(Z,N,U.t),V!==U.a&&ct(Z,"placeholder",U.a=V),fe!==U.o&&(Z.disabled=U.o=fe),z!==U.i&&(Z.required=U.i=z),U},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),se(()=>Z.value=w()),G})()};wt(["input","click","keydown"]);var Eh=H("<div>"),HC=H("<div><div><input type=text autocomplete=off>"),WC=H("<button type=button>+"),GC=H("<div><div><div><div> </div><div><span>: </span><span></span></div><div>");const Ea=t=>{const{t:e}=it(),[r,n]=ye(!1),[i,o]=ye(""),[a,c]=ye(-1),u=ze(()=>t.value?Re.getLocationById(t.value):null),h=ze(()=>{let G=Re.getActiveLocations();t.filterType&&(G=G.filter(Z=>Z.type===t.filterType));const k=i().toLowerCase();return k?G.filter(Z=>Z.name.toLowerCase().includes(k)||Z?.code?.toLowerCase().includes(k)||Z?.type?.toLowerCase().includes(k)||Z?.address?.toLowerCase().includes(k)):G}),f=()=>{n(!0),o(""),c(-1)},p=G=>{const k=G.target;o(k.value),n(!0),c(-1)},b=G=>{t.onChange(G.id),n(!1),o(""),c(-1)},C=G=>{const k=h();switch(G.key){case"ArrowDown":G.preventDefault(),c(Z=>Math.min(Z+1,k.length-1));break;case"ArrowUp":G.preventDefault(),c(Z=>Math.max(Z-1,-1));break;case"Enter":G.preventDefault(),a()>=0&&k[a()]&&b(k[a()]);break;case"Escape":n(!1),o(""),c(-1);break}},R=G=>{setTimeout(()=>{n(!1),o(""),c(-1)},150)},E=G=>({warehouse:"🏭",store:"🏪",supplier:"🚚",customer:"👥"})[G]||"📍",x=G=>({warehouse:"#2196F3",store:"#4CAF50",supplier:"#FF9800",customer:"#9C27B0"})[G]||"#757575",T={position:"relative",width:"100%",...t.style},W={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},te={display:"flex","align-items":"stretch",width:"100%"},Q={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},de={...W,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"},ae={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},I=G=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:G?"var(--strip-color)":"transparent",color:G?"var(--primary-dark)":"var(--text-primary)",transition:"all 0.2s ease"}),_={display:"flex","justify-content":"space-between","align-items":"center"},v={flex:"1"},P={"font-weight":"500","margin-bottom":"0.25rem"},w={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem","align-items":"center"},A=G=>({padding:"0.2rem 0.5rem","border-radius":"var(--border-radius-sm)","font-size":"0.7rem","font-weight":"500",background:x(G),color:"white","text-transform":"uppercase"}),y={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},he=()=>r()&&i()?i():u()?`${u().name} (${u().code})`:"";return(()=>{var G=HC(),k=G.firstChild,Z=k.firstChild;return d(k,te),Z.addEventListener("blur",R),Z.$$keydown=C,Z.$$click=f,Z.$$input=p,s(k,(()=>{var U=me(()=>!!t.onAddNew);return()=>U()&&(()=>{var F=WC();return F.addEventListener("mouseleave",N=>{N.currentTarget.style.background="var(--surface-color)",N.currentTarget.style.color="var(--primary-color)"}),F.addEventListener("mouseenter",N=>{N.currentTarget.style.background="var(--primary-color)",N.currentTarget.style.color="white"}),Ci(F,"click",t.onAddNew,!0),d(F,Q),se(()=>ct(F,"title",e("inventory.addLocation","Add new location"))),F})()})(),null),s(G,S(Ve,{get when(){return r()},get children(){var U=Eh();return s(U,S(Ve,{get when(){return h().length>0},get fallback(){return(()=>{var F=Eh();return d(F,y),s(F,(()=>{var N=me(()=>!!i());return()=>N()?e("inventory.noLocationsFound","No locations found matching your search."):e("inventory.noLocationsAvailable","No locations available.")})()),F})()},get children(){return S(Ot,{get each(){return h()},children:(F,N)=>(()=>{var V=GC(),fe=V.firstChild,z=fe.firstChild,ge=z.firstChild,$=ge.firstChild,O=ge.nextSibling,X=O.firstChild,Y=X.firstChild,ue=X.nextSibling,re=O.nextSibling;return V.addEventListener("mouseenter",()=>c(N())),V.$$click=()=>b(F),d(fe,_),d(z,v),d(ge,P),s(ge,()=>E(F.type),$),s(ge,()=>F.name,null),d(O,w),s(X,()=>e("inventory.locationCode","Code"),Y),s(X,()=>F.code,null),s(ue,()=>F.type),re.style.setProperty("font-size","0.75rem"),re.style.setProperty("color","var(--text-muted)"),re.style.setProperty("margin-top","0.25rem"),s(re,()=>F.address),se(M=>{var oe=I(N()===a()),pe=A(F.type);return M.e=d(V,oe,M.e),M.t=d(ue,pe,M.t),M},{e:void 0,t:void 0}),V})()})}})),se(F=>d(U,ae,F)),U}}),null),se(U=>{var F=T,N=de,V=t.placeholder||e("inventory.searchLocations","Search locations by name, code, or type..."),fe=t.disabled,z=t.required;return U.e=d(G,F,U.e),U.t=d(Z,N,U.t),V!==U.a&&ct(Z,"placeholder",U.a=V),fe!==U.o&&(Z.disabled=U.o=fe),z!==U.i&&(Z.required=U.i=z),U},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),se(()=>Z.value=he()),G})()};wt(["input","click","keydown"]);var YC=H("<form><div><label> *</label><input type=text required></div><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text list=categories required><datalist id=categories><option value=Electronics></option><option value=Accessories></option><option value=Office></option><option value=Furniture></option><option value=Software></option><option value=Hardware></option></datalist></div></div><div><label></label><textarea></textarea></div><div><div><label></label><select><option value=pcs></option><option value=kg></option><option value=lbs></option><option value=m></option><option value=ft></option><option value=l></option><option value=gal></option><option value=box></option><option value=pack></option></select></div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div></div><div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div><div></div></div><div><div><label></label><input type=number min=0 step=1></div><div><label></label><input type=number min=1 step=1></div></div><div>"),KC=H("<div>");const hu=t=>{const{t:e}=it(),[r,n]=ye(""),[i,o]=ye(""),[a,c]=ye(""),[u,h]=ye(""),[f,p]=ye("pcs"),[b,C]=ye(0),[R,E]=ye(0),[x,T]=ye(10),[W,te]=ye(100),[Q,de]=ye(""),ae=()=>{n(""),o(""),c(""),h(""),p("pcs"),C(0),E(0),T(10),te(100),de("")},I=k=>{if(k.preventDefault(),de(""),!r().trim()){de(e("forms.productNameRequired"));return}if(!i().trim()){de(e("forms.skuRequired"));return}if(!u().trim()){de(e("forms.categoryRequired"));return}if(b()<0){de(e("forms.unitCostNotNegative"));return}if(R()<0){de(e("forms.sellingPriceNotNegative"));return}if(x()<0){de(e("forms.minStockNotNegative"));return}if(W()<=x()){de(e("forms.maxStockGreaterThanMin"));return}if(Re.getProductsBySku(i()).length>0){de(e("forms.skuAlreadyExists"));return}const U={name:r().trim(),sku:i().trim().toUpperCase(),description:a().trim(),category:u().trim(),unitOfMeasure:f(),unitCost:b(),sellingPrice:R(),minStockLevel:x(),maxStockLevel:W(),isActive:!0,businessId:"default-business"};Re.addProduct(U);const F=`prod-${Date.now()}`;t.onProductAdded&&t.onProductAdded(F),ae(),t.onClose()},_=()=>{ae(),t.onClose()},v={"margin-bottom":"1.5rem"},P={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},w={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},A={...w,cursor:"pointer"},y={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},he={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},G={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"};return S(yr,{get isOpen(){return t.isOpen},onClose:_,get title(){return e("inventory.addNewProduct")},get children(){var k=YC(),Z=k.firstChild,U=Z.firstChild,F=U.firstChild,N=U.nextSibling,V=Z.nextSibling,fe=V.firstChild,z=fe.firstChild,ge=z.firstChild,$=z.nextSibling,O=fe.nextSibling,X=O.firstChild,Y=X.firstChild,ue=X.nextSibling,re=V.nextSibling,M=re.firstChild,oe=M.nextSibling,pe=re.nextSibling,be=pe.firstChild,ne=be.firstChild,le=ne.nextSibling,j=le.firstChild,ce=j.nextSibling,D=ce.nextSibling,J=D.nextSibling,ee=J.nextSibling,q=ee.nextSibling,B=q.nextSibling,_e=B.nextSibling,we=_e.nextSibling,ie=be.nextSibling,ve=ie.firstChild,K=ve.nextSibling,Pe=pe.nextSibling,Te=Pe.firstChild,xe=Te.firstChild,$e=xe.nextSibling,Oe=Pe.nextSibling,Qe=Oe.firstChild,Ue=Qe.firstChild,Ie=Ue.nextSibling,Me=Qe.nextSibling,qe=Me.firstChild,He=qe.nextSibling,Ge=Oe.nextSibling;return k.addEventListener("submit",I),s(U,()=>e("inventory.productName"),F),N.addEventListener("change",Ae=>n(Ae.target.value)),s(z,()=>e("inventory.sku"),ge),$.addEventListener("change",Ae=>o(Ae.target.value)),s(X,()=>e("inventory.category"),Y),ue.addEventListener("change",Ae=>h(Ae.target.value)),s(M,()=>e("common.description")),oe.addEventListener("change",Ae=>c(Ae.target.value)),s(ne,()=>e("inventory.unitOfMeasure")),le.addEventListener("change",Ae=>p(Ae.target.value)),s(j,()=>e("inventory.pieces")),s(ce,()=>e("inventory.kilograms")),s(D,()=>e("inventory.pounds")),s(J,()=>e("inventory.meters")),s(ee,()=>e("inventory.feet")),s(q,()=>e("inventory.liters")),s(B,()=>e("inventory.gallons")),s(_e,()=>e("inventory.boxes")),s(we,()=>e("inventory.packs")),s(ve,()=>e("inventory.unitCost")),K.addEventListener("change",Ae=>C(Number(Ae.target.value))),s(xe,()=>e("inventory.sellingPrice")),$e.addEventListener("change",Ae=>E(Number(Ae.target.value))),s(Ue,()=>e("inventory.minimumStockLevel")),Ie.addEventListener("change",Ae=>T(Number(Ae.target.value))),s(qe,()=>e("inventory.maximumStockLevel")),He.addEventListener("change",Ae=>te(Number(Ae.target.value))),s(k,(()=>{var Ae=me(()=>!!Q());return()=>Ae()&&(()=>{var ot=KC();return d(ot,y),s(ot,Q),ot})()})(),Ge),d(Ge,he),s(Ge,S(De,{variant:"secondary",type:"button",onClick:_,get children(){return e("common.cancel")}}),null),s(Ge,S(De,{variant:"primary",type:"submit",get children(){return e("inventory.addProduct")}}),null),se(Ae=>{var ot=v,et=P,pt=w,yt=e("inventory.enterProductName"),xt=G,Yt=P,kt=w,Qt=e("inventory.enterSkuCode"),st=P,ar=w,Ht=e("inventory.enterCategory"),Rt=v,Fe=P,Le={...w,"min-height":"80px",resize:"vertical"},Ye=e("inventory.enterProductDescription"),lt=G,Tt=P,Xe=A,bt=P,dt=w,gt=G,Ct=P,rr=w,jt=G,Ft=P,Wt=w,_t=P,Jt=w;return Ae.e=d(Z,ot,Ae.e),Ae.t=d(U,et,Ae.t),Ae.a=d(N,pt,Ae.a),yt!==Ae.o&&ct(N,"placeholder",Ae.o=yt),Ae.i=d(V,xt,Ae.i),Ae.n=d(z,Yt,Ae.n),Ae.s=d($,kt,Ae.s),Qt!==Ae.h&&ct($,"placeholder",Ae.h=Qt),Ae.r=d(X,st,Ae.r),Ae.d=d(ue,ar,Ae.d),Ht!==Ae.l&&ct(ue,"placeholder",Ae.l=Ht),Ae.u=d(re,Rt,Ae.u),Ae.c=d(M,Fe,Ae.c),Ae.w=d(oe,Le,Ae.w),Ye!==Ae.m&&ct(oe,"placeholder",Ae.m=Ye),Ae.f=d(pe,lt,Ae.f),Ae.y=d(ne,Tt,Ae.y),Ae.g=d(le,Xe,Ae.g),Ae.p=d(ve,bt,Ae.p),Ae.b=d(K,dt,Ae.b),Ae.T=d(Pe,gt,Ae.T),Ae.A=d(xe,Ct,Ae.A),Ae.O=d($e,rr,Ae.O),Ae.I=d(Oe,jt,Ae.I),Ae.S=d(Ue,Ft,Ae.S),Ae.W=d(Ie,Wt,Ae.W),Ae.C=d(qe,_t,Ae.C),Ae.B=d(He,Jt,Ae.B),Ae},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),se(()=>N.value=r()),se(()=>$.value=i()),se(()=>ue.value=u()),se(()=>oe.value=a()),se(()=>le.value=f()),se(()=>K.value=b()),se(()=>$e.value=R()),se(()=>Ie.value=x()),se(()=>He.value=W()),k}})};var QC=H('<form><div><label> *</label><input type=text required></div><div><div><label> *<button type=button title="Generate code automatically"></button></label><input type=text required><div></div></div><div><label> *</label><select required><option value=warehouse> </option><option value=store> </option><option value=supplier> </option><option value=customer> </option></select><div></div></div></div><div><label> *</label><textarea required></textarea></div><div>'),JC=H("<div><div>:</div><div><span></span><div><div></div><div>"),XC=H("<div>");const mu=t=>{const{t:e}=it(),[r,n]=ye(""),[i,o]=ye(""),[a,c]=ye("warehouse"),[u,h]=ye(""),[f,p]=ye(""),b=()=>{n(""),o(""),c("warehouse"),h(""),p("")},C=()=>{if(r()){const w=a()==="warehouse"?"WH":a()==="store"?"ST":a()==="supplier"?"SUP":"CUST",A=r().toUpperCase().replace(/[^A-Z0-9]/g,"").substring(0,3),y=String(Math.floor(Math.random()*1e3)).padStart(3,"0");o(`${w}-${A}-${y}`)}},R=w=>{if(w.preventDefault(),p(""),!r().trim()){p(e("forms.locationNameRequired"));return}if(!i().trim()){p(e("forms.locationCodeRequired"));return}if(!u().trim()){p(e("forms.addressRequired"));return}if(Re.locations.filter(G=>G.code.toLowerCase()===i().toLowerCase()).length>0){p(e("forms.locationCodeExists"));return}const y={name:r().trim(),code:i().trim().toUpperCase(),type:a(),address:u().trim(),isActive:!0};Re.addLocation(y);const he=`loc-${Date.now()}`;t.onLocationAdded&&t.onLocationAdded(he),b(),t.onClose()},E=()=>{b(),t.onClose()},x={"margin-bottom":"1.5rem"},T={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},W={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},te={...W,cursor:"pointer"},Q={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},de={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},ae={display:"grid","grid-template-columns":"2fr 1fr",gap:"1rem"},I={"font-size":"0.875rem",color:"var(--text-muted)","margin-top":"0.25rem"},_={padding:"0.25rem 0.5rem","font-size":"0.75rem","margin-left":"0.5rem",background:"var(--background-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",color:"var(--text-muted)"},v=w=>({warehouse:"🏭",store:"🏪",supplier:"🚚",customer:"👥"})[w]||"📍",P=w=>({warehouse:e("inventory.warehouseDescription"),store:e("inventory.storeDescription"),supplier:e("inventory.supplierDescription"),customer:e("inventory.customerDescription")})[w]||"";return S(yr,{get isOpen(){return t.isOpen},onClose:E,get title(){return e("inventory.addNewLocation")},get children(){var w=QC(),A=w.firstChild,y=A.firstChild,he=y.firstChild,G=y.nextSibling,k=A.nextSibling,Z=k.firstChild,U=Z.firstChild,F=U.firstChild,N=F.nextSibling,V=U.nextSibling,fe=V.nextSibling,z=Z.nextSibling,ge=z.firstChild,$=ge.firstChild,O=ge.nextSibling,X=O.firstChild,Y=X.firstChild,ue=X.nextSibling,re=ue.firstChild,M=ue.nextSibling,oe=M.firstChild,pe=M.nextSibling,be=pe.firstChild,ne=O.nextSibling,le=k.nextSibling,j=le.firstChild,ce=j.firstChild,D=j.nextSibling,J=le.nextSibling;return w.addEventListener("submit",R),s(y,()=>e("inventory.locationName"),he),G.addEventListener("change",ee=>n(ee.target.value)),d(k,ae),s(U,()=>e("inventory.locationCode"),F),N.$$click=C,d(N,_),s(N,()=>e("common.generate")),V.addEventListener("change",ee=>o(ee.target.value)),s(fe,()=>e("inventory.uniqueIdentifierHelp")),s(ge,()=>e("inventory.locationType"),$),O.addEventListener("change",ee=>c(ee.target.value)),s(X,()=>v("warehouse"),Y),s(X,()=>e("inventory.warehouse"),null),s(ue,()=>v("store"),re),s(ue,()=>e("inventory.store"),null),s(M,()=>v("supplier"),oe),s(M,()=>e("inventory.supplier"),null),s(pe,()=>v("customer"),be),s(pe,()=>e("inventory.customer"),null),s(ne,()=>P(a())),s(j,()=>e("common.address"),ce),D.addEventListener("change",ee=>h(ee.target.value)),s(w,(()=>{var ee=me(()=>!!r());return()=>ee()&&(()=>{var q=JC(),B=q.firstChild,_e=B.firstChild,we=B.nextSibling,ie=we.firstChild,ve=ie.nextSibling,K=ve.firstChild,Pe=K.nextSibling;return q.style.setProperty("padding","1rem"),q.style.setProperty("background","var(--background-color)"),q.style.setProperty("border-radius","var(--border-radius-sm)"),q.style.setProperty("border","1px solid var(--border-color)"),q.style.setProperty("margin-bottom","1rem"),B.style.setProperty("font-weight","500"),B.style.setProperty("margin-bottom","0.5rem"),s(B,()=>e("common.preview"),_e),we.style.setProperty("display","flex"),we.style.setProperty("align-items","center"),we.style.setProperty("gap","0.5rem"),ie.style.setProperty("font-size","1.2rem"),s(ie,()=>v(a())),K.style.setProperty("font-weight","600"),s(K,r),Pe.style.setProperty("font-size","0.875rem"),Pe.style.setProperty("color","var(--text-muted)"),s(Pe,(()=>{var Te=me(()=>!!i());return()=>Te()&&`${i()} • `})(),null),s(Pe,a,null),q})()})(),J),s(w,(()=>{var ee=me(()=>!!f());return()=>ee()&&(()=>{var q=XC();return d(q,Q),s(q,f),q})()})(),J),d(J,de),s(J,S(De,{variant:"secondary",type:"button",onClick:E,get children(){return e("common.cancel")}}),null),s(J,S(De,{variant:"primary",type:"submit",get children(){return e("inventory.addLocation")}}),null),se(ee=>{var q=x,B=T,_e=W,we=e("inventory.enterLocationName"),ie=T,ve=W,K=e("inventory.enterUniqueCode"),Pe=I,Te=T,xe=te,$e=I,Oe=x,Qe=T,Ue={...W,"min-height":"100px",resize:"vertical"},Ie=e("inventory.enterCompleteAddress");return ee.e=d(A,q,ee.e),ee.t=d(y,B,ee.t),ee.a=d(G,_e,ee.a),we!==ee.o&&ct(G,"placeholder",ee.o=we),ee.i=d(U,ie,ee.i),ee.n=d(V,ve,ee.n),K!==ee.s&&ct(V,"placeholder",ee.s=K),ee.h=d(fe,Pe,ee.h),ee.r=d(ge,Te,ee.r),ee.d=d(O,xe,ee.d),ee.l=d(ne,$e,ee.l),ee.u=d(le,Oe,ee.u),ee.c=d(j,Qe,ee.c),ee.w=d(D,Ue,ee.w),Ie!==ee.m&&ct(D,"placeholder",ee.m=Ie),ee},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),se(()=>G.value=r()),se(()=>V.value=i()),se(()=>O.value=a()),se(()=>D.value=u()),w}})};wt(["click"]);var ZC=H("<form><div>"),xh=H("<div><label> *"),eA=H("<div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment>"),tA=H("<div><label>"),rA=H("<div><label> *</label><input type=number min=0 step=1 required>"),nA=H("<div><label></label><input type=number min=0 step=0.01>"),iA=H("<div><label></label><input type=text>"),oA=H("<div><label></label><textarea>"),sA=H("<div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span>:</span><span> "),aA=H("<div><div><span>:</span><span>"),lA=H("<div>");const cA=t=>{const{t:e}=it(),[r,n]=ye({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""}),[i,o]=ye(""),[a,c]=ye(""),[u,h]=ye("in"),[f,p]=ye(0),[b,C]=ye(0),[R,E]=ye(""),[x,T]=ye(""),[W,te]=ye(""),[Q,de]=ye(""),[ae,I]=ye(!1),[_,v]=ye(!1),P=()=>t.mode==="movement",w=ze(()=>i()?Re.getProductById(i()):null),A=ze(()=>a()?Re.getLocationById(a()):null),y=ze(()=>W()?Re.getLocationById(W()):null),he=ze(()=>f()*b()),G=ze(()=>!i()||!a()?0:Re.getStockByProductAndLocation(i(),a())?.quantity||0),k=[{value:"Electronics",label:"Electronics"},{value:"Accessories",label:"Accessories"},{value:"Furniture",label:"Furniture"},{value:"Office Supplies",label:"Office Supplies"},{value:"Software",label:"Software"},{value:"Hardware",label:"Hardware"},{value:"Consumables",label:"Consumables"}],Z=[{value:"Warehouse A",label:"Warehouse A"},{value:"Warehouse B",label:"Warehouse B"},{value:"Warehouse C",label:"Warehouse C"},{value:"Storage Room",label:"Storage Room"},{value:"Main Office",label:"Main Office"}],U={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},F=()=>{o(""),c(""),h("in"),p(0),C(0),E(""),T(""),te(""),de("")},N=()=>{n({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""})},V=pe=>{if(pe.preventDefault(),P()){if(de(""),!i()){de(e("forms.selectProduct"));return}if(!a()){de(e("forms.selectLocation"));return}if(f()<=0){de(e("forms.quantityGreaterThanZero"));return}if(b()<0){de(e("forms.unitCostNotNegative"));return}if(u()==="transfer"&&!W()){de(e("forms.selectFromLocation"));return}if(u()==="transfer"&&W()===a()){de(e("forms.sameLocationError"));return}if(u()==="out"&&f()>G()){de(e("forms.insufficientStock",{currentStock:G()}));return}const be=w(),ne=A(),le={productId:be.id,productName:be.name,productSku:be.sku,locationId:ne.id,locationName:ne.name,movementType:u(),quantity:f(),unitCost:b()||be.unitCost,totalCost:he()||f()*be.unitCost,referenceNumber:R()||`AUTO-${Date.now()}`,notes:x(),createdBy:"admin",fromLocationId:u()==="transfer"?W():void 0,fromLocationName:u()==="transfer"?y()?.name:void 0};Re.addInventoryMovement(le),F()}else{const be=r();if(!be.name||!be.price||!be.quantity||!be.category||!be.sku||!be.supplier||!be.minStock||!be.location){alert(e("forms.fillAllRequired"));return}const ne={name:be.name,price:parseFloat(be.price),quantity:parseInt(be.quantity),category:be.category,description:be.description,sku:be.sku,supplier:be.supplier,minStock:parseInt(be.minStock),location:be.location};Re.addItem(ne),N()}t.onClose()},fe=(pe,be)=>{n(ne=>({...ne,[pe]:be}))},z=()=>{P()?F():N(),t.onClose()},ge=pe=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(pe),$={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},O={...$,cursor:"pointer"},X={color:"#f44336","font-size":"0.875rem","margin-top":"0.5rem"},Y={padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},ue={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},re={"font-weight":"500",color:"var(--text-muted)"},M={"font-weight":"600",color:"var(--text-primary)"},oe=()=>P()?e("inventory.addMovement"):e("inventory.addNewItem");return S(yr,{get isOpen(){return t.isOpen},onClose:z,get title(){return oe()},get children(){return[(()=>{var pe=ZC(),be=pe.firstChild;return pe.addEventListener("submit",V),s(pe,(()=>{var ne=me(()=>!!P());return()=>ne()?[(()=>{var le=xh(),j=le.firstChild,ce=j.firstChild;return le.style.setProperty("margin-bottom","1.5rem"),j.style.setProperty("display","block"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("font-weight","500"),s(j,()=>e("inventory.product"),ce),s(le,S(Hy,{get value(){return i()},onChange:D=>{o(D);const J=Re.getProductById(D);J&&C(J.unitCost)},get placeholder(){return e("inventory.searchProductsPlaceholder")},onAddNew:()=>I(!0),required:!0}),null),le})(),(()=>{var le=eA(),j=le.firstChild,ce=j.firstChild,D=j.nextSibling,J=D.firstChild,ee=J.nextSibling,q=ee.nextSibling,B=q.nextSibling;return le.style.setProperty("margin-bottom","1.5rem"),j.style.setProperty("display","block"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("font-weight","500"),s(j,()=>e("inventory.movementType"),ce),D.addEventListener("change",_e=>h(_e.target.value)),s(J,()=>e("inventory.stockInPurchase")),s(ee,()=>e("inventory.stockOutSale")),s(q,()=>e("inventory.transferBetween")),s(B,()=>e("inventory.stockAdjustment")),se(_e=>d(D,O,_e)),se(()=>D.value=u()),le})(),me(()=>me(()=>u()==="transfer")()&&(()=>{var le=xh(),j=le.firstChild,ce=j.firstChild;return le.style.setProperty("margin-bottom","1.5rem"),j.style.setProperty("display","block"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("font-weight","500"),s(j,()=>e("inventory.fromLocation"),ce),s(le,S(Ea,{get value(){return W()},onChange:D=>te(D),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>v(!0),required:!0}),null),le})()),(()=>{var le=tA(),j=le.firstChild;return le.style.setProperty("margin-bottom","1.5rem"),j.style.setProperty("display","block"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("font-weight","500"),s(j,(()=>{var ce=me(()=>u()==="transfer");return()=>ce()?e("inventory.toLocation")+" *":e("inventory.locationName")+" *"})()),s(le,S(Ea,{get value(){return a()},onChange:ce=>c(ce),get placeholder(){return me(()=>u()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>v(!0),required:!0}),null),le})(),me(()=>me(()=>!!(w()&&A()))()&&(()=>{var le=sA(),j=le.firstChild,ce=j.firstChild,D=ce.firstChild,J=ce.nextSibling,ee=J.firstChild,q=j.nextSibling,B=q.firstChild,_e=B.firstChild,we=B.nextSibling,ie=q.nextSibling,ve=ie.firstChild,K=ve.firstChild,Pe=ve.nextSibling,Te=Pe.firstChild;return s(ce,()=>e("inventory.currentStockAt",{location:A()?.name}),D),s(J,G,ee),s(J,()=>w()?.unitOfMeasure,null),s(B,()=>e("inventory.productCost"),_e),s(we,()=>ge(w()?.unitCost||0)),s(ve,()=>e("inventory.minStockLevel"),K),s(Pe,()=>w()?.minStockLevel,Te),s(Pe,()=>w()?.unitOfMeasure,null),se(xe=>{var $e=Y,Oe=ue,Qe=re,Ue=M,Ie=ue,Me=re,qe=M,He=ue,Ge=re,Ae=M;return xe.e=d(le,$e,xe.e),xe.t=d(j,Oe,xe.t),xe.a=d(ce,Qe,xe.a),xe.o=d(J,Ue,xe.o),xe.i=d(q,Ie,xe.i),xe.n=d(B,Me,xe.n),xe.s=d(we,qe,xe.s),xe.h=d(ie,He,xe.h),xe.r=d(ve,Ge,xe.r),xe.d=d(Pe,Ae,xe.d),xe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),le})()),(()=>{var le=rA(),j=le.firstChild,ce=j.firstChild,D=j.nextSibling;return le.style.setProperty("margin-bottom","1.5rem"),j.style.setProperty("display","block"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("font-weight","500"),s(j,()=>e("inventory.quantity"),ce),D.addEventListener("change",J=>p(Number(J.target.value))),se(J=>d(D,$,J)),se(()=>D.value=f()),le})(),(()=>{var le=nA(),j=le.firstChild,ce=j.nextSibling;return le.style.setProperty("margin-bottom","1.5rem"),j.style.setProperty("display","block"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("font-weight","500"),s(j,()=>e("inventory.unitCost")),ce.addEventListener("change",D=>C(Number(D.target.value))),se(D=>{var J=$,ee=e("inventory.willUseDefaultCost");return D.e=d(ce,J,D.e),ee!==D.t&&ct(ce,"placeholder",D.t=ee),D},{e:void 0,t:void 0}),se(()=>ce.value=b()),le})(),me(()=>me(()=>f()>0&&b()>0)()&&(()=>{var le=aA(),j=le.firstChild,ce=j.firstChild,D=ce.firstChild,J=ce.nextSibling;return s(ce,()=>e("inventory.totalCost"),D),s(J,()=>ge(he())),se(ee=>{var q=Y,B=ue,_e=re,we={...M,"font-size":"1.2rem",color:"var(--primary-color)"};return ee.e=d(le,q,ee.e),ee.t=d(j,B,ee.t),ee.a=d(ce,_e,ee.a),ee.o=d(J,we,ee.o),ee},{e:void 0,t:void 0,a:void 0,o:void 0}),le})()),(()=>{var le=iA(),j=le.firstChild,ce=j.nextSibling;return le.style.setProperty("margin-bottom","1.5rem"),j.style.setProperty("display","block"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("font-weight","500"),s(j,()=>e("common.referenceNumber")),ce.addEventListener("change",D=>E(D.target.value)),se(D=>{var J=$,ee=e("common.referenceNumberPlaceholder");return D.e=d(ce,J,D.e),ee!==D.t&&ct(ce,"placeholder",D.t=ee),D},{e:void 0,t:void 0}),se(()=>ce.value=R()),le})(),(()=>{var le=oA(),j=le.firstChild,ce=j.nextSibling;return le.style.setProperty("margin-bottom","1.5rem"),j.style.setProperty("display","block"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("font-weight","500"),s(j,()=>e("common.notes")),ce.addEventListener("change",D=>T(D.target.value)),se(D=>{var J={...$,"min-height":"100px",resize:"vertical"},ee=e("inventory.additionalNotesPlaceholder");return D.e=d(ce,J,D.e),ee!==D.t&&ct(ce,"placeholder",D.t=ee),D},{e:void 0,t:void 0}),se(()=>ce.value=x()),le})(),me(()=>me(()=>!!Q())()&&(()=>{var le=lA();return d(le,X),s(le,Q),le})())]:[S(Pt,{get label(){return e("inventory.itemName")},get value(){return r().name},onChange:le=>fe("name",le),get placeholder(){return e("inventory.enterItemName")},required:!0}),S(Pt,{get label(){return e("inventory.sku")},get value(){return r().sku},onChange:le=>fe("sku",le),get placeholder(){return e("inventory.enterSkuCode")},required:!0}),S(mr,{get label(){return e("inventory.category")},get value(){return r().category},onChange:le=>fe("category",le),options:k,required:!0}),S(Pt,{get label(){return e("common.description")},get value(){return r().description},onChange:le=>fe("description",le),get placeholder(){return e("inventory.enterItemDescription")}}),S(Pt,{get label(){return e("common.price")},type:"number",get value(){return r().price},onChange:le=>fe("price",le),get placeholder(){return e("common.enterPrice")},required:!0}),S(Pt,{get label(){return e("inventory.quantity")},type:"number",get value(){return r().quantity},onChange:le=>fe("quantity",le),get placeholder(){return e("inventory.enterQuantity")},required:!0}),S(Pt,{get label(){return e("inventory.minimumStock")},type:"number",get value(){return r().minStock},onChange:le=>fe("minStock",le),get placeholder(){return e("inventory.enterMinStockLevel")},required:!0}),S(Pt,{get label(){return e("inventory.supplier")},get value(){return r().supplier},onChange:le=>fe("supplier",le),get placeholder(){return e("inventory.enterSupplierName")},required:!0}),S(mr,{get label(){return e("inventory.location")},get value(){return r().location},onChange:le=>fe("location",le),options:Z,required:!0})]})(),be),d(be,U),s(be,S(De,{variant:"secondary",type:"button",onClick:z,get children(){return e("common.cancel")}}),null),s(be,S(De,{variant:"primary",type:"submit",get children(){return me(()=>!!P())()?e("inventory.addMovement"):e("inventory.addItem")}}),null),pe})(),S(hu,{get isOpen(){return ae()},onClose:()=>I(!1),onProductAdded:pe=>{o(pe),I(!1)}}),S(mu,{get isOpen(){return _()},onClose:()=>v(!1),onLocationAdded:pe=>{u()==="transfer"&&!W()?te(pe):c(pe),v(!1)}})]}})};wt(["input","keydown"]);var uA=H("<form><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text required></div></div><div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><div><label></label></div></div><div><div><h3></h3></div></div><div><label></label><textarea></textarea></div><div>"),dA=H("<div><label> *"),hA=H("<div><div></div><div></div><div></div><div></div><div>"),Sl=H("<div>"),mA=H("<div><input type=number min=0 step=1 required><input type=number min=0 step=0.01><input type=text>"),fA=H("<div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span>"),yA=H("<div>• ");const gA=t=>{const{t:e}=it(),[r,n]=ye(`INV-${Date.now()}`),[i,o]=ye(""),[a,c]=ye("in"),[u,h]=ye(""),[f,p]=ye(""),[b,C]=ye(""),[R,E]=ye([]),[x,T]=ye([]),[W,te]=ye(!1),[Q,de]=ye(!1),ae=()=>{E(Y=>[...Y,{productId:"",quantity:0,unitCost:0,notes:""}])},I=Y=>{E(ue=>ue.filter((re,M)=>M!==Y))},_=(Y,ue,re)=>{E(M=>M.map((oe,pe)=>pe===Y?{...oe,[ue]:re}:oe))},v=()=>{n(`INV-${Date.now()}`),o(""),c("in"),h(""),p(""),C(""),E([]),T([])},P=async Y=>{Y.preventDefault(),T([]);const ue=[];if(i()||ue.push(e("forms.referenceNumberRequired")),u()||ue.push(e("forms.locationRequired")),a()==="transfer"&&!f()&&ue.push(e("forms.fromLocationRequired")),R().length===0&&ue.push(e("forms.atLeastOneProduct")),R().forEach((oe,pe)=>{oe.productId||ue.push(e("forms.itemProductRequired","Product is required for item {{index}}",{index:pe+1})),oe.quantity<=0&&ue.push(e("forms.itemQuantityRequired","Quantity must be greater than 0 for item {{index}}",{index:pe+1}))}),ue.length>0){T(ue);return}const re={ssg_inventory_key:js(),invoiceId:r(),referenceNumber:i(),movementType:a(),type:Bl(a()),locationId:u(),fromLocationId:a()==="transfer"?f():void 0,items:R(),products:R(),generalNotes:b(),description:b(),invoice:i(),store:u(),createdBy:"admin",createDate:new Date().toISOString()};console.log(re);const M=await Re.addBulkInventoryMovements(re);console.log(M),M.success?(v(),t.onClose()):T(M.errors)},w=()=>{v(),t.onClose()},A=ze(()=>R().reduce((Y,ue)=>{const re=Re.getProductById(ue.productId),M=ue.unitCost||re?.unitCost||0;return Y+ue.quantity*M},0)),y=ze(()=>R().reduce((Y,ue)=>Y+ue.quantity,0)),he={"margin-bottom":"1.5rem"},G={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},k={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},Z={...k,cursor:"pointer"},U={display:"grid",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},F={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},N={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem","padding-left":"0.75rem"},V={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},fe={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},z={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},ge={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},$=Y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Y),O=Y=>({in:e("inventory.purchaseReceive"),out:e("inventory.saleIssue"),transfer:e("inventory.transfer"),adjustment:e("inventory.adjustment")})[Y]||Y,X=async Y=>{await Re.fecthInventory(Y),await Re.fecthProduct(Y)};return un(()=>{X("prod")}),S(yr,{get isOpen(){return t.isOpen},onClose:w,get title(){return e("inventory.bulkMovement")},get children(){return[(()=>{var Y=uA(),ue=Y.firstChild,re=ue.firstChild,M=re.firstChild,oe=M.firstChild,pe=M.nextSibling,be=re.nextSibling,ne=be.firstChild,le=ne.firstChild,j=ne.nextSibling,ce=ue.nextSibling,D=ce.firstChild,J=D.firstChild,ee=D.nextSibling,q=ee.firstChild,B=q.nextSibling,_e=B.nextSibling,we=_e.nextSibling,ie=ce.nextSibling,ve=ie.firstChild,K=ve.firstChild,Pe=ie.nextSibling,Te=Pe.firstChild,xe=Te.firstChild,$e=Pe.nextSibling,Oe=$e.firstChild,Qe=Oe.nextSibling,Ue=$e.nextSibling;return Y.addEventListener("submit",P),ue.style.setProperty("display","grid"),ue.style.setProperty("grid-template-columns","1fr 1fr"),ue.style.setProperty("gap","1rem"),ue.style.setProperty("margin-bottom","1.5rem"),s(M,()=>e("common.invoiceDocumentId"),oe),pe.addEventListener("change",Ie=>n(Ie.target.value)),s(ne,()=>e("common.referenceNumber"),le),j.addEventListener("change",Ie=>o(Ie.target.value)),s(D,()=>e("inventory.movementType"),J),ee.addEventListener("change",Ie=>c(Ie.target.value)),s(q,()=>e("inventory.purchaseReceive")),s(B,()=>e("inventory.saleIssue")),s(_e,()=>e("inventory.transfer")),s(we,()=>e("inventory.adjustment")),ie.style.setProperty("display","grid"),ie.style.setProperty("gap","1rem"),ie.style.setProperty("margin-bottom","1.5rem"),s(ie,(()=>{var Ie=me(()=>a()==="transfer");return()=>Ie()&&(()=>{var Me=dA(),qe=Me.firstChild,He=qe.firstChild;return s(qe,()=>e("inventory.fromLocation"),He),s(Me,S(Ea,{get value(){return f()},onChange:Ge=>p(Ge),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>de(!0),required:!0}),null),se(Ge=>d(qe,G,Ge)),Me})()})(),ve),s(K,(()=>{var Ie=me(()=>a()==="transfer");return()=>Ie()?e("inventory.toLocation")+" *":e("inventory.location")+" *"})()),s(ve,S(Ea,{get value(){return u()},onChange:Ie=>h(Ie),get placeholder(){return me(()=>a()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>de(!0),required:!0}),null),Te.style.setProperty("display","flex"),Te.style.setProperty("justify-content","space-between"),Te.style.setProperty("align-items","center"),Te.style.setProperty("margin-bottom","1rem"),xe.style.setProperty("margin","0"),xe.style.setProperty("font-size","1.1rem"),s(xe,()=>e("inventory.products")),s(Te,S(De,{variant:"outline",type:"button",onClick:ae,get children(){return e("inventory.addProduct")}}),null),s(Pe,(()=>{var Ie=me(()=>R().length>0);return()=>Ie()&&[(()=>{var Me=hA(),qe=Me.firstChild,He=qe.nextSibling,Ge=He.nextSibling,Ae=Ge.nextSibling;return d(Me,N),s(qe,()=>e("inventory.product")),s(He,()=>e("inventory.quantity")),s(Ge,()=>e("inventory.unitCost")),s(Ae,()=>e("common.notes")),Me})(),S(Ot,{get each(){return R()},children:(Me,qe)=>[(()=>{var He=Sl();return d(He,U),s(He,S(Hy,{get value(){return Me.productId},onChange:Ge=>{_(qe(),"productId",Ge.id);let Ae={id:Ge.id,label:Ge.name,code:Ge.sku};_(qe(),"product",Ae);const ot=Re.getProductById(Ge.id);ot&&!Me.unitCost&&_(qe(),"unitCost",ot.unitCost)},get placeholder(){return e("inventory.searchProduct")},onAddNew:()=>te(!0),required:!0})),He})(),(()=>{var He=mA(),Ge=He.firstChild,Ae=Ge.nextSibling,ot=Ae.nextSibling;return d(He,F),Ge.addEventListener("change",et=>_(qe(),"quantity",Number(et.target.value))),Ae.addEventListener("change",et=>_(qe(),"unitCost",Number(et.target.value))),ot.addEventListener("change",et=>_(qe(),"notes",et.target.value)),s(He,S(De,{variant:"outline",size:"sm",type:"button",onClick:()=>I(qe()),style:{color:"#f44336","border-color":"#f44336"},get children(){return e("common.remove")}}),null),se(et=>{var pt=k,yt=k,xt=e("common.auto"),Yt=k,kt=e("common.optionalNotes");return et.e=d(Ge,pt,et.e),et.t=d(Ae,yt,et.t),xt!==et.a&&ct(Ae,"placeholder",et.a=xt),et.o=d(ot,Yt,et.o),kt!==et.i&&ct(ot,"placeholder",et.i=kt),et},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),se(()=>Ge.value=Me.quantity),se(()=>Ae.value=Me.unitCost),se(()=>ot.value=Me.notes),He})()]})]})(),null),s(Pe,(()=>{var Ie=me(()=>R().length===0);return()=>Ie()&&(()=>{var Me=Sl();return Me.style.setProperty("text-align","center"),Me.style.setProperty("padding","2rem"),Me.style.setProperty("background","var(--background-color)"),Me.style.setProperty("border-radius","var(--border-radius-sm)"),Me.style.setProperty("border","1px solid var(--border-color)"),Me.style.setProperty("color","var(--text-muted)"),s(Me,()=>e("inventory.noProductsAdded")),Me})()})(),null),s(Y,(()=>{var Ie=me(()=>R().length>0);return()=>Ie()&&(()=>{var Me=fA(),qe=Me.firstChild,He=qe.nextSibling,Ge=He.firstChild,Ae=Ge.firstChild,ot=Ge.nextSibling,et=He.nextSibling,pt=et.firstChild,yt=pt.firstChild,xt=pt.nextSibling,Yt=et.nextSibling,kt=Yt.firstChild,Qt=kt.firstChild,st=kt.nextSibling,ar=Yt.nextSibling,Ht=ar.firstChild,Rt=Ht.firstChild,Fe=Ht.nextSibling;return d(Me,V),qe.style.setProperty("margin","0 0 1rem 0"),qe.style.setProperty("font-size","1rem"),s(qe,()=>e("common.summary")),s(Ge,()=>e("inventory.totalProducts"),Ae),ot.style.setProperty("font-weight","600"),s(ot,()=>R().length),s(pt,()=>e("inventory.totalItems"),yt),xt.style.setProperty("font-weight","600"),s(xt,y),s(kt,()=>e("inventory.totalValue"),Qt),st.style.setProperty("font-weight","600"),st.style.setProperty("color","var(--primary-color)"),s(st,()=>$(A())),s(Ht,()=>e("inventory.movementType"),Rt),Fe.style.setProperty("font-weight","600"),s(Fe,()=>O(a())),se(Le=>{var Ye=fe,lt=fe,Tt=fe,Xe=fe;return Le.e=d(He,Ye,Le.e),Le.t=d(et,lt,Le.t),Le.a=d(Yt,Tt,Le.a),Le.o=d(ar,Xe,Le.o),Le},{e:void 0,t:void 0,a:void 0,o:void 0}),Me})()})(),$e),s(Oe,()=>e("common.generalNotes")),Qe.addEventListener("change",Ie=>C(Ie.target.value)),s(Y,(()=>{var Ie=me(()=>x().length>0);return()=>Ie()&&(()=>{var Me=Sl();return d(Me,z),s(Me,S(Ot,{get each(){return x()},children:qe=>(()=>{var He=yA();return He.firstChild,s(He,qe,null),He})()})),Me})()})(),Ue),d(Ue,ge),s(Ue,S(De,{variant:"secondary",type:"button",onClick:w,get children(){return e("common.cancel")}}),null),s(Ue,S(De,{variant:"primary",type:"submit",get children(){return e("inventory.createMovement")}}),null),se(Ie=>{var Me=G,qe=k,He=G,Ge=k,Ae=e("common.referenceNumberPlaceholder"),ot=he,et=G,pt=Z,yt=a()==="transfer"?"1fr 1fr":"1fr",xt=G,Yt=he,kt=he,Qt=G,st={...k,"min-height":"80px",resize:"vertical"},ar=e("inventory.generalNotesPlaceholder");return Ie.e=d(M,Me,Ie.e),Ie.t=d(pe,qe,Ie.t),Ie.a=d(ne,He,Ie.a),Ie.o=d(j,Ge,Ie.o),Ae!==Ie.i&&ct(j,"placeholder",Ie.i=Ae),Ie.n=d(ce,ot,Ie.n),Ie.s=d(D,et,Ie.s),Ie.h=d(ee,pt,Ie.h),yt!==Ie.r&&((Ie.r=yt)!=null?ie.style.setProperty("grid-template-columns",yt):ie.style.removeProperty("grid-template-columns")),Ie.d=d(K,xt,Ie.d),Ie.l=d(Pe,Yt,Ie.l),Ie.u=d($e,kt,Ie.u),Ie.c=d(Oe,Qt,Ie.c),Ie.w=d(Qe,st,Ie.w),ar!==Ie.m&&ct(Qe,"placeholder",Ie.m=ar),Ie},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),se(()=>pe.value=r()),se(()=>j.value=i()),se(()=>ee.value=a()),se(()=>Qe.value=b()),Y})(),S(hu,{get isOpen(){return W()},onClose:()=>te(!1),onProductAdded:Y=>{te(!1)}}),S(mu,{get isOpen(){return Q()},onClose:()=>de(!1),onLocationAdded:Y=>{a()==="transfer"&&!f()?p(Y):h(Y),de(!1)}})]}})};var pA=H("<div><div></div><div></div><div></div><div>"),vA=H("<div><strong>:</strong> "),bA=H("<div><div><span></span><span></span></div><div><span></span><span> </span></div><div><span></span><span> </span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),_A=H("<div>");const SA=t=>{const{t:e}=it(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},i={"font-weight":"600",color:"var(--text-primary)"},o={"text-align":"center","margin-bottom":"2rem"},a={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},c={color:"var(--text-muted)","font-size":"1rem"},u={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"1rem"},h=(E,x)=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:E>x?"#d4edda":"#f8d7da",color:E>x?"#155724":"#721c24"}),f={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},p={"margin-bottom":"1.5rem",padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",color:"var(--text-secondary)"};if(!t.item)return null;const b=E=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(E),C=E=>new Date(E).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),R=t.item.price*t.item.quantity;return S(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.itemDetails")},get children(){return[(()=>{var E=pA(),x=E.firstChild,T=x.nextSibling,W=T.nextSibling,te=W.nextSibling;return d(E,o),d(x,a),s(x,()=>t.item.name),d(T,c),s(T,()=>t.item.category),d(W,u),s(W,()=>b(t.item.price)),s(te,(()=>{var Q=me(()=>t.item.quantity>t.item.minStock);return()=>Q()?e("inventory.inStock"):e("inventory.lowStockAlert")})()),se(Q=>d(te,h(t.item.quantity,t.item.minStock),Q)),E})(),(()=>{var E=vA(),x=E.firstChild,T=x.firstChild;return x.nextSibling,d(E,p),s(x,()=>e("common.description"),T),s(E,()=>t.item.description,null),E})(),(()=>{var E=bA(),x=E.firstChild,T=x.firstChild,W=T.nextSibling,te=x.nextSibling,Q=te.firstChild,de=Q.nextSibling,ae=de.firstChild,I=te.nextSibling,_=I.firstChild,v=_.nextSibling,P=v.firstChild,w=I.nextSibling,A=w.firstChild,y=A.nextSibling,he=w.nextSibling,G=he.firstChild,k=G.nextSibling,Z=he.nextSibling,U=Z.firstChild,F=U.nextSibling,N=Z.nextSibling,V=N.firstChild,fe=V.nextSibling;return s(T,()=>e("inventory.sku")),s(W,()=>t.item.sku),s(Q,()=>e("inventory.quantity")),s(de,()=>t.item.quantity,ae),s(de,()=>e("common.units"),null),s(_,()=>e("inventory.minimumStock")),s(v,()=>t.item.minStock,P),s(v,()=>e("common.units"),null),s(A,()=>e("inventory.totalValue")),s(y,()=>b(R)),s(G,()=>e("inventory.supplier")),s(k,()=>t.item.supplier),s(U,()=>e("inventory.location")),s(F,()=>t.item.location),s(V,()=>e("common.lastUpdated")),s(fe,()=>C(t.item.lastUpdated)),se(z=>{var ge=r,$=n,O=i,X=r,Y=n,ue=i,re=r,M=n,oe=i,pe=r,be=n,ne=i,le=r,j=n,ce=i,D=r,J=n,ee=i,q=r,B=n,_e=i;return z.e=d(x,ge,z.e),z.t=d(T,$,z.t),z.a=d(W,O,z.a),z.o=d(te,X,z.o),z.i=d(Q,Y,z.i),z.n=d(de,ue,z.n),z.s=d(I,re,z.s),z.h=d(_,M,z.h),z.r=d(v,oe,z.r),z.d=d(w,pe,z.d),z.l=d(A,be,z.l),z.u=d(y,ne,z.u),z.c=d(he,le,z.c),z.w=d(G,j,z.w),z.m=d(k,ce,z.m),z.f=d(Z,D,z.f),z.y=d(U,J,z.y),z.g=d(F,ee,z.g),z.p=d(N,q,z.p),z.b=d(V,B,z.b),z.T=d(fe,_e,z.T),z},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),E})(),(()=>{var E=_A();return d(E,f),s(E,S(De,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(E,S(De,{variant:"primary",onClick:()=>{console.log("Edit item:",t.item.id)},get children(){return e("common.editItem")}}),null),E})()]}})};var PA=H("<div>🔄"),wA=H("<button type=button>×"),CA=H("<div>⚠️ "),Th=H("<div>"),AA=H("<div><div><input type=text autocomplete=off>"),IA=H("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>"),EA=H("<span>⚠️ ");const xA=t=>{const{t:e}=it(),[r,n]=ye(""),[i,o]=ye(!1),[a,c]=ye(null),[u,h]=ye([]),[f,p]=ye(!1),[b,C]=ye(-1),[R,E]=ye(null),x=t.searchDelay||300;t.maxResults;const T=async ge=>{if(!ge.trim()||ge.trim().length<3){h([]),t.onSearchResults?.([]);return}try{o(!0),c(null);try{console.log("apiResults",ge),t.onSearchResults?.(ge)}catch($){console.warn("API search failed, using local fallback:",$),c("API search failed, showing local results")}}catch($){const O=$ instanceof Error?$.message:"Search failed";c(O),h([]),t.onSearchResults?.([])}finally{o(!1)}},W=ge=>{const O=ge.target.value;n(O),c(null),console.log(),t.showResults,R()&&clearTimeout(R());const X=setTimeout(()=>{T(O)},x);E(X)},te=ge=>{n(ge.name),p(!1),C(-1),t.onInventorySelect?.(ge)},Q=ge=>{if(!(!f()||u().length===0))switch(ge.key){case"ArrowDown":ge.preventDefault(),C($=>Math.min($+1,u().length-1));break;case"ArrowUp":ge.preventDefault(),C($=>Math.max($-1,-1));break;case"Enter":ge.preventDefault(),b()>=0&&u()[b()]&&te(u()[b()]);break;case"Escape":p(!1),C(-1);break}},de=()=>{t.showResults!==!1&&u().length>0&&p(!0)},ae=()=>{setTimeout(()=>{p(!1),C(-1)},150)},I=()=>{n(""),h([]),c(null),p(!1),C(-1),t.onSearchResults?.([]),R()&&(clearTimeout(R()),E(null))},_=ge=>Re.stockLevels.filter($=>$.inventoryId===ge).reduce(($,O)=>$+O.quantity,0),v=ge=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ge),P={position:"relative",width:"100%",...t.style},w={position:"relative",display:"flex","align-items":"center"},A={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},y={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},he={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},G={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},k=ge=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:ge?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),Z={display:"flex","justify-content":"space-between","align-items":"center"},U={flex:"1"},F={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},N={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},V={"text-align":"right","font-size":"0.875rem"},fe={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},z={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var ge=AA(),$=ge.firstChild,O=$.firstChild;return O.addEventListener("blur",ae),O.addEventListener("focus",de),O.$$keydown=Q,O.$$input=W,s($,S(Ve,{get when(){return i()},get children(){var X=PA();return se(Y=>d(X,he,Y)),X}}),null),s($,S(Ve,{get when(){return me(()=>!!r())()&&!i()},get children(){var X=wA();return X.addEventListener("mouseleave",Y=>{Y.currentTarget.style.background="none",Y.currentTarget.style.color="var(--text-muted)"}),X.addEventListener("mouseenter",Y=>{Y.currentTarget.style.background="var(--border-color)",Y.currentTarget.style.color="var(--text-primary)"}),X.$$click=I,se(Y=>{var ue=y,re=e("common.clear","Clear search");return Y.e=d(X,ue,Y.e),re!==Y.t&&ct(X,"title",Y.t=re),Y},{e:void 0,t:void 0}),X}}),null),s(ge,S(Ve,{get when(){return f()&&t.showResults!==!1},get children(){var X=Th();return s(X,S(Ve,{get when(){return a()},get children(){var Y=CA();return Y.firstChild,d(Y,z),s(Y,a,null),Y}}),null),s(X,S(Ve,{get when(){return u().length>0},get fallback(){return me(()=>!!(r()&&!i()))()&&(()=>{var Y=Th();return d(Y,fe),s(Y,()=>e("inventory.noInventorysFound","No inventorys found matching your search.")),Y})()},get children(){return S(Ot,{get each(){return u()},children:(Y,ue)=>{const re=_(Y.id),M=re<=Y.minStockLevel;return(()=>{var oe=IA(),pe=oe.firstChild,be=pe.firstChild,ne=be.firstChild,le=ne.nextSibling,j=le.firstChild,ce=j.firstChild,D=j.nextSibling,J=D.nextSibling,ee=J.nextSibling,q=ee.nextSibling,B=be.nextSibling,_e=B.firstChild,we=_e.firstChild,ie=_e.nextSibling;return oe.addEventListener("mouseenter",()=>C(ue())),oe.$$click=()=>te(Y),d(pe,Z),d(be,U),d(ne,F),s(ne,()=>Y.name),d(le,N),s(j,()=>e("inventory.sku","SKU"),ce),s(j,()=>Y.sku,null),s(J,()=>Y.category),s(q,()=>v(Y.unitCost)),d(B,V),_e.style.setProperty("font-weight","600"),(M?"#f44336":"var(--text-primary)")!=null?_e.style.setProperty("color",M?"#f44336":"var(--text-primary)"):_e.style.removeProperty("color"),s(_e,re,we),s(_e,()=>Y.unitOfMeasure,null),ie.style.setProperty("color","var(--text-muted)"),s(ie,()=>M?(()=>{var ve=EA();return ve.firstChild,ve.style.setProperty("color","#f44336"),s(ve,()=>e("inventory.lowStock","Low Stock"),null),ve})():e("inventory.inStock","In Stock")),se(ve=>d(oe,k(ue()===b()),ve)),oe})()}})}}),null),se(Y=>d(X,G,Y)),X}}),null),se(X=>{var Y=P,ue=w,re=A,M=t.placeholder||e("inventory.searchInventorys","Search inventorys by name, SKU, or category..."),oe=t.disabled;return X.e=d(ge,Y,X.e),X.t=d($,ue,X.t),X.a=d(O,re,X.a),M!==X.o&&ct(O,"placeholder",X.o=M),oe!==X.i&&(O.disabled=X.i=oe),X},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),se(()=>O.value=r()),ge})()};wt(["input","keydown","click"]);var TA=H("<div>"),Pl=H("<div><span>:</span><span>"),$A=H("<div><button> "),kA=H("<div><div><div><h3></h3><div>: </div></div><div><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span> <!>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span>");const RA=t=>{const{t:e}=it(),r=C=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(C),n=C=>new Date(C).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),i=C=>({in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}})[C]||{bg:"#f5f5f5",color:"#666"},o=C=>({in:"📦",out:"📤",transfer:"🔄",adjustment:"⚖️"})[C]||"📋",a=()=>t.movement,c={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},u={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},h={"font-weight":"600",color:"var(--text-primary)","text-align":"right"},f={"margin-bottom":"1.5rem"},p={"font-weight":"600","margin-bottom":"0.75rem","padding-bottom":"0.5rem","border-bottom":"2px solid var(--border-color)"},b=C=>({display:"inline-flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"600","text-transform":"uppercase","letter-spacing":"0.5px",background:i(C).bg,color:i(C).color});return S(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.movementDetails")},size:"lg",get children(){return S(Ve,{get when(){return a()},get fallback(){return(()=>{var C=TA();return s(C,()=>e("common.noDataFound")),C})()},children:C=>(()=>{var R=kA(),E=R.firstChild,x=E.firstChild,T=x.firstChild,W=T.nextSibling,te=W.firstChild,Q=x.nextSibling,de=Q.firstChild,ae=E.nextSibling,I=ae.firstChild,_=I.nextSibling,v=_.firstChild,P=v.firstChild,w=v.nextSibling,A=_.nextSibling,y=A.firstChild,he=y.firstChild,G=y.nextSibling,k=G.firstChild,Z=A.nextSibling,U=Z.firstChild,F=U.firstChild,N=U.nextSibling,V=Z.nextSibling,fe=V.firstChild,z=fe.firstChild,ge=z.nextSibling;ge.nextSibling;var $=fe.nextSibling,O=ae.nextSibling,X=O.firstChild,Y=X.nextSibling,ue=Y.firstChild,re=ue.firstChild,M=ue.nextSibling,oe=O.nextSibling,pe=oe.firstChild,be=pe.nextSibling,ne=be.firstChild,le=ne.firstChild,j=ne.nextSibling,ce=be.nextSibling,D=ce.firstChild,J=D.firstChild,ee=D.nextSibling;return E.style.setProperty("display","flex"),E.style.setProperty("justify-content","space-between"),E.style.setProperty("align-items","center"),E.style.setProperty("margin-bottom","1.5rem"),E.style.setProperty("padding-bottom","1rem"),E.style.setProperty("border-bottom","2px solid var(--border-color)"),T.style.setProperty("margin","0 0 0.5rem 0"),T.style.setProperty("font-size","1.25rem"),s(T,()=>C().productName),W.style.setProperty("font-size","0.875rem"),W.style.setProperty("color","var(--text-muted)"),s(W,()=>e("inventory.sku"),te),s(W,()=>C().productSku,null),de.style.setProperty("font-size","1.2rem"),s(de,()=>o(C().movementType)),s(Q,()=>C().movementType,null),s(I,()=>e("inventory.movementInformation")),s(v,()=>e("inventory.referenceNumber"),P),s(w,()=>C().referenceNumber),s(y,()=>e("common.quantity"),he),s(G,()=>C().quantity,k),s(G,()=>e("common.units"),null),s(U,()=>e("inventory.unitCost"),F),s(N,()=>r(C().unitCost)),s(fe,()=>e("common.total"),z),s(fe,()=>e("common.value"),ge),s($,()=>r(C().totalCost)),s(X,()=>e("inventory.locationInformation")),s(ue,()=>e("inventory.location"),re),s(M,()=>C().locationName),s(O,S(Ve,{get when(){return C().fromLocationName},get children(){var q=Pl(),B=q.firstChild,_e=B.firstChild,we=B.nextSibling;return s(B,()=>e("common.from"),_e),s(we,()=>C().fromLocationName),se(ie=>{var ve=c,K=u,Pe=h;return ie.e=d(q,ve,ie.e),ie.t=d(B,K,ie.t),ie.a=d(we,Pe,ie.a),ie},{e:void 0,t:void 0,a:void 0}),q}}),null),s(O,S(Ve,{get when(){return C().invoiceId},get children(){var q=Pl(),B=q.firstChild,_e=B.firstChild,we=B.nextSibling;return s(B,()=>e("common.invoice"),_e),s(we,()=>C().invoiceId),se(ie=>{var ve=c,K=u,Pe={...h,color:"var(--primary-color)"};return ie.e=d(q,ve,ie.e),ie.t=d(B,K,ie.t),ie.a=d(we,Pe,ie.a),ie},{e:void 0,t:void 0,a:void 0}),q}}),null),s(pe,()=>e("common.details")),s(ne,()=>e("common.createdBy"),le),s(j,()=>C().createdBy),s(D,()=>e("common.created"),J),s(ee,()=>n(C().createdDate)),s(oe,S(Ve,{get when(){return C().notes},get children(){var q=Pl(),B=q.firstChild,_e=B.firstChild,we=B.nextSibling;return s(B,()=>e("common.notes"),_e),s(we,()=>C().notes),se(ie=>{var ve={...c,"border-bottom":"none"},K=u,Pe={...h,"font-style":"italic","max-width":"60%","white-space":"pre-wrap"};return ie.e=d(q,ve,ie.e),ie.t=d(B,K,ie.t),ie.a=d(we,Pe,ie.a),ie},{e:void 0,t:void 0,a:void 0}),q}}),null),s(R,S(Ve,{get when(){return t.onEdit},get children(){var q=$A(),B=q.firstChild,_e=B.firstChild;return q.style.setProperty("display","flex"),q.style.setProperty("justify-content","flex-end"),q.style.setProperty("margin-top","1.5rem"),q.style.setProperty("padding-top","1rem"),q.style.setProperty("border-top","1px solid var(--border-color)"),B.addEventListener("mouseleave",we=>{we.currentTarget.style.transform="translateY(0)",we.currentTarget.style.boxShadow="none"}),B.addEventListener("mouseenter",we=>{we.currentTarget.style.transform="translateY(-1px)",we.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)"}),B.$$click=()=>t.onEdit?.(C()),B.style.setProperty("padding","0.5rem 1.5rem"),B.style.setProperty("border-radius","var(--border-radius-sm)"),B.style.setProperty("border","1px solid var(--primary-color)"),B.style.setProperty("background","var(--primary-color)"),B.style.setProperty("color","white"),B.style.setProperty("cursor","pointer"),B.style.setProperty("font-weight","500"),B.style.setProperty("transition","all 0.2s ease"),s(B,()=>e("common.edit"),_e),s(B,()=>e("inventory.movement"),null),q}}),null),se(q=>{var B=b(C().movementType),_e=f,we=p,ie=c,ve=u,K=h,Pe=c,Te=u,xe={...h,"font-size":"1.1rem",color:"var(--primary-color)"},$e=c,Oe=u,Qe=h,Ue=c,Ie=u,Me={...h,"font-size":"1.1rem",color:"var(--primary-color)"},qe=f,He=p,Ge=c,Ae=u,ot=h,et=f,pt=p,yt=c,xt=u,Yt=h,kt=c,Qt=u,st=h;return q.e=d(Q,B,q.e),q.t=d(ae,_e,q.t),q.a=d(I,we,q.a),q.o=d(_,ie,q.o),q.i=d(v,ve,q.i),q.n=d(w,K,q.n),q.s=d(A,Pe,q.s),q.h=d(y,Te,q.h),q.r=d(G,xe,q.r),q.d=d(Z,$e,q.d),q.l=d(U,Oe,q.l),q.u=d(N,Qe,q.u),q.c=d(V,Ue,q.c),q.w=d(fe,Ie,q.w),q.m=d($,Me,q.m),q.f=d(O,qe,q.f),q.y=d(X,He,q.y),q.g=d(Y,Ge,q.g),q.p=d(ue,Ae,q.p),q.b=d(M,ot,q.b),q.T=d(oe,et,q.T),q.A=d(pe,pt,q.A),q.O=d(be,yt,q.O),q.I=d(ne,xt,q.I),q.S=d(j,Yt,q.S),q.W=d(ce,kt,q.W),q.C=d(D,Qt,q.C),q.B=d(ee,st,q.B),q},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),R})()})}})};wt(["click"]);var ci=H("<div>"),DA=H("<div><label></label><select><option value>"),NA=H("<div><div><span>:</span><span>$"),LA=H("<form><div><label></label><select><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><input type=number min=0.01 step=0.01></div><div><label></label><input type=number min=0 step=0.01></div><div><label></label><input type=text></div><div><label> (<!>)</label><input type=text></div><div><label> (<!>)</label><textarea></textarea></div><div><button type=button></button><button type=submit>"),$h=H("<option> (<!>)");const MA=t=>{const{t:e}=it(),[r,n]=ye("in"),[i,o]=ye(""),[a,c]=ye(""),[u,h]=ye(""),[f,p]=ye(""),[b,C]=ye(""),[R,E]=ye(""),[x,T]=ye(""),[W,te]=ye(!1),[Q,de]=ye({});ei(()=>{const he=t.movement;he&&t.isOpen&&(n(he.movementType),o(he.quantity.toString()),c(he.unitCost.toString()),h(he.referenceNumber),p(he.notes),E(he.locationId),C(he.fromLocationId||""),T(he.invoiceId||""),de({}))});const ae=()=>{const he={};return(!i()||parseFloat(i())<=0)&&(he.quantity=e("forms.requiredField")),(!a()||parseFloat(a())<0)&&(he.unitCost=e("forms.requiredField")),u().trim()||(he.referenceNumber=e("forms.requiredField")),R()||(he.locationId=e("forms.requiredField")),r()==="transfer"&&!b()&&(he.fromLocationId=e("forms.requiredField")),de(he),Object.keys(he).length===0},I=async he=>{if(he.preventDefault(),!(!ae()||!t.movement)){te(!0);try{const G=t.movement,k=Re.getProductById(G.productId),Z=Re.getLocationById(R()),U=b()?Re.getLocationById(b()):null;if(!k||!Z)throw new Error("Product or location not found");const F={...G,movementType:r(),quantity:parseFloat(i()),unitCost:parseFloat(a()),totalCost:parseFloat(i())*parseFloat(a()),referenceNumber:u().trim(),notes:f().trim(),locationId:R(),locationName:Z.name,fromLocationId:b()||void 0,fromLocationName:U?.name,invoiceId:x().trim()||void 0,lastModified:new Date().toISOString()};Re.updateMovement(G.id,F),t.onMovementUpdated?.(),t.onClose(),_()}catch(G){console.error("Error updating movement:",G),de({submit:e("forms.saveError")})}finally{te(!1)}}},_=()=>{n("in"),o(""),c(""),h(""),p(""),C(""),E(""),T(""),de({})},v=()=>{_(),t.onClose()},P={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",transition:"border-color 0.2s ease"},w={display:"block","margin-bottom":"0.25rem","font-weight":"500","font-size":"0.875rem"},A={color:"#d32f2f","font-size":"0.75rem","margin-top":"0.25rem"},y={"margin-bottom":"1rem"};return S(yr,{get isOpen(){return t.isOpen},onClose:v,get title(){return e("inventory.editMovement","Edit Movement")},get children(){return S(Ve,{get when(){return t.movement},get fallback(){return(()=>{var he=ci();return s(he,()=>e("common.loading")),he})()},get children(){var he=LA(),G=he.firstChild,k=G.firstChild,Z=k.nextSibling,U=Z.firstChild,F=U.nextSibling,N=F.nextSibling,V=N.nextSibling,fe=G.nextSibling,z=fe.firstChild,ge=z.nextSibling,$=ge.firstChild,O=fe.nextSibling,X=O.firstChild,Y=X.nextSibling,ue=O.nextSibling,re=ue.firstChild,M=re.nextSibling,oe=ue.nextSibling,pe=oe.firstChild,be=pe.nextSibling,ne=oe.nextSibling,le=ne.firstChild,j=le.firstChild,ce=j.nextSibling;ce.nextSibling;var D=le.nextSibling,J=ne.nextSibling,ee=J.firstChild,q=ee.firstChild,B=q.nextSibling;B.nextSibling;var _e=ee.nextSibling,we=J.nextSibling,ie=we.firstChild,ve=ie.nextSibling;return he.addEventListener("submit",I),s(k,()=>e("inventory.movementType")),Z.addEventListener("change",K=>n(K.target.value)),s(U,()=>e("inventory.stockIn")),s(F,()=>e("inventory.stockOut")),s(N,()=>e("inventory.transfer")),s(V,()=>e("inventory.adjustment")),s(z,(()=>{var K=me(()=>r()==="transfer");return()=>K()?e("inventory.toLocation"):e("inventory.location")})()),ge.addEventListener("change",K=>E(K.target.value)),s($,()=>e("modals.selectLocation")),s(ge,S(Ot,{get each(){return Re.getActiveLocations()},children:K=>(()=>{var Pe=$h(),Te=Pe.firstChild,xe=Te.nextSibling;return xe.nextSibling,s(Pe,()=>K.name,Te),s(Pe,()=>K.type,xe),se(()=>Pe.value=K.id),Pe})()}),null),s(fe,S(Ve,{get when(){return Q().locationId},get children(){var K=ci();return s(K,()=>Q().locationId),se(Pe=>d(K,A,Pe)),K}}),null),s(he,S(Ve,{get when(){return r()==="transfer"},get children(){var K=DA(),Pe=K.firstChild,Te=Pe.nextSibling,xe=Te.firstChild;return s(Pe,()=>e("inventory.fromLocation")),Te.addEventListener("change",$e=>C($e.target.value)),s(xe,()=>e("modals.selectLocation")),s(Te,S(Ot,{get each(){return Re.getActiveLocations().filter($e=>$e.id!==R())},children:$e=>(()=>{var Oe=$h(),Qe=Oe.firstChild,Ue=Qe.nextSibling;return Ue.nextSibling,s(Oe,()=>$e.name,Qe),s(Oe,()=>$e.type,Ue),se(()=>Oe.value=$e.id),Oe})()}),null),s(K,S(Ve,{get when(){return Q().fromLocationId},get children(){var $e=ci();return s($e,()=>Q().fromLocationId),se(Oe=>d($e,A,Oe)),$e}}),null),se($e=>{var Oe=y,Qe=w,Ue={...P,"border-color":Q().fromLocationId?"#d32f2f":"var(--border-color)"},Ie=W();return $e.e=d(K,Oe,$e.e),$e.t=d(Pe,Qe,$e.t),$e.a=d(Te,Ue,$e.a),Ie!==$e.o&&(Te.disabled=$e.o=Ie),$e},{e:void 0,t:void 0,a:void 0,o:void 0}),se(()=>Te.value=b()),K}}),O),s(X,()=>e("common.quantity")),Y.$$input=K=>o(K.target.value),s(O,S(Ve,{get when(){return Q().quantity},get children(){var K=ci();return s(K,()=>Q().quantity),se(Pe=>d(K,A,Pe)),K}}),null),s(re,()=>e("inventory.unitCost")),M.$$input=K=>c(K.target.value),s(ue,S(Ve,{get when(){return Q().unitCost},get children(){var K=ci();return s(K,()=>Q().unitCost),se(Pe=>d(K,A,Pe)),K}}),null),s(he,S(Ve,{get when(){return me(()=>!!i())()&&a()},get children(){var K=NA(),Pe=K.firstChild,Te=Pe.firstChild,xe=Te.firstChild,$e=Te.nextSibling;return $e.firstChild,Pe.style.setProperty("display","flex"),Pe.style.setProperty("justify-content","space-between"),Te.style.setProperty("font-weight","500"),s(Te,()=>e("common.total"),xe),$e.style.setProperty("font-weight","600"),$e.style.setProperty("color","var(--primary-color)"),s($e,()=>(parseFloat(i()||"0")*parseFloat(a()||"0")).toFixed(2),null),se(Oe=>d(K,{...y,padding:"0.75rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)"},Oe)),K}}),oe),s(pe,()=>e("inventory.referenceNumber")),be.$$input=K=>h(K.target.value),s(oe,S(Ve,{get when(){return Q().referenceNumber},get children(){var K=ci();return s(K,()=>Q().referenceNumber),se(Pe=>d(K,A,Pe)),K}}),null),s(le,()=>e("inventory.invoiceNumber"),j),s(le,()=>e("common.optional"),ce),D.$$input=K=>T(K.target.value),s(ee,()=>e("common.notes"),q),s(ee,()=>e("common.optional"),B),_e.$$input=K=>p(K.target.value),s(he,S(Ve,{get when(){return Q().submit},get children(){var K=ci();return s(K,()=>Q().submit),se(Pe=>d(K,{...A,"margin-bottom":"1rem"},Pe)),K}}),we),we.style.setProperty("display","flex"),we.style.setProperty("gap","1rem"),we.style.setProperty("justify-content","flex-end"),ie.$$click=v,ie.style.setProperty("padding","0.5rem 1rem"),ie.style.setProperty("border","1px solid var(--border-color)"),ie.style.setProperty("border-radius","var(--border-radius-sm)"),ie.style.setProperty("background","white"),ie.style.setProperty("cursor","pointer"),s(ie,()=>e("common.cancel")),ve.style.setProperty("padding","0.5rem 1rem"),ve.style.setProperty("border","none"),ve.style.setProperty("border-radius","var(--border-radius-sm)"),ve.style.setProperty("background","var(--primary-color)"),ve.style.setProperty("color","white"),ve.style.setProperty("cursor","pointer"),ve.style.setProperty("font-weight","500"),s(ve,(()=>{var K=me(()=>!!W());return()=>K()?e("modals.processing"):e("inventory.updateMovement","Update Movement")})()),se(K=>{var Pe=y,Te=w,xe=P,$e=W(),Oe=y,Qe=w,Ue={...P,"border-color":Q().locationId?"#d32f2f":"var(--border-color)"},Ie=W(),Me=y,qe=w,He={...P,"border-color":Q().quantity?"#d32f2f":"var(--border-color)"},Ge=e("modals.enterQuantity"),Ae=W(),ot=y,et=w,pt={...P,"border-color":Q().unitCost?"#d32f2f":"var(--border-color)"},yt=e("modals.enterCost"),xt=W(),Yt=y,kt=w,Qt={...P,"border-color":Q().referenceNumber?"#d32f2f":"var(--border-color)"},st=e("modals.enterReference"),ar=W(),Ht=y,Rt=w,Fe=P,Le=e("inventory.invoiceNumber"),Ye=W(),lt=y,Tt=w,Xe={...P,resize:"vertical","min-height":"80px"},bt=e("modals.addNotes"),dt=W(),gt=W(),Ct=W();return K.e=d(G,Pe,K.e),K.t=d(k,Te,K.t),K.a=d(Z,xe,K.a),$e!==K.o&&(Z.disabled=K.o=$e),K.i=d(fe,Oe,K.i),K.n=d(z,Qe,K.n),K.s=d(ge,Ue,K.s),Ie!==K.h&&(ge.disabled=K.h=Ie),K.r=d(O,Me,K.r),K.d=d(X,qe,K.d),K.l=d(Y,He,K.l),Ge!==K.u&&ct(Y,"placeholder",K.u=Ge),Ae!==K.c&&(Y.disabled=K.c=Ae),K.w=d(ue,ot,K.w),K.m=d(re,et,K.m),K.f=d(M,pt,K.f),yt!==K.y&&ct(M,"placeholder",K.y=yt),xt!==K.g&&(M.disabled=K.g=xt),K.p=d(oe,Yt,K.p),K.b=d(pe,kt,K.b),K.T=d(be,Qt,K.T),st!==K.A&&ct(be,"placeholder",K.A=st),ar!==K.O&&(be.disabled=K.O=ar),K.I=d(ne,Ht,K.I),K.S=d(le,Rt,K.S),K.W=d(D,Fe,K.W),Le!==K.C&&ct(D,"placeholder",K.C=Le),Ye!==K.B&&(D.disabled=K.B=Ye),K.v=d(J,lt,K.v),K.k=d(ee,Tt,K.k),K.x=d(_e,Xe,K.x),bt!==K.j&&ct(_e,"placeholder",K.j=bt),dt!==K.q&&(_e.disabled=K.q=dt),gt!==K.z&&(ie.disabled=K.z=gt),Ct!==K.P&&(ve.disabled=K.P=Ct),K},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0,x:void 0,j:void 0,q:void 0,z:void 0,P:void 0}),se(()=>Z.value=r()),se(()=>ge.value=R()),se(()=>Y.value=i()),se(()=>M.value=a()),se(()=>be.value=u()),se(()=>D.value=x()),se(()=>_e.value=f()),he}})}})};wt(["input","click"]);var OA=H("<div><div></div><div><div><label></label><select><option value=all></option><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),VA=H("<div><h2>"),kh=H("<div><label></label><select><option value>"),BA=H("<option> (<!>)"),FA=H("<option>"),UA=H("<div><div>📦</div><div></div><div>"),jA=H("<div><div><div><div><span></span><h3></h3><span></span></div><div> • </div></div><div><div></div><div> <!> @ </div></div></div><div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div><span>:</span><span>"),zA=H("<span>"),qA=H("<span>• <!>: "),Rh=H("<div><span>:</span><span>"),HA=H("<div><div><span>:</span><select><option value=10>10</option><option value=25>25</option><option value=50>50</option><option value=100>100</option></select><span></span></div><div><div><span>:</span><input type=number min=1><span> "),WA=H("<span>..."),GA=H("<button>");const YA=t=>{const{t:e}=it(),[r,n]=ye(""),[i,o]=ye(""),[a,c]=ye("all"),[u,h]=ye({start:"",end:""}),[f,p]=ye(""),[b,C]=ye(""),[R,E]=ye(1),[x,T]=ye(25),[W,te]=ye(null),[Q,de]=ye(!1),[ae,I]=ye(!1),_=ze(()=>{let ce=Re.movements;if(t.filterBy==="product"&&t.filterId?ce=ce.filter(D=>D.productId===t.filterId):t.filterBy==="location"&&t.filterId&&(ce=ce.filter(D=>D.locationId===t.filterId)),r()&&(ce=ce.filter(D=>D.productId===r())),i()&&(ce=ce.filter(D=>D.locationId===i())),a()!=="all"&&(ce=ce.filter(D=>D.movementType===a())),u().start&&(ce=ce.filter(D=>D.createdDate>=u().start)),u().end&&(ce=ce.filter(D=>D.createdDate<=u().end+"T23:59:59Z")),f()){const D=f().toLowerCase();ce=ce.filter(J=>J.productName.toLowerCase().includes(D)||J.productSku.toLowerCase().includes(D)||J.locationName.toLowerCase().includes(D)||J.referenceNumber.toLowerCase().includes(D)||J.notes.toLowerCase().includes(D)||J.createdBy.toLowerCase().includes(D)||J.invoiceId&&J.invoiceId.toLowerCase().includes(D)||J.fromLocationName&&J.fromLocationName.toLowerCase().includes(D)||J.movementType.toLowerCase().includes(D))}return ce.sort((D,J)=>new Date(J.createdDate).getTime()-new Date(D.createdDate).getTime())});ei(()=>{r(),i(),a(),u(),f(),E(1)});const v=ze(()=>{const ce=(R()-1)*x(),D=ce+x();return _().slice(ce,D)}),P=ze(()=>Math.ceil(_().length/x())),w=ze(()=>{const ce=_();return{total:ce.length,stockIn:ce.filter(D=>D.movementType==="in").length,stockOut:ce.filter(D=>D.movementType==="out").length,transfers:ce.filter(D=>D.movementType==="transfer").length,adjustments:ce.filter(D=>D.movementType==="adjustment").length,totalValue:ce.reduce((D,J)=>D+J.totalCost,0)}}),A={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},y={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},he={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)",cursor:"pointer"},G={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},k={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem","margin-bottom":"2rem"},Z={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","text-align":"center"},U={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},F={"font-size":"0.875rem",color:"var(--text-muted)","font-weight":"500"},N={padding:"1.5rem","margin-bottom":"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",transition:"all 0.2s ease"},V={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"1rem"};function fe(ce){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[ce]||{bg:"#f5f5f5",color:"#666"}}const z=ce=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:fe(ce).bg,color:fe(ce).color}),ge={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"1rem"},$={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.5rem 0","border-bottom":"1px solid var(--border-color)"},O={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},X={"font-weight":"600",color:"var(--text-primary)"},Y={display:"flex","justify-content":"space-between","align-items":"center","margin-top":"2rem",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},ue=ce=>({padding:"0.25rem 0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:ce?"var(--primary-color)":"var(--surface-color)",color:ce?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),re=ce=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ce),M=ce=>new Date(ce).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),oe=ce=>({in:"📦",out:"📤",transfer:"🔄",adjustment:"⚖️"})[ce]||"📋",pe=()=>{n(""),o(""),c("all"),h({start:"",end:""}),p(""),E(1)},be=ce=>{te(ce),de(!0)},ne=ce=>{te(ce),de(!1),I(!0)},le=()=>{I(!1),te(null)},j=async ce=>{i()&&(ce+=" "+i()),Bl(a())&&(ce+=" "+Bl(a()));const D=await Fn.getInventory(ce),J=Re.parseInventoryData(D);Re.updMovements(J)};return(()=>{var ce=OA(),D=ce.firstChild,J=D.nextSibling,ee=J.firstChild,q=ee.firstChild,B=q.nextSibling,_e=B.firstChild,we=_e.nextSibling,ie=we.nextSibling,ve=ie.nextSibling,K=ve.nextSibling,Pe=ee.nextSibling,Te=Pe.firstChild,xe=Te.nextSibling,$e=Pe.nextSibling,Oe=$e.firstChild,Qe=Oe.nextSibling,Ue=J.nextSibling,Ie=Ue.firstChild,Me=Ie.firstChild,qe=Me.nextSibling,He=Ie.nextSibling,Ge=He.firstChild,Ae=Ge.nextSibling,ot=He.nextSibling,et=ot.firstChild,pt=et.nextSibling,yt=ot.nextSibling,xt=yt.firstChild,Yt=xt.nextSibling,kt=yt.nextSibling,Qt=kt.firstChild,st=Qt.nextSibling,ar=kt.nextSibling,Ht=ar.firstChild,Rt=Ht.nextSibling;return s(ce,(()=>{var Fe=me(()=>!t.filterBy);return()=>Fe()&&(()=>{var Le=VA(),Ye=Le.firstChild;return d(Le,A),Ye.style.setProperty("margin","0"),Ye.style.setProperty("font-size","1.5rem"),s(Ye,()=>e("inventory.movements")),s(Le,S(De,{variant:"outline",onClick:pe,get children(){return e("common.clearFilters")}}),null),Le})()})(),D),s(ce,S(xA,{filters:{selectedLocation:i,movementType:a},onSearchResults:Fe=>{C(Fe),j(Fe)},get placeholder(){return e("inventory.searchProductsStock","Search inventories...")},showResults:!1,maxResults:20}),D),D.style.setProperty("margin","20px"),d(J,y),s(J,(()=>{var Fe=me(()=>!t.filterBy);return()=>Fe()&&[(()=>{var Le=kh(),Ye=Le.firstChild,lt=Ye.nextSibling,Tt=lt.firstChild;return Ye.style.setProperty("display","block"),Ye.style.setProperty("margin-bottom","0.5rem"),Ye.style.setProperty("font-weight","500"),s(Ye,()=>e("inventory.product")),lt.addEventListener("change",Xe=>n(Xe.target.value)),s(Tt,()=>e("inventory.allProducts")),s(lt,S(Ot,{get each(){return Re.products},children:Xe=>(()=>{var bt=BA(),dt=bt.firstChild,gt=dt.nextSibling;return gt.nextSibling,s(bt,()=>Xe.name,dt),s(bt,()=>Xe.sku,gt),se(()=>bt.value=Xe.id),bt})()}),null),se(Xe=>d(lt,he,Xe)),se(()=>lt.value=r()),Le})(),(()=>{var Le=kh(),Ye=Le.firstChild,lt=Ye.nextSibling,Tt=lt.firstChild;return Ye.style.setProperty("display","block"),Ye.style.setProperty("margin-bottom","0.5rem"),Ye.style.setProperty("font-weight","500"),s(Ye,()=>e("inventory.location")),lt.addEventListener("change",Xe=>o(Xe.target.value)),s(Tt,()=>e("inventory.allLocations")),s(lt,S(Ot,{get each(){return Re.locations},children:Xe=>(()=>{var bt=FA();return s(bt,()=>Xe.name),se(()=>bt.value=Xe.id),bt})()}),null),se(Xe=>d(lt,he,Xe)),se(()=>lt.value=i()),Le})()]})(),ee),q.style.setProperty("display","block"),q.style.setProperty("margin-bottom","0.5rem"),q.style.setProperty("font-weight","500"),s(q,()=>e("inventory.movementType")),B.addEventListener("change",Fe=>{c(Fe.target.value),j(b())}),s(_e,()=>e("inventory.allTypes")),s(we,()=>e("inventory.stockIn")),s(ie,()=>e("inventory.stockOut")),s(ve,()=>e("inventory.transfer")),s(K,()=>e("inventory.adjustment")),Te.style.setProperty("display","block"),Te.style.setProperty("margin-bottom","0.5rem"),Te.style.setProperty("font-weight","500"),s(Te,()=>e("common.startDate")),xe.addEventListener("change",Fe=>h(Le=>({...Le,start:Fe.target.value}))),Oe.style.setProperty("display","block"),Oe.style.setProperty("margin-bottom","0.5rem"),Oe.style.setProperty("font-weight","500"),s(Oe,()=>e("common.endDate")),Qe.addEventListener("change",Fe=>h(Le=>({...Le,end:Fe.target.value}))),d(Ue,k),s(Me,()=>w().total),s(qe,()=>e("inventory.totalMovements")),s(Ge,()=>w().stockIn),s(Ae,()=>e("inventory.stockIn")),s(et,()=>w().stockOut),s(pt,()=>e("inventory.stockOut")),s(xt,()=>w().transfers),s(Yt,()=>e("inventory.transfers")),s(Qt,()=>w().adjustments),s(st,()=>e("inventory.adjustments")),s(Ht,()=>re(w().totalValue)),s(Rt,()=>e("inventory.totalValue")),s(ce,(()=>{var Fe=me(()=>v().length===0);return()=>Fe()?(()=>{var Le=UA(),Ye=Le.firstChild,lt=Ye.nextSibling,Tt=lt.nextSibling;return Le.style.setProperty("text-align","center"),Le.style.setProperty("padding","3rem"),Le.style.setProperty("color","var(--text-muted)"),Le.style.setProperty("background","var(--surface-color)"),Le.style.setProperty("border-radius","var(--border-radius)"),Le.style.setProperty("border","1px solid var(--border-color)"),Ye.style.setProperty("font-size","1.5rem"),Ye.style.setProperty("margin-bottom","1rem"),lt.style.setProperty("font-size","1.1rem"),lt.style.setProperty("margin-bottom","0.5rem"),s(lt,()=>e("inventory.noMovementsFound")),Tt.style.setProperty("font-size","0.875rem"),s(Tt,()=>e("inventory.tryAdjustingFilters")),Le})():[S(Ot,{get each(){return v()},children:Le=>(()=>{var Ye=jA(),lt=Ye.firstChild,Tt=lt.firstChild,Xe=Tt.firstChild,bt=Xe.firstChild,dt=bt.nextSibling,gt=dt.nextSibling,Ct=Xe.nextSibling,rr=Ct.firstChild,jt=Tt.nextSibling,Ft=jt.firstChild,Wt=Ft.nextSibling,_t=Wt.firstChild,Jt=_t.nextSibling;Jt.nextSibling;var jr=lt.nextSibling,Ut=jr.firstChild,cr=Ut.firstChild,Nr=cr.firstChild,dn=Nr.firstChild,Lr=Nr.nextSibling,ii=cr.nextSibling,xi=ii.firstChild,ms=xi.firstChild,uo=xi.nextSibling,ho=Ut.nextSibling,Ti=ho.firstChild,xn=Ti.firstChild,fs=xn.firstChild,mo=xn.nextSibling;return Ye.addEventListener("mouseleave",at=>{at.currentTarget.style.transform="translateY(0)",at.currentTarget.style.boxShadow="none"}),Ye.addEventListener("mouseenter",at=>{at.currentTarget.style.transform="translateY(-2px)",at.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),Ye.$$click=()=>be(Le),d(lt,V),Xe.style.setProperty("display","flex"),Xe.style.setProperty("align-items","center"),Xe.style.setProperty("gap","0.5rem"),Xe.style.setProperty("margin-bottom","0.5rem"),bt.style.setProperty("font-size","1.2rem"),s(bt,()=>oe(Le.movementType)),dt.style.setProperty("margin","0"),dt.style.setProperty("font-size","1.1rem"),s(dt,()=>Le.productName),s(gt,()=>Le.movementType),s(Xe,(()=>{var at=me(()=>!!Le.invoiceId);return()=>at()&&(()=>{var Dt=zA();return Dt.style.setProperty("padding","0.2rem 0.5rem"),Dt.style.setProperty("border-radius","var(--border-radius-sm)"),Dt.style.setProperty("font-size","0.7rem"),Dt.style.setProperty("font-weight","500"),Dt.style.setProperty("background","var(--primary-color)"),Dt.style.setProperty("color","white"),s(Dt,()=>e("inventory.bulk")),Dt})()})(),null),Ct.style.setProperty("font-size","0.875rem"),Ct.style.setProperty("color","var(--text-muted)"),s(Ct,()=>Le.productSku,rr),s(Ct,()=>M(Le.createdDate),null),s(Ct,(()=>{var at=me(()=>!!Le.invoiceId);return()=>at()&&(()=>{var Dt=qA(),gr=Dt.firstChild,zr=gr.nextSibling;return zr.nextSibling,Dt.style.setProperty("margin-left","0.5rem"),Dt.style.setProperty("font-weight","500"),s(Dt,()=>e("common.invoice"),zr),s(Dt,()=>Le.invoiceId,null),Dt})()})(),null),jt.style.setProperty("text-align","right"),Ft.style.setProperty("font-size","1.25rem"),Ft.style.setProperty("font-weight","700"),Ft.style.setProperty("color","var(--primary-color)"),s(Ft,()=>re(Le.totalCost)),Wt.style.setProperty("font-size","0.875rem"),Wt.style.setProperty("color","var(--text-muted)"),s(Wt,()=>Le.quantity,_t),s(Wt,()=>e("common.units"),Jt),s(Wt,()=>re(Le.unitCost),null),d(jr,ge),s(Nr,()=>e("inventory.location"),dn),s(Lr,()=>Le.locationName),s(Ut,(()=>{var at=me(()=>!!Le.fromLocationName);return()=>at()&&(()=>{var Dt=Rh(),gr=Dt.firstChild,zr=gr.firstChild,hn=gr.nextSibling;return s(gr,()=>e("common.from"),zr),s(hn,()=>Le.fromLocationName),se(Vt=>{var Ar=$,Yr=O,Kr=X;return Vt.e=d(Dt,Ar,Vt.e),Vt.t=d(gr,Yr,Vt.t),Vt.a=d(hn,Kr,Vt.a),Vt},{e:void 0,t:void 0,a:void 0}),Dt})()})(),ii),s(xi,()=>e("common.reference"),ms),s(uo,()=>Le.referenceNumber),s(xn,()=>e("common.createdBy"),fs),s(mo,()=>Le.createdBy),s(ho,(()=>{var at=me(()=>!!Le.notes);return()=>at()&&(()=>{var Dt=Rh(),gr=Dt.firstChild,zr=gr.firstChild,hn=gr.nextSibling;return s(gr,()=>e("common.notes"),zr),s(hn,()=>Le.notes),se(Vt=>{var Ar={...$,"border-bottom":"none"},Yr=O,Kr={...X,"max-width":"200px","text-align":"right","font-style":"italic"};return Vt.e=d(Dt,Ar,Vt.e),Vt.t=d(gr,Yr,Vt.t),Vt.a=d(hn,Kr,Vt.a),Vt},{e:void 0,t:void 0,a:void 0}),Dt})()})(),null),se(at=>{var Dt={...N,"border-left":Le.invoiceId?"4px solid var(--primary-color)":"1px solid var(--border-color)",cursor:"pointer"},gr=z(Le.movementType),zr=$,hn=O,Vt=X,Ar=$,Yr=O,Kr=X,ys=$,Nt=O,$i=X;return at.e=d(Ye,Dt,at.e),at.t=d(gt,gr,at.t),at.a=d(cr,zr,at.a),at.o=d(Nr,hn,at.o),at.i=d(Lr,Vt,at.i),at.n=d(ii,Ar,at.n),at.s=d(xi,Yr,at.s),at.h=d(uo,Kr,at.h),at.r=d(Ti,ys,at.r),at.d=d(xn,Nt,at.d),at.l=d(mo,$i,at.l),at},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),Ye})()}),me(()=>me(()=>P()>1)()&&(()=>{var Le=HA(),Ye=Le.firstChild,lt=Ye.firstChild,Tt=lt.firstChild,Xe=lt.nextSibling,bt=Xe.nextSibling,dt=Ye.nextSibling,gt=dt.firstChild,Ct=gt.firstChild,rr=Ct.firstChild,jt=Ct.nextSibling,Ft=jt.nextSibling,Wt=Ft.firstChild;return d(Le,Y),Ye.style.setProperty("display","flex"),Ye.style.setProperty("align-items","center"),Ye.style.setProperty("gap","0.5rem"),lt.style.setProperty("font-size","0.875rem"),lt.style.setProperty("color","var(--text-muted)"),s(lt,()=>e("common.showPerPage","Show per page"),Tt),Xe.addEventListener("change",_t=>{T(Number(_t.target.value)),E(1)}),Xe.style.setProperty("padding","0.25rem 0.5rem"),Xe.style.setProperty("border","1px solid var(--border-color)"),Xe.style.setProperty("border-radius","var(--border-radius-sm)"),Xe.style.setProperty("background","var(--surface-color)"),Xe.style.setProperty("cursor","pointer"),Xe.style.setProperty("font-size","0.875rem"),bt.style.setProperty("font-size","0.875rem"),bt.style.setProperty("color","var(--text-muted)"),bt.style.setProperty("margin-left","1rem"),s(bt,()=>e("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:(R()-1)*x()+1,end:Math.min(R()*x(),_().length),total:_().length})),dt.style.setProperty("display","flex"),dt.style.setProperty("align-items","center"),dt.style.setProperty("gap","0.5rem"),s(dt,S(De,{variant:"outline",size:"sm",onClick:()=>E(1),get disabled(){return R()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.first","First")}}),gt),s(dt,S(De,{variant:"outline",size:"sm",onClick:()=>E(_t=>Math.max(1,_t-1)),get disabled(){return R()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.previous")}}),gt),s(dt,()=>{const _t=[],Jt=P(),jr=R();if(Jt<=7)for(let Ut=1;Ut<=Jt;Ut++)_t.push(Ut);else{_t.push(1),jr>3&&_t.push("...");for(let Ut=Math.max(2,jr-1);Ut<=Math.min(Jt-1,jr+1);Ut++)_t.includes(Ut)||_t.push(Ut);jr<Jt-2&&_t.push("..."),_t.includes(Jt)||_t.push(Jt)}return S(Ot,{each:_t,children:Ut=>Ut==="..."?(()=>{var cr=WA();return cr.style.setProperty("padding","0 0.5rem"),cr.style.setProperty("color","var(--text-muted)"),cr})():(()=>{var cr=GA();return cr.$$click=()=>E(Ut),s(cr,Ut),se(Nr=>d(cr,ue(Ut===R()),Nr)),cr})()})},gt),s(dt,S(De,{variant:"outline",size:"sm",onClick:()=>E(_t=>Math.min(P(),_t+1)),get disabled(){return R()===P()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.next")}}),gt),s(dt,S(De,{variant:"outline",size:"sm",onClick:()=>E(P()),get disabled(){return R()===P()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.last","Last")}}),gt),gt.style.setProperty("display","flex"),gt.style.setProperty("align-items","center"),gt.style.setProperty("gap","0.5rem"),gt.style.setProperty("margin-left","1rem"),Ct.style.setProperty("font-size","0.875rem"),Ct.style.setProperty("color","var(--text-muted)"),s(Ct,()=>e("common.page","Page"),rr),jt.addEventListener("change",_t=>{const Jt=Number(_t.target.value);Jt>=1&&Jt<=P()&&E(Jt)}),jt.style.setProperty("width","4rem"),jt.style.setProperty("padding","0.25rem 0.5rem"),jt.style.setProperty("border","1px solid var(--border-color)"),jt.style.setProperty("border-radius","var(--border-radius-sm)"),jt.style.setProperty("background","var(--surface-color)"),jt.style.setProperty("text-align","center"),jt.style.setProperty("font-size","0.875rem"),Ft.style.setProperty("font-size","0.875rem"),Ft.style.setProperty("color","var(--text-muted)"),s(Ft,()=>e("common.of","of"),Wt),s(Ft,P,null),se(()=>ct(jt,"max",P())),se(()=>Xe.value=x()),se(()=>jt.value=R()),Le})())]})(),null),s(ce,S(RA,{get isOpen(){return Q()},onClose:()=>{de(!1),te(null)},get movement(){return W()},onEdit:ne}),null),s(ce,S(Ve,{get when(){return $t.hasPermission("read_write")},get children(){return S(MA,{get isOpen(){return ae()},onClose:()=>{I(!1),te(null)},get movement(){return W()},onMovementUpdated:le})}}),null),se(Fe=>{var Le=he,Ye=G,lt=G,Tt=Z,Xe=U,bt=F,dt=Z,gt={...U,color:"#2d7d32"},Ct=F,rr=Z,jt={...U,color:"#d32f2f"},Ft=F,Wt=Z,_t={...U,color:"#1976d2"},Jt=F,jr=Z,Ut={...U,color:"#f57c00"},cr=F,Nr=Z,dn=U,Lr=F;return Fe.e=d(B,Le,Fe.e),Fe.t=d(xe,Ye,Fe.t),Fe.a=d(Qe,lt,Fe.a),Fe.o=d(Ie,Tt,Fe.o),Fe.i=d(Me,Xe,Fe.i),Fe.n=d(qe,bt,Fe.n),Fe.s=d(He,dt,Fe.s),Fe.h=d(Ge,gt,Fe.h),Fe.r=d(Ae,Ct,Fe.r),Fe.d=d(ot,rr,Fe.d),Fe.l=d(et,jt,Fe.l),Fe.u=d(pt,Ft,Fe.u),Fe.c=d(yt,Wt,Fe.c),Fe.w=d(xt,_t,Fe.w),Fe.m=d(Yt,Jt,Fe.m),Fe.f=d(kt,jr,Fe.f),Fe.y=d(Qt,Ut,Fe.y),Fe.g=d(st,cr,Fe.g),Fe.p=d(ar,Nr,Fe.p),Fe.b=d(Ht,dn,Fe.b),Fe.T=d(Rt,Lr,Fe.T),Fe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),se(()=>B.value=a()),se(()=>xe.value=u().start),se(()=>Qe.value=u().end),ce})()};wt(["click"]);var KA=H("<div><p>📋 "),QA=H("<div>"),JA=H("<div><div>📊</div><h3></h3><p></p><div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=name></option><option value=sku></option><option value=category>"),XA=H("<div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div>%</div><div></div></div></div><div></div><div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),ZA=H("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),eI=H("<div><div>✅</div><h3></h3><p>"),tI=H("<div><div><h3>📋 </h3><p></p></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div></div><div>"),rI=H("<div><div><div><h2>📋 </h2><button>×"),Dh=H("<option>"),nI=H("<div>..."),iI=H("<tr><td><div></div><div> • </div></td><td><div></div></td><td><div></div></td><td><div></div></td><td><div>"),oI=H("<tr><td><div></div></td><td><div></div><div> • <!> • </div></td><td><div></div></td><td><input type=number placeholder=0 min=0 step=0.01></td><td><div></div></td><td><input type=text>");const sI=t=>{const{t:e}=it(),[r,n]=ye([]),[i,o]=ye(!1),[a,c]=ye(!1),[u,h]=ye("all"),[f,p]=ye("all"),[b,C]=ye("name"),[R,E]=ye([]),[x,T]=ye("setup"),W=async()=>{try{o(!0);const F=await Fn.getProducts("prod");if(!F||typeof F!="object"){console.warn("No API results, using local store"),n(Re.products);return}const N=Object.keys(F),V=z=>{let $=F[z];return{id:z,name:$.name||"Unknown Product",businessId:$.businessId||"",sku:$.code||$.sku||"",UPC:$.UPC||"",numCode:$.codeN||"",category:$.category||"General",unitCost:$.unitCost||0,unitOfMeasure:$.unitOfMeasure||"pcs",minStockLevel:$.minStockLevel||0,maxStockLevel:$.maxStockLevel||100,isActive:$.isActive!==!1,description:$.description||"",createdDate:$.createdAt||new Date().toISOString(),lastModified:$.updatedAt||new Date().toISOString(),sellingPrice:parseFloat($.sellingPrice||$.price||"0")}},fe=N.map(V);n(fe)}catch(F){console.error("Failed to load products from API:",F),n(Re.products)}finally{o(!1)}},te=ze(()=>[...new Set(r().map(N=>N.category).filter(N=>N))].sort()),Q=ze(()=>{let F=r().filter(N=>N.isActive);return f()!=="all"&&(F=F.filter(N=>N.category===f())),F.sort((N,V)=>{switch(b()){case"name":return N.name.localeCompare(V.name);case"sku":return N.sku.localeCompare(V.sku);case"category":return N.category.localeCompare(V.category)||N.name.localeCompare(V.name);default:return 0}}),F}),de=ze(()=>Re.getActiveLocations()),ae=(F,N)=>N&&N!=="all"?Re.getStockByProductAndLocation(F,N)?.quantity||0:Re.getTotalStockByProduct(F),I=()=>{const F=Q().map(N=>{const V=ae(N.id,u()!=="all"?u():void 0);return{productId:N.id,systemQuantity:V,physicalCount:null,notes:"",variance:0,product:N}});E(F),T("counting")},_=(F,N)=>{E(V=>V.map(fe=>{if(fe.productId===F){const z=N,ge=z!==null?z-fe.systemQuantity:0;return{...fe,physicalCount:z,variance:ge}}return fe}))},v=(F,N)=>{E(V=>V.map(fe=>fe.productId===F?{...fe,notes:N}:fe))},P=ze(()=>{const F=R(),N=F.length,V=F.filter($=>$.physicalCount!==null).length,fe=F.filter($=>$.variance!==0).length,z=F.filter($=>$.variance>0).length,ge=F.filter($=>$.variance<0).length;return{totalProducts:N,countedProducts:V,remainingProducts:N-V,variances:fe,positiveVariances:z,negativeVariances:ge,isComplete:V===N}}),w=()=>{const F=R().filter(z=>z.physicalCount!==null&&z.variance!==0);if(F.length===0)return null;const N=[e("inventory.product","Product"),e("inventory.sku","SKU"),e("inventory.category","Category"),e("inventory.location","Location"),e("inventory.systemQty","System Qty"),e("inventory.physicalCount","Physical Count"),e("inventory.variance","Variance"),e("inventory.adjustment","Adjustment"),e("common.notes","Notes"),e("common.date","Date")],V=F.map(z=>[`"${z.product.name}"`,`"${z.product.sku}"`,`"${z.product.category}"`,`"${he()}"`,z.systemQuantity,z.physicalCount,z.variance,z.variance>0?e("inventory.stockIncrease","Stock Increase"):e("inventory.stockDecrease","Stock Decrease"),`"${z.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")}"`,`"${G()}"`]);return[N.join(","),...V.map(z=>z.join(","))].join(`
`)},A=()=>{const F=w();if(!F){alert(e("inventory.noAdjustmentsToDownload","No adjustments to download"));return}const N=new Blob([F],{type:"text/csv;charset=utf-8;"}),V=document.createElement("a");if(V.download!==void 0){const fe=URL.createObjectURL(N);V.setAttribute("href",fe),V.setAttribute("download",`inventory-adjustments-${G().replace(/[/:,\s]/g,"-")}.csv`),V.style.visibility="hidden",document.body.appendChild(V),V.click(),document.body.removeChild(V)}},y=async(F=!0)=>{try{c(!0),console.log(R());const N=O=>{let X=Re.getProductById(O.productId),Y=Re.getStockByProductAndLocation(O.productId,u()),ue=parseFloat(Y?.averageCost+""),re=parseFloat(Y?.quantity+"");return{product:{id:O.productId,label:X?.name,code:X?.code},productId:O?.productId,reason:"Physical Count Adjustment",notes:O?.notes||"Physical inventory adjustment",quantity:O?.variance,unitCost:ue}},V=R().filter(O=>O.physicalCount!==null&&O.variance!==0).map(N);let fe="ADJ_"+js();const z=new Date().toISOString(),ge={ssg_inventory_key:js(),invoiceId:fe,referenceNumber:js(),movementType:"adjustment",type:"adjustment",locationId:u(),items:V,products:V,generalNotes:"Physical inventory adjustment",description:"Physical Count Adjustment",invoice:fe,store:u(),createdBy:"admin",createDate:z};console.log("Saving inventory bulkRequest:",ge);const $=await Fn.addInventory(ge);F&&V.length>0&&A(),console.log("Saving inventory adjustments:",V),await new Promise(O=>setTimeout(O,1e3)),t.onClose()}catch(N){console.error("Failed to save inventory adjustments:",N)}finally{c(!1)}},he=ze(()=>u()==="all"?"All Locations":de().find(N=>N.id===u())?.name||"Unknown Location"),G=()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),k=async()=>{await Re.fecthInventory("prod"),await W()};un(async()=>{t.selectedLocationId&&h(t.selectedLocationId),k()});const Z=()=>{const F=window.open("","_blank");if(!F){alert("Please allow pop-ups to print the counting sheet");return}const N=U();F.document.write(N),F.document.close(),F.onload=()=>{F.print(),F.onafterprint=()=>{F.close()}}},U=()=>{const F=Q().map((N,V)=>{const fe=ae(N.id,u()!=="all"?u():void 0);return`
        <tr>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${V+1}</td>
          <td style="border: 1px solid #000; padding: 8px; font-family: monospace;">${N.sku}</td>
          <td style="border: 1px solid #000; padding: 8px;">
            <div style="font-weight: 500;">${N.name}</div>
            ${N.UPC?`<div style="font-size: 0.8em; color: #666;">UPC: ${N.UPC}</div>`:""}
          </td>
          <td style="border: 1px solid #000; padding: 8px;">${N.category}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${N.unitOfMeasure}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">${fe}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; background-color: #f9f9f9;">________</td>
          <td style="border: 1px solid #000; padding: 8px;">_______________</td>
        </tr>
      `}).join("");return`
      <!DOCTYPE html>
      <html>
      <head>
        <title> ${he()}_${f()}_${e("inventory.countingSheet","Inventory Counting Sheet")} - ${G()}</title>
        <style>
          @page {
            size: letter;
            margin: 0.5in;
          }
          body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            margin: 0;
            padding: 0;
          }
          h1 {
            text-align: center;
            margin: 0 0 10px 0;
            font-size: 24px;
          }
          .header-info {
            text-align: center;
            margin-bottom: 20px;
          }
          .instructions {
            background-color: #f0f0f0;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
          }
          th {
            background-color: #333;
            color: white;
            padding: 8px;
            text-align: left;
            font-weight: bold;
            border: 1px solid #000;
          }
          .summary-table {
            width: 50%;
            margin: 20px auto;
          }
          .signature-section {
            margin-top: 40px;
            display: flex;
            justify-content: space-between;
          }
          .signature-box {
            width: 45%;
            text-align: center;
          }
          .signature-line {
            border-bottom: 1px solid #000;
            margin-bottom: 5px;
            height: 30px;
          }
          @media print {
            tr { page-break-inside: avoid; }
          }
        </style>
      </head>
      <body>
        <h1>${e("inventory.inventoryCountingSheetTitle","INVENTORY COUNTING SHEET")}</h1>
        <div class="header-info">
          <p><strong>${e("inventory.location","Location")}:</strong> ${he()}</p>
          <p><strong>${e("common.category","Category")}:</strong> ${f()==="all"?e("inventory.allCategories","All Categories"):f()}</p>
          <p><strong>${e("common.date","Date")}:</strong> ${G()}</p>
          <p style="margin-top: 10px;">
            <span style="margin-right: 30px;">${e("inventory.countedBy","Counted by")}: _________________________</span>
            <span>${e("inventory.verifiedBy","Verified by")}: _________________________</span>
          </p>
        </div>

        <table>
          <thead>
            <tr>
              <th style="width: 5%; text-align: center;">#</th>
              <th style="width: 12%;">${e("inventory.sku","SKU")}</th>
              <th style="width: 25%;">${e("inventory.productName","Product Name")}</th>
              <th style="width: 12%;">${e("common.category","Category")}</th>
              <th style="width: 8%; text-align: center;">${e("inventory.unit","Unit")}</th>
              <th style="width: 10%; text-align: center;">${e("inventory.systemQty","System Qty")}</th>
              <th style="width: 12%; text-align: center; background-color: #f0f0f0;">${e("inventory.physicalCount","Physical Count")}</th>
              <th style="width: 16%;">${e("common.notes","Notes")}</th>
            </tr>
          </thead>
          <tbody>
            ${F}
          </tbody>
        </table>
        
        <table class="summary-table">
          <tr>
            <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
              ${e("inventory.totalProductsListed","Total Products Listed")}:
            </td>
            <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">
              ${Q().length}
            </td>
          </tr>
          <tr>
            <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
              ${e("inventory.itemsCounted","Items Counted")}:
            </td>
            <td style="border: 1px solid #000; padding: 8px; text-align: center;">
              ___________
            </td>
          </tr>
          <tr>
            <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
              ${e("inventory.discrepanciesFound","Discrepancies Found")}:
            </td>
            <td style="border: 1px solid #000; padding: 8px; text-align: center;">
              ___________
            </td>
          </tr>
        </table>
        
        <div class="signature-section">
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.counterSignature","Counter Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.supervisorSignature","Supervisor Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
        </div>
      </body>
      </html>
    `};return S(Ve,{get when(){return t.isOpen},get children(){var F=rI(),N=F.firstChild,V=N.firstChild,fe=V.firstChild;fe.firstChild;var z=fe.nextSibling;return F.style.setProperty("position","fixed"),F.style.setProperty("top","0"),F.style.setProperty("left","0"),F.style.setProperty("right","0"),F.style.setProperty("bottom","0"),F.style.setProperty("background","rgba(0, 0, 0, 0.5)"),F.style.setProperty("z-index","1000"),F.style.setProperty("display","flex"),F.style.setProperty("align-items","center"),F.style.setProperty("justify-content","center"),N.style.setProperty("background","white"),N.style.setProperty("border-radius","var(--border-radius)"),N.style.setProperty("padding","2rem"),N.style.setProperty("width","95%"),N.style.setProperty("height","95%"),N.style.setProperty("max-width","1400px"),N.style.setProperty("overflow-y","auto"),N.style.setProperty("position","relative"),V.style.setProperty("display","flex"),V.style.setProperty("justify-content","space-between"),V.style.setProperty("align-items","center"),V.style.setProperty("margin-bottom","2rem"),V.style.setProperty("border-bottom","1px solid var(--border-color)"),V.style.setProperty("padding-bottom","1rem"),fe.style.setProperty("margin","0"),fe.style.setProperty("font-size","1.5rem"),s(fe,()=>e("inventory.physicalInventoryCount","Physical Inventory Count"),null),Ci(z,"click",t.onClose,!0),z.style.setProperty("background","none"),z.style.setProperty("border","none"),z.style.setProperty("font-size","1.5rem"),z.style.setProperty("cursor","pointer"),z.style.setProperty("padding","0.5rem"),s(N,S(Ve,{get when(){return x()==="setup"},get children(){var ge=JA(),$=ge.firstChild,O=$.nextSibling,X=O.nextSibling,Y=X.nextSibling,ue=Y.firstChild,re=ue.firstChild,M=re.firstChild,oe=re.nextSibling,pe=oe.firstChild,be=ue.nextSibling,ne=be.firstChild,le=ne.firstChild,j=ne.nextSibling,ce=j.firstChild,D=be.nextSibling,J=D.firstChild,ee=J.firstChild,q=J.nextSibling,B=q.firstChild,_e=B.nextSibling,we=_e.nextSibling;return ge.style.setProperty("text-align","center"),ge.style.setProperty("padding","2rem"),ge.style.setProperty("max-width","600px"),ge.style.setProperty("margin","0 auto"),$.style.setProperty("font-size","3rem"),$.style.setProperty("margin-bottom","1rem"),O.style.setProperty("margin-bottom","1rem"),s(O,()=>e("inventory.setupPhysicalCount","Setup Physical Inventory Count")),X.style.setProperty("margin-bottom","2rem"),X.style.setProperty("color","var(--text-muted)"),s(X,()=>e("inventory.setupDescription","Configure your physical inventory count settings and begin the counting process.")),Y.style.setProperty("display","grid"),Y.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),Y.style.setProperty("gap","1rem"),Y.style.setProperty("margin-bottom","2rem"),Y.style.setProperty("padding","1rem"),Y.style.setProperty("background","var(--surface-color)"),Y.style.setProperty("border-radius","var(--border-radius)"),Y.style.setProperty("text-align","left"),re.style.setProperty("display","block"),re.style.setProperty("margin-bottom","0.5rem"),re.style.setProperty("font-weight","500"),s(re,()=>e("inventory.location","Location"),M),oe.addEventListener("change",ie=>h(ie.target.value)),oe.style.setProperty("width","100%"),oe.style.setProperty("padding","0.5rem"),oe.style.setProperty("border","1px solid var(--border-color)"),oe.style.setProperty("border-radius","var(--border-radius-sm)"),s(pe,()=>e("inventory.allLocations","All Locations")),s(oe,S(Ot,{get each(){return de()},children:ie=>(()=>{var ve=Dh();return s(ve,()=>ie.name),se(()=>ve.value=ie.id),ve})()}),null),ne.style.setProperty("display","block"),ne.style.setProperty("margin-bottom","0.5rem"),ne.style.setProperty("font-weight","500"),s(ne,()=>e("inventory.category","Category"),le),j.addEventListener("change",ie=>p(ie.target.value)),j.style.setProperty("width","100%"),j.style.setProperty("padding","0.5rem"),j.style.setProperty("border","1px solid var(--border-color)"),j.style.setProperty("border-radius","var(--border-radius-sm)"),s(ce,()=>e("products.allCategories","All Categories")),s(j,S(Ot,{get each(){return te()},children:ie=>(()=>{var ve=Dh();return ve.value=ie,s(ve,ie),ve})()}),null),J.style.setProperty("display","block"),J.style.setProperty("margin-bottom","0.5rem"),J.style.setProperty("font-weight","500"),s(J,()=>e("inventory.sortBy","Sort By"),ee),q.addEventListener("change",ie=>C(ie.target.value)),q.style.setProperty("width","100%"),q.style.setProperty("padding","0.5rem"),q.style.setProperty("border","1px solid var(--border-color)"),q.style.setProperty("border-radius","var(--border-radius-sm)"),s(B,()=>e("inventory.productName","Product Name")),s(_e,()=>e("inventory.sku","SKU")),s(we,()=>e("inventory.category","Category")),s(ge,S(Ve,{get when(){return!i()},get fallback(){return(()=>{var ie=nI(),ve=ie.firstChild;return ie.style.setProperty("padding","2rem"),s(ie,()=>e("common.loading","Loading"),ve),ie})()},get children(){return[(()=>{var ie=KA(),ve=ie.firstChild;return ve.firstChild,ie.style.setProperty("padding","1rem"),ie.style.setProperty("background","#fff3cd"),ie.style.setProperty("border-radius","var(--border-radius-sm)"),ie.style.setProperty("margin-bottom","2rem"),ve.style.setProperty("margin","0"),ve.style.setProperty("color","#856404"),s(ve,()=>e("inventory.countWillInclude","This count will include {{count}} products from {{location}} in {{category}} category.",{count:Q().length,location:he(),category:f()==="all"?e("inventory.allCategories","all categories"):f()}),null),ie})(),(()=>{var ie=QA();return ie.style.setProperty("display","grid"),ie.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),ie.style.setProperty("gap","1rem"),ie.style.setProperty("margin-bottom","2rem"),ie.style.setProperty("padding","1rem"),ie.style.setProperty("background","var(--surface-color)"),ie.style.setProperty("border-radius","var(--border-radius)"),s(ie,S(Ve,{get when(){return $t.hasPermission("physicalInventoryCountingForm")},get children(){return S(De,{variant:"primary",size:"large",onClick:I,get disabled(){return i()||Q().length===0},get children(){return["🚀 ",me(()=>e("inventory.startCounting","Start Physical Count"))]}})}}),null),s(ie,S(De,{variant:"primary",onClick:Z,get disabled(){return i()},get children(){return["🖨️ ",me(()=>e("common.print","Print"))]}}),null),ie})()]}}),null),se(()=>oe.value=u()),se(()=>j.value=f()),se(()=>q.value=b()),ge}}),null),s(N,S(Ve,{get when(){return x()==="counting"},get children(){var ge=XA(),$=ge.firstChild,O=$.firstChild,X=O.firstChild,Y=X.nextSibling,ue=O.nextSibling,re=ue.firstChild,M=re.nextSibling,oe=ue.nextSibling,pe=oe.firstChild,be=pe.nextSibling,ne=oe.nextSibling,le=ne.firstChild,j=le.firstChild,ce=le.nextSibling,D=$.nextSibling,J=D.nextSibling,ee=J.firstChild,q=ee.firstChild,B=q.firstChild,_e=B.firstChild,we=_e.nextSibling,ie=we.nextSibling,ve=ie.nextSibling,K=ve.nextSibling,Pe=K.nextSibling,Te=q.nextSibling;return $.style.setProperty("display","grid"),$.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),$.style.setProperty("gap","1rem"),$.style.setProperty("margin-bottom","2rem"),$.style.setProperty("padding","1rem"),$.style.setProperty("background","var(--surface-color)"),$.style.setProperty("border-radius","var(--border-radius)"),O.style.setProperty("text-align","center"),X.style.setProperty("font-size","1.5rem"),X.style.setProperty("font-weight","700"),X.style.setProperty("color","var(--primary-color)"),s(X,()=>P().countedProducts),Y.style.setProperty("font-size","0.875rem"),Y.style.setProperty("color","var(--text-muted)"),s(Y,()=>e("inventory.counted","Counted")),ue.style.setProperty("text-align","center"),re.style.setProperty("font-size","1.5rem"),re.style.setProperty("font-weight","700"),re.style.setProperty("color","#ff9800"),s(re,()=>P().remainingProducts),M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","var(--text-muted)"),s(M,()=>e("inventory.remaining","Remaining")),oe.style.setProperty("text-align","center"),pe.style.setProperty("font-size","1.5rem"),pe.style.setProperty("font-weight","700"),pe.style.setProperty("color","#f44336"),s(pe,()=>P().variances),be.style.setProperty("font-size","0.875rem"),be.style.setProperty("color","var(--text-muted)"),s(be,()=>e("inventory.variances","Variances")),ne.style.setProperty("text-align","center"),le.style.setProperty("font-size","1.5rem"),le.style.setProperty("font-weight","700"),s(le,()=>Math.round(P().countedProducts/P().totalProducts*100),j),ce.style.setProperty("font-size","0.875rem"),ce.style.setProperty("color","var(--text-muted)"),s(ce,()=>e("inventory.complete","Complete")),D.style.setProperty("display","flex"),D.style.setProperty("gap","1rem"),D.style.setProperty("margin-bottom","2rem"),D.style.setProperty("justify-content","center"),s(D,S(De,{variant:"outline",onClick:()=>T("setup"),get children(){return["⬅️ ",me(()=>e("common.back","Back to Setup"))]}}),null),s(D,S(De,{variant:"primary",onClick:()=>T("review"),get children(){return["📋 ",me(()=>e("inventory.reviewAdjustments","Review Adjustments"))]}}),null),J.style.setProperty("border","1px solid var(--border-color)"),J.style.setProperty("border-radius","var(--border-radius)"),J.style.setProperty("overflow-x","auto"),ee.style.setProperty("width","100%"),ee.style.setProperty("border-collapse","collapse"),B.style.setProperty("background","var(--surface-color)"),_e.style.setProperty("padding","1rem"),_e.style.setProperty("text-align","left"),_e.style.setProperty("border-bottom","1px solid var(--border-color)"),s(_e,()=>e("inventory.no","No")),we.style.setProperty("padding","1rem"),we.style.setProperty("text-align","left"),we.style.setProperty("border-bottom","1px solid var(--border-color)"),s(we,()=>e("inventory.product","Product")),ie.style.setProperty("padding","1rem"),ie.style.setProperty("text-align","center"),ie.style.setProperty("border-bottom","1px solid var(--border-color)"),s(ie,()=>e("inventory.systemQty","System Qty")),ve.style.setProperty("padding","1rem"),ve.style.setProperty("text-align","center"),ve.style.setProperty("border-bottom","1px solid var(--border-color)"),s(ve,()=>e("inventory.physicalCount","Physical Count")),K.style.setProperty("padding","1rem"),K.style.setProperty("text-align","center"),K.style.setProperty("border-bottom","1px solid var(--border-color)"),s(K,()=>e("inventory.variance","Variance")),Pe.style.setProperty("padding","1rem"),Pe.style.setProperty("text-align","left"),Pe.style.setProperty("border-bottom","1px solid var(--border-color)"),s(Pe,()=>e("common.notes","Notes")),s(Te,S(Ot,{get each(){return R()},children:(xe,$e)=>S(aI,{get index(){return $e()},updatePhysicalCount:_,entry:xe,updateNotes:v})})),se(xe=>(xe=P().isComplete?"#4caf50":"#ff9800")!=null?le.style.setProperty("color",xe):le.style.removeProperty("color")),ge}}),null),s(N,S(Ve,{get when(){return x()==="review"},get children(){var ge=tI(),$=ge.firstChild,O=$.firstChild;O.firstChild;var X=O.nextSibling,Y=$.nextSibling,ue=Y.firstChild,re=ue.firstChild,M=re.nextSibling,oe=ue.nextSibling,pe=oe.firstChild,be=pe.nextSibling,ne=oe.nextSibling,le=ne.firstChild,j=le.nextSibling,ce=Y.nextSibling;return $.style.setProperty("text-align","center"),$.style.setProperty("margin-bottom","2rem"),O.style.setProperty("margin-bottom","1rem"),s(O,()=>e("inventory.reviewAndConfirm","Review and Confirm Adjustments"),null),X.style.setProperty("color","var(--text-muted)"),s(X,()=>e("inventory.reviewDescription","Review the inventory adjustments below and confirm to update your system.")),Y.style.setProperty("display","grid"),Y.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),Y.style.setProperty("gap","1rem"),Y.style.setProperty("margin-bottom","2rem"),Y.style.setProperty("padding","1rem"),Y.style.setProperty("background","var(--surface-color)"),Y.style.setProperty("border-radius","var(--border-radius)"),ue.style.setProperty("text-align","center"),re.style.setProperty("font-size","1.5rem"),re.style.setProperty("font-weight","700"),re.style.setProperty("color","#4caf50"),s(re,()=>P().positiveVariances),M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","var(--text-muted)"),s(M,()=>e("inventory.stockIncreases","Stock Increases")),oe.style.setProperty("text-align","center"),pe.style.setProperty("font-size","1.5rem"),pe.style.setProperty("font-weight","700"),pe.style.setProperty("color","#f44336"),s(pe,()=>P().negativeVariances),be.style.setProperty("font-size","0.875rem"),be.style.setProperty("color","var(--text-muted)"),s(be,()=>e("inventory.stockDecreases","Stock Decreases")),ne.style.setProperty("text-align","center"),le.style.setProperty("font-size","1.5rem"),le.style.setProperty("font-weight","700"),le.style.setProperty("color","var(--primary-color)"),s(le,()=>P().variances),j.style.setProperty("font-size","0.875rem"),j.style.setProperty("color","var(--text-muted)"),s(j,()=>e("inventory.totalAdjustments","Total Adjustments")),ce.style.setProperty("display","flex"),ce.style.setProperty("gap","1rem"),ce.style.setProperty("margin-bottom","2rem"),ce.style.setProperty("justify-content","center"),ce.style.setProperty("flex-wrap","wrap"),s(ce,S(De,{variant:"outline",onClick:()=>T("counting"),get children(){return["⬅️ ",me(()=>e("common.back","Back to Counting"))]}}),null),s(ce,S(De,{variant:"outline",onClick:A,get disabled(){return P().variances===0},get children(){return["📥 ",me(()=>e("inventory.downloadCSV","Download CSV"))]}}),null),s(ce,S(De,{variant:"primary",onClick:y,get disabled(){return a()||P().variances===0},get children(){return me(()=>!!a())()?"💾 "+e("common.saving","Saving")+"...":"✅ "+e("inventory.confirmAdjustments","Confirm Adjustments")}}),null),s(ge,S(Ve,{get when(){return P().variances>0},get children(){var D=ZA(),J=D.firstChild,ee=J.firstChild,q=ee.firstChild,B=q.firstChild,_e=B.nextSibling,we=_e.nextSibling,ie=we.nextSibling,ve=ie.nextSibling,K=ee.nextSibling;return D.style.setProperty("border","1px solid var(--border-color)"),D.style.setProperty("border-radius","var(--border-radius)"),D.style.setProperty("overflow-x","auto"),J.style.setProperty("width","100%"),J.style.setProperty("border-collapse","collapse"),q.style.setProperty("background","var(--surface-color)"),B.style.setProperty("padding","1rem"),B.style.setProperty("text-align","left"),B.style.setProperty("border-bottom","1px solid var(--border-color)"),s(B,()=>e("inventory.product","Product")),_e.style.setProperty("padding","1rem"),_e.style.setProperty("text-align","center"),_e.style.setProperty("border-bottom","1px solid var(--border-color)"),s(_e,()=>e("inventory.systemQty","System Qty")),we.style.setProperty("padding","1rem"),we.style.setProperty("text-align","center"),we.style.setProperty("border-bottom","1px solid var(--border-color)"),s(we,()=>e("inventory.physicalCount","Physical Count")),ie.style.setProperty("padding","1rem"),ie.style.setProperty("text-align","center"),ie.style.setProperty("border-bottom","1px solid var(--border-color)"),s(ie,()=>e("inventory.adjustment","Adjustment")),ve.style.setProperty("padding","1rem"),ve.style.setProperty("text-align","left"),ve.style.setProperty("border-bottom","1px solid var(--border-color)"),s(ve,()=>e("common.notes","Notes")),s(K,S(Ot,{get each(){return R().filter(Pe=>Pe.variance!==0)},children:Pe=>(()=>{var Te=iI(),xe=Te.firstChild,$e=xe.firstChild,Oe=$e.nextSibling,Qe=Oe.firstChild,Ue=xe.nextSibling,Ie=Ue.firstChild,Me=Ue.nextSibling,qe=Me.firstChild,He=Me.nextSibling,Ge=He.firstChild,Ae=He.nextSibling,ot=Ae.firstChild;return Te.style.setProperty("border-bottom","1px solid var(--border-color)"),xe.style.setProperty("padding","1rem"),$e.style.setProperty("font-weight","500"),s($e,()=>Pe.product.name),Oe.style.setProperty("font-size","0.875rem"),Oe.style.setProperty("color","var(--text-muted)"),s(Oe,()=>Pe.product.sku,Qe),s(Oe,()=>Pe.product.category,null),Ue.style.setProperty("padding","1rem"),Ue.style.setProperty("text-align","center"),Ie.style.setProperty("font-weight","600"),s(Ie,()=>Pe.systemQuantity),Me.style.setProperty("padding","1rem"),Me.style.setProperty("text-align","center"),qe.style.setProperty("font-weight","600"),s(qe,()=>Pe.physicalCount),He.style.setProperty("padding","1rem"),He.style.setProperty("text-align","center"),Ge.style.setProperty("font-weight","700"),s(Ge,()=>Pe.variance>0?"+":"",null),s(Ge,()=>Pe.variance,null),Ae.style.setProperty("padding","1rem"),ot.style.setProperty("font-size","0.875rem"),s(ot,()=>Pe.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")),se(et=>{var pt=Pe.variance>0?"#d4edda":"#f8d7da",yt=Pe.variance>0?"#4caf50":"#f44336";return pt!==et.e&&((et.e=pt)!=null?Te.style.setProperty("background",pt):Te.style.removeProperty("background")),yt!==et.t&&((et.t=yt)!=null?Ge.style.setProperty("color",yt):Ge.style.removeProperty("color")),et},{e:void 0,t:void 0}),Te})()})),D}}),null),s(ge,S(Ve,{get when(){return P().variances===0},get children(){var D=eI(),J=D.firstChild,ee=J.nextSibling,q=ee.nextSibling;return D.style.setProperty("text-align","center"),D.style.setProperty("padding","3rem"),D.style.setProperty("background","var(--surface-color)"),D.style.setProperty("border-radius","var(--border-radius)"),J.style.setProperty("font-size","3rem"),J.style.setProperty("margin-bottom","1rem"),ee.style.setProperty("margin-bottom","0.5rem"),s(ee,()=>e("inventory.perfectCount","Perfect Count!")),q.style.setProperty("color","var(--text-muted)"),s(q,()=>e("inventory.noVariances","No variances found. Your physical count matches the system exactly.")),D}}),null),ge}}),null),F}})},aI=t=>{const{t:e}=it(),[r,n]=ye(""),[i,o]=ye("");let{entry:a,updatePhysicalCount:c,updateNotes:u,index:h}=t;return un(()=>{o(a?.notes),n(a?.physicalCount)}),(()=>{var f=oI(),p=f.firstChild,b=p.firstChild,C=p.nextSibling,R=C.firstChild,E=R.nextSibling,x=E.firstChild,T=x.nextSibling;T.nextSibling;var W=C.nextSibling,te=W.firstChild,Q=W.nextSibling,de=Q.firstChild,ae=Q.nextSibling,I=ae.firstChild,_=ae.nextSibling,v=_.firstChild;return f.style.setProperty("border-bottom","1px solid var(--border-color)"),p.style.setProperty("padding","1rem"),p.style.setProperty("text-align","center"),b.style.setProperty("font-weight","600"),s(b,h+1),C.style.setProperty("padding","1rem"),R.style.setProperty("font-weight","500"),s(R,()=>a?.product.name),E.style.setProperty("font-size","0.875rem"),E.style.setProperty("color","var(--text-muted)"),s(E,()=>a?.product.sku,x),s(E,()=>a?.product.category,T),s(E,()=>a?.product.unitOfMeasure,null),W.style.setProperty("padding","1rem"),W.style.setProperty("text-align","center"),te.style.setProperty("font-weight","600"),s(te,()=>a?.systemQuantity),Q.style.setProperty("padding","1rem"),Q.style.setProperty("text-align","center"),de.addEventListener("blur",()=>{c(a?.productId,r()===""?null:parseFloat(r()))}),de.$$keydown=P=>{P.keyCode===13&&c(a?.productId,r()===""?null:parseFloat(r())),P.keyCode===27&&c(a?.productId,r()===""?null:parseFloat(r())),P.keyCode===9&&c(a?.productId,r()===""?null:parseFloat(r()))},de.$$input=P=>{const w=P.target.value;n(w)},ct(de,"tabindex",h),de.style.setProperty("width","100px"),de.style.setProperty("padding","0.5rem"),de.style.setProperty("border","1px solid var(--border-color)"),de.style.setProperty("border-radius","var(--border-radius-sm)"),de.style.setProperty("text-align","center"),ae.style.setProperty("padding","1rem"),ae.style.setProperty("text-align","center"),I.style.setProperty("font-weight","600"),s(I,()=>a?.variance>0?"+":"",null),s(I,()=>a?.variance||"—",null),_.style.setProperty("padding","1rem"),v.addEventListener("blur",P=>{u(a?.productId,i())}),v.$$keydown=P=>{P.keyCode===13&&u(a?.productId,i()),P.keyCode===27&&u(a?.productId,i()),P.keyCode===9&&u(a?.productId,i())},v.$$input=P=>{const w=P.target.value;o(w)},v.style.setProperty("width","200px"),v.style.setProperty("padding","0.5rem"),v.style.setProperty("border","1px solid var(--border-color)"),v.style.setProperty("border-radius","var(--border-radius-sm)"),se(P=>{var w=a?.physicalCount!==null?a?.variance!==0?"#fff3cd":"#d4edda":"transparent",A=a?.variance>0?"#4caf50":a?.variance<0?"#f44336":"var(--text-muted)",y=e("inventory.addNotes","Add notes...");return w!==P.e&&((P.e=w)!=null?f.style.setProperty("background",w):f.style.removeProperty("background")),A!==P.t&&((P.t=A)!=null?I.style.setProperty("color",A):I.style.removeProperty("color")),y!==P.a&&ct(v,"placeholder",P.a=y),P},{e:void 0,t:void 0,a:void 0}),se(()=>de.value=r()||""),se(()=>v.value=i()||""),f})()};wt(["click","input","keydown"]);function lI(t,e=300,r=!1){let n,i;const o=()=>{n!==void 0&&(clearTimeout(n),n=void 0),i=void 0},a=()=>{n!==void 0&&i!==void 0&&(clearTimeout(n),n=void 0,t(...i),i=void 0)},c=(...u)=>{i=u,n!==void 0&&clearTimeout(n),r&&n===void 0&&t(...u),n=window.setTimeout(()=>{r||t(...u),n=void 0,i=void 0},e)};return ro(()=>{o()}),{debounced:c,cancel:o,flush:a}}function cI(t,e=300){const[r,n]=ye(!1);let i;const o=async h=>{if(i&&i.abort(),!h.trim()){n(!1);return}i=new AbortController,n(!0);try{await t(h)}catch(f){f instanceof Error&&f.name!=="AbortError"&&console.error("Search error:",f)}finally{i.signal.aborted||n(!1)}},{debounced:a,cancel:c}=lI(o,e,!1),u=()=>{c(),i&&i.abort(),n(!1)};return ro(()=>{u()}),{search:a,isSearching:r,cancel:u}}var Nh=H("<div>"),uI=H("<div><h3></h3><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),dI=H("<div><h3></h3><div><div><div><span></span><span></span></div><div><span></span><span></span></div></div><div><div><span></span><span></span></div><div><span></span><span>%"),hI=H("<div><h4>"),mI=H("<div><h3></h3><div><div><div><span></span><span> </span></div><div><span></span><span> </span></div></div><div><div><span></span><span> </span></div><div><span></span><span>"),fI=H("<div><h3></h3><div><span></span><span></span></div><div><span></span><span>"),Lh=H("<div><h3>"),yI=H("<div><div><div><h2></h2><div>SKU: <!> • </div></div><div></div></div><div><button></button><button></button><button></button></div><div>"),gI=H("<span>✓ "),pI=H("<span>✗ "),vI=H("<div><div><span><span> • </span></span><span> </span></div><div>: <!> • <!>: "),bI=H("<div>📦 "),_I=H("<div>Ref: "),SI=H("<div><div><div><span></span><span></span><span></span></div><div><span></span></div></div><div><div> </div><div>"),PI=H("<div><h4></h4><div></div><div>"),wI=H("<div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div> <!> × </div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div>Min: <!> • Max: ");const CI=t=>{const{t:e}=it(),[r,n]=ye("details"),i=ze(()=>{if(!t.product)return null;const v=Re.getTotalStockByProduct(t.product.id),P=Re.getStockByProduct(t.product.id),w=v<=t.product.minStockLevel,A=v===0,y=v>=t.product.maxStockLevel;return{total:v,byLocation:P,status:A?"out":w?"low":y?"over":"good",statusText:A?e("products.outOfStock","Out of Stock"):w?e("products.lowStock","Low Stock"):y?e("products.overStock","Over Stock"):e("products.inStock","In Stock")}}),o=v=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(v),a=v=>new Date(v).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),c=ze(()=>!t.product||t.product.unitCost===0?0:((t.product.sellingPrice-t.product.unitCost)/t.product.unitCost*100).toFixed(2)),u=ze(()=>t.product?Re.movements.filter(v=>v.productId===t.product.id).sort((v,P)=>new Date(P.createdDate).getTime()-new Date(v.createdDate).getTime()):[]),h=ze(()=>{if(!t.product)return null;const v=u(),P=i(),w=new Date;w.setDate(w.getDate()-30);const A=v.filter(he=>new Date(he.createdDate)>=w),y=v.reduce((he,G)=>{const k=G.productId===t.product.id?G:null;return he+(k?k.quantity*k.unitCost:0)},0);return{recentMovements:v.length,movements30Days:A.length,totalValue:(P?.total||0)*t.product.unitCost,averageMovementValue:v.length>0?y/v.length:0,lastMovementDate:v.length>0?v[0].createdDate:null}}),f={"margin-bottom":"2rem"},p={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},b={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},C={"font-weight":"400",color:"var(--text-primary)","font-size":"1rem"},R=v=>({in:"📦",out:"📤",transfer:"🔄",adjustment:"⚖️"})[v]||"📋";function E(v){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[v]||{bg:"#f5f5f5",color:"#666"}}const x=v=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:E(v).bg,color:E(v).color}),T=v=>{const P={good:{background:"#d4edda",color:"#155724"},low:{background:"#fff3cd",color:"#856404"},out:{background:"#f8d7da",color:"#721c24"},over:{background:"#cce5ff",color:"#004085"}};return{display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500",...P[v]||P.good}},W={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"},te={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1rem","margin-bottom":"0.75rem"},Q={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1.5rem","padding-bottom":"1rem","border-bottom":"2px solid var(--border-color)"},de={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},ae=v=>({padding:"0.75rem 1.5rem",background:"none",border:"none","border-bottom":v?"2px solid var(--primary-color)":"2px solid transparent",color:v?"var(--primary-color)":"var(--text-muted)","font-weight":v?"600":"400",cursor:"pointer",transition:"all 0.2s","font-size":"0.875rem"}),I={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-bottom":"0.5rem"},_={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1.5rem","margin-bottom":"1rem"};return S(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("products.productDetails","Product Details")},size:"large",get children(){return S(Ve,{get when(){return t.product},get fallback(){return(()=>{var v=Nh();return v.style.setProperty("text-align","center"),v.style.setProperty("padding","2rem"),v.style.setProperty("color","var(--text-muted)"),s(v,()=>e("products.noProductSelected","No product selected")),v})()},children:v=>(()=>{var P=yI(),w=P.firstChild,A=w.firstChild,y=A.firstChild,he=y.nextSibling,G=he.firstChild,k=G.nextSibling;k.nextSibling;var Z=A.nextSibling,U=w.nextSibling,F=U.firstChild,N=F.nextSibling,V=N.nextSibling,fe=U.nextSibling;return s(P,()=>JSON.stringify(v),w),d(w,Q),y.style.setProperty("margin","0"),y.style.setProperty("font-size","1.5rem"),y.style.setProperty("margin-bottom","0.25rem"),s(y,()=>v().name),he.style.setProperty("color","var(--text-muted)"),s(he,()=>v().sku,k),s(he,()=>v().category,null),s(Z,()=>i()?.statusText),d(U,de),F.$$click=()=>n("details"),s(F,()=>e("products.details","Details")),N.$$click=()=>n("movements"),s(N,()=>e("products.movements","Movements")),V.$$click=()=>n("analytics"),s(V,()=>e("products.analytics","Analytics")),s(P,S(Ve,{get when(){return r()==="details"},get children(){return[(()=>{var z=uI(),ge=z.firstChild,$=ge.nextSibling,O=$.firstChild,X=O.nextSibling,Y=$.nextSibling,ue=Y.firstChild,re=ue.nextSibling,M=Y.nextSibling,oe=M.firstChild,pe=oe.nextSibling;return ge.style.setProperty("margin-bottom","1rem"),ge.style.setProperty("font-size","1.1rem"),s(ge,()=>e("products.basicInformation","Basic Information")),s(O,()=>e("products.description","Description")),s(X,()=>v().description||e("common.notAvailable","N/A")),s(ue,()=>e("products.unitOfMeasure","Unit of Measure")),s(re,()=>v().unitOfMeasure),s(oe,()=>e("products.status","Status")),s(pe,(()=>{var be=me(()=>!!v().isActive);return()=>be()?(()=>{var ne=gI();return ne.firstChild,ne.style.setProperty("color","#2e7d32"),s(ne,()=>e("common.active","Active"),null),ne})():(()=>{var ne=pI();return ne.firstChild,ne.style.setProperty("color","#d32f2f"),s(ne,()=>e("common.inactive","Inactive"),null),ne})()})()),se(be=>{var ne=f,le=p,j=b,ce=C,D=p,J=b,ee=C,q=p,B=b,_e=C;return be.e=d(z,ne,be.e),be.t=d($,le,be.t),be.a=d(O,j,be.a),be.o=d(X,ce,be.o),be.i=d(Y,D,be.i),be.n=d(ue,J,be.n),be.s=d(re,ee,be.s),be.h=d(M,q,be.h),be.r=d(oe,B,be.r),be.d=d(pe,_e,be.d),be},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),z})(),(()=>{var z=dI(),ge=z.firstChild,$=ge.nextSibling,O=$.firstChild,X=O.firstChild,Y=X.firstChild,ue=Y.nextSibling,re=X.nextSibling,M=re.firstChild,oe=M.nextSibling,pe=O.nextSibling,be=pe.firstChild,ne=be.firstChild,le=ne.nextSibling,j=be.nextSibling,ce=j.firstChild,D=ce.nextSibling,J=D.firstChild;return ge.style.setProperty("margin-bottom","1rem"),ge.style.setProperty("font-size","1.1rem"),s(ge,()=>e("products.pricingInformation","Pricing Information")),s(Y,()=>e("products.unitCost","Unit Cost")),s(ue,()=>o(v().unitCost)),s(M,()=>e("products.sellingPrice","Selling Price")),s(oe,()=>o(v().sellingPrice)),s(ne,()=>e("products.profit","Profit")),s(le,()=>o(v().sellingPrice-v().unitCost)),s(ce,()=>e("products.profitMargin","Profit Margin")),s(D,c,J),se(ee=>{var q=f,B=W,_e=p,we=b,ie=C,ve=p,K=b,Pe=C,Te=p,xe=b,$e=C,Oe=p,Qe=b,Ue=C;return ee.e=d(z,q,ee.e),ee.t=d($,B,ee.t),ee.a=d(X,_e,ee.a),ee.o=d(Y,we,ee.o),ee.i=d(ue,ie,ee.i),ee.n=d(re,ve,ee.n),ee.s=d(M,K,ee.s),ee.h=d(oe,Pe,ee.h),ee.r=d(be,Te,ee.r),ee.d=d(ne,xe,ee.d),ee.l=d(le,$e,ee.l),ee.u=d(j,Oe,ee.u),ee.c=d(ce,Qe,ee.c),ee.w=d(D,Ue,ee.w),ee},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),z})(),(()=>{var z=mI(),ge=z.firstChild,$=ge.nextSibling,O=$.firstChild,X=O.firstChild,Y=X.firstChild,ue=Y.nextSibling,re=ue.firstChild,M=X.nextSibling,oe=M.firstChild,pe=oe.nextSibling,be=pe.firstChild,ne=O.nextSibling,le=ne.firstChild,j=le.firstChild,ce=j.nextSibling,D=ce.firstChild,J=le.nextSibling,ee=J.firstChild,q=ee.nextSibling;return ge.style.setProperty("margin-bottom","1rem"),ge.style.setProperty("font-size","1.1rem"),s(ge,()=>e("products.stockInformation","Stock Information")),s(Y,()=>e("products.totalStock","Total Stock")),s(ue,()=>i()?.total||0,re),s(ue,()=>v().unitOfMeasure,null),s(oe,()=>e("products.minStockLevel","Min Stock Level")),s(pe,()=>v().minStockLevel,be),s(pe,()=>v().unitOfMeasure,null),s(j,()=>e("products.maxStockLevel","Max Stock Level")),s(ce,()=>v().maxStockLevel,D),s(ce,()=>v().unitOfMeasure,null),s(ee,()=>e("products.stockValue","Stock Value")),s(q,()=>o((i()?.total||0)*v().unitCost)),s(z,S(Ve,{get when(){return me(()=>!!i()?.byLocation)()&&i().byLocation.length>0},get children(){var B=hI(),_e=B.firstChild;return B.style.setProperty("margin-top","1.5rem"),_e.style.setProperty("margin-bottom","1rem"),_e.style.setProperty("font-size","1rem"),s(_e,()=>e("products.stockByLocation","Stock by Location")),s(B,()=>i().byLocation.map(we=>(()=>{var ie=vI(),ve=ie.firstChild,K=ve.firstChild,Pe=K.firstChild;Pe.firstChild;var Te=K.nextSibling,xe=Te.firstChild,$e=ve.nextSibling,Oe=$e.firstChild,Qe=Oe.nextSibling,Ue=Qe.nextSibling,Ie=Ue.nextSibling;return Ie.nextSibling,d(ie,te),ve.style.setProperty("display","flex"),ve.style.setProperty("justify-content","space-between"),ve.style.setProperty("align-items","center"),K.style.setProperty("font-weight","500"),K.style.setProperty("color","var(--primary-color)"),s(K,()=>we.locationId,Pe),Pe.style.setProperty("font-weight","500"),Pe.style.setProperty("color","var(--text-muted)"),s(Pe,()=>we.locationName,null),Te.style.setProperty("font-weight","600"),s(Te,()=>we.quantity,xe),s(Te,()=>v().unitOfMeasure,null),$e.style.setProperty("margin-top","0.5rem"),$e.style.setProperty("font-size","0.875rem"),$e.style.setProperty("color","var(--text-muted)"),s($e,()=>e("products.available","Available"),Oe),s($e,()=>we.availableQuantity,Qe),s($e,()=>e("products.reserved","Reserved"),Ie),s($e,()=>we.reservedQuantity,null),se(Me=>(Me=we.quantity>0?"var(--primary-color)":"var(--text-muted)")!=null?Te.style.setProperty("color",Me):Te.style.removeProperty("color")),ie})()),null),B}}),null),se(B=>{var _e=f,we=W,ie=p,ve=b,K=C,Pe=p,Te=b,xe=C,$e=p,Oe=b,Qe=C,Ue=p,Ie=b,Me=C;return B.e=d(z,_e,B.e),B.t=d($,we,B.t),B.a=d(X,ie,B.a),B.o=d(Y,ve,B.o),B.i=d(ue,K,B.i),B.n=d(M,Pe,B.n),B.s=d(oe,Te,B.s),B.h=d(pe,xe,B.h),B.r=d(le,$e,B.r),B.d=d(j,Oe,B.d),B.l=d(ce,Qe,B.l),B.u=d(J,Ue,B.u),B.c=d(ee,Ie,B.c),B.w=d(q,Me,B.w),B},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),z})(),(()=>{var z=fI(),ge=z.firstChild,$=ge.nextSibling,O=$.firstChild,X=O.nextSibling,Y=$.nextSibling,ue=Y.firstChild,re=ue.nextSibling;return ge.style.setProperty("margin-bottom","1rem"),ge.style.setProperty("font-size","1.1rem"),s(ge,()=>e("products.timestamps","Timestamps")),s(O,()=>e("common.createdDate","Created Date")),s(X,()=>a(v().createdDate)),s(ue,()=>e("common.lastModified","Last Modified")),s(re,()=>a(v().lastModified)),se(M=>{var oe=f,pe=p,be=b,ne=C,le=p,j=b,ce=C;return M.e=d(z,oe,M.e),M.t=d($,pe,M.t),M.a=d(O,be,M.a),M.o=d(X,ne,M.o),M.i=d(Y,le,M.i),M.n=d(ue,j,M.n),M.s=d(re,ce,M.s),M},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),z})()]}}),fe),s(P,S(Ve,{get when(){return r()==="movements"},get children(){var z=Lh(),ge=z.firstChild;return ge.style.setProperty("margin-bottom","1rem"),ge.style.setProperty("font-size","1.1rem"),s(ge,()=>e("products.recentMovements","Recent Movements")),s(z,S(Ve,{get when(){return u().length>0},get fallback(){return(()=>{var $=bI();return $.firstChild,$.style.setProperty("text-align","center"),$.style.setProperty("padding","2rem"),$.style.setProperty("color","var(--text-muted)"),$.style.setProperty("background","var(--surface-color)"),$.style.setProperty("border-radius","var(--border-radius-sm)"),$.style.setProperty("border","1px solid var(--border-color)"),s($,()=>e("products.noMovements","No movements found for this product"),null),$})()},get children(){return S(Ot,{get each(){return u()},children:$=>{const O=$.productId===v().id?$:null;if(!O)return null;let X=Re.getLocationById($.locationId);return(()=>{var Y=SI(),ue=Y.firstChild,re=ue.firstChild,M=re.firstChild,oe=M.nextSibling,pe=oe.nextSibling,be=re.nextSibling,ne=be.firstChild,le=ue.nextSibling,j=le.firstChild,ce=j.firstChild,D=j.nextSibling;return d(Y,I),re.style.setProperty("font-weight","600"),re.style.setProperty("margin-bottom","0.25rem"),M.style.setProperty("font-size","1.2rem"),s(M,()=>R($.movementType)),oe.style.setProperty("padding","0 6px"),s(pe,()=>$.movementType),be.style.setProperty("font-size","0.875rem"),be.style.setProperty("color","var(--text-muted)"),s(be,()=>` ${a($?.createdDate)} • `,ne),ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("font-weight","600"),ne.style.setProperty("color","var(--primary-color)"),s(ne,()=>$?.locationId),s(be,()=>` • ${X?.name}`,null),s(ue,S(Ve,{get when(){return $.referenceNumber},get children(){var J=_I();return J.firstChild,J.style.setProperty("font-size","0.75rem"),J.style.setProperty("color","var(--text-muted)"),J.style.setProperty("margin-top","0.25rem"),s(J,()=>$?.referenceNumber,null),J}}),null),le.style.setProperty("text-align","right"),j.style.setProperty("font-weight","600"),j.style.setProperty("font-size","1rem"),s(j,()=>$?.movementType==="in"?"+":"",ce),s(j,()=>O.quantity,ce),s(j,()=>v().unitOfMeasure,null),D.style.setProperty("font-size","0.875rem"),D.style.setProperty("color","var(--text-muted)"),s(D,()=>o(O.unitCost)),se(J=>{var ee=x($.movementType),q=$?.movementType==="in"?"#2e7d32":"#d32f2f";return J.e=d(pe,ee,J.e),q!==J.t&&((J.t=q)!=null?j.style.setProperty("color",q):j.style.removeProperty("color")),J},{e:void 0,t:void 0}),Y})()}})}}),null),se($=>d(z,f,$)),z}}),fe),s(P,S(Ve,{get when(){return r()==="analytics"},get children(){var z=Lh(),ge=z.firstChild;return ge.style.setProperty("margin-bottom","1rem"),ge.style.setProperty("font-size","1.1rem"),s(ge,()=>e("products.analytics","Analytics")),s(z,S(Ve,{get when(){return h()},get fallback(){return(()=>{var $=Nh();return $.style.setProperty("text-align","center"),$.style.setProperty("padding","2rem"),$.style.setProperty("color","var(--text-muted)"),s($,()=>e("products.noAnalytics","No analytics data available")),$})()},children:$=>(()=>{var O=wI(),X=O.firstChild,Y=X.firstChild,ue=Y.nextSibling,re=ue.nextSibling,M=X.nextSibling,oe=M.firstChild,pe=oe.nextSibling,be=pe.nextSibling,ne=M.nextSibling,le=ne.firstChild,j=le.nextSibling,ce=j.nextSibling,D=ce.firstChild,J=D.nextSibling;J.nextSibling;var ee=ne.nextSibling,q=ee.firstChild,B=q.nextSibling,_e=B.nextSibling,we=ee.nextSibling,ie=we.firstChild,ve=ie.nextSibling,K=ve.nextSibling,Pe=K.firstChild,Te=Pe.nextSibling;return Te.nextSibling,Y.style.setProperty("margin","0 0 0.5rem 0"),Y.style.setProperty("color","var(--primary-color)"),s(Y,()=>e("products.totalMovements","Total Movements")),ue.style.setProperty("font-size","1.5rem"),ue.style.setProperty("font-weight","600"),s(ue,()=>$().recentMovements),re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),re.style.setProperty("margin-top","0.25rem"),s(re,()=>e("products.allTime","All time")),oe.style.setProperty("margin","0 0 0.5rem 0"),oe.style.setProperty("color","var(--primary-color)"),s(oe,()=>e("products.last30Days","Last 30 Days")),pe.style.setProperty("font-size","1.5rem"),pe.style.setProperty("font-weight","600"),s(pe,()=>$().movements30Days),be.style.setProperty("font-size","0.875rem"),be.style.setProperty("color","var(--text-muted)"),be.style.setProperty("margin-top","0.25rem"),s(be,()=>e("products.movements","movements")),le.style.setProperty("margin","0 0 0.5rem 0"),le.style.setProperty("color","var(--primary-color)"),s(le,()=>e("products.currentValue","Current Stock Value")),j.style.setProperty("font-size","1.5rem"),j.style.setProperty("font-weight","600"),s(j,()=>o($().totalValue)),ce.style.setProperty("font-size","0.875rem"),ce.style.setProperty("color","var(--text-muted)"),ce.style.setProperty("margin-top","0.25rem"),s(ce,()=>i()?.total||0,D),s(ce,()=>v().unitOfMeasure,J),s(ce,()=>o(v().unitCost),null),q.style.setProperty("margin","0 0 0.5rem 0"),q.style.setProperty("color","var(--primary-color)"),s(q,()=>e("products.avgMovementValue","Avg Movement Value")),B.style.setProperty("font-size","1.5rem"),B.style.setProperty("font-weight","600"),s(B,()=>o($().averageMovementValue)),_e.style.setProperty("font-size","0.875rem"),_e.style.setProperty("color","var(--text-muted)"),_e.style.setProperty("margin-top","0.25rem"),s(_e,()=>e("products.perMovement","per movement")),s(O,S(Ve,{get when(){return $().lastMovementDate},get children(){var xe=PI(),$e=xe.firstChild,Oe=$e.nextSibling,Qe=Oe.nextSibling;return $e.style.setProperty("margin","0 0 0.5rem 0"),$e.style.setProperty("color","var(--primary-color)"),s($e,()=>e("products.lastMovement","Last Movement")),Oe.style.setProperty("font-size","1.25rem"),Oe.style.setProperty("font-weight","600"),s(Oe,()=>a($().lastMovementDate)),Qe.style.setProperty("font-size","0.875rem"),Qe.style.setProperty("color","var(--text-muted)"),Qe.style.setProperty("margin-top","0.25rem"),s(Qe,()=>e("products.mostRecent","Most recent activity")),se(Ue=>d(xe,_,Ue)),xe}}),we),ie.style.setProperty("margin","0 0 0.5rem 0"),ie.style.setProperty("color","var(--primary-color)"),s(ie,()=>e("products.stockStatus","Stock Status")),ve.style.setProperty("font-size","1.25rem"),ve.style.setProperty("font-weight","600"),s(ve,()=>i()?.statusText),K.style.setProperty("font-size","0.875rem"),K.style.setProperty("color","var(--text-muted)"),K.style.setProperty("margin-top","0.25rem"),s(K,()=>v().minStockLevel,Te),s(K,()=>v().maxStockLevel,null),se(xe=>{var $e=W,Oe=_,Qe=_,Ue=_,Ie=_,Me=_;return xe.e=d(O,$e,xe.e),xe.t=d(X,Oe,xe.t),xe.a=d(M,Qe,xe.a),xe.o=d(ne,Ue,xe.o),xe.i=d(ee,Ie,xe.i),xe.n=d(we,Me,xe.n),xe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),O})()}),null),se($=>d(z,f,$)),z}}),fe),fe.style.setProperty("display","flex"),fe.style.setProperty("gap","1rem"),fe.style.setProperty("justify-content","flex-end"),fe.style.setProperty("margin-top","2rem"),s(fe,S(De,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close","Close")}}),null),s(fe,S(Ve,{get when(){return t.onEdit},get children(){return S(De,{variant:"primary",get onClick(){return t.onEdit},get children(){return e("common.edit","Edit")}})}}),null),se(z=>{var ge=T(i()?.status||"good"),$=ae(r()==="details"),O=ae(r()==="movements"),X=ae(r()==="analytics");return z.e=d(Z,ge,z.e),z.t=d(F,$,z.t),z.a=d(N,O,z.a),z.o=d(V,X,z.o),z},{e:void 0,t:void 0,a:void 0,o:void 0}),P})()})}})};wt(["click"]);var AI=H("<div>🔄"),II=H("<button type=button>×"),EI=H("<div>⚠️ "),Mh=H("<div>"),xI=H("<div><div><input type=text autocomplete=off>"),TI=H("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>"),$I=H("<span>⚠️ ");const kI=t=>{const{t:e}=it(),[r,n]=ye(""),[i,o]=ye(!1),[a,c]=ye(null),[u,h]=ye([]),[f,p]=ye(!1),[b,C]=ye(-1),[R,E]=ye(null),x=t.searchDelay||300,T=t.maxResults||900,W=async $=>{if(!$.trim()||$.trim().length<3){h([]),t.onSearchResults?.([]);return}try{o(!0),c(null);try{const O=await Fn.getProducts($),X=Object.keys(O),Y=re=>{let M=O;return{id:re,name:M[re].name,businessId:M[re].businessId,sku:M[re].code,UPC:M[re].UPC,numCode:M[re].codeN,category:M[re].category,unitCost:M[re].unitCost||0,unitOfMeasure:M[re].unitOfMeasure,minStockLevel:M[re].minStockLevel,maxStockLevel:M[re].maxStockLevel,isActive:M[re].isActive,description:M[re].description||"",createdDate:M[re].createdAt||new Date().toISOString(),lastModified:M[re].updatedAt||new Date().toISOString()}},ue=X.map(Y);h(ue),Re.updProduct(ue),t.onSearchResults?.(ue)}catch(O){console.warn("API search failed, using local fallback:",O),c("API search failed, showing local results");const X=Re.getActiveProducts().filter(Y=>Y.name.toLowerCase().includes($.toLowerCase())||Y.sku.toLowerCase().includes($.toLowerCase())||Y.category.toLowerCase().includes($.toLowerCase())).slice(0,T);h(X),t.onSearchResults?.(X)}}catch(O){const X=O instanceof Error?O.message:"Search failed";c(X),h([]),t.onSearchResults?.([])}finally{o(!1)}},te=$=>{const X=$.target.value;n(X),c(null),t.showResults!==!1&&p(!0),R()&&clearTimeout(R());const Y=setTimeout(()=>{W(X)},x);E(Y)},Q=$=>{n($.name),p(!1),C(-1),t.onProductSelect?.($)},de=$=>{if(!(!f()||u().length===0))switch($.key){case"ArrowDown":$.preventDefault(),C(O=>Math.min(O+1,u().length-1));break;case"ArrowUp":$.preventDefault(),C(O=>Math.max(O-1,-1));break;case"Enter":$.preventDefault(),b()>=0&&u()[b()]&&Q(u()[b()]);break;case"Escape":p(!1),C(-1);break}},ae=()=>{t.showResults!==!1&&u().length>0&&p(!0)},I=()=>{setTimeout(()=>{p(!1),C(-1)},150)},_=()=>{n(""),h([]),c(null),p(!1),C(-1),t.onSearchResults?.([]),R()&&(clearTimeout(R()),E(null))},v=$=>Re.stockLevels.filter(O=>O.productId===$).reduce((O,X)=>O+X.quantity,0),P=$=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format($),w={position:"relative",width:"100%",...t.style},A={position:"relative",display:"flex","align-items":"center"},y={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},he={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},G={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},k={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},Z=$=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:$?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),U={display:"flex","justify-content":"space-between","align-items":"center"},F={flex:"1"},N={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},V={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},fe={"text-align":"right","font-size":"0.875rem"},z={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},ge={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var $=xI(),O=$.firstChild,X=O.firstChild;return X.addEventListener("blur",I),X.addEventListener("focus",ae),X.$$keydown=de,X.$$input=te,s(O,S(Ve,{get when(){return i()},get children(){var Y=AI();return se(ue=>d(Y,G,ue)),Y}}),null),s(O,S(Ve,{get when(){return me(()=>!!r())()&&!i()},get children(){var Y=II();return Y.addEventListener("mouseleave",ue=>{ue.currentTarget.style.background="none",ue.currentTarget.style.color="var(--text-muted)"}),Y.addEventListener("mouseenter",ue=>{ue.currentTarget.style.background="var(--border-color)",ue.currentTarget.style.color="var(--text-primary)"}),Y.$$click=_,se(ue=>{var re=he,M=e("common.clear","Clear search");return ue.e=d(Y,re,ue.e),M!==ue.t&&ct(Y,"title",ue.t=M),ue},{e:void 0,t:void 0}),Y}}),null),s($,S(Ve,{get when(){return f()&&t.showResults!==!1},get children(){var Y=Mh();return s(Y,S(Ve,{get when(){return a()},get children(){var ue=EI();return ue.firstChild,d(ue,ge),s(ue,a,null),ue}}),null),s(Y,S(Ve,{get when(){return u().length>0},get fallback(){return me(()=>!!(r()&&!i()))()&&(()=>{var ue=Mh();return d(ue,z),s(ue,()=>e("inventory.noProductsFound","No products found matching your search.")),ue})()},get children(){return S(Ot,{get each(){return u()},children:(ue,re)=>{const M=v(ue.id),oe=M<=ue.minStockLevel;return(()=>{var pe=TI(),be=pe.firstChild,ne=be.firstChild,le=ne.firstChild,j=le.nextSibling,ce=j.firstChild,D=ce.firstChild,J=ce.nextSibling,ee=J.nextSibling,q=ee.nextSibling,B=q.nextSibling,_e=ne.nextSibling,we=_e.firstChild,ie=we.firstChild,ve=we.nextSibling;return pe.addEventListener("mouseenter",()=>C(re())),pe.$$click=()=>Q(ue),d(be,U),d(ne,F),d(le,N),s(le,()=>ue.name),d(j,V),s(ce,()=>e("inventory.sku","SKU"),D),s(ce,()=>ue.sku,null),s(ee,()=>ue.category),s(B,()=>P(ue.unitCost)),d(_e,fe),we.style.setProperty("font-weight","600"),(oe?"#f44336":"var(--text-primary)")!=null?we.style.setProperty("color",oe?"#f44336":"var(--text-primary)"):we.style.removeProperty("color"),s(we,M,ie),s(we,()=>ue.unitOfMeasure,null),ve.style.setProperty("color","var(--text-muted)"),s(ve,()=>oe?(()=>{var K=$I();return K.firstChild,K.style.setProperty("color","#f44336"),s(K,()=>e("inventory.lowStock","Low Stock"),null),K})():e("inventory.inStock","In Stock")),se(K=>d(pe,Z(re()===b()),K)),pe})()}})}}),null),se(ue=>d(Y,k,ue)),Y}}),null),se(Y=>{var ue=w,re=A,M=y,oe=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),pe=t.disabled;return Y.e=d($,ue,Y.e),Y.t=d(O,re,Y.t),Y.a=d(X,M,Y.a),oe!==Y.o&&ct(X,"placeholder",Y.o=oe),pe!==Y.i&&(X.disabled=Y.i=pe),Y},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),se(()=>X.value=r()),$})()};wt(["input","keydown","click"]);var RI=H("<div><div><h2></h2><div><div>"),DI=H("<div><span>"),NI=H("<span>🔍 "),LI=H("<div><div><div><div><h3></h3><span></span></div><div></div><div>: </div></div><div><div></div><div> • <!>: </div><div>: "),MI=H("<div><div>:</div><div>"),OI=H("<div>: "),VI=H("<div><div><span>:</span><select><option value=10>10</option><option value=20>20</option><option value=50>50</option><option value=100>100</option></select></div><div><div><span></span><input type=number min=1><span> </span></div></div><div>");const Wy=()=>{const{t}=it(),[e,r]=ye(""),[n,i]=ye(""),[o,a]=ye([]),[c,u]=ye(!1),[h,f]=ye(null),[p,b]=ye(!1),[C,R]=ye(!1),[E,x]=ye(!1),[T,W]=ye(null),[te,Q]=ye(!1),[de,ae]=ye([]),[I,_]=ye(!1),[v,P]=ye(1),[w,A]=ye(20);un(async()=>{await y()});const y=async()=>{try{u(!0),f(null);try{const $=await Hu.getAll();a($.map(O=>({id:O.id||`prod-${Date.now()}-${Math.random()}`,name:O.productName||O.name||"Unknown Product",sku:O.sku||O.productCode||"",description:O.description||"",category:O.category||"General",unitOfMeasure:O.unitOfMeasure||"pcs",unitCost:parseFloat(O.unitCost||O.cost||"0"),sellingPrice:parseFloat(O.sellingPrice||O.price||"0"),minStockLevel:parseInt(O.minStockLevel||"0"),maxStockLevel:parseInt(O.maxStockLevel||"100"),isActive:O.isActive!==!1,createdDate:O.createdDate||new Date().toISOString(),lastModified:O.lastModified||new Date().toISOString(),businessId:O.businessId||"YB100423253156428"})))}catch($){console.warn("API failed, using local store:",$),a(Re.products)}}catch($){f($ instanceof Error?$.message:"Failed to load products")}finally{u(!1)}},he=async()=>{try{u(!0),f(null);try{const $=await Fn.getProducts("prod"),O=Object.keys($),X=ue=>{let M=$[ue];return{id:M.id,name:M.name,businessId:M.businessId,sku:M.code,numCode:M.codeN,category:M.category,unitCost:M.unitCost||0,unitOfMeasure:M.unitOfMeasure,minStockLevel:M.minStockLevel,maxStockLevel:M.maxStockLevel,isActive:M.isActive,description:M.description||"",createdDate:M.createdAt||new Date().toISOString(),lastModified:M.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(M.sellingPrice||M.price||"0")}},Y=O.map(X);a(Y)}catch($){console.warn("API failed, using local store:",$),a(Re.products)}}catch($){f($ instanceof Error?$.message:"Failed to load products")}finally{u(!1)}},{cancel:G}=cI(async $=>{if(!$.trim()){await y();return}try{f(null);const O=await Hu.getAll($);a(O.map(X=>({id:X.id||`prod-${Date.now()}-${Math.random()}`,name:X.productName||X.name||"Unknown Product",sku:X.sku||X.productCode||"",description:X.description||"",category:X.category||"General",unitOfMeasure:X.unitOfMeasure||"pcs",unitCost:parseFloat(X.unitCost||X.cost||"0"),sellingPrice:parseFloat(X.sellingPrice||X.price||"0"),minStockLevel:parseInt(X.minStockLevel||"0"),maxStockLevel:parseInt(X.maxStockLevel||"100"),isActive:X.isActive!==!1,createdDate:X.createdDate||new Date().toISOString(),lastModified:X.lastModified||new Date().toISOString(),businessId:X.businessId||"YB100423253156428"})))}catch(O){f(O instanceof Error?O.message:"Search failed");const X=Re.products.filter(Y=>Y.name.toLowerCase().includes($.toLowerCase())||Y.sku.toLowerCase().includes($.toLowerCase())||Y.category.toLowerCase().includes($.toLowerCase()));a(X)}},300);ro(()=>{G()}),ze(()=>{let $=o();return n()&&($=$.filter(O=>O.category===n())),$}),ze(()=>[...new Set(o().map(O=>O.category))].sort()),ze(()=>{const $=o().filter(Y=>Y.isActive),O=o().length,X=o().filter(Y=>Re.getTotalStockByProduct(Y.id)===0);return{total:O,active:$.length,outOfStock:X.length}});const k=$=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format($),Z={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},U={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},F=$=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:$?"#ffebee":"#e8f5e8",color:$?"#d32f2f":"#2d7d32"});ze(()=>{const $=Re.products||[],O=Re.movements||[],X=Re.stockLevels||[],Y=Re.getLowStockProducts(),ue=$?.length||0,re=$?.filter(pe=>pe.isActive).length,M=X.reduce((pe,be)=>pe*1+be.quantity*1*be.averageCost*1,0),oe=O?.filter(pe=>{const be=new Date(pe.createdDate),ne=new Date;return be.getMonth()===ne.getMonth()&&be.getFullYear()===ne.getFullYear()}).length;return{totalProducts:ue,activeProducts:re,lowStockProducts:Y.length,totalStockValue:M,totalMovementsThisMonth:oe,totalLocations:Re.locations.length,activeLocations:Re.getActiveLocations().length}});const N=ze(()=>Re.products.map($=>{const O=Re.getStockByProduct($.id),X=Re.getTotalStockByProduct($.id),Y=Re.getLastLocationByProduct($.id);return{...$,totalStock:X,stockByLocation:O,lastLocation:Y,isLowStock:X<=$.minStockLevel}})),V=ze(()=>de().map($=>{const O=Re.getStockByProduct($.id),X=Re.getTotalStockByProduct($.id),Y=Re.getLastLocationByProduct($.id);return{...$,totalStock:X,stockByLocation:O,lastLocation:Y,isLowStock:X<=$.minStockLevel}})),fe=ze(()=>{const $=I()?V():N(),O=(v()-1)*w(),X=O+w();return $.slice(O,X)}),z=ze(()=>{const $=I()?V():N();return Math.ceil($.length/w())}),ge=$=>{W($),R(!0)};return S(Ur,{get title(){return t("products.title","Products")},get children(){return[(()=>{var $=RI(),O=$.firstChild,X=O.firstChild,Y=X.nextSibling,ue=Y.firstChild;return $.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","flex-start"),$.style.setProperty("margin-bottom","1.5rem"),$.style.setProperty("flex-wrap","wrap"),$.style.setProperty("gap","1rem"),O.style.setProperty("flex","1"),O.style.setProperty("min-width","300px"),X.style.setProperty("margin","0 0 1rem 0"),X.style.setProperty("font-size","1.5rem"),s(X,()=>t("inventory.products")),Y.style.setProperty("display","flex"),Y.style.setProperty("gap","1rem"),Y.style.setProperty("align-items","center"),Y.style.setProperty("flex-wrap","wrap"),ue.style.setProperty("flex","1"),ue.style.setProperty("min-width","250px"),s(ue,S(kI,{onSearchResults:re=>{ae(re),_(re.length>0)},get placeholder(){return t("inventory.searchProductsStock","Search products and check stock levels...")},showResults:!1,maxResults:20})),s(Y,S(De,{variant:"outline",onClick:()=>{he(),_(!1)},get children(){return["🔄 ",me(()=>t("common.showAll","Show All"))]}}),null),s($,S(Ve,{get when(){return $t.hasPermission("read_write")},get children(){return S(De,{variant:"primary",onClick:()=>Q(!0),get children(){return["➕ ",me(()=>t("inventory.addProduct"))]}})}}),null),$})(),(()=>{var $=DI(),O=$.firstChild;return $.style.setProperty("margin-bottom","1rem"),$.style.setProperty("font-size","0.875rem"),$.style.setProperty("color","var(--text-muted)"),$.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),s(O,(()=>{var X=me(()=>!!I());return()=>X()?`${t("inventory.searchResults","Search Results")}: ${V().length} ${t("common.products","products")}`:`${t("inventory.totalProducts","Total Products")}: ${N().length} ${t("common.products","products")}`})()),s($,(()=>{var X=me(()=>!!I());return()=>X()&&(()=>{var Y=NI();return Y.firstChild,Y.style.setProperty("color","var(--primary-color)"),s(Y,()=>t("inventory.filtered","Filtered view"),null),Y})()})(),null),$})(),S(Ot,{get each(){return fe()},children:$=>(()=>{var O=LI(),X=O.firstChild,Y=X.firstChild,ue=Y.firstChild,re=ue.firstChild,M=re.nextSibling,oe=ue.nextSibling,pe=oe.nextSibling,be=pe.firstChild,ne=Y.nextSibling,le=ne.firstChild,j=le.nextSibling,ce=j.firstChild,D=ce.nextSibling;D.nextSibling;var J=j.nextSibling,ee=J.firstChild;return O.$$click=()=>ge($),O.addEventListener("mouseleave",q=>{q.currentTarget.style.transform="translateY(0)",q.currentTarget.style.boxShadow="none"}),O.addEventListener("mouseenter",q=>{q.currentTarget.style.transform="translateY(-2px)",q.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),d(O,Z),d(X,U),ue.style.setProperty("display","flex"),ue.style.setProperty("align-items","center"),ue.style.setProperty("gap","0.5rem"),ue.style.setProperty("margin-bottom","0.5rem"),re.style.setProperty("margin","0"),re.style.setProperty("font-size","1.1rem"),s(re,()=>$.name),s(M,(()=>{var q=me(()=>!!$.isLowStock);return()=>q()?t("inventory.lowStockAlert"):t("inventory.inStock")})()),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),s(oe,()=>$.sku,null),s(oe,()=>$.UPC?" • "+$.UPC:"",null),s(oe,()=>$.category?" • "+$.category:"",null),pe.style.setProperty("font-size","0.875rem"),pe.style.setProperty("color","var(--text-muted)"),s(pe,()=>t("inventory.lastSeen"),be),s(pe,()=>$.lastLocation?.name||t("inventory.noMovements"),null),ne.style.setProperty("text-align","right"),le.style.setProperty("font-size","1.25rem"),le.style.setProperty("font-weight","700"),le.style.setProperty("color","var(--primary-color)"),s(le,()=>$.totalStock),j.style.setProperty("font-size","0.875rem"),j.style.setProperty("color","var(--text-muted)"),s(j,()=>$.unitOfMeasure,ce),s(j,()=>t("inventory.min"),D),s(j,()=>$.minStockLevel,null),J.style.setProperty("font-size","0.875rem"),J.style.setProperty("color","var(--text-muted)"),s(J,()=>t("inventory.cost"),ee),s(J,()=>k($.unitCost),null),s(O,(()=>{var q=me(()=>$.stockByLocation.length>0);return()=>q()&&(()=>{var B=MI(),_e=B.firstChild,we=_e.firstChild,ie=_e.nextSibling;return B.style.setProperty("margin-top","1rem"),_e.style.setProperty("font-weight","500"),_e.style.setProperty("margin-bottom","0.5rem"),_e.style.setProperty("font-size","0.875rem"),s(_e,()=>t("inventory.stockByLocation"),we),ie.style.setProperty("display","flex"),ie.style.setProperty("flex-wrap","wrap"),ie.style.setProperty("gap","0.5rem"),s(ie,S(Ot,{get each(){return $.stockByLocation},children:ve=>{const K=Re.getLocationById(ve.locationId);return(()=>{var Pe=OI(),Te=Pe.firstChild;return Pe.style.setProperty("padding","0.25rem 0.5rem"),Pe.style.setProperty("background","var(--background-color)"),Pe.style.setProperty("border-radius","var(--border-radius-sm)"),Pe.style.setProperty("font-size","0.75rem"),Pe.style.setProperty("border","1px solid var(--border-color)"),s(Pe,()=>K?.name,Te),s(Pe,()=>ve.quantity,null),Pe})()}})),B})()})(),null),se(q=>d(M,F($.isLowStock),q)),O})()}),me(()=>me(()=>z()>1)()&&(()=>{var $=VI(),O=$.firstChild,X=O.firstChild,Y=X.firstChild,ue=X.nextSibling,re=O.nextSibling,M=re.firstChild,oe=M.firstChild,pe=oe.nextSibling,be=pe.nextSibling,ne=be.firstChild,le=re.nextSibling;return $.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),$.style.setProperty("margin-top","2rem"),$.style.setProperty("padding","1rem"),$.style.setProperty("background","var(--surface-color)"),$.style.setProperty("border-radius","var(--border-radius)"),$.style.setProperty("border","1px solid var(--border-color)"),O.style.setProperty("display","flex"),O.style.setProperty("align-items","center"),O.style.setProperty("gap","0.5rem"),X.style.setProperty("font-size","0.875rem"),X.style.setProperty("color","var(--text-muted)"),s(X,()=>t("common.showPerPage","Show per page"),Y),ue.addEventListener("change",j=>{A(parseInt(j.target.value)),P(1)}),ue.style.setProperty("padding","0.25rem 0.5rem"),ue.style.setProperty("border","1px solid var(--border-color)"),ue.style.setProperty("border-radius","var(--border-radius-sm)"),ue.style.setProperty("background","var(--background-color)"),ue.style.setProperty("cursor","pointer"),re.style.setProperty("display","flex"),re.style.setProperty("align-items","center"),re.style.setProperty("gap","0.5rem"),s(re,S(De,{variant:"outline",size:"sm",onClick:()=>P(1),get disabled(){return v()===1},get children(){return t("common.first","First")}}),M),s(re,S(De,{variant:"outline",size:"sm",onClick:()=>P(j=>Math.max(1,j-1)),get disabled(){return v()===1},get children(){return t("common.previous","Previous")}}),M),M.style.setProperty("display","flex"),M.style.setProperty("align-items","center"),M.style.setProperty("gap","0.25rem"),oe.style.setProperty("font-size","0.875rem"),s(oe,()=>t("common.page","Page")),pe.addEventListener("change",j=>{const ce=parseInt(j.target.value);ce>=1&&ce<=z()&&P(ce)}),pe.style.setProperty("width","60px"),pe.style.setProperty("padding","0.25rem 0.5rem"),pe.style.setProperty("border","1px solid var(--border-color)"),pe.style.setProperty("border-radius","var(--border-radius-sm)"),pe.style.setProperty("text-align","center"),pe.style.setProperty("font-size","0.875rem"),be.style.setProperty("font-size","0.875rem"),s(be,()=>t("common.of","of"),ne),s(be,z,null),s(re,S(De,{variant:"outline",size:"sm",onClick:()=>P(j=>Math.min(z(),j+1)),get disabled(){return v()===z()},get children(){return t("common.next","Next")}}),null),s(re,S(De,{variant:"outline",size:"sm",onClick:()=>P(z()),get disabled(){return v()===z()},get children(){return t("common.last","Last")}}),null),le.style.setProperty("font-size","0.875rem"),le.style.setProperty("color","var(--text-muted)"),s(le,()=>{const j=I()?V():N(),ce=(v()-1)*w()+1,D=Math.min(v()*w(),j.length);return t("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:ce,end:D,total:j.length})}),se(()=>ct(pe,"max",z())),se(()=>ue.value=w()),se(()=>pe.value=v()),$})()),S(hu,{get isOpen(){return p()},onClose:()=>b(!1),onProductAdded:()=>{y()}}),S(CI,{get isOpen(){return C()},onClose:()=>{R(!1),W(null)},get product(){return T()},onEdit:()=>{R(!1),x(!0)}})]}})};wt(["click"]);var BI=H("<div><h1></h1><div><div><span>View:</span><button> 1</button><button> 2"),Ir=H("<div>"),FI=H("<div><h3></h3><div>"),UI=H("<div>: <!> "),jI=H("<div><button></button><button></button><button></button><button>"),zI=H("<div><div>"),qI=H("<div><span> (<!>)</span><span> / <!> "),HI=H("<div><div><h2></h2></div><div>"),WI=H("<div><div><div><span></span><h3></h3></div><div> • </div><div></div></div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div>:"),GI=H("<div><div><div><div></div><div></div></div><div><div> </div><div></div><div>Min: "),YI=H("<span>⚠️ LOW");const KI=()=>{const{t}=it(),[e,r]=ye(!1),[n,i]=ye(!1),[o,a]=ye(!1),[c,u]=ye(null),[h,f]=ye("overview"),[p,b]=ye("new"),[C,R]=ye(""),[E,x]=ye(""),[T,W]=ye([]),[te,Q]=ye(!1),[de,ae]=ye(!1),[I,_]=ye(!1),[v,P]=ye(!1),[w,A]=ye(!1),[y,he]=ye(1),[G,k]=ye(20),Z=D=>{u(D),a(!0)},U=ze(()=>{const D=Re.products||[],J=Re.movements||[],ee=Re.stockLevels||[],q=Re.getLowStockProducts(),B=D?.length||0,_e=D?.filter(ve=>ve.isActive).length,we=ee.reduce((ve,K)=>ve*1+K.quantity*1*K.averageCost*1,0),ie=J?.filter(ve=>{const K=new Date(ve.createdDate),Pe=new Date;return K.getMonth()===Pe.getMonth()&&K.getFullYear()===Pe.getFullYear()}).length;return{totalProducts:B,activeProducts:_e,lowStockProducts:q.length,totalStockValue:we,totalMovementsThisMonth:ie,totalLocations:Re.locations.length,activeLocations:Re.getActiveLocations().length}});ze(()=>Re.products.map(D=>{const J=Re.getStockByProduct(D.id),ee=Re.getTotalStockByProduct(D.id),q=Re.getLastLocationByProduct(D.id);return{...D,totalStock:ee,stockByLocation:J,lastLocation:q,isLowStock:ee<=D.minStockLevel}})),ze(()=>{de(),he(1)});const F=(D,J)=>D<=J?t("inventory.lowStockAlert"):D<=J*2?t("inventory.normalStock"):t("inventory.inStock"),N=D=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(D),V=D=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(D),fe=D=>{switch(D){case"warehouse":return t("inventory.warehouse");case"store":return t("inventory.store");case"supplier":return t("inventory.supplier");case"customer":return t("inventory.customer");default:return D}},z={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},ge={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},$=D=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500",background:D>50?"#d4edda":D>20?"#fff3cd":"#f8d7da",color:D>50?"#155724":D>20?"#856404":"#721c24"}),O={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},X={color:"var(--text-muted)","font-size":"0.875rem"},Y={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},ue={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},re={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},M=D=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:D?"var(--primary-color)":"var(--text-muted)","border-bottom":D?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),oe={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem","margin-bottom":"2rem"},pe={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},be={display:"flex",gap:"0.5rem","align-items":"center","margin-left":"auto","margin-right":"1rem"},ne=D=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:D?"var(--primary-color)":"var(--surface-color)",color:D?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),le=ze(()=>{const D=Re.movements;return{total:D.length,stockIn:D.filter(J=>J.movementType==="in").length,stockOut:D.filter(J=>J.movementType==="out").length,transfers:D.filter(J=>J.movementType==="transfer").length,adjustments:D.filter(J=>J.movementType==="adjustment").length,totalValue:D.reduce((J,ee)=>J+ee.totalCost,0)}}),j=async()=>{let D="prod";await Re.fecthInventory(D),await Re.fecthProduct(D)},ce=async()=>{let D={YY_8802:!0,YY_8803:!0,YY_8804:!0,YY_8805:!0,YY_8816:!0,YY_8818:!0},J=bm($t.state.profile);J.store||(J.store=D),console.log(J)};return un(()=>{j(),ce()}),S(Ur,{get title(){return t("inventory.title")},get children(){return[(()=>{var D=BI(),J=D.firstChild,ee=J.nextSibling,q=ee.firstChild,B=q.firstChild,_e=B.nextSibling,we=_e.firstChild,ie=_e.nextSibling,ve=ie.firstChild;return d(D,ue),J.style.setProperty("margin","0"),J.style.setProperty("font-size","1.75rem"),ee.style.setProperty("display","flex"),ee.style.setProperty("align-items","center"),ee.style.setProperty("gap","1rem"),d(q,be),B.style.setProperty("font-weight","500"),B.style.setProperty("color","var(--text-muted)"),B.style.setProperty("font-size","0.875rem"),_e.$$click=()=>b("new"),s(_e,()=>t("common.view"),we),ie.$$click=()=>b("legacy"),s(ie,()=>t("common.view"),ve),s(ee,(()=>{var K=me(()=>p()==="new");return()=>K()&&S(De,{variant:"outline",onClick:()=>A(!0),get children(){return["🔢 ",me(()=>t("inventory.physicalCount","Physical Count"))]}})})(),null),s(ee,S(Ve,{get when(){return $t.hasPermission("read_write")},get children(){return S(De,{variant:"primary",onClick:()=>i(!0),get children(){return me(()=>p()==="new")()?t("inventory.addMovement"):t("common.add")}})}}),null),se(K=>{var Pe=ne(p()==="new"),Te=ne(p()==="legacy");return K.e=d(_e,Pe,K.e),K.t=d(ie,Te,K.t),K},{e:void 0,t:void 0}),D})(),S(Ve,{get when(){return $t.hasPermission("inventoryDownsection")},get children(){return me(()=>p()==="legacy")()?[(()=>{var D=Ir();return s(D,S(Ke,{get title(){return t("inventory.totalItems")},get subtitle(){return t("inventory.inStock")},get children(){var J=Ir();return J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("color","var(--primary-color)"),s(J,()=>Re.inventory.length),J}}),null),s(D,S(Ke,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.itemsBelowThreshold")},get children(){var J=Ir();return J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("color","var(--primary-color)"),s(J,()=>Re.getLowStockItems().length),J}}),null),s(D,S(Ke,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.inventoryWorth")},get children(){var J=Ir();return J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("color","var(--primary-color)"),s(J,()=>N(Re.getTotalValue())),J}}),null),se(J=>d(D,Y,J)),D})(),(()=>{var D=Ir();return d(D,z),s(D,S(Ot,{get each(){return Re.inventory},children:J=>{const ee=F(J.quantity,J.minStock),q=J.quantity<=J.minStock?8:J.quantity<=J.minStock*2?35:75;return S(Ke,{onClick:()=>Z(J),get children(){return[(()=>{var B=FI(),_e=B.firstChild,we=_e.nextSibling;return d(B,ge),_e.style.setProperty("margin","0"),_e.style.setProperty("font-size","1.1rem"),s(_e,()=>J.name),s(we,ee),se(ie=>d(we,$(q),ie)),B})(),(()=>{var B=Ir();return d(B,O),s(B,()=>N(J.price)),B})(),(()=>{var B=UI(),_e=B.firstChild,we=_e.nextSibling;return we.nextSibling,d(B,X),s(B,()=>t("inventory.quantity"),_e),s(B,()=>J.quantity,we),s(B,()=>t("common.units"),null),B})()]}})}})),D})()]:[(()=>{var D=jI(),J=D.firstChild,ee=J.nextSibling,q=ee.nextSibling,B=q.nextSibling;return d(D,re),J.$$click=()=>f("overview"),s(J,()=>t("inventory.overview")),ee.$$click=()=>f("products"),s(ee,()=>t("inventory.products")),q.$$click=()=>f("movements"),s(q,()=>t("inventory.movements")),B.$$click=()=>f("locations"),s(B,()=>t("inventory.locations")),se(_e=>{var we=M(h()==="overview"),ie=M(h()==="products"),ve=M(h()==="movements"),K=M(h()==="locations");return _e.e=d(J,we,_e.e),_e.t=d(ee,ie,_e.t),_e.a=d(q,ve,_e.a),_e.o=d(B,K,_e.o),_e},{e:void 0,t:void 0,a:void 0,o:void 0}),D})(),me(()=>me(()=>h()==="overview")()&&(()=>{var D=zI(),J=D.firstChild;return s(J,S(Ke,{get title(){return t("inventory.activeProducts")},get subtitle(){return t("inventory.currentlyManaged")},get children(){var ee=Ir();return ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","600"),ee.style.setProperty("color","var(--primary-color)"),s(ee,()=>U().activeProducts),ee}}),null),s(J,S(Ke,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.needAttention")},get children(){var ee=Ir();return ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","600"),ee.style.setProperty("color","#d32f2f"),s(ee,()=>U().lowStockProducts),ee}}),null),s(J,S(Ke,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.currentWorth")},get children(){var ee=Ir();return ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","600"),ee.style.setProperty("color","var(--primary-color)"),s(ee,()=>V(le().totalValue)),ee}}),null),s(J,S(Ke,{get title(){return t("inventory.movements")},get subtitle(){return t("inventory.thisMonth")},get children(){var ee=Ir();return ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","600"),ee.style.setProperty("color","var(--primary-color)"),s(ee,()=>U().totalMovementsThisMonth),ee}}),null),s(J,S(Ke,{get title(){return t("inventory.activeLocations")},get subtitle(){return t("inventory.warehousesStores")},get children(){var ee=Ir();return ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","600"),ee.style.setProperty("color","var(--primary-color)"),s(ee,()=>U().activeLocations),ee}}),null),s(D,(()=>{var ee=me(()=>U().lowStockProducts>0);return()=>ee()&&S(Ke,{get title(){return`⚠️ ${t("inventory.lowStockAlert")}`},get subtitle(){return`${U().lowStockProducts} ${t("inventory.productsNeedRestocking")}`},style:{"margin-bottom":"2rem","border-color":"#ffcdd2",background:"#ffebee"},get children(){var q=Ir();return q.style.setProperty("margin-top","1rem"),s(q,S(Ot,{get each(){return Re.getLowStockProducts().slice(0,9)},children:B=>(()=>{var _e=qI(),we=_e.firstChild,ie=we.firstChild,ve=ie.nextSibling;ve.nextSibling;var K=we.nextSibling,Pe=K.firstChild,Te=Pe.nextSibling;return Te.nextSibling,_e.style.setProperty("display","flex"),_e.style.setProperty("justify-content","space-between"),_e.style.setProperty("margin-bottom","0.5rem"),_e.style.setProperty("font-size","0.875rem"),s(we,()=>B.name,ie),s(we,()=>B?.sku,ve),K.style.setProperty("color","#d32f2f"),K.style.setProperty("font-weight","600"),s(K,()=>B.currentStock,Pe),s(K,()=>B.minStockLevel,Te),s(K,()=>t("inventory.min"),null),_e})()}),null),s(q,(()=>{var B=me(()=>Re.getLowStockProducts().length>5);return()=>B()&&(()=>{var _e=Ir();return _e.style.setProperty("font-size","0.875rem"),_e.style.setProperty("color","var(--text-muted)"),_e.style.setProperty("font-style","italic"),s(_e,()=>t("common.andMore",{count:Re.getLowStockProducts().length-9})),_e})()})(),null),q}})})(),null),se(ee=>d(J,Y,ee)),D})()),me(()=>me(()=>h()==="products")()&&S(Wy,{})),me(()=>me(()=>h()==="movements")()&&S(YA,{})),me(()=>me(()=>h()==="locations")()&&(()=>{var D=HI(),J=D.firstChild,ee=J.firstChild,q=J.nextSibling;return J.style.setProperty("display","flex"),J.style.setProperty("justify-content","space-between"),J.style.setProperty("align-items","center"),J.style.setProperty("margin-bottom","1.5rem"),ee.style.setProperty("margin","0"),ee.style.setProperty("font-size","1.5rem"),s(ee,()=>t("inventory.locations")),s(J,S(Ve,{get when(){return $t.hasPermission("read_write")},get children(){return S(De,{variant:"primary",onClick:()=>_(!0),get children(){return["🏭 ",me(()=>t("inventory.addLocation"))]}})}}),null),d(q,oe),s(q,S(Ot,{get each(){return Re.getActiveLocations()},children:B=>{const _e=Re.getStockByLocation(B.id),we=_e.length,ie=_e.reduce((K,Pe)=>K*1+Pe.quantity*1,0),ve=_e.reduce((K,Pe)=>(Re.getProductById(Pe.productId),K+(Pe?.averageCost||0)),0);return(()=>{var K=WI(),Pe=K.firstChild,Te=Pe.firstChild,xe=Te.firstChild,$e=xe.nextSibling,Oe=Te.nextSibling,Qe=Oe.firstChild,Ue=Oe.nextSibling,Ie=Pe.nextSibling,Me=Ie.firstChild,qe=Me.firstChild,He=qe.firstChild,Ge=qe.nextSibling,Ae=Me.nextSibling,ot=Ae.firstChild,et=ot.firstChild,pt=ot.nextSibling,yt=Ae.nextSibling,xt=yt.firstChild,Yt=xt.firstChild,kt=xt.nextSibling,Qt=Ie.nextSibling,st=Qt.firstChild,ar=st.firstChild;return Pe.style.setProperty("margin-bottom","1rem"),Pe.style.setProperty("padding-bottom","1rem"),Pe.style.setProperty("border-bottom","1px solid var(--border-color)"),Te.style.setProperty("display","flex"),Te.style.setProperty("align-items","center"),Te.style.setProperty("gap","0.5rem"),Te.style.setProperty("margin-bottom","0.5rem"),xe.style.setProperty("font-size","1.2rem"),s(xe,()=>B.type==="warehouse"?"🏭":B.type==="store"?"🏪":B.type==="supplier"?"🚚":"👥"),$e.style.setProperty("margin","0"),$e.style.setProperty("font-size","1.1rem"),s($e,()=>B.name),Oe.style.setProperty("font-size","0.875rem"),Oe.style.setProperty("color","var(--text-muted)"),s(Oe,()=>B.code,Qe),s(Oe,()=>fe(B.type),null),Ue.style.setProperty("font-size","0.75rem"),Ue.style.setProperty("color","var(--text-muted)"),Ue.style.setProperty("margin-top","0.25rem"),s(Ue,()=>B.address),Ie.style.setProperty("margin-bottom","1rem"),Me.style.setProperty("display","flex"),Me.style.setProperty("justify-content","space-between"),Me.style.setProperty("margin-bottom","0.5rem"),qe.style.setProperty("font-size","0.875rem"),qe.style.setProperty("font-weight","500"),s(qe,()=>t("inventory.products"),He),Ge.style.setProperty("font-weight","600"),s(Ge,we),Ae.style.setProperty("display","flex"),Ae.style.setProperty("justify-content","space-between"),Ae.style.setProperty("margin-bottom","0.5rem"),ot.style.setProperty("font-size","0.875rem"),ot.style.setProperty("font-weight","500"),s(ot,()=>t("inventory.totalItems"),et),pt.style.setProperty("font-weight","600"),pt.style.setProperty("color","var(--primary-color)"),s(pt,ie),yt.style.setProperty("display","flex"),yt.style.setProperty("justify-content","space-between"),yt.style.setProperty("margin-bottom","1rem"),xt.style.setProperty("font-size","0.875rem"),xt.style.setProperty("font-weight","500"),s(xt,()=>t("inventory.totalValue"),Yt),kt.style.setProperty("font-weight","600"),kt.style.setProperty("color","var(--primary-color)"),s(kt,()=>V(ve)),st.style.setProperty("font-weight","600"),st.style.setProperty("margin-bottom","0.75rem"),st.style.setProperty("font-size","0.875rem"),st.style.setProperty("color","var(--text-primary)"),st.style.setProperty("border-bottom","1px solid var(--border-color)"),st.style.setProperty("padding-bottom","0.5rem"),s(st,()=>t("inventory.productDetails"),ar),s(Qt,(()=>{var Ht=me(()=>_e.length===0);return()=>Ht()?(()=>{var Rt=Ir();return Rt.style.setProperty("text-align","center"),Rt.style.setProperty("color","var(--text-muted)"),Rt.style.setProperty("font-style","italic"),Rt.style.setProperty("padding","1rem"),s(Rt,()=>t("inventory.noProducts")),Rt})():(()=>{var Rt=Ir();return Rt.style.setProperty("max-height","200px"),Rt.style.setProperty("overflow-y","auto"),Rt.style.setProperty("border","1px solid var(--border-color)"),Rt.style.setProperty("border-radius","var(--border-radius-sm)"),s(Rt,S(Ot,{each:_e,children:Fe=>{const Le=Re.getProductById(Fe.productId);if(!Le)return null;const Ye=Fe.quantity<=Le.minStockLevel,lt=Fe.averageCost;return(()=>{var Tt=GI(),Xe=Tt.firstChild,bt=Xe.firstChild,dt=bt.firstChild,gt=dt.nextSibling,Ct=bt.nextSibling,rr=Ct.firstChild,jt=rr.firstChild,Ft=rr.nextSibling,Wt=Ft.nextSibling;return Wt.firstChild,Tt.style.setProperty("padding","0.75rem"),Tt.style.setProperty("border-bottom","1px solid var(--border-color)"),(Ye?"#fff5f5":"transparent")!=null?Tt.style.setProperty("background",Ye?"#fff5f5":"transparent"):Tt.style.removeProperty("background"),Tt.style.setProperty("transition","background-color 0.2s ease"),Xe.style.setProperty("display","flex"),Xe.style.setProperty("justify-content","space-between"),Xe.style.setProperty("align-items","flex-start"),Xe.style.setProperty("margin-bottom","0.25rem"),bt.style.setProperty("flex","1"),dt.style.setProperty("font-weight","500"),dt.style.setProperty("font-size","0.875rem"),(Ye?"#d32f2f":"var(--text-primary)")!=null?dt.style.setProperty("color",Ye?"#d32f2f":"var(--text-primary)"):dt.style.removeProperty("color"),s(dt,()=>Le.name,null),s(dt,Ye&&(()=>{var _t=YI();return _t.style.setProperty("margin-left","0.5rem"),_t.style.setProperty("font-size","0.7rem"),_t.style.setProperty("color","#d32f2f"),_t})(),null),gt.style.setProperty("font-size","0.75rem"),gt.style.setProperty("color","var(--text-muted)"),gt.style.setProperty("margin-top","0.1rem"),s(gt,()=>Le.sku,null),s(gt,()=>Le.UPC?" • "+Le.UPC:"",null),s(gt,()=>Le.category?" • "+Le.category:"",null),Ct.style.setProperty("text-align","right"),rr.style.setProperty("font-weight","600"),rr.style.setProperty("font-size","0.875rem"),(Ye?"#d32f2f":"var(--primary-color)")!=null?rr.style.setProperty("color",Ye?"#d32f2f":"var(--primary-color)"):rr.style.removeProperty("color"),s(rr,()=>Fe.quantity,jt),s(rr,()=>Le.unitOfMeasure,null),Ft.style.setProperty("font-size","0.75rem"),Ft.style.setProperty("color","var(--text-muted)"),s(Ft,()=>V(lt)),Wt.style.setProperty("font-size","0.7rem"),Wt.style.setProperty("color","var(--text-muted)"),Wt.style.setProperty("margin-top","0.1rem"),s(Wt,()=>Le.minStockLevel,null),Tt})()}})),Rt})()})(),null),se(Ht=>d(K,{...pe,"min-height":"400px"},Ht)),K})()}})),D})())]}}),S(Ve,{get when(){return $t.hasPermission("read_write")},get children(){return[S(cA,{get isOpen(){return e()},onClose:()=>r(!1),get mode(){return p()==="new"?"movement":"legacy"}}),S(gA,{get isOpen(){return n()},onClose:()=>i(!1)}),S(SA,{get isOpen(){return o()},onClose:()=>a(!1),get item(){return c()}}),S(mu,{get isOpen(){return I()},onClose:()=>_(!1),onLocationAdded:()=>{_(!1)}})]}}),S(sI,{get isOpen(){return w()},onClose:()=>A(!1)})]}})};wt(["click"]);const QI=[{id:"1",name:"John Doe",position:"Software Engineer",salary:85e3,email:"john.doe@company.com",phone:"+1 (555) 123-4567",department:"Engineering",startDate:"2023-01-15"},{id:"2",name:"Jane Smith",position:"Product Manager",salary:95e3,email:"jane.smith@company.com",phone:"+1 (555) 234-5678",department:"Product",startDate:"2022-08-20"},{id:"3",name:"Mike Brown",position:"Designer",salary:7e4,email:"mike.brown@company.com",phone:"+1 (555) 345-6789",department:"Design",startDate:"2023-03-10"},{id:"4",name:"Sarah Kim",position:"HR Manager",salary:78e3,email:"sarah.kim@company.com",phone:"+1 (555) 456-7890",department:"Human Resources",startDate:"2022-11-05"},{id:"5",name:"Alex Lee",position:"Data Analyst",salary:72e3,email:"alex.lee@company.com",phone:"+1 (555) 567-8901",department:"Analytics",startDate:"2023-02-28"},{id:"6",name:"Emma Wilson",position:"Marketing Manager",salary:82e3,email:"emma.wilson@company.com",phone:"+1 (555) 678-9012",department:"Marketing",startDate:"2022-09-15"}],[wo,wl]=ye(QI),Gy={get employees(){return wo()},addEmployee(t){const e={...t,id:Date.now().toString()};return wl([...wo(),e]),e},updateEmployee(t,e){wl(wo().map(r=>r.id===t?{...r,...e}:r))},deleteEmployee(t){wl(wo().filter(e=>e.id!==t))},getEmployeeById(t){return wo().find(e=>e.id===t)}};var JI=H("<form><div>");const XI=t=>{const{t:e}=it(),[r,n]=ye({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),i=[{value:"Engineering",label:e("employees.departments.engineering","Engineering")},{value:"Product",label:e("employees.departments.product","Product")},{value:"Design",label:e("employees.departments.design","Design")},{value:"Marketing",label:e("employees.departments.marketing","Marketing")},{value:"Sales",label:e("employees.departments.sales","Sales")},{value:"Human Resources",label:e("employees.departments.humanResources","Human Resources")},{value:"Finance",label:e("employees.departments.finance","Finance")},{value:"Operations",label:e("employees.departments.operations","Operations")},{value:"Analytics",label:e("employees.departments.analytics","Analytics")}],o={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},a=u=>{u.preventDefault();const h=r();if(!h.name||!h.position||!h.salary||!h.email||!h.department||!h.startDate){alert(e("forms.requiredField"));return}const f={name:h.name,position:h.position,salary:parseFloat(h.salary),email:h.email,phone:h.phone,department:h.department,startDate:h.startDate};Gy.addEmployee(f),n({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),t.onClose()},c=(u,h)=>{n(f=>({...f,[u]:h}))};return S(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.addEmployee")},get children(){var u=JI(),h=u.firstChild;return u.addEventListener("submit",a),s(u,S(Pt,{get label(){return e("employees.fullName")},get value(){return r().name},onChange:f=>c("name",f),get placeholder(){return e("employees.enterFullName","Enter employee's full name")},required:!0}),h),s(u,S(Pt,{get label(){return e("employees.position")},get value(){return r().position},onChange:f=>c("position",f),get placeholder(){return e("employees.enterPosition","Enter job position")},required:!0}),h),s(u,S(mr,{get label(){return e("employees.department")},get value(){return r().department},onChange:f=>c("department",f),options:i,required:!0}),h),s(u,S(Pt,{get label(){return e("employees.email")},type:"email",get value(){return r().email},onChange:f=>c("email",f),get placeholder(){return e("employees.enterEmail","Enter email address")},required:!0}),h),s(u,S(Pt,{get label(){return e("employees.phone")},type:"tel",get value(){return r().phone},onChange:f=>c("phone",f),get placeholder(){return e("employees.enterPhone","Enter phone number")}}),h),s(u,S(Pt,{get label(){return e("employees.salary")},type:"number",get value(){return r().salary},onChange:f=>c("salary",f),get placeholder(){return e("employees.enterSalary","Enter annual salary")},required:!0}),h),s(u,S(Pt,{get label(){return e("employees.hireDate")},type:"date",get value(){return r().startDate},onChange:f=>c("startDate",f),required:!0}),h),d(h,o),s(h,S(De,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(h,S(De,{variant:"primary",type:"submit",get children(){return e("employees.addEmployee")}}),null),u}})};var ZI=H("<div><div></div><div></div><div>"),eE=H("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),tE=H("<div>");const rE=t=>{const{t:e}=it(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},i={"font-weight":"600",color:"var(--text-primary)"},o={width:"80px",height:"80px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.5rem",margin:"0 auto 1.5rem auto"},a={"text-align":"center","margin-bottom":"2rem"},c={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},u={color:"var(--text-muted)","font-size":"1rem"},h={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"};if(!t.employee)return null;const f=C=>C.split(" ").map(R=>R[0]).join("").toUpperCase(),p=C=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(C),b=C=>new Date(C).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return S(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.employeeDetails")},get children(){return[(()=>{var C=ZI(),R=C.firstChild,E=R.nextSibling,x=E.nextSibling;return d(C,a),d(R,o),s(R,()=>f(t.employee.name)),d(E,c),s(E,()=>t.employee.name),d(x,u),s(x,()=>t.employee.position),C})(),(()=>{var C=eE(),R=C.firstChild,E=R.firstChild,x=E.nextSibling,T=R.nextSibling,W=T.firstChild,te=W.nextSibling,Q=T.nextSibling,de=Q.firstChild,ae=de.nextSibling,I=Q.nextSibling,_=I.firstChild,v=_.nextSibling,P=I.nextSibling,w=P.firstChild,A=w.nextSibling,y=P.nextSibling,he=y.firstChild,G=he.nextSibling;return s(E,()=>e("employees.employeeId")),s(x,()=>t.employee.id),s(W,()=>e("employees.department")),s(te,()=>t.employee.department),s(de,()=>e("employees.email")),s(ae,()=>t.employee.email),s(_,()=>e("employees.phone")),s(v,()=>t.employee.phone),s(w,()=>e("employees.salary")),s(A,()=>p(t.employee.salary)),s(he,()=>e("employees.hireDate")),s(G,()=>b(t.employee.startDate)),se(k=>{var Z=r,U=n,F=i,N=r,V=n,fe=i,z=r,ge=n,$=i,O=r,X=n,Y=i,ue=r,re=n,M=i,oe=r,pe=n,be=i;return k.e=d(R,Z,k.e),k.t=d(E,U,k.t),k.a=d(x,F,k.a),k.o=d(T,N,k.o),k.i=d(W,V,k.i),k.n=d(te,fe,k.n),k.s=d(Q,z,k.s),k.h=d(de,ge,k.h),k.r=d(ae,$,k.r),k.d=d(I,O,k.d),k.l=d(_,X,k.l),k.u=d(v,Y,k.u),k.c=d(P,ue,k.c),k.w=d(w,re,k.w),k.m=d(A,M,k.m),k.f=d(y,oe,k.f),k.y=d(he,pe,k.y),k.g=d(G,be,k.g),k},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),C})(),(()=>{var C=tE();return d(C,h),s(C,S(De,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(C,S(De,{variant:"primary",onClick:()=>{console.log("Edit employee:",t.employee.id)},get children(){return e("employees.editEmployee")}}),null),C})()]}})};var Oh=H("<div>"),nE=H("<div><div></div><div><div></div><div></div><div>/year");const iE=()=>{const{t}=it(),[e,r]=ye(!1),[n,i]=ye(!1),[o,a]=ye(null),c=E=>{a(E),i(!0)},u={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},h={display:"flex","align-items":"center",gap:"1rem"},f={width:"60px",height:"60px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.2rem"},p={flex:"1"},b={"font-weight":"600","margin-bottom":"0.25rem"},C={color:"var(--text-muted)","font-size":"0.875rem","margin-bottom":"0.5rem"},R={color:"var(--primary-color)","font-weight":"500"};return S(Ur,{get title(){return t("employees.title")},get children(){return[(()=>{var E=Oh();return E.style.setProperty("margin-bottom","2rem"),s(E,S(De,{variant:"primary",onClick:()=>r(!0),get children(){return t("employees.addEmployee")}})),E})(),(()=>{var E=Oh();return d(E,u),s(E,()=>Gy.employees.map(x=>{const T=te=>te.split(" ").map(Q=>Q[0]).join("").toUpperCase(),W=te=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(te);return S(Ke,{onClick:()=>c(x),get children(){var te=nE(),Q=te.firstChild,de=Q.nextSibling,ae=de.firstChild,I=ae.nextSibling,_=I.nextSibling,v=_.firstChild;return d(te,h),d(Q,f),s(Q,()=>T(x.name)),d(de,p),d(ae,b),s(ae,()=>x.name),d(I,C),s(I,()=>x.position),d(_,R),s(_,()=>W(x.salary),v),te}})})),E})(),S(XI,{get isOpen(){return e()},onClose:()=>r(!1)}),S(rE,{get isOpen(){return n()},onClose:()=>i(!1),get employee(){return o()}})]}})},oE=[{id:"1",accountId:"1002",bankName:"First National Bank",accountNumber:"****1234",accountType:"checking",currency:"USD",currentBalance:32730.5,lastReconciledDate:"2024-01-01",lastReconciledBalance:3e4,isActive:!0},{id:"2",accountId:"1003",bankName:"First National Bank",accountNumber:"****5678",accountType:"savings",currency:"USD",currentBalance:12e3,lastReconciledDate:"2024-01-01",lastReconciledBalance:1e4,isActive:!0}],sE=[{id:"1",accountId:"1002",date:"2024-01-15",description:"Customer Payment - ABC Corp",reference:"CHK001234",debitAmount:5e3,creditAmount:0,balance:35730.5,category:"Customer Payment",isReconciled:!0,reconciledWith:"eb1",importedAt:"2024-01-16",source:"csv_import"},{id:"2",accountId:"1002",date:"2024-01-14",description:"Office Supplies - Staples",reference:"CHK001235",debitAmount:0,creditAmount:250,balance:30730.5,category:"Office Expenses",isReconciled:!0,reconciledWith:"eb2",importedAt:"2024-01-16",source:"csv_import"},{id:"3",accountId:"1002",date:"2024-01-13",description:"Monthly Rent Payment",reference:"CHK001236",debitAmount:0,creditAmount:2e3,balance:28730.5,category:"Rent",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"},{id:"4",accountId:"1002",date:"2024-01-12",description:"Wire Transfer In",reference:"WIRE001",debitAmount:1e4,creditAmount:0,balance:38730.5,category:"Wire Transfer",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"}],aE=[{id:"eb1",accountId:"1002",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",debitAmount:5e3,creditAmount:0,category:"Accounts Receivable",isReconciled:!0,reconciledWith:"1",createdAt:"2024-01-15"},{id:"eb2",accountId:"1002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",debitAmount:0,creditAmount:250,category:"Office Expenses",isReconciled:!0,reconciledWith:"2",createdAt:"2024-01-14"},{id:"eb3",accountId:"1002",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",debitAmount:0,creditAmount:3500,category:"Salary Expense",isReconciled:!1,createdAt:"2024-01-11"}],lE=[{id:"1",bankAccountId:"1",periodStart:"2024-01-01",periodEnd:"2024-01-15",startingBalance:3e4,endingBalance:35730.5,status:"in_progress",totalBankTransactions:4,totalEntryBookRecords:3,reconciledTransactions:2,unreconciledTransactions:2,discrepancyAmount:1500,createdAt:"2024-01-16",notes:"Wire transfer and rent payment need investigation"}],[Os,Vh]=ye(oE),[Nn,Cl]=ye(sE),[Co,Bh]=ye(aE),[Vs,Fh]=ye(lE),nr={get bankAccounts(){return Os()},addBankAccount(t){const e={...t,id:Date.now().toString()};return Vh([...Os(),e]),e},updateBankAccount(t,e){Vh(Os().map(r=>r.id===t?{...r,...e}:r))},getBankAccountById(t){return Os().find(e=>e.id===t)},get bankStatements(){return Nn()},addBankStatement(t){const e={...t,id:Date.now().toString(),importedAt:new Date().toISOString()};return Cl([...Nn(),e]),e},addBankStatementsFromCSV(t){const e=t.map(r=>({...r,id:`csv_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,importedAt:new Date().toISOString(),source:"csv_import",isReconciled:!1}));return Cl([...Nn(),...e]),e},updateBankStatement(t,e){Cl(Nn().map(r=>r.id===t?{...r,...e}:r))},getBankStatementsByAccount(t){return Nn().filter(e=>e.accountId===t)},getUnreconciledBankStatements(t){return(t?this.getBankStatementsByAccount(t):Nn()).filter(r=>!r.isReconciled)},get entryBookRecords(){return Co()},addEntryBookRecord(t){const e={...t,id:Date.now().toString(),createdAt:new Date().toISOString()};return Bh([...Co(),e]),e},updateEntryBookRecord(t,e){Bh(Co().map(r=>r.id===t?{...r,...e}:r))},getEntryBookRecordsByAccount(t){return Co().filter(e=>e.accountId===t)},getUnreconciledEntryBookRecords(t){return(t?this.getEntryBookRecordsByAccount(t):Co()).filter(r=>!r.isReconciled)},reconcileTransaction(t,e){this.updateBankStatement(t,{isReconciled:!0,reconciledWith:e}),this.updateEntryBookRecord(e,{isReconciled:!0,reconciledWith:t})},unreconciledTransaction(t){const e=Nn().find(r=>r.id===t);e?.reconciledWith&&this.updateEntryBookRecord(e.reconciledWith,{isReconciled:!1,reconciledWith:void 0}),this.updateBankStatement(t,{isReconciled:!1,reconciledWith:void 0})},findPotentialMatches(t){const e=Nn().find(n=>n.id===t);return e?this.getUnreconciledEntryBookRecords(e.accountId).filter(n=>{const i=Math.abs(e.debitAmount-n.debitAmount)<.01||Math.abs(e.creditAmount-n.creditAmount)<.01,o=new Date(e.date),a=new Date(n.date),u=Math.abs((o.getTime()-a.getTime())/(1e3*60*60*24))<=3,h=e.reference===n.reference||e.description.toLowerCase().includes(n.description.toLowerCase())||n.description.toLowerCase().includes(e.description.toLowerCase());return i&&(u||h)}).sort((n,i)=>{const o=(n.date===e.date?2:0)+(n.reference===e.reference?1:0);return(i.date===e.date?2:0)+(i.reference===e.reference?1:0)-o}):[]},get reconciliationSessions(){return Vs()},startReconciliationSession(t,e,r){const n=this.getBankStatementsByAccount(t).filter(h=>h.date>=e&&h.date<=r),i=this.getEntryBookRecordsByAccount(t).filter(h=>h.date>=e&&h.date<=r),o=n.filter(h=>h.isReconciled).length,a=this.getBankAccountById(t)?.lastReconciledBalance||0,c=this.getBankAccountById(t)?.currentBalance||0,u={id:Date.now().toString(),bankAccountId:t,periodStart:e,periodEnd:r,startingBalance:a,endingBalance:c,status:"in_progress",totalBankTransactions:n.length,totalEntryBookRecords:i.length,reconciledTransactions:o,unreconciledTransactions:n.length-o,discrepancyAmount:0,createdAt:new Date().toISOString()};return Fh([...Vs(),u]),u},updateReconciliationSession(t,e){Fh(Vs().map(r=>r.id===t?{...r,...e}:r))},getReconciliationSessionsByAccount(t){return Vs().filter(e=>e.bankAccountId===t)}};var Al=H("<div>"),cE=H("<div><strong>:</strong> <!> - "),uE=H("<div><div><div>📄</div><div></div><div></div></div><input id=csvFileInput type=file accept=.csv>"),dE=H("<div><h4></h4><div><div><label> *</label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><select><option value>"),Vi=H("<option>"),hE=H("<div><table><thead><tr></tr></thead><tbody>"),mE=H("<th>"),fE=H("<tr>"),yE=H("<td>");const gE=t=>{const{t:e}=it(),[r,n]=ye(!1),[i,o]=ye(!1),[a,c]=ye(null),[u,h]=ye([]),[f,p]=ye({date:"",description:"",reference:"",debit:"",credit:"",balance:""}),b={border:`2px dashed ${r()?"var(--primary-color)":"var(--border-color)"}`,"border-radius":"var(--border-radius)",padding:"2rem","text-align":"center","background-color":r()?"var(--background-color)":"transparent",transition:"all 0.2s ease",cursor:"pointer"},C={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem","margin-top":"1.5rem"},R={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-family":"inherit"},E={"max-height":"200px","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},x={width:"100%","border-collapse":"collapse","font-size":"0.875rem"},T={padding:"0.5rem","border-bottom":"1px solid var(--border-color)","text-align":"left"},W={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},te=A=>{A.preventDefault(),n(!0)},Q=A=>{A.preventDefault(),n(!1)},de=A=>{A.preventDefault(),n(!1);const y=A.dataTransfer?.files;y&&y.length>0&&I(y[0])},ae=A=>{const y=A.target;y.files&&y.files.length>0&&I(y.files[0])},I=A=>{if(!A.name.toLowerCase().endsWith(".csv")){c({success:!1,message:e("banking.pleaseUploadCSV")});return}o(!0);const y=new FileReader;y.onload=he=>{try{const k=(he.target?.result).split(`
`).filter(N=>N.trim());if(k.length<2){c({success:!1,message:e("banking.csvRequiresHeaderAndData")}),o(!1);return}const Z=k[0].split(",").map(N=>N.trim().replace(/[\"\']/g,"")),U=k.slice(1).map(N=>{const V=N.split(",").map(z=>z.trim().replace(/[\"\']/g,"")),fe={};return Z.forEach((z,ge)=>{fe[z]=V[ge]||""}),fe});h(U),c({success:!0,message:e("banking.successfullyParsed").replace("{count}",U.length.toString()),count:U.length});const F={...f()};Z.forEach(N=>{const V=N.toLowerCase();V.includes("date")&&(F.date=N),(V.includes("description")||V.includes("memo"))&&(F.description=N),(V.includes("reference")||V.includes("check")||V.includes("ref"))&&(F.reference=N),(V.includes("debit")||V.includes("deposit"))&&(F.debit=N),(V.includes("credit")||V.includes("withdrawal")||V.includes("amount"))&&(F.debit?F.credit=N:F.debit=N),V.includes("balance")&&(F.balance=N)}),p(F)}catch{c({success:!1,message:e("banking.errorParsingCSV")})}o(!1)},y.readAsText(A)},_=(A,y)=>{p(he=>({...he,[A]:y}))},v=()=>u().length===0?[]:Object.keys(u()[0]),P=()=>{if(!t.bankAccount||u().length===0)return;const A=f();if(!A.date||!A.description){c({success:!1,message:e("banking.dateDescriptionRequired")});return}o(!0);try{const y=u().map(G=>{const k=N=>N&&parseFloat(N.replace(/[^0-9.-]/g,""))||0,Z=N=>{const V=new Date(N);if(isNaN(V.getTime())){const fe=N.split("/");if(fe.length===3)return new Date(parseInt(fe[2]),parseInt(fe[0])-1,parseInt(fe[1])).toISOString().split("T")[0]}return V.toISOString().split("T")[0]};let U=0,F=0;if(A.debit&&A.credit)U=k(G[A.debit]),F=k(G[A.credit]);else if(A.debit){const N=k(G[A.debit]);N>0?U=N:F=Math.abs(N)}return{accountId:t.bankAccount.accountId,date:Z(G[A.date]),description:G[A.description]||e("banking.importedTransaction"),reference:G[A.reference]||"",debitAmount:U,creditAmount:F,balance:A.balance?k(G[A.balance]):0,isReconciled:!1}}),he=nr.addBankStatementsFromCSV(y);c({success:!0,message:e("banking.successfullyImported").replace("{count}",he.length.toString()),count:he.length}),h([]),p({date:"",description:"",reference:"",debit:"",credit:"",balance:""})}catch{c({success:!1,message:e("banking.errorImportingTransactions")})}o(!1)},w=()=>{h([]),c(null),p({date:"",description:"",reference:"",debit:"",credit:"",balance:""})};return S(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("banking.importBankStatementCSV")},get children(){return[me(()=>me(()=>!!t.bankAccount)()&&(()=>{var A=cE(),y=A.firstChild,he=y.firstChild,G=y.nextSibling,k=G.nextSibling;return k.nextSibling,A.style.setProperty("margin-bottom","1.5rem"),A.style.setProperty("padding","1rem"),A.style.setProperty("background","var(--background-color)"),A.style.setProperty("border-radius","var(--border-radius-sm)"),A.style.setProperty("border","1px solid var(--border-color)"),s(y,()=>e("banking.bankAccount"),he),s(A,()=>t.bankAccount.bankName,k),s(A,()=>t.bankAccount.accountNumber,null),A})()),me(()=>me(()=>u().length===0)()?(()=>{var A=uE(),y=A.firstChild,he=y.firstChild,G=he.nextSibling,k=G.nextSibling,Z=y.nextSibling;return y.$$click=()=>document.getElementById("csvFileInput")?.click(),y.addEventListener("drop",de),y.addEventListener("dragleave",Q),y.addEventListener("dragover",te),he.style.setProperty("font-size","2rem"),he.style.setProperty("margin-bottom","1rem"),G.style.setProperty("font-weight","500"),G.style.setProperty("margin-bottom","0.5rem"),s(G,(()=>{var U=me(()=>!!r());return()=>U()?e("banking.dropCSVHere"):e("banking.clickToUploadCSV")})()),k.style.setProperty("font-size","0.875rem"),k.style.setProperty("color","var(--text-muted)"),s(k,()=>e("banking.supportedFormat")),Z.addEventListener("change",ae),Z.style.setProperty("display","none"),se(U=>d(y,b,U)),A})():(()=>{var A=dE(),y=A.firstChild,he=y.nextSibling,G=he.firstChild,k=G.firstChild,Z=k.firstChild,U=k.nextSibling,F=U.firstChild,N=G.nextSibling,V=N.firstChild,fe=V.firstChild,z=V.nextSibling,ge=z.firstChild,$=N.nextSibling,O=$.firstChild,X=O.nextSibling,Y=X.firstChild,ue=$.nextSibling,re=ue.firstChild,M=re.firstChild,oe=re.nextSibling,pe=oe.firstChild,be=ue.nextSibling,ne=be.firstChild,le=ne.nextSibling,j=le.firstChild,ce=be.nextSibling,D=ce.firstChild,J=D.nextSibling,ee=J.firstChild;return y.style.setProperty("margin","0 0 1rem 0"),s(y,()=>e("banking.mapCSVColumns")),d(he,C),k.style.setProperty("display","block"),k.style.setProperty("margin-bottom","0.5rem"),k.style.setProperty("font-weight","500"),s(k,()=>e("banking.dateColumn"),Z),U.addEventListener("change",q=>_("date",q.target.value)),s(F,()=>e("banking.selectColumn")),s(U,()=>v().map(q=>(()=>{var B=Vi();return B.value=q,s(B,q),B})()),null),V.style.setProperty("display","block"),V.style.setProperty("margin-bottom","0.5rem"),V.style.setProperty("font-weight","500"),s(V,()=>e("banking.descriptionColumn"),fe),z.addEventListener("change",q=>_("description",q.target.value)),s(ge,()=>e("banking.selectColumn")),s(z,()=>v().map(q=>(()=>{var B=Vi();return B.value=q,s(B,q),B})()),null),O.style.setProperty("display","block"),O.style.setProperty("margin-bottom","0.5rem"),O.style.setProperty("font-weight","500"),s(O,()=>e("banking.referenceColumn")),X.addEventListener("change",q=>_("reference",q.target.value)),s(Y,()=>e("banking.selectColumn")),s(X,()=>v().map(q=>(()=>{var B=Vi();return B.value=q,s(B,q),B})()),null),re.style.setProperty("display","block"),re.style.setProperty("margin-bottom","0.5rem"),re.style.setProperty("font-weight","500"),s(re,()=>e("banking.amountDebitColumn"),M),oe.addEventListener("change",q=>_("debit",q.target.value)),s(pe,()=>e("banking.selectColumn")),s(oe,()=>v().map(q=>(()=>{var B=Vi();return B.value=q,s(B,q),B})()),null),ne.style.setProperty("display","block"),ne.style.setProperty("margin-bottom","0.5rem"),ne.style.setProperty("font-weight","500"),s(ne,()=>e("banking.creditColumn")),le.addEventListener("change",q=>_("credit",q.target.value)),s(j,()=>e("banking.selectColumn")),s(le,()=>v().map(q=>(()=>{var B=Vi();return B.value=q,s(B,q),B})()),null),D.style.setProperty("display","block"),D.style.setProperty("margin-bottom","0.5rem"),D.style.setProperty("font-weight","500"),s(D,()=>e("banking.balanceColumn")),J.addEventListener("change",q=>_("balance",q.target.value)),s(ee,()=>e("banking.selectColumn")),s(J,()=>v().map(q=>(()=>{var B=Vi();return B.value=q,s(B,q),B})()),null),s(A,(()=>{var q=me(()=>u().length>0);return()=>q()&&(()=>{var B=hE(),_e=B.firstChild,we=_e.firstChild,ie=we.firstChild,ve=we.nextSibling;return d(B,E),ie.style.setProperty("background-color","var(--background-color)"),s(ie,()=>v().slice(0,6).map(K=>(()=>{var Pe=mE();return s(Pe,K),se(Te=>d(Pe,T,Te)),Pe})())),s(ve,()=>u().slice(0,3).map(K=>(()=>{var Pe=fE();return s(Pe,()=>v().slice(0,6).map(Te=>(()=>{var xe=yE();return s(xe,()=>K[Te]),se($e=>d(xe,T,$e)),xe})())),Pe})())),s(B,(()=>{var K=me(()=>u().length>3);return()=>K()&&(()=>{var Pe=Al();return Pe.style.setProperty("padding","0.5rem"),Pe.style.setProperty("text-align","center"),Pe.style.setProperty("color","var(--text-muted)"),s(Pe,()=>e("banking.andMoreRows").replace("{count}",(u().length-3).toString())),Pe})()})(),null),se(K=>d(_e,x,K)),B})()})(),null),se(q=>{var B=R,_e=R,we=R,ie=R,ve=R,K=R;return q.e=d(U,B,q.e),q.t=d(z,_e,q.t),q.a=d(X,we,q.a),q.o=d(oe,ie,q.o),q.i=d(le,ve,q.i),q.n=d(J,K,q.n),q},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),se(()=>U.value=f().date),se(()=>z.value=f().description),se(()=>X.value=f().reference),se(()=>oe.value=f().debit),se(()=>le.value=f().credit),se(()=>J.value=f().balance),A})()),me(()=>me(()=>!!a())()&&(()=>{var A=Al();return A.style.setProperty("padding","1rem"),A.style.setProperty("border-radius","var(--border-radius-sm)"),A.style.setProperty("margin-top","1rem"),s(A,()=>a().message),se(y=>{var he=a().success?"#d4edda":"#f8d7da",G=a().success?"#155724":"#721c24",k=`1px solid ${a().success?"#c3e6cb":"#f5c6cb"}`;return he!==y.e&&((y.e=he)!=null?A.style.setProperty("background",he):A.style.removeProperty("background")),G!==y.t&&((y.t=G)!=null?A.style.setProperty("color",G):A.style.removeProperty("color")),k!==y.a&&((y.a=k)!=null?A.style.setProperty("border",k):A.style.removeProperty("border")),y},{e:void 0,t:void 0,a:void 0}),A})()),(()=>{var A=Al();return d(A,W),s(A,S(De,{variant:"secondary",onClick:()=>{w(),t.onClose()},get children(){return e("common.cancel")}}),null),s(A,(()=>{var y=me(()=>u().length>0);return()=>y()&&S(De,{variant:"outline",onClick:w,get children(){return e("common.reset")}})})(),null),s(A,(()=>{var y=me(()=>u().length>0);return()=>y()&&S(De,{variant:"primary",onClick:P,get disabled(){return i()||!f().date||!f().description},get children(){return me(()=>!!i())()?e("banking.importing"):e("banking.importTransactions").replace("{count}",u().length.toString())}})})(),null),A})()]}})};wt(["click"]);var Uh=H("<span>"),Bs=H("<div>"),jh=H("<div> "),pE=H("<div><div><h3></h3><div><button></button><button></button><button></button></div></div><div></div><div><div><h4></h4><div></div></div><div><h4></h4><div>"),vE=H("<div><div><div></div><div> • </div></div><div><div>"),Il=H("<span>✓ "),bE=H("<span>(<!>)"),_E=H("<div><strong>:</strong> "),zh=H("<div><div><div></div><div> • </div></div><div>"),SE=H("<div><div>:</div><div></div><div>");const PE=t=>{const{t:e}=it(),[r,n]=ye([]),[i,o]=ye([]),[a,c]=ye(null),[u,h]=ye([]),[f,p]=ye("unreconciled");ei(()=>{const k=nr.getBankAccountById(t.bankAccountId);if(k){const Z=nr.getBankStatementsByAccount(k.accountId).filter(F=>F.date>=t.selectedPeriod.start&&F.date<=t.selectedPeriod.end),U=nr.getEntryBookRecordsByAccount(k.accountId).filter(F=>F.date>=t.selectedPeriod.start&&F.date<=t.selectedPeriod.end);n(Z),o(U)}});const b=()=>{const k=r();switch(f()){case"reconciled":return k.filter(Z=>Z.isReconciled);case"unreconciled":return k.filter(Z=>!Z.isReconciled);default:return k}},C=()=>{const k=i();switch(f()){case"reconciled":return k.filter(Z=>Z.isReconciled);case"unreconciled":return k.filter(Z=>!Z.isReconciled);default:return k}},R=k=>{if(c(k),k.isReconciled)h([]);else{const Z=nr.findPotentialMatches(k.id);h(Z)}},E=k=>{const Z=a();if(Z){nr.reconcileTransaction(Z.id,k.id);const U=nr.getBankAccountById(t.bankAccountId);if(U){const F=nr.getBankStatementsByAccount(U.accountId).filter(V=>V.date>=t.selectedPeriod.start&&V.date<=t.selectedPeriod.end),N=nr.getEntryBookRecordsByAccount(U.accountId).filter(V=>V.date>=t.selectedPeriod.start&&V.date<=t.selectedPeriod.end);n(F),o(N)}c(null),h([])}},x=k=>{nr.unreconciledTransaction(k.id);const Z=nr.getBankAccountById(t.bankAccountId);if(Z){const U=nr.getBankStatementsByAccount(Z.accountId).filter(N=>N.date>=t.selectedPeriod.start&&N.date<=t.selectedPeriod.end),F=nr.getEntryBookRecordsByAccount(Z.accountId).filter(N=>N.date>=t.selectedPeriod.start&&N.date<=t.selectedPeriod.end);n(U),o(F)}},T={display:"grid","grid-template-columns":"1fr 1fr",gap:"2rem","margin-top":"2rem"},W={height:"600px","overflow-y":"auto"},te={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},Q=k=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:k?"var(--primary-color)":"var(--surface-color)",color:k?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),de=(k,Z)=>({display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem","margin-bottom":"0.5rem",background:k?"var(--primary-color)":Z?"#e8f5e8":"var(--surface-color)",color:k?"white":"var(--text-primary)","border-radius":"var(--border-radius-sm)",border:`1px solid ${k?"var(--primary-color)":Z?"#c3e6cb":"var(--border-color)"}`,cursor:"pointer",transition:"all 0.2s ease"}),ae={flex:"1"},I={"font-weight":"500","margin-bottom":"0.25rem"},_={"font-size":"0.875rem",opacity:"0.8"},v=k=>({"font-weight":"600",color:k?"#4caf50":"#f44336"}),P={padding:"0.25rem 0.5rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","margin-left":"0.5rem"},w=k=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(k),A=k=>new Date(k).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),y=k=>{if(!a())return null;const Z=a();return(Math.abs(Z.debitAmount-k.debitAmount)<.01||Math.abs(Z.creditAmount-k.creditAmount)<.01)&&Z.date===k.date?(()=>{var N=Uh();return s(N,()=>e("banking.exactMatch")),se(V=>d(N,{...P,background:"#d4edda",color:"#155724"},V)),N})():u().includes(k)?(()=>{var N=Uh();return s(N,()=>e("banking.possibleMatch")),se(V=>d(N,{...P,background:"#fff3cd",color:"#856404"},V)),N})():null},G=(()=>{const k=r(),Z=i(),U=k.filter(N=>N.isReconciled).length,F=Z.filter(N=>N.isReconciled).length;return{totalStatements:k.length,totalRecords:Z.length,reconciledStatements:U,reconciledRecords:F,unreconciledStatements:k.length-U,unreconciledRecords:Z.length-F}})();return(()=>{var k=pE(),Z=k.firstChild,U=Z.firstChild,F=U.nextSibling,N=F.firstChild,V=N.nextSibling,fe=V.nextSibling,z=Z.nextSibling,ge=z.nextSibling,$=ge.firstChild,O=$.firstChild,X=O.nextSibling,Y=$.nextSibling,ue=Y.firstChild,re=ue.nextSibling;return d(Z,te),U.style.setProperty("margin","0"),U.style.setProperty("font-size","1.25rem"),s(U,()=>e("banking.reconciliationComparison")),F.style.setProperty("display","flex"),F.style.setProperty("gap","0.5rem"),N.$$click=()=>p("all"),s(N,()=>e("common.all")),V.$$click=()=>p("unreconciled"),s(V,()=>e("banking.unreconciled")),fe.$$click=()=>p("reconciled"),s(fe,()=>e("banking.reconciled")),z.style.setProperty("display","grid"),z.style.setProperty("grid-template-columns","repeat(4, 1fr)"),z.style.setProperty("gap","1rem"),z.style.setProperty("margin-bottom","2rem"),s(z,S(Ke,{get title(){return e("banking.bankStatements")},get subtitle(){return e("banking.totalTransactions")},get children(){return[(()=>{var M=Bs();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","var(--primary-color)"),s(M,()=>G.totalStatements),M})(),(()=>{var M=jh(),oe=M.firstChild;return M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","var(--text-muted)"),s(M,()=>G.reconciledStatements,oe),s(M,()=>e("banking.reconciled"),null),M})()]}}),null),s(z,S(Ke,{get title(){return e("banking.entryBookRecords")},get subtitle(){return e("banking.totalEntries")},get children(){return[(()=>{var M=Bs();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","var(--primary-color)"),s(M,()=>G.totalRecords),M})(),(()=>{var M=jh(),oe=M.firstChild;return M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","var(--text-muted)"),s(M,()=>G.reconciledRecords,oe),s(M,()=>e("banking.reconciled"),null),M})()]}}),null),s(z,S(Ke,{get title(){return e("banking.unreconciledBank")},get subtitle(){return e("banking.needAttention")},get children(){var M=Bs();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","#f44336"),s(M,()=>G.unreconciledStatements),M}}),null),s(z,S(Ke,{get title(){return e("banking.unreconciledBooks")},get subtitle(){return e("banking.needAttention")},get children(){var M=Bs();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","#f44336"),s(M,()=>G.unreconciledRecords),M}}),null),d(ge,T),O.style.setProperty("margin","0 0 1rem 0"),s(O,()=>e("banking.bankStatements")),s(X,()=>b().map(M=>(()=>{var oe=vE(),pe=oe.firstChild,be=pe.firstChild,ne=be.nextSibling,le=ne.firstChild,j=pe.nextSibling,ce=j.firstChild;return oe.$$click=()=>R(M),s(be,()=>M.description),s(ne,()=>A(M.date),le),s(ne,()=>M.reference,null),s(ne,(()=>{var D=me(()=>!!M.isReconciled);return()=>D()&&(()=>{var J=Il();return J.firstChild,J.style.setProperty("color","#4caf50"),J.style.setProperty("margin-left","0.5rem"),s(J,()=>e("banking.reconciled"),null),J})()})(),null),s(ce,()=>M.debitAmount>0?"+":"-",null),s(ce,()=>w(M.debitAmount||M.creditAmount),null),s(j,(()=>{var D=me(()=>!!M.isReconciled);return()=>D()&&S(De,{variant:"outline",size:"sm",onClick:J=>{J.stopPropagation(),x(M)},style:{"margin-top":"0.5rem"},get children(){return e("banking.unreconcile")}})})(),null),se(D=>{var J=de(a()?.id===M.id,M.isReconciled),ee=ae,q=I,B=_,_e=v(M.debitAmount>0);return D.e=d(oe,J,D.e),D.t=d(pe,ee,D.t),D.a=d(be,q,D.a),D.o=d(ne,B,D.o),D.i=d(ce,_e,D.i),D},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),oe})())),ue.style.setProperty("margin","0 0 1rem 0"),s(ue,()=>e("banking.entryBookRecords"),null),s(ue,(()=>{var M=me(()=>!!(a()&&!a().isReconciled));return()=>M()&&(()=>{var oe=bE(),pe=oe.firstChild,be=pe.nextSibling;return be.nextSibling,oe.style.setProperty("font-weight","400"),oe.style.setProperty("color","var(--text-muted)"),oe.style.setProperty("margin-left","0.5rem"),s(oe,()=>e("banking.clickToReconcile"),be),oe})()})(),null),s(re,(()=>{var M=me(()=>!!(a()&&!a().isReconciled));return()=>M()?[me(()=>me(()=>u().length>0)()&&(()=>{var oe=_E(),pe=oe.firstChild,be=pe.firstChild;return pe.nextSibling,oe.style.setProperty("margin-bottom","1rem"),oe.style.setProperty("padding","0.75rem"),oe.style.setProperty("background","#fff3cd"),oe.style.setProperty("border-radius","var(--border-radius-sm)"),s(pe,()=>e("banking.potentialMatchesFound"),be),s(oe,()=>e("banking.clickRecordToReconcile"),null),oe})()),me(()=>C().map(oe=>(u().includes(oe),(()=>{var pe=zh(),be=pe.firstChild,ne=be.firstChild,le=ne.nextSibling,j=le.firstChild,ce=be.nextSibling;return pe.$$click=()=>{oe.isReconciled||E(oe)},s(ne,()=>oe.description,null),s(ne,()=>y(oe),null),s(le,()=>A(oe.date),j),s(le,()=>oe.reference,null),s(le,(()=>{var D=me(()=>!!oe.isReconciled);return()=>D()&&(()=>{var J=Il();return J.firstChild,J.style.setProperty("color","#4caf50"),J.style.setProperty("margin-left","0.5rem"),s(J,()=>e("banking.reconciled"),null),J})()})(),null),s(ce,()=>oe.debitAmount>0?"+":"-",null),s(ce,()=>w(oe.debitAmount||oe.creditAmount),null),se(D=>{var J={...de(!1,oe.isReconciled),opacity:oe.isReconciled?.6:1,cursor:oe.isReconciled?"not-allowed":"pointer"},ee=ae,q=I,B=_,_e=v(oe.debitAmount>0);return D.e=d(pe,J,D.e),D.t=d(be,ee,D.t),D.a=d(ne,q,D.a),D.o=d(le,B,D.o),D.i=d(ce,_e,D.i),D},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),pe})())))]:C().map(oe=>(()=>{var pe=zh(),be=pe.firstChild,ne=be.firstChild,le=ne.nextSibling,j=le.firstChild,ce=be.nextSibling;return s(ne,()=>oe.description),s(le,()=>A(oe.date),j),s(le,()=>oe.reference,null),s(le,(()=>{var D=me(()=>!!oe.isReconciled);return()=>D()&&(()=>{var J=Il();return J.firstChild,J.style.setProperty("color","#4caf50"),J.style.setProperty("margin-left","0.5rem"),s(J,()=>e("banking.reconciled"),null),J})()})(),null),s(ce,()=>oe.debitAmount>0?"+":"-",null),s(ce,()=>w(oe.debitAmount||oe.creditAmount),null),se(D=>{var J=de(!1,oe.isReconciled),ee=ae,q=I,B=_,_e=v(oe.debitAmount>0);return D.e=d(pe,J,D.e),D.t=d(be,ee,D.t),D.a=d(ne,q,D.a),D.o=d(le,B,D.o),D.i=d(ce,_e,D.i),D},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),pe})())})()),s(k,(()=>{var M=me(()=>!!(a()&&!a().isReconciled));return()=>M()&&(()=>{var oe=SE(),pe=oe.firstChild,be=pe.firstChild,ne=pe.nextSibling,le=ne.nextSibling;return oe.style.setProperty("position","fixed"),oe.style.setProperty("bottom","2rem"),oe.style.setProperty("right","2rem"),oe.style.setProperty("background","var(--surface-color)"),oe.style.setProperty("padding","1rem"),oe.style.setProperty("border-radius","var(--border-radius)"),oe.style.setProperty("box-shadow","var(--shadow-lg)"),oe.style.setProperty("border","1px solid var(--border-color)"),oe.style.setProperty("max-width","300px"),pe.style.setProperty("font-weight","500"),pe.style.setProperty("margin-bottom","0.5rem"),s(pe,()=>e("banking.selected"),be),ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("margin-bottom","0.5rem"),s(ne,()=>a().description),le.style.setProperty("font-weight","600"),le.style.setProperty("color","var(--primary-color)"),s(le,()=>w(a().debitAmount||a().creditAmount)),s(oe,S(De,{variant:"secondary",size:"sm",onClick:()=>{c(null),h([])},style:{"margin-top":"0.5rem"},get children(){return e("banking.clearSelection")}}),null),oe})()})(),null),se(M=>{var oe=Q(f()==="all"),pe=Q(f()==="unreconciled"),be=Q(f()==="reconciled"),ne=W,le=W;return M.e=d(N,oe,M.e),M.t=d(V,pe,M.t),M.a=d(fe,be,M.a),M.o=d(X,ne,M.o),M.i=d(re,le,M.i),M},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),k})()};wt(["click"]);var wE=H("<div><div><h2></h2><p></p></div><div>"),CE=H("<div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date>"),AE=H("<div><button></button><button>"),IE=H("<div><br>"),Ao=H("<div>"),EE=H("<div><div></div><div> • </div><div>"),xE=H("<div>: "),TE=H("<div> <!> • <!> "),$E=H("<div>%"),kE=H("<div> of <!> transactions");const RE=()=>{const{t}=it(),[e,r]=ye(null),[n,i]=ye({start:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[o,a]=ye(!1),[c,u]=ye("overview");ei(()=>{!e()&&nr.bankAccounts.length>0&&r(nr.bankAccounts[0])});const h={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},f={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},p={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},b=te=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:te?"var(--primary-color)":"var(--text-muted)","border-bottom":te?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),C={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},R=te=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(te),E=te=>new Date(te).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),x=()=>nr.bankAccounts.map(te=>({value:te.id,label:`${te.bankName} - ${te.accountNumber} (${te.accountType})`})),W=(()=>{if(!e())return null;const te=nr.getBankStatementsByAccount(e().accountId).filter(ae=>ae.date>=n().start&&ae.date<=n().end),Q=nr.getEntryBookRecordsByAccount(e().accountId).filter(ae=>ae.date>=n().start&&ae.date<=n().end),de=te.filter(ae=>ae.isReconciled).length;return Q.filter(ae=>ae.isReconciled).length,{totalBankTransactions:te.length,totalEntryBookRecords:Q.length,reconciledTransactions:de,unreconciledTransactions:te.length-de,reconciliationRate:te.length>0?de/te.length*100:0}})();return S(Ur,{get title(){return t("banking.title")},get children(){return[(()=>{var te=wE(),Q=te.firstChild,de=Q.firstChild,ae=de.nextSibling,I=Q.nextSibling;return d(te,h),de.style.setProperty("margin","0 0 0.5rem 0"),de.style.setProperty("font-size","1.5rem"),s(de,()=>t("banking.reconciliation")),ae.style.setProperty("margin","0"),ae.style.setProperty("color","var(--text-muted)"),s(ae,()=>t("banking.compareStatements")),I.style.setProperty("display","flex"),I.style.setProperty("gap","1rem"),s(I,S(De,{variant:"secondary",onClick:()=>a(!0),get disabled(){return!e()},get children(){return t("banking.importCSV")}}),null),s(I,S(De,{variant:"primary",get children(){return t("banking.startNewReconciliation")}}),null),te})(),(()=>{var te=CE(),Q=te.firstChild,de=Q.firstChild,ae=Q.nextSibling,I=ae.firstChild,_=I.nextSibling,v=ae.nextSibling,P=v.firstChild,w=P.nextSibling;return d(te,f),Q.style.setProperty("flex","1"),de.style.setProperty("display","block"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),s(de,()=>t("banking.bankAccount")),s(Q,S(mr,{label:"",get value(){return e()?.id||""},onChange:A=>{const y=nr.getBankAccountById(A);r(y||null)},get options(){return x()}}),null),I.style.setProperty("display","block"),I.style.setProperty("margin-bottom","0.5rem"),I.style.setProperty("font-weight","500"),s(I,()=>t("entryBooks.startDate")),_.addEventListener("change",A=>i(y=>({...y,start:A.target.value}))),_.style.setProperty("padding","0.75rem"),_.style.setProperty("border","1px solid var(--border-color)"),_.style.setProperty("border-radius","var(--border-radius-sm)"),_.style.setProperty("font-family","inherit"),P.style.setProperty("display","block"),P.style.setProperty("margin-bottom","0.5rem"),P.style.setProperty("font-weight","500"),s(P,()=>t("entryBooks.endDate")),w.addEventListener("change",A=>i(y=>({...y,end:A.target.value}))),w.style.setProperty("padding","0.75rem"),w.style.setProperty("border","1px solid var(--border-color)"),w.style.setProperty("border-radius","var(--border-radius-sm)"),w.style.setProperty("font-family","inherit"),se(()=>_.value=n().start),se(()=>w.value=n().end),te})(),(()=>{var te=AE(),Q=te.firstChild,de=Q.nextSibling;return d(te,p),Q.$$click=()=>u("overview"),s(Q,()=>t("common.overview")),de.$$click=()=>u("reconciliation"),s(de,()=>t("banking.reconciliation")),se(ae=>{var I=b(c()==="overview"),_=b(c()==="reconciliation");return ae.e=d(Q,I,ae.e),ae.t=d(de,_,ae.t),ae},{e:void 0,t:void 0}),te})(),me(()=>me(()=>c()==="overview")()&&(()=>{var te=Ao();return s(te,(()=>{var Q=me(()=>!!e());return()=>Q()&&(()=>{var de=Ao();return d(de,C),s(de,S(Ke,{get title(){return t("banking.bankAccountInfo")},get subtitle(){return t("banking.currentAccountDetails")},get children(){return[(()=>{var ae=EE(),I=ae.firstChild,_=I.nextSibling,v=_.firstChild,P=_.nextSibling;return ae.style.setProperty("margin-bottom","1rem"),I.style.setProperty("font-weight","600"),I.style.setProperty("margin-bottom","0.5rem"),s(I,()=>e().bankName),_.style.setProperty("color","var(--text-muted)"),_.style.setProperty("margin-bottom","0.5rem"),s(_,()=>e().accountNumber,v),s(_,()=>e().accountType,null),P.style.setProperty("font-size","1.25rem"),P.style.setProperty("font-weight","600"),P.style.setProperty("color","var(--primary-color)"),s(P,()=>R(e().currentBalance)),ae})(),me(()=>me(()=>!!e().lastReconciledDate)()&&(()=>{var ae=xE(),I=ae.firstChild;return ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),s(ae,()=>t("banking.lastReconciled"),I),s(ae,()=>E(e().lastReconciledDate),null),ae})())]}}),null),s(de,W&&[S(Ke,{get title(){return t("banking.bankTransactions")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var ae=Ao();return ae.style.setProperty("font-size","1.5rem"),ae.style.setProperty("font-weight","600"),ae.style.setProperty("color","var(--primary-color)"),ae.style.setProperty("margin-bottom","0.5rem"),s(ae,()=>W.totalBankTransactions),ae})(),(()=>{var ae=TE(),I=ae.firstChild,_=I.nextSibling,v=_.nextSibling,P=v.nextSibling;return P.nextSibling,ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),s(ae,()=>W.reconciledTransactions,I),s(ae,()=>t("banking.reconciled"),_),s(ae,()=>W.unreconciledTransactions,P),s(ae,()=>t("banking.pending"),null),ae})()]}}),S(Ke,{get title(){return t("entryBooks.entryBookRecords")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var ae=Ao();return ae.style.setProperty("font-size","1.5rem"),ae.style.setProperty("font-weight","600"),ae.style.setProperty("color","var(--primary-color)"),ae.style.setProperty("margin-bottom","0.5rem"),s(ae,()=>W.totalEntryBookRecords),ae})(),(()=>{var ae=Ao();return ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),s(ae,()=>t("banking.bookEntriesForComparison")),ae})()]}}),S(Ke,{get title(){return t("banking.reconciliationRate")},get subtitle(){return t("banking.completionStatus")},get children(){return[(()=>{var ae=$E(),I=ae.firstChild;return ae.style.setProperty("font-size","1.5rem"),ae.style.setProperty("font-weight","600"),ae.style.setProperty("margin-bottom","0.5rem"),s(ae,()=>Math.round(W.reconciliationRate),I),se(_=>(_=W.reconciliationRate>80?"#4caf50":W.reconciliationRate>50?"#ff9800":"#f44336")!=null?ae.style.setProperty("color",_):ae.style.removeProperty("color")),ae})(),(()=>{var ae=kE(),I=ae.firstChild,_=I.nextSibling;return _.nextSibling,ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),s(ae,()=>W.reconciledTransactions,I),s(ae,()=>W.totalBankTransactions,_),ae})()]}})],null),de})()})(),null),s(te,S(Ke,{get title(){return t("banking.recentReconciliationSessions")},get subtitle(){return t("banking.latestActivity")},get children(){var Q=IE(),de=Q.firstChild;return Q.style.setProperty("text-align","center"),Q.style.setProperty("color","var(--text-muted)"),Q.style.setProperty("padding","2rem"),s(Q,()=>t("banking.noRecentSessions"),de),s(Q,S(De,{variant:"primary",style:{"margin-top":"1rem"},onClick:()=>u("reconciliation"),get children(){return t("banking.startFirstReconciliation")}}),null),Q}}),null),te})()),me(()=>me(()=>!!(c()==="reconciliation"&&e()))()&&S(PE,{get bankAccountId(){return e().id},get selectedPeriod(){return n()}})),S(gE,{get isOpen(){return o()},onClose:()=>a(!1),get bankAccount(){return e()}})]}})};wt(["click"]);var DE=H("<div><div></div><div>"),El=H("<div>"),NE=H("<div> • <!> • <!> "),LE=H("<div><div><div></div><div></div></div><div><div></div><div>"),ME=H("<div><div>:"),OE=H("<div>⚠️ <!>: <!> <!>, <!> "),VE=H("<div><div><div></div><div></div></div><div>"),qh=H("<div> "),BE=H("<div>✓ ");const FE=t=>{const{t:e}=it(),r={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},n={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},i={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},o={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)","margin-bottom":"0.5rem"},a={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"1rem"},c={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},u={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},h={"max-height":"100px","overflow-y":"auto","border-top":"1px solid var(--border-color)","padding-top":"1rem"},f={display:"flex","justify-content":"space-between","align-items":"center","font-size":"0.875rem","margin-bottom":"0.5rem"},p={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},b=T=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[T],C=T=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(T),R=T=>new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),E=b(t.entry.status),x=Math.abs(t.entry.totalDebit-t.entry.totalCredit)<.01;return S(Ke,{get children(){return[(()=>{var T=DE(),W=T.firstChild,te=W.nextSibling;return d(T,r),d(W,n),s(W,()=>t.entry.entryNumber),s(te,()=>t.entry.status),se(Q=>d(te,{...i,background:E.bg,color:E.color},Q)),T})(),(()=>{var T=El();return d(T,o),s(T,()=>t.entry.description),T})(),(()=>{var T=NE(),W=T.firstChild,te=W.nextSibling,Q=te.nextSibling,de=Q.nextSibling;return de.nextSibling,d(T,a),s(T,()=>R(t.entry.date),W),s(T,()=>t.entry.reference||e("journal.noReference","No reference"),te),s(T,()=>e("journal.createdBy","By"),de),s(T,()=>t.entry.createdBy,null),T})(),(()=>{var T=LE(),W=T.firstChild,te=W.firstChild,Q=te.nextSibling,de=W.nextSibling,ae=de.firstChild,I=ae.nextSibling;return d(T,c),te.style.setProperty("font-size","0.875rem"),te.style.setProperty("color","var(--text-muted)"),s(te,()=>e("journal.totalAmount","Total Amount")),d(Q,u),s(Q,()=>C(t.entry.totalDebit)),de.style.setProperty("text-align","right"),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),s(ae,()=>e("journal.lines","Lines")),I.style.setProperty("font-weight","600"),s(I,()=>t.entry.lines.length),T})(),me(()=>!x&&(()=>{var T=OE(),W=T.firstChild,te=W.nextSibling,Q=te.nextSibling,de=Q.nextSibling,ae=de.nextSibling,I=ae.nextSibling,_=I.nextSibling,v=_.nextSibling;return v.nextSibling,T.style.setProperty("padding","0.5rem"),T.style.setProperty("border-radius","var(--border-radius-sm)"),T.style.setProperty("background","#f8d7da"),T.style.setProperty("color","#721c24"),T.style.setProperty("font-size","0.875rem"),T.style.setProperty("margin-bottom","1rem"),s(T,()=>e("journal.entryNotBalancedShort","Entry is not balanced"),te),s(T,()=>e("journal.debit"),de),s(T,()=>C(t.entry.totalDebit),I),s(T,()=>e("journal.credit"),v),s(T,()=>C(t.entry.totalCredit),null),T})()),(()=>{var T=ME(),W=T.firstChild,te=W.firstChild;return d(T,h),W.style.setProperty("font-weight","500"),W.style.setProperty("margin-bottom","0.5rem"),W.style.setProperty("font-size","0.875rem"),s(W,()=>e("journal.accountLines","Account Lines"),te),s(T,()=>t.entry.lines.slice(0,3).map(Q=>(()=>{var de=VE(),ae=de.firstChild,I=ae.firstChild,_=I.nextSibling,v=ae.nextSibling;return d(de,f),ae.style.setProperty("flex","1"),I.style.setProperty("font-weight","500"),s(I,()=>Q.accountName),_.style.setProperty("font-size","0.75rem"),_.style.setProperty("color","var(--text-muted)"),s(_,()=>Q.description||e("journal.noDescription","No description")),v.style.setProperty("text-align","right"),s(v,(()=>{var P=me(()=>Q.debitAmount>0);return()=>P()&&(()=>{var w=qh(),A=w.firstChild;return w.style.setProperty("color","#4caf50"),w.style.setProperty("font-weight","500"),s(w,()=>e("journal.debitShort","Dr."),A),s(w,()=>C(Q.debitAmount),null),w})()})(),null),s(v,(()=>{var P=me(()=>Q.creditAmount>0);return()=>P()&&(()=>{var w=qh(),A=w.firstChild;return w.style.setProperty("color","#f44336"),w.style.setProperty("font-weight","500"),s(w,()=>e("journal.creditShort","Cr."),A),s(w,()=>C(Q.creditAmount),null),w})()})(),null),s(v,(()=>{var P=me(()=>!!Q.reconciled);return()=>P()&&(()=>{var w=BE();return w.firstChild,w.style.setProperty("font-size","0.75rem"),w.style.setProperty("color","#4caf50"),s(w,()=>e("banking.reconciled","Reconciled"),null),w})()})(),null),de})()),null),s(T,(()=>{var Q=me(()=>t.entry.lines.length>3);return()=>Q()&&(()=>{var de=El();return de.style.setProperty("text-align","center"),de.style.setProperty("color","var(--text-muted)"),de.style.setProperty("font-size","0.875rem"),s(de,()=>e("journal.andMoreLines","... and {count} more lines").replace("{count}",(t.entry.lines.length-3).toString())),de})()})(),null),T})(),(()=>{var T=El();return d(T,p),s(T,S(De,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.entry),get children(){return e("journal.viewDetails","View Details")}})),T})()]}})},UE=[{id:"je1",entryNumber:"JE-2024-001",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",status:"posted",createdBy:"John Doe",createdAt:"2024-01-15T09:00:00Z",postedAt:"2024-01-15T09:05:00Z",totalDebit:5e3,totalCredit:5e3,lines:[{id:"jel1",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment from ABC Corp",debitAmount:5e3,creditAmount:0,reconciled:!0,reconciledWith:"eb1"},{id:"jel2",accountId:"2001",accountName:"Trade Receivables",description:"Payment received for INV-2024-001",debitAmount:0,creditAmount:5e3}]},{id:"je2",entryNumber:"JE-2024-002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",status:"posted",createdBy:"Jane Smith",createdAt:"2024-01-14T10:00:00Z",postedAt:"2024-01-14T10:15:00Z",totalDebit:250,totalCredit:250,lines:[{id:"jel3",accountId:"5200",accountName:"Office Expenses",description:"Office supplies from Staples",debitAmount:250,creditAmount:0},{id:"jel4",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment to Staples",debitAmount:0,creditAmount:250,reconciled:!0,reconciledWith:"eb2"}]},{id:"je3",entryNumber:"JE-2024-003",date:"2024-01-13",description:"Monthly Rent Payment",reference:"RENT-2024-01",status:"posted",createdBy:"John Doe",createdAt:"2024-01-13T08:00:00Z",postedAt:"2024-01-13T08:30:00Z",totalDebit:2e3,totalCredit:2e3,lines:[{id:"jel5",accountId:"5200",accountName:"Rent Expense",description:"January office rent",debitAmount:2e3,creditAmount:0},{id:"jel6",accountId:"1002",accountName:"Bank - Checking Account",description:"Rent payment",debitAmount:0,creditAmount:2e3,reconciled:!1}]},{id:"je4",entryNumber:"JE-2024-004",date:"2024-01-12",description:"Wire Transfer - Capital Investment",reference:"WIRE-001",status:"posted",createdBy:"Admin",createdAt:"2024-01-12T14:00:00Z",postedAt:"2024-01-12T14:30:00Z",totalDebit:1e4,totalCredit:1e4,lines:[{id:"jel7",accountId:"1002",accountName:"Bank - Checking Account",description:"Wire transfer received",debitAmount:1e4,creditAmount:0,reconciled:!1},{id:"jel8",accountId:"8",accountName:"Owner's Equity",description:"Capital investment",debitAmount:0,creditAmount:1e4}]},{id:"je5",entryNumber:"JE-2024-005",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",status:"posted",createdBy:"HR Manager",createdAt:"2024-01-11T16:00:00Z",postedAt:"2024-01-11T16:30:00Z",totalDebit:3500,totalCredit:3500,lines:[{id:"jel9",accountId:"13",accountName:"Salaries Expense",description:"Monthly salary - John Doe",debitAmount:3500,creditAmount:0},{id:"jel10",accountId:"1002",accountName:"Bank - Checking Account",description:"Salary payment",debitAmount:0,creditAmount:3500,reconciled:!1}]},{id:"je6",entryNumber:"JE-2024-006",date:"2024-01-10",description:"Product Sales - Multiple Customers",reference:"SALES-2024-010",status:"posted",createdBy:"Sales Manager",createdAt:"2024-01-10T11:00:00Z",postedAt:"2024-01-10T11:30:00Z",totalDebit:8500,totalCredit:8500,lines:[{id:"jel11",accountId:"1001",accountName:"Petty Cash",description:"Cash sales",debitAmount:1500,creditAmount:0},{id:"jel12",accountId:"2001",accountName:"Trade Receivables",description:"Credit sales",debitAmount:7e3,creditAmount:0},{id:"jel13",accountId:"10",accountName:"Sales Revenue",description:"Product sales revenue",debitAmount:0,creditAmount:8500}]},{id:"je7",entryNumber:"JE-2024-007",date:"2024-01-09",description:"Inventory Purchase",reference:"PO-2024-002",status:"draft",createdBy:"Warehouse Manager",createdAt:"2024-01-09T15:00:00Z",totalDebit:15e3,totalCredit:15e3,lines:[{id:"jel14",accountId:"3",accountName:"Inventory",description:"Product inventory purchase",debitAmount:15e3,creditAmount:0},{id:"jel15",accountId:"5",accountName:"Accounts Payable",description:"Amount owed to supplier",debitAmount:0,creditAmount:15e3}]},{id:"je8",entryNumber:"JE-2024-008",date:"2024-01-08",description:"Utility Bills Payment",reference:"UTIL-2024-01",status:"posted",createdBy:"Admin",createdAt:"2024-01-08T09:00:00Z",postedAt:"2024-01-08T09:30:00Z",totalDebit:450,totalCredit:450,lines:[{id:"jel16",accountId:"14",accountName:"Operating Expenses",description:"Electricity and water bills",debitAmount:450,creditAmount:0},{id:"jel17",accountId:"1003",accountName:"Bank - Savings Account",description:"Utility payment",debitAmount:0,creditAmount:450}]}],[kr,xl]=ye(UE),Hh=()=>kr().filter(e=>e.status==="posted").flatMap(e=>e.lines.filter(r=>["1001","1002","1003"].includes(r.accountId))).map(e=>{const r=kr().find(n=>n.lines.some(i=>i.id===e.id));return r?{id:`eb_${e.id}`,accountId:e.accountId,date:r.date,description:r.description,reference:r.reference,debitAmount:e.debitAmount,creditAmount:e.creditAmount,category:e.accountName,isReconciled:e.reconciled||!1,reconciledWith:e.reconciledWith,createdAt:r.createdAt}:null}).filter(e=>e!==null),Sn={get journalEntries(){return kr()},addJournalEntry(t){const e={...t,id:Date.now().toString()};return xl([...kr(),e]),e},updateJournalEntry(t,e){xl(kr().map(r=>r.id===t?{...r,...e}:r))},deleteJournalEntry(t){const e=kr().find(r=>r.id===t);if(e&&e.status==="posted")throw new Error("Cannot delete posted journal entries. Void them instead.");xl(kr().filter(r=>r.id!==t))},voidJournalEntry(t){this.updateJournalEntry(t,{status:"void"})},postJournalEntry(t){const e=kr().find(r=>r.id===t);if(!e)throw new Error("Journal entry not found");if(Math.abs(e.totalDebit-e.totalCredit)>.01)throw new Error("Journal entry is not balanced. Debits must equal credits.");this.updateJournalEntry(t,{status:"posted",postedAt:new Date().toISOString()}),Hh()},getJournalEntryById(t){return kr().find(e=>e.id===t)},getJournalEntriesByStatus(t){return kr().filter(e=>e.status===t)},getJournalEntriesByDateRange(t,e){return kr().filter(r=>r.date>=t&&r.date<=e)},getJournalEntriesByAccount(t){return kr().filter(e=>e.lines.some(r=>r.accountId===t))},getNextEntryNumber(){const t=new Date().getFullYear(),r=kr().filter(n=>n.entryNumber.includes(t.toString())).reduce((n,i)=>{const o=parseInt(i.entryNumber.split("-").pop()||"0");return o>n?o:n},0);return`JE-${t}-${String(r+1).padStart(3,"0")}`},validateJournalEntry(t){const e=[];if(t.date||e.push("Date is required"),t.description||e.push("Description is required"),(!t.lines||t.lines.length===0)&&e.push("At least one line item is required"),t.lines){const r=t.lines.reduce((i,o)=>i+(o.debitAmount||0),0),n=t.lines.reduce((i,o)=>i+(o.creditAmount||0),0);Math.abs(r-n)>.01&&e.push(`Entry is not balanced. Debit: ${r}, Credit: ${n}`),t.lines.forEach((i,o)=>{i.accountId||e.push(`Line ${o+1}: Account is required`),i.debitAmount===0&&i.creditAmount===0&&e.push(`Line ${o+1}: Either debit or credit amount must be provided`),i.debitAmount>0&&i.creditAmount>0&&e.push(`Line ${o+1}: Cannot have both debit and credit amounts`)})}return{isValid:e.length===0,errors:e}},getBankRelatedEntries(){return Hh()}};var jE=H("<form><div></div><div><div><h4></h4></div><div><div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div></div></div><div><div><strong>: </strong></div><div><strong>: </strong></div><div></div></div></div><div>"),Wh=H("<div>");const Yy=t=>{const{t:e}=it(),[r,n]=ye({entryNumber:"",date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),[i,o]=ye([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),[a,c]=ye(null);ei(()=>{if(t.isOpen){if(t.editEntry)n({entryNumber:t.editEntry.entryNumber,date:t.editEntry.date,description:t.editEntry.description,reference:t.editEntry.reference,createdBy:t.editEntry.createdBy}),o(t.editEntry.lines.map((Q,de)=>({...Q,tempId:`line_${Date.now()}_${de}`})));else{const Q=Sn.getNextEntryNumber();n({entryNumber:Q,date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),o([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])}c(null)}});const u={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},h={display:"grid","grid-template-columns":"2fr 2fr 1fr 1fr 1fr",gap:"1rem","align-items":"end","margin-bottom":"1rem",padding:"1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},f={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},p=()=>ut.accounts.map(Q=>({value:Q.id,label:`${Q.accountNumber} - ${Q.name}`})),b=(Q,de)=>{n(ae=>({...ae,[Q]:de}))},C=(Q,de,ae)=>{o(I=>I.map(_=>{if(_.tempId===Q){const v={..._,[de]:ae};if(de==="accountId"&&typeof ae=="string"){const P=ut.getAccountById(ae);P&&(v.accountName=P.name)}return v}return _}))},R=()=>{o(Q=>[...Q,{tempId:`line_${Date.now()}_${Q.length}`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])},E=Q=>{i().length>2&&o(de=>de.filter(ae=>ae.tempId!==Q))},x=()=>{const Q=i().reduce((ae,I)=>ae+(I.debitAmount||0),0),de=i().reduce((ae,I)=>ae+(I.creditAmount||0),0);return{totalDebit:Q,totalCredit:de,isBalanced:Math.abs(Q-de)<.01}},T=Q=>{Q.preventDefault(),c(null);const de=r(),ae=i(),{totalDebit:I,totalCredit:_,isBalanced:v}=x();if(!de.description){c(e("forms.descriptionRequired","Description is required"));return}if(ae.length<2){c(e("journal.minTwoLinesRequired","At least 2 line items are required"));return}if(!v){c(e("journal.entryNotBalanced","Entry is not balanced. Debit: ${debit}, Credit: ${credit}").replace("${debit}",`$${I.toFixed(2)}`).replace("${credit}",`$${_.toFixed(2)}`));return}for(let w=0;w<ae.length;w++){const A=ae[w];if(!A.accountId){c(e("journal.lineAccountRequired","Line {lineNumber}: Account is required").replace("{lineNumber}",(w+1).toString()));return}if(A.debitAmount===0&&A.creditAmount===0){c(e("journal.lineAmountRequired","Line {lineNumber}: Either debit or credit amount must be provided").replace("{lineNumber}",(w+1).toString()));return}if((A.debitAmount||0)>0&&(A.creditAmount||0)>0){c(e("journal.lineBothAmounts","Line {lineNumber}: Cannot have both debit and credit amounts").replace("{lineNumber}",(w+1).toString()));return}}const P={entryNumber:de.entryNumber,date:de.date,description:de.description,reference:de.reference,status:"draft",createdBy:de.createdBy,createdAt:new Date().toISOString(),totalDebit:I,totalCredit:_,lines:ae.map((w,A)=>{const{tempId:y,...he}=w;return{id:`jel_${Date.now()}_${A}`,...he}})};try{t.editEntry?Sn.updateJournalEntry(t.editEntry.id,P):Sn.addJournalEntry(P),n({entryNumber:Sn.getNextEntryNumber(),date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),o([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),t.onClose()}catch(w){c(w instanceof Error?w.message:e("forms.errorOccurred","An error occurred"))}},W=Q=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Q),te=x();return S(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return me(()=>!!t.editEntry)()?e("journal.editEntry"):e("journal.addEntry","Add Journal Entry")},get children(){var Q=jE(),de=Q.firstChild,ae=de.nextSibling,I=ae.firstChild,_=I.firstChild,v=I.nextSibling,P=v.firstChild,w=P.firstChild,A=w.firstChild,y=w.nextSibling,he=y.firstChild,G=y.nextSibling,k=G.firstChild,Z=G.nextSibling,U=Z.firstChild,F=Z.nextSibling,N=F.firstChild,V=v.nextSibling,fe=V.firstChild,z=fe.firstChild,ge=z.firstChild,$=fe.nextSibling,O=$.firstChild,X=O.firstChild,Y=$.nextSibling,ue=ae.nextSibling;return Q.addEventListener("submit",T),de.style.setProperty("display","grid"),de.style.setProperty("grid-template-columns","1fr 1fr"),de.style.setProperty("gap","1rem"),s(de,S(Pt,{get label(){return e("journal.entryNumber")},get value(){return r().entryNumber},onChange:re=>b("entryNumber",re),get disabled(){return!!t.editEntry},required:!0}),null),s(de,S(Pt,{get label(){return e("common.date")},type:"date",get value(){return r().date},onChange:re=>b("date",re),required:!0}),null),s(Q,S(Pt,{get label(){return e("common.description")},get value(){return r().description},onChange:re=>b("description",re),get placeholder(){return e("journal.enterEntryDescription","Enter journal entry description")},required:!0}),ae),s(Q,S(Pt,{get label(){return e("journal.reference")},get value(){return r().reference},onChange:re=>b("reference",re),get placeholder(){return e("journal.enterReferenceNumber","Enter reference number")}}),ae),ae.style.setProperty("margin-top","2rem"),I.style.setProperty("display","flex"),I.style.setProperty("justify-content","space-between"),I.style.setProperty("align-items","center"),I.style.setProperty("margin-bottom","1rem"),_.style.setProperty("margin","0"),s(_,()=>e("journal.entryLines","Journal Entry Lines")),s(I,S(De,{type:"button",variant:"secondary",size:"sm",onClick:R,get children(){return e("journal.addLine","Add Line")}}),null),v.style.setProperty("margin-bottom","1rem"),v.style.setProperty("font-size","0.875rem"),v.style.setProperty("color","var(--text-muted)"),P.style.setProperty("display","grid"),P.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1fr"),P.style.setProperty("gap","1rem"),s(A,()=>e("journal.account")),s(he,()=>e("common.description")),s(k,()=>e("journal.debit")),s(U,()=>e("journal.credit")),s(N,()=>e("common.actions")),s(ae,S(Ot,{get each(){return i()},children:re=>(()=>{var M=Wh();return d(M,h),s(M,S(mr,{label:"",get value(){return re.accountId||""},onChange:oe=>C(re.tempId,"accountId",oe),get options(){return p()}}),null),s(M,S(Pt,{label:"",get value(){return re.description||""},onChange:oe=>C(re.tempId,"description",oe),get placeholder(){return e("journal.lineDescription","Line description")}}),null),s(M,S(Pt,{label:"",type:"number",get value(){return re.debitAmount?.toString()||"0"},onChange:oe=>{C(re.tempId,"debitAmount",parseFloat(oe)||0),parseFloat(oe)>0&&C(re.tempId,"creditAmount",0)},placeholder:"0.00"}),null),s(M,S(Pt,{label:"",type:"number",get value(){return re.creditAmount?.toString()||"0"},onChange:oe=>{C(re.tempId,"creditAmount",parseFloat(oe)||0),parseFloat(oe)>0&&C(re.tempId,"debitAmount",0)},placeholder:"0.00"}),null),s(M,S(De,{type:"button",variant:"outline",size:"sm",onClick:()=>E(re.tempId),get disabled(){return i().length<=2},get children(){return e("common.remove","Remove")}}),null),M})()}),V),d(V,f),s(z,()=>e("journal.totalDebit","Total Debit"),ge),s(z,()=>W(te.totalDebit),null),s(O,()=>e("journal.totalCredit","Total Credit"),X),s(O,()=>W(te.totalCredit),null),Y.style.setProperty("font-weight","600"),s(Y,(()=>{var re=me(()=>!!te.isBalanced);return()=>re()?`✓ ${e("journal.balanced")}`:`⚠️ ${e("journal.notBalanced","Not Balanced")}`})()),s(Q,(()=>{var re=me(()=>!!a());return()=>re()&&(()=>{var M=Wh();return M.style.setProperty("padding","1rem"),M.style.setProperty("border-radius","var(--border-radius-sm)"),M.style.setProperty("margin-top","1rem"),M.style.setProperty("background","#f8d7da"),M.style.setProperty("color","#721c24"),M.style.setProperty("border","1px solid #f5c6cb"),s(M,a),M})()})(),ue),d(ue,u),s(ue,S(De,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(ue,S(De,{variant:"primary",type:"submit",get disabled(){return!te.isBalanced},get children(){return me(()=>!!t.editEntry)()?e("journal.updateEntry","Update Entry"):e("journal.saveAsDraft","Save as Draft")}}),null),se(re=>(re=te.isBalanced?"#4caf50":"#f44336")!=null?Y.style.setProperty("color",re):Y.style.removeProperty("color")),Q}})};var zE=H("<div><div>⚠️</div><div></div><div></div><div>"),qE=H("<div><div></div><div></div><div></div><div></div><div>"),HE=H("<div><button></button><button> (<!>)</button><button> (<!>/<!>)"),Gh=H("<div>"),WE=H("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><div><h4></h4><div></div></div><div>"),Tl=H("<div><span></span><span>"),$l=H("<div><strong>:</strong> "),GE=H("<div><div><div></div><div></div><div></div><div></div><div></div></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div></div></div><div><div><strong>🔗 Reconciliation Summary</strong></div><div><div><div><strong>Total Lines:</strong> </div><div><strong>Reconciled:</strong> </div><div><strong>Unreconciled:</strong> </div></div><div><div><strong>Bank Accounts:</strong> </div><div><strong>Bank Reconciled:</strong> "),YE=H("<div><div><div></div><div></div></div><div></div><div></div><div></div><div>"),KE=H("<div><span>✓ "),QE=H("<span>(<!>)"),JE=H("<div><strong>Bank Pending:</strong> "),XE=H("<div><div>Reconciled Lines:"),ZE=H("<div><div>⚠️ Pending Bank Reconciliation:</div><div>Visit Bank Consolidations to reconcile these transactions"),ex=H("<div><div><div><span></span><h3></h3></div><div><div><div></div><div>Total Lines</div></div><div><div></div><div>Reconciled</div></div><div><div></div><div>Pending"),tx=H("<div><h4>✅ Reconciled Lines (<!>)"),rx=H("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div>✓ Matched"),nx=H("<div>→ "),ix=H("<div><h4>⏳ Unreconciled Lines (<!>)"),ox=H("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div>⏳ Pending"),sx=H("<div>Bank account"),ax=H("<div><div>💡 Reconciliation Tip</div><div>This entry has unreconciled bank account transactions. Visit <strong>Bank Consolidations</strong> to match these with bank statements.");const lx=t=>{const{t:e}=it(),[r,n]=ye("details"),[i,o]=ye(!1),a=ze(()=>t.entryId?Sn.getJournalEntryById(t.entryId):null),c={"text-align":"center","margin-bottom":"2rem",position:"relative"},u={position:"absolute",top:"0",right:"0",display:"flex",gap:"0.5rem"},h={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","margin-bottom":"0.5rem"},f={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},p={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},b={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem",display:"inline-block"},C={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},R={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},E={"font-weight":"600",color:"var(--text-primary)"},x={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},T=y=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:y?"var(--primary-color)":"var(--text-muted)","border-bottom":y?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),W={display:"grid","grid-template-columns":"2fr 2.5fr 1fr 1fr 1.5fr",gap:"1rem",padding:"1rem 0","border-bottom":"1px solid var(--border-color)","align-items":"center"},te={...W,"font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","border-bottom":"2px solid var(--border-color)"},Q={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},de={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},ae=y=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[y],I=y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(y),_=y=>new Date(y).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),v=y=>new Date(y).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),P=()=>{entry.status==="posted"&&!confirm(e("journal.confirmEditPosted","This entry has been posted. Editing will create a new draft copy. Continue?"))||o(!0)},w=()=>{if(a()&&confirm(e("journal.confirmPost","Are you sure you want to post this journal entry? This action cannot be undone.")))try{Sn.postJournalEntry(a().id)}catch(y){alert(y instanceof Error?y.message:e("forms.errorPostingEntry","An error occurred while posting the entry"))}},A=()=>{a()&&confirm(e("journal.confirmVoid","Are you sure you want to void this journal entry?"))&&Sn.voidJournalEntry(a().id)};return[S(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.entryDetails","Journal Entry Details")},get children(){return me(()=>!a())()?(()=>{var y=zE(),he=y.firstChild,G=he.nextSibling,k=G.nextSibling,Z=k.nextSibling;return y.style.setProperty("text-align","center"),y.style.setProperty("padding","3rem"),y.style.setProperty("color","var(--text-muted)"),he.style.setProperty("font-size","1.5rem"),he.style.setProperty("margin-bottom","1rem"),G.style.setProperty("font-size","1.1rem"),G.style.setProperty("margin-bottom","0.5rem"),s(G,()=>e("journal.entryNotFound","Entry Not Found")),k.style.setProperty("font-size","0.875rem"),s(k,()=>e("journal.entryNotFoundMessage","The journal entry you're looking for could not be found or may have been deleted.")),Z.style.setProperty("margin-top","2rem"),s(Z,S(De,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),y})():(()=>{const y=a(),he=ae(y.status),G=Math.abs(y.totalDebit-y.totalCredit)<.01;return[(()=>{var k=qE(),Z=k.firstChild,U=Z.nextSibling,F=U.nextSibling,N=F.nextSibling,V=N.nextSibling;return d(k,c),s(Z,S(De,{variant:"outline",size:"sm",onClick:P,get title(){return e("journal.editEntryTooltip","Edit this journal entry")},get children(){return e("common.edit")}}),null),s(Z,(()=>{var fe=me(()=>y.status==="draft");return()=>fe()&&S(De,{variant:"primary",size:"sm",onClick:w,disabled:!G,get title(){return G?e("journal.postEntryTooltip","Post this journal entry"):e("journal.entryMustBeBalanced","Entry must be balanced to post")},get children(){return e("journal.post","Post")}})})(),null),s(Z,(()=>{var fe=me(()=>y.status==="posted");return()=>fe()&&S(De,{variant:"outline",size:"sm",onClick:A,style:{color:"#dc3545","border-color":"#dc3545"},get title(){return e("journal.voidEntryTooltip","Void this journal entry")},get children(){return e("entryBooks.void","Void")}})})(),null),d(U,h),s(U,()=>y.entryNumber),d(F,f),s(F,()=>y.description),d(N,p),s(N,()=>I(y.totalDebit)),s(V,()=>y.status),se(fe=>{var z=u,ge={...b,background:he.bg,color:he.color};return fe.e=d(Z,z,fe.e),fe.t=d(V,ge,fe.t),fe},{e:void 0,t:void 0}),k})(),(()=>{var k=HE(),Z=k.firstChild,U=Z.nextSibling,F=U.firstChild,N=F.nextSibling;N.nextSibling;var V=U.nextSibling,fe=V.firstChild,z=fe.nextSibling,ge=z.nextSibling,$=ge.nextSibling;return $.nextSibling,d(k,x),Z.$$click=()=>n("details"),s(Z,()=>e("common.details")),U.$$click=()=>n("lines"),s(U,()=>e("journal.journalLines","Journal Lines"),F),s(U,()=>y.lines.length,N),V.$$click=()=>n("reconciliation"),s(V,()=>e("banking.reconciliation","Reconciliation"),fe),s(V,()=>y.lines.filter(O=>O.reconciled).length,z),s(V,()=>y.lines.length,$),se(O=>{var X=T(r()==="details"),Y=T(r()==="lines"),ue=T(r()==="reconciliation");return O.e=d(Z,X,O.e),O.t=d(U,Y,O.t),O.a=d(V,ue,O.a),O},{e:void 0,t:void 0,a:void 0}),k})(),me(()=>me(()=>r()==="details")()&&(()=>{var k=WE(),Z=k.firstChild,U=Z.firstChild,F=U.nextSibling,N=Z.nextSibling,V=N.firstChild,fe=V.nextSibling,z=N.nextSibling,ge=z.firstChild,$=ge.nextSibling,O=z.nextSibling,X=O.firstChild,Y=X.nextSibling,ue=O.nextSibling,re=ue.firstChild,M=re.nextSibling,oe=ue.nextSibling,pe=oe.firstChild,be=pe.nextSibling,ne=oe.nextSibling,le=ne.firstChild,j=le.nextSibling,ce=ne.nextSibling,D=ce.firstChild,J=D.firstChild,ee=J.nextSibling,q=D.nextSibling;return s(U,()=>e("common.date")),s(F,()=>_(y.date)),s(V,()=>e("journal.reference")),s(fe,()=>y.reference||e("common.notAvailable","N/A")),s(ge,()=>e("journal.totalDebit")),s($,()=>I(y.totalDebit)),s(X,()=>e("journal.totalCredit")),s(Y,()=>I(y.totalCredit)),s(re,()=>e("journal.balanceStatus","Balance Status")),s(M,()=>G?`${e("journal.balanced")} ✓`:`${e("journal.unbalanced","Unbalanced")} (${I(Math.abs(y.totalDebit-y.totalCredit))} ${e("journal.difference","difference")})`),s(pe,()=>e("journal.createdBy")),s(be,()=>y.createdBy),s(le,()=>e("journal.createdAt","Created At")),s(j,()=>v(y.createdAt)),s(k,(()=>{var B=me(()=>!!y.postedAt);return()=>B()&&(()=>{var _e=Tl(),we=_e.firstChild,ie=we.nextSibling;return s(we,()=>e("journal.postedAt","Posted At")),s(ie,()=>v(y.postedAt)),se(ve=>{var K=C,Pe=R,Te=E;return ve.e=d(_e,K,ve.e),ve.t=d(we,Pe,ve.t),ve.a=d(ie,Te,ve.a),ve},{e:void 0,t:void 0,a:void 0}),_e})()})(),ce),ce.style.setProperty("margin-top","2rem"),ce.style.setProperty("padding-top","1rem"),ce.style.setProperty("border-top","2px solid var(--border-color)"),D.style.setProperty("display","flex"),D.style.setProperty("justify-content","space-between"),D.style.setProperty("align-items","center"),D.style.setProperty("margin-bottom","1rem"),J.style.setProperty("margin","0"),J.style.setProperty("font-size","1rem"),s(J,()=>e("journal.quickActions","Quick Actions")),ee.style.setProperty("display","flex"),ee.style.setProperty("gap","0.5rem"),s(ee,S(De,{variant:"primary",size:"sm",onClick:P,get children(){return["✏️ ",me(()=>e("journal.editEntry"))]}}),null),s(ee,(()=>{var B=me(()=>y.status==="draft");return()=>B()&&S(De,{variant:"outline",size:"sm",onClick:w,disabled:!G,style:{"border-color":G?"#4caf50":"#f44336",color:G?"#4caf50":"#f44336"},get children(){return G?`✓ ${e("journal.postEntry","Post Entry")}`:`⚠️ ${e("journal.fixBalance","Fix Balance")}`}})})(),null),s(ee,(()=>{var B=me(()=>y.status==="posted");return()=>B()&&S(De,{variant:"outline",size:"sm",onClick:A,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return["🗑️ ",me(()=>e("journal.voidEntry","Void Entry"))]}})})(),null),q.style.setProperty("padding","1rem"),q.style.setProperty("border-radius","var(--border-radius-sm)"),q.style.setProperty("font-size","0.875rem"),s(q,(()=>{var B=me(()=>y.status==="draft");return()=>B()&&(()=>{var _e=$l(),we=_e.firstChild,ie=we.firstChild;return we.nextSibling,s(we,()=>e("journal.draftEntry","Draft Entry"),ie),s(_e,()=>e("journal.draftEntryDescription","This entry can be edited and posted."),null),s(_e,()=>!G&&` ⚠️ ${e("journal.entryMustBeBalancedBeforePosting","Entry must be balanced before posting.")}`,null),_e})()})(),null),s(q,(()=>{var B=me(()=>y.status==="posted");return()=>B()&&(()=>{var _e=$l(),we=_e.firstChild,ie=we.firstChild;return we.nextSibling,s(we,()=>e("journal.postedEntry","Posted Entry"),ie),s(_e,()=>e("journal.postedEntryDescription","This entry has been posted to the general ledger. Editing will create a new draft copy."),null),_e})()})(),null),s(q,(()=>{var B=me(()=>y.status==="void");return()=>B()&&(()=>{var _e=$l(),we=_e.firstChild,ie=we.firstChild;return we.nextSibling,s(we,()=>e("journal.voidEntry"),ie),s(_e,()=>e("journal.voidEntryDescription","This entry has been voided and cannot be modified."),null),_e})()})(),null),se(B=>{var _e=C,we=R,ie=E,ve=C,K=R,Pe=E,Te=C,xe=R,$e=E,Oe=C,Qe=R,Ue=E,Ie=C,Me=R,qe={...E,color:G?"#4caf50":"#f44336"},He=C,Ge=R,Ae=E,ot=C,et=R,pt=E,yt=y.status==="draft"?"#fff3cd":y.status==="posted"?"#d4edda":"#f8d7da";return B.e=d(Z,_e,B.e),B.t=d(U,we,B.t),B.a=d(F,ie,B.a),B.o=d(N,ve,B.o),B.i=d(V,K,B.i),B.n=d(fe,Pe,B.n),B.s=d(z,Te,B.s),B.h=d(ge,xe,B.h),B.r=d($,$e,B.r),B.d=d(O,Oe,B.d),B.l=d(X,Qe,B.l),B.u=d(Y,Ue,B.u),B.c=d(ue,Ie,B.c),B.w=d(re,Me,B.w),B.m=d(M,qe,B.m),B.f=d(oe,He,B.f),B.y=d(pe,Ge,B.y),B.g=d(be,Ae,B.g),B.p=d(ne,ot,B.p),B.b=d(le,et,B.b),B.T=d(j,pt,B.T),yt!==B.A&&((B.A=yt)!=null?q.style.setProperty("background",yt):q.style.removeProperty("background")),B},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),k})()),me(()=>me(()=>r()==="lines")()&&(()=>{var k=GE(),Z=k.firstChild,U=Z.firstChild,F=U.nextSibling,N=F.nextSibling,V=N.nextSibling,fe=V.nextSibling,z=Z.nextSibling,ge=z.firstChild,$=ge.firstChild,O=$.firstChild;$.nextSibling;var X=ge.nextSibling,Y=X.firstChild,ue=Y.firstChild;Y.nextSibling;var re=X.nextSibling,M=z.nextSibling,oe=M.firstChild,pe=oe.nextSibling,be=pe.firstChild,ne=be.firstChild,le=ne.firstChild;le.nextSibling;var j=ne.nextSibling,ce=j.firstChild;ce.nextSibling;var D=j.nextSibling,J=D.firstChild;J.nextSibling;var ee=be.nextSibling,q=ee.firstChild,B=q.firstChild;B.nextSibling;var _e=q.nextSibling,we=_e.firstChild;return we.nextSibling,s(U,()=>e("journal.account")),s(F,()=>e("common.description")),s(N,()=>e("journal.debit")),s(V,()=>e("journal.credit")),s(fe,()=>e("banking.reconciliation")),s(k,S(Ot,{get each(){return y.lines},children:ie=>(()=>{var ve=YE(),K=ve.firstChild,Pe=K.firstChild,Te=Pe.nextSibling,xe=K.nextSibling,$e=xe.nextSibling,Oe=$e.nextSibling,Qe=Oe.nextSibling;return Pe.style.setProperty("font-weight","500"),s(Pe,()=>ie.accountName),Te.style.setProperty("font-size","0.75rem"),Te.style.setProperty("color","var(--text-muted)"),s(Te,()=>ut.getAccountById(ie.accountId)?.accountNumber||ie.accountId),xe.style.setProperty("font-size","0.875rem"),s(xe,()=>ie.description||"-"),$e.style.setProperty("font-weight","600"),s($e,(()=>{var Ue=me(()=>ie.debitAmount>0);return()=>Ue()?I(ie.debitAmount):"-"})()),Oe.style.setProperty("font-weight","600"),s(Oe,(()=>{var Ue=me(()=>ie.creditAmount>0);return()=>Ue()?I(ie.creditAmount):"-"})()),s(Qe,(()=>{var Ue=me(()=>!!ie.reconciled);return()=>Ue()?(()=>{var Ie=KE(),Me=Ie.firstChild;return Me.firstChild,Ie.style.setProperty("display","flex"),Ie.style.setProperty("align-items","center"),Ie.style.setProperty("gap","0.5rem"),Ie.style.setProperty("color","#4caf50"),Ie.style.setProperty("font-size","0.875rem"),Me.style.setProperty("font-weight","600"),s(Me,()=>e("banking.reconciled"),null),s(Ie,(()=>{var qe=me(()=>!!ie.reconciledWith);return()=>qe()&&(()=>{var He=QE(),Ge=He.firstChild,Ae=Ge.nextSibling;return Ae.nextSibling,He.style.setProperty("font-size","0.75rem"),He.style.setProperty("color","var(--text-muted)"),He.style.setProperty("font-style","italic"),s(He,()=>ie.reconciledWith,Ae),He})()})(),null),Ie})():(()=>{var Ie=Gh();return Ie.style.setProperty("color","var(--text-muted)"),Ie.style.setProperty("font-size","0.875rem"),s(Ie,()=>e("banking.notReconciled","Not Reconciled")),Ie})()})()),se(Ue=>{var Ie=W,Me=ie.debitAmount>0?"#4caf50":"var(--text-muted)",qe=ie.creditAmount>0?"#f44336":"var(--text-muted)";return Ue.e=d(ve,Ie,Ue.e),Me!==Ue.t&&((Ue.t=Me)!=null?$e.style.setProperty("color",Me):$e.style.removeProperty("color")),qe!==Ue.a&&((Ue.a=qe)!=null?Oe.style.setProperty("color",qe):Oe.style.removeProperty("color")),Ue},{e:void 0,t:void 0,a:void 0}),ve})()}),z),d(z,Q),s($,()=>e("journal.totalDebit"),O),s(ge,()=>I(y.totalDebit),null),s(Y,()=>e("journal.totalCredit"),ue),s(X,()=>I(y.totalCredit),null),(G?"#4caf50":"#f44336")!=null?re.style.setProperty("color",G?"#4caf50":"#f44336"):re.style.removeProperty("color"),re.style.setProperty("font-weight","600"),s(re,()=>G?`✓ ${e("journal.balanced")}`:`⚠️ ${e("journal.notBalanced","Not Balanced")}`),M.style.setProperty("margin-top","1rem"),M.style.setProperty("padding","1rem"),M.style.setProperty("border-radius","var(--border-radius-sm)"),M.style.setProperty("font-size","0.875rem"),oe.style.setProperty("margin-bottom","0.5rem"),pe.style.setProperty("display","grid"),pe.style.setProperty("grid-template-columns","1fr 1fr"),pe.style.setProperty("gap","1rem"),ne.style.setProperty("margin-bottom","0.25rem"),s(ne,()=>y.lines.length,null),j.style.setProperty("margin-bottom","0.25rem"),j.style.setProperty("color","#4caf50"),s(j,()=>y.lines.filter(ie=>ie.reconciled).length,null),D.style.setProperty("color","#f44336"),s(D,()=>y.lines.filter(ie=>!ie.reconciled).length,null),q.style.setProperty("margin-bottom","0.25rem"),s(q,()=>y.lines.filter(ie=>["1001","1002","1003"].includes(ie.accountId)).length,null),_e.style.setProperty("margin-bottom","0.25rem"),_e.style.setProperty("color","#4caf50"),s(_e,()=>y.lines.filter(ie=>["1001","1002","1003"].includes(ie.accountId)&&ie.reconciled).length,null),s(ee,(()=>{var ie=me(()=>y.lines.filter(ve=>["1001","1002","1003"].includes(ve.accountId)&&!ve.reconciled).length>0);return()=>ie()&&(()=>{var ve=JE(),K=ve.firstChild;return K.nextSibling,ve.style.setProperty("color","#f44336"),s(ve,()=>y.lines.filter(Pe=>["1001","1002","1003"].includes(Pe.accountId)&&!Pe.reconciled).length,null),ve})()})(),null),s(M,(()=>{var ie=me(()=>y.lines.filter(ve=>ve.reconciled).length>0);return()=>ie()&&(()=>{var ve=XE(),K=ve.firstChild;return ve.style.setProperty("margin-top","0.75rem"),ve.style.setProperty("padding-top","0.75rem"),ve.style.setProperty("border-top","1px solid var(--border-color)"),K.style.setProperty("margin-bottom","0.5rem"),K.style.setProperty("font-weight","500"),s(ve,()=>y.lines.filter(Pe=>Pe.reconciled).map(Pe=>(()=>{var Te=Tl(),xe=Te.firstChild,$e=xe.nextSibling;return Te.style.setProperty("display","flex"),Te.style.setProperty("justify-content","space-between"),Te.style.setProperty("margin-bottom","0.25rem"),Te.style.setProperty("font-size","0.8rem"),s(xe,()=>Pe.accountName),$e.style.setProperty("color","var(--text-muted)"),s($e,()=>Pe.reconciledWith?`→ ${Pe.reconciledWith}`:"Manual"),Te})()),null),ve})()})(),null),s(M,(()=>{var ie=me(()=>y.lines.filter(ve=>!ve.reconciled&&["1001","1002","1003"].includes(ve.accountId)).length>0);return()=>ie()&&(()=>{var ve=ZE(),K=ve.firstChild,Pe=K.nextSibling;return ve.style.setProperty("margin-top","0.75rem"),ve.style.setProperty("padding-top","0.75rem"),ve.style.setProperty("border-top","1px solid var(--border-color)"),K.style.setProperty("margin-bottom","0.5rem"),K.style.setProperty("font-weight","500"),K.style.setProperty("color","#f44336"),s(ve,()=>y.lines.filter(Te=>!Te.reconciled&&["1001","1002","1003"].includes(Te.accountId)).map(Te=>(()=>{var xe=Tl(),$e=xe.firstChild,Oe=$e.nextSibling;return xe.style.setProperty("display","flex"),xe.style.setProperty("justify-content","space-between"),xe.style.setProperty("margin-bottom","0.25rem"),xe.style.setProperty("font-size","0.8rem"),xe.style.setProperty("color","#f44336"),s($e,()=>Te.accountName),s(Oe,()=>I(Te.debitAmount||Te.creditAmount)),xe})()),Pe),Pe.style.setProperty("margin-top","0.5rem"),Pe.style.setProperty("font-size","0.75rem"),Pe.style.setProperty("color","var(--text-muted)"),Pe.style.setProperty("font-style","italic"),ve})()})(),null),se(ie=>{var ve=te,K=y.lines.some(Pe=>Pe.reconciled)?"#e8f5e8":"#fff3cd";return ie.e=d(Z,ve,ie.e),K!==ie.t&&((ie.t=K)!=null?M.style.setProperty("background",K):M.style.removeProperty("background")),ie},{e:void 0,t:void 0}),k})()),me(()=>me(()=>r()==="reconciliation")()&&(()=>{var k=ex(),Z=k.firstChild,U=Z.firstChild,F=U.firstChild,N=F.nextSibling,V=U.nextSibling,fe=V.firstChild,z=fe.firstChild,ge=z.nextSibling,$=fe.nextSibling,O=$.firstChild,X=O.nextSibling,Y=$.nextSibling,ue=Y.firstChild,re=ue.nextSibling;return Z.style.setProperty("margin-bottom","1.5rem"),Z.style.setProperty("padding","1rem"),Z.style.setProperty("border-radius","var(--border-radius)"),Z.style.setProperty("border","1px solid var(--border-color)"),U.style.setProperty("display","flex"),U.style.setProperty("align-items","center"),U.style.setProperty("gap","0.5rem"),U.style.setProperty("margin-bottom","1rem"),F.style.setProperty("font-size","1.5rem"),s(F,(()=>{var M=me(()=>!!y.lines.every(oe=>oe.reconciled));return()=>M()?"✅":y.lines.some(oe=>oe.reconciled)?"🔄":"⏳"})()),N.style.setProperty("margin","0"),N.style.setProperty("font-size","1.2rem"),s(N,(()=>{var M=me(()=>!!y.lines.every(oe=>oe.reconciled));return()=>M()?"Fully Reconciled":y.lines.some(oe=>oe.reconciled)?"Partially Reconciled":"Unreconciled"})()),V.style.setProperty("display","grid"),V.style.setProperty("grid-template-columns","1fr 1fr 1fr"),V.style.setProperty("gap","1rem"),fe.style.setProperty("text-align","center"),z.style.setProperty("font-size","2rem"),z.style.setProperty("font-weight","700"),z.style.setProperty("color","var(--primary-color)"),s(z,()=>y.lines.length),ge.style.setProperty("font-size","0.875rem"),ge.style.setProperty("color","var(--text-muted)"),$.style.setProperty("text-align","center"),O.style.setProperty("font-size","2rem"),O.style.setProperty("font-weight","700"),O.style.setProperty("color","#4caf50"),s(O,()=>y.lines.filter(M=>M.reconciled).length),X.style.setProperty("font-size","0.875rem"),X.style.setProperty("color","var(--text-muted)"),Y.style.setProperty("text-align","center"),ue.style.setProperty("font-size","2rem"),ue.style.setProperty("font-weight","700"),ue.style.setProperty("color","#f44336"),s(ue,()=>y.lines.filter(M=>!M.reconciled).length),re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),s(k,(()=>{var M=me(()=>y.lines.filter(oe=>oe.reconciled).length>0);return()=>M()&&(()=>{var oe=tx(),pe=oe.firstChild,be=pe.firstChild,ne=be.nextSibling;return ne.nextSibling,oe.style.setProperty("margin-bottom","1.5rem"),pe.style.setProperty("margin","0 0 1rem 0"),pe.style.setProperty("font-size","1.1rem"),pe.style.setProperty("color","#4caf50"),pe.style.setProperty("display","flex"),pe.style.setProperty("align-items","center"),pe.style.setProperty("gap","0.5rem"),s(pe,()=>y.lines.filter(le=>le.reconciled).length,ne),s(oe,()=>y.lines.filter(le=>le.reconciled).map(le=>(()=>{var j=rx(),ce=j.firstChild,D=ce.firstChild,J=D.nextSibling,ee=ce.nextSibling,q=ee.nextSibling,B=q.nextSibling,_e=B.nextSibling,we=_e.firstChild;return j.style.setProperty("display","grid"),j.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),j.style.setProperty("gap","1rem"),j.style.setProperty("padding","0.75rem"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("background","#f0f9f0"),j.style.setProperty("border-radius","var(--border-radius-sm)"),j.style.setProperty("align-items","center"),j.style.setProperty("font-size","0.875rem"),D.style.setProperty("font-weight","500"),s(D,()=>le.accountName),J.style.setProperty("font-size","0.75rem"),J.style.setProperty("color","var(--text-muted)"),s(J,()=>ut.getAccountById(le.accountId)?.accountNumber),ee.style.setProperty("color","var(--text-muted)"),s(ee,()=>le.description||"No description"),q.style.setProperty("font-weight","600"),s(q,(()=>{var ie=me(()=>le.debitAmount>0);return()=>ie()?I(le.debitAmount):"-"})()),B.style.setProperty("font-weight","600"),s(B,(()=>{var ie=me(()=>le.creditAmount>0);return()=>ie()?I(le.creditAmount):"-"})()),_e.style.setProperty("color","#4caf50"),we.style.setProperty("font-weight","500"),s(_e,(()=>{var ie=me(()=>!!le.reconciledWith);return()=>ie()&&(()=>{var ve=nx();return ve.firstChild,ve.style.setProperty("font-size","0.75rem"),ve.style.setProperty("font-style","italic"),s(ve,()=>le.reconciledWith,null),ve})()})(),null),se(ie=>{var ve=le.debitAmount>0?"#4caf50":"var(--text-muted)",K=le.creditAmount>0?"#f44336":"var(--text-muted)";return ve!==ie.e&&((ie.e=ve)!=null?q.style.setProperty("color",ve):q.style.removeProperty("color")),K!==ie.t&&((ie.t=K)!=null?B.style.setProperty("color",K):B.style.removeProperty("color")),ie},{e:void 0,t:void 0}),j})()),null),oe})()})(),null),s(k,(()=>{var M=me(()=>y.lines.filter(oe=>!oe.reconciled).length>0);return()=>M()&&(()=>{var oe=ix(),pe=oe.firstChild,be=pe.firstChild,ne=be.nextSibling;return ne.nextSibling,oe.style.setProperty("margin-bottom","1.5rem"),pe.style.setProperty("margin","0 0 1rem 0"),pe.style.setProperty("font-size","1.1rem"),pe.style.setProperty("color","#f44336"),pe.style.setProperty("display","flex"),pe.style.setProperty("align-items","center"),pe.style.setProperty("gap","0.5rem"),s(pe,()=>y.lines.filter(le=>!le.reconciled).length,ne),s(oe,()=>y.lines.filter(le=>!le.reconciled).map(le=>(()=>{var j=ox(),ce=j.firstChild,D=ce.firstChild,J=D.nextSibling,ee=ce.nextSibling,q=ee.nextSibling,B=q.nextSibling,_e=B.nextSibling,we=_e.firstChild;return j.style.setProperty("display","grid"),j.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),j.style.setProperty("gap","1rem"),j.style.setProperty("padding","0.75rem"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("background","#fff9f0"),j.style.setProperty("border-radius","var(--border-radius-sm)"),j.style.setProperty("align-items","center"),j.style.setProperty("font-size","0.875rem"),j.style.setProperty("border","1px solid #ffe0b3"),D.style.setProperty("font-weight","500"),s(D,()=>le.accountName),J.style.setProperty("font-size","0.75rem"),J.style.setProperty("color","var(--text-muted)"),s(J,()=>ut.getAccountById(le.accountId)?.accountNumber),ee.style.setProperty("color","var(--text-muted)"),s(ee,()=>le.description||"No description"),q.style.setProperty("font-weight","600"),s(q,(()=>{var ie=me(()=>le.debitAmount>0);return()=>ie()?I(le.debitAmount):"-"})()),B.style.setProperty("font-weight","600"),s(B,(()=>{var ie=me(()=>le.creditAmount>0);return()=>ie()?I(le.creditAmount):"-"})()),_e.style.setProperty("color","#f44336"),we.style.setProperty("font-weight","500"),s(_e,(()=>{var ie=me(()=>!!["1001","1002","1003"].includes(le.accountId));return()=>ie()&&(()=>{var ve=sx();return ve.style.setProperty("font-size","0.75rem"),ve.style.setProperty("font-style","italic"),ve})()})(),null),se(ie=>{var ve=le.debitAmount>0?"#4caf50":"var(--text-muted)",K=le.creditAmount>0?"#f44336":"var(--text-muted)";return ve!==ie.e&&((ie.e=ve)!=null?q.style.setProperty("color",ve):q.style.removeProperty("color")),K!==ie.t&&((ie.t=K)!=null?B.style.setProperty("color",K):B.style.removeProperty("color")),ie},{e:void 0,t:void 0}),j})()),null),s(oe,(()=>{var le=me(()=>y.lines.filter(j=>!j.reconciled&&["1001","1002","1003"].includes(j.accountId)).length>0);return()=>le()&&(()=>{var j=ax(),ce=j.firstChild,D=ce.nextSibling;return j.style.setProperty("padding","0.75rem"),j.style.setProperty("background","#ffebee"),j.style.setProperty("border-radius","var(--border-radius-sm)"),j.style.setProperty("margin-top","1rem"),j.style.setProperty("border","1px solid #ffcdd2"),ce.style.setProperty("font-weight","500"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("color","#f44336"),D.style.setProperty("font-size","0.875rem"),D.style.setProperty("color","var(--text-muted)"),j})()})(),null),oe})()})(),null),se(M=>(M=y.lines.every(oe=>oe.reconciled)?"#e8f5e8":y.lines.some(oe=>oe.reconciled)?"#fff3cd":"#ffebee")!=null?Z.style.setProperty("background",M):Z.style.removeProperty("background")),k})()),(()=>{var k=Gh();return d(k,de),s(k,S(De,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(k,S(De,{variant:"primary",onClick:P,get children(){return e("journal.editEntry")}}),null),s(k,(()=>{var Z=me(()=>y.status==="draft");return()=>Z()&&S(De,{variant:"outline",onClick:w,disabled:!G,style:{"border-color":"#4caf50",color:G?"#4caf50":"var(--text-muted)"},get children(){return G?e("journal.postEntry","Post Entry"):e("journal.entryNotBalanced","Entry Not Balanced")}})})(),null),s(k,(()=>{var Z=me(()=>y.status==="posted");return()=>Z()&&S(De,{variant:"outline",onClick:A,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return e("journal.voidEntry","Void Entry")}})})(),null),k})()]})()}}),me(()=>me(()=>!!a())()&&S(Yy,{get isOpen(){return i()},onClose:()=>{o(!1)},get editEntry(){return a()}}))]};wt(["click"]);var cx=H("<div><div><h2></h2><p></p></div><div>"),gn=H("<div>"),ux=H("<div> <!> • <!> "),dx=H("<div><div><label></label></div><div><label></label></div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label></div><div>"),hx=H("<div><span>:</span><span> "),Fs=H("<span>: "),mx=H("<div><br>");const fx=()=>{const{t}=it(),[e,r]=ye(!1),[n,i]=ye(null),[o,a]=ye(!1),[c,u]=ye(null),[h,f]=ye("all"),[p,b]=ye("all"),[C,R]=ye(""),[E,x]=ye(""),[T,W]=ye("date"),[te,Q]=ye("desc"),de={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},ae={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)","flex-wrap":"wrap"},I={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem"},_={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(400px, 1fr))",gap:"1.5rem"},v=()=>[{value:"all",label:t("journal.allEntries","All Entries")},{value:"draft",label:t("journal.draft")},{value:"posted",label:t("journal.posted")},{value:"void",label:t("entryBooks.void","Void")}],P=()=>[{value:"all",label:t("accounts.allAccounts","All Accounts")},...ut.accounts.map(N=>({value:N.id,label:`${N.accountNumber} - ${N.name}`}))],w=()=>[{value:"date",label:t("common.date")},{value:"entryNumber",label:t("journal.entryNumber")},{value:"amount",label:t("common.amount")}],A=()=>{let N=Sn.journalEntries;return h()!=="all"&&(N=N.filter(V=>V.status===h())),p()!=="all"&&(N=N.filter(V=>V.lines.some(fe=>fe.accountId===p()))),C()&&(N=N.filter(V=>V.date>=C())),E()&&(N=N.filter(V=>V.date<=E())),N=[...N].sort((V,fe)=>{let z=0;switch(T()){case"date":z=new Date(V.date).getTime()-new Date(fe.date).getTime();break;case"entryNumber":z=V.entryNumber.localeCompare(fe.entryNumber);break;case"amount":z=V.totalDebit-fe.totalDebit;break}return te()==="asc"?z:-z}),N},y=()=>{const N=Sn.journalEntries,V=N.filter(X=>X.status==="draft"),fe=N.filter(X=>X.status==="posted"),z=N.filter(X=>X.status==="void"),ge=fe.reduce((X,Y)=>X+Y.totalDebit,0),$=fe.reduce((X,Y)=>X+Y.totalCredit,0),O=N.filter(X=>X.lines.some(Y=>["1001","1002","1003"].includes(Y.accountId)&&!Y.reconciled)).length;return{totalEntries:N.length,draftEntries:V.length,postedEntries:fe.length,voidEntries:z.length,totalDebit:ge,totalCredit:$,unreconciledEntries:O}},he=N=>{u(N.id),a(!0)},G=()=>{i(null),r(!0)},k=()=>{r(!1),i(null)},Z=N=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(N),U=y(),F=A();return S(Ur,{get title(){return t("entryBooks.title")},get children(){return[(()=>{var N=cx(),V=N.firstChild,fe=V.firstChild,z=fe.nextSibling,ge=V.nextSibling;return d(N,de),fe.style.setProperty("margin","0 0 0.5rem 0"),fe.style.setProperty("font-size","1.5rem"),s(fe,()=>t("journal.title")),z.style.setProperty("margin","0"),z.style.setProperty("color","var(--text-muted)"),s(z,()=>t("entryBooks.subtitle","Manage accounting entries and general ledger records")),ge.style.setProperty("display","flex"),ge.style.setProperty("gap","1rem"),s(ge,S(De,{variant:"secondary",onClick:()=>window.location.href="/bank-consolidations",get children(){return t("entryBooks.viewReconciliation","View Reconciliation")}}),null),s(ge,S(De,{variant:"primary",onClick:G,get children(){return t("journal.addEntry","Add Journal Entry")}}),null),N})(),(()=>{var N=gn();return d(N,I),s(N,S(Ke,{get title(){return t("entryBooks.totalEntries","Total Entries")},get subtitle(){return t("entryBooks.allJournalEntries","All journal entries")},get children(){return[(()=>{var V=gn();return V.style.setProperty("font-size","1.5rem"),V.style.setProperty("font-weight","600"),V.style.setProperty("color","var(--primary-color)"),V.style.setProperty("margin-bottom","0.5rem"),s(V,()=>U.totalEntries),V})(),(()=>{var V=ux(),fe=V.firstChild,z=fe.nextSibling,ge=z.nextSibling,$=ge.nextSibling;return $.nextSibling,V.style.setProperty("font-size","0.875rem"),V.style.setProperty("color","var(--text-muted)"),s(V,()=>U.postedEntries,fe),s(V,()=>t("journal.posted").toLowerCase(),z),s(V,()=>U.draftEntries,$),s(V,()=>t("journal.draft").toLowerCase(),null),s(V,(()=>{var O=me(()=>U.voidEntries>0);return()=>O()&&` • ${U.voidEntries} ${t("entryBooks.void","void").toLowerCase()}`})(),null),V})()]}}),null),s(N,S(Ke,{get title(){return t("journal.totalDebits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var V=gn();return V.style.setProperty("font-size","1.5rem"),V.style.setProperty("font-weight","600"),V.style.setProperty("color","#4caf50"),V.style.setProperty("margin-bottom","0.5rem"),s(V,()=>Z(U.totalDebit)),V})(),(()=>{var V=gn();return V.style.setProperty("font-size","0.875rem"),V.style.setProperty("color","var(--text-muted)"),s(V,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",U.postedEntries.toString())),V})()]}}),null),s(N,S(Ke,{get title(){return t("journal.totalCredits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var V=gn();return V.style.setProperty("font-size","1.5rem"),V.style.setProperty("font-weight","600"),V.style.setProperty("color","#f44336"),V.style.setProperty("margin-bottom","0.5rem"),s(V,()=>Z(U.totalCredit)),V})(),(()=>{var V=gn();return V.style.setProperty("font-size","0.875rem"),V.style.setProperty("color","var(--text-muted)"),s(V,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",U.postedEntries.toString())),V})()]}}),null),s(N,S(Ke,{get title(){return t("banking.unreconciled","Unreconciled")},get subtitle(){return t("banking.title")},get children(){return[(()=>{var V=gn();return V.style.setProperty("font-size","1.5rem"),V.style.setProperty("font-weight","600"),V.style.setProperty("margin-bottom","0.5rem"),s(V,()=>U.unreconciledEntries),se(fe=>(fe=U.unreconciledEntries>0?"#ff9800":"#4caf50")!=null?V.style.setProperty("color",fe):V.style.removeProperty("color")),V})(),(()=>{var V=gn();return V.style.setProperty("font-size","0.875rem"),V.style.setProperty("color","var(--text-muted)"),s(V,(()=>{var fe=me(()=>U.unreconciledEntries>0);return()=>fe()?t("entryBooks.needBankReconciliation","Need bank reconciliation"):t("entryBooks.allReconciled","All reconciled")})()),V})()]}}),null),N})(),(()=>{var N=dx(),V=N.firstChild,fe=V.firstChild,z=V.nextSibling,ge=z.firstChild,$=z.nextSibling,O=$.firstChild,X=$.nextSibling,Y=X.firstChild,ue=Y.nextSibling,re=X.nextSibling,M=re.firstChild,oe=M.nextSibling,pe=re.nextSibling,be=pe.firstChild,ne=pe.nextSibling;return d(N,ae),V.style.setProperty("min-width","150px"),fe.style.setProperty("display","block"),fe.style.setProperty("margin-bottom","0.5rem"),fe.style.setProperty("font-weight","500"),fe.style.setProperty("font-size","0.875rem"),s(fe,()=>t("common.status")),s(V,S(mr,{label:"",get value(){return h()},onChange:f,get options(){return v()}}),null),z.style.setProperty("min-width","200px"),ge.style.setProperty("display","block"),ge.style.setProperty("margin-bottom","0.5rem"),ge.style.setProperty("font-weight","500"),ge.style.setProperty("font-size","0.875rem"),s(ge,()=>t("journal.account")),s(z,S(mr,{label:"",get value(){return p()},onChange:b,get options(){return P()}}),null),$.style.setProperty("min-width","120px"),O.style.setProperty("display","block"),O.style.setProperty("margin-bottom","0.5rem"),O.style.setProperty("font-weight","500"),O.style.setProperty("font-size","0.875rem"),s(O,()=>t("entryBooks.sortBy","Sort By")),s($,S(mr,{label:"",get value(){return T()},onChange:W,get options(){return w()}}),null),X.style.setProperty("min-width","130px"),Y.style.setProperty("display","block"),Y.style.setProperty("margin-bottom","0.5rem"),Y.style.setProperty("font-weight","500"),Y.style.setProperty("font-size","0.875rem"),s(Y,()=>t("entryBooks.fromDate","From Date")),ue.addEventListener("change",le=>R(le.target.value)),ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("border","1px solid var(--border-color)"),ue.style.setProperty("border-radius","var(--border-radius-sm)"),ue.style.setProperty("font-family","inherit"),ue.style.setProperty("width","100%"),re.style.setProperty("min-width","130px"),M.style.setProperty("display","block"),M.style.setProperty("margin-bottom","0.5rem"),M.style.setProperty("font-weight","500"),M.style.setProperty("font-size","0.875rem"),s(M,()=>t("entryBooks.toDate","To Date")),oe.addEventListener("change",le=>x(le.target.value)),oe.style.setProperty("padding","0.75rem"),oe.style.setProperty("border","1px solid var(--border-color)"),oe.style.setProperty("border-radius","var(--border-radius-sm)"),oe.style.setProperty("font-family","inherit"),oe.style.setProperty("width","100%"),pe.style.setProperty("min-width","100px"),be.style.setProperty("display","block"),be.style.setProperty("margin-bottom","0.5rem"),be.style.setProperty("font-weight","500"),be.style.setProperty("font-size","0.875rem"),s(be,()=>t("entryBooks.order","Order")),s(pe,S(mr,{label:"",get value(){return te()},onChange:Q,get options(){return[{value:"desc",label:t("entryBooks.newest","Newest")},{value:"asc",label:t("entryBooks.oldest","Oldest")}]}}),null),ne.style.setProperty("display","flex"),ne.style.setProperty("align-items","end"),ne.style.setProperty("gap","0.5rem"),s(ne,S(De,{variant:"outline",size:"sm",onClick:()=>{f("all"),b("all"),R(""),x(""),W("date"),Q("desc")},get children(){return t("entryBooks.resetFilters","Reset Filters")}})),se(()=>ue.value=C()),se(()=>oe.value=E()),N})(),me(()=>me(()=>!!(h()!=="all"||p()!=="all"||C()||E()))()&&(()=>{var N=hx(),V=N.firstChild,fe=V.firstChild,z=V.nextSibling,ge=z.firstChild;return N.style.setProperty("display","flex"),N.style.setProperty("gap","0.5rem"),N.style.setProperty("align-items","center"),N.style.setProperty("margin-bottom","1rem"),N.style.setProperty("padding","0.75rem"),N.style.setProperty("background","var(--surface-color)"),N.style.setProperty("border-radius","var(--border-radius-sm)"),N.style.setProperty("border","1px solid var(--border-color)"),V.style.setProperty("font-size","0.875rem"),V.style.setProperty("font-weight","500"),s(V,()=>t("entryBooks.activeFilters","Active filters"),fe),s(N,(()=>{var $=me(()=>h()!=="all");return()=>$()&&(()=>{var O=Fs(),X=O.firstChild;return O.style.setProperty("padding","0.25rem 0.5rem"),O.style.setProperty("background","var(--primary-color)"),O.style.setProperty("color","white"),O.style.setProperty("border-radius","12px"),O.style.setProperty("font-size","0.75rem"),s(O,()=>t("common.status"),X),s(O,h,null),O})()})(),z),s(N,(()=>{var $=me(()=>p()!=="all");return()=>$()&&(()=>{var O=Fs(),X=O.firstChild;return O.style.setProperty("padding","0.25rem 0.5rem"),O.style.setProperty("background","var(--primary-color)"),O.style.setProperty("color","white"),O.style.setProperty("border-radius","12px"),O.style.setProperty("font-size","0.75rem"),s(O,()=>t("journal.account"),X),s(O,()=>ut.getAccountById(p())?.name||t("common.unknown","Unknown"),null),O})()})(),z),s(N,(()=>{var $=me(()=>!!C());return()=>$()&&(()=>{var O=Fs(),X=O.firstChild;return O.style.setProperty("padding","0.25rem 0.5rem"),O.style.setProperty("background","var(--primary-color)"),O.style.setProperty("color","white"),O.style.setProperty("border-radius","12px"),O.style.setProperty("font-size","0.75rem"),s(O,()=>t("entryBooks.from","From"),X),s(O,C,null),O})()})(),z),s(N,(()=>{var $=me(()=>!!E());return()=>$()&&(()=>{var O=Fs(),X=O.firstChild;return O.style.setProperty("padding","0.25rem 0.5rem"),O.style.setProperty("background","var(--primary-color)"),O.style.setProperty("color","white"),O.style.setProperty("border-radius","12px"),O.style.setProperty("font-size","0.75rem"),s(O,()=>t("entryBooks.to","To"),X),s(O,E,null),O})()})(),z),z.style.setProperty("margin-left","auto"),z.style.setProperty("font-size","0.875rem"),z.style.setProperty("color","var(--text-muted)"),s(z,()=>F.length,ge),s(z,()=>t("entryBooks.entriesFound","{count} entries found").replace("{count}",F.length.toString()),null),N})()),me(()=>me(()=>F.length===0)()?S(Ke,{get title(){return t("entryBooks.noJournalEntries","No Journal Entries")},get subtitle(){return t("entryBooks.startByCreating","Start by creating your first entry")},get children(){var N=mx(),V=N.firstChild;return N.style.setProperty("text-align","center"),N.style.setProperty("color","var(--text-muted)"),N.style.setProperty("padding","2rem"),s(N,()=>t("entryBooks.noEntriesMatch","No journal entries match your current filters."),V),s(N,S(De,{variant:"primary",style:{"margin-top":"1rem"},onClick:G,get children(){return t("entryBooks.createFirstEntry","Create First Entry")}}),null),N}}):(()=>{var N=gn();return d(N,_),s(N,S(Ot,{each:F,children:V=>S(FE,{entry:V,onViewDetails:he})})),N})()),S(Yy,{get isOpen(){return e()},onClose:k,get editEntry(){return n()}}),S(lx,{get isOpen(){return o()},onClose:()=>{a(!1),u(null)},get entryId(){return c()}})]}})};var Yh=H("<div>"),yx=H("<div>$23,450"),gx=H("<div>$87,230"),px=H("<div>$5,670"),vx=H("<div><div><div><div>INV-2024-001</div><div>Acme Corporation</div></div><div>$5,250.00</div><div></div></div><div><div><div>INV-2024-002</div><div>Tech Solutions Inc.</div></div><div>$3,750.00</div><div></div></div><div><div><div>INV-2024-003</div><div>Global Services Ltd.</div></div><div>$8,900.00</div><div></div></div><div><div><div>INV-2024-004</div><div>StartUp Co.</div></div><div>$2,100.00</div><div>");const bx=()=>{const{t}=it(),e={display:"flex","flex-direction":"column",gap:"1rem"},r={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},n={flex:"1"},i={"font-weight":"600","margin-bottom":"0.25rem"},o={color:"var(--text-muted)","font-size":"0.875rem"},a={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},c=h=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:h==="paid"?"#d4edda":h==="pending"?"#fff3cd":"#f8d7da",color:h==="paid"?"#155724":h==="pending"?"#856404":"#721c24"}),u={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"};return S(Ur,{get title(){return t("invoices.title","Invoices")},get children(){return[(()=>{var h=Yh();return h.style.setProperty("margin-bottom","2rem"),s(h,S(De,{variant:"primary",get children(){return t("invoices.createNew","Create New Invoice")}})),h})(),(()=>{var h=Yh();return d(h,u),s(h,S(Ke,{get title(){return t("invoices.totalOutstanding","Total Outstanding")},get subtitle(){return t("invoices.unpaidInvoices","Unpaid invoices")},get children(){var f=yx();return f.style.setProperty("font-size","1.5rem"),f.style.setProperty("font-weight","600"),f.style.setProperty("color","var(--primary-color)"),f}}),null),s(h,S(Ke,{get title(){return t("invoices.thisMonth","This Month")},get subtitle(){return t("invoices.revenueCollected","Revenue collected")},get children(){var f=gx();return f.style.setProperty("font-size","1.5rem"),f.style.setProperty("font-weight","600"),f.style.setProperty("color","var(--primary-color)"),f}}),null),s(h,S(Ke,{get title(){return t("invoices.overdue","Overdue")},get subtitle(){return t("invoices.pastDueInvoices","Past due invoices")},get children(){var f=px();return f.style.setProperty("font-size","1.5rem"),f.style.setProperty("font-weight","600"),f.style.setProperty("color","var(--primary-color)"),f}}),null),h})(),S(Ke,{get title(){return t("invoices.recentInvoices","Recent Invoices")},get subtitle(){return t("invoices.latestBillingActivity","Latest billing activity")},get children(){var h=vx(),f=h.firstChild,p=f.firstChild,b=p.firstChild,C=b.nextSibling,R=p.nextSibling,E=R.nextSibling,x=f.nextSibling,T=x.firstChild,W=T.firstChild,te=W.nextSibling,Q=T.nextSibling,de=Q.nextSibling,ae=x.nextSibling,I=ae.firstChild,_=I.firstChild,v=_.nextSibling,P=I.nextSibling,w=P.nextSibling,A=ae.nextSibling,y=A.firstChild,he=y.firstChild,G=he.nextSibling,k=y.nextSibling,Z=k.nextSibling;return d(h,e),s(E,()=>t("invoices.paid","Paid")),s(de,()=>t("invoices.pending","Pending")),s(w,()=>t("invoices.overdue","Overdue")),s(Z,()=>t("invoices.paid","Paid")),se(U=>{var F=r,N=n,V=i,fe=o,z=a,ge=c("paid"),$=r,O=n,X=i,Y=o,ue=a,re=c("pending"),M=r,oe=n,pe=i,be=o,ne=a,le=c("overdue"),j=r,ce=n,D=i,J=o,ee=a,q=c("paid");return U.e=d(f,F,U.e),U.t=d(p,N,U.t),U.a=d(b,V,U.a),U.o=d(C,fe,U.o),U.i=d(R,z,U.i),U.n=d(E,ge,U.n),U.s=d(x,$,U.s),U.h=d(T,O,U.h),U.r=d(W,X,U.r),U.d=d(te,Y,U.d),U.l=d(Q,ue,U.l),U.u=d(de,re,U.u),U.c=d(ae,M,U.c),U.w=d(I,oe,U.w),U.m=d(_,pe,U.m),U.f=d(v,be,U.f),U.y=d(P,ne,U.y),U.g=d(w,le,U.g),U.p=d(A,j,U.p),U.b=d(y,ce,U.b),U.T=d(he,D,U.T),U.A=d(G,J,U.A),U.O=d(k,ee,U.O),U.I=d(Z,q,U.I),U},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0}),h}})]}})};var _x=H("<div><main>");const Sx=t=>[S(vw,{}),me(()=>t.children)],Px=()=>S(XP,{get children(){var t=_x(),e=t.firstChild;return s(e,S(gp,{root:Sx,get children(){return[S(Qr,{path:"/",component:Ow}),S(Qr,{path:"/accounts",component:()=>S(fn,{permission:"AccountAccess",featureName:"Accounts",get children(){return S(CC,{})}})}),S(Qr,{path:"/accounts/:id",component:()=>S(fn,{permission:"AccountAccess",featureName:"Account Details",get children(){return S(kC,{})}})}),S(Qr,{path:"/entry-books",component:()=>S(fn,{permission:"JournalAccess",featureName:"Entry Books",get children(){return S(fx,{})}})}),S(Qr,{path:"/employees",component:()=>S(fn,{permission:"EmployeeAccess",featureName:"Employee Management",get children(){return S(iE,{})}})}),S(Qr,{path:"/bank-consolidations",component:()=>S(fn,{permission:"BankingAccess",featureName:"Bank Consolidations",get children(){return S(RE,{})}})}),S(Qr,{path:"/balance-sheet",component:()=>S(fn,{permission:"AccountAccess",featureName:"Balance Sheet",get children(){return S(OC,{})}})}),S(Qr,{path:"/invoices",component:()=>S(fn,{permission:"JournalAccess",featureName:"Invoices",get children(){return S(bx,{})}})}),S(Qr,{path:"/inventory",component:()=>S(fn,{permission:"InventoryAccess",featureName:"Inventory Management",get children(){return S(KI,{})}})}),S(Qr,{path:"/products",component:()=>S(fn,{permission:"InventoryAccess",featureName:"Product Management",get children(){return S(Wy,{})}})})]}})),s(t,(()=>{var r=me(()=>!1);return()=>r()&&S($w,{})})(),null),t}}),wx=document.getElementById("root");kg(()=>S(Px,{}),wx);
