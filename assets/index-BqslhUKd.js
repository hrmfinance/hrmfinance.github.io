(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const rg=!1,ng=(t,e)=>t===e,Jr=Symbol("solid-proxy"),qh=typeof Proxy=="function",Tl=Symbol("solid-track"),ta={equals:ng};let Hh=Zh;const ui=1,ra=2,Wh={owned:null,cleanups:null,context:null,owner:null};var Mt=null;let Xa=null,ig=null,Wt=null,Tr=null,xn=null,Ta=0;function Lo(t,e){const r=Wt,n=Mt,i=t.length===0,o=e===void 0?n:e,a=i?Wh:{owned:null,cleanups:null,context:o?o.context:null,owner:o},c=i?t:()=>t(()=>qr(()=>qo(a)));Mt=a,Wt=null;try{return di(c,!0)}finally{Wt=r,Mt=n}}function fe(t,e){e=e?Object.assign({},ta,e):ta;const r={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},n=i=>(typeof i=="function"&&(i=i(r.value)),Xh(r,i));return[Jh.bind(r),n]}function K(t,e,r){const n=dc(t,e,!1,ui);os(n)}function Ln(t,e,r){Hh=lg;const n=dc(t,e,!1,ui);n.user=!0,xn?xn.push(n):os(n)}function it(t,e,r){r=r?Object.assign({},ta,r):ta;const n=dc(t,e,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=r.equals||void 0,os(n),Jh.bind(n)}function Gh(t){return di(t,!1)}function qr(t){if(Wt===null)return t();const e=Wt;Wt=null;try{return t()}finally{Wt=e}}function lc(t,e,r){const n=Array.isArray(t);let i,o=r&&r.defer;return a=>{let c;if(n){c=Array(t.length);for(let h=0;h<t.length;h++)c[h]=t[h]()}else c=t();if(o)return o=!1,a;const u=qr(()=>e(c,i,a));return i=c,u}}function yn(t){Ln(()=>qr(t))}function ao(t){return Mt===null||(Mt.cleanups===null?Mt.cleanups=[t]:Mt.cleanups.push(t)),t}function $l(){return Wt}function Kh(){return Mt}function Yh(t,e){const r=Mt,n=Wt;Mt=t,Wt=null;try{return di(e,!0)}catch(i){hc(i)}finally{Mt=r,Wt=n}}function og(t){const e=Wt,r=Mt;return Promise.resolve().then(()=>{Wt=e,Mt=r;let n;return di(t,!1),Wt=Mt=null,n?n.done:void 0})}const[vx,bx]=fe(!1);function Qh(t,e){const r=Symbol("context");return{id:r,Provider:ug(r),defaultValue:t}}function cc(t){let e;return Mt&&Mt.context&&(e=Mt.context[t.id])!==void 0?e:t.defaultValue}function uc(t){const e=it(t),r=it(()=>kl(e()));return r.toArray=()=>{const n=r();return Array.isArray(n)?n:n!=null?[n]:[]},r}function Jh(){if(this.sources&&this.state)if(this.state===ui)os(this);else{const t=Tr;Tr=null,di(()=>ia(this),!1),Tr=t}if(Wt){const t=this.observers?this.observers.length:0;Wt.sources?(Wt.sources.push(this),Wt.sourceSlots.push(t)):(Wt.sources=[this],Wt.sourceSlots=[t]),this.observers?(this.observers.push(Wt),this.observerSlots.push(Wt.sources.length-1)):(this.observers=[Wt],this.observerSlots=[Wt.sources.length-1])}return this.value}function Xh(t,e,r){let n=t.value;return(!t.comparator||!t.comparator(n,e))&&(t.value=e,t.observers&&t.observers.length&&di(()=>{for(let i=0;i<t.observers.length;i+=1){const o=t.observers[i],a=Xa&&Xa.running;a&&Xa.disposed.has(o),(a?!o.tState:!o.state)&&(o.pure?Tr.push(o):xn.push(o),o.observers&&em(o)),a||(o.state=ui)}if(Tr.length>1e6)throw Tr=[],new Error},!1)),e}function os(t){if(!t.fn)return;qo(t);const e=Ta;sg(t,t.value,e)}function sg(t,e,r){let n;const i=Mt,o=Wt;Wt=Mt=t;try{n=t.fn(e)}catch(a){return t.pure&&(t.state=ui,t.owned&&t.owned.forEach(qo),t.owned=null),t.updatedAt=r+1,hc(a)}finally{Wt=o,Mt=i}(!t.updatedAt||t.updatedAt<=r)&&(t.updatedAt!=null&&"observers"in t?Xh(t,n):t.value=n,t.updatedAt=r)}function dc(t,e,r,n=ui,i){const o={fn:t,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:Mt,context:Mt?Mt.context:null,pure:r};return Mt===null||Mt!==Wh&&(Mt.owned?Mt.owned.push(o):Mt.owned=[o]),o}function na(t){if(t.state===0)return;if(t.state===ra)return ia(t);if(t.suspense&&qr(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<Ta);)t.state&&e.push(t);for(let r=e.length-1;r>=0;r--)if(t=e[r],t.state===ui)os(t);else if(t.state===ra){const n=Tr;Tr=null,di(()=>ia(t,e[0]),!1),Tr=n}}function di(t,e){if(Tr)return t();let r=!1;e||(Tr=[]),xn?r=!0:xn=[],Ta++;try{const n=t();return ag(r),n}catch(n){r||(xn=null),Tr=null,hc(n)}}function ag(t){if(Tr&&(Zh(Tr),Tr=null),t)return;const e=xn;xn=null,e.length&&di(()=>Hh(e),!1)}function Zh(t){for(let e=0;e<t.length;e++)na(t[e])}function lg(t){let e,r=0;for(e=0;e<t.length;e++){const n=t[e];n.user?t[r++]=n:na(n)}for(e=0;e<r;e++)na(t[e])}function ia(t,e){t.state=0;for(let r=0;r<t.sources.length;r+=1){const n=t.sources[r];if(n.sources){const i=n.state;i===ui?n!==e&&(!n.updatedAt||n.updatedAt<Ta)&&na(n):i===ra&&ia(n,e)}}}function em(t){for(let e=0;e<t.observers.length;e+=1){const r=t.observers[e];r.state||(r.state=ra,r.pure?Tr.push(r):xn.push(r),r.observers&&em(r))}}function qo(t){let e;if(t.sources)for(;t.sources.length;){const r=t.sources.pop(),n=t.sourceSlots.pop(),i=r.observers;if(i&&i.length){const o=i.pop(),a=r.observerSlots.pop();n<i.length&&(o.sourceSlots[a]=n,i[n]=o,r.observerSlots[n]=a)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)qo(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)qo(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function cg(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function hc(t,e=Mt){throw cg(t)}function kl(t){if(typeof t=="function"&&!t.length)return kl(t());if(Array.isArray(t)){const e=[];for(let r=0;r<t.length;r++){const n=kl(t[r]);Array.isArray(n)?e.push.apply(e,n):e.push(n)}return e}return t}function ug(t,e){return function(n){let i;return K(()=>i=qr(()=>(Mt.context={...Mt.context,[t]:n.value},uc(()=>n.children))),void 0),i}}const dg=Symbol("fallback");function Nu(t){for(let e=0;e<t.length;e++)t[e]()}function hg(t,e,r={}){let n=[],i=[],o=[],a=0,c=e.length>1?[]:null;return ao(()=>Nu(o)),()=>{let u=t()||[],h=u.length,f,p;return u[Tl],qr(()=>{let E,A,T,x,$,O,q,z,ee;if(h===0)a!==0&&(Nu(o),o=[],n=[],i=[],a=0,c&&(c=[])),r.fallback&&(n=[dg],i[0]=Lo(Q=>(o[0]=Q,r.fallback())),a=1);else if(a===0){for(i=new Array(h),p=0;p<h;p++)n[p]=u[p],i[p]=Lo(_);a=h}else{for(T=new Array(h),x=new Array(h),c&&($=new Array(h)),O=0,q=Math.min(a,h);O<q&&n[O]===u[O];O++);for(q=a-1,z=h-1;q>=O&&z>=O&&n[q]===u[z];q--,z--)T[z]=i[q],x[z]=o[q],c&&($[z]=c[q]);for(E=new Map,A=new Array(z+1),p=z;p>=O;p--)ee=u[p],f=E.get(ee),A[p]=f===void 0?-1:f,E.set(ee,p);for(f=O;f<=q;f++)ee=n[f],p=E.get(ee),p!==void 0&&p!==-1?(T[p]=i[f],x[p]=o[f],c&&($[p]=c[f]),p=A[p],E.set(ee,p)):o[f]();for(p=O;p<h;p++)p in T?(i[p]=T[p],o[p]=x[p],c&&(c[p]=$[p],c[p](p))):i[p]=Lo(_);i=i.slice(0,a=h),n=u.slice(0)}return i});function _(E){if(o[p]=E,c){const[A,T]=fe(p);return c[p]=T,e(u[p],A)}return e(u[p])}}}function b(t,e){return qr(()=>t(e||{}))}function Is(){return!0}const Rl={get(t,e,r){return e===Jr?r:t.get(e)},has(t,e){return e===Jr?!0:t.has(e)},set:Is,deleteProperty:Is,getOwnPropertyDescriptor(t,e){return{configurable:!0,enumerable:!0,get(){return t.get(e)},set:Is,deleteProperty:Is}},ownKeys(t){return t.keys()}};function Za(t){return(t=typeof t=="function"?t():t)?t:{}}function mg(){for(let t=0,e=this.length;t<e;++t){const r=this[t]();if(r!==void 0)return r}}function Dl(...t){let e=!1;for(let a=0;a<t.length;a++){const c=t[a];e=e||!!c&&Jr in c,t[a]=typeof c=="function"?(e=!0,it(c)):c}if(qh&&e)return new Proxy({get(a){for(let c=t.length-1;c>=0;c--){const u=Za(t[c])[a];if(u!==void 0)return u}},has(a){for(let c=t.length-1;c>=0;c--)if(a in Za(t[c]))return!0;return!1},keys(){const a=[];for(let c=0;c<t.length;c++)a.push(...Object.keys(Za(t[c])));return[...new Set(a)]}},Rl);const r={},n=Object.create(null);for(let a=t.length-1;a>=0;a--){const c=t[a];if(!c)continue;const u=Object.getOwnPropertyNames(c);for(let h=u.length-1;h>=0;h--){const f=u[h];if(f==="__proto__"||f==="constructor")continue;const p=Object.getOwnPropertyDescriptor(c,f);if(!n[f])n[f]=p.get?{enumerable:!0,configurable:!0,get:mg.bind(r[f]=[p.get.bind(c)])}:p.value!==void 0?p:void 0;else{const _=r[f];_&&(p.get?_.push(p.get.bind(c)):p.value!==void 0&&_.push(()=>p.value))}}}const i={},o=Object.keys(n);for(let a=o.length-1;a>=0;a--){const c=o[a],u=n[c];u&&u.get?Object.defineProperty(i,c,u):i[c]=u?u.value:void 0}return i}function fg(t,...e){if(qh&&Jr in t){const i=new Set(e.length>1?e.flat():e[0]),o=e.map(a=>new Proxy({get(c){return a.includes(c)?t[c]:void 0},has(c){return a.includes(c)&&c in t},keys(){return a.filter(c=>c in t)}},Rl));return o.push(new Proxy({get(a){return i.has(a)?void 0:t[a]},has(a){return i.has(a)?!1:a in t},keys(){return Object.keys(t).filter(a=>!i.has(a))}},Rl)),o}const r={},n=e.map(()=>({}));for(const i of Object.getOwnPropertyNames(t)){const o=Object.getOwnPropertyDescriptor(t,i),a=!o.get&&!o.set&&o.enumerable&&o.writable&&o.configurable;let c=!1,u=0;for(const h of e)h.includes(i)&&(c=!0,a?n[u][i]=o.value:Object.defineProperty(n[u],i,o)),++u;c||(a?r[i]=o.value:Object.defineProperty(r,i,o))}return[...n,r]}const yg=t=>`Stale read from <${t}>.`;function jt(t){const e="fallback"in t&&{fallback:()=>t.fallback};return it(hg(()=>t.each,t.children,e||void 0))}function Ge(t){const e=t.keyed,r=it(()=>t.when,void 0,void 0),n=e?r:it(r,void 0,{equals:(i,o)=>!i==!o});return it(()=>{const i=n();if(i){const o=t.children;return typeof o=="function"&&o.length>0?qr(()=>o(e?i:()=>{if(!qr(n))throw yg("Show");return r()})):o}return t.fallback},void 0,void 0)}const gg=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],pg=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline",...gg]),vg=new Set(["innerHTML","textContent","innerText","children"]),bg=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),_g=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}});function Sg(t,e){const r=_g[t];return typeof r=="object"?r[e]?r.$:void 0:r}const Pg=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),oe=t=>it(()=>t());function wg(t,e,r){let n=r.length,i=e.length,o=n,a=0,c=0,u=e[i-1].nextSibling,h=null;for(;a<i||c<o;){if(e[a]===r[c]){a++,c++;continue}for(;e[i-1]===r[o-1];)i--,o--;if(i===a){const f=o<n?c?r[c-1].nextSibling:r[o-c]:u;for(;c<o;)t.insertBefore(r[c++],f)}else if(o===c)for(;a<i;)(!h||!h.has(e[a]))&&e[a].remove(),a++;else if(e[a]===r[o-1]&&r[c]===e[i-1]){const f=e[--i].nextSibling;t.insertBefore(r[c++],e[a++].nextSibling),t.insertBefore(r[--o],f),e[i]=r[o]}else{if(!h){h=new Map;let p=c;for(;p<o;)h.set(r[p],p++)}const f=h.get(e[a]);if(f!=null)if(c<f&&f<o){let p=a,_=1,E;for(;++p<i&&p<o&&!((E=h.get(e[p]))==null||E!==f+_);)_++;if(_>f-c){const A=e[a];for(;c<f;)t.insertBefore(r[c++],A)}else t.replaceChild(r[c++],e[a++])}else a++;else e[a++].remove()}}}const Lu="_$DX_DELEGATE";function Cg(t,e,r,n={}){let i;return Lo(o=>{i=o,e===document?t():s(e,t(),e.firstChild?null:void 0,r)},n.owner),()=>{i(),e.textContent=""}}function U(t,e,r,n){let i;const o=()=>{const c=document.createElement("template");return c.innerHTML=t,c.content.firstChild},a=()=>(i||(i=o())).cloneNode(!0);return a.cloneNode=a,a}function Ot(t,e=window.document){const r=e[Lu]||(e[Lu]=new Set);for(let n=0,i=t.length;n<i;n++){const o=t[n];r.has(o)||(r.add(o),e.addEventListener(o,kg))}}function gt(t,e,r){r==null?t.removeAttribute(e):t.setAttribute(e,r)}function Ag(t,e,r){r?t.setAttribute(e,""):t.removeAttribute(e)}function mc(t,e){e==null?t.removeAttribute("class"):t.className=e}function Ti(t,e,r,n){if(n)Array.isArray(r)?(t[`$$${e}`]=r[0],t[`$$${e}Data`]=r[1]):t[`$$${e}`]=r;else if(Array.isArray(r)){const i=r[0];t.addEventListener(e,r[0]=o=>i.call(t,r[1],o))}else t.addEventListener(e,r,typeof r!="function"&&r)}function Ig(t,e,r={}){const n=Object.keys(e||{}),i=Object.keys(r);let o,a;for(o=0,a=i.length;o<a;o++){const c=i[o];!c||c==="undefined"||e[c]||(Mu(t,c,!1),delete r[c])}for(o=0,a=n.length;o<a;o++){const c=n[o],u=!!e[c];!c||c==="undefined"||r[c]===u||!u||(Mu(t,c,!0),r[c]=u)}return r}function d(t,e,r){if(!e)return r?gt(t,"style"):e;const n=t.style;if(typeof e=="string")return n.cssText=e;typeof r=="string"&&(n.cssText=r=void 0),r||(r={}),e||(e={});let i,o;for(o in r)e[o]==null&&n.removeProperty(o),delete r[o];for(o in e)i=e[o],i!==r[o]&&(n.setProperty(o,i),r[o]=i);return r}function Eg(t,e={},r,n){const i={};return K(()=>i.children=Ho(t,e.children,i.children)),K(()=>typeof e.ref=="function"&&xg(e.ref,t)),K(()=>Tg(t,e,r,!0,i,!0)),i}function xg(t,e,r){return qr(()=>t(e,r))}function s(t,e,r,n){if(r!==void 0&&!n&&(n=[]),typeof e!="function")return Ho(t,e,n,r);K(i=>Ho(t,e(),i,r),n)}function Tg(t,e,r,n,i={},o=!1){e||(e={});for(const a in i)if(!(a in e)){if(a==="children")continue;i[a]=Ou(t,a,null,i[a],r,o,e)}for(const a in e){if(a==="children")continue;const c=e[a];i[a]=Ou(t,a,c,i[a],r,o,e)}}function $g(t){return t.toLowerCase().replace(/-([a-z])/g,(e,r)=>r.toUpperCase())}function Mu(t,e,r){const n=e.trim().split(/\s+/);for(let i=0,o=n.length;i<o;i++)t.classList.toggle(n[i],r)}function Ou(t,e,r,n,i,o,a){let c,u,h,f,p;if(e==="style")return d(t,r,n);if(e==="classList")return Ig(t,r,n);if(r===n)return n;if(e==="ref")o||r(t);else if(e.slice(0,3)==="on:"){const _=e.slice(3);n&&t.removeEventListener(_,n,typeof n!="function"&&n),r&&t.addEventListener(_,r,typeof r!="function"&&r)}else if(e.slice(0,10)==="oncapture:"){const _=e.slice(10);n&&t.removeEventListener(_,n,!0),r&&t.addEventListener(_,r,!0)}else if(e.slice(0,2)==="on"){const _=e.slice(2).toLowerCase(),E=Pg.has(_);if(!E&&n){const A=Array.isArray(n)?n[0]:n;t.removeEventListener(_,A)}(E||r)&&(Ti(t,_,r,E),E&&Ot([_]))}else e.slice(0,5)==="attr:"?gt(t,e.slice(5),r):e.slice(0,5)==="bool:"?Ag(t,e.slice(5),r):(p=e.slice(0,5)==="prop:")||(h=vg.has(e))||(f=Sg(e,t.tagName))||(u=pg.has(e))||(c=t.nodeName.includes("-")||"is"in a)?(p&&(e=e.slice(5),u=!0),e==="class"||e==="className"?mc(t,r):c&&!u&&!h?t[$g(e)]=r:t[f||e]=r):gt(t,bg[e]||e,r);return r}function kg(t){let e=t.target;const r=`$$${t.type}`,n=t.target,i=t.currentTarget,o=u=>Object.defineProperty(t,"target",{configurable:!0,value:u}),a=()=>{const u=e[r];if(u&&!e.disabled){const h=e[`${r}Data`];if(h!==void 0?u.call(e,h,t):u.call(e,t),t.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(t.target)&&o(e.host),!0},c=()=>{for(;a()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return e||document}}),t.composedPath){const u=t.composedPath();o(u[0]);for(let h=0;h<u.length-2&&(e=u[h],!!a());h++){if(e._$host){e=e._$host,c();break}if(e.parentNode===i)break}}else c();o(n)}function Ho(t,e,r,n,i){for(;typeof r=="function";)r=r();if(e===r)return r;const o=typeof e,a=n!==void 0;if(t=a&&r[0]&&r[0].parentNode||t,o==="string"||o==="number"){if(o==="number"&&(e=e.toString(),e===r))return r;if(a){let c=r[0];c&&c.nodeType===3?c.data!==e&&(c.data=e):c=document.createTextNode(e),r=Bi(t,r,n,c)}else r!==""&&typeof r=="string"?r=t.firstChild.data=e:r=t.textContent=e}else if(e==null||o==="boolean")r=Bi(t,r,n);else{if(o==="function")return K(()=>{let c=e();for(;typeof c=="function";)c=c();r=Ho(t,c,r,n)}),()=>r;if(Array.isArray(e)){const c=[],u=r&&Array.isArray(r);if(Nl(c,e,r,i))return K(()=>r=Ho(t,c,r,n,!0)),()=>r;if(c.length===0){if(r=Bi(t,r,n),a)return r}else u?r.length===0?Vu(t,c,n):wg(t,r,c):(r&&Bi(t),Vu(t,c));r=c}else if(e.nodeType){if(Array.isArray(r)){if(a)return r=Bi(t,r,n,e);Bi(t,r,null,e)}else r==null||r===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);r=e}}return r}function Nl(t,e,r,n){let i=!1;for(let o=0,a=e.length;o<a;o++){let c=e[o],u=r&&r[t.length],h;if(!(c==null||c===!0||c===!1))if((h=typeof c)=="object"&&c.nodeType)t.push(c);else if(Array.isArray(c))i=Nl(t,c,u)||i;else if(h==="function")if(n){for(;typeof c=="function";)c=c();i=Nl(t,Array.isArray(c)?c:[c],Array.isArray(u)?u:[u])||i}else t.push(c),i=!0;else{const f=String(c);u&&u.nodeType===3&&u.data===f?t.push(u):t.push(document.createTextNode(f))}}return i}function Vu(t,e,r=null){for(let n=0,i=e.length;n<i;n++)t.insertBefore(e[n],r)}function Bi(t,e,r,n){if(r===void 0)return t.textContent="";const i=n||document.createTextNode("");if(e.length){let o=!1;for(let a=e.length-1;a>=0;a--){const c=e[a];if(i!==c){const u=c.parentNode===t;!o&&!a?u?t.replaceChild(i,c):t.insertBefore(i,r):u&&c.remove()}else o=!0}}else t.insertBefore(i,r);return[i]}const Rg=!1;function tm(){let t=new Set;function e(i){return t.add(i),()=>t.delete(i)}let r=!1;function n(i,o){if(r)return!(r=!1);const a={to:i,options:o,defaultPrevented:!1,preventDefault:()=>a.defaultPrevented=!0};for(const c of t)c.listener({...a,from:c.location,retry:u=>{u&&(r=!0),c.navigate(i,{...o,resolve:!1})}});return!a.defaultPrevented}return{subscribe:e,confirm:n}}let Ll;function fc(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),Ll=window.history.state._depth}fc();function Dg(t){return{...t,_depth:window.history.state&&window.history.state._depth}}function Ng(t,e){let r=!1;return()=>{const n=Ll;fc();const i=n==null?null:Ll-n;if(r){r=!1;return}i&&e(i)?(r=!0,window.history.go(-i)):t()}}const Lg=/^(?:[a-z0-9]+:)?\/\//i,Mg=/^\/+|(\/)\/+$/g,rm="http://sr";function Pi(t,e=!1){const r=t.replace(Mg,"$1");return r?e||/^[?#]/.test(r)?r:"/"+r:""}function zs(t,e,r){if(Lg.test(e))return;const n=Pi(t),i=r&&Pi(r);let o="";return!i||e.startsWith("/")?o=n:i.toLowerCase().indexOf(n.toLowerCase())!==0?o=n+i:o=i,(o||"/")+Pi(e,!o)}function Og(t,e){if(t==null)throw new Error(e);return t}function Vg(t,e){return Pi(t).replace(/\/*(\*.*)?$/g,"")+Pi(e)}function nm(t){const e={};return t.searchParams.forEach((r,n)=>{n in e?Array.isArray(e[n])?e[n].push(r):e[n]=[e[n],r]:e[n]=r}),e}function Bg(t,e,r){const[n,i]=t.split("/*",2),o=n.split("/").filter(Boolean),a=o.length;return c=>{const u=c.split("/").filter(Boolean),h=u.length-a;if(h<0||h>0&&i===void 0&&!e)return null;const f={path:a?"":"/",params:{}},p=_=>r===void 0?void 0:r[_];for(let _=0;_<a;_++){const E=o[_],A=E[0]===":",T=A?u[_]:u[_].toLowerCase(),x=A?E.slice(1):E.toLowerCase();if(A&&el(T,p(x)))f.params[x]=T;else if(A||!el(T,x))return null;f.path+=`/${T}`}if(i){const _=h?u.slice(-h).join("/"):"";if(el(_,p(i)))f.params[i]=_;else return null}return f}}function el(t,e){const r=n=>n===t;return e===void 0?!0:typeof e=="string"?r(e):typeof e=="function"?e(t):Array.isArray(e)?e.some(r):e instanceof RegExp?e.test(t):!1}function Fg(t){const[e,r]=t.pattern.split("/*",2),n=e.split("/").filter(Boolean);return n.reduce((i,o)=>i+(o.startsWith(":")?2:3),n.length-(r===void 0?0:1))}function im(t){const e=new Map,r=Kh();return new Proxy({},{get(n,i){return e.has(i)||Yh(r,()=>e.set(i,it(()=>t()[i]))),e.get(i)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(t())}})}function om(t){let e=/(\/?\:[^\/]+)\?/.exec(t);if(!e)return[t];let r=t.slice(0,e.index),n=t.slice(e.index+e[0].length);const i=[r,r+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(n);)i.push(r+=e[1]),n=n.slice(e[0].length);return om(n).reduce((o,a)=>[...o,...i.map(c=>c+a)],[])}const Ug=100,sm=Qh(),yc=Qh(),ss=()=>Og(cc(sm),"<A> and 'use' router primitives can be only used inside a Route."),jg=()=>cc(yc)||ss().base,zg=t=>{const e=jg();return it(()=>e.resolvePath(t()))},qg=t=>{const e=ss();return it(()=>{const r=t();return r!==void 0?e.renderPath(r):r})},gc=()=>ss().navigatorFactory(),Hg=()=>ss().location,Wg=()=>ss().params;function Gg(t,e=""){const{component:r,preload:n,load:i,children:o,info:a}=t,c=!o||Array.isArray(o)&&!o.length,u={key:t,component:r,preload:n||i,info:a};return am(t.path).reduce((h,f)=>{for(const p of om(f)){const _=Vg(e,p);let E=c?_:_.split("/*",1)[0];E=E.split("/").map(A=>A.startsWith(":")||A.startsWith("*")?A:encodeURIComponent(A)).join("/"),h.push({...u,originalPath:f,pattern:E,matcher:Bg(E,!c,t.matchFilters)})}return h},[])}function Kg(t,e=0){return{routes:t,score:Fg(t[t.length-1])*1e4-e,matcher(r){const n=[];for(let i=t.length-1;i>=0;i--){const o=t[i],a=o.matcher(r);if(!a)return null;n.unshift({...a,route:o})}return n}}}function am(t){return Array.isArray(t)?t:[t]}function lm(t,e="",r=[],n=[]){const i=am(t);for(let o=0,a=i.length;o<a;o++){const c=i[o];if(c&&typeof c=="object"){c.hasOwnProperty("path")||(c.path="");const u=Gg(c,e);for(const h of u){r.push(h);const f=Array.isArray(c.children)&&c.children.length===0;if(c.children&&!f)lm(c.children,h.pattern,r,n);else{const p=Kg([...r],n.length);n.push(p)}r.pop()}}}return r.length?n:n.sort((o,a)=>a.score-o.score)}function tl(t,e){for(let r=0,n=t.length;r<n;r++){const i=t[r].matcher(e);if(i)return i}return[]}function Yg(t,e,r){const n=new URL(rm),i=it(f=>{const p=t();try{return new URL(p,n)}catch{return console.error(`Invalid path ${p}`),f}},n,{equals:(f,p)=>f.href===p.href}),o=it(()=>i().pathname),a=it(()=>i().search,!0),c=it(()=>i().hash),u=()=>"",h=lc(a,()=>nm(i()));return{get pathname(){return o()},get search(){return a()},get hash(){return c()},get state(){return e()},get key(){return u()},query:r?r(h):im(h)}}let vi;function Qg(){return vi}function Jg(t,e,r,n={}){const{signal:[i,o],utils:a={}}=t,c=a.parsePath||(le=>le),u=a.renderPath||(le=>le),h=a.beforeLeave||tm(),f=zs("",n.base||"");if(f===void 0)throw new Error(`${f} is not a valid base path`);f&&!i().value&&o({value:f,replace:!0,scroll:!1});const[p,_]=fe(!1);let E;const A=(le,B)=>{B.value===T()&&B.state===$()||(E===void 0&&_(!0),vi=le,E=B,og(()=>{E===B&&(x(E.value),O(E.state),ee[1](k=>k.filter(W=>W.pending)))}).finally(()=>{E===B&&Gh(()=>{vi=void 0,le==="navigate"&&I(E),_(!1),E=void 0})}))},[T,x]=fe(i().value),[$,O]=fe(i().state),q=Yg(T,$,a.queryWrapper),z=[],ee=fe([]),Q=it(()=>typeof n.transformUrl=="function"?tl(e(),n.transformUrl(q.pathname)):tl(e(),q.pathname)),C=()=>{const le=Q(),B={};for(let k=0;k<le.length;k++)Object.assign(B,le[k].params);return B},v=a.paramsWrapper?a.paramsWrapper(C,e):im(C),S={pattern:f,path:()=>f,outlet:()=>null,resolvePath(le){return zs(f,le)}};return K(lc(i,le=>A("native",le),{defer:!0})),{base:S,location:q,params:v,isRouting:p,renderPath:u,parsePath:c,navigatorFactory:P,matches:Q,beforeLeave:h,preloadRoute:y,singleFlight:n.singleFlight===void 0?!0:n.singleFlight,submissions:ee};function w(le,B,k){qr(()=>{if(typeof B=="number"){B&&(a.go?a.go(B):console.warn("Router integration does not support relative routing"));return}const W=!B||B[0]==="?",{replace:R,resolve:V,scroll:M,state:F}={replace:!1,resolve:!W,scroll:!0,...k},ne=V?le.resolvePath(B):zs(W&&q.pathname||"",B);if(ne===void 0)throw new Error(`Path '${B}' is not a routable path`);if(z.length>=Ug)throw new Error("Too many redirects");const L=T();(ne!==L||F!==$())&&(Rg||h.confirm(ne,k)&&(z.push({value:L,replace:R,scroll:M,state:$()}),A("navigate",{value:ne,state:F})))})}function P(le){return le=le||cc(yc)||S,(B,k)=>w(le,B,k)}function I(le){const B=z[0];B&&(o({...le,replace:B.replace,scroll:B.scroll}),z.length=0)}function y(le,B){const k=tl(e(),le.pathname),W=vi;vi="preload";for(let R in k){const{route:V,params:M}=k[R];V.component&&V.component.preload&&V.component.preload();const{preload:F}=V;B&&F&&Yh(r(),()=>F({params:M,location:{pathname:le.pathname,search:le.search,hash:le.hash,query:nm(le),state:null,key:""},intent:"preload"}))}vi=W}}function Xg(t,e,r,n){const{base:i,location:o,params:a}=t,{pattern:c,component:u,preload:h}=n().route,f=it(()=>n().path);u&&u.preload&&u.preload();const p=h?h({params:a,location:o,intent:vi||"initial"}):void 0;return{parent:e,pattern:c,path:f,outlet:()=>u?b(u,{params:a,location:o,data:p,get children(){return r()}}):r(),resolvePath(E){return zs(i.path(),E,f())}}}const Zg=t=>e=>{const{base:r}=e,n=uc(()=>e.children),i=it(()=>lm(n(),e.base||""));let o;const a=Jg(t,i,()=>o,{base:r,singleFlight:e.singleFlight,transformUrl:e.transformUrl});return t.create&&t.create(a),b(sm.Provider,{value:a,get children(){return b(ep,{routerState:a,get root(){return e.root},get preload(){return e.rootPreload||e.rootLoad},get children(){return[oe(()=>(o=Kh())&&null),b(tp,{routerState:a,get branches(){return i()}})]}})}})};function ep(t){const e=t.routerState.location,r=t.routerState.params,n=it(()=>t.preload&&qr(()=>{t.preload({params:r,location:e,intent:Qg()||"initial"})}));return b(Ge,{get when(){return t.root},keyed:!0,get fallback(){return t.children},children:i=>b(i,{params:r,location:e,get data(){return n()},get children(){return t.children}})})}function tp(t){const e=[];let r;const n=it(lc(t.routerState.matches,(i,o,a)=>{let c=o&&i.length===o.length;const u=[];for(let h=0,f=i.length;h<f;h++){const p=o&&o[h],_=i[h];a&&p&&_.route.key===p.route.key?u[h]=a[h]:(c=!1,e[h]&&e[h](),Lo(E=>{e[h]=E,u[h]=Xg(t.routerState,u[h-1]||t.routerState.base,Bu(()=>n()[h+1]),()=>t.routerState.matches()[h])}))}return e.splice(i.length).forEach(h=>h()),a&&c?a:(r=u[0],u)}));return Bu(()=>n()&&r)()}const Bu=t=>()=>b(Ge,{get when(){return t()},keyed:!0,children:e=>b(yc.Provider,{value:e,get children(){return e.outlet()}})}),rn=t=>{const e=uc(()=>t.children);return Dl(t,{get children(){return e()}})};function rp([t,e],r,n){return[t,n?i=>e(n(i)):e]}function np(t){let e=!1;const r=i=>typeof i=="string"?{value:i}:i,n=rp(fe(r(t.get()),{equals:(i,o)=>i.value===o.value&&i.state===o.state}),void 0,i=>(!e&&t.set(i),i));return t.init&&ao(t.init((i=t.get())=>{e=!0,n[1](r(i)),e=!1})),Zg({signal:n,create:t.create,utils:t.utils})}function ip(t,e,r){return t.addEventListener(e,r),()=>t.removeEventListener(e,r)}function op(t,e){const r=t&&document.getElementById(t);r?r.scrollIntoView():e&&window.scrollTo(0,0)}const sp=new Map;function ap(t=!0,e=!1,r="/_server",n){return i=>{const o=i.base.path(),a=i.navigatorFactory(i.base);let c,u;function h(T){return T.namespaceURI==="http://www.w3.org/2000/svg"}function f(T){if(T.defaultPrevented||T.button!==0||T.metaKey||T.altKey||T.ctrlKey||T.shiftKey)return;const x=T.composedPath().find(Q=>Q instanceof Node&&Q.nodeName.toUpperCase()==="A");if(!x||e&&!x.hasAttribute("link"))return;const $=h(x),O=$?x.href.baseVal:x.href;if(($?x.target.baseVal:x.target)||!O&&!x.hasAttribute("state"))return;const z=(x.getAttribute("rel")||"").split(/\s+/);if(x.hasAttribute("download")||z&&z.includes("external"))return;const ee=$?new URL(O,document.baseURI):new URL(O);if(!(ee.origin!==window.location.origin||o&&ee.pathname&&!ee.pathname.toLowerCase().startsWith(o.toLowerCase())))return[x,ee]}function p(T){const x=f(T);if(!x)return;const[$,O]=x,q=i.parsePath(O.pathname+O.search+O.hash),z=$.getAttribute("state");T.preventDefault(),a(q,{resolve:!1,replace:$.hasAttribute("replace"),scroll:!$.hasAttribute("noscroll"),state:z?JSON.parse(z):void 0})}function _(T){const x=f(T);if(!x)return;const[$,O]=x;i.preloadRoute(O,$.getAttribute("preload")!=="false")}function E(T){clearTimeout(c);const x=f(T);if(!x)return u=null;const[$,O]=x;u!==$&&(c=setTimeout(()=>{i.preloadRoute(O,$.getAttribute("preload")!=="false"),u=$},20))}function A(T){if(T.defaultPrevented)return;let x=T.submitter&&T.submitter.hasAttribute("formaction")?T.submitter.getAttribute("formaction"):T.target.getAttribute("action");if(!x)return;if(!x.startsWith("https://action/")){const O=new URL(x,rm);if(x=i.parsePath(O.pathname+O.search),!x.startsWith(r))return}if(T.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const $=sp.get(x);if($){T.preventDefault();const O=new FormData(T.target,T.submitter);$.call({r:i,f:T.target},T.target.enctype==="multipart/form-data"?O:new URLSearchParams(O))}}Ot(["click","submit"]),document.addEventListener("click",p),t&&(document.addEventListener("mousemove",E,{passive:!0}),document.addEventListener("focusin",_,{passive:!0}),document.addEventListener("touchstart",_,{passive:!0})),document.addEventListener("submit",A),ao(()=>{document.removeEventListener("click",p),t&&(document.removeEventListener("mousemove",E),document.removeEventListener("focusin",_),document.removeEventListener("touchstart",_)),document.removeEventListener("submit",A)})}}function lp(t){const e=t.replace(/^.*?#/,"");if(!e.startsWith("/")){const[,r="/"]=window.location.hash.split("#",2);return`${r}#${e}`}return e}function cp(t){const e=()=>window.location.hash.slice(1),r=tm();return np({get:e,set({value:n,replace:i,scroll:o,state:a}){i?window.history.replaceState(Dg(a),"","#"+n):window.history.pushState(a,"","#"+n);const c=n.indexOf("#"),u=c>=0?n.slice(c+1):"";op(u,o),fc()},init:n=>ip(window,"hashchange",Ng(n,i=>!r.confirm(i&&i<0?i:e()))),create:ap(t.preload,t.explicitLinks,t.actionBase),utils:{go:n=>window.history.go(n),renderPath:n=>`#${n}`,parsePath:lp,beforeLeave:r}})(t)}var up=U("<a>");function wn(t){t=Dl({inactiveClass:"inactive",activeClass:"active"},t);const[,e]=fg(t,["href","state","class","activeClass","inactiveClass","end"]),r=zg(()=>t.href),n=qg(r),i=Hg(),o=it(()=>{const a=r();if(a===void 0)return[!1,!1];const c=Pi(a.split(/[?#]/,1)[0]).toLowerCase(),u=decodeURI(Pi(i.pathname).toLowerCase());return[t.end?c===u:u.startsWith(c+"/")||u===c,c===u]});return(()=>{var a=up();return Eg(a,Dl(e,{get href(){return n()||t.href},get state(){return JSON.stringify(t.state)},get classList(){return{...t.class&&{[t.class]:!0},[t.inactiveClass]:!o()[0],[t.activeClass]:o()[0],...e.classList}},link:"",get"aria-current"(){return o()[1]?"page":void 0}}),!1),a})()}const Ml=Symbol("store-raw"),Ki=Symbol("store-node"),Cn=Symbol("store-has"),cm=Symbol("store-self");function um(t){let e=t[Jr];if(!e&&(Object.defineProperty(t,Jr,{value:e=new Proxy(t,mp)}),!Array.isArray(t))){const r=Object.keys(t),n=Object.getOwnPropertyDescriptors(t);for(let i=0,o=r.length;i<o;i++){const a=r[i];n[a].get&&Object.defineProperty(t,a,{enumerable:n[a].enumerable,get:n[a].get.bind(e)})}}return e}function oa(t){let e;return t!=null&&typeof t=="object"&&(t[Jr]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function Wo(t,e=new Set){let r,n,i,o;if(r=t!=null&&t[Ml])return r;if(!oa(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let a=0,c=t.length;a<c;a++)i=t[a],(n=Wo(i,e))!==i&&(t[a]=n)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const a=Object.keys(t),c=Object.getOwnPropertyDescriptors(t);for(let u=0,h=a.length;u<h;u++)o=a[u],!c[o].get&&(i=t[o],(n=Wo(i,e))!==i&&(t[o]=n))}return t}function sa(t,e){let r=t[e];return r||Object.defineProperty(t,e,{value:r=Object.create(null)}),r}function Go(t,e,r){if(t[e])return t[e];const[n,i]=fe(r,{equals:!1,internal:!0});return n.$=i,t[e]=n}function dp(t,e){const r=Reflect.getOwnPropertyDescriptor(t,e);return!r||r.get||!r.configurable||e===Jr||e===Ki||(delete r.value,delete r.writable,r.get=()=>t[Jr][e]),r}function dm(t){$l()&&Go(sa(t,Ki),cm)()}function hp(t){return dm(t),Reflect.ownKeys(t)}const mp={get(t,e,r){if(e===Ml)return t;if(e===Jr)return r;if(e===Tl)return dm(t),r;const n=sa(t,Ki),i=n[e];let o=i?i():t[e];if(e===Ki||e===Cn||e==="__proto__")return o;if(!i){const a=Object.getOwnPropertyDescriptor(t,e);$l()&&(typeof o!="function"||t.hasOwnProperty(e))&&!(a&&a.get)&&(o=Go(n,e,o)())}return oa(o)?um(o):o},has(t,e){return e===Ml||e===Jr||e===Tl||e===Ki||e===Cn||e==="__proto__"?!0:($l()&&Go(sa(t,Cn),e)(),e in t)},set(){return!0},deleteProperty(){return!0},ownKeys:hp,getOwnPropertyDescriptor:dp};function aa(t,e,r,n=!1){if(!n&&t[e]===r)return;const i=t[e],o=t.length;r===void 0?(delete t[e],t[Cn]&&t[Cn][e]&&i!==void 0&&t[Cn][e].$()):(t[e]=r,t[Cn]&&t[Cn][e]&&i===void 0&&t[Cn][e].$());let a=sa(t,Ki),c;if((c=Go(a,e,i))&&c.$(()=>r),Array.isArray(t)&&t.length!==o){for(let u=t.length;u<o;u++)(c=a[u])&&c.$();(c=Go(a,"length",o))&&c.$(t.length)}(c=a[cm])&&c.$()}function hm(t,e){const r=Object.keys(e);for(let n=0;n<r.length;n+=1){const i=r[n];aa(t,i,e[i])}}function fp(t,e){if(typeof e=="function"&&(e=e(t)),e=Wo(e),Array.isArray(e)){if(t===e)return;let r=0,n=e.length;for(;r<n;r++){const i=e[r];t[r]!==i&&aa(t,r,i)}aa(t,"length",n)}else hm(t,e)}function xo(t,e,r=[]){let n,i=t;if(e.length>1){n=e.shift();const a=typeof n,c=Array.isArray(t);if(Array.isArray(n)){for(let u=0;u<n.length;u++)xo(t,[n[u]].concat(e),r);return}else if(c&&a==="function"){for(let u=0;u<t.length;u++)n(t[u],u)&&xo(t,[u].concat(e),r);return}else if(c&&a==="object"){const{from:u=0,to:h=t.length-1,by:f=1}=n;for(let p=u;p<=h;p+=f)xo(t,[p].concat(e),r);return}else if(e.length>1){xo(t[n],e,[n].concat(r));return}i=t[n],r=[n].concat(r)}let o=e[0];typeof o=="function"&&(o=o(i,r),o===i)||n===void 0&&o==null||(o=Wo(o),n===void 0||oa(i)&&oa(o)&&!Array.isArray(o)?hm(i,o):aa(t,n,o))}function mm(...[t,e]){const r=Wo(t||{}),n=Array.isArray(r),i=um(r);function o(...a){Gh(()=>{n&&a.length===1?fp(r,a[0]):xo(r,a)})}return[i,o]}const Lt=(t=300+Math.random()*700)=>new Promise(e=>setTimeout(e,t)),mi=(t="")=>`${t}${Date.now()}-${Math.random().toString(36).substr(2,9)}`;let He={products:[{id:"prod-001",name:"Wireless Headphones",sku:"WH-001",productCode:"WH-001",productName:"Wireless Headphones",description:"High-quality wireless bluetooth headphones",category:"Electronics",unitOfMeasure:"pcs",unitCost:45,sellingPrice:89.99,minStockLevel:10,maxStockLevel:100,isActive:!0,createdDate:"2024-01-15T10:00:00Z",lastModified:"2024-01-15T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-002",name:"USB-C Cable",sku:"USB-001",description:"3ft USB-C charging cable",category:"Accessories",unitOfMeasure:"pcs",unitCost:8.5,sellingPrice:19.99,minStockLevel:25,maxStockLevel:200,isActive:!0,createdDate:"2024-01-16T10:00:00Z",lastModified:"2024-01-16T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-003",name:"Laptop Stand",sku:"LS-001",description:"Adjustable aluminum laptop stand",category:"Office",unitOfMeasure:"pcs",unitCost:25,sellingPrice:49.99,minStockLevel:5,maxStockLevel:50,isActive:!0,createdDate:"2024-01-17T10:00:00Z",lastModified:"2024-01-17T10:00:00Z",businessId:"YB100423253156428"}],locations:[{id:"loc-001",name:"Main Warehouse",code:"WH-001",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-002",name:"Retail Store - Downtown",code:"ST-001",type:"store",address:"456 Main St, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-003",name:"Retail Store - Mall",code:"ST-002",type:"store",address:"789 Mall Blvd, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"}],movements:[{id:"mov-001",productId:"prod-001",productName:"Wireless Headphones",productSku:"WH-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:50,unitCost:45,totalCost:2250,referenceNumber:"PO-001",notes:"Initial stock purchase",createdBy:"admin",createdDate:"2024-01-15T10:00:00Z",invoiceId:"INV-1000001"},{id:"mov-002",productId:"prod-002",productName:"USB-C Cable",productSku:"USB-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:100,unitCost:8.5,totalCost:850,referenceNumber:"PO-001",notes:"Bulk purchase",createdBy:"admin",createdDate:"2024-01-15T10:05:00Z",invoiceId:"INV-1000001"}],accounts:[{id:"acc-001",accountNumber:"1000",accountName:"Cash",accountType:"asset",category:"currentAssets",balance:5e4,parentAccountId:null,description:"Cash and cash equivalents",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"},{id:"acc-002",accountNumber:"1100",accountName:"Accounts Receivable",accountType:"asset",category:"currentAssets",balance:25e3,parentAccountId:null,description:"Money owed by customers",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"}],journalEntries:[{id:"je-001",entryNumber:"JE-001",date:"2024-01-15",description:"Initial cash deposit",reference:"DEP-001",status:"posted",createdBy:"admin",createdAt:"2024-01-15T10:00:00Z",postedAt:"2024-01-15T10:05:00Z",lines:[{id:"jel-001",accountId:"acc-001",accountName:"Cash",description:"Initial deposit",debitAmount:5e4,creditAmount:0},{id:"jel-002",accountId:"acc-003",accountName:"Owner Equity",description:"Initial capital",debitAmount:0,creditAmount:5e4}]}]};const nr=(t=.05)=>Math.random()<t,ir=()=>{const t=["Network timeout","Connection refused","Server temporarily unavailable","Invalid request"];throw new Error(t[Math.floor(Math.random()*t.length)])},Or={products:{async getAll(t,e){await Lt(),nr()&&ir();let r=[...He.products];if(t&&t.trim()){const n=t.toLowerCase();r=r.filter(i=>i.name.toLowerCase().includes(n)||i.sku.toLowerCase().includes(n)||i.category.toLowerCase().includes(n)||i.description.toLowerCase().includes(n))}return e?.category&&(r=r.filter(n=>n.category===e.category)),e?.isActive!==void 0&&(r=r.filter(n=>n.isActive===e.isActive)),r},async getById(t){return await Lt(),nr()&&ir(),He.products.find(e=>e.id===t)||null},async create(t){if(await Lt(),nr()&&ir(),He.products.some(r=>r.sku===t.sku))throw new Error("SKU already exists");const e={...t,id:mi("prod-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return He.products.push(e),e},async update(t,e){await Lt(),nr()&&ir();const r=He.products.findIndex(i=>i.id===t);if(r===-1)throw new Error("Product not found");if(e.sku&&He.products.some(i=>i.id!==t&&i.sku===e.sku))throw new Error("SKU already exists");const n={...He.products[r],...e,lastModified:new Date().toISOString()};return He.products[r]=n,n},async delete(t){await Lt(),nr()&&ir();const e=He.products.findIndex(n=>n.id===t);if(e===-1)throw new Error("Product not found");return He.movements.some(n=>n.productId===t)?{success:!1,message:"Cannot delete product with existing movements"}:(He.products.splice(e,1),{success:!0,message:"Product deleted successfully"})}},locations:{async getAll(t){await Lt(),nr()&&ir();let e=[...He.locations];return t?.type&&(e=e.filter(r=>r.type===t.type)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await Lt(),He.locations.find(e=>e.id===t)||null},async create(t){if(await Lt(),nr()&&ir(),He.locations.some(r=>r.code===t.code))throw new Error("Location code already exists");const e={...t,id:mi("loc-"),createdDate:new Date().toISOString()};return He.locations.push(e),e},async update(t,e){await Lt(),nr()&&ir();const r=He.locations.findIndex(n=>n.id===t);if(r===-1)throw new Error("Location not found");if(e.code&&He.locations.some(n=>n.id!==t&&n.code===e.code))throw new Error("Location code already exists");return He.locations[r]={...He.locations[r],...e},He.locations[r]}},movements:{async getAll(t){await Lt(),nr()&&ir();let e=[...He.movements];if(t?.productId&&(e=e.filter(r=>r.productId===t.productId)),t?.locationId&&(e=e.filter(r=>r.locationId===t.locationId)),t?.movementType&&(e=e.filter(r=>r.movementType===t.movementType)),t?.dateFrom&&(e=e.filter(r=>r.createdDate>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.createdDate<=t.dateTo)),t?.search){const r=t.search.toLowerCase();e=e.filter(n=>n.productName.toLowerCase().includes(r)||n.productSku.toLowerCase().includes(r)||n.referenceNumber.toLowerCase().includes(r)||n.notes.toLowerCase().includes(r))}return e.sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime()),e},async getById(t){return await Lt(),He.movements.find(e=>e.id===t)||null},async create(t){if(await Lt(),nr()&&ir(),!He.products.find(i=>i.id===t.productId))throw new Error("Product not found");if(!He.locations.find(i=>i.id===t.locationId))throw new Error("Location not found");if(t.movementType==="out"){const i=await this.getStockLevel(t.productId,t.locationId);if(i<t.quantity)throw new Error(`Insufficient stock. Available: ${i}, Requested: ${t.quantity}`)}const n={...t,id:mi("mov-"),createdDate:new Date().toISOString()};return He.movements.push(n),n},async update(t,e){await Lt(),nr()&&ir();const r=He.movements.findIndex(i=>i.id===t);if(r===-1)throw new Error("Movement not found");const n={...He.movements[r],...e,lastModified:new Date().toISOString()};return He.movements[r]=n,n},async delete(t){await Lt(),nr()&&ir();const e=He.movements.findIndex(r=>r.id===t);if(e===-1)throw new Error("Movement not found");return He.movements.splice(e,1),{success:!0,message:"Movement deleted successfully"}},async createBulk(t){await Lt(),nr()&&ir();const e=[],r=[],n=new Date().toISOString(),i=He.locations.find(o=>o.id===t.locationId);if(!i)return{success:!1,movements:[],errors:["Invalid location"]};for(let o=0;o<t.items.length;o++){const a=t.items[o],c=He.products.find(f=>f.id===a.productId);if(!c){e.push(`Item ${o+1}: Product not found`);continue}if(a.quantity<=0){e.push(`Item ${o+1}: Quantity must be greater than 0`);continue}if(t.movementType==="out"){const f=await this.getStockLevel(a.productId,t.locationId);if(a.quantity>f){e.push(`Item ${o+1}: Insufficient stock. Available: ${f}, Requested: ${a.quantity}`);continue}}const u=a.unitCost||c.unitCost,h={id:mi("mov-"),productId:c.id,productName:c.name,productSku:c.sku,locationId:t.locationId,locationName:i.name,movementType:t.movementType,quantity:a.quantity,unitCost:u,totalCost:a.quantity*u,referenceNumber:t.referenceNumber,notes:a.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:t.fromLocationId?He.locations.find(f=>f.id===t.fromLocationId)?.name:void 0};r.push(h)}return e.length>0?{success:!1,movements:[],errors:e}:(He.movements.push(...r),{success:!0,movements:r,errors:[]})},async getStockLevel(t,e){return await Lt(50),He.movements.filter(r=>r.productId===t&&r.locationId===e).reduce((r,n)=>{switch(n.movementType){case"in":case"adjustment":return r+n.quantity;case"out":return r-n.quantity;case"transfer":return n.locationId===e?r+n.quantity:r;default:return r}},0)},async getStockLevels(){await Lt();const t=new Map;for(const e of He.movements){const r=`${e.productId}-${e.locationId}`;let n=t.get(r);switch(n||(n={id:r,productId:e.productId,locationId:e.locationId,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType){case"in":case"adjustment":n.quantity+=e.quantity;break;case"out":n.quantity-=e.quantity;break;case"transfer":e.locationId===e.locationId&&(n.quantity+=e.quantity);break}new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost,n.availableQuantity=n.quantity-n.reservedQuantity}return Array.from(t.values())}},accounts:{async getAll(t){await Lt(),nr()&&ir();let e=[...He.accounts];return t?.accountType&&(e=e.filter(r=>r.accountType===t.accountType)),t?.category&&(e=e.filter(r=>r.category===t.category)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await Lt(),He.accounts.find(e=>e.id===t)||null},async create(t){if(await Lt(),nr()&&ir(),He.accounts.some(r=>r.accountNumber===t.accountNumber))throw new Error("Account number already exists");const e={...t,id:mi("acc-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return He.accounts.push(e),e},async update(t,e){await Lt(),nr()&&ir();const r=He.accounts.findIndex(n=>n.id===t);if(r===-1)throw new Error("Account not found");if(e.accountNumber&&He.accounts.some(n=>n.id!==t&&n.accountNumber===e.accountNumber))throw new Error("Account number already exists");return He.accounts[r]={...He.accounts[r],...e,lastModified:new Date().toISOString()},He.accounts[r]}},journal:{async getAll(t){await Lt(),nr()&&ir();let e=[...He.journalEntries];return t?.status&&(e=e.filter(r=>r.status===t.status)),t?.accountId&&(e=e.filter(r=>r.lines.some(n=>n.accountId===t.accountId))),t?.dateFrom&&(e=e.filter(r=>r.date>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.date<=t.dateTo)),e.sort((r,n)=>new Date(n.createdAt).getTime()-new Date(r.createdAt).getTime())},async getById(t){return await Lt(),He.journalEntries.find(e=>e.id===t)||null},async create(t){await Lt(),nr()&&ir();const e=t.lines.reduce((c,u)=>c+(u.debitAmount||0),0),r=t.lines.reduce((c,u)=>c+(u.creditAmount||0),0);if(Math.abs(e-r)>.01)throw new Error(`Entry is not balanced. Debit: ${e}, Credit: ${r}`);const n=He.journalEntries.sort((c,u)=>u.entryNumber.localeCompare(c.entryNumber))[0],o=`JE-${((n?parseInt(n.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`,a={...t,id:mi("je-"),entryNumber:o,createdAt:new Date().toISOString(),lines:t.lines.map(c=>({...c,id:mi("jel-")}))};return He.journalEntries.push(a),a},async update(t,e){await Lt(),nr()&&ir();const r=He.journalEntries.findIndex(n=>n.id===t);if(r===-1)throw new Error("Journal entry not found");if(He.journalEntries[r].status==="posted")throw new Error("Cannot modify posted entries");return He.journalEntries[r]={...He.journalEntries[r],...e},He.journalEntries[r]},async post(t){await Lt(),nr()&&ir();const e=He.journalEntries.findIndex(o=>o.id===t);if(e===-1)throw new Error("Journal entry not found");const r=He.journalEntries[e];if(r.status==="posted")throw new Error("Entry is already posted");const n=r.lines.reduce((o,a)=>o+(a.debitAmount||0),0),i=r.lines.reduce((o,a)=>o+(a.creditAmount||0),0);if(Math.abs(n-i)>.01)throw new Error("Entry must be balanced before posting");return He.journalEntries[e]={...r,status:"posted",postedAt:new Date().toISOString()},r.lines.forEach(o=>{const a=He.accounts.findIndex(c=>c.id===o.accountId);if(a!==-1){const c=He.accounts[a],u=o.debitAmount||0,h=o.creditAmount||0;["asset","expense"].includes(c.accountType)?c.balance+=u-h:c.balance+=h-u}}),He.journalEntries[e]}},utils:{async getNextEntryNumber(){await Lt(100);const t=He.journalEntries.sort((r,n)=>n.entryNumber.localeCompare(r.entryNumber))[0];return`JE-${((t?parseInt(t.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`},async getNextProductCode(t){await Lt(100);const e=t.toUpperCase().slice(0,3),r=He.products.filter(i=>i.productCode?.startsWith(e)).sort((i,o)=>(o.productCode||"").localeCompare(i.productCode||""));if(r.length===0)return`${e}001`;const n=parseInt(r[0].productCode?.slice(-3)||"0");return`${e}${(n+1).toString().padStart(3,"0")}`},async healthCheck(){return await Lt(50),{status:"healthy",timestamp:new Date().toISOString(),version:"1.0.0"}},async resetDatabase(){return await Lt(200),He={products:[...He.products.slice(0,3)],locations:[...He.locations.slice(0,3)],movements:[...He.movements.slice(0,2)],accounts:[...He.accounts.slice(0,2)],journalEntries:[...He.journalEntries.slice(0,1)]},{success:!0,message:"Database reset to initial state"}},async getStats(){return await Lt(100),{products:He.products.length,locations:He.locations.length,movements:He.movements.length,accounts:He.accounts.length,journalEntries:He.journalEntries.length,totalStockValue:He.movements.reduce((t,e)=>e.movementType==="in"?t+e.totalCost:e.movementType==="out"?t-e.totalCost:t,0)}}}},qs=(t=16)=>{const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},Jn=async t=>{const n=await fetch("https://qvamarkets.com/gql_api",{method:"POST",headers:{"Content-Type":"application/json","Accept-Encoding":"gzip, deflate, br",Authorization:"eyJhbGciOiJSUzI1NiIsImtpZCI6IjhlOGZjOGU1NTZmN2E3NmQwOGQzNTgyOWQ2ZjkwYWUyZTEyY2ZkMGQiLCJ0eXAiOiJKV1QifQ"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const i=await n.json();if(i.errors)throw new Error(i.errors[0]?.message||"GraphQL error");return i.data},yp=t=>({ENTRY:"in",in:"in",TRANSFER:"transfer",transfer:"transfer",SALES:"out",out:"out",adjustment:"adjustment"})[t],Ol=t=>({ENTRY:"ENTRY",in:"ENTRY",TRANSFER:"TRANSFER",transfer:"TRANSFER",SALES:"SALES",out:"SALES",adjustment:"adjustment"})[t];function gp(t){var e=[];return t&&Object.keys(t).map(r=>{e.push(t[r])}),e}const pp=async()=>({}),vp=()=>(typeof window<"u"&&localStorage.getItem("hrmfinance-api-mode"),"real");let bi=vp();const Ko={getMode(){return bi},setMode(t){bi=t,typeof window<"u"&&localStorage.setItem("hrmfinance-api-mode",t)},isFakeMode(){return bi==="fake"},isRealMode(){return bi==="real"},isHybridMode(){return bi==="hybrid"}},zr=async(t,e,r=!0)=>{if(bi==="fake")return e();if(bi==="real")return t();try{return await t()}catch(n){if(console.warn("Real API failed, falling back to fake server:",n),r)return e();throw n}},Fu={async getAll(t,e){const r=await Jn({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:{businessId:"YB100423253156428",":search0":"produ"}});return gp(r)},async getById(t){return zr(async()=>(await this.getAll()).find(r=>r.id===t)||null,()=>Or.products.getById(t))},async create(t){return zr(async()=>{throw console.log("Creating product via real API:",t),new Error("Real API not implemented yet")},()=>Or.products.create(t))},async update(t,e){return zr(async()=>{throw console.log("Updating product via real API:",t,e),new Error("Real API not implemented yet")},()=>Or.products.update(t,e))},async delete(t){return zr(async()=>{throw console.log("Deleting product via real API:",t),new Error("Real API not implemented yet")},()=>Or.products.delete(t))}},Tn={async getInventory(t,e){if(!(t&&t?.trim()))return[];let r={businessId:"YB100423253156428"};return t&&t.split(" ").map((o,a)=>{o&&(r[":search"+a]=o.trim())}),await Jn({query:"getScanYabaInventory",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async getProducts(t){if(!(t&&t?.trim()))return[];let e={businessId:"YB100423253156428"};return t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())}),await Jn({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async addInventory(t){let r={query:"addYabaInventory",params:{businessId:"YB100423253156428"},form:t};const n=await Jn(r);return console.log(r),console.log(n),n},async updInventory(t){return await pp()}},Uu={async getAll(t){return zr(async()=>{throw console.log("Getting accounts via real API:",t),new Error("Real API not implemented yet")},()=>Or.accounts.getAll(t))},async getById(t){return zr(async()=>{throw console.log("Getting account by ID via real API:",t),new Error("Real API not implemented yet")},()=>Or.accounts.getById(t))},async create(t){return zr(async()=>{throw console.log("Creating account via real API:",t),new Error("Real API not implemented yet")},()=>Or.accounts.create(t))},async update(t,e){return zr(async()=>{throw console.log("Updating account via real API:",t,e),new Error("Real API not implemented yet")},()=>Or.accounts.update(t,e))}},ju={async getNextEntryNumber(){return zr(async()=>{throw console.log("Getting next entry number via real API"),new Error("Real API not implemented yet")},()=>Or.utils.getNextEntryNumber())},async getNextProductCode(t){return zr(async()=>{throw console.log("Getting next product code via real API:",t),new Error("Real API not implemented yet")},()=>Or.utils.getNextProductCode(t))},async healthCheck(){return zr(async()=>{const t=await fetch("/api/health");if(!t.ok)throw new Error("Health check failed");return t.json()},()=>Or.utils.healthCheck())},async getStats(){return zr(async()=>{throw console.log("Getting stats via real API"),new Error("Real API not implemented yet")},()=>Or.utils.getStats())}},bp=()=>{Ko.setMode("real"),console.log("🚀 HRM Finance initialized in REAL API mode for production")};bp();const _p=()=>{};var zu={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fm=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},Sp=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[r++];e[n++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=t[r++],a=t[r++],c=t[r++],u=((i&7)<<18|(o&63)<<12|(a&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const o=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return e.join("")},ym={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const o=t[i],a=i+1<t.length,c=a?t[i+1]:0,u=i+2<t.length,h=u?t[i+2]:0,f=o>>2,p=(o&3)<<4|c>>4;let _=(c&15)<<2|h>>6,E=h&63;u||(E=64,a||(_=64)),n.push(r[f],r[p],r[_],r[E])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(fm(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Sp(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const o=r[t.charAt(i++)],c=i<t.length?r[t.charAt(i)]:0;++i;const h=i<t.length?r[t.charAt(i)]:64;++i;const p=i<t.length?r[t.charAt(i)]:64;if(++i,o==null||c==null||h==null||p==null)throw new Pp;const _=o<<2|c>>4;if(n.push(_),h!==64){const E=c<<4&240|h>>2;if(n.push(E),p!==64){const A=h<<6&192|p;n.push(A)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Pp extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const wp=function(t){const e=fm(t);return ym.encodeByteArray(e,!0)},la=function(t){return wp(t).replace(/\./g,"")},gm=function(t){try{return ym.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cp(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ap=()=>Cp().__FIREBASE_DEFAULTS__,Ip=()=>{if(typeof process>"u"||typeof zu>"u")return;const t=zu.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Ep=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&gm(t[1]);return e&&JSON.parse(e)},$a=()=>{try{return _p()||Ap()||Ip()||Ep()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},pm=t=>$a()?.emulatorHosts?.[t],xp=t=>{const e=pm(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},vm=()=>$a()?.config,bm=t=>$a()?.[`_${t}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tp{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lo(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function _m(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $p(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...t};return[la(JSON.stringify(r)),la(JSON.stringify(a)),""].join(".")}const Mo={};function kp(){const t={prod:[],emulator:[]};for(const e of Object.keys(Mo))Mo[e]?t.emulator.push(e):t.prod.push(e);return t}function Rp(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let qu=!1;function Sm(t,e){if(typeof window>"u"||typeof document>"u"||!lo(window.location.host)||Mo[t]===e||Mo[t]||qu)return;Mo[t]=e;function r(_){return`__firebase__banner__${_}`}const n="__firebase__banner",o=kp().prod.length>0;function a(){const _=document.getElementById(n);_&&_.remove()}function c(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function u(_,E){_.setAttribute("width","24"),_.setAttribute("id",E),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function h(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{qu=!0,a()},_}function f(_,E){_.setAttribute("id",E),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function p(){const _=Rp(n),E=r("text"),A=document.getElementById(E)||document.createElement("span"),T=r("learnmore"),x=document.getElementById(T)||document.createElement("a"),$=r("preprendIcon"),O=document.getElementById($)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const q=_.element;c(q),f(x,T);const z=h();u(O,$),q.append(O,A,x,z),document.body.appendChild(q)}o?(A.innerText="Preview backend disconnected.",O.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(O.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,A.innerText="Preview backend running in this workspace."),A.setAttribute("id",E)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $r(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Dp(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test($r())}function Np(){const t=$a()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Lp(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Mp(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Op(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Vp(){const t=$r();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Bp(){return!Np()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Fp(){try{return typeof indexedDB=="object"}catch{return!1}}function Up(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jp="FirebaseError";class Mn extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=jp,Object.setPrototypeOf(this,Mn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,as.prototype.create)}}class as{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,o=this.errors[e],a=o?zp(o,n):"Error",c=`${this.serviceName}: ${a} (${i}).`;return new Mn(i,c,n)}}function zp(t,e){return t.replace(qp,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const qp=/\{\$([^}]+)}/g;function Hp(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ci(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const o=t[i],a=e[i];if(Hu(o)&&Hu(a)){if(!Ci(o,a))return!1}else if(o!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function Hu(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ls(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Wp(t,e){const r=new Gp(t,e);return r.subscribe.bind(r)}class Gp{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");Kp(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=rl),i.error===void 0&&(i.error=rl),i.complete===void 0&&(i.complete=rl);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Kp(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function rl(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hr(t){return t&&t._delegate?t._delegate:t}class Ai{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yp{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new Tp;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Jp(e))try{this.getOrInitializeService({instanceIdentifier:pi})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:i});n.resolve(o)}catch{}}}}clearInstance(e=pi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=pi){return this.instances.has(e)}getOptions(e=pi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[o,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(o);n===c&&a.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const o=this.instances.get(n);return o&&e(o,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Qp(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=pi){return this.component?this.component.multipleInstances?e:pi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Qp(t){return t===pi?void 0:t}function Jp(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xp{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new Yp(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ct;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ct||(Ct={}));const Zp={debug:Ct.DEBUG,verbose:Ct.VERBOSE,info:Ct.INFO,warn:Ct.WARN,error:Ct.ERROR,silent:Ct.SILENT},ev=Ct.INFO,tv={[Ct.DEBUG]:"log",[Ct.VERBOSE]:"log",[Ct.INFO]:"info",[Ct.WARN]:"warn",[Ct.ERROR]:"error"},rv=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=tv[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class pc{constructor(e){this.name=e,this._logLevel=ev,this._logHandler=rv,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ct))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Zp[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ct.DEBUG,...e),this._logHandler(this,Ct.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ct.VERBOSE,...e),this._logHandler(this,Ct.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ct.INFO,...e),this._logHandler(this,Ct.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ct.WARN,...e),this._logHandler(this,Ct.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ct.ERROR,...e),this._logHandler(this,Ct.ERROR,...e)}}const nv=(t,e)=>e.some(r=>t instanceof r);let Wu,Gu;function iv(){return Wu||(Wu=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ov(){return Gu||(Gu=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Pm=new WeakMap,Vl=new WeakMap,wm=new WeakMap,nl=new WeakMap,vc=new WeakMap;function sv(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",a)},o=()=>{r(Xn(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&Pm.set(r,t)}).catch(()=>{}),vc.set(e,t),e}function av(t){if(Vl.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",a),t.removeEventListener("abort",a)},o=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",a),t.addEventListener("abort",a)});Vl.set(t,e)}let Bl={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Vl.get(t);if(e==="objectStoreNames")return t.objectStoreNames||wm.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Xn(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function lv(t){Bl=t(Bl)}function cv(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(il(this),e,...r);return wm.set(n,e.sort?e.sort():[e]),Xn(n)}:ov().includes(t)?function(...e){return t.apply(il(this),e),Xn(Pm.get(this))}:function(...e){return Xn(t.apply(il(this),e))}}function uv(t){return typeof t=="function"?cv(t):(t instanceof IDBTransaction&&av(t),nv(t,iv())?new Proxy(t,Bl):t)}function Xn(t){if(t instanceof IDBRequest)return sv(t);if(nl.has(t))return nl.get(t);const e=uv(t);return e!==t&&(nl.set(t,e),vc.set(e,t)),e}const il=t=>vc.get(t);function dv(t,e,{blocked:r,upgrade:n,blocking:i,terminated:o}={}){const a=indexedDB.open(t,e),c=Xn(a);return n&&a.addEventListener("upgradeneeded",u=>{n(Xn(a.result),u.oldVersion,u.newVersion,Xn(a.transaction),u)}),r&&a.addEventListener("blocked",u=>r(u.oldVersion,u.newVersion,u)),c.then(u=>{o&&u.addEventListener("close",()=>o()),i&&u.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const hv=["get","getKey","getAll","getAllKeys","count"],mv=["put","add","delete","clear"],ol=new Map;function Ku(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(ol.get(e))return ol.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=mv.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||hv.includes(r)))return;const o=async function(a,...c){const u=this.transaction(a,i?"readwrite":"readonly");let h=u.store;return n&&(h=h.index(c.shift())),(await Promise.all([h[r](...c),i&&u.done]))[0]};return ol.set(e,o),o}lv(t=>({...t,get:(e,r,n)=>Ku(e,r)||t.get(e,r,n),has:(e,r)=>!!Ku(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fv{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(yv(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function yv(t){return t.getComponent()?.type==="VERSION"}const Fl="@firebase/app",Yu="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kn=new pc("@firebase/app"),gv="@firebase/app-compat",pv="@firebase/analytics-compat",vv="@firebase/analytics",bv="@firebase/app-check-compat",_v="@firebase/app-check",Sv="@firebase/auth",Pv="@firebase/auth-compat",wv="@firebase/database",Cv="@firebase/data-connect",Av="@firebase/database-compat",Iv="@firebase/functions",Ev="@firebase/functions-compat",xv="@firebase/installations",Tv="@firebase/installations-compat",$v="@firebase/messaging",kv="@firebase/messaging-compat",Rv="@firebase/performance",Dv="@firebase/performance-compat",Nv="@firebase/remote-config",Lv="@firebase/remote-config-compat",Mv="@firebase/storage",Ov="@firebase/storage-compat",Vv="@firebase/firestore",Bv="@firebase/ai",Fv="@firebase/firestore-compat",Uv="firebase",jv="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ul="[DEFAULT]",zv={[Fl]:"fire-core",[gv]:"fire-core-compat",[vv]:"fire-analytics",[pv]:"fire-analytics-compat",[_v]:"fire-app-check",[bv]:"fire-app-check-compat",[Sv]:"fire-auth",[Pv]:"fire-auth-compat",[wv]:"fire-rtdb",[Cv]:"fire-data-connect",[Av]:"fire-rtdb-compat",[Iv]:"fire-fn",[Ev]:"fire-fn-compat",[xv]:"fire-iid",[Tv]:"fire-iid-compat",[$v]:"fire-fcm",[kv]:"fire-fcm-compat",[Rv]:"fire-perf",[Dv]:"fire-perf-compat",[Nv]:"fire-rc",[Lv]:"fire-rc-compat",[Mv]:"fire-gcs",[Ov]:"fire-gcs-compat",[Vv]:"fire-fst",[Fv]:"fire-fst-compat",[Bv]:"fire-vertex","fire-js":"fire-js",[Uv]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ca=new Map,qv=new Map,jl=new Map;function Qu(t,e){try{t.container.addComponent(e)}catch(r){kn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Zi(t){const e=t.name;if(jl.has(e))return kn.debug(`There were multiple attempts to register component ${e}.`),!1;jl.set(e,t);for(const r of ca.values())Qu(r,t);for(const r of qv.values())Qu(r,t);return!0}function bc(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Fr(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hv={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Zn=new as("app","Firebase",Hv);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wv{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ai("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Zn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const co=jv;function Cm(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:Ul,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw Zn.create("bad-app-name",{appName:String(i)});if(r||(r=vm()),!r)throw Zn.create("no-options");const o=ca.get(i);if(o){if(Ci(r,o.options)&&Ci(n,o.config))return o;throw Zn.create("duplicate-app",{appName:i})}const a=new Xp(i);for(const u of jl.values())a.addComponent(u);const c=new Wv(r,n,a);return ca.set(i,c),c}function Am(t=Ul){const e=ca.get(t);if(!e&&t===Ul&&vm())return Cm();if(!e)throw Zn.create("no-app",{appName:t});return e}function ei(t,e,r){let n=zv[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${n}" with version "${e}":`];i&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),kn.warn(a.join(" "));return}Zi(new Ai(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gv="firebase-heartbeat-database",Kv=1,Yo="firebase-heartbeat-store";let sl=null;function Im(){return sl||(sl=dv(Gv,Kv,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Yo)}catch(r){console.warn(r)}}}}).catch(t=>{throw Zn.create("idb-open",{originalErrorMessage:t.message})})),sl}async function Yv(t){try{const r=(await Im()).transaction(Yo),n=await r.objectStore(Yo).get(Em(t));return await r.done,n}catch(e){if(e instanceof Mn)kn.warn(e.message);else{const r=Zn.create("idb-get",{originalErrorMessage:e?.message});kn.warn(r.message)}}}async function Ju(t,e){try{const n=(await Im()).transaction(Yo,"readwrite");await n.objectStore(Yo).put(e,Em(t)),await n.done}catch(r){if(r instanceof Mn)kn.warn(r.message);else{const n=Zn.create("idb-set",{originalErrorMessage:r?.message});kn.warn(n.message)}}}function Em(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qv=1024,Jv=30;class Xv{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new eb(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Xu();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>Jv){const i=tb(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){kn.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Xu(),{heartbeatsToSend:r,unsentEntries:n}=Zv(this._heartbeatsCache.heartbeats),i=la(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return kn.warn(e),""}}}function Xu(){return new Date().toISOString().substring(0,10)}function Zv(t,e=Qv){const r=[];let n=t.slice();for(const i of t){const o=r.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),Zu(r)>e){o.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),Zu(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class eb{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Fp()?Up().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Yv(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Ju(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Ju(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Zu(t){return la(JSON.stringify({version:2,heartbeats:t})).length}function tb(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rb(t){Zi(new Ai("platform-logger",e=>new fv(e),"PRIVATE")),Zi(new Ai("heartbeat",e=>new Xv(e),"PRIVATE")),ei(Fl,Yu,t),ei(Fl,Yu,"esm2020"),ei("fire-js","")}rb("");function xm(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const nb=xm,Tm=new as("auth","Firebase",xm());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ua=new pc("@firebase/auth");function ib(t,...e){ua.logLevel<=Ct.WARN&&ua.warn(`Auth (${co}): ${t}`,...e)}function Hs(t,...e){ua.logLevel<=Ct.ERROR&&ua.error(`Auth (${co}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hn(t,...e){throw Sc(t,...e)}function Qr(t,...e){return Sc(t,...e)}function _c(t,e,r){const n={...nb(),[e]:r};return new as("auth","Firebase",n).create(e,{appName:t.name})}function ti(t){return _c(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function $m(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&hn(t,"argument-error"),_c(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Sc(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return Tm.create(t,...e)}function dt(t,e,...r){if(!t)throw Sc(e,...r)}function An(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Hs(e),new Error(e)}function Rn(t,e){t||An(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zl(){return typeof self<"u"&&self.location?.href||""}function ob(){return ed()==="http:"||ed()==="https:"}function ed(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sb(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(ob()||Mp()||"connection"in navigator)?navigator.onLine:!0}function ab(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs{constructor(e,r){this.shortDelay=e,this.longDelay=r,Rn(r>e,"Short delay should be less than long delay!"),this.isMobile=Dp()||Op()}get(){return sb()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pc(t,e){Rn(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class km{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;An("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;An("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;An("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lb={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cb=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],ub=new cs(3e4,6e4);function wc(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function uo(t,e,r,n,i={}){return Rm(t,i,async()=>{let o={},a={};n&&(e==="GET"?a=n:o={body:JSON.stringify(n)});const c=ls({key:t.config.apiKey,...a}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const h={method:e,headers:u,...o};return Lp()||(h.referrerPolicy="no-referrer"),t.emulatorConfig&&lo(t.emulatorConfig.host)&&(h.credentials="include"),km.fetch()(await Dm(t,t.config.apiHost,r,c),h)})}async function Rm(t,e,r){t._canInitEmulator=!1;const n={...lb,...e};try{const i=new hb(t),o=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await o.json();if("needConfirmation"in a)throw Es(t,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{const c=o.ok?a.errorMessage:a.error.message,[u,h]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Es(t,"credential-already-in-use",a);if(u==="EMAIL_EXISTS")throw Es(t,"email-already-in-use",a);if(u==="USER_DISABLED")throw Es(t,"user-disabled",a);const f=n[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw _c(t,f,h);hn(t,f)}}catch(i){if(i instanceof Mn)throw i;hn(t,"network-request-failed",{message:String(i)})}}async function db(t,e,r,n,i={}){const o=await uo(t,e,r,n,i);return"mfaPendingCredential"in o&&hn(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function Dm(t,e,r,n){const i=`${e}${r}?${n}`,o=t,a=o.config.emulator?Pc(t.config,i):`${t.config.apiScheme}://${i}`;return cb.includes(r)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(a).toString():a}class hb{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Qr(this.auth,"network-request-failed")),ub.get())})}}function Es(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Qr(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mb(t,e){return uo(t,"POST","/v1/accounts:delete",e)}async function da(t,e){return uo(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oo(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function fb(t,e=!1){const r=Hr(t),n=await r.getIdToken(e),i=Cc(n);dt(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,a=o?.sign_in_provider;return{claims:i,token:n,authTime:Oo(al(i.auth_time)),issuedAtTime:Oo(al(i.iat)),expirationTime:Oo(al(i.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}}function al(t){return Number(t)*1e3}function Cc(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Hs("JWT malformed, contained fewer than 3 sections"),null;try{const i=gm(r);return i?JSON.parse(i):(Hs("Failed to decode base64 JWT payload"),null)}catch(i){return Hs("Caught error parsing JWT payload as JSON",i?.toString()),null}}function td(t){const e=Cc(t);return dt(e,"internal-error"),dt(typeof e.exp<"u","internal-error"),dt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qo(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Mn&&yb(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function yb({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gb{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Oo(this.lastLoginAt),this.creationTime=Oo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ha(t){const e=t.auth,r=await t.getIdToken(),n=await Qo(t,da(e,{idToken:r}));dt(n?.users.length,e,"internal-error");const i=n.users[0];t._notifyReloadListener(i);const o=i.providerUserInfo?.length?Nm(i.providerUserInfo):[],a=vb(t.providerData,o),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!a?.length,h=c?u:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new ql(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(t,f)}async function pb(t){const e=Hr(t);await ha(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function vb(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function Nm(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bb(t,e){const r=await Rm(t,{},async()=>{const n=ls({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=t.config,a=await Dm(t,i,"/v1/token",`key=${o}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:n};return t.emulatorConfig&&lo(t.emulatorConfig.host)&&(u.credentials="include"),km.fetch()(a,u)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function _b(t,e){return uo(t,"POST","/v2/accounts:revokeToken",wc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){dt(e.idToken,"internal-error"),dt(typeof e.idToken<"u","internal-error"),dt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):td(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){dt(e.length!==0,"internal-error");const r=td(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(dt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:o}=await bb(e,r);this.updateTokensAndExpiration(n,i,Number(o))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:o}=r,a=new Yi;return n&&(dt(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(dt(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),o&&(dt(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Yi,this.toJSON())}_performRefresh(){return An("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Un(t,e){dt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Kr{constructor({uid:e,auth:r,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new gb(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new ql(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await Qo(this,this.stsTokenManager.getToken(this.auth,e));return dt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return fb(this,e)}reload(){return pb(this)}_assign(e){this!==e&&(dt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Kr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){dt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await ha(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Fr(this.auth.app))return Promise.reject(ti(this.auth));const e=await this.getIdToken();return await Qo(this,mb(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,i=r.email??void 0,o=r.phoneNumber??void 0,a=r.photoURL??void 0,c=r.tenantId??void 0,u=r._redirectEventId??void 0,h=r.createdAt??void 0,f=r.lastLoginAt??void 0,{uid:p,emailVerified:_,isAnonymous:E,providerData:A,stsTokenManager:T}=r;dt(p&&T,e,"internal-error");const x=Yi.fromJSON(this.name,T);dt(typeof p=="string",e,"internal-error"),Un(n,e.name),Un(i,e.name),dt(typeof _=="boolean",e,"internal-error"),dt(typeof E=="boolean",e,"internal-error"),Un(o,e.name),Un(a,e.name),Un(c,e.name),Un(u,e.name),Un(h,e.name),Un(f,e.name);const $=new Kr({uid:p,auth:e,email:i,emailVerified:_,displayName:n,isAnonymous:E,photoURL:a,phoneNumber:o,tenantId:c,stsTokenManager:x,createdAt:h,lastLoginAt:f});return A&&Array.isArray(A)&&($.providerData=A.map(O=>({...O}))),u&&($._redirectEventId=u),$}static async _fromIdTokenResponse(e,r,n=!1){const i=new Yi;i.updateFromServerResponse(r);const o=new Kr({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await ha(o),o}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];dt(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?Nm(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!o?.length,c=new Yi;c.updateFromIdToken(n);const u=new Kr({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:a}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new ql(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(u,h),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rd=new Map;function In(t){Rn(t instanceof Function,"Expected a class definition");let e=rd.get(t);return e?(Rn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,rd.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lm{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}Lm.type="NONE";const nd=Lm;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ws(t,e,r){return`firebase:${t}:${e}:${r}`}class Qi{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:o}=this.auth;this.fullUserKey=Ws(this.userKey,i.apiKey,o),this.fullPersistenceKey=Ws("persistence",i.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await da(this.auth,{idToken:e}).catch(()=>{});return r?Kr._fromGetAccountInfoResponse(this.auth,r,e):null}return Kr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Qi(In(nd),e,n);const i=(await Promise.all(r.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let o=i[0]||In(nd);const a=Ws(n,e.config.apiKey,e.name);let c=null;for(const h of r)try{const f=await h._get(a);if(f){let p;if(typeof f=="string"){const _=await da(e,{idToken:f}).catch(()=>{});if(!_)break;p=await Kr._fromGetAccountInfoResponse(e,_,f)}else p=Kr._fromJSON(e,f);h!==o&&(c=p),o=h;break}}catch{}const u=i.filter(h=>h._shouldAllowMigration);return!o._shouldAllowMigration||!u.length?new Qi(o,e,n):(o=u[0],c&&await o._set(a,c.toJSON()),await Promise.all(r.map(async h=>{if(h!==o)try{await h._remove(a)}catch{}})),new Qi(o,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function id(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Bm(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Mm(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Um(e))return"Blackberry";if(jm(e))return"Webos";if(Om(e))return"Safari";if((e.includes("chrome/")||Vm(e))&&!e.includes("edge/"))return"Chrome";if(Fm(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function Mm(t=$r()){return/firefox\//i.test(t)}function Om(t=$r()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Vm(t=$r()){return/crios\//i.test(t)}function Bm(t=$r()){return/iemobile/i.test(t)}function Fm(t=$r()){return/android/i.test(t)}function Um(t=$r()){return/blackberry/i.test(t)}function jm(t=$r()){return/webos/i.test(t)}function Ac(t=$r()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Sb(t=$r()){return Ac(t)&&!!window.navigator?.standalone}function Pb(){return Vp()&&document.documentMode===10}function zm(t=$r()){return Ac(t)||Fm(t)||jm(t)||Um(t)||/windows phone/i.test(t)||Bm(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qm(t,e=[]){let r;switch(t){case"Browser":r=id($r());break;case"Worker":r=`${id($r())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${co}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wb{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=o=>new Promise((a,c)=>{try{const u=e(o);a(u)}catch(u){c(u)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cb(t,e={}){return uo(t,"GET","/v2/passwordPolicy",wc(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ab=6;class Ib{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??Ab,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eb{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new od(this),this.idTokenSubscription=new od(this),this.beforeStateQueue=new wb(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Tm,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=In(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Qi.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await da(this,{idToken:e}),n=await Kr._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Fr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=this.redirectUser?._redirectEventId,a=n?._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(n=c.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return dt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await ha(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=ab()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Fr(this.app))return Promise.reject(ti(this));const r=e?Hr(e):null;return r&&dt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&dt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Fr(this.app)?Promise.reject(ti(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Fr(this.app)?Promise.reject(ti(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(In(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Cb(this),r=new Ib(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new as("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await _b(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&In(e)||this._popupRedirectResolver;dt(r,this,"argument-error"),this.redirectPersistenceManager=await Qi.create(this,[In(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const o=typeof r=="function"?r:r.next.bind(r);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(dt(c,this,"internal-error"),c.then(()=>{a||o(this.currentUser)}),typeof r=="function"){const u=e.addObserver(r,n,i);return()=>{a=!0,u()}}else{const u=e.addObserver(r);return()=>{a=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return dt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=qm(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(Fr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&ib(`Error while retrieving App Check token: ${e.error}`),e?.token}}function $i(t){return Hr(t)}class od{constructor(e){this.auth=e,this.observer=null,this.addObserver=Wp(r=>this.observer=r)}get next(){return dt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ic={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function xb(t){Ic=t}function Tb(t){return Ic.loadJS(t)}function $b(){return Ic.gapiScript}function kb(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rb(t,e){const r=bc(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),o=r.getOptions();if(Ci(o,e??{}))return i;hn(i,"already-initialized")}return r.initialize({options:e})}function Db(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(In);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function Nb(t,e,r){const n=$i(t);dt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,o=Hm(e),{host:a,port:c}=Lb(e),u=c===null?"":`:${c}`,h={url:`${o}//${a}${u}/`},f=Object.freeze({host:a,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){dt(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),dt(Ci(h,n.config.emulator)&&Ci(f,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=h,n.emulatorConfig=f,n.settings.appVerificationDisabledForTesting=!0,lo(a)?(_m(`${o}//${a}${u}`),Sm("Auth",!0)):Mb()}function Hm(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Lb(t){const e=Hm(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const o=i[1];return{host:o,port:sd(n.substr(o.length+1))}}else{const[o,a]=n.split(":");return{host:o,port:sd(a)}}}function sd(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Mb(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wm{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return An("not implemented")}_getIdTokenResponse(e){return An("not implemented")}_linkToIdToken(e,r){return An("not implemented")}_getReauthenticationResolver(e){return An("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ji(t,e){return db(t,"POST","/v1/accounts:signInWithIdp",wc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ob="http://localhost";class Ii extends Wm{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Ii(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):hn("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...o}=r;if(!n||!i)return null;const a=new Ii(n,i);return a.idToken=o.idToken||void 0,a.accessToken=o.accessToken||void 0,a.secret=o.secret,a.nonce=o.nonce,a.pendingToken=o.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return Ji(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Ji(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Ji(e,r)}buildRequest(){const e={requestUri:Ob,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=ls(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us extends ka{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn extends us{constructor(){super("facebook.com")}static credential(e){return Ii._fromParams({providerId:Gn.PROVIDER_ID,signInMethod:Gn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gn.credentialFromTaggedObject(e)}static credentialFromError(e){return Gn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Gn.credential(e.oauthAccessToken)}catch{return null}}}Gn.FACEBOOK_SIGN_IN_METHOD="facebook.com";Gn.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn extends us{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Ii._fromParams({providerId:sn.PROVIDER_ID,signInMethod:sn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return sn.credentialFromTaggedObject(e)}static credentialFromError(e){return sn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return sn.credential(r,n)}catch{return null}}}sn.GOOGLE_SIGN_IN_METHOD="google.com";sn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn extends us{constructor(){super("github.com")}static credential(e){return Ii._fromParams({providerId:Kn.PROVIDER_ID,signInMethod:Kn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Kn.credentialFromTaggedObject(e)}static credentialFromError(e){return Kn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Kn.credential(e.oauthAccessToken)}catch{return null}}}Kn.GITHUB_SIGN_IN_METHOD="github.com";Kn.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn extends us{constructor(){super("twitter.com")}static credential(e,r){return Ii._fromParams({providerId:Yn.PROVIDER_ID,signInMethod:Yn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Yn.credentialFromTaggedObject(e)}static credentialFromError(e){return Yn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Yn.credential(r,n)}catch{return null}}}Yn.TWITTER_SIGN_IN_METHOD="twitter.com";Yn.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const o=await Kr._fromIdTokenResponse(e,n,i),a=ad(n);return new eo({user:o,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=ad(n);return new eo({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function ad(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma extends Mn{constructor(e,r,n,i){super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,ma.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new ma(e,r,n,i)}}function Gm(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?ma._fromErrorAndOperation(t,o,e,n):o})}async function Vb(t,e,r=!1){const n=await Qo(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return eo._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bb(t,e,r=!1){const{auth:n}=t;if(Fr(n.app))return Promise.reject(ti(n));const i="reauthenticate";try{const o=await Qo(t,Gm(n,i,e,t),r);dt(o.idToken,n,"internal-error");const a=Cc(o.idToken);dt(a,n,"internal-error");const{sub:c}=a;return dt(t.uid===c,n,"user-mismatch"),eo._forOperation(t,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&hn(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Km(t,e,r=!1){if(Fr(t.app))return Promise.reject(ti(t));const n="signIn",i=await Gm(t,n,e),o=await eo._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(o.user),o}async function Fb(t,e){return Km($i(t),e)}function Ub(t,e,r,n){return Hr(t).onIdTokenChanged(e,r,n)}function jb(t,e,r){return Hr(t).beforeAuthStateChanged(e,r)}function zb(t,e,r,n){return Hr(t).onAuthStateChanged(e,r,n)}function qb(t){return Hr(t).signOut()}const fa="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ym{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(fa,"1"),this.storage.removeItem(fa),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hb=1e3,Wb=10;class Qm extends Ym{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=zm(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,c,u)=>{this.notifyListeners(a,u)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},o=this.storage.getItem(n);Pb()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Wb):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},Hb)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}Qm.type="LOCAL";const Gb=Qm;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jm extends Ym{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}Jm.type="SESSION";const Xm=Jm;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kb(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new Ra(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:o}=r.data,a=this.handlersMap[i];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const c=Array.from(a).map(async h=>h(r.origin,o)),u=await Kb(c);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:u})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ra.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ec(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yb{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,a;return new Promise((c,u)=>{const h=Ec("",20);i.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(p){const _=p;if(_.data.eventId===h)switch(_.data.status){case"ack":clearTimeout(f),o=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),c(_.data.response);break;default:clearTimeout(f),clearTimeout(o),u(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:h,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function an(){return window}function Qb(t){an().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zm(){return typeof an().WorkerGlobalScope<"u"&&typeof an().importScripts=="function"}async function Jb(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Xb(){return navigator?.serviceWorker?.controller||null}function Zb(){return Zm()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ef="firebaseLocalStorageDb",e0=1,ya="firebaseLocalStorage",tf="fbase_key";class ds{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Da(t,e){return t.transaction([ya],e?"readwrite":"readonly").objectStore(ya)}function t0(){const t=indexedDB.deleteDatabase(ef);return new ds(t).toPromise()}function Hl(){const t=indexedDB.open(ef,e0);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(ya,{keyPath:tf})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(ya)?e(n):(n.close(),await t0(),e(await Hl()))})})}async function ld(t,e,r){const n=Da(t,!0).put({[tf]:e,value:r});return new ds(n).toPromise()}async function r0(t,e){const r=Da(t,!1).get(e),n=await new ds(r).toPromise();return n===void 0?null:n.value}function cd(t,e){const r=Da(t,!0).delete(e);return new ds(r).toPromise()}const n0=800,i0=3;class rf{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Hl(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>i0)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Zm()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ra._getInstance(Zb()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await Jb(),!this.activeServiceWorker)return;this.sender=new Yb(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Xb()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Hl();return await ld(e,fa,"1"),await cd(e,fa),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>ld(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>r0(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>cd(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=Da(i,!1).getAll();return new ds(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),n0)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}rf.type="LOCAL";const o0=rf;new cs(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xc(t,e){return e?In(e):(dt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tc extends Wm{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ji(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Ji(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Ji(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function s0(t){return Km(t.auth,new Tc(t),t.bypassAuthState)}function a0(t){const{auth:e,user:r}=t;return dt(r,e,"internal-error"),Bb(r,new Tc(t),t.bypassAuthState)}async function l0(t){const{auth:e,user:r}=t;return dt(r,e,"internal-error"),Vb(r,new Tc(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(e,r,n,i,o=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:o,error:a,type:c}=e;if(a){this.reject(a);return}const u={auth:this.auth,requestUri:r,sessionId:n,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return s0;case"linkViaPopup":case"linkViaRedirect":return l0;case"reauthViaPopup":case"reauthViaRedirect":return a0;default:hn(this.auth,"internal-error")}}resolve(e){Rn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Rn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c0=new cs(2e3,1e4);async function u0(t,e,r){if(Fr(t.app))return Promise.reject(Qr(t,"operation-not-supported-in-this-environment"));const n=$i(t);$m(t,e,ka);const i=xc(n,r);return new _i(n,"signInViaPopup",e,i).executeNotNull()}class _i extends nf{constructor(e,r,n,i,o){super(e,r,i,o),this.provider=n,this.authWindow=null,this.pollId=null,_i.currentPopupAction&&_i.currentPopupAction.cancel(),_i.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return dt(e,this.auth,"internal-error"),e}async onExecution(){Rn(this.filter.length===1,"Popup operations only handle one event");const e=Ec();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Qr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Qr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,_i.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Qr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,c0.get())};e()}}_i.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d0="pendingRedirect",Gs=new Map;class h0 extends nf{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Gs.get(this.auth._key());if(!e){try{const n=await m0(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Gs.set(this.auth._key(),e)}return this.bypassAuthState||Gs.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function m0(t,e){const r=sf(e),n=of(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}async function f0(t,e){return of(t)._set(sf(e),"true")}function y0(t,e){Gs.set(t._key(),e)}function of(t){return In(t._redirectPersistence)}function sf(t){return Ws(d0,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g0(t,e,r){return p0(t,e,r)}async function p0(t,e,r){if(Fr(t.app))return Promise.reject(ti(t));const n=$i(t);$m(t,e,ka),await n._initializationPromise;const i=xc(n,r);return await f0(i,n),i._openRedirect(n,e,"signInViaRedirect")}async function v0(t,e){return await $i(t)._initializationPromise,af(t,e,!1)}async function af(t,e,r=!1){if(Fr(t.app))return Promise.reject(ti(t));const n=$i(t),i=xc(n,e),a=await new h0(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b0=10*60*1e3;class _0{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!S0(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!lf(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(Qr(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=b0&&this.cachedEventUids.clear(),this.cachedEventUids.has(ud(e))}saveEventToCache(e){this.cachedEventUids.add(ud(e)),this.lastProcessedEventTime=Date.now()}}function ud(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function lf({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function S0(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return lf(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P0(t,e={}){return uo(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w0=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,C0=/^https?/;async function A0(t){if(t.config.emulator)return;const{authorizedDomains:e}=await P0(t);for(const r of e)try{if(I0(r))return}catch{}hn(t,"unauthorized-domain")}function I0(t){const e=zl(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!C0.test(r))return!1;if(w0.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E0=new cs(3e4,6e4);function dd(){const t=an().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function x0(t){return new Promise((e,r)=>{function n(){dd(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{dd(),r(Qr(t,"network-request-failed"))},timeout:E0.get()})}if(an().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(an().gapi?.load)n();else{const i=kb("iframefcb");return an()[i]=()=>{gapi.load?n():r(Qr(t,"network-request-failed"))},Tb(`${$b()}?onload=${i}`).catch(o=>r(o))}}).catch(e=>{throw Ks=null,e})}let Ks=null;function T0(t){return Ks=Ks||x0(t),Ks}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $0=new cs(5e3,15e3),k0="__/auth/iframe",R0="emulator/auth/iframe",D0={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},N0=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function L0(t){const e=t.config;dt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Pc(e,R0):`https://${t.config.authDomain}/${k0}`,n={apiKey:e.apiKey,appName:t.name,v:co},i=N0.get(t.config.apiHost);i&&(n.eid=i);const o=t._getFrameworks();return o.length&&(n.fw=o.join(",")),`${r}?${ls(n).slice(1)}`}async function M0(t){const e=await T0(t),r=an().gapi;return dt(r,t,"internal-error"),e.open({where:document.body,url:L0(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:D0,dontclear:!0},n=>new Promise(async(i,o)=>{await n.restyle({setHideOnLeave:!1});const a=Qr(t,"network-request-failed"),c=an().setTimeout(()=>{o(a)},$0.get());function u(){an().clearTimeout(c),i(n)}n.ping(u).then(u,()=>{o(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O0={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},V0=500,B0=600,F0="_blank",U0="http://localhost";class hd{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function j0(t,e,r,n=V0,i=B0){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const u={...O0,width:n.toString(),height:i.toString(),top:o,left:a},h=$r().toLowerCase();r&&(c=Vm(h)?F0:r),Mm(h)&&(e=e||U0,u.scrollbars="yes");const f=Object.entries(u).reduce((_,[E,A])=>`${_}${E}=${A},`,"");if(Sb(h)&&c!=="_self")return z0(e||"",c),new hd(null);const p=window.open(e||"",c,f);dt(p,t,"popup-blocked");try{p.focus()}catch{}return new hd(p)}function z0(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q0="__/auth/handler",H0="emulator/auth/handler",W0=encodeURIComponent("fac");async function md(t,e,r,n,i,o){dt(t.config.authDomain,t,"auth-domain-config-required"),dt(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:co,eventId:i};if(e instanceof ka){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",Hp(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))a[f]=p}if(e instanceof us){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const c=a;for(const f of Object.keys(c))c[f]===void 0&&delete c[f];const u=await t._getAppCheckToken(),h=u?`#${W0}=${encodeURIComponent(u)}`:"";return`${G0(t)}?${ls(c).slice(1)}${h}`}function G0({config:t}){return t.emulator?Pc(t,H0):`https://${t.authDomain}/${q0}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ll="webStorageSupport";class K0{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Xm,this._completeRedirectFn=af,this._overrideRedirectResult=y0}async _openPopup(e,r,n,i){Rn(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const o=await md(e,r,n,zl(),i);return j0(e,o,Ec())}async _openRedirect(e,r,n,i){await this._originValidation(e);const o=await md(e,r,n,zl(),i);return Qb(o),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:o}=this.eventManagers[r];return i?Promise.resolve(i):(Rn(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await M0(e),n=new _0(e);return r.register("authEvent",i=>(dt(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(ll,{type:ll},i=>{const o=i?.[0]?.[ll];o!==void 0&&r(!!o),hn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=A0(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return zm()||Om()||Ac()}}const Y0=K0;var fd="@firebase/auth",yd="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q0{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){dt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J0(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function X0(t){Zi(new Ai("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=n.options;dt(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const u={apiKey:a,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:qm(t)},h=new Eb(n,i,o,u);return Db(h,r),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Zi(new Ai("auth-internal",e=>{const r=$i(e.getProvider("auth").getImmediate());return(n=>new Q0(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),ei(fd,yd,J0(t)),ei(fd,yd,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z0=5*60,e_=bm("authIdTokenMaxAge")||Z0;let gd=null;const t_=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>e_)return;const i=r?.token;gd!==i&&(gd=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function r_(t=Am()){const e=bc(t,"auth");if(e.isInitialized())return e.getImmediate();const r=Rb(t,{popupRedirectResolver:Y0,persistence:[o0,Gb,Xm]}),n=bm("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const a=t_(o.toString());jb(r,a,()=>a(r.currentUser)),Ub(r,c=>a(c))}}const i=pm("auth");return i&&Nb(r,`http://${i}`),r}function n_(){return document.getElementsByTagName("head")?.[0]??document}xb({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const o=Qr("internal-error");o.customData=i,r(o)},n.type="text/javascript",n.charset="UTF-8",n_().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});X0("Browser");var i_="firebase",o_="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ei(i_,o_,"app");var pd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ri,cf;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,v){function S(){}S.prototype=v.prototype,C.D=v.prototype,C.prototype=new S,C.prototype.constructor=C,C.C=function(w,P,I){for(var y=Array(arguments.length-2),le=2;le<arguments.length;le++)y[le-2]=arguments[le];return v.prototype[P].apply(w,y)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(C,v,S){S||(S=0);var w=Array(16);if(typeof v=="string")for(var P=0;16>P;++P)w[P]=v.charCodeAt(S++)|v.charCodeAt(S++)<<8|v.charCodeAt(S++)<<16|v.charCodeAt(S++)<<24;else for(P=0;16>P;++P)w[P]=v[S++]|v[S++]<<8|v[S++]<<16|v[S++]<<24;v=C.g[0],S=C.g[1],P=C.g[2];var I=C.g[3],y=v+(I^S&(P^I))+w[0]+3614090360&4294967295;v=S+(y<<7&4294967295|y>>>25),y=I+(P^v&(S^P))+w[1]+3905402710&4294967295,I=v+(y<<12&4294967295|y>>>20),y=P+(S^I&(v^S))+w[2]+606105819&4294967295,P=I+(y<<17&4294967295|y>>>15),y=S+(v^P&(I^v))+w[3]+3250441966&4294967295,S=P+(y<<22&4294967295|y>>>10),y=v+(I^S&(P^I))+w[4]+4118548399&4294967295,v=S+(y<<7&4294967295|y>>>25),y=I+(P^v&(S^P))+w[5]+1200080426&4294967295,I=v+(y<<12&4294967295|y>>>20),y=P+(S^I&(v^S))+w[6]+2821735955&4294967295,P=I+(y<<17&4294967295|y>>>15),y=S+(v^P&(I^v))+w[7]+4249261313&4294967295,S=P+(y<<22&4294967295|y>>>10),y=v+(I^S&(P^I))+w[8]+1770035416&4294967295,v=S+(y<<7&4294967295|y>>>25),y=I+(P^v&(S^P))+w[9]+2336552879&4294967295,I=v+(y<<12&4294967295|y>>>20),y=P+(S^I&(v^S))+w[10]+4294925233&4294967295,P=I+(y<<17&4294967295|y>>>15),y=S+(v^P&(I^v))+w[11]+2304563134&4294967295,S=P+(y<<22&4294967295|y>>>10),y=v+(I^S&(P^I))+w[12]+1804603682&4294967295,v=S+(y<<7&4294967295|y>>>25),y=I+(P^v&(S^P))+w[13]+4254626195&4294967295,I=v+(y<<12&4294967295|y>>>20),y=P+(S^I&(v^S))+w[14]+2792965006&4294967295,P=I+(y<<17&4294967295|y>>>15),y=S+(v^P&(I^v))+w[15]+1236535329&4294967295,S=P+(y<<22&4294967295|y>>>10),y=v+(P^I&(S^P))+w[1]+4129170786&4294967295,v=S+(y<<5&4294967295|y>>>27),y=I+(S^P&(v^S))+w[6]+3225465664&4294967295,I=v+(y<<9&4294967295|y>>>23),y=P+(v^S&(I^v))+w[11]+643717713&4294967295,P=I+(y<<14&4294967295|y>>>18),y=S+(I^v&(P^I))+w[0]+3921069994&4294967295,S=P+(y<<20&4294967295|y>>>12),y=v+(P^I&(S^P))+w[5]+3593408605&4294967295,v=S+(y<<5&4294967295|y>>>27),y=I+(S^P&(v^S))+w[10]+38016083&4294967295,I=v+(y<<9&4294967295|y>>>23),y=P+(v^S&(I^v))+w[15]+3634488961&4294967295,P=I+(y<<14&4294967295|y>>>18),y=S+(I^v&(P^I))+w[4]+3889429448&4294967295,S=P+(y<<20&4294967295|y>>>12),y=v+(P^I&(S^P))+w[9]+568446438&4294967295,v=S+(y<<5&4294967295|y>>>27),y=I+(S^P&(v^S))+w[14]+3275163606&4294967295,I=v+(y<<9&4294967295|y>>>23),y=P+(v^S&(I^v))+w[3]+4107603335&4294967295,P=I+(y<<14&4294967295|y>>>18),y=S+(I^v&(P^I))+w[8]+1163531501&4294967295,S=P+(y<<20&4294967295|y>>>12),y=v+(P^I&(S^P))+w[13]+2850285829&4294967295,v=S+(y<<5&4294967295|y>>>27),y=I+(S^P&(v^S))+w[2]+4243563512&4294967295,I=v+(y<<9&4294967295|y>>>23),y=P+(v^S&(I^v))+w[7]+1735328473&4294967295,P=I+(y<<14&4294967295|y>>>18),y=S+(I^v&(P^I))+w[12]+2368359562&4294967295,S=P+(y<<20&4294967295|y>>>12),y=v+(S^P^I)+w[5]+4294588738&4294967295,v=S+(y<<4&4294967295|y>>>28),y=I+(v^S^P)+w[8]+2272392833&4294967295,I=v+(y<<11&4294967295|y>>>21),y=P+(I^v^S)+w[11]+1839030562&4294967295,P=I+(y<<16&4294967295|y>>>16),y=S+(P^I^v)+w[14]+4259657740&4294967295,S=P+(y<<23&4294967295|y>>>9),y=v+(S^P^I)+w[1]+2763975236&4294967295,v=S+(y<<4&4294967295|y>>>28),y=I+(v^S^P)+w[4]+1272893353&4294967295,I=v+(y<<11&4294967295|y>>>21),y=P+(I^v^S)+w[7]+4139469664&4294967295,P=I+(y<<16&4294967295|y>>>16),y=S+(P^I^v)+w[10]+3200236656&4294967295,S=P+(y<<23&4294967295|y>>>9),y=v+(S^P^I)+w[13]+681279174&4294967295,v=S+(y<<4&4294967295|y>>>28),y=I+(v^S^P)+w[0]+3936430074&4294967295,I=v+(y<<11&4294967295|y>>>21),y=P+(I^v^S)+w[3]+3572445317&4294967295,P=I+(y<<16&4294967295|y>>>16),y=S+(P^I^v)+w[6]+76029189&4294967295,S=P+(y<<23&4294967295|y>>>9),y=v+(S^P^I)+w[9]+3654602809&4294967295,v=S+(y<<4&4294967295|y>>>28),y=I+(v^S^P)+w[12]+3873151461&4294967295,I=v+(y<<11&4294967295|y>>>21),y=P+(I^v^S)+w[15]+530742520&4294967295,P=I+(y<<16&4294967295|y>>>16),y=S+(P^I^v)+w[2]+3299628645&4294967295,S=P+(y<<23&4294967295|y>>>9),y=v+(P^(S|~I))+w[0]+4096336452&4294967295,v=S+(y<<6&4294967295|y>>>26),y=I+(S^(v|~P))+w[7]+1126891415&4294967295,I=v+(y<<10&4294967295|y>>>22),y=P+(v^(I|~S))+w[14]+2878612391&4294967295,P=I+(y<<15&4294967295|y>>>17),y=S+(I^(P|~v))+w[5]+4237533241&4294967295,S=P+(y<<21&4294967295|y>>>11),y=v+(P^(S|~I))+w[12]+1700485571&4294967295,v=S+(y<<6&4294967295|y>>>26),y=I+(S^(v|~P))+w[3]+2399980690&4294967295,I=v+(y<<10&4294967295|y>>>22),y=P+(v^(I|~S))+w[10]+4293915773&4294967295,P=I+(y<<15&4294967295|y>>>17),y=S+(I^(P|~v))+w[1]+2240044497&4294967295,S=P+(y<<21&4294967295|y>>>11),y=v+(P^(S|~I))+w[8]+1873313359&4294967295,v=S+(y<<6&4294967295|y>>>26),y=I+(S^(v|~P))+w[15]+4264355552&4294967295,I=v+(y<<10&4294967295|y>>>22),y=P+(v^(I|~S))+w[6]+2734768916&4294967295,P=I+(y<<15&4294967295|y>>>17),y=S+(I^(P|~v))+w[13]+1309151649&4294967295,S=P+(y<<21&4294967295|y>>>11),y=v+(P^(S|~I))+w[4]+4149444226&4294967295,v=S+(y<<6&4294967295|y>>>26),y=I+(S^(v|~P))+w[11]+3174756917&4294967295,I=v+(y<<10&4294967295|y>>>22),y=P+(v^(I|~S))+w[2]+718787259&4294967295,P=I+(y<<15&4294967295|y>>>17),y=S+(I^(P|~v))+w[9]+3951481745&4294967295,C.g[0]=C.g[0]+v&4294967295,C.g[1]=C.g[1]+(P+(y<<21&4294967295|y>>>11))&4294967295,C.g[2]=C.g[2]+P&4294967295,C.g[3]=C.g[3]+I&4294967295}n.prototype.u=function(C,v){v===void 0&&(v=C.length);for(var S=v-this.blockSize,w=this.B,P=this.h,I=0;I<v;){if(P==0)for(;I<=S;)i(this,C,I),I+=this.blockSize;if(typeof C=="string"){for(;I<v;)if(w[P++]=C.charCodeAt(I++),P==this.blockSize){i(this,w),P=0;break}}else for(;I<v;)if(w[P++]=C[I++],P==this.blockSize){i(this,w),P=0;break}}this.h=P,this.o+=v},n.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var v=1;v<C.length-8;++v)C[v]=0;var S=8*this.o;for(v=C.length-8;v<C.length;++v)C[v]=S&255,S/=256;for(this.u(C),C=Array(16),v=S=0;4>v;++v)for(var w=0;32>w;w+=8)C[S++]=this.g[v]>>>w&255;return C};function o(C,v){var S=c;return Object.prototype.hasOwnProperty.call(S,C)?S[C]:S[C]=v(C)}function a(C,v){this.h=v;for(var S=[],w=!0,P=C.length-1;0<=P;P--){var I=C[P]|0;w&&I==v||(S[P]=I,w=!1)}this.g=S}var c={};function u(C){return-128<=C&&128>C?o(C,function(v){return new a([v|0],0>v?-1:0)}):new a([C|0],0>C?-1:0)}function h(C){if(isNaN(C)||!isFinite(C))return p;if(0>C)return x(h(-C));for(var v=[],S=1,w=0;C>=S;w++)v[w]=C/S|0,S*=4294967296;return new a(v,0)}function f(C,v){if(C.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(C.charAt(0)=="-")return x(f(C.substring(1),v));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=h(Math.pow(v,8)),w=p,P=0;P<C.length;P+=8){var I=Math.min(8,C.length-P),y=parseInt(C.substring(P,P+I),v);8>I?(I=h(Math.pow(v,I)),w=w.j(I).add(h(y))):(w=w.j(S),w=w.add(h(y)))}return w}var p=u(0),_=u(1),E=u(16777216);t=a.prototype,t.m=function(){if(T(this))return-x(this).m();for(var C=0,v=1,S=0;S<this.g.length;S++){var w=this.i(S);C+=(0<=w?w:4294967296+w)*v,v*=4294967296}return C},t.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(A(this))return"0";if(T(this))return"-"+x(this).toString(C);for(var v=h(Math.pow(C,6)),S=this,w="";;){var P=z(S,v).g;S=$(S,P.j(v));var I=((0<S.g.length?S.g[0]:S.h)>>>0).toString(C);if(S=P,A(S))return I+w;for(;6>I.length;)I="0"+I;w=I+w}},t.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function A(C){if(C.h!=0)return!1;for(var v=0;v<C.g.length;v++)if(C.g[v]!=0)return!1;return!0}function T(C){return C.h==-1}t.l=function(C){return C=$(this,C),T(C)?-1:A(C)?0:1};function x(C){for(var v=C.g.length,S=[],w=0;w<v;w++)S[w]=~C.g[w];return new a(S,~C.h).add(_)}t.abs=function(){return T(this)?x(this):this},t.add=function(C){for(var v=Math.max(this.g.length,C.g.length),S=[],w=0,P=0;P<=v;P++){var I=w+(this.i(P)&65535)+(C.i(P)&65535),y=(I>>>16)+(this.i(P)>>>16)+(C.i(P)>>>16);w=y>>>16,I&=65535,y&=65535,S[P]=y<<16|I}return new a(S,S[S.length-1]&-2147483648?-1:0)};function $(C,v){return C.add(x(v))}t.j=function(C){if(A(this)||A(C))return p;if(T(this))return T(C)?x(this).j(x(C)):x(x(this).j(C));if(T(C))return x(this.j(x(C)));if(0>this.l(E)&&0>C.l(E))return h(this.m()*C.m());for(var v=this.g.length+C.g.length,S=[],w=0;w<2*v;w++)S[w]=0;for(w=0;w<this.g.length;w++)for(var P=0;P<C.g.length;P++){var I=this.i(w)>>>16,y=this.i(w)&65535,le=C.i(P)>>>16,B=C.i(P)&65535;S[2*w+2*P]+=y*B,O(S,2*w+2*P),S[2*w+2*P+1]+=I*B,O(S,2*w+2*P+1),S[2*w+2*P+1]+=y*le,O(S,2*w+2*P+1),S[2*w+2*P+2]+=I*le,O(S,2*w+2*P+2)}for(w=0;w<v;w++)S[w]=S[2*w+1]<<16|S[2*w];for(w=v;w<2*v;w++)S[w]=0;return new a(S,0)};function O(C,v){for(;(C[v]&65535)!=C[v];)C[v+1]+=C[v]>>>16,C[v]&=65535,v++}function q(C,v){this.g=C,this.h=v}function z(C,v){if(A(v))throw Error("division by zero");if(A(C))return new q(p,p);if(T(C))return v=z(x(C),v),new q(x(v.g),x(v.h));if(T(v))return v=z(C,x(v)),new q(x(v.g),v.h);if(30<C.g.length){if(T(C)||T(v))throw Error("slowDivide_ only works with positive integers.");for(var S=_,w=v;0>=w.l(C);)S=ee(S),w=ee(w);var P=Q(S,1),I=Q(w,1);for(w=Q(w,2),S=Q(S,2);!A(w);){var y=I.add(w);0>=y.l(C)&&(P=P.add(S),I=y),w=Q(w,1),S=Q(S,1)}return v=$(C,P.j(v)),new q(P,v)}for(P=p;0<=C.l(v);){for(S=Math.max(1,Math.floor(C.m()/v.m())),w=Math.ceil(Math.log(S)/Math.LN2),w=48>=w?1:Math.pow(2,w-48),I=h(S),y=I.j(v);T(y)||0<y.l(C);)S-=w,I=h(S),y=I.j(v);A(I)&&(I=_),P=P.add(I),C=$(C,y)}return new q(P,C)}t.A=function(C){return z(this,C).h},t.and=function(C){for(var v=Math.max(this.g.length,C.g.length),S=[],w=0;w<v;w++)S[w]=this.i(w)&C.i(w);return new a(S,this.h&C.h)},t.or=function(C){for(var v=Math.max(this.g.length,C.g.length),S=[],w=0;w<v;w++)S[w]=this.i(w)|C.i(w);return new a(S,this.h|C.h)},t.xor=function(C){for(var v=Math.max(this.g.length,C.g.length),S=[],w=0;w<v;w++)S[w]=this.i(w)^C.i(w);return new a(S,this.h^C.h)};function ee(C){for(var v=C.g.length+1,S=[],w=0;w<v;w++)S[w]=C.i(w)<<1|C.i(w-1)>>>31;return new a(S,C.h)}function Q(C,v){var S=v>>5;v%=32;for(var w=C.g.length-S,P=[],I=0;I<w;I++)P[I]=0<v?C.i(I+S)>>>v|C.i(I+S+1)<<32-v:C.i(I+S);return new a(P,C.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,cf=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=f,ri=a}).apply(typeof pd<"u"?pd:typeof self<"u"?self:typeof window<"u"?window:{});var xs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var uf,To,df,Ys,Wl,hf,mf,ff;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,m,g){return l==Array.prototype||l==Object.prototype||(l[m]=g.value),l};function r(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof xs=="object"&&xs];for(var m=0;m<l.length;++m){var g=l[m];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var n=r(this);function i(l,m){if(m)e:{var g=n;l=l.split(".");for(var N=0;N<l.length-1;N++){var be=l[N];if(!(be in g))break e;g=g[be]}l=l[l.length-1],N=g[l],m=m(N),m!=N&&m!=null&&e(g,l,{configurable:!0,writable:!0,value:m})}}function o(l,m){l instanceof String&&(l+="");var g=0,N=!1,be={next:function(){if(!N&&g<l.length){var xe=g++;return{value:m(xe,l[xe]),done:!1}}return N=!0,{done:!0,value:void 0}}};return be[Symbol.iterator]=function(){return be},be}i("Array.prototype.values",function(l){return l||function(){return o(this,function(m,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},c=this||self;function u(l){var m=typeof l;return m=m!="object"?m:l?Array.isArray(l)?"array":m:"null",m=="array"||m=="object"&&typeof l.length=="number"}function h(l){var m=typeof l;return m=="object"&&l!=null||m=="function"}function f(l,m,g){return l.call.apply(l.bind,arguments)}function p(l,m,g){if(!l)throw Error();if(2<arguments.length){var N=Array.prototype.slice.call(arguments,2);return function(){var be=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(be,N),l.apply(m,be)}}return function(){return l.apply(m,arguments)}}function _(l,m,g){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,_.apply(null,arguments)}function E(l,m){var g=Array.prototype.slice.call(arguments,1);return function(){var N=g.slice();return N.push.apply(N,arguments),l.apply(this,N)}}function A(l,m){function g(){}g.prototype=m.prototype,l.aa=m.prototype,l.prototype=new g,l.prototype.constructor=l,l.Qb=function(N,be,xe){for(var je=Array(arguments.length-2),Ht=2;Ht<arguments.length;Ht++)je[Ht-2]=arguments[Ht];return m.prototype[be].apply(N,je)}}function T(l){const m=l.length;if(0<m){const g=Array(m);for(let N=0;N<m;N++)g[N]=l[N];return g}return[]}function x(l,m){for(let g=1;g<arguments.length;g++){const N=arguments[g];if(u(N)){const be=l.length||0,xe=N.length||0;l.length=be+xe;for(let je=0;je<xe;je++)l[be+je]=N[je]}else l.push(N)}}class ${constructor(m,g){this.i=m,this.j=g,this.h=0,this.g=null}get(){let m;return 0<this.h?(this.h--,m=this.g,this.g=m.next,m.next=null):m=this.i(),m}}function O(l){return/^[\s\xa0]*$/.test(l)}function q(){var l=c.navigator;return l&&(l=l.userAgent)?l:""}function z(l){return z[" "](l),l}z[" "]=function(){};var ee=q().indexOf("Gecko")!=-1&&!(q().toLowerCase().indexOf("webkit")!=-1&&q().indexOf("Edge")==-1)&&!(q().indexOf("Trident")!=-1||q().indexOf("MSIE")!=-1)&&q().indexOf("Edge")==-1;function Q(l,m,g){for(const N in l)m.call(g,l[N],N,l)}function C(l,m){for(const g in l)m.call(void 0,l[g],g,l)}function v(l){const m={};for(const g in l)m[g]=l[g];return m}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function w(l,m){let g,N;for(let be=1;be<arguments.length;be++){N=arguments[be];for(g in N)l[g]=N[g];for(let xe=0;xe<S.length;xe++)g=S[xe],Object.prototype.hasOwnProperty.call(N,g)&&(l[g]=N[g])}}function P(l){var m=1;l=l.split(":");const g=[];for(;0<m&&l.length;)g.push(l.shift()),m--;return l.length&&g.push(l.join(":")),g}function I(l){c.setTimeout(()=>{throw l},0)}function y(){var l=V;let m=null;return l.g&&(m=l.g,l.g=l.g.next,l.g||(l.h=null),m.next=null),m}class le{constructor(){this.h=this.g=null}add(m,g){const N=B.get();N.set(m,g),this.h?this.h.next=N:this.g=N,this.h=N}}var B=new $(()=>new k,l=>l.reset());class k{constructor(){this.next=this.g=this.h=null}set(m,g){this.h=m,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let W,R=!1,V=new le,M=()=>{const l=c.Promise.resolve(void 0);W=()=>{l.then(F)}};var F=()=>{for(var l;l=y();){try{l.h.call(l.g)}catch(g){I(g)}var m=B;m.j(l),100>m.h&&(m.h++,l.next=m.g,m.g=l)}R=!1};function ne(){this.s=this.s,this.C=this.C}ne.prototype.s=!1,ne.prototype.ma=function(){this.s||(this.s=!0,this.N())},ne.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function L(l,m){this.type=l,this.g=this.target=m,this.defaultPrevented=!1}L.prototype.h=function(){this.defaultPrevented=!0};var j=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var l=!1,m=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const g=()=>{};c.addEventListener("test",g,m),c.removeEventListener("test",g,m)}catch{}return l}();function Z(l,m){if(L.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var g=this.type=l.type,N=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=m,m=l.relatedTarget){if(ee){e:{try{z(m.nodeName);var be=!0;break e}catch{}be=!1}be||(m=null)}}else g=="mouseover"?m=l.fromElement:g=="mouseout"&&(m=l.toElement);this.relatedTarget=m,N?(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:te[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&Z.aa.h.call(this)}}A(Z,L);var te={2:"touch",3:"pen",4:"mouse"};Z.prototype.h=function(){Z.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var he="closure_listenable_"+(1e6*Math.random()|0),se=0;function re(l,m,g,N,be){this.listener=l,this.proxy=null,this.src=m,this.type=g,this.capture=!!N,this.ha=be,this.key=++se,this.da=this.fa=!1}function ye(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function G(l){this.src=l,this.g={},this.h=0}G.prototype.add=function(l,m,g,N,be){var xe=l.toString();l=this.g[xe],l||(l=this.g[xe]=[],this.h++);var je=Pe(l,m,N,be);return-1<je?(m=l[je],g||(m.fa=!1)):(m=new re(m,this.src,xe,!!N,be),m.fa=g,l.push(m)),m};function ae(l,m){var g=m.type;if(g in l.g){var N=l.g[g],be=Array.prototype.indexOf.call(N,m,void 0),xe;(xe=0<=be)&&Array.prototype.splice.call(N,be,1),xe&&(ye(m),l.g[g].length==0&&(delete l.g[g],l.h--))}}function Pe(l,m,g,N){for(var be=0;be<l.length;++be){var xe=l[be];if(!xe.da&&xe.listener==m&&xe.capture==!!g&&xe.ha==N)return be}return-1}var we="closure_lm_"+(1e6*Math.random()|0),ue={};function ce(l,m,g,N,be){if(Array.isArray(m)){for(var xe=0;xe<m.length;xe++)ce(l,m[xe],g,N,be);return null}return g=pe(g),l&&l[he]?l.K(m,g,h(N)?!!N.capture:!1,be):H(l,m,g,!1,N,be)}function H(l,m,g,N,be,xe){if(!m)throw Error("Invalid event type");var je=h(be)?!!be.capture:!!be,Ht=ie(l);if(Ht||(l[we]=Ht=new G(l)),g=Ht.add(m,g,N,je,xe),g.proxy)return g;if(N=de(),g.proxy=N,N.src=l,N.listener=g,l.addEventListener)j||(be=je),be===void 0&&(be=!1),l.addEventListener(m.toString(),N,be);else if(l.attachEvent)l.attachEvent(Se(m.toString()),N);else if(l.addListener&&l.removeListener)l.addListener(N);else throw Error("addEventListener and attachEvent are unavailable.");return g}function de(){function l(g){return m.call(l.src,l.listener,g)}const m=Y;return l}function X(l,m,g,N,be){if(Array.isArray(m))for(var xe=0;xe<m.length;xe++)X(l,m[xe],g,N,be);else N=h(N)?!!N.capture:!!N,g=pe(g),l&&l[he]?(l=l.i,m=String(m).toString(),m in l.g&&(xe=l.g[m],g=Pe(xe,g,N,be),-1<g&&(ye(xe[g]),Array.prototype.splice.call(xe,g,1),xe.length==0&&(delete l.g[m],l.h--)))):l&&(l=ie(l))&&(m=l.g[m.toString()],l=-1,m&&(l=Pe(m,g,N,be)),(g=-1<l?m[l]:null)&&_e(g))}function _e(l){if(typeof l!="number"&&l&&!l.da){var m=l.src;if(m&&m[he])ae(m.i,l);else{var g=l.type,N=l.proxy;m.removeEventListener?m.removeEventListener(g,N,l.capture):m.detachEvent?m.detachEvent(Se(g),N):m.addListener&&m.removeListener&&m.removeListener(N),(g=ie(m))?(ae(g,l),g.h==0&&(g.src=null,m[we]=null)):ye(l)}}}function Se(l){return l in ue?ue[l]:ue[l]="on"+l}function Y(l,m){if(l.da)l=!0;else{m=new Z(m,this);var g=l.listener,N=l.ha||l.src;l.fa&&_e(l),l=g.call(N,m)}return l}function ie(l){return l=l[we],l instanceof G?l:null}var Ie="__closure_events_fn_"+(1e9*Math.random()>>>0);function pe(l){return typeof l=="function"?l:(l[Ie]||(l[Ie]=function(m){return l.handleEvent(m)}),l[Ie])}function me(){ne.call(this),this.i=new G(this),this.M=this,this.F=null}A(me,ne),me.prototype[he]=!0,me.prototype.removeEventListener=function(l,m,g,N){X(this,l,m,g,N)};function J(l,m){var g,N=l.F;if(N)for(g=[];N;N=N.F)g.push(N);if(l=l.M,N=m.type||m,typeof m=="string")m=new L(m,l);else if(m instanceof L)m.target=m.target||l;else{var be=m;m=new L(N,l),w(m,be)}if(be=!0,g)for(var xe=g.length-1;0<=xe;xe--){var je=m.g=g[xe];be=D(je,N,!0,m)&&be}if(je=m.g=l,be=D(je,N,!0,m)&&be,be=D(je,N,!1,m)&&be,g)for(xe=0;xe<g.length;xe++)je=m.g=g[xe],be=D(je,N,!1,m)&&be}me.prototype.N=function(){if(me.aa.N.call(this),this.i){var l=this.i,m;for(m in l.g){for(var g=l.g[m],N=0;N<g.length;N++)ye(g[N]);delete l.g[m],l.h--}}this.F=null},me.prototype.K=function(l,m,g,N){return this.i.add(String(l),m,!1,g,N)},me.prototype.L=function(l,m,g,N){return this.i.add(String(l),m,!0,g,N)};function D(l,m,g,N){if(m=l.i.g[String(m)],!m)return!0;m=m.concat();for(var be=!0,xe=0;xe<m.length;++xe){var je=m[xe];if(je&&!je.da&&je.capture==g){var Ht=je.listener,pr=je.ha||je.src;je.fa&&ae(l.i,je),be=Ht.call(pr,N)!==!1&&be}}return be&&!N.defaultPrevented}function ge(l,m,g){if(typeof l=="function")g&&(l=_(l,g));else if(l&&typeof l.handleEvent=="function")l=_(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(m)?-1:c.setTimeout(l,m||0)}function ke(l){l.g=ge(()=>{l.g=null,l.i&&(l.i=!1,ke(l))},l.l);const m=l.h;l.h=null,l.m.apply(null,m)}class Ee extends ne{constructor(m,g){super(),this.m=m,this.l=g,this.h=null,this.i=!1,this.g=null}j(m){this.h=arguments,this.g?this.i=!0:ke(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Te(l){ne.call(this),this.h=l,this.g={}}A(Te,ne);var De=[];function Ke(l){Q(l.g,function(m,g){this.g.hasOwnProperty(g)&&_e(m)},l),l.g={}}Te.prototype.N=function(){Te.aa.N.call(this),Ke(this)},Te.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Me=c.JSON.stringify,ve=c.JSON.parse,Le=class{stringify(l){return c.JSON.stringify(l,void 0)}parse(l){return c.JSON.parse(l,void 0)}};function Fe(){}Fe.prototype.h=null;function ze(l){return l.h||(l.h=l.i())}function qe(){}var Ce={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ye(){L.call(this,"d")}A(Ye,L);function Qe(){L.call(this,"c")}A(Qe,L);var Ze={},Ae=null;function et(){return Ae=Ae||new me}Ze.La="serverreachability";function Pt(l){L.call(this,Ze.La,l)}A(Pt,L);function rt(l){const m=et();J(m,new Pt(m))}Ze.STAT_EVENT="statevent";function vt(l,m){L.call(this,Ze.STAT_EVENT,l),this.stat=m}A(vt,L);function at(l){const m=et();J(m,new vt(m,l))}Ze.Ma="timingevent";function Vt(l,m){L.call(this,Ze.Ma,l),this.size=m}A(Vt,L);function xt(l,m){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){l()},m)}function bt(){this.g=!0}bt.prototype.xa=function(){this.g=!1};function Ue(l,m,g,N,be,xe){l.info(function(){if(l.g)if(xe)for(var je="",Ht=xe.split("&"),pr=0;pr<Ht.length;pr++){var kt=Ht[pr].split("=");if(1<kt.length){var wr=kt[0];kt=kt[1];var Cr=wr.split("_");je=2<=Cr.length&&Cr[1]=="type"?je+(wr+"="+kt+"&"):je+(wr+"=redacted&")}}else je=null;else je=xe;return"XMLHTTP REQ ("+N+") [attempt "+be+"]: "+m+`
`+g+`
`+je})}function Ve(l,m,g,N,be,xe,je){l.info(function(){return"XMLHTTP RESP ("+N+") [ attempt "+be+"]: "+m+`
`+g+`
`+xe+" "+je})}function Je(l,m,g,N){l.info(function(){return"XMLHTTP TEXT ("+m+"): "+_t(l,g)+(N?" "+N:"")})}function st(l,m){l.info(function(){return"TIMEOUT: "+m})}bt.prototype.info=function(){};function _t(l,m){if(!l.g)return m;if(!m)return null;try{var g=JSON.parse(m);if(g){for(l=0;l<g.length;l++)if(Array.isArray(g[l])){var N=g[l];if(!(2>N.length)){var be=N[1];if(Array.isArray(be)&&!(1>be.length)){var xe=be[0];if(xe!="noop"&&xe!="stop"&&xe!="close")for(var je=1;je<be.length;je++)be[je]=""}}}}return Me(g)}catch{return m}}var nt={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},$e={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Xe;function ut(){}A(ut,Fe),ut.prototype.g=function(){return new XMLHttpRequest},ut.prototype.i=function(){return{}},Xe=new ut;function ht(l,m,g,N){this.j=l,this.i=m,this.l=g,this.R=N||1,this.U=new Te(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Yt}function Yt(){this.i=null,this.g="",this.h=!1}var zt={},Dt={};function Gt(l,m,g){l.L=1,l.v=Li(gr(m)),l.m=g,l.P=!0,wt(l,null)}function wt(l,m){l.F=Date.now(),$t(l),l.A=gr(l.v);var g=l.A,N=l.R;Array.isArray(N)||(N=[String(N)]),hu(g.i,"t",N),l.C=0,g=l.j.J,l.h=new Yt,l.g=$u(l.j,g?m:null,!l.m),0<l.O&&(l.M=new Ee(_(l.Y,l,l.g),l.O)),m=l.U,g=l.g,N=l.ca;var be="readystatechange";Array.isArray(be)||(be&&(De[0]=be.toString()),be=De);for(var xe=0;xe<be.length;xe++){var je=ce(g,be[xe],N||m.handleEvent,!1,m.h||m);if(!je)break;m.g[je.key]=je}m=l.H?v(l.H):{},l.m?(l.u||(l.u="POST"),m["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,m)):(l.u="GET",l.g.ea(l.A,l.u,null,m)),rt(),Ue(l.i,l.u,l.A,l.l,l.R,l.m)}ht.prototype.ca=function(l){l=l.target;const m=this.M;m&&bn(l)==3?m.j():this.Y(l)},ht.prototype.Y=function(l){try{if(l==this.g)e:{const Cr=bn(this.g);var m=this.g.Ba();const Vi=this.g.Z();if(!(3>Cr)&&(Cr!=3||this.g&&(this.h.h||this.g.oa()||bu(this.g)))){this.J||Cr!=4||m==7||(m==8||0>=Vi?rt(3):rt(2)),dr(this);var g=this.g.Z();this.X=g;t:if(Tt(this)){var N=bu(this.g);l="";var be=N.length,xe=bn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Qt(this),hr(this);var je="";break t}this.h.i=new c.TextDecoder}for(m=0;m<be;m++)this.h.h=!0,l+=this.h.i.decode(N[m],{stream:!(xe&&m==be-1)});N.length=0,this.h.g+=l,this.C=0,je=this.h.g}else je=this.g.oa();if(this.o=g==200,Ve(this.i,this.u,this.A,this.l,this.R,Cr,g),this.o){if(this.T&&!this.K){t:{if(this.g){var Ht,pr=this.g;if((Ht=pr.g?pr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(Ht)){var kt=Ht;break t}}kt=null}if(g=kt)Je(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Pr(this,g);else{this.o=!1,this.s=3,at(12),Qt(this),hr(this);break e}}if(this.P){g=!0;let Gr;for(;!this.J&&this.C<je.length;)if(Gr=Zt(this,je),Gr==Dt){Cr==4&&(this.s=4,at(14),g=!1),Je(this.i,this.l,null,"[Incomplete Response]");break}else if(Gr==zt){this.s=4,at(15),Je(this.i,this.l,je,"[Invalid Chunk]"),g=!1;break}else Je(this.i,this.l,Gr,null),Pr(this,Gr);if(Tt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Cr!=4||je.length!=0||this.h.h||(this.s=1,at(16),g=!1),this.o=this.o&&g,!g)Je(this.i,this.l,je,"[Invalid Chunked Response]"),Qt(this),hr(this);else if(0<je.length&&!this.W){this.W=!0;var wr=this.j;wr.g==this&&wr.ba&&!wr.M&&(wr.j.info("Great, no buffering proxy detected. Bytes received: "+je.length),Qa(wr),wr.M=!0,at(11))}}else Je(this.i,this.l,je,null),Pr(this,je);Cr==4&&Qt(this),this.o&&!this.J&&(Cr==4?Iu(this.j,this):(this.o=!1,$t(this)))}else eg(this.g),g==400&&0<je.indexOf("Unknown SID")?(this.s=3,at(12)):(this.s=0,at(13)),Qt(this),hr(this)}}}catch{}finally{}};function Tt(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function Zt(l,m){var g=l.C,N=m.indexOf(`
`,g);return N==-1?Dt:(g=Number(m.substring(g,N)),isNaN(g)?zt:(N+=1,N+g>m.length?Dt:(m=m.slice(N,N+g),l.C=N+g,m)))}ht.prototype.cancel=function(){this.J=!0,Qt(this)};function $t(l){l.S=Date.now()+l.I,Bt(l,l.I)}function Bt(l,m){if(l.B!=null)throw Error("WatchDog timer not null");l.B=xt(_(l.ba,l),m)}function dr(l){l.B&&(c.clearTimeout(l.B),l.B=null)}ht.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(st(this.i,this.A),this.L!=2&&(rt(),at(17)),Qt(this),this.s=2,hr(this)):Bt(this,this.S-l)};function hr(l){l.j.G==0||l.J||Iu(l.j,l)}function Qt(l){dr(l);var m=l.M;m&&typeof m.ma=="function"&&m.ma(),l.M=null,Ke(l.U),l.g&&(m=l.g,l.g=null,m.abort(),m.ma())}function Pr(l,m){try{var g=l.j;if(g.G!=0&&(g.g==l||Zr(g.h,l))){if(!l.K&&Zr(g.h,l)&&g.G==3){try{var N=g.Da.g.parse(m)}catch{N=null}if(Array.isArray(N)&&N.length==3){var be=N;if(be[0]==0){e:if(!g.u){if(g.g)if(g.g.F+3e3<l.F)ws(g),Ss(g);else break e;Ya(g),at(18)}}else g.za=be[1],0<g.za-g.T&&37500>be[2]&&g.F&&g.v==0&&!g.C&&(g.C=xt(_(g.Za,g),6e3));if(1>=pn(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else hi(g,11)}else if((l.K||g.g==l)&&ws(g),!O(m))for(be=g.Da.g.parse(m),m=0;m<be.length;m++){let kt=be[m];if(g.T=kt[0],kt=kt[1],g.G==2)if(kt[0]=="c"){g.K=kt[1],g.ia=kt[2];const wr=kt[3];wr!=null&&(g.la=wr,g.j.info("VER="+g.la));const Cr=kt[4];Cr!=null&&(g.Aa=Cr,g.j.info("SVER="+g.Aa));const Vi=kt[5];Vi!=null&&typeof Vi=="number"&&0<Vi&&(N=1.5*Vi,g.L=N,g.j.info("backChannelRequestTimeoutMs_="+N)),N=g;const Gr=l.g;if(Gr){const As=Gr.g?Gr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(As){var xe=N.h;xe.g||As.indexOf("spdy")==-1&&As.indexOf("quic")==-1&&As.indexOf("h2")==-1||(xe.j=xe.l,xe.g=new Set,xe.h&&(Vr(xe,xe.h),xe.h=null))}if(N.D){const Ja=Gr.g?Gr.g.getResponseHeader("X-HTTP-Session-Id"):null;Ja&&(N.ya=Ja,qt(N.I,N.D,Ja))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-l.F,g.j.info("Handshake RTT: "+g.R+"ms")),N=g;var je=l;if(N.qa=Tu(N,N.J?N.ia:null,N.W),je.K){Vn(N.h,je);var Ht=je,pr=N.L;pr&&(Ht.I=pr),Ht.B&&(dr(Ht),$t(Ht)),N.g=je}else Cu(N);0<g.i.length&&Ps(g)}else kt[0]!="stop"&&kt[0]!="close"||hi(g,7);else g.G==3&&(kt[0]=="stop"||kt[0]=="close"?kt[0]=="stop"?hi(g,7):Ka(g):kt[0]!="noop"&&g.l&&g.l.ta(kt),g.v=0)}}rt(4)}catch{}}var Xr=class{constructor(l,m){this.g=l,this.map=m}};function On(l){this.l=l||10,c.PerformanceNavigationTiming?(l=c.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function gn(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function pn(l){return l.h?1:l.g?l.g.size:0}function Zr(l,m){return l.h?l.h==m:l.g?l.g.has(m):!1}function Vr(l,m){l.g?l.g.add(m):l.h=m}function Vn(l,m){l.h&&l.h==m?l.h=null:l.g&&l.g.has(m)&&l.g.delete(m)}On.prototype.cancel=function(){if(this.i=vn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function vn(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let m=l.i;for(const g of l.g.values())m=m.concat(g.D);return m}return T(l.i)}function yt(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(u(l)){for(var m=[],g=l.length,N=0;N<g;N++)m.push(l[N]);return m}m=[],g=0;for(N in l)m[g++]=l[N];return m}function Nt(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(u(l)||typeof l=="string"){var m=[];l=l.length;for(var g=0;g<l;g++)m.push(g);return m}m=[],g=0;for(const N in l)m[g++]=N;return m}}}function rr(l,m){if(l.forEach&&typeof l.forEach=="function")l.forEach(m,void 0);else if(u(l)||typeof l=="string")Array.prototype.forEach.call(l,m,void 0);else for(var g=Nt(l),N=yt(l),be=N.length,xe=0;xe<be;xe++)m.call(void 0,N[xe],g&&g[xe],l)}var kr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Nr(l,m){if(l){l=l.split("&");for(var g=0;g<l.length;g++){var N=l[g].indexOf("="),be=null;if(0<=N){var xe=l[g].substring(0,N);be=l[g].substring(N+1)}else xe=l[g];m(xe,be?decodeURIComponent(be.replace(/\+/g," ")):"")}}}function Ut(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Ut){this.h=l.h,en(this,l.j),this.o=l.o,this.g=l.g,tn(this,l.s),this.l=l.l;var m=l.i,g=new vo;g.i=m.i,m.g&&(g.g=new Map(m.g),g.h=m.h),ps(this,g),this.m=l.m}else l&&(m=String(l).match(kr))?(this.h=!1,en(this,m[1]||"",!0),this.o=go(m[2]||""),this.g=go(m[3]||"",!0),tn(this,m[4]),this.l=go(m[5]||"",!0),ps(this,m[6]||"",!0),this.m=go(m[7]||"")):(this.h=!1,this.i=new vo(null,this.h))}Ut.prototype.toString=function(){var l=[],m=this.j;m&&l.push(po(m,cu,!0),":");var g=this.g;return(g||m=="file")&&(l.push("//"),(m=this.o)&&l.push(po(m,cu,!0),"@"),l.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&l.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&l.push("/"),l.push(po(g,g.charAt(0)=="/"?qy:zy,!0))),(g=this.i.toString())&&l.push("?",g),(g=this.m)&&l.push("#",po(g,Wy)),l.join("")};function gr(l){return new Ut(l)}function en(l,m,g){l.j=g?go(m,!0):m,l.j&&(l.j=l.j.replace(/:$/,""))}function tn(l,m){if(m){if(m=Number(m),isNaN(m)||0>m)throw Error("Bad port number "+m);l.s=m}else l.s=null}function ps(l,m,g){m instanceof vo?(l.i=m,Gy(l.i,l.h)):(g||(m=po(m,Hy)),l.i=new vo(m,l.h))}function qt(l,m,g){l.i.set(m,g)}function Li(l){return qt(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function go(l,m){return l?m?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function po(l,m,g){return typeof l=="string"?(l=encodeURI(l).replace(m,jy),g&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function jy(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var cu=/[#\/\?@]/g,zy=/[#\?:]/g,qy=/[#\?]/g,Hy=/[#\?@]/g,Wy=/#/g;function vo(l,m){this.h=this.g=null,this.i=l||null,this.j=!!m}function Bn(l){l.g||(l.g=new Map,l.h=0,l.i&&Nr(l.i,function(m,g){l.add(decodeURIComponent(m.replace(/\+/g," ")),g)}))}t=vo.prototype,t.add=function(l,m){Bn(this),this.i=null,l=Mi(this,l);var g=this.g.get(l);return g||this.g.set(l,g=[]),g.push(m),this.h+=1,this};function uu(l,m){Bn(l),m=Mi(l,m),l.g.has(m)&&(l.i=null,l.h-=l.g.get(m).length,l.g.delete(m))}function du(l,m){return Bn(l),m=Mi(l,m),l.g.has(m)}t.forEach=function(l,m){Bn(this),this.g.forEach(function(g,N){g.forEach(function(be){l.call(m,be,N,this)},this)},this)},t.na=function(){Bn(this);const l=Array.from(this.g.values()),m=Array.from(this.g.keys()),g=[];for(let N=0;N<m.length;N++){const be=l[N];for(let xe=0;xe<be.length;xe++)g.push(m[N])}return g},t.V=function(l){Bn(this);let m=[];if(typeof l=="string")du(this,l)&&(m=m.concat(this.g.get(Mi(this,l))));else{l=Array.from(this.g.values());for(let g=0;g<l.length;g++)m=m.concat(l[g])}return m},t.set=function(l,m){return Bn(this),this.i=null,l=Mi(this,l),du(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[m]),this.h+=1,this},t.get=function(l,m){return l?(l=this.V(l),0<l.length?String(l[0]):m):m};function hu(l,m,g){uu(l,m),0<g.length&&(l.i=null,l.g.set(Mi(l,m),T(g)),l.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],m=Array.from(this.g.keys());for(var g=0;g<m.length;g++){var N=m[g];const xe=encodeURIComponent(String(N)),je=this.V(N);for(N=0;N<je.length;N++){var be=xe;je[N]!==""&&(be+="="+encodeURIComponent(String(je[N]))),l.push(be)}}return this.i=l.join("&")};function Mi(l,m){return m=String(m),l.j&&(m=m.toLowerCase()),m}function Gy(l,m){m&&!l.j&&(Bn(l),l.i=null,l.g.forEach(function(g,N){var be=N.toLowerCase();N!=be&&(uu(this,N),hu(this,be,g))},l)),l.j=m}function Ky(l,m){const g=new bt;if(c.Image){const N=new Image;N.onload=E(Fn,g,"TestLoadImage: loaded",!0,m,N),N.onerror=E(Fn,g,"TestLoadImage: error",!1,m,N),N.onabort=E(Fn,g,"TestLoadImage: abort",!1,m,N),N.ontimeout=E(Fn,g,"TestLoadImage: timeout",!1,m,N),c.setTimeout(function(){N.ontimeout&&N.ontimeout()},1e4),N.src=l}else m(!1)}function Yy(l,m){const g=new bt,N=new AbortController,be=setTimeout(()=>{N.abort(),Fn(g,"TestPingServer: timeout",!1,m)},1e4);fetch(l,{signal:N.signal}).then(xe=>{clearTimeout(be),xe.ok?Fn(g,"TestPingServer: ok",!0,m):Fn(g,"TestPingServer: server error",!1,m)}).catch(()=>{clearTimeout(be),Fn(g,"TestPingServer: error",!1,m)})}function Fn(l,m,g,N,be){try{be&&(be.onload=null,be.onerror=null,be.onabort=null,be.ontimeout=null),N(g)}catch{}}function Qy(){this.g=new Le}function Jy(l,m,g){const N=g||"";try{rr(l,function(be,xe){let je=be;h(be)&&(je=Me(be)),m.push(N+xe+"="+encodeURIComponent(je))})}catch(be){throw m.push(N+"type="+encodeURIComponent("_badmap")),be}}function vs(l){this.l=l.Ub||null,this.j=l.eb||!1}A(vs,Fe),vs.prototype.g=function(){return new bs(this.l,this.j)},vs.prototype.i=function(l){return function(){return l}}({});function bs(l,m){me.call(this),this.D=l,this.o=m,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}A(bs,me),t=bs.prototype,t.open=function(l,m){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=m,this.readyState=1,_o(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const m={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(m.body=l),(this.D||c).fetch(new Request(this.A,m)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,bo(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,_o(this)),this.g&&(this.readyState=3,_o(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;mu(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function mu(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var m=l.value?l.value:new Uint8Array(0);(m=this.v.decode(m,{stream:!l.done}))&&(this.response=this.responseText+=m)}l.done?bo(this):_o(this),this.readyState==3&&mu(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,bo(this))},t.Qa=function(l){this.g&&(this.response=l,bo(this))},t.ga=function(){this.g&&bo(this)};function bo(l){l.readyState=4,l.l=null,l.j=null,l.v=null,_o(l)}t.setRequestHeader=function(l,m){this.u.append(l,m)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],m=this.h.entries();for(var g=m.next();!g.done;)g=g.value,l.push(g[0]+": "+g[1]),g=m.next();return l.join(`\r
`)};function _o(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(bs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function fu(l){let m="";return Q(l,function(g,N){m+=N,m+=":",m+=g,m+=`\r
`}),m}function Ga(l,m,g){e:{for(N in g){var N=!1;break e}N=!0}N||(g=fu(g),typeof l=="string"?g!=null&&encodeURIComponent(String(g)):qt(l,m,g))}function er(l){me.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}A(er,me);var Xy=/^https?$/i,Zy=["POST","PUT"];t=er.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,m,g,N){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);m=m?m.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Xe.g(),this.v=this.o?ze(this.o):ze(Xe),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(m,String(l),!0),this.B=!1}catch(xe){yu(this,xe);return}if(l=g||"",g=new Map(this.headers),N)if(Object.getPrototypeOf(N)===Object.prototype)for(var be in N)g.set(be,N[be]);else if(typeof N.keys=="function"&&typeof N.get=="function")for(const xe of N.keys())g.set(xe,N.get(xe));else throw Error("Unknown input type for opt_headers: "+String(N));N=Array.from(g.keys()).find(xe=>xe.toLowerCase()=="content-type"),be=c.FormData&&l instanceof c.FormData,!(0<=Array.prototype.indexOf.call(Zy,m,void 0))||N||be||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[xe,je]of g)this.g.setRequestHeader(xe,je);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{vu(this),this.u=!0,this.g.send(l),this.u=!1}catch(xe){yu(this,xe)}};function yu(l,m){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=m,l.m=5,gu(l),_s(l)}function gu(l){l.A||(l.A=!0,J(l,"complete"),J(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,J(this,"complete"),J(this,"abort"),_s(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),_s(this,!0)),er.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?pu(this):this.bb())},t.bb=function(){pu(this)};function pu(l){if(l.h&&typeof a<"u"&&(!l.v[1]||bn(l)!=4||l.Z()!=2)){if(l.u&&bn(l)==4)ge(l.Ea,0,l);else if(J(l,"readystatechange"),bn(l)==4){l.h=!1;try{const je=l.Z();e:switch(je){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var m=!0;break e;default:m=!1}var g;if(!(g=m)){var N;if(N=je===0){var be=String(l.D).match(kr)[1]||null;!be&&c.self&&c.self.location&&(be=c.self.location.protocol.slice(0,-1)),N=!Xy.test(be?be.toLowerCase():"")}g=N}if(g)J(l,"complete"),J(l,"success");else{l.m=6;try{var xe=2<bn(l)?l.g.statusText:""}catch{xe=""}l.l=xe+" ["+l.Z()+"]",gu(l)}}finally{_s(l)}}}}function _s(l,m){if(l.g){vu(l);const g=l.g,N=l.v[0]?()=>{}:null;l.g=null,l.v=null,m||J(l,"ready");try{g.onreadystatechange=N}catch{}}}function vu(l){l.I&&(c.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function bn(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<bn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var m=this.g.responseText;return l&&m.indexOf(l)==0&&(m=m.substring(l.length)),ve(m)}};function bu(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function eg(l){const m={};l=(l.g&&2<=bn(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let N=0;N<l.length;N++){if(O(l[N]))continue;var g=P(l[N]);const be=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const xe=m[be]||[];m[be]=xe,xe.push(g)}C(m,function(N){return N.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function So(l,m,g){return g&&g.internalChannelParams&&g.internalChannelParams[l]||m}function _u(l){this.Aa=0,this.i=[],this.j=new bt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=So("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=So("baseRetryDelayMs",5e3,l),this.cb=So("retryDelaySeedMs",1e4,l),this.Wa=So("forwardChannelMaxRetries",2,l),this.wa=So("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new On(l&&l.concurrentRequestLimit),this.Da=new Qy,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=_u.prototype,t.la=8,t.G=1,t.connect=function(l,m,g,N){at(0),this.W=l,this.H=m||{},g&&N!==void 0&&(this.H.OSID=g,this.H.OAID=N),this.F=this.X,this.I=Tu(this,null,this.W),Ps(this)};function Ka(l){if(Su(l),l.G==3){var m=l.U++,g=gr(l.I);if(qt(g,"SID",l.K),qt(g,"RID",m),qt(g,"TYPE","terminate"),Po(l,g),m=new ht(l,l.j,m),m.L=2,m.v=Li(gr(g)),g=!1,c.navigator&&c.navigator.sendBeacon)try{g=c.navigator.sendBeacon(m.v.toString(),"")}catch{}!g&&c.Image&&(new Image().src=m.v,g=!0),g||(m.g=$u(m.j,null),m.g.ea(m.v)),m.F=Date.now(),$t(m)}xu(l)}function Ss(l){l.g&&(Qa(l),l.g.cancel(),l.g=null)}function Su(l){Ss(l),l.u&&(c.clearTimeout(l.u),l.u=null),ws(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&c.clearTimeout(l.s),l.s=null)}function Ps(l){if(!gn(l.h)&&!l.s){l.s=!0;var m=l.Ga;W||M(),R||(W(),R=!0),V.add(m,l),l.B=0}}function tg(l,m){return pn(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=m.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=xt(_(l.Ga,l,m),Eu(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const be=new ht(this,this.j,l);let xe=this.o;if(this.S&&(xe?(xe=v(xe),w(xe,this.S)):xe=this.S),this.m!==null||this.O||(be.H=xe,xe=null),this.P)e:{for(var m=0,g=0;g<this.i.length;g++){t:{var N=this.i[g];if("__data__"in N.map&&(N=N.map.__data__,typeof N=="string")){N=N.length;break t}N=void 0}if(N===void 0)break;if(m+=N,4096<m){m=g;break e}if(m===4096||g===this.i.length-1){m=g+1;break e}}m=1e3}else m=1e3;m=wu(this,be,m),g=gr(this.I),qt(g,"RID",l),qt(g,"CVER",22),this.D&&qt(g,"X-HTTP-Session-Id",this.D),Po(this,g),xe&&(this.O?m="headers="+encodeURIComponent(String(fu(xe)))+"&"+m:this.m&&Ga(g,this.m,xe)),Vr(this.h,be),this.Ua&&qt(g,"TYPE","init"),this.P?(qt(g,"$req",m),qt(g,"SID","null"),be.T=!0,Gt(be,g,null)):Gt(be,g,m),this.G=2}}else this.G==3&&(l?Pu(this,l):this.i.length==0||gn(this.h)||Pu(this))};function Pu(l,m){var g;m?g=m.l:g=l.U++;const N=gr(l.I);qt(N,"SID",l.K),qt(N,"RID",g),qt(N,"AID",l.T),Po(l,N),l.m&&l.o&&Ga(N,l.m,l.o),g=new ht(l,l.j,g,l.B+1),l.m===null&&(g.H=l.o),m&&(l.i=m.D.concat(l.i)),m=wu(l,g,1e3),g.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),Vr(l.h,g),Gt(g,N,m)}function Po(l,m){l.H&&Q(l.H,function(g,N){qt(m,N,g)}),l.l&&rr({},function(g,N){qt(m,N,g)})}function wu(l,m,g){g=Math.min(l.i.length,g);var N=l.l?_(l.l.Na,l.l,l):null;e:{var be=l.i;let xe=-1;for(;;){const je=["count="+g];xe==-1?0<g?(xe=be[0].g,je.push("ofs="+xe)):xe=0:je.push("ofs="+xe);let Ht=!0;for(let pr=0;pr<g;pr++){let kt=be[pr].g;const wr=be[pr].map;if(kt-=xe,0>kt)xe=Math.max(0,be[pr].g-100),Ht=!1;else try{Jy(wr,je,"req"+kt+"_")}catch{N&&N(wr)}}if(Ht){N=je.join("&");break e}}}return l=l.i.splice(0,g),m.D=l,N}function Cu(l){if(!l.g&&!l.u){l.Y=1;var m=l.Fa;W||M(),R||(W(),R=!0),V.add(m,l),l.v=0}}function Ya(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=xt(_(l.Fa,l),Eu(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,Au(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=xt(_(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,at(10),Ss(this),Au(this))};function Qa(l){l.A!=null&&(c.clearTimeout(l.A),l.A=null)}function Au(l){l.g=new ht(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var m=gr(l.qa);qt(m,"RID","rpc"),qt(m,"SID",l.K),qt(m,"AID",l.T),qt(m,"CI",l.F?"0":"1"),!l.F&&l.ja&&qt(m,"TO",l.ja),qt(m,"TYPE","xmlhttp"),Po(l,m),l.m&&l.o&&Ga(m,l.m,l.o),l.L&&(l.g.I=l.L);var g=l.g;l=l.ia,g.L=1,g.v=Li(gr(m)),g.m=null,g.P=!0,wt(g,l)}t.Za=function(){this.C!=null&&(this.C=null,Ss(this),Ya(this),at(19))};function ws(l){l.C!=null&&(c.clearTimeout(l.C),l.C=null)}function Iu(l,m){var g=null;if(l.g==m){ws(l),Qa(l),l.g=null;var N=2}else if(Zr(l.h,m))g=m.D,Vn(l.h,m),N=1;else return;if(l.G!=0){if(m.o)if(N==1){g=m.m?m.m.length:0,m=Date.now()-m.F;var be=l.B;N=et(),J(N,new Vt(N,g)),Ps(l)}else Cu(l);else if(be=m.s,be==3||be==0&&0<m.X||!(N==1&&tg(l,m)||N==2&&Ya(l)))switch(g&&0<g.length&&(m=l.h,m.i=m.i.concat(g)),be){case 1:hi(l,5);break;case 4:hi(l,10);break;case 3:hi(l,6);break;default:hi(l,2)}}}function Eu(l,m){let g=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(g*=2),g*m}function hi(l,m){if(l.j.info("Error code "+m),m==2){var g=_(l.fb,l),N=l.Xa;const be=!N;N=new Ut(N||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||en(N,"https"),Li(N),be?Ky(N.toString(),g):Yy(N.toString(),g)}else at(2);l.G=0,l.l&&l.l.sa(m),xu(l),Su(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),at(2)):(this.j.info("Failed to ping google.com"),at(1))};function xu(l){if(l.G=0,l.ka=[],l.l){const m=vn(l.h);(m.length!=0||l.i.length!=0)&&(x(l.ka,m),x(l.ka,l.i),l.h.i.length=0,T(l.i),l.i.length=0),l.l.ra()}}function Tu(l,m,g){var N=g instanceof Ut?gr(g):new Ut(g);if(N.g!="")m&&(N.g=m+"."+N.g),tn(N,N.s);else{var be=c.location;N=be.protocol,m=m?m+"."+be.hostname:be.hostname,be=+be.port;var xe=new Ut(null);N&&en(xe,N),m&&(xe.g=m),be&&tn(xe,be),g&&(xe.l=g),N=xe}return g=l.D,m=l.ya,g&&m&&qt(N,g,m),qt(N,"VER",l.la),Po(l,N),N}function $u(l,m,g){if(m&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return m=l.Ca&&!l.pa?new er(new vs({eb:g})):new er(l.pa),m.Ha(l.J),m}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function ku(){}t=ku.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Cs(){}Cs.prototype.g=function(l,m){return new Lr(l,m)};function Lr(l,m){me.call(this),this.g=new _u(m),this.l=l,this.h=m&&m.messageUrlParams||null,l=m&&m.messageHeaders||null,m&&m.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=m&&m.initMessageHeaders||null,m&&m.messageContentType&&(l?l["X-WebChannel-Content-Type"]=m.messageContentType:l={"X-WebChannel-Content-Type":m.messageContentType}),m&&m.va&&(l?l["X-WebChannel-Client-Profile"]=m.va:l={"X-WebChannel-Client-Profile":m.va}),this.g.S=l,(l=m&&m.Sb)&&!O(l)&&(this.g.m=l),this.v=m&&m.supportsCrossDomainXhr||!1,this.u=m&&m.sendRawJson||!1,(m=m&&m.httpSessionIdParam)&&!O(m)&&(this.g.D=m,l=this.h,l!==null&&m in l&&(l=this.h,m in l&&delete l[m])),this.j=new Oi(this)}A(Lr,me),Lr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Lr.prototype.close=function(){Ka(this.g)},Lr.prototype.o=function(l){var m=this.g;if(typeof l=="string"){var g={};g.__data__=l,l=g}else this.u&&(g={},g.__data__=Me(l),l=g);m.i.push(new Xr(m.Ya++,l)),m.G==3&&Ps(m)},Lr.prototype.N=function(){this.g.l=null,delete this.j,Ka(this.g),delete this.g,Lr.aa.N.call(this)};function Ru(l){Ye.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var m=l.__sm__;if(m){e:{for(const g in m){l=g;break e}l=void 0}(this.i=l)&&(l=this.i,m=m!==null&&l in m?m[l]:void 0),this.data=m}else this.data=l}A(Ru,Ye);function Du(){Qe.call(this),this.status=1}A(Du,Qe);function Oi(l){this.g=l}A(Oi,ku),Oi.prototype.ua=function(){J(this.g,"a")},Oi.prototype.ta=function(l){J(this.g,new Ru(l))},Oi.prototype.sa=function(l){J(this.g,new Du)},Oi.prototype.ra=function(){J(this.g,"b")},Cs.prototype.createWebChannel=Cs.prototype.g,Lr.prototype.send=Lr.prototype.o,Lr.prototype.open=Lr.prototype.m,Lr.prototype.close=Lr.prototype.close,ff=function(){return new Cs},mf=function(){return et()},hf=Ze,Wl={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},nt.NO_ERROR=0,nt.TIMEOUT=8,nt.HTTP_ERROR=6,Ys=nt,$e.COMPLETE="complete",df=$e,qe.EventType=Ce,Ce.OPEN="a",Ce.CLOSE="b",Ce.ERROR="c",Ce.MESSAGE="d",me.prototype.listen=me.prototype.K,To=qe,er.prototype.listenOnce=er.prototype.L,er.prototype.getLastError=er.prototype.Ka,er.prototype.getLastErrorCode=er.prototype.Ba,er.prototype.getStatus=er.prototype.Z,er.prototype.getResponseJson=er.prototype.Oa,er.prototype.getResponseText=er.prototype.oa,er.prototype.send=er.prototype.ea,er.prototype.setWithCredentials=er.prototype.Ha,uf=er}).apply(typeof xs<"u"?xs:typeof self<"u"?self:typeof window<"u"?window:{});const vd="@firebase/firestore",bd="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Er.UNAUTHENTICATED=new Er(null),Er.GOOGLE_CREDENTIALS=new Er("google-credentials-uid"),Er.FIRST_PARTY=new Er("first-party-uid"),Er.MOCK_USER=new Er("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ho="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ei=new pc("@firebase/firestore");function qi(){return Ei.logLevel}function We(t,...e){if(Ei.logLevel<=Ct.DEBUG){const r=e.map($c);Ei.debug(`Firestore (${ho}): ${t}`,...r)}}function Dn(t,...e){if(Ei.logLevel<=Ct.ERROR){const r=e.map($c);Ei.error(`Firestore (${ho}): ${t}`,...r)}}function to(t,...e){if(Ei.logLevel<=Ct.WARN){const r=e.map($c);Ei.warn(`Firestore (${ho}): ${t}`,...r)}}function $c(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ct(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,yf(t,n,r)}function yf(t,e,r){let n=`FIRESTORE (${ho}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Dn(n),new Error(n)}function Ft(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||yf(e,i,n)}function ft(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ne={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ot extends Mn{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class s_{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Er.UNAUTHENTICATED))}shutdown(){}}class a_{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class l_{constructor(e){this.t=e,this.currentUser=Er.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Ft(this.o===void 0,42304);let n=this.i;const i=u=>this.i!==n?(n=this.i,r(u)):Promise.resolve();let o=new ni;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new ni,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const u=o;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},c=u=>{We("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(We("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new ni)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(We("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Ft(typeof n.accessToken=="string",31837,{l:n}),new gf(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ft(e===null||typeof e=="string",2055,{h:e}),new Er(e)}}class c_{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Er.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class u_{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new c_(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(Er.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class _d{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class d_{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Fr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Ft(this.o===void 0,3512);const n=o=>{o.error!=null&&We("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const a=o.token!==this.m;return this.m=o.token,We("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>n(o))};const i=o=>{We("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):We("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new _d(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Ft(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new _d(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h_(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kc{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=h_(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<r&&(n+=e.charAt(i[o]%62))}return n}}function At(t,e){return t<e?-1:t>e?1:0}function Gl(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const i=t.charAt(n),o=e.charAt(n);if(i!==o)return cl(i)===cl(o)?At(i,o):cl(i)?1:-1}return At(t.length,e.length)}const m_=55296,f_=57343;function cl(t){const e=t.charCodeAt(0);return e>=m_&&e<=f_}function ro(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sd="__name__";class on{constructor(e,r,n){r===void 0?r=0:r>e.length&&ct(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&ct(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return on.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof on?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const o=on.compareSegments(e.get(i),r.get(i));if(o!==0)return o}return At(e.length,r.length)}static compareSegments(e,r){const n=on.isNumericId(e),i=on.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?on.extractNumericId(e).compare(on.extractNumericId(r)):Gl(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ri.fromString(e.substring(4,e.length-2))}}class Jt extends on{construct(e,r,n){return new Jt(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new ot(Ne.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Jt(r)}static emptyPath(){return new Jt([])}}const y_=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class br extends on{construct(e,r,n){return new br(e,r,n)}static isValidIdentifier(e){return y_.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),br.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Sd}static keyField(){return new br([Sd])}static fromServerFormat(e){const r=[];let n="",i=0;const o=()=>{if(n.length===0)throw new ot(Ne.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new ot(Ne.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new ot(Ne.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,i+=2}else c==="`"?(a=!a,i++):c!=="."||a?(n+=c,i++):(o(),i++)}if(o(),a)throw new ot(Ne.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new br(r)}static emptyPath(){return new br([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(e){this.path=e}static fromPath(e){return new lt(Jt.fromString(e))}static fromName(e){return new lt(Jt.fromString(e).popFirst(5))}static empty(){return new lt(Jt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Jt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Jt.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new lt(new Jt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g_(t,e,r){if(!r)throw new ot(Ne.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function p_(t,e,r,n){if(e===!0&&n===!0)throw new ot(Ne.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function Pd(t){if(!lt.isDocumentKey(t))throw new ot(Ne.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function pf(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Rc(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ct(12329,{type:typeof t})}function Jo(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ot(Ne.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Rc(t);throw new ot(Ne.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ar(t,e){const r={typeString:t};return e&&(r.value=e),r}function hs(t,e){if(!pf(t))throw new ot(Ne.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const a=t[n];if(i&&typeof a!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(o!==void 0&&a!==o.value){r=`Expected '${n}' field to equal '${o.value}'`;break}}if(r)throw new ot(Ne.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wd=-62135596800,Cd=1e6;class Kt{static now(){return Kt.fromMillis(Date.now())}static fromDate(e){return Kt.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*Cd);return new Kt(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new ot(Ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new ot(Ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<wd)throw new ot(Ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ot(Ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Cd}_compareTo(e){return this.seconds===e.seconds?At(this.nanoseconds,e.nanoseconds):At(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Kt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(hs(e,Kt._jsonSchema))return new Kt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-wd;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Kt._jsonSchemaVersion="firestore/timestamp/1.0",Kt._jsonSchema={type:ar("string",Kt._jsonSchemaVersion),seconds:ar("number"),nanoseconds:ar("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{static fromTimestamp(e){return new mt(e)}static min(){return new mt(new Kt(0,0))}static max(){return new mt(new Kt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xo=-1;function v_(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=mt.fromTimestamp(n===1e9?new Kt(r+1,0):new Kt(r,n));return new ii(i,lt.empty(),e)}function b_(t){return new ii(t.readTime,t.key,Xo)}class ii{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new ii(mt.min(),lt.empty(),Xo)}static max(){return new ii(mt.max(),lt.empty(),Xo)}}function __(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=lt.comparator(t.documentKey,e.documentKey),r!==0?r:At(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S_="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class P_{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mo(t){if(t.code!==Ne.FAILED_PRECONDITION||t.message!==S_)throw t;We("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&ct(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Re((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(r,o).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Re?r:Re.resolve(r)}catch(r){return Re.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Re.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Re.reject(r)}static resolve(e){return new Re((r,n)=>{r(e)})}static reject(e){return new Re((r,n)=>{n(e)})}static waitFor(e){return new Re((r,n)=>{let i=0,o=0,a=!1;e.forEach(c=>{++i,c.next(()=>{++o,a&&o===i&&r()},u=>n(u))}),a=!0,o===i&&r()})}static or(e){let r=Re.resolve(!1);for(const n of e)r=r.next(i=>i?Re.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,o)=>{n.push(r.call(this,i,o))}),this.waitFor(n)}static mapArray(e,r){return new Re((n,i)=>{const o=e.length,a=new Array(o);let c=0;for(let u=0;u<o;u++){const h=u;r(e[h]).next(f=>{a[h]=f,++c,c===o&&n(a)},f=>i(f))}})}static doWhile(e,r){return new Re((n,i)=>{const o=()=>{e()===!0?r().next(()=>{o()},i):n()};o()})}}function w_(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function fo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Na{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Na.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dc=-1;function La(t){return t==null}function ga(t){return t===0&&1/t==-1/0}function C_(t){return typeof t=="number"&&Number.isInteger(t)&&!ga(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vf="";function A_(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=Ad(e)),e=I_(t.get(r),e);return Ad(e)}function I_(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const o=t.charAt(i);switch(o){case"\0":r+="";break;case vf:r+="";break;default:r+=o}}return r}function Ad(t){return t+vf+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Id(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function ki(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function bf(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e,r){this.comparator=e,this.root=r||vr.EMPTY}insert(e,r){return new Xt(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,vr.BLACK,null,null))}remove(e){return new Xt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,vr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ts(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ts(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ts(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ts(this.root,e,this.comparator,!0)}}class Ts{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=r?n(e.key,r):1,r&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class vr{constructor(e,r,n,i,o){this.key=e,this.value=r,this.color=n??vr.RED,this.left=i??vr.EMPTY,this.right=o??vr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,o){return new vr(e??this.key,r??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const o=n(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,r,n),null):o===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return vr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return vr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,vr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,vr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ct(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ct(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ct(27949);return e+(this.isRed()?0:1)}}vr.EMPTY=null,vr.RED=!0,vr.BLACK=!1;vr.EMPTY=new class{constructor(){this.size=0}get key(){throw ct(57766)}get value(){throw ct(16141)}get color(){throw ct(16727)}get left(){throw ct(29726)}get right(){throw ct(36894)}copy(e,r,n,i,o){return this}insert(e,r,n){return new vr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur{constructor(e){this.comparator=e,this.data=new Xt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new Ed(this.data.getIterator())}getIteratorFrom(e){return new Ed(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof ur)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new ur(this.comparator);return r.data=e,r}}class Ed{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(e){this.fields=e,e.sort(br.comparator)}static empty(){return new Yr([])}unionWith(e){let r=new ur(br.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Yr(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return ro(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _f extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new _f("Invalid base64 string: "+o):o}}(e);return new Sr(r)}static fromUint8Array(e){const r=function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o}(e);return new Sr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return At(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Sr.EMPTY_BYTE_STRING=new Sr("");const E_=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function oi(t){if(Ft(!!t,39018),typeof t=="string"){let e=0;const r=E_.exec(t);if(Ft(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:tr(t.seconds),nanos:tr(t.nanos)}}function tr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function si(t){return typeof t=="string"?Sr.fromBase64String(t):Sr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sf="server_timestamp",Pf="__type__",wf="__previous_value__",Cf="__local_write_time__";function Nc(t){return(t?.mapValue?.fields||{})[Pf]?.stringValue===Sf}function Ma(t){const e=t.mapValue.fields[wf];return Nc(e)?Ma(e):e}function Zo(t){const e=oi(t.mapValue.fields[Cf].timestampValue);return new Kt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x_{constructor(e,r,n,i,o,a,c,u,h,f){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=f}}const pa="(default)";class es{constructor(e,r){this.projectId=e,this.database=r||pa}static empty(){return new es("","")}get isDefaultDatabase(){return this.database===pa}isEqual(e){return e instanceof es&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Af="__type__",T_="__max__",$s={mapValue:{}},If="__vector__",va="value";function ai(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Nc(t)?4:k_(t)?9007199254740991:$_(t)?10:11:ct(28295,{value:t})}function mn(t,e){if(t===e)return!0;const r=ai(t);if(r!==ai(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Zo(t).isEqual(Zo(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const a=oi(i.timestampValue),c=oi(o.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,o){return si(i.bytesValue).isEqual(si(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,o){return tr(i.geoPointValue.latitude)===tr(o.geoPointValue.latitude)&&tr(i.geoPointValue.longitude)===tr(o.geoPointValue.longitude)}(t,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return tr(i.integerValue)===tr(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const a=tr(i.doubleValue),c=tr(o.doubleValue);return a===c?ga(a)===ga(c):isNaN(a)&&isNaN(c)}return!1}(t,e);case 9:return ro(t.arrayValue.values||[],e.arrayValue.values||[],mn);case 10:case 11:return function(i,o){const a=i.mapValue.fields||{},c=o.mapValue.fields||{};if(Id(a)!==Id(c))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(c[u]===void 0||!mn(a[u],c[u])))return!1;return!0}(t,e);default:return ct(52216,{left:t})}}function ts(t,e){return(t.values||[]).find(r=>mn(r,e))!==void 0}function no(t,e){if(t===e)return 0;const r=ai(t),n=ai(e);if(r!==n)return At(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return At(t.booleanValue,e.booleanValue);case 2:return function(o,a){const c=tr(o.integerValue||o.doubleValue),u=tr(a.integerValue||a.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return xd(t.timestampValue,e.timestampValue);case 4:return xd(Zo(t),Zo(e));case 5:return Gl(t.stringValue,e.stringValue);case 6:return function(o,a){const c=si(o),u=si(a);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(o,a){const c=o.split("/"),u=a.split("/");for(let h=0;h<c.length&&h<u.length;h++){const f=At(c[h],u[h]);if(f!==0)return f}return At(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,a){const c=At(tr(o.latitude),tr(a.latitude));return c!==0?c:At(tr(o.longitude),tr(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Td(t.arrayValue,e.arrayValue);case 10:return function(o,a){const c=o.fields||{},u=a.fields||{},h=c[va]?.arrayValue,f=u[va]?.arrayValue,p=At(h?.values?.length||0,f?.values?.length||0);return p!==0?p:Td(h,f)}(t.mapValue,e.mapValue);case 11:return function(o,a){if(o===$s.mapValue&&a===$s.mapValue)return 0;if(o===$s.mapValue)return 1;if(a===$s.mapValue)return-1;const c=o.fields||{},u=Object.keys(c),h=a.fields||{},f=Object.keys(h);u.sort(),f.sort();for(let p=0;p<u.length&&p<f.length;++p){const _=Gl(u[p],f[p]);if(_!==0)return _;const E=no(c[u[p]],h[f[p]]);if(E!==0)return E}return At(u.length,f.length)}(t.mapValue,e.mapValue);default:throw ct(23264,{he:r})}}function xd(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return At(t,e);const r=oi(t),n=oi(e),i=At(r.seconds,n.seconds);return i!==0?i:At(r.nanos,n.nanos)}function Td(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const o=no(r[i],n[i]);if(o)return o}return At(r.length,n.length)}function io(t){return Kl(t)}function Kl(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=oi(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return si(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return lt.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const o of r.values||[])i?i=!1:n+=",",n+=Kl(o);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const a of n)o?o=!1:i+=",",i+=`${a}:${Kl(r.fields[a])}`;return i+"}"}(t.mapValue):ct(61005,{value:t})}function Qs(t){switch(ai(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ma(t);return e?16+Qs(e):16;case 5:return 2*t.stringValue.length;case 6:return si(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,o)=>i+Qs(o),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return ki(n.fields,(o,a)=>{i+=o.length+Qs(a)}),i}(t.mapValue);default:throw ct(13486,{value:t})}}function Yl(t){return!!t&&"integerValue"in t}function Lc(t){return!!t&&"arrayValue"in t}function $d(t){return!!t&&"nullValue"in t}function kd(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Js(t){return!!t&&"mapValue"in t}function $_(t){return(t?.mapValue?.fields||{})[Af]?.stringValue===If}function Vo(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return ki(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Vo(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Vo(t.arrayValue.values[r]);return e}return{...t}}function k_(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===T_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(e){this.value=e}static empty(){return new Ur({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Js(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Vo(r)}setAll(e){let r=br.emptyPath(),n={},i=[];e.forEach((a,c)=>{if(!r.isImmediateParentOf(c)){const u=this.getFieldsMap(r);this.applyChanges(u,n,i),n={},i=[],r=c.popLast()}a?n[c.lastSegment()]=Vo(a):i.push(c.lastSegment())});const o=this.getFieldsMap(r);this.applyChanges(o,n,i)}delete(e){const r=this.field(e.popLast());Js(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return mn(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];Js(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){ki(r,(i,o)=>e[i]=o);for(const i of n)delete e[i]}clone(){return new Ur(Vo(this.value))}}function Ef(t){const e=[];return ki(t.fields,(r,n)=>{const i=new br([r]);if(Js(n)){const o=Ef(n.mapValue).fields;if(o.length===0)e.push(i);else for(const a of o)e.push(i.child(a))}else e.push(i)}),new Yr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(e,r,n,i,o,a,c){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=o,this.data=a,this.documentState=c}static newInvalidDocument(e){return new xr(e,0,mt.min(),mt.min(),mt.min(),Ur.empty(),0)}static newFoundDocument(e,r,n,i){return new xr(e,1,r,mt.min(),n,i,0)}static newNoDocument(e,r){return new xr(e,2,r,mt.min(),mt.min(),Ur.empty(),0)}static newUnknownDocument(e,r){return new xr(e,3,r,mt.min(),mt.min(),Ur.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(mt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ur.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ur.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=mt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof xr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new xr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba{constructor(e,r){this.position=e,this.inclusive=r}}function Rd(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const o=e[i],a=t.position[i];if(o.field.isKeyField()?n=lt.comparator(lt.fromName(a.referenceValue),r.key):n=no(a,r.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function Dd(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!mn(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(e,r="asc"){this.field=e,this.dir=r}}function R_(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xf{}class cr extends xf{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new N_(e,r,n):r==="array-contains"?new O_(e,n):r==="in"?new V_(e,n):r==="not-in"?new B_(e,n):r==="array-contains-any"?new F_(e,n):new cr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new L_(e,n):new M_(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(no(r,this.value)):r!==null&&ai(this.value)===ai(r)&&this.matchesComparison(no(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ct(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class fn extends xf{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new fn(e,r)}matches(e){return Tf(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Tf(t){return t.op==="and"}function $f(t){return D_(t)&&Tf(t)}function D_(t){for(const e of t.filters)if(e instanceof fn)return!1;return!0}function Ql(t){if(t instanceof cr)return t.field.canonicalString()+t.op.toString()+io(t.value);if($f(t))return t.filters.map(e=>Ql(e)).join(",");{const e=t.filters.map(r=>Ql(r)).join(",");return`${t.op}(${e})`}}function kf(t,e){return t instanceof cr?function(n,i){return i instanceof cr&&n.op===i.op&&n.field.isEqual(i.field)&&mn(n.value,i.value)}(t,e):t instanceof fn?function(n,i){return i instanceof fn&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((o,a,c)=>o&&kf(a,i.filters[c]),!0):!1}(t,e):void ct(19439)}function Rf(t){return t instanceof cr?function(r){return`${r.field.canonicalString()} ${r.op} ${io(r.value)}`}(t):t instanceof fn?function(r){return r.op.toString()+" {"+r.getFilters().map(Rf).join(" ,")+"}"}(t):"Filter"}class N_ extends cr{constructor(e,r,n){super(e,r,n),this.key=lt.fromName(n.referenceValue)}matches(e){const r=lt.comparator(e.key,this.key);return this.matchesComparison(r)}}class L_ extends cr{constructor(e,r){super(e,"in",r),this.keys=Df("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class M_ extends cr{constructor(e,r){super(e,"not-in",r),this.keys=Df("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function Df(t,e){return(e.arrayValue?.values||[]).map(r=>lt.fromName(r.referenceValue))}class O_ extends cr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Lc(r)&&ts(r.arrayValue,this.value)}}class V_ extends cr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&ts(this.value.arrayValue,r)}}class B_ extends cr{constructor(e,r){super(e,"not-in",r)}matches(e){if(ts(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!ts(this.value.arrayValue,r)}}class F_ extends cr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Lc(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>ts(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U_{constructor(e,r=null,n=[],i=[],o=null,a=null,c=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=a,this.endAt=c,this.Te=null}}function Nd(t,e=null,r=[],n=[],i=null,o=null,a=null){return new U_(t,e,r,n,i,o,a)}function Mc(t){const e=ft(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Ql(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(o){return o.field.canonicalString()+o.dir}(n)).join(","),La(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>io(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>io(n)).join(",")),e.Te=r}return e.Te}function Oc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!R_(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!kf(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Dd(t.startAt,e.startAt)&&Dd(t.endAt,e.endAt)}function Jl(t){return lt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa{constructor(e,r=null,n=[],i=[],o=null,a="F",c=null,u=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=a,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function j_(t,e,r,n,i,o,a,c){return new Oa(t,e,r,n,i,o,a,c)}function Vc(t){return new Oa(t)}function Ld(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function z_(t){return t.collectionGroup!==null}function Bo(t){const e=ft(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),r.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new ur(br.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(c=c.add(h.field))})}),c})(e).forEach(o=>{r.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new _a(o,n))}),r.has(br.keyField().canonicalString())||e.Ie.push(new _a(br.keyField(),n))}return e.Ie}function ln(t){const e=ft(t);return e.Ee||(e.Ee=q_(e,Bo(t))),e.Ee}function q_(t,e){if(t.limitType==="F")return Nd(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const o=i.dir==="desc"?"asc":"desc";return new _a(i.field,o)});const r=t.endAt?new ba(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new ba(t.startAt.position,t.startAt.inclusive):null;return Nd(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Xl(t,e,r){return new Oa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Va(t,e){return Oc(ln(t),ln(e))&&t.limitType===e.limitType}function Nf(t){return`${Mc(ln(t))}|lt:${t.limitType}`}function Hi(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>Rf(i)).join(", ")}]`),La(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>io(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>io(i)).join(",")),`Target(${n})`}(ln(t))}; limitType=${t.limitType})`}function Ba(t,e){return e.isFoundDocument()&&function(n,i){const o=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):lt.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(t,e)&&function(n,i){for(const o of Bo(n))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const o of n.filters)if(!o.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,c,u){const h=Rd(a,c,u);return a.inclusive?h<=0:h<0}(n.startAt,Bo(n),i)||n.endAt&&!function(a,c,u){const h=Rd(a,c,u);return a.inclusive?h>=0:h>0}(n.endAt,Bo(n),i))}(t,e)}function H_(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Lf(t){return(e,r)=>{let n=!1;for(const i of Bo(t)){const o=W_(i,e,r);if(o!==0)return o;n=n||i.field.isKeyField()}return 0}}function W_(t,e,r){const n=t.field.isKeyField()?lt.comparator(e.key,r.key):function(o,a,c){const u=a.data.field(o),h=c.data.field(o);return u!==null&&h!==null?no(u,h):ct(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return ct(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,o]of n)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ki(this.inner,(r,n)=>{for(const[i,o]of n)e(i,o)})}isEmpty(){return bf(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G_=new Xt(lt.comparator);function Nn(){return G_}const Mf=new Xt(lt.comparator);function $o(...t){let e=Mf;for(const r of t)e=e.insert(r.key,r);return e}function Of(t){let e=Mf;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Si(){return Fo()}function Vf(){return Fo()}function Fo(){return new Ri(t=>t.toString(),(t,e)=>t.isEqual(e))}const K_=new Xt(lt.comparator),Y_=new ur(lt.comparator);function It(...t){let e=Y_;for(const r of t)e=e.add(r);return e}const Q_=new ur(At);function J_(){return Q_}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bc(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ga(e)?"-0":e}}function Bf(t){return{integerValue:""+t}}function X_(t,e){return C_(e)?Bf(e):Bc(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa{constructor(){this._=void 0}}function Z_(t,e,r){return t instanceof Sa?function(i,o){const a={fields:{[Pf]:{stringValue:Sf},[Cf]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Nc(o)&&(o=Ma(o)),o&&(a.fields[wf]=o),{mapValue:a}}(r,e):t instanceof rs?Uf(t,e):t instanceof ns?jf(t,e):function(i,o){const a=Ff(i,o),c=Md(a)+Md(i.Ae);return Yl(a)&&Yl(i.Ae)?Bf(c):Bc(i.serializer,c)}(t,e)}function eS(t,e,r){return t instanceof rs?Uf(t,e):t instanceof ns?jf(t,e):r}function Ff(t,e){return t instanceof Pa?function(n){return Yl(n)||function(o){return!!o&&"doubleValue"in o}(n)}(e)?e:{integerValue:0}:null}class Sa extends Fa{}class rs extends Fa{constructor(e){super(),this.elements=e}}function Uf(t,e){const r=zf(e);for(const n of t.elements)r.some(i=>mn(i,n))||r.push(n);return{arrayValue:{values:r}}}class ns extends Fa{constructor(e){super(),this.elements=e}}function jf(t,e){let r=zf(e);for(const n of t.elements)r=r.filter(i=>!mn(i,n));return{arrayValue:{values:r}}}class Pa extends Fa{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function Md(t){return tr(t.integerValue||t.doubleValue)}function zf(t){return Lc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function tS(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof rs&&i instanceof rs||n instanceof ns&&i instanceof ns?ro(n.elements,i.elements,mn):n instanceof Pa&&i instanceof Pa?mn(n.Ae,i.Ae):n instanceof Sa&&i instanceof Sa}(t.transform,e.transform)}class rS{constructor(e,r){this.version=e,this.transformResults=r}}class $n{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new $n}static exists(e){return new $n(void 0,e)}static updateTime(e){return new $n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Xs(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Ua{}function qf(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Wf(t.key,$n.none()):new ms(t.key,t.data,$n.none());{const r=t.data,n=Ur.empty();let i=new ur(br.comparator);for(let o of e.fields)if(!i.has(o)){let a=r.field(o);a===null&&o.length>1&&(o=o.popLast(),a=r.field(o)),a===null?n.delete(o):n.set(o,a),i=i.add(o)}return new Di(t.key,n,new Yr(i.toArray()),$n.none())}}function nS(t,e,r){t instanceof ms?function(i,o,a){const c=i.value.clone(),u=Vd(i.fieldTransforms,o,a.transformResults);c.setAll(u),o.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,r):t instanceof Di?function(i,o,a){if(!Xs(i.precondition,o))return void o.convertToUnknownDocument(a.version);const c=Vd(i.fieldTransforms,o,a.transformResults),u=o.data;u.setAll(Hf(i)),u.setAll(c),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,r):function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function Uo(t,e,r,n){return t instanceof ms?function(o,a,c,u){if(!Xs(o.precondition,a))return c;const h=o.value.clone(),f=Bd(o.fieldTransforms,u,a);return h.setAll(f),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(t,e,r,n):t instanceof Di?function(o,a,c,u){if(!Xs(o.precondition,a))return c;const h=Bd(o.fieldTransforms,u,a),f=a.data;return f.setAll(Hf(o)),f.setAll(h),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),c===null?null:c.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(p=>p.field))}(t,e,r,n):function(o,a,c){return Xs(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(t,e,r)}function iS(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),o=Ff(n.transform,i||null);o!=null&&(r===null&&(r=Ur.empty()),r.set(n.field,o))}return r||null}function Od(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&ro(n,i,(o,a)=>tS(o,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ms extends Ua{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Di extends Ua{constructor(e,r,n,i,o=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function Hf(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function Vd(t,e,r){const n=new Map;Ft(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let i=0;i<r.length;i++){const o=t[i],a=o.transform,c=e.data.field(o.field);n.set(o.field,eS(a,c,r[i]))}return n}function Bd(t,e,r){const n=new Map;for(const i of t){const o=i.transform,a=r.data.field(i.field);n.set(i.field,Z_(o,a,e))}return n}class Wf extends Ua{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class oS extends Ua{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&nS(o,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Uo(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Uo(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=Vf();return this.mutations.forEach(i=>{const o=e.get(i.key),a=o.overlayedDocument;let c=this.applyToLocalView(a,o.mutatedFields);c=r.has(i.key)?null:c;const u=qf(a,c);u!==null&&n.set(i.key,u),a.isValidDocument()||a.convertToNoDocument(mt.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),It())}isEqual(e){return this.batchId===e.batchId&&ro(this.mutations,e.mutations,(r,n)=>Od(r,n))&&ro(this.baseMutations,e.baseMutations,(r,n)=>Od(r,n))}}class Fc{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Ft(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=function(){return K_}();const o=e.mutations;for(let a=0;a<o.length;a++)i=i.insert(o[a].key,n[a].version);return new Fc(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aS{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var or,Et;function cS(t){switch(t){case Ne.OK:return ct(64938);case Ne.CANCELLED:case Ne.UNKNOWN:case Ne.DEADLINE_EXCEEDED:case Ne.RESOURCE_EXHAUSTED:case Ne.INTERNAL:case Ne.UNAVAILABLE:case Ne.UNAUTHENTICATED:return!1;case Ne.INVALID_ARGUMENT:case Ne.NOT_FOUND:case Ne.ALREADY_EXISTS:case Ne.PERMISSION_DENIED:case Ne.FAILED_PRECONDITION:case Ne.ABORTED:case Ne.OUT_OF_RANGE:case Ne.UNIMPLEMENTED:case Ne.DATA_LOSS:return!0;default:return ct(15467,{code:t})}}function Gf(t){if(t===void 0)return Dn("GRPC error has no .code"),Ne.UNKNOWN;switch(t){case or.OK:return Ne.OK;case or.CANCELLED:return Ne.CANCELLED;case or.UNKNOWN:return Ne.UNKNOWN;case or.DEADLINE_EXCEEDED:return Ne.DEADLINE_EXCEEDED;case or.RESOURCE_EXHAUSTED:return Ne.RESOURCE_EXHAUSTED;case or.INTERNAL:return Ne.INTERNAL;case or.UNAVAILABLE:return Ne.UNAVAILABLE;case or.UNAUTHENTICATED:return Ne.UNAUTHENTICATED;case or.INVALID_ARGUMENT:return Ne.INVALID_ARGUMENT;case or.NOT_FOUND:return Ne.NOT_FOUND;case or.ALREADY_EXISTS:return Ne.ALREADY_EXISTS;case or.PERMISSION_DENIED:return Ne.PERMISSION_DENIED;case or.FAILED_PRECONDITION:return Ne.FAILED_PRECONDITION;case or.ABORTED:return Ne.ABORTED;case or.OUT_OF_RANGE:return Ne.OUT_OF_RANGE;case or.UNIMPLEMENTED:return Ne.UNIMPLEMENTED;case or.DATA_LOSS:return Ne.DATA_LOSS;default:return ct(39323,{code:t})}}(Et=or||(or={}))[Et.OK=0]="OK",Et[Et.CANCELLED=1]="CANCELLED",Et[Et.UNKNOWN=2]="UNKNOWN",Et[Et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Et[Et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Et[Et.NOT_FOUND=5]="NOT_FOUND",Et[Et.ALREADY_EXISTS=6]="ALREADY_EXISTS",Et[Et.PERMISSION_DENIED=7]="PERMISSION_DENIED",Et[Et.UNAUTHENTICATED=16]="UNAUTHENTICATED",Et[Et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Et[Et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Et[Et.ABORTED=10]="ABORTED",Et[Et.OUT_OF_RANGE=11]="OUT_OF_RANGE",Et[Et.UNIMPLEMENTED=12]="UNIMPLEMENTED",Et[Et.INTERNAL=13]="INTERNAL",Et[Et.UNAVAILABLE=14]="UNAVAILABLE",Et[Et.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uS(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dS=new ri([4294967295,4294967295],0);function Fd(t){const e=uS().encode(t),r=new cf;return r.update(e),new Uint8Array(r.digest())}function Ud(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new ri([r,n],0),new ri([i,o],0)]}class Uc{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new ko(`Invalid padding: ${r}`);if(n<0)throw new ko(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new ko(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new ko(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=ri.fromNumber(this.ge)}ye(e,r,n){let i=e.add(r.multiply(ri.fromNumber(n)));return i.compare(dS)===1&&(i=new ri([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=Fd(e),[n,i]=Ud(r);for(let o=0;o<this.hashCount;o++){const a=this.ye(n,i,o);if(!this.we(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new Uc(o,i,r);return n.forEach(c=>a.insert(c)),a}insert(e){if(this.ge===0)return;const r=Fd(e),[n,i]=Ud(r);for(let o=0;o<this.hashCount;o++){const a=this.ye(n,i,o);this.Se(a)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class ko extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja{constructor(e,r,n,i,o){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,fs.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new ja(mt.min(),i,new Xt(At),Nn(),It())}}class fs{constructor(e,r,n,i,o){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new fs(n,r,It(),It(),It())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs{constructor(e,r,n,i){this.be=e,this.removedTargetIds=r,this.key=n,this.De=i}}class Kf{constructor(e,r){this.targetId=e,this.Ce=r}}class Yf{constructor(e,r,n=Sr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class jd{constructor(){this.ve=0,this.Fe=zd(),this.Me=Sr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=It(),r=It(),n=It();return this.Fe.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:ct(38017,{changeType:o})}}),new fs(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=zd()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ft(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class hS{constructor(e){this.Ge=e,this.ze=new Map,this.je=Nn(),this.Je=ks(),this.He=ks(),this.Ye=new Xt(At)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:ct(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,i)=>{this.rt(i)&&r(i)})}st(e){const r=e.targetId,n=e.Ce.count,i=this.ot(r);if(i){const o=i.target;if(Jl(o))if(n===0){const a=new lt(o.path);this.et(r,a,xr.newNoDocument(a,mt.min()))}else Ft(n===1,20013,{expectedCount:n});else{const a=this._t(r);if(a!==n){const c=this.ut(e),u=c?this.ct(c,e,a):1;if(u!==0){this.it(r);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,h)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:o=0}=r;let a,c;try{a=si(n).toUint8Array()}catch(u){if(u instanceof _f)return to("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Uc(a,i,o)}catch(u){return to(u instanceof ko?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let i=0;return n.forEach(o=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(c)||(this.et(r,o,null),i++)}),i}Tt(e){const r=new Map;this.ze.forEach((o,a)=>{const c=this.ot(a);if(c){if(o.current&&Jl(c.target)){const u=new lt(c.target.path);this.It(u).has(a)||this.Et(a,u)||this.et(a,u,xr.newNoDocument(u,e))}o.Be&&(r.set(a,o.ke()),o.qe())}});let n=It();this.He.forEach((o,a)=>{let c=!0;a.forEachWhile(u=>{const h=this.ot(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(n=n.add(o))}),this.je.forEach((o,a)=>a.setReadTime(e));const i=new ja(e,r,this.Ye,this.je,n);return this.je=Nn(),this.Je=ks(),this.He=ks(),this.Ye=new Xt(At),i}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,r)?i.Qe(r,1):i.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new jd,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new ur(At),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new ur(At),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||We("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new jd),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function ks(){return new Xt(lt.comparator)}function zd(){return new Xt(lt.comparator)}const mS={asc:"ASCENDING",desc:"DESCENDING"},fS={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},yS={and:"AND",or:"OR"};class gS{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Zl(t,e){return t.useProto3Json||La(e)?e:{value:e}}function wa(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Qf(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function pS(t,e){return wa(t,e.toTimestamp())}function cn(t){return Ft(!!t,49232),mt.fromTimestamp(function(r){const n=oi(r);return new Kt(n.seconds,n.nanos)}(t))}function jc(t,e){return ec(t,e).canonicalString()}function ec(t,e){const r=function(i){return new Jt(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function Jf(t){const e=Jt.fromString(t);return Ft(ry(e),10190,{key:e.toString()}),e}function tc(t,e){return jc(t.databaseId,e.path)}function ul(t,e){const r=Jf(e);if(r.get(1)!==t.databaseId.projectId)throw new ot(Ne.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new ot(Ne.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new lt(Zf(r))}function Xf(t,e){return jc(t.databaseId,e)}function vS(t){const e=Jf(t);return e.length===4?Jt.emptyPath():Zf(e)}function rc(t){return new Jt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Zf(t){return Ft(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function qd(t,e,r){return{name:tc(t,e),fields:r.value.mapValue.fields}}function bS(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:ct(39313,{state:h})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(h,f){return h.useProto3Json?(Ft(f===void 0||typeof f=="string",58123),Sr.fromBase64String(f||"")):(Ft(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),Sr.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(h){const f=h.code===void 0?Ne.UNKNOWN:Gf(h.code);return new ot(f,h.message||"")}(a);r=new Yf(n,i,o,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=ul(t,n.document.name),o=cn(n.document.updateTime),a=n.document.createTime?cn(n.document.createTime):mt.min(),c=new Ur({mapValue:{fields:n.document.fields}}),u=xr.newFoundDocument(i,o,a,c),h=n.targetIds||[],f=n.removedTargetIds||[];r=new Zs(h,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=ul(t,n.document),o=n.readTime?cn(n.readTime):mt.min(),a=xr.newNoDocument(i,o),c=n.removedTargetIds||[];r=new Zs([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=ul(t,n.document),o=n.removedTargetIds||[];r=new Zs([],o,i,null)}else{if(!("filter"in e))return ct(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:o}=n,a=new lS(i,o),c=n.targetId;r=new Kf(c,a)}}return r}function _S(t,e){let r;if(e instanceof ms)r={update:qd(t,e.key,e.value)};else if(e instanceof Wf)r={delete:tc(t,e.key)};else if(e instanceof Di)r={update:qd(t,e.key,e.data),updateMask:TS(e.fieldMask)};else{if(!(e instanceof oS))return ct(16599,{Vt:e.type});r={verify:tc(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(o,a){const c=a.transform;if(c instanceof Sa)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof rs)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof ns)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Pa)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw ct(20930,{transform:a.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:pS(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:ct(27497)}(t,e.precondition)),r}function SS(t,e){return t&&t.length>0?(Ft(e!==void 0,14353),t.map(r=>function(i,o){let a=i.updateTime?cn(i.updateTime):cn(o);return a.isEqual(mt.min())&&(a=cn(o)),new rS(a,i.transformResults||[])}(r,e))):[]}function PS(t,e){return{documents:[Xf(t,e.path)]}}function wS(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=Xf(t,i);const o=function(h){if(h.length!==0)return ty(fn.create(h,"and"))}(e.filters);o&&(r.structuredQuery.where=o);const a=function(h){if(h.length!==0)return h.map(f=>function(_){return{field:Wi(_.field),direction:IS(_.dir)}}(f))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const c=Zl(t,e.limit);return c!==null&&(r.structuredQuery.limit=c),e.startAt&&(r.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{ft:r,parent:i}}function CS(t){let e=vS(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Ft(n===1,65062);const f=r.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let o=[];r.where&&(o=function(p){const _=ey(p);return _ instanceof fn&&$f(_)?_.getFilters():[_]}(r.where));let a=[];r.orderBy&&(a=function(p){return p.map(_=>function(A){return new _a(Gi(A.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(A.direction))}(_))}(r.orderBy));let c=null;r.limit&&(c=function(p){let _;return _=typeof p=="object"?p.value:p,La(_)?null:_}(r.limit));let u=null;r.startAt&&(u=function(p){const _=!!p.before,E=p.values||[];return new ba(E,_)}(r.startAt));let h=null;return r.endAt&&(h=function(p){const _=!p.before,E=p.values||[];return new ba(E,_)}(r.endAt)),j_(e,i,a,o,c,"F",u,h)}function AS(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ct(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function ey(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Gi(r.unaryFilter.field);return cr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Gi(r.unaryFilter.field);return cr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Gi(r.unaryFilter.field);return cr.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Gi(r.unaryFilter.field);return cr.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ct(61313);default:return ct(60726)}}(t):t.fieldFilter!==void 0?function(r){return cr.create(Gi(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ct(58110);default:return ct(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return fn.create(r.compositeFilter.filters.map(n=>ey(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ct(1026)}}(r.compositeFilter.op))}(t):ct(30097,{filter:t})}function IS(t){return mS[t]}function ES(t){return fS[t]}function xS(t){return yS[t]}function Wi(t){return{fieldPath:t.canonicalString()}}function Gi(t){return br.fromServerFormat(t.fieldPath)}function ty(t){return t instanceof cr?function(r){if(r.op==="=="){if(kd(r.value))return{unaryFilter:{field:Wi(r.field),op:"IS_NAN"}};if($d(r.value))return{unaryFilter:{field:Wi(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(kd(r.value))return{unaryFilter:{field:Wi(r.field),op:"IS_NOT_NAN"}};if($d(r.value))return{unaryFilter:{field:Wi(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Wi(r.field),op:ES(r.op),value:r.value}}}(t):t instanceof fn?function(r){const n=r.getFilters().map(i=>ty(i));return n.length===1?n[0]:{compositeFilter:{op:xS(r.op),filters:n}}}(t):ct(54877,{filter:t})}function TS(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function ry(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(e,r,n,i,o=mt.min(),a=mt.min(),c=Sr.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Qn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Qn(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Qn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Qn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $S{constructor(e){this.yt=e}}function kS(t){const e=CS({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Xl(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RS{constructor(){this.Cn=new DS}addToCollectionParentIndex(e,r){return this.Cn.add(r),Re.resolve()}getCollectionParents(e,r){return Re.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return Re.resolve()}deleteFieldIndex(e,r){return Re.resolve()}deleteAllFieldIndexes(e){return Re.resolve()}createTargetIndexes(e,r){return Re.resolve()}getDocumentsMatchingTarget(e,r){return Re.resolve(null)}getIndexType(e,r){return Re.resolve(0)}getFieldIndexes(e,r){return Re.resolve([])}getNextCollectionGroupToUpdate(e){return Re.resolve(null)}getMinOffset(e,r){return Re.resolve(ii.min())}getMinOffsetFromCollectionGroup(e,r){return Re.resolve(ii.min())}updateCollectionGroup(e,r,n){return Re.resolve()}updateIndexEntries(e,r){return Re.resolve()}}class DS{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new ur(Jt.comparator),o=!i.has(n);return this.index[r]=i.add(n),o}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new ur(Jt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hd={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},ny=41943040;class Dr{static withCacheSize(e){return new Dr(e,Dr.DEFAULT_COLLECTION_PERCENTILE,Dr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Dr.DEFAULT_COLLECTION_PERCENTILE=10,Dr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Dr.DEFAULT=new Dr(ny,Dr.DEFAULT_COLLECTION_PERCENTILE,Dr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Dr.DISABLED=new Dr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new oo(0)}static cr(){return new oo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wd="LruGarbageCollector",NS=1048576;function Gd([t,e],[r,n]){const i=At(t,r);return i===0?At(e,n):i}class LS{constructor(e){this.Ir=e,this.buffer=new ur(Gd),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();Gd(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class MS{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){We(Wd,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){fo(r)?We(Wd,"Ignoring IndexedDB error during garbage collection: ",r):await mo(r)}await this.Vr(3e5)})}}class OS{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return Re.resolve(Na.ce);const n=new LS(r);return this.mr.forEachTarget(e,i=>n.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>n.Ar(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(We("LruGarbageCollector","Garbage collection skipped; disabled"),Re.resolve(Hd)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(We("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Hd):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,i,o,a,c,u,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(We("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,a=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(n=p,c=Date.now(),this.removeTargets(e,n,r))).next(p=>(o=p,u=Date.now(),this.removeOrphanedDocuments(e,n))).next(p=>(h=Date.now(),qi()<=Ct.DEBUG&&We("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-f}ms
	Determined least recently used ${i} in `+(c-a)+`ms
	Removed ${o} targets in `+(u-c)+`ms
	Removed ${p} documents in `+(h-u)+`ms
Total Duration: ${h-f}ms`),Re.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:p})))}}function VS(t,e){return new OS(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BS{constructor(){this.changes=new Ri(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,xr.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Re.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FS{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class US{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Uo(n.mutation,i,Yr.empty(),Kt.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,It()).next(()=>n))}getLocalViewOfDocuments(e,r,n=It()){const i=Si();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(o=>{let a=$o();return o.forEach((c,u)=>{a=a.insert(c,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=Si();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,It()))}populateOverlays(e,r,n){const i=[];return n.forEach(o=>{r.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((a,c)=>{r.set(a,c)})})}computeViews(e,r,n,i){let o=Nn();const a=Fo(),c=function(){return Fo()}();return r.forEach((u,h)=>{const f=n.get(h.key);i.has(h.key)&&(f===void 0||f.mutation instanceof Di)?o=o.insert(h.key,h):f!==void 0?(a.set(h.key,f.mutation.getFieldMask()),Uo(f.mutation,h,f.mutation.getFieldMask(),Kt.now())):a.set(h.key,Yr.empty())}),this.recalculateAndSaveOverlays(e,o).next(u=>(u.forEach((h,f)=>a.set(h,f)),r.forEach((h,f)=>c.set(h,new FS(f,a.get(h)??null))),c))}recalculateAndSaveOverlays(e,r){const n=Fo();let i=new Xt((a,c)=>a-c),o=It();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const c of a)c.keys().forEach(u=>{const h=r.get(u);if(h===null)return;let f=n.get(u)||Yr.empty();f=c.applyToLocalView(h,f),n.set(u,f);const p=(i.get(c.batchId)||It()).add(u);i=i.insert(c.batchId,p)})}).next(()=>{const a=[],c=i.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),h=u.key,f=u.value,p=Vf();f.forEach(_=>{if(!o.has(_)){const E=qf(r.get(_),n.get(_));E!==null&&p.set(_,E),o=o.add(_)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,p))}return Re.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return lt.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):z_(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(o=>{const a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-o.size):Re.resolve(Si());let c=Xo,u=o;return a.next(h=>Re.forEach(h,(f,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),o.get(f)?Re.resolve():this.remoteDocumentCache.getEntry(e,f).next(_=>{u=u.insert(f,_)}))).next(()=>this.populateOverlays(e,h,o)).next(()=>this.computeViews(e,u,h,It())).next(f=>({batchId:c,changes:Of(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new lt(r)).next(n=>{let i=$o();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const o=r.collectionGroup;let a=$o();return this.indexManager.getCollectionParents(e,o).next(c=>Re.forEach(c,u=>{const h=function(p,_){return new Oa(_,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(r,u.child(o));return this.getDocumentsMatchingCollectionQuery(e,h,n,i).next(f=>{f.forEach((p,_)=>{a=a.insert(p,_)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,o,i))).next(a=>{o.forEach((u,h)=>{const f=h.getKey();a.get(f)===null&&(a=a.insert(f,xr.newInvalidDocument(f)))});let c=$o();return a.forEach((u,h)=>{const f=o.get(u);f!==void 0&&Uo(f.mutation,h,Yr.empty(),Kt.now()),Ba(r,h)&&(c=c.insert(u,h))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return Re.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:cn(i.createTime)}}(r)),Re.resolve()}getNamedQuery(e,r){return Re.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(i){return{name:i.name,query:kS(i.bundledQuery),readTime:cn(i.readTime)}}(r)),Re.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zS{constructor(){this.overlays=new Xt(lt.comparator),this.qr=new Map}getOverlay(e,r){return Re.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Si();return Re.forEach(r,i=>this.getOverlay(e,i).next(o=>{o!==null&&n.set(i,o)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,o)=>{this.St(e,r,o)}),Re.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.qr.delete(n)),Re.resolve()}getOverlaysForCollection(e,r,n){const i=Si(),o=r.length+1,a=new lt(r.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const u=c.getNext().value,h=u.getKey();if(!r.isPrefixOf(h.path))break;h.path.length===o&&u.largestBatchId>n&&i.set(u.getKey(),u)}return Re.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let o=new Xt((h,f)=>h-f);const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===r&&h.largestBatchId>n){let f=o.get(h.largestBatchId);f===null&&(f=Si(),o=o.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const c=Si(),u=o.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,f)=>c.set(h,f)),!(c.size()>=i)););return Re.resolve(c)}St(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new aS(r,n));let o=this.qr.get(r);o===void 0&&(o=It(),this.qr.set(r,o)),this.qr.set(r,o.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qS{constructor(){this.sessionToken=Sr.EMPTY_BYTE_STRING}getSessionToken(e){return Re.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Re.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zc{constructor(){this.Qr=new ur(mr.$r),this.Ur=new ur(mr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new mr(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new mr(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new lt(new Jt([])),n=new mr(r,e),i=new mr(r,e+1),o=[];return this.Ur.forEachInRange([n,i],a=>{this.Gr(a),o.push(a.key)}),o}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new lt(new Jt([])),n=new mr(r,e),i=new mr(r,e+1);let o=It();return this.Ur.forEachInRange([n,i],a=>{o=o.add(a.key)}),o}containsKey(e){const r=new mr(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class mr{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return lt.comparator(e.key,r.key)||At(e.Yr,r.Yr)}static Kr(e,r){return At(e.Yr,r.Yr)||lt.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HS{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new ur(mr.$r)}checkEmpty(e){return Re.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new sS(o,r,n,i);this.mutationQueue.push(a);for(const c of i)this.Zr=this.Zr.add(new mr(c.key,o)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return Re.resolve(a)}lookupMutationBatch(e,r){return Re.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.ei(n),o=i<0?0:i;return Re.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return Re.resolve(this.mutationQueue.length===0?Dc:this.tr-1)}getAllMutationBatches(e){return Re.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new mr(r,0),i=new mr(r,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([n,i],a=>{const c=this.Xr(a.Yr);o.push(c)}),Re.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new ur(At);return r.forEach(i=>{const o=new mr(i,0),a=new mr(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,a],c=>{n=n.add(c.Yr)})}),Re.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let o=n;lt.isDocumentKey(o)||(o=o.child(""));const a=new mr(new lt(o),0);let c=new ur(At);return this.Zr.forEachWhile(u=>{const h=u.key.path;return!!n.isPrefixOf(h)&&(h.length===i&&(c=c.add(u.Yr)),!0)},a),Re.resolve(this.ti(c))}ti(e){const r=[];return e.forEach(n=>{const i=this.Xr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){Ft(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return Re.forEach(r.mutations,i=>{const o=new mr(i.key,r.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new mr(r,0),i=this.Zr.firstAfterOrEqual(n);return Re.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Re.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WS{constructor(e){this.ri=e,this.docs=function(){return new Xt(lt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),o=i?i.size:0,a=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Re.resolve(n?n.document.mutableCopy():xr.newInvalidDocument(r))}getEntries(e,r){let n=Nn();return r.forEach(i=>{const o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():xr.newInvalidDocument(i))}),Re.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let o=Nn();const a=r.path,c=new lt(a.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:h,value:{document:f}}=u.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||__(b_(f),n)<=0||(i.has(f.key)||Ba(r,f))&&(o=o.insert(f.key,f.mutableCopy()))}return Re.resolve(o)}getAllFromCollectionGroup(e,r,n,i){ct(9500)}ii(e,r){return Re.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new GS(this)}getSize(e){return Re.resolve(this.size)}}class GS extends BS{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)}),Re.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{constructor(e){this.persistence=e,this.si=new Ri(r=>Mc(r),Oc),this.lastRemoteSnapshotVersion=mt.min(),this.highestTargetId=0,this.oi=0,this._i=new zc,this.targetCount=0,this.ai=oo.ur()}forEachTarget(e,r){return this.si.forEach((n,i)=>r(i)),Re.resolve()}getLastRemoteSnapshotVersion(e){return Re.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Re.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Re.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),Re.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new oo(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,Re.resolve()}updateTargetData(e,r){return this.Pr(r),Re.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,Re.resolve()}removeTargets(e,r,n){let i=0;const o=[];return this.si.forEach((a,c)=>{c.sequenceNumber<=r&&n.get(c.targetId)===null&&(this.si.delete(a),o.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),Re.waitFor(o).next(()=>i)}getTargetCount(e){return Re.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return Re.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),Re.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const i=this.persistence.referenceDelegate,o=[];return i&&r.forEach(a=>{o.push(i.markPotentiallyOrphaned(e,a))}),Re.waitFor(o)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),Re.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return Re.resolve(n)}containsKey(e,r){return Re.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iy{constructor(e,r){this.ui={},this.overlays={},this.ci=new Na(0),this.li=!1,this.li=!0,this.hi=new qS,this.referenceDelegate=e(this),this.Pi=new KS(this),this.indexManager=new RS,this.remoteDocumentCache=function(i){return new WS(i)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new $S(r),this.Ii=new jS(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new zS,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new HS(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){We("MemoryPersistence","Starting transaction:",e);const i=new YS(this.ci.next());return this.referenceDelegate.Ei(),n(i).next(o=>this.referenceDelegate.di(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ai(e,r){return Re.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class YS extends P_{constructor(e){super(),this.currentSequenceNumber=e}}class qc{constructor(e){this.persistence=e,this.Ri=new zc,this.Vi=null}static mi(e){return new qc(e)}get fi(){if(this.Vi)return this.Vi;throw ct(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),Re.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),Re.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),Re.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(i=>this.fi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(o=>this.fi.add(o.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Re.forEach(this.fi,n=>{const i=lt.fromPath(n);return this.gi(e,i).next(o=>{o||r.removeEntry(i,mt.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return Re.or([()=>Re.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class Ca{constructor(e,r){this.persistence=e,this.pi=new Ri(n=>A_(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=VS(this,r)}static mi(e,r){return new Ca(e,r)}Ei(){}di(e){return Re.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return Re.forEach(this.pi,(n,i)=>this.br(e,n,i).next(o=>o?Re.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ii(e,a=>this.br(e,a,r).next(c=>{c||(n++,o.removeEntry(a,mt.min()))})).next(()=>o.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),Re.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Re.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Re.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),Re.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=Qs(e.data.value)),r}br(e,r,n){return Re.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.pi.get(r);return Re.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hc{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=i}static As(e,r){let n=It(),i=It();for(const o of r.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new Hc(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return Bp()?8:w_($r())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,i){const o={result:null};return this.ys(e,r).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.ws(e,r,i,n).next(a=>{o.result=a})}).next(()=>{if(o.result)return;const a=new QS;return this.Ss(e,r,a).next(c=>{if(o.result=c,this.Vs)return this.bs(e,r,a,c.size)})}).next(()=>o.result)}bs(e,r,n,i){return n.documentReadCount<this.fs?(qi()<=Ct.DEBUG&&We("QueryEngine","SDK will not create cache indexes for query:",Hi(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Re.resolve()):(qi()<=Ct.DEBUG&&We("QueryEngine","Query:",Hi(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(qi()<=Ct.DEBUG&&We("QueryEngine","The SDK decides to create cache indexes for query:",Hi(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ln(r))):Re.resolve())}ys(e,r){if(Ld(r))return Re.resolve(null);let n=ln(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=Xl(r,null,"F"),n=ln(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(o=>{const a=It(...o);return this.ps.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,n).next(u=>{const h=this.Ds(r,c);return this.Cs(r,h,a,u.readTime)?this.ys(e,Xl(r,null,"F")):this.vs(e,h,r,u)}))})))}ws(e,r,n,i){return Ld(r)||i.isEqual(mt.min())?Re.resolve(null):this.ps.getDocuments(e,n).next(o=>{const a=this.Ds(r,o);return this.Cs(r,a,n,i)?Re.resolve(null):(qi()<=Ct.DEBUG&&We("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Hi(r)),this.vs(e,a,r,v_(i,Xo)).next(c=>c))})}Ds(e,r){let n=new ur(Lf(e));return r.forEach((i,o)=>{Ba(e,o)&&(n=n.add(o))}),n}Cs(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const o=e.limitType==="F"?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Ss(e,r,n){return qi()<=Ct.DEBUG&&We("QueryEngine","Using full collection scan to execute query:",Hi(r)),this.ps.getDocumentsMatchingQuery(e,r,ii.min(),n)}vs(e,r,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next(o=>(r.forEach(a=>{o=o.insert(a.key,a)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wc="LocalStore",XS=3e8;class ZS{constructor(e,r,n,i){this.persistence=e,this.Fs=r,this.serializer=i,this.Ms=new Xt(At),this.xs=new Ri(o=>Mc(o),Oc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new US(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function e1(t,e,r,n){return new ZS(t,e,r,n)}async function oy(t,e){const r=ft(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(o=>(i=o,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(o=>{const a=[],c=[];let u=It();for(const h of i){a.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}for(const h of o){c.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}return r.localDocuments.getDocuments(n,u).next(h=>({Ls:h,removedBatchIds:a,addedBatchIds:c}))})})}function t1(t,e){const r=ft(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),o=r.Ns.newChangeBuffer({trackRemovals:!0});return function(c,u,h,f){const p=h.batch,_=p.keys();let E=Re.resolve();return _.forEach(A=>{E=E.next(()=>f.getEntry(u,A)).next(T=>{const x=h.docVersions.get(A);Ft(x!==null,48541),T.version.compareTo(x)<0&&(p.applyToRemoteDocument(T,h),T.isValidDocument()&&(T.setReadTime(h.commitVersion),f.addEntry(T)))})}),E.next(()=>c.mutationQueue.removeMutationBatch(u,p))}(r,n,e,o).next(()=>o.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(c){let u=It();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(u=u.add(c.batch.mutations[h].key));return u}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function sy(t){const e=ft(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function r1(t,e){const r=ft(t),n=e.snapshotVersion;let i=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const a=r.Ns.newChangeBuffer({trackRemovals:!0});i=r.Ms;const c=[];e.targetChanges.forEach((f,p)=>{const _=i.get(p);if(!_)return;c.push(r.Pi.removeMatchingKeys(o,f.removedDocuments,p).next(()=>r.Pi.addMatchingKeys(o,f.addedDocuments,p)));let E=_.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(p)!==null?E=E.withResumeToken(Sr.EMPTY_BYTE_STRING,mt.min()).withLastLimboFreeSnapshotVersion(mt.min()):f.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(f.resumeToken,n)),i=i.insert(p,E),function(T,x,$){return T.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=XS?!0:$.addedDocuments.size+$.modifiedDocuments.size+$.removedDocuments.size>0}(_,E,f)&&c.push(r.Pi.updateTargetData(o,E))});let u=Nn(),h=It();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&c.push(r.persistence.referenceDelegate.updateLimboDocument(o,f))}),c.push(n1(o,a,e.documentUpdates).next(f=>{u=f.ks,h=f.qs})),!n.isEqual(mt.min())){const f=r.Pi.getLastRemoteSnapshotVersion(o).next(p=>r.Pi.setTargetsMetadata(o,o.currentSequenceNumber,n));c.push(f)}return Re.waitFor(c).next(()=>a.apply(o)).next(()=>r.localDocuments.getLocalViewOfDocuments(o,u,h)).next(()=>u)}).then(o=>(r.Ms=i,o))}function n1(t,e,r){let n=It(),i=It();return r.forEach(o=>n=n.add(o)),e.getEntries(t,n).next(o=>{let a=Nn();return r.forEach((c,u)=>{const h=o.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(mt.min())?(e.removeEntry(c,u.readTime),a=a.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),a=a.insert(c,u)):We(Wc,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)}),{ks:a,qs:i}})}function i1(t,e){const r=ft(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Dc),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function o1(t,e){const r=ft(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Pi.getTargetData(n,e).next(o=>o?(i=o,Re.resolve(i)):r.Pi.allocateTargetId(n).next(a=>(i=new Qn(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function nc(t,e,r){const n=ft(t),i=n.Ms.get(e),o=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",o,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!fo(a))throw a;We(Wc,`Failed to update sequence numbers for target ${e}: ${a}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function Kd(t,e,r){const n=ft(t);let i=mt.min(),o=It();return n.persistence.runTransaction("Execute query","readwrite",a=>function(u,h,f){const p=ft(u),_=p.xs.get(f);return _!==void 0?Re.resolve(p.Ms.get(_)):p.Pi.getTargetData(h,f)}(n,a,ln(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(a,c.targetId).next(u=>{o=u})}).next(()=>n.Fs.getDocumentsMatchingQuery(a,e,r?i:mt.min(),r?o:It())).next(c=>(s1(n,H_(e),c),{documents:c,Qs:o})))}function s1(t,e,r){let n=t.Os.get(e)||mt.min();r.forEach((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)}),t.Os.set(e,n)}class Yd{constructor(){this.activeTargetIds=J_()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class a1{constructor(){this.Mo=new Yd,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Yd,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l1{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qd="ConnectivityMonitor";class Jd{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){We(Qd,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){We(Qd,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rs=null;function ic(){return Rs===null?Rs=function(){return 268435456+Math.round(2147483648*Math.random())}():Rs++,"0x"+Rs.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dl="RestConnection",c1={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class u1{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===pa?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,r,n,i,o){const a=ic(),c=this.zo(e,r.toUriEncodedString());We(dl,`Sending RPC '${e}' ${a}:`,c,n);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,o);const{host:h}=new URL(c),f=lo(h);return this.Jo(e,c,u,n,f).then(p=>(We(dl,`Received RPC '${e}' ${a}: `,p),p),p=>{throw to(dl,`RPC '${e}' ${a} failed with error: `,p,"url: ",c,"request:",n),p})}Ho(e,r,n,i,o,a){return this.Go(e,r,n,i,o)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ho}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>e[o]=i),n&&n.headers.forEach((i,o)=>e[o]=i)}zo(e,r){const n=c1[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d1{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ar="WebChannelConnection";class h1 extends u1{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,i,o){const a=ic();return new Promise((c,u)=>{const h=new uf;h.setWithCredentials(!0),h.listenOnce(df.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Ys.NO_ERROR:const p=h.getResponseJson();We(Ar,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(p)),c(p);break;case Ys.TIMEOUT:We(Ar,`RPC '${e}' ${a} timed out`),u(new ot(Ne.DEADLINE_EXCEEDED,"Request time out"));break;case Ys.HTTP_ERROR:const _=h.getStatus();if(We(Ar,`RPC '${e}' ${a} failed with status:`,_,"response text:",h.getResponseText()),_>0){let E=h.getResponseJson();Array.isArray(E)&&(E=E[0]);const A=E?.error;if(A&&A.status&&A.message){const T=function($){const O=$.toLowerCase().replace(/_/g,"-");return Object.values(Ne).indexOf(O)>=0?O:Ne.UNKNOWN}(A.status);u(new ot(T,A.message))}else u(new ot(Ne.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new ot(Ne.UNAVAILABLE,"Connection failed."));break;default:ct(9055,{l_:e,streamId:a,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{We(Ar,`RPC '${e}' ${a} completed.`)}});const f=JSON.stringify(i);We(Ar,`RPC '${e}' ${a} sending request:`,i),h.send(r,"POST",f,n,15)})}T_(e,r,n){const i=ic(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=ff(),c=mf(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,r,n),u.encodeInitMessageHeaders=!0;const f=o.join("");We(Ar,`Creating RPC '${e}' stream ${i}: ${f}`,u);const p=a.createWebChannel(f,u);this.I_(p);let _=!1,E=!1;const A=new d1({Yo:x=>{E?We(Ar,`Not sending because RPC '${e}' stream ${i} is closed:`,x):(_||(We(Ar,`Opening RPC '${e}' stream ${i} transport.`),p.open(),_=!0),We(Ar,`RPC '${e}' stream ${i} sending:`,x),p.send(x))},Zo:()=>p.close()}),T=(x,$,O)=>{x.listen($,q=>{try{O(q)}catch(z){setTimeout(()=>{throw z},0)}})};return T(p,To.EventType.OPEN,()=>{E||(We(Ar,`RPC '${e}' stream ${i} transport opened.`),A.o_())}),T(p,To.EventType.CLOSE,()=>{E||(E=!0,We(Ar,`RPC '${e}' stream ${i} transport closed`),A.a_(),this.E_(p))}),T(p,To.EventType.ERROR,x=>{E||(E=!0,to(Ar,`RPC '${e}' stream ${i} transport errored. Name:`,x.name,"Message:",x.message),A.a_(new ot(Ne.UNAVAILABLE,"The operation could not be completed")))}),T(p,To.EventType.MESSAGE,x=>{if(!E){const $=x.data[0];Ft(!!$,16349);const O=$,q=O?.error||O[0]?.error;if(q){We(Ar,`RPC '${e}' stream ${i} received error:`,q);const z=q.status;let ee=function(v){const S=or[v];if(S!==void 0)return Gf(S)}(z),Q=q.message;ee===void 0&&(ee=Ne.INTERNAL,Q="Unknown error status: "+z+" with message "+q.message),E=!0,A.a_(new ot(ee,Q)),p.close()}else We(Ar,`RPC '${e}' stream ${i} received:`,$),A.u_($)}}),T(c,hf.STAT_EVENT,x=>{x.stat===Wl.PROXY?We(Ar,`RPC '${e}' stream ${i} detected buffering proxy`):x.stat===Wl.NOPROXY&&We(Ar,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{A.__()},0),A}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function hl(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function za(t){return new gS(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay{constructor(e,r,n=1e3,i=1.5,o=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=i,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,r-n);i>0&&We("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xd="PersistentStream";class ly{constructor(e,r,n,i,o,a,c,u){this.Mi=e,this.S_=n,this.b_=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new ay(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===Ne.RESOURCE_EXHAUSTED?(Dn(r.toString()),Dn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===Ne.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.D_===r&&this.G_(n,i)},n=>{e(()=>{const i=new ot(Ne.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{n(()=>this.z_(i))}),this.stream.onMessage(i=>{n(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return We(Xd,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(We(Xd,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class m1 extends ly{constructor(e,r,n,i,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=o}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=bS(this.serializer,e),n=function(o){if(!("targetChange"in o))return mt.min();const a=o.targetChange;return a.targetIds&&a.targetIds.length?mt.min():a.readTime?cn(a.readTime):mt.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=rc(this.serializer),r.addTarget=function(o,a){let c;const u=a.target;if(c=Jl(u)?{documents:PS(o,u)}:{query:wS(o,u).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=Qf(o,a.resumeToken);const h=Zl(o,a.expectedCount);h!==null&&(c.expectedCount=h)}else if(a.snapshotVersion.compareTo(mt.min())>0){c.readTime=wa(o,a.snapshotVersion.toTimestamp());const h=Zl(o,a.expectedCount);h!==null&&(c.expectedCount=h)}return c}(this.serializer,e);const n=AS(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=rc(this.serializer),r.removeTarget=e,this.q_(r)}}class f1 extends ly{constructor(e,r,n,i,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Ft(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ft(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ft(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=SS(e.writeResults,e.commitTime),n=cn(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=rc(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>_S(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{}class g1 extends y1{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new ot(Ne.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Go(e,ec(r,n),i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ot(Ne.UNKNOWN,o.toString())})}Ho(e,r,n,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Ho(e,ec(r,n),i,a,c,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ot(Ne.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class p1{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Dn(r),this.aa=!1):We("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xi="RemoteStore";class v1{constructor(e,r,n,i,o){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo(a=>{n.enqueueAndForget(async()=>{Ni(this)&&(We(xi,"Restarting streams for network reachability change."),await async function(u){const h=ft(u);h.Ea.add(4),await ys(h),h.Ra.set("Unknown"),h.Ea.delete(4),await qa(h)}(this))})}),this.Ra=new p1(n,i)}}async function qa(t){if(Ni(t))for(const e of t.da)await e(!0)}async function ys(t){for(const e of t.da)await e(!1)}function cy(t,e){const r=ft(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),Qc(r)?Yc(r):yo(r).O_()&&Kc(r,e))}function Gc(t,e){const r=ft(t),n=yo(r);r.Ia.delete(e),n.O_()&&uy(r,e),r.Ia.size===0&&(n.O_()?n.L_():Ni(r)&&r.Ra.set("Unknown"))}function Kc(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(mt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}yo(t).Y_(e)}function uy(t,e){t.Va.Ue(e),yo(t).Z_(e)}function Yc(t){t.Va=new hS({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),yo(t).start(),t.Ra.ua()}function Qc(t){return Ni(t)&&!yo(t).x_()&&t.Ia.size>0}function Ni(t){return ft(t).Ea.size===0}function dy(t){t.Va=void 0}async function b1(t){t.Ra.set("Online")}async function _1(t){t.Ia.forEach((e,r)=>{Kc(t,e)})}async function S1(t,e){dy(t),Qc(t)?(t.Ra.ha(e),Yc(t)):t.Ra.set("Unknown")}async function P1(t,e,r){if(t.Ra.set("Online"),e instanceof Yf&&e.state===2&&e.cause)try{await async function(i,o){const a=o.cause;for(const c of o.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,a),i.Ia.delete(c),i.Va.removeTarget(c))}(t,e)}catch(n){We(xi,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Aa(t,n)}else if(e instanceof Zs?t.Va.Ze(e):e instanceof Kf?t.Va.st(e):t.Va.tt(e),!r.isEqual(mt.min()))try{const n=await sy(t.localStore);r.compareTo(n)>=0&&await function(o,a){const c=o.Va.Tt(a);return c.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const f=o.Ia.get(h);f&&o.Ia.set(h,f.withResumeToken(u.resumeToken,a))}}),c.targetMismatches.forEach((u,h)=>{const f=o.Ia.get(u);if(!f)return;o.Ia.set(u,f.withResumeToken(Sr.EMPTY_BYTE_STRING,f.snapshotVersion)),uy(o,u);const p=new Qn(f.target,u,h,f.sequenceNumber);Kc(o,p)}),o.remoteSyncer.applyRemoteEvent(c)}(t,r)}catch(n){We(xi,"Failed to raise snapshot:",n),await Aa(t,n)}}async function Aa(t,e,r){if(!fo(e))throw e;t.Ea.add(1),await ys(t),t.Ra.set("Offline"),r||(r=()=>sy(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{We(xi,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await qa(t)})}function hy(t,e){return e().catch(r=>Aa(t,r,e))}async function Ha(t){const e=ft(t),r=li(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Dc;for(;w1(e);)try{const i=await i1(e.localStore,n);if(i===null){e.Ta.length===0&&r.L_();break}n=i.batchId,C1(e,i)}catch(i){await Aa(e,i)}my(e)&&fy(e)}function w1(t){return Ni(t)&&t.Ta.length<10}function C1(t,e){t.Ta.push(e);const r=li(t);r.O_()&&r.X_&&r.ea(e.mutations)}function my(t){return Ni(t)&&!li(t).x_()&&t.Ta.length>0}function fy(t){li(t).start()}async function A1(t){li(t).ra()}async function I1(t){const e=li(t);for(const r of t.Ta)e.ea(r.mutations)}async function E1(t,e,r){const n=t.Ta.shift(),i=Fc.from(n,e,r);await hy(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Ha(t)}async function x1(t,e){e&&li(t).X_&&await async function(n,i){if(function(a){return cS(a)&&a!==Ne.ABORTED}(i.code)){const o=n.Ta.shift();li(n).B_(),await hy(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,i)),await Ha(n)}}(t,e),my(t)&&fy(t)}async function Zd(t,e){const r=ft(t);r.asyncQueue.verifyOperationInProgress(),We(xi,"RemoteStore received new credentials");const n=Ni(r);r.Ea.add(3),await ys(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await qa(r)}async function T1(t,e){const r=ft(t);e?(r.Ea.delete(2),await qa(r)):e||(r.Ea.add(2),await ys(r),r.Ra.set("Unknown"))}function yo(t){return t.ma||(t.ma=function(r,n,i){const o=ft(r);return o.sa(),new m1(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Xo:b1.bind(null,t),t_:_1.bind(null,t),r_:S1.bind(null,t),H_:P1.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Qc(t)?Yc(t):t.Ra.set("Unknown")):(await t.ma.stop(),dy(t))})),t.ma}function li(t){return t.fa||(t.fa=function(r,n,i){const o=ft(r);return o.sa(),new f1(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:A1.bind(null,t),r_:x1.bind(null,t),ta:I1.bind(null,t),na:E1.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Ha(t)):(await t.fa.stop(),t.Ta.length>0&&(We(xi,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(e,r,n,i,o){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new ni,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,o){const a=Date.now()+n,c=new Jc(e,r,a,i,o);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ot(Ne.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Xc(t,e){if(Dn("AsyncQueue",`${e}: ${t}`),fo(t))return new ot(Ne.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{static emptySet(e){return new Xi(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||lt.comparator(r.key,n.key):(r,n)=>lt.comparator(r.key,n.key),this.keyedMap=$o(),this.sortedSet=new Xt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Xi)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Xi;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eh{constructor(){this.ga=new Xt(lt.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):ct(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class so{constructor(e,r,n,i,o,a,c,u,h){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,r,n,i,o){const a=[];return r.forEach(c=>{a.push({type:0,doc:c})}),new so(e,r,Xi.emptySet(r),a,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Va(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $1{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class k1{constructor(){this.queries=th(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const i=ft(r),o=i.queries;i.queries=th(),o.forEach((a,c)=>{for(const u of c.Sa)u.onError(n)})})(this,new ot(Ne.ABORTED,"Firestore shutting down"))}}function th(){return new Ri(t=>Nf(t),Va)}async function R1(t,e){const r=ft(t);let n=3;const i=e.query;let o=r.queries.get(i);o?!o.ba()&&e.Da()&&(n=2):(o=new $1,n=e.Da()?0:1);try{switch(n){case 0:o.wa=await r.onListen(i,!0);break;case 1:o.wa=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const c=Xc(a,`Initialization of query '${Hi(e.query)}' failed`);return void e.onError(c)}r.queries.set(i,o),o.Sa.push(e),e.va(r.onlineState),o.wa&&e.Fa(o.wa)&&Zc(r)}async function D1(t,e){const r=ft(t),n=e.query;let i=3;const o=r.queries.get(n);if(o){const a=o.Sa.indexOf(e);a>=0&&(o.Sa.splice(a,1),o.Sa.length===0?i=e.Da()?0:1:!o.ba()&&e.Da()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function N1(t,e){const r=ft(t);let n=!1;for(const i of e){const o=i.query,a=r.queries.get(o);if(a){for(const c of a.Sa)c.Fa(i)&&(n=!0);a.wa=i}}n&&Zc(r)}function L1(t,e,r){const n=ft(t),i=n.queries.get(e);if(i)for(const o of i.Sa)o.onError(r);n.queries.delete(e)}function Zc(t){t.Ca.forEach(e=>{e.next()})}var oc,rh;(rh=oc||(oc={})).Ma="default",rh.Cache="cache";class M1{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new so(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=so.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==oc.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yy{constructor(e){this.key=e}}class gy{constructor(e){this.key=e}}class O1{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=It(),this.mutatedKeys=It(),this.eu=Lf(e),this.tu=new Xi(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new eh,i=r?r.tu:this.tu;let o=r?r.mutatedKeys:this.mutatedKeys,a=i,c=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,p)=>{const _=i.get(f),E=Ba(this.query,p)?p:null,A=!!_&&this.mutatedKeys.has(_.key),T=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let x=!1;_&&E?_.data.isEqual(E.data)?A!==T&&(n.track({type:3,doc:E}),x=!0):this.su(_,E)||(n.track({type:2,doc:E}),x=!0,(u&&this.eu(E,u)>0||h&&this.eu(E,h)<0)&&(c=!0)):!_&&E?(n.track({type:0,doc:E}),x=!0):_&&!E&&(n.track({type:1,doc:_}),x=!0,(u||h)&&(c=!0)),x&&(E?(a=a.add(E),o=T?o.add(f):o.delete(f)):(a=a.delete(f),o=o.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),o=o.delete(f.key),n.track({type:1,doc:f})}return{tu:a,iu:n,Cs:c,mutatedKeys:o}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((f,p)=>function(E,A){const T=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ct(20277,{Rt:x})}};return T(E)-T(A)}(f.type,p.type)||this.eu(f.doc,p.doc)),this.ou(n),i=i??!1;const c=r&&!i?this._u():[],u=this.Xa.size===0&&this.current&&!i?1:0,h=u!==this.Za;return this.Za=u,a.length!==0||h?{snapshot:new so(this.query,e.tu,o,a,e.mutatedKeys,u===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new eh,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=It(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new gy(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new yy(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=It();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return so.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const eu="SyncEngine";class V1{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class B1{constructor(e){this.key=e,this.hu=!1}}class F1{constructor(e,r,n,i,o,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Ri(c=>Nf(c),Va),this.Iu=new Map,this.Eu=new Set,this.du=new Xt(lt.comparator),this.Au=new Map,this.Ru=new zc,this.Vu={},this.mu=new Map,this.fu=oo.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function U1(t,e,r=!0){const n=Py(t);let i;const o=n.Tu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await py(n,e,r,!0),i}async function j1(t,e){const r=Py(t);await py(r,e,!0,!1)}async function py(t,e,r,n){const i=await o1(t.localStore,ln(e)),o=i.targetId,a=t.sharedClientState.addLocalQueryTarget(o,r);let c;return n&&(c=await z1(t,e,o,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&cy(t.remoteStore,i),c}async function z1(t,e,r,n,i){t.pu=(p,_,E)=>async function(T,x,$,O){let q=x.view.ru($);q.Cs&&(q=await Kd(T.localStore,x.query,!1).then(({documents:C})=>x.view.ru(C,q)));const z=O&&O.targetChanges.get(x.targetId),ee=O&&O.targetMismatches.get(x.targetId)!=null,Q=x.view.applyChanges(q,T.isPrimaryClient,z,ee);return ih(T,x.targetId,Q.au),Q.snapshot}(t,p,_,E);const o=await Kd(t.localStore,e,!0),a=new O1(e,o.Qs),c=a.ru(o.documents),u=fs.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),h=a.applyChanges(c,t.isPrimaryClient,u);ih(t,r,h.au);const f=new V1(e,r,a);return t.Tu.set(e,f),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),h.snapshot}async function q1(t,e,r){const n=ft(t),i=n.Tu.get(e),o=n.Iu.get(i.targetId);if(o.length>1)return n.Iu.set(i.targetId,o.filter(a=>!Va(a,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await nc(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Gc(n.remoteStore,i.targetId),sc(n,i.targetId)}).catch(mo)):(sc(n,i.targetId),await nc(n.localStore,i.targetId,!0))}async function H1(t,e){const r=ft(t),n=r.Tu.get(e),i=r.Iu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Gc(r.remoteStore,n.targetId))}async function W1(t,e,r){const n=Z1(t);try{const i=await function(a,c){const u=ft(a),h=Kt.now(),f=c.reduce((E,A)=>E.add(A.key),It());let p,_;return u.persistence.runTransaction("Locally write mutations","readwrite",E=>{let A=Nn(),T=It();return u.Ns.getEntries(E,f).next(x=>{A=x,A.forEach(($,O)=>{O.isValidDocument()||(T=T.add($))})}).next(()=>u.localDocuments.getOverlayedDocuments(E,A)).next(x=>{p=x;const $=[];for(const O of c){const q=iS(O,p.get(O.key).overlayedDocument);q!=null&&$.push(new Di(O.key,q,Ef(q.value.mapValue),$n.exists(!0)))}return u.mutationQueue.addMutationBatch(E,h,$,c)}).next(x=>{_=x;const $=x.applyToLocalDocumentSet(p,T);return u.documentOverlayCache.saveOverlays(E,x.batchId,$)})}).then(()=>({batchId:_.batchId,changes:Of(p)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,c,u){let h=a.Vu[a.currentUser.toKey()];h||(h=new Xt(At)),h=h.insert(c,u),a.Vu[a.currentUser.toKey()]=h}(n,i.batchId,r),await gs(n,i.changes),await Ha(n.remoteStore)}catch(i){const o=Xc(i,"Failed to persist write");r.reject(o)}}async function vy(t,e){const r=ft(t);try{const n=await r1(r.localStore,e);e.targetChanges.forEach((i,o)=>{const a=r.Au.get(o);a&&(Ft(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?Ft(a.hu,14607):i.removedDocuments.size>0&&(Ft(a.hu,42227),a.hu=!1))}),await gs(r,n,e)}catch(n){await mo(n)}}function nh(t,e,r){const n=ft(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Tu.forEach((o,a)=>{const c=a.view.va(e);c.snapshot&&i.push(c.snapshot)}),function(a,c){const u=ft(a);u.onlineState=c;let h=!1;u.queries.forEach((f,p)=>{for(const _ of p.Sa)_.va(c)&&(h=!0)}),h&&Zc(u)}(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function G1(t,e,r){const n=ft(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Au.get(e),o=i&&i.key;if(o){let a=new Xt(lt.comparator);a=a.insert(o,xr.newNoDocument(o,mt.min()));const c=It().add(o),u=new ja(mt.min(),new Map,new Xt(At),a,c);await vy(n,u),n.du=n.du.remove(o),n.Au.delete(e),tu(n)}else await nc(n.localStore,e,!1).then(()=>sc(n,e,r)).catch(mo)}async function K1(t,e){const r=ft(t),n=e.batch.batchId;try{const i=await t1(r.localStore,e);_y(r,n,null),by(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await gs(r,i)}catch(i){await mo(i)}}async function Y1(t,e,r){const n=ft(t);try{const i=await function(a,c){const u=ft(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let f;return u.mutationQueue.lookupMutationBatch(h,c).next(p=>(Ft(p!==null,37113),f=p.keys(),u.mutationQueue.removeMutationBatch(h,p))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,f,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f)).next(()=>u.localDocuments.getDocuments(h,f))})}(n.localStore,e);_y(n,e,r),by(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await gs(n,i)}catch(i){await mo(i)}}function by(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function _y(t,e,r){const n=ft(t);let i=n.Vu[n.currentUser.toKey()];if(i){const o=i.get(e);o&&(r?o.reject(r):o.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function sc(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||Sy(t,n)})}function Sy(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(Gc(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),tu(t))}function ih(t,e,r){for(const n of r)n instanceof yy?(t.Ru.addReference(n.key,e),Q1(t,n)):n instanceof gy?(We(eu,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||Sy(t,n.key)):ct(19791,{wu:n})}function Q1(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(We(eu,"New document in limbo: "+r),t.Eu.add(n),tu(t))}function tu(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new lt(Jt.fromString(e)),n=t.fu.next();t.Au.set(n,new B1(r)),t.du=t.du.insert(r,n),cy(t.remoteStore,new Qn(ln(Vc(r.path)),n,"TargetPurposeLimboResolution",Na.ce))}}async function gs(t,e,r){const n=ft(t),i=[],o=[],a=[];n.Tu.isEmpty()||(n.Tu.forEach((c,u)=>{a.push(n.pu(u,e,r).then(h=>{if((h||r)&&n.isPrimaryClient){const f=h?!h.fromCache:r?.targetChanges.get(u.targetId)?.current;n.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(h){i.push(h);const f=Hc.As(u.targetId,h);o.push(f)}}))}),await Promise.all(a),n.Pu.H_(i),await async function(u,h){const f=ft(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>Re.forEach(h,_=>Re.forEach(_.Es,E=>f.persistence.referenceDelegate.addReference(p,_.targetId,E)).next(()=>Re.forEach(_.ds,E=>f.persistence.referenceDelegate.removeReference(p,_.targetId,E)))))}catch(p){if(!fo(p))throw p;We(Wc,"Failed to update sequence numbers: "+p)}for(const p of h){const _=p.targetId;if(!p.fromCache){const E=f.Ms.get(_),A=E.snapshotVersion,T=E.withLastLimboFreeSnapshotVersion(A);f.Ms=f.Ms.insert(_,T)}}}(n.localStore,o))}async function J1(t,e){const r=ft(t);if(!r.currentUser.isEqual(e)){We(eu,"User change. New user:",e.toKey());const n=await oy(r.localStore,e);r.currentUser=e,function(o,a){o.mu.forEach(c=>{c.forEach(u=>{u.reject(new ot(Ne.CANCELLED,a))})}),o.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await gs(r,n.Ls)}}function X1(t,e){const r=ft(t),n=r.Au.get(e);if(n&&n.hu)return It().add(n.key);{let i=It();const o=r.Iu.get(e);if(!o)return i;for(const a of o){const c=r.Tu.get(a);i=i.unionWith(c.view.nu)}return i}}function Py(t){const e=ft(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=vy.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=X1.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=G1.bind(null,e),e.Pu.H_=N1.bind(null,e.eventManager),e.Pu.yu=L1.bind(null,e.eventManager),e}function Z1(t){const e=ft(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=K1.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Y1.bind(null,e),e}class Ia{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=za(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return e1(this.persistence,new JS,e.initialUser,this.serializer)}Cu(e){return new iy(qc.mi,this.serializer)}Du(e){return new a1}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ia.provider={build:()=>new Ia};class eP extends Ia{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Ft(this.persistence.referenceDelegate instanceof Ca,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new MS(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?Dr.withCacheSize(this.cacheSizeBytes):Dr.DEFAULT;return new iy(n=>Ca.mi(n,r),this.serializer)}}class ac{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>nh(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=J1.bind(null,this.syncEngine),await T1(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new k1}()}createDatastore(e){const r=za(e.databaseInfo.databaseId),n=function(o){return new h1(o)}(e.databaseInfo);return function(o,a,c,u){return new g1(o,a,c,u)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,o,a,c){return new v1(n,i,o,a,c)}(this.localStore,this.datastore,e.asyncQueue,r=>nh(this.syncEngine,r,0),function(){return Jd.v()?new Jd:new l1}())}createSyncEngine(e,r){return function(i,o,a,c,u,h,f){const p=new F1(i,o,a,c,u,h);return f&&(p.gu=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await async function(r){const n=ft(r);We(xi,"RemoteStore shutting down."),n.Ea.add(5),await ys(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}ac.provider={build:()=>new ac};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Dn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ci="FirestoreClient";class rP{constructor(e,r,n,i,o){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Er.UNAUTHENTICATED,this.clientId=kc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,async a=>{We(ci,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(We(ci,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ni;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Xc(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function ml(t,e){t.asyncQueue.verifyOperationInProgress(),We(ci,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await oy(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function oh(t,e){t.asyncQueue.verifyOperationInProgress();const r=await nP(t);We(ci,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>Zd(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>Zd(e.remoteStore,i)),t._onlineComponents=e}async function nP(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){We(ci,"Using user provided OfflineComponentProvider");try{await ml(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===Ne.FAILED_PRECONDITION||i.code===Ne.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;to("Error using user provided cache. Falling back to memory cache: "+r),await ml(t,new Ia)}}else We(ci,"Using default OfflineComponentProvider"),await ml(t,new eP(void 0));return t._offlineComponents}async function wy(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(We(ci,"Using user provided OnlineComponentProvider"),await oh(t,t._uninitializedComponentsProvider._online)):(We(ci,"Using default OnlineComponentProvider"),await oh(t,new ac))),t._onlineComponents}function iP(t){return wy(t).then(e=>e.syncEngine)}async function oP(t){const e=await wy(t),r=e.eventManager;return r.onListen=U1.bind(null,e.syncEngine),r.onUnlisten=q1.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=j1.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=H1.bind(null,e.syncEngine),r}function sP(t,e,r={}){const n=new ni;return t.asyncQueue.enqueueAndForget(async()=>function(o,a,c,u,h){const f=new tP({next:_=>{f.Nu(),a.enqueueAndForget(()=>D1(o,p));const E=_.docs.has(c);!E&&_.fromCache?h.reject(new ot(Ne.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&_.fromCache&&u&&u.source==="server"?h.reject(new ot(Ne.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(_)},error:_=>h.reject(_)}),p=new M1(Vc(c.path),f,{includeMetadataChanges:!0,qa:!0});return R1(o,p)}(await oP(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cy(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sh=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ay="firestore.googleapis.com",ah=!0;class lh{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ot(Ne.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Ay,this.ssl=ah}else this.host=e.host,this.ssl=e.ssl??ah;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=ny;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<NS)throw new ot(Ne.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}p_("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Cy(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new ot(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new ot(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new ot(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ru{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new lh({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ot(Ne.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ot(Ne.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new lh(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new s_;switch(n.type){case"firstParty":return new u_(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new ot(Ne.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=sh.get(r);n&&(We("ComponentProvider","Removing Datastore"),sh.delete(r),n.terminate())}(this),Promise.resolve()}}function aP(t,e,r,n={}){t=Jo(t,ru);const i=lo(e),o=t._getSettings(),a={...o,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${r}`;i&&(_m(`https://${c}`),Sm("Firestore",!0)),o.host!==Ay&&o.host!==c&&to("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...o,host:c,ssl:i,emulatorOptions:n};if(!Ci(u,a)&&(t._setSettings(u),n.mockUserToken)){let h,f;if(typeof n.mockUserToken=="string")h=n.mockUserToken,f=Er.MOCK_USER;else{h=$p(n.mockUserToken,t._app?.options.projectId);const p=n.mockUserToken.sub||n.mockUserToken.user_id;if(!p)throw new ot(Ne.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Er(p)}t._authCredentials=new a_(new gf(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nu{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new nu(this.firestore,e,this._query)}}class fr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new is(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new fr(this.firestore,e,this._key)}toJSON(){return{type:fr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(hs(r,fr._jsonSchema))return new fr(e,n||null,new lt(Jt.fromString(r.referencePath)))}}fr._jsonSchemaVersion="firestore/documentReference/1.0",fr._jsonSchema={type:ar("string",fr._jsonSchemaVersion),referencePath:ar("string")};class is extends nu{constructor(e,r,n){super(e,r,Vc(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new fr(this.firestore,null,new lt(e))}withConverter(e){return new is(this.firestore,e,this._path)}}function lP(t,e,...r){if(t=Hr(t),arguments.length===1&&(e=kc.newId()),g_("doc","path",e),t instanceof ru){const n=Jt.fromString(e,...r);return Pd(n),new fr(t,null,new lt(n))}{if(!(t instanceof fr||t instanceof is))throw new ot(Ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Jt.fromString(e,...r));return Pd(n),new fr(t.firestore,t instanceof is?t.converter:null,new lt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ch="AsyncQueue";class uh{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new ay(this,"async_queue_retry"),this._c=()=>{const n=hl();n&&We(ch,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=hl();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=hl();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new ni;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!fo(e))throw e;We(ch,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,Dn("INTERNAL UNHANDLED ERROR: ",dh(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const i=Jc.createAndSchedule(this,e,r,n,o=>this.hc(o));return this.tc.push(i),i}uc(){this.nc&&ct(47125,{Pc:dh(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function dh(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class iu extends ru{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new uh,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new uh(e),this._firestoreClient=void 0,await e}}}function cP(t,e){const r=typeof t=="object"?t:Am(),n=typeof t=="string"?t:pa,i=bc(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const o=xp("firestore");o&&aP(i,...o)}return i}function Iy(t){if(t._terminated)throw new ot(Ne.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||uP(t),t._firestoreClient}function uP(t){const e=t._freezeSettings(),r=function(i,o,a,c){return new x_(i,o,a,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,Cy(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)}(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new rP(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(i){const o=i?._online.build();return{_offline:i?._offline.build(o),_online:o}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new jr(Sr.fromBase64String(e))}catch(r){throw new ot(Ne.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new jr(Sr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:jr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(hs(e,jr._jsonSchema))return jr.fromBase64String(e.bytes)}}jr._jsonSchemaVersion="firestore/bytes/1.0",jr._jsonSchema={type:ar("string",jr._jsonSchemaVersion),bytes:ar("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new ot(Ne.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new br(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ey{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new ot(Ne.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new ot(Ne.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return At(this._lat,e._lat)||At(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:un._jsonSchemaVersion}}static fromJSON(e){if(hs(e,un._jsonSchema))return new un(e.latitude,e.longitude)}}un._jsonSchemaVersion="firestore/geoPoint/1.0",un._jsonSchema={type:ar("string",un._jsonSchemaVersion),latitude:ar("number"),longitude:ar("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==i[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:dn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(hs(e,dn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new dn(e.vectorValues);throw new ot(Ne.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}dn._jsonSchemaVersion="firestore/vectorValue/1.0",dn._jsonSchema={type:ar("string",dn._jsonSchemaVersion),vectorValues:ar("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dP=/^__.*__$/;class hP{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Di(e,this.data,this.fieldMask,r,this.fieldTransforms):new ms(e,this.data,r,this.fieldTransforms)}}function xy(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ct(40011,{Ac:t})}}class su{constructor(e,r,n,i,o,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new su({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Ea(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(xy(this.Ac)&&dP.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class mP{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||za(e)}Cc(e,r,n,i=!1){return new su({Ac:e,methodName:r,Dc:n,path:br.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function fP(t){const e=t._freezeSettings(),r=za(t._databaseId);return new mP(t._databaseId,!!e.ignoreUndefinedProperties,r)}function yP(t,e,r,n,i,o={}){const a=t.Cc(o.merge||o.mergeFields?2:0,e,r,i);Ry("Data must be an object, but it was:",a,n);const c=$y(n,a);let u,h;if(o.merge)u=new Yr(a.fieldMask),h=a.fieldTransforms;else if(o.mergeFields){const f=[];for(const p of o.mergeFields){const _=gP(e,p,r);if(!a.contains(_))throw new ot(Ne.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);vP(f,_)||f.push(_)}u=new Yr(f),h=a.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,h=a.fieldTransforms;return new hP(new Ur(c),u,h)}function Ty(t,e){if(ky(t=Hr(t)))return Ry("Unsupported field value:",e,t),$y(t,e);if(t instanceof Ey)return function(n,i){if(!xy(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,i){const o=[];let a=0;for(const c of n){let u=Ty(c,i.wc(a));u==null&&(u={nullValue:"NULL_VALUE"}),o.push(u),a++}return{arrayValue:{values:o}}}(t,e)}return function(n,i){if((n=Hr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return X_(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=Kt.fromDate(n);return{timestampValue:wa(i.serializer,o)}}if(n instanceof Kt){const o=new Kt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:wa(i.serializer,o)}}if(n instanceof un)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof jr)return{bytesValue:Qf(i.serializer,n._byteString)};if(n instanceof fr){const o=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(o))throw i.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:jc(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof dn)return function(a,c){return{mapValue:{fields:{[Af]:{stringValue:If},[va]:{arrayValue:{values:a.toArray().map(h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return Bc(c.serializer,h)})}}}}}}(n,i);throw i.Sc(`Unsupported field value: ${Rc(n)}`)}(t,e)}function $y(t,e){const r={};return bf(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ki(t,(n,i)=>{const o=Ty(i,e.mc(n));o!=null&&(r[n]=o)}),{mapValue:{fields:r}}}function ky(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Kt||t instanceof un||t instanceof jr||t instanceof fr||t instanceof Ey||t instanceof dn)}function Ry(t,e,r){if(!ky(r)||!pf(r)){const n=Rc(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function gP(t,e,r){if((e=Hr(e))instanceof ou)return e._internalPath;if(typeof e=="string")return Dy(t,e);throw Ea("Field path arguments must be of type string or ",t,!1,void 0,r)}const pP=new RegExp("[~\\*/\\[\\]]");function Dy(t,e,r){if(e.search(pP)>=0)throw Ea(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new ou(...e.split("."))._internalPath}catch{throw Ea(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Ea(t,e,r,n,i){const o=n&&!n.isEmpty(),a=i!==void 0;let c=`Function ${e}() called with invalid data`;r&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(o||a)&&(u+=" (found",o&&(u+=` in field ${n}`),a&&(u+=` in document ${i}`),u+=")"),new ot(Ne.INVALID_ARGUMENT,c+t+u)}function vP(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{constructor(e,r,n,i,o){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new fr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new bP(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Ly("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class bP extends Ny{data(){return super.data()}}function Ly(t,e){return typeof e=="string"?Dy(t,e):e instanceof ou?e._internalPath:e._delegate._internalPath}class _P{convertValue(e,r="none"){switch(ai(e)){case 0:return null;case 1:return e.booleanValue;case 2:return tr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(si(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw ct(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return ki(e,(i,o)=>{n[i]=this.convertValue(o,r)}),n}convertVectorValue(e){const r=e.fields?.[va].arrayValue?.values?.map(n=>tr(n.doubleValue));return new dn(r)}convertGeoPoint(e){return new un(tr(e.latitude),tr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Ma(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Zo(e));default:return null}}convertTimestamp(e){const r=oi(e);return new Kt(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Jt.fromString(e);Ft(ry(n),9688,{name:e});const i=new es(n.get(1),n.get(3)),o=new lt(n.popFirst(5));return i.isEqual(r)||Dn(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SP(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class Ro{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class wi extends Ny{constructor(e,r,n,i,o,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new ea(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Ly("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ot(Ne.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=wi._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}wi._jsonSchemaVersion="firestore/documentSnapshot/1.0",wi._jsonSchema={type:ar("string",wi._jsonSchemaVersion),bundleSource:ar("string","DocumentSnapshot"),bundleName:ar("string"),bundle:ar("string")};class ea extends wi{data(e={}){return super.data(e)}}class jo{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new Ro(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new ea(this._firestore,this._userDataWriter,n.key,n,new Ro(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new ot(Ne.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(c=>{const u=new ea(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Ro(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>o||c.type!==3).map(c=>{const u=new ea(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Ro(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,f=-1;return c.type!==0&&(h=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),f=a.indexOf(c.doc.key)),{type:PP(c.type),doc:u,oldIndex:h,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ot(Ne.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=jo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=kc.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(r.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function PP(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ct(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wP(t){t=Jo(t,fr);const e=Jo(t.firestore,iu);return sP(Iy(e),t._key).then(r=>EP(e,t,r))}jo._jsonSchemaVersion="firestore/querySnapshot/1.0",jo._jsonSchema={type:ar("string",jo._jsonSchemaVersion),bundleSource:ar("string","QuerySnapshot"),bundleName:ar("string"),bundle:ar("string")};class CP extends _P{constructor(e){super(),this.firestore=e}convertBytes(e){return new jr(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new fr(this.firestore,null,r)}}function AP(t,e,r){t=Jo(t,fr);const n=Jo(t.firestore,iu),i=SP(t.converter,e);return IP(n,[yP(fP(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,$n.none())])}function IP(t,e){return function(n,i){const o=new ni;return n.asyncQueue.enqueueAndForget(async()=>W1(await iP(n),i,o)),o.promise}(Iy(t),e)}function EP(t,e,r){const n=r.docs.get(e._key),i=new CP(t);return new wi(t,i,e._key,n,new Ro(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){ho=i})(co),Zi(new Ai("firestore",(n,{instanceIdentifier:i,options:o})=>{const a=n.getProvider("app").getImmediate(),c=new iu(new l_(n.getProvider("auth-internal")),new d_(a,n.getProvider("app-check-internal")),function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new ot(Ne.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new es(h.options.projectId,f)}(a,i),a);return o={useFetchStreams:r,...o},c._setSettings(o),c},"PUBLIC").setMultipleInstances(!0)),ei(vd,bd,e),ei(vd,bd,"esm2020")})();const xP={apiKey:"AIzaSyBAlcvZTL1tlCNKDLD4BiMbaGMbNxBF4-M",authDomain:"hrm-1128.firebaseapp.com",databaseURL:"https://hrm-1128.firebaseio.com",projectId:"hrm-1128",storageBucket:"hrm-1128.appspot.com",messagingSenderId:"1049250585245",appId:"1:1049250585245:web:0dad00202723514ccc5274"},My=Cm(xP),Wn=r_(My),zo=new sn,TP=cP(My);zo.addScope("profile");zo.addScope("email");class Do extends Error{}Do.prototype.name="InvalidTokenError";function $P(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function kP(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return $P(e)}catch{return atob(e)}}function RP(t,e){if(typeof t!="string")throw new Do("Invalid token specified: must be a string");e||(e={});const r=e.header===!0?0:1,n=t.split(".")[r];if(typeof n!="string")throw new Do(`Invalid token specified: missing part #${r+1}`);let i;try{i=kP(n)}catch(o){throw new Do(`Invalid token specified: invalid base64 for part #${r+1} (${o.message})`)}try{return JSON.parse(i)}catch(o){throw new Do(`Invalid token specified: invalid json for part #${r+1} (${o.message})`)}}const DP={clientId:"195275085181-8ccjpgp8v1g80qhnlk6v4lpgid7n81gr.apps.googleusercontent.com"},NP=t=>{const e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.onload=()=>{window.google&&window.google.accounts.id.initialize({client_id:DP.clientId,callback:r=>{t(r.credential)},auto_select:!1,cancel_on_tap_outside:!0})},document.head.appendChild(e)},LP=t=>RP(t),MP=()=>{window.google&&window.google.accounts.id.disableAutoSelect()},[OP,VP]=mm({}),BP=async()=>{let t={query:"qcm42351987"};const e=await Jn(t);if(console.log(t),console.log(e),e&&!e.error){let n=Object.assign({},{},e);VP(n)}return 1},FP=async t=>{let e=OP?.[992002];if(e){e.params={tkn:t};const r=await Jn(e);console.log(r)}},[Fi,Ir]=mm({user:null,loading:!0,error:null,authMethod:null}),[Oy,hh]=fe(null);zb(Wn,t=>{t?Ir({user:t,loading:!1,error:null,authMethod:"firebase"}):Oy()||Ir({user:null,loading:!1,error:null,authMethod:null})});v0(Wn).then(t=>{t&&Ir({user:t.user,loading:!1,error:null,authMethod:"firebase"})}).catch(t=>{console.error("Redirect sign-in error:",t),Ir({loading:!1,error:t.message})});const sr={get state(){return Fi},async getUserProfile(t){try{const e=lP(TP,"users",t),r=await wP(e);if(r.exists())return console.log("User profile data:",r.data()),Ir("profile",r.data()),r.data();{let n=sr?.state?.user;return await AP(e,{uid:n?.uid,email:n?.email,displayName:n?.displayName,createdAt:new Date}),console.log("No such user profile!"),null}}catch(e){return console.error("Error fetching user profile:",e),null}},async signInWithGoogle(){try{Ir("loading",!0),Ir("error",null);try{const t=await u0(Wn,zo);Ir({user:t.user,loading:!1,error:null,authMethod:"firebase"}),console.log(t.user),console.log(Wn,zo);try{sr.getUserProfile(t.user.uid)}catch(e){console.error("firestore error:",e)}}catch(t){if(t.code==="auth/popup-blocked")await g0(Wn,zo);else throw t}}catch(t){console.error("Sign-in error:",t),Ir({loading:!1,error:t.message||"Failed to sign in with Google"})}},async signInWithGoogleP(t){console.log(t);const r=await Jn({params:{id_token:t},query:"getGoogleUserbyToken"});if(r&&r){let n=new Date().getTime(),i=new Date(n+6e4*60*24*365),o="hrm_tkn_acc";document.cookie=`${o}=${r.data}; expires=${i}; path=/;g_state = {"i_l":1,"i_p":${i}}; ssgl_access_tkn = ${t}`,document.cookie=`ssgl_access_tkn = ${t}; expires=${i};`,await BP(),FP(r.data)}},async signInWithGoogleCloud(t){try{Ir("loading",!0),Ir("error",null);const e=LP(t),r={uid:e.sub,email:e.email,displayName:e.name,photoURL:e.picture};hh(r);const n={uid:r.uid,email:r.email,displayName:r.displayName,photoURL:r.photoURL,emailVerified:!0};Ir({user:n,loading:!1,error:null,authMethod:"google-cloud"});try{const i=sn.credential(t);await Fb(Wn,i)}catch{console.log("Firebase sign-in optional, continuing with Google Cloud auth")}}catch(e){console.error("Google Cloud sign-in error:",e),Ir({loading:!1,error:e.message||"Failed to sign in with Google Cloud"})}},async signOut(){try{Ir("loading",!0),(Fi.authMethod==="firebase"||Wn.currentUser)&&await qb(Wn),Fi.authMethod==="google-cloud"&&(MP(),hh(null)),Ir({user:null,loading:!1,error:null,authMethod:null})}catch(t){console.error("Sign-out error:",t),Ir({loading:!1,error:t.message||"Failed to sign out"})}},get isAuthenticated(){return!!Fi.user||!!Oy()},get currentUser(){return Fi.user},get authMethod(){return Fi.authMethod}};var UP=U("<p>"),jP=U('<div><div><div><h1>HRM Finance</h1><p>Complete Business Management Solution</p><div><div><button><svg width=24 height=24 viewBox="0 0 24 24"><path fill=#4285F4 d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"></path><path fill=#34A853 d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"></path><path fill=#FBBC05 d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"></path><path fill=#EA4335 d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"></path></svg></button><p>Firebase Authentication</p></div></div></div><div><div><div>💰</div><h3>Financial Management</h3><p>Complete chart of accounts, balance sheets, journal entries, and invoice management in one place.</p></div><div><div>👥</div><h3>HR Management</h3><p>Track employees, manage onboarding, and monitor your workforce with powerful analytics.</p></div><div><div>📦</div><h3>Inventory Control</h3><p>Real-time inventory tracking, product management, and movement history across multiple locations.</p></div><div><div>🏦</div><h3>Banking Integration</h3><p>Streamline bank reconciliation with CSV imports and automated consolidation features.</p></div><div><div>📊</div><h3>Real-time Analytics</h3><p>Get instant insights with dashboards showing revenue, cash flow, and business performance.</p></div><div><div>🌐</div><h3>Multi-language Support</h3><p>Available in multiple languages to support your global business operations.</p></div></div><div><p>Secure authentication powered by Google • Your data is encrypted and protected</p><p>Choose your preferred authentication method above');const zP=()=>{yn(()=>{NP(x=>{sr.signInWithGoogleP(x)}),setTimeout(()=>{},100)});const t={"min-height":"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},e={background:"white","border-radius":"1rem","box-shadow":"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","max-width":"1200px",width:"100%",overflow:"hidden"},r={padding:"3rem","text-align":"center","border-bottom":"1px solid #e2e8f0"},n={"font-size":"2.5rem","font-weight":"800",color:"#1a202c","margin-bottom":"1rem"},i={"font-size":"1.125rem",color:"#718096","margin-bottom":"2rem"},o={display:"flex","flex-direction":"column",gap:"1rem","align-items":"center","margin-bottom":"1rem"},a={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"2rem",padding:"3rem"},c={"text-align":"center",padding:"2rem","border-radius":"0.5rem",background:"#f7fafc",transition:"transform 0.2s",cursor:"default"},u={"font-size":"3rem","margin-bottom":"1rem"},h={"font-size":"1.25rem","font-weight":"600",color:"#2d3748","margin-bottom":"0.5rem"},f={color:"#718096","line-height":"1.6"},p={display:"inline-flex","align-items":"center",gap:"0.75rem",background:"white",color:"#4285f4",border:"2px solid #4285f4",padding:"0.75rem 2rem","font-size":"1.125rem","font-weight":"500","border-radius":"0.5rem",cursor:"pointer",transition:"all 0.2s","min-width":"250px","justify-content":"center"},_={color:"#e53e3e","margin-top":"1rem","font-size":"0.875rem"},E={background:"#f7fafc",padding:"2rem","text-align":"center",color:"#718096","font-size":"0.875rem"},A={"font-size":"0.75rem",color:"#718096","margin-top":"0.25rem","font-style":"italic"},T=()=>{sr.signInWithGoogle()};return(()=>{var x=jP(),$=x.firstChild,O=$.firstChild,q=O.firstChild,z=q.nextSibling,ee=z.nextSibling,Q=ee.firstChild,C=Q.firstChild;C.firstChild;var v=C.nextSibling,S=O.nextSibling,w=S.firstChild,P=w.firstChild,I=P.nextSibling,y=I.nextSibling,le=w.nextSibling,B=le.firstChild,k=B.nextSibling,W=k.nextSibling,R=le.nextSibling,V=R.firstChild,M=V.nextSibling,F=M.nextSibling,ne=R.nextSibling,L=ne.firstChild,j=L.nextSibling,Z=j.nextSibling,te=ne.nextSibling,he=te.firstChild,se=he.nextSibling,re=se.nextSibling,ye=te.nextSibling,G=ye.firstChild,ae=G.nextSibling,Pe=ae.nextSibling,we=S.nextSibling,ue=we.firstChild,ce=ue.nextSibling;return d(x,t),d($,e),d(O,r),d(q,n),d(z,i),d(ee,o),C.addEventListener("mouseleave",H=>{H.currentTarget.style.background="white",H.currentTarget.style.color="#4285f4"}),C.addEventListener("mouseenter",H=>{H.currentTarget.style.background="#4285f4",H.currentTarget.style.color="white"}),C.$$click=T,d(C,p),s(C,b(Ge,{get when(){return sr.state.loading},fallback:"Sign in with Google",children:"Signing in..."}),null),d(v,A),s(O,b(Ge,{get when(){return sr.state.error},get children(){var H=UP();return d(H,_),s(H,()=>sr.state.error),H}}),null),d(S,a),d(we,E),ce.style.setProperty("margin-top","0.5rem"),ce.style.setProperty("font-size","0.75rem"),K(H=>{var de=sr.state.loading,X=c,_e=u,Se=h,Y=f,ie=c,Ie=u,pe=h,me=f,J=c,D=u,ge=h,ke=f,Ee=c,Te=u,De=h,Ke=f,Me=c,ve=u,Le=h,Fe=f,ze=c,qe=u,Ce=h,Ye=f;return de!==H.e&&(C.disabled=H.e=de),H.t=d(w,X,H.t),H.a=d(P,_e,H.a),H.o=d(I,Se,H.o),H.i=d(y,Y,H.i),H.n=d(le,ie,H.n),H.s=d(B,Ie,H.s),H.h=d(k,pe,H.h),H.r=d(W,me,H.r),H.d=d(R,J,H.d),H.l=d(V,D,H.l),H.u=d(M,ge,H.u),H.c=d(F,ke,H.c),H.w=d(ne,Ee,H.w),H.m=d(L,Te,H.m),H.f=d(j,De,H.f),H.y=d(Z,Ke,H.y),H.g=d(te,Me,H.g),H.p=d(he,ve,H.p),H.b=d(se,Le,H.b),H.T=d(re,Fe,H.T),H.A=d(ye,ze,H.A),H.O=d(G,qe,H.O),H.I=d(ae,Ce,H.I),H.S=d(Pe,Ye,H.S),H},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0}),x})()};Ot(["click"]);var qP=U("<div><div>");const HP=t=>{const e={"min-height":"100vh",display:"flex","align-items":"center","justify-content":"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},r={width:"50px",height:"50px",border:"3px solid rgba(255, 255, 255, 0.3)","border-top-color":"white","border-radius":"50%",animation:"spin 1s linear infinite"},n=document.createElement("style");return n.textContent=`
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  `,document.head.appendChild(n),Ln(()=>{sr.state?.user?.uid&&(console.log(sr.state?.user.uid),sr.getUserProfile(sr.state?.user?.uid))}),yn(()=>{}),b(Ge,{get when(){return!sr.state.loading},get fallback(){return(()=>{var i=qP(),o=i.firstChild;return d(i,e),d(o,r),i})()},get children(){return b(Ge,{get when(){return sr.isAuthenticated},get fallback(){return b(zP,{})},get children(){return t.children}})}})};var WP=U("<button>");const Oe=t=>{const e=()=>{const r={"font-family":"inherit",cursor:t.disabled?"not-allowed":"pointer",border:"none","border-radius":"var(--border-radius-sm)","font-weight":"500",transition:"all 0.2s ease","text-decoration":"none",display:"inline-flex","align-items":"center","justify-content":"center",gap:"0.5rem",opacity:t.disabled?"0.6":"1"},n={sm:{padding:"0.5rem 1rem","font-size":"0.875rem"},md:{padding:"0.75rem 1.5rem","font-size":"1rem"},lg:{padding:"1rem 2rem","font-size":"1.125rem"}},i={primary:{background:"linear-gradient(135deg, var(--primary-color), var(--primary-dark))",color:"white","box-shadow":"var(--shadow-sm)"},secondary:{background:"var(--surface-color)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},outline:{background:"transparent",color:"var(--primary-color)",border:"1px solid var(--primary-color)"}};return{...r,...n[t.size||"md"],...i[t.variant||"primary"]}};return(()=>{var r=WP();return Ti(r,"click",t.onClick,!0),s(r,()=>t.children),K(n=>{var i=e(),o=t.disabled,a=t.type||"button",c=`btn btn-${t.variant||"primary"} ${t.className||""}`;return n.e=d(r,i,n.e),o!==n.t&&(r.disabled=n.t=o),a!==n.a&&gt(r,"type",n.a=a),c!==n.o&&mc(r,n.o=c),n},{e:void 0,t:void 0,a:void 0,o:void 0}),r})()};Ot(["click"]);var GP=U("<div><div><div><h2></h2><button>×</button></div><div>");const yr=t=>{const e={position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","z-index":"1000"},r={background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)","max-width":"920px",width:"90%","max-height":"80vh",overflow:"auto",position:"relative"},n={padding:"1.5rem","border-bottom":"1px solid var(--border-color)",display:"flex","justify-content":"space-between","align-items":"center"},i={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},o={background:"none",border:"none","font-size":"1.5rem",cursor:"pointer",color:"var(--text-muted)",padding:"0.5rem","border-radius":"var(--border-radius-sm)"},a={padding:"1.5rem"},c=u=>{u.target===u.currentTarget&&t.onClose()};return b(Ge,{get when(){return t.isOpen},get children(){var u=GP(),h=u.firstChild,f=h.firstChild,p=f.firstChild,_=p.nextSibling,E=f.nextSibling;return u.$$click=c,d(f,n),d(p,i),s(p,()=>t.title),_.addEventListener("mouseleave",A=>A.target.style.background="none"),_.addEventListener("mouseenter",A=>A.target.style.background="var(--background-color)"),Ti(_,"click",t.onClose,!0),d(_,o),d(E,a),s(E,()=>t.children),K(A=>{var T=e,x=r;return A.e=d(u,T,A.e),A.t=d(h,x,A.t),A},{e:void 0,t:void 0}),u}})};Ot(["click"]);var mh=U("<div>"),KP=U("<h3>"),YP=U("<p>");const tt=t=>{const e={background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"1.5rem","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",transition:"all 0.2s ease",cursor:t.onClick?"pointer":"default"},r={"margin-bottom":"1rem"},n={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0 0 0.5rem 0"},i={"font-size":"0.875rem",color:"var(--text-muted)",margin:"0"};return(()=>{var o=mh();return Ti(o,"click",t.onClick,!0),s(o,(()=>{var a=oe(()=>!!(t.title||t.subtitle));return()=>a()&&(()=>{var c=mh();return d(c,r),s(c,(()=>{var u=oe(()=>!!t.title);return()=>u()&&(()=>{var h=KP();return d(h,n),s(h,()=>t.title),h})()})(),null),s(c,(()=>{var u=oe(()=>!!t.subtitle);return()=>u()&&(()=>{var h=YP();return d(h,i),s(h,()=>t.subtitle),h})()})(),null),c})()})(),null),s(o,()=>t.children,null),K(a=>{var c=e,u=`card ${t.className||""}`;return a.e=d(o,c,a.e),u!==a.t&&mc(o,a.t=u),a},{e:void 0,t:void 0}),o})()};Ot(["click"]);var QP=U("<div><label></label><input>"),JP=U("<span>*");const Rt=t=>{const e={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},r={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},n={"margin-bottom":"1rem"};return(()=>{var i=QP(),o=i.firstChild,a=o.nextSibling;return d(i,n),d(o,e),s(o,()=>t.label,null),s(o,(()=>{var c=oe(()=>!!t.required);return()=>c()&&(()=>{var u=JP();return u.style.setProperty("color","var(--primary-color)"),u})()})(),null),a.addEventListener("blur",c=>c.target.style.borderColor="var(--border-color)"),a.addEventListener("focus",c=>c.target.style.borderColor="var(--primary-color)"),a.$$input=c=>t.onChange(c.target.value),d(a,r),K(c=>{var u=t.type||"text",h=t.placeholder,f=t.required,p=t.disabled;return u!==c.e&&gt(a,"type",c.e=u),h!==c.t&&gt(a,"placeholder",c.t=h),f!==c.a&&(a.required=c.a=f),p!==c.o&&(a.disabled=c.o=p),c},{e:void 0,t:void 0,a:void 0,o:void 0}),K(()=>a.value=t.value),i})()};Ot(["input"]);const XP={en:{common:{save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",close:"Close",search:"Search",filter:"Filter",reset:"Reset",back:"Back",next:"Next",previous:"Previous",yes:"Yes",no:"No",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",confirm:"Confirm",actions:"Actions",status:"Status",active:"Active",inactive:"Inactive",date:"Date",time:"Time",description:"Description",notes:"Notes",amount:"Amount",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Language",english:"English",spanish:"Spanish",noDataFound:"No data found",required:"Required",optional:"Optional",all:"All",none:"None",select:"Select",clear:"Clear",searching:"Searching...",refresh:"Refresh",showAll:"Show All",products:"products",filtered:"Filtered",view:"View",suggested:"Suggested",clearFilters:"Clear Filters",enhanced:"Enhanced",legacy:"Legacy",email:"Email",phone:"Phone",address:"Address",name:"Name",code:"Code",category:"Category",type:"Type",quantity:"Quantity",price:"Price",cost:"Cost",value:"Value",balance:"Balance",created:"Created",modified:"Modified",details:"Details",summary:"Summary",history:"History",new:"New",addNew:"Add New",unknown:"Unknown",notAvailable:"N/A",remove:"Remove",startDate:"Start Date",endDate:"End Date",from:"From",invoice:"Invoice",reference:"Reference",createdBy:"Created By",units:"units",invoiceDocumentId:"Invoice/Document ID",referenceNumber:"Reference Number",referenceNumberPlaceholder:"Enter reference number...",generalNotes:"General Notes",auto:"Auto",optionalNotes:"Optional notes...",showPerPage:"Show per page",first:"First",last:"Last",pageOfPages:"Page {{current}} of {{total}}",showingXofY:"Showing {{start}}-{{end}} of {{total}}",page:"Page",of:"of"},forms:{referenceNumberRequired:"Reference number is required",locationRequired:"Location is required",fromLocationRequired:"From location is required for transfers",atLeastOneProduct:"At least one product is required",itemProductRequired:"Product is required for item {{index}}",itemQuantityRequired:"Quantity must be greater than 0 for item {{index}}"},navigation:{dashboard:"Dashboard",accounts:"Chart of Accounts",balanceSheet:"Balance Sheet",inventory:"Inventory",employees:"Employees",entryBooks:"Entry Books",consolidate:"Bank Consolidation",reports:"Reports",settings:"Settings"},dashboard:{title:"Dashboard",welcome:"Welcome to HRM Finance",totalRevenue:"Total Revenue",overview:"Overview",recentActivity:"Recent Activity",quickActions:"Quick Actions",employeeCount:"Employee Count",pendingInvoices:"Pending Invoices",cashBalance:"Cash Balance",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalExpenses:"Total Expenses",netIncome:"Net Income",netLoss:"Net Loss",monthlyPayroll:"Monthly Payroll",current:"Current",newHires:"+3 new hires",outstanding:"Outstanding",totalOutstanding:"$23,450 total",lastUpdatedToday:"Last updated today",commonTasks:"Common tasks",generateReport:"Generate Report",latestUpdates:"Latest updates",invoicePaid:"Invoice #1234 paid",hoursAgo:"2 hours ago",newEmployeeOnboarded:"New employee onboarded",dayAgo:"1 day ago",monthlyReportGenerated:"Monthly report generated",daysAgo:"2 days ago"},accounts:{title:"Chart of Accounts",accountNumber:"Account Number",accountName:"Account Name",accountType:"Account Type",category:"Category",balance:"Balance",parentAccount:"Parent Account",subAccounts:"Sub-accounts",addAccount:"Add Account",editAccount:"Edit Account",deleteAccount:"Delete Account",accountDetails:"Account Details",transactions:"Transactions",accountHistory:"Account History",backToAccounts:"Back to Accounts",accountNotFound:"Account not found",accountInformation:"Account Information",accountPurpose:"Account purpose",transactionHistory:"Transaction History",noTransactions:"No transactions found for this account",createdDate:"Created Date",lastModified:"Last Modified",noDescription:"No description provided.",totalCount:"Total count",basicDetails:"Basic details",currentBalance:"Current balance",classification:"Classification",allTransactions:"All account transactions",reference:"Reference",allAccounts:"All Accounts",types:{asset:"Asset",liability:"Liability",equity:"Equity",revenue:"Revenue",expense:"Expense"},categories:{currentAssets:"Current Assets",fixedAssets:"Fixed Assets",currentLiabilities:"Current Liabilities",longTermLiabilities:"Long-term Liabilities",ownersEquity:"Owner's Equity",operatingRevenue:"Operating Revenue",operatingExpenses:"Operating Expenses"}},inventory:{title:"Inventory Management",overview:"Overview",products:"Products & Stock",movements:"Movements",locations:"Locations",bulkMovement:"Bulk Movement",addMovement:"Add Movement",addProduct:"Add Product",addLocation:"Add Location",singleMovement:"Add Single Movement",addNewItem:"Add New Item",activeProducts:"Active Products",lowStockAlert:"Low Stock Items",totalValue:"Total Stock Value",activeLocations:"Active Locations",productsNeedRestocking:"products need restocking",recentMovements:"Recent Movements",noProducts:"No products at this location",productName:"Product Name",productCode:"Product Code",sku:"SKU",unitOfMeasure:"Unit of Measure",unitCost:"Unit Cost",minStockLevel:"Min Stock Level",maxStockLevel:"Max Stock Level",locationName:"Location Name",locationType:"Location Type",locationCode:"Location Code",movementType:"Movement Type",referenceNumber:"Reference Number",invoiceNumber:"Invoice Number",fromLocation:"From Location",toLocation:"To Location",stockIn:"Stock In",stockOut:"Stock Out",transfer:"Transfer",adjustment:"Adjustment",inStock:"In Stock",lowStock:"Low Stock",outOfStock:"Out of Stock",stockLevels:"Stock Levels",stockByLocation:"Stock by Location",searchProducts:"Search products by name, SKU, or category...",searchProductsStock:"Search products and check stock levels...",searchResult:"Search Result",searchResults:"Search Results",searchFallback:"Showing local results",tryDifferentTerm:"Try a different search term or check spelling.",showingTopResults:"Showing top {{count}} results",searchLocations:"Search locations...",noMovements:"No movements found",productDetails:"Product Details",locationDetails:"Location Details",movementDetails:"Movement Details",totalProducts:"Total Products",totalLocations:"Total Locations",lastSeen:"Last seen",warehouseType:"Warehouse",storeType:"Store",supplierType:"Supplier",customerType:"Customer",currentlyManaged:"Currently managed",needAttention:"Need attention",currentWorth:"Current worth",warehousesStores:"Warehouses & stores",thisMonth:"This Month",latestActivities:"Latest inventory activities",searchMovements:"Search Movements",countingSheet:"Counting Sheet",physicalCount:"Physical Count",physicalInventoryCount:"Physical Inventory Count",setupPhysicalCount:"Setup Physical Inventory Count",setupDescription:"Configure your physical inventory count settings and begin the counting process.",countWillInclude:"This count will include {{count}} products from {{location}} in {{category}} category.",startCounting:"Start Physical Count",counted:"Counted",remaining:"Remaining",variances:"Variances",complete:"Complete",systemQty:"System Qty",variance:"Variance",addNotes:"Add notes...",reviewAndConfirm:"Review and Confirm Adjustments",reviewDescription:"Review the inventory adjustments below and confirm to update your system.",stockIncreases:"Stock Increases",stockDecreases:"Stock Decreases",totalAdjustments:"Total Adjustments",confirmAdjustments:"Confirm Adjustments",perfectCount:"Perfect Count!",noVariances:"No variances found. Your physical count matches the system exactly.",physicalCountAdjustment:"Physical count adjustment",inventoryCountingSheetTitle:"INVENTORY COUNTING SHEET",location:"Location",allCategories:"All Categories",countedBy:"Counted by",verifiedBy:"Verified by",instructions:"Instructions",countInstructions:["Count all items physically present at this location",'Write the actual count in the "Physical Count" column',"Leave blank if item is not found",'Note any discrepancies in the "Notes" column',"Sign and date when complete"],productName:"Product Name",unit:"Unit",totalProductsListed:"Total Products Listed",itemsCounted:"Items Counted",discrepanciesFound:"Discrepancies Found",counterSignature:"Counter Signature",supervisorSignature:"Supervisor Signature",downloadCSV:"Download CSV",noAdjustmentsToDownload:"No adjustments to download",stockIncrease:"Stock Increase",stockDecrease:"Stock Decrease",purchaseReceive:"Purchase/Receive",saleIssue:"Sale/Issue",transfer:"Transfer",adjustment:"Adjustment",movementType:"Movement Type",fromLocation:"From Location",toLocation:"To Location",searchSourceLocation:"Search source location...",searchDestinationLocation:"Search destination location...",searchLocation:"Search location...",addProduct:"Add Product",searchProduct:"Search product...",unitCost:"Unit Cost",noProductsAdded:'No products added yet. Click "Add Product" to get started.',createMovement:"Create Movement",generalNotesPlaceholder:"Enter general notes for this movement...",sortBy:"Sort By",allLocations:"All Locations",searchByProduct:"Search by product, location, reference, notes, invoice...",allProducts:"All Products",allTypes:"All Types",startDate:"Start Date",endDate:"End Date",totalMovements:"Total Movements",totalItems:"Total Items",adjustMovements:"Try adjusting your filters or check back later.",inventoryMovements:"Inventory Movements",createdBy:"Created By",view:"View",enhanced:"Enhanced",legacy:"Legacy",addSingleMovement:"Add Single Movement",inStockSubtitle:"In stock",itemsBelowThreshold:"Items below threshold",inventoryWorth:"Inventory worth",quantity:"Quantity",units:"units",normal:"Normal",productsAndStock:"Products & Stock",lowStockItems:"Low Stock Items",totalStockValue:"Total Stock Value",warehousesAndStores:"Warehouses & stores",andMore:"...and {count} more",latestInventoryActivities:"Latest inventory activities",min:"Min",max:"Max",cost:"Cost",noProductsFound:"No products found matching your search.",noProductsAvailable:"No products available.",noLocationsFound:"No locations found matching your search.",noLocationsAvailable:"No locations available.",searchPlaceholder:"Search by product, location, reference, notes, invoice...",noMovementsFound:"No movements found",tryAdjustingFilters:"Try adjusting your filters or check back later.",transfers:"Transfers",adjustments:"Adjustments",bulk:"Bulk",product:"Product",location:"Location",store:"Store",supplier:"Supplier",warehouse:"Warehouse",movement:"Movement",editMovement:"Edit Movement",updateMovement:"Update Movement",movementInformation:"Movement Information",locationInformation:"Location Information"},employees:{title:"Employee Management",employeeList:"Employee List",addEmployee:"Add Employee",editEmployee:"Edit Employee",employeeDetails:"Employee Details",personalInfo:"Personal Information",employmentInfo:"Employment Information",payrollInfo:"Payroll Information",firstName:"First Name",lastName:"Last Name",fullName:"Full Name",email:"Email",phone:"Phone",address:"Address",dateOfBirth:"Date of Birth",employeeId:"Employee ID",department:"Department",position:"Position",hireDate:"Hire Date",employmentStatus:"Employment Status",salary:"Salary",payFrequency:"Pay Frequency",taxId:"Tax ID",bankAccount:"Bank Account",emergencyContact:"Emergency Contact",activeEmployees:"Active Employees",inactiveEmployees:"Inactive Employees",totalPayroll:"Total Payroll",searchEmployees:"Search employees...",enterFullName:"Enter employee's full name",enterPosition:"Enter job position",enterEmail:"Enter email address",enterPhone:"Enter phone number",enterSalary:"Enter annual salary",departments:{engineering:"Engineering",product:"Product",design:"Design",marketing:"Marketing",sales:"Sales",humanResources:"Human Resources",finance:"Finance",operations:"Operations",analytics:"Analytics"}},entryBooks:{title:"Entry Books",bookName:"Book Name",bookType:"Book Type",createBook:"Create Book",editBook:"Edit Book",salesBook:"Sales Book",purchaseBook:"Purchase Book",cashBook:"Cash Book",generalBook:"General Book",entries:"Entries",addEntry:"Add Entry",period:"Period",startDate:"Start Date",endDate:"End Date",bookBalance:"Book Balance",reconciledBalance:"Reconciled Balance",difference:"Difference",reconcile:"Reconcile",isReconciled:"Is Reconciled",noBooks:"No entry books found",createFirst:"Create your first entry book to get started",bookDetails:"Book Details",entriesCount:"entries",bookOverview:"Book overview and details",bookEntries:"Book Entries",allEntries:"All entries in this book",noEntries:"No entries found",addFirst:"Add your first entry to this book",entryDate:"Entry Date",entryDescription:"Entry Description",entryAmount:"Entry Amount",entryReference:"Entry Reference",subtitle:"Manage accounting entries and general ledger records",viewReconciliation:"View Reconciliation",totalEntries:"Total Entries",allJournalEntries:"All journal entries",postedEntriesOnly:"Posted entries only",fromPostedEntries:"From {count} posted entries",needBankReconciliation:"Need bank reconciliation",allReconciled:"All reconciled",sortBy:"Sort By",fromDate:"From Date",toDate:"To Date",order:"Order",newest:"Newest",oldest:"Oldest",resetFilters:"Reset Filters",activeFilters:"Active filters",from:"From",to:"To",entriesFound:"{count} entries found",noJournalEntries:"No Journal Entries",startByCreating:"Start by creating your first entry",noEntriesMatch:"No journal entries match your current filters.",createFirstEntry:"Create First Entry",void:"Void",confirmVoid:"Are you sure you want to void this journal entry?",entryBookRecords:"Entry Book Records"},banking:{title:"Bank Consolidation",bankAccount:"Bank Account",statementDate:"Statement Date",beginningBalance:"Beginning Balance",endingBalance:"Ending Balance",deposits:"Deposits",withdrawals:"Withdrawals",bankCharges:"Bank Charges",interest:"Interest",reconcile:"Reconcile",matched:"Matched",unmatched:"Unmatched",importStatement:"Import Statement",manualEntry:"Manual Entry",autoMatch:"Auto Match",clearAll:"Clear All",reconciliationStatus:"Reconciliation Status",difference:"Difference",bookBalance:"Book Balance",statementBalance:"Statement Balance",outstandingChecks:"Outstanding Checks",depositsInTransit:"Deposits in Transit",reconciled:"Reconciled",notReconciled:"Not Reconciled",unreconciled:"Unreconciled",reconciliation:"Reconciliation",compareStatements:"Compare bank statements with entry book records",importCSV:"Import CSV",startNewReconciliation:"Start New Reconciliation",bankAccountInfo:"Bank Account Info",currentAccountDetails:"Current account details",lastReconciled:"Last reconciled",bankTransactions:"Bank Transactions",selectedPeriod:"Selected period",pending:"pending",bookEntriesForComparison:"Book entries for comparison",reconciliationRate:"Reconciliation Rate",completionStatus:"Completion status",recentReconciliationSessions:"Recent Reconciliation Sessions",latestActivity:"Latest activity",noRecentSessions:"No recent reconciliation sessions found.",startFirstReconciliation:"Start First Reconciliation",entryBookRecords:"Entry Book Records",pleaseUploadCSV:"Please upload a CSV file",csvRequiresHeaderAndData:"CSV file must have at least a header and one data row",successfullyParsed:"Successfully parsed {count} rows",errorParsingCSV:"Error parsing CSV file. Please check the format.",dateDescriptionRequired:"Date and Description columns are required",importedTransaction:"Imported transaction",successfullyImported:"Successfully imported {count} bank transactions",errorImportingTransactions:"Error importing transactions. Please check your data.",importBankStatementCSV:"Import Bank Statement CSV",dropCSVHere:"Drop CSV file here",clickToUploadCSV:"Click to upload or drag and drop CSV file",supportedFormat:"Supported format: CSV with Date, Description, and Amount columns",mapCSVColumns:"Map CSV Columns",dateColumn:"Date Column",selectColumn:"Select column...",descriptionColumn:"Description Column",referenceColumn:"Reference Column",amountDebitColumn:"Amount/Debit Column",creditColumn:"Credit Column",balanceColumn:"Balance Column",andMoreRows:"... and {count} more rows",importing:"Importing...",importTransactions:"Import {count} Transactions",reconciliationComparison:"Reconciliation Comparison",bankStatements:"Bank Statements",totalTransactions:"Total transactions",totalEntries:"Total entries",unreconciledBank:"Unreconciled Bank",unreconciledBooks:"Unreconciled Books",needAttention:"Need attention",unreconcile:"Unreconcile",clickToReconcile:"Click to reconcile",potentialMatchesFound:"Potential Matches Found",clickRecordToReconcile:"Click on a record below to reconcile",exactMatch:"Exact Match",possibleMatch:"Possible Match",selected:"Selected",clearSelection:"Clear Selection"},journal:{title:"Journal Entries",entryNumber:"Entry Number",entryDate:"Entry Date",debit:"Debit",credit:"Credit",account:"Account",memo:"Memo",reference:"Reference",createEntry:"Create Entry",editEntry:"Edit Entry",deleteEntry:"Delete Entry",posted:"Posted",draft:"Draft",reversed:"Reversed",recurringEntry:"Recurring Entry",attachments:"Attachments",totalDebits:"Total Debits",totalCredits:"Total Credits",outOfBalance:"Out of Balance",balanced:"Balanced",addEntry:"Add Journal Entry",allEntries:"All Entries",totalDebit:"Total Debit",totalCredit:"Total Credit",debitShort:"Dr.",creditShort:"Cr.",noReference:"No reference",createdBy:"By",totalAmount:"Total Amount",lines:"Lines",entryNotBalancedShort:"Entry is not balanced",accountLines:"Account Lines",noDescription:"No description",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryLines:"Journal Entry Lines",addLine:"Add Line",lineDescription:"Line description",notBalanced:"Not Balanced",updateEntry:"Update Entry",saveAsDraft:"Save as Draft",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",editEntryTooltip:"Edit this journal entry",post:"Post",entryMustBeBalanced:"Entry must be balanced to post",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",journalLines:"Journal Lines",balanceStatus:"Balance Status",unbalanced:"Unbalanced",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",postEntry:"Post Entry",fixBalance:"Fix Balance",voidEntry:"Void Entry",draftEntry:"Draft Entry",draftEntryDescription:"This entry can be edited and posted.",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",postedEntry:"Posted Entry",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",minTwoLinesRequired:"At least 2 line items are required",entryNotBalanced:"Entry is not balanced. Debit: ${debit}, Credit: ${credit}",lineAccountRequired:"Line {lineNumber}: Account is required",lineAmountRequired:"Line {lineNumber}: Either debit or credit amount must be provided",lineBothAmounts:"Line {lineNumber}: Cannot have both debit and credit amounts",enterEntryDescription:"Enter journal entry description",enterReferenceNumber:"Enter reference number"},forms:{requiredField:"This field is required",invalidEmail:"Invalid email address",invalidNumber:"Invalid number",invalidDate:"Invalid date",selectOption:"Please select an option",enterValue:"Please enter a value",confirmDelete:"Are you sure you want to delete this item?",unsavedChanges:"You have unsaved changes. Do you want to continue?",saveSuccess:"Saved successfully",saveError:"Error saving data",deleteSuccess:"Deleted successfully",deleteError:"Error deleting item",duplicateAccountNumber:"Account number already exists",descriptionRequired:"Description is required",errorOccurred:"An error occurred",errorPostingEntry:"An error occurred while posting the entry"},modals:{addInventory:"Add Inventory Movement",bulkMovement:"Bulk Inventory Movement",addProduct:"Add New Product",addLocation:"Add New Location",inventoryDetail:"Inventory Item Details",quickAdd:"Quick Add",selectProduct:"Select Product",selectLocation:"Select Location",enterQuantity:"Enter quantity",enterCost:"Enter unit cost",enterReference:"Enter reference number",addNotes:"Add notes (optional)",generalInformation:"General Information",stockInformation:"Stock Information",locationInformation:"Location Information",movementInformation:"Movement Information",addToInventory:"Add to Inventory",createProduct:"Create Product",createLocation:"Create Location",processing:"Processing...",addingMovement:"Adding movement...",creatingProduct:"Creating product...",creatingLocation:"Creating location..."},products:{title:"Products",addNew:"Add New Product",totalProducts:"Total Products",inCatalog:"In catalog",activeProducts:"Active Products",currentlyAvailable:"Currently available",outOfStock:"Out of Stock",needsRestock:"Needs restock",productCatalog:"Product Catalog",manageYourProducts:"Manage your products and pricing",inStock:"In Stock",furniture:"Furniture",electronics:"Electronics",supplies:"Supplies",lighting:"Lighting",searchPlaceholder:"Search products by name, SKU, or category...",allCategories:"All Categories",clearFilters:"Clear filters",noResults:"No products found matching your criteria.",noProducts:"No products available.",showing:"Showing",filtered:"Filtered results",allProducts:"All products",searchResult:"Search Result",stock:"Stock",lowStock:"Low Stock"},invoices:{title:"Invoices",createNew:"Create New Invoice",totalOutstanding:"Total Outstanding",unpaidInvoices:"Unpaid invoices",thisMonth:"This Month",revenueCollected:"Revenue collected",overdue:"Overdue",pastDueInvoices:"Past due invoices",recentInvoices:"Recent Invoices",latestBillingActivity:"Latest billing activity",paid:"Paid",pending:"Pending"}},es:{common:{save:"Guardar",cancel:"Cancelar",delete:"Eliminar",edit:"Editar",add:"Agregar",close:"Cerrar",search:"Buscar",filter:"Filtrar",reset:"Restablecer",back:"Atrás",next:"Siguiente",previous:"Anterior",yes:"Sí",no:"No",loading:"Cargando...",error:"Error",success:"Éxito",warning:"Advertencia",info:"Información",confirm:"Confirmar",actions:"Acciones",status:"Estado",active:"Activo",inactive:"Inactivo",date:"Fecha",time:"Hora",description:"Descripción",notes:"Notas",amount:"Monto",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Idioma",english:"Inglés",spanish:"Español",noDataFound:"No se encontraron datos",required:"Requerido",optional:"Opcional",all:"Todos",none:"Ninguno",select:"Seleccionar",clear:"Limpiar",view:"Ver",suggested:"Sugerido",clearFilters:"Limpiar Filtros",enhanced:"Mejorado",legacy:"Clásico",email:"Correo Electrónico",phone:"Teléfono",address:"Dirección",name:"Nombre",code:"Código",category:"Categoría",type:"Tipo",quantity:"Cantidad",price:"Precio",cost:"Costo",value:"Valor",balance:"Saldo",created:"Creado",modified:"Modificado",details:"Detalles",summary:"Resumen",history:"Historial",new:"Nuevo",addNew:"Agregar Nuevo",unknown:"Desconocido",notAvailable:"N/A",remove:"Remover",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",from:"De",invoice:"Factura",reference:"Referencia",createdBy:"Creado Por",units:"unidades",invoiceDocumentId:"ID de Factura/Documento",referenceNumber:"Número de Referencia",referenceNumberPlaceholder:"Ingrese número de referencia...",generalNotes:"Notas Generales",auto:"Auto",optionalNotes:"Notas opcionales...",showPerPage:"Mostrar por página",first:"Primera",last:"Última",pageOfPages:"Página {{current}} de {{total}}",showingXofY:"Mostrando {{start}}-{{end}} de {{total}}",page:"Página",of:"de"},forms:{referenceNumberRequired:"El número de referencia es requerido",locationRequired:"La ubicación es requerida",fromLocationRequired:"La ubicación de origen es requerida para transferencias",atLeastOneProduct:"Al menos un producto es requerido",itemProductRequired:"El producto es requerido para el artículo {{index}}",itemQuantityRequired:"La cantidad debe ser mayor que 0 para el artículo {{index}}"},navigation:{dashboard:"Panel de Control",accounts:"Plan de Cuentas",balanceSheet:"Balance General",inventory:"Inventario",employees:"Empleados",entryBooks:"Libros de Entrada",consolidate:"Consolidación Bancaria",reports:"Reportes",settings:"Configuración"},dashboard:{title:"Panel de Control",welcome:"Bienvenido a HRM Finance",totalRevenue:"Ingresos Totales",overview:"Resumen",recentActivity:"Actividad Reciente",quickActions:"Acciones Rápidas",employeeCount:"Número de Empleados",pendingInvoices:"Facturas Pendientes",cashBalance:"Saldo en Efectivo",totalAssets:"Activos Totales",totalLiabilities:"Pasivos Totales",totalExpenses:"Gastos Totales",netIncome:"Ingreso Neto",netLoss:"Pérdida Neta",monthlyPayroll:"Nómina Mensual",current:"Actual",newHires:"+3 nuevas contrataciones",outstanding:"Pendiente",totalOutstanding:"$23,450 total",lastUpdatedToday:"Última actualización hoy",commonTasks:"Tareas comunes",generateReport:"Generar Reporte",latestUpdates:"Últimas actualizaciones",invoicePaid:"Factura #1234 pagada",hoursAgo:"hace 2 horas",newEmployeeOnboarded:"Nuevo empleado incorporado",dayAgo:"hace 1 día",monthlyReportGenerated:"Reporte mensual generado",daysAgo:"hace 2 días"},accounts:{title:"Plan de Cuentas",accountNumber:"Número de Cuenta",accountName:"Nombre de Cuenta",accountType:"Tipo de Cuenta",category:"Categoría",balance:"Saldo",parentAccount:"Cuenta Padre",subAccounts:"Subcuentas",addAccount:"Agregar Cuenta",editAccount:"Editar Cuenta",deleteAccount:"Eliminar Cuenta",accountDetails:"Detalles de Cuenta",transactions:"Transacciones",accountHistory:"Historial de Cuenta",backToAccounts:"Volver a Cuentas",accountNotFound:"Cuenta no encontrada",accountInformation:"Información de Cuenta",accountPurpose:"Propósito de la cuenta",transactionHistory:"Historial de Transacciones",noTransactions:"No se encontraron transacciones para esta cuenta",createdDate:"Fecha de Creación",lastModified:"Última Modificación",noDescription:"No se proporcionó descripción.",totalCount:"Conteo total",basicDetails:"Detalles básicos",currentBalance:"Saldo actual",classification:"Clasificación",allTransactions:"Todas las transacciones de la cuenta",reference:"Referencia",types:{asset:"Activo",liability:"Pasivo",equity:"Patrimonio",revenue:"Ingreso",expense:"Gasto"},categories:{currentAssets:"Activos Corrientes",fixedAssets:"Activos Fijos",currentLiabilities:"Pasivos Corrientes",longTermLiabilities:"Pasivos a Largo Plazo",ownersEquity:"Patrimonio del Propietario",operatingRevenue:"Ingresos Operacionales",operatingExpenses:"Gastos Operacionales"}},inventory:{title:"Gestión de Inventario",overview:"Resumen",products:"Productos y Stock",movements:"Movimientos",locations:"Ubicaciones",bulkMovement:"Movimiento Masivo",addMovement:"Agregar Movimiento",addProduct:"Agregar Producto",addLocation:"Agregar Ubicación",singleMovement:"Agregar Movimiento Individual",addNewItem:"Agregar Nuevo Artículo",activeProducts:"Productos Activos",lowStockAlert:"Artículos con Stock Bajo",totalValue:"Valor Total del Stock",activeLocations:"Ubicaciones Activas",productsNeedRestocking:"productos necesitan reabastecimiento",recentMovements:"Movimientos Recientes",noProducts:"No hay productos en esta ubicación",productName:"Nombre del Producto",productCode:"Código del Producto",sku:"SKU",unitOfMeasure:"Unidad de Medida",unitCost:"Costo Unitario",minStockLevel:"Nivel Mínimo de Stock",maxStockLevel:"Nivel Máximo de Stock",locationName:"Nombre de Ubicación",locationType:"Tipo de Ubicación",locationCode:"Código de Ubicación",movementType:"Tipo de Movimiento",referenceNumber:"Número de Referencia",invoiceNumber:"Número de Factura",fromLocation:"Desde Ubicación",toLocation:"Hacia Ubicación",stockIn:"Entrada de Stock",stockOut:"Salida de Stock",transfer:"Transferencia",adjustment:"Ajuste",inStock:"En Stock",lowStock:"Stock Bajo",outOfStock:"Sin Stock",stockLevels:"Niveles de Stock",stockByLocation:"Stock por Ubicación",searchProducts:"Buscar productos...",searchLocations:"Buscar ubicaciones...",noMovements:"No se encontraron movimientos",productDetails:"Detalles del Producto",locationDetails:"Detalles de Ubicación",movementDetails:"Detalles del Movimiento",totalProducts:"Total de Productos",totalLocations:"Total de Ubicaciones",lastSeen:"Visto por última vez",warehouseType:"Almacén",storeType:"Tienda",supplierType:"Proveedor",customerType:"Cliente",currentlyManaged:"Gestionados actualmente",needAttention:"Necesitan atención",currentWorth:"Valor actual",warehousesStores:"Almacenes y tiendas",thisMonth:"Este Mes",latestActivities:"Últimas actividades de inventario",searchMovements:"Buscar Movimientos",countingSheet:"Hoja de Conteo",physicalCount:"Conteo Físico",physicalInventoryCount:"Conteo Físico de Inventario",setupPhysicalCount:"Configurar Conteo Físico de Inventario",setupDescription:"Configure los ajustes de su conteo físico de inventario y comience el proceso de conteo.",countWillInclude:"Este conteo incluirá {{count}} productos de {{location}} en la categoría {{category}}.",startCounting:"Iniciar Conteo Físico",counted:"Contado",remaining:"Restante",variances:"Variaciones",complete:"Completo",systemQty:"Cant. Sistema",variance:"Variación",addNotes:"Agregar notas...",reviewAndConfirm:"Revisar y Confirmar Ajustes",reviewDescription:"Revise los ajustes de inventario a continuación y confirme para actualizar su sistema.",stockIncreases:"Aumentos de Stock",stockDecreases:"Disminuciones de Stock",totalAdjustments:"Ajustes Totales",confirmAdjustments:"Confirmar Ajustes",adjustment:"Ajuste",perfectCount:"¡Conteo Perfecto!",noVariances:"No se encontraron variaciones. Su conteo físico coincide exactamente con el sistema.",physicalCountAdjustment:"Ajuste de conteo físico",inventoryCountingSheetTitle:"HOJA DE CONTEO DE INVENTARIO",location:"Ubicación",allCategories:"Todas las Categorías",countedBy:"Contado por",verifiedBy:"Verificado por",instructions:"Instrucciones",countInstructions:["Contar todos los artículos físicamente presentes en esta ubicación",'Escribir el conteo real en la columna "Conteo Físico"',"Dejar en blanco si el artículo no se encuentra",'Anotar cualquier discrepancia en la columna "Notas"',"Firmar y fechar cuando esté completo"],productName:"Nombre del Producto",unit:"Unidad",totalProductsListed:"Total de Productos Listados",itemsCounted:"Artículos Contados",discrepanciesFound:"Discrepancias Encontradas",counterSignature:"Firma del Contador",supervisorSignature:"Firma del Supervisor",downloadCSV:"Descargar CSV",noAdjustmentsToDownload:"No hay ajustes para descargar",stockIncrease:"Aumento de Stock",stockDecrease:"Disminución de Stock",purchaseReceive:"Compra/Recepción",saleIssue:"Venta/Emisión",transfer:"Transferencia",adjustment:"Ajuste",movementType:"Tipo de Movimiento",fromLocation:"Ubicación de Origen",toLocation:"Ubicación de Destino",searchSourceLocation:"Buscar ubicación de origen...",searchDestinationLocation:"Buscar ubicación de destino...",searchLocation:"Buscar ubicación...",addProduct:"Agregar Producto",searchProduct:"Buscar producto...",unitCost:"Costo Unitario",noProductsAdded:'No se han agregado productos aún. Haga clic en "Agregar Producto" para comenzar.',createMovement:"Crear Movimiento",generalNotesPlaceholder:"Ingrese notas generales para este movimiento...",sortBy:"Ordenar Por",allLocations:"Todas las Ubicaciones",searchByProduct:"Buscar por producto, ubicación, referencia, notas, factura...",allProducts:"Todos los Productos",allTypes:"Todos los Tipos",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",totalMovements:"Movimientos Totales",totalItems:"Artículos Totales",adjustMovements:"Intenta ajustar tus filtros o revisa más tarde.",inventoryMovements:"Movimientos de Inventario",createdBy:"Creado Por",view:"Ver",enhanced:"Mejorado",legacy:"Clásico",addSingleMovement:"Agregar Movimiento Individual",inStockSubtitle:"En stock",itemsBelowThreshold:"Artículos bajo el umbral",inventoryWorth:"Valor del inventario",quantity:"Cantidad",units:"unidades",normal:"Normal",productsAndStock:"Productos y Stock",lowStockItems:"Artículos con Stock Bajo",totalStockValue:"Valor Total del Stock",warehousesAndStores:"Almacenes y tiendas",andMore:"...y {count} más",latestInventoryActivities:"Últimas actividades de inventario",min:"Mín",max:"Máx",cost:"Costo",noProductsFound:"No se encontraron productos que coincidan con su búsqueda.",noProductsAvailable:"No hay productos disponibles.",noLocationsFound:"No se encontraron ubicaciones que coincidan con su búsqueda.",noLocationsAvailable:"No hay ubicaciones disponibles.",searchPlaceholder:"Buscar por producto, ubicación, referencia, notas, factura...",noMovementsFound:"No se encontraron movimientos",tryAdjustingFilters:"Intenta ajustar tus filtros o revisa más tarde.",transfers:"Transferencias",adjustments:"Ajustes",bulk:"Masivo",product:"Producto",location:"Ubicación",store:"Tienda",supplier:"Proveedor",warehouse:"Almacén",movement:"Movimiento",editMovement:"Editar Movimiento",updateMovement:"Actualizar Movimiento",movementInformation:"Información del Movimiento",locationInformation:"Información de Ubicación"},employees:{title:"Gestión de Empleados",employeeList:"Lista de Empleados",addEmployee:"Agregar Empleado",editEmployee:"Editar Empleado",employeeDetails:"Detalles del Empleado",personalInfo:"Información Personal",employmentInfo:"Información Laboral",payrollInfo:"Información de Nómina",firstName:"Nombre",lastName:"Apellido",fullName:"Nombre Completo",email:"Correo Electrónico",phone:"Teléfono",address:"Dirección",dateOfBirth:"Fecha de Nacimiento",employeeId:"ID de Empleado",department:"Departamento",position:"Puesto",hireDate:"Fecha de Contratación",employmentStatus:"Estado Laboral",salary:"Salario",payFrequency:"Frecuencia de Pago",taxId:"ID Fiscal",bankAccount:"Cuenta Bancaria",emergencyContact:"Contacto de Emergencia",activeEmployees:"Empleados Activos",inactiveEmployees:"Empleados Inactivos",totalPayroll:"Nómina Total",searchEmployees:"Buscar empleados...",enterFullName:"Ingrese el nombre completo del empleado",enterPosition:"Ingrese el puesto de trabajo",enterEmail:"Ingrese la dirección de correo electrónico",enterPhone:"Ingrese el número de teléfono",enterSalary:"Ingrese el salario anual",departments:{engineering:"Ingeniería",product:"Producto",design:"Diseño",marketing:"Marketing",sales:"Ventas",humanResources:"Recursos Humanos",finance:"Finanzas",operations:"Operaciones",analytics:"Analítica"}},entryBooks:{title:"Libros de Entrada",bookName:"Nombre del Libro",bookType:"Tipo de Libro",createBook:"Crear Libro",editBook:"Editar Libro",salesBook:"Libro de Ventas",purchaseBook:"Libro de Compras",cashBook:"Libro de Caja",generalBook:"Libro General",entries:"Entradas",addEntry:"Agregar Entrada",period:"Período",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",bookBalance:"Saldo del Libro",reconciledBalance:"Saldo Conciliado",difference:"Diferencia",reconcile:"Conciliar",isReconciled:"Está Conciliado",noBooks:"No se encontraron libros de entrada",createFirst:"Crea tu primer libro de entrada para comenzar",bookDetails:"Detalles del Libro",entriesCount:"entradas",bookOverview:"Resumen y detalles del libro",bookEntries:"Entradas del Libro",allEntries:"Todas las entradas en este libro",noEntries:"No se encontraron entradas",addFirst:"Agrega tu primera entrada a este libro",entryDate:"Fecha de Entrada",entryDescription:"Descripción de Entrada",entryAmount:"Monto de Entrada",entryReference:"Referencia de Entrada"},banking:{title:"Consolidación Bancaria",bankAccount:"Cuenta Bancaria",statementDate:"Fecha del Estado",beginningBalance:"Saldo Inicial",endingBalance:"Saldo Final",deposits:"Depósitos",withdrawals:"Retiros",bankCharges:"Cargos Bancarios",interest:"Intereses",reconcile:"Conciliar",matched:"Conciliado",unmatched:"No Conciliado",importStatement:"Importar Estado",manualEntry:"Entrada Manual",autoMatch:"Coincidencia Automática",clearAll:"Limpiar Todo",reconciliationStatus:"Estado de Conciliación",difference:"Diferencia",bookBalance:"Saldo en Libros",statementBalance:"Saldo del Estado",outstandingChecks:"Cheques Pendientes",depositsInTransit:"Depósitos en Tránsito",reconciled:"Conciliado",notReconciled:"No Conciliado",unreconciled:"No Conciliado",reconciliation:"Conciliación",compareStatements:"Comparar estados bancarios con registros de libros de entrada",importCSV:"Importar CSV",startNewReconciliation:"Iniciar Nueva Conciliación",bankAccountInfo:"Información de Cuenta Bancaria",currentAccountDetails:"Detalles de cuenta actual",lastReconciled:"Última conciliación",bankTransactions:"Transacciones Bancarias",selectedPeriod:"Período seleccionado",pending:"pendiente",bookEntriesForComparison:"Entradas de libros para comparación",reconciliationRate:"Tasa de Conciliación",completionStatus:"Estado de finalización",recentReconciliationSessions:"Sesiones de Conciliación Recientes",latestActivity:"Actividad reciente",noRecentSessions:"No se encontraron sesiones de conciliación recientes.",startFirstReconciliation:"Iniciar Primera Conciliación",entryBookRecords:"Registros de Libros de Entrada",pleaseUploadCSV:"Por favor suba un archivo CSV",csvRequiresHeaderAndData:"El archivo CSV debe tener al menos un encabezado y una fila de datos",successfullyParsed:"Se analizaron exitosamente {count} filas",errorParsingCSV:"Error al analizar el archivo CSV. Verifique el formato.",dateDescriptionRequired:"Las columnas de Fecha y Descripción son requeridas",importedTransaction:"Transacción importada",successfullyImported:"Se importaron exitosamente {count} transacciones bancarias",errorImportingTransactions:"Error al importar transacciones. Verifique sus datos.",importBankStatementCSV:"Importar CSV de Estado Bancario",dropCSVHere:"Suelte el archivo CSV aquí",clickToUploadCSV:"Haga clic para cargar o arrastre y suelte el archivo CSV",supportedFormat:"Formato soportado: CSV con columnas de Fecha, Descripción y Monto",mapCSVColumns:"Mapear Columnas CSV",dateColumn:"Columna de Fecha",selectColumn:"Seleccionar columna...",descriptionColumn:"Columna de Descripción",referenceColumn:"Columna de Referencia",amountDebitColumn:"Columna de Monto/Débito",creditColumn:"Columna de Crédito",balanceColumn:"Columna de Saldo",andMoreRows:"... y {count} filas más",importing:"Importando...",importTransactions:"Importar {count} Transacciones",reconciliationComparison:"Comparación de Conciliación",bankStatements:"Estados Bancarios",totalTransactions:"Transacciones totales",totalEntries:"Entradas totales",unreconciledBank:"Banco No Conciliado",unreconciledBooks:"Libros No Conciliados",needAttention:"Necesitan atención",unreconcile:"Desconciliar",clickToReconcile:"Hacer clic para conciliar",potentialMatchesFound:"Coincidencias Potenciales Encontradas",clickRecordToReconcile:"Haga clic en un registro a continuación para conciliar",exactMatch:"Coincidencia Exacta",possibleMatch:"Posible Coincidencia",selected:"Seleccionado",clearSelection:"Limpiar Selección"},journal:{title:"Asientos Contables",entryNumber:"Número de Asiento",entryDate:"Fecha del Asiento",debit:"Débito",credit:"Crédito",account:"Cuenta",memo:"Memo",reference:"Referencia",createEntry:"Crear Asiento",editEntry:"Editar Asiento",deleteEntry:"Eliminar Asiento",posted:"Registrado",draft:"Borrador",reversed:"Revertido",recurringEntry:"Asiento Recurrente",attachments:"Adjuntos",totalDebits:"Débitos Totales",totalCredits:"Créditos Totales",outOfBalance:"Desbalanceado",balanced:"Balanceado"},forms:{requiredField:"Este campo es requerido",invalidEmail:"Dirección de correo inválida",invalidNumber:"Número inválido",invalidDate:"Fecha inválida",selectOption:"Por favor seleccione una opción",enterValue:"Por favor ingrese un valor",confirmDelete:"¿Está seguro de que desea eliminar este elemento?",unsavedChanges:"Tiene cambios sin guardar. ¿Desea continuar?",saveSuccess:"Guardado exitosamente",saveError:"Error al guardar datos",deleteSuccess:"Eliminado exitosamente",deleteError:"Error al eliminar elemento",duplicateAccountNumber:"El número de cuenta ya existe"},modals:{addInventory:"Agregar Movimiento de Inventario",bulkMovement:"Movimiento Masivo de Inventario",addProduct:"Agregar Nuevo Producto",addLocation:"Agregar Nueva Ubicación",inventoryDetail:"Detalles del Artículo de Inventario",quickAdd:"Agregar Rápido",selectProduct:"Seleccionar Producto",selectLocation:"Seleccionar Ubicación",enterQuantity:"Ingresar cantidad",enterCost:"Ingresar costo unitario",enterReference:"Ingresar número de referencia",addNotes:"Agregar notas (opcional)",generalInformation:"Información General",stockInformation:"Información de Stock",locationInformation:"Información de Ubicación",movementInformation:"Información de Movimiento",addToInventory:"Agregar al Inventario",createProduct:"Crear Producto",createLocation:"Crear Ubicación",processing:"Procesando...",addingMovement:"Agregando movimiento...",creatingProduct:"Creando producto...",creatingLocation:"Creando ubicación..."},products:{title:"Productos",addNew:"Agregar Nuevo Producto",totalProducts:"Total de Productos",inCatalog:"En catálogo",activeProducts:"Productos Activos",currentlyAvailable:"Actualmente disponibles",outOfStock:"Sin Stock",needsRestock:"Necesita reabastecimiento",productCatalog:"Catálogo de Productos",manageYourProducts:"Gestiona tus productos y precios",inStock:"En Stock",furniture:"Muebles",electronics:"Electrónicos",supplies:"Suministros",lighting:"Iluminación"},invoices:{title:"Facturas",createNew:"Crear Nueva Factura",totalOutstanding:"Total Pendiente",unpaidInvoices:"Facturas no pagadas",thisMonth:"Este Mes",revenueCollected:"Ingresos recaudados",overdue:"Vencidas",pastDueInvoices:"Facturas vencidas",recentInvoices:"Facturas Recientes",latestBillingActivity:"Actividad de facturación reciente",paid:"Pagado",pending:"Pendiente"}}},ZP=()=>{if(typeof window<"u"){const t=localStorage.getItem("hrmfinance-language");if(t&&["en","es"].includes(t))return t}return"en"},[fh,ew]=fe(ZP()),pt=()=>({t:(n,i,o)=>{const a=fh(),c=n.split(".");let u=XP[a];for(const f of c)if(u&&typeof u=="object"&&f in u)u=u[f];else return i||n;let h=typeof u=="string"?u:i||n;return o&&typeof h=="string"&&Object.keys(o).forEach(f=>{const p=o[f],_=`{{${f}}}`;h=h.replace(new RegExp(_,"g"),String(p))}),h},language:()=>fh(),setLanguage:n=>{ew(n),typeof window<"u"&&localStorage.setItem("hrmfinance-language",n)}});var tw=U("<div><label></label><select><option value>"),rw=U("<span>*"),nw=U("<option>");const _r=t=>{const{t:e}=pt(),r={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},n={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},i={"margin-bottom":"1rem"};return(()=>{var o=tw(),a=o.firstChild,c=a.nextSibling,u=c.firstChild;return d(o,i),d(a,r),s(a,()=>t.label,null),s(a,(()=>{var h=oe(()=>!!t.required);return()=>h()&&(()=>{var f=rw();return f.style.setProperty("color","var(--primary-color)"),f})()})(),null),c.addEventListener("blur",h=>h.target.style.borderColor="var(--border-color)"),c.addEventListener("focus",h=>h.target.style.borderColor="var(--primary-color)"),c.addEventListener("change",h=>t.onChange(h.target.value)),d(c,n),s(u,()=>e("forms.selectOption")),s(c,()=>t.options.map(h=>(()=>{var f=nw();return s(f,()=>h.label),K(()=>f.value=h.value),f})()),null),K(h=>{var f=t.required,p=t.disabled;return f!==h.e&&(c.required=h.e=f),p!==h.t&&(c.disabled=h.t=p),h},{e:void 0,t:void 0}),K(()=>c.value=t.value),o})()};var iw=U("<div><span></span><select><option value=en>🇺🇸 </option><option value=es>🇪🇸 ");const Vy=()=>{const{t,language:e,setLanguage:r}=pt(),n={display:"flex","align-items":"center",gap:"0.5rem","margin-left":"auto"},i={padding:"0.5rem 1rem","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",background:"var(--surface-color)",color:"var(--text-primary)",cursor:"pointer","font-size":"0.875rem","font-weight":"500",transition:"all 0.2s ease","min-width":"120px"},o={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},a=c=>{const u=c.target;r(u.value)};return(()=>{var c=iw(),u=c.firstChild,h=u.nextSibling,f=h.firstChild;f.firstChild;var p=f.nextSibling;return p.firstChild,d(c,n),d(u,o),h.addEventListener("change",a),d(h,i),s(f,()=>t("common.english"),null),s(p,()=>t("common.spanish"),null),K(()=>h.value=e()),c})()};var ow=U("<main><div>"),sw=U("<header><h1>");const Wr=t=>{const e={"min-height":"100vh",background:"var(--background-color)"},r={"max-width":"1200px",margin:"0 auto",padding:"2rem"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},i={"font-size":"2rem","font-weight":"700",color:"var(--text-primary)",margin:"0"};return(()=>{var o=ow(),a=o.firstChild;return d(o,e),d(a,r),s(a,(()=>{var c=oe(()=>!!t.title);return()=>c()&&(()=>{var u=sw(),h=u.firstChild;return d(u,n),d(h,i),s(h,()=>t.title),s(u,b(Vy,{}),null),u})()})(),null),s(a,()=>t.children,null),o})()};var aw=U('<img alt="User avatar">'),lw=U("<div><span>"),cw=U("<button>Sign Out"),uw=U(`<nav><div><div><div></div></div><div></div></div><style>
        .nav-active {
          background: linear-gradient(135deg, var(--primary-color), var(--primary-dark)) !important;
          color: white !important;
          box-shadow: var(--shadow-sm);
        }
        
        nav a:hover:not(.nav-active) {
          background: var(--background-color);
          color: var(--text-primary);
        }
        
        @media (max-width: 768px) {
          nav div:first-child {
            flex-direction: column;
            gap: 1rem;
            padding: 1rem;
          }
          
          nav div:last-child {
            flex-wrap: wrap;
            justify-content: center;
          }
        }
      `);const dw=()=>{const{t}=pt(),e={background:"var(--surface-color)","border-bottom":"1px solid var(--border-color)","box-shadow":"var(--shadow-sm)","backdrop-filter":"blur(10px)",position:"sticky",top:"0","z-index":"100"},r={display:"flex","align-items":"center","justify-content":"space-between",padding:"1rem 2rem",margin:"0 auto"},n={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","text-decoration":"none","margin-right":"2rem"},i={display:"flex",gap:"0.5rem","align-items":"center"},o={"text-decoration":"none",color:"var(--text-secondary)",padding:"0.5rem 1rem","border-radius":"var(--border-radius-sm)","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease","white-space":"nowrap"},a={display:"flex","align-items":"center",gap:"1rem"},c={display:"flex","align-items":"center",gap:"0.75rem",padding:"0.5rem 1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",color:"var(--text-primary)"},u={width:"32px",height:"32px","border-radius":"50%","object-fit":"cover"},h={...o,cursor:"pointer",border:"1px solid var(--border-color)",background:"transparent"},f=()=>{sr.signOut()},p=_=>{const E=sr.state?.profile;return E?E[_]===!0:!1};return(()=>{var _=uw(),E=_.firstChild,A=E.firstChild,T=A.firstChild,x=A.nextSibling;return d(E,r),A.style.setProperty("display","flex"),A.style.setProperty("align-items","center"),A.style.setProperty("flex","1"),s(A,b(wn,{href:"/",style:n,children:"HRM Finance"}),T),d(T,i),s(T,b(wn,{href:"/",style:o,activeClass:"nav-active",get children(){return t("navigation.dashboard")}}),null),s(T,b(Ge,{get when(){return p("AccountAccess")},get children(){return b(wn,{href:"/accounts",style:o,activeClass:"nav-active",get children(){return t("navigation.accounts")}})}}),null),s(T,b(Ge,{get when(){return p("JournalAccess")},get children(){return b(wn,{href:"/entry-books",style:o,activeClass:"nav-active",get children(){return t("navigation.entryBooks")}})}}),null),s(T,b(Ge,{get when(){return p("EmployeeAccess")},get children(){return b(wn,{href:"/employees",style:o,activeClass:"nav-active",get children(){return t("navigation.employees")}})}}),null),s(T,b(Ge,{get when(){return p("BankingAccess")},get children(){return b(wn,{href:"/bank-consolidations",style:o,activeClass:"nav-active",get children(){return t("navigation.consolidate")}})}}),null),s(T,b(Ge,{get when(){return p("AccountAccess")},get children(){return b(wn,{href:"/balance-sheet",style:o,activeClass:"nav-active",get children(){return t("navigation.balanceSheet")}})}}),null),s(T,b(Ge,{get when(){return p("InventoryAccess")},get children(){return b(wn,{href:"/inventory",style:o,activeClass:"nav-active",get children(){return t("navigation.inventory")}})}}),null),d(x,a),s(x,b(Vy,{}),null),s(x,b(Ge,{get when(){return sr.currentUser},get children(){return[(()=>{var $=lw(),O=$.firstChild;return d($,c),s($,b(Ge,{get when(){return sr.currentUser?.photoURL},get children(){var q=aw();return K(z=>{var ee=sr.currentUser.photoURL,Q=u;return ee!==z.e&&gt(q,"src",z.e=ee),z.t=d(q,Q,z.t),z},{e:void 0,t:void 0}),q}}),O),$})(),(()=>{var $=cw();return $.addEventListener("mouseleave",O=>{O.currentTarget.style.background="transparent",O.currentTarget.style.color="var(--text-secondary)"}),$.addEventListener("mouseenter",O=>{O.currentTarget.style.background="var(--background-color)",O.currentTarget.style.color="var(--text-primary)"}),$.$$click=f,K(O=>d($,h,O)),$})()]}}),null),K($=>d(_,e,$)),_})()};Ot(["click"]);var hw=U("<div><div><div>🔒</div><h1>Access Denied</h1><p>You don't have permission to access <!>.</p><div><p><strong>Why am I seeing this?</strong><br>Your account doesn't have the necessary permissions to view this content. </p></div><div><button>Go Back</button></div><div><h3>Features you can access:</h3><div><span>✓</span><span>Dashboard and overview statistics</span></div><div><span>✓</span><span>Your profile and settings</span></div><div><span>✓</span><span>Features enabled for your role</span></div></div><div><p>Need access? Contact your administrator or manager to request the appropriate permissions."),yh=U("<br>"),mw=U("<strong>Required permission:");const fw=t=>{const e={"min-height":"calc(100vh - 200px)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},r={"text-align":"center","max-width":"600px",width:"100%"},n={"font-size":"5rem",color:"#e53e3e","margin-bottom":"2rem"},i={"font-size":"2.5rem","font-weight":"700",color:"#1a202c","margin-bottom":"1rem"},o={"font-size":"1.25rem",color:"#718096","margin-bottom":"2rem","line-height":"1.6"},a={background:"#f7fafc",border:"1px solid #e2e8f0","border-radius":"0.5rem",padding:"1.5rem","margin-bottom":"2rem"},c={color:"#4a5568","font-size":"1rem","line-height":"1.6"},u={display:"flex",gap:"1rem","justify-content":"center","flex-wrap":"wrap"},h={padding:"0.75rem 2rem","border-radius":"0.5rem","text-decoration":"none","font-weight":"500",transition:"all 0.2s",display:"inline-block"},f={...h,background:"var(--primary-color)",color:"white",border:"2px solid var(--primary-color)"},p={...h,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},_={"text-align":"left","margin-top":"2rem",padding:"0 2rem"},E={display:"flex","align-items":"center",gap:"0.75rem","margin-bottom":"1rem",color:"#4a5568"},A={color:"#48bb78","font-size":"1.25rem"};return b(Wr,{title:"Access Restricted",get children(){var T=hw(),x=T.firstChild,$=x.firstChild,O=$.nextSibling,q=O.nextSibling,z=q.firstChild,ee=z.nextSibling;ee.nextSibling;var Q=q.nextSibling,C=Q.firstChild,v=C.firstChild,S=v.nextSibling;S.nextSibling;var w=Q.nextSibling,P=w.firstChild,I=w.nextSibling,y=I.firstChild,le=y.nextSibling,B=le.firstChild,k=le.nextSibling,W=k.firstChild,R=k.nextSibling,V=R.firstChild,M=I.nextSibling,F=M.firstChild;return d(T,e),d(x,r),d($,n),d(O,i),d(q,o),s(q,()=>t.featureName?` ${t.featureName}`:" this feature",ee),d(Q,a),d(C,c),s(C,(()=>{var ne=oe(()=>!!t.requiredPermission);return()=>ne()&&[yh(),yh(),mw()," ",oe(()=>t.requiredPermission)]})(),null),d(w,u),s(w,b(wn,{href:"/",style:f,children:"Go to Dashboard"}),P),P.$$click=()=>window.history.back(),d(I,_),y.style.setProperty("margin-bottom","1rem"),y.style.setProperty("color","#2d3748"),M.style.setProperty("margin-top","3rem"),M.style.setProperty("padding","1.5rem"),M.style.setProperty("background","#edf2f7"),M.style.setProperty("border-radius","0.5rem"),F.style.setProperty("color","#4a5568"),F.style.setProperty("font-size","0.875rem"),K(ne=>{var L=p,j=E,Z=A,te=E,he=A,se=E,re=A;return ne.e=d(P,L,ne.e),ne.t=d(le,j,ne.t),ne.a=d(B,Z,ne.a),ne.o=d(k,te,ne.o),ne.i=d(W,he,ne.i),ne.n=d(R,se,ne.n),ne.s=d(V,re,ne.s),ne},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),T}})};Ot(["click"]);const _n=t=>{const e=()=>{if(!t.permission)return!0;const r=sr.state?.profile;if(!r)return!1;switch(t.permission){case"AccountAccess":return r.AccountAccess===!0;case"InventoryAccess":return r.InventoryAccess===!0;case"EmployeeAccess":return r.EmployeeAccess===!0;case"BankingAccess":return r.BankingAccess===!0;case"JournalAccess":return r.JournalAccess===!0;case"AdminAccess":return r.isAdmin===!0;default:return r[t.permission]===!0}};return b(Ge,{get when(){return e()},get fallback(){return t.fallback||b(fw,{get featureName(){return t.featureName},get requiredPermission(){return t.requiredPermission}})},get children(){return t.children}})};var yw=U('<button title="Open Dev Tools">🛠️'),gw=U("<span>(<!>)"),pw=U("<div><span></span><span>"),gh=U("<div>"),vw=U("<div>Database reset only available in fake mode"),bw=U("<div><div>Loading..."),_w=U("<div><div><h3>🛠️ Dev Tools</h3><button>✕</button></div><div><div>API Mode</div><div><button>Fake Server</button><button>Real API</button><button>Hybrid</button></div><div>Current: <strong></strong></div></div><div><div>Health Status</div></div><div><div>Database Stats</div></div><div><div>Actions</div><div><button>🔄 Refresh Stats</button><button>💊 Health Check</button></div><div><button>🗑️ Reset DB</button></div></div><div><div>Info</div><div>• <strong>Fake Server:</strong> Uses local mock data<br>• <strong>Real API:</strong> Connects to actual backend<br>• <strong>Hybrid:</strong> Real API with fake fallback<br>• Settings are saved in localStorage"),Sw=U("<div>Loading..."),Pw=U("<div><span>:</span><span>");const ww=()=>{const[t,e]=fe(!1),[r,n]=fe(Ko.getMode()),[i,o]=fe({}),[a,c]=fe(null),[u,h]=fe(!1);yn(async()=>{await f(),await p()});const f=async()=>{try{const C=await ju.getStats();o(C)}catch(C){console.error("Failed to load stats:",C)}},p=async()=>{try{const C=await ju.healthCheck();c(C)}catch(C){console.error("Health check failed:",C),c({status:"error",error:C.message})}},_=async C=>{h(!0);try{Ko.setMode(C),n(C),await f(),await p()}catch(v){console.error("Failed to change API mode:",v)}finally{h(!1)}},E=async()=>{if(confirm("Are you sure you want to reset the fake database to its initial state?")){h(!0);try{const C=await Or.utils.resetDatabase();alert(C.message),await f()}catch(C){console.error("Failed to reset database:",C),alert("Failed to reset database")}finally{h(!1)}}},A={position:"fixed",bottom:"20px",right:"20px","z-index":"10000","font-family":"monospace"},T={background:"#1a1a1a",color:"#fff",border:"1px solid #333","border-radius":"8px",padding:"16px","min-width":"300px","max-width":"400px","box-shadow":"0 4px 20px rgba(0,0,0,0.3)"},x={background:"#007acc",color:"#fff",border:"none","border-radius":"50%",width:"50px",height:"50px",cursor:"pointer","font-size":"20px","box-shadow":"0 2px 10px rgba(0,0,0,0.2)",display:"flex","align-items":"center","justify-content":"center"},$={background:"#333",color:"#fff",border:"1px solid #555","border-radius":"4px",padding:"6px 12px",cursor:"pointer","font-size":"12px","margin-right":"8px","margin-bottom":"8px"},O={...$,background:"#007acc","border-color":"#007acc"},q={"margin-bottom":"16px","padding-bottom":"12px","border-bottom":"1px solid #333"},z={"font-size":"14px","font-weight":"bold","margin-bottom":"8px",color:"#007acc"},ee={display:"flex","justify-content":"space-between","font-size":"12px","margin-bottom":"4px"},Q=C=>({display:"inline-block",width:"8px",height:"8px","border-radius":"50%","margin-right":"8px",background:C==="healthy"?"#00ff00":C==="error"?"#ff0000":"#ffff00"});return(()=>{var C=gh();return s(C,b(Ge,{get when(){return!t()},get children(){var v=yw();return v.$$click=()=>e(!0),d(v,x),v}}),null),s(C,b(Ge,{get when(){return t()},get children(){var v=_w(),S=v.firstChild,w=S.firstChild,P=w.nextSibling,I=S.nextSibling,y=I.firstChild,le=y.nextSibling,B=le.firstChild,k=B.nextSibling,W=k.nextSibling,R=le.nextSibling,V=R.firstChild,M=V.nextSibling,F=I.nextSibling,ne=F.firstChild,L=F.nextSibling,j=L.firstChild,Z=L.nextSibling,te=Z.firstChild,he=te.nextSibling,se=he.firstChild,re=se.nextSibling,ye=he.nextSibling,G=ye.firstChild,ae=Z.nextSibling,Pe=ae.firstChild,we=Pe.nextSibling;return d(v,T),S.style.setProperty("display","flex"),S.style.setProperty("justify-content","space-between"),S.style.setProperty("align-items","center"),S.style.setProperty("margin-bottom","16px"),w.style.setProperty("margin","0"),w.style.setProperty("color","#007acc"),w.style.setProperty("font-size","16px"),P.$$click=()=>e(!1),B.$$click=()=>_("fake"),k.$$click=()=>_("real"),W.$$click=()=>_("hybrid"),R.style.setProperty("font-size","11px"),R.style.setProperty("color","#888"),R.style.setProperty("margin-top","4px"),s(M,r),s(R,()=>r()==="fake"&&" (Using fake server)",null),s(R,()=>r()==="real"&&" (Using real API)",null),s(R,()=>r()==="hybrid"&&" (Real API with fallback)",null),s(F,b(Ge,{get when(){return a()},get fallback(){return(()=>{var ue=Sw();return ue.style.setProperty("font-size","12px"),ue})()},get children(){return[(()=>{var ue=pw(),ce=ue.firstChild,H=ce.nextSibling;return ue.style.setProperty("display","flex"),ue.style.setProperty("align-items","center"),ue.style.setProperty("font-size","12px"),s(H,()=>a()?.status||"Unknown"),s(ue,b(Ge,{get when(){return a()?.timestamp},get children(){var de=gw(),X=de.firstChild,_e=X.nextSibling;return _e.nextSibling,de.style.setProperty("margin-left","8px"),de.style.setProperty("color","#888"),s(de,()=>new Date(a().timestamp).toLocaleTimeString(),_e),de}}),null),K(de=>d(ce,Q(a()?.status||"unknown"),de)),ue})(),b(Ge,{get when(){return a()?.error},get children(){var ue=gh();return ue.style.setProperty("font-size","11px"),ue.style.setProperty("color","#ff6666"),ue.style.setProperty("margin-top","4px"),s(ue,()=>a().error),ue}})]}}),null),s(L,b(jt,{get each(){return Object.entries(i())},children:([ue,ce])=>(()=>{var H=Pw(),de=H.firstChild,X=de.firstChild,_e=de.nextSibling;return d(H,ee),de.style.setProperty("text-transform","capitalize"),s(de,ue,X),_e.style.setProperty("color","#00ff00"),s(_e,ce),H})()}),null),se.$$click=f,re.$$click=p,ye.style.setProperty("margin-top","8px"),G.$$click=E,s(Z,b(Ge,{get when(){return r()!=="fake"},get children(){var ue=vw();return ue.style.setProperty("font-size","11px"),ue.style.setProperty("color","#888"),ue.style.setProperty("margin-top","4px"),ue}}),null),we.style.setProperty("font-size","11px"),we.style.setProperty("color","#888"),we.style.setProperty("line-height","1.4"),s(v,b(Ge,{get when(){return u()},get children(){var ue=bw(),ce=ue.firstChild;return ue.style.setProperty("position","absolute"),ue.style.setProperty("top","0"),ue.style.setProperty("left","0"),ue.style.setProperty("right","0"),ue.style.setProperty("bottom","0"),ue.style.setProperty("background","rgba(0,0,0,0.7)"),ue.style.setProperty("display","flex"),ue.style.setProperty("align-items","center"),ue.style.setProperty("justify-content","center"),ue.style.setProperty("border-radius","8px"),ce.style.setProperty("color","#fff"),ce.style.setProperty("font-size","14px"),ue}}),null),K(ue=>{var ce={...$,padding:"4px 8px"},H=q,de=z,X=r()==="fake"?O:$,_e=u(),Se=r()==="real"?O:$,Y=u(),ie=r()==="hybrid"?O:$,Ie=u(),pe=q,me=z,J=q,D=z,ge=q,ke=z,Ee=$,Te=u(),De=$,Ke=u(),Me={...$,background:"#cc4400","border-color":"#cc4400"},ve=u()||r()!=="fake",Le=z;return ue.e=d(P,ce,ue.e),ue.t=d(I,H,ue.t),ue.a=d(y,de,ue.a),ue.o=d(B,X,ue.o),_e!==ue.i&&(B.disabled=ue.i=_e),ue.n=d(k,Se,ue.n),Y!==ue.s&&(k.disabled=ue.s=Y),ue.h=d(W,ie,ue.h),Ie!==ue.r&&(W.disabled=ue.r=Ie),ue.d=d(F,pe,ue.d),ue.l=d(ne,me,ue.l),ue.u=d(L,J,ue.u),ue.c=d(j,D,ue.c),ue.w=d(Z,ge,ue.w),ue.m=d(te,ke,ue.m),ue.f=d(se,Ee,ue.f),Te!==ue.y&&(se.disabled=ue.y=Te),ue.g=d(re,De,ue.g),Ke!==ue.p&&(re.disabled=ue.p=Ke),ue.b=d(G,Me,ue.b),ve!==ue.T&&(G.disabled=ue.T=ve),ue.A=d(Pe,Le,ue.A),ue},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),v}}),null),K(v=>d(C,A,v)),C})()};Ot(["click"]);var Cw=U("<div>$124,350"),Aw=U("<div>+12% from last month"),Iw=U("<div>247"),Ui=U("<div>"),Ew=U("<div>18"),xw=U("<div>$89,250"),Tw=U("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>");const $w=()=>{const{t}=pt(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},n={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)",margin:"0.5rem 0"},i={"font-size":"0.875rem",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"};return b(Wr,{get title(){return t("dashboard.title")},get children(){return[(()=>{var o=Ui();return d(o,e),s(o,b(tt,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var a=Cw();return K(c=>d(a,n,c)),a})(),(()=>{var a=Aw();return K(c=>d(a,i,c)),a})()]}}),null),s(o,b(tt,{get title(){return t("dashboard.employeeCount")},get subtitle(){return t("dashboard.current")},get children(){return[(()=>{var a=Iw();return K(c=>d(a,n,c)),a})(),(()=>{var a=Ui();return s(a,()=>t("dashboard.newHires")),K(c=>d(a,i,c)),a})()]}}),null),s(o,b(tt,{get title(){return t("dashboard.pendingInvoices")},get subtitle(){return t("dashboard.outstanding")},get children(){return[(()=>{var a=Ew();return K(c=>d(a,n,c)),a})(),(()=>{var a=Ui();return s(a,()=>t("dashboard.totalOutstanding")),K(c=>d(a,i,c)),a})()]}}),null),s(o,b(tt,{get title(){return t("dashboard.cashBalance")},get subtitle(){return t("accounts.title")},get children(){return[(()=>{var a=xw();return K(c=>d(a,n,c)),a})(),(()=>{var a=Ui();return s(a,()=>t("dashboard.lastUpdatedToday")),K(c=>d(a,i,c)),a})()]}}),null),o})(),(()=>{var o=Ui();return d(o,r),s(o,b(tt,{get title(){return t("dashboard.quickActions")},get subtitle(){return t("dashboard.commonTasks")},get children(){var a=Ui();return a.style.setProperty("display","flex"),a.style.setProperty("flex-direction","column"),a.style.setProperty("gap","1rem"),s(a,b(Oe,{variant:"primary",get children(){return t("invoices.createNew")}}),null),s(a,b(Oe,{variant:"secondary",get children(){return t("employees.addEmployee")}}),null),s(a,b(Oe,{variant:"outline",get children(){return t("dashboard.generateReport")}}),null),a}}),null),s(o,b(tt,{get title(){return t("dashboard.recentActivity")},get subtitle(){return t("dashboard.latestUpdates")},get children(){var a=Tw(),c=a.firstChild,u=c.firstChild,h=u.nextSibling,f=c.nextSibling,p=f.firstChild,_=p.nextSibling,E=f.nextSibling,A=E.firstChild,T=A.nextSibling;return a.style.setProperty("display","flex"),a.style.setProperty("flex-direction","column"),a.style.setProperty("gap","0.75rem"),c.style.setProperty("border-bottom","1px solid var(--border-color)"),c.style.setProperty("padding-bottom","0.5rem"),u.style.setProperty("font-weight","500"),s(u,()=>t("dashboard.invoicePaid")),h.style.setProperty("font-size","0.875rem"),h.style.setProperty("color","var(--text-muted)"),s(h,()=>t("dashboard.hoursAgo")),f.style.setProperty("border-bottom","1px solid var(--border-color)"),f.style.setProperty("padding-bottom","0.5rem"),p.style.setProperty("font-weight","500"),s(p,()=>t("dashboard.newEmployeeOnboarded")),_.style.setProperty("font-size","0.875rem"),_.style.setProperty("color","var(--text-muted)"),s(_,()=>t("dashboard.dayAgo")),A.style.setProperty("font-weight","500"),s(A,()=>t("dashboard.monthlyReportGenerated")),T.style.setProperty("font-size","0.875rem"),T.style.setProperty("color","var(--text-muted)"),s(T,()=>t("dashboard.daysAgo")),a}}),null),o})()]}})},kw=[{id:"1",accountNumber:"1000",name:"Cash and Cash Equivalents",type:"Asset",category:"Current Assets",description:"Cash on hand and in bank accounts",balance:45230.5,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1001",accountNumber:"1001",name:"Petty Cash",type:"Asset",category:"Current Assets",description:"Small amounts of cash for minor expenses",balance:500,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1002",accountNumber:"1002",name:"Bank - Checking Account",type:"Asset",category:"Current Assets",description:"Main operating checking account",balance:32730.5,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1003",accountNumber:"1003",name:"Bank - Savings Account",type:"Asset",category:"Current Assets",description:"Interest-bearing savings account",balance:12e3,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"2",accountNumber:"1100",name:"Accounts Receivable",type:"Asset",category:"Current Assets",description:"Money owed by customers",balance:23450.75,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2001",accountNumber:"1101",name:"Trade Receivables",type:"Asset",category:"Current Assets",description:"Receivables from regular customers",balance:18450.75,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2002",accountNumber:"1102",name:"Employee Advances",type:"Asset",category:"Current Assets",description:"Money advanced to employees",balance:5e3,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"3",accountNumber:"1200",name:"Inventory",type:"Asset",category:"Current Assets",description:"Products held for sale",balance:78920.25,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-13"},{id:"4",accountNumber:"1500",name:"Equipment",type:"Asset",category:"Fixed Assets",description:"Office equipment and machinery",balance:125e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-12"},{id:"5",accountNumber:"2000",name:"Accounts Payable",type:"Liability",category:"Current Liabilities",description:"Money owed to suppliers",balance:15670.3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-11"},{id:"6",accountNumber:"2100",name:"Accrued Expenses",type:"Liability",category:"Current Liabilities",description:"Expenses incurred but not yet paid",balance:8945.6,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-10"},{id:"7",accountNumber:"2500",name:"Long-term Debt",type:"Liability",category:"Long-term Liabilities",description:"Long-term loans and mortgages",balance:85e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-09"},{id:"8",accountNumber:"3000",name:"Owner's Equity",type:"Equity",category:"Owner's Equity",description:"Owner's investment in the business",balance:15e4,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-08"},{id:"9",accountNumber:"3100",name:"Retained Earnings",type:"Equity",category:"Owner's Equity",description:"Accumulated profits retained in business",balance:32450.8,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-07"},{id:"10",accountNumber:"4000",name:"Sales Revenue",type:"Revenue",category:"Operating Revenue",description:"Revenue from product sales",balance:245678.9,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-06"},{id:"11",accountNumber:"4100",name:"Service Revenue",type:"Revenue",category:"Operating Revenue",description:"Revenue from services provided",balance:89432.15,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-05"},{id:"12",accountNumber:"5000",name:"Cost of Goods Sold",type:"Expense",category:"Operating Expenses",description:"Direct costs of producing goods",balance:125678.45,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-04"},{id:"13",accountNumber:"5100",name:"Salaries Expense",type:"Expense",category:"Operating Expenses",description:"Employee salary expenses",balance:98765.32,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-03"},{id:"14",accountNumber:"5200",name:"Rent Expense",type:"Expense",category:"Operating Expenses",description:"Office rent expenses",balance:24e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-02"}],Rw=[{id:"1",accountId:"1",date:"2024-01-15",description:"Customer payment received",debitAmount:5e3,creditAmount:0,reference:"INV-2024-001",type:"debit"},{id:"2",accountId:"2",date:"2024-01-15",description:"Customer payment received",debitAmount:0,creditAmount:5e3,reference:"INV-2024-001",type:"credit"},{id:"3",accountId:"5",date:"2024-01-14",description:"Office supplies purchased",debitAmount:0,creditAmount:1250,reference:"PO-2024-001",type:"credit"}],[nn,Ds]=fe(kw),[fl,Dw]=fe(Rw),St={get accounts(){return nn()},get transactions(){return fl()},fetchAllAccount(t){const e={...t,id:Date.now().toString(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return Ds([...nn(),e]),e},addAccount(t){const e={...t,id:Date.now().toString(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return Ds([...nn(),e]),e},updateAccount(t,e){Ds(nn().map(r=>r.id===t?{...r,...e,lastModified:new Date().toISOString().split("T")[0]}:r))},deleteAccount(t){Ds(nn().filter(e=>e.id!==t))},getAccountById(t){return nn().find(e=>e.id===t)},getAccountsByType(t){return nn().filter(e=>e.type===t)},getAccountTransactions(t){return fl().filter(e=>e.accountId===t)},addTransaction(t){const e={...t,id:Date.now().toString()};Dw([...fl(),e]);const r=this.getAccountById(t.accountId);if(r){const n=t.type==="debit"?t.debitAmount:-t.creditAmount;this.updateAccount(t.accountId,{balance:r.balance+n})}return e},getTotalByType(t){return nn().filter(e=>e.type===t&&e.isActive).reduce((e,r)=>e+r.balance,0)},getAccountCategories(t){const e=this.getAccountsByType(t);return[...new Set(e.map(r=>r.category))]},getSubAccounts(t){return nn().filter(e=>e.parentAccountId===t)},getParentAccounts(){return nn().filter(t=>!t.parentAccountId)},getAccountHierarchy(){return this.getParentAccounts().map(e=>({...e,subAccounts:this.getSubAccounts(e.id)}))},getAccountWithSubAccounts(t){const e=this.getAccountById(t);return e?{...e,subAccounts:this.getSubAccounts(t),parentAccount:e.parentAccountId?this.getAccountById(e.parentAccountId):null}:null},getAccountPath(t){const e=this.getAccountById(t);if(!e)return[];const r=[e];let n=e;for(;n.parentAccountId;){const i=this.getAccountById(n.parentAccountId);if(i)r.unshift(i),n=i;else break}return r},getTotalBalanceWithSubAccounts(t){const e=this.getAccountById(t);if(!e)return 0;const n=this.getSubAccounts(t).reduce((i,o)=>i+this.getTotalBalanceWithSubAccounts(o.id),0);return e.balance+n},canDeleteAccount(t){const e=this.getSubAccounts(t);if(e.length>0)return{canDelete:!1,reason:`Account has ${e.length} sub-account(s). Delete or move sub-accounts first.`};const r=this.getAccountTransactions(t);return r.length>0?{canDelete:!1,reason:`Account has ${r.length} transaction(s). Cannot delete account with transaction history.`}:{canDelete:!0}}};var jn=U("<div>"),wo=U("<div> ");const Nw=()=>{const{t}=pt(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},n={"font-size":"0.875rem",color:"var(--text-muted)"},i=T=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(T),o=St.getTotalByType("Asset"),a=St.getTotalByType("Liability"),c=St.getTotalByType("Equity"),u=St.getTotalByType("Revenue"),h=St.getTotalByType("Expense"),f=St.getAccountsByType("Asset").length,p=St.getAccountsByType("Liability").length,_=St.getAccountsByType("Equity").length,E=St.getAccountsByType("Revenue").length,A=St.getAccountsByType("Expense").length;return(()=>{var T=jn();return d(T,e),s(T,b(tt,{get title(){return t("dashboard.totalAssets")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var x=jn();return s(x,()=>i(o)),K($=>d(x,r,$)),x})(),(()=>{var x=wo(),$=x.firstChild;return s(x,f,$),s(x,()=>t("navigation.accounts"),null),K(O=>d(x,n,O)),x})()]}}),null),s(T,b(tt,{get title(){return t("dashboard.totalLiabilities")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var x=jn();return s(x,()=>i(a)),K($=>d(x,r,$)),x})(),(()=>{var x=wo(),$=x.firstChild;return s(x,p,$),s(x,()=>t("navigation.accounts"),null),K(O=>d(x,n,O)),x})()]}}),null),s(T,b(tt,{get title(){return t("dashboard.totalEquity")},get subtitle(){return t("accounts.categories.ownersEquity")},get children(){return[(()=>{var x=jn();return s(x,()=>i(c)),K($=>d(x,r,$)),x})(),(()=>{var x=wo(),$=x.firstChild;return s(x,_,$),s(x,()=>t("navigation.accounts"),null),K(O=>d(x,n,O)),x})()]}}),null),s(T,b(tt,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("accounts.categories.operatingRevenue")},get children(){return[(()=>{var x=jn();return s(x,()=>i(u)),K($=>d(x,r,$)),x})(),(()=>{var x=wo(),$=x.firstChild;return s(x,E,$),s(x,()=>t("navigation.accounts"),null),K(O=>d(x,n,O)),x})()]}}),null),s(T,b(tt,{get title(){return t("dashboard.totalExpenses")},get subtitle(){return t("accounts.categories.operatingExpenses")},get children(){return[(()=>{var x=jn();return s(x,()=>i(h)),K($=>d(x,r,$)),x})(),(()=>{var x=wo(),$=x.firstChild;return s(x,A,$),s(x,()=>t("navigation.accounts"),null),K(O=>d(x,n,O)),x})()]}}),null),s(T,b(tt,{get title(){return t("dashboard.netIncome")},get subtitle(){return`${t("dashboard.totalRevenue")} - ${t("dashboard.totalExpenses")}`},get children(){return[(()=>{var x=jn();return s(x,()=>i(u-h)),K($=>d(x,{...r,color:u-h>=0?"#4caf50":"#f44336"},$)),x})(),(()=>{var x=jn();return s(x,()=>u-h>=0?t("dashboard.netIncome"):t("dashboard.netLoss")),K($=>d(x,n,$)),x})()]}}),null),T})()};var Lw=U("<div><div></div><div>"),Mw=U("<h3>"),Co=U("<div>");const Ow=t=>{const{t:e}=pt();gc();const r={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},i={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"},o={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},a={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},c={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem"},u={"font-size":"0.875rem",color:"var(--text-secondary)","line-height":"1.4"},h=_=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[_]||{bg:"#f5f5f5",color:"#666"},f=_=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(_),p=h(t.account.type);return b(tt,{get children(){return[(()=>{var _=Lw(),E=_.firstChild,A=E.nextSibling;return d(_,n),d(E,i),s(E,()=>t.account.accountNumber),s(A,()=>e(`accounts.types.${t.account.type.toLowerCase()}`)),K(T=>d(A,{...o,background:p.bg,color:p.color},T)),_})(),(()=>{var _=Mw();return _.style.setProperty("margin","0 0 0.5rem 0"),_.style.setProperty("font-size","1.1rem"),s(_,()=>t.account.name),_})(),(()=>{var _=Co();return d(_,c),s(_,()=>t.account.category),_})(),(()=>{var _=Co();return d(_,a),s(_,()=>f(t.account.balance)),_})(),(()=>{var _=Co();return d(_,u),s(_,()=>t.account.description),_})(),oe(()=>oe(()=>!t.account.isActive)()&&(()=>{var _=Co();return _.style.setProperty("margin-top","0.5rem"),_.style.setProperty("padding","0.25rem 0.75rem"),_.style.setProperty("border-radius","9999px"),_.style.setProperty("font-size","0.75rem"),_.style.setProperty("font-weight","500"),_.style.setProperty("background","#ffebee"),_.style.setProperty("color","#d32f2f"),_.style.setProperty("text-align","center"),s(_,()=>e("common.inactive")),_})()),(()=>{var _=Co();return d(_,r),s(_,b(Oe,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.account),get children(){return[oe(()=>e("common.view"))," ",oe(()=>e("accounts.accountDetails"))]}})),_})()]}})};var Vw=U("<div><div><div><div></div><h3></h3></div></div><div><div></div><div>"),Bw=U("<div>"),Fw=U("<button>"),Uw=U("<div><h4> (<!>)"),jw=U("<div><div><div></div><div> • </div></div><div>");const zw=t=>{const{t:e}=pt(),r=gc(),[n,i]=fe(!0),o={"margin-bottom":"1rem"},a={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},c={display:"flex","align-items":"center",gap:"1rem"},u={background:"none",border:"none",cursor:"pointer","font-size":"1.2rem",color:"var(--text-muted)",padding:"0.25rem","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease"},h={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},f={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},p={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},_={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},E={"margin-left":"1rem","border-left":"2px solid var(--border-color)","padding-left":"1rem","margin-top":"1rem"},A={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem","margin-bottom":"0.5rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},T={flex:"1"},x={"font-weight":"500","margin-bottom":"0.25rem"},$={"font-size":"0.875rem",color:"var(--text-muted)"},O={"font-weight":"600",color:"var(--primary-color)"},q={display:"flex",gap:"0.5rem"},z=w=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[w]||{bg:"#f5f5f5",color:"#666"},ee=w=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(w),Q=w=>{t.onViewDetails?t.onViewDetails(w):r(`/accounts/${w.id}`)},C=()=>{t.onAddSubAccount&&t.onAddSubAccount(t.account)},v=t.account.balance+t.account.subAccounts.reduce((w,P)=>w+P.balance,0),S=z(t.account.type);return b(tt,{className:"account-hierarchy-card",style:o,get children(){return[(()=>{var w=Vw(),P=w.firstChild,I=P.firstChild,y=I.firstChild,le=y.nextSibling,B=P.nextSibling,k=B.firstChild,W=k.nextSibling;return d(w,a),d(P,c),s(P,(()=>{var R=oe(()=>t.account.subAccounts.length>0);return()=>R()&&(()=>{var V=Fw();return V.addEventListener("mouseleave",M=>M.target.style.background="none"),V.addEventListener("mouseenter",M=>M.target.style.background="var(--background-color)"),V.$$click=()=>i(!n()),d(V,u),s(V,()=>n()?"▼":"▶"),V})()})(),I),I.$$click=()=>Q(t.account),I.style.setProperty("cursor","pointer"),d(y,h),s(y,()=>t.account.accountNumber),d(le,f),s(le,()=>t.account.name),B.style.setProperty("text-align","right"),d(k,p),s(k,()=>ee(v)),s(W,()=>e(`accounts.types.${t.account.type.toLowerCase()}`)),K(R=>d(W,{..._,background:S.bg,color:S.color},R)),w})(),(()=>{var w=Bw();return d(w,q),s(w,b(Oe,{variant:"secondary",size:"sm",onClick:()=>Q(t.account),get children(){return[oe(()=>e("common.view"))," ",oe(()=>e("accounts.accountDetails"))]}}),null),s(w,b(Oe,{variant:"outline",size:"sm",onClick:C,get children(){return[oe(()=>e("common.add"))," ",oe(()=>e("accounts.subAccounts"))]}}),null),w})(),oe(()=>oe(()=>!!(n()&&t.account.subAccounts.length>0))()&&(()=>{var w=Uw(),P=w.firstChild,I=P.firstChild,y=I.nextSibling;return y.nextSibling,d(w,E),P.style.setProperty("margin","0 0 1rem 0"),P.style.setProperty("font-size","1rem"),P.style.setProperty("color","var(--text-muted)"),s(P,()=>e("accounts.subAccounts"),I),s(P,()=>t.account.subAccounts.length,y),s(w,()=>t.account.subAccounts.map(le=>(()=>{var B=jw(),k=B.firstChild,W=k.firstChild,R=W.nextSibling,V=R.firstChild,M=k.nextSibling;return B.addEventListener("mouseleave",F=>{F.currentTarget.style.background="var(--background-color)",F.currentTarget.style.transform="translateY(0)"}),B.addEventListener("mouseenter",F=>{F.currentTarget.style.background="var(--surface-color)",F.currentTarget.style.transform="translateY(-1px)"}),B.$$click=()=>Q(le),d(B,A),d(k,T),d(W,x),s(W,()=>le.name),d(R,$),s(R,()=>le.accountNumber,V),s(R,()=>le.description,null),d(M,O),s(M,()=>ee(le.balance)),B})()),null),w})())]}})};Ot(["click"]);var qw=U("<form><div>");const Hw=t=>{const{t:e}=pt(),[r,n]=fe({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),i=[{value:"Asset",label:e("accounts.types.asset"),type:"debit",classification:"real"},{value:"Liability",label:e("accounts.types.liability"),type:"credit",classification:"real"},{value:"Equity",label:e("accounts.types.equity"),type:"credit",classification:"real"},{value:"Revenue",label:e("accounts.types.revenue"),type:"credit",classification:"nominal"},{value:"Expense",label:e("accounts.types.expense"),type:"debit",classification:"nominal"}],o=()=>{const f=r().type;return f?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")},{value:"Sales Revenue",label:e("accounts.categories.salesRevenue")},{value:"Service Revenue",label:e("accounts.categories.servicesRevenue")},{value:"Subscription Revenue",label:e("accounts.categories.subscriptionRevenue")},{value:"Rental Revenue",label:e("accounts.categories.rentalRevenue")},{value:"Commission Revenue",label:e("accounts.categories.commissionRevenue")},{value:"Franchise Revenue",label:e("accounts.categories.franchiseRevenue")},{value:"Licensing Revenue",label:e("accounts.categories.licensingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[f]||[]:[]},a=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],c={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},u=f=>{f.preventDefault();const p=r();if(!p.accountNumber||!p.name||!p.type||!p.category){alert(e("forms.requiredField"));return}if(St.accounts.find(A=>A.accountNumber===p.accountNumber)){alert(e("forms.duplicateAccountNumber"));return}const E={accountNumber:p.accountNumber,name:p.name,type:p.type,category:p.category,description:p.description,balance:parseFloat(p.balance)||0,isActive:p.isActive==="true"};St.addAccount(E),n({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},h=(f,p)=>{n(_=>{const E={..._,[f]:p};return f==="type"&&(E.category=""),E})};return b(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.addAccount")},get children(){var f=qw(),p=f.firstChild;return f.addEventListener("submit",u),s(f,b(Rt,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:_=>h("accountNumber",_),get placeholder(){return e("accounts.accountNumber")},required:!0}),p),s(f,b(Rt,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:_=>h("name",_),get placeholder(){return e("accounts.accountName")},required:!0}),p),s(f,b(_r,{get label(){return e("accounts.accountType")},get value(){return r().type},onChange:_=>h("type",_),options:i,required:!0}),p),s(f,b(_r,{get label(){return e("accounts.category")},get value(){return r().category},onChange:_=>h("category",_),get options(){return o()},required:!0}),p),s(f,b(Rt,{get label(){return e("common.description")},get value(){return r().description},onChange:_=>h("description",_),get placeholder(){return e("common.description")}}),p),s(f,b(Rt,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:_=>h("balance",_),get placeholder(){return e("accounts.balance")}}),p),s(f,b(_r,{get label(){return e("common.status")},get value(){return r().isActive},onChange:_=>h("isActive",_),options:a,required:!0}),p),d(p,c),s(p,b(Oe,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(p,b(Oe,{variant:"primary",type:"submit",get children(){return e("accounts.addAccount")}}),null),f}})};var Ww=U("<form><div>"),Gw=U("<div><div></div><div> - </div><div> • ");const Kw=t=>{const{t:e}=pt(),[r,n]=fe({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),i=()=>t.parentAccount?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[t.parentAccount.type]||[]:[],o=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],a={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},c={background:"var(--background-color)",padding:"1rem","border-radius":"var(--border-radius-sm)","margin-bottom":"1.5rem",border:"1px solid var(--border-color)"},u={"font-size":"0.875rem","font-weight":"500",color:"var(--text-muted)","margin-bottom":"0.5rem"},h={"font-weight":"600",color:"var(--text-primary)"},f={"font-size":"0.875rem",color:"var(--text-secondary)"},p=T=>{T.preventDefault();const x=r();if(!x.accountNumber||!x.name||!x.category||!t.parentAccount){alert(e("forms.requiredField"));return}if(St.accounts.find(q=>q.accountNumber===x.accountNumber)){alert(e("forms.duplicateAccountNumber"));return}const O={accountNumber:x.accountNumber,name:x.name,type:t.parentAccount.type,category:x.category,description:x.description,balance:parseFloat(x.balance)||0,isActive:x.isActive==="true",parentAccountId:t.parentAccount.id};St.addAccount(O),n({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},_=(T,x)=>{n($=>({...$,[T]:x}))},E=()=>{if(!t.parentAccount)return"";const T=t.parentAccount.accountNumber,$=St.getSubAccounts(t.parentAccount.id).length+1;return(parseInt(T)+$).toString()},A=()=>r().accountNumber===""&&t.parentAccount?E():r().accountNumber;return b(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return`${e("common.add")} ${e("accounts.subAccounts")}`},get children(){return[oe(()=>oe(()=>!!t.parentAccount)()&&(()=>{var T=Gw(),x=T.firstChild,$=x.nextSibling,O=$.firstChild,q=$.nextSibling,z=q.firstChild;return d(T,c),d(x,u),s(x,()=>e("accounts.parentAccount")),d($,h),s($,()=>t.parentAccount.accountNumber,O),s($,()=>t.parentAccount.name,null),d(q,f),s(q,()=>e(`accounts.types.${t.parentAccount.type.toLowerCase()}`),z),s(q,()=>t.parentAccount.category,null),T})()),(()=>{var T=Ww(),x=T.firstChild;return T.addEventListener("submit",p),s(T,b(Rt,{get label(){return e("accounts.accountNumber")},get value(){return A()},onChange:$=>_("accountNumber",$),get placeholder(){return`${e("common.suggested")}: ${E()}`},required:!0}),x),s(T,b(Rt,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:$=>_("name",$),get placeholder(){return e("accounts.accountName")},required:!0}),x),s(T,b(_r,{get label(){return e("accounts.category")},get value(){return r().category},onChange:$=>_("category",$),get options(){return i()},required:!0}),x),s(T,b(Rt,{get label(){return e("common.description")},get value(){return r().description},onChange:$=>_("description",$),get placeholder(){return e("common.description")}}),x),s(T,b(Rt,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:$=>_("balance",$),get placeholder(){return e("accounts.balance")}}),x),s(T,b(_r,{get label(){return e("common.status")},get value(){return r().isActive},onChange:$=>_("isActive",$),options:o,required:!0}),x),d(x,a),s(x,b(Oe,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(x,b(Oe,{variant:"primary",type:"submit",get children(){return[oe(()=>e("common.add"))," ",oe(()=>e("accounts.subAccounts"))]}}),null),T})()]}})};var Yw=U("<form><div>"),Qw=U("<div>");const Jw=t=>{const{t:e}=pt(),[r,n]=fe({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),[i,o]=fe(null);Ln(()=>{t.account&&(n({accountNumber:t.account.accountNumber,name:t.account.name,type:t.account.type,category:t.account.category,description:t.account.description,balance:t.account.balance.toString(),isActive:t.account.isActive.toString()}),o(null))});const a=[{value:"Asset",label:e("accounts.types.asset")},{value:"Liability",label:e("accounts.types.liability")},{value:"Equity",label:e("accounts.types.equity")},{value:"Revenue",label:e("accounts.types.revenue")},{value:"Expense",label:e("accounts.types.expense")}],c=()=>{const E=r().type;return E?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[E]||[]:[]},u=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],h={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},f=E=>{if(E.preventDefault(),o(null),!t.account)return;const A=r();if(!A.accountNumber||!A.name||!A.type||!A.category){o(e("forms.requiredField"));return}if(St.accounts.find($=>$.accountNumber===A.accountNumber&&$.id!==t.account.id)){o(e("forms.duplicateAccountNumber"));return}const x={accountNumber:A.accountNumber,name:A.name,type:A.type,category:A.category,description:A.description,balance:parseFloat(A.balance)||0,isActive:A.isActive==="true"};try{St.updateAccount(t.account.id,x),t.onClose()}catch($){o($ instanceof Error?$.message:e("forms.saveError"))}},p=()=>{if(!t.account)return;const E=St.canDeleteAccount(t.account.id);if(!E.canDelete){o(E.reason||e("forms.deleteError"));return}const A=e("forms.confirmDelete");if(confirm(A))try{St.deleteAccount(t.account.id),t.onClose()}catch(T){o(T instanceof Error?T.message:e("forms.deleteError"))}},_=(E,A)=>{n(T=>{const x={...T,[E]:A};return E==="type"&&(x.category=""),x}),i()&&o(null)};return t.account?b(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.editAccount")},get children(){var E=Yw(),A=E.firstChild;return E.addEventListener("submit",f),s(E,b(Rt,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:T=>_("accountNumber",T),get placeholder(){return e("accounts.accountNumber")},required:!0}),A),s(E,b(Rt,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:T=>_("name",T),get placeholder(){return e("accounts.accountName")},required:!0}),A),s(E,b(_r,{get label(){return e("accounts.accountType")},get value(){return r().type},onChange:T=>_("type",T),options:a,required:!0}),A),s(E,b(_r,{get label(){return e("accounts.category")},get value(){return r().category},onChange:T=>_("category",T),get options(){return c()},required:!0}),A),s(E,b(Rt,{get label(){return e("common.description")},get value(){return r().description},onChange:T=>_("description",T),get placeholder(){return e("common.description")}}),A),s(E,b(Rt,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:T=>_("balance",T),get placeholder(){return e("accounts.balance")}}),A),s(E,b(_r,{get label(){return e("common.status")},get value(){return r().isActive},onChange:T=>_("isActive",T),options:u,required:!0}),A),s(E,(()=>{var T=oe(()=>!!i());return()=>T()&&(()=>{var x=Qw();return x.style.setProperty("padding","1rem"),x.style.setProperty("border-radius","var(--border-radius-sm)"),x.style.setProperty("margin-top","1rem"),x.style.setProperty("background","#f8d7da"),x.style.setProperty("color","#721c24"),x.style.setProperty("border","1px solid #f5c6cb"),s(x,i),x})()})(),A),d(A,h),s(A,b(Oe,{variant:"outline",type:"button",onClick:p,style:{color:"#dc3545","border-color":"#dc3545","margin-right":"auto"},get children(){return e("accounts.deleteAccount")}}),null),s(A,b(Oe,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(A,b(Oe,{variant:"primary",type:"submit",get children(){return e("common.save")}}),null),E}}):null};var Xw=U("<div><div>⚠️</div><div></div><div></div><div>"),Zw=U("<div><div></div><div></div><div>"),eC=U("<div><button></button><button> (<!>)"),yl=U("<div>"),tC=U("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),rC=U("<div><div><div></div><div> • </div></div><div>");const nC=t=>{const{t:e}=pt(),[r,n]=fe("details"),[i,o]=fe(!1),a=it(()=>t.account?St.getAccountById(t.account.id)||t.account:null),c={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},u={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},h={"font-weight":"600",color:"var(--text-primary)"},f={"text-align":"center","margin-bottom":"2rem"},p={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},_={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},E={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem"},A={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},T=S=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:S?"var(--primary-color)":"var(--text-muted)","border-bottom":S?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),x={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},$={flex:"1"},O={"font-size":"0.875rem",color:"var(--text-muted)"},q={"font-weight":"500","margin-bottom":"0.25rem"},z=S=>({"font-weight":"600",color:S==="debit"?"#4caf50":"#f44336"}),ee={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},Q=S=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[S]||{bg:"#f5f5f5",color:"#666"},C=S=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(S),v=S=>new Date(S).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return b(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.accountDetails")},get children(){return[oe(()=>oe(()=>!a())()?(()=>{var S=Xw(),w=S.firstChild,P=w.nextSibling,I=P.nextSibling,y=I.nextSibling;return S.style.setProperty("text-align","center"),S.style.setProperty("padding","3rem"),S.style.setProperty("color","var(--text-muted)"),w.style.setProperty("font-size","1.5rem"),w.style.setProperty("margin-bottom","1rem"),P.style.setProperty("font-size","1.1rem"),P.style.setProperty("margin-bottom","0.5rem"),s(P,()=>e("common.error")),I.style.setProperty("font-size","0.875rem"),s(I,()=>e("common.noDataFound")),y.style.setProperty("margin-top","2rem"),s(y,b(Oe,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),S})():(()=>{const S=it(()=>Q(a().type)),w=it(()=>St.getAccountTransactions(a().id));return[(()=>{var P=Zw(),I=P.firstChild,y=I.nextSibling,le=y.nextSibling;return d(P,f),d(I,p),s(I,()=>a().name),d(y,_),s(y,()=>C(a().balance)),s(le,()=>e(`accounts.types.${a().type.toLowerCase()}`)),K(B=>d(le,{...E,background:S().bg,color:S().color},B)),P})(),(()=>{var P=eC(),I=P.firstChild,y=I.nextSibling,le=y.firstChild,B=le.nextSibling;return B.nextSibling,d(P,A),I.$$click=()=>n("details"),s(I,()=>e("accounts.accountDetails")),y.$$click=()=>n("transactions"),s(y,()=>e("accounts.transactions"),le),s(y,()=>w().length,B),K(k=>{var W=T(r()==="details"),R=T(r()==="transactions");return k.e=d(I,W,k.e),k.t=d(y,R,k.t),k},{e:void 0,t:void 0}),P})(),oe(()=>oe(()=>r()==="details")()&&(()=>{var P=tC(),I=P.firstChild,y=I.firstChild,le=y.nextSibling,B=I.nextSibling,k=B.firstChild,W=k.nextSibling,R=B.nextSibling,V=R.firstChild,M=V.nextSibling,F=R.nextSibling,ne=F.firstChild,L=ne.nextSibling,j=F.nextSibling,Z=j.firstChild,te=Z.nextSibling,he=j.nextSibling,se=he.firstChild,re=se.nextSibling;return s(y,()=>e("accounts.accountNumber")),s(le,()=>a().accountNumber),s(k,()=>e("accounts.category")),s(W,()=>a().category),s(V,()=>e("common.description")),s(M,()=>a().description),s(ne,()=>e("common.status")),s(L,(()=>{var ye=oe(()=>!!a().isActive);return()=>ye()?e("common.active"):e("common.inactive")})()),s(Z,()=>e("accounts.createdDate")),s(te,()=>v(a().createdDate)),s(se,()=>e("accounts.lastModified")),s(re,()=>v(a().lastModified)),K(ye=>{var G=c,ae=u,Pe=h,we=c,ue=u,ce=h,H=c,de=u,X=h,_e=c,Se=u,Y=h,ie=c,Ie=u,pe=h,me=c,J=u,D=h;return ye.e=d(I,G,ye.e),ye.t=d(y,ae,ye.t),ye.a=d(le,Pe,ye.a),ye.o=d(B,we,ye.o),ye.i=d(k,ue,ye.i),ye.n=d(W,ce,ye.n),ye.s=d(R,H,ye.s),ye.h=d(V,de,ye.h),ye.r=d(M,X,ye.r),ye.d=d(F,_e,ye.d),ye.l=d(ne,Se,ye.l),ye.u=d(L,Y,ye.u),ye.c=d(j,ie,ye.c),ye.w=d(Z,Ie,ye.w),ye.m=d(te,pe,ye.m),ye.f=d(he,me,ye.f),ye.y=d(se,J,ye.y),ye.g=d(re,D,ye.g),ye},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),P})()),oe(()=>oe(()=>r()==="transactions")()&&(()=>{var P=yl();return s(P,(()=>{var I=oe(()=>w().length===0);return()=>I()?(()=>{var y=yl();return y.style.setProperty("text-align","center"),y.style.setProperty("color","var(--text-muted)"),y.style.setProperty("padding","2rem"),s(y,()=>e("common.noDataFound")),y})():w().map(y=>(()=>{var le=rC(),B=le.firstChild,k=B.firstChild,W=k.nextSibling,R=W.firstChild,V=B.nextSibling;return d(le,x),d(B,$),d(k,q),s(k,()=>y.description),d(W,O),s(W,()=>v(y.date),R),s(W,()=>y.reference,null),s(V,()=>y.type==="debit"?"+":"-",null),s(V,()=>C(y.type==="debit"?y.debitAmount:y.creditAmount),null),K(M=>d(V,z(y.type),M)),le})())})()),P})()),(()=>{var P=yl();return d(P,ee),s(P,b(Oe,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(P,b(Oe,{variant:"primary",onClick:()=>o(!0),get children(){return e("accounts.editAccount")}}),null),P})()]})()),oe(()=>oe(()=>!!a())()&&b(Jw,{get isOpen(){return i()},onClose:()=>{o(!1)},get account(){return a()}}))]}})};Ot(["click"]);const iC="https://qvamarkets.com/gql_api",[oC,ph]=fe(!1),[sC,gl]=fe(null);class aC{baseUrl;constructor(e=iC){this.baseUrl=e}async request(e,r,n,i){ph(!0),gl(null);try{const o=r.startsWith("http")?r:`${this.baseUrl}${r}`,a={method:e,headers:{"Content-Type":"application/json",Accept:"application/json",...i}};n&&(e==="POST"||e==="PUT"||e==="PATCH")&&(a.body=JSON.stringify(n));const c=await fetch(o,a);if(!c.ok)throw new Error(`HTTP error! status: ${c.status}`);const u=await c.json();if(u.errors&&u.errors.length>0)throw new Error(u.errors[0].message);return u.data||u}catch(o){const a=o instanceof Error?o.message:"Unknown error occurred";throw gl(a),o}finally{ph(!1)}}async graphql(e){return this.request("POST","",e)}async get(e,r){return this.request("GET",e,void 0,r)}async post(e,r,n){return this.request("POST",e,r,n)}async put(e,r,n){return this.request("PUT",e,r,n)}async patch(e,r,n){return this.request("PATCH",e,r,n)}async delete(e,r){return this.request("DELETE",e,void 0,r)}getLoadingState(){return oC()}getErrorState(){return sC()}clearError(){gl(null)}}const Ns=new aC,au=`
  fragment AccountFields on Account {
    id
    accountNumber
    name
    type
    category
    description
    balance
    isActive
    parentAccountId
    createdDate
    lastModified
  }
`,lC=`
  query GetAccountById($id: ID!) {
    account(id: $id) {
      ...AccountFields
    }
  }
  ${au}
`,cC=`
  mutation CreateAccount($input: CreateAccountInput!) {
    createAccount(input: $input) {
      ...AccountFields
    }
  }
  ${au}
`,uC=`
  mutation UpdateAccount($id: ID!, $input: UpdateAccountInput!) {
    updateAccount(id: $id, input: $input) {
      ...AccountFields
    }
  }
  ${au}
`,dC=`
  mutation DeleteAccount($id: ID!) {
    deleteAccount(id: $id) {
      success
      message
    }
  }
`;class hC{async getAccounts(e,r){try{if(Ko.isFakeMode())return await Uu.getAll(e);const n=await Jn({query:"getAllYabaProducts",params:{businessId:"YB100423253156428"}});return console.log("Real API accounts response:",n),n?.accounts||[]}catch(n){if(console.error("Error fetching accounts:",n),Ko.isHybridMode())return console.warn("Falling back to fake API for accounts"),await Uu.getAll(e);throw n}}async getAccountById(e){try{return(await Ns.graphql({query:lC,variables:{id:e}})).account}catch(r){throw console.error("Error fetching account:",r),r}}async createAccount(e){try{return(await Ns.graphql({query:cC,variables:{input:e}})).createAccount}catch(r){throw console.error("Error creating account:",r),r}}async updateAccount(e,r){try{return(await Ns.graphql({query:uC,variables:{id:e,input:r}})).updateAccount}catch(n){throw console.error("Error updating account:",n),n}}async deleteAccount(e){try{return(await Ns.graphql({query:dC,variables:{id:e}})).deleteAccount}catch(r){throw console.error("Error deleting account:",r),r}}async getAccountsByType(e){return this.getAccounts({type:e})}async getAccountHierarchy(){const e=await this.getAccounts();return this.buildHierarchy(e)}buildHierarchy(e){const r=new Map,n=[];return e.forEach(i=>{r.set(i.id,{...i,subAccounts:[]})}),e.forEach(i=>{const o=r.get(i.id);if(i.parentAccountId){const a=r.get(i.parentAccountId);a&&(a.subAccounts=a.subAccounts||[],a.subAccounts.push(o))}else n.push(o)}),n}async getAccountBalance(e){const r=await this.getAccountById(e);return r?r.balance:0}async searchAccounts(e){return this.getAccounts({search:e})}}const mC=new hC;var fC=U("<div><h2></h2><div><span>:</span><button></button><button>"),yC=U("<div><span>:"),vh=U("<div>"),gC=U("<button>");const pC=()=>{const{t}=pt(),[e,r]=fe(!1),[n,i]=fe(!1),[o,a]=fe(!1),[c,u]=fe(null),[h,f]=fe(null),[p,_]=fe("All"),[E,A]=fe("hierarchy"),T=v=>{u(v),a(!0)},x=v=>{f(v),i(!0)},$=()=>p()==="All"?E()==="hierarchy"?St.getAccountHierarchy():St.accounts:E()==="hierarchy"?St.getAccountHierarchy().filter(v=>v.type===p()):St.getAccountsByType(p()),O={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(350px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},q={display:"flex",gap:"1rem","margin-bottom":"2rem","align-items":"center"},z=v=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:v?"var(--primary-color)":"var(--surface-color)",color:v?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500",transition:"all 0.2s ease"}),ee={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},Q={display:"flex",gap:"0.5rem","align-items":"center","margin-left":"auto","margin-right":"1rem"},C=v=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:v?"var(--primary-color)":"var(--surface-color)",color:v?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"});return b(Wr,{get title(){return t("accounts.title")},get children(){return[b(Nw,{}),(()=>{var v=fC(),S=v.firstChild,w=S.nextSibling,P=w.firstChild,I=P.firstChild,y=P.nextSibling,le=y.nextSibling;return d(v,ee),S.style.setProperty("margin","0"),S.style.setProperty("font-size","1.5rem"),s(S,()=>t("accounts.title")),d(w,Q),P.style.setProperty("font-weight","500"),P.style.setProperty("color","var(--text-muted)"),P.style.setProperty("font-size","0.875rem"),s(P,()=>t("common.view"),I),y.$$click=()=>A("hierarchy"),s(y,()=>t("accounts.accountHierarchy")),le.$$click=()=>{A("flat"),mC.getAccounts()},s(le,()=>t("common.all")),s(v,b(Oe,{variant:"primary",onClick:()=>r(!0),get children(){return t("accounts.addAccount")}}),null),K(B=>{var k=C(E()==="hierarchy"),W=C(E()==="flat");return B.e=d(y,k,B.e),B.t=d(le,W,B.t),B},{e:void 0,t:void 0}),v})(),(()=>{var v=yC(),S=v.firstChild,w=S.firstChild;return d(v,q),S.style.setProperty("font-weight","500"),S.style.setProperty("color","var(--text-muted)"),s(S,()=>t("common.filter"),w),s(v,()=>[t("common.all"),t("accounts.types.asset"),t("accounts.types.liability"),t("accounts.types.equity"),t("accounts.types.revenue"),t("accounts.types.expense")].map((P,I)=>{const le=["All","Asset","Liability","Equity","Revenue","Expense"][I];return(()=>{var B=gC();return B.$$click=()=>_(le),s(B,P),K(k=>d(B,z(p()===le),k)),B})()}),null),v})(),(()=>{var v=vh();return s(v,(()=>{var S=oe(()=>E()==="hierarchy");return()=>S()?$().map(w=>b(zw,{account:w,onAddSubAccount:x,onViewDetails:T})):$().map(w=>b(Ow,{account:w,onViewDetails:T}))})()),K(S=>d(v,E()==="hierarchy"?{display:"flex","flex-direction":"column",gap:"1rem"}:O,S)),v})(),oe(()=>oe(()=>$().length===0)()&&(()=>{var v=vh();return v.style.setProperty("text-align","center"),v.style.setProperty("color","var(--text-muted)"),v.style.setProperty("padding","3rem"),v.style.setProperty("font-size","1.1rem"),s(v,()=>t("common.noDataFound")),v})()),b(Hw,{get isOpen(){return e()},onClose:()=>r(!1)}),b(Kw,{get isOpen(){return n()},onClose:()=>i(!1),get parentAccount(){return h()}}),b(nC,{get isOpen(){return o()},onClose:()=>a(!1),get account(){return c()}})]}})};Ot(["click"]);var vC=U("<div><h2>"),ji=U("<div>"),bC=U("<div><div><div></div><h1></h1><div></div></div><div>"),_C=U("<div><button></button><button> (<!>)"),Ls=U("<div><span></span><span>"),SC=U("<p>"),PC=U("<div><div></div><div>"),wC=U("<div><div><div></div><div> • </div></div><div>");const CC=()=>{const{t}=pt(),e=Wg(),r=gc(),[n,i]=fe(null),[o,a]=fe("overview");yn(()=>{const y=St.getAccountById(e.id);y?i(y):r("/accounts")});const c={display:"flex","align-items":"center",gap:"0.5rem","margin-bottom":"1rem"},u={display:"flex","align-items":"center",gap:"1rem","margin-bottom":"2rem"},h={"font-size":"1rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},f={"font-size":"2.5rem","font-weight":"700",color:"var(--primary-color)"},p={padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},_={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},E=y=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:y?"var(--primary-color)":"var(--text-muted)","border-bottom":y?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),A={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},T={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},x={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},$={"font-weight":"500",color:"var(--text-muted)"},O={"font-weight":"600",color:"var(--text-primary)"},q={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},z={flex:"1"},ee={"font-weight":"500","margin-bottom":"0.25rem"},Q={"font-size":"0.875rem",color:"var(--text-muted)"},C=y=>({"font-weight":"600",color:y==="debit"?"#4caf50":"#f44336"});if(!n())return b(Wr,{get title(){return t("accounts.accountDetails")},get children(){var y=vC(),le=y.firstChild;return y.style.setProperty("text-align","center"),y.style.setProperty("padding","3rem"),s(le,()=>t("common.error")),s(y,b(Oe,{variant:"primary",onClick:()=>r("/accounts"),get children(){return[oe(()=>t("common.back"))," ",oe(()=>t("navigation.accounts"))]}}),null),y}});const v=y=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[y]||{bg:"#f5f5f5",color:"#666"},S=y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(y),w=y=>new Date(y).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),P=v(n().type),I=St.getAccountTransactions(n().id);return b(Wr,{get title(){return n().name},get children(){return[(()=>{var y=ji();return d(y,c),s(y,b(Oe,{variant:"secondary",onClick:()=>r("/accounts"),get children(){return["← ",oe(()=>t("common.back"))," ",oe(()=>t("navigation.accounts"))]}})),y})(),(()=>{var y=bC(),le=y.firstChild,B=le.firstChild,k=B.nextSibling,W=k.nextSibling,R=le.nextSibling;return d(y,u),d(B,h),s(B,()=>n().accountNumber),k.style.setProperty("margin","0.5rem 0"),k.style.setProperty("font-size","2rem"),s(k,()=>n().name),d(W,f),s(W,()=>S(n().balance)),s(R,()=>n().type),K(V=>d(R,{...p,background:P.bg,color:P.color},V)),y})(),(()=>{var y=_C(),le=y.firstChild,B=le.nextSibling,k=B.firstChild,W=k.nextSibling;return W.nextSibling,d(y,_),le.$$click=()=>a("overview"),s(le,()=>t("dashboard.overview")),B.$$click=()=>a("transactions"),s(B,()=>t("accounts.transactions"),k),s(B,()=>I.length,W),K(R=>{var V=E(o()==="overview"),M=E(o()==="transactions");return R.e=d(le,V,R.e),R.t=d(B,M,R.t),R},{e:void 0,t:void 0}),y})(),oe(()=>oe(()=>o()==="overview")()&&(()=>{var y=PC(),le=y.firstChild,B=le.nextSibling;return d(le,A),s(le,b(tt,{get title(){return t("accounts.balance")},get subtitle(){return t("dashboard.overview")},get children(){var k=ji();return k.style.setProperty("font-size","1.5rem"),k.style.setProperty("font-weight","600"),k.style.setProperty("color","var(--primary-color)"),s(k,()=>S(n().balance)),k}}),null),s(le,b(tt,{get title(){return t("accounts.accountType")},get subtitle(){return t("accounts.category")},get children(){var k=ji();return k.style.setProperty("font-size","1.5rem"),k.style.setProperty("font-weight","600"),k.style.setProperty("color","var(--primary-color)"),s(k,()=>t(`accounts.types.${n().type.toLowerCase()}`)),k}}),null),s(le,b(tt,{get title(){return t("common.status")},get subtitle(){return t("accounts.accountDetails")},get children(){var k=ji();return k.style.setProperty("font-size","1.5rem"),k.style.setProperty("font-weight","600"),s(k,(()=>{var W=oe(()=>!!n().isActive);return()=>W()?t("common.active"):t("common.inactive")})()),K(W=>(W=n().isActive?"#4caf50":"#f44336")!=null?k.style.setProperty("color",W):k.style.removeProperty("color")),k}}),null),s(le,b(tt,{get title(){return t("accounts.transactions")},get subtitle(){return t("common.total")},get children(){var k=ji();return k.style.setProperty("font-size","1.5rem"),k.style.setProperty("font-weight","600"),k.style.setProperty("color","var(--primary-color)"),s(k,()=>I.length),k}}),null),d(B,T),s(B,b(tt,{get title(){return t("accounts.accountDetails")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var k=Ls(),W=k.firstChild,R=W.nextSibling;return s(W,()=>t("accounts.accountNumber")),s(R,()=>n().accountNumber),K(V=>{var M=x,F=$,ne=O;return V.e=d(k,M,V.e),V.t=d(W,F,V.t),V.a=d(R,ne,V.a),V},{e:void 0,t:void 0,a:void 0}),k})(),(()=>{var k=Ls(),W=k.firstChild,R=W.nextSibling;return s(W,()=>t("accounts.category")),s(R,()=>n().category),K(V=>{var M=x,F=$,ne=O;return V.e=d(k,M,V.e),V.t=d(W,F,V.t),V.a=d(R,ne,V.a),V},{e:void 0,t:void 0,a:void 0}),k})(),(()=>{var k=Ls(),W=k.firstChild,R=W.nextSibling;return s(W,()=>t("common.date")),s(R,()=>w(n().createdDate)),K(V=>{var M=x,F=$,ne=O;return V.e=d(k,M,V.e),V.t=d(W,F,V.t),V.a=d(R,ne,V.a),V},{e:void 0,t:void 0,a:void 0}),k})(),(()=>{var k=Ls(),W=k.firstChild,R=W.nextSibling;return s(W,()=>t("common.date")),s(R,()=>w(n().lastModified)),K(V=>{var M=x,F=$,ne=O;return V.e=d(k,M,V.e),V.t=d(W,F,V.t),V.a=d(R,ne,V.a),V},{e:void 0,t:void 0,a:void 0}),k})()]}}),null),s(B,b(tt,{get title(){return t("common.description")},get subtitle(){return t("accounts.accountDetails")},get children(){var k=SC();return k.style.setProperty("margin","0"),k.style.setProperty("color","var(--text-secondary)"),s(k,()=>n().description||t("common.noDataFound")),k}}),null),y})()),oe(()=>oe(()=>o()==="transactions")()&&b(tt,{get title(){return t("accounts.accountHistory")},get subtitle(){return t("accounts.transactions")},get children(){return oe(()=>I.length===0)()?(()=>{var y=ji();return y.style.setProperty("text-align","center"),y.style.setProperty("color","var(--text-muted)"),y.style.setProperty("padding","2rem"),s(y,()=>t("common.noDataFound")),y})():I.map(y=>(()=>{var le=wC(),B=le.firstChild,k=B.firstChild,W=k.nextSibling,R=W.firstChild,V=B.nextSibling;return d(le,q),d(B,z),d(k,ee),s(k,()=>y.description),d(W,Q),s(W,()=>w(y.date),R),s(W,()=>y.reference,null),s(V,()=>y.type==="debit"?"+":"-",null),s(V,()=>S(y.type==="debit"?y.debitAmount:y.creditAmount),null),K(M=>d(V,C(y.type),M)),le})())}}))]}})};Ot(["click"]);var AC=U("<div><div><h1></h1><p> </p></div><div><input type=date>"),Sn=U("<div><span></span><span>"),IC=U("<div><div></div><div>"),EC=U("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),xC=U("<div><div> (<!> = <!> + <!>)</div><div> = "),TC=U("<span>(<!>: <!>)");const $C=()=>{const{t}=pt(),[e,r]=fe(new Date().toISOString().split("T")[0]),[n,i]=fe(0),[o,a]=fe(0),[c,u]=fe(0);yn(()=>{h()});const h=()=>{const A=St.getAccountsByType("Asset"),T=St.getAccountsByType("Liability"),x=St.getAccountsByType("Equity"),$=A.reduce((z,ee)=>z+ee.balance,0),O=T.reduce((z,ee)=>z+ee.balance,0),q=x.reduce((z,ee)=>z+ee.balance,0);i($),a(O),u(q)},f=A=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(A),p={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},_={"margin-bottom":"2rem"},E={"font-weight":"bold","font-size":"1.1rem","border-top":"2px solid var(--border-color)","padding-top":"0.5rem","margin-top":"1rem"};return b(Wr,{get title(){return t("balanceSheet.title")},get children(){return[(()=>{var A=AC(),T=A.firstChild,x=T.firstChild,$=x.nextSibling,O=$.firstChild,q=T.nextSibling,z=q.firstChild;return d(A,p),x.style.setProperty("margin","0"),s(x,()=>t("balanceSheet.title")),$.style.setProperty("margin","0.5rem 0 0 0"),$.style.setProperty("color","var(--text-muted)"),s($,()=>t("balanceSheet.asOf"),O),s($,()=>new Date(e()).toLocaleDateString(),null),q.style.setProperty("display","flex"),q.style.setProperty("gap","1rem"),z.addEventListener("change",ee=>r(ee.target.value)),z.style.setProperty("padding","0.5rem"),z.style.setProperty("border","1px solid var(--border-color)"),z.style.setProperty("border-radius","var(--border-radius-sm)"),s(q,b(Oe,{variant:"primary",onClick:h,get children(){return t("balanceSheet.generateReport")}}),null),K(()=>z.value=e()),A})(),(()=>{var A=IC(),T=A.firstChild,x=T.nextSibling;return A.style.setProperty("display","grid"),A.style.setProperty("grid-template-columns","1fr 1fr"),A.style.setProperty("gap","2rem"),s(T,b(tt,{get title(){return t("balanceSheet.assets")},style:_,get children(){return[(()=>{var $=Sn(),O=$.firstChild,q=O.nextSibling;return $.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),s(O,()=>t("balanceSheet.currentAssets")),s(q,()=>f(n()*.6)),$})(),(()=>{var $=Sn(),O=$.firstChild,q=O.nextSibling;return $.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),s(O,()=>t("balanceSheet.nonCurrentAssets")),s(q,()=>f(n()*.4)),$})(),(()=>{var $=Sn(),O=$.firstChild,q=O.nextSibling;return s(O,()=>t("balanceSheet.totalAssets")),s(q,()=>f(n())),K(z=>d($,{...E,display:"flex","justify-content":"space-between"},z)),$})()]}})),s(x,b(tt,{get title(){return t("balanceSheet.liabilities")},style:_,get children(){return[(()=>{var $=Sn(),O=$.firstChild,q=O.nextSibling;return $.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),s(O,()=>t("balanceSheet.currentLiabilities")),s(q,()=>f(o()*.7)),$})(),(()=>{var $=Sn(),O=$.firstChild,q=O.nextSibling;return $.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),s(O,()=>t("balanceSheet.nonCurrentLiabilities")),s(q,()=>f(o()*.3)),$})(),(()=>{var $=Sn(),O=$.firstChild,q=O.nextSibling;return s(O,()=>t("balanceSheet.totalLiabilities")),s(q,()=>f(o())),K(z=>d($,{...E,display:"flex","justify-content":"space-between"},z)),$})()]}}),null),s(x,b(tt,{get title(){return t("balanceSheet.equity")},get children(){return[(()=>{var $=Sn(),O=$.firstChild,q=O.nextSibling;return $.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),s(O,()=>t("balanceSheet.commonStock")),s(q,()=>f(c()*.8)),$})(),(()=>{var $=Sn(),O=$.firstChild,q=O.nextSibling;return $.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),s(O,()=>t("balanceSheet.retainedEarnings")),s(q,()=>f(c()*.2)),$})(),(()=>{var $=Sn(),O=$.firstChild,q=O.nextSibling;return s(O,()=>t("balanceSheet.totalEquity")),s(q,()=>f(c())),K(z=>d($,{...E,display:"flex","justify-content":"space-between"},z)),$})()]}}),null),A})(),b(tt,{get title(){return t("dashboard.overview")},style:{"margin-top":"2rem"},get children(){return[(()=>{var A=EC(),T=A.firstChild,x=T.firstChild,$=x.nextSibling,O=T.nextSibling,q=O.firstChild,z=q.nextSibling,ee=O.nextSibling,Q=ee.firstChild,C=Q.nextSibling;return A.style.setProperty("display","grid"),A.style.setProperty("grid-template-columns","repeat(3, 1fr)"),A.style.setProperty("gap","2rem"),T.style.setProperty("text-align","center"),x.style.setProperty("font-size","0.875rem"),x.style.setProperty("color","var(--text-muted)"),x.style.setProperty("margin-bottom","0.5rem"),s(x,()=>t("balanceSheet.totalAssets")),$.style.setProperty("font-size","1.5rem"),$.style.setProperty("font-weight","bold"),$.style.setProperty("color","var(--primary-color)"),s($,()=>f(n())),O.style.setProperty("text-align","center"),q.style.setProperty("font-size","0.875rem"),q.style.setProperty("color","var(--text-muted)"),q.style.setProperty("margin-bottom","0.5rem"),s(q,()=>t("balanceSheet.totalLiabilities")),z.style.setProperty("font-size","1.5rem"),z.style.setProperty("font-weight","bold"),z.style.setProperty("color","#f44336"),s(z,()=>f(o())),ee.style.setProperty("text-align","center"),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),Q.style.setProperty("margin-bottom","0.5rem"),s(Q,()=>t("balanceSheet.totalEquity")),C.style.setProperty("font-size","1.5rem"),C.style.setProperty("font-weight","bold"),C.style.setProperty("color","#4caf50"),s(C,()=>f(c())),A})(),(()=>{var A=xC(),T=A.firstChild,x=T.firstChild,$=x.nextSibling,O=$.nextSibling,q=O.nextSibling,z=q.nextSibling,ee=z.nextSibling;ee.nextSibling;var Q=T.nextSibling,C=Q.firstChild;return A.style.setProperty("margin-top","2rem"),A.style.setProperty("text-align","center"),T.style.setProperty("font-size","0.875rem"),T.style.setProperty("color","var(--text-muted)"),T.style.setProperty("margin-bottom","0.5rem"),s(T,()=>t("common.total"),x),s(T,()=>t("balanceSheet.totalAssets"),$),s(T,()=>t("balanceSheet.totalLiabilities"),q),s(T,()=>t("balanceSheet.totalEquity"),ee),Q.style.setProperty("font-size","1.2rem"),Q.style.setProperty("font-weight","bold"),s(Q,()=>f(n()),C),s(Q,()=>f(o()+c()),null),s(Q,(()=>{var v=oe(()=>Math.abs(n()-(o()+c()))>.01);return()=>v()&&(()=>{var S=TC(),w=S.firstChild,P=w.nextSibling,I=P.nextSibling,y=I.nextSibling;return y.nextSibling,S.style.setProperty("font-size","0.875rem"),S.style.setProperty("color","#f44336"),S.style.setProperty("display","block"),s(S,()=>t("common.error"),P),s(S,()=>f(n()-(o()+c())),y),S})()})(),null),K(v=>(v=Math.abs(n()-(o()+c()))<.01?"#4caf50":"#f44336")!=null?Q.style.setProperty("color",v):Q.style.removeProperty("color")),A})()]}})]}})};Ot(["click"]);const kC=[{id:"YY_8801",code:"YY_8801",name:"YABA SUR",bussinesId:"YB100423253156428",type:"store",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8802",code:"YY_8802",name:"CENTER",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8803",code:"YY_8803",name:"BISONET",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8804",code:"YY_8804",name:"IRVIN",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8805",code:"YY_8805",name:"KATTY",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8814",code:"YY_8814",name:"YABASUR OR",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8816",code:"YY_8816",name:"YABA GLOBAL",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8818",code:"YY_8818",name:"YABASURAUSTIN",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8844",code:"YY_8844",name:"YABANEBRASKA",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8847",code:"YY_8847",name:"YABAOFICINA AZ",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_3251",code:"YY_3251",name:"YABA FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_32",code:"YY_32",name:"YABA MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_33",code:"YY_33",name:"YABASUR ARIZONA",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8635",code:"YY_8635",name:"FASHION MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8665",code:"YY_8665",name:"IRVIN FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8901",code:"YY_8901",name:"ALMACEN CENTRAL YABA",bussinesId:"YB100423253156428",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01"}],RC=[{id:"1",name:'MacBook Pro 16"',price:2399,quantity:75,category:"Electronics",description:"Apple MacBook Pro 16-inch with M2 Pro chip",sku:"MBP-16-M2P",supplier:"Apple Inc.",minStock:10,location:"Warehouse A",lastUpdated:"2024-01-15"},{id:"2",name:'Dell Monitor 27"',price:299,quantity:35,category:"Electronics",description:"Dell 27-inch 4K UHD Monitor",sku:"DELL-MON-27-4K",supplier:"Dell Technologies",minStock:15,location:"Warehouse B",lastUpdated:"2024-01-14"},{id:"3",name:"Wireless Mouse",price:49.99,quantity:12,category:"Accessories",description:"Ergonomic wireless mouse with precision tracking",sku:"MOUSE-WL-001",supplier:"Logitech",minStock:25,location:"Warehouse A",lastUpdated:"2024-01-13"}],Ms=()=>{const t=new Map;return Br().forEach(e=>{const r=`${e.productId}-${e.locationId}`;let n=t.get(r);n||(n={id:r,productId:e.productId,locationId:e.locationId,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType==="in"||e.movementType==="transfer"?(e.locationId===e.toLocationId||e.movementType==="in")&&(n.quantity+=e.quantity*1):e.movementType==="out"?n.quantity-=e.quantity*1:e.movementType==="adjustment"&&(n.quantity=e.quantity*1),new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost*1,n.availableQuantity=n.quantity*1-n.reservedQuantity*1}),Array.from(t.values())},[fi,pl]=fe([]),[yi,bh]=fe(kC),[Br,Os]=fe([]),[zn,No]=fe([]),DC=()=>{const t=new Map;return Br().forEach(e=>{const r=`${e.productId}-${e.locationId}`;let n=t.get(r);n||(n={id:r,productId:e.productId,locationId:e.locationId,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType==="in"||e.movementType==="transfer"?(e.locationId===e.toLocationId||e.movementType==="in")&&(n.quantity+=e.quantity*1):e.movementType==="out"?n.quantity-=e.quantity*1:e.movementType==="adjustment"&&(n.quantity=e.quantity*1),new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost*1,n.availableQuantity=n.quantity*1-n.reservedQuantity*1}),Array.from(t.values())};No(DC());const[Vs,vl]=fe(RC),NC={TRANSFER:1,transfer:1},_h=173442384e4,Be={get products(){return fi()},get locations(){return yi()},get movements(){return Br()},get stockLevels(){return zn()},parseInventoryData:t=>{const e=Object.keys(t).slice(0,900),r=[],n=i=>{let o=t;o[i]?.products&&o[i]?.products?.map(a=>{let c=yp(o[i]?.type),u=a?.price*1||a?.unitCost*1,h=a?.qty*1||a?.quantity*1;u=isNaN(u)?0:u,h=isNaN(h)?0:h;let f={id:o[i]?.ssg_inventory_key,productId:a?.product?.id,productName:a?.product?.label,productSku:a?.product?.code,locationId:o[i]?.store,locationName:o[i]?.store,location:o[i]?.store,movementType:c,quantity:h,unitCost:u,totalCost:u*1*h,minStock:10,referenceNumber:"PO-001",notes:o[i]?.description||o[i]?.notes,createdBy:"admin",createdDate:o[i]?.createDate?new Date(o[i]?.createDate).toISOString():new Date(_h).toISOString(),invoiceId:o[i]?.invoice};if(r.push(f),NC[o[i].movementType]&&o[i]?.fromLocationId){let p=Be.getLocationById(o[i]?.fromLocationId);const _={id:o[i]?.ssg_inventory_key,productId:a?.product?.id,productName:a?.product?.label,productSku:a?.product?.code,locationId:o[i]?.fromLocationId,locationName:p?.name||"",movementType:"out",quantity:h*-1,unitCost:u,totalCost:u*-1*h,minStock:10,referenceNumber:o[i]?.referenceNumber,notes:`Transfer to ${o[i]?.locationName}`+(o[i].notes?` - ${o[i].notes}`:""),createdBy:o[i].createdBy,createdDate:o[i]?.createDate?new Date(o[i]?.createDate).toISOString():new Date(_h).toISOString(),invoiceId:o[i]?.invoiceId,toLocationId:o[i]?.locationId,toLocationName:o[i]?.locationName};r.push(_)}})};return e.map(n),r},fecthInventory:async t=>{const e=await Tn.getInventory(t),r=Be.parseInventoryData(e);Be.updMovements(r)},fecthProduct:async t=>{const e=await Tn.getProducts(t),r=Object.keys(e),n=o=>{let a=e;return{id:o,name:a[o].name,businessId:a[o].businessId,sku:a[o].code,UPC:a[o].UPC,numCode:a[o].codeN,category:a[o].category,unitCost:a[o].unitCost||0,unitOfMeasure:a[o].unitOfMeasure,minStockLevel:a[o].minStockLevel,maxStockLevel:a[o].maxStockLevel,isActive:a[o].isActive,description:a[o].description||"",createdDate:a[o].createdAt||new Date().toISOString(),lastModified:a[o].updatedAt||new Date().toISOString()}},i=r.map(n);return Be.updProduct(i),i},getProductById:t=>fi().find(e=>e.id===t),updProduct:t=>{pl(t)},getProductsBySku:t=>fi().filter(e=>e.sku.toLowerCase().includes(t.toLowerCase())),getProductsByCategory:t=>fi().filter(e=>e.category===t),getActiveProducts:()=>fi().filter(t=>t.name),getLocationById:t=>yi().find(e=>e.id===t),getLocationsByType:t=>yi().filter(e=>e.type===t),getActiveLocations:()=>yi().filter(t=>t.isActive),getMovementsByProduct:t=>Br().filter(e=>e.productId===t),updMovements:t=>{Os([...t]),No(Ms())},getMovementsByLocation:t=>Br().filter(e=>e.locationId===t),getMovementsByDateRange:(t,e)=>Br().filter(r=>r.createdDate>=t&&r.createdDate<=e),getStockByProduct:t=>zn().filter(e=>e.productId===t),getStockByLocation:t=>zn().filter(e=>e.locationId===t),getStockByProductAndLocation:(t,e)=>zn().find(r=>r.productId===t&&r.locationId===e),getTotalStockByProduct:t=>zn().filter(e=>e.productId===t).reduce((e,r)=>e*1+r.quantity*1,0),getLastLocationByProduct:t=>{const e=Br().filter(r=>r.productId===t).sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime());if(e.length>0)return yi().find(r=>r.id===e[0].locationId)},getLowStockProducts:()=>(fi()||[])?.map(t=>{const e=zn().filter(r=>r.productId===t.id).reduce((r,n)=>r+n.quantity,0);return{...t,currentStock:e}}).filter(t=>t.currentStock<=t.minStockLevel),addInventoryMovement:t=>{const e={...t,id:`mov-${Date.now()}`,createdDate:new Date().toISOString()};Os(r=>[...r,e]),No(Ms())},addBulkInventoryMovements:async t=>{const e=[],r=[],n=new Date().toISOString(),i=yi().find(c=>c.id===t.locationId);if(!i)return{success:!1,errors:["Invalid location"]};let o;if(t.movementType==="transfer"){if(!t.fromLocationId)return{success:!1,errors:["From location required for transfers"]};if(o=yi().find(c=>c.id===t.fromLocationId),!o)return{success:!1,errors:["Invalid from location"]};if(t.fromLocationId===t.locationId)return{success:!1,errors:["From and to locations cannot be the same"]}}if(t.items.forEach((c,u)=>{const h=fi().find(E=>E.id===c.productId);if(!h){e.push(`Item ${u+1}: Product not found`);return}if(c.quantity<=0){e.push(`Item ${u+1}: Quantity must be greater than 0`);return}if(t.movementType==="out"){const E=zn().filter(A=>A.productId===c.productId&&A.locationId===t.locationId).reduce((A,T)=>A+T.quantity,0);if(c.quantity>E){e.push(`Item ${u+1}: Insufficient stock. Available: ${E}, Requested: ${c.quantity}`);return}}if(t.movementType==="transfer"){const E=zn().filter(A=>A.productId===c.productId&&A.locationId===t.fromLocationId).reduce((A,T)=>A+T.quantity,0);if(c.quantity>E){e.push(`Item ${u+1}: Insufficient stock at ${o?.name}. Available: ${E}, Requested: ${c.quantity}`);return}}const f=c.unitCost||h.unitCost,p=c.quantity*f,_={id:`mov-${Date.now()}-${u}`,productId:h.id,productName:h.name,productSku:h.sku,locationId:t.locationId,locationName:i.name,movementType:t.movementType,quantity:c.quantity,unitCost:f,totalCost:p,minStock:10,referenceNumber:t.referenceNumber||"",notes:c.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:o?.name};if(r.push(_),t.movementType==="transfer"&&o){const E={id:`mov-${Date.now()}-${u}-out`,productId:h.id,productName:h.name,productSku:h.sku,locationId:t.fromLocationId,locationName:o.name,movementType:"out",quantity:c.quantity,unitCost:f,totalCost:p,minStock:10,referenceNumber:t.referenceNumber||"",notes:`Transfer to ${i.name}`+(c.notes?` - ${c.notes}`:""),createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,toLocationId:t.locationId,toLocationName:i.name};r.push(E)}}),e.length>0)return{success:!1,errors:e};Os(c=>[...c,...r]),No(Ms()),console.log({bulkRequest:t});const a=await Tn.addInventory(t);return console.log({prodResults:a}),{success:!0,errors:[]}},getMovementsByInvoice:t=>Br().filter(e=>e.invoiceId===t),getInvoiceSummary:t=>{const e=Br().filter(o=>o.invoiceId===t);if(e.length===0)return null;const r=e.reduce((o,a)=>o+a.totalCost,0),n=new Set(e.map(o=>o.productId)).size,i=e[0];return{invoiceId:t,referenceNumber:i.referenceNumber,movementType:i.movementType,location:i.locationName,fromLocation:i.fromLocationName,productCount:n,totalItems:e.reduce((o,a)=>o+a.quantity,0),totalValue:r,createdDate:i.createdDate,createdBy:i.createdBy}},addProduct:t=>{const e={...t,id:`prod-${Date.now()}`,createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};pl(r=>[...r,e])},addLocation:t=>{const e={...t,id:`loc-${Date.now()}`,createdDate:new Date().toISOString()};bh(r=>[...r,e])},updateProduct:(t,e)=>{pl(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n))},updateLocation:(t,e)=>{bh(r=>r.map(n=>n.id===t?{...n,...e}:n))},updateMovement:(t,e)=>{Os(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n)),No(Ms())},get inventory(){return Vs()},addItem(t){const e={...t,id:Date.now().toString(),lastUpdated:new Date().toISOString().split("T")[0]};return vl([...Vs(),e]),e},updateItem(t,e){vl(Vs().map(r=>r.id===t?{...r,...e,lastUpdated:new Date().toISOString().split("T")[0]}:r))},deleteItem(t){vl(Vs().filter(e=>e.id!==t))},getItemById(t){return Br().find(e=>e.id===t)},getLowStockItems(){return Br().filter(t=>t.quantity*1<=t.minStock*1)},getTotalValue(){return Br().reduce((t,e)=>t*1+e.unitCost*1*e.quantity*1,0)}};var Sh=U("<div>"),LC=U("<div><div><input type=text autocomplete=off>"),MC=U("<button type=button>+"),OC=U("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>");const By=t=>{const{t:e}=pt(),[r,n]=fe(!1),[i,o]=fe(""),[a,c]=fe(-1),u=it(()=>t.value?Be.getProductById(t.value):null),h=it(()=>{const B=i().toLowerCase();return B?Be.getActiveProducts().filter(k=>k.name.toLowerCase().includes(B)||k.sku.toLowerCase().includes(B)||k.category.toLowerCase().includes(B)):Be.getActiveProducts()}),f=()=>{n(!0),o(""),c(-1)},p=B=>{const k=B.target;o(k.value),n(!0),c(-1)},_=B=>{t.onChange(B),n(!1),o(""),c(-1)},E=B=>{const k=h();switch(B.key){case"ArrowDown":B.preventDefault(),c(W=>Math.min(W+1,k.length-1));break;case"ArrowUp":B.preventDefault(),c(W=>Math.max(W-1,-1));break;case"Enter":B.preventDefault(),a()>=0&&k[a()]&&_(k[a()]);break;case"Escape":n(!1),o(""),c(-1);break}},A=B=>{setTimeout(()=>{n(!1),o(""),c(-1)},150)},T=B=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(B),x=B=>Be.stockLevels.filter(k=>k.productId===B).reduce((k,W)=>k+W.quantity,0),$={position:"relative",width:"100%",...t.style},O={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},q={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},z=B=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid "+B?"var(--primary-color)":"var(--border-color)",background:B?"var(--strip-color)":"transparent",color:B?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),ee={display:"flex","justify-content":"space-between","align-items":"center"},Q={flex:"1"},C={"font-weight":"500","margin-bottom":"0.25rem"},v={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},S={"text-align":"right","font-size":"0.875rem"},w={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},P=()=>r()&&i()?i():u()?`${u().name} (${u().sku})`:"",I={display:"flex","align-items":"stretch",width:"100%"},y={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},le={...O,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"};return(()=>{var B=LC(),k=B.firstChild,W=k.firstChild;return d(k,I),W.addEventListener("blur",A),W.$$keydown=E,W.$$click=f,W.$$input=p,s(k,(()=>{var R=oe(()=>!!t.onAddNew);return()=>R()&&(()=>{var V=MC();return V.addEventListener("mouseleave",M=>{M.currentTarget.style.background="var(--surface-color)",M.currentTarget.style.color="var(--primary-color)"}),V.addEventListener("mouseenter",M=>{M.currentTarget.style.background="var(--primary-color)",M.currentTarget.style.color="white"}),Ti(V,"click",t.onAddNew,!0),d(V,y),K(()=>gt(V,"title",e("inventory.addProduct","Add new product"))),V})()})(),null),s(B,b(Ge,{get when(){return r()},get children(){var R=Sh();return s(R,b(Ge,{get when(){return h().length>0},get fallback(){return(()=>{var V=Sh();return d(V,w),s(V,(()=>{var M=oe(()=>!!i());return()=>M()?e("inventory.noProductsFound","No products found matching your search."):e("inventory.noProductsAvailable","No products available.")})()),V})()},get children(){return b(jt,{get each(){return h()},children:(V,M)=>{const F=x(V.id),ne=F<=V.minStockLevel;return(()=>{var L=OC(),j=L.firstChild,Z=j.firstChild,te=Z.firstChild,he=te.nextSibling,se=he.firstChild,re=se.firstChild,ye=se.nextSibling,G=ye.nextSibling,ae=G.nextSibling,Pe=ae.nextSibling,we=Z.nextSibling,ue=we.firstChild,ce=ue.firstChild,H=ue.nextSibling;return L.addEventListener("mouseenter",()=>c(M())),L.$$click=()=>_(V),d(j,ee),d(Z,Q),d(te,C),s(te,()=>V.name),d(he,v),s(se,()=>e("inventory.sku","SKU"),re),s(se,()=>V.sku,null),s(G,()=>V.category),s(Pe,()=>T(V.unitCost)),d(we,S),ue.style.setProperty("font-weight","600"),(ne?"#f44336":"var(--text-primary)")!=null?ue.style.setProperty("color",ne?"#f44336":"var(--text-primary)"):ue.style.removeProperty("color"),s(ue,F,ce),s(ue,()=>V.unitOfMeasure,null),H.style.setProperty("color","var(--text-muted)"),s(H,()=>ne?e("inventory.lowStock","Low Stock"):e("inventory.inStock","In Stock")),K(de=>d(L,z(M()===a()),de)),L})()}})}})),K(V=>d(R,q,V)),R}}),null),K(R=>{var V=$,M=le,F=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),ne=t.disabled,L=t.required;return R.e=d(B,V,R.e),R.t=d(W,M,R.t),F!==R.a&&gt(W,"placeholder",R.a=F),ne!==R.o&&(W.disabled=R.o=ne),L!==R.i&&(W.required=R.i=L),R},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),K(()=>W.value=P()),B})()};Ot(["input","click","keydown"]);var Ph=U("<div>"),VC=U("<div><div><input type=text autocomplete=off>"),BC=U("<button type=button>+"),FC=U("<div><div><div><div> </div><div><span>: </span><span></span></div><div>");const xa=t=>{const{t:e}=pt(),[r,n]=fe(!1),[i,o]=fe(""),[a,c]=fe(-1),u=it(()=>t.value?Be.getLocationById(t.value):null),h=it(()=>{let B=Be.getActiveLocations();t.filterType&&(B=B.filter(W=>W.type===t.filterType));const k=i().toLowerCase();return k?B.filter(W=>W.name.toLowerCase().includes(k)||W?.code?.toLowerCase().includes(k)||W?.type?.toLowerCase().includes(k)||W?.address?.toLowerCase().includes(k)):B}),f=()=>{n(!0),o(""),c(-1)},p=B=>{const k=B.target;o(k.value),n(!0),c(-1)},_=B=>{t.onChange(B.id),n(!1),o(""),c(-1)},E=B=>{const k=h();switch(B.key){case"ArrowDown":B.preventDefault(),c(W=>Math.min(W+1,k.length-1));break;case"ArrowUp":B.preventDefault(),c(W=>Math.max(W-1,-1));break;case"Enter":B.preventDefault(),a()>=0&&k[a()]&&_(k[a()]);break;case"Escape":n(!1),o(""),c(-1);break}},A=B=>{setTimeout(()=>{n(!1),o(""),c(-1)},150)},T=B=>({warehouse:"🏭",store:"🏪",supplier:"🚚",customer:"👥"})[B]||"📍",x=B=>({warehouse:"#2196F3",store:"#4CAF50",supplier:"#FF9800",customer:"#9C27B0"})[B]||"#757575",$={position:"relative",width:"100%",...t.style},O={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},q={display:"flex","align-items":"stretch",width:"100%"},z={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},ee={...O,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"},Q={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},C=B=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:B?"var(--strip-color)":"transparent",color:B?"var(--primary-dark)":"var(--text-primary)",transition:"all 0.2s ease"}),v={display:"flex","justify-content":"space-between","align-items":"center"},S={flex:"1"},w={"font-weight":"500","margin-bottom":"0.25rem"},P={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem","align-items":"center"},I=B=>({padding:"0.2rem 0.5rem","border-radius":"var(--border-radius-sm)","font-size":"0.7rem","font-weight":"500",background:x(B),color:"white","text-transform":"uppercase"}),y={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},le=()=>r()&&i()?i():u()?`${u().name} (${u().code})`:"";return(()=>{var B=VC(),k=B.firstChild,W=k.firstChild;return d(k,q),W.addEventListener("blur",A),W.$$keydown=E,W.$$click=f,W.$$input=p,s(k,(()=>{var R=oe(()=>!!t.onAddNew);return()=>R()&&(()=>{var V=BC();return V.addEventListener("mouseleave",M=>{M.currentTarget.style.background="var(--surface-color)",M.currentTarget.style.color="var(--primary-color)"}),V.addEventListener("mouseenter",M=>{M.currentTarget.style.background="var(--primary-color)",M.currentTarget.style.color="white"}),Ti(V,"click",t.onAddNew,!0),d(V,z),K(()=>gt(V,"title",e("inventory.addLocation","Add new location"))),V})()})(),null),s(B,b(Ge,{get when(){return r()},get children(){var R=Ph();return s(R,b(Ge,{get when(){return h().length>0},get fallback(){return(()=>{var V=Ph();return d(V,y),s(V,(()=>{var M=oe(()=>!!i());return()=>M()?e("inventory.noLocationsFound","No locations found matching your search."):e("inventory.noLocationsAvailable","No locations available.")})()),V})()},get children(){return b(jt,{get each(){return h()},children:(V,M)=>(()=>{var F=FC(),ne=F.firstChild,L=ne.firstChild,j=L.firstChild,Z=j.firstChild,te=j.nextSibling,he=te.firstChild,se=he.firstChild,re=he.nextSibling,ye=te.nextSibling;return F.addEventListener("mouseenter",()=>c(M())),F.$$click=()=>_(V),d(ne,v),d(L,S),d(j,w),s(j,()=>T(V.type),Z),s(j,()=>V.name,null),d(te,P),s(he,()=>e("inventory.locationCode","Code"),se),s(he,()=>V.code,null),s(re,()=>V.type),ye.style.setProperty("font-size","0.75rem"),ye.style.setProperty("color","var(--text-muted)"),ye.style.setProperty("margin-top","0.25rem"),s(ye,()=>V.address),K(G=>{var ae=C(M()===a()),Pe=I(V.type);return G.e=d(F,ae,G.e),G.t=d(re,Pe,G.t),G},{e:void 0,t:void 0}),F})()})}})),K(V=>d(R,Q,V)),R}}),null),K(R=>{var V=$,M=ee,F=t.placeholder||e("inventory.searchLocations","Search locations by name, code, or type..."),ne=t.disabled,L=t.required;return R.e=d(B,V,R.e),R.t=d(W,M,R.t),F!==R.a&&gt(W,"placeholder",R.a=F),ne!==R.o&&(W.disabled=R.o=ne),L!==R.i&&(W.required=R.i=L),R},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),K(()=>W.value=le()),B})()};Ot(["input","click","keydown"]);var UC=U("<form><div><label> *</label><input type=text required></div><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text list=categories required><datalist id=categories><option value=Electronics></option><option value=Accessories></option><option value=Office></option><option value=Furniture></option><option value=Software></option><option value=Hardware></option></datalist></div></div><div><label></label><textarea></textarea></div><div><div><label></label><select><option value=pcs></option><option value=kg></option><option value=lbs></option><option value=m></option><option value=ft></option><option value=l></option><option value=gal></option><option value=box></option><option value=pack></option></select></div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div></div><div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div><div></div></div><div><div><label></label><input type=number min=0 step=1></div><div><label></label><input type=number min=1 step=1></div></div><div>"),jC=U("<div>");const Wa=t=>{const{t:e}=pt(),[r,n]=fe(""),[i,o]=fe(""),[a,c]=fe(""),[u,h]=fe(""),[f,p]=fe("pcs"),[_,E]=fe(0),[A,T]=fe(0),[x,$]=fe(10),[O,q]=fe(100),[z,ee]=fe(""),Q=()=>{n(""),o(""),c(""),h(""),p("pcs"),E(0),T(0),$(10),q(100),ee("")},C=k=>{if(k.preventDefault(),ee(""),!r().trim()){ee(e("forms.productNameRequired"));return}if(!i().trim()){ee(e("forms.skuRequired"));return}if(!u().trim()){ee(e("forms.categoryRequired"));return}if(_()<0){ee(e("forms.unitCostNotNegative"));return}if(A()<0){ee(e("forms.sellingPriceNotNegative"));return}if(x()<0){ee(e("forms.minStockNotNegative"));return}if(O()<=x()){ee(e("forms.maxStockGreaterThanMin"));return}if(Be.getProductsBySku(i()).length>0){ee(e("forms.skuAlreadyExists"));return}const R={name:r().trim(),sku:i().trim().toUpperCase(),description:a().trim(),category:u().trim(),unitOfMeasure:f(),unitCost:_(),sellingPrice:A(),minStockLevel:x(),maxStockLevel:O(),isActive:!0,businessId:"default-business"};Be.addProduct(R);const V=`prod-${Date.now()}`;t.onProductAdded&&t.onProductAdded(V),Q(),t.onClose()},v=()=>{Q(),t.onClose()},S={"margin-bottom":"1.5rem"},w={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},P={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},I={...P,cursor:"pointer"},y={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},le={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},B={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"};return b(yr,{get isOpen(){return t.isOpen},onClose:v,get title(){return e("inventory.addNewProduct")},get children(){var k=UC(),W=k.firstChild,R=W.firstChild,V=R.firstChild,M=R.nextSibling,F=W.nextSibling,ne=F.firstChild,L=ne.firstChild,j=L.firstChild,Z=L.nextSibling,te=ne.nextSibling,he=te.firstChild,se=he.firstChild,re=he.nextSibling,ye=F.nextSibling,G=ye.firstChild,ae=G.nextSibling,Pe=ye.nextSibling,we=Pe.firstChild,ue=we.firstChild,ce=ue.nextSibling,H=ce.firstChild,de=H.nextSibling,X=de.nextSibling,_e=X.nextSibling,Se=_e.nextSibling,Y=Se.nextSibling,ie=Y.nextSibling,Ie=ie.nextSibling,pe=Ie.nextSibling,me=we.nextSibling,J=me.firstChild,D=J.nextSibling,ge=Pe.nextSibling,ke=ge.firstChild,Ee=ke.firstChild,Te=Ee.nextSibling,De=ge.nextSibling,Ke=De.firstChild,Me=Ke.firstChild,ve=Me.nextSibling,Le=Ke.nextSibling,Fe=Le.firstChild,ze=Fe.nextSibling,qe=De.nextSibling;return k.addEventListener("submit",C),s(R,()=>e("inventory.productName"),V),M.addEventListener("change",Ce=>n(Ce.target.value)),s(L,()=>e("inventory.sku"),j),Z.addEventListener("change",Ce=>o(Ce.target.value)),s(he,()=>e("inventory.category"),se),re.addEventListener("change",Ce=>h(Ce.target.value)),s(G,()=>e("common.description")),ae.addEventListener("change",Ce=>c(Ce.target.value)),s(ue,()=>e("inventory.unitOfMeasure")),ce.addEventListener("change",Ce=>p(Ce.target.value)),s(H,()=>e("inventory.pieces")),s(de,()=>e("inventory.kilograms")),s(X,()=>e("inventory.pounds")),s(_e,()=>e("inventory.meters")),s(Se,()=>e("inventory.feet")),s(Y,()=>e("inventory.liters")),s(ie,()=>e("inventory.gallons")),s(Ie,()=>e("inventory.boxes")),s(pe,()=>e("inventory.packs")),s(J,()=>e("inventory.unitCost")),D.addEventListener("change",Ce=>E(Number(Ce.target.value))),s(Ee,()=>e("inventory.sellingPrice")),Te.addEventListener("change",Ce=>T(Number(Ce.target.value))),s(Me,()=>e("inventory.minimumStockLevel")),ve.addEventListener("change",Ce=>$(Number(Ce.target.value))),s(Fe,()=>e("inventory.maximumStockLevel")),ze.addEventListener("change",Ce=>q(Number(Ce.target.value))),s(k,(()=>{var Ce=oe(()=>!!z());return()=>Ce()&&(()=>{var Ye=jC();return d(Ye,y),s(Ye,z),Ye})()})(),qe),d(qe,le),s(qe,b(Oe,{variant:"secondary",type:"button",onClick:v,get children(){return e("common.cancel")}}),null),s(qe,b(Oe,{variant:"primary",type:"submit",get children(){return e("inventory.addProduct")}}),null),K(Ce=>{var Ye=S,Qe=w,Ze=P,Ae=e("inventory.enterProductName"),et=B,Pt=w,rt=P,vt=e("inventory.enterSkuCode"),at=w,Vt=P,xt=e("inventory.enterCategory"),bt=S,Ue=w,Ve={...P,"min-height":"80px",resize:"vertical"},Je=e("inventory.enterProductDescription"),st=B,_t=w,nt=I,$e=w,Xe=P,ut=B,ht=w,Yt=P,zt=B,Dt=w,Gt=P,wt=w,Tt=P;return Ce.e=d(W,Ye,Ce.e),Ce.t=d(R,Qe,Ce.t),Ce.a=d(M,Ze,Ce.a),Ae!==Ce.o&&gt(M,"placeholder",Ce.o=Ae),Ce.i=d(F,et,Ce.i),Ce.n=d(L,Pt,Ce.n),Ce.s=d(Z,rt,Ce.s),vt!==Ce.h&&gt(Z,"placeholder",Ce.h=vt),Ce.r=d(he,at,Ce.r),Ce.d=d(re,Vt,Ce.d),xt!==Ce.l&&gt(re,"placeholder",Ce.l=xt),Ce.u=d(ye,bt,Ce.u),Ce.c=d(G,Ue,Ce.c),Ce.w=d(ae,Ve,Ce.w),Je!==Ce.m&&gt(ae,"placeholder",Ce.m=Je),Ce.f=d(Pe,st,Ce.f),Ce.y=d(ue,_t,Ce.y),Ce.g=d(ce,nt,Ce.g),Ce.p=d(J,$e,Ce.p),Ce.b=d(D,Xe,Ce.b),Ce.T=d(ge,ut,Ce.T),Ce.A=d(Ee,ht,Ce.A),Ce.O=d(Te,Yt,Ce.O),Ce.I=d(De,zt,Ce.I),Ce.S=d(Me,Dt,Ce.S),Ce.W=d(ve,Gt,Ce.W),Ce.C=d(Fe,wt,Ce.C),Ce.B=d(ze,Tt,Ce.B),Ce},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),K(()=>M.value=r()),K(()=>Z.value=i()),K(()=>re.value=u()),K(()=>ae.value=a()),K(()=>ce.value=f()),K(()=>D.value=_()),K(()=>Te.value=A()),K(()=>ve.value=x()),K(()=>ze.value=O()),k}})};var zC=U('<form><div><label> *</label><input type=text required></div><div><div><label> *<button type=button title="Generate code automatically"></button></label><input type=text required><div></div></div><div><label> *</label><select required><option value=warehouse> </option><option value=store> </option><option value=supplier> </option><option value=customer> </option></select><div></div></div></div><div><label> *</label><textarea required></textarea></div><div>'),qC=U("<div><div>:</div><div><span></span><div><div></div><div>"),HC=U("<div>");const lu=t=>{const{t:e}=pt(),[r,n]=fe(""),[i,o]=fe(""),[a,c]=fe("warehouse"),[u,h]=fe(""),[f,p]=fe(""),_=()=>{n(""),o(""),c("warehouse"),h(""),p("")},E=()=>{if(r()){const P=a()==="warehouse"?"WH":a()==="store"?"ST":a()==="supplier"?"SUP":"CUST",I=r().toUpperCase().replace(/[^A-Z0-9]/g,"").substring(0,3),y=String(Math.floor(Math.random()*1e3)).padStart(3,"0");o(`${P}-${I}-${y}`)}},A=P=>{if(P.preventDefault(),p(""),!r().trim()){p(e("forms.locationNameRequired"));return}if(!i().trim()){p(e("forms.locationCodeRequired"));return}if(!u().trim()){p(e("forms.addressRequired"));return}if(Be.locations.filter(B=>B.code.toLowerCase()===i().toLowerCase()).length>0){p(e("forms.locationCodeExists"));return}const y={name:r().trim(),code:i().trim().toUpperCase(),type:a(),address:u().trim(),isActive:!0};Be.addLocation(y);const le=`loc-${Date.now()}`;t.onLocationAdded&&t.onLocationAdded(le),_(),t.onClose()},T=()=>{_(),t.onClose()},x={"margin-bottom":"1.5rem"},$={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},O={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},q={...O,cursor:"pointer"},z={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},ee={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},Q={display:"grid","grid-template-columns":"2fr 1fr",gap:"1rem"},C={"font-size":"0.875rem",color:"var(--text-muted)","margin-top":"0.25rem"},v={padding:"0.25rem 0.5rem","font-size":"0.75rem","margin-left":"0.5rem",background:"var(--background-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",color:"var(--text-muted)"},S=P=>({warehouse:"🏭",store:"🏪",supplier:"🚚",customer:"👥"})[P]||"📍",w=P=>({warehouse:e("inventory.warehouseDescription"),store:e("inventory.storeDescription"),supplier:e("inventory.supplierDescription"),customer:e("inventory.customerDescription")})[P]||"";return b(yr,{get isOpen(){return t.isOpen},onClose:T,get title(){return e("inventory.addNewLocation")},get children(){var P=zC(),I=P.firstChild,y=I.firstChild,le=y.firstChild,B=y.nextSibling,k=I.nextSibling,W=k.firstChild,R=W.firstChild,V=R.firstChild,M=V.nextSibling,F=R.nextSibling,ne=F.nextSibling,L=W.nextSibling,j=L.firstChild,Z=j.firstChild,te=j.nextSibling,he=te.firstChild,se=he.firstChild,re=he.nextSibling,ye=re.firstChild,G=re.nextSibling,ae=G.firstChild,Pe=G.nextSibling,we=Pe.firstChild,ue=te.nextSibling,ce=k.nextSibling,H=ce.firstChild,de=H.firstChild,X=H.nextSibling,_e=ce.nextSibling;return P.addEventListener("submit",A),s(y,()=>e("inventory.locationName"),le),B.addEventListener("change",Se=>n(Se.target.value)),d(k,Q),s(R,()=>e("inventory.locationCode"),V),M.$$click=E,d(M,v),s(M,()=>e("common.generate")),F.addEventListener("change",Se=>o(Se.target.value)),s(ne,()=>e("inventory.uniqueIdentifierHelp")),s(j,()=>e("inventory.locationType"),Z),te.addEventListener("change",Se=>c(Se.target.value)),s(he,()=>S("warehouse"),se),s(he,()=>e("inventory.warehouse"),null),s(re,()=>S("store"),ye),s(re,()=>e("inventory.store"),null),s(G,()=>S("supplier"),ae),s(G,()=>e("inventory.supplier"),null),s(Pe,()=>S("customer"),we),s(Pe,()=>e("inventory.customer"),null),s(ue,()=>w(a())),s(H,()=>e("common.address"),de),X.addEventListener("change",Se=>h(Se.target.value)),s(P,(()=>{var Se=oe(()=>!!r());return()=>Se()&&(()=>{var Y=qC(),ie=Y.firstChild,Ie=ie.firstChild,pe=ie.nextSibling,me=pe.firstChild,J=me.nextSibling,D=J.firstChild,ge=D.nextSibling;return Y.style.setProperty("padding","1rem"),Y.style.setProperty("background","var(--background-color)"),Y.style.setProperty("border-radius","var(--border-radius-sm)"),Y.style.setProperty("border","1px solid var(--border-color)"),Y.style.setProperty("margin-bottom","1rem"),ie.style.setProperty("font-weight","500"),ie.style.setProperty("margin-bottom","0.5rem"),s(ie,()=>e("common.preview"),Ie),pe.style.setProperty("display","flex"),pe.style.setProperty("align-items","center"),pe.style.setProperty("gap","0.5rem"),me.style.setProperty("font-size","1.2rem"),s(me,()=>S(a())),D.style.setProperty("font-weight","600"),s(D,r),ge.style.setProperty("font-size","0.875rem"),ge.style.setProperty("color","var(--text-muted)"),s(ge,(()=>{var ke=oe(()=>!!i());return()=>ke()&&`${i()} • `})(),null),s(ge,a,null),Y})()})(),_e),s(P,(()=>{var Se=oe(()=>!!f());return()=>Se()&&(()=>{var Y=HC();return d(Y,z),s(Y,f),Y})()})(),_e),d(_e,ee),s(_e,b(Oe,{variant:"secondary",type:"button",onClick:T,get children(){return e("common.cancel")}}),null),s(_e,b(Oe,{variant:"primary",type:"submit",get children(){return e("inventory.addLocation")}}),null),K(Se=>{var Y=x,ie=$,Ie=O,pe=e("inventory.enterLocationName"),me=$,J=O,D=e("inventory.enterUniqueCode"),ge=C,ke=$,Ee=q,Te=C,De=x,Ke=$,Me={...O,"min-height":"100px",resize:"vertical"},ve=e("inventory.enterCompleteAddress");return Se.e=d(I,Y,Se.e),Se.t=d(y,ie,Se.t),Se.a=d(B,Ie,Se.a),pe!==Se.o&&gt(B,"placeholder",Se.o=pe),Se.i=d(R,me,Se.i),Se.n=d(F,J,Se.n),D!==Se.s&&gt(F,"placeholder",Se.s=D),Se.h=d(ne,ge,Se.h),Se.r=d(j,ke,Se.r),Se.d=d(te,Ee,Se.d),Se.l=d(ue,Te,Se.l),Se.u=d(ce,De,Se.u),Se.c=d(H,Ke,Se.c),Se.w=d(X,Me,Se.w),ve!==Se.m&&gt(X,"placeholder",Se.m=ve),Se},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),K(()=>B.value=r()),K(()=>F.value=i()),K(()=>te.value=a()),K(()=>X.value=u()),P}})};Ot(["click"]);var WC=U("<form><div>"),wh=U("<div><label> *"),GC=U("<div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment>"),KC=U("<div><label>"),YC=U("<div><label> *</label><input type=number min=0 step=1 required>"),QC=U("<div><label></label><input type=number min=0 step=0.01>"),JC=U("<div><label></label><input type=text>"),XC=U("<div><label></label><textarea>"),ZC=U("<div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span>:</span><span> "),eA=U("<div><div><span>:</span><span>"),tA=U("<div>");const rA=t=>{const{t:e}=pt(),[r,n]=fe({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""}),[i,o]=fe(""),[a,c]=fe(""),[u,h]=fe("in"),[f,p]=fe(0),[_,E]=fe(0),[A,T]=fe(""),[x,$]=fe(""),[O,q]=fe(""),[z,ee]=fe(""),[Q,C]=fe(!1),[v,S]=fe(!1),w=()=>t.mode==="movement",P=it(()=>i()?Be.getProductById(i()):null),I=it(()=>a()?Be.getLocationById(a()):null),y=it(()=>O()?Be.getLocationById(O()):null),le=it(()=>f()*_()),B=it(()=>!i()||!a()?0:Be.getStockByProductAndLocation(i(),a())?.quantity||0),k=[{value:"Electronics",label:"Electronics"},{value:"Accessories",label:"Accessories"},{value:"Furniture",label:"Furniture"},{value:"Office Supplies",label:"Office Supplies"},{value:"Software",label:"Software"},{value:"Hardware",label:"Hardware"},{value:"Consumables",label:"Consumables"}],W=[{value:"Warehouse A",label:"Warehouse A"},{value:"Warehouse B",label:"Warehouse B"},{value:"Warehouse C",label:"Warehouse C"},{value:"Storage Room",label:"Storage Room"},{value:"Main Office",label:"Main Office"}],R={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},V=()=>{o(""),c(""),h("in"),p(0),E(0),T(""),$(""),q(""),ee("")},M=()=>{n({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""})},F=Pe=>{if(Pe.preventDefault(),w()){if(ee(""),!i()){ee(e("forms.selectProduct"));return}if(!a()){ee(e("forms.selectLocation"));return}if(f()<=0){ee(e("forms.quantityGreaterThanZero"));return}if(_()<0){ee(e("forms.unitCostNotNegative"));return}if(u()==="transfer"&&!O()){ee(e("forms.selectFromLocation"));return}if(u()==="transfer"&&O()===a()){ee(e("forms.sameLocationError"));return}if(u()==="out"&&f()>B()){ee(e("forms.insufficientStock",{currentStock:B()}));return}const we=P(),ue=I(),ce={productId:we.id,productName:we.name,productSku:we.sku,locationId:ue.id,locationName:ue.name,movementType:u(),quantity:f(),unitCost:_()||we.unitCost,totalCost:le()||f()*we.unitCost,referenceNumber:A()||`AUTO-${Date.now()}`,notes:x(),createdBy:"admin",fromLocationId:u()==="transfer"?O():void 0,fromLocationName:u()==="transfer"?y()?.name:void 0};Be.addInventoryMovement(ce),V()}else{const we=r();if(!we.name||!we.price||!we.quantity||!we.category||!we.sku||!we.supplier||!we.minStock||!we.location){alert(e("forms.fillAllRequired"));return}const ue={name:we.name,price:parseFloat(we.price),quantity:parseInt(we.quantity),category:we.category,description:we.description,sku:we.sku,supplier:we.supplier,minStock:parseInt(we.minStock),location:we.location};Be.addItem(ue),M()}t.onClose()},ne=(Pe,we)=>{n(ue=>({...ue,[Pe]:we}))},L=()=>{w()?V():M(),t.onClose()},j=Pe=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Pe),Z={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},te={...Z,cursor:"pointer"},he={color:"#f44336","font-size":"0.875rem","margin-top":"0.5rem"},se={padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},re={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},ye={"font-weight":"500",color:"var(--text-muted)"},G={"font-weight":"600",color:"var(--text-primary)"},ae=()=>w()?e("inventory.addMovement"):e("inventory.addNewItem");return b(yr,{get isOpen(){return t.isOpen},onClose:L,get title(){return ae()},get children(){return[(()=>{var Pe=WC(),we=Pe.firstChild;return Pe.addEventListener("submit",F),s(Pe,(()=>{var ue=oe(()=>!!w());return()=>ue()?[(()=>{var ce=wh(),H=ce.firstChild,de=H.firstChild;return ce.style.setProperty("margin-bottom","1.5rem"),H.style.setProperty("display","block"),H.style.setProperty("margin-bottom","0.5rem"),H.style.setProperty("font-weight","500"),s(H,()=>e("inventory.product"),de),s(ce,b(By,{get value(){return i()},onChange:X=>{o(X);const _e=Be.getProductById(X);_e&&E(_e.unitCost)},get placeholder(){return e("inventory.searchProductsPlaceholder")},onAddNew:()=>C(!0),required:!0}),null),ce})(),(()=>{var ce=GC(),H=ce.firstChild,de=H.firstChild,X=H.nextSibling,_e=X.firstChild,Se=_e.nextSibling,Y=Se.nextSibling,ie=Y.nextSibling;return ce.style.setProperty("margin-bottom","1.5rem"),H.style.setProperty("display","block"),H.style.setProperty("margin-bottom","0.5rem"),H.style.setProperty("font-weight","500"),s(H,()=>e("inventory.movementType"),de),X.addEventListener("change",Ie=>h(Ie.target.value)),s(_e,()=>e("inventory.stockInPurchase")),s(Se,()=>e("inventory.stockOutSale")),s(Y,()=>e("inventory.transferBetween")),s(ie,()=>e("inventory.stockAdjustment")),K(Ie=>d(X,te,Ie)),K(()=>X.value=u()),ce})(),oe(()=>oe(()=>u()==="transfer")()&&(()=>{var ce=wh(),H=ce.firstChild,de=H.firstChild;return ce.style.setProperty("margin-bottom","1.5rem"),H.style.setProperty("display","block"),H.style.setProperty("margin-bottom","0.5rem"),H.style.setProperty("font-weight","500"),s(H,()=>e("inventory.fromLocation"),de),s(ce,b(xa,{get value(){return O()},onChange:X=>q(X),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>S(!0),required:!0}),null),ce})()),(()=>{var ce=KC(),H=ce.firstChild;return ce.style.setProperty("margin-bottom","1.5rem"),H.style.setProperty("display","block"),H.style.setProperty("margin-bottom","0.5rem"),H.style.setProperty("font-weight","500"),s(H,(()=>{var de=oe(()=>u()==="transfer");return()=>de()?e("inventory.toLocation")+" *":e("inventory.locationName")+" *"})()),s(ce,b(xa,{get value(){return a()},onChange:de=>c(de),get placeholder(){return oe(()=>u()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>S(!0),required:!0}),null),ce})(),oe(()=>oe(()=>!!(P()&&I()))()&&(()=>{var ce=ZC(),H=ce.firstChild,de=H.firstChild,X=de.firstChild,_e=de.nextSibling,Se=_e.firstChild,Y=H.nextSibling,ie=Y.firstChild,Ie=ie.firstChild,pe=ie.nextSibling,me=Y.nextSibling,J=me.firstChild,D=J.firstChild,ge=J.nextSibling,ke=ge.firstChild;return s(de,()=>e("inventory.currentStockAt",{location:I()?.name}),X),s(_e,B,Se),s(_e,()=>P()?.unitOfMeasure,null),s(ie,()=>e("inventory.productCost"),Ie),s(pe,()=>j(P()?.unitCost||0)),s(J,()=>e("inventory.minStockLevel"),D),s(ge,()=>P()?.minStockLevel,ke),s(ge,()=>P()?.unitOfMeasure,null),K(Ee=>{var Te=se,De=re,Ke=ye,Me=G,ve=re,Le=ye,Fe=G,ze=re,qe=ye,Ce=G;return Ee.e=d(ce,Te,Ee.e),Ee.t=d(H,De,Ee.t),Ee.a=d(de,Ke,Ee.a),Ee.o=d(_e,Me,Ee.o),Ee.i=d(Y,ve,Ee.i),Ee.n=d(ie,Le,Ee.n),Ee.s=d(pe,Fe,Ee.s),Ee.h=d(me,ze,Ee.h),Ee.r=d(J,qe,Ee.r),Ee.d=d(ge,Ce,Ee.d),Ee},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),ce})()),(()=>{var ce=YC(),H=ce.firstChild,de=H.firstChild,X=H.nextSibling;return ce.style.setProperty("margin-bottom","1.5rem"),H.style.setProperty("display","block"),H.style.setProperty("margin-bottom","0.5rem"),H.style.setProperty("font-weight","500"),s(H,()=>e("inventory.quantity"),de),X.addEventListener("change",_e=>p(Number(_e.target.value))),K(_e=>d(X,Z,_e)),K(()=>X.value=f()),ce})(),(()=>{var ce=QC(),H=ce.firstChild,de=H.nextSibling;return ce.style.setProperty("margin-bottom","1.5rem"),H.style.setProperty("display","block"),H.style.setProperty("margin-bottom","0.5rem"),H.style.setProperty("font-weight","500"),s(H,()=>e("inventory.unitCost")),de.addEventListener("change",X=>E(Number(X.target.value))),K(X=>{var _e=Z,Se=e("inventory.willUseDefaultCost");return X.e=d(de,_e,X.e),Se!==X.t&&gt(de,"placeholder",X.t=Se),X},{e:void 0,t:void 0}),K(()=>de.value=_()),ce})(),oe(()=>oe(()=>f()>0&&_()>0)()&&(()=>{var ce=eA(),H=ce.firstChild,de=H.firstChild,X=de.firstChild,_e=de.nextSibling;return s(de,()=>e("inventory.totalCost"),X),s(_e,()=>j(le())),K(Se=>{var Y=se,ie=re,Ie=ye,pe={...G,"font-size":"1.2rem",color:"var(--primary-color)"};return Se.e=d(ce,Y,Se.e),Se.t=d(H,ie,Se.t),Se.a=d(de,Ie,Se.a),Se.o=d(_e,pe,Se.o),Se},{e:void 0,t:void 0,a:void 0,o:void 0}),ce})()),(()=>{var ce=JC(),H=ce.firstChild,de=H.nextSibling;return ce.style.setProperty("margin-bottom","1.5rem"),H.style.setProperty("display","block"),H.style.setProperty("margin-bottom","0.5rem"),H.style.setProperty("font-weight","500"),s(H,()=>e("common.referenceNumber")),de.addEventListener("change",X=>T(X.target.value)),K(X=>{var _e=Z,Se=e("common.referenceNumberPlaceholder");return X.e=d(de,_e,X.e),Se!==X.t&&gt(de,"placeholder",X.t=Se),X},{e:void 0,t:void 0}),K(()=>de.value=A()),ce})(),(()=>{var ce=XC(),H=ce.firstChild,de=H.nextSibling;return ce.style.setProperty("margin-bottom","1.5rem"),H.style.setProperty("display","block"),H.style.setProperty("margin-bottom","0.5rem"),H.style.setProperty("font-weight","500"),s(H,()=>e("common.notes")),de.addEventListener("change",X=>$(X.target.value)),K(X=>{var _e={...Z,"min-height":"100px",resize:"vertical"},Se=e("inventory.additionalNotesPlaceholder");return X.e=d(de,_e,X.e),Se!==X.t&&gt(de,"placeholder",X.t=Se),X},{e:void 0,t:void 0}),K(()=>de.value=x()),ce})(),oe(()=>oe(()=>!!z())()&&(()=>{var ce=tA();return d(ce,he),s(ce,z),ce})())]:[b(Rt,{get label(){return e("inventory.itemName")},get value(){return r().name},onChange:ce=>ne("name",ce),get placeholder(){return e("inventory.enterItemName")},required:!0}),b(Rt,{get label(){return e("inventory.sku")},get value(){return r().sku},onChange:ce=>ne("sku",ce),get placeholder(){return e("inventory.enterSkuCode")},required:!0}),b(_r,{get label(){return e("inventory.category")},get value(){return r().category},onChange:ce=>ne("category",ce),options:k,required:!0}),b(Rt,{get label(){return e("common.description")},get value(){return r().description},onChange:ce=>ne("description",ce),get placeholder(){return e("inventory.enterItemDescription")}}),b(Rt,{get label(){return e("common.price")},type:"number",get value(){return r().price},onChange:ce=>ne("price",ce),get placeholder(){return e("common.enterPrice")},required:!0}),b(Rt,{get label(){return e("inventory.quantity")},type:"number",get value(){return r().quantity},onChange:ce=>ne("quantity",ce),get placeholder(){return e("inventory.enterQuantity")},required:!0}),b(Rt,{get label(){return e("inventory.minimumStock")},type:"number",get value(){return r().minStock},onChange:ce=>ne("minStock",ce),get placeholder(){return e("inventory.enterMinStockLevel")},required:!0}),b(Rt,{get label(){return e("inventory.supplier")},get value(){return r().supplier},onChange:ce=>ne("supplier",ce),get placeholder(){return e("inventory.enterSupplierName")},required:!0}),b(_r,{get label(){return e("inventory.location")},get value(){return r().location},onChange:ce=>ne("location",ce),options:W,required:!0})]})(),we),d(we,R),s(we,b(Oe,{variant:"secondary",type:"button",onClick:L,get children(){return e("common.cancel")}}),null),s(we,b(Oe,{variant:"primary",type:"submit",get children(){return oe(()=>!!w())()?e("inventory.addMovement"):e("inventory.addItem")}}),null),Pe})(),b(Wa,{get isOpen(){return Q()},onClose:()=>C(!1),onProductAdded:Pe=>{o(Pe),C(!1)}}),b(lu,{get isOpen(){return v()},onClose:()=>S(!1),onLocationAdded:Pe=>{u()==="transfer"&&!O()?q(Pe):c(Pe),S(!1)}})]}})};Ot(["input","keydown"]);var nA=U("<form><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text required></div></div><div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><div><label></label></div></div><div><div><h3></h3></div></div><div><label></label><textarea></textarea></div><div>"),iA=U("<div><label> *"),oA=U("<div><div></div><div></div><div></div><div></div><div>"),bl=U("<div>"),sA=U("<div><input type=number min=0 step=1 required><input type=number min=0 step=0.01><input type=text>"),aA=U("<div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span>"),lA=U("<div>• ");const cA=t=>{const{t:e}=pt(),[r,n]=fe(`INV-${Date.now()}`),[i,o]=fe(""),[a,c]=fe("in"),[u,h]=fe(""),[f,p]=fe(""),[_,E]=fe(""),[A,T]=fe([]),[x,$]=fe([]),[O,q]=fe(!1),[z,ee]=fe(!1),Q=()=>{T(se=>[...se,{productId:"",quantity:0,unitCost:0,notes:""}])},C=se=>{T(re=>re.filter((ye,G)=>G!==se))},v=(se,re,ye)=>{T(G=>G.map((ae,Pe)=>Pe===se?{...ae,[re]:ye}:ae))},S=()=>{n(`INV-${Date.now()}`),o(""),c("in"),h(""),p(""),E(""),T([]),$([])},w=async se=>{se.preventDefault(),$([]);const re=[];if(i()||re.push(e("forms.referenceNumberRequired")),u()||re.push(e("forms.locationRequired")),a()==="transfer"&&!f()&&re.push(e("forms.fromLocationRequired")),A().length===0&&re.push(e("forms.atLeastOneProduct")),A().forEach((ae,Pe)=>{ae.productId||re.push(e("forms.itemProductRequired","Product is required for item {{index}}",{index:Pe+1})),ae.quantity<=0&&re.push(e("forms.itemQuantityRequired","Quantity must be greater than 0 for item {{index}}",{index:Pe+1}))}),re.length>0){$(re);return}const ye={ssg_inventory_key:qs(),invoiceId:r(),referenceNumber:i(),movementType:a(),type:Ol(a()),locationId:u(),fromLocationId:a()==="transfer"?f():void 0,items:A(),products:A(),generalNotes:_(),description:_(),invoice:i(),store:u(),createdBy:"admin",createDate:new Date().toISOString()};console.log(ye);const G=await Be.addBulkInventoryMovements(ye);console.log(G),G.success?(S(),t.onClose()):$(G.errors)},P=()=>{S(),t.onClose()},I=it(()=>A().reduce((se,re)=>{const ye=Be.getProductById(re.productId),G=re.unitCost||ye?.unitCost||0;return se+re.quantity*G},0)),y=it(()=>A().reduce((se,re)=>se+re.quantity,0)),le={"margin-bottom":"1.5rem"},B={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},k={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},W={...k,cursor:"pointer"},R={display:"grid",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},V={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},M={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem","padding-left":"0.75rem"},F={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},ne={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},L={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},j={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},Z=se=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(se),te=se=>({in:e("inventory.purchaseReceive"),out:e("inventory.saleIssue"),transfer:e("inventory.transfer"),adjustment:e("inventory.adjustment")})[se]||se,he=async se=>{await Be.fecthInventory(se),await Be.fecthProduct(se)};return yn(()=>{he("prod")}),b(yr,{get isOpen(){return t.isOpen},onClose:P,get title(){return e("inventory.bulkMovement")},get children(){return[(()=>{var se=nA(),re=se.firstChild,ye=re.firstChild,G=ye.firstChild,ae=G.firstChild,Pe=G.nextSibling,we=ye.nextSibling,ue=we.firstChild,ce=ue.firstChild,H=ue.nextSibling,de=re.nextSibling,X=de.firstChild,_e=X.firstChild,Se=X.nextSibling,Y=Se.firstChild,ie=Y.nextSibling,Ie=ie.nextSibling,pe=Ie.nextSibling,me=de.nextSibling,J=me.firstChild,D=J.firstChild,ge=me.nextSibling,ke=ge.firstChild,Ee=ke.firstChild,Te=ge.nextSibling,De=Te.firstChild,Ke=De.nextSibling,Me=Te.nextSibling;return se.addEventListener("submit",w),re.style.setProperty("display","grid"),re.style.setProperty("grid-template-columns","1fr 1fr"),re.style.setProperty("gap","1rem"),re.style.setProperty("margin-bottom","1.5rem"),s(G,()=>e("common.invoiceDocumentId"),ae),Pe.addEventListener("change",ve=>n(ve.target.value)),s(ue,()=>e("common.referenceNumber"),ce),H.addEventListener("change",ve=>o(ve.target.value)),s(X,()=>e("inventory.movementType"),_e),Se.addEventListener("change",ve=>c(ve.target.value)),s(Y,()=>e("inventory.purchaseReceive")),s(ie,()=>e("inventory.saleIssue")),s(Ie,()=>e("inventory.transfer")),s(pe,()=>e("inventory.adjustment")),me.style.setProperty("display","grid"),me.style.setProperty("gap","1rem"),me.style.setProperty("margin-bottom","1.5rem"),s(me,(()=>{var ve=oe(()=>a()==="transfer");return()=>ve()&&(()=>{var Le=iA(),Fe=Le.firstChild,ze=Fe.firstChild;return s(Fe,()=>e("inventory.fromLocation"),ze),s(Le,b(xa,{get value(){return f()},onChange:qe=>p(qe),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>ee(!0),required:!0}),null),K(qe=>d(Fe,B,qe)),Le})()})(),J),s(D,(()=>{var ve=oe(()=>a()==="transfer");return()=>ve()?e("inventory.toLocation")+" *":e("inventory.location")+" *"})()),s(J,b(xa,{get value(){return u()},onChange:ve=>h(ve),get placeholder(){return oe(()=>a()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>ee(!0),required:!0}),null),ke.style.setProperty("display","flex"),ke.style.setProperty("justify-content","space-between"),ke.style.setProperty("align-items","center"),ke.style.setProperty("margin-bottom","1rem"),Ee.style.setProperty("margin","0"),Ee.style.setProperty("font-size","1.1rem"),s(Ee,()=>e("inventory.products")),s(ke,b(Oe,{variant:"outline",type:"button",onClick:Q,get children(){return e("inventory.addProduct")}}),null),s(ge,(()=>{var ve=oe(()=>A().length>0);return()=>ve()&&[(()=>{var Le=oA(),Fe=Le.firstChild,ze=Fe.nextSibling,qe=ze.nextSibling,Ce=qe.nextSibling;return d(Le,M),s(Fe,()=>e("inventory.product")),s(ze,()=>e("inventory.quantity")),s(qe,()=>e("inventory.unitCost")),s(Ce,()=>e("common.notes")),Le})(),b(jt,{get each(){return A()},children:(Le,Fe)=>[(()=>{var ze=bl();return d(ze,R),s(ze,b(By,{get value(){return Le.productId},onChange:qe=>{v(Fe(),"productId",qe.id);let Ce={id:qe.id,label:qe.name,code:qe.sku};v(Fe(),"product",Ce);const Ye=Be.getProductById(qe.id);Ye&&!Le.unitCost&&v(Fe(),"unitCost",Ye.unitCost)},get placeholder(){return e("inventory.searchProduct")},onAddNew:()=>q(!0),required:!0})),ze})(),(()=>{var ze=sA(),qe=ze.firstChild,Ce=qe.nextSibling,Ye=Ce.nextSibling;return d(ze,V),qe.addEventListener("change",Qe=>v(Fe(),"quantity",Number(Qe.target.value))),Ce.addEventListener("change",Qe=>v(Fe(),"unitCost",Number(Qe.target.value))),Ye.addEventListener("change",Qe=>v(Fe(),"notes",Qe.target.value)),s(ze,b(Oe,{variant:"outline",size:"sm",type:"button",onClick:()=>C(Fe()),style:{color:"#f44336","border-color":"#f44336"},get children(){return e("common.remove")}}),null),K(Qe=>{var Ze=k,Ae=k,et=e("common.auto"),Pt=k,rt=e("common.optionalNotes");return Qe.e=d(qe,Ze,Qe.e),Qe.t=d(Ce,Ae,Qe.t),et!==Qe.a&&gt(Ce,"placeholder",Qe.a=et),Qe.o=d(Ye,Pt,Qe.o),rt!==Qe.i&&gt(Ye,"placeholder",Qe.i=rt),Qe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),K(()=>qe.value=Le.quantity),K(()=>Ce.value=Le.unitCost),K(()=>Ye.value=Le.notes),ze})()]})]})(),null),s(ge,(()=>{var ve=oe(()=>A().length===0);return()=>ve()&&(()=>{var Le=bl();return Le.style.setProperty("text-align","center"),Le.style.setProperty("padding","2rem"),Le.style.setProperty("background","var(--background-color)"),Le.style.setProperty("border-radius","var(--border-radius-sm)"),Le.style.setProperty("border","1px solid var(--border-color)"),Le.style.setProperty("color","var(--text-muted)"),s(Le,()=>e("inventory.noProductsAdded")),Le})()})(),null),s(se,(()=>{var ve=oe(()=>A().length>0);return()=>ve()&&(()=>{var Le=aA(),Fe=Le.firstChild,ze=Fe.nextSibling,qe=ze.firstChild,Ce=qe.firstChild,Ye=qe.nextSibling,Qe=ze.nextSibling,Ze=Qe.firstChild,Ae=Ze.firstChild,et=Ze.nextSibling,Pt=Qe.nextSibling,rt=Pt.firstChild,vt=rt.firstChild,at=rt.nextSibling,Vt=Pt.nextSibling,xt=Vt.firstChild,bt=xt.firstChild,Ue=xt.nextSibling;return d(Le,F),Fe.style.setProperty("margin","0 0 1rem 0"),Fe.style.setProperty("font-size","1rem"),s(Fe,()=>e("common.summary")),s(qe,()=>e("inventory.totalProducts"),Ce),Ye.style.setProperty("font-weight","600"),s(Ye,()=>A().length),s(Ze,()=>e("inventory.totalItems"),Ae),et.style.setProperty("font-weight","600"),s(et,y),s(rt,()=>e("inventory.totalValue"),vt),at.style.setProperty("font-weight","600"),at.style.setProperty("color","var(--primary-color)"),s(at,()=>Z(I())),s(xt,()=>e("inventory.movementType"),bt),Ue.style.setProperty("font-weight","600"),s(Ue,()=>te(a())),K(Ve=>{var Je=ne,st=ne,_t=ne,nt=ne;return Ve.e=d(ze,Je,Ve.e),Ve.t=d(Qe,st,Ve.t),Ve.a=d(Pt,_t,Ve.a),Ve.o=d(Vt,nt,Ve.o),Ve},{e:void 0,t:void 0,a:void 0,o:void 0}),Le})()})(),Te),s(De,()=>e("common.generalNotes")),Ke.addEventListener("change",ve=>E(ve.target.value)),s(se,(()=>{var ve=oe(()=>x().length>0);return()=>ve()&&(()=>{var Le=bl();return d(Le,L),s(Le,b(jt,{get each(){return x()},children:Fe=>(()=>{var ze=lA();return ze.firstChild,s(ze,Fe,null),ze})()})),Le})()})(),Me),d(Me,j),s(Me,b(Oe,{variant:"secondary",type:"button",onClick:P,get children(){return e("common.cancel")}}),null),s(Me,b(Oe,{variant:"primary",type:"submit",get children(){return e("inventory.createMovement")}}),null),K(ve=>{var Le=B,Fe=k,ze=B,qe=k,Ce=e("common.referenceNumberPlaceholder"),Ye=le,Qe=B,Ze=W,Ae=a()==="transfer"?"1fr 1fr":"1fr",et=B,Pt=le,rt=le,vt=B,at={...k,"min-height":"80px",resize:"vertical"},Vt=e("inventory.generalNotesPlaceholder");return ve.e=d(G,Le,ve.e),ve.t=d(Pe,Fe,ve.t),ve.a=d(ue,ze,ve.a),ve.o=d(H,qe,ve.o),Ce!==ve.i&&gt(H,"placeholder",ve.i=Ce),ve.n=d(de,Ye,ve.n),ve.s=d(X,Qe,ve.s),ve.h=d(Se,Ze,ve.h),Ae!==ve.r&&((ve.r=Ae)!=null?me.style.setProperty("grid-template-columns",Ae):me.style.removeProperty("grid-template-columns")),ve.d=d(D,et,ve.d),ve.l=d(ge,Pt,ve.l),ve.u=d(Te,rt,ve.u),ve.c=d(De,vt,ve.c),ve.w=d(Ke,at,ve.w),Vt!==ve.m&&gt(Ke,"placeholder",ve.m=Vt),ve},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),K(()=>Pe.value=r()),K(()=>H.value=i()),K(()=>Se.value=a()),K(()=>Ke.value=_()),se})(),b(Wa,{get isOpen(){return O()},onClose:()=>q(!1),onProductAdded:se=>{q(!1)}}),b(lu,{get isOpen(){return z()},onClose:()=>ee(!1),onLocationAdded:se=>{a()==="transfer"&&!f()?p(se):h(se),ee(!1)}})]}})};var uA=U("<div><div></div><div></div><div></div><div>"),dA=U("<div><strong>:</strong> "),hA=U("<div><div><span></span><span></span></div><div><span></span><span> </span></div><div><span></span><span> </span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),mA=U("<div>");const fA=t=>{const{t:e}=pt(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},i={"font-weight":"600",color:"var(--text-primary)"},o={"text-align":"center","margin-bottom":"2rem"},a={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},c={color:"var(--text-muted)","font-size":"1rem"},u={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"1rem"},h=(T,x)=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:T>x?"#d4edda":"#f8d7da",color:T>x?"#155724":"#721c24"}),f={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},p={"margin-bottom":"1.5rem",padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",color:"var(--text-secondary)"};if(!t.item)return null;const _=T=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(T),E=T=>new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),A=t.item.price*t.item.quantity;return b(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.itemDetails")},get children(){return[(()=>{var T=uA(),x=T.firstChild,$=x.nextSibling,O=$.nextSibling,q=O.nextSibling;return d(T,o),d(x,a),s(x,()=>t.item.name),d($,c),s($,()=>t.item.category),d(O,u),s(O,()=>_(t.item.price)),s(q,(()=>{var z=oe(()=>t.item.quantity>t.item.minStock);return()=>z()?e("inventory.inStock"):e("inventory.lowStockAlert")})()),K(z=>d(q,h(t.item.quantity,t.item.minStock),z)),T})(),(()=>{var T=dA(),x=T.firstChild,$=x.firstChild;return x.nextSibling,d(T,p),s(x,()=>e("common.description"),$),s(T,()=>t.item.description,null),T})(),(()=>{var T=hA(),x=T.firstChild,$=x.firstChild,O=$.nextSibling,q=x.nextSibling,z=q.firstChild,ee=z.nextSibling,Q=ee.firstChild,C=q.nextSibling,v=C.firstChild,S=v.nextSibling,w=S.firstChild,P=C.nextSibling,I=P.firstChild,y=I.nextSibling,le=P.nextSibling,B=le.firstChild,k=B.nextSibling,W=le.nextSibling,R=W.firstChild,V=R.nextSibling,M=W.nextSibling,F=M.firstChild,ne=F.nextSibling;return s($,()=>e("inventory.sku")),s(O,()=>t.item.sku),s(z,()=>e("inventory.quantity")),s(ee,()=>t.item.quantity,Q),s(ee,()=>e("common.units"),null),s(v,()=>e("inventory.minimumStock")),s(S,()=>t.item.minStock,w),s(S,()=>e("common.units"),null),s(I,()=>e("inventory.totalValue")),s(y,()=>_(A)),s(B,()=>e("inventory.supplier")),s(k,()=>t.item.supplier),s(R,()=>e("inventory.location")),s(V,()=>t.item.location),s(F,()=>e("common.lastUpdated")),s(ne,()=>E(t.item.lastUpdated)),K(L=>{var j=r,Z=n,te=i,he=r,se=n,re=i,ye=r,G=n,ae=i,Pe=r,we=n,ue=i,ce=r,H=n,de=i,X=r,_e=n,Se=i,Y=r,ie=n,Ie=i;return L.e=d(x,j,L.e),L.t=d($,Z,L.t),L.a=d(O,te,L.a),L.o=d(q,he,L.o),L.i=d(z,se,L.i),L.n=d(ee,re,L.n),L.s=d(C,ye,L.s),L.h=d(v,G,L.h),L.r=d(S,ae,L.r),L.d=d(P,Pe,L.d),L.l=d(I,we,L.l),L.u=d(y,ue,L.u),L.c=d(le,ce,L.c),L.w=d(B,H,L.w),L.m=d(k,de,L.m),L.f=d(W,X,L.f),L.y=d(R,_e,L.y),L.g=d(V,Se,L.g),L.p=d(M,Y,L.p),L.b=d(F,ie,L.b),L.T=d(ne,Ie,L.T),L},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),T})(),(()=>{var T=mA();return d(T,f),s(T,b(Oe,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(T,b(Oe,{variant:"primary",onClick:()=>{console.log("Edit item:",t.item.id)},get children(){return e("common.editItem")}}),null),T})()]}})};var yA=U("<div>🔄"),gA=U("<button type=button>×"),pA=U("<div>⚠️ "),Ch=U("<div>"),vA=U("<div><div><input type=text autocomplete=off>"),bA=U("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>"),_A=U("<span>⚠️ ");const SA=t=>{const{t:e}=pt(),[r,n]=fe(""),[i,o]=fe(!1),[a,c]=fe(null),[u,h]=fe([]),[f,p]=fe(!1),[_,E]=fe(-1),[A,T]=fe(null),x=t.searchDelay||300;t.maxResults;const $=async j=>{if(!j.trim()||j.trim().length<3){h([]),t.onSearchResults?.([]);return}try{o(!0),c(null);try{console.log("apiResults",j),t.onSearchResults?.(j)}catch(Z){console.warn("API search failed, using local fallback:",Z),c("API search failed, showing local results")}}catch(Z){const te=Z instanceof Error?Z.message:"Search failed";c(te),h([]),t.onSearchResults?.([])}finally{o(!1)}},O=j=>{const te=j.target.value;n(te),c(null),console.log(),t.showResults,A()&&clearTimeout(A());const he=setTimeout(()=>{$(te)},x);T(he)},q=j=>{n(j.name),p(!1),E(-1),t.onInventorySelect?.(j)},z=j=>{if(!(!f()||u().length===0))switch(j.key){case"ArrowDown":j.preventDefault(),E(Z=>Math.min(Z+1,u().length-1));break;case"ArrowUp":j.preventDefault(),E(Z=>Math.max(Z-1,-1));break;case"Enter":j.preventDefault(),_()>=0&&u()[_()]&&q(u()[_()]);break;case"Escape":p(!1),E(-1);break}},ee=()=>{t.showResults!==!1&&u().length>0&&p(!0)},Q=()=>{setTimeout(()=>{p(!1),E(-1)},150)},C=()=>{n(""),h([]),c(null),p(!1),E(-1),t.onSearchResults?.([]),A()&&(clearTimeout(A()),T(null))},v=j=>Be.stockLevels.filter(Z=>Z.inventoryId===j).reduce((Z,te)=>Z+te.quantity,0),S=j=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(j),w={position:"relative",width:"100%",...t.style},P={position:"relative",display:"flex","align-items":"center"},I={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},y={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},le={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},B={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},k=j=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:j?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),W={display:"flex","justify-content":"space-between","align-items":"center"},R={flex:"1"},V={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},M={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},F={"text-align":"right","font-size":"0.875rem"},ne={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},L={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var j=vA(),Z=j.firstChild,te=Z.firstChild;return te.addEventListener("blur",Q),te.addEventListener("focus",ee),te.$$keydown=z,te.$$input=O,s(Z,b(Ge,{get when(){return i()},get children(){var he=yA();return K(se=>d(he,le,se)),he}}),null),s(Z,b(Ge,{get when(){return oe(()=>!!r())()&&!i()},get children(){var he=gA();return he.addEventListener("mouseleave",se=>{se.currentTarget.style.background="none",se.currentTarget.style.color="var(--text-muted)"}),he.addEventListener("mouseenter",se=>{se.currentTarget.style.background="var(--border-color)",se.currentTarget.style.color="var(--text-primary)"}),he.$$click=C,K(se=>{var re=y,ye=e("common.clear","Clear search");return se.e=d(he,re,se.e),ye!==se.t&&gt(he,"title",se.t=ye),se},{e:void 0,t:void 0}),he}}),null),s(j,b(Ge,{get when(){return f()&&t.showResults!==!1},get children(){var he=Ch();return s(he,b(Ge,{get when(){return a()},get children(){var se=pA();return se.firstChild,d(se,L),s(se,a,null),se}}),null),s(he,b(Ge,{get when(){return u().length>0},get fallback(){return oe(()=>!!(r()&&!i()))()&&(()=>{var se=Ch();return d(se,ne),s(se,()=>e("inventory.noInventorysFound","No inventorys found matching your search.")),se})()},get children(){return b(jt,{get each(){return u()},children:(se,re)=>{const ye=v(se.id),G=ye<=se.minStockLevel;return(()=>{var ae=bA(),Pe=ae.firstChild,we=Pe.firstChild,ue=we.firstChild,ce=ue.nextSibling,H=ce.firstChild,de=H.firstChild,X=H.nextSibling,_e=X.nextSibling,Se=_e.nextSibling,Y=Se.nextSibling,ie=we.nextSibling,Ie=ie.firstChild,pe=Ie.firstChild,me=Ie.nextSibling;return ae.addEventListener("mouseenter",()=>E(re())),ae.$$click=()=>q(se),d(Pe,W),d(we,R),d(ue,V),s(ue,()=>se.name),d(ce,M),s(H,()=>e("inventory.sku","SKU"),de),s(H,()=>se.sku,null),s(_e,()=>se.category),s(Y,()=>S(se.unitCost)),d(ie,F),Ie.style.setProperty("font-weight","600"),(G?"#f44336":"var(--text-primary)")!=null?Ie.style.setProperty("color",G?"#f44336":"var(--text-primary)"):Ie.style.removeProperty("color"),s(Ie,ye,pe),s(Ie,()=>se.unitOfMeasure,null),me.style.setProperty("color","var(--text-muted)"),s(me,()=>G?(()=>{var J=_A();return J.firstChild,J.style.setProperty("color","#f44336"),s(J,()=>e("inventory.lowStock","Low Stock"),null),J})():e("inventory.inStock","In Stock")),K(J=>d(ae,k(re()===_()),J)),ae})()}})}}),null),K(se=>d(he,B,se)),he}}),null),K(he=>{var se=w,re=P,ye=I,G=t.placeholder||e("inventory.searchInventorys","Search inventorys by name, SKU, or category..."),ae=t.disabled;return he.e=d(j,se,he.e),he.t=d(Z,re,he.t),he.a=d(te,ye,he.a),G!==he.o&&gt(te,"placeholder",he.o=G),ae!==he.i&&(te.disabled=he.i=ae),he},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),K(()=>te.value=r()),j})()};Ot(["input","keydown","click"]);var PA=U("<div>"),_l=U("<div><span>:</span><span>"),wA=U("<div><button> "),CA=U("<div><div><div><h3></h3><div>: </div></div><div><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span> <!>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span>");const AA=t=>{const{t:e}=pt(),r=E=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(E),n=E=>new Date(E).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),i=E=>({in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}})[E]||{bg:"#f5f5f5",color:"#666"},o=E=>({in:"📦",out:"📤",transfer:"🔄",adjustment:"⚖️"})[E]||"📋",a=()=>t.movement,c={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},u={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},h={"font-weight":"600",color:"var(--text-primary)","text-align":"right"},f={"margin-bottom":"1.5rem"},p={"font-weight":"600","margin-bottom":"0.75rem","padding-bottom":"0.5rem","border-bottom":"2px solid var(--border-color)"},_=E=>({display:"inline-flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"600","text-transform":"uppercase","letter-spacing":"0.5px",background:i(E).bg,color:i(E).color});return b(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.movementDetails")},size:"lg",get children(){return b(Ge,{get when(){return a()},get fallback(){return(()=>{var E=PA();return s(E,()=>e("common.noDataFound")),E})()},children:E=>(()=>{var A=CA(),T=A.firstChild,x=T.firstChild,$=x.firstChild,O=$.nextSibling,q=O.firstChild,z=x.nextSibling,ee=z.firstChild,Q=T.nextSibling,C=Q.firstChild,v=C.nextSibling,S=v.firstChild,w=S.firstChild,P=S.nextSibling,I=v.nextSibling,y=I.firstChild,le=y.firstChild,B=y.nextSibling,k=B.firstChild,W=I.nextSibling,R=W.firstChild,V=R.firstChild,M=R.nextSibling,F=W.nextSibling,ne=F.firstChild,L=ne.firstChild,j=L.nextSibling;j.nextSibling;var Z=ne.nextSibling,te=Q.nextSibling,he=te.firstChild,se=he.nextSibling,re=se.firstChild,ye=re.firstChild,G=re.nextSibling,ae=te.nextSibling,Pe=ae.firstChild,we=Pe.nextSibling,ue=we.firstChild,ce=ue.firstChild,H=ue.nextSibling,de=we.nextSibling,X=de.firstChild,_e=X.firstChild,Se=X.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),T.style.setProperty("margin-bottom","1.5rem"),T.style.setProperty("padding-bottom","1rem"),T.style.setProperty("border-bottom","2px solid var(--border-color)"),$.style.setProperty("margin","0 0 0.5rem 0"),$.style.setProperty("font-size","1.25rem"),s($,()=>E().productName),O.style.setProperty("font-size","0.875rem"),O.style.setProperty("color","var(--text-muted)"),s(O,()=>e("inventory.sku"),q),s(O,()=>E().productSku,null),ee.style.setProperty("font-size","1.2rem"),s(ee,()=>o(E().movementType)),s(z,()=>E().movementType,null),s(C,()=>e("inventory.movementInformation")),s(S,()=>e("inventory.referenceNumber"),w),s(P,()=>E().referenceNumber),s(y,()=>e("common.quantity"),le),s(B,()=>E().quantity,k),s(B,()=>e("common.units"),null),s(R,()=>e("inventory.unitCost"),V),s(M,()=>r(E().unitCost)),s(ne,()=>e("common.total"),L),s(ne,()=>e("common.value"),j),s(Z,()=>r(E().totalCost)),s(he,()=>e("inventory.locationInformation")),s(re,()=>e("inventory.location"),ye),s(G,()=>E().locationName),s(te,b(Ge,{get when(){return E().fromLocationName},get children(){var Y=_l(),ie=Y.firstChild,Ie=ie.firstChild,pe=ie.nextSibling;return s(ie,()=>e("common.from"),Ie),s(pe,()=>E().fromLocationName),K(me=>{var J=c,D=u,ge=h;return me.e=d(Y,J,me.e),me.t=d(ie,D,me.t),me.a=d(pe,ge,me.a),me},{e:void 0,t:void 0,a:void 0}),Y}}),null),s(te,b(Ge,{get when(){return E().invoiceId},get children(){var Y=_l(),ie=Y.firstChild,Ie=ie.firstChild,pe=ie.nextSibling;return s(ie,()=>e("common.invoice"),Ie),s(pe,()=>E().invoiceId),K(me=>{var J=c,D=u,ge={...h,color:"var(--primary-color)"};return me.e=d(Y,J,me.e),me.t=d(ie,D,me.t),me.a=d(pe,ge,me.a),me},{e:void 0,t:void 0,a:void 0}),Y}}),null),s(Pe,()=>e("common.details")),s(ue,()=>e("common.createdBy"),ce),s(H,()=>E().createdBy),s(X,()=>e("common.created"),_e),s(Se,()=>n(E().createdDate)),s(ae,b(Ge,{get when(){return E().notes},get children(){var Y=_l(),ie=Y.firstChild,Ie=ie.firstChild,pe=ie.nextSibling;return s(ie,()=>e("common.notes"),Ie),s(pe,()=>E().notes),K(me=>{var J={...c,"border-bottom":"none"},D=u,ge={...h,"font-style":"italic","max-width":"60%","white-space":"pre-wrap"};return me.e=d(Y,J,me.e),me.t=d(ie,D,me.t),me.a=d(pe,ge,me.a),me},{e:void 0,t:void 0,a:void 0}),Y}}),null),s(A,b(Ge,{get when(){return t.onEdit},get children(){var Y=wA(),ie=Y.firstChild,Ie=ie.firstChild;return Y.style.setProperty("display","flex"),Y.style.setProperty("justify-content","flex-end"),Y.style.setProperty("margin-top","1.5rem"),Y.style.setProperty("padding-top","1rem"),Y.style.setProperty("border-top","1px solid var(--border-color)"),ie.addEventListener("mouseleave",pe=>{pe.currentTarget.style.transform="translateY(0)",pe.currentTarget.style.boxShadow="none"}),ie.addEventListener("mouseenter",pe=>{pe.currentTarget.style.transform="translateY(-1px)",pe.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)"}),ie.$$click=()=>t.onEdit?.(E()),ie.style.setProperty("padding","0.5rem 1.5rem"),ie.style.setProperty("border-radius","var(--border-radius-sm)"),ie.style.setProperty("border","1px solid var(--primary-color)"),ie.style.setProperty("background","var(--primary-color)"),ie.style.setProperty("color","white"),ie.style.setProperty("cursor","pointer"),ie.style.setProperty("font-weight","500"),ie.style.setProperty("transition","all 0.2s ease"),s(ie,()=>e("common.edit"),Ie),s(ie,()=>e("inventory.movement"),null),Y}}),null),K(Y=>{var ie=_(E().movementType),Ie=f,pe=p,me=c,J=u,D=h,ge=c,ke=u,Ee={...h,"font-size":"1.1rem",color:"var(--primary-color)"},Te=c,De=u,Ke=h,Me=c,ve=u,Le={...h,"font-size":"1.1rem",color:"var(--primary-color)"},Fe=f,ze=p,qe=c,Ce=u,Ye=h,Qe=f,Ze=p,Ae=c,et=u,Pt=h,rt=c,vt=u,at=h;return Y.e=d(z,ie,Y.e),Y.t=d(Q,Ie,Y.t),Y.a=d(C,pe,Y.a),Y.o=d(v,me,Y.o),Y.i=d(S,J,Y.i),Y.n=d(P,D,Y.n),Y.s=d(I,ge,Y.s),Y.h=d(y,ke,Y.h),Y.r=d(B,Ee,Y.r),Y.d=d(W,Te,Y.d),Y.l=d(R,De,Y.l),Y.u=d(M,Ke,Y.u),Y.c=d(F,Me,Y.c),Y.w=d(ne,ve,Y.w),Y.m=d(Z,Le,Y.m),Y.f=d(te,Fe,Y.f),Y.y=d(he,ze,Y.y),Y.g=d(se,qe,Y.g),Y.p=d(re,Ce,Y.p),Y.b=d(G,Ye,Y.b),Y.T=d(ae,Qe,Y.T),Y.A=d(Pe,Ze,Y.A),Y.O=d(we,Ae,Y.O),Y.I=d(ue,et,Y.I),Y.S=d(H,Pt,Y.S),Y.W=d(de,rt,Y.W),Y.C=d(X,vt,Y.C),Y.B=d(Se,at,Y.B),Y},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),A})()})}})};Ot(["click"]);var gi=U("<div>"),IA=U("<div><label></label><select><option value>"),EA=U("<div><div><span>:</span><span>$"),xA=U("<form><div><label></label><select><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><input type=number min=0.01 step=0.01></div><div><label></label><input type=number min=0 step=0.01></div><div><label></label><input type=text></div><div><label> (<!>)</label><input type=text></div><div><label> (<!>)</label><textarea></textarea></div><div><button type=button></button><button type=submit>"),Ah=U("<option> (<!>)");const TA=t=>{const{t:e}=pt(),[r,n]=fe("in"),[i,o]=fe(""),[a,c]=fe(""),[u,h]=fe(""),[f,p]=fe(""),[_,E]=fe(""),[A,T]=fe(""),[x,$]=fe(""),[O,q]=fe(!1),[z,ee]=fe({});Ln(()=>{const le=t.movement;le&&t.isOpen&&(n(le.movementType),o(le.quantity.toString()),c(le.unitCost.toString()),h(le.referenceNumber),p(le.notes),T(le.locationId),E(le.fromLocationId||""),$(le.invoiceId||""),ee({}))});const Q=()=>{const le={};return(!i()||parseFloat(i())<=0)&&(le.quantity=e("forms.requiredField")),(!a()||parseFloat(a())<0)&&(le.unitCost=e("forms.requiredField")),u().trim()||(le.referenceNumber=e("forms.requiredField")),A()||(le.locationId=e("forms.requiredField")),r()==="transfer"&&!_()&&(le.fromLocationId=e("forms.requiredField")),ee(le),Object.keys(le).length===0},C=async le=>{if(le.preventDefault(),!(!Q()||!t.movement)){q(!0);try{const B=t.movement,k=Be.getProductById(B.productId),W=Be.getLocationById(A()),R=_()?Be.getLocationById(_()):null;if(!k||!W)throw new Error("Product or location not found");const V={...B,movementType:r(),quantity:parseFloat(i()),unitCost:parseFloat(a()),totalCost:parseFloat(i())*parseFloat(a()),referenceNumber:u().trim(),notes:f().trim(),locationId:A(),locationName:W.name,fromLocationId:_()||void 0,fromLocationName:R?.name,invoiceId:x().trim()||void 0,lastModified:new Date().toISOString()};Be.updateMovement(B.id,V),t.onMovementUpdated?.(),t.onClose(),v()}catch(B){console.error("Error updating movement:",B),ee({submit:e("forms.saveError")})}finally{q(!1)}}},v=()=>{n("in"),o(""),c(""),h(""),p(""),E(""),T(""),$(""),ee({})},S=()=>{v(),t.onClose()},w={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",transition:"border-color 0.2s ease"},P={display:"block","margin-bottom":"0.25rem","font-weight":"500","font-size":"0.875rem"},I={color:"#d32f2f","font-size":"0.75rem","margin-top":"0.25rem"},y={"margin-bottom":"1rem"};return b(yr,{get isOpen(){return t.isOpen},onClose:S,get title(){return e("inventory.editMovement","Edit Movement")},get children(){return b(Ge,{get when(){return t.movement},get fallback(){return(()=>{var le=gi();return s(le,()=>e("common.loading")),le})()},get children(){var le=xA(),B=le.firstChild,k=B.firstChild,W=k.nextSibling,R=W.firstChild,V=R.nextSibling,M=V.nextSibling,F=M.nextSibling,ne=B.nextSibling,L=ne.firstChild,j=L.nextSibling,Z=j.firstChild,te=ne.nextSibling,he=te.firstChild,se=he.nextSibling,re=te.nextSibling,ye=re.firstChild,G=ye.nextSibling,ae=re.nextSibling,Pe=ae.firstChild,we=Pe.nextSibling,ue=ae.nextSibling,ce=ue.firstChild,H=ce.firstChild,de=H.nextSibling;de.nextSibling;var X=ce.nextSibling,_e=ue.nextSibling,Se=_e.firstChild,Y=Se.firstChild,ie=Y.nextSibling;ie.nextSibling;var Ie=Se.nextSibling,pe=_e.nextSibling,me=pe.firstChild,J=me.nextSibling;return le.addEventListener("submit",C),s(k,()=>e("inventory.movementType")),W.addEventListener("change",D=>n(D.target.value)),s(R,()=>e("inventory.stockIn")),s(V,()=>e("inventory.stockOut")),s(M,()=>e("inventory.transfer")),s(F,()=>e("inventory.adjustment")),s(L,(()=>{var D=oe(()=>r()==="transfer");return()=>D()?e("inventory.toLocation"):e("inventory.location")})()),j.addEventListener("change",D=>T(D.target.value)),s(Z,()=>e("modals.selectLocation")),s(j,b(jt,{get each(){return Be.getActiveLocations()},children:D=>(()=>{var ge=Ah(),ke=ge.firstChild,Ee=ke.nextSibling;return Ee.nextSibling,s(ge,()=>D.name,ke),s(ge,()=>D.type,Ee),K(()=>ge.value=D.id),ge})()}),null),s(ne,b(Ge,{get when(){return z().locationId},get children(){var D=gi();return s(D,()=>z().locationId),K(ge=>d(D,I,ge)),D}}),null),s(le,b(Ge,{get when(){return r()==="transfer"},get children(){var D=IA(),ge=D.firstChild,ke=ge.nextSibling,Ee=ke.firstChild;return s(ge,()=>e("inventory.fromLocation")),ke.addEventListener("change",Te=>E(Te.target.value)),s(Ee,()=>e("modals.selectLocation")),s(ke,b(jt,{get each(){return Be.getActiveLocations().filter(Te=>Te.id!==A())},children:Te=>(()=>{var De=Ah(),Ke=De.firstChild,Me=Ke.nextSibling;return Me.nextSibling,s(De,()=>Te.name,Ke),s(De,()=>Te.type,Me),K(()=>De.value=Te.id),De})()}),null),s(D,b(Ge,{get when(){return z().fromLocationId},get children(){var Te=gi();return s(Te,()=>z().fromLocationId),K(De=>d(Te,I,De)),Te}}),null),K(Te=>{var De=y,Ke=P,Me={...w,"border-color":z().fromLocationId?"#d32f2f":"var(--border-color)"},ve=O();return Te.e=d(D,De,Te.e),Te.t=d(ge,Ke,Te.t),Te.a=d(ke,Me,Te.a),ve!==Te.o&&(ke.disabled=Te.o=ve),Te},{e:void 0,t:void 0,a:void 0,o:void 0}),K(()=>ke.value=_()),D}}),te),s(he,()=>e("common.quantity")),se.$$input=D=>o(D.target.value),s(te,b(Ge,{get when(){return z().quantity},get children(){var D=gi();return s(D,()=>z().quantity),K(ge=>d(D,I,ge)),D}}),null),s(ye,()=>e("inventory.unitCost")),G.$$input=D=>c(D.target.value),s(re,b(Ge,{get when(){return z().unitCost},get children(){var D=gi();return s(D,()=>z().unitCost),K(ge=>d(D,I,ge)),D}}),null),s(le,b(Ge,{get when(){return oe(()=>!!i())()&&a()},get children(){var D=EA(),ge=D.firstChild,ke=ge.firstChild,Ee=ke.firstChild,Te=ke.nextSibling;return Te.firstChild,ge.style.setProperty("display","flex"),ge.style.setProperty("justify-content","space-between"),ke.style.setProperty("font-weight","500"),s(ke,()=>e("common.total"),Ee),Te.style.setProperty("font-weight","600"),Te.style.setProperty("color","var(--primary-color)"),s(Te,()=>(parseFloat(i()||"0")*parseFloat(a()||"0")).toFixed(2),null),K(De=>d(D,{...y,padding:"0.75rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)"},De)),D}}),ae),s(Pe,()=>e("inventory.referenceNumber")),we.$$input=D=>h(D.target.value),s(ae,b(Ge,{get when(){return z().referenceNumber},get children(){var D=gi();return s(D,()=>z().referenceNumber),K(ge=>d(D,I,ge)),D}}),null),s(ce,()=>e("inventory.invoiceNumber"),H),s(ce,()=>e("common.optional"),de),X.$$input=D=>$(D.target.value),s(Se,()=>e("common.notes"),Y),s(Se,()=>e("common.optional"),ie),Ie.$$input=D=>p(D.target.value),s(le,b(Ge,{get when(){return z().submit},get children(){var D=gi();return s(D,()=>z().submit),K(ge=>d(D,{...I,"margin-bottom":"1rem"},ge)),D}}),pe),pe.style.setProperty("display","flex"),pe.style.setProperty("gap","1rem"),pe.style.setProperty("justify-content","flex-end"),me.$$click=S,me.style.setProperty("padding","0.5rem 1rem"),me.style.setProperty("border","1px solid var(--border-color)"),me.style.setProperty("border-radius","var(--border-radius-sm)"),me.style.setProperty("background","white"),me.style.setProperty("cursor","pointer"),s(me,()=>e("common.cancel")),J.style.setProperty("padding","0.5rem 1rem"),J.style.setProperty("border","none"),J.style.setProperty("border-radius","var(--border-radius-sm)"),J.style.setProperty("background","var(--primary-color)"),J.style.setProperty("color","white"),J.style.setProperty("cursor","pointer"),J.style.setProperty("font-weight","500"),s(J,(()=>{var D=oe(()=>!!O());return()=>D()?e("modals.processing"):e("inventory.updateMovement","Update Movement")})()),K(D=>{var ge=y,ke=P,Ee=w,Te=O(),De=y,Ke=P,Me={...w,"border-color":z().locationId?"#d32f2f":"var(--border-color)"},ve=O(),Le=y,Fe=P,ze={...w,"border-color":z().quantity?"#d32f2f":"var(--border-color)"},qe=e("modals.enterQuantity"),Ce=O(),Ye=y,Qe=P,Ze={...w,"border-color":z().unitCost?"#d32f2f":"var(--border-color)"},Ae=e("modals.enterCost"),et=O(),Pt=y,rt=P,vt={...w,"border-color":z().referenceNumber?"#d32f2f":"var(--border-color)"},at=e("modals.enterReference"),Vt=O(),xt=y,bt=P,Ue=w,Ve=e("inventory.invoiceNumber"),Je=O(),st=y,_t=P,nt={...w,resize:"vertical","min-height":"80px"},$e=e("modals.addNotes"),Xe=O(),ut=O(),ht=O();return D.e=d(B,ge,D.e),D.t=d(k,ke,D.t),D.a=d(W,Ee,D.a),Te!==D.o&&(W.disabled=D.o=Te),D.i=d(ne,De,D.i),D.n=d(L,Ke,D.n),D.s=d(j,Me,D.s),ve!==D.h&&(j.disabled=D.h=ve),D.r=d(te,Le,D.r),D.d=d(he,Fe,D.d),D.l=d(se,ze,D.l),qe!==D.u&&gt(se,"placeholder",D.u=qe),Ce!==D.c&&(se.disabled=D.c=Ce),D.w=d(re,Ye,D.w),D.m=d(ye,Qe,D.m),D.f=d(G,Ze,D.f),Ae!==D.y&&gt(G,"placeholder",D.y=Ae),et!==D.g&&(G.disabled=D.g=et),D.p=d(ae,Pt,D.p),D.b=d(Pe,rt,D.b),D.T=d(we,vt,D.T),at!==D.A&&gt(we,"placeholder",D.A=at),Vt!==D.O&&(we.disabled=D.O=Vt),D.I=d(ue,xt,D.I),D.S=d(ce,bt,D.S),D.W=d(X,Ue,D.W),Ve!==D.C&&gt(X,"placeholder",D.C=Ve),Je!==D.B&&(X.disabled=D.B=Je),D.v=d(_e,st,D.v),D.k=d(Se,_t,D.k),D.x=d(Ie,nt,D.x),$e!==D.j&&gt(Ie,"placeholder",D.j=$e),Xe!==D.q&&(Ie.disabled=D.q=Xe),ut!==D.z&&(me.disabled=D.z=ut),ht!==D.P&&(J.disabled=D.P=ht),D},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0,x:void 0,j:void 0,q:void 0,z:void 0,P:void 0}),K(()=>W.value=r()),K(()=>j.value=A()),K(()=>se.value=i()),K(()=>G.value=a()),K(()=>we.value=u()),K(()=>X.value=x()),K(()=>Ie.value=f()),le}})}})};Ot(["input","click"]);var $A=U("<div><div></div><div><div><label></label><select><option value=all></option><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),kA=U("<div><h2>"),Ih=U("<div><label></label><select><option value>"),RA=U("<option> (<!>)"),DA=U("<option>"),NA=U("<div><div>📦</div><div></div><div>"),LA=U("<div><div><div><div><span></span><h3></h3><span></span></div><div> • </div></div><div><div></div><div> <!> @ </div></div></div><div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div><span>:</span><span>"),MA=U("<span>"),OA=U("<span>• <!>: "),Eh=U("<div><span>:</span><span>"),VA=U("<div><div><span>:</span><select><option value=10>10</option><option value=25>25</option><option value=50>50</option><option value=100>100</option></select><span></span></div><div><div><span>:</span><input type=number min=1><span> "),BA=U("<span>..."),FA=U("<button>");const UA=t=>{const{t:e}=pt(),[r,n]=fe(""),[i,o]=fe(""),[a,c]=fe("all"),[u,h]=fe({start:"",end:""}),[f,p]=fe(""),[_,E]=fe(""),[A,T]=fe(1),[x,$]=fe(25),[O,q]=fe(null),[z,ee]=fe(!1),[Q,C]=fe(!1),v=it(()=>{let de=Be.movements;if(t.filterBy==="product"&&t.filterId?de=de.filter(X=>X.productId===t.filterId):t.filterBy==="location"&&t.filterId&&(de=de.filter(X=>X.locationId===t.filterId)),r()&&(de=de.filter(X=>X.productId===r())),i()&&(de=de.filter(X=>X.locationId===i())),a()!=="all"&&(de=de.filter(X=>X.movementType===a())),u().start&&(de=de.filter(X=>X.createdDate>=u().start)),u().end&&(de=de.filter(X=>X.createdDate<=u().end+"T23:59:59Z")),f()){const X=f().toLowerCase();de=de.filter(_e=>_e.productName.toLowerCase().includes(X)||_e.productSku.toLowerCase().includes(X)||_e.locationName.toLowerCase().includes(X)||_e.referenceNumber.toLowerCase().includes(X)||_e.notes.toLowerCase().includes(X)||_e.createdBy.toLowerCase().includes(X)||_e.invoiceId&&_e.invoiceId.toLowerCase().includes(X)||_e.fromLocationName&&_e.fromLocationName.toLowerCase().includes(X)||_e.movementType.toLowerCase().includes(X))}return de.sort((X,_e)=>new Date(_e.createdDate).getTime()-new Date(X.createdDate).getTime())});Ln(()=>{r(),i(),a(),u(),f(),T(1)});const S=it(()=>{const de=(A()-1)*x(),X=de+x();return v().slice(de,X)}),w=it(()=>Math.ceil(v().length/x())),P=it(()=>{const de=v();return{total:de.length,stockIn:de.filter(X=>X.movementType==="in").length,stockOut:de.filter(X=>X.movementType==="out").length,transfers:de.filter(X=>X.movementType==="transfer").length,adjustments:de.filter(X=>X.movementType==="adjustment").length,totalValue:de.reduce((X,_e)=>X+_e.totalCost,0)}}),I={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},y={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},le={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)",cursor:"pointer"},B={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},k={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem","margin-bottom":"2rem"},W={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","text-align":"center"},R={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},V={"font-size":"0.875rem",color:"var(--text-muted)","font-weight":"500"},M={padding:"1.5rem","margin-bottom":"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",transition:"all 0.2s ease"},F={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"1rem"},ne=de=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:re(de).bg,color:re(de).color}),L={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"1rem"},j={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.5rem 0","border-bottom":"1px solid var(--border-color)"},Z={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},te={"font-weight":"600",color:"var(--text-primary)"},he={display:"flex","justify-content":"space-between","align-items":"center","margin-top":"2rem",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},se=de=>({padding:"0.25rem 0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:de?"var(--primary-color)":"var(--surface-color)",color:de?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"});function re(de){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[de]||{bg:"#f5f5f5",color:"#666"}}const ye=de=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(de),G=de=>new Date(de).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),ae=de=>({in:"📦",out:"📤",transfer:"🔄",adjustment:"⚖️"})[de]||"📋",Pe=()=>{n(""),o(""),c("all"),h({start:"",end:""}),p(""),T(1)},we=de=>{q(de),ee(!0)},ue=de=>{q(de),ee(!1),C(!0)},ce=()=>{C(!1),q(null)},H=async de=>{i()&&(de+=" "+i()),Ol(a())&&(de+=" "+Ol(a()));const X=await Tn.getInventory(de),_e=Be.parseInventoryData(X);Be.updMovements(_e)};return(()=>{var de=$A(),X=de.firstChild,_e=X.nextSibling,Se=_e.firstChild,Y=Se.firstChild,ie=Y.nextSibling,Ie=ie.firstChild,pe=Ie.nextSibling,me=pe.nextSibling,J=me.nextSibling,D=J.nextSibling,ge=Se.nextSibling,ke=ge.firstChild,Ee=ke.nextSibling,Te=ge.nextSibling,De=Te.firstChild,Ke=De.nextSibling,Me=_e.nextSibling,ve=Me.firstChild,Le=ve.firstChild,Fe=Le.nextSibling,ze=ve.nextSibling,qe=ze.firstChild,Ce=qe.nextSibling,Ye=ze.nextSibling,Qe=Ye.firstChild,Ze=Qe.nextSibling,Ae=Ye.nextSibling,et=Ae.firstChild,Pt=et.nextSibling,rt=Ae.nextSibling,vt=rt.firstChild,at=vt.nextSibling,Vt=rt.nextSibling,xt=Vt.firstChild,bt=xt.nextSibling;return s(de,(()=>{var Ue=oe(()=>!t.filterBy);return()=>Ue()&&(()=>{var Ve=kA(),Je=Ve.firstChild;return d(Ve,I),Je.style.setProperty("margin","0"),Je.style.setProperty("font-size","1.5rem"),s(Je,()=>e("inventory.movements")),s(Ve,b(Oe,{variant:"outline",onClick:Pe,get children(){return e("common.clearFilters")}}),null),Ve})()})(),X),s(de,b(SA,{filters:{selectedLocation:i,movementType:a},onSearchResults:Ue=>{E(Ue),H(Ue)},get placeholder(){return e("inventory.searchProductsStock","Search inventories...")},showResults:!1,maxResults:20}),X),X.style.setProperty("margin","20px"),d(_e,y),s(_e,(()=>{var Ue=oe(()=>!t.filterBy);return()=>Ue()&&[(()=>{var Ve=Ih(),Je=Ve.firstChild,st=Je.nextSibling,_t=st.firstChild;return Je.style.setProperty("display","block"),Je.style.setProperty("margin-bottom","0.5rem"),Je.style.setProperty("font-weight","500"),s(Je,()=>e("inventory.product")),st.addEventListener("change",nt=>n(nt.target.value)),s(_t,()=>e("inventory.allProducts")),s(st,b(jt,{get each(){return Be.products},children:nt=>(()=>{var $e=RA(),Xe=$e.firstChild,ut=Xe.nextSibling;return ut.nextSibling,s($e,()=>nt.name,Xe),s($e,()=>nt.sku,ut),K(()=>$e.value=nt.id),$e})()}),null),K(nt=>d(st,le,nt)),K(()=>st.value=r()),Ve})(),(()=>{var Ve=Ih(),Je=Ve.firstChild,st=Je.nextSibling,_t=st.firstChild;return Je.style.setProperty("display","block"),Je.style.setProperty("margin-bottom","0.5rem"),Je.style.setProperty("font-weight","500"),s(Je,()=>e("inventory.location")),st.addEventListener("change",nt=>o(nt.target.value)),s(_t,()=>e("inventory.allLocations")),s(st,b(jt,{get each(){return Be.locations},children:nt=>(()=>{var $e=DA();return s($e,()=>nt.name),K(()=>$e.value=nt.id),$e})()}),null),K(nt=>d(st,le,nt)),K(()=>st.value=i()),Ve})()]})(),Se),Y.style.setProperty("display","block"),Y.style.setProperty("margin-bottom","0.5rem"),Y.style.setProperty("font-weight","500"),s(Y,()=>e("inventory.movementType")),ie.addEventListener("change",Ue=>{c(Ue.target.value),H(_())}),s(Ie,()=>e("inventory.allTypes")),s(pe,()=>e("inventory.stockIn")),s(me,()=>e("inventory.stockOut")),s(J,()=>e("inventory.transfer")),s(D,()=>e("inventory.adjustment")),ke.style.setProperty("display","block"),ke.style.setProperty("margin-bottom","0.5rem"),ke.style.setProperty("font-weight","500"),s(ke,()=>e("common.startDate")),Ee.addEventListener("change",Ue=>h(Ve=>({...Ve,start:Ue.target.value}))),De.style.setProperty("display","block"),De.style.setProperty("margin-bottom","0.5rem"),De.style.setProperty("font-weight","500"),s(De,()=>e("common.endDate")),Ke.addEventListener("change",Ue=>h(Ve=>({...Ve,end:Ue.target.value}))),d(Me,k),s(Le,()=>P().total),s(Fe,()=>e("inventory.totalMovements")),s(qe,()=>P().stockIn),s(Ce,()=>e("inventory.stockIn")),s(Qe,()=>P().stockOut),s(Ze,()=>e("inventory.stockOut")),s(et,()=>P().transfers),s(Pt,()=>e("inventory.transfers")),s(vt,()=>P().adjustments),s(at,()=>e("inventory.adjustments")),s(xt,()=>ye(P().totalValue)),s(bt,()=>e("inventory.totalValue")),s(de,(()=>{var Ue=oe(()=>S().length===0);return()=>Ue()?(()=>{var Ve=NA(),Je=Ve.firstChild,st=Je.nextSibling,_t=st.nextSibling;return Ve.style.setProperty("text-align","center"),Ve.style.setProperty("padding","3rem"),Ve.style.setProperty("color","var(--text-muted)"),Ve.style.setProperty("background","var(--surface-color)"),Ve.style.setProperty("border-radius","var(--border-radius)"),Ve.style.setProperty("border","1px solid var(--border-color)"),Je.style.setProperty("font-size","1.5rem"),Je.style.setProperty("margin-bottom","1rem"),st.style.setProperty("font-size","1.1rem"),st.style.setProperty("margin-bottom","0.5rem"),s(st,()=>e("inventory.noMovementsFound")),_t.style.setProperty("font-size","0.875rem"),s(_t,()=>e("inventory.tryAdjustingFilters")),Ve})():[b(jt,{get each(){return S()},children:Ve=>(()=>{var Je=LA(),st=Je.firstChild,_t=st.firstChild,nt=_t.firstChild,$e=nt.firstChild,Xe=$e.nextSibling,ut=Xe.nextSibling,ht=nt.nextSibling,Yt=ht.firstChild,zt=_t.nextSibling,Dt=zt.firstChild,Gt=Dt.nextSibling,wt=Gt.firstChild,Tt=wt.nextSibling;Tt.nextSibling;var Zt=st.nextSibling,$t=Zt.firstChild,Bt=$t.firstChild,dr=Bt.firstChild,hr=dr.firstChild,Qt=dr.nextSibling,Pr=Bt.nextSibling,Xr=Pr.firstChild,On=Xr.firstChild,gn=Xr.nextSibling,pn=$t.nextSibling,Zr=pn.firstChild,Vr=Zr.firstChild,Vn=Vr.firstChild,vn=Vr.nextSibling;return Je.addEventListener("mouseleave",yt=>{yt.currentTarget.style.transform="translateY(0)",yt.currentTarget.style.boxShadow="none"}),Je.addEventListener("mouseenter",yt=>{yt.currentTarget.style.transform="translateY(-2px)",yt.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),Je.$$click=()=>we(Ve),d(st,F),nt.style.setProperty("display","flex"),nt.style.setProperty("align-items","center"),nt.style.setProperty("gap","0.5rem"),nt.style.setProperty("margin-bottom","0.5rem"),$e.style.setProperty("font-size","1.2rem"),s($e,()=>ae(Ve.movementType)),Xe.style.setProperty("margin","0"),Xe.style.setProperty("font-size","1.1rem"),s(Xe,()=>Ve.productName),s(ut,()=>Ve.movementType),s(nt,(()=>{var yt=oe(()=>!!Ve.invoiceId);return()=>yt()&&(()=>{var Nt=MA();return Nt.style.setProperty("padding","0.2rem 0.5rem"),Nt.style.setProperty("border-radius","var(--border-radius-sm)"),Nt.style.setProperty("font-size","0.7rem"),Nt.style.setProperty("font-weight","500"),Nt.style.setProperty("background","var(--primary-color)"),Nt.style.setProperty("color","white"),s(Nt,()=>e("inventory.bulk")),Nt})()})(),null),ht.style.setProperty("font-size","0.875rem"),ht.style.setProperty("color","var(--text-muted)"),s(ht,()=>Ve.productSku,Yt),s(ht,()=>G(Ve.createdDate),null),s(ht,(()=>{var yt=oe(()=>!!Ve.invoiceId);return()=>yt()&&(()=>{var Nt=OA(),rr=Nt.firstChild,kr=rr.nextSibling;return kr.nextSibling,Nt.style.setProperty("margin-left","0.5rem"),Nt.style.setProperty("font-weight","500"),s(Nt,()=>e("common.invoice"),kr),s(Nt,()=>Ve.invoiceId,null),Nt})()})(),null),zt.style.setProperty("text-align","right"),Dt.style.setProperty("font-size","1.25rem"),Dt.style.setProperty("font-weight","700"),Dt.style.setProperty("color","var(--primary-color)"),s(Dt,()=>ye(Ve.totalCost)),Gt.style.setProperty("font-size","0.875rem"),Gt.style.setProperty("color","var(--text-muted)"),s(Gt,()=>Ve.quantity,wt),s(Gt,()=>e("common.units"),Tt),s(Gt,()=>ye(Ve.unitCost),null),d(Zt,L),s(dr,()=>e("inventory.location"),hr),s(Qt,()=>Ve.locationName),s($t,(()=>{var yt=oe(()=>!!Ve.fromLocationName);return()=>yt()&&(()=>{var Nt=Eh(),rr=Nt.firstChild,kr=rr.firstChild,Nr=rr.nextSibling;return s(rr,()=>e("common.from"),kr),s(Nr,()=>Ve.fromLocationName),K(Ut=>{var gr=j,en=Z,tn=te;return Ut.e=d(Nt,gr,Ut.e),Ut.t=d(rr,en,Ut.t),Ut.a=d(Nr,tn,Ut.a),Ut},{e:void 0,t:void 0,a:void 0}),Nt})()})(),Pr),s(Xr,()=>e("common.reference"),On),s(gn,()=>Ve.referenceNumber),s(Vr,()=>e("common.createdBy"),Vn),s(vn,()=>Ve.createdBy),s(pn,(()=>{var yt=oe(()=>!!Ve.notes);return()=>yt()&&(()=>{var Nt=Eh(),rr=Nt.firstChild,kr=rr.firstChild,Nr=rr.nextSibling;return s(rr,()=>e("common.notes"),kr),s(Nr,()=>Ve.notes),K(Ut=>{var gr={...j,"border-bottom":"none"},en=Z,tn={...te,"max-width":"200px","text-align":"right","font-style":"italic"};return Ut.e=d(Nt,gr,Ut.e),Ut.t=d(rr,en,Ut.t),Ut.a=d(Nr,tn,Ut.a),Ut},{e:void 0,t:void 0,a:void 0}),Nt})()})(),null),K(yt=>{var Nt={...M,"border-left":Ve.invoiceId?"4px solid var(--primary-color)":"1px solid var(--border-color)",cursor:"pointer"},rr=ne(Ve.movementType),kr=j,Nr=Z,Ut=te,gr=j,en=Z,tn=te,ps=j,qt=Z,Li=te;return yt.e=d(Je,Nt,yt.e),yt.t=d(ut,rr,yt.t),yt.a=d(Bt,kr,yt.a),yt.o=d(dr,Nr,yt.o),yt.i=d(Qt,Ut,yt.i),yt.n=d(Pr,gr,yt.n),yt.s=d(Xr,en,yt.s),yt.h=d(gn,tn,yt.h),yt.r=d(Zr,ps,yt.r),yt.d=d(Vr,qt,yt.d),yt.l=d(vn,Li,yt.l),yt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),Je})()}),oe(()=>oe(()=>w()>1)()&&(()=>{var Ve=VA(),Je=Ve.firstChild,st=Je.firstChild,_t=st.firstChild,nt=st.nextSibling,$e=nt.nextSibling,Xe=Je.nextSibling,ut=Xe.firstChild,ht=ut.firstChild,Yt=ht.firstChild,zt=ht.nextSibling,Dt=zt.nextSibling,Gt=Dt.firstChild;return d(Ve,he),Je.style.setProperty("display","flex"),Je.style.setProperty("align-items","center"),Je.style.setProperty("gap","0.5rem"),st.style.setProperty("font-size","0.875rem"),st.style.setProperty("color","var(--text-muted)"),s(st,()=>e("common.showPerPage","Show per page"),_t),nt.addEventListener("change",wt=>{$(Number(wt.target.value)),T(1)}),nt.style.setProperty("padding","0.25rem 0.5rem"),nt.style.setProperty("border","1px solid var(--border-color)"),nt.style.setProperty("border-radius","var(--border-radius-sm)"),nt.style.setProperty("background","var(--surface-color)"),nt.style.setProperty("cursor","pointer"),nt.style.setProperty("font-size","0.875rem"),$e.style.setProperty("font-size","0.875rem"),$e.style.setProperty("color","var(--text-muted)"),$e.style.setProperty("margin-left","1rem"),s($e,()=>e("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:(A()-1)*x()+1,end:Math.min(A()*x(),v().length),total:v().length})),Xe.style.setProperty("display","flex"),Xe.style.setProperty("align-items","center"),Xe.style.setProperty("gap","0.5rem"),s(Xe,b(Oe,{variant:"outline",size:"sm",onClick:()=>T(1),get disabled(){return A()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.first","First")}}),ut),s(Xe,b(Oe,{variant:"outline",size:"sm",onClick:()=>T(wt=>Math.max(1,wt-1)),get disabled(){return A()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.previous")}}),ut),s(Xe,()=>{const wt=[],Tt=w(),Zt=A();if(Tt<=7)for(let $t=1;$t<=Tt;$t++)wt.push($t);else{wt.push(1),Zt>3&&wt.push("...");for(let $t=Math.max(2,Zt-1);$t<=Math.min(Tt-1,Zt+1);$t++)wt.includes($t)||wt.push($t);Zt<Tt-2&&wt.push("..."),wt.includes(Tt)||wt.push(Tt)}return b(jt,{each:wt,children:$t=>$t==="..."?(()=>{var Bt=BA();return Bt.style.setProperty("padding","0 0.5rem"),Bt.style.setProperty("color","var(--text-muted)"),Bt})():(()=>{var Bt=FA();return Bt.$$click=()=>T($t),s(Bt,$t),K(dr=>d(Bt,se($t===A()),dr)),Bt})()})},ut),s(Xe,b(Oe,{variant:"outline",size:"sm",onClick:()=>T(wt=>Math.min(w(),wt+1)),get disabled(){return A()===w()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.next")}}),ut),s(Xe,b(Oe,{variant:"outline",size:"sm",onClick:()=>T(w()),get disabled(){return A()===w()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.last","Last")}}),ut),ut.style.setProperty("display","flex"),ut.style.setProperty("align-items","center"),ut.style.setProperty("gap","0.5rem"),ut.style.setProperty("margin-left","1rem"),ht.style.setProperty("font-size","0.875rem"),ht.style.setProperty("color","var(--text-muted)"),s(ht,()=>e("common.page","Page"),Yt),zt.addEventListener("change",wt=>{const Tt=Number(wt.target.value);Tt>=1&&Tt<=w()&&T(Tt)}),zt.style.setProperty("width","4rem"),zt.style.setProperty("padding","0.25rem 0.5rem"),zt.style.setProperty("border","1px solid var(--border-color)"),zt.style.setProperty("border-radius","var(--border-radius-sm)"),zt.style.setProperty("background","var(--surface-color)"),zt.style.setProperty("text-align","center"),zt.style.setProperty("font-size","0.875rem"),Dt.style.setProperty("font-size","0.875rem"),Dt.style.setProperty("color","var(--text-muted)"),s(Dt,()=>e("common.of","of"),Gt),s(Dt,w,null),K(()=>gt(zt,"max",w())),K(()=>nt.value=x()),K(()=>zt.value=A()),Ve})())]})(),null),s(de,b(AA,{get isOpen(){return z()},onClose:()=>{ee(!1),q(null)},get movement(){return O()},onEdit:ue}),null),s(de,b(TA,{get isOpen(){return Q()},onClose:()=>{C(!1),q(null)},get movement(){return O()},onMovementUpdated:ce}),null),K(Ue=>{var Ve=le,Je=B,st=B,_t=W,nt=R,$e=V,Xe=W,ut={...R,color:"#2d7d32"},ht=V,Yt=W,zt={...R,color:"#d32f2f"},Dt=V,Gt=W,wt={...R,color:"#1976d2"},Tt=V,Zt=W,$t={...R,color:"#f57c00"},Bt=V,dr=W,hr=R,Qt=V;return Ue.e=d(ie,Ve,Ue.e),Ue.t=d(Ee,Je,Ue.t),Ue.a=d(Ke,st,Ue.a),Ue.o=d(ve,_t,Ue.o),Ue.i=d(Le,nt,Ue.i),Ue.n=d(Fe,$e,Ue.n),Ue.s=d(ze,Xe,Ue.s),Ue.h=d(qe,ut,Ue.h),Ue.r=d(Ce,ht,Ue.r),Ue.d=d(Ye,Yt,Ue.d),Ue.l=d(Qe,zt,Ue.l),Ue.u=d(Ze,Dt,Ue.u),Ue.c=d(Ae,Gt,Ue.c),Ue.w=d(et,wt,Ue.w),Ue.m=d(Pt,Tt,Ue.m),Ue.f=d(rt,Zt,Ue.f),Ue.y=d(vt,$t,Ue.y),Ue.g=d(at,Bt,Ue.g),Ue.p=d(Vt,dr,Ue.p),Ue.b=d(xt,hr,Ue.b),Ue.T=d(bt,Qt,Ue.T),Ue},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),K(()=>ie.value=a()),K(()=>Ee.value=u().start),K(()=>Ke.value=u().end),de})()};Ot(["click"]);var jA=U("<div>🔄"),zA=U("<button type=button>×"),qA=U("<div>⚠️ "),xh=U("<div>"),HA=U("<div><div><input type=text autocomplete=off>"),WA=U("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>"),GA=U("<span>⚠️ ");const KA=t=>{const{t:e}=pt(),[r,n]=fe(""),[i,o]=fe(!1),[a,c]=fe(null),[u,h]=fe([]),[f,p]=fe(!1),[_,E]=fe(-1),[A,T]=fe(null),x=t.searchDelay||300,$=t.maxResults||900,O=async Z=>{if(!Z.trim()||Z.trim().length<3){h([]),t.onSearchResults?.([]);return}try{o(!0),c(null);try{const te=await Tn.getProducts(Z),he=Object.keys(te),se=ye=>{let G=te;return{id:ye,name:G[ye].name,businessId:G[ye].businessId,sku:G[ye].code,UPC:G[ye].UPC,numCode:G[ye].codeN,category:G[ye].category,unitCost:G[ye].unitCost||0,unitOfMeasure:G[ye].unitOfMeasure,minStockLevel:G[ye].minStockLevel,maxStockLevel:G[ye].maxStockLevel,isActive:G[ye].isActive,description:G[ye].description||"",createdDate:G[ye].createdAt||new Date().toISOString(),lastModified:G[ye].updatedAt||new Date().toISOString()}},re=he.map(se);h(re),Be.updProduct(re),t.onSearchResults?.(re)}catch(te){console.warn("API search failed, using local fallback:",te),c("API search failed, showing local results");const he=Be.getActiveProducts().filter(se=>se.name.toLowerCase().includes(Z.toLowerCase())||se.sku.toLowerCase().includes(Z.toLowerCase())||se.category.toLowerCase().includes(Z.toLowerCase())).slice(0,$);h(he),t.onSearchResults?.(he)}}catch(te){const he=te instanceof Error?te.message:"Search failed";c(he),h([]),t.onSearchResults?.([])}finally{o(!1)}},q=Z=>{const he=Z.target.value;n(he),c(null),t.showResults!==!1&&p(!0),A()&&clearTimeout(A());const se=setTimeout(()=>{O(he)},x);T(se)},z=Z=>{n(Z.name),p(!1),E(-1),t.onProductSelect?.(Z)},ee=Z=>{if(!(!f()||u().length===0))switch(Z.key){case"ArrowDown":Z.preventDefault(),E(te=>Math.min(te+1,u().length-1));break;case"ArrowUp":Z.preventDefault(),E(te=>Math.max(te-1,-1));break;case"Enter":Z.preventDefault(),_()>=0&&u()[_()]&&z(u()[_()]);break;case"Escape":p(!1),E(-1);break}},Q=()=>{t.showResults!==!1&&u().length>0&&p(!0)},C=()=>{setTimeout(()=>{p(!1),E(-1)},150)},v=()=>{n(""),h([]),c(null),p(!1),E(-1),t.onSearchResults?.([]),A()&&(clearTimeout(A()),T(null))},S=Z=>Be.stockLevels.filter(te=>te.productId===Z).reduce((te,he)=>te+he.quantity,0),w=Z=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Z),P={position:"relative",width:"100%",...t.style},I={position:"relative",display:"flex","align-items":"center"},y={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},le={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},B={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},k={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},W=Z=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:Z?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),R={display:"flex","justify-content":"space-between","align-items":"center"},V={flex:"1"},M={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},F={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},ne={"text-align":"right","font-size":"0.875rem"},L={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},j={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var Z=HA(),te=Z.firstChild,he=te.firstChild;return he.addEventListener("blur",C),he.addEventListener("focus",Q),he.$$keydown=ee,he.$$input=q,s(te,b(Ge,{get when(){return i()},get children(){var se=jA();return K(re=>d(se,B,re)),se}}),null),s(te,b(Ge,{get when(){return oe(()=>!!r())()&&!i()},get children(){var se=zA();return se.addEventListener("mouseleave",re=>{re.currentTarget.style.background="none",re.currentTarget.style.color="var(--text-muted)"}),se.addEventListener("mouseenter",re=>{re.currentTarget.style.background="var(--border-color)",re.currentTarget.style.color="var(--text-primary)"}),se.$$click=v,K(re=>{var ye=le,G=e("common.clear","Clear search");return re.e=d(se,ye,re.e),G!==re.t&&gt(se,"title",re.t=G),re},{e:void 0,t:void 0}),se}}),null),s(Z,b(Ge,{get when(){return f()&&t.showResults!==!1},get children(){var se=xh();return s(se,b(Ge,{get when(){return a()},get children(){var re=qA();return re.firstChild,d(re,j),s(re,a,null),re}}),null),s(se,b(Ge,{get when(){return u().length>0},get fallback(){return oe(()=>!!(r()&&!i()))()&&(()=>{var re=xh();return d(re,L),s(re,()=>e("inventory.noProductsFound","No products found matching your search.")),re})()},get children(){return b(jt,{get each(){return u()},children:(re,ye)=>{const G=S(re.id),ae=G<=re.minStockLevel;return(()=>{var Pe=WA(),we=Pe.firstChild,ue=we.firstChild,ce=ue.firstChild,H=ce.nextSibling,de=H.firstChild,X=de.firstChild,_e=de.nextSibling,Se=_e.nextSibling,Y=Se.nextSibling,ie=Y.nextSibling,Ie=ue.nextSibling,pe=Ie.firstChild,me=pe.firstChild,J=pe.nextSibling;return Pe.addEventListener("mouseenter",()=>E(ye())),Pe.$$click=()=>z(re),d(we,R),d(ue,V),d(ce,M),s(ce,()=>re.name),d(H,F),s(de,()=>e("inventory.sku","SKU"),X),s(de,()=>re.sku,null),s(Se,()=>re.category),s(ie,()=>w(re.unitCost)),d(Ie,ne),pe.style.setProperty("font-weight","600"),(ae?"#f44336":"var(--text-primary)")!=null?pe.style.setProperty("color",ae?"#f44336":"var(--text-primary)"):pe.style.removeProperty("color"),s(pe,G,me),s(pe,()=>re.unitOfMeasure,null),J.style.setProperty("color","var(--text-muted)"),s(J,()=>ae?(()=>{var D=GA();return D.firstChild,D.style.setProperty("color","#f44336"),s(D,()=>e("inventory.lowStock","Low Stock"),null),D})():e("inventory.inStock","In Stock")),K(D=>d(Pe,W(ye()===_()),D)),Pe})()}})}}),null),K(re=>d(se,k,re)),se}}),null),K(se=>{var re=P,ye=I,G=y,ae=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),Pe=t.disabled;return se.e=d(Z,re,se.e),se.t=d(te,ye,se.t),se.a=d(he,G,se.a),ae!==se.o&&gt(he,"placeholder",se.o=ae),Pe!==se.i&&(he.disabled=se.i=Pe),se},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),K(()=>he.value=r()),Z})()};Ot(["input","keydown","click"]);var YA=U("<div><p>📋 "),QA=U("<div>"),JA=U("<div><div>📊</div><h3></h3><p></p><div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=name></option><option value=sku></option><option value=category>"),XA=U("<div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div>%</div><div></div></div></div><div></div><div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),ZA=U("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),eI=U("<div><div>✅</div><h3></h3><p>"),tI=U("<div><div><h3>📋 </h3><p></p></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div></div><div>"),rI=U("<div><div><div><h2>📋 </h2><button>×"),Th=U("<option>"),nI=U("<div>..."),iI=U("<tr><td><div></div><div> • </div></td><td><div></div></td><td><div></div></td><td><div></div></td><td><div>"),oI=U("<tr><td><div></div></td><td><div></div><div> • <!> • </div></td><td><div></div></td><td><input type=number placeholder=0 min=0 step=0.01></td><td><div></div></td><td><input type=text>");const sI=t=>{const{t:e}=pt(),[r,n]=fe([]),[i,o]=fe(!1),[a,c]=fe(!1),[u,h]=fe("all"),[f,p]=fe("all"),[_,E]=fe("name"),[A,T]=fe([]),[x,$]=fe("setup");yn(async()=>{await O(),t.selectedLocationId&&h(t.selectedLocationId)});const O=async()=>{try{o(!0);const R=await Tn.getProducts("prod");if(!R||typeof R!="object"){console.warn("No API results, using local store"),n(Be.products);return}const V=Object.keys(R),M=ne=>{let j=R[ne];return{id:ne,name:j.name||"Unknown Product",businessId:j.businessId||"",sku:j.code||j.sku||"",UPC:j.UPC||"",numCode:j.codeN||"",category:j.category||"General",unitCost:j.unitCost||0,unitOfMeasure:j.unitOfMeasure||"pcs",minStockLevel:j.minStockLevel||0,maxStockLevel:j.maxStockLevel||100,isActive:j.isActive!==!1,description:j.description||"",createdDate:j.createdAt||new Date().toISOString(),lastModified:j.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(j.sellingPrice||j.price||"0")}},F=V.map(M);n(F)}catch(R){console.error("Failed to load products from API:",R),n(Be.products)}finally{o(!1)}},q=it(()=>[...new Set(r().map(V=>V.category).filter(V=>V))].sort()),z=it(()=>{let R=r().filter(V=>V.isActive);return f()!=="all"&&(R=R.filter(V=>V.category===f())),R.sort((V,M)=>{switch(_()){case"name":return V.name.localeCompare(M.name);case"sku":return V.sku.localeCompare(M.sku);case"category":return V.category.localeCompare(M.category)||V.name.localeCompare(M.name);default:return 0}}),R}),ee=it(()=>Be.getActiveLocations()),Q=(R,V)=>V&&V!=="all"?Be.getStockByProductAndLocation(R,V)?.quantity||0:Be.getTotalStockByProduct(R),C=()=>{const R=z().map(V=>{const M=Q(V.id,u()!=="all"?u():void 0);return{productId:V.id,systemQuantity:M,physicalCount:null,notes:"",variance:0,product:V}});T(R),$("counting")},v=(R,V)=>{T(M=>M.map(F=>{if(F.productId===R){const ne=V,L=ne!==null?ne-F.systemQuantity:0;return{...F,physicalCount:ne,variance:L}}return F}))},S=(R,V)=>{T(M=>M.map(F=>F.productId===R?{...F,notes:V}:F))},w=it(()=>{const R=A(),V=R.length,M=R.filter(j=>j.physicalCount!==null).length,F=R.filter(j=>j.variance!==0).length,ne=R.filter(j=>j.variance>0).length,L=R.filter(j=>j.variance<0).length;return{totalProducts:V,countedProducts:M,remainingProducts:V-M,variances:F,positiveVariances:ne,negativeVariances:L,isComplete:M===V}}),P=()=>{const R=A().filter(ne=>ne.physicalCount!==null&&ne.variance!==0);if(R.length===0)return null;const V=[e("inventory.product","Product"),e("inventory.sku","SKU"),e("inventory.category","Category"),e("inventory.location","Location"),e("inventory.systemQty","System Qty"),e("inventory.physicalCount","Physical Count"),e("inventory.variance","Variance"),e("inventory.adjustment","Adjustment"),e("common.notes","Notes"),e("common.date","Date")],M=R.map(ne=>[`"${ne.product.name}"`,`"${ne.product.sku}"`,`"${ne.product.category}"`,`"${le()}"`,ne.systemQuantity,ne.physicalCount,ne.variance,ne.variance>0?e("inventory.stockIncrease","Stock Increase"):e("inventory.stockDecrease","Stock Decrease"),`"${ne.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")}"`,`"${B()}"`]);return[V.join(","),...M.map(ne=>ne.join(","))].join(`
`)},I=()=>{const R=P();if(!R){alert(e("inventory.noAdjustmentsToDownload","No adjustments to download"));return}const V=new Blob([R],{type:"text/csv;charset=utf-8;"}),M=document.createElement("a");if(M.download!==void 0){const F=URL.createObjectURL(V);M.setAttribute("href",F),M.setAttribute("download",`inventory-adjustments-${B().replace(/[/:,\s]/g,"-")}.csv`),M.style.visibility="hidden",document.body.appendChild(M),M.click(),document.body.removeChild(M)}},y=async(R=!0)=>{try{c(!0),console.log(A());const V=Z=>{let te=Be.getProductById(Z.productId),he=Be.getStockByProductAndLocation(Z.productId,u()),se=parseFloat(he?.averageCost+""),re=parseFloat(he?.quantity+"");return{product:{id:Z.productId,label:te?.name,code:te?.code},productId:Z?.productId,reason:"Physical Count Adjustment",notes:Z?.notes||"Physical inventory adjustment",quantity:Z?.variance,unitCost:se}},M=A().filter(Z=>Z.physicalCount!==null&&Z.variance!==0).map(V);let F="ADJ_"+qs();const ne=new Date().toISOString(),L={ssg_inventory_key:qs(),invoiceId:F,referenceNumber:qs(),movementType:"adjustment",type:"adjustment",locationId:u(),items:M,products:M,generalNotes:"Physical inventory adjustment",description:"Physical Count Adjustment",invoice:F,store:u(),createdBy:"admin",createDate:ne};console.log("Saving inventory bulkRequest:",L);const j=await Tn.addInventory(L);R&&M.length>0&&I(),console.log("Saving inventory adjustments:",M),await new Promise(Z=>setTimeout(Z,1e3)),t.onClose()}catch(V){console.error("Failed to save inventory adjustments:",V)}finally{c(!1)}},le=it(()=>u()==="all"?"All Locations":ee().find(V=>V.id===u())?.name||"Unknown Location"),B=()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),k=()=>{const R=window.open("","_blank");if(!R){alert("Please allow pop-ups to print the counting sheet");return}const V=W();R.document.write(V),R.document.close(),R.onload=()=>{R.print(),R.onafterprint=()=>{R.close()}}},W=()=>{const R=z().map((V,M)=>{const F=Q(V.id,u()!=="all"?u():void 0);return`
        <tr>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${M+1}</td>
          <td style="border: 1px solid #000; padding: 8px; font-family: monospace;">${V.sku}</td>
          <td style="border: 1px solid #000; padding: 8px;">
            <div style="font-weight: 500;">${V.name}</div>
            ${V.UPC?`<div style="font-size: 0.8em; color: #666;">UPC: ${V.UPC}</div>`:""}
          </td>
          <td style="border: 1px solid #000; padding: 8px;">${V.category}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${V.unitOfMeasure}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">${F}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; background-color: #f9f9f9;">________</td>
          <td style="border: 1px solid #000; padding: 8px;">_______________</td>
        </tr>
      `}).join("");return`
      <!DOCTYPE html>
      <html>
      <head>
        <title> ${le()}_${f()}_${e("inventory.countingSheet","Inventory Counting Sheet")} - ${B()}</title>
        <style>
          @page {
            size: letter;
            margin: 0.5in;
          }
          body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            margin: 0;
            padding: 0;
          }
          h1 {
            text-align: center;
            margin: 0 0 10px 0;
            font-size: 24px;
          }
          .header-info {
            text-align: center;
            margin-bottom: 20px;
          }
          .instructions {
            background-color: #f0f0f0;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
          }
          th {
            background-color: #333;
            color: white;
            padding: 8px;
            text-align: left;
            font-weight: bold;
            border: 1px solid #000;
          }
          .summary-table {
            width: 50%;
            margin: 20px auto;
          }
          .signature-section {
            margin-top: 40px;
            display: flex;
            justify-content: space-between;
          }
          .signature-box {
            width: 45%;
            text-align: center;
          }
          .signature-line {
            border-bottom: 1px solid #000;
            margin-bottom: 5px;
            height: 30px;
          }
          @media print {
            tr { page-break-inside: avoid; }
          }
        </style>
      </head>
      <body>
        <h1>${e("inventory.inventoryCountingSheetTitle","INVENTORY COUNTING SHEET")}</h1>
        <div class="header-info">
          <p><strong>${e("inventory.location","Location")}:</strong> ${le()}</p>
          <p><strong>${e("common.category","Category")}:</strong> ${f()==="all"?e("inventory.allCategories","All Categories"):f()}</p>
          <p><strong>${e("common.date","Date")}:</strong> ${B()}</p>
          <p style="margin-top: 10px;">
            <span style="margin-right: 30px;">${e("inventory.countedBy","Counted by")}: _________________________</span>
            <span>${e("inventory.verifiedBy","Verified by")}: _________________________</span>
          </p>
        </div>

        <table>
          <thead>
            <tr>
              <th style="width: 5%; text-align: center;">#</th>
              <th style="width: 12%;">${e("inventory.sku","SKU")}</th>
              <th style="width: 25%;">${e("inventory.productName","Product Name")}</th>
              <th style="width: 12%;">${e("common.category","Category")}</th>
              <th style="width: 8%; text-align: center;">${e("inventory.unit","Unit")}</th>
              <th style="width: 10%; text-align: center;">${e("inventory.systemQty","System Qty")}</th>
              <th style="width: 12%; text-align: center; background-color: #f0f0f0;">${e("inventory.physicalCount","Physical Count")}</th>
              <th style="width: 16%;">${e("common.notes","Notes")}</th>
            </tr>
          </thead>
          <tbody>
            ${R}
          </tbody>
        </table>
        
        <table class="summary-table">
          <tr>
            <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
              ${e("inventory.totalProductsListed","Total Products Listed")}:
            </td>
            <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">
              ${z().length}
            </td>
          </tr>
          <tr>
            <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
              ${e("inventory.itemsCounted","Items Counted")}:
            </td>
            <td style="border: 1px solid #000; padding: 8px; text-align: center;">
              ___________
            </td>
          </tr>
          <tr>
            <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
              ${e("inventory.discrepanciesFound","Discrepancies Found")}:
            </td>
            <td style="border: 1px solid #000; padding: 8px; text-align: center;">
              ___________
            </td>
          </tr>
        </table>
        
        <div class="signature-section">
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.counterSignature","Counter Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.supervisorSignature","Supervisor Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
        </div>
      </body>
      </html>
    `};return b(Ge,{get when(){return t.isOpen},get children(){var R=rI(),V=R.firstChild,M=V.firstChild,F=M.firstChild;F.firstChild;var ne=F.nextSibling;return R.style.setProperty("position","fixed"),R.style.setProperty("top","0"),R.style.setProperty("left","0"),R.style.setProperty("right","0"),R.style.setProperty("bottom","0"),R.style.setProperty("background","rgba(0, 0, 0, 0.5)"),R.style.setProperty("z-index","1000"),R.style.setProperty("display","flex"),R.style.setProperty("align-items","center"),R.style.setProperty("justify-content","center"),V.style.setProperty("background","white"),V.style.setProperty("border-radius","var(--border-radius)"),V.style.setProperty("padding","2rem"),V.style.setProperty("width","95%"),V.style.setProperty("height","95%"),V.style.setProperty("max-width","1400px"),V.style.setProperty("overflow-y","auto"),V.style.setProperty("position","relative"),M.style.setProperty("display","flex"),M.style.setProperty("justify-content","space-between"),M.style.setProperty("align-items","center"),M.style.setProperty("margin-bottom","2rem"),M.style.setProperty("border-bottom","1px solid var(--border-color)"),M.style.setProperty("padding-bottom","1rem"),F.style.setProperty("margin","0"),F.style.setProperty("font-size","1.5rem"),s(F,()=>e("inventory.physicalInventoryCount","Physical Inventory Count"),null),Ti(ne,"click",t.onClose,!0),ne.style.setProperty("background","none"),ne.style.setProperty("border","none"),ne.style.setProperty("font-size","1.5rem"),ne.style.setProperty("cursor","pointer"),ne.style.setProperty("padding","0.5rem"),s(V,b(Ge,{get when(){return x()==="setup"},get children(){var L=JA(),j=L.firstChild,Z=j.nextSibling,te=Z.nextSibling,he=te.nextSibling,se=he.firstChild,re=se.firstChild,ye=re.firstChild,G=re.nextSibling,ae=G.firstChild,Pe=se.nextSibling,we=Pe.firstChild,ue=we.firstChild,ce=we.nextSibling,H=ce.firstChild,de=Pe.nextSibling,X=de.firstChild,_e=X.firstChild,Se=X.nextSibling,Y=Se.firstChild,ie=Y.nextSibling,Ie=ie.nextSibling;return L.style.setProperty("text-align","center"),L.style.setProperty("padding","2rem"),L.style.setProperty("max-width","600px"),L.style.setProperty("margin","0 auto"),j.style.setProperty("font-size","3rem"),j.style.setProperty("margin-bottom","1rem"),Z.style.setProperty("margin-bottom","1rem"),s(Z,()=>e("inventory.setupPhysicalCount","Setup Physical Inventory Count")),te.style.setProperty("margin-bottom","2rem"),te.style.setProperty("color","var(--text-muted)"),s(te,()=>e("inventory.setupDescription","Configure your physical inventory count settings and begin the counting process.")),he.style.setProperty("display","grid"),he.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),he.style.setProperty("gap","1rem"),he.style.setProperty("margin-bottom","2rem"),he.style.setProperty("padding","1rem"),he.style.setProperty("background","var(--surface-color)"),he.style.setProperty("border-radius","var(--border-radius)"),he.style.setProperty("text-align","left"),re.style.setProperty("display","block"),re.style.setProperty("margin-bottom","0.5rem"),re.style.setProperty("font-weight","500"),s(re,()=>e("inventory.location","Location"),ye),G.addEventListener("change",pe=>h(pe.target.value)),G.style.setProperty("width","100%"),G.style.setProperty("padding","0.5rem"),G.style.setProperty("border","1px solid var(--border-color)"),G.style.setProperty("border-radius","var(--border-radius-sm)"),s(ae,()=>e("inventory.allLocations","All Locations")),s(G,b(jt,{get each(){return ee()},children:pe=>(()=>{var me=Th();return s(me,()=>pe.name),K(()=>me.value=pe.id),me})()}),null),we.style.setProperty("display","block"),we.style.setProperty("margin-bottom","0.5rem"),we.style.setProperty("font-weight","500"),s(we,()=>e("inventory.category","Category"),ue),ce.addEventListener("change",pe=>p(pe.target.value)),ce.style.setProperty("width","100%"),ce.style.setProperty("padding","0.5rem"),ce.style.setProperty("border","1px solid var(--border-color)"),ce.style.setProperty("border-radius","var(--border-radius-sm)"),s(H,()=>e("products.allCategories","All Categories")),s(ce,b(jt,{get each(){return q()},children:pe=>(()=>{var me=Th();return me.value=pe,s(me,pe),me})()}),null),X.style.setProperty("display","block"),X.style.setProperty("margin-bottom","0.5rem"),X.style.setProperty("font-weight","500"),s(X,()=>e("inventory.sortBy","Sort By"),_e),Se.addEventListener("change",pe=>E(pe.target.value)),Se.style.setProperty("width","100%"),Se.style.setProperty("padding","0.5rem"),Se.style.setProperty("border","1px solid var(--border-color)"),Se.style.setProperty("border-radius","var(--border-radius-sm)"),s(Y,()=>e("inventory.productName","Product Name")),s(ie,()=>e("inventory.sku","SKU")),s(Ie,()=>e("inventory.category","Category")),s(L,b(Ge,{get when(){return!i()},get fallback(){return(()=>{var pe=nI(),me=pe.firstChild;return pe.style.setProperty("padding","2rem"),s(pe,()=>e("common.loading","Loading"),me),pe})()},get children(){return[(()=>{var pe=YA(),me=pe.firstChild;return me.firstChild,pe.style.setProperty("padding","1rem"),pe.style.setProperty("background","#fff3cd"),pe.style.setProperty("border-radius","var(--border-radius-sm)"),pe.style.setProperty("margin-bottom","2rem"),me.style.setProperty("margin","0"),me.style.setProperty("color","#856404"),s(me,()=>e("inventory.countWillInclude","This count will include {{count}} products from {{location}} in {{category}} category.",{count:z().length,location:le(),category:f()==="all"?e("inventory.allCategories","all categories"):f()}),null),pe})(),(()=>{var pe=QA();return pe.style.setProperty("display","grid"),pe.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),pe.style.setProperty("gap","1rem"),pe.style.setProperty("margin-bottom","2rem"),pe.style.setProperty("padding","1rem"),pe.style.setProperty("background","var(--surface-color)"),pe.style.setProperty("border-radius","var(--border-radius)"),s(pe,b(Oe,{variant:"primary",size:"large",onClick:C,get disabled(){return i()||z().length===0},get children(){return["🚀 ",oe(()=>e("inventory.startCounting","Start Physical Count"))]}}),null),s(pe,b(Oe,{variant:"primary",onClick:k,get disabled(){return i()},get children(){return["🖨️ ",oe(()=>e("common.print","Print"))]}}),null),pe})()]}}),null),K(()=>G.value=u()),K(()=>ce.value=f()),K(()=>Se.value=_()),L}}),null),s(V,b(Ge,{get when(){return x()==="counting"},get children(){var L=XA(),j=L.firstChild,Z=j.firstChild,te=Z.firstChild,he=te.nextSibling,se=Z.nextSibling,re=se.firstChild,ye=re.nextSibling,G=se.nextSibling,ae=G.firstChild,Pe=ae.nextSibling,we=G.nextSibling,ue=we.firstChild,ce=ue.firstChild,H=ue.nextSibling,de=j.nextSibling,X=de.nextSibling,_e=X.firstChild,Se=_e.firstChild,Y=Se.firstChild,ie=Y.firstChild,Ie=ie.nextSibling,pe=Ie.nextSibling,me=pe.nextSibling,J=me.nextSibling,D=J.nextSibling,ge=Se.nextSibling;return j.style.setProperty("display","grid"),j.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),j.style.setProperty("gap","1rem"),j.style.setProperty("margin-bottom","2rem"),j.style.setProperty("padding","1rem"),j.style.setProperty("background","var(--surface-color)"),j.style.setProperty("border-radius","var(--border-radius)"),Z.style.setProperty("text-align","center"),te.style.setProperty("font-size","1.5rem"),te.style.setProperty("font-weight","700"),te.style.setProperty("color","var(--primary-color)"),s(te,()=>w().countedProducts),he.style.setProperty("font-size","0.875rem"),he.style.setProperty("color","var(--text-muted)"),s(he,()=>e("inventory.counted","Counted")),se.style.setProperty("text-align","center"),re.style.setProperty("font-size","1.5rem"),re.style.setProperty("font-weight","700"),re.style.setProperty("color","#ff9800"),s(re,()=>w().remainingProducts),ye.style.setProperty("font-size","0.875rem"),ye.style.setProperty("color","var(--text-muted)"),s(ye,()=>e("inventory.remaining","Remaining")),G.style.setProperty("text-align","center"),ae.style.setProperty("font-size","1.5rem"),ae.style.setProperty("font-weight","700"),ae.style.setProperty("color","#f44336"),s(ae,()=>w().variances),Pe.style.setProperty("font-size","0.875rem"),Pe.style.setProperty("color","var(--text-muted)"),s(Pe,()=>e("inventory.variances","Variances")),we.style.setProperty("text-align","center"),ue.style.setProperty("font-size","1.5rem"),ue.style.setProperty("font-weight","700"),s(ue,()=>Math.round(w().countedProducts/w().totalProducts*100),ce),H.style.setProperty("font-size","0.875rem"),H.style.setProperty("color","var(--text-muted)"),s(H,()=>e("inventory.complete","Complete")),de.style.setProperty("display","flex"),de.style.setProperty("gap","1rem"),de.style.setProperty("margin-bottom","2rem"),de.style.setProperty("justify-content","center"),s(de,b(Oe,{variant:"outline",onClick:()=>$("setup"),get children(){return["⬅️ ",oe(()=>e("common.back","Back to Setup"))]}}),null),s(de,b(Oe,{variant:"primary",onClick:()=>$("review"),get children(){return["📋 ",oe(()=>e("inventory.reviewAdjustments","Review Adjustments"))]}}),null),X.style.setProperty("border","1px solid var(--border-color)"),X.style.setProperty("border-radius","var(--border-radius)"),X.style.setProperty("overflow-x","auto"),_e.style.setProperty("width","100%"),_e.style.setProperty("border-collapse","collapse"),Y.style.setProperty("background","var(--surface-color)"),ie.style.setProperty("padding","1rem"),ie.style.setProperty("text-align","left"),ie.style.setProperty("border-bottom","1px solid var(--border-color)"),s(ie,()=>e("inventory.no","No")),Ie.style.setProperty("padding","1rem"),Ie.style.setProperty("text-align","left"),Ie.style.setProperty("border-bottom","1px solid var(--border-color)"),s(Ie,()=>e("inventory.product","Product")),pe.style.setProperty("padding","1rem"),pe.style.setProperty("text-align","center"),pe.style.setProperty("border-bottom","1px solid var(--border-color)"),s(pe,()=>e("inventory.systemQty","System Qty")),me.style.setProperty("padding","1rem"),me.style.setProperty("text-align","center"),me.style.setProperty("border-bottom","1px solid var(--border-color)"),s(me,()=>e("inventory.physicalCount","Physical Count")),J.style.setProperty("padding","1rem"),J.style.setProperty("text-align","center"),J.style.setProperty("border-bottom","1px solid var(--border-color)"),s(J,()=>e("inventory.variance","Variance")),D.style.setProperty("padding","1rem"),D.style.setProperty("text-align","left"),D.style.setProperty("border-bottom","1px solid var(--border-color)"),s(D,()=>e("common.notes","Notes")),s(ge,b(jt,{get each(){return A()},children:(ke,Ee)=>b(aI,{get index(){return Ee()},updatePhysicalCount:v,entry:ke,updateNotes:S})})),K(ke=>(ke=w().isComplete?"#4caf50":"#ff9800")!=null?ue.style.setProperty("color",ke):ue.style.removeProperty("color")),L}}),null),s(V,b(Ge,{get when(){return x()==="review"},get children(){var L=tI(),j=L.firstChild,Z=j.firstChild;Z.firstChild;var te=Z.nextSibling,he=j.nextSibling,se=he.firstChild,re=se.firstChild,ye=re.nextSibling,G=se.nextSibling,ae=G.firstChild,Pe=ae.nextSibling,we=G.nextSibling,ue=we.firstChild,ce=ue.nextSibling,H=he.nextSibling;return j.style.setProperty("text-align","center"),j.style.setProperty("margin-bottom","2rem"),Z.style.setProperty("margin-bottom","1rem"),s(Z,()=>e("inventory.reviewAndConfirm","Review and Confirm Adjustments"),null),te.style.setProperty("color","var(--text-muted)"),s(te,()=>e("inventory.reviewDescription","Review the inventory adjustments below and confirm to update your system.")),he.style.setProperty("display","grid"),he.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),he.style.setProperty("gap","1rem"),he.style.setProperty("margin-bottom","2rem"),he.style.setProperty("padding","1rem"),he.style.setProperty("background","var(--surface-color)"),he.style.setProperty("border-radius","var(--border-radius)"),se.style.setProperty("text-align","center"),re.style.setProperty("font-size","1.5rem"),re.style.setProperty("font-weight","700"),re.style.setProperty("color","#4caf50"),s(re,()=>w().positiveVariances),ye.style.setProperty("font-size","0.875rem"),ye.style.setProperty("color","var(--text-muted)"),s(ye,()=>e("inventory.stockIncreases","Stock Increases")),G.style.setProperty("text-align","center"),ae.style.setProperty("font-size","1.5rem"),ae.style.setProperty("font-weight","700"),ae.style.setProperty("color","#f44336"),s(ae,()=>w().negativeVariances),Pe.style.setProperty("font-size","0.875rem"),Pe.style.setProperty("color","var(--text-muted)"),s(Pe,()=>e("inventory.stockDecreases","Stock Decreases")),we.style.setProperty("text-align","center"),ue.style.setProperty("font-size","1.5rem"),ue.style.setProperty("font-weight","700"),ue.style.setProperty("color","var(--primary-color)"),s(ue,()=>w().variances),ce.style.setProperty("font-size","0.875rem"),ce.style.setProperty("color","var(--text-muted)"),s(ce,()=>e("inventory.totalAdjustments","Total Adjustments")),H.style.setProperty("display","flex"),H.style.setProperty("gap","1rem"),H.style.setProperty("margin-bottom","2rem"),H.style.setProperty("justify-content","center"),H.style.setProperty("flex-wrap","wrap"),s(H,b(Oe,{variant:"outline",onClick:()=>$("counting"),get children(){return["⬅️ ",oe(()=>e("common.back","Back to Counting"))]}}),null),s(H,b(Oe,{variant:"outline",onClick:I,get disabled(){return w().variances===0},get children(){return["📥 ",oe(()=>e("inventory.downloadCSV","Download CSV"))]}}),null),s(H,b(Oe,{variant:"primary",onClick:y,get disabled(){return a()||w().variances===0},get children(){return oe(()=>!!a())()?"💾 "+e("common.saving","Saving")+"...":"✅ "+e("inventory.confirmAdjustments","Confirm Adjustments")}}),null),s(L,b(Ge,{get when(){return w().variances>0},get children(){var de=ZA(),X=de.firstChild,_e=X.firstChild,Se=_e.firstChild,Y=Se.firstChild,ie=Y.nextSibling,Ie=ie.nextSibling,pe=Ie.nextSibling,me=pe.nextSibling,J=_e.nextSibling;return de.style.setProperty("border","1px solid var(--border-color)"),de.style.setProperty("border-radius","var(--border-radius)"),de.style.setProperty("overflow-x","auto"),X.style.setProperty("width","100%"),X.style.setProperty("border-collapse","collapse"),Se.style.setProperty("background","var(--surface-color)"),Y.style.setProperty("padding","1rem"),Y.style.setProperty("text-align","left"),Y.style.setProperty("border-bottom","1px solid var(--border-color)"),s(Y,()=>e("inventory.product","Product")),ie.style.setProperty("padding","1rem"),ie.style.setProperty("text-align","center"),ie.style.setProperty("border-bottom","1px solid var(--border-color)"),s(ie,()=>e("inventory.systemQty","System Qty")),Ie.style.setProperty("padding","1rem"),Ie.style.setProperty("text-align","center"),Ie.style.setProperty("border-bottom","1px solid var(--border-color)"),s(Ie,()=>e("inventory.physicalCount","Physical Count")),pe.style.setProperty("padding","1rem"),pe.style.setProperty("text-align","center"),pe.style.setProperty("border-bottom","1px solid var(--border-color)"),s(pe,()=>e("inventory.adjustment","Adjustment")),me.style.setProperty("padding","1rem"),me.style.setProperty("text-align","left"),me.style.setProperty("border-bottom","1px solid var(--border-color)"),s(me,()=>e("common.notes","Notes")),s(J,b(jt,{get each(){return A().filter(D=>D.variance!==0)},children:D=>(()=>{var ge=iI(),ke=ge.firstChild,Ee=ke.firstChild,Te=Ee.nextSibling,De=Te.firstChild,Ke=ke.nextSibling,Me=Ke.firstChild,ve=Ke.nextSibling,Le=ve.firstChild,Fe=ve.nextSibling,ze=Fe.firstChild,qe=Fe.nextSibling,Ce=qe.firstChild;return ge.style.setProperty("border-bottom","1px solid var(--border-color)"),ke.style.setProperty("padding","1rem"),Ee.style.setProperty("font-weight","500"),s(Ee,()=>D.product.name),Te.style.setProperty("font-size","0.875rem"),Te.style.setProperty("color","var(--text-muted)"),s(Te,()=>D.product.sku,De),s(Te,()=>D.product.category,null),Ke.style.setProperty("padding","1rem"),Ke.style.setProperty("text-align","center"),Me.style.setProperty("font-weight","600"),s(Me,()=>D.systemQuantity),ve.style.setProperty("padding","1rem"),ve.style.setProperty("text-align","center"),Le.style.setProperty("font-weight","600"),s(Le,()=>D.physicalCount),Fe.style.setProperty("padding","1rem"),Fe.style.setProperty("text-align","center"),ze.style.setProperty("font-weight","700"),s(ze,()=>D.variance>0?"+":"",null),s(ze,()=>D.variance,null),qe.style.setProperty("padding","1rem"),Ce.style.setProperty("font-size","0.875rem"),s(Ce,()=>D.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")),K(Ye=>{var Qe=D.variance>0?"#d4edda":"#f8d7da",Ze=D.variance>0?"#4caf50":"#f44336";return Qe!==Ye.e&&((Ye.e=Qe)!=null?ge.style.setProperty("background",Qe):ge.style.removeProperty("background")),Ze!==Ye.t&&((Ye.t=Ze)!=null?ze.style.setProperty("color",Ze):ze.style.removeProperty("color")),Ye},{e:void 0,t:void 0}),ge})()})),de}}),null),s(L,b(Ge,{get when(){return w().variances===0},get children(){var de=eI(),X=de.firstChild,_e=X.nextSibling,Se=_e.nextSibling;return de.style.setProperty("text-align","center"),de.style.setProperty("padding","3rem"),de.style.setProperty("background","var(--surface-color)"),de.style.setProperty("border-radius","var(--border-radius)"),X.style.setProperty("font-size","3rem"),X.style.setProperty("margin-bottom","1rem"),_e.style.setProperty("margin-bottom","0.5rem"),s(_e,()=>e("inventory.perfectCount","Perfect Count!")),Se.style.setProperty("color","var(--text-muted)"),s(Se,()=>e("inventory.noVariances","No variances found. Your physical count matches the system exactly.")),de}}),null),L}}),null),R}})},aI=t=>{const{t:e}=pt(),[r,n]=fe(""),[i,o]=fe("");let{entry:a,updatePhysicalCount:c,updateNotes:u,index:h}=t;return yn(()=>{o(a?.notes),n(a?.physicalCount)}),(()=>{var f=oI(),p=f.firstChild,_=p.firstChild,E=p.nextSibling,A=E.firstChild,T=A.nextSibling,x=T.firstChild,$=x.nextSibling;$.nextSibling;var O=E.nextSibling,q=O.firstChild,z=O.nextSibling,ee=z.firstChild,Q=z.nextSibling,C=Q.firstChild,v=Q.nextSibling,S=v.firstChild;return f.style.setProperty("border-bottom","1px solid var(--border-color)"),p.style.setProperty("padding","1rem"),p.style.setProperty("text-align","center"),_.style.setProperty("font-weight","600"),s(_,h+1),E.style.setProperty("padding","1rem"),A.style.setProperty("font-weight","500"),s(A,()=>a?.product.name),T.style.setProperty("font-size","0.875rem"),T.style.setProperty("color","var(--text-muted)"),s(T,()=>a?.product.sku,x),s(T,()=>a?.product.category,$),s(T,()=>a?.product.unitOfMeasure,null),O.style.setProperty("padding","1rem"),O.style.setProperty("text-align","center"),q.style.setProperty("font-weight","600"),s(q,()=>a?.systemQuantity),z.style.setProperty("padding","1rem"),z.style.setProperty("text-align","center"),ee.addEventListener("blur",()=>{c(a?.productId,r()===""?null:parseFloat(r()))}),ee.$$keydown=w=>{w.keyCode===13&&c(a?.productId,r()===""?null:parseFloat(r())),w.keyCode===27&&c(a?.productId,r()===""?null:parseFloat(r())),w.keyCode===9&&c(a?.productId,r()===""?null:parseFloat(r()))},ee.$$input=w=>{const P=w.target.value;n(P)},gt(ee,"tabindex",h),ee.style.setProperty("width","100px"),ee.style.setProperty("padding","0.5rem"),ee.style.setProperty("border","1px solid var(--border-color)"),ee.style.setProperty("border-radius","var(--border-radius-sm)"),ee.style.setProperty("text-align","center"),Q.style.setProperty("padding","1rem"),Q.style.setProperty("text-align","center"),C.style.setProperty("font-weight","600"),s(C,()=>a?.variance>0?"+":"",null),s(C,()=>a?.variance||"—",null),v.style.setProperty("padding","1rem"),S.addEventListener("blur",w=>{u(a?.productId,i())}),S.$$keydown=w=>{w.keyCode===13&&u(a?.productId,i()),w.keyCode===27&&u(a?.productId,i()),w.keyCode===9&&u(a?.productId,i())},S.$$input=w=>{const P=w.target.value;o(P)},S.style.setProperty("width","200px"),S.style.setProperty("padding","0.5rem"),S.style.setProperty("border","1px solid var(--border-color)"),S.style.setProperty("border-radius","var(--border-radius-sm)"),K(w=>{var P=a?.physicalCount!==null?a?.variance!==0?"#fff3cd":"#d4edda":"transparent",I=a?.variance>0?"#4caf50":a?.variance<0?"#f44336":"var(--text-muted)",y=e("inventory.addNotes","Add notes...");return P!==w.e&&((w.e=P)!=null?f.style.setProperty("background",P):f.style.removeProperty("background")),I!==w.t&&((w.t=I)!=null?C.style.setProperty("color",I):C.style.removeProperty("color")),y!==w.a&&gt(S,"placeholder",w.a=y),w},{e:void 0,t:void 0,a:void 0}),K(()=>ee.value=r()||""),K(()=>S.value=i()||""),f})()};Ot(["click","input","keydown"]);var lI=U("<div><h1></h1><div><div><span>View:</span><button> 1</button><button> 2"),Rr=U("<div>"),cI=U("<div><h3></h3><div>"),uI=U("<div>: <!> "),dI=U("<div><button></button><button></button><button></button><button>"),hI=U("<div><div>"),mI=U("<div><span> (<!>)</span><span> / <!> "),fI=U("<div><div><div><h2></h2><div><div></div></div></div></div><div><span>"),yI=U("<span>🔍 "),gI=U("<div><div><div><div><h3></h3><span></span></div><div></div><div>: </div></div><div><div> </div><div>: <!> • <!>: </div><div>: "),pI=U("<div><div>:</div><div>"),vI=U("<div>: "),bI=U("<div><div><span>:</span><select><option value=10>10</option><option value=20>20</option><option value=50>50</option><option value=100>100</option></select></div><div><div><span></span><input type=number min=1><span> </span></div></div><div>"),_I=U("<div><div><h2></h2></div><div>"),SI=U("<div><div><div><span></span><h3></h3></div><div> • </div><div></div></div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div>:"),PI=U("<div><div><div><div></div><div></div></div><div><div> </div><div></div><div>Min: "),wI=U("<span>⚠️ LOW");const CI=()=>{const{t}=pt(),[e,r]=fe(!1),[n,i]=fe(!1),[o,a]=fe(!1),[c,u]=fe(null),[h,f]=fe("overview"),[p,_]=fe("new"),[E,A]=fe(""),[T,x]=fe(""),[$,O]=fe([]),[q,z]=fe(!1),[ee,Q]=fe(!1),[C,v]=fe(!1),[S,w]=fe(!1),[P,I]=fe(!1),[y,le]=fe(!1),[B,k]=fe(1),[W,R]=fe(20),V=J=>{u(J),a(!0)},M=it(()=>{const J=Be.products||[],D=Be.movements||[],ge=Be.stockLevels||[],ke=Be.getLowStockProducts(),Ee=J?.length||0,Te=J?.filter(Me=>Me.isActive).length,De=ge.reduce((Me,ve)=>Me*1+ve.quantity*1*ve.averageCost*1,0),Ke=D?.filter(Me=>{const ve=new Date(Me.createdDate),Le=new Date;return ve.getMonth()===Le.getMonth()&&ve.getFullYear()===Le.getFullYear()}).length;return{totalProducts:Ee,activeProducts:Te,lowStockProducts:ke.length,totalStockValue:De,totalMovementsThisMonth:Ke,totalLocations:Be.locations.length,activeLocations:Be.getActiveLocations().length}}),F=it(()=>Be.products.map(J=>{const D=Be.getStockByProduct(J.id),ge=Be.getTotalStockByProduct(J.id),ke=Be.getLastLocationByProduct(J.id);return{...J,totalStock:ge,stockByLocation:D,lastLocation:ke,isLowStock:ge<=J.minStockLevel}})),ne=it(()=>$().map(J=>{const D=Be.getStockByProduct(J.id),ge=Be.getTotalStockByProduct(J.id),ke=Be.getLastLocationByProduct(J.id);return console.log(J),{...J,totalStock:ge,stockByLocation:D,lastLocation:ke,isLowStock:ge<=J.minStockLevel}})),L=it(()=>{const J=ee()?ne():F(),D=(B()-1)*W(),ge=D+W();return J.slice(D,ge)}),j=it(()=>{const J=ee()?ne():F();return Math.ceil(J.length/W())});it(()=>{ee(),k(1)});const Z=(J,D)=>J<=D?t("inventory.lowStockAlert"):J<=D*2?t("inventory.normalStock"):t("inventory.inStock"),te=J=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(J),he=J=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(J),se=J=>{switch(J){case"warehouse":return t("inventory.warehouse");case"store":return t("inventory.store");case"supplier":return t("inventory.supplier");case"customer":return t("inventory.customer");default:return J}},re={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},ye={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},G=J=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500",background:J>50?"#d4edda":J>20?"#fff3cd":"#f8d7da",color:J>50?"#155724":J>20?"#856404":"#721c24"}),ae={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},Pe={color:"var(--text-muted)","font-size":"0.875rem"},we={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},ue={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},ce={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},H=J=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:J?"var(--primary-color)":"var(--text-muted)","border-bottom":J?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),de={padding:"1.5rem","margin-bottom":"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},X={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"1rem"},_e=J=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:J?"#ffebee":"#e8f5e8",color:J?"#d32f2f":"#2d7d32"}),Se={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem","margin-bottom":"2rem"},Y={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},ie={display:"flex",gap:"0.5rem","align-items":"center","margin-left":"auto","margin-right":"1rem"},Ie=J=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:J?"var(--primary-color)":"var(--surface-color)",color:J?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),pe=it(()=>{const J=Be.movements;return{total:J.length,stockIn:J.filter(D=>D.movementType==="in").length,stockOut:J.filter(D=>D.movementType==="out").length,transfers:J.filter(D=>D.movementType==="transfer").length,adjustments:J.filter(D=>D.movementType==="adjustment").length,totalValue:J.reduce((D,ge)=>D+ge.totalCost,0)}}),me=async()=>{try{try{const J=await Tn.getProducts("prod");console.log({apiResults:J});const D=Object.keys(J),ge=Ee=>{let De=J[Ee];return{id:Ee,name:De.name,businessId:De.businessId,sku:De.code,UPC:De.UPC,numCode:De.codeN,category:De.category,unitCost:De.unitCost||0,unitOfMeasure:De.unitOfMeasure,minStockLevel:De.minStockLevel,maxStockLevel:De.maxStockLevel,isActive:De.isActive,description:De.description||"",createdDate:De.createdAt||new Date().toISOString(),lastModified:De.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(De.sellingPrice||De.price||"0")}};let ke=D.map(ge);O(ke),Be.updProduct(ke)}catch(J){console.warn("API failed, using local store:",J),O(Be.products)}}catch{}finally{}};return yn(()=>{}),b(Wr,{get title(){return t("inventory.title")},get children(){return[(()=>{var J=lI(),D=J.firstChild,ge=D.nextSibling,ke=ge.firstChild,Ee=ke.firstChild,Te=Ee.nextSibling,De=Te.firstChild,Ke=Te.nextSibling,Me=Ke.firstChild;return d(J,ue),D.style.setProperty("margin","0"),D.style.setProperty("font-size","1.75rem"),ge.style.setProperty("display","flex"),ge.style.setProperty("align-items","center"),ge.style.setProperty("gap","1rem"),d(ke,ie),Ee.style.setProperty("font-weight","500"),Ee.style.setProperty("color","var(--text-muted)"),Ee.style.setProperty("font-size","0.875rem"),Te.$$click=()=>_("new"),s(Te,()=>t("common.view"),De),Ke.$$click=()=>_("legacy"),s(Ke,()=>t("common.view"),Me),s(ge,(()=>{var ve=oe(()=>p()==="new");return()=>ve()&&b(Oe,{variant:"outline",onClick:()=>le(!0),get children(){return["🔢 ",oe(()=>t("inventory.physicalCount","Physical Count"))]}})})(),null),s(ge,b(Oe,{variant:"primary",onClick:()=>i(!0),get children(){return oe(()=>p()==="new")()?t("inventory.addMovement"):t("common.add")}}),null),K(ve=>{var Le=Ie(p()==="new"),Fe=Ie(p()==="legacy");return ve.e=d(Te,Le,ve.e),ve.t=d(Ke,Fe,ve.t),ve},{e:void 0,t:void 0}),J})(),oe(()=>oe(()=>p()==="legacy")()?[(()=>{var J=Rr();return s(J,b(tt,{get title(){return t("inventory.totalItems")},get subtitle(){return t("inventory.inStock")},get children(){var D=Rr();return D.style.setProperty("font-size","1.5rem"),D.style.setProperty("font-weight","600"),D.style.setProperty("color","var(--primary-color)"),s(D,()=>Be.inventory.length),D}}),null),s(J,b(tt,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.itemsBelowThreshold")},get children(){var D=Rr();return D.style.setProperty("font-size","1.5rem"),D.style.setProperty("font-weight","600"),D.style.setProperty("color","var(--primary-color)"),s(D,()=>Be.getLowStockItems().length),D}}),null),s(J,b(tt,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.inventoryWorth")},get children(){var D=Rr();return D.style.setProperty("font-size","1.5rem"),D.style.setProperty("font-weight","600"),D.style.setProperty("color","var(--primary-color)"),s(D,()=>te(Be.getTotalValue())),D}}),null),K(D=>d(J,we,D)),J})(),(()=>{var J=Rr();return d(J,re),s(J,b(jt,{get each(){return Be.inventory},children:D=>{const ge=Z(D.quantity,D.minStock),ke=D.quantity<=D.minStock?8:D.quantity<=D.minStock*2?35:75;return b(tt,{onClick:()=>V(D),get children(){return[(()=>{var Ee=cI(),Te=Ee.firstChild,De=Te.nextSibling;return d(Ee,ye),Te.style.setProperty("margin","0"),Te.style.setProperty("font-size","1.1rem"),s(Te,()=>D.name),s(De,ge),K(Ke=>d(De,G(ke),Ke)),Ee})(),(()=>{var Ee=Rr();return d(Ee,ae),s(Ee,()=>te(D.price)),Ee})(),(()=>{var Ee=uI(),Te=Ee.firstChild,De=Te.nextSibling;return De.nextSibling,d(Ee,Pe),s(Ee,()=>t("inventory.quantity"),Te),s(Ee,()=>D.quantity,De),s(Ee,()=>t("common.units"),null),Ee})()]}})}})),J})()]:[(()=>{var J=dI(),D=J.firstChild,ge=D.nextSibling,ke=ge.nextSibling,Ee=ke.nextSibling;return d(J,ce),D.$$click=()=>f("overview"),s(D,()=>t("inventory.overview")),ge.$$click=()=>f("products"),s(ge,()=>t("inventory.products")),ke.$$click=()=>f("movements"),s(ke,()=>t("inventory.movements")),Ee.$$click=()=>f("locations"),s(Ee,()=>t("inventory.locations")),K(Te=>{var De=H(h()==="overview"),Ke=H(h()==="products"),Me=H(h()==="movements"),ve=H(h()==="locations");return Te.e=d(D,De,Te.e),Te.t=d(ge,Ke,Te.t),Te.a=d(ke,Me,Te.a),Te.o=d(Ee,ve,Te.o),Te},{e:void 0,t:void 0,a:void 0,o:void 0}),J})(),oe(()=>oe(()=>h()==="overview")()&&(()=>{var J=hI(),D=J.firstChild;return s(D,b(tt,{get title(){return t("inventory.activeProducts")},get subtitle(){return t("inventory.currentlyManaged")},get children(){var ge=Rr();return ge.style.setProperty("font-size","1.5rem"),ge.style.setProperty("font-weight","600"),ge.style.setProperty("color","var(--primary-color)"),s(ge,()=>M().activeProducts),ge}}),null),s(D,b(tt,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.needAttention")},get children(){var ge=Rr();return ge.style.setProperty("font-size","1.5rem"),ge.style.setProperty("font-weight","600"),ge.style.setProperty("color","#d32f2f"),s(ge,()=>M().lowStockProducts),ge}}),null),s(D,b(tt,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.currentWorth")},get children(){var ge=Rr();return ge.style.setProperty("font-size","1.5rem"),ge.style.setProperty("font-weight","600"),ge.style.setProperty("color","var(--primary-color)"),s(ge,()=>he(pe().totalValue)),ge}}),null),s(D,b(tt,{get title(){return t("inventory.movements")},get subtitle(){return t("inventory.thisMonth")},get children(){var ge=Rr();return ge.style.setProperty("font-size","1.5rem"),ge.style.setProperty("font-weight","600"),ge.style.setProperty("color","var(--primary-color)"),s(ge,()=>M().totalMovementsThisMonth),ge}}),null),s(D,b(tt,{get title(){return t("inventory.activeLocations")},get subtitle(){return t("inventory.warehousesStores")},get children(){var ge=Rr();return ge.style.setProperty("font-size","1.5rem"),ge.style.setProperty("font-weight","600"),ge.style.setProperty("color","var(--primary-color)"),s(ge,()=>M().activeLocations),ge}}),null),s(J,(()=>{var ge=oe(()=>M().lowStockProducts>0);return()=>ge()&&b(tt,{get title(){return`⚠️ ${t("inventory.lowStockAlert")}`},get subtitle(){return`${M().lowStockProducts} ${t("inventory.productsNeedRestocking")}`},style:{"margin-bottom":"2rem","border-color":"#ffcdd2",background:"#ffebee"},get children(){var ke=Rr();return ke.style.setProperty("margin-top","1rem"),s(ke,b(jt,{get each(){return Be.getLowStockProducts().slice(0,9)},children:Ee=>(()=>{var Te=mI(),De=Te.firstChild,Ke=De.firstChild,Me=Ke.nextSibling;Me.nextSibling;var ve=De.nextSibling,Le=ve.firstChild,Fe=Le.nextSibling;return Fe.nextSibling,Te.style.setProperty("display","flex"),Te.style.setProperty("justify-content","space-between"),Te.style.setProperty("margin-bottom","0.5rem"),Te.style.setProperty("font-size","0.875rem"),s(De,()=>Ee.name,Ke),s(De,()=>Ee?.sku,Me),ve.style.setProperty("color","#d32f2f"),ve.style.setProperty("font-weight","600"),s(ve,()=>Ee.currentStock,Le),s(ve,()=>Ee.minStockLevel,Fe),s(ve,()=>t("inventory.min"),null),Te})()}),null),s(ke,(()=>{var Ee=oe(()=>Be.getLowStockProducts().length>5);return()=>Ee()&&(()=>{var Te=Rr();return Te.style.setProperty("font-size","0.875rem"),Te.style.setProperty("color","var(--text-muted)"),Te.style.setProperty("font-style","italic"),s(Te,()=>t("common.andMore",{count:Be.getLowStockProducts().length-9})),Te})()})(),null),ke}})})(),null),K(ge=>d(D,we,ge)),J})()),oe(()=>oe(()=>h()==="products")()&&(()=>{var J=fI(),D=J.firstChild,ge=D.firstChild,ke=ge.firstChild,Ee=ke.nextSibling,Te=Ee.firstChild,De=D.nextSibling,Ke=De.firstChild;return D.style.setProperty("display","flex"),D.style.setProperty("justify-content","space-between"),D.style.setProperty("align-items","flex-start"),D.style.setProperty("margin-bottom","1.5rem"),D.style.setProperty("flex-wrap","wrap"),D.style.setProperty("gap","1rem"),ge.style.setProperty("flex","1"),ge.style.setProperty("min-width","300px"),ke.style.setProperty("margin","0 0 1rem 0"),ke.style.setProperty("font-size","1.5rem"),s(ke,()=>t("inventory.products")),Ee.style.setProperty("display","flex"),Ee.style.setProperty("gap","1rem"),Ee.style.setProperty("align-items","center"),Ee.style.setProperty("flex-wrap","wrap"),Te.style.setProperty("flex","1"),Te.style.setProperty("min-width","250px"),s(Te,b(KA,{onSearchResults:Me=>{O(Me),Q(Me.length>0)},get placeholder(){return t("inventory.searchProductsStock","Search products and check stock levels...")},showResults:!1,maxResults:20})),s(Ee,b(Oe,{variant:"outline",onClick:()=>{me(),Q(!1)},get children(){return["🔄 ",oe(()=>t("common.showAll","Show All"))]}}),null),s(D,b(Oe,{variant:"primary",onClick:()=>v(!0),get children(){return["➕ ",oe(()=>t("inventory.addProduct"))]}}),null),De.style.setProperty("margin-bottom","1rem"),De.style.setProperty("font-size","0.875rem"),De.style.setProperty("color","var(--text-muted)"),De.style.setProperty("display","flex"),De.style.setProperty("justify-content","space-between"),De.style.setProperty("align-items","center"),s(Ke,(()=>{var Me=oe(()=>!!ee());return()=>Me()?`${t("inventory.searchResults","Search Results")}: ${ne().length} ${t("common.products","products")}`:`${t("inventory.totalProducts","Total Products")}: ${F().length} ${t("common.products","products")}`})()),s(De,(()=>{var Me=oe(()=>!!ee());return()=>Me()&&(()=>{var ve=yI();return ve.firstChild,ve.style.setProperty("color","var(--primary-color)"),s(ve,()=>t("inventory.filtered","Filtered view"),null),ve})()})(),null),s(J,b(jt,{get each(){return L()},children:Me=>(()=>{var ve=gI(),Le=ve.firstChild,Fe=Le.firstChild,ze=Fe.firstChild,qe=ze.firstChild,Ce=qe.nextSibling,Ye=ze.nextSibling,Qe=Ye.nextSibling,Ze=Qe.firstChild,Ae=Fe.nextSibling,et=Ae.firstChild,Pt=et.firstChild,rt=et.nextSibling,vt=rt.firstChild,at=vt.nextSibling,Vt=at.nextSibling,xt=Vt.nextSibling;xt.nextSibling;var bt=rt.nextSibling,Ue=bt.firstChild;return ve.addEventListener("mouseleave",Ve=>{Ve.currentTarget.style.transform="translateY(0)",Ve.currentTarget.style.boxShadow="none"}),ve.addEventListener("mouseenter",Ve=>{Ve.currentTarget.style.transform="translateY(-2px)",Ve.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),d(ve,de),d(Le,X),ze.style.setProperty("display","flex"),ze.style.setProperty("align-items","center"),ze.style.setProperty("gap","0.5rem"),ze.style.setProperty("margin-bottom","0.5rem"),qe.style.setProperty("margin","0"),qe.style.setProperty("font-size","1.1rem"),s(qe,()=>Me.name),s(Ce,(()=>{var Ve=oe(()=>!!Me.isLowStock);return()=>Ve()?t("inventory.lowStockAlert"):t("inventory.inStock")})()),Ye.style.setProperty("font-size","0.875rem"),Ye.style.setProperty("color","var(--text-muted)"),s(Ye,()=>Me.sku,null),s(Ye,()=>Me.UPC?" • "+Me.UPC:"",null),s(Ye,()=>Me.category?" • "+Me.category:"",null),Qe.style.setProperty("font-size","0.875rem"),Qe.style.setProperty("color","var(--text-muted)"),s(Qe,()=>t("inventory.lastSeen"),Ze),s(Qe,()=>Me.lastLocation?.name||t("inventory.noMovements"),null),Ae.style.setProperty("text-align","right"),et.style.setProperty("font-size","1.25rem"),et.style.setProperty("font-weight","700"),et.style.setProperty("color","var(--primary-color)"),s(et,()=>Me.totalStock,Pt),s(et,()=>Me.unitOfMeasure,null),rt.style.setProperty("font-size","0.875rem"),rt.style.setProperty("color","var(--text-muted)"),s(rt,()=>t("inventory.min"),vt),s(rt,()=>Me.minStockLevel,at),s(rt,()=>t("inventory.max"),xt),s(rt,()=>Me.maxStockLevel,null),bt.style.setProperty("font-size","0.875rem"),bt.style.setProperty("color","var(--text-muted)"),s(bt,()=>t("inventory.cost"),Ue),s(bt,()=>he(Me.unitCost),null),s(ve,(()=>{var Ve=oe(()=>Me.stockByLocation.length>0);return()=>Ve()&&(()=>{var Je=pI(),st=Je.firstChild,_t=st.firstChild,nt=st.nextSibling;return Je.style.setProperty("margin-top","1rem"),st.style.setProperty("font-weight","500"),st.style.setProperty("margin-bottom","0.5rem"),st.style.setProperty("font-size","0.875rem"),s(st,()=>t("inventory.stockByLocation"),_t),nt.style.setProperty("display","flex"),nt.style.setProperty("flex-wrap","wrap"),nt.style.setProperty("gap","0.5rem"),s(nt,b(jt,{get each(){return Me.stockByLocation},children:$e=>{const Xe=Be.getLocationById($e.locationId);return console.log("location",$e,Xe),(()=>{var ut=vI(),ht=ut.firstChild;return ut.style.setProperty("padding","0.25rem 0.5rem"),ut.style.setProperty("background","var(--background-color)"),ut.style.setProperty("border-radius","var(--border-radius-sm)"),ut.style.setProperty("font-size","0.75rem"),ut.style.setProperty("border","1px solid var(--border-color)"),s(ut,()=>Xe?.name,ht),s(ut,()=>$e.quantity,null),ut})()}})),Je})()})(),null),K(Ve=>d(Ce,_e(Me.isLowStock),Ve)),ve})()}),null),s(J,(()=>{var Me=oe(()=>j()>1);return()=>Me()&&(()=>{var ve=bI(),Le=ve.firstChild,Fe=Le.firstChild,ze=Fe.firstChild,qe=Fe.nextSibling,Ce=Le.nextSibling,Ye=Ce.firstChild,Qe=Ye.firstChild,Ze=Qe.nextSibling,Ae=Ze.nextSibling,et=Ae.firstChild,Pt=Ce.nextSibling;return ve.style.setProperty("display","flex"),ve.style.setProperty("justify-content","space-between"),ve.style.setProperty("align-items","center"),ve.style.setProperty("margin-top","2rem"),ve.style.setProperty("padding","1rem"),ve.style.setProperty("background","var(--surface-color)"),ve.style.setProperty("border-radius","var(--border-radius)"),ve.style.setProperty("border","1px solid var(--border-color)"),Le.style.setProperty("display","flex"),Le.style.setProperty("align-items","center"),Le.style.setProperty("gap","0.5rem"),Fe.style.setProperty("font-size","0.875rem"),Fe.style.setProperty("color","var(--text-muted)"),s(Fe,()=>t("common.showPerPage","Show per page"),ze),qe.addEventListener("change",rt=>{R(parseInt(rt.target.value)),k(1)}),qe.style.setProperty("padding","0.25rem 0.5rem"),qe.style.setProperty("border","1px solid var(--border-color)"),qe.style.setProperty("border-radius","var(--border-radius-sm)"),qe.style.setProperty("background","var(--background-color)"),qe.style.setProperty("cursor","pointer"),Ce.style.setProperty("display","flex"),Ce.style.setProperty("align-items","center"),Ce.style.setProperty("gap","0.5rem"),s(Ce,b(Oe,{variant:"outline",size:"sm",onClick:()=>k(1),get disabled(){return B()===1},get children(){return t("common.first","First")}}),Ye),s(Ce,b(Oe,{variant:"outline",size:"sm",onClick:()=>k(rt=>Math.max(1,rt-1)),get disabled(){return B()===1},get children(){return t("common.previous","Previous")}}),Ye),Ye.style.setProperty("display","flex"),Ye.style.setProperty("align-items","center"),Ye.style.setProperty("gap","0.25rem"),Qe.style.setProperty("font-size","0.875rem"),s(Qe,()=>t("common.page","Page")),Ze.addEventListener("change",rt=>{const vt=parseInt(rt.target.value);vt>=1&&vt<=j()&&k(vt)}),Ze.style.setProperty("width","60px"),Ze.style.setProperty("padding","0.25rem 0.5rem"),Ze.style.setProperty("border","1px solid var(--border-color)"),Ze.style.setProperty("border-radius","var(--border-radius-sm)"),Ze.style.setProperty("text-align","center"),Ze.style.setProperty("font-size","0.875rem"),Ae.style.setProperty("font-size","0.875rem"),s(Ae,()=>t("common.of","of"),et),s(Ae,j,null),s(Ce,b(Oe,{variant:"outline",size:"sm",onClick:()=>k(rt=>Math.min(j(),rt+1)),get disabled(){return B()===j()},get children(){return t("common.next","Next")}}),null),s(Ce,b(Oe,{variant:"outline",size:"sm",onClick:()=>k(j()),get disabled(){return B()===j()},get children(){return t("common.last","Last")}}),null),Pt.style.setProperty("font-size","0.875rem"),Pt.style.setProperty("color","var(--text-muted)"),s(Pt,()=>{const rt=ee()?ne():F(),vt=(B()-1)*W()+1,at=Math.min(B()*W(),rt.length);return t("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:vt,end:at,total:rt.length})}),K(()=>gt(Ze,"max",j())),K(()=>qe.value=W()),K(()=>Ze.value=B()),ve})()})(),null),J})()),oe(()=>oe(()=>h()==="movements")()&&b(UA,{})),oe(()=>oe(()=>h()==="locations")()&&(()=>{var J=_I(),D=J.firstChild,ge=D.firstChild,ke=D.nextSibling;return D.style.setProperty("display","flex"),D.style.setProperty("justify-content","space-between"),D.style.setProperty("align-items","center"),D.style.setProperty("margin-bottom","1.5rem"),ge.style.setProperty("margin","0"),ge.style.setProperty("font-size","1.5rem"),s(ge,()=>t("inventory.locations")),s(D,b(Oe,{variant:"primary",onClick:()=>w(!0),get children(){return["🏭 ",oe(()=>t("inventory.addLocation"))]}}),null),d(ke,Se),s(ke,b(jt,{get each(){return Be.getActiveLocations()},children:Ee=>{const Te=Be.getStockByLocation(Ee.id),De=Te.length,Ke=Te.reduce((ve,Le)=>ve*1+Le.quantity*1,0),Me=Te.reduce((ve,Le)=>(Be.getProductById(Le.productId),ve+(Le?.averageCost||0)),0);return(()=>{var ve=SI(),Le=ve.firstChild,Fe=Le.firstChild,ze=Fe.firstChild,qe=ze.nextSibling,Ce=Fe.nextSibling,Ye=Ce.firstChild,Qe=Ce.nextSibling,Ze=Le.nextSibling,Ae=Ze.firstChild,et=Ae.firstChild,Pt=et.firstChild,rt=et.nextSibling,vt=Ae.nextSibling,at=vt.firstChild,Vt=at.firstChild,xt=at.nextSibling,bt=vt.nextSibling,Ue=bt.firstChild,Ve=Ue.firstChild,Je=Ue.nextSibling,st=Ze.nextSibling,_t=st.firstChild,nt=_t.firstChild;return Le.style.setProperty("margin-bottom","1rem"),Le.style.setProperty("padding-bottom","1rem"),Le.style.setProperty("border-bottom","1px solid var(--border-color)"),Fe.style.setProperty("display","flex"),Fe.style.setProperty("align-items","center"),Fe.style.setProperty("gap","0.5rem"),Fe.style.setProperty("margin-bottom","0.5rem"),ze.style.setProperty("font-size","1.2rem"),s(ze,()=>Ee.type==="warehouse"?"🏭":Ee.type==="store"?"🏪":Ee.type==="supplier"?"🚚":"👥"),qe.style.setProperty("margin","0"),qe.style.setProperty("font-size","1.1rem"),s(qe,()=>Ee.name),Ce.style.setProperty("font-size","0.875rem"),Ce.style.setProperty("color","var(--text-muted)"),s(Ce,()=>Ee.code,Ye),s(Ce,()=>se(Ee.type),null),Qe.style.setProperty("font-size","0.75rem"),Qe.style.setProperty("color","var(--text-muted)"),Qe.style.setProperty("margin-top","0.25rem"),s(Qe,()=>Ee.address),Ze.style.setProperty("margin-bottom","1rem"),Ae.style.setProperty("display","flex"),Ae.style.setProperty("justify-content","space-between"),Ae.style.setProperty("margin-bottom","0.5rem"),et.style.setProperty("font-size","0.875rem"),et.style.setProperty("font-weight","500"),s(et,()=>t("inventory.products"),Pt),rt.style.setProperty("font-weight","600"),s(rt,De),vt.style.setProperty("display","flex"),vt.style.setProperty("justify-content","space-between"),vt.style.setProperty("margin-bottom","0.5rem"),at.style.setProperty("font-size","0.875rem"),at.style.setProperty("font-weight","500"),s(at,()=>t("inventory.totalItems"),Vt),xt.style.setProperty("font-weight","600"),xt.style.setProperty("color","var(--primary-color)"),s(xt,Ke),bt.style.setProperty("display","flex"),bt.style.setProperty("justify-content","space-between"),bt.style.setProperty("margin-bottom","1rem"),Ue.style.setProperty("font-size","0.875rem"),Ue.style.setProperty("font-weight","500"),s(Ue,()=>t("inventory.totalValue"),Ve),Je.style.setProperty("font-weight","600"),Je.style.setProperty("color","var(--primary-color)"),s(Je,()=>he(Me)),_t.style.setProperty("font-weight","600"),_t.style.setProperty("margin-bottom","0.75rem"),_t.style.setProperty("font-size","0.875rem"),_t.style.setProperty("color","var(--text-primary)"),_t.style.setProperty("border-bottom","1px solid var(--border-color)"),_t.style.setProperty("padding-bottom","0.5rem"),s(_t,()=>t("inventory.productDetails"),nt),s(st,(()=>{var $e=oe(()=>Te.length===0);return()=>$e()?(()=>{var Xe=Rr();return Xe.style.setProperty("text-align","center"),Xe.style.setProperty("color","var(--text-muted)"),Xe.style.setProperty("font-style","italic"),Xe.style.setProperty("padding","1rem"),s(Xe,()=>t("inventory.noProducts")),Xe})():(()=>{var Xe=Rr();return Xe.style.setProperty("max-height","200px"),Xe.style.setProperty("overflow-y","auto"),Xe.style.setProperty("border","1px solid var(--border-color)"),Xe.style.setProperty("border-radius","var(--border-radius-sm)"),s(Xe,b(jt,{each:Te,children:ut=>{const ht=Be.getProductById(ut.productId);if(!ht)return null;const Yt=ut.quantity<=ht.minStockLevel,zt=ut.averageCost;return(()=>{var Dt=PI(),Gt=Dt.firstChild,wt=Gt.firstChild,Tt=wt.firstChild,Zt=Tt.nextSibling,$t=wt.nextSibling,Bt=$t.firstChild,dr=Bt.firstChild,hr=Bt.nextSibling,Qt=hr.nextSibling;return Qt.firstChild,Dt.style.setProperty("padding","0.75rem"),Dt.style.setProperty("border-bottom","1px solid var(--border-color)"),(Yt?"#fff5f5":"transparent")!=null?Dt.style.setProperty("background",Yt?"#fff5f5":"transparent"):Dt.style.removeProperty("background"),Dt.style.setProperty("transition","background-color 0.2s ease"),Gt.style.setProperty("display","flex"),Gt.style.setProperty("justify-content","space-between"),Gt.style.setProperty("align-items","flex-start"),Gt.style.setProperty("margin-bottom","0.25rem"),wt.style.setProperty("flex","1"),Tt.style.setProperty("font-weight","500"),Tt.style.setProperty("font-size","0.875rem"),(Yt?"#d32f2f":"var(--text-primary)")!=null?Tt.style.setProperty("color",Yt?"#d32f2f":"var(--text-primary)"):Tt.style.removeProperty("color"),s(Tt,()=>ht.name,null),s(Tt,Yt&&(()=>{var Pr=wI();return Pr.style.setProperty("margin-left","0.5rem"),Pr.style.setProperty("font-size","0.7rem"),Pr.style.setProperty("color","#d32f2f"),Pr})(),null),Zt.style.setProperty("font-size","0.75rem"),Zt.style.setProperty("color","var(--text-muted)"),Zt.style.setProperty("margin-top","0.1rem"),s(Zt,()=>ht.sku,null),s(Zt,()=>ht.UPC?" • "+ht.UPC:"",null),s(Zt,()=>ht.category?" • "+ht.category:"",null),$t.style.setProperty("text-align","right"),Bt.style.setProperty("font-weight","600"),Bt.style.setProperty("font-size","0.875rem"),(Yt?"#d32f2f":"var(--primary-color)")!=null?Bt.style.setProperty("color",Yt?"#d32f2f":"var(--primary-color)"):Bt.style.removeProperty("color"),s(Bt,()=>ut.quantity,dr),s(Bt,()=>ht.unitOfMeasure,null),hr.style.setProperty("font-size","0.75rem"),hr.style.setProperty("color","var(--text-muted)"),s(hr,()=>he(zt)),Qt.style.setProperty("font-size","0.7rem"),Qt.style.setProperty("color","var(--text-muted)"),Qt.style.setProperty("margin-top","0.1rem"),s(Qt,()=>ht.minStockLevel,null),Dt})()}})),Xe})()})(),null),K($e=>d(ve,{...Y,"min-height":"400px"},$e)),ve})()}})),J})())]),b(rA,{get isOpen(){return e()},onClose:()=>r(!1),get mode(){return p()==="new"?"movement":"legacy"}}),b(cA,{get isOpen(){return n()},onClose:()=>i(!1)}),b(fA,{get isOpen(){return o()},onClose:()=>a(!1),get item(){return c()}}),b(Wa,{get isOpen(){return C()},onClose:()=>v(!1),onProductAdded:()=>{v(!1)}}),b(lu,{get isOpen(){return S()},onClose:()=>w(!1),onLocationAdded:()=>{w(!1)}}),b(sI,{get isOpen(){return y()},onClose:()=>le(!1)})]}})};Ot(["click"]);function AI(t,e=300,r=!1){let n,i;const o=()=>{n!==void 0&&(clearTimeout(n),n=void 0),i=void 0},a=()=>{n!==void 0&&i!==void 0&&(clearTimeout(n),n=void 0,t(...i),i=void 0)},c=(...u)=>{i=u,n!==void 0&&clearTimeout(n),r&&n===void 0&&t(...u),n=window.setTimeout(()=>{r||t(...u),n=void 0,i=void 0},e)};return ao(()=>{o()}),{debounced:c,cancel:o,flush:a}}function II(t,e=300){const[r,n]=fe(!1);let i;const o=async h=>{if(i&&i.abort(),!h.trim()){n(!1);return}i=new AbortController,n(!0);try{await t(h)}catch(f){f instanceof Error&&f.name!=="AbortError"&&console.error("Search error:",f)}finally{i.signal.aborted||n(!1)}},{debounced:a,cancel:c}=AI(o,e,!1),u=()=>{c(),i&&i.abort(),n(!1)};return ao(()=>{u()}),{search:a,isSearching:r,cancel:u}}var EI=U("<div>"),xI=U("<div><h4>"),TI=U("<div><div><div><h2></h2><div>SKU: <!> • </div></div><div></div></div><div><h3></h3><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div></div><div><h3></h3><div><div><div><span></span><span></span></div><div><span></span><span></span></div></div><div><div><span></span><span></span></div><div><span></span><span>%</span></div></div></div></div><div><h3></h3><div><div><div><span></span><span> </span></div><div><span></span><span> </span></div></div><div><div><span></span><span> </span></div><div><span></span><span></span></div></div></div></div><div><h3></h3><div><span></span><span></span></div><div><span></span><span></span></div></div><div>"),$I=U("<span>✓ "),kI=U("<span>✗ "),RI=U("<div><div><span></span><span> </span></div><div>: <!> • <!>: ");const DI=t=>{const{t:e}=pt(),r=it(()=>{if(!t.product)return null;const A=Be.getTotalStockByProduct(t.product.id),T=Be.getStockByProduct(t.product.id),x=A<=t.product.minStockLevel,$=A===0,O=A>=t.product.maxStockLevel;return{total:A,byLocation:T,status:$?"out":x?"low":O?"over":"good",statusText:$?e("products.outOfStock","Out of Stock"):x?e("products.lowStock","Low Stock"):O?e("products.overStock","Over Stock"):e("products.inStock","In Stock")}}),n=A=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(A),i=A=>new Date(A).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),o=it(()=>!t.product||t.product.unitCost===0?0:((t.product.sellingPrice-t.product.unitCost)/t.product.unitCost*100).toFixed(2)),a={"margin-bottom":"2rem"},c={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},u={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},h={"font-weight":"400",color:"var(--text-primary)","font-size":"1rem"},f=A=>{const T={good:{background:"#d4edda",color:"#155724"},low:{background:"#fff3cd",color:"#856404"},out:{background:"#f8d7da",color:"#721c24"},over:{background:"#cce5ff",color:"#004085"}};return{display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500",...T[A]||T.good}},p={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"},_={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1rem","margin-bottom":"0.75rem"},E={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1.5rem","padding-bottom":"1rem","border-bottom":"2px solid var(--border-color)"};return b(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("products.productDetails","Product Details")},size:"large",get children(){return b(Ge,{get when(){return t.product},get fallback(){return(()=>{var A=EI();return A.style.setProperty("text-align","center"),A.style.setProperty("padding","2rem"),A.style.setProperty("color","var(--text-muted)"),s(A,()=>e("products.noProductSelected","No product selected")),A})()},children:A=>(()=>{var T=TI(),x=T.firstChild,$=x.firstChild,O=$.firstChild,q=O.nextSibling,z=q.firstChild,ee=z.nextSibling;ee.nextSibling;var Q=$.nextSibling,C=x.nextSibling,v=C.firstChild,S=v.nextSibling,w=S.firstChild,P=w.nextSibling,I=S.nextSibling,y=I.firstChild,le=y.nextSibling,B=I.nextSibling,k=B.firstChild,W=k.nextSibling,R=C.nextSibling,V=R.firstChild,M=V.nextSibling,F=M.firstChild,ne=F.firstChild,L=ne.firstChild,j=L.nextSibling,Z=ne.nextSibling,te=Z.firstChild,he=te.nextSibling,se=F.nextSibling,re=se.firstChild,ye=re.firstChild,G=ye.nextSibling,ae=re.nextSibling,Pe=ae.firstChild,we=Pe.nextSibling,ue=we.firstChild,ce=R.nextSibling,H=ce.firstChild,de=H.nextSibling,X=de.firstChild,_e=X.firstChild,Se=_e.firstChild,Y=Se.nextSibling,ie=Y.firstChild,Ie=_e.nextSibling,pe=Ie.firstChild,me=pe.nextSibling,J=me.firstChild,D=X.nextSibling,ge=D.firstChild,ke=ge.firstChild,Ee=ke.nextSibling,Te=Ee.firstChild,De=ge.nextSibling,Ke=De.firstChild,Me=Ke.nextSibling,ve=ce.nextSibling,Le=ve.firstChild,Fe=Le.nextSibling,ze=Fe.firstChild,qe=ze.nextSibling,Ce=Fe.nextSibling,Ye=Ce.firstChild,Qe=Ye.nextSibling,Ze=ve.nextSibling;return d(x,E),O.style.setProperty("margin","0"),O.style.setProperty("font-size","1.5rem"),O.style.setProperty("margin-bottom","0.25rem"),s(O,()=>A().name),q.style.setProperty("color","var(--text-muted)"),s(q,()=>A().sku,ee),s(q,()=>A().category,null),s(Q,()=>r()?.statusText),v.style.setProperty("margin-bottom","1rem"),v.style.setProperty("font-size","1.1rem"),s(v,()=>e("products.basicInformation","Basic Information")),s(w,()=>e("products.description","Description")),s(P,()=>A().description||e("common.notAvailable","N/A")),s(y,()=>e("products.unitOfMeasure","Unit of Measure")),s(le,()=>A().unitOfMeasure),s(k,()=>e("products.status","Status")),s(W,(()=>{var Ae=oe(()=>!!A().isActive);return()=>Ae()?(()=>{var et=$I();return et.firstChild,et.style.setProperty("color","#2e7d32"),s(et,()=>e("common.active","Active"),null),et})():(()=>{var et=kI();return et.firstChild,et.style.setProperty("color","#d32f2f"),s(et,()=>e("common.inactive","Inactive"),null),et})()})()),V.style.setProperty("margin-bottom","1rem"),V.style.setProperty("font-size","1.1rem"),s(V,()=>e("products.pricingInformation","Pricing Information")),s(L,()=>e("products.unitCost","Unit Cost")),s(j,()=>n(A().unitCost)),s(te,()=>e("products.sellingPrice","Selling Price")),s(he,()=>n(A().sellingPrice)),s(ye,()=>e("products.profit","Profit")),s(G,()=>n(A().sellingPrice-A().unitCost)),s(Pe,()=>e("products.profitMargin","Profit Margin")),s(we,o,ue),H.style.setProperty("margin-bottom","1rem"),H.style.setProperty("font-size","1.1rem"),s(H,()=>e("products.stockInformation","Stock Information")),s(Se,()=>e("products.totalStock","Total Stock")),s(Y,()=>r()?.total||0,ie),s(Y,()=>A().unitOfMeasure,null),s(pe,()=>e("products.minStockLevel","Min Stock Level")),s(me,()=>A().minStockLevel,J),s(me,()=>A().unitOfMeasure,null),s(ke,()=>e("products.maxStockLevel","Max Stock Level")),s(Ee,()=>A().maxStockLevel,Te),s(Ee,()=>A().unitOfMeasure,null),s(Ke,()=>e("products.stockValue","Stock Value")),s(Me,()=>n((r()?.total||0)*A().unitCost)),s(ce,b(Ge,{get when(){return oe(()=>!!r()?.byLocation)()&&r().byLocation.length>0},get children(){var Ae=xI(),et=Ae.firstChild;return Ae.style.setProperty("margin-top","1.5rem"),et.style.setProperty("margin-bottom","1rem"),et.style.setProperty("font-size","1rem"),s(et,()=>e("products.stockByLocation","Stock by Location")),s(Ae,()=>r().byLocation.map(Pt=>(()=>{var rt=RI(),vt=rt.firstChild,at=vt.firstChild,Vt=at.nextSibling,xt=Vt.firstChild,bt=vt.nextSibling,Ue=bt.firstChild,Ve=Ue.nextSibling,Je=Ve.nextSibling,st=Je.nextSibling;return st.nextSibling,d(rt,_),vt.style.setProperty("display","flex"),vt.style.setProperty("justify-content","space-between"),vt.style.setProperty("align-items","center"),at.style.setProperty("font-weight","500"),s(at,()=>Pt.locationName),Vt.style.setProperty("font-weight","600"),Vt.style.setProperty("color","var(--primary-color)"),s(Vt,()=>Pt.quantity,xt),s(Vt,()=>A().unitOfMeasure,null),bt.style.setProperty("margin-top","0.5rem"),bt.style.setProperty("font-size","0.875rem"),bt.style.setProperty("color","var(--text-muted)"),s(bt,()=>e("products.available","Available"),Ue),s(bt,()=>Pt.availableQuantity,Ve),s(bt,()=>e("products.reserved","Reserved"),st),s(bt,()=>Pt.reservedQuantity,null),rt})()),null),Ae}}),null),Le.style.setProperty("margin-bottom","1rem"),Le.style.setProperty("font-size","1.1rem"),s(Le,()=>e("products.timestamps","Timestamps")),s(ze,()=>e("common.createdDate","Created Date")),s(qe,()=>i(A().createdDate)),s(Ye,()=>e("common.lastModified","Last Modified")),s(Qe,()=>i(A().lastModified)),Ze.style.setProperty("display","flex"),Ze.style.setProperty("gap","1rem"),Ze.style.setProperty("justify-content","flex-end"),Ze.style.setProperty("margin-top","2rem"),s(Ze,b(Oe,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close","Close")}}),null),s(Ze,b(Ge,{get when(){return t.onEdit},get children(){return b(Oe,{variant:"primary",get onClick(){return t.onEdit},get children(){return e("common.edit","Edit")}})}}),null),K(Ae=>{var et=f(r()?.status||"good"),Pt=a,rt=c,vt=u,at=h,Vt=c,xt=u,bt=h,Ue=c,Ve=u,Je=h,st=a,_t=p,nt=c,$e=u,Xe=h,ut=c,ht=u,Yt=h,zt=c,Dt=u,Gt=h,wt=c,Tt=u,Zt=h,$t=a,Bt=p,dr=c,hr=u,Qt=h,Pr=c,Xr=u,On=h,gn=c,pn=u,Zr=h,Vr=c,Vn=u,vn=h,yt=a,Nt=c,rr=u,kr=h,Nr=c,Ut=u,gr=h;return Ae.e=d(Q,et,Ae.e),Ae.t=d(C,Pt,Ae.t),Ae.a=d(S,rt,Ae.a),Ae.o=d(w,vt,Ae.o),Ae.i=d(P,at,Ae.i),Ae.n=d(I,Vt,Ae.n),Ae.s=d(y,xt,Ae.s),Ae.h=d(le,bt,Ae.h),Ae.r=d(B,Ue,Ae.r),Ae.d=d(k,Ve,Ae.d),Ae.l=d(W,Je,Ae.l),Ae.u=d(R,st,Ae.u),Ae.c=d(M,_t,Ae.c),Ae.w=d(ne,nt,Ae.w),Ae.m=d(L,$e,Ae.m),Ae.f=d(j,Xe,Ae.f),Ae.y=d(Z,ut,Ae.y),Ae.g=d(te,ht,Ae.g),Ae.p=d(he,Yt,Ae.p),Ae.b=d(re,zt,Ae.b),Ae.T=d(ye,Dt,Ae.T),Ae.A=d(G,Gt,Ae.A),Ae.O=d(ae,wt,Ae.O),Ae.I=d(Pe,Tt,Ae.I),Ae.S=d(we,Zt,Ae.S),Ae.W=d(ce,$t,Ae.W),Ae.C=d(de,Bt,Ae.C),Ae.B=d(_e,dr,Ae.B),Ae.v=d(Se,hr,Ae.v),Ae.k=d(Y,Qt,Ae.k),Ae.x=d(Ie,Pr,Ae.x),Ae.j=d(pe,Xr,Ae.j),Ae.q=d(me,On,Ae.q),Ae.z=d(ge,gn,Ae.z),Ae.P=d(ke,pn,Ae.P),Ae.H=d(Ee,Zr,Ae.H),Ae.F=d(De,Vr,Ae.F),Ae.M=d(Ke,Vn,Ae.M),Ae.D=d(Me,vn,Ae.D),Ae.R=d(ve,yt,Ae.R),Ae.E=d(Fe,Nt,Ae.E),Ae.L=d(ze,rr,Ae.L),Ae.N=d(qe,kr,Ae.N),Ae.G=d(Ce,Nr,Ae.G),Ae.U=d(Ye,Ut,Ae.U),Ae.K=d(Qe,gr,Ae.K),Ae},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0,x:void 0,j:void 0,q:void 0,z:void 0,P:void 0,H:void 0,F:void 0,M:void 0,D:void 0,R:void 0,E:void 0,L:void 0,N:void 0,G:void 0,U:void 0,K:void 0}),T})()})}})};var NI=U("<form><div><label> *</label><input type=text required></div><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text list=categories required><datalist id=categories><option value=Electronics></option><option value=Accessories></option><option value=Office></option><option value=Furniture></option><option value=Software></option><option value=Hardware></option></datalist></div></div><div><label></label><textarea></textarea></div><div><label></label><div><input type=checkbox id=activeStatus><label for=activeStatus></label></div></div><div><div><label></label><select><option value=pcs></option><option value=kg></option><option value=lbs></option><option value=m></option><option value=ft></option><option value=l></option><option value=gal></option><option value=box></option><option value=pack></option></select></div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div></div><div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div><div></div></div><div><div><span>:</span><span>$</span></div><div><span>:</span><span>%</span></div></div><div><div><label></label><input type=number min=0 step=1></div><div><label></label><input type=number min=1 step=1></div></div><div>"),$h=U("<div>"),LI=U("<span>✓ "),MI=U("<span>✗ ");const OI=t=>{const{t:e}=pt(),[r,n]=fe(""),[i,o]=fe(""),[a,c]=fe(""),[u,h]=fe(""),[f,p]=fe("pcs"),[_,E]=fe(0),[A,T]=fe(0),[x,$]=fe(10),[O,q]=fe(100),[z,ee]=fe(!0),[Q,C]=fe("");Ln(()=>{t.product&&(n(t.product.name),o(t.product.sku),c(t.product.description||""),h(t.product.category),p(t.product.unitOfMeasure),E(t.product.unitCost),T(t.product.sellingPrice),$(t.product.minStockLevel),q(t.product.maxStockLevel),ee(t.product.isActive),C(""))});const v=M=>{if(M.preventDefault(),C(""),!t.product)return;if(!r().trim()){C(e("forms.productNameRequired","Product name is required"));return}if(!i().trim()){C(e("forms.skuRequired","SKU is required"));return}if(!u().trim()){C(e("forms.categoryRequired","Category is required"));return}if(_()<0){C(e("forms.unitCostNotNegative","Unit cost cannot be negative"));return}if(A()<0){C(e("forms.sellingPriceNotNegative","Selling price cannot be negative"));return}if(x()<0){C(e("forms.minStockNotNegative","Min stock level cannot be negative"));return}if(O()<=x()){C(e("forms.maxStockGreaterThanMin","Max stock level must be greater than min stock level"));return}const F=Be.getProductsBySku(i());if(F.length>0&&F[0].id!==t.product.id){C(e("forms.skuAlreadyExists","SKU already exists"));return}const ne={...t.product,name:r().trim(),sku:i().trim().toUpperCase(),description:a().trim(),category:u().trim(),unitOfMeasure:f(),unitCost:_(),sellingPrice:A(),minStockLevel:x(),maxStockLevel:O(),isActive:z(),lastModified:new Date().toISOString()};Be.updateProduct(t.product.id,ne),t.onProductUpdated&&t.onProductUpdated(t.product.id),t.onClose()},S=()=>{C(""),t.onClose()},w=()=>_()===0?0:((A()-_())/_()*100).toFixed(2),P={"margin-bottom":"1.5rem"},I={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},y={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},le={...y,cursor:"pointer"},B={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},k={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},W={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"},R={padding:"1rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-bottom":"1.5rem",display:"flex","justify-content":"space-between","align-items":"center"},V={display:"flex","align-items":"center",gap:"0.5rem",cursor:"pointer"};return b(yr,{get isOpen(){return t.isOpen},onClose:S,get title(){return e("products.updateProduct","Update Product")},size:"large",get children(){return b(Ge,{get when(){return t.product},get fallback(){return(()=>{var M=$h();return M.style.setProperty("text-align","center"),M.style.setProperty("padding","2rem"),M.style.setProperty("color","var(--text-muted)"),s(M,()=>e("products.noProductSelected","No product selected")),M})()},get children(){var M=NI(),F=M.firstChild,ne=F.firstChild,L=ne.firstChild,j=ne.nextSibling,Z=F.nextSibling,te=Z.firstChild,he=te.firstChild,se=he.firstChild,re=he.nextSibling,ye=te.nextSibling,G=ye.firstChild,ae=G.firstChild,Pe=G.nextSibling,we=Z.nextSibling,ue=we.firstChild,ce=ue.nextSibling,H=we.nextSibling,de=H.firstChild,X=de.nextSibling,_e=X.firstChild,Se=_e.nextSibling,Y=H.nextSibling,ie=Y.firstChild,Ie=ie.firstChild,pe=Ie.nextSibling,me=pe.firstChild,J=me.nextSibling,D=J.nextSibling,ge=D.nextSibling,ke=ge.nextSibling,Ee=ke.nextSibling,Te=Ee.nextSibling,De=Te.nextSibling,Ke=De.nextSibling,Me=ie.nextSibling,ve=Me.firstChild,Le=ve.nextSibling,Fe=Y.nextSibling,ze=Fe.firstChild,qe=ze.firstChild,Ce=qe.nextSibling,Ye=Fe.nextSibling,Qe=Ye.firstChild,Ze=Qe.firstChild,Ae=Ze.firstChild,et=Ze.nextSibling;et.firstChild;var Pt=Qe.nextSibling,rt=Pt.firstChild,vt=rt.firstChild,at=rt.nextSibling,Vt=at.firstChild,xt=Ye.nextSibling,bt=xt.firstChild,Ue=bt.firstChild,Ve=Ue.nextSibling,Je=bt.nextSibling,st=Je.firstChild,_t=st.nextSibling,nt=xt.nextSibling;return M.addEventListener("submit",v),s(ne,()=>e("inventory.productName","Product Name"),L),j.addEventListener("change",$e=>n($e.target.value)),s(he,()=>e("inventory.sku","SKU"),se),re.addEventListener("change",$e=>o($e.target.value)),s(G,()=>e("inventory.category","Category"),ae),Pe.addEventListener("change",$e=>h($e.target.value)),s(ue,()=>e("common.description","Description")),ce.addEventListener("change",$e=>c($e.target.value)),s(de,()=>e("products.status","Status")),d(X,V),_e.addEventListener("change",$e=>ee($e.target.checked)),_e.style.setProperty("cursor","pointer"),Se.style.setProperty("cursor","pointer"),s(Se,(()=>{var $e=oe(()=>!!z());return()=>$e()?(()=>{var Xe=LI();return Xe.firstChild,Xe.style.setProperty("color","#2e7d32"),s(Xe,()=>e("common.active","Active"),null),Xe})():(()=>{var Xe=MI();return Xe.firstChild,Xe.style.setProperty("color","#d32f2f"),s(Xe,()=>e("common.inactive","Inactive"),null),Xe})()})()),s(Ie,()=>e("inventory.unitOfMeasure","Unit of Measure")),pe.addEventListener("change",$e=>p($e.target.value)),s(me,()=>e("inventory.pieces","Pieces")),s(J,()=>e("inventory.kilograms","Kilograms")),s(D,()=>e("inventory.pounds","Pounds")),s(ge,()=>e("inventory.meters","Meters")),s(ke,()=>e("inventory.feet","Feet")),s(Ee,()=>e("inventory.liters","Liters")),s(Te,()=>e("inventory.gallons","Gallons")),s(De,()=>e("inventory.boxes","Boxes")),s(Ke,()=>e("inventory.packs","Packs")),s(ve,()=>e("inventory.unitCost","Unit Cost")),Le.addEventListener("change",$e=>E(Number($e.target.value))),s(qe,()=>e("inventory.sellingPrice","Selling Price")),Ce.addEventListener("change",$e=>T(Number($e.target.value))),d(Ye,R),Ze.style.setProperty("color","var(--text-muted)"),Ze.style.setProperty("font-size","0.875rem"),s(Ze,()=>e("products.profit","Profit"),Ae),et.style.setProperty("margin-left","0.5rem"),et.style.setProperty("font-weight","600"),s(et,()=>(A()-_()).toFixed(2),null),rt.style.setProperty("color","var(--text-muted)"),rt.style.setProperty("font-size","0.875rem"),s(rt,()=>e("products.profitMargin","Profit Margin"),vt),at.style.setProperty("margin-left","0.5rem"),at.style.setProperty("font-weight","600"),s(at,w,Vt),s(Ue,()=>e("inventory.minimumStockLevel","Minimum Stock Level")),Ve.addEventListener("change",$e=>$(Number($e.target.value))),s(st,()=>e("inventory.maximumStockLevel","Maximum Stock Level")),_t.addEventListener("change",$e=>q(Number($e.target.value))),s(M,(()=>{var $e=oe(()=>!!Q());return()=>$e()&&(()=>{var Xe=$h();return d(Xe,B),s(Xe,Q),Xe})()})(),nt),d(nt,k),s(nt,b(Oe,{variant:"secondary",type:"button",onClick:S,get children(){return e("common.cancel","Cancel")}}),null),s(nt,b(Oe,{variant:"primary",type:"submit",get children(){return e("common.update","Update")}}),null),K($e=>{var Xe=P,ut=I,ht=y,Yt=e("inventory.enterProductName","Enter product name"),zt=W,Dt=I,Gt=y,wt=e("inventory.enterSkuCode","Enter SKU code"),Tt=I,Zt=y,$t=e("inventory.enterCategory","Enter category"),Bt=P,dr=I,hr={...y,"min-height":"80px",resize:"vertical"},Qt=e("inventory.enterProductDescription","Enter product description"),Pr=P,Xr=I,On=W,gn=I,pn=le,Zr=I,Vr=y,Vn=W,vn=I,yt=y,Nt=W,rr=I,kr=y,Nr=I,Ut=y;return $e.e=d(F,Xe,$e.e),$e.t=d(ne,ut,$e.t),$e.a=d(j,ht,$e.a),Yt!==$e.o&&gt(j,"placeholder",$e.o=Yt),$e.i=d(Z,zt,$e.i),$e.n=d(he,Dt,$e.n),$e.s=d(re,Gt,$e.s),wt!==$e.h&&gt(re,"placeholder",$e.h=wt),$e.r=d(G,Tt,$e.r),$e.d=d(Pe,Zt,$e.d),$t!==$e.l&&gt(Pe,"placeholder",$e.l=$t),$e.u=d(we,Bt,$e.u),$e.c=d(ue,dr,$e.c),$e.w=d(ce,hr,$e.w),Qt!==$e.m&&gt(ce,"placeholder",$e.m=Qt),$e.f=d(H,Pr,$e.f),$e.y=d(de,Xr,$e.y),$e.g=d(Y,On,$e.g),$e.p=d(Ie,gn,$e.p),$e.b=d(pe,pn,$e.b),$e.T=d(ve,Zr,$e.T),$e.A=d(Le,Vr,$e.A),$e.O=d(Fe,Vn,$e.O),$e.I=d(qe,vn,$e.I),$e.S=d(Ce,yt,$e.S),$e.W=d(xt,Nt,$e.W),$e.C=d(Ue,rr,$e.C),$e.B=d(Ve,kr,$e.B),$e.v=d(st,Nr,$e.v),$e.k=d(_t,Ut,$e.k),$e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0}),K(()=>j.value=r()),K(()=>re.value=i()),K(()=>Pe.value=u()),K(()=>ce.value=a()),K(()=>_e.checked=z()),K(()=>pe.value=f()),K(()=>Le.value=_()),K(()=>Ce.value=A()),K(()=>Ve.value=x()),K(()=>_t.value=O()),M}})}})};var kh=U("<div>🔄 "),VI=U("<div><div><div><input type=text></div><select><option value>"),BI=U("<div>⚠️ "),qn=U("<div>"),FI=U("<option>"),UI=U("<div>🔍 <br><button>"),jI=U("<div><div><h3></h3><div></div></div><div></div><div>SKU: <!> • UPC: <!> • </div><div><span>: <!> </span><span></span></div><div><button></button><button>");const zI=()=>{const{t}=pt(),[e,r]=fe(""),[n,i]=fe(""),[o,a]=fe([]),[c,u]=fe(!1),[h,f]=fe(null),[p,_]=fe(!1),[E,A]=fe(!1),[T,x]=fe(!1),[$,O]=fe(null);yn(async()=>{await q()});const q=async()=>{try{u(!0),f(null);try{const L=await Fu.getAll();console.log({apiProducts:L}),a(L.map(j=>({id:j.id||`prod-${Date.now()}-${Math.random()}`,name:j.productName||j.name||"Unknown Product",sku:j.sku||j.productCode||"",description:j.description||"",category:j.category||"General",unitOfMeasure:j.unitOfMeasure||"pcs",unitCost:parseFloat(j.unitCost||j.cost||"0"),sellingPrice:parseFloat(j.sellingPrice||j.price||"0"),minStockLevel:parseInt(j.minStockLevel||"0"),maxStockLevel:parseInt(j.maxStockLevel||"100"),isActive:j.isActive!==!1,createdDate:j.createdDate||new Date().toISOString(),lastModified:j.lastModified||new Date().toISOString(),businessId:j.businessId||"YB100423253156428"})))}catch(L){console.warn("API failed, using local store:",L),a(Be.products)}}catch(L){f(L instanceof Error?L.message:"Failed to load products")}finally{u(!1)}},z=async()=>{try{u(!0),f(null);try{console.log("loadAllProducts inventoryApi");const L=await Tn.getProducts("prod");console.log({apiResults:L});const j=Object.keys(L),Z=he=>{let re=L[he];return{id:re.id,name:re.name,businessId:re.businessId,sku:re.code,numCode:re.codeN,category:re.category,unitCost:re.unitCost||0,unitOfMeasure:re.unitOfMeasure,minStockLevel:re.minStockLevel,maxStockLevel:re.maxStockLevel,isActive:re.isActive,description:re.description||"",createdDate:re.createdAt||new Date().toISOString(),lastModified:re.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(re.sellingPrice||re.price||"0")}},te=j.map(Z);a(te)}catch(L){console.warn("API failed, using local store:",L),a(Be.products)}}catch(L){f(L instanceof Error?L.message:"Failed to load products")}finally{u(!1)}},{search:ee,isSearching:Q,cancel:C}=II(async L=>{if(!L.trim()){await q();return}try{f(null);const j=await Fu.getAll(L);a(j.map(Z=>({id:Z.id||`prod-${Date.now()}-${Math.random()}`,name:Z.productName||Z.name||"Unknown Product",sku:Z.sku||Z.productCode||"",description:Z.description||"",category:Z.category||"General",unitOfMeasure:Z.unitOfMeasure||"pcs",unitCost:parseFloat(Z.unitCost||Z.cost||"0"),sellingPrice:parseFloat(Z.sellingPrice||Z.price||"0"),minStockLevel:parseInt(Z.minStockLevel||"0"),maxStockLevel:parseInt(Z.maxStockLevel||"100"),isActive:Z.isActive!==!1,createdDate:Z.createdDate||new Date().toISOString(),lastModified:Z.lastModified||new Date().toISOString(),businessId:Z.businessId||"YB100423253156428"})))}catch(j){f(j instanceof Error?j.message:"Search failed");const Z=Be.products.filter(te=>te.name.toLowerCase().includes(L.toLowerCase())||te.sku.toLowerCase().includes(L.toLowerCase())||te.category.toLowerCase().includes(L.toLowerCase()));a(Z)}},300),v=L=>{const Z=L.target.value;r(Z),ee(Z)};ao(()=>{C()});const S=it(()=>{let L=o();return n()&&(L=L.filter(j=>j.category===n())),L}),w=it(()=>[...new Set(o().map(j=>j.category))].sort()),P=it(()=>{const L=o().filter(te=>te.isActive),j=o().length,Z=o().filter(te=>Be.getTotalStockByProduct(te.id)===0);return{total:j,active:L.length,outOfStock:Z.length}}),I=L=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(L),y=L=>{const j=Be.getTotalStockByProduct(L),Z=o().find(se=>se.id===L);if(!Z)return{quantity:0,status:"unknown"};const te=j<=Z.minStockLevel;return{quantity:j,status:j===0?"out":te?"low":"good"}},le={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},B={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},k={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},W={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},R=L=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500",background:L?"#d4edda":"#f8d7da",color:L?"#155724":"#721c24"}),V={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},M={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem","flex-wrap":"wrap"},F={flex:"1","min-width":"300px",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},ne={padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)","min-width":"150px"};return b(Wr,{get title(){return t("products.title","Products")},get children(){return[(()=>{var L=VI(),j=L.firstChild,Z=j.firstChild,te=Z.firstChild,he=Z.nextSibling,se=he.firstChild;return L.style.setProperty("display","flex"),L.style.setProperty("justify-content","space-between"),L.style.setProperty("align-items","flex-start"),L.style.setProperty("margin-bottom","2rem"),L.style.setProperty("flex-wrap","wrap"),L.style.setProperty("gap","1rem"),d(j,M),Z.style.setProperty("position","relative"),Z.style.setProperty("flex","1"),Z.style.setProperty("min-width","300px"),te.$$input=v,d(te,F),s(Z,b(Ge,{get when(){return Q()},get children(){var re=kh();return re.firstChild,re.style.setProperty("position","absolute"),re.style.setProperty("right","0.75rem"),re.style.setProperty("top","50%"),re.style.setProperty("transform","translateY(-50%)"),re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),s(re,()=>t("common.searching","Searching..."),null),re}}),null),he.addEventListener("change",re=>i(re.target.value)),d(he,ne),s(se,()=>t("products.allCategories","All Categories")),s(he,b(jt,{get each(){return w()},children:re=>(()=>{var ye=FI();return ye.value=re,s(ye,re),ye})()}),null),s(j,b(Oe,{variant:"outline",onClick:()=>{r(""),i(""),console.log("loadAllProducts"),z()},get children(){return["🔄 ",oe(()=>t("common.refresh","Refresh"))]}}),null),s(L,b(Oe,{variant:"primary",onClick:()=>_(!0),get children(){return["➕ ",oe(()=>t("products.addNew","Add New Product"))]}}),null),K(()=>gt(te,"placeholder",t("products.searchPlaceholder","Search products by name, SKU, or category..."))),K(()=>te.value=e()),K(()=>he.value=n()),L})(),b(Ge,{get when(){return h()},get children(){var L=BI();return L.firstChild,L.style.setProperty("padding","1rem"),L.style.setProperty("margin-bottom","1rem"),L.style.setProperty("background","#ffebee"),L.style.setProperty("border","1px solid #ffcdd2"),L.style.setProperty("border-radius","var(--border-radius)"),L.style.setProperty("color","#d32f2f"),s(L,h,null),L}}),(()=>{var L=qn();return d(L,V),s(L,b(tt,{get title(){return t("products.totalProducts","Total Products")},get subtitle(){return t("products.inCatalog","In catalog")},get children(){var j=qn();return j.style.setProperty("font-size","1.5rem"),j.style.setProperty("font-weight","600"),j.style.setProperty("color","var(--primary-color)"),s(j,()=>P().total),j}}),null),s(L,b(tt,{get title(){return t("products.activeProducts","Active Products")},get subtitle(){return t("products.currentlyAvailable","Currently available")},get children(){var j=qn();return j.style.setProperty("font-size","1.5rem"),j.style.setProperty("font-weight","600"),j.style.setProperty("color","var(--primary-color)"),s(j,()=>P().active),j}}),null),s(L,b(tt,{get title(){return t("products.outOfStock","Out of Stock")},get subtitle(){return t("products.needsRestock","Needs restock")},get children(){var j=qn();return j.style.setProperty("font-size","1.5rem"),j.style.setProperty("font-weight","600"),s(j,()=>P().outOfStock),K(Z=>(Z=P().outOfStock>0?"#f44336":"var(--primary-color)")!=null?j.style.setProperty("color",Z):j.style.removeProperty("color")),j}}),null),s(L,b(tt,{get title(){return t("products.showing","Showing")},get subtitle(){return oe(()=>!!(e()||n()))()?t("products.filtered","Filtered results"):t("products.allProducts","All products")},get children(){var j=qn();return j.style.setProperty("font-size","1.5rem"),j.style.setProperty("font-weight","600"),j.style.setProperty("color","var(--primary-color)"),s(j,()=>S().length),j}}),null),L})(),b(tt,{get title(){return t("products.productCatalog","Product Catalog")},get subtitle(){return t("products.manageYourProducts","Manage your products and pricing")},get children(){return b(Ge,{get when(){return oe(()=>!c())()&&!Q()},get fallback(){return(()=>{var L=kh();return L.firstChild,L.style.setProperty("text-align","center"),L.style.setProperty("padding","3rem"),L.style.setProperty("color","var(--text-muted)"),s(L,()=>t("common.loading","Loading products..."),null),L})()},get children(){return b(Ge,{get when(){return S().length>0},get fallback(){return(()=>{var L=qn();return L.style.setProperty("text-align","center"),L.style.setProperty("padding","3rem"),L.style.setProperty("color","var(--text-muted)"),s(L,(()=>{var j=oe(()=>!!(e()||n()));return()=>j()?(()=>{var Z=UI(),te=Z.firstChild,he=te.nextSibling,se=he.nextSibling;return s(Z,()=>t("products.noResults","No products found matching your criteria."),he),se.$$click=()=>{r(""),i(""),q()},se.style.setProperty("margin-top","1rem"),se.style.setProperty("padding","0.5rem 1rem"),se.style.setProperty("background","none"),se.style.setProperty("border","1px solid var(--primary-color)"),se.style.setProperty("border-radius","var(--border-radius-sm)"),se.style.setProperty("color","var(--primary-color)"),se.style.setProperty("cursor","pointer"),s(se,()=>t("products.clearFilters","Clear filters")),Z})():t("products.noProducts","No products available.")})()),L})()},get children(){var L=qn();return d(L,le),s(L,b(jt,{get each(){return S()},children:j=>{const Z=y(j.id),te={good:{background:"#d4edda",color:"#155724"},low:{background:"#fff3cd",color:"#856404"},out:{background:"#f8d7da",color:"#721c24"}}[Z.status];return(()=>{var he=jI(),se=he.firstChild,re=se.firstChild,ye=re.nextSibling,G=se.nextSibling,ae=G.nextSibling,Pe=ae.firstChild,we=Pe.nextSibling,ue=we.nextSibling,ce=ue.nextSibling;ce.nextSibling;var H=ae.nextSibling,de=H.firstChild,X=de.firstChild,_e=X.nextSibling;_e.nextSibling;var Se=de.nextSibling,Y=H.nextSibling,ie=Y.firstChild,Ie=ie.nextSibling;return he.addEventListener("mouseleave",pe=>{pe.currentTarget.style.transform="translateY(0)",pe.currentTarget.style.boxShadow="none"}),he.addEventListener("mouseenter",pe=>{pe.currentTarget.style.transform="translateY(-2px)",pe.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),he.$$click=()=>{O(j),A(!0)},d(se,k),re.style.setProperty("margin","0"),re.style.setProperty("font-size","1.1rem"),s(re,()=>j.name),s(ye,(()=>{var pe=oe(()=>Z.status==="out");return()=>pe()?t("products.outOfStock","Out of Stock"):oe(()=>Z.status==="low")()?t("products.lowStock","Low Stock"):t("products.inStock","In Stock")})()),d(G,W),s(G,()=>I(j.unitCost)),ae.style.setProperty("color","var(--text-muted)"),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("margin-bottom","0.5rem"),s(ae,()=>j.sku,we),s(ae,()=>j.UPC,ce),s(ae,()=>j.category,null),H.style.setProperty("display","flex"),H.style.setProperty("justify-content","space-between"),H.style.setProperty("align-items","center"),H.style.setProperty("font-size","0.875rem"),H.style.setProperty("color","var(--text-muted)"),s(de,()=>t("products.stock","Stock"),X),s(de,()=>Z.quantity,_e),s(de,()=>j.unitOfMeasure,null),Se.style.setProperty("font-weight","600"),s(Se,()=>Z.status==="out"?"⚠️":Z.status==="low"?"⚡":"✅"),s(he,(()=>{var pe=oe(()=>!!j.description);return()=>pe()&&(()=>{var me=qn();return me.style.setProperty("margin-top","0.5rem"),me.style.setProperty("font-size","0.75rem"),me.style.setProperty("color","var(--text-muted)"),me.style.setProperty("font-style","italic"),me.style.setProperty("white-space","nowrap"),me.style.setProperty("overflow","hidden"),me.style.setProperty("text-overflow","ellipsis"),s(me,()=>j.description),me})()})(),Y),Y.style.setProperty("display","flex"),Y.style.setProperty("gap","0.5rem"),Y.style.setProperty("margin-top","1rem"),Y.style.setProperty("padding-top","1rem"),Y.style.setProperty("border-top","1px solid var(--border-color)"),ie.addEventListener("mouseleave",pe=>pe.currentTarget.style.opacity="1"),ie.addEventListener("mouseenter",pe=>pe.currentTarget.style.opacity="0.8"),ie.$$click=pe=>{pe.stopPropagation(),O(j),A(!0)},ie.style.setProperty("flex","1"),ie.style.setProperty("padding","0.5rem"),ie.style.setProperty("background","var(--primary-color)"),ie.style.setProperty("color","white"),ie.style.setProperty("border","none"),ie.style.setProperty("border-radius","var(--border-radius-sm)"),ie.style.setProperty("cursor","pointer"),ie.style.setProperty("font-size","0.875rem"),ie.style.setProperty("transition","opacity 0.2s"),s(ie,()=>t("common.view","View")),Ie.addEventListener("mouseleave",pe=>{pe.currentTarget.style.background="transparent",pe.currentTarget.style.color="var(--primary-color)"}),Ie.addEventListener("mouseenter",pe=>{pe.currentTarget.style.background="var(--primary-color)",pe.currentTarget.style.color="white"}),Ie.$$click=pe=>{pe.stopPropagation(),O(j),x(!0)},Ie.style.setProperty("flex","1"),Ie.style.setProperty("padding","0.5rem"),Ie.style.setProperty("background","transparent"),Ie.style.setProperty("color","var(--primary-color)"),Ie.style.setProperty("border","1px solid var(--primary-color)"),Ie.style.setProperty("border-radius","var(--border-radius-sm)"),Ie.style.setProperty("cursor","pointer"),Ie.style.setProperty("font-size","0.875rem"),Ie.style.setProperty("transition","all 0.2s"),s(Ie,()=>t("common.edit","Edit")),K(pe=>{var me={...B,cursor:"pointer",transition:"all 0.2s ease"},J={...R(Z.status==="good"),...te},D=Z.status==="good"?"#2e7d32":Z.status==="low"?"#f57f17":"#d32f2f";return pe.e=d(he,me,pe.e),pe.t=d(ye,J,pe.t),D!==pe.a&&((pe.a=D)!=null?Se.style.setProperty("color",D):Se.style.removeProperty("color")),pe},{e:void 0,t:void 0,a:void 0}),he})()}})),L}})}})}}),b(Wa,{get isOpen(){return p()},onClose:()=>_(!1),onProductAdded:()=>{q()}}),b(DI,{get isOpen(){return E()},onClose:()=>{A(!1),O(null)},get product(){return $()},onEdit:()=>{A(!1),x(!0)}}),b(OI,{get isOpen(){return T()},onClose:()=>{x(!1),O(null)},get product(){return $()},onProductUpdated:()=>{q()}})]}})};Ot(["input","click"]);const qI=[{id:"1",name:"John Doe",position:"Software Engineer",salary:85e3,email:"john.doe@company.com",phone:"+1 (555) 123-4567",department:"Engineering",startDate:"2023-01-15"},{id:"2",name:"Jane Smith",position:"Product Manager",salary:95e3,email:"jane.smith@company.com",phone:"+1 (555) 234-5678",department:"Product",startDate:"2022-08-20"},{id:"3",name:"Mike Brown",position:"Designer",salary:7e4,email:"mike.brown@company.com",phone:"+1 (555) 345-6789",department:"Design",startDate:"2023-03-10"},{id:"4",name:"Sarah Kim",position:"HR Manager",salary:78e3,email:"sarah.kim@company.com",phone:"+1 (555) 456-7890",department:"Human Resources",startDate:"2022-11-05"},{id:"5",name:"Alex Lee",position:"Data Analyst",salary:72e3,email:"alex.lee@company.com",phone:"+1 (555) 567-8901",department:"Analytics",startDate:"2023-02-28"},{id:"6",name:"Emma Wilson",position:"Marketing Manager",salary:82e3,email:"emma.wilson@company.com",phone:"+1 (555) 678-9012",department:"Marketing",startDate:"2022-09-15"}],[Ao,Sl]=fe(qI),Fy={get employees(){return Ao()},addEmployee(t){const e={...t,id:Date.now().toString()};return Sl([...Ao(),e]),e},updateEmployee(t,e){Sl(Ao().map(r=>r.id===t?{...r,...e}:r))},deleteEmployee(t){Sl(Ao().filter(e=>e.id!==t))},getEmployeeById(t){return Ao().find(e=>e.id===t)}};var HI=U("<form><div>");const WI=t=>{const{t:e}=pt(),[r,n]=fe({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),i=[{value:"Engineering",label:e("employees.departments.engineering","Engineering")},{value:"Product",label:e("employees.departments.product","Product")},{value:"Design",label:e("employees.departments.design","Design")},{value:"Marketing",label:e("employees.departments.marketing","Marketing")},{value:"Sales",label:e("employees.departments.sales","Sales")},{value:"Human Resources",label:e("employees.departments.humanResources","Human Resources")},{value:"Finance",label:e("employees.departments.finance","Finance")},{value:"Operations",label:e("employees.departments.operations","Operations")},{value:"Analytics",label:e("employees.departments.analytics","Analytics")}],o={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},a=u=>{u.preventDefault();const h=r();if(!h.name||!h.position||!h.salary||!h.email||!h.department||!h.startDate){alert(e("forms.requiredField"));return}const f={name:h.name,position:h.position,salary:parseFloat(h.salary),email:h.email,phone:h.phone,department:h.department,startDate:h.startDate};Fy.addEmployee(f),n({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),t.onClose()},c=(u,h)=>{n(f=>({...f,[u]:h}))};return b(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.addEmployee")},get children(){var u=HI(),h=u.firstChild;return u.addEventListener("submit",a),s(u,b(Rt,{get label(){return e("employees.fullName")},get value(){return r().name},onChange:f=>c("name",f),get placeholder(){return e("employees.enterFullName","Enter employee's full name")},required:!0}),h),s(u,b(Rt,{get label(){return e("employees.position")},get value(){return r().position},onChange:f=>c("position",f),get placeholder(){return e("employees.enterPosition","Enter job position")},required:!0}),h),s(u,b(_r,{get label(){return e("employees.department")},get value(){return r().department},onChange:f=>c("department",f),options:i,required:!0}),h),s(u,b(Rt,{get label(){return e("employees.email")},type:"email",get value(){return r().email},onChange:f=>c("email",f),get placeholder(){return e("employees.enterEmail","Enter email address")},required:!0}),h),s(u,b(Rt,{get label(){return e("employees.phone")},type:"tel",get value(){return r().phone},onChange:f=>c("phone",f),get placeholder(){return e("employees.enterPhone","Enter phone number")}}),h),s(u,b(Rt,{get label(){return e("employees.salary")},type:"number",get value(){return r().salary},onChange:f=>c("salary",f),get placeholder(){return e("employees.enterSalary","Enter annual salary")},required:!0}),h),s(u,b(Rt,{get label(){return e("employees.hireDate")},type:"date",get value(){return r().startDate},onChange:f=>c("startDate",f),required:!0}),h),d(h,o),s(h,b(Oe,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(h,b(Oe,{variant:"primary",type:"submit",get children(){return e("employees.addEmployee")}}),null),u}})};var GI=U("<div><div></div><div></div><div>"),KI=U("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),YI=U("<div>");const QI=t=>{const{t:e}=pt(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},i={"font-weight":"600",color:"var(--text-primary)"},o={width:"80px",height:"80px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.5rem",margin:"0 auto 1.5rem auto"},a={"text-align":"center","margin-bottom":"2rem"},c={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},u={color:"var(--text-muted)","font-size":"1rem"},h={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"};if(!t.employee)return null;const f=E=>E.split(" ").map(A=>A[0]).join("").toUpperCase(),p=E=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(E),_=E=>new Date(E).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return b(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.employeeDetails")},get children(){return[(()=>{var E=GI(),A=E.firstChild,T=A.nextSibling,x=T.nextSibling;return d(E,a),d(A,o),s(A,()=>f(t.employee.name)),d(T,c),s(T,()=>t.employee.name),d(x,u),s(x,()=>t.employee.position),E})(),(()=>{var E=KI(),A=E.firstChild,T=A.firstChild,x=T.nextSibling,$=A.nextSibling,O=$.firstChild,q=O.nextSibling,z=$.nextSibling,ee=z.firstChild,Q=ee.nextSibling,C=z.nextSibling,v=C.firstChild,S=v.nextSibling,w=C.nextSibling,P=w.firstChild,I=P.nextSibling,y=w.nextSibling,le=y.firstChild,B=le.nextSibling;return s(T,()=>e("employees.employeeId")),s(x,()=>t.employee.id),s(O,()=>e("employees.department")),s(q,()=>t.employee.department),s(ee,()=>e("employees.email")),s(Q,()=>t.employee.email),s(v,()=>e("employees.phone")),s(S,()=>t.employee.phone),s(P,()=>e("employees.salary")),s(I,()=>p(t.employee.salary)),s(le,()=>e("employees.hireDate")),s(B,()=>_(t.employee.startDate)),K(k=>{var W=r,R=n,V=i,M=r,F=n,ne=i,L=r,j=n,Z=i,te=r,he=n,se=i,re=r,ye=n,G=i,ae=r,Pe=n,we=i;return k.e=d(A,W,k.e),k.t=d(T,R,k.t),k.a=d(x,V,k.a),k.o=d($,M,k.o),k.i=d(O,F,k.i),k.n=d(q,ne,k.n),k.s=d(z,L,k.s),k.h=d(ee,j,k.h),k.r=d(Q,Z,k.r),k.d=d(C,te,k.d),k.l=d(v,he,k.l),k.u=d(S,se,k.u),k.c=d(w,re,k.c),k.w=d(P,ye,k.w),k.m=d(I,G,k.m),k.f=d(y,ae,k.f),k.y=d(le,Pe,k.y),k.g=d(B,we,k.g),k},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),E})(),(()=>{var E=YI();return d(E,h),s(E,b(Oe,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(E,b(Oe,{variant:"primary",onClick:()=>{console.log("Edit employee:",t.employee.id)},get children(){return e("employees.editEmployee")}}),null),E})()]}})};var Rh=U("<div>"),JI=U("<div><div></div><div><div></div><div></div><div>/year");const XI=()=>{const{t}=pt(),[e,r]=fe(!1),[n,i]=fe(!1),[o,a]=fe(null),c=T=>{a(T),i(!0)},u={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},h={display:"flex","align-items":"center",gap:"1rem"},f={width:"60px",height:"60px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.2rem"},p={flex:"1"},_={"font-weight":"600","margin-bottom":"0.25rem"},E={color:"var(--text-muted)","font-size":"0.875rem","margin-bottom":"0.5rem"},A={color:"var(--primary-color)","font-weight":"500"};return b(Wr,{get title(){return t("employees.title")},get children(){return[(()=>{var T=Rh();return T.style.setProperty("margin-bottom","2rem"),s(T,b(Oe,{variant:"primary",onClick:()=>r(!0),get children(){return t("employees.addEmployee")}})),T})(),(()=>{var T=Rh();return d(T,u),s(T,()=>Fy.employees.map(x=>{const $=q=>q.split(" ").map(z=>z[0]).join("").toUpperCase(),O=q=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(q);return b(tt,{onClick:()=>c(x),get children(){var q=JI(),z=q.firstChild,ee=z.nextSibling,Q=ee.firstChild,C=Q.nextSibling,v=C.nextSibling,S=v.firstChild;return d(q,h),d(z,f),s(z,()=>$(x.name)),d(ee,p),d(Q,_),s(Q,()=>x.name),d(C,E),s(C,()=>x.position),d(v,A),s(v,()=>O(x.salary),S),q}})})),T})(),b(WI,{get isOpen(){return e()},onClose:()=>r(!1)}),b(QI,{get isOpen(){return n()},onClose:()=>i(!1),get employee(){return o()}})]}})},ZI=[{id:"1",accountId:"1002",bankName:"First National Bank",accountNumber:"****1234",accountType:"checking",currency:"USD",currentBalance:32730.5,lastReconciledDate:"2024-01-01",lastReconciledBalance:3e4,isActive:!0},{id:"2",accountId:"1003",bankName:"First National Bank",accountNumber:"****5678",accountType:"savings",currency:"USD",currentBalance:12e3,lastReconciledDate:"2024-01-01",lastReconciledBalance:1e4,isActive:!0}],eE=[{id:"1",accountId:"1002",date:"2024-01-15",description:"Customer Payment - ABC Corp",reference:"CHK001234",debitAmount:5e3,creditAmount:0,balance:35730.5,category:"Customer Payment",isReconciled:!0,reconciledWith:"eb1",importedAt:"2024-01-16",source:"csv_import"},{id:"2",accountId:"1002",date:"2024-01-14",description:"Office Supplies - Staples",reference:"CHK001235",debitAmount:0,creditAmount:250,balance:30730.5,category:"Office Expenses",isReconciled:!0,reconciledWith:"eb2",importedAt:"2024-01-16",source:"csv_import"},{id:"3",accountId:"1002",date:"2024-01-13",description:"Monthly Rent Payment",reference:"CHK001236",debitAmount:0,creditAmount:2e3,balance:28730.5,category:"Rent",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"},{id:"4",accountId:"1002",date:"2024-01-12",description:"Wire Transfer In",reference:"WIRE001",debitAmount:1e4,creditAmount:0,balance:38730.5,category:"Wire Transfer",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"}],tE=[{id:"eb1",accountId:"1002",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",debitAmount:5e3,creditAmount:0,category:"Accounts Receivable",isReconciled:!0,reconciledWith:"1",createdAt:"2024-01-15"},{id:"eb2",accountId:"1002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",debitAmount:0,creditAmount:250,category:"Office Expenses",isReconciled:!0,reconciledWith:"2",createdAt:"2024-01-14"},{id:"eb3",accountId:"1002",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",debitAmount:0,creditAmount:3500,category:"Salary Expense",isReconciled:!1,createdAt:"2024-01-11"}],rE=[{id:"1",bankAccountId:"1",periodStart:"2024-01-01",periodEnd:"2024-01-15",startingBalance:3e4,endingBalance:35730.5,status:"in_progress",totalBankTransactions:4,totalEntryBookRecords:3,reconciledTransactions:2,unreconciledTransactions:2,discrepancyAmount:1500,createdAt:"2024-01-16",notes:"Wire transfer and rent payment need investigation"}],[Bs,Dh]=fe(ZI),[Hn,Pl]=fe(eE),[Io,Nh]=fe(tE),[Fs,Lh]=fe(rE),lr={get bankAccounts(){return Bs()},addBankAccount(t){const e={...t,id:Date.now().toString()};return Dh([...Bs(),e]),e},updateBankAccount(t,e){Dh(Bs().map(r=>r.id===t?{...r,...e}:r))},getBankAccountById(t){return Bs().find(e=>e.id===t)},get bankStatements(){return Hn()},addBankStatement(t){const e={...t,id:Date.now().toString(),importedAt:new Date().toISOString()};return Pl([...Hn(),e]),e},addBankStatementsFromCSV(t){const e=t.map(r=>({...r,id:`csv_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,importedAt:new Date().toISOString(),source:"csv_import",isReconciled:!1}));return Pl([...Hn(),...e]),e},updateBankStatement(t,e){Pl(Hn().map(r=>r.id===t?{...r,...e}:r))},getBankStatementsByAccount(t){return Hn().filter(e=>e.accountId===t)},getUnreconciledBankStatements(t){return(t?this.getBankStatementsByAccount(t):Hn()).filter(r=>!r.isReconciled)},get entryBookRecords(){return Io()},addEntryBookRecord(t){const e={...t,id:Date.now().toString(),createdAt:new Date().toISOString()};return Nh([...Io(),e]),e},updateEntryBookRecord(t,e){Nh(Io().map(r=>r.id===t?{...r,...e}:r))},getEntryBookRecordsByAccount(t){return Io().filter(e=>e.accountId===t)},getUnreconciledEntryBookRecords(t){return(t?this.getEntryBookRecordsByAccount(t):Io()).filter(r=>!r.isReconciled)},reconcileTransaction(t,e){this.updateBankStatement(t,{isReconciled:!0,reconciledWith:e}),this.updateEntryBookRecord(e,{isReconciled:!0,reconciledWith:t})},unreconciledTransaction(t){const e=Hn().find(r=>r.id===t);e?.reconciledWith&&this.updateEntryBookRecord(e.reconciledWith,{isReconciled:!1,reconciledWith:void 0}),this.updateBankStatement(t,{isReconciled:!1,reconciledWith:void 0})},findPotentialMatches(t){const e=Hn().find(n=>n.id===t);return e?this.getUnreconciledEntryBookRecords(e.accountId).filter(n=>{const i=Math.abs(e.debitAmount-n.debitAmount)<.01||Math.abs(e.creditAmount-n.creditAmount)<.01,o=new Date(e.date),a=new Date(n.date),u=Math.abs((o.getTime()-a.getTime())/(1e3*60*60*24))<=3,h=e.reference===n.reference||e.description.toLowerCase().includes(n.description.toLowerCase())||n.description.toLowerCase().includes(e.description.toLowerCase());return i&&(u||h)}).sort((n,i)=>{const o=(n.date===e.date?2:0)+(n.reference===e.reference?1:0);return(i.date===e.date?2:0)+(i.reference===e.reference?1:0)-o}):[]},get reconciliationSessions(){return Fs()},startReconciliationSession(t,e,r){const n=this.getBankStatementsByAccount(t).filter(h=>h.date>=e&&h.date<=r),i=this.getEntryBookRecordsByAccount(t).filter(h=>h.date>=e&&h.date<=r),o=n.filter(h=>h.isReconciled).length,a=this.getBankAccountById(t)?.lastReconciledBalance||0,c=this.getBankAccountById(t)?.currentBalance||0,u={id:Date.now().toString(),bankAccountId:t,periodStart:e,periodEnd:r,startingBalance:a,endingBalance:c,status:"in_progress",totalBankTransactions:n.length,totalEntryBookRecords:i.length,reconciledTransactions:o,unreconciledTransactions:n.length-o,discrepancyAmount:0,createdAt:new Date().toISOString()};return Lh([...Fs(),u]),u},updateReconciliationSession(t,e){Lh(Fs().map(r=>r.id===t?{...r,...e}:r))},getReconciliationSessionsByAccount(t){return Fs().filter(e=>e.bankAccountId===t)}};var wl=U("<div>"),nE=U("<div><strong>:</strong> <!> - "),iE=U("<div><div><div>📄</div><div></div><div></div></div><input id=csvFileInput type=file accept=.csv>"),oE=U("<div><h4></h4><div><div><label> *</label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><select><option value>"),zi=U("<option>"),sE=U("<div><table><thead><tr></tr></thead><tbody>"),aE=U("<th>"),lE=U("<tr>"),cE=U("<td>");const uE=t=>{const{t:e}=pt(),[r,n]=fe(!1),[i,o]=fe(!1),[a,c]=fe(null),[u,h]=fe([]),[f,p]=fe({date:"",description:"",reference:"",debit:"",credit:"",balance:""}),_={border:`2px dashed ${r()?"var(--primary-color)":"var(--border-color)"}`,"border-radius":"var(--border-radius)",padding:"2rem","text-align":"center","background-color":r()?"var(--background-color)":"transparent",transition:"all 0.2s ease",cursor:"pointer"},E={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem","margin-top":"1.5rem"},A={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-family":"inherit"},T={"max-height":"200px","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},x={width:"100%","border-collapse":"collapse","font-size":"0.875rem"},$={padding:"0.5rem","border-bottom":"1px solid var(--border-color)","text-align":"left"},O={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},q=I=>{I.preventDefault(),n(!0)},z=I=>{I.preventDefault(),n(!1)},ee=I=>{I.preventDefault(),n(!1);const y=I.dataTransfer?.files;y&&y.length>0&&C(y[0])},Q=I=>{const y=I.target;y.files&&y.files.length>0&&C(y.files[0])},C=I=>{if(!I.name.toLowerCase().endsWith(".csv")){c({success:!1,message:e("banking.pleaseUploadCSV")});return}o(!0);const y=new FileReader;y.onload=le=>{try{const k=(le.target?.result).split(`
`).filter(M=>M.trim());if(k.length<2){c({success:!1,message:e("banking.csvRequiresHeaderAndData")}),o(!1);return}const W=k[0].split(",").map(M=>M.trim().replace(/[\"\']/g,"")),R=k.slice(1).map(M=>{const F=M.split(",").map(L=>L.trim().replace(/[\"\']/g,"")),ne={};return W.forEach((L,j)=>{ne[L]=F[j]||""}),ne});h(R),c({success:!0,message:e("banking.successfullyParsed").replace("{count}",R.length.toString()),count:R.length});const V={...f()};W.forEach(M=>{const F=M.toLowerCase();F.includes("date")&&(V.date=M),(F.includes("description")||F.includes("memo"))&&(V.description=M),(F.includes("reference")||F.includes("check")||F.includes("ref"))&&(V.reference=M),(F.includes("debit")||F.includes("deposit"))&&(V.debit=M),(F.includes("credit")||F.includes("withdrawal")||F.includes("amount"))&&(V.debit?V.credit=M:V.debit=M),F.includes("balance")&&(V.balance=M)}),p(V)}catch{c({success:!1,message:e("banking.errorParsingCSV")})}o(!1)},y.readAsText(I)},v=(I,y)=>{p(le=>({...le,[I]:y}))},S=()=>u().length===0?[]:Object.keys(u()[0]),w=()=>{if(!t.bankAccount||u().length===0)return;const I=f();if(!I.date||!I.description){c({success:!1,message:e("banking.dateDescriptionRequired")});return}o(!0);try{const y=u().map(B=>{const k=M=>M&&parseFloat(M.replace(/[^0-9.-]/g,""))||0,W=M=>{const F=new Date(M);if(isNaN(F.getTime())){const ne=M.split("/");if(ne.length===3)return new Date(parseInt(ne[2]),parseInt(ne[0])-1,parseInt(ne[1])).toISOString().split("T")[0]}return F.toISOString().split("T")[0]};let R=0,V=0;if(I.debit&&I.credit)R=k(B[I.debit]),V=k(B[I.credit]);else if(I.debit){const M=k(B[I.debit]);M>0?R=M:V=Math.abs(M)}return{accountId:t.bankAccount.accountId,date:W(B[I.date]),description:B[I.description]||e("banking.importedTransaction"),reference:B[I.reference]||"",debitAmount:R,creditAmount:V,balance:I.balance?k(B[I.balance]):0,isReconciled:!1}}),le=lr.addBankStatementsFromCSV(y);c({success:!0,message:e("banking.successfullyImported").replace("{count}",le.length.toString()),count:le.length}),h([]),p({date:"",description:"",reference:"",debit:"",credit:"",balance:""})}catch{c({success:!1,message:e("banking.errorImportingTransactions")})}o(!1)},P=()=>{h([]),c(null),p({date:"",description:"",reference:"",debit:"",credit:"",balance:""})};return b(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("banking.importBankStatementCSV")},get children(){return[oe(()=>oe(()=>!!t.bankAccount)()&&(()=>{var I=nE(),y=I.firstChild,le=y.firstChild,B=y.nextSibling,k=B.nextSibling;return k.nextSibling,I.style.setProperty("margin-bottom","1.5rem"),I.style.setProperty("padding","1rem"),I.style.setProperty("background","var(--background-color)"),I.style.setProperty("border-radius","var(--border-radius-sm)"),I.style.setProperty("border","1px solid var(--border-color)"),s(y,()=>e("banking.bankAccount"),le),s(I,()=>t.bankAccount.bankName,k),s(I,()=>t.bankAccount.accountNumber,null),I})()),oe(()=>oe(()=>u().length===0)()?(()=>{var I=iE(),y=I.firstChild,le=y.firstChild,B=le.nextSibling,k=B.nextSibling,W=y.nextSibling;return y.$$click=()=>document.getElementById("csvFileInput")?.click(),y.addEventListener("drop",ee),y.addEventListener("dragleave",z),y.addEventListener("dragover",q),le.style.setProperty("font-size","2rem"),le.style.setProperty("margin-bottom","1rem"),B.style.setProperty("font-weight","500"),B.style.setProperty("margin-bottom","0.5rem"),s(B,(()=>{var R=oe(()=>!!r());return()=>R()?e("banking.dropCSVHere"):e("banking.clickToUploadCSV")})()),k.style.setProperty("font-size","0.875rem"),k.style.setProperty("color","var(--text-muted)"),s(k,()=>e("banking.supportedFormat")),W.addEventListener("change",Q),W.style.setProperty("display","none"),K(R=>d(y,_,R)),I})():(()=>{var I=oE(),y=I.firstChild,le=y.nextSibling,B=le.firstChild,k=B.firstChild,W=k.firstChild,R=k.nextSibling,V=R.firstChild,M=B.nextSibling,F=M.firstChild,ne=F.firstChild,L=F.nextSibling,j=L.firstChild,Z=M.nextSibling,te=Z.firstChild,he=te.nextSibling,se=he.firstChild,re=Z.nextSibling,ye=re.firstChild,G=ye.firstChild,ae=ye.nextSibling,Pe=ae.firstChild,we=re.nextSibling,ue=we.firstChild,ce=ue.nextSibling,H=ce.firstChild,de=we.nextSibling,X=de.firstChild,_e=X.nextSibling,Se=_e.firstChild;return y.style.setProperty("margin","0 0 1rem 0"),s(y,()=>e("banking.mapCSVColumns")),d(le,E),k.style.setProperty("display","block"),k.style.setProperty("margin-bottom","0.5rem"),k.style.setProperty("font-weight","500"),s(k,()=>e("banking.dateColumn"),W),R.addEventListener("change",Y=>v("date",Y.target.value)),s(V,()=>e("banking.selectColumn")),s(R,()=>S().map(Y=>(()=>{var ie=zi();return ie.value=Y,s(ie,Y),ie})()),null),F.style.setProperty("display","block"),F.style.setProperty("margin-bottom","0.5rem"),F.style.setProperty("font-weight","500"),s(F,()=>e("banking.descriptionColumn"),ne),L.addEventListener("change",Y=>v("description",Y.target.value)),s(j,()=>e("banking.selectColumn")),s(L,()=>S().map(Y=>(()=>{var ie=zi();return ie.value=Y,s(ie,Y),ie})()),null),te.style.setProperty("display","block"),te.style.setProperty("margin-bottom","0.5rem"),te.style.setProperty("font-weight","500"),s(te,()=>e("banking.referenceColumn")),he.addEventListener("change",Y=>v("reference",Y.target.value)),s(se,()=>e("banking.selectColumn")),s(he,()=>S().map(Y=>(()=>{var ie=zi();return ie.value=Y,s(ie,Y),ie})()),null),ye.style.setProperty("display","block"),ye.style.setProperty("margin-bottom","0.5rem"),ye.style.setProperty("font-weight","500"),s(ye,()=>e("banking.amountDebitColumn"),G),ae.addEventListener("change",Y=>v("debit",Y.target.value)),s(Pe,()=>e("banking.selectColumn")),s(ae,()=>S().map(Y=>(()=>{var ie=zi();return ie.value=Y,s(ie,Y),ie})()),null),ue.style.setProperty("display","block"),ue.style.setProperty("margin-bottom","0.5rem"),ue.style.setProperty("font-weight","500"),s(ue,()=>e("banking.creditColumn")),ce.addEventListener("change",Y=>v("credit",Y.target.value)),s(H,()=>e("banking.selectColumn")),s(ce,()=>S().map(Y=>(()=>{var ie=zi();return ie.value=Y,s(ie,Y),ie})()),null),X.style.setProperty("display","block"),X.style.setProperty("margin-bottom","0.5rem"),X.style.setProperty("font-weight","500"),s(X,()=>e("banking.balanceColumn")),_e.addEventListener("change",Y=>v("balance",Y.target.value)),s(Se,()=>e("banking.selectColumn")),s(_e,()=>S().map(Y=>(()=>{var ie=zi();return ie.value=Y,s(ie,Y),ie})()),null),s(I,(()=>{var Y=oe(()=>u().length>0);return()=>Y()&&(()=>{var ie=sE(),Ie=ie.firstChild,pe=Ie.firstChild,me=pe.firstChild,J=pe.nextSibling;return d(ie,T),me.style.setProperty("background-color","var(--background-color)"),s(me,()=>S().slice(0,6).map(D=>(()=>{var ge=aE();return s(ge,D),K(ke=>d(ge,$,ke)),ge})())),s(J,()=>u().slice(0,3).map(D=>(()=>{var ge=lE();return s(ge,()=>S().slice(0,6).map(ke=>(()=>{var Ee=cE();return s(Ee,()=>D[ke]),K(Te=>d(Ee,$,Te)),Ee})())),ge})())),s(ie,(()=>{var D=oe(()=>u().length>3);return()=>D()&&(()=>{var ge=wl();return ge.style.setProperty("padding","0.5rem"),ge.style.setProperty("text-align","center"),ge.style.setProperty("color","var(--text-muted)"),s(ge,()=>e("banking.andMoreRows").replace("{count}",(u().length-3).toString())),ge})()})(),null),K(D=>d(Ie,x,D)),ie})()})(),null),K(Y=>{var ie=A,Ie=A,pe=A,me=A,J=A,D=A;return Y.e=d(R,ie,Y.e),Y.t=d(L,Ie,Y.t),Y.a=d(he,pe,Y.a),Y.o=d(ae,me,Y.o),Y.i=d(ce,J,Y.i),Y.n=d(_e,D,Y.n),Y},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),K(()=>R.value=f().date),K(()=>L.value=f().description),K(()=>he.value=f().reference),K(()=>ae.value=f().debit),K(()=>ce.value=f().credit),K(()=>_e.value=f().balance),I})()),oe(()=>oe(()=>!!a())()&&(()=>{var I=wl();return I.style.setProperty("padding","1rem"),I.style.setProperty("border-radius","var(--border-radius-sm)"),I.style.setProperty("margin-top","1rem"),s(I,()=>a().message),K(y=>{var le=a().success?"#d4edda":"#f8d7da",B=a().success?"#155724":"#721c24",k=`1px solid ${a().success?"#c3e6cb":"#f5c6cb"}`;return le!==y.e&&((y.e=le)!=null?I.style.setProperty("background",le):I.style.removeProperty("background")),B!==y.t&&((y.t=B)!=null?I.style.setProperty("color",B):I.style.removeProperty("color")),k!==y.a&&((y.a=k)!=null?I.style.setProperty("border",k):I.style.removeProperty("border")),y},{e:void 0,t:void 0,a:void 0}),I})()),(()=>{var I=wl();return d(I,O),s(I,b(Oe,{variant:"secondary",onClick:()=>{P(),t.onClose()},get children(){return e("common.cancel")}}),null),s(I,(()=>{var y=oe(()=>u().length>0);return()=>y()&&b(Oe,{variant:"outline",onClick:P,get children(){return e("common.reset")}})})(),null),s(I,(()=>{var y=oe(()=>u().length>0);return()=>y()&&b(Oe,{variant:"primary",onClick:w,get disabled(){return i()||!f().date||!f().description},get children(){return oe(()=>!!i())()?e("banking.importing"):e("banking.importTransactions").replace("{count}",u().length.toString())}})})(),null),I})()]}})};Ot(["click"]);var Mh=U("<span>"),Us=U("<div>"),Oh=U("<div> "),dE=U("<div><div><h3></h3><div><button></button><button></button><button></button></div></div><div></div><div><div><h4></h4><div></div></div><div><h4></h4><div>"),hE=U("<div><div><div></div><div> • </div></div><div><div>"),Cl=U("<span>✓ "),mE=U("<span>(<!>)"),fE=U("<div><strong>:</strong> "),Vh=U("<div><div><div></div><div> • </div></div><div>"),yE=U("<div><div>:</div><div></div><div>");const gE=t=>{const{t:e}=pt(),[r,n]=fe([]),[i,o]=fe([]),[a,c]=fe(null),[u,h]=fe([]),[f,p]=fe("unreconciled");Ln(()=>{const k=lr.getBankAccountById(t.bankAccountId);if(k){const W=lr.getBankStatementsByAccount(k.accountId).filter(V=>V.date>=t.selectedPeriod.start&&V.date<=t.selectedPeriod.end),R=lr.getEntryBookRecordsByAccount(k.accountId).filter(V=>V.date>=t.selectedPeriod.start&&V.date<=t.selectedPeriod.end);n(W),o(R)}});const _=()=>{const k=r();switch(f()){case"reconciled":return k.filter(W=>W.isReconciled);case"unreconciled":return k.filter(W=>!W.isReconciled);default:return k}},E=()=>{const k=i();switch(f()){case"reconciled":return k.filter(W=>W.isReconciled);case"unreconciled":return k.filter(W=>!W.isReconciled);default:return k}},A=k=>{if(c(k),k.isReconciled)h([]);else{const W=lr.findPotentialMatches(k.id);h(W)}},T=k=>{const W=a();if(W){lr.reconcileTransaction(W.id,k.id);const R=lr.getBankAccountById(t.bankAccountId);if(R){const V=lr.getBankStatementsByAccount(R.accountId).filter(F=>F.date>=t.selectedPeriod.start&&F.date<=t.selectedPeriod.end),M=lr.getEntryBookRecordsByAccount(R.accountId).filter(F=>F.date>=t.selectedPeriod.start&&F.date<=t.selectedPeriod.end);n(V),o(M)}c(null),h([])}},x=k=>{lr.unreconciledTransaction(k.id);const W=lr.getBankAccountById(t.bankAccountId);if(W){const R=lr.getBankStatementsByAccount(W.accountId).filter(M=>M.date>=t.selectedPeriod.start&&M.date<=t.selectedPeriod.end),V=lr.getEntryBookRecordsByAccount(W.accountId).filter(M=>M.date>=t.selectedPeriod.start&&M.date<=t.selectedPeriod.end);n(R),o(V)}},$={display:"grid","grid-template-columns":"1fr 1fr",gap:"2rem","margin-top":"2rem"},O={height:"600px","overflow-y":"auto"},q={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},z=k=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:k?"var(--primary-color)":"var(--surface-color)",color:k?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),ee=(k,W)=>({display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem","margin-bottom":"0.5rem",background:k?"var(--primary-color)":W?"#e8f5e8":"var(--surface-color)",color:k?"white":"var(--text-primary)","border-radius":"var(--border-radius-sm)",border:`1px solid ${k?"var(--primary-color)":W?"#c3e6cb":"var(--border-color)"}`,cursor:"pointer",transition:"all 0.2s ease"}),Q={flex:"1"},C={"font-weight":"500","margin-bottom":"0.25rem"},v={"font-size":"0.875rem",opacity:"0.8"},S=k=>({"font-weight":"600",color:k?"#4caf50":"#f44336"}),w={padding:"0.25rem 0.5rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","margin-left":"0.5rem"},P=k=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(k),I=k=>new Date(k).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),y=k=>{if(!a())return null;const W=a();return(Math.abs(W.debitAmount-k.debitAmount)<.01||Math.abs(W.creditAmount-k.creditAmount)<.01)&&W.date===k.date?(()=>{var M=Mh();return s(M,()=>e("banking.exactMatch")),K(F=>d(M,{...w,background:"#d4edda",color:"#155724"},F)),M})():u().includes(k)?(()=>{var M=Mh();return s(M,()=>e("banking.possibleMatch")),K(F=>d(M,{...w,background:"#fff3cd",color:"#856404"},F)),M})():null},B=(()=>{const k=r(),W=i(),R=k.filter(M=>M.isReconciled).length,V=W.filter(M=>M.isReconciled).length;return{totalStatements:k.length,totalRecords:W.length,reconciledStatements:R,reconciledRecords:V,unreconciledStatements:k.length-R,unreconciledRecords:W.length-V}})();return(()=>{var k=dE(),W=k.firstChild,R=W.firstChild,V=R.nextSibling,M=V.firstChild,F=M.nextSibling,ne=F.nextSibling,L=W.nextSibling,j=L.nextSibling,Z=j.firstChild,te=Z.firstChild,he=te.nextSibling,se=Z.nextSibling,re=se.firstChild,ye=re.nextSibling;return d(W,q),R.style.setProperty("margin","0"),R.style.setProperty("font-size","1.25rem"),s(R,()=>e("banking.reconciliationComparison")),V.style.setProperty("display","flex"),V.style.setProperty("gap","0.5rem"),M.$$click=()=>p("all"),s(M,()=>e("common.all")),F.$$click=()=>p("unreconciled"),s(F,()=>e("banking.unreconciled")),ne.$$click=()=>p("reconciled"),s(ne,()=>e("banking.reconciled")),L.style.setProperty("display","grid"),L.style.setProperty("grid-template-columns","repeat(4, 1fr)"),L.style.setProperty("gap","1rem"),L.style.setProperty("margin-bottom","2rem"),s(L,b(tt,{get title(){return e("banking.bankStatements")},get subtitle(){return e("banking.totalTransactions")},get children(){return[(()=>{var G=Us();return G.style.setProperty("font-size","1.5rem"),G.style.setProperty("font-weight","600"),G.style.setProperty("color","var(--primary-color)"),s(G,()=>B.totalStatements),G})(),(()=>{var G=Oh(),ae=G.firstChild;return G.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","var(--text-muted)"),s(G,()=>B.reconciledStatements,ae),s(G,()=>e("banking.reconciled"),null),G})()]}}),null),s(L,b(tt,{get title(){return e("banking.entryBookRecords")},get subtitle(){return e("banking.totalEntries")},get children(){return[(()=>{var G=Us();return G.style.setProperty("font-size","1.5rem"),G.style.setProperty("font-weight","600"),G.style.setProperty("color","var(--primary-color)"),s(G,()=>B.totalRecords),G})(),(()=>{var G=Oh(),ae=G.firstChild;return G.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","var(--text-muted)"),s(G,()=>B.reconciledRecords,ae),s(G,()=>e("banking.reconciled"),null),G})()]}}),null),s(L,b(tt,{get title(){return e("banking.unreconciledBank")},get subtitle(){return e("banking.needAttention")},get children(){var G=Us();return G.style.setProperty("font-size","1.5rem"),G.style.setProperty("font-weight","600"),G.style.setProperty("color","#f44336"),s(G,()=>B.unreconciledStatements),G}}),null),s(L,b(tt,{get title(){return e("banking.unreconciledBooks")},get subtitle(){return e("banking.needAttention")},get children(){var G=Us();return G.style.setProperty("font-size","1.5rem"),G.style.setProperty("font-weight","600"),G.style.setProperty("color","#f44336"),s(G,()=>B.unreconciledRecords),G}}),null),d(j,$),te.style.setProperty("margin","0 0 1rem 0"),s(te,()=>e("banking.bankStatements")),s(he,()=>_().map(G=>(()=>{var ae=hE(),Pe=ae.firstChild,we=Pe.firstChild,ue=we.nextSibling,ce=ue.firstChild,H=Pe.nextSibling,de=H.firstChild;return ae.$$click=()=>A(G),s(we,()=>G.description),s(ue,()=>I(G.date),ce),s(ue,()=>G.reference,null),s(ue,(()=>{var X=oe(()=>!!G.isReconciled);return()=>X()&&(()=>{var _e=Cl();return _e.firstChild,_e.style.setProperty("color","#4caf50"),_e.style.setProperty("margin-left","0.5rem"),s(_e,()=>e("banking.reconciled"),null),_e})()})(),null),s(de,()=>G.debitAmount>0?"+":"-",null),s(de,()=>P(G.debitAmount||G.creditAmount),null),s(H,(()=>{var X=oe(()=>!!G.isReconciled);return()=>X()&&b(Oe,{variant:"outline",size:"sm",onClick:_e=>{_e.stopPropagation(),x(G)},style:{"margin-top":"0.5rem"},get children(){return e("banking.unreconcile")}})})(),null),K(X=>{var _e=ee(a()?.id===G.id,G.isReconciled),Se=Q,Y=C,ie=v,Ie=S(G.debitAmount>0);return X.e=d(ae,_e,X.e),X.t=d(Pe,Se,X.t),X.a=d(we,Y,X.a),X.o=d(ue,ie,X.o),X.i=d(de,Ie,X.i),X},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ae})())),re.style.setProperty("margin","0 0 1rem 0"),s(re,()=>e("banking.entryBookRecords"),null),s(re,(()=>{var G=oe(()=>!!(a()&&!a().isReconciled));return()=>G()&&(()=>{var ae=mE(),Pe=ae.firstChild,we=Pe.nextSibling;return we.nextSibling,ae.style.setProperty("font-weight","400"),ae.style.setProperty("color","var(--text-muted)"),ae.style.setProperty("margin-left","0.5rem"),s(ae,()=>e("banking.clickToReconcile"),we),ae})()})(),null),s(ye,(()=>{var G=oe(()=>!!(a()&&!a().isReconciled));return()=>G()?[oe(()=>oe(()=>u().length>0)()&&(()=>{var ae=fE(),Pe=ae.firstChild,we=Pe.firstChild;return Pe.nextSibling,ae.style.setProperty("margin-bottom","1rem"),ae.style.setProperty("padding","0.75rem"),ae.style.setProperty("background","#fff3cd"),ae.style.setProperty("border-radius","var(--border-radius-sm)"),s(Pe,()=>e("banking.potentialMatchesFound"),we),s(ae,()=>e("banking.clickRecordToReconcile"),null),ae})()),oe(()=>E().map(ae=>(u().includes(ae),(()=>{var Pe=Vh(),we=Pe.firstChild,ue=we.firstChild,ce=ue.nextSibling,H=ce.firstChild,de=we.nextSibling;return Pe.$$click=()=>{ae.isReconciled||T(ae)},s(ue,()=>ae.description,null),s(ue,()=>y(ae),null),s(ce,()=>I(ae.date),H),s(ce,()=>ae.reference,null),s(ce,(()=>{var X=oe(()=>!!ae.isReconciled);return()=>X()&&(()=>{var _e=Cl();return _e.firstChild,_e.style.setProperty("color","#4caf50"),_e.style.setProperty("margin-left","0.5rem"),s(_e,()=>e("banking.reconciled"),null),_e})()})(),null),s(de,()=>ae.debitAmount>0?"+":"-",null),s(de,()=>P(ae.debitAmount||ae.creditAmount),null),K(X=>{var _e={...ee(!1,ae.isReconciled),opacity:ae.isReconciled?.6:1,cursor:ae.isReconciled?"not-allowed":"pointer"},Se=Q,Y=C,ie=v,Ie=S(ae.debitAmount>0);return X.e=d(Pe,_e,X.e),X.t=d(we,Se,X.t),X.a=d(ue,Y,X.a),X.o=d(ce,ie,X.o),X.i=d(de,Ie,X.i),X},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Pe})())))]:E().map(ae=>(()=>{var Pe=Vh(),we=Pe.firstChild,ue=we.firstChild,ce=ue.nextSibling,H=ce.firstChild,de=we.nextSibling;return s(ue,()=>ae.description),s(ce,()=>I(ae.date),H),s(ce,()=>ae.reference,null),s(ce,(()=>{var X=oe(()=>!!ae.isReconciled);return()=>X()&&(()=>{var _e=Cl();return _e.firstChild,_e.style.setProperty("color","#4caf50"),_e.style.setProperty("margin-left","0.5rem"),s(_e,()=>e("banking.reconciled"),null),_e})()})(),null),s(de,()=>ae.debitAmount>0?"+":"-",null),s(de,()=>P(ae.debitAmount||ae.creditAmount),null),K(X=>{var _e=ee(!1,ae.isReconciled),Se=Q,Y=C,ie=v,Ie=S(ae.debitAmount>0);return X.e=d(Pe,_e,X.e),X.t=d(we,Se,X.t),X.a=d(ue,Y,X.a),X.o=d(ce,ie,X.o),X.i=d(de,Ie,X.i),X},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Pe})())})()),s(k,(()=>{var G=oe(()=>!!(a()&&!a().isReconciled));return()=>G()&&(()=>{var ae=yE(),Pe=ae.firstChild,we=Pe.firstChild,ue=Pe.nextSibling,ce=ue.nextSibling;return ae.style.setProperty("position","fixed"),ae.style.setProperty("bottom","2rem"),ae.style.setProperty("right","2rem"),ae.style.setProperty("background","var(--surface-color)"),ae.style.setProperty("padding","1rem"),ae.style.setProperty("border-radius","var(--border-radius)"),ae.style.setProperty("box-shadow","var(--shadow-lg)"),ae.style.setProperty("border","1px solid var(--border-color)"),ae.style.setProperty("max-width","300px"),Pe.style.setProperty("font-weight","500"),Pe.style.setProperty("margin-bottom","0.5rem"),s(Pe,()=>e("banking.selected"),we),ue.style.setProperty("font-size","0.875rem"),ue.style.setProperty("margin-bottom","0.5rem"),s(ue,()=>a().description),ce.style.setProperty("font-weight","600"),ce.style.setProperty("color","var(--primary-color)"),s(ce,()=>P(a().debitAmount||a().creditAmount)),s(ae,b(Oe,{variant:"secondary",size:"sm",onClick:()=>{c(null),h([])},style:{"margin-top":"0.5rem"},get children(){return e("banking.clearSelection")}}),null),ae})()})(),null),K(G=>{var ae=z(f()==="all"),Pe=z(f()==="unreconciled"),we=z(f()==="reconciled"),ue=O,ce=O;return G.e=d(M,ae,G.e),G.t=d(F,Pe,G.t),G.a=d(ne,we,G.a),G.o=d(he,ue,G.o),G.i=d(ye,ce,G.i),G},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),k})()};Ot(["click"]);var pE=U("<div><div><h2></h2><p></p></div><div>"),vE=U("<div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date>"),bE=U("<div><button></button><button>"),_E=U("<div><br>"),Eo=U("<div>"),SE=U("<div><div></div><div> • </div><div>"),PE=U("<div>: "),wE=U("<div> <!> • <!> "),CE=U("<div>%"),AE=U("<div> of <!> transactions");const IE=()=>{const{t}=pt(),[e,r]=fe(null),[n,i]=fe({start:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[o,a]=fe(!1),[c,u]=fe("overview");Ln(()=>{!e()&&lr.bankAccounts.length>0&&r(lr.bankAccounts[0])});const h={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},f={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},p={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},_=q=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:q?"var(--primary-color)":"var(--text-muted)","border-bottom":q?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),E={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},A=q=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(q),T=q=>new Date(q).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),x=()=>lr.bankAccounts.map(q=>({value:q.id,label:`${q.bankName} - ${q.accountNumber} (${q.accountType})`})),O=(()=>{if(!e())return null;const q=lr.getBankStatementsByAccount(e().accountId).filter(Q=>Q.date>=n().start&&Q.date<=n().end),z=lr.getEntryBookRecordsByAccount(e().accountId).filter(Q=>Q.date>=n().start&&Q.date<=n().end),ee=q.filter(Q=>Q.isReconciled).length;return z.filter(Q=>Q.isReconciled).length,{totalBankTransactions:q.length,totalEntryBookRecords:z.length,reconciledTransactions:ee,unreconciledTransactions:q.length-ee,reconciliationRate:q.length>0?ee/q.length*100:0}})();return b(Wr,{get title(){return t("banking.title")},get children(){return[(()=>{var q=pE(),z=q.firstChild,ee=z.firstChild,Q=ee.nextSibling,C=z.nextSibling;return d(q,h),ee.style.setProperty("margin","0 0 0.5rem 0"),ee.style.setProperty("font-size","1.5rem"),s(ee,()=>t("banking.reconciliation")),Q.style.setProperty("margin","0"),Q.style.setProperty("color","var(--text-muted)"),s(Q,()=>t("banking.compareStatements")),C.style.setProperty("display","flex"),C.style.setProperty("gap","1rem"),s(C,b(Oe,{variant:"secondary",onClick:()=>a(!0),get disabled(){return!e()},get children(){return t("banking.importCSV")}}),null),s(C,b(Oe,{variant:"primary",get children(){return t("banking.startNewReconciliation")}}),null),q})(),(()=>{var q=vE(),z=q.firstChild,ee=z.firstChild,Q=z.nextSibling,C=Q.firstChild,v=C.nextSibling,S=Q.nextSibling,w=S.firstChild,P=w.nextSibling;return d(q,f),z.style.setProperty("flex","1"),ee.style.setProperty("display","block"),ee.style.setProperty("margin-bottom","0.5rem"),ee.style.setProperty("font-weight","500"),s(ee,()=>t("banking.bankAccount")),s(z,b(_r,{label:"",get value(){return e()?.id||""},onChange:I=>{const y=lr.getBankAccountById(I);r(y||null)},get options(){return x()}}),null),C.style.setProperty("display","block"),C.style.setProperty("margin-bottom","0.5rem"),C.style.setProperty("font-weight","500"),s(C,()=>t("entryBooks.startDate")),v.addEventListener("change",I=>i(y=>({...y,start:I.target.value}))),v.style.setProperty("padding","0.75rem"),v.style.setProperty("border","1px solid var(--border-color)"),v.style.setProperty("border-radius","var(--border-radius-sm)"),v.style.setProperty("font-family","inherit"),w.style.setProperty("display","block"),w.style.setProperty("margin-bottom","0.5rem"),w.style.setProperty("font-weight","500"),s(w,()=>t("entryBooks.endDate")),P.addEventListener("change",I=>i(y=>({...y,end:I.target.value}))),P.style.setProperty("padding","0.75rem"),P.style.setProperty("border","1px solid var(--border-color)"),P.style.setProperty("border-radius","var(--border-radius-sm)"),P.style.setProperty("font-family","inherit"),K(()=>v.value=n().start),K(()=>P.value=n().end),q})(),(()=>{var q=bE(),z=q.firstChild,ee=z.nextSibling;return d(q,p),z.$$click=()=>u("overview"),s(z,()=>t("common.overview")),ee.$$click=()=>u("reconciliation"),s(ee,()=>t("banking.reconciliation")),K(Q=>{var C=_(c()==="overview"),v=_(c()==="reconciliation");return Q.e=d(z,C,Q.e),Q.t=d(ee,v,Q.t),Q},{e:void 0,t:void 0}),q})(),oe(()=>oe(()=>c()==="overview")()&&(()=>{var q=Eo();return s(q,(()=>{var z=oe(()=>!!e());return()=>z()&&(()=>{var ee=Eo();return d(ee,E),s(ee,b(tt,{get title(){return t("banking.bankAccountInfo")},get subtitle(){return t("banking.currentAccountDetails")},get children(){return[(()=>{var Q=SE(),C=Q.firstChild,v=C.nextSibling,S=v.firstChild,w=v.nextSibling;return Q.style.setProperty("margin-bottom","1rem"),C.style.setProperty("font-weight","600"),C.style.setProperty("margin-bottom","0.5rem"),s(C,()=>e().bankName),v.style.setProperty("color","var(--text-muted)"),v.style.setProperty("margin-bottom","0.5rem"),s(v,()=>e().accountNumber,S),s(v,()=>e().accountType,null),w.style.setProperty("font-size","1.25rem"),w.style.setProperty("font-weight","600"),w.style.setProperty("color","var(--primary-color)"),s(w,()=>A(e().currentBalance)),Q})(),oe(()=>oe(()=>!!e().lastReconciledDate)()&&(()=>{var Q=PE(),C=Q.firstChild;return Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),s(Q,()=>t("banking.lastReconciled"),C),s(Q,()=>T(e().lastReconciledDate),null),Q})())]}}),null),s(ee,O&&[b(tt,{get title(){return t("banking.bankTransactions")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var Q=Eo();return Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","600"),Q.style.setProperty("color","var(--primary-color)"),Q.style.setProperty("margin-bottom","0.5rem"),s(Q,()=>O.totalBankTransactions),Q})(),(()=>{var Q=wE(),C=Q.firstChild,v=C.nextSibling,S=v.nextSibling,w=S.nextSibling;return w.nextSibling,Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),s(Q,()=>O.reconciledTransactions,C),s(Q,()=>t("banking.reconciled"),v),s(Q,()=>O.unreconciledTransactions,w),s(Q,()=>t("banking.pending"),null),Q})()]}}),b(tt,{get title(){return t("entryBooks.entryBookRecords")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var Q=Eo();return Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","600"),Q.style.setProperty("color","var(--primary-color)"),Q.style.setProperty("margin-bottom","0.5rem"),s(Q,()=>O.totalEntryBookRecords),Q})(),(()=>{var Q=Eo();return Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),s(Q,()=>t("banking.bookEntriesForComparison")),Q})()]}}),b(tt,{get title(){return t("banking.reconciliationRate")},get subtitle(){return t("banking.completionStatus")},get children(){return[(()=>{var Q=CE(),C=Q.firstChild;return Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","600"),Q.style.setProperty("margin-bottom","0.5rem"),s(Q,()=>Math.round(O.reconciliationRate),C),K(v=>(v=O.reconciliationRate>80?"#4caf50":O.reconciliationRate>50?"#ff9800":"#f44336")!=null?Q.style.setProperty("color",v):Q.style.removeProperty("color")),Q})(),(()=>{var Q=AE(),C=Q.firstChild,v=C.nextSibling;return v.nextSibling,Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),s(Q,()=>O.reconciledTransactions,C),s(Q,()=>O.totalBankTransactions,v),Q})()]}})],null),ee})()})(),null),s(q,b(tt,{get title(){return t("banking.recentReconciliationSessions")},get subtitle(){return t("banking.latestActivity")},get children(){var z=_E(),ee=z.firstChild;return z.style.setProperty("text-align","center"),z.style.setProperty("color","var(--text-muted)"),z.style.setProperty("padding","2rem"),s(z,()=>t("banking.noRecentSessions"),ee),s(z,b(Oe,{variant:"primary",style:{"margin-top":"1rem"},onClick:()=>u("reconciliation"),get children(){return t("banking.startFirstReconciliation")}}),null),z}}),null),q})()),oe(()=>oe(()=>!!(c()==="reconciliation"&&e()))()&&b(gE,{get bankAccountId(){return e().id},get selectedPeriod(){return n()}})),b(uE,{get isOpen(){return o()},onClose:()=>a(!1),get bankAccount(){return e()}})]}})};Ot(["click"]);var EE=U("<div><div></div><div>"),Al=U("<div>"),xE=U("<div> • <!> • <!> "),TE=U("<div><div><div></div><div></div></div><div><div></div><div>"),$E=U("<div><div>:"),kE=U("<div>⚠️ <!>: <!> <!>, <!> "),RE=U("<div><div><div></div><div></div></div><div>"),Bh=U("<div> "),DE=U("<div>✓ ");const NE=t=>{const{t:e}=pt(),r={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},n={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},i={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},o={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)","margin-bottom":"0.5rem"},a={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"1rem"},c={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},u={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},h={"max-height":"100px","overflow-y":"auto","border-top":"1px solid var(--border-color)","padding-top":"1rem"},f={display:"flex","justify-content":"space-between","align-items":"center","font-size":"0.875rem","margin-bottom":"0.5rem"},p={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},_=$=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[$],E=$=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format($),A=$=>new Date($).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),T=_(t.entry.status),x=Math.abs(t.entry.totalDebit-t.entry.totalCredit)<.01;return b(tt,{get children(){return[(()=>{var $=EE(),O=$.firstChild,q=O.nextSibling;return d($,r),d(O,n),s(O,()=>t.entry.entryNumber),s(q,()=>t.entry.status),K(z=>d(q,{...i,background:T.bg,color:T.color},z)),$})(),(()=>{var $=Al();return d($,o),s($,()=>t.entry.description),$})(),(()=>{var $=xE(),O=$.firstChild,q=O.nextSibling,z=q.nextSibling,ee=z.nextSibling;return ee.nextSibling,d($,a),s($,()=>A(t.entry.date),O),s($,()=>t.entry.reference||e("journal.noReference","No reference"),q),s($,()=>e("journal.createdBy","By"),ee),s($,()=>t.entry.createdBy,null),$})(),(()=>{var $=TE(),O=$.firstChild,q=O.firstChild,z=q.nextSibling,ee=O.nextSibling,Q=ee.firstChild,C=Q.nextSibling;return d($,c),q.style.setProperty("font-size","0.875rem"),q.style.setProperty("color","var(--text-muted)"),s(q,()=>e("journal.totalAmount","Total Amount")),d(z,u),s(z,()=>E(t.entry.totalDebit)),ee.style.setProperty("text-align","right"),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),s(Q,()=>e("journal.lines","Lines")),C.style.setProperty("font-weight","600"),s(C,()=>t.entry.lines.length),$})(),oe(()=>!x&&(()=>{var $=kE(),O=$.firstChild,q=O.nextSibling,z=q.nextSibling,ee=z.nextSibling,Q=ee.nextSibling,C=Q.nextSibling,v=C.nextSibling,S=v.nextSibling;return S.nextSibling,$.style.setProperty("padding","0.5rem"),$.style.setProperty("border-radius","var(--border-radius-sm)"),$.style.setProperty("background","#f8d7da"),$.style.setProperty("color","#721c24"),$.style.setProperty("font-size","0.875rem"),$.style.setProperty("margin-bottom","1rem"),s($,()=>e("journal.entryNotBalancedShort","Entry is not balanced"),q),s($,()=>e("journal.debit"),ee),s($,()=>E(t.entry.totalDebit),C),s($,()=>e("journal.credit"),S),s($,()=>E(t.entry.totalCredit),null),$})()),(()=>{var $=$E(),O=$.firstChild,q=O.firstChild;return d($,h),O.style.setProperty("font-weight","500"),O.style.setProperty("margin-bottom","0.5rem"),O.style.setProperty("font-size","0.875rem"),s(O,()=>e("journal.accountLines","Account Lines"),q),s($,()=>t.entry.lines.slice(0,3).map(z=>(()=>{var ee=RE(),Q=ee.firstChild,C=Q.firstChild,v=C.nextSibling,S=Q.nextSibling;return d(ee,f),Q.style.setProperty("flex","1"),C.style.setProperty("font-weight","500"),s(C,()=>z.accountName),v.style.setProperty("font-size","0.75rem"),v.style.setProperty("color","var(--text-muted)"),s(v,()=>z.description||e("journal.noDescription","No description")),S.style.setProperty("text-align","right"),s(S,(()=>{var w=oe(()=>z.debitAmount>0);return()=>w()&&(()=>{var P=Bh(),I=P.firstChild;return P.style.setProperty("color","#4caf50"),P.style.setProperty("font-weight","500"),s(P,()=>e("journal.debitShort","Dr."),I),s(P,()=>E(z.debitAmount),null),P})()})(),null),s(S,(()=>{var w=oe(()=>z.creditAmount>0);return()=>w()&&(()=>{var P=Bh(),I=P.firstChild;return P.style.setProperty("color","#f44336"),P.style.setProperty("font-weight","500"),s(P,()=>e("journal.creditShort","Cr."),I),s(P,()=>E(z.creditAmount),null),P})()})(),null),s(S,(()=>{var w=oe(()=>!!z.reconciled);return()=>w()&&(()=>{var P=DE();return P.firstChild,P.style.setProperty("font-size","0.75rem"),P.style.setProperty("color","#4caf50"),s(P,()=>e("banking.reconciled","Reconciled"),null),P})()})(),null),ee})()),null),s($,(()=>{var z=oe(()=>t.entry.lines.length>3);return()=>z()&&(()=>{var ee=Al();return ee.style.setProperty("text-align","center"),ee.style.setProperty("color","var(--text-muted)"),ee.style.setProperty("font-size","0.875rem"),s(ee,()=>e("journal.andMoreLines","... and {count} more lines").replace("{count}",(t.entry.lines.length-3).toString())),ee})()})(),null),$})(),(()=>{var $=Al();return d($,p),s($,b(Oe,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.entry),get children(){return e("journal.viewDetails","View Details")}})),$})()]}})},LE=[{id:"je1",entryNumber:"JE-2024-001",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",status:"posted",createdBy:"John Doe",createdAt:"2024-01-15T09:00:00Z",postedAt:"2024-01-15T09:05:00Z",totalDebit:5e3,totalCredit:5e3,lines:[{id:"jel1",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment from ABC Corp",debitAmount:5e3,creditAmount:0,reconciled:!0,reconciledWith:"eb1"},{id:"jel2",accountId:"2001",accountName:"Trade Receivables",description:"Payment received for INV-2024-001",debitAmount:0,creditAmount:5e3}]},{id:"je2",entryNumber:"JE-2024-002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",status:"posted",createdBy:"Jane Smith",createdAt:"2024-01-14T10:00:00Z",postedAt:"2024-01-14T10:15:00Z",totalDebit:250,totalCredit:250,lines:[{id:"jel3",accountId:"5200",accountName:"Office Expenses",description:"Office supplies from Staples",debitAmount:250,creditAmount:0},{id:"jel4",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment to Staples",debitAmount:0,creditAmount:250,reconciled:!0,reconciledWith:"eb2"}]},{id:"je3",entryNumber:"JE-2024-003",date:"2024-01-13",description:"Monthly Rent Payment",reference:"RENT-2024-01",status:"posted",createdBy:"John Doe",createdAt:"2024-01-13T08:00:00Z",postedAt:"2024-01-13T08:30:00Z",totalDebit:2e3,totalCredit:2e3,lines:[{id:"jel5",accountId:"5200",accountName:"Rent Expense",description:"January office rent",debitAmount:2e3,creditAmount:0},{id:"jel6",accountId:"1002",accountName:"Bank - Checking Account",description:"Rent payment",debitAmount:0,creditAmount:2e3,reconciled:!1}]},{id:"je4",entryNumber:"JE-2024-004",date:"2024-01-12",description:"Wire Transfer - Capital Investment",reference:"WIRE-001",status:"posted",createdBy:"Admin",createdAt:"2024-01-12T14:00:00Z",postedAt:"2024-01-12T14:30:00Z",totalDebit:1e4,totalCredit:1e4,lines:[{id:"jel7",accountId:"1002",accountName:"Bank - Checking Account",description:"Wire transfer received",debitAmount:1e4,creditAmount:0,reconciled:!1},{id:"jel8",accountId:"8",accountName:"Owner's Equity",description:"Capital investment",debitAmount:0,creditAmount:1e4}]},{id:"je5",entryNumber:"JE-2024-005",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",status:"posted",createdBy:"HR Manager",createdAt:"2024-01-11T16:00:00Z",postedAt:"2024-01-11T16:30:00Z",totalDebit:3500,totalCredit:3500,lines:[{id:"jel9",accountId:"13",accountName:"Salaries Expense",description:"Monthly salary - John Doe",debitAmount:3500,creditAmount:0},{id:"jel10",accountId:"1002",accountName:"Bank - Checking Account",description:"Salary payment",debitAmount:0,creditAmount:3500,reconciled:!1}]},{id:"je6",entryNumber:"JE-2024-006",date:"2024-01-10",description:"Product Sales - Multiple Customers",reference:"SALES-2024-010",status:"posted",createdBy:"Sales Manager",createdAt:"2024-01-10T11:00:00Z",postedAt:"2024-01-10T11:30:00Z",totalDebit:8500,totalCredit:8500,lines:[{id:"jel11",accountId:"1001",accountName:"Petty Cash",description:"Cash sales",debitAmount:1500,creditAmount:0},{id:"jel12",accountId:"2001",accountName:"Trade Receivables",description:"Credit sales",debitAmount:7e3,creditAmount:0},{id:"jel13",accountId:"10",accountName:"Sales Revenue",description:"Product sales revenue",debitAmount:0,creditAmount:8500}]},{id:"je7",entryNumber:"JE-2024-007",date:"2024-01-09",description:"Inventory Purchase",reference:"PO-2024-002",status:"draft",createdBy:"Warehouse Manager",createdAt:"2024-01-09T15:00:00Z",totalDebit:15e3,totalCredit:15e3,lines:[{id:"jel14",accountId:"3",accountName:"Inventory",description:"Product inventory purchase",debitAmount:15e3,creditAmount:0},{id:"jel15",accountId:"5",accountName:"Accounts Payable",description:"Amount owed to supplier",debitAmount:0,creditAmount:15e3}]},{id:"je8",entryNumber:"JE-2024-008",date:"2024-01-08",description:"Utility Bills Payment",reference:"UTIL-2024-01",status:"posted",createdBy:"Admin",createdAt:"2024-01-08T09:00:00Z",postedAt:"2024-01-08T09:30:00Z",totalDebit:450,totalCredit:450,lines:[{id:"jel16",accountId:"14",accountName:"Operating Expenses",description:"Electricity and water bills",debitAmount:450,creditAmount:0},{id:"jel17",accountId:"1003",accountName:"Bank - Savings Account",description:"Utility payment",debitAmount:0,creditAmount:450}]}],[Mr,Il]=fe(LE),Fh=()=>Mr().filter(e=>e.status==="posted").flatMap(e=>e.lines.filter(r=>["1001","1002","1003"].includes(r.accountId))).map(e=>{const r=Mr().find(n=>n.lines.some(i=>i.id===e.id));return r?{id:`eb_${e.id}`,accountId:e.accountId,date:r.date,description:r.description,reference:r.reference,debitAmount:e.debitAmount,creditAmount:e.creditAmount,category:e.accountName,isReconciled:e.reconciled||!1,reconciledWith:e.reconciledWith,createdAt:r.createdAt}:null}).filter(e=>e!==null),En={get journalEntries(){return Mr()},addJournalEntry(t){const e={...t,id:Date.now().toString()};return Il([...Mr(),e]),e},updateJournalEntry(t,e){Il(Mr().map(r=>r.id===t?{...r,...e}:r))},deleteJournalEntry(t){const e=Mr().find(r=>r.id===t);if(e&&e.status==="posted")throw new Error("Cannot delete posted journal entries. Void them instead.");Il(Mr().filter(r=>r.id!==t))},voidJournalEntry(t){this.updateJournalEntry(t,{status:"void"})},postJournalEntry(t){const e=Mr().find(r=>r.id===t);if(!e)throw new Error("Journal entry not found");if(Math.abs(e.totalDebit-e.totalCredit)>.01)throw new Error("Journal entry is not balanced. Debits must equal credits.");this.updateJournalEntry(t,{status:"posted",postedAt:new Date().toISOString()}),Fh()},getJournalEntryById(t){return Mr().find(e=>e.id===t)},getJournalEntriesByStatus(t){return Mr().filter(e=>e.status===t)},getJournalEntriesByDateRange(t,e){return Mr().filter(r=>r.date>=t&&r.date<=e)},getJournalEntriesByAccount(t){return Mr().filter(e=>e.lines.some(r=>r.accountId===t))},getNextEntryNumber(){const t=new Date().getFullYear(),r=Mr().filter(n=>n.entryNumber.includes(t.toString())).reduce((n,i)=>{const o=parseInt(i.entryNumber.split("-").pop()||"0");return o>n?o:n},0);return`JE-${t}-${String(r+1).padStart(3,"0")}`},validateJournalEntry(t){const e=[];if(t.date||e.push("Date is required"),t.description||e.push("Description is required"),(!t.lines||t.lines.length===0)&&e.push("At least one line item is required"),t.lines){const r=t.lines.reduce((i,o)=>i+(o.debitAmount||0),0),n=t.lines.reduce((i,o)=>i+(o.creditAmount||0),0);Math.abs(r-n)>.01&&e.push(`Entry is not balanced. Debit: ${r}, Credit: ${n}`),t.lines.forEach((i,o)=>{i.accountId||e.push(`Line ${o+1}: Account is required`),i.debitAmount===0&&i.creditAmount===0&&e.push(`Line ${o+1}: Either debit or credit amount must be provided`),i.debitAmount>0&&i.creditAmount>0&&e.push(`Line ${o+1}: Cannot have both debit and credit amounts`)})}return{isValid:e.length===0,errors:e}},getBankRelatedEntries(){return Fh()}};var ME=U("<form><div></div><div><div><h4></h4></div><div><div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div></div></div><div><div><strong>: </strong></div><div><strong>: </strong></div><div></div></div></div><div>"),Uh=U("<div>");const Uy=t=>{const{t:e}=pt(),[r,n]=fe({entryNumber:"",date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),[i,o]=fe([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),[a,c]=fe(null);Ln(()=>{if(t.isOpen){if(t.editEntry)n({entryNumber:t.editEntry.entryNumber,date:t.editEntry.date,description:t.editEntry.description,reference:t.editEntry.reference,createdBy:t.editEntry.createdBy}),o(t.editEntry.lines.map((z,ee)=>({...z,tempId:`line_${Date.now()}_${ee}`})));else{const z=En.getNextEntryNumber();n({entryNumber:z,date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),o([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])}c(null)}});const u={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},h={display:"grid","grid-template-columns":"2fr 2fr 1fr 1fr 1fr",gap:"1rem","align-items":"end","margin-bottom":"1rem",padding:"1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},f={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},p=()=>St.accounts.map(z=>({value:z.id,label:`${z.accountNumber} - ${z.name}`})),_=(z,ee)=>{n(Q=>({...Q,[z]:ee}))},E=(z,ee,Q)=>{o(C=>C.map(v=>{if(v.tempId===z){const S={...v,[ee]:Q};if(ee==="accountId"&&typeof Q=="string"){const w=St.getAccountById(Q);w&&(S.accountName=w.name)}return S}return v}))},A=()=>{o(z=>[...z,{tempId:`line_${Date.now()}_${z.length}`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])},T=z=>{i().length>2&&o(ee=>ee.filter(Q=>Q.tempId!==z))},x=()=>{const z=i().reduce((Q,C)=>Q+(C.debitAmount||0),0),ee=i().reduce((Q,C)=>Q+(C.creditAmount||0),0);return{totalDebit:z,totalCredit:ee,isBalanced:Math.abs(z-ee)<.01}},$=z=>{z.preventDefault(),c(null);const ee=r(),Q=i(),{totalDebit:C,totalCredit:v,isBalanced:S}=x();if(!ee.description){c(e("forms.descriptionRequired","Description is required"));return}if(Q.length<2){c(e("journal.minTwoLinesRequired","At least 2 line items are required"));return}if(!S){c(e("journal.entryNotBalanced","Entry is not balanced. Debit: ${debit}, Credit: ${credit}").replace("${debit}",`$${C.toFixed(2)}`).replace("${credit}",`$${v.toFixed(2)}`));return}for(let P=0;P<Q.length;P++){const I=Q[P];if(!I.accountId){c(e("journal.lineAccountRequired","Line {lineNumber}: Account is required").replace("{lineNumber}",(P+1).toString()));return}if(I.debitAmount===0&&I.creditAmount===0){c(e("journal.lineAmountRequired","Line {lineNumber}: Either debit or credit amount must be provided").replace("{lineNumber}",(P+1).toString()));return}if((I.debitAmount||0)>0&&(I.creditAmount||0)>0){c(e("journal.lineBothAmounts","Line {lineNumber}: Cannot have both debit and credit amounts").replace("{lineNumber}",(P+1).toString()));return}}const w={entryNumber:ee.entryNumber,date:ee.date,description:ee.description,reference:ee.reference,status:"draft",createdBy:ee.createdBy,createdAt:new Date().toISOString(),totalDebit:C,totalCredit:v,lines:Q.map((P,I)=>{const{tempId:y,...le}=P;return{id:`jel_${Date.now()}_${I}`,...le}})};try{t.editEntry?En.updateJournalEntry(t.editEntry.id,w):En.addJournalEntry(w),n({entryNumber:En.getNextEntryNumber(),date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),o([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),t.onClose()}catch(P){c(P instanceof Error?P.message:e("forms.errorOccurred","An error occurred"))}},O=z=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(z),q=x();return b(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return oe(()=>!!t.editEntry)()?e("journal.editEntry"):e("journal.addEntry","Add Journal Entry")},get children(){var z=ME(),ee=z.firstChild,Q=ee.nextSibling,C=Q.firstChild,v=C.firstChild,S=C.nextSibling,w=S.firstChild,P=w.firstChild,I=P.firstChild,y=P.nextSibling,le=y.firstChild,B=y.nextSibling,k=B.firstChild,W=B.nextSibling,R=W.firstChild,V=W.nextSibling,M=V.firstChild,F=S.nextSibling,ne=F.firstChild,L=ne.firstChild,j=L.firstChild,Z=ne.nextSibling,te=Z.firstChild,he=te.firstChild,se=Z.nextSibling,re=Q.nextSibling;return z.addEventListener("submit",$),ee.style.setProperty("display","grid"),ee.style.setProperty("grid-template-columns","1fr 1fr"),ee.style.setProperty("gap","1rem"),s(ee,b(Rt,{get label(){return e("journal.entryNumber")},get value(){return r().entryNumber},onChange:ye=>_("entryNumber",ye),get disabled(){return!!t.editEntry},required:!0}),null),s(ee,b(Rt,{get label(){return e("common.date")},type:"date",get value(){return r().date},onChange:ye=>_("date",ye),required:!0}),null),s(z,b(Rt,{get label(){return e("common.description")},get value(){return r().description},onChange:ye=>_("description",ye),get placeholder(){return e("journal.enterEntryDescription","Enter journal entry description")},required:!0}),Q),s(z,b(Rt,{get label(){return e("journal.reference")},get value(){return r().reference},onChange:ye=>_("reference",ye),get placeholder(){return e("journal.enterReferenceNumber","Enter reference number")}}),Q),Q.style.setProperty("margin-top","2rem"),C.style.setProperty("display","flex"),C.style.setProperty("justify-content","space-between"),C.style.setProperty("align-items","center"),C.style.setProperty("margin-bottom","1rem"),v.style.setProperty("margin","0"),s(v,()=>e("journal.entryLines","Journal Entry Lines")),s(C,b(Oe,{type:"button",variant:"secondary",size:"sm",onClick:A,get children(){return e("journal.addLine","Add Line")}}),null),S.style.setProperty("margin-bottom","1rem"),S.style.setProperty("font-size","0.875rem"),S.style.setProperty("color","var(--text-muted)"),w.style.setProperty("display","grid"),w.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1fr"),w.style.setProperty("gap","1rem"),s(I,()=>e("journal.account")),s(le,()=>e("common.description")),s(k,()=>e("journal.debit")),s(R,()=>e("journal.credit")),s(M,()=>e("common.actions")),s(Q,b(jt,{get each(){return i()},children:ye=>(()=>{var G=Uh();return d(G,h),s(G,b(_r,{label:"",get value(){return ye.accountId||""},onChange:ae=>E(ye.tempId,"accountId",ae),get options(){return p()}}),null),s(G,b(Rt,{label:"",get value(){return ye.description||""},onChange:ae=>E(ye.tempId,"description",ae),get placeholder(){return e("journal.lineDescription","Line description")}}),null),s(G,b(Rt,{label:"",type:"number",get value(){return ye.debitAmount?.toString()||"0"},onChange:ae=>{E(ye.tempId,"debitAmount",parseFloat(ae)||0),parseFloat(ae)>0&&E(ye.tempId,"creditAmount",0)},placeholder:"0.00"}),null),s(G,b(Rt,{label:"",type:"number",get value(){return ye.creditAmount?.toString()||"0"},onChange:ae=>{E(ye.tempId,"creditAmount",parseFloat(ae)||0),parseFloat(ae)>0&&E(ye.tempId,"debitAmount",0)},placeholder:"0.00"}),null),s(G,b(Oe,{type:"button",variant:"outline",size:"sm",onClick:()=>T(ye.tempId),get disabled(){return i().length<=2},get children(){return e("common.remove","Remove")}}),null),G})()}),F),d(F,f),s(L,()=>e("journal.totalDebit","Total Debit"),j),s(L,()=>O(q.totalDebit),null),s(te,()=>e("journal.totalCredit","Total Credit"),he),s(te,()=>O(q.totalCredit),null),se.style.setProperty("font-weight","600"),s(se,(()=>{var ye=oe(()=>!!q.isBalanced);return()=>ye()?`✓ ${e("journal.balanced")}`:`⚠️ ${e("journal.notBalanced","Not Balanced")}`})()),s(z,(()=>{var ye=oe(()=>!!a());return()=>ye()&&(()=>{var G=Uh();return G.style.setProperty("padding","1rem"),G.style.setProperty("border-radius","var(--border-radius-sm)"),G.style.setProperty("margin-top","1rem"),G.style.setProperty("background","#f8d7da"),G.style.setProperty("color","#721c24"),G.style.setProperty("border","1px solid #f5c6cb"),s(G,a),G})()})(),re),d(re,u),s(re,b(Oe,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(re,b(Oe,{variant:"primary",type:"submit",get disabled(){return!q.isBalanced},get children(){return oe(()=>!!t.editEntry)()?e("journal.updateEntry","Update Entry"):e("journal.saveAsDraft","Save as Draft")}}),null),K(ye=>(ye=q.isBalanced?"#4caf50":"#f44336")!=null?se.style.setProperty("color",ye):se.style.removeProperty("color")),z}})};var OE=U("<div><div>⚠️</div><div></div><div></div><div>"),VE=U("<div><div></div><div></div><div></div><div></div><div>"),BE=U("<div><button></button><button> (<!>)</button><button> (<!>/<!>)"),jh=U("<div>"),FE=U("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><div><h4></h4><div></div></div><div>"),El=U("<div><span></span><span>"),xl=U("<div><strong>:</strong> "),UE=U("<div><div><div></div><div></div><div></div><div></div><div></div></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div></div></div><div><div><strong>🔗 Reconciliation Summary</strong></div><div><div><div><strong>Total Lines:</strong> </div><div><strong>Reconciled:</strong> </div><div><strong>Unreconciled:</strong> </div></div><div><div><strong>Bank Accounts:</strong> </div><div><strong>Bank Reconciled:</strong> "),jE=U("<div><div><div></div><div></div></div><div></div><div></div><div></div><div>"),zE=U("<div><span>✓ "),qE=U("<span>(<!>)"),HE=U("<div><strong>Bank Pending:</strong> "),WE=U("<div><div>Reconciled Lines:"),GE=U("<div><div>⚠️ Pending Bank Reconciliation:</div><div>Visit Bank Consolidations to reconcile these transactions"),KE=U("<div><div><div><span></span><h3></h3></div><div><div><div></div><div>Total Lines</div></div><div><div></div><div>Reconciled</div></div><div><div></div><div>Pending"),YE=U("<div><h4>✅ Reconciled Lines (<!>)"),QE=U("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div>✓ Matched"),JE=U("<div>→ "),XE=U("<div><h4>⏳ Unreconciled Lines (<!>)"),ZE=U("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div>⏳ Pending"),ex=U("<div>Bank account"),tx=U("<div><div>💡 Reconciliation Tip</div><div>This entry has unreconciled bank account transactions. Visit <strong>Bank Consolidations</strong> to match these with bank statements.");const rx=t=>{const{t:e}=pt(),[r,n]=fe("details"),[i,o]=fe(!1),a=it(()=>t.entryId?En.getJournalEntryById(t.entryId):null),c={"text-align":"center","margin-bottom":"2rem",position:"relative"},u={position:"absolute",top:"0",right:"0",display:"flex",gap:"0.5rem"},h={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","margin-bottom":"0.5rem"},f={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},p={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},_={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem",display:"inline-block"},E={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},A={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},T={"font-weight":"600",color:"var(--text-primary)"},x={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},$=y=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:y?"var(--primary-color)":"var(--text-muted)","border-bottom":y?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),O={display:"grid","grid-template-columns":"2fr 2.5fr 1fr 1fr 1.5fr",gap:"1rem",padding:"1rem 0","border-bottom":"1px solid var(--border-color)","align-items":"center"},q={...O,"font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","border-bottom":"2px solid var(--border-color)"},z={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},ee={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},Q=y=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[y],C=y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(y),v=y=>new Date(y).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),S=y=>new Date(y).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),w=()=>{entry.status==="posted"&&!confirm(e("journal.confirmEditPosted","This entry has been posted. Editing will create a new draft copy. Continue?"))||o(!0)},P=()=>{if(a()&&confirm(e("journal.confirmPost","Are you sure you want to post this journal entry? This action cannot be undone.")))try{En.postJournalEntry(a().id)}catch(y){alert(y instanceof Error?y.message:e("forms.errorPostingEntry","An error occurred while posting the entry"))}},I=()=>{a()&&confirm(e("journal.confirmVoid","Are you sure you want to void this journal entry?"))&&En.voidJournalEntry(a().id)};return[b(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.entryDetails","Journal Entry Details")},get children(){return oe(()=>!a())()?(()=>{var y=OE(),le=y.firstChild,B=le.nextSibling,k=B.nextSibling,W=k.nextSibling;return y.style.setProperty("text-align","center"),y.style.setProperty("padding","3rem"),y.style.setProperty("color","var(--text-muted)"),le.style.setProperty("font-size","1.5rem"),le.style.setProperty("margin-bottom","1rem"),B.style.setProperty("font-size","1.1rem"),B.style.setProperty("margin-bottom","0.5rem"),s(B,()=>e("journal.entryNotFound","Entry Not Found")),k.style.setProperty("font-size","0.875rem"),s(k,()=>e("journal.entryNotFoundMessage","The journal entry you're looking for could not be found or may have been deleted.")),W.style.setProperty("margin-top","2rem"),s(W,b(Oe,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),y})():(()=>{const y=a(),le=Q(y.status),B=Math.abs(y.totalDebit-y.totalCredit)<.01;return[(()=>{var k=VE(),W=k.firstChild,R=W.nextSibling,V=R.nextSibling,M=V.nextSibling,F=M.nextSibling;return d(k,c),s(W,b(Oe,{variant:"outline",size:"sm",onClick:w,get title(){return e("journal.editEntryTooltip","Edit this journal entry")},get children(){return e("common.edit")}}),null),s(W,(()=>{var ne=oe(()=>y.status==="draft");return()=>ne()&&b(Oe,{variant:"primary",size:"sm",onClick:P,disabled:!B,get title(){return B?e("journal.postEntryTooltip","Post this journal entry"):e("journal.entryMustBeBalanced","Entry must be balanced to post")},get children(){return e("journal.post","Post")}})})(),null),s(W,(()=>{var ne=oe(()=>y.status==="posted");return()=>ne()&&b(Oe,{variant:"outline",size:"sm",onClick:I,style:{color:"#dc3545","border-color":"#dc3545"},get title(){return e("journal.voidEntryTooltip","Void this journal entry")},get children(){return e("entryBooks.void","Void")}})})(),null),d(R,h),s(R,()=>y.entryNumber),d(V,f),s(V,()=>y.description),d(M,p),s(M,()=>C(y.totalDebit)),s(F,()=>y.status),K(ne=>{var L=u,j={..._,background:le.bg,color:le.color};return ne.e=d(W,L,ne.e),ne.t=d(F,j,ne.t),ne},{e:void 0,t:void 0}),k})(),(()=>{var k=BE(),W=k.firstChild,R=W.nextSibling,V=R.firstChild,M=V.nextSibling;M.nextSibling;var F=R.nextSibling,ne=F.firstChild,L=ne.nextSibling,j=L.nextSibling,Z=j.nextSibling;return Z.nextSibling,d(k,x),W.$$click=()=>n("details"),s(W,()=>e("common.details")),R.$$click=()=>n("lines"),s(R,()=>e("journal.journalLines","Journal Lines"),V),s(R,()=>y.lines.length,M),F.$$click=()=>n("reconciliation"),s(F,()=>e("banking.reconciliation","Reconciliation"),ne),s(F,()=>y.lines.filter(te=>te.reconciled).length,L),s(F,()=>y.lines.length,Z),K(te=>{var he=$(r()==="details"),se=$(r()==="lines"),re=$(r()==="reconciliation");return te.e=d(W,he,te.e),te.t=d(R,se,te.t),te.a=d(F,re,te.a),te},{e:void 0,t:void 0,a:void 0}),k})(),oe(()=>oe(()=>r()==="details")()&&(()=>{var k=FE(),W=k.firstChild,R=W.firstChild,V=R.nextSibling,M=W.nextSibling,F=M.firstChild,ne=F.nextSibling,L=M.nextSibling,j=L.firstChild,Z=j.nextSibling,te=L.nextSibling,he=te.firstChild,se=he.nextSibling,re=te.nextSibling,ye=re.firstChild,G=ye.nextSibling,ae=re.nextSibling,Pe=ae.firstChild,we=Pe.nextSibling,ue=ae.nextSibling,ce=ue.firstChild,H=ce.nextSibling,de=ue.nextSibling,X=de.firstChild,_e=X.firstChild,Se=_e.nextSibling,Y=X.nextSibling;return s(R,()=>e("common.date")),s(V,()=>v(y.date)),s(F,()=>e("journal.reference")),s(ne,()=>y.reference||e("common.notAvailable","N/A")),s(j,()=>e("journal.totalDebit")),s(Z,()=>C(y.totalDebit)),s(he,()=>e("journal.totalCredit")),s(se,()=>C(y.totalCredit)),s(ye,()=>e("journal.balanceStatus","Balance Status")),s(G,()=>B?`${e("journal.balanced")} ✓`:`${e("journal.unbalanced","Unbalanced")} (${C(Math.abs(y.totalDebit-y.totalCredit))} ${e("journal.difference","difference")})`),s(Pe,()=>e("journal.createdBy")),s(we,()=>y.createdBy),s(ce,()=>e("journal.createdAt","Created At")),s(H,()=>S(y.createdAt)),s(k,(()=>{var ie=oe(()=>!!y.postedAt);return()=>ie()&&(()=>{var Ie=El(),pe=Ie.firstChild,me=pe.nextSibling;return s(pe,()=>e("journal.postedAt","Posted At")),s(me,()=>S(y.postedAt)),K(J=>{var D=E,ge=A,ke=T;return J.e=d(Ie,D,J.e),J.t=d(pe,ge,J.t),J.a=d(me,ke,J.a),J},{e:void 0,t:void 0,a:void 0}),Ie})()})(),de),de.style.setProperty("margin-top","2rem"),de.style.setProperty("padding-top","1rem"),de.style.setProperty("border-top","2px solid var(--border-color)"),X.style.setProperty("display","flex"),X.style.setProperty("justify-content","space-between"),X.style.setProperty("align-items","center"),X.style.setProperty("margin-bottom","1rem"),_e.style.setProperty("margin","0"),_e.style.setProperty("font-size","1rem"),s(_e,()=>e("journal.quickActions","Quick Actions")),Se.style.setProperty("display","flex"),Se.style.setProperty("gap","0.5rem"),s(Se,b(Oe,{variant:"primary",size:"sm",onClick:w,get children(){return["✏️ ",oe(()=>e("journal.editEntry"))]}}),null),s(Se,(()=>{var ie=oe(()=>y.status==="draft");return()=>ie()&&b(Oe,{variant:"outline",size:"sm",onClick:P,disabled:!B,style:{"border-color":B?"#4caf50":"#f44336",color:B?"#4caf50":"#f44336"},get children(){return B?`✓ ${e("journal.postEntry","Post Entry")}`:`⚠️ ${e("journal.fixBalance","Fix Balance")}`}})})(),null),s(Se,(()=>{var ie=oe(()=>y.status==="posted");return()=>ie()&&b(Oe,{variant:"outline",size:"sm",onClick:I,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return["🗑️ ",oe(()=>e("journal.voidEntry","Void Entry"))]}})})(),null),Y.style.setProperty("padding","1rem"),Y.style.setProperty("border-radius","var(--border-radius-sm)"),Y.style.setProperty("font-size","0.875rem"),s(Y,(()=>{var ie=oe(()=>y.status==="draft");return()=>ie()&&(()=>{var Ie=xl(),pe=Ie.firstChild,me=pe.firstChild;return pe.nextSibling,s(pe,()=>e("journal.draftEntry","Draft Entry"),me),s(Ie,()=>e("journal.draftEntryDescription","This entry can be edited and posted."),null),s(Ie,()=>!B&&` ⚠️ ${e("journal.entryMustBeBalancedBeforePosting","Entry must be balanced before posting.")}`,null),Ie})()})(),null),s(Y,(()=>{var ie=oe(()=>y.status==="posted");return()=>ie()&&(()=>{var Ie=xl(),pe=Ie.firstChild,me=pe.firstChild;return pe.nextSibling,s(pe,()=>e("journal.postedEntry","Posted Entry"),me),s(Ie,()=>e("journal.postedEntryDescription","This entry has been posted to the general ledger. Editing will create a new draft copy."),null),Ie})()})(),null),s(Y,(()=>{var ie=oe(()=>y.status==="void");return()=>ie()&&(()=>{var Ie=xl(),pe=Ie.firstChild,me=pe.firstChild;return pe.nextSibling,s(pe,()=>e("journal.voidEntry"),me),s(Ie,()=>e("journal.voidEntryDescription","This entry has been voided and cannot be modified."),null),Ie})()})(),null),K(ie=>{var Ie=E,pe=A,me=T,J=E,D=A,ge=T,ke=E,Ee=A,Te=T,De=E,Ke=A,Me=T,ve=E,Le=A,Fe={...T,color:B?"#4caf50":"#f44336"},ze=E,qe=A,Ce=T,Ye=E,Qe=A,Ze=T,Ae=y.status==="draft"?"#fff3cd":y.status==="posted"?"#d4edda":"#f8d7da";return ie.e=d(W,Ie,ie.e),ie.t=d(R,pe,ie.t),ie.a=d(V,me,ie.a),ie.o=d(M,J,ie.o),ie.i=d(F,D,ie.i),ie.n=d(ne,ge,ie.n),ie.s=d(L,ke,ie.s),ie.h=d(j,Ee,ie.h),ie.r=d(Z,Te,ie.r),ie.d=d(te,De,ie.d),ie.l=d(he,Ke,ie.l),ie.u=d(se,Me,ie.u),ie.c=d(re,ve,ie.c),ie.w=d(ye,Le,ie.w),ie.m=d(G,Fe,ie.m),ie.f=d(ae,ze,ie.f),ie.y=d(Pe,qe,ie.y),ie.g=d(we,Ce,ie.g),ie.p=d(ue,Ye,ie.p),ie.b=d(ce,Qe,ie.b),ie.T=d(H,Ze,ie.T),Ae!==ie.A&&((ie.A=Ae)!=null?Y.style.setProperty("background",Ae):Y.style.removeProperty("background")),ie},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),k})()),oe(()=>oe(()=>r()==="lines")()&&(()=>{var k=UE(),W=k.firstChild,R=W.firstChild,V=R.nextSibling,M=V.nextSibling,F=M.nextSibling,ne=F.nextSibling,L=W.nextSibling,j=L.firstChild,Z=j.firstChild,te=Z.firstChild;Z.nextSibling;var he=j.nextSibling,se=he.firstChild,re=se.firstChild;se.nextSibling;var ye=he.nextSibling,G=L.nextSibling,ae=G.firstChild,Pe=ae.nextSibling,we=Pe.firstChild,ue=we.firstChild,ce=ue.firstChild;ce.nextSibling;var H=ue.nextSibling,de=H.firstChild;de.nextSibling;var X=H.nextSibling,_e=X.firstChild;_e.nextSibling;var Se=we.nextSibling,Y=Se.firstChild,ie=Y.firstChild;ie.nextSibling;var Ie=Y.nextSibling,pe=Ie.firstChild;return pe.nextSibling,s(R,()=>e("journal.account")),s(V,()=>e("common.description")),s(M,()=>e("journal.debit")),s(F,()=>e("journal.credit")),s(ne,()=>e("banking.reconciliation")),s(k,b(jt,{get each(){return y.lines},children:me=>(()=>{var J=jE(),D=J.firstChild,ge=D.firstChild,ke=ge.nextSibling,Ee=D.nextSibling,Te=Ee.nextSibling,De=Te.nextSibling,Ke=De.nextSibling;return ge.style.setProperty("font-weight","500"),s(ge,()=>me.accountName),ke.style.setProperty("font-size","0.75rem"),ke.style.setProperty("color","var(--text-muted)"),s(ke,()=>St.getAccountById(me.accountId)?.accountNumber||me.accountId),Ee.style.setProperty("font-size","0.875rem"),s(Ee,()=>me.description||"-"),Te.style.setProperty("font-weight","600"),s(Te,(()=>{var Me=oe(()=>me.debitAmount>0);return()=>Me()?C(me.debitAmount):"-"})()),De.style.setProperty("font-weight","600"),s(De,(()=>{var Me=oe(()=>me.creditAmount>0);return()=>Me()?C(me.creditAmount):"-"})()),s(Ke,(()=>{var Me=oe(()=>!!me.reconciled);return()=>Me()?(()=>{var ve=zE(),Le=ve.firstChild;return Le.firstChild,ve.style.setProperty("display","flex"),ve.style.setProperty("align-items","center"),ve.style.setProperty("gap","0.5rem"),ve.style.setProperty("color","#4caf50"),ve.style.setProperty("font-size","0.875rem"),Le.style.setProperty("font-weight","600"),s(Le,()=>e("banking.reconciled"),null),s(ve,(()=>{var Fe=oe(()=>!!me.reconciledWith);return()=>Fe()&&(()=>{var ze=qE(),qe=ze.firstChild,Ce=qe.nextSibling;return Ce.nextSibling,ze.style.setProperty("font-size","0.75rem"),ze.style.setProperty("color","var(--text-muted)"),ze.style.setProperty("font-style","italic"),s(ze,()=>me.reconciledWith,Ce),ze})()})(),null),ve})():(()=>{var ve=jh();return ve.style.setProperty("color","var(--text-muted)"),ve.style.setProperty("font-size","0.875rem"),s(ve,()=>e("banking.notReconciled","Not Reconciled")),ve})()})()),K(Me=>{var ve=O,Le=me.debitAmount>0?"#4caf50":"var(--text-muted)",Fe=me.creditAmount>0?"#f44336":"var(--text-muted)";return Me.e=d(J,ve,Me.e),Le!==Me.t&&((Me.t=Le)!=null?Te.style.setProperty("color",Le):Te.style.removeProperty("color")),Fe!==Me.a&&((Me.a=Fe)!=null?De.style.setProperty("color",Fe):De.style.removeProperty("color")),Me},{e:void 0,t:void 0,a:void 0}),J})()}),L),d(L,z),s(Z,()=>e("journal.totalDebit"),te),s(j,()=>C(y.totalDebit),null),s(se,()=>e("journal.totalCredit"),re),s(he,()=>C(y.totalCredit),null),(B?"#4caf50":"#f44336")!=null?ye.style.setProperty("color",B?"#4caf50":"#f44336"):ye.style.removeProperty("color"),ye.style.setProperty("font-weight","600"),s(ye,()=>B?`✓ ${e("journal.balanced")}`:`⚠️ ${e("journal.notBalanced","Not Balanced")}`),G.style.setProperty("margin-top","1rem"),G.style.setProperty("padding","1rem"),G.style.setProperty("border-radius","var(--border-radius-sm)"),G.style.setProperty("font-size","0.875rem"),ae.style.setProperty("margin-bottom","0.5rem"),Pe.style.setProperty("display","grid"),Pe.style.setProperty("grid-template-columns","1fr 1fr"),Pe.style.setProperty("gap","1rem"),ue.style.setProperty("margin-bottom","0.25rem"),s(ue,()=>y.lines.length,null),H.style.setProperty("margin-bottom","0.25rem"),H.style.setProperty("color","#4caf50"),s(H,()=>y.lines.filter(me=>me.reconciled).length,null),X.style.setProperty("color","#f44336"),s(X,()=>y.lines.filter(me=>!me.reconciled).length,null),Y.style.setProperty("margin-bottom","0.25rem"),s(Y,()=>y.lines.filter(me=>["1001","1002","1003"].includes(me.accountId)).length,null),Ie.style.setProperty("margin-bottom","0.25rem"),Ie.style.setProperty("color","#4caf50"),s(Ie,()=>y.lines.filter(me=>["1001","1002","1003"].includes(me.accountId)&&me.reconciled).length,null),s(Se,(()=>{var me=oe(()=>y.lines.filter(J=>["1001","1002","1003"].includes(J.accountId)&&!J.reconciled).length>0);return()=>me()&&(()=>{var J=HE(),D=J.firstChild;return D.nextSibling,J.style.setProperty("color","#f44336"),s(J,()=>y.lines.filter(ge=>["1001","1002","1003"].includes(ge.accountId)&&!ge.reconciled).length,null),J})()})(),null),s(G,(()=>{var me=oe(()=>y.lines.filter(J=>J.reconciled).length>0);return()=>me()&&(()=>{var J=WE(),D=J.firstChild;return J.style.setProperty("margin-top","0.75rem"),J.style.setProperty("padding-top","0.75rem"),J.style.setProperty("border-top","1px solid var(--border-color)"),D.style.setProperty("margin-bottom","0.5rem"),D.style.setProperty("font-weight","500"),s(J,()=>y.lines.filter(ge=>ge.reconciled).map(ge=>(()=>{var ke=El(),Ee=ke.firstChild,Te=Ee.nextSibling;return ke.style.setProperty("display","flex"),ke.style.setProperty("justify-content","space-between"),ke.style.setProperty("margin-bottom","0.25rem"),ke.style.setProperty("font-size","0.8rem"),s(Ee,()=>ge.accountName),Te.style.setProperty("color","var(--text-muted)"),s(Te,()=>ge.reconciledWith?`→ ${ge.reconciledWith}`:"Manual"),ke})()),null),J})()})(),null),s(G,(()=>{var me=oe(()=>y.lines.filter(J=>!J.reconciled&&["1001","1002","1003"].includes(J.accountId)).length>0);return()=>me()&&(()=>{var J=GE(),D=J.firstChild,ge=D.nextSibling;return J.style.setProperty("margin-top","0.75rem"),J.style.setProperty("padding-top","0.75rem"),J.style.setProperty("border-top","1px solid var(--border-color)"),D.style.setProperty("margin-bottom","0.5rem"),D.style.setProperty("font-weight","500"),D.style.setProperty("color","#f44336"),s(J,()=>y.lines.filter(ke=>!ke.reconciled&&["1001","1002","1003"].includes(ke.accountId)).map(ke=>(()=>{var Ee=El(),Te=Ee.firstChild,De=Te.nextSibling;return Ee.style.setProperty("display","flex"),Ee.style.setProperty("justify-content","space-between"),Ee.style.setProperty("margin-bottom","0.25rem"),Ee.style.setProperty("font-size","0.8rem"),Ee.style.setProperty("color","#f44336"),s(Te,()=>ke.accountName),s(De,()=>C(ke.debitAmount||ke.creditAmount)),Ee})()),ge),ge.style.setProperty("margin-top","0.5rem"),ge.style.setProperty("font-size","0.75rem"),ge.style.setProperty("color","var(--text-muted)"),ge.style.setProperty("font-style","italic"),J})()})(),null),K(me=>{var J=q,D=y.lines.some(ge=>ge.reconciled)?"#e8f5e8":"#fff3cd";return me.e=d(W,J,me.e),D!==me.t&&((me.t=D)!=null?G.style.setProperty("background",D):G.style.removeProperty("background")),me},{e:void 0,t:void 0}),k})()),oe(()=>oe(()=>r()==="reconciliation")()&&(()=>{var k=KE(),W=k.firstChild,R=W.firstChild,V=R.firstChild,M=V.nextSibling,F=R.nextSibling,ne=F.firstChild,L=ne.firstChild,j=L.nextSibling,Z=ne.nextSibling,te=Z.firstChild,he=te.nextSibling,se=Z.nextSibling,re=se.firstChild,ye=re.nextSibling;return W.style.setProperty("margin-bottom","1.5rem"),W.style.setProperty("padding","1rem"),W.style.setProperty("border-radius","var(--border-radius)"),W.style.setProperty("border","1px solid var(--border-color)"),R.style.setProperty("display","flex"),R.style.setProperty("align-items","center"),R.style.setProperty("gap","0.5rem"),R.style.setProperty("margin-bottom","1rem"),V.style.setProperty("font-size","1.5rem"),s(V,(()=>{var G=oe(()=>!!y.lines.every(ae=>ae.reconciled));return()=>G()?"✅":y.lines.some(ae=>ae.reconciled)?"🔄":"⏳"})()),M.style.setProperty("margin","0"),M.style.setProperty("font-size","1.2rem"),s(M,(()=>{var G=oe(()=>!!y.lines.every(ae=>ae.reconciled));return()=>G()?"Fully Reconciled":y.lines.some(ae=>ae.reconciled)?"Partially Reconciled":"Unreconciled"})()),F.style.setProperty("display","grid"),F.style.setProperty("grid-template-columns","1fr 1fr 1fr"),F.style.setProperty("gap","1rem"),ne.style.setProperty("text-align","center"),L.style.setProperty("font-size","2rem"),L.style.setProperty("font-weight","700"),L.style.setProperty("color","var(--primary-color)"),s(L,()=>y.lines.length),j.style.setProperty("font-size","0.875rem"),j.style.setProperty("color","var(--text-muted)"),Z.style.setProperty("text-align","center"),te.style.setProperty("font-size","2rem"),te.style.setProperty("font-weight","700"),te.style.setProperty("color","#4caf50"),s(te,()=>y.lines.filter(G=>G.reconciled).length),he.style.setProperty("font-size","0.875rem"),he.style.setProperty("color","var(--text-muted)"),se.style.setProperty("text-align","center"),re.style.setProperty("font-size","2rem"),re.style.setProperty("font-weight","700"),re.style.setProperty("color","#f44336"),s(re,()=>y.lines.filter(G=>!G.reconciled).length),ye.style.setProperty("font-size","0.875rem"),ye.style.setProperty("color","var(--text-muted)"),s(k,(()=>{var G=oe(()=>y.lines.filter(ae=>ae.reconciled).length>0);return()=>G()&&(()=>{var ae=YE(),Pe=ae.firstChild,we=Pe.firstChild,ue=we.nextSibling;return ue.nextSibling,ae.style.setProperty("margin-bottom","1.5rem"),Pe.style.setProperty("margin","0 0 1rem 0"),Pe.style.setProperty("font-size","1.1rem"),Pe.style.setProperty("color","#4caf50"),Pe.style.setProperty("display","flex"),Pe.style.setProperty("align-items","center"),Pe.style.setProperty("gap","0.5rem"),s(Pe,()=>y.lines.filter(ce=>ce.reconciled).length,ue),s(ae,()=>y.lines.filter(ce=>ce.reconciled).map(ce=>(()=>{var H=QE(),de=H.firstChild,X=de.firstChild,_e=X.nextSibling,Se=de.nextSibling,Y=Se.nextSibling,ie=Y.nextSibling,Ie=ie.nextSibling,pe=Ie.firstChild;return H.style.setProperty("display","grid"),H.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),H.style.setProperty("gap","1rem"),H.style.setProperty("padding","0.75rem"),H.style.setProperty("margin-bottom","0.5rem"),H.style.setProperty("background","#f0f9f0"),H.style.setProperty("border-radius","var(--border-radius-sm)"),H.style.setProperty("align-items","center"),H.style.setProperty("font-size","0.875rem"),X.style.setProperty("font-weight","500"),s(X,()=>ce.accountName),_e.style.setProperty("font-size","0.75rem"),_e.style.setProperty("color","var(--text-muted)"),s(_e,()=>St.getAccountById(ce.accountId)?.accountNumber),Se.style.setProperty("color","var(--text-muted)"),s(Se,()=>ce.description||"No description"),Y.style.setProperty("font-weight","600"),s(Y,(()=>{var me=oe(()=>ce.debitAmount>0);return()=>me()?C(ce.debitAmount):"-"})()),ie.style.setProperty("font-weight","600"),s(ie,(()=>{var me=oe(()=>ce.creditAmount>0);return()=>me()?C(ce.creditAmount):"-"})()),Ie.style.setProperty("color","#4caf50"),pe.style.setProperty("font-weight","500"),s(Ie,(()=>{var me=oe(()=>!!ce.reconciledWith);return()=>me()&&(()=>{var J=JE();return J.firstChild,J.style.setProperty("font-size","0.75rem"),J.style.setProperty("font-style","italic"),s(J,()=>ce.reconciledWith,null),J})()})(),null),K(me=>{var J=ce.debitAmount>0?"#4caf50":"var(--text-muted)",D=ce.creditAmount>0?"#f44336":"var(--text-muted)";return J!==me.e&&((me.e=J)!=null?Y.style.setProperty("color",J):Y.style.removeProperty("color")),D!==me.t&&((me.t=D)!=null?ie.style.setProperty("color",D):ie.style.removeProperty("color")),me},{e:void 0,t:void 0}),H})()),null),ae})()})(),null),s(k,(()=>{var G=oe(()=>y.lines.filter(ae=>!ae.reconciled).length>0);return()=>G()&&(()=>{var ae=XE(),Pe=ae.firstChild,we=Pe.firstChild,ue=we.nextSibling;return ue.nextSibling,ae.style.setProperty("margin-bottom","1.5rem"),Pe.style.setProperty("margin","0 0 1rem 0"),Pe.style.setProperty("font-size","1.1rem"),Pe.style.setProperty("color","#f44336"),Pe.style.setProperty("display","flex"),Pe.style.setProperty("align-items","center"),Pe.style.setProperty("gap","0.5rem"),s(Pe,()=>y.lines.filter(ce=>!ce.reconciled).length,ue),s(ae,()=>y.lines.filter(ce=>!ce.reconciled).map(ce=>(()=>{var H=ZE(),de=H.firstChild,X=de.firstChild,_e=X.nextSibling,Se=de.nextSibling,Y=Se.nextSibling,ie=Y.nextSibling,Ie=ie.nextSibling,pe=Ie.firstChild;return H.style.setProperty("display","grid"),H.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),H.style.setProperty("gap","1rem"),H.style.setProperty("padding","0.75rem"),H.style.setProperty("margin-bottom","0.5rem"),H.style.setProperty("background","#fff9f0"),H.style.setProperty("border-radius","var(--border-radius-sm)"),H.style.setProperty("align-items","center"),H.style.setProperty("font-size","0.875rem"),H.style.setProperty("border","1px solid #ffe0b3"),X.style.setProperty("font-weight","500"),s(X,()=>ce.accountName),_e.style.setProperty("font-size","0.75rem"),_e.style.setProperty("color","var(--text-muted)"),s(_e,()=>St.getAccountById(ce.accountId)?.accountNumber),Se.style.setProperty("color","var(--text-muted)"),s(Se,()=>ce.description||"No description"),Y.style.setProperty("font-weight","600"),s(Y,(()=>{var me=oe(()=>ce.debitAmount>0);return()=>me()?C(ce.debitAmount):"-"})()),ie.style.setProperty("font-weight","600"),s(ie,(()=>{var me=oe(()=>ce.creditAmount>0);return()=>me()?C(ce.creditAmount):"-"})()),Ie.style.setProperty("color","#f44336"),pe.style.setProperty("font-weight","500"),s(Ie,(()=>{var me=oe(()=>!!["1001","1002","1003"].includes(ce.accountId));return()=>me()&&(()=>{var J=ex();return J.style.setProperty("font-size","0.75rem"),J.style.setProperty("font-style","italic"),J})()})(),null),K(me=>{var J=ce.debitAmount>0?"#4caf50":"var(--text-muted)",D=ce.creditAmount>0?"#f44336":"var(--text-muted)";return J!==me.e&&((me.e=J)!=null?Y.style.setProperty("color",J):Y.style.removeProperty("color")),D!==me.t&&((me.t=D)!=null?ie.style.setProperty("color",D):ie.style.removeProperty("color")),me},{e:void 0,t:void 0}),H})()),null),s(ae,(()=>{var ce=oe(()=>y.lines.filter(H=>!H.reconciled&&["1001","1002","1003"].includes(H.accountId)).length>0);return()=>ce()&&(()=>{var H=tx(),de=H.firstChild,X=de.nextSibling;return H.style.setProperty("padding","0.75rem"),H.style.setProperty("background","#ffebee"),H.style.setProperty("border-radius","var(--border-radius-sm)"),H.style.setProperty("margin-top","1rem"),H.style.setProperty("border","1px solid #ffcdd2"),de.style.setProperty("font-weight","500"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("color","#f44336"),X.style.setProperty("font-size","0.875rem"),X.style.setProperty("color","var(--text-muted)"),H})()})(),null),ae})()})(),null),K(G=>(G=y.lines.every(ae=>ae.reconciled)?"#e8f5e8":y.lines.some(ae=>ae.reconciled)?"#fff3cd":"#ffebee")!=null?W.style.setProperty("background",G):W.style.removeProperty("background")),k})()),(()=>{var k=jh();return d(k,ee),s(k,b(Oe,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(k,b(Oe,{variant:"primary",onClick:w,get children(){return e("journal.editEntry")}}),null),s(k,(()=>{var W=oe(()=>y.status==="draft");return()=>W()&&b(Oe,{variant:"outline",onClick:P,disabled:!B,style:{"border-color":"#4caf50",color:B?"#4caf50":"var(--text-muted)"},get children(){return B?e("journal.postEntry","Post Entry"):e("journal.entryNotBalanced","Entry Not Balanced")}})})(),null),s(k,(()=>{var W=oe(()=>y.status==="posted");return()=>W()&&b(Oe,{variant:"outline",onClick:I,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return e("journal.voidEntry","Void Entry")}})})(),null),k})()]})()}}),oe(()=>oe(()=>!!a())()&&b(Uy,{get isOpen(){return i()},onClose:()=>{o(!1)},get editEntry(){return a()}}))]};Ot(["click"]);var nx=U("<div><div><h2></h2><p></p></div><div>"),Pn=U("<div>"),ix=U("<div> <!> • <!> "),ox=U("<div><div><label></label></div><div><label></label></div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label></div><div>"),sx=U("<div><span>:</span><span> "),js=U("<span>: "),ax=U("<div><br>");const lx=()=>{const{t}=pt(),[e,r]=fe(!1),[n,i]=fe(null),[o,a]=fe(!1),[c,u]=fe(null),[h,f]=fe("all"),[p,_]=fe("all"),[E,A]=fe(""),[T,x]=fe(""),[$,O]=fe("date"),[q,z]=fe("desc"),ee={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},Q={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)","flex-wrap":"wrap"},C={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem"},v={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(400px, 1fr))",gap:"1.5rem"},S=()=>[{value:"all",label:t("journal.allEntries","All Entries")},{value:"draft",label:t("journal.draft")},{value:"posted",label:t("journal.posted")},{value:"void",label:t("entryBooks.void","Void")}],w=()=>[{value:"all",label:t("accounts.allAccounts","All Accounts")},...St.accounts.map(M=>({value:M.id,label:`${M.accountNumber} - ${M.name}`}))],P=()=>[{value:"date",label:t("common.date")},{value:"entryNumber",label:t("journal.entryNumber")},{value:"amount",label:t("common.amount")}],I=()=>{let M=En.journalEntries;return h()!=="all"&&(M=M.filter(F=>F.status===h())),p()!=="all"&&(M=M.filter(F=>F.lines.some(ne=>ne.accountId===p()))),E()&&(M=M.filter(F=>F.date>=E())),T()&&(M=M.filter(F=>F.date<=T())),M=[...M].sort((F,ne)=>{let L=0;switch($()){case"date":L=new Date(F.date).getTime()-new Date(ne.date).getTime();break;case"entryNumber":L=F.entryNumber.localeCompare(ne.entryNumber);break;case"amount":L=F.totalDebit-ne.totalDebit;break}return q()==="asc"?L:-L}),M},y=()=>{const M=En.journalEntries,F=M.filter(he=>he.status==="draft"),ne=M.filter(he=>he.status==="posted"),L=M.filter(he=>he.status==="void"),j=ne.reduce((he,se)=>he+se.totalDebit,0),Z=ne.reduce((he,se)=>he+se.totalCredit,0),te=M.filter(he=>he.lines.some(se=>["1001","1002","1003"].includes(se.accountId)&&!se.reconciled)).length;return{totalEntries:M.length,draftEntries:F.length,postedEntries:ne.length,voidEntries:L.length,totalDebit:j,totalCredit:Z,unreconciledEntries:te}},le=M=>{u(M.id),a(!0)},B=()=>{i(null),r(!0)},k=()=>{r(!1),i(null)},W=M=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(M),R=y(),V=I();return b(Wr,{get title(){return t("entryBooks.title")},get children(){return[(()=>{var M=nx(),F=M.firstChild,ne=F.firstChild,L=ne.nextSibling,j=F.nextSibling;return d(M,ee),ne.style.setProperty("margin","0 0 0.5rem 0"),ne.style.setProperty("font-size","1.5rem"),s(ne,()=>t("journal.title")),L.style.setProperty("margin","0"),L.style.setProperty("color","var(--text-muted)"),s(L,()=>t("entryBooks.subtitle","Manage accounting entries and general ledger records")),j.style.setProperty("display","flex"),j.style.setProperty("gap","1rem"),s(j,b(Oe,{variant:"secondary",onClick:()=>window.location.href="/bank-consolidations",get children(){return t("entryBooks.viewReconciliation","View Reconciliation")}}),null),s(j,b(Oe,{variant:"primary",onClick:B,get children(){return t("journal.addEntry","Add Journal Entry")}}),null),M})(),(()=>{var M=Pn();return d(M,C),s(M,b(tt,{get title(){return t("entryBooks.totalEntries","Total Entries")},get subtitle(){return t("entryBooks.allJournalEntries","All journal entries")},get children(){return[(()=>{var F=Pn();return F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("color","var(--primary-color)"),F.style.setProperty("margin-bottom","0.5rem"),s(F,()=>R.totalEntries),F})(),(()=>{var F=ix(),ne=F.firstChild,L=ne.nextSibling,j=L.nextSibling,Z=j.nextSibling;return Z.nextSibling,F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-muted)"),s(F,()=>R.postedEntries,ne),s(F,()=>t("journal.posted").toLowerCase(),L),s(F,()=>R.draftEntries,Z),s(F,()=>t("journal.draft").toLowerCase(),null),s(F,(()=>{var te=oe(()=>R.voidEntries>0);return()=>te()&&` • ${R.voidEntries} ${t("entryBooks.void","void").toLowerCase()}`})(),null),F})()]}}),null),s(M,b(tt,{get title(){return t("journal.totalDebits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var F=Pn();return F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("color","#4caf50"),F.style.setProperty("margin-bottom","0.5rem"),s(F,()=>W(R.totalDebit)),F})(),(()=>{var F=Pn();return F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-muted)"),s(F,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",R.postedEntries.toString())),F})()]}}),null),s(M,b(tt,{get title(){return t("journal.totalCredits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var F=Pn();return F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("color","#f44336"),F.style.setProperty("margin-bottom","0.5rem"),s(F,()=>W(R.totalCredit)),F})(),(()=>{var F=Pn();return F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-muted)"),s(F,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",R.postedEntries.toString())),F})()]}}),null),s(M,b(tt,{get title(){return t("banking.unreconciled","Unreconciled")},get subtitle(){return t("banking.title")},get children(){return[(()=>{var F=Pn();return F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("margin-bottom","0.5rem"),s(F,()=>R.unreconciledEntries),K(ne=>(ne=R.unreconciledEntries>0?"#ff9800":"#4caf50")!=null?F.style.setProperty("color",ne):F.style.removeProperty("color")),F})(),(()=>{var F=Pn();return F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-muted)"),s(F,(()=>{var ne=oe(()=>R.unreconciledEntries>0);return()=>ne()?t("entryBooks.needBankReconciliation","Need bank reconciliation"):t("entryBooks.allReconciled","All reconciled")})()),F})()]}}),null),M})(),(()=>{var M=ox(),F=M.firstChild,ne=F.firstChild,L=F.nextSibling,j=L.firstChild,Z=L.nextSibling,te=Z.firstChild,he=Z.nextSibling,se=he.firstChild,re=se.nextSibling,ye=he.nextSibling,G=ye.firstChild,ae=G.nextSibling,Pe=ye.nextSibling,we=Pe.firstChild,ue=Pe.nextSibling;return d(M,Q),F.style.setProperty("min-width","150px"),ne.style.setProperty("display","block"),ne.style.setProperty("margin-bottom","0.5rem"),ne.style.setProperty("font-weight","500"),ne.style.setProperty("font-size","0.875rem"),s(ne,()=>t("common.status")),s(F,b(_r,{label:"",get value(){return h()},onChange:f,get options(){return S()}}),null),L.style.setProperty("min-width","200px"),j.style.setProperty("display","block"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("font-weight","500"),j.style.setProperty("font-size","0.875rem"),s(j,()=>t("journal.account")),s(L,b(_r,{label:"",get value(){return p()},onChange:_,get options(){return w()}}),null),Z.style.setProperty("min-width","120px"),te.style.setProperty("display","block"),te.style.setProperty("margin-bottom","0.5rem"),te.style.setProperty("font-weight","500"),te.style.setProperty("font-size","0.875rem"),s(te,()=>t("entryBooks.sortBy","Sort By")),s(Z,b(_r,{label:"",get value(){return $()},onChange:O,get options(){return P()}}),null),he.style.setProperty("min-width","130px"),se.style.setProperty("display","block"),se.style.setProperty("margin-bottom","0.5rem"),se.style.setProperty("font-weight","500"),se.style.setProperty("font-size","0.875rem"),s(se,()=>t("entryBooks.fromDate","From Date")),re.addEventListener("change",ce=>A(ce.target.value)),re.style.setProperty("padding","0.75rem"),re.style.setProperty("border","1px solid var(--border-color)"),re.style.setProperty("border-radius","var(--border-radius-sm)"),re.style.setProperty("font-family","inherit"),re.style.setProperty("width","100%"),ye.style.setProperty("min-width","130px"),G.style.setProperty("display","block"),G.style.setProperty("margin-bottom","0.5rem"),G.style.setProperty("font-weight","500"),G.style.setProperty("font-size","0.875rem"),s(G,()=>t("entryBooks.toDate","To Date")),ae.addEventListener("change",ce=>x(ce.target.value)),ae.style.setProperty("padding","0.75rem"),ae.style.setProperty("border","1px solid var(--border-color)"),ae.style.setProperty("border-radius","var(--border-radius-sm)"),ae.style.setProperty("font-family","inherit"),ae.style.setProperty("width","100%"),Pe.style.setProperty("min-width","100px"),we.style.setProperty("display","block"),we.style.setProperty("margin-bottom","0.5rem"),we.style.setProperty("font-weight","500"),we.style.setProperty("font-size","0.875rem"),s(we,()=>t("entryBooks.order","Order")),s(Pe,b(_r,{label:"",get value(){return q()},onChange:z,get options(){return[{value:"desc",label:t("entryBooks.newest","Newest")},{value:"asc",label:t("entryBooks.oldest","Oldest")}]}}),null),ue.style.setProperty("display","flex"),ue.style.setProperty("align-items","end"),ue.style.setProperty("gap","0.5rem"),s(ue,b(Oe,{variant:"outline",size:"sm",onClick:()=>{f("all"),_("all"),A(""),x(""),O("date"),z("desc")},get children(){return t("entryBooks.resetFilters","Reset Filters")}})),K(()=>re.value=E()),K(()=>ae.value=T()),M})(),oe(()=>oe(()=>!!(h()!=="all"||p()!=="all"||E()||T()))()&&(()=>{var M=sx(),F=M.firstChild,ne=F.firstChild,L=F.nextSibling,j=L.firstChild;return M.style.setProperty("display","flex"),M.style.setProperty("gap","0.5rem"),M.style.setProperty("align-items","center"),M.style.setProperty("margin-bottom","1rem"),M.style.setProperty("padding","0.75rem"),M.style.setProperty("background","var(--surface-color)"),M.style.setProperty("border-radius","var(--border-radius-sm)"),M.style.setProperty("border","1px solid var(--border-color)"),F.style.setProperty("font-size","0.875rem"),F.style.setProperty("font-weight","500"),s(F,()=>t("entryBooks.activeFilters","Active filters"),ne),s(M,(()=>{var Z=oe(()=>h()!=="all");return()=>Z()&&(()=>{var te=js(),he=te.firstChild;return te.style.setProperty("padding","0.25rem 0.5rem"),te.style.setProperty("background","var(--primary-color)"),te.style.setProperty("color","white"),te.style.setProperty("border-radius","12px"),te.style.setProperty("font-size","0.75rem"),s(te,()=>t("common.status"),he),s(te,h,null),te})()})(),L),s(M,(()=>{var Z=oe(()=>p()!=="all");return()=>Z()&&(()=>{var te=js(),he=te.firstChild;return te.style.setProperty("padding","0.25rem 0.5rem"),te.style.setProperty("background","var(--primary-color)"),te.style.setProperty("color","white"),te.style.setProperty("border-radius","12px"),te.style.setProperty("font-size","0.75rem"),s(te,()=>t("journal.account"),he),s(te,()=>St.getAccountById(p())?.name||t("common.unknown","Unknown"),null),te})()})(),L),s(M,(()=>{var Z=oe(()=>!!E());return()=>Z()&&(()=>{var te=js(),he=te.firstChild;return te.style.setProperty("padding","0.25rem 0.5rem"),te.style.setProperty("background","var(--primary-color)"),te.style.setProperty("color","white"),te.style.setProperty("border-radius","12px"),te.style.setProperty("font-size","0.75rem"),s(te,()=>t("entryBooks.from","From"),he),s(te,E,null),te})()})(),L),s(M,(()=>{var Z=oe(()=>!!T());return()=>Z()&&(()=>{var te=js(),he=te.firstChild;return te.style.setProperty("padding","0.25rem 0.5rem"),te.style.setProperty("background","var(--primary-color)"),te.style.setProperty("color","white"),te.style.setProperty("border-radius","12px"),te.style.setProperty("font-size","0.75rem"),s(te,()=>t("entryBooks.to","To"),he),s(te,T,null),te})()})(),L),L.style.setProperty("margin-left","auto"),L.style.setProperty("font-size","0.875rem"),L.style.setProperty("color","var(--text-muted)"),s(L,()=>V.length,j),s(L,()=>t("entryBooks.entriesFound","{count} entries found").replace("{count}",V.length.toString()),null),M})()),oe(()=>oe(()=>V.length===0)()?b(tt,{get title(){return t("entryBooks.noJournalEntries","No Journal Entries")},get subtitle(){return t("entryBooks.startByCreating","Start by creating your first entry")},get children(){var M=ax(),F=M.firstChild;return M.style.setProperty("text-align","center"),M.style.setProperty("color","var(--text-muted)"),M.style.setProperty("padding","2rem"),s(M,()=>t("entryBooks.noEntriesMatch","No journal entries match your current filters."),F),s(M,b(Oe,{variant:"primary",style:{"margin-top":"1rem"},onClick:B,get children(){return t("entryBooks.createFirstEntry","Create First Entry")}}),null),M}}):(()=>{var M=Pn();return d(M,v),s(M,b(jt,{each:V,children:F=>b(NE,{entry:F,onViewDetails:le})})),M})()),b(Uy,{get isOpen(){return e()},onClose:k,get editEntry(){return n()}}),b(rx,{get isOpen(){return o()},onClose:()=>{a(!1),u(null)},get entryId(){return c()}})]}})};var zh=U("<div>"),cx=U("<div>$23,450"),ux=U("<div>$87,230"),dx=U("<div>$5,670"),hx=U("<div><div><div><div>INV-2024-001</div><div>Acme Corporation</div></div><div>$5,250.00</div><div></div></div><div><div><div>INV-2024-002</div><div>Tech Solutions Inc.</div></div><div>$3,750.00</div><div></div></div><div><div><div>INV-2024-003</div><div>Global Services Ltd.</div></div><div>$8,900.00</div><div></div></div><div><div><div>INV-2024-004</div><div>StartUp Co.</div></div><div>$2,100.00</div><div>");const mx=()=>{const{t}=pt(),e={display:"flex","flex-direction":"column",gap:"1rem"},r={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},n={flex:"1"},i={"font-weight":"600","margin-bottom":"0.25rem"},o={color:"var(--text-muted)","font-size":"0.875rem"},a={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},c=h=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:h==="paid"?"#d4edda":h==="pending"?"#fff3cd":"#f8d7da",color:h==="paid"?"#155724":h==="pending"?"#856404":"#721c24"}),u={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"};return b(Wr,{get title(){return t("invoices.title","Invoices")},get children(){return[(()=>{var h=zh();return h.style.setProperty("margin-bottom","2rem"),s(h,b(Oe,{variant:"primary",get children(){return t("invoices.createNew","Create New Invoice")}})),h})(),(()=>{var h=zh();return d(h,u),s(h,b(tt,{get title(){return t("invoices.totalOutstanding","Total Outstanding")},get subtitle(){return t("invoices.unpaidInvoices","Unpaid invoices")},get children(){var f=cx();return f.style.setProperty("font-size","1.5rem"),f.style.setProperty("font-weight","600"),f.style.setProperty("color","var(--primary-color)"),f}}),null),s(h,b(tt,{get title(){return t("invoices.thisMonth","This Month")},get subtitle(){return t("invoices.revenueCollected","Revenue collected")},get children(){var f=ux();return f.style.setProperty("font-size","1.5rem"),f.style.setProperty("font-weight","600"),f.style.setProperty("color","var(--primary-color)"),f}}),null),s(h,b(tt,{get title(){return t("invoices.overdue","Overdue")},get subtitle(){return t("invoices.pastDueInvoices","Past due invoices")},get children(){var f=dx();return f.style.setProperty("font-size","1.5rem"),f.style.setProperty("font-weight","600"),f.style.setProperty("color","var(--primary-color)"),f}}),null),h})(),b(tt,{get title(){return t("invoices.recentInvoices","Recent Invoices")},get subtitle(){return t("invoices.latestBillingActivity","Latest billing activity")},get children(){var h=hx(),f=h.firstChild,p=f.firstChild,_=p.firstChild,E=_.nextSibling,A=p.nextSibling,T=A.nextSibling,x=f.nextSibling,$=x.firstChild,O=$.firstChild,q=O.nextSibling,z=$.nextSibling,ee=z.nextSibling,Q=x.nextSibling,C=Q.firstChild,v=C.firstChild,S=v.nextSibling,w=C.nextSibling,P=w.nextSibling,I=Q.nextSibling,y=I.firstChild,le=y.firstChild,B=le.nextSibling,k=y.nextSibling,W=k.nextSibling;return d(h,e),s(T,()=>t("invoices.paid","Paid")),s(ee,()=>t("invoices.pending","Pending")),s(P,()=>t("invoices.overdue","Overdue")),s(W,()=>t("invoices.paid","Paid")),K(R=>{var V=r,M=n,F=i,ne=o,L=a,j=c("paid"),Z=r,te=n,he=i,se=o,re=a,ye=c("pending"),G=r,ae=n,Pe=i,we=o,ue=a,ce=c("overdue"),H=r,de=n,X=i,_e=o,Se=a,Y=c("paid");return R.e=d(f,V,R.e),R.t=d(p,M,R.t),R.a=d(_,F,R.a),R.o=d(E,ne,R.o),R.i=d(A,L,R.i),R.n=d(T,j,R.n),R.s=d(x,Z,R.s),R.h=d($,te,R.h),R.r=d(O,he,R.r),R.d=d(q,se,R.d),R.l=d(z,re,R.l),R.u=d(ee,ye,R.u),R.c=d(Q,G,R.c),R.w=d(C,ae,R.w),R.m=d(v,Pe,R.m),R.f=d(S,we,R.f),R.y=d(w,ue,R.y),R.g=d(P,ce,R.g),R.p=d(I,H,R.p),R.b=d(y,de,R.b),R.T=d(le,X,R.T),R.A=d(B,_e,R.A),R.O=d(k,Se,R.O),R.I=d(W,Y,R.I),R},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0}),h}})]}})};var fx=U("<div><main>");const yx=t=>[b(dw,{}),oe(()=>t.children)],gx=()=>b(HP,{get children(){var t=fx(),e=t.firstChild;return s(e,b(cp,{root:yx,get children(){return[b(rn,{path:"/",component:$w}),b(rn,{path:"/accounts",component:()=>b(_n,{permission:"AccountAccess",featureName:"Accounts",requiredPermission:"Account Management Access",get children(){return b(pC,{})}})}),b(rn,{path:"/accounts/:id",component:()=>b(_n,{permission:"AccountAccess",featureName:"Account Details",requiredPermission:"Account Management Access",get children(){return b(CC,{})}})}),b(rn,{path:"/entry-books",component:()=>b(_n,{permission:"JournalAccess",featureName:"Entry Books",requiredPermission:"Journal Entry Access",get children(){return b(lx,{})}})}),b(rn,{path:"/employees",component:()=>b(_n,{permission:"EmployeeAccess",featureName:"Employee Management",requiredPermission:"HR Access",get children(){return b(XI,{})}})}),b(rn,{path:"/bank-consolidations",component:()=>b(_n,{permission:"BankingAccess",featureName:"Bank Consolidations",requiredPermission:"Banking Access",get children(){return b(IE,{})}})}),b(rn,{path:"/balance-sheet",component:()=>b(_n,{permission:"AccountAccess",featureName:"Balance Sheet",requiredPermission:"Financial Reporting Access",get children(){return b($C,{})}})}),b(rn,{path:"/invoices",component:()=>b(_n,{permission:"JournalAccess",featureName:"Invoices",requiredPermission:"Invoice Management Access",get children(){return b(mx,{})}})}),b(rn,{path:"/inventory",component:()=>b(_n,{permission:"InventoryAccess",featureName:"Inventory Management",requiredPermission:"Inventory Access",get children(){return b(CI,{})}})}),b(rn,{path:"/products",component:()=>b(_n,{permission:"InventoryAccess",featureName:"Product Management",requiredPermission:"Product Management Access",get children(){return b(zI,{})}})})]}})),s(t,(()=>{var r=oe(()=>!1);return()=>r()&&b(ww,{})})(),null),t}}),px=document.getElementById("root");Cg(()=>b(gx,{}),px);
