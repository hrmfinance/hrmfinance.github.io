import{e as L,P as ae,s as Pe,c as E,g as ue,o as he,t as g,i as l,a as m,F as oe,b as X,k as N,S as J,w as ie,d as fe}from"./index-CS63pYUf.js";async function be(r){try{const d={":search0":r?.searchTerm||"230"};return r?.guia&&r.guia!=="all"&&(d.guia=r.guia),(await ae({query:"getScanYabaHbls",queryString:"!* contain :search0 AND guia = guia",params:d,limit:1e4})).data||[]}catch(d){return L("Error fetching all HBLs:",d),[]}}function ye(r){return!r.scannedLocations||r.scannedLocations.length===0?null:[...r.scannedLocations].sort((n,f)=>{const b=new Date(n.scannedAt).getTime();return new Date(f.scannedAt).getTime()-b})[0]}function ve(r){return Pe.find(n=>n.id===r)?.label||r}async function xe(r){try{L("ğŸ“Š Fetching all HBLs for location summary...",r),L(r);let d="",n={};r?.guia&&(d+=" "+r?.guia),r?.searchTerm&&(d+=" "+r?.searchTerm),d&&d.split(" ").map((w,S)=>{w&&(n[":search"+S]=w.trim())});let f={query:"getScannedLocations",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4 AND !* contain :search5",params:n};const b=await ae(f);L(f),L(b);let P=[];L(`âœ… Fetched ${P.length} HBLs`);const F=new Map;for(const w of P){const S=ye(w);if(!S)continue;const D=S.locationId;F.has(D)||F.set(D,{locationId:D,locationLabel:ve(D),hblCount:0,hbls:[]});const q=F.get(D);q.hblCount++,q.hbls.push({hbl:w.hbl,lastScannedAt:new Date(S.scannedAt),scannedBy:S.scannedBy})}const R=Array.from(F.values()).sort((w,S)=>S.hblCount-w.hblCount),K={totalHBLs:P.length,locations:R,lastUpdated:new Date};return L("âœ… Location summary generated:",{totalHBLs:K.totalHBLs,totalLocations:R.length}),K}catch(d){throw L("âŒ Error grouping HBLs by location:",d),d}}async function $e(r,d){try{const n=await be(d),f=[];for(const b of n){const P=ye(b);P&&P.locationId===r&&f.push({hbl:b.hbl,lastScannedAt:new Date(P.scannedAt),scannedBy:P.scannedBy})}return f.sort((b,P)=>P.lastScannedAt.getTime()-b.lastScannedAt.getTime()),f}catch(n){return L(`Error getting HBLs for location ${r}:`,n),[]}}var _e=g('<div><div><label>ğŸ“‹ Guide Number</label><select><option value=all>All Guides</option></select></div><div><label>ğŸ” Search HBL</label><input type=text placeholder="Enter HBL prefix or number..."></div><div><button>'),Le=g("<div>âŒ "),we=g("<div><div>ğŸ“¦</div><div>Loading HBL location summary..."),Se=g("<div><div></div><div>Total HBLs"),Ce=g("<div><div></div><div>Active Locations"),Be=g("<div><div>Last Updated</div><div>"),He=g("<div>"),ke=g("<div><h2>HBLs by Location</h2><div><table><thead><tr><th>Location</th><th>HBL Count</th><th>Percentage</th><th>Actions</th></tr></thead><tbody>"),ze=g("<div><div><div><h1>ğŸ“Š HBL Location Summary</h1><p>View all HBLs grouped by their last scanned location</p></div><button>"),Ae=g("<option>Guide No. "),De=g("<tr><td><div></div><div></div></td><td></td><td><div>%</div></td><td><button>"),Te=g("<div>Loading HBL details..."),Ee=g("<tr><td colspan=4><div><h4>HBLs in "),Fe=g("<div><table><thead><tr><th>HBL Number</th><th>Last Scanned</th><th>Scanned By</th></tr></thead><tbody>"),Ne=g("<tr><td></td><td></td><td>");const Ge=()=>{const[r,d]=E(null),[n,f]=E(!1),[b,P]=E(null),[F,R]=E(null),[K,w]=E([]),[S,D]=E(!1),[q,de]=E("230"),[U,pe]=E("all"),ce=ue(()=>[2518,2519,2520,2521,2522,2523,2524,2525,2526]),Z=async()=>{try{f(!0),P(null);const a={searchTerm:q().trim()||"230",guia:U()!=="all"?U():void 0},v=await xe(a);d(v)}catch(a){L("Error loading location summary:",a),P("Failed to load location summary")}finally{f(!1)}},me=async a=>{if(F()===a)R(null),w([]);else{R(a),D(!0);try{const v={searchTerm:q().trim()||"230",guia:U()!=="all"?U():void 0},O=await $e(a,v);w(O)}catch(v){L("Error loading location details:",v)}finally{D(!1)}}};he(()=>{Z()});const le=a=>new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(a);return(()=>{var a=ze(),v=a.firstChild,O=v.firstChild,I=O.firstChild,ne=I.nextSibling,h=O.nextSibling;return a.style.setProperty("padding","2rem"),a.style.setProperty("max-width","1400px"),a.style.setProperty("margin","0 auto"),v.style.setProperty("margin-bottom","2rem"),v.style.setProperty("display","flex"),v.style.setProperty("justify-content","space-between"),v.style.setProperty("align-items","center"),I.style.setProperty("font-size","2rem"),I.style.setProperty("font-weight","700"),I.style.setProperty("margin-bottom","0.5rem"),I.style.setProperty("color","var(--text-primary)"),ne.style.setProperty("color","var(--text-muted)"),ne.style.setProperty("font-size","1rem"),h.$$click=Z,h.style.setProperty("padding","0.75rem 1.5rem"),h.style.setProperty("color","white"),h.style.setProperty("border","none"),h.style.setProperty("border-radius","6px"),h.style.setProperty("font-weight","500"),h.style.setProperty("font-size","1rem"),l(h,()=>n()?"ğŸ”„ Loading...":"ğŸ”„ Refresh"),l(a,m(N,{get children(){var e=_e(),o=e.firstChild,t=o.firstChild,s=t.nextSibling;s.firstChild;var V=o.nextSibling,B=V.firstChild,u=B.nextSibling,H=V.nextSibling,i=H.firstChild;return e.style.setProperty("padding","1.5rem"),e.style.setProperty("display","grid"),e.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),e.style.setProperty("gap","1rem"),e.style.setProperty("margin-bottom","1rem"),t.style.setProperty("display","block"),t.style.setProperty("margin-bottom","0.5rem"),t.style.setProperty("font-weight","500"),t.style.setProperty("color","var(--text-primary)"),s.addEventListener("change",y=>pe(y.currentTarget.value)),s.style.setProperty("width","100%"),s.style.setProperty("padding","0.5rem"),s.style.setProperty("border","1px solid var(--border-color)"),s.style.setProperty("border-radius","6px"),s.style.setProperty("font-family","inherit"),s.style.setProperty("background","var(--surface-color)"),l(s,m(oe,{get each(){return ce()},children:y=>(()=>{var k=Ae();return k.firstChild,k.value=y,l(k,y,null),k})()}),null),B.style.setProperty("display","block"),B.style.setProperty("margin-bottom","0.5rem"),B.style.setProperty("font-weight","500"),B.style.setProperty("color","var(--text-primary)"),u.$$input=y=>de(y.currentTarget.value),u.style.setProperty("width","100%"),u.style.setProperty("padding","0.5rem"),u.style.setProperty("border","1px solid var(--border-color)"),u.style.setProperty("border-radius","6px"),u.style.setProperty("font-family","inherit"),u.style.setProperty("background","var(--surface-color)"),H.style.setProperty("display","flex"),H.style.setProperty("align-items","flex-end"),i.$$click=Z,i.style.setProperty("width","100%"),i.style.setProperty("padding","0.5rem 1rem"),i.style.setProperty("color","white"),i.style.setProperty("border","none"),i.style.setProperty("border-radius","6px"),i.style.setProperty("font-weight","500"),i.style.setProperty("font-size","0.95rem"),l(i,()=>n()?"â³ Searching...":"ğŸ” Search"),X(y=>{var k=n(),x=n()?"#6c757d":"#28a745",j=n()?"not-allowed":"pointer";return k!==y.e&&(i.disabled=y.e=k),x!==y.t&&((y.t=x)!=null?i.style.setProperty("background",x):i.style.removeProperty("background")),j!==y.a&&((y.a=j)!=null?i.style.setProperty("cursor",j):i.style.removeProperty("cursor")),y},{e:void 0,t:void 0,a:void 0}),X(()=>s.value=U()),X(()=>u.value=q()),e}}),null),l(a,m(J,{get when(){return b()},get children(){return m(N,{get children(){var e=Le();return e.firstChild,e.style.setProperty("padding","1rem"),e.style.setProperty("background","#f8d7da"),e.style.setProperty("color","#721c24"),e.style.setProperty("border-radius","6px"),e.style.setProperty("text-align","center"),l(e,b,null),e}})}}),null),l(a,m(J,{get when(){return ie(()=>!!n())()&&!r()},get children(){return m(N,{get children(){var e=we(),o=e.firstChild;return e.style.setProperty("padding","4rem"),e.style.setProperty("text-align","center"),e.style.setProperty("color","var(--text-muted)"),o.style.setProperty("font-size","3rem"),o.style.setProperty("margin-bottom","1rem"),e}})}}),null),l(a,m(J,{get when(){return ie(()=>!!r())()&&!n()},get children(){return[(()=>{var e=He();return e.style.setProperty("display","grid"),e.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),e.style.setProperty("gap","1.5rem"),e.style.setProperty("margin-bottom","2rem"),l(e,m(N,{get children(){var o=Se(),t=o.firstChild,s=t.nextSibling;return o.style.setProperty("padding","1.5rem"),o.style.setProperty("text-align","center"),t.style.setProperty("font-size","2.5rem"),t.style.setProperty("font-weight","700"),t.style.setProperty("color","#007bff"),t.style.setProperty("margin-bottom","0.5rem"),l(t,()=>r().totalHBLs),s.style.setProperty("color","var(--text-muted)"),s.style.setProperty("font-size","0.95rem"),o}}),null),l(e,m(N,{get children(){var o=Ce(),t=o.firstChild,s=t.nextSibling;return o.style.setProperty("padding","1.5rem"),o.style.setProperty("text-align","center"),t.style.setProperty("font-size","2.5rem"),t.style.setProperty("font-weight","700"),t.style.setProperty("color","#28a745"),t.style.setProperty("margin-bottom","0.5rem"),l(t,()=>r().locations.length),s.style.setProperty("color","var(--text-muted)"),s.style.setProperty("font-size","0.95rem"),o}}),null),l(e,m(N,{get children(){var o=Be(),t=o.firstChild,s=t.nextSibling;return o.style.setProperty("padding","1.5rem"),o.style.setProperty("text-align","center"),t.style.setProperty("font-size","1rem"),t.style.setProperty("font-weight","500"),t.style.setProperty("color","var(--text-muted)"),t.style.setProperty("margin-bottom","0.5rem"),s.style.setProperty("font-size","0.9rem"),s.style.setProperty("color","var(--text-primary)"),l(s,()=>le(r().lastUpdated)),o}}),null),e})(),m(N,{get children(){var e=ke(),o=e.firstChild,t=o.nextSibling,s=t.firstChild,V=s.firstChild,B=V.firstChild,u=B.firstChild,H=u.nextSibling,i=H.nextSibling,y=i.nextSibling,k=V.nextSibling;return e.style.setProperty("padding","1.5rem"),o.style.setProperty("font-size","1.25rem"),o.style.setProperty("font-weight","600"),o.style.setProperty("margin-bottom","1.5rem"),t.style.setProperty("overflow-x","auto"),s.style.setProperty("width","100%"),s.style.setProperty("border-collapse","collapse"),s.style.setProperty("font-size","0.95rem"),B.style.setProperty("background","#f8f9fa"),B.style.setProperty("border-bottom","2px solid #dee2e6"),u.style.setProperty("padding","1rem"),u.style.setProperty("text-align","left"),u.style.setProperty("font-weight","600"),u.style.setProperty("color","var(--text-primary)"),H.style.setProperty("padding","1rem"),H.style.setProperty("text-align","center"),H.style.setProperty("font-weight","600"),H.style.setProperty("color","var(--text-primary)"),i.style.setProperty("padding","1rem"),i.style.setProperty("text-align","center"),i.style.setProperty("font-weight","600"),i.style.setProperty("color","var(--text-primary)"),y.style.setProperty("padding","1rem"),y.style.setProperty("text-align","center"),y.style.setProperty("font-weight","600"),y.style.setProperty("color","var(--text-primary)"),l(k,m(oe,{get each(){return r().locations},children:x=>{const j=(x.hblCount/r().totalHBLs*100).toFixed(1),G=F()===x.locationId;return[(()=>{var z=De(),M=z.firstChild,A=M.firstChild,C=A.nextSibling,p=M.nextSibling,$=p.nextSibling,_=$.firstChild,W=_.firstChild,T=$.nextSibling,c=T.firstChild;return z.style.setProperty("border-bottom","1px solid #dee2e6"),(G?"#e7f3ff":"white")!=null?z.style.setProperty("background",G?"#e7f3ff":"white"):z.style.removeProperty("background"),z.style.setProperty("transition","background 0.2s"),M.style.setProperty("padding","1rem"),A.style.setProperty("font-weight","500"),l(A,()=>x.locationLabel),C.style.setProperty("font-size","0.85rem"),C.style.setProperty("color","var(--text-muted)"),C.style.setProperty("margin-top","0.25rem"),l(C,()=>x.locationId),p.style.setProperty("padding","1rem"),p.style.setProperty("text-align","center"),p.style.setProperty("font-weight","600"),p.style.setProperty("font-size","1.1rem"),p.style.setProperty("color","#007bff"),l(p,()=>x.hblCount),$.style.setProperty("padding","1rem"),$.style.setProperty("text-align","center"),_.style.setProperty("display","inline-block"),_.style.setProperty("padding","0.25rem 0.75rem"),_.style.setProperty("background","#e7f3ff"),_.style.setProperty("border-radius","12px"),_.style.setProperty("font-weight","500"),_.style.setProperty("color","#007bff"),l(_,j,W),T.style.setProperty("padding","1rem"),T.style.setProperty("text-align","center"),c.$$click=()=>me(x.locationId),c.style.setProperty("padding","0.5rem 1rem"),(G?"#dc3545":"#007bff")!=null?c.style.setProperty("background",G?"#dc3545":"#007bff"):c.style.removeProperty("background"),c.style.setProperty("color","white"),c.style.setProperty("border","none"),c.style.setProperty("border-radius","4px"),c.style.setProperty("cursor","pointer"),c.style.setProperty("font-size","0.85rem"),l(c,G?"â–² Hide":"â–¼ View HBLs"),z})(),m(J,{when:G,get children(){var z=Ee(),M=z.firstChild,A=M.firstChild,C=A.firstChild;return C.firstChild,M.style.setProperty("padding","0"),A.style.setProperty("background","#f8f9fa"),A.style.setProperty("padding","1.5rem"),A.style.setProperty("border-top","1px solid #dee2e6"),C.style.setProperty("margin-bottom","1rem"),C.style.setProperty("font-size","1rem"),C.style.setProperty("font-weight","600"),l(C,()=>x.locationLabel,null),l(A,m(J,{get when(){return S()},get fallback(){return(()=>{var p=Fe(),$=p.firstChild,_=$.firstChild,W=_.firstChild,T=W.firstChild,c=T.nextSibling,ee=c.nextSibling,ge=_.nextSibling;return p.style.setProperty("max-height","400px"),p.style.setProperty("overflow-y","auto"),$.style.setProperty("width","100%"),$.style.setProperty("border-collapse","collapse"),$.style.setProperty("background","white"),$.style.setProperty("border-radius","4px"),$.style.setProperty("overflow","hidden"),W.style.setProperty("background","#e9ecef"),T.style.setProperty("padding","0.75rem"),T.style.setProperty("text-align","left"),T.style.setProperty("font-size","0.85rem"),c.style.setProperty("padding","0.75rem"),c.style.setProperty("text-align","left"),c.style.setProperty("font-size","0.85rem"),ee.style.setProperty("padding","0.75rem"),ee.style.setProperty("text-align","left"),ee.style.setProperty("font-size","0.85rem"),l(ge,m(oe,{get each(){return K()},children:te=>(()=>{var re=Ne(),Q=re.firstChild,Y=Q.nextSibling,se=Y.nextSibling;return re.style.setProperty("border-bottom","1px solid #e9ecef"),Q.style.setProperty("padding","0.75rem"),Q.style.setProperty("font-family","monospace"),Q.style.setProperty("font-size","0.9rem"),l(Q,()=>te.hbl),Y.style.setProperty("padding","0.75rem"),Y.style.setProperty("font-size","0.85rem"),Y.style.setProperty("color","var(--text-muted)"),l(Y,()=>le(te.lastScannedAt)),se.style.setProperty("padding","0.75rem"),se.style.setProperty("font-size","0.85rem"),l(se,()=>te.scannedBy||"-"),re})()})),p})()},get children(){var p=Te();return p.style.setProperty("padding","2rem"),p.style.setProperty("text-align","center"),p}}),null),z}})]}})),e}})]}}),null),X(e=>{var o=n(),t=n()?"#6c757d":"#007bff",s=n()?"not-allowed":"pointer";return o!==e.e&&(h.disabled=e.e=o),t!==e.t&&((e.t=t)!=null?h.style.setProperty("background",t):h.style.removeProperty("background")),s!==e.a&&((e.a=s)!=null?h.style.setProperty("cursor",s):h.style.removeProperty("cursor")),e},{e:void 0,t:void 0,a:void 0}),a})()};fe(["click","input"]);export{Ge as default};
