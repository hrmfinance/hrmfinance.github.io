import{aF as Et,aG as lr,aH as _r,aI as Ge,aJ as or,c as Z,f as bt,aK as wr,R as sr,t as B,i as e,a as f,B as ot,S as K,j as Je,b as O,h as y,F as de,v as Ae,aL as Nr,aM as zr,aN as kr,d as Fr}from"./index-BOEEaCzO.js";async function Ar(a,s,S){return new Promise((t,i)=>{const p=new FileReader;p.onload=C=>{try{const J=C.target?.result,j=Mr(J,s,S||a.name.replace(/\.csv$/i,""));t(j)}catch(J){i(J)}},p.onerror=()=>{i(new Error("Failed to read file"))},p.readAsText(a)})}function Mr(a,s,S){const t={...Et,...s,columnMapping:{...Et.columnMapping,...s?.columnMapping}};s?.delimiter||(t.delimiter=ir(a));const i=Or(a,t.delimiter);if(i.length===0)throw new Error("CSV file is empty");let p=0;if(t.skipRows&&(p+=t.skipRows),t.hasHeader){if(!s?.columnMapping&&i.length>0){const se=nr(i[p]);t.columnMapping={...t.columnMapping,...se}}p+=1}const C=[],J=t.defaultCurrency||"USD";for(let se=p;se<i.length;se++){const Ce=i[se];if(!(Ce.length===0||Ce.every(E=>!E.trim())))try{const E=Tr(Ce,t,J);E&&C.push(E)}catch(E){console.warn(`Skipping row ${se+1}: ${E}`)}}const j=C.reduce((se,Ce)=>se+Ce.totalPrice,0);return{id:lr(),supplierName:S||"Unknown Supplier",sourceFile:S||"csv-import",sourceType:"csv",uploadDate:Date.now(),products:C,currency:J,totalProducts:C.length,totalValue:j}}function ir(a){const S=a.split(`
`).slice(0,5).join(`
`),t=(S.match(/,/g)||[]).length,i=(S.match(/;/g)||[]).length,p=(S.match(/\t/g)||[]).length;return p>t&&p>i?"	":i>t?";":","}function nr(a){const s={};return a.forEach((S,t)=>{const i=S.toLowerCase().trim();(i.includes("product")||i.includes("name")||i.includes("item")||i.includes("description")&&!s.productName)&&(s.productName=t),(i.includes("code")||i.includes("product code")||i.includes("item code"))&&!i.includes("sku")&&!s.productCode&&(s.productCode=t),i.includes("sku")&&(s.sku=t),(i.includes("desc")||i==="description")&&s.productName!==t&&(s.description=t),(i.includes("unit")||i.includes("uom")||i.includes("measure"))&&(s.unit=t),(i.includes("qty")||i.includes("quantity")||i.includes("amount")&&!i.includes("price"))&&(s.quantity=t),(i.includes("price")&&i.includes("unit")||i.includes("price")&&!i.includes("total")||i==="price"||i.includes("unit price")||i.includes("price/unit"))&&(s.unitPrice=t),(i.includes("total")||i.includes("amount")&&i.includes("total")||i.includes("subtotal"))&&(s.totalPrice=t),(i.includes("category")||i.includes("type")||i.includes("group"))&&(s.category=t),(i.includes("brand")||i.includes("manufacturer")||i.includes("make"))&&(s.brand=t)}),s}function Or(a,s){const S=[],t=a.split(/\r?\n/);for(let i=0;i<t.length;i++){const p=t[i];if(!p.trim())continue;const C=[];let J="",j=!1;for(let ce=0;ce<p.length;ce++){const se=p[ce],Ce=p[ce+1];se==='"'?j&&Ce==='"'?(J+='"',ce++):j=!j:se===s&&!j?(C.push(J.trim()),J=""):J+=se}C.push(J.trim()),S.push(C)}return S}function Tr(a,s,S){const t=s.columnMapping,i=Re(a,t.productName);if(!i)return null;const p=Re(a,t.unitPrice);if(!p)return null;const C=Dt(p);if(isNaN(C))throw new Error(`Invalid unit price: ${p}`);const J=Re(a,t.productCode),j=Re(a,t.sku),ce=Re(a,t.description),se=Re(a,t.category),Ce=Re(a,t.brand);let E=1;const ee=Re(a,t.quantity);ee&&(E=Dt(ee),(isNaN(E)||E<=0)&&(E=1));let pe=s.defaultUnit||"ea";const Se=Re(a,t.unit);Se&&(pe=_r(Se));let ye;const X=Re(a,t.totalPrice);X?(ye=Dt(X),isNaN(ye)&&(ye=E*C)):ye=E*C;const te={id:or(),productName:i.trim(),normalizedName:Ge(i),unit:pe,quantity:E,unitPrice:C,totalPrice:ye,currency:S};return J&&(te.productCode=J),j&&(te.sku=j),ce&&(te.description=ce),se&&(te.category=se),Ce&&(te.brand=Ce),te}function Re(a,s){return s===void 0||s<0||s>=a.length?"":a[s]?.trim()||""}function Dt(a){if(!a)return NaN;let s=a.trim().replace(/[$â‚¬Â£Â¥â‚¹]/g,"");const S=s.lastIndexOf(","),t=s.lastIndexOf(".");return S>t?s=s.replace(/\./g,"").replace(",","."):s=s.replace(/,/g,""),parseFloat(s)}function Dr(a,s){const S=a.length,t=s.length;if(S===0)return t;if(t===0)return S;const i=Array(S+1).fill(null).map(()=>Array(t+1).fill(0));for(let p=0;p<=S;p++)i[p][0]=p;for(let p=0;p<=t;p++)i[0][p]=p;for(let p=1;p<=S;p++)for(let C=1;C<=t;C++){const J=a[p-1]===s[C-1]?0:1;i[p][C]=Math.min(i[p-1][C]+1,i[p][C-1]+1,i[p-1][C-1]+J)}return i[S][t]}function Er(a,s){if(!a||!s)return 0;if(a===s)return 100;const S=Math.max(a.length,s.length);if(S===0)return 100;const t=Dr(a,s);return Math.round((S-t)/S*100)}function qr(a,s){const S=new Set(a.toLowerCase().split(/\s+/).filter(C=>C.length>1)),t=new Set(s.toLowerCase().split(/\s+/).filter(C=>C.length>1));if(S.size===0&&t.size===0)return 100;if(S.size===0||t.size===0)return 0;const i=new Set([...S].filter(C=>t.has(C))),p=new Set([...S,...t]);return Math.round(i.size/p.size*100)}function $t(a){if(!a)return"";const s=a.replace(/\D/g,"");return s.length===0?"":s}function Ir(a,s){const S=$t(a),t=$t(s);return!S||!t?!1:S===t?!0:S.length===12&&t.length===13?"0"+S===t:S.length===13&&t.length===12?S==="0"+t:!!(S.length>6&&t.length>6&&(S.includes(t)||t.includes(S)))}function Xt(a){const s=[];return[/\b(\d{10,14})\b/g,/\b([A-Z]{2,}\d{3,})\b/gi,/\b(\d{3,}-\d{3,})\b/g,/#(\w+)\b/g].forEach(t=>{const i=a.match(t);i&&s.push(...i)}),s}function Lr(a,s){const S=$t(a.productCode||a.barcode),t=$t(s.productCode||s.barcode),i=Ir(S,t);if(i)return{score:100,matchType:"upc_match",upcMatch:!0,upcMismatch:!1,nameScore:100,details:"UPC/Barcode match"};const C=S.length>=6&&t.length>=6&&!i,J=Ge(a.productName),j=Ge(s.productName);if(J===j&&!C)return{score:100,matchType:"exact",upcMatch:!1,upcMismatch:!1,nameScore:100,details:"Exact name match"};const ce=Er(J,j),se=qr(J,j),Ce=Xt(a.productName),E=Xt(s.productName),ee=Ce.some(te=>E.some(we=>te===we));let pe;ee?pe=Math.max(ce,se,85):pe=Math.round(ce*.4+se*.6),a.brand&&s.brand&&a.brand.toLowerCase()===s.brand.toLowerCase()&&(pe=Math.min(100,pe+10));let Se=pe,ye=`Name similarity: ${pe}%`;C&&(Se=Math.round(pe*.5),ye+=` (UPC mismatch: ${S} vs ${t} - score reduced)`),ee&&!C&&(ye+=" (ID match found)");let X;return Se>=90?X="high":Se>=70?X="medium":Se>=50?X="low":X="none",{score:Se,matchType:X,upcMatch:!1,upcMismatch:C,nameScore:pe,details:ye}}function Ur(a,s=70){const S=[],t=new Set,i=[...a].sort((p,C)=>p.product.productName.localeCompare(C.product.productName));for(const p of i){if(t.has(p.product.id))continue;const C={id:`group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,representativeName:p.product.productName,representativeUpc:p.product.productCode||p.product.barcode,products:[{...p,similarity:{score:100,matchType:"exact",upcMatch:!1,upcMismatch:!1,nameScore:100,details:"Reference product"}}],matchQuality:"exact",averageSimilarity:100};t.add(p.product.id);for(const J of i){if(t.has(J.product.id)||J.supplierId===p.supplierId)continue;const j=Lr(p.product,J.product);j.score>=s&&(C.products.push({...J,similarity:j}),t.add(J.product.id),j.upcMatch&&!C.representativeUpc&&(C.representativeUpc=J.product.productCode||J.product.barcode))}if(C.products.length>1){const J=C.products.reduce((j,ce)=>j+ce.similarity.score,0);C.averageSimilarity=Math.round(J/C.products.length),C.averageSimilarity>=95?C.matchQuality="exact":C.averageSimilarity>=85?C.matchQuality="high":C.averageSimilarity>=70?C.matchQuality="medium":C.matchQuality="low"}S.push(C)}return S}function Zt(a){switch(a){case"exact":return{label:"Exact Match",color:"var(--success-color)",bgColor:"var(--success-light)"};case"high":return{label:"High Match",color:"var(--info-color)",bgColor:"var(--info-light)"};case"medium":return{label:"Similar",color:"var(--warning-color)",bgColor:"var(--warning-light)"};case"low":return{label:"Possible Match",color:"var(--text-muted)",bgColor:"var(--gray-100)"};default:return{label:"Unknown",color:"var(--text-muted)",bgColor:"var(--gray-50)"}}}function er(a){return a>=95?{label:`${a}%`,color:"var(--success-color)",bgColor:"var(--success-light)"}:a>=85?{label:`${a}%`,color:"var(--info-color)",bgColor:"var(--info-light)"}:a>=70?{label:`${a}%`,color:"var(--warning-color)",bgColor:"var(--warning-light)"}:{label:`${a}%`,color:"var(--danger-color)",bgColor:"var(--danger-light)"}}function Rr(){const[a,s]=Z([]),[S,t]=Z(70),i=E=>{s(ee=>[...ee,E])},p=E=>{s(ee=>ee.filter(pe=>pe.id!==E))},C=(E,ee)=>{s(pe=>pe.map(Se=>{if(Se.id===E){const ye={...Se,...ee};return ee.products&&(ye.totalProducts=ye.products.length,ye.totalValue=ye.products.reduce((X,te)=>X+te.totalPrice,0)),ye}return Se}))},J=()=>{s([])},j=E=>a().find(ee=>ee.id===E),ce=bt(()=>{const E=a();if(E.length===0)return[];const ee=[];E.forEach(X=>{X.products.forEach(te=>{ee.push({product:te,supplierId:X.id,supplierName:X.supplierName})})});const pe=S();return Ur(ee,pe).map(X=>{const te=X.products.map(Me=>Me.product.unitPrice),we=Math.min(...te),it=Math.max(...te),xt=te.reduce((Me,Qe)=>Me+Qe,0)/te.length,Ue=te.indexOf(we),nt=X.products[Ue],Ye=X.products[0].product;return{productName:X.representativeName,normalizedName:Ge(X.representativeName),productCode:X.representativeUpc||Ye.productCode,category:Ye.category,matchQuality:X.matchQuality,averageSimilarity:X.averageSimilarity,offers:X.products.map(Me=>{const Qe=Me.product.unitPrice===we,Ke=Qe?0:Me.product.unitPrice-we,mt=Qe?0:Ke/we*100;return{supplierId:Me.supplierId,supplierName:Me.supplierName,productOffer:Me.product,isBestPrice:Qe,priceDifference:Ke>0?Ke:void 0,priceDifferencePercent:mt>0?mt:void 0,similarity:Me.similarity}}),bestOffer:{supplierId:nt.supplierId,supplierName:nt.supplierName,price:we},averagePrice:xt,priceRange:{min:we,max:it}}}).sort((X,te)=>X.productName.localeCompare(te.productName))}),se=E=>ce().find(ee=>ee.normalizedName===E),Ce=bt(()=>{const E=a(),ee=ce(),pe=ee.reduce((X,te)=>{const we=te.priceRange.max-te.priceRange.min;return X+we},0),Se=new Set(E.flatMap(X=>X.products.map(te=>Ge(te.productName)))),ye=ee.filter(X=>X.offers.length>1).length;return{id:wr(),name:`Comparison ${new Date().toLocaleDateString()}`,createdAt:Date.now(),supplierOffers:E,comparisons:ee,summary:{totalProducts:Se.size,totalSuppliers:E.length,productsWithMultipleOffers:ye,potentialSavings:pe}}});return{offers:a,similarityThreshold:S,addSupplierOffer:i,removeSupplierOffer:p,updateSupplierOffer:C,clearAllOffers:J,getOfferById:j,setSimilarityThreshold:t,compareProducts:ce,getBestOffersForProduct:se,getComparisonResult:Ce}}const _e=Rr();async function Br(a,s,S){try{const i={query:"analyzePdfTefi",params:{pdfBase64:a,prompt:s,supplierName:S||"Unknown Supplier"}};console.log("ðŸ“„ Calling analyzePdfTefi...");const p=await sr(i);return console.log("ðŸ“„ AI Response:",p),ar(p.data||p)}catch(t){return console.error("âŒ analyzePdfTefi error:",t),{success:!1,products:[],error:t instanceof Error?t.message:"Failed to analyze PDF with AI"}}}async function Jr(a,s,S,t=!1){try{const i={prompt:s,supplierName:S||"Unknown Supplier"};t?i.csvBase64=a:i.csvContent=a;const p={query:"analyzeCsvTefi",params:i};console.log("ðŸ“Š Calling analyzeCsvTefi...");const C=await sr(p);return console.log("ðŸ“Š AI Response:",C),ar(C.data||C)}catch(i){return console.error("âŒ analyzeCsvTefi error:",i),{success:!1,products:[],error:i instanceof Error?i.message:"Failed to analyze CSV with AI"}}}async function jr(a){return new Promise((s,S)=>{const t=new FileReader;t.onload=()=>{const i=t.result,p=i.split(",")[1]||i;s(p)},t.onerror=S,t.readAsDataURL(a)})}function tr(){return`Analyze this B2B product catalog and extract ALL products.

Expected columns:
- UPC (barcode, 10-14 digits)
- IMAGE (skip)
- PRODUCT DESCRIPTION (product name)
- EXPERATION/EXPIRATION (date - optional)
- QTY IN A CASE (quantity per case)
- WHOLESALE PRICE BY CASE
- B2B CASE PRICE (use this as the final price)

Return a JSON array with this structure:
[
  {
    "productCode": "UPC number",
    "productName": "Product Description",
    "quantity": number,
    "unit": "case",
    "unitPrice": B2B_CASE_PRICE,
    "totalPrice": unitPrice * quantity,
    "currency": "USD"
  }
]

Extract ALL products. Return ONLY valid JSON, no explanations.`}function ar(a){try{let s=a;if(typeof a=="string"){let t=a.trim();t=t.replace(/^```json\s*/i,""),t=t.replace(/^```\s*/i,""),t=t.replace(/\s*```$/i,"");const i=t.match(/\[[\s\S]*\]/);if(!i)return{success:!1,products:[],error:"No JSON array found in AI response",rawResponse:a};s=JSON.parse(i[0])}return s&&s.products&&Array.isArray(s.products)&&(s=s.products),Array.isArray(s)?{success:!0,products:s.filter(t=>t&&(t.productName||t.name||t.description)).map(t=>({id:or(),productCode:t.productCode||t.upc||t.sku||t.code||void 0,productName:String(t.productName||t.name||t.description||"").trim(),quantity:parseFloat(t.quantity)||1,unit:t.unit||"case",unitPrice:parseFloat(t.unitPrice)||parseFloat(t.price)||parseFloat(t.b2bPrice)||0,totalPrice:parseFloat(t.totalPrice)||(parseFloat(t.unitPrice)||parseFloat(t.price)||0)*(parseFloat(t.quantity)||1),currency:t.currency||"USD",normalizedName:Ge(t.productName||t.name||"")})),rawResponse:JSON.stringify(a)}:{success:!1,products:[],error:"AI response is not an array",rawResponse:JSON.stringify(a)}}catch(s){return{success:!1,products:[],error:s instanceof Error?s.message:"Failed to parse AI response",rawResponse:JSON.stringify(a)}}}function Qr(a,s,S,t){const i=a.length,p=a.reduce((C,J)=>C+J.totalPrice,0);return{id:lr(),supplierName:s,sourceFile:S,sourceType:t,uploadDate:Date.now(),products:a,currency:"USD",totalProducts:i,totalValue:p}}var st=B("<div>"),rr=B("<div>Selected: <!> (<!>)"),Vr=B("<div><label>Upload File (CSV or PDF) *</label><input type=file accept=.csv,.pdf>"),Hr=B(`<div><label>Paste Product List *</label><textarea placeholder="Paste product data here. Expected formats:

Product Name    $12.99
Product Name    10    $25.00
Product Name    10    kg    $2.50    $25.00

Tip: Copy text from PDF and paste here"></textarea><div>One product per line. Use spaces or tabs to separate columns.`),Wr=B("<div><h4>AI-Powered Analysis</h4><p>Use AI to analyze complex PDFs or CSVs that don't parse correctly. The file is sent directly to the AI backend for analysis.</p><div><label>Upload File (PDF or CSV)</label><input type=file accept=.csv,.pdf></div><div><label>Analysis Prompt</label><textarea></textarea><div><button type=button>Reset to Default"),Gr=B("<div><h5>Map JSON Fields (<!> items detected)</h5><p>Match your JSON fields to the product comparison columns.</p><div><div><label>Product Name *</label><select><option value>-- Select Field --</option></select></div><div><label>Unit Price *</label><select><option value>-- Select Field --</option></select></div><div><label>Product Code</label><select><option value>-- Not Mapped --</option></select></div><div><label>Quantity</label><select><option value>-- Not Mapped --</option></select></div><div><label>Unit</label><select><option value>-- Not Mapped --</option></select></div><div><label>Total Price</label><select><option value>-- Not Mapped --</option></select></div><div><label>Category</label><select><option value>-- Not Mapped --"),Yr=B("<div><h5>Preview (first 3 items):</h5><table><thead><tr><th>Name</th><th>Code</th><th>Price</th><th>Qty</th></tr></thead><tbody>"),Kr=B(`<div><h4>JSON Product List</h4><p>Paste a JSON array of products and map the fields to the comparison columns.</p><div><label>Paste JSON Array</label><textarea placeholder="Paste JSON array here, e.g.:
[
  {&quot;name&quot;: &quot;Product A&quot;, &quot;sku&quot;: &quot;123&quot;, &quot;price&quot;: 10.99, &quot;qty&quot;: 5},
  {&quot;name&quot;: &quot;Product B&quot;, &quot;sku&quot;: &quot;456&quot;, &quot;price&quot;: 15.99, &quot;qty&quot;: 3}
]">`),Xr=B("<div>Selected: "),Zr=B("<div>Extracting text from PDF..."),el=B("<div><h5>Map PDF Columns (<!> rows detected)</h5><div><label><input type=checkbox><span>First row contains headers</span></label></div><div><div><label>Product Name *</label><select><option value>-- Select Column --</option></select></div><div><label>Unit Price *</label><select><option value>-- Select Column --</option></select></div><div><label>UPC/Code</label><select><option value>-- Not Mapped --</option></select></div><div><label>Quantity</label><select><option value>-- Not Mapped --</option></select></div><div><label>Total Price</label><select><option value>-- Not Mapped --"),tl=B("<div><h5>Preview (first 5 rows):</h5><table><thead><tr></tr></thead><tbody></tbody></table><div><span>Product Name</span><span>Price</span><span>Code"),rl=B("<div><h4>PDF Field Mapping</h4><p>Upload a PDF, extract its table data, and map columns to product fields.</p><div><label>Upload PDF File</label><input type=file accept=.pdf>"),ll=B("<div><div><label>Product Name Column</label><select></select></div><div><label>Unit Price Column</label><select></select></div><div><label>Quantity Column (optional)</label><select><option value=-1>-- Not mapped --</option></select></div><div><label>Product Code Column (optional)</label><select><option value=-1>-- Not mapped --"),ol=B("<div><div><span>CSV Configuration</span><button> Column Mapping</button></div><div>Detected <!> columns: "),sl=B('<div><h3>Add Supplier Offer</h3><div><label>Supplier Name *</label><input type=text placeholder="Enter supplier name"></div><div><label>Input Method</label><div><button type=button>Upload File</button><button type=button>Paste Text</button><button type=button>AI Analysis</button><button type=button>JSON List</button><button type=button>PDF Fields'),il=B("<div>No offers loaded yet. Upload CSV or PDF files to start comparing."),nl=B("<div><h3>Loaded Offers (<!>)"),al=B("<div><div></div><div>Total Products"),dl=B("<div><div></div><div>Suppliers"),cl=B("<div><div></div><div>Products w/ Multiple Offers"),ul=B("<div><div></div><div>Potential Savings"),pl=B("<div><select><option value>All Categories"),yl=B('<div><div><input type=text placeholder="Search products..."></div><div><label>Match Threshold:</label><input type=range min=50 max=100 step=5><span>%</span></div><div>Showing <!> of <!> products'),ml=B("<div>No products to compare. Upload at least 2 supplier offers."),gl=B("<div><table><thead><tr><th>Product </th><th>Match Score</th><th>Suppliers </th><th>Best Price </th><th>Price Range</th><th>Potential Savings </th><th>Best Supplier</th><th>Actions</th></tr></thead><tbody>"),vl=B("<div><strong>UPC/Code:</strong> "),fl=B("<div><div><h3></h3><button>Ã—</button></div><div><div><div>Best Price</div><div></div></div><div><div>Average Price</div><div></div></div><div><div>Potential Savings</div><div></div></div><div><div>Match Quality</div></div></div><h4>All Offers</h4><table><thead><tr><th>Supplier</th><th>Product Name</th><th>Match</th><th>Price</th><th>Qty</th><th>Difference</th></tr></thead><tbody>"),hl=B("<div><div><h1>Product Offers Comparison</h1><div></div></div><div><button>Upload Offers (<!>)</button><button>Compare Products"),We=B("<option>"),Pl=B("<tr><td></td><td></td><td></td><td>"),je=B("<option>: "),bl=B("<th>"),$l=B("<tr>"),xl=B("<td>"),Sl=B("<div><div><div><div></div><div> products | <!> total</div><div>Source: <!> (<!>)</div></div><button>Remove</button></div><div><table><thead><tr><th>Product</th><th>Code</th><th>Qty</th><th>Price</th><th>Total</th></tr></thead><tbody>"),Cl=B("<tr><td></td><td></td><td> </td><td></td><td>"),_l=B("<div>UPC: "),wl=B("<div><span></span><span>%"),Nl=B("<span>--"),zl=B("<tr><td><div></div></td><td><div><span></span><span></span></div></td><td><span></span></td><td></td><td> - </td><td></td><td><span></span></td><td><button>Details"),kl=B("<div><span>%"),Fl=B("<span>UPC Match"),Al=B("<span>UPC Diff"),Ml=B("<span>+<!> (<!>%)"),Ol=B("<span>Best Price"),Tl=B("<tr><td><span></span></td><td></td><td><div><span></span></div></td><td></td><td> </td><td>");const El=()=>{const[a,s]=Z("upload"),[S,t]=Z(!1),[i,p]=Z(null),[C,J]=Z(null),[j,ce]=Z("file"),[se,Ce]=Z(null),[E,ee]=Z(""),[pe,Se]=Z("csv"),[ye,X]=Z(""),[te,we]=Z(Et),[it,xt]=Z(!1),[Ue,nt]=Z([]),[Ye,St]=Z(null),[Me,Qe]=Z(tr()),[Ke,mt]=Z("pdf"),[qt,It]=Z(!1),[dr,Lt]=Z(""),[gt,vt]=Z([]),[Ve,ft]=Z([]),[$e,He]=Z({productName:"",productCode:"",quantity:"",unit:"",unitPrice:"",totalPrice:"",category:""}),[Ut,Ct]=Z([]),[_t,Rt]=Z(null),[et,Bt]=Z([]),[Xe,Jt]=Z([]),[Oe,tt]=Z({productName:"",productCode:"",quantity:"",unit:"",unitPrice:"",totalPrice:"",category:""}),[wt,jt]=Z([]),[ht,cr]=Z(!0),[Qt,Vt]=Z(!1),[rt,ur]=Z("savings"),[at,Ht]=Z("desc"),[Nt,pr]=Z(""),[zt,yr]=Z(""),[Le,kt]=Z(null),Be=()=>_e.offers(),Wt=()=>_e.compareProducts(),dt=()=>_e.getComparisonResult(),Gt=bt(()=>{const q=new Set;return Be().forEach(ze=>{ze.products.forEach(Ee=>{Ee.category&&q.add(Ee.category)})}),Array.from(q).sort()}),Ft=bt(()=>{let q=Wt();if(zt()){const Ne=zt().toLowerCase();q=q.filter(ve=>ve.productName.toLowerCase().includes(Ne)||ve.normalizedName.includes(Ne)||ve.productCode&&ve.productCode.toLowerCase().includes(Ne))}Nt()&&(q=q.filter(Ne=>Ne.category===Nt()));const ze=rt(),Ee=at();return q=[...q].sort((Ne,ve)=>{let ke=0;switch(ze){case"name":ke=Ne.productName.localeCompare(ve.productName);break;case"bestPrice":ke=(Ne.bestOffer?.price||0)-(ve.bestOffer?.price||0);break;case"savings":const lt=Ne.priceRange.max-Ne.priceRange.min,Ze=ve.priceRange.max-ve.priceRange.min;ke=lt-Ze;break;case"suppliers":ke=Ne.offers.length-ve.offers.length;break}return Ee==="asc"?ke:-ke}),q}),mr=async q=>{const Ee=q.target.files?.[0];if(!Ee)return;if(Ce(Ee),p(null),Ee.name.split(".").pop()?.toLowerCase()==="pdf")Se("pdf");else{Se("csv");try{const ve=await Ee.text(),ke=ir(ve),lt=ve.split(`
`);if(lt.length>0){const Ze=lt[0].split(ke).map(h=>h.trim().replace(/"/g,""));nt(Ze);const ct=nr(Ze);we(h=>({...h,delimiter:ke,columnMapping:{...h.columnMapping,...ct}}))}}catch(ve){console.error("Error detecting CSV config:",ve)}}if(!E()){const ve=Ee.name.replace(/\.(csv|pdf)$/i,"");ee(ve.replace(/[_-]/g," ").trim())}},gr=async()=>{if(!E()){p("Please enter a supplier name");return}if(j()==="file"){if(!se()){p("Please select a file");return}}else if(!ye().trim()){p("Please paste the product text");return}t(!0),p(null);try{let q;if(j()==="text"?q=zr(ye(),{},E()):pe()==="csv"?q=await Ar(se(),te(),E()):q=await kr(se(),{},E()),q.products.length===0)throw new Error(`No products found. Please check the format.

Expected format (one product per line):
â€¢ Product Name    $12.99
â€¢ Product Name    10    $25.00
â€¢ Product Name    10    kg    $2.50    $25.00`);_e.addSupplierOffer(q),J(`Added ${q.products.length} products from ${E()}`),setTimeout(()=>J(null),3e3),Ce(null),ee(""),X(""),nt([]),Be().length>=2&&s("compare")}catch(q){console.error("Error parsing:",q),p(q instanceof Error?q.message:"Error parsing input")}finally{t(!1)}},vr=q=>{_e.removeSupplierOffer(q)},Pt=q=>{rt()===q?Ht(ze=>ze==="asc"?"desc":"asc"):(ur(q),Ht("desc"))},qe=(q,ze="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:ze}).format(q),fr=q=>q.priceRange.min===0?0:(q.priceRange.max-q.priceRange.min)/q.priceRange.max*100,At={padding:"1.5rem","margin-bottom":"1rem"},Yt={width:"100%","border-collapse":"collapse","font-size":"0.9rem"},Te={padding:"0.75rem","text-align":"left","border-bottom":"2px solid var(--border-color)","font-weight":"600",background:"var(--gray-50)",cursor:"pointer"},De={padding:"0.75rem","border-bottom":"1px solid var(--border-color)"},ae={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},ue={display:"block","margin-bottom":"0.5rem","font-weight":"500"},Kt=q=>({padding:"0.75rem 1.5rem",background:q?"var(--primary-color)":"transparent",color:q?"white":"var(--text-primary)",border:"1px solid var(--border-color)","border-bottom":q?"none":"1px solid var(--border-color)","border-radius":"var(--border-radius-sm) var(--border-radius-sm) 0 0",cursor:"pointer","font-weight":q?"600":"400"});return(()=>{var q=hl(),ze=q.firstChild,Ee=ze.firstChild,Ne=Ee.nextSibling,ve=ze.nextSibling,ke=ve.firstChild,lt=ke.firstChild,Ze=lt.nextSibling;Ze.nextSibling;var ct=ke.nextSibling;return q.style.setProperty("padding","1rem"),q.style.setProperty("max-width","1400px"),q.style.setProperty("margin","0 auto"),ze.style.setProperty("display","flex"),ze.style.setProperty("justify-content","space-between"),ze.style.setProperty("align-items","center"),ze.style.setProperty("margin-bottom","1.5rem"),Ee.style.setProperty("font-size","1.5rem"),Ee.style.setProperty("font-weight","600"),Ne.style.setProperty("display","flex"),Ne.style.setProperty("gap","0.5rem"),e(Ne,f(K,{get when(){return Be().length>0},get children(){return f(ot,{variant:"outline",onClick:()=>_e.clearAllOffers(),children:"Clear All"})}})),ve.style.setProperty("display","flex"),ve.style.setProperty("gap","0.25rem"),ve.style.setProperty("margin-bottom","1rem"),ke.$$click=()=>s("upload"),e(ke,()=>Be().length,Ze),ct.$$click=()=>s("compare"),e(q,f(K,{get when(){return i()},get children(){var h=st();return h.style.setProperty("padding","1rem"),h.style.setProperty("background","var(--danger-light)"),h.style.setProperty("color","var(--danger-color)"),h.style.setProperty("border-radius","var(--border-radius-sm)"),h.style.setProperty("margin-bottom","1rem"),e(h,i),h}}),null),e(q,f(K,{get when(){return C()},get children(){var h=st();return h.style.setProperty("padding","1rem"),h.style.setProperty("background","var(--success-light)"),h.style.setProperty("color","var(--success-color)"),h.style.setProperty("border-radius","var(--border-radius-sm)"),h.style.setProperty("margin-bottom","1rem"),e(h,C),h}}),null),e(q,f(K,{get when(){return a()==="upload"},get children(){var h=st();return h.style.setProperty("display","grid"),h.style.setProperty("grid-template-columns","1fr 1fr"),h.style.setProperty("gap","1.5rem"),e(h,f(Je,{get children(){var T=sl(),U=T.firstChild,re=U.nextSibling,fe=re.firstChild,W=fe.nextSibling,ne=re.nextSibling,he=ne.firstChild,Pe=he.nextSibling,ie=Pe.firstChild,le=ie.nextSibling,me=le.nextSibling,ge=me.nextSibling,c=ge.nextSibling;return U.style.setProperty("margin-bottom","1.5rem"),U.style.setProperty("font-weight","600"),re.style.setProperty("margin-bottom","1rem"),W.$$input=d=>ee(d.currentTarget.value),ne.style.setProperty("margin-bottom","1rem"),Pe.style.setProperty("display","flex"),Pe.style.setProperty("gap","0.5rem"),ie.$$click=()=>ce("file"),ie.style.setProperty("flex","1"),ie.style.setProperty("padding","0.5rem 1rem"),ie.style.setProperty("border","1px solid var(--border-color)"),ie.style.setProperty("border-radius","var(--border-radius-sm)"),ie.style.setProperty("cursor","pointer"),ie.style.setProperty("font-size","0.875rem"),le.$$click=()=>ce("text"),le.style.setProperty("flex","1"),le.style.setProperty("padding","0.5rem 1rem"),le.style.setProperty("border","1px solid var(--border-color)"),le.style.setProperty("border-radius","var(--border-radius-sm)"),le.style.setProperty("cursor","pointer"),le.style.setProperty("font-size","0.875rem"),me.$$click=()=>ce("ai"),me.style.setProperty("flex","1"),me.style.setProperty("padding","0.5rem 1rem"),me.style.setProperty("border","1px solid var(--border-color)"),me.style.setProperty("border-radius","var(--border-radius-sm)"),me.style.setProperty("cursor","pointer"),me.style.setProperty("font-size","0.875rem"),ge.$$click=()=>ce("json"),ge.style.setProperty("flex","1"),ge.style.setProperty("padding","0.5rem 1rem"),ge.style.setProperty("border","1px solid var(--border-color)"),ge.style.setProperty("border-radius","var(--border-radius-sm)"),ge.style.setProperty("cursor","pointer"),ge.style.setProperty("font-size","0.875rem"),c.$$click=()=>ce("pdf-map"),c.style.setProperty("flex","1"),c.style.setProperty("padding","0.5rem 1rem"),c.style.setProperty("border","1px solid var(--border-color)"),c.style.setProperty("border-radius","var(--border-radius-sm)"),c.style.setProperty("cursor","pointer"),c.style.setProperty("font-size","0.875rem"),e(T,f(K,{get when(){return j()==="file"},get children(){var d=Vr(),I=d.firstChild,G=I.nextSibling;return d.style.setProperty("margin-bottom","1rem"),G.addEventListener("change",mr),e(d,f(K,{get when(){return se()},get children(){var F=rr(),H=F.firstChild,Q=H.nextSibling,l=Q.nextSibling,P=l.nextSibling;return P.nextSibling,F.style.setProperty("margin-top","0.5rem"),F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-muted)"),e(F,()=>se()?.name,Q),e(F,()=>pe().toUpperCase(),P),F}}),null),O(F=>{var H=ue,Q=ae;return F.e=y(I,H,F.e),F.t=y(G,Q,F.t),F},{e:void 0,t:void 0}),d}}),null),e(T,f(K,{get when(){return j()==="text"},get children(){var d=Hr(),I=d.firstChild,G=I.nextSibling,F=G.nextSibling;return d.style.setProperty("margin-bottom","1rem"),G.$$input=H=>X(H.currentTarget.value),F.style.setProperty("margin-top","0.5rem"),F.style.setProperty("font-size","0.75rem"),F.style.setProperty("color","var(--text-muted)"),O(H=>{var Q=ue,l={...ae,"min-height":"150px","font-family":"monospace","font-size":"0.8rem",resize:"vertical"};return H.e=y(I,Q,H.e),H.t=y(G,l,H.t),H},{e:void 0,t:void 0}),O(()=>G.value=ye()),d}}),null),e(T,f(K,{get when(){return j()==="ai"},get children(){var d=Wr(),I=d.firstChild,G=I.nextSibling,F=G.nextSibling,H=F.firstChild,Q=H.nextSibling,l=F.nextSibling,P=l.firstChild,n=P.nextSibling,R=n.nextSibling,k=R.firstChild;return d.style.setProperty("padding","1rem"),d.style.setProperty("background","var(--warning-light)"),d.style.setProperty("border-radius","var(--border-radius-sm)"),d.style.setProperty("margin-bottom","1rem"),I.style.setProperty("margin-bottom","0.75rem"),I.style.setProperty("color","var(--warning-color)"),G.style.setProperty("font-size","0.875rem"),G.style.setProperty("margin-bottom","1rem"),F.style.setProperty("margin-bottom","1rem"),Q.addEventListener("change",o=>{const v=o.currentTarget.files?.[0];if(!v)return;const m=v.name.split(".").pop()?.toLowerCase();if(mt(m==="pdf"?"pdf":"csv"),St(v),!E()){const r=v.name.replace(/\.(csv|pdf)$/i,"");ee(r.replace(/[_-]/g," ").trim())}}),e(F,f(K,{get when(){return Ye()},get children(){var o=rr(),v=o.firstChild,m=v.nextSibling,r=m.nextSibling,b=r.nextSibling;return b.nextSibling,o.style.setProperty("margin-top","0.5rem"),o.style.setProperty("font-size","0.875rem"),o.style.setProperty("color","var(--text-muted)"),e(o,()=>Ye()?.name,m),e(o,()=>Ke().toUpperCase(),b),o}}),null),l.style.setProperty("margin-bottom","1rem"),n.$$input=o=>Qe(o.currentTarget.value),R.style.setProperty("display","flex"),R.style.setProperty("gap","0.5rem"),R.style.setProperty("margin-top","0.5rem"),k.$$click=()=>Qe(tr()),k.style.setProperty("padding","0.25rem 0.5rem"),k.style.setProperty("border","1px solid var(--border-color)"),k.style.setProperty("border-radius","var(--border-radius-sm)"),k.style.setProperty("background","white"),k.style.setProperty("cursor","pointer"),k.style.setProperty("font-size","0.75rem"),e(d,f(ot,{variant:"primary",get disabled(){return!Ye()||!E()||qt()},onClick:async()=>{const o=Ye();if(o){It(!0),p(null);try{console.log(`ðŸ¤– Starting AI analysis for ${o.name}...`);const v=await jr(o);console.log(`ðŸ“¦ File converted to base64 (${v.length} chars)`);let m;if(Ke()==="pdf"?(console.log("ðŸ“„ Calling analyzePdfWithAI..."),m=await Br(v,Me(),E())):(console.log("ðŸ“Š Calling analyzeCsvWithAI..."),m=await Jr(v,Me(),E(),!0)),console.log("ðŸ¤– AI Result:",m),m.success&&m.products.length>0){const r=Qr(m.products,E()||"AI Analyzed",o.name,Ke());_e.addSupplierOffer(r),J(`Added ${m.products.length} products from AI analysis`),setTimeout(()=>J(null),3e3),St(null),ee(""),_e.offers().length>=2&&s("compare")}else p(m.error||"AI analysis returned no products")}catch(v){console.error("âŒ AI Analysis error:",v),p(v instanceof Error?v.message:"Failed to analyze with AI")}finally{It(!1)}}},style:{width:"100%"},get children(){return qt()?"Analyzing with AI...":"Analyze with AI"}}),null),O(o=>{var v=ue,m=ae,r=ue,b={...ae,"min-height":"100px","font-family":"monospace","font-size":"0.75rem",resize:"vertical"};return o.e=y(H,v,o.e),o.t=y(Q,m,o.t),o.a=y(P,r,o.a),o.o=y(n,b,o.o),o},{e:void 0,t:void 0,a:void 0,o:void 0}),O(()=>n.value=Me()),d}}),null),e(T,f(K,{get when(){return j()==="json"},get children(){var d=Kr(),I=d.firstChild,G=I.nextSibling,F=G.nextSibling,H=F.firstChild,Q=H.nextSibling;return d.style.setProperty("padding","1rem"),d.style.setProperty("background","var(--info-light)"),d.style.setProperty("border-radius","var(--border-radius-sm)"),d.style.setProperty("margin-bottom","1rem"),I.style.setProperty("margin-bottom","0.75rem"),I.style.setProperty("color","var(--info-color)"),G.style.setProperty("font-size","0.875rem"),G.style.setProperty("margin-bottom","1rem"),F.style.setProperty("margin-bottom","1rem"),Q.$$input=l=>{const P=l.currentTarget.value;Lt(P),p(null);try{if(!P.trim()){vt([]),ft([]),Ct([]);return}let n=JSON.parse(P);if(!Array.isArray(n))if(n.products&&Array.isArray(n.products))n=n.products;else if(n.data&&Array.isArray(n.data))n=n.data;else if(n.items&&Array.isArray(n.items))n=n.items;else throw new Error("JSON must be an array or contain a products/data/items array");vt(n),Ct(n.slice(0,3));const R=new Set;n.slice(0,10).forEach(v=>{v&&typeof v=="object"&&Object.keys(v).forEach(m=>R.add(m))});const k=Array.from(R).sort();ft(k);const o={productName:"",productCode:"",quantity:"",unit:"",unitPrice:"",totalPrice:"",category:""};k.forEach(v=>{const m=v.toLowerCase();!o.productName&&(m.includes("name")||m.includes("description")||m.includes("product"))&&(o.productName=v),!o.productCode&&(m.includes("code")||m.includes("sku")||m.includes("upc")||m.includes("barcode")||m==="id")&&(o.productCode=v),!o.quantity&&(m.includes("qty")||m.includes("quantity")||m.includes("amount"))&&(o.quantity=v),!o.unit&&(m.includes("unit")||m==="uom")&&(o.unit=v),!o.unitPrice&&(m.includes("price")||m.includes("cost"))&&!m.includes("total")&&(o.unitPrice=v),!o.totalPrice&&(m.includes("total")||m.includes("subtotal"))&&(o.totalPrice=v),!o.category&&(m.includes("category")||m.includes("type")||m.includes("group"))&&(o.category=v)}),He(o)}catch(n){P.trim()&&p(n instanceof Error?n.message:"Invalid JSON"),vt([]),ft([])}},e(d,f(K,{get when(){return Ve().length>0},get children(){return[(()=>{var l=Gr(),P=l.firstChild,n=P.firstChild,R=n.nextSibling;R.nextSibling;var k=P.nextSibling,o=k.nextSibling,v=o.firstChild,m=v.firstChild,r=m.nextSibling;r.firstChild;var b=v.nextSibling,z=b.firstChild,x=z.nextSibling;x.firstChild;var w=b.nextSibling,u=w.firstChild,N=u.nextSibling;N.firstChild;var $=w.nextSibling,_=$.firstChild,M=_.nextSibling;M.firstChild;var oe=$.nextSibling,Ie=oe.firstChild,xe=Ie.nextSibling;xe.firstChild;var A=oe.nextSibling,Fe=A.firstChild,be=Fe.nextSibling;be.firstChild;var D=A.nextSibling,Y=D.firstChild,V=Y.nextSibling;return V.firstChild,l.style.setProperty("padding","1rem"),l.style.setProperty("background","white"),l.style.setProperty("border-radius","var(--border-radius-sm)"),l.style.setProperty("margin-bottom","1rem"),P.style.setProperty("margin-bottom","0.75rem"),P.style.setProperty("font-weight","600"),e(P,()=>gt().length,R),k.style.setProperty("font-size","0.75rem"),k.style.setProperty("color","var(--text-muted)"),k.style.setProperty("margin-bottom","1rem"),o.style.setProperty("display","grid"),o.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(180px, 1fr))"),o.style.setProperty("gap","0.75rem"),r.addEventListener("change",g=>He(L=>({...L,productName:g.currentTarget.value}))),e(r,f(de,{get each(){return Ve()},children:g=>(()=>{var L=We();return L.value=g,e(L,g),L})()}),null),x.addEventListener("change",g=>He(L=>({...L,unitPrice:g.currentTarget.value}))),e(x,f(de,{get each(){return Ve()},children:g=>(()=>{var L=We();return L.value=g,e(L,g),L})()}),null),N.addEventListener("change",g=>He(L=>({...L,productCode:g.currentTarget.value}))),e(N,f(de,{get each(){return Ve()},children:g=>(()=>{var L=We();return L.value=g,e(L,g),L})()}),null),M.addEventListener("change",g=>He(L=>({...L,quantity:g.currentTarget.value}))),e(M,f(de,{get each(){return Ve()},children:g=>(()=>{var L=We();return L.value=g,e(L,g),L})()}),null),xe.addEventListener("change",g=>He(L=>({...L,unit:g.currentTarget.value}))),e(xe,f(de,{get each(){return Ve()},children:g=>(()=>{var L=We();return L.value=g,e(L,g),L})()}),null),be.addEventListener("change",g=>He(L=>({...L,totalPrice:g.currentTarget.value}))),e(be,f(de,{get each(){return Ve()},children:g=>(()=>{var L=We();return L.value=g,e(L,g),L})()}),null),V.addEventListener("change",g=>He(L=>({...L,category:g.currentTarget.value}))),e(V,f(de,{get each(){return Ve()},children:g=>(()=>{var L=We();return L.value=g,e(L,g),L})()}),null),O(g=>{var L={...ue,"font-size":"0.8rem",color:"var(--danger-color)"},ut={...ae,"font-size":"0.85rem"},pt={...ue,"font-size":"0.8rem",color:"var(--danger-color)"},yt={...ae,"font-size":"0.85rem"},Mt={...ue,"font-size":"0.8rem"},Ot={...ae,"font-size":"0.85rem"},Tt={...ue,"font-size":"0.8rem"},hr={...ae,"font-size":"0.85rem"},Pr={...ue,"font-size":"0.8rem"},br={...ae,"font-size":"0.85rem"},$r={...ue,"font-size":"0.8rem"},xr={...ae,"font-size":"0.85rem"},Sr={...ue,"font-size":"0.8rem"},Cr={...ae,"font-size":"0.85rem"};return g.e=y(m,L,g.e),g.t=y(r,ut,g.t),g.a=y(z,pt,g.a),g.o=y(x,yt,g.o),g.i=y(u,Mt,g.i),g.n=y(N,Ot,g.n),g.s=y(_,Tt,g.s),g.h=y(M,hr,g.h),g.r=y(Ie,Pr,g.r),g.d=y(xe,br,g.d),g.l=y(Fe,$r,g.l),g.u=y(be,xr,g.u),g.c=y(Y,Sr,g.c),g.w=y(V,Cr,g.w),g},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),O(()=>r.value=$e().productName),O(()=>x.value=$e().unitPrice),O(()=>N.value=$e().productCode),O(()=>M.value=$e().quantity),O(()=>xe.value=$e().unit),O(()=>be.value=$e().totalPrice),O(()=>V.value=$e().category),l})(),f(K,{get when(){return Ae(()=>Ut().length>0)()&&$e().productName},get children(){var l=Yr(),P=l.firstChild,n=P.nextSibling,R=n.firstChild,k=R.firstChild,o=k.firstChild,v=o.nextSibling,m=v.nextSibling,r=m.nextSibling,b=R.nextSibling;return l.style.setProperty("padding","0.75rem"),l.style.setProperty("background","white"),l.style.setProperty("border-radius","var(--border-radius-sm)"),l.style.setProperty("margin-bottom","1rem"),l.style.setProperty("max-height","150px"),l.style.setProperty("overflow","auto"),P.style.setProperty("margin-bottom","0.5rem"),P.style.setProperty("font-size","0.8rem"),P.style.setProperty("color","var(--text-muted)"),n.style.setProperty("width","100%"),n.style.setProperty("font-size","0.75rem"),n.style.setProperty("border-collapse","collapse"),k.style.setProperty("background","var(--gray-50)"),o.style.setProperty("padding","0.25rem 0.5rem"),o.style.setProperty("text-align","left"),o.style.setProperty("border-bottom","1px solid var(--border-color)"),v.style.setProperty("padding","0.25rem 0.5rem"),v.style.setProperty("text-align","left"),v.style.setProperty("border-bottom","1px solid var(--border-color)"),m.style.setProperty("padding","0.25rem 0.5rem"),m.style.setProperty("text-align","right"),m.style.setProperty("border-bottom","1px solid var(--border-color)"),r.style.setProperty("padding","0.25rem 0.5rem"),r.style.setProperty("text-align","right"),r.style.setProperty("border-bottom","1px solid var(--border-color)"),e(b,f(de,{get each(){return Ut()},children:z=>(()=>{var x=Pl(),w=x.firstChild,u=w.nextSibling,N=u.nextSibling,$=N.nextSibling;return w.style.setProperty("padding","0.25rem 0.5rem"),w.style.setProperty("border-bottom","1px solid var(--border-color)"),e(w,(()=>{var _=Ae(()=>!!$e().productName);return()=>_()?String(z[$e().productName]||""):"--"})()),u.style.setProperty("padding","0.25rem 0.5rem"),u.style.setProperty("border-bottom","1px solid var(--border-color)"),e(u,(()=>{var _=Ae(()=>!!$e().productCode);return()=>_()?String(z[$e().productCode]||""):"--"})()),N.style.setProperty("padding","0.25rem 0.5rem"),N.style.setProperty("text-align","right"),N.style.setProperty("border-bottom","1px solid var(--border-color)"),e(N,(()=>{var _=Ae(()=>!!$e().unitPrice);return()=>_()?`$${parseFloat(z[$e().unitPrice]||0).toFixed(2)}`:"--"})()),$.style.setProperty("padding","0.25rem 0.5rem"),$.style.setProperty("text-align","right"),$.style.setProperty("border-bottom","1px solid var(--border-color)"),e($,(()=>{var _=Ae(()=>!!$e().quantity);return()=>_()?String(z[$e().quantity]||1):"1"})()),x})()})),l}}),f(ot,{variant:"primary",get disabled(){return!E()||!$e().productName||!$e().unitPrice||gt().length===0},onClick:()=>{const l=$e(),P=gt();if(!l.productName||!l.unitPrice){p("Product Name and Unit Price fields are required");return}try{const n=P.filter(o=>o&&o[l.productName]).map(o=>{const v=String(o[l.productName]||"").trim(),m=parseFloat(o[l.unitPrice])||0,r=l.quantity&&parseFloat(o[l.quantity])||1,b=l.totalPrice&&parseFloat(o[l.totalPrice])||m*r;return{id:`json-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,productCode:l.productCode?String(o[l.productCode]||""):void 0,productName:v,quantity:r,unit:l.unit?String(o[l.unit]||"unit"):"unit",unitPrice:m,totalPrice:b,currency:"USD",category:l.category?String(o[l.category]||""):void 0,normalizedName:Ge(v)}});if(n.length===0){p("No valid products found in JSON");return}const R=n.reduce((o,v)=>o+v.totalPrice,0),k={id:`offer-${Date.now()}`,supplierName:E(),sourceFile:"json-import",sourceType:"csv",uploadDate:Date.now(),products:n,currency:"USD",totalProducts:n.length,totalValue:R};_e.addSupplierOffer(k),J(`Added ${n.length} products from JSON`),setTimeout(()=>J(null),3e3),Lt(""),vt([]),ft([]),Ct([]),ee(""),_e.offers().length>=2&&s("compare")}catch(n){p(n instanceof Error?n.message:"Failed to parse JSON")}},style:{width:"100%"},get children(){return["Add ",Ae(()=>gt().length)," Products from JSON"]}})]}}),null),O(l=>{var P=ue,n={...ae,"min-height":"120px","font-family":"monospace","font-size":"0.75rem",resize:"vertical"};return l.e=y(H,P,l.e),l.t=y(Q,n,l.t),l},{e:void 0,t:void 0}),O(()=>Q.value=dr()),d}}),null),e(T,f(K,{get when(){return j()==="pdf-map"},get children(){var d=rl(),I=d.firstChild,G=I.nextSibling,F=G.nextSibling,H=F.firstChild,Q=H.nextSibling;return d.style.setProperty("padding","1rem"),d.style.setProperty("background","var(--success-light)"),d.style.setProperty("border-radius","var(--border-radius-sm)"),d.style.setProperty("margin-bottom","1rem"),I.style.setProperty("margin-bottom","0.75rem"),I.style.setProperty("color","var(--success-color)"),G.style.setProperty("font-size","0.875rem"),G.style.setProperty("margin-bottom","1rem"),F.style.setProperty("margin-bottom","1rem"),Q.addEventListener("change",async l=>{const P=l.currentTarget.files?.[0];if(P){Rt(P),Vt(!0),p(null);try{const n=await Nr(P);console.log("ðŸ“„ Extracted PDF text:",n.substring(0,500));const R=n.split(`
`).filter(b=>b.trim()),k=[];for(const b of R){const z=b.split(/\t|  +/).map(x=>x.trim()).filter(x=>x);z.length>=2&&k.push(z)}if(k.length===0)throw new Error("No table data found in PDF. Try AI Analysis mode instead.");const o=Math.max(...k.map(b=>b.length)),v=k.map(b=>{for(;b.length<o;)b.push("");return b.slice(0,o)});Bt(v),jt(v.slice(0,5));const m=v[0].map((b,z)=>b&&b.length<30?b:`Column ${z+1}`);Jt(m);const r={productName:"",productCode:"",quantity:"",unit:"",unitPrice:"",totalPrice:"",category:""};if(m.forEach((b,z)=>{const x=b.toLowerCase(),w=`${z}`;!r.productName&&(x.includes("name")||x.includes("description")||x.includes("product"))&&(r.productName=w),!r.productCode&&(x.includes("upc")||x.includes("code")||x.includes("sku")||x.includes("barcode"))&&(r.productCode=w),!r.quantity&&(x.includes("qty")||x.includes("quantity")||x.includes("case"))&&(r.quantity=w),!r.unitPrice&&(x.includes("price")||x.includes("cost"))&&!x.includes("total")&&(r.unitPrice=w),!r.totalPrice&&(x.includes("total")||x.includes("amount"))&&(r.totalPrice=w)}),tt(r),!E()){const b=P.name.replace(/\.pdf$/i,"");ee(b.replace(/[_-]/g," ").trim())}J(`Extracted ${v.length} rows with ${o} columns from PDF`),setTimeout(()=>J(null),3e3)}catch(n){console.error("PDF parsing error:",n),p(n instanceof Error?n.message:"Failed to parse PDF")}finally{Vt(!1)}}}),e(F,f(K,{get when(){return _t()},get children(){var l=Xr();return l.firstChild,l.style.setProperty("margin-top","0.5rem"),l.style.setProperty("font-size","0.875rem"),l.style.setProperty("color","var(--text-muted)"),e(l,()=>_t()?.name,null),l}}),null),e(F,f(K,{get when(){return Qt()},get children(){var l=Zr();return l.style.setProperty("margin-top","0.5rem"),l.style.setProperty("font-size","0.875rem"),l.style.setProperty("color","var(--warning-color)"),l}}),null),e(d,f(K,{get when(){return Xe().length>0},get children(){return[(()=>{var l=el(),P=l.firstChild,n=P.firstChild,R=n.nextSibling;R.nextSibling;var k=P.nextSibling,o=k.firstChild,v=o.firstChild,m=v.nextSibling,r=k.nextSibling,b=r.firstChild,z=b.firstChild,x=z.nextSibling;x.firstChild;var w=b.nextSibling,u=w.firstChild,N=u.nextSibling;N.firstChild;var $=w.nextSibling,_=$.firstChild,M=_.nextSibling;M.firstChild;var oe=$.nextSibling,Ie=oe.firstChild,xe=Ie.nextSibling;xe.firstChild;var A=oe.nextSibling,Fe=A.firstChild,be=Fe.nextSibling;return be.firstChild,l.style.setProperty("padding","1rem"),l.style.setProperty("background","white"),l.style.setProperty("border-radius","var(--border-radius-sm)"),l.style.setProperty("margin-bottom","1rem"),P.style.setProperty("margin-bottom","0.75rem"),P.style.setProperty("font-weight","600"),e(P,()=>et().length,R),k.style.setProperty("margin-bottom","1rem"),o.style.setProperty("display","flex"),o.style.setProperty("align-items","center"),o.style.setProperty("gap","0.5rem"),o.style.setProperty("cursor","pointer"),v.addEventListener("change",D=>cr(D.currentTarget.checked)),m.style.setProperty("font-size","0.875rem"),r.style.setProperty("display","grid"),r.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(180px, 1fr))"),r.style.setProperty("gap","0.75rem"),x.addEventListener("change",D=>tt(Y=>({...Y,productName:D.currentTarget.value}))),e(x,f(de,{get each(){return Xe()},children:(D,Y)=>(()=>{var V=je(),g=V.firstChild;return e(V,Y,g),e(V,D,null),O(()=>V.value=Y()),V})()}),null),N.addEventListener("change",D=>tt(Y=>({...Y,unitPrice:D.currentTarget.value}))),e(N,f(de,{get each(){return Xe()},children:(D,Y)=>(()=>{var V=je(),g=V.firstChild;return e(V,Y,g),e(V,D,null),O(()=>V.value=Y()),V})()}),null),M.addEventListener("change",D=>tt(Y=>({...Y,productCode:D.currentTarget.value}))),e(M,f(de,{get each(){return Xe()},children:(D,Y)=>(()=>{var V=je(),g=V.firstChild;return e(V,Y,g),e(V,D,null),O(()=>V.value=Y()),V})()}),null),xe.addEventListener("change",D=>tt(Y=>({...Y,quantity:D.currentTarget.value}))),e(xe,f(de,{get each(){return Xe()},children:(D,Y)=>(()=>{var V=je(),g=V.firstChild;return e(V,Y,g),e(V,D,null),O(()=>V.value=Y()),V})()}),null),be.addEventListener("change",D=>tt(Y=>({...Y,totalPrice:D.currentTarget.value}))),e(be,f(de,{get each(){return Xe()},children:(D,Y)=>(()=>{var V=je(),g=V.firstChild;return e(V,Y,g),e(V,D,null),O(()=>V.value=Y()),V})()}),null),O(D=>{var Y={...ue,"font-size":"0.8rem",color:"var(--danger-color)"},V={...ae,"font-size":"0.85rem"},g={...ue,"font-size":"0.8rem",color:"var(--danger-color)"},L={...ae,"font-size":"0.85rem"},ut={...ue,"font-size":"0.8rem"},pt={...ae,"font-size":"0.85rem"},yt={...ue,"font-size":"0.8rem"},Mt={...ae,"font-size":"0.85rem"},Ot={...ue,"font-size":"0.8rem"},Tt={...ae,"font-size":"0.85rem"};return D.e=y(z,Y,D.e),D.t=y(x,V,D.t),D.a=y(u,g,D.a),D.o=y(N,L,D.o),D.i=y(_,ut,D.i),D.n=y(M,pt,D.n),D.s=y(Ie,yt,D.s),D.h=y(xe,Mt,D.h),D.r=y(Fe,Ot,D.r),D.d=y(be,Tt,D.d),D},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),O(()=>v.checked=ht()),O(()=>x.value=Oe().productName),O(()=>N.value=Oe().unitPrice),O(()=>M.value=Oe().productCode),O(()=>xe.value=Oe().quantity),O(()=>be.value=Oe().totalPrice),l})(),f(K,{get when(){return wt().length>0},get children(){var l=tl(),P=l.firstChild,n=P.nextSibling,R=n.firstChild,k=R.firstChild,o=R.nextSibling,v=n.nextSibling,m=v.firstChild,r=m.nextSibling,b=r.nextSibling;return l.style.setProperty("padding","0.75rem"),l.style.setProperty("background","white"),l.style.setProperty("border-radius","var(--border-radius-sm)"),l.style.setProperty("margin-bottom","1rem"),l.style.setProperty("max-height","200px"),l.style.setProperty("overflow","auto"),P.style.setProperty("margin-bottom","0.5rem"),P.style.setProperty("font-size","0.8rem"),P.style.setProperty("color","var(--text-muted)"),n.style.setProperty("width","100%"),n.style.setProperty("font-size","0.7rem"),n.style.setProperty("border-collapse","collapse"),k.style.setProperty("background","var(--gray-50)"),e(k,f(de,{get each(){return Xe()},children:(z,x)=>(()=>{var w=bl();return w.style.setProperty("padding","0.25rem 0.4rem"),w.style.setProperty("text-align","left"),w.style.setProperty("border-bottom","1px solid var(--border-color)"),w.style.setProperty("font-weight","600"),w.style.setProperty("white-space","nowrap"),e(w,z),O(u=>(u=Oe().productName===`${x()}`?"var(--success-light)":Oe().unitPrice===`${x()}`?"var(--warning-light)":Oe().productCode===`${x()}`?"var(--info-light)":"inherit")!=null?w.style.setProperty("background",u):w.style.removeProperty("background")),w})()})),e(o,f(de,{get each(){return Ae(()=>!!ht())()?wt().slice(1):wt()},children:z=>(()=>{var x=$l();return e(x,f(de,{each:z,children:(w,u)=>(()=>{var N=xl();return N.style.setProperty("padding","0.25rem 0.4rem"),N.style.setProperty("border-bottom","1px solid var(--border-color)"),N.style.setProperty("max-width","150px"),N.style.setProperty("overflow","hidden"),N.style.setProperty("text-overflow","ellipsis"),N.style.setProperty("white-space","nowrap"),e(N,w),O($=>($=Oe().productName===`${u()}`?"var(--success-light)":Oe().unitPrice===`${u()}`?"var(--warning-light)":Oe().productCode===`${u()}`?"var(--info-light)":"inherit")!=null?N.style.setProperty("background",$):N.style.removeProperty("background")),N})()})),x})()})),v.style.setProperty("margin-top","0.5rem"),v.style.setProperty("font-size","0.7rem"),v.style.setProperty("color","var(--text-muted)"),m.style.setProperty("background","var(--success-light)"),m.style.setProperty("padding","0.1rem 0.3rem"),m.style.setProperty("margin-right","0.5rem"),r.style.setProperty("background","var(--warning-light)"),r.style.setProperty("padding","0.1rem 0.3rem"),r.style.setProperty("margin-right","0.5rem"),b.style.setProperty("background","var(--info-light)"),b.style.setProperty("padding","0.1rem 0.3rem"),l}}),f(ot,{variant:"primary",get disabled(){return!E()||!Oe().productName||!Oe().unitPrice||et().length===0},onClick:()=>{const l=Oe(),P=ht()?et().slice(1):et();if(!l.productName||!l.unitPrice){p("Product Name and Unit Price columns are required");return}try{const n=parseInt(l.productName),R=parseInt(l.unitPrice),k=l.productCode?parseInt(l.productCode):-1,o=l.quantity?parseInt(l.quantity):-1,v=l.totalPrice?parseInt(l.totalPrice):-1,m=P.filter(z=>z[n]&&z[n].trim()).map(z=>{const x=z[n]?.trim()||"",w=(z[R]||"0").replace(/[$,â‚¬Â£]/g,"").trim(),u=parseFloat(w)||0,N=o>=0&&parseFloat(z[o]?.replace(/[^0-9.]/g,"")||"1")||1,$=v>=0&&parseFloat(z[v]?.replace(/[$,â‚¬Â£]/g,"")||"0")||u*N;return{id:`pdf-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,productCode:k>=0?z[k]?.trim():void 0,productName:x,quantity:N,unit:"unit",unitPrice:u,totalPrice:$,currency:"USD",normalizedName:Ge(x)}}).filter(z=>z.unitPrice>0||z.productName);if(m.length===0){p("No valid products found. Check your column mappings.");return}const r=m.reduce((z,x)=>z+x.totalPrice,0),b={id:`offer-${Date.now()}`,supplierName:E(),sourceFile:_t()?.name||"pdf-import",sourceType:"pdf",uploadDate:Date.now(),products:m,currency:"USD",totalProducts:m.length,totalValue:r};_e.addSupplierOffer(b),J(`Added ${m.length} products from PDF`),setTimeout(()=>J(null),3e3),Rt(null),Bt([]),Jt([]),jt([]),ee(""),_e.offers().length>=2&&s("compare")}catch(n){p(n instanceof Error?n.message:"Failed to parse PDF data")}},style:{width:"100%"},get children(){return["Add ",Ae(()=>Ae(()=>!!ht())()?et().length-1:et().length)," Products from PDF"]}})]}}),null),O(l=>{var P=ue,n=ae,R=Qt();return l.e=y(H,P,l.e),l.t=y(Q,n,l.t),R!==l.a&&(Q.disabled=l.a=R),l},{e:void 0,t:void 0,a:void 0}),d}}),null),e(T,f(K,{get when(){return Ae(()=>j()==="file"&&pe()==="csv")()&&Ue().length>0},get children(){var d=ol(),I=d.firstChild,G=I.firstChild,F=G.nextSibling,H=F.firstChild,Q=I.nextSibling,l=Q.firstChild,P=l.nextSibling;return P.nextSibling,d.style.setProperty("padding","1rem"),d.style.setProperty("background","var(--gray-50)"),d.style.setProperty("border-radius","var(--border-radius-sm)"),d.style.setProperty("margin-bottom","1rem"),I.style.setProperty("display","flex"),I.style.setProperty("justify-content","space-between"),I.style.setProperty("align-items","center"),I.style.setProperty("margin-bottom","0.75rem"),G.style.setProperty("font-weight","500"),F.$$click=()=>xt(!it()),F.style.setProperty("background","none"),F.style.setProperty("border","none"),F.style.setProperty("color","var(--primary-color)"),F.style.setProperty("cursor","pointer"),F.style.setProperty("font-size","0.875rem"),e(F,()=>it()?"Hide":"Show",H),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),Q.style.setProperty("margin-bottom","0.5rem"),e(Q,()=>Ue().length,P),e(Q,()=>Ue().slice(0,5).join(", "),null),e(Q,()=>Ue().length>5&&"...",null),e(d,f(K,{get when(){return it()},get children(){var n=ll(),R=n.firstChild,k=R.firstChild,o=k.nextSibling,v=R.nextSibling,m=v.firstChild,r=m.nextSibling,b=v.nextSibling,z=b.firstChild,x=z.nextSibling;x.firstChild;var w=b.nextSibling,u=w.firstChild,N=u.nextSibling;return N.firstChild,n.style.setProperty("display","grid"),n.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),n.style.setProperty("gap","0.75rem"),n.style.setProperty("margin-top","1rem"),o.addEventListener("change",$=>we(_=>({..._,columnMapping:{..._.columnMapping,productName:parseInt($.currentTarget.value)}}))),e(o,f(de,{get each(){return Ue()},children:($,_)=>(()=>{var M=je(),oe=M.firstChild;return e(M,_,oe),e(M,$,null),O(()=>M.value=_()),M})()})),r.addEventListener("change",$=>we(_=>({..._,columnMapping:{..._.columnMapping,unitPrice:parseInt($.currentTarget.value)}}))),e(r,f(de,{get each(){return Ue()},children:($,_)=>(()=>{var M=je(),oe=M.firstChild;return e(M,_,oe),e(M,$,null),O(()=>M.value=_()),M})()})),x.addEventListener("change",$=>{const _=parseInt($.currentTarget.value);we(M=>({...M,columnMapping:{...M.columnMapping,quantity:_>=0?_:void 0}}))}),e(x,f(de,{get each(){return Ue()},children:($,_)=>(()=>{var M=je(),oe=M.firstChild;return e(M,_,oe),e(M,$,null),O(()=>M.value=_()),M})()}),null),N.addEventListener("change",$=>{const _=parseInt($.currentTarget.value);we(M=>({...M,columnMapping:{...M.columnMapping,productCode:_>=0?_:void 0}}))}),e(N,f(de,{get each(){return Ue()},children:($,_)=>(()=>{var M=je(),oe=M.firstChild;return e(M,_,oe),e(M,$,null),O(()=>M.value=_()),M})()}),null),O($=>{var _={...ue,"font-size":"0.875rem"},M=ae,oe={...ue,"font-size":"0.875rem"},Ie=ae,xe={...ue,"font-size":"0.875rem"},A=ae,Fe={...ue,"font-size":"0.875rem"},be=ae;return $.e=y(k,_,$.e),$.t=y(o,M,$.t),$.a=y(m,oe,$.a),$.o=y(r,Ie,$.o),$.i=y(z,xe,$.i),$.n=y(x,A,$.n),$.s=y(u,Fe,$.s),$.h=y(N,be,$.h),$},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),O(()=>o.value=te().columnMapping.productName),O(()=>r.value=te().columnMapping.unitPrice),O(()=>x.value=te().columnMapping.quantity??-1),O(()=>N.value=te().columnMapping.productCode??-1),n}}),null),d}}),null),e(T,f(K,{get when(){return Ae(()=>j()!=="ai"&&j()!=="json")()&&j()!=="pdf-map"},get children(){return f(ot,{variant:"primary",onClick:gr,get disabled(){return S()||!E()||(j()==="file"?!se():!ye().trim())},style:{width:"100%"},get children(){return S()?"Processing...":"Add Offer"}})}}),null),O(d=>{var I=At,G=ue,F=ae,H=ue,Q=j()==="file"?"var(--primary-color)":"white",l=j()==="file"?"white":"var(--text-primary)",P=j()==="text"?"var(--primary-color)":"white",n=j()==="text"?"white":"var(--text-primary)",R=j()==="ai"?"var(--warning-color)":"white",k=j()==="ai"?"white":"var(--text-primary)",o=j()==="json"?"var(--info-color)":"white",v=j()==="json"?"white":"var(--text-primary)",m=j()==="pdf-map"?"var(--success-color)":"white",r=j()==="pdf-map"?"white":"var(--text-primary)";return d.e=y(T,I,d.e),d.t=y(fe,G,d.t),d.a=y(W,F,d.a),d.o=y(he,H,d.o),Q!==d.i&&((d.i=Q)!=null?ie.style.setProperty("background",Q):ie.style.removeProperty("background")),l!==d.n&&((d.n=l)!=null?ie.style.setProperty("color",l):ie.style.removeProperty("color")),P!==d.s&&((d.s=P)!=null?le.style.setProperty("background",P):le.style.removeProperty("background")),n!==d.h&&((d.h=n)!=null?le.style.setProperty("color",n):le.style.removeProperty("color")),R!==d.r&&((d.r=R)!=null?me.style.setProperty("background",R):me.style.removeProperty("background")),k!==d.d&&((d.d=k)!=null?me.style.setProperty("color",k):me.style.removeProperty("color")),o!==d.l&&((d.l=o)!=null?ge.style.setProperty("background",o):ge.style.removeProperty("background")),v!==d.u&&((d.u=v)!=null?ge.style.setProperty("color",v):ge.style.removeProperty("color")),m!==d.c&&((d.c=m)!=null?c.style.setProperty("background",m):c.style.removeProperty("background")),r!==d.w&&((d.w=r)!=null?c.style.setProperty("color",r):c.style.removeProperty("color")),d},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),O(()=>W.value=E()),T}}),null),e(h,f(Je,{get children(){var T=nl(),U=T.firstChild,re=U.firstChild,fe=re.nextSibling;return fe.nextSibling,U.style.setProperty("margin-bottom","1.5rem"),U.style.setProperty("font-weight","600"),e(U,()=>Be().length,fe),e(T,f(K,{get when(){return Be().length===0},get children(){var W=il();return W.style.setProperty("padding","2rem"),W.style.setProperty("text-align","center"),W.style.setProperty("color","var(--text-muted)"),W.style.setProperty("background","var(--gray-50)"),W.style.setProperty("border-radius","var(--border-radius-sm)"),W}}),null),e(T,f(de,{get each(){return Be()},children:W=>(()=>{var ne=Sl(),he=ne.firstChild,Pe=he.firstChild,ie=Pe.firstChild,le=ie.nextSibling,me=le.firstChild,ge=me.nextSibling;ge.nextSibling;var c=le.nextSibling,d=c.firstChild,I=d.nextSibling,G=I.nextSibling,F=G.nextSibling;F.nextSibling;var H=Pe.nextSibling,Q=he.nextSibling,l=Q.firstChild,P=l.firstChild,n=P.firstChild,R=n.firstChild,k=R.nextSibling,o=k.nextSibling,v=o.nextSibling,m=v.nextSibling,r=P.nextSibling;return ne.style.setProperty("border","1px solid var(--border-color)"),ne.style.setProperty("border-radius","var(--border-radius-sm)"),ne.style.setProperty("margin-bottom","0.75rem"),ne.style.setProperty("overflow","hidden"),he.style.setProperty("padding","1rem"),he.style.setProperty("background","var(--gray-50)"),he.style.setProperty("display","flex"),he.style.setProperty("justify-content","space-between"),he.style.setProperty("align-items","center"),ie.style.setProperty("font-weight","600"),e(ie,()=>W.supplierName),le.style.setProperty("font-size","0.875rem"),le.style.setProperty("color","var(--text-muted)"),e(le,()=>W.totalProducts,me),e(le,()=>qe(W.totalValue,W.currency),ge),c.style.setProperty("font-size","0.75rem"),c.style.setProperty("color","var(--text-muted)"),e(c,()=>W.sourceFile,I),e(c,()=>W.sourceType.toUpperCase(),F),H.$$click=()=>vr(W.id),H.style.setProperty("background","var(--danger-color)"),H.style.setProperty("color","white"),H.style.setProperty("border","none"),H.style.setProperty("padding","0.5rem 1rem"),H.style.setProperty("border-radius","var(--border-radius-sm)"),H.style.setProperty("cursor","pointer"),Q.style.setProperty("max-height","200px"),Q.style.setProperty("overflow","auto"),Q.style.setProperty("font-size","0.8rem"),l.style.setProperty("width","100%"),l.style.setProperty("border-collapse","collapse"),n.style.setProperty("background","var(--gray-100)"),n.style.setProperty("position","sticky"),n.style.setProperty("top","0"),R.style.setProperty("padding","0.4rem 0.6rem"),R.style.setProperty("text-align","left"),R.style.setProperty("font-weight","600"),k.style.setProperty("padding","0.4rem 0.6rem"),k.style.setProperty("text-align","left"),k.style.setProperty("font-weight","600"),o.style.setProperty("padding","0.4rem 0.6rem"),o.style.setProperty("text-align","right"),o.style.setProperty("font-weight","600"),v.style.setProperty("padding","0.4rem 0.6rem"),v.style.setProperty("text-align","right"),v.style.setProperty("font-weight","600"),m.style.setProperty("padding","0.4rem 0.6rem"),m.style.setProperty("text-align","right"),m.style.setProperty("font-weight","600"),e(r,f(de,{get each(){return W.products},children:(b,z)=>(()=>{var x=Cl(),w=x.firstChild,u=w.nextSibling,N=u.nextSibling,$=N.firstChild,_=N.nextSibling,M=_.nextSibling;return x.style.setProperty("border-bottom","1px solid var(--border-color)"),w.style.setProperty("padding","0.4rem 0.6rem"),w.style.setProperty("max-width","200px"),w.style.setProperty("overflow","hidden"),w.style.setProperty("text-overflow","ellipsis"),w.style.setProperty("white-space","nowrap"),e(w,()=>b.productName),u.style.setProperty("padding","0.4rem 0.6rem"),u.style.setProperty("color","var(--text-muted)"),u.style.setProperty("font-family","monospace"),u.style.setProperty("font-size","0.75rem"),e(u,()=>b.productCode||"-"),N.style.setProperty("padding","0.4rem 0.6rem"),N.style.setProperty("text-align","right"),e(N,()=>b.quantity,$),e(N,()=>b.unit,null),_.style.setProperty("padding","0.4rem 0.6rem"),_.style.setProperty("text-align","right"),_.style.setProperty("font-weight","500"),e(_,()=>qe(b.unitPrice)),M.style.setProperty("padding","0.4rem 0.6rem"),M.style.setProperty("text-align","right"),e(M,()=>qe(b.totalPrice)),O(oe=>(oe=z()%2===0?"white":"var(--gray-50)")!=null?x.style.setProperty("background",oe):x.style.removeProperty("background")),x})()})),ne})()}),null),e(T,f(K,{get when(){return Be().length>=2},get children(){return f(ot,{variant:"primary",onClick:()=>s("compare"),style:{width:"100%","margin-top":"1rem"},children:"Compare Offers"})}}),null),O(W=>y(T,At,W)),T}}),null),h}}),null),e(q,f(K,{get when(){return a()==="compare"},get children(){return[f(K,{get when(){return dt()},get children(){var h=st();return h.style.setProperty("display","grid"),h.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),h.style.setProperty("gap","1rem"),h.style.setProperty("margin-bottom","1.5rem"),e(h,f(Je,{get children(){var T=al(),U=T.firstChild,re=U.nextSibling;return T.style.setProperty("padding","1rem"),T.style.setProperty("text-align","center"),U.style.setProperty("font-size","2rem"),U.style.setProperty("font-weight","700"),U.style.setProperty("color","var(--primary-color)"),e(U,()=>dt().summary.totalProducts),re.style.setProperty("color","var(--text-muted)"),T}}),null),e(h,f(Je,{get children(){var T=dl(),U=T.firstChild,re=U.nextSibling;return T.style.setProperty("padding","1rem"),T.style.setProperty("text-align","center"),U.style.setProperty("font-size","2rem"),U.style.setProperty("font-weight","700"),U.style.setProperty("color","var(--info-color)"),e(U,()=>dt().summary.totalSuppliers),re.style.setProperty("color","var(--text-muted)"),T}}),null),e(h,f(Je,{get children(){var T=cl(),U=T.firstChild,re=U.nextSibling;return T.style.setProperty("padding","1rem"),T.style.setProperty("text-align","center"),U.style.setProperty("font-size","2rem"),U.style.setProperty("font-weight","700"),U.style.setProperty("color","var(--warning-color)"),e(U,()=>dt().summary.productsWithMultipleOffers),re.style.setProperty("color","var(--text-muted)"),T}}),null),e(h,f(Je,{get children(){var T=ul(),U=T.firstChild,re=U.nextSibling;return T.style.setProperty("padding","1rem"),T.style.setProperty("text-align","center"),U.style.setProperty("font-size","2rem"),U.style.setProperty("font-weight","700"),U.style.setProperty("color","var(--success-color)"),e(U,()=>qe(dt().summary.potentialSavings)),re.style.setProperty("color","var(--text-muted)"),T}}),null),h}}),f(Je,{get children(){var h=yl(),T=h.firstChild,U=T.firstChild,re=T.nextSibling,fe=re.firstChild,W=fe.nextSibling,ne=W.nextSibling,he=ne.firstChild,Pe=re.nextSibling,ie=Pe.firstChild,le=ie.nextSibling,me=le.nextSibling,ge=me.nextSibling;return ge.nextSibling,h.style.setProperty("padding","1rem"),h.style.setProperty("display","flex"),h.style.setProperty("gap","1rem"),h.style.setProperty("flex-wrap","wrap"),h.style.setProperty("align-items","center"),T.style.setProperty("flex","1"),T.style.setProperty("min-width","200px"),U.$$input=c=>yr(c.currentTarget.value),e(h,f(K,{get when(){return Gt().length>0},get children(){var c=pl(),d=c.firstChild;return d.firstChild,d.addEventListener("change",I=>pr(I.currentTarget.value)),e(d,f(de,{get each(){return Gt()},children:I=>(()=>{var G=We();return G.value=I,e(G,I),G})()}),null),O(I=>y(d,ae,I)),O(()=>d.value=Nt()),c}}),re),re.style.setProperty("display","flex"),re.style.setProperty("align-items","center"),re.style.setProperty("gap","0.5rem"),fe.style.setProperty("font-size","0.8rem"),fe.style.setProperty("white-space","nowrap"),W.$$input=c=>_e.setSimilarityThreshold(parseInt(c.currentTarget.value)),W.style.setProperty("width","100px"),ne.style.setProperty("font-size","0.8rem"),ne.style.setProperty("font-weight","600"),ne.style.setProperty("min-width","35px"),e(ne,()=>_e.similarityThreshold(),he),Pe.style.setProperty("font-size","0.875rem"),Pe.style.setProperty("color","var(--text-muted)"),e(Pe,()=>Ft().length,le),e(Pe,()=>Wt().length,ge),O(c=>{var d=ae,I=_e.similarityThreshold()>=90?"var(--success-color)":_e.similarityThreshold()>=70?"var(--warning-color)":"var(--danger-color)";return c.e=y(U,d,c.e),I!==c.t&&((c.t=I)!=null?ne.style.setProperty("color",I):ne.style.removeProperty("color")),c},{e:void 0,t:void 0}),O(()=>U.value=zt()),O(()=>W.value=_e.similarityThreshold()),h}}),f(Je,{get children(){var h=gl(),T=h.firstChild,U=T.firstChild,re=U.firstChild,fe=re.firstChild;fe.firstChild;var W=fe.nextSibling,ne=W.nextSibling;ne.firstChild;var he=ne.nextSibling;he.firstChild;var Pe=he.nextSibling,ie=Pe.nextSibling;ie.firstChild;var le=ie.nextSibling,me=le.nextSibling,ge=U.nextSibling;return h.style.setProperty("padding","1rem"),h.style.setProperty("overflow-x","auto"),fe.$$click=()=>Pt("name"),e(fe,(()=>{var c=Ae(()=>rt()==="name");return()=>c()&&(at()==="asc"?"â†‘":"â†“")})(),null),ne.$$click=()=>Pt("suppliers"),e(ne,(()=>{var c=Ae(()=>rt()==="suppliers");return()=>c()&&(at()==="asc"?"â†‘":"â†“")})(),null),he.$$click=()=>Pt("bestPrice"),e(he,(()=>{var c=Ae(()=>rt()==="bestPrice");return()=>c()&&(at()==="asc"?"â†‘":"â†“")})(),null),ie.$$click=()=>Pt("savings"),e(ie,(()=>{var c=Ae(()=>rt()==="savings");return()=>c()&&(at()==="asc"?"â†‘":"â†“")})(),null),e(ge,f(de,{get each(){return Ft()},children:c=>{const d=Zt(c.matchQuality),I=er(c.averageSimilarity);return(()=>{var G=zl(),F=G.firstChild,H=F.firstChild,Q=F.nextSibling,l=Q.firstChild,P=l.firstChild,n=P.nextSibling,R=Q.nextSibling,k=R.firstChild,o=R.nextSibling,v=o.nextSibling,m=v.firstChild,r=v.nextSibling,b=r.nextSibling,z=b.firstChild,x=b.nextSibling,w=x.firstChild;return H.style.setProperty("font-weight","500"),e(H,()=>c.productName),e(F,f(K,{get when(){return c.productCode},get children(){var u=_l();return u.firstChild,u.style.setProperty("font-size","0.75rem"),u.style.setProperty("color","var(--text-muted)"),e(u,()=>c.productCode,null),u}}),null),l.style.setProperty("display","flex"),l.style.setProperty("flex-direction","column"),l.style.setProperty("gap","0.25rem"),P.style.setProperty("padding","0.15rem 0.4rem"),P.style.setProperty("border-radius","var(--border-radius-sm)"),P.style.setProperty("font-size","0.7rem"),P.style.setProperty("font-weight","600"),P.style.setProperty("text-align","center"),e(P,()=>d.label),n.style.setProperty("padding","0.1rem 0.3rem"),n.style.setProperty("border-radius","var(--border-radius-sm)"),n.style.setProperty("font-size","0.7rem"),n.style.setProperty("text-align","center"),e(n,()=>I.label),k.style.setProperty("padding","0.25rem 0.5rem"),k.style.setProperty("border-radius","var(--border-radius-sm)"),k.style.setProperty("font-size","0.875rem"),e(k,()=>c.offers.length),e(o,()=>qe(c.bestOffer?.price||0)),e(v,()=>qe(c.priceRange.min),m),e(v,()=>qe(c.priceRange.max),null),e(r,f(K,{get when(){return c.offers.length>1},get children(){var u=wl(),N=u.firstChild,$=N.nextSibling,_=$.firstChild;return u.style.setProperty("display","flex"),u.style.setProperty("align-items","center"),u.style.setProperty("gap","0.5rem"),N.style.setProperty("font-weight","600"),N.style.setProperty("color","var(--success-color)"),e(N,()=>qe(c.priceRange.max-c.priceRange.min)),$.style.setProperty("font-size","0.75rem"),$.style.setProperty("color","var(--success-color)"),$.style.setProperty("background","var(--success-light)"),$.style.setProperty("padding","0.125rem 0.375rem"),$.style.setProperty("border-radius","var(--border-radius-sm)"),e($,()=>fr(c).toFixed(1),_),u}}),null),e(r,f(K,{get when(){return c.offers.length<=1},get children(){var u=Nl();return u.style.setProperty("color","var(--text-muted)"),u}}),null),z.style.setProperty("color","var(--primary-color)"),z.style.setProperty("font-weight","500"),e(z,()=>c.bestOffer?.supplierName||"--"),w.$$click=()=>kt(c),w.style.setProperty("background","var(--primary-color)"),w.style.setProperty("color","white"),w.style.setProperty("border","none"),w.style.setProperty("padding","0.375rem 0.75rem"),w.style.setProperty("border-radius","var(--border-radius-sm)"),w.style.setProperty("cursor","pointer"),w.style.setProperty("font-size","0.875rem"),O(u=>{var N=De,$=De,_=d.bgColor,M=d.color,oe=I.bgColor,Ie=I.color,xe=De,A=c.offers.length>1?"var(--success-light)":"var(--gray-100)",Fe={...De,"font-weight":"600",color:"var(--success-color)"},be=De,D=De,Y=De,V=De;return u.e=y(F,N,u.e),u.t=y(Q,$,u.t),_!==u.a&&((u.a=_)!=null?P.style.setProperty("background",_):P.style.removeProperty("background")),M!==u.o&&((u.o=M)!=null?P.style.setProperty("color",M):P.style.removeProperty("color")),oe!==u.i&&((u.i=oe)!=null?n.style.setProperty("background",oe):n.style.removeProperty("background")),Ie!==u.n&&((u.n=Ie)!=null?n.style.setProperty("color",Ie):n.style.removeProperty("color")),u.s=y(R,xe,u.s),A!==u.h&&((u.h=A)!=null?k.style.setProperty("background",A):k.style.removeProperty("background")),u.r=y(o,Fe,u.r),u.d=y(v,be,u.d),u.l=y(r,D,u.l),u.u=y(b,Y,u.u),u.c=y(x,V,u.c),u},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0}),G})()}})),e(h,f(K,{get when(){return Ft().length===0},get children(){var c=ml();return c.style.setProperty("padding","2rem"),c.style.setProperty("text-align","center"),c.style.setProperty("color","var(--text-muted)"),c}}),null),O(c=>{var d=Yt,I=Te,G=Te,F=Te,H=Te,Q=Te,l=Te,P=Te,n=Te;return c.e=y(T,d,c.e),c.t=y(fe,I,c.t),c.a=y(W,G,c.a),c.o=y(ne,F,c.o),c.i=y(he,H,c.i),c.n=y(Pe,Q,c.n),c.s=y(ie,l,c.s),c.h=y(le,P,c.h),c.r=y(me,n,c.r),c},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),h}})]}}),null),e(q,f(K,{get when(){return Le()},get children(){var h=st();return h.$$click=()=>kt(null),h.style.setProperty("position","fixed"),h.style.setProperty("top","0"),h.style.setProperty("left","0"),h.style.setProperty("right","0"),h.style.setProperty("bottom","0"),h.style.setProperty("background","rgba(0,0,0,0.5)"),h.style.setProperty("display","flex"),h.style.setProperty("justify-content","center"),h.style.setProperty("align-items","center"),h.style.setProperty("z-index","1000"),e(h,f(Je,{style:{width:"90%","max-width":"700px","max-height":"80vh",overflow:"auto"},get children(){var T=fl(),U=T.firstChild,re=U.firstChild,fe=re.nextSibling,W=U.nextSibling,ne=W.firstChild,he=ne.firstChild,Pe=he.nextSibling,ie=ne.nextSibling,le=ie.firstChild,me=le.nextSibling,ge=ie.nextSibling,c=ge.firstChild,d=c.nextSibling,I=ge.nextSibling,G=I.firstChild,F=W.nextSibling,H=F.nextSibling,Q=H.firstChild,l=Q.firstChild,P=l.firstChild,n=P.nextSibling,R=n.nextSibling,k=R.nextSibling,o=k.nextSibling,v=o.nextSibling,m=Q.nextSibling;return T.$$click=r=>r.stopPropagation(),U.style.setProperty("display","flex"),U.style.setProperty("justify-content","space-between"),U.style.setProperty("align-items","center"),U.style.setProperty("margin-bottom","1.5rem"),re.style.setProperty("font-weight","600"),e(re,()=>Le()?.productName),fe.$$click=()=>kt(null),fe.style.setProperty("background","none"),fe.style.setProperty("border","none"),fe.style.setProperty("font-size","1.5rem"),fe.style.setProperty("cursor","pointer"),fe.style.setProperty("color","var(--text-muted)"),W.style.setProperty("display","grid"),W.style.setProperty("grid-template-columns","repeat(4, 1fr)"),W.style.setProperty("gap","1rem"),W.style.setProperty("margin-bottom","1.5rem"),W.style.setProperty("padding","1rem"),W.style.setProperty("background","var(--gray-50)"),W.style.setProperty("border-radius","var(--border-radius-sm)"),he.style.setProperty("font-size","0.875rem"),he.style.setProperty("color","var(--text-muted)"),Pe.style.setProperty("font-size","1.25rem"),Pe.style.setProperty("font-weight","700"),Pe.style.setProperty("color","var(--success-color)"),e(Pe,()=>qe(Le()?.bestOffer?.price||0)),le.style.setProperty("font-size","0.875rem"),le.style.setProperty("color","var(--text-muted)"),me.style.setProperty("font-size","1.25rem"),me.style.setProperty("font-weight","600"),e(me,()=>qe(Le()?.averagePrice||0)),c.style.setProperty("font-size","0.875rem"),c.style.setProperty("color","var(--text-muted)"),d.style.setProperty("font-size","1.25rem"),d.style.setProperty("font-weight","600"),d.style.setProperty("color","var(--success-color)"),e(d,()=>qe((Le()?.priceRange.max||0)-(Le()?.priceRange.min||0))),G.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","var(--text-muted)"),e(I,()=>{const r=Zt(Le()?.matchQuality||"exact");return(()=>{var b=kl(),z=b.firstChild,x=z.firstChild;return b.style.setProperty("font-size","1rem"),b.style.setProperty("font-weight","600"),b.style.setProperty("display","flex"),b.style.setProperty("align-items","center"),b.style.setProperty("gap","0.5rem"),e(b,()=>r.label,z),z.style.setProperty("font-size","0.8rem"),z.style.setProperty("padding","0.1rem 0.4rem"),z.style.setProperty("border-radius","var(--border-radius-sm)"),e(z,()=>Le()?.averageSimilarity||100,x),O(w=>{var u=r.color,N=r.bgColor;return u!==w.e&&((w.e=u)!=null?b.style.setProperty("color",u):b.style.removeProperty("color")),N!==w.t&&((w.t=N)!=null?z.style.setProperty("background",N):z.style.removeProperty("background")),w},{e:void 0,t:void 0}),b})()},null),e(T,f(K,{get when(){return Le()?.productCode},get children(){var r=vl(),b=r.firstChild;return b.nextSibling,r.style.setProperty("padding","0.5rem 1rem"),r.style.setProperty("background","var(--info-light)"),r.style.setProperty("border-radius","var(--border-radius-sm)"),r.style.setProperty("margin-bottom","1rem"),r.style.setProperty("font-size","0.875rem"),e(r,()=>Le()?.productCode,null),r}}),F),F.style.setProperty("margin-bottom","1rem"),F.style.setProperty("font-weight","600"),e(m,f(de,{get each(){return Le()?.offers.sort((r,b)=>r.productOffer.unitPrice-b.productOffer.unitPrice)},children:r=>{const b=er(r.similarity?.score||100);return(()=>{var z=Tl(),x=z.firstChild,w=x.firstChild,u=x.nextSibling,N=u.nextSibling,$=N.firstChild,_=$.firstChild,M=N.nextSibling,oe=M.nextSibling,Ie=oe.firstChild,xe=oe.nextSibling;return e(w,()=>r.supplierName,null),e(w,()=>r.isBestPrice&&" â­",null),e(u,()=>r.productOffer.productName,null),e(u,f(K,{get when(){return r.productOffer.productCode},get children(){var A=st();return A.style.setProperty("font-size","0.7rem"),A.style.setProperty("color","var(--text-muted)"),e(A,()=>r.productOffer.productCode),A}}),null),$.style.setProperty("display","flex"),$.style.setProperty("flex-direction","column"),$.style.setProperty("gap","0.15rem"),_.style.setProperty("padding","0.1rem 0.3rem"),_.style.setProperty("border-radius","var(--border-radius-sm)"),_.style.setProperty("font-size","0.7rem"),_.style.setProperty("text-align","center"),e(_,()=>b.label),e($,f(K,{get when(){return r.similarity?.upcMatch},get children(){var A=Fl();return A.style.setProperty("font-size","0.65rem"),A.style.setProperty("color","var(--success-color)"),A.style.setProperty("text-align","center"),A}}),null),e($,f(K,{get when(){return r.similarity?.upcMismatch},get children(){var A=Al();return A.style.setProperty("font-size","0.65rem"),A.style.setProperty("color","var(--danger-color)"),A.style.setProperty("text-align","center"),A}}),null),e(M,()=>qe(r.productOffer.unitPrice)),e(oe,()=>r.productOffer.quantity,Ie),e(oe,()=>r.productOffer.unit,null),e(xe,f(K,{get when(){return!r.isBestPrice&&r.priceDifference},get children(){var A=Ml(),Fe=A.firstChild,be=Fe.nextSibling,D=be.nextSibling,Y=D.nextSibling;return Y.nextSibling,A.style.setProperty("color","var(--danger-color)"),e(A,()=>qe(r.priceDifference),be),e(A,()=>r.priceDifferencePercent?.toFixed(1),Y),A}}),null),e(xe,f(K,{get when(){return r.isBestPrice},get children(){var A=Ol();return A.style.setProperty("color","var(--success-color)"),A}}),null),O(A=>{var Fe=r.isBestPrice?"var(--success-light)":"transparent",be=De,D=r.isBestPrice?"600":"400",Y={...De,"font-size":"0.8rem"},V=De,g=b.bgColor,L=b.color,ut={...De,"font-weight":"600"},pt=De,yt=De;return Fe!==A.e&&((A.e=Fe)!=null?z.style.setProperty("background",Fe):z.style.removeProperty("background")),A.t=y(x,be,A.t),D!==A.a&&((A.a=D)!=null?w.style.setProperty("font-weight",D):w.style.removeProperty("font-weight")),A.o=y(u,Y,A.o),A.i=y(N,V,A.i),g!==A.n&&((A.n=g)!=null?_.style.setProperty("background",g):_.style.removeProperty("background")),L!==A.s&&((A.s=L)!=null?_.style.setProperty("color",L):_.style.removeProperty("color")),A.h=y(M,ut,A.h),A.r=y(oe,pt,A.r),A.d=y(xe,yt,A.d),A},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),z})()}})),O(r=>{var b=At,z=Yt,x=Te,w=Te,u=Te,N=Te,$=Te,_=Te;return r.e=y(T,b,r.e),r.t=y(H,z,r.t),r.a=y(P,x,r.a),r.o=y(n,w,r.o),r.i=y(R,u,r.i),r.n=y(k,N,r.n),r.s=y(o,$,r.s),r.h=y(v,_,r.h),r},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),T}})),h}}),null),O(h=>{var T=Kt(a()==="upload"),U=Kt(a()==="compare"),re=Be().length<2;return h.e=y(ke,T,h.e),h.t=y(ct,U,h.t),re!==h.a&&(ct.disabled=h.a=re),h},{e:void 0,t:void 0,a:void 0}),q})()};Fr(["click","input"]);export{El as default};
