import{O as ie,s as me,c as T,f as Pe,o as ue,t as m,i as l,a as g,F as se,b as W,j as F,S as Q,v as ne,d as he}from"./index-fjqJWr9C.js";async function fe(r){try{const d={":search0":r?.searchTerm||"230"};return r?.guia&&r.guia!=="all"&&(d.guia=r.guia),(await ie({query:"getScanYabaHbls",queryString:"!* contain :search0 AND guia = guia",params:d,limit:1e4})).data||[]}catch(d){return console.error("Error fetching all HBLs:",d),[]}}function ae(r){return!r.scannedLocations||r.scannedLocations.length===0?null:[...r.scannedLocations].sort((n,f)=>{const b=new Date(n.scannedAt).getTime();return new Date(f.scannedAt).getTime()-b})[0]}function be(r){return me.find(n=>n.id===r)?.label||r}async function ve(r){try{console.log("ğŸ“Š Fetching all HBLs for location summary...",r),console.log(r);let d="",n={};r?.guia&&(d+=" "+r?.guia),r?.searchTerm&&(d+=" "+r?.searchTerm),d&&d.split(" ").map((L,w)=>{L&&(n[":search"+w]=L.trim())});let f={query:"getScannedLocations",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4 AND !* contain :search5",params:n};const b=await ie(f);console.log(f),console.log(b);let P=[];console.log(`âœ… Fetched ${P.length} HBLs`);const E=new Map;for(const L of P){const w=ae(L);if(!w)continue;const A=w.locationId;E.has(A)||E.set(A,{locationId:A,locationLabel:be(A),hblCount:0,hbls:[]});const N=E.get(A);N.hblCount++,N.hbls.push({hbl:L.hbl,lastScannedAt:new Date(w.scannedAt),scannedBy:w.scannedBy})}const M=Array.from(E.values()).sort((L,w)=>w.hblCount-L.hblCount),Y={totalHBLs:P.length,locations:M,lastUpdated:new Date};return console.log("âœ… Location summary generated:",{totalHBLs:Y.totalHBLs,totalLocations:M.length}),Y}catch(d){throw console.error("âŒ Error grouping HBLs by location:",d),d}}async function xe(r,d){try{const n=await fe(d),f=[];for(const b of n){const P=ae(b);P&&P.locationId===r&&f.push({hbl:b.hbl,lastScannedAt:new Date(P.scannedAt),scannedBy:P.scannedBy})}return f.sort((b,P)=>P.lastScannedAt.getTime()-b.lastScannedAt.getTime()),f}catch(n){return console.error(`Error getting HBLs for location ${r}:`,n),[]}}var $e=m('<div><div><label>ğŸ“‹ Guide Number</label><select><option value=all>All Guides</option></select></div><div><label>ğŸ” Search HBL</label><input type=text placeholder="Enter HBL prefix or number..."></div><div><button>'),_e=m("<div>âŒ "),Le=m("<div><div>ğŸ“¦</div><div>Loading HBL location summary..."),we=m("<div><div></div><div>Total HBLs"),Se=m("<div><div></div><div>Active Locations"),Ce=m("<div><div>Last Updated</div><div>"),Be=m("<div>"),He=m("<div><h2>HBLs by Location</h2><div><table><thead><tr><th>Location</th><th>HBL Count</th><th>Percentage</th><th>Actions</th></tr></thead><tbody>"),ke=m("<div><div><div><h1>ğŸ“Š HBL Location Summary</h1><p>View all HBLs grouped by their last scanned location</p></div><button>"),ze=m("<option>Guide No. "),Ae=m("<tr><td><div></div><div></div></td><td></td><td><div>%</div></td><td><button>"),De=m("<div>Loading HBL details..."),Te=m("<tr><td colspan=4><div><h4>HBLs in "),Ee=m("<div><table><thead><tr><th>HBL Number</th><th>Last Scanned</th><th>Scanned By</th></tr></thead><tbody>"),Fe=m("<tr><td></td><td></td><td>");const qe=()=>{const[r,d]=T(null),[n,f]=T(!1),[b,P]=T(null),[E,M]=T(null),[Y,L]=T([]),[w,A]=T(!1),[N,ye]=T("230"),[R,de]=T("all"),pe=Pe(()=>[2518,2519,2520,2521,2522,2523,2524,2525,2526]),X=async()=>{try{f(!0),P(null);const a={searchTerm:N().trim()||"230",guia:R()!=="all"?R():void 0},v=await ve(a);d(v)}catch(a){console.error("Error loading location summary:",a),P("Failed to load location summary")}finally{f(!1)}},ce=async a=>{if(E()===a)M(null),L([]);else{M(a),A(!0);try{const v={searchTerm:N().trim()||"230",guia:R()!=="all"?R():void 0},J=await xe(a,v);L(J)}catch(v){console.error("Error loading location details:",v)}finally{A(!1)}}};ue(()=>{X()});const oe=a=>new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(a);return(()=>{var a=ke(),v=a.firstChild,J=v.firstChild,U=J.firstChild,le=U.nextSibling,h=J.nextSibling;return a.style.setProperty("padding","2rem"),a.style.setProperty("max-width","1400px"),a.style.setProperty("margin","0 auto"),v.style.setProperty("margin-bottom","2rem"),v.style.setProperty("display","flex"),v.style.setProperty("justify-content","space-between"),v.style.setProperty("align-items","center"),U.style.setProperty("font-size","2rem"),U.style.setProperty("font-weight","700"),U.style.setProperty("margin-bottom","0.5rem"),U.style.setProperty("color","var(--text-primary)"),le.style.setProperty("color","var(--text-muted)"),le.style.setProperty("font-size","1rem"),h.$$click=X,h.style.setProperty("padding","0.75rem 1.5rem"),h.style.setProperty("color","white"),h.style.setProperty("border","none"),h.style.setProperty("border-radius","6px"),h.style.setProperty("font-weight","500"),h.style.setProperty("font-size","1rem"),l(h,()=>n()?"ğŸ”„ Loading...":"ğŸ”„ Refresh"),l(a,g(F,{get children(){var e=$e(),o=e.firstChild,t=o.firstChild,s=t.nextSibling;s.firstChild;var I=o.nextSibling,C=I.firstChild,u=C.nextSibling,B=I.nextSibling,i=B.firstChild;return e.style.setProperty("padding","1.5rem"),e.style.setProperty("display","grid"),e.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),e.style.setProperty("gap","1rem"),e.style.setProperty("margin-bottom","1rem"),t.style.setProperty("display","block"),t.style.setProperty("margin-bottom","0.5rem"),t.style.setProperty("font-weight","500"),t.style.setProperty("color","var(--text-primary)"),s.addEventListener("change",y=>de(y.currentTarget.value)),s.style.setProperty("width","100%"),s.style.setProperty("padding","0.5rem"),s.style.setProperty("border","1px solid var(--border-color)"),s.style.setProperty("border-radius","6px"),s.style.setProperty("font-family","inherit"),s.style.setProperty("background","var(--surface-color)"),l(s,g(se,{get each(){return pe()},children:y=>(()=>{var H=ze();return H.firstChild,H.value=y,l(H,y,null),H})()}),null),C.style.setProperty("display","block"),C.style.setProperty("margin-bottom","0.5rem"),C.style.setProperty("font-weight","500"),C.style.setProperty("color","var(--text-primary)"),u.$$input=y=>ye(y.currentTarget.value),u.style.setProperty("width","100%"),u.style.setProperty("padding","0.5rem"),u.style.setProperty("border","1px solid var(--border-color)"),u.style.setProperty("border-radius","6px"),u.style.setProperty("font-family","inherit"),u.style.setProperty("background","var(--surface-color)"),B.style.setProperty("display","flex"),B.style.setProperty("align-items","flex-end"),i.$$click=X,i.style.setProperty("width","100%"),i.style.setProperty("padding","0.5rem 1rem"),i.style.setProperty("color","white"),i.style.setProperty("border","none"),i.style.setProperty("border-radius","6px"),i.style.setProperty("font-weight","500"),i.style.setProperty("font-size","0.95rem"),l(i,()=>n()?"â³ Searching...":"ğŸ” Search"),W(y=>{var H=n(),x=n()?"#6c757d":"#28a745",j=n()?"not-allowed":"pointer";return H!==y.e&&(i.disabled=y.e=H),x!==y.t&&((y.t=x)!=null?i.style.setProperty("background",x):i.style.removeProperty("background")),j!==y.a&&((y.a=j)!=null?i.style.setProperty("cursor",j):i.style.removeProperty("cursor")),y},{e:void 0,t:void 0,a:void 0}),W(()=>s.value=R()),W(()=>u.value=N()),e}}),null),l(a,g(Q,{get when(){return b()},get children(){return g(F,{get children(){var e=_e();return e.firstChild,e.style.setProperty("padding","1rem"),e.style.setProperty("background","#f8d7da"),e.style.setProperty("color","#721c24"),e.style.setProperty("border-radius","6px"),e.style.setProperty("text-align","center"),l(e,b,null),e}})}}),null),l(a,g(Q,{get when(){return ne(()=>!!n())()&&!r()},get children(){return g(F,{get children(){var e=Le(),o=e.firstChild;return e.style.setProperty("padding","4rem"),e.style.setProperty("text-align","center"),e.style.setProperty("color","var(--text-muted)"),o.style.setProperty("font-size","3rem"),o.style.setProperty("margin-bottom","1rem"),e}})}}),null),l(a,g(Q,{get when(){return ne(()=>!!r())()&&!n()},get children(){return[(()=>{var e=Be();return e.style.setProperty("display","grid"),e.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),e.style.setProperty("gap","1.5rem"),e.style.setProperty("margin-bottom","2rem"),l(e,g(F,{get children(){var o=we(),t=o.firstChild,s=t.nextSibling;return o.style.setProperty("padding","1.5rem"),o.style.setProperty("text-align","center"),t.style.setProperty("font-size","2.5rem"),t.style.setProperty("font-weight","700"),t.style.setProperty("color","#007bff"),t.style.setProperty("margin-bottom","0.5rem"),l(t,()=>r().totalHBLs),s.style.setProperty("color","var(--text-muted)"),s.style.setProperty("font-size","0.95rem"),o}}),null),l(e,g(F,{get children(){var o=Se(),t=o.firstChild,s=t.nextSibling;return o.style.setProperty("padding","1.5rem"),o.style.setProperty("text-align","center"),t.style.setProperty("font-size","2.5rem"),t.style.setProperty("font-weight","700"),t.style.setProperty("color","#28a745"),t.style.setProperty("margin-bottom","0.5rem"),l(t,()=>r().locations.length),s.style.setProperty("color","var(--text-muted)"),s.style.setProperty("font-size","0.95rem"),o}}),null),l(e,g(F,{get children(){var o=Ce(),t=o.firstChild,s=t.nextSibling;return o.style.setProperty("padding","1.5rem"),o.style.setProperty("text-align","center"),t.style.setProperty("font-size","1rem"),t.style.setProperty("font-weight","500"),t.style.setProperty("color","var(--text-muted)"),t.style.setProperty("margin-bottom","0.5rem"),s.style.setProperty("font-size","0.9rem"),s.style.setProperty("color","var(--text-primary)"),l(s,()=>oe(r().lastUpdated)),o}}),null),e})(),g(F,{get children(){var e=He(),o=e.firstChild,t=o.nextSibling,s=t.firstChild,I=s.firstChild,C=I.firstChild,u=C.firstChild,B=u.nextSibling,i=B.nextSibling,y=i.nextSibling,H=I.nextSibling;return e.style.setProperty("padding","1.5rem"),o.style.setProperty("font-size","1.25rem"),o.style.setProperty("font-weight","600"),o.style.setProperty("margin-bottom","1.5rem"),t.style.setProperty("overflow-x","auto"),s.style.setProperty("width","100%"),s.style.setProperty("border-collapse","collapse"),s.style.setProperty("font-size","0.95rem"),C.style.setProperty("background","#f8f9fa"),C.style.setProperty("border-bottom","2px solid #dee2e6"),u.style.setProperty("padding","1rem"),u.style.setProperty("text-align","left"),u.style.setProperty("font-weight","600"),u.style.setProperty("color","var(--text-primary)"),B.style.setProperty("padding","1rem"),B.style.setProperty("text-align","center"),B.style.setProperty("font-weight","600"),B.style.setProperty("color","var(--text-primary)"),i.style.setProperty("padding","1rem"),i.style.setProperty("text-align","center"),i.style.setProperty("font-weight","600"),i.style.setProperty("color","var(--text-primary)"),y.style.setProperty("padding","1rem"),y.style.setProperty("text-align","center"),y.style.setProperty("font-weight","600"),y.style.setProperty("color","var(--text-primary)"),l(H,g(se,{get each(){return r().locations},children:x=>{const j=(x.hblCount/r().totalHBLs*100).toFixed(1),q=E()===x.locationId;return[(()=>{var k=Ae(),G=k.firstChild,z=G.firstChild,S=z.nextSibling,p=G.nextSibling,$=p.nextSibling,_=$.firstChild,K=_.firstChild,D=$.nextSibling,c=D.firstChild;return k.style.setProperty("border-bottom","1px solid #dee2e6"),(q?"#e7f3ff":"white")!=null?k.style.setProperty("background",q?"#e7f3ff":"white"):k.style.removeProperty("background"),k.style.setProperty("transition","background 0.2s"),G.style.setProperty("padding","1rem"),z.style.setProperty("font-weight","500"),l(z,()=>x.locationLabel),S.style.setProperty("font-size","0.85rem"),S.style.setProperty("color","var(--text-muted)"),S.style.setProperty("margin-top","0.25rem"),l(S,()=>x.locationId),p.style.setProperty("padding","1rem"),p.style.setProperty("text-align","center"),p.style.setProperty("font-weight","600"),p.style.setProperty("font-size","1.1rem"),p.style.setProperty("color","#007bff"),l(p,()=>x.hblCount),$.style.setProperty("padding","1rem"),$.style.setProperty("text-align","center"),_.style.setProperty("display","inline-block"),_.style.setProperty("padding","0.25rem 0.75rem"),_.style.setProperty("background","#e7f3ff"),_.style.setProperty("border-radius","12px"),_.style.setProperty("font-weight","500"),_.style.setProperty("color","#007bff"),l(_,j,K),D.style.setProperty("padding","1rem"),D.style.setProperty("text-align","center"),c.$$click=()=>ce(x.locationId),c.style.setProperty("padding","0.5rem 1rem"),(q?"#dc3545":"#007bff")!=null?c.style.setProperty("background",q?"#dc3545":"#007bff"):c.style.removeProperty("background"),c.style.setProperty("color","white"),c.style.setProperty("border","none"),c.style.setProperty("border-radius","4px"),c.style.setProperty("cursor","pointer"),c.style.setProperty("font-size","0.85rem"),l(c,q?"â–² Hide":"â–¼ View HBLs"),k})(),g(Q,{when:q,get children(){var k=Te(),G=k.firstChild,z=G.firstChild,S=z.firstChild;return S.firstChild,G.style.setProperty("padding","0"),z.style.setProperty("background","#f8f9fa"),z.style.setProperty("padding","1.5rem"),z.style.setProperty("border-top","1px solid #dee2e6"),S.style.setProperty("margin-bottom","1rem"),S.style.setProperty("font-size","1rem"),S.style.setProperty("font-weight","600"),l(S,()=>x.locationLabel,null),l(z,g(Q,{get when(){return w()},get fallback(){return(()=>{var p=Ee(),$=p.firstChild,_=$.firstChild,K=_.firstChild,D=K.firstChild,c=D.nextSibling,Z=c.nextSibling,ge=_.nextSibling;return p.style.setProperty("max-height","400px"),p.style.setProperty("overflow-y","auto"),$.style.setProperty("width","100%"),$.style.setProperty("border-collapse","collapse"),$.style.setProperty("background","white"),$.style.setProperty("border-radius","4px"),$.style.setProperty("overflow","hidden"),K.style.setProperty("background","#e9ecef"),D.style.setProperty("padding","0.75rem"),D.style.setProperty("text-align","left"),D.style.setProperty("font-size","0.85rem"),c.style.setProperty("padding","0.75rem"),c.style.setProperty("text-align","left"),c.style.setProperty("font-size","0.85rem"),Z.style.setProperty("padding","0.75rem"),Z.style.setProperty("text-align","left"),Z.style.setProperty("font-size","0.85rem"),l(ge,g(se,{get each(){return Y()},children:ee=>(()=>{var te=Fe(),V=te.firstChild,O=V.nextSibling,re=O.nextSibling;return te.style.setProperty("border-bottom","1px solid #e9ecef"),V.style.setProperty("padding","0.75rem"),V.style.setProperty("font-family","monospace"),V.style.setProperty("font-size","0.9rem"),l(V,()=>ee.hbl),O.style.setProperty("padding","0.75rem"),O.style.setProperty("font-size","0.85rem"),O.style.setProperty("color","var(--text-muted)"),l(O,()=>oe(ee.lastScannedAt)),re.style.setProperty("padding","0.75rem"),re.style.setProperty("font-size","0.85rem"),l(re,()=>ee.scannedBy||"-"),te})()})),p})()},get children(){var p=De();return p.style.setProperty("padding","2rem"),p.style.setProperty("text-align","center"),p}}),null),k}})]}})),e}})]}}),null),W(e=>{var o=n(),t=n()?"#6c757d":"#007bff",s=n()?"not-allowed":"pointer";return o!==e.e&&(h.disabled=e.e=o),t!==e.t&&((e.t=t)!=null?h.style.setProperty("background",t):h.style.removeProperty("background")),s!==e.a&&((e.a=s)!=null?h.style.setProperty("cursor",s):h.style.removeProperty("cursor")),e},{e:void 0,t:void 0,a:void 0}),a})()};he(["click","input"]);export{qe as default};
