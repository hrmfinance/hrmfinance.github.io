(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const ng=!1,ig=(t,e)=>t===e,Yr=Symbol("solid-proxy"),qh=typeof Proxy=="function",xl=Symbol("solid-track"),Zs={equals:ig};let Hh=Zh;const ni=1,ea=2,Wh={owned:null,cleanups:null,context:null,owner:null};var Et=null;let Ja=null,og=null,Ft=null,wr=null,wn=null,xa=0;function No(t,e){const r=Ft,n=Et,i=t.length===0,o=e===void 0?n:e,a=i?Wh:{owned:null,cleanups:null,context:o?o.context:null,owner:o},c=i?t:()=>t(()=>Fr(()=>jo(a)));Et=a,Ft=null;try{return ii(c,!0)}finally{Ft=r,Et=n}}function ye(t,e){e=e?Object.assign({},Zs,e):Zs;const r={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},n=i=>(typeof i=="function"&&(i=i(r.value)),Xh(r,i));return[Jh.bind(r),n]}function re(t,e,r){const n=uc(t,e,!1,ni);ns(n)}function Tn(t,e,r){Hh=cg;const n=uc(t,e,!1,ni);n.user=!0,wn?wn.push(n):ns(n)}function Ke(t,e,r){r=r?Object.assign({},Zs,r):Zs;const n=uc(t,e,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=r.equals||void 0,ns(n),Jh.bind(n)}function Gh(t){return ii(t,!1)}function Fr(t){if(Ft===null)return t();const e=Ft;Ft=null;try{return t()}finally{Ft=e}}function ac(t,e,r){const n=Array.isArray(t);let i,o=r&&r.defer;return a=>{let c;if(n){c=Array(t.length);for(let h=0;h<t.length;h++)c[h]=t[h]()}else c=t();if(o)return o=!1,a;const u=Fr(()=>e(c,i,a));return i=c,u}}function hn(t){Tn(()=>Fr(t))}function so(t){return Et===null||(Et.cleanups===null?Et.cleanups=[t]:Et.cleanups.push(t)),t}function Tl(){return Ft}function Kh(){return Et}function Yh(t,e){const r=Et,n=Ft;Et=t,Ft=null;try{return ii(e,!0)}catch(i){dc(i)}finally{Et=r,Ft=n}}function sg(t){const e=Ft,r=Et;return Promise.resolve().then(()=>{Ft=e,Et=r;let n;return ii(t,!1),Ft=Et=null,n?n.done:void 0})}const[wx,Cx]=ye(!1);function Qh(t,e){const r=Symbol("context");return{id:r,Provider:dg(r),defaultValue:t}}function lc(t){let e;return Et&&Et.context&&(e=Et.context[t.id])!==void 0?e:t.defaultValue}function cc(t){const e=Ke(t),r=Ke(()=>$l(e()));return r.toArray=()=>{const n=r();return Array.isArray(n)?n:n!=null?[n]:[]},r}function Jh(){if(this.sources&&this.state)if(this.state===ni)ns(this);else{const t=wr;wr=null,ii(()=>ra(this),!1),wr=t}if(Ft){const t=this.observers?this.observers.length:0;Ft.sources?(Ft.sources.push(this),Ft.sourceSlots.push(t)):(Ft.sources=[this],Ft.sourceSlots=[t]),this.observers?(this.observers.push(Ft),this.observerSlots.push(Ft.sources.length-1)):(this.observers=[Ft],this.observerSlots=[Ft.sources.length-1])}return this.value}function Xh(t,e,r){let n=t.value;return(!t.comparator||!t.comparator(n,e))&&(t.value=e,t.observers&&t.observers.length&&ii(()=>{for(let i=0;i<t.observers.length;i+=1){const o=t.observers[i],a=Ja&&Ja.running;a&&Ja.disposed.has(o),(a?!o.tState:!o.state)&&(o.pure?wr.push(o):wn.push(o),o.observers&&em(o)),a||(o.state=ni)}if(wr.length>1e6)throw wr=[],new Error},!1)),e}function ns(t){if(!t.fn)return;jo(t);const e=xa;ag(t,t.value,e)}function ag(t,e,r){let n;const i=Et,o=Ft;Ft=Et=t;try{n=t.fn(e)}catch(a){return t.pure&&(t.state=ni,t.owned&&t.owned.forEach(jo),t.owned=null),t.updatedAt=r+1,dc(a)}finally{Ft=o,Et=i}(!t.updatedAt||t.updatedAt<=r)&&(t.updatedAt!=null&&"observers"in t?Xh(t,n):t.value=n,t.updatedAt=r)}function uc(t,e,r,n=ni,i){const o={fn:t,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:Et,context:Et?Et.context:null,pure:r};return Et===null||Et!==Wh&&(Et.owned?Et.owned.push(o):Et.owned=[o]),o}function ta(t){if(t.state===0)return;if(t.state===ea)return ra(t);if(t.suspense&&Fr(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<xa);)t.state&&e.push(t);for(let r=e.length-1;r>=0;r--)if(t=e[r],t.state===ni)ns(t);else if(t.state===ea){const n=wr;wr=null,ii(()=>ra(t,e[0]),!1),wr=n}}function ii(t,e){if(wr)return t();let r=!1;e||(wr=[]),wn?r=!0:wn=[],xa++;try{const n=t();return lg(r),n}catch(n){r||(wn=null),wr=null,dc(n)}}function lg(t){if(wr&&(Zh(wr),wr=null),t)return;const e=wn;wn=null,e.length&&ii(()=>Hh(e),!1)}function Zh(t){for(let e=0;e<t.length;e++)ta(t[e])}function cg(t){let e,r=0;for(e=0;e<t.length;e++){const n=t[e];n.user?t[r++]=n:ta(n)}for(e=0;e<r;e++)ta(t[e])}function ra(t,e){t.state=0;for(let r=0;r<t.sources.length;r+=1){const n=t.sources[r];if(n.sources){const i=n.state;i===ni?n!==e&&(!n.updatedAt||n.updatedAt<xa)&&ta(n):i===ea&&ra(n,e)}}}function em(t){for(let e=0;e<t.observers.length;e+=1){const r=t.observers[e];r.state||(r.state=ea,r.pure?wr.push(r):wn.push(r),r.observers&&em(r))}}function jo(t){let e;if(t.sources)for(;t.sources.length;){const r=t.sources.pop(),n=t.sourceSlots.pop(),i=r.observers;if(i&&i.length){const o=i.pop(),a=r.observerSlots.pop();n<i.length&&(o.sourceSlots[a]=n,i[n]=o,r.observerSlots[n]=a)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)jo(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)jo(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function ug(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function dc(t,e=Et){throw ug(t)}function $l(t){if(typeof t=="function"&&!t.length)return $l(t());if(Array.isArray(t)){const e=[];for(let r=0;r<t.length;r++){const n=$l(t[r]);Array.isArray(n)?e.push.apply(e,n):e.push(n)}return e}return t}function dg(t,e){return function(n){let i;return re(()=>i=Fr(()=>(Et.context={...Et.context,[t]:n.value},cc(()=>n.children))),void 0),i}}const hg=Symbol("fallback");function Du(t){for(let e=0;e<t.length;e++)t[e]()}function mg(t,e,r={}){let n=[],i=[],o=[],a=0,c=e.length>1?[]:null;return so(()=>Du(o)),()=>{let u=t()||[],h=u.length,f,p;return u[xl],Fr(()=>{let C,D,x,E,T,H,te,Y,ue;if(h===0)a!==0&&(Du(o),o=[],n=[],i=[],a=0,c&&(c=[])),r.fallback&&(n=[hg],i[0]=No(oe=>(o[0]=oe,r.fallback())),a=1);else if(a===0){for(i=new Array(h),p=0;p<h;p++)n[p]=u[p],i[p]=No(b);a=h}else{for(x=new Array(h),E=new Array(h),c&&(T=new Array(h)),H=0,te=Math.min(a,h);H<te&&n[H]===u[H];H++);for(te=a-1,Y=h-1;te>=H&&Y>=H&&n[te]===u[Y];te--,Y--)x[Y]=i[te],E[Y]=o[te],c&&(T[Y]=c[te]);for(C=new Map,D=new Array(Y+1),p=Y;p>=H;p--)ue=u[p],f=C.get(ue),D[p]=f===void 0?-1:f,C.set(ue,p);for(f=H;f<=te;f++)ue=n[f],p=C.get(ue),p!==void 0&&p!==-1?(x[p]=i[f],E[p]=o[f],c&&(T[p]=c[f]),p=D[p],C.set(ue,p)):o[f]();for(p=H;p<h;p++)p in x?(i[p]=x[p],o[p]=E[p],c&&(c[p]=T[p],c[p](p))):i[p]=No(b);i=i.slice(0,a=h),n=u.slice(0)}return i});function b(C){if(o[p]=C,c){const[D,x]=ye(p);return c[p]=x,e(u[p],D)}return e(u[p])}}}function S(t,e){return Fr(()=>t(e||{}))}function Cs(){return!0}const kl={get(t,e,r){return e===Yr?r:t.get(e)},has(t,e){return e===Yr?!0:t.has(e)},set:Cs,deleteProperty:Cs,getOwnPropertyDescriptor(t,e){return{configurable:!0,enumerable:!0,get(){return t.get(e)},set:Cs,deleteProperty:Cs}},ownKeys(t){return t.keys()}};function Xa(t){return(t=typeof t=="function"?t():t)?t:{}}function fg(){for(let t=0,e=this.length;t<e;++t){const r=this[t]();if(r!==void 0)return r}}function Rl(...t){let e=!1;for(let a=0;a<t.length;a++){const c=t[a];e=e||!!c&&Yr in c,t[a]=typeof c=="function"?(e=!0,Ke(c)):c}if(qh&&e)return new Proxy({get(a){for(let c=t.length-1;c>=0;c--){const u=Xa(t[c])[a];if(u!==void 0)return u}},has(a){for(let c=t.length-1;c>=0;c--)if(a in Xa(t[c]))return!0;return!1},keys(){const a=[];for(let c=0;c<t.length;c++)a.push(...Object.keys(Xa(t[c])));return[...new Set(a)]}},kl);const r={},n=Object.create(null);for(let a=t.length-1;a>=0;a--){const c=t[a];if(!c)continue;const u=Object.getOwnPropertyNames(c);for(let h=u.length-1;h>=0;h--){const f=u[h];if(f==="__proto__"||f==="constructor")continue;const p=Object.getOwnPropertyDescriptor(c,f);if(!n[f])n[f]=p.get?{enumerable:!0,configurable:!0,get:fg.bind(r[f]=[p.get.bind(c)])}:p.value!==void 0?p:void 0;else{const b=r[f];b&&(p.get?b.push(p.get.bind(c)):p.value!==void 0&&b.push(()=>p.value))}}}const i={},o=Object.keys(n);for(let a=o.length-1;a>=0;a--){const c=o[a],u=n[c];u&&u.get?Object.defineProperty(i,c,u):i[c]=u?u.value:void 0}return i}function yg(t,...e){if(qh&&Yr in t){const i=new Set(e.length>1?e.flat():e[0]),o=e.map(a=>new Proxy({get(c){return a.includes(c)?t[c]:void 0},has(c){return a.includes(c)&&c in t},keys(){return a.filter(c=>c in t)}},kl));return o.push(new Proxy({get(a){return i.has(a)?void 0:t[a]},has(a){return i.has(a)?!1:a in t},keys(){return Object.keys(t).filter(a=>!i.has(a))}},kl)),o}const r={},n=e.map(()=>({}));for(const i of Object.getOwnPropertyNames(t)){const o=Object.getOwnPropertyDescriptor(t,i),a=!o.get&&!o.set&&o.enumerable&&o.writable&&o.configurable;let c=!1,u=0;for(const h of e)h.includes(i)&&(c=!0,a?n[u][i]=o.value:Object.defineProperty(n[u],i,o)),++u;c||(a?r[i]=o.value:Object.defineProperty(r,i,o))}return[...n,r]}const gg=t=>`Stale read from <${t}>.`;function Ut(t){const e="fallback"in t&&{fallback:()=>t.fallback};return Ke(mg(()=>t.each,t.children,e||void 0))}function Ue(t){const e=t.keyed,r=Ke(()=>t.when,void 0,void 0),n=e?r:Ke(r,void 0,{equals:(i,o)=>!i==!o});return Ke(()=>{const i=n();if(i){const o=t.children;return typeof o=="function"&&o.length>0?Fr(()=>o(e?i:()=>{if(!Fr(n))throw gg("Show");return r()})):o}return t.fallback},void 0,void 0)}const pg=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],vg=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline",...pg]),bg=new Set(["innerHTML","textContent","innerText","children"]),_g=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),Sg=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}});function Pg(t,e){const r=Sg[t];return typeof r=="object"?r[e]?r.$:void 0:r}const wg=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),fe=t=>Ke(()=>t());function Cg(t,e,r){let n=r.length,i=e.length,o=n,a=0,c=0,u=e[i-1].nextSibling,h=null;for(;a<i||c<o;){if(e[a]===r[c]){a++,c++;continue}for(;e[i-1]===r[o-1];)i--,o--;if(i===a){const f=o<n?c?r[c-1].nextSibling:r[o-c]:u;for(;c<o;)t.insertBefore(r[c++],f)}else if(o===c)for(;a<i;)(!h||!h.has(e[a]))&&e[a].remove(),a++;else if(e[a]===r[o-1]&&r[c]===e[i-1]){const f=e[--i].nextSibling;t.insertBefore(r[c++],e[a++].nextSibling),t.insertBefore(r[--o],f),e[i]=r[o]}else{if(!h){h=new Map;let p=c;for(;p<o;)h.set(r[p],p++)}const f=h.get(e[a]);if(f!=null)if(c<f&&f<o){let p=a,b=1,C;for(;++p<i&&p<o&&!((C=h.get(e[p]))==null||C!==f+b);)b++;if(b>f-c){const D=e[a];for(;c<f;)t.insertBefore(r[c++],D)}else t.replaceChild(r[c++],e[a++])}else a++;else e[a++].remove()}}}const Nu="_$DX_DELEGATE";function Ag(t,e,r,n={}){let i;return No(o=>{i=o,e===document?t():s(e,t(),e.firstChild?null:void 0,r)},n.owner),()=>{i(),e.textContent=""}}function q(t,e,r,n){let i;const o=()=>{const c=document.createElement("template");return c.innerHTML=t,c.content.firstChild},a=()=>(i||(i=o())).cloneNode(!0);return a.cloneNode=a,a}function At(t,e=window.document){const r=e[Nu]||(e[Nu]=new Set);for(let n=0,i=t.length;n<i;n++){const o=t[n];r.has(o)||(r.add(o),e.addEventListener(o,Rg))}}function ut(t,e,r){r==null?t.removeAttribute(e):t.setAttribute(e,r)}function Ig(t,e,r){r?t.setAttribute(e,""):t.removeAttribute(e)}function hc(t,e){e==null?t.removeAttribute("class"):t.className=e}function Ii(t,e,r,n){if(n)Array.isArray(r)?(t[`$$${e}`]=r[0],t[`$$${e}Data`]=r[1]):t[`$$${e}`]=r;else if(Array.isArray(r)){const i=r[0];t.addEventListener(e,r[0]=o=>i.call(t,r[1],o))}else t.addEventListener(e,r,typeof r!="function"&&r)}function Eg(t,e,r={}){const n=Object.keys(e||{}),i=Object.keys(r);let o,a;for(o=0,a=i.length;o<a;o++){const c=i[o];!c||c==="undefined"||e[c]||(Lu(t,c,!1),delete r[c])}for(o=0,a=n.length;o<a;o++){const c=n[o],u=!!e[c];!c||c==="undefined"||r[c]===u||!u||(Lu(t,c,!0),r[c]=u)}return r}function d(t,e,r){if(!e)return r?ut(t,"style"):e;const n=t.style;if(typeof e=="string")return n.cssText=e;typeof r=="string"&&(n.cssText=r=void 0),r||(r={}),e||(e={});let i,o;for(o in r)e[o]==null&&n.removeProperty(o),delete r[o];for(o in e)i=e[o],i!==r[o]&&(n.setProperty(o,i),r[o]=i);return r}function xg(t,e={},r,n){const i={};return re(()=>i.children=zo(t,e.children,i.children)),re(()=>typeof e.ref=="function"&&Tg(e.ref,t)),re(()=>$g(t,e,r,!0,i,!0)),i}function Tg(t,e,r){return Fr(()=>t(e,r))}function s(t,e,r,n){if(r!==void 0&&!n&&(n=[]),typeof e!="function")return zo(t,e,n,r);re(i=>zo(t,e(),i,r),n)}function $g(t,e,r,n,i={},o=!1){e||(e={});for(const a in i)if(!(a in e)){if(a==="children")continue;i[a]=Mu(t,a,null,i[a],r,o,e)}for(const a in e){if(a==="children")continue;const c=e[a];i[a]=Mu(t,a,c,i[a],r,o,e)}}function kg(t){return t.toLowerCase().replace(/-([a-z])/g,(e,r)=>r.toUpperCase())}function Lu(t,e,r){const n=e.trim().split(/\s+/);for(let i=0,o=n.length;i<o;i++)t.classList.toggle(n[i],r)}function Mu(t,e,r,n,i,o,a){let c,u,h,f,p;if(e==="style")return d(t,r,n);if(e==="classList")return Eg(t,r,n);if(r===n)return n;if(e==="ref")o||r(t);else if(e.slice(0,3)==="on:"){const b=e.slice(3);n&&t.removeEventListener(b,n,typeof n!="function"&&n),r&&t.addEventListener(b,r,typeof r!="function"&&r)}else if(e.slice(0,10)==="oncapture:"){const b=e.slice(10);n&&t.removeEventListener(b,n,!0),r&&t.addEventListener(b,r,!0)}else if(e.slice(0,2)==="on"){const b=e.slice(2).toLowerCase(),C=wg.has(b);if(!C&&n){const D=Array.isArray(n)?n[0]:n;t.removeEventListener(b,D)}(C||r)&&(Ii(t,b,r,C),C&&At([b]))}else e.slice(0,5)==="attr:"?ut(t,e.slice(5),r):e.slice(0,5)==="bool:"?Ig(t,e.slice(5),r):(p=e.slice(0,5)==="prop:")||(h=bg.has(e))||(f=Pg(e,t.tagName))||(u=vg.has(e))||(c=t.nodeName.includes("-")||"is"in a)?(p&&(e=e.slice(5),u=!0),e==="class"||e==="className"?hc(t,r):c&&!u&&!h?t[kg(e)]=r:t[f||e]=r):ut(t,_g[e]||e,r);return r}function Rg(t){let e=t.target;const r=`$$${t.type}`,n=t.target,i=t.currentTarget,o=u=>Object.defineProperty(t,"target",{configurable:!0,value:u}),a=()=>{const u=e[r];if(u&&!e.disabled){const h=e[`${r}Data`];if(h!==void 0?u.call(e,h,t):u.call(e,t),t.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(t.target)&&o(e.host),!0},c=()=>{for(;a()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return e||document}}),t.composedPath){const u=t.composedPath();o(u[0]);for(let h=0;h<u.length-2&&(e=u[h],!!a());h++){if(e._$host){e=e._$host,c();break}if(e.parentNode===i)break}}else c();o(n)}function zo(t,e,r,n,i){for(;typeof r=="function";)r=r();if(e===r)return r;const o=typeof e,a=n!==void 0;if(t=a&&r[0]&&r[0].parentNode||t,o==="string"||o==="number"){if(o==="number"&&(e=e.toString(),e===r))return r;if(a){let c=r[0];c&&c.nodeType===3?c.data!==e&&(c.data=e):c=document.createTextNode(e),r=Vi(t,r,n,c)}else r!==""&&typeof r=="string"?r=t.firstChild.data=e:r=t.textContent=e}else if(e==null||o==="boolean")r=Vi(t,r,n);else{if(o==="function")return re(()=>{let c=e();for(;typeof c=="function";)c=c();r=zo(t,c,r,n)}),()=>r;if(Array.isArray(e)){const c=[],u=r&&Array.isArray(r);if(Dl(c,e,r,i))return re(()=>r=zo(t,c,r,n,!0)),()=>r;if(c.length===0){if(r=Vi(t,r,n),a)return r}else u?r.length===0?Ou(t,c,n):Cg(t,r,c):(r&&Vi(t),Ou(t,c));r=c}else if(e.nodeType){if(Array.isArray(r)){if(a)return r=Vi(t,r,n,e);Vi(t,r,null,e)}else r==null||r===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);r=e}}return r}function Dl(t,e,r,n){let i=!1;for(let o=0,a=e.length;o<a;o++){let c=e[o],u=r&&r[t.length],h;if(!(c==null||c===!0||c===!1))if((h=typeof c)=="object"&&c.nodeType)t.push(c);else if(Array.isArray(c))i=Dl(t,c,u)||i;else if(h==="function")if(n){for(;typeof c=="function";)c=c();i=Dl(t,Array.isArray(c)?c:[c],Array.isArray(u)?u:[u])||i}else t.push(c),i=!0;else{const f=String(c);u&&u.nodeType===3&&u.data===f?t.push(u):t.push(document.createTextNode(f))}}return i}function Ou(t,e,r=null){for(let n=0,i=e.length;n<i;n++)t.insertBefore(e[n],r)}function Vi(t,e,r,n){if(r===void 0)return t.textContent="";const i=n||document.createTextNode("");if(e.length){let o=!1;for(let a=e.length-1;a>=0;a--){const c=e[a];if(i!==c){const u=c.parentNode===t;!o&&!a?u?t.replaceChild(i,c):t.insertBefore(i,r):u&&c.remove()}else o=!0}}else t.insertBefore(i,r);return[i]}const Dg=!1;function tm(){let t=new Set;function e(i){return t.add(i),()=>t.delete(i)}let r=!1;function n(i,o){if(r)return!(r=!1);const a={to:i,options:o,defaultPrevented:!1,preventDefault:()=>a.defaultPrevented=!0};for(const c of t)c.listener({...a,from:c.location,retry:u=>{u&&(r=!0),c.navigate(i,{...o,resolve:!1})}});return!a.defaultPrevented}return{subscribe:e,confirm:n}}let Nl;function mc(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),Nl=window.history.state._depth}mc();function Ng(t){return{...t,_depth:window.history.state&&window.history.state._depth}}function Lg(t,e){let r=!1;return()=>{const n=Nl;mc();const i=n==null?null:Nl-n;if(r){r=!1;return}i&&e(i)?(r=!0,window.history.go(-i)):t()}}const Mg=/^(?:[a-z0-9]+:)?\/\//i,Og=/^\/+|(\/)\/+$/g,rm="http://sr";function bi(t,e=!1){const r=t.replace(Og,"$1");return r?e||/^[?#]/.test(r)?r:"/"+r:""}function Us(t,e,r){if(Mg.test(e))return;const n=bi(t),i=r&&bi(r);let o="";return!i||e.startsWith("/")?o=n:i.toLowerCase().indexOf(n.toLowerCase())!==0?o=n+i:o=i,(o||"/")+bi(e,!o)}function Vg(t,e){if(t==null)throw new Error(e);return t}function Bg(t,e){return bi(t).replace(/\/*(\*.*)?$/g,"")+bi(e)}function nm(t){const e={};return t.searchParams.forEach((r,n)=>{n in e?Array.isArray(e[n])?e[n].push(r):e[n]=[e[n],r]:e[n]=r}),e}function Fg(t,e,r){const[n,i]=t.split("/*",2),o=n.split("/").filter(Boolean),a=o.length;return c=>{const u=c.split("/").filter(Boolean),h=u.length-a;if(h<0||h>0&&i===void 0&&!e)return null;const f={path:a?"":"/",params:{}},p=b=>r===void 0?void 0:r[b];for(let b=0;b<a;b++){const C=o[b],D=C[0]===":",x=D?u[b]:u[b].toLowerCase(),E=D?C.slice(1):C.toLowerCase();if(D&&Za(x,p(E)))f.params[E]=x;else if(D||!Za(x,E))return null;f.path+=`/${x}`}if(i){const b=h?u.slice(-h).join("/"):"";if(Za(b,p(i)))f.params[i]=b;else return null}return f}}function Za(t,e){const r=n=>n===t;return e===void 0?!0:typeof e=="string"?r(e):typeof e=="function"?e(t):Array.isArray(e)?e.some(r):e instanceof RegExp?e.test(t):!1}function Ug(t){const[e,r]=t.pattern.split("/*",2),n=e.split("/").filter(Boolean);return n.reduce((i,o)=>i+(o.startsWith(":")?2:3),n.length-(r===void 0?0:1))}function im(t){const e=new Map,r=Kh();return new Proxy({},{get(n,i){return e.has(i)||Yh(r,()=>e.set(i,Ke(()=>t()[i]))),e.get(i)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(t())}})}function om(t){let e=/(\/?\:[^\/]+)\?/.exec(t);if(!e)return[t];let r=t.slice(0,e.index),n=t.slice(e.index+e[0].length);const i=[r,r+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(n);)i.push(r+=e[1]),n=n.slice(e[0].length);return om(n).reduce((o,a)=>[...o,...i.map(c=>c+a)],[])}const jg=100,sm=Qh(),fc=Qh(),is=()=>Vg(lc(sm),"<A> and 'use' router primitives can be only used inside a Route."),zg=()=>lc(fc)||is().base,qg=t=>{const e=zg();return Ke(()=>e.resolvePath(t()))},Hg=t=>{const e=is();return Ke(()=>{const r=t();return r!==void 0?e.renderPath(r):r})},yc=()=>is().navigatorFactory(),Wg=()=>is().location,Gg=()=>is().params;function Kg(t,e=""){const{component:r,preload:n,load:i,children:o,info:a}=t,c=!o||Array.isArray(o)&&!o.length,u={key:t,component:r,preload:n||i,info:a};return am(t.path).reduce((h,f)=>{for(const p of om(f)){const b=Bg(e,p);let C=c?b:b.split("/*",1)[0];C=C.split("/").map(D=>D.startsWith(":")||D.startsWith("*")?D:encodeURIComponent(D)).join("/"),h.push({...u,originalPath:f,pattern:C,matcher:Fg(C,!c,t.matchFilters)})}return h},[])}function Yg(t,e=0){return{routes:t,score:Ug(t[t.length-1])*1e4-e,matcher(r){const n=[];for(let i=t.length-1;i>=0;i--){const o=t[i],a=o.matcher(r);if(!a)return null;n.unshift({...a,route:o})}return n}}}function am(t){return Array.isArray(t)?t:[t]}function lm(t,e="",r=[],n=[]){const i=am(t);for(let o=0,a=i.length;o<a;o++){const c=i[o];if(c&&typeof c=="object"){c.hasOwnProperty("path")||(c.path="");const u=Kg(c,e);for(const h of u){r.push(h);const f=Array.isArray(c.children)&&c.children.length===0;if(c.children&&!f)lm(c.children,h.pattern,r,n);else{const p=Yg([...r],n.length);n.push(p)}r.pop()}}}return r.length?n:n.sort((o,a)=>a.score-o.score)}function el(t,e){for(let r=0,n=t.length;r<n;r++){const i=t[r].matcher(e);if(i)return i}return[]}function Qg(t,e,r){const n=new URL(rm),i=Ke(f=>{const p=t();try{return new URL(p,n)}catch{return console.error(`Invalid path ${p}`),f}},n,{equals:(f,p)=>f.href===p.href}),o=Ke(()=>i().pathname),a=Ke(()=>i().search,!0),c=Ke(()=>i().hash),u=()=>"",h=ac(a,()=>nm(i()));return{get pathname(){return o()},get search(){return a()},get hash(){return c()},get state(){return e()},get key(){return u()},query:r?r(h):im(h)}}let fi;function Jg(){return fi}function Xg(t,e,r,n={}){const{signal:[i,o],utils:a={}}=t,c=a.parsePath||(he=>he),u=a.renderPath||(he=>he),h=a.beforeLeave||tm(),f=Us("",n.base||"");if(f===void 0)throw new Error(`${f} is not a valid base path`);f&&!i().value&&o({value:f,replace:!0,scroll:!1});const[p,b]=ye(!1);let C;const D=(he,W)=>{W.value===x()&&W.state===T()||(C===void 0&&b(!0),fi=he,C=W,sg(()=>{C===W&&(E(C.value),H(C.state),ue[1]($=>$.filter(Z=>Z.pending)))}).finally(()=>{C===W&&Gh(()=>{fi=void 0,he==="navigate"&&A(C),b(!1),C=void 0})}))},[x,E]=ye(i().value),[T,H]=ye(i().state),te=Qg(x,T,a.queryWrapper),Y=[],ue=ye([]),oe=Ke(()=>typeof n.transformUrl=="function"?el(e(),n.transformUrl(te.pathname)):el(e(),te.pathname)),I=()=>{const he=oe(),W={};for(let $=0;$<he.length;$++)Object.assign(W,he[$].params);return W},_=a.paramsWrapper?a.paramsWrapper(I,e):im(I),v={pattern:f,path:()=>f,outlet:()=>null,resolvePath(he){return Us(f,he)}};return re(ac(i,he=>D("native",he),{defer:!0})),{base:v,location:te,params:_,isRouting:p,renderPath:u,parsePath:c,navigatorFactory:w,matches:oe,beforeLeave:h,preloadRoute:y,singleFlight:n.singleFlight===void 0?!0:n.singleFlight,submissions:ue};function P(he,W,$){Fr(()=>{if(typeof W=="number"){W&&(a.go?a.go(W):console.warn("Router integration does not support relative routing"));return}const Z=!W||W[0]==="?",{replace:k,resolve:F,scroll:V,state:z}={replace:!1,resolve:!Z,scroll:!0,...$},me=F?he.resolvePath(W):Us(Z&&te.pathname||"",W);if(me===void 0)throw new Error(`Path '${W}' is not a routable path`);if(Y.length>=jg)throw new Error("Too many redirects");const K=x();(me!==K||z!==T())&&(Dg||h.confirm(me,$)&&(Y.push({value:K,replace:k,scroll:V,state:T()}),D("navigate",{value:me,state:z})))})}function w(he){return he=he||lc(fc)||v,(W,$)=>P(he,W,$)}function A(he){const W=Y[0];W&&(o({...he,replace:W.replace,scroll:W.scroll}),Y.length=0)}function y(he,W){const $=el(e(),he.pathname),Z=fi;fi="preload";for(let k in $){const{route:F,params:V}=$[k];F.component&&F.component.preload&&F.component.preload();const{preload:z}=F;W&&z&&Yh(r(),()=>z({params:V,location:{pathname:he.pathname,search:he.search,hash:he.hash,query:nm(he),state:null,key:""},intent:"preload"}))}fi=Z}}function Zg(t,e,r,n){const{base:i,location:o,params:a}=t,{pattern:c,component:u,preload:h}=n().route,f=Ke(()=>n().path);u&&u.preload&&u.preload();const p=h?h({params:a,location:o,intent:fi||"initial"}):void 0;return{parent:e,pattern:c,path:f,outlet:()=>u?S(u,{params:a,location:o,data:p,get children(){return r()}}):r(),resolvePath(C){return Us(i.path(),C,f())}}}const ep=t=>e=>{const{base:r}=e,n=cc(()=>e.children),i=Ke(()=>lm(n(),e.base||""));let o;const a=Xg(t,i,()=>o,{base:r,singleFlight:e.singleFlight,transformUrl:e.transformUrl});return t.create&&t.create(a),S(sm.Provider,{value:a,get children(){return S(tp,{routerState:a,get root(){return e.root},get preload(){return e.rootPreload||e.rootLoad},get children(){return[fe(()=>(o=Kh())&&null),S(rp,{routerState:a,get branches(){return i()}})]}})}})};function tp(t){const e=t.routerState.location,r=t.routerState.params,n=Ke(()=>t.preload&&Fr(()=>{t.preload({params:r,location:e,intent:Jg()||"initial"})}));return S(Ue,{get when(){return t.root},keyed:!0,get fallback(){return t.children},children:i=>S(i,{params:r,location:e,get data(){return n()},get children(){return t.children}})})}function rp(t){const e=[];let r;const n=Ke(ac(t.routerState.matches,(i,o,a)=>{let c=o&&i.length===o.length;const u=[];for(let h=0,f=i.length;h<f;h++){const p=o&&o[h],b=i[h];a&&p&&b.route.key===p.route.key?u[h]=a[h]:(c=!1,e[h]&&e[h](),No(C=>{e[h]=C,u[h]=Zg(t.routerState,u[h-1]||t.routerState.base,Vu(()=>n()[h+1]),()=>t.routerState.matches()[h])}))}return e.splice(i.length).forEach(h=>h()),a&&c?a:(r=u[0],u)}));return Vu(()=>n()&&r)()}const Vu=t=>()=>S(Ue,{get when(){return t()},keyed:!0,children:e=>S(fc.Provider,{value:e,get children(){return e.outlet()}})}),Zr=t=>{const e=cc(()=>t.children);return Rl(t,{get children(){return e()}})};function np([t,e],r,n){return[t,n?i=>e(n(i)):e]}function ip(t){let e=!1;const r=i=>typeof i=="string"?{value:i}:i,n=np(ye(r(t.get()),{equals:(i,o)=>i.value===o.value&&i.state===o.state}),void 0,i=>(!e&&t.set(i),i));return t.init&&so(t.init((i=t.get())=>{e=!0,n[1](r(i)),e=!1})),ep({signal:n,create:t.create,utils:t.utils})}function op(t,e,r){return t.addEventListener(e,r),()=>t.removeEventListener(e,r)}function sp(t,e){const r=t&&document.getElementById(t);r?r.scrollIntoView():e&&window.scrollTo(0,0)}const ap=new Map;function lp(t=!0,e=!1,r="/_server",n){return i=>{const o=i.base.path(),a=i.navigatorFactory(i.base);let c,u;function h(x){return x.namespaceURI==="http://www.w3.org/2000/svg"}function f(x){if(x.defaultPrevented||x.button!==0||x.metaKey||x.altKey||x.ctrlKey||x.shiftKey)return;const E=x.composedPath().find(oe=>oe instanceof Node&&oe.nodeName.toUpperCase()==="A");if(!E||e&&!E.hasAttribute("link"))return;const T=h(E),H=T?E.href.baseVal:E.href;if((T?E.target.baseVal:E.target)||!H&&!E.hasAttribute("state"))return;const Y=(E.getAttribute("rel")||"").split(/\s+/);if(E.hasAttribute("download")||Y&&Y.includes("external"))return;const ue=T?new URL(H,document.baseURI):new URL(H);if(!(ue.origin!==window.location.origin||o&&ue.pathname&&!ue.pathname.toLowerCase().startsWith(o.toLowerCase())))return[E,ue]}function p(x){const E=f(x);if(!E)return;const[T,H]=E,te=i.parsePath(H.pathname+H.search+H.hash),Y=T.getAttribute("state");x.preventDefault(),a(te,{resolve:!1,replace:T.hasAttribute("replace"),scroll:!T.hasAttribute("noscroll"),state:Y?JSON.parse(Y):void 0})}function b(x){const E=f(x);if(!E)return;const[T,H]=E;i.preloadRoute(H,T.getAttribute("preload")!=="false")}function C(x){clearTimeout(c);const E=f(x);if(!E)return u=null;const[T,H]=E;u!==T&&(c=setTimeout(()=>{i.preloadRoute(H,T.getAttribute("preload")!=="false"),u=T},20))}function D(x){if(x.defaultPrevented)return;let E=x.submitter&&x.submitter.hasAttribute("formaction")?x.submitter.getAttribute("formaction"):x.target.getAttribute("action");if(!E)return;if(!E.startsWith("https://action/")){const H=new URL(E,rm);if(E=i.parsePath(H.pathname+H.search),!E.startsWith(r))return}if(x.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const T=ap.get(E);if(T){x.preventDefault();const H=new FormData(x.target,x.submitter);T.call({r:i,f:x.target},x.target.enctype==="multipart/form-data"?H:new URLSearchParams(H))}}At(["click","submit"]),document.addEventListener("click",p),t&&(document.addEventListener("mousemove",C,{passive:!0}),document.addEventListener("focusin",b,{passive:!0}),document.addEventListener("touchstart",b,{passive:!0})),document.addEventListener("submit",D),so(()=>{document.removeEventListener("click",p),t&&(document.removeEventListener("mousemove",C),document.removeEventListener("focusin",b),document.removeEventListener("touchstart",b)),document.removeEventListener("submit",D)})}}function cp(t){const e=t.replace(/^.*?#/,"");if(!e.startsWith("/")){const[,r="/"]=window.location.hash.split("#",2);return`${r}#${e}`}return e}function up(t){const e=()=>window.location.hash.slice(1),r=tm();return ip({get:e,set({value:n,replace:i,scroll:o,state:a}){i?window.history.replaceState(Ng(a),"","#"+n):window.history.pushState(a,"","#"+n);const c=n.indexOf("#"),u=c>=0?n.slice(c+1):"";sp(u,o),mc()},init:n=>op(window,"hashchange",Lg(n,i=>!r.confirm(i&&i<0?i:e()))),create:lp(t.preload,t.explicitLinks,t.actionBase),utils:{go:n=>window.history.go(n),renderPath:n=>`#${n}`,parsePath:cp,beforeLeave:r}})(t)}var dp=q("<a>");function vn(t){t=Rl({inactiveClass:"inactive",activeClass:"active"},t);const[,e]=yg(t,["href","state","class","activeClass","inactiveClass","end"]),r=qg(()=>t.href),n=Hg(r),i=Wg(),o=Ke(()=>{const a=r();if(a===void 0)return[!1,!1];const c=bi(a.split(/[?#]/,1)[0]).toLowerCase(),u=decodeURI(bi(i.pathname).toLowerCase());return[t.end?c===u:u.startsWith(c+"/")||u===c,c===u]});return(()=>{var a=dp();return xg(a,Rl(e,{get href(){return n()||t.href},get state(){return JSON.stringify(t.state)},get classList(){return{...t.class&&{[t.class]:!0},[t.inactiveClass]:!o()[0],[t.activeClass]:o()[0],...e.classList}},link:"",get"aria-current"(){return o()[1]?"page":void 0}}),!1),a})()}const Ll=Symbol("store-raw"),Gi=Symbol("store-node"),bn=Symbol("store-has"),cm=Symbol("store-self");function um(t){let e=t[Yr];if(!e&&(Object.defineProperty(t,Yr,{value:e=new Proxy(t,fp)}),!Array.isArray(t))){const r=Object.keys(t),n=Object.getOwnPropertyDescriptors(t);for(let i=0,o=r.length;i<o;i++){const a=r[i];n[a].get&&Object.defineProperty(t,a,{enumerable:n[a].enumerable,get:n[a].get.bind(e)})}}return e}function na(t){let e;return t!=null&&typeof t=="object"&&(t[Yr]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function qo(t,e=new Set){let r,n,i,o;if(r=t!=null&&t[Ll])return r;if(!na(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let a=0,c=t.length;a<c;a++)i=t[a],(n=qo(i,e))!==i&&(t[a]=n)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const a=Object.keys(t),c=Object.getOwnPropertyDescriptors(t);for(let u=0,h=a.length;u<h;u++)o=a[u],!c[o].get&&(i=t[o],(n=qo(i,e))!==i&&(t[o]=n))}return t}function ia(t,e){let r=t[e];return r||Object.defineProperty(t,e,{value:r=Object.create(null)}),r}function Ho(t,e,r){if(t[e])return t[e];const[n,i]=ye(r,{equals:!1,internal:!0});return n.$=i,t[e]=n}function hp(t,e){const r=Reflect.getOwnPropertyDescriptor(t,e);return!r||r.get||!r.configurable||e===Yr||e===Gi||(delete r.value,delete r.writable,r.get=()=>t[Yr][e]),r}function dm(t){Tl()&&Ho(ia(t,Gi),cm)()}function mp(t){return dm(t),Reflect.ownKeys(t)}const fp={get(t,e,r){if(e===Ll)return t;if(e===Yr)return r;if(e===xl)return dm(t),r;const n=ia(t,Gi),i=n[e];let o=i?i():t[e];if(e===Gi||e===bn||e==="__proto__")return o;if(!i){const a=Object.getOwnPropertyDescriptor(t,e);Tl()&&(typeof o!="function"||t.hasOwnProperty(e))&&!(a&&a.get)&&(o=Ho(n,e,o)())}return na(o)?um(o):o},has(t,e){return e===Ll||e===Yr||e===xl||e===Gi||e===bn||e==="__proto__"?!0:(Tl()&&Ho(ia(t,bn),e)(),e in t)},set(){return!0},deleteProperty(){return!0},ownKeys:mp,getOwnPropertyDescriptor:hp};function oa(t,e,r,n=!1){if(!n&&t[e]===r)return;const i=t[e],o=t.length;r===void 0?(delete t[e],t[bn]&&t[bn][e]&&i!==void 0&&t[bn][e].$()):(t[e]=r,t[bn]&&t[bn][e]&&i===void 0&&t[bn][e].$());let a=ia(t,Gi),c;if((c=Ho(a,e,i))&&c.$(()=>r),Array.isArray(t)&&t.length!==o){for(let u=t.length;u<o;u++)(c=a[u])&&c.$();(c=Ho(a,"length",o))&&c.$(t.length)}(c=a[cm])&&c.$()}function hm(t,e){const r=Object.keys(e);for(let n=0;n<r.length;n+=1){const i=r[n];oa(t,i,e[i])}}function yp(t,e){if(typeof e=="function"&&(e=e(t)),e=qo(e),Array.isArray(e)){if(t===e)return;let r=0,n=e.length;for(;r<n;r++){const i=e[r];t[r]!==i&&oa(t,r,i)}oa(t,"length",n)}else hm(t,e)}function Eo(t,e,r=[]){let n,i=t;if(e.length>1){n=e.shift();const a=typeof n,c=Array.isArray(t);if(Array.isArray(n)){for(let u=0;u<n.length;u++)Eo(t,[n[u]].concat(e),r);return}else if(c&&a==="function"){for(let u=0;u<t.length;u++)n(t[u],u)&&Eo(t,[u].concat(e),r);return}else if(c&&a==="object"){const{from:u=0,to:h=t.length-1,by:f=1}=n;for(let p=u;p<=h;p+=f)Eo(t,[p].concat(e),r);return}else if(e.length>1){Eo(t[n],e,[n].concat(r));return}i=t[n],r=[n].concat(r)}let o=e[0];typeof o=="function"&&(o=o(i,r),o===i)||n===void 0&&o==null||(o=qo(o),n===void 0||na(i)&&na(o)&&!Array.isArray(o)?hm(i,o):oa(t,n,o))}function mm(...[t,e]){const r=qo(t||{}),n=Array.isArray(r),i=um(r);function o(...a){Gh(()=>{n&&a.length===1?yp(r,a[0]):Eo(r,a)})}return[i,o]}const It=(t=300+Math.random()*700)=>new Promise(e=>setTimeout(e,t)),ci=(t="")=>`${t}${Date.now()}-${Math.random().toString(36).substr(2,9)}`;let Fe={products:[{id:"prod-001",name:"Wireless Headphones",sku:"WH-001",productCode:"WH-001",productName:"Wireless Headphones",description:"High-quality wireless bluetooth headphones",category:"Electronics",unitOfMeasure:"pcs",unitCost:45,sellingPrice:89.99,minStockLevel:10,maxStockLevel:100,isActive:!0,createdDate:"2024-01-15T10:00:00Z",lastModified:"2024-01-15T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-002",name:"USB-C Cable",sku:"USB-001",description:"3ft USB-C charging cable",category:"Accessories",unitOfMeasure:"pcs",unitCost:8.5,sellingPrice:19.99,minStockLevel:25,maxStockLevel:200,isActive:!0,createdDate:"2024-01-16T10:00:00Z",lastModified:"2024-01-16T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-003",name:"Laptop Stand",sku:"LS-001",description:"Adjustable aluminum laptop stand",category:"Office",unitOfMeasure:"pcs",unitCost:25,sellingPrice:49.99,minStockLevel:5,maxStockLevel:50,isActive:!0,createdDate:"2024-01-17T10:00:00Z",lastModified:"2024-01-17T10:00:00Z",businessId:"YB100423253156428"}],locations:[{id:"loc-001",name:"Main Warehouse",code:"WH-001",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-002",name:"Retail Store - Downtown",code:"ST-001",type:"store",address:"456 Main St, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-003",name:"Retail Store - Mall",code:"ST-002",type:"store",address:"789 Mall Blvd, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"}],movements:[{id:"mov-001",productId:"prod-001",productName:"Wireless Headphones",productSku:"WH-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:50,unitCost:45,totalCost:2250,referenceNumber:"PO-001",notes:"Initial stock purchase",createdBy:"admin",createdDate:"2024-01-15T10:00:00Z",invoiceId:"INV-1000001"},{id:"mov-002",productId:"prod-002",productName:"USB-C Cable",productSku:"USB-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:100,unitCost:8.5,totalCost:850,referenceNumber:"PO-001",notes:"Bulk purchase",createdBy:"admin",createdDate:"2024-01-15T10:05:00Z",invoiceId:"INV-1000001"}],accounts:[{id:"acc-001",accountNumber:"1000",accountName:"Cash",accountType:"asset",category:"currentAssets",balance:5e4,parentAccountId:null,description:"Cash and cash equivalents",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"},{id:"acc-002",accountNumber:"1100",accountName:"Accounts Receivable",accountType:"asset",category:"currentAssets",balance:25e3,parentAccountId:null,description:"Money owed by customers",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"}],journalEntries:[{id:"je-001",entryNumber:"JE-001",date:"2024-01-15",description:"Initial cash deposit",reference:"DEP-001",status:"posted",createdBy:"admin",createdAt:"2024-01-15T10:00:00Z",postedAt:"2024-01-15T10:05:00Z",lines:[{id:"jel-001",accountId:"acc-001",accountName:"Cash",description:"Initial deposit",debitAmount:5e4,creditAmount:0},{id:"jel-002",accountId:"acc-003",accountName:"Owner Equity",description:"Initial capital",debitAmount:0,creditAmount:5e4}]}]};const Xt=(t=.05)=>Math.random()<t,Zt=()=>{const t=["Network timeout","Connection refused","Server temporarily unavailable","Invalid request"];throw new Error(t[Math.floor(Math.random()*t.length)])},Nr={products:{async getAll(t,e){await It(),Xt()&&Zt();let r=[...Fe.products];if(t&&t.trim()){const n=t.toLowerCase();r=r.filter(i=>i.name.toLowerCase().includes(n)||i.sku.toLowerCase().includes(n)||i.category.toLowerCase().includes(n)||i.description.toLowerCase().includes(n))}return e?.category&&(r=r.filter(n=>n.category===e.category)),e?.isActive!==void 0&&(r=r.filter(n=>n.isActive===e.isActive)),r},async getById(t){return await It(),Xt()&&Zt(),Fe.products.find(e=>e.id===t)||null},async create(t){if(await It(),Xt()&&Zt(),Fe.products.some(r=>r.sku===t.sku))throw new Error("SKU already exists");const e={...t,id:ci("prod-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return Fe.products.push(e),e},async update(t,e){await It(),Xt()&&Zt();const r=Fe.products.findIndex(i=>i.id===t);if(r===-1)throw new Error("Product not found");if(e.sku&&Fe.products.some(i=>i.id!==t&&i.sku===e.sku))throw new Error("SKU already exists");const n={...Fe.products[r],...e,lastModified:new Date().toISOString()};return Fe.products[r]=n,n},async delete(t){await It(),Xt()&&Zt();const e=Fe.products.findIndex(n=>n.id===t);if(e===-1)throw new Error("Product not found");return Fe.movements.some(n=>n.productId===t)?{success:!1,message:"Cannot delete product with existing movements"}:(Fe.products.splice(e,1),{success:!0,message:"Product deleted successfully"})}},locations:{async getAll(t){await It(),Xt()&&Zt();let e=[...Fe.locations];return t?.type&&(e=e.filter(r=>r.type===t.type)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await It(),Fe.locations.find(e=>e.id===t)||null},async create(t){if(await It(),Xt()&&Zt(),Fe.locations.some(r=>r.code===t.code))throw new Error("Location code already exists");const e={...t,id:ci("loc-"),createdDate:new Date().toISOString()};return Fe.locations.push(e),e},async update(t,e){await It(),Xt()&&Zt();const r=Fe.locations.findIndex(n=>n.id===t);if(r===-1)throw new Error("Location not found");if(e.code&&Fe.locations.some(n=>n.id!==t&&n.code===e.code))throw new Error("Location code already exists");return Fe.locations[r]={...Fe.locations[r],...e},Fe.locations[r]}},movements:{async getAll(t){await It(),Xt()&&Zt();let e=[...Fe.movements];if(t?.productId&&(e=e.filter(r=>r.productId===t.productId)),t?.locationId&&(e=e.filter(r=>r.locationId===t.locationId)),t?.movementType&&(e=e.filter(r=>r.movementType===t.movementType)),t?.dateFrom&&(e=e.filter(r=>r.createdDate>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.createdDate<=t.dateTo)),t?.search){const r=t.search.toLowerCase();e=e.filter(n=>n.productName.toLowerCase().includes(r)||n.productSku.toLowerCase().includes(r)||n.referenceNumber.toLowerCase().includes(r)||n.notes.toLowerCase().includes(r))}return e.sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime()),e},async getById(t){return await It(),Fe.movements.find(e=>e.id===t)||null},async create(t){if(await It(),Xt()&&Zt(),!Fe.products.find(i=>i.id===t.productId))throw new Error("Product not found");if(!Fe.locations.find(i=>i.id===t.locationId))throw new Error("Location not found");if(t.movementType==="out"){const i=await this.getStockLevel(t.productId,t.locationId);if(i<t.quantity)throw new Error(`Insufficient stock. Available: ${i}, Requested: ${t.quantity}`)}const n={...t,id:ci("mov-"),createdDate:new Date().toISOString()};return Fe.movements.push(n),n},async update(t,e){await It(),Xt()&&Zt();const r=Fe.movements.findIndex(i=>i.id===t);if(r===-1)throw new Error("Movement not found");const n={...Fe.movements[r],...e,lastModified:new Date().toISOString()};return Fe.movements[r]=n,n},async delete(t){await It(),Xt()&&Zt();const e=Fe.movements.findIndex(r=>r.id===t);if(e===-1)throw new Error("Movement not found");return Fe.movements.splice(e,1),{success:!0,message:"Movement deleted successfully"}},async createBulk(t){await It(),Xt()&&Zt();const e=[],r=[],n=new Date().toISOString(),i=Fe.locations.find(o=>o.id===t.locationId);if(!i)return{success:!1,movements:[],errors:["Invalid location"]};for(let o=0;o<t.items.length;o++){const a=t.items[o],c=Fe.products.find(f=>f.id===a.productId);if(!c){e.push(`Item ${o+1}: Product not found`);continue}if(a.quantity<=0){e.push(`Item ${o+1}: Quantity must be greater than 0`);continue}if(t.movementType==="out"){const f=await this.getStockLevel(a.productId,t.locationId);if(a.quantity>f){e.push(`Item ${o+1}: Insufficient stock. Available: ${f}, Requested: ${a.quantity}`);continue}}const u=a.unitCost||c.unitCost,h={id:ci("mov-"),productId:c.id,productName:c.name,productSku:c.sku,locationId:t.locationId,locationName:i.name,movementType:t.movementType,quantity:a.quantity,unitCost:u,totalCost:a.quantity*u,referenceNumber:t.referenceNumber,notes:a.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:t.fromLocationId?Fe.locations.find(f=>f.id===t.fromLocationId)?.name:void 0};r.push(h)}return e.length>0?{success:!1,movements:[],errors:e}:(Fe.movements.push(...r),{success:!0,movements:r,errors:[]})},async getStockLevel(t,e){return await It(50),Fe.movements.filter(r=>r.productId===t&&r.locationId===e).reduce((r,n)=>{switch(n.movementType){case"in":case"adjustment":return r+n.quantity;case"out":return r-n.quantity;case"transfer":return n.locationId===e?r+n.quantity:r;default:return r}},0)},async getStockLevels(){await It();const t=new Map;for(const e of Fe.movements){const r=`${e.productId}-${e.locationId}`;let n=t.get(r);switch(n||(n={id:r,productId:e.productId,locationId:e.locationId,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType){case"in":case"adjustment":n.quantity+=e.quantity;break;case"out":n.quantity-=e.quantity;break;case"transfer":e.locationId===e.locationId&&(n.quantity+=e.quantity);break}new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost,n.availableQuantity=n.quantity-n.reservedQuantity}return Array.from(t.values())}},accounts:{async getAll(t){await It(),Xt()&&Zt();let e=[...Fe.accounts];return t?.accountType&&(e=e.filter(r=>r.accountType===t.accountType)),t?.category&&(e=e.filter(r=>r.category===t.category)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await It(),Fe.accounts.find(e=>e.id===t)||null},async create(t){if(await It(),Xt()&&Zt(),Fe.accounts.some(r=>r.accountNumber===t.accountNumber))throw new Error("Account number already exists");const e={...t,id:ci("acc-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return Fe.accounts.push(e),e},async update(t,e){await It(),Xt()&&Zt();const r=Fe.accounts.findIndex(n=>n.id===t);if(r===-1)throw new Error("Account not found");if(e.accountNumber&&Fe.accounts.some(n=>n.id!==t&&n.accountNumber===e.accountNumber))throw new Error("Account number already exists");return Fe.accounts[r]={...Fe.accounts[r],...e,lastModified:new Date().toISOString()},Fe.accounts[r]}},journal:{async getAll(t){await It(),Xt()&&Zt();let e=[...Fe.journalEntries];return t?.status&&(e=e.filter(r=>r.status===t.status)),t?.accountId&&(e=e.filter(r=>r.lines.some(n=>n.accountId===t.accountId))),t?.dateFrom&&(e=e.filter(r=>r.date>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.date<=t.dateTo)),e.sort((r,n)=>new Date(n.createdAt).getTime()-new Date(r.createdAt).getTime())},async getById(t){return await It(),Fe.journalEntries.find(e=>e.id===t)||null},async create(t){await It(),Xt()&&Zt();const e=t.lines.reduce((c,u)=>c+(u.debitAmount||0),0),r=t.lines.reduce((c,u)=>c+(u.creditAmount||0),0);if(Math.abs(e-r)>.01)throw new Error(`Entry is not balanced. Debit: ${e}, Credit: ${r}`);const n=Fe.journalEntries.sort((c,u)=>u.entryNumber.localeCompare(c.entryNumber))[0],o=`JE-${((n?parseInt(n.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`,a={...t,id:ci("je-"),entryNumber:o,createdAt:new Date().toISOString(),lines:t.lines.map(c=>({...c,id:ci("jel-")}))};return Fe.journalEntries.push(a),a},async update(t,e){await It(),Xt()&&Zt();const r=Fe.journalEntries.findIndex(n=>n.id===t);if(r===-1)throw new Error("Journal entry not found");if(Fe.journalEntries[r].status==="posted")throw new Error("Cannot modify posted entries");return Fe.journalEntries[r]={...Fe.journalEntries[r],...e},Fe.journalEntries[r]},async post(t){await It(),Xt()&&Zt();const e=Fe.journalEntries.findIndex(o=>o.id===t);if(e===-1)throw new Error("Journal entry not found");const r=Fe.journalEntries[e];if(r.status==="posted")throw new Error("Entry is already posted");const n=r.lines.reduce((o,a)=>o+(a.debitAmount||0),0),i=r.lines.reduce((o,a)=>o+(a.creditAmount||0),0);if(Math.abs(n-i)>.01)throw new Error("Entry must be balanced before posting");return Fe.journalEntries[e]={...r,status:"posted",postedAt:new Date().toISOString()},r.lines.forEach(o=>{const a=Fe.accounts.findIndex(c=>c.id===o.accountId);if(a!==-1){const c=Fe.accounts[a],u=o.debitAmount||0,h=o.creditAmount||0;["asset","expense"].includes(c.accountType)?c.balance+=u-h:c.balance+=h-u}}),Fe.journalEntries[e]}},utils:{async getNextEntryNumber(){await It(100);const t=Fe.journalEntries.sort((r,n)=>n.entryNumber.localeCompare(r.entryNumber))[0];return`JE-${((t?parseInt(t.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`},async getNextProductCode(t){await It(100);const e=t.toUpperCase().slice(0,3),r=Fe.products.filter(i=>i.productCode?.startsWith(e)).sort((i,o)=>(o.productCode||"").localeCompare(i.productCode||""));if(r.length===0)return`${e}001`;const n=parseInt(r[0].productCode?.slice(-3)||"0");return`${e}${(n+1).toString().padStart(3,"0")}`},async healthCheck(){return await It(50),{status:"healthy",timestamp:new Date().toISOString(),version:"1.0.0"}},async resetDatabase(){return await It(200),Fe={products:[...Fe.products.slice(0,3)],locations:[...Fe.locations.slice(0,3)],movements:[...Fe.movements.slice(0,2)],accounts:[...Fe.accounts.slice(0,2)],journalEntries:[...Fe.journalEntries.slice(0,1)]},{success:!0,message:"Database reset to initial state"}},async getStats(){return await It(100),{products:Fe.products.length,locations:Fe.locations.length,movements:Fe.movements.length,accounts:Fe.accounts.length,journalEntries:Fe.journalEntries.length,totalStockValue:Fe.movements.reduce((t,e)=>e.movementType==="in"?t+e.totalCost:e.movementType==="out"?t-e.totalCost:t,0)}}}},js=(t=16)=>{const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},zn=async t=>{const n=await fetch("https://qvamarkets.com/gql_api",{method:"POST",headers:{"Content-Type":"application/json","Accept-Encoding":"gzip, deflate, br",Authorization:"eyJhbGciOiJSUzI1NiIsImtpZCI6IjhlOGZjOGU1NTZmN2E3NmQwOGQzNTgyOWQ2ZjkwYWUyZTEyY2ZkMGQiLCJ0eXAiOiJKV1QifQ"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const i=await n.json();if(i.errors)throw new Error(i.errors[0]?.message||"GraphQL error");return i.data},gp=t=>({ENTRY:"in",in:"in",TRANSFER:"transfer",transfer:"transfer",SALES:"out",out:"out",adjustment:"adjustment"})[t],Ml=t=>({ENTRY:"ENTRY",in:"ENTRY",TRANSFER:"TRANSFER",transfer:"TRANSFER",SALES:"SALES",out:"SALES",adjustment:"adjustment"})[t];function pp(t){var e=[];return t&&Object.keys(t).map(r=>{e.push(t[r])}),e}function vp(t){if(!/^[a-z0-9+/]+={0,2}$/i.test(t)||t.length%4!=0)throw Error("Not base64 string");for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r,n,i,o,a,c,u,h,f=[],p=0;p<t.length;p+=4)o=e.indexOf(t.charAt(p)),a=e.indexOf(t.charAt(p+1)),c=e.indexOf(t.charAt(p+2)),u=e.indexOf(t.charAt(p+3)),h=o<<18|a<<12|c<<6|u,r=h>>>16&255,n=h>>>8&255,i=h&255,f[p/4]=String.fromCharCode(r,n,i),u==64&&(f[p/4]=String.fromCharCode(r,n)),c==64&&(f[p/4]=String.fromCharCode(r));return t=f.join(""),t}const bp=async()=>({}),_p=()=>(typeof window<"u"&&localStorage.getItem("hrmfinance-api-mode"),"real");let yi=_p();const Wo={getMode(){return yi},setMode(t){yi=t,typeof window<"u"&&localStorage.setItem("hrmfinance-api-mode",t)},isFakeMode(){return yi==="fake"},isRealMode(){return yi==="real"},isHybridMode(){return yi==="hybrid"}},Br=async(t,e,r=!0)=>{if(yi==="fake")return e();if(yi==="real")return t();try{return await t()}catch(n){if(console.warn("Real API failed, falling back to fake server:",n),r)return e();throw n}},Bu={async getAll(t,e){const r=await zn({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:{businessId:"YB100423253156428",":search0":"produ"}});return pp(r)},async getById(t){return Br(async()=>(await this.getAll()).find(r=>r.id===t)||null,()=>Nr.products.getById(t))},async create(t){return Br(async()=>{throw console.log("Creating product via real API:",t),new Error("Real API not implemented yet")},()=>Nr.products.create(t))},async update(t,e){return Br(async()=>{throw console.log("Updating product via real API:",t,e),new Error("Real API not implemented yet")},()=>Nr.products.update(t,e))},async delete(t){return Br(async()=>{throw console.log("Deleting product via real API:",t),new Error("Real API not implemented yet")},()=>Nr.products.delete(t))}},qn={async getInventory(t,e){if(!(t&&t?.trim()))return[];let r={businessId:"YB100423253156428"};return t&&t.split(" ").map((o,a)=>{o&&(r[":search"+a]=o.trim())}),await zn({query:"getScanYabaInventory",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async getProducts(t){if(!(t&&t?.trim()))return[];let e={businessId:"YB100423253156428"};return t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())}),await zn({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async addInventory(t){let r={query:"addYabaInventory",params:{businessId:"YB100423253156428"},form:t};const n=await zn(r);return console.log(r),console.log(n),n},async updInventory(t){return await bp()}},Fu={async getAll(t){return Br(async()=>{throw console.log("Getting accounts via real API:",t),new Error("Real API not implemented yet")},()=>Nr.accounts.getAll(t))},async getById(t){return Br(async()=>{throw console.log("Getting account by ID via real API:",t),new Error("Real API not implemented yet")},()=>Nr.accounts.getById(t))},async create(t){return Br(async()=>{throw console.log("Creating account via real API:",t),new Error("Real API not implemented yet")},()=>Nr.accounts.create(t))},async update(t,e){return Br(async()=>{throw console.log("Updating account via real API:",t,e),new Error("Real API not implemented yet")},()=>Nr.accounts.update(t,e))}},Uu={async getNextEntryNumber(){return Br(async()=>{throw console.log("Getting next entry number via real API"),new Error("Real API not implemented yet")},()=>Nr.utils.getNextEntryNumber())},async getNextProductCode(t){return Br(async()=>{throw console.log("Getting next product code via real API:",t),new Error("Real API not implemented yet")},()=>Nr.utils.getNextProductCode(t))},async healthCheck(){return Br(async()=>{const t=await fetch("/api/health");if(!t.ok)throw new Error("Health check failed");return t.json()},()=>Nr.utils.healthCheck())},async getStats(){return Br(async()=>{throw console.log("Getting stats via real API"),new Error("Real API not implemented yet")},()=>Nr.utils.getStats())}},Sp=()=>{Wo.setMode("real"),console.log(" HRM Finance initialized in REAL API mode for production")};Sp();const Pp=()=>{};var ju={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fm=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},wp=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[r++];e[n++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=t[r++],a=t[r++],c=t[r++],u=((i&7)<<18|(o&63)<<12|(a&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const o=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return e.join("")},ym={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const o=t[i],a=i+1<t.length,c=a?t[i+1]:0,u=i+2<t.length,h=u?t[i+2]:0,f=o>>2,p=(o&3)<<4|c>>4;let b=(c&15)<<2|h>>6,C=h&63;u||(C=64,a||(b=64)),n.push(r[f],r[p],r[b],r[C])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(fm(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):wp(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const o=r[t.charAt(i++)],c=i<t.length?r[t.charAt(i)]:0;++i;const h=i<t.length?r[t.charAt(i)]:64;++i;const p=i<t.length?r[t.charAt(i)]:64;if(++i,o==null||c==null||h==null||p==null)throw new Cp;const b=o<<2|c>>4;if(n.push(b),h!==64){const C=c<<4&240|h>>2;if(n.push(C),p!==64){const D=h<<6&192|p;n.push(D)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Cp extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Ap=function(t){const e=fm(t);return ym.encodeByteArray(e,!0)},sa=function(t){return Ap(t).replace(/\./g,"")},gm=function(t){try{return ym.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ip(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ep=()=>Ip().__FIREBASE_DEFAULTS__,xp=()=>{if(typeof process>"u"||typeof ju>"u")return;const t=ju.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Tp=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&gm(t[1]);return e&&JSON.parse(e)},Ta=()=>{try{return Pp()||Ep()||xp()||Tp()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},pm=t=>Ta()?.emulatorHosts?.[t],$p=t=>{const e=pm(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},vm=()=>Ta()?.config,bm=t=>Ta()?.[`_${t}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kp{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ao(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function _m(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rp(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...t};return[sa(JSON.stringify(r)),sa(JSON.stringify(a)),""].join(".")}const Lo={};function Dp(){const t={prod:[],emulator:[]};for(const e of Object.keys(Lo))Lo[e]?t.emulator.push(e):t.prod.push(e);return t}function Np(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let zu=!1;function Sm(t,e){if(typeof window>"u"||typeof document>"u"||!ao(window.location.host)||Lo[t]===e||Lo[t]||zu)return;Lo[t]=e;function r(b){return`__firebase__banner__${b}`}const n="__firebase__banner",o=Dp().prod.length>0;function a(){const b=document.getElementById(n);b&&b.remove()}function c(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function u(b,C){b.setAttribute("width","24"),b.setAttribute("id",C),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function h(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{zu=!0,a()},b}function f(b,C){b.setAttribute("id",C),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function p(){const b=Np(n),C=r("text"),D=document.getElementById(C)||document.createElement("span"),x=r("learnmore"),E=document.getElementById(x)||document.createElement("a"),T=r("preprendIcon"),H=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const te=b.element;c(te),f(E,x);const Y=h();u(H,T),te.append(H,D,E,Y),document.body.appendChild(te)}o?(D.innerText="Preview backend disconnected.",H.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(H.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,D.innerText="Preview backend running in this workspace."),D.setAttribute("id",C)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Lp(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Cr())}function Mp(){const t=Ta()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Op(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Vp(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Bp(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Fp(){const t=Cr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Up(){return!Mp()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function jp(){try{return typeof indexedDB=="object"}catch{return!1}}function zp(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qp="FirebaseError";class $n extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=qp,Object.setPrototypeOf(this,$n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,os.prototype.create)}}class os{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,o=this.errors[e],a=o?Hp(o,n):"Error",c=`${this.serviceName}: ${a} (${i}).`;return new $n(i,c,n)}}function Hp(t,e){return t.replace(Wp,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const Wp=/\{\$([^}]+)}/g;function Gp(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Si(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const o=t[i],a=e[i];if(qu(o)&&qu(a)){if(!Si(o,a))return!1}else if(o!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function qu(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ss(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Kp(t,e){const r=new Yp(t,e);return r.subscribe.bind(r)}class Yp{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");Qp(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=tl),i.error===void 0&&(i.error=tl),i.complete===void 0&&(i.complete=tl);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Qp(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function tl(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ur(t){return t&&t._delegate?t._delegate:t}class Pi{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jp{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new kp;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Zp(e))try{this.getOrInitializeService({instanceIdentifier:mi})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:i});n.resolve(o)}catch{}}}}clearInstance(e=mi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=mi){return this.instances.has(e)}getOptions(e=mi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[o,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(o);n===c&&a.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const o=this.instances.get(n);return o&&e(o,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Xp(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=mi){return this.component?this.component.multipleInstances?e:mi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Xp(t){return t===mi?void 0:t}function Zp(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ev{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new Jp(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(gt||(gt={}));const tv={debug:gt.DEBUG,verbose:gt.VERBOSE,info:gt.INFO,warn:gt.WARN,error:gt.ERROR,silent:gt.SILENT},rv=gt.INFO,nv={[gt.DEBUG]:"log",[gt.VERBOSE]:"log",[gt.INFO]:"info",[gt.WARN]:"warn",[gt.ERROR]:"error"},iv=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=nv[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class gc{constructor(e){this.name=e,this._logLevel=rv,this._logHandler=iv,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in gt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?tv[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,gt.DEBUG,...e),this._logHandler(this,gt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,gt.VERBOSE,...e),this._logHandler(this,gt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,gt.INFO,...e),this._logHandler(this,gt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,gt.WARN,...e),this._logHandler(this,gt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,gt.ERROR,...e),this._logHandler(this,gt.ERROR,...e)}}const ov=(t,e)=>e.some(r=>t instanceof r);let Hu,Wu;function sv(){return Hu||(Hu=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function av(){return Wu||(Wu=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Pm=new WeakMap,Ol=new WeakMap,wm=new WeakMap,rl=new WeakMap,pc=new WeakMap;function lv(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",a)},o=()=>{r(Hn(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&Pm.set(r,t)}).catch(()=>{}),pc.set(e,t),e}function cv(t){if(Ol.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",a),t.removeEventListener("abort",a)},o=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",a),t.addEventListener("abort",a)});Ol.set(t,e)}let Vl={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Ol.get(t);if(e==="objectStoreNames")return t.objectStoreNames||wm.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Hn(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function uv(t){Vl=t(Vl)}function dv(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(nl(this),e,...r);return wm.set(n,e.sort?e.sort():[e]),Hn(n)}:av().includes(t)?function(...e){return t.apply(nl(this),e),Hn(Pm.get(this))}:function(...e){return Hn(t.apply(nl(this),e))}}function hv(t){return typeof t=="function"?dv(t):(t instanceof IDBTransaction&&cv(t),ov(t,sv())?new Proxy(t,Vl):t)}function Hn(t){if(t instanceof IDBRequest)return lv(t);if(rl.has(t))return rl.get(t);const e=hv(t);return e!==t&&(rl.set(t,e),pc.set(e,t)),e}const nl=t=>pc.get(t);function mv(t,e,{blocked:r,upgrade:n,blocking:i,terminated:o}={}){const a=indexedDB.open(t,e),c=Hn(a);return n&&a.addEventListener("upgradeneeded",u=>{n(Hn(a.result),u.oldVersion,u.newVersion,Hn(a.transaction),u)}),r&&a.addEventListener("blocked",u=>r(u.oldVersion,u.newVersion,u)),c.then(u=>{o&&u.addEventListener("close",()=>o()),i&&u.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const fv=["get","getKey","getAll","getAllKeys","count"],yv=["put","add","delete","clear"],il=new Map;function Gu(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(il.get(e))return il.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=yv.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||fv.includes(r)))return;const o=async function(a,...c){const u=this.transaction(a,i?"readwrite":"readonly");let h=u.store;return n&&(h=h.index(c.shift())),(await Promise.all([h[r](...c),i&&u.done]))[0]};return il.set(e,o),o}uv(t=>({...t,get:(e,r,n)=>Gu(e,r)||t.get(e,r,n),has:(e,r)=>!!Gu(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gv{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(pv(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function pv(t){return t.getComponent()?.type==="VERSION"}const Bl="@firebase/app",Ku="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const An=new gc("@firebase/app"),vv="@firebase/app-compat",bv="@firebase/analytics-compat",_v="@firebase/analytics",Sv="@firebase/app-check-compat",Pv="@firebase/app-check",wv="@firebase/auth",Cv="@firebase/auth-compat",Av="@firebase/database",Iv="@firebase/data-connect",Ev="@firebase/database-compat",xv="@firebase/functions",Tv="@firebase/functions-compat",$v="@firebase/installations",kv="@firebase/installations-compat",Rv="@firebase/messaging",Dv="@firebase/messaging-compat",Nv="@firebase/performance",Lv="@firebase/performance-compat",Mv="@firebase/remote-config",Ov="@firebase/remote-config-compat",Vv="@firebase/storage",Bv="@firebase/storage-compat",Fv="@firebase/firestore",Uv="@firebase/ai",jv="@firebase/firestore-compat",zv="firebase",qv="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fl="[DEFAULT]",Hv={[Bl]:"fire-core",[vv]:"fire-core-compat",[_v]:"fire-analytics",[bv]:"fire-analytics-compat",[Pv]:"fire-app-check",[Sv]:"fire-app-check-compat",[wv]:"fire-auth",[Cv]:"fire-auth-compat",[Av]:"fire-rtdb",[Iv]:"fire-data-connect",[Ev]:"fire-rtdb-compat",[xv]:"fire-fn",[Tv]:"fire-fn-compat",[$v]:"fire-iid",[kv]:"fire-iid-compat",[Rv]:"fire-fcm",[Dv]:"fire-fcm-compat",[Nv]:"fire-perf",[Lv]:"fire-perf-compat",[Mv]:"fire-rc",[Ov]:"fire-rc-compat",[Vv]:"fire-gcs",[Bv]:"fire-gcs-compat",[Fv]:"fire-fst",[jv]:"fire-fst-compat",[Uv]:"fire-vertex","fire-js":"fire-js",[zv]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aa=new Map,Wv=new Map,Ul=new Map;function Yu(t,e){try{t.container.addComponent(e)}catch(r){An.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Xi(t){const e=t.name;if(Ul.has(e))return An.debug(`There were multiple attempts to register component ${e}.`),!1;Ul.set(e,t);for(const r of aa.values())Yu(r,t);for(const r of Wv.values())Yu(r,t);return!0}function vc(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Mr(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gv={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Wn=new os("app","Firebase",Gv);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Pi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Wn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lo=qv;function Cm(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:Fl,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw Wn.create("bad-app-name",{appName:String(i)});if(r||(r=vm()),!r)throw Wn.create("no-options");const o=aa.get(i);if(o){if(Si(r,o.options)&&Si(n,o.config))return o;throw Wn.create("duplicate-app",{appName:i})}const a=new ev(i);for(const u of Ul.values())a.addComponent(u);const c=new Kv(r,n,a);return aa.set(i,c),c}function Am(t=Fl){const e=aa.get(t);if(!e&&t===Fl&&vm())return Cm();if(!e)throw Wn.create("no-app",{appName:t});return e}function Gn(t,e,r){let n=Hv[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${n}" with version "${e}":`];i&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),An.warn(a.join(" "));return}Xi(new Pi(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yv="firebase-heartbeat-database",Qv=1,Go="firebase-heartbeat-store";let ol=null;function Im(){return ol||(ol=mv(Yv,Qv,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Go)}catch(r){console.warn(r)}}}}).catch(t=>{throw Wn.create("idb-open",{originalErrorMessage:t.message})})),ol}async function Jv(t){try{const r=(await Im()).transaction(Go),n=await r.objectStore(Go).get(Em(t));return await r.done,n}catch(e){if(e instanceof $n)An.warn(e.message);else{const r=Wn.create("idb-get",{originalErrorMessage:e?.message});An.warn(r.message)}}}async function Qu(t,e){try{const n=(await Im()).transaction(Go,"readwrite");await n.objectStore(Go).put(e,Em(t)),await n.done}catch(r){if(r instanceof $n)An.warn(r.message);else{const n=Wn.create("idb-set",{originalErrorMessage:r?.message});An.warn(n.message)}}}function Em(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xv=1024,Zv=30;class eb{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new rb(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Ju();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>Zv){const i=nb(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){An.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Ju(),{heartbeatsToSend:r,unsentEntries:n}=tb(this._heartbeatsCache.heartbeats),i=sa(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return An.warn(e),""}}}function Ju(){return new Date().toISOString().substring(0,10)}function tb(t,e=Xv){const r=[];let n=t.slice();for(const i of t){const o=r.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),Xu(r)>e){o.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),Xu(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class rb{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return jp()?zp().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Jv(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Qu(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Qu(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Xu(t){return sa(JSON.stringify({version:2,heartbeats:t})).length}function nb(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ib(t){Xi(new Pi("platform-logger",e=>new gv(e),"PRIVATE")),Xi(new Pi("heartbeat",e=>new eb(e),"PRIVATE")),Gn(Bl,Ku,t),Gn(Bl,Ku,"esm2020"),Gn("fire-js","")}ib("");function xm(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ob=xm,Tm=new os("auth","Firebase",xm());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const la=new gc("@firebase/auth");function sb(t,...e){la.logLevel<=gt.WARN&&la.warn(`Auth (${lo}): ${t}`,...e)}function zs(t,...e){la.logLevel<=gt.ERROR&&la.error(`Auth (${lo}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cn(t,...e){throw _c(t,...e)}function Kr(t,...e){return _c(t,...e)}function bc(t,e,r){const n={...ob(),[e]:r};return new os("auth","Firebase",n).create(e,{appName:t.name})}function Kn(t){return bc(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function $m(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&cn(t,"argument-error"),bc(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function _c(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return Tm.create(t,...e)}function it(t,e,...r){if(!t)throw _c(e,...r)}function _n(t){const e="INTERNAL ASSERTION FAILED: "+t;throw zs(e),new Error(e)}function In(t,e){t||_n(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jl(){return typeof self<"u"&&self.location?.href||""}function ab(){return Zu()==="http:"||Zu()==="https:"}function Zu(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lb(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(ab()||Vp()||"connection"in navigator)?navigator.onLine:!0}function cb(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(e,r){this.shortDelay=e,this.longDelay=r,In(r>e,"Short delay should be less than long delay!"),this.isMobile=Lp()||Bp()}get(){return lb()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sc(t,e){In(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class km{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;_n("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;_n("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;_n("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ub={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const db=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],hb=new as(3e4,6e4);function Pc(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function co(t,e,r,n,i={}){return Rm(t,i,async()=>{let o={},a={};n&&(e==="GET"?a=n:o={body:JSON.stringify(n)});const c=ss({key:t.config.apiKey,...a}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const h={method:e,headers:u,...o};return Op()||(h.referrerPolicy="no-referrer"),t.emulatorConfig&&ao(t.emulatorConfig.host)&&(h.credentials="include"),km.fetch()(await Dm(t,t.config.apiHost,r,c),h)})}async function Rm(t,e,r){t._canInitEmulator=!1;const n={...ub,...e};try{const i=new fb(t),o=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await o.json();if("needConfirmation"in a)throw As(t,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{const c=o.ok?a.errorMessage:a.error.message,[u,h]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw As(t,"credential-already-in-use",a);if(u==="EMAIL_EXISTS")throw As(t,"email-already-in-use",a);if(u==="USER_DISABLED")throw As(t,"user-disabled",a);const f=n[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw bc(t,f,h);cn(t,f)}}catch(i){if(i instanceof $n)throw i;cn(t,"network-request-failed",{message:String(i)})}}async function mb(t,e,r,n,i={}){const o=await co(t,e,r,n,i);return"mfaPendingCredential"in o&&cn(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function Dm(t,e,r,n){const i=`${e}${r}?${n}`,o=t,a=o.config.emulator?Sc(t.config,i):`${t.config.apiScheme}://${i}`;return db.includes(r)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(a).toString():a}class fb{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Kr(this.auth,"network-request-failed")),hb.get())})}}function As(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Kr(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yb(t,e){return co(t,"POST","/v1/accounts:delete",e)}async function ca(t,e){return co(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mo(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function gb(t,e=!1){const r=Ur(t),n=await r.getIdToken(e),i=wc(n);it(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,a=o?.sign_in_provider;return{claims:i,token:n,authTime:Mo(sl(i.auth_time)),issuedAtTime:Mo(sl(i.iat)),expirationTime:Mo(sl(i.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}}function sl(t){return Number(t)*1e3}function wc(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return zs("JWT malformed, contained fewer than 3 sections"),null;try{const i=gm(r);return i?JSON.parse(i):(zs("Failed to decode base64 JWT payload"),null)}catch(i){return zs("Caught error parsing JWT payload as JSON",i?.toString()),null}}function ed(t){const e=wc(t);return it(e,"internal-error"),it(typeof e.exp<"u","internal-error"),it(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ko(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof $n&&pb(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function pb({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vb{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zl{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Mo(this.lastLoginAt),this.creationTime=Mo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ua(t){const e=t.auth,r=await t.getIdToken(),n=await Ko(t,ca(e,{idToken:r}));it(n?.users.length,e,"internal-error");const i=n.users[0];t._notifyReloadListener(i);const o=i.providerUserInfo?.length?Nm(i.providerUserInfo):[],a=_b(t.providerData,o),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!a?.length,h=c?u:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new zl(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(t,f)}async function bb(t){const e=Ur(t);await ua(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function _b(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function Nm(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sb(t,e){const r=await Rm(t,{},async()=>{const n=ss({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=t.config,a=await Dm(t,i,"/v1/token",`key=${o}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:n};return t.emulatorConfig&&ao(t.emulatorConfig.host)&&(u.credentials="include"),km.fetch()(a,u)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function Pb(t,e){return co(t,"POST","/v2/accounts:revokeToken",Pc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){it(e.idToken,"internal-error"),it(typeof e.idToken<"u","internal-error"),it(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ed(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){it(e.length!==0,"internal-error");const r=ed(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(it(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:o}=await Sb(e,r);this.updateTokensAndExpiration(n,i,Number(o))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:o}=r,a=new Ki;return n&&(it(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(it(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),o&&(it(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ki,this.toJSON())}_performRefresh(){return _n("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ln(t,e){it(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Wr{constructor({uid:e,auth:r,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new vb(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new zl(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await Ko(this,this.stsTokenManager.getToken(this.auth,e));return it(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return gb(this,e)}reload(){return bb(this)}_assign(e){this!==e&&(it(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Wr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){it(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await ua(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Mr(this.auth.app))return Promise.reject(Kn(this.auth));const e=await this.getIdToken();return await Ko(this,yb(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,i=r.email??void 0,o=r.phoneNumber??void 0,a=r.photoURL??void 0,c=r.tenantId??void 0,u=r._redirectEventId??void 0,h=r.createdAt??void 0,f=r.lastLoginAt??void 0,{uid:p,emailVerified:b,isAnonymous:C,providerData:D,stsTokenManager:x}=r;it(p&&x,e,"internal-error");const E=Ki.fromJSON(this.name,x);it(typeof p=="string",e,"internal-error"),Ln(n,e.name),Ln(i,e.name),it(typeof b=="boolean",e,"internal-error"),it(typeof C=="boolean",e,"internal-error"),Ln(o,e.name),Ln(a,e.name),Ln(c,e.name),Ln(u,e.name),Ln(h,e.name),Ln(f,e.name);const T=new Wr({uid:p,auth:e,email:i,emailVerified:b,displayName:n,isAnonymous:C,photoURL:a,phoneNumber:o,tenantId:c,stsTokenManager:E,createdAt:h,lastLoginAt:f});return D&&Array.isArray(D)&&(T.providerData=D.map(H=>({...H}))),u&&(T._redirectEventId=u),T}static async _fromIdTokenResponse(e,r,n=!1){const i=new Ki;i.updateFromServerResponse(r);const o=new Wr({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await ua(o),o}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];it(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?Nm(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!o?.length,c=new Ki;c.updateFromIdToken(n);const u=new Wr({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:a}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new zl(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(u,h),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const td=new Map;function Sn(t){In(t instanceof Function,"Expected a class definition");let e=td.get(t);return e?(In(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,td.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lm{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}Lm.type="NONE";const rd=Lm;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qs(t,e,r){return`firebase:${t}:${e}:${r}`}class Yi{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:o}=this.auth;this.fullUserKey=qs(this.userKey,i.apiKey,o),this.fullPersistenceKey=qs("persistence",i.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await ca(this.auth,{idToken:e}).catch(()=>{});return r?Wr._fromGetAccountInfoResponse(this.auth,r,e):null}return Wr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Yi(Sn(rd),e,n);const i=(await Promise.all(r.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let o=i[0]||Sn(rd);const a=qs(n,e.config.apiKey,e.name);let c=null;for(const h of r)try{const f=await h._get(a);if(f){let p;if(typeof f=="string"){const b=await ca(e,{idToken:f}).catch(()=>{});if(!b)break;p=await Wr._fromGetAccountInfoResponse(e,b,f)}else p=Wr._fromJSON(e,f);h!==o&&(c=p),o=h;break}}catch{}const u=i.filter(h=>h._shouldAllowMigration);return!o._shouldAllowMigration||!u.length?new Yi(o,e,n):(o=u[0],c&&await o._set(a,c.toJSON()),await Promise.all(r.map(async h=>{if(h!==o)try{await h._remove(a)}catch{}})),new Yi(o,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nd(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Bm(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Mm(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Um(e))return"Blackberry";if(jm(e))return"Webos";if(Om(e))return"Safari";if((e.includes("chrome/")||Vm(e))&&!e.includes("edge/"))return"Chrome";if(Fm(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function Mm(t=Cr()){return/firefox\//i.test(t)}function Om(t=Cr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Vm(t=Cr()){return/crios\//i.test(t)}function Bm(t=Cr()){return/iemobile/i.test(t)}function Fm(t=Cr()){return/android/i.test(t)}function Um(t=Cr()){return/blackberry/i.test(t)}function jm(t=Cr()){return/webos/i.test(t)}function Cc(t=Cr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function wb(t=Cr()){return Cc(t)&&!!window.navigator?.standalone}function Cb(){return Fp()&&document.documentMode===10}function zm(t=Cr()){return Cc(t)||Fm(t)||jm(t)||Um(t)||/windows phone/i.test(t)||Bm(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qm(t,e=[]){let r;switch(t){case"Browser":r=nd(Cr());break;case"Worker":r=`${nd(Cr())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${lo}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ab{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=o=>new Promise((a,c)=>{try{const u=e(o);a(u)}catch(u){c(u)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ib(t,e={}){return co(t,"GET","/v2/passwordPolicy",Pc(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eb=6;class xb{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??Eb,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tb{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new id(this),this.idTokenSubscription=new id(this),this.beforeStateQueue=new Ab(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Tm,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Sn(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Yi.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await ca(this,{idToken:e}),n=await Wr._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Mr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=this.redirectUser?._redirectEventId,a=n?._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(n=c.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return it(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await ua(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=cb()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Mr(this.app))return Promise.reject(Kn(this));const r=e?Ur(e):null;return r&&it(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&it(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Mr(this.app)?Promise.reject(Kn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Mr(this.app)?Promise.reject(Kn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Sn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Ib(this),r=new xb(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new os("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await Pb(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Sn(e)||this._popupRedirectResolver;it(r,this,"argument-error"),this.redirectPersistenceManager=await Yi.create(this,[Sn(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const o=typeof r=="function"?r:r.next.bind(r);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(it(c,this,"internal-error"),c.then(()=>{a||o(this.currentUser)}),typeof r=="function"){const u=e.addObserver(r,n,i);return()=>{a=!0,u()}}else{const u=e.addObserver(r);return()=>{a=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return it(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=qm(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(Mr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&sb(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Ei(t){return Ur(t)}class id{constructor(e){this.auth=e,this.observer=null,this.addObserver=Kp(r=>this.observer=r)}get next(){return it(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ac={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function $b(t){Ac=t}function kb(t){return Ac.loadJS(t)}function Rb(){return Ac.gapiScript}function Db(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nb(t,e){const r=vc(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),o=r.getOptions();if(Si(o,e??{}))return i;cn(i,"already-initialized")}return r.initialize({options:e})}function Lb(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(Sn);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function Mb(t,e,r){const n=Ei(t);it(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,o=Hm(e),{host:a,port:c}=Ob(e),u=c===null?"":`:${c}`,h={url:`${o}//${a}${u}/`},f=Object.freeze({host:a,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){it(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),it(Si(h,n.config.emulator)&&Si(f,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=h,n.emulatorConfig=f,n.settings.appVerificationDisabledForTesting=!0,ao(a)?(_m(`${o}//${a}${u}`),Sm("Auth",!0)):Vb()}function Hm(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Ob(t){const e=Hm(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const o=i[1];return{host:o,port:od(n.substr(o.length+1))}}else{const[o,a]=n.split(":");return{host:o,port:od(a)}}}function od(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Vb(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wm{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return _n("not implemented")}_getIdTokenResponse(e){return _n("not implemented")}_linkToIdToken(e,r){return _n("not implemented")}_getReauthenticationResolver(e){return _n("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qi(t,e){return mb(t,"POST","/v1/accounts:signInWithIdp",Pc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bb="http://localhost";class wi extends Wm{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new wi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):cn("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...o}=r;if(!n||!i)return null;const a=new wi(n,i);return a.idToken=o.idToken||void 0,a.accessToken=o.accessToken||void 0,a.secret=o.secret,a.nonce=o.nonce,a.pendingToken=o.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return Qi(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Qi(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Qi(e,r)}buildRequest(){const e={requestUri:Bb,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=ss(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls extends $a{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn extends ls{constructor(){super("facebook.com")}static credential(e){return wi._fromParams({providerId:Bn.PROVIDER_ID,signInMethod:Bn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Bn.credentialFromTaggedObject(e)}static credentialFromError(e){return Bn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Bn.credential(e.oauthAccessToken)}catch{return null}}}Bn.FACEBOOK_SIGN_IN_METHOD="facebook.com";Bn.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn extends ls{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return wi._fromParams({providerId:rn.PROVIDER_ID,signInMethod:rn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return rn.credentialFromTaggedObject(e)}static credentialFromError(e){return rn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return rn.credential(r,n)}catch{return null}}}rn.GOOGLE_SIGN_IN_METHOD="google.com";rn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn extends ls{constructor(){super("github.com")}static credential(e){return wi._fromParams({providerId:Fn.PROVIDER_ID,signInMethod:Fn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fn.credentialFromTaggedObject(e)}static credentialFromError(e){return Fn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fn.credential(e.oauthAccessToken)}catch{return null}}}Fn.GITHUB_SIGN_IN_METHOD="github.com";Fn.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un extends ls{constructor(){super("twitter.com")}static credential(e,r){return wi._fromParams({providerId:Un.PROVIDER_ID,signInMethod:Un.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Un.credentialFromTaggedObject(e)}static credentialFromError(e){return Un.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Un.credential(r,n)}catch{return null}}}Un.TWITTER_SIGN_IN_METHOD="twitter.com";Un.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const o=await Wr._fromIdTokenResponse(e,n,i),a=sd(n);return new Zi({user:o,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=sd(n);return new Zi({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function sd(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da extends $n{constructor(e,r,n,i){super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,da.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new da(e,r,n,i)}}function Gm(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?da._fromErrorAndOperation(t,o,e,n):o})}async function Fb(t,e,r=!1){const n=await Ko(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Zi._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ub(t,e,r=!1){const{auth:n}=t;if(Mr(n.app))return Promise.reject(Kn(n));const i="reauthenticate";try{const o=await Ko(t,Gm(n,i,e,t),r);it(o.idToken,n,"internal-error");const a=wc(o.idToken);it(a,n,"internal-error");const{sub:c}=a;return it(t.uid===c,n,"user-mismatch"),Zi._forOperation(t,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&cn(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Km(t,e,r=!1){if(Mr(t.app))return Promise.reject(Kn(t));const n="signIn",i=await Gm(t,n,e),o=await Zi._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(o.user),o}async function jb(t,e){return Km(Ei(t),e)}function zb(t,e,r,n){return Ur(t).onIdTokenChanged(e,r,n)}function qb(t,e,r){return Ur(t).beforeAuthStateChanged(e,r)}function Hb(t,e,r,n){return Ur(t).onAuthStateChanged(e,r,n)}function Wb(t){return Ur(t).signOut()}const ha="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ym{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(ha,"1"),this.storage.removeItem(ha),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gb=1e3,Kb=10;class Qm extends Ym{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=zm(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,c,u)=>{this.notifyListeners(a,u)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},o=this.storage.getItem(n);Cb()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Kb):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},Gb)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}Qm.type="LOCAL";const Yb=Qm;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jm extends Ym{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}Jm.type="SESSION";const Xm=Jm;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qb(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new ka(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:o}=r.data,a=this.handlersMap[i];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const c=Array.from(a).map(async h=>h(r.origin,o)),u=await Qb(c);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:u})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ka.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ic(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,a;return new Promise((c,u)=>{const h=Ic("",20);i.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(p){const b=p;if(b.data.eventId===h)switch(b.data.status){case"ack":clearTimeout(f),o=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),c(b.data.response);break;default:clearTimeout(f),clearTimeout(o),u(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:h,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nn(){return window}function Xb(t){nn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zm(){return typeof nn().WorkerGlobalScope<"u"&&typeof nn().importScripts=="function"}async function Zb(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function e0(){return navigator?.serviceWorker?.controller||null}function t0(){return Zm()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ef="firebaseLocalStorageDb",r0=1,ma="firebaseLocalStorage",tf="fbase_key";class cs{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Ra(t,e){return t.transaction([ma],e?"readwrite":"readonly").objectStore(ma)}function n0(){const t=indexedDB.deleteDatabase(ef);return new cs(t).toPromise()}function ql(){const t=indexedDB.open(ef,r0);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(ma,{keyPath:tf})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(ma)?e(n):(n.close(),await n0(),e(await ql()))})})}async function ad(t,e,r){const n=Ra(t,!0).put({[tf]:e,value:r});return new cs(n).toPromise()}async function i0(t,e){const r=Ra(t,!1).get(e),n=await new cs(r).toPromise();return n===void 0?null:n.value}function ld(t,e){const r=Ra(t,!0).delete(e);return new cs(r).toPromise()}const o0=800,s0=3;class rf{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ql(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>s0)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Zm()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ka._getInstance(t0()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await Zb(),!this.activeServiceWorker)return;this.sender=new Jb(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||e0()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ql();return await ad(e,ha,"1"),await ld(e,ha),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>ad(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>i0(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>ld(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=Ra(i,!1).getAll();return new cs(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),o0)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}rf.type="LOCAL";const a0=rf;new as(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ec(t,e){return e?Sn(e):(it(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc extends Wm{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Qi(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Qi(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Qi(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function l0(t){return Km(t.auth,new xc(t),t.bypassAuthState)}function c0(t){const{auth:e,user:r}=t;return it(r,e,"internal-error"),Ub(r,new xc(t),t.bypassAuthState)}async function u0(t){const{auth:e,user:r}=t;return it(r,e,"internal-error"),Fb(r,new xc(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(e,r,n,i,o=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:o,error:a,type:c}=e;if(a){this.reject(a);return}const u={auth:this.auth,requestUri:r,sessionId:n,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return l0;case"linkViaPopup":case"linkViaRedirect":return u0;case"reauthViaPopup":case"reauthViaRedirect":return c0;default:cn(this.auth,"internal-error")}}resolve(e){In(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){In(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d0=new as(2e3,1e4);async function h0(t,e,r){if(Mr(t.app))return Promise.reject(Kr(t,"operation-not-supported-in-this-environment"));const n=Ei(t);$m(t,e,$a);const i=Ec(n,r);return new pi(n,"signInViaPopup",e,i).executeNotNull()}class pi extends nf{constructor(e,r,n,i,o){super(e,r,i,o),this.provider=n,this.authWindow=null,this.pollId=null,pi.currentPopupAction&&pi.currentPopupAction.cancel(),pi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return it(e,this.auth,"internal-error"),e}async onExecution(){In(this.filter.length===1,"Popup operations only handle one event");const e=Ic();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Kr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Kr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,pi.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Kr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,d0.get())};e()}}pi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m0="pendingRedirect",Hs=new Map;class f0 extends nf{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Hs.get(this.auth._key());if(!e){try{const n=await y0(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Hs.set(this.auth._key(),e)}return this.bypassAuthState||Hs.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function y0(t,e){const r=sf(e),n=of(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}async function g0(t,e){return of(t)._set(sf(e),"true")}function p0(t,e){Hs.set(t._key(),e)}function of(t){return Sn(t._redirectPersistence)}function sf(t){return qs(m0,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v0(t,e,r){return b0(t,e,r)}async function b0(t,e,r){if(Mr(t.app))return Promise.reject(Kn(t));const n=Ei(t);$m(t,e,$a),await n._initializationPromise;const i=Ec(n,r);return await g0(i,n),i._openRedirect(n,e,"signInViaRedirect")}async function _0(t,e){return await Ei(t)._initializationPromise,af(t,e,!1)}async function af(t,e,r=!1){if(Mr(t.app))return Promise.reject(Kn(t));const n=Ei(t),i=Ec(n,e),a=await new f0(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S0=10*60*1e3;class P0{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!w0(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!lf(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(Kr(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=S0&&this.cachedEventUids.clear(),this.cachedEventUids.has(cd(e))}saveEventToCache(e){this.cachedEventUids.add(cd(e)),this.lastProcessedEventTime=Date.now()}}function cd(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function lf({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function w0(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return lf(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C0(t,e={}){return co(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A0=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,I0=/^https?/;async function E0(t){if(t.config.emulator)return;const{authorizedDomains:e}=await C0(t);for(const r of e)try{if(x0(r))return}catch{}cn(t,"unauthorized-domain")}function x0(t){const e=jl(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!I0.test(r))return!1;if(A0.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T0=new as(3e4,6e4);function ud(){const t=nn().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function $0(t){return new Promise((e,r)=>{function n(){ud(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ud(),r(Kr(t,"network-request-failed"))},timeout:T0.get()})}if(nn().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(nn().gapi?.load)n();else{const i=Db("iframefcb");return nn()[i]=()=>{gapi.load?n():r(Kr(t,"network-request-failed"))},kb(`${Rb()}?onload=${i}`).catch(o=>r(o))}}).catch(e=>{throw Ws=null,e})}let Ws=null;function k0(t){return Ws=Ws||$0(t),Ws}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R0=new as(5e3,15e3),D0="__/auth/iframe",N0="emulator/auth/iframe",L0={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},M0=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function O0(t){const e=t.config;it(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Sc(e,N0):`https://${t.config.authDomain}/${D0}`,n={apiKey:e.apiKey,appName:t.name,v:lo},i=M0.get(t.config.apiHost);i&&(n.eid=i);const o=t._getFrameworks();return o.length&&(n.fw=o.join(",")),`${r}?${ss(n).slice(1)}`}async function V0(t){const e=await k0(t),r=nn().gapi;return it(r,t,"internal-error"),e.open({where:document.body,url:O0(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:L0,dontclear:!0},n=>new Promise(async(i,o)=>{await n.restyle({setHideOnLeave:!1});const a=Kr(t,"network-request-failed"),c=nn().setTimeout(()=>{o(a)},R0.get());function u(){nn().clearTimeout(c),i(n)}n.ping(u).then(u,()=>{o(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B0={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},F0=500,U0=600,j0="_blank",z0="http://localhost";class dd{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function q0(t,e,r,n=F0,i=U0){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const u={...B0,width:n.toString(),height:i.toString(),top:o,left:a},h=Cr().toLowerCase();r&&(c=Vm(h)?j0:r),Mm(h)&&(e=e||z0,u.scrollbars="yes");const f=Object.entries(u).reduce((b,[C,D])=>`${b}${C}=${D},`,"");if(wb(h)&&c!=="_self")return H0(e||"",c),new dd(null);const p=window.open(e||"",c,f);it(p,t,"popup-blocked");try{p.focus()}catch{}return new dd(p)}function H0(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W0="__/auth/handler",G0="emulator/auth/handler",K0=encodeURIComponent("fac");async function hd(t,e,r,n,i,o){it(t.config.authDomain,t,"auth-domain-config-required"),it(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:lo,eventId:i};if(e instanceof $a){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",Gp(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))a[f]=p}if(e instanceof ls){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const c=a;for(const f of Object.keys(c))c[f]===void 0&&delete c[f];const u=await t._getAppCheckToken(),h=u?`#${K0}=${encodeURIComponent(u)}`:"";return`${Y0(t)}?${ss(c).slice(1)}${h}`}function Y0({config:t}){return t.emulator?Sc(t,G0):`https://${t.authDomain}/${W0}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const al="webStorageSupport";class Q0{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Xm,this._completeRedirectFn=af,this._overrideRedirectResult=p0}async _openPopup(e,r,n,i){In(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const o=await hd(e,r,n,jl(),i);return q0(e,o,Ic())}async _openRedirect(e,r,n,i){await this._originValidation(e);const o=await hd(e,r,n,jl(),i);return Xb(o),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:o}=this.eventManagers[r];return i?Promise.resolve(i):(In(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await V0(e),n=new P0(e);return r.register("authEvent",i=>(it(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(al,{type:al},i=>{const o=i?.[0]?.[al];o!==void 0&&r(!!o),cn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=E0(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return zm()||Om()||Cc()}}const J0=Q0;var md="@firebase/auth",fd="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){it(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z0(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function e_(t){Xi(new Pi("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=n.options;it(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const u={apiKey:a,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:qm(t)},h=new Tb(n,i,o,u);return Lb(h,r),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Xi(new Pi("auth-internal",e=>{const r=Ei(e.getProvider("auth").getImmediate());return(n=>new X0(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Gn(md,fd,Z0(t)),Gn(md,fd,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t_=5*60,r_=bm("authIdTokenMaxAge")||t_;let yd=null;const n_=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>r_)return;const i=r?.token;yd!==i&&(yd=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function i_(t=Am()){const e=vc(t,"auth");if(e.isInitialized())return e.getImmediate();const r=Nb(t,{popupRedirectResolver:J0,persistence:[a0,Yb,Xm]}),n=bm("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const a=n_(o.toString());qb(r,a,()=>a(r.currentUser)),zb(r,c=>a(c))}}const i=pm("auth");return i&&Mb(r,`http://${i}`),r}function o_(){return document.getElementsByTagName("head")?.[0]??document}$b({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const o=Kr("internal-error");o.customData=i,r(o)},n.type="text/javascript",n.charset="UTF-8",o_().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});e_("Browser");var s_="firebase",a_="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Gn(s_,a_,"app");var gd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Yn,cf;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,_){function v(){}v.prototype=_.prototype,I.D=_.prototype,I.prototype=new v,I.prototype.constructor=I,I.C=function(P,w,A){for(var y=Array(arguments.length-2),he=2;he<arguments.length;he++)y[he-2]=arguments[he];return _.prototype[w].apply(P,y)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,_,v){v||(v=0);var P=Array(16);if(typeof _=="string")for(var w=0;16>w;++w)P[w]=_.charCodeAt(v++)|_.charCodeAt(v++)<<8|_.charCodeAt(v++)<<16|_.charCodeAt(v++)<<24;else for(w=0;16>w;++w)P[w]=_[v++]|_[v++]<<8|_[v++]<<16|_[v++]<<24;_=I.g[0],v=I.g[1],w=I.g[2];var A=I.g[3],y=_+(A^v&(w^A))+P[0]+3614090360&4294967295;_=v+(y<<7&4294967295|y>>>25),y=A+(w^_&(v^w))+P[1]+3905402710&4294967295,A=_+(y<<12&4294967295|y>>>20),y=w+(v^A&(_^v))+P[2]+606105819&4294967295,w=A+(y<<17&4294967295|y>>>15),y=v+(_^w&(A^_))+P[3]+3250441966&4294967295,v=w+(y<<22&4294967295|y>>>10),y=_+(A^v&(w^A))+P[4]+4118548399&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(w^_&(v^w))+P[5]+1200080426&4294967295,A=_+(y<<12&4294967295|y>>>20),y=w+(v^A&(_^v))+P[6]+2821735955&4294967295,w=A+(y<<17&4294967295|y>>>15),y=v+(_^w&(A^_))+P[7]+4249261313&4294967295,v=w+(y<<22&4294967295|y>>>10),y=_+(A^v&(w^A))+P[8]+1770035416&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(w^_&(v^w))+P[9]+2336552879&4294967295,A=_+(y<<12&4294967295|y>>>20),y=w+(v^A&(_^v))+P[10]+4294925233&4294967295,w=A+(y<<17&4294967295|y>>>15),y=v+(_^w&(A^_))+P[11]+2304563134&4294967295,v=w+(y<<22&4294967295|y>>>10),y=_+(A^v&(w^A))+P[12]+1804603682&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(w^_&(v^w))+P[13]+4254626195&4294967295,A=_+(y<<12&4294967295|y>>>20),y=w+(v^A&(_^v))+P[14]+2792965006&4294967295,w=A+(y<<17&4294967295|y>>>15),y=v+(_^w&(A^_))+P[15]+1236535329&4294967295,v=w+(y<<22&4294967295|y>>>10),y=_+(w^A&(v^w))+P[1]+4129170786&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^w&(_^v))+P[6]+3225465664&4294967295,A=_+(y<<9&4294967295|y>>>23),y=w+(_^v&(A^_))+P[11]+643717713&4294967295,w=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(w^A))+P[0]+3921069994&4294967295,v=w+(y<<20&4294967295|y>>>12),y=_+(w^A&(v^w))+P[5]+3593408605&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^w&(_^v))+P[10]+38016083&4294967295,A=_+(y<<9&4294967295|y>>>23),y=w+(_^v&(A^_))+P[15]+3634488961&4294967295,w=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(w^A))+P[4]+3889429448&4294967295,v=w+(y<<20&4294967295|y>>>12),y=_+(w^A&(v^w))+P[9]+568446438&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^w&(_^v))+P[14]+3275163606&4294967295,A=_+(y<<9&4294967295|y>>>23),y=w+(_^v&(A^_))+P[3]+4107603335&4294967295,w=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(w^A))+P[8]+1163531501&4294967295,v=w+(y<<20&4294967295|y>>>12),y=_+(w^A&(v^w))+P[13]+2850285829&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^w&(_^v))+P[2]+4243563512&4294967295,A=_+(y<<9&4294967295|y>>>23),y=w+(_^v&(A^_))+P[7]+1735328473&4294967295,w=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(w^A))+P[12]+2368359562&4294967295,v=w+(y<<20&4294967295|y>>>12),y=_+(v^w^A)+P[5]+4294588738&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^w)+P[8]+2272392833&4294967295,A=_+(y<<11&4294967295|y>>>21),y=w+(A^_^v)+P[11]+1839030562&4294967295,w=A+(y<<16&4294967295|y>>>16),y=v+(w^A^_)+P[14]+4259657740&4294967295,v=w+(y<<23&4294967295|y>>>9),y=_+(v^w^A)+P[1]+2763975236&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^w)+P[4]+1272893353&4294967295,A=_+(y<<11&4294967295|y>>>21),y=w+(A^_^v)+P[7]+4139469664&4294967295,w=A+(y<<16&4294967295|y>>>16),y=v+(w^A^_)+P[10]+3200236656&4294967295,v=w+(y<<23&4294967295|y>>>9),y=_+(v^w^A)+P[13]+681279174&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^w)+P[0]+3936430074&4294967295,A=_+(y<<11&4294967295|y>>>21),y=w+(A^_^v)+P[3]+3572445317&4294967295,w=A+(y<<16&4294967295|y>>>16),y=v+(w^A^_)+P[6]+76029189&4294967295,v=w+(y<<23&4294967295|y>>>9),y=_+(v^w^A)+P[9]+3654602809&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^w)+P[12]+3873151461&4294967295,A=_+(y<<11&4294967295|y>>>21),y=w+(A^_^v)+P[15]+530742520&4294967295,w=A+(y<<16&4294967295|y>>>16),y=v+(w^A^_)+P[2]+3299628645&4294967295,v=w+(y<<23&4294967295|y>>>9),y=_+(w^(v|~A))+P[0]+4096336452&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~w))+P[7]+1126891415&4294967295,A=_+(y<<10&4294967295|y>>>22),y=w+(_^(A|~v))+P[14]+2878612391&4294967295,w=A+(y<<15&4294967295|y>>>17),y=v+(A^(w|~_))+P[5]+4237533241&4294967295,v=w+(y<<21&4294967295|y>>>11),y=_+(w^(v|~A))+P[12]+1700485571&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~w))+P[3]+2399980690&4294967295,A=_+(y<<10&4294967295|y>>>22),y=w+(_^(A|~v))+P[10]+4293915773&4294967295,w=A+(y<<15&4294967295|y>>>17),y=v+(A^(w|~_))+P[1]+2240044497&4294967295,v=w+(y<<21&4294967295|y>>>11),y=_+(w^(v|~A))+P[8]+1873313359&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~w))+P[15]+4264355552&4294967295,A=_+(y<<10&4294967295|y>>>22),y=w+(_^(A|~v))+P[6]+2734768916&4294967295,w=A+(y<<15&4294967295|y>>>17),y=v+(A^(w|~_))+P[13]+1309151649&4294967295,v=w+(y<<21&4294967295|y>>>11),y=_+(w^(v|~A))+P[4]+4149444226&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~w))+P[11]+3174756917&4294967295,A=_+(y<<10&4294967295|y>>>22),y=w+(_^(A|~v))+P[2]+718787259&4294967295,w=A+(y<<15&4294967295|y>>>17),y=v+(A^(w|~_))+P[9]+3951481745&4294967295,I.g[0]=I.g[0]+_&4294967295,I.g[1]=I.g[1]+(w+(y<<21&4294967295|y>>>11))&4294967295,I.g[2]=I.g[2]+w&4294967295,I.g[3]=I.g[3]+A&4294967295}n.prototype.u=function(I,_){_===void 0&&(_=I.length);for(var v=_-this.blockSize,P=this.B,w=this.h,A=0;A<_;){if(w==0)for(;A<=v;)i(this,I,A),A+=this.blockSize;if(typeof I=="string"){for(;A<_;)if(P[w++]=I.charCodeAt(A++),w==this.blockSize){i(this,P),w=0;break}}else for(;A<_;)if(P[w++]=I[A++],w==this.blockSize){i(this,P),w=0;break}}this.h=w,this.o+=_},n.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var _=1;_<I.length-8;++_)I[_]=0;var v=8*this.o;for(_=I.length-8;_<I.length;++_)I[_]=v&255,v/=256;for(this.u(I),I=Array(16),_=v=0;4>_;++_)for(var P=0;32>P;P+=8)I[v++]=this.g[_]>>>P&255;return I};function o(I,_){var v=c;return Object.prototype.hasOwnProperty.call(v,I)?v[I]:v[I]=_(I)}function a(I,_){this.h=_;for(var v=[],P=!0,w=I.length-1;0<=w;w--){var A=I[w]|0;P&&A==_||(v[w]=A,P=!1)}this.g=v}var c={};function u(I){return-128<=I&&128>I?o(I,function(_){return new a([_|0],0>_?-1:0)}):new a([I|0],0>I?-1:0)}function h(I){if(isNaN(I)||!isFinite(I))return p;if(0>I)return E(h(-I));for(var _=[],v=1,P=0;I>=v;P++)_[P]=I/v|0,v*=4294967296;return new a(_,0)}function f(I,_){if(I.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(I.charAt(0)=="-")return E(f(I.substring(1),_));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=h(Math.pow(_,8)),P=p,w=0;w<I.length;w+=8){var A=Math.min(8,I.length-w),y=parseInt(I.substring(w,w+A),_);8>A?(A=h(Math.pow(_,A)),P=P.j(A).add(h(y))):(P=P.j(v),P=P.add(h(y)))}return P}var p=u(0),b=u(1),C=u(16777216);t=a.prototype,t.m=function(){if(x(this))return-E(this).m();for(var I=0,_=1,v=0;v<this.g.length;v++){var P=this.i(v);I+=(0<=P?P:4294967296+P)*_,_*=4294967296}return I},t.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(D(this))return"0";if(x(this))return"-"+E(this).toString(I);for(var _=h(Math.pow(I,6)),v=this,P="";;){var w=Y(v,_).g;v=T(v,w.j(_));var A=((0<v.g.length?v.g[0]:v.h)>>>0).toString(I);if(v=w,D(v))return A+P;for(;6>A.length;)A="0"+A;P=A+P}},t.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function D(I){if(I.h!=0)return!1;for(var _=0;_<I.g.length;_++)if(I.g[_]!=0)return!1;return!0}function x(I){return I.h==-1}t.l=function(I){return I=T(this,I),x(I)?-1:D(I)?0:1};function E(I){for(var _=I.g.length,v=[],P=0;P<_;P++)v[P]=~I.g[P];return new a(v,~I.h).add(b)}t.abs=function(){return x(this)?E(this):this},t.add=function(I){for(var _=Math.max(this.g.length,I.g.length),v=[],P=0,w=0;w<=_;w++){var A=P+(this.i(w)&65535)+(I.i(w)&65535),y=(A>>>16)+(this.i(w)>>>16)+(I.i(w)>>>16);P=y>>>16,A&=65535,y&=65535,v[w]=y<<16|A}return new a(v,v[v.length-1]&-2147483648?-1:0)};function T(I,_){return I.add(E(_))}t.j=function(I){if(D(this)||D(I))return p;if(x(this))return x(I)?E(this).j(E(I)):E(E(this).j(I));if(x(I))return E(this.j(E(I)));if(0>this.l(C)&&0>I.l(C))return h(this.m()*I.m());for(var _=this.g.length+I.g.length,v=[],P=0;P<2*_;P++)v[P]=0;for(P=0;P<this.g.length;P++)for(var w=0;w<I.g.length;w++){var A=this.i(P)>>>16,y=this.i(P)&65535,he=I.i(w)>>>16,W=I.i(w)&65535;v[2*P+2*w]+=y*W,H(v,2*P+2*w),v[2*P+2*w+1]+=A*W,H(v,2*P+2*w+1),v[2*P+2*w+1]+=y*he,H(v,2*P+2*w+1),v[2*P+2*w+2]+=A*he,H(v,2*P+2*w+2)}for(P=0;P<_;P++)v[P]=v[2*P+1]<<16|v[2*P];for(P=_;P<2*_;P++)v[P]=0;return new a(v,0)};function H(I,_){for(;(I[_]&65535)!=I[_];)I[_+1]+=I[_]>>>16,I[_]&=65535,_++}function te(I,_){this.g=I,this.h=_}function Y(I,_){if(D(_))throw Error("division by zero");if(D(I))return new te(p,p);if(x(I))return _=Y(E(I),_),new te(E(_.g),E(_.h));if(x(_))return _=Y(I,E(_)),new te(E(_.g),_.h);if(30<I.g.length){if(x(I)||x(_))throw Error("slowDivide_ only works with positive integers.");for(var v=b,P=_;0>=P.l(I);)v=ue(v),P=ue(P);var w=oe(v,1),A=oe(P,1);for(P=oe(P,2),v=oe(v,2);!D(P);){var y=A.add(P);0>=y.l(I)&&(w=w.add(v),A=y),P=oe(P,1),v=oe(v,1)}return _=T(I,w.j(_)),new te(w,_)}for(w=p;0<=I.l(_);){for(v=Math.max(1,Math.floor(I.m()/_.m())),P=Math.ceil(Math.log(v)/Math.LN2),P=48>=P?1:Math.pow(2,P-48),A=h(v),y=A.j(_);x(y)||0<y.l(I);)v-=P,A=h(v),y=A.j(_);D(A)&&(A=b),w=w.add(A),I=T(I,y)}return new te(w,I)}t.A=function(I){return Y(this,I).h},t.and=function(I){for(var _=Math.max(this.g.length,I.g.length),v=[],P=0;P<_;P++)v[P]=this.i(P)&I.i(P);return new a(v,this.h&I.h)},t.or=function(I){for(var _=Math.max(this.g.length,I.g.length),v=[],P=0;P<_;P++)v[P]=this.i(P)|I.i(P);return new a(v,this.h|I.h)},t.xor=function(I){for(var _=Math.max(this.g.length,I.g.length),v=[],P=0;P<_;P++)v[P]=this.i(P)^I.i(P);return new a(v,this.h^I.h)};function ue(I){for(var _=I.g.length+1,v=[],P=0;P<_;P++)v[P]=I.i(P)<<1|I.i(P-1)>>>31;return new a(v,I.h)}function oe(I,_){var v=_>>5;_%=32;for(var P=I.g.length-v,w=[],A=0;A<P;A++)w[A]=0<_?I.i(A+v)>>>_|I.i(A+v+1)<<32-_:I.i(A+v);return new a(w,I.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,cf=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=f,Yn=a}).apply(typeof gd<"u"?gd:typeof self<"u"?self:typeof window<"u"?window:{});var Is=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var uf,xo,df,Gs,Hl,hf,mf,ff;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,m,g){return l==Array.prototype||l==Object.prototype||(l[m]=g.value),l};function r(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Is=="object"&&Is];for(var m=0;m<l.length;++m){var g=l[m];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var n=r(this);function i(l,m){if(m)e:{var g=n;l=l.split(".");for(var O=0;O<l.length-1;O++){var Se=l[O];if(!(Se in g))break e;g=g[Se]}l=l[l.length-1],O=g[l],m=m(O),m!=O&&m!=null&&e(g,l,{configurable:!0,writable:!0,value:m})}}function o(l,m){l instanceof String&&(l+="");var g=0,O=!1,Se={next:function(){if(!O&&g<l.length){var Ce=g++;return{value:m(Ce,l[Ce]),done:!1}}return O=!0,{done:!0,value:void 0}}};return Se[Symbol.iterator]=function(){return Se},Se}i("Array.prototype.values",function(l){return l||function(){return o(this,function(m,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},c=this||self;function u(l){var m=typeof l;return m=m!="object"?m:l?Array.isArray(l)?"array":m:"null",m=="array"||m=="object"&&typeof l.length=="number"}function h(l){var m=typeof l;return m=="object"&&l!=null||m=="function"}function f(l,m,g){return l.call.apply(l.bind,arguments)}function p(l,m,g){if(!l)throw Error();if(2<arguments.length){var O=Array.prototype.slice.call(arguments,2);return function(){var Se=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Se,O),l.apply(m,Se)}}return function(){return l.apply(m,arguments)}}function b(l,m,g){return b=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,b.apply(null,arguments)}function C(l,m){var g=Array.prototype.slice.call(arguments,1);return function(){var O=g.slice();return O.push.apply(O,arguments),l.apply(this,O)}}function D(l,m){function g(){}g.prototype=m.prototype,l.aa=m.prototype,l.prototype=new g,l.prototype.constructor=l,l.Qb=function(O,Se,Ce){for(var Le=Array(arguments.length-2),Bt=2;Bt<arguments.length;Bt++)Le[Bt-2]=arguments[Bt];return m.prototype[Se].apply(O,Le)}}function x(l){const m=l.length;if(0<m){const g=Array(m);for(let O=0;O<m;O++)g[O]=l[O];return g}return[]}function E(l,m){for(let g=1;g<arguments.length;g++){const O=arguments[g];if(u(O)){const Se=l.length||0,Ce=O.length||0;l.length=Se+Ce;for(let Le=0;Le<Ce;Le++)l[Se+Le]=O[Le]}else l.push(O)}}class T{constructor(m,g){this.i=m,this.j=g,this.h=0,this.g=null}get(){let m;return 0<this.h?(this.h--,m=this.g,this.g=m.next,m.next=null):m=this.i(),m}}function H(l){return/^[\s\xa0]*$/.test(l)}function te(){var l=c.navigator;return l&&(l=l.userAgent)?l:""}function Y(l){return Y[" "](l),l}Y[" "]=function(){};var ue=te().indexOf("Gecko")!=-1&&!(te().toLowerCase().indexOf("webkit")!=-1&&te().indexOf("Edge")==-1)&&!(te().indexOf("Trident")!=-1||te().indexOf("MSIE")!=-1)&&te().indexOf("Edge")==-1;function oe(l,m,g){for(const O in l)m.call(g,l[O],O,l)}function I(l,m){for(const g in l)m.call(void 0,l[g],g,l)}function _(l){const m={};for(const g in l)m[g]=l[g];return m}const v="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function P(l,m){let g,O;for(let Se=1;Se<arguments.length;Se++){O=arguments[Se];for(g in O)l[g]=O[g];for(let Ce=0;Ce<v.length;Ce++)g=v[Ce],Object.prototype.hasOwnProperty.call(O,g)&&(l[g]=O[g])}}function w(l){var m=1;l=l.split(":");const g=[];for(;0<m&&l.length;)g.push(l.shift()),m--;return l.length&&g.push(l.join(":")),g}function A(l){c.setTimeout(()=>{throw l},0)}function y(){var l=F;let m=null;return l.g&&(m=l.g,l.g=l.g.next,l.g||(l.h=null),m.next=null),m}class he{constructor(){this.h=this.g=null}add(m,g){const O=W.get();O.set(m,g),this.h?this.h.next=O:this.g=O,this.h=O}}var W=new T(()=>new $,l=>l.reset());class ${constructor(){this.next=this.g=this.h=null}set(m,g){this.h=m,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let Z,k=!1,F=new he,V=()=>{const l=c.Promise.resolve(void 0);Z=()=>{l.then(z)}};var z=()=>{for(var l;l=y();){try{l.h.call(l.g)}catch(g){A(g)}var m=W;m.j(l),100>m.h&&(m.h++,l.next=m.g,m.g=l)}k=!1};function me(){this.s=this.s,this.C=this.C}me.prototype.s=!1,me.prototype.ma=function(){this.s||(this.s=!0,this.N())},me.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function K(l,m){this.type=l,this.g=this.target=m,this.defaultPrevented=!1}K.prototype.h=function(){this.defaultPrevented=!0};var de=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var l=!1,m=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const g=()=>{};c.addEventListener("test",g,m),c.removeEventListener("test",g,m)}catch{}return l}();function N(l,m){if(K.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var g=this.type=l.type,O=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=m,m=l.relatedTarget){if(ue){e:{try{Y(m.nodeName);var Se=!0;break e}catch{}Se=!1}Se||(m=null)}}else g=="mouseover"?m=l.fromElement:g=="mouseout"&&(m=l.toElement);this.relatedTarget=m,O?(this.clientX=O.clientX!==void 0?O.clientX:O.pageX,this.clientY=O.clientY!==void 0?O.clientY:O.pageY,this.screenX=O.screenX||0,this.screenY=O.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:j[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&N.aa.h.call(this)}}D(N,K);var j={2:"touch",3:"pen",4:"mouse"};N.prototype.h=function(){N.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Q="closure_listenable_"+(1e6*Math.random()|0),J=0;function ce(l,m,g,O,Se){this.listener=l,this.proxy=null,this.src=m,this.type=g,this.capture=!!O,this.ha=Se,this.key=++J,this.da=this.fa=!1}function ae(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function M(l){this.src=l,this.g={},this.h=0}M.prototype.add=function(l,m,g,O,Se){var Ce=l.toString();l=this.g[Ce],l||(l=this.g[Ce]=[],this.h++);var Le=pe(l,m,O,Se);return-1<Le?(m=l[Le],g||(m.fa=!1)):(m=new ce(m,this.src,Ce,!!O,Se),m.fa=g,l.push(m)),m};function ne(l,m){var g=m.type;if(g in l.g){var O=l.g[g],Se=Array.prototype.indexOf.call(O,m,void 0),Ce;(Ce=0<=Se)&&Array.prototype.splice.call(O,Se,1),Ce&&(ae(m),l.g[g].length==0&&(delete l.g[g],l.h--))}}function pe(l,m,g,O){for(var Se=0;Se<l.length;++Se){var Ce=l[Se];if(!Ce.da&&Ce.listener==m&&Ce.capture==!!g&&Ce.ha==O)return Se}return-1}var ve="closure_lm_"+(1e6*Math.random()|0),ee={};function ie(l,m,g,O,Se){if(Array.isArray(m)){for(var Ce=0;Ce<m.length;Ce++)ie(l,m[Ce],g,O,Se);return null}return g=_e(g),l&&l[Q]?l.K(m,g,h(O)?!!O.capture:!1,Se):R(l,m,g,!1,O,Se)}function R(l,m,g,O,Se,Ce){if(!m)throw Error("Invalid event type");var Le=h(Se)?!!Se.capture:!!Se,Bt=G(l);if(Bt||(l[ve]=Bt=new M(l)),g=Bt.add(m,g,O,Le,Ce),g.proxy)return g;if(O=L(),g.proxy=O,O.src=l,O.listener=g,l.addEventListener)de||(Se=Le),Se===void 0&&(Se=!1),l.addEventListener(m.toString(),O,Se);else if(l.attachEvent)l.attachEvent(le(m.toString()),O);else if(l.addListener&&l.removeListener)l.addListener(O);else throw Error("addEventListener and attachEvent are unavailable.");return g}function L(){function l(g){return m.call(l.src,l.listener,g)}const m=U;return l}function B(l,m,g,O,Se){if(Array.isArray(m))for(var Ce=0;Ce<m.length;Ce++)B(l,m[Ce],g,O,Se);else O=h(O)?!!O.capture:!!O,g=_e(g),l&&l[Q]?(l=l.i,m=String(m).toString(),m in l.g&&(Ce=l.g[m],g=pe(Ce,g,O,Se),-1<g&&(ae(Ce[g]),Array.prototype.splice.call(Ce,g,1),Ce.length==0&&(delete l.g[m],l.h--)))):l&&(l=G(l))&&(m=l.g[m.toString()],l=-1,m&&(l=pe(m,g,O,Se)),(g=-1<l?m[l]:null)&&ge(g))}function ge(l){if(typeof l!="number"&&l&&!l.da){var m=l.src;if(m&&m[Q])ne(m.i,l);else{var g=l.type,O=l.proxy;m.removeEventListener?m.removeEventListener(g,O,l.capture):m.detachEvent?m.detachEvent(le(g),O):m.addListener&&m.removeListener&&m.removeListener(O),(g=G(m))?(ne(g,l),g.h==0&&(g.src=null,m[ve]=null)):ae(l)}}}function le(l){return l in ee?ee[l]:ee[l]="on"+l}function U(l,m){if(l.da)l=!0;else{m=new N(m,this);var g=l.listener,O=l.ha||l.src;l.fa&&ge(l),l=g.call(O,m)}return l}function G(l){return l=l[ve],l instanceof M?l:null}var Pe="__closure_events_fn_"+(1e9*Math.random()>>>0);function _e(l){return typeof l=="function"?l:(l[Pe]||(l[Pe]=function(m){return l.handleEvent(m)}),l[Pe])}function se(){me.call(this),this.i=new M(this),this.M=this,this.F=null}D(se,me),se.prototype[Q]=!0,se.prototype.removeEventListener=function(l,m,g,O){B(this,l,m,g,O)};function be(l,m){var g,O=l.F;if(O)for(g=[];O;O=O.F)g.push(O);if(l=l.M,O=m.type||m,typeof m=="string")m=new K(m,l);else if(m instanceof K)m.target=m.target||l;else{var Se=m;m=new K(O,l),P(m,Se)}if(Se=!0,g)for(var Ce=g.length-1;0<=Ce;Ce--){var Le=m.g=g[Ce];Se=X(Le,O,!0,m)&&Se}if(Le=m.g=l,Se=X(Le,O,!0,m)&&Se,Se=X(Le,O,!1,m)&&Se,g)for(Ce=0;Ce<g.length;Ce++)Le=m.g=g[Ce],Se=X(Le,O,!1,m)&&Se}se.prototype.N=function(){if(se.aa.N.call(this),this.i){var l=this.i,m;for(m in l.g){for(var g=l.g[m],O=0;O<g.length;O++)ae(g[O]);delete l.g[m],l.h--}}this.F=null},se.prototype.K=function(l,m,g,O){return this.i.add(String(l),m,!1,g,O)},se.prototype.L=function(l,m,g,O){return this.i.add(String(l),m,!0,g,O)};function X(l,m,g,O){if(m=l.i.g[String(m)],!m)return!0;m=m.concat();for(var Se=!0,Ce=0;Ce<m.length;++Ce){var Le=m[Ce];if(Le&&!Le.da&&Le.capture==g){var Bt=Le.listener,hr=Le.ha||Le.src;Le.fa&&ne(l.i,Le),Se=Bt.call(hr,O)!==!1&&Se}}return Se&&!O.defaultPrevented}function we(l,m,g){if(typeof l=="function")g&&(l=b(l,g));else if(l&&typeof l.handleEvent=="function")l=b(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(m)?-1:c.setTimeout(l,m||0)}function ke(l){l.g=we(()=>{l.g=null,l.i&&(l.i=!1,ke(l))},l.l);const m=l.h;l.h=null,l.m.apply(null,m)}class xe extends me{constructor(m,g){super(),this.m=m,this.l=g,this.h=null,this.i=!1,this.g=null}j(m){this.h=arguments,this.g?this.i=!0:ke(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Te(l){me.call(this),this.h=l,this.g={}}D(Te,me);var Oe=[];function We(l){oe(l.g,function(m,g){this.g.hasOwnProperty(g)&&ge(m)},l),l.g={}}Te.prototype.N=function(){Te.aa.N.call(this),We(this)},Te.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var je=c.JSON.stringify,Ie=c.JSON.parse,Ve=class{stringify(l){return c.JSON.stringify(l,void 0)}parse(l){return c.JSON.parse(l,void 0)}};function He(){}He.prototype.h=null;function qe(l){return l.h||(l.h=l.i())}function Ge(){}var Ae={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function rt(){K.call(this,"d")}D(rt,K);function et(){K.call(this,"c")}D(et,K);var ct={},xt=null;function _t(){return xt=xt||new se}ct.La="serverreachability";function Ht(l){K.call(this,ct.La,l)}D(Ht,K);function mt(l){const m=_t();be(m,new Ht(m))}ct.STAT_EVENT="statevent";function Qt(l,m){K.call(this,ct.STAT_EVENT,l),this.stat=m}D(Qt,K);function ht(l){const m=_t();be(m,new Qt(m,l))}ct.Ma="timingevent";function St(l,m){K.call(this,ct.Ma,l),this.size=m}D(St,K);function Lt(l,m){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){l()},m)}function Nt(){this.g=!0}Nt.prototype.xa=function(){this.g=!1};function Me(l,m,g,O,Se,Ce){l.info(function(){if(l.g)if(Ce)for(var Le="",Bt=Ce.split("&"),hr=0;hr<Bt.length;hr++){var wt=Bt[hr].split("=");if(1<wt.length){var pr=wt[0];wt=wt[1];var vr=pr.split("_");Le=2<=vr.length&&vr[1]=="type"?Le+(pr+"="+wt+"&"):Le+(pr+"=redacted&")}}else Le=null;else Le=Ce;return"XMLHTTP REQ ("+O+") [attempt "+Se+"]: "+m+`
`+g+`
`+Le})}function Be(l,m,g,O,Se,Ce,Le){l.info(function(){return"XMLHTTP RESP ("+O+") [ attempt "+Se+"]: "+m+`
`+g+`
`+Ce+" "+Le})}function Ye(l,m,g,O){l.info(function(){return"XMLHTTP TEXT ("+m+"): "+kt(l,g)+(O?" "+O:"")})}function ot(l,m){l.info(function(){return"TIMEOUT: "+m})}Nt.prototype.info=function(){};function kt(l,m){if(!l.g)return m;if(!m)return null;try{var g=JSON.parse(m);if(g){for(l=0;l<g.length;l++)if(Array.isArray(g[l])){var O=g[l];if(!(2>O.length)){var Se=O[1];if(Array.isArray(Se)&&!(1>Se.length)){var Ce=Se[0];if(Ce!="noop"&&Ce!="stop"&&Ce!="close")for(var Le=1;Le<Se.length;Le++)Se[Le]=""}}}}return je(g)}catch{return m}}var Qe={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ee={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},nt;function ft(){}D(ft,He),ft.prototype.g=function(){return new XMLHttpRequest},ft.prototype.i=function(){return{}},nt=new ft;function Pt(l,m,g,O){this.j=l,this.i=m,this.l=g,this.R=O||1,this.U=new Te(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new sr}function sr(){this.i=null,this.g="",this.h=!1}var Rt={},jt={};function ar(l,m,g){l.L=1,l.v=Ni(Ir(m)),l.m=g,l.P=!0,Tt(l,null)}function Tt(l,m){l.F=Date.now(),Mt(l),l.A=Ir(l.v);var g=l.A,O=l.R;Array.isArray(O)||(O=[String(O)]),du(g.i,"t",O),l.C=0,g=l.j.J,l.h=new sr,l.g=Tu(l.j,g?m:null,!l.m),0<l.O&&(l.M=new xe(b(l.Y,l,l.g),l.O)),m=l.U,g=l.g,O=l.ca;var Se="readystatechange";Array.isArray(Se)||(Se&&(Oe[0]=Se.toString()),Se=Oe);for(var Ce=0;Ce<Se.length;Ce++){var Le=ie(g,Se[Ce],O||m.handleEvent,!1,m.h||m);if(!Le)break;m.g[Le.key]=Le}m=l.H?_(l.H):{},l.m?(l.u||(l.u="POST"),m["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,m)):(l.u="GET",l.g.ea(l.A,l.u,null,m)),mt(),Me(l.i,l.u,l.A,l.l,l.R,l.m)}Pt.prototype.ca=function(l){l=l.target;const m=this.M;m&&fn(l)==3?m.j():this.Y(l)},Pt.prototype.Y=function(l){try{if(l==this.g)e:{const vr=fn(this.g);var m=this.g.Ba();const Oi=this.g.Z();if(!(3>vr)&&(vr!=3||this.g&&(this.h.h||this.g.oa()||vu(this.g)))){this.J||vr!=4||m==7||(m==8||0>=Oi?mt(3):mt(2)),xr(this);var g=this.g.Z();this.X=g;t:if(Kt(this)){var O=vu(this.g);l="";var Se=O.length,Ce=fn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ar(this),zr(this);var Le="";break t}this.h.i=new c.TextDecoder}for(m=0;m<Se;m++)this.h.h=!0,l+=this.h.i.decode(O[m],{stream:!(Ce&&m==Se-1)});O.length=0,this.h.g+=l,this.C=0,Le=this.h.g}else Le=this.g.oa();if(this.o=g==200,Be(this.i,this.u,this.A,this.l,this.R,vr,g),this.o){if(this.T&&!this.K){t:{if(this.g){var Bt,hr=this.g;if((Bt=hr.g?hr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(Bt)){var wt=Bt;break t}}wt=null}if(g=wt)Ye(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,mn(this,g);else{this.o=!1,this.s=3,ht(12),Ar(this),zr(this);break e}}if(this.P){g=!0;let Hr;for(;!this.J&&this.C<Le.length;)if(Hr=$r(this,Le),Hr==jt){vr==4&&(this.s=4,ht(14),g=!1),Ye(this.i,this.l,null,"[Incomplete Response]");break}else if(Hr==Rt){this.s=4,ht(15),Ye(this.i,this.l,Le,"[Invalid Chunk]"),g=!1;break}else Ye(this.i,this.l,Hr,null),mn(this,Hr);if(Kt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),vr!=4||Le.length!=0||this.h.h||(this.s=1,ht(16),g=!1),this.o=this.o&&g,!g)Ye(this.i,this.l,Le,"[Invalid Chunked Response]"),Ar(this),zr(this);else if(0<Le.length&&!this.W){this.W=!0;var pr=this.j;pr.g==this&&pr.ba&&!pr.M&&(pr.j.info("Great, no buffering proxy detected. Bytes received: "+Le.length),Ya(pr),pr.M=!0,ht(11))}}else Ye(this.i,this.l,Le,null),mn(this,Le);vr==4&&Ar(this),this.o&&!this.J&&(vr==4?Au(this.j,this):(this.o=!1,Mt(this)))}else tg(this.g),g==400&&0<Le.indexOf("Unknown SID")?(this.s=3,ht(12)):(this.s=0,ht(13)),Ar(this),zr(this)}}}catch{}finally{}};function Kt(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function $r(l,m){var g=l.C,O=m.indexOf(`
`,g);return O==-1?jt:(g=Number(m.substring(g,O)),isNaN(g)?Rt:(O+=1,O+g>m.length?jt:(m=m.slice(O,O+g),l.C=O+g,m)))}Pt.prototype.cancel=function(){this.J=!0,Ar(this)};function Mt(l){l.S=Date.now()+l.I,rr(l,l.I)}function rr(l,m){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Lt(b(l.ba,l),m)}function xr(l){l.B&&(c.clearTimeout(l.B),l.B=null)}Pt.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(ot(this.i,this.A),this.L!=2&&(mt(),ht(17)),Ar(this),this.s=2,zr(this)):rr(this,this.S-l)};function zr(l){l.j.G==0||l.J||Au(l.j,l)}function Ar(l){xr(l);var m=l.M;m&&typeof m.ma=="function"&&m.ma(),l.M=null,We(l.U),l.g&&(m=l.g,l.g=null,m.abort(),m.ma())}function mn(l,m){try{var g=l.j;if(g.G!=0&&(g.g==l||Rn(g.h,l))){if(!l.K&&Rn(g.h,l)&&g.G==3){try{var O=g.Da.g.parse(m)}catch{O=null}if(Array.isArray(O)&&O.length==3){var Se=O;if(Se[0]==0){e:if(!g.u){if(g.g)if(g.g.F+3e3<l.F)Ss(g),bs(g);else break e;Ka(g),ht(18)}}else g.za=Se[1],0<g.za-g.T&&37500>Se[2]&&g.F&&g.v==0&&!g.C&&(g.C=Lt(b(g.Za,g),6e3));if(1>=si(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else li(g,11)}else if((l.K||g.g==l)&&Ss(g),!H(m))for(Se=g.Da.g.parse(m),m=0;m<Se.length;m++){let wt=Se[m];if(g.T=wt[0],wt=wt[1],g.G==2)if(wt[0]=="c"){g.K=wt[1],g.ia=wt[2];const pr=wt[3];pr!=null&&(g.la=pr,g.j.info("VER="+g.la));const vr=wt[4];vr!=null&&(g.Aa=vr,g.j.info("SVER="+g.Aa));const Oi=wt[5];Oi!=null&&typeof Oi=="number"&&0<Oi&&(O=1.5*Oi,g.L=O,g.j.info("backChannelRequestTimeoutMs_="+O)),O=g;const Hr=l.g;if(Hr){const ws=Hr.g?Hr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ws){var Ce=O.h;Ce.g||ws.indexOf("spdy")==-1&&ws.indexOf("quic")==-1&&ws.indexOf("h2")==-1||(Ce.j=Ce.l,Ce.g=new Set,Ce.h&&(Qr(Ce,Ce.h),Ce.h=null))}if(O.D){const Qa=Hr.g?Hr.g.getResponseHeader("X-HTTP-Session-Id"):null;Qa&&(O.ya=Qa,Vt(O.I,O.D,Qa))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-l.F,g.j.info("Handshake RTT: "+g.R+"ms")),O=g;var Le=l;if(O.qa=xu(O,O.J?O.ia:null,O.W),Le.K){Di(O.h,Le);var Bt=Le,hr=O.L;hr&&(Bt.I=hr),Bt.B&&(xr(Bt),Mt(Bt)),O.g=Le}else wu(O);0<g.i.length&&_s(g)}else wt[0]!="stop"&&wt[0]!="close"||li(g,7);else g.G==3&&(wt[0]=="stop"||wt[0]=="close"?wt[0]=="stop"?li(g,7):Ga(g):wt[0]!="noop"&&g.l&&g.l.ta(wt),g.v=0)}}mt(4)}catch{}}var kn=class{constructor(l,m){this.g=l,this.map=m}};function Ri(l){this.l=l||10,c.PerformanceNavigationTiming?(l=c.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function oi(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function si(l){return l.h?1:l.g?l.g.size:0}function Rn(l,m){return l.h?l.h==m:l.g?l.g.has(m):!1}function Qr(l,m){l.g?l.g.add(m):l.h=m}function Di(l,m){l.h&&l.h==m?l.h=null:l.g&&l.g.has(m)&&l.g.delete(m)}Ri.prototype.cancel=function(){if(this.i=ai(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function ai(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let m=l.i;for(const g of l.g.values())m=m.concat(g.D);return m}return x(l.i)}function dt(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(u(l)){for(var m=[],g=l.length,O=0;O<g;O++)m.push(l[O]);return m}m=[],g=0;for(O in l)m[g++]=l[O];return m}function Dt(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(u(l)||typeof l=="string"){var m=[];l=l.length;for(var g=0;g<l;g++)m.push(g);return m}m=[],g=0;for(const O in l)m[g++]=O;return m}}}function lr(l,m){if(l.forEach&&typeof l.forEach=="function")l.forEach(m,void 0);else if(u(l)||typeof l=="string")Array.prototype.forEach.call(l,m,void 0);else for(var g=Dt(l),O=dt(l),Se=O.length,Ce=0;Ce<Se;Ce++)m.call(void 0,O[Ce],g&&g[Ce],l)}var kr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function qr(l,m){if(l){l=l.split("&");for(var g=0;g<l.length;g++){var O=l[g].indexOf("="),Se=null;if(0<=O){var Ce=l[g].substring(0,O);Se=l[g].substring(O+1)}else Ce=l[g];m(Ce,Se?decodeURIComponent(Se.replace(/\+/g," ")):"")}}}function Ot(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Ot){this.h=l.h,Jr(this,l.j),this.o=l.o,this.g=l.g,Xr(this,l.s),this.l=l.l;var m=l.i,g=new po;g.i=m.i,m.g&&(g.g=new Map(m.g),g.h=m.h),ys(this,g),this.m=l.m}else l&&(m=String(l).match(kr))?(this.h=!1,Jr(this,m[1]||"",!0),this.o=yo(m[2]||""),this.g=yo(m[3]||"",!0),Xr(this,m[4]),this.l=yo(m[5]||"",!0),ys(this,m[6]||"",!0),this.m=yo(m[7]||"")):(this.h=!1,this.i=new po(null,this.h))}Ot.prototype.toString=function(){var l=[],m=this.j;m&&l.push(go(m,lu,!0),":");var g=this.g;return(g||m=="file")&&(l.push("//"),(m=this.o)&&l.push(go(m,lu,!0),"@"),l.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&l.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&l.push("/"),l.push(go(g,g.charAt(0)=="/"?Hy:qy,!0))),(g=this.i.toString())&&l.push("?",g),(g=this.m)&&l.push("#",go(g,Gy)),l.join("")};function Ir(l){return new Ot(l)}function Jr(l,m,g){l.j=g?yo(m,!0):m,l.j&&(l.j=l.j.replace(/:$/,""))}function Xr(l,m){if(m){if(m=Number(m),isNaN(m)||0>m)throw Error("Bad port number "+m);l.s=m}else l.s=null}function ys(l,m,g){m instanceof po?(l.i=m,Ky(l.i,l.h)):(g||(m=go(m,Wy)),l.i=new po(m,l.h))}function Vt(l,m,g){l.i.set(m,g)}function Ni(l){return Vt(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function yo(l,m){return l?m?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function go(l,m,g){return typeof l=="string"?(l=encodeURI(l).replace(m,zy),g&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function zy(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var lu=/[#\/\?@]/g,qy=/[#\?:]/g,Hy=/[#\?]/g,Wy=/[#\?@]/g,Gy=/#/g;function po(l,m){this.h=this.g=null,this.i=l||null,this.j=!!m}function Dn(l){l.g||(l.g=new Map,l.h=0,l.i&&qr(l.i,function(m,g){l.add(decodeURIComponent(m.replace(/\+/g," ")),g)}))}t=po.prototype,t.add=function(l,m){Dn(this),this.i=null,l=Li(this,l);var g=this.g.get(l);return g||this.g.set(l,g=[]),g.push(m),this.h+=1,this};function cu(l,m){Dn(l),m=Li(l,m),l.g.has(m)&&(l.i=null,l.h-=l.g.get(m).length,l.g.delete(m))}function uu(l,m){return Dn(l),m=Li(l,m),l.g.has(m)}t.forEach=function(l,m){Dn(this),this.g.forEach(function(g,O){g.forEach(function(Se){l.call(m,Se,O,this)},this)},this)},t.na=function(){Dn(this);const l=Array.from(this.g.values()),m=Array.from(this.g.keys()),g=[];for(let O=0;O<m.length;O++){const Se=l[O];for(let Ce=0;Ce<Se.length;Ce++)g.push(m[O])}return g},t.V=function(l){Dn(this);let m=[];if(typeof l=="string")uu(this,l)&&(m=m.concat(this.g.get(Li(this,l))));else{l=Array.from(this.g.values());for(let g=0;g<l.length;g++)m=m.concat(l[g])}return m},t.set=function(l,m){return Dn(this),this.i=null,l=Li(this,l),uu(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[m]),this.h+=1,this},t.get=function(l,m){return l?(l=this.V(l),0<l.length?String(l[0]):m):m};function du(l,m,g){cu(l,m),0<g.length&&(l.i=null,l.g.set(Li(l,m),x(g)),l.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],m=Array.from(this.g.keys());for(var g=0;g<m.length;g++){var O=m[g];const Ce=encodeURIComponent(String(O)),Le=this.V(O);for(O=0;O<Le.length;O++){var Se=Ce;Le[O]!==""&&(Se+="="+encodeURIComponent(String(Le[O]))),l.push(Se)}}return this.i=l.join("&")};function Li(l,m){return m=String(m),l.j&&(m=m.toLowerCase()),m}function Ky(l,m){m&&!l.j&&(Dn(l),l.i=null,l.g.forEach(function(g,O){var Se=O.toLowerCase();O!=Se&&(cu(this,O),du(this,Se,g))},l)),l.j=m}function Yy(l,m){const g=new Nt;if(c.Image){const O=new Image;O.onload=C(Nn,g,"TestLoadImage: loaded",!0,m,O),O.onerror=C(Nn,g,"TestLoadImage: error",!1,m,O),O.onabort=C(Nn,g,"TestLoadImage: abort",!1,m,O),O.ontimeout=C(Nn,g,"TestLoadImage: timeout",!1,m,O),c.setTimeout(function(){O.ontimeout&&O.ontimeout()},1e4),O.src=l}else m(!1)}function Qy(l,m){const g=new Nt,O=new AbortController,Se=setTimeout(()=>{O.abort(),Nn(g,"TestPingServer: timeout",!1,m)},1e4);fetch(l,{signal:O.signal}).then(Ce=>{clearTimeout(Se),Ce.ok?Nn(g,"TestPingServer: ok",!0,m):Nn(g,"TestPingServer: server error",!1,m)}).catch(()=>{clearTimeout(Se),Nn(g,"TestPingServer: error",!1,m)})}function Nn(l,m,g,O,Se){try{Se&&(Se.onload=null,Se.onerror=null,Se.onabort=null,Se.ontimeout=null),O(g)}catch{}}function Jy(){this.g=new Ve}function Xy(l,m,g){const O=g||"";try{lr(l,function(Se,Ce){let Le=Se;h(Se)&&(Le=je(Se)),m.push(O+Ce+"="+encodeURIComponent(Le))})}catch(Se){throw m.push(O+"type="+encodeURIComponent("_badmap")),Se}}function gs(l){this.l=l.Ub||null,this.j=l.eb||!1}D(gs,He),gs.prototype.g=function(){return new ps(this.l,this.j)},gs.prototype.i=function(l){return function(){return l}}({});function ps(l,m){se.call(this),this.D=l,this.o=m,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}D(ps,se),t=ps.prototype,t.open=function(l,m){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=m,this.readyState=1,bo(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const m={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(m.body=l),(this.D||c).fetch(new Request(this.A,m)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,vo(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,bo(this)),this.g&&(this.readyState=3,bo(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;hu(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function hu(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var m=l.value?l.value:new Uint8Array(0);(m=this.v.decode(m,{stream:!l.done}))&&(this.response=this.responseText+=m)}l.done?vo(this):bo(this),this.readyState==3&&hu(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,vo(this))},t.Qa=function(l){this.g&&(this.response=l,vo(this))},t.ga=function(){this.g&&vo(this)};function vo(l){l.readyState=4,l.l=null,l.j=null,l.v=null,bo(l)}t.setRequestHeader=function(l,m){this.u.append(l,m)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],m=this.h.entries();for(var g=m.next();!g.done;)g=g.value,l.push(g[0]+": "+g[1]),g=m.next();return l.join(`\r
`)};function bo(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(ps.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function mu(l){let m="";return oe(l,function(g,O){m+=O,m+=":",m+=g,m+=`\r
`}),m}function Wa(l,m,g){e:{for(O in g){var O=!1;break e}O=!0}O||(g=mu(g),typeof l=="string"?g!=null&&encodeURIComponent(String(g)):Vt(l,m,g))}function Yt(l){se.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}D(Yt,se);var Zy=/^https?$/i,eg=["POST","PUT"];t=Yt.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,m,g,O){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);m=m?m.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():nt.g(),this.v=this.o?qe(this.o):qe(nt),this.g.onreadystatechange=b(this.Ea,this);try{this.B=!0,this.g.open(m,String(l),!0),this.B=!1}catch(Ce){fu(this,Ce);return}if(l=g||"",g=new Map(this.headers),O)if(Object.getPrototypeOf(O)===Object.prototype)for(var Se in O)g.set(Se,O[Se]);else if(typeof O.keys=="function"&&typeof O.get=="function")for(const Ce of O.keys())g.set(Ce,O.get(Ce));else throw Error("Unknown input type for opt_headers: "+String(O));O=Array.from(g.keys()).find(Ce=>Ce.toLowerCase()=="content-type"),Se=c.FormData&&l instanceof c.FormData,!(0<=Array.prototype.indexOf.call(eg,m,void 0))||O||Se||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ce,Le]of g)this.g.setRequestHeader(Ce,Le);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{pu(this),this.u=!0,this.g.send(l),this.u=!1}catch(Ce){fu(this,Ce)}};function fu(l,m){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=m,l.m=5,yu(l),vs(l)}function yu(l){l.A||(l.A=!0,be(l,"complete"),be(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,be(this,"complete"),be(this,"abort"),vs(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),vs(this,!0)),Yt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?gu(this):this.bb())},t.bb=function(){gu(this)};function gu(l){if(l.h&&typeof a<"u"&&(!l.v[1]||fn(l)!=4||l.Z()!=2)){if(l.u&&fn(l)==4)we(l.Ea,0,l);else if(be(l,"readystatechange"),fn(l)==4){l.h=!1;try{const Le=l.Z();e:switch(Le){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var m=!0;break e;default:m=!1}var g;if(!(g=m)){var O;if(O=Le===0){var Se=String(l.D).match(kr)[1]||null;!Se&&c.self&&c.self.location&&(Se=c.self.location.protocol.slice(0,-1)),O=!Zy.test(Se?Se.toLowerCase():"")}g=O}if(g)be(l,"complete"),be(l,"success");else{l.m=6;try{var Ce=2<fn(l)?l.g.statusText:""}catch{Ce=""}l.l=Ce+" ["+l.Z()+"]",yu(l)}}finally{vs(l)}}}}function vs(l,m){if(l.g){pu(l);const g=l.g,O=l.v[0]?()=>{}:null;l.g=null,l.v=null,m||be(l,"ready");try{g.onreadystatechange=O}catch{}}}function pu(l){l.I&&(c.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function fn(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<fn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var m=this.g.responseText;return l&&m.indexOf(l)==0&&(m=m.substring(l.length)),Ie(m)}};function vu(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function tg(l){const m={};l=(l.g&&2<=fn(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let O=0;O<l.length;O++){if(H(l[O]))continue;var g=w(l[O]);const Se=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const Ce=m[Se]||[];m[Se]=Ce,Ce.push(g)}I(m,function(O){return O.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function _o(l,m,g){return g&&g.internalChannelParams&&g.internalChannelParams[l]||m}function bu(l){this.Aa=0,this.i=[],this.j=new Nt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=_o("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=_o("baseRetryDelayMs",5e3,l),this.cb=_o("retryDelaySeedMs",1e4,l),this.Wa=_o("forwardChannelMaxRetries",2,l),this.wa=_o("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new Ri(l&&l.concurrentRequestLimit),this.Da=new Jy,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=bu.prototype,t.la=8,t.G=1,t.connect=function(l,m,g,O){ht(0),this.W=l,this.H=m||{},g&&O!==void 0&&(this.H.OSID=g,this.H.OAID=O),this.F=this.X,this.I=xu(this,null,this.W),_s(this)};function Ga(l){if(_u(l),l.G==3){var m=l.U++,g=Ir(l.I);if(Vt(g,"SID",l.K),Vt(g,"RID",m),Vt(g,"TYPE","terminate"),So(l,g),m=new Pt(l,l.j,m),m.L=2,m.v=Ni(Ir(g)),g=!1,c.navigator&&c.navigator.sendBeacon)try{g=c.navigator.sendBeacon(m.v.toString(),"")}catch{}!g&&c.Image&&(new Image().src=m.v,g=!0),g||(m.g=Tu(m.j,null),m.g.ea(m.v)),m.F=Date.now(),Mt(m)}Eu(l)}function bs(l){l.g&&(Ya(l),l.g.cancel(),l.g=null)}function _u(l){bs(l),l.u&&(c.clearTimeout(l.u),l.u=null),Ss(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&c.clearTimeout(l.s),l.s=null)}function _s(l){if(!oi(l.h)&&!l.s){l.s=!0;var m=l.Ga;Z||V(),k||(Z(),k=!0),F.add(m,l),l.B=0}}function rg(l,m){return si(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=m.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Lt(b(l.Ga,l,m),Iu(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const Se=new Pt(this,this.j,l);let Ce=this.o;if(this.S&&(Ce?(Ce=_(Ce),P(Ce,this.S)):Ce=this.S),this.m!==null||this.O||(Se.H=Ce,Ce=null),this.P)e:{for(var m=0,g=0;g<this.i.length;g++){t:{var O=this.i[g];if("__data__"in O.map&&(O=O.map.__data__,typeof O=="string")){O=O.length;break t}O=void 0}if(O===void 0)break;if(m+=O,4096<m){m=g;break e}if(m===4096||g===this.i.length-1){m=g+1;break e}}m=1e3}else m=1e3;m=Pu(this,Se,m),g=Ir(this.I),Vt(g,"RID",l),Vt(g,"CVER",22),this.D&&Vt(g,"X-HTTP-Session-Id",this.D),So(this,g),Ce&&(this.O?m="headers="+encodeURIComponent(String(mu(Ce)))+"&"+m:this.m&&Wa(g,this.m,Ce)),Qr(this.h,Se),this.Ua&&Vt(g,"TYPE","init"),this.P?(Vt(g,"$req",m),Vt(g,"SID","null"),Se.T=!0,ar(Se,g,null)):ar(Se,g,m),this.G=2}}else this.G==3&&(l?Su(this,l):this.i.length==0||oi(this.h)||Su(this))};function Su(l,m){var g;m?g=m.l:g=l.U++;const O=Ir(l.I);Vt(O,"SID",l.K),Vt(O,"RID",g),Vt(O,"AID",l.T),So(l,O),l.m&&l.o&&Wa(O,l.m,l.o),g=new Pt(l,l.j,g,l.B+1),l.m===null&&(g.H=l.o),m&&(l.i=m.D.concat(l.i)),m=Pu(l,g,1e3),g.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),Qr(l.h,g),ar(g,O,m)}function So(l,m){l.H&&oe(l.H,function(g,O){Vt(m,O,g)}),l.l&&lr({},function(g,O){Vt(m,O,g)})}function Pu(l,m,g){g=Math.min(l.i.length,g);var O=l.l?b(l.l.Na,l.l,l):null;e:{var Se=l.i;let Ce=-1;for(;;){const Le=["count="+g];Ce==-1?0<g?(Ce=Se[0].g,Le.push("ofs="+Ce)):Ce=0:Le.push("ofs="+Ce);let Bt=!0;for(let hr=0;hr<g;hr++){let wt=Se[hr].g;const pr=Se[hr].map;if(wt-=Ce,0>wt)Ce=Math.max(0,Se[hr].g-100),Bt=!1;else try{Xy(pr,Le,"req"+wt+"_")}catch{O&&O(pr)}}if(Bt){O=Le.join("&");break e}}}return l=l.i.splice(0,g),m.D=l,O}function wu(l){if(!l.g&&!l.u){l.Y=1;var m=l.Fa;Z||V(),k||(Z(),k=!0),F.add(m,l),l.v=0}}function Ka(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Lt(b(l.Fa,l),Iu(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,Cu(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Lt(b(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ht(10),bs(this),Cu(this))};function Ya(l){l.A!=null&&(c.clearTimeout(l.A),l.A=null)}function Cu(l){l.g=new Pt(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var m=Ir(l.qa);Vt(m,"RID","rpc"),Vt(m,"SID",l.K),Vt(m,"AID",l.T),Vt(m,"CI",l.F?"0":"1"),!l.F&&l.ja&&Vt(m,"TO",l.ja),Vt(m,"TYPE","xmlhttp"),So(l,m),l.m&&l.o&&Wa(m,l.m,l.o),l.L&&(l.g.I=l.L);var g=l.g;l=l.ia,g.L=1,g.v=Ni(Ir(m)),g.m=null,g.P=!0,Tt(g,l)}t.Za=function(){this.C!=null&&(this.C=null,bs(this),Ka(this),ht(19))};function Ss(l){l.C!=null&&(c.clearTimeout(l.C),l.C=null)}function Au(l,m){var g=null;if(l.g==m){Ss(l),Ya(l),l.g=null;var O=2}else if(Rn(l.h,m))g=m.D,Di(l.h,m),O=1;else return;if(l.G!=0){if(m.o)if(O==1){g=m.m?m.m.length:0,m=Date.now()-m.F;var Se=l.B;O=_t(),be(O,new St(O,g)),_s(l)}else wu(l);else if(Se=m.s,Se==3||Se==0&&0<m.X||!(O==1&&rg(l,m)||O==2&&Ka(l)))switch(g&&0<g.length&&(m=l.h,m.i=m.i.concat(g)),Se){case 1:li(l,5);break;case 4:li(l,10);break;case 3:li(l,6);break;default:li(l,2)}}}function Iu(l,m){let g=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(g*=2),g*m}function li(l,m){if(l.j.info("Error code "+m),m==2){var g=b(l.fb,l),O=l.Xa;const Se=!O;O=new Ot(O||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Jr(O,"https"),Ni(O),Se?Yy(O.toString(),g):Qy(O.toString(),g)}else ht(2);l.G=0,l.l&&l.l.sa(m),Eu(l),_u(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),ht(2)):(this.j.info("Failed to ping google.com"),ht(1))};function Eu(l){if(l.G=0,l.ka=[],l.l){const m=ai(l.h);(m.length!=0||l.i.length!=0)&&(E(l.ka,m),E(l.ka,l.i),l.h.i.length=0,x(l.i),l.i.length=0),l.l.ra()}}function xu(l,m,g){var O=g instanceof Ot?Ir(g):new Ot(g);if(O.g!="")m&&(O.g=m+"."+O.g),Xr(O,O.s);else{var Se=c.location;O=Se.protocol,m=m?m+"."+Se.hostname:Se.hostname,Se=+Se.port;var Ce=new Ot(null);O&&Jr(Ce,O),m&&(Ce.g=m),Se&&Xr(Ce,Se),g&&(Ce.l=g),O=Ce}return g=l.D,m=l.ya,g&&m&&Vt(O,g,m),Vt(O,"VER",l.la),So(l,O),O}function Tu(l,m,g){if(m&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return m=l.Ca&&!l.pa?new Yt(new gs({eb:g})):new Yt(l.pa),m.Ha(l.J),m}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function $u(){}t=$u.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Ps(){}Ps.prototype.g=function(l,m){return new Rr(l,m)};function Rr(l,m){se.call(this),this.g=new bu(m),this.l=l,this.h=m&&m.messageUrlParams||null,l=m&&m.messageHeaders||null,m&&m.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=m&&m.initMessageHeaders||null,m&&m.messageContentType&&(l?l["X-WebChannel-Content-Type"]=m.messageContentType:l={"X-WebChannel-Content-Type":m.messageContentType}),m&&m.va&&(l?l["X-WebChannel-Client-Profile"]=m.va:l={"X-WebChannel-Client-Profile":m.va}),this.g.S=l,(l=m&&m.Sb)&&!H(l)&&(this.g.m=l),this.v=m&&m.supportsCrossDomainXhr||!1,this.u=m&&m.sendRawJson||!1,(m=m&&m.httpSessionIdParam)&&!H(m)&&(this.g.D=m,l=this.h,l!==null&&m in l&&(l=this.h,m in l&&delete l[m])),this.j=new Mi(this)}D(Rr,se),Rr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Rr.prototype.close=function(){Ga(this.g)},Rr.prototype.o=function(l){var m=this.g;if(typeof l=="string"){var g={};g.__data__=l,l=g}else this.u&&(g={},g.__data__=je(l),l=g);m.i.push(new kn(m.Ya++,l)),m.G==3&&_s(m)},Rr.prototype.N=function(){this.g.l=null,delete this.j,Ga(this.g),delete this.g,Rr.aa.N.call(this)};function ku(l){rt.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var m=l.__sm__;if(m){e:{for(const g in m){l=g;break e}l=void 0}(this.i=l)&&(l=this.i,m=m!==null&&l in m?m[l]:void 0),this.data=m}else this.data=l}D(ku,rt);function Ru(){et.call(this),this.status=1}D(Ru,et);function Mi(l){this.g=l}D(Mi,$u),Mi.prototype.ua=function(){be(this.g,"a")},Mi.prototype.ta=function(l){be(this.g,new ku(l))},Mi.prototype.sa=function(l){be(this.g,new Ru)},Mi.prototype.ra=function(){be(this.g,"b")},Ps.prototype.createWebChannel=Ps.prototype.g,Rr.prototype.send=Rr.prototype.o,Rr.prototype.open=Rr.prototype.m,Rr.prototype.close=Rr.prototype.close,ff=function(){return new Ps},mf=function(){return _t()},hf=ct,Hl={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Qe.NO_ERROR=0,Qe.TIMEOUT=8,Qe.HTTP_ERROR=6,Gs=Qe,Ee.COMPLETE="complete",df=Ee,Ge.EventType=Ae,Ae.OPEN="a",Ae.CLOSE="b",Ae.ERROR="c",Ae.MESSAGE="d",se.prototype.listen=se.prototype.K,xo=Ge,Yt.prototype.listenOnce=Yt.prototype.L,Yt.prototype.getLastError=Yt.prototype.Ka,Yt.prototype.getLastErrorCode=Yt.prototype.Ba,Yt.prototype.getStatus=Yt.prototype.Z,Yt.prototype.getResponseJson=Yt.prototype.Oa,Yt.prototype.getResponseText=Yt.prototype.oa,Yt.prototype.send=Yt.prototype.ea,Yt.prototype.setWithCredentials=Yt.prototype.Ha,uf=Yt}).apply(typeof Is<"u"?Is:typeof self<"u"?self:typeof window<"u"?window:{});const pd="@firebase/firestore",vd="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Sr.UNAUTHENTICATED=new Sr(null),Sr.GOOGLE_CREDENTIALS=new Sr("google-credentials-uid"),Sr.FIRST_PARTY=new Sr("first-party-uid"),Sr.MOCK_USER=new Sr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uo="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ci=new gc("@firebase/firestore");function zi(){return Ci.logLevel}function ze(t,...e){if(Ci.logLevel<=gt.DEBUG){const r=e.map(Tc);Ci.debug(`Firestore (${uo}): ${t}`,...r)}}function En(t,...e){if(Ci.logLevel<=gt.ERROR){const r=e.map(Tc);Ci.error(`Firestore (${uo}): ${t}`,...r)}}function eo(t,...e){if(Ci.logLevel<=gt.WARN){const r=e.map(Tc);Ci.warn(`Firestore (${uo}): ${t}`,...r)}}function Tc(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tt(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,yf(t,n,r)}function yf(t,e,r){let n=`FIRESTORE (${uo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw En(n),new Error(n)}function $t(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||yf(e,i,n)}function lt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Je extends $n{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class l_{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Sr.UNAUTHENTICATED))}shutdown(){}}class c_{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class u_{constructor(e){this.t=e,this.currentUser=Sr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){$t(this.o===void 0,42304);let n=this.i;const i=u=>this.i!==n?(n=this.i,r(u)):Promise.resolve();let o=new Qn;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Qn,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const u=o;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},c=u=>{ze("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(ze("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Qn)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(ze("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?($t(typeof n.accessToken=="string",31837,{l:n}),new gf(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return $t(e===null||typeof e=="string",2055,{h:e}),new Sr(e)}}class d_{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Sr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class h_{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new d_(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(Sr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class bd{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class m_{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Mr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){$t(this.o===void 0,3512);const n=o=>{o.error!=null&&ze("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const a=o.token!==this.m;return this.m=o.token,ze("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>n(o))};const i=o=>{ze("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):ze("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new bd(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?($t(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new bd(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f_(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=f_(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<r&&(n+=e.charAt(i[o]%62))}return n}}function pt(t,e){return t<e?-1:t>e?1:0}function Wl(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const i=t.charAt(n),o=e.charAt(n);if(i!==o)return ll(i)===ll(o)?pt(i,o):ll(i)?1:-1}return pt(t.length,e.length)}const y_=55296,g_=57343;function ll(t){const e=t.charCodeAt(0);return e>=y_&&e<=g_}function to(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _d="__name__";class tn{constructor(e,r,n){r===void 0?r=0:r>e.length&&tt(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&tt(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return tn.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof tn?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const o=tn.compareSegments(e.get(i),r.get(i));if(o!==0)return o}return pt(e.length,r.length)}static compareSegments(e,r){const n=tn.isNumericId(e),i=tn.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?tn.extractNumericId(e).compare(tn.extractNumericId(r)):Wl(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Yn.fromString(e.substring(4,e.length-2))}}class Wt extends tn{construct(e,r,n){return new Wt(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Je(Re.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Wt(r)}static emptyPath(){return new Wt([])}}const p_=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class fr extends tn{construct(e,r,n){return new fr(e,r,n)}static isValidIdentifier(e){return p_.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),fr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===_d}static keyField(){return new fr([_d])}static fromServerFormat(e){const r=[];let n="",i=0;const o=()=>{if(n.length===0)throw new Je(Re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new Je(Re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Je(Re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,i+=2}else c==="`"?(a=!a,i++):c!=="."||a?(n+=c,i++):(o(),i++)}if(o(),a)throw new Je(Re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new fr(r)}static emptyPath(){return new fr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(e){this.path=e}static fromPath(e){return new Ze(Wt.fromString(e))}static fromName(e){return new Ze(Wt.fromString(e).popFirst(5))}static empty(){return new Ze(Wt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Wt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Wt.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ze(new Wt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v_(t,e,r){if(!r)throw new Je(Re.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function b_(t,e,r,n){if(e===!0&&n===!0)throw new Je(Re.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function Sd(t){if(!Ze.isDocumentKey(t))throw new Je(Re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function pf(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function kc(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":tt(12329,{type:typeof t})}function Yo(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Je(Re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=kc(t);throw new Je(Re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tr(t,e){const r={typeString:t};return e&&(r.value=e),r}function us(t,e){if(!pf(t))throw new Je(Re.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const a=t[n];if(i&&typeof a!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(o!==void 0&&a!==o.value){r=`Expected '${n}' field to equal '${o.value}'`;break}}if(r)throw new Je(Re.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pd=-62135596800,wd=1e6;class zt{static now(){return zt.fromMillis(Date.now())}static fromDate(e){return zt.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*wd);return new zt(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Je(Re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Je(Re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<Pd)throw new Je(Re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Je(Re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/wd}_compareTo(e){return this.seconds===e.seconds?pt(this.nanoseconds,e.nanoseconds):pt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:zt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(us(e,zt._jsonSchema))return new zt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Pd;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}zt._jsonSchemaVersion="firestore/timestamp/1.0",zt._jsonSchema={type:tr("string",zt._jsonSchemaVersion),seconds:tr("number"),nanoseconds:tr("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{static fromTimestamp(e){return new st(e)}static min(){return new st(new zt(0,0))}static max(){return new st(new zt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qo=-1;function __(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=st.fromTimestamp(n===1e9?new zt(r+1,0):new zt(r,n));return new Jn(i,Ze.empty(),e)}function S_(t){return new Jn(t.readTime,t.key,Qo)}class Jn{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Jn(st.min(),Ze.empty(),Qo)}static max(){return new Jn(st.max(),Ze.empty(),Qo)}}function P_(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Ze.comparator(t.documentKey,e.documentKey),r!==0?r:pt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w_="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class C_{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ho(t){if(t.code!==Re.FAILED_PRECONDITION||t.message!==w_)throw t;ze("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&tt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new $e((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(r,o).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof $e?r:$e.resolve(r)}catch(r){return $e.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):$e.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):$e.reject(r)}static resolve(e){return new $e((r,n)=>{r(e)})}static reject(e){return new $e((r,n)=>{n(e)})}static waitFor(e){return new $e((r,n)=>{let i=0,o=0,a=!1;e.forEach(c=>{++i,c.next(()=>{++o,a&&o===i&&r()},u=>n(u))}),a=!0,o===i&&r()})}static or(e){let r=$e.resolve(!1);for(const n of e)r=r.next(i=>i?$e.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,o)=>{n.push(r.call(this,i,o))}),this.waitFor(n)}static mapArray(e,r){return new $e((n,i)=>{const o=e.length,a=new Array(o);let c=0;for(let u=0;u<o;u++){const h=u;r(e[h]).next(f=>{a[h]=f,++c,c===o&&n(a)},f=>i(f))}})}static doWhile(e,r){return new $e((n,i)=>{const o=()=>{e()===!0?r().next(()=>{o()},i):n()};o()})}}function A_(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function mo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Da.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rc=-1;function Na(t){return t==null}function fa(t){return t===0&&1/t==-1/0}function I_(t){return typeof t=="number"&&Number.isInteger(t)&&!fa(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vf="";function E_(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=Cd(e)),e=x_(t.get(r),e);return Cd(e)}function x_(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const o=t.charAt(i);switch(o){case"\0":r+="";break;case vf:r+="";break;default:r+=o}}return r}function Cd(t){return t+vf+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ad(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function xi(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function bf(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e,r){this.comparator=e,this.root=r||mr.EMPTY}insert(e,r){return new Gt(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,mr.BLACK,null,null))}remove(e){return new Gt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,mr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Es(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Es(this.root,e,this.comparator,!1)}getReverseIterator(){return new Es(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Es(this.root,e,this.comparator,!0)}}class Es{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=r?n(e.key,r):1,r&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class mr{constructor(e,r,n,i,o){this.key=e,this.value=r,this.color=n??mr.RED,this.left=i??mr.EMPTY,this.right=o??mr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,o){return new mr(e??this.key,r??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const o=n(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,r,n),null):o===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return mr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return mr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,mr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,mr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw tt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw tt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw tt(27949);return e+(this.isRed()?0:1)}}mr.EMPTY=null,mr.RED=!0,mr.BLACK=!1;mr.EMPTY=new class{constructor(){this.size=0}get key(){throw tt(57766)}get value(){throw tt(16141)}get color(){throw tt(16727)}get left(){throw tt(29726)}get right(){throw tt(36894)}copy(e,r,n,i,o){return this}insert(e,r,n){return new mr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or{constructor(e){this.comparator=e,this.data=new Gt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new Id(this.data.getIterator())}getIteratorFrom(e){return new Id(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof or)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new or(this.comparator);return r.data=e,r}}class Id{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr{constructor(e){this.fields=e,e.sort(fr.comparator)}static empty(){return new Gr([])}unionWith(e){let r=new or(fr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Gr(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return to(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _f extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new _f("Invalid base64 string: "+o):o}}(e);return new gr(r)}static fromUint8Array(e){const r=function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o}(e);return new gr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return pt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}gr.EMPTY_BYTE_STRING=new gr("");const T_=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Xn(t){if($t(!!t,39018),typeof t=="string"){let e=0;const r=T_.exec(t);if($t(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Jt(t.seconds),nanos:Jt(t.nanos)}}function Jt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Zn(t){return typeof t=="string"?gr.fromBase64String(t):gr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sf="server_timestamp",Pf="__type__",wf="__previous_value__",Cf="__local_write_time__";function Dc(t){return(t?.mapValue?.fields||{})[Pf]?.stringValue===Sf}function La(t){const e=t.mapValue.fields[wf];return Dc(e)?La(e):e}function Jo(t){const e=Xn(t.mapValue.fields[Cf].timestampValue);return new zt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $_{constructor(e,r,n,i,o,a,c,u,h,f){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=f}}const ya="(default)";class Xo{constructor(e,r){this.projectId=e,this.database=r||ya}static empty(){return new Xo("","")}get isDefaultDatabase(){return this.database===ya}isEqual(e){return e instanceof Xo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Af="__type__",k_="__max__",xs={mapValue:{}},If="__vector__",ga="value";function ei(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Dc(t)?4:D_(t)?9007199254740991:R_(t)?10:11:tt(28295,{value:t})}function un(t,e){if(t===e)return!0;const r=ei(t);if(r!==ei(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Jo(t).isEqual(Jo(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const a=Xn(i.timestampValue),c=Xn(o.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,o){return Zn(i.bytesValue).isEqual(Zn(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,o){return Jt(i.geoPointValue.latitude)===Jt(o.geoPointValue.latitude)&&Jt(i.geoPointValue.longitude)===Jt(o.geoPointValue.longitude)}(t,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return Jt(i.integerValue)===Jt(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const a=Jt(i.doubleValue),c=Jt(o.doubleValue);return a===c?fa(a)===fa(c):isNaN(a)&&isNaN(c)}return!1}(t,e);case 9:return to(t.arrayValue.values||[],e.arrayValue.values||[],un);case 10:case 11:return function(i,o){const a=i.mapValue.fields||{},c=o.mapValue.fields||{};if(Ad(a)!==Ad(c))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(c[u]===void 0||!un(a[u],c[u])))return!1;return!0}(t,e);default:return tt(52216,{left:t})}}function Zo(t,e){return(t.values||[]).find(r=>un(r,e))!==void 0}function ro(t,e){if(t===e)return 0;const r=ei(t),n=ei(e);if(r!==n)return pt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return pt(t.booleanValue,e.booleanValue);case 2:return function(o,a){const c=Jt(o.integerValue||o.doubleValue),u=Jt(a.integerValue||a.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return Ed(t.timestampValue,e.timestampValue);case 4:return Ed(Jo(t),Jo(e));case 5:return Wl(t.stringValue,e.stringValue);case 6:return function(o,a){const c=Zn(o),u=Zn(a);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(o,a){const c=o.split("/"),u=a.split("/");for(let h=0;h<c.length&&h<u.length;h++){const f=pt(c[h],u[h]);if(f!==0)return f}return pt(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,a){const c=pt(Jt(o.latitude),Jt(a.latitude));return c!==0?c:pt(Jt(o.longitude),Jt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return xd(t.arrayValue,e.arrayValue);case 10:return function(o,a){const c=o.fields||{},u=a.fields||{},h=c[ga]?.arrayValue,f=u[ga]?.arrayValue,p=pt(h?.values?.length||0,f?.values?.length||0);return p!==0?p:xd(h,f)}(t.mapValue,e.mapValue);case 11:return function(o,a){if(o===xs.mapValue&&a===xs.mapValue)return 0;if(o===xs.mapValue)return 1;if(a===xs.mapValue)return-1;const c=o.fields||{},u=Object.keys(c),h=a.fields||{},f=Object.keys(h);u.sort(),f.sort();for(let p=0;p<u.length&&p<f.length;++p){const b=Wl(u[p],f[p]);if(b!==0)return b;const C=ro(c[u[p]],h[f[p]]);if(C!==0)return C}return pt(u.length,f.length)}(t.mapValue,e.mapValue);default:throw tt(23264,{he:r})}}function Ed(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return pt(t,e);const r=Xn(t),n=Xn(e),i=pt(r.seconds,n.seconds);return i!==0?i:pt(r.nanos,n.nanos)}function xd(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const o=ro(r[i],n[i]);if(o)return o}return pt(r.length,n.length)}function no(t){return Gl(t)}function Gl(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Xn(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Zn(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Ze.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const o of r.values||[])i?i=!1:n+=",",n+=Gl(o);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const a of n)o?o=!1:i+=",",i+=`${a}:${Gl(r.fields[a])}`;return i+"}"}(t.mapValue):tt(61005,{value:t})}function Ks(t){switch(ei(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=La(t);return e?16+Ks(e):16;case 5:return 2*t.stringValue.length;case 6:return Zn(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,o)=>i+Ks(o),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return xi(n.fields,(o,a)=>{i+=o.length+Ks(a)}),i}(t.mapValue);default:throw tt(13486,{value:t})}}function Kl(t){return!!t&&"integerValue"in t}function Nc(t){return!!t&&"arrayValue"in t}function Td(t){return!!t&&"nullValue"in t}function $d(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ys(t){return!!t&&"mapValue"in t}function R_(t){return(t?.mapValue?.fields||{})[Af]?.stringValue===If}function Oo(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return xi(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Oo(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Oo(t.arrayValue.values[r]);return e}return{...t}}function D_(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===k_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e){this.value=e}static empty(){return new Or({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Ys(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Oo(r)}setAll(e){let r=fr.emptyPath(),n={},i=[];e.forEach((a,c)=>{if(!r.isImmediateParentOf(c)){const u=this.getFieldsMap(r);this.applyChanges(u,n,i),n={},i=[],r=c.popLast()}a?n[c.lastSegment()]=Oo(a):i.push(c.lastSegment())});const o=this.getFieldsMap(r);this.applyChanges(o,n,i)}delete(e){const r=this.field(e.popLast());Ys(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return un(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];Ys(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){xi(r,(i,o)=>e[i]=o);for(const i of n)delete e[i]}clone(){return new Or(Oo(this.value))}}function Ef(t){const e=[];return xi(t.fields,(r,n)=>{const i=new fr([r]);if(Ys(n)){const o=Ef(n.mapValue).fields;if(o.length===0)e.push(i);else for(const a of o)e.push(i.child(a))}else e.push(i)}),new Gr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e,r,n,i,o,a,c){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=o,this.data=a,this.documentState=c}static newInvalidDocument(e){return new Pr(e,0,st.min(),st.min(),st.min(),Or.empty(),0)}static newFoundDocument(e,r,n,i){return new Pr(e,1,r,st.min(),n,i,0)}static newNoDocument(e,r){return new Pr(e,2,r,st.min(),st.min(),Or.empty(),0)}static newUnknownDocument(e,r){return new Pr(e,3,r,st.min(),st.min(),Or.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(st.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Or.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Or.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=st.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Pr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Pr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa{constructor(e,r){this.position=e,this.inclusive=r}}function kd(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const o=e[i],a=t.position[i];if(o.field.isKeyField()?n=Ze.comparator(Ze.fromName(a.referenceValue),r.key):n=ro(a,r.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function Rd(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!un(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(e,r="asc"){this.field=e,this.dir=r}}function N_(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xf{}class ir extends xf{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new M_(e,r,n):r==="array-contains"?new B_(e,n):r==="in"?new F_(e,n):r==="not-in"?new U_(e,n):r==="array-contains-any"?new j_(e,n):new ir(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new O_(e,n):new V_(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(ro(r,this.value)):r!==null&&ei(this.value)===ei(r)&&this.matchesComparison(ro(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return tt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class dn extends xf{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new dn(e,r)}matches(e){return Tf(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Tf(t){return t.op==="and"}function $f(t){return L_(t)&&Tf(t)}function L_(t){for(const e of t.filters)if(e instanceof dn)return!1;return!0}function Yl(t){if(t instanceof ir)return t.field.canonicalString()+t.op.toString()+no(t.value);if($f(t))return t.filters.map(e=>Yl(e)).join(",");{const e=t.filters.map(r=>Yl(r)).join(",");return`${t.op}(${e})`}}function kf(t,e){return t instanceof ir?function(n,i){return i instanceof ir&&n.op===i.op&&n.field.isEqual(i.field)&&un(n.value,i.value)}(t,e):t instanceof dn?function(n,i){return i instanceof dn&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((o,a,c)=>o&&kf(a,i.filters[c]),!0):!1}(t,e):void tt(19439)}function Rf(t){return t instanceof ir?function(r){return`${r.field.canonicalString()} ${r.op} ${no(r.value)}`}(t):t instanceof dn?function(r){return r.op.toString()+" {"+r.getFilters().map(Rf).join(" ,")+"}"}(t):"Filter"}class M_ extends ir{constructor(e,r,n){super(e,r,n),this.key=Ze.fromName(n.referenceValue)}matches(e){const r=Ze.comparator(e.key,this.key);return this.matchesComparison(r)}}class O_ extends ir{constructor(e,r){super(e,"in",r),this.keys=Df("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class V_ extends ir{constructor(e,r){super(e,"not-in",r),this.keys=Df("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function Df(t,e){return(e.arrayValue?.values||[]).map(r=>Ze.fromName(r.referenceValue))}class B_ extends ir{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Nc(r)&&Zo(r.arrayValue,this.value)}}class F_ extends ir{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Zo(this.value.arrayValue,r)}}class U_ extends ir{constructor(e,r){super(e,"not-in",r)}matches(e){if(Zo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!Zo(this.value.arrayValue,r)}}class j_ extends ir{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Nc(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Zo(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z_{constructor(e,r=null,n=[],i=[],o=null,a=null,c=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=a,this.endAt=c,this.Te=null}}function Dd(t,e=null,r=[],n=[],i=null,o=null,a=null){return new z_(t,e,r,n,i,o,a)}function Lc(t){const e=lt(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Yl(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(o){return o.field.canonicalString()+o.dir}(n)).join(","),Na(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>no(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>no(n)).join(",")),e.Te=r}return e.Te}function Mc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!N_(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!kf(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Rd(t.startAt,e.startAt)&&Rd(t.endAt,e.endAt)}function Ql(t){return Ze.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(e,r=null,n=[],i=[],o=null,a="F",c=null,u=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=a,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function q_(t,e,r,n,i,o,a,c){return new Ma(t,e,r,n,i,o,a,c)}function Oc(t){return new Ma(t)}function Nd(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function H_(t){return t.collectionGroup!==null}function Vo(t){const e=lt(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),r.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new or(fr.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(c=c.add(h.field))})}),c})(e).forEach(o=>{r.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new va(o,n))}),r.has(fr.keyField().canonicalString())||e.Ie.push(new va(fr.keyField(),n))}return e.Ie}function on(t){const e=lt(t);return e.Ee||(e.Ee=W_(e,Vo(t))),e.Ee}function W_(t,e){if(t.limitType==="F")return Dd(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const o=i.dir==="desc"?"asc":"desc";return new va(i.field,o)});const r=t.endAt?new pa(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new pa(t.startAt.position,t.startAt.inclusive):null;return Dd(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Jl(t,e,r){return new Ma(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Oa(t,e){return Mc(on(t),on(e))&&t.limitType===e.limitType}function Nf(t){return`${Lc(on(t))}|lt:${t.limitType}`}function qi(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>Rf(i)).join(", ")}]`),Na(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>no(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>no(i)).join(",")),`Target(${n})`}(on(t))}; limitType=${t.limitType})`}function Va(t,e){return e.isFoundDocument()&&function(n,i){const o=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):Ze.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(t,e)&&function(n,i){for(const o of Vo(n))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const o of n.filters)if(!o.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,c,u){const h=kd(a,c,u);return a.inclusive?h<=0:h<0}(n.startAt,Vo(n),i)||n.endAt&&!function(a,c,u){const h=kd(a,c,u);return a.inclusive?h>=0:h>0}(n.endAt,Vo(n),i))}(t,e)}function G_(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Lf(t){return(e,r)=>{let n=!1;for(const i of Vo(t)){const o=K_(i,e,r);if(o!==0)return o;n=n||i.field.isKeyField()}return 0}}function K_(t,e,r){const n=t.field.isKeyField()?Ze.comparator(e.key,r.key):function(o,a,c){const u=a.data.field(o),h=c.data.field(o);return u!==null&&h!==null?ro(u,h):tt(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return tt(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,o]of n)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){xi(this.inner,(r,n)=>{for(const[i,o]of n)e(i,o)})}isEmpty(){return bf(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y_=new Gt(Ze.comparator);function xn(){return Y_}const Mf=new Gt(Ze.comparator);function To(...t){let e=Mf;for(const r of t)e=e.insert(r.key,r);return e}function Of(t){let e=Mf;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function vi(){return Bo()}function Vf(){return Bo()}function Bo(){return new Ti(t=>t.toString(),(t,e)=>t.isEqual(e))}const Q_=new Gt(Ze.comparator),J_=new or(Ze.comparator);function vt(...t){let e=J_;for(const r of t)e=e.add(r);return e}const X_=new or(pt);function Z_(){return X_}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vc(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:fa(e)?"-0":e}}function Bf(t){return{integerValue:""+t}}function eS(t,e){return I_(e)?Bf(e):Vc(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ba{constructor(){this._=void 0}}function tS(t,e,r){return t instanceof ba?function(i,o){const a={fields:{[Pf]:{stringValue:Sf},[Cf]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Dc(o)&&(o=La(o)),o&&(a.fields[wf]=o),{mapValue:a}}(r,e):t instanceof es?Uf(t,e):t instanceof ts?jf(t,e):function(i,o){const a=Ff(i,o),c=Ld(a)+Ld(i.Ae);return Kl(a)&&Kl(i.Ae)?Bf(c):Vc(i.serializer,c)}(t,e)}function rS(t,e,r){return t instanceof es?Uf(t,e):t instanceof ts?jf(t,e):r}function Ff(t,e){return t instanceof _a?function(n){return Kl(n)||function(o){return!!o&&"doubleValue"in o}(n)}(e)?e:{integerValue:0}:null}class ba extends Ba{}class es extends Ba{constructor(e){super(),this.elements=e}}function Uf(t,e){const r=zf(e);for(const n of t.elements)r.some(i=>un(i,n))||r.push(n);return{arrayValue:{values:r}}}class ts extends Ba{constructor(e){super(),this.elements=e}}function jf(t,e){let r=zf(e);for(const n of t.elements)r=r.filter(i=>!un(i,n));return{arrayValue:{values:r}}}class _a extends Ba{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function Ld(t){return Jt(t.integerValue||t.doubleValue)}function zf(t){return Nc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function nS(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof es&&i instanceof es||n instanceof ts&&i instanceof ts?to(n.elements,i.elements,un):n instanceof _a&&i instanceof _a?un(n.Ae,i.Ae):n instanceof ba&&i instanceof ba}(t.transform,e.transform)}class iS{constructor(e,r){this.version=e,this.transformResults=r}}class Cn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Cn}static exists(e){return new Cn(void 0,e)}static updateTime(e){return new Cn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Qs(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Fa{}function qf(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Wf(t.key,Cn.none()):new ds(t.key,t.data,Cn.none());{const r=t.data,n=Or.empty();let i=new or(fr.comparator);for(let o of e.fields)if(!i.has(o)){let a=r.field(o);a===null&&o.length>1&&(o=o.popLast(),a=r.field(o)),a===null?n.delete(o):n.set(o,a),i=i.add(o)}return new $i(t.key,n,new Gr(i.toArray()),Cn.none())}}function oS(t,e,r){t instanceof ds?function(i,o,a){const c=i.value.clone(),u=Od(i.fieldTransforms,o,a.transformResults);c.setAll(u),o.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,r):t instanceof $i?function(i,o,a){if(!Qs(i.precondition,o))return void o.convertToUnknownDocument(a.version);const c=Od(i.fieldTransforms,o,a.transformResults),u=o.data;u.setAll(Hf(i)),u.setAll(c),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,r):function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function Fo(t,e,r,n){return t instanceof ds?function(o,a,c,u){if(!Qs(o.precondition,a))return c;const h=o.value.clone(),f=Vd(o.fieldTransforms,u,a);return h.setAll(f),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(t,e,r,n):t instanceof $i?function(o,a,c,u){if(!Qs(o.precondition,a))return c;const h=Vd(o.fieldTransforms,u,a),f=a.data;return f.setAll(Hf(o)),f.setAll(h),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),c===null?null:c.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(p=>p.field))}(t,e,r,n):function(o,a,c){return Qs(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(t,e,r)}function sS(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),o=Ff(n.transform,i||null);o!=null&&(r===null&&(r=Or.empty()),r.set(n.field,o))}return r||null}function Md(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&to(n,i,(o,a)=>nS(o,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ds extends Fa{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class $i extends Fa{constructor(e,r,n,i,o=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function Hf(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function Od(t,e,r){const n=new Map;$t(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let i=0;i<r.length;i++){const o=t[i],a=o.transform,c=e.data.field(o.field);n.set(o.field,rS(a,c,r[i]))}return n}function Vd(t,e,r){const n=new Map;for(const i of t){const o=i.transform,a=r.data.field(i.field);n.set(i.field,tS(o,a,e))}return n}class Wf extends Fa{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class aS extends Fa{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&oS(o,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Fo(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Fo(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=Vf();return this.mutations.forEach(i=>{const o=e.get(i.key),a=o.overlayedDocument;let c=this.applyToLocalView(a,o.mutatedFields);c=r.has(i.key)?null:c;const u=qf(a,c);u!==null&&n.set(i.key,u),a.isValidDocument()||a.convertToNoDocument(st.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),vt())}isEqual(e){return this.batchId===e.batchId&&to(this.mutations,e.mutations,(r,n)=>Md(r,n))&&to(this.baseMutations,e.baseMutations,(r,n)=>Md(r,n))}}class Bc{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){$t(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=function(){return Q_}();const o=e.mutations;for(let a=0;a<o.length;a++)i=i.insert(o[a].key,n[a].version);return new Bc(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cS{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uS{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var er,bt;function dS(t){switch(t){case Re.OK:return tt(64938);case Re.CANCELLED:case Re.UNKNOWN:case Re.DEADLINE_EXCEEDED:case Re.RESOURCE_EXHAUSTED:case Re.INTERNAL:case Re.UNAVAILABLE:case Re.UNAUTHENTICATED:return!1;case Re.INVALID_ARGUMENT:case Re.NOT_FOUND:case Re.ALREADY_EXISTS:case Re.PERMISSION_DENIED:case Re.FAILED_PRECONDITION:case Re.ABORTED:case Re.OUT_OF_RANGE:case Re.UNIMPLEMENTED:case Re.DATA_LOSS:return!0;default:return tt(15467,{code:t})}}function Gf(t){if(t===void 0)return En("GRPC error has no .code"),Re.UNKNOWN;switch(t){case er.OK:return Re.OK;case er.CANCELLED:return Re.CANCELLED;case er.UNKNOWN:return Re.UNKNOWN;case er.DEADLINE_EXCEEDED:return Re.DEADLINE_EXCEEDED;case er.RESOURCE_EXHAUSTED:return Re.RESOURCE_EXHAUSTED;case er.INTERNAL:return Re.INTERNAL;case er.UNAVAILABLE:return Re.UNAVAILABLE;case er.UNAUTHENTICATED:return Re.UNAUTHENTICATED;case er.INVALID_ARGUMENT:return Re.INVALID_ARGUMENT;case er.NOT_FOUND:return Re.NOT_FOUND;case er.ALREADY_EXISTS:return Re.ALREADY_EXISTS;case er.PERMISSION_DENIED:return Re.PERMISSION_DENIED;case er.FAILED_PRECONDITION:return Re.FAILED_PRECONDITION;case er.ABORTED:return Re.ABORTED;case er.OUT_OF_RANGE:return Re.OUT_OF_RANGE;case er.UNIMPLEMENTED:return Re.UNIMPLEMENTED;case er.DATA_LOSS:return Re.DATA_LOSS;default:return tt(39323,{code:t})}}(bt=er||(er={}))[bt.OK=0]="OK",bt[bt.CANCELLED=1]="CANCELLED",bt[bt.UNKNOWN=2]="UNKNOWN",bt[bt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",bt[bt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",bt[bt.NOT_FOUND=5]="NOT_FOUND",bt[bt.ALREADY_EXISTS=6]="ALREADY_EXISTS",bt[bt.PERMISSION_DENIED=7]="PERMISSION_DENIED",bt[bt.UNAUTHENTICATED=16]="UNAUTHENTICATED",bt[bt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",bt[bt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",bt[bt.ABORTED=10]="ABORTED",bt[bt.OUT_OF_RANGE=11]="OUT_OF_RANGE",bt[bt.UNIMPLEMENTED=12]="UNIMPLEMENTED",bt[bt.INTERNAL=13]="INTERNAL",bt[bt.UNAVAILABLE=14]="UNAVAILABLE",bt[bt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hS(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mS=new Yn([4294967295,4294967295],0);function Bd(t){const e=hS().encode(t),r=new cf;return r.update(e),new Uint8Array(r.digest())}function Fd(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Yn([r,n],0),new Yn([i,o],0)]}class Fc{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new $o(`Invalid padding: ${r}`);if(n<0)throw new $o(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new $o(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new $o(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Yn.fromNumber(this.ge)}ye(e,r,n){let i=e.add(r.multiply(Yn.fromNumber(n)));return i.compare(mS)===1&&(i=new Yn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=Bd(e),[n,i]=Fd(r);for(let o=0;o<this.hashCount;o++){const a=this.ye(n,i,o);if(!this.we(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new Fc(o,i,r);return n.forEach(c=>a.insert(c)),a}insert(e){if(this.ge===0)return;const r=Bd(e),[n,i]=Fd(r);for(let o=0;o<this.hashCount;o++){const a=this.ye(n,i,o);this.Se(a)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class $o extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e,r,n,i,o){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,hs.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Ua(st.min(),i,new Gt(pt),xn(),vt())}}class hs{constructor(e,r,n,i,o){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new hs(n,r,vt(),vt(),vt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js{constructor(e,r,n,i){this.be=e,this.removedTargetIds=r,this.key=n,this.De=i}}class Kf{constructor(e,r){this.targetId=e,this.Ce=r}}class Yf{constructor(e,r,n=gr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class Ud{constructor(){this.ve=0,this.Fe=jd(),this.Me=gr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=vt(),r=vt(),n=vt();return this.Fe.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:tt(38017,{changeType:o})}}),new hs(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=jd()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,$t(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class fS{constructor(e){this.Ge=e,this.ze=new Map,this.je=xn(),this.Je=Ts(),this.He=Ts(),this.Ye=new Gt(pt)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:tt(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,i)=>{this.rt(i)&&r(i)})}st(e){const r=e.targetId,n=e.Ce.count,i=this.ot(r);if(i){const o=i.target;if(Ql(o))if(n===0){const a=new Ze(o.path);this.et(r,a,Pr.newNoDocument(a,st.min()))}else $t(n===1,20013,{expectedCount:n});else{const a=this._t(r);if(a!==n){const c=this.ut(e),u=c?this.ct(c,e,a):1;if(u!==0){this.it(r);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,h)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:o=0}=r;let a,c;try{a=Zn(n).toUint8Array()}catch(u){if(u instanceof _f)return eo("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Fc(a,i,o)}catch(u){return eo(u instanceof $o?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let i=0;return n.forEach(o=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(c)||(this.et(r,o,null),i++)}),i}Tt(e){const r=new Map;this.ze.forEach((o,a)=>{const c=this.ot(a);if(c){if(o.current&&Ql(c.target)){const u=new Ze(c.target.path);this.It(u).has(a)||this.Et(a,u)||this.et(a,u,Pr.newNoDocument(u,e))}o.Be&&(r.set(a,o.ke()),o.qe())}});let n=vt();this.He.forEach((o,a)=>{let c=!0;a.forEachWhile(u=>{const h=this.ot(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(n=n.add(o))}),this.je.forEach((o,a)=>a.setReadTime(e));const i=new Ua(e,r,this.Ye,this.je,n);return this.je=xn(),this.Je=Ts(),this.He=Ts(),this.Ye=new Gt(pt),i}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,r)?i.Qe(r,1):i.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new Ud,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new or(pt),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new or(pt),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||ze("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Ud),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function Ts(){return new Gt(Ze.comparator)}function jd(){return new Gt(Ze.comparator)}const yS={asc:"ASCENDING",desc:"DESCENDING"},gS={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},pS={and:"AND",or:"OR"};class vS{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Xl(t,e){return t.useProto3Json||Na(e)?e:{value:e}}function Sa(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Qf(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function bS(t,e){return Sa(t,e.toTimestamp())}function sn(t){return $t(!!t,49232),st.fromTimestamp(function(r){const n=Xn(r);return new zt(n.seconds,n.nanos)}(t))}function Uc(t,e){return Zl(t,e).canonicalString()}function Zl(t,e){const r=function(i){return new Wt(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function Jf(t){const e=Wt.fromString(t);return $t(ry(e),10190,{key:e.toString()}),e}function ec(t,e){return Uc(t.databaseId,e.path)}function cl(t,e){const r=Jf(e);if(r.get(1)!==t.databaseId.projectId)throw new Je(Re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Je(Re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Ze(Zf(r))}function Xf(t,e){return Uc(t.databaseId,e)}function _S(t){const e=Jf(t);return e.length===4?Wt.emptyPath():Zf(e)}function tc(t){return new Wt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Zf(t){return $t(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function zd(t,e,r){return{name:ec(t,e),fields:r.value.mapValue.fields}}function SS(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:tt(39313,{state:h})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(h,f){return h.useProto3Json?($t(f===void 0||typeof f=="string",58123),gr.fromBase64String(f||"")):($t(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),gr.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(h){const f=h.code===void 0?Re.UNKNOWN:Gf(h.code);return new Je(f,h.message||"")}(a);r=new Yf(n,i,o,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=cl(t,n.document.name),o=sn(n.document.updateTime),a=n.document.createTime?sn(n.document.createTime):st.min(),c=new Or({mapValue:{fields:n.document.fields}}),u=Pr.newFoundDocument(i,o,a,c),h=n.targetIds||[],f=n.removedTargetIds||[];r=new Js(h,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=cl(t,n.document),o=n.readTime?sn(n.readTime):st.min(),a=Pr.newNoDocument(i,o),c=n.removedTargetIds||[];r=new Js([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=cl(t,n.document),o=n.removedTargetIds||[];r=new Js([],o,i,null)}else{if(!("filter"in e))return tt(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:o}=n,a=new uS(i,o),c=n.targetId;r=new Kf(c,a)}}return r}function PS(t,e){let r;if(e instanceof ds)r={update:zd(t,e.key,e.value)};else if(e instanceof Wf)r={delete:ec(t,e.key)};else if(e instanceof $i)r={update:zd(t,e.key,e.data),updateMask:kS(e.fieldMask)};else{if(!(e instanceof aS))return tt(16599,{Vt:e.type});r={verify:ec(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(o,a){const c=a.transform;if(c instanceof ba)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof es)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof ts)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof _a)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw tt(20930,{transform:a.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:bS(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:tt(27497)}(t,e.precondition)),r}function wS(t,e){return t&&t.length>0?($t(e!==void 0,14353),t.map(r=>function(i,o){let a=i.updateTime?sn(i.updateTime):sn(o);return a.isEqual(st.min())&&(a=sn(o)),new iS(a,i.transformResults||[])}(r,e))):[]}function CS(t,e){return{documents:[Xf(t,e.path)]}}function AS(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=Xf(t,i);const o=function(h){if(h.length!==0)return ty(dn.create(h,"and"))}(e.filters);o&&(r.structuredQuery.where=o);const a=function(h){if(h.length!==0)return h.map(f=>function(b){return{field:Hi(b.field),direction:xS(b.dir)}}(f))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const c=Xl(t,e.limit);return c!==null&&(r.structuredQuery.limit=c),e.startAt&&(r.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{ft:r,parent:i}}function IS(t){let e=_S(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){$t(n===1,65062);const f=r.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let o=[];r.where&&(o=function(p){const b=ey(p);return b instanceof dn&&$f(b)?b.getFilters():[b]}(r.where));let a=[];r.orderBy&&(a=function(p){return p.map(b=>function(D){return new va(Wi(D.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(D.direction))}(b))}(r.orderBy));let c=null;r.limit&&(c=function(p){let b;return b=typeof p=="object"?p.value:p,Na(b)?null:b}(r.limit));let u=null;r.startAt&&(u=function(p){const b=!!p.before,C=p.values||[];return new pa(C,b)}(r.startAt));let h=null;return r.endAt&&(h=function(p){const b=!p.before,C=p.values||[];return new pa(C,b)}(r.endAt)),q_(e,i,a,o,c,"F",u,h)}function ES(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return tt(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function ey(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Wi(r.unaryFilter.field);return ir.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Wi(r.unaryFilter.field);return ir.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Wi(r.unaryFilter.field);return ir.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Wi(r.unaryFilter.field);return ir.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return tt(61313);default:return tt(60726)}}(t):t.fieldFilter!==void 0?function(r){return ir.create(Wi(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return tt(58110);default:return tt(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return dn.create(r.compositeFilter.filters.map(n=>ey(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return tt(1026)}}(r.compositeFilter.op))}(t):tt(30097,{filter:t})}function xS(t){return yS[t]}function TS(t){return gS[t]}function $S(t){return pS[t]}function Hi(t){return{fieldPath:t.canonicalString()}}function Wi(t){return fr.fromServerFormat(t.fieldPath)}function ty(t){return t instanceof ir?function(r){if(r.op==="=="){if($d(r.value))return{unaryFilter:{field:Hi(r.field),op:"IS_NAN"}};if(Td(r.value))return{unaryFilter:{field:Hi(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if($d(r.value))return{unaryFilter:{field:Hi(r.field),op:"IS_NOT_NAN"}};if(Td(r.value))return{unaryFilter:{field:Hi(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Hi(r.field),op:TS(r.op),value:r.value}}}(t):t instanceof dn?function(r){const n=r.getFilters().map(i=>ty(i));return n.length===1?n[0]:{compositeFilter:{op:$S(r.op),filters:n}}}(t):tt(54877,{filter:t})}function kS(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function ry(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e,r,n,i,o=st.min(),a=st.min(),c=gr.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new jn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new jn(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new jn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new jn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RS{constructor(e){this.yt=e}}function DS(t){const e=IS({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Jl(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NS{constructor(){this.Cn=new LS}addToCollectionParentIndex(e,r){return this.Cn.add(r),$e.resolve()}getCollectionParents(e,r){return $e.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return $e.resolve()}deleteFieldIndex(e,r){return $e.resolve()}deleteAllFieldIndexes(e){return $e.resolve()}createTargetIndexes(e,r){return $e.resolve()}getDocumentsMatchingTarget(e,r){return $e.resolve(null)}getIndexType(e,r){return $e.resolve(0)}getFieldIndexes(e,r){return $e.resolve([])}getNextCollectionGroupToUpdate(e){return $e.resolve(null)}getMinOffset(e,r){return $e.resolve(Jn.min())}getMinOffsetFromCollectionGroup(e,r){return $e.resolve(Jn.min())}updateCollectionGroup(e,r,n){return $e.resolve()}updateIndexEntries(e,r){return $e.resolve()}}class LS{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new or(Wt.comparator),o=!i.has(n);return this.index[r]=i.add(n),o}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new or(Wt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qd={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},ny=41943040;class Tr{static withCacheSize(e){return new Tr(e,Tr.DEFAULT_COLLECTION_PERCENTILE,Tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Tr.DEFAULT_COLLECTION_PERCENTILE=10,Tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Tr.DEFAULT=new Tr(ny,Tr.DEFAULT_COLLECTION_PERCENTILE,Tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Tr.DISABLED=new Tr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class io{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new io(0)}static cr(){return new io(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hd="LruGarbageCollector",MS=1048576;function Wd([t,e],[r,n]){const i=pt(t,r);return i===0?pt(e,n):i}class OS{constructor(e){this.Ir=e,this.buffer=new or(Wd),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();Wd(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class VS{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ze(Hd,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){mo(r)?ze(Hd,"Ignoring IndexedDB error during garbage collection: ",r):await ho(r)}await this.Vr(3e5)})}}class BS{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return $e.resolve(Da.ce);const n=new OS(r);return this.mr.forEachTarget(e,i=>n.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>n.Ar(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(ze("LruGarbageCollector","Garbage collection skipped; disabled"),$e.resolve(qd)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(ze("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),qd):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,i,o,a,c,u,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(ze("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,a=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(n=p,c=Date.now(),this.removeTargets(e,n,r))).next(p=>(o=p,u=Date.now(),this.removeOrphanedDocuments(e,n))).next(p=>(h=Date.now(),zi()<=gt.DEBUG&&ze("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-f}ms
	Determined least recently used ${i} in `+(c-a)+`ms
	Removed ${o} targets in `+(u-c)+`ms
	Removed ${p} documents in `+(h-u)+`ms
Total Duration: ${h-f}ms`),$e.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:p})))}}function FS(t,e){return new BS(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class US{constructor(){this.changes=new Ti(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Pr.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?$e.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zS{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Fo(n.mutation,i,Gr.empty(),zt.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,vt()).next(()=>n))}getLocalViewOfDocuments(e,r,n=vt()){const i=vi();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(o=>{let a=To();return o.forEach((c,u)=>{a=a.insert(c,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=vi();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,vt()))}populateOverlays(e,r,n){const i=[];return n.forEach(o=>{r.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((a,c)=>{r.set(a,c)})})}computeViews(e,r,n,i){let o=xn();const a=Bo(),c=function(){return Bo()}();return r.forEach((u,h)=>{const f=n.get(h.key);i.has(h.key)&&(f===void 0||f.mutation instanceof $i)?o=o.insert(h.key,h):f!==void 0?(a.set(h.key,f.mutation.getFieldMask()),Fo(f.mutation,h,f.mutation.getFieldMask(),zt.now())):a.set(h.key,Gr.empty())}),this.recalculateAndSaveOverlays(e,o).next(u=>(u.forEach((h,f)=>a.set(h,f)),r.forEach((h,f)=>c.set(h,new jS(f,a.get(h)??null))),c))}recalculateAndSaveOverlays(e,r){const n=Bo();let i=new Gt((a,c)=>a-c),o=vt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const c of a)c.keys().forEach(u=>{const h=r.get(u);if(h===null)return;let f=n.get(u)||Gr.empty();f=c.applyToLocalView(h,f),n.set(u,f);const p=(i.get(c.batchId)||vt()).add(u);i=i.insert(c.batchId,p)})}).next(()=>{const a=[],c=i.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),h=u.key,f=u.value,p=Vf();f.forEach(b=>{if(!o.has(b)){const C=qf(r.get(b),n.get(b));C!==null&&p.set(b,C),o=o.add(b)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,p))}return $e.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return Ze.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):H_(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(o=>{const a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-o.size):$e.resolve(vi());let c=Qo,u=o;return a.next(h=>$e.forEach(h,(f,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),o.get(f)?$e.resolve():this.remoteDocumentCache.getEntry(e,f).next(b=>{u=u.insert(f,b)}))).next(()=>this.populateOverlays(e,h,o)).next(()=>this.computeViews(e,u,h,vt())).next(f=>({batchId:c,changes:Of(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Ze(r)).next(n=>{let i=To();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const o=r.collectionGroup;let a=To();return this.indexManager.getCollectionParents(e,o).next(c=>$e.forEach(c,u=>{const h=function(p,b){return new Ma(b,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(r,u.child(o));return this.getDocumentsMatchingCollectionQuery(e,h,n,i).next(f=>{f.forEach((p,b)=>{a=a.insert(p,b)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,o,i))).next(a=>{o.forEach((u,h)=>{const f=h.getKey();a.get(f)===null&&(a=a.insert(f,Pr.newInvalidDocument(f)))});let c=To();return a.forEach((u,h)=>{const f=o.get(u);f!==void 0&&Fo(f.mutation,h,Gr.empty(),zt.now()),Va(r,h)&&(c=c.insert(u,h))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qS{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return $e.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:sn(i.createTime)}}(r)),$e.resolve()}getNamedQuery(e,r){return $e.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(i){return{name:i.name,query:DS(i.bundledQuery),readTime:sn(i.readTime)}}(r)),$e.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HS{constructor(){this.overlays=new Gt(Ze.comparator),this.qr=new Map}getOverlay(e,r){return $e.resolve(this.overlays.get(r))}getOverlays(e,r){const n=vi();return $e.forEach(r,i=>this.getOverlay(e,i).next(o=>{o!==null&&n.set(i,o)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,o)=>{this.St(e,r,o)}),$e.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.qr.delete(n)),$e.resolve()}getOverlaysForCollection(e,r,n){const i=vi(),o=r.length+1,a=new Ze(r.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const u=c.getNext().value,h=u.getKey();if(!r.isPrefixOf(h.path))break;h.path.length===o&&u.largestBatchId>n&&i.set(u.getKey(),u)}return $e.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let o=new Gt((h,f)=>h-f);const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===r&&h.largestBatchId>n){let f=o.get(h.largestBatchId);f===null&&(f=vi(),o=o.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const c=vi(),u=o.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,f)=>c.set(h,f)),!(c.size()>=i)););return $e.resolve(c)}St(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new cS(r,n));let o=this.qr.get(r);o===void 0&&(o=vt(),this.qr.set(r,o)),this.qr.set(r,o.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WS{constructor(){this.sessionToken=gr.EMPTY_BYTE_STRING}getSessionToken(e){return $e.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,$e.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jc{constructor(){this.Qr=new or(cr.$r),this.Ur=new or(cr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new cr(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new cr(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new Ze(new Wt([])),n=new cr(r,e),i=new cr(r,e+1),o=[];return this.Ur.forEachInRange([n,i],a=>{this.Gr(a),o.push(a.key)}),o}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new Ze(new Wt([])),n=new cr(r,e),i=new cr(r,e+1);let o=vt();return this.Ur.forEachInRange([n,i],a=>{o=o.add(a.key)}),o}containsKey(e){const r=new cr(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class cr{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return Ze.comparator(e.key,r.key)||pt(e.Yr,r.Yr)}static Kr(e,r){return pt(e.Yr,r.Yr)||Ze.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new or(cr.$r)}checkEmpty(e){return $e.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new lS(o,r,n,i);this.mutationQueue.push(a);for(const c of i)this.Zr=this.Zr.add(new cr(c.key,o)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return $e.resolve(a)}lookupMutationBatch(e,r){return $e.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.ei(n),o=i<0?0:i;return $e.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return $e.resolve(this.mutationQueue.length===0?Rc:this.tr-1)}getAllMutationBatches(e){return $e.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new cr(r,0),i=new cr(r,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([n,i],a=>{const c=this.Xr(a.Yr);o.push(c)}),$e.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new or(pt);return r.forEach(i=>{const o=new cr(i,0),a=new cr(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,a],c=>{n=n.add(c.Yr)})}),$e.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let o=n;Ze.isDocumentKey(o)||(o=o.child(""));const a=new cr(new Ze(o),0);let c=new or(pt);return this.Zr.forEachWhile(u=>{const h=u.key.path;return!!n.isPrefixOf(h)&&(h.length===i&&(c=c.add(u.Yr)),!0)},a),$e.resolve(this.ti(c))}ti(e){const r=[];return e.forEach(n=>{const i=this.Xr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){$t(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return $e.forEach(r.mutations,i=>{const o=new cr(i.key,r.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new cr(r,0),i=this.Zr.firstAfterOrEqual(n);return $e.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,$e.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{constructor(e){this.ri=e,this.docs=function(){return new Gt(Ze.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),o=i?i.size:0,a=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return $e.resolve(n?n.document.mutableCopy():Pr.newInvalidDocument(r))}getEntries(e,r){let n=xn();return r.forEach(i=>{const o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():Pr.newInvalidDocument(i))}),$e.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let o=xn();const a=r.path,c=new Ze(a.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:h,value:{document:f}}=u.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||P_(S_(f),n)<=0||(i.has(f.key)||Va(r,f))&&(o=o.insert(f.key,f.mutableCopy()))}return $e.resolve(o)}getAllFromCollectionGroup(e,r,n,i){tt(9500)}ii(e,r){return $e.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new YS(this)}getSize(e){return $e.resolve(this.size)}}class YS extends US{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)}),$e.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(e){this.persistence=e,this.si=new Ti(r=>Lc(r),Mc),this.lastRemoteSnapshotVersion=st.min(),this.highestTargetId=0,this.oi=0,this._i=new jc,this.targetCount=0,this.ai=io.ur()}forEachTarget(e,r){return this.si.forEach((n,i)=>r(i)),$e.resolve()}getLastRemoteSnapshotVersion(e){return $e.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $e.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),$e.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),$e.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new io(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,$e.resolve()}updateTargetData(e,r){return this.Pr(r),$e.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,$e.resolve()}removeTargets(e,r,n){let i=0;const o=[];return this.si.forEach((a,c)=>{c.sequenceNumber<=r&&n.get(c.targetId)===null&&(this.si.delete(a),o.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),$e.waitFor(o).next(()=>i)}getTargetCount(e){return $e.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return $e.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),$e.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const i=this.persistence.referenceDelegate,o=[];return i&&r.forEach(a=>{o.push(i.markPotentiallyOrphaned(e,a))}),$e.waitFor(o)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),$e.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return $e.resolve(n)}containsKey(e,r){return $e.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iy{constructor(e,r){this.ui={},this.overlays={},this.ci=new Da(0),this.li=!1,this.li=!0,this.hi=new WS,this.referenceDelegate=e(this),this.Pi=new QS(this),this.indexManager=new NS,this.remoteDocumentCache=function(i){return new KS(i)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new RS(r),this.Ii=new qS(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new HS,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new GS(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){ze("MemoryPersistence","Starting transaction:",e);const i=new JS(this.ci.next());return this.referenceDelegate.Ei(),n(i).next(o=>this.referenceDelegate.di(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ai(e,r){return $e.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class JS extends C_{constructor(e){super(),this.currentSequenceNumber=e}}class zc{constructor(e){this.persistence=e,this.Ri=new jc,this.Vi=null}static mi(e){return new zc(e)}get fi(){if(this.Vi)return this.Vi;throw tt(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),$e.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),$e.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),$e.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(i=>this.fi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(o=>this.fi.add(o.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $e.forEach(this.fi,n=>{const i=Ze.fromPath(n);return this.gi(e,i).next(o=>{o||r.removeEntry(i,st.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return $e.or([()=>$e.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class Pa{constructor(e,r){this.persistence=e,this.pi=new Ti(n=>E_(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=FS(this,r)}static mi(e,r){return new Pa(e,r)}Ei(){}di(e){return $e.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return $e.forEach(this.pi,(n,i)=>this.br(e,n,i).next(o=>o?$e.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ii(e,a=>this.br(e,a,r).next(c=>{c||(n++,o.removeEntry(a,st.min()))})).next(()=>o.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),$e.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),$e.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),$e.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),$e.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=Ks(e.data.value)),r}br(e,r,n){return $e.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.pi.get(r);return $e.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=i}static As(e,r){let n=vt(),i=vt();for(const o of r.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new qc(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XS{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return Up()?8:A_(Cr())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,i){const o={result:null};return this.ys(e,r).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.ws(e,r,i,n).next(a=>{o.result=a})}).next(()=>{if(o.result)return;const a=new XS;return this.Ss(e,r,a).next(c=>{if(o.result=c,this.Vs)return this.bs(e,r,a,c.size)})}).next(()=>o.result)}bs(e,r,n,i){return n.documentReadCount<this.fs?(zi()<=gt.DEBUG&&ze("QueryEngine","SDK will not create cache indexes for query:",qi(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),$e.resolve()):(zi()<=gt.DEBUG&&ze("QueryEngine","Query:",qi(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(zi()<=gt.DEBUG&&ze("QueryEngine","The SDK decides to create cache indexes for query:",qi(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,on(r))):$e.resolve())}ys(e,r){if(Nd(r))return $e.resolve(null);let n=on(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=Jl(r,null,"F"),n=on(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(o=>{const a=vt(...o);return this.ps.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,n).next(u=>{const h=this.Ds(r,c);return this.Cs(r,h,a,u.readTime)?this.ys(e,Jl(r,null,"F")):this.vs(e,h,r,u)}))})))}ws(e,r,n,i){return Nd(r)||i.isEqual(st.min())?$e.resolve(null):this.ps.getDocuments(e,n).next(o=>{const a=this.Ds(r,o);return this.Cs(r,a,n,i)?$e.resolve(null):(zi()<=gt.DEBUG&&ze("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),qi(r)),this.vs(e,a,r,__(i,Qo)).next(c=>c))})}Ds(e,r){let n=new or(Lf(e));return r.forEach((i,o)=>{Va(e,o)&&(n=n.add(o))}),n}Cs(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const o=e.limitType==="F"?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Ss(e,r,n){return zi()<=gt.DEBUG&&ze("QueryEngine","Using full collection scan to execute query:",qi(r)),this.ps.getDocumentsMatchingQuery(e,r,Jn.min(),n)}vs(e,r,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next(o=>(r.forEach(a=>{o=o.insert(a.key,a)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hc="LocalStore",e1=3e8;class t1{constructor(e,r,n,i){this.persistence=e,this.Fs=r,this.serializer=i,this.Ms=new Gt(pt),this.xs=new Ti(o=>Lc(o),Mc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new zS(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function r1(t,e,r,n){return new t1(t,e,r,n)}async function oy(t,e){const r=lt(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(o=>(i=o,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(o=>{const a=[],c=[];let u=vt();for(const h of i){a.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}for(const h of o){c.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}return r.localDocuments.getDocuments(n,u).next(h=>({Ls:h,removedBatchIds:a,addedBatchIds:c}))})})}function n1(t,e){const r=lt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),o=r.Ns.newChangeBuffer({trackRemovals:!0});return function(c,u,h,f){const p=h.batch,b=p.keys();let C=$e.resolve();return b.forEach(D=>{C=C.next(()=>f.getEntry(u,D)).next(x=>{const E=h.docVersions.get(D);$t(E!==null,48541),x.version.compareTo(E)<0&&(p.applyToRemoteDocument(x,h),x.isValidDocument()&&(x.setReadTime(h.commitVersion),f.addEntry(x)))})}),C.next(()=>c.mutationQueue.removeMutationBatch(u,p))}(r,n,e,o).next(()=>o.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(c){let u=vt();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(u=u.add(c.batch.mutations[h].key));return u}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function sy(t){const e=lt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function i1(t,e){const r=lt(t),n=e.snapshotVersion;let i=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const a=r.Ns.newChangeBuffer({trackRemovals:!0});i=r.Ms;const c=[];e.targetChanges.forEach((f,p)=>{const b=i.get(p);if(!b)return;c.push(r.Pi.removeMatchingKeys(o,f.removedDocuments,p).next(()=>r.Pi.addMatchingKeys(o,f.addedDocuments,p)));let C=b.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(p)!==null?C=C.withResumeToken(gr.EMPTY_BYTE_STRING,st.min()).withLastLimboFreeSnapshotVersion(st.min()):f.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(f.resumeToken,n)),i=i.insert(p,C),function(x,E,T){return x.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=e1?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(b,C,f)&&c.push(r.Pi.updateTargetData(o,C))});let u=xn(),h=vt();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&c.push(r.persistence.referenceDelegate.updateLimboDocument(o,f))}),c.push(o1(o,a,e.documentUpdates).next(f=>{u=f.ks,h=f.qs})),!n.isEqual(st.min())){const f=r.Pi.getLastRemoteSnapshotVersion(o).next(p=>r.Pi.setTargetsMetadata(o,o.currentSequenceNumber,n));c.push(f)}return $e.waitFor(c).next(()=>a.apply(o)).next(()=>r.localDocuments.getLocalViewOfDocuments(o,u,h)).next(()=>u)}).then(o=>(r.Ms=i,o))}function o1(t,e,r){let n=vt(),i=vt();return r.forEach(o=>n=n.add(o)),e.getEntries(t,n).next(o=>{let a=xn();return r.forEach((c,u)=>{const h=o.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(st.min())?(e.removeEntry(c,u.readTime),a=a.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),a=a.insert(c,u)):ze(Hc,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)}),{ks:a,qs:i}})}function s1(t,e){const r=lt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Rc),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function a1(t,e){const r=lt(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Pi.getTargetData(n,e).next(o=>o?(i=o,$e.resolve(i)):r.Pi.allocateTargetId(n).next(a=>(i=new jn(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function rc(t,e,r){const n=lt(t),i=n.Ms.get(e),o=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",o,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!mo(a))throw a;ze(Hc,`Failed to update sequence numbers for target ${e}: ${a}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function Gd(t,e,r){const n=lt(t);let i=st.min(),o=vt();return n.persistence.runTransaction("Execute query","readwrite",a=>function(u,h,f){const p=lt(u),b=p.xs.get(f);return b!==void 0?$e.resolve(p.Ms.get(b)):p.Pi.getTargetData(h,f)}(n,a,on(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(a,c.targetId).next(u=>{o=u})}).next(()=>n.Fs.getDocumentsMatchingQuery(a,e,r?i:st.min(),r?o:vt())).next(c=>(l1(n,G_(e),c),{documents:c,Qs:o})))}function l1(t,e,r){let n=t.Os.get(e)||st.min();r.forEach((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)}),t.Os.set(e,n)}class Kd{constructor(){this.activeTargetIds=Z_()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class c1{constructor(){this.Mo=new Kd,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Kd,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u1{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yd="ConnectivityMonitor";class Qd{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ze(Yd,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ze(Yd,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $s=null;function nc(){return $s===null?$s=function(){return 268435456+Math.round(2147483648*Math.random())}():$s++,"0x"+$s.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ul="RestConnection",d1={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class h1{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===ya?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,r,n,i,o){const a=nc(),c=this.zo(e,r.toUriEncodedString());ze(ul,`Sending RPC '${e}' ${a}:`,c,n);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,o);const{host:h}=new URL(c),f=ao(h);return this.Jo(e,c,u,n,f).then(p=>(ze(ul,`Received RPC '${e}' ${a}: `,p),p),p=>{throw eo(ul,`RPC '${e}' ${a} failed with error: `,p,"url: ",c,"request:",n),p})}Ho(e,r,n,i,o,a){return this.Go(e,r,n,i,o)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+uo}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>e[o]=i),n&&n.headers.forEach((i,o)=>e[o]=i)}zo(e,r){const n=d1[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m1{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const br="WebChannelConnection";class f1 extends h1{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,i,o){const a=nc();return new Promise((c,u)=>{const h=new uf;h.setWithCredentials(!0),h.listenOnce(df.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Gs.NO_ERROR:const p=h.getResponseJson();ze(br,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(p)),c(p);break;case Gs.TIMEOUT:ze(br,`RPC '${e}' ${a} timed out`),u(new Je(Re.DEADLINE_EXCEEDED,"Request time out"));break;case Gs.HTTP_ERROR:const b=h.getStatus();if(ze(br,`RPC '${e}' ${a} failed with status:`,b,"response text:",h.getResponseText()),b>0){let C=h.getResponseJson();Array.isArray(C)&&(C=C[0]);const D=C?.error;if(D&&D.status&&D.message){const x=function(T){const H=T.toLowerCase().replace(/_/g,"-");return Object.values(Re).indexOf(H)>=0?H:Re.UNKNOWN}(D.status);u(new Je(x,D.message))}else u(new Je(Re.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new Je(Re.UNAVAILABLE,"Connection failed."));break;default:tt(9055,{l_:e,streamId:a,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{ze(br,`RPC '${e}' ${a} completed.`)}});const f=JSON.stringify(i);ze(br,`RPC '${e}' ${a} sending request:`,i),h.send(r,"POST",f,n,15)})}T_(e,r,n){const i=nc(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=ff(),c=mf(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,r,n),u.encodeInitMessageHeaders=!0;const f=o.join("");ze(br,`Creating RPC '${e}' stream ${i}: ${f}`,u);const p=a.createWebChannel(f,u);this.I_(p);let b=!1,C=!1;const D=new m1({Yo:E=>{C?ze(br,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(b||(ze(br,`Opening RPC '${e}' stream ${i} transport.`),p.open(),b=!0),ze(br,`RPC '${e}' stream ${i} sending:`,E),p.send(E))},Zo:()=>p.close()}),x=(E,T,H)=>{E.listen(T,te=>{try{H(te)}catch(Y){setTimeout(()=>{throw Y},0)}})};return x(p,xo.EventType.OPEN,()=>{C||(ze(br,`RPC '${e}' stream ${i} transport opened.`),D.o_())}),x(p,xo.EventType.CLOSE,()=>{C||(C=!0,ze(br,`RPC '${e}' stream ${i} transport closed`),D.a_(),this.E_(p))}),x(p,xo.EventType.ERROR,E=>{C||(C=!0,eo(br,`RPC '${e}' stream ${i} transport errored. Name:`,E.name,"Message:",E.message),D.a_(new Je(Re.UNAVAILABLE,"The operation could not be completed")))}),x(p,xo.EventType.MESSAGE,E=>{if(!C){const T=E.data[0];$t(!!T,16349);const H=T,te=H?.error||H[0]?.error;if(te){ze(br,`RPC '${e}' stream ${i} received error:`,te);const Y=te.status;let ue=function(_){const v=er[_];if(v!==void 0)return Gf(v)}(Y),oe=te.message;ue===void 0&&(ue=Re.INTERNAL,oe="Unknown error status: "+Y+" with message "+te.message),C=!0,D.a_(new Je(ue,oe)),p.close()}else ze(br,`RPC '${e}' stream ${i} received:`,T),D.u_(T)}}),x(c,hf.STAT_EVENT,E=>{E.stat===Hl.PROXY?ze(br,`RPC '${e}' stream ${i} detected buffering proxy`):E.stat===Hl.NOPROXY&&ze(br,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{D.__()},0),D}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function dl(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ja(t){return new vS(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay{constructor(e,r,n=1e3,i=1.5,o=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=i,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,r-n);i>0&&ze("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jd="PersistentStream";class ly{constructor(e,r,n,i,o,a,c,u){this.Mi=e,this.S_=n,this.b_=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new ay(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===Re.RESOURCE_EXHAUSTED?(En(r.toString()),En("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===Re.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.D_===r&&this.G_(n,i)},n=>{e(()=>{const i=new Je(Re.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{n(()=>this.z_(i))}),this.stream.onMessage(i=>{n(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ze(Jd,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(ze(Jd,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class y1 extends ly{constructor(e,r,n,i,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=o}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=SS(this.serializer,e),n=function(o){if(!("targetChange"in o))return st.min();const a=o.targetChange;return a.targetIds&&a.targetIds.length?st.min():a.readTime?sn(a.readTime):st.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=tc(this.serializer),r.addTarget=function(o,a){let c;const u=a.target;if(c=Ql(u)?{documents:CS(o,u)}:{query:AS(o,u).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=Qf(o,a.resumeToken);const h=Xl(o,a.expectedCount);h!==null&&(c.expectedCount=h)}else if(a.snapshotVersion.compareTo(st.min())>0){c.readTime=Sa(o,a.snapshotVersion.toTimestamp());const h=Xl(o,a.expectedCount);h!==null&&(c.expectedCount=h)}return c}(this.serializer,e);const n=ES(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=tc(this.serializer),r.removeTarget=e,this.q_(r)}}class g1 extends ly{constructor(e,r,n,i,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return $t(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,$t(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){$t(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=wS(e.writeResults,e.commitTime),n=sn(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=tc(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>PS(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p1{}class v1 extends p1{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Je(Re.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Go(e,Zl(r,n),i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Je(Re.UNKNOWN,o.toString())})}Ho(e,r,n,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Ho(e,Zl(r,n),i,a,c,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Je(Re.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class b1{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(En(r),this.aa=!1):ze("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ai="RemoteStore";class _1{constructor(e,r,n,i,o){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo(a=>{n.enqueueAndForget(async()=>{ki(this)&&(ze(Ai,"Restarting streams for network reachability change."),await async function(u){const h=lt(u);h.Ea.add(4),await ms(h),h.Ra.set("Unknown"),h.Ea.delete(4),await za(h)}(this))})}),this.Ra=new b1(n,i)}}async function za(t){if(ki(t))for(const e of t.da)await e(!0)}async function ms(t){for(const e of t.da)await e(!1)}function cy(t,e){const r=lt(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),Yc(r)?Kc(r):fo(r).O_()&&Gc(r,e))}function Wc(t,e){const r=lt(t),n=fo(r);r.Ia.delete(e),n.O_()&&uy(r,e),r.Ia.size===0&&(n.O_()?n.L_():ki(r)&&r.Ra.set("Unknown"))}function Gc(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(st.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}fo(t).Y_(e)}function uy(t,e){t.Va.Ue(e),fo(t).Z_(e)}function Kc(t){t.Va=new fS({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),fo(t).start(),t.Ra.ua()}function Yc(t){return ki(t)&&!fo(t).x_()&&t.Ia.size>0}function ki(t){return lt(t).Ea.size===0}function dy(t){t.Va=void 0}async function S1(t){t.Ra.set("Online")}async function P1(t){t.Ia.forEach((e,r)=>{Gc(t,e)})}async function w1(t,e){dy(t),Yc(t)?(t.Ra.ha(e),Kc(t)):t.Ra.set("Unknown")}async function C1(t,e,r){if(t.Ra.set("Online"),e instanceof Yf&&e.state===2&&e.cause)try{await async function(i,o){const a=o.cause;for(const c of o.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,a),i.Ia.delete(c),i.Va.removeTarget(c))}(t,e)}catch(n){ze(Ai,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await wa(t,n)}else if(e instanceof Js?t.Va.Ze(e):e instanceof Kf?t.Va.st(e):t.Va.tt(e),!r.isEqual(st.min()))try{const n=await sy(t.localStore);r.compareTo(n)>=0&&await function(o,a){const c=o.Va.Tt(a);return c.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const f=o.Ia.get(h);f&&o.Ia.set(h,f.withResumeToken(u.resumeToken,a))}}),c.targetMismatches.forEach((u,h)=>{const f=o.Ia.get(u);if(!f)return;o.Ia.set(u,f.withResumeToken(gr.EMPTY_BYTE_STRING,f.snapshotVersion)),uy(o,u);const p=new jn(f.target,u,h,f.sequenceNumber);Gc(o,p)}),o.remoteSyncer.applyRemoteEvent(c)}(t,r)}catch(n){ze(Ai,"Failed to raise snapshot:",n),await wa(t,n)}}async function wa(t,e,r){if(!mo(e))throw e;t.Ea.add(1),await ms(t),t.Ra.set("Offline"),r||(r=()=>sy(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ze(Ai,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await za(t)})}function hy(t,e){return e().catch(r=>wa(t,r,e))}async function qa(t){const e=lt(t),r=ti(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Rc;for(;A1(e);)try{const i=await s1(e.localStore,n);if(i===null){e.Ta.length===0&&r.L_();break}n=i.batchId,I1(e,i)}catch(i){await wa(e,i)}my(e)&&fy(e)}function A1(t){return ki(t)&&t.Ta.length<10}function I1(t,e){t.Ta.push(e);const r=ti(t);r.O_()&&r.X_&&r.ea(e.mutations)}function my(t){return ki(t)&&!ti(t).x_()&&t.Ta.length>0}function fy(t){ti(t).start()}async function E1(t){ti(t).ra()}async function x1(t){const e=ti(t);for(const r of t.Ta)e.ea(r.mutations)}async function T1(t,e,r){const n=t.Ta.shift(),i=Bc.from(n,e,r);await hy(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await qa(t)}async function $1(t,e){e&&ti(t).X_&&await async function(n,i){if(function(a){return dS(a)&&a!==Re.ABORTED}(i.code)){const o=n.Ta.shift();ti(n).B_(),await hy(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,i)),await qa(n)}}(t,e),my(t)&&fy(t)}async function Xd(t,e){const r=lt(t);r.asyncQueue.verifyOperationInProgress(),ze(Ai,"RemoteStore received new credentials");const n=ki(r);r.Ea.add(3),await ms(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await za(r)}async function k1(t,e){const r=lt(t);e?(r.Ea.delete(2),await za(r)):e||(r.Ea.add(2),await ms(r),r.Ra.set("Unknown"))}function fo(t){return t.ma||(t.ma=function(r,n,i){const o=lt(r);return o.sa(),new y1(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Xo:S1.bind(null,t),t_:P1.bind(null,t),r_:w1.bind(null,t),H_:C1.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Yc(t)?Kc(t):t.Ra.set("Unknown")):(await t.ma.stop(),dy(t))})),t.ma}function ti(t){return t.fa||(t.fa=function(r,n,i){const o=lt(r);return o.sa(),new g1(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:E1.bind(null,t),r_:$1.bind(null,t),ta:x1.bind(null,t),na:T1.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await qa(t)):(await t.fa.stop(),t.Ta.length>0&&(ze(Ai,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(e,r,n,i,o){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new Qn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,o){const a=Date.now()+n,c=new Qc(e,r,a,i,o);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Je(Re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Jc(t,e){if(En("AsyncQueue",`${e}: ${t}`),mo(t))return new Je(Re.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{static emptySet(e){return new Ji(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||Ze.comparator(r.key,n.key):(r,n)=>Ze.comparator(r.key,n.key),this.keyedMap=To(),this.sortedSet=new Gt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Ji)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Ji;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zd{constructor(){this.ga=new Gt(Ze.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):tt(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class oo{constructor(e,r,n,i,o,a,c,u,h){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,r,n,i,o){const a=[];return r.forEach(c=>{a.push({type:0,doc:c})}),new oo(e,r,Ji.emptySet(r),a,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Oa(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R1{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class D1{constructor(){this.queries=eh(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const i=lt(r),o=i.queries;i.queries=eh(),o.forEach((a,c)=>{for(const u of c.Sa)u.onError(n)})})(this,new Je(Re.ABORTED,"Firestore shutting down"))}}function eh(){return new Ti(t=>Nf(t),Oa)}async function N1(t,e){const r=lt(t);let n=3;const i=e.query;let o=r.queries.get(i);o?!o.ba()&&e.Da()&&(n=2):(o=new R1,n=e.Da()?0:1);try{switch(n){case 0:o.wa=await r.onListen(i,!0);break;case 1:o.wa=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const c=Jc(a,`Initialization of query '${qi(e.query)}' failed`);return void e.onError(c)}r.queries.set(i,o),o.Sa.push(e),e.va(r.onlineState),o.wa&&e.Fa(o.wa)&&Xc(r)}async function L1(t,e){const r=lt(t),n=e.query;let i=3;const o=r.queries.get(n);if(o){const a=o.Sa.indexOf(e);a>=0&&(o.Sa.splice(a,1),o.Sa.length===0?i=e.Da()?0:1:!o.ba()&&e.Da()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function M1(t,e){const r=lt(t);let n=!1;for(const i of e){const o=i.query,a=r.queries.get(o);if(a){for(const c of a.Sa)c.Fa(i)&&(n=!0);a.wa=i}}n&&Xc(r)}function O1(t,e,r){const n=lt(t),i=n.queries.get(e);if(i)for(const o of i.Sa)o.onError(r);n.queries.delete(e)}function Xc(t){t.Ca.forEach(e=>{e.next()})}var ic,th;(th=ic||(ic={})).Ma="default",th.Cache="cache";class V1{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new oo(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=oo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==ic.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yy{constructor(e){this.key=e}}class gy{constructor(e){this.key=e}}class B1{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=vt(),this.mutatedKeys=vt(),this.eu=Lf(e),this.tu=new Ji(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new Zd,i=r?r.tu:this.tu;let o=r?r.mutatedKeys:this.mutatedKeys,a=i,c=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,p)=>{const b=i.get(f),C=Va(this.query,p)?p:null,D=!!b&&this.mutatedKeys.has(b.key),x=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let E=!1;b&&C?b.data.isEqual(C.data)?D!==x&&(n.track({type:3,doc:C}),E=!0):this.su(b,C)||(n.track({type:2,doc:C}),E=!0,(u&&this.eu(C,u)>0||h&&this.eu(C,h)<0)&&(c=!0)):!b&&C?(n.track({type:0,doc:C}),E=!0):b&&!C&&(n.track({type:1,doc:b}),E=!0,(u||h)&&(c=!0)),E&&(C?(a=a.add(C),o=x?o.add(f):o.delete(f)):(a=a.delete(f),o=o.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),o=o.delete(f.key),n.track({type:1,doc:f})}return{tu:a,iu:n,Cs:c,mutatedKeys:o}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((f,p)=>function(C,D){const x=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return tt(20277,{Rt:E})}};return x(C)-x(D)}(f.type,p.type)||this.eu(f.doc,p.doc)),this.ou(n),i=i??!1;const c=r&&!i?this._u():[],u=this.Xa.size===0&&this.current&&!i?1:0,h=u!==this.Za;return this.Za=u,a.length!==0||h?{snapshot:new oo(this.query,e.tu,o,a,e.mutatedKeys,u===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Zd,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=vt(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new gy(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new yy(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=vt();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return oo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Zc="SyncEngine";class F1{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class U1{constructor(e){this.key=e,this.hu=!1}}class j1{constructor(e,r,n,i,o,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Ti(c=>Nf(c),Oa),this.Iu=new Map,this.Eu=new Set,this.du=new Gt(Ze.comparator),this.Au=new Map,this.Ru=new jc,this.Vu={},this.mu=new Map,this.fu=io.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function z1(t,e,r=!0){const n=Py(t);let i;const o=n.Tu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await py(n,e,r,!0),i}async function q1(t,e){const r=Py(t);await py(r,e,!0,!1)}async function py(t,e,r,n){const i=await a1(t.localStore,on(e)),o=i.targetId,a=t.sharedClientState.addLocalQueryTarget(o,r);let c;return n&&(c=await H1(t,e,o,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&cy(t.remoteStore,i),c}async function H1(t,e,r,n,i){t.pu=(p,b,C)=>async function(x,E,T,H){let te=E.view.ru(T);te.Cs&&(te=await Gd(x.localStore,E.query,!1).then(({documents:I})=>E.view.ru(I,te)));const Y=H&&H.targetChanges.get(E.targetId),ue=H&&H.targetMismatches.get(E.targetId)!=null,oe=E.view.applyChanges(te,x.isPrimaryClient,Y,ue);return nh(x,E.targetId,oe.au),oe.snapshot}(t,p,b,C);const o=await Gd(t.localStore,e,!0),a=new B1(e,o.Qs),c=a.ru(o.documents),u=hs.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),h=a.applyChanges(c,t.isPrimaryClient,u);nh(t,r,h.au);const f=new F1(e,r,a);return t.Tu.set(e,f),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),h.snapshot}async function W1(t,e,r){const n=lt(t),i=n.Tu.get(e),o=n.Iu.get(i.targetId);if(o.length>1)return n.Iu.set(i.targetId,o.filter(a=>!Oa(a,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await rc(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Wc(n.remoteStore,i.targetId),oc(n,i.targetId)}).catch(ho)):(oc(n,i.targetId),await rc(n.localStore,i.targetId,!0))}async function G1(t,e){const r=lt(t),n=r.Tu.get(e),i=r.Iu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Wc(r.remoteStore,n.targetId))}async function K1(t,e,r){const n=tP(t);try{const i=await function(a,c){const u=lt(a),h=zt.now(),f=c.reduce((C,D)=>C.add(D.key),vt());let p,b;return u.persistence.runTransaction("Locally write mutations","readwrite",C=>{let D=xn(),x=vt();return u.Ns.getEntries(C,f).next(E=>{D=E,D.forEach((T,H)=>{H.isValidDocument()||(x=x.add(T))})}).next(()=>u.localDocuments.getOverlayedDocuments(C,D)).next(E=>{p=E;const T=[];for(const H of c){const te=sS(H,p.get(H.key).overlayedDocument);te!=null&&T.push(new $i(H.key,te,Ef(te.value.mapValue),Cn.exists(!0)))}return u.mutationQueue.addMutationBatch(C,h,T,c)}).next(E=>{b=E;const T=E.applyToLocalDocumentSet(p,x);return u.documentOverlayCache.saveOverlays(C,E.batchId,T)})}).then(()=>({batchId:b.batchId,changes:Of(p)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,c,u){let h=a.Vu[a.currentUser.toKey()];h||(h=new Gt(pt)),h=h.insert(c,u),a.Vu[a.currentUser.toKey()]=h}(n,i.batchId,r),await fs(n,i.changes),await qa(n.remoteStore)}catch(i){const o=Jc(i,"Failed to persist write");r.reject(o)}}async function vy(t,e){const r=lt(t);try{const n=await i1(r.localStore,e);e.targetChanges.forEach((i,o)=>{const a=r.Au.get(o);a&&($t(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?$t(a.hu,14607):i.removedDocuments.size>0&&($t(a.hu,42227),a.hu=!1))}),await fs(r,n,e)}catch(n){await ho(n)}}function rh(t,e,r){const n=lt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Tu.forEach((o,a)=>{const c=a.view.va(e);c.snapshot&&i.push(c.snapshot)}),function(a,c){const u=lt(a);u.onlineState=c;let h=!1;u.queries.forEach((f,p)=>{for(const b of p.Sa)b.va(c)&&(h=!0)}),h&&Xc(u)}(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function Y1(t,e,r){const n=lt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Au.get(e),o=i&&i.key;if(o){let a=new Gt(Ze.comparator);a=a.insert(o,Pr.newNoDocument(o,st.min()));const c=vt().add(o),u=new Ua(st.min(),new Map,new Gt(pt),a,c);await vy(n,u),n.du=n.du.remove(o),n.Au.delete(e),eu(n)}else await rc(n.localStore,e,!1).then(()=>oc(n,e,r)).catch(ho)}async function Q1(t,e){const r=lt(t),n=e.batch.batchId;try{const i=await n1(r.localStore,e);_y(r,n,null),by(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await fs(r,i)}catch(i){await ho(i)}}async function J1(t,e,r){const n=lt(t);try{const i=await function(a,c){const u=lt(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let f;return u.mutationQueue.lookupMutationBatch(h,c).next(p=>($t(p!==null,37113),f=p.keys(),u.mutationQueue.removeMutationBatch(h,p))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,f,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f)).next(()=>u.localDocuments.getDocuments(h,f))})}(n.localStore,e);_y(n,e,r),by(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await fs(n,i)}catch(i){await ho(i)}}function by(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function _y(t,e,r){const n=lt(t);let i=n.Vu[n.currentUser.toKey()];if(i){const o=i.get(e);o&&(r?o.reject(r):o.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function oc(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||Sy(t,n)})}function Sy(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(Wc(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),eu(t))}function nh(t,e,r){for(const n of r)n instanceof yy?(t.Ru.addReference(n.key,e),X1(t,n)):n instanceof gy?(ze(Zc,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||Sy(t,n.key)):tt(19791,{wu:n})}function X1(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(ze(Zc,"New document in limbo: "+r),t.Eu.add(n),eu(t))}function eu(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new Ze(Wt.fromString(e)),n=t.fu.next();t.Au.set(n,new U1(r)),t.du=t.du.insert(r,n),cy(t.remoteStore,new jn(on(Oc(r.path)),n,"TargetPurposeLimboResolution",Da.ce))}}async function fs(t,e,r){const n=lt(t),i=[],o=[],a=[];n.Tu.isEmpty()||(n.Tu.forEach((c,u)=>{a.push(n.pu(u,e,r).then(h=>{if((h||r)&&n.isPrimaryClient){const f=h?!h.fromCache:r?.targetChanges.get(u.targetId)?.current;n.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(h){i.push(h);const f=qc.As(u.targetId,h);o.push(f)}}))}),await Promise.all(a),n.Pu.H_(i),await async function(u,h){const f=lt(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>$e.forEach(h,b=>$e.forEach(b.Es,C=>f.persistence.referenceDelegate.addReference(p,b.targetId,C)).next(()=>$e.forEach(b.ds,C=>f.persistence.referenceDelegate.removeReference(p,b.targetId,C)))))}catch(p){if(!mo(p))throw p;ze(Hc,"Failed to update sequence numbers: "+p)}for(const p of h){const b=p.targetId;if(!p.fromCache){const C=f.Ms.get(b),D=C.snapshotVersion,x=C.withLastLimboFreeSnapshotVersion(D);f.Ms=f.Ms.insert(b,x)}}}(n.localStore,o))}async function Z1(t,e){const r=lt(t);if(!r.currentUser.isEqual(e)){ze(Zc,"User change. New user:",e.toKey());const n=await oy(r.localStore,e);r.currentUser=e,function(o,a){o.mu.forEach(c=>{c.forEach(u=>{u.reject(new Je(Re.CANCELLED,a))})}),o.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await fs(r,n.Ls)}}function eP(t,e){const r=lt(t),n=r.Au.get(e);if(n&&n.hu)return vt().add(n.key);{let i=vt();const o=r.Iu.get(e);if(!o)return i;for(const a of o){const c=r.Tu.get(a);i=i.unionWith(c.view.nu)}return i}}function Py(t){const e=lt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=vy.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=eP.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Y1.bind(null,e),e.Pu.H_=M1.bind(null,e.eventManager),e.Pu.yu=O1.bind(null,e.eventManager),e}function tP(t){const e=lt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Q1.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=J1.bind(null,e),e}class Ca{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ja(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return r1(this.persistence,new ZS,e.initialUser,this.serializer)}Cu(e){return new iy(zc.mi,this.serializer)}Du(e){return new c1}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ca.provider={build:()=>new Ca};class rP extends Ca{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){$t(this.persistence.referenceDelegate instanceof Pa,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new VS(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?Tr.withCacheSize(this.cacheSizeBytes):Tr.DEFAULT;return new iy(n=>Pa.mi(n,r),this.serializer)}}class sc{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>rh(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=Z1.bind(null,this.syncEngine),await k1(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new D1}()}createDatastore(e){const r=ja(e.databaseInfo.databaseId),n=function(o){return new f1(o)}(e.databaseInfo);return function(o,a,c,u){return new v1(o,a,c,u)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,o,a,c){return new _1(n,i,o,a,c)}(this.localStore,this.datastore,e.asyncQueue,r=>rh(this.syncEngine,r,0),function(){return Qd.v()?new Qd:new u1}())}createSyncEngine(e,r){return function(i,o,a,c,u,h,f){const p=new j1(i,o,a,c,u,h);return f&&(p.gu=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await async function(r){const n=lt(r);ze(Ai,"RemoteStore shutting down."),n.Ea.add(5),await ms(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}sc.provider={build:()=>new sc};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nP{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):En("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ri="FirestoreClient";class iP{constructor(e,r,n,i,o){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Sr.UNAUTHENTICATED,this.clientId=$c.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,async a=>{ze(ri,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(ze(ri,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Qn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Jc(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function hl(t,e){t.asyncQueue.verifyOperationInProgress(),ze(ri,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await oy(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function ih(t,e){t.asyncQueue.verifyOperationInProgress();const r=await oP(t);ze(ri,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>Xd(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>Xd(e.remoteStore,i)),t._onlineComponents=e}async function oP(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ze(ri,"Using user provided OfflineComponentProvider");try{await hl(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===Re.FAILED_PRECONDITION||i.code===Re.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;eo("Error using user provided cache. Falling back to memory cache: "+r),await hl(t,new Ca)}}else ze(ri,"Using default OfflineComponentProvider"),await hl(t,new rP(void 0));return t._offlineComponents}async function wy(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ze(ri,"Using user provided OnlineComponentProvider"),await ih(t,t._uninitializedComponentsProvider._online)):(ze(ri,"Using default OnlineComponentProvider"),await ih(t,new sc))),t._onlineComponents}function sP(t){return wy(t).then(e=>e.syncEngine)}async function aP(t){const e=await wy(t),r=e.eventManager;return r.onListen=z1.bind(null,e.syncEngine),r.onUnlisten=W1.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=q1.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=G1.bind(null,e.syncEngine),r}function lP(t,e,r={}){const n=new Qn;return t.asyncQueue.enqueueAndForget(async()=>function(o,a,c,u,h){const f=new nP({next:b=>{f.Nu(),a.enqueueAndForget(()=>L1(o,p));const C=b.docs.has(c);!C&&b.fromCache?h.reject(new Je(Re.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&b.fromCache&&u&&u.source==="server"?h.reject(new Je(Re.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(b)},error:b=>h.reject(b)}),p=new V1(Oc(c.path),f,{includeMetadataChanges:!0,qa:!0});return N1(o,p)}(await aP(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cy(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oh=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ay="firestore.googleapis.com",sh=!0;class ah{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Je(Re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Ay,this.ssl=sh}else this.host=e.host,this.ssl=e.ssl??sh;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=ny;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<MS)throw new Je(Re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}b_("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Cy(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Je(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Je(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Je(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class tu{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ah({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Je(Re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Je(Re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ah(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new l_;switch(n.type){case"firstParty":return new h_(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Je(Re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=oh.get(r);n&&(ze("ComponentProvider","Removing Datastore"),oh.delete(r),n.terminate())}(this),Promise.resolve()}}function cP(t,e,r,n={}){t=Yo(t,tu);const i=ao(e),o=t._getSettings(),a={...o,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${r}`;i&&(_m(`https://${c}`),Sm("Firestore",!0)),o.host!==Ay&&o.host!==c&&eo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...o,host:c,ssl:i,emulatorOptions:n};if(!Si(u,a)&&(t._setSettings(u),n.mockUserToken)){let h,f;if(typeof n.mockUserToken=="string")h=n.mockUserToken,f=Sr.MOCK_USER;else{h=Rp(n.mockUserToken,t._app?.options.projectId);const p=n.mockUserToken.sub||n.mockUserToken.user_id;if(!p)throw new Je(Re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Sr(p)}t._authCredentials=new c_(new gf(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new ru(this.firestore,e,this._query)}}class ur{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new rs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ur(this.firestore,e,this._key)}toJSON(){return{type:ur._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(us(r,ur._jsonSchema))return new ur(e,n||null,new Ze(Wt.fromString(r.referencePath)))}}ur._jsonSchemaVersion="firestore/documentReference/1.0",ur._jsonSchema={type:tr("string",ur._jsonSchemaVersion),referencePath:tr("string")};class rs extends ru{constructor(e,r,n){super(e,r,Oc(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ur(this.firestore,null,new Ze(e))}withConverter(e){return new rs(this.firestore,e,this._path)}}function uP(t,e,...r){if(t=Ur(t),arguments.length===1&&(e=$c.newId()),v_("doc","path",e),t instanceof tu){const n=Wt.fromString(e,...r);return Sd(n),new ur(t,null,new Ze(n))}{if(!(t instanceof ur||t instanceof rs))throw new Je(Re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Wt.fromString(e,...r));return Sd(n),new ur(t.firestore,t instanceof rs?t.converter:null,new Ze(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lh="AsyncQueue";class ch{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new ay(this,"async_queue_retry"),this._c=()=>{const n=dl();n&&ze(lh,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=dl();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=dl();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new Qn;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!mo(e))throw e;ze(lh,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,En("INTERNAL UNHANDLED ERROR: ",uh(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const i=Qc.createAndSchedule(this,e,r,n,o=>this.hc(o));return this.tc.push(i),i}uc(){this.nc&&tt(47125,{Pc:uh(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function uh(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class nu extends tu{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new ch,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ch(e),this._firestoreClient=void 0,await e}}}function dP(t,e){const r=typeof t=="object"?t:Am(),n=typeof t=="string"?t:ya,i=vc(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const o=$p("firestore");o&&cP(i,...o)}return i}function Iy(t){if(t._terminated)throw new Je(Re.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||hP(t),t._firestoreClient}function hP(t){const e=t._freezeSettings(),r=function(i,o,a,c){return new $_(i,o,a,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,Cy(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)}(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new iP(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(i){const o=i?._online.build();return{_offline:i?._offline.build(o),_online:o}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Vr(gr.fromBase64String(e))}catch(r){throw new Je(Re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Vr(gr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Vr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(us(e,Vr._jsonSchema))return Vr.fromBase64String(e.bytes)}}Vr._jsonSchemaVersion="firestore/bytes/1.0",Vr._jsonSchema={type:tr("string",Vr._jsonSchemaVersion),bytes:tr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Je(Re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new fr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ey{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Je(Re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Je(Re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return pt(this._lat,e._lat)||pt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:an._jsonSchemaVersion}}static fromJSON(e){if(us(e,an._jsonSchema))return new an(e.latitude,e.longitude)}}an._jsonSchemaVersion="firestore/geoPoint/1.0",an._jsonSchema={type:tr("string",an._jsonSchemaVersion),latitude:tr("number"),longitude:tr("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==i[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ln._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(us(e,ln._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new ln(e.vectorValues);throw new Je(Re.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ln._jsonSchemaVersion="firestore/vectorValue/1.0",ln._jsonSchema={type:tr("string",ln._jsonSchemaVersion),vectorValues:tr("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mP=/^__.*__$/;class fP{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new $i(e,this.data,this.fieldMask,r,this.fieldTransforms):new ds(e,this.data,r,this.fieldTransforms)}}function xy(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw tt(40011,{Ac:t})}}class ou{constructor(e,r,n,i,o,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new ou({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Aa(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(xy(this.Ac)&&mP.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class yP{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||ja(e)}Cc(e,r,n,i=!1){return new ou({Ac:e,methodName:r,Dc:n,path:fr.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function gP(t){const e=t._freezeSettings(),r=ja(t._databaseId);return new yP(t._databaseId,!!e.ignoreUndefinedProperties,r)}function pP(t,e,r,n,i,o={}){const a=t.Cc(o.merge||o.mergeFields?2:0,e,r,i);Ry("Data must be an object, but it was:",a,n);const c=$y(n,a);let u,h;if(o.merge)u=new Gr(a.fieldMask),h=a.fieldTransforms;else if(o.mergeFields){const f=[];for(const p of o.mergeFields){const b=vP(e,p,r);if(!a.contains(b))throw new Je(Re.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);_P(f,b)||f.push(b)}u=new Gr(f),h=a.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,h=a.fieldTransforms;return new fP(new Or(c),u,h)}function Ty(t,e){if(ky(t=Ur(t)))return Ry("Unsupported field value:",e,t),$y(t,e);if(t instanceof Ey)return function(n,i){if(!xy(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,i){const o=[];let a=0;for(const c of n){let u=Ty(c,i.wc(a));u==null&&(u={nullValue:"NULL_VALUE"}),o.push(u),a++}return{arrayValue:{values:o}}}(t,e)}return function(n,i){if((n=Ur(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return eS(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=zt.fromDate(n);return{timestampValue:Sa(i.serializer,o)}}if(n instanceof zt){const o=new zt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Sa(i.serializer,o)}}if(n instanceof an)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Vr)return{bytesValue:Qf(i.serializer,n._byteString)};if(n instanceof ur){const o=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(o))throw i.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Uc(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof ln)return function(a,c){return{mapValue:{fields:{[Af]:{stringValue:If},[ga]:{arrayValue:{values:a.toArray().map(h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return Vc(c.serializer,h)})}}}}}}(n,i);throw i.Sc(`Unsupported field value: ${kc(n)}`)}(t,e)}function $y(t,e){const r={};return bf(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):xi(t,(n,i)=>{const o=Ty(i,e.mc(n));o!=null&&(r[n]=o)}),{mapValue:{fields:r}}}function ky(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof zt||t instanceof an||t instanceof Vr||t instanceof ur||t instanceof Ey||t instanceof ln)}function Ry(t,e,r){if(!ky(r)||!pf(r)){const n=kc(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function vP(t,e,r){if((e=Ur(e))instanceof iu)return e._internalPath;if(typeof e=="string")return Dy(t,e);throw Aa("Field path arguments must be of type string or ",t,!1,void 0,r)}const bP=new RegExp("[~\\*/\\[\\]]");function Dy(t,e,r){if(e.search(bP)>=0)throw Aa(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new iu(...e.split("."))._internalPath}catch{throw Aa(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Aa(t,e,r,n,i){const o=n&&!n.isEmpty(),a=i!==void 0;let c=`Function ${e}() called with invalid data`;r&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(o||a)&&(u+=" (found",o&&(u+=` in field ${n}`),a&&(u+=` in document ${i}`),u+=")"),new Je(Re.INVALID_ARGUMENT,c+t+u)}function _P(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{constructor(e,r,n,i,o){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new ur(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new SP(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Ly("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class SP extends Ny{data(){return super.data()}}function Ly(t,e){return typeof e=="string"?Dy(t,e):e instanceof iu?e._internalPath:e._delegate._internalPath}class PP{convertValue(e,r="none"){switch(ei(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Jt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Zn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw tt(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return xi(e,(i,o)=>{n[i]=this.convertValue(o,r)}),n}convertVectorValue(e){const r=e.fields?.[ga].arrayValue?.values?.map(n=>Jt(n.doubleValue));return new ln(r)}convertGeoPoint(e){return new an(Jt(e.latitude),Jt(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=La(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Jo(e));default:return null}}convertTimestamp(e){const r=Xn(e);return new zt(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Wt.fromString(e);$t(ry(n),9688,{name:e});const i=new Xo(n.get(1),n.get(3)),o=new Ze(n.popFirst(5));return i.isEqual(r)||En(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wP(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class ko{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class _i extends Ny{constructor(e,r,n,i,o,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Xs(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Ly("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Je(Re.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=_i._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}_i._jsonSchemaVersion="firestore/documentSnapshot/1.0",_i._jsonSchema={type:tr("string",_i._jsonSchemaVersion),bundleSource:tr("string","DocumentSnapshot"),bundleName:tr("string"),bundle:tr("string")};class Xs extends _i{data(e={}){return super.data(e)}}class Uo{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new ko(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Xs(this._firestore,this._userDataWriter,n.key,n,new ko(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Je(Re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(c=>{const u=new Xs(i._firestore,i._userDataWriter,c.doc.key,c.doc,new ko(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>o||c.type!==3).map(c=>{const u=new Xs(i._firestore,i._userDataWriter,c.doc.key,c.doc,new ko(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,f=-1;return c.type!==0&&(h=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),f=a.indexOf(c.doc.key)),{type:CP(c.type),doc:u,oldIndex:h,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Je(Re.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Uo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=$c.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(r.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function CP(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return tt(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AP(t){t=Yo(t,ur);const e=Yo(t.firestore,nu);return lP(Iy(e),t._key).then(r=>TP(e,t,r))}Uo._jsonSchemaVersion="firestore/querySnapshot/1.0",Uo._jsonSchema={type:tr("string",Uo._jsonSchemaVersion),bundleSource:tr("string","QuerySnapshot"),bundleName:tr("string"),bundle:tr("string")};class IP extends PP{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vr(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new ur(this.firestore,null,r)}}function EP(t,e,r){t=Yo(t,ur);const n=Yo(t.firestore,nu),i=wP(t.converter,e);return xP(n,[pP(gP(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,Cn.none())])}function xP(t,e){return function(n,i){const o=new Qn;return n.asyncQueue.enqueueAndForget(async()=>K1(await sP(n),i,o)),o.promise}(Iy(t),e)}function TP(t,e,r){const n=r.docs.get(e._key),i=new IP(t);return new _i(t,i,e._key,n,new ko(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){uo=i})(lo),Xi(new Pi("firestore",(n,{instanceIdentifier:i,options:o})=>{const a=n.getProvider("app").getImmediate(),c=new nu(new u_(n.getProvider("auth-internal")),new m_(a,n.getProvider("app-check-internal")),function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Je(Re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xo(h.options.projectId,f)}(a,i),a);return o={useFetchStreams:r,...o},c._setSettings(o),c},"PUBLIC").setMultipleInstances(!0)),Gn(pd,vd,e),Gn(pd,vd,"esm2020")})();let $P="eyAiYXBpS2V5IjogIkFJemFTeUJBbGN2WlRMMXRsQ05LRExENEJpTWJhR01iTnhCRjQtTSIsICAiYXV0aERvbWFpbiI6ICJocm0tMTEyOC5maXJlYmFzZWFwcC5jb20iLCAgImRhdGFiYXNlVVJMIjogImh0dHBzOi8vaHJtLTExMjguZmlyZWJhc2Vpby5jb20iLCAgInByb2plY3RJZCI6ICJocm0tMTEyOCIsICAic3RvcmFnZUJ1Y2tldCI6ICJocm0tMTEyOC5hcHBzcG90LmNvbSIsICAibWVzc2FnaW5nU2VuZGVySWQiOiAiMTA0OTI1MDU4NTI0NSIsICAiYXBwSWQiOiAiMToxMDQ5MjUwNTg1MjQ1OndlYjowZGFkMDAyMDI3MjM1MTRjY2M1Mjc0In0=";const My=Cm(JSON.parse(vp($P))),gi=i_(My),Ia=new rn,kP=dP(My);Ia.addScope("profile");Ia.addScope("email");class Ro extends Error{}Ro.prototype.name="InvalidTokenError";function RP(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function DP(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return RP(e)}catch{return atob(e)}}function NP(t,e){if(typeof t!="string")throw new Ro("Invalid token specified: must be a string");e||(e={});const r=e.header===!0?0:1,n=t.split(".")[r];if(typeof n!="string")throw new Ro(`Invalid token specified: missing part #${r+1}`);let i;try{i=DP(n)}catch(o){throw new Ro(`Invalid token specified: invalid base64 for part #${r+1} (${o.message})`)}try{return JSON.parse(i)}catch(o){throw new Ro(`Invalid token specified: invalid json for part #${r+1} (${o.message})`)}}const LP={clientId:"195275085181-8ccjpgp8v1g80qhnlk6v4lpgid7n81gr.apps.googleusercontent.com"},MP=t=>{const e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.onload=()=>{window.google&&window.google.accounts.id.initialize({client_id:LP.clientId,callback:r=>{t(r.credential)},auto_select:!1,cancel_on_tap_outside:!0})},document.head.appendChild(e)},OP=t=>NP(t),VP=()=>{window.google&&window.google.accounts.id.disableAutoSelect()},[BP,FP]=mm({}),UP=async()=>{const e=await zn({query:"qcm42351987"});if(e&&!e.error){let n=Object.assign({},{},e);FP(n)}return 1},jP=async t=>{let e=BP?.[992002];e&&(e.params={tkn:t},await zn(e))},[Bi,_r]=mm({user:null,loading:!0,error:null,authMethod:null}),[Oy,dh]=ye(null);Hb(gi,t=>{t?_r({user:t,loading:!1,error:null,authMethod:"firebase"}):Oy()||_r({user:null,loading:!1,error:null,authMethod:null})});_0(gi).then(t=>{t&&_r({user:t.user,loading:!1,error:null,authMethod:"firebase"})}).catch(t=>{console.error("Redirect sign-in error:",t),_r({loading:!1,error:t.message})});const qt={get state(){return Bi},async getUserProfile(t){try{const e=uP(kP,"users",t),r=await AP(e);if(r.exists())return _r("profile",r.data()),r.data();{let n=qt?.state?.user;return await EP(e,{uid:n?.uid,email:n?.email,displayName:n?.displayName,createdAt:new Date}),console.log("No such user profile!"),null}}catch(e){return console.error("Error fetching user profile:",e),null}},hasPermission:t=>{const e=qt.state?.profile;return e?e[t]===!0:!1},async signInWithGoogle(){try{_r("loading",!0),_r("error",null);try{const t=await h0(gi,Ia);_r({user:t.user,loading:!1,error:null,authMethod:"firebase"});try{qt.getUserProfile(t.user.uid)}catch(e){console.error("firestore error:",e)}}catch(t){if(t.code==="auth/popup-blocked")await v0(gi,Ia);else throw t}}catch(t){console.error("Sign-in error:",t),_r({loading:!1,error:t.message||"Failed to sign in with Google"})}},async signInWithGoogleP(t){const r=await zn({params:{id_token:t},query:"getGoogleUserbyToken"});if(r&&r){let n=new Date().getTime(),i=new Date(n+6e4*60*24*365),o="hrm_tkn_acc";document.cookie=`${o}=${r.data}; expires=${i}; path=/;g_state = {"i_l":1,"i_p":${i}}; ssgl_access_tkn = ${t}`,document.cookie=`ssgl_access_tkn = ${t}; expires=${i};`,await UP(),jP(r.data)}},async signInWithGoogleCloud(t){try{_r("loading",!0),_r("error",null);const e=OP(t),r={uid:e.sub,email:e.email,displayName:e.name,photoURL:e.picture};dh(r);const n={uid:r.uid,email:r.email,displayName:r.displayName,photoURL:r.photoURL,emailVerified:!0};_r({user:n,loading:!1,error:null,authMethod:"google-cloud"});try{const i=rn.credential(t);await jb(gi,i)}catch{console.log("Firebase sign-in optional, continuing with Google Cloud auth")}}catch(e){console.error("Google Cloud sign-in error:",e),_r({loading:!1,error:e.message||"Failed to sign in with Google Cloud"})}},async signOut(){try{_r("loading",!0),(Bi.authMethod==="firebase"||gi.currentUser)&&await Wb(gi),Bi.authMethod==="google-cloud"&&(VP(),dh(null)),_r({user:null,loading:!1,error:null,authMethod:null})}catch(t){console.error("Sign-out error:",t),_r({loading:!1,error:t.message||"Failed to sign out"})}},get isAuthenticated(){return!!Bi.user||!!Oy()},get currentUser(){return Bi.user},get authMethod(){return Bi.authMethod}};var zP=q("<p>"),qP=q('<div><div><div><h1>HRM Finance</h1><p>Complete Business Management Solution</p><div><div><button><svg width=24 height=24 viewBox="0 0 24 24"><path fill=#4285F4 d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"></path><path fill=#34A853 d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"></path><path fill=#FBBC05 d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"></path><path fill=#EA4335 d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"></path></svg></button><p>Firebase Authentication</p></div></div></div><div><div><div></div><h3>Financial Management</h3><p>Complete chart of accounts, balance sheets, journal entries, and invoice management in one place.</p></div><div><div></div><h3>HR Management</h3><p>Track employees, manage onboarding, and monitor your workforce with powerful analytics.</p></div><div><div></div><h3>Inventory Control</h3><p>Real-time inventory tracking, product management, and movement history across multiple locations.</p></div><div><div></div><h3>Banking Integration</h3><p>Streamline bank reconciliation with CSV imports and automated consolidation features.</p></div><div><div></div><h3>Real-time Analytics</h3><p>Get instant insights with dashboards showing revenue, cash flow, and business performance.</p></div><div><div></div><h3>Multi-language Support</h3><p>Available in multiple languages to support your global business operations.</p></div></div><div><p>Secure authentication powered by Google  Your data is encrypted and protected</p><p>Choose your preferred authentication method above');const HP=()=>{hn(()=>{MP(E=>{qt.signInWithGoogleP(E)}),setTimeout(()=>{},100)});const t={"min-height":"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},e={background:"white","border-radius":"1rem","box-shadow":"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","max-width":"1200px",width:"100%",overflow:"hidden"},r={padding:"3rem","text-align":"center","border-bottom":"1px solid #e2e8f0"},n={"font-size":"2.5rem","font-weight":"800",color:"#1a202c","margin-bottom":"1rem"},i={"font-size":"1.125rem",color:"#718096","margin-bottom":"2rem"},o={display:"flex","flex-direction":"column",gap:"1rem","align-items":"center","margin-bottom":"1rem"},a={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"2rem",padding:"3rem"},c={"text-align":"center",padding:"2rem","border-radius":"0.5rem",background:"#f7fafc",transition:"transform 0.2s",cursor:"default"},u={"font-size":"3rem","margin-bottom":"1rem"},h={"font-size":"1.25rem","font-weight":"600",color:"#2d3748","margin-bottom":"0.5rem"},f={color:"#718096","line-height":"1.6"},p={display:"inline-flex","align-items":"center",gap:"0.75rem",background:"white",color:"#4285f4",border:"2px solid #4285f4",padding:"0.75rem 2rem","font-size":"1.125rem","font-weight":"500","border-radius":"0.5rem",cursor:"pointer",transition:"all 0.2s","min-width":"250px","justify-content":"center"},b={color:"#e53e3e","margin-top":"1rem","font-size":"0.875rem"},C={background:"#f7fafc",padding:"2rem","text-align":"center",color:"#718096","font-size":"0.875rem"},D={"font-size":"0.75rem",color:"#718096","margin-top":"0.25rem","font-style":"italic"},x=()=>{qt.signInWithGoogle()};return(()=>{var E=qP(),T=E.firstChild,H=T.firstChild,te=H.firstChild,Y=te.nextSibling,ue=Y.nextSibling,oe=ue.firstChild,I=oe.firstChild;I.firstChild;var _=I.nextSibling,v=H.nextSibling,P=v.firstChild,w=P.firstChild,A=w.nextSibling,y=A.nextSibling,he=P.nextSibling,W=he.firstChild,$=W.nextSibling,Z=$.nextSibling,k=he.nextSibling,F=k.firstChild,V=F.nextSibling,z=V.nextSibling,me=k.nextSibling,K=me.firstChild,de=K.nextSibling,N=de.nextSibling,j=me.nextSibling,Q=j.firstChild,J=Q.nextSibling,ce=J.nextSibling,ae=j.nextSibling,M=ae.firstChild,ne=M.nextSibling,pe=ne.nextSibling,ve=v.nextSibling,ee=ve.firstChild,ie=ee.nextSibling;return d(E,t),d(T,e),d(H,r),d(te,n),d(Y,i),d(ue,o),I.addEventListener("mouseleave",R=>{R.currentTarget.style.background="white",R.currentTarget.style.color="#4285f4"}),I.addEventListener("mouseenter",R=>{R.currentTarget.style.background="#4285f4",R.currentTarget.style.color="white"}),I.$$click=x,d(I,p),s(I,S(Ue,{get when(){return qt.state.loading},fallback:"Sign in with Google",children:"Signing in..."}),null),d(_,D),s(H,S(Ue,{get when(){return qt.state.error},get children(){var R=zP();return d(R,b),s(R,()=>qt.state.error),R}}),null),d(v,a),d(ve,C),ie.style.setProperty("margin-top","0.5rem"),ie.style.setProperty("font-size","0.75rem"),re(R=>{var L=qt.state.loading,B=c,ge=u,le=h,U=f,G=c,Pe=u,_e=h,se=f,be=c,X=u,we=h,ke=f,xe=c,Te=u,Oe=h,We=f,je=c,Ie=u,Ve=h,He=f,qe=c,Ge=u,Ae=h,rt=f;return L!==R.e&&(I.disabled=R.e=L),R.t=d(P,B,R.t),R.a=d(w,ge,R.a),R.o=d(A,le,R.o),R.i=d(y,U,R.i),R.n=d(he,G,R.n),R.s=d(W,Pe,R.s),R.h=d($,_e,R.h),R.r=d(Z,se,R.r),R.d=d(k,be,R.d),R.l=d(F,X,R.l),R.u=d(V,we,R.u),R.c=d(z,ke,R.c),R.w=d(me,xe,R.w),R.m=d(K,Te,R.m),R.f=d(de,Oe,R.f),R.y=d(N,We,R.y),R.g=d(j,je,R.g),R.p=d(Q,Ie,R.p),R.b=d(J,Ve,R.b),R.T=d(ce,He,R.T),R.A=d(ae,qe,R.A),R.O=d(M,Ge,R.O),R.I=d(ne,Ae,R.I),R.S=d(pe,rt,R.S),R},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0}),E})()};At(["click"]);var WP=q("<div><div>");const GP=t=>{const e={"min-height":"100vh",display:"flex","align-items":"center","justify-content":"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},r={width:"50px",height:"50px",border:"3px solid rgba(255, 255, 255, 0.3)","border-top-color":"white","border-radius":"50%",animation:"spin 1s linear infinite"},n=document.createElement("style");return n.textContent=`
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  `,document.head.appendChild(n),Tn(()=>{qt.state?.user?.uid&&qt.getUserProfile(qt.state?.user?.uid)}),hn(()=>{}),S(Ue,{get when(){return!qt.state.loading},get fallback(){return(()=>{var i=WP(),o=i.firstChild;return d(i,e),d(o,r),i})()},get children(){return S(Ue,{get when(){return qt.isAuthenticated},get fallback(){return S(HP,{})},get children(){return t.children}})}})};var KP=q("<button>");const Ne=t=>{const e=()=>{const r={"font-family":"inherit",cursor:t.disabled?"not-allowed":"pointer",border:"none","border-radius":"var(--border-radius-sm)","font-weight":"500",transition:"all 0.2s ease","text-decoration":"none",display:"inline-flex","align-items":"center","justify-content":"center",gap:"0.5rem",opacity:t.disabled?"0.6":"1"},n={sm:{padding:"0.5rem 1rem","font-size":"0.875rem"},md:{padding:"0.75rem 1.5rem","font-size":"1rem"},lg:{padding:"1rem 2rem","font-size":"1.125rem"}},i={primary:{background:"linear-gradient(135deg, var(--primary-color), var(--primary-dark))",color:"white","box-shadow":"var(--shadow-sm)"},secondary:{background:"var(--surface-color)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},outline:{background:"transparent",color:"var(--primary-color)",border:"1px solid var(--primary-color)"}};return{...r,...n[t.size||"md"],...i[t.variant||"primary"]}};return(()=>{var r=KP();return Ii(r,"click",t.onClick,!0),s(r,()=>t.children),re(n=>{var i=e(),o=t.disabled,a=t.type||"button",c=`btn btn-${t.variant||"primary"} ${t.className||""}`;return n.e=d(r,i,n.e),o!==n.t&&(r.disabled=n.t=o),a!==n.a&&ut(r,"type",n.a=a),c!==n.o&&hc(r,n.o=c),n},{e:void 0,t:void 0,a:void 0,o:void 0}),r})()};At(["click"]);var YP=q("<div><div><div><h2></h2><button></button></div><div>");const dr=t=>{const e={position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","z-index":"1000"},r={background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)","max-width":"920px",width:"90%","max-height":"80vh",overflow:"auto",position:"relative"},n={padding:"1.5rem","border-bottom":"1px solid var(--border-color)",display:"flex","justify-content":"space-between","align-items":"center"},i={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},o={background:"none",border:"none","font-size":"1.5rem",cursor:"pointer",color:"var(--text-muted)",padding:"0.5rem","border-radius":"var(--border-radius-sm)"},a={padding:"1.5rem"},c=u=>{u.target===u.currentTarget&&t.onClose()};return S(Ue,{get when(){return t.isOpen},get children(){var u=YP(),h=u.firstChild,f=h.firstChild,p=f.firstChild,b=p.nextSibling,C=f.nextSibling;return u.$$click=c,d(f,n),d(p,i),s(p,()=>t.title),b.addEventListener("mouseleave",D=>D.target.style.background="none"),b.addEventListener("mouseenter",D=>D.target.style.background="var(--background-color)"),Ii(b,"click",t.onClose,!0),d(b,o),d(C,a),s(C,()=>t.children),re(D=>{var x=e,E=r;return D.e=d(u,x,D.e),D.t=d(h,E,D.t),D},{e:void 0,t:void 0}),u}})};At(["click"]);var hh=q("<div>"),QP=q("<h3>"),JP=q("<p>");const Xe=t=>{const e={background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"1.5rem","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",transition:"all 0.2s ease",cursor:t.onClick?"pointer":"default"},r={"margin-bottom":"1rem"},n={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0 0 0.5rem 0"},i={"font-size":"0.875rem",color:"var(--text-muted)",margin:"0"};return(()=>{var o=hh();return Ii(o,"click",t.onClick,!0),s(o,(()=>{var a=fe(()=>!!(t.title||t.subtitle));return()=>a()&&(()=>{var c=hh();return d(c,r),s(c,(()=>{var u=fe(()=>!!t.title);return()=>u()&&(()=>{var h=QP();return d(h,n),s(h,()=>t.title),h})()})(),null),s(c,(()=>{var u=fe(()=>!!t.subtitle);return()=>u()&&(()=>{var h=JP();return d(h,i),s(h,()=>t.subtitle),h})()})(),null),c})()})(),null),s(o,()=>t.children,null),re(a=>{var c=e,u=`card ${t.className||""}`;return a.e=d(o,c,a.e),u!==a.t&&hc(o,a.t=u),a},{e:void 0,t:void 0}),o})()};At(["click"]);var XP=q("<div><label></label><input>"),ZP=q("<span>*");const Ct=t=>{const e={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},r={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},n={"margin-bottom":"1rem"};return(()=>{var i=XP(),o=i.firstChild,a=o.nextSibling;return d(i,n),d(o,e),s(o,()=>t.label,null),s(o,(()=>{var c=fe(()=>!!t.required);return()=>c()&&(()=>{var u=ZP();return u.style.setProperty("color","var(--primary-color)"),u})()})(),null),a.addEventListener("blur",c=>c.target.style.borderColor="var(--border-color)"),a.addEventListener("focus",c=>c.target.style.borderColor="var(--primary-color)"),a.$$input=c=>t.onChange(c.target.value),d(a,r),re(c=>{var u=t.type||"text",h=t.placeholder,f=t.required,p=t.disabled;return u!==c.e&&ut(a,"type",c.e=u),h!==c.t&&ut(a,"placeholder",c.t=h),f!==c.a&&(a.required=c.a=f),p!==c.o&&(a.disabled=c.o=p),c},{e:void 0,t:void 0,a:void 0,o:void 0}),re(()=>a.value=t.value),i})()};At(["input"]);const ew={en:{common:{save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",close:"Close",search:"Search",filter:"Filter",reset:"Reset",back:"Back",next:"Next",previous:"Previous",yes:"Yes",no:"No",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",confirm:"Confirm",actions:"Actions",status:"Status",active:"Active",inactive:"Inactive",date:"Date",time:"Time",description:"Description",notes:"Notes",amount:"Amount",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Language",english:"English",spanish:"Spanish",noDataFound:"No data found",required:"Required",optional:"Optional",all:"All",none:"None",select:"Select",clear:"Clear",searching:"Searching...",refresh:"Refresh",showAll:"Show All",products:"products",filtered:"Filtered",view:"View",suggested:"Suggested",clearFilters:"Clear Filters",enhanced:"Enhanced",legacy:"Legacy",email:"Email",phone:"Phone",address:"Address",name:"Name",code:"Code",category:"Category",type:"Type",quantity:"Quantity",price:"Price",cost:"Cost",value:"Value",balance:"Balance",created:"Created",modified:"Modified",details:"Details",summary:"Summary",history:"History",new:"New",addNew:"Add New",unknown:"Unknown",notAvailable:"N/A",remove:"Remove",startDate:"Start Date",endDate:"End Date",from:"From",invoice:"Invoice",reference:"Reference",createdBy:"Created By",units:"units",invoiceDocumentId:"Invoice/Document ID",referenceNumber:"Reference Number",referenceNumberPlaceholder:"Enter reference number...",generalNotes:"General Notes",auto:"Auto",optionalNotes:"Optional notes...",showPerPage:"Show per page",first:"First",last:"Last",pageOfPages:"Page {{current}} of {{total}}",showingXofY:"Showing {{start}}-{{end}} of {{total}}",page:"Page",of:"of"},forms:{referenceNumberRequired:"Reference number is required",locationRequired:"Location is required",fromLocationRequired:"From location is required for transfers",atLeastOneProduct:"At least one product is required",itemProductRequired:"Product is required for item {{index}}",itemQuantityRequired:"Quantity must be greater than 0 for item {{index}}"},navigation:{dashboard:"Dashboard",accounts:"Chart of Accounts",balanceSheet:"Balance Sheet",inventory:"Inventory",employees:"Employees",entryBooks:"Entry Books",consolidate:"Bank Consolidation",reports:"Reports",settings:"Settings"},dashboard:{title:"Dashboard",welcome:"Welcome to HRM Finance",totalRevenue:"Total Revenue",overview:"Overview",recentActivity:"Recent Activity",quickActions:"Quick Actions",employeeCount:"Employee Count",pendingInvoices:"Pending Invoices",cashBalance:"Cash Balance",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalExpenses:"Total Expenses",netIncome:"Net Income",netLoss:"Net Loss",monthlyPayroll:"Monthly Payroll",current:"Current",newHires:"+3 new hires",outstanding:"Outstanding",totalOutstanding:"$23,450 total",lastUpdatedToday:"Last updated today",commonTasks:"Common tasks",generateReport:"Generate Report",latestUpdates:"Latest updates",invoicePaid:"Invoice #1234 paid",hoursAgo:"2 hours ago",newEmployeeOnboarded:"New employee onboarded",dayAgo:"1 day ago",monthlyReportGenerated:"Monthly report generated",daysAgo:"2 days ago"},accounts:{title:"Chart of Accounts",accountNumber:"Account Number",accountName:"Account Name",accountType:"Account Type",category:"Category",balance:"Balance",parentAccount:"Parent Account",subAccounts:"Sub-accounts",addAccount:"Add Account",editAccount:"Edit Account",deleteAccount:"Delete Account",accountDetails:"Account Details",transactions:"Transactions",accountHistory:"Account History",backToAccounts:"Back to Accounts",accountNotFound:"Account not found",accountInformation:"Account Information",accountPurpose:"Account purpose",transactionHistory:"Transaction History",noTransactions:"No transactions found for this account",createdDate:"Created Date",lastModified:"Last Modified",noDescription:"No description provided.",totalCount:"Total count",basicDetails:"Basic details",currentBalance:"Current balance",classification:"Classification",allTransactions:"All account transactions",reference:"Reference",allAccounts:"All Accounts",types:{asset:"Asset",liability:"Liability",equity:"Equity",revenue:"Revenue",expense:"Expense"},categories:{currentAssets:"Current Assets",fixedAssets:"Fixed Assets",currentLiabilities:"Current Liabilities",longTermLiabilities:"Long-term Liabilities",ownersEquity:"Owner's Equity",operatingRevenue:"Operating Revenue",operatingExpenses:"Operating Expenses"}},inventory:{title:"Inventory Management",overview:"Overview",products:"Products & Stock",movements:"Movements",locations:"Locations",bulkMovement:"Bulk Movement",addMovement:"Add Movement",addProduct:"Add Product",addLocation:"Add Location",singleMovement:"Add Single Movement",addNewItem:"Add New Item",activeProducts:"Active Products",lowStockAlert:"Low Stock Items",totalValue:"Total Stock Value",activeLocations:"Active Locations",productsNeedRestocking:"products need restocking",recentMovements:"Recent Movements",noProducts:"No products at this location",productName:"Product Name",productCode:"Product Code",sku:"SKU",unitOfMeasure:"Unit of Measure",unitCost:"Unit Cost",minStockLevel:"Min Stock Level",maxStockLevel:"Max Stock Level",locationName:"Location Name",locationType:"Location Type",locationCode:"Location Code",movementType:"Movement Type",referenceNumber:"Reference Number",invoiceNumber:"Invoice Number",fromLocation:"From Location",toLocation:"To Location",stockIn:"Stock In",stockOut:"Stock Out",transfer:"Transfer",adjustment:"Adjustment",inStock:"In Stock",lowStock:"Low Stock",outOfStock:"Out of Stock",stockLevels:"Stock Levels",stockByLocation:"Stock by Location",searchProducts:"Search products by name, SKU, or category...",searchProductsStock:"Search products and check stock levels...",searchResult:"Search Result",searchResults:"Search Results",searchFallback:"Showing local results",tryDifferentTerm:"Try a different search term or check spelling.",showingTopResults:"Showing top {{count}} results",searchLocations:"Search locations...",noMovements:"No movements found",productDetails:"Product Details",locationDetails:"Location Details",movementDetails:"Movement Details",totalProducts:"Total Products",totalLocations:"Total Locations",lastSeen:"Last seen",warehouseType:"Warehouse",storeType:"Store",supplierType:"Supplier",customerType:"Customer",currentlyManaged:"Currently managed",needAttention:"Need attention",currentWorth:"Current worth",warehousesStores:"Warehouses & stores",thisMonth:"This Month",latestActivities:"Latest inventory activities",searchMovements:"Search Movements",countingSheet:"Counting Sheet",physicalCount:"Physical Count",physicalInventoryCount:"Physical Inventory Count",setupPhysicalCount:"Setup Physical Inventory Count",setupDescription:"Configure your physical inventory count settings and begin the counting process.",countWillInclude:"This count will include {{count}} products from {{location}} in {{category}} category.",startCounting:"Start Physical Count",counted:"Counted",remaining:"Remaining",variances:"Variances",complete:"Complete",systemQty:"System Qty",variance:"Variance",addNotes:"Add notes...",reviewAndConfirm:"Review and Confirm Adjustments",reviewDescription:"Review the inventory adjustments below and confirm to update your system.",stockIncreases:"Stock Increases",stockDecreases:"Stock Decreases",totalAdjustments:"Total Adjustments",confirmAdjustments:"Confirm Adjustments",perfectCount:"Perfect Count!",noVariances:"No variances found. Your physical count matches the system exactly.",physicalCountAdjustment:"Physical count adjustment",inventoryCountingSheetTitle:"INVENTORY COUNTING SHEET",location:"Location",allCategories:"All Categories",countedBy:"Counted by",verifiedBy:"Verified by",instructions:"Instructions",countInstructions:["Count all items physically present at this location",'Write the actual count in the "Physical Count" column',"Leave blank if item is not found",'Note any discrepancies in the "Notes" column',"Sign and date when complete"],productName:"Product Name",unit:"Unit",totalProductsListed:"Total Products Listed",itemsCounted:"Items Counted",discrepanciesFound:"Discrepancies Found",counterSignature:"Counter Signature",supervisorSignature:"Supervisor Signature",downloadCSV:"Download CSV",noAdjustmentsToDownload:"No adjustments to download",stockIncrease:"Stock Increase",stockDecrease:"Stock Decrease",purchaseReceive:"Purchase/Receive",saleIssue:"Sale/Issue",transfer:"Transfer",adjustment:"Adjustment",movementType:"Movement Type",fromLocation:"From Location",toLocation:"To Location",searchSourceLocation:"Search source location...",searchDestinationLocation:"Search destination location...",searchLocation:"Search location...",addProduct:"Add Product",searchProduct:"Search product...",unitCost:"Unit Cost",noProductsAdded:'No products added yet. Click "Add Product" to get started.',createMovement:"Create Movement",generalNotesPlaceholder:"Enter general notes for this movement...",sortBy:"Sort By",allLocations:"All Locations",searchByProduct:"Search by product, location, reference, notes, invoice...",allProducts:"All Products",allTypes:"All Types",startDate:"Start Date",endDate:"End Date",totalMovements:"Total Movements",totalItems:"Total Items",adjustMovements:"Try adjusting your filters or check back later.",inventoryMovements:"Inventory Movements",createdBy:"Created By",view:"View",enhanced:"Enhanced",legacy:"Legacy",addSingleMovement:"Add Single Movement",inStockSubtitle:"In stock",itemsBelowThreshold:"Items below threshold",inventoryWorth:"Inventory worth",quantity:"Quantity",units:"units",normal:"Normal",productsAndStock:"Products & Stock",lowStockItems:"Low Stock Items",totalStockValue:"Total Stock Value",warehousesAndStores:"Warehouses & stores",andMore:"...and {count} more",latestInventoryActivities:"Latest inventory activities",min:"Min",max:"Max",cost:"Cost",noProductsFound:"No products found matching your search.",noProductsAvailable:"No products available.",noLocationsFound:"No locations found matching your search.",noLocationsAvailable:"No locations available.",searchPlaceholder:"Search by product, location, reference, notes, invoice...",noMovementsFound:"No movements found",tryAdjustingFilters:"Try adjusting your filters or check back later.",transfers:"Transfers",adjustments:"Adjustments",bulk:"Bulk",product:"Product",location:"Location",store:"Store",supplier:"Supplier",warehouse:"Warehouse",movement:"Movement",editMovement:"Edit Movement",updateMovement:"Update Movement",movementInformation:"Movement Information",locationInformation:"Location Information"},employees:{title:"Employee Management",employeeList:"Employee List",addEmployee:"Add Employee",editEmployee:"Edit Employee",employeeDetails:"Employee Details",personalInfo:"Personal Information",employmentInfo:"Employment Information",payrollInfo:"Payroll Information",firstName:"First Name",lastName:"Last Name",fullName:"Full Name",email:"Email",phone:"Phone",address:"Address",dateOfBirth:"Date of Birth",employeeId:"Employee ID",department:"Department",position:"Position",hireDate:"Hire Date",employmentStatus:"Employment Status",salary:"Salary",payFrequency:"Pay Frequency",taxId:"Tax ID",bankAccount:"Bank Account",emergencyContact:"Emergency Contact",activeEmployees:"Active Employees",inactiveEmployees:"Inactive Employees",totalPayroll:"Total Payroll",searchEmployees:"Search employees...",enterFullName:"Enter employee's full name",enterPosition:"Enter job position",enterEmail:"Enter email address",enterPhone:"Enter phone number",enterSalary:"Enter annual salary",departments:{engineering:"Engineering",product:"Product",design:"Design",marketing:"Marketing",sales:"Sales",humanResources:"Human Resources",finance:"Finance",operations:"Operations",analytics:"Analytics"}},entryBooks:{title:"Entry Books",bookName:"Book Name",bookType:"Book Type",createBook:"Create Book",editBook:"Edit Book",salesBook:"Sales Book",purchaseBook:"Purchase Book",cashBook:"Cash Book",generalBook:"General Book",entries:"Entries",addEntry:"Add Entry",period:"Period",startDate:"Start Date",endDate:"End Date",bookBalance:"Book Balance",reconciledBalance:"Reconciled Balance",difference:"Difference",reconcile:"Reconcile",isReconciled:"Is Reconciled",noBooks:"No entry books found",createFirst:"Create your first entry book to get started",bookDetails:"Book Details",entriesCount:"entries",bookOverview:"Book overview and details",bookEntries:"Book Entries",allEntries:"All entries in this book",noEntries:"No entries found",addFirst:"Add your first entry to this book",entryDate:"Entry Date",entryDescription:"Entry Description",entryAmount:"Entry Amount",entryReference:"Entry Reference",subtitle:"Manage accounting entries and general ledger records",viewReconciliation:"View Reconciliation",totalEntries:"Total Entries",allJournalEntries:"All journal entries",postedEntriesOnly:"Posted entries only",fromPostedEntries:"From {count} posted entries",needBankReconciliation:"Need bank reconciliation",allReconciled:"All reconciled",sortBy:"Sort By",fromDate:"From Date",toDate:"To Date",order:"Order",newest:"Newest",oldest:"Oldest",resetFilters:"Reset Filters",activeFilters:"Active filters",from:"From",to:"To",entriesFound:"{count} entries found",noJournalEntries:"No Journal Entries",startByCreating:"Start by creating your first entry",noEntriesMatch:"No journal entries match your current filters.",createFirstEntry:"Create First Entry",void:"Void",confirmVoid:"Are you sure you want to void this journal entry?",entryBookRecords:"Entry Book Records"},banking:{title:"Bank Consolidation",bankAccount:"Bank Account",statementDate:"Statement Date",beginningBalance:"Beginning Balance",endingBalance:"Ending Balance",deposits:"Deposits",withdrawals:"Withdrawals",bankCharges:"Bank Charges",interest:"Interest",reconcile:"Reconcile",matched:"Matched",unmatched:"Unmatched",importStatement:"Import Statement",manualEntry:"Manual Entry",autoMatch:"Auto Match",clearAll:"Clear All",reconciliationStatus:"Reconciliation Status",difference:"Difference",bookBalance:"Book Balance",statementBalance:"Statement Balance",outstandingChecks:"Outstanding Checks",depositsInTransit:"Deposits in Transit",reconciled:"Reconciled",notReconciled:"Not Reconciled",unreconciled:"Unreconciled",reconciliation:"Reconciliation",compareStatements:"Compare bank statements with entry book records",importCSV:"Import CSV",startNewReconciliation:"Start New Reconciliation",bankAccountInfo:"Bank Account Info",currentAccountDetails:"Current account details",lastReconciled:"Last reconciled",bankTransactions:"Bank Transactions",selectedPeriod:"Selected period",pending:"pending",bookEntriesForComparison:"Book entries for comparison",reconciliationRate:"Reconciliation Rate",completionStatus:"Completion status",recentReconciliationSessions:"Recent Reconciliation Sessions",latestActivity:"Latest activity",noRecentSessions:"No recent reconciliation sessions found.",startFirstReconciliation:"Start First Reconciliation",entryBookRecords:"Entry Book Records",pleaseUploadCSV:"Please upload a CSV file",csvRequiresHeaderAndData:"CSV file must have at least a header and one data row",successfullyParsed:"Successfully parsed {count} rows",errorParsingCSV:"Error parsing CSV file. Please check the format.",dateDescriptionRequired:"Date and Description columns are required",importedTransaction:"Imported transaction",successfullyImported:"Successfully imported {count} bank transactions",errorImportingTransactions:"Error importing transactions. Please check your data.",importBankStatementCSV:"Import Bank Statement CSV",dropCSVHere:"Drop CSV file here",clickToUploadCSV:"Click to upload or drag and drop CSV file",supportedFormat:"Supported format: CSV with Date, Description, and Amount columns",mapCSVColumns:"Map CSV Columns",dateColumn:"Date Column",selectColumn:"Select column...",descriptionColumn:"Description Column",referenceColumn:"Reference Column",amountDebitColumn:"Amount/Debit Column",creditColumn:"Credit Column",balanceColumn:"Balance Column",andMoreRows:"... and {count} more rows",importing:"Importing...",importTransactions:"Import {count} Transactions",reconciliationComparison:"Reconciliation Comparison",bankStatements:"Bank Statements",totalTransactions:"Total transactions",totalEntries:"Total entries",unreconciledBank:"Unreconciled Bank",unreconciledBooks:"Unreconciled Books",needAttention:"Need attention",unreconcile:"Unreconcile",clickToReconcile:"Click to reconcile",potentialMatchesFound:"Potential Matches Found",clickRecordToReconcile:"Click on a record below to reconcile",exactMatch:"Exact Match",possibleMatch:"Possible Match",selected:"Selected",clearSelection:"Clear Selection"},journal:{title:"Journal Entries",entryNumber:"Entry Number",entryDate:"Entry Date",debit:"Debit",credit:"Credit",account:"Account",memo:"Memo",reference:"Reference",createEntry:"Create Entry",editEntry:"Edit Entry",deleteEntry:"Delete Entry",posted:"Posted",draft:"Draft",reversed:"Reversed",recurringEntry:"Recurring Entry",attachments:"Attachments",totalDebits:"Total Debits",totalCredits:"Total Credits",outOfBalance:"Out of Balance",balanced:"Balanced",addEntry:"Add Journal Entry",allEntries:"All Entries",totalDebit:"Total Debit",totalCredit:"Total Credit",debitShort:"Dr.",creditShort:"Cr.",noReference:"No reference",createdBy:"By",totalAmount:"Total Amount",lines:"Lines",entryNotBalancedShort:"Entry is not balanced",accountLines:"Account Lines",noDescription:"No description",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryLines:"Journal Entry Lines",addLine:"Add Line",lineDescription:"Line description",notBalanced:"Not Balanced",updateEntry:"Update Entry",saveAsDraft:"Save as Draft",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",editEntryTooltip:"Edit this journal entry",post:"Post",entryMustBeBalanced:"Entry must be balanced to post",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",journalLines:"Journal Lines",balanceStatus:"Balance Status",unbalanced:"Unbalanced",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",postEntry:"Post Entry",fixBalance:"Fix Balance",voidEntry:"Void Entry",draftEntry:"Draft Entry",draftEntryDescription:"This entry can be edited and posted.",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",postedEntry:"Posted Entry",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",minTwoLinesRequired:"At least 2 line items are required",entryNotBalanced:"Entry is not balanced. Debit: ${debit}, Credit: ${credit}",lineAccountRequired:"Line {lineNumber}: Account is required",lineAmountRequired:"Line {lineNumber}: Either debit or credit amount must be provided",lineBothAmounts:"Line {lineNumber}: Cannot have both debit and credit amounts",enterEntryDescription:"Enter journal entry description",enterReferenceNumber:"Enter reference number"},forms:{requiredField:"This field is required",invalidEmail:"Invalid email address",invalidNumber:"Invalid number",invalidDate:"Invalid date",selectOption:"Please select an option",enterValue:"Please enter a value",confirmDelete:"Are you sure you want to delete this item?",unsavedChanges:"You have unsaved changes. Do you want to continue?",saveSuccess:"Saved successfully",saveError:"Error saving data",deleteSuccess:"Deleted successfully",deleteError:"Error deleting item",duplicateAccountNumber:"Account number already exists",descriptionRequired:"Description is required",errorOccurred:"An error occurred",errorPostingEntry:"An error occurred while posting the entry"},modals:{addInventory:"Add Inventory Movement",bulkMovement:"Bulk Inventory Movement",addProduct:"Add New Product",addLocation:"Add New Location",inventoryDetail:"Inventory Item Details",quickAdd:"Quick Add",selectProduct:"Select Product",selectLocation:"Select Location",enterQuantity:"Enter quantity",enterCost:"Enter unit cost",enterReference:"Enter reference number",addNotes:"Add notes (optional)",generalInformation:"General Information",stockInformation:"Stock Information",locationInformation:"Location Information",movementInformation:"Movement Information",addToInventory:"Add to Inventory",createProduct:"Create Product",createLocation:"Create Location",processing:"Processing...",addingMovement:"Adding movement...",creatingProduct:"Creating product...",creatingLocation:"Creating location..."},products:{title:"Products",addNew:"Add New Product",totalProducts:"Total Products",inCatalog:"In catalog",activeProducts:"Active Products",currentlyAvailable:"Currently available",outOfStock:"Out of Stock",needsRestock:"Needs restock",productCatalog:"Product Catalog",manageYourProducts:"Manage your products and pricing",inStock:"In Stock",furniture:"Furniture",electronics:"Electronics",supplies:"Supplies",lighting:"Lighting",searchPlaceholder:"Search products by name, SKU, or category...",allCategories:"All Categories",clearFilters:"Clear filters",noResults:"No products found matching your criteria.",noProducts:"No products available.",showing:"Showing",filtered:"Filtered results",allProducts:"All products",searchResult:"Search Result",stock:"Stock",lowStock:"Low Stock"},invoices:{title:"Invoices",createNew:"Create New Invoice",totalOutstanding:"Total Outstanding",unpaidInvoices:"Unpaid invoices",thisMonth:"This Month",revenueCollected:"Revenue collected",overdue:"Overdue",pastDueInvoices:"Past due invoices",recentInvoices:"Recent Invoices",latestBillingActivity:"Latest billing activity",paid:"Paid",pending:"Pending"},unauthorized:{title:"Access Restricted",accessDenied:"Access Denied",noPermission:"You don't have permission to access",thisFeature:"this feature",whySeeing:"Why am I seeing this?",explanation:"Your account doesn't have the necessary permissions to view this content.",requiredPermission:"Required permission:",goToDashboard:"Go to Dashboard",goBack:"Go Back",featuresCanAccess:"Features you can access:",dashboardAccess:"Dashboard and overview statistics",profileAccess:"Your profile and settings",roleBasedAccess:"Features enabled for your role",needAccess:"Need access? Contact your administrator or manager to request the appropriate permissions.",permissions:{accountAccess:"Account Management Access",inventoryAccess:"Inventory Access",employeeAccess:"HR Access",bankingAccess:"Banking Access",journalAccess:"Journal Entry Access",adminAccess:"Administrative Access",financialReporting:"Financial Reporting Access",invoiceManagement:"Invoice Management Access",productManagement:"Product Management Access"}}},es:{common:{save:"Guardar",cancel:"Cancelar",delete:"Eliminar",edit:"Editar",add:"Agregar",close:"Cerrar",search:"Buscar",filter:"Filtrar",reset:"Restablecer",back:"Atrs",next:"Siguiente",previous:"Anterior",yes:"S",no:"No",loading:"Cargando...",error:"Error",success:"xito",warning:"Advertencia",info:"Informacin",confirm:"Confirmar",actions:"Acciones",status:"Estado",active:"Activo",inactive:"Inactivo",date:"Fecha",time:"Hora",description:"Descripcin",notes:"Notas",amount:"Monto",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Idioma",english:"Ingls",spanish:"Espaol",noDataFound:"No se encontraron datos",required:"Requerido",optional:"Opcional",all:"Todos",none:"Ninguno",select:"Seleccionar",clear:"Limpiar",view:"Ver",suggested:"Sugerido",clearFilters:"Limpiar Filtros",enhanced:"Mejorado",legacy:"Clsico",email:"Correo Electrnico",phone:"Telfono",address:"Direccin",name:"Nombre",code:"Cdigo",category:"Categora",type:"Tipo",quantity:"Cantidad",price:"Precio",cost:"Costo",value:"Valor",balance:"Saldo",created:"Creado",modified:"Modificado",details:"Detalles",summary:"Resumen",history:"Historial",new:"Nuevo",addNew:"Agregar Nuevo",unknown:"Desconocido",notAvailable:"N/A",remove:"Remover",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",from:"De",invoice:"Factura",reference:"Referencia",createdBy:"Creado Por",units:"unidades",invoiceDocumentId:"ID de Factura/Documento",referenceNumber:"Nmero de Referencia",referenceNumberPlaceholder:"Ingrese nmero de referencia...",generalNotes:"Notas Generales",auto:"Auto",optionalNotes:"Notas opcionales...",showPerPage:"Mostrar por pgina",first:"Primera",last:"ltima",pageOfPages:"Pgina {{current}} de {{total}}",showingXofY:"Mostrando {{start}}-{{end}} de {{total}}",page:"Pgina",of:"de"},forms:{referenceNumberRequired:"El nmero de referencia es requerido",locationRequired:"La ubicacin es requerida",fromLocationRequired:"La ubicacin de origen es requerida para transferencias",atLeastOneProduct:"Al menos un producto es requerido",itemProductRequired:"El producto es requerido para el artculo {{index}}",itemQuantityRequired:"La cantidad debe ser mayor que 0 para el artculo {{index}}"},navigation:{dashboard:"Panel de Control",accounts:"Plan de Cuentas",balanceSheet:"Balance General",inventory:"Inventario",employees:"Empleados",entryBooks:"Libros de Entrada",consolidate:"Consolidacin Bancaria",reports:"Reportes",settings:"Configuracin"},dashboard:{title:"Panel de Control",welcome:"Bienvenido a HRM Finance",totalRevenue:"Ingresos Totales",overview:"Resumen",recentActivity:"Actividad Reciente",quickActions:"Acciones Rpidas",employeeCount:"Nmero de Empleados",pendingInvoices:"Facturas Pendientes",cashBalance:"Saldo en Efectivo",totalAssets:"Activos Totales",totalLiabilities:"Pasivos Totales",totalExpenses:"Gastos Totales",netIncome:"Ingreso Neto",netLoss:"Prdida Neta",monthlyPayroll:"Nmina Mensual",current:"Actual",newHires:"+3 nuevas contrataciones",outstanding:"Pendiente",totalOutstanding:"$23,450 total",lastUpdatedToday:"ltima actualizacin hoy",commonTasks:"Tareas comunes",generateReport:"Generar Reporte",latestUpdates:"ltimas actualizaciones",invoicePaid:"Factura #1234 pagada",hoursAgo:"hace 2 horas",newEmployeeOnboarded:"Nuevo empleado incorporado",dayAgo:"hace 1 da",monthlyReportGenerated:"Reporte mensual generado",daysAgo:"hace 2 das"},accounts:{title:"Plan de Cuentas",accountNumber:"Nmero de Cuenta",accountName:"Nombre de Cuenta",accountType:"Tipo de Cuenta",category:"Categora",balance:"Saldo",parentAccount:"Cuenta Padre",subAccounts:"Subcuentas",addAccount:"Agregar Cuenta",editAccount:"Editar Cuenta",deleteAccount:"Eliminar Cuenta",accountDetails:"Detalles de Cuenta",transactions:"Transacciones",accountHistory:"Historial de Cuenta",backToAccounts:"Volver a Cuentas",accountNotFound:"Cuenta no encontrada",accountInformation:"Informacin de Cuenta",accountPurpose:"Propsito de la cuenta",transactionHistory:"Historial de Transacciones",noTransactions:"No se encontraron transacciones para esta cuenta",createdDate:"Fecha de Creacin",lastModified:"ltima Modificacin",noDescription:"No se proporcion descripcin.",totalCount:"Conteo total",basicDetails:"Detalles bsicos",currentBalance:"Saldo actual",classification:"Clasificacin",allTransactions:"Todas las transacciones de la cuenta",reference:"Referencia",types:{asset:"Activo",liability:"Pasivo",equity:"Patrimonio",revenue:"Ingreso",expense:"Gasto"},categories:{currentAssets:"Activos Corrientes",fixedAssets:"Activos Fijos",currentLiabilities:"Pasivos Corrientes",longTermLiabilities:"Pasivos a Largo Plazo",ownersEquity:"Patrimonio del Propietario",operatingRevenue:"Ingresos Operacionales",operatingExpenses:"Gastos Operacionales"}},inventory:{title:"Gestin de Inventario",overview:"Resumen",products:"Productos y Stock",movements:"Movimientos",locations:"Ubicaciones",bulkMovement:"Movimiento Masivo",addMovement:"Agregar Movimiento",addProduct:"Agregar Producto",addLocation:"Agregar Ubicacin",singleMovement:"Agregar Movimiento Individual",addNewItem:"Agregar Nuevo Artculo",activeProducts:"Productos Activos",lowStockAlert:"Artculos con Stock Bajo",totalValue:"Valor Total del Stock",activeLocations:"Ubicaciones Activas",productsNeedRestocking:"productos necesitan reabastecimiento",recentMovements:"Movimientos Recientes",noProducts:"No hay productos en esta ubicacin",productName:"Nombre del Producto",productCode:"Cdigo del Producto",sku:"SKU",unitOfMeasure:"Unidad de Medida",unitCost:"Costo Unitario",minStockLevel:"Nivel Mnimo de Stock",maxStockLevel:"Nivel Mximo de Stock",locationName:"Nombre de Ubicacin",locationType:"Tipo de Ubicacin",locationCode:"Cdigo de Ubicacin",movementType:"Tipo de Movimiento",referenceNumber:"Nmero de Referencia",invoiceNumber:"Nmero de Factura",fromLocation:"Desde Ubicacin",toLocation:"Hacia Ubicacin",stockIn:"Entrada de Stock",stockOut:"Salida de Stock",transfer:"Transferencia",adjustment:"Ajuste",inStock:"En Stock",lowStock:"Stock Bajo",outOfStock:"Sin Stock",stockLevels:"Niveles de Stock",stockByLocation:"Stock por Ubicacin",searchProducts:"Buscar productos...",searchLocations:"Buscar ubicaciones...",noMovements:"No se encontraron movimientos",productDetails:"Detalles del Producto",locationDetails:"Detalles de Ubicacin",movementDetails:"Detalles del Movimiento",totalProducts:"Total de Productos",totalLocations:"Total de Ubicaciones",lastSeen:"Visto por ltima vez",warehouseType:"Almacn",storeType:"Tienda",supplierType:"Proveedor",customerType:"Cliente",currentlyManaged:"Gestionados actualmente",needAttention:"Necesitan atencin",currentWorth:"Valor actual",warehousesStores:"Almacenes y tiendas",thisMonth:"Este Mes",latestActivities:"ltimas actividades de inventario",searchMovements:"Buscar Movimientos",countingSheet:"Hoja de Conteo",physicalCount:"Conteo Fsico",physicalInventoryCount:"Conteo Fsico de Inventario",setupPhysicalCount:"Configurar Conteo Fsico de Inventario",setupDescription:"Configure los ajustes de su conteo fsico de inventario y comience el proceso de conteo.",countWillInclude:"Este conteo incluir {{count}} productos de {{location}} en la categora {{category}}.",startCounting:"Iniciar Conteo Fsico",counted:"Contado",remaining:"Restante",variances:"Variaciones",complete:"Completo",systemQty:"Cant. Sistema",variance:"Variacin",addNotes:"Agregar notas...",reviewAndConfirm:"Revisar y Confirmar Ajustes",reviewDescription:"Revise los ajustes de inventario a continuacin y confirme para actualizar su sistema.",stockIncreases:"Aumentos de Stock",stockDecreases:"Disminuciones de Stock",totalAdjustments:"Ajustes Totales",confirmAdjustments:"Confirmar Ajustes",adjustment:"Ajuste",perfectCount:"Conteo Perfecto!",noVariances:"No se encontraron variaciones. Su conteo fsico coincide exactamente con el sistema.",physicalCountAdjustment:"Ajuste de conteo fsico",inventoryCountingSheetTitle:"HOJA DE CONTEO DE INVENTARIO",location:"Ubicacin",allCategories:"Todas las Categoras",countedBy:"Contado por",verifiedBy:"Verificado por",instructions:"Instrucciones",countInstructions:["Contar todos los artculos fsicamente presentes en esta ubicacin",'Escribir el conteo real en la columna "Conteo Fsico"',"Dejar en blanco si el artculo no se encuentra",'Anotar cualquier discrepancia en la columna "Notas"',"Firmar y fechar cuando est completo"],productName:"Nombre del Producto",unit:"Unidad",totalProductsListed:"Total de Productos Listados",itemsCounted:"Artculos Contados",discrepanciesFound:"Discrepancias Encontradas",counterSignature:"Firma del Contador",supervisorSignature:"Firma del Supervisor",downloadCSV:"Descargar CSV",noAdjustmentsToDownload:"No hay ajustes para descargar",stockIncrease:"Aumento de Stock",stockDecrease:"Disminucin de Stock",purchaseReceive:"Compra/Recepcin",saleIssue:"Venta/Emisin",transfer:"Transferencia",adjustment:"Ajuste",movementType:"Tipo de Movimiento",fromLocation:"Ubicacin de Origen",toLocation:"Ubicacin de Destino",searchSourceLocation:"Buscar ubicacin de origen...",searchDestinationLocation:"Buscar ubicacin de destino...",searchLocation:"Buscar ubicacin...",addProduct:"Agregar Producto",searchProduct:"Buscar producto...",unitCost:"Costo Unitario",noProductsAdded:'No se han agregado productos an. Haga clic en "Agregar Producto" para comenzar.',createMovement:"Crear Movimiento",generalNotesPlaceholder:"Ingrese notas generales para este movimiento...",sortBy:"Ordenar Por",allLocations:"Todas las Ubicaciones",searchByProduct:"Buscar por producto, ubicacin, referencia, notas, factura...",allProducts:"Todos los Productos",allTypes:"Todos los Tipos",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",totalMovements:"Movimientos Totales",totalItems:"Artculos Totales",adjustMovements:"Intenta ajustar tus filtros o revisa ms tarde.",inventoryMovements:"Movimientos de Inventario",createdBy:"Creado Por",view:"Ver",enhanced:"Mejorado",legacy:"Clsico",addSingleMovement:"Agregar Movimiento Individual",inStockSubtitle:"En stock",itemsBelowThreshold:"Artculos bajo el umbral",inventoryWorth:"Valor del inventario",quantity:"Cantidad",units:"unidades",normal:"Normal",productsAndStock:"Productos y Stock",lowStockItems:"Artculos con Stock Bajo",totalStockValue:"Valor Total del Stock",warehousesAndStores:"Almacenes y tiendas",andMore:"...y {count} ms",latestInventoryActivities:"ltimas actividades de inventario",min:"Mn",max:"Mx",cost:"Costo",noProductsFound:"No se encontraron productos que coincidan con su bsqueda.",noProductsAvailable:"No hay productos disponibles.",noLocationsFound:"No se encontraron ubicaciones que coincidan con su bsqueda.",noLocationsAvailable:"No hay ubicaciones disponibles.",searchPlaceholder:"Buscar por producto, ubicacin, referencia, notas, factura...",noMovementsFound:"No se encontraron movimientos",tryAdjustingFilters:"Intenta ajustar tus filtros o revisa ms tarde.",transfers:"Transferencias",adjustments:"Ajustes",bulk:"Masivo",product:"Producto",location:"Ubicacin",store:"Tienda",supplier:"Proveedor",warehouse:"Almacn",movement:"Movimiento",editMovement:"Editar Movimiento",updateMovement:"Actualizar Movimiento",movementInformation:"Informacin del Movimiento",locationInformation:"Informacin de Ubicacin"},employees:{title:"Gestin de Empleados",employeeList:"Lista de Empleados",addEmployee:"Agregar Empleado",editEmployee:"Editar Empleado",employeeDetails:"Detalles del Empleado",personalInfo:"Informacin Personal",employmentInfo:"Informacin Laboral",payrollInfo:"Informacin de Nmina",firstName:"Nombre",lastName:"Apellido",fullName:"Nombre Completo",email:"Correo Electrnico",phone:"Telfono",address:"Direccin",dateOfBirth:"Fecha de Nacimiento",employeeId:"ID de Empleado",department:"Departamento",position:"Puesto",hireDate:"Fecha de Contratacin",employmentStatus:"Estado Laboral",salary:"Salario",payFrequency:"Frecuencia de Pago",taxId:"ID Fiscal",bankAccount:"Cuenta Bancaria",emergencyContact:"Contacto de Emergencia",activeEmployees:"Empleados Activos",inactiveEmployees:"Empleados Inactivos",totalPayroll:"Nmina Total",searchEmployees:"Buscar empleados...",enterFullName:"Ingrese el nombre completo del empleado",enterPosition:"Ingrese el puesto de trabajo",enterEmail:"Ingrese la direccin de correo electrnico",enterPhone:"Ingrese el nmero de telfono",enterSalary:"Ingrese el salario anual",departments:{engineering:"Ingeniera",product:"Producto",design:"Diseo",marketing:"Marketing",sales:"Ventas",humanResources:"Recursos Humanos",finance:"Finanzas",operations:"Operaciones",analytics:"Analtica"}},entryBooks:{title:"Libros de Entrada",bookName:"Nombre del Libro",bookType:"Tipo de Libro",createBook:"Crear Libro",editBook:"Editar Libro",salesBook:"Libro de Ventas",purchaseBook:"Libro de Compras",cashBook:"Libro de Caja",generalBook:"Libro General",entries:"Entradas",addEntry:"Agregar Entrada",period:"Perodo",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",bookBalance:"Saldo del Libro",reconciledBalance:"Saldo Conciliado",difference:"Diferencia",reconcile:"Conciliar",isReconciled:"Est Conciliado",noBooks:"No se encontraron libros de entrada",createFirst:"Crea tu primer libro de entrada para comenzar",bookDetails:"Detalles del Libro",entriesCount:"entradas",bookOverview:"Resumen y detalles del libro",bookEntries:"Entradas del Libro",allEntries:"Todas las entradas en este libro",noEntries:"No se encontraron entradas",addFirst:"Agrega tu primera entrada a este libro",entryDate:"Fecha de Entrada",entryDescription:"Descripcin de Entrada",entryAmount:"Monto de Entrada",entryReference:"Referencia de Entrada"},banking:{title:"Consolidacin Bancaria",bankAccount:"Cuenta Bancaria",statementDate:"Fecha del Estado",beginningBalance:"Saldo Inicial",endingBalance:"Saldo Final",deposits:"Depsitos",withdrawals:"Retiros",bankCharges:"Cargos Bancarios",interest:"Intereses",reconcile:"Conciliar",matched:"Conciliado",unmatched:"No Conciliado",importStatement:"Importar Estado",manualEntry:"Entrada Manual",autoMatch:"Coincidencia Automtica",clearAll:"Limpiar Todo",reconciliationStatus:"Estado de Conciliacin",difference:"Diferencia",bookBalance:"Saldo en Libros",statementBalance:"Saldo del Estado",outstandingChecks:"Cheques Pendientes",depositsInTransit:"Depsitos en Trnsito",reconciled:"Conciliado",notReconciled:"No Conciliado",unreconciled:"No Conciliado",reconciliation:"Conciliacin",compareStatements:"Comparar estados bancarios con registros de libros de entrada",importCSV:"Importar CSV",startNewReconciliation:"Iniciar Nueva Conciliacin",bankAccountInfo:"Informacin de Cuenta Bancaria",currentAccountDetails:"Detalles de cuenta actual",lastReconciled:"ltima conciliacin",bankTransactions:"Transacciones Bancarias",selectedPeriod:"Perodo seleccionado",pending:"pendiente",bookEntriesForComparison:"Entradas de libros para comparacin",reconciliationRate:"Tasa de Conciliacin",completionStatus:"Estado de finalizacin",recentReconciliationSessions:"Sesiones de Conciliacin Recientes",latestActivity:"Actividad reciente",noRecentSessions:"No se encontraron sesiones de conciliacin recientes.",startFirstReconciliation:"Iniciar Primera Conciliacin",entryBookRecords:"Registros de Libros de Entrada",pleaseUploadCSV:"Por favor suba un archivo CSV",csvRequiresHeaderAndData:"El archivo CSV debe tener al menos un encabezado y una fila de datos",successfullyParsed:"Se analizaron exitosamente {count} filas",errorParsingCSV:"Error al analizar el archivo CSV. Verifique el formato.",dateDescriptionRequired:"Las columnas de Fecha y Descripcin son requeridas",importedTransaction:"Transaccin importada",successfullyImported:"Se importaron exitosamente {count} transacciones bancarias",errorImportingTransactions:"Error al importar transacciones. Verifique sus datos.",importBankStatementCSV:"Importar CSV de Estado Bancario",dropCSVHere:"Suelte el archivo CSV aqu",clickToUploadCSV:"Haga clic para cargar o arrastre y suelte el archivo CSV",supportedFormat:"Formato soportado: CSV con columnas de Fecha, Descripcin y Monto",mapCSVColumns:"Mapear Columnas CSV",dateColumn:"Columna de Fecha",selectColumn:"Seleccionar columna...",descriptionColumn:"Columna de Descripcin",referenceColumn:"Columna de Referencia",amountDebitColumn:"Columna de Monto/Dbito",creditColumn:"Columna de Crdito",balanceColumn:"Columna de Saldo",andMoreRows:"... y {count} filas ms",importing:"Importando...",importTransactions:"Importar {count} Transacciones",reconciliationComparison:"Comparacin de Conciliacin",bankStatements:"Estados Bancarios",totalTransactions:"Transacciones totales",totalEntries:"Entradas totales",unreconciledBank:"Banco No Conciliado",unreconciledBooks:"Libros No Conciliados",needAttention:"Necesitan atencin",unreconcile:"Desconciliar",clickToReconcile:"Hacer clic para conciliar",potentialMatchesFound:"Coincidencias Potenciales Encontradas",clickRecordToReconcile:"Haga clic en un registro a continuacin para conciliar",exactMatch:"Coincidencia Exacta",possibleMatch:"Posible Coincidencia",selected:"Seleccionado",clearSelection:"Limpiar Seleccin"},journal:{title:"Asientos Contables",entryNumber:"Nmero de Asiento",entryDate:"Fecha del Asiento",debit:"Dbito",credit:"Crdito",account:"Cuenta",memo:"Memo",reference:"Referencia",createEntry:"Crear Asiento",editEntry:"Editar Asiento",deleteEntry:"Eliminar Asiento",posted:"Registrado",draft:"Borrador",reversed:"Revertido",recurringEntry:"Asiento Recurrente",attachments:"Adjuntos",totalDebits:"Dbitos Totales",totalCredits:"Crditos Totales",outOfBalance:"Desbalanceado",balanced:"Balanceado"},forms:{requiredField:"Este campo es requerido",invalidEmail:"Direccin de correo invlida",invalidNumber:"Nmero invlido",invalidDate:"Fecha invlida",selectOption:"Por favor seleccione una opcin",enterValue:"Por favor ingrese un valor",confirmDelete:"Est seguro de que desea eliminar este elemento?",unsavedChanges:"Tiene cambios sin guardar. Desea continuar?",saveSuccess:"Guardado exitosamente",saveError:"Error al guardar datos",deleteSuccess:"Eliminado exitosamente",deleteError:"Error al eliminar elemento",duplicateAccountNumber:"El nmero de cuenta ya existe"},modals:{addInventory:"Agregar Movimiento de Inventario",bulkMovement:"Movimiento Masivo de Inventario",addProduct:"Agregar Nuevo Producto",addLocation:"Agregar Nueva Ubicacin",inventoryDetail:"Detalles del Artculo de Inventario",quickAdd:"Agregar Rpido",selectProduct:"Seleccionar Producto",selectLocation:"Seleccionar Ubicacin",enterQuantity:"Ingresar cantidad",enterCost:"Ingresar costo unitario",enterReference:"Ingresar nmero de referencia",addNotes:"Agregar notas (opcional)",generalInformation:"Informacin General",stockInformation:"Informacin de Stock",locationInformation:"Informacin de Ubicacin",movementInformation:"Informacin de Movimiento",addToInventory:"Agregar al Inventario",createProduct:"Crear Producto",createLocation:"Crear Ubicacin",processing:"Procesando...",addingMovement:"Agregando movimiento...",creatingProduct:"Creando producto...",creatingLocation:"Creando ubicacin..."},products:{title:"Productos",addNew:"Agregar Nuevo Producto",totalProducts:"Total de Productos",inCatalog:"En catlogo",activeProducts:"Productos Activos",currentlyAvailable:"Actualmente disponibles",outOfStock:"Sin Stock",needsRestock:"Necesita reabastecimiento",productCatalog:"Catlogo de Productos",manageYourProducts:"Gestiona tus productos y precios",inStock:"En Stock",furniture:"Muebles",electronics:"Electrnicos",supplies:"Suministros",lighting:"Iluminacin"},invoices:{title:"Facturas",createNew:"Crear Nueva Factura",totalOutstanding:"Total Pendiente",unpaidInvoices:"Facturas no pagadas",thisMonth:"Este Mes",revenueCollected:"Ingresos recaudados",overdue:"Vencidas",pastDueInvoices:"Facturas vencidas",recentInvoices:"Facturas Recientes",latestBillingActivity:"Actividad de facturacin reciente",paid:"Pagado",pending:"Pendiente"},unauthorized:{title:"Acceso Restringido",accessDenied:"Acceso Denegado",noPermission:"No tienes permisos para acceder a",thisFeature:"esta funcionalidad",whySeeing:"Por qu veo esto?",explanation:"Tu cuenta no tiene los permisos necesarios para ver este contenido.",requiredPermission:"Permiso requerido:",goToDashboard:"Ir al Panel de Control",goBack:"Regresar",featuresCanAccess:"Funcionalidades a las que puedes acceder:",dashboardAccess:"Panel de control y estadsticas generales",profileAccess:"Tu perfil y configuraciones",roleBasedAccess:"Funcionalidades habilitadas para tu rol",needAccess:"Necesitas acceso? Contacta a tu administrador o gerente para solicitar los permisos apropiados.",permissions:{accountAccess:"Acceso a Gestin de Cuentas",inventoryAccess:"Acceso a Inventario",employeeAccess:"Acceso a Recursos Humanos",bankingAccess:"Acceso Bancario",journalAccess:"Acceso a Asientos Contables",adminAccess:"Acceso Administrativo",financialReporting:"Acceso a Reportes Financieros",invoiceManagement:"Acceso a Gestin de Facturas",productManagement:"Acceso a Gestin de Productos"}}}},tw=()=>{if(typeof window<"u"){const t=localStorage.getItem("hrmfinance-language");if(t&&["en","es"].includes(t))return t}return"en"},[mh,rw]=ye(tw()),at=()=>({t:(n,i,o)=>{const a=mh(),c=n.split(".");let u=ew[a];for(const f of c)if(u&&typeof u=="object"&&f in u)u=u[f];else return i||n;let h=typeof u=="string"?u:i||n;return o&&typeof h=="string"&&Object.keys(o).forEach(f=>{const p=o[f],b=`{{${f}}}`;h=h.replace(new RegExp(b,"g"),String(p))}),h},language:()=>mh(),setLanguage:n=>{rw(n),typeof window<"u"&&localStorage.setItem("hrmfinance-language",n)}});var nw=q("<div><label></label><select><option value>"),iw=q("<span>*"),ow=q("<option>");const yr=t=>{const{t:e}=at(),r={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},n={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},i={"margin-bottom":"1rem"};return(()=>{var o=nw(),a=o.firstChild,c=a.nextSibling,u=c.firstChild;return d(o,i),d(a,r),s(a,()=>t.label,null),s(a,(()=>{var h=fe(()=>!!t.required);return()=>h()&&(()=>{var f=iw();return f.style.setProperty("color","var(--primary-color)"),f})()})(),null),c.addEventListener("blur",h=>h.target.style.borderColor="var(--border-color)"),c.addEventListener("focus",h=>h.target.style.borderColor="var(--primary-color)"),c.addEventListener("change",h=>t.onChange(h.target.value)),d(c,n),s(u,()=>e("forms.selectOption")),s(c,()=>t.options.map(h=>(()=>{var f=ow();return s(f,()=>h.label),re(()=>f.value=h.value),f})()),null),re(h=>{var f=t.required,p=t.disabled;return f!==h.e&&(c.required=h.e=f),p!==h.t&&(c.disabled=h.t=p),h},{e:void 0,t:void 0}),re(()=>c.value=t.value),o})()};var sw=q("<div><span></span><select><option value=en> </option><option value=es> ");const Vy=()=>{const{t,language:e,setLanguage:r}=at(),n={display:"flex","align-items":"center",gap:"0.5rem","margin-left":"auto"},i={padding:"0.5rem 1rem","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",background:"var(--surface-color)",color:"var(--text-primary)",cursor:"pointer","font-size":"0.875rem","font-weight":"500",transition:"all 0.2s ease","min-width":"120px"},o={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},a=c=>{const u=c.target;r(u.value)};return(()=>{var c=sw(),u=c.firstChild,h=u.nextSibling,f=h.firstChild;f.firstChild;var p=f.nextSibling;return p.firstChild,d(c,n),d(u,o),h.addEventListener("change",a),d(h,i),s(f,()=>t("common.english"),null),s(p,()=>t("common.spanish"),null),re(()=>h.value=e()),c})()};var aw=q("<main><div>"),lw=q("<header><h1>");const jr=t=>{const e={"min-height":"100vh",background:"var(--background-color)"},r={"max-width":"1200px",margin:"0 auto",padding:"2rem"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},i={"font-size":"2rem","font-weight":"700",color:"var(--text-primary)",margin:"0"};return(()=>{var o=aw(),a=o.firstChild;return d(o,e),d(a,r),s(a,(()=>{var c=fe(()=>!!t.title);return()=>c()&&(()=>{var u=lw(),h=u.firstChild;return d(u,n),d(h,i),s(h,()=>t.title),s(u,S(Vy,{}),null),u})()})(),null),s(a,()=>t.children,null),o})()};var cw=q('<img alt="User avatar">'),uw=q("<div><span>"),dw=q("<button>Sign Out"),hw=q(`<nav><div><div><div></div></div><div></div></div><style>
        .nav-active {
          background: linear-gradient(135deg, var(--primary-color), var(--primary-dark)) !important;
          color: white !important;
          box-shadow: var(--shadow-sm);
        }
        
        nav a:hover:not(.nav-active) {
          background: var(--background-color);
          color: var(--text-primary);
        }
        
        @media (max-width: 768px) {
          nav div:first-child {
            flex-direction: column;
            gap: 1rem;
            padding: 1rem;
          }
          
          nav div:last-child {
            flex-wrap: wrap;
            justify-content: center;
          }
        }
      `);const mw=()=>{const{t}=at(),e={background:"var(--surface-color)","border-bottom":"1px solid var(--border-color)","box-shadow":"var(--shadow-sm)","backdrop-filter":"blur(10px)",position:"sticky",top:"0","z-index":"100"},r={display:"flex","align-items":"center","justify-content":"space-between",padding:"1rem 2rem",margin:"0 auto"},n={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","text-decoration":"none","margin-right":"2rem"},i={display:"flex",gap:"0.5rem","align-items":"center"},o={"text-decoration":"none",color:"var(--text-secondary)",padding:"0.5rem 1rem","border-radius":"var(--border-radius-sm)","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease","white-space":"nowrap"},a={display:"flex","align-items":"center",gap:"1rem"},c={display:"flex","align-items":"center",gap:"0.75rem",padding:"0.5rem 1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",color:"var(--text-primary)"},u={width:"32px",height:"32px","border-radius":"50%","object-fit":"cover"},h={...o,cursor:"pointer",border:"1px solid var(--border-color)",background:"transparent"},f=()=>{qt.signOut()},p=b=>{const C=qt.state?.profile;return C?C[b]===!0:!1};return(()=>{var b=hw(),C=b.firstChild,D=C.firstChild,x=D.firstChild,E=D.nextSibling;return d(C,r),D.style.setProperty("display","flex"),D.style.setProperty("align-items","center"),D.style.setProperty("flex","1"),s(D,S(vn,{href:"/",style:n,children:"HRM Finance"}),x),d(x,i),s(x,S(vn,{href:"/",style:o,activeClass:"nav-active",get children(){return t("navigation.dashboard")}}),null),s(x,S(Ue,{get when(){return p("AccountAccess")},get children(){return S(vn,{href:"/accounts",style:o,activeClass:"nav-active",get children(){return t("navigation.accounts")}})}}),null),s(x,S(Ue,{get when(){return p("JournalAccess")},get children(){return S(vn,{href:"/entry-books",style:o,activeClass:"nav-active",get children(){return t("navigation.entryBooks")}})}}),null),s(x,S(Ue,{get when(){return p("EmployeeAccess")},get children(){return S(vn,{href:"/employees",style:o,activeClass:"nav-active",get children(){return t("navigation.employees")}})}}),null),s(x,S(Ue,{get when(){return p("BankingAccess")},get children(){return S(vn,{href:"/bank-consolidations",style:o,activeClass:"nav-active",get children(){return t("navigation.consolidate")}})}}),null),s(x,S(Ue,{get when(){return p("AccountAccess")},get children(){return S(vn,{href:"/balance-sheet",style:o,activeClass:"nav-active",get children(){return t("navigation.balanceSheet")}})}}),null),s(x,S(Ue,{get when(){return p("InventoryAccess")},get children(){return S(vn,{href:"/inventory",style:o,activeClass:"nav-active",get children(){return t("navigation.inventory")}})}}),null),d(E,a),s(E,S(Vy,{}),null),s(E,S(Ue,{get when(){return qt.currentUser},get children(){return[(()=>{var T=uw(),H=T.firstChild;return d(T,c),s(T,S(Ue,{get when(){return qt.currentUser?.photoURL},get children(){var te=cw();return re(Y=>{var ue=qt.currentUser.photoURL,oe=u;return ue!==Y.e&&ut(te,"src",Y.e=ue),Y.t=d(te,oe,Y.t),Y},{e:void 0,t:void 0}),te}}),H),T})(),(()=>{var T=dw();return T.addEventListener("mouseleave",H=>{H.currentTarget.style.background="transparent",H.currentTarget.style.color="var(--text-secondary)"}),T.addEventListener("mouseenter",H=>{H.currentTarget.style.background="var(--background-color)",H.currentTarget.style.color="var(--text-primary)"}),T.$$click=f,re(H=>d(T,h,H)),T})()]}}),null),re(T=>d(b,e,T)),b})()};At(["click"]);var fw=q("<div><div><div></div><h1></h1><p>.</p><div><p><strong></strong><br></p></div><div><button></button></div><div><h3></h3><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div></div><div><p>"),fh=q("<br>"),yw=q("<strong>");const gw=t=>{const{t:e}=at(),r={"min-height":"calc(100vh - 200px)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},n={"text-align":"center","max-width":"600px",width:"100%"},i={"font-size":"5rem",color:"#e53e3e","margin-bottom":"2rem"},o={"font-size":"2.5rem","font-weight":"700",color:"#1a202c","margin-bottom":"1rem"},a={"font-size":"1.25rem",color:"#718096","margin-bottom":"2rem","line-height":"1.6"},c={background:"#f7fafc",border:"1px solid #e2e8f0","border-radius":"0.5rem",padding:"1.5rem","margin-bottom":"2rem"},u={color:"#4a5568","font-size":"1rem","line-height":"1.6"},h={display:"flex",gap:"1rem","justify-content":"center","flex-wrap":"wrap"},f={padding:"0.75rem 2rem","border-radius":"0.5rem","text-decoration":"none","font-weight":"500",transition:"all 0.2s",display:"inline-block"},p={...f,background:"var(--primary-color)",color:"white",border:"2px solid var(--primary-color)"},b={...f,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},C={"text-align":"left","margin-top":"2rem",padding:"0 2rem"},D={display:"flex","align-items":"center",gap:"0.75rem","margin-bottom":"1rem",color:"#4a5568"},x={color:"#48bb78","font-size":"1.25rem"};return S(jr,{get title(){return e("unauthorized.title")},get children(){var E=fw(),T=E.firstChild,H=T.firstChild,te=H.nextSibling,Y=te.nextSibling,ue=Y.firstChild,oe=Y.nextSibling,I=oe.firstChild,_=I.firstChild;_.nextSibling;var v=oe.nextSibling,P=v.firstChild,w=v.nextSibling,A=w.firstChild,y=A.nextSibling,he=y.firstChild,W=he.nextSibling,$=y.nextSibling,Z=$.firstChild,k=Z.nextSibling,F=$.nextSibling,V=F.firstChild,z=V.nextSibling,me=w.nextSibling,K=me.firstChild;return d(E,r),d(T,n),d(H,i),d(te,o),s(te,()=>e("unauthorized.accessDenied")),d(Y,a),s(Y,()=>e("unauthorized.noPermission"),ue),s(Y,(()=>{var de=fe(()=>!!t.featureName);return()=>de()?` ${t.featureName}`:` ${e("unauthorized.thisFeature")}`})(),ue),d(oe,c),d(I,u),s(_,()=>e("unauthorized.whySeeing")),s(I,()=>e("unauthorized.explanation"),null),s(I,(()=>{var de=fe(()=>!!t.requiredPermission);return()=>de()&&[fh(),fh(),(()=>{var N=yw();return s(N,()=>e("unauthorized.requiredPermission")),N})()," ",fe(()=>t.requiredPermission)]})(),null),d(v,h),s(v,S(vn,{href:"/",style:p,get children(){return e("unauthorized.goToDashboard")}}),P),P.$$click=()=>window.history.back(),s(P,()=>e("unauthorized.goBack")),d(w,C),A.style.setProperty("margin-bottom","1rem"),A.style.setProperty("color","#2d3748"),s(A,()=>e("unauthorized.featuresCanAccess")),s(W,()=>e("unauthorized.dashboardAccess")),s(k,()=>e("unauthorized.profileAccess")),s(z,()=>e("unauthorized.roleBasedAccess")),me.style.setProperty("margin-top","3rem"),me.style.setProperty("padding","1.5rem"),me.style.setProperty("background","#edf2f7"),me.style.setProperty("border-radius","0.5rem"),K.style.setProperty("color","#4a5568"),K.style.setProperty("font-size","0.875rem"),s(K,()=>e("unauthorized.needAccess")),re(de=>{var N=b,j=D,Q=x,J=D,ce=x,ae=D,M=x;return de.e=d(P,N,de.e),de.t=d(y,j,de.t),de.a=d(he,Q,de.a),de.o=d($,J,de.o),de.i=d(Z,ce,de.i),de.n=d(F,ae,de.n),de.s=d(V,M,de.s),de},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),E}})};At(["click"]);const yn=t=>{const{t:e}=at(),r=()=>{if(!t.permission)return!0;const i=qt.state?.profile;if(!i)return!1;switch(t.permission){case"AccountAccess":return i.AccountAccess===!0;case"InventoryAccess":return i.InventoryAccess===!0;case"EmployeeAccess":return i.EmployeeAccess===!0;case"BankingAccess":return i.BankingAccess===!0;case"JournalAccess":return i.JournalAccess===!0;case"AdminAccess":return i.isAdmin===!0;default:return i[t.permission]===!0}},n=()=>{if(t.requiredPermission)return t.requiredPermission;switch(t.permission){case"AccountAccess":return e("unauthorized.permissions.accountAccess");case"InventoryAccess":return e("unauthorized.permissions.inventoryAccess");case"EmployeeAccess":return e("unauthorized.permissions.employeeAccess");case"BankingAccess":return e("unauthorized.permissions.bankingAccess");case"JournalAccess":return e("unauthorized.permissions.journalAccess");case"AdminAccess":return e("unauthorized.permissions.adminAccess");default:return t.permission}};return S(Ue,{get when(){return r()},get fallback(){return t.fallback||S(gw,{get featureName(){return t.featureName},get requiredPermission(){return n()}})},get children(){return t.children}})};var pw=q('<button title="Open Dev Tools">'),vw=q("<span>(<!>)"),bw=q("<div><span></span><span>"),yh=q("<div>"),_w=q("<div>Database reset only available in fake mode"),Sw=q("<div><div>Loading..."),Pw=q("<div><div><h3> Dev Tools</h3><button></button></div><div><div>API Mode</div><div><button>Fake Server</button><button>Real API</button><button>Hybrid</button></div><div>Current: <strong></strong></div></div><div><div>Health Status</div></div><div><div>Database Stats</div></div><div><div>Actions</div><div><button> Refresh Stats</button><button> Health Check</button></div><div><button> Reset DB</button></div></div><div><div>Info</div><div> <strong>Fake Server:</strong> Uses local mock data<br> <strong>Real API:</strong> Connects to actual backend<br> <strong>Hybrid:</strong> Real API with fake fallback<br> Settings are saved in localStorage"),ww=q("<div>Loading..."),Cw=q("<div><span>:</span><span>");const Aw=()=>{const[t,e]=ye(!1),[r,n]=ye(Wo.getMode()),[i,o]=ye({}),[a,c]=ye(null),[u,h]=ye(!1);hn(async()=>{await f(),await p()});const f=async()=>{try{const I=await Uu.getStats();o(I)}catch(I){console.error("Failed to load stats:",I)}},p=async()=>{try{const I=await Uu.healthCheck();c(I)}catch(I){console.error("Health check failed:",I),c({status:"error",error:I.message})}},b=async I=>{h(!0);try{Wo.setMode(I),n(I),await f(),await p()}catch(_){console.error("Failed to change API mode:",_)}finally{h(!1)}},C=async()=>{if(confirm("Are you sure you want to reset the fake database to its initial state?")){h(!0);try{const I=await Nr.utils.resetDatabase();alert(I.message),await f()}catch(I){console.error("Failed to reset database:",I),alert("Failed to reset database")}finally{h(!1)}}},D={position:"fixed",bottom:"20px",right:"20px","z-index":"10000","font-family":"monospace"},x={background:"#1a1a1a",color:"#fff",border:"1px solid #333","border-radius":"8px",padding:"16px","min-width":"300px","max-width":"400px","box-shadow":"0 4px 20px rgba(0,0,0,0.3)"},E={background:"#007acc",color:"#fff",border:"none","border-radius":"50%",width:"50px",height:"50px",cursor:"pointer","font-size":"20px","box-shadow":"0 2px 10px rgba(0,0,0,0.2)",display:"flex","align-items":"center","justify-content":"center"},T={background:"#333",color:"#fff",border:"1px solid #555","border-radius":"4px",padding:"6px 12px",cursor:"pointer","font-size":"12px","margin-right":"8px","margin-bottom":"8px"},H={...T,background:"#007acc","border-color":"#007acc"},te={"margin-bottom":"16px","padding-bottom":"12px","border-bottom":"1px solid #333"},Y={"font-size":"14px","font-weight":"bold","margin-bottom":"8px",color:"#007acc"},ue={display:"flex","justify-content":"space-between","font-size":"12px","margin-bottom":"4px"},oe=I=>({display:"inline-block",width:"8px",height:"8px","border-radius":"50%","margin-right":"8px",background:I==="healthy"?"#00ff00":I==="error"?"#ff0000":"#ffff00"});return(()=>{var I=yh();return s(I,S(Ue,{get when(){return!t()},get children(){var _=pw();return _.$$click=()=>e(!0),d(_,E),_}}),null),s(I,S(Ue,{get when(){return t()},get children(){var _=Pw(),v=_.firstChild,P=v.firstChild,w=P.nextSibling,A=v.nextSibling,y=A.firstChild,he=y.nextSibling,W=he.firstChild,$=W.nextSibling,Z=$.nextSibling,k=he.nextSibling,F=k.firstChild,V=F.nextSibling,z=A.nextSibling,me=z.firstChild,K=z.nextSibling,de=K.firstChild,N=K.nextSibling,j=N.firstChild,Q=j.nextSibling,J=Q.firstChild,ce=J.nextSibling,ae=Q.nextSibling,M=ae.firstChild,ne=N.nextSibling,pe=ne.firstChild,ve=pe.nextSibling;return d(_,x),v.style.setProperty("display","flex"),v.style.setProperty("justify-content","space-between"),v.style.setProperty("align-items","center"),v.style.setProperty("margin-bottom","16px"),P.style.setProperty("margin","0"),P.style.setProperty("color","#007acc"),P.style.setProperty("font-size","16px"),w.$$click=()=>e(!1),W.$$click=()=>b("fake"),$.$$click=()=>b("real"),Z.$$click=()=>b("hybrid"),k.style.setProperty("font-size","11px"),k.style.setProperty("color","#888"),k.style.setProperty("margin-top","4px"),s(V,r),s(k,()=>r()==="fake"&&" (Using fake server)",null),s(k,()=>r()==="real"&&" (Using real API)",null),s(k,()=>r()==="hybrid"&&" (Real API with fallback)",null),s(z,S(Ue,{get when(){return a()},get fallback(){return(()=>{var ee=ww();return ee.style.setProperty("font-size","12px"),ee})()},get children(){return[(()=>{var ee=bw(),ie=ee.firstChild,R=ie.nextSibling;return ee.style.setProperty("display","flex"),ee.style.setProperty("align-items","center"),ee.style.setProperty("font-size","12px"),s(R,()=>a()?.status||"Unknown"),s(ee,S(Ue,{get when(){return a()?.timestamp},get children(){var L=vw(),B=L.firstChild,ge=B.nextSibling;return ge.nextSibling,L.style.setProperty("margin-left","8px"),L.style.setProperty("color","#888"),s(L,()=>new Date(a().timestamp).toLocaleTimeString(),ge),L}}),null),re(L=>d(ie,oe(a()?.status||"unknown"),L)),ee})(),S(Ue,{get when(){return a()?.error},get children(){var ee=yh();return ee.style.setProperty("font-size","11px"),ee.style.setProperty("color","#ff6666"),ee.style.setProperty("margin-top","4px"),s(ee,()=>a().error),ee}})]}}),null),s(K,S(Ut,{get each(){return Object.entries(i())},children:([ee,ie])=>(()=>{var R=Cw(),L=R.firstChild,B=L.firstChild,ge=L.nextSibling;return d(R,ue),L.style.setProperty("text-transform","capitalize"),s(L,ee,B),ge.style.setProperty("color","#00ff00"),s(ge,ie),R})()}),null),J.$$click=f,ce.$$click=p,ae.style.setProperty("margin-top","8px"),M.$$click=C,s(N,S(Ue,{get when(){return r()!=="fake"},get children(){var ee=_w();return ee.style.setProperty("font-size","11px"),ee.style.setProperty("color","#888"),ee.style.setProperty("margin-top","4px"),ee}}),null),ve.style.setProperty("font-size","11px"),ve.style.setProperty("color","#888"),ve.style.setProperty("line-height","1.4"),s(_,S(Ue,{get when(){return u()},get children(){var ee=Sw(),ie=ee.firstChild;return ee.style.setProperty("position","absolute"),ee.style.setProperty("top","0"),ee.style.setProperty("left","0"),ee.style.setProperty("right","0"),ee.style.setProperty("bottom","0"),ee.style.setProperty("background","rgba(0,0,0,0.7)"),ee.style.setProperty("display","flex"),ee.style.setProperty("align-items","center"),ee.style.setProperty("justify-content","center"),ee.style.setProperty("border-radius","8px"),ie.style.setProperty("color","#fff"),ie.style.setProperty("font-size","14px"),ee}}),null),re(ee=>{var ie={...T,padding:"4px 8px"},R=te,L=Y,B=r()==="fake"?H:T,ge=u(),le=r()==="real"?H:T,U=u(),G=r()==="hybrid"?H:T,Pe=u(),_e=te,se=Y,be=te,X=Y,we=te,ke=Y,xe=T,Te=u(),Oe=T,We=u(),je={...T,background:"#cc4400","border-color":"#cc4400"},Ie=u()||r()!=="fake",Ve=Y;return ee.e=d(w,ie,ee.e),ee.t=d(A,R,ee.t),ee.a=d(y,L,ee.a),ee.o=d(W,B,ee.o),ge!==ee.i&&(W.disabled=ee.i=ge),ee.n=d($,le,ee.n),U!==ee.s&&($.disabled=ee.s=U),ee.h=d(Z,G,ee.h),Pe!==ee.r&&(Z.disabled=ee.r=Pe),ee.d=d(z,_e,ee.d),ee.l=d(me,se,ee.l),ee.u=d(K,be,ee.u),ee.c=d(de,X,ee.c),ee.w=d(N,we,ee.w),ee.m=d(j,ke,ee.m),ee.f=d(J,xe,ee.f),Te!==ee.y&&(J.disabled=ee.y=Te),ee.g=d(ce,Oe,ee.g),We!==ee.p&&(ce.disabled=ee.p=We),ee.b=d(M,je,ee.b),Ie!==ee.T&&(M.disabled=ee.T=Ie),ee.A=d(pe,Ve,ee.A),ee},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),_}}),null),re(_=>d(I,D,_)),I})()};At(["click"]);var Iw=q("<div>$124,350"),Ew=q("<div>+12% from last month"),xw=q("<div>247"),Fi=q("<div>"),Tw=q("<div>18"),$w=q("<div>$89,250"),kw=q("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>");const Rw=()=>{const{t}=at(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},n={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)",margin:"0.5rem 0"},i={"font-size":"0.875rem",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"};return S(jr,{get title(){return t("dashboard.title")},get children(){return[(()=>{var o=Fi();return d(o,e),s(o,S(Xe,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var a=Iw();return re(c=>d(a,n,c)),a})(),(()=>{var a=Ew();return re(c=>d(a,i,c)),a})()]}}),null),s(o,S(Xe,{get title(){return t("dashboard.employeeCount")},get subtitle(){return t("dashboard.current")},get children(){return[(()=>{var a=xw();return re(c=>d(a,n,c)),a})(),(()=>{var a=Fi();return s(a,()=>t("dashboard.newHires")),re(c=>d(a,i,c)),a})()]}}),null),s(o,S(Xe,{get title(){return t("dashboard.pendingInvoices")},get subtitle(){return t("dashboard.outstanding")},get children(){return[(()=>{var a=Tw();return re(c=>d(a,n,c)),a})(),(()=>{var a=Fi();return s(a,()=>t("dashboard.totalOutstanding")),re(c=>d(a,i,c)),a})()]}}),null),s(o,S(Xe,{get title(){return t("dashboard.cashBalance")},get subtitle(){return t("accounts.title")},get children(){return[(()=>{var a=$w();return re(c=>d(a,n,c)),a})(),(()=>{var a=Fi();return s(a,()=>t("dashboard.lastUpdatedToday")),re(c=>d(a,i,c)),a})()]}}),null),o})(),(()=>{var o=Fi();return d(o,r),s(o,S(Xe,{get title(){return t("dashboard.quickActions")},get subtitle(){return t("dashboard.commonTasks")},get children(){var a=Fi();return a.style.setProperty("display","flex"),a.style.setProperty("flex-direction","column"),a.style.setProperty("gap","1rem"),s(a,S(Ne,{variant:"primary",get children(){return t("invoices.createNew")}}),null),s(a,S(Ne,{variant:"secondary",get children(){return t("employees.addEmployee")}}),null),s(a,S(Ne,{variant:"outline",get children(){return t("dashboard.generateReport")}}),null),a}}),null),s(o,S(Xe,{get title(){return t("dashboard.recentActivity")},get subtitle(){return t("dashboard.latestUpdates")},get children(){var a=kw(),c=a.firstChild,u=c.firstChild,h=u.nextSibling,f=c.nextSibling,p=f.firstChild,b=p.nextSibling,C=f.nextSibling,D=C.firstChild,x=D.nextSibling;return a.style.setProperty("display","flex"),a.style.setProperty("flex-direction","column"),a.style.setProperty("gap","0.75rem"),c.style.setProperty("border-bottom","1px solid var(--border-color)"),c.style.setProperty("padding-bottom","0.5rem"),u.style.setProperty("font-weight","500"),s(u,()=>t("dashboard.invoicePaid")),h.style.setProperty("font-size","0.875rem"),h.style.setProperty("color","var(--text-muted)"),s(h,()=>t("dashboard.hoursAgo")),f.style.setProperty("border-bottom","1px solid var(--border-color)"),f.style.setProperty("padding-bottom","0.5rem"),p.style.setProperty("font-weight","500"),s(p,()=>t("dashboard.newEmployeeOnboarded")),b.style.setProperty("font-size","0.875rem"),b.style.setProperty("color","var(--text-muted)"),s(b,()=>t("dashboard.dayAgo")),D.style.setProperty("font-weight","500"),s(D,()=>t("dashboard.monthlyReportGenerated")),x.style.setProperty("font-size","0.875rem"),x.style.setProperty("color","var(--text-muted)"),s(x,()=>t("dashboard.daysAgo")),a}}),null),o})()]}})},Dw=[{id:"1",accountNumber:"1000",name:"Cash and Cash Equivalents",type:"Asset",category:"Current Assets",description:"Cash on hand and in bank accounts",balance:45230.5,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1001",accountNumber:"1001",name:"Petty Cash",type:"Asset",category:"Current Assets",description:"Small amounts of cash for minor expenses",balance:500,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1002",accountNumber:"1002",name:"Bank - Checking Account",type:"Asset",category:"Current Assets",description:"Main operating checking account",balance:32730.5,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1003",accountNumber:"1003",name:"Bank - Savings Account",type:"Asset",category:"Current Assets",description:"Interest-bearing savings account",balance:12e3,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"2",accountNumber:"1100",name:"Accounts Receivable",type:"Asset",category:"Current Assets",description:"Money owed by customers",balance:23450.75,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2001",accountNumber:"1101",name:"Trade Receivables",type:"Asset",category:"Current Assets",description:"Receivables from regular customers",balance:18450.75,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2002",accountNumber:"1102",name:"Employee Advances",type:"Asset",category:"Current Assets",description:"Money advanced to employees",balance:5e3,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"3",accountNumber:"1200",name:"Inventory",type:"Asset",category:"Current Assets",description:"Products held for sale",balance:78920.25,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-13"},{id:"4",accountNumber:"1500",name:"Equipment",type:"Asset",category:"Fixed Assets",description:"Office equipment and machinery",balance:125e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-12"},{id:"5",accountNumber:"2000",name:"Accounts Payable",type:"Liability",category:"Current Liabilities",description:"Money owed to suppliers",balance:15670.3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-11"},{id:"6",accountNumber:"2100",name:"Accrued Expenses",type:"Liability",category:"Current Liabilities",description:"Expenses incurred but not yet paid",balance:8945.6,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-10"},{id:"7",accountNumber:"2500",name:"Long-term Debt",type:"Liability",category:"Long-term Liabilities",description:"Long-term loans and mortgages",balance:85e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-09"},{id:"8",accountNumber:"3000",name:"Owner's Equity",type:"Equity",category:"Owner's Equity",description:"Owner's investment in the business",balance:15e4,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-08"},{id:"9",accountNumber:"3100",name:"Retained Earnings",type:"Equity",category:"Owner's Equity",description:"Accumulated profits retained in business",balance:32450.8,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-07"},{id:"10",accountNumber:"4000",name:"Sales Revenue",type:"Revenue",category:"Operating Revenue",description:"Revenue from product sales",balance:245678.9,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-06"},{id:"11",accountNumber:"4100",name:"Service Revenue",type:"Revenue",category:"Operating Revenue",description:"Revenue from services provided",balance:89432.15,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-05"},{id:"12",accountNumber:"5000",name:"Cost of Goods Sold",type:"Expense",category:"Operating Expenses",description:"Direct costs of producing goods",balance:125678.45,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-04"},{id:"13",accountNumber:"5100",name:"Salaries Expense",type:"Expense",category:"Operating Expenses",description:"Employee salary expenses",balance:98765.32,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-03"},{id:"14",accountNumber:"5200",name:"Rent Expense",type:"Expense",category:"Operating Expenses",description:"Office rent expenses",balance:24e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-02"}],Nw=[{id:"1",accountId:"1",date:"2024-01-15",description:"Customer payment received",debitAmount:5e3,creditAmount:0,reference:"INV-2024-001",type:"debit"},{id:"2",accountId:"2",date:"2024-01-15",description:"Customer payment received",debitAmount:0,creditAmount:5e3,reference:"INV-2024-001",type:"credit"},{id:"3",accountId:"5",date:"2024-01-14",description:"Office supplies purchased",debitAmount:0,creditAmount:1250,reference:"PO-2024-001",type:"credit"}],[en,ks]=ye(Dw),[ml,Lw]=ye(Nw),yt={get accounts(){return en()},get transactions(){return ml()},fetchAllAccount(t){const e={...t,id:Date.now().toString(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return ks([...en(),e]),e},addAccount(t){const e={...t,id:Date.now().toString(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return ks([...en(),e]),e},updateAccount(t,e){ks(en().map(r=>r.id===t?{...r,...e,lastModified:new Date().toISOString().split("T")[0]}:r))},deleteAccount(t){ks(en().filter(e=>e.id!==t))},getAccountById(t){return en().find(e=>e.id===t)},getAccountsByType(t){return en().filter(e=>e.type===t)},getAccountTransactions(t){return ml().filter(e=>e.accountId===t)},addTransaction(t){const e={...t,id:Date.now().toString()};Lw([...ml(),e]);const r=this.getAccountById(t.accountId);if(r){const n=t.type==="debit"?t.debitAmount:-t.creditAmount;this.updateAccount(t.accountId,{balance:r.balance+n})}return e},getTotalByType(t){return en().filter(e=>e.type===t&&e.isActive).reduce((e,r)=>e+r.balance,0)},getAccountCategories(t){const e=this.getAccountsByType(t);return[...new Set(e.map(r=>r.category))]},getSubAccounts(t){return en().filter(e=>e.parentAccountId===t)},getParentAccounts(){return en().filter(t=>!t.parentAccountId)},getAccountHierarchy(){return this.getParentAccounts().map(e=>({...e,subAccounts:this.getSubAccounts(e.id)}))},getAccountWithSubAccounts(t){const e=this.getAccountById(t);return e?{...e,subAccounts:this.getSubAccounts(t),parentAccount:e.parentAccountId?this.getAccountById(e.parentAccountId):null}:null},getAccountPath(t){const e=this.getAccountById(t);if(!e)return[];const r=[e];let n=e;for(;n.parentAccountId;){const i=this.getAccountById(n.parentAccountId);if(i)r.unshift(i),n=i;else break}return r},getTotalBalanceWithSubAccounts(t){const e=this.getAccountById(t);if(!e)return 0;const n=this.getSubAccounts(t).reduce((i,o)=>i+this.getTotalBalanceWithSubAccounts(o.id),0);return e.balance+n},canDeleteAccount(t){const e=this.getSubAccounts(t);if(e.length>0)return{canDelete:!1,reason:`Account has ${e.length} sub-account(s). Delete or move sub-accounts first.`};const r=this.getAccountTransactions(t);return r.length>0?{canDelete:!1,reason:`Account has ${r.length} transaction(s). Cannot delete account with transaction history.`}:{canDelete:!0}}};var Mn=q("<div>"),Po=q("<div> ");const Mw=()=>{const{t}=at(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},n={"font-size":"0.875rem",color:"var(--text-muted)"},i=x=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(x),o=yt.getTotalByType("Asset"),a=yt.getTotalByType("Liability"),c=yt.getTotalByType("Equity"),u=yt.getTotalByType("Revenue"),h=yt.getTotalByType("Expense"),f=yt.getAccountsByType("Asset").length,p=yt.getAccountsByType("Liability").length,b=yt.getAccountsByType("Equity").length,C=yt.getAccountsByType("Revenue").length,D=yt.getAccountsByType("Expense").length;return(()=>{var x=Mn();return d(x,e),s(x,S(Xe,{get title(){return t("dashboard.totalAssets")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var E=Mn();return s(E,()=>i(o)),re(T=>d(E,r,T)),E})(),(()=>{var E=Po(),T=E.firstChild;return s(E,f,T),s(E,()=>t("navigation.accounts"),null),re(H=>d(E,n,H)),E})()]}}),null),s(x,S(Xe,{get title(){return t("dashboard.totalLiabilities")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var E=Mn();return s(E,()=>i(a)),re(T=>d(E,r,T)),E})(),(()=>{var E=Po(),T=E.firstChild;return s(E,p,T),s(E,()=>t("navigation.accounts"),null),re(H=>d(E,n,H)),E})()]}}),null),s(x,S(Xe,{get title(){return t("dashboard.totalEquity")},get subtitle(){return t("accounts.categories.ownersEquity")},get children(){return[(()=>{var E=Mn();return s(E,()=>i(c)),re(T=>d(E,r,T)),E})(),(()=>{var E=Po(),T=E.firstChild;return s(E,b,T),s(E,()=>t("navigation.accounts"),null),re(H=>d(E,n,H)),E})()]}}),null),s(x,S(Xe,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("accounts.categories.operatingRevenue")},get children(){return[(()=>{var E=Mn();return s(E,()=>i(u)),re(T=>d(E,r,T)),E})(),(()=>{var E=Po(),T=E.firstChild;return s(E,C,T),s(E,()=>t("navigation.accounts"),null),re(H=>d(E,n,H)),E})()]}}),null),s(x,S(Xe,{get title(){return t("dashboard.totalExpenses")},get subtitle(){return t("accounts.categories.operatingExpenses")},get children(){return[(()=>{var E=Mn();return s(E,()=>i(h)),re(T=>d(E,r,T)),E})(),(()=>{var E=Po(),T=E.firstChild;return s(E,D,T),s(E,()=>t("navigation.accounts"),null),re(H=>d(E,n,H)),E})()]}}),null),s(x,S(Xe,{get title(){return t("dashboard.netIncome")},get subtitle(){return`${t("dashboard.totalRevenue")} - ${t("dashboard.totalExpenses")}`},get children(){return[(()=>{var E=Mn();return s(E,()=>i(u-h)),re(T=>d(E,{...r,color:u-h>=0?"#4caf50":"#f44336"},T)),E})(),(()=>{var E=Mn();return s(E,()=>u-h>=0?t("dashboard.netIncome"):t("dashboard.netLoss")),re(T=>d(E,n,T)),E})()]}}),null),x})()};var Ow=q("<div><div></div><div>"),Vw=q("<h3>"),wo=q("<div>");const Bw=t=>{const{t:e}=at();yc();const r={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},i={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"},o={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},a={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},c={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem"},u={"font-size":"0.875rem",color:"var(--text-secondary)","line-height":"1.4"},h=b=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[b]||{bg:"#f5f5f5",color:"#666"},f=b=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(b),p=h(t.account.type);return S(Xe,{get children(){return[(()=>{var b=Ow(),C=b.firstChild,D=C.nextSibling;return d(b,n),d(C,i),s(C,()=>t.account.accountNumber),s(D,()=>e(`accounts.types.${t.account.type.toLowerCase()}`)),re(x=>d(D,{...o,background:p.bg,color:p.color},x)),b})(),(()=>{var b=Vw();return b.style.setProperty("margin","0 0 0.5rem 0"),b.style.setProperty("font-size","1.1rem"),s(b,()=>t.account.name),b})(),(()=>{var b=wo();return d(b,c),s(b,()=>t.account.category),b})(),(()=>{var b=wo();return d(b,a),s(b,()=>f(t.account.balance)),b})(),(()=>{var b=wo();return d(b,u),s(b,()=>t.account.description),b})(),fe(()=>fe(()=>!t.account.isActive)()&&(()=>{var b=wo();return b.style.setProperty("margin-top","0.5rem"),b.style.setProperty("padding","0.25rem 0.75rem"),b.style.setProperty("border-radius","9999px"),b.style.setProperty("font-size","0.75rem"),b.style.setProperty("font-weight","500"),b.style.setProperty("background","#ffebee"),b.style.setProperty("color","#d32f2f"),b.style.setProperty("text-align","center"),s(b,()=>e("common.inactive")),b})()),(()=>{var b=wo();return d(b,r),s(b,S(Ne,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.account),get children(){return[fe(()=>e("common.view"))," ",fe(()=>e("accounts.accountDetails"))]}})),b})()]}})};var Fw=q("<div><div><div><div></div><h3></h3></div></div><div><div></div><div>"),Uw=q("<div>"),jw=q("<button>"),zw=q("<div><h4> (<!>)"),qw=q("<div><div><div></div><div>  </div></div><div>");const Hw=t=>{const{t:e}=at(),r=yc(),[n,i]=ye(!0),o={"margin-bottom":"1rem"},a={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},c={display:"flex","align-items":"center",gap:"1rem"},u={background:"none",border:"none",cursor:"pointer","font-size":"1.2rem",color:"var(--text-muted)",padding:"0.25rem","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease"},h={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},f={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},p={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},b={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},C={"margin-left":"1rem","border-left":"2px solid var(--border-color)","padding-left":"1rem","margin-top":"1rem"},D={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem","margin-bottom":"0.5rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},x={flex:"1"},E={"font-weight":"500","margin-bottom":"0.25rem"},T={"font-size":"0.875rem",color:"var(--text-muted)"},H={"font-weight":"600",color:"var(--primary-color)"},te={display:"flex",gap:"0.5rem"},Y=P=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[P]||{bg:"#f5f5f5",color:"#666"},ue=P=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(P),oe=P=>{t.onViewDetails?t.onViewDetails(P):r(`/accounts/${P.id}`)},I=()=>{t.onAddSubAccount&&t.onAddSubAccount(t.account)},_=t.account.balance+t.account.subAccounts.reduce((P,w)=>P+w.balance,0),v=Y(t.account.type);return S(Xe,{className:"account-hierarchy-card",style:o,get children(){return[(()=>{var P=Fw(),w=P.firstChild,A=w.firstChild,y=A.firstChild,he=y.nextSibling,W=w.nextSibling,$=W.firstChild,Z=$.nextSibling;return d(P,a),d(w,c),s(w,(()=>{var k=fe(()=>t.account.subAccounts.length>0);return()=>k()&&(()=>{var F=jw();return F.addEventListener("mouseleave",V=>V.target.style.background="none"),F.addEventListener("mouseenter",V=>V.target.style.background="var(--background-color)"),F.$$click=()=>i(!n()),d(F,u),s(F,()=>n()?"":""),F})()})(),A),A.$$click=()=>oe(t.account),A.style.setProperty("cursor","pointer"),d(y,h),s(y,()=>t.account.accountNumber),d(he,f),s(he,()=>t.account.name),W.style.setProperty("text-align","right"),d($,p),s($,()=>ue(_)),s(Z,()=>e(`accounts.types.${t.account.type.toLowerCase()}`)),re(k=>d(Z,{...b,background:v.bg,color:v.color},k)),P})(),(()=>{var P=Uw();return d(P,te),s(P,S(Ne,{variant:"secondary",size:"sm",onClick:()=>oe(t.account),get children(){return[fe(()=>e("common.view"))," ",fe(()=>e("accounts.accountDetails"))]}}),null),s(P,S(Ne,{variant:"outline",size:"sm",onClick:I,get children(){return[fe(()=>e("common.add"))," ",fe(()=>e("accounts.subAccounts"))]}}),null),P})(),fe(()=>fe(()=>!!(n()&&t.account.subAccounts.length>0))()&&(()=>{var P=zw(),w=P.firstChild,A=w.firstChild,y=A.nextSibling;return y.nextSibling,d(P,C),w.style.setProperty("margin","0 0 1rem 0"),w.style.setProperty("font-size","1rem"),w.style.setProperty("color","var(--text-muted)"),s(w,()=>e("accounts.subAccounts"),A),s(w,()=>t.account.subAccounts.length,y),s(P,()=>t.account.subAccounts.map(he=>(()=>{var W=qw(),$=W.firstChild,Z=$.firstChild,k=Z.nextSibling,F=k.firstChild,V=$.nextSibling;return W.addEventListener("mouseleave",z=>{z.currentTarget.style.background="var(--background-color)",z.currentTarget.style.transform="translateY(0)"}),W.addEventListener("mouseenter",z=>{z.currentTarget.style.background="var(--surface-color)",z.currentTarget.style.transform="translateY(-1px)"}),W.$$click=()=>oe(he),d(W,D),d($,x),d(Z,E),s(Z,()=>he.name),d(k,T),s(k,()=>he.accountNumber,F),s(k,()=>he.description,null),d(V,H),s(V,()=>ue(he.balance)),W})()),null),P})())]}})};At(["click"]);var Ww=q("<form><div>");const Gw=t=>{const{t:e}=at(),[r,n]=ye({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),i=[{value:"Asset",label:e("accounts.types.asset"),type:"debit",classification:"real"},{value:"Liability",label:e("accounts.types.liability"),type:"credit",classification:"real"},{value:"Equity",label:e("accounts.types.equity"),type:"credit",classification:"real"},{value:"Revenue",label:e("accounts.types.revenue"),type:"credit",classification:"nominal"},{value:"Expense",label:e("accounts.types.expense"),type:"debit",classification:"nominal"}],o=()=>{const f=r().type;return f?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")},{value:"Sales Revenue",label:e("accounts.categories.salesRevenue")},{value:"Service Revenue",label:e("accounts.categories.servicesRevenue")},{value:"Subscription Revenue",label:e("accounts.categories.subscriptionRevenue")},{value:"Rental Revenue",label:e("accounts.categories.rentalRevenue")},{value:"Commission Revenue",label:e("accounts.categories.commissionRevenue")},{value:"Franchise Revenue",label:e("accounts.categories.franchiseRevenue")},{value:"Licensing Revenue",label:e("accounts.categories.licensingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[f]||[]:[]},a=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],c={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},u=f=>{f.preventDefault();const p=r();if(!p.accountNumber||!p.name||!p.type||!p.category){alert(e("forms.requiredField"));return}if(yt.accounts.find(D=>D.accountNumber===p.accountNumber)){alert(e("forms.duplicateAccountNumber"));return}const C={accountNumber:p.accountNumber,name:p.name,type:p.type,category:p.category,description:p.description,balance:parseFloat(p.balance)||0,isActive:p.isActive==="true"};yt.addAccount(C),n({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},h=(f,p)=>{n(b=>{const C={...b,[f]:p};return f==="type"&&(C.category=""),C})};return S(dr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.addAccount")},get children(){var f=Ww(),p=f.firstChild;return f.addEventListener("submit",u),s(f,S(Ct,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:b=>h("accountNumber",b),get placeholder(){return e("accounts.accountNumber")},required:!0}),p),s(f,S(Ct,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:b=>h("name",b),get placeholder(){return e("accounts.accountName")},required:!0}),p),s(f,S(yr,{get label(){return e("accounts.accountType")},get value(){return r().type},onChange:b=>h("type",b),options:i,required:!0}),p),s(f,S(yr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:b=>h("category",b),get options(){return o()},required:!0}),p),s(f,S(Ct,{get label(){return e("common.description")},get value(){return r().description},onChange:b=>h("description",b),get placeholder(){return e("common.description")}}),p),s(f,S(Ct,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:b=>h("balance",b),get placeholder(){return e("accounts.balance")}}),p),s(f,S(yr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:b=>h("isActive",b),options:a,required:!0}),p),d(p,c),s(p,S(Ne,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(p,S(Ne,{variant:"primary",type:"submit",get children(){return e("accounts.addAccount")}}),null),f}})};var Kw=q("<form><div>"),Yw=q("<div><div></div><div> - </div><div>  ");const Qw=t=>{const{t:e}=at(),[r,n]=ye({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),i=()=>t.parentAccount?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[t.parentAccount.type]||[]:[],o=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],a={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},c={background:"var(--background-color)",padding:"1rem","border-radius":"var(--border-radius-sm)","margin-bottom":"1.5rem",border:"1px solid var(--border-color)"},u={"font-size":"0.875rem","font-weight":"500",color:"var(--text-muted)","margin-bottom":"0.5rem"},h={"font-weight":"600",color:"var(--text-primary)"},f={"font-size":"0.875rem",color:"var(--text-secondary)"},p=x=>{x.preventDefault();const E=r();if(!E.accountNumber||!E.name||!E.category||!t.parentAccount){alert(e("forms.requiredField"));return}if(yt.accounts.find(te=>te.accountNumber===E.accountNumber)){alert(e("forms.duplicateAccountNumber"));return}const H={accountNumber:E.accountNumber,name:E.name,type:t.parentAccount.type,category:E.category,description:E.description,balance:parseFloat(E.balance)||0,isActive:E.isActive==="true",parentAccountId:t.parentAccount.id};yt.addAccount(H),n({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},b=(x,E)=>{n(T=>({...T,[x]:E}))},C=()=>{if(!t.parentAccount)return"";const x=t.parentAccount.accountNumber,T=yt.getSubAccounts(t.parentAccount.id).length+1;return(parseInt(x)+T).toString()},D=()=>r().accountNumber===""&&t.parentAccount?C():r().accountNumber;return S(dr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return`${e("common.add")} ${e("accounts.subAccounts")}`},get children(){return[fe(()=>fe(()=>!!t.parentAccount)()&&(()=>{var x=Yw(),E=x.firstChild,T=E.nextSibling,H=T.firstChild,te=T.nextSibling,Y=te.firstChild;return d(x,c),d(E,u),s(E,()=>e("accounts.parentAccount")),d(T,h),s(T,()=>t.parentAccount.accountNumber,H),s(T,()=>t.parentAccount.name,null),d(te,f),s(te,()=>e(`accounts.types.${t.parentAccount.type.toLowerCase()}`),Y),s(te,()=>t.parentAccount.category,null),x})()),(()=>{var x=Kw(),E=x.firstChild;return x.addEventListener("submit",p),s(x,S(Ct,{get label(){return e("accounts.accountNumber")},get value(){return D()},onChange:T=>b("accountNumber",T),get placeholder(){return`${e("common.suggested")}: ${C()}`},required:!0}),E),s(x,S(Ct,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:T=>b("name",T),get placeholder(){return e("accounts.accountName")},required:!0}),E),s(x,S(yr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:T=>b("category",T),get options(){return i()},required:!0}),E),s(x,S(Ct,{get label(){return e("common.description")},get value(){return r().description},onChange:T=>b("description",T),get placeholder(){return e("common.description")}}),E),s(x,S(Ct,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:T=>b("balance",T),get placeholder(){return e("accounts.balance")}}),E),s(x,S(yr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:T=>b("isActive",T),options:o,required:!0}),E),d(E,a),s(E,S(Ne,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(E,S(Ne,{variant:"primary",type:"submit",get children(){return[fe(()=>e("common.add"))," ",fe(()=>e("accounts.subAccounts"))]}}),null),x})()]}})};var Jw=q("<form><div>"),Xw=q("<div>");const Zw=t=>{const{t:e}=at(),[r,n]=ye({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),[i,o]=ye(null);Tn(()=>{t.account&&(n({accountNumber:t.account.accountNumber,name:t.account.name,type:t.account.type,category:t.account.category,description:t.account.description,balance:t.account.balance.toString(),isActive:t.account.isActive.toString()}),o(null))});const a=[{value:"Asset",label:e("accounts.types.asset")},{value:"Liability",label:e("accounts.types.liability")},{value:"Equity",label:e("accounts.types.equity")},{value:"Revenue",label:e("accounts.types.revenue")},{value:"Expense",label:e("accounts.types.expense")}],c=()=>{const C=r().type;return C?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[C]||[]:[]},u=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],h={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},f=C=>{if(C.preventDefault(),o(null),!t.account)return;const D=r();if(!D.accountNumber||!D.name||!D.type||!D.category){o(e("forms.requiredField"));return}if(yt.accounts.find(T=>T.accountNumber===D.accountNumber&&T.id!==t.account.id)){o(e("forms.duplicateAccountNumber"));return}const E={accountNumber:D.accountNumber,name:D.name,type:D.type,category:D.category,description:D.description,balance:parseFloat(D.balance)||0,isActive:D.isActive==="true"};try{yt.updateAccount(t.account.id,E),t.onClose()}catch(T){o(T instanceof Error?T.message:e("forms.saveError"))}},p=()=>{if(!t.account)return;const C=yt.canDeleteAccount(t.account.id);if(!C.canDelete){o(C.reason||e("forms.deleteError"));return}const D=e("forms.confirmDelete");if(confirm(D))try{yt.deleteAccount(t.account.id),t.onClose()}catch(x){o(x instanceof Error?x.message:e("forms.deleteError"))}},b=(C,D)=>{n(x=>{const E={...x,[C]:D};return C==="type"&&(E.category=""),E}),i()&&o(null)};return t.account?S(dr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.editAccount")},get children(){var C=Jw(),D=C.firstChild;return C.addEventListener("submit",f),s(C,S(Ct,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:x=>b("accountNumber",x),get placeholder(){return e("accounts.accountNumber")},required:!0}),D),s(C,S(Ct,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:x=>b("name",x),get placeholder(){return e("accounts.accountName")},required:!0}),D),s(C,S(yr,{get label(){return e("accounts.accountType")},get value(){return r().type},onChange:x=>b("type",x),options:a,required:!0}),D),s(C,S(yr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:x=>b("category",x),get options(){return c()},required:!0}),D),s(C,S(Ct,{get label(){return e("common.description")},get value(){return r().description},onChange:x=>b("description",x),get placeholder(){return e("common.description")}}),D),s(C,S(Ct,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:x=>b("balance",x),get placeholder(){return e("accounts.balance")}}),D),s(C,S(yr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:x=>b("isActive",x),options:u,required:!0}),D),s(C,(()=>{var x=fe(()=>!!i());return()=>x()&&(()=>{var E=Xw();return E.style.setProperty("padding","1rem"),E.style.setProperty("border-radius","var(--border-radius-sm)"),E.style.setProperty("margin-top","1rem"),E.style.setProperty("background","#f8d7da"),E.style.setProperty("color","#721c24"),E.style.setProperty("border","1px solid #f5c6cb"),s(E,i),E})()})(),D),d(D,h),s(D,S(Ne,{variant:"outline",type:"button",onClick:p,style:{color:"#dc3545","border-color":"#dc3545","margin-right":"auto"},get children(){return e("accounts.deleteAccount")}}),null),s(D,S(Ne,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(D,S(Ne,{variant:"primary",type:"submit",get children(){return e("common.save")}}),null),C}}):null};var eC=q("<div><div></div><div></div><div></div><div>"),tC=q("<div><div></div><div></div><div>"),rC=q("<div><button></button><button> (<!>)"),fl=q("<div>"),nC=q("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),iC=q("<div><div><div></div><div>  </div></div><div>");const oC=t=>{const{t:e}=at(),[r,n]=ye("details"),[i,o]=ye(!1),a=Ke(()=>t.account?yt.getAccountById(t.account.id)||t.account:null),c={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},u={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},h={"font-weight":"600",color:"var(--text-primary)"},f={"text-align":"center","margin-bottom":"2rem"},p={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},b={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},C={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem"},D={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},x=v=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:v?"var(--primary-color)":"var(--text-muted)","border-bottom":v?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),E={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},T={flex:"1"},H={"font-size":"0.875rem",color:"var(--text-muted)"},te={"font-weight":"500","margin-bottom":"0.25rem"},Y=v=>({"font-weight":"600",color:v==="debit"?"#4caf50":"#f44336"}),ue={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},oe=v=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[v]||{bg:"#f5f5f5",color:"#666"},I=v=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(v),_=v=>new Date(v).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return S(dr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.accountDetails")},get children(){return[fe(()=>fe(()=>!a())()?(()=>{var v=eC(),P=v.firstChild,w=P.nextSibling,A=w.nextSibling,y=A.nextSibling;return v.style.setProperty("text-align","center"),v.style.setProperty("padding","3rem"),v.style.setProperty("color","var(--text-muted)"),P.style.setProperty("font-size","1.5rem"),P.style.setProperty("margin-bottom","1rem"),w.style.setProperty("font-size","1.1rem"),w.style.setProperty("margin-bottom","0.5rem"),s(w,()=>e("common.error")),A.style.setProperty("font-size","0.875rem"),s(A,()=>e("common.noDataFound")),y.style.setProperty("margin-top","2rem"),s(y,S(Ne,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),v})():(()=>{const v=Ke(()=>oe(a().type)),P=Ke(()=>yt.getAccountTransactions(a().id));return[(()=>{var w=tC(),A=w.firstChild,y=A.nextSibling,he=y.nextSibling;return d(w,f),d(A,p),s(A,()=>a().name),d(y,b),s(y,()=>I(a().balance)),s(he,()=>e(`accounts.types.${a().type.toLowerCase()}`)),re(W=>d(he,{...C,background:v().bg,color:v().color},W)),w})(),(()=>{var w=rC(),A=w.firstChild,y=A.nextSibling,he=y.firstChild,W=he.nextSibling;return W.nextSibling,d(w,D),A.$$click=()=>n("details"),s(A,()=>e("accounts.accountDetails")),y.$$click=()=>n("transactions"),s(y,()=>e("accounts.transactions"),he),s(y,()=>P().length,W),re($=>{var Z=x(r()==="details"),k=x(r()==="transactions");return $.e=d(A,Z,$.e),$.t=d(y,k,$.t),$},{e:void 0,t:void 0}),w})(),fe(()=>fe(()=>r()==="details")()&&(()=>{var w=nC(),A=w.firstChild,y=A.firstChild,he=y.nextSibling,W=A.nextSibling,$=W.firstChild,Z=$.nextSibling,k=W.nextSibling,F=k.firstChild,V=F.nextSibling,z=k.nextSibling,me=z.firstChild,K=me.nextSibling,de=z.nextSibling,N=de.firstChild,j=N.nextSibling,Q=de.nextSibling,J=Q.firstChild,ce=J.nextSibling;return s(y,()=>e("accounts.accountNumber")),s(he,()=>a().accountNumber),s($,()=>e("accounts.category")),s(Z,()=>a().category),s(F,()=>e("common.description")),s(V,()=>a().description),s(me,()=>e("common.status")),s(K,(()=>{var ae=fe(()=>!!a().isActive);return()=>ae()?e("common.active"):e("common.inactive")})()),s(N,()=>e("accounts.createdDate")),s(j,()=>_(a().createdDate)),s(J,()=>e("accounts.lastModified")),s(ce,()=>_(a().lastModified)),re(ae=>{var M=c,ne=u,pe=h,ve=c,ee=u,ie=h,R=c,L=u,B=h,ge=c,le=u,U=h,G=c,Pe=u,_e=h,se=c,be=u,X=h;return ae.e=d(A,M,ae.e),ae.t=d(y,ne,ae.t),ae.a=d(he,pe,ae.a),ae.o=d(W,ve,ae.o),ae.i=d($,ee,ae.i),ae.n=d(Z,ie,ae.n),ae.s=d(k,R,ae.s),ae.h=d(F,L,ae.h),ae.r=d(V,B,ae.r),ae.d=d(z,ge,ae.d),ae.l=d(me,le,ae.l),ae.u=d(K,U,ae.u),ae.c=d(de,G,ae.c),ae.w=d(N,Pe,ae.w),ae.m=d(j,_e,ae.m),ae.f=d(Q,se,ae.f),ae.y=d(J,be,ae.y),ae.g=d(ce,X,ae.g),ae},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),w})()),fe(()=>fe(()=>r()==="transactions")()&&(()=>{var w=fl();return s(w,(()=>{var A=fe(()=>P().length===0);return()=>A()?(()=>{var y=fl();return y.style.setProperty("text-align","center"),y.style.setProperty("color","var(--text-muted)"),y.style.setProperty("padding","2rem"),s(y,()=>e("common.noDataFound")),y})():P().map(y=>(()=>{var he=iC(),W=he.firstChild,$=W.firstChild,Z=$.nextSibling,k=Z.firstChild,F=W.nextSibling;return d(he,E),d(W,T),d($,te),s($,()=>y.description),d(Z,H),s(Z,()=>_(y.date),k),s(Z,()=>y.reference,null),s(F,()=>y.type==="debit"?"+":"-",null),s(F,()=>I(y.type==="debit"?y.debitAmount:y.creditAmount),null),re(V=>d(F,Y(y.type),V)),he})())})()),w})()),(()=>{var w=fl();return d(w,ue),s(w,S(Ne,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(w,S(Ne,{variant:"primary",onClick:()=>o(!0),get children(){return e("accounts.editAccount")}}),null),w})()]})()),fe(()=>fe(()=>!!a())()&&S(Zw,{get isOpen(){return i()},onClose:()=>{o(!1)},get account(){return a()}}))]}})};At(["click"]);const sC="https://qvamarkets.com/gql_api",[aC,gh]=ye(!1),[lC,yl]=ye(null);class cC{baseUrl;constructor(e=sC){this.baseUrl=e}async request(e,r,n,i){gh(!0),yl(null);try{const o=r.startsWith("http")?r:`${this.baseUrl}${r}`,a={method:e,headers:{"Content-Type":"application/json",Accept:"application/json",...i}};n&&(e==="POST"||e==="PUT"||e==="PATCH")&&(a.body=JSON.stringify(n));const c=await fetch(o,a);if(!c.ok)throw new Error(`HTTP error! status: ${c.status}`);const u=await c.json();if(u.errors&&u.errors.length>0)throw new Error(u.errors[0].message);return u.data||u}catch(o){const a=o instanceof Error?o.message:"Unknown error occurred";throw yl(a),o}finally{gh(!1)}}async graphql(e){return this.request("POST","",e)}async get(e,r){return this.request("GET",e,void 0,r)}async post(e,r,n){return this.request("POST",e,r,n)}async put(e,r,n){return this.request("PUT",e,r,n)}async patch(e,r,n){return this.request("PATCH",e,r,n)}async delete(e,r){return this.request("DELETE",e,void 0,r)}getLoadingState(){return aC()}getErrorState(){return lC()}clearError(){yl(null)}}const Rs=new cC,su=`
  fragment AccountFields on Account {
    id
    accountNumber
    name
    type
    category
    description
    balance
    isActive
    parentAccountId
    createdDate
    lastModified
  }
`,uC=`
  query GetAccountById($id: ID!) {
    account(id: $id) {
      ...AccountFields
    }
  }
  ${su}
`,dC=`
  mutation CreateAccount($input: CreateAccountInput!) {
    createAccount(input: $input) {
      ...AccountFields
    }
  }
  ${su}
`,hC=`
  mutation UpdateAccount($id: ID!, $input: UpdateAccountInput!) {
    updateAccount(id: $id, input: $input) {
      ...AccountFields
    }
  }
  ${su}
`,mC=`
  mutation DeleteAccount($id: ID!) {
    deleteAccount(id: $id) {
      success
      message
    }
  }
`;class fC{async getAccounts(e,r){try{if(Wo.isFakeMode())return await Fu.getAll(e);const n=await zn({query:"getAllYabaProducts",params:{businessId:"YB100423253156428"}});return console.log("Real API accounts response:",n),n?.accounts||[]}catch(n){if(console.error("Error fetching accounts:",n),Wo.isHybridMode())return console.warn("Falling back to fake API for accounts"),await Fu.getAll(e);throw n}}async getAccountById(e){try{return(await Rs.graphql({query:uC,variables:{id:e}})).account}catch(r){throw console.error("Error fetching account:",r),r}}async createAccount(e){try{return(await Rs.graphql({query:dC,variables:{input:e}})).createAccount}catch(r){throw console.error("Error creating account:",r),r}}async updateAccount(e,r){try{return(await Rs.graphql({query:hC,variables:{id:e,input:r}})).updateAccount}catch(n){throw console.error("Error updating account:",n),n}}async deleteAccount(e){try{return(await Rs.graphql({query:mC,variables:{id:e}})).deleteAccount}catch(r){throw console.error("Error deleting account:",r),r}}async getAccountsByType(e){return this.getAccounts({type:e})}async getAccountHierarchy(){const e=await this.getAccounts();return this.buildHierarchy(e)}buildHierarchy(e){const r=new Map,n=[];return e.forEach(i=>{r.set(i.id,{...i,subAccounts:[]})}),e.forEach(i=>{const o=r.get(i.id);if(i.parentAccountId){const a=r.get(i.parentAccountId);a&&(a.subAccounts=a.subAccounts||[],a.subAccounts.push(o))}else n.push(o)}),n}async getAccountBalance(e){const r=await this.getAccountById(e);return r?r.balance:0}async searchAccounts(e){return this.getAccounts({search:e})}}const yC=new fC;var gC=q("<div><h2></h2><div><span>:</span><button></button><button>"),pC=q("<div><span>:"),ph=q("<div>"),vC=q("<button>");const bC=()=>{const{t}=at(),[e,r]=ye(!1),[n,i]=ye(!1),[o,a]=ye(!1),[c,u]=ye(null),[h,f]=ye(null),[p,b]=ye("All"),[C,D]=ye("hierarchy"),x=_=>{u(_),a(!0)},E=_=>{f(_),i(!0)},T=()=>p()==="All"?C()==="hierarchy"?yt.getAccountHierarchy():yt.accounts:C()==="hierarchy"?yt.getAccountHierarchy().filter(_=>_.type===p()):yt.getAccountsByType(p()),H={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(350px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},te={display:"flex",gap:"1rem","margin-bottom":"2rem","align-items":"center"},Y=_=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:_?"var(--primary-color)":"var(--surface-color)",color:_?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500",transition:"all 0.2s ease"}),ue={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},oe={display:"flex",gap:"0.5rem","align-items":"center","margin-left":"auto","margin-right":"1rem"},I=_=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:_?"var(--primary-color)":"var(--surface-color)",color:_?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"});return S(jr,{get title(){return t("accounts.title")},get children(){return[S(Mw,{}),(()=>{var _=gC(),v=_.firstChild,P=v.nextSibling,w=P.firstChild,A=w.firstChild,y=w.nextSibling,he=y.nextSibling;return d(_,ue),v.style.setProperty("margin","0"),v.style.setProperty("font-size","1.5rem"),s(v,()=>t("accounts.title")),d(P,oe),w.style.setProperty("font-weight","500"),w.style.setProperty("color","var(--text-muted)"),w.style.setProperty("font-size","0.875rem"),s(w,()=>t("common.view"),A),y.$$click=()=>D("hierarchy"),s(y,()=>t("accounts.accountHierarchy")),he.$$click=()=>{D("flat"),yC.getAccounts()},s(he,()=>t("common.all")),s(_,S(Ne,{variant:"primary",onClick:()=>r(!0),get children(){return t("accounts.addAccount")}}),null),re(W=>{var $=I(C()==="hierarchy"),Z=I(C()==="flat");return W.e=d(y,$,W.e),W.t=d(he,Z,W.t),W},{e:void 0,t:void 0}),_})(),(()=>{var _=pC(),v=_.firstChild,P=v.firstChild;return d(_,te),v.style.setProperty("font-weight","500"),v.style.setProperty("color","var(--text-muted)"),s(v,()=>t("common.filter"),P),s(_,()=>[t("common.all"),t("accounts.types.asset"),t("accounts.types.liability"),t("accounts.types.equity"),t("accounts.types.revenue"),t("accounts.types.expense")].map((w,A)=>{const he=["All","Asset","Liability","Equity","Revenue","Expense"][A];return(()=>{var W=vC();return W.$$click=()=>b(he),s(W,w),re($=>d(W,Y(p()===he),$)),W})()}),null),_})(),(()=>{var _=ph();return s(_,(()=>{var v=fe(()=>C()==="hierarchy");return()=>v()?T().map(P=>S(Hw,{account:P,onAddSubAccount:E,onViewDetails:x})):T().map(P=>S(Bw,{account:P,onViewDetails:x}))})()),re(v=>d(_,C()==="hierarchy"?{display:"flex","flex-direction":"column",gap:"1rem"}:H,v)),_})(),fe(()=>fe(()=>T().length===0)()&&(()=>{var _=ph();return _.style.setProperty("text-align","center"),_.style.setProperty("color","var(--text-muted)"),_.style.setProperty("padding","3rem"),_.style.setProperty("font-size","1.1rem"),s(_,()=>t("common.noDataFound")),_})()),S(Gw,{get isOpen(){return e()},onClose:()=>r(!1)}),S(Qw,{get isOpen(){return n()},onClose:()=>i(!1),get parentAccount(){return h()}}),S(oC,{get isOpen(){return o()},onClose:()=>a(!1),get account(){return c()}})]}})};At(["click"]);var _C=q("<div><h2>"),Ui=q("<div>"),SC=q("<div><div><div></div><h1></h1><div></div></div><div>"),PC=q("<div><button></button><button> (<!>)"),Ds=q("<div><span></span><span>"),wC=q("<p>"),CC=q("<div><div></div><div>"),AC=q("<div><div><div></div><div>  </div></div><div>");const IC=()=>{const{t}=at(),e=Gg(),r=yc(),[n,i]=ye(null),[o,a]=ye("overview");hn(()=>{const y=yt.getAccountById(e.id);y?i(y):r("/accounts")});const c={display:"flex","align-items":"center",gap:"0.5rem","margin-bottom":"1rem"},u={display:"flex","align-items":"center",gap:"1rem","margin-bottom":"2rem"},h={"font-size":"1rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},f={"font-size":"2.5rem","font-weight":"700",color:"var(--primary-color)"},p={padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},b={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},C=y=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:y?"var(--primary-color)":"var(--text-muted)","border-bottom":y?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),D={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},x={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},E={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},T={"font-weight":"500",color:"var(--text-muted)"},H={"font-weight":"600",color:"var(--text-primary)"},te={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},Y={flex:"1"},ue={"font-weight":"500","margin-bottom":"0.25rem"},oe={"font-size":"0.875rem",color:"var(--text-muted)"},I=y=>({"font-weight":"600",color:y==="debit"?"#4caf50":"#f44336"});if(!n())return S(jr,{get title(){return t("accounts.accountDetails")},get children(){var y=_C(),he=y.firstChild;return y.style.setProperty("text-align","center"),y.style.setProperty("padding","3rem"),s(he,()=>t("common.error")),s(y,S(Ne,{variant:"primary",onClick:()=>r("/accounts"),get children(){return[fe(()=>t("common.back"))," ",fe(()=>t("navigation.accounts"))]}}),null),y}});const _=y=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[y]||{bg:"#f5f5f5",color:"#666"},v=y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(y),P=y=>new Date(y).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),w=_(n().type),A=yt.getAccountTransactions(n().id);return S(jr,{get title(){return n().name},get children(){return[(()=>{var y=Ui();return d(y,c),s(y,S(Ne,{variant:"secondary",onClick:()=>r("/accounts"),get children(){return[" ",fe(()=>t("common.back"))," ",fe(()=>t("navigation.accounts"))]}})),y})(),(()=>{var y=SC(),he=y.firstChild,W=he.firstChild,$=W.nextSibling,Z=$.nextSibling,k=he.nextSibling;return d(y,u),d(W,h),s(W,()=>n().accountNumber),$.style.setProperty("margin","0.5rem 0"),$.style.setProperty("font-size","2rem"),s($,()=>n().name),d(Z,f),s(Z,()=>v(n().balance)),s(k,()=>n().type),re(F=>d(k,{...p,background:w.bg,color:w.color},F)),y})(),(()=>{var y=PC(),he=y.firstChild,W=he.nextSibling,$=W.firstChild,Z=$.nextSibling;return Z.nextSibling,d(y,b),he.$$click=()=>a("overview"),s(he,()=>t("dashboard.overview")),W.$$click=()=>a("transactions"),s(W,()=>t("accounts.transactions"),$),s(W,()=>A.length,Z),re(k=>{var F=C(o()==="overview"),V=C(o()==="transactions");return k.e=d(he,F,k.e),k.t=d(W,V,k.t),k},{e:void 0,t:void 0}),y})(),fe(()=>fe(()=>o()==="overview")()&&(()=>{var y=CC(),he=y.firstChild,W=he.nextSibling;return d(he,D),s(he,S(Xe,{get title(){return t("accounts.balance")},get subtitle(){return t("dashboard.overview")},get children(){var $=Ui();return $.style.setProperty("font-size","1.5rem"),$.style.setProperty("font-weight","600"),$.style.setProperty("color","var(--primary-color)"),s($,()=>v(n().balance)),$}}),null),s(he,S(Xe,{get title(){return t("accounts.accountType")},get subtitle(){return t("accounts.category")},get children(){var $=Ui();return $.style.setProperty("font-size","1.5rem"),$.style.setProperty("font-weight","600"),$.style.setProperty("color","var(--primary-color)"),s($,()=>t(`accounts.types.${n().type.toLowerCase()}`)),$}}),null),s(he,S(Xe,{get title(){return t("common.status")},get subtitle(){return t("accounts.accountDetails")},get children(){var $=Ui();return $.style.setProperty("font-size","1.5rem"),$.style.setProperty("font-weight","600"),s($,(()=>{var Z=fe(()=>!!n().isActive);return()=>Z()?t("common.active"):t("common.inactive")})()),re(Z=>(Z=n().isActive?"#4caf50":"#f44336")!=null?$.style.setProperty("color",Z):$.style.removeProperty("color")),$}}),null),s(he,S(Xe,{get title(){return t("accounts.transactions")},get subtitle(){return t("common.total")},get children(){var $=Ui();return $.style.setProperty("font-size","1.5rem"),$.style.setProperty("font-weight","600"),$.style.setProperty("color","var(--primary-color)"),s($,()=>A.length),$}}),null),d(W,x),s(W,S(Xe,{get title(){return t("accounts.accountDetails")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var $=Ds(),Z=$.firstChild,k=Z.nextSibling;return s(Z,()=>t("accounts.accountNumber")),s(k,()=>n().accountNumber),re(F=>{var V=E,z=T,me=H;return F.e=d($,V,F.e),F.t=d(Z,z,F.t),F.a=d(k,me,F.a),F},{e:void 0,t:void 0,a:void 0}),$})(),(()=>{var $=Ds(),Z=$.firstChild,k=Z.nextSibling;return s(Z,()=>t("accounts.category")),s(k,()=>n().category),re(F=>{var V=E,z=T,me=H;return F.e=d($,V,F.e),F.t=d(Z,z,F.t),F.a=d(k,me,F.a),F},{e:void 0,t:void 0,a:void 0}),$})(),(()=>{var $=Ds(),Z=$.firstChild,k=Z.nextSibling;return s(Z,()=>t("common.date")),s(k,()=>P(n().createdDate)),re(F=>{var V=E,z=T,me=H;return F.e=d($,V,F.e),F.t=d(Z,z,F.t),F.a=d(k,me,F.a),F},{e:void 0,t:void 0,a:void 0}),$})(),(()=>{var $=Ds(),Z=$.firstChild,k=Z.nextSibling;return s(Z,()=>t("common.date")),s(k,()=>P(n().lastModified)),re(F=>{var V=E,z=T,me=H;return F.e=d($,V,F.e),F.t=d(Z,z,F.t),F.a=d(k,me,F.a),F},{e:void 0,t:void 0,a:void 0}),$})()]}}),null),s(W,S(Xe,{get title(){return t("common.description")},get subtitle(){return t("accounts.accountDetails")},get children(){var $=wC();return $.style.setProperty("margin","0"),$.style.setProperty("color","var(--text-secondary)"),s($,()=>n().description||t("common.noDataFound")),$}}),null),y})()),fe(()=>fe(()=>o()==="transactions")()&&S(Xe,{get title(){return t("accounts.accountHistory")},get subtitle(){return t("accounts.transactions")},get children(){return fe(()=>A.length===0)()?(()=>{var y=Ui();return y.style.setProperty("text-align","center"),y.style.setProperty("color","var(--text-muted)"),y.style.setProperty("padding","2rem"),s(y,()=>t("common.noDataFound")),y})():A.map(y=>(()=>{var he=AC(),W=he.firstChild,$=W.firstChild,Z=$.nextSibling,k=Z.firstChild,F=W.nextSibling;return d(he,te),d(W,Y),d($,ue),s($,()=>y.description),d(Z,oe),s(Z,()=>P(y.date),k),s(Z,()=>y.reference,null),s(F,()=>y.type==="debit"?"+":"-",null),s(F,()=>v(y.type==="debit"?y.debitAmount:y.creditAmount),null),re(V=>d(F,I(y.type),V)),he})())}}))]}})};At(["click"]);var EC=q("<div><div><h1></h1><p> </p></div><div><input type=date>"),gn=q("<div><span></span><span>"),xC=q("<div><div></div><div>"),TC=q("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),$C=q("<div><div> (<!> = <!> + <!>)</div><div> = "),kC=q("<span>(<!>: <!>)");const RC=()=>{const{t}=at(),[e,r]=ye(new Date().toISOString().split("T")[0]),[n,i]=ye(0),[o,a]=ye(0),[c,u]=ye(0);hn(()=>{h()});const h=()=>{const D=yt.getAccountsByType("Asset"),x=yt.getAccountsByType("Liability"),E=yt.getAccountsByType("Equity"),T=D.reduce((Y,ue)=>Y+ue.balance,0),H=x.reduce((Y,ue)=>Y+ue.balance,0),te=E.reduce((Y,ue)=>Y+ue.balance,0);i(T),a(H),u(te)},f=D=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(D),p={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},b={"margin-bottom":"2rem"},C={"font-weight":"bold","font-size":"1.1rem","border-top":"2px solid var(--border-color)","padding-top":"0.5rem","margin-top":"1rem"};return S(jr,{get title(){return t("balanceSheet.title")},get children(){return[(()=>{var D=EC(),x=D.firstChild,E=x.firstChild,T=E.nextSibling,H=T.firstChild,te=x.nextSibling,Y=te.firstChild;return d(D,p),E.style.setProperty("margin","0"),s(E,()=>t("balanceSheet.title")),T.style.setProperty("margin","0.5rem 0 0 0"),T.style.setProperty("color","var(--text-muted)"),s(T,()=>t("balanceSheet.asOf"),H),s(T,()=>new Date(e()).toLocaleDateString(),null),te.style.setProperty("display","flex"),te.style.setProperty("gap","1rem"),Y.addEventListener("change",ue=>r(ue.target.value)),Y.style.setProperty("padding","0.5rem"),Y.style.setProperty("border","1px solid var(--border-color)"),Y.style.setProperty("border-radius","var(--border-radius-sm)"),s(te,S(Ne,{variant:"primary",onClick:h,get children(){return t("balanceSheet.generateReport")}}),null),re(()=>Y.value=e()),D})(),(()=>{var D=xC(),x=D.firstChild,E=x.nextSibling;return D.style.setProperty("display","grid"),D.style.setProperty("grid-template-columns","1fr 1fr"),D.style.setProperty("gap","2rem"),s(x,S(Xe,{get title(){return t("balanceSheet.assets")},style:b,get children(){return[(()=>{var T=gn(),H=T.firstChild,te=H.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),s(H,()=>t("balanceSheet.currentAssets")),s(te,()=>f(n()*.6)),T})(),(()=>{var T=gn(),H=T.firstChild,te=H.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),s(H,()=>t("balanceSheet.nonCurrentAssets")),s(te,()=>f(n()*.4)),T})(),(()=>{var T=gn(),H=T.firstChild,te=H.nextSibling;return s(H,()=>t("balanceSheet.totalAssets")),s(te,()=>f(n())),re(Y=>d(T,{...C,display:"flex","justify-content":"space-between"},Y)),T})()]}})),s(E,S(Xe,{get title(){return t("balanceSheet.liabilities")},style:b,get children(){return[(()=>{var T=gn(),H=T.firstChild,te=H.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),s(H,()=>t("balanceSheet.currentLiabilities")),s(te,()=>f(o()*.7)),T})(),(()=>{var T=gn(),H=T.firstChild,te=H.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),s(H,()=>t("balanceSheet.nonCurrentLiabilities")),s(te,()=>f(o()*.3)),T})(),(()=>{var T=gn(),H=T.firstChild,te=H.nextSibling;return s(H,()=>t("balanceSheet.totalLiabilities")),s(te,()=>f(o())),re(Y=>d(T,{...C,display:"flex","justify-content":"space-between"},Y)),T})()]}}),null),s(E,S(Xe,{get title(){return t("balanceSheet.equity")},get children(){return[(()=>{var T=gn(),H=T.firstChild,te=H.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),s(H,()=>t("balanceSheet.commonStock")),s(te,()=>f(c()*.8)),T})(),(()=>{var T=gn(),H=T.firstChild,te=H.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),s(H,()=>t("balanceSheet.retainedEarnings")),s(te,()=>f(c()*.2)),T})(),(()=>{var T=gn(),H=T.firstChild,te=H.nextSibling;return s(H,()=>t("balanceSheet.totalEquity")),s(te,()=>f(c())),re(Y=>d(T,{...C,display:"flex","justify-content":"space-between"},Y)),T})()]}}),null),D})(),S(Xe,{get title(){return t("dashboard.overview")},style:{"margin-top":"2rem"},get children(){return[(()=>{var D=TC(),x=D.firstChild,E=x.firstChild,T=E.nextSibling,H=x.nextSibling,te=H.firstChild,Y=te.nextSibling,ue=H.nextSibling,oe=ue.firstChild,I=oe.nextSibling;return D.style.setProperty("display","grid"),D.style.setProperty("grid-template-columns","repeat(3, 1fr)"),D.style.setProperty("gap","2rem"),x.style.setProperty("text-align","center"),E.style.setProperty("font-size","0.875rem"),E.style.setProperty("color","var(--text-muted)"),E.style.setProperty("margin-bottom","0.5rem"),s(E,()=>t("balanceSheet.totalAssets")),T.style.setProperty("font-size","1.5rem"),T.style.setProperty("font-weight","bold"),T.style.setProperty("color","var(--primary-color)"),s(T,()=>f(n())),H.style.setProperty("text-align","center"),te.style.setProperty("font-size","0.875rem"),te.style.setProperty("color","var(--text-muted)"),te.style.setProperty("margin-bottom","0.5rem"),s(te,()=>t("balanceSheet.totalLiabilities")),Y.style.setProperty("font-size","1.5rem"),Y.style.setProperty("font-weight","bold"),Y.style.setProperty("color","#f44336"),s(Y,()=>f(o())),ue.style.setProperty("text-align","center"),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),oe.style.setProperty("margin-bottom","0.5rem"),s(oe,()=>t("balanceSheet.totalEquity")),I.style.setProperty("font-size","1.5rem"),I.style.setProperty("font-weight","bold"),I.style.setProperty("color","#4caf50"),s(I,()=>f(c())),D})(),(()=>{var D=$C(),x=D.firstChild,E=x.firstChild,T=E.nextSibling,H=T.nextSibling,te=H.nextSibling,Y=te.nextSibling,ue=Y.nextSibling;ue.nextSibling;var oe=x.nextSibling,I=oe.firstChild;return D.style.setProperty("margin-top","2rem"),D.style.setProperty("text-align","center"),x.style.setProperty("font-size","0.875rem"),x.style.setProperty("color","var(--text-muted)"),x.style.setProperty("margin-bottom","0.5rem"),s(x,()=>t("common.total"),E),s(x,()=>t("balanceSheet.totalAssets"),T),s(x,()=>t("balanceSheet.totalLiabilities"),te),s(x,()=>t("balanceSheet.totalEquity"),ue),oe.style.setProperty("font-size","1.2rem"),oe.style.setProperty("font-weight","bold"),s(oe,()=>f(n()),I),s(oe,()=>f(o()+c()),null),s(oe,(()=>{var _=fe(()=>Math.abs(n()-(o()+c()))>.01);return()=>_()&&(()=>{var v=kC(),P=v.firstChild,w=P.nextSibling,A=w.nextSibling,y=A.nextSibling;return y.nextSibling,v.style.setProperty("font-size","0.875rem"),v.style.setProperty("color","#f44336"),v.style.setProperty("display","block"),s(v,()=>t("common.error"),w),s(v,()=>f(n()-(o()+c())),y),v})()})(),null),re(_=>(_=Math.abs(n()-(o()+c()))<.01?"#4caf50":"#f44336")!=null?oe.style.setProperty("color",_):oe.style.removeProperty("color")),D})()]}})]}})};At(["click"]);const DC=[{id:"YY_8801",code:"YY_8801",name:"YABA SUR",bussinesId:"YB100423253156428",type:"store",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8802",code:"YY_8802",name:"CENTER",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8803",code:"YY_8803",name:"BISONET",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8804",code:"YY_8804",name:"IRVIN",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8805",code:"YY_8805",name:"KATTY",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8814",code:"YY_8814",name:"YABASUR OR",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8816",code:"YY_8816",name:"YABA GLOBAL",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8818",code:"YY_8818",name:"YABASURAUSTIN",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8844",code:"YY_8844",name:"YABANEBRASKA",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8847",code:"YY_8847",name:"YABAOFICINA AZ",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_3251",code:"YY_3251",name:"YABA FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_32",code:"YY_32",name:"YABA MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_33",code:"YY_33",name:"YABASUR ARIZONA",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8635",code:"YY_8635",name:"FASHION MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8665",code:"YY_8665",name:"IRVIN FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8901",code:"YY_8901",name:"ALMACEN CENTRAL YABA",bussinesId:"YB100423253156428",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01"}],NC=[{id:"1",name:'MacBook Pro 16"',price:2399,quantity:75,category:"Electronics",description:"Apple MacBook Pro 16-inch with M2 Pro chip",sku:"MBP-16-M2P",supplier:"Apple Inc.",minStock:10,location:"Warehouse A",lastUpdated:"2024-01-15"},{id:"2",name:'Dell Monitor 27"',price:299,quantity:35,category:"Electronics",description:"Dell 27-inch 4K UHD Monitor",sku:"DELL-MON-27-4K",supplier:"Dell Technologies",minStock:15,location:"Warehouse B",lastUpdated:"2024-01-14"},{id:"3",name:"Wireless Mouse",price:49.99,quantity:12,category:"Accessories",description:"Ergonomic wireless mouse with precision tracking",sku:"MOUSE-WL-001",supplier:"Logitech",minStock:25,location:"Warehouse A",lastUpdated:"2024-01-13"}],Ns=()=>{const t=new Map;return Lr().forEach(e=>{const r=`${e.productId}-${e.locationId}`;let n=De.getLocationById(e.locationId),i=t.get(r);i||(i={id:r,productId:e.productId,locationId:e.locationId,locationName:n?.name,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,i)),e.movementType==="in"||e.movementType==="transfer"?(e.locationId===e.toLocationId||e.movementType==="in")&&(i.quantity+=e.quantity*1):e.movementType==="out"?i.quantity-=e.quantity*1:e.movementType==="adjustment"&&(i.quantity=e.quantity*1),new Date(e.createdDate)>new Date(i.lastMovementDate)&&(i.lastMovementDate=e.createdDate,i.lastMovementType=e.movementType),i.averageCost=e.unitCost*1,i.availableQuantity=i.quantity*1-i.reservedQuantity*1}),Array.from(t.values())},[ui,gl]=ye([]),[di,vh]=ye(DC),[Lr,Ls]=ye([]),[On,Do]=ye([]),LC=()=>{const t=new Map;return Lr().forEach(e=>{const r=`${e.productId}-${e.locationId}`;let n=t.get(r),i=De.getLocationById(e.locationId);n||(n={id:r,productId:e.productId,locationId:e.locationId,locationName:i?.name,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType==="in"||e.movementType==="transfer"?(e.locationId===e.toLocationId||e.movementType==="in")&&(n.quantity+=e.quantity*1):e.movementType==="out"?n.quantity-=e.quantity*1:e.movementType==="adjustment"&&(n.quantity=e.quantity*1),new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost*1,n.availableQuantity=n.quantity*1-n.reservedQuantity*1}),Array.from(t.values())};Do(LC());const[Ms,pl]=ye(NC),MC={TRANSFER:1,transfer:1},bh=173442384e4,De={get products(){return ui()},get locations(){return di()},get movements(){return Lr()},get stockLevels(){return On()},parseInventoryData:t=>{const e=Object.keys(t).slice(0,900),r=[],n=i=>{let o=t;o[i]?.products&&o[i]?.products?.map(a=>{let c=gp(o[i]?.type),u=a?.price*1||a?.unitCost*1,h=a?.qty*1||a?.quantity*1;u=isNaN(u)?0:u,h=isNaN(h)?0:h;let f={id:o[i]?.ssg_inventory_key,productId:a?.product?.id,productName:a?.product?.label,productSku:a?.product?.code,locationId:o[i]?.store,locationName:o[i]?.store,location:o[i]?.store,movementType:c,quantity:h,unitCost:u,totalCost:u*1*h,minStock:10,referenceNumber:"PO-001",notes:o[i]?.description||o[i]?.notes,createdBy:"admin",createdDate:o[i]?.createDate?new Date(o[i]?.createDate).toISOString():new Date(bh).toISOString(),invoiceId:o[i]?.invoice};if(r.push(f),MC[o[i].movementType]&&o[i]?.fromLocationId){let p=De.getLocationById(o[i]?.fromLocationId);const b={id:o[i]?.ssg_inventory_key,productId:a?.product?.id,productName:a?.product?.label,productSku:a?.product?.code,locationId:o[i]?.fromLocationId,locationName:p?.name||"",movementType:"out",quantity:h*-1,unitCost:u,totalCost:u*-1*h,minStock:10,referenceNumber:o[i]?.referenceNumber,notes:`Transfer to ${o[i]?.locationName}`+(o[i].notes?` - ${o[i].notes}`:""),createdBy:o[i].createdBy,createdDate:o[i]?.createDate?new Date(o[i]?.createDate).toISOString():new Date(bh).toISOString(),invoiceId:o[i]?.invoiceId,toLocationId:o[i]?.locationId,toLocationName:o[i]?.locationName};r.push(b)}})};return e.map(n),r},fecthInventory:async t=>{const e=await qn.getInventory(t),r=De.parseInventoryData(e);De.updMovements(r)},fecthProduct:async t=>{const e=await qn.getProducts(t),r=Object.keys(e),n=o=>{let a=e;return console.log(a[o]),{id:o,name:a[o].name,businessId:a[o].businessId,sku:a[o].code,UPC:a[o].UPC,numCode:a[o].codeN,category:a[o].category,unitCost:a[o].unitCost||0,unitOfMeasure:a[o].unitOfMeasure||a[o].unit,minStockLevel:a[o].minStockLevel,maxStockLevel:a[o].maxStockLevel,isActive:a[o].isActive,description:a[o].description||"",createdDate:a[o].createdAt||new Date().toISOString(),lastModified:a[o].updatedAt||new Date().toISOString()}},i=r.map(n);return De.updProduct(i),i},getProductById:t=>ui().find(e=>e.id===t),updProduct:t=>{gl(t)},getProductsBySku:t=>ui().filter(e=>e.sku.toLowerCase().includes(t.toLowerCase())),getProductsByCategory:t=>ui().filter(e=>e.category===t),getActiveProducts:()=>ui().filter(t=>t.name),getLocationById:t=>di().find(e=>e.id===t),getLocationsByType:t=>di().filter(e=>e.type===t),getActiveLocations:()=>di().filter(t=>t.isActive),getMovementsByProduct:t=>Lr().filter(e=>e.productId===t),updMovements:t=>{Ls([...t]),Do(Ns())},getMovementsByLocation:t=>Lr().filter(e=>e.locationId===t),getMovementsByDateRange:(t,e)=>Lr().filter(r=>r.createdDate>=t&&r.createdDate<=e),getStockByProduct:t=>On().filter(e=>e.productId===t),getStockByLocation:t=>On().filter(e=>e.locationId===t),getStockByProductAndLocation:(t,e)=>On().find(r=>r.productId===t&&r.locationId===e),getTotalStockByProduct:t=>On().filter(e=>e.productId===t).reduce((e,r)=>e*1+r.quantity*1,0),getLastLocationByProduct:t=>{const e=Lr().filter(r=>r.productId===t).sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime());if(e.length>0)return di().find(r=>r.id===e[0].locationId)},getLowStockProducts:()=>(ui()||[])?.map(t=>{const e=On().filter(r=>r.productId===t.id).reduce((r,n)=>r+n.quantity,0);return{...t,currentStock:e}}).filter(t=>t.currentStock<=t.minStockLevel),addInventoryMovement:t=>{const e={...t,id:`mov-${Date.now()}`,createdDate:new Date().toISOString()};Ls(r=>[...r,e]),Do(Ns())},addBulkInventoryMovements:async t=>{const e=[],r=[],n=new Date().toISOString(),i=di().find(c=>c.id===t.locationId);if(!i)return{success:!1,errors:["Invalid location"]};let o;if(t.movementType==="transfer"){if(!t.fromLocationId)return{success:!1,errors:["From location required for transfers"]};if(o=di().find(c=>c.id===t.fromLocationId),!o)return{success:!1,errors:["Invalid from location"]};if(t.fromLocationId===t.locationId)return{success:!1,errors:["From and to locations cannot be the same"]}}if(t.items.forEach((c,u)=>{const h=ui().find(C=>C.id===c.productId);if(!h){e.push(`Item ${u+1}: Product not found`);return}if(c.quantity<=0){e.push(`Item ${u+1}: Quantity must be greater than 0`);return}if(t.movementType==="out"){const C=On().filter(D=>D.productId===c.productId&&D.locationId===t.locationId).reduce((D,x)=>D+x.quantity,0);if(c.quantity>C){e.push(`Item ${u+1}: Insufficient stock. Available: ${C}, Requested: ${c.quantity}`);return}}if(t.movementType==="transfer"){const C=On().filter(D=>D.productId===c.productId&&D.locationId===t.fromLocationId).reduce((D,x)=>D+x.quantity,0);if(c.quantity>C){e.push(`Item ${u+1}: Insufficient stock at ${o?.name}. Available: ${C}, Requested: ${c.quantity}`);return}}const f=c.unitCost||h.unitCost,p=c.quantity*f,b={id:`mov-${Date.now()}-${u}`,productId:h.id,productName:h.name,productSku:h.sku,locationId:t.locationId,locationName:i.name,movementType:t.movementType,quantity:c.quantity,unitCost:f,totalCost:p,minStock:10,referenceNumber:t.referenceNumber||"",notes:c.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:o?.name};if(r.push(b),t.movementType==="transfer"&&o){const C={id:`mov-${Date.now()}-${u}-out`,productId:h.id,productName:h.name,productSku:h.sku,locationId:t.fromLocationId,locationName:o.name,movementType:"out",quantity:c.quantity,unitCost:f,totalCost:p,minStock:10,referenceNumber:t.referenceNumber||"",notes:`Transfer to ${i.name}`+(c.notes?` - ${c.notes}`:""),createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,toLocationId:t.locationId,toLocationName:i.name};r.push(C)}}),e.length>0)return{success:!1,errors:e};Ls(c=>[...c,...r]),Do(Ns()),console.log({bulkRequest:t});const a=await qn.addInventory(t);return console.log({prodResults:a}),{success:!0,errors:[]}},getMovementsByInvoice:t=>Lr().filter(e=>e.invoiceId===t),getInvoiceSummary:t=>{const e=Lr().filter(o=>o.invoiceId===t);if(e.length===0)return null;const r=e.reduce((o,a)=>o+a.totalCost,0),n=new Set(e.map(o=>o.productId)).size,i=e[0];return{invoiceId:t,referenceNumber:i.referenceNumber,movementType:i.movementType,location:i.locationName,fromLocation:i.fromLocationName,productCount:n,totalItems:e.reduce((o,a)=>o+a.quantity,0),totalValue:r,createdDate:i.createdDate,createdBy:i.createdBy}},addProduct:t=>{const e={...t,id:`prod-${Date.now()}`,createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};gl(r=>[...r,e])},addLocation:t=>{const e={...t,id:`loc-${Date.now()}`,createdDate:new Date().toISOString()};vh(r=>[...r,e])},updateProduct:(t,e)=>{gl(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n))},updateLocation:(t,e)=>{vh(r=>r.map(n=>n.id===t?{...n,...e}:n))},updateMovement:(t,e)=>{Ls(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n)),Do(Ns())},get inventory(){return Ms()},addItem(t){const e={...t,id:Date.now().toString(),lastUpdated:new Date().toISOString().split("T")[0]};return pl([...Ms(),e]),e},updateItem(t,e){pl(Ms().map(r=>r.id===t?{...r,...e,lastUpdated:new Date().toISOString().split("T")[0]}:r))},deleteItem(t){pl(Ms().filter(e=>e.id!==t))},getItemById(t){return Lr().find(e=>e.id===t)},getLowStockItems(){return Lr().filter(t=>t.quantity*1<=t.minStock*1)},getTotalValue(){return Lr().reduce((t,e)=>t*1+e.unitCost*1*e.quantity*1,0)}};var _h=q("<div>"),OC=q("<div><div><input type=text autocomplete=off>"),VC=q("<button type=button>+"),BC=q("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div>");const By=t=>{const{t:e}=at(),[r,n]=ye(!1),[i,o]=ye(""),[a,c]=ye(-1),u=Ke(()=>t.value?De.getProductById(t.value):null),h=Ke(()=>{const W=i().toLowerCase();return W?De.getActiveProducts().filter($=>$.name.toLowerCase().includes(W)||$.sku.toLowerCase().includes(W)||$.category.toLowerCase().includes(W)):De.getActiveProducts()}),f=()=>{n(!0),o(""),c(-1)},p=W=>{const $=W.target;o($.value),n(!0),c(-1)},b=W=>{t.onChange(W),n(!1),o(""),c(-1)},C=W=>{const $=h();switch(W.key){case"ArrowDown":W.preventDefault(),c(Z=>Math.min(Z+1,$.length-1));break;case"ArrowUp":W.preventDefault(),c(Z=>Math.max(Z-1,-1));break;case"Enter":W.preventDefault(),a()>=0&&$[a()]&&b($[a()]);break;case"Escape":n(!1),o(""),c(-1);break}},D=W=>{setTimeout(()=>{n(!1),o(""),c(-1)},150)},x=W=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(W),E=W=>De.stockLevels.filter($=>$.productId===W).reduce(($,Z)=>$+Z.quantity,0),T={position:"relative",width:"100%",...t.style},H={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},te={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},Y=W=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid "+W?"var(--primary-color)":"var(--border-color)",background:W?"var(--strip-color)":"transparent",color:W?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),ue={display:"flex","justify-content":"space-between","align-items":"center"},oe={flex:"1"},I={"font-weight":"500","margin-bottom":"0.25rem"},_={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},v={"text-align":"right","font-size":"0.875rem"},P={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},w=()=>r()&&i()?i():u()?`${u().name} (${u().sku})`:"",A={display:"flex","align-items":"stretch",width:"100%"},y={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},he={...H,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"};return(()=>{var W=OC(),$=W.firstChild,Z=$.firstChild;return d($,A),Z.addEventListener("blur",D),Z.$$keydown=C,Z.$$click=f,Z.$$input=p,s($,(()=>{var k=fe(()=>!!t.onAddNew);return()=>k()&&(()=>{var F=VC();return F.addEventListener("mouseleave",V=>{V.currentTarget.style.background="var(--surface-color)",V.currentTarget.style.color="var(--primary-color)"}),F.addEventListener("mouseenter",V=>{V.currentTarget.style.background="var(--primary-color)",V.currentTarget.style.color="white"}),Ii(F,"click",t.onAddNew,!0),d(F,y),re(()=>ut(F,"title",e("inventory.addProduct","Add new product"))),F})()})(),null),s(W,S(Ue,{get when(){return r()},get children(){var k=_h();return s(k,S(Ue,{get when(){return h().length>0},get fallback(){return(()=>{var F=_h();return d(F,P),s(F,(()=>{var V=fe(()=>!!i());return()=>V()?e("inventory.noProductsFound","No products found matching your search."):e("inventory.noProductsAvailable","No products available.")})()),F})()},get children(){return S(Ut,{get each(){return h()},children:(F,V)=>{const z=E(F.id),me=z<=F.minStockLevel;return(()=>{var K=BC(),de=K.firstChild,N=de.firstChild,j=N.firstChild,Q=j.nextSibling,J=Q.firstChild,ce=J.firstChild,ae=J.nextSibling,M=ae.nextSibling,ne=M.nextSibling,pe=ne.nextSibling,ve=N.nextSibling,ee=ve.firstChild,ie=ee.firstChild,R=ee.nextSibling;return K.addEventListener("mouseenter",()=>c(V())),K.$$click=()=>b(F),d(de,ue),d(N,oe),d(j,I),s(j,()=>F.name),d(Q,_),s(J,()=>e("inventory.sku","SKU"),ce),s(J,()=>F.sku,null),s(M,()=>F.category),s(pe,()=>x(F.unitCost)),d(ve,v),ee.style.setProperty("font-weight","600"),(me?"#f44336":"var(--text-primary)")!=null?ee.style.setProperty("color",me?"#f44336":"var(--text-primary)"):ee.style.removeProperty("color"),s(ee,z,ie),s(ee,()=>F.unitOfMeasure,null),R.style.setProperty("color","var(--text-muted)"),s(R,()=>me?e("inventory.lowStock","Low Stock"):e("inventory.inStock","In Stock")),re(L=>d(K,Y(V()===a()),L)),K})()}})}})),re(F=>d(k,te,F)),k}}),null),re(k=>{var F=T,V=he,z=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),me=t.disabled,K=t.required;return k.e=d(W,F,k.e),k.t=d(Z,V,k.t),z!==k.a&&ut(Z,"placeholder",k.a=z),me!==k.o&&(Z.disabled=k.o=me),K!==k.i&&(Z.required=k.i=K),k},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),re(()=>Z.value=w()),W})()};At(["input","click","keydown"]);var Sh=q("<div>"),FC=q("<div><div><input type=text autocomplete=off>"),UC=q("<button type=button>+"),jC=q("<div><div><div><div> </div><div><span>: </span><span></span></div><div>");const Ea=t=>{const{t:e}=at(),[r,n]=ye(!1),[i,o]=ye(""),[a,c]=ye(-1),u=Ke(()=>t.value?De.getLocationById(t.value):null),h=Ke(()=>{let W=De.getActiveLocations();t.filterType&&(W=W.filter(Z=>Z.type===t.filterType));const $=i().toLowerCase();return $?W.filter(Z=>Z.name.toLowerCase().includes($)||Z?.code?.toLowerCase().includes($)||Z?.type?.toLowerCase().includes($)||Z?.address?.toLowerCase().includes($)):W}),f=()=>{n(!0),o(""),c(-1)},p=W=>{const $=W.target;o($.value),n(!0),c(-1)},b=W=>{t.onChange(W.id),n(!1),o(""),c(-1)},C=W=>{const $=h();switch(W.key){case"ArrowDown":W.preventDefault(),c(Z=>Math.min(Z+1,$.length-1));break;case"ArrowUp":W.preventDefault(),c(Z=>Math.max(Z-1,-1));break;case"Enter":W.preventDefault(),a()>=0&&$[a()]&&b($[a()]);break;case"Escape":n(!1),o(""),c(-1);break}},D=W=>{setTimeout(()=>{n(!1),o(""),c(-1)},150)},x=W=>({warehouse:"",store:"",supplier:"",customer:""})[W]||"",E=W=>({warehouse:"#2196F3",store:"#4CAF50",supplier:"#FF9800",customer:"#9C27B0"})[W]||"#757575",T={position:"relative",width:"100%",...t.style},H={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},te={display:"flex","align-items":"stretch",width:"100%"},Y={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},ue={...H,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"},oe={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},I=W=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:W?"var(--strip-color)":"transparent",color:W?"var(--primary-dark)":"var(--text-primary)",transition:"all 0.2s ease"}),_={display:"flex","justify-content":"space-between","align-items":"center"},v={flex:"1"},P={"font-weight":"500","margin-bottom":"0.25rem"},w={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem","align-items":"center"},A=W=>({padding:"0.2rem 0.5rem","border-radius":"var(--border-radius-sm)","font-size":"0.7rem","font-weight":"500",background:E(W),color:"white","text-transform":"uppercase"}),y={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},he=()=>r()&&i()?i():u()?`${u().name} (${u().code})`:"";return(()=>{var W=FC(),$=W.firstChild,Z=$.firstChild;return d($,te),Z.addEventListener("blur",D),Z.$$keydown=C,Z.$$click=f,Z.$$input=p,s($,(()=>{var k=fe(()=>!!t.onAddNew);return()=>k()&&(()=>{var F=UC();return F.addEventListener("mouseleave",V=>{V.currentTarget.style.background="var(--surface-color)",V.currentTarget.style.color="var(--primary-color)"}),F.addEventListener("mouseenter",V=>{V.currentTarget.style.background="var(--primary-color)",V.currentTarget.style.color="white"}),Ii(F,"click",t.onAddNew,!0),d(F,Y),re(()=>ut(F,"title",e("inventory.addLocation","Add new location"))),F})()})(),null),s(W,S(Ue,{get when(){return r()},get children(){var k=Sh();return s(k,S(Ue,{get when(){return h().length>0},get fallback(){return(()=>{var F=Sh();return d(F,y),s(F,(()=>{var V=fe(()=>!!i());return()=>V()?e("inventory.noLocationsFound","No locations found matching your search."):e("inventory.noLocationsAvailable","No locations available.")})()),F})()},get children(){return S(Ut,{get each(){return h()},children:(F,V)=>(()=>{var z=jC(),me=z.firstChild,K=me.firstChild,de=K.firstChild,N=de.firstChild,j=de.nextSibling,Q=j.firstChild,J=Q.firstChild,ce=Q.nextSibling,ae=j.nextSibling;return z.addEventListener("mouseenter",()=>c(V())),z.$$click=()=>b(F),d(me,_),d(K,v),d(de,P),s(de,()=>x(F.type),N),s(de,()=>F.name,null),d(j,w),s(Q,()=>e("inventory.locationCode","Code"),J),s(Q,()=>F.code,null),s(ce,()=>F.type),ae.style.setProperty("font-size","0.75rem"),ae.style.setProperty("color","var(--text-muted)"),ae.style.setProperty("margin-top","0.25rem"),s(ae,()=>F.address),re(M=>{var ne=I(V()===a()),pe=A(F.type);return M.e=d(z,ne,M.e),M.t=d(ce,pe,M.t),M},{e:void 0,t:void 0}),z})()})}})),re(F=>d(k,oe,F)),k}}),null),re(k=>{var F=T,V=ue,z=t.placeholder||e("inventory.searchLocations","Search locations by name, code, or type..."),me=t.disabled,K=t.required;return k.e=d(W,F,k.e),k.t=d(Z,V,k.t),z!==k.a&&ut(Z,"placeholder",k.a=z),me!==k.o&&(Z.disabled=k.o=me),K!==k.i&&(Z.required=k.i=K),k},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),re(()=>Z.value=he()),W})()};At(["input","click","keydown"]);var zC=q("<form><div><label> *</label><input type=text required></div><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text list=categories required><datalist id=categories><option value=Electronics></option><option value=Accessories></option><option value=Office></option><option value=Furniture></option><option value=Software></option><option value=Hardware></option></datalist></div></div><div><label></label><textarea></textarea></div><div><div><label></label><select><option value=pcs></option><option value=kg></option><option value=lbs></option><option value=m></option><option value=ft></option><option value=l></option><option value=gal></option><option value=box></option><option value=pack></option></select></div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div></div><div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div><div></div></div><div><div><label></label><input type=number min=0 step=1></div><div><label></label><input type=number min=1 step=1></div></div><div>"),qC=q("<div>");const Ha=t=>{const{t:e}=at(),[r,n]=ye(""),[i,o]=ye(""),[a,c]=ye(""),[u,h]=ye(""),[f,p]=ye("pcs"),[b,C]=ye(0),[D,x]=ye(0),[E,T]=ye(10),[H,te]=ye(100),[Y,ue]=ye(""),oe=()=>{n(""),o(""),c(""),h(""),p("pcs"),C(0),x(0),T(10),te(100),ue("")},I=$=>{if($.preventDefault(),ue(""),!r().trim()){ue(e("forms.productNameRequired"));return}if(!i().trim()){ue(e("forms.skuRequired"));return}if(!u().trim()){ue(e("forms.categoryRequired"));return}if(b()<0){ue(e("forms.unitCostNotNegative"));return}if(D()<0){ue(e("forms.sellingPriceNotNegative"));return}if(E()<0){ue(e("forms.minStockNotNegative"));return}if(H()<=E()){ue(e("forms.maxStockGreaterThanMin"));return}if(De.getProductsBySku(i()).length>0){ue(e("forms.skuAlreadyExists"));return}const k={name:r().trim(),sku:i().trim().toUpperCase(),description:a().trim(),category:u().trim(),unitOfMeasure:f(),unitCost:b(),sellingPrice:D(),minStockLevel:E(),maxStockLevel:H(),isActive:!0,businessId:"default-business"};De.addProduct(k);const F=`prod-${Date.now()}`;t.onProductAdded&&t.onProductAdded(F),oe(),t.onClose()},_=()=>{oe(),t.onClose()},v={"margin-bottom":"1.5rem"},P={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},w={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},A={...w,cursor:"pointer"},y={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},he={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},W={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"};return S(dr,{get isOpen(){return t.isOpen},onClose:_,get title(){return e("inventory.addNewProduct")},get children(){var $=zC(),Z=$.firstChild,k=Z.firstChild,F=k.firstChild,V=k.nextSibling,z=Z.nextSibling,me=z.firstChild,K=me.firstChild,de=K.firstChild,N=K.nextSibling,j=me.nextSibling,Q=j.firstChild,J=Q.firstChild,ce=Q.nextSibling,ae=z.nextSibling,M=ae.firstChild,ne=M.nextSibling,pe=ae.nextSibling,ve=pe.firstChild,ee=ve.firstChild,ie=ee.nextSibling,R=ie.firstChild,L=R.nextSibling,B=L.nextSibling,ge=B.nextSibling,le=ge.nextSibling,U=le.nextSibling,G=U.nextSibling,Pe=G.nextSibling,_e=Pe.nextSibling,se=ve.nextSibling,be=se.firstChild,X=be.nextSibling,we=pe.nextSibling,ke=we.firstChild,xe=ke.firstChild,Te=xe.nextSibling,Oe=we.nextSibling,We=Oe.firstChild,je=We.firstChild,Ie=je.nextSibling,Ve=We.nextSibling,He=Ve.firstChild,qe=He.nextSibling,Ge=Oe.nextSibling;return $.addEventListener("submit",I),s(k,()=>e("inventory.productName"),F),V.addEventListener("change",Ae=>n(Ae.target.value)),s(K,()=>e("inventory.sku"),de),N.addEventListener("change",Ae=>o(Ae.target.value)),s(Q,()=>e("inventory.category"),J),ce.addEventListener("change",Ae=>h(Ae.target.value)),s(M,()=>e("common.description")),ne.addEventListener("change",Ae=>c(Ae.target.value)),s(ee,()=>e("inventory.unitOfMeasure")),ie.addEventListener("change",Ae=>p(Ae.target.value)),s(R,()=>e("inventory.pieces")),s(L,()=>e("inventory.kilograms")),s(B,()=>e("inventory.pounds")),s(ge,()=>e("inventory.meters")),s(le,()=>e("inventory.feet")),s(U,()=>e("inventory.liters")),s(G,()=>e("inventory.gallons")),s(Pe,()=>e("inventory.boxes")),s(_e,()=>e("inventory.packs")),s(be,()=>e("inventory.unitCost")),X.addEventListener("change",Ae=>C(Number(Ae.target.value))),s(xe,()=>e("inventory.sellingPrice")),Te.addEventListener("change",Ae=>x(Number(Ae.target.value))),s(je,()=>e("inventory.minimumStockLevel")),Ie.addEventListener("change",Ae=>T(Number(Ae.target.value))),s(He,()=>e("inventory.maximumStockLevel")),qe.addEventListener("change",Ae=>te(Number(Ae.target.value))),s($,(()=>{var Ae=fe(()=>!!Y());return()=>Ae()&&(()=>{var rt=qC();return d(rt,y),s(rt,Y),rt})()})(),Ge),d(Ge,he),s(Ge,S(Ne,{variant:"secondary",type:"button",onClick:_,get children(){return e("common.cancel")}}),null),s(Ge,S(Ne,{variant:"primary",type:"submit",get children(){return e("inventory.addProduct")}}),null),re(Ae=>{var rt=v,et=P,ct=w,xt=e("inventory.enterProductName"),_t=W,Ht=P,mt=w,Qt=e("inventory.enterSkuCode"),ht=P,St=w,Lt=e("inventory.enterCategory"),Nt=v,Me=P,Be={...w,"min-height":"80px",resize:"vertical"},Ye=e("inventory.enterProductDescription"),ot=W,kt=P,Qe=A,Ee=P,nt=w,ft=W,Pt=P,sr=w,Rt=W,jt=P,ar=w,Tt=P,Kt=w;return Ae.e=d(Z,rt,Ae.e),Ae.t=d(k,et,Ae.t),Ae.a=d(V,ct,Ae.a),xt!==Ae.o&&ut(V,"placeholder",Ae.o=xt),Ae.i=d(z,_t,Ae.i),Ae.n=d(K,Ht,Ae.n),Ae.s=d(N,mt,Ae.s),Qt!==Ae.h&&ut(N,"placeholder",Ae.h=Qt),Ae.r=d(Q,ht,Ae.r),Ae.d=d(ce,St,Ae.d),Lt!==Ae.l&&ut(ce,"placeholder",Ae.l=Lt),Ae.u=d(ae,Nt,Ae.u),Ae.c=d(M,Me,Ae.c),Ae.w=d(ne,Be,Ae.w),Ye!==Ae.m&&ut(ne,"placeholder",Ae.m=Ye),Ae.f=d(pe,ot,Ae.f),Ae.y=d(ee,kt,Ae.y),Ae.g=d(ie,Qe,Ae.g),Ae.p=d(be,Ee,Ae.p),Ae.b=d(X,nt,Ae.b),Ae.T=d(we,ft,Ae.T),Ae.A=d(xe,Pt,Ae.A),Ae.O=d(Te,sr,Ae.O),Ae.I=d(Oe,Rt,Ae.I),Ae.S=d(je,jt,Ae.S),Ae.W=d(Ie,ar,Ae.W),Ae.C=d(He,Tt,Ae.C),Ae.B=d(qe,Kt,Ae.B),Ae},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),re(()=>V.value=r()),re(()=>N.value=i()),re(()=>ce.value=u()),re(()=>ne.value=a()),re(()=>ie.value=f()),re(()=>X.value=b()),re(()=>Te.value=D()),re(()=>Ie.value=E()),re(()=>qe.value=H()),$}})};var HC=q('<form><div><label> *</label><input type=text required></div><div><div><label> *<button type=button title="Generate code automatically"></button></label><input type=text required><div></div></div><div><label> *</label><select required><option value=warehouse> </option><option value=store> </option><option value=supplier> </option><option value=customer> </option></select><div></div></div></div><div><label> *</label><textarea required></textarea></div><div>'),WC=q("<div><div>:</div><div><span></span><div><div></div><div>"),GC=q("<div>");const au=t=>{const{t:e}=at(),[r,n]=ye(""),[i,o]=ye(""),[a,c]=ye("warehouse"),[u,h]=ye(""),[f,p]=ye(""),b=()=>{n(""),o(""),c("warehouse"),h(""),p("")},C=()=>{if(r()){const w=a()==="warehouse"?"WH":a()==="store"?"ST":a()==="supplier"?"SUP":"CUST",A=r().toUpperCase().replace(/[^A-Z0-9]/g,"").substring(0,3),y=String(Math.floor(Math.random()*1e3)).padStart(3,"0");o(`${w}-${A}-${y}`)}},D=w=>{if(w.preventDefault(),p(""),!r().trim()){p(e("forms.locationNameRequired"));return}if(!i().trim()){p(e("forms.locationCodeRequired"));return}if(!u().trim()){p(e("forms.addressRequired"));return}if(De.locations.filter(W=>W.code.toLowerCase()===i().toLowerCase()).length>0){p(e("forms.locationCodeExists"));return}const y={name:r().trim(),code:i().trim().toUpperCase(),type:a(),address:u().trim(),isActive:!0};De.addLocation(y);const he=`loc-${Date.now()}`;t.onLocationAdded&&t.onLocationAdded(he),b(),t.onClose()},x=()=>{b(),t.onClose()},E={"margin-bottom":"1.5rem"},T={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},H={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},te={...H,cursor:"pointer"},Y={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},ue={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},oe={display:"grid","grid-template-columns":"2fr 1fr",gap:"1rem"},I={"font-size":"0.875rem",color:"var(--text-muted)","margin-top":"0.25rem"},_={padding:"0.25rem 0.5rem","font-size":"0.75rem","margin-left":"0.5rem",background:"var(--background-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",color:"var(--text-muted)"},v=w=>({warehouse:"",store:"",supplier:"",customer:""})[w]||"",P=w=>({warehouse:e("inventory.warehouseDescription"),store:e("inventory.storeDescription"),supplier:e("inventory.supplierDescription"),customer:e("inventory.customerDescription")})[w]||"";return S(dr,{get isOpen(){return t.isOpen},onClose:x,get title(){return e("inventory.addNewLocation")},get children(){var w=HC(),A=w.firstChild,y=A.firstChild,he=y.firstChild,W=y.nextSibling,$=A.nextSibling,Z=$.firstChild,k=Z.firstChild,F=k.firstChild,V=F.nextSibling,z=k.nextSibling,me=z.nextSibling,K=Z.nextSibling,de=K.firstChild,N=de.firstChild,j=de.nextSibling,Q=j.firstChild,J=Q.firstChild,ce=Q.nextSibling,ae=ce.firstChild,M=ce.nextSibling,ne=M.firstChild,pe=M.nextSibling,ve=pe.firstChild,ee=j.nextSibling,ie=$.nextSibling,R=ie.firstChild,L=R.firstChild,B=R.nextSibling,ge=ie.nextSibling;return w.addEventListener("submit",D),s(y,()=>e("inventory.locationName"),he),W.addEventListener("change",le=>n(le.target.value)),d($,oe),s(k,()=>e("inventory.locationCode"),F),V.$$click=C,d(V,_),s(V,()=>e("common.generate")),z.addEventListener("change",le=>o(le.target.value)),s(me,()=>e("inventory.uniqueIdentifierHelp")),s(de,()=>e("inventory.locationType"),N),j.addEventListener("change",le=>c(le.target.value)),s(Q,()=>v("warehouse"),J),s(Q,()=>e("inventory.warehouse"),null),s(ce,()=>v("store"),ae),s(ce,()=>e("inventory.store"),null),s(M,()=>v("supplier"),ne),s(M,()=>e("inventory.supplier"),null),s(pe,()=>v("customer"),ve),s(pe,()=>e("inventory.customer"),null),s(ee,()=>P(a())),s(R,()=>e("common.address"),L),B.addEventListener("change",le=>h(le.target.value)),s(w,(()=>{var le=fe(()=>!!r());return()=>le()&&(()=>{var U=WC(),G=U.firstChild,Pe=G.firstChild,_e=G.nextSibling,se=_e.firstChild,be=se.nextSibling,X=be.firstChild,we=X.nextSibling;return U.style.setProperty("padding","1rem"),U.style.setProperty("background","var(--background-color)"),U.style.setProperty("border-radius","var(--border-radius-sm)"),U.style.setProperty("border","1px solid var(--border-color)"),U.style.setProperty("margin-bottom","1rem"),G.style.setProperty("font-weight","500"),G.style.setProperty("margin-bottom","0.5rem"),s(G,()=>e("common.preview"),Pe),_e.style.setProperty("display","flex"),_e.style.setProperty("align-items","center"),_e.style.setProperty("gap","0.5rem"),se.style.setProperty("font-size","1.2rem"),s(se,()=>v(a())),X.style.setProperty("font-weight","600"),s(X,r),we.style.setProperty("font-size","0.875rem"),we.style.setProperty("color","var(--text-muted)"),s(we,(()=>{var ke=fe(()=>!!i());return()=>ke()&&`${i()}  `})(),null),s(we,a,null),U})()})(),ge),s(w,(()=>{var le=fe(()=>!!f());return()=>le()&&(()=>{var U=GC();return d(U,Y),s(U,f),U})()})(),ge),d(ge,ue),s(ge,S(Ne,{variant:"secondary",type:"button",onClick:x,get children(){return e("common.cancel")}}),null),s(ge,S(Ne,{variant:"primary",type:"submit",get children(){return e("inventory.addLocation")}}),null),re(le=>{var U=E,G=T,Pe=H,_e=e("inventory.enterLocationName"),se=T,be=H,X=e("inventory.enterUniqueCode"),we=I,ke=T,xe=te,Te=I,Oe=E,We=T,je={...H,"min-height":"100px",resize:"vertical"},Ie=e("inventory.enterCompleteAddress");return le.e=d(A,U,le.e),le.t=d(y,G,le.t),le.a=d(W,Pe,le.a),_e!==le.o&&ut(W,"placeholder",le.o=_e),le.i=d(k,se,le.i),le.n=d(z,be,le.n),X!==le.s&&ut(z,"placeholder",le.s=X),le.h=d(me,we,le.h),le.r=d(de,ke,le.r),le.d=d(j,xe,le.d),le.l=d(ee,Te,le.l),le.u=d(ie,Oe,le.u),le.c=d(R,We,le.c),le.w=d(B,je,le.w),Ie!==le.m&&ut(B,"placeholder",le.m=Ie),le},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),re(()=>W.value=r()),re(()=>z.value=i()),re(()=>j.value=a()),re(()=>B.value=u()),w}})};At(["click"]);var KC=q("<form><div>"),Ph=q("<div><label> *"),YC=q("<div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment>"),QC=q("<div><label>"),JC=q("<div><label> *</label><input type=number min=0 step=1 required>"),XC=q("<div><label></label><input type=number min=0 step=0.01>"),ZC=q("<div><label></label><input type=text>"),eA=q("<div><label></label><textarea>"),tA=q("<div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span>:</span><span> "),rA=q("<div><div><span>:</span><span>"),nA=q("<div>");const iA=t=>{const{t:e}=at(),[r,n]=ye({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""}),[i,o]=ye(""),[a,c]=ye(""),[u,h]=ye("in"),[f,p]=ye(0),[b,C]=ye(0),[D,x]=ye(""),[E,T]=ye(""),[H,te]=ye(""),[Y,ue]=ye(""),[oe,I]=ye(!1),[_,v]=ye(!1),P=()=>t.mode==="movement",w=Ke(()=>i()?De.getProductById(i()):null),A=Ke(()=>a()?De.getLocationById(a()):null),y=Ke(()=>H()?De.getLocationById(H()):null),he=Ke(()=>f()*b()),W=Ke(()=>!i()||!a()?0:De.getStockByProductAndLocation(i(),a())?.quantity||0),$=[{value:"Electronics",label:"Electronics"},{value:"Accessories",label:"Accessories"},{value:"Furniture",label:"Furniture"},{value:"Office Supplies",label:"Office Supplies"},{value:"Software",label:"Software"},{value:"Hardware",label:"Hardware"},{value:"Consumables",label:"Consumables"}],Z=[{value:"Warehouse A",label:"Warehouse A"},{value:"Warehouse B",label:"Warehouse B"},{value:"Warehouse C",label:"Warehouse C"},{value:"Storage Room",label:"Storage Room"},{value:"Main Office",label:"Main Office"}],k={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},F=()=>{o(""),c(""),h("in"),p(0),C(0),x(""),T(""),te(""),ue("")},V=()=>{n({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""})},z=pe=>{if(pe.preventDefault(),P()){if(ue(""),!i()){ue(e("forms.selectProduct"));return}if(!a()){ue(e("forms.selectLocation"));return}if(f()<=0){ue(e("forms.quantityGreaterThanZero"));return}if(b()<0){ue(e("forms.unitCostNotNegative"));return}if(u()==="transfer"&&!H()){ue(e("forms.selectFromLocation"));return}if(u()==="transfer"&&H()===a()){ue(e("forms.sameLocationError"));return}if(u()==="out"&&f()>W()){ue(e("forms.insufficientStock",{currentStock:W()}));return}const ve=w(),ee=A(),ie={productId:ve.id,productName:ve.name,productSku:ve.sku,locationId:ee.id,locationName:ee.name,movementType:u(),quantity:f(),unitCost:b()||ve.unitCost,totalCost:he()||f()*ve.unitCost,referenceNumber:D()||`AUTO-${Date.now()}`,notes:E(),createdBy:"admin",fromLocationId:u()==="transfer"?H():void 0,fromLocationName:u()==="transfer"?y()?.name:void 0};De.addInventoryMovement(ie),F()}else{const ve=r();if(!ve.name||!ve.price||!ve.quantity||!ve.category||!ve.sku||!ve.supplier||!ve.minStock||!ve.location){alert(e("forms.fillAllRequired"));return}const ee={name:ve.name,price:parseFloat(ve.price),quantity:parseInt(ve.quantity),category:ve.category,description:ve.description,sku:ve.sku,supplier:ve.supplier,minStock:parseInt(ve.minStock),location:ve.location};De.addItem(ee),V()}t.onClose()},me=(pe,ve)=>{n(ee=>({...ee,[pe]:ve}))},K=()=>{P()?F():V(),t.onClose()},de=pe=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(pe),N={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},j={...N,cursor:"pointer"},Q={color:"#f44336","font-size":"0.875rem","margin-top":"0.5rem"},J={padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},ce={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},ae={"font-weight":"500",color:"var(--text-muted)"},M={"font-weight":"600",color:"var(--text-primary)"},ne=()=>P()?e("inventory.addMovement"):e("inventory.addNewItem");return S(dr,{get isOpen(){return t.isOpen},onClose:K,get title(){return ne()},get children(){return[(()=>{var pe=KC(),ve=pe.firstChild;return pe.addEventListener("submit",z),s(pe,(()=>{var ee=fe(()=>!!P());return()=>ee()?[(()=>{var ie=Ph(),R=ie.firstChild,L=R.firstChild;return ie.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),s(R,()=>e("inventory.product"),L),s(ie,S(By,{get value(){return i()},onChange:B=>{o(B);const ge=De.getProductById(B);ge&&C(ge.unitCost)},get placeholder(){return e("inventory.searchProductsPlaceholder")},onAddNew:()=>I(!0),required:!0}),null),ie})(),(()=>{var ie=YC(),R=ie.firstChild,L=R.firstChild,B=R.nextSibling,ge=B.firstChild,le=ge.nextSibling,U=le.nextSibling,G=U.nextSibling;return ie.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),s(R,()=>e("inventory.movementType"),L),B.addEventListener("change",Pe=>h(Pe.target.value)),s(ge,()=>e("inventory.stockInPurchase")),s(le,()=>e("inventory.stockOutSale")),s(U,()=>e("inventory.transferBetween")),s(G,()=>e("inventory.stockAdjustment")),re(Pe=>d(B,j,Pe)),re(()=>B.value=u()),ie})(),fe(()=>fe(()=>u()==="transfer")()&&(()=>{var ie=Ph(),R=ie.firstChild,L=R.firstChild;return ie.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),s(R,()=>e("inventory.fromLocation"),L),s(ie,S(Ea,{get value(){return H()},onChange:B=>te(B),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>v(!0),required:!0}),null),ie})()),(()=>{var ie=QC(),R=ie.firstChild;return ie.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),s(R,(()=>{var L=fe(()=>u()==="transfer");return()=>L()?e("inventory.toLocation")+" *":e("inventory.locationName")+" *"})()),s(ie,S(Ea,{get value(){return a()},onChange:L=>c(L),get placeholder(){return fe(()=>u()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>v(!0),required:!0}),null),ie})(),fe(()=>fe(()=>!!(w()&&A()))()&&(()=>{var ie=tA(),R=ie.firstChild,L=R.firstChild,B=L.firstChild,ge=L.nextSibling,le=ge.firstChild,U=R.nextSibling,G=U.firstChild,Pe=G.firstChild,_e=G.nextSibling,se=U.nextSibling,be=se.firstChild,X=be.firstChild,we=be.nextSibling,ke=we.firstChild;return s(L,()=>e("inventory.currentStockAt",{location:A()?.name}),B),s(ge,W,le),s(ge,()=>w()?.unitOfMeasure,null),s(G,()=>e("inventory.productCost"),Pe),s(_e,()=>de(w()?.unitCost||0)),s(be,()=>e("inventory.minStockLevel"),X),s(we,()=>w()?.minStockLevel,ke),s(we,()=>w()?.unitOfMeasure,null),re(xe=>{var Te=J,Oe=ce,We=ae,je=M,Ie=ce,Ve=ae,He=M,qe=ce,Ge=ae,Ae=M;return xe.e=d(ie,Te,xe.e),xe.t=d(R,Oe,xe.t),xe.a=d(L,We,xe.a),xe.o=d(ge,je,xe.o),xe.i=d(U,Ie,xe.i),xe.n=d(G,Ve,xe.n),xe.s=d(_e,He,xe.s),xe.h=d(se,qe,xe.h),xe.r=d(be,Ge,xe.r),xe.d=d(we,Ae,xe.d),xe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),ie})()),(()=>{var ie=JC(),R=ie.firstChild,L=R.firstChild,B=R.nextSibling;return ie.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),s(R,()=>e("inventory.quantity"),L),B.addEventListener("change",ge=>p(Number(ge.target.value))),re(ge=>d(B,N,ge)),re(()=>B.value=f()),ie})(),(()=>{var ie=XC(),R=ie.firstChild,L=R.nextSibling;return ie.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),s(R,()=>e("inventory.unitCost")),L.addEventListener("change",B=>C(Number(B.target.value))),re(B=>{var ge=N,le=e("inventory.willUseDefaultCost");return B.e=d(L,ge,B.e),le!==B.t&&ut(L,"placeholder",B.t=le),B},{e:void 0,t:void 0}),re(()=>L.value=b()),ie})(),fe(()=>fe(()=>f()>0&&b()>0)()&&(()=>{var ie=rA(),R=ie.firstChild,L=R.firstChild,B=L.firstChild,ge=L.nextSibling;return s(L,()=>e("inventory.totalCost"),B),s(ge,()=>de(he())),re(le=>{var U=J,G=ce,Pe=ae,_e={...M,"font-size":"1.2rem",color:"var(--primary-color)"};return le.e=d(ie,U,le.e),le.t=d(R,G,le.t),le.a=d(L,Pe,le.a),le.o=d(ge,_e,le.o),le},{e:void 0,t:void 0,a:void 0,o:void 0}),ie})()),(()=>{var ie=ZC(),R=ie.firstChild,L=R.nextSibling;return ie.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),s(R,()=>e("common.referenceNumber")),L.addEventListener("change",B=>x(B.target.value)),re(B=>{var ge=N,le=e("common.referenceNumberPlaceholder");return B.e=d(L,ge,B.e),le!==B.t&&ut(L,"placeholder",B.t=le),B},{e:void 0,t:void 0}),re(()=>L.value=D()),ie})(),(()=>{var ie=eA(),R=ie.firstChild,L=R.nextSibling;return ie.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),s(R,()=>e("common.notes")),L.addEventListener("change",B=>T(B.target.value)),re(B=>{var ge={...N,"min-height":"100px",resize:"vertical"},le=e("inventory.additionalNotesPlaceholder");return B.e=d(L,ge,B.e),le!==B.t&&ut(L,"placeholder",B.t=le),B},{e:void 0,t:void 0}),re(()=>L.value=E()),ie})(),fe(()=>fe(()=>!!Y())()&&(()=>{var ie=nA();return d(ie,Q),s(ie,Y),ie})())]:[S(Ct,{get label(){return e("inventory.itemName")},get value(){return r().name},onChange:ie=>me("name",ie),get placeholder(){return e("inventory.enterItemName")},required:!0}),S(Ct,{get label(){return e("inventory.sku")},get value(){return r().sku},onChange:ie=>me("sku",ie),get placeholder(){return e("inventory.enterSkuCode")},required:!0}),S(yr,{get label(){return e("inventory.category")},get value(){return r().category},onChange:ie=>me("category",ie),options:$,required:!0}),S(Ct,{get label(){return e("common.description")},get value(){return r().description},onChange:ie=>me("description",ie),get placeholder(){return e("inventory.enterItemDescription")}}),S(Ct,{get label(){return e("common.price")},type:"number",get value(){return r().price},onChange:ie=>me("price",ie),get placeholder(){return e("common.enterPrice")},required:!0}),S(Ct,{get label(){return e("inventory.quantity")},type:"number",get value(){return r().quantity},onChange:ie=>me("quantity",ie),get placeholder(){return e("inventory.enterQuantity")},required:!0}),S(Ct,{get label(){return e("inventory.minimumStock")},type:"number",get value(){return r().minStock},onChange:ie=>me("minStock",ie),get placeholder(){return e("inventory.enterMinStockLevel")},required:!0}),S(Ct,{get label(){return e("inventory.supplier")},get value(){return r().supplier},onChange:ie=>me("supplier",ie),get placeholder(){return e("inventory.enterSupplierName")},required:!0}),S(yr,{get label(){return e("inventory.location")},get value(){return r().location},onChange:ie=>me("location",ie),options:Z,required:!0})]})(),ve),d(ve,k),s(ve,S(Ne,{variant:"secondary",type:"button",onClick:K,get children(){return e("common.cancel")}}),null),s(ve,S(Ne,{variant:"primary",type:"submit",get children(){return fe(()=>!!P())()?e("inventory.addMovement"):e("inventory.addItem")}}),null),pe})(),S(Ha,{get isOpen(){return oe()},onClose:()=>I(!1),onProductAdded:pe=>{o(pe),I(!1)}}),S(au,{get isOpen(){return _()},onClose:()=>v(!1),onLocationAdded:pe=>{u()==="transfer"&&!H()?te(pe):c(pe),v(!1)}})]}})};At(["input","keydown"]);var oA=q("<form><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text required></div></div><div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><div><label></label></div></div><div><div><h3></h3></div></div><div><label></label><textarea></textarea></div><div>"),sA=q("<div><label> *"),aA=q("<div><div></div><div></div><div></div><div></div><div>"),vl=q("<div>"),lA=q("<div><input type=number min=0 step=1 required><input type=number min=0 step=0.01><input type=text>"),cA=q("<div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span>"),uA=q("<div> ");const dA=t=>{const{t:e}=at(),[r,n]=ye(`INV-${Date.now()}`),[i,o]=ye(""),[a,c]=ye("in"),[u,h]=ye(""),[f,p]=ye(""),[b,C]=ye(""),[D,x]=ye([]),[E,T]=ye([]),[H,te]=ye(!1),[Y,ue]=ye(!1),oe=()=>{x(J=>[...J,{productId:"",quantity:0,unitCost:0,notes:""}])},I=J=>{x(ce=>ce.filter((ae,M)=>M!==J))},_=(J,ce,ae)=>{x(M=>M.map((ne,pe)=>pe===J?{...ne,[ce]:ae}:ne))},v=()=>{n(`INV-${Date.now()}`),o(""),c("in"),h(""),p(""),C(""),x([]),T([])},P=async J=>{J.preventDefault(),T([]);const ce=[];if(i()||ce.push(e("forms.referenceNumberRequired")),u()||ce.push(e("forms.locationRequired")),a()==="transfer"&&!f()&&ce.push(e("forms.fromLocationRequired")),D().length===0&&ce.push(e("forms.atLeastOneProduct")),D().forEach((ne,pe)=>{ne.productId||ce.push(e("forms.itemProductRequired","Product is required for item {{index}}",{index:pe+1})),ne.quantity<=0&&ce.push(e("forms.itemQuantityRequired","Quantity must be greater than 0 for item {{index}}",{index:pe+1}))}),ce.length>0){T(ce);return}const ae={ssg_inventory_key:js(),invoiceId:r(),referenceNumber:i(),movementType:a(),type:Ml(a()),locationId:u(),fromLocationId:a()==="transfer"?f():void 0,items:D(),products:D(),generalNotes:b(),description:b(),invoice:i(),store:u(),createdBy:"admin",createDate:new Date().toISOString()};console.log(ae);const M=await De.addBulkInventoryMovements(ae);console.log(M),M.success?(v(),t.onClose()):T(M.errors)},w=()=>{v(),t.onClose()},A=Ke(()=>D().reduce((J,ce)=>{const ae=De.getProductById(ce.productId),M=ce.unitCost||ae?.unitCost||0;return J+ce.quantity*M},0)),y=Ke(()=>D().reduce((J,ce)=>J+ce.quantity,0)),he={"margin-bottom":"1.5rem"},W={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},$={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},Z={...$,cursor:"pointer"},k={display:"grid",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},F={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},V={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem","padding-left":"0.75rem"},z={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},me={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},K={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},de={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},N=J=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(J),j=J=>({in:e("inventory.purchaseReceive"),out:e("inventory.saleIssue"),transfer:e("inventory.transfer"),adjustment:e("inventory.adjustment")})[J]||J,Q=async J=>{await De.fecthInventory(J),await De.fecthProduct(J)};return hn(()=>{Q("prod")}),S(dr,{get isOpen(){return t.isOpen},onClose:w,get title(){return e("inventory.bulkMovement")},get children(){return[(()=>{var J=oA(),ce=J.firstChild,ae=ce.firstChild,M=ae.firstChild,ne=M.firstChild,pe=M.nextSibling,ve=ae.nextSibling,ee=ve.firstChild,ie=ee.firstChild,R=ee.nextSibling,L=ce.nextSibling,B=L.firstChild,ge=B.firstChild,le=B.nextSibling,U=le.firstChild,G=U.nextSibling,Pe=G.nextSibling,_e=Pe.nextSibling,se=L.nextSibling,be=se.firstChild,X=be.firstChild,we=se.nextSibling,ke=we.firstChild,xe=ke.firstChild,Te=we.nextSibling,Oe=Te.firstChild,We=Oe.nextSibling,je=Te.nextSibling;return J.addEventListener("submit",P),ce.style.setProperty("display","grid"),ce.style.setProperty("grid-template-columns","1fr 1fr"),ce.style.setProperty("gap","1rem"),ce.style.setProperty("margin-bottom","1.5rem"),s(M,()=>e("common.invoiceDocumentId"),ne),pe.addEventListener("change",Ie=>n(Ie.target.value)),s(ee,()=>e("common.referenceNumber"),ie),R.addEventListener("change",Ie=>o(Ie.target.value)),s(B,()=>e("inventory.movementType"),ge),le.addEventListener("change",Ie=>c(Ie.target.value)),s(U,()=>e("inventory.purchaseReceive")),s(G,()=>e("inventory.saleIssue")),s(Pe,()=>e("inventory.transfer")),s(_e,()=>e("inventory.adjustment")),se.style.setProperty("display","grid"),se.style.setProperty("gap","1rem"),se.style.setProperty("margin-bottom","1.5rem"),s(se,(()=>{var Ie=fe(()=>a()==="transfer");return()=>Ie()&&(()=>{var Ve=sA(),He=Ve.firstChild,qe=He.firstChild;return s(He,()=>e("inventory.fromLocation"),qe),s(Ve,S(Ea,{get value(){return f()},onChange:Ge=>p(Ge),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>ue(!0),required:!0}),null),re(Ge=>d(He,W,Ge)),Ve})()})(),be),s(X,(()=>{var Ie=fe(()=>a()==="transfer");return()=>Ie()?e("inventory.toLocation")+" *":e("inventory.location")+" *"})()),s(be,S(Ea,{get value(){return u()},onChange:Ie=>h(Ie),get placeholder(){return fe(()=>a()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>ue(!0),required:!0}),null),ke.style.setProperty("display","flex"),ke.style.setProperty("justify-content","space-between"),ke.style.setProperty("align-items","center"),ke.style.setProperty("margin-bottom","1rem"),xe.style.setProperty("margin","0"),xe.style.setProperty("font-size","1.1rem"),s(xe,()=>e("inventory.products")),s(ke,S(Ne,{variant:"outline",type:"button",onClick:oe,get children(){return e("inventory.addProduct")}}),null),s(we,(()=>{var Ie=fe(()=>D().length>0);return()=>Ie()&&[(()=>{var Ve=aA(),He=Ve.firstChild,qe=He.nextSibling,Ge=qe.nextSibling,Ae=Ge.nextSibling;return d(Ve,V),s(He,()=>e("inventory.product")),s(qe,()=>e("inventory.quantity")),s(Ge,()=>e("inventory.unitCost")),s(Ae,()=>e("common.notes")),Ve})(),S(Ut,{get each(){return D()},children:(Ve,He)=>[(()=>{var qe=vl();return d(qe,k),s(qe,S(By,{get value(){return Ve.productId},onChange:Ge=>{_(He(),"productId",Ge.id);let Ae={id:Ge.id,label:Ge.name,code:Ge.sku};_(He(),"product",Ae);const rt=De.getProductById(Ge.id);rt&&!Ve.unitCost&&_(He(),"unitCost",rt.unitCost)},get placeholder(){return e("inventory.searchProduct")},onAddNew:()=>te(!0),required:!0})),qe})(),(()=>{var qe=lA(),Ge=qe.firstChild,Ae=Ge.nextSibling,rt=Ae.nextSibling;return d(qe,F),Ge.addEventListener("change",et=>_(He(),"quantity",Number(et.target.value))),Ae.addEventListener("change",et=>_(He(),"unitCost",Number(et.target.value))),rt.addEventListener("change",et=>_(He(),"notes",et.target.value)),s(qe,S(Ne,{variant:"outline",size:"sm",type:"button",onClick:()=>I(He()),style:{color:"#f44336","border-color":"#f44336"},get children(){return e("common.remove")}}),null),re(et=>{var ct=$,xt=$,_t=e("common.auto"),Ht=$,mt=e("common.optionalNotes");return et.e=d(Ge,ct,et.e),et.t=d(Ae,xt,et.t),_t!==et.a&&ut(Ae,"placeholder",et.a=_t),et.o=d(rt,Ht,et.o),mt!==et.i&&ut(rt,"placeholder",et.i=mt),et},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),re(()=>Ge.value=Ve.quantity),re(()=>Ae.value=Ve.unitCost),re(()=>rt.value=Ve.notes),qe})()]})]})(),null),s(we,(()=>{var Ie=fe(()=>D().length===0);return()=>Ie()&&(()=>{var Ve=vl();return Ve.style.setProperty("text-align","center"),Ve.style.setProperty("padding","2rem"),Ve.style.setProperty("background","var(--background-color)"),Ve.style.setProperty("border-radius","var(--border-radius-sm)"),Ve.style.setProperty("border","1px solid var(--border-color)"),Ve.style.setProperty("color","var(--text-muted)"),s(Ve,()=>e("inventory.noProductsAdded")),Ve})()})(),null),s(J,(()=>{var Ie=fe(()=>D().length>0);return()=>Ie()&&(()=>{var Ve=cA(),He=Ve.firstChild,qe=He.nextSibling,Ge=qe.firstChild,Ae=Ge.firstChild,rt=Ge.nextSibling,et=qe.nextSibling,ct=et.firstChild,xt=ct.firstChild,_t=ct.nextSibling,Ht=et.nextSibling,mt=Ht.firstChild,Qt=mt.firstChild,ht=mt.nextSibling,St=Ht.nextSibling,Lt=St.firstChild,Nt=Lt.firstChild,Me=Lt.nextSibling;return d(Ve,z),He.style.setProperty("margin","0 0 1rem 0"),He.style.setProperty("font-size","1rem"),s(He,()=>e("common.summary")),s(Ge,()=>e("inventory.totalProducts"),Ae),rt.style.setProperty("font-weight","600"),s(rt,()=>D().length),s(ct,()=>e("inventory.totalItems"),xt),_t.style.setProperty("font-weight","600"),s(_t,y),s(mt,()=>e("inventory.totalValue"),Qt),ht.style.setProperty("font-weight","600"),ht.style.setProperty("color","var(--primary-color)"),s(ht,()=>N(A())),s(Lt,()=>e("inventory.movementType"),Nt),Me.style.setProperty("font-weight","600"),s(Me,()=>j(a())),re(Be=>{var Ye=me,ot=me,kt=me,Qe=me;return Be.e=d(qe,Ye,Be.e),Be.t=d(et,ot,Be.t),Be.a=d(Ht,kt,Be.a),Be.o=d(St,Qe,Be.o),Be},{e:void 0,t:void 0,a:void 0,o:void 0}),Ve})()})(),Te),s(Oe,()=>e("common.generalNotes")),We.addEventListener("change",Ie=>C(Ie.target.value)),s(J,(()=>{var Ie=fe(()=>E().length>0);return()=>Ie()&&(()=>{var Ve=vl();return d(Ve,K),s(Ve,S(Ut,{get each(){return E()},children:He=>(()=>{var qe=uA();return qe.firstChild,s(qe,He,null),qe})()})),Ve})()})(),je),d(je,de),s(je,S(Ne,{variant:"secondary",type:"button",onClick:w,get children(){return e("common.cancel")}}),null),s(je,S(Ne,{variant:"primary",type:"submit",get children(){return e("inventory.createMovement")}}),null),re(Ie=>{var Ve=W,He=$,qe=W,Ge=$,Ae=e("common.referenceNumberPlaceholder"),rt=he,et=W,ct=Z,xt=a()==="transfer"?"1fr 1fr":"1fr",_t=W,Ht=he,mt=he,Qt=W,ht={...$,"min-height":"80px",resize:"vertical"},St=e("inventory.generalNotesPlaceholder");return Ie.e=d(M,Ve,Ie.e),Ie.t=d(pe,He,Ie.t),Ie.a=d(ee,qe,Ie.a),Ie.o=d(R,Ge,Ie.o),Ae!==Ie.i&&ut(R,"placeholder",Ie.i=Ae),Ie.n=d(L,rt,Ie.n),Ie.s=d(B,et,Ie.s),Ie.h=d(le,ct,Ie.h),xt!==Ie.r&&((Ie.r=xt)!=null?se.style.setProperty("grid-template-columns",xt):se.style.removeProperty("grid-template-columns")),Ie.d=d(X,_t,Ie.d),Ie.l=d(we,Ht,Ie.l),Ie.u=d(Te,mt,Ie.u),Ie.c=d(Oe,Qt,Ie.c),Ie.w=d(We,ht,Ie.w),St!==Ie.m&&ut(We,"placeholder",Ie.m=St),Ie},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),re(()=>pe.value=r()),re(()=>R.value=i()),re(()=>le.value=a()),re(()=>We.value=b()),J})(),S(Ha,{get isOpen(){return H()},onClose:()=>te(!1),onProductAdded:J=>{te(!1)}}),S(au,{get isOpen(){return Y()},onClose:()=>ue(!1),onLocationAdded:J=>{a()==="transfer"&&!f()?p(J):h(J),ue(!1)}})]}})};var hA=q("<div><div></div><div></div><div></div><div>"),mA=q("<div><strong>:</strong> "),fA=q("<div><div><span></span><span></span></div><div><span></span><span> </span></div><div><span></span><span> </span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),yA=q("<div>");const gA=t=>{const{t:e}=at(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},i={"font-weight":"600",color:"var(--text-primary)"},o={"text-align":"center","margin-bottom":"2rem"},a={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},c={color:"var(--text-muted)","font-size":"1rem"},u={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"1rem"},h=(x,E)=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:x>E?"#d4edda":"#f8d7da",color:x>E?"#155724":"#721c24"}),f={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},p={"margin-bottom":"1.5rem",padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",color:"var(--text-secondary)"};if(!t.item)return null;const b=x=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(x),C=x=>new Date(x).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),D=t.item.price*t.item.quantity;return S(dr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.itemDetails")},get children(){return[(()=>{var x=hA(),E=x.firstChild,T=E.nextSibling,H=T.nextSibling,te=H.nextSibling;return d(x,o),d(E,a),s(E,()=>t.item.name),d(T,c),s(T,()=>t.item.category),d(H,u),s(H,()=>b(t.item.price)),s(te,(()=>{var Y=fe(()=>t.item.quantity>t.item.minStock);return()=>Y()?e("inventory.inStock"):e("inventory.lowStockAlert")})()),re(Y=>d(te,h(t.item.quantity,t.item.minStock),Y)),x})(),(()=>{var x=mA(),E=x.firstChild,T=E.firstChild;return E.nextSibling,d(x,p),s(E,()=>e("common.description"),T),s(x,()=>t.item.description,null),x})(),(()=>{var x=fA(),E=x.firstChild,T=E.firstChild,H=T.nextSibling,te=E.nextSibling,Y=te.firstChild,ue=Y.nextSibling,oe=ue.firstChild,I=te.nextSibling,_=I.firstChild,v=_.nextSibling,P=v.firstChild,w=I.nextSibling,A=w.firstChild,y=A.nextSibling,he=w.nextSibling,W=he.firstChild,$=W.nextSibling,Z=he.nextSibling,k=Z.firstChild,F=k.nextSibling,V=Z.nextSibling,z=V.firstChild,me=z.nextSibling;return s(T,()=>e("inventory.sku")),s(H,()=>t.item.sku),s(Y,()=>e("inventory.quantity")),s(ue,()=>t.item.quantity,oe),s(ue,()=>e("common.units"),null),s(_,()=>e("inventory.minimumStock")),s(v,()=>t.item.minStock,P),s(v,()=>e("common.units"),null),s(A,()=>e("inventory.totalValue")),s(y,()=>b(D)),s(W,()=>e("inventory.supplier")),s($,()=>t.item.supplier),s(k,()=>e("inventory.location")),s(F,()=>t.item.location),s(z,()=>e("common.lastUpdated")),s(me,()=>C(t.item.lastUpdated)),re(K=>{var de=r,N=n,j=i,Q=r,J=n,ce=i,ae=r,M=n,ne=i,pe=r,ve=n,ee=i,ie=r,R=n,L=i,B=r,ge=n,le=i,U=r,G=n,Pe=i;return K.e=d(E,de,K.e),K.t=d(T,N,K.t),K.a=d(H,j,K.a),K.o=d(te,Q,K.o),K.i=d(Y,J,K.i),K.n=d(ue,ce,K.n),K.s=d(I,ae,K.s),K.h=d(_,M,K.h),K.r=d(v,ne,K.r),K.d=d(w,pe,K.d),K.l=d(A,ve,K.l),K.u=d(y,ee,K.u),K.c=d(he,ie,K.c),K.w=d(W,R,K.w),K.m=d($,L,K.m),K.f=d(Z,B,K.f),K.y=d(k,ge,K.y),K.g=d(F,le,K.g),K.p=d(V,U,K.p),K.b=d(z,G,K.b),K.T=d(me,Pe,K.T),K},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),x})(),(()=>{var x=yA();return d(x,f),s(x,S(Ne,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(x,S(Ne,{variant:"primary",onClick:()=>{console.log("Edit item:",t.item.id)},get children(){return e("common.editItem")}}),null),x})()]}})};var pA=q("<div>"),vA=q("<button type=button>"),bA=q("<div> "),wh=q("<div>"),_A=q("<div><div><input type=text autocomplete=off>"),SA=q("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div>"),PA=q("<span> ");const wA=t=>{const{t:e}=at(),[r,n]=ye(""),[i,o]=ye(!1),[a,c]=ye(null),[u,h]=ye([]),[f,p]=ye(!1),[b,C]=ye(-1),[D,x]=ye(null),E=t.searchDelay||300;t.maxResults;const T=async de=>{if(!de.trim()||de.trim().length<3){h([]),t.onSearchResults?.([]);return}try{o(!0),c(null);try{console.log("apiResults",de),t.onSearchResults?.(de)}catch(N){console.warn("API search failed, using local fallback:",N),c("API search failed, showing local results")}}catch(N){const j=N instanceof Error?N.message:"Search failed";c(j),h([]),t.onSearchResults?.([])}finally{o(!1)}},H=de=>{const j=de.target.value;n(j),c(null),console.log(),t.showResults,D()&&clearTimeout(D());const Q=setTimeout(()=>{T(j)},E);x(Q)},te=de=>{n(de.name),p(!1),C(-1),t.onInventorySelect?.(de)},Y=de=>{if(!(!f()||u().length===0))switch(de.key){case"ArrowDown":de.preventDefault(),C(N=>Math.min(N+1,u().length-1));break;case"ArrowUp":de.preventDefault(),C(N=>Math.max(N-1,-1));break;case"Enter":de.preventDefault(),b()>=0&&u()[b()]&&te(u()[b()]);break;case"Escape":p(!1),C(-1);break}},ue=()=>{t.showResults!==!1&&u().length>0&&p(!0)},oe=()=>{setTimeout(()=>{p(!1),C(-1)},150)},I=()=>{n(""),h([]),c(null),p(!1),C(-1),t.onSearchResults?.([]),D()&&(clearTimeout(D()),x(null))},_=de=>De.stockLevels.filter(N=>N.inventoryId===de).reduce((N,j)=>N+j.quantity,0),v=de=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(de),P={position:"relative",width:"100%",...t.style},w={position:"relative",display:"flex","align-items":"center"},A={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},y={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},he={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},W={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},$=de=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:de?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),Z={display:"flex","justify-content":"space-between","align-items":"center"},k={flex:"1"},F={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},V={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},z={"text-align":"right","font-size":"0.875rem"},me={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},K={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var de=_A(),N=de.firstChild,j=N.firstChild;return j.addEventListener("blur",oe),j.addEventListener("focus",ue),j.$$keydown=Y,j.$$input=H,s(N,S(Ue,{get when(){return i()},get children(){var Q=pA();return re(J=>d(Q,he,J)),Q}}),null),s(N,S(Ue,{get when(){return fe(()=>!!r())()&&!i()},get children(){var Q=vA();return Q.addEventListener("mouseleave",J=>{J.currentTarget.style.background="none",J.currentTarget.style.color="var(--text-muted)"}),Q.addEventListener("mouseenter",J=>{J.currentTarget.style.background="var(--border-color)",J.currentTarget.style.color="var(--text-primary)"}),Q.$$click=I,re(J=>{var ce=y,ae=e("common.clear","Clear search");return J.e=d(Q,ce,J.e),ae!==J.t&&ut(Q,"title",J.t=ae),J},{e:void 0,t:void 0}),Q}}),null),s(de,S(Ue,{get when(){return f()&&t.showResults!==!1},get children(){var Q=wh();return s(Q,S(Ue,{get when(){return a()},get children(){var J=bA();return J.firstChild,d(J,K),s(J,a,null),J}}),null),s(Q,S(Ue,{get when(){return u().length>0},get fallback(){return fe(()=>!!(r()&&!i()))()&&(()=>{var J=wh();return d(J,me),s(J,()=>e("inventory.noInventorysFound","No inventorys found matching your search.")),J})()},get children(){return S(Ut,{get each(){return u()},children:(J,ce)=>{const ae=_(J.id),M=ae<=J.minStockLevel;return(()=>{var ne=SA(),pe=ne.firstChild,ve=pe.firstChild,ee=ve.firstChild,ie=ee.nextSibling,R=ie.firstChild,L=R.firstChild,B=R.nextSibling,ge=B.nextSibling,le=ge.nextSibling,U=le.nextSibling,G=ve.nextSibling,Pe=G.firstChild,_e=Pe.firstChild,se=Pe.nextSibling;return ne.addEventListener("mouseenter",()=>C(ce())),ne.$$click=()=>te(J),d(pe,Z),d(ve,k),d(ee,F),s(ee,()=>J.name),d(ie,V),s(R,()=>e("inventory.sku","SKU"),L),s(R,()=>J.sku,null),s(ge,()=>J.category),s(U,()=>v(J.unitCost)),d(G,z),Pe.style.setProperty("font-weight","600"),(M?"#f44336":"var(--text-primary)")!=null?Pe.style.setProperty("color",M?"#f44336":"var(--text-primary)"):Pe.style.removeProperty("color"),s(Pe,ae,_e),s(Pe,()=>J.unitOfMeasure,null),se.style.setProperty("color","var(--text-muted)"),s(se,()=>M?(()=>{var be=PA();return be.firstChild,be.style.setProperty("color","#f44336"),s(be,()=>e("inventory.lowStock","Low Stock"),null),be})():e("inventory.inStock","In Stock")),re(be=>d(ne,$(ce()===b()),be)),ne})()}})}}),null),re(J=>d(Q,W,J)),Q}}),null),re(Q=>{var J=P,ce=w,ae=A,M=t.placeholder||e("inventory.searchInventorys","Search inventorys by name, SKU, or category..."),ne=t.disabled;return Q.e=d(de,J,Q.e),Q.t=d(N,ce,Q.t),Q.a=d(j,ae,Q.a),M!==Q.o&&ut(j,"placeholder",Q.o=M),ne!==Q.i&&(j.disabled=Q.i=ne),Q},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),re(()=>j.value=r()),de})()};At(["input","keydown","click"]);var CA=q("<div>"),bl=q("<div><span>:</span><span>"),AA=q("<div><button> "),IA=q("<div><div><div><h3></h3><div>: </div></div><div><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span> <!>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span>");const EA=t=>{const{t:e}=at(),r=C=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(C),n=C=>new Date(C).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),i=C=>({in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}})[C]||{bg:"#f5f5f5",color:"#666"},o=C=>({in:"",out:"",transfer:"",adjustment:""})[C]||"",a=()=>t.movement,c={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},u={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},h={"font-weight":"600",color:"var(--text-primary)","text-align":"right"},f={"margin-bottom":"1.5rem"},p={"font-weight":"600","margin-bottom":"0.75rem","padding-bottom":"0.5rem","border-bottom":"2px solid var(--border-color)"},b=C=>({display:"inline-flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"600","text-transform":"uppercase","letter-spacing":"0.5px",background:i(C).bg,color:i(C).color});return S(dr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.movementDetails")},size:"lg",get children(){return S(Ue,{get when(){return a()},get fallback(){return(()=>{var C=CA();return s(C,()=>e("common.noDataFound")),C})()},children:C=>(()=>{var D=IA(),x=D.firstChild,E=x.firstChild,T=E.firstChild,H=T.nextSibling,te=H.firstChild,Y=E.nextSibling,ue=Y.firstChild,oe=x.nextSibling,I=oe.firstChild,_=I.nextSibling,v=_.firstChild,P=v.firstChild,w=v.nextSibling,A=_.nextSibling,y=A.firstChild,he=y.firstChild,W=y.nextSibling,$=W.firstChild,Z=A.nextSibling,k=Z.firstChild,F=k.firstChild,V=k.nextSibling,z=Z.nextSibling,me=z.firstChild,K=me.firstChild,de=K.nextSibling;de.nextSibling;var N=me.nextSibling,j=oe.nextSibling,Q=j.firstChild,J=Q.nextSibling,ce=J.firstChild,ae=ce.firstChild,M=ce.nextSibling,ne=j.nextSibling,pe=ne.firstChild,ve=pe.nextSibling,ee=ve.firstChild,ie=ee.firstChild,R=ee.nextSibling,L=ve.nextSibling,B=L.firstChild,ge=B.firstChild,le=B.nextSibling;return x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),x.style.setProperty("margin-bottom","1.5rem"),x.style.setProperty("padding-bottom","1rem"),x.style.setProperty("border-bottom","2px solid var(--border-color)"),T.style.setProperty("margin","0 0 0.5rem 0"),T.style.setProperty("font-size","1.25rem"),s(T,()=>C().productName),H.style.setProperty("font-size","0.875rem"),H.style.setProperty("color","var(--text-muted)"),s(H,()=>e("inventory.sku"),te),s(H,()=>C().productSku,null),ue.style.setProperty("font-size","1.2rem"),s(ue,()=>o(C().movementType)),s(Y,()=>C().movementType,null),s(I,()=>e("inventory.movementInformation")),s(v,()=>e("inventory.referenceNumber"),P),s(w,()=>C().referenceNumber),s(y,()=>e("common.quantity"),he),s(W,()=>C().quantity,$),s(W,()=>e("common.units"),null),s(k,()=>e("inventory.unitCost"),F),s(V,()=>r(C().unitCost)),s(me,()=>e("common.total"),K),s(me,()=>e("common.value"),de),s(N,()=>r(C().totalCost)),s(Q,()=>e("inventory.locationInformation")),s(ce,()=>e("inventory.location"),ae),s(M,()=>C().locationName),s(j,S(Ue,{get when(){return C().fromLocationName},get children(){var U=bl(),G=U.firstChild,Pe=G.firstChild,_e=G.nextSibling;return s(G,()=>e("common.from"),Pe),s(_e,()=>C().fromLocationName),re(se=>{var be=c,X=u,we=h;return se.e=d(U,be,se.e),se.t=d(G,X,se.t),se.a=d(_e,we,se.a),se},{e:void 0,t:void 0,a:void 0}),U}}),null),s(j,S(Ue,{get when(){return C().invoiceId},get children(){var U=bl(),G=U.firstChild,Pe=G.firstChild,_e=G.nextSibling;return s(G,()=>e("common.invoice"),Pe),s(_e,()=>C().invoiceId),re(se=>{var be=c,X=u,we={...h,color:"var(--primary-color)"};return se.e=d(U,be,se.e),se.t=d(G,X,se.t),se.a=d(_e,we,se.a),se},{e:void 0,t:void 0,a:void 0}),U}}),null),s(pe,()=>e("common.details")),s(ee,()=>e("common.createdBy"),ie),s(R,()=>C().createdBy),s(B,()=>e("common.created"),ge),s(le,()=>n(C().createdDate)),s(ne,S(Ue,{get when(){return C().notes},get children(){var U=bl(),G=U.firstChild,Pe=G.firstChild,_e=G.nextSibling;return s(G,()=>e("common.notes"),Pe),s(_e,()=>C().notes),re(se=>{var be={...c,"border-bottom":"none"},X=u,we={...h,"font-style":"italic","max-width":"60%","white-space":"pre-wrap"};return se.e=d(U,be,se.e),se.t=d(G,X,se.t),se.a=d(_e,we,se.a),se},{e:void 0,t:void 0,a:void 0}),U}}),null),s(D,S(Ue,{get when(){return t.onEdit},get children(){var U=AA(),G=U.firstChild,Pe=G.firstChild;return U.style.setProperty("display","flex"),U.style.setProperty("justify-content","flex-end"),U.style.setProperty("margin-top","1.5rem"),U.style.setProperty("padding-top","1rem"),U.style.setProperty("border-top","1px solid var(--border-color)"),G.addEventListener("mouseleave",_e=>{_e.currentTarget.style.transform="translateY(0)",_e.currentTarget.style.boxShadow="none"}),G.addEventListener("mouseenter",_e=>{_e.currentTarget.style.transform="translateY(-1px)",_e.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)"}),G.$$click=()=>t.onEdit?.(C()),G.style.setProperty("padding","0.5rem 1.5rem"),G.style.setProperty("border-radius","var(--border-radius-sm)"),G.style.setProperty("border","1px solid var(--primary-color)"),G.style.setProperty("background","var(--primary-color)"),G.style.setProperty("color","white"),G.style.setProperty("cursor","pointer"),G.style.setProperty("font-weight","500"),G.style.setProperty("transition","all 0.2s ease"),s(G,()=>e("common.edit"),Pe),s(G,()=>e("inventory.movement"),null),U}}),null),re(U=>{var G=b(C().movementType),Pe=f,_e=p,se=c,be=u,X=h,we=c,ke=u,xe={...h,"font-size":"1.1rem",color:"var(--primary-color)"},Te=c,Oe=u,We=h,je=c,Ie=u,Ve={...h,"font-size":"1.1rem",color:"var(--primary-color)"},He=f,qe=p,Ge=c,Ae=u,rt=h,et=f,ct=p,xt=c,_t=u,Ht=h,mt=c,Qt=u,ht=h;return U.e=d(Y,G,U.e),U.t=d(oe,Pe,U.t),U.a=d(I,_e,U.a),U.o=d(_,se,U.o),U.i=d(v,be,U.i),U.n=d(w,X,U.n),U.s=d(A,we,U.s),U.h=d(y,ke,U.h),U.r=d(W,xe,U.r),U.d=d(Z,Te,U.d),U.l=d(k,Oe,U.l),U.u=d(V,We,U.u),U.c=d(z,je,U.c),U.w=d(me,Ie,U.w),U.m=d(N,Ve,U.m),U.f=d(j,He,U.f),U.y=d(Q,qe,U.y),U.g=d(J,Ge,U.g),U.p=d(ce,Ae,U.p),U.b=d(M,rt,U.b),U.T=d(ne,et,U.T),U.A=d(pe,ct,U.A),U.O=d(ve,xt,U.O),U.I=d(ee,_t,U.I),U.S=d(R,Ht,U.S),U.W=d(L,mt,U.W),U.C=d(B,Qt,U.C),U.B=d(le,ht,U.B),U},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),D})()})}})};At(["click"]);var hi=q("<div>"),xA=q("<div><label></label><select><option value>"),TA=q("<div><div><span>:</span><span>$"),$A=q("<form><div><label></label><select><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><input type=number min=0.01 step=0.01></div><div><label></label><input type=number min=0 step=0.01></div><div><label></label><input type=text></div><div><label> (<!>)</label><input type=text></div><div><label> (<!>)</label><textarea></textarea></div><div><button type=button></button><button type=submit>"),Ch=q("<option> (<!>)");const kA=t=>{const{t:e}=at(),[r,n]=ye("in"),[i,o]=ye(""),[a,c]=ye(""),[u,h]=ye(""),[f,p]=ye(""),[b,C]=ye(""),[D,x]=ye(""),[E,T]=ye(""),[H,te]=ye(!1),[Y,ue]=ye({});Tn(()=>{const he=t.movement;he&&t.isOpen&&(n(he.movementType),o(he.quantity.toString()),c(he.unitCost.toString()),h(he.referenceNumber),p(he.notes),x(he.locationId),C(he.fromLocationId||""),T(he.invoiceId||""),ue({}))});const oe=()=>{const he={};return(!i()||parseFloat(i())<=0)&&(he.quantity=e("forms.requiredField")),(!a()||parseFloat(a())<0)&&(he.unitCost=e("forms.requiredField")),u().trim()||(he.referenceNumber=e("forms.requiredField")),D()||(he.locationId=e("forms.requiredField")),r()==="transfer"&&!b()&&(he.fromLocationId=e("forms.requiredField")),ue(he),Object.keys(he).length===0},I=async he=>{if(he.preventDefault(),!(!oe()||!t.movement)){te(!0);try{const W=t.movement,$=De.getProductById(W.productId),Z=De.getLocationById(D()),k=b()?De.getLocationById(b()):null;if(!$||!Z)throw new Error("Product or location not found");const F={...W,movementType:r(),quantity:parseFloat(i()),unitCost:parseFloat(a()),totalCost:parseFloat(i())*parseFloat(a()),referenceNumber:u().trim(),notes:f().trim(),locationId:D(),locationName:Z.name,fromLocationId:b()||void 0,fromLocationName:k?.name,invoiceId:E().trim()||void 0,lastModified:new Date().toISOString()};De.updateMovement(W.id,F),t.onMovementUpdated?.(),t.onClose(),_()}catch(W){console.error("Error updating movement:",W),ue({submit:e("forms.saveError")})}finally{te(!1)}}},_=()=>{n("in"),o(""),c(""),h(""),p(""),C(""),x(""),T(""),ue({})},v=()=>{_(),t.onClose()},P={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",transition:"border-color 0.2s ease"},w={display:"block","margin-bottom":"0.25rem","font-weight":"500","font-size":"0.875rem"},A={color:"#d32f2f","font-size":"0.75rem","margin-top":"0.25rem"},y={"margin-bottom":"1rem"};return S(dr,{get isOpen(){return t.isOpen},onClose:v,get title(){return e("inventory.editMovement","Edit Movement")},get children(){return S(Ue,{get when(){return t.movement},get fallback(){return(()=>{var he=hi();return s(he,()=>e("common.loading")),he})()},get children(){var he=$A(),W=he.firstChild,$=W.firstChild,Z=$.nextSibling,k=Z.firstChild,F=k.nextSibling,V=F.nextSibling,z=V.nextSibling,me=W.nextSibling,K=me.firstChild,de=K.nextSibling,N=de.firstChild,j=me.nextSibling,Q=j.firstChild,J=Q.nextSibling,ce=j.nextSibling,ae=ce.firstChild,M=ae.nextSibling,ne=ce.nextSibling,pe=ne.firstChild,ve=pe.nextSibling,ee=ne.nextSibling,ie=ee.firstChild,R=ie.firstChild,L=R.nextSibling;L.nextSibling;var B=ie.nextSibling,ge=ee.nextSibling,le=ge.firstChild,U=le.firstChild,G=U.nextSibling;G.nextSibling;var Pe=le.nextSibling,_e=ge.nextSibling,se=_e.firstChild,be=se.nextSibling;return he.addEventListener("submit",I),s($,()=>e("inventory.movementType")),Z.addEventListener("change",X=>n(X.target.value)),s(k,()=>e("inventory.stockIn")),s(F,()=>e("inventory.stockOut")),s(V,()=>e("inventory.transfer")),s(z,()=>e("inventory.adjustment")),s(K,(()=>{var X=fe(()=>r()==="transfer");return()=>X()?e("inventory.toLocation"):e("inventory.location")})()),de.addEventListener("change",X=>x(X.target.value)),s(N,()=>e("modals.selectLocation")),s(de,S(Ut,{get each(){return De.getActiveLocations()},children:X=>(()=>{var we=Ch(),ke=we.firstChild,xe=ke.nextSibling;return xe.nextSibling,s(we,()=>X.name,ke),s(we,()=>X.type,xe),re(()=>we.value=X.id),we})()}),null),s(me,S(Ue,{get when(){return Y().locationId},get children(){var X=hi();return s(X,()=>Y().locationId),re(we=>d(X,A,we)),X}}),null),s(he,S(Ue,{get when(){return r()==="transfer"},get children(){var X=xA(),we=X.firstChild,ke=we.nextSibling,xe=ke.firstChild;return s(we,()=>e("inventory.fromLocation")),ke.addEventListener("change",Te=>C(Te.target.value)),s(xe,()=>e("modals.selectLocation")),s(ke,S(Ut,{get each(){return De.getActiveLocations().filter(Te=>Te.id!==D())},children:Te=>(()=>{var Oe=Ch(),We=Oe.firstChild,je=We.nextSibling;return je.nextSibling,s(Oe,()=>Te.name,We),s(Oe,()=>Te.type,je),re(()=>Oe.value=Te.id),Oe})()}),null),s(X,S(Ue,{get when(){return Y().fromLocationId},get children(){var Te=hi();return s(Te,()=>Y().fromLocationId),re(Oe=>d(Te,A,Oe)),Te}}),null),re(Te=>{var Oe=y,We=w,je={...P,"border-color":Y().fromLocationId?"#d32f2f":"var(--border-color)"},Ie=H();return Te.e=d(X,Oe,Te.e),Te.t=d(we,We,Te.t),Te.a=d(ke,je,Te.a),Ie!==Te.o&&(ke.disabled=Te.o=Ie),Te},{e:void 0,t:void 0,a:void 0,o:void 0}),re(()=>ke.value=b()),X}}),j),s(Q,()=>e("common.quantity")),J.$$input=X=>o(X.target.value),s(j,S(Ue,{get when(){return Y().quantity},get children(){var X=hi();return s(X,()=>Y().quantity),re(we=>d(X,A,we)),X}}),null),s(ae,()=>e("inventory.unitCost")),M.$$input=X=>c(X.target.value),s(ce,S(Ue,{get when(){return Y().unitCost},get children(){var X=hi();return s(X,()=>Y().unitCost),re(we=>d(X,A,we)),X}}),null),s(he,S(Ue,{get when(){return fe(()=>!!i())()&&a()},get children(){var X=TA(),we=X.firstChild,ke=we.firstChild,xe=ke.firstChild,Te=ke.nextSibling;return Te.firstChild,we.style.setProperty("display","flex"),we.style.setProperty("justify-content","space-between"),ke.style.setProperty("font-weight","500"),s(ke,()=>e("common.total"),xe),Te.style.setProperty("font-weight","600"),Te.style.setProperty("color","var(--primary-color)"),s(Te,()=>(parseFloat(i()||"0")*parseFloat(a()||"0")).toFixed(2),null),re(Oe=>d(X,{...y,padding:"0.75rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)"},Oe)),X}}),ne),s(pe,()=>e("inventory.referenceNumber")),ve.$$input=X=>h(X.target.value),s(ne,S(Ue,{get when(){return Y().referenceNumber},get children(){var X=hi();return s(X,()=>Y().referenceNumber),re(we=>d(X,A,we)),X}}),null),s(ie,()=>e("inventory.invoiceNumber"),R),s(ie,()=>e("common.optional"),L),B.$$input=X=>T(X.target.value),s(le,()=>e("common.notes"),U),s(le,()=>e("common.optional"),G),Pe.$$input=X=>p(X.target.value),s(he,S(Ue,{get when(){return Y().submit},get children(){var X=hi();return s(X,()=>Y().submit),re(we=>d(X,{...A,"margin-bottom":"1rem"},we)),X}}),_e),_e.style.setProperty("display","flex"),_e.style.setProperty("gap","1rem"),_e.style.setProperty("justify-content","flex-end"),se.$$click=v,se.style.setProperty("padding","0.5rem 1rem"),se.style.setProperty("border","1px solid var(--border-color)"),se.style.setProperty("border-radius","var(--border-radius-sm)"),se.style.setProperty("background","white"),se.style.setProperty("cursor","pointer"),s(se,()=>e("common.cancel")),be.style.setProperty("padding","0.5rem 1rem"),be.style.setProperty("border","none"),be.style.setProperty("border-radius","var(--border-radius-sm)"),be.style.setProperty("background","var(--primary-color)"),be.style.setProperty("color","white"),be.style.setProperty("cursor","pointer"),be.style.setProperty("font-weight","500"),s(be,(()=>{var X=fe(()=>!!H());return()=>X()?e("modals.processing"):e("inventory.updateMovement","Update Movement")})()),re(X=>{var we=y,ke=w,xe=P,Te=H(),Oe=y,We=w,je={...P,"border-color":Y().locationId?"#d32f2f":"var(--border-color)"},Ie=H(),Ve=y,He=w,qe={...P,"border-color":Y().quantity?"#d32f2f":"var(--border-color)"},Ge=e("modals.enterQuantity"),Ae=H(),rt=y,et=w,ct={...P,"border-color":Y().unitCost?"#d32f2f":"var(--border-color)"},xt=e("modals.enterCost"),_t=H(),Ht=y,mt=w,Qt={...P,"border-color":Y().referenceNumber?"#d32f2f":"var(--border-color)"},ht=e("modals.enterReference"),St=H(),Lt=y,Nt=w,Me=P,Be=e("inventory.invoiceNumber"),Ye=H(),ot=y,kt=w,Qe={...P,resize:"vertical","min-height":"80px"},Ee=e("modals.addNotes"),nt=H(),ft=H(),Pt=H();return X.e=d(W,we,X.e),X.t=d($,ke,X.t),X.a=d(Z,xe,X.a),Te!==X.o&&(Z.disabled=X.o=Te),X.i=d(me,Oe,X.i),X.n=d(K,We,X.n),X.s=d(de,je,X.s),Ie!==X.h&&(de.disabled=X.h=Ie),X.r=d(j,Ve,X.r),X.d=d(Q,He,X.d),X.l=d(J,qe,X.l),Ge!==X.u&&ut(J,"placeholder",X.u=Ge),Ae!==X.c&&(J.disabled=X.c=Ae),X.w=d(ce,rt,X.w),X.m=d(ae,et,X.m),X.f=d(M,ct,X.f),xt!==X.y&&ut(M,"placeholder",X.y=xt),_t!==X.g&&(M.disabled=X.g=_t),X.p=d(ne,Ht,X.p),X.b=d(pe,mt,X.b),X.T=d(ve,Qt,X.T),ht!==X.A&&ut(ve,"placeholder",X.A=ht),St!==X.O&&(ve.disabled=X.O=St),X.I=d(ee,Lt,X.I),X.S=d(ie,Nt,X.S),X.W=d(B,Me,X.W),Be!==X.C&&ut(B,"placeholder",X.C=Be),Ye!==X.B&&(B.disabled=X.B=Ye),X.v=d(ge,ot,X.v),X.k=d(le,kt,X.k),X.x=d(Pe,Qe,X.x),Ee!==X.j&&ut(Pe,"placeholder",X.j=Ee),nt!==X.q&&(Pe.disabled=X.q=nt),ft!==X.z&&(se.disabled=X.z=ft),Pt!==X.P&&(be.disabled=X.P=Pt),X},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0,x:void 0,j:void 0,q:void 0,z:void 0,P:void 0}),re(()=>Z.value=r()),re(()=>de.value=D()),re(()=>J.value=i()),re(()=>M.value=a()),re(()=>ve.value=u()),re(()=>B.value=E()),re(()=>Pe.value=f()),he}})}})};At(["input","click"]);var RA=q("<div><div></div><div><div><label></label><select><option value=all></option><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),DA=q("<div><h2>"),Ah=q("<div><label></label><select><option value>"),NA=q("<option> (<!>)"),LA=q("<option>"),MA=q("<div><div></div><div></div><div>"),OA=q("<div><div><div><div><span></span><h3></h3><span></span></div><div>  </div></div><div><div></div><div> <!> @ </div></div></div><div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div><span>:</span><span>"),VA=q("<span>"),BA=q("<span> <!>: "),Ih=q("<div><span>:</span><span>"),FA=q("<div><div><span>:</span><select><option value=10>10</option><option value=25>25</option><option value=50>50</option><option value=100>100</option></select><span></span></div><div><div><span>:</span><input type=number min=1><span> "),UA=q("<span>..."),jA=q("<button>");const zA=t=>{const{t:e}=at(),[r,n]=ye(""),[i,o]=ye(""),[a,c]=ye("all"),[u,h]=ye({start:"",end:""}),[f,p]=ye(""),[b,C]=ye(""),[D,x]=ye(1),[E,T]=ye(25),[H,te]=ye(null),[Y,ue]=ye(!1),[oe,I]=ye(!1),_=Ke(()=>{let L=De.movements;if(t.filterBy==="product"&&t.filterId?L=L.filter(B=>B.productId===t.filterId):t.filterBy==="location"&&t.filterId&&(L=L.filter(B=>B.locationId===t.filterId)),r()&&(L=L.filter(B=>B.productId===r())),i()&&(L=L.filter(B=>B.locationId===i())),a()!=="all"&&(L=L.filter(B=>B.movementType===a())),u().start&&(L=L.filter(B=>B.createdDate>=u().start)),u().end&&(L=L.filter(B=>B.createdDate<=u().end+"T23:59:59Z")),f()){const B=f().toLowerCase();L=L.filter(ge=>ge.productName.toLowerCase().includes(B)||ge.productSku.toLowerCase().includes(B)||ge.locationName.toLowerCase().includes(B)||ge.referenceNumber.toLowerCase().includes(B)||ge.notes.toLowerCase().includes(B)||ge.createdBy.toLowerCase().includes(B)||ge.invoiceId&&ge.invoiceId.toLowerCase().includes(B)||ge.fromLocationName&&ge.fromLocationName.toLowerCase().includes(B)||ge.movementType.toLowerCase().includes(B))}return L.sort((B,ge)=>new Date(ge.createdDate).getTime()-new Date(B.createdDate).getTime())});Tn(()=>{r(),i(),a(),u(),f(),x(1)});const v=Ke(()=>{const L=(D()-1)*E(),B=L+E();return _().slice(L,B)}),P=Ke(()=>Math.ceil(_().length/E())),w=Ke(()=>{const L=_();return{total:L.length,stockIn:L.filter(B=>B.movementType==="in").length,stockOut:L.filter(B=>B.movementType==="out").length,transfers:L.filter(B=>B.movementType==="transfer").length,adjustments:L.filter(B=>B.movementType==="adjustment").length,totalValue:L.reduce((B,ge)=>B+ge.totalCost,0)}}),A={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},y={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},he={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)",cursor:"pointer"},W={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},$={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem","margin-bottom":"2rem"},Z={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","text-align":"center"},k={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},F={"font-size":"0.875rem",color:"var(--text-muted)","font-weight":"500"},V={padding:"1.5rem","margin-bottom":"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",transition:"all 0.2s ease"},z={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"1rem"};function me(L){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[L]||{bg:"#f5f5f5",color:"#666"}}const K=L=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:me(L).bg,color:me(L).color}),de={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"1rem"},N={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.5rem 0","border-bottom":"1px solid var(--border-color)"},j={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},Q={"font-weight":"600",color:"var(--text-primary)"},J={display:"flex","justify-content":"space-between","align-items":"center","margin-top":"2rem",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},ce=L=>({padding:"0.25rem 0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:L?"var(--primary-color)":"var(--surface-color)",color:L?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),ae=L=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(L),M=L=>new Date(L).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),ne=L=>({in:"",out:"",transfer:"",adjustment:""})[L]||"",pe=()=>{n(""),o(""),c("all"),h({start:"",end:""}),p(""),x(1)},ve=L=>{te(L),ue(!0)},ee=L=>{te(L),ue(!1),I(!0)},ie=()=>{I(!1),te(null)},R=async L=>{i()&&(L+=" "+i()),Ml(a())&&(L+=" "+Ml(a()));const B=await qn.getInventory(L),ge=De.parseInventoryData(B);De.updMovements(ge)};return(()=>{var L=RA(),B=L.firstChild,ge=B.nextSibling,le=ge.firstChild,U=le.firstChild,G=U.nextSibling,Pe=G.firstChild,_e=Pe.nextSibling,se=_e.nextSibling,be=se.nextSibling,X=be.nextSibling,we=le.nextSibling,ke=we.firstChild,xe=ke.nextSibling,Te=we.nextSibling,Oe=Te.firstChild,We=Oe.nextSibling,je=ge.nextSibling,Ie=je.firstChild,Ve=Ie.firstChild,He=Ve.nextSibling,qe=Ie.nextSibling,Ge=qe.firstChild,Ae=Ge.nextSibling,rt=qe.nextSibling,et=rt.firstChild,ct=et.nextSibling,xt=rt.nextSibling,_t=xt.firstChild,Ht=_t.nextSibling,mt=xt.nextSibling,Qt=mt.firstChild,ht=Qt.nextSibling,St=mt.nextSibling,Lt=St.firstChild,Nt=Lt.nextSibling;return s(L,(()=>{var Me=fe(()=>!t.filterBy);return()=>Me()&&(()=>{var Be=DA(),Ye=Be.firstChild;return d(Be,A),Ye.style.setProperty("margin","0"),Ye.style.setProperty("font-size","1.5rem"),s(Ye,()=>e("inventory.movements")),s(Be,S(Ne,{variant:"outline",onClick:pe,get children(){return e("common.clearFilters")}}),null),Be})()})(),B),s(L,S(wA,{filters:{selectedLocation:i,movementType:a},onSearchResults:Me=>{C(Me),R(Me)},get placeholder(){return e("inventory.searchProductsStock","Search inventories...")},showResults:!1,maxResults:20}),B),B.style.setProperty("margin","20px"),d(ge,y),s(ge,(()=>{var Me=fe(()=>!t.filterBy);return()=>Me()&&[(()=>{var Be=Ah(),Ye=Be.firstChild,ot=Ye.nextSibling,kt=ot.firstChild;return Ye.style.setProperty("display","block"),Ye.style.setProperty("margin-bottom","0.5rem"),Ye.style.setProperty("font-weight","500"),s(Ye,()=>e("inventory.product")),ot.addEventListener("change",Qe=>n(Qe.target.value)),s(kt,()=>e("inventory.allProducts")),s(ot,S(Ut,{get each(){return De.products},children:Qe=>(()=>{var Ee=NA(),nt=Ee.firstChild,ft=nt.nextSibling;return ft.nextSibling,s(Ee,()=>Qe.name,nt),s(Ee,()=>Qe.sku,ft),re(()=>Ee.value=Qe.id),Ee})()}),null),re(Qe=>d(ot,he,Qe)),re(()=>ot.value=r()),Be})(),(()=>{var Be=Ah(),Ye=Be.firstChild,ot=Ye.nextSibling,kt=ot.firstChild;return Ye.style.setProperty("display","block"),Ye.style.setProperty("margin-bottom","0.5rem"),Ye.style.setProperty("font-weight","500"),s(Ye,()=>e("inventory.location")),ot.addEventListener("change",Qe=>o(Qe.target.value)),s(kt,()=>e("inventory.allLocations")),s(ot,S(Ut,{get each(){return De.locations},children:Qe=>(()=>{var Ee=LA();return s(Ee,()=>Qe.name),re(()=>Ee.value=Qe.id),Ee})()}),null),re(Qe=>d(ot,he,Qe)),re(()=>ot.value=i()),Be})()]})(),le),U.style.setProperty("display","block"),U.style.setProperty("margin-bottom","0.5rem"),U.style.setProperty("font-weight","500"),s(U,()=>e("inventory.movementType")),G.addEventListener("change",Me=>{c(Me.target.value),R(b())}),s(Pe,()=>e("inventory.allTypes")),s(_e,()=>e("inventory.stockIn")),s(se,()=>e("inventory.stockOut")),s(be,()=>e("inventory.transfer")),s(X,()=>e("inventory.adjustment")),ke.style.setProperty("display","block"),ke.style.setProperty("margin-bottom","0.5rem"),ke.style.setProperty("font-weight","500"),s(ke,()=>e("common.startDate")),xe.addEventListener("change",Me=>h(Be=>({...Be,start:Me.target.value}))),Oe.style.setProperty("display","block"),Oe.style.setProperty("margin-bottom","0.5rem"),Oe.style.setProperty("font-weight","500"),s(Oe,()=>e("common.endDate")),We.addEventListener("change",Me=>h(Be=>({...Be,end:Me.target.value}))),d(je,$),s(Ve,()=>w().total),s(He,()=>e("inventory.totalMovements")),s(Ge,()=>w().stockIn),s(Ae,()=>e("inventory.stockIn")),s(et,()=>w().stockOut),s(ct,()=>e("inventory.stockOut")),s(_t,()=>w().transfers),s(Ht,()=>e("inventory.transfers")),s(Qt,()=>w().adjustments),s(ht,()=>e("inventory.adjustments")),s(Lt,()=>ae(w().totalValue)),s(Nt,()=>e("inventory.totalValue")),s(L,(()=>{var Me=fe(()=>v().length===0);return()=>Me()?(()=>{var Be=MA(),Ye=Be.firstChild,ot=Ye.nextSibling,kt=ot.nextSibling;return Be.style.setProperty("text-align","center"),Be.style.setProperty("padding","3rem"),Be.style.setProperty("color","var(--text-muted)"),Be.style.setProperty("background","var(--surface-color)"),Be.style.setProperty("border-radius","var(--border-radius)"),Be.style.setProperty("border","1px solid var(--border-color)"),Ye.style.setProperty("font-size","1.5rem"),Ye.style.setProperty("margin-bottom","1rem"),ot.style.setProperty("font-size","1.1rem"),ot.style.setProperty("margin-bottom","0.5rem"),s(ot,()=>e("inventory.noMovementsFound")),kt.style.setProperty("font-size","0.875rem"),s(kt,()=>e("inventory.tryAdjustingFilters")),Be})():[S(Ut,{get each(){return v()},children:Be=>(()=>{var Ye=OA(),ot=Ye.firstChild,kt=ot.firstChild,Qe=kt.firstChild,Ee=Qe.firstChild,nt=Ee.nextSibling,ft=nt.nextSibling,Pt=Qe.nextSibling,sr=Pt.firstChild,Rt=kt.nextSibling,jt=Rt.firstChild,ar=jt.nextSibling,Tt=ar.firstChild,Kt=Tt.nextSibling;Kt.nextSibling;var $r=ot.nextSibling,Mt=$r.firstChild,rr=Mt.firstChild,xr=rr.firstChild,zr=xr.firstChild,Ar=xr.nextSibling,mn=rr.nextSibling,kn=mn.firstChild,Ri=kn.firstChild,oi=kn.nextSibling,si=Mt.nextSibling,Rn=si.firstChild,Qr=Rn.firstChild,Di=Qr.firstChild,ai=Qr.nextSibling;return Ye.addEventListener("mouseleave",dt=>{dt.currentTarget.style.transform="translateY(0)",dt.currentTarget.style.boxShadow="none"}),Ye.addEventListener("mouseenter",dt=>{dt.currentTarget.style.transform="translateY(-2px)",dt.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),Ye.$$click=()=>ve(Be),d(ot,z),Qe.style.setProperty("display","flex"),Qe.style.setProperty("align-items","center"),Qe.style.setProperty("gap","0.5rem"),Qe.style.setProperty("margin-bottom","0.5rem"),Ee.style.setProperty("font-size","1.2rem"),s(Ee,()=>ne(Be.movementType)),nt.style.setProperty("margin","0"),nt.style.setProperty("font-size","1.1rem"),s(nt,()=>Be.productName),s(ft,()=>Be.movementType),s(Qe,(()=>{var dt=fe(()=>!!Be.invoiceId);return()=>dt()&&(()=>{var Dt=VA();return Dt.style.setProperty("padding","0.2rem 0.5rem"),Dt.style.setProperty("border-radius","var(--border-radius-sm)"),Dt.style.setProperty("font-size","0.7rem"),Dt.style.setProperty("font-weight","500"),Dt.style.setProperty("background","var(--primary-color)"),Dt.style.setProperty("color","white"),s(Dt,()=>e("inventory.bulk")),Dt})()})(),null),Pt.style.setProperty("font-size","0.875rem"),Pt.style.setProperty("color","var(--text-muted)"),s(Pt,()=>Be.productSku,sr),s(Pt,()=>M(Be.createdDate),null),s(Pt,(()=>{var dt=fe(()=>!!Be.invoiceId);return()=>dt()&&(()=>{var Dt=BA(),lr=Dt.firstChild,kr=lr.nextSibling;return kr.nextSibling,Dt.style.setProperty("margin-left","0.5rem"),Dt.style.setProperty("font-weight","500"),s(Dt,()=>e("common.invoice"),kr),s(Dt,()=>Be.invoiceId,null),Dt})()})(),null),Rt.style.setProperty("text-align","right"),jt.style.setProperty("font-size","1.25rem"),jt.style.setProperty("font-weight","700"),jt.style.setProperty("color","var(--primary-color)"),s(jt,()=>ae(Be.totalCost)),ar.style.setProperty("font-size","0.875rem"),ar.style.setProperty("color","var(--text-muted)"),s(ar,()=>Be.quantity,Tt),s(ar,()=>e("common.units"),Kt),s(ar,()=>ae(Be.unitCost),null),d($r,de),s(xr,()=>e("inventory.location"),zr),s(Ar,()=>Be.locationName),s(Mt,(()=>{var dt=fe(()=>!!Be.fromLocationName);return()=>dt()&&(()=>{var Dt=Ih(),lr=Dt.firstChild,kr=lr.firstChild,qr=lr.nextSibling;return s(lr,()=>e("common.from"),kr),s(qr,()=>Be.fromLocationName),re(Ot=>{var Ir=N,Jr=j,Xr=Q;return Ot.e=d(Dt,Ir,Ot.e),Ot.t=d(lr,Jr,Ot.t),Ot.a=d(qr,Xr,Ot.a),Ot},{e:void 0,t:void 0,a:void 0}),Dt})()})(),mn),s(kn,()=>e("common.reference"),Ri),s(oi,()=>Be.referenceNumber),s(Qr,()=>e("common.createdBy"),Di),s(ai,()=>Be.createdBy),s(si,(()=>{var dt=fe(()=>!!Be.notes);return()=>dt()&&(()=>{var Dt=Ih(),lr=Dt.firstChild,kr=lr.firstChild,qr=lr.nextSibling;return s(lr,()=>e("common.notes"),kr),s(qr,()=>Be.notes),re(Ot=>{var Ir={...N,"border-bottom":"none"},Jr=j,Xr={...Q,"max-width":"200px","text-align":"right","font-style":"italic"};return Ot.e=d(Dt,Ir,Ot.e),Ot.t=d(lr,Jr,Ot.t),Ot.a=d(qr,Xr,Ot.a),Ot},{e:void 0,t:void 0,a:void 0}),Dt})()})(),null),re(dt=>{var Dt={...V,"border-left":Be.invoiceId?"4px solid var(--primary-color)":"1px solid var(--border-color)",cursor:"pointer"},lr=K(Be.movementType),kr=N,qr=j,Ot=Q,Ir=N,Jr=j,Xr=Q,ys=N,Vt=j,Ni=Q;return dt.e=d(Ye,Dt,dt.e),dt.t=d(ft,lr,dt.t),dt.a=d(rr,kr,dt.a),dt.o=d(xr,qr,dt.o),dt.i=d(Ar,Ot,dt.i),dt.n=d(mn,Ir,dt.n),dt.s=d(kn,Jr,dt.s),dt.h=d(oi,Xr,dt.h),dt.r=d(Rn,ys,dt.r),dt.d=d(Qr,Vt,dt.d),dt.l=d(ai,Ni,dt.l),dt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),Ye})()}),fe(()=>fe(()=>P()>1)()&&(()=>{var Be=FA(),Ye=Be.firstChild,ot=Ye.firstChild,kt=ot.firstChild,Qe=ot.nextSibling,Ee=Qe.nextSibling,nt=Ye.nextSibling,ft=nt.firstChild,Pt=ft.firstChild,sr=Pt.firstChild,Rt=Pt.nextSibling,jt=Rt.nextSibling,ar=jt.firstChild;return d(Be,J),Ye.style.setProperty("display","flex"),Ye.style.setProperty("align-items","center"),Ye.style.setProperty("gap","0.5rem"),ot.style.setProperty("font-size","0.875rem"),ot.style.setProperty("color","var(--text-muted)"),s(ot,()=>e("common.showPerPage","Show per page"),kt),Qe.addEventListener("change",Tt=>{T(Number(Tt.target.value)),x(1)}),Qe.style.setProperty("padding","0.25rem 0.5rem"),Qe.style.setProperty("border","1px solid var(--border-color)"),Qe.style.setProperty("border-radius","var(--border-radius-sm)"),Qe.style.setProperty("background","var(--surface-color)"),Qe.style.setProperty("cursor","pointer"),Qe.style.setProperty("font-size","0.875rem"),Ee.style.setProperty("font-size","0.875rem"),Ee.style.setProperty("color","var(--text-muted)"),Ee.style.setProperty("margin-left","1rem"),s(Ee,()=>e("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:(D()-1)*E()+1,end:Math.min(D()*E(),_().length),total:_().length})),nt.style.setProperty("display","flex"),nt.style.setProperty("align-items","center"),nt.style.setProperty("gap","0.5rem"),s(nt,S(Ne,{variant:"outline",size:"sm",onClick:()=>x(1),get disabled(){return D()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.first","First")}}),ft),s(nt,S(Ne,{variant:"outline",size:"sm",onClick:()=>x(Tt=>Math.max(1,Tt-1)),get disabled(){return D()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.previous")}}),ft),s(nt,()=>{const Tt=[],Kt=P(),$r=D();if(Kt<=7)for(let Mt=1;Mt<=Kt;Mt++)Tt.push(Mt);else{Tt.push(1),$r>3&&Tt.push("...");for(let Mt=Math.max(2,$r-1);Mt<=Math.min(Kt-1,$r+1);Mt++)Tt.includes(Mt)||Tt.push(Mt);$r<Kt-2&&Tt.push("..."),Tt.includes(Kt)||Tt.push(Kt)}return S(Ut,{each:Tt,children:Mt=>Mt==="..."?(()=>{var rr=UA();return rr.style.setProperty("padding","0 0.5rem"),rr.style.setProperty("color","var(--text-muted)"),rr})():(()=>{var rr=jA();return rr.$$click=()=>x(Mt),s(rr,Mt),re(xr=>d(rr,ce(Mt===D()),xr)),rr})()})},ft),s(nt,S(Ne,{variant:"outline",size:"sm",onClick:()=>x(Tt=>Math.min(P(),Tt+1)),get disabled(){return D()===P()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.next")}}),ft),s(nt,S(Ne,{variant:"outline",size:"sm",onClick:()=>x(P()),get disabled(){return D()===P()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.last","Last")}}),ft),ft.style.setProperty("display","flex"),ft.style.setProperty("align-items","center"),ft.style.setProperty("gap","0.5rem"),ft.style.setProperty("margin-left","1rem"),Pt.style.setProperty("font-size","0.875rem"),Pt.style.setProperty("color","var(--text-muted)"),s(Pt,()=>e("common.page","Page"),sr),Rt.addEventListener("change",Tt=>{const Kt=Number(Tt.target.value);Kt>=1&&Kt<=P()&&x(Kt)}),Rt.style.setProperty("width","4rem"),Rt.style.setProperty("padding","0.25rem 0.5rem"),Rt.style.setProperty("border","1px solid var(--border-color)"),Rt.style.setProperty("border-radius","var(--border-radius-sm)"),Rt.style.setProperty("background","var(--surface-color)"),Rt.style.setProperty("text-align","center"),Rt.style.setProperty("font-size","0.875rem"),jt.style.setProperty("font-size","0.875rem"),jt.style.setProperty("color","var(--text-muted)"),s(jt,()=>e("common.of","of"),ar),s(jt,P,null),re(()=>ut(Rt,"max",P())),re(()=>Qe.value=E()),re(()=>Rt.value=D()),Be})())]})(),null),s(L,S(EA,{get isOpen(){return Y()},onClose:()=>{ue(!1),te(null)},get movement(){return H()},onEdit:ee}),null),s(L,S(Ue,{get when(){return qt.hasPermission("read_write")},get children(){return S(kA,{get isOpen(){return oe()},onClose:()=>{I(!1),te(null)},get movement(){return H()},onMovementUpdated:ie})}}),null),re(Me=>{var Be=he,Ye=W,ot=W,kt=Z,Qe=k,Ee=F,nt=Z,ft={...k,color:"#2d7d32"},Pt=F,sr=Z,Rt={...k,color:"#d32f2f"},jt=F,ar=Z,Tt={...k,color:"#1976d2"},Kt=F,$r=Z,Mt={...k,color:"#f57c00"},rr=F,xr=Z,zr=k,Ar=F;return Me.e=d(G,Be,Me.e),Me.t=d(xe,Ye,Me.t),Me.a=d(We,ot,Me.a),Me.o=d(Ie,kt,Me.o),Me.i=d(Ve,Qe,Me.i),Me.n=d(He,Ee,Me.n),Me.s=d(qe,nt,Me.s),Me.h=d(Ge,ft,Me.h),Me.r=d(Ae,Pt,Me.r),Me.d=d(rt,sr,Me.d),Me.l=d(et,Rt,Me.l),Me.u=d(ct,jt,Me.u),Me.c=d(xt,ar,Me.c),Me.w=d(_t,Tt,Me.w),Me.m=d(Ht,Kt,Me.m),Me.f=d(mt,$r,Me.f),Me.y=d(Qt,Mt,Me.y),Me.g=d(ht,rr,Me.g),Me.p=d(St,xr,Me.p),Me.b=d(Lt,zr,Me.b),Me.T=d(Nt,Ar,Me.T),Me},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),re(()=>G.value=a()),re(()=>xe.value=u().start),re(()=>We.value=u().end),L})()};At(["click"]);var qA=q("<div><p> "),HA=q("<div>"),WA=q("<div><div></div><h3></h3><p></p><div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=name></option><option value=sku></option><option value=category>"),GA=q("<div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div>%</div><div></div></div></div><div></div><div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),KA=q("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),YA=q("<div><div></div><h3></h3><p>"),QA=q("<div><div><h3> </h3><p></p></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div></div><div>"),JA=q("<div><div><div><h2> </h2><button>"),Eh=q("<option>"),XA=q("<div>..."),ZA=q("<tr><td><div></div><div>  </div></td><td><div></div></td><td><div></div></td><td><div></div></td><td><div>"),eI=q("<tr><td><div></div></td><td><div></div><div>  <!>  </div></td><td><div></div></td><td><input type=number placeholder=0 min=0 step=0.01></td><td><div></div></td><td><input type=text>");const tI=t=>{const{t:e}=at(),[r,n]=ye([]),[i,o]=ye(!1),[a,c]=ye(!1),[u,h]=ye("all"),[f,p]=ye("all"),[b,C]=ye("name"),[D,x]=ye([]),[E,T]=ye("setup");hn(async()=>{await H(),t.selectedLocationId&&h(t.selectedLocationId)});const H=async()=>{try{o(!0);const k=await qn.getProducts("prod");if(!k||typeof k!="object"){console.warn("No API results, using local store"),n(De.products);return}const F=Object.keys(k),V=me=>{let de=k[me];return{id:me,name:de.name||"Unknown Product",businessId:de.businessId||"",sku:de.code||de.sku||"",UPC:de.UPC||"",numCode:de.codeN||"",category:de.category||"General",unitCost:de.unitCost||0,unitOfMeasure:de.unitOfMeasure||"pcs",minStockLevel:de.minStockLevel||0,maxStockLevel:de.maxStockLevel||100,isActive:de.isActive!==!1,description:de.description||"",createdDate:de.createdAt||new Date().toISOString(),lastModified:de.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(de.sellingPrice||de.price||"0")}},z=F.map(V);n(z)}catch(k){console.error("Failed to load products from API:",k),n(De.products)}finally{o(!1)}},te=Ke(()=>[...new Set(r().map(F=>F.category).filter(F=>F))].sort()),Y=Ke(()=>{let k=r().filter(F=>F.isActive);return f()!=="all"&&(k=k.filter(F=>F.category===f())),k.sort((F,V)=>{switch(b()){case"name":return F.name.localeCompare(V.name);case"sku":return F.sku.localeCompare(V.sku);case"category":return F.category.localeCompare(V.category)||F.name.localeCompare(V.name);default:return 0}}),k}),ue=Ke(()=>De.getActiveLocations()),oe=(k,F)=>F&&F!=="all"?De.getStockByProductAndLocation(k,F)?.quantity||0:De.getTotalStockByProduct(k),I=()=>{const k=Y().map(F=>{const V=oe(F.id,u()!=="all"?u():void 0);return{productId:F.id,systemQuantity:V,physicalCount:null,notes:"",variance:0,product:F}});x(k),T("counting")},_=(k,F)=>{x(V=>V.map(z=>{if(z.productId===k){const me=F,K=me!==null?me-z.systemQuantity:0;return{...z,physicalCount:me,variance:K}}return z}))},v=(k,F)=>{x(V=>V.map(z=>z.productId===k?{...z,notes:F}:z))},P=Ke(()=>{const k=D(),F=k.length,V=k.filter(de=>de.physicalCount!==null).length,z=k.filter(de=>de.variance!==0).length,me=k.filter(de=>de.variance>0).length,K=k.filter(de=>de.variance<0).length;return{totalProducts:F,countedProducts:V,remainingProducts:F-V,variances:z,positiveVariances:me,negativeVariances:K,isComplete:V===F}}),w=()=>{const k=D().filter(me=>me.physicalCount!==null&&me.variance!==0);if(k.length===0)return null;const F=[e("inventory.product","Product"),e("inventory.sku","SKU"),e("inventory.category","Category"),e("inventory.location","Location"),e("inventory.systemQty","System Qty"),e("inventory.physicalCount","Physical Count"),e("inventory.variance","Variance"),e("inventory.adjustment","Adjustment"),e("common.notes","Notes"),e("common.date","Date")],V=k.map(me=>[`"${me.product.name}"`,`"${me.product.sku}"`,`"${me.product.category}"`,`"${he()}"`,me.systemQuantity,me.physicalCount,me.variance,me.variance>0?e("inventory.stockIncrease","Stock Increase"):e("inventory.stockDecrease","Stock Decrease"),`"${me.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")}"`,`"${W()}"`]);return[F.join(","),...V.map(me=>me.join(","))].join(`
`)},A=()=>{const k=w();if(!k){alert(e("inventory.noAdjustmentsToDownload","No adjustments to download"));return}const F=new Blob([k],{type:"text/csv;charset=utf-8;"}),V=document.createElement("a");if(V.download!==void 0){const z=URL.createObjectURL(F);V.setAttribute("href",z),V.setAttribute("download",`inventory-adjustments-${W().replace(/[/:,\s]/g,"-")}.csv`),V.style.visibility="hidden",document.body.appendChild(V),V.click(),document.body.removeChild(V)}},y=async(k=!0)=>{try{c(!0),console.log(D());const F=N=>{let j=De.getProductById(N.productId),Q=De.getStockByProductAndLocation(N.productId,u()),J=parseFloat(Q?.averageCost+""),ce=parseFloat(Q?.quantity+"");return{product:{id:N.productId,label:j?.name,code:j?.code},productId:N?.productId,reason:"Physical Count Adjustment",notes:N?.notes||"Physical inventory adjustment",quantity:N?.variance,unitCost:J}},V=D().filter(N=>N.physicalCount!==null&&N.variance!==0).map(F);let z="ADJ_"+js();const me=new Date().toISOString(),K={ssg_inventory_key:js(),invoiceId:z,referenceNumber:js(),movementType:"adjustment",type:"adjustment",locationId:u(),items:V,products:V,generalNotes:"Physical inventory adjustment",description:"Physical Count Adjustment",invoice:z,store:u(),createdBy:"admin",createDate:me};console.log("Saving inventory bulkRequest:",K);const de=await qn.addInventory(K);k&&V.length>0&&A(),console.log("Saving inventory adjustments:",V),await new Promise(N=>setTimeout(N,1e3)),t.onClose()}catch(F){console.error("Failed to save inventory adjustments:",F)}finally{c(!1)}},he=Ke(()=>u()==="all"?"All Locations":ue().find(F=>F.id===u())?.name||"Unknown Location"),W=()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),$=()=>{const k=window.open("","_blank");if(!k){alert("Please allow pop-ups to print the counting sheet");return}const F=Z();k.document.write(F),k.document.close(),k.onload=()=>{k.print(),k.onafterprint=()=>{k.close()}}},Z=()=>{const k=Y().map((F,V)=>{const z=oe(F.id,u()!=="all"?u():void 0);return`
        <tr>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${V+1}</td>
          <td style="border: 1px solid #000; padding: 8px; font-family: monospace;">${F.sku}</td>
          <td style="border: 1px solid #000; padding: 8px;">
            <div style="font-weight: 500;">${F.name}</div>
            ${F.UPC?`<div style="font-size: 0.8em; color: #666;">UPC: ${F.UPC}</div>`:""}
          </td>
          <td style="border: 1px solid #000; padding: 8px;">${F.category}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${F.unitOfMeasure}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">${z}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; background-color: #f9f9f9;">________</td>
          <td style="border: 1px solid #000; padding: 8px;">_______________</td>
        </tr>
      `}).join("");return`
      <!DOCTYPE html>
      <html>
      <head>
        <title> ${he()}_${f()}_${e("inventory.countingSheet","Inventory Counting Sheet")} - ${W()}</title>
        <style>
          @page {
            size: letter;
            margin: 0.5in;
          }
          body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            margin: 0;
            padding: 0;
          }
          h1 {
            text-align: center;
            margin: 0 0 10px 0;
            font-size: 24px;
          }
          .header-info {
            text-align: center;
            margin-bottom: 20px;
          }
          .instructions {
            background-color: #f0f0f0;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
          }
          th {
            background-color: #333;
            color: white;
            padding: 8px;
            text-align: left;
            font-weight: bold;
            border: 1px solid #000;
          }
          .summary-table {
            width: 50%;
            margin: 20px auto;
          }
          .signature-section {
            margin-top: 40px;
            display: flex;
            justify-content: space-between;
          }
          .signature-box {
            width: 45%;
            text-align: center;
          }
          .signature-line {
            border-bottom: 1px solid #000;
            margin-bottom: 5px;
            height: 30px;
          }
          @media print {
            tr { page-break-inside: avoid; }
          }
        </style>
      </head>
      <body>
        <h1>${e("inventory.inventoryCountingSheetTitle","INVENTORY COUNTING SHEET")}</h1>
        <div class="header-info">
          <p><strong>${e("inventory.location","Location")}:</strong> ${he()}</p>
          <p><strong>${e("common.category","Category")}:</strong> ${f()==="all"?e("inventory.allCategories","All Categories"):f()}</p>
          <p><strong>${e("common.date","Date")}:</strong> ${W()}</p>
          <p style="margin-top: 10px;">
            <span style="margin-right: 30px;">${e("inventory.countedBy","Counted by")}: _________________________</span>
            <span>${e("inventory.verifiedBy","Verified by")}: _________________________</span>
          </p>
        </div>

        <table>
          <thead>
            <tr>
              <th style="width: 5%; text-align: center;">#</th>
              <th style="width: 12%;">${e("inventory.sku","SKU")}</th>
              <th style="width: 25%;">${e("inventory.productName","Product Name")}</th>
              <th style="width: 12%;">${e("common.category","Category")}</th>
              <th style="width: 8%; text-align: center;">${e("inventory.unit","Unit")}</th>
              <th style="width: 10%; text-align: center;">${e("inventory.systemQty","System Qty")}</th>
              <th style="width: 12%; text-align: center; background-color: #f0f0f0;">${e("inventory.physicalCount","Physical Count")}</th>
              <th style="width: 16%;">${e("common.notes","Notes")}</th>
            </tr>
          </thead>
          <tbody>
            ${k}
          </tbody>
        </table>
        
        <table class="summary-table">
          <tr>
            <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
              ${e("inventory.totalProductsListed","Total Products Listed")}:
            </td>
            <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">
              ${Y().length}
            </td>
          </tr>
          <tr>
            <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
              ${e("inventory.itemsCounted","Items Counted")}:
            </td>
            <td style="border: 1px solid #000; padding: 8px; text-align: center;">
              ___________
            </td>
          </tr>
          <tr>
            <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
              ${e("inventory.discrepanciesFound","Discrepancies Found")}:
            </td>
            <td style="border: 1px solid #000; padding: 8px; text-align: center;">
              ___________
            </td>
          </tr>
        </table>
        
        <div class="signature-section">
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.counterSignature","Counter Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.supervisorSignature","Supervisor Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
        </div>
      </body>
      </html>
    `};return S(Ue,{get when(){return t.isOpen},get children(){var k=JA(),F=k.firstChild,V=F.firstChild,z=V.firstChild;z.firstChild;var me=z.nextSibling;return k.style.setProperty("position","fixed"),k.style.setProperty("top","0"),k.style.setProperty("left","0"),k.style.setProperty("right","0"),k.style.setProperty("bottom","0"),k.style.setProperty("background","rgba(0, 0, 0, 0.5)"),k.style.setProperty("z-index","1000"),k.style.setProperty("display","flex"),k.style.setProperty("align-items","center"),k.style.setProperty("justify-content","center"),F.style.setProperty("background","white"),F.style.setProperty("border-radius","var(--border-radius)"),F.style.setProperty("padding","2rem"),F.style.setProperty("width","95%"),F.style.setProperty("height","95%"),F.style.setProperty("max-width","1400px"),F.style.setProperty("overflow-y","auto"),F.style.setProperty("position","relative"),V.style.setProperty("display","flex"),V.style.setProperty("justify-content","space-between"),V.style.setProperty("align-items","center"),V.style.setProperty("margin-bottom","2rem"),V.style.setProperty("border-bottom","1px solid var(--border-color)"),V.style.setProperty("padding-bottom","1rem"),z.style.setProperty("margin","0"),z.style.setProperty("font-size","1.5rem"),s(z,()=>e("inventory.physicalInventoryCount","Physical Inventory Count"),null),Ii(me,"click",t.onClose,!0),me.style.setProperty("background","none"),me.style.setProperty("border","none"),me.style.setProperty("font-size","1.5rem"),me.style.setProperty("cursor","pointer"),me.style.setProperty("padding","0.5rem"),s(F,S(Ue,{get when(){return E()==="setup"},get children(){var K=WA(),de=K.firstChild,N=de.nextSibling,j=N.nextSibling,Q=j.nextSibling,J=Q.firstChild,ce=J.firstChild,ae=ce.firstChild,M=ce.nextSibling,ne=M.firstChild,pe=J.nextSibling,ve=pe.firstChild,ee=ve.firstChild,ie=ve.nextSibling,R=ie.firstChild,L=pe.nextSibling,B=L.firstChild,ge=B.firstChild,le=B.nextSibling,U=le.firstChild,G=U.nextSibling,Pe=G.nextSibling;return K.style.setProperty("text-align","center"),K.style.setProperty("padding","2rem"),K.style.setProperty("max-width","600px"),K.style.setProperty("margin","0 auto"),de.style.setProperty("font-size","3rem"),de.style.setProperty("margin-bottom","1rem"),N.style.setProperty("margin-bottom","1rem"),s(N,()=>e("inventory.setupPhysicalCount","Setup Physical Inventory Count")),j.style.setProperty("margin-bottom","2rem"),j.style.setProperty("color","var(--text-muted)"),s(j,()=>e("inventory.setupDescription","Configure your physical inventory count settings and begin the counting process.")),Q.style.setProperty("display","grid"),Q.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),Q.style.setProperty("gap","1rem"),Q.style.setProperty("margin-bottom","2rem"),Q.style.setProperty("padding","1rem"),Q.style.setProperty("background","var(--surface-color)"),Q.style.setProperty("border-radius","var(--border-radius)"),Q.style.setProperty("text-align","left"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),s(ce,()=>e("inventory.location","Location"),ae),M.addEventListener("change",_e=>h(_e.target.value)),M.style.setProperty("width","100%"),M.style.setProperty("padding","0.5rem"),M.style.setProperty("border","1px solid var(--border-color)"),M.style.setProperty("border-radius","var(--border-radius-sm)"),s(ne,()=>e("inventory.allLocations","All Locations")),s(M,S(Ut,{get each(){return ue()},children:_e=>(()=>{var se=Eh();return s(se,()=>_e.name),re(()=>se.value=_e.id),se})()}),null),ve.style.setProperty("display","block"),ve.style.setProperty("margin-bottom","0.5rem"),ve.style.setProperty("font-weight","500"),s(ve,()=>e("inventory.category","Category"),ee),ie.addEventListener("change",_e=>p(_e.target.value)),ie.style.setProperty("width","100%"),ie.style.setProperty("padding","0.5rem"),ie.style.setProperty("border","1px solid var(--border-color)"),ie.style.setProperty("border-radius","var(--border-radius-sm)"),s(R,()=>e("products.allCategories","All Categories")),s(ie,S(Ut,{get each(){return te()},children:_e=>(()=>{var se=Eh();return se.value=_e,s(se,_e),se})()}),null),B.style.setProperty("display","block"),B.style.setProperty("margin-bottom","0.5rem"),B.style.setProperty("font-weight","500"),s(B,()=>e("inventory.sortBy","Sort By"),ge),le.addEventListener("change",_e=>C(_e.target.value)),le.style.setProperty("width","100%"),le.style.setProperty("padding","0.5rem"),le.style.setProperty("border","1px solid var(--border-color)"),le.style.setProperty("border-radius","var(--border-radius-sm)"),s(U,()=>e("inventory.productName","Product Name")),s(G,()=>e("inventory.sku","SKU")),s(Pe,()=>e("inventory.category","Category")),s(K,S(Ue,{get when(){return!i()},get fallback(){return(()=>{var _e=XA(),se=_e.firstChild;return _e.style.setProperty("padding","2rem"),s(_e,()=>e("common.loading","Loading"),se),_e})()},get children(){return[(()=>{var _e=qA(),se=_e.firstChild;return se.firstChild,_e.style.setProperty("padding","1rem"),_e.style.setProperty("background","#fff3cd"),_e.style.setProperty("border-radius","var(--border-radius-sm)"),_e.style.setProperty("margin-bottom","2rem"),se.style.setProperty("margin","0"),se.style.setProperty("color","#856404"),s(se,()=>e("inventory.countWillInclude","This count will include {{count}} products from {{location}} in {{category}} category.",{count:Y().length,location:he(),category:f()==="all"?e("inventory.allCategories","all categories"):f()}),null),_e})(),(()=>{var _e=HA();return _e.style.setProperty("display","grid"),_e.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),_e.style.setProperty("gap","1rem"),_e.style.setProperty("margin-bottom","2rem"),_e.style.setProperty("padding","1rem"),_e.style.setProperty("background","var(--surface-color)"),_e.style.setProperty("border-radius","var(--border-radius)"),s(_e,S(Ne,{variant:"primary",size:"large",onClick:I,get disabled(){return i()||Y().length===0},get children(){return[" ",fe(()=>e("inventory.startCounting","Start Physical Count"))]}}),null),s(_e,S(Ne,{variant:"primary",onClick:$,get disabled(){return i()},get children(){return[" ",fe(()=>e("common.print","Print"))]}}),null),_e})()]}}),null),re(()=>M.value=u()),re(()=>ie.value=f()),re(()=>le.value=b()),K}}),null),s(F,S(Ue,{get when(){return E()==="counting"},get children(){var K=GA(),de=K.firstChild,N=de.firstChild,j=N.firstChild,Q=j.nextSibling,J=N.nextSibling,ce=J.firstChild,ae=ce.nextSibling,M=J.nextSibling,ne=M.firstChild,pe=ne.nextSibling,ve=M.nextSibling,ee=ve.firstChild,ie=ee.firstChild,R=ee.nextSibling,L=de.nextSibling,B=L.nextSibling,ge=B.firstChild,le=ge.firstChild,U=le.firstChild,G=U.firstChild,Pe=G.nextSibling,_e=Pe.nextSibling,se=_e.nextSibling,be=se.nextSibling,X=be.nextSibling,we=le.nextSibling;return de.style.setProperty("display","grid"),de.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),de.style.setProperty("gap","1rem"),de.style.setProperty("margin-bottom","2rem"),de.style.setProperty("padding","1rem"),de.style.setProperty("background","var(--surface-color)"),de.style.setProperty("border-radius","var(--border-radius)"),N.style.setProperty("text-align","center"),j.style.setProperty("font-size","1.5rem"),j.style.setProperty("font-weight","700"),j.style.setProperty("color","var(--primary-color)"),s(j,()=>P().countedProducts),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),s(Q,()=>e("inventory.counted","Counted")),J.style.setProperty("text-align","center"),ce.style.setProperty("font-size","1.5rem"),ce.style.setProperty("font-weight","700"),ce.style.setProperty("color","#ff9800"),s(ce,()=>P().remainingProducts),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),s(ae,()=>e("inventory.remaining","Remaining")),M.style.setProperty("text-align","center"),ne.style.setProperty("font-size","1.5rem"),ne.style.setProperty("font-weight","700"),ne.style.setProperty("color","#f44336"),s(ne,()=>P().variances),pe.style.setProperty("font-size","0.875rem"),pe.style.setProperty("color","var(--text-muted)"),s(pe,()=>e("inventory.variances","Variances")),ve.style.setProperty("text-align","center"),ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","700"),s(ee,()=>Math.round(P().countedProducts/P().totalProducts*100),ie),R.style.setProperty("font-size","0.875rem"),R.style.setProperty("color","var(--text-muted)"),s(R,()=>e("inventory.complete","Complete")),L.style.setProperty("display","flex"),L.style.setProperty("gap","1rem"),L.style.setProperty("margin-bottom","2rem"),L.style.setProperty("justify-content","center"),s(L,S(Ne,{variant:"outline",onClick:()=>T("setup"),get children(){return[" ",fe(()=>e("common.back","Back to Setup"))]}}),null),s(L,S(Ne,{variant:"primary",onClick:()=>T("review"),get children(){return[" ",fe(()=>e("inventory.reviewAdjustments","Review Adjustments"))]}}),null),B.style.setProperty("border","1px solid var(--border-color)"),B.style.setProperty("border-radius","var(--border-radius)"),B.style.setProperty("overflow-x","auto"),ge.style.setProperty("width","100%"),ge.style.setProperty("border-collapse","collapse"),U.style.setProperty("background","var(--surface-color)"),G.style.setProperty("padding","1rem"),G.style.setProperty("text-align","left"),G.style.setProperty("border-bottom","1px solid var(--border-color)"),s(G,()=>e("inventory.no","No")),Pe.style.setProperty("padding","1rem"),Pe.style.setProperty("text-align","left"),Pe.style.setProperty("border-bottom","1px solid var(--border-color)"),s(Pe,()=>e("inventory.product","Product")),_e.style.setProperty("padding","1rem"),_e.style.setProperty("text-align","center"),_e.style.setProperty("border-bottom","1px solid var(--border-color)"),s(_e,()=>e("inventory.systemQty","System Qty")),se.style.setProperty("padding","1rem"),se.style.setProperty("text-align","center"),se.style.setProperty("border-bottom","1px solid var(--border-color)"),s(se,()=>e("inventory.physicalCount","Physical Count")),be.style.setProperty("padding","1rem"),be.style.setProperty("text-align","center"),be.style.setProperty("border-bottom","1px solid var(--border-color)"),s(be,()=>e("inventory.variance","Variance")),X.style.setProperty("padding","1rem"),X.style.setProperty("text-align","left"),X.style.setProperty("border-bottom","1px solid var(--border-color)"),s(X,()=>e("common.notes","Notes")),s(we,S(Ut,{get each(){return D()},children:(ke,xe)=>S(rI,{get index(){return xe()},updatePhysicalCount:_,entry:ke,updateNotes:v})})),re(ke=>(ke=P().isComplete?"#4caf50":"#ff9800")!=null?ee.style.setProperty("color",ke):ee.style.removeProperty("color")),K}}),null),s(F,S(Ue,{get when(){return E()==="review"},get children(){var K=QA(),de=K.firstChild,N=de.firstChild;N.firstChild;var j=N.nextSibling,Q=de.nextSibling,J=Q.firstChild,ce=J.firstChild,ae=ce.nextSibling,M=J.nextSibling,ne=M.firstChild,pe=ne.nextSibling,ve=M.nextSibling,ee=ve.firstChild,ie=ee.nextSibling,R=Q.nextSibling;return de.style.setProperty("text-align","center"),de.style.setProperty("margin-bottom","2rem"),N.style.setProperty("margin-bottom","1rem"),s(N,()=>e("inventory.reviewAndConfirm","Review and Confirm Adjustments"),null),j.style.setProperty("color","var(--text-muted)"),s(j,()=>e("inventory.reviewDescription","Review the inventory adjustments below and confirm to update your system.")),Q.style.setProperty("display","grid"),Q.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),Q.style.setProperty("gap","1rem"),Q.style.setProperty("margin-bottom","2rem"),Q.style.setProperty("padding","1rem"),Q.style.setProperty("background","var(--surface-color)"),Q.style.setProperty("border-radius","var(--border-radius)"),J.style.setProperty("text-align","center"),ce.style.setProperty("font-size","1.5rem"),ce.style.setProperty("font-weight","700"),ce.style.setProperty("color","#4caf50"),s(ce,()=>P().positiveVariances),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),s(ae,()=>e("inventory.stockIncreases","Stock Increases")),M.style.setProperty("text-align","center"),ne.style.setProperty("font-size","1.5rem"),ne.style.setProperty("font-weight","700"),ne.style.setProperty("color","#f44336"),s(ne,()=>P().negativeVariances),pe.style.setProperty("font-size","0.875rem"),pe.style.setProperty("color","var(--text-muted)"),s(pe,()=>e("inventory.stockDecreases","Stock Decreases")),ve.style.setProperty("text-align","center"),ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","700"),ee.style.setProperty("color","var(--primary-color)"),s(ee,()=>P().variances),ie.style.setProperty("font-size","0.875rem"),ie.style.setProperty("color","var(--text-muted)"),s(ie,()=>e("inventory.totalAdjustments","Total Adjustments")),R.style.setProperty("display","flex"),R.style.setProperty("gap","1rem"),R.style.setProperty("margin-bottom","2rem"),R.style.setProperty("justify-content","center"),R.style.setProperty("flex-wrap","wrap"),s(R,S(Ne,{variant:"outline",onClick:()=>T("counting"),get children(){return[" ",fe(()=>e("common.back","Back to Counting"))]}}),null),s(R,S(Ne,{variant:"outline",onClick:A,get disabled(){return P().variances===0},get children(){return[" ",fe(()=>e("inventory.downloadCSV","Download CSV"))]}}),null),s(R,S(Ne,{variant:"primary",onClick:y,get disabled(){return a()||P().variances===0},get children(){return fe(()=>!!a())()?" "+e("common.saving","Saving")+"...":" "+e("inventory.confirmAdjustments","Confirm Adjustments")}}),null),s(K,S(Ue,{get when(){return P().variances>0},get children(){var L=KA(),B=L.firstChild,ge=B.firstChild,le=ge.firstChild,U=le.firstChild,G=U.nextSibling,Pe=G.nextSibling,_e=Pe.nextSibling,se=_e.nextSibling,be=ge.nextSibling;return L.style.setProperty("border","1px solid var(--border-color)"),L.style.setProperty("border-radius","var(--border-radius)"),L.style.setProperty("overflow-x","auto"),B.style.setProperty("width","100%"),B.style.setProperty("border-collapse","collapse"),le.style.setProperty("background","var(--surface-color)"),U.style.setProperty("padding","1rem"),U.style.setProperty("text-align","left"),U.style.setProperty("border-bottom","1px solid var(--border-color)"),s(U,()=>e("inventory.product","Product")),G.style.setProperty("padding","1rem"),G.style.setProperty("text-align","center"),G.style.setProperty("border-bottom","1px solid var(--border-color)"),s(G,()=>e("inventory.systemQty","System Qty")),Pe.style.setProperty("padding","1rem"),Pe.style.setProperty("text-align","center"),Pe.style.setProperty("border-bottom","1px solid var(--border-color)"),s(Pe,()=>e("inventory.physicalCount","Physical Count")),_e.style.setProperty("padding","1rem"),_e.style.setProperty("text-align","center"),_e.style.setProperty("border-bottom","1px solid var(--border-color)"),s(_e,()=>e("inventory.adjustment","Adjustment")),se.style.setProperty("padding","1rem"),se.style.setProperty("text-align","left"),se.style.setProperty("border-bottom","1px solid var(--border-color)"),s(se,()=>e("common.notes","Notes")),s(be,S(Ut,{get each(){return D().filter(X=>X.variance!==0)},children:X=>(()=>{var we=ZA(),ke=we.firstChild,xe=ke.firstChild,Te=xe.nextSibling,Oe=Te.firstChild,We=ke.nextSibling,je=We.firstChild,Ie=We.nextSibling,Ve=Ie.firstChild,He=Ie.nextSibling,qe=He.firstChild,Ge=He.nextSibling,Ae=Ge.firstChild;return we.style.setProperty("border-bottom","1px solid var(--border-color)"),ke.style.setProperty("padding","1rem"),xe.style.setProperty("font-weight","500"),s(xe,()=>X.product.name),Te.style.setProperty("font-size","0.875rem"),Te.style.setProperty("color","var(--text-muted)"),s(Te,()=>X.product.sku,Oe),s(Te,()=>X.product.category,null),We.style.setProperty("padding","1rem"),We.style.setProperty("text-align","center"),je.style.setProperty("font-weight","600"),s(je,()=>X.systemQuantity),Ie.style.setProperty("padding","1rem"),Ie.style.setProperty("text-align","center"),Ve.style.setProperty("font-weight","600"),s(Ve,()=>X.physicalCount),He.style.setProperty("padding","1rem"),He.style.setProperty("text-align","center"),qe.style.setProperty("font-weight","700"),s(qe,()=>X.variance>0?"+":"",null),s(qe,()=>X.variance,null),Ge.style.setProperty("padding","1rem"),Ae.style.setProperty("font-size","0.875rem"),s(Ae,()=>X.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")),re(rt=>{var et=X.variance>0?"#d4edda":"#f8d7da",ct=X.variance>0?"#4caf50":"#f44336";return et!==rt.e&&((rt.e=et)!=null?we.style.setProperty("background",et):we.style.removeProperty("background")),ct!==rt.t&&((rt.t=ct)!=null?qe.style.setProperty("color",ct):qe.style.removeProperty("color")),rt},{e:void 0,t:void 0}),we})()})),L}}),null),s(K,S(Ue,{get when(){return P().variances===0},get children(){var L=YA(),B=L.firstChild,ge=B.nextSibling,le=ge.nextSibling;return L.style.setProperty("text-align","center"),L.style.setProperty("padding","3rem"),L.style.setProperty("background","var(--surface-color)"),L.style.setProperty("border-radius","var(--border-radius)"),B.style.setProperty("font-size","3rem"),B.style.setProperty("margin-bottom","1rem"),ge.style.setProperty("margin-bottom","0.5rem"),s(ge,()=>e("inventory.perfectCount","Perfect Count!")),le.style.setProperty("color","var(--text-muted)"),s(le,()=>e("inventory.noVariances","No variances found. Your physical count matches the system exactly.")),L}}),null),K}}),null),k}})},rI=t=>{const{t:e}=at(),[r,n]=ye(""),[i,o]=ye("");let{entry:a,updatePhysicalCount:c,updateNotes:u,index:h}=t;return hn(()=>{o(a?.notes),n(a?.physicalCount)}),(()=>{var f=eI(),p=f.firstChild,b=p.firstChild,C=p.nextSibling,D=C.firstChild,x=D.nextSibling,E=x.firstChild,T=E.nextSibling;T.nextSibling;var H=C.nextSibling,te=H.firstChild,Y=H.nextSibling,ue=Y.firstChild,oe=Y.nextSibling,I=oe.firstChild,_=oe.nextSibling,v=_.firstChild;return f.style.setProperty("border-bottom","1px solid var(--border-color)"),p.style.setProperty("padding","1rem"),p.style.setProperty("text-align","center"),b.style.setProperty("font-weight","600"),s(b,h+1),C.style.setProperty("padding","1rem"),D.style.setProperty("font-weight","500"),s(D,()=>a?.product.name),x.style.setProperty("font-size","0.875rem"),x.style.setProperty("color","var(--text-muted)"),s(x,()=>a?.product.sku,E),s(x,()=>a?.product.category,T),s(x,()=>a?.product.unitOfMeasure,null),H.style.setProperty("padding","1rem"),H.style.setProperty("text-align","center"),te.style.setProperty("font-weight","600"),s(te,()=>a?.systemQuantity),Y.style.setProperty("padding","1rem"),Y.style.setProperty("text-align","center"),ue.addEventListener("blur",()=>{c(a?.productId,r()===""?null:parseFloat(r()))}),ue.$$keydown=P=>{P.keyCode===13&&c(a?.productId,r()===""?null:parseFloat(r())),P.keyCode===27&&c(a?.productId,r()===""?null:parseFloat(r())),P.keyCode===9&&c(a?.productId,r()===""?null:parseFloat(r()))},ue.$$input=P=>{const w=P.target.value;n(w)},ut(ue,"tabindex",h),ue.style.setProperty("width","100px"),ue.style.setProperty("padding","0.5rem"),ue.style.setProperty("border","1px solid var(--border-color)"),ue.style.setProperty("border-radius","var(--border-radius-sm)"),ue.style.setProperty("text-align","center"),oe.style.setProperty("padding","1rem"),oe.style.setProperty("text-align","center"),I.style.setProperty("font-weight","600"),s(I,()=>a?.variance>0?"+":"",null),s(I,()=>a?.variance||"",null),_.style.setProperty("padding","1rem"),v.addEventListener("blur",P=>{u(a?.productId,i())}),v.$$keydown=P=>{P.keyCode===13&&u(a?.productId,i()),P.keyCode===27&&u(a?.productId,i()),P.keyCode===9&&u(a?.productId,i())},v.$$input=P=>{const w=P.target.value;o(w)},v.style.setProperty("width","200px"),v.style.setProperty("padding","0.5rem"),v.style.setProperty("border","1px solid var(--border-color)"),v.style.setProperty("border-radius","var(--border-radius-sm)"),re(P=>{var w=a?.physicalCount!==null?a?.variance!==0?"#fff3cd":"#d4edda":"transparent",A=a?.variance>0?"#4caf50":a?.variance<0?"#f44336":"var(--text-muted)",y=e("inventory.addNotes","Add notes...");return w!==P.e&&((P.e=w)!=null?f.style.setProperty("background",w):f.style.removeProperty("background")),A!==P.t&&((P.t=A)!=null?I.style.setProperty("color",A):I.style.removeProperty("color")),y!==P.a&&ut(v,"placeholder",P.a=y),P},{e:void 0,t:void 0,a:void 0}),re(()=>ue.value=r()||""),re(()=>v.value=i()||""),f})()};At(["click","input","keydown"]);var nI=q("<form><div><label> *</label><input type=text required></div><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text list=categories required><datalist id=categories><option value=Electronics></option><option value=Accessories></option><option value=Office></option><option value=Furniture></option><option value=Software></option><option value=Hardware></option></datalist></div></div><div><label></label><textarea></textarea></div><div><label></label><div><input type=checkbox id=activeStatus><label for=activeStatus></label></div></div><div><div><label></label><select><option value=pcs></option><option value=kg></option><option value=lbs></option><option value=m></option><option value=ft></option><option value=l></option><option value=gal></option><option value=box></option><option value=pack></option></select></div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div></div><div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div><div></div></div><div><div><span>:</span><span>$</span></div><div><span>:</span><span>%</span></div></div><div><div><label></label><input type=number min=0 step=1></div><div><label></label><input type=number min=1 step=1></div></div><div>"),xh=q("<div>"),iI=q("<span> "),oI=q("<span> ");const sI=t=>{const{t:e}=at(),[r,n]=ye(""),[i,o]=ye(""),[a,c]=ye(""),[u,h]=ye(""),[f,p]=ye("pcs"),[b,C]=ye(0),[D,x]=ye(0),[E,T]=ye(10),[H,te]=ye(100),[Y,ue]=ye(!0),[oe,I]=ye("");Tn(()=>{t.product&&(n(t.product.name),o(t.product.sku),c(t.product.description||""),h(t.product.category),p(t.product.unitOfMeasure),C(t.product.unitCost),x(t.product.sellingPrice),T(t.product.minStockLevel),te(t.product.maxStockLevel),ue(t.product.isActive),I(""))});const _=V=>{if(V.preventDefault(),I(""),!t.product)return;if(!r().trim()){I(e("forms.productNameRequired","Product name is required"));return}if(!i().trim()){I(e("forms.skuRequired","SKU is required"));return}if(!u().trim()){I(e("forms.categoryRequired","Category is required"));return}if(b()<0){I(e("forms.unitCostNotNegative","Unit cost cannot be negative"));return}if(D()<0){I(e("forms.sellingPriceNotNegative","Selling price cannot be negative"));return}if(E()<0){I(e("forms.minStockNotNegative","Min stock level cannot be negative"));return}if(H()<=E()){I(e("forms.maxStockGreaterThanMin","Max stock level must be greater than min stock level"));return}const z=De.getProductsBySku(i());if(z.length>0&&z[0].id!==t.product.id){I(e("forms.skuAlreadyExists","SKU already exists"));return}const me={...t.product,name:r().trim(),sku:i().trim().toUpperCase(),description:a().trim(),category:u().trim(),unitOfMeasure:f(),unitCost:b(),sellingPrice:D(),minStockLevel:E(),maxStockLevel:H(),isActive:Y(),lastModified:new Date().toISOString()};De.updateProduct(t.product.id,me),t.onProductUpdated&&t.onProductUpdated(t.product.id),t.onClose()},v=()=>{I(""),t.onClose()},P=()=>b()===0?0:((D()-b())/b()*100).toFixed(2),w={"margin-bottom":"1.5rem"},A={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},y={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},he={...y,cursor:"pointer"},W={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},$={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},Z={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"},k={padding:"1rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-bottom":"1.5rem",display:"flex","justify-content":"space-between","align-items":"center"},F={display:"flex","align-items":"center",gap:"0.5rem",cursor:"pointer"};return S(dr,{get isOpen(){return t.isOpen},onClose:v,get title(){return e("products.updateProduct","Update Product")},size:"large",get children(){return S(Ue,{get when(){return t.product},get fallback(){return(()=>{var V=xh();return V.style.setProperty("text-align","center"),V.style.setProperty("padding","2rem"),V.style.setProperty("color","var(--text-muted)"),s(V,()=>e("products.noProductSelected","No product selected")),V})()},get children(){var V=nI(),z=V.firstChild,me=z.firstChild,K=me.firstChild,de=me.nextSibling,N=z.nextSibling,j=N.firstChild,Q=j.firstChild,J=Q.firstChild,ce=Q.nextSibling,ae=j.nextSibling,M=ae.firstChild,ne=M.firstChild,pe=M.nextSibling,ve=N.nextSibling,ee=ve.firstChild,ie=ee.nextSibling,R=ve.nextSibling,L=R.firstChild,B=L.nextSibling,ge=B.firstChild,le=ge.nextSibling,U=R.nextSibling,G=U.firstChild,Pe=G.firstChild,_e=Pe.nextSibling,se=_e.firstChild,be=se.nextSibling,X=be.nextSibling,we=X.nextSibling,ke=we.nextSibling,xe=ke.nextSibling,Te=xe.nextSibling,Oe=Te.nextSibling,We=Oe.nextSibling,je=G.nextSibling,Ie=je.firstChild,Ve=Ie.nextSibling,He=U.nextSibling,qe=He.firstChild,Ge=qe.firstChild,Ae=Ge.nextSibling,rt=He.nextSibling,et=rt.firstChild,ct=et.firstChild,xt=ct.firstChild,_t=ct.nextSibling;_t.firstChild;var Ht=et.nextSibling,mt=Ht.firstChild,Qt=mt.firstChild,ht=mt.nextSibling,St=ht.firstChild,Lt=rt.nextSibling,Nt=Lt.firstChild,Me=Nt.firstChild,Be=Me.nextSibling,Ye=Nt.nextSibling,ot=Ye.firstChild,kt=ot.nextSibling,Qe=Lt.nextSibling;return V.addEventListener("submit",_),s(me,()=>e("inventory.productName","Product Name"),K),de.addEventListener("change",Ee=>n(Ee.target.value)),s(Q,()=>e("inventory.sku","SKU"),J),ce.addEventListener("change",Ee=>o(Ee.target.value)),s(M,()=>e("inventory.category","Category"),ne),pe.addEventListener("change",Ee=>h(Ee.target.value)),s(ee,()=>e("common.description","Description")),ie.addEventListener("change",Ee=>c(Ee.target.value)),s(L,()=>e("products.status","Status")),d(B,F),ge.addEventListener("change",Ee=>ue(Ee.target.checked)),ge.style.setProperty("cursor","pointer"),le.style.setProperty("cursor","pointer"),s(le,(()=>{var Ee=fe(()=>!!Y());return()=>Ee()?(()=>{var nt=iI();return nt.firstChild,nt.style.setProperty("color","#2e7d32"),s(nt,()=>e("common.active","Active"),null),nt})():(()=>{var nt=oI();return nt.firstChild,nt.style.setProperty("color","#d32f2f"),s(nt,()=>e("common.inactive","Inactive"),null),nt})()})()),s(Pe,()=>e("inventory.unitOfMeasure","Unit of Measure")),_e.addEventListener("change",Ee=>p(Ee.target.value)),s(se,()=>e("inventory.pieces","Pieces")),s(be,()=>e("inventory.kilograms","Kilograms")),s(X,()=>e("inventory.pounds","Pounds")),s(we,()=>e("inventory.meters","Meters")),s(ke,()=>e("inventory.feet","Feet")),s(xe,()=>e("inventory.liters","Liters")),s(Te,()=>e("inventory.gallons","Gallons")),s(Oe,()=>e("inventory.boxes","Boxes")),s(We,()=>e("inventory.packs","Packs")),s(Ie,()=>e("inventory.unitCost","Unit Cost")),Ve.addEventListener("change",Ee=>C(Number(Ee.target.value))),s(Ge,()=>e("inventory.sellingPrice","Selling Price")),Ae.addEventListener("change",Ee=>x(Number(Ee.target.value))),d(rt,k),ct.style.setProperty("color","var(--text-muted)"),ct.style.setProperty("font-size","0.875rem"),s(ct,()=>e("products.profit","Profit"),xt),_t.style.setProperty("margin-left","0.5rem"),_t.style.setProperty("font-weight","600"),s(_t,()=>(D()-b()).toFixed(2),null),mt.style.setProperty("color","var(--text-muted)"),mt.style.setProperty("font-size","0.875rem"),s(mt,()=>e("products.profitMargin","Profit Margin"),Qt),ht.style.setProperty("margin-left","0.5rem"),ht.style.setProperty("font-weight","600"),s(ht,P,St),s(Me,()=>e("inventory.minimumStockLevel","Minimum Stock Level")),Be.addEventListener("change",Ee=>T(Number(Ee.target.value))),s(ot,()=>e("inventory.maximumStockLevel","Maximum Stock Level")),kt.addEventListener("change",Ee=>te(Number(Ee.target.value))),s(V,(()=>{var Ee=fe(()=>!!oe());return()=>Ee()&&(()=>{var nt=xh();return d(nt,W),s(nt,oe),nt})()})(),Qe),d(Qe,$),s(Qe,S(Ne,{variant:"secondary",type:"button",onClick:v,get children(){return e("common.cancel","Cancel")}}),null),s(Qe,S(Ne,{variant:"primary",type:"submit",get children(){return e("common.update","Update")}}),null),re(Ee=>{var nt=w,ft=A,Pt=y,sr=e("inventory.enterProductName","Enter product name"),Rt=Z,jt=A,ar=y,Tt=e("inventory.enterSkuCode","Enter SKU code"),Kt=A,$r=y,Mt=e("inventory.enterCategory","Enter category"),rr=w,xr=A,zr={...y,"min-height":"80px",resize:"vertical"},Ar=e("inventory.enterProductDescription","Enter product description"),mn=w,kn=A,Ri=Z,oi=A,si=he,Rn=A,Qr=y,Di=Z,ai=A,dt=y,Dt=Z,lr=A,kr=y,qr=A,Ot=y;return Ee.e=d(z,nt,Ee.e),Ee.t=d(me,ft,Ee.t),Ee.a=d(de,Pt,Ee.a),sr!==Ee.o&&ut(de,"placeholder",Ee.o=sr),Ee.i=d(N,Rt,Ee.i),Ee.n=d(Q,jt,Ee.n),Ee.s=d(ce,ar,Ee.s),Tt!==Ee.h&&ut(ce,"placeholder",Ee.h=Tt),Ee.r=d(M,Kt,Ee.r),Ee.d=d(pe,$r,Ee.d),Mt!==Ee.l&&ut(pe,"placeholder",Ee.l=Mt),Ee.u=d(ve,rr,Ee.u),Ee.c=d(ee,xr,Ee.c),Ee.w=d(ie,zr,Ee.w),Ar!==Ee.m&&ut(ie,"placeholder",Ee.m=Ar),Ee.f=d(R,mn,Ee.f),Ee.y=d(L,kn,Ee.y),Ee.g=d(U,Ri,Ee.g),Ee.p=d(Pe,oi,Ee.p),Ee.b=d(_e,si,Ee.b),Ee.T=d(Ie,Rn,Ee.T),Ee.A=d(Ve,Qr,Ee.A),Ee.O=d(He,Di,Ee.O),Ee.I=d(Ge,ai,Ee.I),Ee.S=d(Ae,dt,Ee.S),Ee.W=d(Lt,Dt,Ee.W),Ee.C=d(Me,lr,Ee.C),Ee.B=d(Be,kr,Ee.B),Ee.v=d(ot,qr,Ee.v),Ee.k=d(kt,Ot,Ee.k),Ee},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0}),re(()=>de.value=r()),re(()=>ce.value=i()),re(()=>pe.value=u()),re(()=>ie.value=a()),re(()=>ge.checked=Y()),re(()=>_e.value=f()),re(()=>Ve.value=b()),re(()=>Ae.value=D()),re(()=>Be.value=E()),re(()=>kt.value=H()),V}})}})};function aI(t,e=300,r=!1){let n,i;const o=()=>{n!==void 0&&(clearTimeout(n),n=void 0),i=void 0},a=()=>{n!==void 0&&i!==void 0&&(clearTimeout(n),n=void 0,t(...i),i=void 0)},c=(...u)=>{i=u,n!==void 0&&clearTimeout(n),r&&n===void 0&&t(...u),n=window.setTimeout(()=>{r||t(...u),n=void 0,i=void 0},e)};return so(()=>{o()}),{debounced:c,cancel:o,flush:a}}function lI(t,e=300){const[r,n]=ye(!1);let i;const o=async h=>{if(i&&i.abort(),!h.trim()){n(!1);return}i=new AbortController,n(!0);try{await t(h)}catch(f){f instanceof Error&&f.name!=="AbortError"&&console.error("Search error:",f)}finally{i.signal.aborted||n(!1)}},{debounced:a,cancel:c}=aI(o,e,!1),u=()=>{c(),i&&i.abort(),n(!1)};return so(()=>{u()}),{search:a,isSearching:r,cancel:u}}var Th=q("<div>"),cI=q("<div><h3></h3><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),uI=q("<div><h3></h3><div><div><div><span></span><span></span></div><div><span></span><span></span></div></div><div><div><span></span><span></span></div><div><span></span><span>%"),dI=q("<div><h4>"),hI=q("<div><h3></h3><div><div><div><span></span><span> </span></div><div><span></span><span> </span></div></div><div><div><span></span><span> </span></div><div><span></span><span>"),mI=q("<div><h3></h3><div><span></span><span></span></div><div><span></span><span>"),$h=q("<div><h3>"),fI=q("<div><div><div><h2></h2><div>SKU: <!>  </div></div><div></div></div><div><button></button><button></button><button></button></div><div>"),yI=q("<span> "),gI=q("<span> "),pI=q("<div><div><span><span>  </span></span><span> </span></div><div>: <!>  <!>: "),vI=q("<div> "),bI=q("<div>Ref: "),_I=q("<div><div><div><span></span><span></span><span></span></div><div><span></span></div></div><div><div> </div><div>"),SI=q("<div><h4></h4><div></div><div>"),PI=q("<div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div> <!>  </div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div>Min: <!>  Max: ");const wI=t=>{const{t:e}=at(),[r,n]=ye("details"),i=Ke(()=>{if(!t.product)return null;const v=De.getTotalStockByProduct(t.product.id),P=De.getStockByProduct(t.product.id),w=v<=t.product.minStockLevel,A=v===0,y=v>=t.product.maxStockLevel;return{total:v,byLocation:P,status:A?"out":w?"low":y?"over":"good",statusText:A?e("products.outOfStock","Out of Stock"):w?e("products.lowStock","Low Stock"):y?e("products.overStock","Over Stock"):e("products.inStock","In Stock")}}),o=v=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(v),a=v=>new Date(v).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),c=Ke(()=>!t.product||t.product.unitCost===0?0:((t.product.sellingPrice-t.product.unitCost)/t.product.unitCost*100).toFixed(2)),u=Ke(()=>t.product?De.movements.filter(v=>v.productId===t.product.id).sort((v,P)=>new Date(P.createdDate).getTime()-new Date(v.createdDate).getTime()):[]),h=Ke(()=>{if(!t.product)return null;const v=u(),P=i(),w=new Date;w.setDate(w.getDate()-30);const A=v.filter(he=>new Date(he.createdDate)>=w),y=v.reduce((he,W)=>{const $=W.productId===t.product.id?W:null;return he+($?$.quantity*$.unitCost:0)},0);return{recentMovements:v.length,movements30Days:A.length,totalValue:(P?.total||0)*t.product.unitCost,averageMovementValue:v.length>0?y/v.length:0,lastMovementDate:v.length>0?v[0].createdDate:null}}),f={"margin-bottom":"2rem"},p={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},b={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},C={"font-weight":"400",color:"var(--text-primary)","font-size":"1rem"},D=v=>({in:"",out:"",transfer:"",adjustment:""})[v]||"";function x(v){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[v]||{bg:"#f5f5f5",color:"#666"}}const E=v=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:x(v).bg,color:x(v).color}),T=v=>{const P={good:{background:"#d4edda",color:"#155724"},low:{background:"#fff3cd",color:"#856404"},out:{background:"#f8d7da",color:"#721c24"},over:{background:"#cce5ff",color:"#004085"}};return{display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500",...P[v]||P.good}},H={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"},te={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1rem","margin-bottom":"0.75rem"},Y={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1.5rem","padding-bottom":"1rem","border-bottom":"2px solid var(--border-color)"},ue={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},oe=v=>({padding:"0.75rem 1.5rem",background:"none",border:"none","border-bottom":v?"2px solid var(--primary-color)":"2px solid transparent",color:v?"var(--primary-color)":"var(--text-muted)","font-weight":v?"600":"400",cursor:"pointer",transition:"all 0.2s","font-size":"0.875rem"}),I={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-bottom":"0.5rem"},_={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1.5rem","margin-bottom":"1rem"};return S(dr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("products.productDetails","Product Details")},size:"large",get children(){return S(Ue,{get when(){return t.product},get fallback(){return(()=>{var v=Th();return v.style.setProperty("text-align","center"),v.style.setProperty("padding","2rem"),v.style.setProperty("color","var(--text-muted)"),s(v,()=>e("products.noProductSelected","No product selected")),v})()},children:v=>(()=>{var P=fI(),w=P.firstChild,A=w.firstChild,y=A.firstChild,he=y.nextSibling,W=he.firstChild,$=W.nextSibling;$.nextSibling;var Z=A.nextSibling,k=w.nextSibling,F=k.firstChild,V=F.nextSibling,z=V.nextSibling,me=k.nextSibling;return s(P,()=>JSON.stringify(v),w),d(w,Y),y.style.setProperty("margin","0"),y.style.setProperty("font-size","1.5rem"),y.style.setProperty("margin-bottom","0.25rem"),s(y,()=>v().name),he.style.setProperty("color","var(--text-muted)"),s(he,()=>v().sku,$),s(he,()=>v().category,null),s(Z,()=>i()?.statusText),d(k,ue),F.$$click=()=>n("details"),s(F,()=>e("products.details","Details")),V.$$click=()=>n("movements"),s(V,()=>e("products.movements","Movements")),z.$$click=()=>n("analytics"),s(z,()=>e("products.analytics","Analytics")),s(P,S(Ue,{get when(){return r()==="details"},get children(){return[(()=>{var K=cI(),de=K.firstChild,N=de.nextSibling,j=N.firstChild,Q=j.nextSibling,J=N.nextSibling,ce=J.firstChild,ae=ce.nextSibling,M=J.nextSibling,ne=M.firstChild,pe=ne.nextSibling;return de.style.setProperty("margin-bottom","1rem"),de.style.setProperty("font-size","1.1rem"),s(de,()=>e("products.basicInformation","Basic Information")),s(j,()=>e("products.description","Description")),s(Q,()=>v().description||e("common.notAvailable","N/A")),s(ce,()=>e("products.unitOfMeasure","Unit of Measure")),s(ae,()=>v().unitOfMeasure),s(ne,()=>e("products.status","Status")),s(pe,(()=>{var ve=fe(()=>!!v().isActive);return()=>ve()?(()=>{var ee=yI();return ee.firstChild,ee.style.setProperty("color","#2e7d32"),s(ee,()=>e("common.active","Active"),null),ee})():(()=>{var ee=gI();return ee.firstChild,ee.style.setProperty("color","#d32f2f"),s(ee,()=>e("common.inactive","Inactive"),null),ee})()})()),re(ve=>{var ee=f,ie=p,R=b,L=C,B=p,ge=b,le=C,U=p,G=b,Pe=C;return ve.e=d(K,ee,ve.e),ve.t=d(N,ie,ve.t),ve.a=d(j,R,ve.a),ve.o=d(Q,L,ve.o),ve.i=d(J,B,ve.i),ve.n=d(ce,ge,ve.n),ve.s=d(ae,le,ve.s),ve.h=d(M,U,ve.h),ve.r=d(ne,G,ve.r),ve.d=d(pe,Pe,ve.d),ve},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),K})(),(()=>{var K=uI(),de=K.firstChild,N=de.nextSibling,j=N.firstChild,Q=j.firstChild,J=Q.firstChild,ce=J.nextSibling,ae=Q.nextSibling,M=ae.firstChild,ne=M.nextSibling,pe=j.nextSibling,ve=pe.firstChild,ee=ve.firstChild,ie=ee.nextSibling,R=ve.nextSibling,L=R.firstChild,B=L.nextSibling,ge=B.firstChild;return de.style.setProperty("margin-bottom","1rem"),de.style.setProperty("font-size","1.1rem"),s(de,()=>e("products.pricingInformation","Pricing Information")),s(J,()=>e("products.unitCost","Unit Cost")),s(ce,()=>o(v().unitCost)),s(M,()=>e("products.sellingPrice","Selling Price")),s(ne,()=>o(v().sellingPrice)),s(ee,()=>e("products.profit","Profit")),s(ie,()=>o(v().sellingPrice-v().unitCost)),s(L,()=>e("products.profitMargin","Profit Margin")),s(B,c,ge),re(le=>{var U=f,G=H,Pe=p,_e=b,se=C,be=p,X=b,we=C,ke=p,xe=b,Te=C,Oe=p,We=b,je=C;return le.e=d(K,U,le.e),le.t=d(N,G,le.t),le.a=d(Q,Pe,le.a),le.o=d(J,_e,le.o),le.i=d(ce,se,le.i),le.n=d(ae,be,le.n),le.s=d(M,X,le.s),le.h=d(ne,we,le.h),le.r=d(ve,ke,le.r),le.d=d(ee,xe,le.d),le.l=d(ie,Te,le.l),le.u=d(R,Oe,le.u),le.c=d(L,We,le.c),le.w=d(B,je,le.w),le},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),K})(),(()=>{var K=hI(),de=K.firstChild,N=de.nextSibling,j=N.firstChild,Q=j.firstChild,J=Q.firstChild,ce=J.nextSibling,ae=ce.firstChild,M=Q.nextSibling,ne=M.firstChild,pe=ne.nextSibling,ve=pe.firstChild,ee=j.nextSibling,ie=ee.firstChild,R=ie.firstChild,L=R.nextSibling,B=L.firstChild,ge=ie.nextSibling,le=ge.firstChild,U=le.nextSibling;return de.style.setProperty("margin-bottom","1rem"),de.style.setProperty("font-size","1.1rem"),s(de,()=>e("products.stockInformation","Stock Information")),s(J,()=>e("products.totalStock","Total Stock")),s(ce,()=>i()?.total||0,ae),s(ce,()=>v().unitOfMeasure,null),s(ne,()=>e("products.minStockLevel","Min Stock Level")),s(pe,()=>v().minStockLevel,ve),s(pe,()=>v().unitOfMeasure,null),s(R,()=>e("products.maxStockLevel","Max Stock Level")),s(L,()=>v().maxStockLevel,B),s(L,()=>v().unitOfMeasure,null),s(le,()=>e("products.stockValue","Stock Value")),s(U,()=>o((i()?.total||0)*v().unitCost)),s(K,S(Ue,{get when(){return fe(()=>!!i()?.byLocation)()&&i().byLocation.length>0},get children(){var G=dI(),Pe=G.firstChild;return G.style.setProperty("margin-top","1.5rem"),Pe.style.setProperty("margin-bottom","1rem"),Pe.style.setProperty("font-size","1rem"),s(Pe,()=>e("products.stockByLocation","Stock by Location")),s(G,()=>i().byLocation.map(_e=>(()=>{var se=pI(),be=se.firstChild,X=be.firstChild,we=X.firstChild;we.firstChild;var ke=X.nextSibling,xe=ke.firstChild,Te=be.nextSibling,Oe=Te.firstChild,We=Oe.nextSibling,je=We.nextSibling,Ie=je.nextSibling;return Ie.nextSibling,d(se,te),be.style.setProperty("display","flex"),be.style.setProperty("justify-content","space-between"),be.style.setProperty("align-items","center"),X.style.setProperty("font-weight","500"),X.style.setProperty("color","var(--primary-color)"),s(X,()=>_e.locationId,we),we.style.setProperty("font-weight","500"),we.style.setProperty("color","var(--text-muted)"),s(we,()=>_e.locationName,null),ke.style.setProperty("font-weight","600"),s(ke,()=>_e.quantity,xe),s(ke,()=>v().unitOfMeasure,null),Te.style.setProperty("margin-top","0.5rem"),Te.style.setProperty("font-size","0.875rem"),Te.style.setProperty("color","var(--text-muted)"),s(Te,()=>e("products.available","Available"),Oe),s(Te,()=>_e.availableQuantity,We),s(Te,()=>e("products.reserved","Reserved"),Ie),s(Te,()=>_e.reservedQuantity,null),re(Ve=>(Ve=_e.quantity>0?"var(--primary-color)":"var(--text-muted)")!=null?ke.style.setProperty("color",Ve):ke.style.removeProperty("color")),se})()),null),G}}),null),re(G=>{var Pe=f,_e=H,se=p,be=b,X=C,we=p,ke=b,xe=C,Te=p,Oe=b,We=C,je=p,Ie=b,Ve=C;return G.e=d(K,Pe,G.e),G.t=d(N,_e,G.t),G.a=d(Q,se,G.a),G.o=d(J,be,G.o),G.i=d(ce,X,G.i),G.n=d(M,we,G.n),G.s=d(ne,ke,G.s),G.h=d(pe,xe,G.h),G.r=d(ie,Te,G.r),G.d=d(R,Oe,G.d),G.l=d(L,We,G.l),G.u=d(ge,je,G.u),G.c=d(le,Ie,G.c),G.w=d(U,Ve,G.w),G},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),K})(),(()=>{var K=mI(),de=K.firstChild,N=de.nextSibling,j=N.firstChild,Q=j.nextSibling,J=N.nextSibling,ce=J.firstChild,ae=ce.nextSibling;return de.style.setProperty("margin-bottom","1rem"),de.style.setProperty("font-size","1.1rem"),s(de,()=>e("products.timestamps","Timestamps")),s(j,()=>e("common.createdDate","Created Date")),s(Q,()=>a(v().createdDate)),s(ce,()=>e("common.lastModified","Last Modified")),s(ae,()=>a(v().lastModified)),re(M=>{var ne=f,pe=p,ve=b,ee=C,ie=p,R=b,L=C;return M.e=d(K,ne,M.e),M.t=d(N,pe,M.t),M.a=d(j,ve,M.a),M.o=d(Q,ee,M.o),M.i=d(J,ie,M.i),M.n=d(ce,R,M.n),M.s=d(ae,L,M.s),M},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),K})()]}}),me),s(P,S(Ue,{get when(){return r()==="movements"},get children(){var K=$h(),de=K.firstChild;return de.style.setProperty("margin-bottom","1rem"),de.style.setProperty("font-size","1.1rem"),s(de,()=>e("products.recentMovements","Recent Movements")),s(K,S(Ue,{get when(){return u().length>0},get fallback(){return(()=>{var N=vI();return N.firstChild,N.style.setProperty("text-align","center"),N.style.setProperty("padding","2rem"),N.style.setProperty("color","var(--text-muted)"),N.style.setProperty("background","var(--surface-color)"),N.style.setProperty("border-radius","var(--border-radius-sm)"),N.style.setProperty("border","1px solid var(--border-color)"),s(N,()=>e("products.noMovements","No movements found for this product"),null),N})()},get children(){return S(Ut,{get each(){return u()},children:N=>{const j=N.productId===v().id?N:null;if(!j)return null;let Q=De.getLocationById(N.locationId);return(()=>{var J=_I(),ce=J.firstChild,ae=ce.firstChild,M=ae.firstChild,ne=M.nextSibling,pe=ne.nextSibling,ve=ae.nextSibling,ee=ve.firstChild,ie=ce.nextSibling,R=ie.firstChild,L=R.firstChild,B=R.nextSibling;return d(J,I),ae.style.setProperty("font-weight","600"),ae.style.setProperty("margin-bottom","0.25rem"),M.style.setProperty("font-size","1.2rem"),s(M,()=>D(N.movementType)),ne.style.setProperty("padding","0 6px"),s(pe,()=>N.movementType),ve.style.setProperty("font-size","0.875rem"),ve.style.setProperty("color","var(--text-muted)"),s(ve,()=>` ${a(N?.createdDate)}  `,ee),ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("font-weight","600"),ee.style.setProperty("color","var(--primary-color)"),s(ee,()=>N?.locationId),s(ve,()=>`  ${Q?.name}`,null),s(ce,S(Ue,{get when(){return N.referenceNumber},get children(){var ge=bI();return ge.firstChild,ge.style.setProperty("font-size","0.75rem"),ge.style.setProperty("color","var(--text-muted)"),ge.style.setProperty("margin-top","0.25rem"),s(ge,()=>N?.referenceNumber,null),ge}}),null),ie.style.setProperty("text-align","right"),R.style.setProperty("font-weight","600"),R.style.setProperty("font-size","1rem"),s(R,()=>N?.movementType==="in"?"+":"",L),s(R,()=>j.quantity,L),s(R,()=>v().unitOfMeasure,null),B.style.setProperty("font-size","0.875rem"),B.style.setProperty("color","var(--text-muted)"),s(B,()=>o(j.unitCost)),re(ge=>{var le=E(N.movementType),U=N?.movementType==="in"?"#2e7d32":"#d32f2f";return ge.e=d(pe,le,ge.e),U!==ge.t&&((ge.t=U)!=null?R.style.setProperty("color",U):R.style.removeProperty("color")),ge},{e:void 0,t:void 0}),J})()}})}}),null),re(N=>d(K,f,N)),K}}),me),s(P,S(Ue,{get when(){return r()==="analytics"},get children(){var K=$h(),de=K.firstChild;return de.style.setProperty("margin-bottom","1rem"),de.style.setProperty("font-size","1.1rem"),s(de,()=>e("products.analytics","Analytics")),s(K,S(Ue,{get when(){return h()},get fallback(){return(()=>{var N=Th();return N.style.setProperty("text-align","center"),N.style.setProperty("padding","2rem"),N.style.setProperty("color","var(--text-muted)"),s(N,()=>e("products.noAnalytics","No analytics data available")),N})()},children:N=>(()=>{var j=PI(),Q=j.firstChild,J=Q.firstChild,ce=J.nextSibling,ae=ce.nextSibling,M=Q.nextSibling,ne=M.firstChild,pe=ne.nextSibling,ve=pe.nextSibling,ee=M.nextSibling,ie=ee.firstChild,R=ie.nextSibling,L=R.nextSibling,B=L.firstChild,ge=B.nextSibling;ge.nextSibling;var le=ee.nextSibling,U=le.firstChild,G=U.nextSibling,Pe=G.nextSibling,_e=le.nextSibling,se=_e.firstChild,be=se.nextSibling,X=be.nextSibling,we=X.firstChild,ke=we.nextSibling;return ke.nextSibling,J.style.setProperty("margin","0 0 0.5rem 0"),J.style.setProperty("color","var(--primary-color)"),s(J,()=>e("products.totalMovements","Total Movements")),ce.style.setProperty("font-size","1.5rem"),ce.style.setProperty("font-weight","600"),s(ce,()=>N().recentMovements),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),ae.style.setProperty("margin-top","0.25rem"),s(ae,()=>e("products.allTime","All time")),ne.style.setProperty("margin","0 0 0.5rem 0"),ne.style.setProperty("color","var(--primary-color)"),s(ne,()=>e("products.last30Days","Last 30 Days")),pe.style.setProperty("font-size","1.5rem"),pe.style.setProperty("font-weight","600"),s(pe,()=>N().movements30Days),ve.style.setProperty("font-size","0.875rem"),ve.style.setProperty("color","var(--text-muted)"),ve.style.setProperty("margin-top","0.25rem"),s(ve,()=>e("products.movements","movements")),ie.style.setProperty("margin","0 0 0.5rem 0"),ie.style.setProperty("color","var(--primary-color)"),s(ie,()=>e("products.currentValue","Current Stock Value")),R.style.setProperty("font-size","1.5rem"),R.style.setProperty("font-weight","600"),s(R,()=>o(N().totalValue)),L.style.setProperty("font-size","0.875rem"),L.style.setProperty("color","var(--text-muted)"),L.style.setProperty("margin-top","0.25rem"),s(L,()=>i()?.total||0,B),s(L,()=>v().unitOfMeasure,ge),s(L,()=>o(v().unitCost),null),U.style.setProperty("margin","0 0 0.5rem 0"),U.style.setProperty("color","var(--primary-color)"),s(U,()=>e("products.avgMovementValue","Avg Movement Value")),G.style.setProperty("font-size","1.5rem"),G.style.setProperty("font-weight","600"),s(G,()=>o(N().averageMovementValue)),Pe.style.setProperty("font-size","0.875rem"),Pe.style.setProperty("color","var(--text-muted)"),Pe.style.setProperty("margin-top","0.25rem"),s(Pe,()=>e("products.perMovement","per movement")),s(j,S(Ue,{get when(){return N().lastMovementDate},get children(){var xe=SI(),Te=xe.firstChild,Oe=Te.nextSibling,We=Oe.nextSibling;return Te.style.setProperty("margin","0 0 0.5rem 0"),Te.style.setProperty("color","var(--primary-color)"),s(Te,()=>e("products.lastMovement","Last Movement")),Oe.style.setProperty("font-size","1.25rem"),Oe.style.setProperty("font-weight","600"),s(Oe,()=>a(N().lastMovementDate)),We.style.setProperty("font-size","0.875rem"),We.style.setProperty("color","var(--text-muted)"),We.style.setProperty("margin-top","0.25rem"),s(We,()=>e("products.mostRecent","Most recent activity")),re(je=>d(xe,_,je)),xe}}),_e),se.style.setProperty("margin","0 0 0.5rem 0"),se.style.setProperty("color","var(--primary-color)"),s(se,()=>e("products.stockStatus","Stock Status")),be.style.setProperty("font-size","1.25rem"),be.style.setProperty("font-weight","600"),s(be,()=>i()?.statusText),X.style.setProperty("font-size","0.875rem"),X.style.setProperty("color","var(--text-muted)"),X.style.setProperty("margin-top","0.25rem"),s(X,()=>v().minStockLevel,ke),s(X,()=>v().maxStockLevel,null),re(xe=>{var Te=H,Oe=_,We=_,je=_,Ie=_,Ve=_;return xe.e=d(j,Te,xe.e),xe.t=d(Q,Oe,xe.t),xe.a=d(M,We,xe.a),xe.o=d(ee,je,xe.o),xe.i=d(le,Ie,xe.i),xe.n=d(_e,Ve,xe.n),xe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),j})()}),null),re(N=>d(K,f,N)),K}}),me),me.style.setProperty("display","flex"),me.style.setProperty("gap","1rem"),me.style.setProperty("justify-content","flex-end"),me.style.setProperty("margin-top","2rem"),s(me,S(Ne,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close","Close")}}),null),s(me,S(Ue,{get when(){return t.onEdit},get children(){return S(Ne,{variant:"primary",get onClick(){return t.onEdit},get children(){return e("common.edit","Edit")}})}}),null),re(K=>{var de=T(i()?.status||"good"),N=oe(r()==="details"),j=oe(r()==="movements"),Q=oe(r()==="analytics");return K.e=d(Z,de,K.e),K.t=d(F,N,K.t),K.a=d(V,j,K.a),K.o=d(z,Q,K.o),K},{e:void 0,t:void 0,a:void 0,o:void 0}),P})()})}})};At(["click"]);var CI=q("<div>"),AI=q("<button type=button>"),II=q("<div> "),kh=q("<div>"),EI=q("<div><div><input type=text autocomplete=off>"),xI=q("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div>"),TI=q("<span> ");const $I=t=>{const{t:e}=at(),[r,n]=ye(""),[i,o]=ye(!1),[a,c]=ye(null),[u,h]=ye([]),[f,p]=ye(!1),[b,C]=ye(-1),[D,x]=ye(null),E=t.searchDelay||300,T=t.maxResults||900,H=async N=>{if(!N.trim()||N.trim().length<3){h([]),t.onSearchResults?.([]);return}try{o(!0),c(null);try{const j=await qn.getProducts(N),Q=Object.keys(j),J=ae=>{let M=j;return{id:ae,name:M[ae].name,businessId:M[ae].businessId,sku:M[ae].code,UPC:M[ae].UPC,numCode:M[ae].codeN,category:M[ae].category,unitCost:M[ae].unitCost||0,unitOfMeasure:M[ae].unitOfMeasure,minStockLevel:M[ae].minStockLevel,maxStockLevel:M[ae].maxStockLevel,isActive:M[ae].isActive,description:M[ae].description||"",createdDate:M[ae].createdAt||new Date().toISOString(),lastModified:M[ae].updatedAt||new Date().toISOString()}},ce=Q.map(J);h(ce),De.updProduct(ce),t.onSearchResults?.(ce)}catch(j){console.warn("API search failed, using local fallback:",j),c("API search failed, showing local results");const Q=De.getActiveProducts().filter(J=>J.name.toLowerCase().includes(N.toLowerCase())||J.sku.toLowerCase().includes(N.toLowerCase())||J.category.toLowerCase().includes(N.toLowerCase())).slice(0,T);h(Q),t.onSearchResults?.(Q)}}catch(j){const Q=j instanceof Error?j.message:"Search failed";c(Q),h([]),t.onSearchResults?.([])}finally{o(!1)}},te=N=>{const Q=N.target.value;n(Q),c(null),t.showResults!==!1&&p(!0),D()&&clearTimeout(D());const J=setTimeout(()=>{H(Q)},E);x(J)},Y=N=>{n(N.name),p(!1),C(-1),t.onProductSelect?.(N)},ue=N=>{if(!(!f()||u().length===0))switch(N.key){case"ArrowDown":N.preventDefault(),C(j=>Math.min(j+1,u().length-1));break;case"ArrowUp":N.preventDefault(),C(j=>Math.max(j-1,-1));break;case"Enter":N.preventDefault(),b()>=0&&u()[b()]&&Y(u()[b()]);break;case"Escape":p(!1),C(-1);break}},oe=()=>{t.showResults!==!1&&u().length>0&&p(!0)},I=()=>{setTimeout(()=>{p(!1),C(-1)},150)},_=()=>{n(""),h([]),c(null),p(!1),C(-1),t.onSearchResults?.([]),D()&&(clearTimeout(D()),x(null))},v=N=>De.stockLevels.filter(j=>j.productId===N).reduce((j,Q)=>j+Q.quantity,0),P=N=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(N),w={position:"relative",width:"100%",...t.style},A={position:"relative",display:"flex","align-items":"center"},y={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},he={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},W={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},$={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},Z=N=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:N?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),k={display:"flex","justify-content":"space-between","align-items":"center"},F={flex:"1"},V={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},z={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},me={"text-align":"right","font-size":"0.875rem"},K={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},de={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var N=EI(),j=N.firstChild,Q=j.firstChild;return Q.addEventListener("blur",I),Q.addEventListener("focus",oe),Q.$$keydown=ue,Q.$$input=te,s(j,S(Ue,{get when(){return i()},get children(){var J=CI();return re(ce=>d(J,W,ce)),J}}),null),s(j,S(Ue,{get when(){return fe(()=>!!r())()&&!i()},get children(){var J=AI();return J.addEventListener("mouseleave",ce=>{ce.currentTarget.style.background="none",ce.currentTarget.style.color="var(--text-muted)"}),J.addEventListener("mouseenter",ce=>{ce.currentTarget.style.background="var(--border-color)",ce.currentTarget.style.color="var(--text-primary)"}),J.$$click=_,re(ce=>{var ae=he,M=e("common.clear","Clear search");return ce.e=d(J,ae,ce.e),M!==ce.t&&ut(J,"title",ce.t=M),ce},{e:void 0,t:void 0}),J}}),null),s(N,S(Ue,{get when(){return f()&&t.showResults!==!1},get children(){var J=kh();return s(J,S(Ue,{get when(){return a()},get children(){var ce=II();return ce.firstChild,d(ce,de),s(ce,a,null),ce}}),null),s(J,S(Ue,{get when(){return u().length>0},get fallback(){return fe(()=>!!(r()&&!i()))()&&(()=>{var ce=kh();return d(ce,K),s(ce,()=>e("inventory.noProductsFound","No products found matching your search.")),ce})()},get children(){return S(Ut,{get each(){return u()},children:(ce,ae)=>{const M=v(ce.id),ne=M<=ce.minStockLevel;return(()=>{var pe=xI(),ve=pe.firstChild,ee=ve.firstChild,ie=ee.firstChild,R=ie.nextSibling,L=R.firstChild,B=L.firstChild,ge=L.nextSibling,le=ge.nextSibling,U=le.nextSibling,G=U.nextSibling,Pe=ee.nextSibling,_e=Pe.firstChild,se=_e.firstChild,be=_e.nextSibling;return pe.addEventListener("mouseenter",()=>C(ae())),pe.$$click=()=>Y(ce),d(ve,k),d(ee,F),d(ie,V),s(ie,()=>ce.name),d(R,z),s(L,()=>e("inventory.sku","SKU"),B),s(L,()=>ce.sku,null),s(le,()=>ce.category),s(G,()=>P(ce.unitCost)),d(Pe,me),_e.style.setProperty("font-weight","600"),(ne?"#f44336":"var(--text-primary)")!=null?_e.style.setProperty("color",ne?"#f44336":"var(--text-primary)"):_e.style.removeProperty("color"),s(_e,M,se),s(_e,()=>ce.unitOfMeasure,null),be.style.setProperty("color","var(--text-muted)"),s(be,()=>ne?(()=>{var X=TI();return X.firstChild,X.style.setProperty("color","#f44336"),s(X,()=>e("inventory.lowStock","Low Stock"),null),X})():e("inventory.inStock","In Stock")),re(X=>d(pe,Z(ae()===b()),X)),pe})()}})}}),null),re(ce=>d(J,$,ce)),J}}),null),re(J=>{var ce=w,ae=A,M=y,ne=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),pe=t.disabled;return J.e=d(N,ce,J.e),J.t=d(j,ae,J.t),J.a=d(Q,M,J.a),ne!==J.o&&ut(Q,"placeholder",J.o=ne),pe!==J.i&&(Q.disabled=J.i=pe),J},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),re(()=>Q.value=r()),N})()};At(["input","keydown","click"]);var kI=q("<div><div><h2></h2><div><div>"),RI=q("<div><span>"),DI=q("<span> "),NI=q("<div><div><div><div><h3></h3><span></span></div><div></div><div>: </div></div><div><div> </div><div>: <!>  <!>: </div><div>: "),LI=q("<div><div>:</div><div>"),MI=q("<div>: "),OI=q("<div><div><span>:</span><select><option value=10>10</option><option value=20>20</option><option value=50>50</option><option value=100>100</option></select></div><div><div><span></span><input type=number min=1><span> </span></div></div><div>");const Fy=()=>{const{t}=at(),[e,r]=ye(""),[n,i]=ye(""),[o,a]=ye([]),[c,u]=ye(!1),[h,f]=ye(null),[p,b]=ye(!1),[C,D]=ye(!1),[x,E]=ye(!1),[T,H]=ye(null),[te,Y]=ye(!1),[ue,oe]=ye([]),[I,_]=ye(!1),[v,P]=ye(1),[w,A]=ye(20);hn(async()=>{await y()});const y=async()=>{try{u(!0),f(null);try{const N=await Bu.getAll();a(N.map(j=>({id:j.id||`prod-${Date.now()}-${Math.random()}`,name:j.productName||j.name||"Unknown Product",sku:j.sku||j.productCode||"",description:j.description||"",category:j.category||"General",unitOfMeasure:j.unitOfMeasure||"pcs",unitCost:parseFloat(j.unitCost||j.cost||"0"),sellingPrice:parseFloat(j.sellingPrice||j.price||"0"),minStockLevel:parseInt(j.minStockLevel||"0"),maxStockLevel:parseInt(j.maxStockLevel||"100"),isActive:j.isActive!==!1,createdDate:j.createdDate||new Date().toISOString(),lastModified:j.lastModified||new Date().toISOString(),businessId:j.businessId||"YB100423253156428"})))}catch(N){console.warn("API failed, using local store:",N),a(De.products)}}catch(N){f(N instanceof Error?N.message:"Failed to load products")}finally{u(!1)}},he=async()=>{try{u(!0),f(null);try{const N=await qn.getProducts("prod"),j=Object.keys(N),Q=ce=>{let M=N[ce];return{id:M.id,name:M.name,businessId:M.businessId,sku:M.code,numCode:M.codeN,category:M.category,unitCost:M.unitCost||0,unitOfMeasure:M.unitOfMeasure,minStockLevel:M.minStockLevel,maxStockLevel:M.maxStockLevel,isActive:M.isActive,description:M.description||"",createdDate:M.createdAt||new Date().toISOString(),lastModified:M.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(M.sellingPrice||M.price||"0")}},J=j.map(Q);a(J)}catch(N){console.warn("API failed, using local store:",N),a(De.products)}}catch(N){f(N instanceof Error?N.message:"Failed to load products")}finally{u(!1)}},{cancel:W}=lI(async N=>{if(!N.trim()){await y();return}try{f(null);const j=await Bu.getAll(N);a(j.map(Q=>({id:Q.id||`prod-${Date.now()}-${Math.random()}`,name:Q.productName||Q.name||"Unknown Product",sku:Q.sku||Q.productCode||"",description:Q.description||"",category:Q.category||"General",unitOfMeasure:Q.unitOfMeasure||"pcs",unitCost:parseFloat(Q.unitCost||Q.cost||"0"),sellingPrice:parseFloat(Q.sellingPrice||Q.price||"0"),minStockLevel:parseInt(Q.minStockLevel||"0"),maxStockLevel:parseInt(Q.maxStockLevel||"100"),isActive:Q.isActive!==!1,createdDate:Q.createdDate||new Date().toISOString(),lastModified:Q.lastModified||new Date().toISOString(),businessId:Q.businessId||"YB100423253156428"})))}catch(j){f(j instanceof Error?j.message:"Search failed");const Q=De.products.filter(J=>J.name.toLowerCase().includes(N.toLowerCase())||J.sku.toLowerCase().includes(N.toLowerCase())||J.category.toLowerCase().includes(N.toLowerCase()));a(Q)}},300);so(()=>{W()}),Ke(()=>{let N=o();return n()&&(N=N.filter(j=>j.category===n())),N}),Ke(()=>[...new Set(o().map(j=>j.category))].sort()),Ke(()=>{const N=o().filter(J=>J.isActive),j=o().length,Q=o().filter(J=>De.getTotalStockByProduct(J.id)===0);return{total:j,active:N.length,outOfStock:Q.length}});const $=N=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(N),Z={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},k={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},F=N=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:N?"#ffebee":"#e8f5e8",color:N?"#d32f2f":"#2d7d32"});Ke(()=>{const N=De.products||[],j=De.movements||[],Q=De.stockLevels||[],J=De.getLowStockProducts(),ce=N?.length||0,ae=N?.filter(pe=>pe.isActive).length,M=Q.reduce((pe,ve)=>pe*1+ve.quantity*1*ve.averageCost*1,0),ne=j?.filter(pe=>{const ve=new Date(pe.createdDate),ee=new Date;return ve.getMonth()===ee.getMonth()&&ve.getFullYear()===ee.getFullYear()}).length;return{totalProducts:ce,activeProducts:ae,lowStockProducts:J.length,totalStockValue:M,totalMovementsThisMonth:ne,totalLocations:De.locations.length,activeLocations:De.getActiveLocations().length}});const V=Ke(()=>De.products.map(N=>{const j=De.getStockByProduct(N.id),Q=De.getTotalStockByProduct(N.id),J=De.getLastLocationByProduct(N.id);return{...N,totalStock:Q,stockByLocation:j,lastLocation:J,isLowStock:Q<=N.minStockLevel}})),z=Ke(()=>ue().map(N=>{const j=De.getStockByProduct(N.id),Q=De.getTotalStockByProduct(N.id),J=De.getLastLocationByProduct(N.id);return{...N,totalStock:Q,stockByLocation:j,lastLocation:J,isLowStock:Q<=N.minStockLevel}})),me=Ke(()=>{const N=I()?z():V(),j=(v()-1)*w(),Q=j+w();return N.slice(j,Q)}),K=Ke(()=>{const N=I()?z():V();return Math.ceil(N.length/w())}),de=N=>{H(N),D(!0)};return S(jr,{get title(){return t("products.title","Products")},get children(){return[(()=>{var N=kI(),j=N.firstChild,Q=j.firstChild,J=Q.nextSibling,ce=J.firstChild;return N.style.setProperty("display","flex"),N.style.setProperty("justify-content","space-between"),N.style.setProperty("align-items","flex-start"),N.style.setProperty("margin-bottom","1.5rem"),N.style.setProperty("flex-wrap","wrap"),N.style.setProperty("gap","1rem"),j.style.setProperty("flex","1"),j.style.setProperty("min-width","300px"),Q.style.setProperty("margin","0 0 1rem 0"),Q.style.setProperty("font-size","1.5rem"),s(Q,()=>t("inventory.products")),J.style.setProperty("display","flex"),J.style.setProperty("gap","1rem"),J.style.setProperty("align-items","center"),J.style.setProperty("flex-wrap","wrap"),ce.style.setProperty("flex","1"),ce.style.setProperty("min-width","250px"),s(ce,S($I,{onSearchResults:ae=>{oe(ae),_(ae.length>0)},get placeholder(){return t("inventory.searchProductsStock","Search products and check stock levels...")},showResults:!1,maxResults:20})),s(J,S(Ne,{variant:"outline",onClick:()=>{he(),_(!1)},get children(){return[" ",fe(()=>t("common.showAll","Show All"))]}}),null),s(N,S(Ue,{get when(){return qt.hasPermission("read_write")},get children(){return S(Ne,{variant:"primary",onClick:()=>Y(!0),get children(){return[" ",fe(()=>t("inventory.addProduct"))]}})}}),null),N})(),(()=>{var N=RI(),j=N.firstChild;return N.style.setProperty("margin-bottom","1rem"),N.style.setProperty("font-size","0.875rem"),N.style.setProperty("color","var(--text-muted)"),N.style.setProperty("display","flex"),N.style.setProperty("justify-content","space-between"),N.style.setProperty("align-items","center"),s(j,(()=>{var Q=fe(()=>!!I());return()=>Q()?`${t("inventory.searchResults","Search Results")}: ${z().length} ${t("common.products","products")}`:`${t("inventory.totalProducts","Total Products")}: ${V().length} ${t("common.products","products")}`})()),s(N,(()=>{var Q=fe(()=>!!I());return()=>Q()&&(()=>{var J=DI();return J.firstChild,J.style.setProperty("color","var(--primary-color)"),s(J,()=>t("inventory.filtered","Filtered view"),null),J})()})(),null),N})(),S(Ut,{get each(){return me()},children:N=>(()=>{var j=NI(),Q=j.firstChild,J=Q.firstChild,ce=J.firstChild,ae=ce.firstChild,M=ae.nextSibling,ne=ce.nextSibling,pe=ne.nextSibling,ve=pe.firstChild,ee=J.nextSibling,ie=ee.firstChild,R=ie.firstChild,L=ie.nextSibling,B=L.firstChild,ge=B.nextSibling,le=ge.nextSibling,U=le.nextSibling;U.nextSibling;var G=L.nextSibling,Pe=G.firstChild;return j.$$click=()=>de(N),j.addEventListener("mouseleave",_e=>{_e.currentTarget.style.transform="translateY(0)",_e.currentTarget.style.boxShadow="none"}),j.addEventListener("mouseenter",_e=>{_e.currentTarget.style.transform="translateY(-2px)",_e.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),d(j,Z),d(Q,k),ce.style.setProperty("display","flex"),ce.style.setProperty("align-items","center"),ce.style.setProperty("gap","0.5rem"),ce.style.setProperty("margin-bottom","0.5rem"),ae.style.setProperty("margin","0"),ae.style.setProperty("font-size","1.1rem"),s(ae,()=>N.name),s(M,(()=>{var _e=fe(()=>!!N.isLowStock);return()=>_e()?t("inventory.lowStockAlert"):t("inventory.inStock")})()),ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("color","var(--text-muted)"),s(ne,()=>N.sku,null),s(ne,()=>N.UPC?"  "+N.UPC:"",null),s(ne,()=>N.category?"  "+N.category:"",null),pe.style.setProperty("font-size","0.875rem"),pe.style.setProperty("color","var(--text-muted)"),s(pe,()=>t("inventory.lastSeen"),ve),s(pe,()=>N.lastLocation?.name||t("inventory.noMovements"),null),ee.style.setProperty("text-align","right"),ie.style.setProperty("font-size","1.25rem"),ie.style.setProperty("font-weight","700"),ie.style.setProperty("color","var(--primary-color)"),s(ie,()=>N.totalStock,R),s(ie,()=>N.unitOfMeasure,null),L.style.setProperty("font-size","0.875rem"),L.style.setProperty("color","var(--text-muted)"),s(L,()=>t("inventory.min"),B),s(L,()=>N.minStockLevel,ge),s(L,()=>t("inventory.max"),U),s(L,()=>N.maxStockLevel,null),G.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","var(--text-muted)"),s(G,()=>t("inventory.cost"),Pe),s(G,()=>$(N.unitCost),null),s(j,(()=>{var _e=fe(()=>N.stockByLocation.length>0);return()=>_e()&&(()=>{var se=LI(),be=se.firstChild,X=be.firstChild,we=be.nextSibling;return se.style.setProperty("margin-top","1rem"),be.style.setProperty("font-weight","500"),be.style.setProperty("margin-bottom","0.5rem"),be.style.setProperty("font-size","0.875rem"),s(be,()=>t("inventory.stockByLocation"),X),we.style.setProperty("display","flex"),we.style.setProperty("flex-wrap","wrap"),we.style.setProperty("gap","0.5rem"),s(we,S(Ut,{get each(){return N.stockByLocation},children:ke=>{const xe=De.getLocationById(ke.locationId);return(()=>{var Te=MI(),Oe=Te.firstChild;return Te.style.setProperty("padding","0.25rem 0.5rem"),Te.style.setProperty("background","var(--background-color)"),Te.style.setProperty("border-radius","var(--border-radius-sm)"),Te.style.setProperty("font-size","0.75rem"),Te.style.setProperty("border","1px solid var(--border-color)"),s(Te,()=>xe?.name,Oe),s(Te,()=>ke.quantity,null),Te})()}})),se})()})(),null),re(_e=>d(M,F(N.isLowStock),_e)),j})()}),fe(()=>fe(()=>K()>1)()&&(()=>{var N=OI(),j=N.firstChild,Q=j.firstChild,J=Q.firstChild,ce=Q.nextSibling,ae=j.nextSibling,M=ae.firstChild,ne=M.firstChild,pe=ne.nextSibling,ve=pe.nextSibling,ee=ve.firstChild,ie=ae.nextSibling;return N.style.setProperty("display","flex"),N.style.setProperty("justify-content","space-between"),N.style.setProperty("align-items","center"),N.style.setProperty("margin-top","2rem"),N.style.setProperty("padding","1rem"),N.style.setProperty("background","var(--surface-color)"),N.style.setProperty("border-radius","var(--border-radius)"),N.style.setProperty("border","1px solid var(--border-color)"),j.style.setProperty("display","flex"),j.style.setProperty("align-items","center"),j.style.setProperty("gap","0.5rem"),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),s(Q,()=>t("common.showPerPage","Show per page"),J),ce.addEventListener("change",R=>{A(parseInt(R.target.value)),P(1)}),ce.style.setProperty("padding","0.25rem 0.5rem"),ce.style.setProperty("border","1px solid var(--border-color)"),ce.style.setProperty("border-radius","var(--border-radius-sm)"),ce.style.setProperty("background","var(--background-color)"),ce.style.setProperty("cursor","pointer"),ae.style.setProperty("display","flex"),ae.style.setProperty("align-items","center"),ae.style.setProperty("gap","0.5rem"),s(ae,S(Ne,{variant:"outline",size:"sm",onClick:()=>P(1),get disabled(){return v()===1},get children(){return t("common.first","First")}}),M),s(ae,S(Ne,{variant:"outline",size:"sm",onClick:()=>P(R=>Math.max(1,R-1)),get disabled(){return v()===1},get children(){return t("common.previous","Previous")}}),M),M.style.setProperty("display","flex"),M.style.setProperty("align-items","center"),M.style.setProperty("gap","0.25rem"),ne.style.setProperty("font-size","0.875rem"),s(ne,()=>t("common.page","Page")),pe.addEventListener("change",R=>{const L=parseInt(R.target.value);L>=1&&L<=K()&&P(L)}),pe.style.setProperty("width","60px"),pe.style.setProperty("padding","0.25rem 0.5rem"),pe.style.setProperty("border","1px solid var(--border-color)"),pe.style.setProperty("border-radius","var(--border-radius-sm)"),pe.style.setProperty("text-align","center"),pe.style.setProperty("font-size","0.875rem"),ve.style.setProperty("font-size","0.875rem"),s(ve,()=>t("common.of","of"),ee),s(ve,K,null),s(ae,S(Ne,{variant:"outline",size:"sm",onClick:()=>P(R=>Math.min(K(),R+1)),get disabled(){return v()===K()},get children(){return t("common.next","Next")}}),null),s(ae,S(Ne,{variant:"outline",size:"sm",onClick:()=>P(K()),get disabled(){return v()===K()},get children(){return t("common.last","Last")}}),null),ie.style.setProperty("font-size","0.875rem"),ie.style.setProperty("color","var(--text-muted)"),s(ie,()=>{const R=I()?z():V(),L=(v()-1)*w()+1,B=Math.min(v()*w(),R.length);return t("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:L,end:B,total:R.length})}),re(()=>ut(pe,"max",K())),re(()=>ce.value=w()),re(()=>pe.value=v()),N})()),S(Ha,{get isOpen(){return p()},onClose:()=>b(!1),onProductAdded:()=>{y()}}),S(wI,{get isOpen(){return C()},onClose:()=>{D(!1),H(null)},get product(){return T()},onEdit:()=>{D(!1),E(!0)}})]}})};At(["click"]);var VI=q("<div><h1></h1><div><div><span>View:</span><button> 1</button><button> 2"),Er=q("<div>"),BI=q("<div><h3></h3><div>"),FI=q("<div>: <!> "),UI=q("<div><button></button><button></button><button></button><button>"),jI=q("<div><div>"),zI=q("<div><span> (<!>)</span><span> / <!> "),qI=q("<div><div><h2></h2></div><div>"),HI=q("<div><div><div><span></span><h3></h3></div><div>  </div><div></div></div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div>:"),WI=q("<div><div><div><div></div><div></div></div><div><div> </div><div></div><div>Min: "),GI=q("<span> LOW");const KI=()=>{const{t}=at(),[e,r]=ye(!1),[n,i]=ye(!1),[o,a]=ye(!1),[c,u]=ye(null),[h,f]=ye("overview"),[p,b]=ye("new"),[C,D]=ye(""),[x,E]=ye(""),[T,H]=ye([]),[te,Y]=ye(!1),[ue,oe]=ye(!1),[I,_]=ye(!1),[v,P]=ye(!1),[w,A]=ye(!1),[y,he]=ye(1),[W,$]=ye(20),Z=R=>{u(R),a(!0)},k=Ke(()=>{const R=De.products||[],L=De.movements||[],B=De.stockLevels||[],ge=De.getLowStockProducts(),le=R?.length||0,U=R?.filter(_e=>_e.isActive).length,G=B.reduce((_e,se)=>_e*1+se.quantity*1*se.averageCost*1,0),Pe=L?.filter(_e=>{const se=new Date(_e.createdDate),be=new Date;return se.getMonth()===be.getMonth()&&se.getFullYear()===be.getFullYear()}).length;return{totalProducts:le,activeProducts:U,lowStockProducts:ge.length,totalStockValue:G,totalMovementsThisMonth:Pe,totalLocations:De.locations.length,activeLocations:De.getActiveLocations().length}});Ke(()=>De.products.map(R=>{const L=De.getStockByProduct(R.id),B=De.getTotalStockByProduct(R.id),ge=De.getLastLocationByProduct(R.id);return{...R,totalStock:B,stockByLocation:L,lastLocation:ge,isLowStock:B<=R.minStockLevel}})),Ke(()=>{ue(),he(1)});const F=(R,L)=>R<=L?t("inventory.lowStockAlert"):R<=L*2?t("inventory.normalStock"):t("inventory.inStock"),V=R=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(R),z=R=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(R),me=R=>{switch(R){case"warehouse":return t("inventory.warehouse");case"store":return t("inventory.store");case"supplier":return t("inventory.supplier");case"customer":return t("inventory.customer");default:return R}},K={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},de={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},N=R=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500",background:R>50?"#d4edda":R>20?"#fff3cd":"#f8d7da",color:R>50?"#155724":R>20?"#856404":"#721c24"}),j={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},Q={color:"var(--text-muted)","font-size":"0.875rem"},J={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},ce={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},ae={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},M=R=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:R?"var(--primary-color)":"var(--text-muted)","border-bottom":R?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),ne={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem","margin-bottom":"2rem"},pe={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},ve={display:"flex",gap:"0.5rem","align-items":"center","margin-left":"auto","margin-right":"1rem"},ee=R=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:R?"var(--primary-color)":"var(--surface-color)",color:R?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),ie=Ke(()=>{const R=De.movements;return{total:R.length,stockIn:R.filter(L=>L.movementType==="in").length,stockOut:R.filter(L=>L.movementType==="out").length,transfers:R.filter(L=>L.movementType==="transfer").length,adjustments:R.filter(L=>L.movementType==="adjustment").length,totalValue:R.reduce((L,B)=>L+B.totalCost,0)}});return hn(()=>{}),S(jr,{get title(){return t("inventory.title")},get children(){return[(()=>{var R=VI(),L=R.firstChild,B=L.nextSibling,ge=B.firstChild,le=ge.firstChild,U=le.nextSibling,G=U.firstChild,Pe=U.nextSibling,_e=Pe.firstChild;return d(R,ce),L.style.setProperty("margin","0"),L.style.setProperty("font-size","1.75rem"),B.style.setProperty("display","flex"),B.style.setProperty("align-items","center"),B.style.setProperty("gap","1rem"),d(ge,ve),le.style.setProperty("font-weight","500"),le.style.setProperty("color","var(--text-muted)"),le.style.setProperty("font-size","0.875rem"),U.$$click=()=>b("new"),s(U,()=>t("common.view"),G),Pe.$$click=()=>b("legacy"),s(Pe,()=>t("common.view"),_e),s(B,(()=>{var se=fe(()=>p()==="new");return()=>se()&&S(Ne,{variant:"outline",onClick:()=>A(!0),get children(){return[" ",fe(()=>t("inventory.physicalCount","Physical Count"))]}})})(),null),s(B,S(Ue,{get when(){return qt.hasPermission("read_write")},get children(){return S(Ne,{variant:"primary",onClick:()=>i(!0),get children(){return fe(()=>p()==="new")()?t("inventory.addMovement"):t("common.add")}})}}),null),re(se=>{var be=ee(p()==="new"),X=ee(p()==="legacy");return se.e=d(U,be,se.e),se.t=d(Pe,X,se.t),se},{e:void 0,t:void 0}),R})(),fe(()=>fe(()=>p()==="legacy")()?[(()=>{var R=Er();return s(R,S(Xe,{get title(){return t("inventory.totalItems")},get subtitle(){return t("inventory.inStock")},get children(){var L=Er();return L.style.setProperty("font-size","1.5rem"),L.style.setProperty("font-weight","600"),L.style.setProperty("color","var(--primary-color)"),s(L,()=>De.inventory.length),L}}),null),s(R,S(Xe,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.itemsBelowThreshold")},get children(){var L=Er();return L.style.setProperty("font-size","1.5rem"),L.style.setProperty("font-weight","600"),L.style.setProperty("color","var(--primary-color)"),s(L,()=>De.getLowStockItems().length),L}}),null),s(R,S(Xe,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.inventoryWorth")},get children(){var L=Er();return L.style.setProperty("font-size","1.5rem"),L.style.setProperty("font-weight","600"),L.style.setProperty("color","var(--primary-color)"),s(L,()=>V(De.getTotalValue())),L}}),null),re(L=>d(R,J,L)),R})(),(()=>{var R=Er();return d(R,K),s(R,S(Ut,{get each(){return De.inventory},children:L=>{const B=F(L.quantity,L.minStock),ge=L.quantity<=L.minStock?8:L.quantity<=L.minStock*2?35:75;return S(Xe,{onClick:()=>Z(L),get children(){return[(()=>{var le=BI(),U=le.firstChild,G=U.nextSibling;return d(le,de),U.style.setProperty("margin","0"),U.style.setProperty("font-size","1.1rem"),s(U,()=>L.name),s(G,B),re(Pe=>d(G,N(ge),Pe)),le})(),(()=>{var le=Er();return d(le,j),s(le,()=>V(L.price)),le})(),(()=>{var le=FI(),U=le.firstChild,G=U.nextSibling;return G.nextSibling,d(le,Q),s(le,()=>t("inventory.quantity"),U),s(le,()=>L.quantity,G),s(le,()=>t("common.units"),null),le})()]}})}})),R})()]:[(()=>{var R=UI(),L=R.firstChild,B=L.nextSibling,ge=B.nextSibling,le=ge.nextSibling;return d(R,ae),L.$$click=()=>f("overview"),s(L,()=>t("inventory.overview")),B.$$click=()=>f("products"),s(B,()=>t("inventory.products")),ge.$$click=()=>f("movements"),s(ge,()=>t("inventory.movements")),le.$$click=()=>f("locations"),s(le,()=>t("inventory.locations")),re(U=>{var G=M(h()==="overview"),Pe=M(h()==="products"),_e=M(h()==="movements"),se=M(h()==="locations");return U.e=d(L,G,U.e),U.t=d(B,Pe,U.t),U.a=d(ge,_e,U.a),U.o=d(le,se,U.o),U},{e:void 0,t:void 0,a:void 0,o:void 0}),R})(),fe(()=>fe(()=>h()==="overview")()&&(()=>{var R=jI(),L=R.firstChild;return s(L,S(Xe,{get title(){return t("inventory.activeProducts")},get subtitle(){return t("inventory.currentlyManaged")},get children(){var B=Er();return B.style.setProperty("font-size","1.5rem"),B.style.setProperty("font-weight","600"),B.style.setProperty("color","var(--primary-color)"),s(B,()=>k().activeProducts),B}}),null),s(L,S(Xe,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.needAttention")},get children(){var B=Er();return B.style.setProperty("font-size","1.5rem"),B.style.setProperty("font-weight","600"),B.style.setProperty("color","#d32f2f"),s(B,()=>k().lowStockProducts),B}}),null),s(L,S(Xe,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.currentWorth")},get children(){var B=Er();return B.style.setProperty("font-size","1.5rem"),B.style.setProperty("font-weight","600"),B.style.setProperty("color","var(--primary-color)"),s(B,()=>z(ie().totalValue)),B}}),null),s(L,S(Xe,{get title(){return t("inventory.movements")},get subtitle(){return t("inventory.thisMonth")},get children(){var B=Er();return B.style.setProperty("font-size","1.5rem"),B.style.setProperty("font-weight","600"),B.style.setProperty("color","var(--primary-color)"),s(B,()=>k().totalMovementsThisMonth),B}}),null),s(L,S(Xe,{get title(){return t("inventory.activeLocations")},get subtitle(){return t("inventory.warehousesStores")},get children(){var B=Er();return B.style.setProperty("font-size","1.5rem"),B.style.setProperty("font-weight","600"),B.style.setProperty("color","var(--primary-color)"),s(B,()=>k().activeLocations),B}}),null),s(R,(()=>{var B=fe(()=>k().lowStockProducts>0);return()=>B()&&S(Xe,{get title(){return` ${t("inventory.lowStockAlert")}`},get subtitle(){return`${k().lowStockProducts} ${t("inventory.productsNeedRestocking")}`},style:{"margin-bottom":"2rem","border-color":"#ffcdd2",background:"#ffebee"},get children(){var ge=Er();return ge.style.setProperty("margin-top","1rem"),s(ge,S(Ut,{get each(){return De.getLowStockProducts().slice(0,9)},children:le=>(()=>{var U=zI(),G=U.firstChild,Pe=G.firstChild,_e=Pe.nextSibling;_e.nextSibling;var se=G.nextSibling,be=se.firstChild,X=be.nextSibling;return X.nextSibling,U.style.setProperty("display","flex"),U.style.setProperty("justify-content","space-between"),U.style.setProperty("margin-bottom","0.5rem"),U.style.setProperty("font-size","0.875rem"),s(G,()=>le.name,Pe),s(G,()=>le?.sku,_e),se.style.setProperty("color","#d32f2f"),se.style.setProperty("font-weight","600"),s(se,()=>le.currentStock,be),s(se,()=>le.minStockLevel,X),s(se,()=>t("inventory.min"),null),U})()}),null),s(ge,(()=>{var le=fe(()=>De.getLowStockProducts().length>5);return()=>le()&&(()=>{var U=Er();return U.style.setProperty("font-size","0.875rem"),U.style.setProperty("color","var(--text-muted)"),U.style.setProperty("font-style","italic"),s(U,()=>t("common.andMore",{count:De.getLowStockProducts().length-9})),U})()})(),null),ge}})})(),null),re(B=>d(L,J,B)),R})()),fe(()=>fe(()=>h()==="products")()&&S(Fy,{})),fe(()=>fe(()=>h()==="movements")()&&S(zA,{})),fe(()=>fe(()=>h()==="locations")()&&(()=>{var R=qI(),L=R.firstChild,B=L.firstChild,ge=L.nextSibling;return L.style.setProperty("display","flex"),L.style.setProperty("justify-content","space-between"),L.style.setProperty("align-items","center"),L.style.setProperty("margin-bottom","1.5rem"),B.style.setProperty("margin","0"),B.style.setProperty("font-size","1.5rem"),s(B,()=>t("inventory.locations")),s(L,S(Ue,{get when(){return qt.hasPermission("read_write")},get children(){return S(Ne,{variant:"primary",onClick:()=>_(!0),get children(){return[" ",fe(()=>t("inventory.addLocation"))]}})}}),null),d(ge,ne),s(ge,S(Ut,{get each(){return De.getActiveLocations()},children:le=>{const U=De.getStockByLocation(le.id),G=U.length,Pe=U.reduce((se,be)=>se*1+be.quantity*1,0),_e=U.reduce((se,be)=>(De.getProductById(be.productId),se+(be?.averageCost||0)),0);return(()=>{var se=HI(),be=se.firstChild,X=be.firstChild,we=X.firstChild,ke=we.nextSibling,xe=X.nextSibling,Te=xe.firstChild,Oe=xe.nextSibling,We=be.nextSibling,je=We.firstChild,Ie=je.firstChild,Ve=Ie.firstChild,He=Ie.nextSibling,qe=je.nextSibling,Ge=qe.firstChild,Ae=Ge.firstChild,rt=Ge.nextSibling,et=qe.nextSibling,ct=et.firstChild,xt=ct.firstChild,_t=ct.nextSibling,Ht=We.nextSibling,mt=Ht.firstChild,Qt=mt.firstChild;return be.style.setProperty("margin-bottom","1rem"),be.style.setProperty("padding-bottom","1rem"),be.style.setProperty("border-bottom","1px solid var(--border-color)"),X.style.setProperty("display","flex"),X.style.setProperty("align-items","center"),X.style.setProperty("gap","0.5rem"),X.style.setProperty("margin-bottom","0.5rem"),we.style.setProperty("font-size","1.2rem"),s(we,()=>le.type==="warehouse"?"":le.type==="store"?"":le.type==="supplier"?"":""),ke.style.setProperty("margin","0"),ke.style.setProperty("font-size","1.1rem"),s(ke,()=>le.name),xe.style.setProperty("font-size","0.875rem"),xe.style.setProperty("color","var(--text-muted)"),s(xe,()=>le.code,Te),s(xe,()=>me(le.type),null),Oe.style.setProperty("font-size","0.75rem"),Oe.style.setProperty("color","var(--text-muted)"),Oe.style.setProperty("margin-top","0.25rem"),s(Oe,()=>le.address),We.style.setProperty("margin-bottom","1rem"),je.style.setProperty("display","flex"),je.style.setProperty("justify-content","space-between"),je.style.setProperty("margin-bottom","0.5rem"),Ie.style.setProperty("font-size","0.875rem"),Ie.style.setProperty("font-weight","500"),s(Ie,()=>t("inventory.products"),Ve),He.style.setProperty("font-weight","600"),s(He,G),qe.style.setProperty("display","flex"),qe.style.setProperty("justify-content","space-between"),qe.style.setProperty("margin-bottom","0.5rem"),Ge.style.setProperty("font-size","0.875rem"),Ge.style.setProperty("font-weight","500"),s(Ge,()=>t("inventory.totalItems"),Ae),rt.style.setProperty("font-weight","600"),rt.style.setProperty("color","var(--primary-color)"),s(rt,Pe),et.style.setProperty("display","flex"),et.style.setProperty("justify-content","space-between"),et.style.setProperty("margin-bottom","1rem"),ct.style.setProperty("font-size","0.875rem"),ct.style.setProperty("font-weight","500"),s(ct,()=>t("inventory.totalValue"),xt),_t.style.setProperty("font-weight","600"),_t.style.setProperty("color","var(--primary-color)"),s(_t,()=>z(_e)),mt.style.setProperty("font-weight","600"),mt.style.setProperty("margin-bottom","0.75rem"),mt.style.setProperty("font-size","0.875rem"),mt.style.setProperty("color","var(--text-primary)"),mt.style.setProperty("border-bottom","1px solid var(--border-color)"),mt.style.setProperty("padding-bottom","0.5rem"),s(mt,()=>t("inventory.productDetails"),Qt),s(Ht,(()=>{var ht=fe(()=>U.length===0);return()=>ht()?(()=>{var St=Er();return St.style.setProperty("text-align","center"),St.style.setProperty("color","var(--text-muted)"),St.style.setProperty("font-style","italic"),St.style.setProperty("padding","1rem"),s(St,()=>t("inventory.noProducts")),St})():(()=>{var St=Er();return St.style.setProperty("max-height","200px"),St.style.setProperty("overflow-y","auto"),St.style.setProperty("border","1px solid var(--border-color)"),St.style.setProperty("border-radius","var(--border-radius-sm)"),s(St,S(Ut,{each:U,children:Lt=>{const Nt=De.getProductById(Lt.productId);if(!Nt)return null;const Me=Lt.quantity<=Nt.minStockLevel,Be=Lt.averageCost;return(()=>{var Ye=WI(),ot=Ye.firstChild,kt=ot.firstChild,Qe=kt.firstChild,Ee=Qe.nextSibling,nt=kt.nextSibling,ft=nt.firstChild,Pt=ft.firstChild,sr=ft.nextSibling,Rt=sr.nextSibling;return Rt.firstChild,Ye.style.setProperty("padding","0.75rem"),Ye.style.setProperty("border-bottom","1px solid var(--border-color)"),(Me?"#fff5f5":"transparent")!=null?Ye.style.setProperty("background",Me?"#fff5f5":"transparent"):Ye.style.removeProperty("background"),Ye.style.setProperty("transition","background-color 0.2s ease"),ot.style.setProperty("display","flex"),ot.style.setProperty("justify-content","space-between"),ot.style.setProperty("align-items","flex-start"),ot.style.setProperty("margin-bottom","0.25rem"),kt.style.setProperty("flex","1"),Qe.style.setProperty("font-weight","500"),Qe.style.setProperty("font-size","0.875rem"),(Me?"#d32f2f":"var(--text-primary)")!=null?Qe.style.setProperty("color",Me?"#d32f2f":"var(--text-primary)"):Qe.style.removeProperty("color"),s(Qe,()=>Nt.name,null),s(Qe,Me&&(()=>{var jt=GI();return jt.style.setProperty("margin-left","0.5rem"),jt.style.setProperty("font-size","0.7rem"),jt.style.setProperty("color","#d32f2f"),jt})(),null),Ee.style.setProperty("font-size","0.75rem"),Ee.style.setProperty("color","var(--text-muted)"),Ee.style.setProperty("margin-top","0.1rem"),s(Ee,()=>Nt.sku,null),s(Ee,()=>Nt.UPC?"  "+Nt.UPC:"",null),s(Ee,()=>Nt.category?"  "+Nt.category:"",null),nt.style.setProperty("text-align","right"),ft.style.setProperty("font-weight","600"),ft.style.setProperty("font-size","0.875rem"),(Me?"#d32f2f":"var(--primary-color)")!=null?ft.style.setProperty("color",Me?"#d32f2f":"var(--primary-color)"):ft.style.removeProperty("color"),s(ft,()=>Lt.quantity,Pt),s(ft,()=>Nt.unitOfMeasure,null),sr.style.setProperty("font-size","0.75rem"),sr.style.setProperty("color","var(--text-muted)"),s(sr,()=>z(Be)),Rt.style.setProperty("font-size","0.7rem"),Rt.style.setProperty("color","var(--text-muted)"),Rt.style.setProperty("margin-top","0.1rem"),s(Rt,()=>Nt.minStockLevel,null),Ye})()}})),St})()})(),null),re(ht=>d(se,{...pe,"min-height":"400px"},ht)),se})()}})),R})())]),S(Ue,{get when(){return qt.hasPermission("read_write")},get children(){return[S(iA,{get isOpen(){return e()},onClose:()=>r(!1),get mode(){return p()==="new"?"movement":"legacy"}}),S(dA,{get isOpen(){return n()},onClose:()=>i(!1)}),S(gA,{get isOpen(){return o()},onClose:()=>a(!1),get item(){return c()}}),S(Ha,{get isOpen(){return isAddProductModalOpen()},onClose:()=>setIsAddProductModalOpen(!1),onProductAdded:()=>{setIsAddProductModalOpen(!1)}}),S(au,{get isOpen(){return I()},onClose:()=>_(!1),onLocationAdded:()=>{_(!1)}}),S(sI,{get isOpen(){return isUpdateModalOpen()},onClose:()=>{setIsUpdateModalOpen(!1),D(null)},get product(){return C()},onProductUpdated:()=>{loadProducts()}})]}}),S(tI,{get isOpen(){return w()},onClose:()=>A(!1)})]}})};At(["click"]);const YI=[{id:"1",name:"John Doe",position:"Software Engineer",salary:85e3,email:"john.doe@company.com",phone:"+1 (555) 123-4567",department:"Engineering",startDate:"2023-01-15"},{id:"2",name:"Jane Smith",position:"Product Manager",salary:95e3,email:"jane.smith@company.com",phone:"+1 (555) 234-5678",department:"Product",startDate:"2022-08-20"},{id:"3",name:"Mike Brown",position:"Designer",salary:7e4,email:"mike.brown@company.com",phone:"+1 (555) 345-6789",department:"Design",startDate:"2023-03-10"},{id:"4",name:"Sarah Kim",position:"HR Manager",salary:78e3,email:"sarah.kim@company.com",phone:"+1 (555) 456-7890",department:"Human Resources",startDate:"2022-11-05"},{id:"5",name:"Alex Lee",position:"Data Analyst",salary:72e3,email:"alex.lee@company.com",phone:"+1 (555) 567-8901",department:"Analytics",startDate:"2023-02-28"},{id:"6",name:"Emma Wilson",position:"Marketing Manager",salary:82e3,email:"emma.wilson@company.com",phone:"+1 (555) 678-9012",department:"Marketing",startDate:"2022-09-15"}],[Co,_l]=ye(YI),Uy={get employees(){return Co()},addEmployee(t){const e={...t,id:Date.now().toString()};return _l([...Co(),e]),e},updateEmployee(t,e){_l(Co().map(r=>r.id===t?{...r,...e}:r))},deleteEmployee(t){_l(Co().filter(e=>e.id!==t))},getEmployeeById(t){return Co().find(e=>e.id===t)}};var QI=q("<form><div>");const JI=t=>{const{t:e}=at(),[r,n]=ye({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),i=[{value:"Engineering",label:e("employees.departments.engineering","Engineering")},{value:"Product",label:e("employees.departments.product","Product")},{value:"Design",label:e("employees.departments.design","Design")},{value:"Marketing",label:e("employees.departments.marketing","Marketing")},{value:"Sales",label:e("employees.departments.sales","Sales")},{value:"Human Resources",label:e("employees.departments.humanResources","Human Resources")},{value:"Finance",label:e("employees.departments.finance","Finance")},{value:"Operations",label:e("employees.departments.operations","Operations")},{value:"Analytics",label:e("employees.departments.analytics","Analytics")}],o={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},a=u=>{u.preventDefault();const h=r();if(!h.name||!h.position||!h.salary||!h.email||!h.department||!h.startDate){alert(e("forms.requiredField"));return}const f={name:h.name,position:h.position,salary:parseFloat(h.salary),email:h.email,phone:h.phone,department:h.department,startDate:h.startDate};Uy.addEmployee(f),n({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),t.onClose()},c=(u,h)=>{n(f=>({...f,[u]:h}))};return S(dr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.addEmployee")},get children(){var u=QI(),h=u.firstChild;return u.addEventListener("submit",a),s(u,S(Ct,{get label(){return e("employees.fullName")},get value(){return r().name},onChange:f=>c("name",f),get placeholder(){return e("employees.enterFullName","Enter employee's full name")},required:!0}),h),s(u,S(Ct,{get label(){return e("employees.position")},get value(){return r().position},onChange:f=>c("position",f),get placeholder(){return e("employees.enterPosition","Enter job position")},required:!0}),h),s(u,S(yr,{get label(){return e("employees.department")},get value(){return r().department},onChange:f=>c("department",f),options:i,required:!0}),h),s(u,S(Ct,{get label(){return e("employees.email")},type:"email",get value(){return r().email},onChange:f=>c("email",f),get placeholder(){return e("employees.enterEmail","Enter email address")},required:!0}),h),s(u,S(Ct,{get label(){return e("employees.phone")},type:"tel",get value(){return r().phone},onChange:f=>c("phone",f),get placeholder(){return e("employees.enterPhone","Enter phone number")}}),h),s(u,S(Ct,{get label(){return e("employees.salary")},type:"number",get value(){return r().salary},onChange:f=>c("salary",f),get placeholder(){return e("employees.enterSalary","Enter annual salary")},required:!0}),h),s(u,S(Ct,{get label(){return e("employees.hireDate")},type:"date",get value(){return r().startDate},onChange:f=>c("startDate",f),required:!0}),h),d(h,o),s(h,S(Ne,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(h,S(Ne,{variant:"primary",type:"submit",get children(){return e("employees.addEmployee")}}),null),u}})};var XI=q("<div><div></div><div></div><div>"),ZI=q("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),eE=q("<div>");const tE=t=>{const{t:e}=at(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},i={"font-weight":"600",color:"var(--text-primary)"},o={width:"80px",height:"80px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.5rem",margin:"0 auto 1.5rem auto"},a={"text-align":"center","margin-bottom":"2rem"},c={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},u={color:"var(--text-muted)","font-size":"1rem"},h={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"};if(!t.employee)return null;const f=C=>C.split(" ").map(D=>D[0]).join("").toUpperCase(),p=C=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(C),b=C=>new Date(C).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return S(dr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.employeeDetails")},get children(){return[(()=>{var C=XI(),D=C.firstChild,x=D.nextSibling,E=x.nextSibling;return d(C,a),d(D,o),s(D,()=>f(t.employee.name)),d(x,c),s(x,()=>t.employee.name),d(E,u),s(E,()=>t.employee.position),C})(),(()=>{var C=ZI(),D=C.firstChild,x=D.firstChild,E=x.nextSibling,T=D.nextSibling,H=T.firstChild,te=H.nextSibling,Y=T.nextSibling,ue=Y.firstChild,oe=ue.nextSibling,I=Y.nextSibling,_=I.firstChild,v=_.nextSibling,P=I.nextSibling,w=P.firstChild,A=w.nextSibling,y=P.nextSibling,he=y.firstChild,W=he.nextSibling;return s(x,()=>e("employees.employeeId")),s(E,()=>t.employee.id),s(H,()=>e("employees.department")),s(te,()=>t.employee.department),s(ue,()=>e("employees.email")),s(oe,()=>t.employee.email),s(_,()=>e("employees.phone")),s(v,()=>t.employee.phone),s(w,()=>e("employees.salary")),s(A,()=>p(t.employee.salary)),s(he,()=>e("employees.hireDate")),s(W,()=>b(t.employee.startDate)),re($=>{var Z=r,k=n,F=i,V=r,z=n,me=i,K=r,de=n,N=i,j=r,Q=n,J=i,ce=r,ae=n,M=i,ne=r,pe=n,ve=i;return $.e=d(D,Z,$.e),$.t=d(x,k,$.t),$.a=d(E,F,$.a),$.o=d(T,V,$.o),$.i=d(H,z,$.i),$.n=d(te,me,$.n),$.s=d(Y,K,$.s),$.h=d(ue,de,$.h),$.r=d(oe,N,$.r),$.d=d(I,j,$.d),$.l=d(_,Q,$.l),$.u=d(v,J,$.u),$.c=d(P,ce,$.c),$.w=d(w,ae,$.w),$.m=d(A,M,$.m),$.f=d(y,ne,$.f),$.y=d(he,pe,$.y),$.g=d(W,ve,$.g),$},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),C})(),(()=>{var C=eE();return d(C,h),s(C,S(Ne,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(C,S(Ne,{variant:"primary",onClick:()=>{console.log("Edit employee:",t.employee.id)},get children(){return e("employees.editEmployee")}}),null),C})()]}})};var Rh=q("<div>"),rE=q("<div><div></div><div><div></div><div></div><div>/year");const nE=()=>{const{t}=at(),[e,r]=ye(!1),[n,i]=ye(!1),[o,a]=ye(null),c=x=>{a(x),i(!0)},u={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},h={display:"flex","align-items":"center",gap:"1rem"},f={width:"60px",height:"60px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.2rem"},p={flex:"1"},b={"font-weight":"600","margin-bottom":"0.25rem"},C={color:"var(--text-muted)","font-size":"0.875rem","margin-bottom":"0.5rem"},D={color:"var(--primary-color)","font-weight":"500"};return S(jr,{get title(){return t("employees.title")},get children(){return[(()=>{var x=Rh();return x.style.setProperty("margin-bottom","2rem"),s(x,S(Ne,{variant:"primary",onClick:()=>r(!0),get children(){return t("employees.addEmployee")}})),x})(),(()=>{var x=Rh();return d(x,u),s(x,()=>Uy.employees.map(E=>{const T=te=>te.split(" ").map(Y=>Y[0]).join("").toUpperCase(),H=te=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(te);return S(Xe,{onClick:()=>c(E),get children(){var te=rE(),Y=te.firstChild,ue=Y.nextSibling,oe=ue.firstChild,I=oe.nextSibling,_=I.nextSibling,v=_.firstChild;return d(te,h),d(Y,f),s(Y,()=>T(E.name)),d(ue,p),d(oe,b),s(oe,()=>E.name),d(I,C),s(I,()=>E.position),d(_,D),s(_,()=>H(E.salary),v),te}})})),x})(),S(JI,{get isOpen(){return e()},onClose:()=>r(!1)}),S(tE,{get isOpen(){return n()},onClose:()=>i(!1),get employee(){return o()}})]}})},iE=[{id:"1",accountId:"1002",bankName:"First National Bank",accountNumber:"****1234",accountType:"checking",currency:"USD",currentBalance:32730.5,lastReconciledDate:"2024-01-01",lastReconciledBalance:3e4,isActive:!0},{id:"2",accountId:"1003",bankName:"First National Bank",accountNumber:"****5678",accountType:"savings",currency:"USD",currentBalance:12e3,lastReconciledDate:"2024-01-01",lastReconciledBalance:1e4,isActive:!0}],oE=[{id:"1",accountId:"1002",date:"2024-01-15",description:"Customer Payment - ABC Corp",reference:"CHK001234",debitAmount:5e3,creditAmount:0,balance:35730.5,category:"Customer Payment",isReconciled:!0,reconciledWith:"eb1",importedAt:"2024-01-16",source:"csv_import"},{id:"2",accountId:"1002",date:"2024-01-14",description:"Office Supplies - Staples",reference:"CHK001235",debitAmount:0,creditAmount:250,balance:30730.5,category:"Office Expenses",isReconciled:!0,reconciledWith:"eb2",importedAt:"2024-01-16",source:"csv_import"},{id:"3",accountId:"1002",date:"2024-01-13",description:"Monthly Rent Payment",reference:"CHK001236",debitAmount:0,creditAmount:2e3,balance:28730.5,category:"Rent",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"},{id:"4",accountId:"1002",date:"2024-01-12",description:"Wire Transfer In",reference:"WIRE001",debitAmount:1e4,creditAmount:0,balance:38730.5,category:"Wire Transfer",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"}],sE=[{id:"eb1",accountId:"1002",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",debitAmount:5e3,creditAmount:0,category:"Accounts Receivable",isReconciled:!0,reconciledWith:"1",createdAt:"2024-01-15"},{id:"eb2",accountId:"1002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",debitAmount:0,creditAmount:250,category:"Office Expenses",isReconciled:!0,reconciledWith:"2",createdAt:"2024-01-14"},{id:"eb3",accountId:"1002",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",debitAmount:0,creditAmount:3500,category:"Salary Expense",isReconciled:!1,createdAt:"2024-01-11"}],aE=[{id:"1",bankAccountId:"1",periodStart:"2024-01-01",periodEnd:"2024-01-15",startingBalance:3e4,endingBalance:35730.5,status:"in_progress",totalBankTransactions:4,totalEntryBookRecords:3,reconciledTransactions:2,unreconciledTransactions:2,discrepancyAmount:1500,createdAt:"2024-01-16",notes:"Wire transfer and rent payment need investigation"}],[Os,Dh]=ye(iE),[Vn,Sl]=ye(oE),[Ao,Nh]=ye(sE),[Vs,Lh]=ye(aE),nr={get bankAccounts(){return Os()},addBankAccount(t){const e={...t,id:Date.now().toString()};return Dh([...Os(),e]),e},updateBankAccount(t,e){Dh(Os().map(r=>r.id===t?{...r,...e}:r))},getBankAccountById(t){return Os().find(e=>e.id===t)},get bankStatements(){return Vn()},addBankStatement(t){const e={...t,id:Date.now().toString(),importedAt:new Date().toISOString()};return Sl([...Vn(),e]),e},addBankStatementsFromCSV(t){const e=t.map(r=>({...r,id:`csv_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,importedAt:new Date().toISOString(),source:"csv_import",isReconciled:!1}));return Sl([...Vn(),...e]),e},updateBankStatement(t,e){Sl(Vn().map(r=>r.id===t?{...r,...e}:r))},getBankStatementsByAccount(t){return Vn().filter(e=>e.accountId===t)},getUnreconciledBankStatements(t){return(t?this.getBankStatementsByAccount(t):Vn()).filter(r=>!r.isReconciled)},get entryBookRecords(){return Ao()},addEntryBookRecord(t){const e={...t,id:Date.now().toString(),createdAt:new Date().toISOString()};return Nh([...Ao(),e]),e},updateEntryBookRecord(t,e){Nh(Ao().map(r=>r.id===t?{...r,...e}:r))},getEntryBookRecordsByAccount(t){return Ao().filter(e=>e.accountId===t)},getUnreconciledEntryBookRecords(t){return(t?this.getEntryBookRecordsByAccount(t):Ao()).filter(r=>!r.isReconciled)},reconcileTransaction(t,e){this.updateBankStatement(t,{isReconciled:!0,reconciledWith:e}),this.updateEntryBookRecord(e,{isReconciled:!0,reconciledWith:t})},unreconciledTransaction(t){const e=Vn().find(r=>r.id===t);e?.reconciledWith&&this.updateEntryBookRecord(e.reconciledWith,{isReconciled:!1,reconciledWith:void 0}),this.updateBankStatement(t,{isReconciled:!1,reconciledWith:void 0})},findPotentialMatches(t){const e=Vn().find(n=>n.id===t);return e?this.getUnreconciledEntryBookRecords(e.accountId).filter(n=>{const i=Math.abs(e.debitAmount-n.debitAmount)<.01||Math.abs(e.creditAmount-n.creditAmount)<.01,o=new Date(e.date),a=new Date(n.date),u=Math.abs((o.getTime()-a.getTime())/(1e3*60*60*24))<=3,h=e.reference===n.reference||e.description.toLowerCase().includes(n.description.toLowerCase())||n.description.toLowerCase().includes(e.description.toLowerCase());return i&&(u||h)}).sort((n,i)=>{const o=(n.date===e.date?2:0)+(n.reference===e.reference?1:0);return(i.date===e.date?2:0)+(i.reference===e.reference?1:0)-o}):[]},get reconciliationSessions(){return Vs()},startReconciliationSession(t,e,r){const n=this.getBankStatementsByAccount(t).filter(h=>h.date>=e&&h.date<=r),i=this.getEntryBookRecordsByAccount(t).filter(h=>h.date>=e&&h.date<=r),o=n.filter(h=>h.isReconciled).length,a=this.getBankAccountById(t)?.lastReconciledBalance||0,c=this.getBankAccountById(t)?.currentBalance||0,u={id:Date.now().toString(),bankAccountId:t,periodStart:e,periodEnd:r,startingBalance:a,endingBalance:c,status:"in_progress",totalBankTransactions:n.length,totalEntryBookRecords:i.length,reconciledTransactions:o,unreconciledTransactions:n.length-o,discrepancyAmount:0,createdAt:new Date().toISOString()};return Lh([...Vs(),u]),u},updateReconciliationSession(t,e){Lh(Vs().map(r=>r.id===t?{...r,...e}:r))},getReconciliationSessionsByAccount(t){return Vs().filter(e=>e.bankAccountId===t)}};var Pl=q("<div>"),lE=q("<div><strong>:</strong> <!> - "),cE=q("<div><div><div></div><div></div><div></div></div><input id=csvFileInput type=file accept=.csv>"),uE=q("<div><h4></h4><div><div><label> *</label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><select><option value>"),ji=q("<option>"),dE=q("<div><table><thead><tr></tr></thead><tbody>"),hE=q("<th>"),mE=q("<tr>"),fE=q("<td>");const yE=t=>{const{t:e}=at(),[r,n]=ye(!1),[i,o]=ye(!1),[a,c]=ye(null),[u,h]=ye([]),[f,p]=ye({date:"",description:"",reference:"",debit:"",credit:"",balance:""}),b={border:`2px dashed ${r()?"var(--primary-color)":"var(--border-color)"}`,"border-radius":"var(--border-radius)",padding:"2rem","text-align":"center","background-color":r()?"var(--background-color)":"transparent",transition:"all 0.2s ease",cursor:"pointer"},C={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem","margin-top":"1.5rem"},D={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-family":"inherit"},x={"max-height":"200px","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},E={width:"100%","border-collapse":"collapse","font-size":"0.875rem"},T={padding:"0.5rem","border-bottom":"1px solid var(--border-color)","text-align":"left"},H={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},te=A=>{A.preventDefault(),n(!0)},Y=A=>{A.preventDefault(),n(!1)},ue=A=>{A.preventDefault(),n(!1);const y=A.dataTransfer?.files;y&&y.length>0&&I(y[0])},oe=A=>{const y=A.target;y.files&&y.files.length>0&&I(y.files[0])},I=A=>{if(!A.name.toLowerCase().endsWith(".csv")){c({success:!1,message:e("banking.pleaseUploadCSV")});return}o(!0);const y=new FileReader;y.onload=he=>{try{const $=(he.target?.result).split(`
`).filter(V=>V.trim());if($.length<2){c({success:!1,message:e("banking.csvRequiresHeaderAndData")}),o(!1);return}const Z=$[0].split(",").map(V=>V.trim().replace(/[\"\']/g,"")),k=$.slice(1).map(V=>{const z=V.split(",").map(K=>K.trim().replace(/[\"\']/g,"")),me={};return Z.forEach((K,de)=>{me[K]=z[de]||""}),me});h(k),c({success:!0,message:e("banking.successfullyParsed").replace("{count}",k.length.toString()),count:k.length});const F={...f()};Z.forEach(V=>{const z=V.toLowerCase();z.includes("date")&&(F.date=V),(z.includes("description")||z.includes("memo"))&&(F.description=V),(z.includes("reference")||z.includes("check")||z.includes("ref"))&&(F.reference=V),(z.includes("debit")||z.includes("deposit"))&&(F.debit=V),(z.includes("credit")||z.includes("withdrawal")||z.includes("amount"))&&(F.debit?F.credit=V:F.debit=V),z.includes("balance")&&(F.balance=V)}),p(F)}catch{c({success:!1,message:e("banking.errorParsingCSV")})}o(!1)},y.readAsText(A)},_=(A,y)=>{p(he=>({...he,[A]:y}))},v=()=>u().length===0?[]:Object.keys(u()[0]),P=()=>{if(!t.bankAccount||u().length===0)return;const A=f();if(!A.date||!A.description){c({success:!1,message:e("banking.dateDescriptionRequired")});return}o(!0);try{const y=u().map(W=>{const $=V=>V&&parseFloat(V.replace(/[^0-9.-]/g,""))||0,Z=V=>{const z=new Date(V);if(isNaN(z.getTime())){const me=V.split("/");if(me.length===3)return new Date(parseInt(me[2]),parseInt(me[0])-1,parseInt(me[1])).toISOString().split("T")[0]}return z.toISOString().split("T")[0]};let k=0,F=0;if(A.debit&&A.credit)k=$(W[A.debit]),F=$(W[A.credit]);else if(A.debit){const V=$(W[A.debit]);V>0?k=V:F=Math.abs(V)}return{accountId:t.bankAccount.accountId,date:Z(W[A.date]),description:W[A.description]||e("banking.importedTransaction"),reference:W[A.reference]||"",debitAmount:k,creditAmount:F,balance:A.balance?$(W[A.balance]):0,isReconciled:!1}}),he=nr.addBankStatementsFromCSV(y);c({success:!0,message:e("banking.successfullyImported").replace("{count}",he.length.toString()),count:he.length}),h([]),p({date:"",description:"",reference:"",debit:"",credit:"",balance:""})}catch{c({success:!1,message:e("banking.errorImportingTransactions")})}o(!1)},w=()=>{h([]),c(null),p({date:"",description:"",reference:"",debit:"",credit:"",balance:""})};return S(dr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("banking.importBankStatementCSV")},get children(){return[fe(()=>fe(()=>!!t.bankAccount)()&&(()=>{var A=lE(),y=A.firstChild,he=y.firstChild,W=y.nextSibling,$=W.nextSibling;return $.nextSibling,A.style.setProperty("margin-bottom","1.5rem"),A.style.setProperty("padding","1rem"),A.style.setProperty("background","var(--background-color)"),A.style.setProperty("border-radius","var(--border-radius-sm)"),A.style.setProperty("border","1px solid var(--border-color)"),s(y,()=>e("banking.bankAccount"),he),s(A,()=>t.bankAccount.bankName,$),s(A,()=>t.bankAccount.accountNumber,null),A})()),fe(()=>fe(()=>u().length===0)()?(()=>{var A=cE(),y=A.firstChild,he=y.firstChild,W=he.nextSibling,$=W.nextSibling,Z=y.nextSibling;return y.$$click=()=>document.getElementById("csvFileInput")?.click(),y.addEventListener("drop",ue),y.addEventListener("dragleave",Y),y.addEventListener("dragover",te),he.style.setProperty("font-size","2rem"),he.style.setProperty("margin-bottom","1rem"),W.style.setProperty("font-weight","500"),W.style.setProperty("margin-bottom","0.5rem"),s(W,(()=>{var k=fe(()=>!!r());return()=>k()?e("banking.dropCSVHere"):e("banking.clickToUploadCSV")})()),$.style.setProperty("font-size","0.875rem"),$.style.setProperty("color","var(--text-muted)"),s($,()=>e("banking.supportedFormat")),Z.addEventListener("change",oe),Z.style.setProperty("display","none"),re(k=>d(y,b,k)),A})():(()=>{var A=uE(),y=A.firstChild,he=y.nextSibling,W=he.firstChild,$=W.firstChild,Z=$.firstChild,k=$.nextSibling,F=k.firstChild,V=W.nextSibling,z=V.firstChild,me=z.firstChild,K=z.nextSibling,de=K.firstChild,N=V.nextSibling,j=N.firstChild,Q=j.nextSibling,J=Q.firstChild,ce=N.nextSibling,ae=ce.firstChild,M=ae.firstChild,ne=ae.nextSibling,pe=ne.firstChild,ve=ce.nextSibling,ee=ve.firstChild,ie=ee.nextSibling,R=ie.firstChild,L=ve.nextSibling,B=L.firstChild,ge=B.nextSibling,le=ge.firstChild;return y.style.setProperty("margin","0 0 1rem 0"),s(y,()=>e("banking.mapCSVColumns")),d(he,C),$.style.setProperty("display","block"),$.style.setProperty("margin-bottom","0.5rem"),$.style.setProperty("font-weight","500"),s($,()=>e("banking.dateColumn"),Z),k.addEventListener("change",U=>_("date",U.target.value)),s(F,()=>e("banking.selectColumn")),s(k,()=>v().map(U=>(()=>{var G=ji();return G.value=U,s(G,U),G})()),null),z.style.setProperty("display","block"),z.style.setProperty("margin-bottom","0.5rem"),z.style.setProperty("font-weight","500"),s(z,()=>e("banking.descriptionColumn"),me),K.addEventListener("change",U=>_("description",U.target.value)),s(de,()=>e("banking.selectColumn")),s(K,()=>v().map(U=>(()=>{var G=ji();return G.value=U,s(G,U),G})()),null),j.style.setProperty("display","block"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("font-weight","500"),s(j,()=>e("banking.referenceColumn")),Q.addEventListener("change",U=>_("reference",U.target.value)),s(J,()=>e("banking.selectColumn")),s(Q,()=>v().map(U=>(()=>{var G=ji();return G.value=U,s(G,U),G})()),null),ae.style.setProperty("display","block"),ae.style.setProperty("margin-bottom","0.5rem"),ae.style.setProperty("font-weight","500"),s(ae,()=>e("banking.amountDebitColumn"),M),ne.addEventListener("change",U=>_("debit",U.target.value)),s(pe,()=>e("banking.selectColumn")),s(ne,()=>v().map(U=>(()=>{var G=ji();return G.value=U,s(G,U),G})()),null),ee.style.setProperty("display","block"),ee.style.setProperty("margin-bottom","0.5rem"),ee.style.setProperty("font-weight","500"),s(ee,()=>e("banking.creditColumn")),ie.addEventListener("change",U=>_("credit",U.target.value)),s(R,()=>e("banking.selectColumn")),s(ie,()=>v().map(U=>(()=>{var G=ji();return G.value=U,s(G,U),G})()),null),B.style.setProperty("display","block"),B.style.setProperty("margin-bottom","0.5rem"),B.style.setProperty("font-weight","500"),s(B,()=>e("banking.balanceColumn")),ge.addEventListener("change",U=>_("balance",U.target.value)),s(le,()=>e("banking.selectColumn")),s(ge,()=>v().map(U=>(()=>{var G=ji();return G.value=U,s(G,U),G})()),null),s(A,(()=>{var U=fe(()=>u().length>0);return()=>U()&&(()=>{var G=dE(),Pe=G.firstChild,_e=Pe.firstChild,se=_e.firstChild,be=_e.nextSibling;return d(G,x),se.style.setProperty("background-color","var(--background-color)"),s(se,()=>v().slice(0,6).map(X=>(()=>{var we=hE();return s(we,X),re(ke=>d(we,T,ke)),we})())),s(be,()=>u().slice(0,3).map(X=>(()=>{var we=mE();return s(we,()=>v().slice(0,6).map(ke=>(()=>{var xe=fE();return s(xe,()=>X[ke]),re(Te=>d(xe,T,Te)),xe})())),we})())),s(G,(()=>{var X=fe(()=>u().length>3);return()=>X()&&(()=>{var we=Pl();return we.style.setProperty("padding","0.5rem"),we.style.setProperty("text-align","center"),we.style.setProperty("color","var(--text-muted)"),s(we,()=>e("banking.andMoreRows").replace("{count}",(u().length-3).toString())),we})()})(),null),re(X=>d(Pe,E,X)),G})()})(),null),re(U=>{var G=D,Pe=D,_e=D,se=D,be=D,X=D;return U.e=d(k,G,U.e),U.t=d(K,Pe,U.t),U.a=d(Q,_e,U.a),U.o=d(ne,se,U.o),U.i=d(ie,be,U.i),U.n=d(ge,X,U.n),U},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),re(()=>k.value=f().date),re(()=>K.value=f().description),re(()=>Q.value=f().reference),re(()=>ne.value=f().debit),re(()=>ie.value=f().credit),re(()=>ge.value=f().balance),A})()),fe(()=>fe(()=>!!a())()&&(()=>{var A=Pl();return A.style.setProperty("padding","1rem"),A.style.setProperty("border-radius","var(--border-radius-sm)"),A.style.setProperty("margin-top","1rem"),s(A,()=>a().message),re(y=>{var he=a().success?"#d4edda":"#f8d7da",W=a().success?"#155724":"#721c24",$=`1px solid ${a().success?"#c3e6cb":"#f5c6cb"}`;return he!==y.e&&((y.e=he)!=null?A.style.setProperty("background",he):A.style.removeProperty("background")),W!==y.t&&((y.t=W)!=null?A.style.setProperty("color",W):A.style.removeProperty("color")),$!==y.a&&((y.a=$)!=null?A.style.setProperty("border",$):A.style.removeProperty("border")),y},{e:void 0,t:void 0,a:void 0}),A})()),(()=>{var A=Pl();return d(A,H),s(A,S(Ne,{variant:"secondary",onClick:()=>{w(),t.onClose()},get children(){return e("common.cancel")}}),null),s(A,(()=>{var y=fe(()=>u().length>0);return()=>y()&&S(Ne,{variant:"outline",onClick:w,get children(){return e("common.reset")}})})(),null),s(A,(()=>{var y=fe(()=>u().length>0);return()=>y()&&S(Ne,{variant:"primary",onClick:P,get disabled(){return i()||!f().date||!f().description},get children(){return fe(()=>!!i())()?e("banking.importing"):e("banking.importTransactions").replace("{count}",u().length.toString())}})})(),null),A})()]}})};At(["click"]);var Mh=q("<span>"),Bs=q("<div>"),Oh=q("<div> "),gE=q("<div><div><h3></h3><div><button></button><button></button><button></button></div></div><div></div><div><div><h4></h4><div></div></div><div><h4></h4><div>"),pE=q("<div><div><div></div><div>  </div></div><div><div>"),wl=q("<span> "),vE=q("<span>(<!>)"),bE=q("<div><strong>:</strong> "),Vh=q("<div><div><div></div><div>  </div></div><div>"),_E=q("<div><div>:</div><div></div><div>");const SE=t=>{const{t:e}=at(),[r,n]=ye([]),[i,o]=ye([]),[a,c]=ye(null),[u,h]=ye([]),[f,p]=ye("unreconciled");Tn(()=>{const $=nr.getBankAccountById(t.bankAccountId);if($){const Z=nr.getBankStatementsByAccount($.accountId).filter(F=>F.date>=t.selectedPeriod.start&&F.date<=t.selectedPeriod.end),k=nr.getEntryBookRecordsByAccount($.accountId).filter(F=>F.date>=t.selectedPeriod.start&&F.date<=t.selectedPeriod.end);n(Z),o(k)}});const b=()=>{const $=r();switch(f()){case"reconciled":return $.filter(Z=>Z.isReconciled);case"unreconciled":return $.filter(Z=>!Z.isReconciled);default:return $}},C=()=>{const $=i();switch(f()){case"reconciled":return $.filter(Z=>Z.isReconciled);case"unreconciled":return $.filter(Z=>!Z.isReconciled);default:return $}},D=$=>{if(c($),$.isReconciled)h([]);else{const Z=nr.findPotentialMatches($.id);h(Z)}},x=$=>{const Z=a();if(Z){nr.reconcileTransaction(Z.id,$.id);const k=nr.getBankAccountById(t.bankAccountId);if(k){const F=nr.getBankStatementsByAccount(k.accountId).filter(z=>z.date>=t.selectedPeriod.start&&z.date<=t.selectedPeriod.end),V=nr.getEntryBookRecordsByAccount(k.accountId).filter(z=>z.date>=t.selectedPeriod.start&&z.date<=t.selectedPeriod.end);n(F),o(V)}c(null),h([])}},E=$=>{nr.unreconciledTransaction($.id);const Z=nr.getBankAccountById(t.bankAccountId);if(Z){const k=nr.getBankStatementsByAccount(Z.accountId).filter(V=>V.date>=t.selectedPeriod.start&&V.date<=t.selectedPeriod.end),F=nr.getEntryBookRecordsByAccount(Z.accountId).filter(V=>V.date>=t.selectedPeriod.start&&V.date<=t.selectedPeriod.end);n(k),o(F)}},T={display:"grid","grid-template-columns":"1fr 1fr",gap:"2rem","margin-top":"2rem"},H={height:"600px","overflow-y":"auto"},te={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},Y=$=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:$?"var(--primary-color)":"var(--surface-color)",color:$?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),ue=($,Z)=>({display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem","margin-bottom":"0.5rem",background:$?"var(--primary-color)":Z?"#e8f5e8":"var(--surface-color)",color:$?"white":"var(--text-primary)","border-radius":"var(--border-radius-sm)",border:`1px solid ${$?"var(--primary-color)":Z?"#c3e6cb":"var(--border-color)"}`,cursor:"pointer",transition:"all 0.2s ease"}),oe={flex:"1"},I={"font-weight":"500","margin-bottom":"0.25rem"},_={"font-size":"0.875rem",opacity:"0.8"},v=$=>({"font-weight":"600",color:$?"#4caf50":"#f44336"}),P={padding:"0.25rem 0.5rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","margin-left":"0.5rem"},w=$=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format($),A=$=>new Date($).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),y=$=>{if(!a())return null;const Z=a();return(Math.abs(Z.debitAmount-$.debitAmount)<.01||Math.abs(Z.creditAmount-$.creditAmount)<.01)&&Z.date===$.date?(()=>{var V=Mh();return s(V,()=>e("banking.exactMatch")),re(z=>d(V,{...P,background:"#d4edda",color:"#155724"},z)),V})():u().includes($)?(()=>{var V=Mh();return s(V,()=>e("banking.possibleMatch")),re(z=>d(V,{...P,background:"#fff3cd",color:"#856404"},z)),V})():null},W=(()=>{const $=r(),Z=i(),k=$.filter(V=>V.isReconciled).length,F=Z.filter(V=>V.isReconciled).length;return{totalStatements:$.length,totalRecords:Z.length,reconciledStatements:k,reconciledRecords:F,unreconciledStatements:$.length-k,unreconciledRecords:Z.length-F}})();return(()=>{var $=gE(),Z=$.firstChild,k=Z.firstChild,F=k.nextSibling,V=F.firstChild,z=V.nextSibling,me=z.nextSibling,K=Z.nextSibling,de=K.nextSibling,N=de.firstChild,j=N.firstChild,Q=j.nextSibling,J=N.nextSibling,ce=J.firstChild,ae=ce.nextSibling;return d(Z,te),k.style.setProperty("margin","0"),k.style.setProperty("font-size","1.25rem"),s(k,()=>e("banking.reconciliationComparison")),F.style.setProperty("display","flex"),F.style.setProperty("gap","0.5rem"),V.$$click=()=>p("all"),s(V,()=>e("common.all")),z.$$click=()=>p("unreconciled"),s(z,()=>e("banking.unreconciled")),me.$$click=()=>p("reconciled"),s(me,()=>e("banking.reconciled")),K.style.setProperty("display","grid"),K.style.setProperty("grid-template-columns","repeat(4, 1fr)"),K.style.setProperty("gap","1rem"),K.style.setProperty("margin-bottom","2rem"),s(K,S(Xe,{get title(){return e("banking.bankStatements")},get subtitle(){return e("banking.totalTransactions")},get children(){return[(()=>{var M=Bs();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","var(--primary-color)"),s(M,()=>W.totalStatements),M})(),(()=>{var M=Oh(),ne=M.firstChild;return M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","var(--text-muted)"),s(M,()=>W.reconciledStatements,ne),s(M,()=>e("banking.reconciled"),null),M})()]}}),null),s(K,S(Xe,{get title(){return e("banking.entryBookRecords")},get subtitle(){return e("banking.totalEntries")},get children(){return[(()=>{var M=Bs();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","var(--primary-color)"),s(M,()=>W.totalRecords),M})(),(()=>{var M=Oh(),ne=M.firstChild;return M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","var(--text-muted)"),s(M,()=>W.reconciledRecords,ne),s(M,()=>e("banking.reconciled"),null),M})()]}}),null),s(K,S(Xe,{get title(){return e("banking.unreconciledBank")},get subtitle(){return e("banking.needAttention")},get children(){var M=Bs();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","#f44336"),s(M,()=>W.unreconciledStatements),M}}),null),s(K,S(Xe,{get title(){return e("banking.unreconciledBooks")},get subtitle(){return e("banking.needAttention")},get children(){var M=Bs();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","#f44336"),s(M,()=>W.unreconciledRecords),M}}),null),d(de,T),j.style.setProperty("margin","0 0 1rem 0"),s(j,()=>e("banking.bankStatements")),s(Q,()=>b().map(M=>(()=>{var ne=pE(),pe=ne.firstChild,ve=pe.firstChild,ee=ve.nextSibling,ie=ee.firstChild,R=pe.nextSibling,L=R.firstChild;return ne.$$click=()=>D(M),s(ve,()=>M.description),s(ee,()=>A(M.date),ie),s(ee,()=>M.reference,null),s(ee,(()=>{var B=fe(()=>!!M.isReconciled);return()=>B()&&(()=>{var ge=wl();return ge.firstChild,ge.style.setProperty("color","#4caf50"),ge.style.setProperty("margin-left","0.5rem"),s(ge,()=>e("banking.reconciled"),null),ge})()})(),null),s(L,()=>M.debitAmount>0?"+":"-",null),s(L,()=>w(M.debitAmount||M.creditAmount),null),s(R,(()=>{var B=fe(()=>!!M.isReconciled);return()=>B()&&S(Ne,{variant:"outline",size:"sm",onClick:ge=>{ge.stopPropagation(),E(M)},style:{"margin-top":"0.5rem"},get children(){return e("banking.unreconcile")}})})(),null),re(B=>{var ge=ue(a()?.id===M.id,M.isReconciled),le=oe,U=I,G=_,Pe=v(M.debitAmount>0);return B.e=d(ne,ge,B.e),B.t=d(pe,le,B.t),B.a=d(ve,U,B.a),B.o=d(ee,G,B.o),B.i=d(L,Pe,B.i),B},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ne})())),ce.style.setProperty("margin","0 0 1rem 0"),s(ce,()=>e("banking.entryBookRecords"),null),s(ce,(()=>{var M=fe(()=>!!(a()&&!a().isReconciled));return()=>M()&&(()=>{var ne=vE(),pe=ne.firstChild,ve=pe.nextSibling;return ve.nextSibling,ne.style.setProperty("font-weight","400"),ne.style.setProperty("color","var(--text-muted)"),ne.style.setProperty("margin-left","0.5rem"),s(ne,()=>e("banking.clickToReconcile"),ve),ne})()})(),null),s(ae,(()=>{var M=fe(()=>!!(a()&&!a().isReconciled));return()=>M()?[fe(()=>fe(()=>u().length>0)()&&(()=>{var ne=bE(),pe=ne.firstChild,ve=pe.firstChild;return pe.nextSibling,ne.style.setProperty("margin-bottom","1rem"),ne.style.setProperty("padding","0.75rem"),ne.style.setProperty("background","#fff3cd"),ne.style.setProperty("border-radius","var(--border-radius-sm)"),s(pe,()=>e("banking.potentialMatchesFound"),ve),s(ne,()=>e("banking.clickRecordToReconcile"),null),ne})()),fe(()=>C().map(ne=>(u().includes(ne),(()=>{var pe=Vh(),ve=pe.firstChild,ee=ve.firstChild,ie=ee.nextSibling,R=ie.firstChild,L=ve.nextSibling;return pe.$$click=()=>{ne.isReconciled||x(ne)},s(ee,()=>ne.description,null),s(ee,()=>y(ne),null),s(ie,()=>A(ne.date),R),s(ie,()=>ne.reference,null),s(ie,(()=>{var B=fe(()=>!!ne.isReconciled);return()=>B()&&(()=>{var ge=wl();return ge.firstChild,ge.style.setProperty("color","#4caf50"),ge.style.setProperty("margin-left","0.5rem"),s(ge,()=>e("banking.reconciled"),null),ge})()})(),null),s(L,()=>ne.debitAmount>0?"+":"-",null),s(L,()=>w(ne.debitAmount||ne.creditAmount),null),re(B=>{var ge={...ue(!1,ne.isReconciled),opacity:ne.isReconciled?.6:1,cursor:ne.isReconciled?"not-allowed":"pointer"},le=oe,U=I,G=_,Pe=v(ne.debitAmount>0);return B.e=d(pe,ge,B.e),B.t=d(ve,le,B.t),B.a=d(ee,U,B.a),B.o=d(ie,G,B.o),B.i=d(L,Pe,B.i),B},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),pe})())))]:C().map(ne=>(()=>{var pe=Vh(),ve=pe.firstChild,ee=ve.firstChild,ie=ee.nextSibling,R=ie.firstChild,L=ve.nextSibling;return s(ee,()=>ne.description),s(ie,()=>A(ne.date),R),s(ie,()=>ne.reference,null),s(ie,(()=>{var B=fe(()=>!!ne.isReconciled);return()=>B()&&(()=>{var ge=wl();return ge.firstChild,ge.style.setProperty("color","#4caf50"),ge.style.setProperty("margin-left","0.5rem"),s(ge,()=>e("banking.reconciled"),null),ge})()})(),null),s(L,()=>ne.debitAmount>0?"+":"-",null),s(L,()=>w(ne.debitAmount||ne.creditAmount),null),re(B=>{var ge=ue(!1,ne.isReconciled),le=oe,U=I,G=_,Pe=v(ne.debitAmount>0);return B.e=d(pe,ge,B.e),B.t=d(ve,le,B.t),B.a=d(ee,U,B.a),B.o=d(ie,G,B.o),B.i=d(L,Pe,B.i),B},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),pe})())})()),s($,(()=>{var M=fe(()=>!!(a()&&!a().isReconciled));return()=>M()&&(()=>{var ne=_E(),pe=ne.firstChild,ve=pe.firstChild,ee=pe.nextSibling,ie=ee.nextSibling;return ne.style.setProperty("position","fixed"),ne.style.setProperty("bottom","2rem"),ne.style.setProperty("right","2rem"),ne.style.setProperty("background","var(--surface-color)"),ne.style.setProperty("padding","1rem"),ne.style.setProperty("border-radius","var(--border-radius)"),ne.style.setProperty("box-shadow","var(--shadow-lg)"),ne.style.setProperty("border","1px solid var(--border-color)"),ne.style.setProperty("max-width","300px"),pe.style.setProperty("font-weight","500"),pe.style.setProperty("margin-bottom","0.5rem"),s(pe,()=>e("banking.selected"),ve),ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("margin-bottom","0.5rem"),s(ee,()=>a().description),ie.style.setProperty("font-weight","600"),ie.style.setProperty("color","var(--primary-color)"),s(ie,()=>w(a().debitAmount||a().creditAmount)),s(ne,S(Ne,{variant:"secondary",size:"sm",onClick:()=>{c(null),h([])},style:{"margin-top":"0.5rem"},get children(){return e("banking.clearSelection")}}),null),ne})()})(),null),re(M=>{var ne=Y(f()==="all"),pe=Y(f()==="unreconciled"),ve=Y(f()==="reconciled"),ee=H,ie=H;return M.e=d(V,ne,M.e),M.t=d(z,pe,M.t),M.a=d(me,ve,M.a),M.o=d(Q,ee,M.o),M.i=d(ae,ie,M.i),M},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),$})()};At(["click"]);var PE=q("<div><div><h2></h2><p></p></div><div>"),wE=q("<div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date>"),CE=q("<div><button></button><button>"),AE=q("<div><br>"),Io=q("<div>"),IE=q("<div><div></div><div>  </div><div>"),EE=q("<div>: "),xE=q("<div> <!>  <!> "),TE=q("<div>%"),$E=q("<div> of <!> transactions");const kE=()=>{const{t}=at(),[e,r]=ye(null),[n,i]=ye({start:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[o,a]=ye(!1),[c,u]=ye("overview");Tn(()=>{!e()&&nr.bankAccounts.length>0&&r(nr.bankAccounts[0])});const h={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},f={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},p={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},b=te=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:te?"var(--primary-color)":"var(--text-muted)","border-bottom":te?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),C={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},D=te=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(te),x=te=>new Date(te).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),E=()=>nr.bankAccounts.map(te=>({value:te.id,label:`${te.bankName} - ${te.accountNumber} (${te.accountType})`})),H=(()=>{if(!e())return null;const te=nr.getBankStatementsByAccount(e().accountId).filter(oe=>oe.date>=n().start&&oe.date<=n().end),Y=nr.getEntryBookRecordsByAccount(e().accountId).filter(oe=>oe.date>=n().start&&oe.date<=n().end),ue=te.filter(oe=>oe.isReconciled).length;return Y.filter(oe=>oe.isReconciled).length,{totalBankTransactions:te.length,totalEntryBookRecords:Y.length,reconciledTransactions:ue,unreconciledTransactions:te.length-ue,reconciliationRate:te.length>0?ue/te.length*100:0}})();return S(jr,{get title(){return t("banking.title")},get children(){return[(()=>{var te=PE(),Y=te.firstChild,ue=Y.firstChild,oe=ue.nextSibling,I=Y.nextSibling;return d(te,h),ue.style.setProperty("margin","0 0 0.5rem 0"),ue.style.setProperty("font-size","1.5rem"),s(ue,()=>t("banking.reconciliation")),oe.style.setProperty("margin","0"),oe.style.setProperty("color","var(--text-muted)"),s(oe,()=>t("banking.compareStatements")),I.style.setProperty("display","flex"),I.style.setProperty("gap","1rem"),s(I,S(Ne,{variant:"secondary",onClick:()=>a(!0),get disabled(){return!e()},get children(){return t("banking.importCSV")}}),null),s(I,S(Ne,{variant:"primary",get children(){return t("banking.startNewReconciliation")}}),null),te})(),(()=>{var te=wE(),Y=te.firstChild,ue=Y.firstChild,oe=Y.nextSibling,I=oe.firstChild,_=I.nextSibling,v=oe.nextSibling,P=v.firstChild,w=P.nextSibling;return d(te,f),Y.style.setProperty("flex","1"),ue.style.setProperty("display","block"),ue.style.setProperty("margin-bottom","0.5rem"),ue.style.setProperty("font-weight","500"),s(ue,()=>t("banking.bankAccount")),s(Y,S(yr,{label:"",get value(){return e()?.id||""},onChange:A=>{const y=nr.getBankAccountById(A);r(y||null)},get options(){return E()}}),null),I.style.setProperty("display","block"),I.style.setProperty("margin-bottom","0.5rem"),I.style.setProperty("font-weight","500"),s(I,()=>t("entryBooks.startDate")),_.addEventListener("change",A=>i(y=>({...y,start:A.target.value}))),_.style.setProperty("padding","0.75rem"),_.style.setProperty("border","1px solid var(--border-color)"),_.style.setProperty("border-radius","var(--border-radius-sm)"),_.style.setProperty("font-family","inherit"),P.style.setProperty("display","block"),P.style.setProperty("margin-bottom","0.5rem"),P.style.setProperty("font-weight","500"),s(P,()=>t("entryBooks.endDate")),w.addEventListener("change",A=>i(y=>({...y,end:A.target.value}))),w.style.setProperty("padding","0.75rem"),w.style.setProperty("border","1px solid var(--border-color)"),w.style.setProperty("border-radius","var(--border-radius-sm)"),w.style.setProperty("font-family","inherit"),re(()=>_.value=n().start),re(()=>w.value=n().end),te})(),(()=>{var te=CE(),Y=te.firstChild,ue=Y.nextSibling;return d(te,p),Y.$$click=()=>u("overview"),s(Y,()=>t("common.overview")),ue.$$click=()=>u("reconciliation"),s(ue,()=>t("banking.reconciliation")),re(oe=>{var I=b(c()==="overview"),_=b(c()==="reconciliation");return oe.e=d(Y,I,oe.e),oe.t=d(ue,_,oe.t),oe},{e:void 0,t:void 0}),te})(),fe(()=>fe(()=>c()==="overview")()&&(()=>{var te=Io();return s(te,(()=>{var Y=fe(()=>!!e());return()=>Y()&&(()=>{var ue=Io();return d(ue,C),s(ue,S(Xe,{get title(){return t("banking.bankAccountInfo")},get subtitle(){return t("banking.currentAccountDetails")},get children(){return[(()=>{var oe=IE(),I=oe.firstChild,_=I.nextSibling,v=_.firstChild,P=_.nextSibling;return oe.style.setProperty("margin-bottom","1rem"),I.style.setProperty("font-weight","600"),I.style.setProperty("margin-bottom","0.5rem"),s(I,()=>e().bankName),_.style.setProperty("color","var(--text-muted)"),_.style.setProperty("margin-bottom","0.5rem"),s(_,()=>e().accountNumber,v),s(_,()=>e().accountType,null),P.style.setProperty("font-size","1.25rem"),P.style.setProperty("font-weight","600"),P.style.setProperty("color","var(--primary-color)"),s(P,()=>D(e().currentBalance)),oe})(),fe(()=>fe(()=>!!e().lastReconciledDate)()&&(()=>{var oe=EE(),I=oe.firstChild;return oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),s(oe,()=>t("banking.lastReconciled"),I),s(oe,()=>x(e().lastReconciledDate),null),oe})())]}}),null),s(ue,H&&[S(Xe,{get title(){return t("banking.bankTransactions")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var oe=Io();return oe.style.setProperty("font-size","1.5rem"),oe.style.setProperty("font-weight","600"),oe.style.setProperty("color","var(--primary-color)"),oe.style.setProperty("margin-bottom","0.5rem"),s(oe,()=>H.totalBankTransactions),oe})(),(()=>{var oe=xE(),I=oe.firstChild,_=I.nextSibling,v=_.nextSibling,P=v.nextSibling;return P.nextSibling,oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),s(oe,()=>H.reconciledTransactions,I),s(oe,()=>t("banking.reconciled"),_),s(oe,()=>H.unreconciledTransactions,P),s(oe,()=>t("banking.pending"),null),oe})()]}}),S(Xe,{get title(){return t("entryBooks.entryBookRecords")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var oe=Io();return oe.style.setProperty("font-size","1.5rem"),oe.style.setProperty("font-weight","600"),oe.style.setProperty("color","var(--primary-color)"),oe.style.setProperty("margin-bottom","0.5rem"),s(oe,()=>H.totalEntryBookRecords),oe})(),(()=>{var oe=Io();return oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),s(oe,()=>t("banking.bookEntriesForComparison")),oe})()]}}),S(Xe,{get title(){return t("banking.reconciliationRate")},get subtitle(){return t("banking.completionStatus")},get children(){return[(()=>{var oe=TE(),I=oe.firstChild;return oe.style.setProperty("font-size","1.5rem"),oe.style.setProperty("font-weight","600"),oe.style.setProperty("margin-bottom","0.5rem"),s(oe,()=>Math.round(H.reconciliationRate),I),re(_=>(_=H.reconciliationRate>80?"#4caf50":H.reconciliationRate>50?"#ff9800":"#f44336")!=null?oe.style.setProperty("color",_):oe.style.removeProperty("color")),oe})(),(()=>{var oe=$E(),I=oe.firstChild,_=I.nextSibling;return _.nextSibling,oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),s(oe,()=>H.reconciledTransactions,I),s(oe,()=>H.totalBankTransactions,_),oe})()]}})],null),ue})()})(),null),s(te,S(Xe,{get title(){return t("banking.recentReconciliationSessions")},get subtitle(){return t("banking.latestActivity")},get children(){var Y=AE(),ue=Y.firstChild;return Y.style.setProperty("text-align","center"),Y.style.setProperty("color","var(--text-muted)"),Y.style.setProperty("padding","2rem"),s(Y,()=>t("banking.noRecentSessions"),ue),s(Y,S(Ne,{variant:"primary",style:{"margin-top":"1rem"},onClick:()=>u("reconciliation"),get children(){return t("banking.startFirstReconciliation")}}),null),Y}}),null),te})()),fe(()=>fe(()=>!!(c()==="reconciliation"&&e()))()&&S(SE,{get bankAccountId(){return e().id},get selectedPeriod(){return n()}})),S(yE,{get isOpen(){return o()},onClose:()=>a(!1),get bankAccount(){return e()}})]}})};At(["click"]);var RE=q("<div><div></div><div>"),Cl=q("<div>"),DE=q("<div>  <!>  <!> "),NE=q("<div><div><div></div><div></div></div><div><div></div><div>"),LE=q("<div><div>:"),ME=q("<div> <!>: <!> <!>, <!> "),OE=q("<div><div><div></div><div></div></div><div>"),Bh=q("<div> "),VE=q("<div> ");const BE=t=>{const{t:e}=at(),r={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},n={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},i={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},o={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)","margin-bottom":"0.5rem"},a={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"1rem"},c={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},u={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},h={"max-height":"100px","overflow-y":"auto","border-top":"1px solid var(--border-color)","padding-top":"1rem"},f={display:"flex","justify-content":"space-between","align-items":"center","font-size":"0.875rem","margin-bottom":"0.5rem"},p={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},b=T=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[T],C=T=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(T),D=T=>new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),x=b(t.entry.status),E=Math.abs(t.entry.totalDebit-t.entry.totalCredit)<.01;return S(Xe,{get children(){return[(()=>{var T=RE(),H=T.firstChild,te=H.nextSibling;return d(T,r),d(H,n),s(H,()=>t.entry.entryNumber),s(te,()=>t.entry.status),re(Y=>d(te,{...i,background:x.bg,color:x.color},Y)),T})(),(()=>{var T=Cl();return d(T,o),s(T,()=>t.entry.description),T})(),(()=>{var T=DE(),H=T.firstChild,te=H.nextSibling,Y=te.nextSibling,ue=Y.nextSibling;return ue.nextSibling,d(T,a),s(T,()=>D(t.entry.date),H),s(T,()=>t.entry.reference||e("journal.noReference","No reference"),te),s(T,()=>e("journal.createdBy","By"),ue),s(T,()=>t.entry.createdBy,null),T})(),(()=>{var T=NE(),H=T.firstChild,te=H.firstChild,Y=te.nextSibling,ue=H.nextSibling,oe=ue.firstChild,I=oe.nextSibling;return d(T,c),te.style.setProperty("font-size","0.875rem"),te.style.setProperty("color","var(--text-muted)"),s(te,()=>e("journal.totalAmount","Total Amount")),d(Y,u),s(Y,()=>C(t.entry.totalDebit)),ue.style.setProperty("text-align","right"),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),s(oe,()=>e("journal.lines","Lines")),I.style.setProperty("font-weight","600"),s(I,()=>t.entry.lines.length),T})(),fe(()=>!E&&(()=>{var T=ME(),H=T.firstChild,te=H.nextSibling,Y=te.nextSibling,ue=Y.nextSibling,oe=ue.nextSibling,I=oe.nextSibling,_=I.nextSibling,v=_.nextSibling;return v.nextSibling,T.style.setProperty("padding","0.5rem"),T.style.setProperty("border-radius","var(--border-radius-sm)"),T.style.setProperty("background","#f8d7da"),T.style.setProperty("color","#721c24"),T.style.setProperty("font-size","0.875rem"),T.style.setProperty("margin-bottom","1rem"),s(T,()=>e("journal.entryNotBalancedShort","Entry is not balanced"),te),s(T,()=>e("journal.debit"),ue),s(T,()=>C(t.entry.totalDebit),I),s(T,()=>e("journal.credit"),v),s(T,()=>C(t.entry.totalCredit),null),T})()),(()=>{var T=LE(),H=T.firstChild,te=H.firstChild;return d(T,h),H.style.setProperty("font-weight","500"),H.style.setProperty("margin-bottom","0.5rem"),H.style.setProperty("font-size","0.875rem"),s(H,()=>e("journal.accountLines","Account Lines"),te),s(T,()=>t.entry.lines.slice(0,3).map(Y=>(()=>{var ue=OE(),oe=ue.firstChild,I=oe.firstChild,_=I.nextSibling,v=oe.nextSibling;return d(ue,f),oe.style.setProperty("flex","1"),I.style.setProperty("font-weight","500"),s(I,()=>Y.accountName),_.style.setProperty("font-size","0.75rem"),_.style.setProperty("color","var(--text-muted)"),s(_,()=>Y.description||e("journal.noDescription","No description")),v.style.setProperty("text-align","right"),s(v,(()=>{var P=fe(()=>Y.debitAmount>0);return()=>P()&&(()=>{var w=Bh(),A=w.firstChild;return w.style.setProperty("color","#4caf50"),w.style.setProperty("font-weight","500"),s(w,()=>e("journal.debitShort","Dr."),A),s(w,()=>C(Y.debitAmount),null),w})()})(),null),s(v,(()=>{var P=fe(()=>Y.creditAmount>0);return()=>P()&&(()=>{var w=Bh(),A=w.firstChild;return w.style.setProperty("color","#f44336"),w.style.setProperty("font-weight","500"),s(w,()=>e("journal.creditShort","Cr."),A),s(w,()=>C(Y.creditAmount),null),w})()})(),null),s(v,(()=>{var P=fe(()=>!!Y.reconciled);return()=>P()&&(()=>{var w=VE();return w.firstChild,w.style.setProperty("font-size","0.75rem"),w.style.setProperty("color","#4caf50"),s(w,()=>e("banking.reconciled","Reconciled"),null),w})()})(),null),ue})()),null),s(T,(()=>{var Y=fe(()=>t.entry.lines.length>3);return()=>Y()&&(()=>{var ue=Cl();return ue.style.setProperty("text-align","center"),ue.style.setProperty("color","var(--text-muted)"),ue.style.setProperty("font-size","0.875rem"),s(ue,()=>e("journal.andMoreLines","... and {count} more lines").replace("{count}",(t.entry.lines.length-3).toString())),ue})()})(),null),T})(),(()=>{var T=Cl();return d(T,p),s(T,S(Ne,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.entry),get children(){return e("journal.viewDetails","View Details")}})),T})()]}})},FE=[{id:"je1",entryNumber:"JE-2024-001",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",status:"posted",createdBy:"John Doe",createdAt:"2024-01-15T09:00:00Z",postedAt:"2024-01-15T09:05:00Z",totalDebit:5e3,totalCredit:5e3,lines:[{id:"jel1",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment from ABC Corp",debitAmount:5e3,creditAmount:0,reconciled:!0,reconciledWith:"eb1"},{id:"jel2",accountId:"2001",accountName:"Trade Receivables",description:"Payment received for INV-2024-001",debitAmount:0,creditAmount:5e3}]},{id:"je2",entryNumber:"JE-2024-002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",status:"posted",createdBy:"Jane Smith",createdAt:"2024-01-14T10:00:00Z",postedAt:"2024-01-14T10:15:00Z",totalDebit:250,totalCredit:250,lines:[{id:"jel3",accountId:"5200",accountName:"Office Expenses",description:"Office supplies from Staples",debitAmount:250,creditAmount:0},{id:"jel4",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment to Staples",debitAmount:0,creditAmount:250,reconciled:!0,reconciledWith:"eb2"}]},{id:"je3",entryNumber:"JE-2024-003",date:"2024-01-13",description:"Monthly Rent Payment",reference:"RENT-2024-01",status:"posted",createdBy:"John Doe",createdAt:"2024-01-13T08:00:00Z",postedAt:"2024-01-13T08:30:00Z",totalDebit:2e3,totalCredit:2e3,lines:[{id:"jel5",accountId:"5200",accountName:"Rent Expense",description:"January office rent",debitAmount:2e3,creditAmount:0},{id:"jel6",accountId:"1002",accountName:"Bank - Checking Account",description:"Rent payment",debitAmount:0,creditAmount:2e3,reconciled:!1}]},{id:"je4",entryNumber:"JE-2024-004",date:"2024-01-12",description:"Wire Transfer - Capital Investment",reference:"WIRE-001",status:"posted",createdBy:"Admin",createdAt:"2024-01-12T14:00:00Z",postedAt:"2024-01-12T14:30:00Z",totalDebit:1e4,totalCredit:1e4,lines:[{id:"jel7",accountId:"1002",accountName:"Bank - Checking Account",description:"Wire transfer received",debitAmount:1e4,creditAmount:0,reconciled:!1},{id:"jel8",accountId:"8",accountName:"Owner's Equity",description:"Capital investment",debitAmount:0,creditAmount:1e4}]},{id:"je5",entryNumber:"JE-2024-005",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",status:"posted",createdBy:"HR Manager",createdAt:"2024-01-11T16:00:00Z",postedAt:"2024-01-11T16:30:00Z",totalDebit:3500,totalCredit:3500,lines:[{id:"jel9",accountId:"13",accountName:"Salaries Expense",description:"Monthly salary - John Doe",debitAmount:3500,creditAmount:0},{id:"jel10",accountId:"1002",accountName:"Bank - Checking Account",description:"Salary payment",debitAmount:0,creditAmount:3500,reconciled:!1}]},{id:"je6",entryNumber:"JE-2024-006",date:"2024-01-10",description:"Product Sales - Multiple Customers",reference:"SALES-2024-010",status:"posted",createdBy:"Sales Manager",createdAt:"2024-01-10T11:00:00Z",postedAt:"2024-01-10T11:30:00Z",totalDebit:8500,totalCredit:8500,lines:[{id:"jel11",accountId:"1001",accountName:"Petty Cash",description:"Cash sales",debitAmount:1500,creditAmount:0},{id:"jel12",accountId:"2001",accountName:"Trade Receivables",description:"Credit sales",debitAmount:7e3,creditAmount:0},{id:"jel13",accountId:"10",accountName:"Sales Revenue",description:"Product sales revenue",debitAmount:0,creditAmount:8500}]},{id:"je7",entryNumber:"JE-2024-007",date:"2024-01-09",description:"Inventory Purchase",reference:"PO-2024-002",status:"draft",createdBy:"Warehouse Manager",createdAt:"2024-01-09T15:00:00Z",totalDebit:15e3,totalCredit:15e3,lines:[{id:"jel14",accountId:"3",accountName:"Inventory",description:"Product inventory purchase",debitAmount:15e3,creditAmount:0},{id:"jel15",accountId:"5",accountName:"Accounts Payable",description:"Amount owed to supplier",debitAmount:0,creditAmount:15e3}]},{id:"je8",entryNumber:"JE-2024-008",date:"2024-01-08",description:"Utility Bills Payment",reference:"UTIL-2024-01",status:"posted",createdBy:"Admin",createdAt:"2024-01-08T09:00:00Z",postedAt:"2024-01-08T09:30:00Z",totalDebit:450,totalCredit:450,lines:[{id:"jel16",accountId:"14",accountName:"Operating Expenses",description:"Electricity and water bills",debitAmount:450,creditAmount:0},{id:"jel17",accountId:"1003",accountName:"Bank - Savings Account",description:"Utility payment",debitAmount:0,creditAmount:450}]}],[Dr,Al]=ye(FE),Fh=()=>Dr().filter(e=>e.status==="posted").flatMap(e=>e.lines.filter(r=>["1001","1002","1003"].includes(r.accountId))).map(e=>{const r=Dr().find(n=>n.lines.some(i=>i.id===e.id));return r?{id:`eb_${e.id}`,accountId:e.accountId,date:r.date,description:r.description,reference:r.reference,debitAmount:e.debitAmount,creditAmount:e.creditAmount,category:e.accountName,isReconciled:e.reconciled||!1,reconciledWith:e.reconciledWith,createdAt:r.createdAt}:null}).filter(e=>e!==null),Pn={get journalEntries(){return Dr()},addJournalEntry(t){const e={...t,id:Date.now().toString()};return Al([...Dr(),e]),e},updateJournalEntry(t,e){Al(Dr().map(r=>r.id===t?{...r,...e}:r))},deleteJournalEntry(t){const e=Dr().find(r=>r.id===t);if(e&&e.status==="posted")throw new Error("Cannot delete posted journal entries. Void them instead.");Al(Dr().filter(r=>r.id!==t))},voidJournalEntry(t){this.updateJournalEntry(t,{status:"void"})},postJournalEntry(t){const e=Dr().find(r=>r.id===t);if(!e)throw new Error("Journal entry not found");if(Math.abs(e.totalDebit-e.totalCredit)>.01)throw new Error("Journal entry is not balanced. Debits must equal credits.");this.updateJournalEntry(t,{status:"posted",postedAt:new Date().toISOString()}),Fh()},getJournalEntryById(t){return Dr().find(e=>e.id===t)},getJournalEntriesByStatus(t){return Dr().filter(e=>e.status===t)},getJournalEntriesByDateRange(t,e){return Dr().filter(r=>r.date>=t&&r.date<=e)},getJournalEntriesByAccount(t){return Dr().filter(e=>e.lines.some(r=>r.accountId===t))},getNextEntryNumber(){const t=new Date().getFullYear(),r=Dr().filter(n=>n.entryNumber.includes(t.toString())).reduce((n,i)=>{const o=parseInt(i.entryNumber.split("-").pop()||"0");return o>n?o:n},0);return`JE-${t}-${String(r+1).padStart(3,"0")}`},validateJournalEntry(t){const e=[];if(t.date||e.push("Date is required"),t.description||e.push("Description is required"),(!t.lines||t.lines.length===0)&&e.push("At least one line item is required"),t.lines){const r=t.lines.reduce((i,o)=>i+(o.debitAmount||0),0),n=t.lines.reduce((i,o)=>i+(o.creditAmount||0),0);Math.abs(r-n)>.01&&e.push(`Entry is not balanced. Debit: ${r}, Credit: ${n}`),t.lines.forEach((i,o)=>{i.accountId||e.push(`Line ${o+1}: Account is required`),i.debitAmount===0&&i.creditAmount===0&&e.push(`Line ${o+1}: Either debit or credit amount must be provided`),i.debitAmount>0&&i.creditAmount>0&&e.push(`Line ${o+1}: Cannot have both debit and credit amounts`)})}return{isValid:e.length===0,errors:e}},getBankRelatedEntries(){return Fh()}};var UE=q("<form><div></div><div><div><h4></h4></div><div><div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div></div></div><div><div><strong>: </strong></div><div><strong>: </strong></div><div></div></div></div><div>"),Uh=q("<div>");const jy=t=>{const{t:e}=at(),[r,n]=ye({entryNumber:"",date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),[i,o]=ye([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),[a,c]=ye(null);Tn(()=>{if(t.isOpen){if(t.editEntry)n({entryNumber:t.editEntry.entryNumber,date:t.editEntry.date,description:t.editEntry.description,reference:t.editEntry.reference,createdBy:t.editEntry.createdBy}),o(t.editEntry.lines.map((Y,ue)=>({...Y,tempId:`line_${Date.now()}_${ue}`})));else{const Y=Pn.getNextEntryNumber();n({entryNumber:Y,date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),o([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])}c(null)}});const u={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},h={display:"grid","grid-template-columns":"2fr 2fr 1fr 1fr 1fr",gap:"1rem","align-items":"end","margin-bottom":"1rem",padding:"1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},f={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},p=()=>yt.accounts.map(Y=>({value:Y.id,label:`${Y.accountNumber} - ${Y.name}`})),b=(Y,ue)=>{n(oe=>({...oe,[Y]:ue}))},C=(Y,ue,oe)=>{o(I=>I.map(_=>{if(_.tempId===Y){const v={..._,[ue]:oe};if(ue==="accountId"&&typeof oe=="string"){const P=yt.getAccountById(oe);P&&(v.accountName=P.name)}return v}return _}))},D=()=>{o(Y=>[...Y,{tempId:`line_${Date.now()}_${Y.length}`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])},x=Y=>{i().length>2&&o(ue=>ue.filter(oe=>oe.tempId!==Y))},E=()=>{const Y=i().reduce((oe,I)=>oe+(I.debitAmount||0),0),ue=i().reduce((oe,I)=>oe+(I.creditAmount||0),0);return{totalDebit:Y,totalCredit:ue,isBalanced:Math.abs(Y-ue)<.01}},T=Y=>{Y.preventDefault(),c(null);const ue=r(),oe=i(),{totalDebit:I,totalCredit:_,isBalanced:v}=E();if(!ue.description){c(e("forms.descriptionRequired","Description is required"));return}if(oe.length<2){c(e("journal.minTwoLinesRequired","At least 2 line items are required"));return}if(!v){c(e("journal.entryNotBalanced","Entry is not balanced. Debit: ${debit}, Credit: ${credit}").replace("${debit}",`$${I.toFixed(2)}`).replace("${credit}",`$${_.toFixed(2)}`));return}for(let w=0;w<oe.length;w++){const A=oe[w];if(!A.accountId){c(e("journal.lineAccountRequired","Line {lineNumber}: Account is required").replace("{lineNumber}",(w+1).toString()));return}if(A.debitAmount===0&&A.creditAmount===0){c(e("journal.lineAmountRequired","Line {lineNumber}: Either debit or credit amount must be provided").replace("{lineNumber}",(w+1).toString()));return}if((A.debitAmount||0)>0&&(A.creditAmount||0)>0){c(e("journal.lineBothAmounts","Line {lineNumber}: Cannot have both debit and credit amounts").replace("{lineNumber}",(w+1).toString()));return}}const P={entryNumber:ue.entryNumber,date:ue.date,description:ue.description,reference:ue.reference,status:"draft",createdBy:ue.createdBy,createdAt:new Date().toISOString(),totalDebit:I,totalCredit:_,lines:oe.map((w,A)=>{const{tempId:y,...he}=w;return{id:`jel_${Date.now()}_${A}`,...he}})};try{t.editEntry?Pn.updateJournalEntry(t.editEntry.id,P):Pn.addJournalEntry(P),n({entryNumber:Pn.getNextEntryNumber(),date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),o([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),t.onClose()}catch(w){c(w instanceof Error?w.message:e("forms.errorOccurred","An error occurred"))}},H=Y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Y),te=E();return S(dr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return fe(()=>!!t.editEntry)()?e("journal.editEntry"):e("journal.addEntry","Add Journal Entry")},get children(){var Y=UE(),ue=Y.firstChild,oe=ue.nextSibling,I=oe.firstChild,_=I.firstChild,v=I.nextSibling,P=v.firstChild,w=P.firstChild,A=w.firstChild,y=w.nextSibling,he=y.firstChild,W=y.nextSibling,$=W.firstChild,Z=W.nextSibling,k=Z.firstChild,F=Z.nextSibling,V=F.firstChild,z=v.nextSibling,me=z.firstChild,K=me.firstChild,de=K.firstChild,N=me.nextSibling,j=N.firstChild,Q=j.firstChild,J=N.nextSibling,ce=oe.nextSibling;return Y.addEventListener("submit",T),ue.style.setProperty("display","grid"),ue.style.setProperty("grid-template-columns","1fr 1fr"),ue.style.setProperty("gap","1rem"),s(ue,S(Ct,{get label(){return e("journal.entryNumber")},get value(){return r().entryNumber},onChange:ae=>b("entryNumber",ae),get disabled(){return!!t.editEntry},required:!0}),null),s(ue,S(Ct,{get label(){return e("common.date")},type:"date",get value(){return r().date},onChange:ae=>b("date",ae),required:!0}),null),s(Y,S(Ct,{get label(){return e("common.description")},get value(){return r().description},onChange:ae=>b("description",ae),get placeholder(){return e("journal.enterEntryDescription","Enter journal entry description")},required:!0}),oe),s(Y,S(Ct,{get label(){return e("journal.reference")},get value(){return r().reference},onChange:ae=>b("reference",ae),get placeholder(){return e("journal.enterReferenceNumber","Enter reference number")}}),oe),oe.style.setProperty("margin-top","2rem"),I.style.setProperty("display","flex"),I.style.setProperty("justify-content","space-between"),I.style.setProperty("align-items","center"),I.style.setProperty("margin-bottom","1rem"),_.style.setProperty("margin","0"),s(_,()=>e("journal.entryLines","Journal Entry Lines")),s(I,S(Ne,{type:"button",variant:"secondary",size:"sm",onClick:D,get children(){return e("journal.addLine","Add Line")}}),null),v.style.setProperty("margin-bottom","1rem"),v.style.setProperty("font-size","0.875rem"),v.style.setProperty("color","var(--text-muted)"),P.style.setProperty("display","grid"),P.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1fr"),P.style.setProperty("gap","1rem"),s(A,()=>e("journal.account")),s(he,()=>e("common.description")),s($,()=>e("journal.debit")),s(k,()=>e("journal.credit")),s(V,()=>e("common.actions")),s(oe,S(Ut,{get each(){return i()},children:ae=>(()=>{var M=Uh();return d(M,h),s(M,S(yr,{label:"",get value(){return ae.accountId||""},onChange:ne=>C(ae.tempId,"accountId",ne),get options(){return p()}}),null),s(M,S(Ct,{label:"",get value(){return ae.description||""},onChange:ne=>C(ae.tempId,"description",ne),get placeholder(){return e("journal.lineDescription","Line description")}}),null),s(M,S(Ct,{label:"",type:"number",get value(){return ae.debitAmount?.toString()||"0"},onChange:ne=>{C(ae.tempId,"debitAmount",parseFloat(ne)||0),parseFloat(ne)>0&&C(ae.tempId,"creditAmount",0)},placeholder:"0.00"}),null),s(M,S(Ct,{label:"",type:"number",get value(){return ae.creditAmount?.toString()||"0"},onChange:ne=>{C(ae.tempId,"creditAmount",parseFloat(ne)||0),parseFloat(ne)>0&&C(ae.tempId,"debitAmount",0)},placeholder:"0.00"}),null),s(M,S(Ne,{type:"button",variant:"outline",size:"sm",onClick:()=>x(ae.tempId),get disabled(){return i().length<=2},get children(){return e("common.remove","Remove")}}),null),M})()}),z),d(z,f),s(K,()=>e("journal.totalDebit","Total Debit"),de),s(K,()=>H(te.totalDebit),null),s(j,()=>e("journal.totalCredit","Total Credit"),Q),s(j,()=>H(te.totalCredit),null),J.style.setProperty("font-weight","600"),s(J,(()=>{var ae=fe(()=>!!te.isBalanced);return()=>ae()?` ${e("journal.balanced")}`:` ${e("journal.notBalanced","Not Balanced")}`})()),s(Y,(()=>{var ae=fe(()=>!!a());return()=>ae()&&(()=>{var M=Uh();return M.style.setProperty("padding","1rem"),M.style.setProperty("border-radius","var(--border-radius-sm)"),M.style.setProperty("margin-top","1rem"),M.style.setProperty("background","#f8d7da"),M.style.setProperty("color","#721c24"),M.style.setProperty("border","1px solid #f5c6cb"),s(M,a),M})()})(),ce),d(ce,u),s(ce,S(Ne,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(ce,S(Ne,{variant:"primary",type:"submit",get disabled(){return!te.isBalanced},get children(){return fe(()=>!!t.editEntry)()?e("journal.updateEntry","Update Entry"):e("journal.saveAsDraft","Save as Draft")}}),null),re(ae=>(ae=te.isBalanced?"#4caf50":"#f44336")!=null?J.style.setProperty("color",ae):J.style.removeProperty("color")),Y}})};var jE=q("<div><div></div><div></div><div></div><div>"),zE=q("<div><div></div><div></div><div></div><div></div><div>"),qE=q("<div><button></button><button> (<!>)</button><button> (<!>/<!>)"),jh=q("<div>"),HE=q("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><div><h4></h4><div></div></div><div>"),Il=q("<div><span></span><span>"),El=q("<div><strong>:</strong> "),WE=q("<div><div><div></div><div></div><div></div><div></div><div></div></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div></div></div><div><div><strong> Reconciliation Summary</strong></div><div><div><div><strong>Total Lines:</strong> </div><div><strong>Reconciled:</strong> </div><div><strong>Unreconciled:</strong> </div></div><div><div><strong>Bank Accounts:</strong> </div><div><strong>Bank Reconciled:</strong> "),GE=q("<div><div><div></div><div></div></div><div></div><div></div><div></div><div>"),KE=q("<div><span> "),YE=q("<span>(<!>)"),QE=q("<div><strong>Bank Pending:</strong> "),JE=q("<div><div>Reconciled Lines:"),XE=q("<div><div> Pending Bank Reconciliation:</div><div>Visit Bank Consolidations to reconcile these transactions"),ZE=q("<div><div><div><span></span><h3></h3></div><div><div><div></div><div>Total Lines</div></div><div><div></div><div>Reconciled</div></div><div><div></div><div>Pending"),ex=q("<div><h4> Reconciled Lines (<!>)"),tx=q("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div> Matched"),rx=q("<div> "),nx=q("<div><h4> Unreconciled Lines (<!>)"),ix=q("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div> Pending"),ox=q("<div>Bank account"),sx=q("<div><div> Reconciliation Tip</div><div>This entry has unreconciled bank account transactions. Visit <strong>Bank Consolidations</strong> to match these with bank statements.");const ax=t=>{const{t:e}=at(),[r,n]=ye("details"),[i,o]=ye(!1),a=Ke(()=>t.entryId?Pn.getJournalEntryById(t.entryId):null),c={"text-align":"center","margin-bottom":"2rem",position:"relative"},u={position:"absolute",top:"0",right:"0",display:"flex",gap:"0.5rem"},h={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","margin-bottom":"0.5rem"},f={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},p={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},b={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem",display:"inline-block"},C={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},D={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},x={"font-weight":"600",color:"var(--text-primary)"},E={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},T=y=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:y?"var(--primary-color)":"var(--text-muted)","border-bottom":y?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),H={display:"grid","grid-template-columns":"2fr 2.5fr 1fr 1fr 1.5fr",gap:"1rem",padding:"1rem 0","border-bottom":"1px solid var(--border-color)","align-items":"center"},te={...H,"font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","border-bottom":"2px solid var(--border-color)"},Y={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},ue={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},oe=y=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[y],I=y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(y),_=y=>new Date(y).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),v=y=>new Date(y).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),P=()=>{entry.status==="posted"&&!confirm(e("journal.confirmEditPosted","This entry has been posted. Editing will create a new draft copy. Continue?"))||o(!0)},w=()=>{if(a()&&confirm(e("journal.confirmPost","Are you sure you want to post this journal entry? This action cannot be undone.")))try{Pn.postJournalEntry(a().id)}catch(y){alert(y instanceof Error?y.message:e("forms.errorPostingEntry","An error occurred while posting the entry"))}},A=()=>{a()&&confirm(e("journal.confirmVoid","Are you sure you want to void this journal entry?"))&&Pn.voidJournalEntry(a().id)};return[S(dr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.entryDetails","Journal Entry Details")},get children(){return fe(()=>!a())()?(()=>{var y=jE(),he=y.firstChild,W=he.nextSibling,$=W.nextSibling,Z=$.nextSibling;return y.style.setProperty("text-align","center"),y.style.setProperty("padding","3rem"),y.style.setProperty("color","var(--text-muted)"),he.style.setProperty("font-size","1.5rem"),he.style.setProperty("margin-bottom","1rem"),W.style.setProperty("font-size","1.1rem"),W.style.setProperty("margin-bottom","0.5rem"),s(W,()=>e("journal.entryNotFound","Entry Not Found")),$.style.setProperty("font-size","0.875rem"),s($,()=>e("journal.entryNotFoundMessage","The journal entry you're looking for could not be found or may have been deleted.")),Z.style.setProperty("margin-top","2rem"),s(Z,S(Ne,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),y})():(()=>{const y=a(),he=oe(y.status),W=Math.abs(y.totalDebit-y.totalCredit)<.01;return[(()=>{var $=zE(),Z=$.firstChild,k=Z.nextSibling,F=k.nextSibling,V=F.nextSibling,z=V.nextSibling;return d($,c),s(Z,S(Ne,{variant:"outline",size:"sm",onClick:P,get title(){return e("journal.editEntryTooltip","Edit this journal entry")},get children(){return e("common.edit")}}),null),s(Z,(()=>{var me=fe(()=>y.status==="draft");return()=>me()&&S(Ne,{variant:"primary",size:"sm",onClick:w,disabled:!W,get title(){return W?e("journal.postEntryTooltip","Post this journal entry"):e("journal.entryMustBeBalanced","Entry must be balanced to post")},get children(){return e("journal.post","Post")}})})(),null),s(Z,(()=>{var me=fe(()=>y.status==="posted");return()=>me()&&S(Ne,{variant:"outline",size:"sm",onClick:A,style:{color:"#dc3545","border-color":"#dc3545"},get title(){return e("journal.voidEntryTooltip","Void this journal entry")},get children(){return e("entryBooks.void","Void")}})})(),null),d(k,h),s(k,()=>y.entryNumber),d(F,f),s(F,()=>y.description),d(V,p),s(V,()=>I(y.totalDebit)),s(z,()=>y.status),re(me=>{var K=u,de={...b,background:he.bg,color:he.color};return me.e=d(Z,K,me.e),me.t=d(z,de,me.t),me},{e:void 0,t:void 0}),$})(),(()=>{var $=qE(),Z=$.firstChild,k=Z.nextSibling,F=k.firstChild,V=F.nextSibling;V.nextSibling;var z=k.nextSibling,me=z.firstChild,K=me.nextSibling,de=K.nextSibling,N=de.nextSibling;return N.nextSibling,d($,E),Z.$$click=()=>n("details"),s(Z,()=>e("common.details")),k.$$click=()=>n("lines"),s(k,()=>e("journal.journalLines","Journal Lines"),F),s(k,()=>y.lines.length,V),z.$$click=()=>n("reconciliation"),s(z,()=>e("banking.reconciliation","Reconciliation"),me),s(z,()=>y.lines.filter(j=>j.reconciled).length,K),s(z,()=>y.lines.length,N),re(j=>{var Q=T(r()==="details"),J=T(r()==="lines"),ce=T(r()==="reconciliation");return j.e=d(Z,Q,j.e),j.t=d(k,J,j.t),j.a=d(z,ce,j.a),j},{e:void 0,t:void 0,a:void 0}),$})(),fe(()=>fe(()=>r()==="details")()&&(()=>{var $=HE(),Z=$.firstChild,k=Z.firstChild,F=k.nextSibling,V=Z.nextSibling,z=V.firstChild,me=z.nextSibling,K=V.nextSibling,de=K.firstChild,N=de.nextSibling,j=K.nextSibling,Q=j.firstChild,J=Q.nextSibling,ce=j.nextSibling,ae=ce.firstChild,M=ae.nextSibling,ne=ce.nextSibling,pe=ne.firstChild,ve=pe.nextSibling,ee=ne.nextSibling,ie=ee.firstChild,R=ie.nextSibling,L=ee.nextSibling,B=L.firstChild,ge=B.firstChild,le=ge.nextSibling,U=B.nextSibling;return s(k,()=>e("common.date")),s(F,()=>_(y.date)),s(z,()=>e("journal.reference")),s(me,()=>y.reference||e("common.notAvailable","N/A")),s(de,()=>e("journal.totalDebit")),s(N,()=>I(y.totalDebit)),s(Q,()=>e("journal.totalCredit")),s(J,()=>I(y.totalCredit)),s(ae,()=>e("journal.balanceStatus","Balance Status")),s(M,()=>W?`${e("journal.balanced")} `:`${e("journal.unbalanced","Unbalanced")} (${I(Math.abs(y.totalDebit-y.totalCredit))} ${e("journal.difference","difference")})`),s(pe,()=>e("journal.createdBy")),s(ve,()=>y.createdBy),s(ie,()=>e("journal.createdAt","Created At")),s(R,()=>v(y.createdAt)),s($,(()=>{var G=fe(()=>!!y.postedAt);return()=>G()&&(()=>{var Pe=Il(),_e=Pe.firstChild,se=_e.nextSibling;return s(_e,()=>e("journal.postedAt","Posted At")),s(se,()=>v(y.postedAt)),re(be=>{var X=C,we=D,ke=x;return be.e=d(Pe,X,be.e),be.t=d(_e,we,be.t),be.a=d(se,ke,be.a),be},{e:void 0,t:void 0,a:void 0}),Pe})()})(),L),L.style.setProperty("margin-top","2rem"),L.style.setProperty("padding-top","1rem"),L.style.setProperty("border-top","2px solid var(--border-color)"),B.style.setProperty("display","flex"),B.style.setProperty("justify-content","space-between"),B.style.setProperty("align-items","center"),B.style.setProperty("margin-bottom","1rem"),ge.style.setProperty("margin","0"),ge.style.setProperty("font-size","1rem"),s(ge,()=>e("journal.quickActions","Quick Actions")),le.style.setProperty("display","flex"),le.style.setProperty("gap","0.5rem"),s(le,S(Ne,{variant:"primary",size:"sm",onClick:P,get children(){return[" ",fe(()=>e("journal.editEntry"))]}}),null),s(le,(()=>{var G=fe(()=>y.status==="draft");return()=>G()&&S(Ne,{variant:"outline",size:"sm",onClick:w,disabled:!W,style:{"border-color":W?"#4caf50":"#f44336",color:W?"#4caf50":"#f44336"},get children(){return W?` ${e("journal.postEntry","Post Entry")}`:` ${e("journal.fixBalance","Fix Balance")}`}})})(),null),s(le,(()=>{var G=fe(()=>y.status==="posted");return()=>G()&&S(Ne,{variant:"outline",size:"sm",onClick:A,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return[" ",fe(()=>e("journal.voidEntry","Void Entry"))]}})})(),null),U.style.setProperty("padding","1rem"),U.style.setProperty("border-radius","var(--border-radius-sm)"),U.style.setProperty("font-size","0.875rem"),s(U,(()=>{var G=fe(()=>y.status==="draft");return()=>G()&&(()=>{var Pe=El(),_e=Pe.firstChild,se=_e.firstChild;return _e.nextSibling,s(_e,()=>e("journal.draftEntry","Draft Entry"),se),s(Pe,()=>e("journal.draftEntryDescription","This entry can be edited and posted."),null),s(Pe,()=>!W&&`  ${e("journal.entryMustBeBalancedBeforePosting","Entry must be balanced before posting.")}`,null),Pe})()})(),null),s(U,(()=>{var G=fe(()=>y.status==="posted");return()=>G()&&(()=>{var Pe=El(),_e=Pe.firstChild,se=_e.firstChild;return _e.nextSibling,s(_e,()=>e("journal.postedEntry","Posted Entry"),se),s(Pe,()=>e("journal.postedEntryDescription","This entry has been posted to the general ledger. Editing will create a new draft copy."),null),Pe})()})(),null),s(U,(()=>{var G=fe(()=>y.status==="void");return()=>G()&&(()=>{var Pe=El(),_e=Pe.firstChild,se=_e.firstChild;return _e.nextSibling,s(_e,()=>e("journal.voidEntry"),se),s(Pe,()=>e("journal.voidEntryDescription","This entry has been voided and cannot be modified."),null),Pe})()})(),null),re(G=>{var Pe=C,_e=D,se=x,be=C,X=D,we=x,ke=C,xe=D,Te=x,Oe=C,We=D,je=x,Ie=C,Ve=D,He={...x,color:W?"#4caf50":"#f44336"},qe=C,Ge=D,Ae=x,rt=C,et=D,ct=x,xt=y.status==="draft"?"#fff3cd":y.status==="posted"?"#d4edda":"#f8d7da";return G.e=d(Z,Pe,G.e),G.t=d(k,_e,G.t),G.a=d(F,se,G.a),G.o=d(V,be,G.o),G.i=d(z,X,G.i),G.n=d(me,we,G.n),G.s=d(K,ke,G.s),G.h=d(de,xe,G.h),G.r=d(N,Te,G.r),G.d=d(j,Oe,G.d),G.l=d(Q,We,G.l),G.u=d(J,je,G.u),G.c=d(ce,Ie,G.c),G.w=d(ae,Ve,G.w),G.m=d(M,He,G.m),G.f=d(ne,qe,G.f),G.y=d(pe,Ge,G.y),G.g=d(ve,Ae,G.g),G.p=d(ee,rt,G.p),G.b=d(ie,et,G.b),G.T=d(R,ct,G.T),xt!==G.A&&((G.A=xt)!=null?U.style.setProperty("background",xt):U.style.removeProperty("background")),G},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),$})()),fe(()=>fe(()=>r()==="lines")()&&(()=>{var $=WE(),Z=$.firstChild,k=Z.firstChild,F=k.nextSibling,V=F.nextSibling,z=V.nextSibling,me=z.nextSibling,K=Z.nextSibling,de=K.firstChild,N=de.firstChild,j=N.firstChild;N.nextSibling;var Q=de.nextSibling,J=Q.firstChild,ce=J.firstChild;J.nextSibling;var ae=Q.nextSibling,M=K.nextSibling,ne=M.firstChild,pe=ne.nextSibling,ve=pe.firstChild,ee=ve.firstChild,ie=ee.firstChild;ie.nextSibling;var R=ee.nextSibling,L=R.firstChild;L.nextSibling;var B=R.nextSibling,ge=B.firstChild;ge.nextSibling;var le=ve.nextSibling,U=le.firstChild,G=U.firstChild;G.nextSibling;var Pe=U.nextSibling,_e=Pe.firstChild;return _e.nextSibling,s(k,()=>e("journal.account")),s(F,()=>e("common.description")),s(V,()=>e("journal.debit")),s(z,()=>e("journal.credit")),s(me,()=>e("banking.reconciliation")),s($,S(Ut,{get each(){return y.lines},children:se=>(()=>{var be=GE(),X=be.firstChild,we=X.firstChild,ke=we.nextSibling,xe=X.nextSibling,Te=xe.nextSibling,Oe=Te.nextSibling,We=Oe.nextSibling;return we.style.setProperty("font-weight","500"),s(we,()=>se.accountName),ke.style.setProperty("font-size","0.75rem"),ke.style.setProperty("color","var(--text-muted)"),s(ke,()=>yt.getAccountById(se.accountId)?.accountNumber||se.accountId),xe.style.setProperty("font-size","0.875rem"),s(xe,()=>se.description||"-"),Te.style.setProperty("font-weight","600"),s(Te,(()=>{var je=fe(()=>se.debitAmount>0);return()=>je()?I(se.debitAmount):"-"})()),Oe.style.setProperty("font-weight","600"),s(Oe,(()=>{var je=fe(()=>se.creditAmount>0);return()=>je()?I(se.creditAmount):"-"})()),s(We,(()=>{var je=fe(()=>!!se.reconciled);return()=>je()?(()=>{var Ie=KE(),Ve=Ie.firstChild;return Ve.firstChild,Ie.style.setProperty("display","flex"),Ie.style.setProperty("align-items","center"),Ie.style.setProperty("gap","0.5rem"),Ie.style.setProperty("color","#4caf50"),Ie.style.setProperty("font-size","0.875rem"),Ve.style.setProperty("font-weight","600"),s(Ve,()=>e("banking.reconciled"),null),s(Ie,(()=>{var He=fe(()=>!!se.reconciledWith);return()=>He()&&(()=>{var qe=YE(),Ge=qe.firstChild,Ae=Ge.nextSibling;return Ae.nextSibling,qe.style.setProperty("font-size","0.75rem"),qe.style.setProperty("color","var(--text-muted)"),qe.style.setProperty("font-style","italic"),s(qe,()=>se.reconciledWith,Ae),qe})()})(),null),Ie})():(()=>{var Ie=jh();return Ie.style.setProperty("color","var(--text-muted)"),Ie.style.setProperty("font-size","0.875rem"),s(Ie,()=>e("banking.notReconciled","Not Reconciled")),Ie})()})()),re(je=>{var Ie=H,Ve=se.debitAmount>0?"#4caf50":"var(--text-muted)",He=se.creditAmount>0?"#f44336":"var(--text-muted)";return je.e=d(be,Ie,je.e),Ve!==je.t&&((je.t=Ve)!=null?Te.style.setProperty("color",Ve):Te.style.removeProperty("color")),He!==je.a&&((je.a=He)!=null?Oe.style.setProperty("color",He):Oe.style.removeProperty("color")),je},{e:void 0,t:void 0,a:void 0}),be})()}),K),d(K,Y),s(N,()=>e("journal.totalDebit"),j),s(de,()=>I(y.totalDebit),null),s(J,()=>e("journal.totalCredit"),ce),s(Q,()=>I(y.totalCredit),null),(W?"#4caf50":"#f44336")!=null?ae.style.setProperty("color",W?"#4caf50":"#f44336"):ae.style.removeProperty("color"),ae.style.setProperty("font-weight","600"),s(ae,()=>W?` ${e("journal.balanced")}`:` ${e("journal.notBalanced","Not Balanced")}`),M.style.setProperty("margin-top","1rem"),M.style.setProperty("padding","1rem"),M.style.setProperty("border-radius","var(--border-radius-sm)"),M.style.setProperty("font-size","0.875rem"),ne.style.setProperty("margin-bottom","0.5rem"),pe.style.setProperty("display","grid"),pe.style.setProperty("grid-template-columns","1fr 1fr"),pe.style.setProperty("gap","1rem"),ee.style.setProperty("margin-bottom","0.25rem"),s(ee,()=>y.lines.length,null),R.style.setProperty("margin-bottom","0.25rem"),R.style.setProperty("color","#4caf50"),s(R,()=>y.lines.filter(se=>se.reconciled).length,null),B.style.setProperty("color","#f44336"),s(B,()=>y.lines.filter(se=>!se.reconciled).length,null),U.style.setProperty("margin-bottom","0.25rem"),s(U,()=>y.lines.filter(se=>["1001","1002","1003"].includes(se.accountId)).length,null),Pe.style.setProperty("margin-bottom","0.25rem"),Pe.style.setProperty("color","#4caf50"),s(Pe,()=>y.lines.filter(se=>["1001","1002","1003"].includes(se.accountId)&&se.reconciled).length,null),s(le,(()=>{var se=fe(()=>y.lines.filter(be=>["1001","1002","1003"].includes(be.accountId)&&!be.reconciled).length>0);return()=>se()&&(()=>{var be=QE(),X=be.firstChild;return X.nextSibling,be.style.setProperty("color","#f44336"),s(be,()=>y.lines.filter(we=>["1001","1002","1003"].includes(we.accountId)&&!we.reconciled).length,null),be})()})(),null),s(M,(()=>{var se=fe(()=>y.lines.filter(be=>be.reconciled).length>0);return()=>se()&&(()=>{var be=JE(),X=be.firstChild;return be.style.setProperty("margin-top","0.75rem"),be.style.setProperty("padding-top","0.75rem"),be.style.setProperty("border-top","1px solid var(--border-color)"),X.style.setProperty("margin-bottom","0.5rem"),X.style.setProperty("font-weight","500"),s(be,()=>y.lines.filter(we=>we.reconciled).map(we=>(()=>{var ke=Il(),xe=ke.firstChild,Te=xe.nextSibling;return ke.style.setProperty("display","flex"),ke.style.setProperty("justify-content","space-between"),ke.style.setProperty("margin-bottom","0.25rem"),ke.style.setProperty("font-size","0.8rem"),s(xe,()=>we.accountName),Te.style.setProperty("color","var(--text-muted)"),s(Te,()=>we.reconciledWith?` ${we.reconciledWith}`:"Manual"),ke})()),null),be})()})(),null),s(M,(()=>{var se=fe(()=>y.lines.filter(be=>!be.reconciled&&["1001","1002","1003"].includes(be.accountId)).length>0);return()=>se()&&(()=>{var be=XE(),X=be.firstChild,we=X.nextSibling;return be.style.setProperty("margin-top","0.75rem"),be.style.setProperty("padding-top","0.75rem"),be.style.setProperty("border-top","1px solid var(--border-color)"),X.style.setProperty("margin-bottom","0.5rem"),X.style.setProperty("font-weight","500"),X.style.setProperty("color","#f44336"),s(be,()=>y.lines.filter(ke=>!ke.reconciled&&["1001","1002","1003"].includes(ke.accountId)).map(ke=>(()=>{var xe=Il(),Te=xe.firstChild,Oe=Te.nextSibling;return xe.style.setProperty("display","flex"),xe.style.setProperty("justify-content","space-between"),xe.style.setProperty("margin-bottom","0.25rem"),xe.style.setProperty("font-size","0.8rem"),xe.style.setProperty("color","#f44336"),s(Te,()=>ke.accountName),s(Oe,()=>I(ke.debitAmount||ke.creditAmount)),xe})()),we),we.style.setProperty("margin-top","0.5rem"),we.style.setProperty("font-size","0.75rem"),we.style.setProperty("color","var(--text-muted)"),we.style.setProperty("font-style","italic"),be})()})(),null),re(se=>{var be=te,X=y.lines.some(we=>we.reconciled)?"#e8f5e8":"#fff3cd";return se.e=d(Z,be,se.e),X!==se.t&&((se.t=X)!=null?M.style.setProperty("background",X):M.style.removeProperty("background")),se},{e:void 0,t:void 0}),$})()),fe(()=>fe(()=>r()==="reconciliation")()&&(()=>{var $=ZE(),Z=$.firstChild,k=Z.firstChild,F=k.firstChild,V=F.nextSibling,z=k.nextSibling,me=z.firstChild,K=me.firstChild,de=K.nextSibling,N=me.nextSibling,j=N.firstChild,Q=j.nextSibling,J=N.nextSibling,ce=J.firstChild,ae=ce.nextSibling;return Z.style.setProperty("margin-bottom","1.5rem"),Z.style.setProperty("padding","1rem"),Z.style.setProperty("border-radius","var(--border-radius)"),Z.style.setProperty("border","1px solid var(--border-color)"),k.style.setProperty("display","flex"),k.style.setProperty("align-items","center"),k.style.setProperty("gap","0.5rem"),k.style.setProperty("margin-bottom","1rem"),F.style.setProperty("font-size","1.5rem"),s(F,(()=>{var M=fe(()=>!!y.lines.every(ne=>ne.reconciled));return()=>M()?"":y.lines.some(ne=>ne.reconciled)?"":""})()),V.style.setProperty("margin","0"),V.style.setProperty("font-size","1.2rem"),s(V,(()=>{var M=fe(()=>!!y.lines.every(ne=>ne.reconciled));return()=>M()?"Fully Reconciled":y.lines.some(ne=>ne.reconciled)?"Partially Reconciled":"Unreconciled"})()),z.style.setProperty("display","grid"),z.style.setProperty("grid-template-columns","1fr 1fr 1fr"),z.style.setProperty("gap","1rem"),me.style.setProperty("text-align","center"),K.style.setProperty("font-size","2rem"),K.style.setProperty("font-weight","700"),K.style.setProperty("color","var(--primary-color)"),s(K,()=>y.lines.length),de.style.setProperty("font-size","0.875rem"),de.style.setProperty("color","var(--text-muted)"),N.style.setProperty("text-align","center"),j.style.setProperty("font-size","2rem"),j.style.setProperty("font-weight","700"),j.style.setProperty("color","#4caf50"),s(j,()=>y.lines.filter(M=>M.reconciled).length),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),J.style.setProperty("text-align","center"),ce.style.setProperty("font-size","2rem"),ce.style.setProperty("font-weight","700"),ce.style.setProperty("color","#f44336"),s(ce,()=>y.lines.filter(M=>!M.reconciled).length),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),s($,(()=>{var M=fe(()=>y.lines.filter(ne=>ne.reconciled).length>0);return()=>M()&&(()=>{var ne=ex(),pe=ne.firstChild,ve=pe.firstChild,ee=ve.nextSibling;return ee.nextSibling,ne.style.setProperty("margin-bottom","1.5rem"),pe.style.setProperty("margin","0 0 1rem 0"),pe.style.setProperty("font-size","1.1rem"),pe.style.setProperty("color","#4caf50"),pe.style.setProperty("display","flex"),pe.style.setProperty("align-items","center"),pe.style.setProperty("gap","0.5rem"),s(pe,()=>y.lines.filter(ie=>ie.reconciled).length,ee),s(ne,()=>y.lines.filter(ie=>ie.reconciled).map(ie=>(()=>{var R=tx(),L=R.firstChild,B=L.firstChild,ge=B.nextSibling,le=L.nextSibling,U=le.nextSibling,G=U.nextSibling,Pe=G.nextSibling,_e=Pe.firstChild;return R.style.setProperty("display","grid"),R.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),R.style.setProperty("gap","1rem"),R.style.setProperty("padding","0.75rem"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("background","#f0f9f0"),R.style.setProperty("border-radius","var(--border-radius-sm)"),R.style.setProperty("align-items","center"),R.style.setProperty("font-size","0.875rem"),B.style.setProperty("font-weight","500"),s(B,()=>ie.accountName),ge.style.setProperty("font-size","0.75rem"),ge.style.setProperty("color","var(--text-muted)"),s(ge,()=>yt.getAccountById(ie.accountId)?.accountNumber),le.style.setProperty("color","var(--text-muted)"),s(le,()=>ie.description||"No description"),U.style.setProperty("font-weight","600"),s(U,(()=>{var se=fe(()=>ie.debitAmount>0);return()=>se()?I(ie.debitAmount):"-"})()),G.style.setProperty("font-weight","600"),s(G,(()=>{var se=fe(()=>ie.creditAmount>0);return()=>se()?I(ie.creditAmount):"-"})()),Pe.style.setProperty("color","#4caf50"),_e.style.setProperty("font-weight","500"),s(Pe,(()=>{var se=fe(()=>!!ie.reconciledWith);return()=>se()&&(()=>{var be=rx();return be.firstChild,be.style.setProperty("font-size","0.75rem"),be.style.setProperty("font-style","italic"),s(be,()=>ie.reconciledWith,null),be})()})(),null),re(se=>{var be=ie.debitAmount>0?"#4caf50":"var(--text-muted)",X=ie.creditAmount>0?"#f44336":"var(--text-muted)";return be!==se.e&&((se.e=be)!=null?U.style.setProperty("color",be):U.style.removeProperty("color")),X!==se.t&&((se.t=X)!=null?G.style.setProperty("color",X):G.style.removeProperty("color")),se},{e:void 0,t:void 0}),R})()),null),ne})()})(),null),s($,(()=>{var M=fe(()=>y.lines.filter(ne=>!ne.reconciled).length>0);return()=>M()&&(()=>{var ne=nx(),pe=ne.firstChild,ve=pe.firstChild,ee=ve.nextSibling;return ee.nextSibling,ne.style.setProperty("margin-bottom","1.5rem"),pe.style.setProperty("margin","0 0 1rem 0"),pe.style.setProperty("font-size","1.1rem"),pe.style.setProperty("color","#f44336"),pe.style.setProperty("display","flex"),pe.style.setProperty("align-items","center"),pe.style.setProperty("gap","0.5rem"),s(pe,()=>y.lines.filter(ie=>!ie.reconciled).length,ee),s(ne,()=>y.lines.filter(ie=>!ie.reconciled).map(ie=>(()=>{var R=ix(),L=R.firstChild,B=L.firstChild,ge=B.nextSibling,le=L.nextSibling,U=le.nextSibling,G=U.nextSibling,Pe=G.nextSibling,_e=Pe.firstChild;return R.style.setProperty("display","grid"),R.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),R.style.setProperty("gap","1rem"),R.style.setProperty("padding","0.75rem"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("background","#fff9f0"),R.style.setProperty("border-radius","var(--border-radius-sm)"),R.style.setProperty("align-items","center"),R.style.setProperty("font-size","0.875rem"),R.style.setProperty("border","1px solid #ffe0b3"),B.style.setProperty("font-weight","500"),s(B,()=>ie.accountName),ge.style.setProperty("font-size","0.75rem"),ge.style.setProperty("color","var(--text-muted)"),s(ge,()=>yt.getAccountById(ie.accountId)?.accountNumber),le.style.setProperty("color","var(--text-muted)"),s(le,()=>ie.description||"No description"),U.style.setProperty("font-weight","600"),s(U,(()=>{var se=fe(()=>ie.debitAmount>0);return()=>se()?I(ie.debitAmount):"-"})()),G.style.setProperty("font-weight","600"),s(G,(()=>{var se=fe(()=>ie.creditAmount>0);return()=>se()?I(ie.creditAmount):"-"})()),Pe.style.setProperty("color","#f44336"),_e.style.setProperty("font-weight","500"),s(Pe,(()=>{var se=fe(()=>!!["1001","1002","1003"].includes(ie.accountId));return()=>se()&&(()=>{var be=ox();return be.style.setProperty("font-size","0.75rem"),be.style.setProperty("font-style","italic"),be})()})(),null),re(se=>{var be=ie.debitAmount>0?"#4caf50":"var(--text-muted)",X=ie.creditAmount>0?"#f44336":"var(--text-muted)";return be!==se.e&&((se.e=be)!=null?U.style.setProperty("color",be):U.style.removeProperty("color")),X!==se.t&&((se.t=X)!=null?G.style.setProperty("color",X):G.style.removeProperty("color")),se},{e:void 0,t:void 0}),R})()),null),s(ne,(()=>{var ie=fe(()=>y.lines.filter(R=>!R.reconciled&&["1001","1002","1003"].includes(R.accountId)).length>0);return()=>ie()&&(()=>{var R=sx(),L=R.firstChild,B=L.nextSibling;return R.style.setProperty("padding","0.75rem"),R.style.setProperty("background","#ffebee"),R.style.setProperty("border-radius","var(--border-radius-sm)"),R.style.setProperty("margin-top","1rem"),R.style.setProperty("border","1px solid #ffcdd2"),L.style.setProperty("font-weight","500"),L.style.setProperty("margin-bottom","0.5rem"),L.style.setProperty("color","#f44336"),B.style.setProperty("font-size","0.875rem"),B.style.setProperty("color","var(--text-muted)"),R})()})(),null),ne})()})(),null),re(M=>(M=y.lines.every(ne=>ne.reconciled)?"#e8f5e8":y.lines.some(ne=>ne.reconciled)?"#fff3cd":"#ffebee")!=null?Z.style.setProperty("background",M):Z.style.removeProperty("background")),$})()),(()=>{var $=jh();return d($,ue),s($,S(Ne,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s($,S(Ne,{variant:"primary",onClick:P,get children(){return e("journal.editEntry")}}),null),s($,(()=>{var Z=fe(()=>y.status==="draft");return()=>Z()&&S(Ne,{variant:"outline",onClick:w,disabled:!W,style:{"border-color":"#4caf50",color:W?"#4caf50":"var(--text-muted)"},get children(){return W?e("journal.postEntry","Post Entry"):e("journal.entryNotBalanced","Entry Not Balanced")}})})(),null),s($,(()=>{var Z=fe(()=>y.status==="posted");return()=>Z()&&S(Ne,{variant:"outline",onClick:A,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return e("journal.voidEntry","Void Entry")}})})(),null),$})()]})()}}),fe(()=>fe(()=>!!a())()&&S(jy,{get isOpen(){return i()},onClose:()=>{o(!1)},get editEntry(){return a()}}))]};At(["click"]);var lx=q("<div><div><h2></h2><p></p></div><div>"),pn=q("<div>"),cx=q("<div> <!>  <!> "),ux=q("<div><div><label></label></div><div><label></label></div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label></div><div>"),dx=q("<div><span>:</span><span> "),Fs=q("<span>: "),hx=q("<div><br>");const mx=()=>{const{t}=at(),[e,r]=ye(!1),[n,i]=ye(null),[o,a]=ye(!1),[c,u]=ye(null),[h,f]=ye("all"),[p,b]=ye("all"),[C,D]=ye(""),[x,E]=ye(""),[T,H]=ye("date"),[te,Y]=ye("desc"),ue={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},oe={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)","flex-wrap":"wrap"},I={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem"},_={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(400px, 1fr))",gap:"1.5rem"},v=()=>[{value:"all",label:t("journal.allEntries","All Entries")},{value:"draft",label:t("journal.draft")},{value:"posted",label:t("journal.posted")},{value:"void",label:t("entryBooks.void","Void")}],P=()=>[{value:"all",label:t("accounts.allAccounts","All Accounts")},...yt.accounts.map(V=>({value:V.id,label:`${V.accountNumber} - ${V.name}`}))],w=()=>[{value:"date",label:t("common.date")},{value:"entryNumber",label:t("journal.entryNumber")},{value:"amount",label:t("common.amount")}],A=()=>{let V=Pn.journalEntries;return h()!=="all"&&(V=V.filter(z=>z.status===h())),p()!=="all"&&(V=V.filter(z=>z.lines.some(me=>me.accountId===p()))),C()&&(V=V.filter(z=>z.date>=C())),x()&&(V=V.filter(z=>z.date<=x())),V=[...V].sort((z,me)=>{let K=0;switch(T()){case"date":K=new Date(z.date).getTime()-new Date(me.date).getTime();break;case"entryNumber":K=z.entryNumber.localeCompare(me.entryNumber);break;case"amount":K=z.totalDebit-me.totalDebit;break}return te()==="asc"?K:-K}),V},y=()=>{const V=Pn.journalEntries,z=V.filter(Q=>Q.status==="draft"),me=V.filter(Q=>Q.status==="posted"),K=V.filter(Q=>Q.status==="void"),de=me.reduce((Q,J)=>Q+J.totalDebit,0),N=me.reduce((Q,J)=>Q+J.totalCredit,0),j=V.filter(Q=>Q.lines.some(J=>["1001","1002","1003"].includes(J.accountId)&&!J.reconciled)).length;return{totalEntries:V.length,draftEntries:z.length,postedEntries:me.length,voidEntries:K.length,totalDebit:de,totalCredit:N,unreconciledEntries:j}},he=V=>{u(V.id),a(!0)},W=()=>{i(null),r(!0)},$=()=>{r(!1),i(null)},Z=V=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(V),k=y(),F=A();return S(jr,{get title(){return t("entryBooks.title")},get children(){return[(()=>{var V=lx(),z=V.firstChild,me=z.firstChild,K=me.nextSibling,de=z.nextSibling;return d(V,ue),me.style.setProperty("margin","0 0 0.5rem 0"),me.style.setProperty("font-size","1.5rem"),s(me,()=>t("journal.title")),K.style.setProperty("margin","0"),K.style.setProperty("color","var(--text-muted)"),s(K,()=>t("entryBooks.subtitle","Manage accounting entries and general ledger records")),de.style.setProperty("display","flex"),de.style.setProperty("gap","1rem"),s(de,S(Ne,{variant:"secondary",onClick:()=>window.location.href="/bank-consolidations",get children(){return t("entryBooks.viewReconciliation","View Reconciliation")}}),null),s(de,S(Ne,{variant:"primary",onClick:W,get children(){return t("journal.addEntry","Add Journal Entry")}}),null),V})(),(()=>{var V=pn();return d(V,I),s(V,S(Xe,{get title(){return t("entryBooks.totalEntries","Total Entries")},get subtitle(){return t("entryBooks.allJournalEntries","All journal entries")},get children(){return[(()=>{var z=pn();return z.style.setProperty("font-size","1.5rem"),z.style.setProperty("font-weight","600"),z.style.setProperty("color","var(--primary-color)"),z.style.setProperty("margin-bottom","0.5rem"),s(z,()=>k.totalEntries),z})(),(()=>{var z=cx(),me=z.firstChild,K=me.nextSibling,de=K.nextSibling,N=de.nextSibling;return N.nextSibling,z.style.setProperty("font-size","0.875rem"),z.style.setProperty("color","var(--text-muted)"),s(z,()=>k.postedEntries,me),s(z,()=>t("journal.posted").toLowerCase(),K),s(z,()=>k.draftEntries,N),s(z,()=>t("journal.draft").toLowerCase(),null),s(z,(()=>{var j=fe(()=>k.voidEntries>0);return()=>j()&&`  ${k.voidEntries} ${t("entryBooks.void","void").toLowerCase()}`})(),null),z})()]}}),null),s(V,S(Xe,{get title(){return t("journal.totalDebits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var z=pn();return z.style.setProperty("font-size","1.5rem"),z.style.setProperty("font-weight","600"),z.style.setProperty("color","#4caf50"),z.style.setProperty("margin-bottom","0.5rem"),s(z,()=>Z(k.totalDebit)),z})(),(()=>{var z=pn();return z.style.setProperty("font-size","0.875rem"),z.style.setProperty("color","var(--text-muted)"),s(z,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",k.postedEntries.toString())),z})()]}}),null),s(V,S(Xe,{get title(){return t("journal.totalCredits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var z=pn();return z.style.setProperty("font-size","1.5rem"),z.style.setProperty("font-weight","600"),z.style.setProperty("color","#f44336"),z.style.setProperty("margin-bottom","0.5rem"),s(z,()=>Z(k.totalCredit)),z})(),(()=>{var z=pn();return z.style.setProperty("font-size","0.875rem"),z.style.setProperty("color","var(--text-muted)"),s(z,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",k.postedEntries.toString())),z})()]}}),null),s(V,S(Xe,{get title(){return t("banking.unreconciled","Unreconciled")},get subtitle(){return t("banking.title")},get children(){return[(()=>{var z=pn();return z.style.setProperty("font-size","1.5rem"),z.style.setProperty("font-weight","600"),z.style.setProperty("margin-bottom","0.5rem"),s(z,()=>k.unreconciledEntries),re(me=>(me=k.unreconciledEntries>0?"#ff9800":"#4caf50")!=null?z.style.setProperty("color",me):z.style.removeProperty("color")),z})(),(()=>{var z=pn();return z.style.setProperty("font-size","0.875rem"),z.style.setProperty("color","var(--text-muted)"),s(z,(()=>{var me=fe(()=>k.unreconciledEntries>0);return()=>me()?t("entryBooks.needBankReconciliation","Need bank reconciliation"):t("entryBooks.allReconciled","All reconciled")})()),z})()]}}),null),V})(),(()=>{var V=ux(),z=V.firstChild,me=z.firstChild,K=z.nextSibling,de=K.firstChild,N=K.nextSibling,j=N.firstChild,Q=N.nextSibling,J=Q.firstChild,ce=J.nextSibling,ae=Q.nextSibling,M=ae.firstChild,ne=M.nextSibling,pe=ae.nextSibling,ve=pe.firstChild,ee=pe.nextSibling;return d(V,oe),z.style.setProperty("min-width","150px"),me.style.setProperty("display","block"),me.style.setProperty("margin-bottom","0.5rem"),me.style.setProperty("font-weight","500"),me.style.setProperty("font-size","0.875rem"),s(me,()=>t("common.status")),s(z,S(yr,{label:"",get value(){return h()},onChange:f,get options(){return v()}}),null),K.style.setProperty("min-width","200px"),de.style.setProperty("display","block"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),de.style.setProperty("font-size","0.875rem"),s(de,()=>t("journal.account")),s(K,S(yr,{label:"",get value(){return p()},onChange:b,get options(){return P()}}),null),N.style.setProperty("min-width","120px"),j.style.setProperty("display","block"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("font-weight","500"),j.style.setProperty("font-size","0.875rem"),s(j,()=>t("entryBooks.sortBy","Sort By")),s(N,S(yr,{label:"",get value(){return T()},onChange:H,get options(){return w()}}),null),Q.style.setProperty("min-width","130px"),J.style.setProperty("display","block"),J.style.setProperty("margin-bottom","0.5rem"),J.style.setProperty("font-weight","500"),J.style.setProperty("font-size","0.875rem"),s(J,()=>t("entryBooks.fromDate","From Date")),ce.addEventListener("change",ie=>D(ie.target.value)),ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("border","1px solid var(--border-color)"),ce.style.setProperty("border-radius","var(--border-radius-sm)"),ce.style.setProperty("font-family","inherit"),ce.style.setProperty("width","100%"),ae.style.setProperty("min-width","130px"),M.style.setProperty("display","block"),M.style.setProperty("margin-bottom","0.5rem"),M.style.setProperty("font-weight","500"),M.style.setProperty("font-size","0.875rem"),s(M,()=>t("entryBooks.toDate","To Date")),ne.addEventListener("change",ie=>E(ie.target.value)),ne.style.setProperty("padding","0.75rem"),ne.style.setProperty("border","1px solid var(--border-color)"),ne.style.setProperty("border-radius","var(--border-radius-sm)"),ne.style.setProperty("font-family","inherit"),ne.style.setProperty("width","100%"),pe.style.setProperty("min-width","100px"),ve.style.setProperty("display","block"),ve.style.setProperty("margin-bottom","0.5rem"),ve.style.setProperty("font-weight","500"),ve.style.setProperty("font-size","0.875rem"),s(ve,()=>t("entryBooks.order","Order")),s(pe,S(yr,{label:"",get value(){return te()},onChange:Y,get options(){return[{value:"desc",label:t("entryBooks.newest","Newest")},{value:"asc",label:t("entryBooks.oldest","Oldest")}]}}),null),ee.style.setProperty("display","flex"),ee.style.setProperty("align-items","end"),ee.style.setProperty("gap","0.5rem"),s(ee,S(Ne,{variant:"outline",size:"sm",onClick:()=>{f("all"),b("all"),D(""),E(""),H("date"),Y("desc")},get children(){return t("entryBooks.resetFilters","Reset Filters")}})),re(()=>ce.value=C()),re(()=>ne.value=x()),V})(),fe(()=>fe(()=>!!(h()!=="all"||p()!=="all"||C()||x()))()&&(()=>{var V=dx(),z=V.firstChild,me=z.firstChild,K=z.nextSibling,de=K.firstChild;return V.style.setProperty("display","flex"),V.style.setProperty("gap","0.5rem"),V.style.setProperty("align-items","center"),V.style.setProperty("margin-bottom","1rem"),V.style.setProperty("padding","0.75rem"),V.style.setProperty("background","var(--surface-color)"),V.style.setProperty("border-radius","var(--border-radius-sm)"),V.style.setProperty("border","1px solid var(--border-color)"),z.style.setProperty("font-size","0.875rem"),z.style.setProperty("font-weight","500"),s(z,()=>t("entryBooks.activeFilters","Active filters"),me),s(V,(()=>{var N=fe(()=>h()!=="all");return()=>N()&&(()=>{var j=Fs(),Q=j.firstChild;return j.style.setProperty("padding","0.25rem 0.5rem"),j.style.setProperty("background","var(--primary-color)"),j.style.setProperty("color","white"),j.style.setProperty("border-radius","12px"),j.style.setProperty("font-size","0.75rem"),s(j,()=>t("common.status"),Q),s(j,h,null),j})()})(),K),s(V,(()=>{var N=fe(()=>p()!=="all");return()=>N()&&(()=>{var j=Fs(),Q=j.firstChild;return j.style.setProperty("padding","0.25rem 0.5rem"),j.style.setProperty("background","var(--primary-color)"),j.style.setProperty("color","white"),j.style.setProperty("border-radius","12px"),j.style.setProperty("font-size","0.75rem"),s(j,()=>t("journal.account"),Q),s(j,()=>yt.getAccountById(p())?.name||t("common.unknown","Unknown"),null),j})()})(),K),s(V,(()=>{var N=fe(()=>!!C());return()=>N()&&(()=>{var j=Fs(),Q=j.firstChild;return j.style.setProperty("padding","0.25rem 0.5rem"),j.style.setProperty("background","var(--primary-color)"),j.style.setProperty("color","white"),j.style.setProperty("border-radius","12px"),j.style.setProperty("font-size","0.75rem"),s(j,()=>t("entryBooks.from","From"),Q),s(j,C,null),j})()})(),K),s(V,(()=>{var N=fe(()=>!!x());return()=>N()&&(()=>{var j=Fs(),Q=j.firstChild;return j.style.setProperty("padding","0.25rem 0.5rem"),j.style.setProperty("background","var(--primary-color)"),j.style.setProperty("color","white"),j.style.setProperty("border-radius","12px"),j.style.setProperty("font-size","0.75rem"),s(j,()=>t("entryBooks.to","To"),Q),s(j,x,null),j})()})(),K),K.style.setProperty("margin-left","auto"),K.style.setProperty("font-size","0.875rem"),K.style.setProperty("color","var(--text-muted)"),s(K,()=>F.length,de),s(K,()=>t("entryBooks.entriesFound","{count} entries found").replace("{count}",F.length.toString()),null),V})()),fe(()=>fe(()=>F.length===0)()?S(Xe,{get title(){return t("entryBooks.noJournalEntries","No Journal Entries")},get subtitle(){return t("entryBooks.startByCreating","Start by creating your first entry")},get children(){var V=hx(),z=V.firstChild;return V.style.setProperty("text-align","center"),V.style.setProperty("color","var(--text-muted)"),V.style.setProperty("padding","2rem"),s(V,()=>t("entryBooks.noEntriesMatch","No journal entries match your current filters."),z),s(V,S(Ne,{variant:"primary",style:{"margin-top":"1rem"},onClick:W,get children(){return t("entryBooks.createFirstEntry","Create First Entry")}}),null),V}}):(()=>{var V=pn();return d(V,_),s(V,S(Ut,{each:F,children:z=>S(BE,{entry:z,onViewDetails:he})})),V})()),S(jy,{get isOpen(){return e()},onClose:$,get editEntry(){return n()}}),S(ax,{get isOpen(){return o()},onClose:()=>{a(!1),u(null)},get entryId(){return c()}})]}})};var zh=q("<div>"),fx=q("<div>$23,450"),yx=q("<div>$87,230"),gx=q("<div>$5,670"),px=q("<div><div><div><div>INV-2024-001</div><div>Acme Corporation</div></div><div>$5,250.00</div><div></div></div><div><div><div>INV-2024-002</div><div>Tech Solutions Inc.</div></div><div>$3,750.00</div><div></div></div><div><div><div>INV-2024-003</div><div>Global Services Ltd.</div></div><div>$8,900.00</div><div></div></div><div><div><div>INV-2024-004</div><div>StartUp Co.</div></div><div>$2,100.00</div><div>");const vx=()=>{const{t}=at(),e={display:"flex","flex-direction":"column",gap:"1rem"},r={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},n={flex:"1"},i={"font-weight":"600","margin-bottom":"0.25rem"},o={color:"var(--text-muted)","font-size":"0.875rem"},a={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},c=h=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:h==="paid"?"#d4edda":h==="pending"?"#fff3cd":"#f8d7da",color:h==="paid"?"#155724":h==="pending"?"#856404":"#721c24"}),u={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"};return S(jr,{get title(){return t("invoices.title","Invoices")},get children(){return[(()=>{var h=zh();return h.style.setProperty("margin-bottom","2rem"),s(h,S(Ne,{variant:"primary",get children(){return t("invoices.createNew","Create New Invoice")}})),h})(),(()=>{var h=zh();return d(h,u),s(h,S(Xe,{get title(){return t("invoices.totalOutstanding","Total Outstanding")},get subtitle(){return t("invoices.unpaidInvoices","Unpaid invoices")},get children(){var f=fx();return f.style.setProperty("font-size","1.5rem"),f.style.setProperty("font-weight","600"),f.style.setProperty("color","var(--primary-color)"),f}}),null),s(h,S(Xe,{get title(){return t("invoices.thisMonth","This Month")},get subtitle(){return t("invoices.revenueCollected","Revenue collected")},get children(){var f=yx();return f.style.setProperty("font-size","1.5rem"),f.style.setProperty("font-weight","600"),f.style.setProperty("color","var(--primary-color)"),f}}),null),s(h,S(Xe,{get title(){return t("invoices.overdue","Overdue")},get subtitle(){return t("invoices.pastDueInvoices","Past due invoices")},get children(){var f=gx();return f.style.setProperty("font-size","1.5rem"),f.style.setProperty("font-weight","600"),f.style.setProperty("color","var(--primary-color)"),f}}),null),h})(),S(Xe,{get title(){return t("invoices.recentInvoices","Recent Invoices")},get subtitle(){return t("invoices.latestBillingActivity","Latest billing activity")},get children(){var h=px(),f=h.firstChild,p=f.firstChild,b=p.firstChild,C=b.nextSibling,D=p.nextSibling,x=D.nextSibling,E=f.nextSibling,T=E.firstChild,H=T.firstChild,te=H.nextSibling,Y=T.nextSibling,ue=Y.nextSibling,oe=E.nextSibling,I=oe.firstChild,_=I.firstChild,v=_.nextSibling,P=I.nextSibling,w=P.nextSibling,A=oe.nextSibling,y=A.firstChild,he=y.firstChild,W=he.nextSibling,$=y.nextSibling,Z=$.nextSibling;return d(h,e),s(x,()=>t("invoices.paid","Paid")),s(ue,()=>t("invoices.pending","Pending")),s(w,()=>t("invoices.overdue","Overdue")),s(Z,()=>t("invoices.paid","Paid")),re(k=>{var F=r,V=n,z=i,me=o,K=a,de=c("paid"),N=r,j=n,Q=i,J=o,ce=a,ae=c("pending"),M=r,ne=n,pe=i,ve=o,ee=a,ie=c("overdue"),R=r,L=n,B=i,ge=o,le=a,U=c("paid");return k.e=d(f,F,k.e),k.t=d(p,V,k.t),k.a=d(b,z,k.a),k.o=d(C,me,k.o),k.i=d(D,K,k.i),k.n=d(x,de,k.n),k.s=d(E,N,k.s),k.h=d(T,j,k.h),k.r=d(H,Q,k.r),k.d=d(te,J,k.d),k.l=d(Y,ce,k.l),k.u=d(ue,ae,k.u),k.c=d(oe,M,k.c),k.w=d(I,ne,k.w),k.m=d(_,pe,k.m),k.f=d(v,ve,k.f),k.y=d(P,ee,k.y),k.g=d(w,ie,k.g),k.p=d(A,R,k.p),k.b=d(y,L,k.b),k.T=d(he,B,k.T),k.A=d(W,ge,k.A),k.O=d($,le,k.O),k.I=d(Z,U,k.I),k},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0}),h}})]}})};var bx=q("<div><main>");const _x=t=>[S(mw,{}),fe(()=>t.children)],Sx=()=>S(GP,{get children(){var t=bx(),e=t.firstChild;return s(e,S(up,{root:_x,get children(){return[S(Zr,{path:"/",component:Rw}),S(Zr,{path:"/accounts",component:()=>S(yn,{permission:"AccountAccess",featureName:"Accounts",get children(){return S(bC,{})}})}),S(Zr,{path:"/accounts/:id",component:()=>S(yn,{permission:"AccountAccess",featureName:"Account Details",get children(){return S(IC,{})}})}),S(Zr,{path:"/entry-books",component:()=>S(yn,{permission:"JournalAccess",featureName:"Entry Books",get children(){return S(mx,{})}})}),S(Zr,{path:"/employees",component:()=>S(yn,{permission:"EmployeeAccess",featureName:"Employee Management",get children(){return S(nE,{})}})}),S(Zr,{path:"/bank-consolidations",component:()=>S(yn,{permission:"BankingAccess",featureName:"Bank Consolidations",get children(){return S(kE,{})}})}),S(Zr,{path:"/balance-sheet",component:()=>S(yn,{permission:"AccountAccess",featureName:"Balance Sheet",get children(){return S(RC,{})}})}),S(Zr,{path:"/invoices",component:()=>S(yn,{permission:"JournalAccess",featureName:"Invoices",get children(){return S(vx,{})}})}),S(Zr,{path:"/inventory",component:()=>S(yn,{permission:"InventoryAccess",featureName:"Inventory Management",get children(){return S(KI,{})}})}),S(Zr,{path:"/products",component:()=>S(yn,{permission:"InventoryAccess",featureName:"Product Management",get children(){return S(Fy,{})}})})]}})),s(t,(()=>{var r=fe(()=>!1);return()=>r()&&S(Aw,{})})(),null),t}}),Px=document.getElementById("root");Ag(()=>S(Sx,{}),Px);
