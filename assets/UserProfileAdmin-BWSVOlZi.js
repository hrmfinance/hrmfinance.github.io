import{u as Be,c as h,s as O,o as xe,e as _,f as V,g as U,h as Ie,a as y,S as L,t as v,j as Y,i as l,F as B,b as A,k as M,B as Z,L as Le,l as W,m as X,q as ee,n as se,p as te,d as ke}from"./index-BwmeK1hP.js";var re=v("<div>"),Ce=v("<div><div><div><strong>Display Name:</strong> </div><div><strong>UID:</strong> </div></div><div><strong>Created:</strong> "),we=v("<div><h3>Store Access</h3><div></div><div>No store access granted"),Ne=v("<div><h3>Business Access</h3><div><label>Primary Business ID</label><select><option value=all></option></select></div><div><label>Additional Business Access</label><div></div><div>User can access data from all selected businesses"),Ee=v("<div><h3>Permissions</h3><div>"),Oe=v("<div><h3>HBL Status Location Permissions</h3><div>Control which status locations this user can update HBLs to</div><div></div><div> locations enabled"),Ue=v('<div><div><input type=text placeholder="Search users..."></div><div>'),Me=v("<div>‚ö†Ô∏è You need administrator privileges to access this page."),Te=v("<div>Loading users..."),He=v("<div><div></div><div></div><div> stores"),Re=v("<div>Select a user to view and edit their profile"),T=v("<div><input type=checkbox><label>"),Fe=v("<option>"),De=v("<div><input type=checkbox><div><div></div><div>");const qe=()=>{const{t:ie}=Be(),[H,R]=h([]),[s,S]=h(null),[ne,F]=h(!1),[D,z]=h(!1),[q,oe]=h(""),[k,I]=h(null),[J,j]=h([]),[ae,G]=h([]),le=async()=>{try{const t=W(X,"stores"),o=ee(t,se("name")),f=await te(o),m=[];f.forEach(i=>{const n=i.data();n.isActive!==!1&&m.push({id:i.id,name:n.name})});const e=[{id:"YY_8802",name:"CENTER"},{id:"YY_8803",name:"BISSONNET"},{id:"YY_8804",name:"IRVIN"},{id:"YY_8805",name:"KATTY"},{id:"YY_8816",name:"YABA GLOBAL"},{id:"YY_8818",name:"YABASURAUSTIN"},{id:"YY_8847",name:"YABAOFICINA AZ"},{id:"YY_3251",name:"YABA FASHION"},{id:"YY_32",name:"YABA MESQUITE"},{id:"YY_76",name:"YABA DALLAS"},{id:"YY_79",name:"YABA 79"},{id:"YY_2376",name:"YABA SAN ANTONIO"},{id:"YY_8635",name:"YABA 8635"},{id:"YY_8665",name:"YABA 8665"},{id:"YY_8901",name:"YABA 8901"},{id:"YY_3303",name:"YABA MIAMI"},{id:"YY_3329",name:"YABA MIAMI 29"},{id:"SS_42",name:"STEPHANIE SOLUTION"}];for(const i of e)m.find(n=>n.id===i.id)||m.push(i);G(m)}catch(t){console.error("Error loading stores from Firestore:",t),G([{id:"YY_8802",name:"CENTER"},{id:"YY_8803",name:"BISSONNET"},{id:"YY_8804",name:"IRVIN"},{id:"YY_8805",name:"KATTY"},{id:"YY_8816",name:"YABA GLOBAL"},{id:"YY_8818",name:"YABASURAUSTIN"},{id:"YY_8847",name:"YABAOFICINA AZ"},{id:"YY_3251",name:"YABA FASHION"},{id:"YY_32",name:"YABA MESQUITE"},{id:"YY_76",name:"YABA DALLAS"},{id:"YY_79",name:"YABA 79"},{id:"YY_2376",name:"YABA SAN ANTONIO"},{id:"YY_8635",name:"YABA 8635"},{id:"YY_8665",name:"YABA 8665"},{id:"YY_8901",name:"YABA 8901"},{id:"YY_3303",name:"YABA MIAMI"},{id:"YY_3329",name:"YABA MIAMI 29"},{id:"SS_42",name:"STEPHANIE SOLUTION"}])}},ce=[{key:"AccountAccess",label:"Account Access",description:"Access to accounting features"},{key:"BankingAccess",label:"Banking Access",description:"Access to banking operations"},{key:"InventoryAccess",label:"Inventory Access",description:"Access to inventory management"},{key:"EmployeeAccess",label:"Employee Access",description:"Access to employee management and timesheets"},{key:"JournalAccess",label:"Journal Access",description:"Access to journal entries"},{key:"invoiceAccess",label:"Invoice Access",description:"Access to Invoices"},{key:"RemittanceAccess",label:"Remittance Access",description:"Access to remittances management"},{key:"HBLAccess",label:"HBL Access",description:"Access to HBL management"},{key:"PassportAccess",label:"Passport Access",description:"Access to passport applications"},{key:"inventoryDownsection",label:"Inventory Downsection",description:"Access to inventory downsection"},{key:"onlyRead",label:"Read Only",description:"Limited to read-only access"},{key:"PurchaseRequestAccess",label:"Purchase Request Access",description:"Access to Purchase management"},{key:"read_write",label:"Read/Write",description:"Full read and write permissions"},{key:"AdminPassportAccess",label:"Passport Admin Access",description:"Access to passport applications"},{key:"HBLAccessManagement",label:"HBL Managements Access",description:"Access to HBL management"},{key:"HBLScannerAccess",label:"HBL Scanner Only",description:"Scanner access without full HBL privileges"},{key:"NotaryAccess",label:"Notary Access",description:"Access to notary customer management"},{key:"offersManagementAccess",label:"YABA Offers Management",description:"Access to manage YABA shipping offers configurations"},{key:"isAdmin",label:"Administrator",description:"Full system administration rights"}];let K={businessId:"YB100423253156428",stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_2376:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1,YY_3303:!1,YY_3329:!1,SS_42:!1},statusLocationPermissions:Object.fromEntries(O.map(t=>[t.id,!1])),permissions:{AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,EmployeeAccess:!1,JournalAccess:!1,invoiceAccess:!1,PurchaseRequestAccess:!1,RemittanceAccess:!1,HBLAccess:!1,PassportAccess:!1,AdminPassportAccess:!1,HBLAccessManagement:!1,HBLScannerAccess:!1,NotaryAccess:!1,offersManagementAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1,isAdmin:!1}};const de=async()=>{try{const t=W(X,"businesses"),o=ee(t,se("name")),f=await te(o),m=[];f.forEach(i=>{const n=i.data();n.isActive&&m.push({id:i.id,name:n.name})});const e=[{id:"SS695841584167881",name:"Stephanie S"},{id:"YB100423253156428",name:"YABA"},{id:"JJCM23753J15918M",name:"GUANCHO"},{id:"LMR470531564CT28",name:"LUISCUETO"}];for(const i of e)m.find(n=>n.id===i.id)||m.push(i);j(m)}catch(t){console.error("Error loading businesses:",t),j([{id:"SS695841584167881",name:"Stephanie S"},{id:"YB100423253156428",name:"YABA"},{id:"JJCM23753J15918M",name:"GUANCHO"},{id:"LMR470531564CT28",name:"LUISCUETO"}])}};xe(async()=>{await me(),await de(),await le()});const me=async()=>{try{F(!0),_("üì• Loading users via API...");const t=await V.getAll();_(`‚úÖ Received ${t.length} users from API`);const o=t.map(f=>{let m={uid:f.uid,...f};return Object.keys(K).forEach(e=>{m.hasOwnProperty(e)||(m[e]=K[e])}),m});_(`‚úÖ Loaded and normalized ${o.length} users`),_(o),R(o)}catch(t){console.error("‚ùå Error loading users:",t),I({type:"error",text:"Failed to load users from server"})}finally{F(!1)}},pe=U(()=>{const t=q().toLowerCase();return t?H().filter(o=>o.email?.toLowerCase().includes(t)||o.displayName?.toLowerCase().includes(t)||o.uid?.toLowerCase().includes(t)):H()}),ye=t=>{s()&&S(o=>({...o,stores:{...o.stores,[t]:!o.stores[t]}}))},ue=t=>{s()&&S(o=>({...o,businessId:t}))},Ae=t=>{s()&&S(o=>({...o,permissions:{...o.permissions,[t]:!o.permissions?.[t]}}))},fe=t=>{s()&&S(o=>({...o,statusLocationPermissions:{...o.statusLocationPermissions,[t]:!o.statusLocationPermissions?.[t]}}))};U(()=>s()?s().stores&&Object.values(s().stores).some(t=>t):!1);const ge=async()=>{if(s())try{z(!0),I(null),_("üíæ Saving user permissions via API..."),_("üîÑ Using API endpoint (NOT Firebase directly)");const t={permissions:{AccountAccess:s().permissions?.AccountAccess||!1,BankingAccess:s().permissions?.BankingAccess||!1,InventoryAccess:s().permissions?.InventoryAccess||!1,EmployeeAccess:s().permissions?.EmployeeAccess||!1,invoiceAccess:s().permissions?.invoiceAccess||!1,JournalAccess:s().permissions?.JournalAccess||!1,PassportAccess:s().permissions?.PassportAccess||!1,inventoryDownsection:s().permissions?.inventoryDownsection||!1,PurchaseRequestAccess:s().permissions?.PurchaseRequestAccess||!1,onlyRead:s().permissions?.onlyRead||!1,AdminPassportAccess:s().permissions?.AdminPassportAccess||!1,HBLAccessManagement:s().permissions?.HBLAccessManagement||!1,HBLScannerAccess:s().permissions?.HBLScannerAccess||!1,HBLAccess:s().permissions?.HBLAccess||!1,NotaryAccess:s().permissions?.NotaryAccess||!1,RemittanceAccess:s().permissions?.RemittanceAccess||!1,offersManagementAccess:s().permissions?.offersManagementAccess||!1,AppointmentAccess:s().permissions?.AppointmentAccess||!1,read_write:s().permissions?.read_write||!1,isAdmin:s().permissions?.isAdmin||!1},stores:s().stores,statusLocationPermissions:s().statusLocationPermissions||Object.fromEntries(O.map(f=>[f.id,!1])),businessId:s().businessId,businessIds:s().businessIds||[]};let o=s().id||s().uid;_("üì° Calling usersApi.updatePermissions (API endpoint)..."),await V.updatePermissions(o,t),_("‚úÖ API call completed successfully (no direct Firebase update)"),R(f=>f.map(m=>m.uid===s().uid?s():m)),_("‚úÖ User permissions saved successfully via API"),I({type:"success",text:"User profile updated successfully via API (not direct Firebase)"})}catch(t){console.error("‚ùå Error saving user profile via API:",t),I({type:"error",text:"Failed to save user profile via API endpoint"})}finally{z(!1)}},ve={display:"grid","grid-template-columns":"350px 1fr",gap:"2rem",height:"calc(100vh - 200px)"},be={"max-height":"100%","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)",background:"var(--surface-color)"},Ye=t=>({padding:"1rem","border-bottom":"1px solid var(--border-color)",cursor:"pointer",background:t?"var(--primary-color-light)":"transparent",transition:"background 0.2s"}),Pe={padding:"0.75rem",border:"none","border-bottom":"1px solid var(--border-color)",background:"var(--surface-color)",width:"100%","font-size":"1rem"},_e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1rem"},Q={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(200px, 1fr))",gap:"0.75rem"},C={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",transition:"all 0.2s"},he=t=>({padding:"1rem","margin-bottom":"1rem","border-radius":"var(--border-radius)",background:t==="success"?"#d4edda":"#f8d7da",color:t==="success"?"#155724":"#721c24",border:`1px solid ${t==="success"?"#c3e6cb":"#f5c6cb"}`}),Se=U(()=>Ie.state.profile?.isAdmin===!0);return y(Le,{title:"User Profile Administration",get children(){return y(L,{get when(){return Se()},get fallback(){return y(M,{get children(){var t=Me();return t.style.setProperty("text-align","center"),t.style.setProperty("padding","2rem"),t.style.setProperty("color","var(--text-muted)"),t}})},get children(){var t=Ue(),o=t.firstChild,f=o.firstChild,m=o.nextSibling;return Y(t,ve),Y(o,be),f.$$input=e=>oe(e.currentTarget.value),Y(f,Pe),l(o,y(L,{get when(){return!ne()},get fallback(){return(()=>{var e=Te();return e.style.setProperty("padding","2rem"),e.style.setProperty("text-align","center"),e})()},get children(){return y(B,{get each(){return pe()},children:e=>(()=>{var i=He(),n=i.firstChild,a=n.nextSibling,r=a.nextSibling,p=r.firstChild;return i.$$click=()=>{_(e),S(e)},n.style.setProperty("font-weight","600"),l(n,()=>e.displayName||"No Name"),a.style.setProperty("font-size","0.875rem"),a.style.setProperty("color","var(--text-muted)"),l(a,()=>e.email),r.style.setProperty("font-size","0.75rem"),r.style.setProperty("color","var(--text-muted)"),r.style.setProperty("margin-top","0.25rem"),l(r,()=>e.permissions?.isAdmin&&"üëë Admin ‚Ä¢ ",p),l(r,()=>Object.values(e.stores||{}).filter(Boolean).length,p),A(c=>Y(i,Ye(s()?.uid===e.uid),c)),i})()})}}),null),l(m,y(L,{get when(){return s()},get fallback(){return y(M,{get children(){var e=Re();return e.style.setProperty("text-align","center"),e.style.setProperty("padding","2rem"),e.style.setProperty("color","var(--text-muted)"),e}})},get children(){return[y(L,{get when(){return k()},get children(){var e=re();return l(e,()=>k().text),A(i=>Y(e,he(k().type),i)),e}}),y(M,{title:"User Information",get subtitle(){return s().email},get children(){return[(()=>{var e=Ce(),i=e.firstChild,n=i.firstChild,a=n.firstChild;a.nextSibling;var r=n.nextSibling,p=r.firstChild;p.nextSibling;var c=i.nextSibling,d=c.firstChild;return d.nextSibling,e.style.setProperty("margin-bottom","2rem"),i.style.setProperty("display","flex"),i.style.setProperty("justify-content","space-between"),i.style.setProperty("margin-bottom","1rem"),l(n,()=>s().displayName||"Not set",null),l(r,()=>s().uid,null),l(c,()=>new Date(s().createdAt?.toDate?.()||s().createdAt).toLocaleDateString(),null),e})(),(()=>{var e=we(),i=e.firstChild,n=i.nextSibling,a=n.nextSibling;return e.style.setProperty("margin-bottom","2rem"),i.style.setProperty("margin-bottom","1rem"),l(n,y(B,{get each(){return ae()},children:r=>(()=>{var p=T(),c=p.firstChild,d=c.nextSibling;return p.$$click=()=>ye(r?.id),c.style.setProperty("cursor","pointer"),d.style.setProperty("cursor","pointer"),d.style.setProperty("user-select","none"),l(d,()=>r?.name),A(u=>Y(p,{...C,background:s().stores?.[r?.id]?"var(--primary-color-light)":"transparent"},u)),A(()=>c.checked=s().stores?.[r?.id]||!1),p})()})),a.style.setProperty("margin-top","0.5rem"),a.style.setProperty("font-size","0.875rem"),a.style.setProperty("color","var(--text-muted)"),A(r=>Y(n,Q,r)),e})(),(()=>{var e=Ne(),i=e.firstChild,n=i.nextSibling,a=n.firstChild,r=a.nextSibling,p=r.firstChild,c=n.nextSibling,d=c.firstChild,u=d.nextSibling,P=u.nextSibling;return e.style.setProperty("margin-bottom","2rem"),i.style.setProperty("margin-bottom","1rem"),n.style.setProperty("margin-bottom","1rem"),a.style.setProperty("display","block"),a.style.setProperty("margin-bottom","0.5rem"),a.style.setProperty("font-weight","500"),r.addEventListener("change",b=>ue(b.currentTarget.value)),r.style.setProperty("width","100%"),r.style.setProperty("padding","0.5rem"),r.style.setProperty("border","1px solid var(--border-color)"),r.style.setProperty("border-radius","var(--border-radius-sm)"),r.style.setProperty("background","var(--surface-color)"),l(p,()=>ie("common.all","All")),l(r,y(B,{get each(){return J()},children:b=>(()=>{var $=Fe();return l($,()=>b.name),A(()=>$.value=b.id),$})()}),null),d.style.setProperty("display","block"),d.style.setProperty("margin-bottom","0.5rem"),d.style.setProperty("font-weight","500"),u.style.setProperty("display","grid"),u.style.setProperty("grid-template-columns","repeat(auto-fill, minmax(200px, 1fr))"),u.style.setProperty("gap","0.75rem"),l(u,y(B,{get each(){return J()},children:b=>{const $=()=>(s()?.businessIds||[]).includes(b.id)||s()?.businessId===b.id;return(()=>{var g=T(),w=g.firstChild,N=w.nextSibling;return g.$$click=()=>{if(!s())return;const x=s().businessIds||[],$e=$()?x.filter(E=>E!==b.id):[...x,b.id];S(E=>({...E,businessIds:$e}))},g.style.setProperty("display","flex"),g.style.setProperty("align-items","center"),g.style.setProperty("gap","0.5rem"),g.style.setProperty("padding","0.5rem"),g.style.setProperty("border","1px solid var(--border-color)"),g.style.setProperty("border-radius","var(--border-radius-sm)"),g.style.setProperty("cursor","pointer"),g.style.setProperty("transition","all 0.2s"),w.style.setProperty("cursor","pointer"),N.style.setProperty("cursor","pointer"),N.style.setProperty("user-select","none"),l(N,()=>b.name),A(x=>(x=$()?"var(--primary-color-light)":"transparent")!=null?g.style.setProperty("background",x):g.style.removeProperty("background")),A(()=>w.checked=$()),g})()}})),P.style.setProperty("margin-top","0.5rem"),P.style.setProperty("font-size","0.875rem"),P.style.setProperty("color","var(--text-muted)"),A(()=>r.value=s()?.businessId),e})(),(()=>{var e=Ee(),i=e.firstChild,n=i.nextSibling;return e.style.setProperty("margin-bottom","2rem"),i.style.setProperty("margin-bottom","1rem"),Y(n,_e),l(n,y(B,{each:ce,children:a=>(()=>{var r=De(),p=r.firstChild,c=p.nextSibling,d=c.firstChild,u=d.nextSibling;return r.$$click=()=>Ae(a.key),p.style.setProperty("cursor","pointer"),c.style.setProperty("flex","1"),c.style.setProperty("cursor","pointer"),c.style.setProperty("user-select","none"),d.style.setProperty("font-weight","500"),l(d,()=>a.label),u.style.setProperty("font-size","0.75rem"),u.style.setProperty("color","var(--text-muted)"),l(u,()=>a.description),A(P=>Y(r,{...C,background:s()?.permissions?.[a.key]?"var(--primary-color-light)":"transparent"},P)),A(()=>p.checked=!!s()?.permissions?.[a.key]),r})()})),e})(),(()=>{var e=Oe(),i=e.firstChild,n=i.nextSibling,a=n.nextSibling,r=a.nextSibling,p=r.firstChild;return e.style.setProperty("margin-bottom","2rem"),i.style.setProperty("margin-bottom","1rem"),n.style.setProperty("font-size","0.875rem"),n.style.setProperty("color","var(--text-muted)"),n.style.setProperty("margin-bottom","1rem"),l(a,y(B,{each:O,children:c=>(()=>{var d=T(),u=d.firstChild,P=u.nextSibling;return d.$$click=()=>fe(c.id),u.style.setProperty("cursor","pointer"),P.style.setProperty("cursor","pointer"),P.style.setProperty("user-select","none"),P.style.setProperty("font-size","0.875rem"),l(P,()=>c.label),A(b=>Y(d,{...C,background:s().statusLocationPermissions?.[c.id]?"var(--primary-color-light)":"transparent"},b)),A(()=>u.checked=!!s().statusLocationPermissions?.[c.id]),d})()})),r.style.setProperty("margin-top","0.5rem"),r.style.setProperty("font-size","0.875rem"),r.style.setProperty("color","var(--text-muted)"),l(r,()=>Object.values(s().statusLocationPermissions||{}).filter(Boolean).length,p),A(c=>Y(a,Q,c)),e})(),(()=>{var e=re();return e.style.setProperty("display","flex"),e.style.setProperty("gap","1rem"),e.style.setProperty("justify-content","flex-end"),l(e,y(Z,{variant:"secondary",onClick:()=>S(null),children:"Cancel"}),null),l(e,y(Z,{variant:"primary",onClick:ge,get disabled(){return D()},get children(){return D()?"Saving...":"Save Changes"}}),null),e})()]}})]}})),A(()=>f.value=q()),t}})}})};ke(["input","click"]);export{qe as default};
