import{h as I,P as pt,Q as Kt,c as K,o as Yt,aR as ir,g as or,$ as Qt,a as m,t as g,j as e,i,S as x,F as Ye,b as s,d as Ut,a3 as Xt,X as Tt,w as nt,D as lr,aS as ar}from"./index-BwmeK1hP.js";const wt=[{code:"USD",name:"US Dollar",symbol:"$"},{code:"EUR",name:"Euro",symbol:"‚Ç¨"},{code:"CUP",name:"Peso Cubano",symbol:"$"},{code:"CUC",name:"Peso Convertible Cubano",symbol:"CUC"}],Pt=[{value:"pending",label:"Pendiente",color:"#f59e0b"},{value:"processing",label:"Procesando",color:"#3b82f6"},{value:"completed",label:"Completada",color:"#10b981"},{value:"cancelled",label:"Cancelada",color:"#ef4444"}],sr=()=>{const r=new Date,a=r.getFullYear(),w=String(r.getMonth()+1).padStart(2,"0"),t=String(r.getDate()).padStart(2,"0"),d=`${a}${w}${t}`,k=String(r.getHours()).padStart(2,"0"),o=String(r.getMinutes()).padStart(2,"0"),U=String(r.getSeconds()).padStart(2,"0"),q=`${k}${o}${U}`,X=Math.random().toString(36).substr(2,5).toUpperCase();return`REM-${d}-${q}-${X}`},Rt={async getAll(r,a=1,w=20){try{let t={businessId:I.getBusinessId(),page:a,pageSize:w},d=["businessId = businessId"];const k=I.state?.profile;k&&!k.isAdmin&&!k.read_write&&(t[":createdBy"]=I.currentUser?.uid||"unknown",d.push("createdBy = :createdBy")),r?.search&&r.search.split(" ").forEach((X,J)=>{const W=`search${J}`;t[`:${W}`]=X.trim(),d.push(`(remittanceNumber contain :${W} OR customerName contain :${W} OR reference contain :${W})`)}),r?.status&&(t[":status"]=r.status,d.push("status = :status")),r?.currency&&(t[":currency"]=r.currency,d.push("currency = :currency")),r?.dateFrom&&(t[":dateFrom"]=r.dateFrom.toISOString(),d.push("createdAt >= :dateFrom")),r?.dateTo&&(t[":dateTo"]=r.dateTo.toISOString(),d.push("createdAt <= :dateTo")),r?.customerId&&(t[":customerId"]=r.customerId,d.push("customerId = :customerId"));const U={query:"getRemittance",queryString:d.join(" AND "),params:t},q=await pt(U);return{remittances:q.data||[],total:q.total||0,page:a,pageSize:w}}catch(t){return console.error("Error fetching remittances:",t),{remittances:[],total:0,page:a,pageSize:w}}},async getById(r){try{const w={query:"getRemittance",queryString:"!* contain id",params:{id:{id:r}.id}},t=await pt(w);return console.log(w),console.log(t),t.data&&t.data.length>0?t.data[0]:null}catch(a){return console.error("Error fetching remittance by ID:",a),null}},async create(r){try{const a=sr(),w={...r,remittanceNumber:a,id:Kt(),date:new Date,status:"pending",createdAt:new Date,updatedAt:new Date,businessId:I.getBusinessId(),createdBy:I.currentUser?.uid||"unknown"},d={query:"addRemittance",params:{businessId:I.getBusinessId()},form:w},k=await pt(d);if(k.error)throw new Error(k.error);return{...w}}catch(a){throw console.error("Error creating remittance:",a),new Error("Error al crear la remesa")}},async update(r){try{const a={...r,updatedAt:new Date},t={query:"updateRemittance",params:{businessId:r.businessId,id:r.id},form:a},d=await pt(t);if(d.error)throw new Error(d.error);const k=await this.getById(r.id);if(!k)throw new Error("No se pudo recuperar la remesa actualizada");return k}catch(a){throw console.error("Error updating remittance:",a),new Error("Error al actualizar la remesa")}},async delete(r){try{const w={query:"deleteRemittance",params:{businessId:I.getBusinessId(),id:r}},t=await pt(w);if(t.error)throw new Error(t.error);return{success:!0,message:"Remesa eliminada exitosamente"}}catch(a){return console.error("Error deleting remittance:",a),{success:!1,message:"Error al eliminar la remesa"}}},async updateStatus(r,a){return this.update({id:r,status:a})},async getByCustomer(r){try{const a={customerId:r};return(await this.getAll(a,1,100)).remittances}catch(a){return console.error("Error fetching remittances by customer:",a),[]}},async getStatistics(){try{const a={query:"getRemittanceStatistics",params:{businessId:I.getBusinessId()}};return(await pt(a)).data||{total:0,byStatus:{},byCurrency:{},totalAmount:{}}}catch(r){return console.error("Error fetching remittance statistics:",r),{total:0,byStatus:{},byCurrency:{},totalAmount:{}}}}},Mt=r=>({pending:"Pendiente",processing:"Procesando",completed:"Completada",cancelled:"Cancelada"})[r]||r,zt=r=>({pending:"#f59e0b",processing:"#3b82f6",completed:"#10b981",cancelled:"#ef4444"})[r]||"#6b7280";var dr=g("<div>Ref: "),qt=g("<select>"),cr=g("<div><span>Fecha</span><span>"),ur=g("<div><span>USD</span><div>"),vr=g("<div><span>Equivalente CUP</span><div><span>$"),mr=g("<div>C√©dula: "),gr=g("<div><div>"),hr=g("<button>‚úèÔ∏è Editar"),br=g("<button>üóëÔ∏è"),fr=g("<div><button>üëÅÔ∏è Ver"),yr=g("<div><div><div><div></div></div></div><div><div><span>Estado"),jt=g("<span>"),Ft=g("<option>"),xr=g("<button>+ Nueva"),Sr=g("<div><div><select><option value>Todos los estados</option></select><select><option value>Moneda</option></select></div><div><button>Aplicar</button><button>Limpiar"),$r=g("<div>"),pr=g("<div><button>‚Üê Anterior</button><span> / </span><button>Siguiente ‚Üí"),wr=g('<div><div><div><h1>Remesas</h1></div><div><input type=text placeholder="Buscar remesa..."><button>üîç'),Vt=g("<div>Cargando remesas..."),Wt=g("<div><p>No se encontraron remesas.</p><button>Crear primera remesa"),Cr=g("<button>+ Nueva Remesa"),_r=g("<th>Creado por"),kr=g("<table><thead><tr><th>N√∫mero</th><th>Cliente</th><th>Cantidad</th><th>Estado</th><th>Fecha</th><th>Acciones</th></tr></thead><tbody>"),Er=g("<div><button>Anterior</button><span>P√°gina <!> de </span><button>Siguiente"),Fr=g('<div><div><h1>Lista de Remesas</h1></div><div><div><label>Buscar</label><input type=text placeholder="N√∫mero, cliente, referencia..."></div><div><label>Estado</label><select><option value>Todos los estados</option></select></div><div><label>Moneda</label><select><option value>Todas las monedas</option></select></div><div><label>&nbsp;</label><div><button>Filtrar</button><button>Limpiar'),Rr=g("<option> - "),Ot=g("<br>"),zr=g("<small>Ref: "),Dr=g("<small>C√©dula: "),Nr=g("<small> $"),Ar=g("<td><small>"),Ir=g("<button>Editar"),Br=g("<button>Eliminar"),Pr=g("<tr><td><strong></strong><p></p></td><td><div></div></td><td><strong></strong></td><td></td><td></td><td><button>Ver");const Ur=r=>{const[a,w]=K({}),[t,d]=K(1),[k]=K(20),[o,U]=K(""),[q,X]=K(""),[J,W]=K(""),[G,se]=K(!1),[N,D]=K(window.innerWidth<768),[L,j]=K(!1),Ae=()=>{D(window.innerWidth<768)};Yt(()=>{window.addEventListener("resize",Ae)}),ir(()=>{window.removeEventListener("resize",Ae)});const de=or(()=>{const u={};return o()&&(u.search=o()),q()&&(u.status=q()),J()&&(u.currency=J()),u}),[_,{refetch:T}]=Qt(()=>({filter:de(),page:t(),pageSize:k()}),async({filter:u,page:z,pageSize:ve})=>{let fe=await Rt.getAll(u,z,ve),ye=fe.remittances.filter(me=>I.state?.profile?.isAdmin||me.status==="pending");return fe.remittances=ye,console.log(fe),fe}),re=async u=>{if(confirm(`¬øEst√° seguro que desea eliminar la remesa ${u.remittanceNumber}?`)){const z=await Rt.delete(u.id);z.success?(alert("Remesa eliminada exitosamente"),T()):alert(z.message)}},H=async(u,z)=>{try{await Rt.updateStatus(u.id,z),alert("Estado actualizado exitosamente"),T()}catch{alert("Error al actualizar el estado")}},Ie=()=>{d(1),T()},O=()=>{U(""),X(""),W(""),d(1),T()},Z=(u,z)=>`${wt.find(ye=>ye.code===z)?.symbol||z} ${u.toFixed(2)}`,Re={padding:"2rem","background-color":"var(--background-color)"},Be={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},Qe={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)"},$={padding:"0.75rem 1.5rem","background-color":"var(--primary-color)",color:"white",border:"none","border-radius":"4px",cursor:"pointer","font-weight":"500"},ee={display:"flex",gap:"1rem","margin-bottom":"2rem","flex-wrap":"wrap","align-items":"end"},Se={display:"flex","flex-direction":"column",gap:"0.5rem"},_e={"font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)"},ie={padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"4px","font-size":"0.875rem"},ke={...ie,cursor:"pointer"},$e={padding:"0.5rem 1rem",border:"none","border-radius":"4px",cursor:"pointer","font-size":"0.875rem","font-weight":"500"},M={...$e,"background-color":"var(--primary-color)",color:"white"},oe={...$e,"background-color":"var(--border-color)",color:"var(--text-secondary)"},be={width:"100%","border-collapse":"collapse","background-color":"white","border-radius":"8px",overflow:"hidden","box-shadow":"0 1px 3px rgba(0,0,0,0.1)"},ce={padding:"1rem","text-align":"left","background-color":"var(--strip-color)","font-weight":"600","font-size":"0.875rem",color:"var(--text-primary)","border-bottom":"1px solid var(--border-color)"},ue={padding:"1rem","border-bottom":"1px solid var(--border-light)","font-size":"0.875rem","vertical-align":"middle"},qe=u=>({display:"inline-block",padding:"0.25rem 0.5rem","border-radius":"12px","font-size":"0.75rem","font-weight":"500","background-color":zt(u)+"20",color:zt(u)}),Pe={...$e,padding:"0.25rem 0.5rem","font-size":"0.75rem","margin-right":"0.5rem"},it={...Pe,"background-color":"#3b82f6",color:"white"},mt={...Pe,"background-color":"#6b7280",color:"white"},ot={...Pe,"background-color":"#ef4444",color:"white"},Ue={display:"flex","justify-content":"center","align-items":"center",gap:"1rem","margin-top":"2rem"},gt={"text-align":"center",padding:"3rem",color:"var(--text-muted)"},je={"text-align":"center",padding:"3rem",color:"var(--text-muted)"},Xe={padding:"1rem","background-color":"var(--background-color)"},ht={display:"flex","flex-direction":"column",gap:"1rem","margin-bottom":"1rem"},lt={display:"flex","justify-content":"space-between","align-items":"center"},Ve={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)"},We={padding:"0.5rem 1rem","background-color":"var(--primary-color)",color:"white",border:"none","border-radius":"4px",cursor:"pointer","font-weight":"500","font-size":"0.875rem"},Je={display:"flex",gap:"0.5rem","align-items":"center"},l={flex:"1",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"8px","font-size":"1rem"},A={padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"8px",background:"white",cursor:"pointer",display:"flex","align-items":"center","justify-content":"center"},V={display:"flex","flex-direction":"column",gap:"0.75rem",padding:"1rem",background:"white","border-radius":"8px","margin-bottom":"1rem","box-shadow":"0 2px 8px rgba(0,0,0,0.08)"},E={display:"flex",gap:"0.5rem"},ne={flex:"1",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"8px","font-size":"0.875rem",background:"white"},Ee={display:"flex",gap:"0.5rem","margin-top":"0.5rem"},pe={flex:"1",padding:"0.75rem","border-radius":"8px",border:"none","font-weight":"500",cursor:"pointer"},Oe={display:"flex","flex-direction":"column",gap:"1rem"},Ge={background:"white","border-radius":"12px",padding:"1rem","box-shadow":"0 2px 8px rgba(0,0,0,0.08)",border:"1px solid var(--border-light)"},B={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"0.75rem"},we={"font-weight":"600","font-size":"1rem",color:"var(--text-primary)"},le={"font-size":"0.75rem",color:"var(--text-muted)","margin-top":"0.25rem"},ze={"font-size":"1.25rem","font-weight":"700",color:"var(--primary-color)","text-align":"right"},Ze={display:"flex","flex-direction":"column",gap:"0.5rem"},Le={display:"flex","justify-content":"space-between","align-items":"center","font-size":"0.875rem"},et={color:"var(--text-muted)","font-size":"0.75rem"},at={color:"var(--text-primary)","font-weight":"500"},bt={"border-top":"1px solid var(--border-light)","padding-top":"0.75rem","margin-top":"0.5rem"},ft={"font-weight":"500",color:"var(--text-primary)","margin-bottom":"0.25rem"},st={"font-size":"0.75rem",color:"var(--text-muted)"},Dt={display:"flex",gap:"0.5rem","margin-top":"1rem","padding-top":"0.75rem","border-top":"1px solid var(--border-light)"},xt={flex:"1",padding:"0.625rem","border-radius":"8px",border:"none","font-weight":"500","font-size":"0.875rem",cursor:"pointer",display:"flex","align-items":"center","justify-content":"center",gap:"0.25rem"},Nt={...xt,background:"#f3f4f6",color:"#374151"},At={...xt,background:"#dbeafe",color:"#1d4ed8"},It={...xt,background:"#fee2e2",color:"#dc2626"},n={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"white","border-radius":"8px","margin-top":"1rem"},Y={padding:"0.625rem 1rem","border-radius":"8px",border:"1px solid var(--border-color)",background:"white",cursor:"pointer","font-weight":"500","font-size":"0.875rem"},te={"font-size":"0.875rem",color:"var(--text-muted)"},S=u=>(()=>{var z=yr(),ve=z.firstChild,fe=ve.firstChild,ye=fe.firstChild,me=ve.nextSibling,De=me.firstChild,p=De.firstChild;return e(z,Ge),e(ve,B),e(ye,we),i(ye,()=>u.remittanceNumber),i(fe,m(x,{get when(){return u.reference},get children(){var c=dr();return c.firstChild,e(c,le),i(c,()=>u.reference,null),c}}),null),i(De,m(x,{get when(){return I.state?.profile?.isAdmin},get fallback(){return(()=>{var c=jt();return i(c,()=>Mt(u.status)),s(f=>e(c,qe(u.status),f)),c})()},get children(){var c=qt();return c.addEventListener("change",f=>H(u,f.target.value)),i(c,m(Ye,{each:Pt,children:f=>(()=>{var y=Ft();return i(y,()=>f.label),s(()=>y.value=f.value),y})()})),s(f=>e(c,{...ne,flex:"none",width:"auto",padding:"0.25rem 0.5rem",...qe(u.status),border:`1px solid ${zt(u.status)}40`},f)),s(()=>c.value=u.status),c}}),null),i(me,m(x,{get when(){return I.state?.profile?.isAdmin||u.status==="pending"},get children(){return[(()=>{var c=cr(),f=c.firstChild,y=f.nextSibling;return i(y,()=>new Date(u.date).toLocaleDateString("es-ES")),s(C=>{var F=Le,xe=et,R=at;return C.e=e(c,F,C.e),C.t=e(f,xe,C.t),C.a=e(y,R,C.a),C},{e:void 0,t:void 0,a:void 0}),c})(),(()=>{var c=ur(),f=c.firstChild,y=f.nextSibling;return i(y,()=>Z(u.amount,u.currency)),s(C=>{var F=Le,xe=et,R=ze;return C.e=e(c,F,C.e),C.t=e(f,xe,C.t),C.a=e(y,R,C.a),C},{e:void 0,t:void 0,a:void 0}),c})(),m(x,{get when(){return u.currency!=="USD"&&u.exchangeRate},get children(){var c=vr(),f=c.firstChild,y=f.nextSibling,C=y.firstChild;return C.firstChild,i(C,()=>(u.amount*(u.exchangeRate||1)).toFixed(2),null),s(F=>{var xe=Le,R=et,ae={...at,...ze};return F.e=e(c,xe,F.e),F.t=e(f,R,F.t),F.a=e(C,ae,F.a),F},{e:void 0,t:void 0,a:void 0}),c}})]}}),null),i(z,m(x,{get when(){return I.isAdmin()||u.status==="pending"},get children(){return[(()=>{var c=gr(),f=c.firstChild;return e(c,bt),e(f,ft),i(f,()=>u.customer.fullName||u.customer.name),i(c,m(x,{get when(){return u.customer.cid},get children(){var y=mr();return y.firstChild,e(y,st),i(y,()=>u.customer.cid,null),y}}),null),c})(),(()=>{var c=fr(),f=c.firstChild;return e(c,Dt),f.$$click=()=>r.onView(u),i(c,m(x,{get when(){return I.isAdmin()},get children(){return[(()=>{var y=hr();return y.$$click=()=>r.onEdit(u),s(C=>e(y,At,C)),y})(),(()=>{var y=br();return y.$$click=()=>re(u),s(C=>e(y,It,C)),y})()]}}),null),s(y=>e(f,Nt,y)),c})()]}}),null),s(c=>{var f=Ze,y=Le,C=et;return c.e=e(me,f,c.e),c.t=e(De,y,c.t),c.a=e(p,C,c.a),c},{e:void 0,t:void 0,a:void 0}),z})(),Fe=()=>(()=>{var u=wr(),z=u.firstChild,ve=z.firstChild,fe=ve.firstChild,ye=ve.nextSibling,me=ye.firstChild,De=me.nextSibling;return e(u,Xe),e(ve,lt),e(fe,Ve),i(ve,m(x,{get when(){return I.isAdmin()},get children(){var p=xr();return p.$$click=()=>r.onCreate(),s(c=>e(p,We,c)),p}}),null),e(ye,Je),me.$$keyup=p=>p.key==="Enter"&&Ie(),me.$$input=p=>U(p.target.value),e(me,l),De.$$click=()=>j(!L()),i(u,m(x,{get when(){return L()},get children(){var p=Sr(),c=p.firstChild,f=c.firstChild;f.firstChild;var y=f.nextSibling;y.firstChild;var C=c.nextSibling,F=C.firstChild,xe=F.nextSibling;return e(c,E),f.addEventListener("change",R=>X(R.target.value)),i(f,m(Ye,{each:Pt,children:R=>(()=>{var ae=Ft();return i(ae,()=>R.label),s(()=>ae.value=R.value),ae})()}),null),y.addEventListener("change",R=>W(R.target.value)),i(y,m(Ye,{each:wt,children:R=>(()=>{var ae=Ft();return i(ae,()=>R.code),s(()=>ae.value=R.code),ae})()}),null),e(C,Ee),F.$$click=Ie,xe.$$click=O,s(R=>{var ae=V,He=ne,St=ne,v={...pe,background:"var(--primary-color)",color:"white"},P={...pe,background:"#f3f4f6",color:"var(--text-secondary)"};return R.e=e(p,ae,R.e),R.t=e(f,He,R.t),R.a=e(y,St,R.a),R.o=e(F,v,R.o),R.i=e(xe,P,R.i),R},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),s(()=>f.value=q()),s(()=>y.value=J()),p}}),null),i(u,m(x,{get when(){return!_.loading},get fallback(){return(()=>{var p=Vt();return s(c=>e(p,{...je,background:"white","border-radius":"12px"},c)),p})()},get children(){return m(x,{get when(){return _()?.remittances.length>0},get fallback(){return(()=>{var p=Wt(),c=p.firstChild,f=c.nextSibling;return f.$$click=()=>r.onCreate(),s(y=>{var C={...je,background:"white","border-radius":"12px"},F={...We,"margin-top":"1rem"};return y.e=e(p,C,y.e),y.t=e(f,F,y.t),y},{e:void 0,t:void 0}),p})()},get children(){return[(()=>{var p=$r();return i(p,m(Ye,{get each(){return _()?.remittances||[]},children:c=>S(c)})),s(c=>e(p,Oe,c)),p})(),m(x,{get when(){return _()?.total>k()},get children(){var p=pr(),c=p.firstChild,f=c.nextSibling,y=f.firstChild,C=f.nextSibling;return e(p,n),c.$$click=()=>d(t()-1),e(f,te),i(f,t,y),i(f,()=>Math.ceil((_()?.total||0)/k()),null),C.$$click=()=>d(t()+1),s(F=>{var xe={...Y,opacity:t()===1?.5:1},R=t()===1,ae={...Y,opacity:t()>=Math.ceil((_()?.total||0)/k())?.5:1},He=t()>=Math.ceil((_()?.total||0)/k());return F.e=e(c,xe,F.e),R!==F.t&&(c.disabled=F.t=R),F.a=e(C,ae,F.a),He!==F.o&&(C.disabled=F.o=He),F},{e:void 0,t:void 0,a:void 0,o:void 0}),p}})]}})}}),null),s(p=>{var c=ht,f={...A,background:L()?"var(--primary-color)":"white",color:L()?"white":"var(--text-primary)"};return p.e=e(z,c,p.e),p.t=e(De,f,p.t),p},{e:void 0,t:void 0}),s(()=>me.value=o()),u})();return m(x,{get when(){return N()},get fallback(){return(()=>{var u=Fr(),z=u.firstChild,ve=z.firstChild,fe=z.nextSibling,ye=fe.firstChild,me=ye.firstChild,De=me.nextSibling,p=ye.nextSibling,c=p.firstChild,f=c.nextSibling;f.firstChild;var y=p.nextSibling,C=y.firstChild,F=C.nextSibling;F.firstChild;var xe=y.nextSibling,R=xe.firstChild,ae=R.nextSibling,He=ae.firstChild,St=He.nextSibling;return e(u,Re),e(z,Be),e(ve,Qe),i(z,m(x,{get when(){return I.isAdmin()},get children(){var v=Cr();return v.$$click=()=>r.onCreate(),e(v,$),v}}),null),e(fe,ee),De.$$input=v=>U(v.target.value),f.addEventListener("change",v=>X(v.target.value)),i(f,m(Ye,{each:Pt,children:v=>(()=>{var P=Ft();return i(P,()=>v.label),s(()=>P.value=v.value),P})()}),null),F.addEventListener("change",v=>W(v.target.value)),i(F,m(Ye,{each:wt,children:v=>(()=>{var P=Rr(),ge=P.firstChild;return i(P,()=>v.code,ge),i(P,()=>v.name,null),s(()=>P.value=v.code),P})()}),null),He.$$click=Ie,St.$$click=O,i(u,m(x,{get when(){return!_.loading},get fallback(){return(()=>{var v=Vt();return s(P=>e(v,gt,P)),v})()},get children(){return m(x,{get when(){return _()?.remittances.length>0},get fallback(){return(()=>{var v=Wt(),P=v.firstChild,ge=P.nextSibling;return ge.$$click=()=>r.onCreate(),s(Ce=>{var Te=je,Ne=M;return Ce.e=e(v,Te,Ce.e),Ce.t=e(ge,Ne,Ce.t),Ce},{e:void 0,t:void 0}),v})()},get children(){return[(()=>{var v=kr(),P=v.firstChild,ge=P.firstChild,Ce=ge.firstChild,Te=Ce.nextSibling,Ne=Te.nextSibling,he=Ne.nextSibling,dt=he.nextSibling,tt=dt.nextSibling,yt=P.nextSibling;return i(ge,m(x,{get when(){return I.state?.profile?.isAdmin},get children(){var b=_r();return s(Me=>e(b,ce,Me)),b}}),tt),i(yt,m(Ye,{get each(){return _()?.remittances||[]},children:b=>(()=>{var Me=Pr(),Ke=Me.firstChild,ct=Ke.firstChild,Ct=ct.nextSibling,ut=Ke.nextSibling,_t=ut.firstChild,vt=ut.nextSibling,Lt=vt.firstChild,kt=vt.nextSibling,Et=kt.nextSibling,$t=Et.nextSibling,Bt=$t.firstChild;return i(ct,()=>b.remittanceNumber),i(Ct,()=>b.id),i(Ke,m(x,{get when(){return b.reference},get children(){return[Ot(),(()=>{var h=zr();return h.firstChild,h.style.setProperty("color","var(--text-muted)"),i(h,()=>b.reference,null),h})()]}}),null),i(_t,()=>b.customer.fullName||b.customer.name),i(ut,m(x,{get when(){return b.customer.cid},get children(){var h=Dr();return h.firstChild,h.style.setProperty("color","var(--text-muted)"),i(h,()=>b.customer.cid,null),h}}),null),i(Lt,()=>Z(b.amount,b.currency)),i(vt,m(x,{get when(){return b.currency!=="USD"&&b.exchangeRate},get children(){return[Ot(),(()=>{var h=Nr(),Q=h.firstChild;return h.style.setProperty("color","var(--text-muted)"),i(h,()=>b.currency,Q),i(h,()=>(b.amount*(b.exchangeRate||1)).toFixed(2),null),h})()]}}),null),i(kt,m(x,{get when(){return I.state?.profile?.isAdmin||I.state?.profile?.read_write||b.createdBy===I.currentUser?.uid},get fallback(){return(()=>{var h=jt();return i(h,()=>Mt(b.status)),s(Q=>e(h,qe(b.status),Q)),h})()},get children(){var h=qt();return h.addEventListener("change",Q=>H(b,Q.target.value)),i(h,m(Ye,{each:Pt,children:Q=>(()=>{var rt=Ft();return i(rt,()=>Q.label),s(()=>rt.value=Q.value),rt})()})),s(Q=>e(h,{...ke,...qe(b.status),border:"none",background:"transparent"},Q)),s(()=>h.value=b.status),h}})),i(Et,()=>new Date(b.date).toLocaleDateString("es-ES")),i(Me,m(x,{get when(){return I.isAdmin()},get children(){var h=Ar(),Q=h.firstChild;return Q.style.setProperty("color","var(--text-muted)"),i(Q,()=>b.createdBy||"N/A"),s(rt=>e(h,ue,rt)),h}}),$t),Bt.$$click=()=>r.onView(b),i($t,m(x,{get when(){return I.isAdmin()},get children(){return[(()=>{var h=Ir();return h.$$click=()=>r.onEdit(b),s(Q=>e(h,it,Q)),h})(),(()=>{var h=Br();return h.$$click=()=>re(b),s(Q=>e(h,ot,Q)),h})()]}}),null),s(h=>{var Q=ue,rt=ue,Zt=ue,er=ue,tr=ue,rr=ue,nr=mt;return h.e=e(Ke,Q,h.e),h.t=e(ut,rt,h.t),h.a=e(vt,Zt,h.a),h.o=e(kt,er,h.o),h.i=e(Et,tr,h.i),h.n=e($t,rr,h.n),h.s=e(Bt,nr,h.s),h},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),Me})()})),s(b=>{var Me=be,Ke=ce,ct=ce,Ct=ce,ut=ce,_t=ce,vt=ce;return b.e=e(v,Me,b.e),b.t=e(Ce,Ke,b.t),b.a=e(Te,ct,b.a),b.o=e(Ne,Ct,b.o),b.i=e(he,ut,b.i),b.n=e(dt,_t,b.n),b.s=e(tt,vt,b.s),b},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),v})(),m(x,{get when(){return _()?.total>k()},get children(){var v=Er(),P=v.firstChild,ge=P.nextSibling,Ce=ge.firstChild,Te=Ce.nextSibling;Te.nextSibling;var Ne=ge.nextSibling;return e(v,Ue),P.$$click=()=>d(t()-1),i(ge,t,Te),i(ge,()=>Math.ceil((_()?.total||0)/k()),null),Ne.$$click=()=>d(t()+1),s(he=>{var dt=oe,tt=t()===1,yt=oe,b=t()>=Math.ceil((_()?.total||0)/k());return he.e=e(P,dt,he.e),tt!==he.t&&(P.disabled=he.t=tt),he.a=e(Ne,yt,he.a),b!==he.o&&(Ne.disabled=he.o=b),he},{e:void 0,t:void 0,a:void 0,o:void 0}),v}})]}})}}),null),s(v=>{var P=Se,ge=_e,Ce=ie,Te=Se,Ne=_e,he=ke,dt=Se,tt=_e,yt=ke,b=Se,Me=_e,Ke=M,ct=oe;return v.e=e(ye,P,v.e),v.t=e(me,ge,v.t),v.a=e(De,Ce,v.a),v.o=e(p,Te,v.o),v.i=e(c,Ne,v.i),v.n=e(f,he,v.n),v.s=e(y,dt,v.s),v.h=e(C,tt,v.h),v.r=e(F,yt,v.r),v.d=e(xe,b,v.d),v.l=e(R,Me,v.l),v.u=e(He,Ke,v.u),v.c=e(St,ct,v.c),v},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0}),s(()=>De.value=o()),s(()=>f.value=q()),s(()=>F.value=J()),u})()},get children(){return m(Fe,{})}})};Ut(["click","input","keyup"]);const Lr=r=>{const a=58.419999999999995,w=4*25.4,t=new Xt({orientation:"portrait",unit:"mm",format:[a,w]}),d=5,k=5;let o=d;const U=(D,L,j=10)=>{t.setFontSize(j);const Ae=t.splitTextToSize(D,a-2*d);return t.text(Ae,d,L),L+Ae.length*k};t.setFontSize(14),t.setFont("helvetica","bold"),t.text("REMESA",a/2,o,{align:"center"}),o+=8,t.setLineWidth(.5),t.line(d,o,a-d,o),o+=5,t.setFontSize(8),t.setFont("helvetica","normal");const q=new Date(r.date);t.text(`Fecha: ${q.toLocaleDateString("es-ES")}`,d,o),o+=4,t.text(`No.: ${r.remittanceNumber}`,d,o),o+=4,t.setLineWidth(.2),t.line(d,o,a-d,o),o+=5,t.setFontSize(10),t.setFont("helvetica","bold"),t.text("DESTINATARIO:",d,o),o+=5,t.setFont("helvetica","normal");const X=r.customer.fullName||`${r.customer.firstName||""} ${r.customer.lastName||""}`.trim()||r.customer.name;o=U(X,o,9),o+=2,r.customer.address&&(t.setFontSize(8),o=U(r.customer.address,o,8),o+=2),r.customer.phoneNumber&&(t.setFontSize(8),t.text(`Tel√©fono: ${r.customer.phoneNumber}`,d,o),o+=4),r.customer.cid&&(t.setFontSize(8),t.text(`C√©dula: ${r.customer.cid}`,d,o),o+=4),o+=2,t.setLineWidth(.2),t.line(d,o,a-d,o),o+=5,t.setFontSize(10),t.setFont("helvetica","bold"),t.text("CANTIDAD:",d,o),o+=5;const J={USD:"$",EUR:"‚Ç¨",CUP:"‚Ç±",CUC:"CUC$"};t.setFontSize(14),t.setFont("helvetica","bold");const G=`${J[r.currency]||r.currency}${r.amount.toFixed(2)}`;if(t.text(G,a/2,o,{align:"center"}),o+=6,t.setFontSize(8),t.setFont("helvetica","normal"),t.text(r.currency,a/2,o,{align:"center"}),o+=5,r.currency!=="USD"&&r.exchangeRate){t.setFontSize(8);const D=(r.amount*r.exchangeRate).toFixed(2);t.text(`(USD $${D})`,a/2,o,{align:"center"}),o+=5}r.reference&&(o+=3,t.setLineWidth(.2),t.line(d,o,a-d,o),o+=5,t.setFontSize(8),t.setFont("helvetica","normal"),o=U(`Referencia: ${r.reference}`,o,8)),w-o-d>10&&(o=w-10,t.setFontSize(6),t.setFont("helvetica","italic"),t.text("Gracias por su confianza",a/2,o,{align:"center"}));const N=`remesa_${r.customer.cid||"cliente"}_${Date.now()}.pdf`;t.save(N)},Jt=r=>{const a=58.419999999999995,w=5*25.4,t=new Xt({orientation:"portrait",unit:"mm",format:[a,w]}),d=5,k=5;let o=d;const U=(N,D,L=10)=>{t.setFontSize(L);const j=t.splitTextToSize(N,a-2*d);return t.text(j,d,D),D+j.length*k};t.setFontSize(14),t.setFont("helvetica","bold"),t.text("REMESA",a/2,o,{align:"center"}),o+=8,t.setLineWidth(.5),t.line(d,o,a-d,o),o+=5,t.setFontSize(8),t.setFont("helvetica","normal");const q=new Date(r.date);t.text(`Fecha: ${q.toLocaleDateString("es-ES")}`,d,o),o+=4,t.text(`No.: ${r.remittanceNumber}`,d,o),o+=4,t.setLineWidth(.2),t.line(d,o,a-d,o),o+=5,t.setFontSize(10),t.setFont("helvetica","bold"),t.text("DESTINATARIO:",d,o),o+=5,t.setFont("helvetica","normal");const X=r.customer.fullName||`${r.customer.firstName||""} ${r.customer.lastName||""}`.trim()||r.customer.name;o=U(X,o,9),o+=2,r.customer.address&&(t.setFontSize(8),o=U(r.customer.address,o,8),o+=2),r.customer.phoneNumber&&(t.setFontSize(8),t.text(`Tel√©fono: ${r.customer.phoneNumber}`,d,o),o+=4),r.customer.cid&&(t.setFontSize(8),t.text(`C√©dula: ${r.customer.cid}`,d,o),o+=4),o+=2,t.setLineWidth(.2),t.line(d,o,a-d,o),o+=5,t.setFontSize(10),t.setFont("helvetica","bold"),t.text("CANTIDAD:",d,o),o+=9;const J={USD:"$",EUR:"‚Ç¨",CUP:"$",CUC:"CUC"};if(r.currency!=="USD"&&r.exchangeRate){t.setFontSize(14),t.setFont("helvetica","bold");const N=J[r.currency]||r.currency,D=(r.amount*r.exchangeRate).toFixed(2),L=`${r.currency} ${N} ${D}`;t.text(L,a/2,o,{align:"center"}),o+=6,t.setFontSize(8),t.text(`(USD $${r.amount.toFixed(2)})`,a/2,o,{align:"center"}),o+=5}r.reference&&(o+=3,t.setLineWidth(.2),t.line(d,o,a-d,o),o+=5,t.setFontSize(8),t.setFont("helvetica","normal"),o=U(`Referencia: ${r.reference}`,o,8)),w-o-d>10&&(o=w-10,t.setFontSize(6),t.setFont("helvetica","italic"),t.text("Gracias por su confianza",a/2,o,{align:"center"}));const G=t.output("dataurlstring"),se=window.open();se&&se.document.write(`
      <html>
        <head>
          <title>Recibo de Remesa</title>
          <style>
            body { margin: 0; padding: 20px; background: #f0f0f0; display: flex; justify-content: center; }
            iframe { box-shadow: 0 0 20px rgba(0,0,0,0.2); }
          </style>
        </head>
        <body>
          <iframe src="${G}" width="600" height="800"></iframe>
        </body>
      </html>
    `)};var Tr=g("<div><div><div><h2>Detalles de Remesa</h2><button>√ó"),Mr=g("<div>Cargando detalles..."),qr=g("<div>No se pudo cargar la remesa"),jr=g("<div><span>Direcci√≥n</span><span>"),Vr=g("<div><span>Tasa de Cambio</span><span>"),Wr=g("<div><span>Equivalente </span><span>$"),Or=g("<div><h3>Notas</h3><div>"),Gr=g("<div><span>Creado por</span><span>"),Hr=g("<div><div><h3>Informaci√≥n General</h3><div><div><span>N√∫mero de Remesa</span><span></span></div><div><span>Estado</span><span></span></div><div><span>Fecha</span><span></span></div><div><span>Referencia</span><span></span></div></div></div><div><h3>Informaci√≥n del Cliente</h3><div><div><span>Nombre Completo</span><span></span></div><div><span>C√©dula</span><span></span></div><div><span>Tel√©fono</span><span></span></div><div><span>Email</span><span></span></div></div></div><div><h3>Informaci√≥n Financiera</h3><div><div><span>Cantidad</span><span> USD</span></div><div><span>Moneda</span><span></span></div></div></div><div><h3>Informaci√≥n de Auditor√≠a</h3><div><div><span>Creado</span><span></span></div><div><span>√öltima Actualizaci√≥n</span><span>"),Kr=g("<button>Editar"),Yr=g("<div><button>Vista Previa PDF</button><button>Cerrar");const Qr=r=>{const[a,w]=K(!1);Qt(()=>r.remittanceId,async O=>{if(!O)return null});const t=async()=>{const O=r?.remittance;if(O)try{await Jt(O)}catch(Z){console.error("Error previewing PDF:",Z),alert("Error al mostrar la vista previa")}},d=(O,Z)=>`${wt.find(Qe=>Qe.code===Z)?.symbol||Z} ${O.toFixed(2)}`,k={position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","z-index":"1000"},o={"background-color":"white","border-radius":"8px","max-width":"600px",width:"90%","max-height":"90%",overflow:"auto","box-shadow":"0 20px 25px -5px rgba(0, 0, 0, 0.1)"},U={padding:"1.5rem","border-bottom":"1px solid var(--border-color)",display:"flex","justify-content":"space-between","align-items":"center"},q={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)"},X={background:"none",border:"none","font-size":"1.5rem",cursor:"pointer",color:"var(--text-muted)"},J={padding:"1.5rem"},W={"margin-bottom":"2rem"},G={"font-size":"1rem","font-weight":"600","margin-bottom":"1rem",color:"var(--text-primary)","border-bottom":"1px solid var(--border-light)","padding-bottom":"0.5rem"},se={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"1rem"},N={display:"flex","flex-direction":"column",gap:"0.25rem"},D={"font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)"},L={"font-size":"0.875rem",color:"var(--text-primary)"},j={...L,"font-weight":"600","font-size":"1rem"},Ae=O=>({display:"inline-block",padding:"0.5rem 1rem","border-radius":"20px","font-size":"0.875rem","font-weight":"500","background-color":zt(O)+"20",color:zt(O)}),de={padding:"1.5rem","border-top":"1px solid var(--border-color)",display:"flex",gap:"1rem","justify-content":"flex-end"},_={padding:"0.75rem 1.5rem",border:"none","border-radius":"4px",cursor:"pointer","font-weight":"500","font-size":"0.875rem"},T={..._,"background-color":"var(--primary-color)",color:"white"},re={..._,"background-color":"var(--border-color)",color:"var(--text-secondary)"},H={"text-align":"center",padding:"2rem",color:"var(--text-muted)"},Ie={"text-align":"center",padding:"2rem",color:"#ef4444"};return(()=>{var O=Tr(),Z=O.firstChild,Re=Z.firstChild,Be=Re.firstChild,Qe=Be.nextSibling;return Tt(O,"click",r.onClose,!0),Z.$$click=$=>$.stopPropagation(),e(Z,o),e(Re,U),e(Be,q),Tt(Qe,"click",r.onClose,!0),e(Qe,X),i(Z,m(x,{when:!0,get fallback(){return(()=>{var $=Mr();return s(ee=>e($,H,ee)),$})()},get children(){return m(x,{get when(){return r?.remittance},get fallback(){return(()=>{var $=qr();return s(ee=>e($,Ie,ee)),$})()},children:$=>[(()=>{var ee=Hr(),Se=ee.firstChild,_e=Se.firstChild,ie=_e.nextSibling,ke=ie.firstChild,$e=ke.firstChild,M=$e.nextSibling,oe=ke.nextSibling,be=oe.firstChild,ce=be.nextSibling,ue=oe.nextSibling,qe=ue.firstChild,Pe=qe.nextSibling,it=ue.nextSibling,mt=it.firstChild,ot=mt.nextSibling,Ue=Se.nextSibling,gt=Ue.firstChild,je=gt.nextSibling,Xe=je.firstChild,ht=Xe.firstChild,lt=ht.nextSibling,Ve=Xe.nextSibling,We=Ve.firstChild,Je=We.nextSibling,l=Ve.nextSibling,A=l.firstChild,V=A.nextSibling,E=l.nextSibling,ne=E.firstChild,Ee=ne.nextSibling,pe=Ue.nextSibling,Oe=pe.firstChild,Ge=Oe.nextSibling,B=Ge.firstChild,we=B.firstChild,le=we.nextSibling,ze=le.firstChild,Ze=B.nextSibling,Le=Ze.firstChild,et=Le.nextSibling,at=pe.nextSibling,bt=at.firstChild,ft=bt.nextSibling,st=ft.firstChild,Dt=st.firstChild,xt=Dt.nextSibling,Nt=st.nextSibling,At=Nt.firstChild,It=At.nextSibling;return e(ee,J),i(M,()=>$().remittanceNumber),i(ce,()=>Mt($().status)),i(Pe,()=>new Date($().date).toLocaleDateString("es-ES")),i(ot,()=>$().reference||"N/A"),i(lt,()=>$().customer.fullName||$().customer.name),i(Je,()=>$().customer.cid||"N/A"),i(V,()=>$().customer.phoneNumber||"N/A"),i(Ee,()=>$().customer.email||"N/A"),i(Ue,m(x,{get when(){return $().customer.address},get children(){var n=jr(),Y=n.firstChild,te=Y.nextSibling;return i(te,()=>$().customer.address),s(S=>{var Fe=N,u=D,z=j;return S.e=e(n,Fe,S.e),S.t=e(Y,u,S.t),S.a=e(te,z,S.a),S},{e:void 0,t:void 0,a:void 0}),n}}),null),i(le,()=>d($().amount,"USD"),ze),i(et,()=>$().currency),i(Ge,m(x,{get when(){return nt(()=>!!$().exchangeRate)()&&$().currency!=="USD"},get children(){return[(()=>{var n=Vr(),Y=n.firstChild,te=Y.nextSibling;return i(te,()=>$().exchangeRate?.toFixed(4)),s(S=>{var Fe=N,u=D,z=j;return S.e=e(n,Fe,S.e),S.t=e(Y,u,S.t),S.a=e(te,z,S.a),S},{e:void 0,t:void 0,a:void 0}),n})(),(()=>{var n=Wr(),Y=n.firstChild;Y.firstChild;var te=Y.nextSibling;return te.firstChild,i(Y,()=>$().currency,null),i(te,()=>($().amount*($().exchangeRate||1)).toFixed(2),null),s(S=>{var Fe=N,u=D,z={...j,color:"var(--primary-color)","font-size":"1.6rem"};return S.e=e(n,Fe,S.e),S.t=e(Y,u,S.t),S.a=e(te,z,S.a),S},{e:void 0,t:void 0,a:void 0}),n})()]}}),null),i(ee,m(x,{get when(){return $().notes},get children(){var n=Or(),Y=n.firstChild,te=Y.nextSibling;return i(te,()=>$().notes),s(S=>{var Fe=W,u=G,z=L;return S.e=e(n,Fe,S.e),S.t=e(Y,u,S.t),S.a=e(te,z,S.a),S},{e:void 0,t:void 0,a:void 0}),n}}),at),i(xt,()=>new Date($().createdAt).toLocaleString("es-ES")),i(It,()=>new Date($().updatedAt).toLocaleString("es-ES")),i(ft,m(x,{get when(){return nt(()=>!!I.isAdmin())()&&$().createdBy},get children(){var n=Gr(),Y=n.firstChild,te=Y.nextSibling;return i(te,()=>$().createdBy),s(S=>{var Fe=N,u=D,z=L;return S.e=e(n,Fe,S.e),S.t=e(Y,u,S.t),S.a=e(te,z,S.a),S},{e:void 0,t:void 0,a:void 0}),n}}),null),s(n=>{var Y=W,te=G,S=se,Fe=N,u=D,z=j,ve=N,fe=D,ye=Ae($().status),me=N,De=D,p=j,c=N,f=D,y=j,C=W,F=G,xe=se,R=N,ae=D,He=j,St=N,v=D,P=j,ge=N,Ce=D,Te=j,Ne=N,he=D,dt=L,tt=W,yt=G,b=se,Me=N,Ke=D,ct=j,Ct=N,ut=D,_t=j,vt=W,Lt=G,kt=se,Et=N,$t=D,Bt=L,h=N,Q=D,rt=L;return n.e=e(Se,Y,n.e),n.t=e(_e,te,n.t),n.a=e(ie,S,n.a),n.o=e(ke,Fe,n.o),n.i=e($e,u,n.i),n.n=e(M,z,n.n),n.s=e(oe,ve,n.s),n.h=e(be,fe,n.h),n.r=e(ce,ye,n.r),n.d=e(ue,me,n.d),n.l=e(qe,De,n.l),n.u=e(Pe,p,n.u),n.c=e(it,c,n.c),n.w=e(mt,f,n.w),n.m=e(ot,y,n.m),n.f=e(Ue,C,n.f),n.y=e(gt,F,n.y),n.g=e(je,xe,n.g),n.p=e(Xe,R,n.p),n.b=e(ht,ae,n.b),n.T=e(lt,He,n.T),n.A=e(Ve,St,n.A),n.O=e(We,v,n.O),n.I=e(Je,P,n.I),n.S=e(l,ge,n.S),n.W=e(A,Ce,n.W),n.C=e(V,Te,n.C),n.B=e(E,Ne,n.B),n.v=e(ne,he,n.v),n.k=e(Ee,dt,n.k),n.x=e(pe,tt,n.x),n.j=e(Oe,yt,n.j),n.q=e(Ge,b,n.q),n.z=e(B,Me,n.z),n.P=e(we,Ke,n.P),n.H=e(le,ct,n.H),n.F=e(Ze,Ct,n.F),n.M=e(Le,ut,n.M),n.D=e(et,_t,n.D),n.R=e(at,vt,n.R),n.E=e(bt,Lt,n.E),n.L=e(ft,kt,n.L),n.N=e(st,Et,n.N),n.G=e(Dt,$t,n.G),n.U=e(xt,Bt,n.U),n.K=e(Nt,h,n.K),n.V=e(At,Q,n.V),n.Y=e(It,rt,n.Y),n},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0,x:void 0,j:void 0,q:void 0,z:void 0,P:void 0,H:void 0,F:void 0,M:void 0,D:void 0,R:void 0,E:void 0,L:void 0,N:void 0,G:void 0,U:void 0,K:void 0,V:void 0,Y:void 0}),ee})(),(()=>{var ee=Yr(),Se=ee.firstChild,_e=Se.nextSibling;return e(ee,de),Se.$$click=t,i(ee,m(x,{get when(){return I.isAdmin()},get children(){var ie=Kr();return ie.$$click=()=>r.onEdit($()),s(ke=>e(ie,T,ke)),ie}}),_e),Tt(_e,"click",r.onClose,!0),s(ie=>{var ke=re,$e=re;return ie.e=e(Se,ke,ie.e),ie.t=e(_e,$e,ie.t),ie},{e:void 0,t:void 0}),ee})()]})}}),null),s($=>e(O,k,$)),O})()};Ut(["click"]);var Xr=g("<div><label>Negocio</label><select>"),Jr=g("<div><label>Tasa de Cambio (a USD)</label><input type=number step=0.0001 min=0 placeholder=1.0000>"),Zr=g("<div><span>Equivalente:</span><span>$<!> "),en=g("<div><span>C√©dula:</span><span>"),tn=g("<div><span>Tel√©fono:</span><span>"),rn=g("<div><h3>Resumen</h3><div><span>Cliente:</span><span></span></div><div><span>Cantidad:</span><span> USD"),nn=g("<button type=button>Vista Previa"),on=g('<div><h2></h2><form><div></div><div><label>Moneda</label><select required></select></div><div><label>Cantidad USD</label><input type=number step=0.01 min=0 placeholder=0.00 required></div><div><label>Referencia (Opcional)</label><input type=text placeholder="N√∫mero de referencia o descripci√≥n"></div><div><label>Notas (Opcional)</label><textarea placeholder="Notas adicionales sobre esta remesa"></textarea></div><div><button type=button>Cancelar</button><button type=submit>'),ln=g("<option>"),an=g("<option> <!> - ");const Gt=r=>{const[a,w]=K(null),[t,d]=K(0),[k,o]=K("CUP"),[U,q]=K(395),[X,J]=K(""),[W,G]=K(""),[se,N]=K(!1),[D,L]=K(I.getBusinessId()),[j,Ae]=K([]),de=()=>!!r.remittance,_=()=>I.isAdmin();Yt(async()=>{if(_()){const M=await I.getAvailableBusinesses();Ae(M)}}),lr(()=>{const M=r.remittance;M?(w(M.customer),d(M.amount),o(M.currency),q(M.exchangeRate||1),J(M.reference||""),G(M.notes||""),M.businessId&&L(M.businessId)):(w(null),d(0),o("CUP"),q(395),J(""),G(""),L(I.getBusinessId()))});const T=async M=>{if(M.preventDefault(),!a()){alert("Por favor seleccione un cliente");return}if(t()<=0){alert("Por favor ingrese una cantidad v√°lida");return}N(!0);try{if(de()){const oe={id:r.remittance.id,customer:a(),amount:t(),currency:k(),exchangeRate:U(),reference:X(),notes:W(),..._()&&{businessId:D()}};await Rt.update(oe),alert("Remesa actualizada exitosamente")}else{const oe={customer:a(),amount:t(),currency:k(),exchangeRate:U(),reference:X(),notes:W(),..._()&&{businessId:D()}},be=await Rt.create(oe),ce={...be,date:new Date,remittanceNumber:be.remittanceNumber};Lr(ce),alert("¬°Remesa creada exitosamente! Se ha descargado el recibo PDF.")}r.onSubmit?.(de()),de()||(w(null),d(0),o("USD"),q(1),J(""),G(""))}catch(oe){console.error("Error submitting remittance:",oe);const be=de()?"Error al actualizar la remesa. Por favor intente de nuevo.":"Error al crear la remesa. Por favor intente de nuevo.";alert(be)}finally{N(!1)}},re=()=>{if(!a()||t()<=0){alert("Por favor complete cliente y cantidad para ver la vista previa");return}const M={customer:a(),amount:t(),currency:k(),exchangeRate:U(),reference:X(),notes:W(),date:new Date,remittanceNumber:de()?r.remittance.remittanceNumber:Kt()};Jt(M)},H=()=>{de()||(w(null),d(0),o("CUP"),q(395),J(""),G("")),r.onCancel?.()},Ie=r.isModal?{"max-width":"600px",margin:"0 auto",padding:"0"}:{"max-width":"600px",margin:"0 auto",padding:"2rem","background-color":"white","border-radius":"8px","box-shadow":"0 4px 12px rgba(0,0,0,0.15)"},O={"font-size":"1.5rem","font-weight":"600","margin-bottom":"1.5rem","text-align":"center",color:"var(--text-primary)"},Z={"margin-bottom":"1.5rem"},Re={display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.5rem"},Be={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"4px","font-size":"1rem",background:"var(--surface-color)",color:"var(--text-primary)"},Qe={...Be,cursor:"pointer"},$={...Be,"min-height":"80px",resize:"vertical"},ee={padding:"0.75rem 1.5rem","background-color":"var(--primary-color)",color:"white",border:"none","border-radius":"4px",cursor:"pointer","font-weight":"500","margin-right":"0.5rem"},Se={...ee,"background-color":"var(--border-color)",color:"var(--text-secondary)"},_e={...ee,"background-color":"var(--secondary-color, #6b7280)",color:"white"},ie={display:"flex","justify-content":"flex-end","margin-top":"2rem"},ke={"background-color":"var(--strip-color)",padding:"1rem","border-radius":"4px","margin-bottom":"1.5rem"},$e={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"};return(()=>{var M=on(),oe=M.firstChild,be=oe.nextSibling,ce=be.firstChild,ue=ce.nextSibling,qe=ue.firstChild,Pe=qe.nextSibling,it=ue.nextSibling,mt=it.firstChild,ot=mt.nextSibling,Ue=it.nextSibling,gt=Ue.firstChild,je=gt.nextSibling,Xe=Ue.nextSibling,ht=Xe.firstChild,lt=ht.nextSibling,Ve=Xe.nextSibling,We=Ve.firstChild,Je=We.nextSibling;return i(oe,()=>de()?"Editar Remesa":"Crear Remesa"),be.addEventListener("submit",T),i(ce,m(ar,{get value(){return a()},onChange:w,label:"Seleccionar Cliente",placeholder:"Buscar clientes por nombre, tel√©fono, c√©dula...",required:!0})),i(be,m(x,{get when(){return nt(()=>!!_())()&&j().length>0},get children(){var l=Xr(),A=l.firstChild,V=A.nextSibling;return V.addEventListener("change",E=>L(E.target.value)),i(V,m(Ye,{get each(){return j()},children:E=>(()=>{var ne=ln();return i(ne,()=>E.name),s(()=>ne.value=E.id),ne})()})),s(E=>{var ne=Z,Ee=Re,pe=Qe;return E.e=e(l,ne,E.e),E.t=e(A,Ee,E.t),E.a=e(V,pe,E.a),E},{e:void 0,t:void 0,a:void 0}),s(()=>V.value=D()),l}}),ue),Pe.addEventListener("change",l=>o(l.target.value)),i(Pe,m(Ye,{each:wt,children:l=>(()=>{var A=an(),V=A.firstChild,E=V.nextSibling;return E.nextSibling,i(A,()=>l.symbol,V),i(A,()=>l.code,E),i(A,()=>l.name,null),s(()=>A.value=l.code),A})()})),ot.$$input=l=>d(parseFloat(l.target.value)||0),i(be,m(x,{get when(){return k()!=="USD"},get children(){var l=Jr(),A=l.firstChild,V=A.nextSibling;return V.$$input=E=>q(parseFloat(E.target.value)||1),s(E=>{var ne=Z,Ee=Re,pe=Be;return E.e=e(l,ne,E.e),E.t=e(A,Ee,E.t),E.a=e(V,pe,E.a),E},{e:void 0,t:void 0,a:void 0}),s(()=>V.value=U()),l}}),Ue),je.$$input=l=>J(l.target.value),lt.$$input=l=>G(l.target.value),i(be,m(x,{get when(){return nt(()=>!!a())()&&t()>0},get children(){var l=rn(),A=l.firstChild,V=A.nextSibling,E=V.firstChild,ne=E.nextSibling,Ee=V.nextSibling,pe=Ee.firstChild,Oe=pe.nextSibling,Ge=Oe.firstChild;return e(l,ke),A.style.setProperty("margin-bottom","0.75rem"),A.style.setProperty("font-weight","600"),i(ne,()=>a()?.fullName||a()?.name),i(Oe,()=>wt.find(B=>B.code===k())?.symbol,Ge),i(Oe,()=>t().toFixed(2),Ge),i(l,m(x,{get when(){return nt(()=>k()!=="USD")()&&U()!==1},get children(){var B=Zr(),we=B.firstChild,le=we.nextSibling,ze=le.firstChild,Ze=ze.nextSibling;return Ze.nextSibling,i(le,()=>(t()*U()).toFixed(2),Ze),i(le,k,null),s(Le=>e(B,$e,Le)),B}}),null),i(l,m(x,{get when(){return a()?.cid},get children(){var B=en(),we=B.firstChild,le=we.nextSibling;return i(le,()=>a()?.cid),s(ze=>e(B,$e,ze)),B}}),null),i(l,m(x,{get when(){return a()?.phoneNumber},get children(){var B=tn(),we=B.firstChild,le=we.nextSibling;return i(le,()=>a()?.phoneNumber),s(ze=>e(B,$e,ze)),B}}),null),s(B=>{var we=$e,le=$e;return B.e=e(V,we,B.e),B.t=e(Ee,le,B.t),B},{e:void 0,t:void 0}),l}}),Ve),e(Ve,ie),We.$$click=H,i(Ve,m(x,{get when(){return!de()},get children(){var l=nn();return l.$$click=re,s(A=>{var V=_e,E=se()||!a()||t()<=0;return A.e=e(l,V,A.e),E!==A.t&&(l.disabled=A.t=E),A},{e:void 0,t:void 0}),l}}),Je),i(Je,(()=>{var l=nt(()=>!!se());return()=>l()?de()?"Actualizando...":"Creando...":de()?"Actualizar Remesa":"Crear Remesa"})()),s(l=>{var A=Ie,V=O,E=Z,ne=Z,Ee=Re,pe=Qe,Oe=Z,Ge=Re,B=Be,we=Z,le=Re,ze=Be,Ze=Z,Le=Re,et=$,at=Se,bt=se(),ft=ee,st=se()||!a()||t()<=0;return l.e=e(M,A,l.e),l.t=e(oe,V,l.t),l.a=e(ce,E,l.a),l.o=e(ue,ne,l.o),l.i=e(qe,Ee,l.i),l.n=e(Pe,pe,l.n),l.s=e(it,Oe,l.s),l.h=e(mt,Ge,l.h),l.r=e(ot,B,l.r),l.d=e(Ue,we,l.d),l.l=e(gt,le,l.l),l.u=e(je,ze,l.u),l.c=e(Xe,Ze,l.c),l.w=e(ht,Le,l.w),l.m=e(lt,et,l.m),l.f=e(We,at,l.f),bt!==l.y&&(We.disabled=l.y=bt),l.g=e(Je,ft,l.g),st!==l.p&&(Je.disabled=l.p=st),l},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0}),s(()=>Pe.value=k()),s(()=>ot.value=t()),s(()=>je.value=X()),s(()=>lt.value=W()),M})()};Ut(["input","click"]);var sn=g("<div><span>Remesas"),Ht=g("<div><div>"),dn=g("<div>");const cn=()=>{const[r,a]=K("list"),[w,t]=K(null),[d,k]=K(0),o=()=>{a("list"),t(null),k(_=>_+1)},U=()=>{a("create"),t(null)},q=_=>{t(_),a("edit")},X=_=>{t(_),a("view")},J=()=>{o()},W=()=>{o()},G=()=>{o()},se=_=>{},N=_=>{q(_)},D={"min-height":"100vh","background-color":"var(--background-color)"},L={position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","z-index":"1000"},j={"background-color":"white","border-radius":"8px","max-width":"800px",width:"90%","max-height":"90%",overflow:"auto","box-shadow":"0 20px 25px -5px rgba(0, 0, 0, 0.1)",padding:"2rem"},Ae={padding:"1rem 2rem","background-color":"white","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem",color:"var(--text-muted)"},de={color:"var(--primary-color)","text-decoration":"none",cursor:"pointer"};return(()=>{var _=dn();return e(_,D),i(_,m(x,{get when(){return r()!=="list"},get children(){var T=sn(),re=T.firstChild;return e(T,Ae),re.$$click=o,e(re,de),i(T,m(x,{get when(){return r()==="create"},children:" > Nueva Remesa"}),null),i(T,m(x,{get when(){return r()==="edit"},get children(){return" > Editar > "+(w()?.remittanceNumber||"")}}),null),i(T,m(x,{get when(){return r()==="view"},get children(){return" > Ver > "+(w()?.remittanceNumber||"")}}),null),T}}),null),i(_,m(x,{get when(){return r()==="list"},get children(){return m(Ur,{get key(){return d()},onCreate:U,onEdit:q,onView:X,onDelete:se})}}),null),i(_,m(x,{get when(){return nt(()=>!!I.isAdmin())()&&r()==="create"},get children(){var T=Ht(),re=T.firstChild;return T.$$click=G,re.$$click=H=>H.stopPropagation(),i(re,m(Gt,{remittance:null,onSubmit:J,onCancel:G,isModal:!0})),s(H=>{var Ie=L,O=j;return H.e=e(T,Ie,H.e),H.t=e(re,O,H.t),H},{e:void 0,t:void 0}),T}}),null),i(_,m(x,{get when(){return nt(()=>!!I.isAdmin())()&&r()==="edit"},get children(){var T=Ht(),re=T.firstChild;return T.$$click=G,re.$$click=H=>H.stopPropagation(),i(re,m(Gt,{get remittance(){return w()},onSubmit:W,onCancel:G,isModal:!0})),s(H=>{var Ie=L,O=j;return H.e=e(T,Ie,H.e),H.t=e(re,O,H.t),H},{e:void 0,t:void 0}),T}}),null),i(_,m(x,{get when(){return nt(()=>r()==="view")()&&w()},get children(){return m(Qr,{get remittanceId(){return w().id},get remittance(){return w()},onEdit:N,onClose:G})}}),null),_})()};Ut(["click"]);const vn=()=>m(cn,{});export{vn as default};
