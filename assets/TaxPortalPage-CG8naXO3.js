import{c as _,A as Pt,t as g,h as a,i as e,a as n,B as T,b as C,S as h,x as Rt,r as I,F as ue,v as Ne,V as Tt,d as $t,u as Bt,a1 as gt,M as At,j as mt}from"./index-DsjFW37z.js";import{g as Ft,a as Lt,b as vt,i as It,f as ft,c as Mt,d as Ut,s as jt,e as Vt,h as Xt,j as Yt,k as Ot,l as Ht,m as qt}from"./taxPortalApi-BeYQIJCF.js";import{a as Gt,A as at,V as ht}from"./drakeTypes-DcjcYEfx.js";var dt=g("<div>"),Qt=g("<div><h4>Nueva Solicitud de Documentos</h4><div><div></div></div><div><label>Verificacion de Informacion (Formularios)</label><div></div></div><div><label>Documentos a Subir (Archivos)</label><div></div></div><div>"),Wt=g("<div><p>Cargando solicitudes..."),Kt=g("<div><p>No hay solicitudes de documentos</p><p>Cree una nueva solicitud para que el cliente suba sus documentos fiscales."),Zt=g("<div><div><h3>Solicitudes de Documentos"),Jt=g('<div><input type=checkbox><span><svg viewBox="0 0 20 20"fill=#8b5cf6><path fill-rule=evenodd d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z"clip-rule=evenodd>'),er=g('<div><input type=checkbox><span><svg viewBox="0 0 20 20"fill=#3b82f6><path fill-rule=evenodd d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z"clip-rule=evenodd>'),bt=g('<svg width=16 height=16 viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2><polyline points="20 6 9 17 4 12">'),tr=g('<div><img alt="QR Code">'),rr=g('<svg width=16 height=16 viewBox="0 0 24 24"fill=currentColor><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z">'),lr=g("<div>Ultimo acceso: "),ir=g("<div><strong>Instrucciones:</strong> "),nr=g('<div><div><div><div>Enlace Magico</div><div><div></div><button title="Copiar enlace"></button></div></div><div><div>Codigo PIN</div><div><div></div><button title="Copiar PIN"></button></div><div>Usar en: </div></div><div><div>Codigo QR</div></div></div><div><div>Documentos Solicitados</div><div></div></div><div></div><div><div>Creado: </div><div>Por: '),sr=g('<div><div><div><span></span><span>Ano </span><div><div></div></div><span>%</span></div><div><span></span><svg width=16 height=16 viewBox="0 0 16 16"><path d="M4 6L8 10L12 6"stroke=currentColor stroke-width=1.5 stroke-linecap=round stroke-linejoin=round fill=none>'),xt=g('<svg width=16 height=16 viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2><rect x=9 y=9 width=13 height=13 rx=2 ry=2></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1">'),or=g("<span> ");const ar=R=>{const[G,B]=_([]),[re,P]=_(!1),[le,M]=_(null),[pe,A]=_(null),[ie,ge]=_(!1),[Q,ne]=_(2024),[F,b]=_(Gt.filter(l=>l.required).map(l=>l.type)),[D,me]=_(""),[De,Re]=_(!1),[ve,He]=_(null),[se,Te]=_(null);Pt(()=>{console.log(R.taxPortal),R.taxPortal?.id&&oe()});const oe=async()=>{P(!0),M(null);try{const l=await Ft(R.taxPortal.id);B(l)}catch(l){M("Error al cargar las solicitudes"),console.error("Error loading requests:",l)}finally{P(!1)}},qe=async()=>{Re(!0),M(null);try{const l=at.filter(d=>F().includes(d.type)).map(d=>({...d,required:!0,uploaded:!1})),r=await Ut(R.taxPortal,{taxYear:Q(),requestedDocuments:l,instructions:D()||void 0});B(d=>[r,...d]),ge(!1),me(""),A("Solicitud creada exitosamente"),setTimeout(()=>A(null),3e3),R.onRequestCreated?.(r)}catch(l){M("Error al crear la solicitud"),console.error("Error creating request:",l)}finally{Re(!1)}},Be=async l=>{if(confirm("Esta seguro de cancelar esta solicitud?"))try{await Vt(l),B(r=>r.map(d=>d.id===l?{...d,status:"cancelled"}:d)),A("Solicitud cancelada"),setTimeout(()=>A(null),3e3)}catch{M("Error al cancelar la solicitud")}},Ge=async l=>{if(confirm("Esta seguro de eliminar esta solicitud? Esta accion no se puede deshacer."))try{await Xt(l),B(r=>r.filter(d=>d.id!==l)),A("Solicitud eliminada"),setTimeout(()=>A(null),3e3)}catch{M("Error al eliminar la solicitud")}},Qe=async l=>{try{await jt(l),B(r=>r.map(d=>d.id===l?{...d,remindersSent:(d.remindersSent||0)+1}:d)),A("Recordatorio enviado"),setTimeout(()=>A(null),3e3)}catch{M("Error al enviar el recordatorio")}},Ae=async(l,r)=>{try{await navigator.clipboard.writeText(l),Te(r),setTimeout(()=>Te(null),2e3)}catch(d){console.error("Error copying to clipboard:",d)}},We=l=>{const r=l.clientPhone?.replace(/\D/g,"")||"",d=vt(l.accessToken),i=encodeURIComponent(`Hola ${l.clientName}, necesitamos que suba sus documentos fiscales para el ano ${l.taxYear}.

Puede acceder usando este enlace: ${d}

O ingrese con el PIN: ${l.accessPin}

La solicitud expira en: ${ft(l.expiresAt)}`),t=r?`https://wa.me/${r}?text=${i}`:`https://wa.me/?text=${i}`;window.open(t,"_blank")},y=l=>{const r={pending:{label:"Pendiente",color:"#F59E0B",bg:"rgba(245, 158, 11, 0.15)"},partial:{label:"Parcial",color:"#3B82F6",bg:"rgba(59, 130, 246, 0.15)"},complete:{label:"Completo",color:"#10B981",bg:"rgba(16, 185, 129, 0.15)"},expired:{label:"Expirado",color:"#EF4444",bg:"rgba(239, 68, 68, 0.15)"},cancelled:{label:"Cancelado",color:"#6B7280",bg:"rgba(107, 114, 128, 0.15)"}};return r[l]||r.pending},v=l=>{b(r=>r.includes(l)?r.filter(d=>d!==l):[...r,l])},Fe={display:"flex","flex-direction":"column",gap:"1rem"},ae={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},Le={"font-size":"1.125rem","font-weight":"600",color:"var(--text-primary, #1f2937)",margin:"0"},W=l=>({padding:"0.75rem 1rem","border-radius":"6px","font-size":"0.875rem",background:l==="success"?"rgba(16, 185, 129, 0.1)":"rgba(239, 68, 68, 0.1)",color:l==="success"?"#10B981":"#EF4444",border:`1px solid ${l==="success"?"#10B981":"#EF4444"}`,"margin-bottom":"1rem"}),fe={padding:"1rem",background:"var(--surface-alt, #f9fafb)","border-radius":"8px",border:"1px solid var(--border-color, #e5e7eb)","margin-bottom":"1rem"},he={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem","margin-bottom":"1rem"},X={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(200px, 1fr))",gap:"0.5rem","margin-bottom":"1rem"},be=l=>({display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 0.75rem",background:l?"rgba(59, 130, 246, 0.1)":"var(--surface-color, #ffffff)",border:`1px solid ${l?"#3B82F6":"var(--border-color, #e5e7eb)"}`,"border-radius":"6px",cursor:"pointer","font-size":"0.875rem",transition:"all 0.2s ease"}),xe=l=>({background:"var(--surface-color, #ffffff)",border:"1px solid var(--border-color, #e5e7eb)","border-radius":"8px",overflow:"hidden",transition:"box-shadow 0.2s ease","box-shadow":l?"var(--shadow-md, 0 4px 6px rgba(0, 0, 0, 0.1))":"none"}),K={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",cursor:"pointer","user-select":"none"},Ie={display:"flex","align-items":"center",gap:"1rem"},Pe=l=>({display:"inline-flex","align-items":"center",padding:"0.25rem 0.625rem","border-radius":"9999px",background:l.bg,color:l.color,"font-size":"0.75rem","font-weight":"600"}),Z={width:"100px",height:"6px",background:"var(--border-color, #e5e7eb)","border-radius":"3px",overflow:"hidden"},Me=l=>({width:`${l}%`,height:"100%",background:l===100?"#10B981":"#3B82F6",transition:"width 0.3s ease"}),Ue={padding:"1rem","border-top":"1px solid var(--border-color, #e5e7eb)",background:"var(--surface-alt, #f9fafb)"},J={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem","margin-bottom":"1rem"},de={padding:"1rem",background:"var(--surface-color, #ffffff)","border-radius":"8px",border:"1px solid var(--border-color, #e5e7eb)"},ee={"font-size":"0.75rem","font-weight":"600","text-transform":"uppercase","letter-spacing":"0.05em",color:"var(--text-secondary, #6B7280)","margin-bottom":"0.5rem"},Y={display:"flex","align-items":"center",gap:"0.5rem"},je={flex:"1",padding:"0.5rem",background:"var(--surface-alt, #f9fafb)","border-radius":"4px","font-family":"monospace","font-size":"0.875rem",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},$e=l=>({padding:"0.5rem",background:l?"#10B981":"var(--primary-color, #3B82F6)",color:"#ffffff",border:"none","border-radius":"4px",cursor:"pointer",display:"flex","align-items":"center","justify-content":"center",transition:"background 0.2s ease"}),ce={display:"flex","justify-content":"center","align-items":"center",padding:"1rem",background:"#ffffff","border-radius":"8px"},Ke={display:"flex",gap:"0.5rem","flex-wrap":"wrap","margin-top":"1rem"},Ce={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)","font-size":"0.875rem"},s={"text-align":"center",padding:"2rem",color:"var(--text-secondary, #6B7280)"},c=[{value:"2023",label:"2023"},{value:"2024",label:"2024"},{value:"2025",label:"2025"},{value:"2026",label:"2026"}];return(()=>{var l=Zt(),r=l.firstChild,d=r.firstChild;return a(r,ae),a(d,Le),e(r,n(T,{get variant(){return ie()?"secondary":"primary"},size:"sm",onClick:()=>ge(!ie()),get children(){return ie()?"Cancelar":"+ Nueva Solicitud"}}),null),e(l,n(h,{get when(){return le()},get children(){var i=dt();return e(i,le),C(t=>a(i,W("error"),t)),i}}),null),e(l,n(h,{get when(){return pe()},get children(){var i=dt();return e(i,pe),C(t=>a(i,W("success"),t)),i}}),null),e(l,n(h,{get when(){return ie()},get children(){var i=Qt(),t=i.firstChild,p=t.nextSibling,w=p.firstChild,m=p.nextSibling,f=m.firstChild,x=f.nextSibling,N=m.nextSibling,U=N.firstChild,O=U.nextSibling,L=N.nextSibling;return a(i,fe),t.style.setProperty("margin","0 0 1rem 0"),t.style.setProperty("font-size","1rem"),a(p,he),e(p,n(Rt,{label:"Ano Fiscal",get value(){return Q().toString()},onChange:u=>ne(parseInt(u)),options:c,required:!0}),w),e(w,n(I,{label:"Instrucciones (opcional)",get value(){return D()},onChange:me,placeholder:"Instrucciones adicionales para el cliente..."})),e(x,n(ue,{get each(){return at.filter(u=>ht.includes(u.type))},children:u=>(()=>{var k=Jt(),z=k.firstChild,S=z.nextSibling,j=S.firstChild;return k.$$click=()=>v(u.type),z.addEventListener("change",()=>v(u.type)),S.style.setProperty("display","flex"),S.style.setProperty("align-items","center"),S.style.setProperty("gap","0.375rem"),j.style.setProperty("width","14px"),j.style.setProperty("height","14px"),e(S,()=>u.label,null),C(H=>a(k,{...be(F().includes(u.type)),background:F().includes(u.type)?"rgba(139, 92, 246, 0.1)":"var(--surface-alt, #f9fafb)",border:F().includes(u.type)?"2px solid #8b5cf6":"1px solid var(--border-color, #e5e7eb)"},H)),C(()=>z.checked=F().includes(u.type)),k})()})),e(O,n(ue,{get each(){return at.filter(u=>!ht.includes(u.type))},children:u=>(()=>{var k=er(),z=k.firstChild,S=z.nextSibling,j=S.firstChild;return k.$$click=()=>v(u.type),z.addEventListener("change",()=>v(u.type)),S.style.setProperty("display","flex"),S.style.setProperty("align-items","center"),S.style.setProperty("gap","0.375rem"),j.style.setProperty("width","14px"),j.style.setProperty("height","14px"),e(S,()=>u.label,null),C(H=>a(k,be(F().includes(u.type)),H)),C(()=>z.checked=F().includes(u.type)),k})()})),L.style.setProperty("display","flex"),L.style.setProperty("gap","0.5rem"),L.style.setProperty("justify-content","flex-end"),e(L,n(T,{variant:"secondary",size:"sm",onClick:()=>ge(!1),children:"Cancelar"}),null),e(L,n(T,{variant:"primary",size:"sm",onClick:qe,get disabled(){return De()||F().length===0},get children(){return De()?"Creando...":"Crear Solicitud"}}),null),C(u=>{var k=Ce,z=X,S=Ce,j=X;return u.e=a(f,k,u.e),u.t=a(x,z,u.t),u.a=a(U,S,u.a),u.o=a(O,j,u.o),u},{e:void 0,t:void 0,a:void 0,o:void 0}),i}}),null),e(l,n(h,{get when(){return re()},get children(){var i=Wt();return C(t=>a(i,s,t)),i}}),null),e(l,n(h,{get when(){return Ne(()=>!re())()&&G().length===0},get children(){var i=Kt(),t=i.firstChild,p=t.nextSibling;return p.style.setProperty("font-size","0.875rem"),p.style.setProperty("margin-top","0.5rem"),C(w=>a(i,s,w)),i}}),null),e(l,n(h,{get when(){return Ne(()=>!re())()&&G().length>0},get children(){var i=dt();return i.style.setProperty("display","flex"),i.style.setProperty("flex-direction","column"),i.style.setProperty("gap","0.75rem"),e(i,n(ue,{get each(){return G()},children:t=>{const p=()=>ve()===t.id,w=y(t.status),m=Lt(t),f=vt(t.accessToken),x=It(t);return(()=>{var N=sr(),U=N.firstChild,O=U.firstChild,L=O.firstChild,u=L.nextSibling;u.firstChild;var k=u.nextSibling,z=k.firstChild,S=k.nextSibling,j=S.firstChild,H=O.nextSibling,Ve=H.firstChild,Ze=Ve.nextSibling;return U.$$click=()=>He(p()?null:t.id),a(O,Ie),e(L,()=>w.label),u.style.setProperty("font-weight","500"),e(u,()=>t.taxYear,null),a(k,Z),S.style.setProperty("font-size","0.75rem"),S.style.setProperty("color","var(--text-secondary)"),e(S,m,j),H.style.setProperty("display","flex"),H.style.setProperty("align-items","center"),H.style.setProperty("gap","0.75rem"),Ve.style.setProperty("font-size","0.75rem"),Ve.style.setProperty("color","var(--text-secondary)"),e(Ve,()=>ft(t.expiresAt)),Ze.style.setProperty("transition","transform 0.2s ease"),e(N,n(h,{get when(){return p()},get children(){var E=nr(),_e=E.firstChild,Se=_e.firstChild,Xe=Se.firstChild,Ye=Xe.nextSibling,te=Ye.firstChild,Je=te.nextSibling,et=Se.nextSibling,yt=et.firstChild,tt=yt.nextSibling,rt=tt.firstChild,lt=rt.nextSibling,we=tt.nextSibling;we.firstChild;var it=et.nextSibling,Ct=it.firstChild,nt=_e.nextSibling,ut=nt.firstChild,Oe=ut.nextSibling,ye=nt.nextSibling,q=ye.nextSibling,st=q.firstChild;st.firstChild;var pt=st.nextSibling;return pt.firstChild,a(E,Ue),a(_e,J),e(te,f),Je.$$click=()=>Ae(f,`link-${t.id}`),e(Je,n(h,{get when(){return se()===`link-${t.id}`},get fallback(){return xt()},get children(){return bt()}})),e(rt,()=>t.accessPin),lt.$$click=()=>Ae(t.accessPin,`pin-${t.id}`),e(lt,n(h,{get when(){return se()===`pin-${t.id}`},get fallback(){return xt()},get children(){return bt()}})),we.style.setProperty("font-size","0.75rem"),we.style.setProperty("color","var(--text-secondary)"),we.style.setProperty("margin-top","0.5rem"),e(we,Mt,null),e(it,n(h,{get when(){return t.qrCodeUrl},get children(){var o=tr(),$=o.firstChild;return a(o,ce),$.style.setProperty("width","150px"),$.style.setProperty("height","150px"),C(()=>Tt($,"src",t.qrCodeUrl)),o}}),null),nt.style.setProperty("margin-bottom","1rem"),Oe.style.setProperty("display","flex"),Oe.style.setProperty("flex-wrap","wrap"),Oe.style.setProperty("gap","0.5rem"),e(Oe,n(ue,{get each(){return t.requestedDocuments},children:o=>(()=>{var $=or(),ot=$.firstChild;return $.style.setProperty("padding","0.25rem 0.5rem"),$.style.setProperty("border-radius","4px"),$.style.setProperty("font-size","0.75rem"),e($,()=>o.uploaded?"OK":o.required?"*":"",ot),e($,()=>o.label,null),C(V=>{var ke=o.uploaded?"rgba(16, 185, 129, 0.1)":o.required?"rgba(239, 68, 68, 0.1)":"rgba(107, 114, 128, 0.1)",ze=o.uploaded?"#10B981":o.required?"#EF4444":"#6B7280",Ee=`1px solid ${o.uploaded?"#10B981":o.required?"#EF4444":"#6B7280"}`;return ke!==V.e&&((V.e=ke)!=null?$.style.setProperty("background",ke):$.style.removeProperty("background")),ze!==V.t&&((V.t=ze)!=null?$.style.setProperty("color",ze):$.style.removeProperty("color")),Ee!==V.a&&((V.a=Ee)!=null?$.style.setProperty("border",Ee):$.style.removeProperty("border")),V},{e:void 0,t:void 0,a:void 0}),$})()})),e(ye,n(T,{variant:"primary",size:"sm",onClick:()=>We(t),get children(){return[rr(),"WhatsApp"]}}),null),e(ye,n(h,{get when(){return t.status!=="complete"&&t.status!=="cancelled"&&!x},get children(){return n(T,{variant:"secondary",size:"sm",onClick:()=>Qe(t.id),get children(){return["Enviar Recordatorio",Ne(()=>t.remindersSent?` (${t.remindersSent})`:"")]}})}}),null),e(ye,n(h,{get when(){return t.status==="pending"||t.status==="partial"},get children(){return n(T,{variant:"outline",size:"sm",onClick:()=>Be(t.id),children:"Cancelar"})}}),null),e(ye,n(h,{get when(){return t.status==="cancelled"||t.status==="expired"},get children(){return n(T,{variant:"danger",size:"sm",onClick:()=>Ge(t.id),children:"Eliminar"})}}),null),q.style.setProperty("margin-top","1rem"),q.style.setProperty("padding-top","1rem"),q.style.setProperty("border-top","1px solid var(--border-color)"),q.style.setProperty("font-size","0.75rem"),q.style.setProperty("color","var(--text-secondary)"),e(st,()=>new Date(t.createdAt).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),null),e(pt,()=>t.requestedByName,null),e(q,n(h,{get when(){return t.lastAccessedAt},get children(){var o=lr();return o.firstChild,e(o,()=>new Date(t.lastAccessedAt).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),null),o}}),null),e(q,n(h,{get when(){return t.instructions},get children(){var o=ir(),$=o.firstChild;return $.nextSibling,o.style.setProperty("margin-top","0.5rem"),e(o,()=>t.instructions,null),o}}),null),C(o=>{var $=de,ot=ee,V=Y,ke=je,ze=$e(se()===`link-${t.id}`),Ee=de,_t=ee,St=Y,wt={...je,"font-size":"1.25rem","font-weight":"700","letter-spacing":"0.1em","text-align":"center"},kt=$e(se()===`pin-${t.id}`),zt=de,Et=ee,Nt=ee,Dt=Ke;return o.e=a(Se,$,o.e),o.t=a(Xe,ot,o.t),o.a=a(Ye,V,o.a),o.o=a(te,ke,o.o),o.i=a(Je,ze,o.i),o.n=a(et,Ee,o.n),o.s=a(yt,_t,o.s),o.h=a(tt,St,o.h),o.r=a(rt,wt,o.r),o.d=a(lt,kt,o.d),o.l=a(it,zt,o.l),o.u=a(Ct,Et,o.u),o.c=a(ut,Nt,o.c),o.w=a(ye,Dt,o.w),o},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),E}}),null),C(E=>{var _e=xe(p()),Se=K,Xe=Pe(w),Ye=Me(m),te=p()?"rotate(180deg)":"rotate(0deg)";return E.e=a(N,_e,E.e),E.t=a(U,Se,E.t),E.a=a(L,Xe,E.a),E.o=a(z,Ye,E.o),te!==E.i&&((E.i=te)!=null?Ze.style.setProperty("transform",te):Ze.style.removeProperty("transform")),E},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),N})()}})),i}}),null),C(i=>a(l,Fe,i)),l})()};$t(["click"]);var dr=g("<div><div>Loading..."),ct=g("<div>"),cr=g("<div>No tax clients found"),yr=g("<div><h2> "),ur=g("<div><div><div>Email</div><div></div></div><div><div>Phone</div><div></div></div><div><div>SSN</div><div></div></div><div><div>Address</div><div>"),pr=g("<div><div>"),gr=g("<div>Select a client to manage document requests"),mr=g("<div><div><div>"),vr=g("<div>No document requests yet. Create one from a client's profile."),fr=g("<div><div><div><h1>Tax Portal</h1><p>Manage tax clients and document requests</p></div><div></div></div><div><div><div></div><div>Tax Clients</div></div><div><div></div><div>Pending Requests</div></div><div><div></div><div>Partial Uploads</div></div><div><div></div><div>Complete</div></div></div><div><button>Tax Clients (<!>)</button><button>Document Requests (<!>)"),hr=g("<div> documents"),br=g("<div><div><div><div> </div><div></div></div><button>x"),xr=g("<div><div><div></div><div>Tax Year <!> - Created </div></div><div>"),Pr=g("<div><div><span>Upload Progress</span><span> / <!> documents</span></div><div><div>");const Sr=()=>{Bt();const[R,G]=_([]),[B,re]=_([]),[P,le]=_(null),[M,pe]=_(!0),[A,ie]=_(""),[ge,Q]=_(!1),[ne,F]=_("portals"),[b,D]=_({firstName:"",lastName:"",email:"",phone:"",ssn:"",address:"",city:"",state:"",zipCode:""});Pt(async()=>{pe(!0);try{const[y,v]=await Promise.all([Yt(),Ot()]);G(y),re(v)}catch(y){console.error("Error loading data:",y)}finally{pe(!1)}});const me=()=>{const y=A().toLowerCase();return y?R().filter(v=>v.firstName.toLowerCase().includes(y)||v.lastName.toLowerCase().includes(y)||v.email?.toLowerCase().includes(y)||v.phone?.includes(y)):R()},De=async()=>{try{const y=await Ht(b());G([y,...R()]),Q(!1),D({firstName:"",lastName:"",email:"",phone:"",ssn:"",address:"",city:"",state:"",zipCode:""}),le(y)}catch(y){console.error("Error creating portal:",y),alert("Error al crear el portal")}},Re=async y=>{if(confirm("Are you sure you want to delete this tax portal?"))try{await qt(y),G(R().filter(v=>v.id!==y)),P()?.id===y&&le(null)}catch(v){console.error("Error deleting portal:",v)}},ve=()=>{const y=B();return{pending:y.filter(v=>v.status==="pending").length,partial:y.filter(v=>v.status==="partial").length,complete:y.filter(v=>v.status==="complete").length,expired:y.filter(v=>v.status==="expired").length}},He={padding:"1.5rem","max-width":"1400px",margin:"0 auto"},se={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1.5rem","flex-wrap":"wrap",gap:"1rem"},Te={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem","margin-bottom":"1.5rem"},oe=y=>({background:"var(--surface-color)",border:"1px solid var(--border-color)","border-left":`4px solid ${y}`,"border-radius":"var(--border-radius-md)",padding:"1rem","text-align":"center"}),qe={display:"flex",gap:"0.5rem","margin-bottom":"1.5rem","border-bottom":"1px solid var(--border-color)","padding-bottom":"0.5rem"},Be=y=>({padding:"0.75rem 1.5rem",background:y?"var(--primary-color)":"transparent",color:y?"white":"var(--text-primary)",border:"none","border-radius":"var(--border-radius-md)",cursor:"pointer","font-weight":"500",transition:"all 0.2s"}),Ge={display:"grid","grid-template-columns":P()?"350px 1fr":"1fr",gap:"1.5rem"},Qe={display:"flex","flex-direction":"column",gap:"0.75rem","max-height":"70vh","overflow-y":"auto"},Ae=y=>({background:y?"var(--primary-color)":"var(--surface-color)",color:y?"white":"var(--text-primary)",border:`1px solid ${y?"var(--primary-color)":"var(--border-color)"}`,"border-radius":"var(--border-radius-md)",padding:"1rem",cursor:"pointer",transition:"all 0.2s"}),We={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"};return(()=>{var y=fr(),v=y.firstChild,Fe=v.firstChild,ae=Fe.firstChild,Le=ae.nextSibling,W=Fe.nextSibling,fe=v.nextSibling,he=fe.firstChild,X=he.firstChild,be=X.nextSibling,xe=he.nextSibling,K=xe.firstChild,Ie=K.nextSibling,Pe=xe.nextSibling,Z=Pe.firstChild,Me=Z.nextSibling,Ue=Pe.nextSibling,J=Ue.firstChild,de=J.nextSibling,ee=fe.nextSibling,Y=ee.firstChild,je=Y.firstChild,$e=je.nextSibling;$e.nextSibling;var ce=Y.nextSibling,Ke=ce.firstChild,Ce=Ke.nextSibling;return Ce.nextSibling,a(y,He),a(v,se),ae.style.setProperty("font-size","1.75rem"),ae.style.setProperty("font-weight","700"),ae.style.setProperty("margin","0 0 0.25rem 0"),Le.style.setProperty("color","var(--text-muted)"),Le.style.setProperty("margin","0"),W.style.setProperty("display","flex"),W.style.setProperty("gap","0.75rem"),e(W,n(gt,{href:"/accounting/drake-export",style:{"text-decoration":"none"},get children(){return n(T,{variant:"secondary",children:"Drake Export"})}}),null),e(W,n(T,{onClick:()=>Q(!0),children:"+ New Client"}),null),a(fe,Te),X.style.setProperty("font-size","2rem"),X.style.setProperty("font-weight","700"),X.style.setProperty("color","#3b82f6"),e(X,()=>R().length),be.style.setProperty("font-size","0.875rem"),be.style.setProperty("color","var(--text-muted)"),K.style.setProperty("font-size","2rem"),K.style.setProperty("font-weight","700"),K.style.setProperty("color","#f59e0b"),e(K,()=>ve().pending),Ie.style.setProperty("font-size","0.875rem"),Ie.style.setProperty("color","var(--text-muted)"),Z.style.setProperty("font-size","2rem"),Z.style.setProperty("font-weight","700"),Z.style.setProperty("color","#8b5cf6"),e(Z,()=>ve().partial),Me.style.setProperty("font-size","0.875rem"),Me.style.setProperty("color","var(--text-muted)"),J.style.setProperty("font-size","2rem"),J.style.setProperty("font-weight","700"),J.style.setProperty("color","#22c55e"),e(J,()=>ve().complete),de.style.setProperty("font-size","0.875rem"),de.style.setProperty("color","var(--text-muted)"),a(ee,qe),Y.$$click=()=>F("portals"),e(Y,()=>R().length,$e),ce.$$click=()=>F("requests"),e(ce,()=>B().length,Ce),e(y,n(h,{get when(){return M()},get children(){var s=dr(),c=s.firstChild;return s.style.setProperty("text-align","center"),s.style.setProperty("padding","3rem"),c.style.setProperty("font-size","1.5rem"),c.style.setProperty("color","var(--text-muted)"),s}}),null),e(y,n(At,{get isOpen(){return ge()},onClose:()=>Q(!1),title:"New Tax Client",maxWidth:"600px",get children(){return[(()=>{var s=ct();return a(s,We),e(s,n(I,{label:"First Name *",get value(){return b().firstName},onChange:c=>D({...b(),firstName:c})}),null),e(s,n(I,{label:"Last Name *",get value(){return b().lastName},onChange:c=>D({...b(),lastName:c})}),null),e(s,n(I,{label:"Email",type:"email",get value(){return b().email},onChange:c=>D({...b(),email:c})}),null),e(s,n(I,{label:"Phone",get value(){return b().phone},onChange:c=>D({...b(),phone:c})}),null),e(s,n(I,{label:"SSN",placeholder:"XXX-XX-XXXX",get value(){return b().ssn},onChange:c=>D({...b(),ssn:c})}),null),e(s,n(I,{label:"Address",get value(){return b().address},onChange:c=>D({...b(),address:c})}),null),e(s,n(I,{label:"City",get value(){return b().city},onChange:c=>D({...b(),city:c})}),null),e(s,n(I,{label:"State",get value(){return b().state},onChange:c=>D({...b(),state:c})}),null),e(s,n(I,{label:"Zip Code",get value(){return b().zipCode},onChange:c=>D({...b(),zipCode:c})}),null),s})(),(()=>{var s=ct();return s.style.setProperty("display","flex"),s.style.setProperty("gap","1rem"),s.style.setProperty("justify-content","flex-end"),s.style.setProperty("margin-top","1.5rem"),e(s,n(T,{variant:"secondary",onClick:()=>Q(!1),children:"Cancel"}),null),e(s,n(T,{onClick:De,get disabled(){return!b().firstName||!b().lastName},children:"Create Client"}),null),s})()]}}),null),e(y,n(h,{get when(){return!M()},get children(){return[n(h,{get when(){return ne()==="portals"},get children(){var s=mr(),c=s.firstChild,l=c.firstChild;return e(c,n(I,{placeholder:"Search clients...",get value(){return A()},onChange:r=>ie(r),style:{"margin-bottom":"1rem"}}),l),a(l,Qe),e(l,n(h,{get when(){return me().length===0},get children(){var r=cr();return r.style.setProperty("text-align","center"),r.style.setProperty("padding","2rem"),r.style.setProperty("color","var(--text-muted)"),r}}),null),e(l,n(ue,{get each(){return me()},children:r=>(()=>{var d=br(),i=d.firstChild,t=i.firstChild,p=t.firstChild,w=p.firstChild,m=p.nextSibling,f=t.nextSibling;return d.$$click=()=>le(r),i.style.setProperty("display","flex"),i.style.setProperty("justify-content","space-between"),i.style.setProperty("align-items","flex-start"),p.style.setProperty("font-weight","600"),p.style.setProperty("margin-bottom","0.25rem"),e(p,()=>r.firstName,w),e(p,()=>r.lastName,null),m.style.setProperty("font-size","0.875rem"),m.style.setProperty("opacity","0.8"),e(m,()=>r.email||r.phone||"No contact info"),e(t,n(h,{get when(){return r.documentCount},get children(){var x=hr(),N=x.firstChild;return x.style.setProperty("font-size","0.75rem"),x.style.setProperty("margin-top","0.5rem"),x.style.setProperty("opacity","0.7"),e(x,()=>r.documentCount,N),x}}),null),f.$$click=x=>{x.stopPropagation(),Re(r.id)},f.style.setProperty("background","none"),f.style.setProperty("border","none"),f.style.setProperty("cursor","pointer"),f.style.setProperty("opacity","0.6"),f.style.setProperty("font-size","1.25rem"),C(x=>a(d,Ae(P()?.id===r.id),x)),d})()}),null),e(s,n(h,{get when(){return P()},get children(){var r=pr(),d=r.firstChild;return e(r,n(mt,{get children(){return[(()=>{var i=yr(),t=i.firstChild,p=t.firstChild;return i.style.setProperty("display","flex"),i.style.setProperty("justify-content","space-between"),i.style.setProperty("align-items","center"),i.style.setProperty("margin-bottom","1rem"),t.style.setProperty("margin","0"),e(t,()=>P().firstName,p),e(t,()=>P().lastName,null),e(i,n(gt,{get href(){return`/accounting/drake-export?client=${P().id}`},style:{"text-decoration":"none"},get children(){return n(T,{variant:"secondary",size:"sm",children:"Open in Drake Export"})}}),null),i})(),(()=>{var i=ur(),t=i.firstChild,p=t.firstChild,w=p.nextSibling,m=t.nextSibling,f=m.firstChild,x=f.nextSibling,N=m.nextSibling,U=N.firstChild,O=U.nextSibling,L=N.nextSibling,u=L.firstChild,k=u.nextSibling;return i.style.setProperty("display","grid"),i.style.setProperty("grid-template-columns","repeat(2, 1fr)"),i.style.setProperty("gap","1rem"),i.style.setProperty("margin-bottom","1.5rem"),p.style.setProperty("font-size","0.75rem"),p.style.setProperty("color","var(--text-muted)"),e(w,()=>P().email||"-"),f.style.setProperty("font-size","0.75rem"),f.style.setProperty("color","var(--text-muted)"),e(x,()=>P().phone||"-"),U.style.setProperty("font-size","0.75rem"),U.style.setProperty("color","var(--text-muted)"),e(O,(()=>{var z=Ne(()=>!!P().ssn);return()=>z()?`***-**-${P().ssn.slice(-4)}`:"-"})()),u.style.setProperty("font-size","0.75rem"),u.style.setProperty("color","var(--text-muted)"),e(k,(()=>{var z=Ne(()=>!!P().address);return()=>z()?`${P().address}, ${P().city}, ${P().state} ${P().zipCode}`:"-"})()),i})()]}}),d),d.style.setProperty("margin-top","1.5rem"),e(d,n(ar,{get taxPortal(){return P()},onRequestCreated:i=>re([i,...B()])})),r}}),null),e(s,n(h,{get when(){return!P()},get children(){var r=gr();return r.style.setProperty("display","flex"),r.style.setProperty("align-items","center"),r.style.setProperty("justify-content","center"),r.style.setProperty("background","var(--surface-color)"),r.style.setProperty("border","1px solid var(--border-color)"),r.style.setProperty("border-radius","var(--border-radius-md)"),r.style.setProperty("padding","3rem"),r.style.setProperty("color","var(--text-muted)"),r}}),null),C(r=>a(s,Ge,r)),s}}),n(h,{get when(){return ne()==="requests"},get children(){var s=ct();return s.style.setProperty("display","flex"),s.style.setProperty("flex-direction","column"),s.style.setProperty("gap","1rem"),e(s,n(h,{get when(){return B().length===0},get children(){var c=vr();return c.style.setProperty("text-align","center"),c.style.setProperty("padding","3rem"),c.style.setProperty("color","var(--text-muted)"),c}}),null),e(s,n(ue,{get each(){return B()},children:c=>{const l={pending:"#f59e0b",partial:"#8b5cf6",complete:"#22c55e",expired:"#ef4444",cancelled:"#6b7280"};return n(mt,{get children(){return[(()=>{var r=xr(),d=r.firstChild,i=d.firstChild,t=i.nextSibling,p=t.firstChild,w=p.nextSibling;w.nextSibling;var m=d.nextSibling;return r.style.setProperty("display","flex"),r.style.setProperty("justify-content","space-between"),r.style.setProperty("align-items","flex-start"),i.style.setProperty("font-weight","600"),i.style.setProperty("margin-bottom","0.25rem"),e(i,()=>c.clientName),t.style.setProperty("font-size","0.875rem"),t.style.setProperty("color","var(--text-muted)"),e(t,()=>c.taxYear,w),e(t,()=>new Date(c.createdAt).toLocaleDateString(),null),m.style.setProperty("color","white"),m.style.setProperty("padding","0.25rem 0.75rem"),m.style.setProperty("border-radius","9999px"),m.style.setProperty("font-size","0.75rem"),m.style.setProperty("font-weight","600"),m.style.setProperty("text-transform","uppercase"),e(m,()=>c.status),C(f=>(f=l[c.status])!=null?m.style.setProperty("background",f):m.style.removeProperty("background")),r})(),(()=>{var r=Pr(),d=r.firstChild,i=d.firstChild,t=i.nextSibling,p=t.firstChild,w=p.nextSibling;w.nextSibling;var m=d.nextSibling,f=m.firstChild;return r.style.setProperty("margin-top","1rem"),d.style.setProperty("display","flex"),d.style.setProperty("justify-content","space-between"),d.style.setProperty("font-size","0.875rem"),d.style.setProperty("margin-bottom","0.5rem"),e(t,()=>c.requestedDocuments.filter(x=>x.uploaded).length,p),e(t,()=>c.requestedDocuments.length,w),m.style.setProperty("height","8px"),m.style.setProperty("background","var(--border-color)"),m.style.setProperty("border-radius","4px"),m.style.setProperty("overflow","hidden"),f.style.setProperty("height","100%"),f.style.setProperty("background","var(--primary-color)"),f.style.setProperty("transition","width 0.3s"),C(x=>(x=`${c.requestedDocuments.filter(N=>N.uploaded).length/c.requestedDocuments.length*100}%`)!=null?f.style.setProperty("width",x):f.style.removeProperty("width")),r})()]}})}}),null),s}})]}}),null),C(s=>{var c=oe("#3b82f6"),l=oe("#f59e0b"),r=oe("#8b5cf6"),d=oe("#22c55e"),i=Be(ne()==="portals"),t=Be(ne()==="requests");return s.e=a(he,c,s.e),s.t=a(xe,l,s.t),s.a=a(Pe,r,s.a),s.o=a(Ue,d,s.o),s.i=a(Y,i,s.i),s.n=a(ce,t,s.n),s},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),y})()};$t(["click"]);export{Sr as default};
