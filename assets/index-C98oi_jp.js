(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}})();const zg=!1,qg=(t,e)=>t===e,Xr=Symbol("solid-proxy"),Cm=typeof Proxy=="function",Fl=Symbol("solid-track"),ca={equals:qg};let Am=Dm;const so=1,ua=2,Im={owned:null,cleanups:null,context:null,owner:null};var Vt=null;let ll=null,Gg=null,Wt=null,xr=null,xn=null,Oa=0;function ji(t,e){const r=Wt,n=Vt,o=t.length===0,i=e===void 0?n:e,a=o?Im:{owned:null,cleanups:null,context:i?i.context:null,owner:i},c=o?t:()=>t(()=>Fr(()=>Ki(a)));Vt=a,Wt=null;try{return ao(c,!0)}finally{Wt=r,Vt=n}}function ve(t,e){e=e?Object.assign({},ca,e):ca;const r={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},n=o=>(typeof o=="function"&&(o=o(r.value)),Rm(r,o));return[km.bind(r),n]}function ie(t,e,r){const n=Ic(t,e,!1,so);cs(n)}function Nn(t,e,r){Am=Kg;const n=Ic(t,e,!1,so);n.user=!0,xn?xn.push(n):cs(n)}function Ge(t,e,r){r=r?Object.assign({},ca,r):ca;const n=Ic(t,e,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=r.equals||void 0,cs(n),km.bind(n)}function xm(t){return ao(t,!1)}function Fr(t){if(Wt===null)return t();const e=Wt;Wt=null;try{return t()}finally{Wt=e}}function wc(t,e,r){const n=Array.isArray(t);let o,i=r&&r.defer;return a=>{let c;if(n){c=Array(t.length);for(let h=0;h<t.length;h++)c[h]=t[h]()}else c=t();if(i)return i=!1,a;const d=Fr(()=>e(c,o,a));return o=c,d}}function Hr(t){Nn(()=>Fr(t))}function hi(t){return Vt===null||(Vt.cleanups===null?Vt.cleanups=[t]:Vt.cleanups.push(t)),t}function Ul(){return Wt}function Em(){return Vt}function Tm(t,e){const r=Vt,n=Wt;Vt=t,Wt=null;try{return ao(e,!0)}catch(o){xc(o)}finally{Vt=r,Wt=n}}function Hg(t){const e=Wt,r=Vt;return Promise.resolve().then(()=>{Wt=e,Vt=r;let n;return ao(t,!1),Wt=Vt=null,n?n.done:void 0})}const[j2,z2]=ve(!1);function $m(t,e){const r=Symbol("context");return{id:r,Provider:Jg(r),defaultValue:t}}function Cc(t){let e;return Vt&&Vt.context&&(e=Vt.context[t.id])!==void 0?e:t.defaultValue}function Ac(t){const e=Ge(t),r=Ge(()=>jl(e()));return r.toArray=()=>{const n=r();return Array.isArray(n)?n:n!=null?[n]:[]},r}function km(){if(this.sources&&this.state)if(this.state===so)cs(this);else{const t=xr;xr=null,ao(()=>ha(this),!1),xr=t}if(Wt){const t=this.observers?this.observers.length:0;Wt.sources?(Wt.sources.push(this),Wt.sourceSlots.push(t)):(Wt.sources=[this],Wt.sourceSlots=[t]),this.observers?(this.observers.push(Wt),this.observerSlots.push(Wt.sources.length-1)):(this.observers=[Wt],this.observerSlots=[Wt.sources.length-1])}return this.value}function Rm(t,e,r){let n=t.value;return(!t.comparator||!t.comparator(n,e))&&(t.value=e,t.observers&&t.observers.length&&ao(()=>{for(let o=0;o<t.observers.length;o+=1){const i=t.observers[o],a=ll&&ll.running;a&&ll.disposed.has(i),(a?!i.tState:!i.state)&&(i.pure?xr.push(i):xn.push(i),i.observers&&Nm(i)),a||(i.state=so)}if(xr.length>1e6)throw xr=[],new Error},!1)),e}function cs(t){if(!t.fn)return;Ki(t);const e=Oa;Yg(t,t.value,e)}function Yg(t,e,r){let n;const o=Vt,i=Wt;Wt=Vt=t;try{n=t.fn(e)}catch(a){return t.pure&&(t.state=so,t.owned&&t.owned.forEach(Ki),t.owned=null),t.updatedAt=r+1,xc(a)}finally{Wt=i,Vt=o}(!t.updatedAt||t.updatedAt<=r)&&(t.updatedAt!=null&&"observers"in t?Rm(t,n):t.value=n,t.updatedAt=r)}function Ic(t,e,r,n=so,o){const i={fn:t,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:Vt,context:Vt?Vt.context:null,pure:r};return Vt===null||Vt!==Im&&(Vt.owned?Vt.owned.push(i):Vt.owned=[i]),i}function da(t){if(t.state===0)return;if(t.state===ua)return ha(t);if(t.suspense&&Fr(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<Oa);)t.state&&e.push(t);for(let r=e.length-1;r>=0;r--)if(t=e[r],t.state===so)cs(t);else if(t.state===ua){const n=xr;xr=null,ao(()=>ha(t,e[0]),!1),xr=n}}function ao(t,e){if(xr)return t();let r=!1;e||(xr=[]),xn?r=!0:xn=[],Oa++;try{const n=t();return Wg(r),n}catch(n){r||(xn=null),xr=null,xc(n)}}function Wg(t){if(xr&&(Dm(xr),xr=null),t)return;const e=xn;xn=null,e.length&&ao(()=>Am(e),!1)}function Dm(t){for(let e=0;e<t.length;e++)da(t[e])}function Kg(t){let e,r=0;for(e=0;e<t.length;e++){const n=t[e];n.user?t[r++]=n:da(n)}for(e=0;e<r;e++)da(t[e])}function ha(t,e){t.state=0;for(let r=0;r<t.sources.length;r+=1){const n=t.sources[r];if(n.sources){const o=n.state;o===so?n!==e&&(!n.updatedAt||n.updatedAt<Oa)&&da(n):o===ua&&ha(n,e)}}}function Nm(t){for(let e=0;e<t.observers.length;e+=1){const r=t.observers[e];r.state||(r.state=ua,r.pure?xr.push(r):xn.push(r),r.observers&&Nm(r))}}function Ki(t){let e;if(t.sources)for(;t.sources.length;){const r=t.sources.pop(),n=t.sourceSlots.pop(),o=r.observers;if(o&&o.length){const i=o.pop(),a=r.observerSlots.pop();n<o.length&&(i.sourceSlots[a]=n,o[n]=i,r.observerSlots[n]=a)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)Ki(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)Ki(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function Qg(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function xc(t,e=Vt){throw Qg(t)}function jl(t){if(typeof t=="function"&&!t.length)return jl(t());if(Array.isArray(t)){const e=[];for(let r=0;r<t.length;r++){const n=jl(t[r]);Array.isArray(n)?e.push.apply(e,n):e.push(n)}return e}return t}function Jg(t,e){return function(n){let o;return ie(()=>o=Fr(()=>(Vt.context={...Vt.context,[t]:n.value},Ac(()=>n.children))),void 0),o}}const Xg=Symbol("fallback");function nd(t){for(let e=0;e<t.length;e++)t[e]()}function Zg(t,e,r={}){let n=[],o=[],i=[],a=0,c=e.length>1?[]:null;return hi(()=>nd(i)),()=>{let d=t()||[],h=d.length,m,g;return d[Fl],Fr(()=>{let A,L,M,$,T,ee,ce,Z,ge;if(h===0)a!==0&&(nd(i),i=[],n=[],o=[],a=0,c&&(c=[])),r.fallback&&(n=[Xg],o[0]=ji(ne=>(i[0]=ne,r.fallback())),a=1);else if(a===0){for(o=new Array(h),g=0;g<h;g++)n[g]=d[g],o[g]=ji(_);a=h}else{for(M=new Array(h),$=new Array(h),c&&(T=new Array(h)),ee=0,ce=Math.min(a,h);ee<ce&&n[ee]===d[ee];ee++);for(ce=a-1,Z=h-1;ce>=ee&&Z>=ee&&n[ce]===d[Z];ce--,Z--)M[Z]=o[ce],$[Z]=i[ce],c&&(T[Z]=c[ce]);for(A=new Map,L=new Array(Z+1),g=Z;g>=ee;g--)ge=d[g],m=A.get(ge),L[g]=m===void 0?-1:m,A.set(ge,g);for(m=ee;m<=ce;m++)ge=n[m],g=A.get(ge),g!==void 0&&g!==-1?(M[g]=o[m],$[g]=i[m],c&&(T[g]=c[m]),g=L[g],A.set(ge,g)):i[m]();for(g=ee;g<h;g++)g in M?(o[g]=M[g],i[g]=$[g],c&&(c[g]=T[g],c[g](g))):o[g]=ji(_);o=o.slice(0,a=h),n=d.slice(0)}return o});function _(A){if(i[g]=A,c){const[L,M]=ve(g);return c[g]=M,e(d[g],L)}return e(d[g])}}}function v(t,e){return Fr(()=>t(e||{}))}function Ds(){return!0}const zl={get(t,e,r){return e===Xr?r:t.get(e)},has(t,e){return e===Xr?!0:t.has(e)},set:Ds,deleteProperty:Ds,getOwnPropertyDescriptor(t,e){return{configurable:!0,enumerable:!0,get(){return t.get(e)},set:Ds,deleteProperty:Ds}},ownKeys(t){return t.keys()}};function cl(t){return(t=typeof t=="function"?t():t)?t:{}}function ep(){for(let t=0,e=this.length;t<e;++t){const r=this[t]();if(r!==void 0)return r}}function ql(...t){let e=!1;for(let a=0;a<t.length;a++){const c=t[a];e=e||!!c&&Xr in c,t[a]=typeof c=="function"?(e=!0,Ge(c)):c}if(Cm&&e)return new Proxy({get(a){for(let c=t.length-1;c>=0;c--){const d=cl(t[c])[a];if(d!==void 0)return d}},has(a){for(let c=t.length-1;c>=0;c--)if(a in cl(t[c]))return!0;return!1},keys(){const a=[];for(let c=0;c<t.length;c++)a.push(...Object.keys(cl(t[c])));return[...new Set(a)]}},zl);const r={},n=Object.create(null);for(let a=t.length-1;a>=0;a--){const c=t[a];if(!c)continue;const d=Object.getOwnPropertyNames(c);for(let h=d.length-1;h>=0;h--){const m=d[h];if(m==="__proto__"||m==="constructor")continue;const g=Object.getOwnPropertyDescriptor(c,m);if(!n[m])n[m]=g.get?{enumerable:!0,configurable:!0,get:ep.bind(r[m]=[g.get.bind(c)])}:g.value!==void 0?g:void 0;else{const _=r[m];_&&(g.get?_.push(g.get.bind(c)):g.value!==void 0&&_.push(()=>g.value))}}}const o={},i=Object.keys(n);for(let a=i.length-1;a>=0;a--){const c=i[a],d=n[c];d&&d.get?Object.defineProperty(o,c,d):o[c]=d?d.value:void 0}return o}function tp(t,...e){if(Cm&&Xr in t){const o=new Set(e.length>1?e.flat():e[0]),i=e.map(a=>new Proxy({get(c){return a.includes(c)?t[c]:void 0},has(c){return a.includes(c)&&c in t},keys(){return a.filter(c=>c in t)}},zl));return i.push(new Proxy({get(a){return o.has(a)?void 0:t[a]},has(a){return o.has(a)?!1:a in t},keys(){return Object.keys(t).filter(a=>!o.has(a))}},zl)),i}const r={},n=e.map(()=>({}));for(const o of Object.getOwnPropertyNames(t)){const i=Object.getOwnPropertyDescriptor(t,o),a=!i.get&&!i.set&&i.enumerable&&i.writable&&i.configurable;let c=!1,d=0;for(const h of e)h.includes(o)&&(c=!0,a?n[d][o]=i.value:Object.defineProperty(n[d],o,i)),++d;c||(a?r[o]=i.value:Object.defineProperty(r,o,i))}return[...n,r]}const rp=t=>`Stale read from <${t}>.`;function pt(t){const e="fallback"in t&&{fallback:()=>t.fallback};return Ge(Zg(()=>t.each,t.children,e||void 0))}function Ne(t){const e=t.keyed,r=Ge(()=>t.when,void 0,void 0),n=e?r:Ge(r,void 0,{equals:(o,i)=>!o==!i});return Ge(()=>{const o=n();if(o){const i=t.children;return typeof i=="function"&&i.length>0?Fr(()=>i(e?o:()=>{if(!Fr(n))throw rp("Show");return r()})):i}return t.fallback},void 0,void 0)}const np=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],op=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline",...np]),ip=new Set(["innerHTML","textContent","innerText","children"]),sp=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),ap=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}});function lp(t,e){const r=ap[t];return typeof r=="object"?r[e]?r.$:void 0:r}const cp=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),ye=t=>Ge(()=>t());function up(t,e,r){let n=r.length,o=e.length,i=n,a=0,c=0,d=e[o-1].nextSibling,h=null;for(;a<o||c<i;){if(e[a]===r[c]){a++,c++;continue}for(;e[o-1]===r[i-1];)o--,i--;if(o===a){const m=i<n?c?r[c-1].nextSibling:r[i-c]:d;for(;c<i;)t.insertBefore(r[c++],m)}else if(i===c)for(;a<o;)(!h||!h.has(e[a]))&&e[a].remove(),a++;else if(e[a]===r[i-1]&&r[c]===e[o-1]){const m=e[--o].nextSibling;t.insertBefore(r[c++],e[a++].nextSibling),t.insertBefore(r[--i],m),e[o]=r[i]}else{if(!h){h=new Map;let g=c;for(;g<i;)h.set(r[g],g++)}const m=h.get(e[a]);if(m!=null)if(c<m&&m<i){let g=a,_=1,A;for(;++g<o&&g<i&&!((A=h.get(e[g]))==null||A!==m+_);)_++;if(_>m-c){const L=e[a];for(;c<m;)t.insertBefore(r[c++],L)}else t.replaceChild(r[c++],e[a++])}else a++;else e[a++].remove()}}}const od="_$DX_DELEGATE";function dp(t,e,r,n={}){let o;return ji(i=>{o=i,e===document?t():s(e,t(),e.firstChild?null:void 0,r)},n.owner),()=>{o(),e.textContent=""}}function q(t,e,r,n){let o;const i=()=>{const c=n?document.createElementNS("http://www.w3.org/1998/Math/MathML","template"):document.createElement("template");return c.innerHTML=t,r?c.content.firstChild.firstChild:n?c.firstChild:c.content.firstChild},a=e?()=>Fr(()=>document.importNode(o||(o=i()),!0)):()=>(o||(o=i())).cloneNode(!0);return a.cloneNode=a,a}function Et(t,e=window.document){const r=e[od]||(e[od]=new Set);for(let n=0,o=t.length;n<o;n++){const i=t[n];r.has(i)||(r.add(i),e.addEventListener(i,vp))}}function ut(t,e,r){r==null?t.removeAttribute(e):t.setAttribute(e,r)}function hp(t,e,r){r?t.setAttribute(e,""):t.removeAttribute(e)}function Ec(t,e){e==null?t.removeAttribute("class"):t.className=e}function ko(t,e,r,n){if(n)Array.isArray(r)?(t[`$$${e}`]=r[0],t[`$$${e}Data`]=r[1]):t[`$$${e}`]=r;else if(Array.isArray(r)){const o=r[0];t.addEventListener(e,r[0]=i=>o.call(t,r[1],i))}else t.addEventListener(e,r,typeof r!="function"&&r)}function mp(t,e,r={}){const n=Object.keys(e||{}),o=Object.keys(r);let i,a;for(i=0,a=o.length;i<a;i++){const c=o[i];!c||c==="undefined"||e[c]||(id(t,c,!1),delete r[c])}for(i=0,a=n.length;i<a;i++){const c=n[i],d=!!e[c];!c||c==="undefined"||r[c]===d||!d||(id(t,c,!0),r[c]=d)}return r}function u(t,e,r){if(!e)return r?ut(t,"style"):e;const n=t.style;if(typeof e=="string")return n.cssText=e;typeof r=="string"&&(n.cssText=r=void 0),r||(r={}),e||(e={});let o,i;for(i in r)e[i]==null&&n.removeProperty(i),delete r[i];for(i in e)o=e[i],o!==r[i]&&(n.setProperty(i,o),r[i]=o);return r}function fp(t,e={},r,n){const o={};return ie(()=>o.children=Qi(t,e.children,o.children)),ie(()=>typeof e.ref=="function"&&yp(e.ref,t)),ie(()=>gp(t,e,r,!0,o,!0)),o}function yp(t,e,r){return Fr(()=>t(e,r))}function s(t,e,r,n){if(r!==void 0&&!n&&(n=[]),typeof e!="function")return Qi(t,e,n,r);ie(o=>Qi(t,e(),o,r),n)}function gp(t,e,r,n,o={},i=!1){e||(e={});for(const a in o)if(!(a in e)){if(a==="children")continue;o[a]=sd(t,a,null,o[a],r,i,e)}for(const a in e){if(a==="children")continue;const c=e[a];o[a]=sd(t,a,c,o[a],r,i,e)}}function pp(t){return t.toLowerCase().replace(/-([a-z])/g,(e,r)=>r.toUpperCase())}function id(t,e,r){const n=e.trim().split(/\s+/);for(let o=0,i=n.length;o<i;o++)t.classList.toggle(n[o],r)}function sd(t,e,r,n,o,i,a){let c,d,h,m,g;if(e==="style")return u(t,r,n);if(e==="classList")return mp(t,r,n);if(r===n)return n;if(e==="ref")i||r(t);else if(e.slice(0,3)==="on:"){const _=e.slice(3);n&&t.removeEventListener(_,n,typeof n!="function"&&n),r&&t.addEventListener(_,r,typeof r!="function"&&r)}else if(e.slice(0,10)==="oncapture:"){const _=e.slice(10);n&&t.removeEventListener(_,n,!0),r&&t.addEventListener(_,r,!0)}else if(e.slice(0,2)==="on"){const _=e.slice(2).toLowerCase(),A=cp.has(_);if(!A&&n){const L=Array.isArray(n)?n[0]:n;t.removeEventListener(_,L)}(A||r)&&(ko(t,_,r,A),A&&Et([_]))}else e.slice(0,5)==="attr:"?ut(t,e.slice(5),r):e.slice(0,5)==="bool:"?hp(t,e.slice(5),r):(g=e.slice(0,5)==="prop:")||(h=ip.has(e))||(m=lp(e,t.tagName))||(d=op.has(e))||(c=t.nodeName.includes("-")||"is"in a)?(g&&(e=e.slice(5),d=!0),e==="class"||e==="className"?Ec(t,r):c&&!d&&!h?t[pp(e)]=r:t[m||e]=r):ut(t,sp[e]||e,r);return r}function vp(t){let e=t.target;const r=`$$${t.type}`,n=t.target,o=t.currentTarget,i=d=>Object.defineProperty(t,"target",{configurable:!0,value:d}),a=()=>{const d=e[r];if(d&&!e.disabled){const h=e[`${r}Data`];if(h!==void 0?d.call(e,h,t):d.call(e,t),t.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(t.target)&&i(e.host),!0},c=()=>{for(;a()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return e||document}}),t.composedPath){const d=t.composedPath();i(d[0]);for(let h=0;h<d.length-2&&(e=d[h],!!a());h++){if(e._$host){e=e._$host,c();break}if(e.parentNode===o)break}}else c();i(n)}function Qi(t,e,r,n,o){for(;typeof r=="function";)r=r();if(e===r)return r;const i=typeof e,a=n!==void 0;if(t=a&&r[0]&&r[0].parentNode||t,i==="string"||i==="number"){if(i==="number"&&(e=e.toString(),e===r))return r;if(a){let c=r[0];c&&c.nodeType===3?c.data!==e&&(c.data=e):c=document.createTextNode(e),r=jo(t,r,n,c)}else r!==""&&typeof r=="string"?r=t.firstChild.data=e:r=t.textContent=e}else if(e==null||i==="boolean")r=jo(t,r,n);else{if(i==="function")return ie(()=>{let c=e();for(;typeof c=="function";)c=c();r=Qi(t,c,r,n)}),()=>r;if(Array.isArray(e)){const c=[],d=r&&Array.isArray(r);if(Gl(c,e,r,o))return ie(()=>r=Qi(t,c,r,n,!0)),()=>r;if(c.length===0){if(r=jo(t,r,n),a)return r}else d?r.length===0?ad(t,c,n):up(t,r,c):(r&&jo(t),ad(t,c));r=c}else if(e.nodeType){if(Array.isArray(r)){if(a)return r=jo(t,r,n,e);jo(t,r,null,e)}else r==null||r===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);r=e}}return r}function Gl(t,e,r,n){let o=!1;for(let i=0,a=e.length;i<a;i++){let c=e[i],d=r&&r[t.length],h;if(!(c==null||c===!0||c===!1))if((h=typeof c)=="object"&&c.nodeType)t.push(c);else if(Array.isArray(c))o=Gl(t,c,d)||o;else if(h==="function")if(n){for(;typeof c=="function";)c=c();o=Gl(t,Array.isArray(c)?c:[c],Array.isArray(d)?d:[d])||o}else t.push(c),o=!0;else{const m=String(c);d&&d.nodeType===3&&d.data===m?t.push(d):t.push(document.createTextNode(m))}}return o}function ad(t,e,r=null){for(let n=0,o=e.length;n<o;n++)t.insertBefore(e[n],r)}function jo(t,e,r,n){if(r===void 0)return t.textContent="";const o=n||document.createTextNode("");if(e.length){let i=!1;for(let a=e.length-1;a>=0;a--){const c=e[a];if(o!==c){const d=c.parentNode===t;!i&&!a?d?t.replaceChild(o,c):t.insertBefore(o,r):d&&c.remove()}else i=!0}}else t.insertBefore(o,r);return[o]}const bp=!1;function Lm(){let t=new Set;function e(o){return t.add(o),()=>t.delete(o)}let r=!1;function n(o,i){if(r)return!(r=!1);const a={to:o,options:i,defaultPrevented:!1,preventDefault:()=>a.defaultPrevented=!0};for(const c of t)c.listener({...a,from:c.location,retry:d=>{d&&(r=!0),c.navigate(o,{...i,resolve:!1})}});return!a.defaultPrevented}return{subscribe:e,confirm:n}}let Hl;function Tc(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),Hl=window.history.state._depth}Tc();function _p(t){return{...t,_depth:window.history.state&&window.history.state._depth}}function Sp(t,e){let r=!1;return()=>{const n=Hl;Tc();const o=n==null?null:Hl-n;if(r){r=!1;return}o&&e(o)?(r=!0,window.history.go(-o)):t()}}const Pp=/^(?:[a-z0-9]+:)?\/\//i,wp=/^\/+|(\/)\/+$/g,Mm="http://sr";function Co(t,e=!1){const r=t.replace(wp,"$1");return r?e||/^[?#]/.test(r)?r:"/"+r:""}function Js(t,e,r){if(Pp.test(e))return;const n=Co(t),o=r&&Co(r);let i="";return!o||e.startsWith("/")?i=n:o.toLowerCase().indexOf(n.toLowerCase())!==0?i=n+o:i=o,(i||"/")+Co(e,!i)}function Cp(t,e){if(t==null)throw new Error(e);return t}function Ap(t,e){return Co(t).replace(/\/*(\*.*)?$/g,"")+Co(e)}function Om(t){const e={};return t.searchParams.forEach((r,n)=>{n in e?Array.isArray(e[n])?e[n].push(r):e[n]=[e[n],r]:e[n]=r}),e}function Ip(t,e,r){const[n,o]=t.split("/*",2),i=n.split("/").filter(Boolean),a=i.length;return c=>{const d=c.split("/").filter(Boolean),h=d.length-a;if(h<0||h>0&&o===void 0&&!e)return null;const m={path:a?"":"/",params:{}},g=_=>r===void 0?void 0:r[_];for(let _=0;_<a;_++){const A=i[_],L=A[0]===":",M=L?d[_]:d[_].toLowerCase(),$=L?A.slice(1):A.toLowerCase();if(L&&ul(M,g($)))m.params[$]=M;else if(L||!ul(M,$))return null;m.path+=`/${M}`}if(o){const _=h?d.slice(-h).join("/"):"";if(ul(_,g(o)))m.params[o]=_;else return null}return m}}function ul(t,e){const r=n=>n===t;return e===void 0?!0:typeof e=="string"?r(e):typeof e=="function"?e(t):Array.isArray(e)?e.some(r):e instanceof RegExp?e.test(t):!1}function xp(t){const[e,r]=t.pattern.split("/*",2),n=e.split("/").filter(Boolean);return n.reduce((o,i)=>o+(i.startsWith(":")?2:3),n.length-(r===void 0?0:1))}function Vm(t){const e=new Map,r=Em();return new Proxy({},{get(n,o){return e.has(o)||Tm(r,()=>e.set(o,Ge(()=>t()[o]))),e.get(o)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(t())}})}function Bm(t){let e=/(\/?\:[^\/]+)\?/.exec(t);if(!e)return[t];let r=t.slice(0,e.index),n=t.slice(e.index+e[0].length);const o=[r,r+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(n);)o.push(r+=e[1]),n=n.slice(e[0].length);return Bm(n).reduce((i,a)=>[...i,...o.map(c=>c+a)],[])}const Ep=100,Fm=$m(),$c=$m(),us=()=>Cp(Cc(Fm),"<A> and 'use' router primitives can be only used inside a Route."),Tp=()=>Cc($c)||us().base,$p=t=>{const e=Tp();return Ge(()=>e.resolvePath(t()))},kp=t=>{const e=us();return Ge(()=>{const r=t();return r!==void 0?e.renderPath(r):r})},kc=()=>us().navigatorFactory(),Rp=()=>us().location,Dp=()=>us().params;function Np(t,e=""){const{component:r,preload:n,load:o,children:i,info:a}=t,c=!i||Array.isArray(i)&&!i.length,d={key:t,component:r,preload:n||o,info:a};return Um(t.path).reduce((h,m)=>{for(const g of Bm(m)){const _=Ap(e,g);let A=c?_:_.split("/*",1)[0];A=A.split("/").map(L=>L.startsWith(":")||L.startsWith("*")?L:encodeURIComponent(L)).join("/"),h.push({...d,originalPath:m,pattern:A,matcher:Ip(A,!c,t.matchFilters)})}return h},[])}function Lp(t,e=0){return{routes:t,score:xp(t[t.length-1])*1e4-e,matcher(r){const n=[];for(let o=t.length-1;o>=0;o--){const i=t[o],a=i.matcher(r);if(!a)return null;n.unshift({...a,route:i})}return n}}}function Um(t){return Array.isArray(t)?t:[t]}function jm(t,e="",r=[],n=[]){const o=Um(t);for(let i=0,a=o.length;i<a;i++){const c=o[i];if(c&&typeof c=="object"){c.hasOwnProperty("path")||(c.path="");const d=Np(c,e);for(const h of d){r.push(h);const m=Array.isArray(c.children)&&c.children.length===0;if(c.children&&!m)jm(c.children,h.pattern,r,n);else{const g=Lp([...r],n.length);n.push(g)}r.pop()}}}return r.length?n:n.sort((i,a)=>a.score-i.score)}function dl(t,e){for(let r=0,n=t.length;r<n;r++){const o=t[r].matcher(e);if(o)return o}return[]}function Mp(t,e,r){const n=new URL(Mm),o=Ge(m=>{const g=t();try{return new URL(g,n)}catch{return console.error(`Invalid path ${g}`),m}},n,{equals:(m,g)=>m.href===g.href}),i=Ge(()=>o().pathname),a=Ge(()=>o().search,!0),c=Ge(()=>o().hash),d=()=>"",h=wc(a,()=>Om(o()));return{get pathname(){return i()},get search(){return a()},get hash(){return c()},get state(){return e()},get key(){return d()},query:r?r(h):Vm(h)}}let bo;function Op(){return bo}function Vp(t,e,r,n={}){const{signal:[o,i],utils:a={}}=t,c=a.parsePath||(ue=>ue),d=a.renderPath||(ue=>ue),h=a.beforeLeave||Lm(),m=Js("",n.base||"");if(m===void 0)throw new Error(`${m} is not a valid base path`);m&&!o().value&&i({value:m,replace:!0,scroll:!1});const[g,_]=ve(!1);let A;const L=(ue,J)=>{J.value===M()&&J.state===T()||(A===void 0&&_(!0),bo=ue,A=J,Hg(()=>{A===J&&($(A.value),ee(A.state),ge[1](E=>E.filter(F=>F.pending)))}).finally(()=>{A===J&&xm(()=>{bo=void 0,ue==="navigate"&&x(A),_(!1),A=void 0})}))},[M,$]=ve(o().value),[T,ee]=ve(o().state),ce=Mp(M,T,a.queryWrapper),Z=[],ge=ve([]),ne=Ge(()=>typeof n.transformUrl=="function"?dl(e(),n.transformUrl(ce.pathname)):dl(e(),ce.pathname)),w=()=>{const ue=ne(),J={};for(let E=0;E<ue.length;E++)Object.assign(J,ue[E].params);return J},S=a.paramsWrapper?a.paramsWrapper(w,e):Vm(w),p={pattern:m,path:()=>m,outlet:()=>null,resolvePath(ue){return Js(m,ue)}};return ie(wc(o,ue=>L("native",ue),{defer:!0})),{base:p,location:ce,params:S,isRouting:g,renderPath:d,parsePath:c,navigatorFactory:P,matches:ne,beforeLeave:h,preloadRoute:y,singleFlight:n.singleFlight===void 0?!0:n.singleFlight,submissions:ge};function C(ue,J,E){Fr(()=>{if(typeof J=="number"){J&&(a.go?a.go(J):console.warn("Router integration does not support relative routing"));return}const F=!J||J[0]==="?",{replace:z,resolve:B,scroll:k,state:U}={replace:!1,resolve:!F,scroll:!0,...E},he=B?ue.resolvePath(J):Js(F&&ce.pathname||"",J);if(he===void 0)throw new Error(`Path '${J}' is not a routable path`);if(Z.length>=Ep)throw new Error("Too many redirects");const H=M();(he!==H||U!==T())&&(bp||h.confirm(he,E)&&(Z.push({value:H,replace:z,scroll:k,state:T()}),L("navigate",{value:he,state:U})))})}function P(ue){return ue=ue||Cc($c)||p,(J,E)=>C(ue,J,E)}function x(ue){const J=Z[0];J&&(i({...ue,replace:J.replace,scroll:J.scroll}),Z.length=0)}function y(ue,J){const E=dl(e(),ue.pathname),F=bo;bo="preload";for(let z in E){const{route:B,params:k}=E[z];B.component&&B.component.preload&&B.component.preload();const{preload:U}=B;J&&U&&Tm(r(),()=>U({params:k,location:{pathname:ue.pathname,search:ue.search,hash:ue.hash,query:Om(ue),state:null,key:""},intent:"preload"}))}bo=F}}function Bp(t,e,r,n){const{base:o,location:i,params:a}=t,{pattern:c,component:d,preload:h}=n().route,m=Ge(()=>n().path);d&&d.preload&&d.preload();const g=h?h({params:a,location:i,intent:bo||"initial"}):void 0;return{parent:e,pattern:c,path:m,outlet:()=>d?v(d,{params:a,location:i,data:g,get children(){return r()}}):r(),resolvePath(A){return Js(o.path(),A,m())}}}const Fp=t=>e=>{const{base:r}=e,n=Ac(()=>e.children),o=Ge(()=>jm(n(),e.base||""));let i;const a=Vp(t,o,()=>i,{base:r,singleFlight:e.singleFlight,transformUrl:e.transformUrl});return t.create&&t.create(a),v(Fm.Provider,{value:a,get children(){return v(Up,{routerState:a,get root(){return e.root},get preload(){return e.rootPreload||e.rootLoad},get children(){return[ye(()=>(i=Em())&&null),v(jp,{routerState:a,get branches(){return o()}})]}})}})};function Up(t){const e=t.routerState.location,r=t.routerState.params,n=Ge(()=>t.preload&&Fr(()=>{t.preload({params:r,location:e,intent:Op()||"initial"})}));return v(Ne,{get when(){return t.root},keyed:!0,get fallback(){return t.children},children:o=>v(o,{params:r,location:e,get data(){return n()},get children(){return t.children}})})}function jp(t){const e=[];let r;const n=Ge(wc(t.routerState.matches,(o,i,a)=>{let c=i&&o.length===i.length;const d=[];for(let h=0,m=o.length;h<m;h++){const g=i&&i[h],_=o[h];a&&g&&_.route.key===g.route.key?d[h]=a[h]:(c=!1,e[h]&&e[h](),ji(A=>{e[h]=A,d[h]=Bp(t.routerState,d[h-1]||t.routerState.base,ld(()=>n()[h+1]),()=>t.routerState.matches()[h])}))}return e.splice(o.length).forEach(h=>h()),a&&c?a:(r=d[0],d)}));return ld(()=>n()&&r)()}const ld=t=>()=>v(Ne,{get when(){return t()},keyed:!0,children:e=>v($c.Provider,{value:e,get children(){return e.outlet()}})}),Kr=t=>{const e=Ac(()=>t.children);return ql(t,{get children(){return e()}})};function zp([t,e],r,n){return[t,n?o=>e(n(o)):e]}function qp(t){let e=!1;const r=o=>typeof o=="string"?{value:o}:o,n=zp(ve(r(t.get()),{equals:(o,i)=>o.value===i.value&&o.state===i.state}),void 0,o=>(!e&&t.set(o),o));return t.init&&hi(t.init((o=t.get())=>{e=!0,n[1](r(o)),e=!1})),Fp({signal:n,create:t.create,utils:t.utils})}function Gp(t,e,r){return t.addEventListener(e,r),()=>t.removeEventListener(e,r)}function Hp(t,e){const r=t&&document.getElementById(t);r?r.scrollIntoView():e&&window.scrollTo(0,0)}const Yp=new Map;function Wp(t=!0,e=!1,r="/_server",n){return o=>{const i=o.base.path(),a=o.navigatorFactory(o.base);let c,d;function h(M){return M.namespaceURI==="http://www.w3.org/2000/svg"}function m(M){if(M.defaultPrevented||M.button!==0||M.metaKey||M.altKey||M.ctrlKey||M.shiftKey)return;const $=M.composedPath().find(ne=>ne instanceof Node&&ne.nodeName.toUpperCase()==="A");if(!$||e&&!$.hasAttribute("link"))return;const T=h($),ee=T?$.href.baseVal:$.href;if((T?$.target.baseVal:$.target)||!ee&&!$.hasAttribute("state"))return;const Z=($.getAttribute("rel")||"").split(/\s+/);if($.hasAttribute("download")||Z&&Z.includes("external"))return;const ge=T?new URL(ee,document.baseURI):new URL(ee);if(!(ge.origin!==window.location.origin||i&&ge.pathname&&!ge.pathname.toLowerCase().startsWith(i.toLowerCase())))return[$,ge]}function g(M){const $=m(M);if(!$)return;const[T,ee]=$,ce=o.parsePath(ee.pathname+ee.search+ee.hash),Z=T.getAttribute("state");M.preventDefault(),a(ce,{resolve:!1,replace:T.hasAttribute("replace"),scroll:!T.hasAttribute("noscroll"),state:Z?JSON.parse(Z):void 0})}function _(M){const $=m(M);if(!$)return;const[T,ee]=$;o.preloadRoute(ee,T.getAttribute("preload")!=="false")}function A(M){clearTimeout(c);const $=m(M);if(!$)return d=null;const[T,ee]=$;d!==T&&(c=setTimeout(()=>{o.preloadRoute(ee,T.getAttribute("preload")!=="false"),d=T},20))}function L(M){if(M.defaultPrevented)return;let $=M.submitter&&M.submitter.hasAttribute("formaction")?M.submitter.getAttribute("formaction"):M.target.getAttribute("action");if(!$)return;if(!$.startsWith("https://action/")){const ee=new URL($,Mm);if($=o.parsePath(ee.pathname+ee.search),!$.startsWith(r))return}if(M.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const T=Yp.get($);if(T){M.preventDefault();const ee=new FormData(M.target,M.submitter);T.call({r:o,f:M.target},M.target.enctype==="multipart/form-data"?ee:new URLSearchParams(ee))}}Et(["click","submit"]),document.addEventListener("click",g),t&&(document.addEventListener("mousemove",A,{passive:!0}),document.addEventListener("focusin",_,{passive:!0}),document.addEventListener("touchstart",_,{passive:!0})),document.addEventListener("submit",L),hi(()=>{document.removeEventListener("click",g),t&&(document.removeEventListener("mousemove",A),document.removeEventListener("focusin",_),document.removeEventListener("touchstart",_)),document.removeEventListener("submit",L)})}}function Kp(t){const e=t.replace(/^.*?#/,"");if(!e.startsWith("/")){const[,r="/"]=window.location.hash.split("#",2);return`${r}#${e}`}return e}function Qp(t){const e=()=>window.location.hash.slice(1),r=Lm();return qp({get:e,set({value:n,replace:o,scroll:i,state:a}){o?window.history.replaceState(_p(a),"","#"+n):window.history.pushState(a,"","#"+n);const c=n.indexOf("#"),d=c>=0?n.slice(c+1):"";Hp(d,i),Tc()},init:n=>Gp(window,"hashchange",Sp(n,o=>!r.confirm(o&&o<0?o:e()))),create:Wp(t.preload,t.explicitLinks,t.actionBase),utils:{go:n=>window.history.go(n),renderPath:n=>`#${n}`,parsePath:Kp,beforeLeave:r}})(t)}var Jp=q("<a>");function Yo(t){t=ql({inactiveClass:"inactive",activeClass:"active"},t);const[,e]=tp(t,["href","state","class","activeClass","inactiveClass","end"]),r=$p(()=>t.href),n=kp(r),o=Rp(),i=Ge(()=>{const a=r();if(a===void 0)return[!1,!1];const c=Co(a.split(/[?#]/,1)[0]).toLowerCase(),d=decodeURI(Co(o.pathname).toLowerCase());return[t.end?c===d:d.startsWith(c+"/")||d===c,c===d]});return(()=>{var a=Jp();return fp(a,ql(e,{get href(){return n()||t.href},get state(){return JSON.stringify(t.state)},get classList(){return{...t.class&&{[t.class]:!0},[t.inactiveClass]:!i()[0],[t.activeClass]:i()[0],...e.classList}},link:"",get"aria-current"(){return i()[1]?"page":void 0}}),!1),a})()}const Yl=Symbol("store-raw"),Xo=Symbol("store-node"),Pn=Symbol("store-has"),zm=Symbol("store-self");function qm(t){let e=t[Xr];if(!e&&(Object.defineProperty(t,Xr,{value:e=new Proxy(t,ev)}),!Array.isArray(t))){const r=Object.keys(t),n=Object.getOwnPropertyDescriptors(t);for(let o=0,i=r.length;o<i;o++){const a=r[o];n[a].get&&Object.defineProperty(t,a,{enumerable:n[a].enumerable,get:n[a].get.bind(e)})}}return e}function ma(t){let e;return t!=null&&typeof t=="object"&&(t[Xr]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function Ji(t,e=new Set){let r,n,o,i;if(r=t!=null&&t[Yl])return r;if(!ma(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let a=0,c=t.length;a<c;a++)o=t[a],(n=Ji(o,e))!==o&&(t[a]=n)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const a=Object.keys(t),c=Object.getOwnPropertyDescriptors(t);for(let d=0,h=a.length;d<h;d++)i=a[d],!c[i].get&&(o=t[i],(n=Ji(o,e))!==o&&(t[i]=n))}return t}function fa(t,e){let r=t[e];return r||Object.defineProperty(t,e,{value:r=Object.create(null)}),r}function Xi(t,e,r){if(t[e])return t[e];const[n,o]=ve(r,{equals:!1,internal:!0});return n.$=o,t[e]=n}function Xp(t,e){const r=Reflect.getOwnPropertyDescriptor(t,e);return!r||r.get||!r.configurable||e===Xr||e===Xo||(delete r.value,delete r.writable,r.get=()=>t[Xr][e]),r}function Gm(t){Ul()&&Xi(fa(t,Xo),zm)()}function Zp(t){return Gm(t),Reflect.ownKeys(t)}const ev={get(t,e,r){if(e===Yl)return t;if(e===Xr)return r;if(e===Fl)return Gm(t),r;const n=fa(t,Xo),o=n[e];let i=o?o():t[e];if(e===Xo||e===Pn||e==="__proto__")return i;if(!o){const a=Object.getOwnPropertyDescriptor(t,e);Ul()&&(typeof i!="function"||t.hasOwnProperty(e))&&!(a&&a.get)&&(i=Xi(n,e,i)())}return ma(i)?qm(i):i},has(t,e){return e===Yl||e===Xr||e===Fl||e===Xo||e===Pn||e==="__proto__"?!0:(Ul()&&Xi(fa(t,Pn),e)(),e in t)},set(){return!0},deleteProperty(){return!0},ownKeys:Zp,getOwnPropertyDescriptor:Xp};function ya(t,e,r,n=!1){if(!n&&t[e]===r)return;const o=t[e],i=t.length;r===void 0?(delete t[e],t[Pn]&&t[Pn][e]&&o!==void 0&&t[Pn][e].$()):(t[e]=r,t[Pn]&&t[Pn][e]&&o===void 0&&t[Pn][e].$());let a=fa(t,Xo),c;if((c=Xi(a,e,o))&&c.$(()=>r),Array.isArray(t)&&t.length!==i){for(let d=t.length;d<i;d++)(c=a[d])&&c.$();(c=Xi(a,"length",i))&&c.$(t.length)}(c=a[zm])&&c.$()}function Hm(t,e){const r=Object.keys(e);for(let n=0;n<r.length;n+=1){const o=r[n];ya(t,o,e[o])}}function tv(t,e){if(typeof e=="function"&&(e=e(t)),e=Ji(e),Array.isArray(e)){if(t===e)return;let r=0,n=e.length;for(;r<n;r++){const o=e[r];t[r]!==o&&ya(t,r,o)}ya(t,"length",n)}else Hm(t,e)}function Li(t,e,r=[]){let n,o=t;if(e.length>1){n=e.shift();const a=typeof n,c=Array.isArray(t);if(Array.isArray(n)){for(let d=0;d<n.length;d++)Li(t,[n[d]].concat(e),r);return}else if(c&&a==="function"){for(let d=0;d<t.length;d++)n(t[d],d)&&Li(t,[d].concat(e),r);return}else if(c&&a==="object"){const{from:d=0,to:h=t.length-1,by:m=1}=n;for(let g=d;g<=h;g+=m)Li(t,[g].concat(e),r);return}else if(e.length>1){Li(t[n],e,[n].concat(r));return}o=t[n],r=[n].concat(r)}let i=e[0];typeof i=="function"&&(i=i(o,r),i===o)||n===void 0&&i==null||(i=Ji(i),n===void 0||ma(o)&&ma(i)&&!Array.isArray(i)?Hm(o,i):ya(t,n,i))}function Rc(...[t,e]){const r=Ji(t||{}),n=Array.isArray(r),o=qm(r);function i(...a){xm(()=>{n&&a.length===1?tv(r,a[0]):Li(r,a)})}return[o,i]}const Ot=(t=300+Math.random()*700)=>new Promise(e=>setTimeout(e,t)),mo=(t="")=>`${t}${Date.now()}-${Math.random().toString(36).substr(2,9)}`;let ze={products:[{id:"prod-001",name:"Wireless Headphones",sku:"WH-001",productCode:"WH-001",productName:"Wireless Headphones",description:"High-quality wireless bluetooth headphones",category:"Electronics",unitOfMeasure:"pcs",unitCost:45,sellingPrice:89.99,minStockLevel:10,maxStockLevel:100,isActive:!0,createdDate:"2024-01-15T10:00:00Z",lastModified:"2024-01-15T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-002",name:"USB-C Cable",sku:"USB-001",description:"3ft USB-C charging cable",category:"Accessories",unitOfMeasure:"pcs",unitCost:8.5,sellingPrice:19.99,minStockLevel:25,maxStockLevel:200,isActive:!0,createdDate:"2024-01-16T10:00:00Z",lastModified:"2024-01-16T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-003",name:"Laptop Stand",sku:"LS-001",description:"Adjustable aluminum laptop stand",category:"Office",unitOfMeasure:"pcs",unitCost:25,sellingPrice:49.99,minStockLevel:5,maxStockLevel:50,isActive:!0,createdDate:"2024-01-17T10:00:00Z",lastModified:"2024-01-17T10:00:00Z",businessId:"YB100423253156428"}],locations:[{id:"loc-001",name:"Main Warehouse",code:"WH-001",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-002",name:"Retail Store - Downtown",code:"ST-001",type:"store",address:"456 Main St, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-003",name:"Retail Store - Mall",code:"ST-002",type:"store",address:"789 Mall Blvd, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"}],movements:[{id:"mov-001",productId:"prod-001",productName:"Wireless Headphones",productSku:"WH-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:50,unitCost:45,totalCost:2250,referenceNumber:"PO-001",notes:"Initial stock purchase",createdBy:"admin",createdDate:"2024-01-15T10:00:00Z",invoiceId:"INV-1000001"},{id:"mov-002",productId:"prod-002",productName:"USB-C Cable",productSku:"USB-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:100,unitCost:8.5,totalCost:850,referenceNumber:"PO-001",notes:"Bulk purchase",createdBy:"admin",createdDate:"2024-01-15T10:05:00Z",invoiceId:"INV-1000001"}],accounts:[{id:"acc-001",accountNumber:"1000",accountName:"Cash",accountType:"asset",category:"currentAssets",balance:5e4,parentAccountId:null,description:"Cash and cash equivalents",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"},{id:"acc-002",accountNumber:"1100",accountName:"Accounts Receivable",accountType:"asset",category:"currentAssets",balance:25e3,parentAccountId:null,description:"Money owed by customers",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"}],journalEntries:[{id:"je-001",entryNumber:"JE-001",date:"2024-01-15",description:"Initial cash deposit",reference:"DEP-001",status:"posted",createdBy:"admin",createdAt:"2024-01-15T10:00:00Z",postedAt:"2024-01-15T10:05:00Z",lines:[{id:"jel-001",accountId:"acc-001",accountName:"Cash",description:"Initial deposit",debitAmount:5e4,creditAmount:0},{id:"jel-002",accountId:"acc-003",accountName:"Owner Equity",description:"Initial capital",debitAmount:0,creditAmount:5e4}]}]};const or=(t=.05)=>Math.random()<t,ir=()=>{const t=["Network timeout","Connection refused","Server temporarily unavailable","Invalid request"];throw new Error(t[Math.floor(Math.random()*t.length)])},Vr={products:{async getAll(t,e){await Ot(),or()&&ir();let r=[...ze.products];if(t&&t.trim()){const n=t.toLowerCase();r=r.filter(o=>o.name.toLowerCase().includes(n)||o.sku.toLowerCase().includes(n)||o.category.toLowerCase().includes(n)||o.description.toLowerCase().includes(n))}return e?.category&&(r=r.filter(n=>n.category===e.category)),e?.isActive!==void 0&&(r=r.filter(n=>n.isActive===e.isActive)),r},async getById(t){return await Ot(),or()&&ir(),ze.products.find(e=>e.id===t)||null},async create(t){if(await Ot(),or()&&ir(),ze.products.some(r=>r.sku===t.sku))throw new Error("SKU already exists");const e={...t,id:mo("prod-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return ze.products.push(e),e},async update(t,e){await Ot(),or()&&ir();const r=ze.products.findIndex(o=>o.id===t);if(r===-1)throw new Error("Product not found");if(e.sku&&ze.products.some(o=>o.id!==t&&o.sku===e.sku))throw new Error("SKU already exists");const n={...ze.products[r],...e,lastModified:new Date().toISOString()};return ze.products[r]=n,n},async delete(t){await Ot(),or()&&ir();const e=ze.products.findIndex(n=>n.id===t);if(e===-1)throw new Error("Product not found");return ze.movements.some(n=>n.productId===t)?{success:!1,message:"Cannot delete product with existing movements"}:(ze.products.splice(e,1),{success:!0,message:"Product deleted successfully"})}},locations:{async getAll(t){await Ot(),or()&&ir();let e=[...ze.locations];return t?.type&&(e=e.filter(r=>r.type===t.type)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await Ot(),ze.locations.find(e=>e.id===t)||null},async create(t){if(await Ot(),or()&&ir(),ze.locations.some(r=>r.code===t.code))throw new Error("Location code already exists");const e={...t,id:mo("loc-"),createdDate:new Date().toISOString()};return ze.locations.push(e),e},async update(t,e){await Ot(),or()&&ir();const r=ze.locations.findIndex(n=>n.id===t);if(r===-1)throw new Error("Location not found");if(e.code&&ze.locations.some(n=>n.id!==t&&n.code===e.code))throw new Error("Location code already exists");return ze.locations[r]={...ze.locations[r],...e},ze.locations[r]}},movements:{async getAll(t){await Ot(),or()&&ir();let e=[...ze.movements];if(t?.productId&&(e=e.filter(r=>r.productId===t.productId)),t?.locationId&&(e=e.filter(r=>r.locationId===t.locationId)),t?.movementType&&(e=e.filter(r=>r.movementType===t.movementType)),t?.dateFrom&&(e=e.filter(r=>r.createdDate>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.createdDate<=t.dateTo)),t?.search){const r=t.search.toLowerCase();e=e.filter(n=>n.productName.toLowerCase().includes(r)||n.productSku.toLowerCase().includes(r)||n.referenceNumber.toLowerCase().includes(r)||n.notes.toLowerCase().includes(r))}return e.sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime()),e},async getById(t){return await Ot(),ze.movements.find(e=>e.id===t)||null},async create(t){if(await Ot(),or()&&ir(),!ze.products.find(o=>o.id===t.productId))throw new Error("Product not found");if(!ze.locations.find(o=>o.id===t.locationId))throw new Error("Location not found");if(t.movementType==="out"){const o=await this.getStockLevel(t.productId,t.locationId);if(o<t.quantity)throw new Error(`Insufficient stock. Available: ${o}, Requested: ${t.quantity}`)}const n={...t,id:mo("mov-"),createdDate:new Date().toISOString()};return ze.movements.push(n),n},async update(t,e){await Ot(),or()&&ir();const r=ze.movements.findIndex(o=>o.id===t);if(r===-1)throw new Error("Movement not found");const n={...ze.movements[r],...e,lastModified:new Date().toISOString()};return ze.movements[r]=n,n},async delete(t){await Ot(),or()&&ir();const e=ze.movements.findIndex(r=>r.id===t);if(e===-1)throw new Error("Movement not found");return ze.movements.splice(e,1),{success:!0,message:"Movement deleted successfully"}},async createBulk(t){await Ot(),or()&&ir();const e=[],r=[],n=new Date().toISOString(),o=ze.locations.find(i=>i.id===t.locationId);if(!o)return{success:!1,movements:[],errors:["Invalid location"]};for(let i=0;i<t.items.length;i++){const a=t.items[i],c=ze.products.find(m=>m.id===a.productId);if(!c){e.push(`Item ${i+1}: Product not found`);continue}if(a.quantity<=0){e.push(`Item ${i+1}: Quantity must be greater than 0`);continue}if(t.movementType==="out"){const m=await this.getStockLevel(a.productId,t.locationId);if(a.quantity>m){e.push(`Item ${i+1}: Insufficient stock. Available: ${m}, Requested: ${a.quantity}`);continue}}const d=a.unitCost||c.unitCost,h={id:mo("mov-"),productId:c.id,productName:c.name,productSku:c.sku,locationId:t.locationId,locationName:o.name,movementType:t.movementType,quantity:a.quantity,unitCost:d,totalCost:a.quantity*d,referenceNumber:t.referenceNumber,notes:a.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:t.fromLocationId?ze.locations.find(m=>m.id===t.fromLocationId)?.name:void 0};r.push(h)}return e.length>0?{success:!1,movements:[],errors:e}:(ze.movements.push(...r),{success:!0,movements:r,errors:[]})},async getStockLevel(t,e){return await Ot(50),ze.movements.filter(r=>r.productId===t&&r.locationId===e).reduce((r,n)=>{switch(n.movementType){case"in":case"adjustment":return r+n.quantity;case"out":return r-n.quantity;case"transfer":return n.locationId===e?r+n.quantity:r;default:return r}},0)},async getStockLevels(){await Ot();const t=new Map;for(const e of ze.movements){const r=`${e.productId}-${e.locationId}`;let n=t.get(r);switch(n||(n={id:r,productId:e.productId,locationId:e.locationId,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType){case"in":case"adjustment":n.quantity+=e.quantity;break;case"out":n.quantity-=e.quantity;break;case"transfer":e.locationId===e.locationId&&(n.quantity+=e.quantity);break}new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost,n.availableQuantity=n.quantity-n.reservedQuantity}return Array.from(t.values())}},accounts:{async getAll(t){await Ot(),or()&&ir();let e=[...ze.accounts];return t?.accountType&&(e=e.filter(r=>r.accountType===t.accountType)),t?.category&&(e=e.filter(r=>r.category===t.category)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await Ot(),ze.accounts.find(e=>e.id===t)||null},async create(t){if(await Ot(),or()&&ir(),ze.accounts.some(r=>r.accountNumber===t.accountNumber))throw new Error("Account number already exists");const e={...t,id:mo("acc-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return ze.accounts.push(e),e},async update(t,e){await Ot(),or()&&ir();const r=ze.accounts.findIndex(n=>n.id===t);if(r===-1)throw new Error("Account not found");if(e.accountNumber&&ze.accounts.some(n=>n.id!==t&&n.accountNumber===e.accountNumber))throw new Error("Account number already exists");return ze.accounts[r]={...ze.accounts[r],...e,lastModified:new Date().toISOString()},ze.accounts[r]}},journal:{async getAll(t){await Ot(),or()&&ir();let e=[...ze.journalEntries];return t?.status&&(e=e.filter(r=>r.status===t.status)),t?.accountId&&(e=e.filter(r=>r.lines.some(n=>n.accountId===t.accountId))),t?.dateFrom&&(e=e.filter(r=>r.date>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.date<=t.dateTo)),e.sort((r,n)=>new Date(n.createdAt).getTime()-new Date(r.createdAt).getTime())},async getById(t){return await Ot(),ze.journalEntries.find(e=>e.id===t)||null},async create(t){await Ot(),or()&&ir();const e=t.lines.reduce((c,d)=>c+(d.debitAmount||0),0),r=t.lines.reduce((c,d)=>c+(d.creditAmount||0),0);if(Math.abs(e-r)>.01)throw new Error(`Entry is not balanced. Debit: ${e}, Credit: ${r}`);const n=ze.journalEntries.sort((c,d)=>d.entryNumber.localeCompare(c.entryNumber))[0],i=`JE-${((n?parseInt(n.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`,a={...t,id:mo("je-"),entryNumber:i,createdAt:new Date().toISOString(),lines:t.lines.map(c=>({...c,id:mo("jel-")}))};return ze.journalEntries.push(a),a},async update(t,e){await Ot(),or()&&ir();const r=ze.journalEntries.findIndex(n=>n.id===t);if(r===-1)throw new Error("Journal entry not found");if(ze.journalEntries[r].status==="posted")throw new Error("Cannot modify posted entries");return ze.journalEntries[r]={...ze.journalEntries[r],...e},ze.journalEntries[r]},async post(t){await Ot(),or()&&ir();const e=ze.journalEntries.findIndex(i=>i.id===t);if(e===-1)throw new Error("Journal entry not found");const r=ze.journalEntries[e];if(r.status==="posted")throw new Error("Entry is already posted");const n=r.lines.reduce((i,a)=>i+(a.debitAmount||0),0),o=r.lines.reduce((i,a)=>i+(a.creditAmount||0),0);if(Math.abs(n-o)>.01)throw new Error("Entry must be balanced before posting");return ze.journalEntries[e]={...r,status:"posted",postedAt:new Date().toISOString()},r.lines.forEach(i=>{const a=ze.accounts.findIndex(c=>c.id===i.accountId);if(a!==-1){const c=ze.accounts[a],d=i.debitAmount||0,h=i.creditAmount||0;["asset","expense"].includes(c.accountType)?c.balance+=d-h:c.balance+=h-d}}),ze.journalEntries[e]}},utils:{async getNextEntryNumber(){await Ot(100);const t=ze.journalEntries.sort((r,n)=>n.entryNumber.localeCompare(r.entryNumber))[0];return`JE-${((t?parseInt(t.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`},async getNextProductCode(t){await Ot(100);const e=t.toUpperCase().slice(0,3),r=ze.products.filter(o=>o.productCode?.startsWith(e)).sort((o,i)=>(i.productCode||"").localeCompare(o.productCode||""));if(r.length===0)return`${e}001`;const n=parseInt(r[0].productCode?.slice(-3)||"0");return`${e}${(n+1).toString().padStart(3,"0")}`},async healthCheck(){return await Ot(50),{status:"healthy",timestamp:new Date().toISOString(),version:"1.0.0"}},async resetDatabase(){return await Ot(200),ze={products:[...ze.products.slice(0,3)],locations:[...ze.locations.slice(0,3)],movements:[...ze.movements.slice(0,2)],accounts:[...ze.accounts.slice(0,2)],journalEntries:[...ze.journalEntries.slice(0,1)]},{success:!0,message:"Database reset to initial state"}},async getStats(){return await Ot(100),{products:ze.products.length,locations:ze.locations.length,movements:ze.movements.length,accounts:ze.accounts.length,journalEntries:ze.journalEntries.length,totalStockValue:ze.movements.reduce((t,e)=>e.movementType==="in"?t+e.totalCost:e.movementType==="out"?t-e.totalCost:t,0)}}}},Xs=(t=16)=>{const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},hl=t=>typeof t=="string"&&t.trim().length>0,wn=async t=>{const n=await fetch("https://qvamarkets.com/gql_api",{method:"POST",headers:{"Content-Type":"application/json","Accept-Encoding":"gzip, deflate, br",Authorization:"eyJhbGciOiJSUzI1NiIsImtpZCI6IjhlOGZjOGU1NTZmN2E3NmQwOGQzNTgyOWQ2ZjkwYWUyZTEyY2ZkMGQiLCJ0eXAiOiJKV1QifQ"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const o=await n.json();if(o.errors)throw new Error(o.errors[0]?.message||"GraphQL error");return o.data},rv=t=>({ENTRY:"in",in:"in",TRANSFER:"transfer",transfer:"transfer",SALES:"out",out:"out",adjustment:"adjustment"})[t],Wl=t=>({ENTRY:"ENTRY",in:"ENTRY",TRANSFER:"TRANSFER",transfer:"TRANSFER",SALES:"SALES",out:"SALES",adjustment:"adjustment"})[t];function Kl(t){var e=[];return t&&Object.keys(t).map(r=>{e.push(t[r])}),e}function nv(t){if(!/^[a-z0-9+/]+={0,2}$/i.test(t)||t.length%4!=0)throw Error("Not base64 string");for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r,n,o,i,a,c,d,h,m=[],g=0;g<t.length;g+=4)i=e.indexOf(t.charAt(g)),a=e.indexOf(t.charAt(g+1)),c=e.indexOf(t.charAt(g+2)),d=e.indexOf(t.charAt(g+3)),h=i<<18|a<<12|c<<6|d,r=h>>>16&255,n=h>>>8&255,o=h&255,m[g/4]=String.fromCharCode(r,n,o),d==64&&(m[g/4]=String.fromCharCode(r,n)),c==64&&(m[g/4]=String.fromCharCode(r));return t=m.join(""),t}const ov=async()=>({}),iv=()=>(typeof window<"u"&&localStorage.getItem("hrmfinance-api-mode"),"real");let _o=iv();const Zi={getMode(){return _o},setMode(t){_o=t,typeof window<"u"&&localStorage.setItem("hrmfinance-api-mode",t)},isFakeMode(){return _o==="fake"},isRealMode(){return _o==="real"},isHybridMode(){return _o==="hybrid"}},Gr=async(t,e,r=!0)=>{if(_o==="fake")return e();if(_o==="real")return t();try{return await t()}catch(n){if(console.warn("Real API failed, falling back to fake server:",n),r)return e();throw n}},cd={async getAll(t,e){const r=await wn({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:{businessId:"YB100423253156428",":search0":"produ"}});return Kl(r)},async getById(t){return Gr(async()=>(await this.getAll()).find(r=>r.id===t)||null,()=>Vr.products.getById(t))},async create(t){return Gr(async()=>{throw console.log("Creating product via real API:",t),new Error("Real API not implemented yet")},()=>Vr.products.create(t))},async update(t,e){return Gr(async()=>{throw console.log("Updating product via real API:",t,e),new Error("Real API not implemented yet")},()=>Vr.products.update(t,e))},async delete(t){return Gr(async()=>{throw console.log("Deleting product via real API:",t),new Error("Real API not implemented yet")},()=>Vr.products.delete(t))}},ln={async getInventory(t,e){if(!(t&&t?.trim()))return[];let r={businessId:"YB100423253156428"};return t&&t.split(" ").map((i,a)=>{i&&(r[":search"+a]=i.trim())}),await wn({query:"getScanYabaInventory",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async getProducts(t){if(!(t&&t?.trim()))return[];let e={businessId:"YB100423253156428"};return t&&t.split(" ").map((o,i)=>{o&&(e[":search"+i]=o.trim())}),await wn({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async getInvoice(t,e){if(!(t&&t?.trim()))return[];let r={businessId:"YB100423253156428"};return t&&t.split(" ").map((i,a)=>{i&&(r[":search"+a]=i.trim())}),await wn({query:"getScanYabaSalesOrders",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async addInventory(t){let r={query:"addYabaInventory",params:{businessId:"YB100423253156428"},form:t};const n=await wn(r);return console.log(r),console.log(n),n},async updInventory(t){return await ov()}},ud={async getAll(t){return Gr(async()=>{throw console.log("Getting accounts via real API:",t),new Error("Real API not implemented yet")},()=>Vr.accounts.getAll(t))},async getById(t){return Gr(async()=>{throw console.log("Getting account by ID via real API:",t),new Error("Real API not implemented yet")},()=>Vr.accounts.getById(t))},async create(t){return Gr(async()=>{throw console.log("Creating account via real API:",t),new Error("Real API not implemented yet")},()=>Vr.accounts.create(t))},async update(t,e){return Gr(async()=>{throw console.log("Updating account via real API:",t,e),new Error("Real API not implemented yet")},()=>Vr.accounts.update(t,e))}},dd={async getNextEntryNumber(){return Gr(async()=>{throw console.log("Getting next entry number via real API"),new Error("Real API not implemented yet")},()=>Vr.utils.getNextEntryNumber())},async getNextProductCode(t){return Gr(async()=>{throw console.log("Getting next product code via real API:",t),new Error("Real API not implemented yet")},()=>Vr.utils.getNextProductCode(t))},async healthCheck(){return Gr(async()=>{const t=await fetch("/api/health");if(!t.ok)throw new Error("Health check failed");return t.json()},()=>Vr.utils.healthCheck())},async getStats(){return Gr(async()=>{throw console.log("Getting stats via real API"),new Error("Real API not implemented yet")},()=>Vr.utils.getStats())}},sv=()=>{Zi.setMode("real"),console.log("🚀 HRM Finance initialized in REAL API mode for production")};sv();const av=()=>{};var hd={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ym=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let o=t.charCodeAt(n);o<128?e[r++]=o:o<2048?(e[r++]=o>>6|192,e[r++]=o&63|128):(o&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(o=65536+((o&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=o>>18|240,e[r++]=o>>12&63|128,e[r++]=o>>6&63|128,e[r++]=o&63|128):(e[r++]=o>>12|224,e[r++]=o>>6&63|128,e[r++]=o&63|128)}return e},lv=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const o=t[r++];if(o<128)e[n++]=String.fromCharCode(o);else if(o>191&&o<224){const i=t[r++];e[n++]=String.fromCharCode((o&31)<<6|i&63)}else if(o>239&&o<365){const i=t[r++],a=t[r++],c=t[r++],d=((o&7)<<18|(i&63)<<12|(a&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(d>>10)),e[n++]=String.fromCharCode(56320+(d&1023))}else{const i=t[r++],a=t[r++];e[n++]=String.fromCharCode((o&15)<<12|(i&63)<<6|a&63)}}return e.join("")},Wm={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let o=0;o<t.length;o+=3){const i=t[o],a=o+1<t.length,c=a?t[o+1]:0,d=o+2<t.length,h=d?t[o+2]:0,m=i>>2,g=(i&3)<<4|c>>4;let _=(c&15)<<2|h>>6,A=h&63;d||(A=64,a||(_=64)),n.push(r[m],r[g],r[_],r[A])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Ym(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):lv(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let o=0;o<t.length;){const i=r[t.charAt(o++)],c=o<t.length?r[t.charAt(o)]:0;++o;const h=o<t.length?r[t.charAt(o)]:64;++o;const g=o<t.length?r[t.charAt(o)]:64;if(++o,i==null||c==null||h==null||g==null)throw new cv;const _=i<<2|c>>4;if(n.push(_),h!==64){const A=c<<4&240|h>>2;if(n.push(A),g!==64){const L=h<<6&192|g;n.push(L)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class cv extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const uv=function(t){const e=Ym(t);return Wm.encodeByteArray(e,!0)},ga=function(t){return uv(t).replace(/\./g,"")},Km=function(t){try{return Wm.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dv(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hv=()=>dv().__FIREBASE_DEFAULTS__,mv=()=>{if(typeof process>"u"||typeof hd>"u")return;const t=hd.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},fv=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Km(t[1]);return e&&JSON.parse(e)},Va=()=>{try{return av()||hv()||mv()||fv()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Qm=t=>Va()?.emulatorHosts?.[t],yv=t=>{const e=Qm(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},Jm=()=>Va()?.config,Xm=t=>Va()?.[`_${t}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gv{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mi(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Zm(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pv(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",o=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${n}`,aud:n,iat:o,exp:o+3600,auth_time:o,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[ga(JSON.stringify(r)),ga(JSON.stringify(a)),""].join(".")}const zi={};function vv(){const t={prod:[],emulator:[]};for(const e of Object.keys(zi))zi[e]?t.emulator.push(e):t.prod.push(e);return t}function bv(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let md=!1;function ef(t,e){if(typeof window>"u"||typeof document>"u"||!mi(window.location.host)||zi[t]===e||zi[t]||md)return;zi[t]=e;function r(_){return`__firebase__banner__${_}`}const n="__firebase__banner",i=vv().prod.length>0;function a(){const _=document.getElementById(n);_&&_.remove()}function c(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function d(_,A){_.setAttribute("width","24"),_.setAttribute("id",A),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function h(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{md=!0,a()},_}function m(_,A){_.setAttribute("id",A),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function g(){const _=bv(n),A=r("text"),L=document.getElementById(A)||document.createElement("span"),M=r("learnmore"),$=document.getElementById(M)||document.createElement("a"),T=r("preprendIcon"),ee=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const ce=_.element;c(ce),m($,M);const Z=h();d(ee,T),ce.append(ee,L,$,Z),document.body.appendChild(ce)}i?(L.innerText="Preview backend disconnected.",ee.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(ee.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,L.innerText="Preview backend running in this workspace."),L.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Er(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function _v(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Er())}function Sv(){const t=Va()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Pv(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function wv(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Cv(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Av(){const t=Er();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Iv(){return!Sv()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function xv(){try{return typeof indexedDB=="object"}catch{return!1}}function Ev(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(n);o.onsuccess=()=>{o.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},o.onupgradeneeded=()=>{r=!1},o.onerror=()=>{e(o.error?.message||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tv="FirebaseError";class Ln extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=Tv,Object.setPrototypeOf(this,Ln.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ds.prototype.create)}}class ds{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},o=`${this.service}/${e}`,i=this.errors[e],a=i?$v(i,n):"Error",c=`${this.serviceName}: ${a} (${o}).`;return new Ln(o,c,n)}}function $v(t,e){return t.replace(kv,(r,n)=>{const o=e[n];return o!=null?String(o):`<${n}?>`})}const kv=/\{\$([^}]+)}/g;function Rv(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Io(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const o of r){if(!n.includes(o))return!1;const i=t[o],a=e[o];if(fd(i)&&fd(a)){if(!Io(i,a))return!1}else if(i!==a)return!1}for(const o of n)if(!r.includes(o))return!1;return!0}function fd(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hs(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(o=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Dv(t,e){const r=new Nv(t,e);return r.subscribe.bind(r)}class Nv{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let o;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");Lv(e,["next","error","complete"])?o=e:o={next:e,error:r,complete:n},o.next===void 0&&(o.next=ml),o.error===void 0&&(o.error=ml),o.complete===void 0&&(o.complete=ml);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Lv(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function ml(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pr(t){return t&&t._delegate?t._delegate:t}class xo{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mv{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new gv;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:r});o&&n.resolve(o)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(n)return null;throw o}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Vv(e))try{this.getOrInitializeService({instanceIdentifier:vo})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:o});n.resolve(i)}catch{}}}}clearInstance(e=vo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=vo){return this.instances.has(e)}getOptions(e=vo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);n===c&&a.resolve(o)}return o}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),o=this.onInitCallbacks.get(n)??new Set;o.add(e),this.onInitCallbacks.set(n,o);const i=this.instances.get(n);return i&&e(i,n),()=>{o.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const o of n)try{o(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Ov(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=vo){return this.component?this.component.multipleInstances?e:vo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Ov(t){return t===vo?void 0:t}function Vv(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bv{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new Mv(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var At;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(At||(At={}));const Fv={debug:At.DEBUG,verbose:At.VERBOSE,info:At.INFO,warn:At.WARN,error:At.ERROR,silent:At.SILENT},Uv=At.INFO,jv={[At.DEBUG]:"log",[At.VERBOSE]:"log",[At.INFO]:"info",[At.WARN]:"warn",[At.ERROR]:"error"},zv=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),o=jv[e];if(o)console[o](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Dc{constructor(e){this.name=e,this._logLevel=Uv,this._logHandler=zv,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in At))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Fv[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,At.DEBUG,...e),this._logHandler(this,At.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,At.VERBOSE,...e),this._logHandler(this,At.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,At.INFO,...e),this._logHandler(this,At.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,At.WARN,...e),this._logHandler(this,At.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,At.ERROR,...e),this._logHandler(this,At.ERROR,...e)}}const qv=(t,e)=>e.some(r=>t instanceof r);let yd,gd;function Gv(){return yd||(yd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Hv(){return gd||(gd=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const tf=new WeakMap,Ql=new WeakMap,rf=new WeakMap,fl=new WeakMap,Nc=new WeakMap;function Yv(t){const e=new Promise((r,n)=>{const o=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{r(Wn(t.result)),o()},a=()=>{n(t.error),o()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&tf.set(r,t)}).catch(()=>{}),Nc.set(e,t),e}function Wv(t){if(Ql.has(t))return;const e=new Promise((r,n)=>{const o=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{r(),o()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),o()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});Ql.set(t,e)}let Jl={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Ql.get(t);if(e==="objectStoreNames")return t.objectStoreNames||rf.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Wn(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Kv(t){Jl=t(Jl)}function Qv(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(yl(this),e,...r);return rf.set(n,e.sort?e.sort():[e]),Wn(n)}:Hv().includes(t)?function(...e){return t.apply(yl(this),e),Wn(tf.get(this))}:function(...e){return Wn(t.apply(yl(this),e))}}function Jv(t){return typeof t=="function"?Qv(t):(t instanceof IDBTransaction&&Wv(t),qv(t,Gv())?new Proxy(t,Jl):t)}function Wn(t){if(t instanceof IDBRequest)return Yv(t);if(fl.has(t))return fl.get(t);const e=Jv(t);return e!==t&&(fl.set(t,e),Nc.set(e,t)),e}const yl=t=>Nc.get(t);function Xv(t,e,{blocked:r,upgrade:n,blocking:o,terminated:i}={}){const a=indexedDB.open(t,e),c=Wn(a);return n&&a.addEventListener("upgradeneeded",d=>{n(Wn(a.result),d.oldVersion,d.newVersion,Wn(a.transaction),d)}),r&&a.addEventListener("blocked",d=>r(d.oldVersion,d.newVersion,d)),c.then(d=>{i&&d.addEventListener("close",()=>i()),o&&d.addEventListener("versionchange",h=>o(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const Zv=["get","getKey","getAll","getAllKeys","count"],eb=["put","add","delete","clear"],gl=new Map;function pd(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(gl.get(e))return gl.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,o=eb.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(o||Zv.includes(r)))return;const i=async function(a,...c){const d=this.transaction(a,o?"readwrite":"readonly");let h=d.store;return n&&(h=h.index(c.shift())),(await Promise.all([h[r](...c),o&&d.done]))[0]};return gl.set(e,i),i}Kv(t=>({...t,get:(e,r,n)=>pd(e,r)||t.get(e,r,n),has:(e,r)=>!!pd(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tb{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(rb(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function rb(t){return t.getComponent()?.type==="VERSION"}const Xl="@firebase/app",vd="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tn=new Dc("@firebase/app"),nb="@firebase/app-compat",ob="@firebase/analytics-compat",ib="@firebase/analytics",sb="@firebase/app-check-compat",ab="@firebase/app-check",lb="@firebase/auth",cb="@firebase/auth-compat",ub="@firebase/database",db="@firebase/data-connect",hb="@firebase/database-compat",mb="@firebase/functions",fb="@firebase/functions-compat",yb="@firebase/installations",gb="@firebase/installations-compat",pb="@firebase/messaging",vb="@firebase/messaging-compat",bb="@firebase/performance",_b="@firebase/performance-compat",Sb="@firebase/remote-config",Pb="@firebase/remote-config-compat",wb="@firebase/storage",Cb="@firebase/storage-compat",Ab="@firebase/firestore",Ib="@firebase/ai",xb="@firebase/firestore-compat",Eb="firebase",Tb="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zl="[DEFAULT]",$b={[Xl]:"fire-core",[nb]:"fire-core-compat",[ib]:"fire-analytics",[ob]:"fire-analytics-compat",[ab]:"fire-app-check",[sb]:"fire-app-check-compat",[lb]:"fire-auth",[cb]:"fire-auth-compat",[ub]:"fire-rtdb",[db]:"fire-data-connect",[hb]:"fire-rtdb-compat",[mb]:"fire-fn",[fb]:"fire-fn-compat",[yb]:"fire-iid",[gb]:"fire-iid-compat",[pb]:"fire-fcm",[vb]:"fire-fcm-compat",[bb]:"fire-perf",[_b]:"fire-perf-compat",[Sb]:"fire-rc",[Pb]:"fire-rc-compat",[wb]:"fire-gcs",[Cb]:"fire-gcs-compat",[Ab]:"fire-fst",[xb]:"fire-fst-compat",[Ib]:"fire-vertex","fire-js":"fire-js",[Eb]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pa=new Map,kb=new Map,ec=new Map;function bd(t,e){try{t.container.addComponent(e)}catch(r){Tn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function oi(t){const e=t.name;if(ec.has(e))return Tn.debug(`There were multiple attempts to register component ${e}.`),!1;ec.set(e,t);for(const r of pa.values())bd(r,t);for(const r of kb.values())bd(r,t);return!0}function Lc(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function zr(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rb={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Kn=new ds("app","Firebase",Rb);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Db{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new xo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Kn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fi=Tb;function nf(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:Zl,automaticDataCollectionEnabled:!0,...e},o=n.name;if(typeof o!="string"||!o)throw Kn.create("bad-app-name",{appName:String(o)});if(r||(r=Jm()),!r)throw Kn.create("no-options");const i=pa.get(o);if(i){if(Io(r,i.options)&&Io(n,i.config))return i;throw Kn.create("duplicate-app",{appName:o})}const a=new Bv(o);for(const d of ec.values())a.addComponent(d);const c=new Db(r,n,a);return pa.set(o,c),c}function of(t=Zl){const e=pa.get(t);if(!e&&t===Zl&&Jm())return nf();if(!e)throw Kn.create("no-app",{appName:t});return e}function Qn(t,e,r){let n=$b[t]??t;r&&(n+=`-${r}`);const o=n.match(/\s|\//),i=e.match(/\s|\//);if(o||i){const a=[`Unable to register library "${n}" with version "${e}":`];o&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),o&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Tn.warn(a.join(" "));return}oi(new xo(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nb="firebase-heartbeat-database",Lb=1,es="firebase-heartbeat-store";let pl=null;function sf(){return pl||(pl=Xv(Nb,Lb,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(es)}catch(r){console.warn(r)}}}}).catch(t=>{throw Kn.create("idb-open",{originalErrorMessage:t.message})})),pl}async function Mb(t){try{const r=(await sf()).transaction(es),n=await r.objectStore(es).get(af(t));return await r.done,n}catch(e){if(e instanceof Ln)Tn.warn(e.message);else{const r=Kn.create("idb-get",{originalErrorMessage:e?.message});Tn.warn(r.message)}}}async function _d(t,e){try{const n=(await sf()).transaction(es,"readwrite");await n.objectStore(es).put(e,af(t)),await n.done}catch(r){if(r instanceof Ln)Tn.warn(r.message);else{const n=Kn.create("idb-set",{originalErrorMessage:r?.message});Tn.warn(n.message)}}}function af(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ob=1024,Vb=30;class Bb{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new Ub(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Sd();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(o=>o.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>Vb){const o=jb(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Tn.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Sd(),{heartbeatsToSend:r,unsentEntries:n}=Fb(this._heartbeatsCache.heartbeats),o=ga(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(e){return Tn.warn(e),""}}}function Sd(){return new Date().toISOString().substring(0,10)}function Fb(t,e=Ob){const r=[];let n=t.slice();for(const o of t){const i=r.find(a=>a.agent===o.agent);if(i){if(i.dates.push(o.date),Pd(r)>e){i.dates.pop();break}}else if(r.push({agent:o.agent,dates:[o.date]}),Pd(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class Ub{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return xv()?Ev().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Mb(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return _d(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return _d(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Pd(t){return ga(JSON.stringify({version:2,heartbeats:t})).length}function jb(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zb(t){oi(new xo("platform-logger",e=>new tb(e),"PRIVATE")),oi(new xo("heartbeat",e=>new Bb(e),"PRIVATE")),Qn(Xl,vd,t),Qn(Xl,vd,"esm2020"),Qn("fire-js","")}zb("");function lf(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const qb=lf,cf=new ds("auth","Firebase",lf());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const va=new Dc("@firebase/auth");function Gb(t,...e){va.logLevel<=At.WARN&&va.warn(`Auth (${fi}): ${t}`,...e)}function Zs(t,...e){va.logLevel<=At.ERROR&&va.error(`Auth (${fi}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yn(t,...e){throw Oc(t,...e)}function Jr(t,...e){return Oc(t,...e)}function Mc(t,e,r){const n={...qb(),[e]:r};return new ds("auth","Firebase",n).create(e,{appName:t.name})}function Jn(t){return Mc(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function uf(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&yn(t,"argument-error"),Mc(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Oc(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return cf.create(t,...e)}function lt(t,e,...r){if(!t)throw Oc(e,...r)}function Cn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Zs(e),new Error(e)}function $n(t,e){t||Cn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tc(){return typeof self<"u"&&self.location?.href||""}function Hb(){return wd()==="http:"||wd()==="https:"}function wd(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yb(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Hb()||wv()||"connection"in navigator)?navigator.onLine:!0}function Wb(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms{constructor(e,r){this.shortDelay=e,this.longDelay=r,$n(r>e,"Short delay should be less than long delay!"),this.isMobile=_v()||Cv()}get(){return Yb()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vc(t,e){$n(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Cn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Cn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Cn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kb={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qb=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Jb=new ms(3e4,6e4);function Bc(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function yi(t,e,r,n,o={}){return hf(t,o,async()=>{let i={},a={};n&&(e==="GET"?a=n:i={body:JSON.stringify(n)});const c=hs({key:t.config.apiKey,...a}).slice(1),d=await t._getAdditionalHeaders();d["Content-Type"]="application/json",t.languageCode&&(d["X-Firebase-Locale"]=t.languageCode);const h={method:e,headers:d,...i};return Pv()||(h.referrerPolicy="no-referrer"),t.emulatorConfig&&mi(t.emulatorConfig.host)&&(h.credentials="include"),df.fetch()(await mf(t,t.config.apiHost,r,c),h)})}async function hf(t,e,r){t._canInitEmulator=!1;const n={...Kb,...e};try{const o=new Zb(t),i=await Promise.race([r(),o.promise]);o.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw Ns(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const c=i.ok?a.errorMessage:a.error.message,[d,h]=c.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ns(t,"credential-already-in-use",a);if(d==="EMAIL_EXISTS")throw Ns(t,"email-already-in-use",a);if(d==="USER_DISABLED")throw Ns(t,"user-disabled",a);const m=n[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Mc(t,m,h);yn(t,m)}}catch(o){if(o instanceof Ln)throw o;yn(t,"network-request-failed",{message:String(o)})}}async function Xb(t,e,r,n,o={}){const i=await yi(t,e,r,n,o);return"mfaPendingCredential"in i&&yn(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function mf(t,e,r,n){const o=`${e}${r}?${n}`,i=t,a=i.config.emulator?Vc(t.config,o):`${t.config.apiScheme}://${o}`;return Qb.includes(r)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}class Zb{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Jr(this.auth,"network-request-failed")),Jb.get())})}}function Ns(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const o=Jr(t,e,n);return o.customData._tokenResponse=r,o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e0(t,e){return yi(t,"POST","/v1/accounts:delete",e)}async function ba(t,e){return yi(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qi(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function t0(t,e=!1){const r=pr(t),n=await r.getIdToken(e),o=Fc(n);lt(o&&o.exp&&o.auth_time&&o.iat,r.auth,"internal-error");const i=typeof o.firebase=="object"?o.firebase:void 0,a=i?.sign_in_provider;return{claims:o,token:n,authTime:qi(vl(o.auth_time)),issuedAtTime:qi(vl(o.iat)),expirationTime:qi(vl(o.exp)),signInProvider:a||null,signInSecondFactor:i?.sign_in_second_factor||null}}function vl(t){return Number(t)*1e3}function Fc(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Zs("JWT malformed, contained fewer than 3 sections"),null;try{const o=Km(r);return o?JSON.parse(o):(Zs("Failed to decode base64 JWT payload"),null)}catch(o){return Zs("Caught error parsing JWT payload as JSON",o?.toString()),null}}function Cd(t){const e=Fc(t);return lt(e,"internal-error"),lt(typeof e.exp<"u","internal-error"),lt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ts(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Ln&&r0(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function r0({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n0{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rc{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=qi(this.lastLoginAt),this.creationTime=qi(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _a(t){const e=t.auth,r=await t.getIdToken(),n=await ts(t,ba(e,{idToken:r}));lt(n?.users.length,e,"internal-error");const o=n.users[0];t._notifyReloadListener(o);const i=o.providerUserInfo?.length?ff(o.providerUserInfo):[],a=i0(t.providerData,i),c=t.isAnonymous,d=!(t.email&&o.passwordHash)&&!a?.length,h=c?d:!1,m={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new rc(o.createdAt,o.lastLoginAt),isAnonymous:h};Object.assign(t,m)}async function o0(t){const e=pr(t);await _a(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function i0(t,e){return[...t.filter(n=>!e.some(o=>o.providerId===n.providerId)),...e]}function ff(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s0(t,e){const r=await hf(t,{},async()=>{const n=hs({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:i}=t.config,a=await mf(t,o,"/v1/token",`key=${i}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const d={method:"POST",headers:c,body:n};return t.emulatorConfig&&mi(t.emulatorConfig.host)&&(d.credentials="include"),df.fetch()(a,d)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function a0(t,e){return yi(t,"POST","/v2/accounts:revokeToken",Bc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){lt(e.idToken,"internal-error"),lt(typeof e.idToken<"u","internal-error"),lt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Cd(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){lt(e.length!==0,"internal-error");const r=Cd(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(lt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:o,expiresIn:i}=await s0(e,r);this.updateTokensAndExpiration(n,o,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:o,expirationTime:i}=r,a=new Zo;return n&&(lt(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),o&&(lt(typeof o=="string","internal-error",{appName:e}),a.accessToken=o),i&&(lt(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Zo,this.toJSON())}_performRefresh(){return Cn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fn(t,e){lt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Qr{constructor({uid:e,auth:r,stsTokenManager:n,...o}){this.providerId="firebase",this.proactiveRefresh=new n0(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new rc(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const r=await ts(this,this.stsTokenManager.getToken(this.auth,e));return lt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return t0(this,e)}reload(){return o0(this)}_assign(e){this!==e&&(lt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Qr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){lt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await _a(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(zr(this.auth.app))return Promise.reject(Jn(this.auth));const e=await this.getIdToken();return await ts(this,e0(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,o=r.email??void 0,i=r.phoneNumber??void 0,a=r.photoURL??void 0,c=r.tenantId??void 0,d=r._redirectEventId??void 0,h=r.createdAt??void 0,m=r.lastLoginAt??void 0,{uid:g,emailVerified:_,isAnonymous:A,providerData:L,stsTokenManager:M}=r;lt(g&&M,e,"internal-error");const $=Zo.fromJSON(this.name,M);lt(typeof g=="string",e,"internal-error"),Fn(n,e.name),Fn(o,e.name),lt(typeof _=="boolean",e,"internal-error"),lt(typeof A=="boolean",e,"internal-error"),Fn(i,e.name),Fn(a,e.name),Fn(c,e.name),Fn(d,e.name),Fn(h,e.name),Fn(m,e.name);const T=new Qr({uid:g,auth:e,email:o,emailVerified:_,displayName:n,isAnonymous:A,photoURL:a,phoneNumber:i,tenantId:c,stsTokenManager:$,createdAt:h,lastLoginAt:m});return L&&Array.isArray(L)&&(T.providerData=L.map(ee=>({...ee}))),d&&(T._redirectEventId=d),T}static async _fromIdTokenResponse(e,r,n=!1){const o=new Zo;o.updateFromServerResponse(r);const i=new Qr({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:n});return await _a(i),i}static async _fromGetAccountInfoResponse(e,r,n){const o=r.users[0];lt(o.localId!==void 0,"internal-error");const i=o.providerUserInfo!==void 0?ff(o.providerUserInfo):[],a=!(o.email&&o.passwordHash)&&!i?.length,c=new Zo;c.updateFromIdToken(n);const d=new Qr({uid:o.localId,auth:e,stsTokenManager:c,isAnonymous:a}),h={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:i,metadata:new rc(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!i?.length};return Object.assign(d,h),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ad=new Map;function An(t){$n(t instanceof Function,"Expected a class definition");let e=Ad.get(t);return e?($n(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Ad.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}yf.type="NONE";const Id=yf;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ea(t,e,r){return`firebase:${t}:${e}:${r}`}class ei{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:o,name:i}=this.auth;this.fullUserKey=ea(this.userKey,o.apiKey,i),this.fullPersistenceKey=ea("persistence",o.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await ba(this.auth,{idToken:e}).catch(()=>{});return r?Qr._fromGetAccountInfoResponse(this.auth,r,e):null}return Qr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new ei(An(Id),e,n);const o=(await Promise.all(r.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=o[0]||An(Id);const a=ea(n,e.config.apiKey,e.name);let c=null;for(const h of r)try{const m=await h._get(a);if(m){let g;if(typeof m=="string"){const _=await ba(e,{idToken:m}).catch(()=>{});if(!_)break;g=await Qr._fromGetAccountInfoResponse(e,_,m)}else g=Qr._fromJSON(e,m);h!==i&&(c=g),i=h;break}}catch{}const d=o.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!d.length?new ei(i,e,n):(i=d[0],c&&await i._set(a,c.toJSON()),await Promise.all(r.map(async h=>{if(h!==i)try{await h._remove(a)}catch{}})),new ei(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xd(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(bf(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(gf(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Sf(e))return"Blackberry";if(Pf(e))return"Webos";if(pf(e))return"Safari";if((e.includes("chrome/")||vf(e))&&!e.includes("edge/"))return"Chrome";if(_f(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function gf(t=Er()){return/firefox\//i.test(t)}function pf(t=Er()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function vf(t=Er()){return/crios\//i.test(t)}function bf(t=Er()){return/iemobile/i.test(t)}function _f(t=Er()){return/android/i.test(t)}function Sf(t=Er()){return/blackberry/i.test(t)}function Pf(t=Er()){return/webos/i.test(t)}function Uc(t=Er()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function l0(t=Er()){return Uc(t)&&!!window.navigator?.standalone}function c0(){return Av()&&document.documentMode===10}function wf(t=Er()){return Uc(t)||_f(t)||Pf(t)||Sf(t)||/windows phone/i.test(t)||bf(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cf(t,e=[]){let r;switch(t){case"Browser":r=xd(Er());break;case"Worker":r=`${xd(Er())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${fi}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u0{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((a,c)=>{try{const d=e(i);a(d)}catch(d){c(d)}});n.onAbort=r,this.queue.push(n);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const o of r)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d0(t,e={}){return yi(t,"GET","/v2/passwordPolicy",Bc(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h0=6;class m0{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??h0,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),o&&(r.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let o=0;o<e.length;o++)n=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,o,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f0{constructor(e,r,n,o){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ed(this),this.idTokenSubscription=new Ed(this),this.beforeStateQueue=new u0(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=cf,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=An(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await ei.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await ba(this,{idToken:e}),n=await Qr._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(zr(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,a=n?._redirectEventId,c=await this.tryRedirectSignIn(e);(!i||i===a)&&c?.user&&(n=c.user,o=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(n)}catch(i){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return lt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await _a(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Wb()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(zr(this.app))return Promise.reject(Jn(this));const r=e?pr(e):null;return r&&lt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&lt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return zr(this.app)?Promise.reject(Jn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return zr(this.app)?Promise.reject(Jn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(An(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await d0(this),r=new m0(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ds("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await a0(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&An(e)||this._popupRedirectResolver;lt(r,this,"argument-error"),this.redirectPersistenceManager=await ei.create(this,[An(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,o){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(lt(c,this,"internal-error"),c.then(()=>{a||i(this.currentUser)}),typeof r=="function"){const d=e.addObserver(r,n,o);return()=>{a=!0,d()}}else{const d=e.addObserver(r);return()=>{a=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return lt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Cf(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(zr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Gb(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Ro(t){return pr(t)}class Ed{constructor(e){this.auth=e,this.observer=null,this.addObserver=Dv(r=>this.observer=r)}get next(){return lt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function y0(t){jc=t}function g0(t){return jc.loadJS(t)}function p0(){return jc.gapiScript}function v0(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b0(t,e){const r=Lc(t,"auth");if(r.isInitialized()){const o=r.getImmediate(),i=r.getOptions();if(Io(i,e??{}))return o;yn(o,"already-initialized")}return r.initialize({options:e})}function _0(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(An);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function S0(t,e,r){const n=Ro(t);lt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const o=!1,i=Af(e),{host:a,port:c}=P0(e),d=c===null?"":`:${c}`,h={url:`${i}//${a}${d}/`},m=Object.freeze({host:a,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!n._canInitEmulator){lt(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),lt(Io(h,n.config.emulator)&&Io(m,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=h,n.emulatorConfig=m,n.settings.appVerificationDisabledForTesting=!0,mi(a)?(Zm(`${i}//${a}${d}`),ef("Auth",!0)):w0()}function Af(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function P0(t){const e=Af(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(n);if(o){const i=o[1];return{host:i,port:Td(n.substr(i.length+1))}}else{const[i,a]=n.split(":");return{host:i,port:Td(a)}}}function Td(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function w0(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Cn("not implemented")}_getIdTokenResponse(e){return Cn("not implemented")}_linkToIdToken(e,r){return Cn("not implemented")}_getReauthenticationResolver(e){return Cn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ti(t,e){return Xb(t,"POST","/v1/accounts:signInWithIdp",Bc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C0="http://localhost";class Eo extends If{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Eo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):yn("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:o,...i}=r;if(!n||!o)return null;const a=new Eo(n,o);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return ti(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,ti(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,ti(e,r)}buildRequest(){const e={requestUri:C0,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=hs(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ba{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs extends Ba{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn extends fs{constructor(){super("facebook.com")}static credential(e){return Eo._fromParams({providerId:qn.PROVIDER_ID,signInMethod:qn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return qn.credentialFromTaggedObject(e)}static credentialFromError(e){return qn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return qn.credential(e.oauthAccessToken)}catch{return null}}}qn.FACEBOOK_SIGN_IN_METHOD="facebook.com";qn.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an extends fs{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Eo._fromParams({providerId:an.PROVIDER_ID,signInMethod:an.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return an.credentialFromTaggedObject(e)}static credentialFromError(e){return an.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return an.credential(r,n)}catch{return null}}}an.GOOGLE_SIGN_IN_METHOD="google.com";an.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn extends fs{constructor(){super("github.com")}static credential(e){return Eo._fromParams({providerId:Gn.PROVIDER_ID,signInMethod:Gn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gn.credentialFromTaggedObject(e)}static credentialFromError(e){return Gn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Gn.credential(e.oauthAccessToken)}catch{return null}}}Gn.GITHUB_SIGN_IN_METHOD="github.com";Gn.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn extends fs{constructor(){super("twitter.com")}static credential(e,r){return Eo._fromParams({providerId:Hn.PROVIDER_ID,signInMethod:Hn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Hn.credentialFromTaggedObject(e)}static credentialFromError(e){return Hn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Hn.credential(r,n)}catch{return null}}}Hn.TWITTER_SIGN_IN_METHOD="twitter.com";Hn.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,o=!1){const i=await Qr._fromIdTokenResponse(e,n,o),a=$d(n);return new ii({user:i,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const o=$d(n);return new ii({user:e,providerId:o,_tokenResponse:n,operationType:r})}}function $d(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa extends Ln{constructor(e,r,n,o){super(r.code,r.message),this.operationType=n,this.user=o,Object.setPrototypeOf(this,Sa.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,o){return new Sa(e,r,n,o)}}function xf(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Sa._fromErrorAndOperation(t,i,e,n):i})}async function A0(t,e,r=!1){const n=await ts(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return ii._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I0(t,e,r=!1){const{auth:n}=t;if(zr(n.app))return Promise.reject(Jn(n));const o="reauthenticate";try{const i=await ts(t,xf(n,o,e,t),r);lt(i.idToken,n,"internal-error");const a=Fc(i.idToken);lt(a,n,"internal-error");const{sub:c}=a;return lt(t.uid===c,n,"user-mismatch"),ii._forOperation(t,o,i)}catch(i){throw i?.code==="auth/user-not-found"&&yn(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ef(t,e,r=!1){if(zr(t.app))return Promise.reject(Jn(t));const n="signIn",o=await xf(t,n,e),i=await ii._fromIdTokenResponse(t,n,o);return r||await t._updateCurrentUser(i.user),i}async function x0(t,e){return Ef(Ro(t),e)}function E0(t,e,r,n){return pr(t).onIdTokenChanged(e,r,n)}function T0(t,e,r){return pr(t).beforeAuthStateChanged(e,r)}function $0(t,e,r,n){return pr(t).onAuthStateChanged(e,r,n)}function k0(t){return pr(t).signOut()}const Pa="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Pa,"1"),this.storage.removeItem(Pa),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R0=1e3,D0=10;class $f extends Tf{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=wf(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),o=this.localCache[r];n!==o&&e(r,o,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,c,d)=>{this.notifyListeners(a,d)});return}const n=e.key;r?this.detachListener():this.stopPolling();const o=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},i=this.storage.getItem(n);c0()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,D0):o()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const o of Array.from(n))o(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},R0)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}$f.type="LOCAL";const N0=$f;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf extends Tf{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}kf.type="SESSION";const Rf=kf;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L0(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(o=>o.isListeningto(e));if(r)return r;const n=new Fa(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:o,data:i}=r.data,a=this.handlersMap[o];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:o});const c=Array.from(a).map(async h=>h(r.origin,i)),d=await L0(c);r.ports[0].postMessage({status:"done",eventId:n,eventType:o,response:d})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Fa.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zc(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let i,a;return new Promise((c,d)=>{const h=zc("",20);o.port1.start();const m=setTimeout(()=>{d(new Error("unsupported_event"))},n);a={messageChannel:o,onMessage(g){const _=g;if(_.data.eventId===h)switch(_.data.status){case"ack":clearTimeout(m),i=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(_.data.response);break;default:clearTimeout(m),clearTimeout(i),d(new Error("invalid_response"));break}}},this.handlers.add(a),o.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:h,data:r},[o.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cn(){return window}function O0(t){cn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Df(){return typeof cn().WorkerGlobalScope<"u"&&typeof cn().importScripts=="function"}async function V0(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function B0(){return navigator?.serviceWorker?.controller||null}function F0(){return Df()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nf="firebaseLocalStorageDb",U0=1,wa="firebaseLocalStorage",Lf="fbase_key";class ys{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Ua(t,e){return t.transaction([wa],e?"readwrite":"readonly").objectStore(wa)}function j0(){const t=indexedDB.deleteDatabase(Nf);return new ys(t).toPromise()}function nc(){const t=indexedDB.open(Nf,U0);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(wa,{keyPath:Lf})}catch(o){r(o)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(wa)?e(n):(n.close(),await j0(),e(await nc()))})})}async function kd(t,e,r){const n=Ua(t,!0).put({[Lf]:e,value:r});return new ys(n).toPromise()}async function z0(t,e){const r=Ua(t,!1).get(e),n=await new ys(r).toPromise();return n===void 0?null:n.value}function Rd(t,e){const r=Ua(t,!0).delete(e);return new ys(r).toPromise()}const q0=800,G0=3;class Mf{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await nc(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>G0)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Df()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Fa._getInstance(F0()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await V0(),!this.activeServiceWorker)return;this.sender=new M0(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||B0()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await nc();return await kd(e,Pa,"1"),await Rd(e,Pa),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>kd(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>z0(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>Rd(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const i=Ua(o,!1).getAll();return new ys(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:o,value:i}of e)n.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(i)&&(this.notifyListeners(o,i),r.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!n.has(o)&&(this.notifyListeners(o,null),r.push(o));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const o of Array.from(n))o(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),q0)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Mf.type="LOCAL";const H0=Mf;new ms(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qc(t,e){return e?An(e):(lt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gc extends If{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ti(e,this._buildIdpRequest())}_linkToIdToken(e,r){return ti(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return ti(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function Y0(t){return Ef(t.auth,new Gc(t),t.bypassAuthState)}function W0(t){const{auth:e,user:r}=t;return lt(r,e,"internal-error"),I0(r,new Gc(t),t.bypassAuthState)}async function K0(t){const{auth:e,user:r}=t;return lt(r,e,"internal-error"),A0(r,new Gc(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Of{constructor(e,r,n,o,i=!1){this.auth=e,this.resolver=n,this.user=o,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:o,tenantId:i,error:a,type:c}=e;if(a){this.reject(a);return}const d={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(d))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Y0;case"linkViaPopup":case"linkViaRedirect":return K0;case"reauthViaPopup":case"reauthViaRedirect":return W0;default:yn(this.auth,"internal-error")}}resolve(e){$n(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){$n(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q0=new ms(2e3,1e4);async function J0(t,e,r){if(zr(t.app))return Promise.reject(Jr(t,"operation-not-supported-in-this-environment"));const n=Ro(t);uf(t,e,Ba);const o=qc(n,r);return new Po(n,"signInViaPopup",e,o).executeNotNull()}class Po extends Of{constructor(e,r,n,o,i){super(e,r,o,i),this.provider=n,this.authWindow=null,this.pollId=null,Po.currentPopupAction&&Po.currentPopupAction.cancel(),Po.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return lt(e,this.auth,"internal-error"),e}async onExecution(){$n(this.filter.length===1,"Popup operations only handle one event");const e=zc();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Jr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Jr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Po.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Jr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Q0.get())};e()}}Po.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X0="pendingRedirect",ta=new Map;class Z0 extends Of{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=ta.get(this.auth._key());if(!e){try{const n=await e_(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}ta.set(this.auth._key(),e)}return this.bypassAuthState||ta.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function e_(t,e){const r=Bf(e),n=Vf(t);if(!await n._isAvailable())return!1;const o=await n._get(r)==="true";return await n._remove(r),o}async function t_(t,e){return Vf(t)._set(Bf(e),"true")}function r_(t,e){ta.set(t._key(),e)}function Vf(t){return An(t._redirectPersistence)}function Bf(t){return ea(X0,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n_(t,e,r){return o_(t,e,r)}async function o_(t,e,r){if(zr(t.app))return Promise.reject(Jn(t));const n=Ro(t);uf(t,e,Ba),await n._initializationPromise;const o=qc(n,r);return await t_(o,n),o._openRedirect(n,e,"signInViaRedirect")}async function i_(t,e){return await Ro(t)._initializationPromise,Ff(t,e,!1)}async function Ff(t,e,r=!1){if(zr(t.app))return Promise.reject(Jn(t));const n=Ro(t),o=qc(n,e),a=await new Z0(n,o,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s_=10*60*1e3;class a_{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!l_(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!Uf(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(Jr(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=s_&&this.cachedEventUids.clear(),this.cachedEventUids.has(Dd(e))}saveEventToCache(e){this.cachedEventUids.add(Dd(e)),this.lastProcessedEventTime=Date.now()}}function Dd(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Uf({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function l_(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Uf(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c_(t,e={}){return yi(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u_=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,d_=/^https?/;async function h_(t){if(t.config.emulator)return;const{authorizedDomains:e}=await c_(t);for(const r of e)try{if(m_(r))return}catch{}yn(t,"unauthorized-domain")}function m_(t){const e=tc(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!d_.test(r))return!1;if(u_.test(t))return n===t;const o=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f_=new ms(3e4,6e4);function Nd(){const t=cn().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function y_(t){return new Promise((e,r)=>{function n(){Nd(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Nd(),r(Jr(t,"network-request-failed"))},timeout:f_.get()})}if(cn().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(cn().gapi?.load)n();else{const o=v0("iframefcb");return cn()[o]=()=>{gapi.load?n():r(Jr(t,"network-request-failed"))},g0(`${p0()}?onload=${o}`).catch(i=>r(i))}}).catch(e=>{throw ra=null,e})}let ra=null;function g_(t){return ra=ra||y_(t),ra}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p_=new ms(5e3,15e3),v_="__/auth/iframe",b_="emulator/auth/iframe",__={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},S_=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function P_(t){const e=t.config;lt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Vc(e,b_):`https://${t.config.authDomain}/${v_}`,n={apiKey:e.apiKey,appName:t.name,v:fi},o=S_.get(t.config.apiHost);o&&(n.eid=o);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${hs(n).slice(1)}`}async function w_(t){const e=await g_(t),r=cn().gapi;return lt(r,t,"internal-error"),e.open({where:document.body,url:P_(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:__,dontclear:!0},n=>new Promise(async(o,i)=>{await n.restyle({setHideOnLeave:!1});const a=Jr(t,"network-request-failed"),c=cn().setTimeout(()=>{i(a)},p_.get());function d(){cn().clearTimeout(c),o(n)}n.ping(d).then(d,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C_={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},A_=500,I_=600,x_="_blank",E_="http://localhost";class Ld{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function T_(t,e,r,n=A_,o=I_){const i=Math.max((window.screen.availHeight-o)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const d={...C_,width:n.toString(),height:o.toString(),top:i,left:a},h=Er().toLowerCase();r&&(c=vf(h)?x_:r),gf(h)&&(e=e||E_,d.scrollbars="yes");const m=Object.entries(d).reduce((_,[A,L])=>`${_}${A}=${L},`,"");if(l0(h)&&c!=="_self")return $_(e||"",c),new Ld(null);const g=window.open(e||"",c,m);lt(g,t,"popup-blocked");try{g.focus()}catch{}return new Ld(g)}function $_(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k_="__/auth/handler",R_="emulator/auth/handler",D_=encodeURIComponent("fac");async function Md(t,e,r,n,o,i){lt(t.config.authDomain,t,"auth-domain-config-required"),lt(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:fi,eventId:o};if(e instanceof Ba){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",Rv(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,g]of Object.entries({}))a[m]=g}if(e instanceof fs){const m=e.getScopes().filter(g=>g!=="");m.length>0&&(a.scopes=m.join(","))}t.tenantId&&(a.tid=t.tenantId);const c=a;for(const m of Object.keys(c))c[m]===void 0&&delete c[m];const d=await t._getAppCheckToken(),h=d?`#${D_}=${encodeURIComponent(d)}`:"";return`${N_(t)}?${hs(c).slice(1)}${h}`}function N_({config:t}){return t.emulator?Vc(t,R_):`https://${t.authDomain}/${k_}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bl="webStorageSupport";class L_{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Rf,this._completeRedirectFn=Ff,this._overrideRedirectResult=r_}async _openPopup(e,r,n,o){$n(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await Md(e,r,n,tc(),o);return T_(e,i,zc())}async _openRedirect(e,r,n,o){await this._originValidation(e);const i=await Md(e,r,n,tc(),o);return O0(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:o,promise:i}=this.eventManagers[r];return o?Promise.resolve(o):($n(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await w_(e),n=new a_(e);return r.register("authEvent",o=>(lt(o?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(bl,{type:bl},o=>{const i=o?.[0]?.[bl];i!==void 0&&r(!!i),yn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=h_(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return wf()||pf()||Uc()}}const M_=L_;var Od="@firebase/auth",Vd="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O_{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){lt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V_(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function B_(t){oi(new xo("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=n.options;lt(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const d={apiKey:a,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Cf(t)},h=new f0(n,o,i,d);return _0(h,r),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),oi(new xo("auth-internal",e=>{const r=Ro(e.getProvider("auth").getImmediate());return(n=>new O_(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Qn(Od,Vd,V_(t)),Qn(Od,Vd,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F_=5*60,U_=Xm("authIdTokenMaxAge")||F_;let Bd=null;const j_=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>U_)return;const o=r?.token;Bd!==o&&(Bd=o,await fetch(t,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function z_(t=of()){const e=Lc(t,"auth");if(e.isInitialized())return e.getImmediate();const r=b0(t,{popupRedirectResolver:M_,persistence:[H0,N0,Rf]}),n=Xm("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const a=j_(i.toString());T0(r,a,()=>a(r.currentUser)),E0(r,c=>a(c))}}const o=Qm("auth");return o&&S0(r,`http://${o}`),r}function q_(){return document.getElementsByTagName("head")?.[0]??document}y0({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=o=>{const i=Jr("internal-error");i.customData=o,r(i)},n.type="text/javascript",n.charset="UTF-8",q_().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});B_("Browser");var G_="firebase",H_="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Qn(G_,H_,"app");var Fd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Xn,jf;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,S){function p(){}p.prototype=S.prototype,w.D=S.prototype,w.prototype=new p,w.prototype.constructor=w,w.C=function(C,P,x){for(var y=Array(arguments.length-2),ue=2;ue<arguments.length;ue++)y[ue-2]=arguments[ue];return S.prototype[P].apply(C,y)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(w,S,p){p||(p=0);var C=Array(16);if(typeof S=="string")for(var P=0;16>P;++P)C[P]=S.charCodeAt(p++)|S.charCodeAt(p++)<<8|S.charCodeAt(p++)<<16|S.charCodeAt(p++)<<24;else for(P=0;16>P;++P)C[P]=S[p++]|S[p++]<<8|S[p++]<<16|S[p++]<<24;S=w.g[0],p=w.g[1],P=w.g[2];var x=w.g[3],y=S+(x^p&(P^x))+C[0]+3614090360&4294967295;S=p+(y<<7&4294967295|y>>>25),y=x+(P^S&(p^P))+C[1]+3905402710&4294967295,x=S+(y<<12&4294967295|y>>>20),y=P+(p^x&(S^p))+C[2]+606105819&4294967295,P=x+(y<<17&4294967295|y>>>15),y=p+(S^P&(x^S))+C[3]+3250441966&4294967295,p=P+(y<<22&4294967295|y>>>10),y=S+(x^p&(P^x))+C[4]+4118548399&4294967295,S=p+(y<<7&4294967295|y>>>25),y=x+(P^S&(p^P))+C[5]+1200080426&4294967295,x=S+(y<<12&4294967295|y>>>20),y=P+(p^x&(S^p))+C[6]+2821735955&4294967295,P=x+(y<<17&4294967295|y>>>15),y=p+(S^P&(x^S))+C[7]+4249261313&4294967295,p=P+(y<<22&4294967295|y>>>10),y=S+(x^p&(P^x))+C[8]+1770035416&4294967295,S=p+(y<<7&4294967295|y>>>25),y=x+(P^S&(p^P))+C[9]+2336552879&4294967295,x=S+(y<<12&4294967295|y>>>20),y=P+(p^x&(S^p))+C[10]+4294925233&4294967295,P=x+(y<<17&4294967295|y>>>15),y=p+(S^P&(x^S))+C[11]+2304563134&4294967295,p=P+(y<<22&4294967295|y>>>10),y=S+(x^p&(P^x))+C[12]+1804603682&4294967295,S=p+(y<<7&4294967295|y>>>25),y=x+(P^S&(p^P))+C[13]+4254626195&4294967295,x=S+(y<<12&4294967295|y>>>20),y=P+(p^x&(S^p))+C[14]+2792965006&4294967295,P=x+(y<<17&4294967295|y>>>15),y=p+(S^P&(x^S))+C[15]+1236535329&4294967295,p=P+(y<<22&4294967295|y>>>10),y=S+(P^x&(p^P))+C[1]+4129170786&4294967295,S=p+(y<<5&4294967295|y>>>27),y=x+(p^P&(S^p))+C[6]+3225465664&4294967295,x=S+(y<<9&4294967295|y>>>23),y=P+(S^p&(x^S))+C[11]+643717713&4294967295,P=x+(y<<14&4294967295|y>>>18),y=p+(x^S&(P^x))+C[0]+3921069994&4294967295,p=P+(y<<20&4294967295|y>>>12),y=S+(P^x&(p^P))+C[5]+3593408605&4294967295,S=p+(y<<5&4294967295|y>>>27),y=x+(p^P&(S^p))+C[10]+38016083&4294967295,x=S+(y<<9&4294967295|y>>>23),y=P+(S^p&(x^S))+C[15]+3634488961&4294967295,P=x+(y<<14&4294967295|y>>>18),y=p+(x^S&(P^x))+C[4]+3889429448&4294967295,p=P+(y<<20&4294967295|y>>>12),y=S+(P^x&(p^P))+C[9]+568446438&4294967295,S=p+(y<<5&4294967295|y>>>27),y=x+(p^P&(S^p))+C[14]+3275163606&4294967295,x=S+(y<<9&4294967295|y>>>23),y=P+(S^p&(x^S))+C[3]+4107603335&4294967295,P=x+(y<<14&4294967295|y>>>18),y=p+(x^S&(P^x))+C[8]+1163531501&4294967295,p=P+(y<<20&4294967295|y>>>12),y=S+(P^x&(p^P))+C[13]+2850285829&4294967295,S=p+(y<<5&4294967295|y>>>27),y=x+(p^P&(S^p))+C[2]+4243563512&4294967295,x=S+(y<<9&4294967295|y>>>23),y=P+(S^p&(x^S))+C[7]+1735328473&4294967295,P=x+(y<<14&4294967295|y>>>18),y=p+(x^S&(P^x))+C[12]+2368359562&4294967295,p=P+(y<<20&4294967295|y>>>12),y=S+(p^P^x)+C[5]+4294588738&4294967295,S=p+(y<<4&4294967295|y>>>28),y=x+(S^p^P)+C[8]+2272392833&4294967295,x=S+(y<<11&4294967295|y>>>21),y=P+(x^S^p)+C[11]+1839030562&4294967295,P=x+(y<<16&4294967295|y>>>16),y=p+(P^x^S)+C[14]+4259657740&4294967295,p=P+(y<<23&4294967295|y>>>9),y=S+(p^P^x)+C[1]+2763975236&4294967295,S=p+(y<<4&4294967295|y>>>28),y=x+(S^p^P)+C[4]+1272893353&4294967295,x=S+(y<<11&4294967295|y>>>21),y=P+(x^S^p)+C[7]+4139469664&4294967295,P=x+(y<<16&4294967295|y>>>16),y=p+(P^x^S)+C[10]+3200236656&4294967295,p=P+(y<<23&4294967295|y>>>9),y=S+(p^P^x)+C[13]+681279174&4294967295,S=p+(y<<4&4294967295|y>>>28),y=x+(S^p^P)+C[0]+3936430074&4294967295,x=S+(y<<11&4294967295|y>>>21),y=P+(x^S^p)+C[3]+3572445317&4294967295,P=x+(y<<16&4294967295|y>>>16),y=p+(P^x^S)+C[6]+76029189&4294967295,p=P+(y<<23&4294967295|y>>>9),y=S+(p^P^x)+C[9]+3654602809&4294967295,S=p+(y<<4&4294967295|y>>>28),y=x+(S^p^P)+C[12]+3873151461&4294967295,x=S+(y<<11&4294967295|y>>>21),y=P+(x^S^p)+C[15]+530742520&4294967295,P=x+(y<<16&4294967295|y>>>16),y=p+(P^x^S)+C[2]+3299628645&4294967295,p=P+(y<<23&4294967295|y>>>9),y=S+(P^(p|~x))+C[0]+4096336452&4294967295,S=p+(y<<6&4294967295|y>>>26),y=x+(p^(S|~P))+C[7]+1126891415&4294967295,x=S+(y<<10&4294967295|y>>>22),y=P+(S^(x|~p))+C[14]+2878612391&4294967295,P=x+(y<<15&4294967295|y>>>17),y=p+(x^(P|~S))+C[5]+4237533241&4294967295,p=P+(y<<21&4294967295|y>>>11),y=S+(P^(p|~x))+C[12]+1700485571&4294967295,S=p+(y<<6&4294967295|y>>>26),y=x+(p^(S|~P))+C[3]+2399980690&4294967295,x=S+(y<<10&4294967295|y>>>22),y=P+(S^(x|~p))+C[10]+4293915773&4294967295,P=x+(y<<15&4294967295|y>>>17),y=p+(x^(P|~S))+C[1]+2240044497&4294967295,p=P+(y<<21&4294967295|y>>>11),y=S+(P^(p|~x))+C[8]+1873313359&4294967295,S=p+(y<<6&4294967295|y>>>26),y=x+(p^(S|~P))+C[15]+4264355552&4294967295,x=S+(y<<10&4294967295|y>>>22),y=P+(S^(x|~p))+C[6]+2734768916&4294967295,P=x+(y<<15&4294967295|y>>>17),y=p+(x^(P|~S))+C[13]+1309151649&4294967295,p=P+(y<<21&4294967295|y>>>11),y=S+(P^(p|~x))+C[4]+4149444226&4294967295,S=p+(y<<6&4294967295|y>>>26),y=x+(p^(S|~P))+C[11]+3174756917&4294967295,x=S+(y<<10&4294967295|y>>>22),y=P+(S^(x|~p))+C[2]+718787259&4294967295,P=x+(y<<15&4294967295|y>>>17),y=p+(x^(P|~S))+C[9]+3951481745&4294967295,w.g[0]=w.g[0]+S&4294967295,w.g[1]=w.g[1]+(P+(y<<21&4294967295|y>>>11))&4294967295,w.g[2]=w.g[2]+P&4294967295,w.g[3]=w.g[3]+x&4294967295}n.prototype.u=function(w,S){S===void 0&&(S=w.length);for(var p=S-this.blockSize,C=this.B,P=this.h,x=0;x<S;){if(P==0)for(;x<=p;)o(this,w,x),x+=this.blockSize;if(typeof w=="string"){for(;x<S;)if(C[P++]=w.charCodeAt(x++),P==this.blockSize){o(this,C),P=0;break}}else for(;x<S;)if(C[P++]=w[x++],P==this.blockSize){o(this,C),P=0;break}}this.h=P,this.o+=S},n.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var S=1;S<w.length-8;++S)w[S]=0;var p=8*this.o;for(S=w.length-8;S<w.length;++S)w[S]=p&255,p/=256;for(this.u(w),w=Array(16),S=p=0;4>S;++S)for(var C=0;32>C;C+=8)w[p++]=this.g[S]>>>C&255;return w};function i(w,S){var p=c;return Object.prototype.hasOwnProperty.call(p,w)?p[w]:p[w]=S(w)}function a(w,S){this.h=S;for(var p=[],C=!0,P=w.length-1;0<=P;P--){var x=w[P]|0;C&&x==S||(p[P]=x,C=!1)}this.g=p}var c={};function d(w){return-128<=w&&128>w?i(w,function(S){return new a([S|0],0>S?-1:0)}):new a([w|0],0>w?-1:0)}function h(w){if(isNaN(w)||!isFinite(w))return g;if(0>w)return $(h(-w));for(var S=[],p=1,C=0;w>=p;C++)S[C]=w/p|0,p*=4294967296;return new a(S,0)}function m(w,S){if(w.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(w.charAt(0)=="-")return $(m(w.substring(1),S));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var p=h(Math.pow(S,8)),C=g,P=0;P<w.length;P+=8){var x=Math.min(8,w.length-P),y=parseInt(w.substring(P,P+x),S);8>x?(x=h(Math.pow(S,x)),C=C.j(x).add(h(y))):(C=C.j(p),C=C.add(h(y)))}return C}var g=d(0),_=d(1),A=d(16777216);t=a.prototype,t.m=function(){if(M(this))return-$(this).m();for(var w=0,S=1,p=0;p<this.g.length;p++){var C=this.i(p);w+=(0<=C?C:4294967296+C)*S,S*=4294967296}return w},t.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(L(this))return"0";if(M(this))return"-"+$(this).toString(w);for(var S=h(Math.pow(w,6)),p=this,C="";;){var P=Z(p,S).g;p=T(p,P.j(S));var x=((0<p.g.length?p.g[0]:p.h)>>>0).toString(w);if(p=P,L(p))return x+C;for(;6>x.length;)x="0"+x;C=x+C}},t.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function L(w){if(w.h!=0)return!1;for(var S=0;S<w.g.length;S++)if(w.g[S]!=0)return!1;return!0}function M(w){return w.h==-1}t.l=function(w){return w=T(this,w),M(w)?-1:L(w)?0:1};function $(w){for(var S=w.g.length,p=[],C=0;C<S;C++)p[C]=~w.g[C];return new a(p,~w.h).add(_)}t.abs=function(){return M(this)?$(this):this},t.add=function(w){for(var S=Math.max(this.g.length,w.g.length),p=[],C=0,P=0;P<=S;P++){var x=C+(this.i(P)&65535)+(w.i(P)&65535),y=(x>>>16)+(this.i(P)>>>16)+(w.i(P)>>>16);C=y>>>16,x&=65535,y&=65535,p[P]=y<<16|x}return new a(p,p[p.length-1]&-2147483648?-1:0)};function T(w,S){return w.add($(S))}t.j=function(w){if(L(this)||L(w))return g;if(M(this))return M(w)?$(this).j($(w)):$($(this).j(w));if(M(w))return $(this.j($(w)));if(0>this.l(A)&&0>w.l(A))return h(this.m()*w.m());for(var S=this.g.length+w.g.length,p=[],C=0;C<2*S;C++)p[C]=0;for(C=0;C<this.g.length;C++)for(var P=0;P<w.g.length;P++){var x=this.i(C)>>>16,y=this.i(C)&65535,ue=w.i(P)>>>16,J=w.i(P)&65535;p[2*C+2*P]+=y*J,ee(p,2*C+2*P),p[2*C+2*P+1]+=x*J,ee(p,2*C+2*P+1),p[2*C+2*P+1]+=y*ue,ee(p,2*C+2*P+1),p[2*C+2*P+2]+=x*ue,ee(p,2*C+2*P+2)}for(C=0;C<S;C++)p[C]=p[2*C+1]<<16|p[2*C];for(C=S;C<2*S;C++)p[C]=0;return new a(p,0)};function ee(w,S){for(;(w[S]&65535)!=w[S];)w[S+1]+=w[S]>>>16,w[S]&=65535,S++}function ce(w,S){this.g=w,this.h=S}function Z(w,S){if(L(S))throw Error("division by zero");if(L(w))return new ce(g,g);if(M(w))return S=Z($(w),S),new ce($(S.g),$(S.h));if(M(S))return S=Z(w,$(S)),new ce($(S.g),S.h);if(30<w.g.length){if(M(w)||M(S))throw Error("slowDivide_ only works with positive integers.");for(var p=_,C=S;0>=C.l(w);)p=ge(p),C=ge(C);var P=ne(p,1),x=ne(C,1);for(C=ne(C,2),p=ne(p,2);!L(C);){var y=x.add(C);0>=y.l(w)&&(P=P.add(p),x=y),C=ne(C,1),p=ne(p,1)}return S=T(w,P.j(S)),new ce(P,S)}for(P=g;0<=w.l(S);){for(p=Math.max(1,Math.floor(w.m()/S.m())),C=Math.ceil(Math.log(p)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),x=h(p),y=x.j(S);M(y)||0<y.l(w);)p-=C,x=h(p),y=x.j(S);L(x)&&(x=_),P=P.add(x),w=T(w,y)}return new ce(P,w)}t.A=function(w){return Z(this,w).h},t.and=function(w){for(var S=Math.max(this.g.length,w.g.length),p=[],C=0;C<S;C++)p[C]=this.i(C)&w.i(C);return new a(p,this.h&w.h)},t.or=function(w){for(var S=Math.max(this.g.length,w.g.length),p=[],C=0;C<S;C++)p[C]=this.i(C)|w.i(C);return new a(p,this.h|w.h)},t.xor=function(w){for(var S=Math.max(this.g.length,w.g.length),p=[],C=0;C<S;C++)p[C]=this.i(C)^w.i(C);return new a(p,this.h^w.h)};function ge(w){for(var S=w.g.length+1,p=[],C=0;C<S;C++)p[C]=w.i(C)<<1|w.i(C-1)>>>31;return new a(p,w.h)}function ne(w,S){var p=S>>5;S%=32;for(var C=w.g.length-p,P=[],x=0;x<C;x++)P[x]=0<S?w.i(x+p)>>>S|w.i(x+p+1)<<32-S:w.i(x+p);return new a(P,w.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,jf=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=m,Xn=a}).apply(typeof Fd<"u"?Fd:typeof self<"u"?self:typeof window<"u"?window:{});var Ls=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var zf,Mi,qf,na,oc,Gf,Hf,Yf;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,f,b){return l==Array.prototype||l==Object.prototype||(l[f]=b.value),l};function r(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ls=="object"&&Ls];for(var f=0;f<l.length;++f){var b=l[f];if(b&&b.Math==Math)return b}throw Error("Cannot find global object")}var n=r(this);function o(l,f){if(f)e:{var b=n;l=l.split(".");for(var G=0;G<l.length-1;G++){var we=l[G];if(!(we in b))break e;b=b[we]}l=l[l.length-1],G=b[l],f=f(G),f!=G&&f!=null&&e(b,l,{configurable:!0,writable:!0,value:f})}}function i(l,f){l instanceof String&&(l+="");var b=0,G=!1,we={next:function(){if(!G&&b<l.length){var Ae=b++;return{value:f(Ae,l[Ae]),done:!1}}return G=!0,{done:!0,value:void 0}}};return we[Symbol.iterator]=function(){return we},we}o("Array.prototype.values",function(l){return l||function(){return i(this,function(f,b){return b})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},c=this||self;function d(l){var f=typeof l;return f=f!="object"?f:l?Array.isArray(l)?"array":f:"null",f=="array"||f=="object"&&typeof l.length=="number"}function h(l){var f=typeof l;return f=="object"&&l!=null||f=="function"}function m(l,f,b){return l.call.apply(l.bind,arguments)}function g(l,f,b){if(!l)throw Error();if(2<arguments.length){var G=Array.prototype.slice.call(arguments,2);return function(){var we=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(we,G),l.apply(f,we)}}return function(){return l.apply(f,arguments)}}function _(l,f,b){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:g,_.apply(null,arguments)}function A(l,f){var b=Array.prototype.slice.call(arguments,1);return function(){var G=b.slice();return G.push.apply(G,arguments),l.apply(this,G)}}function L(l,f){function b(){}b.prototype=f.prototype,l.aa=f.prototype,l.prototype=new b,l.prototype.constructor=l,l.Qb=function(G,we,Ae){for(var Ue=Array(arguments.length-2),Yt=2;Yt<arguments.length;Yt++)Ue[Yt-2]=arguments[Yt];return f.prototype[we].apply(G,Ue)}}function M(l){const f=l.length;if(0<f){const b=Array(f);for(let G=0;G<f;G++)b[G]=l[G];return b}return[]}function $(l,f){for(let b=1;b<arguments.length;b++){const G=arguments[b];if(d(G)){const we=l.length||0,Ae=G.length||0;l.length=we+Ae;for(let Ue=0;Ue<Ae;Ue++)l[we+Ue]=G[Ue]}else l.push(G)}}class T{constructor(f,b){this.i=f,this.j=b,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function ee(l){return/^[\s\xa0]*$/.test(l)}function ce(){var l=c.navigator;return l&&(l=l.userAgent)?l:""}function Z(l){return Z[" "](l),l}Z[" "]=function(){};var ge=ce().indexOf("Gecko")!=-1&&!(ce().toLowerCase().indexOf("webkit")!=-1&&ce().indexOf("Edge")==-1)&&!(ce().indexOf("Trident")!=-1||ce().indexOf("MSIE")!=-1)&&ce().indexOf("Edge")==-1;function ne(l,f,b){for(const G in l)f.call(b,l[G],G,l)}function w(l,f){for(const b in l)f.call(void 0,l[b],b,l)}function S(l){const f={};for(const b in l)f[b]=l[b];return f}const p="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(l,f){let b,G;for(let we=1;we<arguments.length;we++){G=arguments[we];for(b in G)l[b]=G[b];for(let Ae=0;Ae<p.length;Ae++)b=p[Ae],Object.prototype.hasOwnProperty.call(G,b)&&(l[b]=G[b])}}function P(l){var f=1;l=l.split(":");const b=[];for(;0<f&&l.length;)b.push(l.shift()),f--;return l.length&&b.push(l.join(":")),b}function x(l){c.setTimeout(()=>{throw l},0)}function y(){var l=B;let f=null;return l.g&&(f=l.g,l.g=l.g.next,l.g||(l.h=null),f.next=null),f}class ue{constructor(){this.h=this.g=null}add(f,b){const G=J.get();G.set(f,b),this.h?this.h.next=G:this.g=G,this.h=G}}var J=new T(()=>new E,l=>l.reset());class E{constructor(){this.next=this.g=this.h=null}set(f,b){this.h=f,this.g=b,this.next=null}reset(){this.next=this.g=this.h=null}}let F,z=!1,B=new ue,k=()=>{const l=c.Promise.resolve(void 0);F=()=>{l.then(U)}};var U=()=>{for(var l;l=y();){try{l.h.call(l.g)}catch(b){x(b)}var f=J;f.j(l),100>f.h&&(f.h++,l.next=f.g,f.g=l)}z=!1};function he(){this.s=this.s,this.C=this.C}he.prototype.s=!1,he.prototype.ma=function(){this.s||(this.s=!0,this.N())},he.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function H(l,f){this.type=l,this.g=this.target=f,this.defaultPrevented=!1}H.prototype.h=function(){this.defaultPrevented=!0};var le=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var l=!1,f=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const b=()=>{};c.addEventListener("test",b,f),c.removeEventListener("test",b,f)}catch{}return l}();function I(l,f){if(H.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var b=this.type=l.type,G=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=f,f=l.relatedTarget){if(ge){e:{try{Z(f.nodeName);var we=!0;break e}catch{}we=!1}we||(f=null)}}else b=="mouseover"?f=l.fromElement:b=="mouseout"&&(f=l.toElement);this.relatedTarget=f,G?(this.clientX=G.clientX!==void 0?G.clientX:G.pageX,this.clientY=G.clientY!==void 0?G.clientY:G.pageY,this.screenX=G.screenX||0,this.screenY=G.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:j[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&I.aa.h.call(this)}}L(I,H);var j={2:"touch",3:"pen",4:"mouse"};I.prototype.h=function(){I.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var K="closure_listenable_"+(1e6*Math.random()|0),R=0;function X(l,f,b,G,we){this.listener=l,this.proxy=null,this.src=f,this.type=b,this.capture=!!G,this.ha=we,this.key=++R,this.da=this.fa=!1}function O(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function N(l){this.src=l,this.g={},this.h=0}N.prototype.add=function(l,f,b,G,we){var Ae=l.toString();l=this.g[Ae],l||(l=this.g[Ae]=[],this.h++);var Ue=de(l,f,G,we);return-1<Ue?(f=l[Ue],b||(f.fa=!1)):(f=new X(f,this.src,Ae,!!G,we),f.fa=b,l.push(f)),f};function te(l,f){var b=f.type;if(b in l.g){var G=l.g[b],we=Array.prototype.indexOf.call(G,f,void 0),Ae;(Ae=0<=we)&&Array.prototype.splice.call(G,we,1),Ae&&(O(f),l.g[b].length==0&&(delete l.g[b],l.h--))}}function de(l,f,b,G){for(var we=0;we<l.length;++we){var Ae=l[we];if(!Ae.da&&Ae.listener==f&&Ae.capture==!!b&&Ae.ha==G)return we}return-1}var pe="closure_lm_"+(1e6*Math.random()|0),se={};function Y(l,f,b,G,we){if(Array.isArray(f)){for(var Ae=0;Ae<f.length;Ae++)Y(l,f[Ae],b,G,we);return null}return b=Pe(b),l&&l[K]?l.K(f,b,h(G)?!!G.capture:!1,we):D(l,f,b,!1,G,we)}function D(l,f,b,G,we,Ae){if(!f)throw Error("Invalid event type");var Ue=h(we)?!!we.capture:!!we,Yt=re(l);if(Yt||(l[pe]=Yt=new N(l)),b=Yt.add(f,b,G,Ue,Ae),b.proxy)return b;if(G=Q(),b.proxy=G,G.src=l,G.listener=b,l.addEventListener)le||(we=Ue),we===void 0&&(we=!1),l.addEventListener(f.toString(),G,we);else if(l.attachEvent)l.attachEvent(fe(f.toString()),G);else if(l.addListener&&l.removeListener)l.addListener(G);else throw Error("addEventListener and attachEvent are unavailable.");return b}function Q(){function l(b){return f.call(l.src,l.listener,b)}const f=V;return l}function W(l,f,b,G,we){if(Array.isArray(f))for(var Ae=0;Ae<f.length;Ae++)W(l,f[Ae],b,G,we);else G=h(G)?!!G.capture:!!G,b=Pe(b),l&&l[K]?(l=l.i,f=String(f).toString(),f in l.g&&(Ae=l.g[f],b=de(Ae,b,G,we),-1<b&&(O(Ae[b]),Array.prototype.splice.call(Ae,b,1),Ae.length==0&&(delete l.g[f],l.h--)))):l&&(l=re(l))&&(f=l.g[f.toString()],l=-1,f&&(l=de(f,b,G,we)),(b=-1<l?f[l]:null)&&me(b))}function me(l){if(typeof l!="number"&&l&&!l.da){var f=l.src;if(f&&f[K])te(f.i,l);else{var b=l.type,G=l.proxy;f.removeEventListener?f.removeEventListener(b,G,l.capture):f.detachEvent?f.detachEvent(fe(b),G):f.addListener&&f.removeListener&&f.removeListener(G),(b=re(f))?(te(b,l),b.h==0&&(b.src=null,f[pe]=null)):O(l)}}}function fe(l){return l in se?se[l]:se[l]="on"+l}function V(l,f){if(l.da)l=!0;else{f=new I(f,this);var b=l.listener,G=l.ha||l.src;l.fa&&me(l),l=b.call(G,f)}return l}function re(l){return l=l[pe],l instanceof N?l:null}var _e="__closure_events_fn_"+(1e9*Math.random()>>>0);function Pe(l){return typeof l=="function"?l:(l[_e]||(l[_e]=function(f){return l.handleEvent(f)}),l[_e])}function ae(){he.call(this),this.i=new N(this),this.M=this,this.F=null}L(ae,he),ae.prototype[K]=!0,ae.prototype.removeEventListener=function(l,f,b,G){W(this,l,f,b,G)};function be(l,f){var b,G=l.F;if(G)for(b=[];G;G=G.F)b.push(G);if(l=l.M,G=f.type||f,typeof f=="string")f=new H(f,l);else if(f instanceof H)f.target=f.target||l;else{var we=f;f=new H(G,l),C(f,we)}if(we=!0,b)for(var Ae=b.length-1;0<=Ae;Ae--){var Ue=f.g=b[Ae];we=oe(Ue,G,!0,f)&&we}if(Ue=f.g=l,we=oe(Ue,G,!0,f)&&we,we=oe(Ue,G,!1,f)&&we,b)for(Ae=0;Ae<b.length;Ae++)Ue=f.g=b[Ae],we=oe(Ue,G,!1,f)&&we}ae.prototype.N=function(){if(ae.aa.N.call(this),this.i){var l=this.i,f;for(f in l.g){for(var b=l.g[f],G=0;G<b.length;G++)O(b[G]);delete l.g[f],l.h--}}this.F=null},ae.prototype.K=function(l,f,b,G){return this.i.add(String(l),f,!1,b,G)},ae.prototype.L=function(l,f,b,G){return this.i.add(String(l),f,!0,b,G)};function oe(l,f,b,G){if(f=l.i.g[String(f)],!f)return!0;f=f.concat();for(var we=!0,Ae=0;Ae<f.length;++Ae){var Ue=f[Ae];if(Ue&&!Ue.da&&Ue.capture==b){var Yt=Ue.listener,mr=Ue.ha||Ue.src;Ue.fa&&te(l.i,Ue),we=Yt.call(mr,G)!==!1&&we}}return we&&!G.defaultPrevented}function Se(l,f,b){if(typeof l=="function")b&&(l=_(l,b));else if(l&&typeof l.handleEvent=="function")l=_(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:c.setTimeout(l,f||0)}function Ee(l){l.g=Se(()=>{l.g=null,l.i&&(l.i=!1,Ee(l))},l.l);const f=l.h;l.h=null,l.m.apply(null,f)}class xe extends he{constructor(f,b){super(),this.m=f,this.l=b,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:Ee(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $e(l){he.call(this),this.h=l,this.g={}}L($e,he);var Me=[];function We(l){ne(l.g,function(f,b){this.g.hasOwnProperty(b)&&me(f)},l),l.g={}}$e.prototype.N=function(){$e.aa.N.call(this),We(this)},$e.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var je=c.JSON.stringify,Ce=c.JSON.parse,Ve=class{stringify(l){return c.JSON.stringify(l,void 0)}parse(l){return c.JSON.parse(l,void 0)}};function Ke(){}Ke.prototype.h=null;function He(l){return l.h||(l.h=l.i())}function Qe(){}var Ie={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ot(){H.call(this,"d")}L(ot,H);function et(){H.call(this,"c")}L(et,H);var Ct={},yt=null;function Dt(){return yt=yt||new ae}Ct.La="serverreachability";function Tt(l){H.call(this,Ct.La,l)}L(Tt,H);function $t(l){const f=Dt();be(f,new Tt(f))}Ct.STAT_EVENT="statevent";function qt(l,f){H.call(this,Ct.STAT_EVENT,l),this.stat=f}L(qt,H);function st(l){const f=Dt();be(f,new qt(f,l))}Ct.Ma="timingevent";function ke(l,f){H.call(this,Ct.Ma,l),this.size=f}L(ke,H);function at(l,f){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){l()},f)}function kt(){this.g=!0}kt.prototype.xa=function(){this.g=!1};function Fe(l,f,b,G,we,Ae){l.info(function(){if(l.g)if(Ae)for(var Ue="",Yt=Ae.split("&"),mr=0;mr<Yt.length;mr++){var Lt=Yt[mr].split("=");if(1<Lt.length){var Sr=Lt[0];Lt=Lt[1];var Pr=Sr.split("_");Ue=2<=Pr.length&&Pr[1]=="type"?Ue+(Sr+"="+Lt+"&"):Ue+(Sr+"=redacted&")}}else Ue=null;else Ue=Ae;return"XMLHTTP REQ ("+G+") [attempt "+we+"]: "+f+`
`+b+`
`+Ue})}function Be(l,f,b,G,we,Ae,Ue){l.info(function(){return"XMLHTTP RESP ("+G+") [ attempt "+we+"]: "+f+`
`+b+`
`+Ae+" "+Ue})}function Je(l,f,b,G){l.info(function(){return"XMLHTTP TEXT ("+f+"): "+vt(l,b)+(G?" "+G:"")})}function rt(l,f){l.info(function(){return"TIMEOUT: "+f})}kt.prototype.info=function(){};function vt(l,f){if(!l.g)return f;if(!f)return null;try{var b=JSON.parse(f);if(b){for(l=0;l<b.length;l++)if(Array.isArray(b[l])){var G=b[l];if(!(2>G.length)){var we=G[1];if(Array.isArray(we)&&!(1>we.length)){var Ae=we[0];if(Ae!="noop"&&Ae!="stop"&&Ae!="close")for(var Ue=1;Ue<we.length;Ue++)we[Ue]=""}}}}return je(b)}catch{return f}}var Xe={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},bt={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ft;function Oe(){}L(Oe,Ke),Oe.prototype.g=function(){return new XMLHttpRequest},Oe.prototype.i=function(){return{}},ft=new Oe;function dt(l,f,b,G){this.j=l,this.i=f,this.l=b,this.R=G||1,this.U=new $e(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Bt}function Bt(){this.i=null,this.g="",this.h=!1}var gt={},Nt={};function Ft(l,f,b){l.L=1,l.v=Vo($r(f)),l.m=b,l.P=!0,_t(l,null)}function _t(l,f){l.F=Date.now(),Ut(l),l.A=$r(l.v);var b=l.A,G=l.R;Array.isArray(G)||(G=[String(G)]),Lu(b.i,"t",G),l.C=0,b=l.j.J,l.h=new Bt,l.g=Zu(l.j,b?f:null,!l.m),0<l.O&&(l.M=new xe(_(l.Y,l,l.g),l.O)),f=l.U,b=l.g,G=l.ca;var we="readystatechange";Array.isArray(we)||(we&&(Me[0]=we.toString()),we=Me);for(var Ae=0;Ae<we.length;Ae++){var Ue=Y(b,we[Ae],G||f.handleEvent,!1,f.h||f);if(!Ue)break;f.g[Ue.key]=Ue}f=l.H?S(l.H):{},l.m?(l.u||(l.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,f)):(l.u="GET",l.g.ea(l.A,l.u,null,f)),$t(),Fe(l.i,l.u,l.A,l.l,l.R,l.m)}dt.prototype.ca=function(l){l=l.target;const f=this.M;f&&bn(l)==3?f.j():this.Y(l)},dt.prototype.Y=function(l){try{if(l==this.g)e:{const Pr=bn(this.g);var f=this.g.Ba();const Uo=this.g.Z();if(!(3>Pr)&&(Pr!=3||this.g&&(this.h.h||this.g.oa()||ju(this.g)))){this.J||Pr!=4||f==7||(f==8||0>=Uo?$t(3):$t(2)),dr(this);var b=this.g.Z();this.X=b;t:if(nt(this)){var G=ju(this.g);l="";var we=G.length,Ae=bn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Rr(this),Tr(this);var Ue="";break t}this.h.i=new c.TextDecoder}for(f=0;f<we;f++)this.h.h=!0,l+=this.h.i.decode(G[f],{stream:!(Ae&&f==we-1)});G.length=0,this.h.g+=l,this.C=0,Ue=this.h.g}else Ue=this.g.oa();if(this.o=b==200,Be(this.i,this.u,this.A,this.l,this.R,Pr,b),this.o){if(this.T&&!this.K){t:{if(this.g){var Yt,mr=this.g;if((Yt=mr.g?mr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ee(Yt)){var Lt=Yt;break t}}Lt=null}if(b=Lt)Je(this.i,this.l,b,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,pn(this,b);else{this.o=!1,this.s=3,st(12),Rr(this),Tr(this);break e}}if(this.P){b=!0;let Wr;for(;!this.J&&this.C<Ue.length;)if(Wr=tr(this,Ue),Wr==Nt){Pr==4&&(this.s=4,st(14),b=!1),Je(this.i,this.l,null,"[Incomplete Response]");break}else if(Wr==gt){this.s=4,st(15),Je(this.i,this.l,Ue,"[Invalid Chunk]"),b=!1;break}else Je(this.i,this.l,Wr,null),pn(this,Wr);if(nt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Pr!=4||Ue.length!=0||this.h.h||(this.s=1,st(16),b=!1),this.o=this.o&&b,!b)Je(this.i,this.l,Ue,"[Invalid Chunked Response]"),Rr(this),Tr(this);else if(0<Ue.length&&!this.W){this.W=!0;var Sr=this.j;Sr.g==this&&Sr.ba&&!Sr.M&&(Sr.j.info("Great, no buffering proxy detected. Bytes received: "+Ue.length),sl(Sr),Sr.M=!0,st(11))}}else Je(this.i,this.l,Ue,null),pn(this,Ue);Pr==4&&Rr(this),this.o&&!this.J&&(Pr==4?Ku(this.j,this):(this.o=!1,Ut(this)))}else Ug(this.g),b==400&&0<Ue.indexOf("Unknown SID")?(this.s=3,st(12)):(this.s=0,st(13)),Rr(this),Tr(this)}}}catch{}finally{}};function nt(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function tr(l,f){var b=l.C,G=f.indexOf(`
`,b);return G==-1?Nt:(b=Number(f.substring(b,G)),isNaN(b)?gt:(G+=1,G+b>f.length?Nt:(f=f.slice(G,G+b),l.C=G+b,f)))}dt.prototype.cancel=function(){this.J=!0,Rr(this)};function Ut(l){l.S=Date.now()+l.I,Xt(l,l.I)}function Xt(l,f){if(l.B!=null)throw Error("WatchDog timer not null");l.B=at(_(l.ba,l),f)}function dr(l){l.B&&(c.clearTimeout(l.B),l.B=null)}dt.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(rt(this.i,this.A),this.L!=2&&($t(),st(17)),Rr(this),this.s=2,Tr(this)):Xt(this,this.S-l)};function Tr(l){l.j.G==0||l.J||Ku(l.j,l)}function Rr(l){dr(l);var f=l.M;f&&typeof f.ma=="function"&&f.ma(),l.M=null,We(l.U),l.g&&(f=l.g,l.g=null,f.abort(),f.ma())}function pn(l,f){try{var b=l.j;if(b.G!=0&&(b.g==l||Oo(b.h,l))){if(!l.K&&Oo(b.h,l)&&b.G==3){try{var G=b.Da.g.parse(f)}catch{G=null}if(Array.isArray(G)&&G.length==3){var we=G;if(we[0]==0){e:if(!b.u){if(b.g)if(b.g.F+3e3<l.F)$s(b),Es(b);else break e;il(b),st(18)}}else b.za=we[1],0<b.za-b.T&&37500>we[2]&&b.F&&b.v==0&&!b.C&&(b.C=at(_(b.Za,b),6e3));if(1>=Si(b.h)&&b.ca){try{b.ca()}catch{}b.ca=void 0}}else ho(b,11)}else if((l.K||b.g==l)&&$s(b),!ee(f))for(we=b.Da.g.parse(f),f=0;f<we.length;f++){let Lt=we[f];if(b.T=Lt[0],Lt=Lt[1],b.G==2)if(Lt[0]=="c"){b.K=Lt[1],b.ia=Lt[2];const Sr=Lt[3];Sr!=null&&(b.la=Sr,b.j.info("VER="+b.la));const Pr=Lt[4];Pr!=null&&(b.Aa=Pr,b.j.info("SVER="+b.Aa));const Uo=Lt[5];Uo!=null&&typeof Uo=="number"&&0<Uo&&(G=1.5*Uo,b.L=G,b.j.info("backChannelRequestTimeoutMs_="+G)),G=b;const Wr=l.g;if(Wr){const Rs=Wr.g?Wr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Rs){var Ae=G.h;Ae.g||Rs.indexOf("spdy")==-1&&Rs.indexOf("quic")==-1&&Rs.indexOf("h2")==-1||(Ae.j=Ae.l,Ae.g=new Set,Ae.h&&(On(Ae,Ae.h),Ae.h=null))}if(G.D){const al=Wr.g?Wr.g.getResponseHeader("X-HTTP-Session-Id"):null;al&&(G.ya=al,Ht(G.I,G.D,al))}}b.G=3,b.l&&b.l.ua(),b.ba&&(b.R=Date.now()-l.F,b.j.info("Handshake RTT: "+b.R+"ms")),G=b;var Ue=l;if(G.qa=Xu(G,G.J?G.ia:null,G.W),Ue.K){ws(G.h,Ue);var Yt=Ue,mr=G.L;mr&&(Yt.I=mr),Yt.B&&(dr(Yt),Ut(Yt)),G.g=Ue}else Yu(G);0<b.i.length&&Ts(b)}else Lt[0]!="stop"&&Lt[0]!="close"||ho(b,7);else b.G==3&&(Lt[0]=="stop"||Lt[0]=="close"?Lt[0]=="stop"?ho(b,7):ol(b):Lt[0]!="noop"&&b.l&&b.l.ta(Lt),b.v=0)}}$t(4)}catch{}}var Mn=class{constructor(l,f){this.g=l,this.map=f}};function Mo(l){this.l=l||10,c.PerformanceNavigationTiming?(l=c.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function uo(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Si(l){return l.h?1:l.g?l.g.size:0}function Oo(l,f){return l.h?l.h==f:l.g?l.g.has(f):!1}function On(l,f){l.g?l.g.add(f):l.h=f}function ws(l,f){l.h&&l.h==f?l.h=null:l.g&&l.g.has(f)&&l.g.delete(f)}Mo.prototype.cancel=function(){if(this.i=Pi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Pi(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let f=l.i;for(const b of l.g.values())f=f.concat(b.D);return f}return M(l.i)}function St(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(d(l)){for(var f=[],b=l.length,G=0;G<b;G++)f.push(l[G]);return f}f=[],b=0;for(G in l)f[b++]=l[G];return f}function Gt(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(d(l)||typeof l=="string"){var f=[];l=l.length;for(var b=0;b<l;b++)f.push(b);return f}f=[],b=0;for(const G in l)f[b++]=G;return f}}}function _r(l,f){if(l.forEach&&typeof l.forEach=="function")l.forEach(f,void 0);else if(d(l)||typeof l=="string")Array.prototype.forEach.call(l,f,void 0);else for(var b=Gt(l),G=St(l),we=G.length,Ae=0;Ae<we;Ae++)f.call(void 0,G[Ae],b&&b[Ae],l)}var Yr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function vn(l,f){if(l){l=l.split("&");for(var b=0;b<l.length;b++){var G=l[b].indexOf("="),we=null;if(0<=G){var Ae=l[b].substring(0,G);we=l[b].substring(G+1)}else Ae=l[b];f(Ae,we?decodeURIComponent(we.replace(/\+/g," ")):"")}}}function Qt(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Qt){this.h=l.h,en(this,l.j),this.o=l.o,this.g=l.g,tn(this,l.s),this.l=l.l;var f=l.i,b=new Ai;b.i=f.i,f.g&&(b.g=new Map(f.g),b.h=f.h),Cs(this,b),this.m=l.m}else l&&(f=String(l).match(Yr))?(this.h=!1,en(this,f[1]||"",!0),this.o=wi(f[2]||""),this.g=wi(f[3]||"",!0),tn(this,f[4]),this.l=wi(f[5]||"",!0),Cs(this,f[6]||"",!0),this.m=wi(f[7]||"")):(this.h=!1,this.i=new Ai(null,this.h))}Qt.prototype.toString=function(){var l=[],f=this.j;f&&l.push(Ci(f,Ru,!0),":");var b=this.g;return(b||f=="file")&&(l.push("//"),(f=this.o)&&l.push(Ci(f,Ru,!0),"@"),l.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b=this.s,b!=null&&l.push(":",String(b))),(b=this.l)&&(this.g&&b.charAt(0)!="/"&&l.push("/"),l.push(Ci(b,b.charAt(0)=="/"?kg:$g,!0))),(b=this.i.toString())&&l.push("?",b),(b=this.m)&&l.push("#",Ci(b,Dg)),l.join("")};function $r(l){return new Qt(l)}function en(l,f,b){l.j=b?wi(f,!0):f,l.j&&(l.j=l.j.replace(/:$/,""))}function tn(l,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);l.s=f}else l.s=null}function Cs(l,f,b){f instanceof Ai?(l.i=f,Ng(l.i,l.h)):(b||(f=Ci(f,Rg)),l.i=new Ai(f,l.h))}function Ht(l,f,b){l.i.set(f,b)}function Vo(l){return Ht(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function wi(l,f){return l?f?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Ci(l,f,b){return typeof l=="string"?(l=encodeURI(l).replace(f,Tg),b&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function Tg(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Ru=/[#\/\?@]/g,$g=/[#\?:]/g,kg=/[#\?]/g,Rg=/[#\?@]/g,Dg=/#/g;function Ai(l,f){this.h=this.g=null,this.i=l||null,this.j=!!f}function Vn(l){l.g||(l.g=new Map,l.h=0,l.i&&vn(l.i,function(f,b){l.add(decodeURIComponent(f.replace(/\+/g," ")),b)}))}t=Ai.prototype,t.add=function(l,f){Vn(this),this.i=null,l=Bo(this,l);var b=this.g.get(l);return b||this.g.set(l,b=[]),b.push(f),this.h+=1,this};function Du(l,f){Vn(l),f=Bo(l,f),l.g.has(f)&&(l.i=null,l.h-=l.g.get(f).length,l.g.delete(f))}function Nu(l,f){return Vn(l),f=Bo(l,f),l.g.has(f)}t.forEach=function(l,f){Vn(this),this.g.forEach(function(b,G){b.forEach(function(we){l.call(f,we,G,this)},this)},this)},t.na=function(){Vn(this);const l=Array.from(this.g.values()),f=Array.from(this.g.keys()),b=[];for(let G=0;G<f.length;G++){const we=l[G];for(let Ae=0;Ae<we.length;Ae++)b.push(f[G])}return b},t.V=function(l){Vn(this);let f=[];if(typeof l=="string")Nu(this,l)&&(f=f.concat(this.g.get(Bo(this,l))));else{l=Array.from(this.g.values());for(let b=0;b<l.length;b++)f=f.concat(l[b])}return f},t.set=function(l,f){return Vn(this),this.i=null,l=Bo(this,l),Nu(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[f]),this.h+=1,this},t.get=function(l,f){return l?(l=this.V(l),0<l.length?String(l[0]):f):f};function Lu(l,f,b){Du(l,f),0<b.length&&(l.i=null,l.g.set(Bo(l,f),M(b)),l.h+=b.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],f=Array.from(this.g.keys());for(var b=0;b<f.length;b++){var G=f[b];const Ae=encodeURIComponent(String(G)),Ue=this.V(G);for(G=0;G<Ue.length;G++){var we=Ae;Ue[G]!==""&&(we+="="+encodeURIComponent(String(Ue[G]))),l.push(we)}}return this.i=l.join("&")};function Bo(l,f){return f=String(f),l.j&&(f=f.toLowerCase()),f}function Ng(l,f){f&&!l.j&&(Vn(l),l.i=null,l.g.forEach(function(b,G){var we=G.toLowerCase();G!=we&&(Du(this,G),Lu(this,we,b))},l)),l.j=f}function Lg(l,f){const b=new kt;if(c.Image){const G=new Image;G.onload=A(Bn,b,"TestLoadImage: loaded",!0,f,G),G.onerror=A(Bn,b,"TestLoadImage: error",!1,f,G),G.onabort=A(Bn,b,"TestLoadImage: abort",!1,f,G),G.ontimeout=A(Bn,b,"TestLoadImage: timeout",!1,f,G),c.setTimeout(function(){G.ontimeout&&G.ontimeout()},1e4),G.src=l}else f(!1)}function Mg(l,f){const b=new kt,G=new AbortController,we=setTimeout(()=>{G.abort(),Bn(b,"TestPingServer: timeout",!1,f)},1e4);fetch(l,{signal:G.signal}).then(Ae=>{clearTimeout(we),Ae.ok?Bn(b,"TestPingServer: ok",!0,f):Bn(b,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(we),Bn(b,"TestPingServer: error",!1,f)})}function Bn(l,f,b,G,we){try{we&&(we.onload=null,we.onerror=null,we.onabort=null,we.ontimeout=null),G(b)}catch{}}function Og(){this.g=new Ve}function Vg(l,f,b){const G=b||"";try{_r(l,function(we,Ae){let Ue=we;h(we)&&(Ue=je(we)),f.push(G+Ae+"="+encodeURIComponent(Ue))})}catch(we){throw f.push(G+"type="+encodeURIComponent("_badmap")),we}}function As(l){this.l=l.Ub||null,this.j=l.eb||!1}L(As,Ke),As.prototype.g=function(){return new Is(this.l,this.j)},As.prototype.i=function(l){return function(){return l}}({});function Is(l,f){ae.call(this),this.D=l,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}L(Is,ae),t=Is.prototype,t.open=function(l,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=f,this.readyState=1,xi(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(f.body=l),(this.D||c).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ii(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,xi(this)),this.g&&(this.readyState=3,xi(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Mu(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function Mu(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var f=l.value?l.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!l.done}))&&(this.response=this.responseText+=f)}l.done?Ii(this):xi(this),this.readyState==3&&Mu(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,Ii(this))},t.Qa=function(l){this.g&&(this.response=l,Ii(this))},t.ga=function(){this.g&&Ii(this)};function Ii(l){l.readyState=4,l.l=null,l.j=null,l.v=null,xi(l)}t.setRequestHeader=function(l,f){this.u.append(l,f)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],f=this.h.entries();for(var b=f.next();!b.done;)b=b.value,l.push(b[0]+": "+b[1]),b=f.next();return l.join(`\r
`)};function xi(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Is.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Ou(l){let f="";return ne(l,function(b,G){f+=G,f+=":",f+=b,f+=`\r
`}),f}function nl(l,f,b){e:{for(G in b){var G=!1;break e}G=!0}G||(b=Ou(b),typeof l=="string"?b!=null&&encodeURIComponent(String(b)):Ht(l,f,b))}function er(l){ae.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}L(er,ae);var Bg=/^https?$/i,Fg=["POST","PUT"];t=er.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,f,b,G){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);f=f?f.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ft.g(),this.v=this.o?He(this.o):He(ft),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(f,String(l),!0),this.B=!1}catch(Ae){Vu(this,Ae);return}if(l=b||"",b=new Map(this.headers),G)if(Object.getPrototypeOf(G)===Object.prototype)for(var we in G)b.set(we,G[we]);else if(typeof G.keys=="function"&&typeof G.get=="function")for(const Ae of G.keys())b.set(Ae,G.get(Ae));else throw Error("Unknown input type for opt_headers: "+String(G));G=Array.from(b.keys()).find(Ae=>Ae.toLowerCase()=="content-type"),we=c.FormData&&l instanceof c.FormData,!(0<=Array.prototype.indexOf.call(Fg,f,void 0))||G||we||b.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ae,Ue]of b)this.g.setRequestHeader(Ae,Ue);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Uu(this),this.u=!0,this.g.send(l),this.u=!1}catch(Ae){Vu(this,Ae)}};function Vu(l,f){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=f,l.m=5,Bu(l),xs(l)}function Bu(l){l.A||(l.A=!0,be(l,"complete"),be(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,be(this,"complete"),be(this,"abort"),xs(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xs(this,!0)),er.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Fu(this):this.bb())},t.bb=function(){Fu(this)};function Fu(l){if(l.h&&typeof a<"u"&&(!l.v[1]||bn(l)!=4||l.Z()!=2)){if(l.u&&bn(l)==4)Se(l.Ea,0,l);else if(be(l,"readystatechange"),bn(l)==4){l.h=!1;try{const Ue=l.Z();e:switch(Ue){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var b;if(!(b=f)){var G;if(G=Ue===0){var we=String(l.D).match(Yr)[1]||null;!we&&c.self&&c.self.location&&(we=c.self.location.protocol.slice(0,-1)),G=!Bg.test(we?we.toLowerCase():"")}b=G}if(b)be(l,"complete"),be(l,"success");else{l.m=6;try{var Ae=2<bn(l)?l.g.statusText:""}catch{Ae=""}l.l=Ae+" ["+l.Z()+"]",Bu(l)}}finally{xs(l)}}}}function xs(l,f){if(l.g){Uu(l);const b=l.g,G=l.v[0]?()=>{}:null;l.g=null,l.v=null,f||be(l,"ready");try{b.onreadystatechange=G}catch{}}}function Uu(l){l.I&&(c.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function bn(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<bn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var f=this.g.responseText;return l&&f.indexOf(l)==0&&(f=f.substring(l.length)),Ce(f)}};function ju(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function Ug(l){const f={};l=(l.g&&2<=bn(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let G=0;G<l.length;G++){if(ee(l[G]))continue;var b=P(l[G]);const we=b[0];if(b=b[1],typeof b!="string")continue;b=b.trim();const Ae=f[we]||[];f[we]=Ae,Ae.push(b)}w(f,function(G){return G.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ei(l,f,b){return b&&b.internalChannelParams&&b.internalChannelParams[l]||f}function zu(l){this.Aa=0,this.i=[],this.j=new kt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ei("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ei("baseRetryDelayMs",5e3,l),this.cb=Ei("retryDelaySeedMs",1e4,l),this.Wa=Ei("forwardChannelMaxRetries",2,l),this.wa=Ei("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new Mo(l&&l.concurrentRequestLimit),this.Da=new Og,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=zu.prototype,t.la=8,t.G=1,t.connect=function(l,f,b,G){st(0),this.W=l,this.H=f||{},b&&G!==void 0&&(this.H.OSID=b,this.H.OAID=G),this.F=this.X,this.I=Xu(this,null,this.W),Ts(this)};function ol(l){if(qu(l),l.G==3){var f=l.U++,b=$r(l.I);if(Ht(b,"SID",l.K),Ht(b,"RID",f),Ht(b,"TYPE","terminate"),Ti(l,b),f=new dt(l,l.j,f),f.L=2,f.v=Vo($r(b)),b=!1,c.navigator&&c.navigator.sendBeacon)try{b=c.navigator.sendBeacon(f.v.toString(),"")}catch{}!b&&c.Image&&(new Image().src=f.v,b=!0),b||(f.g=Zu(f.j,null),f.g.ea(f.v)),f.F=Date.now(),Ut(f)}Ju(l)}function Es(l){l.g&&(sl(l),l.g.cancel(),l.g=null)}function qu(l){Es(l),l.u&&(c.clearTimeout(l.u),l.u=null),$s(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&c.clearTimeout(l.s),l.s=null)}function Ts(l){if(!uo(l.h)&&!l.s){l.s=!0;var f=l.Ga;F||k(),z||(F(),z=!0),B.add(f,l),l.B=0}}function jg(l,f){return Si(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=f.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=at(_(l.Ga,l,f),Qu(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const we=new dt(this,this.j,l);let Ae=this.o;if(this.S&&(Ae?(Ae=S(Ae),C(Ae,this.S)):Ae=this.S),this.m!==null||this.O||(we.H=Ae,Ae=null),this.P)e:{for(var f=0,b=0;b<this.i.length;b++){t:{var G=this.i[b];if("__data__"in G.map&&(G=G.map.__data__,typeof G=="string")){G=G.length;break t}G=void 0}if(G===void 0)break;if(f+=G,4096<f){f=b;break e}if(f===4096||b===this.i.length-1){f=b+1;break e}}f=1e3}else f=1e3;f=Hu(this,we,f),b=$r(this.I),Ht(b,"RID",l),Ht(b,"CVER",22),this.D&&Ht(b,"X-HTTP-Session-Id",this.D),Ti(this,b),Ae&&(this.O?f="headers="+encodeURIComponent(String(Ou(Ae)))+"&"+f:this.m&&nl(b,this.m,Ae)),On(this.h,we),this.Ua&&Ht(b,"TYPE","init"),this.P?(Ht(b,"$req",f),Ht(b,"SID","null"),we.T=!0,Ft(we,b,null)):Ft(we,b,f),this.G=2}}else this.G==3&&(l?Gu(this,l):this.i.length==0||uo(this.h)||Gu(this))};function Gu(l,f){var b;f?b=f.l:b=l.U++;const G=$r(l.I);Ht(G,"SID",l.K),Ht(G,"RID",b),Ht(G,"AID",l.T),Ti(l,G),l.m&&l.o&&nl(G,l.m,l.o),b=new dt(l,l.j,b,l.B+1),l.m===null&&(b.H=l.o),f&&(l.i=f.D.concat(l.i)),f=Hu(l,b,1e3),b.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),On(l.h,b),Ft(b,G,f)}function Ti(l,f){l.H&&ne(l.H,function(b,G){Ht(f,G,b)}),l.l&&_r({},function(b,G){Ht(f,G,b)})}function Hu(l,f,b){b=Math.min(l.i.length,b);var G=l.l?_(l.l.Na,l.l,l):null;e:{var we=l.i;let Ae=-1;for(;;){const Ue=["count="+b];Ae==-1?0<b?(Ae=we[0].g,Ue.push("ofs="+Ae)):Ae=0:Ue.push("ofs="+Ae);let Yt=!0;for(let mr=0;mr<b;mr++){let Lt=we[mr].g;const Sr=we[mr].map;if(Lt-=Ae,0>Lt)Ae=Math.max(0,we[mr].g-100),Yt=!1;else try{Vg(Sr,Ue,"req"+Lt+"_")}catch{G&&G(Sr)}}if(Yt){G=Ue.join("&");break e}}}return l=l.i.splice(0,b),f.D=l,G}function Yu(l){if(!l.g&&!l.u){l.Y=1;var f=l.Fa;F||k(),z||(F(),z=!0),B.add(f,l),l.v=0}}function il(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=at(_(l.Fa,l),Qu(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,Wu(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=at(_(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,st(10),Es(this),Wu(this))};function sl(l){l.A!=null&&(c.clearTimeout(l.A),l.A=null)}function Wu(l){l.g=new dt(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var f=$r(l.qa);Ht(f,"RID","rpc"),Ht(f,"SID",l.K),Ht(f,"AID",l.T),Ht(f,"CI",l.F?"0":"1"),!l.F&&l.ja&&Ht(f,"TO",l.ja),Ht(f,"TYPE","xmlhttp"),Ti(l,f),l.m&&l.o&&nl(f,l.m,l.o),l.L&&(l.g.I=l.L);var b=l.g;l=l.ia,b.L=1,b.v=Vo($r(f)),b.m=null,b.P=!0,_t(b,l)}t.Za=function(){this.C!=null&&(this.C=null,Es(this),il(this),st(19))};function $s(l){l.C!=null&&(c.clearTimeout(l.C),l.C=null)}function Ku(l,f){var b=null;if(l.g==f){$s(l),sl(l),l.g=null;var G=2}else if(Oo(l.h,f))b=f.D,ws(l.h,f),G=1;else return;if(l.G!=0){if(f.o)if(G==1){b=f.m?f.m.length:0,f=Date.now()-f.F;var we=l.B;G=Dt(),be(G,new ke(G,b)),Ts(l)}else Yu(l);else if(we=f.s,we==3||we==0&&0<f.X||!(G==1&&jg(l,f)||G==2&&il(l)))switch(b&&0<b.length&&(f=l.h,f.i=f.i.concat(b)),we){case 1:ho(l,5);break;case 4:ho(l,10);break;case 3:ho(l,6);break;default:ho(l,2)}}}function Qu(l,f){let b=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(b*=2),b*f}function ho(l,f){if(l.j.info("Error code "+f),f==2){var b=_(l.fb,l),G=l.Xa;const we=!G;G=new Qt(G||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||en(G,"https"),Vo(G),we?Lg(G.toString(),b):Mg(G.toString(),b)}else st(2);l.G=0,l.l&&l.l.sa(f),Ju(l),qu(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),st(2)):(this.j.info("Failed to ping google.com"),st(1))};function Ju(l){if(l.G=0,l.ka=[],l.l){const f=Pi(l.h);(f.length!=0||l.i.length!=0)&&($(l.ka,f),$(l.ka,l.i),l.h.i.length=0,M(l.i),l.i.length=0),l.l.ra()}}function Xu(l,f,b){var G=b instanceof Qt?$r(b):new Qt(b);if(G.g!="")f&&(G.g=f+"."+G.g),tn(G,G.s);else{var we=c.location;G=we.protocol,f=f?f+"."+we.hostname:we.hostname,we=+we.port;var Ae=new Qt(null);G&&en(Ae,G),f&&(Ae.g=f),we&&tn(Ae,we),b&&(Ae.l=b),G=Ae}return b=l.D,f=l.ya,b&&f&&Ht(G,b,f),Ht(G,"VER",l.la),Ti(l,G),G}function Zu(l,f,b){if(f&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=l.Ca&&!l.pa?new er(new As({eb:b})):new er(l.pa),f.Ha(l.J),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function ed(){}t=ed.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ks(){}ks.prototype.g=function(l,f){return new Mr(l,f)};function Mr(l,f){ae.call(this),this.g=new zu(f),this.l=l,this.h=f&&f.messageUrlParams||null,l=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(l?l["X-WebChannel-Content-Type"]=f.messageContentType:l={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(l?l["X-WebChannel-Client-Profile"]=f.va:l={"X-WebChannel-Client-Profile":f.va}),this.g.S=l,(l=f&&f.Sb)&&!ee(l)&&(this.g.m=l),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!ee(f)&&(this.g.D=f,l=this.h,l!==null&&f in l&&(l=this.h,f in l&&delete l[f])),this.j=new Fo(this)}L(Mr,ae),Mr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Mr.prototype.close=function(){ol(this.g)},Mr.prototype.o=function(l){var f=this.g;if(typeof l=="string"){var b={};b.__data__=l,l=b}else this.u&&(b={},b.__data__=je(l),l=b);f.i.push(new Mn(f.Ya++,l)),f.G==3&&Ts(f)},Mr.prototype.N=function(){this.g.l=null,delete this.j,ol(this.g),delete this.g,Mr.aa.N.call(this)};function td(l){ot.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var f=l.__sm__;if(f){e:{for(const b in f){l=b;break e}l=void 0}(this.i=l)&&(l=this.i,f=f!==null&&l in f?f[l]:void 0),this.data=f}else this.data=l}L(td,ot);function rd(){et.call(this),this.status=1}L(rd,et);function Fo(l){this.g=l}L(Fo,ed),Fo.prototype.ua=function(){be(this.g,"a")},Fo.prototype.ta=function(l){be(this.g,new td(l))},Fo.prototype.sa=function(l){be(this.g,new rd)},Fo.prototype.ra=function(){be(this.g,"b")},ks.prototype.createWebChannel=ks.prototype.g,Mr.prototype.send=Mr.prototype.o,Mr.prototype.open=Mr.prototype.m,Mr.prototype.close=Mr.prototype.close,Yf=function(){return new ks},Hf=function(){return Dt()},Gf=Ct,oc={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Xe.NO_ERROR=0,Xe.TIMEOUT=8,Xe.HTTP_ERROR=6,na=Xe,bt.COMPLETE="complete",qf=bt,Qe.EventType=Ie,Ie.OPEN="a",Ie.CLOSE="b",Ie.ERROR="c",Ie.MESSAGE="d",ae.prototype.listen=ae.prototype.K,Mi=Qe,er.prototype.listenOnce=er.prototype.L,er.prototype.getLastError=er.prototype.Ka,er.prototype.getLastErrorCode=er.prototype.Ba,er.prototype.getStatus=er.prototype.Z,er.prototype.getResponseJson=er.prototype.Oa,er.prototype.getResponseText=er.prototype.oa,er.prototype.send=er.prototype.ea,er.prototype.setWithCredentials=er.prototype.Ha,zf=er}).apply(typeof Ls<"u"?Ls:typeof self<"u"?self:typeof window<"u"?window:{});const Ud="@firebase/firestore",jd="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ar.UNAUTHENTICATED=new Ar(null),Ar.GOOGLE_CREDENTIALS=new Ar("google-credentials-uid"),Ar.FIRST_PARTY=new Ar("first-party-uid"),Ar.MOCK_USER=new Ar("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gi="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const To=new Dc("@firebase/firestore");function Wo(){return To.logLevel}function Ye(t,...e){if(To.logLevel<=At.DEBUG){const r=e.map(Hc);To.debug(`Firestore (${gi}): ${t}`,...r)}}function kn(t,...e){if(To.logLevel<=At.ERROR){const r=e.map(Hc);To.error(`Firestore (${gi}): ${t}`,...r)}}function si(t,...e){if(To.logLevel<=At.WARN){const r=e.map(Hc);To.warn(`Firestore (${gi}): ${t}`,...r)}}function Hc(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function it(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,Wf(t,n,r)}function Wf(t,e,r){let n=`FIRESTORE (${gi}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw kn(n),new Error(n)}function jt(t,e,r,n){let o="Unexpected state";typeof r=="string"?o=r:n=r,t||Wf(e,o,n)}function mt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Te={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class qe extends Ln{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kf{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Y_{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Ar.UNAUTHENTICATED))}shutdown(){}}class W_{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class K_{constructor(e){this.t=e,this.currentUser=Ar.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){jt(this.o===void 0,42304);let n=this.i;const o=d=>this.i!==n?(n=this.i,r(d)):Promise.resolve();let i=new En;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new En,e.enqueueRetryable(()=>o(this.currentUser))};const a=()=>{const d=i;e.enqueueRetryable(async()=>{await d.promise,await o(this.currentUser)})},c=d=>{Ye("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(d=>c(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?c(d):(Ye("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new En)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Ye("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(jt(typeof n.accessToken=="string",31837,{l:n}),new Kf(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return jt(e===null||typeof e=="string",2055,{h:e}),new Ar(e)}}class Q_{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Ar.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class J_{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new Q_(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(Ar.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class zd{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class X_{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,zr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){jt(this.o===void 0,3512);const n=i=>{i.error!=null&&Ye("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,Ye("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const o=i=>{Ye("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>o(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?o(i):Ye("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new zd(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(jt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new zd(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z_(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const o=Z_(40);for(let i=0;i<o.length;++i)n.length<20&&o[i]<r&&(n+=e.charAt(o[i]%62))}return n}}function It(t,e){return t<e?-1:t>e?1:0}function ic(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const o=t.charAt(n),i=e.charAt(n);if(o!==i)return _l(o)===_l(i)?It(o,i):_l(o)?1:-1}return It(t.length,e.length)}const eS=55296,tS=57343;function _l(t){const e=t.charCodeAt(0);return e>=eS&&e<=tS}function ai(t,e,r){return t.length===e.length&&t.every((n,o)=>r(n,e[o]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qd="__name__";class sn{constructor(e,r,n){r===void 0?r=0:r>e.length&&it(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&it(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return sn.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof sn?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let o=0;o<n;o++){const i=sn.compareSegments(e.get(o),r.get(o));if(i!==0)return i}return It(e.length,r.length)}static compareSegments(e,r){const n=sn.isNumericId(e),o=sn.isNumericId(r);return n&&!o?-1:!n&&o?1:n&&o?sn.extractNumericId(e).compare(sn.extractNumericId(r)):ic(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Xn.fromString(e.substring(4,e.length-2))}}class Kt extends sn{construct(e,r,n){return new Kt(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new qe(Te.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(o=>o.length>0))}return new Kt(r)}static emptyPath(){return new Kt([])}}const rS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class yr extends sn{construct(e,r,n){return new yr(e,r,n)}static isValidIdentifier(e){return rS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),yr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===qd}static keyField(){return new yr([qd])}static fromServerFormat(e){const r=[];let n="",o=0;const i=()=>{if(n.length===0)throw new qe(Te.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;o<e.length;){const c=e[o];if(c==="\\"){if(o+1===e.length)throw new qe(Te.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[o+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new qe(Te.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=d,o+=2}else c==="`"?(a=!a,o++):c!=="."||a?(n+=c,o++):(i(),o++)}if(i(),a)throw new qe(Te.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new yr(r)}static emptyPath(){return new yr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{constructor(e){this.path=e}static fromPath(e){return new tt(Kt.fromString(e))}static fromName(e){return new tt(Kt.fromString(e).popFirst(5))}static empty(){return new tt(Kt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Kt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Kt.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new tt(new Kt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qf(t,e,r){if(!r)throw new qe(Te.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function nS(t,e,r,n){if(e===!0&&n===!0)throw new qe(Te.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function Gd(t){if(!tt.isDocumentKey(t))throw new qe(Te.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Hd(t){if(tt.isDocumentKey(t))throw new qe(Te.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Jf(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function ja(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":it(12329,{type:typeof t})}function Rn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new qe(Te.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=ja(t);throw new qe(Te.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lr(t,e){const r={typeString:t};return e&&(r.value=e),r}function gs(t,e){if(!Jf(t))throw new qe(Te.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const o=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const a=t[n];if(o&&typeof a!==o){r=`JSON field '${n}' must be a ${o}.`;break}if(i!==void 0&&a!==i.value){r=`Expected '${n}' field to equal '${i.value}'`;break}}if(r)throw new qe(Te.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yd=-62135596800,Wd=1e6;class Jt{static now(){return Jt.fromMillis(Date.now())}static fromDate(e){return Jt.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*Wd);return new Jt(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new qe(Te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new qe(Te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<Yd)throw new qe(Te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new qe(Te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Wd}_compareTo(e){return this.seconds===e.seconds?It(this.nanoseconds,e.nanoseconds):It(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Jt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(gs(e,Jt._jsonSchema))return new Jt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Yd;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Jt._jsonSchemaVersion="firestore/timestamp/1.0",Jt._jsonSchema={type:lr("string",Jt._jsonSchemaVersion),seconds:lr("number"),nanoseconds:lr("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{static fromTimestamp(e){return new ht(e)}static min(){return new ht(new Jt(0,0))}static max(){return new ht(new Jt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rs=-1;function oS(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,o=ht.fromTimestamp(n===1e9?new Jt(r+1,0):new Jt(r,n));return new eo(o,tt.empty(),e)}function iS(t){return new eo(t.readTime,t.key,rs)}class eo{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new eo(ht.min(),tt.empty(),rs)}static max(){return new eo(ht.max(),tt.empty(),rs)}}function sS(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=tt.comparator(t.documentKey,e.documentKey),r!==0?r:It(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class lS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pi(t){if(t.code!==Te.FAILED_PRECONDITION||t.message!==aS)throw t;Ye("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&it(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Re((n,o)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,o)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,o)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Re?r:Re.resolve(r)}catch(r){return Re.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Re.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Re.reject(r)}static resolve(e){return new Re((r,n)=>{r(e)})}static reject(e){return new Re((r,n)=>{n(e)})}static waitFor(e){return new Re((r,n)=>{let o=0,i=0,a=!1;e.forEach(c=>{++o,c.next(()=>{++i,a&&i===o&&r()},d=>n(d))}),a=!0,i===o&&r()})}static or(e){let r=Re.resolve(!1);for(const n of e)r=r.next(o=>o?Re.resolve(o):n());return r}static forEach(e,r){const n=[];return e.forEach((o,i)=>{n.push(r.call(this,o,i))}),this.waitFor(n)}static mapArray(e,r){return new Re((n,o)=>{const i=e.length,a=new Array(i);let c=0;for(let d=0;d<i;d++){const h=d;r(e[h]).next(m=>{a[h]=m,++c,c===i&&n(a)},m=>o(m))}})}static doWhile(e,r){return new Re((n,o)=>{const i=()=>{e()===!0?r().next(()=>{i()},o):n()};i()})}}function cS(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function vi(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}za.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wc=-1;function qa(t){return t==null}function Ca(t){return t===0&&1/t==-1/0}function uS(t){return typeof t=="number"&&Number.isInteger(t)&&!Ca(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xf="";function dS(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=Kd(e)),e=hS(t.get(r),e);return Kd(e)}function hS(t,e){let r=e;const n=t.length;for(let o=0;o<n;o++){const i=t.charAt(o);switch(i){case"\0":r+="";break;case Xf:r+="";break;default:r+=i}}return r}function Kd(t){return t+Xf+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qd(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function lo(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function Zf(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e,r){this.comparator=e,this.root=r||fr.EMPTY}insert(e,r){return new Zt(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,fr.BLACK,null,null))}remove(e){return new Zt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,fr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const o=this.comparator(e,n.key);if(o===0)return r+n.left.size;o<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ms(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ms(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ms(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ms(this.root,e,this.comparator,!0)}}class Ms{constructor(e,r,n,o){this.isReverse=o,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&o&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class fr{constructor(e,r,n,o,i){this.key=e,this.value=r,this.color=n??fr.RED,this.left=o??fr.EMPTY,this.right=i??fr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,o,i){return new fr(e??this.key,r??this.value,n??this.color,o??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let o=this;const i=n(e,o.key);return o=i<0?o.copy(null,null,null,o.left.insert(e,r,n),null):i===0?o.copy(null,r,null,null,null):o.copy(null,null,null,null,o.right.insert(e,r,n)),o.fixUp()}removeMin(){if(this.left.isEmpty())return fr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,o=this;if(r(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,r),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),r(e,o.key)===0){if(o.right.isEmpty())return fr.EMPTY;n=o.right.min(),o=o.copy(n.key,n.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,r))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,fr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,fr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw it(43730,{key:this.key,value:this.value});if(this.right.isRed())throw it(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw it(27949);return e+(this.isRed()?0:1)}}fr.EMPTY=null,fr.RED=!0,fr.BLACK=!1;fr.EMPTY=new class{constructor(){this.size=0}get key(){throw it(57766)}get value(){throw it(16141)}get color(){throw it(16727)}get left(){throw it(29726)}get right(){throw it(36894)}copy(e,r,n,o,i){return this}insert(e,r,n){return new fr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur{constructor(e){this.comparator=e,this.data=new Zt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const o=n.getNext();if(this.comparator(o.key,e[1])>=0)return;r(o.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new Jd(this.data.getIterator())}getIteratorFrom(e){return new Jd(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof ur)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const o=r.getNext().key,i=n.getNext().key;if(this.comparator(o,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new ur(this.comparator);return r.data=e,r}}class Jd{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br{constructor(e){this.fields=e,e.sort(yr.comparator)}static empty(){return new Br([])}unionWith(e){let r=new ur(yr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Br(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return ai(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ey extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(o){try{return atob(o)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new ey("Invalid base64 string: "+i):i}}(e);return new vr(r)}static fromUint8Array(e){const r=function(o){let i="";for(let a=0;a<o.length;++a)i+=String.fromCharCode(o[a]);return i}(e);return new vr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let o=0;o<r.length;o++)n[o]=r.charCodeAt(o);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return It(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}vr.EMPTY_BYTE_STRING=new vr("");const mS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function to(t){if(jt(!!t,39018),typeof t=="string"){let e=0;const r=mS.exec(t);if(jt(!!r,46558,{timestamp:t}),r[1]){let o=r[1];o=(o+"000000000").substr(0,9),e=Number(o)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:rr(t.seconds),nanos:rr(t.nanos)}}function rr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ro(t){return typeof t=="string"?vr.fromBase64String(t):vr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ty="server_timestamp",ry="__type__",ny="__previous_value__",oy="__local_write_time__";function Kc(t){return(t?.mapValue?.fields||{})[ry]?.stringValue===ty}function Ga(t){const e=t.mapValue.fields[ny];return Kc(e)?Ga(e):e}function ns(t){const e=to(t.mapValue.fields[oy].timestampValue);return new Jt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(e,r,n,o,i,a,c,d,h,m){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=o,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=d,this.useFetchStreams=h,this.isUsingEmulator=m}}const Aa="(default)";class os{constructor(e,r){this.projectId=e,this.database=r||Aa}static empty(){return new os("","")}get isDefaultDatabase(){return this.database===Aa}isEqual(e){return e instanceof os&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iy="__type__",yS="__max__",Os={mapValue:{}},sy="__vector__",Ia="value";function no(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Kc(t)?4:pS(t)?9007199254740991:gS(t)?10:11:it(28295,{value:t})}function gn(t,e){if(t===e)return!0;const r=no(t);if(r!==no(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ns(t).isEqual(ns(e));case 3:return function(o,i){if(typeof o.timestampValue=="string"&&typeof i.timestampValue=="string"&&o.timestampValue.length===i.timestampValue.length)return o.timestampValue===i.timestampValue;const a=to(o.timestampValue),c=to(i.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(o,i){return ro(o.bytesValue).isEqual(ro(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(o,i){return rr(o.geoPointValue.latitude)===rr(i.geoPointValue.latitude)&&rr(o.geoPointValue.longitude)===rr(i.geoPointValue.longitude)}(t,e);case 2:return function(o,i){if("integerValue"in o&&"integerValue"in i)return rr(o.integerValue)===rr(i.integerValue);if("doubleValue"in o&&"doubleValue"in i){const a=rr(o.doubleValue),c=rr(i.doubleValue);return a===c?Ca(a)===Ca(c):isNaN(a)&&isNaN(c)}return!1}(t,e);case 9:return ai(t.arrayValue.values||[],e.arrayValue.values||[],gn);case 10:case 11:return function(o,i){const a=o.mapValue.fields||{},c=i.mapValue.fields||{};if(Qd(a)!==Qd(c))return!1;for(const d in a)if(a.hasOwnProperty(d)&&(c[d]===void 0||!gn(a[d],c[d])))return!1;return!0}(t,e);default:return it(52216,{left:t})}}function is(t,e){return(t.values||[]).find(r=>gn(r,e))!==void 0}function li(t,e){if(t===e)return 0;const r=no(t),n=no(e);if(r!==n)return It(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return It(t.booleanValue,e.booleanValue);case 2:return function(i,a){const c=rr(i.integerValue||i.doubleValue),d=rr(a.integerValue||a.doubleValue);return c<d?-1:c>d?1:c===d?0:isNaN(c)?isNaN(d)?0:-1:1}(t,e);case 3:return Xd(t.timestampValue,e.timestampValue);case 4:return Xd(ns(t),ns(e));case 5:return ic(t.stringValue,e.stringValue);case 6:return function(i,a){const c=ro(i),d=ro(a);return c.compareTo(d)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const c=i.split("/"),d=a.split("/");for(let h=0;h<c.length&&h<d.length;h++){const m=It(c[h],d[h]);if(m!==0)return m}return It(c.length,d.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const c=It(rr(i.latitude),rr(a.latitude));return c!==0?c:It(rr(i.longitude),rr(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Zd(t.arrayValue,e.arrayValue);case 10:return function(i,a){const c=i.fields||{},d=a.fields||{},h=c[Ia]?.arrayValue,m=d[Ia]?.arrayValue,g=It(h?.values?.length||0,m?.values?.length||0);return g!==0?g:Zd(h,m)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===Os.mapValue&&a===Os.mapValue)return 0;if(i===Os.mapValue)return 1;if(a===Os.mapValue)return-1;const c=i.fields||{},d=Object.keys(c),h=a.fields||{},m=Object.keys(h);d.sort(),m.sort();for(let g=0;g<d.length&&g<m.length;++g){const _=ic(d[g],m[g]);if(_!==0)return _;const A=li(c[d[g]],h[m[g]]);if(A!==0)return A}return It(d.length,m.length)}(t.mapValue,e.mapValue);default:throw it(23264,{he:r})}}function Xd(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return It(t,e);const r=to(t),n=to(e),o=It(r.seconds,n.seconds);return o!==0?o:It(r.nanos,n.nanos)}function Zd(t,e){const r=t.values||[],n=e.values||[];for(let o=0;o<r.length&&o<n.length;++o){const i=li(r[o],n[o]);if(i)return i}return It(r.length,n.length)}function ci(t){return sc(t)}function sc(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=to(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return ro(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return tt.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",o=!0;for(const i of r.values||[])o?o=!1:n+=",",n+=sc(i);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let o="{",i=!0;for(const a of n)i?i=!1:o+=",",o+=`${a}:${sc(r.fields[a])}`;return o+"}"}(t.mapValue):it(61005,{value:t})}function oa(t){switch(no(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ga(t);return e?16+oa(e):16;case 5:return 2*t.stringValue.length;case 6:return ro(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((o,i)=>o+oa(i),0)}(t.arrayValue);case 10:case 11:return function(n){let o=0;return lo(n.fields,(i,a)=>{o+=i.length+oa(a)}),o}(t.mapValue);default:throw it(13486,{value:t})}}function eh(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function ac(t){return!!t&&"integerValue"in t}function Qc(t){return!!t&&"arrayValue"in t}function th(t){return!!t&&"nullValue"in t}function rh(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ia(t){return!!t&&"mapValue"in t}function gS(t){return(t?.mapValue?.fields||{})[iy]?.stringValue===sy}function Gi(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return lo(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Gi(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Gi(t.arrayValue.values[r]);return e}return{...t}}function pS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===yS}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(e){this.value=e}static empty(){return new Nr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!ia(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Gi(r)}setAll(e){let r=yr.emptyPath(),n={},o=[];e.forEach((a,c)=>{if(!r.isImmediateParentOf(c)){const d=this.getFieldsMap(r);this.applyChanges(d,n,o),n={},o=[],r=c.popLast()}a?n[c.lastSegment()]=Gi(a):o.push(c.lastSegment())});const i=this.getFieldsMap(r);this.applyChanges(i,n,o)}delete(e){const r=this.field(e.popLast());ia(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return gn(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let o=r.mapValue.fields[e.get(n)];ia(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=o),r=o}return r.mapValue.fields}applyChanges(e,r,n){lo(r,(o,i)=>e[o]=i);for(const o of n)delete e[o]}clone(){return new Nr(Gi(this.value))}}function ay(t){const e=[];return lo(t.fields,(r,n)=>{const o=new yr([r]);if(ia(n)){const i=ay(n.mapValue).fields;if(i.length===0)e.push(o);else for(const a of i)e.push(o.child(a))}else e.push(o)}),new Br(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(e,r,n,o,i,a,c){this.key=e,this.documentType=r,this.version=n,this.readTime=o,this.createTime=i,this.data=a,this.documentState=c}static newInvalidDocument(e){return new Ir(e,0,ht.min(),ht.min(),ht.min(),Nr.empty(),0)}static newFoundDocument(e,r,n,o){return new Ir(e,1,r,ht.min(),n,o,0)}static newNoDocument(e,r){return new Ir(e,2,r,ht.min(),ht.min(),Nr.empty(),0)}static newUnknownDocument(e,r){return new Ir(e,3,r,ht.min(),ht.min(),Nr.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(ht.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Nr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Nr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ht.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ir&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ir(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa{constructor(e,r){this.position=e,this.inclusive=r}}function nh(t,e,r){let n=0;for(let o=0;o<t.position.length;o++){const i=e[o],a=t.position[o];if(i.field.isKeyField()?n=tt.comparator(tt.fromName(a.referenceValue),r.key):n=li(a,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function oh(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!gn(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e,r="asc"){this.field=e,this.dir=r}}function vS(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ly{}class ar extends ly{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new _S(e,r,n):r==="array-contains"?new wS(e,n):r==="in"?new CS(e,n):r==="not-in"?new AS(e,n):r==="array-contains-any"?new IS(e,n):new ar(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new SS(e,n):new PS(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(li(r,this.value)):r!==null&&no(this.value)===no(r)&&this.matchesComparison(li(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return it(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Zr extends ly{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Zr(e,r)}matches(e){return cy(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function cy(t){return t.op==="and"}function uy(t){return bS(t)&&cy(t)}function bS(t){for(const e of t.filters)if(e instanceof Zr)return!1;return!0}function lc(t){if(t instanceof ar)return t.field.canonicalString()+t.op.toString()+ci(t.value);if(uy(t))return t.filters.map(e=>lc(e)).join(",");{const e=t.filters.map(r=>lc(r)).join(",");return`${t.op}(${e})`}}function dy(t,e){return t instanceof ar?function(n,o){return o instanceof ar&&n.op===o.op&&n.field.isEqual(o.field)&&gn(n.value,o.value)}(t,e):t instanceof Zr?function(n,o){return o instanceof Zr&&n.op===o.op&&n.filters.length===o.filters.length?n.filters.reduce((i,a,c)=>i&&dy(a,o.filters[c]),!0):!1}(t,e):void it(19439)}function hy(t){return t instanceof ar?function(r){return`${r.field.canonicalString()} ${r.op} ${ci(r.value)}`}(t):t instanceof Zr?function(r){return r.op.toString()+" {"+r.getFilters().map(hy).join(" ,")+"}"}(t):"Filter"}class _S extends ar{constructor(e,r,n){super(e,r,n),this.key=tt.fromName(n.referenceValue)}matches(e){const r=tt.comparator(e.key,this.key);return this.matchesComparison(r)}}class SS extends ar{constructor(e,r){super(e,"in",r),this.keys=my("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class PS extends ar{constructor(e,r){super(e,"not-in",r),this.keys=my("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function my(t,e){return(e.arrayValue?.values||[]).map(r=>tt.fromName(r.referenceValue))}class wS extends ar{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Qc(r)&&is(r.arrayValue,this.value)}}class CS extends ar{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&is(this.value.arrayValue,r)}}class AS extends ar{constructor(e,r){super(e,"not-in",r)}matches(e){if(is(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!is(this.value.arrayValue,r)}}class IS extends ar{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Qc(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>is(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(e,r=null,n=[],o=[],i=null,a=null,c=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=o,this.limit=i,this.startAt=a,this.endAt=c,this.Te=null}}function ih(t,e=null,r=[],n=[],o=null,i=null,a=null){return new xS(t,e,r,n,o,i,a)}function Jc(t){const e=mt(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>lc(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),qa(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>ci(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>ci(n)).join(",")),e.Te=r}return e.Te}function Xc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!vS(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!dy(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!oh(t.startAt,e.startAt)&&oh(t.endAt,e.endAt)}function cc(t){return tt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(e,r=null,n=[],o=[],i=null,a="F",c=null,d=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=o,this.limit=i,this.limitType=a,this.startAt=c,this.endAt=d,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function ES(t,e,r,n,o,i,a,c){return new bi(t,e,r,n,o,i,a,c)}function Zc(t){return new bi(t)}function sh(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function fy(t){return t.collectionGroup!==null}function Hi(t){const e=mt(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new ur(yr.comparator);return a.filters.forEach(d=>{d.getFlattenedFilters().forEach(h=>{h.isInequality()&&(c=c.add(h.field))})}),c})(e).forEach(i=>{r.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new ss(i,n))}),r.has(yr.keyField().canonicalString())||e.Ie.push(new ss(yr.keyField(),n))}return e.Ie}function un(t){const e=mt(t);return e.Ee||(e.Ee=TS(e,Hi(t))),e.Ee}function TS(t,e){if(t.limitType==="F")return ih(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(o=>{const i=o.dir==="desc"?"asc":"desc";return new ss(o.field,i)});const r=t.endAt?new xa(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new xa(t.startAt.position,t.startAt.inclusive):null;return ih(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function uc(t,e){const r=t.filters.concat([e]);return new bi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function dc(t,e,r){return new bi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Ha(t,e){return Xc(un(t),un(e))&&t.limitType===e.limitType}function yy(t){return`${Jc(un(t))}|lt:${t.limitType}`}function Ko(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(o=>hy(o)).join(", ")}]`),qa(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(o=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(o)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(o=>ci(o)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(o=>ci(o)).join(",")),`Target(${n})`}(un(t))}; limitType=${t.limitType})`}function Ya(t,e){return e.isFoundDocument()&&function(n,o){const i=o.key.path;return n.collectionGroup!==null?o.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):tt.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,o){for(const i of Hi(n))if(!i.field.isKeyField()&&o.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,o){for(const i of n.filters)if(!i.matches(o))return!1;return!0}(t,e)&&function(n,o){return!(n.startAt&&!function(a,c,d){const h=nh(a,c,d);return a.inclusive?h<=0:h<0}(n.startAt,Hi(n),o)||n.endAt&&!function(a,c,d){const h=nh(a,c,d);return a.inclusive?h>=0:h>0}(n.endAt,Hi(n),o))}(t,e)}function $S(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function gy(t){return(e,r)=>{let n=!1;for(const o of Hi(t)){const i=kS(o,e,r);if(i!==0)return i;n=n||o.field.isKeyField()}return 0}}function kS(t,e,r){const n=t.field.isKeyField()?tt.comparator(e.key,r.key):function(i,a,c){const d=a.data.field(i),h=c.data.field(i);return d!==null&&h!==null?li(d,h):it(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return it(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[o,i]of n)if(this.equalsFn(o,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),o=this.inner[n];if(o===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<o.length;i++)if(this.equalsFn(o[i][0],e))return void(o[i]=[e,r]);o.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let o=0;o<n.length;o++)if(this.equalsFn(n[o][0],e))return n.length===1?delete this.inner[r]:n.splice(o,1),this.innerSize--,!0;return!1}forEach(e){lo(this.inner,(r,n)=>{for(const[o,i]of n)e(o,i)})}isEmpty(){return Zf(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RS=new Zt(tt.comparator);function Dn(){return RS}const py=new Zt(tt.comparator);function Oi(...t){let e=py;for(const r of t)e=e.insert(r.key,r);return e}function vy(t){let e=py;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function wo(){return Yi()}function by(){return Yi()}function Yi(){return new Do(t=>t.toString(),(t,e)=>t.isEqual(e))}const DS=new Zt(tt.comparator),NS=new ur(tt.comparator);function xt(...t){let e=NS;for(const r of t)e=e.add(r);return e}const LS=new ur(It);function MS(){return LS}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eu(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ca(e)?"-0":e}}function _y(t){return{integerValue:""+t}}function OS(t,e){return uS(e)?_y(e):eu(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa{constructor(){this._=void 0}}function VS(t,e,r){return t instanceof Ea?function(o,i){const a={fields:{[ry]:{stringValue:ty},[oy]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return i&&Kc(i)&&(i=Ga(i)),i&&(a.fields[ny]=i),{mapValue:a}}(r,e):t instanceof as?Py(t,e):t instanceof ls?wy(t,e):function(o,i){const a=Sy(o,i),c=ah(a)+ah(o.Ae);return ac(a)&&ac(o.Ae)?_y(c):eu(o.serializer,c)}(t,e)}function BS(t,e,r){return t instanceof as?Py(t,e):t instanceof ls?wy(t,e):r}function Sy(t,e){return t instanceof Ta?function(n){return ac(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class Ea extends Wa{}class as extends Wa{constructor(e){super(),this.elements=e}}function Py(t,e){const r=Cy(e);for(const n of t.elements)r.some(o=>gn(o,n))||r.push(n);return{arrayValue:{values:r}}}class ls extends Wa{constructor(e){super(),this.elements=e}}function wy(t,e){let r=Cy(e);for(const n of t.elements)r=r.filter(o=>!gn(o,n));return{arrayValue:{values:r}}}class Ta extends Wa{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function ah(t){return rr(t.integerValue||t.doubleValue)}function Cy(t){return Qc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function FS(t,e){return t.field.isEqual(e.field)&&function(n,o){return n instanceof as&&o instanceof as||n instanceof ls&&o instanceof ls?ai(n.elements,o.elements,gn):n instanceof Ta&&o instanceof Ta?gn(n.Ae,o.Ae):n instanceof Ea&&o instanceof Ea}(t.transform,e.transform)}class US{constructor(e,r){this.version=e,this.transformResults=r}}class dn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new dn}static exists(e){return new dn(void 0,e)}static updateTime(e){return new dn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function sa(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Ka{}function Ay(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new xy(t.key,dn.none()):new ps(t.key,t.data,dn.none());{const r=t.data,n=Nr.empty();let o=new ur(yr.comparator);for(let i of e.fields)if(!o.has(i)){let a=r.field(i);a===null&&i.length>1&&(i=i.popLast(),a=r.field(i)),a===null?n.delete(i):n.set(i,a),o=o.add(i)}return new co(t.key,n,new Br(o.toArray()),dn.none())}}function jS(t,e,r){t instanceof ps?function(o,i,a){const c=o.value.clone(),d=ch(o.fieldTransforms,i,a.transformResults);c.setAll(d),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,r):t instanceof co?function(o,i,a){if(!sa(o.precondition,i))return void i.convertToUnknownDocument(a.version);const c=ch(o.fieldTransforms,i,a.transformResults),d=i.data;d.setAll(Iy(o)),d.setAll(c),i.convertToFoundDocument(a.version,d).setHasCommittedMutations()}(t,e,r):function(o,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function Wi(t,e,r,n){return t instanceof ps?function(i,a,c,d){if(!sa(i.precondition,a))return c;const h=i.value.clone(),m=uh(i.fieldTransforms,d,a);return h.setAll(m),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(t,e,r,n):t instanceof co?function(i,a,c,d){if(!sa(i.precondition,a))return c;const h=uh(i.fieldTransforms,d,a),m=a.data;return m.setAll(Iy(i)),m.setAll(h),a.convertToFoundDocument(a.version,m).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(g=>g.field))}(t,e,r,n):function(i,a,c){return sa(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(t,e,r)}function zS(t,e){let r=null;for(const n of t.fieldTransforms){const o=e.data.field(n.field),i=Sy(n.transform,o||null);i!=null&&(r===null&&(r=Nr.empty()),r.set(n.field,i))}return r||null}function lh(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,o){return n===void 0&&o===void 0||!(!n||!o)&&ai(n,o,(i,a)=>FS(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ps extends Ka{constructor(e,r,n,o=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class co extends Ka{constructor(e,r,n,o,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=o,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Iy(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function ch(t,e,r){const n=new Map;jt(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let o=0;o<r.length;o++){const i=t[o],a=i.transform,c=e.data.field(i.field);n.set(i.field,BS(a,c,r[o]))}return n}function uh(t,e,r){const n=new Map;for(const o of t){const i=o.transform,a=r.data.field(o.field);n.set(o.field,VS(i,a,e))}return n}class xy extends Ka{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class qS extends Ka{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(e,r,n,o){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=o}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let o=0;o<this.mutations.length;o++){const i=this.mutations[o];i.key.isEqual(e.key)&&jS(i,e,n[o])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Wi(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Wi(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=by();return this.mutations.forEach(o=>{const i=e.get(o.key),a=i.overlayedDocument;let c=this.applyToLocalView(a,i.mutatedFields);c=r.has(o.key)?null:c;const d=Ay(a,c);d!==null&&n.set(o.key,d),a.isValidDocument()||a.convertToNoDocument(ht.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),xt())}isEqual(e){return this.batchId===e.batchId&&ai(this.mutations,e.mutations,(r,n)=>lh(r,n))&&ai(this.baseMutations,e.baseMutations,(r,n)=>lh(r,n))}}class tu{constructor(e,r,n,o){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=o}static from(e,r,n){jt(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let o=function(){return DS}();const i=e.mutations;for(let a=0;a<i.length;a++)o=o.insert(i[a].key,n[a].version);return new tu(e,r,n,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HS{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YS{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var sr,Rt;function WS(t){switch(t){case Te.OK:return it(64938);case Te.CANCELLED:case Te.UNKNOWN:case Te.DEADLINE_EXCEEDED:case Te.RESOURCE_EXHAUSTED:case Te.INTERNAL:case Te.UNAVAILABLE:case Te.UNAUTHENTICATED:return!1;case Te.INVALID_ARGUMENT:case Te.NOT_FOUND:case Te.ALREADY_EXISTS:case Te.PERMISSION_DENIED:case Te.FAILED_PRECONDITION:case Te.ABORTED:case Te.OUT_OF_RANGE:case Te.UNIMPLEMENTED:case Te.DATA_LOSS:return!0;default:return it(15467,{code:t})}}function Ey(t){if(t===void 0)return kn("GRPC error has no .code"),Te.UNKNOWN;switch(t){case sr.OK:return Te.OK;case sr.CANCELLED:return Te.CANCELLED;case sr.UNKNOWN:return Te.UNKNOWN;case sr.DEADLINE_EXCEEDED:return Te.DEADLINE_EXCEEDED;case sr.RESOURCE_EXHAUSTED:return Te.RESOURCE_EXHAUSTED;case sr.INTERNAL:return Te.INTERNAL;case sr.UNAVAILABLE:return Te.UNAVAILABLE;case sr.UNAUTHENTICATED:return Te.UNAUTHENTICATED;case sr.INVALID_ARGUMENT:return Te.INVALID_ARGUMENT;case sr.NOT_FOUND:return Te.NOT_FOUND;case sr.ALREADY_EXISTS:return Te.ALREADY_EXISTS;case sr.PERMISSION_DENIED:return Te.PERMISSION_DENIED;case sr.FAILED_PRECONDITION:return Te.FAILED_PRECONDITION;case sr.ABORTED:return Te.ABORTED;case sr.OUT_OF_RANGE:return Te.OUT_OF_RANGE;case sr.UNIMPLEMENTED:return Te.UNIMPLEMENTED;case sr.DATA_LOSS:return Te.DATA_LOSS;default:return it(39323,{code:t})}}(Rt=sr||(sr={}))[Rt.OK=0]="OK",Rt[Rt.CANCELLED=1]="CANCELLED",Rt[Rt.UNKNOWN=2]="UNKNOWN",Rt[Rt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Rt[Rt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Rt[Rt.NOT_FOUND=5]="NOT_FOUND",Rt[Rt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Rt[Rt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Rt[Rt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Rt[Rt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Rt[Rt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Rt[Rt.ABORTED=10]="ABORTED",Rt[Rt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Rt[Rt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Rt[Rt.INTERNAL=13]="INTERNAL",Rt[Rt.UNAVAILABLE=14]="UNAVAILABLE",Rt[Rt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KS(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QS=new Xn([4294967295,4294967295],0);function dh(t){const e=KS().encode(t),r=new jf;return r.update(e),new Uint8Array(r.digest())}function hh(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),o=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Xn([r,n],0),new Xn([o,i],0)]}class ru{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Vi(`Invalid padding: ${r}`);if(n<0)throw new Vi(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Vi(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Vi(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Xn.fromNumber(this.ge)}ye(e,r,n){let o=e.add(r.multiply(Xn.fromNumber(n)));return o.compare(QS)===1&&(o=new Xn([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=dh(e),[n,o]=hh(r);for(let i=0;i<this.hashCount;i++){const a=this.ye(n,o,i);if(!this.we(a))return!1}return!0}static create(e,r,n){const o=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new ru(i,o,r);return n.forEach(c=>a.insert(c)),a}insert(e){if(this.ge===0)return;const r=dh(e),[n,o]=hh(r);for(let i=0;i<this.hashCount;i++){const a=this.ye(n,o,i);this.Se(a)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Vi extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(e,r,n,o,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=o,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const o=new Map;return o.set(e,vs.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Qa(ht.min(),o,new Zt(It),Dn(),xt())}}class vs{constructor(e,r,n,o,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=o,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new vs(n,r,xt(),xt(),xt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aa{constructor(e,r,n,o){this.be=e,this.removedTargetIds=r,this.key=n,this.De=o}}class Ty{constructor(e,r){this.targetId=e,this.Ce=r}}class $y{constructor(e,r,n=vr.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=o}}class mh{constructor(){this.ve=0,this.Fe=fh(),this.Me=vr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=xt(),r=xt(),n=xt();return this.Fe.forEach((o,i)=>{switch(i){case 0:e=e.add(o);break;case 2:r=r.add(o);break;case 1:n=n.add(o);break;default:it(38017,{changeType:i})}}),new vs(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=fh()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,jt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class JS{constructor(e){this.Ge=e,this.ze=new Map,this.je=Dn(),this.Je=Vs(),this.He=Vs(),this.Ye=new Zt(It)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:it(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,o)=>{this.rt(o)&&r(o)})}st(e){const r=e.targetId,n=e.Ce.count,o=this.ot(r);if(o){const i=o.target;if(cc(i))if(n===0){const a=new tt(i.path);this.et(r,a,Ir.newNoDocument(a,ht.min()))}else jt(n===1,20013,{expectedCount:n});else{const a=this._t(r);if(a!==n){const c=this.ut(e),d=c?this.ct(c,e,a):1;if(d!==0){this.it(r);const h=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,h)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:o=0},hashCount:i=0}=r;let a,c;try{a=ro(n).toUint8Array()}catch(d){if(d instanceof ey)return si("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{c=new ru(a,o,i)}catch(d){return si(d instanceof Vi?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return c.ge===0?null:c}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let o=0;return n.forEach(i=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(r,i,null),o++)}),o}Tt(e){const r=new Map;this.ze.forEach((i,a)=>{const c=this.ot(a);if(c){if(i.current&&cc(c.target)){const d=new tt(c.target.path);this.It(d).has(a)||this.Et(a,d)||this.et(a,d,Ir.newNoDocument(d,e))}i.Be&&(r.set(a,i.ke()),i.qe())}});let n=xt();this.He.forEach((i,a)=>{let c=!0;a.forEachWhile(d=>{const h=this.ot(d);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(n=n.add(i))}),this.je.forEach((i,a)=>a.setReadTime(e));const o=new Qa(e,r,this.Ye,this.je,n);return this.je=Dn(),this.Je=Vs(),this.He=Vs(),this.Ye=new Zt(It),o}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,r)?o.Qe(r,1):o.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new mh,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new ur(It),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new ur(It),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Ye("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new mh),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function Vs(){return new Zt(tt.comparator)}function fh(){return new Zt(tt.comparator)}const XS={asc:"ASCENDING",desc:"DESCENDING"},ZS={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},e1={and:"AND",or:"OR"};class t1{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function hc(t,e){return t.useProto3Json||qa(e)?e:{value:e}}function $a(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ky(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function r1(t,e){return $a(t,e.toTimestamp())}function hn(t){return jt(!!t,49232),ht.fromTimestamp(function(r){const n=to(r);return new Jt(n.seconds,n.nanos)}(t))}function nu(t,e){return mc(t,e).canonicalString()}function mc(t,e){const r=function(o){return new Kt(["projects",o.projectId,"databases",o.database])}(t).child("documents");return e===void 0?r:r.child(e)}function Ry(t){const e=Kt.fromString(t);return jt(Oy(e),10190,{key:e.toString()}),e}function fc(t,e){return nu(t.databaseId,e.path)}function Sl(t,e){const r=Ry(e);if(r.get(1)!==t.databaseId.projectId)throw new qe(Te.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new qe(Te.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new tt(Ny(r))}function Dy(t,e){return nu(t.databaseId,e)}function n1(t){const e=Ry(t);return e.length===4?Kt.emptyPath():Ny(e)}function yc(t){return new Kt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Ny(t){return jt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function yh(t,e,r){return{name:fc(t,e),fields:r.value.mapValue.fields}}function o1(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:it(39313,{state:h})}(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],i=function(h,m){return h.useProto3Json?(jt(m===void 0||typeof m=="string",58123),vr.fromBase64String(m||"")):(jt(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),vr.fromUint8Array(m||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(h){const m=h.code===void 0?Te.UNKNOWN:Ey(h.code);return new qe(m,h.message||"")}(a);r=new $y(n,o,i,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const o=Sl(t,n.document.name),i=hn(n.document.updateTime),a=n.document.createTime?hn(n.document.createTime):ht.min(),c=new Nr({mapValue:{fields:n.document.fields}}),d=Ir.newFoundDocument(o,i,a,c),h=n.targetIds||[],m=n.removedTargetIds||[];r=new aa(h,m,d.key,d)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const o=Sl(t,n.document),i=n.readTime?hn(n.readTime):ht.min(),a=Ir.newNoDocument(o,i),c=n.removedTargetIds||[];r=new aa([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const o=Sl(t,n.document),i=n.removedTargetIds||[];r=new aa([],i,o,null)}else{if(!("filter"in e))return it(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:o=0,unchangedNames:i}=n,a=new YS(o,i),c=n.targetId;r=new Ty(c,a)}}return r}function i1(t,e){let r;if(e instanceof ps)r={update:yh(t,e.key,e.value)};else if(e instanceof xy)r={delete:fc(t,e.key)};else if(e instanceof co)r={update:yh(t,e.key,e.data),updateMask:f1(e.fieldMask)};else{if(!(e instanceof qS))return it(16599,{Vt:e.type});r={verify:fc(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(i,a){const c=a.transform;if(c instanceof Ea)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof as)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof ls)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Ta)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw it(20930,{transform:a.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(o,i){return i.updateTime!==void 0?{updateTime:r1(o,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:it(27497)}(t,e.precondition)),r}function s1(t,e){return t&&t.length>0?(jt(e!==void 0,14353),t.map(r=>function(o,i){let a=o.updateTime?hn(o.updateTime):hn(i);return a.isEqual(ht.min())&&(a=hn(i)),new US(a,o.transformResults||[])}(r,e))):[]}function a1(t,e){return{documents:[Dy(t,e.path)]}}function l1(t,e){const r={structuredQuery:{}},n=e.path;let o;e.collectionGroup!==null?(o=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=Dy(t,o);const i=function(h){if(h.length!==0)return My(Zr.create(h,"and"))}(e.filters);i&&(r.structuredQuery.where=i);const a=function(h){if(h.length!==0)return h.map(m=>function(_){return{field:Qo(_.field),direction:d1(_.dir)}}(m))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const c=hc(t,e.limit);return c!==null&&(r.structuredQuery.limit=c),e.startAt&&(r.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{ft:r,parent:o}}function c1(t){let e=n1(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let o=null;if(n>0){jt(n===1,65062);const m=r.from[0];m.allDescendants?o=m.collectionId:e=e.child(m.collectionId)}let i=[];r.where&&(i=function(g){const _=Ly(g);return _ instanceof Zr&&uy(_)?_.getFilters():[_]}(r.where));let a=[];r.orderBy&&(a=function(g){return g.map(_=>function(L){return new ss(Jo(L.field),function($){switch($){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(L.direction))}(_))}(r.orderBy));let c=null;r.limit&&(c=function(g){let _;return _=typeof g=="object"?g.value:g,qa(_)?null:_}(r.limit));let d=null;r.startAt&&(d=function(g){const _=!!g.before,A=g.values||[];return new xa(A,_)}(r.startAt));let h=null;return r.endAt&&(h=function(g){const _=!g.before,A=g.values||[];return new xa(A,_)}(r.endAt)),ES(e,o,a,i,c,"F",d,h)}function u1(t,e){const r=function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return it(28987,{purpose:o})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function Ly(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Jo(r.unaryFilter.field);return ar.create(n,"==",{doubleValue:NaN});case"IS_NULL":const o=Jo(r.unaryFilter.field);return ar.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Jo(r.unaryFilter.field);return ar.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Jo(r.unaryFilter.field);return ar.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return it(61313);default:return it(60726)}}(t):t.fieldFilter!==void 0?function(r){return ar.create(Jo(r.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return it(58110);default:return it(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Zr.create(r.compositeFilter.filters.map(n=>Ly(n)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return it(1026)}}(r.compositeFilter.op))}(t):it(30097,{filter:t})}function d1(t){return XS[t]}function h1(t){return ZS[t]}function m1(t){return e1[t]}function Qo(t){return{fieldPath:t.canonicalString()}}function Jo(t){return yr.fromServerFormat(t.fieldPath)}function My(t){return t instanceof ar?function(r){if(r.op==="=="){if(rh(r.value))return{unaryFilter:{field:Qo(r.field),op:"IS_NAN"}};if(th(r.value))return{unaryFilter:{field:Qo(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(rh(r.value))return{unaryFilter:{field:Qo(r.field),op:"IS_NOT_NAN"}};if(th(r.value))return{unaryFilter:{field:Qo(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Qo(r.field),op:h1(r.op),value:r.value}}}(t):t instanceof Zr?function(r){const n=r.getFilters().map(o=>My(o));return n.length===1?n[0]:{compositeFilter:{op:m1(r.op),filters:n}}}(t):it(54877,{filter:t})}function f1(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function Oy(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(e,r,n,o,i=ht.min(),a=ht.min(),c=vr.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=o,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=d}withSequenceNumber(e){return new Yn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Yn(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Yn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Yn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(e){this.yt=e}}function g1(t){const e=c1({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?dc(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p1{constructor(){this.Cn=new v1}addToCollectionParentIndex(e,r){return this.Cn.add(r),Re.resolve()}getCollectionParents(e,r){return Re.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return Re.resolve()}deleteFieldIndex(e,r){return Re.resolve()}deleteAllFieldIndexes(e){return Re.resolve()}createTargetIndexes(e,r){return Re.resolve()}getDocumentsMatchingTarget(e,r){return Re.resolve(null)}getIndexType(e,r){return Re.resolve(0)}getFieldIndexes(e,r){return Re.resolve([])}getNextCollectionGroupToUpdate(e){return Re.resolve(null)}getMinOffset(e,r){return Re.resolve(eo.min())}getMinOffsetFromCollectionGroup(e,r){return Re.resolve(eo.min())}updateCollectionGroup(e,r,n){return Re.resolve()}updateIndexEntries(e,r){return Re.resolve()}}class v1{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),o=this.index[r]||new ur(Kt.comparator),i=!o.has(n);return this.index[r]=o.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),o=this.index[r];return o&&o.has(n)}getEntries(e){return(this.index[e]||new ur(Kt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gh={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Vy=41943040;class Dr{static withCacheSize(e){return new Dr(e,Dr.DEFAULT_COLLECTION_PERCENTILE,Dr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Dr.DEFAULT_COLLECTION_PERCENTILE=10,Dr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Dr.DEFAULT=new Dr(Vy,Dr.DEFAULT_COLLECTION_PERCENTILE,Dr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Dr.DISABLED=new Dr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new ui(0)}static cr(){return new ui(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ph="LruGarbageCollector",b1=1048576;function vh([t,e],[r,n]){const o=It(t,r);return o===0?It(e,n):o}class _1{constructor(e){this.Ir=e,this.buffer=new ur(vh),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();vh(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class S1{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ye(ph,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){vi(r)?Ye(ph,"Ignoring IndexedDB error during garbage collection: ",r):await pi(r)}await this.Vr(3e5)})}}class P1{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return Re.resolve(za.ce);const n=new _1(r);return this.mr.forEachTarget(e,o=>n.Ar(o.sequenceNumber)).next(()=>this.mr.pr(e,o=>n.Ar(o))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Ye("LruGarbageCollector","Garbage collection skipped; disabled"),Re.resolve(gh)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Ye("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),gh):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,o,i,a,c,d,h;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(g=>(g>this.params.maximumSequenceNumbersToCollect?(Ye("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),o=this.params.maximumSequenceNumbersToCollect):o=g,a=Date.now(),this.nthSequenceNumber(e,o))).next(g=>(n=g,c=Date.now(),this.removeTargets(e,n,r))).next(g=>(i=g,d=Date.now(),this.removeOrphanedDocuments(e,n))).next(g=>(h=Date.now(),Wo()<=At.DEBUG&&Ye("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-m}ms
	Determined least recently used ${o} in `+(c-a)+`ms
	Removed ${i} targets in `+(d-c)+`ms
	Removed ${g} documents in `+(h-d)+`ms
Total Duration: ${h-m}ms`),Re.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:i,documentsRemoved:g})))}}function w1(t,e){return new P1(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C1{constructor(){this.changes=new Do(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Ir.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Re.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A1{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I1{constructor(e,r,n,o){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=o}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(o=>(n=o,this.remoteDocumentCache.getEntry(e,r))).next(o=>(n!==null&&Wi(n.mutation,o,Br.empty(),Jt.now()),o))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,xt()).next(()=>n))}getLocalViewOfDocuments(e,r,n=xt()){const o=wo();return this.populateOverlays(e,o,r).next(()=>this.computeViews(e,r,o,n).next(i=>{let a=Oi();return i.forEach((c,d)=>{a=a.insert(c,d.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=wo();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,xt()))}populateOverlays(e,r,n){const o=[];return n.forEach(i=>{r.has(i)||o.push(i)}),this.documentOverlayCache.getOverlays(e,o).next(i=>{i.forEach((a,c)=>{r.set(a,c)})})}computeViews(e,r,n,o){let i=Dn();const a=Yi(),c=function(){return Yi()}();return r.forEach((d,h)=>{const m=n.get(h.key);o.has(h.key)&&(m===void 0||m.mutation instanceof co)?i=i.insert(h.key,h):m!==void 0?(a.set(h.key,m.mutation.getFieldMask()),Wi(m.mutation,h,m.mutation.getFieldMask(),Jt.now())):a.set(h.key,Br.empty())}),this.recalculateAndSaveOverlays(e,i).next(d=>(d.forEach((h,m)=>a.set(h,m)),r.forEach((h,m)=>c.set(h,new A1(m,a.get(h)??null))),c))}recalculateAndSaveOverlays(e,r){const n=Yi();let o=new Zt((a,c)=>a-c),i=xt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const c of a)c.keys().forEach(d=>{const h=r.get(d);if(h===null)return;let m=n.get(d)||Br.empty();m=c.applyToLocalView(h,m),n.set(d,m);const g=(o.get(c.batchId)||xt()).add(d);o=o.insert(c.batchId,g)})}).next(()=>{const a=[],c=o.getReverseIterator();for(;c.hasNext();){const d=c.getNext(),h=d.key,m=d.value,g=by();m.forEach(_=>{if(!i.has(_)){const A=Ay(r.get(_),n.get(_));A!==null&&g.set(_,A),i=i.add(_)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,g))}return Re.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,o){return function(a){return tt.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):fy(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,o):this.getDocumentsMatchingCollectionQuery(e,r,n,o)}getNextDocuments(e,r,n,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,o).next(i=>{const a=o-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,o-i.size):Re.resolve(wo());let c=rs,d=i;return a.next(h=>Re.forEach(h,(m,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),i.get(m)?Re.resolve():this.remoteDocumentCache.getEntry(e,m).next(_=>{d=d.insert(m,_)}))).next(()=>this.populateOverlays(e,h,i)).next(()=>this.computeViews(e,d,h,xt())).next(m=>({batchId:c,changes:vy(m)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new tt(r)).next(n=>{let o=Oi();return n.isFoundDocument()&&(o=o.insert(n.key,n)),o})}getDocumentsMatchingCollectionGroupQuery(e,r,n,o){const i=r.collectionGroup;let a=Oi();return this.indexManager.getCollectionParents(e,i).next(c=>Re.forEach(c,d=>{const h=function(g,_){return new bi(_,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(r,d.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,n,o).next(m=>{m.forEach((g,_)=>{a=a.insert(g,_)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,o){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,o))).next(a=>{i.forEach((d,h)=>{const m=h.getKey();a.get(m)===null&&(a=a.insert(m,Ir.newInvalidDocument(m)))});let c=Oi();return a.forEach((d,h)=>{const m=i.get(d);m!==void 0&&Wi(m.mutation,h,Br.empty(),Jt.now()),Ya(r,h)&&(c=c.insert(d,h))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return Re.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(o){return{id:o.id,version:o.version,createTime:hn(o.createTime)}}(r)),Re.resolve()}getNamedQuery(e,r){return Re.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(o){return{name:o.name,query:g1(o.bundledQuery),readTime:hn(o.readTime)}}(r)),Re.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E1{constructor(){this.overlays=new Zt(tt.comparator),this.qr=new Map}getOverlay(e,r){return Re.resolve(this.overlays.get(r))}getOverlays(e,r){const n=wo();return Re.forEach(r,o=>this.getOverlay(e,o).next(i=>{i!==null&&n.set(o,i)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((o,i)=>{this.St(e,r,i)}),Re.resolve()}removeOverlaysForBatchId(e,r,n){const o=this.qr.get(n);return o!==void 0&&(o.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(n)),Re.resolve()}getOverlaysForCollection(e,r,n){const o=wo(),i=r.length+1,a=new tt(r.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const d=c.getNext().value,h=d.getKey();if(!r.isPrefixOf(h.path))break;h.path.length===i&&d.largestBatchId>n&&o.set(d.getKey(),d)}return Re.resolve(o)}getOverlaysForCollectionGroup(e,r,n,o){let i=new Zt((h,m)=>h-m);const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===r&&h.largestBatchId>n){let m=i.get(h.largestBatchId);m===null&&(m=wo(),i=i.insert(h.largestBatchId,m)),m.set(h.getKey(),h)}}const c=wo(),d=i.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((h,m)=>c.set(h,m)),!(c.size()>=o)););return Re.resolve(c)}St(e,r,n){const o=this.overlays.get(n.key);if(o!==null){const a=this.qr.get(o.largestBatchId).delete(n.key);this.qr.set(o.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new HS(r,n));let i=this.qr.get(r);i===void 0&&(i=xt(),this.qr.set(r,i)),this.qr.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T1{constructor(){this.sessionToken=vr.EMPTY_BYTE_STRING}getSessionToken(e){return Re.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Re.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou{constructor(){this.Qr=new ur(hr.$r),this.Ur=new ur(hr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new hr(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new hr(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new tt(new Kt([])),n=new hr(r,e),o=new hr(r,e+1),i=[];return this.Ur.forEachInRange([n,o],a=>{this.Gr(a),i.push(a.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new tt(new Kt([])),n=new hr(r,e),o=new hr(r,e+1);let i=xt();return this.Ur.forEachInRange([n,o],a=>{i=i.add(a.key)}),i}containsKey(e){const r=new hr(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class hr{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return tt.comparator(e.key,r.key)||It(e.Yr,r.Yr)}static Kr(e,r){return It(e.Yr,r.Yr)||tt.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $1{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new ur(hr.$r)}checkEmpty(e){return Re.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,o){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new GS(i,r,n,o);this.mutationQueue.push(a);for(const c of o)this.Zr=this.Zr.add(new hr(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return Re.resolve(a)}lookupMutationBatch(e,r){return Re.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,o=this.ei(n),i=o<0?0:o;return Re.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Re.resolve(this.mutationQueue.length===0?Wc:this.tr-1)}getAllMutationBatches(e){return Re.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new hr(r,0),o=new hr(r,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,o],a=>{const c=this.Xr(a.Yr);i.push(c)}),Re.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new ur(It);return r.forEach(o=>{const i=new hr(o,0),a=new hr(o,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],c=>{n=n.add(c.Yr)})}),Re.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,o=n.length+1;let i=n;tt.isDocumentKey(i)||(i=i.child(""));const a=new hr(new tt(i),0);let c=new ur(It);return this.Zr.forEachWhile(d=>{const h=d.key.path;return!!n.isPrefixOf(h)&&(h.length===o&&(c=c.add(d.Yr)),!0)},a),Re.resolve(this.ti(c))}ti(e){const r=[];return e.forEach(n=>{const o=this.Xr(n);o!==null&&r.push(o)}),r}removeMutationBatch(e,r){jt(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return Re.forEach(r.mutations,o=>{const i=new hr(o.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new hr(r,0),o=this.Zr.firstAfterOrEqual(n);return Re.resolve(r.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,Re.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k1{constructor(e){this.ri=e,this.docs=function(){return new Zt(tt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,o=this.docs.get(n),i=o?o.size:0,a=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Re.resolve(n?n.document.mutableCopy():Ir.newInvalidDocument(r))}getEntries(e,r){let n=Dn();return r.forEach(o=>{const i=this.docs.get(o);n=n.insert(o,i?i.document.mutableCopy():Ir.newInvalidDocument(o))}),Re.resolve(n)}getDocumentsMatchingQuery(e,r,n,o){let i=Dn();const a=r.path,c=new tt(a.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(c);for(;d.hasNext();){const{key:h,value:{document:m}}=d.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||sS(iS(m),n)<=0||(o.has(m.key)||Ya(r,m))&&(i=i.insert(m.key,m.mutableCopy()))}return Re.resolve(i)}getAllFromCollectionGroup(e,r,n,o){it(9500)}ii(e,r){return Re.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new R1(this)}getSize(e){return Re.resolve(this.size)}}class R1 extends C1{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,o)=>{o.isValidDocument()?r.push(this.Nr.addEntry(e,o)):this.Nr.removeEntry(n)}),Re.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D1{constructor(e){this.persistence=e,this.si=new Do(r=>Jc(r),Xc),this.lastRemoteSnapshotVersion=ht.min(),this.highestTargetId=0,this.oi=0,this._i=new ou,this.targetCount=0,this.ai=ui.ur()}forEachTarget(e,r){return this.si.forEach((n,o)=>r(o)),Re.resolve()}getLastRemoteSnapshotVersion(e){return Re.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Re.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Re.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),Re.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new ui(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,Re.resolve()}updateTargetData(e,r){return this.Pr(r),Re.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,Re.resolve()}removeTargets(e,r,n){let o=0;const i=[];return this.si.forEach((a,c)=>{c.sequenceNumber<=r&&n.get(c.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),o++)}),Re.waitFor(i).next(()=>o)}getTargetCount(e){return Re.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return Re.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),Re.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const o=this.persistence.referenceDelegate,i=[];return o&&r.forEach(a=>{i.push(o.markPotentiallyOrphaned(e,a))}),Re.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),Re.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return Re.resolve(n)}containsKey(e,r){return Re.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class By{constructor(e,r){this.ui={},this.overlays={},this.ci=new za(0),this.li=!1,this.li=!0,this.hi=new T1,this.referenceDelegate=e(this),this.Pi=new D1(this),this.indexManager=new p1,this.remoteDocumentCache=function(o){return new k1(o)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new y1(r),this.Ii=new x1(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new E1,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new $1(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Ye("MemoryPersistence","Starting transaction:",e);const o=new N1(this.ci.next());return this.referenceDelegate.Ei(),n(o).next(i=>this.referenceDelegate.di(o).next(()=>i)).toPromise().then(i=>(o.raiseOnCommittedEvent(),i))}Ai(e,r){return Re.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class N1 extends lS{constructor(e){super(),this.currentSequenceNumber=e}}class iu{constructor(e){this.persistence=e,this.Ri=new ou,this.Vi=null}static mi(e){return new iu(e)}get fi(){if(this.Vi)return this.Vi;throw it(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),Re.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),Re.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),Re.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(o=>this.fi.add(o.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(o=>{o.forEach(i=>this.fi.add(i.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Re.forEach(this.fi,n=>{const o=tt.fromPath(n);return this.gi(e,o).next(i=>{i||r.removeEntry(o,ht.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return Re.or([()=>Re.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class ka{constructor(e,r){this.persistence=e,this.pi=new Do(n=>dS(n.path),(n,o)=>n.isEqual(o)),this.garbageCollector=w1(this,r)}static mi(e,r){return new ka(e,r)}Ei(){}di(e){return Re.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(o=>n+o))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return Re.forEach(this.pi,(n,o)=>this.br(e,n,o).next(i=>i?Re.resolve():r(o)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const o=this.persistence.getRemoteDocumentCache(),i=o.newChangeBuffer();return o.ii(e,a=>this.br(e,a,r).next(c=>{c||(n++,i.removeEntry(a,ht.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),Re.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Re.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Re.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),Re.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=oa(e.data.value)),r}br(e,r,n){return Re.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const o=this.pi.get(r);return Re.resolve(o!==void 0&&o>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e,r,n,o){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=o}static As(e,r){let n=xt(),o=xt();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:o=o.add(i.doc.key)}return new su(e,r.fromCache,n,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L1{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M1{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return Iv()?8:cS(Er())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,o){const i={result:null};return this.ys(e,r).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.ws(e,r,o,n).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new L1;return this.Ss(e,r,a).next(c=>{if(i.result=c,this.Vs)return this.bs(e,r,a,c.size)})}).next(()=>i.result)}bs(e,r,n,o){return n.documentReadCount<this.fs?(Wo()<=At.DEBUG&&Ye("QueryEngine","SDK will not create cache indexes for query:",Ko(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Re.resolve()):(Wo()<=At.DEBUG&&Ye("QueryEngine","Query:",Ko(r),"scans",n.documentReadCount,"local documents and returns",o,"documents as results."),n.documentReadCount>this.gs*o?(Wo()<=At.DEBUG&&Ye("QueryEngine","The SDK decides to create cache indexes for query:",Ko(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,un(r))):Re.resolve())}ys(e,r){if(sh(r))return Re.resolve(null);let n=un(r);return this.indexManager.getIndexType(e,n).next(o=>o===0?null:(r.limit!==null&&o===1&&(r=dc(r,null,"F"),n=un(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const a=xt(...i);return this.ps.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,n).next(d=>{const h=this.Ds(r,c);return this.Cs(r,h,a,d.readTime)?this.ys(e,dc(r,null,"F")):this.vs(e,h,r,d)}))})))}ws(e,r,n,o){return sh(r)||o.isEqual(ht.min())?Re.resolve(null):this.ps.getDocuments(e,n).next(i=>{const a=this.Ds(r,i);return this.Cs(r,a,n,o)?Re.resolve(null):(Wo()<=At.DEBUG&&Ye("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Ko(r)),this.vs(e,a,r,oS(o,rs)).next(c=>c))})}Ds(e,r){let n=new ur(gy(e));return r.forEach((o,i)=>{Ya(e,i)&&(n=n.add(i))}),n}Cs(e,r,n,o){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(o)>0)}Ss(e,r,n){return Wo()<=At.DEBUG&&Ye("QueryEngine","Using full collection scan to execute query:",Ko(r)),this.ps.getDocumentsMatchingQuery(e,r,eo.min(),n)}vs(e,r,n,o){return this.ps.getDocumentsMatchingQuery(e,n,o).next(i=>(r.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const au="LocalStore",O1=3e8;class V1{constructor(e,r,n,o){this.persistence=e,this.Fs=r,this.serializer=o,this.Ms=new Zt(It),this.xs=new Do(i=>Jc(i),Xc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new I1(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function B1(t,e,r,n){return new V1(t,e,r,n)}async function Fy(t,e){const r=mt(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let o;return r.mutationQueue.getAllMutationBatches(n).next(i=>(o=i,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(i=>{const a=[],c=[];let d=xt();for(const h of o){a.push(h.batchId);for(const m of h.mutations)d=d.add(m.key)}for(const h of i){c.push(h.batchId);for(const m of h.mutations)d=d.add(m.key)}return r.localDocuments.getDocuments(n,d).next(h=>({Ls:h,removedBatchIds:a,addedBatchIds:c}))})})}function F1(t,e){const r=mt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const o=e.batch.keys(),i=r.Ns.newChangeBuffer({trackRemovals:!0});return function(c,d,h,m){const g=h.batch,_=g.keys();let A=Re.resolve();return _.forEach(L=>{A=A.next(()=>m.getEntry(d,L)).next(M=>{const $=h.docVersions.get(L);jt($!==null,48541),M.version.compareTo($)<0&&(g.applyToRemoteDocument(M,h),M.isValidDocument()&&(M.setReadTime(h.commitVersion),m.addEntry(M)))})}),A.next(()=>c.mutationQueue.removeMutationBatch(d,g))}(r,n,e,i).next(()=>i.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,o,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(c){let d=xt();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(d=d.add(c.batch.mutations[h].key));return d}(e))).next(()=>r.localDocuments.getDocuments(n,o))})}function Uy(t){const e=mt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function U1(t,e){const r=mt(t),n=e.snapshotVersion;let o=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=r.Ns.newChangeBuffer({trackRemovals:!0});o=r.Ms;const c=[];e.targetChanges.forEach((m,g)=>{const _=o.get(g);if(!_)return;c.push(r.Pi.removeMatchingKeys(i,m.removedDocuments,g).next(()=>r.Pi.addMatchingKeys(i,m.addedDocuments,g)));let A=_.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(g)!==null?A=A.withResumeToken(vr.EMPTY_BYTE_STRING,ht.min()).withLastLimboFreeSnapshotVersion(ht.min()):m.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(m.resumeToken,n)),o=o.insert(g,A),function(M,$,T){return M.resumeToken.approximateByteSize()===0||$.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=O1?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(_,A,m)&&c.push(r.Pi.updateTargetData(i,A))});let d=Dn(),h=xt();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&c.push(r.persistence.referenceDelegate.updateLimboDocument(i,m))}),c.push(j1(i,a,e.documentUpdates).next(m=>{d=m.ks,h=m.qs})),!n.isEqual(ht.min())){const m=r.Pi.getLastRemoteSnapshotVersion(i).next(g=>r.Pi.setTargetsMetadata(i,i.currentSequenceNumber,n));c.push(m)}return Re.waitFor(c).next(()=>a.apply(i)).next(()=>r.localDocuments.getLocalViewOfDocuments(i,d,h)).next(()=>d)}).then(i=>(r.Ms=o,i))}function j1(t,e,r){let n=xt(),o=xt();return r.forEach(i=>n=n.add(i)),e.getEntries(t,n).next(i=>{let a=Dn();return r.forEach((c,d)=>{const h=i.get(c);d.isFoundDocument()!==h.isFoundDocument()&&(o=o.add(c)),d.isNoDocument()&&d.version.isEqual(ht.min())?(e.removeEntry(c,d.readTime),a=a.insert(c,d)):!h.isValidDocument()||d.version.compareTo(h.version)>0||d.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(d),a=a.insert(c,d)):Ye(au,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",d.version)}),{ks:a,qs:o}})}function z1(t,e){const r=mt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Wc),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function q1(t,e){const r=mt(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let o;return r.Pi.getTargetData(n,e).next(i=>i?(o=i,Re.resolve(o)):r.Pi.allocateTargetId(n).next(a=>(o=new Yn(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,o).next(()=>o))))}).then(n=>{const o=r.Ms.get(n.targetId);return(o===null||n.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function gc(t,e,r){const n=mt(t),o=n.Ms.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,a=>n.persistence.referenceDelegate.removeTarget(a,o))}catch(a){if(!vi(a))throw a;Ye(au,`Failed to update sequence numbers for target ${e}: ${a}`)}n.Ms=n.Ms.remove(e),n.xs.delete(o.target)}function bh(t,e,r){const n=mt(t);let o=ht.min(),i=xt();return n.persistence.runTransaction("Execute query","readwrite",a=>function(d,h,m){const g=mt(d),_=g.xs.get(m);return _!==void 0?Re.resolve(g.Ms.get(_)):g.Pi.getTargetData(h,m)}(n,a,un(e)).next(c=>{if(c)return o=c.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(a,c.targetId).next(d=>{i=d})}).next(()=>n.Fs.getDocumentsMatchingQuery(a,e,r?o:ht.min(),r?i:xt())).next(c=>(G1(n,$S(e),c),{documents:c,Qs:i})))}function G1(t,e,r){let n=t.Os.get(e)||ht.min();r.forEach((o,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),t.Os.set(e,n)}class _h{constructor(){this.activeTargetIds=MS()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class H1{constructor(){this.Mo=new _h,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new _h,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y1{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sh="ConnectivityMonitor";class Ph{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ye(Sh,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ye(Sh,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bs=null;function pc(){return Bs===null?Bs=function(){return 268435456+Math.round(2147483648*Math.random())}():Bs++,"0x"+Bs.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pl="RestConnection",W1={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class K1{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${o}`,this.Wo=this.databaseId.database===Aa?`project_id=${n}`:`project_id=${n}&database_id=${o}`}Go(e,r,n,o,i){const a=pc(),c=this.zo(e,r.toUriEncodedString());Ye(Pl,`Sending RPC '${e}' ${a}:`,c,n);const d={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(d,o,i);const{host:h}=new URL(c),m=mi(h);return this.Jo(e,c,d,n,m).then(g=>(Ye(Pl,`Received RPC '${e}' ${a}: `,g),g),g=>{throw si(Pl,`RPC '${e}' ${a} failed with error: `,g,"url: ",c,"request:",n),g})}Ho(e,r,n,o,i,a){return this.Go(e,r,n,o,i)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+gi}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,i)=>e[i]=o),n&&n.headers.forEach((o,i)=>e[i]=o)}zo(e,r){const n=W1[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q1{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wr="WebChannelConnection";class J1 extends K1{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,o,i){const a=pc();return new Promise((c,d)=>{const h=new zf;h.setWithCredentials(!0),h.listenOnce(qf.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case na.NO_ERROR:const g=h.getResponseJson();Ye(wr,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(g)),c(g);break;case na.TIMEOUT:Ye(wr,`RPC '${e}' ${a} timed out`),d(new qe(Te.DEADLINE_EXCEEDED,"Request time out"));break;case na.HTTP_ERROR:const _=h.getStatus();if(Ye(wr,`RPC '${e}' ${a} failed with status:`,_,"response text:",h.getResponseText()),_>0){let A=h.getResponseJson();Array.isArray(A)&&(A=A[0]);const L=A?.error;if(L&&L.status&&L.message){const M=function(T){const ee=T.toLowerCase().replace(/_/g,"-");return Object.values(Te).indexOf(ee)>=0?ee:Te.UNKNOWN}(L.status);d(new qe(M,L.message))}else d(new qe(Te.UNKNOWN,"Server responded with status "+h.getStatus()))}else d(new qe(Te.UNAVAILABLE,"Connection failed."));break;default:it(9055,{l_:e,streamId:a,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{Ye(wr,`RPC '${e}' ${a} completed.`)}});const m=JSON.stringify(o);Ye(wr,`RPC '${e}' ${a} sending request:`,o),h.send(r,"POST",m,n,15)})}T_(e,r,n){const o=pc(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Yf(),c=Hf(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(d.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(d.useFetchStreams=!0),this.jo(d.initMessageHeaders,r,n),d.encodeInitMessageHeaders=!0;const m=i.join("");Ye(wr,`Creating RPC '${e}' stream ${o}: ${m}`,d);const g=a.createWebChannel(m,d);this.I_(g);let _=!1,A=!1;const L=new Q1({Yo:$=>{A?Ye(wr,`Not sending because RPC '${e}' stream ${o} is closed:`,$):(_||(Ye(wr,`Opening RPC '${e}' stream ${o} transport.`),g.open(),_=!0),Ye(wr,`RPC '${e}' stream ${o} sending:`,$),g.send($))},Zo:()=>g.close()}),M=($,T,ee)=>{$.listen(T,ce=>{try{ee(ce)}catch(Z){setTimeout(()=>{throw Z},0)}})};return M(g,Mi.EventType.OPEN,()=>{A||(Ye(wr,`RPC '${e}' stream ${o} transport opened.`),L.o_())}),M(g,Mi.EventType.CLOSE,()=>{A||(A=!0,Ye(wr,`RPC '${e}' stream ${o} transport closed`),L.a_(),this.E_(g))}),M(g,Mi.EventType.ERROR,$=>{A||(A=!0,si(wr,`RPC '${e}' stream ${o} transport errored. Name:`,$.name,"Message:",$.message),L.a_(new qe(Te.UNAVAILABLE,"The operation could not be completed")))}),M(g,Mi.EventType.MESSAGE,$=>{if(!A){const T=$.data[0];jt(!!T,16349);const ee=T,ce=ee?.error||ee[0]?.error;if(ce){Ye(wr,`RPC '${e}' stream ${o} received error:`,ce);const Z=ce.status;let ge=function(S){const p=sr[S];if(p!==void 0)return Ey(p)}(Z),ne=ce.message;ge===void 0&&(ge=Te.INTERNAL,ne="Unknown error status: "+Z+" with message "+ce.message),A=!0,L.a_(new qe(ge,ne)),g.close()}else Ye(wr,`RPC '${e}' stream ${o} received:`,T),L.u_(T)}}),M(c,Gf.STAT_EVENT,$=>{$.stat===oc.PROXY?Ye(wr,`RPC '${e}' stream ${o} detected buffering proxy`):$.stat===oc.NOPROXY&&Ye(wr,`RPC '${e}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{L.__()},0),L}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function wl(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ja(t){return new t1(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jy{constructor(e,r,n=1e3,o=1.5,i=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=o,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),o=Math.max(0,r-n);o>0&&Ye("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,o,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wh="PersistentStream";class zy{constructor(e,r,n,o,i,a,c,d){this.Mi=e,this.S_=n,this.b_=o,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=d,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new jy(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===Te.RESOURCE_EXHAUSTED?(kn(r.toString()),kn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===Te.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,o])=>{this.D_===r&&this.G_(n,o)},n=>{e(()=>{const o=new qe(Te.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(o)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(o=>{n(()=>this.z_(o))}),this.stream.onMessage(o=>{n(()=>++this.F_==1?this.J_(o):this.onNext(o))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Ye(wh,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(Ye(wh,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class X1 extends zy{constructor(e,r,n,o,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,o,a),this.serializer=i}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=o1(this.serializer,e),n=function(i){if(!("targetChange"in i))return ht.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?ht.min():a.readTime?hn(a.readTime):ht.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=yc(this.serializer),r.addTarget=function(i,a){let c;const d=a.target;if(c=cc(d)?{documents:a1(i,d)}:{query:l1(i,d).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=ky(i,a.resumeToken);const h=hc(i,a.expectedCount);h!==null&&(c.expectedCount=h)}else if(a.snapshotVersion.compareTo(ht.min())>0){c.readTime=$a(i,a.snapshotVersion.toTimestamp());const h=hc(i,a.expectedCount);h!==null&&(c.expectedCount=h)}return c}(this.serializer,e);const n=u1(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=yc(this.serializer),r.removeTarget=e,this.q_(r)}}class Z1 extends zy{constructor(e,r,n,o,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,o,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return jt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,jt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){jt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=s1(e.writeResults,e.commitTime),n=hn(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=yc(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>i1(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eP{}class tP extends eP{constructor(e,r,n,o){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new qe(Te.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Go(e,mc(r,n),o,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===Te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new qe(Te.UNKNOWN,i.toString())})}Ho(e,r,n,o,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Ho(e,mc(r,n),o,a,c,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new qe(Te.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class rP{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(kn(r),this.aa=!1):Ye("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $o="RemoteStore";class nP{constructor(e,r,n,o,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(a=>{n.enqueueAndForget(async()=>{No(this)&&(Ye($o,"Restarting streams for network reachability change."),await async function(d){const h=mt(d);h.Ea.add(4),await bs(h),h.Ra.set("Unknown"),h.Ea.delete(4),await Xa(h)}(this))})}),this.Ra=new rP(n,o)}}async function Xa(t){if(No(t))for(const e of t.da)await e(!0)}async function bs(t){for(const e of t.da)await e(!1)}function qy(t,e){const r=mt(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),du(r)?uu(r):_i(r).O_()&&cu(r,e))}function lu(t,e){const r=mt(t),n=_i(r);r.Ia.delete(e),n.O_()&&Gy(r,e),r.Ia.size===0&&(n.O_()?n.L_():No(r)&&r.Ra.set("Unknown"))}function cu(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ht.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}_i(t).Y_(e)}function Gy(t,e){t.Va.Ue(e),_i(t).Z_(e)}function uu(t){t.Va=new JS({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),_i(t).start(),t.Ra.ua()}function du(t){return No(t)&&!_i(t).x_()&&t.Ia.size>0}function No(t){return mt(t).Ea.size===0}function Hy(t){t.Va=void 0}async function oP(t){t.Ra.set("Online")}async function iP(t){t.Ia.forEach((e,r)=>{cu(t,e)})}async function sP(t,e){Hy(t),du(t)?(t.Ra.ha(e),uu(t)):t.Ra.set("Unknown")}async function aP(t,e,r){if(t.Ra.set("Online"),e instanceof $y&&e.state===2&&e.cause)try{await async function(o,i){const a=i.cause;for(const c of i.targetIds)o.Ia.has(c)&&(await o.remoteSyncer.rejectListen(c,a),o.Ia.delete(c),o.Va.removeTarget(c))}(t,e)}catch(n){Ye($o,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Ra(t,n)}else if(e instanceof aa?t.Va.Ze(e):e instanceof Ty?t.Va.st(e):t.Va.tt(e),!r.isEqual(ht.min()))try{const n=await Uy(t.localStore);r.compareTo(n)>=0&&await function(i,a){const c=i.Va.Tt(a);return c.targetChanges.forEach((d,h)=>{if(d.resumeToken.approximateByteSize()>0){const m=i.Ia.get(h);m&&i.Ia.set(h,m.withResumeToken(d.resumeToken,a))}}),c.targetMismatches.forEach((d,h)=>{const m=i.Ia.get(d);if(!m)return;i.Ia.set(d,m.withResumeToken(vr.EMPTY_BYTE_STRING,m.snapshotVersion)),Gy(i,d);const g=new Yn(m.target,d,h,m.sequenceNumber);cu(i,g)}),i.remoteSyncer.applyRemoteEvent(c)}(t,r)}catch(n){Ye($o,"Failed to raise snapshot:",n),await Ra(t,n)}}async function Ra(t,e,r){if(!vi(e))throw e;t.Ea.add(1),await bs(t),t.Ra.set("Offline"),r||(r=()=>Uy(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ye($o,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await Xa(t)})}function Yy(t,e){return e().catch(r=>Ra(t,r,e))}async function Za(t){const e=mt(t),r=oo(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Wc;for(;lP(e);)try{const o=await z1(e.localStore,n);if(o===null){e.Ta.length===0&&r.L_();break}n=o.batchId,cP(e,o)}catch(o){await Ra(e,o)}Wy(e)&&Ky(e)}function lP(t){return No(t)&&t.Ta.length<10}function cP(t,e){t.Ta.push(e);const r=oo(t);r.O_()&&r.X_&&r.ea(e.mutations)}function Wy(t){return No(t)&&!oo(t).x_()&&t.Ta.length>0}function Ky(t){oo(t).start()}async function uP(t){oo(t).ra()}async function dP(t){const e=oo(t);for(const r of t.Ta)e.ea(r.mutations)}async function hP(t,e,r){const n=t.Ta.shift(),o=tu.from(n,e,r);await Yy(t,()=>t.remoteSyncer.applySuccessfulWrite(o)),await Za(t)}async function mP(t,e){e&&oo(t).X_&&await async function(n,o){if(function(a){return WS(a)&&a!==Te.ABORTED}(o.code)){const i=n.Ta.shift();oo(n).B_(),await Yy(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,o)),await Za(n)}}(t,e),Wy(t)&&Ky(t)}async function Ch(t,e){const r=mt(t);r.asyncQueue.verifyOperationInProgress(),Ye($o,"RemoteStore received new credentials");const n=No(r);r.Ea.add(3),await bs(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await Xa(r)}async function fP(t,e){const r=mt(t);e?(r.Ea.delete(2),await Xa(r)):e||(r.Ea.add(2),await bs(r),r.Ra.set("Unknown"))}function _i(t){return t.ma||(t.ma=function(r,n,o){const i=mt(r);return i.sa(),new X1(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,o)}(t.datastore,t.asyncQueue,{Xo:oP.bind(null,t),t_:iP.bind(null,t),r_:sP.bind(null,t),H_:aP.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),du(t)?uu(t):t.Ra.set("Unknown")):(await t.ma.stop(),Hy(t))})),t.ma}function oo(t){return t.fa||(t.fa=function(r,n,o){const i=mt(r);return i.sa(),new Z1(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,o)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:uP.bind(null,t),r_:mP.bind(null,t),ta:dP.bind(null,t),na:hP.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Za(t)):(await t.fa.stop(),t.Ta.length>0&&(Ye($o,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{constructor(e,r,n,o,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=o,this.removalCallback=i,this.deferred=new En,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,o,i){const a=Date.now()+n,c=new hu(e,r,a,o,i);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new qe(Te.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function mu(t,e){if(kn("AsyncQueue",`${e}: ${t}`),vi(t))return new qe(Te.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{static emptySet(e){return new ri(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||tt.comparator(r.key,n.key):(r,n)=>tt.comparator(r.key,n.key),this.keyedMap=Oi(),this.sortedSet=new Zt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof ri)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const o=r.getNext().key,i=n.getNext().key;if(!o.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new ri;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah{constructor(){this.ga=new Zt(tt.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):it(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class di{constructor(e,r,n,o,i,a,c,d,h){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=o,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=d,this.hasCachedResults=h}static fromInitialDocuments(e,r,n,o,i){const a=[];return r.forEach(c=>{a.push({type:0,doc:c})}),new di(e,r,ri.emptySet(r),a,n,o,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ha(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let o=0;o<r.length;o++)if(r[o].type!==n[o].type||!r[o].doc.isEqual(n[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yP{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class gP{constructor(){this.queries=Ih(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const o=mt(r),i=o.queries;o.queries=Ih(),i.forEach((a,c)=>{for(const d of c.Sa)d.onError(n)})})(this,new qe(Te.ABORTED,"Firestore shutting down"))}}function Ih(){return new Do(t=>yy(t),Ha)}async function Qy(t,e){const r=mt(t);let n=3;const o=e.query;let i=r.queries.get(o);i?!i.ba()&&e.Da()&&(n=2):(i=new yP,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await r.onListen(o,!0);break;case 1:i.wa=await r.onListen(o,!1);break;case 2:await r.onFirstRemoteStoreListen(o)}}catch(a){const c=mu(a,`Initialization of query '${Ko(e.query)}' failed`);return void e.onError(c)}r.queries.set(o,i),i.Sa.push(e),e.va(r.onlineState),i.wa&&e.Fa(i.wa)&&fu(r)}async function Jy(t,e){const r=mt(t),n=e.query;let o=3;const i=r.queries.get(n);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?o=e.Da()?0:1:!i.ba()&&e.Da()&&(o=2))}switch(o){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function pP(t,e){const r=mt(t);let n=!1;for(const o of e){const i=o.query,a=r.queries.get(i);if(a){for(const c of a.Sa)c.Fa(o)&&(n=!0);a.wa=o}}n&&fu(r)}function vP(t,e,r){const n=mt(t),o=n.queries.get(e);if(o)for(const i of o.Sa)i.onError(r);n.queries.delete(e)}function fu(t){t.Ca.forEach(e=>{e.next()})}var vc,xh;(xh=vc||(vc={})).Ma="default",xh.Cache="cache";class Xy{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const o of e.docChanges)o.type!==3&&n.push(o);e=new di(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=di.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==vc.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zy{constructor(e){this.key=e}}class eg{constructor(e){this.key=e}}class bP{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=xt(),this.mutatedKeys=xt(),this.eu=gy(e),this.tu=new ri(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new Ah,o=r?r.tu:this.tu;let i=r?r.mutatedKeys:this.mutatedKeys,a=o,c=!1;const d=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,h=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal((m,g)=>{const _=o.get(m),A=Ya(this.query,g)?g:null,L=!!_&&this.mutatedKeys.has(_.key),M=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let $=!1;_&&A?_.data.isEqual(A.data)?L!==M&&(n.track({type:3,doc:A}),$=!0):this.su(_,A)||(n.track({type:2,doc:A}),$=!0,(d&&this.eu(A,d)>0||h&&this.eu(A,h)<0)&&(c=!0)):!_&&A?(n.track({type:0,doc:A}),$=!0):_&&!A&&(n.track({type:1,doc:_}),$=!0,(d||h)&&(c=!0)),$&&(A?(a=a.add(A),i=M?i.add(m):i.delete(m)):(a=a.delete(m),i=i.delete(m)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const m=this.query.limitType==="F"?a.last():a.first();a=a.delete(m.key),i=i.delete(m.key),n.track({type:1,doc:m})}return{tu:a,iu:n,Cs:c,mutatedKeys:i}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,o){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((m,g)=>function(A,L){const M=$=>{switch($){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return it(20277,{Rt:$})}};return M(A)-M(L)}(m.type,g.type)||this.eu(m.doc,g.doc)),this.ou(n),o=o??!1;const c=r&&!o?this._u():[],d=this.Xa.size===0&&this.current&&!o?1:0,h=d!==this.Za;return this.Za=d,a.length!==0||h?{snapshot:new di(this.query,e.tu,i,a,e.mutatedKeys,d===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Ah,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=xt(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new eg(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new Zy(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=xt();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return di.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const yu="SyncEngine";class _P{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class SP{constructor(e){this.key=e,this.hu=!1}}class PP{constructor(e,r,n,o,i,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=o,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Do(c=>yy(c),Ha),this.Iu=new Map,this.Eu=new Set,this.du=new Zt(tt.comparator),this.Au=new Map,this.Ru=new ou,this.Vu={},this.mu=new Map,this.fu=ui.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function wP(t,e,r=!0){const n=sg(t);let o;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),o=i.view.lu()):o=await tg(n,e,r,!0),o}async function CP(t,e){const r=sg(t);await tg(r,e,!0,!1)}async function tg(t,e,r,n){const o=await q1(t.localStore,un(e)),i=o.targetId,a=t.sharedClientState.addLocalQueryTarget(i,r);let c;return n&&(c=await AP(t,e,i,a==="current",o.resumeToken)),t.isPrimaryClient&&r&&qy(t.remoteStore,o),c}async function AP(t,e,r,n,o){t.pu=(g,_,A)=>async function(M,$,T,ee){let ce=$.view.ru(T);ce.Cs&&(ce=await bh(M.localStore,$.query,!1).then(({documents:w})=>$.view.ru(w,ce)));const Z=ee&&ee.targetChanges.get($.targetId),ge=ee&&ee.targetMismatches.get($.targetId)!=null,ne=$.view.applyChanges(ce,M.isPrimaryClient,Z,ge);return Th(M,$.targetId,ne.au),ne.snapshot}(t,g,_,A);const i=await bh(t.localStore,e,!0),a=new bP(e,i.Qs),c=a.ru(i.documents),d=vs.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",o),h=a.applyChanges(c,t.isPrimaryClient,d);Th(t,r,h.au);const m=new _P(e,r,a);return t.Tu.set(e,m),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),h.snapshot}async function IP(t,e,r){const n=mt(t),o=n.Tu.get(e),i=n.Iu.get(o.targetId);if(i.length>1)return n.Iu.set(o.targetId,i.filter(a=>!Ha(a,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(o.targetId),n.sharedClientState.isActiveQueryTarget(o.targetId)||await gc(n.localStore,o.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(o.targetId),r&&lu(n.remoteStore,o.targetId),bc(n,o.targetId)}).catch(pi)):(bc(n,o.targetId),await gc(n.localStore,o.targetId,!0))}async function xP(t,e){const r=mt(t),n=r.Tu.get(e),o=r.Iu.get(n.targetId);r.isPrimaryClient&&o.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),lu(r.remoteStore,n.targetId))}async function EP(t,e,r){const n=LP(t);try{const o=await function(a,c){const d=mt(a),h=Jt.now(),m=c.reduce((A,L)=>A.add(L.key),xt());let g,_;return d.persistence.runTransaction("Locally write mutations","readwrite",A=>{let L=Dn(),M=xt();return d.Ns.getEntries(A,m).next($=>{L=$,L.forEach((T,ee)=>{ee.isValidDocument()||(M=M.add(T))})}).next(()=>d.localDocuments.getOverlayedDocuments(A,L)).next($=>{g=$;const T=[];for(const ee of c){const ce=zS(ee,g.get(ee.key).overlayedDocument);ce!=null&&T.push(new co(ee.key,ce,ay(ce.value.mapValue),dn.exists(!0)))}return d.mutationQueue.addMutationBatch(A,h,T,c)}).next($=>{_=$;const T=$.applyToLocalDocumentSet(g,M);return d.documentOverlayCache.saveOverlays(A,$.batchId,T)})}).then(()=>({batchId:_.batchId,changes:vy(g)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(o.batchId),function(a,c,d){let h=a.Vu[a.currentUser.toKey()];h||(h=new Zt(It)),h=h.insert(c,d),a.Vu[a.currentUser.toKey()]=h}(n,o.batchId,r),await _s(n,o.changes),await Za(n.remoteStore)}catch(o){const i=mu(o,"Failed to persist write");r.reject(i)}}async function rg(t,e){const r=mt(t);try{const n=await U1(r.localStore,e);e.targetChanges.forEach((o,i)=>{const a=r.Au.get(i);a&&(jt(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?a.hu=!0:o.modifiedDocuments.size>0?jt(a.hu,14607):o.removedDocuments.size>0&&(jt(a.hu,42227),a.hu=!1))}),await _s(r,n,e)}catch(n){await pi(n)}}function Eh(t,e,r){const n=mt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const o=[];n.Tu.forEach((i,a)=>{const c=a.view.va(e);c.snapshot&&o.push(c.snapshot)}),function(a,c){const d=mt(a);d.onlineState=c;let h=!1;d.queries.forEach((m,g)=>{for(const _ of g.Sa)_.va(c)&&(h=!0)}),h&&fu(d)}(n.eventManager,e),o.length&&n.Pu.H_(o),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function TP(t,e,r){const n=mt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const o=n.Au.get(e),i=o&&o.key;if(i){let a=new Zt(tt.comparator);a=a.insert(i,Ir.newNoDocument(i,ht.min()));const c=xt().add(i),d=new Qa(ht.min(),new Map,new Zt(It),a,c);await rg(n,d),n.du=n.du.remove(i),n.Au.delete(e),gu(n)}else await gc(n.localStore,e,!1).then(()=>bc(n,e,r)).catch(pi)}async function $P(t,e){const r=mt(t),n=e.batch.batchId;try{const o=await F1(r.localStore,e);og(r,n,null),ng(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await _s(r,o)}catch(o){await pi(o)}}async function kP(t,e,r){const n=mt(t);try{const o=await function(a,c){const d=mt(a);return d.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let m;return d.mutationQueue.lookupMutationBatch(h,c).next(g=>(jt(g!==null,37113),m=g.keys(),d.mutationQueue.removeMutationBatch(h,g))).next(()=>d.mutationQueue.performConsistencyCheck(h)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(h,m,c)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,m)).next(()=>d.localDocuments.getDocuments(h,m))})}(n.localStore,e);og(n,e,r),ng(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await _s(n,o)}catch(o){await pi(o)}}function ng(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function og(t,e,r){const n=mt(t);let o=n.Vu[n.currentUser.toKey()];if(o){const i=o.get(e);i&&(r?i.reject(r):i.resolve(),o=o.remove(e)),n.Vu[n.currentUser.toKey()]=o}}function bc(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||ig(t,n)})}function ig(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(lu(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),gu(t))}function Th(t,e,r){for(const n of r)n instanceof Zy?(t.Ru.addReference(n.key,e),RP(t,n)):n instanceof eg?(Ye(yu,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||ig(t,n.key)):it(19791,{wu:n})}function RP(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Ye(yu,"New document in limbo: "+r),t.Eu.add(n),gu(t))}function gu(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new tt(Kt.fromString(e)),n=t.fu.next();t.Au.set(n,new SP(r)),t.du=t.du.insert(r,n),qy(t.remoteStore,new Yn(un(Zc(r.path)),n,"TargetPurposeLimboResolution",za.ce))}}async function _s(t,e,r){const n=mt(t),o=[],i=[],a=[];n.Tu.isEmpty()||(n.Tu.forEach((c,d)=>{a.push(n.pu(d,e,r).then(h=>{if((h||r)&&n.isPrimaryClient){const m=h?!h.fromCache:r?.targetChanges.get(d.targetId)?.current;n.sharedClientState.updateQueryState(d.targetId,m?"current":"not-current")}if(h){o.push(h);const m=su.As(d.targetId,h);i.push(m)}}))}),await Promise.all(a),n.Pu.H_(o),await async function(d,h){const m=mt(d);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>Re.forEach(h,_=>Re.forEach(_.Es,A=>m.persistence.referenceDelegate.addReference(g,_.targetId,A)).next(()=>Re.forEach(_.ds,A=>m.persistence.referenceDelegate.removeReference(g,_.targetId,A)))))}catch(g){if(!vi(g))throw g;Ye(au,"Failed to update sequence numbers: "+g)}for(const g of h){const _=g.targetId;if(!g.fromCache){const A=m.Ms.get(_),L=A.snapshotVersion,M=A.withLastLimboFreeSnapshotVersion(L);m.Ms=m.Ms.insert(_,M)}}}(n.localStore,i))}async function DP(t,e){const r=mt(t);if(!r.currentUser.isEqual(e)){Ye(yu,"User change. New user:",e.toKey());const n=await Fy(r.localStore,e);r.currentUser=e,function(i,a){i.mu.forEach(c=>{c.forEach(d=>{d.reject(new qe(Te.CANCELLED,a))})}),i.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await _s(r,n.Ls)}}function NP(t,e){const r=mt(t),n=r.Au.get(e);if(n&&n.hu)return xt().add(n.key);{let o=xt();const i=r.Iu.get(e);if(!i)return o;for(const a of i){const c=r.Tu.get(a);o=o.unionWith(c.view.nu)}return o}}function sg(t){const e=mt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=rg.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=NP.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=TP.bind(null,e),e.Pu.H_=pP.bind(null,e.eventManager),e.Pu.yu=vP.bind(null,e.eventManager),e}function LP(t){const e=mt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=$P.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=kP.bind(null,e),e}class Da{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ja(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return B1(this.persistence,new M1,e.initialUser,this.serializer)}Cu(e){return new By(iu.mi,this.serializer)}Du(e){return new H1}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Da.provider={build:()=>new Da};class MP extends Da{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){jt(this.persistence.referenceDelegate instanceof ka,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new S1(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?Dr.withCacheSize(this.cacheSizeBytes):Dr.DEFAULT;return new By(n=>ka.mi(n,r),this.serializer)}}class _c{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Eh(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=DP.bind(null,this.syncEngine),await fP(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new gP}()}createDatastore(e){const r=Ja(e.databaseInfo.databaseId),n=function(i){return new J1(i)}(e.databaseInfo);return function(i,a,c,d){return new tP(i,a,c,d)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,o,i,a,c){return new nP(n,o,i,a,c)}(this.localStore,this.datastore,e.asyncQueue,r=>Eh(this.syncEngine,r,0),function(){return Ph.v()?new Ph:new Y1}())}createSyncEngine(e,r){return function(o,i,a,c,d,h,m){const g=new PP(o,i,a,c,d,h);return m&&(g.gu=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await async function(r){const n=mt(r);Ye($o,"RemoteStore shutting down."),n.Ea.add(5),await bs(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}_c.provider={build:()=>new _c};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ag{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):kn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const io="FirestoreClient";class OP{constructor(e,r,n,o,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=o,this.user=Ar.UNAUTHENTICATED,this.clientId=Yc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async a=>{Ye(io,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Ye(io,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new En;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=mu(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Cl(t,e){t.asyncQueue.verifyOperationInProgress(),Ye(io,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async o=>{n.isEqual(o)||(await Fy(e.localStore,o),n=o)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function $h(t,e){t.asyncQueue.verifyOperationInProgress();const r=await VP(t);Ye(io,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>Ch(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,o)=>Ch(e.remoteStore,o)),t._onlineComponents=e}async function VP(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ye(io,"Using user provided OfflineComponentProvider");try{await Cl(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(o){return o.name==="FirebaseError"?o.code===Te.FAILED_PRECONDITION||o.code===Te.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11}(r))throw r;si("Error using user provided cache. Falling back to memory cache: "+r),await Cl(t,new Da)}}else Ye(io,"Using default OfflineComponentProvider"),await Cl(t,new MP(void 0));return t._offlineComponents}async function lg(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ye(io,"Using user provided OnlineComponentProvider"),await $h(t,t._uninitializedComponentsProvider._online)):(Ye(io,"Using default OnlineComponentProvider"),await $h(t,new _c))),t._onlineComponents}function BP(t){return lg(t).then(e=>e.syncEngine)}async function cg(t){const e=await lg(t),r=e.eventManager;return r.onListen=wP.bind(null,e.syncEngine),r.onUnlisten=IP.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=CP.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=xP.bind(null,e.syncEngine),r}function FP(t,e,r={}){const n=new En;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,c,d,h){const m=new ag({next:_=>{m.Nu(),a.enqueueAndForget(()=>Jy(i,g));const A=_.docs.has(c);!A&&_.fromCache?h.reject(new qe(Te.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&_.fromCache&&d&&d.source==="server"?h.reject(new qe(Te.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(_)},error:_=>h.reject(_)}),g=new Xy(Zc(c.path),m,{includeMetadataChanges:!0,qa:!0});return Qy(i,g)}(await cg(t),t.asyncQueue,e,r,n)),n.promise}function UP(t,e,r={}){const n=new En;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,c,d,h){const m=new ag({next:_=>{m.Nu(),a.enqueueAndForget(()=>Jy(i,g)),_.fromCache&&d.source==="server"?h.reject(new qe(Te.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(_)},error:_=>h.reject(_)}),g=new Xy(c,m,{includeMetadataChanges:!0,qa:!0});return Qy(i,g)}(await cg(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ug(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kh=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dg="firestore.googleapis.com",Rh=!0;class Dh{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new qe(Te.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=dg,this.ssl=Rh}else this.host=e.host,this.ssl=e.ssl??Rh;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Vy;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<b1)throw new qe(Te.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}nS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ug(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new qe(Te.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new qe(Te.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new qe(Te.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,o){return n.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class el{constructor(e,r,n,o){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Dh({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new qe(Te.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new qe(Te.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Dh(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new Y_;switch(n.type){case"firstParty":return new J_(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new qe(Te.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=kh.get(r);n&&(Ye("ComponentProvider","Removing Datastore"),kh.delete(r),n.terminate())}(this),Promise.resolve()}}function jP(t,e,r,n={}){t=Rn(t,el);const o=mi(e),i=t._getSettings(),a={...i,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${r}`;o&&(Zm(`https://${c}`),ef("Firestore",!0)),i.host!==dg&&i.host!==c&&si("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d={...i,host:c,ssl:o,emulatorOptions:n};if(!Io(d,a)&&(t._setSettings(d),n.mockUserToken)){let h,m;if(typeof n.mockUserToken=="string")h=n.mockUserToken,m=Ar.MOCK_USER;else{h=pv(n.mockUserToken,t._app?.options.projectId);const g=n.mockUserToken.sub||n.mockUserToken.user_id;if(!g)throw new qe(Te.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new Ar(g)}t._authCredentials=new W_(new Kf(h,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Lo(this.firestore,e,this._query)}}class nr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Zn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new nr(this.firestore,e,this._key)}toJSON(){return{type:nr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(gs(r,nr._jsonSchema))return new nr(e,n||null,new tt(Kt.fromString(r.referencePath)))}}nr._jsonSchemaVersion="firestore/documentReference/1.0",nr._jsonSchema={type:lr("string",nr._jsonSchemaVersion),referencePath:lr("string")};class Zn extends Lo{constructor(e,r,n){super(e,r,Zc(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new nr(this.firestore,null,new tt(e))}withConverter(e){return new Zn(this.firestore,e,this._path)}}function zP(t,e,...r){if(t=pr(t),Qf("collection","path",e),t instanceof el){const n=Kt.fromString(e,...r);return Hd(n),new Zn(t,null,n)}{if(!(t instanceof nr||t instanceof Zn))throw new qe(Te.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Kt.fromString(e,...r));return Hd(n),new Zn(t.firestore,null,n)}}function hg(t,e,...r){if(t=pr(t),arguments.length===1&&(e=Yc.newId()),Qf("doc","path",e),t instanceof el){const n=Kt.fromString(e,...r);return Gd(n),new nr(t,null,new tt(n))}{if(!(t instanceof nr||t instanceof Zn))throw new qe(Te.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Kt.fromString(e,...r));return Gd(n),new nr(t.firestore,t instanceof Zn?t.converter:null,new tt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nh="AsyncQueue";class Lh{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new jy(this,"async_queue_retry"),this._c=()=>{const n=wl();n&&Ye(Nh,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=wl();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=wl();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new En;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!vi(e))throw e;Ye(Nh,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,kn("INTERNAL UNHANDLED ERROR: ",Mh(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const o=hu.createAndSchedule(this,e,r,n,i=>this.hc(i));return this.tc.push(o),o}uc(){this.nc&&it(47125,{Pc:Mh(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function Mh(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Ss extends el{constructor(e,r,n,o){super(e,r,n,o),this.type="firestore",this._queue=new Lh,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Lh(e),this._firestoreClient=void 0,await e}}}function qP(t,e){const r=typeof t=="object"?t:of(),n=typeof t=="string"?t:Aa,o=Lc(r,"firestore").getImmediate({identifier:n});if(!o._initialized){const i=yv("firestore");i&&jP(o,...i)}return o}function pu(t){if(t._terminated)throw new qe(Te.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||GP(t),t._firestoreClient}function GP(t){const e=t._freezeSettings(),r=function(o,i,a,c){return new fS(o,i,a,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,ug(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)}(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new OP(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(o){const i=o?._online.build();return{_offline:o?._offline.build(i),_online:i}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new qr(vr.fromBase64String(e))}catch(r){throw new qe(Te.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new qr(vr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:qr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(gs(e,qr._jsonSchema))return qr.fromBase64String(e.bytes)}}qr._jsonSchemaVersion="firestore/bytes/1.0",qr._jsonSchema={type:lr("string",qr._jsonSchemaVersion),bytes:lr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new qe(Te.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new yr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new qe(Te.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new qe(Te.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return It(this._lat,e._lat)||It(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:mn._jsonSchemaVersion}}static fromJSON(e){if(gs(e,mn._jsonSchema))return new mn(e.latitude,e.longitude)}}mn._jsonSchemaVersion="firestore/geoPoint/1.0",mn._jsonSchema={type:lr("string",mn._jsonSchemaVersion),latitude:lr("number"),longitude:lr("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,o){if(n.length!==o.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==o[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:fn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(gs(e,fn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new fn(e.vectorValues);throw new qe(Te.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}fn._jsonSchemaVersion="firestore/vectorValue/1.0",fn._jsonSchema={type:lr("string",fn._jsonSchemaVersion),vectorValues:lr("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HP=/^__.*__$/;class YP{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new co(e,this.data,this.fieldMask,r,this.fieldTransforms):new ps(e,this.data,r,this.fieldTransforms)}}class mg{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new co(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function fg(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw it(40011,{Ac:t})}}class bu{constructor(e,r,n,o,i,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=o,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new bu({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Na(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(fg(this.Ac)&&HP.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class WP{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Ja(e)}Cc(e,r,n,o=!1){return new bu({Ac:e,methodName:r,Dc:n,path:yr.emptyPath(),fc:!1,bc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function _u(t){const e=t._freezeSettings(),r=Ja(t._databaseId);return new WP(t._databaseId,!!e.ignoreUndefinedProperties,r)}function KP(t,e,r,n,o,i={}){const a=t.Cc(i.merge||i.mergeFields?2:0,e,r,o);Su("Data must be an object, but it was:",a,n);const c=yg(n,a);let d,h;if(i.merge)d=new Br(a.fieldMask),h=a.fieldTransforms;else if(i.mergeFields){const m=[];for(const g of i.mergeFields){const _=Sc(e,g,r);if(!a.contains(_))throw new qe(Te.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);pg(m,_)||m.push(_)}d=new Br(m),h=a.fieldTransforms.filter(g=>d.covers(g.field))}else d=null,h=a.fieldTransforms;return new YP(new Nr(c),d,h)}class rl extends vu{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof rl}}function QP(t,e,r,n){const o=t.Cc(1,e,r);Su("Data must be an object, but it was:",o,n);const i=[],a=Nr.empty();lo(n,(d,h)=>{const m=Pu(e,d,r);h=pr(h);const g=o.yc(m);if(h instanceof rl)i.push(m);else{const _=Ps(h,g);_!=null&&(i.push(m),a.set(m,_))}});const c=new Br(i);return new mg(a,c,o.fieldTransforms)}function JP(t,e,r,n,o,i){const a=t.Cc(1,e,r),c=[Sc(e,n,r)],d=[o];if(i.length%2!=0)throw new qe(Te.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<i.length;_+=2)c.push(Sc(e,i[_])),d.push(i[_+1]);const h=[],m=Nr.empty();for(let _=c.length-1;_>=0;--_)if(!pg(h,c[_])){const A=c[_];let L=d[_];L=pr(L);const M=a.yc(A);if(L instanceof rl)h.push(A);else{const $=Ps(L,M);$!=null&&(h.push(A),m.set(A,$))}}const g=new Br(h);return new mg(m,g,a.fieldTransforms)}function XP(t,e,r,n=!1){return Ps(r,t.Cc(n?4:3,e))}function Ps(t,e){if(gg(t=pr(t)))return Su("Unsupported field value:",e,t),yg(t,e);if(t instanceof vu)return function(n,o){if(!fg(o.Ac))throw o.Sc(`${n._methodName}() can only be used with update() and set()`);if(!o.path)throw o.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(o);i&&o.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,o){const i=[];let a=0;for(const c of n){let d=Ps(c,o.wc(a));d==null&&(d={nullValue:"NULL_VALUE"}),i.push(d),a++}return{arrayValue:{values:i}}}(t,e)}return function(n,o){if((n=pr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return OS(o.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=Jt.fromDate(n);return{timestampValue:$a(o.serializer,i)}}if(n instanceof Jt){const i=new Jt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:$a(o.serializer,i)}}if(n instanceof mn)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof qr)return{bytesValue:ky(o.serializer,n._byteString)};if(n instanceof nr){const i=o.databaseId,a=n.firestore._databaseId;if(!a.isEqual(i))throw o.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:nu(n.firestore._databaseId||o.databaseId,n._key.path)}}if(n instanceof fn)return function(a,c){return{mapValue:{fields:{[iy]:{stringValue:sy},[Ia]:{arrayValue:{values:a.toArray().map(h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return eu(c.serializer,h)})}}}}}}(n,o);throw o.Sc(`Unsupported field value: ${ja(n)}`)}(t,e)}function yg(t,e){const r={};return Zf(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):lo(t,(n,o)=>{const i=Ps(o,e.mc(n));i!=null&&(r[n]=i)}),{mapValue:{fields:r}}}function gg(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Jt||t instanceof mn||t instanceof qr||t instanceof nr||t instanceof vu||t instanceof fn)}function Su(t,e,r){if(!gg(r)||!Jf(r)){const n=ja(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function Sc(t,e,r){if((e=pr(e))instanceof tl)return e._internalPath;if(typeof e=="string")return Pu(t,e);throw Na("Field path arguments must be of type string or ",t,!1,void 0,r)}const ZP=new RegExp("[~\\*/\\[\\]]");function Pu(t,e,r){if(e.search(ZP)>=0)throw Na(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new tl(...e.split("."))._internalPath}catch{throw Na(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Na(t,e,r,n,o){const i=n&&!n.isEmpty(),a=o!==void 0;let c=`Function ${e}() called with invalid data`;r&&(c+=" (via `toFirestore()`)"),c+=". ";let d="";return(i||a)&&(d+=" (found",i&&(d+=` in field ${n}`),a&&(d+=` in document ${o}`),d+=")"),new qe(Te.INVALID_ARGUMENT,c+t+d)}function pg(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg{constructor(e,r,n,o,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=o,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new nr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new ew(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(wu("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class ew extends vg{data(){return super.data()}}function wu(t,e){return typeof e=="string"?Pu(t,e):e instanceof tl?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tw(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new qe(Te.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Cu{}class bg extends Cu{}function rw(t,e,...r){let n=[];e instanceof Cu&&n.push(e),n=n.concat(r),function(i){const a=i.filter(d=>d instanceof Iu).length,c=i.filter(d=>d instanceof Au).length;if(a>1||a>0&&c>0)throw new qe(Te.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const o of n)t=o._apply(t);return t}class Au extends bg{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Au(e,r,n)}_apply(e){const r=this._parse(e);return _g(e._query,r),new Lo(e.firestore,e.converter,uc(e._query,r))}_parse(e){const r=_u(e.firestore);return function(i,a,c,d,h,m,g){let _;if(h.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new qe(Te.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){Vh(g,m);const L=[];for(const M of g)L.push(Oh(d,i,M));_={arrayValue:{values:L}}}else _=Oh(d,i,g)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||Vh(g,m),_=XP(c,a,g,m==="in"||m==="not-in");return ar.create(h,m,_)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}class Iu extends Cu{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new Iu(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Zr.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(o,i){let a=o;const c=i.getFlattenedFilters();for(const d of c)_g(a,d),a=uc(a,d)}(e._query,r),new Lo(e.firestore,e.converter,uc(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class xu extends bg{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new xu(e,r)}_apply(e){const r=function(o,i,a){if(o.startAt!==null)throw new qe(Te.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new qe(Te.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ss(i,a)}(e._query,this._field,this._direction);return new Lo(e.firestore,e.converter,function(o,i){const a=o.explicitOrderBy.concat([i]);return new bi(o.path,o.collectionGroup,a,o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt)}(e._query,r))}}function nw(t,e="asc"){const r=e,n=wu("orderBy",t);return xu._create(n,r)}function Oh(t,e,r){if(typeof(r=pr(r))=="string"){if(r==="")throw new qe(Te.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!fy(e)&&r.indexOf("/")!==-1)throw new qe(Te.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(Kt.fromString(r));if(!tt.isDocumentKey(n))throw new qe(Te.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return eh(t,new tt(n))}if(r instanceof nr)return eh(t,r._key);throw new qe(Te.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ja(r)}.`)}function Vh(t,e){if(!Array.isArray(t)||t.length===0)throw new qe(Te.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function _g(t,e){const r=function(o,i){for(const a of o)for(const c of a.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new qe(Te.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new qe(Te.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class ow{convertValue(e,r="none"){switch(no(e)){case 0:return null;case 1:return e.booleanValue;case 2:return rr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(ro(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw it(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return lo(e,(o,i)=>{n[o]=this.convertValue(i,r)}),n}convertVectorValue(e){const r=e.fields?.[Ia].arrayValue?.values?.map(n=>rr(n.doubleValue));return new fn(r)}convertGeoPoint(e){return new mn(rr(e.latitude),rr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Ga(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(ns(e));default:return null}}convertTimestamp(e){const r=to(e);return new Jt(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Kt.fromString(e);jt(Oy(n),9688,{name:e});const o=new os(n.get(1),n.get(3)),i=new tt(n.popFirst(5));return o.isEqual(r)||kn(`Document ${i} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iw(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class Bi{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ao extends vg{constructor(e,r,n,o,i,a){super(e,r,n,o,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new la(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(wu("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new qe(Te.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Ao._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Ao._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ao._jsonSchema={type:lr("string",Ao._jsonSchemaVersion),bundleSource:lr("string","DocumentSnapshot"),bundleName:lr("string"),bundle:lr("string")};class la extends Ao{data(e={}){return super.data(e)}}class ni{constructor(e,r,n,o){this._firestore=e,this._userDataWriter=r,this._snapshot=o,this.metadata=new Bi(o.hasPendingWrites,o.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new la(this._firestore,this._userDataWriter,n.key,n,new Bi(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new qe(Te.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(o,i){if(o._snapshot.oldDocs.isEmpty()){let a=0;return o._snapshot.docChanges.map(c=>{const d=new la(o._firestore,o._userDataWriter,c.doc.key,c.doc,new Bi(o._snapshot.mutatedKeys.has(c.doc.key),o._snapshot.fromCache),o.query.converter);return c.doc,{type:"added",doc:d,oldIndex:-1,newIndex:a++}})}{let a=o._snapshot.oldDocs;return o._snapshot.docChanges.filter(c=>i||c.type!==3).map(c=>{const d=new la(o._firestore,o._userDataWriter,c.doc.key,c.doc,new Bi(o._snapshot.mutatedKeys.has(c.doc.key),o._snapshot.fromCache),o.query.converter);let h=-1,m=-1;return c.type!==0&&(h=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),m=a.indexOf(c.doc.key)),{type:sw(c.type),doc:d,oldIndex:h,newIndex:m}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new qe(Te.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ni._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Yc.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],o=[];return this.docs.forEach(i=>{i._document!==null&&(r.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),o.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function sw(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return it(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aw(t){t=Rn(t,nr);const e=Rn(t.firestore,Ss);return FP(pu(e),t._key).then(r=>uw(e,t,r))}ni._jsonSchemaVersion="firestore/querySnapshot/1.0",ni._jsonSchema={type:lr("string",ni._jsonSchemaVersion),bundleSource:lr("string","QuerySnapshot"),bundleName:lr("string"),bundle:lr("string")};class Sg extends ow{constructor(e){super(),this.firestore=e}convertBytes(e){return new qr(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new nr(this.firestore,null,r)}}function lw(t){t=Rn(t,Lo);const e=Rn(t.firestore,Ss),r=pu(e),n=new Sg(e);return tw(t._query),UP(r,t._query).then(o=>new ni(e,n,t,o))}function cw(t,e,r){t=Rn(t,nr);const n=Rn(t.firestore,Ss),o=iw(t.converter,e);return wg(n,[KP(_u(n),"setDoc",t._key,o,t.converter!==null,r).toMutation(t._key,dn.none())])}function Pg(t,e,r,...n){t=Rn(t,nr);const o=Rn(t.firestore,Ss),i=_u(o);let a;return a=typeof(e=pr(e))=="string"||e instanceof tl?JP(i,"updateDoc",t._key,e,r,n):QP(i,"updateDoc",t._key,e),wg(o,[a.toMutation(t._key,dn.exists(!0))])}function wg(t,e){return function(n,o){const i=new En;return n.asyncQueue.enqueueAndForget(async()=>EP(await BP(n),o,i)),i.promise}(pu(t),e)}function uw(t,e,r){const n=r.docs.get(e._key),o=new Sg(t);return new Ao(t,o,e._key,n,new Bi(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(o){gi=o})(fi),oi(new xo("firestore",(n,{instanceIdentifier:o,options:i})=>{const a=n.getProvider("app").getImmediate(),c=new Ss(new K_(n.getProvider("auth-internal")),new X_(a,n.getProvider("app-check-internal")),function(h,m){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new qe(Te.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new os(h.options.projectId,m)}(a,o),a);return i={useFetchStreams:r,...i},c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),Qn(Ud,jd,e),Qn(Ud,jd,"esm2020")})();let dw="eyAiYXBpS2V5IjogIkFJemFTeUJBbGN2WlRMMXRsQ05LRExENEJpTWJhR01iTnhCRjQtTSIsICAiYXV0aERvbWFpbiI6ICJocm0tMTEyOC5maXJlYmFzZWFwcC5jb20iLCAgImRhdGFiYXNlVVJMIjogImh0dHBzOi8vaHJtLTExMjguZmlyZWJhc2Vpby5jb20iLCAgInByb2plY3RJZCI6ICJocm0tMTEyOCIsICAic3RvcmFnZUJ1Y2tldCI6ICJocm0tMTEyOC5hcHBzcG90LmNvbSIsICAibWVzc2FnaW5nU2VuZGVySWQiOiAiMTA0OTI1MDU4NTI0NSIsICAiYXBwSWQiOiAiMToxMDQ5MjUwNTg1MjQ1OndlYjowZGFkMDAyMDI3MjM1MTRjY2M1Mjc0In0=";const Cg=nf(JSON.parse(nv(dw))),So=z_(Cg),La=new an,Pc=qP(Cg);La.addScope("profile");La.addScope("email");class Fi extends Error{}Fi.prototype.name="InvalidTokenError";function hw(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function mw(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return hw(e)}catch{return atob(e)}}function fw(t,e){if(typeof t!="string")throw new Fi("Invalid token specified: must be a string");e||(e={});const r=e.header===!0?0:1,n=t.split(".")[r];if(typeof n!="string")throw new Fi(`Invalid token specified: missing part #${r+1}`);let o;try{o=mw(n)}catch(i){throw new Fi(`Invalid token specified: invalid base64 for part #${r+1} (${i.message})`)}try{return JSON.parse(o)}catch(i){throw new Fi(`Invalid token specified: invalid json for part #${r+1} (${i.message})`)}}const yw={clientId:"195275085181-8ccjpgp8v1g80qhnlk6v4lpgid7n81gr.apps.googleusercontent.com"},gw=t=>{const e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.onload=()=>{window.google&&window.google.accounts.id.initialize({client_id:yw.clientId,callback:r=>{t(r.credential)},auto_select:!1,cancel_on_tap_outside:!0})},document.head.appendChild(e)},pw=t=>fw(t),vw=()=>{window.google&&window.google.accounts.id.disableAutoSelect()},[bw,_w]=Rc({}),Sw=async()=>{const e=await wn({query:"qcm42351987"});if(e&&!e.error){let n=Object.assign({},{},e);_w(n)}return 1},Pw=async t=>{let e=bw?.[992002];e&&(e.params={tkn:t},await wn(e))},[zo,Cr]=Rc({user:null,loading:!0,error:null,authMethod:null}),[Ag,Bh]=ve(null);$0(So,t=>{t?Cr({user:t,loading:!1,error:null,authMethod:"firebase"}):Ag()||Cr({user:null,loading:!1,error:null,authMethod:null})});i_(So).then(t=>{t&&Cr({user:t.user,loading:!1,error:null,authMethod:"firebase"})}).catch(t=>{console.error("Redirect sign-in error:",t),Cr({loading:!1,error:t.message})});const Pt={get state(){return zo},async getUserProfile(t){try{const e=hg(Pc,"users",t),r=await aw(e);if(r.exists()){Cr("profile",r.data());let n={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1},o=r.data(),i={};return Object.keys(n).map(a=>{let c=n?.[a];o.hasOwnProperty(a)||(i[a]=c)}),Object.keys(i).length>0&&Pg(e,i),r.data()}else{let n=Pt?.state?.user,o={uid:n?.uid,email:n?.email,displayName:n?.displayName,createdAt:new Date,stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1};return await cw(e,o),console.log("No such user profile!"),null}}catch(e){return console.error("Error fetching user profile:",e),null}},hasPermission:t=>{const e=Pt.state?.profile;return e?.isAdmin?!0:e?e?.[t]===!0:!1},async signInWithGoogle(){try{Cr("loading",!0),Cr("error",null);try{const t=await J0(So,La);Cr({user:t.user,loading:!1,error:null,authMethod:"firebase"});try{Pt.getUserProfile(t.user.uid)}catch(e){console.error("firestore error:",e)}}catch(t){if(t.code==="auth/popup-blocked")await n_(So,La);else throw t}}catch(t){console.error("Sign-in error:",t),Cr({loading:!1,error:t.message||"Failed to sign in with Google"})}},async signInWithGoogleP(t){const r=await wn({params:{id_token:t},query:"getGoogleUserbyToken"});if(r&&r){let n=new Date().getTime(),o=new Date(n+6e4*60*24*365),i="hrm_tkn_acc";document.cookie=`${i}=${r.data}; expires=${o}; path=/;g_state = {"i_l":1,"i_p":${o}}; ssgl_access_tkn = ${t}`,document.cookie=`ssgl_access_tkn = ${t}; expires=${o};`,await Sw(),Pw(r.data)}},async signInWithGoogleCloud(t){try{Cr("loading",!0),Cr("error",null);const e=pw(t),r={uid:e.sub,email:e.email,displayName:e.name,photoURL:e.picture};Bh(r);const n={uid:r.uid,email:r.email,displayName:r.displayName,photoURL:r.photoURL,emailVerified:!0};Cr({user:n,loading:!1,error:null,authMethod:"google-cloud"});try{const o=an.credential(t);await x0(So,o)}catch{console.log("Firebase sign-in optional, continuing with Google Cloud auth")}}catch(e){console.error("Google Cloud sign-in error:",e),Cr({loading:!1,error:e.message||"Failed to sign in with Google Cloud"})}},async signOut(){try{Cr("loading",!0),(zo.authMethod==="firebase"||So.currentUser)&&await k0(So),zo.authMethod==="google-cloud"&&(vw(),Bh(null)),Cr({user:null,loading:!1,error:null,authMethod:null})}catch(t){console.error("Sign-out error:",t),Cr({loading:!1,error:t.message||"Failed to sign out"})}},get isAuthenticated(){return!!zo.user||!!Ag()},get currentUser(){return zo.user},get authMethod(){return zo.authMethod}};var ww=q("<p>"),Cw=q('<div><div><div><h1>HRM Finance</h1><p>Complete Business Management Solution</p><div><div><button><svg width=24 height=24 viewBox="0 0 24 24"><path fill=#4285F4 d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"></path><path fill=#34A853 d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"></path><path fill=#FBBC05 d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"></path><path fill=#EA4335 d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"></path></svg></button><p>Firebase Authentication</p></div></div></div><div><div><div>💰</div><h3>Financial Management</h3><p>Complete chart of accounts, balance sheets, journal entries, and invoice management in one place.</p></div><div><div>👥</div><h3>HR Management</h3><p>Track employees, manage onboarding, and monitor your workforce with powerful analytics.</p></div><div><div>📦</div><h3>Inventory Control</h3><p>Real-time inventory tracking, product management, and movement history across multiple locations.</p></div><div><div>🏦</div><h3>Banking Integration</h3><p>Streamline bank reconciliation with CSV imports and automated consolidation features.</p></div><div><div>📊</div><h3>Real-time Analytics</h3><p>Get instant insights with dashboards showing revenue, cash flow, and business performance.</p></div><div><div>🌐</div><h3>Multi-language Support</h3><p>Available in multiple languages to support your global business operations.</p></div></div><div><p>Secure authentication powered by Google • Your data is encrypted and protected</p><p>Choose your preferred authentication method above');const Aw=()=>{Hr(()=>{gw($=>{Pt.signInWithGoogleP($)}),setTimeout(()=>{},100)});const t={"min-height":"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},e={background:"white","border-radius":"1rem","box-shadow":"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","max-width":"1200px",width:"100%",overflow:"hidden"},r={padding:"3rem","text-align":"center","border-bottom":"1px solid #e2e8f0"},n={"font-size":"2.5rem","font-weight":"800",color:"#1a202c","margin-bottom":"1rem"},o={"font-size":"1.125rem",color:"#718096","margin-bottom":"2rem"},i={display:"flex","flex-direction":"column",gap:"1rem","align-items":"center","margin-bottom":"1rem"},a={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"2rem",padding:"3rem"},c={"text-align":"center",padding:"2rem","border-radius":"0.5rem",background:"#f7fafc",transition:"transform 0.2s",cursor:"default"},d={"font-size":"3rem","margin-bottom":"1rem"},h={"font-size":"1.25rem","font-weight":"600",color:"#2d3748","margin-bottom":"0.5rem"},m={color:"#718096","line-height":"1.6"},g={display:"inline-flex","align-items":"center",gap:"0.75rem",background:"white",color:"#4285f4",border:"2px solid #4285f4",padding:"0.75rem 2rem","font-size":"1.125rem","font-weight":"500","border-radius":"0.5rem",cursor:"pointer",transition:"all 0.2s","min-width":"250px","justify-content":"center"},_={color:"#e53e3e","margin-top":"1rem","font-size":"0.875rem"},A={background:"#f7fafc",padding:"2rem","text-align":"center",color:"#718096","font-size":"0.875rem"},L={"font-size":"0.75rem",color:"#718096","margin-top":"0.25rem","font-style":"italic"},M=()=>{Pt.signInWithGoogle()};return(()=>{var $=Cw(),T=$.firstChild,ee=T.firstChild,ce=ee.firstChild,Z=ce.nextSibling,ge=Z.nextSibling,ne=ge.firstChild,w=ne.firstChild;w.firstChild;var S=w.nextSibling,p=ee.nextSibling,C=p.firstChild,P=C.firstChild,x=P.nextSibling,y=x.nextSibling,ue=C.nextSibling,J=ue.firstChild,E=J.nextSibling,F=E.nextSibling,z=ue.nextSibling,B=z.firstChild,k=B.nextSibling,U=k.nextSibling,he=z.nextSibling,H=he.firstChild,le=H.nextSibling,I=le.nextSibling,j=he.nextSibling,K=j.firstChild,R=K.nextSibling,X=R.nextSibling,O=j.nextSibling,N=O.firstChild,te=N.nextSibling,de=te.nextSibling,pe=p.nextSibling,se=pe.firstChild,Y=se.nextSibling;return u($,t),u(T,e),u(ee,r),u(ce,n),u(Z,o),u(ge,i),w.addEventListener("mouseleave",D=>{D.currentTarget.style.background="white",D.currentTarget.style.color="#4285f4"}),w.addEventListener("mouseenter",D=>{D.currentTarget.style.background="#4285f4",D.currentTarget.style.color="white"}),w.$$click=M,u(w,g),s(w,v(Ne,{get when(){return Pt.state.loading},fallback:"Sign in with Google",children:"Signing in..."}),null),u(S,L),s(ee,v(Ne,{get when(){return Pt.state.error},get children(){var D=ww();return u(D,_),s(D,()=>Pt.state.error),D}}),null),u(p,a),u(pe,A),Y.style.setProperty("margin-top","0.5rem"),Y.style.setProperty("font-size","0.75rem"),ie(D=>{var Q=Pt.state.loading,W=c,me=d,fe=h,V=m,re=c,_e=d,Pe=h,ae=m,be=c,oe=d,Se=h,Ee=m,xe=c,$e=d,Me=h,We=m,je=c,Ce=d,Ve=h,Ke=m,He=c,Qe=d,Ie=h,ot=m;return Q!==D.e&&(w.disabled=D.e=Q),D.t=u(C,W,D.t),D.a=u(P,me,D.a),D.o=u(x,fe,D.o),D.i=u(y,V,D.i),D.n=u(ue,re,D.n),D.s=u(J,_e,D.s),D.h=u(E,Pe,D.h),D.r=u(F,ae,D.r),D.d=u(z,be,D.d),D.l=u(B,oe,D.l),D.u=u(k,Se,D.u),D.c=u(U,Ee,D.c),D.w=u(he,xe,D.w),D.m=u(H,$e,D.m),D.f=u(le,Me,D.f),D.y=u(I,We,D.y),D.g=u(j,je,D.g),D.p=u(K,Ce,D.p),D.b=u(R,Ve,D.b),D.T=u(X,Ke,D.T),D.A=u(O,He,D.A),D.O=u(N,Qe,D.O),D.I=u(te,Ie,D.I),D.S=u(de,ot,D.S),D},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0}),$})()};Et(["click"]);var Iw=q("<div><div>");const xw=t=>{const e={"min-height":"100vh",display:"flex","align-items":"center","justify-content":"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},r={width:"50px",height:"50px",border:"3px solid rgba(255, 255, 255, 0.3)","border-top-color":"white","border-radius":"50%",animation:"spin 1s linear infinite"},n=document.createElement("style");return n.textContent=`
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  `,document.head.appendChild(n),Nn(()=>{Pt.state?.user?.uid&&Pt.getUserProfile(Pt.state?.user?.uid)}),Hr(()=>{}),v(Ne,{get when(){return!Pt.state.loading},get fallback(){return(()=>{var o=Iw(),i=o.firstChild;return u(o,e),u(i,r),o})()},get children(){return v(Ne,{get when(){return Pt.isAuthenticated},get fallback(){return v(Aw,{})},get children(){return t.children}})}})};var Ew=q("<button>");const Le=t=>{const e=()=>{const r={"font-family":"inherit",cursor:t.disabled?"not-allowed":"pointer",border:"none","border-radius":"var(--border-radius-sm)","font-weight":"500",transition:"all 0.2s ease","text-decoration":"none",display:"inline-flex","align-items":"center","justify-content":"center",gap:"0.5rem",opacity:t.disabled?"0.6":"1"},n={sm:{padding:"0.5rem 1rem","font-size":"0.875rem"},md:{padding:"0.75rem 1.5rem","font-size":"1rem"},lg:{padding:"1rem 2rem","font-size":"1.125rem"}},o={primary:{background:"linear-gradient(135deg, var(--primary-color), var(--primary-dark))",color:"white","box-shadow":"var(--shadow-sm)"},secondary:{background:"var(--surface-color)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},outline:{background:"transparent",color:"var(--primary-color)",border:"1px solid var(--primary-color)"}};return{...r,...n[t.size||"md"],...o[t.variant||"primary"]}};return(()=>{var r=Ew();return ko(r,"click",t.onClick,!0),s(r,()=>t.children),ie(n=>{var o=e(),i=t.disabled,a=t.type||"button",c=`btn btn-${t.variant||"primary"} ${t.className||""}`;return n.e=u(r,o,n.e),i!==n.t&&(r.disabled=n.t=i),a!==n.a&&ut(r,"type",n.a=a),c!==n.o&&Ec(r,n.o=c),n},{e:void 0,t:void 0,a:void 0,o:void 0}),r})()};Et(["click"]);var Tw=q("<div><div><div><h2></h2><button>×</button></div><div>");const br=t=>{const e={position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","z-index":"1000"},r={background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)","max-width":"920px",width:"90%","max-height":"80vh",overflow:"auto",position:"relative"},n={padding:"1.5rem","border-bottom":"1px solid var(--border-color)",display:"flex","justify-content":"space-between","align-items":"center"},o={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},i={background:"none",border:"none","font-size":"1.5rem",cursor:"pointer",color:"var(--text-muted)",padding:"0.5rem","border-radius":"var(--border-radius-sm)"},a={padding:"1.5rem"},c=d=>{d.target===d.currentTarget&&t.onClose()};return v(Ne,{get when(){return t.isOpen},get children(){var d=Tw(),h=d.firstChild,m=h.firstChild,g=m.firstChild,_=g.nextSibling,A=m.nextSibling;return d.$$click=c,u(m,n),u(g,o),s(g,()=>t.title),_.addEventListener("mouseleave",L=>L.target.style.background="none"),_.addEventListener("mouseenter",L=>L.target.style.background="var(--background-color)"),ko(_,"click",t.onClose,!0),u(_,i),u(A,a),s(A,()=>t.children),ie(L=>{var M=e,$=r;return L.e=u(d,M,L.e),L.t=u(h,$,L.t),L},{e:void 0,t:void 0}),d}})};Et(["click"]);var Fh=q("<div>"),$w=q("<h3>"),kw=q("<p>");const Ze=t=>{const e={background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"1.5rem","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",transition:"all 0.2s ease",cursor:t.onClick?"pointer":"default"},r={"margin-bottom":"1rem"},n={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0 0 0.5rem 0"},o={"font-size":"0.875rem",color:"var(--text-muted)",margin:"0"};return(()=>{var i=Fh();return ko(i,"click",t.onClick,!0),s(i,(()=>{var a=ye(()=>!!(t.title||t.subtitle));return()=>a()&&(()=>{var c=Fh();return u(c,r),s(c,(()=>{var d=ye(()=>!!t.title);return()=>d()&&(()=>{var h=$w();return u(h,n),s(h,()=>t.title),h})()})(),null),s(c,(()=>{var d=ye(()=>!!t.subtitle);return()=>d()&&(()=>{var h=kw();return u(h,o),s(h,()=>t.subtitle),h})()})(),null),c})()})(),null),s(i,()=>t.children,null),ie(a=>{var c=e,d=`card ${t.className||""}`;return a.e=u(i,c,a.e),d!==a.t&&Ec(i,a.t=d),a},{e:void 0,t:void 0}),i})()};Et(["click"]);var Rw=q("<div><label></label><input>"),Dw=q("<span>*");const Mt=t=>{const e={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},r={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},n={"margin-bottom":"1rem"};return(()=>{var o=Rw(),i=o.firstChild,a=i.nextSibling;return u(o,n),u(i,e),s(i,()=>t.label,null),s(i,(()=>{var c=ye(()=>!!t.required);return()=>c()&&(()=>{var d=Dw();return d.style.setProperty("color","var(--primary-color)"),d})()})(),null),a.addEventListener("blur",c=>c.target.style.borderColor="var(--border-color)"),a.addEventListener("focus",c=>c.target.style.borderColor="var(--primary-color)"),a.$$input=c=>t.onChange(c.target.value),u(a,r),ie(c=>{var d=t.type||"text",h=t.placeholder,m=t.required,g=t.disabled;return d!==c.e&&ut(a,"type",c.e=d),h!==c.t&&ut(a,"placeholder",c.t=h),m!==c.a&&(a.required=c.a=m),g!==c.o&&(a.disabled=c.o=g),c},{e:void 0,t:void 0,a:void 0,o:void 0}),ie(()=>a.value=t.value),o})()};Et(["input"]);const Nw={en:{common:{save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",close:"Close",search:"Search",filter:"Filter",reset:"Reset",back:"Back",next:"Next",previous:"Previous",yes:"Yes",no:"No",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",confirm:"Confirm",actions:"Actions",status:"Status",active:"Active",inactive:"Inactive",date:"Date",time:"Time",description:"Description",notes:"Notes",amount:"Amount",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Language",english:"English",spanish:"Spanish",noDataFound:"No data found",required:"Required",optional:"Optional",all:"All",none:"None",select:"Select",clear:"Clear",searching:"Searching...",refresh:"Refresh",showAll:"Show All",products:"products",filtered:"Filtered",view:"View",suggested:"Suggested",clearFilters:"Clear Filters",enhanced:"Enhanced",legacy:"Legacy",email:"Email",phone:"Phone",address:"Address",name:"Name",code:"Code",category:"Category",type:"Type",quantity:"Quantity",price:"Price",cost:"Cost",value:"Value",balance:"Balance",created:"Created",modified:"Modified",details:"Details",summary:"Summary",history:"History",new:"New",addNew:"Add New",unknown:"Unknown",notAvailable:"N/A",remove:"Remove",startDate:"Start Date",endDate:"End Date",from:"From",invoice:"Invoice",invoices:"invoices",reference:"Reference",createdBy:"Created By",units:"units",invoiceDocumentId:"Invoice/Document ID",referenceNumber:"Reference Number",referenceNumberPlaceholder:"Enter reference number...",generalNotes:"General Notes",auto:"Auto",optionalNotes:"Optional notes...",showPerPage:"Show per page",first:"First",last:"Last",pageOfPages:"Page {{current}} of {{total}}",showingXofY:"Showing {{start}}-{{end}} of {{total}}",page:"Page",of:"of",print:"Print",export:"Export",pending:"Pending",completed:"Completed",customer:"Customer",store:"Store",location:"Location",reservations:"Reservations",backToDashboard:"Back to Dashboard",lbs:"pounds"},forms:{referenceNumberRequired:"Reference number is required",locationRequired:"Location is required",fromLocationRequired:"From location is required for transfers",atLeastOneProduct:"At least one product is required",itemProductRequired:"Product is required for item {{index}}",itemQuantityRequired:"Quantity must be greater than 0 for item {{index}}"},navigation:{dashboard:"Dashboard",accounts:"Chart of Accounts",balanceSheet:"Balance Sheet",inventory:"Inventory",employees:"Employees",entryBooks:"Entry Books",consolidate:"Bank Consolidation",reports:"Reports",settings:"Settings"},dashboard:{title:"Dashboard",welcome:"Welcome to HRM Finance",totalRevenue:"Total Revenue",overview:"Overview",recentActivity:"Recent Activity",quickActions:"Quick Actions",employeeCount:"Employee Count",pendingInvoices:"Pending Invoices",cashBalance:"Cash Balance",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalExpenses:"Total Expenses",netIncome:"Net Income",netLoss:"Net Loss",monthlyPayroll:"Monthly Payroll",current:"Current",newHires:"+3 new hires",outstanding:"Outstanding",totalOutstanding:"$23,450 total",lastUpdatedToday:"Last updated today",commonTasks:"Common tasks",generateReport:"Generate Report",latestUpdates:"Latest updates",invoicePaid:"Invoice #1234 paid",hoursAgo:"2 hours ago",newEmployeeOnboarded:"New employee onboarded",dayAgo:"1 day ago",monthlyReportGenerated:"Monthly report generated",daysAgo:"2 days ago"},accounts:{title:"Chart of Accounts",accountNumber:"Account Number",accountName:"Account Name",accountType:"Account Type",category:"Category",balance:"Balance",parentAccount:"Parent Account",subAccounts:"Sub-accounts",addAccount:"Add Account",editAccount:"Edit Account",deleteAccount:"Delete Account",accountDetails:"Account Details",transactions:"Transactions",accountHistory:"Account History",backToAccounts:"Back to Accounts",accountNotFound:"Account not found",accountInformation:"Account Information",accountPurpose:"Account purpose",transactionHistory:"Transaction History",noTransactions:"No transactions found for this account",createdDate:"Created Date",lastModified:"Last Modified",noDescription:"No description provided.",totalCount:"Total count",basicDetails:"Basic details",currentBalance:"Current balance",classification:"Classification",allTransactions:"All account transactions",reference:"Reference",allAccounts:"All Accounts",types:{asset:"Asset",liability:"Liability",equity:"Equity",revenue:"Revenue",expense:"Expense"},categories:{currentAssets:"Current Assets",fixedAssets:"Fixed Assets",currentLiabilities:"Current Liabilities",longTermLiabilities:"Long-term Liabilities",ownersEquity:"Owner's Equity",operatingRevenue:"Operating Revenue",operatingExpenses:"Operating Expenses"}},inventory:{title:"Inventory Management",overview:"Overview",products:"Products & Stock",movements:"Movements",locations:"Locations",bulkMovement:"Bulk Movement",addMovement:"Add Movement",addProduct:"Add Product",addLocation:"Add Location",singleMovement:"Add Single Movement",addNewItem:"Add New Item",activeProducts:"Active Products",lowStockAlert:"Low Stock Items",totalValue:"Total Stock Value",activeLocations:"Active Locations",productsNeedRestocking:"products need restocking",recentMovements:"Recent Movements",noProducts:"No products at this location",productName:"Product Name",productCode:"Product Code",sku:"SKU",unitOfMeasure:"Unit of Measure",unitCost:"Unit Cost",minStockLevel:"Min Stock Level",maxStockLevel:"Max Stock Level",locationName:"Location Name",locationType:"Location Type",locationCode:"Location Code",movementType:"Movement Type",referenceNumber:"Reference Number",invoiceNumber:"Invoice Number",fromLocation:"From Location",toLocation:"To Location",stockIn:"Stock In",stockOut:"Stock Out",transfer:"Transfer",adjustment:"Adjustment",inStock:"In Stock",lowStock:"Low Stock",outOfStock:"Out of Stock",stockLevels:"Stock Levels",stockByLocation:"Stock by Location",searchProducts:"Search products by name, SKU, or category...",searchProductsStock:"Search products and check stock levels...",searchResult:"Search Result",searchResults:"Search Results",searchFallback:"Showing local results",tryDifferentTerm:"Try a different search term or check spelling.",showingTopResults:"Showing top {{count}} results",searchLocations:"Search locations...",noMovements:"No movements found",productDetails:"Product Details",locationDetails:"Location Details",movementDetails:"Movement Details",totalProducts:"Total Products",totalLocations:"Total Locations",lastSeen:"Last seen",warehouseType:"Warehouse",storeType:"Store",supplierType:"Supplier",customerType:"Customer",currentlyManaged:"Currently managed",needAttention:"Need attention",currentWorth:"Current worth",warehousesStores:"Warehouses & stores",thisMonth:"This Month",latestActivities:"Latest inventory activities",searchMovements:"Search Movements",countingSheet:"Counting Sheet",physicalCount:"Physical Count",physicalInventoryCount:"Physical Inventory Count",setupPhysicalCount:"Setup Physical Inventory Count",setupDescription:"Configure your physical inventory count settings and begin the counting process.",countWillInclude:"This count will include {{count}} products from {{location}} in {{category}} category.",startCounting:"Start Physical Count",counted:"Counted",remaining:"Remaining",variances:"Variances",complete:"Complete",systemQty:"System Qty",variance:"Variance",addNotes:"Add notes...",reviewAndConfirm:"Review and Confirm Adjustments",reviewDescription:"Review the inventory adjustments below and confirm to update your system.",stockIncreases:"Stock Increases",stockDecreases:"Stock Decreases",totalAdjustments:"Total Adjustments",confirmAdjustments:"Confirm Adjustments",perfectCount:"Perfect Count!",noVariances:"No variances found. Your physical count matches the system exactly.",physicalCountAdjustment:"Physical count adjustment",inventoryCountingSheetTitle:"INVENTORY COUNTING SHEET",location:"Location",allCategories:"All Categories",countedBy:"Counted by",verifiedBy:"Verified by",instructions:"Instructions",countInstructions:["Count all items physically present at this location",'Write the actual count in the "Physical Count" column',"Leave blank if item is not found",'Note any discrepancies in the "Notes" column',"Sign and date when complete"],productName:"Product Name",unit:"Unit",totalProductsListed:"Total Products Listed",itemsCounted:"Items Counted",discrepanciesFound:"Discrepancies Found",counterSignature:"Counter Signature",supervisorSignature:"Supervisor Signature",downloadCSV:"Download CSV",noAdjustmentsToDownload:"No adjustments to download",stockIncrease:"Stock Increase",stockDecrease:"Stock Decrease",purchaseReceive:"Purchase/Receive",saleIssue:"Sale/Issue",transfer:"Transfer",adjustment:"Adjustment",movementType:"Movement Type",fromLocation:"From Location",toLocation:"To Location",searchSourceLocation:"Search source location...",searchDestinationLocation:"Search destination location...",searchLocation:"Search location...",addProduct:"Add Product",searchProduct:"Search product...",unitCost:"Unit Cost",noProductsAdded:'No products added yet. Click "Add Product" to get started.',createMovement:"Create Movement",generalNotesPlaceholder:"Enter general notes for this movement...",sortBy:"Sort By",allLocations:"All Locations",searchByProduct:"Search by product, location, reference, notes, invoice...",allProducts:"All Products",allTypes:"All Types",startDate:"Start Date",endDate:"End Date",totalMovements:"Total Movements",totalItems:"Total Items",adjustMovements:"Try adjusting your filters or check back later.",inventoryMovements:"Inventory Movements",createdBy:"Created By",view:"View",enhanced:"Enhanced",legacy:"Legacy",addSingleMovement:"Add Single Movement",inStockSubtitle:"In stock",itemsBelowThreshold:"Items below threshold",inventoryWorth:"Inventory worth",quantity:"Quantity",units:"units",normal:"Normal",productsAndStock:"Products & Stock",lowStockItems:"Low Stock Items",totalStockValue:"Total Stock Value",warehousesAndStores:"Warehouses & stores",andMore:"...and {count} more",latestInventoryActivities:"Latest inventory activities",min:"Min",max:"Max",cost:"Cost",noProductsFound:"No products found matching your search.",noProductsAvailable:"No products available.",noLocationsFound:"No locations found matching your search.",noLocationsAvailable:"No locations available.",searchPlaceholder:"Search by product, location, reference, notes, invoice...",noMovementsFound:"No movements found",tryAdjustingFilters:"Try adjusting your filters or check back later.",transfers:"Transfers",adjustments:"Adjustments",bulk:"Bulk",product:"Product",location:"Location",store:"Store",supplier:"Supplier",warehouse:"Warehouse",movement:"Movement",editMovement:"Edit Movement",updateMovement:"Update Movement",movementInformation:"Movement Information",locationInformation:"Location Information",searchProductsImages:"Search products to view images...",searchForProducts:"Search for Products",startTypingToSearch:"Start typing to search and view product images",tryDifferentSearch:"Try a different search term"},employees:{title:"Employee Management",employeeList:"Employee List",addEmployee:"Add Employee",editEmployee:"Edit Employee",employeeDetails:"Employee Details",personalInfo:"Personal Information",employmentInfo:"Employment Information",payrollInfo:"Payroll Information",firstName:"First Name",lastName:"Last Name",fullName:"Full Name",email:"Email",phone:"Phone",address:"Address",dateOfBirth:"Date of Birth",employeeId:"Employee ID",department:"Department",position:"Position",hireDate:"Hire Date",employmentStatus:"Employment Status",salary:"Salary",payFrequency:"Pay Frequency",taxId:"Tax ID",bankAccount:"Bank Account",emergencyContact:"Emergency Contact",activeEmployees:"Active Employees",inactiveEmployees:"Inactive Employees",totalPayroll:"Total Payroll",searchEmployees:"Search employees...",enterFullName:"Enter employee's full name",enterPosition:"Enter job position",enterEmail:"Enter email address",enterPhone:"Enter phone number",enterSalary:"Enter annual salary",departments:{engineering:"Engineering",product:"Product",design:"Design",marketing:"Marketing",sales:"Sales",humanResources:"Human Resources",finance:"Finance",operations:"Operations",analytics:"Analytics"}},entryBooks:{title:"Entry Books",bookName:"Book Name",bookType:"Book Type",createBook:"Create Book",editBook:"Edit Book",salesBook:"Sales Book",purchaseBook:"Purchase Book",cashBook:"Cash Book",generalBook:"General Book",entries:"Entries",addEntry:"Add Entry",period:"Period",startDate:"Start Date",endDate:"End Date",bookBalance:"Book Balance",reconciledBalance:"Reconciled Balance",difference:"Difference",reconcile:"Reconcile",isReconciled:"Is Reconciled",noBooks:"No entry books found",createFirst:"Create your first entry book to get started",bookDetails:"Book Details",entriesCount:"entries",bookOverview:"Book overview and details",bookEntries:"Book Entries",allEntries:"All entries in this book",noEntries:"No entries found",addFirst:"Add your first entry to this book",entryDate:"Entry Date",entryDescription:"Entry Description",entryAmount:"Entry Amount",entryReference:"Entry Reference",subtitle:"Manage accounting entries and general ledger records",viewReconciliation:"View Reconciliation",totalEntries:"Total Entries",allJournalEntries:"All journal entries",postedEntriesOnly:"Posted entries only",fromPostedEntries:"From {count} posted entries",needBankReconciliation:"Need bank reconciliation",allReconciled:"All reconciled",sortBy:"Sort By",fromDate:"From Date",toDate:"To Date",order:"Order",newest:"Newest",oldest:"Oldest",resetFilters:"Reset Filters",activeFilters:"Active filters",from:"From",to:"To",entriesFound:"{count} entries found",noJournalEntries:"No Journal Entries",startByCreating:"Start by creating your first entry",noEntriesMatch:"No journal entries match your current filters.",createFirstEntry:"Create First Entry",void:"Void",confirmVoid:"Are you sure you want to void this journal entry?",entryBookRecords:"Entry Book Records"},banking:{title:"Bank Consolidation",bankAccount:"Bank Account",statementDate:"Statement Date",beginningBalance:"Beginning Balance",endingBalance:"Ending Balance",deposits:"Deposits",withdrawals:"Withdrawals",bankCharges:"Bank Charges",interest:"Interest",reconcile:"Reconcile",matched:"Matched",unmatched:"Unmatched",importStatement:"Import Statement",manualEntry:"Manual Entry",autoMatch:"Auto Match",clearAll:"Clear All",reconciliationStatus:"Reconciliation Status",difference:"Difference",bookBalance:"Book Balance",statementBalance:"Statement Balance",outstandingChecks:"Outstanding Checks",depositsInTransit:"Deposits in Transit",reconciled:"Reconciled",notReconciled:"Not Reconciled",unreconciled:"Unreconciled",reconciliation:"Reconciliation",compareStatements:"Compare bank statements with entry book records",importCSV:"Import CSV",startNewReconciliation:"Start New Reconciliation",bankAccountInfo:"Bank Account Info",currentAccountDetails:"Current account details",lastReconciled:"Last reconciled",bankTransactions:"Bank Transactions",selectedPeriod:"Selected period",pending:"pending",bookEntriesForComparison:"Book entries for comparison",reconciliationRate:"Reconciliation Rate",completionStatus:"Completion status",recentReconciliationSessions:"Recent Reconciliation Sessions",latestActivity:"Latest activity",noRecentSessions:"No recent reconciliation sessions found.",startFirstReconciliation:"Start First Reconciliation",entryBookRecords:"Entry Book Records",pleaseUploadCSV:"Please upload a CSV file",csvRequiresHeaderAndData:"CSV file must have at least a header and one data row",successfullyParsed:"Successfully parsed {count} rows",errorParsingCSV:"Error parsing CSV file. Please check the format.",dateDescriptionRequired:"Date and Description columns are required",importedTransaction:"Imported transaction",successfullyImported:"Successfully imported {count} bank transactions",errorImportingTransactions:"Error importing transactions. Please check your data.",importBankStatementCSV:"Import Bank Statement CSV",dropCSVHere:"Drop CSV file here",clickToUploadCSV:"Click to upload or drag and drop CSV file",supportedFormat:"Supported format: CSV with Date, Description, and Amount columns",mapCSVColumns:"Map CSV Columns",dateColumn:"Date Column",selectColumn:"Select column...",descriptionColumn:"Description Column",referenceColumn:"Reference Column",amountDebitColumn:"Amount/Debit Column",creditColumn:"Credit Column",balanceColumn:"Balance Column",andMoreRows:"... and {count} more rows",importing:"Importing...",importTransactions:"Import {count} Transactions",reconciliationComparison:"Reconciliation Comparison",bankStatements:"Bank Statements",totalTransactions:"Total transactions",totalEntries:"Total entries",unreconciledBank:"Unreconciled Bank",unreconciledBooks:"Unreconciled Books",needAttention:"Need attention",unreconcile:"Unreconcile",clickToReconcile:"Click to reconcile",potentialMatchesFound:"Potential Matches Found",clickRecordToReconcile:"Click on a record below to reconcile",exactMatch:"Exact Match",possibleMatch:"Possible Match",selected:"Selected",clearSelection:"Clear Selection"},journal:{title:"Journal Entries",entryNumber:"Entry Number",entryDate:"Entry Date",debit:"Debit",credit:"Credit",account:"Account",memo:"Memo",reference:"Reference",createEntry:"Create Entry",editEntry:"Edit Entry",deleteEntry:"Delete Entry",posted:"Posted",draft:"Draft",reversed:"Reversed",recurringEntry:"Recurring Entry",attachments:"Attachments",totalDebits:"Total Debits",totalCredits:"Total Credits",outOfBalance:"Out of Balance",balanced:"Balanced",addEntry:"Add Journal Entry",allEntries:"All Entries",totalDebit:"Total Debit",totalCredit:"Total Credit",debitShort:"Dr.",creditShort:"Cr.",noReference:"No reference",createdBy:"By",totalAmount:"Total Amount",lines:"Lines",entryNotBalancedShort:"Entry is not balanced",accountLines:"Account Lines",noDescription:"No description",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryLines:"Journal Entry Lines",addLine:"Add Line",lineDescription:"Line description",notBalanced:"Not Balanced",updateEntry:"Update Entry",saveAsDraft:"Save as Draft",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",editEntryTooltip:"Edit this journal entry",post:"Post",entryMustBeBalanced:"Entry must be balanced to post",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",journalLines:"Journal Lines",balanceStatus:"Balance Status",unbalanced:"Unbalanced",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",postEntry:"Post Entry",fixBalance:"Fix Balance",voidEntry:"Void Entry",draftEntry:"Draft Entry",draftEntryDescription:"This entry can be edited and posted.",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",postedEntry:"Posted Entry",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",minTwoLinesRequired:"At least 2 line items are required",entryNotBalanced:"Entry is not balanced. Debit: ${debit}, Credit: ${credit}",lineAccountRequired:"Line {lineNumber}: Account is required",lineAmountRequired:"Line {lineNumber}: Either debit or credit amount must be provided",lineBothAmounts:"Line {lineNumber}: Cannot have both debit and credit amounts",enterEntryDescription:"Enter journal entry description",enterReferenceNumber:"Enter reference number"},invoices:{title:"Invoice Dashboard",invoice:"Invoice",invoiceNumber:"Invoice Number",invoiceDetails:"Invoice Details",customerInformation:"Customer Information",customerName:"Customer Name",legalName:"Legal Name",contactInformation:"Contact Information",idPassport:"ID/Passport",phoneNumber:"Phone Number",altPhone:"Alt Phone",address:"Address",between:"Between",and:"and",products:"Products",reservations:"Reservations",unitPrice:"Unit Price",total:"Total",subtotal:"Subtotal",totalRevenue:"Total Revenue",totalProducts:"Total Products",totalReservations:"Total Reservations",aranceles:"Aranceles (Customs)",uniqueCustomers:"Unique Customers",averageInvoice:"Average Invoice",completed:"Completed",pending:"Pending",storesActive:"Stores Active",topProducts:"Top Products",mostSoldProducts:"Most sold products by quantity",reservationsByType:"Reservations by Type",distributionOfCategories:"Distribution of reservation categories",recentInvoices:"Recent Invoices",showingInvoices:"Showing {{count}} invoices",date:"Date",customer:"Customer",store:"Store",actions:"Actions",view:"View",status:"Status",printInvoice:"Print Invoice",exportPdf:"Export PDF",backToDashboard:"Back to Dashboard",fromInvoices:"From {{count}} invoices",value:"value",activeCustomers:"Active customers",perInvoiceValue:"Per invoice value",locations:"Locations",mostRecentActivity:"Most recent activity",storeLocation:"Store Location",allStores:"All Stores",fromDate:"From Date",toDate:"To Date",clearFilters:"Clear Filters",customsFees:"Total customs fees",salesType:"SALES",packagesOrder:"Packages Order",businessId:"Business ID",orderKey:"Order Key",reservationType:"Reservation Type",arancel:"Arancel",key:"Key",noInvoicesFound:"No invoices found",loadingInvoices:"Loading invoices...",errorLoadingInvoices:"Error loading invoices",refreshData:"Refresh Data",currentStockValue:"Current Stock Value",filterByStore:"Filter by store",filterByDate:"Filter by date range",totalCustomsFees:"Total customs fees",averageValue:"Average value",senderInformation:"Sender Information",receiptInformation:"Receipt Information",productsSubtotal:"Products Subtotal",reservationsSubtotal:"Reservations Subtotal",code:"Code",description:"Description",qty:"Qty",type:"Type",id:"ID",passport:"Passport"},forms:{requiredField:"This field is required",invalidEmail:"Invalid email address",invalidNumber:"Invalid number",invalidDate:"Invalid date",selectOption:"Please select an option",enterValue:"Please enter a value",confirmDelete:"Are you sure you want to delete this item?",unsavedChanges:"You have unsaved changes. Do you want to continue?",saveSuccess:"Saved successfully",saveError:"Error saving data",deleteSuccess:"Deleted successfully",deleteError:"Error deleting item",duplicateAccountNumber:"Account number already exists",descriptionRequired:"Description is required",errorOccurred:"An error occurred",errorPostingEntry:"An error occurred while posting the entry"},modals:{addInventory:"Add Inventory Movement",bulkMovement:"Bulk Inventory Movement",addProduct:"Add New Product",addLocation:"Add New Location",inventoryDetail:"Inventory Item Details",quickAdd:"Quick Add",selectProduct:"Select Product",selectLocation:"Select Location",enterQuantity:"Enter quantity",enterCost:"Enter unit cost",enterReference:"Enter reference number",addNotes:"Add notes (optional)",generalInformation:"General Information",stockInformation:"Stock Information",locationInformation:"Location Information",movementInformation:"Movement Information",addToInventory:"Add to Inventory",createProduct:"Create Product",createLocation:"Create Location",processing:"Processing...",addingMovement:"Adding movement...",creatingProduct:"Creating product...",creatingLocation:"Creating location..."},products:{title:"Products",addNew:"Add New Product",totalProducts:"Total Products",inCatalog:"In catalog",activeProducts:"Active Products",currentlyAvailable:"Currently available",outOfStock:"Out of Stock",needsRestock:"Needs restock",productCatalog:"Product Catalog",manageYourProducts:"Manage your products and pricing",inStock:"In Stock",furniture:"Furniture",electronics:"Electronics",supplies:"Supplies",lighting:"Lighting",searchPlaceholder:"Search products by name, SKU, or category...",allCategories:"All Categories",clearFilters:"Clear filters",noResults:"No products found matching your criteria.",noProducts:"No products available.",showing:"Showing",filtered:"Filtered results",allProducts:"All products",searchResult:"Search Result",stock:"Stock",lowStock:"Low Stock"},invoices:{title:"Invoices",createNew:"Create New Invoice",totalOutstanding:"Total Outstanding",unpaidInvoices:"Unpaid invoices",thisMonth:"This Month",revenueCollected:"Revenue collected",overdue:"Overdue",pastDueInvoices:"Past due invoices",recentInvoices:"Recent Invoices",latestBillingActivity:"Latest billing activity",paid:"Paid",pending:"Pending"},unauthorized:{title:"Access Restricted",accessDenied:"Access Denied",noPermission:"You don't have permission to access",thisFeature:"this feature",whySeeing:"Why am I seeing this?",explanation:"Your account doesn't have the necessary permissions to view this content.",requiredPermission:"Required permission:",goToDashboard:"Go to Dashboard",goBack:"Go Back",featuresCanAccess:"Features you can access:",dashboardAccess:"Dashboard and overview statistics",profileAccess:"Your profile and settings",roleBasedAccess:"Features enabled for your role",needAccess:"Need access? Contact your administrator or manager to request the appropriate permissions.",permissions:{accountAccess:"Account Management Access",inventoryAccess:"Inventory Access",employeeAccess:"HR Access",bankingAccess:"Banking Access",journalAccess:"Journal Entry Access",adminAccess:"Administrative Access",financialReporting:"Financial Reporting Access",invoiceManagement:"Invoice Management Access",productManagement:"Product Management Access"}}},es:{common:{save:"Guardar",cancel:"Cancelar",delete:"Eliminar",edit:"Editar",add:"Agregar",close:"Cerrar",search:"Buscar",filter:"Filtrar",reset:"Restablecer",back:"Atrás",next:"Siguiente",previous:"Anterior",yes:"Sí",no:"No",loading:"Cargando...",error:"Error",success:"Éxito",warning:"Advertencia",info:"Información",confirm:"Confirmar",actions:"Acciones",status:"Estado",active:"Activo",inactive:"Inactivo",date:"Fecha",time:"Hora",description:"Descripción",notes:"Notas",amount:"Monto",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Idioma",english:"Inglés",spanish:"Español",noDataFound:"No se encontraron datos",required:"Requerido",optional:"Opcional",all:"Todos",none:"Ninguno",select:"Seleccionar",clear:"Limpiar",view:"Ver",suggested:"Sugerido",clearFilters:"Limpiar Filtros",enhanced:"Mejorado",legacy:"Clásico",email:"Correo Electrónico",phone:"Teléfono",address:"Dirección",name:"Nombre",code:"Código",category:"Categoría",type:"Tipo",quantity:"Cantidad",price:"Precio",cost:"Costo",value:"Valor",balance:"Saldo",created:"Creado",modified:"Modificado",details:"Detalles",summary:"Resumen",history:"Historial",new:"Nuevo",addNew:"Agregar Nuevo",unknown:"Desconocido",notAvailable:"N/A",remove:"Remover",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",from:"De",invoice:"Factura",invoices:"facturas",reference:"Referencia",createdBy:"Creado Por",units:"unidades",invoiceDocumentId:"ID de Factura/Documento",referenceNumber:"Número de Referencia",referenceNumberPlaceholder:"Ingrese número de referencia...",generalNotes:"Notas Generales",auto:"Auto",optionalNotes:"Notas opcionales...",showPerPage:"Mostrar por página",first:"Primera",last:"Última",pageOfPages:"Página {{current}} de {{total}}",showingXofY:"Mostrando {{start}}-{{end}} de {{total}}",page:"Página",of:"de",lbs:"libras"},forms:{referenceNumberRequired:"El número de referencia es requerido",locationRequired:"La ubicación es requerida",fromLocationRequired:"La ubicación de origen es requerida para transferencias",atLeastOneProduct:"Al menos un producto es requerido",itemProductRequired:"El producto es requerido para el artículo {{index}}",itemQuantityRequired:"La cantidad debe ser mayor que 0 para el artículo {{index}}"},navigation:{dashboard:"Panel de Control",accounts:"Plan de Cuentas",balanceSheet:"Balance General",inventory:"Inventario",employees:"Empleados",entryBooks:"Libros de Entrada",consolidate:"Consolidación Bancaria",reports:"Reportes",settings:"Configuración"},dashboard:{title:"Panel de Control",welcome:"Bienvenido a HRM Finance",totalRevenue:"Ingresos Totales",overview:"Resumen",recentActivity:"Actividad Reciente",quickActions:"Acciones Rápidas",employeeCount:"Número de Empleados",pendingInvoices:"Facturas Pendientes",cashBalance:"Saldo en Efectivo",totalAssets:"Activos Totales",totalLiabilities:"Pasivos Totales",totalExpenses:"Gastos Totales",netIncome:"Ingreso Neto",netLoss:"Pérdida Neta",monthlyPayroll:"Nómina Mensual",current:"Actual",newHires:"+3 nuevas contrataciones",outstanding:"Pendiente",totalOutstanding:"$23,450 total",lastUpdatedToday:"Última actualización hoy",commonTasks:"Tareas comunes",generateReport:"Generar Reporte",latestUpdates:"Últimas actualizaciones",invoicePaid:"Factura #1234 pagada",hoursAgo:"hace 2 horas",newEmployeeOnboarded:"Nuevo empleado incorporado",dayAgo:"hace 1 día",monthlyReportGenerated:"Reporte mensual generado",daysAgo:"hace 2 días"},accounts:{title:"Plan de Cuentas",accountNumber:"Número de Cuenta",accountName:"Nombre de Cuenta",accountType:"Tipo de Cuenta",category:"Categoría",balance:"Saldo",parentAccount:"Cuenta Padre",subAccounts:"Subcuentas",addAccount:"Agregar Cuenta",editAccount:"Editar Cuenta",deleteAccount:"Eliminar Cuenta",accountDetails:"Detalles de Cuenta",transactions:"Transacciones",accountHistory:"Historial de Cuenta",backToAccounts:"Volver a Cuentas",accountNotFound:"Cuenta no encontrada",accountInformation:"Información de Cuenta",accountPurpose:"Propósito de la cuenta",transactionHistory:"Historial de Transacciones",noTransactions:"No se encontraron transacciones para esta cuenta",createdDate:"Fecha de Creación",lastModified:"Última Modificación",noDescription:"No se proporcionó descripción.",totalCount:"Conteo total",basicDetails:"Detalles básicos",currentBalance:"Saldo actual",classification:"Clasificación",allTransactions:"Todas las transacciones de la cuenta",reference:"Referencia",types:{asset:"Activo",liability:"Pasivo",equity:"Patrimonio",revenue:"Ingreso",expense:"Gasto"},categories:{currentAssets:"Activos Corrientes",fixedAssets:"Activos Fijos",currentLiabilities:"Pasivos Corrientes",longTermLiabilities:"Pasivos a Largo Plazo",ownersEquity:"Patrimonio del Propietario",operatingRevenue:"Ingresos Operacionales",operatingExpenses:"Gastos Operacionales"}},inventory:{title:"Gestión de Inventario",overview:"Resumen",products:"Productos y Stock",movements:"Movimientos",locations:"Ubicaciones",bulkMovement:"Movimiento Masivo",addMovement:"Agregar Movimiento",addProduct:"Agregar Producto",addLocation:"Agregar Ubicación",singleMovement:"Agregar Movimiento Individual",addNewItem:"Agregar Nuevo Artículo",activeProducts:"Productos Activos",lowStockAlert:"Artículos con Stock Bajo",totalValue:"Valor Total del Stock",activeLocations:"Ubicaciones Activas",productsNeedRestocking:"productos necesitan reabastecimiento",recentMovements:"Movimientos Recientes",noProducts:"No hay productos en esta ubicación",productName:"Nombre del Producto",productCode:"Código del Producto",sku:"SKU",category:"Categoria",unitOfMeasure:"Unidad de Medida",unitCost:"Costo Unitario",minStockLevel:"Nivel Mínimo de Stock",maxStockLevel:"Nivel Máximo de Stock",locationName:"Nombre de Ubicación",locationType:"Tipo de Ubicación",locationCode:"Código de Ubicación",movementType:"Tipo de Movimiento",referenceNumber:"Número de Referencia",invoiceNumber:"Número de Factura",fromLocation:"Desde Ubicación",toLocation:"Hacia Ubicación",stockIn:"Entrada de Stock",stockOut:"Salida de Stock",transfer:"Transferencia",adjustment:"Ajuste",inStock:"En Stock",lowStock:"Stock Bajo",outOfStock:"Sin Stock",stockLevels:"Niveles de Stock",stockByLocation:"Stock por Ubicación",searchProducts:"Buscar productos...",searchLocations:"Buscar ubicaciones...",noMovements:"No se encontraron movimientos",productDetails:"Detalles del Producto",locationDetails:"Detalles de Ubicación",movementDetails:"Detalles del Movimiento",totalProducts:"Total de Productos",totalLocations:"Total de Ubicaciones",lastSeen:"Visto por última vez",warehouseType:"Almacén",storeType:"Tienda",supplierType:"Proveedor",customerType:"Cliente",currentlyManaged:"Gestionados actualmente",needAttention:"Necesitan atención",currentWorth:"Valor actual",warehousesStores:"Almacenes y tiendas",thisMonth:"Este Mes",latestActivities:"Últimas actividades de inventario",searchMovements:"Buscar Movimientos",countingSheet:"Hoja de Conteo",physicalCount:"Conteo Físico",physicalInventoryCount:"Conteo Físico de Inventario",setupPhysicalCount:"Configurar Conteo Físico de Inventario",setupDescription:"Configure los ajustes de su conteo físico de inventario y comience el proceso de conteo.",countWillInclude:"Este conteo incluirá {{count}} productos de {{location}} en la categoría {{category}}.",startCounting:"Iniciar Conteo Físico",counted:"Contado",remaining:"Restante",variances:"Variaciones",complete:"Completo",systemQty:"Cant. Sistema",variance:"Variación",addNotes:"Agregar notas...",reviewAndConfirm:"Revisar y Confirmar Ajustes",reviewDescription:"Revise los ajustes de inventario a continuación y confirme para actualizar su sistema.",stockIncreases:"Aumentos de Stock",stockDecreases:"Disminuciones de Stock",totalAdjustments:"Ajustes Totales",confirmAdjustments:"Confirmar Ajustes",adjustment:"Ajuste",perfectCount:"¡Conteo Perfecto!",noVariances:"No se encontraron variaciones. Su conteo físico coincide exactamente con el sistema.",physicalCountAdjustment:"Ajuste de conteo físico",inventoryCountingSheetTitle:"HOJA DE CONTEO DE INVENTARIO",location:"Ubicación",allCategories:"Todas las Categorías",countedBy:"Contado por",verifiedBy:"Verificado por",instructions:"Instrucciones",countInstructions:["Contar todos los artículos físicamente presentes en esta ubicación",'Escribir el conteo real en la columna "Conteo Físico"',"Dejar en blanco si el artículo no se encuentra",'Anotar cualquier discrepancia en la columna "Notas"',"Firmar y fechar cuando esté completo"],productName:"Nombre del Producto",unit:"Unidad",totalProductsListed:"Total de Productos Listados",itemsCounted:"Artículos Contados",discrepanciesFound:"Discrepancias Encontradas",counterSignature:"Firma del Contador",supervisorSignature:"Firma del Supervisor",downloadCSV:"Descargar CSV",noAdjustmentsToDownload:"No hay ajustes para descargar",stockIncrease:"Aumento de Stock",stockDecrease:"Disminución de Stock",purchaseReceive:"Compra/Recepción",saleIssue:"Venta/Emisión",transfer:"Transferencia",adjustment:"Ajuste",movementType:"Tipo de Movimiento",fromLocation:"Ubicación de Origen",toLocation:"Ubicación de Destino",searchSourceLocation:"Buscar ubicación de origen...",searchDestinationLocation:"Buscar ubicación de destino...",searchLocation:"Buscar ubicación...",addProduct:"Agregar Producto",searchProduct:"Buscar producto...",unitCost:"Costo Unitario",noProductsAdded:'No se han agregado productos aún. Haga clic en "Agregar Producto" para comenzar.',createMovement:"Crear Movimiento",generalNotesPlaceholder:"Ingrese notas generales para este movimiento...",sortBy:"Ordenar Por",allLocations:"Todas las Ubicaciones",searchByProduct:"Buscar por producto, ubicación, referencia, notas, factura...",allProducts:"Todos los Productos",allTypes:"Todos los Tipos",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",totalMovements:"Movimientos Totales",totalItems:"Artículos Totales",adjustMovements:"Intenta ajustar tus filtros o revisa más tarde.",inventoryMovements:"Movimientos de Inventario",createdBy:"Creado Por",view:"Ver",enhanced:"Mejorado",legacy:"Clásico",addSingleMovement:"Agregar Movimiento Individual",inStockSubtitle:"En stock",itemsBelowThreshold:"Artículos bajo el umbral",inventoryWorth:"Valor del inventario",quantity:"Cantidad",units:"unidades",normal:"Normal",productsAndStock:"Productos y Stock",lowStockItems:"Artículos con Stock Bajo",totalStockValue:"Valor Total del Stock",warehousesAndStores:"Almacenes y tiendas",andMore:"...y {count} más",latestInventoryActivities:"Últimas actividades de inventario",min:"Mín",max:"Máx",cost:"Costo",noProductsFound:"No se encontraron productos que coincidan con su búsqueda.",noProductsAvailable:"No hay productos disponibles.",noLocationsFound:"No se encontraron ubicaciones que coincidan con su búsqueda.",noLocationsAvailable:"No hay ubicaciones disponibles.",searchPlaceholder:"Buscar por producto, ubicación, referencia, notas, factura...",noMovementsFound:"No se encontraron movimientos",tryAdjustingFilters:"Intenta ajustar tus filtros o revisa más tarde.",transfers:"Transferencias",adjustments:"Ajustes",bulk:"Masivo",product:"Producto",location:"Ubicación",store:"Tienda",supplier:"Proveedor",warehouse:"Almacén",movement:"Movimiento",editMovement:"Editar Movimiento",updateMovement:"Actualizar Movimiento",movementInformation:"Información del Movimiento",locationInformation:"Información de Ubicación",searchProductsImages:"Buscar productos para ver imágenes...",searchForProducts:"Buscar Productos",startTypingToSearch:"Comienza a escribir para buscar y ver imágenes de productos",tryDifferentSearch:"Prueba con un término de búsqueda diferente"},employees:{title:"Gestión de Empleados",employeeList:"Lista de Empleados",addEmployee:"Agregar Empleado",editEmployee:"Editar Empleado",employeeDetails:"Detalles del Empleado",personalInfo:"Información Personal",employmentInfo:"Información Laboral",payrollInfo:"Información de Nómina",firstName:"Nombre",lastName:"Apellido",fullName:"Nombre Completo",email:"Correo Electrónico",phone:"Teléfono",address:"Dirección",dateOfBirth:"Fecha de Nacimiento",employeeId:"ID de Empleado",department:"Departamento",position:"Puesto",hireDate:"Fecha de Contratación",employmentStatus:"Estado Laboral",salary:"Salario",payFrequency:"Frecuencia de Pago",taxId:"ID Fiscal",bankAccount:"Cuenta Bancaria",emergencyContact:"Contacto de Emergencia",activeEmployees:"Empleados Activos",inactiveEmployees:"Empleados Inactivos",totalPayroll:"Nómina Total",searchEmployees:"Buscar empleados...",enterFullName:"Ingrese el nombre completo del empleado",enterPosition:"Ingrese el puesto de trabajo",enterEmail:"Ingrese la dirección de correo electrónico",enterPhone:"Ingrese el número de teléfono",enterSalary:"Ingrese el salario anual",departments:{engineering:"Ingeniería",product:"Producto",design:"Diseño",marketing:"Marketing",sales:"Ventas",humanResources:"Recursos Humanos",finance:"Finanzas",operations:"Operaciones",analytics:"Analítica"}},entryBooks:{title:"Libros de Entrada",bookName:"Nombre del Libro",bookType:"Tipo de Libro",createBook:"Crear Libro",editBook:"Editar Libro",salesBook:"Libro de Ventas",purchaseBook:"Libro de Compras",cashBook:"Libro de Caja",generalBook:"Libro General",entries:"Entradas",addEntry:"Agregar Entrada",period:"Período",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",bookBalance:"Saldo del Libro",reconciledBalance:"Saldo Conciliado",difference:"Diferencia",reconcile:"Conciliar",isReconciled:"Está Conciliado",noBooks:"No se encontraron libros de entrada",createFirst:"Crea tu primer libro de entrada para comenzar",bookDetails:"Detalles del Libro",entriesCount:"entradas",bookOverview:"Resumen y detalles del libro",bookEntries:"Entradas del Libro",allEntries:"Todas las entradas en este libro",noEntries:"No se encontraron entradas",addFirst:"Agrega tu primera entrada a este libro",entryDate:"Fecha de Entrada",entryDescription:"Descripción de Entrada",entryAmount:"Monto de Entrada",entryReference:"Referencia de Entrada"},banking:{title:"Consolidación Bancaria",bankAccount:"Cuenta Bancaria",statementDate:"Fecha del Estado",beginningBalance:"Saldo Inicial",endingBalance:"Saldo Final",deposits:"Depósitos",withdrawals:"Retiros",bankCharges:"Cargos Bancarios",interest:"Intereses",reconcile:"Conciliar",matched:"Conciliado",unmatched:"No Conciliado",importStatement:"Importar Estado",manualEntry:"Entrada Manual",autoMatch:"Coincidencia Automática",clearAll:"Limpiar Todo",reconciliationStatus:"Estado de Conciliación",difference:"Diferencia",bookBalance:"Saldo en Libros",statementBalance:"Saldo del Estado",outstandingChecks:"Cheques Pendientes",depositsInTransit:"Depósitos en Tránsito",reconciled:"Conciliado",notReconciled:"No Conciliado",unreconciled:"No Conciliado",reconciliation:"Conciliación",compareStatements:"Comparar estados bancarios con registros de libros de entrada",importCSV:"Importar CSV",startNewReconciliation:"Iniciar Nueva Conciliación",bankAccountInfo:"Información de Cuenta Bancaria",currentAccountDetails:"Detalles de cuenta actual",lastReconciled:"Última conciliación",bankTransactions:"Transacciones Bancarias",selectedPeriod:"Período seleccionado",pending:"pendiente",bookEntriesForComparison:"Entradas de libros para comparación",reconciliationRate:"Tasa de Conciliación",completionStatus:"Estado de finalización",recentReconciliationSessions:"Sesiones de Conciliación Recientes",latestActivity:"Actividad reciente",noRecentSessions:"No se encontraron sesiones de conciliación recientes.",startFirstReconciliation:"Iniciar Primera Conciliación",entryBookRecords:"Registros de Libros de Entrada",pleaseUploadCSV:"Por favor suba un archivo CSV",csvRequiresHeaderAndData:"El archivo CSV debe tener al menos un encabezado y una fila de datos",successfullyParsed:"Se analizaron exitosamente {count} filas",errorParsingCSV:"Error al analizar el archivo CSV. Verifique el formato.",dateDescriptionRequired:"Las columnas de Fecha y Descripción son requeridas",importedTransaction:"Transacción importada",successfullyImported:"Se importaron exitosamente {count} transacciones bancarias",errorImportingTransactions:"Error al importar transacciones. Verifique sus datos.",importBankStatementCSV:"Importar CSV de Estado Bancario",dropCSVHere:"Suelte el archivo CSV aquí",clickToUploadCSV:"Haga clic para cargar o arrastre y suelte el archivo CSV",supportedFormat:"Formato soportado: CSV con columnas de Fecha, Descripción y Monto",mapCSVColumns:"Mapear Columnas CSV",dateColumn:"Columna de Fecha",selectColumn:"Seleccionar columna...",descriptionColumn:"Columna de Descripción",referenceColumn:"Columna de Referencia",amountDebitColumn:"Columna de Monto/Débito",creditColumn:"Columna de Crédito",balanceColumn:"Columna de Saldo",andMoreRows:"... y {count} filas más",importing:"Importando...",importTransactions:"Importar {count} Transacciones",reconciliationComparison:"Comparación de Conciliación",bankStatements:"Estados Bancarios",totalTransactions:"Transacciones totales",totalEntries:"Entradas totales",unreconciledBank:"Banco No Conciliado",unreconciledBooks:"Libros No Conciliados",needAttention:"Necesitan atención",unreconcile:"Desconciliar",clickToReconcile:"Hacer clic para conciliar",potentialMatchesFound:"Coincidencias Potenciales Encontradas",clickRecordToReconcile:"Haga clic en un registro a continuación para conciliar",exactMatch:"Coincidencia Exacta",possibleMatch:"Posible Coincidencia",selected:"Seleccionado",clearSelection:"Limpiar Selección"},journal:{title:"Asientos Contables",entryNumber:"Número de Asiento",entryDate:"Fecha del Asiento",debit:"Débito",credit:"Crédito",account:"Cuenta",memo:"Memo",reference:"Referencia",createEntry:"Crear Asiento",editEntry:"Editar Asiento",deleteEntry:"Eliminar Asiento",posted:"Registrado",draft:"Borrador",reversed:"Revertido",recurringEntry:"Asiento Recurrente",attachments:"Adjuntos",totalDebits:"Débitos Totales",totalCredits:"Créditos Totales",outOfBalance:"Desbalanceado",balanced:"Balanceado"},forms:{requiredField:"Este campo es requerido",invalidEmail:"Dirección de correo inválida",invalidNumber:"Número inválido",invalidDate:"Fecha inválida",selectOption:"Por favor seleccione una opción",enterValue:"Por favor ingrese un valor",confirmDelete:"¿Está seguro de que desea eliminar este elemento?",unsavedChanges:"Tiene cambios sin guardar. ¿Desea continuar?",saveSuccess:"Guardado exitosamente",saveError:"Error al guardar datos",deleteSuccess:"Eliminado exitosamente",deleteError:"Error al eliminar elemento",duplicateAccountNumber:"El número de cuenta ya existe"},modals:{addInventory:"Agregar Movimiento de Inventario",bulkMovement:"Movimiento Masivo de Inventario",addProduct:"Agregar Nuevo Producto",addLocation:"Agregar Nueva Ubicación",inventoryDetail:"Detalles del Artículo de Inventario",quickAdd:"Agregar Rápido",selectProduct:"Seleccionar Producto",selectLocation:"Seleccionar Ubicación",enterQuantity:"Ingresar cantidad",enterCost:"Ingresar costo unitario",enterReference:"Ingresar número de referencia",addNotes:"Agregar notas (opcional)",generalInformation:"Información General",stockInformation:"Información de Stock",locationInformation:"Información de Ubicación",movementInformation:"Información de Movimiento",addToInventory:"Agregar al Inventario",createProduct:"Crear Producto",createLocation:"Crear Ubicación",processing:"Procesando...",addingMovement:"Agregando movimiento...",creatingProduct:"Creando producto...",creatingLocation:"Creando ubicación..."},products:{title:"Productos",addNew:"Agregar Nuevo Producto",totalProducts:"Total de Productos",inCatalog:"En catálogo",activeProducts:"Productos Activos",currentlyAvailable:"Actualmente disponibles",outOfStock:"Sin Stock",needsRestock:"Necesita reabastecimiento",productCatalog:"Catálogo de Productos",manageYourProducts:"Gestiona tus productos y precios",inStock:"En Stock",furniture:"Muebles",electronics:"Electrónicos",supplies:"Suministros",lighting:"Iluminación"},invoices:{title:"Panel de Facturas",invoice:"Factura",invoiceNumber:"Número de Factura",invoiceDetails:"Detalles de Factura",customerInformation:"Información del Cliente",customerName:"Nombre del Cliente",legalName:"Nombre Legal",contactInformation:"Información de Contacto",idPassport:"ID/Pasaporte",phoneNumber:"Número de Teléfono",altPhone:"Teléfono Alt.",address:"Dirección",between:"Entre",and:"y",products:"Productos",reservations:"Reservaciones",unitPrice:"Precio Unitario",total:"Total",subtotal:"Subtotal",category:"Categoria",totalRevenue:"Ingresos Totales",totalProducts:"Total de Productos",totalReservations:"Total de Reservaciones",aranceles:"Aranceles (Aduanas)",uniqueCustomers:"Clientes Únicos",averageInvoice:"Factura Promedio",completed:"Completada",pending:"Pendiente",storesActive:"Tiendas Activas",topProducts:"Productos Principales",mostSoldProducts:"Productos más vendidos por cantidad",reservationsByType:"Reservaciones por Tipo",distributionOfCategories:"Distribución de categorías de reservaciones",recentInvoices:"Facturas Recientes",showingInvoices:"Mostrando {{count}} facturas",date:"Fecha",customer:"Cliente",store:"Tienda",actions:"Acciones",view:"Ver",status:"Estado",printInvoice:"Imprimir Factura",exportPdf:"Exportar PDF",backToDashboard:"Volver al Panel",fromInvoices:"De {{count}} facturas",value:"valor",activeCustomers:"Clientes activos",perInvoiceValue:"Valor por factura",locations:"Ubicaciones",mostRecentActivity:"Actividad más reciente",storeLocation:"Ubicación de Tienda",allStores:"Todas las Tiendas",fromDate:"Fecha Desde",toDate:"Fecha Hasta",clearFilters:"Limpiar Filtros",customsFees:"Aranceles totales",salesType:"VENTAS",packagesOrder:"Orden de Paquetes",businessId:"ID de Negocio",orderKey:"Clave de Orden",reservationType:"Tipo de Reservación",arancel:"Arancel",key:"Clave",noInvoicesFound:"No se encontraron facturas",loadingInvoices:"Cargando facturas...",errorLoadingInvoices:"Error al cargar facturas",refreshData:"Actualizar Datos",currentStockValue:"Valor de Stock Actual",filterByStore:"Filtrar por tienda",filterByDate:"Filtrar por rango de fechas",totalCustomsFees:"Aranceles totales",averageValue:"Valor promedio",senderInformation:"Información del Remitente",receiptInformation:"Información del Destinatario",productsSubtotal:"Subtotal de Productos",reservationsSubtotal:"Subtotal de Reservaciones",code:"Código",description:"Descripción",qty:"Cant.",type:"Tipo",id:"ID",passport:"Pasaporte"},unauthorized:{title:"Acceso Restringido",accessDenied:"Acceso Denegado",noPermission:"No tienes permisos para acceder a",thisFeature:"esta funcionalidad",whySeeing:"¿Por qué veo esto?",explanation:"Tu cuenta no tiene los permisos necesarios para ver este contenido.",requiredPermission:"Permiso requerido:",goToDashboard:"Ir al Panel de Control",goBack:"Regresar",featuresCanAccess:"Funcionalidades a las que puedes acceder:",dashboardAccess:"Panel de control y estadísticas generales",profileAccess:"Tu perfil y configuraciones",roleBasedAccess:"Funcionalidades habilitadas para tu rol",needAccess:"¿Necesitas acceso? Contacta a tu administrador o gerente para solicitar los permisos apropiados.",permissions:{accountAccess:"Acceso a Gestión de Cuentas",inventoryAccess:"Acceso a Inventario",employeeAccess:"Acceso a Recursos Humanos",bankingAccess:"Acceso Bancario",journalAccess:"Acceso a Asientos Contables",adminAccess:"Acceso Administrativo",financialReporting:"Acceso a Reportes Financieros",invoiceManagement:"Acceso a Gestión de Facturas",productManagement:"Acceso a Gestión de Productos"}}}},Lw=()=>{if(typeof window<"u"){const t=localStorage.getItem("hrmfinance-language");if(t&&["en","es"].includes(t))return t}return"en"},[Uh,Mw]=ve(Lw()),ct=()=>({t:(n,o,i)=>{const a=Uh(),c=n.split(".");let d=Nw[a];for(const m of c)if(d&&typeof d=="object"&&m in d)d=d[m];else return o||n;let h=typeof d=="string"?d:o||n;return i&&typeof h=="string"&&Object.keys(i).forEach(m=>{const g=i[m],_=`{{${m}}}`;h=h.replace(new RegExp(_,"g"),String(g))}),h},language:()=>Uh(),setLanguage:n=>{Mw(n),typeof window<"u"&&localStorage.setItem("hrmfinance-language",n)}});var Ow=q("<div><label></label><select><option value>"),Vw=q("<span>*"),Bw=q("<option>");const gr=t=>{const{t:e}=ct(),r={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},n={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},o={"margin-bottom":"1rem"};return(()=>{var i=Ow(),a=i.firstChild,c=a.nextSibling,d=c.firstChild;return u(i,o),u(a,r),s(a,()=>t.label,null),s(a,(()=>{var h=ye(()=>!!t.required);return()=>h()&&(()=>{var m=Vw();return m.style.setProperty("color","var(--primary-color)"),m})()})(),null),c.addEventListener("blur",h=>h.target.style.borderColor="var(--border-color)"),c.addEventListener("focus",h=>h.target.style.borderColor="var(--primary-color)"),c.addEventListener("change",h=>t.onChange(h.target.value)),u(c,n),s(d,()=>e("forms.selectOption")),s(c,()=>t.options.map(h=>(()=>{var m=Bw();return s(m,()=>h.label),ie(()=>m.value=h.value),m})()),null),ie(h=>{var m=t.required,g=t.disabled;return m!==h.e&&(c.required=h.e=m),g!==h.t&&(c.disabled=h.t=g),h},{e:void 0,t:void 0}),ie(()=>c.value=t.value),i})()};var Fw=q("<main><div>"),Uw=q("<header><h1>");const Lr=t=>{const e={"min-height":"100vh",background:"var(--background-color)"},r={"max-width":"1200px",margin:"0 auto",padding:"2rem"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},o={"font-size":"2rem","font-weight":"700",color:"var(--text-primary)",margin:"0"};return(()=>{var i=Fw(),a=i.firstChild;return u(i,e),u(a,r),s(a,(()=>{var c=ye(()=>!!t.title);return()=>c()&&(()=>{var d=Uw(),h=d.firstChild;return u(d,n),u(h,o),s(h,()=>t.title),d})()})(),null),s(a,()=>t.children,null),i})()};var jw=q("<div><span></span><select><option value=en>🇺🇸 </option><option value=es>🇪🇸 ");const zw=()=>{const{t,language:e,setLanguage:r}=ct(),n={display:"flex","align-items":"center",gap:"0.5rem","margin-left":"auto"},o={padding:"0.5rem 1rem","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",background:"var(--surface-color)",color:"var(--text-primary)",cursor:"pointer","font-size":"0.875rem","font-weight":"500",transition:"all 0.2s ease","min-width":"120px"},i={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},a=c=>{const d=c.target;r(d.value)};return(()=>{var c=jw(),d=c.firstChild,h=d.nextSibling,m=h.firstChild;m.firstChild;var g=m.nextSibling;return g.firstChild,u(c,n),u(d,i),h.addEventListener("change",a),u(h,o),s(m,()=>t("common.english"),null),s(g,()=>t("common.spanish"),null),ie(()=>h.value=e()),c})()};var jh=q('<img alt="User avatar">'),qw=q("<div class=user-info-desktop><span>"),Gw=q("<button class=sign-out-desktop>Sign Out"),Hw=q("<div><div><span></span></div><button>Sign Out"),Yw=q(`<nav><div><div class=desktop-nav></div><div><button class=mobile-menu-button><svg width=24 height=24 viewBox="0 0 24 24"fill=currentColor><path></path></svg></button></div></div><div class=mobile-nav></div><style>
        .nav-active {
          background: linear-gradient(135deg, var(--primary-color), var(--primary-dark)) !important;
          color: white !important;
          box-shadow: var(--shadow-sm);
        }
        
        .desktop-nav a:hover:not(.nav-active),
        .nav-group button:hover {
          background: var(--background-color);
          color: var(--text-primary);
        }
        
        .mobile-nav a:hover:not(.nav-active) {
          background: var(--background-color);
          color: var(--text-primary);
        }

        /* Create invisible bridge to prevent gap issues */
        .nav-group::before {
          content: '';
          position: absolute;
          top: 100%;
          left: 0;
          right: 0;
          height: 0.5rem;
          z-index: 9;
        }
        
        @media (max-width: 768px) {
          .desktop-nav {
            display: none !important;
          }
          
          .mobile-menu-button {
            display: block !important;
          }
          
          .user-info-desktop,
          .sign-out-desktop {
            display: none !important;
          }
          
          nav > div:first-child {
            padding: 1rem;
          }
        }
        
        @media (min-width: 769px) {
          .mobile-nav {
            display: none !important;
          }
        }
      `),Ww=q("<div class=nav-group><button> <span>▼</span></button><div>"),Kw=q("<div>"),Qw=q("<div><div><span> </span><span>▼");const Jw=()=>{const{t}=ct(),[e,r]=ve(!1),[n,o]=ve(null),[i,a]=ve(null),c={background:"var(--surface-color)","border-bottom":"1px solid var(--border-color)","box-shadow":"var(--shadow-sm)","backdrop-filter":"blur(10px)",position:"sticky",top:"0","z-index":"100"},d={display:"flex","align-items":"center","justify-content":"space-between",padding:"1rem 2rem",margin:"0 auto",position:"relative"},h={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","text-decoration":"none"},m={display:"flex",gap:"1rem","align-items":"center",flex:"1","margin-left":"2rem"},g={display:"none",position:"absolute",top:"100%",left:"0",right:"0",background:"var(--surface-color)","border-top":"1px solid var(--border-color)","box-shadow":"var(--shadow-md)","max-height":"70vh","overflow-y":"auto"},_={position:"relative",display:"flex","align-items":"center"},A={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem",background:"transparent",border:"none",color:"var(--text-secondary)","font-weight":"500","font-size":"0.875rem",cursor:"pointer","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease","white-space":"nowrap"},L={position:"absolute",top:"100%",left:"0",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)","min-width":"200px","margin-top":"0.25rem","z-index":"10",display:"none","padding-top":"0.25rem"},M={"border-bottom":"1px solid var(--border-color)"},$={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",cursor:"pointer","font-weight":"600",color:"var(--text-primary)"},T={display:"block","text-decoration":"none",color:"var(--text-secondary)",padding:"0.75rem 1rem","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease","white-space":"nowrap"},ee={...T,padding:"0.75rem 1.5rem","border-bottom":"1px solid var(--border-light)"},ce={display:"none",background:"transparent",border:"none",padding:"0.5rem",cursor:"pointer",color:"var(--text-primary)"},Z={display:"flex","align-items":"center",gap:"1rem"},ge={display:"flex","align-items":"center",gap:"0.75rem",padding:"0.5rem 1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",color:"var(--text-primary)"},ne={width:"32px",height:"32px","border-radius":"50%","object-fit":"cover"},w={...T,cursor:"pointer",border:"1px solid var(--border-color)",background:"transparent","border-radius":"var(--border-radius-sm)"},S=()=>{Pt.signOut()},p=E=>{const F=Pt.state?.profile;return F?F[E]===!0||F.isAdmin===!0:!1},C=()=>{r(!e())},P=E=>{o(n()===E?null:E)},x=E=>{const F=i();F&&(clearTimeout(F),a(null)),o(E)},y=()=>{const E=setTimeout(()=>{o(null)},300);a(E)},ue=[{name:"Finance",icon:"💰",items:[{path:"/accounts",label:t("navigation.accounts"),permission:"AccountAccess",icon:"📊"},{path:"/balance-sheet",label:t("navigation.balanceSheet"),permission:"AccountAccess",icon:"📈"},{path:"/bank-consolidations",label:t("navigation.consolidate"),permission:"BankingAccess",icon:"🏦"}]},{name:"Operations",icon:"📦",items:[{path:"/inventory",label:t("navigation.inventory"),permission:"InventoryAccess",icon:"📦"},{path:"/entry-books",label:t("navigation.entryBooks"),permission:"JournalAccess",icon:"📚"}]},{name:"Management",icon:"👥",items:[{path:"/employees",label:t("navigation.employees"),permission:"EmployeeAccess",icon:"👷"},{path:"/admin/users",label:"Admin",permission:"isAdmin",icon:"👑",adminOnly:!0}]}],J=()=>ue.map(E=>({...E,items:E.items.filter(F=>F.adminOnly?Pt.state?.profile?.isAdmin:p(F.permission))})).filter(E=>E.items.length>0);return(()=>{var E=Yw(),F=E.firstChild,z=F.firstChild,B=z.nextSibling,k=B.firstChild,U=k.firstChild,he=U.firstChild,H=F.nextSibling;return s(F,v(Yo,{href:"/",style:h,children:"HRM Finance"}),z),u(z,m),s(z,v(Yo,{href:"/",style:T,activeClass:"nav-active",get children(){return["🏠 ",ye(()=>t("navigation.dashboard"))]}}),null),s(z,v(pt,{get each(){return J()},children:le=>(()=>{var I=Ww(),j=I.firstChild,K=j.firstChild,R=K.nextSibling,X=j.nextSibling;return I.addEventListener("mouseleave",y),I.addEventListener("mouseenter",()=>x(le.name)),s(j,()=>le.icon,K),s(j,()=>le.name,R),R.style.setProperty("font-size","0.75rem"),X.addEventListener("mouseleave",y),X.addEventListener("mouseenter",()=>x(le.name)),s(X,v(pt,{get each(){return le.items},children:O=>v(Yo,{get href(){return O.path},style:T,activeClass:"nav-active",onClick:()=>o(null),get children(){return[ye(()=>O.icon)," ",ye(()=>O.label)]}})})),ie(O=>{var N=_,te=A,de={...L,display:n()===le.name?"block":"none"};return O.e=u(I,N,O.e),O.t=u(j,te,O.t),O.a=u(X,de,O.a),O},{e:void 0,t:void 0,a:void 0}),I})()}),null),u(B,Z),s(B,v(zw,{}),k),s(B,v(Ne,{get when(){return Pt.currentUser},get children(){return[(()=>{var le=qw(),I=le.firstChild;return s(le,v(Ne,{get when(){return Pt.currentUser?.photoURL},get children(){var j=jh();return ie(K=>{var R=Pt.currentUser.photoURL,X=ne;return R!==K.e&&ut(j,"src",K.e=R),K.t=u(j,X,K.t),K},{e:void 0,t:void 0}),j}}),I),s(I,()=>Pt.currentUser?.displayName||Pt.currentUser?.email),ie(j=>u(le,ge,j)),le})(),(()=>{var le=Gw();return le.addEventListener("mouseleave",I=>{I.currentTarget.style.background="transparent",I.currentTarget.style.color="var(--text-secondary)"}),le.addEventListener("mouseenter",I=>{I.currentTarget.style.background="var(--background-color)",I.currentTarget.style.color="var(--text-primary)"}),le.$$click=S,ie(I=>u(le,w,I)),le})()]}}),k),k.$$click=C,u(k,ce),s(H,v(Yo,{href:"/",style:ee,activeClass:"nav-active",onClick:()=>r(!1),get children(){return["🏠 ",ye(()=>t("navigation.dashboard"))]}}),null),s(H,v(pt,{get each(){return J()},children:le=>(()=>{var I=Qw(),j=I.firstChild,K=j.firstChild,R=K.firstChild,X=K.nextSibling;return u(I,M),j.$$click=()=>P(le.name),u(j,$),s(K,()=>le.icon,R),s(K,()=>le.name,null),X.style.setProperty("transition","transform 0.2s"),s(I,v(Ne,{get when(){return n()===le.name},get children(){var O=Kw();return O.style.setProperty("background","var(--background-color)"),s(O,v(pt,{get each(){return le.items},children:N=>v(Yo,{get href(){return N.path},get style(){return{...ee,"padding-left":"3rem"}},activeClass:"nav-active",onClick:()=>r(!1),get children(){return[ye(()=>N.icon)," ",ye(()=>N.label)]}})})),O}}),null),ie(O=>(O=n()===le.name?"rotate(180deg)":"none")!=null?X.style.setProperty("transform",O):X.style.removeProperty("transform")),I})()}),null),s(H,v(Ne,{get when(){return Pt.currentUser},get children(){var le=Hw(),I=le.firstChild,j=I.firstChild,K=I.nextSibling;return le.style.setProperty("padding","1rem"),le.style.setProperty("border-top","2px solid var(--border-color)"),s(I,v(Ne,{get when(){return Pt.currentUser?.photoURL},get children(){var R=jh();return ie(X=>{var O=Pt.currentUser.photoURL,N=ne;return O!==X.e&&ut(R,"src",X.e=O),X.t=u(R,N,X.t),X},{e:void 0,t:void 0}),R}}),j),s(j,()=>Pt.currentUser?.displayName||Pt.currentUser?.email),K.$$click=()=>{S(),r(!1)},ie(R=>{var X={...ge,"margin-bottom":"1rem"},O={...w,width:"100%"};return R.e=u(I,X,R.e),R.t=u(K,O,R.t),R},{e:void 0,t:void 0}),le}}),null),ie(le=>{var I=c,j=d,K=e()?"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z":"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z",R={...g,display:e()?"block":"none"};return le.e=u(E,I,le.e),le.t=u(F,j,le.t),K!==le.a&&ut(he,"d",le.a=K),le.o=u(H,R,le.o),le},{e:void 0,t:void 0,a:void 0,o:void 0}),E})()};Et(["click"]);var Xw=q("<div><div><div>🔒</div><h1></h1><p>.</p><div><p><strong></strong><br></p></div><div><button></button></div><div><h3></h3><div><span>✓</span><span></span></div><div><span>✓</span><span></span></div><div><span>✓</span><span></span></div></div><div><p>"),zh=q("<br>"),Zw=q("<strong>");const eC=t=>{const{t:e}=ct(),r={"min-height":"calc(100vh - 200px)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},n={"text-align":"center","max-width":"600px",width:"100%"},o={"font-size":"5rem",color:"#e53e3e","margin-bottom":"2rem"},i={"font-size":"2.5rem","font-weight":"700",color:"#1a202c","margin-bottom":"1rem"},a={"font-size":"1.25rem",color:"#718096","margin-bottom":"2rem","line-height":"1.6"},c={background:"#f7fafc",border:"1px solid #e2e8f0","border-radius":"0.5rem",padding:"1.5rem","margin-bottom":"2rem"},d={color:"#4a5568","font-size":"1rem","line-height":"1.6"},h={display:"flex",gap:"1rem","justify-content":"center","flex-wrap":"wrap"},m={padding:"0.75rem 2rem","border-radius":"0.5rem","text-decoration":"none","font-weight":"500",transition:"all 0.2s",display:"inline-block"},g={...m,background:"var(--primary-color)",color:"white",border:"2px solid var(--primary-color)"},_={...m,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},A={"text-align":"left","margin-top":"2rem",padding:"0 2rem"},L={display:"flex","align-items":"center",gap:"0.75rem","margin-bottom":"1rem",color:"#4a5568"},M={color:"#48bb78","font-size":"1.25rem"};return v(Lr,{get title(){return e("unauthorized.title")},get children(){var $=Xw(),T=$.firstChild,ee=T.firstChild,ce=ee.nextSibling,Z=ce.nextSibling,ge=Z.firstChild,ne=Z.nextSibling,w=ne.firstChild,S=w.firstChild;S.nextSibling;var p=ne.nextSibling,C=p.firstChild,P=p.nextSibling,x=P.firstChild,y=x.nextSibling,ue=y.firstChild,J=ue.nextSibling,E=y.nextSibling,F=E.firstChild,z=F.nextSibling,B=E.nextSibling,k=B.firstChild,U=k.nextSibling,he=P.nextSibling,H=he.firstChild;return u($,r),u(T,n),u(ee,o),u(ce,i),s(ce,()=>e("unauthorized.accessDenied")),u(Z,a),s(Z,()=>e("unauthorized.noPermission"),ge),s(Z,(()=>{var le=ye(()=>!!t.featureName);return()=>le()?` ${t.featureName}`:` ${e("unauthorized.thisFeature")}`})(),ge),u(ne,c),u(w,d),s(S,()=>e("unauthorized.whySeeing")),s(w,()=>e("unauthorized.explanation"),null),s(w,(()=>{var le=ye(()=>!!t.requiredPermission);return()=>le()&&[zh(),zh(),(()=>{var I=Zw();return s(I,()=>e("unauthorized.requiredPermission")),I})()," ",ye(()=>t.requiredPermission)]})(),null),u(p,h),s(p,v(Yo,{href:"/",style:g,get children(){return e("unauthorized.goToDashboard")}}),C),C.$$click=()=>window.history.back(),s(C,()=>e("unauthorized.goBack")),u(P,A),x.style.setProperty("margin-bottom","1rem"),x.style.setProperty("color","#2d3748"),s(x,()=>e("unauthorized.featuresCanAccess")),s(J,()=>e("unauthorized.dashboardAccess")),s(z,()=>e("unauthorized.profileAccess")),s(U,()=>e("unauthorized.roleBasedAccess")),he.style.setProperty("margin-top","3rem"),he.style.setProperty("padding","1.5rem"),he.style.setProperty("background","#edf2f7"),he.style.setProperty("border-radius","0.5rem"),H.style.setProperty("color","#4a5568"),H.style.setProperty("font-size","0.875rem"),s(H,()=>e("unauthorized.needAccess")),ie(le=>{var I=_,j=L,K=M,R=L,X=M,O=L,N=M;return le.e=u(C,I,le.e),le.t=u(y,j,le.t),le.a=u(ue,K,le.a),le.o=u(E,R,le.o),le.i=u(F,X,le.i),le.n=u(B,O,le.n),le.s=u(k,N,le.s),le},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),$}})};Et(["click"]);const rn=t=>{const{t:e}=ct(),r=()=>{if(!t.permission)return!0;const o=Pt.state?.profile;if(!o)return!1;switch(t.permission){case"AccountAccess":return o.AccountAccess===!0;case"InventoryAccess":return o.InventoryAccess===!0;case"EmployeeAccess":return o.EmployeeAccess===!0;case"BankingAccess":return o.BankingAccess===!0;case"JournalAccess":return o.JournalAccess===!0;case"AdminAccess":return o.isAdmin===!0;default:return o[t.permission]===!0}},n=()=>{if(t.requiredPermission)return t.requiredPermission;switch(t.permission){case"AccountAccess":return e("unauthorized.permissions.accountAccess");case"InventoryAccess":return e("unauthorized.permissions.inventoryAccess");case"EmployeeAccess":return e("unauthorized.permissions.employeeAccess");case"BankingAccess":return e("unauthorized.permissions.bankingAccess");case"JournalAccess":return e("unauthorized.permissions.journalAccess");case"AdminAccess":return e("unauthorized.permissions.adminAccess");default:return t.permission}};return v(Ne,{get when(){return r()},get fallback(){return t.fallback||v(eC,{get featureName(){return t.featureName},get requiredPermission(){return n()}})},get children(){return t.children}})};var tC=q('<button title="Open Dev Tools">🛠️'),rC=q("<span>(<!>)"),nC=q("<div><span></span><span>"),qh=q("<div>"),oC=q("<div>Database reset only available in fake mode"),iC=q("<div><div>Loading..."),sC=q("<div><div><h3>🛠️ Dev Tools</h3><button>✕</button></div><div><div>API Mode</div><div><button>Fake Server</button><button>Real API</button><button>Hybrid</button></div><div>Current: <strong></strong></div></div><div><div>Health Status</div></div><div><div>Database Stats</div></div><div><div>Actions</div><div><button>🔄 Refresh Stats</button><button>💊 Health Check</button></div><div><button>🗑️ Reset DB</button></div></div><div><div>Info</div><div>• <strong>Fake Server:</strong> Uses local mock data<br>• <strong>Real API:</strong> Connects to actual backend<br>• <strong>Hybrid:</strong> Real API with fake fallback<br>• Settings are saved in localStorage"),aC=q("<div>Loading..."),lC=q("<div><span>:</span><span>");const cC=()=>{const[t,e]=ve(!1),[r,n]=ve(Zi.getMode()),[o,i]=ve({}),[a,c]=ve(null),[d,h]=ve(!1);Hr(async()=>{await m(),await g()});const m=async()=>{try{const w=await dd.getStats();i(w)}catch(w){console.error("Failed to load stats:",w)}},g=async()=>{try{const w=await dd.healthCheck();c(w)}catch(w){console.error("Health check failed:",w),c({status:"error",error:w.message})}},_=async w=>{h(!0);try{Zi.setMode(w),n(w),await m(),await g()}catch(S){console.error("Failed to change API mode:",S)}finally{h(!1)}},A=async()=>{if(confirm("Are you sure you want to reset the fake database to its initial state?")){h(!0);try{const w=await Vr.utils.resetDatabase();alert(w.message),await m()}catch(w){console.error("Failed to reset database:",w),alert("Failed to reset database")}finally{h(!1)}}},L={position:"fixed",bottom:"20px",right:"20px","z-index":"10000","font-family":"monospace"},M={background:"#1a1a1a",color:"#fff",border:"1px solid #333","border-radius":"8px",padding:"16px","min-width":"300px","max-width":"400px","box-shadow":"0 4px 20px rgba(0,0,0,0.3)"},$={background:"#007acc",color:"#fff",border:"none","border-radius":"50%",width:"50px",height:"50px",cursor:"pointer","font-size":"20px","box-shadow":"0 2px 10px rgba(0,0,0,0.2)",display:"flex","align-items":"center","justify-content":"center"},T={background:"#333",color:"#fff",border:"1px solid #555","border-radius":"4px",padding:"6px 12px",cursor:"pointer","font-size":"12px","margin-right":"8px","margin-bottom":"8px"},ee={...T,background:"#007acc","border-color":"#007acc"},ce={"margin-bottom":"16px","padding-bottom":"12px","border-bottom":"1px solid #333"},Z={"font-size":"14px","font-weight":"bold","margin-bottom":"8px",color:"#007acc"},ge={display:"flex","justify-content":"space-between","font-size":"12px","margin-bottom":"4px"},ne=w=>({display:"inline-block",width:"8px",height:"8px","border-radius":"50%","margin-right":"8px",background:w==="healthy"?"#00ff00":w==="error"?"#ff0000":"#ffff00"});return(()=>{var w=qh();return s(w,v(Ne,{get when(){return!t()},get children(){var S=tC();return S.$$click=()=>e(!0),u(S,$),S}}),null),s(w,v(Ne,{get when(){return t()},get children(){var S=sC(),p=S.firstChild,C=p.firstChild,P=C.nextSibling,x=p.nextSibling,y=x.firstChild,ue=y.nextSibling,J=ue.firstChild,E=J.nextSibling,F=E.nextSibling,z=ue.nextSibling,B=z.firstChild,k=B.nextSibling,U=x.nextSibling,he=U.firstChild,H=U.nextSibling,le=H.firstChild,I=H.nextSibling,j=I.firstChild,K=j.nextSibling,R=K.firstChild,X=R.nextSibling,O=K.nextSibling,N=O.firstChild,te=I.nextSibling,de=te.firstChild,pe=de.nextSibling;return u(S,M),p.style.setProperty("display","flex"),p.style.setProperty("justify-content","space-between"),p.style.setProperty("align-items","center"),p.style.setProperty("margin-bottom","16px"),C.style.setProperty("margin","0"),C.style.setProperty("color","#007acc"),C.style.setProperty("font-size","16px"),P.$$click=()=>e(!1),J.$$click=()=>_("fake"),E.$$click=()=>_("real"),F.$$click=()=>_("hybrid"),z.style.setProperty("font-size","11px"),z.style.setProperty("color","#888"),z.style.setProperty("margin-top","4px"),s(k,r),s(z,()=>r()==="fake"&&" (Using fake server)",null),s(z,()=>r()==="real"&&" (Using real API)",null),s(z,()=>r()==="hybrid"&&" (Real API with fallback)",null),s(U,v(Ne,{get when(){return a()},get fallback(){return(()=>{var se=aC();return se.style.setProperty("font-size","12px"),se})()},get children(){return[(()=>{var se=nC(),Y=se.firstChild,D=Y.nextSibling;return se.style.setProperty("display","flex"),se.style.setProperty("align-items","center"),se.style.setProperty("font-size","12px"),s(D,()=>a()?.status||"Unknown"),s(se,v(Ne,{get when(){return a()?.timestamp},get children(){var Q=rC(),W=Q.firstChild,me=W.nextSibling;return me.nextSibling,Q.style.setProperty("margin-left","8px"),Q.style.setProperty("color","#888"),s(Q,()=>new Date(a().timestamp).toLocaleTimeString(),me),Q}}),null),ie(Q=>u(Y,ne(a()?.status||"unknown"),Q)),se})(),v(Ne,{get when(){return a()?.error},get children(){var se=qh();return se.style.setProperty("font-size","11px"),se.style.setProperty("color","#ff6666"),se.style.setProperty("margin-top","4px"),s(se,()=>a().error),se}})]}}),null),s(H,v(pt,{get each(){return Object.entries(o())},children:([se,Y])=>(()=>{var D=lC(),Q=D.firstChild,W=Q.firstChild,me=Q.nextSibling;return u(D,ge),Q.style.setProperty("text-transform","capitalize"),s(Q,se,W),me.style.setProperty("color","#00ff00"),s(me,Y),D})()}),null),R.$$click=m,X.$$click=g,O.style.setProperty("margin-top","8px"),N.$$click=A,s(I,v(Ne,{get when(){return r()!=="fake"},get children(){var se=oC();return se.style.setProperty("font-size","11px"),se.style.setProperty("color","#888"),se.style.setProperty("margin-top","4px"),se}}),null),pe.style.setProperty("font-size","11px"),pe.style.setProperty("color","#888"),pe.style.setProperty("line-height","1.4"),s(S,v(Ne,{get when(){return d()},get children(){var se=iC(),Y=se.firstChild;return se.style.setProperty("position","absolute"),se.style.setProperty("top","0"),se.style.setProperty("left","0"),se.style.setProperty("right","0"),se.style.setProperty("bottom","0"),se.style.setProperty("background","rgba(0,0,0,0.7)"),se.style.setProperty("display","flex"),se.style.setProperty("align-items","center"),se.style.setProperty("justify-content","center"),se.style.setProperty("border-radius","8px"),Y.style.setProperty("color","#fff"),Y.style.setProperty("font-size","14px"),se}}),null),ie(se=>{var Y={...T,padding:"4px 8px"},D=ce,Q=Z,W=r()==="fake"?ee:T,me=d(),fe=r()==="real"?ee:T,V=d(),re=r()==="hybrid"?ee:T,_e=d(),Pe=ce,ae=Z,be=ce,oe=Z,Se=ce,Ee=Z,xe=T,$e=d(),Me=T,We=d(),je={...T,background:"#cc4400","border-color":"#cc4400"},Ce=d()||r()!=="fake",Ve=Z;return se.e=u(P,Y,se.e),se.t=u(x,D,se.t),se.a=u(y,Q,se.a),se.o=u(J,W,se.o),me!==se.i&&(J.disabled=se.i=me),se.n=u(E,fe,se.n),V!==se.s&&(E.disabled=se.s=V),se.h=u(F,re,se.h),_e!==se.r&&(F.disabled=se.r=_e),se.d=u(U,Pe,se.d),se.l=u(he,ae,se.l),se.u=u(H,be,se.u),se.c=u(le,oe,se.c),se.w=u(I,Se,se.w),se.m=u(j,Ee,se.m),se.f=u(R,xe,se.f),$e!==se.y&&(R.disabled=se.y=$e),se.g=u(X,Me,se.g),We!==se.p&&(X.disabled=se.p=We),se.b=u(N,je,se.b),Ce!==se.T&&(N.disabled=se.T=Ce),se.A=u(de,Ve,se.A),se},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),S}}),null),ie(S=>u(w,L,S)),w})()};Et(["click"]);const uC=[{id:"YY_8802",code:"YY_8802",name:"CENTER",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8803",code:"YY_8803",name:"BISSONNET",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8804",code:"YY_8804",name:"IRVIN",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8805",code:"YY_8805",name:"KATTY",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8816",code:"YY_8816",type:"store",name:"YABA GLOBAL",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8818",code:"YY_8818",type:"store",name:"YABASURAUSTIN",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8847",code:"YY_8847",type:"store",name:"YABAOFICINA AZ",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_3251",code:"YY_3251",type:"store",name:"YABA FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_32",code:"YY_32",type:"store",name:"YABA MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_76",code:"YY_76",type:"store",name:"YABA DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_79",code:"YY_79",type:"warehouse",name:"ALMACEN DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8635",code:"YY_8635",type:"store",name:"FASHION MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8665",code:"YY_8665",name:"IRVIN FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,type:"store",createdDate:"2024-01-01"},{id:"YY_8901",code:"YY_8901",name:"ALMACEN CENTRAL YABA",bussinesId:"YB100423253156428",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01"}],dC=[{id:"1",name:'MacBook Pro 16"',price:2399,quantity:75,category:"Electronics",description:"Apple MacBook Pro 16-inch with M2 Pro chip",sku:"MBP-16-M2P",supplier:"Apple Inc.",minStock:10,location:"Warehouse A",lastUpdated:"2024-01-15"},{id:"2",name:'Dell Monitor 27"',price:299,quantity:35,category:"Electronics",description:"Dell 27-inch 4K UHD Monitor",sku:"DELL-MON-27-4K",supplier:"Dell Technologies",minStock:15,location:"Warehouse B",lastUpdated:"2024-01-14"},{id:"3",name:"Wireless Mouse",price:49.99,quantity:12,category:"Accessories",description:"Ergonomic wireless mouse with precision tracking",sku:"MOUSE-WL-001",supplier:"Logitech",minStock:25,location:"Warehouse A",lastUpdated:"2024-01-13"}],Fs=()=>{const t=new Map;return jr().forEach(e=>{const r=`${e.productId}-${e.locationId}`;let n=De.getLocationById(e.locationId),o=t.get(r);o||(o={id:r,productId:e.productId,locationId:e.locationId,locationName:n?.name,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,o)),e.movementType==="in"||e.movementType==="transfer"?(e.locationId===e.toLocationId||e.movementType==="in")&&(o.quantity+=e.quantity*1):e.movementType==="out"?o.quantity-=e.quantity*1:e.movementType==="adjustment"&&(o.quantity=e.quantity*1),new Date(e.createdDate)>new Date(o.lastMovementDate)&&(o.lastMovementDate=e.createdDate,o.lastMovementType=e.movementType),o.averageCost=e.unitCost*1,o.availableQuantity=o.quantity*1-o.reservedQuantity*1}),Array.from(t.values())},[fo,Al]=ve([]),[yo,Gh]=ve(uC),[jr,Us]=ve([]),[Un,Ui]=ve([]),hC=()=>{const t=new Map;return jr().forEach(e=>{const r=`${e.productId}-${e.locationId}`;let n=t.get(r),o=De.getLocationById(e.locationId);n||(n={id:r,productId:e.productId,locationId:e.locationId,locationName:o?.name,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType==="in"||e.movementType==="transfer"?(e.locationId===e.toLocationId||e.movementType==="in")&&(n.quantity+=e.quantity*1):e.movementType==="out"?n.quantity-=e.quantity*1:e.movementType==="adjustment"&&(n.quantity=e.quantity*1),new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost*1,n.availableQuantity=n.quantity*1-n.reservedQuantity*1}),Array.from(t.values())};Ui(hC());const[js,Il]=ve(dC),mC={TRANSFER:1,transfer:1},Hh=173442384e4,De={get products(){return fo()},get locations(){return yo()},get movements(){return jr()},get stockLevels(){return Un()},parseInventoryData:t=>{const e=Object.keys(t).slice(0,900),r=[],n=o=>{let i=t;i[o]?.products&&i[o]?.products?.map(a=>{let c=rv(i[o]?.type),d=a?.price*1||a?.unitCost*1,h=a?.qty*1||a?.quantity*1;d=isNaN(d)?0:d,h=isNaN(h)?0:h;let m={id:i[o]?.ssg_inventory_key,productId:a?.product?.id,productName:a?.product?.label,productSku:a?.product?.code,locationId:i[o]?.store,locationName:i[o]?.store,location:i[o]?.store,movementType:c,quantity:h,unitCost:d,totalCost:d*1*h,minStock:10,referenceNumber:"PO-001",notes:i[o]?.description||i[o]?.notes,createdBy:"admin",createdDate:i[o]?.createDate?new Date(i[o]?.createDate).toISOString():new Date(Hh).toISOString(),invoiceId:i[o]?.invoice};if(r.push(m),mC[i[o].movementType]&&i[o]?.fromLocationId){let g=De.getLocationById(i[o]?.fromLocationId);const _={id:i[o]?.ssg_inventory_key,productId:a?.product?.id,productName:a?.product?.label,productSku:a?.product?.code,locationId:i[o]?.fromLocationId,locationName:g?.name||"",movementType:"out",quantity:h*-1,unitCost:d,totalCost:d*-1*h,minStock:10,referenceNumber:i[o]?.referenceNumber,notes:`Transfer to ${i[o]?.locationName}`+(i[o].notes?` - ${i[o].notes}`:""),createdBy:i[o].createdBy,createdDate:i[o]?.createDate?new Date(i[o]?.createDate).toISOString():new Date(Hh).toISOString(),invoiceId:i[o]?.invoiceId,toLocationId:i[o]?.locationId,toLocationName:i[o]?.locationName};r.push(_)}})};return e.map(n),r},fecthInventory:async t=>{const e=await ln.getInventory(t),r=De.parseInventoryData(e);De.updMovements(r)},fecthProduct:async t=>{const e=await ln.getProducts(t),r=Object.keys(e),n=i=>{let a=e;return{id:i,name:a[i].name,businessId:a[i].businessId,sku:a[i].code,UPC:a[i].UPC,numCode:a[i].codeN,category:a[i].category,unitCost:a[i].unitCost||0,unitOfMeasure:a[i].unitOfMeasure||a[i].unit,minStockLevel:a[i].minStockLevel,maxStockLevel:a[i].maxStockLevel,isActive:a[i].isActive,productImageUrl:a[i].productImageUrl,description:a[i].description||"",createdDate:a[i].createdAt||new Date().toISOString(),lastModified:a[i].updatedAt||new Date().toISOString()}},o=r.map(n);return De.updProduct(o),o},getProductById:t=>fo().find(e=>e.id===t),updProduct:t=>{Al(t)},getProductsBySku:t=>fo().filter(e=>e.sku.toLowerCase().includes(t.toLowerCase())),getProductsByCategory:t=>fo().filter(e=>e.category===t),getActiveProducts:()=>fo().filter(t=>t.name),getLocationById:t=>yo().find(e=>e.id===t),getLocationsByType:t=>yo().filter(e=>e.type===t),getActiveLocations:()=>{let t=Pt?.state?.profile?.stores;return yo().filter(e=>t?.[e?.id])},getMovementsByProduct:t=>jr().filter(e=>e.productId===t),updMovements:t=>{Us([...t]),Ui(Fs())},getMovementsByLocation:t=>jr().filter(e=>e.locationId===t),getMovementsByDateRange:(t,e)=>jr().filter(r=>r.createdDate>=t&&r.createdDate<=e),getStockByProduct:t=>Un().filter(e=>e.productId===t),getStockByLocation:t=>Un().filter(e=>e.locationId===t),getStockByProductAndLocation:(t,e)=>Un().find(r=>r.productId===t&&r.locationId===e),getTotalStockByProduct:t=>Un().filter(e=>e.productId===t).reduce((e,r)=>e*1+r.quantity*1,0),getLastLocationByProduct:t=>{const e=jr().filter(r=>r.productId===t).sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime());if(e.length>0)return yo().find(r=>r.id===e[0].locationId)},getLowStockProducts:()=>(fo()||[])?.map(t=>{const e=Un().filter(r=>r.productId===t.id).reduce((r,n)=>r+n.quantity,0);return{...t,currentStock:e}}).filter(t=>t.currentStock<=t.minStockLevel),addInventoryMovement:t=>{const e={...t,id:`mov-${Date.now()}`,createdDate:new Date().toISOString()};Us(r=>[...r,e]),Ui(Fs())},addBulkInventoryMovements:async t=>{const e=[],r=[],n=new Date().toISOString(),o=yo().find(c=>c.id===t.locationId);if(!o)return{success:!1,errors:["Invalid location"]};let i;if(t.movementType==="transfer"){if(!t.fromLocationId)return{success:!1,errors:["From location required for transfers"]};if(i=yo().find(c=>c.id===t.fromLocationId),!i)return{success:!1,errors:["Invalid from location"]};if(t.fromLocationId===t.locationId)return{success:!1,errors:["From and to locations cannot be the same"]}}if(t.items.forEach((c,d)=>{const h=fo().find(A=>A.id===c.productId);if(!h){e.push(`Item ${d+1}: Product not found`);return}if(c.quantity<=0){e.push(`Item ${d+1}: Quantity must be greater than 0`);return}if(t.movementType==="out"){const A=Un().filter(L=>L.productId===c.productId&&L.locationId===t.locationId).reduce((L,M)=>L+M.quantity,0);if(c.quantity>A){e.push(`Item ${d+1}: Insufficient stock. Available: ${A}, Requested: ${c.quantity}`);return}}if(t.movementType==="transfer"){const A=Un().filter(L=>L.productId===c.productId&&L.locationId===t.fromLocationId).reduce((L,M)=>L+M.quantity,0);if(c.quantity>A){e.push(`Item ${d+1}: Insufficient stock at ${i?.name}. Available: ${A}, Requested: ${c.quantity}`);return}}const m=c.unitCost||h.unitCost,g=c.quantity*m,_={id:`mov-${Date.now()}-${d}`,productId:h.id,productName:h.name,productSku:h.sku,locationId:t.locationId,locationName:o.name,movementType:t.movementType,quantity:c.quantity,unitCost:m,totalCost:g,minStock:10,referenceNumber:t.referenceNumber||"",notes:c.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:i?.name};if(r.push(_),t.movementType==="transfer"&&i){const A={id:`mov-${Date.now()}-${d}-out`,productId:h.id,productName:h.name,productSku:h.sku,locationId:t.fromLocationId,locationName:i.name,movementType:"out",quantity:c.quantity,unitCost:m,totalCost:g,minStock:10,referenceNumber:t.referenceNumber||"",notes:`Transfer to ${o.name}`+(c.notes?` - ${c.notes}`:""),createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,toLocationId:t.locationId,toLocationName:o.name};r.push(A)}}),e.length>0)return{success:!1,errors:e};Us(c=>[...c,...r]),Ui(Fs()),console.log({bulkRequest:t});const a=await ln.addInventory(t);return console.log({prodResults:a}),{success:!0,errors:[]}},getMovementsByInvoice:t=>jr().filter(e=>e.invoiceId===t),getInvoiceSummary:t=>{const e=jr().filter(i=>i.invoiceId===t);if(e.length===0)return null;const r=e.reduce((i,a)=>i+a.totalCost,0),n=new Set(e.map(i=>i.productId)).size,o=e[0];return{invoiceId:t,referenceNumber:o.referenceNumber,movementType:o.movementType,location:o.locationName,fromLocation:o.fromLocationName,productCount:n,totalItems:e.reduce((i,a)=>i+a.quantity,0),totalValue:r,createdDate:o.createdDate,createdBy:o.createdBy}},addProduct:t=>{const e={...t,id:`prod-${Date.now()}`,createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};Al(r=>[...r,e])},addLocation:t=>{const e={...t,id:`loc-${Date.now()}`,createdDate:new Date().toISOString()};Gh(r=>[...r,e])},updateProduct:(t,e)=>{Al(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n))},updateLocation:(t,e)=>{Gh(r=>r.map(n=>n.id===t?{...n,...e}:n))},updateMovement:(t,e)=>{Us(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n)),Ui(Fs())},get inventory(){return js()},addItem(t){const e={...t,id:Date.now().toString(),lastUpdated:new Date().toISOString().split("T")[0]};return Il([...js(),e]),e},updateItem(t,e){Il(js().map(r=>r.id===t?{...r,...e,lastUpdated:new Date().toISOString().split("T")[0]}:r))},deleteItem(t){Il(js().filter(e=>e.id!==t))},getItemById(t){return jr().find(e=>e.id===t)},getLowStockItems(){return jr().filter(t=>t.quantity*1<=t.minStock*1)},getTotalValue(){return jr().reduce((t,e)=>t*1+e.unitCost*1*e.quantity*1,0)}};var Yh=q("<div>"),fC=q("<div><div><input type=text autocomplete=off>"),yC=q("<button type=button>+"),gC=q("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>");const Eu=t=>{const{t:e}=ct(),[r,n]=ve(!1),[o,i]=ve(""),[a,c]=ve(-1),d=Ge(()=>t.value?De.getProductById(t.value):null),h=Ge(()=>{const J=o().toLowerCase();return J?De.getActiveProducts().filter(E=>E.name.toLowerCase().includes(J)||E.sku.toLowerCase().includes(J)||E.category.toLowerCase().includes(J)):De.getActiveProducts()}),m=()=>{n(!0),i(""),c(-1)},g=J=>{const E=J.target;i(E.value),n(!0),c(-1)},_=J=>{t.onChange(J),n(!1),i(""),c(-1)},A=J=>{const E=h();switch(J.key){case"ArrowDown":J.preventDefault(),c(F=>Math.min(F+1,E.length-1));break;case"ArrowUp":J.preventDefault(),c(F=>Math.max(F-1,-1));break;case"Enter":J.preventDefault(),a()>=0&&E[a()]&&_(E[a()]);break;case"Escape":n(!1),i(""),c(-1);break}},L=J=>{setTimeout(()=>{n(!1),i(""),c(-1)},150)},M=J=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(J),$=J=>De.stockLevels.filter(E=>E.productId===J).reduce((E,F)=>E+F.quantity,0),T={position:"relative",width:"100%",...t.style},ee={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},ce={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},Z=J=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid "+J?"var(--primary-color)":"var(--border-color)",background:J?"var(--strip-color)":"transparent",color:J?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),ge={display:"flex","justify-content":"space-between","align-items":"center"},ne={flex:"1"},w={"font-weight":"500","margin-bottom":"0.25rem"},S={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},p={"text-align":"right","font-size":"0.875rem"},C={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},P=()=>r()&&o()?o():d()?`${d().name} (${d().sku})`:"",x={display:"flex","align-items":"stretch",width:"100%"},y={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},ue={...ee,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"};return(()=>{var J=fC(),E=J.firstChild,F=E.firstChild;return u(E,x),F.addEventListener("blur",L),F.$$keydown=A,F.$$click=m,F.$$input=g,s(E,(()=>{var z=ye(()=>!!t.onAddNew);return()=>z()&&(()=>{var B=yC();return B.addEventListener("mouseleave",k=>{k.currentTarget.style.background="var(--surface-color)",k.currentTarget.style.color="var(--primary-color)"}),B.addEventListener("mouseenter",k=>{k.currentTarget.style.background="var(--primary-color)",k.currentTarget.style.color="white"}),ko(B,"click",t.onAddNew,!0),u(B,y),ie(()=>ut(B,"title",e("inventory.addProduct","Add new product"))),B})()})(),null),s(J,v(Ne,{get when(){return r()},get children(){var z=Yh();return s(z,v(Ne,{get when(){return h().length>0},get fallback(){return(()=>{var B=Yh();return u(B,C),s(B,(()=>{var k=ye(()=>!!o());return()=>k()?e("inventory.noProductsFound","No products found matching your search."):e("inventory.noProductsAvailable","No products available.")})()),B})()},get children(){return v(pt,{get each(){return h()},children:(B,k)=>{const U=$(B.id),he=U<=B.minStockLevel;return(()=>{var H=gC(),le=H.firstChild,I=le.firstChild,j=I.firstChild,K=j.nextSibling,R=K.firstChild,X=R.firstChild,O=R.nextSibling,N=O.nextSibling,te=N.nextSibling,de=te.nextSibling,pe=I.nextSibling,se=pe.firstChild,Y=se.firstChild,D=se.nextSibling;return H.addEventListener("mouseenter",()=>c(k())),H.$$click=()=>_(B),u(le,ge),u(I,ne),u(j,w),s(j,()=>B.name),u(K,S),s(R,()=>e("inventory.sku","SKU"),X),s(R,()=>B.sku,null),s(N,()=>B.category),s(de,()=>M(B.unitCost)),u(pe,p),se.style.setProperty("font-weight","600"),(he?"#f44336":"var(--text-primary)")!=null?se.style.setProperty("color",he?"#f44336":"var(--text-primary)"):se.style.removeProperty("color"),s(se,U,Y),s(se,()=>B.unitOfMeasure,null),D.style.setProperty("color","var(--text-muted)"),s(D,()=>he?e("inventory.lowStock","Low Stock"):e("inventory.inStock","In Stock")),ie(Q=>u(H,Z(k()===a()),Q)),H})()}})}})),ie(B=>u(z,ce,B)),z}}),null),ie(z=>{var B=T,k=ue,U=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),he=t.disabled,H=t.required;return z.e=u(J,B,z.e),z.t=u(F,k,z.t),U!==z.a&&ut(F,"placeholder",z.a=U),he!==z.o&&(F.disabled=z.o=he),H!==z.i&&(F.required=z.i=H),z},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ie(()=>F.value=P()),J})()};Et(["input","click","keydown"]);var Wh=q("<div>"),pC=q("<div><div><input type=text autocomplete=off>"),vC=q("<button type=button>+"),bC=q("<div><div><div><div> </div><div><span>: </span><span></span></div><div>");const Ma=t=>{const{t:e}=ct(),[r,n]=ve(!1),[o,i]=ve(""),[a,c]=ve(-1),d=Ge(()=>t.value?De.getLocationById(t.value):null),h=Ge(()=>{let J=De.getActiveLocations();t.filterType&&(J=J.filter(F=>F.type===t.filterType));const E=o().toLowerCase();return E?J.filter(F=>F.name.toLowerCase().includes(E)||F?.code?.toLowerCase().includes(E)||F?.type?.toLowerCase().includes(E)||F?.address?.toLowerCase().includes(E)):J}),m=()=>{n(!0),i(""),c(-1)},g=J=>{const E=J.target;i(E.value),n(!0),c(-1)},_=J=>{t.onChange(J.id),n(!1),i(""),c(-1)},A=J=>{const E=h();switch(J.key){case"ArrowDown":J.preventDefault(),c(F=>Math.min(F+1,E.length-1));break;case"ArrowUp":J.preventDefault(),c(F=>Math.max(F-1,-1));break;case"Enter":J.preventDefault(),a()>=0&&E[a()]&&_(E[a()]);break;case"Escape":n(!1),i(""),c(-1);break}},L=J=>{setTimeout(()=>{n(!1),i(""),c(-1)},150)},M=J=>({warehouse:"🏭",store:"🏪",supplier:"🚚",customer:"👥"})[J]||"📍",$=J=>({warehouse:"#2196F3",store:"#4CAF50",supplier:"#FF9800",customer:"#9C27B0"})[J]||"#757575",T={position:"relative",width:"100%",...t.style},ee={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},ce={display:"flex","align-items":"stretch",width:"100%"},Z={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},ge={...ee,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"},ne={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},w=J=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:J?"var(--strip-color)":"transparent",color:J?"var(--primary-dark)":"var(--text-primary)",transition:"all 0.2s ease"}),S={display:"flex","justify-content":"space-between","align-items":"center"},p={flex:"1"},C={"font-weight":"500","margin-bottom":"0.25rem"},P={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem","align-items":"center"},x=J=>({padding:"0.2rem 0.5rem","border-radius":"var(--border-radius-sm)","font-size":"0.7rem","font-weight":"500",background:$(J),color:"white","text-transform":"uppercase"}),y={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},ue=()=>r()&&o()?o():d()?`${d().name} (${d().code})`:"";return(()=>{var J=pC(),E=J.firstChild,F=E.firstChild;return u(E,ce),F.addEventListener("blur",L),F.$$keydown=A,F.$$click=m,F.$$input=g,s(E,(()=>{var z=ye(()=>!!t.onAddNew);return()=>z()&&(()=>{var B=vC();return B.addEventListener("mouseleave",k=>{k.currentTarget.style.background="var(--surface-color)",k.currentTarget.style.color="var(--primary-color)"}),B.addEventListener("mouseenter",k=>{k.currentTarget.style.background="var(--primary-color)",k.currentTarget.style.color="white"}),ko(B,"click",t.onAddNew,!0),u(B,Z),ie(()=>ut(B,"title",e("inventory.addLocation","Add new location"))),B})()})(),null),s(J,v(Ne,{get when(){return r()},get children(){var z=Wh();return s(z,v(Ne,{get when(){return h().length>0},get fallback(){return(()=>{var B=Wh();return u(B,y),s(B,(()=>{var k=ye(()=>!!o());return()=>k()?e("inventory.noLocationsFound","No locations found matching your search."):e("inventory.noLocationsAvailable","No locations available.")})()),B})()},get children(){return v(pt,{get each(){return h()},children:(B,k)=>(()=>{var U=bC(),he=U.firstChild,H=he.firstChild,le=H.firstChild,I=le.firstChild,j=le.nextSibling,K=j.firstChild,R=K.firstChild,X=K.nextSibling,O=j.nextSibling;return U.addEventListener("mouseenter",()=>c(k())),U.$$click=()=>_(B),u(he,S),u(H,p),u(le,C),s(le,()=>M(B.type),I),s(le,()=>B.name,null),u(j,P),s(K,()=>e("inventory.locationCode","Code"),R),s(K,()=>B.code,null),s(X,()=>B.type),O.style.setProperty("font-size","0.75rem"),O.style.setProperty("color","var(--text-muted)"),O.style.setProperty("margin-top","0.25rem"),s(O,()=>B.address),ie(N=>{var te=w(k()===a()),de=x(B.type);return N.e=u(U,te,N.e),N.t=u(X,de,N.t),N},{e:void 0,t:void 0}),U})()})}})),ie(B=>u(z,ne,B)),z}}),null),ie(z=>{var B=T,k=ge,U=t.placeholder||e("inventory.searchLocations","Search locations by name, code, or type..."),he=t.disabled,H=t.required;return z.e=u(J,B,z.e),z.t=u(F,k,z.t),U!==z.a&&ut(F,"placeholder",z.a=U),he!==z.o&&(F.disabled=z.o=he),H!==z.i&&(F.required=z.i=H),z},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ie(()=>F.value=ue()),J})()};Et(["input","click","keydown"]);var _C=q("<form><div><label> *</label><input type=text required></div><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text list=categories required><datalist id=categories><option value=Electronics></option><option value=Accessories></option><option value=Office></option><option value=Furniture></option><option value=Software></option><option value=Hardware></option></datalist></div></div><div><label></label><textarea></textarea></div><div><div><label></label><select><option value=pcs></option><option value=kg></option><option value=lbs></option><option value=m></option><option value=ft></option><option value=l></option><option value=gal></option><option value=box></option><option value=pack></option></select></div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div></div><div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div><div></div></div><div><div><label></label><input type=number min=0 step=1></div><div><label></label><input type=number min=1 step=1></div></div><div>"),SC=q("<div>");const Tu=t=>{const{t:e}=ct(),[r,n]=ve(""),[o,i]=ve(""),[a,c]=ve(""),[d,h]=ve(""),[m,g]=ve("pcs"),[_,A]=ve(0),[L,M]=ve(0),[$,T]=ve(10),[ee,ce]=ve(100),[Z,ge]=ve(""),ne=()=>{n(""),i(""),c(""),h(""),g("pcs"),A(0),M(0),T(10),ce(100),ge("")},w=E=>{if(E.preventDefault(),ge(""),!r().trim()){ge(e("forms.productNameRequired"));return}if(!o().trim()){ge(e("forms.skuRequired"));return}if(!d().trim()){ge(e("forms.categoryRequired"));return}if(_()<0){ge(e("forms.unitCostNotNegative"));return}if(L()<0){ge(e("forms.sellingPriceNotNegative"));return}if($()<0){ge(e("forms.minStockNotNegative"));return}if(ee()<=$()){ge(e("forms.maxStockGreaterThanMin"));return}if(De.getProductsBySku(o()).length>0){ge(e("forms.skuAlreadyExists"));return}const z={name:r().trim(),sku:o().trim().toUpperCase(),description:a().trim(),category:d().trim(),unitOfMeasure:m(),unitCost:_(),sellingPrice:L(),minStockLevel:$(),maxStockLevel:ee(),isActive:!0,businessId:"default-business"};De.addProduct(z);const B=`prod-${Date.now()}`;t.onProductAdded&&t.onProductAdded(B),ne(),t.onClose()},S=()=>{ne(),t.onClose()},p={"margin-bottom":"1.5rem"},C={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},P={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},x={...P,cursor:"pointer"},y={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},ue={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},J={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"};return v(br,{get isOpen(){return t.isOpen},onClose:S,get title(){return e("inventory.addNewProduct")},get children(){var E=_C(),F=E.firstChild,z=F.firstChild,B=z.firstChild,k=z.nextSibling,U=F.nextSibling,he=U.firstChild,H=he.firstChild,le=H.firstChild,I=H.nextSibling,j=he.nextSibling,K=j.firstChild,R=K.firstChild,X=K.nextSibling,O=U.nextSibling,N=O.firstChild,te=N.nextSibling,de=O.nextSibling,pe=de.firstChild,se=pe.firstChild,Y=se.nextSibling,D=Y.firstChild,Q=D.nextSibling,W=Q.nextSibling,me=W.nextSibling,fe=me.nextSibling,V=fe.nextSibling,re=V.nextSibling,_e=re.nextSibling,Pe=_e.nextSibling,ae=pe.nextSibling,be=ae.firstChild,oe=be.nextSibling,Se=de.nextSibling,Ee=Se.firstChild,xe=Ee.firstChild,$e=xe.nextSibling,Me=Se.nextSibling,We=Me.firstChild,je=We.firstChild,Ce=je.nextSibling,Ve=We.nextSibling,Ke=Ve.firstChild,He=Ke.nextSibling,Qe=Me.nextSibling;return E.addEventListener("submit",w),s(z,()=>e("inventory.productName"),B),k.addEventListener("change",Ie=>n(Ie.target.value)),s(H,()=>e("inventory.sku"),le),I.addEventListener("change",Ie=>i(Ie.target.value)),s(K,()=>e("inventory.category"),R),X.addEventListener("change",Ie=>h(Ie.target.value)),s(N,()=>e("common.description")),te.addEventListener("change",Ie=>c(Ie.target.value)),s(se,()=>e("inventory.unitOfMeasure")),Y.addEventListener("change",Ie=>g(Ie.target.value)),s(D,()=>e("inventory.pieces")),s(Q,()=>e("inventory.kilograms")),s(W,()=>e("inventory.pounds")),s(me,()=>e("inventory.meters")),s(fe,()=>e("inventory.feet")),s(V,()=>e("inventory.liters")),s(re,()=>e("inventory.gallons")),s(_e,()=>e("inventory.boxes")),s(Pe,()=>e("inventory.packs")),s(be,()=>e("inventory.unitCost")),oe.addEventListener("change",Ie=>A(Number(Ie.target.value))),s(xe,()=>e("inventory.sellingPrice")),$e.addEventListener("change",Ie=>M(Number(Ie.target.value))),s(je,()=>e("inventory.minimumStockLevel")),Ce.addEventListener("change",Ie=>T(Number(Ie.target.value))),s(Ke,()=>e("inventory.maximumStockLevel")),He.addEventListener("change",Ie=>ce(Number(Ie.target.value))),s(E,(()=>{var Ie=ye(()=>!!Z());return()=>Ie()&&(()=>{var ot=SC();return u(ot,y),s(ot,Z),ot})()})(),Qe),u(Qe,ue),s(Qe,v(Le,{variant:"secondary",type:"button",onClick:S,get children(){return e("common.cancel")}}),null),s(Qe,v(Le,{variant:"primary",type:"submit",get children(){return e("inventory.addProduct")}}),null),ie(Ie=>{var ot=p,et=C,Ct=P,yt=e("inventory.enterProductName"),Dt=J,Tt=C,$t=P,qt=e("inventory.enterSkuCode"),st=C,ke=P,at=e("inventory.enterCategory"),kt=p,Fe=C,Be={...P,"min-height":"80px",resize:"vertical"},Je=e("inventory.enterProductDescription"),rt=J,vt=C,Xe=x,bt=C,ft=P,Oe=J,dt=C,Bt=P,gt=J,Nt=C,Ft=P,_t=C,nt=P;return Ie.e=u(F,ot,Ie.e),Ie.t=u(z,et,Ie.t),Ie.a=u(k,Ct,Ie.a),yt!==Ie.o&&ut(k,"placeholder",Ie.o=yt),Ie.i=u(U,Dt,Ie.i),Ie.n=u(H,Tt,Ie.n),Ie.s=u(I,$t,Ie.s),qt!==Ie.h&&ut(I,"placeholder",Ie.h=qt),Ie.r=u(K,st,Ie.r),Ie.d=u(X,ke,Ie.d),at!==Ie.l&&ut(X,"placeholder",Ie.l=at),Ie.u=u(O,kt,Ie.u),Ie.c=u(N,Fe,Ie.c),Ie.w=u(te,Be,Ie.w),Je!==Ie.m&&ut(te,"placeholder",Ie.m=Je),Ie.f=u(de,rt,Ie.f),Ie.y=u(se,vt,Ie.y),Ie.g=u(Y,Xe,Ie.g),Ie.p=u(be,bt,Ie.p),Ie.b=u(oe,ft,Ie.b),Ie.T=u(Se,Oe,Ie.T),Ie.A=u(xe,dt,Ie.A),Ie.O=u($e,Bt,Ie.O),Ie.I=u(Me,gt,Ie.I),Ie.S=u(je,Nt,Ie.S),Ie.W=u(Ce,Ft,Ie.W),Ie.C=u(Ke,_t,Ie.C),Ie.B=u(He,nt,Ie.B),Ie},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),ie(()=>k.value=r()),ie(()=>I.value=o()),ie(()=>X.value=d()),ie(()=>te.value=a()),ie(()=>Y.value=m()),ie(()=>oe.value=_()),ie(()=>$e.value=L()),ie(()=>Ce.value=$()),ie(()=>He.value=ee()),E}})};var PC=q('<form><div><label> *</label><input type=text required></div><div><div><label> *<button type=button title="Generate code automatically"></button></label><input type=text required><div></div></div><div><label> *</label><select required><option value=warehouse> </option><option value=store> </option><option value=supplier> </option><option value=customer> </option></select><div></div></div></div><div><label> *</label><textarea required></textarea></div><div>'),wC=q("<div><div>:</div><div><span></span><div><div></div><div>"),CC=q("<div>");const $u=t=>{const{t:e}=ct(),[r,n]=ve(""),[o,i]=ve(""),[a,c]=ve("warehouse"),[d,h]=ve(""),[m,g]=ve(""),_=()=>{n(""),i(""),c("warehouse"),h(""),g("")},A=()=>{if(r()){const P=a()==="warehouse"?"WH":a()==="store"?"ST":a()==="supplier"?"SUP":"CUST",x=r().toUpperCase().replace(/[^A-Z0-9]/g,"").substring(0,3),y=String(Math.floor(Math.random()*1e3)).padStart(3,"0");i(`${P}-${x}-${y}`)}},L=P=>{if(P.preventDefault(),g(""),!r().trim()){g(e("forms.locationNameRequired"));return}if(!o().trim()){g(e("forms.locationCodeRequired"));return}if(!d().trim()){g(e("forms.addressRequired"));return}if(De.locations.filter(J=>J.code.toLowerCase()===o().toLowerCase()).length>0){g(e("forms.locationCodeExists"));return}const y={name:r().trim(),code:o().trim().toUpperCase(),type:a(),address:d().trim(),isActive:!0};De.addLocation(y);const ue=`loc-${Date.now()}`;t.onLocationAdded&&t.onLocationAdded(ue),_(),t.onClose()},M=()=>{_(),t.onClose()},$={"margin-bottom":"1.5rem"},T={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},ee={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},ce={...ee,cursor:"pointer"},Z={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},ge={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},ne={display:"grid","grid-template-columns":"2fr 1fr",gap:"1rem"},w={"font-size":"0.875rem",color:"var(--text-muted)","margin-top":"0.25rem"},S={padding:"0.25rem 0.5rem","font-size":"0.75rem","margin-left":"0.5rem",background:"var(--background-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",color:"var(--text-muted)"},p=P=>({warehouse:"🏭",store:"🏪",supplier:"🚚",customer:"👥"})[P]||"📍",C=P=>({warehouse:e("inventory.warehouseDescription"),store:e("inventory.storeDescription"),supplier:e("inventory.supplierDescription"),customer:e("inventory.customerDescription")})[P]||"";return v(br,{get isOpen(){return t.isOpen},onClose:M,get title(){return e("inventory.addNewLocation")},get children(){var P=PC(),x=P.firstChild,y=x.firstChild,ue=y.firstChild,J=y.nextSibling,E=x.nextSibling,F=E.firstChild,z=F.firstChild,B=z.firstChild,k=B.nextSibling,U=z.nextSibling,he=U.nextSibling,H=F.nextSibling,le=H.firstChild,I=le.firstChild,j=le.nextSibling,K=j.firstChild,R=K.firstChild,X=K.nextSibling,O=X.firstChild,N=X.nextSibling,te=N.firstChild,de=N.nextSibling,pe=de.firstChild,se=j.nextSibling,Y=E.nextSibling,D=Y.firstChild,Q=D.firstChild,W=D.nextSibling,me=Y.nextSibling;return P.addEventListener("submit",L),s(y,()=>e("inventory.locationName"),ue),J.addEventListener("change",fe=>n(fe.target.value)),u(E,ne),s(z,()=>e("inventory.locationCode"),B),k.$$click=A,u(k,S),s(k,()=>e("common.generate")),U.addEventListener("change",fe=>i(fe.target.value)),s(he,()=>e("inventory.uniqueIdentifierHelp")),s(le,()=>e("inventory.locationType"),I),j.addEventListener("change",fe=>c(fe.target.value)),s(K,()=>p("warehouse"),R),s(K,()=>e("inventory.warehouse"),null),s(X,()=>p("store"),O),s(X,()=>e("inventory.store"),null),s(N,()=>p("supplier"),te),s(N,()=>e("inventory.supplier"),null),s(de,()=>p("customer"),pe),s(de,()=>e("inventory.customer"),null),s(se,()=>C(a())),s(D,()=>e("common.address"),Q),W.addEventListener("change",fe=>h(fe.target.value)),s(P,(()=>{var fe=ye(()=>!!r());return()=>fe()&&(()=>{var V=wC(),re=V.firstChild,_e=re.firstChild,Pe=re.nextSibling,ae=Pe.firstChild,be=ae.nextSibling,oe=be.firstChild,Se=oe.nextSibling;return V.style.setProperty("padding","1rem"),V.style.setProperty("background","var(--background-color)"),V.style.setProperty("border-radius","var(--border-radius-sm)"),V.style.setProperty("border","1px solid var(--border-color)"),V.style.setProperty("margin-bottom","1rem"),re.style.setProperty("font-weight","500"),re.style.setProperty("margin-bottom","0.5rem"),s(re,()=>e("common.preview"),_e),Pe.style.setProperty("display","flex"),Pe.style.setProperty("align-items","center"),Pe.style.setProperty("gap","0.5rem"),ae.style.setProperty("font-size","1.2rem"),s(ae,()=>p(a())),oe.style.setProperty("font-weight","600"),s(oe,r),Se.style.setProperty("font-size","0.875rem"),Se.style.setProperty("color","var(--text-muted)"),s(Se,(()=>{var Ee=ye(()=>!!o());return()=>Ee()&&`${o()} • `})(),null),s(Se,a,null),V})()})(),me),s(P,(()=>{var fe=ye(()=>!!m());return()=>fe()&&(()=>{var V=CC();return u(V,Z),s(V,m),V})()})(),me),u(me,ge),s(me,v(Le,{variant:"secondary",type:"button",onClick:M,get children(){return e("common.cancel")}}),null),s(me,v(Le,{variant:"primary",type:"submit",get children(){return e("inventory.addLocation")}}),null),ie(fe=>{var V=$,re=T,_e=ee,Pe=e("inventory.enterLocationName"),ae=T,be=ee,oe=e("inventory.enterUniqueCode"),Se=w,Ee=T,xe=ce,$e=w,Me=$,We=T,je={...ee,"min-height":"100px",resize:"vertical"},Ce=e("inventory.enterCompleteAddress");return fe.e=u(x,V,fe.e),fe.t=u(y,re,fe.t),fe.a=u(J,_e,fe.a),Pe!==fe.o&&ut(J,"placeholder",fe.o=Pe),fe.i=u(z,ae,fe.i),fe.n=u(U,be,fe.n),oe!==fe.s&&ut(U,"placeholder",fe.s=oe),fe.h=u(he,Se,fe.h),fe.r=u(le,Ee,fe.r),fe.d=u(j,xe,fe.d),fe.l=u(se,$e,fe.l),fe.u=u(Y,Me,fe.u),fe.c=u(D,We,fe.c),fe.w=u(W,je,fe.w),Ce!==fe.m&&ut(W,"placeholder",fe.m=Ce),fe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),ie(()=>J.value=r()),ie(()=>U.value=o()),ie(()=>j.value=a()),ie(()=>W.value=d()),P}})};Et(["click"]);var AC=q("<form><div>"),Kh=q("<div><label> *"),IC=q("<div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment>"),xC=q("<div><label>"),EC=q("<div><label> *</label><input type=number min=0 step=1 required>"),TC=q("<div><label></label><input type=number min=0 step=0.01>"),$C=q("<div><label></label><input type=text>"),kC=q("<div><label></label><textarea>"),RC=q("<div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span>:</span><span> "),DC=q("<div><div><span>:</span><span>"),NC=q("<div>");const LC=t=>{const{t:e}=ct(),[r,n]=ve({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""}),[o,i]=ve(""),[a,c]=ve(""),[d,h]=ve("in"),[m,g]=ve(0),[_,A]=ve(0),[L,M]=ve(""),[$,T]=ve(""),[ee,ce]=ve(""),[Z,ge]=ve(""),[ne,w]=ve(!1),[S,p]=ve(!1),C=()=>t.mode==="movement",P=Ge(()=>o()?De.getProductById(o()):null),x=Ge(()=>a()?De.getLocationById(a()):null),y=Ge(()=>ee()?De.getLocationById(ee()):null),ue=Ge(()=>m()*_()),J=Ge(()=>!o()||!a()?0:De.getStockByProductAndLocation(o(),a())?.quantity||0),E=[{value:"Electronics",label:"Electronics"},{value:"Accessories",label:"Accessories"},{value:"Furniture",label:"Furniture"},{value:"Office Supplies",label:"Office Supplies"},{value:"Software",label:"Software"},{value:"Hardware",label:"Hardware"},{value:"Consumables",label:"Consumables"}],F=[{value:"Warehouse A",label:"Warehouse A"},{value:"Warehouse B",label:"Warehouse B"},{value:"Warehouse C",label:"Warehouse C"},{value:"Storage Room",label:"Storage Room"},{value:"Main Office",label:"Main Office"}],z={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},B=()=>{i(""),c(""),h("in"),g(0),A(0),M(""),T(""),ce(""),ge("")},k=()=>{n({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""})},U=de=>{if(de.preventDefault(),C()){if(ge(""),!o()){ge(e("forms.selectProduct"));return}if(!a()){ge(e("forms.selectLocation"));return}if(m()<=0){ge(e("forms.quantityGreaterThanZero"));return}if(_()<0){ge(e("forms.unitCostNotNegative"));return}if(d()==="transfer"&&!ee()){ge(e("forms.selectFromLocation"));return}if(d()==="transfer"&&ee()===a()){ge(e("forms.sameLocationError"));return}if(d()==="out"&&m()>J()){ge(e("forms.insufficientStock",{currentStock:J()}));return}const pe=P(),se=x(),Y={productId:pe.id,productName:pe.name,productSku:pe.sku,locationId:se.id,locationName:se.name,movementType:d(),quantity:m(),unitCost:_()||pe.unitCost,totalCost:ue()||m()*pe.unitCost,referenceNumber:L()||`AUTO-${Date.now()}`,notes:$(),createdBy:"admin",fromLocationId:d()==="transfer"?ee():void 0,fromLocationName:d()==="transfer"?y()?.name:void 0};De.addInventoryMovement(Y),B()}else{const pe=r();if(!pe.name||!pe.price||!pe.quantity||!pe.category||!pe.sku||!pe.supplier||!pe.minStock||!pe.location){alert(e("forms.fillAllRequired"));return}const se={name:pe.name,price:parseFloat(pe.price),quantity:parseInt(pe.quantity),category:pe.category,description:pe.description,sku:pe.sku,supplier:pe.supplier,minStock:parseInt(pe.minStock),location:pe.location};De.addItem(se),k()}t.onClose()},he=(de,pe)=>{n(se=>({...se,[de]:pe}))},H=()=>{C()?B():k(),t.onClose()},le=de=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(de),I={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},j={...I,cursor:"pointer"},K={color:"#f44336","font-size":"0.875rem","margin-top":"0.5rem"},R={padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},X={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},O={"font-weight":"500",color:"var(--text-muted)"},N={"font-weight":"600",color:"var(--text-primary)"},te=()=>C()?e("inventory.addMovement"):e("inventory.addNewItem");return v(br,{get isOpen(){return t.isOpen},onClose:H,get title(){return te()},get children(){return[(()=>{var de=AC(),pe=de.firstChild;return de.addEventListener("submit",U),s(de,(()=>{var se=ye(()=>!!C());return()=>se()?[(()=>{var Y=Kh(),D=Y.firstChild,Q=D.firstChild;return Y.style.setProperty("margin-bottom","1.5rem"),D.style.setProperty("display","block"),D.style.setProperty("margin-bottom","0.5rem"),D.style.setProperty("font-weight","500"),s(D,()=>e("inventory.product"),Q),s(Y,v(Eu,{get value(){return o()},onChange:W=>{i(W);const me=De.getProductById(W);me&&A(me.unitCost)},get placeholder(){return e("inventory.searchProductsPlaceholder")},onAddNew:()=>w(!0),required:!0}),null),Y})(),(()=>{var Y=IC(),D=Y.firstChild,Q=D.firstChild,W=D.nextSibling,me=W.firstChild,fe=me.nextSibling,V=fe.nextSibling,re=V.nextSibling;return Y.style.setProperty("margin-bottom","1.5rem"),D.style.setProperty("display","block"),D.style.setProperty("margin-bottom","0.5rem"),D.style.setProperty("font-weight","500"),s(D,()=>e("inventory.movementType"),Q),W.addEventListener("change",_e=>h(_e.target.value)),s(me,()=>e("inventory.stockInPurchase")),s(fe,()=>e("inventory.stockOutSale")),s(V,()=>e("inventory.transferBetween")),s(re,()=>e("inventory.stockAdjustment")),ie(_e=>u(W,j,_e)),ie(()=>W.value=d()),Y})(),ye(()=>ye(()=>d()==="transfer")()&&(()=>{var Y=Kh(),D=Y.firstChild,Q=D.firstChild;return Y.style.setProperty("margin-bottom","1.5rem"),D.style.setProperty("display","block"),D.style.setProperty("margin-bottom","0.5rem"),D.style.setProperty("font-weight","500"),s(D,()=>e("inventory.fromLocation"),Q),s(Y,v(Ma,{get value(){return ee()},onChange:W=>ce(W),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>p(!0),required:!0}),null),Y})()),(()=>{var Y=xC(),D=Y.firstChild;return Y.style.setProperty("margin-bottom","1.5rem"),D.style.setProperty("display","block"),D.style.setProperty("margin-bottom","0.5rem"),D.style.setProperty("font-weight","500"),s(D,(()=>{var Q=ye(()=>d()==="transfer");return()=>Q()?e("inventory.toLocation")+" *":e("inventory.locationName")+" *"})()),s(Y,v(Ma,{get value(){return a()},onChange:Q=>c(Q),get placeholder(){return ye(()=>d()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>p(!0),required:!0}),null),Y})(),ye(()=>ye(()=>!!(P()&&x()))()&&(()=>{var Y=RC(),D=Y.firstChild,Q=D.firstChild,W=Q.firstChild,me=Q.nextSibling,fe=me.firstChild,V=D.nextSibling,re=V.firstChild,_e=re.firstChild,Pe=re.nextSibling,ae=V.nextSibling,be=ae.firstChild,oe=be.firstChild,Se=be.nextSibling,Ee=Se.firstChild;return s(Q,()=>e("inventory.currentStockAt",{location:x()?.name}),W),s(me,J,fe),s(me,()=>P()?.unitOfMeasure,null),s(re,()=>e("inventory.productCost"),_e),s(Pe,()=>le(P()?.unitCost||0)),s(be,()=>e("inventory.minStockLevel"),oe),s(Se,()=>P()?.minStockLevel,Ee),s(Se,()=>P()?.unitOfMeasure,null),ie(xe=>{var $e=R,Me=X,We=O,je=N,Ce=X,Ve=O,Ke=N,He=X,Qe=O,Ie=N;return xe.e=u(Y,$e,xe.e),xe.t=u(D,Me,xe.t),xe.a=u(Q,We,xe.a),xe.o=u(me,je,xe.o),xe.i=u(V,Ce,xe.i),xe.n=u(re,Ve,xe.n),xe.s=u(Pe,Ke,xe.s),xe.h=u(ae,He,xe.h),xe.r=u(be,Qe,xe.r),xe.d=u(Se,Ie,xe.d),xe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),Y})()),(()=>{var Y=EC(),D=Y.firstChild,Q=D.firstChild,W=D.nextSibling;return Y.style.setProperty("margin-bottom","1.5rem"),D.style.setProperty("display","block"),D.style.setProperty("margin-bottom","0.5rem"),D.style.setProperty("font-weight","500"),s(D,()=>e("inventory.quantity"),Q),W.addEventListener("change",me=>g(Number(me.target.value))),ie(me=>u(W,I,me)),ie(()=>W.value=m()),Y})(),(()=>{var Y=TC(),D=Y.firstChild,Q=D.nextSibling;return Y.style.setProperty("margin-bottom","1.5rem"),D.style.setProperty("display","block"),D.style.setProperty("margin-bottom","0.5rem"),D.style.setProperty("font-weight","500"),s(D,()=>e("inventory.unitCost")),Q.addEventListener("change",W=>A(Number(W.target.value))),ie(W=>{var me=I,fe=e("inventory.willUseDefaultCost");return W.e=u(Q,me,W.e),fe!==W.t&&ut(Q,"placeholder",W.t=fe),W},{e:void 0,t:void 0}),ie(()=>Q.value=_()),Y})(),ye(()=>ye(()=>m()>0&&_()>0)()&&(()=>{var Y=DC(),D=Y.firstChild,Q=D.firstChild,W=Q.firstChild,me=Q.nextSibling;return s(Q,()=>e("inventory.totalCost"),W),s(me,()=>le(ue())),ie(fe=>{var V=R,re=X,_e=O,Pe={...N,"font-size":"1.2rem",color:"var(--primary-color)"};return fe.e=u(Y,V,fe.e),fe.t=u(D,re,fe.t),fe.a=u(Q,_e,fe.a),fe.o=u(me,Pe,fe.o),fe},{e:void 0,t:void 0,a:void 0,o:void 0}),Y})()),(()=>{var Y=$C(),D=Y.firstChild,Q=D.nextSibling;return Y.style.setProperty("margin-bottom","1.5rem"),D.style.setProperty("display","block"),D.style.setProperty("margin-bottom","0.5rem"),D.style.setProperty("font-weight","500"),s(D,()=>e("common.referenceNumber")),Q.addEventListener("change",W=>M(W.target.value)),ie(W=>{var me=I,fe=e("common.referenceNumberPlaceholder");return W.e=u(Q,me,W.e),fe!==W.t&&ut(Q,"placeholder",W.t=fe),W},{e:void 0,t:void 0}),ie(()=>Q.value=L()),Y})(),(()=>{var Y=kC(),D=Y.firstChild,Q=D.nextSibling;return Y.style.setProperty("margin-bottom","1.5rem"),D.style.setProperty("display","block"),D.style.setProperty("margin-bottom","0.5rem"),D.style.setProperty("font-weight","500"),s(D,()=>e("common.notes")),Q.addEventListener("change",W=>T(W.target.value)),ie(W=>{var me={...I,"min-height":"100px",resize:"vertical"},fe=e("inventory.additionalNotesPlaceholder");return W.e=u(Q,me,W.e),fe!==W.t&&ut(Q,"placeholder",W.t=fe),W},{e:void 0,t:void 0}),ie(()=>Q.value=$()),Y})(),ye(()=>ye(()=>!!Z())()&&(()=>{var Y=NC();return u(Y,K),s(Y,Z),Y})())]:[v(Mt,{get label(){return e("inventory.itemName")},get value(){return r().name},onChange:Y=>he("name",Y),get placeholder(){return e("inventory.enterItemName")},required:!0}),v(Mt,{get label(){return e("inventory.sku")},get value(){return r().sku},onChange:Y=>he("sku",Y),get placeholder(){return e("inventory.enterSkuCode")},required:!0}),v(gr,{get label(){return e("inventory.category")},get value(){return r().category},onChange:Y=>he("category",Y),options:E,required:!0}),v(Mt,{get label(){return e("common.description")},get value(){return r().description},onChange:Y=>he("description",Y),get placeholder(){return e("inventory.enterItemDescription")}}),v(Mt,{get label(){return e("common.price")},type:"number",get value(){return r().price},onChange:Y=>he("price",Y),get placeholder(){return e("common.enterPrice")},required:!0}),v(Mt,{get label(){return e("inventory.quantity")},type:"number",get value(){return r().quantity},onChange:Y=>he("quantity",Y),get placeholder(){return e("inventory.enterQuantity")},required:!0}),v(Mt,{get label(){return e("inventory.minimumStock")},type:"number",get value(){return r().minStock},onChange:Y=>he("minStock",Y),get placeholder(){return e("inventory.enterMinStockLevel")},required:!0}),v(Mt,{get label(){return e("inventory.supplier")},get value(){return r().supplier},onChange:Y=>he("supplier",Y),get placeholder(){return e("inventory.enterSupplierName")},required:!0}),v(gr,{get label(){return e("inventory.location")},get value(){return r().location},onChange:Y=>he("location",Y),options:F,required:!0})]})(),pe),u(pe,z),s(pe,v(Le,{variant:"secondary",type:"button",onClick:H,get children(){return e("common.cancel")}}),null),s(pe,v(Le,{variant:"primary",type:"submit",get children(){return ye(()=>!!C())()?e("inventory.addMovement"):e("inventory.addItem")}}),null),de})(),v(Tu,{get isOpen(){return ne()},onClose:()=>w(!1),onProductAdded:de=>{i(de),w(!1)}}),v($u,{get isOpen(){return S()},onClose:()=>p(!1),onLocationAdded:de=>{d()==="transfer"&&!ee()?ce(de):c(de),p(!1)}})]}})};Et(["input","keydown"]);var MC=q("<form><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text required></div></div><div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><div><label></label></div></div><div><div><h3></h3></div></div><div><label></label><textarea></textarea></div><div>"),OC=q("<div><label> *"),VC=q("<div><div></div><div></div><div></div><div></div><div>"),xl=q("<div>"),BC=q("<div><input type=number min=0 step=1 required><input type=number min=0 step=0.01><input type=text>"),FC=q("<div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span>"),UC=q("<div>• ");const jC=t=>{const{t:e}=ct(),[r,n]=ve(`INV-${Date.now()}`),[o,i]=ve(""),[a,c]=ve("in"),[d,h]=ve(""),[m,g]=ve(""),[_,A]=ve(""),[L,M]=ve([]),[$,T]=ve([]),[ee,ce]=ve(!1),[Z,ge]=ve(!1),ne=()=>{M(R=>[...R,{productId:"",quantity:0,unitCost:0,notes:""}])},w=R=>{M(X=>X.filter((O,N)=>N!==R))},S=(R,X,O)=>{M(N=>N.map((te,de)=>de===R?{...te,[X]:O}:te))},p=()=>{n(`INV-${Date.now()}`),i(""),c("in"),h(""),g(""),A(""),M([]),T([])},C=async R=>{R.preventDefault(),T([]);const X=[];if(o()||X.push(e("forms.referenceNumberRequired")),d()||X.push(e("forms.locationRequired")),a()==="transfer"&&!m()&&X.push(e("forms.fromLocationRequired")),L().length===0&&X.push(e("forms.atLeastOneProduct")),L().forEach((te,de)=>{te.productId||X.push(e("forms.itemProductRequired","Product is required for item {{index}}",{index:de+1})),te.quantity<=0&&X.push(e("forms.itemQuantityRequired","Quantity must be greater than 0 for item {{index}}",{index:de+1}))}),X.length>0){T(X);return}const O={ssg_inventory_key:Xs(),invoiceId:r(),referenceNumber:o(),movementType:a(),type:Wl(a()),locationId:d(),fromLocationId:a()==="transfer"?m():void 0,items:L(),products:L(),generalNotes:_(),description:_(),invoice:o(),store:d(),createdBy:"admin",createDate:new Date().toISOString()};console.log(O);const N=await De.addBulkInventoryMovements(O);console.log(N),N.success?(p(),t.onClose()):T(N.errors)},P=()=>{p(),t.onClose()},x=Ge(()=>L().reduce((R,X)=>{const O=De.getProductById(X.productId),N=X.unitCost||O?.unitCost||0;return R+X.quantity*N},0)),y=Ge(()=>L().reduce((R,X)=>R+X.quantity,0)),ue={"margin-bottom":"1.5rem"},J={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},E={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},F={...E,cursor:"pointer"},z={display:"grid",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},B={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},k={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem","padding-left":"0.75rem"},U={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},he={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},H={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},le={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},I=R=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(R),j=R=>({in:e("inventory.purchaseReceive"),out:e("inventory.saleIssue"),transfer:e("inventory.transfer"),adjustment:e("inventory.adjustment")})[R]||R,K=async R=>{await De.fecthInventory(R),await De.fecthProduct(R)};return Hr(()=>{K("prod")}),v(br,{get isOpen(){return t.isOpen},onClose:P,get title(){return e("inventory.bulkMovement")},get children(){return[(()=>{var R=MC(),X=R.firstChild,O=X.firstChild,N=O.firstChild,te=N.firstChild,de=N.nextSibling,pe=O.nextSibling,se=pe.firstChild,Y=se.firstChild,D=se.nextSibling,Q=X.nextSibling,W=Q.firstChild,me=W.firstChild,fe=W.nextSibling,V=fe.firstChild,re=V.nextSibling,_e=re.nextSibling,Pe=_e.nextSibling,ae=Q.nextSibling,be=ae.firstChild,oe=be.firstChild,Se=ae.nextSibling,Ee=Se.firstChild,xe=Ee.firstChild,$e=Se.nextSibling,Me=$e.firstChild,We=Me.nextSibling,je=$e.nextSibling;return R.addEventListener("submit",C),X.style.setProperty("display","grid"),X.style.setProperty("grid-template-columns","1fr 1fr"),X.style.setProperty("gap","1rem"),X.style.setProperty("margin-bottom","1.5rem"),s(N,()=>e("common.invoiceDocumentId"),te),de.addEventListener("change",Ce=>n(Ce.target.value)),s(se,()=>e("common.referenceNumber"),Y),D.addEventListener("change",Ce=>i(Ce.target.value)),s(W,()=>e("inventory.movementType"),me),fe.addEventListener("change",Ce=>c(Ce.target.value)),s(V,()=>e("inventory.purchaseReceive")),s(re,()=>e("inventory.saleIssue")),s(_e,()=>e("inventory.transfer")),s(Pe,()=>e("inventory.adjustment")),ae.style.setProperty("display","grid"),ae.style.setProperty("gap","1rem"),ae.style.setProperty("margin-bottom","1.5rem"),s(ae,(()=>{var Ce=ye(()=>a()==="transfer");return()=>Ce()&&(()=>{var Ve=OC(),Ke=Ve.firstChild,He=Ke.firstChild;return s(Ke,()=>e("inventory.fromLocation"),He),s(Ve,v(Ma,{get value(){return m()},onChange:Qe=>g(Qe),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>ge(!0),required:!0}),null),ie(Qe=>u(Ke,J,Qe)),Ve})()})(),be),s(oe,(()=>{var Ce=ye(()=>a()==="transfer");return()=>Ce()?e("inventory.toLocation")+" *":e("inventory.location")+" *"})()),s(be,v(Ma,{get value(){return d()},onChange:Ce=>h(Ce),get placeholder(){return ye(()=>a()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>ge(!0),required:!0}),null),Ee.style.setProperty("display","flex"),Ee.style.setProperty("justify-content","space-between"),Ee.style.setProperty("align-items","center"),Ee.style.setProperty("margin-bottom","1rem"),xe.style.setProperty("margin","0"),xe.style.setProperty("font-size","1.1rem"),s(xe,()=>e("inventory.products")),s(Ee,v(Le,{variant:"outline",type:"button",onClick:ne,get children(){return e("inventory.addProduct")}}),null),s(Se,(()=>{var Ce=ye(()=>L().length>0);return()=>Ce()&&[(()=>{var Ve=VC(),Ke=Ve.firstChild,He=Ke.nextSibling,Qe=He.nextSibling,Ie=Qe.nextSibling;return u(Ve,k),s(Ke,()=>e("inventory.product")),s(He,()=>e("inventory.quantity")),s(Qe,()=>e("inventory.unitCost")),s(Ie,()=>e("common.notes")),Ve})(),v(pt,{get each(){return L()},children:(Ve,Ke)=>[(()=>{var He=xl();return u(He,z),s(He,v(Eu,{get value(){return Ve.productId},onChange:Qe=>{S(Ke(),"productId",Qe.id);let Ie={id:Qe.id,label:Qe.name,code:Qe.sku};S(Ke(),"product",Ie);const ot=De.getProductById(Qe.id);ot&&!Ve.unitCost&&S(Ke(),"unitCost",ot.unitCost)},get placeholder(){return e("inventory.searchProduct")},onAddNew:()=>ce(!0),required:!0})),He})(),(()=>{var He=BC(),Qe=He.firstChild,Ie=Qe.nextSibling,ot=Ie.nextSibling;return u(He,B),Qe.addEventListener("change",et=>S(Ke(),"quantity",Number(et.target.value))),Ie.addEventListener("change",et=>S(Ke(),"unitCost",Number(et.target.value))),ot.addEventListener("change",et=>S(Ke(),"notes",et.target.value)),s(He,v(Le,{variant:"outline",size:"sm",type:"button",onClick:()=>w(Ke()),style:{color:"#f44336","border-color":"#f44336"},get children(){return e("common.remove")}}),null),ie(et=>{var Ct=E,yt=E,Dt=e("common.auto"),Tt=E,$t=e("common.optionalNotes");return et.e=u(Qe,Ct,et.e),et.t=u(Ie,yt,et.t),Dt!==et.a&&ut(Ie,"placeholder",et.a=Dt),et.o=u(ot,Tt,et.o),$t!==et.i&&ut(ot,"placeholder",et.i=$t),et},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ie(()=>Qe.value=Ve.quantity),ie(()=>Ie.value=Ve.unitCost),ie(()=>ot.value=Ve.notes),He})()]})]})(),null),s(Se,(()=>{var Ce=ye(()=>L().length===0);return()=>Ce()&&(()=>{var Ve=xl();return Ve.style.setProperty("text-align","center"),Ve.style.setProperty("padding","2rem"),Ve.style.setProperty("background","var(--background-color)"),Ve.style.setProperty("border-radius","var(--border-radius-sm)"),Ve.style.setProperty("border","1px solid var(--border-color)"),Ve.style.setProperty("color","var(--text-muted)"),s(Ve,()=>e("inventory.noProductsAdded")),Ve})()})(),null),s(R,(()=>{var Ce=ye(()=>L().length>0);return()=>Ce()&&(()=>{var Ve=FC(),Ke=Ve.firstChild,He=Ke.nextSibling,Qe=He.firstChild,Ie=Qe.firstChild,ot=Qe.nextSibling,et=He.nextSibling,Ct=et.firstChild,yt=Ct.firstChild,Dt=Ct.nextSibling,Tt=et.nextSibling,$t=Tt.firstChild,qt=$t.firstChild,st=$t.nextSibling,ke=Tt.nextSibling,at=ke.firstChild,kt=at.firstChild,Fe=at.nextSibling;return u(Ve,U),Ke.style.setProperty("margin","0 0 1rem 0"),Ke.style.setProperty("font-size","1rem"),s(Ke,()=>e("common.summary")),s(Qe,()=>e("inventory.totalProducts"),Ie),ot.style.setProperty("font-weight","600"),s(ot,()=>L().length),s(Ct,()=>e("inventory.totalItems"),yt),Dt.style.setProperty("font-weight","600"),s(Dt,y),s($t,()=>e("inventory.totalValue"),qt),st.style.setProperty("font-weight","600"),st.style.setProperty("color","var(--primary-color)"),s(st,()=>I(x())),s(at,()=>e("inventory.movementType"),kt),Fe.style.setProperty("font-weight","600"),s(Fe,()=>j(a())),ie(Be=>{var Je=he,rt=he,vt=he,Xe=he;return Be.e=u(He,Je,Be.e),Be.t=u(et,rt,Be.t),Be.a=u(Tt,vt,Be.a),Be.o=u(ke,Xe,Be.o),Be},{e:void 0,t:void 0,a:void 0,o:void 0}),Ve})()})(),$e),s(Me,()=>e("common.generalNotes")),We.addEventListener("change",Ce=>A(Ce.target.value)),s(R,(()=>{var Ce=ye(()=>$().length>0);return()=>Ce()&&(()=>{var Ve=xl();return u(Ve,H),s(Ve,v(pt,{get each(){return $()},children:Ke=>(()=>{var He=UC();return He.firstChild,s(He,Ke,null),He})()})),Ve})()})(),je),u(je,le),s(je,v(Le,{variant:"secondary",type:"button",onClick:P,get children(){return e("common.cancel")}}),null),s(je,v(Le,{variant:"primary",type:"submit",get children(){return e("inventory.createMovement")}}),null),ie(Ce=>{var Ve=J,Ke=E,He=J,Qe=E,Ie=e("common.referenceNumberPlaceholder"),ot=ue,et=J,Ct=F,yt=a()==="transfer"?"1fr 1fr":"1fr",Dt=J,Tt=ue,$t=ue,qt=J,st={...E,"min-height":"80px",resize:"vertical"},ke=e("inventory.generalNotesPlaceholder");return Ce.e=u(N,Ve,Ce.e),Ce.t=u(de,Ke,Ce.t),Ce.a=u(se,He,Ce.a),Ce.o=u(D,Qe,Ce.o),Ie!==Ce.i&&ut(D,"placeholder",Ce.i=Ie),Ce.n=u(Q,ot,Ce.n),Ce.s=u(W,et,Ce.s),Ce.h=u(fe,Ct,Ce.h),yt!==Ce.r&&((Ce.r=yt)!=null?ae.style.setProperty("grid-template-columns",yt):ae.style.removeProperty("grid-template-columns")),Ce.d=u(oe,Dt,Ce.d),Ce.l=u(Se,Tt,Ce.l),Ce.u=u($e,$t,Ce.u),Ce.c=u(Me,qt,Ce.c),Ce.w=u(We,st,Ce.w),ke!==Ce.m&&ut(We,"placeholder",Ce.m=ke),Ce},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),ie(()=>de.value=r()),ie(()=>D.value=o()),ie(()=>fe.value=a()),ie(()=>We.value=_()),R})(),v(Tu,{get isOpen(){return ee()},onClose:()=>ce(!1),onProductAdded:R=>{ce(!1)}}),v($u,{get isOpen(){return Z()},onClose:()=>ge(!1),onLocationAdded:R=>{a()==="transfer"&&!m()?g(R):h(R),ge(!1)}})]}})};var zC=q("<div><div></div><div></div><div></div><div>"),qC=q("<div><strong>:</strong> "),GC=q("<div><div><span></span><span></span></div><div><span></span><span> </span></div><div><span></span><span> </span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),HC=q("<div>");const YC=t=>{const{t:e}=ct(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},o={"font-weight":"600",color:"var(--text-primary)"},i={"text-align":"center","margin-bottom":"2rem"},a={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},c={color:"var(--text-muted)","font-size":"1rem"},d={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"1rem"},h=(M,$)=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:M>$?"#d4edda":"#f8d7da",color:M>$?"#155724":"#721c24"}),m={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},g={"margin-bottom":"1.5rem",padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",color:"var(--text-secondary)"};if(!t.item)return null;const _=M=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(M),A=M=>new Date(M).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),L=t.item.price*t.item.quantity;return v(br,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.itemDetails")},get children(){return[(()=>{var M=zC(),$=M.firstChild,T=$.nextSibling,ee=T.nextSibling,ce=ee.nextSibling;return u(M,i),u($,a),s($,()=>t.item.name),u(T,c),s(T,()=>t.item.category),u(ee,d),s(ee,()=>_(t.item.price)),s(ce,(()=>{var Z=ye(()=>t.item.quantity>t.item.minStock);return()=>Z()?e("inventory.inStock"):e("inventory.lowStockAlert")})()),ie(Z=>u(ce,h(t.item.quantity,t.item.minStock),Z)),M})(),(()=>{var M=qC(),$=M.firstChild,T=$.firstChild;return $.nextSibling,u(M,g),s($,()=>e("common.description"),T),s(M,()=>t.item.description,null),M})(),(()=>{var M=GC(),$=M.firstChild,T=$.firstChild,ee=T.nextSibling,ce=$.nextSibling,Z=ce.firstChild,ge=Z.nextSibling,ne=ge.firstChild,w=ce.nextSibling,S=w.firstChild,p=S.nextSibling,C=p.firstChild,P=w.nextSibling,x=P.firstChild,y=x.nextSibling,ue=P.nextSibling,J=ue.firstChild,E=J.nextSibling,F=ue.nextSibling,z=F.firstChild,B=z.nextSibling,k=F.nextSibling,U=k.firstChild,he=U.nextSibling;return s(T,()=>e("inventory.sku")),s(ee,()=>t.item.sku),s(Z,()=>e("inventory.quantity")),s(ge,()=>t.item.quantity,ne),s(ge,()=>e("common.units"),null),s(S,()=>e("inventory.minimumStock")),s(p,()=>t.item.minStock,C),s(p,()=>e("common.units"),null),s(x,()=>e("inventory.totalValue")),s(y,()=>_(L)),s(J,()=>e("inventory.supplier")),s(E,()=>t.item.supplier),s(z,()=>e("inventory.location")),s(B,()=>t.item.location),s(U,()=>e("common.lastUpdated")),s(he,()=>A(t.item.lastUpdated)),ie(H=>{var le=r,I=n,j=o,K=r,R=n,X=o,O=r,N=n,te=o,de=r,pe=n,se=o,Y=r,D=n,Q=o,W=r,me=n,fe=o,V=r,re=n,_e=o;return H.e=u($,le,H.e),H.t=u(T,I,H.t),H.a=u(ee,j,H.a),H.o=u(ce,K,H.o),H.i=u(Z,R,H.i),H.n=u(ge,X,H.n),H.s=u(w,O,H.s),H.h=u(S,N,H.h),H.r=u(p,te,H.r),H.d=u(P,de,H.d),H.l=u(x,pe,H.l),H.u=u(y,se,H.u),H.c=u(ue,Y,H.c),H.w=u(J,D,H.w),H.m=u(E,Q,H.m),H.f=u(F,W,H.f),H.y=u(z,me,H.y),H.g=u(B,fe,H.g),H.p=u(k,V,H.p),H.b=u(U,re,H.b),H.T=u(he,_e,H.T),H},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),M})(),(()=>{var M=HC();return u(M,m),s(M,v(Le,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(M,v(Le,{variant:"primary",onClick:()=>{console.log("Edit item:",t.item.id)},get children(){return e("common.editItem")}}),null),M})()]}})};var WC=q("<div>🔄"),KC=q("<button type=button>×"),QC=q("<div>⚠️ "),Qh=q("<div>"),JC=q("<div><div><input type=text autocomplete=off>"),XC=q("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>"),ZC=q("<span>⚠️ ");const eA=t=>{const{t:e}=ct(),[r,n]=ve(""),[o,i]=ve(!1),[a,c]=ve(null),[d,h]=ve([]),[m,g]=ve(!1),[_,A]=ve(-1),[L,M]=ve(null),$=t.searchDelay||300;t.maxResults;const T=async le=>{if(!le.trim()||le.trim().length<3){h([]),t.onSearchResults?.([]);return}try{i(!0),c(null);try{console.log("apiResults",le),t.onSearchResults?.(le)}catch(I){console.warn("API search failed, using local fallback:",I),c("API search failed, showing local results")}}catch(I){const j=I instanceof Error?I.message:"Search failed";c(j),h([]),t.onSearchResults?.([])}finally{i(!1)}},ee=le=>{const j=le.target.value;n(j),c(null),console.log(),t.showResults,L()&&clearTimeout(L());const K=setTimeout(()=>{T(j)},$);M(K)},ce=le=>{n(le.name),g(!1),A(-1),t.onInventorySelect?.(le)},Z=le=>{if(!(!m()||d().length===0))switch(le.key){case"ArrowDown":le.preventDefault(),A(I=>Math.min(I+1,d().length-1));break;case"ArrowUp":le.preventDefault(),A(I=>Math.max(I-1,-1));break;case"Enter":le.preventDefault(),_()>=0&&d()[_()]&&ce(d()[_()]);break;case"Escape":g(!1),A(-1);break}},ge=()=>{t.showResults!==!1&&d().length>0&&g(!0)},ne=()=>{setTimeout(()=>{g(!1),A(-1)},150)},w=()=>{n(""),h([]),c(null),g(!1),A(-1),t.onSearchResults?.([]),L()&&(clearTimeout(L()),M(null))},S=le=>De.stockLevels.filter(I=>I.inventoryId===le).reduce((I,j)=>I+j.quantity,0),p=le=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(le),C={position:"relative",width:"100%",...t.style},P={position:"relative",display:"flex","align-items":"center"},x={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},y={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},ue={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},J={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},E=le=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:le?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),F={display:"flex","justify-content":"space-between","align-items":"center"},z={flex:"1"},B={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},k={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},U={"text-align":"right","font-size":"0.875rem"},he={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},H={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var le=JC(),I=le.firstChild,j=I.firstChild;return j.addEventListener("blur",ne),j.addEventListener("focus",ge),j.$$keydown=Z,j.$$input=ee,s(I,v(Ne,{get when(){return o()},get children(){var K=WC();return ie(R=>u(K,ue,R)),K}}),null),s(I,v(Ne,{get when(){return ye(()=>!!r())()&&!o()},get children(){var K=KC();return K.addEventListener("mouseleave",R=>{R.currentTarget.style.background="none",R.currentTarget.style.color="var(--text-muted)"}),K.addEventListener("mouseenter",R=>{R.currentTarget.style.background="var(--border-color)",R.currentTarget.style.color="var(--text-primary)"}),K.$$click=w,ie(R=>{var X=y,O=e("common.clear","Clear search");return R.e=u(K,X,R.e),O!==R.t&&ut(K,"title",R.t=O),R},{e:void 0,t:void 0}),K}}),null),s(le,v(Ne,{get when(){return m()&&t.showResults!==!1},get children(){var K=Qh();return s(K,v(Ne,{get when(){return a()},get children(){var R=QC();return R.firstChild,u(R,H),s(R,a,null),R}}),null),s(K,v(Ne,{get when(){return d().length>0},get fallback(){return ye(()=>!!(r()&&!o()))()&&(()=>{var R=Qh();return u(R,he),s(R,()=>e("inventory.noInventorysFound","No inventorys found matching your search.")),R})()},get children(){return v(pt,{get each(){return d()},children:(R,X)=>{const O=S(R.id),N=O<=R.minStockLevel;return(()=>{var te=XC(),de=te.firstChild,pe=de.firstChild,se=pe.firstChild,Y=se.nextSibling,D=Y.firstChild,Q=D.firstChild,W=D.nextSibling,me=W.nextSibling,fe=me.nextSibling,V=fe.nextSibling,re=pe.nextSibling,_e=re.firstChild,Pe=_e.firstChild,ae=_e.nextSibling;return te.addEventListener("mouseenter",()=>A(X())),te.$$click=()=>ce(R),u(de,F),u(pe,z),u(se,B),s(se,()=>R.name),u(Y,k),s(D,()=>e("inventory.sku","SKU"),Q),s(D,()=>R.sku,null),s(me,()=>R.category),s(V,()=>p(R.unitCost)),u(re,U),_e.style.setProperty("font-weight","600"),(N?"#f44336":"var(--text-primary)")!=null?_e.style.setProperty("color",N?"#f44336":"var(--text-primary)"):_e.style.removeProperty("color"),s(_e,O,Pe),s(_e,()=>R.unitOfMeasure,null),ae.style.setProperty("color","var(--text-muted)"),s(ae,()=>N?(()=>{var be=ZC();return be.firstChild,be.style.setProperty("color","#f44336"),s(be,()=>e("inventory.lowStock","Low Stock"),null),be})():e("inventory.inStock","In Stock")),ie(be=>u(te,E(X()===_()),be)),te})()}})}}),null),ie(R=>u(K,J,R)),K}}),null),ie(K=>{var R=C,X=P,O=x,N=t.placeholder||e("inventory.searchInventorys","Search inventorys by name, SKU, or category..."),te=t.disabled;return K.e=u(le,R,K.e),K.t=u(I,X,K.t),K.a=u(j,O,K.a),N!==K.o&&ut(j,"placeholder",K.o=N),te!==K.i&&(j.disabled=K.i=te),K},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ie(()=>j.value=r()),le})()};Et(["input","keydown","click"]);var tA=q("<div>"),El=q("<div><span>:</span><span>"),rA=q("<div><button> "),nA=q("<div><div><div><h3></h3><div>: </div></div><div><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span> <!>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span>");const oA=t=>{const{t:e}=ct(),r=A=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(A),n=A=>new Date(A).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),o=A=>({in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}})[A]||{bg:"#f5f5f5",color:"#666"},i=A=>({in:"📦",out:"📤",transfer:"🔄",adjustment:"⚖️"})[A]||"📋",a=()=>t.movement,c={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},d={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},h={"font-weight":"600",color:"var(--text-primary)","text-align":"right"},m={"margin-bottom":"1.5rem"},g={"font-weight":"600","margin-bottom":"0.75rem","padding-bottom":"0.5rem","border-bottom":"2px solid var(--border-color)"},_=A=>({display:"inline-flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"600","text-transform":"uppercase","letter-spacing":"0.5px",background:o(A).bg,color:o(A).color});return v(br,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.movementDetails")},size:"lg",get children(){return v(Ne,{get when(){return a()},get fallback(){return(()=>{var A=tA();return s(A,()=>e("common.noDataFound")),A})()},children:A=>(()=>{var L=nA(),M=L.firstChild,$=M.firstChild,T=$.firstChild,ee=T.nextSibling,ce=ee.firstChild,Z=$.nextSibling,ge=Z.firstChild,ne=M.nextSibling,w=ne.firstChild,S=w.nextSibling,p=S.firstChild,C=p.firstChild,P=p.nextSibling,x=S.nextSibling,y=x.firstChild,ue=y.firstChild,J=y.nextSibling,E=J.firstChild,F=x.nextSibling,z=F.firstChild,B=z.firstChild,k=z.nextSibling,U=F.nextSibling,he=U.firstChild,H=he.firstChild,le=H.nextSibling;le.nextSibling;var I=he.nextSibling,j=ne.nextSibling,K=j.firstChild,R=K.nextSibling,X=R.firstChild,O=X.firstChild,N=X.nextSibling,te=j.nextSibling,de=te.firstChild,pe=de.nextSibling,se=pe.firstChild,Y=se.firstChild,D=se.nextSibling,Q=pe.nextSibling,W=Q.firstChild,me=W.firstChild,fe=W.nextSibling;return M.style.setProperty("display","flex"),M.style.setProperty("justify-content","space-between"),M.style.setProperty("align-items","center"),M.style.setProperty("margin-bottom","1.5rem"),M.style.setProperty("padding-bottom","1rem"),M.style.setProperty("border-bottom","2px solid var(--border-color)"),T.style.setProperty("margin","0 0 0.5rem 0"),T.style.setProperty("font-size","1.25rem"),s(T,()=>A().productName),ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-muted)"),s(ee,()=>e("inventory.sku"),ce),s(ee,()=>A().productSku,null),ge.style.setProperty("font-size","1.2rem"),s(ge,()=>i(A().movementType)),s(Z,()=>A().movementType,null),s(w,()=>e("inventory.movementInformation")),s(p,()=>e("inventory.referenceNumber"),C),s(P,()=>A().referenceNumber),s(y,()=>e("common.quantity"),ue),s(J,()=>A().quantity,E),s(J,()=>e("common.units"),null),s(z,()=>e("inventory.unitCost"),B),s(k,()=>r(A().unitCost)),s(he,()=>e("common.total"),H),s(he,()=>e("common.value"),le),s(I,()=>r(A().totalCost)),s(K,()=>e("inventory.locationInformation")),s(X,()=>e("inventory.location"),O),s(N,()=>A().locationName),s(j,v(Ne,{get when(){return A().fromLocationName},get children(){var V=El(),re=V.firstChild,_e=re.firstChild,Pe=re.nextSibling;return s(re,()=>e("common.from"),_e),s(Pe,()=>A().fromLocationName),ie(ae=>{var be=c,oe=d,Se=h;return ae.e=u(V,be,ae.e),ae.t=u(re,oe,ae.t),ae.a=u(Pe,Se,ae.a),ae},{e:void 0,t:void 0,a:void 0}),V}}),null),s(j,v(Ne,{get when(){return A().invoiceId},get children(){var V=El(),re=V.firstChild,_e=re.firstChild,Pe=re.nextSibling;return s(re,()=>e("common.invoice"),_e),s(Pe,()=>A().invoiceId),ie(ae=>{var be=c,oe=d,Se={...h,color:"var(--primary-color)"};return ae.e=u(V,be,ae.e),ae.t=u(re,oe,ae.t),ae.a=u(Pe,Se,ae.a),ae},{e:void 0,t:void 0,a:void 0}),V}}),null),s(de,()=>e("common.details")),s(se,()=>e("common.createdBy"),Y),s(D,()=>A().createdBy),s(W,()=>e("common.created"),me),s(fe,()=>n(A().createdDate)),s(te,v(Ne,{get when(){return A().notes},get children(){var V=El(),re=V.firstChild,_e=re.firstChild,Pe=re.nextSibling;return s(re,()=>e("common.notes"),_e),s(Pe,()=>A().notes),ie(ae=>{var be={...c,"border-bottom":"none"},oe=d,Se={...h,"font-style":"italic","max-width":"60%","white-space":"pre-wrap"};return ae.e=u(V,be,ae.e),ae.t=u(re,oe,ae.t),ae.a=u(Pe,Se,ae.a),ae},{e:void 0,t:void 0,a:void 0}),V}}),null),s(L,v(Ne,{get when(){return t.onEdit},get children(){var V=rA(),re=V.firstChild,_e=re.firstChild;return V.style.setProperty("display","flex"),V.style.setProperty("justify-content","flex-end"),V.style.setProperty("margin-top","1.5rem"),V.style.setProperty("padding-top","1rem"),V.style.setProperty("border-top","1px solid var(--border-color)"),re.addEventListener("mouseleave",Pe=>{Pe.currentTarget.style.transform="translateY(0)",Pe.currentTarget.style.boxShadow="none"}),re.addEventListener("mouseenter",Pe=>{Pe.currentTarget.style.transform="translateY(-1px)",Pe.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)"}),re.$$click=()=>t.onEdit?.(A()),re.style.setProperty("padding","0.5rem 1.5rem"),re.style.setProperty("border-radius","var(--border-radius-sm)"),re.style.setProperty("border","1px solid var(--primary-color)"),re.style.setProperty("background","var(--primary-color)"),re.style.setProperty("color","white"),re.style.setProperty("cursor","pointer"),re.style.setProperty("font-weight","500"),re.style.setProperty("transition","all 0.2s ease"),s(re,()=>e("common.edit"),_e),s(re,()=>e("inventory.movement"),null),V}}),null),ie(V=>{var re=_(A().movementType),_e=m,Pe=g,ae=c,be=d,oe=h,Se=c,Ee=d,xe={...h,"font-size":"1.1rem",color:"var(--primary-color)"},$e=c,Me=d,We=h,je=c,Ce=d,Ve={...h,"font-size":"1.1rem",color:"var(--primary-color)"},Ke=m,He=g,Qe=c,Ie=d,ot=h,et=m,Ct=g,yt=c,Dt=d,Tt=h,$t=c,qt=d,st=h;return V.e=u(Z,re,V.e),V.t=u(ne,_e,V.t),V.a=u(w,Pe,V.a),V.o=u(S,ae,V.o),V.i=u(p,be,V.i),V.n=u(P,oe,V.n),V.s=u(x,Se,V.s),V.h=u(y,Ee,V.h),V.r=u(J,xe,V.r),V.d=u(F,$e,V.d),V.l=u(z,Me,V.l),V.u=u(k,We,V.u),V.c=u(U,je,V.c),V.w=u(he,Ce,V.w),V.m=u(I,Ve,V.m),V.f=u(j,Ke,V.f),V.y=u(K,He,V.y),V.g=u(R,Qe,V.g),V.p=u(X,Ie,V.p),V.b=u(N,ot,V.b),V.T=u(te,et,V.T),V.A=u(de,Ct,V.A),V.O=u(pe,yt,V.O),V.I=u(se,Dt,V.I),V.S=u(D,Tt,V.S),V.W=u(Q,$t,V.W),V.C=u(W,qt,V.C),V.B=u(fe,st,V.B),V},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),L})()})}})};Et(["click"]);var go=q("<div>"),iA=q("<div><label></label><select><option value>"),sA=q("<div><div><span>:</span><span>$"),aA=q("<form><div><label></label><select><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><input type=number min=0.01 step=0.01></div><div><label></label><input type=number min=0 step=0.01></div><div><label></label><input type=text></div><div><label> (<!>)</label><input type=text></div><div><label> (<!>)</label><textarea></textarea></div><div><button type=button></button><button type=submit>"),Jh=q("<option> (<!>)");const lA=t=>{const{t:e}=ct(),[r,n]=ve("in"),[o,i]=ve(""),[a,c]=ve(""),[d,h]=ve(""),[m,g]=ve(""),[_,A]=ve(""),[L,M]=ve(""),[$,T]=ve(""),[ee,ce]=ve(!1),[Z,ge]=ve({});Nn(()=>{const ue=t.movement;ue&&t.isOpen&&(n(ue.movementType),i(ue.quantity.toString()),c(ue.unitCost.toString()),h(ue.referenceNumber),g(ue.notes),M(ue.locationId),A(ue.fromLocationId||""),T(ue.invoiceId||""),ge({}))});const ne=()=>{const ue={};return(!o()||parseFloat(o())<=0)&&(ue.quantity=e("forms.requiredField")),(!a()||parseFloat(a())<0)&&(ue.unitCost=e("forms.requiredField")),d().trim()||(ue.referenceNumber=e("forms.requiredField")),L()||(ue.locationId=e("forms.requiredField")),r()==="transfer"&&!_()&&(ue.fromLocationId=e("forms.requiredField")),ge(ue),Object.keys(ue).length===0},w=async ue=>{if(ue.preventDefault(),!(!ne()||!t.movement)){ce(!0);try{const J=t.movement,E=De.getProductById(J.productId),F=De.getLocationById(L()),z=_()?De.getLocationById(_()):null;if(!E||!F)throw new Error("Product or location not found");const B={...J,movementType:r(),quantity:parseFloat(o()),unitCost:parseFloat(a()),totalCost:parseFloat(o())*parseFloat(a()),referenceNumber:d().trim(),notes:m().trim(),locationId:L(),locationName:F.name,fromLocationId:_()||void 0,fromLocationName:z?.name,invoiceId:$().trim()||void 0,lastModified:new Date().toISOString()};De.updateMovement(J.id,B),t.onMovementUpdated?.(),t.onClose(),S()}catch(J){console.error("Error updating movement:",J),ge({submit:e("forms.saveError")})}finally{ce(!1)}}},S=()=>{n("in"),i(""),c(""),h(""),g(""),A(""),M(""),T(""),ge({})},p=()=>{S(),t.onClose()},C={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",transition:"border-color 0.2s ease"},P={display:"block","margin-bottom":"0.25rem","font-weight":"500","font-size":"0.875rem"},x={color:"#d32f2f","font-size":"0.75rem","margin-top":"0.25rem"},y={"margin-bottom":"1rem"};return v(br,{get isOpen(){return t.isOpen},onClose:p,get title(){return e("inventory.editMovement","Edit Movement")},get children(){return v(Ne,{get when(){return t.movement},get fallback(){return(()=>{var ue=go();return s(ue,()=>e("common.loading")),ue})()},get children(){var ue=aA(),J=ue.firstChild,E=J.firstChild,F=E.nextSibling,z=F.firstChild,B=z.nextSibling,k=B.nextSibling,U=k.nextSibling,he=J.nextSibling,H=he.firstChild,le=H.nextSibling,I=le.firstChild,j=he.nextSibling,K=j.firstChild,R=K.nextSibling,X=j.nextSibling,O=X.firstChild,N=O.nextSibling,te=X.nextSibling,de=te.firstChild,pe=de.nextSibling,se=te.nextSibling,Y=se.firstChild,D=Y.firstChild,Q=D.nextSibling;Q.nextSibling;var W=Y.nextSibling,me=se.nextSibling,fe=me.firstChild,V=fe.firstChild,re=V.nextSibling;re.nextSibling;var _e=fe.nextSibling,Pe=me.nextSibling,ae=Pe.firstChild,be=ae.nextSibling;return ue.addEventListener("submit",w),s(E,()=>e("inventory.movementType")),F.addEventListener("change",oe=>n(oe.target.value)),s(z,()=>e("inventory.stockIn")),s(B,()=>e("inventory.stockOut")),s(k,()=>e("inventory.transfer")),s(U,()=>e("inventory.adjustment")),s(H,(()=>{var oe=ye(()=>r()==="transfer");return()=>oe()?e("inventory.toLocation"):e("inventory.location")})()),le.addEventListener("change",oe=>M(oe.target.value)),s(I,()=>e("modals.selectLocation")),s(le,v(pt,{get each(){return De.getActiveLocations()},children:oe=>(()=>{var Se=Jh(),Ee=Se.firstChild,xe=Ee.nextSibling;return xe.nextSibling,s(Se,()=>oe.name,Ee),s(Se,()=>oe.type,xe),ie(()=>Se.value=oe.id),Se})()}),null),s(he,v(Ne,{get when(){return Z().locationId},get children(){var oe=go();return s(oe,()=>Z().locationId),ie(Se=>u(oe,x,Se)),oe}}),null),s(ue,v(Ne,{get when(){return r()==="transfer"},get children(){var oe=iA(),Se=oe.firstChild,Ee=Se.nextSibling,xe=Ee.firstChild;return s(Se,()=>e("inventory.fromLocation")),Ee.addEventListener("change",$e=>A($e.target.value)),s(xe,()=>e("modals.selectLocation")),s(Ee,v(pt,{get each(){return De.getActiveLocations().filter($e=>$e.id!==L())},children:$e=>(()=>{var Me=Jh(),We=Me.firstChild,je=We.nextSibling;return je.nextSibling,s(Me,()=>$e.name,We),s(Me,()=>$e.type,je),ie(()=>Me.value=$e.id),Me})()}),null),s(oe,v(Ne,{get when(){return Z().fromLocationId},get children(){var $e=go();return s($e,()=>Z().fromLocationId),ie(Me=>u($e,x,Me)),$e}}),null),ie($e=>{var Me=y,We=P,je={...C,"border-color":Z().fromLocationId?"#d32f2f":"var(--border-color)"},Ce=ee();return $e.e=u(oe,Me,$e.e),$e.t=u(Se,We,$e.t),$e.a=u(Ee,je,$e.a),Ce!==$e.o&&(Ee.disabled=$e.o=Ce),$e},{e:void 0,t:void 0,a:void 0,o:void 0}),ie(()=>Ee.value=_()),oe}}),j),s(K,()=>e("common.quantity")),R.$$input=oe=>i(oe.target.value),s(j,v(Ne,{get when(){return Z().quantity},get children(){var oe=go();return s(oe,()=>Z().quantity),ie(Se=>u(oe,x,Se)),oe}}),null),s(O,()=>e("inventory.unitCost")),N.$$input=oe=>c(oe.target.value),s(X,v(Ne,{get when(){return Z().unitCost},get children(){var oe=go();return s(oe,()=>Z().unitCost),ie(Se=>u(oe,x,Se)),oe}}),null),s(ue,v(Ne,{get when(){return ye(()=>!!o())()&&a()},get children(){var oe=sA(),Se=oe.firstChild,Ee=Se.firstChild,xe=Ee.firstChild,$e=Ee.nextSibling;return $e.firstChild,Se.style.setProperty("display","flex"),Se.style.setProperty("justify-content","space-between"),Ee.style.setProperty("font-weight","500"),s(Ee,()=>e("common.total"),xe),$e.style.setProperty("font-weight","600"),$e.style.setProperty("color","var(--primary-color)"),s($e,()=>(parseFloat(o()||"0")*parseFloat(a()||"0")).toFixed(2),null),ie(Me=>u(oe,{...y,padding:"0.75rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)"},Me)),oe}}),te),s(de,()=>e("inventory.referenceNumber")),pe.$$input=oe=>h(oe.target.value),s(te,v(Ne,{get when(){return Z().referenceNumber},get children(){var oe=go();return s(oe,()=>Z().referenceNumber),ie(Se=>u(oe,x,Se)),oe}}),null),s(Y,()=>e("inventory.invoiceNumber"),D),s(Y,()=>e("common.optional"),Q),W.$$input=oe=>T(oe.target.value),s(fe,()=>e("common.notes"),V),s(fe,()=>e("common.optional"),re),_e.$$input=oe=>g(oe.target.value),s(ue,v(Ne,{get when(){return Z().submit},get children(){var oe=go();return s(oe,()=>Z().submit),ie(Se=>u(oe,{...x,"margin-bottom":"1rem"},Se)),oe}}),Pe),Pe.style.setProperty("display","flex"),Pe.style.setProperty("gap","1rem"),Pe.style.setProperty("justify-content","flex-end"),ae.$$click=p,ae.style.setProperty("padding","0.5rem 1rem"),ae.style.setProperty("border","1px solid var(--border-color)"),ae.style.setProperty("border-radius","var(--border-radius-sm)"),ae.style.setProperty("background","white"),ae.style.setProperty("cursor","pointer"),s(ae,()=>e("common.cancel")),be.style.setProperty("padding","0.5rem 1rem"),be.style.setProperty("border","none"),be.style.setProperty("border-radius","var(--border-radius-sm)"),be.style.setProperty("background","var(--primary-color)"),be.style.setProperty("color","white"),be.style.setProperty("cursor","pointer"),be.style.setProperty("font-weight","500"),s(be,(()=>{var oe=ye(()=>!!ee());return()=>oe()?e("modals.processing"):e("inventory.updateMovement","Update Movement")})()),ie(oe=>{var Se=y,Ee=P,xe=C,$e=ee(),Me=y,We=P,je={...C,"border-color":Z().locationId?"#d32f2f":"var(--border-color)"},Ce=ee(),Ve=y,Ke=P,He={...C,"border-color":Z().quantity?"#d32f2f":"var(--border-color)"},Qe=e("modals.enterQuantity"),Ie=ee(),ot=y,et=P,Ct={...C,"border-color":Z().unitCost?"#d32f2f":"var(--border-color)"},yt=e("modals.enterCost"),Dt=ee(),Tt=y,$t=P,qt={...C,"border-color":Z().referenceNumber?"#d32f2f":"var(--border-color)"},st=e("modals.enterReference"),ke=ee(),at=y,kt=P,Fe=C,Be=e("inventory.invoiceNumber"),Je=ee(),rt=y,vt=P,Xe={...C,resize:"vertical","min-height":"80px"},bt=e("modals.addNotes"),ft=ee(),Oe=ee(),dt=ee();return oe.e=u(J,Se,oe.e),oe.t=u(E,Ee,oe.t),oe.a=u(F,xe,oe.a),$e!==oe.o&&(F.disabled=oe.o=$e),oe.i=u(he,Me,oe.i),oe.n=u(H,We,oe.n),oe.s=u(le,je,oe.s),Ce!==oe.h&&(le.disabled=oe.h=Ce),oe.r=u(j,Ve,oe.r),oe.d=u(K,Ke,oe.d),oe.l=u(R,He,oe.l),Qe!==oe.u&&ut(R,"placeholder",oe.u=Qe),Ie!==oe.c&&(R.disabled=oe.c=Ie),oe.w=u(X,ot,oe.w),oe.m=u(O,et,oe.m),oe.f=u(N,Ct,oe.f),yt!==oe.y&&ut(N,"placeholder",oe.y=yt),Dt!==oe.g&&(N.disabled=oe.g=Dt),oe.p=u(te,Tt,oe.p),oe.b=u(de,$t,oe.b),oe.T=u(pe,qt,oe.T),st!==oe.A&&ut(pe,"placeholder",oe.A=st),ke!==oe.O&&(pe.disabled=oe.O=ke),oe.I=u(se,at,oe.I),oe.S=u(Y,kt,oe.S),oe.W=u(W,Fe,oe.W),Be!==oe.C&&ut(W,"placeholder",oe.C=Be),Je!==oe.B&&(W.disabled=oe.B=Je),oe.v=u(me,rt,oe.v),oe.k=u(fe,vt,oe.k),oe.x=u(_e,Xe,oe.x),bt!==oe.j&&ut(_e,"placeholder",oe.j=bt),ft!==oe.q&&(_e.disabled=oe.q=ft),Oe!==oe.z&&(ae.disabled=oe.z=Oe),dt!==oe.P&&(be.disabled=oe.P=dt),oe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0,x:void 0,j:void 0,q:void 0,z:void 0,P:void 0}),ie(()=>F.value=r()),ie(()=>le.value=L()),ie(()=>R.value=o()),ie(()=>N.value=a()),ie(()=>pe.value=d()),ie(()=>W.value=$()),ie(()=>_e.value=m()),ue}})}})};Et(["input","click"]);var cA=q("<div><div></div><div><div><label></label><select><option value=all></option><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),uA=q("<div><h2>"),Xh=q("<div><label></label><select><option value>"),dA=q("<option> (<!>)"),hA=q("<option>"),mA=q("<div><div>📦</div><div></div><div>"),fA=q("<div><div><div><div><span></span><h3></h3><span></span></div><div> • </div></div><div><div></div><div> <!> @ </div></div></div><div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div><span>:</span><span>"),yA=q("<span>"),gA=q("<span>• <!>: "),Zh=q("<div><span>:</span><span>"),pA=q("<div><div><span>:</span><select><option value=10>10</option><option value=25>25</option><option value=50>50</option><option value=100>100</option></select><span></span></div><div><div><span>:</span><input type=number min=1><span> "),vA=q("<span>..."),bA=q("<button>");const _A=t=>{const{t:e}=ct(),[r,n]=ve(""),[o,i]=ve(""),[a,c]=ve("all"),[d,h]=ve({start:"",end:""}),[m,g]=ve(""),[_,A]=ve(""),[L,M]=ve(1),[$,T]=ve(25),[ee,ce]=ve(null),[Z,ge]=ve(!1),[ne,w]=ve(!1),S=Ge(()=>{let Q=De.movements;if(t.filterBy==="product"&&t.filterId?Q=Q.filter(W=>W.productId===t.filterId):t.filterBy==="location"&&t.filterId&&(Q=Q.filter(W=>W.locationId===t.filterId)),r()&&(Q=Q.filter(W=>W.productId===r())),o()&&(Q=Q.filter(W=>W.locationId===o())),a()!=="all"&&(Q=Q.filter(W=>W.movementType===a())),d().start&&(Q=Q.filter(W=>W.createdDate>=d().start)),d().end&&(Q=Q.filter(W=>W.createdDate<=d().end+"T23:59:59Z")),m()){const W=m().toLowerCase();Q=Q.filter(me=>me.productName.toLowerCase().includes(W)||me.productSku.toLowerCase().includes(W)||me.locationName.toLowerCase().includes(W)||me.referenceNumber.toLowerCase().includes(W)||me.notes.toLowerCase().includes(W)||me.createdBy.toLowerCase().includes(W)||me.invoiceId&&me.invoiceId.toLowerCase().includes(W)||me.fromLocationName&&me.fromLocationName.toLowerCase().includes(W)||me.movementType.toLowerCase().includes(W))}return Q.sort((W,me)=>new Date(me.createdDate).getTime()-new Date(W.createdDate).getTime())});Nn(()=>{r(),o(),a(),d(),m(),M(1)});const p=Ge(()=>{const Q=(L()-1)*$(),W=Q+$();return S().slice(Q,W)}),C=Ge(()=>Math.ceil(S().length/$())),P=Ge(()=>{const Q=S();return{total:Q.length,stockIn:Q.filter(W=>W.movementType==="in").length,stockOut:Q.filter(W=>W.movementType==="out").length,transfers:Q.filter(W=>W.movementType==="transfer").length,adjustments:Q.filter(W=>W.movementType==="adjustment").length,totalValue:Q.reduce((W,me)=>W+me.totalCost,0)}}),x={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},y={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},ue={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)",cursor:"pointer"},J={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},E={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem","margin-bottom":"2rem"},F={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","text-align":"center"},z={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},B={"font-size":"0.875rem",color:"var(--text-muted)","font-weight":"500"},k={padding:"1.5rem","margin-bottom":"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",transition:"all 0.2s ease"},U={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"1rem"};function he(Q){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[Q]||{bg:"#f5f5f5",color:"#666"}}const H=Q=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:he(Q).bg,color:he(Q).color}),le={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"1rem"},I={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.5rem 0","border-bottom":"1px solid var(--border-color)"},j={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},K={"font-weight":"600",color:"var(--text-primary)"},R={display:"flex","justify-content":"space-between","align-items":"center","margin-top":"2rem",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},X=Q=>({padding:"0.25rem 0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:Q?"var(--primary-color)":"var(--surface-color)",color:Q?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),O=Q=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Q),N=Q=>new Date(Q).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),te=Q=>({in:"📦",out:"📤",transfer:"🔄",adjustment:"⚖️"})[Q]||"📋",de=()=>{n(""),i(""),c("all"),h({start:"",end:""}),g(""),M(1)},pe=Q=>{ce(Q),ge(!0)},se=Q=>{ce(Q),ge(!1),w(!0)},Y=()=>{w(!1),ce(null)},D=async Q=>{o()&&(Q+=" "+o()),Wl(a())&&(Q+=" "+Wl(a()));const W=await ln.getInventory(Q),me=De.parseInventoryData(W);De.updMovements(me)};return(()=>{var Q=cA(),W=Q.firstChild,me=W.nextSibling,fe=me.firstChild,V=fe.firstChild,re=V.nextSibling,_e=re.firstChild,Pe=_e.nextSibling,ae=Pe.nextSibling,be=ae.nextSibling,oe=be.nextSibling,Se=fe.nextSibling,Ee=Se.firstChild,xe=Ee.nextSibling,$e=Se.nextSibling,Me=$e.firstChild,We=Me.nextSibling,je=me.nextSibling,Ce=je.firstChild,Ve=Ce.firstChild,Ke=Ve.nextSibling,He=Ce.nextSibling,Qe=He.firstChild,Ie=Qe.nextSibling,ot=He.nextSibling,et=ot.firstChild,Ct=et.nextSibling,yt=ot.nextSibling,Dt=yt.firstChild,Tt=Dt.nextSibling,$t=yt.nextSibling,qt=$t.firstChild,st=qt.nextSibling,ke=$t.nextSibling,at=ke.firstChild,kt=at.nextSibling;return s(Q,(()=>{var Fe=ye(()=>!t.filterBy);return()=>Fe()&&(()=>{var Be=uA(),Je=Be.firstChild;return u(Be,x),Je.style.setProperty("margin","0"),Je.style.setProperty("font-size","1.5rem"),s(Je,()=>e("inventory.movements")),s(Be,v(Le,{variant:"outline",onClick:de,get children(){return e("common.clearFilters")}}),null),Be})()})(),W),s(Q,v(eA,{filters:{selectedLocation:o,movementType:a},onSearchResults:Fe=>{A(Fe),D(Fe)},get placeholder(){return e("inventory.searchProductsStock","Search inventories...")},showResults:!1,maxResults:20}),W),W.style.setProperty("margin","20px"),u(me,y),s(me,(()=>{var Fe=ye(()=>!t.filterBy);return()=>Fe()&&[(()=>{var Be=Xh(),Je=Be.firstChild,rt=Je.nextSibling,vt=rt.firstChild;return Je.style.setProperty("display","block"),Je.style.setProperty("margin-bottom","0.5rem"),Je.style.setProperty("font-weight","500"),s(Je,()=>e("inventory.product")),rt.addEventListener("change",Xe=>n(Xe.target.value)),s(vt,()=>e("inventory.allProducts")),s(rt,v(pt,{get each(){return De.products},children:Xe=>(()=>{var bt=dA(),ft=bt.firstChild,Oe=ft.nextSibling;return Oe.nextSibling,s(bt,()=>Xe.name,ft),s(bt,()=>Xe.sku,Oe),ie(()=>bt.value=Xe.id),bt})()}),null),ie(Xe=>u(rt,ue,Xe)),ie(()=>rt.value=r()),Be})(),(()=>{var Be=Xh(),Je=Be.firstChild,rt=Je.nextSibling,vt=rt.firstChild;return Je.style.setProperty("display","block"),Je.style.setProperty("margin-bottom","0.5rem"),Je.style.setProperty("font-weight","500"),s(Je,()=>e("inventory.location")),rt.addEventListener("change",Xe=>i(Xe.target.value)),s(vt,()=>e("inventory.allLocations")),s(rt,v(pt,{get each(){return De.locations},children:Xe=>(()=>{var bt=hA();return s(bt,()=>Xe.name),ie(()=>bt.value=Xe.id),bt})()}),null),ie(Xe=>u(rt,ue,Xe)),ie(()=>rt.value=o()),Be})()]})(),fe),V.style.setProperty("display","block"),V.style.setProperty("margin-bottom","0.5rem"),V.style.setProperty("font-weight","500"),s(V,()=>e("inventory.movementType")),re.addEventListener("change",Fe=>{c(Fe.target.value),D(_())}),s(_e,()=>e("inventory.allTypes")),s(Pe,()=>e("inventory.stockIn")),s(ae,()=>e("inventory.stockOut")),s(be,()=>e("inventory.transfer")),s(oe,()=>e("inventory.adjustment")),Ee.style.setProperty("display","block"),Ee.style.setProperty("margin-bottom","0.5rem"),Ee.style.setProperty("font-weight","500"),s(Ee,()=>e("common.startDate")),xe.addEventListener("change",Fe=>h(Be=>({...Be,start:Fe.target.value}))),Me.style.setProperty("display","block"),Me.style.setProperty("margin-bottom","0.5rem"),Me.style.setProperty("font-weight","500"),s(Me,()=>e("common.endDate")),We.addEventListener("change",Fe=>h(Be=>({...Be,end:Fe.target.value}))),u(je,E),s(Ve,()=>P().total),s(Ke,()=>e("inventory.totalMovements")),s(Qe,()=>P().stockIn),s(Ie,()=>e("inventory.stockIn")),s(et,()=>P().stockOut),s(Ct,()=>e("inventory.stockOut")),s(Dt,()=>P().transfers),s(Tt,()=>e("inventory.transfers")),s(qt,()=>P().adjustments),s(st,()=>e("inventory.adjustments")),s(at,()=>O(P().totalValue)),s(kt,()=>e("inventory.totalValue")),s(Q,(()=>{var Fe=ye(()=>p().length===0);return()=>Fe()?(()=>{var Be=mA(),Je=Be.firstChild,rt=Je.nextSibling,vt=rt.nextSibling;return Be.style.setProperty("text-align","center"),Be.style.setProperty("padding","3rem"),Be.style.setProperty("color","var(--text-muted)"),Be.style.setProperty("background","var(--surface-color)"),Be.style.setProperty("border-radius","var(--border-radius)"),Be.style.setProperty("border","1px solid var(--border-color)"),Je.style.setProperty("font-size","1.5rem"),Je.style.setProperty("margin-bottom","1rem"),rt.style.setProperty("font-size","1.1rem"),rt.style.setProperty("margin-bottom","0.5rem"),s(rt,()=>e("inventory.noMovementsFound")),vt.style.setProperty("font-size","0.875rem"),s(vt,()=>e("inventory.tryAdjustingFilters")),Be})():[v(pt,{get each(){return p()},children:Be=>(()=>{var Je=fA(),rt=Je.firstChild,vt=rt.firstChild,Xe=vt.firstChild,bt=Xe.firstChild,ft=bt.nextSibling,Oe=ft.nextSibling,dt=Xe.nextSibling,Bt=dt.firstChild,gt=vt.nextSibling,Nt=gt.firstChild,Ft=Nt.nextSibling,_t=Ft.firstChild,nt=_t.nextSibling;nt.nextSibling;var tr=rt.nextSibling,Ut=tr.firstChild,Xt=Ut.firstChild,dr=Xt.firstChild,Tr=dr.firstChild,Rr=dr.nextSibling,pn=Xt.nextSibling,Mn=pn.firstChild,Mo=Mn.firstChild,uo=Mn.nextSibling,Si=Ut.nextSibling,Oo=Si.firstChild,On=Oo.firstChild,ws=On.firstChild,Pi=On.nextSibling;return Je.addEventListener("mouseleave",St=>{St.currentTarget.style.transform="translateY(0)",St.currentTarget.style.boxShadow="none"}),Je.addEventListener("mouseenter",St=>{St.currentTarget.style.transform="translateY(-2px)",St.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),Je.$$click=()=>pe(Be),u(rt,U),Xe.style.setProperty("display","flex"),Xe.style.setProperty("align-items","center"),Xe.style.setProperty("gap","0.5rem"),Xe.style.setProperty("margin-bottom","0.5rem"),bt.style.setProperty("font-size","1.2rem"),s(bt,()=>te(Be.movementType)),ft.style.setProperty("margin","0"),ft.style.setProperty("font-size","1.1rem"),s(ft,()=>Be.productName),s(Oe,()=>Be.movementType),s(Xe,(()=>{var St=ye(()=>!!Be.invoiceId);return()=>St()&&(()=>{var Gt=yA();return Gt.style.setProperty("padding","0.2rem 0.5rem"),Gt.style.setProperty("border-radius","var(--border-radius-sm)"),Gt.style.setProperty("font-size","0.7rem"),Gt.style.setProperty("font-weight","500"),Gt.style.setProperty("background","var(--primary-color)"),Gt.style.setProperty("color","white"),s(Gt,()=>e("inventory.bulk")),Gt})()})(),null),dt.style.setProperty("font-size","0.875rem"),dt.style.setProperty("color","var(--text-muted)"),s(dt,()=>Be.productSku,Bt),s(dt,()=>N(Be.createdDate),null),s(dt,(()=>{var St=ye(()=>!!Be.invoiceId);return()=>St()&&(()=>{var Gt=gA(),_r=Gt.firstChild,Yr=_r.nextSibling;return Yr.nextSibling,Gt.style.setProperty("margin-left","0.5rem"),Gt.style.setProperty("font-weight","500"),s(Gt,()=>e("common.invoice"),Yr),s(Gt,()=>Be.invoiceId,null),Gt})()})(),null),gt.style.setProperty("text-align","right"),Nt.style.setProperty("font-size","1.25rem"),Nt.style.setProperty("font-weight","700"),Nt.style.setProperty("color","var(--primary-color)"),s(Nt,()=>O(Be.totalCost)),Ft.style.setProperty("font-size","0.875rem"),Ft.style.setProperty("color","var(--text-muted)"),s(Ft,()=>Be.quantity,_t),s(Ft,()=>e("common.units"),nt),s(Ft,()=>O(Be.unitCost),null),u(tr,le),s(dr,()=>e("inventory.location"),Tr),s(Rr,()=>Be.locationName),s(Ut,(()=>{var St=ye(()=>!!Be.fromLocationName);return()=>St()&&(()=>{var Gt=Zh(),_r=Gt.firstChild,Yr=_r.firstChild,vn=_r.nextSibling;return s(_r,()=>e("common.from"),Yr),s(vn,()=>Be.fromLocationName),ie(Qt=>{var $r=I,en=j,tn=K;return Qt.e=u(Gt,$r,Qt.e),Qt.t=u(_r,en,Qt.t),Qt.a=u(vn,tn,Qt.a),Qt},{e:void 0,t:void 0,a:void 0}),Gt})()})(),pn),s(Mn,()=>e("common.reference"),Mo),s(uo,()=>Be.referenceNumber),s(On,()=>e("common.createdBy"),ws),s(Pi,()=>Be.createdBy),s(Si,(()=>{var St=ye(()=>!!Be.notes);return()=>St()&&(()=>{var Gt=Zh(),_r=Gt.firstChild,Yr=_r.firstChild,vn=_r.nextSibling;return s(_r,()=>e("common.notes"),Yr),s(vn,()=>Be.notes),ie(Qt=>{var $r={...I,"border-bottom":"none"},en=j,tn={...K,"max-width":"200px","text-align":"right","font-style":"italic"};return Qt.e=u(Gt,$r,Qt.e),Qt.t=u(_r,en,Qt.t),Qt.a=u(vn,tn,Qt.a),Qt},{e:void 0,t:void 0,a:void 0}),Gt})()})(),null),ie(St=>{var Gt={...k,"border-left":Be.invoiceId?"4px solid var(--primary-color)":"1px solid var(--border-color)",cursor:"pointer"},_r=H(Be.movementType),Yr=I,vn=j,Qt=K,$r=I,en=j,tn=K,Cs=I,Ht=j,Vo=K;return St.e=u(Je,Gt,St.e),St.t=u(Oe,_r,St.t),St.a=u(Xt,Yr,St.a),St.o=u(dr,vn,St.o),St.i=u(Rr,Qt,St.i),St.n=u(pn,$r,St.n),St.s=u(Mn,en,St.s),St.h=u(uo,tn,St.h),St.r=u(Oo,Cs,St.r),St.d=u(On,Ht,St.d),St.l=u(Pi,Vo,St.l),St},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),Je})()}),ye(()=>ye(()=>C()>1)()&&(()=>{var Be=pA(),Je=Be.firstChild,rt=Je.firstChild,vt=rt.firstChild,Xe=rt.nextSibling,bt=Xe.nextSibling,ft=Je.nextSibling,Oe=ft.firstChild,dt=Oe.firstChild,Bt=dt.firstChild,gt=dt.nextSibling,Nt=gt.nextSibling,Ft=Nt.firstChild;return u(Be,R),Je.style.setProperty("display","flex"),Je.style.setProperty("align-items","center"),Je.style.setProperty("gap","0.5rem"),rt.style.setProperty("font-size","0.875rem"),rt.style.setProperty("color","var(--text-muted)"),s(rt,()=>e("common.showPerPage","Show per page"),vt),Xe.addEventListener("change",_t=>{T(Number(_t.target.value)),M(1)}),Xe.style.setProperty("padding","0.25rem 0.5rem"),Xe.style.setProperty("border","1px solid var(--border-color)"),Xe.style.setProperty("border-radius","var(--border-radius-sm)"),Xe.style.setProperty("background","var(--surface-color)"),Xe.style.setProperty("cursor","pointer"),Xe.style.setProperty("font-size","0.875rem"),bt.style.setProperty("font-size","0.875rem"),bt.style.setProperty("color","var(--text-muted)"),bt.style.setProperty("margin-left","1rem"),s(bt,()=>e("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:(L()-1)*$()+1,end:Math.min(L()*$(),S().length),total:S().length})),ft.style.setProperty("display","flex"),ft.style.setProperty("align-items","center"),ft.style.setProperty("gap","0.5rem"),s(ft,v(Le,{variant:"outline",size:"sm",onClick:()=>M(1),get disabled(){return L()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.first","First")}}),Oe),s(ft,v(Le,{variant:"outline",size:"sm",onClick:()=>M(_t=>Math.max(1,_t-1)),get disabled(){return L()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.previous")}}),Oe),s(ft,()=>{const _t=[],nt=C(),tr=L();if(nt<=7)for(let Ut=1;Ut<=nt;Ut++)_t.push(Ut);else{_t.push(1),tr>3&&_t.push("...");for(let Ut=Math.max(2,tr-1);Ut<=Math.min(nt-1,tr+1);Ut++)_t.includes(Ut)||_t.push(Ut);tr<nt-2&&_t.push("..."),_t.includes(nt)||_t.push(nt)}return v(pt,{each:_t,children:Ut=>Ut==="..."?(()=>{var Xt=vA();return Xt.style.setProperty("padding","0 0.5rem"),Xt.style.setProperty("color","var(--text-muted)"),Xt})():(()=>{var Xt=bA();return Xt.$$click=()=>M(Ut),s(Xt,Ut),ie(dr=>u(Xt,X(Ut===L()),dr)),Xt})()})},Oe),s(ft,v(Le,{variant:"outline",size:"sm",onClick:()=>M(_t=>Math.min(C(),_t+1)),get disabled(){return L()===C()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.next")}}),Oe),s(ft,v(Le,{variant:"outline",size:"sm",onClick:()=>M(C()),get disabled(){return L()===C()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.last","Last")}}),Oe),Oe.style.setProperty("display","flex"),Oe.style.setProperty("align-items","center"),Oe.style.setProperty("gap","0.5rem"),Oe.style.setProperty("margin-left","1rem"),dt.style.setProperty("font-size","0.875rem"),dt.style.setProperty("color","var(--text-muted)"),s(dt,()=>e("common.page","Page"),Bt),gt.addEventListener("change",_t=>{const nt=Number(_t.target.value);nt>=1&&nt<=C()&&M(nt)}),gt.style.setProperty("width","4rem"),gt.style.setProperty("padding","0.25rem 0.5rem"),gt.style.setProperty("border","1px solid var(--border-color)"),gt.style.setProperty("border-radius","var(--border-radius-sm)"),gt.style.setProperty("background","var(--surface-color)"),gt.style.setProperty("text-align","center"),gt.style.setProperty("font-size","0.875rem"),Nt.style.setProperty("font-size","0.875rem"),Nt.style.setProperty("color","var(--text-muted)"),s(Nt,()=>e("common.of","of"),Ft),s(Nt,C,null),ie(()=>ut(gt,"max",C())),ie(()=>Xe.value=$()),ie(()=>gt.value=L()),Be})())]})(),null),s(Q,v(oA,{get isOpen(){return Z()},onClose:()=>{ge(!1),ce(null)},get movement(){return ee()},onEdit:se}),null),s(Q,v(Ne,{get when(){return Pt.hasPermission("read_write")},get children(){return v(lA,{get isOpen(){return ne()},onClose:()=>{w(!1),ce(null)},get movement(){return ee()},onMovementUpdated:Y})}}),null),ie(Fe=>{var Be=ue,Je=J,rt=J,vt=F,Xe=z,bt=B,ft=F,Oe={...z,color:"#2d7d32"},dt=B,Bt=F,gt={...z,color:"#d32f2f"},Nt=B,Ft=F,_t={...z,color:"#1976d2"},nt=B,tr=F,Ut={...z,color:"#f57c00"},Xt=B,dr=F,Tr=z,Rr=B;return Fe.e=u(re,Be,Fe.e),Fe.t=u(xe,Je,Fe.t),Fe.a=u(We,rt,Fe.a),Fe.o=u(Ce,vt,Fe.o),Fe.i=u(Ve,Xe,Fe.i),Fe.n=u(Ke,bt,Fe.n),Fe.s=u(He,ft,Fe.s),Fe.h=u(Qe,Oe,Fe.h),Fe.r=u(Ie,dt,Fe.r),Fe.d=u(ot,Bt,Fe.d),Fe.l=u(et,gt,Fe.l),Fe.u=u(Ct,Nt,Fe.u),Fe.c=u(yt,Ft,Fe.c),Fe.w=u(Dt,_t,Fe.w),Fe.m=u(Tt,nt,Fe.m),Fe.f=u($t,tr,Fe.f),Fe.y=u(qt,Ut,Fe.y),Fe.g=u(st,Xt,Fe.g),Fe.p=u(ke,dr,Fe.p),Fe.b=u(at,Tr,Fe.b),Fe.T=u(kt,Rr,Fe.T),Fe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),ie(()=>re.value=a()),ie(()=>xe.value=d().start),ie(()=>We.value=d().end),Q})()};Et(["click"]);var SA=q("<div><p>📋 "),PA=q("<div>"),wA=q("<div><div>📊</div><h3></h3><p></p><div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=name></option><option value=sku></option><option value=category>"),CA=q("<div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div>%</div><div></div></div></div><div></div><div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),AA=q("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),IA=q("<div><div>✅</div><h3></h3><p>"),xA=q("<div><div><h3>📋 </h3><p></p></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div></div><div>"),EA=q("<div><div><div><h2>📋 </h2><button>×"),em=q("<option>"),TA=q("<div>..."),$A=q("<tr><td><div></div><div> • </div></td><td><div></div></td><td><div></div></td><td><div></div></td><td><div>"),kA=q("<tr><td><div></div></td><td><div></div><div> • <!> • </div></td><td><div></div></td><td><input type=number placeholder=0 min=0 step=0.01></td><td><div></div></td><td><input type=text>");const RA=t=>{const{t:e}=ct(),[r,n]=ve([]),[o,i]=ve(!1),[a,c]=ve(!1),[d,h]=ve("all"),[m,g]=ve("all"),[_,A]=ve("name"),[L,M]=ve([]),[$,T]=ve("setup"),ee=async()=>{try{i(!0);const B=await ln.getProducts("prod");if(!B||typeof B!="object"){console.warn("No API results, using local store"),n(De.products);return}const k=Object.keys(B),U=H=>{let I=B[H];return{id:H,name:I.name||"Unknown Product",businessId:I.businessId||"",sku:I.code||I.sku||"",UPC:I.UPC||"",numCode:I.codeN||"",category:I.category||"General",unitCost:I.unitCost||0,unitOfMeasure:I.unitOfMeasure||"pcs",minStockLevel:I.minStockLevel||0,maxStockLevel:I.maxStockLevel||100,isActive:I.isActive!==!1,description:I.description||"",createdDate:I.createdAt||new Date().toISOString(),lastModified:I.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(I.sellingPrice||I.price||"0")}},he=k.map(U);n(he)}catch(B){console.error("Failed to load products from API:",B),n(De.products)}finally{i(!1)}},ce=Ge(()=>[...new Set(r().map(k=>k.category).filter(k=>k))].sort()),Z=Ge(()=>{let B=r().filter(k=>k.isActive);return m()!=="all"&&(B=B.filter(k=>k.category===m())),B.sort((k,U)=>{switch(_()){case"name":return k.name.localeCompare(U.name);case"sku":return k.sku.localeCompare(U.sku);case"category":return k.category.localeCompare(U.category)||k.name.localeCompare(U.name);default:return 0}}),B}),ge=Ge(()=>De.getActiveLocations()),ne=(B,k)=>k&&k!=="all"?De.getStockByProductAndLocation(B,k)?.quantity||0:De.getTotalStockByProduct(B),w=()=>{const B=Z().map(k=>{const U=ne(k.id,d()!=="all"?d():void 0);return{productId:k.id,systemQuantity:U,physicalCount:null,notes:"",variance:0,product:k}});M(B),T("counting")},S=(B,k)=>{M(U=>U.map(he=>{if(he.productId===B){const H=k,le=H!==null?H-he.systemQuantity:0;return{...he,physicalCount:H,variance:le}}return he}))},p=(B,k)=>{M(U=>U.map(he=>he.productId===B?{...he,notes:k}:he))},C=Ge(()=>{const B=L(),k=B.length,U=B.filter(I=>I.physicalCount!==null).length,he=B.filter(I=>I.variance!==0).length,H=B.filter(I=>I.variance>0).length,le=B.filter(I=>I.variance<0).length;return{totalProducts:k,countedProducts:U,remainingProducts:k-U,variances:he,positiveVariances:H,negativeVariances:le,isComplete:U===k}}),P=()=>{const B=L().filter(H=>H.physicalCount!==null&&H.variance!==0);if(B.length===0)return null;const k=[e("inventory.product","Product"),e("inventory.sku","SKU"),e("inventory.category","Category"),e("inventory.location","Location"),e("inventory.systemQty","System Qty"),e("inventory.physicalCount","Physical Count"),e("inventory.variance","Variance"),e("inventory.adjustment","Adjustment"),e("common.notes","Notes"),e("common.date","Date")],U=B.map(H=>[`"${H.product.name}"`,`"${H.product.sku}"`,`"${H.product.category}"`,`"${ue()}"`,H.systemQuantity,H.physicalCount,H.variance,H.variance>0?e("inventory.stockIncrease","Stock Increase"):e("inventory.stockDecrease","Stock Decrease"),`"${H.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")}"`,`"${J()}"`]);return[k.join(","),...U.map(H=>H.join(","))].join(`
`)},x=()=>{const B=P();if(!B){alert(e("inventory.noAdjustmentsToDownload","No adjustments to download"));return}const k=new Blob([B],{type:"text/csv;charset=utf-8;"}),U=document.createElement("a");if(U.download!==void 0){const he=URL.createObjectURL(k);U.setAttribute("href",he),U.setAttribute("download",`inventory-adjustments-${J().replace(/[/:,\s]/g,"-")}.csv`),U.style.visibility="hidden",document.body.appendChild(U),U.click(),document.body.removeChild(U)}},y=async(B=!0)=>{try{c(!0),console.log(L());const k=j=>{let K=De.getProductById(j.productId),R=De.getStockByProductAndLocation(j.productId,d()),X=parseFloat(R?.averageCost+""),O=parseFloat(R?.quantity+"");return{product:{id:j.productId,label:K?.name,code:K?.code},productId:j?.productId,reason:"Physical Count Adjustment",notes:j?.notes||"Physical inventory adjustment",quantity:j?.variance,unitCost:X}},U=L().filter(j=>j.physicalCount!==null&&j.variance!==0).map(k);let he="ADJ_"+Xs();const H=new Date().toISOString(),le={ssg_inventory_key:Xs(),invoiceId:he,referenceNumber:Xs(),movementType:"adjustment",type:"adjustment",locationId:d(),items:U,products:U,generalNotes:"Physical inventory adjustment",description:"Physical Count Adjustment",invoice:he,store:d(),createdBy:"admin",createDate:H};console.log("Saving inventory bulkRequest:",le);const I=await ln.addInventory(le);B&&U.length>0&&x(),console.log("Saving inventory adjustments:",U),await new Promise(j=>setTimeout(j,1e3)),t.onClose()}catch(k){console.error("Failed to save inventory adjustments:",k)}finally{c(!1)}},ue=Ge(()=>d()==="all"?"All Locations":ge().find(k=>k.id===d())?.name||"Unknown Location"),J=()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),E=async()=>{await De.fecthInventory("prod"),await ee()};Hr(async()=>{t.selectedLocationId&&h(t.selectedLocationId),E()});const F=()=>{const B=window.open("","_blank");if(!B){alert("Please allow pop-ups to print the counting sheet");return}const k=z();B.document.write(k),B.document.close(),B.onload=()=>{B.print(),B.onafterprint=()=>{B.close()}}},z=()=>{const B=Z().map((k,U)=>{const he=ne(k.id,d()!=="all"?d():void 0);return`
        <tr>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${U+1}</td>
          <td style="border: 1px solid #000; padding: 8px; font-family: monospace;">${k.sku}</td>
          <td style="border: 1px solid #000; padding: 8px;">
            <div style="font-weight: 500;">${k.name}</div>
            ${k.UPC?`<div style="font-size: 0.8em; color: #666;">UPC: ${k.UPC}</div>`:""}
          </td>
          <td style="border: 1px solid #000; padding: 8px;">${k.category}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${k.unitOfMeasure}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">${he}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; background-color: #f9f9f9;">________</td>
          <td style="border: 1px solid #000; padding: 8px;">_______________</td>
        </tr>
      `}).join("");return`
      <!DOCTYPE html>
      <html>
      <head>
        <title> ${ue()}_${m()}_${e("inventory.countingSheet","Inventory Counting Sheet")} - ${J()}</title>
        <style>
          @page {
            size: letter;
            margin: 0.5in;
          }
          body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            margin: 0;
            padding: 0;
          }
          h1 {
            text-align: center;
            margin: 0 0 10px 0;
            font-size: 24px;
          }
          .header-info {
            text-align: center;
            margin-bottom: 20px;
          }
          .instructions {
            background-color: #f0f0f0;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
          }
          th {
            background-color: #333;
            color: white;
            padding: 8px;
            text-align: left;
            font-weight: bold;
            border: 1px solid #000;
          }
          .summary-table {
            width: 50%;
            margin: 20px auto;
          }
          .signature-section {
            margin-top: 40px;
            display: flex;
            justify-content: space-between;
          }
          .signature-box {
            width: 45%;
            text-align: center;
          }
          .signature-line {
            border-bottom: 1px solid #000;
            margin-bottom: 5px;
            height: 30px;
          }
          @media print {
            tr { page-break-inside: avoid; }
          }
        </style>
      </head>
      <body>
        <h1>${e("inventory.inventoryCountingSheetTitle","INVENTORY COUNTING SHEET")}</h1>
        <div class="header-info">
          <p><strong>${e("inventory.location","Location")}:</strong> ${ue()}</p>
          <p><strong>${e("common.category","Category")}:</strong> ${m()==="all"?e("inventory.allCategories","All Categories"):m()}</p>
          <p><strong>${e("common.date","Date")}:</strong> ${J()}</p>
          <p style="margin-top: 10px;">
            <span style="margin-right: 30px;">${e("inventory.countedBy","Counted by")}: _________________________</span>
            <span>${e("inventory.verifiedBy","Verified by")}: _________________________</span>
          </p>
        </div>

        <table>
          <thead>
            <tr>
              <th style="width: 5%; text-align: center;">#</th>
              <th style="width: 12%;">${e("inventory.sku","SKU")}</th>
              <th style="width: 25%;">${e("inventory.productName","Product Name")}</th>
              <th style="width: 12%;">${e("common.category","Category")}</th>
              <th style="width: 8%; text-align: center;">${e("inventory.unit","Unit")}</th>
              <th style="width: 10%; text-align: center;">${e("inventory.systemQty","System Qty")}</th>
              <th style="width: 12%; text-align: center; background-color: #f0f0f0;">${e("inventory.physicalCount","Physical Count")}</th>
              <th style="width: 16%;">${e("common.notes","Notes")}</th>
            </tr>
          </thead>
          <tbody>
            ${B}
          </tbody>
        </table>
        
        <table class="summary-table">
          <tr>
            <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
              ${e("inventory.totalProductsListed","Total Products Listed")}:
            </td>
            <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">
              ${Z().length}
            </td>
          </tr>
          <tr>
            <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
              ${e("inventory.itemsCounted","Items Counted")}:
            </td>
            <td style="border: 1px solid #000; padding: 8px; text-align: center;">
              ___________
            </td>
          </tr>
          <tr>
            <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
              ${e("inventory.discrepanciesFound","Discrepancies Found")}:
            </td>
            <td style="border: 1px solid #000; padding: 8px; text-align: center;">
              ___________
            </td>
          </tr>
        </table>
        
        <div class="signature-section">
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.counterSignature","Counter Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.supervisorSignature","Supervisor Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
        </div>
      </body>
      </html>
    `};return v(Ne,{get when(){return t.isOpen},get children(){var B=EA(),k=B.firstChild,U=k.firstChild,he=U.firstChild;he.firstChild;var H=he.nextSibling;return B.style.setProperty("position","fixed"),B.style.setProperty("top","0"),B.style.setProperty("left","0"),B.style.setProperty("right","0"),B.style.setProperty("bottom","0"),B.style.setProperty("background","rgba(0, 0, 0, 0.5)"),B.style.setProperty("z-index","1000"),B.style.setProperty("display","flex"),B.style.setProperty("align-items","center"),B.style.setProperty("justify-content","center"),k.style.setProperty("background","white"),k.style.setProperty("border-radius","var(--border-radius)"),k.style.setProperty("padding","2rem"),k.style.setProperty("width","95%"),k.style.setProperty("height","95%"),k.style.setProperty("max-width","1400px"),k.style.setProperty("overflow-y","auto"),k.style.setProperty("position","relative"),U.style.setProperty("display","flex"),U.style.setProperty("justify-content","space-between"),U.style.setProperty("align-items","center"),U.style.setProperty("margin-bottom","2rem"),U.style.setProperty("border-bottom","1px solid var(--border-color)"),U.style.setProperty("padding-bottom","1rem"),he.style.setProperty("margin","0"),he.style.setProperty("font-size","1.5rem"),s(he,()=>e("inventory.physicalInventoryCount","Physical Inventory Count"),null),ko(H,"click",t.onClose,!0),H.style.setProperty("background","none"),H.style.setProperty("border","none"),H.style.setProperty("font-size","1.5rem"),H.style.setProperty("cursor","pointer"),H.style.setProperty("padding","0.5rem"),s(k,v(Ne,{get when(){return $()==="setup"},get children(){var le=wA(),I=le.firstChild,j=I.nextSibling,K=j.nextSibling,R=K.nextSibling,X=R.firstChild,O=X.firstChild,N=O.firstChild,te=O.nextSibling,de=te.firstChild,pe=X.nextSibling,se=pe.firstChild,Y=se.firstChild,D=se.nextSibling,Q=D.firstChild,W=pe.nextSibling,me=W.firstChild,fe=me.firstChild,V=me.nextSibling,re=V.firstChild,_e=re.nextSibling,Pe=_e.nextSibling;return le.style.setProperty("text-align","center"),le.style.setProperty("padding","2rem"),le.style.setProperty("max-width","600px"),le.style.setProperty("margin","0 auto"),I.style.setProperty("font-size","3rem"),I.style.setProperty("margin-bottom","1rem"),j.style.setProperty("margin-bottom","1rem"),s(j,()=>e("inventory.setupPhysicalCount","Setup Physical Inventory Count")),K.style.setProperty("margin-bottom","2rem"),K.style.setProperty("color","var(--text-muted)"),s(K,()=>e("inventory.setupDescription","Configure your physical inventory count settings and begin the counting process.")),R.style.setProperty("display","grid"),R.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),R.style.setProperty("gap","1rem"),R.style.setProperty("margin-bottom","2rem"),R.style.setProperty("padding","1rem"),R.style.setProperty("background","var(--surface-color)"),R.style.setProperty("border-radius","var(--border-radius)"),R.style.setProperty("text-align","left"),O.style.setProperty("display","block"),O.style.setProperty("margin-bottom","0.5rem"),O.style.setProperty("font-weight","500"),s(O,()=>e("inventory.location","Location"),N),te.addEventListener("change",ae=>h(ae.target.value)),te.style.setProperty("width","100%"),te.style.setProperty("padding","0.5rem"),te.style.setProperty("border","1px solid var(--border-color)"),te.style.setProperty("border-radius","var(--border-radius-sm)"),s(de,()=>e("inventory.allLocations","All Locations")),s(te,v(pt,{get each(){return ge()},children:ae=>(()=>{var be=em();return s(be,()=>ae.name),ie(()=>be.value=ae.id),be})()}),null),se.style.setProperty("display","block"),se.style.setProperty("margin-bottom","0.5rem"),se.style.setProperty("font-weight","500"),s(se,()=>e("inventory.category","Category"),Y),D.addEventListener("change",ae=>g(ae.target.value)),D.style.setProperty("width","100%"),D.style.setProperty("padding","0.5rem"),D.style.setProperty("border","1px solid var(--border-color)"),D.style.setProperty("border-radius","var(--border-radius-sm)"),s(Q,()=>e("products.allCategories","All Categories")),s(D,v(pt,{get each(){return ce()},children:ae=>(()=>{var be=em();return be.value=ae,s(be,ae),be})()}),null),me.style.setProperty("display","block"),me.style.setProperty("margin-bottom","0.5rem"),me.style.setProperty("font-weight","500"),s(me,()=>e("inventory.sortBy","Sort By"),fe),V.addEventListener("change",ae=>A(ae.target.value)),V.style.setProperty("width","100%"),V.style.setProperty("padding","0.5rem"),V.style.setProperty("border","1px solid var(--border-color)"),V.style.setProperty("border-radius","var(--border-radius-sm)"),s(re,()=>e("inventory.productName","Product Name")),s(_e,()=>e("inventory.sku","SKU")),s(Pe,()=>e("inventory.category","Category")),s(le,v(Ne,{get when(){return!o()},get fallback(){return(()=>{var ae=TA(),be=ae.firstChild;return ae.style.setProperty("padding","2rem"),s(ae,()=>e("common.loading","Loading"),be),ae})()},get children(){return[(()=>{var ae=SA(),be=ae.firstChild;return be.firstChild,ae.style.setProperty("padding","1rem"),ae.style.setProperty("background","#fff3cd"),ae.style.setProperty("border-radius","var(--border-radius-sm)"),ae.style.setProperty("margin-bottom","2rem"),be.style.setProperty("margin","0"),be.style.setProperty("color","#856404"),s(be,()=>e("inventory.countWillInclude","This count will include {{count}} products from {{location}} in {{category}} category.",{count:Z().length,location:ue(),category:m()==="all"?e("inventory.allCategories","all categories"):m()}),null),ae})(),v(Ne,{get when(){return ye(()=>m()!=="all")()&&d()!=="all"},get children(){var ae=PA();return ae.style.setProperty("display","grid"),ae.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),ae.style.setProperty("gap","1rem"),ae.style.setProperty("margin-bottom","2rem"),ae.style.setProperty("padding","1rem"),ae.style.setProperty("background","var(--surface-color)"),ae.style.setProperty("border-radius","var(--border-radius)"),s(ae,v(Ne,{get when(){return Pt.hasPermission("physicalInventoryCountingForm")},get children(){return v(Le,{variant:"primary",size:"large",onClick:w,get disabled(){return o()||Z().length===0},get children(){return["🚀 ",ye(()=>e("inventory.startCounting","Start Physical Count"))]}})}}),null),s(ae,v(Le,{variant:"primary",onClick:F,get disabled(){return o()},get children(){return["🖨️ ",ye(()=>e("common.print","Print"))]}}),null),ae}})]}}),null),ie(()=>te.value=d()),ie(()=>D.value=m()),ie(()=>V.value=_()),le}}),null),s(k,v(Ne,{get when(){return $()==="counting"},get children(){var le=CA(),I=le.firstChild,j=I.firstChild,K=j.firstChild,R=K.nextSibling,X=j.nextSibling,O=X.firstChild,N=O.nextSibling,te=X.nextSibling,de=te.firstChild,pe=de.nextSibling,se=te.nextSibling,Y=se.firstChild,D=Y.firstChild,Q=Y.nextSibling,W=I.nextSibling,me=W.nextSibling,fe=me.firstChild,V=fe.firstChild,re=V.firstChild,_e=re.firstChild,Pe=_e.nextSibling,ae=Pe.nextSibling,be=ae.nextSibling,oe=be.nextSibling,Se=oe.nextSibling,Ee=V.nextSibling;return I.style.setProperty("display","grid"),I.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),I.style.setProperty("gap","1rem"),I.style.setProperty("margin-bottom","2rem"),I.style.setProperty("padding","1rem"),I.style.setProperty("background","var(--surface-color)"),I.style.setProperty("border-radius","var(--border-radius)"),j.style.setProperty("text-align","center"),K.style.setProperty("font-size","1.5rem"),K.style.setProperty("font-weight","700"),K.style.setProperty("color","var(--primary-color)"),s(K,()=>C().countedProducts),R.style.setProperty("font-size","0.875rem"),R.style.setProperty("color","var(--text-muted)"),s(R,()=>e("inventory.counted","Counted")),X.style.setProperty("text-align","center"),O.style.setProperty("font-size","1.5rem"),O.style.setProperty("font-weight","700"),O.style.setProperty("color","#ff9800"),s(O,()=>C().remainingProducts),N.style.setProperty("font-size","0.875rem"),N.style.setProperty("color","var(--text-muted)"),s(N,()=>e("inventory.remaining","Remaining")),te.style.setProperty("text-align","center"),de.style.setProperty("font-size","1.5rem"),de.style.setProperty("font-weight","700"),de.style.setProperty("color","#f44336"),s(de,()=>C().variances),pe.style.setProperty("font-size","0.875rem"),pe.style.setProperty("color","var(--text-muted)"),s(pe,()=>e("inventory.variances","Variances")),se.style.setProperty("text-align","center"),Y.style.setProperty("font-size","1.5rem"),Y.style.setProperty("font-weight","700"),s(Y,()=>Math.round(C().countedProducts/C().totalProducts*100),D),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),s(Q,()=>e("inventory.complete","Complete")),W.style.setProperty("display","flex"),W.style.setProperty("gap","1rem"),W.style.setProperty("margin-bottom","2rem"),W.style.setProperty("justify-content","center"),s(W,v(Le,{variant:"outline",onClick:()=>T("setup"),get children(){return["⬅️ ",ye(()=>e("common.back","Back to Setup"))]}}),null),s(W,v(Le,{variant:"primary",onClick:()=>T("review"),get children(){return["📋 ",ye(()=>e("inventory.reviewAdjustments","Review Adjustments"))]}}),null),me.style.setProperty("border","1px solid var(--border-color)"),me.style.setProperty("border-radius","var(--border-radius)"),me.style.setProperty("overflow-x","auto"),fe.style.setProperty("width","100%"),fe.style.setProperty("border-collapse","collapse"),re.style.setProperty("background","var(--surface-color)"),_e.style.setProperty("padding","1rem"),_e.style.setProperty("text-align","left"),_e.style.setProperty("border-bottom","1px solid var(--border-color)"),s(_e,()=>e("inventory.no","No")),Pe.style.setProperty("padding","1rem"),Pe.style.setProperty("text-align","left"),Pe.style.setProperty("border-bottom","1px solid var(--border-color)"),s(Pe,()=>e("inventory.product","Product")),ae.style.setProperty("padding","1rem"),ae.style.setProperty("text-align","center"),ae.style.setProperty("border-bottom","1px solid var(--border-color)"),s(ae,()=>e("inventory.systemQty","System Qty")),be.style.setProperty("padding","1rem"),be.style.setProperty("text-align","center"),be.style.setProperty("border-bottom","1px solid var(--border-color)"),s(be,()=>e("inventory.physicalCount","Physical Count")),oe.style.setProperty("padding","1rem"),oe.style.setProperty("text-align","center"),oe.style.setProperty("border-bottom","1px solid var(--border-color)"),s(oe,()=>e("inventory.variance","Variance")),Se.style.setProperty("padding","1rem"),Se.style.setProperty("text-align","left"),Se.style.setProperty("border-bottom","1px solid var(--border-color)"),s(Se,()=>e("common.notes","Notes")),s(Ee,v(pt,{get each(){return L()},children:(xe,$e)=>v(DA,{get index(){return $e()},updatePhysicalCount:S,entry:xe,updateNotes:p})})),ie(xe=>(xe=C().isComplete?"#4caf50":"#ff9800")!=null?Y.style.setProperty("color",xe):Y.style.removeProperty("color")),le}}),null),s(k,v(Ne,{get when(){return $()==="review"},get children(){var le=xA(),I=le.firstChild,j=I.firstChild;j.firstChild;var K=j.nextSibling,R=I.nextSibling,X=R.firstChild,O=X.firstChild,N=O.nextSibling,te=X.nextSibling,de=te.firstChild,pe=de.nextSibling,se=te.nextSibling,Y=se.firstChild,D=Y.nextSibling,Q=R.nextSibling;return I.style.setProperty("text-align","center"),I.style.setProperty("margin-bottom","2rem"),j.style.setProperty("margin-bottom","1rem"),s(j,()=>e("inventory.reviewAndConfirm","Review and Confirm Adjustments"),null),K.style.setProperty("color","var(--text-muted)"),s(K,()=>e("inventory.reviewDescription","Review the inventory adjustments below and confirm to update your system.")),R.style.setProperty("display","grid"),R.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),R.style.setProperty("gap","1rem"),R.style.setProperty("margin-bottom","2rem"),R.style.setProperty("padding","1rem"),R.style.setProperty("background","var(--surface-color)"),R.style.setProperty("border-radius","var(--border-radius)"),X.style.setProperty("text-align","center"),O.style.setProperty("font-size","1.5rem"),O.style.setProperty("font-weight","700"),O.style.setProperty("color","#4caf50"),s(O,()=>C().positiveVariances),N.style.setProperty("font-size","0.875rem"),N.style.setProperty("color","var(--text-muted)"),s(N,()=>e("inventory.stockIncreases","Stock Increases")),te.style.setProperty("text-align","center"),de.style.setProperty("font-size","1.5rem"),de.style.setProperty("font-weight","700"),de.style.setProperty("color","#f44336"),s(de,()=>C().negativeVariances),pe.style.setProperty("font-size","0.875rem"),pe.style.setProperty("color","var(--text-muted)"),s(pe,()=>e("inventory.stockDecreases","Stock Decreases")),se.style.setProperty("text-align","center"),Y.style.setProperty("font-size","1.5rem"),Y.style.setProperty("font-weight","700"),Y.style.setProperty("color","var(--primary-color)"),s(Y,()=>C().variances),D.style.setProperty("font-size","0.875rem"),D.style.setProperty("color","var(--text-muted)"),s(D,()=>e("inventory.totalAdjustments","Total Adjustments")),Q.style.setProperty("display","flex"),Q.style.setProperty("gap","1rem"),Q.style.setProperty("margin-bottom","2rem"),Q.style.setProperty("justify-content","center"),Q.style.setProperty("flex-wrap","wrap"),s(Q,v(Le,{variant:"outline",onClick:()=>T("counting"),get children(){return["⬅️ ",ye(()=>e("common.back","Back to Counting"))]}}),null),s(Q,v(Le,{variant:"outline",onClick:x,get disabled(){return C().variances===0},get children(){return["📥 ",ye(()=>e("inventory.downloadCSV","Download CSV"))]}}),null),s(Q,v(Le,{variant:"primary",onClick:y,get disabled(){return a()||C().variances===0},get children(){return ye(()=>!!a())()?"💾 "+e("common.saving","Saving")+"...":"✅ "+e("inventory.confirmAdjustments","Confirm Adjustments")}}),null),s(le,v(Ne,{get when(){return C().variances>0},get children(){var W=AA(),me=W.firstChild,fe=me.firstChild,V=fe.firstChild,re=V.firstChild,_e=re.nextSibling,Pe=_e.nextSibling,ae=Pe.nextSibling,be=ae.nextSibling,oe=fe.nextSibling;return W.style.setProperty("border","1px solid var(--border-color)"),W.style.setProperty("border-radius","var(--border-radius)"),W.style.setProperty("overflow-x","auto"),me.style.setProperty("width","100%"),me.style.setProperty("border-collapse","collapse"),V.style.setProperty("background","var(--surface-color)"),re.style.setProperty("padding","1rem"),re.style.setProperty("text-align","left"),re.style.setProperty("border-bottom","1px solid var(--border-color)"),s(re,()=>e("inventory.product","Product")),_e.style.setProperty("padding","1rem"),_e.style.setProperty("text-align","center"),_e.style.setProperty("border-bottom","1px solid var(--border-color)"),s(_e,()=>e("inventory.systemQty","System Qty")),Pe.style.setProperty("padding","1rem"),Pe.style.setProperty("text-align","center"),Pe.style.setProperty("border-bottom","1px solid var(--border-color)"),s(Pe,()=>e("inventory.physicalCount","Physical Count")),ae.style.setProperty("padding","1rem"),ae.style.setProperty("text-align","center"),ae.style.setProperty("border-bottom","1px solid var(--border-color)"),s(ae,()=>e("inventory.adjustment","Adjustment")),be.style.setProperty("padding","1rem"),be.style.setProperty("text-align","left"),be.style.setProperty("border-bottom","1px solid var(--border-color)"),s(be,()=>e("common.notes","Notes")),s(oe,v(pt,{get each(){return L().filter(Se=>Se.variance!==0)},children:Se=>(()=>{var Ee=$A(),xe=Ee.firstChild,$e=xe.firstChild,Me=$e.nextSibling,We=Me.firstChild,je=xe.nextSibling,Ce=je.firstChild,Ve=je.nextSibling,Ke=Ve.firstChild,He=Ve.nextSibling,Qe=He.firstChild,Ie=He.nextSibling,ot=Ie.firstChild;return Ee.style.setProperty("border-bottom","1px solid var(--border-color)"),xe.style.setProperty("padding","1rem"),$e.style.setProperty("font-weight","500"),s($e,()=>Se.product.name),Me.style.setProperty("font-size","0.875rem"),Me.style.setProperty("color","var(--text-muted)"),s(Me,()=>Se.product.sku,We),s(Me,()=>Se.product.category,null),je.style.setProperty("padding","1rem"),je.style.setProperty("text-align","center"),Ce.style.setProperty("font-weight","600"),s(Ce,()=>Se.systemQuantity),Ve.style.setProperty("padding","1rem"),Ve.style.setProperty("text-align","center"),Ke.style.setProperty("font-weight","600"),s(Ke,()=>Se.physicalCount),He.style.setProperty("padding","1rem"),He.style.setProperty("text-align","center"),Qe.style.setProperty("font-weight","700"),s(Qe,()=>Se.variance>0?"+":"",null),s(Qe,()=>Se.variance,null),Ie.style.setProperty("padding","1rem"),ot.style.setProperty("font-size","0.875rem"),s(ot,()=>Se.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")),ie(et=>{var Ct=Se.variance>0?"#d4edda":"#f8d7da",yt=Se.variance>0?"#4caf50":"#f44336";return Ct!==et.e&&((et.e=Ct)!=null?Ee.style.setProperty("background",Ct):Ee.style.removeProperty("background")),yt!==et.t&&((et.t=yt)!=null?Qe.style.setProperty("color",yt):Qe.style.removeProperty("color")),et},{e:void 0,t:void 0}),Ee})()})),W}}),null),s(le,v(Ne,{get when(){return C().variances===0},get children(){var W=IA(),me=W.firstChild,fe=me.nextSibling,V=fe.nextSibling;return W.style.setProperty("text-align","center"),W.style.setProperty("padding","3rem"),W.style.setProperty("background","var(--surface-color)"),W.style.setProperty("border-radius","var(--border-radius)"),me.style.setProperty("font-size","3rem"),me.style.setProperty("margin-bottom","1rem"),fe.style.setProperty("margin-bottom","0.5rem"),s(fe,()=>e("inventory.perfectCount","Perfect Count!")),V.style.setProperty("color","var(--text-muted)"),s(V,()=>e("inventory.noVariances","No variances found. Your physical count matches the system exactly.")),W}}),null),le}}),null),B}})},DA=t=>{const{t:e}=ct(),[r,n]=ve(""),[o,i]=ve("");let{entry:a,updatePhysicalCount:c,updateNotes:d,index:h}=t;Hr(()=>{i(a?.notes),n(a?.physicalCount)});const m=()=>{let g=document.getElementById(`physicalCountInput_${h+2}`);if(console.log(hl(r()),!g),hl(r())&&!g){c(a?.productId,r()===""?null:parseFloat(r()));return}if(hl(r())&&g){g.focus(),c(a?.productId,r()===""?null:parseFloat(r()));return}};return(()=>{var g=kA(),_=g.firstChild,A=_.firstChild,L=_.nextSibling,M=L.firstChild,$=M.nextSibling,T=$.firstChild,ee=T.nextSibling;ee.nextSibling;var ce=L.nextSibling,Z=ce.firstChild,ge=ce.nextSibling,ne=ge.firstChild,w=ge.nextSibling,S=w.firstChild,p=w.nextSibling,C=p.firstChild;return g.style.setProperty("border-bottom","1px solid var(--border-color)"),_.style.setProperty("padding","1rem"),_.style.setProperty("text-align","center"),A.style.setProperty("font-weight","600"),s(A,h+1),L.style.setProperty("padding","1rem"),M.style.setProperty("font-weight","500"),s(M,()=>a?.product.name),$.style.setProperty("font-size","0.875rem"),$.style.setProperty("color","var(--text-muted)"),s($,()=>a?.product.sku,T),s($,()=>a?.product.category,ee),s($,()=>a?.product.unitOfMeasure,null),ce.style.setProperty("padding","1rem"),ce.style.setProperty("text-align","center"),Z.style.setProperty("font-weight","600"),s(Z,()=>a?.systemQuantity),ge.style.setProperty("padding","1rem"),ge.style.setProperty("text-align","center"),ne.addEventListener("blur",()=>{m()}),ne.$$keydown=P=>{P.keyCode===13&&m(),P.keyCode===27&&m(),P.keyCode},ne.$$input=P=>{const x=P.target.value;n(x)},ut(ne,"id",`physicalCountInput_${h+1}`),ut(ne,"tabindex",h),ne.style.setProperty("width","100px"),ne.style.setProperty("padding","0.5rem"),ne.style.setProperty("border","1px solid var(--border-color)"),ne.style.setProperty("border-radius","var(--border-radius-sm)"),ne.style.setProperty("text-align","center"),w.style.setProperty("padding","1rem"),w.style.setProperty("text-align","center"),S.style.setProperty("font-weight","600"),s(S,()=>a?.variance>0?"+":"",null),s(S,()=>a?.variance||"—",null),p.style.setProperty("padding","1rem"),C.addEventListener("blur",P=>{d(a?.productId,o())}),C.$$keydown=P=>{P.keyCode===13&&d(a?.productId,o()),P.keyCode===27&&d(a?.productId,o()),P.keyCode===9&&d(a?.productId,o())},C.$$input=P=>{const x=P.target.value;i(x)},C.style.setProperty("width","200px"),C.style.setProperty("padding","0.5rem"),C.style.setProperty("border","1px solid var(--border-color)"),C.style.setProperty("border-radius","var(--border-radius-sm)"),ie(P=>{var x=a?.physicalCount!==null?a?.variance!==0?"#fff3cd":"#d4edda":"transparent",y=a?.variance>0?"#4caf50":a?.variance<0?"#f44336":"var(--text-muted)",ue=e("inventory.addNotes","Add notes...");return x!==P.e&&((P.e=x)!=null?g.style.setProperty("background",x):g.style.removeProperty("background")),y!==P.t&&((P.t=y)!=null?S.style.setProperty("color",y):S.style.removeProperty("color")),ue!==P.a&&ut(C,"placeholder",P.a=ue),P},{e:void 0,t:void 0,a:void 0}),ie(()=>ne.value=r()||""),ie(()=>C.value=o()||""),g})()};Et(["click","input","keydown"]);function NA(t,e=300,r=!1){let n,o;const i=()=>{n!==void 0&&(clearTimeout(n),n=void 0),o=void 0},a=()=>{n!==void 0&&o!==void 0&&(clearTimeout(n),n=void 0,t(...o),o=void 0)},c=(...d)=>{o=d,n!==void 0&&clearTimeout(n),r&&n===void 0&&t(...d),n=window.setTimeout(()=>{r||t(...d),n=void 0,o=void 0},e)};return hi(()=>{i()}),{debounced:c,cancel:i,flush:a}}function LA(t,e=300){const[r,n]=ve(!1);let o;const i=async h=>{if(o&&o.abort(),!h.trim()){n(!1);return}o=new AbortController,n(!0);try{await t(h)}catch(m){m instanceof Error&&m.name!=="AbortError"&&console.error("Search error:",m)}finally{o.signal.aborted||n(!1)}},{debounced:a,cancel:c}=NA(i,e,!1),d=()=>{c(),o&&o.abort(),n(!1)};return hi(()=>{d()}),{search:a,isSearching:r,cancel:d}}var tm=q("<div>"),MA=q("<div><h3></h3><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),OA=q("<div><h3></h3><div><div><div><span></span><span></span></div><div><span></span><span></span></div></div><div><div><span></span><span></span></div><div><span></span><span>%"),VA=q("<div><h4>"),BA=q("<div><h3></h3><div><div><div><span></span><span> </span></div><div><span></span><span> </span></div></div><div><div><span></span><span> </span></div><div><span></span><span>"),FA=q("<div><h3></h3><div><span></span><span></span></div><div><span></span><span>"),rm=q("<div><h3>"),UA=q("<div><div><div><h2></h2><div>SKU: <!> • </div></div><div></div></div><div><button></button><button></button><button></button></div><div>"),jA=q("<span>✓ "),zA=q("<span>✗ "),qA=q("<div><div><span><span> • </span></span><span> </span></div><div>: <!> • <!>: "),GA=q("<div>📦 "),HA=q("<div>Ref: "),YA=q("<div><div><div><span></span><span></span><span></span></div><div><span></span></div></div><div><div> </div><div>"),WA=q("<div><h4></h4><div></div><div>"),KA=q("<div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div> <!> × </div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div>Min: <!> • Max: ");const QA=t=>{const{t:e}=ct(),[r,n]=ve("details"),o=Ge(()=>{if(!t.product)return null;const p=De.getTotalStockByProduct(t.product.id),C=De.getStockByProduct(t.product.id),P=p<=t.product.minStockLevel,x=p===0,y=p>=t.product.maxStockLevel;return{total:p,byLocation:C,status:x?"out":P?"low":y?"over":"good",statusText:x?e("products.outOfStock","Out of Stock"):P?e("products.lowStock","Low Stock"):y?e("products.overStock","Over Stock"):e("products.inStock","In Stock")}}),i=p=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(p),a=p=>new Date(p).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),c=Ge(()=>!t.product||t.product.unitCost===0?0:((t.product.sellingPrice-t.product.unitCost)/t.product.unitCost*100).toFixed(2)),d=Ge(()=>t.product?De.movements.filter(p=>p.productId===t.product.id).sort((p,C)=>new Date(C.createdDate).getTime()-new Date(p.createdDate).getTime()):[]),h=Ge(()=>{if(!t.product)return null;const p=d(),C=o(),P=new Date;P.setDate(P.getDate()-30);const x=p.filter(ue=>new Date(ue.createdDate)>=P),y=p.reduce((ue,J)=>{const E=J.productId===t.product.id?J:null;return ue+(E?E.quantity*E.unitCost:0)},0);return{recentMovements:p.length,movements30Days:x.length,totalValue:(C?.total||0)*t.product.unitCost,averageMovementValue:p.length>0?y/p.length:0,lastMovementDate:p.length>0?p[0].createdDate:null}}),m={"margin-bottom":"2rem"},g={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},_={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},A={"font-weight":"400",color:"var(--text-primary)","font-size":"1rem"},L=p=>({in:"📦",out:"📤",transfer:"🔄",adjustment:"⚖️"})[p]||"📋";function M(p){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[p]||{bg:"#f5f5f5",color:"#666"}}const $=p=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:M(p).bg,color:M(p).color}),T=p=>{const C={good:{background:"#d4edda",color:"#155724"},low:{background:"#fff3cd",color:"#856404"},out:{background:"#f8d7da",color:"#721c24"},over:{background:"#cce5ff",color:"#004085"}};return{display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500",...C[p]||C.good}},ee={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"},ce={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1rem","margin-bottom":"0.75rem"},Z={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1.5rem","padding-bottom":"1rem","border-bottom":"2px solid var(--border-color)"},ge={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},ne=p=>({padding:"0.75rem 1.5rem",background:"none",border:"none","border-bottom":p?"2px solid var(--primary-color)":"2px solid transparent",color:p?"var(--primary-color)":"var(--text-muted)","font-weight":p?"600":"400",cursor:"pointer",transition:"all 0.2s","font-size":"0.875rem"}),w={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-bottom":"0.5rem"},S={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1.5rem","margin-bottom":"1rem"};return v(br,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("products.productDetails","Product Details")},size:"large",get children(){return v(Ne,{get when(){return t.product},get fallback(){return(()=>{var p=tm();return p.style.setProperty("text-align","center"),p.style.setProperty("padding","2rem"),p.style.setProperty("color","var(--text-muted)"),s(p,()=>e("products.noProductSelected","No product selected")),p})()},children:p=>(()=>{var C=UA(),P=C.firstChild,x=P.firstChild,y=x.firstChild,ue=y.nextSibling,J=ue.firstChild,E=J.nextSibling;E.nextSibling;var F=x.nextSibling,z=P.nextSibling,B=z.firstChild,k=B.nextSibling,U=k.nextSibling,he=z.nextSibling;return s(C,()=>JSON.stringify(p),P),u(P,Z),y.style.setProperty("margin","0"),y.style.setProperty("font-size","1.5rem"),y.style.setProperty("margin-bottom","0.25rem"),s(y,()=>p().name),ue.style.setProperty("color","var(--text-muted)"),s(ue,()=>p().sku,E),s(ue,()=>p().category,null),s(F,()=>o()?.statusText),u(z,ge),B.$$click=()=>n("details"),s(B,()=>e("products.details","Details")),k.$$click=()=>n("movements"),s(k,()=>e("products.movements","Movements")),U.$$click=()=>n("analytics"),s(U,()=>e("products.analytics","Analytics")),s(C,v(Ne,{get when(){return r()==="details"},get children(){return[(()=>{var H=MA(),le=H.firstChild,I=le.nextSibling,j=I.firstChild,K=j.nextSibling,R=I.nextSibling,X=R.firstChild,O=X.nextSibling,N=R.nextSibling,te=N.firstChild,de=te.nextSibling;return le.style.setProperty("margin-bottom","1rem"),le.style.setProperty("font-size","1.1rem"),s(le,()=>e("products.basicInformation","Basic Information")),s(j,()=>e("products.description","Description")),s(K,()=>p().description||e("common.notAvailable","N/A")),s(X,()=>e("products.unitOfMeasure","Unit of Measure")),s(O,()=>p().unitOfMeasure),s(te,()=>e("products.status","Status")),s(de,(()=>{var pe=ye(()=>!!p().isActive);return()=>pe()?(()=>{var se=jA();return se.firstChild,se.style.setProperty("color","#2e7d32"),s(se,()=>e("common.active","Active"),null),se})():(()=>{var se=zA();return se.firstChild,se.style.setProperty("color","#d32f2f"),s(se,()=>e("common.inactive","Inactive"),null),se})()})()),ie(pe=>{var se=m,Y=g,D=_,Q=A,W=g,me=_,fe=A,V=g,re=_,_e=A;return pe.e=u(H,se,pe.e),pe.t=u(I,Y,pe.t),pe.a=u(j,D,pe.a),pe.o=u(K,Q,pe.o),pe.i=u(R,W,pe.i),pe.n=u(X,me,pe.n),pe.s=u(O,fe,pe.s),pe.h=u(N,V,pe.h),pe.r=u(te,re,pe.r),pe.d=u(de,_e,pe.d),pe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),H})(),(()=>{var H=OA(),le=H.firstChild,I=le.nextSibling,j=I.firstChild,K=j.firstChild,R=K.firstChild,X=R.nextSibling,O=K.nextSibling,N=O.firstChild,te=N.nextSibling,de=j.nextSibling,pe=de.firstChild,se=pe.firstChild,Y=se.nextSibling,D=pe.nextSibling,Q=D.firstChild,W=Q.nextSibling,me=W.firstChild;return le.style.setProperty("margin-bottom","1rem"),le.style.setProperty("font-size","1.1rem"),s(le,()=>e("products.pricingInformation","Pricing Information")),s(R,()=>e("products.unitCost","Unit Cost")),s(X,()=>i(p().unitCost)),s(N,()=>e("products.sellingPrice","Selling Price")),s(te,()=>i(p().sellingPrice)),s(se,()=>e("products.profit","Profit")),s(Y,()=>i(p().sellingPrice-p().unitCost)),s(Q,()=>e("products.profitMargin","Profit Margin")),s(W,c,me),ie(fe=>{var V=m,re=ee,_e=g,Pe=_,ae=A,be=g,oe=_,Se=A,Ee=g,xe=_,$e=A,Me=g,We=_,je=A;return fe.e=u(H,V,fe.e),fe.t=u(I,re,fe.t),fe.a=u(K,_e,fe.a),fe.o=u(R,Pe,fe.o),fe.i=u(X,ae,fe.i),fe.n=u(O,be,fe.n),fe.s=u(N,oe,fe.s),fe.h=u(te,Se,fe.h),fe.r=u(pe,Ee,fe.r),fe.d=u(se,xe,fe.d),fe.l=u(Y,$e,fe.l),fe.u=u(D,Me,fe.u),fe.c=u(Q,We,fe.c),fe.w=u(W,je,fe.w),fe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),H})(),(()=>{var H=BA(),le=H.firstChild,I=le.nextSibling,j=I.firstChild,K=j.firstChild,R=K.firstChild,X=R.nextSibling,O=X.firstChild,N=K.nextSibling,te=N.firstChild,de=te.nextSibling,pe=de.firstChild,se=j.nextSibling,Y=se.firstChild,D=Y.firstChild,Q=D.nextSibling,W=Q.firstChild,me=Y.nextSibling,fe=me.firstChild,V=fe.nextSibling;return le.style.setProperty("margin-bottom","1rem"),le.style.setProperty("font-size","1.1rem"),s(le,()=>e("products.stockInformation","Stock Information")),s(R,()=>e("products.totalStock","Total Stock")),s(X,()=>o()?.total||0,O),s(X,()=>p().unitOfMeasure,null),s(te,()=>e("products.minStockLevel","Min Stock Level")),s(de,()=>p().minStockLevel,pe),s(de,()=>p().unitOfMeasure,null),s(D,()=>e("products.maxStockLevel","Max Stock Level")),s(Q,()=>p().maxStockLevel,W),s(Q,()=>p().unitOfMeasure,null),s(fe,()=>e("products.stockValue","Stock Value")),s(V,()=>i((o()?.total||0)*p().unitCost)),s(H,v(Ne,{get when(){return ye(()=>!!o()?.byLocation)()&&o().byLocation.length>0},get children(){var re=VA(),_e=re.firstChild;return re.style.setProperty("margin-top","1.5rem"),_e.style.setProperty("margin-bottom","1rem"),_e.style.setProperty("font-size","1rem"),s(_e,()=>e("products.stockByLocation","Stock by Location")),s(re,()=>o().byLocation.map(Pe=>(()=>{var ae=qA(),be=ae.firstChild,oe=be.firstChild,Se=oe.firstChild;Se.firstChild;var Ee=oe.nextSibling,xe=Ee.firstChild,$e=be.nextSibling,Me=$e.firstChild,We=Me.nextSibling,je=We.nextSibling,Ce=je.nextSibling;return Ce.nextSibling,u(ae,ce),be.style.setProperty("display","flex"),be.style.setProperty("justify-content","space-between"),be.style.setProperty("align-items","center"),oe.style.setProperty("font-weight","500"),oe.style.setProperty("color","var(--primary-color)"),s(oe,()=>Pe.locationId,Se),Se.style.setProperty("font-weight","500"),Se.style.setProperty("color","var(--text-muted)"),s(Se,()=>Pe.locationName,null),Ee.style.setProperty("font-weight","600"),s(Ee,()=>Pe.quantity,xe),s(Ee,()=>p().unitOfMeasure,null),$e.style.setProperty("margin-top","0.5rem"),$e.style.setProperty("font-size","0.875rem"),$e.style.setProperty("color","var(--text-muted)"),s($e,()=>e("products.available","Available"),Me),s($e,()=>Pe.availableQuantity,We),s($e,()=>e("products.reserved","Reserved"),Ce),s($e,()=>Pe.reservedQuantity,null),ie(Ve=>(Ve=Pe.quantity>0?"var(--primary-color)":"var(--text-muted)")!=null?Ee.style.setProperty("color",Ve):Ee.style.removeProperty("color")),ae})()),null),re}}),null),ie(re=>{var _e=m,Pe=ee,ae=g,be=_,oe=A,Se=g,Ee=_,xe=A,$e=g,Me=_,We=A,je=g,Ce=_,Ve=A;return re.e=u(H,_e,re.e),re.t=u(I,Pe,re.t),re.a=u(K,ae,re.a),re.o=u(R,be,re.o),re.i=u(X,oe,re.i),re.n=u(N,Se,re.n),re.s=u(te,Ee,re.s),re.h=u(de,xe,re.h),re.r=u(Y,$e,re.r),re.d=u(D,Me,re.d),re.l=u(Q,We,re.l),re.u=u(me,je,re.u),re.c=u(fe,Ce,re.c),re.w=u(V,Ve,re.w),re},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),H})(),(()=>{var H=FA(),le=H.firstChild,I=le.nextSibling,j=I.firstChild,K=j.nextSibling,R=I.nextSibling,X=R.firstChild,O=X.nextSibling;return le.style.setProperty("margin-bottom","1rem"),le.style.setProperty("font-size","1.1rem"),s(le,()=>e("products.timestamps","Timestamps")),s(j,()=>e("common.createdDate","Created Date")),s(K,()=>a(p().createdDate)),s(X,()=>e("common.lastModified","Last Modified")),s(O,()=>a(p().lastModified)),ie(N=>{var te=m,de=g,pe=_,se=A,Y=g,D=_,Q=A;return N.e=u(H,te,N.e),N.t=u(I,de,N.t),N.a=u(j,pe,N.a),N.o=u(K,se,N.o),N.i=u(R,Y,N.i),N.n=u(X,D,N.n),N.s=u(O,Q,N.s),N},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),H})()]}}),he),s(C,v(Ne,{get when(){return r()==="movements"},get children(){var H=rm(),le=H.firstChild;return le.style.setProperty("margin-bottom","1rem"),le.style.setProperty("font-size","1.1rem"),s(le,()=>e("products.recentMovements","Recent Movements")),s(H,v(Ne,{get when(){return d().length>0},get fallback(){return(()=>{var I=GA();return I.firstChild,I.style.setProperty("text-align","center"),I.style.setProperty("padding","2rem"),I.style.setProperty("color","var(--text-muted)"),I.style.setProperty("background","var(--surface-color)"),I.style.setProperty("border-radius","var(--border-radius-sm)"),I.style.setProperty("border","1px solid var(--border-color)"),s(I,()=>e("products.noMovements","No movements found for this product"),null),I})()},get children(){return v(pt,{get each(){return d()},children:I=>{const j=I.productId===p().id?I:null;if(!j)return null;let K=De.getLocationById(I.locationId);return(()=>{var R=YA(),X=R.firstChild,O=X.firstChild,N=O.firstChild,te=N.nextSibling,de=te.nextSibling,pe=O.nextSibling,se=pe.firstChild,Y=X.nextSibling,D=Y.firstChild,Q=D.firstChild,W=D.nextSibling;return u(R,w),O.style.setProperty("font-weight","600"),O.style.setProperty("margin-bottom","0.25rem"),N.style.setProperty("font-size","1.2rem"),s(N,()=>L(I.movementType)),te.style.setProperty("padding","0 6px"),s(de,()=>I.movementType),pe.style.setProperty("font-size","0.875rem"),pe.style.setProperty("color","var(--text-muted)"),s(pe,()=>` ${a(I?.createdDate)} • `,se),se.style.setProperty("font-size","0.875rem"),se.style.setProperty("font-weight","600"),se.style.setProperty("color","var(--primary-color)"),s(se,()=>I?.locationId),s(pe,()=>` • ${K?.name}`,null),s(X,v(Ne,{get when(){return I.referenceNumber},get children(){var me=HA();return me.firstChild,me.style.setProperty("font-size","0.75rem"),me.style.setProperty("color","var(--text-muted)"),me.style.setProperty("margin-top","0.25rem"),s(me,()=>I?.referenceNumber,null),me}}),null),Y.style.setProperty("text-align","right"),D.style.setProperty("font-weight","600"),D.style.setProperty("font-size","1rem"),s(D,()=>I?.movementType==="in"?"+":"",Q),s(D,()=>j.quantity,Q),s(D,()=>p().unitOfMeasure,null),W.style.setProperty("font-size","0.875rem"),W.style.setProperty("color","var(--text-muted)"),s(W,()=>i(j.unitCost)),ie(me=>{var fe=$(I.movementType),V=I?.movementType==="in"?"#2e7d32":"#d32f2f";return me.e=u(de,fe,me.e),V!==me.t&&((me.t=V)!=null?D.style.setProperty("color",V):D.style.removeProperty("color")),me},{e:void 0,t:void 0}),R})()}})}}),null),ie(I=>u(H,m,I)),H}}),he),s(C,v(Ne,{get when(){return r()==="analytics"},get children(){var H=rm(),le=H.firstChild;return le.style.setProperty("margin-bottom","1rem"),le.style.setProperty("font-size","1.1rem"),s(le,()=>e("products.analytics","Analytics")),s(H,v(Ne,{get when(){return h()},get fallback(){return(()=>{var I=tm();return I.style.setProperty("text-align","center"),I.style.setProperty("padding","2rem"),I.style.setProperty("color","var(--text-muted)"),s(I,()=>e("products.noAnalytics","No analytics data available")),I})()},children:I=>(()=>{var j=KA(),K=j.firstChild,R=K.firstChild,X=R.nextSibling,O=X.nextSibling,N=K.nextSibling,te=N.firstChild,de=te.nextSibling,pe=de.nextSibling,se=N.nextSibling,Y=se.firstChild,D=Y.nextSibling,Q=D.nextSibling,W=Q.firstChild,me=W.nextSibling;me.nextSibling;var fe=se.nextSibling,V=fe.firstChild,re=V.nextSibling,_e=re.nextSibling,Pe=fe.nextSibling,ae=Pe.firstChild,be=ae.nextSibling,oe=be.nextSibling,Se=oe.firstChild,Ee=Se.nextSibling;return Ee.nextSibling,R.style.setProperty("margin","0 0 0.5rem 0"),R.style.setProperty("color","var(--primary-color)"),s(R,()=>e("products.totalMovements","Total Movements")),X.style.setProperty("font-size","1.5rem"),X.style.setProperty("font-weight","600"),s(X,()=>I().recentMovements),O.style.setProperty("font-size","0.875rem"),O.style.setProperty("color","var(--text-muted)"),O.style.setProperty("margin-top","0.25rem"),s(O,()=>e("products.allTime","All time")),te.style.setProperty("margin","0 0 0.5rem 0"),te.style.setProperty("color","var(--primary-color)"),s(te,()=>e("products.last30Days","Last 30 Days")),de.style.setProperty("font-size","1.5rem"),de.style.setProperty("font-weight","600"),s(de,()=>I().movements30Days),pe.style.setProperty("font-size","0.875rem"),pe.style.setProperty("color","var(--text-muted)"),pe.style.setProperty("margin-top","0.25rem"),s(pe,()=>e("products.movements","movements")),Y.style.setProperty("margin","0 0 0.5rem 0"),Y.style.setProperty("color","var(--primary-color)"),s(Y,()=>e("products.currentValue","Current Stock Value")),D.style.setProperty("font-size","1.5rem"),D.style.setProperty("font-weight","600"),s(D,()=>i(I().totalValue)),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),Q.style.setProperty("margin-top","0.25rem"),s(Q,()=>o()?.total||0,W),s(Q,()=>p().unitOfMeasure,me),s(Q,()=>i(p().unitCost),null),V.style.setProperty("margin","0 0 0.5rem 0"),V.style.setProperty("color","var(--primary-color)"),s(V,()=>e("products.avgMovementValue","Avg Movement Value")),re.style.setProperty("font-size","1.5rem"),re.style.setProperty("font-weight","600"),s(re,()=>i(I().averageMovementValue)),_e.style.setProperty("font-size","0.875rem"),_e.style.setProperty("color","var(--text-muted)"),_e.style.setProperty("margin-top","0.25rem"),s(_e,()=>e("products.perMovement","per movement")),s(j,v(Ne,{get when(){return I().lastMovementDate},get children(){var xe=WA(),$e=xe.firstChild,Me=$e.nextSibling,We=Me.nextSibling;return $e.style.setProperty("margin","0 0 0.5rem 0"),$e.style.setProperty("color","var(--primary-color)"),s($e,()=>e("products.lastMovement","Last Movement")),Me.style.setProperty("font-size","1.25rem"),Me.style.setProperty("font-weight","600"),s(Me,()=>a(I().lastMovementDate)),We.style.setProperty("font-size","0.875rem"),We.style.setProperty("color","var(--text-muted)"),We.style.setProperty("margin-top","0.25rem"),s(We,()=>e("products.mostRecent","Most recent activity")),ie(je=>u(xe,S,je)),xe}}),Pe),ae.style.setProperty("margin","0 0 0.5rem 0"),ae.style.setProperty("color","var(--primary-color)"),s(ae,()=>e("products.stockStatus","Stock Status")),be.style.setProperty("font-size","1.25rem"),be.style.setProperty("font-weight","600"),s(be,()=>o()?.statusText),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),oe.style.setProperty("margin-top","0.25rem"),s(oe,()=>p().minStockLevel,Ee),s(oe,()=>p().maxStockLevel,null),ie(xe=>{var $e=ee,Me=S,We=S,je=S,Ce=S,Ve=S;return xe.e=u(j,$e,xe.e),xe.t=u(K,Me,xe.t),xe.a=u(N,We,xe.a),xe.o=u(se,je,xe.o),xe.i=u(fe,Ce,xe.i),xe.n=u(Pe,Ve,xe.n),xe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),j})()}),null),ie(I=>u(H,m,I)),H}}),he),he.style.setProperty("display","flex"),he.style.setProperty("gap","1rem"),he.style.setProperty("justify-content","flex-end"),he.style.setProperty("margin-top","2rem"),s(he,v(Le,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close","Close")}}),null),s(he,v(Ne,{get when(){return t.onEdit},get children(){return v(Le,{variant:"primary",get onClick(){return t.onEdit},get children(){return e("common.edit","Edit")}})}}),null),ie(H=>{var le=T(o()?.status||"good"),I=ne(r()==="details"),j=ne(r()==="movements"),K=ne(r()==="analytics");return H.e=u(F,le,H.e),H.t=u(B,I,H.t),H.a=u(k,j,H.a),H.o=u(U,K,H.o),H},{e:void 0,t:void 0,a:void 0,o:void 0}),C})()})}})};Et(["click"]);var JA=q("<div>🔄"),XA=q("<button type=button>×"),ZA=q("<div>⚠️ "),nm=q("<div>"),eI=q("<div><div><input type=text autocomplete=off>"),tI=q("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>"),rI=q("<span>⚠️ ");const nI=t=>{const{t:e}=ct(),[r,n]=ve(""),[o,i]=ve(!1),[a,c]=ve(null),[d,h]=ve([]),[m,g]=ve(!1),[_,A]=ve(-1),[L,M]=ve(null),$=t.searchDelay||300,T=t.maxResults||900,ee=async I=>{if(!I.trim()||I.trim().length<3){h([]),t.onSearchResults?.([]);return}try{i(!0),c(null);try{const j=await ln.getProducts(I),K=Object.keys(j),R=O=>{let N=j;return{id:O,name:N[O].name,businessId:N[O].businessId,sku:N[O].code,UPC:N[O].UPC,numCode:N[O].codeN,category:N[O].category,unitCost:N[O].unitCost||0,unitOfMeasure:N[O].unitOfMeasure,minStockLevel:N[O].minStockLevel,maxStockLevel:N[O].maxStockLevel,isActive:N[O].isActive,description:N[O].description||"",createdDate:N[O].createdAt||new Date().toISOString(),lastModified:N[O].updatedAt||new Date().toISOString()}},X=K.map(R);h(X),De.updProduct(X),t.onSearchResults?.(X)}catch(j){console.warn("API search failed, using local fallback:",j),c("API search failed, showing local results");const K=De.getActiveProducts().filter(R=>R.name.toLowerCase().includes(I.toLowerCase())||R.sku.toLowerCase().includes(I.toLowerCase())||R.category.toLowerCase().includes(I.toLowerCase())).slice(0,T);h(K),t.onSearchResults?.(K)}}catch(j){const K=j instanceof Error?j.message:"Search failed";c(K),h([]),t.onSearchResults?.([])}finally{i(!1)}},ce=I=>{const K=I.target.value;n(K),c(null),t.showResults!==!1&&g(!0),L()&&clearTimeout(L());const R=setTimeout(()=>{ee(K)},$);M(R)},Z=I=>{n(I.name),g(!1),A(-1),t.onProductSelect?.(I)},ge=I=>{if(!(!m()||d().length===0))switch(I.key){case"ArrowDown":I.preventDefault(),A(j=>Math.min(j+1,d().length-1));break;case"ArrowUp":I.preventDefault(),A(j=>Math.max(j-1,-1));break;case"Enter":I.preventDefault(),_()>=0&&d()[_()]&&Z(d()[_()]);break;case"Escape":g(!1),A(-1);break}},ne=()=>{t.showResults!==!1&&d().length>0&&g(!0)},w=()=>{setTimeout(()=>{g(!1),A(-1)},150)},S=()=>{n(""),h([]),c(null),g(!1),A(-1),t.onSearchResults?.([]),L()&&(clearTimeout(L()),M(null))},p=I=>De.stockLevels.filter(j=>j.productId===I).reduce((j,K)=>j+K.quantity,0),C=I=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(I),P={position:"relative",width:"100%",...t.style},x={position:"relative",display:"flex","align-items":"center"},y={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},ue={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},J={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},E={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},F=I=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:I?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),z={display:"flex","justify-content":"space-between","align-items":"center"},B={flex:"1"},k={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},U={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},he={"text-align":"right","font-size":"0.875rem"},H={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},le={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var I=eI(),j=I.firstChild,K=j.firstChild;return K.addEventListener("blur",w),K.addEventListener("focus",ne),K.$$keydown=ge,K.$$input=ce,s(j,v(Ne,{get when(){return o()},get children(){var R=JA();return ie(X=>u(R,J,X)),R}}),null),s(j,v(Ne,{get when(){return ye(()=>!!r())()&&!o()},get children(){var R=XA();return R.addEventListener("mouseleave",X=>{X.currentTarget.style.background="none",X.currentTarget.style.color="var(--text-muted)"}),R.addEventListener("mouseenter",X=>{X.currentTarget.style.background="var(--border-color)",X.currentTarget.style.color="var(--text-primary)"}),R.$$click=S,ie(X=>{var O=ue,N=e("common.clear","Clear search");return X.e=u(R,O,X.e),N!==X.t&&ut(R,"title",X.t=N),X},{e:void 0,t:void 0}),R}}),null),s(I,v(Ne,{get when(){return m()&&t.showResults!==!1},get children(){var R=nm();return s(R,v(Ne,{get when(){return a()},get children(){var X=ZA();return X.firstChild,u(X,le),s(X,a,null),X}}),null),s(R,v(Ne,{get when(){return d().length>0},get fallback(){return ye(()=>!!(r()&&!o()))()&&(()=>{var X=nm();return u(X,H),s(X,()=>e("inventory.noProductsFound","No products found matching your search.")),X})()},get children(){return v(pt,{get each(){return d()},children:(X,O)=>{const N=p(X.id),te=N<=X.minStockLevel;return(()=>{var de=tI(),pe=de.firstChild,se=pe.firstChild,Y=se.firstChild,D=Y.nextSibling,Q=D.firstChild,W=Q.firstChild,me=Q.nextSibling,fe=me.nextSibling,V=fe.nextSibling,re=V.nextSibling,_e=se.nextSibling,Pe=_e.firstChild,ae=Pe.firstChild,be=Pe.nextSibling;return de.addEventListener("mouseenter",()=>A(O())),de.$$click=()=>Z(X),u(pe,z),u(se,B),u(Y,k),s(Y,()=>X.name),u(D,U),s(Q,()=>e("inventory.sku","SKU"),W),s(Q,()=>X.sku,null),s(fe,()=>X.category),s(re,()=>C(X.unitCost)),u(_e,he),Pe.style.setProperty("font-weight","600"),(te?"#f44336":"var(--text-primary)")!=null?Pe.style.setProperty("color",te?"#f44336":"var(--text-primary)"):Pe.style.removeProperty("color"),s(Pe,N,ae),s(Pe,()=>X.unitOfMeasure,null),be.style.setProperty("color","var(--text-muted)"),s(be,()=>te?(()=>{var oe=rI();return oe.firstChild,oe.style.setProperty("color","#f44336"),s(oe,()=>e("inventory.lowStock","Low Stock"),null),oe})():e("inventory.inStock","In Stock")),ie(oe=>u(de,F(O()===_()),oe)),de})()}})}}),null),ie(X=>u(R,E,X)),R}}),null),ie(R=>{var X=P,O=x,N=y,te=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),de=t.disabled;return R.e=u(I,X,R.e),R.t=u(j,O,R.t),R.a=u(K,N,R.a),te!==R.o&&ut(K,"placeholder",R.o=te),de!==R.i&&(K.disabled=R.i=de),R},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ie(()=>K.value=r()),I})()};Et(["input","keydown","click"]);var oI=q("<div><div><h2></h2><div><div>"),iI=q("<div><span>"),sI=q("<span>🔍 "),aI=q("<div><div><div><div><h3></h3><span></span></div><div></div><div>: </div></div><div><div></div><div> • <!>: </div><div>: "),lI=q("<div><div>:</div><div>"),cI=q("<div>: "),uI=q("<div><div><span>:</span><select><option value=10>10</option><option value=20>20</option><option value=50>50</option><option value=100>100</option></select></div><div><div><span></span><input type=number min=1><span> </span></div></div><div>");const Ig=()=>{const{t}=ct(),[e,r]=ve(""),[n,o]=ve(""),[i,a]=ve([]),[c,d]=ve(!1),[h,m]=ve(null),[g,_]=ve(!1),[A,L]=ve(!1),[M,$]=ve(!1),[T,ee]=ve(null),[ce,Z]=ve(!1),[ge,ne]=ve([]),[w,S]=ve(!1),[p,C]=ve(1),[P,x]=ve(20);Hr(async()=>{await y()});const y=async()=>{try{d(!0),m(null);try{const I=await cd.getAll();a(I.map(j=>({id:j.id||`prod-${Date.now()}-${Math.random()}`,name:j.productName||j.name||"Unknown Product",sku:j.sku||j.productCode||"",description:j.description||"",category:j.category||"General",unitOfMeasure:j.unitOfMeasure||"pcs",unitCost:parseFloat(j.unitCost||j.cost||"0"),sellingPrice:parseFloat(j.sellingPrice||j.price||"0"),minStockLevel:parseInt(j.minStockLevel||"0"),maxStockLevel:parseInt(j.maxStockLevel||"100"),isActive:j.isActive!==!1,createdDate:j.createdDate||new Date().toISOString(),lastModified:j.lastModified||new Date().toISOString(),businessId:j.businessId||"YB100423253156428"})))}catch(I){console.warn("API failed, using local store:",I),a(De.products)}}catch(I){m(I instanceof Error?I.message:"Failed to load products")}finally{d(!1)}},ue=async()=>{try{d(!0),m(null);try{const I=await ln.getProducts("prod"),j=Object.keys(I),K=X=>{let N=I[X];return{id:N.id,name:N.name,businessId:N.businessId,sku:N.code,numCode:N.codeN,category:N.category,unitCost:N.unitCost||0,unitOfMeasure:N.unitOfMeasure,minStockLevel:N.minStockLevel,maxStockLevel:N.maxStockLevel,isActive:N.isActive,description:N.description||"",createdDate:N.createdAt||new Date().toISOString(),lastModified:N.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(N.sellingPrice||N.price||"0")}},R=j.map(K);a(R)}catch(I){console.warn("API failed, using local store:",I),a(De.products)}}catch(I){m(I instanceof Error?I.message:"Failed to load products")}finally{d(!1)}},{cancel:J}=LA(async I=>{if(!I.trim()){await y();return}try{m(null);const j=await cd.getAll(I);a(j.map(K=>({id:K.id||`prod-${Date.now()}-${Math.random()}`,name:K.productName||K.name||"Unknown Product",sku:K.sku||K.productCode||"",description:K.description||"",category:K.category||"General",unitOfMeasure:K.unitOfMeasure||"pcs",unitCost:parseFloat(K.unitCost||K.cost||"0"),sellingPrice:parseFloat(K.sellingPrice||K.price||"0"),minStockLevel:parseInt(K.minStockLevel||"0"),maxStockLevel:parseInt(K.maxStockLevel||"100"),isActive:K.isActive!==!1,createdDate:K.createdDate||new Date().toISOString(),lastModified:K.lastModified||new Date().toISOString(),businessId:K.businessId||"YB100423253156428"})))}catch(j){m(j instanceof Error?j.message:"Search failed");const K=De.products.filter(R=>R.name.toLowerCase().includes(I.toLowerCase())||R.sku.toLowerCase().includes(I.toLowerCase())||R.category.toLowerCase().includes(I.toLowerCase()));a(K)}},300);hi(()=>{J()}),Ge(()=>{let I=i();return n()&&(I=I.filter(j=>j.category===n())),I}),Ge(()=>[...new Set(i().map(j=>j.category))].sort()),Ge(()=>{const I=i().filter(R=>R.isActive),j=i().length,K=i().filter(R=>De.getTotalStockByProduct(R.id)===0);return{total:j,active:I.length,outOfStock:K.length}});const E=I=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(I),F={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},z={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},B=I=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:I?"#ffebee":"#e8f5e8",color:I?"#d32f2f":"#2d7d32"});Ge(()=>{const I=De.products||[],j=De.movements||[],K=De.stockLevels||[],R=De.getLowStockProducts(),X=I?.length||0,O=I?.filter(de=>de.isActive).length,N=K.reduce((de,pe)=>de*1+pe.quantity*1*pe.averageCost*1,0),te=j?.filter(de=>{const pe=new Date(de.createdDate),se=new Date;return pe.getMonth()===se.getMonth()&&pe.getFullYear()===se.getFullYear()}).length;return{totalProducts:X,activeProducts:O,lowStockProducts:R.length,totalStockValue:N,totalMovementsThisMonth:te,totalLocations:De.locations.length,activeLocations:De.getActiveLocations().length}});const k=Ge(()=>De.products.map(I=>{const j=De.getStockByProduct(I.id),K=De.getTotalStockByProduct(I.id),R=De.getLastLocationByProduct(I.id);return{...I,totalStock:K,stockByLocation:j,lastLocation:R,isLowStock:K<=I.minStockLevel}})),U=Ge(()=>ge().map(I=>{const j=De.getStockByProduct(I.id),K=De.getTotalStockByProduct(I.id),R=De.getLastLocationByProduct(I.id);return{...I,totalStock:K,stockByLocation:j,lastLocation:R,isLowStock:K<=I.minStockLevel}})),he=Ge(()=>{const I=w()?U():k(),j=(p()-1)*P(),K=j+P();return I.slice(j,K)}),H=Ge(()=>{const I=w()?U():k();return Math.ceil(I.length/P())}),le=I=>{ee(I),L(!0)};return v(Lr,{get title(){return t("products.title","Products")},get children(){return[(()=>{var I=oI(),j=I.firstChild,K=j.firstChild,R=K.nextSibling,X=R.firstChild;return I.style.setProperty("display","flex"),I.style.setProperty("justify-content","space-between"),I.style.setProperty("align-items","flex-start"),I.style.setProperty("margin-bottom","1.5rem"),I.style.setProperty("flex-wrap","wrap"),I.style.setProperty("gap","1rem"),j.style.setProperty("flex","1"),j.style.setProperty("min-width","300px"),K.style.setProperty("margin","0 0 1rem 0"),K.style.setProperty("font-size","1.5rem"),s(K,()=>t("inventory.products")),R.style.setProperty("display","flex"),R.style.setProperty("gap","1rem"),R.style.setProperty("align-items","center"),R.style.setProperty("flex-wrap","wrap"),X.style.setProperty("flex","1"),X.style.setProperty("min-width","250px"),s(X,v(nI,{onSearchResults:O=>{ne(O),S(O.length>0)},get placeholder(){return t("inventory.searchProductsStock","Search products and check stock levels...")},showResults:!1,maxResults:20})),s(R,v(Le,{variant:"outline",onClick:()=>{ue(),S(!1)},get children(){return["🔄 ",ye(()=>t("common.showAll","Show All"))]}}),null),s(I,v(Ne,{get when(){return Pt.hasPermission("read_write")},get children(){return v(Le,{variant:"primary",onClick:()=>Z(!0),get children(){return["➕ ",ye(()=>t("inventory.addProduct"))]}})}}),null),I})(),(()=>{var I=iI(),j=I.firstChild;return I.style.setProperty("margin-bottom","1rem"),I.style.setProperty("font-size","0.875rem"),I.style.setProperty("color","var(--text-muted)"),I.style.setProperty("display","flex"),I.style.setProperty("justify-content","space-between"),I.style.setProperty("align-items","center"),s(j,(()=>{var K=ye(()=>!!w());return()=>K()?`${t("inventory.searchResults","Search Results")}: ${U().length} ${t("common.products","products")}`:`${t("inventory.totalProducts","Total Products")}: ${k().length} ${t("common.products","products")}`})()),s(I,(()=>{var K=ye(()=>!!w());return()=>K()&&(()=>{var R=sI();return R.firstChild,R.style.setProperty("color","var(--primary-color)"),s(R,()=>t("inventory.filtered","Filtered view"),null),R})()})(),null),I})(),v(pt,{get each(){return he()},children:I=>(()=>{var j=aI(),K=j.firstChild,R=K.firstChild,X=R.firstChild,O=X.firstChild,N=O.nextSibling,te=X.nextSibling,de=te.nextSibling,pe=de.firstChild,se=R.nextSibling,Y=se.firstChild,D=Y.nextSibling,Q=D.firstChild,W=Q.nextSibling;W.nextSibling;var me=D.nextSibling,fe=me.firstChild;return j.$$click=()=>le(I),j.addEventListener("mouseleave",V=>{V.currentTarget.style.transform="translateY(0)",V.currentTarget.style.boxShadow="none"}),j.addEventListener("mouseenter",V=>{V.currentTarget.style.transform="translateY(-2px)",V.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),u(j,F),u(K,z),X.style.setProperty("display","flex"),X.style.setProperty("align-items","center"),X.style.setProperty("gap","0.5rem"),X.style.setProperty("margin-bottom","0.5rem"),O.style.setProperty("margin","0"),O.style.setProperty("font-size","1.1rem"),s(O,()=>I.name),s(N,(()=>{var V=ye(()=>!!I.isLowStock);return()=>V()?t("inventory.lowStockAlert"):t("inventory.inStock")})()),te.style.setProperty("font-size","0.875rem"),te.style.setProperty("color","var(--text-muted)"),s(te,()=>I.sku,null),s(te,()=>I.UPC?" • "+I.UPC:"",null),s(te,()=>I.category?" • "+I.category:"",null),de.style.setProperty("font-size","0.875rem"),de.style.setProperty("color","var(--text-muted)"),s(de,()=>t("inventory.lastSeen"),pe),s(de,()=>I.lastLocation?.name||t("inventory.noMovements"),null),se.style.setProperty("text-align","right"),Y.style.setProperty("font-size","1.25rem"),Y.style.setProperty("font-weight","700"),Y.style.setProperty("color","var(--primary-color)"),s(Y,()=>I.totalStock),D.style.setProperty("font-size","0.875rem"),D.style.setProperty("color","var(--text-muted)"),s(D,()=>I.unitOfMeasure,Q),s(D,()=>t("inventory.min"),W),s(D,()=>I.minStockLevel,null),me.style.setProperty("font-size","0.875rem"),me.style.setProperty("color","var(--text-muted)"),s(me,()=>t("inventory.cost"),fe),s(me,()=>E(I.unitCost),null),s(j,(()=>{var V=ye(()=>I.stockByLocation.length>0);return()=>V()&&(()=>{var re=lI(),_e=re.firstChild,Pe=_e.firstChild,ae=_e.nextSibling;return re.style.setProperty("margin-top","1rem"),_e.style.setProperty("font-weight","500"),_e.style.setProperty("margin-bottom","0.5rem"),_e.style.setProperty("font-size","0.875rem"),s(_e,()=>t("inventory.stockByLocation"),Pe),ae.style.setProperty("display","flex"),ae.style.setProperty("flex-wrap","wrap"),ae.style.setProperty("gap","0.5rem"),s(ae,v(pt,{get each(){return I.stockByLocation},children:be=>{const oe=De.getLocationById(be.locationId);return(()=>{var Se=cI(),Ee=Se.firstChild;return Se.style.setProperty("padding","0.25rem 0.5rem"),Se.style.setProperty("background","var(--background-color)"),Se.style.setProperty("border-radius","var(--border-radius-sm)"),Se.style.setProperty("font-size","0.75rem"),Se.style.setProperty("border","1px solid var(--border-color)"),s(Se,()=>oe?.name,Ee),s(Se,()=>be.quantity,null),Se})()}})),re})()})(),null),ie(V=>u(N,B(I.isLowStock),V)),j})()}),ye(()=>ye(()=>H()>1)()&&(()=>{var I=uI(),j=I.firstChild,K=j.firstChild,R=K.firstChild,X=K.nextSibling,O=j.nextSibling,N=O.firstChild,te=N.firstChild,de=te.nextSibling,pe=de.nextSibling,se=pe.firstChild,Y=O.nextSibling;return I.style.setProperty("display","flex"),I.style.setProperty("justify-content","space-between"),I.style.setProperty("align-items","center"),I.style.setProperty("margin-top","2rem"),I.style.setProperty("padding","1rem"),I.style.setProperty("background","var(--surface-color)"),I.style.setProperty("border-radius","var(--border-radius)"),I.style.setProperty("border","1px solid var(--border-color)"),j.style.setProperty("display","flex"),j.style.setProperty("align-items","center"),j.style.setProperty("gap","0.5rem"),K.style.setProperty("font-size","0.875rem"),K.style.setProperty("color","var(--text-muted)"),s(K,()=>t("common.showPerPage","Show per page"),R),X.addEventListener("change",D=>{x(parseInt(D.target.value)),C(1)}),X.style.setProperty("padding","0.25rem 0.5rem"),X.style.setProperty("border","1px solid var(--border-color)"),X.style.setProperty("border-radius","var(--border-radius-sm)"),X.style.setProperty("background","var(--background-color)"),X.style.setProperty("cursor","pointer"),O.style.setProperty("display","flex"),O.style.setProperty("align-items","center"),O.style.setProperty("gap","0.5rem"),s(O,v(Le,{variant:"outline",size:"sm",onClick:()=>C(1),get disabled(){return p()===1},get children(){return t("common.first","First")}}),N),s(O,v(Le,{variant:"outline",size:"sm",onClick:()=>C(D=>Math.max(1,D-1)),get disabled(){return p()===1},get children(){return t("common.previous","Previous")}}),N),N.style.setProperty("display","flex"),N.style.setProperty("align-items","center"),N.style.setProperty("gap","0.25rem"),te.style.setProperty("font-size","0.875rem"),s(te,()=>t("common.page","Page")),de.addEventListener("change",D=>{const Q=parseInt(D.target.value);Q>=1&&Q<=H()&&C(Q)}),de.style.setProperty("width","60px"),de.style.setProperty("padding","0.25rem 0.5rem"),de.style.setProperty("border","1px solid var(--border-color)"),de.style.setProperty("border-radius","var(--border-radius-sm)"),de.style.setProperty("text-align","center"),de.style.setProperty("font-size","0.875rem"),pe.style.setProperty("font-size","0.875rem"),s(pe,()=>t("common.of","of"),se),s(pe,H,null),s(O,v(Le,{variant:"outline",size:"sm",onClick:()=>C(D=>Math.min(H(),D+1)),get disabled(){return p()===H()},get children(){return t("common.next","Next")}}),null),s(O,v(Le,{variant:"outline",size:"sm",onClick:()=>C(H()),get disabled(){return p()===H()},get children(){return t("common.last","Last")}}),null),Y.style.setProperty("font-size","0.875rem"),Y.style.setProperty("color","var(--text-muted)"),s(Y,()=>{const D=w()?U():k(),Q=(p()-1)*P()+1,W=Math.min(p()*P(),D.length);return t("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:Q,end:W,total:D.length})}),ie(()=>ut(de,"max",H())),ie(()=>X.value=P()),ie(()=>de.value=p()),I})()),v(Tu,{get isOpen(){return g()},onClose:()=>_(!1),onProductAdded:()=>{y()}}),v(QA,{get isOpen(){return A()},onClose:()=>{L(!1),ee(null)},get product(){return T()},onEdit:()=>{L(!1),$(!0)}})]}})};Et(["click"]);var dI=q("<div><div></div><div>"),hI=q("<div><div><img></div><div>X</div><div><div><h2></h2><div></div></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),mI=q("<div>"),fI=q("<div><div>📦</div><h3></h3><p>"),yI=q("<div><div>"),gI=q("<div>✓"),pI=q("<div><div><img loading=lazy></div><div><div></div><div> • </div><div></div><div>",!0,!1,!1);const vI=t=>{const{t:e}=ct(),[r,n]=ve(null),[o,i]=ve([]),[a,c]=ve(!1),d=F=>{n(F),t.onProductSelect?.(F)},h=()=>{n(null),t.onProductSelect?.(null),i([]),c(!1)},m=F=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(F),g=()=>"YABABYSSolution",_=()=>"https://qvamarkets.s3.us-east-2.amazonaws.com/V2_images/7258/",A=F=>{if(F.productImageUrl)return _()+g()+"/"+F?.productImageUrl;const z={Electronics:"https://via.placeholder.com/400x300/4F46E5/FFFFFF?text=Electronics",Furniture:"https://via.placeholder.com/400x300/059669/FFFFFF?text=Furniture",Food:"https://via.placeholder.com/400x300/DC2626/FFFFFF?text=Food",Clothing:"https://via.placeholder.com/400x300/7C3AED/FFFFFF?text=Clothing",Tools:"https://via.placeholder.com/400x300/EA580C/FFFFFF?text=Tools",General:"https://via.placeholder.com/400x300/6B7280/FFFFFF?text=Product"};return z[F.category]||z.General},L={padding:"2rem"},M={"max-width":"600px",margin:"0 auto 2rem",position:"relative"},$={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},T={background:"var(--surface-color)","border-radius":"var(--border-radius)",overflow:"hidden","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.3s ease"},ee={position:"relative",width:"100%",height:"200px",overflow:"hidden",background:"#f5f5f5"},ce={width:"100%",height:"100%","object-fit":"cover",transition:"transform 0.3s ease"},Z={padding:"1rem"},ge={"font-size":"1rem","font-weight":"600","margin-bottom":"0.5rem",color:"var(--text-primary)",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},ne={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.25rem"},w={"font-size":"1.25rem","font-weight":"700",color:"var(--primary-color)","margin-top":"0.5rem"},S={display:"flex",gap:"2rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"2rem","box-shadow":"var(--shadow-md)","margin-bottom":"2rem",position:"relative"},p={width:"400px",height:"300px","border-radius":"var(--border-radius)",overflow:"hidden",background:"#f5f5f5"},C={flex:"1",display:"flex","flex-direction":"column",gap:"1rem"},P={display:"flex","justify-content":"space-between","padding-bottom":"0.5rem","border-bottom":"1px solid var(--border-light)"},x={"font-weight":"500",color:"var(--text-muted)"},y={"font-weight":"600",color:"var(--text-primary)"},ue=F=>({display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"600",background:"#d4edda",color:"#155724"}),J={"text-align":"center",padding:"4rem 2rem",color:"var(--text-muted)"},E={"font-size":"3rem","margin-bottom":"1rem",opacity:"0.5"};return(()=>{var F=yI(),z=F.firstChild;return u(F,L),s(z,v(Eu,{onChange:B=>{console.log(B);let k=B;c(!0),d(k)},get placeholder(){return e("inventory.searchProductsImages","Search products to view images...")}})),s(F,v(Ne,{get when(){return r()&&t.showDetails!==!1},get children(){var B=hI(),k=B.firstChild,U=k.firstChild,he=k.nextSibling,H=he.nextSibling,le=H.firstChild,I=le.firstChild,j=I.nextSibling,K=le.nextSibling,R=K.firstChild,X=R.nextSibling,O=K.nextSibling,N=O.firstChild,te=N.nextSibling,de=O.nextSibling,pe=de.firstChild,se=pe.nextSibling,Y=de.nextSibling,D=Y.firstChild,Q=D.nextSibling,W=Y.nextSibling,me=W.firstChild,fe=me.nextSibling;return u(B,S),u(k,p),U.style.setProperty("width","100%"),U.style.setProperty("height","100%"),U.style.setProperty("object-fit","contain"),U.style.setProperty("aspect-ratio","1 / 1"),he.$$click=()=>{h()},he.style.setProperty("position","absolute"),he.style.setProperty("top","0.5rem"),he.style.setProperty("right","0.5rem"),he.style.setProperty("color","#3d3d3d"),he.style.setProperty("border-radius","50%"),he.style.setProperty("width","2rem"),he.style.setProperty("height","2rem"),he.style.setProperty("display","flex"),he.style.setProperty("align-items","center"),he.style.setProperty("justify-content","center"),he.style.setProperty("font-size","1.25rem"),he.style.setProperty("box-shadow","var(--shadow-sm)"),he.style.setProperty("cursor","pointer"),u(H,C),I.style.setProperty("margin","0 0 0.5rem 0"),I.style.setProperty("font-size","1.5rem"),s(I,()=>r().name),s(j,()=>e("products.inStock","In Stock")),s(R,()=>e("products.sku","SKU")),s(X,()=>r().sku),s(N,()=>e("inventory.category","Category")),s(te,()=>r().category),s(pe,()=>e("inventory.unitOfMeasure","Unit")),s(se,()=>r().unitOfMeasure),s(D,()=>e("inventory.unitCost","Cost")),s(Q,()=>m(r().unitCost)),s(me,()=>e("inventory.UPC","UPC")),s(fe,()=>r().UPC),s(H,v(Ne,{get when(){return r().description},get children(){var V=dI(),re=V.firstChild,_e=re.nextSibling;return V.style.setProperty("margin-top","1rem"),s(re,()=>e("common.description","Description")),_e.style.setProperty("margin-top","0.5rem"),_e.style.setProperty("color","var(--text-primary)"),s(_e,()=>r().description),ie(Pe=>u(re,x,Pe)),V}}),null),ie(V=>{var re=A(r()),_e=r().name,Pe=ue(),ae=P,be=x,oe=y,Se=P,Ee=x,xe=y,$e=P,Me=x,We=y,je=P,Ce=x,Ve=y,Ke=P,He=x,Qe=y;return re!==V.e&&ut(U,"src",V.e=re),_e!==V.t&&ut(U,"alt",V.t=_e),V.a=u(j,Pe,V.a),V.o=u(K,ae,V.o),V.i=u(R,be,V.i),V.n=u(X,oe,V.n),V.s=u(O,Se,V.s),V.h=u(N,Ee,V.h),V.r=u(te,xe,V.r),V.d=u(de,$e,V.d),V.l=u(pe,Me,V.l),V.u=u(se,We,V.u),V.c=u(Y,je,V.c),V.w=u(D,Ce,V.w),V.m=u(Q,Ve,V.m),V.f=u(W,Ke,V.f),V.y=u(me,He,V.y),V.g=u(fe,Qe,V.g),V},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),B}}),null),s(F,v(Ne,{get when(){return o().length>0},get children(){var B=mI();return u(B,$),s(B,v(pt,{get each(){return o()},children:k=>(()=>{var U=pI(),he=U.firstChild,H=he.firstChild,le=he.nextSibling,I=le.firstChild,j=I.nextSibling,K=j.firstChild,R=j.nextSibling,X=R.nextSibling;return U.addEventListener("mouseleave",O=>{O.currentTarget.style.transform="translateY(0)",O.currentTarget.style.boxShadow="var(--shadow-sm)";const N=O.currentTarget.querySelector("img");N&&(N.style.transform="scale(1)")}),U.addEventListener("mouseenter",O=>{O.currentTarget.style.transform="translateY(-4px)",O.currentTarget.style.boxShadow="var(--shadow-lg)";const N=O.currentTarget.querySelector("img");N&&(N.style.transform="scale(1.05)")}),U.$$click=()=>d(k),u(U,T),s(he,v(Ne,{get when(){return k===r()},get children(){var O=gI();return O.style.setProperty("position","absolute"),O.style.setProperty("top","0.5rem"),O.style.setProperty("right","0.5rem"),O.style.setProperty("background","var(--primary-color)"),O.style.setProperty("color","white"),O.style.setProperty("border-radius","50%"),O.style.setProperty("width","2rem"),O.style.setProperty("height","2rem"),O.style.setProperty("display","flex"),O.style.setProperty("align-items","center"),O.style.setProperty("justify-content","center"),O.style.setProperty("font-size","1.25rem"),O}}),null),u(le,Z),s(I,()=>k.name),s(j,()=>k.sku,K),s(j,()=>k.category,null),s(R,()=>k.unitOfMeasure),u(X,w),s(X,()=>m(k.sellingPrice)),ie(O=>{var N=ee,te=A(k),de=k.name,pe=ce,se=ge,Y=k.name,D=ne,Q=ne;return O.e=u(he,N,O.e),te!==O.t&&ut(H,"src",O.t=te),de!==O.a&&ut(H,"alt",O.a=de),O.o=u(H,pe,O.o),O.i=u(I,se,O.i),Y!==O.n&&ut(I,"title",O.n=Y),O.s=u(j,D,O.s),O.h=u(R,Q,O.h),O},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),U})()})),B}}),null),s(F,v(Ne,{get when(){return!r()},get children(){var B=fI(),k=B.firstChild,U=k.nextSibling,he=U.nextSibling;return u(k,E),U.style.setProperty("margin-bottom","0.5rem"),s(U,()=>e("inventory.noProductsFound","No Products Found")),s(he,()=>e("inventory.tryDifferentSearch","Try a different search term")),ie(H=>u(B,J,H)),B}}),null),ie(B=>u(z,M,B)),F})()};Et(["click"]);var bI=q("<div><h1></h1><div>"),kr=q("<div>"),_I=q("<div><h3></h3><div>"),SI=q("<div>: <!> "),PI=q("<div><button></button><button></button><button></button><button>"),wI=q("<div><div>"),CI=q("<div><span> (<!>)</span><span> / <!> "),AI=q("<div><div><h2></h2></div><div>"),II=q("<div><div><div><span></span><h3></h3></div><div> • </div><div></div></div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div>:"),xI=q("<div><div><div><div></div><div></div></div><div><div> </div><div></div><div>Min: "),EI=q("<span>⚠️ LOW");const TI=()=>{const{t}=ct(),[e,r]=ve(!1),[n,o]=ve(!1),[i,a]=ve(!1),[c,d]=ve(null),[h,m]=ve("overview"),[g,_]=ve("new"),[A,L]=ve(""),[M,$]=ve(""),[T,ee]=ve([]),[ce,Z]=ve(!1),[ge,ne]=ve(!1),[w,S]=ve(!1),[p,C]=ve(!1),[P,x]=ve(!1),[y,ue]=ve(1),[J,E]=ve(20),F=Y=>{d(Y),a(!0)},z=Ge(()=>{const Y=De.products||[],D=De.movements||[],Q=De.stockLevels||[],W=De.getLowStockProducts(),me=Y?.length||0,fe=Y?.filter(_e=>_e.isActive).length,V=Q.reduce((_e,Pe)=>_e*1+Pe.quantity*1*Pe.averageCost*1,0),re=D?.filter(_e=>{const Pe=new Date(_e.createdDate),ae=new Date;return Pe.getMonth()===ae.getMonth()&&Pe.getFullYear()===ae.getFullYear()}).length;return{totalProducts:me,activeProducts:fe,lowStockProducts:W.length,totalStockValue:V,totalMovementsThisMonth:re,totalLocations:De.locations.length,activeLocations:De.getActiveLocations().length}});Ge(()=>De.products.map(Y=>{const D=De.getStockByProduct(Y.id),Q=De.getTotalStockByProduct(Y.id),W=De.getLastLocationByProduct(Y.id);return{...Y,totalStock:Q,stockByLocation:D,lastLocation:W,isLowStock:Q<=Y.minStockLevel}})),Ge(()=>{ge(),ue(1)});const B=(Y,D)=>Y<=D?t("inventory.lowStockAlert"):Y<=D*2?t("inventory.normalStock"):t("inventory.inStock"),k=Y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Y),U=Y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Y),he=Y=>{switch(Y){case"warehouse":return t("inventory.warehouse");case"store":return t("inventory.store");case"supplier":return t("inventory.supplier");case"customer":return t("inventory.customer");default:return Y}},H={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},le={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},I=Y=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500",background:Y>50?"#d4edda":Y>20?"#fff3cd":"#f8d7da",color:Y>50?"#155724":Y>20?"#856404":"#721c24"}),j={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},K={color:"var(--text-muted)","font-size":"0.875rem"},R={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},X={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},O={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},N=Y=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:Y?"var(--primary-color)":"var(--text-muted)","border-bottom":Y?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),te={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem","margin-bottom":"2rem"},de={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},pe=Ge(()=>{const Y=De.movements;return{total:Y.length,stockIn:Y.filter(D=>D.movementType==="in").length,stockOut:Y.filter(D=>D.movementType==="out").length,transfers:Y.filter(D=>D.movementType==="transfer").length,adjustments:Y.filter(D=>D.movementType==="adjustment").length,totalValue:Y.reduce((D,Q)=>D+Q.totalCost,0)}}),se=async()=>{let Y="prod";await De.fecthInventory(Y),await De.fecthProduct(Y)};return Hr(()=>{se()}),v(Lr,{get title(){return t("inventory.title")},get children(){return[(()=>{var Y=bI(),D=Y.firstChild,Q=D.nextSibling;return u(Y,X),D.style.setProperty("margin","0"),D.style.setProperty("font-size","1.75rem"),Q.style.setProperty("display","flex"),Q.style.setProperty("align-items","center"),Q.style.setProperty("gap","1rem"),s(Q,(()=>{var W=ye(()=>g()==="new");return()=>W()&&v(Le,{variant:"outline",onClick:()=>x(!0),get children(){return["🔢 ",ye(()=>t("inventory.physicalCount","Physical Count"))]}})})(),null),s(Q,v(Ne,{get when(){return Pt.hasPermission("read_write")},get children(){return v(Le,{variant:"primary",onClick:()=>o(!0),get children(){return ye(()=>g()==="new")()?t("inventory.addMovement"):t("common.add")}})}}),null),Y})(),v(vI,{}),v(Ne,{get when(){return Pt.hasPermission("inventoryDownsection")},get children(){return ye(()=>g()==="legacy")()?[(()=>{var Y=kr();return s(Y,v(Ze,{get title(){return t("inventory.totalItems")},get subtitle(){return t("inventory.inStock")},get children(){var D=kr();return D.style.setProperty("font-size","1.5rem"),D.style.setProperty("font-weight","600"),D.style.setProperty("color","var(--primary-color)"),s(D,()=>De.inventory.length),D}}),null),s(Y,v(Ze,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.itemsBelowThreshold")},get children(){var D=kr();return D.style.setProperty("font-size","1.5rem"),D.style.setProperty("font-weight","600"),D.style.setProperty("color","var(--primary-color)"),s(D,()=>De.getLowStockItems().length),D}}),null),s(Y,v(Ze,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.inventoryWorth")},get children(){var D=kr();return D.style.setProperty("font-size","1.5rem"),D.style.setProperty("font-weight","600"),D.style.setProperty("color","var(--primary-color)"),s(D,()=>k(De.getTotalValue())),D}}),null),ie(D=>u(Y,R,D)),Y})(),(()=>{var Y=kr();return u(Y,H),s(Y,v(pt,{get each(){return De.inventory},children:D=>{const Q=B(D.quantity,D.minStock),W=D.quantity<=D.minStock?8:D.quantity<=D.minStock*2?35:75;return v(Ze,{onClick:()=>F(D),get children(){return[(()=>{var me=_I(),fe=me.firstChild,V=fe.nextSibling;return u(me,le),fe.style.setProperty("margin","0"),fe.style.setProperty("font-size","1.1rem"),s(fe,()=>D.name),s(V,Q),ie(re=>u(V,I(W),re)),me})(),(()=>{var me=kr();return u(me,j),s(me,()=>k(D.price)),me})(),(()=>{var me=SI(),fe=me.firstChild,V=fe.nextSibling;return V.nextSibling,u(me,K),s(me,()=>t("inventory.quantity"),fe),s(me,()=>D.quantity,V),s(me,()=>t("common.units"),null),me})()]}})}})),Y})()]:[(()=>{var Y=PI(),D=Y.firstChild,Q=D.nextSibling,W=Q.nextSibling,me=W.nextSibling;return u(Y,O),D.$$click=()=>m("overview"),s(D,()=>t("inventory.overview")),Q.$$click=()=>m("products"),s(Q,()=>t("inventory.products")),W.$$click=()=>m("movements"),s(W,()=>t("inventory.movements")),me.$$click=()=>m("locations"),s(me,()=>t("inventory.locations")),ie(fe=>{var V=N(h()==="overview"),re=N(h()==="products"),_e=N(h()==="movements"),Pe=N(h()==="locations");return fe.e=u(D,V,fe.e),fe.t=u(Q,re,fe.t),fe.a=u(W,_e,fe.a),fe.o=u(me,Pe,fe.o),fe},{e:void 0,t:void 0,a:void 0,o:void 0}),Y})(),ye(()=>ye(()=>h()==="overview")()&&(()=>{var Y=wI(),D=Y.firstChild;return s(D,v(Ze,{get title(){return t("inventory.activeProducts")},get subtitle(){return t("inventory.currentlyManaged")},get children(){var Q=kr();return Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","600"),Q.style.setProperty("color","var(--primary-color)"),s(Q,()=>z().activeProducts),Q}}),null),s(D,v(Ze,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.needAttention")},get children(){var Q=kr();return Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","600"),Q.style.setProperty("color","#d32f2f"),s(Q,()=>z().lowStockProducts),Q}}),null),s(D,v(Ze,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.currentWorth")},get children(){var Q=kr();return Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","600"),Q.style.setProperty("color","var(--primary-color)"),s(Q,()=>U(pe().totalValue)),Q}}),null),s(D,v(Ze,{get title(){return t("inventory.movements")},get subtitle(){return t("inventory.thisMonth")},get children(){var Q=kr();return Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","600"),Q.style.setProperty("color","var(--primary-color)"),s(Q,()=>z().totalMovementsThisMonth),Q}}),null),s(D,v(Ze,{get title(){return t("inventory.activeLocations")},get subtitle(){return t("inventory.warehousesStores")},get children(){var Q=kr();return Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","600"),Q.style.setProperty("color","var(--primary-color)"),s(Q,()=>z().activeLocations),Q}}),null),s(Y,(()=>{var Q=ye(()=>z().lowStockProducts>0);return()=>Q()&&v(Ze,{get title(){return`⚠️ ${t("inventory.lowStockAlert")}`},get subtitle(){return`${z().lowStockProducts} ${t("inventory.productsNeedRestocking")}`},style:{"margin-bottom":"2rem","border-color":"#ffcdd2",background:"#ffebee"},get children(){var W=kr();return W.style.setProperty("margin-top","1rem"),s(W,v(pt,{get each(){return De.getLowStockProducts().slice(0,9)},children:me=>(()=>{var fe=CI(),V=fe.firstChild,re=V.firstChild,_e=re.nextSibling;_e.nextSibling;var Pe=V.nextSibling,ae=Pe.firstChild,be=ae.nextSibling;return be.nextSibling,fe.style.setProperty("display","flex"),fe.style.setProperty("justify-content","space-between"),fe.style.setProperty("margin-bottom","0.5rem"),fe.style.setProperty("font-size","0.875rem"),s(V,()=>me.name,re),s(V,()=>me?.sku,_e),Pe.style.setProperty("color","#d32f2f"),Pe.style.setProperty("font-weight","600"),s(Pe,()=>me.currentStock,ae),s(Pe,()=>me.minStockLevel,be),s(Pe,()=>t("inventory.min"),null),fe})()}),null),s(W,(()=>{var me=ye(()=>De.getLowStockProducts().length>5);return()=>me()&&(()=>{var fe=kr();return fe.style.setProperty("font-size","0.875rem"),fe.style.setProperty("color","var(--text-muted)"),fe.style.setProperty("font-style","italic"),s(fe,()=>t("common.andMore",{count:De.getLowStockProducts().length-9})),fe})()})(),null),W}})})(),null),ie(Q=>u(D,R,Q)),Y})()),ye(()=>ye(()=>h()==="products")()&&v(Ig,{})),ye(()=>ye(()=>h()==="movements")()&&v(_A,{})),ye(()=>ye(()=>h()==="locations")()&&(()=>{var Y=AI(),D=Y.firstChild,Q=D.firstChild,W=D.nextSibling;return D.style.setProperty("display","flex"),D.style.setProperty("justify-content","space-between"),D.style.setProperty("align-items","center"),D.style.setProperty("margin-bottom","1.5rem"),Q.style.setProperty("margin","0"),Q.style.setProperty("font-size","1.5rem"),s(Q,()=>t("inventory.locations")),s(D,v(Ne,{get when(){return Pt.hasPermission("read_write")},get children(){return v(Le,{variant:"primary",onClick:()=>S(!0),get children(){return["🏭 ",ye(()=>t("inventory.addLocation"))]}})}}),null),u(W,te),s(W,v(pt,{get each(){return De.getActiveLocations()},children:me=>{const fe=De.getStockByLocation(me.id),V=fe.length,re=fe.reduce((Pe,ae)=>Pe*1+ae.quantity*1,0),_e=fe.reduce((Pe,ae)=>(De.getProductById(ae.productId),Pe+(ae?.averageCost||0)),0);return(()=>{var Pe=II(),ae=Pe.firstChild,be=ae.firstChild,oe=be.firstChild,Se=oe.nextSibling,Ee=be.nextSibling,xe=Ee.firstChild,$e=Ee.nextSibling,Me=ae.nextSibling,We=Me.firstChild,je=We.firstChild,Ce=je.firstChild,Ve=je.nextSibling,Ke=We.nextSibling,He=Ke.firstChild,Qe=He.firstChild,Ie=He.nextSibling,ot=Ke.nextSibling,et=ot.firstChild,Ct=et.firstChild,yt=et.nextSibling,Dt=Me.nextSibling,Tt=Dt.firstChild,$t=Tt.firstChild;return ae.style.setProperty("margin-bottom","1rem"),ae.style.setProperty("padding-bottom","1rem"),ae.style.setProperty("border-bottom","1px solid var(--border-color)"),be.style.setProperty("display","flex"),be.style.setProperty("align-items","center"),be.style.setProperty("gap","0.5rem"),be.style.setProperty("margin-bottom","0.5rem"),oe.style.setProperty("font-size","1.2rem"),s(oe,()=>me.type==="warehouse"?"🏭":me.type==="store"?"🏪":me.type==="supplier"?"🚚":"👥"),Se.style.setProperty("margin","0"),Se.style.setProperty("font-size","1.1rem"),s(Se,()=>me.name),Ee.style.setProperty("font-size","0.875rem"),Ee.style.setProperty("color","var(--text-muted)"),s(Ee,()=>me.code,xe),s(Ee,()=>he(me.type),null),$e.style.setProperty("font-size","0.75rem"),$e.style.setProperty("color","var(--text-muted)"),$e.style.setProperty("margin-top","0.25rem"),s($e,()=>me.address),Me.style.setProperty("margin-bottom","1rem"),We.style.setProperty("display","flex"),We.style.setProperty("justify-content","space-between"),We.style.setProperty("margin-bottom","0.5rem"),je.style.setProperty("font-size","0.875rem"),je.style.setProperty("font-weight","500"),s(je,()=>t("inventory.products"),Ce),Ve.style.setProperty("font-weight","600"),s(Ve,V),Ke.style.setProperty("display","flex"),Ke.style.setProperty("justify-content","space-between"),Ke.style.setProperty("margin-bottom","0.5rem"),He.style.setProperty("font-size","0.875rem"),He.style.setProperty("font-weight","500"),s(He,()=>t("inventory.totalItems"),Qe),Ie.style.setProperty("font-weight","600"),Ie.style.setProperty("color","var(--primary-color)"),s(Ie,re),ot.style.setProperty("display","flex"),ot.style.setProperty("justify-content","space-between"),ot.style.setProperty("margin-bottom","1rem"),et.style.setProperty("font-size","0.875rem"),et.style.setProperty("font-weight","500"),s(et,()=>t("inventory.totalValue"),Ct),yt.style.setProperty("font-weight","600"),yt.style.setProperty("color","var(--primary-color)"),s(yt,()=>U(_e)),Tt.style.setProperty("font-weight","600"),Tt.style.setProperty("margin-bottom","0.75rem"),Tt.style.setProperty("font-size","0.875rem"),Tt.style.setProperty("color","var(--text-primary)"),Tt.style.setProperty("border-bottom","1px solid var(--border-color)"),Tt.style.setProperty("padding-bottom","0.5rem"),s(Tt,()=>t("inventory.productDetails"),$t),s(Dt,(()=>{var qt=ye(()=>fe.length===0);return()=>qt()?(()=>{var st=kr();return st.style.setProperty("text-align","center"),st.style.setProperty("color","var(--text-muted)"),st.style.setProperty("font-style","italic"),st.style.setProperty("padding","1rem"),s(st,()=>t("inventory.noProducts")),st})():(()=>{var st=kr();return st.style.setProperty("max-height","200px"),st.style.setProperty("overflow-y","auto"),st.style.setProperty("border","1px solid var(--border-color)"),st.style.setProperty("border-radius","var(--border-radius-sm)"),s(st,v(pt,{each:fe,children:ke=>{const at=De.getProductById(ke.productId);if(!at)return null;const kt=ke.quantity<=at.minStockLevel,Fe=ke.averageCost;return ke.quantity?(()=>{var Be=xI(),Je=Be.firstChild,rt=Je.firstChild,vt=rt.firstChild,Xe=vt.nextSibling,bt=rt.nextSibling,ft=bt.firstChild,Oe=ft.firstChild,dt=ft.nextSibling,Bt=dt.nextSibling;return Bt.firstChild,Be.style.setProperty("padding","0.75rem"),Be.style.setProperty("border-bottom","1px solid var(--border-color)"),(kt?"#fff5f5":"transparent")!=null?Be.style.setProperty("background",kt?"#fff5f5":"transparent"):Be.style.removeProperty("background"),Be.style.setProperty("transition","background-color 0.2s ease"),Je.style.setProperty("display","flex"),Je.style.setProperty("justify-content","space-between"),Je.style.setProperty("align-items","flex-start"),Je.style.setProperty("margin-bottom","0.25rem"),rt.style.setProperty("flex","1"),vt.style.setProperty("font-weight","500"),vt.style.setProperty("font-size","0.875rem"),(kt?"#d32f2f":"var(--text-primary)")!=null?vt.style.setProperty("color",kt?"#d32f2f":"var(--text-primary)"):vt.style.removeProperty("color"),s(vt,()=>at.name,null),s(vt,kt&&(()=>{var gt=EI();return gt.style.setProperty("margin-left","0.5rem"),gt.style.setProperty("font-size","0.7rem"),gt.style.setProperty("color","#d32f2f"),gt})(),null),Xe.style.setProperty("font-size","0.75rem"),Xe.style.setProperty("color","var(--text-muted)"),Xe.style.setProperty("margin-top","0.1rem"),s(Xe,()=>at.sku,null),s(Xe,()=>at.UPC?" • "+at.UPC:"",null),s(Xe,()=>at.category?" • "+at.category:"",null),bt.style.setProperty("text-align","right"),ft.style.setProperty("font-weight","600"),ft.style.setProperty("font-size","0.875rem"),(kt?"#d32f2f":"var(--primary-color)")!=null?ft.style.setProperty("color",kt?"#d32f2f":"var(--primary-color)"):ft.style.removeProperty("color"),s(ft,()=>ke.quantity,Oe),s(ft,()=>at.unitOfMeasure,null),dt.style.setProperty("font-size","0.75rem"),dt.style.setProperty("color","var(--text-muted)"),s(dt,()=>U(Fe)),Bt.style.setProperty("font-size","0.7rem"),Bt.style.setProperty("color","var(--text-muted)"),Bt.style.setProperty("margin-top","0.1rem"),s(Bt,()=>at.minStockLevel,null),Be})():null}})),st})()})(),null),ie(qt=>u(Pe,{...de,"min-height":"400px"},qt)),Pe})()}})),Y})())]}}),v(Ne,{get when(){return Pt.hasPermission("read_write")},get children(){return[v(LC,{get isOpen(){return e()},onClose:()=>r(!1),get mode(){return g()==="new"?"movement":"legacy"}}),v(jC,{get isOpen(){return n()},onClose:()=>o(!1)}),v(YC,{get isOpen(){return i()},onClose:()=>a(!1),get item(){return c()}}),v($u,{get isOpen(){return w()},onClose:()=>S(!1),onLocationAdded:()=>{S(!1)}})]}}),v(RA,{get isOpen(){return P()},onClose:()=>x(!1)})]}})};Et(["click"]);const $I="modulepreload",kI=function(t){return"/"+t},om={},RI=function(e,r,n){let o=Promise.resolve();if(r&&r.length>0){let a=function(h){return Promise.all(h.map(m=>Promise.resolve(m).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=c?.nonce||c?.getAttribute("nonce");o=a(r.map(h=>{if(h=kI(h),h in om)return;om[h]=!0;const m=h.endsWith(".css"),g=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${g}`))return;const _=document.createElement("link");if(_.rel=m?"stylesheet":$I,m||(_.as="script"),_.crossOrigin="",_.href=h,d&&_.setAttribute("nonce",d),document.head.appendChild(_),m)return new Promise((A,L)=>{_.addEventListener("load",A),_.addEventListener("error",()=>L(new Error(`Unable to preload CSS for ${h}`)))})}))}function i(a){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=a,window.dispatchEvent(c),!c.defaultPrevented)throw a}return o.then(a=>{for(const c of a||[])c.status==="rejected"&&i(c.reason);return e().catch(i)})},DI=async(t,e)=>{try{console.log("Loading jsPDF...");const{default:r}=await RI(async()=>{const{default:ne}=await import("./jspdf.es.min-6CNFlu4Q.js").then(w=>w.j);return{default:ne}},[]);console.log("jsPDF loaded, creating document...");const n=new r,o=n.internal.pageSize.getWidth(),i=n.internal.pageSize.getHeight(),a=20;let c=a;const d=ne=>{c+ne>i-a&&(n.addPage(),c=a)},h=[37,99,235],m=[51,51,51],g=[102,102,102];n.setFontSize(24),n.setTextColor(...h),n.text("HRM Finance",a,c),n.setFontSize(18),n.setTextColor(...m),n.text(e("common.invoice").toUpperCase(),o-a,c,{align:"right"}),c+=10,n.setFontSize(14),n.text(t.invoice,o-a,c,{align:"right"}),c+=6,n.setFontSize(10),n.setTextColor(...g);const _=new Date(t.createDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});n.text(_,o-a,c,{align:"right"});const A=t.isCompleted?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase(),L=t.isCompleted?[21,87,36]:[133,100,4];n.setTextColor(...L),n.setFontSize(8),n.text(A,o-a,c+6,{align:"right"}),c=35,n.setFontSize(10),n.setTextColor(...g),n.text(`${e("common.location")}: ${t.storeName||t.store}`,a,c),c+=5,n.text(`${e("invoices.id")}: ${t.ssg_sorder_key}`,a,c),c+=10,n.setDrawColor(224,224,224),n.line(a,c,o-a,c),c+=10,d(40),n.setFontSize(14),n.setTextColor(...m),n.text(e("invoices.senderInformation"),a,c),c+=8,n.setFontSize(10),n.setTextColor(...g),n.text(e("invoices.customerName"),a,c),c+=5,n.setTextColor(...m),n.text(t.shipper_consignee?.name||"N/A",a,c),t.shipper_consignee?.phoneNumberS&&(c+=5,n.setTextColor(...g),n.text(`${e("invoices.altPhone")}: ${t.shipper_consignee.phoneNumberS}`,a,c)),c+=10,d(50),n.setFontSize(14),n.setTextColor(...m),n.text(e("invoices.receiptInformation"),a,c),c+=8;const M=a,$=o/2+10;let T=c;n.setFontSize(10),n.setTextColor(...g),n.text(e("invoices.customerName"),M,T),T+=5,n.setTextColor(...m);const ee=[t.shipper_consignee?.firstName,t.shipper_consignee?.middleName,t.shipper_consignee?.lastName,t.shipper_consignee?.lastName2].filter(Boolean).join(" ")||"N/A";if(n.text(ee,M,T),T+=8,n.setTextColor(...g),n.text(e("invoices.id"),M,T),T+=5,n.setTextColor(...m),n.text(t.shipper_consignee?.cid||"N/A",M,T),T+=8,n.setTextColor(...g),n.text(e("invoices.passport"),M,T),T+=5,n.setTextColor(...m),n.text(t.shipper_consignee?.passport||"N/A",M,T),T=c,n.setTextColor(...g),n.text(e("invoices.phoneNumber"),$,T),T+=5,n.setTextColor(...m),n.text(t.shipper_consignee?.phoneNumber||"N/A",$,T),T+=8,n.setTextColor(...g),n.text(e("invoices.address"),$,T),T+=5,n.setTextColor(...m),n.setFontSize(9),[`${t.shipper_consignee?.ybstreet||""} #${t.shipper_consignee?.ybstreetNo||""}`,`${e("invoices.between")} ${t.shipper_consignee?.ybbetwen1||""} ${e("invoices.and")} ${t.shipper_consignee?.ybbetwen2||""}`,`${t.shipper_consignee?.ybreparto||""}, ${t.shipper_consignee?.ybcity||""}`,`${t.shipper_consignee?.ybestate||""}, ${t.shipper_consignee?.nacionality||""}`].forEach(ne=>{n.text(ne.trim(),$,T),T+=4}),c=Math.max(c+40,T+5),t.products&&t.products.length>0){d(30),n.setFontSize(14),n.setTextColor(...m),n.text(e("invoices.products"),a,c),c+=8,n.setFontSize(9),n.setTextColor(...m),n.setFont(void 0,"bold");const ne={code:30,description:80,qty:20,unitPrice:30,total:30};let w=a;n.text(e("invoices.code"),w,c),w+=ne.code,n.text(e("invoices.description"),w,c),w+=ne.description,n.text(e("invoices.qty"),w,c),w+=ne.qty,n.text(e("invoices.unitPrice"),w,c),w+=ne.unitPrice,n.text(e("invoices.total"),w,c),c+=2,n.line(a,c,o-a,c),c+=5,n.setFont(void 0,"normal"),t.products.forEach(S=>{d(10),w=a,n.text(S.product.code,w,c),w+=ne.code;let p=S.product.label;p.length>40&&(p=p.substring(0,40)+"..."),n.text(p,w,c),w+=ne.description,n.text(Math.abs(S.qty).toString(),w,c),w+=ne.qty,n.text(`$${parseFloat(S.salePrice).toFixed(2)}`,w,c),w+=ne.unitPrice;const C=Math.abs(S.qty)*parseFloat(S.salePrice);n.text(`$${C.toFixed(2)}`,w,c),c+=6}),c+=5}if(t.reservas&&t.reservas.length>0){d(30),n.setFontSize(14),n.setTextColor(...m),n.text(e("invoices.reservations"),a,c),c+=8,n.setFontSize(9),n.setFont(void 0,"bold");const ne={type:50,qty:30,unitPrice:30,arancel:30,total:30};let w=a;n.text(e("invoices.type"),w,c),w+=ne.type,n.text(e("invoices.qty"),w,c),w+=ne.qty,n.text(e("invoices.unitPrice"),w,c),w+=ne.unitPrice,n.text(e("invoices.arancel"),w,c),w+=ne.arancel,n.text(e("invoices.total"),w,c),c+=2,n.line(a,c,o-a,c),c+=5,n.setFont(void 0,"normal"),t.reservas.forEach(S=>{d(10),w=a,n.text(S.type,w,c),w+=ne.type,n.text(S.qty,w,c),w+=ne.qty,n.text(`$${parseFloat(S.price).toFixed(2)}`,w,c),w+=ne.unitPrice,n.text(S.arancel||"-",w,c),w+=ne.arancel;const p=parseInt(S.qty),C=parseFloat(S.price),P=S.arancel?parseFloat(S.arancel):0,x=p*C+P;n.text(`$${x.toFixed(2)}`,w,c),c+=6}),c+=5}d(30);const Z=o-80;n.setFontSize(10),t.productSubtotal&&(n.text(`${e("invoices.productsSubtotal")}:`,Z,c),n.text(`$${t.productSubtotal.toFixed(2)}`,o-a,c,{align:"right"}),c+=6),t.reservaSubtotal&&(n.text(`${e("invoices.reservationsSubtotal")}:`,Z,c),n.text(`$${t.reservaSubtotal.toFixed(2)}`,o-a,c,{align:"right"}),c+=6),c+=2,n.line(Z-10,c,o-a,c),c+=6,n.setFontSize(14),n.setFont(void 0,"bold"),n.setTextColor(...h),n.text(`${e("invoices.total")}:`,Z,c),n.text(`$${(t.total||0).toFixed(2)}`,o-a,c,{align:"right"}),c=i-30,n.setFontSize(10),n.setTextColor(...g),n.setFont(void 0,"normal"),n.text("Thank you for your business!",o/2,c,{align:"center"}),c+=5,n.setFontSize(8);const ge=new Date().toLocaleString("en-US");n.text(`Generated on ${ge}`,o/2,c,{align:"center"}),n.save(`invoice-${t.invoice}.pdf`),console.log("PDF saved successfully")}catch(r){throw console.error("Error generating PDF:",r),r}};var NI=q("<br>"),im=q("<div><h3></h3><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),sm=q("<div><span>:</span><span>"),LI=q("<div class=invoice-display><div><div><div>:<span></span></div><div>: <span></span></div></div><div><div></div><h2></h2><div></div><div></div></div></div><div><h3></h3><div><div><div></div><div></div></div></div><div></div><h3></h3><div><div><div></div><div> <!> <!> </div><div></div><div></div><div></div><div></div></div><div><div></div><div></div><div></div><div></div><div> #<br> <!> <!> <br>, <br>, </div></div></div></div><div><div><div><span>:</span><span></span></div></div></div><div></div><div><button>🖨️ </button><button>📥 </button></div><style>"),am=q("<tr><td></td><td></td><td></td><td></td><td>");const MI=t=>{const{t:e}=ct(),r=p=>new Date(p).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),n=p=>{const C=typeof p=="string"?parseFloat(p):p;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(C)},o=Ge(()=>{let p=0,C=0,P=0,x=0;t.invoice?.products?.forEach(E=>{const F=Math.abs(E?.qty),z=parseFloat(E?.salePrice)||1;p+=F*z}),t.invoice?.reservas?.forEach(E=>{let F=parseInt(E?.qty);isNaN(F)&&(F=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[E.type]||E?.onlyTariff?(F=parseFloat(E.arancel)||parseFloat(E.qty)*parseFloat(E.price),P+=F):(E?.arancel&&(x+=parseFloat(E?.arancel)),C+=F*parseFloat(E?.price))});const y=p+C+x+P,ue=0,J=y+ue;return{productSubtotal:p,reservaSubtotal:C,tariffSubtotal:x,subtotal:y,tax:ue,total:J}}),i={"max-width":"800px",margin:"0 auto",padding:"2rem",background:"white","box-shadow":"0 0 20px rgba(0,0,0,0.1)","border-radius":"var(--border-radius)"},a={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"2rem","padding-bottom":"2rem","border-bottom":"2px solid #e0e0e0"},c={"text-align":"right",flex:"1"},d={display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"600","text-transform":"uppercase",background:t.invoice.isCompleted?"#d4edda":"#fff3cd",color:t.invoice.isCompleted?"#155724":"#856404","margin-bottom":"0.5rem"},h={"margin-bottom":"2rem"},m={"font-size":"1.1rem","font-weight":"600","margin-bottom":"1rem",color:"#333"},g={display:"grid","grid-template-columns":"1fr 1fr",gap:"1.5rem"},_={background:"#f8f9fa",padding:"1rem","border-radius":"var(--border-radius-sm)",border:"1px solid #e9ecef"},A={"font-size":"0.875rem",color:"#666","margin-bottom":"0.25rem"},L={"font-size":"1rem",color:"#333","font-weight":"500"},M={width:"100%","border-collapse":"collapse","margin-top":"1rem"},$={"text-align":"left",padding:"0.75rem","border-bottom":"2px solid #dee2e6","font-weight":"600",color:"#495057","font-size":"0.875rem","text-transform":"uppercase"},T={padding:"0.75rem","border-bottom":"1px solid #dee2e6",color:"#212529"},ee={"font-weight":"600","font-size":"1.1rem"},ce={display:"flex",gap:"1rem","justify-content":"center","margin-top":"2rem","padding-top":"2rem","border-top":"2px solid #e0e0e0"},Z={padding:"0.75rem 1.5rem","border-radius":"var(--border-radius-sm)",border:"none","font-weight":"500",cursor:"pointer",transition:"all 0.2s",display:"flex","align-items":"center",gap:"0.5rem"},ge={...Z,background:"var(--primary-color)",color:"white"},ne={...Z,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},w=Ge(()=>De.getLocationById(t.invoice.store)),S=async()=>{console.log("Starting PDF export...");try{if(!t.invoice){console.error("No invoice data available"),alert("No invoice data available");return}console.log("Invoice data:",t.invoice),console.log("Store info:",w()),console.log("Totals:",o());const p={...t.invoice,storeName:w()?.name||t.invoice.store,productSubtotal:o().productSubtotal,reservaSubtotal:o().reservaSubtotal,total:o().total};console.log("Prepared invoice data:",p),await DI(p,e),console.log("PDF generation completed")}catch(p){console.error("Error in handleExportPDF:",p),console.error("Error stack:",p.stack),alert(`Error generating PDF: ${p.message}`)}};return(()=>{var p=LI(),C=p.firstChild,P=C.firstChild,x=P.firstChild,y=x.firstChild,ue=y.nextSibling,J=x.nextSibling,E=J.firstChild,F=E.nextSibling,z=P.nextSibling,B=z.firstChild,k=B.nextSibling,U=k.nextSibling,he=U.nextSibling,H=C.nextSibling,le=H.firstChild,I=le.nextSibling,j=I.firstChild,K=j.firstChild,R=K.nextSibling,X=I.nextSibling,O=X.nextSibling,N=O.nextSibling,te=N.firstChild,de=te.firstChild,pe=de.nextSibling,se=pe.firstChild,Y=se.nextSibling,D=Y.nextSibling,Q=D.nextSibling;Q.nextSibling;var W=pe.nextSibling,me=W.nextSibling,fe=me.nextSibling,V=fe.nextSibling,re=te.nextSibling,_e=re.firstChild,Pe=_e.nextSibling,ae=Pe.nextSibling,be=ae.nextSibling,oe=be.nextSibling,Se=oe.firstChild,Ee=Se.nextSibling,xe=Ee.nextSibling,$e=xe.nextSibling,Me=$e.nextSibling,We=Me.nextSibling,je=We.nextSibling,Ce=je.nextSibling,Ve=Ce.nextSibling,Ke=Ve.nextSibling,He=Ke.nextSibling,Qe=H.nextSibling,Ie=Qe.firstChild,ot=Ie.firstChild,et=ot.firstChild,Ct=et.firstChild,yt=et.nextSibling,Dt=Qe.nextSibling,Tt=Dt.nextSibling,$t=Tt.firstChild;$t.firstChild;var qt=$t.nextSibling;qt.firstChild;var st=Tt.nextSibling;return u(p,i),u(C,a),x.style.setProperty("color","#666"),x.style.setProperty("margin-top","0.25rem"),s(x,()=>e(`inventory.${w()?.type}Type`),y),ue.style.setProperty("font-size","1.1rem"),ue.style.setProperty("font-weight","600"),ue.style.setProperty("color","#444"),s(ue,()=>w()?.name),J.style.setProperty("font-size",".91rem"),J.style.setProperty("font-weight","400"),J.style.setProperty("color","#666"),s(J,()=>e("invoices.id"),E),F.style.setProperty("font-size","1.1rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("color","#444"),s(F,()=>t.invoice.ssg_sorder_key),u(z,c),s(B,(()=>{var ke=ye(()=>!!t.invoice.isCompleted);return()=>ke()?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase()})()),k.style.setProperty("margin","0 0 0.5rem 0"),k.style.setProperty("font-size","1.5rem"),s(k,()=>e("common.invoice").toUpperCase()),U.style.setProperty("font-size","1.1rem"),U.style.setProperty("font-weight","600"),U.style.setProperty("color","#333"),s(U,()=>t.invoice.invoice),he.style.setProperty("color","#666"),he.style.setProperty("margin-top","0.5rem"),s(he,()=>r(t.invoice.createDate)),s(le,()=>e("invoices.senderInformation")),s(K,()=>e("invoices.customerName")),s(R,()=>t.invoice.shipper_consignee.name),s(j,v(Ne,{get when(){return t.invoice.shipper_consignee.phoneNumberS},get children(){return[NI(),ye(()=>e("invoices.altPhone")),": ",ye(()=>t.invoice.shipper_consignee.phoneNumberS)]}}),null),X.style.setProperty("margin","20px"),s(O,()=>e("invoices.receiptInformation")),s(de,()=>e("invoices.customerName")),s(pe,()=>t.invoice.shipper_consignee.firstName,se),s(pe,()=>t.invoice.shipper_consignee.middleName,Y),s(pe,()=>t.invoice.shipper_consignee.lastName,Q),s(pe,()=>t.invoice.shipper_consignee.lastName2,null),s(W,()=>e("invoices.id")),s(me,()=>t.invoice.shipper_consignee.cid),s(fe,()=>e("invoices.passport")),s(V,()=>t.invoice.shipper_consignee.passport),s(_e,()=>e("invoices.contactInformation")),s(Pe,()=>e("invoices.phoneNumber")),s(ae,()=>t.invoice.shipper_consignee.phoneNumber),s(be,()=>e("invoices.address")),s(oe,()=>t.invoice.shipper_consignee.ybstreet,Se),s(oe,()=>t.invoice.shipper_consignee.ybstreetNo,Ee),s(oe,()=>e("invoices.between"),xe),s(oe,()=>t.invoice.shipper_consignee.ybbetwen1,$e),s(oe,()=>e("invoices.and"),We),s(oe,()=>t.invoice.shipper_consignee.ybbetwen2,Ce),s(oe,()=>t.invoice.shipper_consignee.ybreparto,Ve),s(oe,()=>t.invoice.shipper_consignee.ybcity,Ke),s(oe,()=>t.invoice.shipper_consignee.ybestate,He),s(oe,()=>t.invoice.shipper_consignee.nacionality,null),s(p,v(Ne,{get when(){return t.invoice?.products?.length>0},get children(){var ke=im(),at=ke.firstChild,kt=at.nextSibling,Fe=kt.firstChild,Be=Fe.firstChild,Je=Be.firstChild,rt=Je.nextSibling,vt=rt.nextSibling,Xe=vt.nextSibling,bt=Xe.nextSibling,ft=Fe.nextSibling;return s(at,()=>e("invoices.products")),s(Je,()=>e("invoices.code")),s(rt,()=>e("invoices.description")),s(vt,()=>e("invoices.qty")),s(Xe,()=>e("invoices.unitPrice")),s(bt,()=>e("invoices.total")),s(ft,v(pt,{get each(){return t.invoice?.products},children:Oe=>(()=>{var dt=am(),Bt=dt.firstChild,gt=Bt.nextSibling,Nt=gt.nextSibling,Ft=Nt.nextSibling,_t=Ft.nextSibling;return s(Bt,()=>Oe.product.code),s(gt,()=>Oe.product.label),s(Nt,()=>Math.abs(Oe.qty)),s(Ft,()=>n(Oe.salePrice)),s(_t,()=>n(Math.abs(Oe.qty)*parseFloat(Oe.salePrice))),ie(nt=>{var tr=T,Ut=T,Xt={...T,"text-align":"center"},dr={...T,"text-align":"right"},Tr={...T,"text-align":"right"};return nt.e=u(Bt,tr,nt.e),nt.t=u(gt,Ut,nt.t),nt.a=u(Nt,Xt,nt.a),nt.o=u(Ft,dr,nt.o),nt.i=u(_t,Tr,nt.i),nt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),dt})()})),ie(Oe=>{var dt=h,Bt=m,gt=M,Nt=$,Ft=$,_t={...$,"text-align":"center"},nt={...$,"text-align":"right"},tr={...$,"text-align":"right"};return Oe.e=u(ke,dt,Oe.e),Oe.t=u(at,Bt,Oe.t),Oe.a=u(kt,gt,Oe.a),Oe.o=u(Je,Nt,Oe.o),Oe.i=u(rt,Ft,Oe.i),Oe.n=u(vt,_t,Oe.n),Oe.s=u(Xe,nt,Oe.s),Oe.h=u(bt,tr,Oe.h),Oe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),ke}}),Qe),s(p,v(Ne,{get when(){return t.invoice?.reservas?.length>0},get children(){var ke=im(),at=ke.firstChild,kt=at.nextSibling,Fe=kt.firstChild,Be=Fe.firstChild,Je=Be.firstChild,rt=Je.nextSibling,vt=rt.nextSibling,Xe=vt.nextSibling,bt=Xe.nextSibling,ft=Fe.nextSibling;return s(at,()=>e("invoices.reservations")),s(Je,()=>e("invoices.type")),s(rt,()=>e("invoices.qty")),s(vt,()=>e("invoices.unitPrice")),s(Xe,()=>e("invoices.arancel")),s(bt,()=>e("invoices.total")),s(ft,v(pt,{get each(){return t.invoice?.reservas},children:Oe=>(()=>{var dt=am(),Bt=dt.firstChild,gt=Bt.nextSibling,Nt=gt.nextSibling,Ft=Nt.nextSibling,_t=Ft.nextSibling;return s(Bt,()=>Oe.type),s(gt,()=>Oe.qty),s(Nt,()=>n(Oe.price)),s(Ft,()=>Oe.arancel||"-"),s(_t,()=>n(parseInt(Oe.qty)*parseFloat(Oe.price)+(Oe.arancel?parseFloat(Oe.arancel):0))),ie(nt=>{var tr=T,Ut={...T,"text-align":"center"},Xt={...T,"text-align":"right"},dr={...T,"text-align":"right"},Tr={...T,"text-align":"right"};return nt.e=u(Bt,tr,nt.e),nt.t=u(gt,Ut,nt.t),nt.a=u(Nt,Xt,nt.a),nt.o=u(Ft,dr,nt.o),nt.i=u(_t,Tr,nt.i),nt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),dt})()})),ie(Oe=>{var dt=h,Bt=m,gt=M,Nt=$,Ft={...$,"text-align":"center"},_t={...$,"text-align":"right"},nt={...$,"text-align":"right"},tr={...$,"text-align":"right"};return Oe.e=u(ke,dt,Oe.e),Oe.t=u(at,Bt,Oe.t),Oe.a=u(kt,gt,Oe.a),Oe.o=u(Je,Nt,Oe.o),Oe.i=u(rt,Ft,Oe.i),Oe.n=u(vt,_t,Oe.n),Oe.s=u(Xe,nt,Oe.s),Oe.h=u(bt,tr,Oe.h),Oe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),ke}}),Qe),Ie.style.setProperty("display","inline-block"),Ie.style.setProperty("min-width","250px"),s(Ie,v(Ne,{get when(){return t.invoice?.products?.length>0},get children(){var ke=sm(),at=ke.firstChild,kt=at.firstChild,Fe=at.nextSibling;return ke.style.setProperty("display","flex"),ke.style.setProperty("justify-content","space-between"),ke.style.setProperty("margin-bottom","0.5rem"),s(at,()=>e("invoices.productsSubtotal"),kt),s(Fe,()=>n(o().productSubtotal)),ke}}),ot),s(Ie,v(Ne,{get when(){return t.invoice?.reservas?.length>0},get children(){var ke=sm(),at=ke.firstChild,kt=at.firstChild,Fe=at.nextSibling;return ke.style.setProperty("display","flex"),ke.style.setProperty("justify-content","space-between"),ke.style.setProperty("margin-bottom","0.5rem"),s(at,()=>e("invoices.subtotal"),kt),s(Fe,()=>n(o().reservaSubtotal)),ke}}),ot),s(et,()=>e("invoices.total"),Ct),yt.style.setProperty("color","var(--primary-color)"),s(yt,()=>n(o().total)),$t.addEventListener("mouseleave",ke=>ke.currentTarget.style.opacity="1"),$t.addEventListener("mouseenter",ke=>ke.currentTarget.style.opacity="0.9"),$t.$$click=()=>t.onPrint?.(),s($t,()=>e("invoices.printInvoice"),null),qt.addEventListener("mouseleave",ke=>{ke.currentTarget.style.background="white",ke.currentTarget.style.color="var(--primary-color)"}),qt.addEventListener("mouseenter",ke=>{ke.currentTarget.style.background="var(--primary-color)",ke.currentTarget.style.color="white"}),qt.$$click=S,s(qt,()=>e("invoices.exportPdf"),null),s(st,`
        @media print {
          .invoice-display {
            box-shadow: none !important;
            padding: 0 !important;
          }
          
          ${ce} {
            display: none !important;
          }
        }
      `),ie(ke=>{var at=d,kt=h,Fe=m,Be=g,Je=_,rt=A,vt=L,Xe=m,bt=g,ft=_,Oe=A,dt=L,Bt={...A,"margin-top":"0.75rem"},gt=L,Nt={...A,"margin-top":"0.75rem"},Ft=L,_t=_,nt=A,tr={...A,"margin-top":"0.75rem"},Ut=L,Xt={...A,"margin-top":"0.75rem"},dr=L,Tr={...h,"text-align":"right"},Rr={...ee,display:"flex","justify-content":"space-between","padding-top":"0.75rem","border-top":"2px solid #dee2e6"},pn={...h,"text-align":"center",color:"#666","font-size":"0.875rem"},Mn=ce,Mo=ge,uo=ne;return ke.e=u(B,at,ke.e),ke.t=u(H,kt,ke.t),ke.a=u(le,Fe,ke.a),ke.o=u(I,Be,ke.o),ke.i=u(j,Je,ke.i),ke.n=u(K,rt,ke.n),ke.s=u(R,vt,ke.s),ke.h=u(O,Xe,ke.h),ke.r=u(N,bt,ke.r),ke.d=u(te,ft,ke.d),ke.l=u(de,Oe,ke.l),ke.u=u(pe,dt,ke.u),ke.c=u(W,Bt,ke.c),ke.w=u(me,gt,ke.w),ke.m=u(fe,Nt,ke.m),ke.f=u(V,Ft,ke.f),ke.y=u(re,_t,ke.y),ke.g=u(_e,nt,ke.g),ke.p=u(Pe,tr,ke.p),ke.b=u(ae,Ut,ke.b),ke.T=u(be,Xt,ke.T),ke.A=u(oe,dr,ke.A),ke.O=u(Qe,Tr,ke.O),ke.I=u(ot,Rr,ke.I),ke.S=u(Dt,pn,ke.S),ke.W=u(Tt,Mn,ke.W),ke.C=u($t,Mo,ke.C),ke.B=u(qt,uo,ke.B),ke},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),p})()};Et(["click"]);const[zs,zt]=Rc({invoices:[],selectedInvoice:null,loading:!1,error:null,lastUpdated:null}),[OI,nn]=ve({fetchAll:!1,fetchById:!1,create:!1,update:!1,delete:!1}),Ur={get state(){return zs},get loadingStates(){return OI()},async fetchInvoices(t){try{nn(a=>({...a,fetchAll:!0})),zt("loading",!0),zt("error",null);let e="SALES";t?.store&&t.store!=="all"&&(e+=" "+t.store),t?.status&&t.status!=="all"&&(e+=" "+t.status);const r=e.toString(),n=await ln.getInvoice(r);let o=[];if(t?.dateFrom&&t?.dateTo){const a=c=>{let d=new Date(n[c].createDate).getTime(),h=new Date(t?.dateFrom).getTime(),m=new Date(t?.dateTo).getTime();d>=h&&d<=m&&o.push(n[c])};Object.keys(n).map(a)}else o=Kl(n);const i=Array.isArray(o)?o:o||[];return zt("invoices",i),zt("lastUpdated",new Date),i}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoices";throw zt("error",r),console.error("Error fetching invoices:",e),e}finally{zt("loading",!1),nn(e=>({...e,fetchAll:!1}))}},fecthInventory:async t=>{},async fetchInvoiceById(t){try{nn(n=>({...n,fetchById:!0})),zt("error",null);const e=await ln.getInvoice(t),r=Kl(e);return zt("selectedInvoice",r[0]),r}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoice";throw zt("error",r),console.error("Error fetching invoice:",e),e}finally{nn(e=>({...e,fetchById:!1}))}},async createInvoice(t){try{nn(r=>({...r,create:!0})),zt("error",null);const e={};return zt("invoices",r=>[e,...r]),zt("lastUpdated",new Date),e}catch(e){const r=e instanceof Error?e.message:"Failed to create invoice";throw zt("error",r),console.error("Error creating invoice:",e),e}finally{nn(e=>({...e,create:!1}))}},async updateInvoice(t,e){try{nn(n=>({...n,update:!0})),zt("error",null);const r={};return zt("invoices",n=>n.map(o=>o.invoice===t?r:o)),zs.selectedInvoice?.invoice===t&&zt("selectedInvoice",r),zt("lastUpdated",new Date),r}catch(r){const n=r instanceof Error?r.message:"Failed to update invoice";throw zt("error",n),console.error("Error updating invoice:",r),r}finally{nn(r=>({...r,update:!1}))}},async deleteInvoice(t){try{return nn(e=>({...e,delete:!0})),zt("error",null),zt("invoices",e=>e.filter(r=>r.invoice!==t)),zs.selectedInvoice?.invoice===t&&zt("selectedInvoice",null),zt("lastUpdated",new Date),!0}catch(e){const r=e instanceof Error?e.message:"Failed to delete invoice";throw zt("error",r),console.error("Error deleting invoice:",e),e}finally{nn(e=>({...e,delete:!1}))}},async fetchInvoiceStats(t){try{zt("error",null);const e=new URLSearchParams;t?.store&&t.store!=="all"&&e.append("store",t.store),t?.dateFrom&&e.append("dateFrom",t.dateFrom),t?.dateTo&&e.append("dateTo",t.dateTo);const r=e.toString();return[]}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoice statistics";throw zt("error",r),console.error("Error fetching invoice stats:",e),e}},async fetchStores(){try{return zt("error",null),[]}catch(t){const e=t instanceof Error?t.message:"Failed to fetch stores";throw zt("error",e),console.error("Error fetching stores:",t),t}},setSelectedInvoice(t){zt("selectedInvoice",t)},clearError(){zt("error",null)},getFilteredInvoices(t){let e=zs.invoices;if(t.store&&t.store!=="all"&&(e=e.filter(r=>r.store===t.store)),t.dateFrom){const r=new Date(t.dateFrom).getTime();e=e.filter(n=>n.createDate>=r)}if(t.dateTo){const r=new Date(t.dateTo).setHours(23,59,59,999);e=e.filter(n=>n.createDate<=r)}if(t.status&&t.status!=="all"){const r=t.status==="completed";e=e.filter(n=>n.isCompleted===r)}return e},calculateSummary(t){let e=t.length,r=t.filter(_=>_.isCompleted).length,n=0,o=0,i=0,a=0,c=0,d=0,h=new Set,m=new Set;t?.forEach(_=>{h.add(_?.shipper_consignee?.cid),m.add(_.store),_?.products?.forEach(A=>{const L=Math.abs(A?.qty);n+=L,i+=L*(parseFloat(A?.salePrice)||1)}),_?.reservas?.forEach(A=>{let L=parseInt(A?.qty);isNaN(L)&&(L=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[A.type]||A?.onlyTariff?(L=parseFloat(A.arancel)||parseFloat(A.qty)*parseFloat(A.price),d+=L):(A?.arancel&&(c+=parseFloat(A?.arancel)),o+=L,a+=L*parseFloat(A?.price))})});const g=i+a+d;return{totalInvoices:e,completedInvoices:r,pendingInvoices:e-r,totalProducts:n,totalReservas:o,totalProductAmount:i,totalReservaAmount:a,totalAranceles:c,grandTotal:g,totalOther:d,uniqueCustomers:h.size,uniqueStores:m.size,avgInvoiceValue:e>0?g/e:0}},async refreshData(t){return console.log(" fetchInvoices {queryString}"),this.fetchInvoices(t)}};var VI=q("<div><div>"),BI=q("<div>⚠️ "),FI=q("<div><div><label></label><select><option value=all></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date>"),UI=q("<div><button></button><button>"),po=q("<div>"),jI=q("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),zI=q("<button>← "),qI=q("<option>"),GI=q("<div><div></div><div></div><div></div><div>"),lm=q("<div><span></span><span> "),HI=q("<div><span></span><span> $"),YI=q("<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td><span></span></td><td><button>");const WI=t=>{const{t:e}=ct(),[r,n]=ve(!1),[o,i]=ve("all"),[a,c]=ve(""),[d,h]=ve(""),[m,g]=ve(null),[_,A]=ve("dashboard"),[L,M]=ve([]),[$,T]=ve("overview");Hr(async()=>{try{t.invoices||console.log("fetchInvoices"),await Ur.fetchInvoices();try{const K=await Ur.fetchStores();let R=Array.isArray(K)?K:Object.keys(K)||[];console.log(R)}catch{const R=Ur.state.invoices||t.invoices,X=[...new Set(R.map(O=>O.store))];M(X.sort())}}catch(K){console.error("Error loading dashboard data:",K)}}),Ge(()=>Ur.state.invoices||t.invoices);const ee=Ge(()=>t.invoices?Ur.getFilteredInvoices({store:o(),dateFrom:a(),dateTo:d()}):Ur.getFilteredInvoices({store:o(),dateFrom:a(),dateTo:d()})),ce=async()=>{try{t.invoices,n(!0),await Ur.refreshData({store:o()!=="all"?o():void 0,dateFrom:a()||void 0,dateTo:d()||void 0}),n(!1)}catch(K){console.error("Error refreshing data:",K)}},Z=Ge(()=>{console.log("summary",r()),r();const K=ee(),R=Ur.calculateSummary(K);let X=new Map,O=new Map,N=new Map;return K.forEach(te=>{te?.products?.forEach(de=>{const pe=Math.abs(de.qty),se=de.product.label;X.set(se,(X.get(se)||0)+pe)}),te?.reservas?.forEach(de=>{let pe=parseInt(de.qty);isNaN(pe)&&(pe=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[de.type]||de?.onlyTariff?(pe=parseFloat(de.arancel)||parseFloat(de.qty)*parseFloat(de.price),N.set(de.type,(O.get(de.type)||0)+pe)):O.set(de.type,(O.get(de.type)||0)+pe)})}),{...R,productsByCategory:X,reservasByType:O,othersByType:N}}),ge=K=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(K),ne=K=>new Date(K).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),w={padding:"2rem"},S={display:"flex",gap:"1rem","align-items":"flex-end","margin-bottom":"2rem","flex-wrap":"wrap",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)"},p={display:"flex","flex-direction":"column",gap:"0.5rem",flex:"1","min-width":"200px"},C={"font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)"},P={padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--background-color)"},x={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(280px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},y={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)"},ue={width:"48px",height:"48px","border-radius":"12px",display:"flex","align-items":"center","justify-content":"center","font-size":"1.5rem","margin-bottom":"1rem"},J={"font-size":"0.875rem",color:"var(--text-secondary)","margin-bottom":"0.5rem"},E={"font-size":"1.75rem","font-weight":"700",color:"var(--text-primary)","margin-bottom":"0.25rem"},F={"font-size":"0.75rem",color:"var(--text-muted)"},z={width:"100%",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)",overflow:"hidden"},B={padding:"1rem","text-align":"left",background:"var(--background-color)","font-weight":"600",color:"var(--text-secondary)","font-size":"0.875rem","border-bottom":"2px solid var(--border-color)"},k={padding:"1rem","border-bottom":"1px solid var(--border-color)"},U={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},he=K=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:K?"var(--primary-color)":"var(--text-muted)","border-bottom":K?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),H={padding:"0.5rem 1rem",background:"var(--primary-color)",color:"white",border:"none","border-radius":"var(--border-radius-sm)",cursor:"pointer","font-size":"0.875rem",transition:"opacity 0.2s"},le={padding:"0.75rem 1.5rem",background:"var(--secondary-color)",color:"white",border:"none","border-radius":"var(--border-radius-sm)",cursor:"pointer","margin-bottom":"1rem",display:"flex","align-items":"center",gap:"0.5rem"},I=()=>[{title:e("invoices.totalRevenue"),value:Z().grandTotal,icon:"💰",color:"#4CAF50",subtext:`${e("common.of")} ${Z().totalInvoices} ${e("common.invoice")} `},{title:e("invoices.totalProducts"),value:Z().totalProducts,icon:"📦",color:"#2196F3",subtext:`${ge(Z().totalProductAmount)} ${e("invoices.value")}`,isNumber:!0},{title:e("invoices.totalReservations"),value:Z().totalReservas,icon:"🎫",color:"#FF9800",subtext:`${ge(Z().totalReservaAmount)} ${e("invoices.value")}`,isNumber:!0},{title:e("invoices.aranceles"),value:Z().totalAranceles,icon:"🏛️",color:"#9C27B0",subtext:e("invoices.customsFees")},{title:e("invoices.uniqueCustomers"),value:Z().uniqueCustomers,icon:"👥",color:"#00BCD4",subtext:e("invoices.activeCustomers"),isNumber:!0},{title:e("invoices.averageInvoice"),value:Z().avgInvoiceValue,icon:"📊",color:"#FF5722",subtext:e("invoices.perInvoiceValue")},{title:e("invoices.completed"),value:Z().completedInvoices,icon:"✅",color:"#4CAF50",subtext:`${Z().pendingInvoices} ${e("invoices.pending")}`,isNumber:!0},{title:e("invoices.storesActive"),value:L().length,icon:"🏪",color:"#795548",subtext:e("invoices.locations"),isNumber:!0}],j=()=>De.getActiveLocations();return Nn(()=>{}),v(Lr,{get title(){return e("invoices.title")},get children(){var K=po();return u(K,w),s(K,v(Ne,{get when(){return _()==="dashboard"},get children(){return[v(Ne,{get when(){return!t.invoices&&Ur.state.loading},get children(){var R=VI(),X=R.firstChild;return R.style.setProperty("text-align","center"),R.style.setProperty("padding","2rem"),X.style.setProperty("font-size","1.25rem"),X.style.setProperty("margin-bottom","1rem"),s(X,()=>e("invoices.loadingInvoices")),R}}),v(Ne,{get when(){return Ur.state.error},get children(){var R=BI();return R.firstChild,R.style.setProperty("padding","1rem"),R.style.setProperty("margin-bottom","1rem"),R.style.setProperty("background","#ffebee"),R.style.setProperty("border","1px solid #ffcdd2"),R.style.setProperty("border-radius","var(--border-radius)"),R.style.setProperty("color","#d32f2f"),s(R,()=>Ur.state.error,null),s(R,v(Le,{variant:"outline",size:"sm",onClick:ce,style:{"margin-left":"1rem"},get children(){return e("invoices.refreshData")}}),null),R}}),(()=>{var R=FI(),X=R.firstChild,O=X.firstChild,N=O.nextSibling,te=N.firstChild,de=X.nextSibling,pe=de.firstChild,se=pe.nextSibling,Y=de.nextSibling,D=Y.firstChild,Q=D.nextSibling;return u(R,S),s(O,()=>e("invoices.storeLocation")),N.addEventListener("change",W=>i(W.currentTarget.value)),s(te,()=>e("invoices.allStores")),s(N,v(pt,{get each(){return j()},children:W=>(()=>{var me=qI();return s(me,()=>W.name),ie(()=>me.value=W.id),me})()}),null),s(pe,()=>e("invoices.fromDate")),se.addEventListener("change",W=>c(W.currentTarget.value)),s(D,()=>e("invoices.toDate")),Q.addEventListener("change",W=>h(W.currentTarget.value)),s(R,v(Le,{variant:"secondary",onClick:()=>{i("all"),c(""),h("")},get children(){return e("invoices.clearFilters")}}),null),s(R,v(Le,{variant:"primary",onClick:ce,get disabled(){return!t.invoices&&Ur.state.loading},get children(){return["🔄 ",ye(()=>e("invoices.refreshData"))]}}),null),ie(W=>{var me=p,fe=C,V=P,re=p,_e=C,Pe=P,ae=p,be=C,oe=P;return W.e=u(X,me,W.e),W.t=u(O,fe,W.t),W.a=u(N,V,W.a),W.o=u(de,re,W.o),W.i=u(pe,_e,W.i),W.n=u(se,Pe,W.n),W.s=u(Y,ae,W.s),W.h=u(D,be,W.h),W.r=u(Q,oe,W.r),W},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),ie(()=>N.value=o()),ie(()=>se.value=a()),ie(()=>Q.value=d()),R})(),(()=>{var R=UI(),X=R.firstChild,O=X.nextSibling;return u(R,U),X.$$click=()=>T("overview"),s(X,()=>e("inventory.overview")),O.$$click=()=>T("invoices"),s(O,()=>e("common.invoices")),ie(N=>{var te=he($()==="overview"),de=he($()==="invoices");return N.e=u(X,te,N.e),N.t=u(O,de,N.t),N},{e:void 0,t:void 0}),R})(),v(Ne,{get when(){return $()==="overview"},get children(){return[(()=>{var R=po();return u(R,x),s(R,v(pt,{get each(){return I()},children:X=>(()=>{var O=GI(),N=O.firstChild,te=N.nextSibling,de=te.nextSibling,pe=de.nextSibling;return u(O,y),s(N,()=>X?.icon),u(te,J),s(te,()=>X?.title),u(de,E),s(de,(()=>{var se=ye(()=>!!X.isNumber);return()=>se()?X.value:ge(X.value)})()),u(pe,F),s(pe,()=>X.subtext),ie(se=>u(N,{...ue,background:`${X?.color}20`,color:X?.color},se)),O})()})),R})(),v(Ne,{get when(){return Z()?.productsByCategory?.size>0},get children(){return v(Ze,{get title(){return e("invoices.topProducts")},get subtitle(){return e("invoices.mostSoldProducts")},get children(){var R=po();return R.style.setProperty("max-height","300px"),R.style.setProperty("overflow-y","auto"),s(R,()=>Array.from(Z().productsByCategory.entries()).sort((X,O)=>O[1]-X[1]).slice(0,10).map(([X,O])=>(()=>{var N=lm(),te=N.firstChild,de=te.nextSibling,pe=de.firstChild;return N.style.setProperty("display","flex"),N.style.setProperty("justify-content","space-between"),N.style.setProperty("padding","0.75rem"),N.style.setProperty("border-bottom","1px solid var(--border-color)"),s(te,X),de.style.setProperty("font-weight","600"),s(de,O,pe),s(de,()=>e("common.units"),null),N})())),R}})}}),(()=>{var R=po();return R.style.setProperty("margin","19px"),R})(),v(Ne,{get when(){return Z()?.reservasByType?.size>0},get children(){return v(Ze,{get title(){return e("invoices.reservationsByType")},get subtitle(){return e("invoices.distributionOfCategories")},style:{"margin-top":"1.5rem"},get children(){var R=po();return R.style.setProperty("max-height","300px"),R.style.setProperty("overflow-y","auto"),s(R,()=>Array.from(Z().reservasByType.entries()).sort((X,O)=>O[1]-X[1]).map(([X,O])=>(()=>{var N=lm(),te=N.firstChild,de=te.nextSibling,pe=de.firstChild;return N.style.setProperty("display","flex"),N.style.setProperty("justify-content","space-between"),N.style.setProperty("padding","0.75rem"),N.style.setProperty("border-bottom","1px solid var(--border-color)"),s(te,X),de.style.setProperty("font-weight","600"),s(de,O,pe),s(de,()=>e("common.lbs"),null),N})())),R}})}}),(()=>{var R=po();return R.style.setProperty("margin","19px"),R})(),v(Ne,{get when(){return Z()?.othersByType?.size>0},get children(){return v(Ze,{title:"Aranceles y otros servicios",get subtitle(){return e("invoices.distributionOfCategories")},style:{"margin-top":"1.5rem"},get children(){var R=po();return R.style.setProperty("max-height","300px"),R.style.setProperty("overflow-y","auto"),s(R,()=>Array.from(Z().othersByType.entries()).sort((X,O)=>O[1]-X[1]).map(([X,O])=>(()=>{var N=HI(),te=N.firstChild,de=te.nextSibling,pe=de.firstChild;return N.style.setProperty("display","flex"),N.style.setProperty("justify-content","space-between"),N.style.setProperty("padding","0.75rem"),N.style.setProperty("border-bottom","1px solid var(--border-color)"),s(te,X),de.style.setProperty("font-weight","600"),s(de,O,pe),N})())),R}})}})]}})]}}),null),s(K,v(Ne,{get when(){return $()==="invoices"},get children(){return[v(Ne,{get when(){return _()!=="detail"},get children(){return v(Ze,{get title(){return e("invoices.recentInvoices")},get subtitle(){return e("invoices.showingInvoices",{count:ee().length})},style:{"margin-top":"1.5rem"},get children(){var R=jI(),X=R.firstChild,O=X.firstChild,N=O.firstChild,te=N.firstChild,de=te.nextSibling,pe=de.nextSibling,se=pe.nextSibling,Y=se.nextSibling,D=Y.nextSibling,Q=D.nextSibling,W=Q.nextSibling,me=W.nextSibling,fe=O.nextSibling;return R.style.setProperty("overflow-x","auto"),u(X,z),s(te,()=>e("invoices.invoiceNumber")),s(de,()=>e("invoices.date")),s(pe,()=>e("invoices.customer")),s(se,()=>e("invoices.store")),s(Y,()=>e("invoices.products")),s(D,()=>e("invoices.reservations")),s(Q,()=>e("invoices.total")),s(W,()=>e("invoices.status")),s(me,()=>e("invoices.actions")),s(fe,v(pt,{get each(){return ee().slice(0,50)},children:V=>{const re=()=>{console.log(V);let _e=0,Pe=0,ae=0,be=0;V?.products?.forEach(oe=>{const Se=Math.abs(oe?.qty),Ee=parseFloat(oe?.salePrice)||1;_e+=Se*Ee}),V?.reservas?.forEach(oe=>{let Se=parseInt(oe?.qty);return isNaN(Se)&&(Se=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[oe.type]||oe?.onlyTariff?(Se=parseFloat(oe.arancel)||parseFloat(oe.qty)*parseFloat(oe.price),be+=Se):(oe?.arancel&&(ae+=parseFloat(oe?.arancel)),Pe+=Se*parseFloat(oe?.price)),{total:_e+Pe+ae+be,totalProductAmount:_e,totalReservaAmount:Pe,totalAranceles:ae,totalOther:be}})};return(()=>{var _e=YI(),Pe=_e.firstChild,ae=Pe.nextSibling,be=ae.nextSibling,oe=be.nextSibling,Se=oe.nextSibling,Ee=Se.nextSibling,xe=Ee.nextSibling,$e=xe.nextSibling,Me=$e.firstChild,We=$e.nextSibling,je=We.firstChild;return s(Pe,()=>V?.invoice),s(ae,()=>ne(V?.createDate)),s(be,()=>V?.shipper_consignee?.name),s(oe,()=>V?.store),s(Se,()=>re()?.totalProductAmount),s(Ee,()=>re()?.totalReservaAmount),s(xe,()=>ge(re()?.total)),Me.style.setProperty("padding","0.25rem 0.75rem"),Me.style.setProperty("border-radius","9999px"),Me.style.setProperty("font-size","0.75rem"),Me.style.setProperty("font-weight","600"),s(Me,(()=>{var Ce=ye(()=>!!V.isCompleted);return()=>Ce()?e("invoices.completed"):e("invoices.pending")})()),je.addEventListener("mouseleave",Ce=>Ce.currentTarget.style.opacity="1"),je.addEventListener("mouseenter",Ce=>Ce.currentTarget.style.opacity="0.8"),je.$$click=()=>{g(V),A("detail")},u(je,H),s(je,()=>e("invoices.view")),ie(Ce=>{var Ve=k,Ke=k,He=k,Qe=k,Ie=k,ot=k,et={...k,"text-align":"right","font-weight":"600"},Ct=k,yt=V.isCompleted?"#d4edda":"#fff3cd",Dt=V.isCompleted?"#155724":"#856404",Tt=k;return Ce.e=u(Pe,Ve,Ce.e),Ce.t=u(ae,Ke,Ce.t),Ce.a=u(be,He,Ce.a),Ce.o=u(oe,Qe,Ce.o),Ce.i=u(Se,Ie,Ce.i),Ce.n=u(Ee,ot,Ce.n),Ce.s=u(xe,et,Ce.s),Ce.h=u($e,Ct,Ce.h),yt!==Ce.r&&((Ce.r=yt)!=null?Me.style.setProperty("background",yt):Me.style.removeProperty("background")),Dt!==Ce.d&&((Ce.d=Dt)!=null?Me.style.setProperty("color",Dt):Me.style.removeProperty("color")),Ce.l=u(We,Tt,Ce.l),Ce},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),_e})()}})),ie(V=>{var re=B,_e=B,Pe=B,ae=B,be=B,oe=B,Se={...B,"text-align":"right"},Ee=B,xe=B;return V.e=u(te,re,V.e),V.t=u(de,_e,V.t),V.a=u(pe,Pe,V.a),V.o=u(se,ae,V.o),V.i=u(Y,be,V.i),V.n=u(D,oe,V.n),V.s=u(Q,Se,V.s),V.h=u(W,Ee,V.h),V.r=u(me,xe,V.r),V},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),R}})}}),v(Ne,{get when(){return ye(()=>_()==="detail")()&&m()},get children(){return[(()=>{var R=zI();return R.firstChild,R.$$click=()=>{A("dashboard"),g(null)},u(R,le),s(R,()=>e("invoices.backToDashboard"),null),R})(),v(MI,{get invoice(){return m()},onPrint:()=>window.print()})]}})]}}),null),K}})};Et(["click"]);const KI=()=>v(WI,{invoices:[{type:"SALES",invoice:"20255FK6S4B43SSS",description:"",store:"YY_8816",ssg_inventory_key:"JqdrRwGBpdBfRCim",ssg_sorder_key:"JqdrRwGBpdBfRCim",createDate:1736132690425,shipper_consignee:{name:"Yudith Perez Medero",phoneNumberS:"5022408378",dob:"1982-07-23",firstName:"RAUL",lastName:"BATISTA",lastName2:"ESPOSITO",middleName:"",email:"",phoneNumber:"52393232",altPhoneNumber:"",cid:"48121007305",ybstreetNo:"9",ybstreet:"10",ybbetwen1:"CARRALERO",ybbetwen2:"3RA",ybapt:"",ybreparto:"PUEBLO NUEVO",consigneeId:"26144",ssg_consignee_key:"26144",passport:"NA",nacionality:"CUB",ybcity:"HOLGUIN",ybestate:"HOLGUIN",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534800",reservas:[{type:"UTILES DEL HOGAR",qty:"15",arancel:"10",price:"5",key:"1GB16SD80"},{type:"MISCELANEAS",qty:"19",arancel:"",price:"4",key:"0DS6K14Y2"}],products:[{product:{id:"CmrhMfVjLR9HxT6P",label:"FOGONES ELECTRICO DOBLE RESISTENCIA DE ALAMBRE",code:"978Y82K94"},qty:-1,price:23.696296296296296,salePrice:"34"},{product:{id:"ov56aPYGbXIq4XGy",label:"Caramelos",code:"C852CSKB5"},qty:-2,price:5.990000000000001,salePrice:"10"}],isCompleted:!0},{type:"SALES",invoice:"20255FK6S4B43TTT",description:"",store:"YY_8803",ssg_inventory_key:"JqdrRwGBpdBfRCin",ssg_sorder_key:"JqdrRwGBpdBfRCin",createDate:1736032690425,shipper_consignee:{name:"Maria Rodriguez Santos",phoneNumberS:"5024567890",dob:"1990-03-15",firstName:"MARIA",lastName:"RODRIGUEZ",lastName2:"SANTOS",middleName:"ELENA",email:"maria@email.com",phoneNumber:"52987654",altPhoneNumber:"",cid:"90031507890",ybstreetNo:"15",ybstreet:"23",ybbetwen1:"MARTI",ybbetwen2:"CESPEDES",ybapt:"2A",ybreparto:"CENTRO",consigneeId:"26145",ssg_consignee_key:"26145",passport:"A1234567",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534801",reservas:[{type:"ELECTRONICOS",qty:"5",arancel:"15",price:"12",key:"2GB16SD81"},{type:"ROPA Y CALZADO",qty:"8",arancel:"8",price:"7",key:"0DS6K14Y3"}],products:[{product:{id:"XmrhMfVjLR9HxT6Q",label:"TELEVISOR LED 32 PULGADAS",code:"TV32LED01"},qty:-1,price:150.5,salePrice:"220"},{product:{id:"Yv56aPYGbXIq4XGz",label:"Zapatos Deportivos Nike",code:"ZAP001"},qty:-1,price:45.99,salePrice:"75"}],isCompleted:!1},{type:"SALES",invoice:"20255FK6S4B43UUU",description:"",store:"YY_8816",ssg_inventory_key:"JqdrRwGBpdBfRCio",ssg_sorder_key:"JqdrRwGBpdBfRCio",createDate:1735932690425,shipper_consignee:{name:"Carlos Mendez Perez",phoneNumberS:"5025678901",dob:"1975-12-08",firstName:"CARLOS",lastName:"MENDEZ",lastName2:"PEREZ",middleName:"ANTONIO",email:"",phoneNumber:"52876543",altPhoneNumber:"",cid:"75120878901",ybstreetNo:"7",ybstreet:"45",ybbetwen1:"LINEA",ybbetwen2:"PASEO",ybapt:"",ybreparto:"VEDADO",consigneeId:"26146",ssg_consignee_key:"26146",passport:"NA",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534802",reservas:[{type:"ALIMENTOS",qty:"25",arancel:"5",price:"3",key:"3GB16SD82"}],products:[{product:{id:"ZmrhMfVjLR9HxT6R",label:"ARROZ ESPECIAL 5LB",code:"ARZ005"},qty:-5,price:2.5,salePrice:"4"},{product:{id:"Av56aPYGbXIq4XG1",label:"ACEITE DE COCINA 1L",code:"ACE001"},qty:-3,price:3.75,salePrice:"6"}],isCompleted:!0},{type:"SALES",invoice:"20255FK6S4B43VVV",description:"",store:"YY_8802",ssg_inventory_key:"JqdrRwGBpdBfRCip",ssg_sorder_key:"JqdrRwGBpdBfRCip",createDate:1735832690425,shipper_consignee:{name:"Ana Lucia Fernandez",phoneNumberS:"5026789012",dob:"1988-06-20",firstName:"ANA",lastName:"FERNANDEZ",lastName2:"LOPEZ",middleName:"LUCIA",email:"ana.lucia@email.com",phoneNumber:"52765432",altPhoneNumber:"52111222",cid:"88062076789",ybstreetNo:"12",ybstreet:"18",ybbetwen1:"CALZADA",ybbetwen2:"SAN LAZARO",ybapt:"3B",ybreparto:"CENTRO HABANA",consigneeId:"26147",ssg_consignee_key:"26147",passport:"B9876543",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:"Entrega en horario de oficina"},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534803",reservas:[{type:"MEDICINA Y SALUD",qty:"10",arancel:"12",price:"8",key:"4GB16SD83"},{type:"UTILES DEL HOGAR",qty:"6",arancel:"6",price:"4",key:"5GB16SD84"}],products:[{product:{id:"BmrhMfVjLR9HxT6S",label:"VITAMINAS MULTIPLES 60 CAP",code:"VIT001"},qty:-2,price:12.5,salePrice:"18"}],isCompleted:!0}]});var QI=q("<div>$124,350"),JI=q("<div>+12% from last month"),XI=q("<div>247"),qo=q("<div>"),ZI=q("<div>18"),ex=q("<div>$89,250"),tx=q("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>");const rx=()=>{const{t}=ct(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},n={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)",margin:"0.5rem 0"},o={"font-size":"0.875rem",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"};return v(Lr,{get title(){return t("dashboard.title")},get children(){return[(()=>{var i=qo();return u(i,e),s(i,v(Ze,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var a=QI();return ie(c=>u(a,n,c)),a})(),(()=>{var a=JI();return ie(c=>u(a,o,c)),a})()]}}),null),s(i,v(Ze,{get title(){return t("dashboard.employeeCount")},get subtitle(){return t("dashboard.current")},get children(){return[(()=>{var a=XI();return ie(c=>u(a,n,c)),a})(),(()=>{var a=qo();return s(a,()=>t("dashboard.newHires")),ie(c=>u(a,o,c)),a})()]}}),null),s(i,v(Ze,{get title(){return t("dashboard.pendingInvoices")},get subtitle(){return t("dashboard.outstanding")},get children(){return[(()=>{var a=ZI();return ie(c=>u(a,n,c)),a})(),(()=>{var a=qo();return s(a,()=>t("dashboard.totalOutstanding")),ie(c=>u(a,o,c)),a})()]}}),null),s(i,v(Ze,{get title(){return t("dashboard.cashBalance")},get subtitle(){return t("accounts.title")},get children(){return[(()=>{var a=ex();return ie(c=>u(a,n,c)),a})(),(()=>{var a=qo();return s(a,()=>t("dashboard.lastUpdatedToday")),ie(c=>u(a,o,c)),a})()]}}),null),i})(),(()=>{var i=qo();return u(i,r),s(i,v(Ze,{get title(){return t("dashboard.quickActions")},get subtitle(){return t("dashboard.commonTasks")},get children(){var a=qo();return a.style.setProperty("display","flex"),a.style.setProperty("flex-direction","column"),a.style.setProperty("gap","1rem"),s(a,v(Le,{variant:"primary",get children(){return t("invoices.createNew")}}),null),s(a,v(Le,{variant:"secondary",get children(){return t("employees.addEmployee")}}),null),s(a,v(Le,{variant:"outline",get children(){return t("dashboard.generateReport")}}),null),a}}),null),s(i,v(Ze,{get title(){return t("dashboard.recentActivity")},get subtitle(){return t("dashboard.latestUpdates")},get children(){var a=tx(),c=a.firstChild,d=c.firstChild,h=d.nextSibling,m=c.nextSibling,g=m.firstChild,_=g.nextSibling,A=m.nextSibling,L=A.firstChild,M=L.nextSibling;return a.style.setProperty("display","flex"),a.style.setProperty("flex-direction","column"),a.style.setProperty("gap","0.75rem"),c.style.setProperty("border-bottom","1px solid var(--border-color)"),c.style.setProperty("padding-bottom","0.5rem"),d.style.setProperty("font-weight","500"),s(d,()=>t("dashboard.invoicePaid")),h.style.setProperty("font-size","0.875rem"),h.style.setProperty("color","var(--text-muted)"),s(h,()=>t("dashboard.hoursAgo")),m.style.setProperty("border-bottom","1px solid var(--border-color)"),m.style.setProperty("padding-bottom","0.5rem"),g.style.setProperty("font-weight","500"),s(g,()=>t("dashboard.newEmployeeOnboarded")),_.style.setProperty("font-size","0.875rem"),_.style.setProperty("color","var(--text-muted)"),s(_,()=>t("dashboard.dayAgo")),L.style.setProperty("font-weight","500"),s(L,()=>t("dashboard.monthlyReportGenerated")),M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","var(--text-muted)"),s(M,()=>t("dashboard.daysAgo")),a}}),null),i})(),v(Ne,{get when(){return Pt.hasPermission("invoiceAccess")},get children(){return v(KI,{})}})]}})},nx=[{id:"1",accountNumber:"1000",name:"Cash and Cash Equivalents",type:"Asset",category:"Current Assets",description:"Cash on hand and in bank accounts",balance:45230.5,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1001",accountNumber:"1001",name:"Petty Cash",type:"Asset",category:"Current Assets",description:"Small amounts of cash for minor expenses",balance:500,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1002",accountNumber:"1002",name:"Bank - Checking Account",type:"Asset",category:"Current Assets",description:"Main operating checking account",balance:32730.5,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1003",accountNumber:"1003",name:"Bank - Savings Account",type:"Asset",category:"Current Assets",description:"Interest-bearing savings account",balance:12e3,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"2",accountNumber:"1100",name:"Accounts Receivable",type:"Asset",category:"Current Assets",description:"Money owed by customers",balance:23450.75,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2001",accountNumber:"1101",name:"Trade Receivables",type:"Asset",category:"Current Assets",description:"Receivables from regular customers",balance:18450.75,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2002",accountNumber:"1102",name:"Employee Advances",type:"Asset",category:"Current Assets",description:"Money advanced to employees",balance:5e3,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"3",accountNumber:"1200",name:"Inventory",type:"Asset",category:"Current Assets",description:"Products held for sale",balance:78920.25,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-13"},{id:"4",accountNumber:"1500",name:"Equipment",type:"Asset",category:"Fixed Assets",description:"Office equipment and machinery",balance:125e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-12"},{id:"5",accountNumber:"2000",name:"Accounts Payable",type:"Liability",category:"Current Liabilities",description:"Money owed to suppliers",balance:15670.3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-11"},{id:"6",accountNumber:"2100",name:"Accrued Expenses",type:"Liability",category:"Current Liabilities",description:"Expenses incurred but not yet paid",balance:8945.6,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-10"},{id:"7",accountNumber:"2500",name:"Long-term Debt",type:"Liability",category:"Long-term Liabilities",description:"Long-term loans and mortgages",balance:85e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-09"},{id:"8",accountNumber:"3000",name:"Owner's Equity",type:"Equity",category:"Owner's Equity",description:"Owner's investment in the business",balance:15e4,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-08"},{id:"9",accountNumber:"3100",name:"Retained Earnings",type:"Equity",category:"Owner's Equity",description:"Accumulated profits retained in business",balance:32450.8,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-07"},{id:"10",accountNumber:"4000",name:"Sales Revenue",type:"Revenue",category:"Operating Revenue",description:"Revenue from product sales",balance:245678.9,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-06"},{id:"11",accountNumber:"4100",name:"Service Revenue",type:"Revenue",category:"Operating Revenue",description:"Revenue from services provided",balance:89432.15,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-05"},{id:"12",accountNumber:"5000",name:"Cost of Goods Sold",type:"Expense",category:"Operating Expenses",description:"Direct costs of producing goods",balance:125678.45,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-04"},{id:"13",accountNumber:"5100",name:"Salaries Expense",type:"Expense",category:"Operating Expenses",description:"Employee salary expenses",balance:98765.32,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-03"},{id:"14",accountNumber:"5200",name:"Rent Expense",type:"Expense",category:"Operating Expenses",description:"Office rent expenses",balance:24e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-02"}],ox=[{id:"1",accountId:"1",date:"2024-01-15",description:"Customer payment received",debitAmount:5e3,creditAmount:0,reference:"INV-2024-001",type:"debit"},{id:"2",accountId:"2",date:"2024-01-15",description:"Customer payment received",debitAmount:0,creditAmount:5e3,reference:"INV-2024-001",type:"credit"},{id:"3",accountId:"5",date:"2024-01-14",description:"Office supplies purchased",debitAmount:0,creditAmount:1250,reference:"PO-2024-001",type:"credit"}],[on,qs]=ve(nx),[Tl,ix]=ve(ox),wt={get accounts(){return on()},get transactions(){return Tl()},fetchAllAccount(t){const e={...t,id:Date.now().toString(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return qs([...on(),e]),e},addAccount(t){const e={...t,id:Date.now().toString(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return qs([...on(),e]),e},updateAccount(t,e){qs(on().map(r=>r.id===t?{...r,...e,lastModified:new Date().toISOString().split("T")[0]}:r))},deleteAccount(t){qs(on().filter(e=>e.id!==t))},getAccountById(t){return on().find(e=>e.id===t)},getAccountsByType(t){return on().filter(e=>e.type===t)},getAccountTransactions(t){return Tl().filter(e=>e.accountId===t)},addTransaction(t){const e={...t,id:Date.now().toString()};ix([...Tl(),e]);const r=this.getAccountById(t.accountId);if(r){const n=t.type==="debit"?t.debitAmount:-t.creditAmount;this.updateAccount(t.accountId,{balance:r.balance+n})}return e},getTotalByType(t){return on().filter(e=>e.type===t&&e.isActive).reduce((e,r)=>e+r.balance,0)},getAccountCategories(t){const e=this.getAccountsByType(t);return[...new Set(e.map(r=>r.category))]},getSubAccounts(t){return on().filter(e=>e.parentAccountId===t)},getParentAccounts(){return on().filter(t=>!t.parentAccountId)},getAccountHierarchy(){return this.getParentAccounts().map(e=>({...e,subAccounts:this.getSubAccounts(e.id)}))},getAccountWithSubAccounts(t){const e=this.getAccountById(t);return e?{...e,subAccounts:this.getSubAccounts(t),parentAccount:e.parentAccountId?this.getAccountById(e.parentAccountId):null}:null},getAccountPath(t){const e=this.getAccountById(t);if(!e)return[];const r=[e];let n=e;for(;n.parentAccountId;){const o=this.getAccountById(n.parentAccountId);if(o)r.unshift(o),n=o;else break}return r},getTotalBalanceWithSubAccounts(t){const e=this.getAccountById(t);if(!e)return 0;const n=this.getSubAccounts(t).reduce((o,i)=>o+this.getTotalBalanceWithSubAccounts(i.id),0);return e.balance+n},canDeleteAccount(t){const e=this.getSubAccounts(t);if(e.length>0)return{canDelete:!1,reason:`Account has ${e.length} sub-account(s). Delete or move sub-accounts first.`};const r=this.getAccountTransactions(t);return r.length>0?{canDelete:!1,reason:`Account has ${r.length} transaction(s). Cannot delete account with transaction history.`}:{canDelete:!0}}};var jn=q("<div>"),$i=q("<div> ");const sx=()=>{const{t}=ct(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},n={"font-size":"0.875rem",color:"var(--text-muted)"},o=M=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(M),i=wt.getTotalByType("Asset"),a=wt.getTotalByType("Liability"),c=wt.getTotalByType("Equity"),d=wt.getTotalByType("Revenue"),h=wt.getTotalByType("Expense"),m=wt.getAccountsByType("Asset").length,g=wt.getAccountsByType("Liability").length,_=wt.getAccountsByType("Equity").length,A=wt.getAccountsByType("Revenue").length,L=wt.getAccountsByType("Expense").length;return(()=>{var M=jn();return u(M,e),s(M,v(Ze,{get title(){return t("dashboard.totalAssets")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var $=jn();return s($,()=>o(i)),ie(T=>u($,r,T)),$})(),(()=>{var $=$i(),T=$.firstChild;return s($,m,T),s($,()=>t("navigation.accounts"),null),ie(ee=>u($,n,ee)),$})()]}}),null),s(M,v(Ze,{get title(){return t("dashboard.totalLiabilities")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var $=jn();return s($,()=>o(a)),ie(T=>u($,r,T)),$})(),(()=>{var $=$i(),T=$.firstChild;return s($,g,T),s($,()=>t("navigation.accounts"),null),ie(ee=>u($,n,ee)),$})()]}}),null),s(M,v(Ze,{get title(){return t("dashboard.totalEquity")},get subtitle(){return t("accounts.categories.ownersEquity")},get children(){return[(()=>{var $=jn();return s($,()=>o(c)),ie(T=>u($,r,T)),$})(),(()=>{var $=$i(),T=$.firstChild;return s($,_,T),s($,()=>t("navigation.accounts"),null),ie(ee=>u($,n,ee)),$})()]}}),null),s(M,v(Ze,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("accounts.categories.operatingRevenue")},get children(){return[(()=>{var $=jn();return s($,()=>o(d)),ie(T=>u($,r,T)),$})(),(()=>{var $=$i(),T=$.firstChild;return s($,A,T),s($,()=>t("navigation.accounts"),null),ie(ee=>u($,n,ee)),$})()]}}),null),s(M,v(Ze,{get title(){return t("dashboard.totalExpenses")},get subtitle(){return t("accounts.categories.operatingExpenses")},get children(){return[(()=>{var $=jn();return s($,()=>o(h)),ie(T=>u($,r,T)),$})(),(()=>{var $=$i(),T=$.firstChild;return s($,L,T),s($,()=>t("navigation.accounts"),null),ie(ee=>u($,n,ee)),$})()]}}),null),s(M,v(Ze,{get title(){return t("dashboard.netIncome")},get subtitle(){return`${t("dashboard.totalRevenue")} - ${t("dashboard.totalExpenses")}`},get children(){return[(()=>{var $=jn();return s($,()=>o(d-h)),ie(T=>u($,{...r,color:d-h>=0?"#4caf50":"#f44336"},T)),$})(),(()=>{var $=jn();return s($,()=>d-h>=0?t("dashboard.netIncome"):t("dashboard.netLoss")),ie(T=>u($,n,T)),$})()]}}),null),M})()};var ax=q("<div><div></div><div>"),lx=q("<h3>"),ki=q("<div>");const cx=t=>{const{t:e}=ct();kc();const r={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},o={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"},i={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},a={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},c={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem"},d={"font-size":"0.875rem",color:"var(--text-secondary)","line-height":"1.4"},h=_=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[_]||{bg:"#f5f5f5",color:"#666"},m=_=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(_),g=h(t.account.type);return v(Ze,{get children(){return[(()=>{var _=ax(),A=_.firstChild,L=A.nextSibling;return u(_,n),u(A,o),s(A,()=>t.account.accountNumber),s(L,()=>e(`accounts.types.${t.account.type.toLowerCase()}`)),ie(M=>u(L,{...i,background:g.bg,color:g.color},M)),_})(),(()=>{var _=lx();return _.style.setProperty("margin","0 0 0.5rem 0"),_.style.setProperty("font-size","1.1rem"),s(_,()=>t.account.name),_})(),(()=>{var _=ki();return u(_,c),s(_,()=>t.account.category),_})(),(()=>{var _=ki();return u(_,a),s(_,()=>m(t.account.balance)),_})(),(()=>{var _=ki();return u(_,d),s(_,()=>t.account.description),_})(),ye(()=>ye(()=>!t.account.isActive)()&&(()=>{var _=ki();return _.style.setProperty("margin-top","0.5rem"),_.style.setProperty("padding","0.25rem 0.75rem"),_.style.setProperty("border-radius","9999px"),_.style.setProperty("font-size","0.75rem"),_.style.setProperty("font-weight","500"),_.style.setProperty("background","#ffebee"),_.style.setProperty("color","#d32f2f"),_.style.setProperty("text-align","center"),s(_,()=>e("common.inactive")),_})()),(()=>{var _=ki();return u(_,r),s(_,v(Le,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.account),get children(){return[ye(()=>e("common.view"))," ",ye(()=>e("accounts.accountDetails"))]}})),_})()]}})};var ux=q("<div><div><div><div></div><h3></h3></div></div><div><div></div><div>"),dx=q("<div>"),hx=q("<button>"),mx=q("<div><h4> (<!>)"),fx=q("<div><div><div></div><div> • </div></div><div>");const yx=t=>{const{t:e}=ct(),r=kc(),[n,o]=ve(!0),i={"margin-bottom":"1rem"},a={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},c={display:"flex","align-items":"center",gap:"1rem"},d={background:"none",border:"none",cursor:"pointer","font-size":"1.2rem",color:"var(--text-muted)",padding:"0.25rem","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease"},h={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},m={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},g={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},_={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},A={"margin-left":"1rem","border-left":"2px solid var(--border-color)","padding-left":"1rem","margin-top":"1rem"},L={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem","margin-bottom":"0.5rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},M={flex:"1"},$={"font-weight":"500","margin-bottom":"0.25rem"},T={"font-size":"0.875rem",color:"var(--text-muted)"},ee={"font-weight":"600",color:"var(--primary-color)"},ce={display:"flex",gap:"0.5rem"},Z=C=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[C]||{bg:"#f5f5f5",color:"#666"},ge=C=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(C),ne=C=>{t.onViewDetails?t.onViewDetails(C):r(`/accounts/${C.id}`)},w=()=>{t.onAddSubAccount&&t.onAddSubAccount(t.account)},S=t.account.balance+t.account.subAccounts.reduce((C,P)=>C+P.balance,0),p=Z(t.account.type);return v(Ze,{className:"account-hierarchy-card",style:i,get children(){return[(()=>{var C=ux(),P=C.firstChild,x=P.firstChild,y=x.firstChild,ue=y.nextSibling,J=P.nextSibling,E=J.firstChild,F=E.nextSibling;return u(C,a),u(P,c),s(P,(()=>{var z=ye(()=>t.account.subAccounts.length>0);return()=>z()&&(()=>{var B=hx();return B.addEventListener("mouseleave",k=>k.target.style.background="none"),B.addEventListener("mouseenter",k=>k.target.style.background="var(--background-color)"),B.$$click=()=>o(!n()),u(B,d),s(B,()=>n()?"▼":"▶"),B})()})(),x),x.$$click=()=>ne(t.account),x.style.setProperty("cursor","pointer"),u(y,h),s(y,()=>t.account.accountNumber),u(ue,m),s(ue,()=>t.account.name),J.style.setProperty("text-align","right"),u(E,g),s(E,()=>ge(S)),s(F,()=>e(`accounts.types.${t.account.type.toLowerCase()}`)),ie(z=>u(F,{..._,background:p.bg,color:p.color},z)),C})(),(()=>{var C=dx();return u(C,ce),s(C,v(Le,{variant:"secondary",size:"sm",onClick:()=>ne(t.account),get children(){return[ye(()=>e("common.view"))," ",ye(()=>e("accounts.accountDetails"))]}}),null),s(C,v(Le,{variant:"outline",size:"sm",onClick:w,get children(){return[ye(()=>e("common.add"))," ",ye(()=>e("accounts.subAccounts"))]}}),null),C})(),ye(()=>ye(()=>!!(n()&&t.account.subAccounts.length>0))()&&(()=>{var C=mx(),P=C.firstChild,x=P.firstChild,y=x.nextSibling;return y.nextSibling,u(C,A),P.style.setProperty("margin","0 0 1rem 0"),P.style.setProperty("font-size","1rem"),P.style.setProperty("color","var(--text-muted)"),s(P,()=>e("accounts.subAccounts"),x),s(P,()=>t.account.subAccounts.length,y),s(C,()=>t.account.subAccounts.map(ue=>(()=>{var J=fx(),E=J.firstChild,F=E.firstChild,z=F.nextSibling,B=z.firstChild,k=E.nextSibling;return J.addEventListener("mouseleave",U=>{U.currentTarget.style.background="var(--background-color)",U.currentTarget.style.transform="translateY(0)"}),J.addEventListener("mouseenter",U=>{U.currentTarget.style.background="var(--surface-color)",U.currentTarget.style.transform="translateY(-1px)"}),J.$$click=()=>ne(ue),u(J,L),u(E,M),u(F,$),s(F,()=>ue.name),u(z,T),s(z,()=>ue.accountNumber,B),s(z,()=>ue.description,null),u(k,ee),s(k,()=>ge(ue.balance)),J})()),null),C})())]}})};Et(["click"]);var gx=q("<form><div>");const px=t=>{const{t:e}=ct(),[r,n]=ve({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),o=[{value:"Asset",label:e("accounts.types.asset"),type:"debit",classification:"real"},{value:"Liability",label:e("accounts.types.liability"),type:"credit",classification:"real"},{value:"Equity",label:e("accounts.types.equity"),type:"credit",classification:"real"},{value:"Revenue",label:e("accounts.types.revenue"),type:"credit",classification:"nominal"},{value:"Expense",label:e("accounts.types.expense"),type:"debit",classification:"nominal"}],i=()=>{const m=r().type;return m?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")},{value:"Sales Revenue",label:e("accounts.categories.salesRevenue")},{value:"Service Revenue",label:e("accounts.categories.servicesRevenue")},{value:"Subscription Revenue",label:e("accounts.categories.subscriptionRevenue")},{value:"Rental Revenue",label:e("accounts.categories.rentalRevenue")},{value:"Commission Revenue",label:e("accounts.categories.commissionRevenue")},{value:"Franchise Revenue",label:e("accounts.categories.franchiseRevenue")},{value:"Licensing Revenue",label:e("accounts.categories.licensingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[m]||[]:[]},a=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],c={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},d=m=>{m.preventDefault();const g=r();if(!g.accountNumber||!g.name||!g.type||!g.category){alert(e("forms.requiredField"));return}if(wt.accounts.find(L=>L.accountNumber===g.accountNumber)){alert(e("forms.duplicateAccountNumber"));return}const A={accountNumber:g.accountNumber,name:g.name,type:g.type,category:g.category,description:g.description,balance:parseFloat(g.balance)||0,isActive:g.isActive==="true"};wt.addAccount(A),n({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},h=(m,g)=>{n(_=>{const A={..._,[m]:g};return m==="type"&&(A.category=""),A})};return v(br,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.addAccount")},get children(){var m=gx(),g=m.firstChild;return m.addEventListener("submit",d),s(m,v(Mt,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:_=>h("accountNumber",_),get placeholder(){return e("accounts.accountNumber")},required:!0}),g),s(m,v(Mt,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:_=>h("name",_),get placeholder(){return e("accounts.accountName")},required:!0}),g),s(m,v(gr,{get label(){return e("accounts.accountType")},get value(){return r().type},onChange:_=>h("type",_),options:o,required:!0}),g),s(m,v(gr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:_=>h("category",_),get options(){return i()},required:!0}),g),s(m,v(Mt,{get label(){return e("common.description")},get value(){return r().description},onChange:_=>h("description",_),get placeholder(){return e("common.description")}}),g),s(m,v(Mt,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:_=>h("balance",_),get placeholder(){return e("accounts.balance")}}),g),s(m,v(gr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:_=>h("isActive",_),options:a,required:!0}),g),u(g,c),s(g,v(Le,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(g,v(Le,{variant:"primary",type:"submit",get children(){return e("accounts.addAccount")}}),null),m}})};var vx=q("<form><div>"),bx=q("<div><div></div><div> - </div><div> • ");const _x=t=>{const{t:e}=ct(),[r,n]=ve({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),o=()=>t.parentAccount?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[t.parentAccount.type]||[]:[],i=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],a={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},c={background:"var(--background-color)",padding:"1rem","border-radius":"var(--border-radius-sm)","margin-bottom":"1.5rem",border:"1px solid var(--border-color)"},d={"font-size":"0.875rem","font-weight":"500",color:"var(--text-muted)","margin-bottom":"0.5rem"},h={"font-weight":"600",color:"var(--text-primary)"},m={"font-size":"0.875rem",color:"var(--text-secondary)"},g=M=>{M.preventDefault();const $=r();if(!$.accountNumber||!$.name||!$.category||!t.parentAccount){alert(e("forms.requiredField"));return}if(wt.accounts.find(ce=>ce.accountNumber===$.accountNumber)){alert(e("forms.duplicateAccountNumber"));return}const ee={accountNumber:$.accountNumber,name:$.name,type:t.parentAccount.type,category:$.category,description:$.description,balance:parseFloat($.balance)||0,isActive:$.isActive==="true",parentAccountId:t.parentAccount.id};wt.addAccount(ee),n({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},_=(M,$)=>{n(T=>({...T,[M]:$}))},A=()=>{if(!t.parentAccount)return"";const M=t.parentAccount.accountNumber,T=wt.getSubAccounts(t.parentAccount.id).length+1;return(parseInt(M)+T).toString()},L=()=>r().accountNumber===""&&t.parentAccount?A():r().accountNumber;return v(br,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return`${e("common.add")} ${e("accounts.subAccounts")}`},get children(){return[ye(()=>ye(()=>!!t.parentAccount)()&&(()=>{var M=bx(),$=M.firstChild,T=$.nextSibling,ee=T.firstChild,ce=T.nextSibling,Z=ce.firstChild;return u(M,c),u($,d),s($,()=>e("accounts.parentAccount")),u(T,h),s(T,()=>t.parentAccount.accountNumber,ee),s(T,()=>t.parentAccount.name,null),u(ce,m),s(ce,()=>e(`accounts.types.${t.parentAccount.type.toLowerCase()}`),Z),s(ce,()=>t.parentAccount.category,null),M})()),(()=>{var M=vx(),$=M.firstChild;return M.addEventListener("submit",g),s(M,v(Mt,{get label(){return e("accounts.accountNumber")},get value(){return L()},onChange:T=>_("accountNumber",T),get placeholder(){return`${e("common.suggested")}: ${A()}`},required:!0}),$),s(M,v(Mt,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:T=>_("name",T),get placeholder(){return e("accounts.accountName")},required:!0}),$),s(M,v(gr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:T=>_("category",T),get options(){return o()},required:!0}),$),s(M,v(Mt,{get label(){return e("common.description")},get value(){return r().description},onChange:T=>_("description",T),get placeholder(){return e("common.description")}}),$),s(M,v(Mt,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:T=>_("balance",T),get placeholder(){return e("accounts.balance")}}),$),s(M,v(gr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:T=>_("isActive",T),options:i,required:!0}),$),u($,a),s($,v(Le,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s($,v(Le,{variant:"primary",type:"submit",get children(){return[ye(()=>e("common.add"))," ",ye(()=>e("accounts.subAccounts"))]}}),null),M})()]}})};var Sx=q("<form><div>"),Px=q("<div>");const wx=t=>{const{t:e}=ct(),[r,n]=ve({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),[o,i]=ve(null);Nn(()=>{t.account&&(n({accountNumber:t.account.accountNumber,name:t.account.name,type:t.account.type,category:t.account.category,description:t.account.description,balance:t.account.balance.toString(),isActive:t.account.isActive.toString()}),i(null))});const a=[{value:"Asset",label:e("accounts.types.asset")},{value:"Liability",label:e("accounts.types.liability")},{value:"Equity",label:e("accounts.types.equity")},{value:"Revenue",label:e("accounts.types.revenue")},{value:"Expense",label:e("accounts.types.expense")}],c=()=>{const A=r().type;return A?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[A]||[]:[]},d=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],h={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},m=A=>{if(A.preventDefault(),i(null),!t.account)return;const L=r();if(!L.accountNumber||!L.name||!L.type||!L.category){i(e("forms.requiredField"));return}if(wt.accounts.find(T=>T.accountNumber===L.accountNumber&&T.id!==t.account.id)){i(e("forms.duplicateAccountNumber"));return}const $={accountNumber:L.accountNumber,name:L.name,type:L.type,category:L.category,description:L.description,balance:parseFloat(L.balance)||0,isActive:L.isActive==="true"};try{wt.updateAccount(t.account.id,$),t.onClose()}catch(T){i(T instanceof Error?T.message:e("forms.saveError"))}},g=()=>{if(!t.account)return;const A=wt.canDeleteAccount(t.account.id);if(!A.canDelete){i(A.reason||e("forms.deleteError"));return}const L=e("forms.confirmDelete");if(confirm(L))try{wt.deleteAccount(t.account.id),t.onClose()}catch(M){i(M instanceof Error?M.message:e("forms.deleteError"))}},_=(A,L)=>{n(M=>{const $={...M,[A]:L};return A==="type"&&($.category=""),$}),o()&&i(null)};return t.account?v(br,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.editAccount")},get children(){var A=Sx(),L=A.firstChild;return A.addEventListener("submit",m),s(A,v(Mt,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:M=>_("accountNumber",M),get placeholder(){return e("accounts.accountNumber")},required:!0}),L),s(A,v(Mt,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:M=>_("name",M),get placeholder(){return e("accounts.accountName")},required:!0}),L),s(A,v(gr,{get label(){return e("accounts.accountType")},get value(){return r().type},onChange:M=>_("type",M),options:a,required:!0}),L),s(A,v(gr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:M=>_("category",M),get options(){return c()},required:!0}),L),s(A,v(Mt,{get label(){return e("common.description")},get value(){return r().description},onChange:M=>_("description",M),get placeholder(){return e("common.description")}}),L),s(A,v(Mt,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:M=>_("balance",M),get placeholder(){return e("accounts.balance")}}),L),s(A,v(gr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:M=>_("isActive",M),options:d,required:!0}),L),s(A,(()=>{var M=ye(()=>!!o());return()=>M()&&(()=>{var $=Px();return $.style.setProperty("padding","1rem"),$.style.setProperty("border-radius","var(--border-radius-sm)"),$.style.setProperty("margin-top","1rem"),$.style.setProperty("background","#f8d7da"),$.style.setProperty("color","#721c24"),$.style.setProperty("border","1px solid #f5c6cb"),s($,o),$})()})(),L),u(L,h),s(L,v(Le,{variant:"outline",type:"button",onClick:g,style:{color:"#dc3545","border-color":"#dc3545","margin-right":"auto"},get children(){return e("accounts.deleteAccount")}}),null),s(L,v(Le,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(L,v(Le,{variant:"primary",type:"submit",get children(){return e("common.save")}}),null),A}}):null};var Cx=q("<div><div>⚠️</div><div></div><div></div><div>"),Ax=q("<div><div></div><div></div><div>"),Ix=q("<div><button></button><button> (<!>)"),$l=q("<div>"),xx=q("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),Ex=q("<div><div><div></div><div> • </div></div><div>");const Tx=t=>{const{t:e}=ct(),[r,n]=ve("details"),[o,i]=ve(!1),a=Ge(()=>t.account?wt.getAccountById(t.account.id)||t.account:null),c={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},d={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},h={"font-weight":"600",color:"var(--text-primary)"},m={"text-align":"center","margin-bottom":"2rem"},g={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},_={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},A={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem"},L={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},M=p=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:p?"var(--primary-color)":"var(--text-muted)","border-bottom":p?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),$={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},T={flex:"1"},ee={"font-size":"0.875rem",color:"var(--text-muted)"},ce={"font-weight":"500","margin-bottom":"0.25rem"},Z=p=>({"font-weight":"600",color:p==="debit"?"#4caf50":"#f44336"}),ge={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},ne=p=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[p]||{bg:"#f5f5f5",color:"#666"},w=p=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(p),S=p=>new Date(p).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return v(br,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.accountDetails")},get children(){return[ye(()=>ye(()=>!a())()?(()=>{var p=Cx(),C=p.firstChild,P=C.nextSibling,x=P.nextSibling,y=x.nextSibling;return p.style.setProperty("text-align","center"),p.style.setProperty("padding","3rem"),p.style.setProperty("color","var(--text-muted)"),C.style.setProperty("font-size","1.5rem"),C.style.setProperty("margin-bottom","1rem"),P.style.setProperty("font-size","1.1rem"),P.style.setProperty("margin-bottom","0.5rem"),s(P,()=>e("common.error")),x.style.setProperty("font-size","0.875rem"),s(x,()=>e("common.noDataFound")),y.style.setProperty("margin-top","2rem"),s(y,v(Le,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),p})():(()=>{const p=Ge(()=>ne(a().type)),C=Ge(()=>wt.getAccountTransactions(a().id));return[(()=>{var P=Ax(),x=P.firstChild,y=x.nextSibling,ue=y.nextSibling;return u(P,m),u(x,g),s(x,()=>a().name),u(y,_),s(y,()=>w(a().balance)),s(ue,()=>e(`accounts.types.${a().type.toLowerCase()}`)),ie(J=>u(ue,{...A,background:p().bg,color:p().color},J)),P})(),(()=>{var P=Ix(),x=P.firstChild,y=x.nextSibling,ue=y.firstChild,J=ue.nextSibling;return J.nextSibling,u(P,L),x.$$click=()=>n("details"),s(x,()=>e("accounts.accountDetails")),y.$$click=()=>n("transactions"),s(y,()=>e("accounts.transactions"),ue),s(y,()=>C().length,J),ie(E=>{var F=M(r()==="details"),z=M(r()==="transactions");return E.e=u(x,F,E.e),E.t=u(y,z,E.t),E},{e:void 0,t:void 0}),P})(),ye(()=>ye(()=>r()==="details")()&&(()=>{var P=xx(),x=P.firstChild,y=x.firstChild,ue=y.nextSibling,J=x.nextSibling,E=J.firstChild,F=E.nextSibling,z=J.nextSibling,B=z.firstChild,k=B.nextSibling,U=z.nextSibling,he=U.firstChild,H=he.nextSibling,le=U.nextSibling,I=le.firstChild,j=I.nextSibling,K=le.nextSibling,R=K.firstChild,X=R.nextSibling;return s(y,()=>e("accounts.accountNumber")),s(ue,()=>a().accountNumber),s(E,()=>e("accounts.category")),s(F,()=>a().category),s(B,()=>e("common.description")),s(k,()=>a().description),s(he,()=>e("common.status")),s(H,(()=>{var O=ye(()=>!!a().isActive);return()=>O()?e("common.active"):e("common.inactive")})()),s(I,()=>e("accounts.createdDate")),s(j,()=>S(a().createdDate)),s(R,()=>e("accounts.lastModified")),s(X,()=>S(a().lastModified)),ie(O=>{var N=c,te=d,de=h,pe=c,se=d,Y=h,D=c,Q=d,W=h,me=c,fe=d,V=h,re=c,_e=d,Pe=h,ae=c,be=d,oe=h;return O.e=u(x,N,O.e),O.t=u(y,te,O.t),O.a=u(ue,de,O.a),O.o=u(J,pe,O.o),O.i=u(E,se,O.i),O.n=u(F,Y,O.n),O.s=u(z,D,O.s),O.h=u(B,Q,O.h),O.r=u(k,W,O.r),O.d=u(U,me,O.d),O.l=u(he,fe,O.l),O.u=u(H,V,O.u),O.c=u(le,re,O.c),O.w=u(I,_e,O.w),O.m=u(j,Pe,O.m),O.f=u(K,ae,O.f),O.y=u(R,be,O.y),O.g=u(X,oe,O.g),O},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),P})()),ye(()=>ye(()=>r()==="transactions")()&&(()=>{var P=$l();return s(P,(()=>{var x=ye(()=>C().length===0);return()=>x()?(()=>{var y=$l();return y.style.setProperty("text-align","center"),y.style.setProperty("color","var(--text-muted)"),y.style.setProperty("padding","2rem"),s(y,()=>e("common.noDataFound")),y})():C().map(y=>(()=>{var ue=Ex(),J=ue.firstChild,E=J.firstChild,F=E.nextSibling,z=F.firstChild,B=J.nextSibling;return u(ue,$),u(J,T),u(E,ce),s(E,()=>y.description),u(F,ee),s(F,()=>S(y.date),z),s(F,()=>y.reference,null),s(B,()=>y.type==="debit"?"+":"-",null),s(B,()=>w(y.type==="debit"?y.debitAmount:y.creditAmount),null),ie(k=>u(B,Z(y.type),k)),ue})())})()),P})()),(()=>{var P=$l();return u(P,ge),s(P,v(Le,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(P,v(Le,{variant:"primary",onClick:()=>i(!0),get children(){return e("accounts.editAccount")}}),null),P})()]})()),ye(()=>ye(()=>!!a())()&&v(wx,{get isOpen(){return o()},onClose:()=>{i(!1)},get account(){return a()}}))]}})};Et(["click"]);const $x="https://qvamarkets.com/gql_api",[kx,cm]=ve(!1),[Rx,kl]=ve(null);class Dx{baseUrl;constructor(e=$x){this.baseUrl=e}async request(e,r,n,o){cm(!0),kl(null);try{const i=r.startsWith("http")?r:`${this.baseUrl}${r}`,a={method:e,headers:{"Content-Type":"application/json",Accept:"application/json",...o}};n&&(e==="POST"||e==="PUT"||e==="PATCH")&&(a.body=JSON.stringify(n));const c=await fetch(i,a);if(!c.ok)throw new Error(`HTTP error! status: ${c.status}`);const d=await c.json();if(d.errors&&d.errors.length>0)throw new Error(d.errors[0].message);return d.data||d}catch(i){const a=i instanceof Error?i.message:"Unknown error occurred";throw kl(a),i}finally{cm(!1)}}async graphql(e){return this.request("POST","",e)}async get(e,r){return this.request("GET",e,void 0,r)}async post(e,r,n){return this.request("POST",e,r,n)}async put(e,r,n){return this.request("PUT",e,r,n)}async patch(e,r,n){return this.request("PATCH",e,r,n)}async delete(e,r){return this.request("DELETE",e,void 0,r)}getLoadingState(){return kx()}getErrorState(){return Rx()}clearError(){kl(null)}}const Gs=new Dx,ku=`
  fragment AccountFields on Account {
    id
    accountNumber
    name
    type
    category
    description
    balance
    isActive
    parentAccountId
    createdDate
    lastModified
  }
`,Nx=`
  query GetAccountById($id: ID!) {
    account(id: $id) {
      ...AccountFields
    }
  }
  ${ku}
`,Lx=`
  mutation CreateAccount($input: CreateAccountInput!) {
    createAccount(input: $input) {
      ...AccountFields
    }
  }
  ${ku}
`,Mx=`
  mutation UpdateAccount($id: ID!, $input: UpdateAccountInput!) {
    updateAccount(id: $id, input: $input) {
      ...AccountFields
    }
  }
  ${ku}
`,Ox=`
  mutation DeleteAccount($id: ID!) {
    deleteAccount(id: $id) {
      success
      message
    }
  }
`;class Vx{async getAccounts(e,r){try{if(Zi.isFakeMode())return await ud.getAll(e);const n=await wn({query:"getAllYabaProducts",params:{businessId:"YB100423253156428"}});return console.log("Real API accounts response:",n),n?.accounts||[]}catch(n){if(console.error("Error fetching accounts:",n),Zi.isHybridMode())return console.warn("Falling back to fake API for accounts"),await ud.getAll(e);throw n}}async getAccountById(e){try{return(await Gs.graphql({query:Nx,variables:{id:e}})).account}catch(r){throw console.error("Error fetching account:",r),r}}async createAccount(e){try{return(await Gs.graphql({query:Lx,variables:{input:e}})).createAccount}catch(r){throw console.error("Error creating account:",r),r}}async updateAccount(e,r){try{return(await Gs.graphql({query:Mx,variables:{id:e,input:r}})).updateAccount}catch(n){throw console.error("Error updating account:",n),n}}async deleteAccount(e){try{return(await Gs.graphql({query:Ox,variables:{id:e}})).deleteAccount}catch(r){throw console.error("Error deleting account:",r),r}}async getAccountsByType(e){return this.getAccounts({type:e})}async getAccountHierarchy(){const e=await this.getAccounts();return this.buildHierarchy(e)}buildHierarchy(e){const r=new Map,n=[];return e.forEach(o=>{r.set(o.id,{...o,subAccounts:[]})}),e.forEach(o=>{const i=r.get(o.id);if(o.parentAccountId){const a=r.get(o.parentAccountId);a&&(a.subAccounts=a.subAccounts||[],a.subAccounts.push(i))}else n.push(i)}),n}async getAccountBalance(e){const r=await this.getAccountById(e);return r?r.balance:0}async searchAccounts(e){return this.getAccounts({search:e})}}const Bx=new Vx;var Fx=q("<div><h2></h2><div><span>:</span><button></button><button>"),Ux=q("<div><span>:"),um=q("<div>"),jx=q("<button>");const zx=()=>{const{t}=ct(),[e,r]=ve(!1),[n,o]=ve(!1),[i,a]=ve(!1),[c,d]=ve(null),[h,m]=ve(null),[g,_]=ve("All"),[A,L]=ve("hierarchy"),M=S=>{d(S),a(!0)},$=S=>{m(S),o(!0)},T=()=>g()==="All"?A()==="hierarchy"?wt.getAccountHierarchy():wt.accounts:A()==="hierarchy"?wt.getAccountHierarchy().filter(S=>S.type===g()):wt.getAccountsByType(g()),ee={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(350px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},ce={display:"flex",gap:"1rem","margin-bottom":"2rem","align-items":"center"},Z=S=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:S?"var(--primary-color)":"var(--surface-color)",color:S?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500",transition:"all 0.2s ease"}),ge={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},ne={display:"flex",gap:"0.5rem","align-items":"center","margin-left":"auto","margin-right":"1rem"},w=S=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:S?"var(--primary-color)":"var(--surface-color)",color:S?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"});return v(Lr,{get title(){return t("accounts.title")},get children(){return[v(sx,{}),(()=>{var S=Fx(),p=S.firstChild,C=p.nextSibling,P=C.firstChild,x=P.firstChild,y=P.nextSibling,ue=y.nextSibling;return u(S,ge),p.style.setProperty("margin","0"),p.style.setProperty("font-size","1.5rem"),s(p,()=>t("accounts.title")),u(C,ne),P.style.setProperty("font-weight","500"),P.style.setProperty("color","var(--text-muted)"),P.style.setProperty("font-size","0.875rem"),s(P,()=>t("common.view"),x),y.$$click=()=>L("hierarchy"),s(y,()=>t("accounts.accountHierarchy")),ue.$$click=()=>{L("flat"),Bx.getAccounts()},s(ue,()=>t("common.all")),s(S,v(Le,{variant:"primary",onClick:()=>r(!0),get children(){return t("accounts.addAccount")}}),null),ie(J=>{var E=w(A()==="hierarchy"),F=w(A()==="flat");return J.e=u(y,E,J.e),J.t=u(ue,F,J.t),J},{e:void 0,t:void 0}),S})(),(()=>{var S=Ux(),p=S.firstChild,C=p.firstChild;return u(S,ce),p.style.setProperty("font-weight","500"),p.style.setProperty("color","var(--text-muted)"),s(p,()=>t("common.filter"),C),s(S,()=>[t("common.all"),t("accounts.types.asset"),t("accounts.types.liability"),t("accounts.types.equity"),t("accounts.types.revenue"),t("accounts.types.expense")].map((P,x)=>{const ue=["All","Asset","Liability","Equity","Revenue","Expense"][x];return(()=>{var J=jx();return J.$$click=()=>_(ue),s(J,P),ie(E=>u(J,Z(g()===ue),E)),J})()}),null),S})(),(()=>{var S=um();return s(S,(()=>{var p=ye(()=>A()==="hierarchy");return()=>p()?T().map(C=>v(yx,{account:C,onAddSubAccount:$,onViewDetails:M})):T().map(C=>v(cx,{account:C,onViewDetails:M}))})()),ie(p=>u(S,A()==="hierarchy"?{display:"flex","flex-direction":"column",gap:"1rem"}:ee,p)),S})(),ye(()=>ye(()=>T().length===0)()&&(()=>{var S=um();return S.style.setProperty("text-align","center"),S.style.setProperty("color","var(--text-muted)"),S.style.setProperty("padding","3rem"),S.style.setProperty("font-size","1.1rem"),s(S,()=>t("common.noDataFound")),S})()),v(px,{get isOpen(){return e()},onClose:()=>r(!1)}),v(_x,{get isOpen(){return n()},onClose:()=>o(!1),get parentAccount(){return h()}}),v(Tx,{get isOpen(){return i()},onClose:()=>a(!1),get account(){return c()}})]}})};Et(["click"]);var qx=q("<div><h2>"),Go=q("<div>"),Gx=q("<div><div><div></div><h1></h1><div></div></div><div>"),Hx=q("<div><button></button><button> (<!>)"),Hs=q("<div><span></span><span>"),Yx=q("<p>"),Wx=q("<div><div></div><div>"),Kx=q("<div><div><div></div><div> • </div></div><div>");const Qx=()=>{const{t}=ct(),e=Dp(),r=kc(),[n,o]=ve(null),[i,a]=ve("overview");Hr(()=>{const y=wt.getAccountById(e.id);y?o(y):r("/accounts")});const c={display:"flex","align-items":"center",gap:"0.5rem","margin-bottom":"1rem"},d={display:"flex","align-items":"center",gap:"1rem","margin-bottom":"2rem"},h={"font-size":"1rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},m={"font-size":"2.5rem","font-weight":"700",color:"var(--primary-color)"},g={padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},_={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},A=y=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:y?"var(--primary-color)":"var(--text-muted)","border-bottom":y?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),L={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},M={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},$={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},T={"font-weight":"500",color:"var(--text-muted)"},ee={"font-weight":"600",color:"var(--text-primary)"},ce={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},Z={flex:"1"},ge={"font-weight":"500","margin-bottom":"0.25rem"},ne={"font-size":"0.875rem",color:"var(--text-muted)"},w=y=>({"font-weight":"600",color:y==="debit"?"#4caf50":"#f44336"});if(!n())return v(Lr,{get title(){return t("accounts.accountDetails")},get children(){var y=qx(),ue=y.firstChild;return y.style.setProperty("text-align","center"),y.style.setProperty("padding","3rem"),s(ue,()=>t("common.error")),s(y,v(Le,{variant:"primary",onClick:()=>r("/accounts"),get children(){return[ye(()=>t("common.back"))," ",ye(()=>t("navigation.accounts"))]}}),null),y}});const S=y=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[y]||{bg:"#f5f5f5",color:"#666"},p=y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(y),C=y=>new Date(y).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),P=S(n().type),x=wt.getAccountTransactions(n().id);return v(Lr,{get title(){return n().name},get children(){return[(()=>{var y=Go();return u(y,c),s(y,v(Le,{variant:"secondary",onClick:()=>r("/accounts"),get children(){return["← ",ye(()=>t("common.back"))," ",ye(()=>t("navigation.accounts"))]}})),y})(),(()=>{var y=Gx(),ue=y.firstChild,J=ue.firstChild,E=J.nextSibling,F=E.nextSibling,z=ue.nextSibling;return u(y,d),u(J,h),s(J,()=>n().accountNumber),E.style.setProperty("margin","0.5rem 0"),E.style.setProperty("font-size","2rem"),s(E,()=>n().name),u(F,m),s(F,()=>p(n().balance)),s(z,()=>n().type),ie(B=>u(z,{...g,background:P.bg,color:P.color},B)),y})(),(()=>{var y=Hx(),ue=y.firstChild,J=ue.nextSibling,E=J.firstChild,F=E.nextSibling;return F.nextSibling,u(y,_),ue.$$click=()=>a("overview"),s(ue,()=>t("dashboard.overview")),J.$$click=()=>a("transactions"),s(J,()=>t("accounts.transactions"),E),s(J,()=>x.length,F),ie(z=>{var B=A(i()==="overview"),k=A(i()==="transactions");return z.e=u(ue,B,z.e),z.t=u(J,k,z.t),z},{e:void 0,t:void 0}),y})(),ye(()=>ye(()=>i()==="overview")()&&(()=>{var y=Wx(),ue=y.firstChild,J=ue.nextSibling;return u(ue,L),s(ue,v(Ze,{get title(){return t("accounts.balance")},get subtitle(){return t("dashboard.overview")},get children(){var E=Go();return E.style.setProperty("font-size","1.5rem"),E.style.setProperty("font-weight","600"),E.style.setProperty("color","var(--primary-color)"),s(E,()=>p(n().balance)),E}}),null),s(ue,v(Ze,{get title(){return t("accounts.accountType")},get subtitle(){return t("accounts.category")},get children(){var E=Go();return E.style.setProperty("font-size","1.5rem"),E.style.setProperty("font-weight","600"),E.style.setProperty("color","var(--primary-color)"),s(E,()=>t(`accounts.types.${n().type.toLowerCase()}`)),E}}),null),s(ue,v(Ze,{get title(){return t("common.status")},get subtitle(){return t("accounts.accountDetails")},get children(){var E=Go();return E.style.setProperty("font-size","1.5rem"),E.style.setProperty("font-weight","600"),s(E,(()=>{var F=ye(()=>!!n().isActive);return()=>F()?t("common.active"):t("common.inactive")})()),ie(F=>(F=n().isActive?"#4caf50":"#f44336")!=null?E.style.setProperty("color",F):E.style.removeProperty("color")),E}}),null),s(ue,v(Ze,{get title(){return t("accounts.transactions")},get subtitle(){return t("common.total")},get children(){var E=Go();return E.style.setProperty("font-size","1.5rem"),E.style.setProperty("font-weight","600"),E.style.setProperty("color","var(--primary-color)"),s(E,()=>x.length),E}}),null),u(J,M),s(J,v(Ze,{get title(){return t("accounts.accountDetails")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var E=Hs(),F=E.firstChild,z=F.nextSibling;return s(F,()=>t("accounts.accountNumber")),s(z,()=>n().accountNumber),ie(B=>{var k=$,U=T,he=ee;return B.e=u(E,k,B.e),B.t=u(F,U,B.t),B.a=u(z,he,B.a),B},{e:void 0,t:void 0,a:void 0}),E})(),(()=>{var E=Hs(),F=E.firstChild,z=F.nextSibling;return s(F,()=>t("accounts.category")),s(z,()=>n().category),ie(B=>{var k=$,U=T,he=ee;return B.e=u(E,k,B.e),B.t=u(F,U,B.t),B.a=u(z,he,B.a),B},{e:void 0,t:void 0,a:void 0}),E})(),(()=>{var E=Hs(),F=E.firstChild,z=F.nextSibling;return s(F,()=>t("common.date")),s(z,()=>C(n().createdDate)),ie(B=>{var k=$,U=T,he=ee;return B.e=u(E,k,B.e),B.t=u(F,U,B.t),B.a=u(z,he,B.a),B},{e:void 0,t:void 0,a:void 0}),E})(),(()=>{var E=Hs(),F=E.firstChild,z=F.nextSibling;return s(F,()=>t("common.date")),s(z,()=>C(n().lastModified)),ie(B=>{var k=$,U=T,he=ee;return B.e=u(E,k,B.e),B.t=u(F,U,B.t),B.a=u(z,he,B.a),B},{e:void 0,t:void 0,a:void 0}),E})()]}}),null),s(J,v(Ze,{get title(){return t("common.description")},get subtitle(){return t("accounts.accountDetails")},get children(){var E=Yx();return E.style.setProperty("margin","0"),E.style.setProperty("color","var(--text-secondary)"),s(E,()=>n().description||t("common.noDataFound")),E}}),null),y})()),ye(()=>ye(()=>i()==="transactions")()&&v(Ze,{get title(){return t("accounts.accountHistory")},get subtitle(){return t("accounts.transactions")},get children(){return ye(()=>x.length===0)()?(()=>{var y=Go();return y.style.setProperty("text-align","center"),y.style.setProperty("color","var(--text-muted)"),y.style.setProperty("padding","2rem"),s(y,()=>t("common.noDataFound")),y})():x.map(y=>(()=>{var ue=Kx(),J=ue.firstChild,E=J.firstChild,F=E.nextSibling,z=F.firstChild,B=J.nextSibling;return u(ue,ce),u(J,Z),u(E,ge),s(E,()=>y.description),u(F,ne),s(F,()=>C(y.date),z),s(F,()=>y.reference,null),s(B,()=>y.type==="debit"?"+":"-",null),s(B,()=>p(y.type==="debit"?y.debitAmount:y.creditAmount),null),ie(k=>u(B,w(y.type),k)),ue})())}}))]}})};Et(["click"]);var Jx=q("<div><div><h1></h1><p> </p></div><div><input type=date>"),_n=q("<div><span></span><span>"),Xx=q("<div><div></div><div>"),Zx=q("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),eE=q("<div><div> (<!> = <!> + <!>)</div><div> = "),tE=q("<span>(<!>: <!>)");const rE=()=>{const{t}=ct(),[e,r]=ve(new Date().toISOString().split("T")[0]),[n,o]=ve(0),[i,a]=ve(0),[c,d]=ve(0);Hr(()=>{h()});const h=()=>{const L=wt.getAccountsByType("Asset"),M=wt.getAccountsByType("Liability"),$=wt.getAccountsByType("Equity"),T=L.reduce((Z,ge)=>Z+ge.balance,0),ee=M.reduce((Z,ge)=>Z+ge.balance,0),ce=$.reduce((Z,ge)=>Z+ge.balance,0);o(T),a(ee),d(ce)},m=L=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(L),g={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},_={"margin-bottom":"2rem"},A={"font-weight":"bold","font-size":"1.1rem","border-top":"2px solid var(--border-color)","padding-top":"0.5rem","margin-top":"1rem"};return v(Lr,{get title(){return t("balanceSheet.title")},get children(){return[(()=>{var L=Jx(),M=L.firstChild,$=M.firstChild,T=$.nextSibling,ee=T.firstChild,ce=M.nextSibling,Z=ce.firstChild;return u(L,g),$.style.setProperty("margin","0"),s($,()=>t("balanceSheet.title")),T.style.setProperty("margin","0.5rem 0 0 0"),T.style.setProperty("color","var(--text-muted)"),s(T,()=>t("balanceSheet.asOf"),ee),s(T,()=>new Date(e()).toLocaleDateString(),null),ce.style.setProperty("display","flex"),ce.style.setProperty("gap","1rem"),Z.addEventListener("change",ge=>r(ge.target.value)),Z.style.setProperty("padding","0.5rem"),Z.style.setProperty("border","1px solid var(--border-color)"),Z.style.setProperty("border-radius","var(--border-radius-sm)"),s(ce,v(Le,{variant:"primary",onClick:h,get children(){return t("balanceSheet.generateReport")}}),null),ie(()=>Z.value=e()),L})(),(()=>{var L=Xx(),M=L.firstChild,$=M.nextSibling;return L.style.setProperty("display","grid"),L.style.setProperty("grid-template-columns","1fr 1fr"),L.style.setProperty("gap","2rem"),s(M,v(Ze,{get title(){return t("balanceSheet.assets")},style:_,get children(){return[(()=>{var T=_n(),ee=T.firstChild,ce=ee.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),s(ee,()=>t("balanceSheet.currentAssets")),s(ce,()=>m(n()*.6)),T})(),(()=>{var T=_n(),ee=T.firstChild,ce=ee.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),s(ee,()=>t("balanceSheet.nonCurrentAssets")),s(ce,()=>m(n()*.4)),T})(),(()=>{var T=_n(),ee=T.firstChild,ce=ee.nextSibling;return s(ee,()=>t("balanceSheet.totalAssets")),s(ce,()=>m(n())),ie(Z=>u(T,{...A,display:"flex","justify-content":"space-between"},Z)),T})()]}})),s($,v(Ze,{get title(){return t("balanceSheet.liabilities")},style:_,get children(){return[(()=>{var T=_n(),ee=T.firstChild,ce=ee.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),s(ee,()=>t("balanceSheet.currentLiabilities")),s(ce,()=>m(i()*.7)),T})(),(()=>{var T=_n(),ee=T.firstChild,ce=ee.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),s(ee,()=>t("balanceSheet.nonCurrentLiabilities")),s(ce,()=>m(i()*.3)),T})(),(()=>{var T=_n(),ee=T.firstChild,ce=ee.nextSibling;return s(ee,()=>t("balanceSheet.totalLiabilities")),s(ce,()=>m(i())),ie(Z=>u(T,{...A,display:"flex","justify-content":"space-between"},Z)),T})()]}}),null),s($,v(Ze,{get title(){return t("balanceSheet.equity")},get children(){return[(()=>{var T=_n(),ee=T.firstChild,ce=ee.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),s(ee,()=>t("balanceSheet.commonStock")),s(ce,()=>m(c()*.8)),T})(),(()=>{var T=_n(),ee=T.firstChild,ce=ee.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),s(ee,()=>t("balanceSheet.retainedEarnings")),s(ce,()=>m(c()*.2)),T})(),(()=>{var T=_n(),ee=T.firstChild,ce=ee.nextSibling;return s(ee,()=>t("balanceSheet.totalEquity")),s(ce,()=>m(c())),ie(Z=>u(T,{...A,display:"flex","justify-content":"space-between"},Z)),T})()]}}),null),L})(),v(Ze,{get title(){return t("dashboard.overview")},style:{"margin-top":"2rem"},get children(){return[(()=>{var L=Zx(),M=L.firstChild,$=M.firstChild,T=$.nextSibling,ee=M.nextSibling,ce=ee.firstChild,Z=ce.nextSibling,ge=ee.nextSibling,ne=ge.firstChild,w=ne.nextSibling;return L.style.setProperty("display","grid"),L.style.setProperty("grid-template-columns","repeat(3, 1fr)"),L.style.setProperty("gap","2rem"),M.style.setProperty("text-align","center"),$.style.setProperty("font-size","0.875rem"),$.style.setProperty("color","var(--text-muted)"),$.style.setProperty("margin-bottom","0.5rem"),s($,()=>t("balanceSheet.totalAssets")),T.style.setProperty("font-size","1.5rem"),T.style.setProperty("font-weight","bold"),T.style.setProperty("color","var(--primary-color)"),s(T,()=>m(n())),ee.style.setProperty("text-align","center"),ce.style.setProperty("font-size","0.875rem"),ce.style.setProperty("color","var(--text-muted)"),ce.style.setProperty("margin-bottom","0.5rem"),s(ce,()=>t("balanceSheet.totalLiabilities")),Z.style.setProperty("font-size","1.5rem"),Z.style.setProperty("font-weight","bold"),Z.style.setProperty("color","#f44336"),s(Z,()=>m(i())),ge.style.setProperty("text-align","center"),ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("color","var(--text-muted)"),ne.style.setProperty("margin-bottom","0.5rem"),s(ne,()=>t("balanceSheet.totalEquity")),w.style.setProperty("font-size","1.5rem"),w.style.setProperty("font-weight","bold"),w.style.setProperty("color","#4caf50"),s(w,()=>m(c())),L})(),(()=>{var L=eE(),M=L.firstChild,$=M.firstChild,T=$.nextSibling,ee=T.nextSibling,ce=ee.nextSibling,Z=ce.nextSibling,ge=Z.nextSibling;ge.nextSibling;var ne=M.nextSibling,w=ne.firstChild;return L.style.setProperty("margin-top","2rem"),L.style.setProperty("text-align","center"),M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","var(--text-muted)"),M.style.setProperty("margin-bottom","0.5rem"),s(M,()=>t("common.total"),$),s(M,()=>t("balanceSheet.totalAssets"),T),s(M,()=>t("balanceSheet.totalLiabilities"),ce),s(M,()=>t("balanceSheet.totalEquity"),ge),ne.style.setProperty("font-size","1.2rem"),ne.style.setProperty("font-weight","bold"),s(ne,()=>m(n()),w),s(ne,()=>m(i()+c()),null),s(ne,(()=>{var S=ye(()=>Math.abs(n()-(i()+c()))>.01);return()=>S()&&(()=>{var p=tE(),C=p.firstChild,P=C.nextSibling,x=P.nextSibling,y=x.nextSibling;return y.nextSibling,p.style.setProperty("font-size","0.875rem"),p.style.setProperty("color","#f44336"),p.style.setProperty("display","block"),s(p,()=>t("common.error"),P),s(p,()=>m(n()-(i()+c())),y),p})()})(),null),ie(S=>(S=Math.abs(n()-(i()+c()))<.01?"#4caf50":"#f44336")!=null?ne.style.setProperty("color",S):ne.style.removeProperty("color")),L})()]}})]}})};Et(["click"]);const nE=[{id:"1",name:"John Doe",position:"Software Engineer",salary:85e3,email:"john.doe@company.com",phone:"+1 (555) 123-4567",department:"Engineering",startDate:"2023-01-15"},{id:"2",name:"Jane Smith",position:"Product Manager",salary:95e3,email:"jane.smith@company.com",phone:"+1 (555) 234-5678",department:"Product",startDate:"2022-08-20"},{id:"3",name:"Mike Brown",position:"Designer",salary:7e4,email:"mike.brown@company.com",phone:"+1 (555) 345-6789",department:"Design",startDate:"2023-03-10"},{id:"4",name:"Sarah Kim",position:"HR Manager",salary:78e3,email:"sarah.kim@company.com",phone:"+1 (555) 456-7890",department:"Human Resources",startDate:"2022-11-05"},{id:"5",name:"Alex Lee",position:"Data Analyst",salary:72e3,email:"alex.lee@company.com",phone:"+1 (555) 567-8901",department:"Analytics",startDate:"2023-02-28"},{id:"6",name:"Emma Wilson",position:"Marketing Manager",salary:82e3,email:"emma.wilson@company.com",phone:"+1 (555) 678-9012",department:"Marketing",startDate:"2022-09-15"}],[Ri,Rl]=ve(nE),xg={get employees(){return Ri()},addEmployee(t){const e={...t,id:Date.now().toString()};return Rl([...Ri(),e]),e},updateEmployee(t,e){Rl(Ri().map(r=>r.id===t?{...r,...e}:r))},deleteEmployee(t){Rl(Ri().filter(e=>e.id!==t))},getEmployeeById(t){return Ri().find(e=>e.id===t)}};var oE=q("<form><div>");const iE=t=>{const{t:e}=ct(),[r,n]=ve({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),o=[{value:"Engineering",label:e("employees.departments.engineering","Engineering")},{value:"Product",label:e("employees.departments.product","Product")},{value:"Design",label:e("employees.departments.design","Design")},{value:"Marketing",label:e("employees.departments.marketing","Marketing")},{value:"Sales",label:e("employees.departments.sales","Sales")},{value:"Human Resources",label:e("employees.departments.humanResources","Human Resources")},{value:"Finance",label:e("employees.departments.finance","Finance")},{value:"Operations",label:e("employees.departments.operations","Operations")},{value:"Analytics",label:e("employees.departments.analytics","Analytics")}],i={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},a=d=>{d.preventDefault();const h=r();if(!h.name||!h.position||!h.salary||!h.email||!h.department||!h.startDate){alert(e("forms.requiredField"));return}const m={name:h.name,position:h.position,salary:parseFloat(h.salary),email:h.email,phone:h.phone,department:h.department,startDate:h.startDate};xg.addEmployee(m),n({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),t.onClose()},c=(d,h)=>{n(m=>({...m,[d]:h}))};return v(br,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.addEmployee")},get children(){var d=oE(),h=d.firstChild;return d.addEventListener("submit",a),s(d,v(Mt,{get label(){return e("employees.fullName")},get value(){return r().name},onChange:m=>c("name",m),get placeholder(){return e("employees.enterFullName","Enter employee's full name")},required:!0}),h),s(d,v(Mt,{get label(){return e("employees.position")},get value(){return r().position},onChange:m=>c("position",m),get placeholder(){return e("employees.enterPosition","Enter job position")},required:!0}),h),s(d,v(gr,{get label(){return e("employees.department")},get value(){return r().department},onChange:m=>c("department",m),options:o,required:!0}),h),s(d,v(Mt,{get label(){return e("employees.email")},type:"email",get value(){return r().email},onChange:m=>c("email",m),get placeholder(){return e("employees.enterEmail","Enter email address")},required:!0}),h),s(d,v(Mt,{get label(){return e("employees.phone")},type:"tel",get value(){return r().phone},onChange:m=>c("phone",m),get placeholder(){return e("employees.enterPhone","Enter phone number")}}),h),s(d,v(Mt,{get label(){return e("employees.salary")},type:"number",get value(){return r().salary},onChange:m=>c("salary",m),get placeholder(){return e("employees.enterSalary","Enter annual salary")},required:!0}),h),s(d,v(Mt,{get label(){return e("employees.hireDate")},type:"date",get value(){return r().startDate},onChange:m=>c("startDate",m),required:!0}),h),u(h,i),s(h,v(Le,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(h,v(Le,{variant:"primary",type:"submit",get children(){return e("employees.addEmployee")}}),null),d}})};var sE=q("<div><div></div><div></div><div>"),aE=q("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),lE=q("<div>");const cE=t=>{const{t:e}=ct(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},o={"font-weight":"600",color:"var(--text-primary)"},i={width:"80px",height:"80px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.5rem",margin:"0 auto 1.5rem auto"},a={"text-align":"center","margin-bottom":"2rem"},c={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},d={color:"var(--text-muted)","font-size":"1rem"},h={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"};if(!t.employee)return null;const m=A=>A.split(" ").map(L=>L[0]).join("").toUpperCase(),g=A=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(A),_=A=>new Date(A).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return v(br,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.employeeDetails")},get children(){return[(()=>{var A=sE(),L=A.firstChild,M=L.nextSibling,$=M.nextSibling;return u(A,a),u(L,i),s(L,()=>m(t.employee.name)),u(M,c),s(M,()=>t.employee.name),u($,d),s($,()=>t.employee.position),A})(),(()=>{var A=aE(),L=A.firstChild,M=L.firstChild,$=M.nextSibling,T=L.nextSibling,ee=T.firstChild,ce=ee.nextSibling,Z=T.nextSibling,ge=Z.firstChild,ne=ge.nextSibling,w=Z.nextSibling,S=w.firstChild,p=S.nextSibling,C=w.nextSibling,P=C.firstChild,x=P.nextSibling,y=C.nextSibling,ue=y.firstChild,J=ue.nextSibling;return s(M,()=>e("employees.employeeId")),s($,()=>t.employee.id),s(ee,()=>e("employees.department")),s(ce,()=>t.employee.department),s(ge,()=>e("employees.email")),s(ne,()=>t.employee.email),s(S,()=>e("employees.phone")),s(p,()=>t.employee.phone),s(P,()=>e("employees.salary")),s(x,()=>g(t.employee.salary)),s(ue,()=>e("employees.hireDate")),s(J,()=>_(t.employee.startDate)),ie(E=>{var F=r,z=n,B=o,k=r,U=n,he=o,H=r,le=n,I=o,j=r,K=n,R=o,X=r,O=n,N=o,te=r,de=n,pe=o;return E.e=u(L,F,E.e),E.t=u(M,z,E.t),E.a=u($,B,E.a),E.o=u(T,k,E.o),E.i=u(ee,U,E.i),E.n=u(ce,he,E.n),E.s=u(Z,H,E.s),E.h=u(ge,le,E.h),E.r=u(ne,I,E.r),E.d=u(w,j,E.d),E.l=u(S,K,E.l),E.u=u(p,R,E.u),E.c=u(C,X,E.c),E.w=u(P,O,E.w),E.m=u(x,N,E.m),E.f=u(y,te,E.f),E.y=u(ue,de,E.y),E.g=u(J,pe,E.g),E},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),A})(),(()=>{var A=lE();return u(A,h),s(A,v(Le,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(A,v(Le,{variant:"primary",onClick:()=>{console.log("Edit employee:",t.employee.id)},get children(){return e("employees.editEmployee")}}),null),A})()]}})};var dm=q("<div>"),uE=q("<div><div></div><div><div></div><div></div><div>/year");const dE=()=>{const{t}=ct(),[e,r]=ve(!1),[n,o]=ve(!1),[i,a]=ve(null),c=M=>{a(M),o(!0)},d={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},h={display:"flex","align-items":"center",gap:"1rem"},m={width:"60px",height:"60px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.2rem"},g={flex:"1"},_={"font-weight":"600","margin-bottom":"0.25rem"},A={color:"var(--text-muted)","font-size":"0.875rem","margin-bottom":"0.5rem"},L={color:"var(--primary-color)","font-weight":"500"};return v(Lr,{get title(){return t("employees.title")},get children(){return[(()=>{var M=dm();return M.style.setProperty("margin-bottom","2rem"),s(M,v(Le,{variant:"primary",onClick:()=>r(!0),get children(){return t("employees.addEmployee")}})),M})(),(()=>{var M=dm();return u(M,d),s(M,()=>xg.employees.map($=>{const T=ce=>ce.split(" ").map(Z=>Z[0]).join("").toUpperCase(),ee=ce=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ce);return v(Ze,{onClick:()=>c($),get children(){var ce=uE(),Z=ce.firstChild,ge=Z.nextSibling,ne=ge.firstChild,w=ne.nextSibling,S=w.nextSibling,p=S.firstChild;return u(ce,h),u(Z,m),s(Z,()=>T($.name)),u(ge,g),u(ne,_),s(ne,()=>$.name),u(w,A),s(w,()=>$.position),u(S,L),s(S,()=>ee($.salary),p),ce}})})),M})(),v(iE,{get isOpen(){return e()},onClose:()=>r(!1)}),v(cE,{get isOpen(){return n()},onClose:()=>o(!1),get employee(){return i()}})]}})},hE=[{id:"1",accountId:"1002",bankName:"First National Bank",accountNumber:"****1234",accountType:"checking",currency:"USD",currentBalance:32730.5,lastReconciledDate:"2024-01-01",lastReconciledBalance:3e4,isActive:!0},{id:"2",accountId:"1003",bankName:"First National Bank",accountNumber:"****5678",accountType:"savings",currency:"USD",currentBalance:12e3,lastReconciledDate:"2024-01-01",lastReconciledBalance:1e4,isActive:!0}],mE=[{id:"1",accountId:"1002",date:"2024-01-15",description:"Customer Payment - ABC Corp",reference:"CHK001234",debitAmount:5e3,creditAmount:0,balance:35730.5,category:"Customer Payment",isReconciled:!0,reconciledWith:"eb1",importedAt:"2024-01-16",source:"csv_import"},{id:"2",accountId:"1002",date:"2024-01-14",description:"Office Supplies - Staples",reference:"CHK001235",debitAmount:0,creditAmount:250,balance:30730.5,category:"Office Expenses",isReconciled:!0,reconciledWith:"eb2",importedAt:"2024-01-16",source:"csv_import"},{id:"3",accountId:"1002",date:"2024-01-13",description:"Monthly Rent Payment",reference:"CHK001236",debitAmount:0,creditAmount:2e3,balance:28730.5,category:"Rent",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"},{id:"4",accountId:"1002",date:"2024-01-12",description:"Wire Transfer In",reference:"WIRE001",debitAmount:1e4,creditAmount:0,balance:38730.5,category:"Wire Transfer",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"}],fE=[{id:"eb1",accountId:"1002",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",debitAmount:5e3,creditAmount:0,category:"Accounts Receivable",isReconciled:!0,reconciledWith:"1",createdAt:"2024-01-15"},{id:"eb2",accountId:"1002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",debitAmount:0,creditAmount:250,category:"Office Expenses",isReconciled:!0,reconciledWith:"2",createdAt:"2024-01-14"},{id:"eb3",accountId:"1002",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",debitAmount:0,creditAmount:3500,category:"Salary Expense",isReconciled:!1,createdAt:"2024-01-11"}],yE=[{id:"1",bankAccountId:"1",periodStart:"2024-01-01",periodEnd:"2024-01-15",startingBalance:3e4,endingBalance:35730.5,status:"in_progress",totalBankTransactions:4,totalEntryBookRecords:3,reconciledTransactions:2,unreconciledTransactions:2,discrepancyAmount:1500,createdAt:"2024-01-16",notes:"Wire transfer and rent payment need investigation"}],[Ys,hm]=ve(hE),[zn,Dl]=ve(mE),[Di,mm]=ve(fE),[Ws,fm]=ve(yE),cr={get bankAccounts(){return Ys()},addBankAccount(t){const e={...t,id:Date.now().toString()};return hm([...Ys(),e]),e},updateBankAccount(t,e){hm(Ys().map(r=>r.id===t?{...r,...e}:r))},getBankAccountById(t){return Ys().find(e=>e.id===t)},get bankStatements(){return zn()},addBankStatement(t){const e={...t,id:Date.now().toString(),importedAt:new Date().toISOString()};return Dl([...zn(),e]),e},addBankStatementsFromCSV(t){const e=t.map(r=>({...r,id:`csv_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,importedAt:new Date().toISOString(),source:"csv_import",isReconciled:!1}));return Dl([...zn(),...e]),e},updateBankStatement(t,e){Dl(zn().map(r=>r.id===t?{...r,...e}:r))},getBankStatementsByAccount(t){return zn().filter(e=>e.accountId===t)},getUnreconciledBankStatements(t){return(t?this.getBankStatementsByAccount(t):zn()).filter(r=>!r.isReconciled)},get entryBookRecords(){return Di()},addEntryBookRecord(t){const e={...t,id:Date.now().toString(),createdAt:new Date().toISOString()};return mm([...Di(),e]),e},updateEntryBookRecord(t,e){mm(Di().map(r=>r.id===t?{...r,...e}:r))},getEntryBookRecordsByAccount(t){return Di().filter(e=>e.accountId===t)},getUnreconciledEntryBookRecords(t){return(t?this.getEntryBookRecordsByAccount(t):Di()).filter(r=>!r.isReconciled)},reconcileTransaction(t,e){this.updateBankStatement(t,{isReconciled:!0,reconciledWith:e}),this.updateEntryBookRecord(e,{isReconciled:!0,reconciledWith:t})},unreconciledTransaction(t){const e=zn().find(r=>r.id===t);e?.reconciledWith&&this.updateEntryBookRecord(e.reconciledWith,{isReconciled:!1,reconciledWith:void 0}),this.updateBankStatement(t,{isReconciled:!1,reconciledWith:void 0})},findPotentialMatches(t){const e=zn().find(n=>n.id===t);return e?this.getUnreconciledEntryBookRecords(e.accountId).filter(n=>{const o=Math.abs(e.debitAmount-n.debitAmount)<.01||Math.abs(e.creditAmount-n.creditAmount)<.01,i=new Date(e.date),a=new Date(n.date),d=Math.abs((i.getTime()-a.getTime())/(1e3*60*60*24))<=3,h=e.reference===n.reference||e.description.toLowerCase().includes(n.description.toLowerCase())||n.description.toLowerCase().includes(e.description.toLowerCase());return o&&(d||h)}).sort((n,o)=>{const i=(n.date===e.date?2:0)+(n.reference===e.reference?1:0);return(o.date===e.date?2:0)+(o.reference===e.reference?1:0)-i}):[]},get reconciliationSessions(){return Ws()},startReconciliationSession(t,e,r){const n=this.getBankStatementsByAccount(t).filter(h=>h.date>=e&&h.date<=r),o=this.getEntryBookRecordsByAccount(t).filter(h=>h.date>=e&&h.date<=r),i=n.filter(h=>h.isReconciled).length,a=this.getBankAccountById(t)?.lastReconciledBalance||0,c=this.getBankAccountById(t)?.currentBalance||0,d={id:Date.now().toString(),bankAccountId:t,periodStart:e,periodEnd:r,startingBalance:a,endingBalance:c,status:"in_progress",totalBankTransactions:n.length,totalEntryBookRecords:o.length,reconciledTransactions:i,unreconciledTransactions:n.length-i,discrepancyAmount:0,createdAt:new Date().toISOString()};return fm([...Ws(),d]),d},updateReconciliationSession(t,e){fm(Ws().map(r=>r.id===t?{...r,...e}:r))},getReconciliationSessionsByAccount(t){return Ws().filter(e=>e.bankAccountId===t)}};var Nl=q("<div>"),gE=q("<div><strong>:</strong> <!> - "),pE=q("<div><div><div>📄</div><div></div><div></div></div><input id=csvFileInput type=file accept=.csv>"),vE=q("<div><h4></h4><div><div><label> *</label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><select><option value>"),Ho=q("<option>"),bE=q("<div><table><thead><tr></tr></thead><tbody>"),_E=q("<th>"),SE=q("<tr>"),PE=q("<td>");const wE=t=>{const{t:e}=ct(),[r,n]=ve(!1),[o,i]=ve(!1),[a,c]=ve(null),[d,h]=ve([]),[m,g]=ve({date:"",description:"",reference:"",debit:"",credit:"",balance:""}),_={border:`2px dashed ${r()?"var(--primary-color)":"var(--border-color)"}`,"border-radius":"var(--border-radius)",padding:"2rem","text-align":"center","background-color":r()?"var(--background-color)":"transparent",transition:"all 0.2s ease",cursor:"pointer"},A={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem","margin-top":"1.5rem"},L={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-family":"inherit"},M={"max-height":"200px","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},$={width:"100%","border-collapse":"collapse","font-size":"0.875rem"},T={padding:"0.5rem","border-bottom":"1px solid var(--border-color)","text-align":"left"},ee={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},ce=x=>{x.preventDefault(),n(!0)},Z=x=>{x.preventDefault(),n(!1)},ge=x=>{x.preventDefault(),n(!1);const y=x.dataTransfer?.files;y&&y.length>0&&w(y[0])},ne=x=>{const y=x.target;y.files&&y.files.length>0&&w(y.files[0])},w=x=>{if(!x.name.toLowerCase().endsWith(".csv")){c({success:!1,message:e("banking.pleaseUploadCSV")});return}i(!0);const y=new FileReader;y.onload=ue=>{try{const E=(ue.target?.result).split(`
`).filter(k=>k.trim());if(E.length<2){c({success:!1,message:e("banking.csvRequiresHeaderAndData")}),i(!1);return}const F=E[0].split(",").map(k=>k.trim().replace(/[\"\']/g,"")),z=E.slice(1).map(k=>{const U=k.split(",").map(H=>H.trim().replace(/[\"\']/g,"")),he={};return F.forEach((H,le)=>{he[H]=U[le]||""}),he});h(z),c({success:!0,message:e("banking.successfullyParsed").replace("{count}",z.length.toString()),count:z.length});const B={...m()};F.forEach(k=>{const U=k.toLowerCase();U.includes("date")&&(B.date=k),(U.includes("description")||U.includes("memo"))&&(B.description=k),(U.includes("reference")||U.includes("check")||U.includes("ref"))&&(B.reference=k),(U.includes("debit")||U.includes("deposit"))&&(B.debit=k),(U.includes("credit")||U.includes("withdrawal")||U.includes("amount"))&&(B.debit?B.credit=k:B.debit=k),U.includes("balance")&&(B.balance=k)}),g(B)}catch{c({success:!1,message:e("banking.errorParsingCSV")})}i(!1)},y.readAsText(x)},S=(x,y)=>{g(ue=>({...ue,[x]:y}))},p=()=>d().length===0?[]:Object.keys(d()[0]),C=()=>{if(!t.bankAccount||d().length===0)return;const x=m();if(!x.date||!x.description){c({success:!1,message:e("banking.dateDescriptionRequired")});return}i(!0);try{const y=d().map(J=>{const E=k=>k&&parseFloat(k.replace(/[^0-9.-]/g,""))||0,F=k=>{const U=new Date(k);if(isNaN(U.getTime())){const he=k.split("/");if(he.length===3)return new Date(parseInt(he[2]),parseInt(he[0])-1,parseInt(he[1])).toISOString().split("T")[0]}return U.toISOString().split("T")[0]};let z=0,B=0;if(x.debit&&x.credit)z=E(J[x.debit]),B=E(J[x.credit]);else if(x.debit){const k=E(J[x.debit]);k>0?z=k:B=Math.abs(k)}return{accountId:t.bankAccount.accountId,date:F(J[x.date]),description:J[x.description]||e("banking.importedTransaction"),reference:J[x.reference]||"",debitAmount:z,creditAmount:B,balance:x.balance?E(J[x.balance]):0,isReconciled:!1}}),ue=cr.addBankStatementsFromCSV(y);c({success:!0,message:e("banking.successfullyImported").replace("{count}",ue.length.toString()),count:ue.length}),h([]),g({date:"",description:"",reference:"",debit:"",credit:"",balance:""})}catch{c({success:!1,message:e("banking.errorImportingTransactions")})}i(!1)},P=()=>{h([]),c(null),g({date:"",description:"",reference:"",debit:"",credit:"",balance:""})};return v(br,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("banking.importBankStatementCSV")},get children(){return[ye(()=>ye(()=>!!t.bankAccount)()&&(()=>{var x=gE(),y=x.firstChild,ue=y.firstChild,J=y.nextSibling,E=J.nextSibling;return E.nextSibling,x.style.setProperty("margin-bottom","1.5rem"),x.style.setProperty("padding","1rem"),x.style.setProperty("background","var(--background-color)"),x.style.setProperty("border-radius","var(--border-radius-sm)"),x.style.setProperty("border","1px solid var(--border-color)"),s(y,()=>e("banking.bankAccount"),ue),s(x,()=>t.bankAccount.bankName,E),s(x,()=>t.bankAccount.accountNumber,null),x})()),ye(()=>ye(()=>d().length===0)()?(()=>{var x=pE(),y=x.firstChild,ue=y.firstChild,J=ue.nextSibling,E=J.nextSibling,F=y.nextSibling;return y.$$click=()=>document.getElementById("csvFileInput")?.click(),y.addEventListener("drop",ge),y.addEventListener("dragleave",Z),y.addEventListener("dragover",ce),ue.style.setProperty("font-size","2rem"),ue.style.setProperty("margin-bottom","1rem"),J.style.setProperty("font-weight","500"),J.style.setProperty("margin-bottom","0.5rem"),s(J,(()=>{var z=ye(()=>!!r());return()=>z()?e("banking.dropCSVHere"):e("banking.clickToUploadCSV")})()),E.style.setProperty("font-size","0.875rem"),E.style.setProperty("color","var(--text-muted)"),s(E,()=>e("banking.supportedFormat")),F.addEventListener("change",ne),F.style.setProperty("display","none"),ie(z=>u(y,_,z)),x})():(()=>{var x=vE(),y=x.firstChild,ue=y.nextSibling,J=ue.firstChild,E=J.firstChild,F=E.firstChild,z=E.nextSibling,B=z.firstChild,k=J.nextSibling,U=k.firstChild,he=U.firstChild,H=U.nextSibling,le=H.firstChild,I=k.nextSibling,j=I.firstChild,K=j.nextSibling,R=K.firstChild,X=I.nextSibling,O=X.firstChild,N=O.firstChild,te=O.nextSibling,de=te.firstChild,pe=X.nextSibling,se=pe.firstChild,Y=se.nextSibling,D=Y.firstChild,Q=pe.nextSibling,W=Q.firstChild,me=W.nextSibling,fe=me.firstChild;return y.style.setProperty("margin","0 0 1rem 0"),s(y,()=>e("banking.mapCSVColumns")),u(ue,A),E.style.setProperty("display","block"),E.style.setProperty("margin-bottom","0.5rem"),E.style.setProperty("font-weight","500"),s(E,()=>e("banking.dateColumn"),F),z.addEventListener("change",V=>S("date",V.target.value)),s(B,()=>e("banking.selectColumn")),s(z,()=>p().map(V=>(()=>{var re=Ho();return re.value=V,s(re,V),re})()),null),U.style.setProperty("display","block"),U.style.setProperty("margin-bottom","0.5rem"),U.style.setProperty("font-weight","500"),s(U,()=>e("banking.descriptionColumn"),he),H.addEventListener("change",V=>S("description",V.target.value)),s(le,()=>e("banking.selectColumn")),s(H,()=>p().map(V=>(()=>{var re=Ho();return re.value=V,s(re,V),re})()),null),j.style.setProperty("display","block"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("font-weight","500"),s(j,()=>e("banking.referenceColumn")),K.addEventListener("change",V=>S("reference",V.target.value)),s(R,()=>e("banking.selectColumn")),s(K,()=>p().map(V=>(()=>{var re=Ho();return re.value=V,s(re,V),re})()),null),O.style.setProperty("display","block"),O.style.setProperty("margin-bottom","0.5rem"),O.style.setProperty("font-weight","500"),s(O,()=>e("banking.amountDebitColumn"),N),te.addEventListener("change",V=>S("debit",V.target.value)),s(de,()=>e("banking.selectColumn")),s(te,()=>p().map(V=>(()=>{var re=Ho();return re.value=V,s(re,V),re})()),null),se.style.setProperty("display","block"),se.style.setProperty("margin-bottom","0.5rem"),se.style.setProperty("font-weight","500"),s(se,()=>e("banking.creditColumn")),Y.addEventListener("change",V=>S("credit",V.target.value)),s(D,()=>e("banking.selectColumn")),s(Y,()=>p().map(V=>(()=>{var re=Ho();return re.value=V,s(re,V),re})()),null),W.style.setProperty("display","block"),W.style.setProperty("margin-bottom","0.5rem"),W.style.setProperty("font-weight","500"),s(W,()=>e("banking.balanceColumn")),me.addEventListener("change",V=>S("balance",V.target.value)),s(fe,()=>e("banking.selectColumn")),s(me,()=>p().map(V=>(()=>{var re=Ho();return re.value=V,s(re,V),re})()),null),s(x,(()=>{var V=ye(()=>d().length>0);return()=>V()&&(()=>{var re=bE(),_e=re.firstChild,Pe=_e.firstChild,ae=Pe.firstChild,be=Pe.nextSibling;return u(re,M),ae.style.setProperty("background-color","var(--background-color)"),s(ae,()=>p().slice(0,6).map(oe=>(()=>{var Se=_E();return s(Se,oe),ie(Ee=>u(Se,T,Ee)),Se})())),s(be,()=>d().slice(0,3).map(oe=>(()=>{var Se=SE();return s(Se,()=>p().slice(0,6).map(Ee=>(()=>{var xe=PE();return s(xe,()=>oe[Ee]),ie($e=>u(xe,T,$e)),xe})())),Se})())),s(re,(()=>{var oe=ye(()=>d().length>3);return()=>oe()&&(()=>{var Se=Nl();return Se.style.setProperty("padding","0.5rem"),Se.style.setProperty("text-align","center"),Se.style.setProperty("color","var(--text-muted)"),s(Se,()=>e("banking.andMoreRows").replace("{count}",(d().length-3).toString())),Se})()})(),null),ie(oe=>u(_e,$,oe)),re})()})(),null),ie(V=>{var re=L,_e=L,Pe=L,ae=L,be=L,oe=L;return V.e=u(z,re,V.e),V.t=u(H,_e,V.t),V.a=u(K,Pe,V.a),V.o=u(te,ae,V.o),V.i=u(Y,be,V.i),V.n=u(me,oe,V.n),V},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),ie(()=>z.value=m().date),ie(()=>H.value=m().description),ie(()=>K.value=m().reference),ie(()=>te.value=m().debit),ie(()=>Y.value=m().credit),ie(()=>me.value=m().balance),x})()),ye(()=>ye(()=>!!a())()&&(()=>{var x=Nl();return x.style.setProperty("padding","1rem"),x.style.setProperty("border-radius","var(--border-radius-sm)"),x.style.setProperty("margin-top","1rem"),s(x,()=>a().message),ie(y=>{var ue=a().success?"#d4edda":"#f8d7da",J=a().success?"#155724":"#721c24",E=`1px solid ${a().success?"#c3e6cb":"#f5c6cb"}`;return ue!==y.e&&((y.e=ue)!=null?x.style.setProperty("background",ue):x.style.removeProperty("background")),J!==y.t&&((y.t=J)!=null?x.style.setProperty("color",J):x.style.removeProperty("color")),E!==y.a&&((y.a=E)!=null?x.style.setProperty("border",E):x.style.removeProperty("border")),y},{e:void 0,t:void 0,a:void 0}),x})()),(()=>{var x=Nl();return u(x,ee),s(x,v(Le,{variant:"secondary",onClick:()=>{P(),t.onClose()},get children(){return e("common.cancel")}}),null),s(x,(()=>{var y=ye(()=>d().length>0);return()=>y()&&v(Le,{variant:"outline",onClick:P,get children(){return e("common.reset")}})})(),null),s(x,(()=>{var y=ye(()=>d().length>0);return()=>y()&&v(Le,{variant:"primary",onClick:C,get disabled(){return o()||!m().date||!m().description},get children(){return ye(()=>!!o())()?e("banking.importing"):e("banking.importTransactions").replace("{count}",d().length.toString())}})})(),null),x})()]}})};Et(["click"]);var ym=q("<span>"),Ks=q("<div>"),gm=q("<div> "),CE=q("<div><div><h3></h3><div><button></button><button></button><button></button></div></div><div></div><div><div><h4></h4><div></div></div><div><h4></h4><div>"),AE=q("<div><div><div></div><div> • </div></div><div><div>"),Ll=q("<span>✓ "),IE=q("<span>(<!>)"),xE=q("<div><strong>:</strong> "),pm=q("<div><div><div></div><div> • </div></div><div>"),EE=q("<div><div>:</div><div></div><div>");const TE=t=>{const{t:e}=ct(),[r,n]=ve([]),[o,i]=ve([]),[a,c]=ve(null),[d,h]=ve([]),[m,g]=ve("unreconciled");Nn(()=>{const E=cr.getBankAccountById(t.bankAccountId);if(E){const F=cr.getBankStatementsByAccount(E.accountId).filter(B=>B.date>=t.selectedPeriod.start&&B.date<=t.selectedPeriod.end),z=cr.getEntryBookRecordsByAccount(E.accountId).filter(B=>B.date>=t.selectedPeriod.start&&B.date<=t.selectedPeriod.end);n(F),i(z)}});const _=()=>{const E=r();switch(m()){case"reconciled":return E.filter(F=>F.isReconciled);case"unreconciled":return E.filter(F=>!F.isReconciled);default:return E}},A=()=>{const E=o();switch(m()){case"reconciled":return E.filter(F=>F.isReconciled);case"unreconciled":return E.filter(F=>!F.isReconciled);default:return E}},L=E=>{if(c(E),E.isReconciled)h([]);else{const F=cr.findPotentialMatches(E.id);h(F)}},M=E=>{const F=a();if(F){cr.reconcileTransaction(F.id,E.id);const z=cr.getBankAccountById(t.bankAccountId);if(z){const B=cr.getBankStatementsByAccount(z.accountId).filter(U=>U.date>=t.selectedPeriod.start&&U.date<=t.selectedPeriod.end),k=cr.getEntryBookRecordsByAccount(z.accountId).filter(U=>U.date>=t.selectedPeriod.start&&U.date<=t.selectedPeriod.end);n(B),i(k)}c(null),h([])}},$=E=>{cr.unreconciledTransaction(E.id);const F=cr.getBankAccountById(t.bankAccountId);if(F){const z=cr.getBankStatementsByAccount(F.accountId).filter(k=>k.date>=t.selectedPeriod.start&&k.date<=t.selectedPeriod.end),B=cr.getEntryBookRecordsByAccount(F.accountId).filter(k=>k.date>=t.selectedPeriod.start&&k.date<=t.selectedPeriod.end);n(z),i(B)}},T={display:"grid","grid-template-columns":"1fr 1fr",gap:"2rem","margin-top":"2rem"},ee={height:"600px","overflow-y":"auto"},ce={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},Z=E=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:E?"var(--primary-color)":"var(--surface-color)",color:E?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),ge=(E,F)=>({display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem","margin-bottom":"0.5rem",background:E?"var(--primary-color)":F?"#e8f5e8":"var(--surface-color)",color:E?"white":"var(--text-primary)","border-radius":"var(--border-radius-sm)",border:`1px solid ${E?"var(--primary-color)":F?"#c3e6cb":"var(--border-color)"}`,cursor:"pointer",transition:"all 0.2s ease"}),ne={flex:"1"},w={"font-weight":"500","margin-bottom":"0.25rem"},S={"font-size":"0.875rem",opacity:"0.8"},p=E=>({"font-weight":"600",color:E?"#4caf50":"#f44336"}),C={padding:"0.25rem 0.5rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","margin-left":"0.5rem"},P=E=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(E),x=E=>new Date(E).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),y=E=>{if(!a())return null;const F=a();return(Math.abs(F.debitAmount-E.debitAmount)<.01||Math.abs(F.creditAmount-E.creditAmount)<.01)&&F.date===E.date?(()=>{var k=ym();return s(k,()=>e("banking.exactMatch")),ie(U=>u(k,{...C,background:"#d4edda",color:"#155724"},U)),k})():d().includes(E)?(()=>{var k=ym();return s(k,()=>e("banking.possibleMatch")),ie(U=>u(k,{...C,background:"#fff3cd",color:"#856404"},U)),k})():null},J=(()=>{const E=r(),F=o(),z=E.filter(k=>k.isReconciled).length,B=F.filter(k=>k.isReconciled).length;return{totalStatements:E.length,totalRecords:F.length,reconciledStatements:z,reconciledRecords:B,unreconciledStatements:E.length-z,unreconciledRecords:F.length-B}})();return(()=>{var E=CE(),F=E.firstChild,z=F.firstChild,B=z.nextSibling,k=B.firstChild,U=k.nextSibling,he=U.nextSibling,H=F.nextSibling,le=H.nextSibling,I=le.firstChild,j=I.firstChild,K=j.nextSibling,R=I.nextSibling,X=R.firstChild,O=X.nextSibling;return u(F,ce),z.style.setProperty("margin","0"),z.style.setProperty("font-size","1.25rem"),s(z,()=>e("banking.reconciliationComparison")),B.style.setProperty("display","flex"),B.style.setProperty("gap","0.5rem"),k.$$click=()=>g("all"),s(k,()=>e("common.all")),U.$$click=()=>g("unreconciled"),s(U,()=>e("banking.unreconciled")),he.$$click=()=>g("reconciled"),s(he,()=>e("banking.reconciled")),H.style.setProperty("display","grid"),H.style.setProperty("grid-template-columns","repeat(4, 1fr)"),H.style.setProperty("gap","1rem"),H.style.setProperty("margin-bottom","2rem"),s(H,v(Ze,{get title(){return e("banking.bankStatements")},get subtitle(){return e("banking.totalTransactions")},get children(){return[(()=>{var N=Ks();return N.style.setProperty("font-size","1.5rem"),N.style.setProperty("font-weight","600"),N.style.setProperty("color","var(--primary-color)"),s(N,()=>J.totalStatements),N})(),(()=>{var N=gm(),te=N.firstChild;return N.style.setProperty("font-size","0.875rem"),N.style.setProperty("color","var(--text-muted)"),s(N,()=>J.reconciledStatements,te),s(N,()=>e("banking.reconciled"),null),N})()]}}),null),s(H,v(Ze,{get title(){return e("banking.entryBookRecords")},get subtitle(){return e("banking.totalEntries")},get children(){return[(()=>{var N=Ks();return N.style.setProperty("font-size","1.5rem"),N.style.setProperty("font-weight","600"),N.style.setProperty("color","var(--primary-color)"),s(N,()=>J.totalRecords),N})(),(()=>{var N=gm(),te=N.firstChild;return N.style.setProperty("font-size","0.875rem"),N.style.setProperty("color","var(--text-muted)"),s(N,()=>J.reconciledRecords,te),s(N,()=>e("banking.reconciled"),null),N})()]}}),null),s(H,v(Ze,{get title(){return e("banking.unreconciledBank")},get subtitle(){return e("banking.needAttention")},get children(){var N=Ks();return N.style.setProperty("font-size","1.5rem"),N.style.setProperty("font-weight","600"),N.style.setProperty("color","#f44336"),s(N,()=>J.unreconciledStatements),N}}),null),s(H,v(Ze,{get title(){return e("banking.unreconciledBooks")},get subtitle(){return e("banking.needAttention")},get children(){var N=Ks();return N.style.setProperty("font-size","1.5rem"),N.style.setProperty("font-weight","600"),N.style.setProperty("color","#f44336"),s(N,()=>J.unreconciledRecords),N}}),null),u(le,T),j.style.setProperty("margin","0 0 1rem 0"),s(j,()=>e("banking.bankStatements")),s(K,()=>_().map(N=>(()=>{var te=AE(),de=te.firstChild,pe=de.firstChild,se=pe.nextSibling,Y=se.firstChild,D=de.nextSibling,Q=D.firstChild;return te.$$click=()=>L(N),s(pe,()=>N.description),s(se,()=>x(N.date),Y),s(se,()=>N.reference,null),s(se,(()=>{var W=ye(()=>!!N.isReconciled);return()=>W()&&(()=>{var me=Ll();return me.firstChild,me.style.setProperty("color","#4caf50"),me.style.setProperty("margin-left","0.5rem"),s(me,()=>e("banking.reconciled"),null),me})()})(),null),s(Q,()=>N.debitAmount>0?"+":"-",null),s(Q,()=>P(N.debitAmount||N.creditAmount),null),s(D,(()=>{var W=ye(()=>!!N.isReconciled);return()=>W()&&v(Le,{variant:"outline",size:"sm",onClick:me=>{me.stopPropagation(),$(N)},style:{"margin-top":"0.5rem"},get children(){return e("banking.unreconcile")}})})(),null),ie(W=>{var me=ge(a()?.id===N.id,N.isReconciled),fe=ne,V=w,re=S,_e=p(N.debitAmount>0);return W.e=u(te,me,W.e),W.t=u(de,fe,W.t),W.a=u(pe,V,W.a),W.o=u(se,re,W.o),W.i=u(Q,_e,W.i),W},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),te})())),X.style.setProperty("margin","0 0 1rem 0"),s(X,()=>e("banking.entryBookRecords"),null),s(X,(()=>{var N=ye(()=>!!(a()&&!a().isReconciled));return()=>N()&&(()=>{var te=IE(),de=te.firstChild,pe=de.nextSibling;return pe.nextSibling,te.style.setProperty("font-weight","400"),te.style.setProperty("color","var(--text-muted)"),te.style.setProperty("margin-left","0.5rem"),s(te,()=>e("banking.clickToReconcile"),pe),te})()})(),null),s(O,(()=>{var N=ye(()=>!!(a()&&!a().isReconciled));return()=>N()?[ye(()=>ye(()=>d().length>0)()&&(()=>{var te=xE(),de=te.firstChild,pe=de.firstChild;return de.nextSibling,te.style.setProperty("margin-bottom","1rem"),te.style.setProperty("padding","0.75rem"),te.style.setProperty("background","#fff3cd"),te.style.setProperty("border-radius","var(--border-radius-sm)"),s(de,()=>e("banking.potentialMatchesFound"),pe),s(te,()=>e("banking.clickRecordToReconcile"),null),te})()),ye(()=>A().map(te=>(d().includes(te),(()=>{var de=pm(),pe=de.firstChild,se=pe.firstChild,Y=se.nextSibling,D=Y.firstChild,Q=pe.nextSibling;return de.$$click=()=>{te.isReconciled||M(te)},s(se,()=>te.description,null),s(se,()=>y(te),null),s(Y,()=>x(te.date),D),s(Y,()=>te.reference,null),s(Y,(()=>{var W=ye(()=>!!te.isReconciled);return()=>W()&&(()=>{var me=Ll();return me.firstChild,me.style.setProperty("color","#4caf50"),me.style.setProperty("margin-left","0.5rem"),s(me,()=>e("banking.reconciled"),null),me})()})(),null),s(Q,()=>te.debitAmount>0?"+":"-",null),s(Q,()=>P(te.debitAmount||te.creditAmount),null),ie(W=>{var me={...ge(!1,te.isReconciled),opacity:te.isReconciled?.6:1,cursor:te.isReconciled?"not-allowed":"pointer"},fe=ne,V=w,re=S,_e=p(te.debitAmount>0);return W.e=u(de,me,W.e),W.t=u(pe,fe,W.t),W.a=u(se,V,W.a),W.o=u(Y,re,W.o),W.i=u(Q,_e,W.i),W},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),de})())))]:A().map(te=>(()=>{var de=pm(),pe=de.firstChild,se=pe.firstChild,Y=se.nextSibling,D=Y.firstChild,Q=pe.nextSibling;return s(se,()=>te.description),s(Y,()=>x(te.date),D),s(Y,()=>te.reference,null),s(Y,(()=>{var W=ye(()=>!!te.isReconciled);return()=>W()&&(()=>{var me=Ll();return me.firstChild,me.style.setProperty("color","#4caf50"),me.style.setProperty("margin-left","0.5rem"),s(me,()=>e("banking.reconciled"),null),me})()})(),null),s(Q,()=>te.debitAmount>0?"+":"-",null),s(Q,()=>P(te.debitAmount||te.creditAmount),null),ie(W=>{var me=ge(!1,te.isReconciled),fe=ne,V=w,re=S,_e=p(te.debitAmount>0);return W.e=u(de,me,W.e),W.t=u(pe,fe,W.t),W.a=u(se,V,W.a),W.o=u(Y,re,W.o),W.i=u(Q,_e,W.i),W},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),de})())})()),s(E,(()=>{var N=ye(()=>!!(a()&&!a().isReconciled));return()=>N()&&(()=>{var te=EE(),de=te.firstChild,pe=de.firstChild,se=de.nextSibling,Y=se.nextSibling;return te.style.setProperty("position","fixed"),te.style.setProperty("bottom","2rem"),te.style.setProperty("right","2rem"),te.style.setProperty("background","var(--surface-color)"),te.style.setProperty("padding","1rem"),te.style.setProperty("border-radius","var(--border-radius)"),te.style.setProperty("box-shadow","var(--shadow-lg)"),te.style.setProperty("border","1px solid var(--border-color)"),te.style.setProperty("max-width","300px"),de.style.setProperty("font-weight","500"),de.style.setProperty("margin-bottom","0.5rem"),s(de,()=>e("banking.selected"),pe),se.style.setProperty("font-size","0.875rem"),se.style.setProperty("margin-bottom","0.5rem"),s(se,()=>a().description),Y.style.setProperty("font-weight","600"),Y.style.setProperty("color","var(--primary-color)"),s(Y,()=>P(a().debitAmount||a().creditAmount)),s(te,v(Le,{variant:"secondary",size:"sm",onClick:()=>{c(null),h([])},style:{"margin-top":"0.5rem"},get children(){return e("banking.clearSelection")}}),null),te})()})(),null),ie(N=>{var te=Z(m()==="all"),de=Z(m()==="unreconciled"),pe=Z(m()==="reconciled"),se=ee,Y=ee;return N.e=u(k,te,N.e),N.t=u(U,de,N.t),N.a=u(he,pe,N.a),N.o=u(K,se,N.o),N.i=u(O,Y,N.i),N},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),E})()};Et(["click"]);var $E=q("<div><div><h2></h2><p></p></div><div>"),kE=q("<div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date>"),RE=q("<div><button></button><button>"),DE=q("<div><br>"),Ni=q("<div>"),NE=q("<div><div></div><div> • </div><div>"),LE=q("<div>: "),ME=q("<div> <!> • <!> "),OE=q("<div>%"),VE=q("<div> of <!> transactions");const BE=()=>{const{t}=ct(),[e,r]=ve(null),[n,o]=ve({start:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[i,a]=ve(!1),[c,d]=ve("overview");Nn(()=>{!e()&&cr.bankAccounts.length>0&&r(cr.bankAccounts[0])});const h={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},m={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},g={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},_=ce=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:ce?"var(--primary-color)":"var(--text-muted)","border-bottom":ce?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),A={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},L=ce=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ce),M=ce=>new Date(ce).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),$=()=>cr.bankAccounts.map(ce=>({value:ce.id,label:`${ce.bankName} - ${ce.accountNumber} (${ce.accountType})`})),ee=(()=>{if(!e())return null;const ce=cr.getBankStatementsByAccount(e().accountId).filter(ne=>ne.date>=n().start&&ne.date<=n().end),Z=cr.getEntryBookRecordsByAccount(e().accountId).filter(ne=>ne.date>=n().start&&ne.date<=n().end),ge=ce.filter(ne=>ne.isReconciled).length;return Z.filter(ne=>ne.isReconciled).length,{totalBankTransactions:ce.length,totalEntryBookRecords:Z.length,reconciledTransactions:ge,unreconciledTransactions:ce.length-ge,reconciliationRate:ce.length>0?ge/ce.length*100:0}})();return v(Lr,{get title(){return t("banking.title")},get children(){return[(()=>{var ce=$E(),Z=ce.firstChild,ge=Z.firstChild,ne=ge.nextSibling,w=Z.nextSibling;return u(ce,h),ge.style.setProperty("margin","0 0 0.5rem 0"),ge.style.setProperty("font-size","1.5rem"),s(ge,()=>t("banking.reconciliation")),ne.style.setProperty("margin","0"),ne.style.setProperty("color","var(--text-muted)"),s(ne,()=>t("banking.compareStatements")),w.style.setProperty("display","flex"),w.style.setProperty("gap","1rem"),s(w,v(Le,{variant:"secondary",onClick:()=>a(!0),get disabled(){return!e()},get children(){return t("banking.importCSV")}}),null),s(w,v(Le,{variant:"primary",get children(){return t("banking.startNewReconciliation")}}),null),ce})(),(()=>{var ce=kE(),Z=ce.firstChild,ge=Z.firstChild,ne=Z.nextSibling,w=ne.firstChild,S=w.nextSibling,p=ne.nextSibling,C=p.firstChild,P=C.nextSibling;return u(ce,m),Z.style.setProperty("flex","1"),ge.style.setProperty("display","block"),ge.style.setProperty("margin-bottom","0.5rem"),ge.style.setProperty("font-weight","500"),s(ge,()=>t("banking.bankAccount")),s(Z,v(gr,{label:"",get value(){return e()?.id||""},onChange:x=>{const y=cr.getBankAccountById(x);r(y||null)},get options(){return $()}}),null),w.style.setProperty("display","block"),w.style.setProperty("margin-bottom","0.5rem"),w.style.setProperty("font-weight","500"),s(w,()=>t("entryBooks.startDate")),S.addEventListener("change",x=>o(y=>({...y,start:x.target.value}))),S.style.setProperty("padding","0.75rem"),S.style.setProperty("border","1px solid var(--border-color)"),S.style.setProperty("border-radius","var(--border-radius-sm)"),S.style.setProperty("font-family","inherit"),C.style.setProperty("display","block"),C.style.setProperty("margin-bottom","0.5rem"),C.style.setProperty("font-weight","500"),s(C,()=>t("entryBooks.endDate")),P.addEventListener("change",x=>o(y=>({...y,end:x.target.value}))),P.style.setProperty("padding","0.75rem"),P.style.setProperty("border","1px solid var(--border-color)"),P.style.setProperty("border-radius","var(--border-radius-sm)"),P.style.setProperty("font-family","inherit"),ie(()=>S.value=n().start),ie(()=>P.value=n().end),ce})(),(()=>{var ce=RE(),Z=ce.firstChild,ge=Z.nextSibling;return u(ce,g),Z.$$click=()=>d("overview"),s(Z,()=>t("common.overview")),ge.$$click=()=>d("reconciliation"),s(ge,()=>t("banking.reconciliation")),ie(ne=>{var w=_(c()==="overview"),S=_(c()==="reconciliation");return ne.e=u(Z,w,ne.e),ne.t=u(ge,S,ne.t),ne},{e:void 0,t:void 0}),ce})(),ye(()=>ye(()=>c()==="overview")()&&(()=>{var ce=Ni();return s(ce,(()=>{var Z=ye(()=>!!e());return()=>Z()&&(()=>{var ge=Ni();return u(ge,A),s(ge,v(Ze,{get title(){return t("banking.bankAccountInfo")},get subtitle(){return t("banking.currentAccountDetails")},get children(){return[(()=>{var ne=NE(),w=ne.firstChild,S=w.nextSibling,p=S.firstChild,C=S.nextSibling;return ne.style.setProperty("margin-bottom","1rem"),w.style.setProperty("font-weight","600"),w.style.setProperty("margin-bottom","0.5rem"),s(w,()=>e().bankName),S.style.setProperty("color","var(--text-muted)"),S.style.setProperty("margin-bottom","0.5rem"),s(S,()=>e().accountNumber,p),s(S,()=>e().accountType,null),C.style.setProperty("font-size","1.25rem"),C.style.setProperty("font-weight","600"),C.style.setProperty("color","var(--primary-color)"),s(C,()=>L(e().currentBalance)),ne})(),ye(()=>ye(()=>!!e().lastReconciledDate)()&&(()=>{var ne=LE(),w=ne.firstChild;return ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("color","var(--text-muted)"),s(ne,()=>t("banking.lastReconciled"),w),s(ne,()=>M(e().lastReconciledDate),null),ne})())]}}),null),s(ge,ee&&[v(Ze,{get title(){return t("banking.bankTransactions")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var ne=Ni();return ne.style.setProperty("font-size","1.5rem"),ne.style.setProperty("font-weight","600"),ne.style.setProperty("color","var(--primary-color)"),ne.style.setProperty("margin-bottom","0.5rem"),s(ne,()=>ee.totalBankTransactions),ne})(),(()=>{var ne=ME(),w=ne.firstChild,S=w.nextSibling,p=S.nextSibling,C=p.nextSibling;return C.nextSibling,ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("color","var(--text-muted)"),s(ne,()=>ee.reconciledTransactions,w),s(ne,()=>t("banking.reconciled"),S),s(ne,()=>ee.unreconciledTransactions,C),s(ne,()=>t("banking.pending"),null),ne})()]}}),v(Ze,{get title(){return t("entryBooks.entryBookRecords")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var ne=Ni();return ne.style.setProperty("font-size","1.5rem"),ne.style.setProperty("font-weight","600"),ne.style.setProperty("color","var(--primary-color)"),ne.style.setProperty("margin-bottom","0.5rem"),s(ne,()=>ee.totalEntryBookRecords),ne})(),(()=>{var ne=Ni();return ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("color","var(--text-muted)"),s(ne,()=>t("banking.bookEntriesForComparison")),ne})()]}}),v(Ze,{get title(){return t("banking.reconciliationRate")},get subtitle(){return t("banking.completionStatus")},get children(){return[(()=>{var ne=OE(),w=ne.firstChild;return ne.style.setProperty("font-size","1.5rem"),ne.style.setProperty("font-weight","600"),ne.style.setProperty("margin-bottom","0.5rem"),s(ne,()=>Math.round(ee.reconciliationRate),w),ie(S=>(S=ee.reconciliationRate>80?"#4caf50":ee.reconciliationRate>50?"#ff9800":"#f44336")!=null?ne.style.setProperty("color",S):ne.style.removeProperty("color")),ne})(),(()=>{var ne=VE(),w=ne.firstChild,S=w.nextSibling;return S.nextSibling,ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("color","var(--text-muted)"),s(ne,()=>ee.reconciledTransactions,w),s(ne,()=>ee.totalBankTransactions,S),ne})()]}})],null),ge})()})(),null),s(ce,v(Ze,{get title(){return t("banking.recentReconciliationSessions")},get subtitle(){return t("banking.latestActivity")},get children(){var Z=DE(),ge=Z.firstChild;return Z.style.setProperty("text-align","center"),Z.style.setProperty("color","var(--text-muted)"),Z.style.setProperty("padding","2rem"),s(Z,()=>t("banking.noRecentSessions"),ge),s(Z,v(Le,{variant:"primary",style:{"margin-top":"1rem"},onClick:()=>d("reconciliation"),get children(){return t("banking.startFirstReconciliation")}}),null),Z}}),null),ce})()),ye(()=>ye(()=>!!(c()==="reconciliation"&&e()))()&&v(TE,{get bankAccountId(){return e().id},get selectedPeriod(){return n()}})),v(wE,{get isOpen(){return i()},onClose:()=>a(!1),get bankAccount(){return e()}})]}})};Et(["click"]);var FE=q("<div><div></div><div>"),Ml=q("<div>"),UE=q("<div> • <!> • <!> "),jE=q("<div><div><div></div><div></div></div><div><div></div><div>"),zE=q("<div><div>:"),qE=q("<div>⚠️ <!>: <!> <!>, <!> "),GE=q("<div><div><div></div><div></div></div><div>"),vm=q("<div> "),HE=q("<div>✓ ");const YE=t=>{const{t:e}=ct(),r={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},n={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},o={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},i={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)","margin-bottom":"0.5rem"},a={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"1rem"},c={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},d={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},h={"max-height":"100px","overflow-y":"auto","border-top":"1px solid var(--border-color)","padding-top":"1rem"},m={display:"flex","justify-content":"space-between","align-items":"center","font-size":"0.875rem","margin-bottom":"0.5rem"},g={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},_=T=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[T],A=T=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(T),L=T=>new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),M=_(t.entry.status),$=Math.abs(t.entry.totalDebit-t.entry.totalCredit)<.01;return v(Ze,{get children(){return[(()=>{var T=FE(),ee=T.firstChild,ce=ee.nextSibling;return u(T,r),u(ee,n),s(ee,()=>t.entry.entryNumber),s(ce,()=>t.entry.status),ie(Z=>u(ce,{...o,background:M.bg,color:M.color},Z)),T})(),(()=>{var T=Ml();return u(T,i),s(T,()=>t.entry.description),T})(),(()=>{var T=UE(),ee=T.firstChild,ce=ee.nextSibling,Z=ce.nextSibling,ge=Z.nextSibling;return ge.nextSibling,u(T,a),s(T,()=>L(t.entry.date),ee),s(T,()=>t.entry.reference||e("journal.noReference","No reference"),ce),s(T,()=>e("journal.createdBy","By"),ge),s(T,()=>t.entry.createdBy,null),T})(),(()=>{var T=jE(),ee=T.firstChild,ce=ee.firstChild,Z=ce.nextSibling,ge=ee.nextSibling,ne=ge.firstChild,w=ne.nextSibling;return u(T,c),ce.style.setProperty("font-size","0.875rem"),ce.style.setProperty("color","var(--text-muted)"),s(ce,()=>e("journal.totalAmount","Total Amount")),u(Z,d),s(Z,()=>A(t.entry.totalDebit)),ge.style.setProperty("text-align","right"),ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("color","var(--text-muted)"),s(ne,()=>e("journal.lines","Lines")),w.style.setProperty("font-weight","600"),s(w,()=>t.entry.lines.length),T})(),ye(()=>!$&&(()=>{var T=qE(),ee=T.firstChild,ce=ee.nextSibling,Z=ce.nextSibling,ge=Z.nextSibling,ne=ge.nextSibling,w=ne.nextSibling,S=w.nextSibling,p=S.nextSibling;return p.nextSibling,T.style.setProperty("padding","0.5rem"),T.style.setProperty("border-radius","var(--border-radius-sm)"),T.style.setProperty("background","#f8d7da"),T.style.setProperty("color","#721c24"),T.style.setProperty("font-size","0.875rem"),T.style.setProperty("margin-bottom","1rem"),s(T,()=>e("journal.entryNotBalancedShort","Entry is not balanced"),ce),s(T,()=>e("journal.debit"),ge),s(T,()=>A(t.entry.totalDebit),w),s(T,()=>e("journal.credit"),p),s(T,()=>A(t.entry.totalCredit),null),T})()),(()=>{var T=zE(),ee=T.firstChild,ce=ee.firstChild;return u(T,h),ee.style.setProperty("font-weight","500"),ee.style.setProperty("margin-bottom","0.5rem"),ee.style.setProperty("font-size","0.875rem"),s(ee,()=>e("journal.accountLines","Account Lines"),ce),s(T,()=>t.entry.lines.slice(0,3).map(Z=>(()=>{var ge=GE(),ne=ge.firstChild,w=ne.firstChild,S=w.nextSibling,p=ne.nextSibling;return u(ge,m),ne.style.setProperty("flex","1"),w.style.setProperty("font-weight","500"),s(w,()=>Z.accountName),S.style.setProperty("font-size","0.75rem"),S.style.setProperty("color","var(--text-muted)"),s(S,()=>Z.description||e("journal.noDescription","No description")),p.style.setProperty("text-align","right"),s(p,(()=>{var C=ye(()=>Z.debitAmount>0);return()=>C()&&(()=>{var P=vm(),x=P.firstChild;return P.style.setProperty("color","#4caf50"),P.style.setProperty("font-weight","500"),s(P,()=>e("journal.debitShort","Dr."),x),s(P,()=>A(Z.debitAmount),null),P})()})(),null),s(p,(()=>{var C=ye(()=>Z.creditAmount>0);return()=>C()&&(()=>{var P=vm(),x=P.firstChild;return P.style.setProperty("color","#f44336"),P.style.setProperty("font-weight","500"),s(P,()=>e("journal.creditShort","Cr."),x),s(P,()=>A(Z.creditAmount),null),P})()})(),null),s(p,(()=>{var C=ye(()=>!!Z.reconciled);return()=>C()&&(()=>{var P=HE();return P.firstChild,P.style.setProperty("font-size","0.75rem"),P.style.setProperty("color","#4caf50"),s(P,()=>e("banking.reconciled","Reconciled"),null),P})()})(),null),ge})()),null),s(T,(()=>{var Z=ye(()=>t.entry.lines.length>3);return()=>Z()&&(()=>{var ge=Ml();return ge.style.setProperty("text-align","center"),ge.style.setProperty("color","var(--text-muted)"),ge.style.setProperty("font-size","0.875rem"),s(ge,()=>e("journal.andMoreLines","... and {count} more lines").replace("{count}",(t.entry.lines.length-3).toString())),ge})()})(),null),T})(),(()=>{var T=Ml();return u(T,g),s(T,v(Le,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.entry),get children(){return e("journal.viewDetails","View Details")}})),T})()]}})},WE=[{id:"je1",entryNumber:"JE-2024-001",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",status:"posted",createdBy:"John Doe",createdAt:"2024-01-15T09:00:00Z",postedAt:"2024-01-15T09:05:00Z",totalDebit:5e3,totalCredit:5e3,lines:[{id:"jel1",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment from ABC Corp",debitAmount:5e3,creditAmount:0,reconciled:!0,reconciledWith:"eb1"},{id:"jel2",accountId:"2001",accountName:"Trade Receivables",description:"Payment received for INV-2024-001",debitAmount:0,creditAmount:5e3}]},{id:"je2",entryNumber:"JE-2024-002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",status:"posted",createdBy:"Jane Smith",createdAt:"2024-01-14T10:00:00Z",postedAt:"2024-01-14T10:15:00Z",totalDebit:250,totalCredit:250,lines:[{id:"jel3",accountId:"5200",accountName:"Office Expenses",description:"Office supplies from Staples",debitAmount:250,creditAmount:0},{id:"jel4",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment to Staples",debitAmount:0,creditAmount:250,reconciled:!0,reconciledWith:"eb2"}]},{id:"je3",entryNumber:"JE-2024-003",date:"2024-01-13",description:"Monthly Rent Payment",reference:"RENT-2024-01",status:"posted",createdBy:"John Doe",createdAt:"2024-01-13T08:00:00Z",postedAt:"2024-01-13T08:30:00Z",totalDebit:2e3,totalCredit:2e3,lines:[{id:"jel5",accountId:"5200",accountName:"Rent Expense",description:"January office rent",debitAmount:2e3,creditAmount:0},{id:"jel6",accountId:"1002",accountName:"Bank - Checking Account",description:"Rent payment",debitAmount:0,creditAmount:2e3,reconciled:!1}]},{id:"je4",entryNumber:"JE-2024-004",date:"2024-01-12",description:"Wire Transfer - Capital Investment",reference:"WIRE-001",status:"posted",createdBy:"Admin",createdAt:"2024-01-12T14:00:00Z",postedAt:"2024-01-12T14:30:00Z",totalDebit:1e4,totalCredit:1e4,lines:[{id:"jel7",accountId:"1002",accountName:"Bank - Checking Account",description:"Wire transfer received",debitAmount:1e4,creditAmount:0,reconciled:!1},{id:"jel8",accountId:"8",accountName:"Owner's Equity",description:"Capital investment",debitAmount:0,creditAmount:1e4}]},{id:"je5",entryNumber:"JE-2024-005",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",status:"posted",createdBy:"HR Manager",createdAt:"2024-01-11T16:00:00Z",postedAt:"2024-01-11T16:30:00Z",totalDebit:3500,totalCredit:3500,lines:[{id:"jel9",accountId:"13",accountName:"Salaries Expense",description:"Monthly salary - John Doe",debitAmount:3500,creditAmount:0},{id:"jel10",accountId:"1002",accountName:"Bank - Checking Account",description:"Salary payment",debitAmount:0,creditAmount:3500,reconciled:!1}]},{id:"je6",entryNumber:"JE-2024-006",date:"2024-01-10",description:"Product Sales - Multiple Customers",reference:"SALES-2024-010",status:"posted",createdBy:"Sales Manager",createdAt:"2024-01-10T11:00:00Z",postedAt:"2024-01-10T11:30:00Z",totalDebit:8500,totalCredit:8500,lines:[{id:"jel11",accountId:"1001",accountName:"Petty Cash",description:"Cash sales",debitAmount:1500,creditAmount:0},{id:"jel12",accountId:"2001",accountName:"Trade Receivables",description:"Credit sales",debitAmount:7e3,creditAmount:0},{id:"jel13",accountId:"10",accountName:"Sales Revenue",description:"Product sales revenue",debitAmount:0,creditAmount:8500}]},{id:"je7",entryNumber:"JE-2024-007",date:"2024-01-09",description:"Inventory Purchase",reference:"PO-2024-002",status:"draft",createdBy:"Warehouse Manager",createdAt:"2024-01-09T15:00:00Z",totalDebit:15e3,totalCredit:15e3,lines:[{id:"jel14",accountId:"3",accountName:"Inventory",description:"Product inventory purchase",debitAmount:15e3,creditAmount:0},{id:"jel15",accountId:"5",accountName:"Accounts Payable",description:"Amount owed to supplier",debitAmount:0,creditAmount:15e3}]},{id:"je8",entryNumber:"JE-2024-008",date:"2024-01-08",description:"Utility Bills Payment",reference:"UTIL-2024-01",status:"posted",createdBy:"Admin",createdAt:"2024-01-08T09:00:00Z",postedAt:"2024-01-08T09:30:00Z",totalDebit:450,totalCredit:450,lines:[{id:"jel16",accountId:"14",accountName:"Operating Expenses",description:"Electricity and water bills",debitAmount:450,creditAmount:0},{id:"jel17",accountId:"1003",accountName:"Bank - Savings Account",description:"Utility payment",debitAmount:0,creditAmount:450}]}],[Or,Ol]=ve(WE),bm=()=>Or().filter(e=>e.status==="posted").flatMap(e=>e.lines.filter(r=>["1001","1002","1003"].includes(r.accountId))).map(e=>{const r=Or().find(n=>n.lines.some(o=>o.id===e.id));return r?{id:`eb_${e.id}`,accountId:e.accountId,date:r.date,description:r.description,reference:r.reference,debitAmount:e.debitAmount,creditAmount:e.creditAmount,category:e.accountName,isReconciled:e.reconciled||!1,reconciledWith:e.reconciledWith,createdAt:r.createdAt}:null}).filter(e=>e!==null),In={get journalEntries(){return Or()},addJournalEntry(t){const e={...t,id:Date.now().toString()};return Ol([...Or(),e]),e},updateJournalEntry(t,e){Ol(Or().map(r=>r.id===t?{...r,...e}:r))},deleteJournalEntry(t){const e=Or().find(r=>r.id===t);if(e&&e.status==="posted")throw new Error("Cannot delete posted journal entries. Void them instead.");Ol(Or().filter(r=>r.id!==t))},voidJournalEntry(t){this.updateJournalEntry(t,{status:"void"})},postJournalEntry(t){const e=Or().find(r=>r.id===t);if(!e)throw new Error("Journal entry not found");if(Math.abs(e.totalDebit-e.totalCredit)>.01)throw new Error("Journal entry is not balanced. Debits must equal credits.");this.updateJournalEntry(t,{status:"posted",postedAt:new Date().toISOString()}),bm()},getJournalEntryById(t){return Or().find(e=>e.id===t)},getJournalEntriesByStatus(t){return Or().filter(e=>e.status===t)},getJournalEntriesByDateRange(t,e){return Or().filter(r=>r.date>=t&&r.date<=e)},getJournalEntriesByAccount(t){return Or().filter(e=>e.lines.some(r=>r.accountId===t))},getNextEntryNumber(){const t=new Date().getFullYear(),r=Or().filter(n=>n.entryNumber.includes(t.toString())).reduce((n,o)=>{const i=parseInt(o.entryNumber.split("-").pop()||"0");return i>n?i:n},0);return`JE-${t}-${String(r+1).padStart(3,"0")}`},validateJournalEntry(t){const e=[];if(t.date||e.push("Date is required"),t.description||e.push("Description is required"),(!t.lines||t.lines.length===0)&&e.push("At least one line item is required"),t.lines){const r=t.lines.reduce((o,i)=>o+(i.debitAmount||0),0),n=t.lines.reduce((o,i)=>o+(i.creditAmount||0),0);Math.abs(r-n)>.01&&e.push(`Entry is not balanced. Debit: ${r}, Credit: ${n}`),t.lines.forEach((o,i)=>{o.accountId||e.push(`Line ${i+1}: Account is required`),o.debitAmount===0&&o.creditAmount===0&&e.push(`Line ${i+1}: Either debit or credit amount must be provided`),o.debitAmount>0&&o.creditAmount>0&&e.push(`Line ${i+1}: Cannot have both debit and credit amounts`)})}return{isValid:e.length===0,errors:e}},getBankRelatedEntries(){return bm()}};var KE=q("<form><div></div><div><div><h4></h4></div><div><div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div></div></div><div><div><strong>: </strong></div><div><strong>: </strong></div><div></div></div></div><div>"),_m=q("<div>");const Eg=t=>{const{t:e}=ct(),[r,n]=ve({entryNumber:"",date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),[o,i]=ve([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),[a,c]=ve(null);Nn(()=>{if(t.isOpen){if(t.editEntry)n({entryNumber:t.editEntry.entryNumber,date:t.editEntry.date,description:t.editEntry.description,reference:t.editEntry.reference,createdBy:t.editEntry.createdBy}),i(t.editEntry.lines.map((Z,ge)=>({...Z,tempId:`line_${Date.now()}_${ge}`})));else{const Z=In.getNextEntryNumber();n({entryNumber:Z,date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),i([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])}c(null)}});const d={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},h={display:"grid","grid-template-columns":"2fr 2fr 1fr 1fr 1fr",gap:"1rem","align-items":"end","margin-bottom":"1rem",padding:"1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},m={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},g=()=>wt.accounts.map(Z=>({value:Z.id,label:`${Z.accountNumber} - ${Z.name}`})),_=(Z,ge)=>{n(ne=>({...ne,[Z]:ge}))},A=(Z,ge,ne)=>{i(w=>w.map(S=>{if(S.tempId===Z){const p={...S,[ge]:ne};if(ge==="accountId"&&typeof ne=="string"){const C=wt.getAccountById(ne);C&&(p.accountName=C.name)}return p}return S}))},L=()=>{i(Z=>[...Z,{tempId:`line_${Date.now()}_${Z.length}`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])},M=Z=>{o().length>2&&i(ge=>ge.filter(ne=>ne.tempId!==Z))},$=()=>{const Z=o().reduce((ne,w)=>ne+(w.debitAmount||0),0),ge=o().reduce((ne,w)=>ne+(w.creditAmount||0),0);return{totalDebit:Z,totalCredit:ge,isBalanced:Math.abs(Z-ge)<.01}},T=Z=>{Z.preventDefault(),c(null);const ge=r(),ne=o(),{totalDebit:w,totalCredit:S,isBalanced:p}=$();if(!ge.description){c(e("forms.descriptionRequired","Description is required"));return}if(ne.length<2){c(e("journal.minTwoLinesRequired","At least 2 line items are required"));return}if(!p){c(e("journal.entryNotBalanced","Entry is not balanced. Debit: ${debit}, Credit: ${credit}").replace("${debit}",`$${w.toFixed(2)}`).replace("${credit}",`$${S.toFixed(2)}`));return}for(let P=0;P<ne.length;P++){const x=ne[P];if(!x.accountId){c(e("journal.lineAccountRequired","Line {lineNumber}: Account is required").replace("{lineNumber}",(P+1).toString()));return}if(x.debitAmount===0&&x.creditAmount===0){c(e("journal.lineAmountRequired","Line {lineNumber}: Either debit or credit amount must be provided").replace("{lineNumber}",(P+1).toString()));return}if((x.debitAmount||0)>0&&(x.creditAmount||0)>0){c(e("journal.lineBothAmounts","Line {lineNumber}: Cannot have both debit and credit amounts").replace("{lineNumber}",(P+1).toString()));return}}const C={entryNumber:ge.entryNumber,date:ge.date,description:ge.description,reference:ge.reference,status:"draft",createdBy:ge.createdBy,createdAt:new Date().toISOString(),totalDebit:w,totalCredit:S,lines:ne.map((P,x)=>{const{tempId:y,...ue}=P;return{id:`jel_${Date.now()}_${x}`,...ue}})};try{t.editEntry?In.updateJournalEntry(t.editEntry.id,C):In.addJournalEntry(C),n({entryNumber:In.getNextEntryNumber(),date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),i([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),t.onClose()}catch(P){c(P instanceof Error?P.message:e("forms.errorOccurred","An error occurred"))}},ee=Z=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Z),ce=$();return v(br,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return ye(()=>!!t.editEntry)()?e("journal.editEntry"):e("journal.addEntry","Add Journal Entry")},get children(){var Z=KE(),ge=Z.firstChild,ne=ge.nextSibling,w=ne.firstChild,S=w.firstChild,p=w.nextSibling,C=p.firstChild,P=C.firstChild,x=P.firstChild,y=P.nextSibling,ue=y.firstChild,J=y.nextSibling,E=J.firstChild,F=J.nextSibling,z=F.firstChild,B=F.nextSibling,k=B.firstChild,U=p.nextSibling,he=U.firstChild,H=he.firstChild,le=H.firstChild,I=he.nextSibling,j=I.firstChild,K=j.firstChild,R=I.nextSibling,X=ne.nextSibling;return Z.addEventListener("submit",T),ge.style.setProperty("display","grid"),ge.style.setProperty("grid-template-columns","1fr 1fr"),ge.style.setProperty("gap","1rem"),s(ge,v(Mt,{get label(){return e("journal.entryNumber")},get value(){return r().entryNumber},onChange:O=>_("entryNumber",O),get disabled(){return!!t.editEntry},required:!0}),null),s(ge,v(Mt,{get label(){return e("common.date")},type:"date",get value(){return r().date},onChange:O=>_("date",O),required:!0}),null),s(Z,v(Mt,{get label(){return e("common.description")},get value(){return r().description},onChange:O=>_("description",O),get placeholder(){return e("journal.enterEntryDescription","Enter journal entry description")},required:!0}),ne),s(Z,v(Mt,{get label(){return e("journal.reference")},get value(){return r().reference},onChange:O=>_("reference",O),get placeholder(){return e("journal.enterReferenceNumber","Enter reference number")}}),ne),ne.style.setProperty("margin-top","2rem"),w.style.setProperty("display","flex"),w.style.setProperty("justify-content","space-between"),w.style.setProperty("align-items","center"),w.style.setProperty("margin-bottom","1rem"),S.style.setProperty("margin","0"),s(S,()=>e("journal.entryLines","Journal Entry Lines")),s(w,v(Le,{type:"button",variant:"secondary",size:"sm",onClick:L,get children(){return e("journal.addLine","Add Line")}}),null),p.style.setProperty("margin-bottom","1rem"),p.style.setProperty("font-size","0.875rem"),p.style.setProperty("color","var(--text-muted)"),C.style.setProperty("display","grid"),C.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1fr"),C.style.setProperty("gap","1rem"),s(x,()=>e("journal.account")),s(ue,()=>e("common.description")),s(E,()=>e("journal.debit")),s(z,()=>e("journal.credit")),s(k,()=>e("common.actions")),s(ne,v(pt,{get each(){return o()},children:O=>(()=>{var N=_m();return u(N,h),s(N,v(gr,{label:"",get value(){return O.accountId||""},onChange:te=>A(O.tempId,"accountId",te),get options(){return g()}}),null),s(N,v(Mt,{label:"",get value(){return O.description||""},onChange:te=>A(O.tempId,"description",te),get placeholder(){return e("journal.lineDescription","Line description")}}),null),s(N,v(Mt,{label:"",type:"number",get value(){return O.debitAmount?.toString()||"0"},onChange:te=>{A(O.tempId,"debitAmount",parseFloat(te)||0),parseFloat(te)>0&&A(O.tempId,"creditAmount",0)},placeholder:"0.00"}),null),s(N,v(Mt,{label:"",type:"number",get value(){return O.creditAmount?.toString()||"0"},onChange:te=>{A(O.tempId,"creditAmount",parseFloat(te)||0),parseFloat(te)>0&&A(O.tempId,"debitAmount",0)},placeholder:"0.00"}),null),s(N,v(Le,{type:"button",variant:"outline",size:"sm",onClick:()=>M(O.tempId),get disabled(){return o().length<=2},get children(){return e("common.remove","Remove")}}),null),N})()}),U),u(U,m),s(H,()=>e("journal.totalDebit","Total Debit"),le),s(H,()=>ee(ce.totalDebit),null),s(j,()=>e("journal.totalCredit","Total Credit"),K),s(j,()=>ee(ce.totalCredit),null),R.style.setProperty("font-weight","600"),s(R,(()=>{var O=ye(()=>!!ce.isBalanced);return()=>O()?`✓ ${e("journal.balanced")}`:`⚠️ ${e("journal.notBalanced","Not Balanced")}`})()),s(Z,(()=>{var O=ye(()=>!!a());return()=>O()&&(()=>{var N=_m();return N.style.setProperty("padding","1rem"),N.style.setProperty("border-radius","var(--border-radius-sm)"),N.style.setProperty("margin-top","1rem"),N.style.setProperty("background","#f8d7da"),N.style.setProperty("color","#721c24"),N.style.setProperty("border","1px solid #f5c6cb"),s(N,a),N})()})(),X),u(X,d),s(X,v(Le,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(X,v(Le,{variant:"primary",type:"submit",get disabled(){return!ce.isBalanced},get children(){return ye(()=>!!t.editEntry)()?e("journal.updateEntry","Update Entry"):e("journal.saveAsDraft","Save as Draft")}}),null),ie(O=>(O=ce.isBalanced?"#4caf50":"#f44336")!=null?R.style.setProperty("color",O):R.style.removeProperty("color")),Z}})};var QE=q("<div><div>⚠️</div><div></div><div></div><div>"),JE=q("<div><div></div><div></div><div></div><div></div><div>"),XE=q("<div><button></button><button> (<!>)</button><button> (<!>/<!>)"),Sm=q("<div>"),ZE=q("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><div><h4></h4><div></div></div><div>"),Vl=q("<div><span></span><span>"),Bl=q("<div><strong>:</strong> "),e2=q("<div><div><div></div><div></div><div></div><div></div><div></div></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div></div></div><div><div><strong>🔗 Reconciliation Summary</strong></div><div><div><div><strong>Total Lines:</strong> </div><div><strong>Reconciled:</strong> </div><div><strong>Unreconciled:</strong> </div></div><div><div><strong>Bank Accounts:</strong> </div><div><strong>Bank Reconciled:</strong> "),t2=q("<div><div><div></div><div></div></div><div></div><div></div><div></div><div>"),r2=q("<div><span>✓ "),n2=q("<span>(<!>)"),o2=q("<div><strong>Bank Pending:</strong> "),i2=q("<div><div>Reconciled Lines:"),s2=q("<div><div>⚠️ Pending Bank Reconciliation:</div><div>Visit Bank Consolidations to reconcile these transactions"),a2=q("<div><div><div><span></span><h3></h3></div><div><div><div></div><div>Total Lines</div></div><div><div></div><div>Reconciled</div></div><div><div></div><div>Pending"),l2=q("<div><h4>✅ Reconciled Lines (<!>)"),c2=q("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div>✓ Matched"),u2=q("<div>→ "),d2=q("<div><h4>⏳ Unreconciled Lines (<!>)"),h2=q("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div>⏳ Pending"),m2=q("<div>Bank account"),f2=q("<div><div>💡 Reconciliation Tip</div><div>This entry has unreconciled bank account transactions. Visit <strong>Bank Consolidations</strong> to match these with bank statements.");const y2=t=>{const{t:e}=ct(),[r,n]=ve("details"),[o,i]=ve(!1),a=Ge(()=>t.entryId?In.getJournalEntryById(t.entryId):null),c={"text-align":"center","margin-bottom":"2rem",position:"relative"},d={position:"absolute",top:"0",right:"0",display:"flex",gap:"0.5rem"},h={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","margin-bottom":"0.5rem"},m={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},g={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},_={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem",display:"inline-block"},A={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},L={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},M={"font-weight":"600",color:"var(--text-primary)"},$={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},T=y=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:y?"var(--primary-color)":"var(--text-muted)","border-bottom":y?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),ee={display:"grid","grid-template-columns":"2fr 2.5fr 1fr 1fr 1.5fr",gap:"1rem",padding:"1rem 0","border-bottom":"1px solid var(--border-color)","align-items":"center"},ce={...ee,"font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","border-bottom":"2px solid var(--border-color)"},Z={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},ge={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},ne=y=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[y],w=y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(y),S=y=>new Date(y).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),p=y=>new Date(y).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),C=()=>{entry.status==="posted"&&!confirm(e("journal.confirmEditPosted","This entry has been posted. Editing will create a new draft copy. Continue?"))||i(!0)},P=()=>{if(a()&&confirm(e("journal.confirmPost","Are you sure you want to post this journal entry? This action cannot be undone.")))try{In.postJournalEntry(a().id)}catch(y){alert(y instanceof Error?y.message:e("forms.errorPostingEntry","An error occurred while posting the entry"))}},x=()=>{a()&&confirm(e("journal.confirmVoid","Are you sure you want to void this journal entry?"))&&In.voidJournalEntry(a().id)};return[v(br,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.entryDetails","Journal Entry Details")},get children(){return ye(()=>!a())()?(()=>{var y=QE(),ue=y.firstChild,J=ue.nextSibling,E=J.nextSibling,F=E.nextSibling;return y.style.setProperty("text-align","center"),y.style.setProperty("padding","3rem"),y.style.setProperty("color","var(--text-muted)"),ue.style.setProperty("font-size","1.5rem"),ue.style.setProperty("margin-bottom","1rem"),J.style.setProperty("font-size","1.1rem"),J.style.setProperty("margin-bottom","0.5rem"),s(J,()=>e("journal.entryNotFound","Entry Not Found")),E.style.setProperty("font-size","0.875rem"),s(E,()=>e("journal.entryNotFoundMessage","The journal entry you're looking for could not be found or may have been deleted.")),F.style.setProperty("margin-top","2rem"),s(F,v(Le,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),y})():(()=>{const y=a(),ue=ne(y.status),J=Math.abs(y.totalDebit-y.totalCredit)<.01;return[(()=>{var E=JE(),F=E.firstChild,z=F.nextSibling,B=z.nextSibling,k=B.nextSibling,U=k.nextSibling;return u(E,c),s(F,v(Le,{variant:"outline",size:"sm",onClick:C,get title(){return e("journal.editEntryTooltip","Edit this journal entry")},get children(){return e("common.edit")}}),null),s(F,(()=>{var he=ye(()=>y.status==="draft");return()=>he()&&v(Le,{variant:"primary",size:"sm",onClick:P,disabled:!J,get title(){return J?e("journal.postEntryTooltip","Post this journal entry"):e("journal.entryMustBeBalanced","Entry must be balanced to post")},get children(){return e("journal.post","Post")}})})(),null),s(F,(()=>{var he=ye(()=>y.status==="posted");return()=>he()&&v(Le,{variant:"outline",size:"sm",onClick:x,style:{color:"#dc3545","border-color":"#dc3545"},get title(){return e("journal.voidEntryTooltip","Void this journal entry")},get children(){return e("entryBooks.void","Void")}})})(),null),u(z,h),s(z,()=>y.entryNumber),u(B,m),s(B,()=>y.description),u(k,g),s(k,()=>w(y.totalDebit)),s(U,()=>y.status),ie(he=>{var H=d,le={..._,background:ue.bg,color:ue.color};return he.e=u(F,H,he.e),he.t=u(U,le,he.t),he},{e:void 0,t:void 0}),E})(),(()=>{var E=XE(),F=E.firstChild,z=F.nextSibling,B=z.firstChild,k=B.nextSibling;k.nextSibling;var U=z.nextSibling,he=U.firstChild,H=he.nextSibling,le=H.nextSibling,I=le.nextSibling;return I.nextSibling,u(E,$),F.$$click=()=>n("details"),s(F,()=>e("common.details")),z.$$click=()=>n("lines"),s(z,()=>e("journal.journalLines","Journal Lines"),B),s(z,()=>y.lines.length,k),U.$$click=()=>n("reconciliation"),s(U,()=>e("banking.reconciliation","Reconciliation"),he),s(U,()=>y.lines.filter(j=>j.reconciled).length,H),s(U,()=>y.lines.length,I),ie(j=>{var K=T(r()==="details"),R=T(r()==="lines"),X=T(r()==="reconciliation");return j.e=u(F,K,j.e),j.t=u(z,R,j.t),j.a=u(U,X,j.a),j},{e:void 0,t:void 0,a:void 0}),E})(),ye(()=>ye(()=>r()==="details")()&&(()=>{var E=ZE(),F=E.firstChild,z=F.firstChild,B=z.nextSibling,k=F.nextSibling,U=k.firstChild,he=U.nextSibling,H=k.nextSibling,le=H.firstChild,I=le.nextSibling,j=H.nextSibling,K=j.firstChild,R=K.nextSibling,X=j.nextSibling,O=X.firstChild,N=O.nextSibling,te=X.nextSibling,de=te.firstChild,pe=de.nextSibling,se=te.nextSibling,Y=se.firstChild,D=Y.nextSibling,Q=se.nextSibling,W=Q.firstChild,me=W.firstChild,fe=me.nextSibling,V=W.nextSibling;return s(z,()=>e("common.date")),s(B,()=>S(y.date)),s(U,()=>e("journal.reference")),s(he,()=>y.reference||e("common.notAvailable","N/A")),s(le,()=>e("journal.totalDebit")),s(I,()=>w(y.totalDebit)),s(K,()=>e("journal.totalCredit")),s(R,()=>w(y.totalCredit)),s(O,()=>e("journal.balanceStatus","Balance Status")),s(N,()=>J?`${e("journal.balanced")} ✓`:`${e("journal.unbalanced","Unbalanced")} (${w(Math.abs(y.totalDebit-y.totalCredit))} ${e("journal.difference","difference")})`),s(de,()=>e("journal.createdBy")),s(pe,()=>y.createdBy),s(Y,()=>e("journal.createdAt","Created At")),s(D,()=>p(y.createdAt)),s(E,(()=>{var re=ye(()=>!!y.postedAt);return()=>re()&&(()=>{var _e=Vl(),Pe=_e.firstChild,ae=Pe.nextSibling;return s(Pe,()=>e("journal.postedAt","Posted At")),s(ae,()=>p(y.postedAt)),ie(be=>{var oe=A,Se=L,Ee=M;return be.e=u(_e,oe,be.e),be.t=u(Pe,Se,be.t),be.a=u(ae,Ee,be.a),be},{e:void 0,t:void 0,a:void 0}),_e})()})(),Q),Q.style.setProperty("margin-top","2rem"),Q.style.setProperty("padding-top","1rem"),Q.style.setProperty("border-top","2px solid var(--border-color)"),W.style.setProperty("display","flex"),W.style.setProperty("justify-content","space-between"),W.style.setProperty("align-items","center"),W.style.setProperty("margin-bottom","1rem"),me.style.setProperty("margin","0"),me.style.setProperty("font-size","1rem"),s(me,()=>e("journal.quickActions","Quick Actions")),fe.style.setProperty("display","flex"),fe.style.setProperty("gap","0.5rem"),s(fe,v(Le,{variant:"primary",size:"sm",onClick:C,get children(){return["✏️ ",ye(()=>e("journal.editEntry"))]}}),null),s(fe,(()=>{var re=ye(()=>y.status==="draft");return()=>re()&&v(Le,{variant:"outline",size:"sm",onClick:P,disabled:!J,style:{"border-color":J?"#4caf50":"#f44336",color:J?"#4caf50":"#f44336"},get children(){return J?`✓ ${e("journal.postEntry","Post Entry")}`:`⚠️ ${e("journal.fixBalance","Fix Balance")}`}})})(),null),s(fe,(()=>{var re=ye(()=>y.status==="posted");return()=>re()&&v(Le,{variant:"outline",size:"sm",onClick:x,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return["🗑️ ",ye(()=>e("journal.voidEntry","Void Entry"))]}})})(),null),V.style.setProperty("padding","1rem"),V.style.setProperty("border-radius","var(--border-radius-sm)"),V.style.setProperty("font-size","0.875rem"),s(V,(()=>{var re=ye(()=>y.status==="draft");return()=>re()&&(()=>{var _e=Bl(),Pe=_e.firstChild,ae=Pe.firstChild;return Pe.nextSibling,s(Pe,()=>e("journal.draftEntry","Draft Entry"),ae),s(_e,()=>e("journal.draftEntryDescription","This entry can be edited and posted."),null),s(_e,()=>!J&&` ⚠️ ${e("journal.entryMustBeBalancedBeforePosting","Entry must be balanced before posting.")}`,null),_e})()})(),null),s(V,(()=>{var re=ye(()=>y.status==="posted");return()=>re()&&(()=>{var _e=Bl(),Pe=_e.firstChild,ae=Pe.firstChild;return Pe.nextSibling,s(Pe,()=>e("journal.postedEntry","Posted Entry"),ae),s(_e,()=>e("journal.postedEntryDescription","This entry has been posted to the general ledger. Editing will create a new draft copy."),null),_e})()})(),null),s(V,(()=>{var re=ye(()=>y.status==="void");return()=>re()&&(()=>{var _e=Bl(),Pe=_e.firstChild,ae=Pe.firstChild;return Pe.nextSibling,s(Pe,()=>e("journal.voidEntry"),ae),s(_e,()=>e("journal.voidEntryDescription","This entry has been voided and cannot be modified."),null),_e})()})(),null),ie(re=>{var _e=A,Pe=L,ae=M,be=A,oe=L,Se=M,Ee=A,xe=L,$e=M,Me=A,We=L,je=M,Ce=A,Ve=L,Ke={...M,color:J?"#4caf50":"#f44336"},He=A,Qe=L,Ie=M,ot=A,et=L,Ct=M,yt=y.status==="draft"?"#fff3cd":y.status==="posted"?"#d4edda":"#f8d7da";return re.e=u(F,_e,re.e),re.t=u(z,Pe,re.t),re.a=u(B,ae,re.a),re.o=u(k,be,re.o),re.i=u(U,oe,re.i),re.n=u(he,Se,re.n),re.s=u(H,Ee,re.s),re.h=u(le,xe,re.h),re.r=u(I,$e,re.r),re.d=u(j,Me,re.d),re.l=u(K,We,re.l),re.u=u(R,je,re.u),re.c=u(X,Ce,re.c),re.w=u(O,Ve,re.w),re.m=u(N,Ke,re.m),re.f=u(te,He,re.f),re.y=u(de,Qe,re.y),re.g=u(pe,Ie,re.g),re.p=u(se,ot,re.p),re.b=u(Y,et,re.b),re.T=u(D,Ct,re.T),yt!==re.A&&((re.A=yt)!=null?V.style.setProperty("background",yt):V.style.removeProperty("background")),re},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),E})()),ye(()=>ye(()=>r()==="lines")()&&(()=>{var E=e2(),F=E.firstChild,z=F.firstChild,B=z.nextSibling,k=B.nextSibling,U=k.nextSibling,he=U.nextSibling,H=F.nextSibling,le=H.firstChild,I=le.firstChild,j=I.firstChild;I.nextSibling;var K=le.nextSibling,R=K.firstChild,X=R.firstChild;R.nextSibling;var O=K.nextSibling,N=H.nextSibling,te=N.firstChild,de=te.nextSibling,pe=de.firstChild,se=pe.firstChild,Y=se.firstChild;Y.nextSibling;var D=se.nextSibling,Q=D.firstChild;Q.nextSibling;var W=D.nextSibling,me=W.firstChild;me.nextSibling;var fe=pe.nextSibling,V=fe.firstChild,re=V.firstChild;re.nextSibling;var _e=V.nextSibling,Pe=_e.firstChild;return Pe.nextSibling,s(z,()=>e("journal.account")),s(B,()=>e("common.description")),s(k,()=>e("journal.debit")),s(U,()=>e("journal.credit")),s(he,()=>e("banking.reconciliation")),s(E,v(pt,{get each(){return y.lines},children:ae=>(()=>{var be=t2(),oe=be.firstChild,Se=oe.firstChild,Ee=Se.nextSibling,xe=oe.nextSibling,$e=xe.nextSibling,Me=$e.nextSibling,We=Me.nextSibling;return Se.style.setProperty("font-weight","500"),s(Se,()=>ae.accountName),Ee.style.setProperty("font-size","0.75rem"),Ee.style.setProperty("color","var(--text-muted)"),s(Ee,()=>wt.getAccountById(ae.accountId)?.accountNumber||ae.accountId),xe.style.setProperty("font-size","0.875rem"),s(xe,()=>ae.description||"-"),$e.style.setProperty("font-weight","600"),s($e,(()=>{var je=ye(()=>ae.debitAmount>0);return()=>je()?w(ae.debitAmount):"-"})()),Me.style.setProperty("font-weight","600"),s(Me,(()=>{var je=ye(()=>ae.creditAmount>0);return()=>je()?w(ae.creditAmount):"-"})()),s(We,(()=>{var je=ye(()=>!!ae.reconciled);return()=>je()?(()=>{var Ce=r2(),Ve=Ce.firstChild;return Ve.firstChild,Ce.style.setProperty("display","flex"),Ce.style.setProperty("align-items","center"),Ce.style.setProperty("gap","0.5rem"),Ce.style.setProperty("color","#4caf50"),Ce.style.setProperty("font-size","0.875rem"),Ve.style.setProperty("font-weight","600"),s(Ve,()=>e("banking.reconciled"),null),s(Ce,(()=>{var Ke=ye(()=>!!ae.reconciledWith);return()=>Ke()&&(()=>{var He=n2(),Qe=He.firstChild,Ie=Qe.nextSibling;return Ie.nextSibling,He.style.setProperty("font-size","0.75rem"),He.style.setProperty("color","var(--text-muted)"),He.style.setProperty("font-style","italic"),s(He,()=>ae.reconciledWith,Ie),He})()})(),null),Ce})():(()=>{var Ce=Sm();return Ce.style.setProperty("color","var(--text-muted)"),Ce.style.setProperty("font-size","0.875rem"),s(Ce,()=>e("banking.notReconciled","Not Reconciled")),Ce})()})()),ie(je=>{var Ce=ee,Ve=ae.debitAmount>0?"#4caf50":"var(--text-muted)",Ke=ae.creditAmount>0?"#f44336":"var(--text-muted)";return je.e=u(be,Ce,je.e),Ve!==je.t&&((je.t=Ve)!=null?$e.style.setProperty("color",Ve):$e.style.removeProperty("color")),Ke!==je.a&&((je.a=Ke)!=null?Me.style.setProperty("color",Ke):Me.style.removeProperty("color")),je},{e:void 0,t:void 0,a:void 0}),be})()}),H),u(H,Z),s(I,()=>e("journal.totalDebit"),j),s(le,()=>w(y.totalDebit),null),s(R,()=>e("journal.totalCredit"),X),s(K,()=>w(y.totalCredit),null),(J?"#4caf50":"#f44336")!=null?O.style.setProperty("color",J?"#4caf50":"#f44336"):O.style.removeProperty("color"),O.style.setProperty("font-weight","600"),s(O,()=>J?`✓ ${e("journal.balanced")}`:`⚠️ ${e("journal.notBalanced","Not Balanced")}`),N.style.setProperty("margin-top","1rem"),N.style.setProperty("padding","1rem"),N.style.setProperty("border-radius","var(--border-radius-sm)"),N.style.setProperty("font-size","0.875rem"),te.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("display","grid"),de.style.setProperty("grid-template-columns","1fr 1fr"),de.style.setProperty("gap","1rem"),se.style.setProperty("margin-bottom","0.25rem"),s(se,()=>y.lines.length,null),D.style.setProperty("margin-bottom","0.25rem"),D.style.setProperty("color","#4caf50"),s(D,()=>y.lines.filter(ae=>ae.reconciled).length,null),W.style.setProperty("color","#f44336"),s(W,()=>y.lines.filter(ae=>!ae.reconciled).length,null),V.style.setProperty("margin-bottom","0.25rem"),s(V,()=>y.lines.filter(ae=>["1001","1002","1003"].includes(ae.accountId)).length,null),_e.style.setProperty("margin-bottom","0.25rem"),_e.style.setProperty("color","#4caf50"),s(_e,()=>y.lines.filter(ae=>["1001","1002","1003"].includes(ae.accountId)&&ae.reconciled).length,null),s(fe,(()=>{var ae=ye(()=>y.lines.filter(be=>["1001","1002","1003"].includes(be.accountId)&&!be.reconciled).length>0);return()=>ae()&&(()=>{var be=o2(),oe=be.firstChild;return oe.nextSibling,be.style.setProperty("color","#f44336"),s(be,()=>y.lines.filter(Se=>["1001","1002","1003"].includes(Se.accountId)&&!Se.reconciled).length,null),be})()})(),null),s(N,(()=>{var ae=ye(()=>y.lines.filter(be=>be.reconciled).length>0);return()=>ae()&&(()=>{var be=i2(),oe=be.firstChild;return be.style.setProperty("margin-top","0.75rem"),be.style.setProperty("padding-top","0.75rem"),be.style.setProperty("border-top","1px solid var(--border-color)"),oe.style.setProperty("margin-bottom","0.5rem"),oe.style.setProperty("font-weight","500"),s(be,()=>y.lines.filter(Se=>Se.reconciled).map(Se=>(()=>{var Ee=Vl(),xe=Ee.firstChild,$e=xe.nextSibling;return Ee.style.setProperty("display","flex"),Ee.style.setProperty("justify-content","space-between"),Ee.style.setProperty("margin-bottom","0.25rem"),Ee.style.setProperty("font-size","0.8rem"),s(xe,()=>Se.accountName),$e.style.setProperty("color","var(--text-muted)"),s($e,()=>Se.reconciledWith?`→ ${Se.reconciledWith}`:"Manual"),Ee})()),null),be})()})(),null),s(N,(()=>{var ae=ye(()=>y.lines.filter(be=>!be.reconciled&&["1001","1002","1003"].includes(be.accountId)).length>0);return()=>ae()&&(()=>{var be=s2(),oe=be.firstChild,Se=oe.nextSibling;return be.style.setProperty("margin-top","0.75rem"),be.style.setProperty("padding-top","0.75rem"),be.style.setProperty("border-top","1px solid var(--border-color)"),oe.style.setProperty("margin-bottom","0.5rem"),oe.style.setProperty("font-weight","500"),oe.style.setProperty("color","#f44336"),s(be,()=>y.lines.filter(Ee=>!Ee.reconciled&&["1001","1002","1003"].includes(Ee.accountId)).map(Ee=>(()=>{var xe=Vl(),$e=xe.firstChild,Me=$e.nextSibling;return xe.style.setProperty("display","flex"),xe.style.setProperty("justify-content","space-between"),xe.style.setProperty("margin-bottom","0.25rem"),xe.style.setProperty("font-size","0.8rem"),xe.style.setProperty("color","#f44336"),s($e,()=>Ee.accountName),s(Me,()=>w(Ee.debitAmount||Ee.creditAmount)),xe})()),Se),Se.style.setProperty("margin-top","0.5rem"),Se.style.setProperty("font-size","0.75rem"),Se.style.setProperty("color","var(--text-muted)"),Se.style.setProperty("font-style","italic"),be})()})(),null),ie(ae=>{var be=ce,oe=y.lines.some(Se=>Se.reconciled)?"#e8f5e8":"#fff3cd";return ae.e=u(F,be,ae.e),oe!==ae.t&&((ae.t=oe)!=null?N.style.setProperty("background",oe):N.style.removeProperty("background")),ae},{e:void 0,t:void 0}),E})()),ye(()=>ye(()=>r()==="reconciliation")()&&(()=>{var E=a2(),F=E.firstChild,z=F.firstChild,B=z.firstChild,k=B.nextSibling,U=z.nextSibling,he=U.firstChild,H=he.firstChild,le=H.nextSibling,I=he.nextSibling,j=I.firstChild,K=j.nextSibling,R=I.nextSibling,X=R.firstChild,O=X.nextSibling;return F.style.setProperty("margin-bottom","1.5rem"),F.style.setProperty("padding","1rem"),F.style.setProperty("border-radius","var(--border-radius)"),F.style.setProperty("border","1px solid var(--border-color)"),z.style.setProperty("display","flex"),z.style.setProperty("align-items","center"),z.style.setProperty("gap","0.5rem"),z.style.setProperty("margin-bottom","1rem"),B.style.setProperty("font-size","1.5rem"),s(B,(()=>{var N=ye(()=>!!y.lines.every(te=>te.reconciled));return()=>N()?"✅":y.lines.some(te=>te.reconciled)?"🔄":"⏳"})()),k.style.setProperty("margin","0"),k.style.setProperty("font-size","1.2rem"),s(k,(()=>{var N=ye(()=>!!y.lines.every(te=>te.reconciled));return()=>N()?"Fully Reconciled":y.lines.some(te=>te.reconciled)?"Partially Reconciled":"Unreconciled"})()),U.style.setProperty("display","grid"),U.style.setProperty("grid-template-columns","1fr 1fr 1fr"),U.style.setProperty("gap","1rem"),he.style.setProperty("text-align","center"),H.style.setProperty("font-size","2rem"),H.style.setProperty("font-weight","700"),H.style.setProperty("color","var(--primary-color)"),s(H,()=>y.lines.length),le.style.setProperty("font-size","0.875rem"),le.style.setProperty("color","var(--text-muted)"),I.style.setProperty("text-align","center"),j.style.setProperty("font-size","2rem"),j.style.setProperty("font-weight","700"),j.style.setProperty("color","#4caf50"),s(j,()=>y.lines.filter(N=>N.reconciled).length),K.style.setProperty("font-size","0.875rem"),K.style.setProperty("color","var(--text-muted)"),R.style.setProperty("text-align","center"),X.style.setProperty("font-size","2rem"),X.style.setProperty("font-weight","700"),X.style.setProperty("color","#f44336"),s(X,()=>y.lines.filter(N=>!N.reconciled).length),O.style.setProperty("font-size","0.875rem"),O.style.setProperty("color","var(--text-muted)"),s(E,(()=>{var N=ye(()=>y.lines.filter(te=>te.reconciled).length>0);return()=>N()&&(()=>{var te=l2(),de=te.firstChild,pe=de.firstChild,se=pe.nextSibling;return se.nextSibling,te.style.setProperty("margin-bottom","1.5rem"),de.style.setProperty("margin","0 0 1rem 0"),de.style.setProperty("font-size","1.1rem"),de.style.setProperty("color","#4caf50"),de.style.setProperty("display","flex"),de.style.setProperty("align-items","center"),de.style.setProperty("gap","0.5rem"),s(de,()=>y.lines.filter(Y=>Y.reconciled).length,se),s(te,()=>y.lines.filter(Y=>Y.reconciled).map(Y=>(()=>{var D=c2(),Q=D.firstChild,W=Q.firstChild,me=W.nextSibling,fe=Q.nextSibling,V=fe.nextSibling,re=V.nextSibling,_e=re.nextSibling,Pe=_e.firstChild;return D.style.setProperty("display","grid"),D.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),D.style.setProperty("gap","1rem"),D.style.setProperty("padding","0.75rem"),D.style.setProperty("margin-bottom","0.5rem"),D.style.setProperty("background","#f0f9f0"),D.style.setProperty("border-radius","var(--border-radius-sm)"),D.style.setProperty("align-items","center"),D.style.setProperty("font-size","0.875rem"),W.style.setProperty("font-weight","500"),s(W,()=>Y.accountName),me.style.setProperty("font-size","0.75rem"),me.style.setProperty("color","var(--text-muted)"),s(me,()=>wt.getAccountById(Y.accountId)?.accountNumber),fe.style.setProperty("color","var(--text-muted)"),s(fe,()=>Y.description||"No description"),V.style.setProperty("font-weight","600"),s(V,(()=>{var ae=ye(()=>Y.debitAmount>0);return()=>ae()?w(Y.debitAmount):"-"})()),re.style.setProperty("font-weight","600"),s(re,(()=>{var ae=ye(()=>Y.creditAmount>0);return()=>ae()?w(Y.creditAmount):"-"})()),_e.style.setProperty("color","#4caf50"),Pe.style.setProperty("font-weight","500"),s(_e,(()=>{var ae=ye(()=>!!Y.reconciledWith);return()=>ae()&&(()=>{var be=u2();return be.firstChild,be.style.setProperty("font-size","0.75rem"),be.style.setProperty("font-style","italic"),s(be,()=>Y.reconciledWith,null),be})()})(),null),ie(ae=>{var be=Y.debitAmount>0?"#4caf50":"var(--text-muted)",oe=Y.creditAmount>0?"#f44336":"var(--text-muted)";return be!==ae.e&&((ae.e=be)!=null?V.style.setProperty("color",be):V.style.removeProperty("color")),oe!==ae.t&&((ae.t=oe)!=null?re.style.setProperty("color",oe):re.style.removeProperty("color")),ae},{e:void 0,t:void 0}),D})()),null),te})()})(),null),s(E,(()=>{var N=ye(()=>y.lines.filter(te=>!te.reconciled).length>0);return()=>N()&&(()=>{var te=d2(),de=te.firstChild,pe=de.firstChild,se=pe.nextSibling;return se.nextSibling,te.style.setProperty("margin-bottom","1.5rem"),de.style.setProperty("margin","0 0 1rem 0"),de.style.setProperty("font-size","1.1rem"),de.style.setProperty("color","#f44336"),de.style.setProperty("display","flex"),de.style.setProperty("align-items","center"),de.style.setProperty("gap","0.5rem"),s(de,()=>y.lines.filter(Y=>!Y.reconciled).length,se),s(te,()=>y.lines.filter(Y=>!Y.reconciled).map(Y=>(()=>{var D=h2(),Q=D.firstChild,W=Q.firstChild,me=W.nextSibling,fe=Q.nextSibling,V=fe.nextSibling,re=V.nextSibling,_e=re.nextSibling,Pe=_e.firstChild;return D.style.setProperty("display","grid"),D.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),D.style.setProperty("gap","1rem"),D.style.setProperty("padding","0.75rem"),D.style.setProperty("margin-bottom","0.5rem"),D.style.setProperty("background","#fff9f0"),D.style.setProperty("border-radius","var(--border-radius-sm)"),D.style.setProperty("align-items","center"),D.style.setProperty("font-size","0.875rem"),D.style.setProperty("border","1px solid #ffe0b3"),W.style.setProperty("font-weight","500"),s(W,()=>Y.accountName),me.style.setProperty("font-size","0.75rem"),me.style.setProperty("color","var(--text-muted)"),s(me,()=>wt.getAccountById(Y.accountId)?.accountNumber),fe.style.setProperty("color","var(--text-muted)"),s(fe,()=>Y.description||"No description"),V.style.setProperty("font-weight","600"),s(V,(()=>{var ae=ye(()=>Y.debitAmount>0);return()=>ae()?w(Y.debitAmount):"-"})()),re.style.setProperty("font-weight","600"),s(re,(()=>{var ae=ye(()=>Y.creditAmount>0);return()=>ae()?w(Y.creditAmount):"-"})()),_e.style.setProperty("color","#f44336"),Pe.style.setProperty("font-weight","500"),s(_e,(()=>{var ae=ye(()=>!!["1001","1002","1003"].includes(Y.accountId));return()=>ae()&&(()=>{var be=m2();return be.style.setProperty("font-size","0.75rem"),be.style.setProperty("font-style","italic"),be})()})(),null),ie(ae=>{var be=Y.debitAmount>0?"#4caf50":"var(--text-muted)",oe=Y.creditAmount>0?"#f44336":"var(--text-muted)";return be!==ae.e&&((ae.e=be)!=null?V.style.setProperty("color",be):V.style.removeProperty("color")),oe!==ae.t&&((ae.t=oe)!=null?re.style.setProperty("color",oe):re.style.removeProperty("color")),ae},{e:void 0,t:void 0}),D})()),null),s(te,(()=>{var Y=ye(()=>y.lines.filter(D=>!D.reconciled&&["1001","1002","1003"].includes(D.accountId)).length>0);return()=>Y()&&(()=>{var D=f2(),Q=D.firstChild,W=Q.nextSibling;return D.style.setProperty("padding","0.75rem"),D.style.setProperty("background","#ffebee"),D.style.setProperty("border-radius","var(--border-radius-sm)"),D.style.setProperty("margin-top","1rem"),D.style.setProperty("border","1px solid #ffcdd2"),Q.style.setProperty("font-weight","500"),Q.style.setProperty("margin-bottom","0.5rem"),Q.style.setProperty("color","#f44336"),W.style.setProperty("font-size","0.875rem"),W.style.setProperty("color","var(--text-muted)"),D})()})(),null),te})()})(),null),ie(N=>(N=y.lines.every(te=>te.reconciled)?"#e8f5e8":y.lines.some(te=>te.reconciled)?"#fff3cd":"#ffebee")!=null?F.style.setProperty("background",N):F.style.removeProperty("background")),E})()),(()=>{var E=Sm();return u(E,ge),s(E,v(Le,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(E,v(Le,{variant:"primary",onClick:C,get children(){return e("journal.editEntry")}}),null),s(E,(()=>{var F=ye(()=>y.status==="draft");return()=>F()&&v(Le,{variant:"outline",onClick:P,disabled:!J,style:{"border-color":"#4caf50",color:J?"#4caf50":"var(--text-muted)"},get children(){return J?e("journal.postEntry","Post Entry"):e("journal.entryNotBalanced","Entry Not Balanced")}})})(),null),s(E,(()=>{var F=ye(()=>y.status==="posted");return()=>F()&&v(Le,{variant:"outline",onClick:x,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return e("journal.voidEntry","Void Entry")}})})(),null),E})()]})()}}),ye(()=>ye(()=>!!a())()&&v(Eg,{get isOpen(){return o()},onClose:()=>{i(!1)},get editEntry(){return a()}}))]};Et(["click"]);var g2=q("<div><div><h2></h2><p></p></div><div>"),Sn=q("<div>"),p2=q("<div> <!> • <!> "),v2=q("<div><div><label></label></div><div><label></label></div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label></div><div>"),b2=q("<div><span>:</span><span> "),Qs=q("<span>: "),_2=q("<div><br>");const S2=()=>{const{t}=ct(),[e,r]=ve(!1),[n,o]=ve(null),[i,a]=ve(!1),[c,d]=ve(null),[h,m]=ve("all"),[g,_]=ve("all"),[A,L]=ve(""),[M,$]=ve(""),[T,ee]=ve("date"),[ce,Z]=ve("desc"),ge={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},ne={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)","flex-wrap":"wrap"},w={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem"},S={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(400px, 1fr))",gap:"1.5rem"},p=()=>[{value:"all",label:t("journal.allEntries","All Entries")},{value:"draft",label:t("journal.draft")},{value:"posted",label:t("journal.posted")},{value:"void",label:t("entryBooks.void","Void")}],C=()=>[{value:"all",label:t("accounts.allAccounts","All Accounts")},...wt.accounts.map(k=>({value:k.id,label:`${k.accountNumber} - ${k.name}`}))],P=()=>[{value:"date",label:t("common.date")},{value:"entryNumber",label:t("journal.entryNumber")},{value:"amount",label:t("common.amount")}],x=()=>{let k=In.journalEntries;return h()!=="all"&&(k=k.filter(U=>U.status===h())),g()!=="all"&&(k=k.filter(U=>U.lines.some(he=>he.accountId===g()))),A()&&(k=k.filter(U=>U.date>=A())),M()&&(k=k.filter(U=>U.date<=M())),k=[...k].sort((U,he)=>{let H=0;switch(T()){case"date":H=new Date(U.date).getTime()-new Date(he.date).getTime();break;case"entryNumber":H=U.entryNumber.localeCompare(he.entryNumber);break;case"amount":H=U.totalDebit-he.totalDebit;break}return ce()==="asc"?H:-H}),k},y=()=>{const k=In.journalEntries,U=k.filter(K=>K.status==="draft"),he=k.filter(K=>K.status==="posted"),H=k.filter(K=>K.status==="void"),le=he.reduce((K,R)=>K+R.totalDebit,0),I=he.reduce((K,R)=>K+R.totalCredit,0),j=k.filter(K=>K.lines.some(R=>["1001","1002","1003"].includes(R.accountId)&&!R.reconciled)).length;return{totalEntries:k.length,draftEntries:U.length,postedEntries:he.length,voidEntries:H.length,totalDebit:le,totalCredit:I,unreconciledEntries:j}},ue=k=>{d(k.id),a(!0)},J=()=>{o(null),r(!0)},E=()=>{r(!1),o(null)},F=k=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(k),z=y(),B=x();return v(Lr,{get title(){return t("entryBooks.title")},get children(){return[(()=>{var k=g2(),U=k.firstChild,he=U.firstChild,H=he.nextSibling,le=U.nextSibling;return u(k,ge),he.style.setProperty("margin","0 0 0.5rem 0"),he.style.setProperty("font-size","1.5rem"),s(he,()=>t("journal.title")),H.style.setProperty("margin","0"),H.style.setProperty("color","var(--text-muted)"),s(H,()=>t("entryBooks.subtitle","Manage accounting entries and general ledger records")),le.style.setProperty("display","flex"),le.style.setProperty("gap","1rem"),s(le,v(Le,{variant:"secondary",onClick:()=>window.location.href="/bank-consolidations",get children(){return t("entryBooks.viewReconciliation","View Reconciliation")}}),null),s(le,v(Le,{variant:"primary",onClick:J,get children(){return t("journal.addEntry","Add Journal Entry")}}),null),k})(),(()=>{var k=Sn();return u(k,w),s(k,v(Ze,{get title(){return t("entryBooks.totalEntries","Total Entries")},get subtitle(){return t("entryBooks.allJournalEntries","All journal entries")},get children(){return[(()=>{var U=Sn();return U.style.setProperty("font-size","1.5rem"),U.style.setProperty("font-weight","600"),U.style.setProperty("color","var(--primary-color)"),U.style.setProperty("margin-bottom","0.5rem"),s(U,()=>z.totalEntries),U})(),(()=>{var U=p2(),he=U.firstChild,H=he.nextSibling,le=H.nextSibling,I=le.nextSibling;return I.nextSibling,U.style.setProperty("font-size","0.875rem"),U.style.setProperty("color","var(--text-muted)"),s(U,()=>z.postedEntries,he),s(U,()=>t("journal.posted").toLowerCase(),H),s(U,()=>z.draftEntries,I),s(U,()=>t("journal.draft").toLowerCase(),null),s(U,(()=>{var j=ye(()=>z.voidEntries>0);return()=>j()&&` • ${z.voidEntries} ${t("entryBooks.void","void").toLowerCase()}`})(),null),U})()]}}),null),s(k,v(Ze,{get title(){return t("journal.totalDebits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var U=Sn();return U.style.setProperty("font-size","1.5rem"),U.style.setProperty("font-weight","600"),U.style.setProperty("color","#4caf50"),U.style.setProperty("margin-bottom","0.5rem"),s(U,()=>F(z.totalDebit)),U})(),(()=>{var U=Sn();return U.style.setProperty("font-size","0.875rem"),U.style.setProperty("color","var(--text-muted)"),s(U,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",z.postedEntries.toString())),U})()]}}),null),s(k,v(Ze,{get title(){return t("journal.totalCredits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var U=Sn();return U.style.setProperty("font-size","1.5rem"),U.style.setProperty("font-weight","600"),U.style.setProperty("color","#f44336"),U.style.setProperty("margin-bottom","0.5rem"),s(U,()=>F(z.totalCredit)),U})(),(()=>{var U=Sn();return U.style.setProperty("font-size","0.875rem"),U.style.setProperty("color","var(--text-muted)"),s(U,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",z.postedEntries.toString())),U})()]}}),null),s(k,v(Ze,{get title(){return t("banking.unreconciled","Unreconciled")},get subtitle(){return t("banking.title")},get children(){return[(()=>{var U=Sn();return U.style.setProperty("font-size","1.5rem"),U.style.setProperty("font-weight","600"),U.style.setProperty("margin-bottom","0.5rem"),s(U,()=>z.unreconciledEntries),ie(he=>(he=z.unreconciledEntries>0?"#ff9800":"#4caf50")!=null?U.style.setProperty("color",he):U.style.removeProperty("color")),U})(),(()=>{var U=Sn();return U.style.setProperty("font-size","0.875rem"),U.style.setProperty("color","var(--text-muted)"),s(U,(()=>{var he=ye(()=>z.unreconciledEntries>0);return()=>he()?t("entryBooks.needBankReconciliation","Need bank reconciliation"):t("entryBooks.allReconciled","All reconciled")})()),U})()]}}),null),k})(),(()=>{var k=v2(),U=k.firstChild,he=U.firstChild,H=U.nextSibling,le=H.firstChild,I=H.nextSibling,j=I.firstChild,K=I.nextSibling,R=K.firstChild,X=R.nextSibling,O=K.nextSibling,N=O.firstChild,te=N.nextSibling,de=O.nextSibling,pe=de.firstChild,se=de.nextSibling;return u(k,ne),U.style.setProperty("min-width","150px"),he.style.setProperty("display","block"),he.style.setProperty("margin-bottom","0.5rem"),he.style.setProperty("font-weight","500"),he.style.setProperty("font-size","0.875rem"),s(he,()=>t("common.status")),s(U,v(gr,{label:"",get value(){return h()},onChange:m,get options(){return p()}}),null),H.style.setProperty("min-width","200px"),le.style.setProperty("display","block"),le.style.setProperty("margin-bottom","0.5rem"),le.style.setProperty("font-weight","500"),le.style.setProperty("font-size","0.875rem"),s(le,()=>t("journal.account")),s(H,v(gr,{label:"",get value(){return g()},onChange:_,get options(){return C()}}),null),I.style.setProperty("min-width","120px"),j.style.setProperty("display","block"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("font-weight","500"),j.style.setProperty("font-size","0.875rem"),s(j,()=>t("entryBooks.sortBy","Sort By")),s(I,v(gr,{label:"",get value(){return T()},onChange:ee,get options(){return P()}}),null),K.style.setProperty("min-width","130px"),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),R.style.setProperty("font-size","0.875rem"),s(R,()=>t("entryBooks.fromDate","From Date")),X.addEventListener("change",Y=>L(Y.target.value)),X.style.setProperty("padding","0.75rem"),X.style.setProperty("border","1px solid var(--border-color)"),X.style.setProperty("border-radius","var(--border-radius-sm)"),X.style.setProperty("font-family","inherit"),X.style.setProperty("width","100%"),O.style.setProperty("min-width","130px"),N.style.setProperty("display","block"),N.style.setProperty("margin-bottom","0.5rem"),N.style.setProperty("font-weight","500"),N.style.setProperty("font-size","0.875rem"),s(N,()=>t("entryBooks.toDate","To Date")),te.addEventListener("change",Y=>$(Y.target.value)),te.style.setProperty("padding","0.75rem"),te.style.setProperty("border","1px solid var(--border-color)"),te.style.setProperty("border-radius","var(--border-radius-sm)"),te.style.setProperty("font-family","inherit"),te.style.setProperty("width","100%"),de.style.setProperty("min-width","100px"),pe.style.setProperty("display","block"),pe.style.setProperty("margin-bottom","0.5rem"),pe.style.setProperty("font-weight","500"),pe.style.setProperty("font-size","0.875rem"),s(pe,()=>t("entryBooks.order","Order")),s(de,v(gr,{label:"",get value(){return ce()},onChange:Z,get options(){return[{value:"desc",label:t("entryBooks.newest","Newest")},{value:"asc",label:t("entryBooks.oldest","Oldest")}]}}),null),se.style.setProperty("display","flex"),se.style.setProperty("align-items","end"),se.style.setProperty("gap","0.5rem"),s(se,v(Le,{variant:"outline",size:"sm",onClick:()=>{m("all"),_("all"),L(""),$(""),ee("date"),Z("desc")},get children(){return t("entryBooks.resetFilters","Reset Filters")}})),ie(()=>X.value=A()),ie(()=>te.value=M()),k})(),ye(()=>ye(()=>!!(h()!=="all"||g()!=="all"||A()||M()))()&&(()=>{var k=b2(),U=k.firstChild,he=U.firstChild,H=U.nextSibling,le=H.firstChild;return k.style.setProperty("display","flex"),k.style.setProperty("gap","0.5rem"),k.style.setProperty("align-items","center"),k.style.setProperty("margin-bottom","1rem"),k.style.setProperty("padding","0.75rem"),k.style.setProperty("background","var(--surface-color)"),k.style.setProperty("border-radius","var(--border-radius-sm)"),k.style.setProperty("border","1px solid var(--border-color)"),U.style.setProperty("font-size","0.875rem"),U.style.setProperty("font-weight","500"),s(U,()=>t("entryBooks.activeFilters","Active filters"),he),s(k,(()=>{var I=ye(()=>h()!=="all");return()=>I()&&(()=>{var j=Qs(),K=j.firstChild;return j.style.setProperty("padding","0.25rem 0.5rem"),j.style.setProperty("background","var(--primary-color)"),j.style.setProperty("color","white"),j.style.setProperty("border-radius","12px"),j.style.setProperty("font-size","0.75rem"),s(j,()=>t("common.status"),K),s(j,h,null),j})()})(),H),s(k,(()=>{var I=ye(()=>g()!=="all");return()=>I()&&(()=>{var j=Qs(),K=j.firstChild;return j.style.setProperty("padding","0.25rem 0.5rem"),j.style.setProperty("background","var(--primary-color)"),j.style.setProperty("color","white"),j.style.setProperty("border-radius","12px"),j.style.setProperty("font-size","0.75rem"),s(j,()=>t("journal.account"),K),s(j,()=>wt.getAccountById(g())?.name||t("common.unknown","Unknown"),null),j})()})(),H),s(k,(()=>{var I=ye(()=>!!A());return()=>I()&&(()=>{var j=Qs(),K=j.firstChild;return j.style.setProperty("padding","0.25rem 0.5rem"),j.style.setProperty("background","var(--primary-color)"),j.style.setProperty("color","white"),j.style.setProperty("border-radius","12px"),j.style.setProperty("font-size","0.75rem"),s(j,()=>t("entryBooks.from","From"),K),s(j,A,null),j})()})(),H),s(k,(()=>{var I=ye(()=>!!M());return()=>I()&&(()=>{var j=Qs(),K=j.firstChild;return j.style.setProperty("padding","0.25rem 0.5rem"),j.style.setProperty("background","var(--primary-color)"),j.style.setProperty("color","white"),j.style.setProperty("border-radius","12px"),j.style.setProperty("font-size","0.75rem"),s(j,()=>t("entryBooks.to","To"),K),s(j,M,null),j})()})(),H),H.style.setProperty("margin-left","auto"),H.style.setProperty("font-size","0.875rem"),H.style.setProperty("color","var(--text-muted)"),s(H,()=>B.length,le),s(H,()=>t("entryBooks.entriesFound","{count} entries found").replace("{count}",B.length.toString()),null),k})()),ye(()=>ye(()=>B.length===0)()?v(Ze,{get title(){return t("entryBooks.noJournalEntries","No Journal Entries")},get subtitle(){return t("entryBooks.startByCreating","Start by creating your first entry")},get children(){var k=_2(),U=k.firstChild;return k.style.setProperty("text-align","center"),k.style.setProperty("color","var(--text-muted)"),k.style.setProperty("padding","2rem"),s(k,()=>t("entryBooks.noEntriesMatch","No journal entries match your current filters."),U),s(k,v(Le,{variant:"primary",style:{"margin-top":"1rem"},onClick:J,get children(){return t("entryBooks.createFirstEntry","Create First Entry")}}),null),k}}):(()=>{var k=Sn();return u(k,S),s(k,v(pt,{each:B,children:U=>v(YE,{entry:U,onViewDetails:ue})})),k})()),v(Eg,{get isOpen(){return e()},onClose:E,get editEntry(){return n()}}),v(y2,{get isOpen(){return i()},onClose:()=>{a(!1),d(null)},get entryId(){return c()}})]}})};var Pm=q("<div>"),P2=q("<div>$23,450"),w2=q("<div>$87,230"),C2=q("<div>$5,670"),A2=q("<div><div><div><div>INV-2024-001</div><div>Acme Corporation</div></div><div>$5,250.00</div><div></div></div><div><div><div>INV-2024-002</div><div>Tech Solutions Inc.</div></div><div>$3,750.00</div><div></div></div><div><div><div>INV-2024-003</div><div>Global Services Ltd.</div></div><div>$8,900.00</div><div></div></div><div><div><div>INV-2024-004</div><div>StartUp Co.</div></div><div>$2,100.00</div><div>");const I2=()=>{const{t}=ct(),e={display:"flex","flex-direction":"column",gap:"1rem"},r={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},n={flex:"1"},o={"font-weight":"600","margin-bottom":"0.25rem"},i={color:"var(--text-muted)","font-size":"0.875rem"},a={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},c=h=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:h==="paid"?"#d4edda":h==="pending"?"#fff3cd":"#f8d7da",color:h==="paid"?"#155724":h==="pending"?"#856404":"#721c24"}),d={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"};return v(Lr,{get title(){return t("invoices.title","Invoices")},get children(){return[(()=>{var h=Pm();return h.style.setProperty("margin-bottom","2rem"),s(h,v(Le,{variant:"primary",get children(){return t("invoices.createNew","Create New Invoice")}})),h})(),(()=>{var h=Pm();return u(h,d),s(h,v(Ze,{get title(){return t("invoices.totalOutstanding","Total Outstanding")},get subtitle(){return t("invoices.unpaidInvoices","Unpaid invoices")},get children(){var m=P2();return m.style.setProperty("font-size","1.5rem"),m.style.setProperty("font-weight","600"),m.style.setProperty("color","var(--primary-color)"),m}}),null),s(h,v(Ze,{get title(){return t("invoices.thisMonth","This Month")},get subtitle(){return t("invoices.revenueCollected","Revenue collected")},get children(){var m=w2();return m.style.setProperty("font-size","1.5rem"),m.style.setProperty("font-weight","600"),m.style.setProperty("color","var(--primary-color)"),m}}),null),s(h,v(Ze,{get title(){return t("invoices.overdue","Overdue")},get subtitle(){return t("invoices.pastDueInvoices","Past due invoices")},get children(){var m=C2();return m.style.setProperty("font-size","1.5rem"),m.style.setProperty("font-weight","600"),m.style.setProperty("color","var(--primary-color)"),m}}),null),h})(),v(Ze,{get title(){return t("invoices.recentInvoices","Recent Invoices")},get subtitle(){return t("invoices.latestBillingActivity","Latest billing activity")},get children(){var h=A2(),m=h.firstChild,g=m.firstChild,_=g.firstChild,A=_.nextSibling,L=g.nextSibling,M=L.nextSibling,$=m.nextSibling,T=$.firstChild,ee=T.firstChild,ce=ee.nextSibling,Z=T.nextSibling,ge=Z.nextSibling,ne=$.nextSibling,w=ne.firstChild,S=w.firstChild,p=S.nextSibling,C=w.nextSibling,P=C.nextSibling,x=ne.nextSibling,y=x.firstChild,ue=y.firstChild,J=ue.nextSibling,E=y.nextSibling,F=E.nextSibling;return u(h,e),s(M,()=>t("invoices.paid","Paid")),s(ge,()=>t("invoices.pending","Pending")),s(P,()=>t("invoices.overdue","Overdue")),s(F,()=>t("invoices.paid","Paid")),ie(z=>{var B=r,k=n,U=o,he=i,H=a,le=c("paid"),I=r,j=n,K=o,R=i,X=a,O=c("pending"),N=r,te=n,de=o,pe=i,se=a,Y=c("overdue"),D=r,Q=n,W=o,me=i,fe=a,V=c("paid");return z.e=u(m,B,z.e),z.t=u(g,k,z.t),z.a=u(_,U,z.a),z.o=u(A,he,z.o),z.i=u(L,H,z.i),z.n=u(M,le,z.n),z.s=u($,I,z.s),z.h=u(T,j,z.h),z.r=u(ee,K,z.r),z.d=u(ce,R,z.d),z.l=u(Z,X,z.l),z.u=u(ge,O,z.u),z.c=u(ne,N,z.c),z.w=u(w,te,z.w),z.m=u(S,de,z.m),z.f=u(p,pe,z.f),z.y=u(C,se,z.y),z.g=u(P,Y,z.g),z.p=u(x,D,z.p),z.b=u(y,Q,z.b),z.T=u(ue,W,z.T),z.A=u(J,me,z.A),z.O=u(E,fe,z.O),z.I=u(F,V,z.I),z},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0}),h}})]}})};var wm=q("<div>"),x2=q("<div><div><div><strong>Display Name:</strong> </div><div><strong>UID:</strong> </div></div><div><strong>Created:</strong> "),E2=q("<div><h3>Store Access</h3><div></div><div>No store access granted"),T2=q("<div><h3>Permissions</h3><div>"),$2=q('<div><div><input type=text placeholder="Search users..."></div><div>'),k2=q("<div>⚠️ You need administrator privileges to access this page."),R2=q("<div>Loading users..."),D2=q("<div><div></div><div></div><div> stores"),N2=q("<div>Select a user to view and edit their profile"),L2=q("<div><input type=checkbox><label>"),M2=q("<div><input type=checkbox><div><div></div><div>");const O2=()=>{const[t,e]=ve([]),[r,n]=ve(null),[o,i]=ve(!1),[a,c]=ve(!1),[d,h]=ve(""),[m,g]=ve(null),_=[{id:"YY_8802",name:"Store 8802"},{id:"YY_8803",name:"Store 8803"},{id:"YY_8804",name:"Store 8804"},{id:"YY_8805",name:"Store 8805"},{id:"YY_8816",name:"Store 8816"},{id:"YY_8818",name:"Store 8818"},{id:"YY_8847",name:"Store 8847"},{id:"YY_3251",name:"Store 3251"},{id:"YY_32",name:"Store 32"},{id:"YY_76",name:"Store 76"},{id:"YY_79",name:"Store 79"},{id:"YY_8635",name:"Store 8635"},{id:"YY_8665",name:"Store 8665"},{id:"YY_8901",name:"Store 8901"}],A=[{key:"AccountAccess",label:"Account Access",description:"Access to accounting features"},{key:"BankingAccess",label:"Banking Access",description:"Access to banking operations"},{key:"InventoryAccess",label:"Inventory Access",description:"Access to inventory management"},{key:"JournalAccess",label:"Journal Access",description:"Access to journal entries"},{key:"inventoryDownsection",label:"Inventory Downsection",description:"Access to inventory downsection"},{key:"onlyRead",label:"Read Only",description:"Limited to read-only access"},{key:"read_write",label:"Read/Write",description:"Full read and write permissions"},{key:"isAdmin",label:"Administrator",description:"Full system administration rights"}];let L={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,invoiceAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1};Hr(async()=>{await M()});const M=async()=>{try{i(!0);const y=zP(Pc,"users"),ue=rw(y,nw("createdAt","desc")),J=await lw(ue),E=[];J.forEach(F=>{let z=F.data();Object.keys(L).map(B=>{let k=L?.[B];z.hasOwnProperty(B)||(z[B]=k)}),E.push({uid:F.id,...z})}),e(E)}catch(y){console.error("Error loading users:",y),g({type:"error",text:"Failed to load users"})}finally{i(!1)}},$=Ge(()=>{const y=d().toLowerCase();return y?t().filter(ue=>ue.email?.toLowerCase().includes(y)||ue.displayName?.toLowerCase().includes(y)||ue.uid?.toLowerCase().includes(y)):t()}),T=y=>{r()&&n(ue=>({...ue,stores:{...ue.stores,[y]:!ue.stores[y]}}))},ee=y=>{r()&&n(ue=>({...ue,[y]:!ue[y]}))};Ge(()=>r()?r().stores&&Object.values(r().stores).some(y=>y):!1);const ce=async()=>{if(r())try{c(!0),g(null);const y=hg(Pc,"users",r().uid);let ue={stores:r().stores,AccountAccess:r().AccountAccess,BankingAccess:r().BankingAccess,InventoryAccess:r().InventoryAccess,JournalAccess:r().JournalAccess,inventoryDownsection:r().inventoryDownsection,onlyRead:r().onlyRead,read_write:r().read_write,isAdmin:r().isAdmin||!1};await Pg(y,ue),e(J=>J.map(E=>E.uid===r().uid?r():E)),g({type:"success",text:"User profile updated successfully"})}catch(y){console.error("Error saving user profile:",y),g({type:"error",text:"Failed to save user profile"})}finally{c(!1)}},Z={display:"grid","grid-template-columns":"350px 1fr",gap:"2rem",height:"calc(100vh - 200px)"},ge={"max-height":"100%","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)",background:"var(--surface-color)"},ne=y=>({padding:"1rem","border-bottom":"1px solid var(--border-color)",cursor:"pointer",background:y?"var(--primary-color-light)":"transparent",transition:"background 0.2s"}),w={padding:"0.75rem",border:"none","border-bottom":"1px solid var(--border-color)",background:"var(--surface-color)",width:"100%","font-size":"1rem"},S={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1rem"},p={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(200px, 1fr))",gap:"0.75rem"},C={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",transition:"all 0.2s"},P=y=>({padding:"1rem","margin-bottom":"1rem","border-radius":"var(--border-radius)",background:y==="success"?"#d4edda":"#f8d7da",color:y==="success"?"#155724":"#721c24",border:`1px solid ${y==="success"?"#c3e6cb":"#f5c6cb"}`}),x=Ge(()=>Pt.state.profile?.isAdmin===!0);return v(Lr,{title:"User Profile Administration",get children(){return v(Ne,{get when(){return x()},get fallback(){return v(Ze,{get children(){var y=k2();return y.style.setProperty("text-align","center"),y.style.setProperty("padding","2rem"),y.style.setProperty("color","var(--text-muted)"),y}})},get children(){var y=$2(),ue=y.firstChild,J=ue.firstChild,E=ue.nextSibling;return u(y,Z),u(ue,ge),J.$$input=F=>h(F.currentTarget.value),u(J,w),s(ue,v(Ne,{get when(){return!o()},get fallback(){return(()=>{var F=R2();return F.style.setProperty("padding","2rem"),F.style.setProperty("text-align","center"),F})()},get children(){return v(pt,{get each(){return $()},children:F=>(()=>{var z=D2(),B=z.firstChild,k=B.nextSibling,U=k.nextSibling,he=U.firstChild;return z.$$click=()=>n(F),B.style.setProperty("font-weight","600"),s(B,()=>F.displayName||"No Name"),k.style.setProperty("font-size","0.875rem"),k.style.setProperty("color","var(--text-muted)"),s(k,()=>F.email),U.style.setProperty("font-size","0.75rem"),U.style.setProperty("color","var(--text-muted)"),U.style.setProperty("margin-top","0.25rem"),s(U,()=>F.isAdmin&&"👑 Admin • ",he),s(U,()=>Object.values(F.stores||{}).filter(Boolean).length,he),ie(H=>u(z,ne(r()?.uid===F.uid),H)),z})()})}}),null),s(E,v(Ne,{get when(){return r()},get fallback(){return v(Ze,{get children(){var F=N2();return F.style.setProperty("text-align","center"),F.style.setProperty("padding","2rem"),F.style.setProperty("color","var(--text-muted)"),F}})},get children(){return[v(Ne,{get when(){return m()},get children(){var F=wm();return s(F,()=>m().text),ie(z=>u(F,P(m().type),z)),F}}),v(Ze,{title:"User Information",get subtitle(){return r().email},get children(){return[(()=>{var F=x2(),z=F.firstChild,B=z.firstChild,k=B.firstChild;k.nextSibling;var U=B.nextSibling,he=U.firstChild;he.nextSibling;var H=z.nextSibling,le=H.firstChild;return le.nextSibling,F.style.setProperty("margin-bottom","2rem"),z.style.setProperty("display","flex"),z.style.setProperty("justify-content","space-between"),z.style.setProperty("margin-bottom","1rem"),s(B,()=>r().displayName||"Not set",null),s(U,()=>r().uid,null),s(H,()=>new Date(r().createdAt?.toDate?.()||r().createdAt).toLocaleDateString(),null),F})(),(()=>{var F=E2(),z=F.firstChild,B=z.nextSibling,k=B.nextSibling;return F.style.setProperty("margin-bottom","2rem"),z.style.setProperty("margin-bottom","1rem"),u(B,p),s(B,v(pt,{each:_,children:U=>{let he=De.getLocationById(U?.id);return(()=>{var H=L2(),le=H.firstChild,I=le.nextSibling;return H.$$click=()=>T(U?.id),le.style.setProperty("cursor","pointer"),I.style.setProperty("cursor","pointer"),I.style.setProperty("user-select","none"),s(I,()=>he?.name),ie(j=>u(H,{...C,background:r().stores?.[U?.id]?"var(--primary-color-light)":"transparent"},j)),ie(()=>le.checked=r().stores?.[U?.id]||!1),H})()}})),k.style.setProperty("margin-top","0.5rem"),k.style.setProperty("font-size","0.875rem"),k.style.setProperty("color","var(--text-muted)"),F})(),(()=>{var F=T2(),z=F.firstChild,B=z.nextSibling;return F.style.setProperty("margin-bottom","2rem"),z.style.setProperty("margin-bottom","1rem"),u(B,S),s(B,v(pt,{each:A,children:k=>(()=>{var U=M2(),he=U.firstChild,H=he.nextSibling,le=H.firstChild,I=le.nextSibling;return U.$$click=()=>ee(k.key),he.style.setProperty("cursor","pointer"),H.style.setProperty("flex","1"),H.style.setProperty("cursor","pointer"),H.style.setProperty("user-select","none"),le.style.setProperty("font-weight","500"),s(le,()=>k.label),I.style.setProperty("font-size","0.75rem"),I.style.setProperty("color","var(--text-muted)"),s(I,()=>k.description),ie(j=>u(U,{...C,background:r()[k.key]?"var(--primary-color-light)":"transparent"},j)),ie(()=>he.checked=!!r()[k.key]),U})()})),F})(),(()=>{var F=wm();return F.style.setProperty("display","flex"),F.style.setProperty("gap","1rem"),F.style.setProperty("justify-content","flex-end"),s(F,v(Le,{variant:"secondary",onClick:()=>n(null),children:"Cancel"}),null),s(F,v(Le,{variant:"primary",onClick:ce,get disabled(){return a()},get children(){return a()?"Saving...":"Save Changes"}}),null),F})()]}})]}})),ie(()=>J.value=d()),y}})}})};Et(["input","click"]);var V2=q("<div><main>");const B2=t=>[v(Jw,{}),ye(()=>t.children)],F2=()=>v(xw,{get children(){var t=V2(),e=t.firstChild;return s(e,v(Qp,{root:B2,get children(){return[v(Kr,{path:"/",component:rx}),v(Kr,{path:"/accounts",component:()=>v(rn,{permission:"AccountAccess",featureName:"Accounts",get children(){return v(zx,{})}})}),v(Kr,{path:"/accounts/:id",component:()=>v(rn,{permission:"AccountAccess",featureName:"Account Details",get children(){return v(Qx,{})}})}),v(Kr,{path:"/entry-books",component:()=>v(rn,{permission:"JournalAccess",featureName:"Entry Books",get children(){return v(S2,{})}})}),v(Kr,{path:"/employees",component:()=>v(rn,{permission:"EmployeeAccess",featureName:"Employee Management",get children(){return v(dE,{})}})}),v(Kr,{path:"/bank-consolidations",component:()=>v(rn,{permission:"BankingAccess",featureName:"Bank Consolidations",get children(){return v(BE,{})}})}),v(Kr,{path:"/balance-sheet",component:()=>v(rn,{permission:"AccountAccess",featureName:"Balance Sheet",get children(){return v(rE,{})}})}),v(Kr,{path:"/invoices",component:()=>v(rn,{permission:"JournalAccess",featureName:"Invoices",get children(){return v(I2,{})}})}),v(Kr,{path:"/inventory",component:()=>v(rn,{permission:"InventoryAccess",featureName:"Inventory Management",get children(){return v(TI,{})}})}),v(Kr,{path:"/products",component:()=>v(rn,{permission:"InventoryAccess",featureName:"Product Management",get children(){return v(Ig,{})}})}),v(Kr,{path:"/admin/users",component:()=>v(rn,{permission:"isAdmin",featureName:"User Administration",get children(){return v(O2,{})}})})]}})),s(t,(()=>{var r=ye(()=>!1);return()=>r()&&v(cC,{})})(),null),t}}),U2=document.getElementById("root");dp(()=>v(F2,{}),U2);export{RI as _};
