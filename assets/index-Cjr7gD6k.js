(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}})();const Yp=!1,Kp=(t,e)=>t===e,Xr=Symbol("solid-proxy"),Im=typeof Proxy=="function",jl=Symbol("solid-track"),ua={equals:Kp};let Em=Mm;const ao=1,da=2,$m={owned:null,cleanups:null,context:null,owner:null};var Ft=null;let ul=null,Qp=null,Wt=null,Er=null,In=null,Va=0;function zi(t,e){const r=Wt,n=Ft,o=t.length===0,i=e===void 0?n:e,a=o?$m:{owned:null,cleanups:null,context:i?i.context:null,owner:i},c=o?t:()=>t(()=>Fr(()=>Qi(a)));Ft=a,Wt=null;try{return lo(c,!0)}finally{Wt=r,Ft=n}}function ve(t,e){e=e?Object.assign({},ua,e):ua;const r={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},n=o=>(typeof o=="function"&&(o=o(r.value)),Lm(r,o));return[Nm.bind(r),n]}function le(t,e,r){const n=Ec(t,e,!1,ao);us(n)}function Nn(t,e,r){Em=eg;const n=Ec(t,e,!1,ao);n.user=!0,In?In.push(n):us(n)}function qe(t,e,r){r=r?Object.assign({},ua,r):ua;const n=Ec(t,e,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=r.equals||void 0,us(n),Nm.bind(n)}function Tm(t){return lo(t,!1)}function Fr(t){if(Wt===null)return t();const e=Wt;Wt=null;try{return t()}finally{Wt=e}}function Ac(t,e,r){const n=Array.isArray(t);let o,i=r&&r.defer;return a=>{let c;if(n){c=Array(t.length);for(let h=0;h<t.length;h++)c[h]=t[h]()}else c=t();if(i)return i=!1,a;const d=Fr(()=>e(c,o,a));return o=c,d}}function Hr(t){Nn(()=>Fr(t))}function mi(t){return Ft===null||(Ft.cleanups===null?Ft.cleanups=[t]:Ft.cleanups.push(t)),t}function zl(){return Wt}function km(){return Ft}function Rm(t,e){const r=Ft,n=Wt;Ft=t,Wt=null;try{return lo(e,!0)}catch(o){$c(o)}finally{Ft=r,Wt=n}}function Jp(t){const e=Wt,r=Ft;return Promise.resolve().then(()=>{Wt=e,Ft=r;let n;return lo(t,!1),Wt=Ft=null,n?n.done:void 0})}const[g$,v$]=ve(!1);function Dm(t,e){const r=Symbol("context");return{id:r,Provider:rg(r),defaultValue:t}}function xc(t){let e;return Ft&&Ft.context&&(e=Ft.context[t.id])!==void 0?e:t.defaultValue}function Ic(t){const e=qe(t),r=qe(()=>ql(e()));return r.toArray=()=>{const n=r();return Array.isArray(n)?n:n!=null?[n]:[]},r}function Nm(){if(this.sources&&this.state)if(this.state===ao)us(this);else{const t=Er;Er=null,lo(()=>ma(this),!1),Er=t}if(Wt){const t=this.observers?this.observers.length:0;Wt.sources?(Wt.sources.push(this),Wt.sourceSlots.push(t)):(Wt.sources=[this],Wt.sourceSlots=[t]),this.observers?(this.observers.push(Wt),this.observerSlots.push(Wt.sources.length-1)):(this.observers=[Wt],this.observerSlots=[Wt.sources.length-1])}return this.value}function Lm(t,e,r){let n=t.value;return(!t.comparator||!t.comparator(n,e))&&(t.value=e,t.observers&&t.observers.length&&lo(()=>{for(let o=0;o<t.observers.length;o+=1){const i=t.observers[o],a=ul&&ul.running;a&&ul.disposed.has(i),(a?!i.tState:!i.state)&&(i.pure?Er.push(i):In.push(i),i.observers&&Om(i)),a||(i.state=ao)}if(Er.length>1e6)throw Er=[],new Error},!1)),e}function us(t){if(!t.fn)return;Qi(t);const e=Va;Xp(t,t.value,e)}function Xp(t,e,r){let n;const o=Ft,i=Wt;Wt=Ft=t;try{n=t.fn(e)}catch(a){return t.pure&&(t.state=ao,t.owned&&t.owned.forEach(Qi),t.owned=null),t.updatedAt=r+1,$c(a)}finally{Wt=i,Ft=o}(!t.updatedAt||t.updatedAt<=r)&&(t.updatedAt!=null&&"observers"in t?Lm(t,n):t.value=n,t.updatedAt=r)}function Ec(t,e,r,n=ao,o){const i={fn:t,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:Ft,context:Ft?Ft.context:null,pure:r};return Ft===null||Ft!==$m&&(Ft.owned?Ft.owned.push(i):Ft.owned=[i]),i}function ha(t){if(t.state===0)return;if(t.state===da)return ma(t);if(t.suspense&&Fr(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<Va);)t.state&&e.push(t);for(let r=e.length-1;r>=0;r--)if(t=e[r],t.state===ao)us(t);else if(t.state===da){const n=Er;Er=null,lo(()=>ma(t,e[0]),!1),Er=n}}function lo(t,e){if(Er)return t();let r=!1;e||(Er=[]),In?r=!0:In=[],Va++;try{const n=t();return Zp(r),n}catch(n){r||(In=null),Er=null,$c(n)}}function Zp(t){if(Er&&(Mm(Er),Er=null),t)return;const e=In;In=null,e.length&&lo(()=>Em(e),!1)}function Mm(t){for(let e=0;e<t.length;e++)ha(t[e])}function eg(t){let e,r=0;for(e=0;e<t.length;e++){const n=t[e];n.user?t[r++]=n:ha(n)}for(e=0;e<r;e++)ha(t[e])}function ma(t,e){t.state=0;for(let r=0;r<t.sources.length;r+=1){const n=t.sources[r];if(n.sources){const o=n.state;o===ao?n!==e&&(!n.updatedAt||n.updatedAt<Va)&&ha(n):o===da&&ma(n,e)}}}function Om(t){for(let e=0;e<t.observers.length;e+=1){const r=t.observers[e];r.state||(r.state=da,r.pure?Er.push(r):In.push(r),r.observers&&Om(r))}}function Qi(t){let e;if(t.sources)for(;t.sources.length;){const r=t.sources.pop(),n=t.sourceSlots.pop(),o=r.observers;if(o&&o.length){const i=o.pop(),a=r.observerSlots.pop();n<o.length&&(i.sourceSlots[a]=n,o[n]=i,r.observerSlots[n]=a)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)Qi(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)Qi(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function tg(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function $c(t,e=Ft){throw tg(t)}function ql(t){if(typeof t=="function"&&!t.length)return ql(t());if(Array.isArray(t)){const e=[];for(let r=0;r<t.length;r++){const n=ql(t[r]);Array.isArray(n)?e.push.apply(e,n):e.push(n)}return e}return t}function rg(t,e){return function(n){let o;return le(()=>o=Fr(()=>(Ft.context={...Ft.context,[t]:n.value},Ic(()=>n.children))),void 0),o}}const ng=Symbol("fallback");function od(t){for(let e=0;e<t.length;e++)t[e]()}function og(t,e,r={}){let n=[],o=[],i=[],a=0,c=e.length>1?[]:null;return mi(()=>od(i)),()=>{let d=t()||[],h=d.length,y,v;return d[jl],Fr(()=>{let E,V,N,x,k,re,ae,F,Y;if(h===0)a!==0&&(od(i),i=[],n=[],o=[],a=0,c&&(c=[])),r.fallback&&(n=[ng],o[0]=zi(U=>(i[0]=U,r.fallback())),a=1);else if(a===0){for(o=new Array(h),v=0;v<h;v++)n[v]=d[v],o[v]=zi(w);a=h}else{for(N=new Array(h),x=new Array(h),c&&(k=new Array(h)),re=0,ae=Math.min(a,h);re<ae&&n[re]===d[re];re++);for(ae=a-1,F=h-1;ae>=re&&F>=re&&n[ae]===d[F];ae--,F--)N[F]=o[ae],x[F]=i[ae],c&&(k[F]=c[ae]);for(E=new Map,V=new Array(F+1),v=F;v>=re;v--)Y=d[v],y=E.get(Y),V[v]=y===void 0?-1:y,E.set(Y,v);for(y=re;y<=ae;y++)Y=n[y],v=E.get(Y),v!==void 0&&v!==-1?(N[v]=o[y],x[v]=i[y],c&&(k[v]=c[y]),v=V[v],E.set(Y,v)):i[y]();for(v=re;v<h;v++)v in N?(o[v]=N[v],i[v]=x[v],c&&(c[v]=k[v],c[v](v))):o[v]=zi(w);o=o.slice(0,a=h),n=d.slice(0)}return o});function w(E){if(i[v]=E,c){const[V,N]=ve(v);return c[v]=N,e(d[v],V)}return e(d[v])}}}function _(t,e){return Fr(()=>t(e||{}))}function Ns(){return!0}const Gl={get(t,e,r){return e===Xr?r:t.get(e)},has(t,e){return e===Xr?!0:t.has(e)},set:Ns,deleteProperty:Ns,getOwnPropertyDescriptor(t,e){return{configurable:!0,enumerable:!0,get(){return t.get(e)},set:Ns,deleteProperty:Ns}},ownKeys(t){return t.keys()}};function dl(t){return(t=typeof t=="function"?t():t)?t:{}}function ig(){for(let t=0,e=this.length;t<e;++t){const r=this[t]();if(r!==void 0)return r}}function Hl(...t){let e=!1;for(let a=0;a<t.length;a++){const c=t[a];e=e||!!c&&Xr in c,t[a]=typeof c=="function"?(e=!0,qe(c)):c}if(Im&&e)return new Proxy({get(a){for(let c=t.length-1;c>=0;c--){const d=dl(t[c])[a];if(d!==void 0)return d}},has(a){for(let c=t.length-1;c>=0;c--)if(a in dl(t[c]))return!0;return!1},keys(){const a=[];for(let c=0;c<t.length;c++)a.push(...Object.keys(dl(t[c])));return[...new Set(a)]}},Gl);const r={},n=Object.create(null);for(let a=t.length-1;a>=0;a--){const c=t[a];if(!c)continue;const d=Object.getOwnPropertyNames(c);for(let h=d.length-1;h>=0;h--){const y=d[h];if(y==="__proto__"||y==="constructor")continue;const v=Object.getOwnPropertyDescriptor(c,y);if(!n[y])n[y]=v.get?{enumerable:!0,configurable:!0,get:ig.bind(r[y]=[v.get.bind(c)])}:v.value!==void 0?v:void 0;else{const w=r[y];w&&(v.get?w.push(v.get.bind(c)):v.value!==void 0&&w.push(()=>v.value))}}}const o={},i=Object.keys(n);for(let a=i.length-1;a>=0;a--){const c=i[a],d=n[c];d&&d.get?Object.defineProperty(o,c,d):o[c]=d?d.value:void 0}return o}function sg(t,...e){if(Im&&Xr in t){const o=new Set(e.length>1?e.flat():e[0]),i=e.map(a=>new Proxy({get(c){return a.includes(c)?t[c]:void 0},has(c){return a.includes(c)&&c in t},keys(){return a.filter(c=>c in t)}},Gl));return i.push(new Proxy({get(a){return o.has(a)?void 0:t[a]},has(a){return o.has(a)?!1:a in t},keys(){return Object.keys(t).filter(a=>!o.has(a))}},Gl)),i}const r={},n=e.map(()=>({}));for(const o of Object.getOwnPropertyNames(t)){const i=Object.getOwnPropertyDescriptor(t,o),a=!i.get&&!i.set&&i.enumerable&&i.writable&&i.configurable;let c=!1,d=0;for(const h of e)h.includes(o)&&(c=!0,a?n[d][o]=i.value:Object.defineProperty(n[d],o,i)),++d;c||(a?r[o]=i.value:Object.defineProperty(r,o,i))}return[...n,r]}const ag=t=>`Stale read from <${t}>.`;function at(t){const e="fallback"in t&&{fallback:()=>t.fallback};return qe(og(()=>t.each,t.children,e||void 0))}function De(t){const e=t.keyed,r=qe(()=>t.when,void 0,void 0),n=e?r:qe(r,void 0,{equals:(o,i)=>!o==!i});return qe(()=>{const o=n();if(o){const i=t.children;return typeof i=="function"&&i.length>0?Fr(()=>i(e?o:()=>{if(!Fr(n))throw ag("Show");return r()})):i}return t.fallback},void 0,void 0)}const lg=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],cg=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline",...lg]),ug=new Set(["innerHTML","textContent","innerText","children"]),dg=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),hg=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}});function mg(t,e){const r=hg[t];return typeof r=="object"?r[e]?r.$:void 0:r}const yg=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),ge=t=>qe(()=>t());function fg(t,e,r){let n=r.length,o=e.length,i=n,a=0,c=0,d=e[o-1].nextSibling,h=null;for(;a<o||c<i;){if(e[a]===r[c]){a++,c++;continue}for(;e[o-1]===r[i-1];)o--,i--;if(o===a){const y=i<n?c?r[c-1].nextSibling:r[i-c]:d;for(;c<i;)t.insertBefore(r[c++],y)}else if(i===c)for(;a<o;)(!h||!h.has(e[a]))&&e[a].remove(),a++;else if(e[a]===r[i-1]&&r[c]===e[o-1]){const y=e[--o].nextSibling;t.insertBefore(r[c++],e[a++].nextSibling),t.insertBefore(r[--i],y),e[o]=r[i]}else{if(!h){h=new Map;let v=c;for(;v<i;)h.set(r[v],v++)}const y=h.get(e[a]);if(y!=null)if(c<y&&y<i){let v=a,w=1,E;for(;++v<o&&v<i&&!((E=h.get(e[v]))==null||E!==y+w);)w++;if(w>y-c){const V=e[a];for(;c<y;)t.insertBefore(r[c++],V)}else t.replaceChild(r[c++],e[a++])}else a++;else e[a++].remove()}}}const id="_$DX_DELEGATE";function pg(t,e,r,n={}){let o;return zi(i=>{o=i,e===document?t():s(e,t(),e.firstChild?null:void 0,r)},n.owner),()=>{o(),e.textContent=""}}function G(t,e,r,n){let o;const i=()=>{const c=n?document.createElementNS("http://www.w3.org/1998/Math/MathML","template"):document.createElement("template");return c.innerHTML=t,r?c.content.firstChild.firstChild:n?c.firstChild:c.content.firstChild},a=e?()=>Fr(()=>document.importNode(o||(o=i()),!0)):()=>(o||(o=i())).cloneNode(!0);return a.cloneNode=a,a}function Pt(t,e=window.document){const r=e[id]||(e[id]=new Set);for(let n=0,o=t.length;n<o;n++){const i=t[n];r.has(i)||(r.add(i),e.addEventListener(i,wg))}}function lt(t,e,r){r==null?t.removeAttribute(e):t.setAttribute(e,r)}function gg(t,e,r){r?t.setAttribute(e,""):t.removeAttribute(e)}function Tc(t,e){e==null?t.removeAttribute("class"):t.className=e}function co(t,e,r,n){if(n)Array.isArray(r)?(t[`$$${e}`]=r[0],t[`$$${e}Data`]=r[1]):t[`$$${e}`]=r;else if(Array.isArray(r)){const o=r[0];t.addEventListener(e,r[0]=i=>o.call(t,r[1],i))}else t.addEventListener(e,r,typeof r!="function"&&r)}function vg(t,e,r={}){const n=Object.keys(e||{}),o=Object.keys(r);let i,a;for(i=0,a=o.length;i<a;i++){const c=o[i];!c||c==="undefined"||e[c]||(sd(t,c,!1),delete r[c])}for(i=0,a=n.length;i<a;i++){const c=n[i],d=!!e[c];!c||c==="undefined"||r[c]===d||!d||(sd(t,c,!0),r[c]=d)}return r}function u(t,e,r){if(!e)return r?lt(t,"style"):e;const n=t.style;if(typeof e=="string")return n.cssText=e;typeof r=="string"&&(n.cssText=r=void 0),r||(r={}),e||(e={});let o,i;for(i in r)e[i]==null&&n.removeProperty(i),delete r[i];for(i in e)o=e[i],o!==r[i]&&(n.setProperty(i,o),r[i]=o);return r}function bg(t,e={},r,n){const o={};return le(()=>o.children=Ji(t,e.children,o.children)),le(()=>typeof e.ref=="function"&&_g(e.ref,t)),le(()=>Sg(t,e,r,!0,o,!0)),o}function _g(t,e,r){return Fr(()=>t(e,r))}function s(t,e,r,n){if(r!==void 0&&!n&&(n=[]),typeof e!="function")return Ji(t,e,n,r);le(o=>Ji(t,e(),o,r),n)}function Sg(t,e,r,n,o={},i=!1){e||(e={});for(const a in o)if(!(a in e)){if(a==="children")continue;o[a]=ad(t,a,null,o[a],r,i,e)}for(const a in e){if(a==="children")continue;const c=e[a];o[a]=ad(t,a,c,o[a],r,i,e)}}function Pg(t){return t.toLowerCase().replace(/-([a-z])/g,(e,r)=>r.toUpperCase())}function sd(t,e,r){const n=e.trim().split(/\s+/);for(let o=0,i=n.length;o<i;o++)t.classList.toggle(n[o],r)}function ad(t,e,r,n,o,i,a){let c,d,h,y,v;if(e==="style")return u(t,r,n);if(e==="classList")return vg(t,r,n);if(r===n)return n;if(e==="ref")i||r(t);else if(e.slice(0,3)==="on:"){const w=e.slice(3);n&&t.removeEventListener(w,n,typeof n!="function"&&n),r&&t.addEventListener(w,r,typeof r!="function"&&r)}else if(e.slice(0,10)==="oncapture:"){const w=e.slice(10);n&&t.removeEventListener(w,n,!0),r&&t.addEventListener(w,r,!0)}else if(e.slice(0,2)==="on"){const w=e.slice(2).toLowerCase(),E=yg.has(w);if(!E&&n){const V=Array.isArray(n)?n[0]:n;t.removeEventListener(w,V)}(E||r)&&(co(t,w,r,E),E&&Pt([w]))}else e.slice(0,5)==="attr:"?lt(t,e.slice(5),r):e.slice(0,5)==="bool:"?gg(t,e.slice(5),r):(v=e.slice(0,5)==="prop:")||(h=ug.has(e))||(y=mg(e,t.tagName))||(d=cg.has(e))||(c=t.nodeName.includes("-")||"is"in a)?(v&&(e=e.slice(5),d=!0),e==="class"||e==="className"?Tc(t,r):c&&!d&&!h?t[Pg(e)]=r:t[y||e]=r):lt(t,dg[e]||e,r);return r}function wg(t){let e=t.target;const r=`$$${t.type}`,n=t.target,o=t.currentTarget,i=d=>Object.defineProperty(t,"target",{configurable:!0,value:d}),a=()=>{const d=e[r];if(d&&!e.disabled){const h=e[`${r}Data`];if(h!==void 0?d.call(e,h,t):d.call(e,t),t.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(t.target)&&i(e.host),!0},c=()=>{for(;a()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return e||document}}),t.composedPath){const d=t.composedPath();i(d[0]);for(let h=0;h<d.length-2&&(e=d[h],!!a());h++){if(e._$host){e=e._$host,c();break}if(e.parentNode===o)break}}else c();i(n)}function Ji(t,e,r,n,o){for(;typeof r=="function";)r=r();if(e===r)return r;const i=typeof e,a=n!==void 0;if(t=a&&r[0]&&r[0].parentNode||t,i==="string"||i==="number"){if(i==="number"&&(e=e.toString(),e===r))return r;if(a){let c=r[0];c&&c.nodeType===3?c.data!==e&&(c.data=e):c=document.createTextNode(e),r=zo(t,r,n,c)}else r!==""&&typeof r=="string"?r=t.firstChild.data=e:r=t.textContent=e}else if(e==null||i==="boolean")r=zo(t,r,n);else{if(i==="function")return le(()=>{let c=e();for(;typeof c=="function";)c=c();r=Ji(t,c,r,n)}),()=>r;if(Array.isArray(e)){const c=[],d=r&&Array.isArray(r);if(Wl(c,e,r,o))return le(()=>r=Ji(t,c,r,n,!0)),()=>r;if(c.length===0){if(r=zo(t,r,n),a)return r}else d?r.length===0?ld(t,c,n):fg(t,r,c):(r&&zo(t),ld(t,c));r=c}else if(e.nodeType){if(Array.isArray(r)){if(a)return r=zo(t,r,n,e);zo(t,r,null,e)}else r==null||r===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);r=e}}return r}function Wl(t,e,r,n){let o=!1;for(let i=0,a=e.length;i<a;i++){let c=e[i],d=r&&r[t.length],h;if(!(c==null||c===!0||c===!1))if((h=typeof c)=="object"&&c.nodeType)t.push(c);else if(Array.isArray(c))o=Wl(t,c,d)||o;else if(h==="function")if(n){for(;typeof c=="function";)c=c();o=Wl(t,Array.isArray(c)?c:[c],Array.isArray(d)?d:[d])||o}else t.push(c),o=!0;else{const y=String(c);d&&d.nodeType===3&&d.data===y?t.push(d):t.push(document.createTextNode(y))}}return o}function ld(t,e,r=null){for(let n=0,o=e.length;n<o;n++)t.insertBefore(e[n],r)}function zo(t,e,r,n){if(r===void 0)return t.textContent="";const o=n||document.createTextNode("");if(e.length){let i=!1;for(let a=e.length-1;a>=0;a--){const c=e[a];if(o!==c){const d=c.parentNode===t;!i&&!a?d?t.replaceChild(o,c):t.insertBefore(o,r):d&&c.remove()}else i=!0}}else t.insertBefore(o,r);return[o]}const Cg=!1;function Vm(){let t=new Set;function e(o){return t.add(o),()=>t.delete(o)}let r=!1;function n(o,i){if(r)return!(r=!1);const a={to:o,options:i,defaultPrevented:!1,preventDefault:()=>a.defaultPrevented=!0};for(const c of t)c.listener({...a,from:c.location,retry:d=>{d&&(r=!0),c.navigate(o,{...i,resolve:!1})}});return!a.defaultPrevented}return{subscribe:e,confirm:n}}let Yl;function kc(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),Yl=window.history.state._depth}kc();function Ag(t){return{...t,_depth:window.history.state&&window.history.state._depth}}function xg(t,e){let r=!1;return()=>{const n=Yl;kc();const o=n==null?null:Yl-n;if(r){r=!1;return}o&&e(o)?(r=!0,window.history.go(-o)):t()}}const Ig=/^(?:[a-z0-9]+:)?\/\//i,Eg=/^\/+|(\/)\/+$/g,Fm="http://sr";function Io(t,e=!1){const r=t.replace(Eg,"$1");return r?e||/^[?#]/.test(r)?r:"/"+r:""}function Zs(t,e,r){if(Ig.test(e))return;const n=Io(t),o=r&&Io(r);let i="";return!o||e.startsWith("/")?i=n:o.toLowerCase().indexOf(n.toLowerCase())!==0?i=n+o:i=o,(i||"/")+Io(e,!i)}function $g(t,e){if(t==null)throw new Error(e);return t}function Tg(t,e){return Io(t).replace(/\/*(\*.*)?$/g,"")+Io(e)}function Bm(t){const e={};return t.searchParams.forEach((r,n)=>{n in e?Array.isArray(e[n])?e[n].push(r):e[n]=[e[n],r]:e[n]=r}),e}function kg(t,e,r){const[n,o]=t.split("/*",2),i=n.split("/").filter(Boolean),a=i.length;return c=>{const d=c.split("/").filter(Boolean),h=d.length-a;if(h<0||h>0&&o===void 0&&!e)return null;const y={path:a?"":"/",params:{}},v=w=>r===void 0?void 0:r[w];for(let w=0;w<a;w++){const E=i[w],V=E[0]===":",N=V?d[w]:d[w].toLowerCase(),x=V?E.slice(1):E.toLowerCase();if(V&&hl(N,v(x)))y.params[x]=N;else if(V||!hl(N,x))return null;y.path+=`/${N}`}if(o){const w=h?d.slice(-h).join("/"):"";if(hl(w,v(o)))y.params[o]=w;else return null}return y}}function hl(t,e){const r=n=>n===t;return e===void 0?!0:typeof e=="string"?r(e):typeof e=="function"?e(t):Array.isArray(e)?e.some(r):e instanceof RegExp?e.test(t):!1}function Rg(t){const[e,r]=t.pattern.split("/*",2),n=e.split("/").filter(Boolean);return n.reduce((o,i)=>o+(i.startsWith(":")?2:3),n.length-(r===void 0?0:1))}function Um(t){const e=new Map,r=km();return new Proxy({},{get(n,o){return e.has(o)||Rm(r,()=>e.set(o,qe(()=>t()[o]))),e.get(o)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(t())}})}function jm(t){let e=/(\/?\:[^\/]+)\?/.exec(t);if(!e)return[t];let r=t.slice(0,e.index),n=t.slice(e.index+e[0].length);const o=[r,r+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(n);)o.push(r+=e[1]),n=n.slice(e[0].length);return jm(n).reduce((i,a)=>[...i,...o.map(c=>c+a)],[])}const Dg=100,zm=Dm(),Rc=Dm(),ds=()=>$g(xc(zm),"<A> and 'use' router primitives can be only used inside a Route."),Ng=()=>xc(Rc)||ds().base,Lg=t=>{const e=Ng();return qe(()=>e.resolvePath(t()))},Mg=t=>{const e=ds();return qe(()=>{const r=t();return r!==void 0?e.renderPath(r):r})},Dc=()=>ds().navigatorFactory(),Og=()=>ds().location,Vg=()=>ds().params;function Fg(t,e=""){const{component:r,preload:n,load:o,children:i,info:a}=t,c=!i||Array.isArray(i)&&!i.length,d={key:t,component:r,preload:n||o,info:a};return qm(t.path).reduce((h,y)=>{for(const v of jm(y)){const w=Tg(e,v);let E=c?w:w.split("/*",1)[0];E=E.split("/").map(V=>V.startsWith(":")||V.startsWith("*")?V:encodeURIComponent(V)).join("/"),h.push({...d,originalPath:y,pattern:E,matcher:kg(E,!c,t.matchFilters)})}return h},[])}function Bg(t,e=0){return{routes:t,score:Rg(t[t.length-1])*1e4-e,matcher(r){const n=[];for(let o=t.length-1;o>=0;o--){const i=t[o],a=i.matcher(r);if(!a)return null;n.unshift({...a,route:i})}return n}}}function qm(t){return Array.isArray(t)?t:[t]}function Gm(t,e="",r=[],n=[]){const o=qm(t);for(let i=0,a=o.length;i<a;i++){const c=o[i];if(c&&typeof c=="object"){c.hasOwnProperty("path")||(c.path="");const d=Fg(c,e);for(const h of d){r.push(h);const y=Array.isArray(c.children)&&c.children.length===0;if(c.children&&!y)Gm(c.children,h.pattern,r,n);else{const v=Bg([...r],n.length);n.push(v)}r.pop()}}}return r.length?n:n.sort((i,a)=>a.score-i.score)}function ml(t,e){for(let r=0,n=t.length;r<n;r++){const o=t[r].matcher(e);if(o)return o}return[]}function Ug(t,e,r){const n=new URL(Fm),o=qe(y=>{const v=t();try{return new URL(v,n)}catch{return console.error(`Invalid path ${v}`),y}},n,{equals:(y,v)=>y.href===v.href}),i=qe(()=>o().pathname),a=qe(()=>o().search,!0),c=qe(()=>o().hash),d=()=>"",h=Ac(a,()=>Bm(o()));return{get pathname(){return i()},get search(){return a()},get hash(){return c()},get state(){return e()},get key(){return d()},query:r?r(h):Um(h)}}let Po;function jg(){return Po}function zg(t,e,r,n={}){const{signal:[o,i],utils:a={}}=t,c=a.parsePath||(ne=>ne),d=a.renderPath||(ne=>ne),h=a.beforeLeave||Vm(),y=Zs("",n.base||"");if(y===void 0)throw new Error(`${y} is not a valid base path`);y&&!o().value&&i({value:y,replace:!0,scroll:!1});const[v,w]=ve(!1);let E;const V=(ne,W)=>{W.value===N()&&W.state===k()||(E===void 0&&w(!0),Po=ne,E=W,Jp(()=>{E===W&&(x(E.value),re(E.state),Y[1](I=>I.filter(O=>O.pending)))}).finally(()=>{E===W&&Tm(()=>{Po=void 0,ne==="navigate"&&A(E),w(!1),E=void 0})}))},[N,x]=ve(o().value),[k,re]=ve(o().state),ae=Ug(N,k,a.queryWrapper),F=[],Y=ve([]),U=qe(()=>typeof n.transformUrl=="function"?ml(e(),n.transformUrl(ae.pathname)):ml(e(),ae.pathname)),b=()=>{const ne=U(),W={};for(let I=0;I<ne.length;I++)Object.assign(W,ne[I].params);return W},g=a.paramsWrapper?a.paramsWrapper(b,e):Um(b),p={pattern:y,path:()=>y,outlet:()=>null,resolvePath(ne){return Zs(y,ne)}};return le(Ac(o,ne=>V("native",ne),{defer:!0})),{base:p,location:ae,params:g,isRouting:v,renderPath:d,parsePath:c,navigatorFactory:S,matches:U,beforeLeave:h,preloadRoute:m,singleFlight:n.singleFlight===void 0?!0:n.singleFlight,submissions:Y};function C(ne,W,I){Fr(()=>{if(typeof W=="number"){W&&(a.go?a.go(W):console.warn("Router integration does not support relative routing"));return}const O=!W||W[0]==="?",{replace:J,resolve:D,scroll:T,state:B}={replace:!1,resolve:!O,scroll:!0,...I},me=D?ne.resolvePath(W):Zs(O&&ae.pathname||"",W);if(me===void 0)throw new Error(`Path '${W}' is not a routable path`);if(F.length>=Dg)throw new Error("Too many redirects");const H=N();(me!==H||B!==k())&&(Cg||h.confirm(me,I)&&(F.push({value:H,replace:J,scroll:T,state:k()}),V("navigate",{value:me,state:B})))})}function S(ne){return ne=ne||xc(Rc)||p,(W,I)=>C(ne,W,I)}function A(ne){const W=F[0];W&&(i({...ne,replace:W.replace,scroll:W.scroll}),F.length=0)}function m(ne,W){const I=ml(e(),ne.pathname),O=Po;Po="preload";for(let J in I){const{route:D,params:T}=I[J];D.component&&D.component.preload&&D.component.preload();const{preload:B}=D;W&&B&&Rm(r(),()=>B({params:T,location:{pathname:ne.pathname,search:ne.search,hash:ne.hash,query:Bm(ne),state:null,key:""},intent:"preload"}))}Po=O}}function qg(t,e,r,n){const{base:o,location:i,params:a}=t,{pattern:c,component:d,preload:h}=n().route,y=qe(()=>n().path);d&&d.preload&&d.preload();const v=h?h({params:a,location:i,intent:Po||"initial"}):void 0;return{parent:e,pattern:c,path:y,outlet:()=>d?_(d,{params:a,location:i,data:v,get children(){return r()}}):r(),resolvePath(E){return Zs(o.path(),E,y())}}}const Gg=t=>e=>{const{base:r}=e,n=Ic(()=>e.children),o=qe(()=>Gm(n(),e.base||""));let i;const a=zg(t,o,()=>i,{base:r,singleFlight:e.singleFlight,transformUrl:e.transformUrl});return t.create&&t.create(a),_(zm.Provider,{value:a,get children(){return _(Hg,{routerState:a,get root(){return e.root},get preload(){return e.rootPreload||e.rootLoad},get children(){return[ge(()=>(i=km())&&null),_(Wg,{routerState:a,get branches(){return o()}})]}})}})};function Hg(t){const e=t.routerState.location,r=t.routerState.params,n=qe(()=>t.preload&&Fr(()=>{t.preload({params:r,location:e,intent:jg()||"initial"})}));return _(De,{get when(){return t.root},keyed:!0,get fallback(){return t.children},children:o=>_(o,{params:r,location:e,get data(){return n()},get children(){return t.children}})})}function Wg(t){const e=[];let r;const n=qe(Ac(t.routerState.matches,(o,i,a)=>{let c=i&&o.length===i.length;const d=[];for(let h=0,y=o.length;h<y;h++){const v=i&&i[h],w=o[h];a&&v&&w.route.key===v.route.key?d[h]=a[h]:(c=!1,e[h]&&e[h](),zi(E=>{e[h]=E,d[h]=qg(t.routerState,d[h-1]||t.routerState.base,cd(()=>n()[h+1]),()=>t.routerState.matches()[h])}))}return e.splice(o.length).forEach(h=>h()),a&&c?a:(r=d[0],d)}));return cd(()=>n()&&r)()}const cd=t=>()=>_(De,{get when(){return t()},keyed:!0,children:e=>_(Rc.Provider,{value:e,get children(){return e.outlet()}})}),Kr=t=>{const e=Ic(()=>t.children);return Hl(t,{get children(){return e()}})};function Yg([t,e],r,n){return[t,n?o=>e(n(o)):e]}function Kg(t){let e=!1;const r=o=>typeof o=="string"?{value:o}:o,n=Yg(ve(r(t.get()),{equals:(o,i)=>o.value===i.value&&o.state===i.state}),void 0,o=>(!e&&t.set(o),o));return t.init&&mi(t.init((o=t.get())=>{e=!0,n[1](r(o)),e=!1})),Gg({signal:n,create:t.create,utils:t.utils})}function Qg(t,e,r){return t.addEventListener(e,r),()=>t.removeEventListener(e,r)}function Jg(t,e){const r=t&&document.getElementById(t);r?r.scrollIntoView():e&&window.scrollTo(0,0)}const Xg=new Map;function Zg(t=!0,e=!1,r="/_server",n){return o=>{const i=o.base.path(),a=o.navigatorFactory(o.base);let c,d;function h(N){return N.namespaceURI==="http://www.w3.org/2000/svg"}function y(N){if(N.defaultPrevented||N.button!==0||N.metaKey||N.altKey||N.ctrlKey||N.shiftKey)return;const x=N.composedPath().find(U=>U instanceof Node&&U.nodeName.toUpperCase()==="A");if(!x||e&&!x.hasAttribute("link"))return;const k=h(x),re=k?x.href.baseVal:x.href;if((k?x.target.baseVal:x.target)||!re&&!x.hasAttribute("state"))return;const F=(x.getAttribute("rel")||"").split(/\s+/);if(x.hasAttribute("download")||F&&F.includes("external"))return;const Y=k?new URL(re,document.baseURI):new URL(re);if(!(Y.origin!==window.location.origin||i&&Y.pathname&&!Y.pathname.toLowerCase().startsWith(i.toLowerCase())))return[x,Y]}function v(N){const x=y(N);if(!x)return;const[k,re]=x,ae=o.parsePath(re.pathname+re.search+re.hash),F=k.getAttribute("state");N.preventDefault(),a(ae,{resolve:!1,replace:k.hasAttribute("replace"),scroll:!k.hasAttribute("noscroll"),state:F?JSON.parse(F):void 0})}function w(N){const x=y(N);if(!x)return;const[k,re]=x;o.preloadRoute(re,k.getAttribute("preload")!=="false")}function E(N){clearTimeout(c);const x=y(N);if(!x)return d=null;const[k,re]=x;d!==k&&(c=setTimeout(()=>{o.preloadRoute(re,k.getAttribute("preload")!=="false"),d=k},20))}function V(N){if(N.defaultPrevented)return;let x=N.submitter&&N.submitter.hasAttribute("formaction")?N.submitter.getAttribute("formaction"):N.target.getAttribute("action");if(!x)return;if(!x.startsWith("https://action/")){const re=new URL(x,Fm);if(x=o.parsePath(re.pathname+re.search),!x.startsWith(r))return}if(N.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const k=Xg.get(x);if(k){N.preventDefault();const re=new FormData(N.target,N.submitter);k.call({r:o,f:N.target},N.target.enctype==="multipart/form-data"?re:new URLSearchParams(re))}}Pt(["click","submit"]),document.addEventListener("click",v),t&&(document.addEventListener("mousemove",E,{passive:!0}),document.addEventListener("focusin",w,{passive:!0}),document.addEventListener("touchstart",w,{passive:!0})),document.addEventListener("submit",V),mi(()=>{document.removeEventListener("click",v),t&&(document.removeEventListener("mousemove",E),document.removeEventListener("focusin",w),document.removeEventListener("touchstart",w)),document.removeEventListener("submit",V)})}}function ev(t){const e=t.replace(/^.*?#/,"");if(!e.startsWith("/")){const[,r="/"]=window.location.hash.split("#",2);return`${r}#${e}`}return e}function tv(t){const e=()=>window.location.hash.slice(1),r=Vm();return Kg({get:e,set({value:n,replace:o,scroll:i,state:a}){o?window.history.replaceState(Ag(a),"","#"+n):window.history.pushState(a,"","#"+n);const c=n.indexOf("#"),d=c>=0?n.slice(c+1):"";Jg(d,i),kc()},init:n=>Qg(window,"hashchange",xg(n,o=>!r.confirm(o&&o<0?o:e()))),create:Zg(t.preload,t.explicitLinks,t.actionBase),utils:{go:n=>window.history.go(n),renderPath:n=>`#${n}`,parsePath:ev,beforeLeave:r}})(t)}var rv=G("<a>");function Yo(t){t=Hl({inactiveClass:"inactive",activeClass:"active"},t);const[,e]=sg(t,["href","state","class","activeClass","inactiveClass","end"]),r=Lg(()=>t.href),n=Mg(r),o=Og(),i=qe(()=>{const a=r();if(a===void 0)return[!1,!1];const c=Io(a.split(/[?#]/,1)[0]).toLowerCase(),d=decodeURI(Io(o.pathname).toLowerCase());return[t.end?c===d:d.startsWith(c+"/")||d===c,c===d]});return(()=>{var a=rv();return bg(a,Hl(e,{get href(){return n()||t.href},get state(){return JSON.stringify(t.state)},get classList(){return{...t.class&&{[t.class]:!0},[t.inactiveClass]:!i()[0],[t.activeClass]:i()[0],...e.classList}},link:"",get"aria-current"(){return i()[1]?"page":void 0}}),!1),a})()}const Kl=Symbol("store-raw"),Zo=Symbol("store-node"),Pn=Symbol("store-has"),Hm=Symbol("store-self");function Wm(t){let e=t[Xr];if(!e&&(Object.defineProperty(t,Xr,{value:e=new Proxy(t,iv)}),!Array.isArray(t))){const r=Object.keys(t),n=Object.getOwnPropertyDescriptors(t);for(let o=0,i=r.length;o<i;o++){const a=r[o];n[a].get&&Object.defineProperty(t,a,{enumerable:n[a].enumerable,get:n[a].get.bind(e)})}}return e}function ya(t){let e;return t!=null&&typeof t=="object"&&(t[Xr]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function Xi(t,e=new Set){let r,n,o,i;if(r=t!=null&&t[Kl])return r;if(!ya(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let a=0,c=t.length;a<c;a++)o=t[a],(n=Xi(o,e))!==o&&(t[a]=n)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const a=Object.keys(t),c=Object.getOwnPropertyDescriptors(t);for(let d=0,h=a.length;d<h;d++)i=a[d],!c[i].get&&(o=t[i],(n=Xi(o,e))!==o&&(t[i]=n))}return t}function fa(t,e){let r=t[e];return r||Object.defineProperty(t,e,{value:r=Object.create(null)}),r}function Zi(t,e,r){if(t[e])return t[e];const[n,o]=ve(r,{equals:!1,internal:!0});return n.$=o,t[e]=n}function nv(t,e){const r=Reflect.getOwnPropertyDescriptor(t,e);return!r||r.get||!r.configurable||e===Xr||e===Zo||(delete r.value,delete r.writable,r.get=()=>t[Xr][e]),r}function Ym(t){zl()&&Zi(fa(t,Zo),Hm)()}function ov(t){return Ym(t),Reflect.ownKeys(t)}const iv={get(t,e,r){if(e===Kl)return t;if(e===Xr)return r;if(e===jl)return Ym(t),r;const n=fa(t,Zo),o=n[e];let i=o?o():t[e];if(e===Zo||e===Pn||e==="__proto__")return i;if(!o){const a=Object.getOwnPropertyDescriptor(t,e);zl()&&(typeof i!="function"||t.hasOwnProperty(e))&&!(a&&a.get)&&(i=Zi(n,e,i)())}return ya(i)?Wm(i):i},has(t,e){return e===Kl||e===Xr||e===jl||e===Zo||e===Pn||e==="__proto__"?!0:(zl()&&Zi(fa(t,Pn),e)(),e in t)},set(){return!0},deleteProperty(){return!0},ownKeys:ov,getOwnPropertyDescriptor:nv};function pa(t,e,r,n=!1){if(!n&&t[e]===r)return;const o=t[e],i=t.length;r===void 0?(delete t[e],t[Pn]&&t[Pn][e]&&o!==void 0&&t[Pn][e].$()):(t[e]=r,t[Pn]&&t[Pn][e]&&o===void 0&&t[Pn][e].$());let a=fa(t,Zo),c;if((c=Zi(a,e,o))&&c.$(()=>r),Array.isArray(t)&&t.length!==i){for(let d=t.length;d<i;d++)(c=a[d])&&c.$();(c=Zi(a,"length",i))&&c.$(t.length)}(c=a[Hm])&&c.$()}function Km(t,e){const r=Object.keys(e);for(let n=0;n<r.length;n+=1){const o=r[n];pa(t,o,e[o])}}function sv(t,e){if(typeof e=="function"&&(e=e(t)),e=Xi(e),Array.isArray(e)){if(t===e)return;let r=0,n=e.length;for(;r<n;r++){const o=e[r];t[r]!==o&&pa(t,r,o)}pa(t,"length",n)}else Km(t,e)}function Mi(t,e,r=[]){let n,o=t;if(e.length>1){n=e.shift();const a=typeof n,c=Array.isArray(t);if(Array.isArray(n)){for(let d=0;d<n.length;d++)Mi(t,[n[d]].concat(e),r);return}else if(c&&a==="function"){for(let d=0;d<t.length;d++)n(t[d],d)&&Mi(t,[d].concat(e),r);return}else if(c&&a==="object"){const{from:d=0,to:h=t.length-1,by:y=1}=n;for(let v=d;v<=h;v+=y)Mi(t,[v].concat(e),r);return}else if(e.length>1){Mi(t[n],e,[n].concat(r));return}o=t[n],r=[n].concat(r)}let i=e[0];typeof i=="function"&&(i=i(o,r),i===o)||n===void 0&&i==null||(i=Xi(i),n===void 0||ya(o)&&ya(i)&&!Array.isArray(i)?Km(o,i):pa(t,n,i))}function Fa(...[t,e]){const r=Xi(t||{}),n=Array.isArray(r),o=Wm(r);function i(...a){Tm(()=>{n&&a.length===1?sv(r,a[0]):Mi(r,a)})}return[o,i]}const Vt=(t=300+Math.random()*700)=>new Promise(e=>setTimeout(e,t)),po=(t="")=>`${t}${Date.now()}-${Math.random().toString(36).substr(2,9)}`;let ze={products:[{id:"prod-001",name:"Wireless Headphones",sku:"WH-001",productCode:"WH-001",productName:"Wireless Headphones",description:"High-quality wireless bluetooth headphones",category:"Electronics",unitOfMeasure:"pcs",unitCost:45,sellingPrice:89.99,minStockLevel:10,maxStockLevel:100,isActive:!0,createdDate:"2024-01-15T10:00:00Z",lastModified:"2024-01-15T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-002",name:"USB-C Cable",sku:"USB-001",description:"3ft USB-C charging cable",category:"Accessories",unitOfMeasure:"pcs",unitCost:8.5,sellingPrice:19.99,minStockLevel:25,maxStockLevel:200,isActive:!0,createdDate:"2024-01-16T10:00:00Z",lastModified:"2024-01-16T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-003",name:"Laptop Stand",sku:"LS-001",description:"Adjustable aluminum laptop stand",category:"Office",unitOfMeasure:"pcs",unitCost:25,sellingPrice:49.99,minStockLevel:5,maxStockLevel:50,isActive:!0,createdDate:"2024-01-17T10:00:00Z",lastModified:"2024-01-17T10:00:00Z",businessId:"YB100423253156428"}],locations:[{id:"loc-001",name:"Main Warehouse",code:"WH-001",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-002",name:"Retail Store - Downtown",code:"ST-001",type:"store",address:"456 Main St, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-003",name:"Retail Store - Mall",code:"ST-002",type:"store",address:"789 Mall Blvd, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"}],movements:[{id:"mov-001",productId:"prod-001",productName:"Wireless Headphones",productSku:"WH-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:50,unitCost:45,totalCost:2250,referenceNumber:"PO-001",notes:"Initial stock purchase",createdBy:"admin",createdDate:"2024-01-15T10:00:00Z",invoiceId:"INV-1000001"},{id:"mov-002",productId:"prod-002",productName:"USB-C Cable",productSku:"USB-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:100,unitCost:8.5,totalCost:850,referenceNumber:"PO-001",notes:"Bulk purchase",createdBy:"admin",createdDate:"2024-01-15T10:05:00Z",invoiceId:"INV-1000001"}],accounts:[{id:"acc-001",accountNumber:"1000",accountName:"Cash",accountType:"asset",category:"currentAssets",balance:5e4,parentAccountId:null,description:"Cash and cash equivalents",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"},{id:"acc-002",accountNumber:"1100",accountName:"Accounts Receivable",accountType:"asset",category:"currentAssets",balance:25e3,parentAccountId:null,description:"Money owed by customers",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"}],journalEntries:[{id:"je-001",entryNumber:"JE-001",date:"2024-01-15",description:"Initial cash deposit",reference:"DEP-001",status:"posted",createdBy:"admin",createdAt:"2024-01-15T10:00:00Z",postedAt:"2024-01-15T10:05:00Z",lines:[{id:"jel-001",accountId:"acc-001",accountName:"Cash",description:"Initial deposit",debitAmount:5e4,creditAmount:0},{id:"jel-002",accountId:"acc-003",accountName:"Owner Equity",description:"Initial capital",debitAmount:0,creditAmount:5e4}]}]};const or=(t=.05)=>Math.random()<t,ir=()=>{const t=["Network timeout","Connection refused","Server temporarily unavailable","Invalid request"];throw new Error(t[Math.floor(Math.random()*t.length)])},Or={products:{async getAll(t,e){await Vt(),or()&&ir();let r=[...ze.products];if(t&&t.trim()){const n=t.toLowerCase();r=r.filter(o=>o.name.toLowerCase().includes(n)||o.sku.toLowerCase().includes(n)||o.category.toLowerCase().includes(n)||o.description.toLowerCase().includes(n))}return e?.category&&(r=r.filter(n=>n.category===e.category)),e?.isActive!==void 0&&(r=r.filter(n=>n.isActive===e.isActive)),r},async getById(t){return await Vt(),or()&&ir(),ze.products.find(e=>e.id===t)||null},async create(t){if(await Vt(),or()&&ir(),ze.products.some(r=>r.sku===t.sku))throw new Error("SKU already exists");const e={...t,id:po("prod-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return ze.products.push(e),e},async update(t,e){await Vt(),or()&&ir();const r=ze.products.findIndex(o=>o.id===t);if(r===-1)throw new Error("Product not found");if(e.sku&&ze.products.some(o=>o.id!==t&&o.sku===e.sku))throw new Error("SKU already exists");const n={...ze.products[r],...e,lastModified:new Date().toISOString()};return ze.products[r]=n,n},async delete(t){await Vt(),or()&&ir();const e=ze.products.findIndex(n=>n.id===t);if(e===-1)throw new Error("Product not found");return ze.movements.some(n=>n.productId===t)?{success:!1,message:"Cannot delete product with existing movements"}:(ze.products.splice(e,1),{success:!0,message:"Product deleted successfully"})}},locations:{async getAll(t){await Vt(),or()&&ir();let e=[...ze.locations];return t?.type&&(e=e.filter(r=>r.type===t.type)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await Vt(),ze.locations.find(e=>e.id===t)||null},async create(t){if(await Vt(),or()&&ir(),ze.locations.some(r=>r.code===t.code))throw new Error("Location code already exists");const e={...t,id:po("loc-"),createdDate:new Date().toISOString()};return ze.locations.push(e),e},async update(t,e){await Vt(),or()&&ir();const r=ze.locations.findIndex(n=>n.id===t);if(r===-1)throw new Error("Location not found");if(e.code&&ze.locations.some(n=>n.id!==t&&n.code===e.code))throw new Error("Location code already exists");return ze.locations[r]={...ze.locations[r],...e},ze.locations[r]}},movements:{async getAll(t){await Vt(),or()&&ir();let e=[...ze.movements];if(t?.productId&&(e=e.filter(r=>r.productId===t.productId)),t?.locationId&&(e=e.filter(r=>r.locationId===t.locationId)),t?.movementType&&(e=e.filter(r=>r.movementType===t.movementType)),t?.dateFrom&&(e=e.filter(r=>r.createdDate>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.createdDate<=t.dateTo)),t?.search){const r=t.search.toLowerCase();e=e.filter(n=>n.productName.toLowerCase().includes(r)||n.productSku.toLowerCase().includes(r)||n.referenceNumber.toLowerCase().includes(r)||n.notes.toLowerCase().includes(r))}return e.sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime()),e},async getById(t){return await Vt(),ze.movements.find(e=>e.id===t)||null},async create(t){if(await Vt(),or()&&ir(),!ze.products.find(o=>o.id===t.productId))throw new Error("Product not found");if(!ze.locations.find(o=>o.id===t.locationId))throw new Error("Location not found");if(t.movementType==="out"){const o=await this.getStockLevel(t.productId,t.locationId);if(o<t.quantity)throw new Error(`Insufficient stock. Available: ${o}, Requested: ${t.quantity}`)}const n={...t,id:po("mov-"),createdDate:new Date().toISOString()};return ze.movements.push(n),n},async update(t,e){await Vt(),or()&&ir();const r=ze.movements.findIndex(o=>o.id===t);if(r===-1)throw new Error("Movement not found");const n={...ze.movements[r],...e,lastModified:new Date().toISOString()};return ze.movements[r]=n,n},async delete(t){await Vt(),or()&&ir();const e=ze.movements.findIndex(r=>r.id===t);if(e===-1)throw new Error("Movement not found");return ze.movements.splice(e,1),{success:!0,message:"Movement deleted successfully"}},async createBulk(t){await Vt(),or()&&ir();const e=[],r=[],n=new Date().toISOString(),o=ze.locations.find(i=>i.id===t.locationId);if(!o)return{success:!1,movements:[],errors:["Invalid location"]};for(let i=0;i<t.items.length;i++){const a=t.items[i],c=ze.products.find(y=>y.id===a.productId);if(!c){e.push(`Item ${i+1}: Product not found`);continue}if(a.quantity<=0){e.push(`Item ${i+1}: Quantity must be greater than 0`);continue}if(t.movementType==="out"){const y=await this.getStockLevel(a.productId,t.locationId);if(a.quantity>y){e.push(`Item ${i+1}: Insufficient stock. Available: ${y}, Requested: ${a.quantity}`);continue}}const d=a.unitCost||c.unitCost,h={id:po("mov-"),productId:c.id,productName:c.name,productSku:c.sku,locationId:t.locationId,locationName:o.name,movementType:t.movementType,quantity:a.quantity,unitCost:d,totalCost:a.quantity*d,referenceNumber:t.referenceNumber,notes:a.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:t.fromLocationId?ze.locations.find(y=>y.id===t.fromLocationId)?.name:void 0};r.push(h)}return e.length>0?{success:!1,movements:[],errors:e}:(ze.movements.push(...r),{success:!0,movements:r,errors:[]})},async getStockLevel(t,e){return await Vt(50),ze.movements.filter(r=>r.productId===t&&r.locationId===e).reduce((r,n)=>{switch(n.movementType){case"in":case"adjustment":return r+n.quantity;case"out":return r-n.quantity;case"transfer":return n.locationId===e?r+n.quantity:r;default:return r}},0)},async getStockLevels(){await Vt();const t=new Map;for(const e of ze.movements){const r=`${e.productId}-${e.locationId}`;let n=t.get(r);switch(n||(n={id:r,productId:e.productId,locationId:e.locationId,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType){case"in":case"adjustment":n.quantity+=e.quantity;break;case"out":n.quantity-=e.quantity;break;case"transfer":e.locationId===e.locationId&&(n.quantity+=e.quantity);break}new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost,n.availableQuantity=n.quantity-n.reservedQuantity}return Array.from(t.values())}},accounts:{async getAll(t){await Vt(),or()&&ir();let e=[...ze.accounts];return t?.accountType&&(e=e.filter(r=>r.accountType===t.accountType)),t?.category&&(e=e.filter(r=>r.category===t.category)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await Vt(),ze.accounts.find(e=>e.id===t)||null},async create(t){if(await Vt(),or()&&ir(),ze.accounts.some(r=>r.accountNumber===t.accountNumber))throw new Error("Account number already exists");const e={...t,id:po("acc-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return ze.accounts.push(e),e},async update(t,e){await Vt(),or()&&ir();const r=ze.accounts.findIndex(n=>n.id===t);if(r===-1)throw new Error("Account not found");if(e.accountNumber&&ze.accounts.some(n=>n.id!==t&&n.accountNumber===e.accountNumber))throw new Error("Account number already exists");return ze.accounts[r]={...ze.accounts[r],...e,lastModified:new Date().toISOString()},ze.accounts[r]}},journal:{async getAll(t){await Vt(),or()&&ir();let e=[...ze.journalEntries];return t?.status&&(e=e.filter(r=>r.status===t.status)),t?.accountId&&(e=e.filter(r=>r.lines.some(n=>n.accountId===t.accountId))),t?.dateFrom&&(e=e.filter(r=>r.date>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.date<=t.dateTo)),e.sort((r,n)=>new Date(n.createdAt).getTime()-new Date(r.createdAt).getTime())},async getById(t){return await Vt(),ze.journalEntries.find(e=>e.id===t)||null},async create(t){await Vt(),or()&&ir();const e=t.lines.reduce((c,d)=>c+(d.debitAmount||0),0),r=t.lines.reduce((c,d)=>c+(d.creditAmount||0),0);if(Math.abs(e-r)>.01)throw new Error(`Entry is not balanced. Debit: ${e}, Credit: ${r}`);const n=ze.journalEntries.sort((c,d)=>d.entryNumber.localeCompare(c.entryNumber))[0],i=`JE-${((n?parseInt(n.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`,a={...t,id:po("je-"),entryNumber:i,createdAt:new Date().toISOString(),lines:t.lines.map(c=>({...c,id:po("jel-")}))};return ze.journalEntries.push(a),a},async update(t,e){await Vt(),or()&&ir();const r=ze.journalEntries.findIndex(n=>n.id===t);if(r===-1)throw new Error("Journal entry not found");if(ze.journalEntries[r].status==="posted")throw new Error("Cannot modify posted entries");return ze.journalEntries[r]={...ze.journalEntries[r],...e},ze.journalEntries[r]},async post(t){await Vt(),or()&&ir();const e=ze.journalEntries.findIndex(i=>i.id===t);if(e===-1)throw new Error("Journal entry not found");const r=ze.journalEntries[e];if(r.status==="posted")throw new Error("Entry is already posted");const n=r.lines.reduce((i,a)=>i+(a.debitAmount||0),0),o=r.lines.reduce((i,a)=>i+(a.creditAmount||0),0);if(Math.abs(n-o)>.01)throw new Error("Entry must be balanced before posting");return ze.journalEntries[e]={...r,status:"posted",postedAt:new Date().toISOString()},r.lines.forEach(i=>{const a=ze.accounts.findIndex(c=>c.id===i.accountId);if(a!==-1){const c=ze.accounts[a],d=i.debitAmount||0,h=i.creditAmount||0;["asset","expense"].includes(c.accountType)?c.balance+=d-h:c.balance+=h-d}}),ze.journalEntries[e]}},utils:{async getNextEntryNumber(){await Vt(100);const t=ze.journalEntries.sort((r,n)=>n.entryNumber.localeCompare(r.entryNumber))[0];return`JE-${((t?parseInt(t.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`},async getNextProductCode(t){await Vt(100);const e=t.toUpperCase().slice(0,3),r=ze.products.filter(o=>o.productCode?.startsWith(e)).sort((o,i)=>(i.productCode||"").localeCompare(o.productCode||""));if(r.length===0)return`${e}001`;const n=parseInt(r[0].productCode?.slice(-3)||"0");return`${e}${(n+1).toString().padStart(3,"0")}`},async healthCheck(){return await Vt(50),{status:"healthy",timestamp:new Date().toISOString(),version:"1.0.0"}},async resetDatabase(){return await Vt(200),ze={products:[...ze.products.slice(0,3)],locations:[...ze.locations.slice(0,3)],movements:[...ze.movements.slice(0,2)],accounts:[...ze.accounts.slice(0,2)],journalEntries:[...ze.journalEntries.slice(0,1)]},{success:!0,message:"Database reset to initial state"}},async getStats(){return await Vt(100),{products:ze.products.length,locations:ze.locations.length,movements:ze.movements.length,accounts:ze.accounts.length,journalEntries:ze.journalEntries.length,totalStockValue:ze.movements.reduce((t,e)=>e.movementType==="in"?t+e.totalCost:e.movementType==="out"?t-e.totalCost:t,0)}}}},Qm=(t=16)=>{const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},ud=(t=16)=>{const e="123456789";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},yl=t=>typeof t=="string"&&t.trim().length>0,wn=async t=>{const n=await fetch("https://qvamarkets.com/gql_api",{method:"POST",headers:{"Content-Type":"application/json","Accept-Encoding":"gzip, deflate, br",Authorization:"eyJhbGciOiJSUzI1NiIsImtpZCI6IjhlOGZjOGU1NTZmN2E3NmQwOGQzNTgyOWQ2ZjkwYWUyZTEyY2ZkMGQiLCJ0eXAiOiJKV1QifQ"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const o=await n.json();if(o.errors)throw new Error(o.errors[0]?.message||"GraphQL error");return o.data},av=t=>({ENTRY:"in",in:"in",TRANSFER:"transfer",transfer:"transfer",SALES:"out",out:"out",adjustment:"adjustment"})[t],Ql=t=>({ENTRY:"ENTRY",in:"ENTRY",TRANSFER:"TRANSFER",transfer:"TRANSFER",SALES:"SALES",out:"SALES",adjustment:"adjustment"})[t];function Jl(t){var e=[];return t&&Object.keys(t).map(r=>{e.push(t[r])}),e}function lv(t){if(!/^[a-z0-9+/]+={0,2}$/i.test(t)||t.length%4!=0)throw Error("Not base64 string");for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r,n,o,i,a,c,d,h,y=[],v=0;v<t.length;v+=4)i=e.indexOf(t.charAt(v)),a=e.indexOf(t.charAt(v+1)),c=e.indexOf(t.charAt(v+2)),d=e.indexOf(t.charAt(v+3)),h=i<<18|a<<12|c<<6|d,r=h>>>16&255,n=h>>>8&255,o=h&255,y[v/4]=String.fromCharCode(r,n,o),d==64&&(y[v/4]=String.fromCharCode(r,n)),c==64&&(y[v/4]=String.fromCharCode(r));return t=y.join(""),t}const cv=async()=>({}),uv=()=>(typeof window<"u"&&localStorage.getItem("hrmfinance-api-mode"),"real");let wo=uv();const es={getMode(){return wo},setMode(t){wo=t,typeof window<"u"&&localStorage.setItem("hrmfinance-api-mode",t)},isFakeMode(){return wo==="fake"},isRealMode(){return wo==="real"},isHybridMode(){return wo==="hybrid"}},Gr=async(t,e,r=!0)=>{if(wo==="fake")return e();if(wo==="real")return t();try{return await t()}catch(n){if(console.warn("Real API failed, falling back to fake server:",n),r)return e();throw n}},dd={async getAll(t,e){const r=await wn({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:{businessId:"YB100423253156428",":search0":"produ"}});return Jl(r)},async getById(t){return Gr(async()=>(await this.getAll()).find(r=>r.id===t)||null,()=>Or.products.getById(t))},async create(t){return Gr(async()=>{throw console.log("Creating product via real API:",t),new Error("Real API not implemented yet")},()=>Or.products.create(t))},async update(t,e){return Gr(async()=>{throw console.log("Updating product via real API:",t,e),new Error("Real API not implemented yet")},()=>Or.products.update(t,e))},async delete(t){return Gr(async()=>{throw console.log("Deleting product via real API:",t),new Error("Real API not implemented yet")},()=>Or.products.delete(t))}},ln={async getInventory(t,e){if(!(t&&t?.trim()))return[];let r={businessId:"YB100423253156428"};return t&&t.split(" ").map((i,a)=>{i&&(r[":search"+a]=i.trim())}),await wn({query:"getScanYabaInventory",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async getProducts(t){if(!(t&&t?.trim()))return[];let e={businessId:"YB100423253156428"};return t&&t.split(" ").map((o,i)=>{o&&(e[":search"+i]=o.trim())}),await wn({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async getInvoice(t,e){if(!(t&&t?.trim()))return[];let r={businessId:"YB100423253156428"};return t&&t.split(" ").map((i,a)=>{i&&(r[":search"+a]=i.trim())}),await wn({query:"getScanYabaSalesOrders",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async addInventory(t){let r={query:"addYabaInventory",params:{businessId:"YB100423253156428"},form:t};const n=await wn(r);return console.log(r),console.log(n),n},async updInventory(t){return await cv()}},hd={async getAll(t){return Gr(async()=>{throw console.log("Getting accounts via real API:",t),new Error("Real API not implemented yet")},()=>Or.accounts.getAll(t))},async getById(t){return Gr(async()=>{throw console.log("Getting account by ID via real API:",t),new Error("Real API not implemented yet")},()=>Or.accounts.getById(t))},async create(t){return Gr(async()=>{throw console.log("Creating account via real API:",t),new Error("Real API not implemented yet")},()=>Or.accounts.create(t))},async update(t,e){return Gr(async()=>{throw console.log("Updating account via real API:",t,e),new Error("Real API not implemented yet")},()=>Or.accounts.update(t,e))}},md={async getNextEntryNumber(){return Gr(async()=>{throw console.log("Getting next entry number via real API"),new Error("Real API not implemented yet")},()=>Or.utils.getNextEntryNumber())},async getNextProductCode(t){return Gr(async()=>{throw console.log("Getting next product code via real API:",t),new Error("Real API not implemented yet")},()=>Or.utils.getNextProductCode(t))},async healthCheck(){return Gr(async()=>{const t=await fetch("/api/health");if(!t.ok)throw new Error("Health check failed");return t.json()},()=>Or.utils.healthCheck())},async getStats(){return Gr(async()=>{throw console.log("Getting stats via real API"),new Error("Real API not implemented yet")},()=>Or.utils.getStats())}},dv=()=>{es.setMode("real"),console.log(" HRM Finance initialized in REAL API mode for production")};dv();const hv=()=>{};var yd={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jm=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let o=t.charCodeAt(n);o<128?e[r++]=o:o<2048?(e[r++]=o>>6|192,e[r++]=o&63|128):(o&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(o=65536+((o&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=o>>18|240,e[r++]=o>>12&63|128,e[r++]=o>>6&63|128,e[r++]=o&63|128):(e[r++]=o>>12|224,e[r++]=o>>6&63|128,e[r++]=o&63|128)}return e},mv=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const o=t[r++];if(o<128)e[n++]=String.fromCharCode(o);else if(o>191&&o<224){const i=t[r++];e[n++]=String.fromCharCode((o&31)<<6|i&63)}else if(o>239&&o<365){const i=t[r++],a=t[r++],c=t[r++],d=((o&7)<<18|(i&63)<<12|(a&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(d>>10)),e[n++]=String.fromCharCode(56320+(d&1023))}else{const i=t[r++],a=t[r++];e[n++]=String.fromCharCode((o&15)<<12|(i&63)<<6|a&63)}}return e.join("")},Xm={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let o=0;o<t.length;o+=3){const i=t[o],a=o+1<t.length,c=a?t[o+1]:0,d=o+2<t.length,h=d?t[o+2]:0,y=i>>2,v=(i&3)<<4|c>>4;let w=(c&15)<<2|h>>6,E=h&63;d||(E=64,a||(w=64)),n.push(r[y],r[v],r[w],r[E])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Jm(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):mv(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let o=0;o<t.length;){const i=r[t.charAt(o++)],c=o<t.length?r[t.charAt(o)]:0;++o;const h=o<t.length?r[t.charAt(o)]:64;++o;const v=o<t.length?r[t.charAt(o)]:64;if(++o,i==null||c==null||h==null||v==null)throw new yv;const w=i<<2|c>>4;if(n.push(w),h!==64){const E=c<<4&240|h>>2;if(n.push(E),v!==64){const V=h<<6&192|v;n.push(V)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class yv extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const fv=function(t){const e=Jm(t);return Xm.encodeByteArray(e,!0)},ga=function(t){return fv(t).replace(/\./g,"")},Zm=function(t){try{return Xm.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pv(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gv=()=>pv().__FIREBASE_DEFAULTS__,vv=()=>{if(typeof process>"u"||typeof yd>"u")return;const t=yd.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},bv=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Zm(t[1]);return e&&JSON.parse(e)},Ba=()=>{try{return hv()||gv()||vv()||bv()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},ey=t=>Ba()?.emulatorHosts?.[t],_v=t=>{const e=ey(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},ty=()=>Ba()?.config,ry=t=>Ba()?.[`_${t}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sv{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yi(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function ny(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pv(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",o=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${n}`,aud:n,iat:o,exp:o+3600,auth_time:o,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[ga(JSON.stringify(r)),ga(JSON.stringify(a)),""].join(".")}const qi={};function wv(){const t={prod:[],emulator:[]};for(const e of Object.keys(qi))qi[e]?t.emulator.push(e):t.prod.push(e);return t}function Cv(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let fd=!1;function oy(t,e){if(typeof window>"u"||typeof document>"u"||!yi(window.location.host)||qi[t]===e||qi[t]||fd)return;qi[t]=e;function r(w){return`__firebase__banner__${w}`}const n="__firebase__banner",i=wv().prod.length>0;function a(){const w=document.getElementById(n);w&&w.remove()}function c(w){w.style.display="flex",w.style.background="#7faaf0",w.style.position="fixed",w.style.bottom="5px",w.style.left="5px",w.style.padding=".5em",w.style.borderRadius="5px",w.style.alignItems="center"}function d(w,E){w.setAttribute("width","24"),w.setAttribute("id",E),w.setAttribute("height","24"),w.setAttribute("viewBox","0 0 24 24"),w.setAttribute("fill","none"),w.style.marginLeft="-6px"}function h(){const w=document.createElement("span");return w.style.cursor="pointer",w.style.marginLeft="16px",w.style.fontSize="24px",w.innerHTML=" &times;",w.onclick=()=>{fd=!0,a()},w}function y(w,E){w.setAttribute("id",E),w.innerText="Learn more",w.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",w.setAttribute("target","__blank"),w.style.paddingLeft="5px",w.style.textDecoration="underline"}function v(){const w=Cv(n),E=r("text"),V=document.getElementById(E)||document.createElement("span"),N=r("learnmore"),x=document.getElementById(N)||document.createElement("a"),k=r("preprendIcon"),re=document.getElementById(k)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(w.created){const ae=w.element;c(ae),y(x,N);const F=h();d(re,k),ae.append(re,V,x,F),document.body.appendChild(ae)}i?(V.innerText="Preview backend disconnected.",re.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(re.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,V.innerText="Preview backend running in this workspace."),V.setAttribute("id",E)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $r(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Av(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test($r())}function xv(){const t=Ba()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Iv(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Ev(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function $v(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Tv(){const t=$r();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function kv(){return!xv()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Rv(){try{return typeof indexedDB=="object"}catch{return!1}}function Dv(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(n);o.onsuccess=()=>{o.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},o.onupgradeneeded=()=>{r=!1},o.onerror=()=>{e(o.error?.message||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nv="FirebaseError";class Ln extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=Nv,Object.setPrototypeOf(this,Ln.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,hs.prototype.create)}}class hs{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},o=`${this.service}/${e}`,i=this.errors[e],a=i?Lv(i,n):"Error",c=`${this.serviceName}: ${a} (${o}).`;return new Ln(o,c,n)}}function Lv(t,e){return t.replace(Mv,(r,n)=>{const o=e[n];return o!=null?String(o):`<${n}?>`})}const Mv=/\{\$([^}]+)}/g;function Ov(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function $o(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const o of r){if(!n.includes(o))return!1;const i=t[o],a=e[o];if(pd(i)&&pd(a)){if(!$o(i,a))return!1}else if(i!==a)return!1}for(const o of n)if(!r.includes(o))return!1;return!0}function pd(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ms(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(o=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Vv(t,e){const r=new Fv(t,e);return r.subscribe.bind(r)}class Fv{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let o;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");Bv(e,["next","error","complete"])?o=e:o={next:e,error:r,complete:n},o.next===void 0&&(o.next=fl),o.error===void 0&&(o.error=fl),o.complete===void 0&&(o.complete=fl);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Bv(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function fl(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vr(t){return t&&t._delegate?t._delegate:t}class To{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const So="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new Sv;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:r});o&&n.resolve(o)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(n)return null;throw o}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(zv(e))try{this.getOrInitializeService({instanceIdentifier:So})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:o});n.resolve(i)}catch{}}}}clearInstance(e=So){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=So){return this.instances.has(e)}getOptions(e=So){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);n===c&&a.resolve(o)}return o}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),o=this.onInitCallbacks.get(n)??new Set;o.add(e),this.onInitCallbacks.set(n,o);const i=this.instances.get(n);return i&&e(i,n),()=>{o.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const o of n)try{o(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:jv(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=So){return this.component?this.component.multipleInstances?e:So:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function jv(t){return t===So?void 0:t}function zv(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qv{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new Uv(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(xt||(xt={}));const Gv={debug:xt.DEBUG,verbose:xt.VERBOSE,info:xt.INFO,warn:xt.WARN,error:xt.ERROR,silent:xt.SILENT},Hv=xt.INFO,Wv={[xt.DEBUG]:"log",[xt.VERBOSE]:"log",[xt.INFO]:"info",[xt.WARN]:"warn",[xt.ERROR]:"error"},Yv=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),o=Wv[e];if(o)console[o](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Nc{constructor(e){this.name=e,this._logLevel=Hv,this._logHandler=Yv,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in xt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Gv[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,xt.DEBUG,...e),this._logHandler(this,xt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,xt.VERBOSE,...e),this._logHandler(this,xt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,xt.INFO,...e),this._logHandler(this,xt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,xt.WARN,...e),this._logHandler(this,xt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,xt.ERROR,...e),this._logHandler(this,xt.ERROR,...e)}}const Kv=(t,e)=>e.some(r=>t instanceof r);let gd,vd;function Qv(){return gd||(gd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Jv(){return vd||(vd=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const iy=new WeakMap,Xl=new WeakMap,sy=new WeakMap,pl=new WeakMap,Lc=new WeakMap;function Xv(t){const e=new Promise((r,n)=>{const o=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{r(Kn(t.result)),o()},a=()=>{n(t.error),o()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&iy.set(r,t)}).catch(()=>{}),Lc.set(e,t),e}function Zv(t){if(Xl.has(t))return;const e=new Promise((r,n)=>{const o=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{r(),o()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),o()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});Xl.set(t,e)}let Zl={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Xl.get(t);if(e==="objectStoreNames")return t.objectStoreNames||sy.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Kn(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function eb(t){Zl=t(Zl)}function tb(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(gl(this),e,...r);return sy.set(n,e.sort?e.sort():[e]),Kn(n)}:Jv().includes(t)?function(...e){return t.apply(gl(this),e),Kn(iy.get(this))}:function(...e){return Kn(t.apply(gl(this),e))}}function rb(t){return typeof t=="function"?tb(t):(t instanceof IDBTransaction&&Zv(t),Kv(t,Qv())?new Proxy(t,Zl):t)}function Kn(t){if(t instanceof IDBRequest)return Xv(t);if(pl.has(t))return pl.get(t);const e=rb(t);return e!==t&&(pl.set(t,e),Lc.set(e,t)),e}const gl=t=>Lc.get(t);function nb(t,e,{blocked:r,upgrade:n,blocking:o,terminated:i}={}){const a=indexedDB.open(t,e),c=Kn(a);return n&&a.addEventListener("upgradeneeded",d=>{n(Kn(a.result),d.oldVersion,d.newVersion,Kn(a.transaction),d)}),r&&a.addEventListener("blocked",d=>r(d.oldVersion,d.newVersion,d)),c.then(d=>{i&&d.addEventListener("close",()=>i()),o&&d.addEventListener("versionchange",h=>o(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const ob=["get","getKey","getAll","getAllKeys","count"],ib=["put","add","delete","clear"],vl=new Map;function bd(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(vl.get(e))return vl.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,o=ib.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(o||ob.includes(r)))return;const i=async function(a,...c){const d=this.transaction(a,o?"readwrite":"readonly");let h=d.store;return n&&(h=h.index(c.shift())),(await Promise.all([h[r](...c),o&&d.done]))[0]};return vl.set(e,i),i}eb(t=>({...t,get:(e,r,n)=>bd(e,r)||t.get(e,r,n),has:(e,r)=>!!bd(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sb{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(ab(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function ab(t){return t.getComponent()?.type==="VERSION"}const ec="@firebase/app",_d="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $n=new Nc("@firebase/app"),lb="@firebase/app-compat",cb="@firebase/analytics-compat",ub="@firebase/analytics",db="@firebase/app-check-compat",hb="@firebase/app-check",mb="@firebase/auth",yb="@firebase/auth-compat",fb="@firebase/database",pb="@firebase/data-connect",gb="@firebase/database-compat",vb="@firebase/functions",bb="@firebase/functions-compat",_b="@firebase/installations",Sb="@firebase/installations-compat",Pb="@firebase/messaging",wb="@firebase/messaging-compat",Cb="@firebase/performance",Ab="@firebase/performance-compat",xb="@firebase/remote-config",Ib="@firebase/remote-config-compat",Eb="@firebase/storage",$b="@firebase/storage-compat",Tb="@firebase/firestore",kb="@firebase/ai",Rb="@firebase/firestore-compat",Db="firebase",Nb="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tc="[DEFAULT]",Lb={[ec]:"fire-core",[lb]:"fire-core-compat",[ub]:"fire-analytics",[cb]:"fire-analytics-compat",[hb]:"fire-app-check",[db]:"fire-app-check-compat",[mb]:"fire-auth",[yb]:"fire-auth-compat",[fb]:"fire-rtdb",[pb]:"fire-data-connect",[gb]:"fire-rtdb-compat",[vb]:"fire-fn",[bb]:"fire-fn-compat",[_b]:"fire-iid",[Sb]:"fire-iid-compat",[Pb]:"fire-fcm",[wb]:"fire-fcm-compat",[Cb]:"fire-perf",[Ab]:"fire-perf-compat",[xb]:"fire-rc",[Ib]:"fire-rc-compat",[Eb]:"fire-gcs",[$b]:"fire-gcs-compat",[Tb]:"fire-fst",[Rb]:"fire-fst-compat",[kb]:"fire-vertex","fire-js":"fire-js",[Db]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const va=new Map,Mb=new Map,rc=new Map;function Sd(t,e){try{t.container.addComponent(e)}catch(r){$n.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function ii(t){const e=t.name;if(rc.has(e))return $n.debug(`There were multiple attempts to register component ${e}.`),!1;rc.set(e,t);for(const r of va.values())Sd(r,t);for(const r of Mb.values())Sd(r,t);return!0}function Mc(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function zr(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ob={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Qn=new hs("app","Firebase",Ob);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vb{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new To("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Qn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fi=Nb;function ay(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:tc,automaticDataCollectionEnabled:!0,...e},o=n.name;if(typeof o!="string"||!o)throw Qn.create("bad-app-name",{appName:String(o)});if(r||(r=ty()),!r)throw Qn.create("no-options");const i=va.get(o);if(i){if($o(r,i.options)&&$o(n,i.config))return i;throw Qn.create("duplicate-app",{appName:o})}const a=new qv(o);for(const d of rc.values())a.addComponent(d);const c=new Vb(r,n,a);return va.set(o,c),c}function ly(t=tc){const e=va.get(t);if(!e&&t===tc&&ty())return ay();if(!e)throw Qn.create("no-app",{appName:t});return e}function Jn(t,e,r){let n=Lb[t]??t;r&&(n+=`-${r}`);const o=n.match(/\s|\//),i=e.match(/\s|\//);if(o||i){const a=[`Unable to register library "${n}" with version "${e}":`];o&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),o&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),$n.warn(a.join(" "));return}ii(new To(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fb="firebase-heartbeat-database",Bb=1,ts="firebase-heartbeat-store";let bl=null;function cy(){return bl||(bl=nb(Fb,Bb,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ts)}catch(r){console.warn(r)}}}}).catch(t=>{throw Qn.create("idb-open",{originalErrorMessage:t.message})})),bl}async function Ub(t){try{const r=(await cy()).transaction(ts),n=await r.objectStore(ts).get(uy(t));return await r.done,n}catch(e){if(e instanceof Ln)$n.warn(e.message);else{const r=Qn.create("idb-get",{originalErrorMessage:e?.message});$n.warn(r.message)}}}async function Pd(t,e){try{const n=(await cy()).transaction(ts,"readwrite");await n.objectStore(ts).put(e,uy(t)),await n.done}catch(r){if(r instanceof Ln)$n.warn(r.message);else{const n=Qn.create("idb-set",{originalErrorMessage:r?.message});$n.warn(n.message)}}}function uy(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jb=1024,zb=30;class qb{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new Hb(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=wd();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(o=>o.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>zb){const o=Wb(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){$n.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=wd(),{heartbeatsToSend:r,unsentEntries:n}=Gb(this._heartbeatsCache.heartbeats),o=ga(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(e){return $n.warn(e),""}}}function wd(){return new Date().toISOString().substring(0,10)}function Gb(t,e=jb){const r=[];let n=t.slice();for(const o of t){const i=r.find(a=>a.agent===o.agent);if(i){if(i.dates.push(o.date),Cd(r)>e){i.dates.pop();break}}else if(r.push({agent:o.agent,dates:[o.date]}),Cd(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class Hb{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Rv()?Dv().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Ub(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Pd(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Pd(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Cd(t){return ga(JSON.stringify({version:2,heartbeats:t})).length}function Wb(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yb(t){ii(new To("platform-logger",e=>new sb(e),"PRIVATE")),ii(new To("heartbeat",e=>new qb(e),"PRIVATE")),Jn(ec,_d,t),Jn(ec,_d,"esm2020"),Jn("fire-js","")}Yb("");function dy(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Kb=dy,hy=new hs("auth","Firebase",dy());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ba=new Nc("@firebase/auth");function Qb(t,...e){ba.logLevel<=xt.WARN&&ba.warn(`Auth (${fi}): ${t}`,...e)}function ea(t,...e){ba.logLevel<=xt.ERROR&&ba.error(`Auth (${fi}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fn(t,...e){throw Vc(t,...e)}function Jr(t,...e){return Vc(t,...e)}function Oc(t,e,r){const n={...Kb(),[e]:r};return new hs("auth","Firebase",n).create(e,{appName:t.name})}function Xn(t){return Oc(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function my(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&fn(t,"argument-error"),Oc(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Vc(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return hy.create(t,...e)}function st(t,e,...r){if(!t)throw Vc(e,...r)}function Cn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw ea(e),new Error(e)}function Tn(t,e){t||Cn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nc(){return typeof self<"u"&&self.location?.href||""}function Jb(){return Ad()==="http:"||Ad()==="https:"}function Ad(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xb(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Jb()||Ev()||"connection"in navigator)?navigator.onLine:!0}function Zb(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(e,r){this.shortDelay=e,this.longDelay=r,Tn(r>e,"Short delay should be less than long delay!"),this.isMobile=Av()||$v()}get(){return Xb()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fc(t,e){Tn(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yy{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Cn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Cn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Cn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e0={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t0=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],r0=new ys(3e4,6e4);function Bc(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function pi(t,e,r,n,o={}){return fy(t,o,async()=>{let i={},a={};n&&(e==="GET"?a=n:i={body:JSON.stringify(n)});const c=ms({key:t.config.apiKey,...a}).slice(1),d=await t._getAdditionalHeaders();d["Content-Type"]="application/json",t.languageCode&&(d["X-Firebase-Locale"]=t.languageCode);const h={method:e,headers:d,...i};return Iv()||(h.referrerPolicy="no-referrer"),t.emulatorConfig&&yi(t.emulatorConfig.host)&&(h.credentials="include"),yy.fetch()(await py(t,t.config.apiHost,r,c),h)})}async function fy(t,e,r){t._canInitEmulator=!1;const n={...e0,...e};try{const o=new o0(t),i=await Promise.race([r(),o.promise]);o.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw Ls(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const c=i.ok?a.errorMessage:a.error.message,[d,h]=c.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ls(t,"credential-already-in-use",a);if(d==="EMAIL_EXISTS")throw Ls(t,"email-already-in-use",a);if(d==="USER_DISABLED")throw Ls(t,"user-disabled",a);const y=n[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Oc(t,y,h);fn(t,y)}}catch(o){if(o instanceof Ln)throw o;fn(t,"network-request-failed",{message:String(o)})}}async function n0(t,e,r,n,o={}){const i=await pi(t,e,r,n,o);return"mfaPendingCredential"in i&&fn(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function py(t,e,r,n){const o=`${e}${r}?${n}`,i=t,a=i.config.emulator?Fc(t.config,o):`${t.config.apiScheme}://${o}`;return t0.includes(r)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}class o0{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Jr(this.auth,"network-request-failed")),r0.get())})}}function Ls(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const o=Jr(t,e,n);return o.customData._tokenResponse=r,o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i0(t,e){return pi(t,"POST","/v1/accounts:delete",e)}async function _a(t,e){return pi(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gi(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function s0(t,e=!1){const r=vr(t),n=await r.getIdToken(e),o=Uc(n);st(o&&o.exp&&o.auth_time&&o.iat,r.auth,"internal-error");const i=typeof o.firebase=="object"?o.firebase:void 0,a=i?.sign_in_provider;return{claims:o,token:n,authTime:Gi(_l(o.auth_time)),issuedAtTime:Gi(_l(o.iat)),expirationTime:Gi(_l(o.exp)),signInProvider:a||null,signInSecondFactor:i?.sign_in_second_factor||null}}function _l(t){return Number(t)*1e3}function Uc(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return ea("JWT malformed, contained fewer than 3 sections"),null;try{const o=Zm(r);return o?JSON.parse(o):(ea("Failed to decode base64 JWT payload"),null)}catch(o){return ea("Caught error parsing JWT payload as JSON",o?.toString()),null}}function xd(t){const e=Uc(t);return st(e,"internal-error"),st(typeof e.exp<"u","internal-error"),st(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rs(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Ln&&a0(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function a0({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l0{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Gi(this.lastLoginAt),this.creationTime=Gi(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sa(t){const e=t.auth,r=await t.getIdToken(),n=await rs(t,_a(e,{idToken:r}));st(n?.users.length,e,"internal-error");const o=n.users[0];t._notifyReloadListener(o);const i=o.providerUserInfo?.length?gy(o.providerUserInfo):[],a=u0(t.providerData,i),c=t.isAnonymous,d=!(t.email&&o.passwordHash)&&!a?.length,h=c?d:!1,y={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new oc(o.createdAt,o.lastLoginAt),isAnonymous:h};Object.assign(t,y)}async function c0(t){const e=vr(t);await Sa(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function u0(t,e){return[...t.filter(n=>!e.some(o=>o.providerId===n.providerId)),...e]}function gy(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d0(t,e){const r=await fy(t,{},async()=>{const n=ms({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:i}=t.config,a=await py(t,o,"/v1/token",`key=${i}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const d={method:"POST",headers:c,body:n};return t.emulatorConfig&&yi(t.emulatorConfig.host)&&(d.credentials="include"),yy.fetch()(a,d)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function h0(t,e){return pi(t,"POST","/v2/accounts:revokeToken",Bc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){st(e.idToken,"internal-error"),st(typeof e.idToken<"u","internal-error"),st(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):xd(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){st(e.length!==0,"internal-error");const r=xd(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(st(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:o,expiresIn:i}=await d0(e,r);this.updateTokensAndExpiration(n,o,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:o,expirationTime:i}=r,a=new ei;return n&&(st(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),o&&(st(typeof o=="string","internal-error",{appName:e}),a.accessToken=o),i&&(st(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ei,this.toJSON())}_performRefresh(){return Cn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Un(t,e){st(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Qr{constructor({uid:e,auth:r,stsTokenManager:n,...o}){this.providerId="firebase",this.proactiveRefresh=new l0(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new oc(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const r=await rs(this,this.stsTokenManager.getToken(this.auth,e));return st(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return s0(this,e)}reload(){return c0(this)}_assign(e){this!==e&&(st(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Qr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){st(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Sa(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(zr(this.auth.app))return Promise.reject(Xn(this.auth));const e=await this.getIdToken();return await rs(this,i0(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,o=r.email??void 0,i=r.phoneNumber??void 0,a=r.photoURL??void 0,c=r.tenantId??void 0,d=r._redirectEventId??void 0,h=r.createdAt??void 0,y=r.lastLoginAt??void 0,{uid:v,emailVerified:w,isAnonymous:E,providerData:V,stsTokenManager:N}=r;st(v&&N,e,"internal-error");const x=ei.fromJSON(this.name,N);st(typeof v=="string",e,"internal-error"),Un(n,e.name),Un(o,e.name),st(typeof w=="boolean",e,"internal-error"),st(typeof E=="boolean",e,"internal-error"),Un(i,e.name),Un(a,e.name),Un(c,e.name),Un(d,e.name),Un(h,e.name),Un(y,e.name);const k=new Qr({uid:v,auth:e,email:o,emailVerified:w,displayName:n,isAnonymous:E,photoURL:a,phoneNumber:i,tenantId:c,stsTokenManager:x,createdAt:h,lastLoginAt:y});return V&&Array.isArray(V)&&(k.providerData=V.map(re=>({...re}))),d&&(k._redirectEventId=d),k}static async _fromIdTokenResponse(e,r,n=!1){const o=new ei;o.updateFromServerResponse(r);const i=new Qr({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:n});return await Sa(i),i}static async _fromGetAccountInfoResponse(e,r,n){const o=r.users[0];st(o.localId!==void 0,"internal-error");const i=o.providerUserInfo!==void 0?gy(o.providerUserInfo):[],a=!(o.email&&o.passwordHash)&&!i?.length,c=new ei;c.updateFromIdToken(n);const d=new Qr({uid:o.localId,auth:e,stsTokenManager:c,isAnonymous:a}),h={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:i,metadata:new oc(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!i?.length};return Object.assign(d,h),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Id=new Map;function An(t){Tn(t instanceof Function,"Expected a class definition");let e=Id.get(t);return e?(Tn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Id.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vy{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}vy.type="NONE";const Ed=vy;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ta(t,e,r){return`firebase:${t}:${e}:${r}`}class ti{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:o,name:i}=this.auth;this.fullUserKey=ta(this.userKey,o.apiKey,i),this.fullPersistenceKey=ta("persistence",o.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await _a(this.auth,{idToken:e}).catch(()=>{});return r?Qr._fromGetAccountInfoResponse(this.auth,r,e):null}return Qr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new ti(An(Ed),e,n);const o=(await Promise.all(r.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=o[0]||An(Ed);const a=ta(n,e.config.apiKey,e.name);let c=null;for(const h of r)try{const y=await h._get(a);if(y){let v;if(typeof y=="string"){const w=await _a(e,{idToken:y}).catch(()=>{});if(!w)break;v=await Qr._fromGetAccountInfoResponse(e,w,y)}else v=Qr._fromJSON(e,y);h!==i&&(c=v),i=h;break}}catch{}const d=o.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!d.length?new ti(i,e,n):(i=d[0],c&&await i._set(a,c.toJSON()),await Promise.all(r.map(async h=>{if(h!==i)try{await h._remove(a)}catch{}})),new ti(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $d(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Py(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(by(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Cy(e))return"Blackberry";if(Ay(e))return"Webos";if(_y(e))return"Safari";if((e.includes("chrome/")||Sy(e))&&!e.includes("edge/"))return"Chrome";if(wy(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function by(t=$r()){return/firefox\//i.test(t)}function _y(t=$r()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Sy(t=$r()){return/crios\//i.test(t)}function Py(t=$r()){return/iemobile/i.test(t)}function wy(t=$r()){return/android/i.test(t)}function Cy(t=$r()){return/blackberry/i.test(t)}function Ay(t=$r()){return/webos/i.test(t)}function jc(t=$r()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function m0(t=$r()){return jc(t)&&!!window.navigator?.standalone}function y0(){return Tv()&&document.documentMode===10}function xy(t=$r()){return jc(t)||wy(t)||Ay(t)||Cy(t)||/windows phone/i.test(t)||Py(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iy(t,e=[]){let r;switch(t){case"Browser":r=$d($r());break;case"Worker":r=`${$d($r())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${fi}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f0{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((a,c)=>{try{const d=e(i);a(d)}catch(d){c(d)}});n.onAbort=r,this.queue.push(n);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const o of r)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p0(t,e={}){return pi(t,"GET","/v2/passwordPolicy",Bc(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g0=6;class v0{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??g0,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),o&&(r.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let o=0;o<e.length;o++)n=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,o,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b0{constructor(e,r,n,o){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Td(this),this.idTokenSubscription=new Td(this),this.beforeStateQueue=new f0(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=hy,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=An(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await ti.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await _a(this,{idToken:e}),n=await Qr._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(zr(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,a=n?._redirectEventId,c=await this.tryRedirectSignIn(e);(!i||i===a)&&c?.user&&(n=c.user,o=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(n)}catch(i){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return st(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Sa(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Zb()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(zr(this.app))return Promise.reject(Xn(this));const r=e?vr(e):null;return r&&st(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&st(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return zr(this.app)?Promise.reject(Xn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return zr(this.app)?Promise.reject(Xn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(An(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await p0(this),r=new v0(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new hs("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await h0(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&An(e)||this._popupRedirectResolver;st(r,this,"argument-error"),this.redirectPersistenceManager=await ti.create(this,[An(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,o){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(st(c,this,"internal-error"),c.then(()=>{a||i(this.currentUser)}),typeof r=="function"){const d=e.addObserver(r,n,o);return()=>{a=!0,d()}}else{const d=e.addObserver(r);return()=>{a=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return st(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Iy(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(zr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Qb(`Error while retrieving App Check token: ${e.error}`),e?.token}}function No(t){return vr(t)}class Td{constructor(e){this.auth=e,this.observer=null,this.addObserver=Vv(r=>this.observer=r)}get next(){return st(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function _0(t){zc=t}function S0(t){return zc.loadJS(t)}function P0(){return zc.gapiScript}function w0(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C0(t,e){const r=Mc(t,"auth");if(r.isInitialized()){const o=r.getImmediate(),i=r.getOptions();if($o(i,e??{}))return o;fn(o,"already-initialized")}return r.initialize({options:e})}function A0(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(An);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function x0(t,e,r){const n=No(t);st(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const o=!1,i=Ey(e),{host:a,port:c}=I0(e),d=c===null?"":`:${c}`,h={url:`${i}//${a}${d}/`},y=Object.freeze({host:a,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!n._canInitEmulator){st(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),st($o(h,n.config.emulator)&&$o(y,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=h,n.emulatorConfig=y,n.settings.appVerificationDisabledForTesting=!0,yi(a)?(ny(`${i}//${a}${d}`),oy("Auth",!0)):E0()}function Ey(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function I0(t){const e=Ey(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(n);if(o){const i=o[1];return{host:i,port:kd(n.substr(i.length+1))}}else{const[i,a]=n.split(":");return{host:i,port:kd(a)}}}function kd(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function E0(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $y{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Cn("not implemented")}_getIdTokenResponse(e){return Cn("not implemented")}_linkToIdToken(e,r){return Cn("not implemented")}_getReauthenticationResolver(e){return Cn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ri(t,e){return n0(t,"POST","/v1/accounts:signInWithIdp",Bc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $0="http://localhost";class ko extends $y{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new ko(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):fn("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:o,...i}=r;if(!n||!o)return null;const a=new ko(n,o);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return ri(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,ri(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,ri(e,r)}buildRequest(){const e={requestUri:$0,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=ms(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs extends Ua{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn extends fs{constructor(){super("facebook.com")}static credential(e){return ko._fromParams({providerId:Gn.PROVIDER_ID,signInMethod:Gn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gn.credentialFromTaggedObject(e)}static credentialFromError(e){return Gn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Gn.credential(e.oauthAccessToken)}catch{return null}}}Gn.FACEBOOK_SIGN_IN_METHOD="facebook.com";Gn.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an extends fs{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return ko._fromParams({providerId:an.PROVIDER_ID,signInMethod:an.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return an.credentialFromTaggedObject(e)}static credentialFromError(e){return an.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return an.credential(r,n)}catch{return null}}}an.GOOGLE_SIGN_IN_METHOD="google.com";an.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn extends fs{constructor(){super("github.com")}static credential(e){return ko._fromParams({providerId:Hn.PROVIDER_ID,signInMethod:Hn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Hn.credentialFromTaggedObject(e)}static credentialFromError(e){return Hn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Hn.credential(e.oauthAccessToken)}catch{return null}}}Hn.GITHUB_SIGN_IN_METHOD="github.com";Hn.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn extends fs{constructor(){super("twitter.com")}static credential(e,r){return ko._fromParams({providerId:Wn.PROVIDER_ID,signInMethod:Wn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Wn.credentialFromTaggedObject(e)}static credentialFromError(e){return Wn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Wn.credential(r,n)}catch{return null}}}Wn.TWITTER_SIGN_IN_METHOD="twitter.com";Wn.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,o=!1){const i=await Qr._fromIdTokenResponse(e,n,o),a=Rd(n);return new si({user:i,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const o=Rd(n);return new si({user:e,providerId:o,_tokenResponse:n,operationType:r})}}function Rd(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa extends Ln{constructor(e,r,n,o){super(r.code,r.message),this.operationType=n,this.user=o,Object.setPrototypeOf(this,Pa.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,o){return new Pa(e,r,n,o)}}function Ty(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Pa._fromErrorAndOperation(t,i,e,n):i})}async function T0(t,e,r=!1){const n=await rs(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return si._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k0(t,e,r=!1){const{auth:n}=t;if(zr(n.app))return Promise.reject(Xn(n));const o="reauthenticate";try{const i=await rs(t,Ty(n,o,e,t),r);st(i.idToken,n,"internal-error");const a=Uc(i.idToken);st(a,n,"internal-error");const{sub:c}=a;return st(t.uid===c,n,"user-mismatch"),si._forOperation(t,o,i)}catch(i){throw i?.code==="auth/user-not-found"&&fn(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ky(t,e,r=!1){if(zr(t.app))return Promise.reject(Xn(t));const n="signIn",o=await Ty(t,n,e),i=await si._fromIdTokenResponse(t,n,o);return r||await t._updateCurrentUser(i.user),i}async function R0(t,e){return ky(No(t),e)}function D0(t,e,r,n){return vr(t).onIdTokenChanged(e,r,n)}function N0(t,e,r){return vr(t).beforeAuthStateChanged(e,r)}function L0(t,e,r,n){return vr(t).onAuthStateChanged(e,r,n)}function M0(t){return vr(t).signOut()}const wa="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ry{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(wa,"1"),this.storage.removeItem(wa),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O0=1e3,V0=10;class Dy extends Ry{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=xy(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),o=this.localCache[r];n!==o&&e(r,o,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,c,d)=>{this.notifyListeners(a,d)});return}const n=e.key;r?this.detachListener():this.stopPolling();const o=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},i=this.storage.getItem(n);y0()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,V0):o()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const o of Array.from(n))o(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},O0)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}Dy.type="LOCAL";const F0=Dy;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny extends Ry{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}Ny.type="SESSION";const Ly=Ny;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B0(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(o=>o.isListeningto(e));if(r)return r;const n=new ja(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:o,data:i}=r.data,a=this.handlersMap[o];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:o});const c=Array.from(a).map(async h=>h(r.origin,i)),d=await B0(c);r.ports[0].postMessage({status:"done",eventId:n,eventType:o,response:d})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ja.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qc(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U0{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let i,a;return new Promise((c,d)=>{const h=qc("",20);o.port1.start();const y=setTimeout(()=>{d(new Error("unsupported_event"))},n);a={messageChannel:o,onMessage(v){const w=v;if(w.data.eventId===h)switch(w.data.status){case"ack":clearTimeout(y),i=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(w.data.response);break;default:clearTimeout(y),clearTimeout(i),d(new Error("invalid_response"));break}}},this.handlers.add(a),o.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:h,data:r},[o.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cn(){return window}function j0(t){cn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function My(){return typeof cn().WorkerGlobalScope<"u"&&typeof cn().importScripts=="function"}async function z0(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function q0(){return navigator?.serviceWorker?.controller||null}function G0(){return My()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oy="firebaseLocalStorageDb",H0=1,Ca="firebaseLocalStorage",Vy="fbase_key";class ps{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function za(t,e){return t.transaction([Ca],e?"readwrite":"readonly").objectStore(Ca)}function W0(){const t=indexedDB.deleteDatabase(Oy);return new ps(t).toPromise()}function ic(){const t=indexedDB.open(Oy,H0);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Ca,{keyPath:Vy})}catch(o){r(o)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Ca)?e(n):(n.close(),await W0(),e(await ic()))})})}async function Dd(t,e,r){const n=za(t,!0).put({[Vy]:e,value:r});return new ps(n).toPromise()}async function Y0(t,e){const r=za(t,!1).get(e),n=await new ps(r).toPromise();return n===void 0?null:n.value}function Nd(t,e){const r=za(t,!0).delete(e);return new ps(r).toPromise()}const K0=800,Q0=3;class Fy{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ic(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>Q0)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return My()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ja._getInstance(G0()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await z0(),!this.activeServiceWorker)return;this.sender=new U0(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||q0()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ic();return await Dd(e,wa,"1"),await Nd(e,wa),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>Dd(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>Y0(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>Nd(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const i=za(o,!1).getAll();return new ps(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:o,value:i}of e)n.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(i)&&(this.notifyListeners(o,i),r.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!n.has(o)&&(this.notifyListeners(o,null),r.push(o));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const o of Array.from(n))o(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),K0)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Fy.type="LOCAL";const J0=Fy;new ys(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gc(t,e){return e?An(e):(st(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hc extends $y{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ri(e,this._buildIdpRequest())}_linkToIdToken(e,r){return ri(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return ri(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function X0(t){return ky(t.auth,new Hc(t),t.bypassAuthState)}function Z0(t){const{auth:e,user:r}=t;return st(r,e,"internal-error"),k0(r,new Hc(t),t.bypassAuthState)}async function e_(t){const{auth:e,user:r}=t;return st(r,e,"internal-error"),T0(r,new Hc(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class By{constructor(e,r,n,o,i=!1){this.auth=e,this.resolver=n,this.user=o,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:o,tenantId:i,error:a,type:c}=e;if(a){this.reject(a);return}const d={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(d))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return X0;case"linkViaPopup":case"linkViaRedirect":return e_;case"reauthViaPopup":case"reauthViaRedirect":return Z0;default:fn(this.auth,"internal-error")}}resolve(e){Tn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Tn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t_=new ys(2e3,1e4);async function r_(t,e,r){if(zr(t.app))return Promise.reject(Jr(t,"operation-not-supported-in-this-environment"));const n=No(t);my(t,e,Ua);const o=Gc(n,r);return new Ao(n,"signInViaPopup",e,o).executeNotNull()}class Ao extends By{constructor(e,r,n,o,i){super(e,r,o,i),this.provider=n,this.authWindow=null,this.pollId=null,Ao.currentPopupAction&&Ao.currentPopupAction.cancel(),Ao.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return st(e,this.auth,"internal-error"),e}async onExecution(){Tn(this.filter.length===1,"Popup operations only handle one event");const e=qc();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Jr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Jr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ao.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Jr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,t_.get())};e()}}Ao.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n_="pendingRedirect",ra=new Map;class o_ extends By{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=ra.get(this.auth._key());if(!e){try{const n=await i_(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}ra.set(this.auth._key(),e)}return this.bypassAuthState||ra.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function i_(t,e){const r=jy(e),n=Uy(t);if(!await n._isAvailable())return!1;const o=await n._get(r)==="true";return await n._remove(r),o}async function s_(t,e){return Uy(t)._set(jy(e),"true")}function a_(t,e){ra.set(t._key(),e)}function Uy(t){return An(t._redirectPersistence)}function jy(t){return ta(n_,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l_(t,e,r){return c_(t,e,r)}async function c_(t,e,r){if(zr(t.app))return Promise.reject(Xn(t));const n=No(t);my(t,e,Ua),await n._initializationPromise;const o=Gc(n,r);return await s_(o,n),o._openRedirect(n,e,"signInViaRedirect")}async function u_(t,e){return await No(t)._initializationPromise,zy(t,e,!1)}async function zy(t,e,r=!1){if(zr(t.app))return Promise.reject(Xn(t));const n=No(t),o=Gc(n,e),a=await new o_(n,o,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d_=10*60*1e3;class h_{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!m_(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!qy(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(Jr(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=d_&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ld(e))}saveEventToCache(e){this.cachedEventUids.add(Ld(e)),this.lastProcessedEventTime=Date.now()}}function Ld(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function qy({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function m_(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return qy(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function y_(t,e={}){return pi(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f_=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,p_=/^https?/;async function g_(t){if(t.config.emulator)return;const{authorizedDomains:e}=await y_(t);for(const r of e)try{if(v_(r))return}catch{}fn(t,"unauthorized-domain")}function v_(t){const e=nc(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!p_.test(r))return!1;if(f_.test(t))return n===t;const o=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b_=new ys(3e4,6e4);function Md(){const t=cn().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function __(t){return new Promise((e,r)=>{function n(){Md(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Md(),r(Jr(t,"network-request-failed"))},timeout:b_.get()})}if(cn().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(cn().gapi?.load)n();else{const o=w0("iframefcb");return cn()[o]=()=>{gapi.load?n():r(Jr(t,"network-request-failed"))},S0(`${P0()}?onload=${o}`).catch(i=>r(i))}}).catch(e=>{throw na=null,e})}let na=null;function S_(t){return na=na||__(t),na}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P_=new ys(5e3,15e3),w_="__/auth/iframe",C_="emulator/auth/iframe",A_={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},x_=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function I_(t){const e=t.config;st(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Fc(e,C_):`https://${t.config.authDomain}/${w_}`,n={apiKey:e.apiKey,appName:t.name,v:fi},o=x_.get(t.config.apiHost);o&&(n.eid=o);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${ms(n).slice(1)}`}async function E_(t){const e=await S_(t),r=cn().gapi;return st(r,t,"internal-error"),e.open({where:document.body,url:I_(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:A_,dontclear:!0},n=>new Promise(async(o,i)=>{await n.restyle({setHideOnLeave:!1});const a=Jr(t,"network-request-failed"),c=cn().setTimeout(()=>{i(a)},P_.get());function d(){cn().clearTimeout(c),o(n)}n.ping(d).then(d,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $_={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},T_=500,k_=600,R_="_blank",D_="http://localhost";class Od{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function N_(t,e,r,n=T_,o=k_){const i=Math.max((window.screen.availHeight-o)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const d={...$_,width:n.toString(),height:o.toString(),top:i,left:a},h=$r().toLowerCase();r&&(c=Sy(h)?R_:r),by(h)&&(e=e||D_,d.scrollbars="yes");const y=Object.entries(d).reduce((w,[E,V])=>`${w}${E}=${V},`,"");if(m0(h)&&c!=="_self")return L_(e||"",c),new Od(null);const v=window.open(e||"",c,y);st(v,t,"popup-blocked");try{v.focus()}catch{}return new Od(v)}function L_(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M_="__/auth/handler",O_="emulator/auth/handler",V_=encodeURIComponent("fac");async function Vd(t,e,r,n,o,i){st(t.config.authDomain,t,"auth-domain-config-required"),st(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:fi,eventId:o};if(e instanceof Ua){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",Ov(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[y,v]of Object.entries({}))a[y]=v}if(e instanceof fs){const y=e.getScopes().filter(v=>v!=="");y.length>0&&(a.scopes=y.join(","))}t.tenantId&&(a.tid=t.tenantId);const c=a;for(const y of Object.keys(c))c[y]===void 0&&delete c[y];const d=await t._getAppCheckToken(),h=d?`#${V_}=${encodeURIComponent(d)}`:"";return`${F_(t)}?${ms(c).slice(1)}${h}`}function F_({config:t}){return t.emulator?Fc(t,O_):`https://${t.authDomain}/${M_}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sl="webStorageSupport";class B_{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ly,this._completeRedirectFn=zy,this._overrideRedirectResult=a_}async _openPopup(e,r,n,o){Tn(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await Vd(e,r,n,nc(),o);return N_(e,i,qc())}async _openRedirect(e,r,n,o){await this._originValidation(e);const i=await Vd(e,r,n,nc(),o);return j0(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:o,promise:i}=this.eventManagers[r];return o?Promise.resolve(o):(Tn(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await E_(e),n=new h_(e);return r.register("authEvent",o=>(st(o?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Sl,{type:Sl},o=>{const i=o?.[0]?.[Sl];i!==void 0&&r(!!i),fn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=g_(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return xy()||_y()||jc()}}const U_=B_;var Fd="@firebase/auth",Bd="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j_{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){st(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z_(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function q_(t){ii(new To("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=n.options;st(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const d={apiKey:a,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Iy(t)},h=new b0(n,o,i,d);return A0(h,r),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),ii(new To("auth-internal",e=>{const r=No(e.getProvider("auth").getImmediate());return(n=>new j_(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Jn(Fd,Bd,z_(t)),Jn(Fd,Bd,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G_=5*60,H_=ry("authIdTokenMaxAge")||G_;let Ud=null;const W_=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>H_)return;const o=r?.token;Ud!==o&&(Ud=o,await fetch(t,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function Y_(t=ly()){const e=Mc(t,"auth");if(e.isInitialized())return e.getImmediate();const r=C0(t,{popupRedirectResolver:U_,persistence:[J0,F0,Ly]}),n=ry("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const a=W_(i.toString());N0(r,a,()=>a(r.currentUser)),D0(r,c=>a(c))}}const o=ey("auth");return o&&x0(r,`http://${o}`),r}function K_(){return document.getElementsByTagName("head")?.[0]??document}_0({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=o=>{const i=Jr("internal-error");i.customData=o,r(i)},n.type="text/javascript",n.charset="UTF-8",K_().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});q_("Browser");var Q_="firebase",J_="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Jn(Q_,J_,"app");var jd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Zn,Gy;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(b,g){function p(){}p.prototype=g.prototype,b.D=g.prototype,b.prototype=new p,b.prototype.constructor=b,b.C=function(C,S,A){for(var m=Array(arguments.length-2),ne=2;ne<arguments.length;ne++)m[ne-2]=arguments[ne];return g.prototype[S].apply(C,m)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(b,g,p){p||(p=0);var C=Array(16);if(typeof g=="string")for(var S=0;16>S;++S)C[S]=g.charCodeAt(p++)|g.charCodeAt(p++)<<8|g.charCodeAt(p++)<<16|g.charCodeAt(p++)<<24;else for(S=0;16>S;++S)C[S]=g[p++]|g[p++]<<8|g[p++]<<16|g[p++]<<24;g=b.g[0],p=b.g[1],S=b.g[2];var A=b.g[3],m=g+(A^p&(S^A))+C[0]+3614090360&4294967295;g=p+(m<<7&4294967295|m>>>25),m=A+(S^g&(p^S))+C[1]+3905402710&4294967295,A=g+(m<<12&4294967295|m>>>20),m=S+(p^A&(g^p))+C[2]+606105819&4294967295,S=A+(m<<17&4294967295|m>>>15),m=p+(g^S&(A^g))+C[3]+3250441966&4294967295,p=S+(m<<22&4294967295|m>>>10),m=g+(A^p&(S^A))+C[4]+4118548399&4294967295,g=p+(m<<7&4294967295|m>>>25),m=A+(S^g&(p^S))+C[5]+1200080426&4294967295,A=g+(m<<12&4294967295|m>>>20),m=S+(p^A&(g^p))+C[6]+2821735955&4294967295,S=A+(m<<17&4294967295|m>>>15),m=p+(g^S&(A^g))+C[7]+4249261313&4294967295,p=S+(m<<22&4294967295|m>>>10),m=g+(A^p&(S^A))+C[8]+1770035416&4294967295,g=p+(m<<7&4294967295|m>>>25),m=A+(S^g&(p^S))+C[9]+2336552879&4294967295,A=g+(m<<12&4294967295|m>>>20),m=S+(p^A&(g^p))+C[10]+4294925233&4294967295,S=A+(m<<17&4294967295|m>>>15),m=p+(g^S&(A^g))+C[11]+2304563134&4294967295,p=S+(m<<22&4294967295|m>>>10),m=g+(A^p&(S^A))+C[12]+1804603682&4294967295,g=p+(m<<7&4294967295|m>>>25),m=A+(S^g&(p^S))+C[13]+4254626195&4294967295,A=g+(m<<12&4294967295|m>>>20),m=S+(p^A&(g^p))+C[14]+2792965006&4294967295,S=A+(m<<17&4294967295|m>>>15),m=p+(g^S&(A^g))+C[15]+1236535329&4294967295,p=S+(m<<22&4294967295|m>>>10),m=g+(S^A&(p^S))+C[1]+4129170786&4294967295,g=p+(m<<5&4294967295|m>>>27),m=A+(p^S&(g^p))+C[6]+3225465664&4294967295,A=g+(m<<9&4294967295|m>>>23),m=S+(g^p&(A^g))+C[11]+643717713&4294967295,S=A+(m<<14&4294967295|m>>>18),m=p+(A^g&(S^A))+C[0]+3921069994&4294967295,p=S+(m<<20&4294967295|m>>>12),m=g+(S^A&(p^S))+C[5]+3593408605&4294967295,g=p+(m<<5&4294967295|m>>>27),m=A+(p^S&(g^p))+C[10]+38016083&4294967295,A=g+(m<<9&4294967295|m>>>23),m=S+(g^p&(A^g))+C[15]+3634488961&4294967295,S=A+(m<<14&4294967295|m>>>18),m=p+(A^g&(S^A))+C[4]+3889429448&4294967295,p=S+(m<<20&4294967295|m>>>12),m=g+(S^A&(p^S))+C[9]+568446438&4294967295,g=p+(m<<5&4294967295|m>>>27),m=A+(p^S&(g^p))+C[14]+3275163606&4294967295,A=g+(m<<9&4294967295|m>>>23),m=S+(g^p&(A^g))+C[3]+4107603335&4294967295,S=A+(m<<14&4294967295|m>>>18),m=p+(A^g&(S^A))+C[8]+1163531501&4294967295,p=S+(m<<20&4294967295|m>>>12),m=g+(S^A&(p^S))+C[13]+2850285829&4294967295,g=p+(m<<5&4294967295|m>>>27),m=A+(p^S&(g^p))+C[2]+4243563512&4294967295,A=g+(m<<9&4294967295|m>>>23),m=S+(g^p&(A^g))+C[7]+1735328473&4294967295,S=A+(m<<14&4294967295|m>>>18),m=p+(A^g&(S^A))+C[12]+2368359562&4294967295,p=S+(m<<20&4294967295|m>>>12),m=g+(p^S^A)+C[5]+4294588738&4294967295,g=p+(m<<4&4294967295|m>>>28),m=A+(g^p^S)+C[8]+2272392833&4294967295,A=g+(m<<11&4294967295|m>>>21),m=S+(A^g^p)+C[11]+1839030562&4294967295,S=A+(m<<16&4294967295|m>>>16),m=p+(S^A^g)+C[14]+4259657740&4294967295,p=S+(m<<23&4294967295|m>>>9),m=g+(p^S^A)+C[1]+2763975236&4294967295,g=p+(m<<4&4294967295|m>>>28),m=A+(g^p^S)+C[4]+1272893353&4294967295,A=g+(m<<11&4294967295|m>>>21),m=S+(A^g^p)+C[7]+4139469664&4294967295,S=A+(m<<16&4294967295|m>>>16),m=p+(S^A^g)+C[10]+3200236656&4294967295,p=S+(m<<23&4294967295|m>>>9),m=g+(p^S^A)+C[13]+681279174&4294967295,g=p+(m<<4&4294967295|m>>>28),m=A+(g^p^S)+C[0]+3936430074&4294967295,A=g+(m<<11&4294967295|m>>>21),m=S+(A^g^p)+C[3]+3572445317&4294967295,S=A+(m<<16&4294967295|m>>>16),m=p+(S^A^g)+C[6]+76029189&4294967295,p=S+(m<<23&4294967295|m>>>9),m=g+(p^S^A)+C[9]+3654602809&4294967295,g=p+(m<<4&4294967295|m>>>28),m=A+(g^p^S)+C[12]+3873151461&4294967295,A=g+(m<<11&4294967295|m>>>21),m=S+(A^g^p)+C[15]+530742520&4294967295,S=A+(m<<16&4294967295|m>>>16),m=p+(S^A^g)+C[2]+3299628645&4294967295,p=S+(m<<23&4294967295|m>>>9),m=g+(S^(p|~A))+C[0]+4096336452&4294967295,g=p+(m<<6&4294967295|m>>>26),m=A+(p^(g|~S))+C[7]+1126891415&4294967295,A=g+(m<<10&4294967295|m>>>22),m=S+(g^(A|~p))+C[14]+2878612391&4294967295,S=A+(m<<15&4294967295|m>>>17),m=p+(A^(S|~g))+C[5]+4237533241&4294967295,p=S+(m<<21&4294967295|m>>>11),m=g+(S^(p|~A))+C[12]+1700485571&4294967295,g=p+(m<<6&4294967295|m>>>26),m=A+(p^(g|~S))+C[3]+2399980690&4294967295,A=g+(m<<10&4294967295|m>>>22),m=S+(g^(A|~p))+C[10]+4293915773&4294967295,S=A+(m<<15&4294967295|m>>>17),m=p+(A^(S|~g))+C[1]+2240044497&4294967295,p=S+(m<<21&4294967295|m>>>11),m=g+(S^(p|~A))+C[8]+1873313359&4294967295,g=p+(m<<6&4294967295|m>>>26),m=A+(p^(g|~S))+C[15]+4264355552&4294967295,A=g+(m<<10&4294967295|m>>>22),m=S+(g^(A|~p))+C[6]+2734768916&4294967295,S=A+(m<<15&4294967295|m>>>17),m=p+(A^(S|~g))+C[13]+1309151649&4294967295,p=S+(m<<21&4294967295|m>>>11),m=g+(S^(p|~A))+C[4]+4149444226&4294967295,g=p+(m<<6&4294967295|m>>>26),m=A+(p^(g|~S))+C[11]+3174756917&4294967295,A=g+(m<<10&4294967295|m>>>22),m=S+(g^(A|~p))+C[2]+718787259&4294967295,S=A+(m<<15&4294967295|m>>>17),m=p+(A^(S|~g))+C[9]+3951481745&4294967295,b.g[0]=b.g[0]+g&4294967295,b.g[1]=b.g[1]+(S+(m<<21&4294967295|m>>>11))&4294967295,b.g[2]=b.g[2]+S&4294967295,b.g[3]=b.g[3]+A&4294967295}n.prototype.u=function(b,g){g===void 0&&(g=b.length);for(var p=g-this.blockSize,C=this.B,S=this.h,A=0;A<g;){if(S==0)for(;A<=p;)o(this,b,A),A+=this.blockSize;if(typeof b=="string"){for(;A<g;)if(C[S++]=b.charCodeAt(A++),S==this.blockSize){o(this,C),S=0;break}}else for(;A<g;)if(C[S++]=b[A++],S==this.blockSize){o(this,C),S=0;break}}this.h=S,this.o+=g},n.prototype.v=function(){var b=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);b[0]=128;for(var g=1;g<b.length-8;++g)b[g]=0;var p=8*this.o;for(g=b.length-8;g<b.length;++g)b[g]=p&255,p/=256;for(this.u(b),b=Array(16),g=p=0;4>g;++g)for(var C=0;32>C;C+=8)b[p++]=this.g[g]>>>C&255;return b};function i(b,g){var p=c;return Object.prototype.hasOwnProperty.call(p,b)?p[b]:p[b]=g(b)}function a(b,g){this.h=g;for(var p=[],C=!0,S=b.length-1;0<=S;S--){var A=b[S]|0;C&&A==g||(p[S]=A,C=!1)}this.g=p}var c={};function d(b){return-128<=b&&128>b?i(b,function(g){return new a([g|0],0>g?-1:0)}):new a([b|0],0>b?-1:0)}function h(b){if(isNaN(b)||!isFinite(b))return v;if(0>b)return x(h(-b));for(var g=[],p=1,C=0;b>=p;C++)g[C]=b/p|0,p*=4294967296;return new a(g,0)}function y(b,g){if(b.length==0)throw Error("number format error: empty string");if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(b.charAt(0)=="-")return x(y(b.substring(1),g));if(0<=b.indexOf("-"))throw Error('number format error: interior "-" character');for(var p=h(Math.pow(g,8)),C=v,S=0;S<b.length;S+=8){var A=Math.min(8,b.length-S),m=parseInt(b.substring(S,S+A),g);8>A?(A=h(Math.pow(g,A)),C=C.j(A).add(h(m))):(C=C.j(p),C=C.add(h(m)))}return C}var v=d(0),w=d(1),E=d(16777216);t=a.prototype,t.m=function(){if(N(this))return-x(this).m();for(var b=0,g=1,p=0;p<this.g.length;p++){var C=this.i(p);b+=(0<=C?C:4294967296+C)*g,g*=4294967296}return b},t.toString=function(b){if(b=b||10,2>b||36<b)throw Error("radix out of range: "+b);if(V(this))return"0";if(N(this))return"-"+x(this).toString(b);for(var g=h(Math.pow(b,6)),p=this,C="";;){var S=F(p,g).g;p=k(p,S.j(g));var A=((0<p.g.length?p.g[0]:p.h)>>>0).toString(b);if(p=S,V(p))return A+C;for(;6>A.length;)A="0"+A;C=A+C}},t.i=function(b){return 0>b?0:b<this.g.length?this.g[b]:this.h};function V(b){if(b.h!=0)return!1;for(var g=0;g<b.g.length;g++)if(b.g[g]!=0)return!1;return!0}function N(b){return b.h==-1}t.l=function(b){return b=k(this,b),N(b)?-1:V(b)?0:1};function x(b){for(var g=b.g.length,p=[],C=0;C<g;C++)p[C]=~b.g[C];return new a(p,~b.h).add(w)}t.abs=function(){return N(this)?x(this):this},t.add=function(b){for(var g=Math.max(this.g.length,b.g.length),p=[],C=0,S=0;S<=g;S++){var A=C+(this.i(S)&65535)+(b.i(S)&65535),m=(A>>>16)+(this.i(S)>>>16)+(b.i(S)>>>16);C=m>>>16,A&=65535,m&=65535,p[S]=m<<16|A}return new a(p,p[p.length-1]&-2147483648?-1:0)};function k(b,g){return b.add(x(g))}t.j=function(b){if(V(this)||V(b))return v;if(N(this))return N(b)?x(this).j(x(b)):x(x(this).j(b));if(N(b))return x(this.j(x(b)));if(0>this.l(E)&&0>b.l(E))return h(this.m()*b.m());for(var g=this.g.length+b.g.length,p=[],C=0;C<2*g;C++)p[C]=0;for(C=0;C<this.g.length;C++)for(var S=0;S<b.g.length;S++){var A=this.i(C)>>>16,m=this.i(C)&65535,ne=b.i(S)>>>16,W=b.i(S)&65535;p[2*C+2*S]+=m*W,re(p,2*C+2*S),p[2*C+2*S+1]+=A*W,re(p,2*C+2*S+1),p[2*C+2*S+1]+=m*ne,re(p,2*C+2*S+1),p[2*C+2*S+2]+=A*ne,re(p,2*C+2*S+2)}for(C=0;C<g;C++)p[C]=p[2*C+1]<<16|p[2*C];for(C=g;C<2*g;C++)p[C]=0;return new a(p,0)};function re(b,g){for(;(b[g]&65535)!=b[g];)b[g+1]+=b[g]>>>16,b[g]&=65535,g++}function ae(b,g){this.g=b,this.h=g}function F(b,g){if(V(g))throw Error("division by zero");if(V(b))return new ae(v,v);if(N(b))return g=F(x(b),g),new ae(x(g.g),x(g.h));if(N(g))return g=F(b,x(g)),new ae(x(g.g),g.h);if(30<b.g.length){if(N(b)||N(g))throw Error("slowDivide_ only works with positive integers.");for(var p=w,C=g;0>=C.l(b);)p=Y(p),C=Y(C);var S=U(p,1),A=U(C,1);for(C=U(C,2),p=U(p,2);!V(C);){var m=A.add(C);0>=m.l(b)&&(S=S.add(p),A=m),C=U(C,1),p=U(p,1)}return g=k(b,S.j(g)),new ae(S,g)}for(S=v;0<=b.l(g);){for(p=Math.max(1,Math.floor(b.m()/g.m())),C=Math.ceil(Math.log(p)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),A=h(p),m=A.j(g);N(m)||0<m.l(b);)p-=C,A=h(p),m=A.j(g);V(A)&&(A=w),S=S.add(A),b=k(b,m)}return new ae(S,b)}t.A=function(b){return F(this,b).h},t.and=function(b){for(var g=Math.max(this.g.length,b.g.length),p=[],C=0;C<g;C++)p[C]=this.i(C)&b.i(C);return new a(p,this.h&b.h)},t.or=function(b){for(var g=Math.max(this.g.length,b.g.length),p=[],C=0;C<g;C++)p[C]=this.i(C)|b.i(C);return new a(p,this.h|b.h)},t.xor=function(b){for(var g=Math.max(this.g.length,b.g.length),p=[],C=0;C<g;C++)p[C]=this.i(C)^b.i(C);return new a(p,this.h^b.h)};function Y(b){for(var g=b.g.length+1,p=[],C=0;C<g;C++)p[C]=b.i(C)<<1|b.i(C-1)>>>31;return new a(p,b.h)}function U(b,g){var p=g>>5;g%=32;for(var C=b.g.length-p,S=[],A=0;A<C;A++)S[A]=0<g?b.i(A+p)>>>g|b.i(A+p+1)<<32-g:b.i(A+p);return new a(S,b.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Gy=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=y,Zn=a}).apply(typeof jd<"u"?jd:typeof self<"u"?self:typeof window<"u"?window:{});var Ms=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Hy,Oi,Wy,oa,sc,Yy,Ky,Qy;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,f,P){return l==Array.prototype||l==Object.prototype||(l[f]=P.value),l};function r(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ms=="object"&&Ms];for(var f=0;f<l.length;++f){var P=l[f];if(P&&P.Math==Math)return P}throw Error("Cannot find global object")}var n=r(this);function o(l,f){if(f)e:{var P=n;l=l.split(".");for(var Q=0;Q<l.length-1;Q++){var we=l[Q];if(!(we in P))break e;P=P[we]}l=l[l.length-1],Q=P[l],f=f(Q),f!=Q&&f!=null&&e(P,l,{configurable:!0,writable:!0,value:f})}}function i(l,f){l instanceof String&&(l+="");var P=0,Q=!1,we={next:function(){if(!Q&&P<l.length){var Ae=P++;return{value:f(Ae,l[Ae]),done:!1}}return Q=!0,{done:!0,value:void 0}}};return we[Symbol.iterator]=function(){return we},we}o("Array.prototype.values",function(l){return l||function(){return i(this,function(f,P){return P})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},c=this||self;function d(l){var f=typeof l;return f=f!="object"?f:l?Array.isArray(l)?"array":f:"null",f=="array"||f=="object"&&typeof l.length=="number"}function h(l){var f=typeof l;return f=="object"&&l!=null||f=="function"}function y(l,f,P){return l.call.apply(l.bind,arguments)}function v(l,f,P){if(!l)throw Error();if(2<arguments.length){var Q=Array.prototype.slice.call(arguments,2);return function(){var we=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(we,Q),l.apply(f,we)}}return function(){return l.apply(f,arguments)}}function w(l,f,P){return w=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?y:v,w.apply(null,arguments)}function E(l,f){var P=Array.prototype.slice.call(arguments,1);return function(){var Q=P.slice();return Q.push.apply(Q,arguments),l.apply(this,Q)}}function V(l,f){function P(){}P.prototype=f.prototype,l.aa=f.prototype,l.prototype=new P,l.prototype.constructor=l,l.Qb=function(Q,we,Ae){for(var Ue=Array(arguments.length-2),Ht=2;Ht<arguments.length;Ht++)Ue[Ht-2]=arguments[Ht];return f.prototype[we].apply(Q,Ue)}}function N(l){const f=l.length;if(0<f){const P=Array(f);for(let Q=0;Q<f;Q++)P[Q]=l[Q];return P}return[]}function x(l,f){for(let P=1;P<arguments.length;P++){const Q=arguments[P];if(d(Q)){const we=l.length||0,Ae=Q.length||0;l.length=we+Ae;for(let Ue=0;Ue<Ae;Ue++)l[we+Ue]=Q[Ue]}else l.push(Q)}}class k{constructor(f,P){this.i=f,this.j=P,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function re(l){return/^[\s\xa0]*$/.test(l)}function ae(){var l=c.navigator;return l&&(l=l.userAgent)?l:""}function F(l){return F[" "](l),l}F[" "]=function(){};var Y=ae().indexOf("Gecko")!=-1&&!(ae().toLowerCase().indexOf("webkit")!=-1&&ae().indexOf("Edge")==-1)&&!(ae().indexOf("Trident")!=-1||ae().indexOf("MSIE")!=-1)&&ae().indexOf("Edge")==-1;function U(l,f,P){for(const Q in l)f.call(P,l[Q],Q,l)}function b(l,f){for(const P in l)f.call(void 0,l[P],P,l)}function g(l){const f={};for(const P in l)f[P]=l[P];return f}const p="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(l,f){let P,Q;for(let we=1;we<arguments.length;we++){Q=arguments[we];for(P in Q)l[P]=Q[P];for(let Ae=0;Ae<p.length;Ae++)P=p[Ae],Object.prototype.hasOwnProperty.call(Q,P)&&(l[P]=Q[P])}}function S(l){var f=1;l=l.split(":");const P=[];for(;0<f&&l.length;)P.push(l.shift()),f--;return l.length&&P.push(l.join(":")),P}function A(l){c.setTimeout(()=>{throw l},0)}function m(){var l=D;let f=null;return l.g&&(f=l.g,l.g=l.g.next,l.g||(l.h=null),f.next=null),f}class ne{constructor(){this.h=this.g=null}add(f,P){const Q=W.get();Q.set(f,P),this.h?this.h.next=Q:this.g=Q,this.h=Q}}var W=new k(()=>new I,l=>l.reset());class I{constructor(){this.next=this.g=this.h=null}set(f,P){this.h=f,this.g=P,this.next=null}reset(){this.next=this.g=this.h=null}}let O,J=!1,D=new ne,T=()=>{const l=c.Promise.resolve(void 0);O=()=>{l.then(B)}};var B=()=>{for(var l;l=m();){try{l.h.call(l.g)}catch(P){A(P)}var f=W;f.j(l),100>f.h&&(f.h++,l.next=f.g,f.g=l)}J=!1};function me(){this.s=this.s,this.C=this.C}me.prototype.s=!1,me.prototype.ma=function(){this.s||(this.s=!0,this.N())},me.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function H(l,f){this.type=l,this.g=this.target=f,this.defaultPrevented=!1}H.prototype.h=function(){this.defaultPrevented=!0};var de=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var l=!1,f=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const P=()=>{};c.addEventListener("test",P,f),c.removeEventListener("test",P,f)}catch{}return l}();function $(l,f){if(H.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var P=this.type=l.type,Q=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=f,f=l.relatedTarget){if(Y){e:{try{F(f.nodeName);var we=!0;break e}catch{}we=!1}we||(f=null)}}else P=="mouseover"?f=l.fromElement:P=="mouseout"&&(f=l.toElement);this.relatedTarget=f,Q?(this.clientX=Q.clientX!==void 0?Q.clientX:Q.pageX,this.clientY=Q.clientY!==void 0?Q.clientY:Q.pageY,this.screenX=Q.screenX||0,this.screenY=Q.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:q[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&$.aa.h.call(this)}}V($,H);var q={2:"touch",3:"pen",4:"mouse"};$.prototype.h=function(){$.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Z="closure_listenable_"+(1e6*Math.random()|0),L=0;function te(l,f,P,Q,we){this.listener=l,this.proxy=null,this.src=f,this.type=P,this.capture=!!Q,this.ha=we,this.key=++L,this.da=this.fa=!1}function j(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function M(l){this.src=l,this.g={},this.h=0}M.prototype.add=function(l,f,P,Q,we){var Ae=l.toString();l=this.g[Ae],l||(l=this.g[Ae]=[],this.h++);var Ue=oe(l,f,Q,we);return-1<Ue?(f=l[Ue],P||(f.fa=!1)):(f=new te(f,this.src,Ae,!!Q,we),f.fa=P,l.push(f)),f};function ie(l,f){var P=f.type;if(P in l.g){var Q=l.g[P],we=Array.prototype.indexOf.call(Q,f,void 0),Ae;(Ae=0<=we)&&Array.prototype.splice.call(Q,we,1),Ae&&(j(f),l.g[P].length==0&&(delete l.g[P],l.h--))}}function oe(l,f,P,Q){for(var we=0;we<l.length;++we){var Ae=l[we];if(!Ae.da&&Ae.listener==f&&Ae.capture==!!P&&Ae.ha==Q)return we}return-1}var fe="closure_lm_"+(1e6*Math.random()|0),ue={};function K(l,f,P,Q,we){if(Array.isArray(f)){for(var Ae=0;Ae<f.length;Ae++)K(l,f[Ae],P,Q,we);return null}return P=Pe(P),l&&l[Z]?l.K(f,P,h(Q)?!!Q.capture:!1,we):R(l,f,P,!1,Q,we)}function R(l,f,P,Q,we,Ae){if(!f)throw Error("Invalid event type");var Ue=h(we)?!!we.capture:!!we,Ht=se(l);if(Ht||(l[fe]=Ht=new M(l)),P=Ht.add(f,P,Q,Ue,Ae),P.proxy)return P;if(Q=ee(),P.proxy=Q,Q.src=l,Q.listener=P,l.addEventListener)de||(we=Ue),we===void 0&&(we=!1),l.addEventListener(f.toString(),Q,we);else if(l.attachEvent)l.attachEvent(pe(f.toString()),Q);else if(l.addListener&&l.removeListener)l.addListener(Q);else throw Error("addEventListener and attachEvent are unavailable.");return P}function ee(){function l(P){return f.call(l.src,l.listener,P)}const f=z;return l}function X(l,f,P,Q,we){if(Array.isArray(f))for(var Ae=0;Ae<f.length;Ae++)X(l,f[Ae],P,Q,we);else Q=h(Q)?!!Q.capture:!!Q,P=Pe(P),l&&l[Z]?(l=l.i,f=String(f).toString(),f in l.g&&(Ae=l.g[f],P=oe(Ae,P,Q,we),-1<P&&(j(Ae[P]),Array.prototype.splice.call(Ae,P,1),Ae.length==0&&(delete l.g[f],l.h--)))):l&&(l=se(l))&&(f=l.g[f.toString()],l=-1,f&&(l=oe(f,P,Q,we)),(P=-1<l?f[l]:null)&&ye(P))}function ye(l){if(typeof l!="number"&&l&&!l.da){var f=l.src;if(f&&f[Z])ie(f.i,l);else{var P=l.type,Q=l.proxy;f.removeEventListener?f.removeEventListener(P,Q,l.capture):f.detachEvent?f.detachEvent(pe(P),Q):f.addListener&&f.removeListener&&f.removeListener(Q),(P=se(f))?(ie(P,l),P.h==0&&(P.src=null,f[fe]=null)):j(l)}}}function pe(l){return l in ue?ue[l]:ue[l]="on"+l}function z(l,f){if(l.da)l=!0;else{f=new $(f,this);var P=l.listener,Q=l.ha||l.src;l.fa&&ye(l),l=P.call(Q,f)}return l}function se(l){return l=l[fe],l instanceof M?l:null}var _e="__closure_events_fn_"+(1e9*Math.random()>>>0);function Pe(l){return typeof l=="function"?l:(l[_e]||(l[_e]=function(f){return l.handleEvent(f)}),l[_e])}function he(){me.call(this),this.i=new M(this),this.M=this,this.F=null}V(he,me),he.prototype[Z]=!0,he.prototype.removeEventListener=function(l,f,P,Q){X(this,l,f,P,Q)};function be(l,f){var P,Q=l.F;if(Q)for(P=[];Q;Q=Q.F)P.push(Q);if(l=l.M,Q=f.type||f,typeof f=="string")f=new H(f,l);else if(f instanceof H)f.target=f.target||l;else{var we=f;f=new H(Q,l),C(f,we)}if(we=!0,P)for(var Ae=P.length-1;0<=Ae;Ae--){var Ue=f.g=P[Ae];we=ce(Ue,Q,!0,f)&&we}if(Ue=f.g=l,we=ce(Ue,Q,!0,f)&&we,we=ce(Ue,Q,!1,f)&&we,P)for(Ae=0;Ae<P.length;Ae++)Ue=f.g=P[Ae],we=ce(Ue,Q,!1,f)&&we}he.prototype.N=function(){if(he.aa.N.call(this),this.i){var l=this.i,f;for(f in l.g){for(var P=l.g[f],Q=0;Q<P.length;Q++)j(P[Q]);delete l.g[f],l.h--}}this.F=null},he.prototype.K=function(l,f,P,Q){return this.i.add(String(l),f,!1,P,Q)},he.prototype.L=function(l,f,P,Q){return this.i.add(String(l),f,!0,P,Q)};function ce(l,f,P,Q){if(f=l.i.g[String(f)],!f)return!0;f=f.concat();for(var we=!0,Ae=0;Ae<f.length;++Ae){var Ue=f[Ae];if(Ue&&!Ue.da&&Ue.capture==P){var Ht=Ue.listener,yr=Ue.ha||Ue.src;Ue.fa&&ie(l.i,Ue),we=Ht.call(yr,Q)!==!1&&we}}return we&&!Q.defaultPrevented}function Se(l,f,P){if(typeof l=="function")P&&(l=w(l,P));else if(l&&typeof l.handleEvent=="function")l=w(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:c.setTimeout(l,f||0)}function Ee(l){l.g=Se(()=>{l.g=null,l.i&&(l.i=!1,Ee(l))},l.l);const f=l.h;l.h=null,l.m.apply(null,f)}class $e extends me{constructor(f,P){super(),this.m=f,this.l=P,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:Ee(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ke(l){me.call(this),this.h=l,this.g={}}V(ke,me);var Me=[];function Ke(l){U(l.g,function(f,P){this.g.hasOwnProperty(P)&&ye(f)},l),l.g={}}ke.prototype.N=function(){ke.aa.N.call(this),Ke(this)},ke.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var je=c.JSON.stringify,Ce=c.JSON.parse,Fe=class{stringify(l){return c.JSON.stringify(l,void 0)}parse(l){return c.JSON.parse(l,void 0)}};function Qe(){}Qe.prototype.h=null;function We(l){return l.h||(l.h=l.i())}function Je(){}var xe={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ot(){H.call(this,"d")}V(ot,H);function et(){H.call(this,"c")}V(et,H);var Ct={},mt=null;function Dt(){return mt=mt||new he}Ct.La="serverreachability";function $t(l){H.call(this,Ct.La,l)}V($t,H);function Tt(l){const f=Dt();be(f,new $t(f))}Ct.STAT_EVENT="statevent";function Kt(l,f){H.call(this,Ct.STAT_EVENT,l),this.stat=f}V(Kt,H);function rt(l){const f=Dt();be(f,new Kt(f,l))}Ct.Ma="timingevent";function Xt(l,f){H.call(this,Ct.Ma,l),this.size=f}V(Xt,H);function Ie(l,f){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){l()},f)}function gt(){this.g=!0}gt.prototype.xa=function(){this.g=!1};function Be(l,f,P,Q,we,Ae){l.info(function(){if(l.g)if(Ae)for(var Ue="",Ht=Ae.split("&"),yr=0;yr<Ht.length;yr++){var Mt=Ht[yr].split("=");if(1<Mt.length){var Pr=Mt[0];Mt=Mt[1];var wr=Pr.split("_");Ue=2<=wr.length&&wr[1]=="type"?Ue+(Pr+"="+Mt+"&"):Ue+(Pr+"=redacted&")}}else Ue=null;else Ue=Ae;return"XMLHTTP REQ ("+Q+") [attempt "+we+"]: "+f+`
`+P+`
`+Ue})}function Oe(l,f,P,Q,we,Ae,Ue){l.info(function(){return"XMLHTTP RESP ("+Q+") [ attempt "+we+"]: "+f+`
`+P+`
`+Ae+" "+Ue})}function Ze(l,f,P,Q){l.info(function(){return"XMLHTTP TEXT ("+f+"): "+bt(l,P)+(Q?" "+Q:"")})}function nt(l,f){l.info(function(){return"TIMEOUT: "+f})}gt.prototype.info=function(){};function bt(l,f){if(!l.g)return f;if(!f)return null;try{var P=JSON.parse(f);if(P){for(l=0;l<P.length;l++)if(Array.isArray(P[l])){var Q=P[l];if(!(2>Q.length)){var we=Q[1];if(Array.isArray(we)&&!(1>we.length)){var Ae=we[0];if(Ae!="noop"&&Ae!="stop"&&Ae!="close")for(var Ue=1;Ue<we.length;Ue++)we[Ue]=""}}}}return je(P)}catch{return f}}var Xe={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},yt={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ut;function At(){}V(At,Qe),At.prototype.g=function(){return new XMLHttpRequest},At.prototype.i=function(){return{}},ut=new At;function Ve(l,f,P,Q){this.j=l,this.i=f,this.l=P,this.R=Q||1,this.U=new ke(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new zt}function zt(){this.i=null,this.g="",this.h=!1}var vt={},Nt={};function Bt(l,f,P){l.L=1,l.v=Fo(kr(f)),l.m=P,l.P=!0,ft(l,null)}function ft(l,f){l.F=Date.now(),kt(l),l.A=kr(l.v);var P=l.A,Q=l.R;Array.isArray(Q)||(Q=[String(Q)]),Mu(P.i,"t",Q),l.C=0,P=l.j.J,l.h=new zt,l.g=ed(l.j,P?f:null,!l.m),0<l.O&&(l.M=new $e(w(l.Y,l,l.g),l.O)),f=l.U,P=l.g,Q=l.ca;var we="readystatechange";Array.isArray(we)||(we&&(Me[0]=we.toString()),we=Me);for(var Ae=0;Ae<we.length;Ae++){var Ue=K(P,we[Ae],Q||f.handleEvent,!1,f.h||f);if(!Ue)break;f.g[Ue.key]=Ue}f=l.H?g(l.H):{},l.m?(l.u||(l.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,f)):(l.u="GET",l.g.ea(l.A,l.u,null,f)),Tt(),Be(l.i,l.u,l.A,l.l,l.R,l.m)}Ve.prototype.ca=function(l){l=l.target;const f=this.M;f&&bn(l)==3?f.j():this.Y(l)},Ve.prototype.Y=function(l){try{if(l==this.g)e:{const wr=bn(this.g);var f=this.g.Ba();const jo=this.g.Z();if(!(3>wr)&&(wr!=3||this.g&&(this.h.h||this.g.oa()||zu(this.g)))){this.J||wr!=4||f==7||(f==8||0>=jo?Tt(3):Tt(2)),dr(this);var P=this.g.Z();this.X=P;t:if(Lt(this)){var Q=zu(this.g);l="";var we=Q.length,Ae=bn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){hr(this),Tr(this);var Ue="";break t}this.h.i=new c.TextDecoder}for(f=0;f<we;f++)this.h.h=!0,l+=this.h.i.decode(Q[f],{stream:!(Ae&&f==we-1)});Q.length=0,this.h.g+=l,this.C=0,Ue=this.h.g}else Ue=this.g.oa();if(this.o=P==200,Oe(this.i,this.u,this.A,this.l,this.R,wr,P),this.o){if(this.T&&!this.K){t:{if(this.g){var Ht,yr=this.g;if((Ht=yr.g?yr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!re(Ht)){var Mt=Ht;break t}}Mt=null}if(P=Mt)Ze(this.i,this.l,P,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,gn(this,P);else{this.o=!1,this.s=3,rt(12),hr(this),Tr(this);break e}}if(this.P){P=!0;let Yr;for(;!this.J&&this.C<Ue.length;)if(Yr=pt(this,Ue),Yr==Nt){wr==4&&(this.s=4,rt(14),P=!1),Ze(this.i,this.l,null,"[Incomplete Response]");break}else if(Yr==vt){this.s=4,rt(15),Ze(this.i,this.l,Ue,"[Invalid Chunk]"),P=!1;break}else Ze(this.i,this.l,Yr,null),gn(this,Yr);if(Lt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),wr!=4||Ue.length!=0||this.h.h||(this.s=1,rt(16),P=!1),this.o=this.o&&P,!P)Ze(this.i,this.l,Ue,"[Invalid Chunked Response]"),hr(this),Tr(this);else if(0<Ue.length&&!this.W){this.W=!0;var Pr=this.j;Pr.g==this&&Pr.ba&&!Pr.M&&(Pr.j.info("Great, no buffering proxy detected. Bytes received: "+Ue.length),ll(Pr),Pr.M=!0,rt(11))}}else Ze(this.i,this.l,Ue,null),gn(this,Ue);wr==4&&hr(this),this.o&&!this.J&&(wr==4?Qu(this.j,this):(this.o=!1,kt(this)))}else Hp(this.g),P==400&&0<Ue.indexOf("Unknown SID")?(this.s=3,rt(12)):(this.s=0,rt(13)),hr(this),Tr(this)}}}catch{}finally{}};function Lt(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function pt(l,f){var P=l.C,Q=f.indexOf(`
`,P);return Q==-1?Nt:(P=Number(f.substring(P,Q)),isNaN(P)?vt:(Q+=1,Q+P>f.length?Nt:(f=f.slice(Q,Q+P),l.C=Q+P,f)))}Ve.prototype.cancel=function(){this.J=!0,hr(this)};function kt(l){l.S=Date.now()+l.I,Zt(l,l.I)}function Zt(l,f){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Ie(w(l.ba,l),f)}function dr(l){l.B&&(c.clearTimeout(l.B),l.B=null)}Ve.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(nt(this.i,this.A),this.L!=2&&(Tt(),rt(17)),hr(this),this.s=2,Tr(this)):Zt(this,this.S-l)};function Tr(l){l.j.G==0||l.J||Qu(l.j,l)}function hr(l){dr(l);var f=l.M;f&&typeof f.ma=="function"&&f.ma(),l.M=null,Ke(l.U),l.g&&(f=l.g,l.g=null,f.abort(),f.ma())}function gn(l,f){try{var P=l.j;if(P.G!=0&&(P.g==l||On(P.h,l))){if(!l.K&&On(P.h,l)&&P.G==3){try{var Q=P.Da.g.parse(f)}catch{Q=null}if(Array.isArray(Q)&&Q.length==3){var we=Q;if(we[0]==0){e:if(!P.u){if(P.g)if(P.g.F+3e3<l.F)ks(P),$s(P);else break e;al(P),rt(18)}}else P.za=we[1],0<P.za-P.T&&37500>we[2]&&P.F&&P.v==0&&!P.C&&(P.C=Ie(w(P.Za,P),6e3));if(1>=yo(P.h)&&P.ca){try{P.ca()}catch{}P.ca=void 0}}else fo(P,11)}else if((l.K||P.g==l)&&ks(P),!re(f))for(we=P.Da.g.parse(f),f=0;f<we.length;f++){let Mt=we[f];if(P.T=Mt[0],Mt=Mt[1],P.G==2)if(Mt[0]=="c"){P.K=Mt[1],P.ia=Mt[2];const Pr=Mt[3];Pr!=null&&(P.la=Pr,P.j.info("VER="+P.la));const wr=Mt[4];wr!=null&&(P.Aa=wr,P.j.info("SVER="+P.Aa));const jo=Mt[5];jo!=null&&typeof jo=="number"&&0<jo&&(Q=1.5*jo,P.L=Q,P.j.info("backChannelRequestTimeoutMs_="+Q)),Q=P;const Yr=l.g;if(Yr){const Ds=Yr.g?Yr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ds){var Ae=Q.h;Ae.g||Ds.indexOf("spdy")==-1&&Ds.indexOf("quic")==-1&&Ds.indexOf("h2")==-1||(Ae.j=Ae.l,Ae.g=new Set,Ae.h&&(Vn(Ae,Ae.h),Ae.h=null))}if(Q.D){const cl=Yr.g?Yr.g.getResponseHeader("X-HTTP-Session-Id"):null;cl&&(Q.ya=cl,Gt(Q.I,Q.D,cl))}}P.G=3,P.l&&P.l.ua(),P.ba&&(P.R=Date.now()-l.F,P.j.info("Handshake RTT: "+P.R+"ms")),Q=P;var Ue=l;if(Q.qa=Zu(Q,Q.J?Q.ia:null,Q.W),Ue.K){Cs(Q.h,Ue);var Ht=Ue,yr=Q.L;yr&&(Ht.I=yr),Ht.B&&(dr(Ht),kt(Ht)),Q.g=Ue}else Yu(Q);0<P.i.length&&Ts(P)}else Mt[0]!="stop"&&Mt[0]!="close"||fo(P,7);else P.G==3&&(Mt[0]=="stop"||Mt[0]=="close"?Mt[0]=="stop"?fo(P,7):sl(P):Mt[0]!="noop"&&P.l&&P.l.ta(Mt),P.v=0)}}Tt(4)}catch{}}var Mn=class{constructor(l,f){this.g=l,this.map=f}};function Vo(l){this.l=l||10,c.PerformanceNavigationTiming?(l=c.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function mo(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function yo(l){return l.h?1:l.g?l.g.size:0}function On(l,f){return l.h?l.h==f:l.g?l.g.has(f):!1}function Vn(l,f){l.g?l.g.add(f):l.h=f}function Cs(l,f){l.h&&l.h==f?l.h=null:l.g&&l.g.has(f)&&l.g.delete(f)}Vo.prototype.cancel=function(){if(this.i=Pi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Pi(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let f=l.i;for(const P of l.g.values())f=f.concat(P.D);return f}return N(l.i)}function _t(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(d(l)){for(var f=[],P=l.length,Q=0;Q<P;Q++)f.push(l[Q]);return f}f=[],P=0;for(Q in l)f[P++]=l[Q];return f}function qt(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(d(l)||typeof l=="string"){var f=[];l=l.length;for(var P=0;P<l;P++)f.push(P);return f}f=[],P=0;for(const Q in l)f[P++]=Q;return f}}}function Sr(l,f){if(l.forEach&&typeof l.forEach=="function")l.forEach(f,void 0);else if(d(l)||typeof l=="string")Array.prototype.forEach.call(l,f,void 0);else for(var P=qt(l),Q=_t(l),we=Q.length,Ae=0;Ae<we;Ae++)f.call(void 0,Q[Ae],P&&P[Ae],l)}var Wr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function vn(l,f){if(l){l=l.split("&");for(var P=0;P<l.length;P++){var Q=l[P].indexOf("="),we=null;if(0<=Q){var Ae=l[P].substring(0,Q);we=l[P].substring(Q+1)}else Ae=l[P];f(Ae,we?decodeURIComponent(we.replace(/\+/g," ")):"")}}}function Qt(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Qt){this.h=l.h,en(this,l.j),this.o=l.o,this.g=l.g,tn(this,l.s),this.l=l.l;var f=l.i,P=new Ai;P.i=f.i,f.g&&(P.g=new Map(f.g),P.h=f.h),As(this,P),this.m=l.m}else l&&(f=String(l).match(Wr))?(this.h=!1,en(this,f[1]||"",!0),this.o=wi(f[2]||""),this.g=wi(f[3]||"",!0),tn(this,f[4]),this.l=wi(f[5]||"",!0),As(this,f[6]||"",!0),this.m=wi(f[7]||"")):(this.h=!1,this.i=new Ai(null,this.h))}Qt.prototype.toString=function(){var l=[],f=this.j;f&&l.push(Ci(f,Du,!0),":");var P=this.g;return(P||f=="file")&&(l.push("//"),(f=this.o)&&l.push(Ci(f,Du,!0),"@"),l.push(encodeURIComponent(String(P)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),P=this.s,P!=null&&l.push(":",String(P))),(P=this.l)&&(this.g&&P.charAt(0)!="/"&&l.push("/"),l.push(Ci(P,P.charAt(0)=="/"?Mp:Lp,!0))),(P=this.i.toString())&&l.push("?",P),(P=this.m)&&l.push("#",Ci(P,Vp)),l.join("")};function kr(l){return new Qt(l)}function en(l,f,P){l.j=P?wi(f,!0):f,l.j&&(l.j=l.j.replace(/:$/,""))}function tn(l,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);l.s=f}else l.s=null}function As(l,f,P){f instanceof Ai?(l.i=f,Fp(l.i,l.h)):(P||(f=Ci(f,Op)),l.i=new Ai(f,l.h))}function Gt(l,f,P){l.i.set(f,P)}function Fo(l){return Gt(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function wi(l,f){return l?f?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Ci(l,f,P){return typeof l=="string"?(l=encodeURI(l).replace(f,Np),P&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function Np(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Du=/[#\/\?@]/g,Lp=/[#\?:]/g,Mp=/[#\?]/g,Op=/[#\?@]/g,Vp=/#/g;function Ai(l,f){this.h=this.g=null,this.i=l||null,this.j=!!f}function Fn(l){l.g||(l.g=new Map,l.h=0,l.i&&vn(l.i,function(f,P){l.add(decodeURIComponent(f.replace(/\+/g," ")),P)}))}t=Ai.prototype,t.add=function(l,f){Fn(this),this.i=null,l=Bo(this,l);var P=this.g.get(l);return P||this.g.set(l,P=[]),P.push(f),this.h+=1,this};function Nu(l,f){Fn(l),f=Bo(l,f),l.g.has(f)&&(l.i=null,l.h-=l.g.get(f).length,l.g.delete(f))}function Lu(l,f){return Fn(l),f=Bo(l,f),l.g.has(f)}t.forEach=function(l,f){Fn(this),this.g.forEach(function(P,Q){P.forEach(function(we){l.call(f,we,Q,this)},this)},this)},t.na=function(){Fn(this);const l=Array.from(this.g.values()),f=Array.from(this.g.keys()),P=[];for(let Q=0;Q<f.length;Q++){const we=l[Q];for(let Ae=0;Ae<we.length;Ae++)P.push(f[Q])}return P},t.V=function(l){Fn(this);let f=[];if(typeof l=="string")Lu(this,l)&&(f=f.concat(this.g.get(Bo(this,l))));else{l=Array.from(this.g.values());for(let P=0;P<l.length;P++)f=f.concat(l[P])}return f},t.set=function(l,f){return Fn(this),this.i=null,l=Bo(this,l),Lu(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[f]),this.h+=1,this},t.get=function(l,f){return l?(l=this.V(l),0<l.length?String(l[0]):f):f};function Mu(l,f,P){Nu(l,f),0<P.length&&(l.i=null,l.g.set(Bo(l,f),N(P)),l.h+=P.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],f=Array.from(this.g.keys());for(var P=0;P<f.length;P++){var Q=f[P];const Ae=encodeURIComponent(String(Q)),Ue=this.V(Q);for(Q=0;Q<Ue.length;Q++){var we=Ae;Ue[Q]!==""&&(we+="="+encodeURIComponent(String(Ue[Q]))),l.push(we)}}return this.i=l.join("&")};function Bo(l,f){return f=String(f),l.j&&(f=f.toLowerCase()),f}function Fp(l,f){f&&!l.j&&(Fn(l),l.i=null,l.g.forEach(function(P,Q){var we=Q.toLowerCase();Q!=we&&(Nu(this,Q),Mu(this,we,P))},l)),l.j=f}function Bp(l,f){const P=new gt;if(c.Image){const Q=new Image;Q.onload=E(Bn,P,"TestLoadImage: loaded",!0,f,Q),Q.onerror=E(Bn,P,"TestLoadImage: error",!1,f,Q),Q.onabort=E(Bn,P,"TestLoadImage: abort",!1,f,Q),Q.ontimeout=E(Bn,P,"TestLoadImage: timeout",!1,f,Q),c.setTimeout(function(){Q.ontimeout&&Q.ontimeout()},1e4),Q.src=l}else f(!1)}function Up(l,f){const P=new gt,Q=new AbortController,we=setTimeout(()=>{Q.abort(),Bn(P,"TestPingServer: timeout",!1,f)},1e4);fetch(l,{signal:Q.signal}).then(Ae=>{clearTimeout(we),Ae.ok?Bn(P,"TestPingServer: ok",!0,f):Bn(P,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(we),Bn(P,"TestPingServer: error",!1,f)})}function Bn(l,f,P,Q,we){try{we&&(we.onload=null,we.onerror=null,we.onabort=null,we.ontimeout=null),Q(P)}catch{}}function jp(){this.g=new Fe}function zp(l,f,P){const Q=P||"";try{Sr(l,function(we,Ae){let Ue=we;h(we)&&(Ue=je(we)),f.push(Q+Ae+"="+encodeURIComponent(Ue))})}catch(we){throw f.push(Q+"type="+encodeURIComponent("_badmap")),we}}function xs(l){this.l=l.Ub||null,this.j=l.eb||!1}V(xs,Qe),xs.prototype.g=function(){return new Is(this.l,this.j)},xs.prototype.i=function(l){return function(){return l}}({});function Is(l,f){he.call(this),this.D=l,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}V(Is,he),t=Is.prototype,t.open=function(l,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=f,this.readyState=1,Ii(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(f.body=l),(this.D||c).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,xi(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,Ii(this)),this.g&&(this.readyState=3,Ii(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ou(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ou(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var f=l.value?l.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!l.done}))&&(this.response=this.responseText+=f)}l.done?xi(this):Ii(this),this.readyState==3&&Ou(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,xi(this))},t.Qa=function(l){this.g&&(this.response=l,xi(this))},t.ga=function(){this.g&&xi(this)};function xi(l){l.readyState=4,l.l=null,l.j=null,l.v=null,Ii(l)}t.setRequestHeader=function(l,f){this.u.append(l,f)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],f=this.h.entries();for(var P=f.next();!P.done;)P=P.value,l.push(P[0]+": "+P[1]),P=f.next();return l.join(`\r
`)};function Ii(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Is.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Vu(l){let f="";return U(l,function(P,Q){f+=Q,f+=":",f+=P,f+=`\r
`}),f}function il(l,f,P){e:{for(Q in P){var Q=!1;break e}Q=!0}Q||(P=Vu(P),typeof l=="string"?P!=null&&encodeURIComponent(String(P)):Gt(l,f,P))}function tr(l){he.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}V(tr,he);var qp=/^https?$/i,Gp=["POST","PUT"];t=tr.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,f,P,Q){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);f=f?f.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ut.g(),this.v=this.o?We(this.o):We(ut),this.g.onreadystatechange=w(this.Ea,this);try{this.B=!0,this.g.open(f,String(l),!0),this.B=!1}catch(Ae){Fu(this,Ae);return}if(l=P||"",P=new Map(this.headers),Q)if(Object.getPrototypeOf(Q)===Object.prototype)for(var we in Q)P.set(we,Q[we]);else if(typeof Q.keys=="function"&&typeof Q.get=="function")for(const Ae of Q.keys())P.set(Ae,Q.get(Ae));else throw Error("Unknown input type for opt_headers: "+String(Q));Q=Array.from(P.keys()).find(Ae=>Ae.toLowerCase()=="content-type"),we=c.FormData&&l instanceof c.FormData,!(0<=Array.prototype.indexOf.call(Gp,f,void 0))||Q||we||P.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ae,Ue]of P)this.g.setRequestHeader(Ae,Ue);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ju(this),this.u=!0,this.g.send(l),this.u=!1}catch(Ae){Fu(this,Ae)}};function Fu(l,f){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=f,l.m=5,Bu(l),Es(l)}function Bu(l){l.A||(l.A=!0,be(l,"complete"),be(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,be(this,"complete"),be(this,"abort"),Es(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Es(this,!0)),tr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Uu(this):this.bb())},t.bb=function(){Uu(this)};function Uu(l){if(l.h&&typeof a<"u"&&(!l.v[1]||bn(l)!=4||l.Z()!=2)){if(l.u&&bn(l)==4)Se(l.Ea,0,l);else if(be(l,"readystatechange"),bn(l)==4){l.h=!1;try{const Ue=l.Z();e:switch(Ue){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var P;if(!(P=f)){var Q;if(Q=Ue===0){var we=String(l.D).match(Wr)[1]||null;!we&&c.self&&c.self.location&&(we=c.self.location.protocol.slice(0,-1)),Q=!qp.test(we?we.toLowerCase():"")}P=Q}if(P)be(l,"complete"),be(l,"success");else{l.m=6;try{var Ae=2<bn(l)?l.g.statusText:""}catch{Ae=""}l.l=Ae+" ["+l.Z()+"]",Bu(l)}}finally{Es(l)}}}}function Es(l,f){if(l.g){ju(l);const P=l.g,Q=l.v[0]?()=>{}:null;l.g=null,l.v=null,f||be(l,"ready");try{P.onreadystatechange=Q}catch{}}}function ju(l){l.I&&(c.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function bn(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<bn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var f=this.g.responseText;return l&&f.indexOf(l)==0&&(f=f.substring(l.length)),Ce(f)}};function zu(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function Hp(l){const f={};l=(l.g&&2<=bn(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let Q=0;Q<l.length;Q++){if(re(l[Q]))continue;var P=S(l[Q]);const we=P[0];if(P=P[1],typeof P!="string")continue;P=P.trim();const Ae=f[we]||[];f[we]=Ae,Ae.push(P)}b(f,function(Q){return Q.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ei(l,f,P){return P&&P.internalChannelParams&&P.internalChannelParams[l]||f}function qu(l){this.Aa=0,this.i=[],this.j=new gt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ei("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ei("baseRetryDelayMs",5e3,l),this.cb=Ei("retryDelaySeedMs",1e4,l),this.Wa=Ei("forwardChannelMaxRetries",2,l),this.wa=Ei("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new Vo(l&&l.concurrentRequestLimit),this.Da=new jp,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=qu.prototype,t.la=8,t.G=1,t.connect=function(l,f,P,Q){rt(0),this.W=l,this.H=f||{},P&&Q!==void 0&&(this.H.OSID=P,this.H.OAID=Q),this.F=this.X,this.I=Zu(this,null,this.W),Ts(this)};function sl(l){if(Gu(l),l.G==3){var f=l.U++,P=kr(l.I);if(Gt(P,"SID",l.K),Gt(P,"RID",f),Gt(P,"TYPE","terminate"),$i(l,P),f=new Ve(l,l.j,f),f.L=2,f.v=Fo(kr(P)),P=!1,c.navigator&&c.navigator.sendBeacon)try{P=c.navigator.sendBeacon(f.v.toString(),"")}catch{}!P&&c.Image&&(new Image().src=f.v,P=!0),P||(f.g=ed(f.j,null),f.g.ea(f.v)),f.F=Date.now(),kt(f)}Xu(l)}function $s(l){l.g&&(ll(l),l.g.cancel(),l.g=null)}function Gu(l){$s(l),l.u&&(c.clearTimeout(l.u),l.u=null),ks(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&c.clearTimeout(l.s),l.s=null)}function Ts(l){if(!mo(l.h)&&!l.s){l.s=!0;var f=l.Ga;O||T(),J||(O(),J=!0),D.add(f,l),l.B=0}}function Wp(l,f){return yo(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=f.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Ie(w(l.Ga,l,f),Ju(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const we=new Ve(this,this.j,l);let Ae=this.o;if(this.S&&(Ae?(Ae=g(Ae),C(Ae,this.S)):Ae=this.S),this.m!==null||this.O||(we.H=Ae,Ae=null),this.P)e:{for(var f=0,P=0;P<this.i.length;P++){t:{var Q=this.i[P];if("__data__"in Q.map&&(Q=Q.map.__data__,typeof Q=="string")){Q=Q.length;break t}Q=void 0}if(Q===void 0)break;if(f+=Q,4096<f){f=P;break e}if(f===4096||P===this.i.length-1){f=P+1;break e}}f=1e3}else f=1e3;f=Wu(this,we,f),P=kr(this.I),Gt(P,"RID",l),Gt(P,"CVER",22),this.D&&Gt(P,"X-HTTP-Session-Id",this.D),$i(this,P),Ae&&(this.O?f="headers="+encodeURIComponent(String(Vu(Ae)))+"&"+f:this.m&&il(P,this.m,Ae)),Vn(this.h,we),this.Ua&&Gt(P,"TYPE","init"),this.P?(Gt(P,"$req",f),Gt(P,"SID","null"),we.T=!0,Bt(we,P,null)):Bt(we,P,f),this.G=2}}else this.G==3&&(l?Hu(this,l):this.i.length==0||mo(this.h)||Hu(this))};function Hu(l,f){var P;f?P=f.l:P=l.U++;const Q=kr(l.I);Gt(Q,"SID",l.K),Gt(Q,"RID",P),Gt(Q,"AID",l.T),$i(l,Q),l.m&&l.o&&il(Q,l.m,l.o),P=new Ve(l,l.j,P,l.B+1),l.m===null&&(P.H=l.o),f&&(l.i=f.D.concat(l.i)),f=Wu(l,P,1e3),P.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),Vn(l.h,P),Bt(P,Q,f)}function $i(l,f){l.H&&U(l.H,function(P,Q){Gt(f,Q,P)}),l.l&&Sr({},function(P,Q){Gt(f,Q,P)})}function Wu(l,f,P){P=Math.min(l.i.length,P);var Q=l.l?w(l.l.Na,l.l,l):null;e:{var we=l.i;let Ae=-1;for(;;){const Ue=["count="+P];Ae==-1?0<P?(Ae=we[0].g,Ue.push("ofs="+Ae)):Ae=0:Ue.push("ofs="+Ae);let Ht=!0;for(let yr=0;yr<P;yr++){let Mt=we[yr].g;const Pr=we[yr].map;if(Mt-=Ae,0>Mt)Ae=Math.max(0,we[yr].g-100),Ht=!1;else try{zp(Pr,Ue,"req"+Mt+"_")}catch{Q&&Q(Pr)}}if(Ht){Q=Ue.join("&");break e}}}return l=l.i.splice(0,P),f.D=l,Q}function Yu(l){if(!l.g&&!l.u){l.Y=1;var f=l.Fa;O||T(),J||(O(),J=!0),D.add(f,l),l.v=0}}function al(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Ie(w(l.Fa,l),Ju(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,Ku(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Ie(w(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,rt(10),$s(this),Ku(this))};function ll(l){l.A!=null&&(c.clearTimeout(l.A),l.A=null)}function Ku(l){l.g=new Ve(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var f=kr(l.qa);Gt(f,"RID","rpc"),Gt(f,"SID",l.K),Gt(f,"AID",l.T),Gt(f,"CI",l.F?"0":"1"),!l.F&&l.ja&&Gt(f,"TO",l.ja),Gt(f,"TYPE","xmlhttp"),$i(l,f),l.m&&l.o&&il(f,l.m,l.o),l.L&&(l.g.I=l.L);var P=l.g;l=l.ia,P.L=1,P.v=Fo(kr(f)),P.m=null,P.P=!0,ft(P,l)}t.Za=function(){this.C!=null&&(this.C=null,$s(this),al(this),rt(19))};function ks(l){l.C!=null&&(c.clearTimeout(l.C),l.C=null)}function Qu(l,f){var P=null;if(l.g==f){ks(l),ll(l),l.g=null;var Q=2}else if(On(l.h,f))P=f.D,Cs(l.h,f),Q=1;else return;if(l.G!=0){if(f.o)if(Q==1){P=f.m?f.m.length:0,f=Date.now()-f.F;var we=l.B;Q=Dt(),be(Q,new Xt(Q,P)),Ts(l)}else Yu(l);else if(we=f.s,we==3||we==0&&0<f.X||!(Q==1&&Wp(l,f)||Q==2&&al(l)))switch(P&&0<P.length&&(f=l.h,f.i=f.i.concat(P)),we){case 1:fo(l,5);break;case 4:fo(l,10);break;case 3:fo(l,6);break;default:fo(l,2)}}}function Ju(l,f){let P=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(P*=2),P*f}function fo(l,f){if(l.j.info("Error code "+f),f==2){var P=w(l.fb,l),Q=l.Xa;const we=!Q;Q=new Qt(Q||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||en(Q,"https"),Fo(Q),we?Bp(Q.toString(),P):Up(Q.toString(),P)}else rt(2);l.G=0,l.l&&l.l.sa(f),Xu(l),Gu(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),rt(2)):(this.j.info("Failed to ping google.com"),rt(1))};function Xu(l){if(l.G=0,l.ka=[],l.l){const f=Pi(l.h);(f.length!=0||l.i.length!=0)&&(x(l.ka,f),x(l.ka,l.i),l.h.i.length=0,N(l.i),l.i.length=0),l.l.ra()}}function Zu(l,f,P){var Q=P instanceof Qt?kr(P):new Qt(P);if(Q.g!="")f&&(Q.g=f+"."+Q.g),tn(Q,Q.s);else{var we=c.location;Q=we.protocol,f=f?f+"."+we.hostname:we.hostname,we=+we.port;var Ae=new Qt(null);Q&&en(Ae,Q),f&&(Ae.g=f),we&&tn(Ae,we),P&&(Ae.l=P),Q=Ae}return P=l.D,f=l.ya,P&&f&&Gt(Q,P,f),Gt(Q,"VER",l.la),$i(l,Q),Q}function ed(l,f,P){if(f&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=l.Ca&&!l.pa?new tr(new xs({eb:P})):new tr(l.pa),f.Ha(l.J),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function td(){}t=td.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Rs(){}Rs.prototype.g=function(l,f){return new Lr(l,f)};function Lr(l,f){he.call(this),this.g=new qu(f),this.l=l,this.h=f&&f.messageUrlParams||null,l=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(l?l["X-WebChannel-Content-Type"]=f.messageContentType:l={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(l?l["X-WebChannel-Client-Profile"]=f.va:l={"X-WebChannel-Client-Profile":f.va}),this.g.S=l,(l=f&&f.Sb)&&!re(l)&&(this.g.m=l),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!re(f)&&(this.g.D=f,l=this.h,l!==null&&f in l&&(l=this.h,f in l&&delete l[f])),this.j=new Uo(this)}V(Lr,he),Lr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Lr.prototype.close=function(){sl(this.g)},Lr.prototype.o=function(l){var f=this.g;if(typeof l=="string"){var P={};P.__data__=l,l=P}else this.u&&(P={},P.__data__=je(l),l=P);f.i.push(new Mn(f.Ya++,l)),f.G==3&&Ts(f)},Lr.prototype.N=function(){this.g.l=null,delete this.j,sl(this.g),delete this.g,Lr.aa.N.call(this)};function rd(l){ot.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var f=l.__sm__;if(f){e:{for(const P in f){l=P;break e}l=void 0}(this.i=l)&&(l=this.i,f=f!==null&&l in f?f[l]:void 0),this.data=f}else this.data=l}V(rd,ot);function nd(){et.call(this),this.status=1}V(nd,et);function Uo(l){this.g=l}V(Uo,td),Uo.prototype.ua=function(){be(this.g,"a")},Uo.prototype.ta=function(l){be(this.g,new rd(l))},Uo.prototype.sa=function(l){be(this.g,new nd)},Uo.prototype.ra=function(){be(this.g,"b")},Rs.prototype.createWebChannel=Rs.prototype.g,Lr.prototype.send=Lr.prototype.o,Lr.prototype.open=Lr.prototype.m,Lr.prototype.close=Lr.prototype.close,Qy=function(){return new Rs},Ky=function(){return Dt()},Yy=Ct,sc={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Xe.NO_ERROR=0,Xe.TIMEOUT=8,Xe.HTTP_ERROR=6,oa=Xe,yt.COMPLETE="complete",Wy=yt,Je.EventType=xe,xe.OPEN="a",xe.CLOSE="b",xe.ERROR="c",xe.MESSAGE="d",he.prototype.listen=he.prototype.K,Oi=Je,tr.prototype.listenOnce=tr.prototype.L,tr.prototype.getLastError=tr.prototype.Ka,tr.prototype.getLastErrorCode=tr.prototype.Ba,tr.prototype.getStatus=tr.prototype.Z,tr.prototype.getResponseJson=tr.prototype.Oa,tr.prototype.getResponseText=tr.prototype.oa,tr.prototype.send=tr.prototype.ea,tr.prototype.setWithCredentials=tr.prototype.Ha,Hy=tr}).apply(typeof Ms<"u"?Ms:typeof self<"u"?self:typeof window<"u"?window:{});const zd="@firebase/firestore",qd="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}xr.UNAUTHENTICATED=new xr(null),xr.GOOGLE_CREDENTIALS=new xr("google-credentials-uid"),xr.FIRST_PARTY=new xr("first-party-uid"),xr.MOCK_USER=new xr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gi="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ro=new Nc("@firebase/firestore");function Ko(){return Ro.logLevel}function Ye(t,...e){if(Ro.logLevel<=xt.DEBUG){const r=e.map(Wc);Ro.debug(`Firestore (${gi}): ${t}`,...r)}}function kn(t,...e){if(Ro.logLevel<=xt.ERROR){const r=e.map(Wc);Ro.error(`Firestore (${gi}): ${t}`,...r)}}function ai(t,...e){if(Ro.logLevel<=xt.WARN){const r=e.map(Wc);Ro.warn(`Firestore (${gi}): ${t}`,...r)}}function Wc(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function it(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,Jy(t,n,r)}function Jy(t,e,r){let n=`FIRESTORE (${gi}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw kn(n),new Error(n)}function Ut(t,e,r,n){let o="Unexpected state";typeof r=="string"?o=r:n=r,t||Jy(e,o,n)}function ht(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Te={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ge extends Ln{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xy{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class X_{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(xr.UNAUTHENTICATED))}shutdown(){}}class Z_{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class eS{constructor(e){this.t=e,this.currentUser=xr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Ut(this.o===void 0,42304);let n=this.i;const o=d=>this.i!==n?(n=this.i,r(d)):Promise.resolve();let i=new En;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new En,e.enqueueRetryable(()=>o(this.currentUser))};const a=()=>{const d=i;e.enqueueRetryable(async()=>{await d.promise,await o(this.currentUser)})},c=d=>{Ye("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(d=>c(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?c(d):(Ye("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new En)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Ye("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Ut(typeof n.accessToken=="string",31837,{l:n}),new Xy(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ut(e===null||typeof e=="string",2055,{h:e}),new xr(e)}}class tS{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=xr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class rS{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new tS(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(xr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Gd{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class nS{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,zr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Ut(this.o===void 0,3512);const n=i=>{i.error!=null&&Ye("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,Ye("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const o=i=>{Ye("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>o(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?o(i):Ye("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Gd(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Ut(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new Gd(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oS(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const o=oS(40);for(let i=0;i<o.length;++i)n.length<20&&o[i]<r&&(n+=e.charAt(o[i]%62))}return n}}function It(t,e){return t<e?-1:t>e?1:0}function ac(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const o=t.charAt(n),i=e.charAt(n);if(o!==i)return Pl(o)===Pl(i)?It(o,i):Pl(o)?1:-1}return It(t.length,e.length)}const iS=55296,sS=57343;function Pl(t){const e=t.charCodeAt(0);return e>=iS&&e<=sS}function li(t,e,r){return t.length===e.length&&t.every((n,o)=>r(n,e[o]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hd="__name__";class sn{constructor(e,r,n){r===void 0?r=0:r>e.length&&it(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&it(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return sn.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof sn?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let o=0;o<n;o++){const i=sn.compareSegments(e.get(o),r.get(o));if(i!==0)return i}return It(e.length,r.length)}static compareSegments(e,r){const n=sn.isNumericId(e),o=sn.isNumericId(r);return n&&!o?-1:!n&&o?1:n&&o?sn.extractNumericId(e).compare(sn.extractNumericId(r)):ac(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Zn.fromString(e.substring(4,e.length-2))}}class Yt extends sn{construct(e,r,n){return new Yt(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ge(Te.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(o=>o.length>0))}return new Yt(r)}static emptyPath(){return new Yt([])}}const aS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class pr extends sn{construct(e,r,n){return new pr(e,r,n)}static isValidIdentifier(e){return aS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),pr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Hd}static keyField(){return new pr([Hd])}static fromServerFormat(e){const r=[];let n="",o=0;const i=()=>{if(n.length===0)throw new Ge(Te.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;o<e.length;){const c=e[o];if(c==="\\"){if(o+1===e.length)throw new Ge(Te.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[o+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new Ge(Te.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=d,o+=2}else c==="`"?(a=!a,o++):c!=="."||a?(n+=c,o++):(i(),o++)}if(i(),a)throw new Ge(Te.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new pr(r)}static emptyPath(){return new pr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{constructor(e){this.path=e}static fromPath(e){return new tt(Yt.fromString(e))}static fromName(e){return new tt(Yt.fromString(e).popFirst(5))}static empty(){return new tt(Yt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Yt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Yt.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new tt(new Yt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zy(t,e,r){if(!r)throw new Ge(Te.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function lS(t,e,r,n){if(e===!0&&n===!0)throw new Ge(Te.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function Wd(t){if(!tt.isDocumentKey(t))throw new Ge(Te.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Yd(t){if(tt.isDocumentKey(t))throw new Ge(Te.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ef(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function qa(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":it(12329,{type:typeof t})}function Rn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ge(Te.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=qa(t);throw new Ge(Te.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lr(t,e){const r={typeString:t};return e&&(r.value=e),r}function gs(t,e){if(!ef(t))throw new Ge(Te.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const o=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const a=t[n];if(o&&typeof a!==o){r=`JSON field '${n}' must be a ${o}.`;break}if(i!==void 0&&a!==i.value){r=`Expected '${n}' field to equal '${i.value}'`;break}}if(r)throw new Ge(Te.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kd=-62135596800,Qd=1e6;class Jt{static now(){return Jt.fromMillis(Date.now())}static fromDate(e){return Jt.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*Qd);return new Jt(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Ge(Te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Ge(Te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<Kd)throw new Ge(Te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ge(Te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Qd}_compareTo(e){return this.seconds===e.seconds?It(this.nanoseconds,e.nanoseconds):It(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Jt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(gs(e,Jt._jsonSchema))return new Jt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Kd;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Jt._jsonSchemaVersion="firestore/timestamp/1.0",Jt._jsonSchema={type:lr("string",Jt._jsonSchemaVersion),seconds:lr("number"),nanoseconds:lr("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{static fromTimestamp(e){return new dt(e)}static min(){return new dt(new Jt(0,0))}static max(){return new dt(new Jt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ns=-1;function cS(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,o=dt.fromTimestamp(n===1e9?new Jt(r+1,0):new Jt(r,n));return new to(o,tt.empty(),e)}function uS(t){return new to(t.readTime,t.key,ns)}class to{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new to(dt.min(),tt.empty(),ns)}static max(){return new to(dt.max(),tt.empty(),ns)}}function dS(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=tt.comparator(t.documentKey,e.documentKey),r!==0?r:It(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class mS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vi(t){if(t.code!==Te.FAILED_PRECONDITION||t.message!==hS)throw t;Ye("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&it(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Re((n,o)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,o)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,o)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Re?r:Re.resolve(r)}catch(r){return Re.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Re.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Re.reject(r)}static resolve(e){return new Re((r,n)=>{r(e)})}static reject(e){return new Re((r,n)=>{n(e)})}static waitFor(e){return new Re((r,n)=>{let o=0,i=0,a=!1;e.forEach(c=>{++o,c.next(()=>{++i,a&&i===o&&r()},d=>n(d))}),a=!0,i===o&&r()})}static or(e){let r=Re.resolve(!1);for(const n of e)r=r.next(o=>o?Re.resolve(o):n());return r}static forEach(e,r){const n=[];return e.forEach((o,i)=>{n.push(r.call(this,o,i))}),this.waitFor(n)}static mapArray(e,r){return new Re((n,o)=>{const i=e.length,a=new Array(i);let c=0;for(let d=0;d<i;d++){const h=d;r(e[h]).next(y=>{a[h]=y,++c,c===i&&n(a)},y=>o(y))}})}static doWhile(e,r){return new Re((n,o)=>{const i=()=>{e()===!0?r().next(()=>{i()},o):n()};i()})}}function yS(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function bi(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ga{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ga.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kc=-1;function Ha(t){return t==null}function Aa(t){return t===0&&1/t==-1/0}function fS(t){return typeof t=="number"&&Number.isInteger(t)&&!Aa(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tf="";function pS(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=Jd(e)),e=gS(t.get(r),e);return Jd(e)}function gS(t,e){let r=e;const n=t.length;for(let o=0;o<n;o++){const i=t.charAt(o);switch(i){case"\0":r+="";break;case tf:r+="";break;default:r+=i}}return r}function Jd(t){return t+tf+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xd(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function uo(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function rf(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(e,r){this.comparator=e,this.root=r||fr.EMPTY}insert(e,r){return new er(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,fr.BLACK,null,null))}remove(e){return new er(this.comparator,this.root.remove(e,this.comparator).copy(null,null,fr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const o=this.comparator(e,n.key);if(o===0)return r+n.left.size;o<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Os(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Os(this.root,e,this.comparator,!1)}getReverseIterator(){return new Os(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Os(this.root,e,this.comparator,!0)}}class Os{constructor(e,r,n,o){this.isReverse=o,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&o&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class fr{constructor(e,r,n,o,i){this.key=e,this.value=r,this.color=n??fr.RED,this.left=o??fr.EMPTY,this.right=i??fr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,o,i){return new fr(e??this.key,r??this.value,n??this.color,o??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let o=this;const i=n(e,o.key);return o=i<0?o.copy(null,null,null,o.left.insert(e,r,n),null):i===0?o.copy(null,r,null,null,null):o.copy(null,null,null,null,o.right.insert(e,r,n)),o.fixUp()}removeMin(){if(this.left.isEmpty())return fr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,o=this;if(r(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,r),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),r(e,o.key)===0){if(o.right.isEmpty())return fr.EMPTY;n=o.right.min(),o=o.copy(n.key,n.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,r))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,fr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,fr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw it(43730,{key:this.key,value:this.value});if(this.right.isRed())throw it(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw it(27949);return e+(this.isRed()?0:1)}}fr.EMPTY=null,fr.RED=!0,fr.BLACK=!1;fr.EMPTY=new class{constructor(){this.size=0}get key(){throw it(57766)}get value(){throw it(16141)}get color(){throw it(16727)}get left(){throw it(29726)}get right(){throw it(36894)}copy(e,r,n,o,i){return this}insert(e,r,n){return new fr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur{constructor(e){this.comparator=e,this.data=new er(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const o=n.getNext();if(this.comparator(o.key,e[1])>=0)return;r(o.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new Zd(this.data.getIterator())}getIteratorFrom(e){return new Zd(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof ur)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const o=r.getNext().key,i=n.getNext().key;if(this.comparator(o,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new ur(this.comparator);return r.data=e,r}}class Zd{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr{constructor(e){this.fields=e,e.sort(pr.comparator)}static empty(){return new Vr([])}unionWith(e){let r=new ur(pr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Vr(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return li(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(o){try{return atob(o)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new nf("Invalid base64 string: "+i):i}}(e);return new br(r)}static fromUint8Array(e){const r=function(o){let i="";for(let a=0;a<o.length;++a)i+=String.fromCharCode(o[a]);return i}(e);return new br(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let o=0;o<r.length;o++)n[o]=r.charCodeAt(o);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return It(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}br.EMPTY_BYTE_STRING=new br("");const vS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ro(t){if(Ut(!!t,39018),typeof t=="string"){let e=0;const r=vS.exec(t);if(Ut(!!r,46558,{timestamp:t}),r[1]){let o=r[1];o=(o+"000000000").substr(0,9),e=Number(o)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:rr(t.seconds),nanos:rr(t.nanos)}}function rr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function no(t){return typeof t=="string"?br.fromBase64String(t):br.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const of="server_timestamp",sf="__type__",af="__previous_value__",lf="__local_write_time__";function Qc(t){return(t?.mapValue?.fields||{})[sf]?.stringValue===of}function Wa(t){const e=t.mapValue.fields[af];return Qc(e)?Wa(e):e}function os(t){const e=ro(t.mapValue.fields[lf].timestampValue);return new Jt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bS{constructor(e,r,n,o,i,a,c,d,h,y){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=o,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=d,this.useFetchStreams=h,this.isUsingEmulator=y}}const xa="(default)";class is{constructor(e,r){this.projectId=e,this.database=r||xa}static empty(){return new is("","")}get isDefaultDatabase(){return this.database===xa}isEqual(e){return e instanceof is&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cf="__type__",_S="__max__",Vs={mapValue:{}},uf="__vector__",Ia="value";function oo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Qc(t)?4:PS(t)?9007199254740991:SS(t)?10:11:it(28295,{value:t})}function pn(t,e){if(t===e)return!0;const r=oo(t);if(r!==oo(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return os(t).isEqual(os(e));case 3:return function(o,i){if(typeof o.timestampValue=="string"&&typeof i.timestampValue=="string"&&o.timestampValue.length===i.timestampValue.length)return o.timestampValue===i.timestampValue;const a=ro(o.timestampValue),c=ro(i.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(o,i){return no(o.bytesValue).isEqual(no(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(o,i){return rr(o.geoPointValue.latitude)===rr(i.geoPointValue.latitude)&&rr(o.geoPointValue.longitude)===rr(i.geoPointValue.longitude)}(t,e);case 2:return function(o,i){if("integerValue"in o&&"integerValue"in i)return rr(o.integerValue)===rr(i.integerValue);if("doubleValue"in o&&"doubleValue"in i){const a=rr(o.doubleValue),c=rr(i.doubleValue);return a===c?Aa(a)===Aa(c):isNaN(a)&&isNaN(c)}return!1}(t,e);case 9:return li(t.arrayValue.values||[],e.arrayValue.values||[],pn);case 10:case 11:return function(o,i){const a=o.mapValue.fields||{},c=i.mapValue.fields||{};if(Xd(a)!==Xd(c))return!1;for(const d in a)if(a.hasOwnProperty(d)&&(c[d]===void 0||!pn(a[d],c[d])))return!1;return!0}(t,e);default:return it(52216,{left:t})}}function ss(t,e){return(t.values||[]).find(r=>pn(r,e))!==void 0}function ci(t,e){if(t===e)return 0;const r=oo(t),n=oo(e);if(r!==n)return It(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return It(t.booleanValue,e.booleanValue);case 2:return function(i,a){const c=rr(i.integerValue||i.doubleValue),d=rr(a.integerValue||a.doubleValue);return c<d?-1:c>d?1:c===d?0:isNaN(c)?isNaN(d)?0:-1:1}(t,e);case 3:return eh(t.timestampValue,e.timestampValue);case 4:return eh(os(t),os(e));case 5:return ac(t.stringValue,e.stringValue);case 6:return function(i,a){const c=no(i),d=no(a);return c.compareTo(d)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const c=i.split("/"),d=a.split("/");for(let h=0;h<c.length&&h<d.length;h++){const y=It(c[h],d[h]);if(y!==0)return y}return It(c.length,d.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const c=It(rr(i.latitude),rr(a.latitude));return c!==0?c:It(rr(i.longitude),rr(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return th(t.arrayValue,e.arrayValue);case 10:return function(i,a){const c=i.fields||{},d=a.fields||{},h=c[Ia]?.arrayValue,y=d[Ia]?.arrayValue,v=It(h?.values?.length||0,y?.values?.length||0);return v!==0?v:th(h,y)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===Vs.mapValue&&a===Vs.mapValue)return 0;if(i===Vs.mapValue)return 1;if(a===Vs.mapValue)return-1;const c=i.fields||{},d=Object.keys(c),h=a.fields||{},y=Object.keys(h);d.sort(),y.sort();for(let v=0;v<d.length&&v<y.length;++v){const w=ac(d[v],y[v]);if(w!==0)return w;const E=ci(c[d[v]],h[y[v]]);if(E!==0)return E}return It(d.length,y.length)}(t.mapValue,e.mapValue);default:throw it(23264,{he:r})}}function eh(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return It(t,e);const r=ro(t),n=ro(e),o=It(r.seconds,n.seconds);return o!==0?o:It(r.nanos,n.nanos)}function th(t,e){const r=t.values||[],n=e.values||[];for(let o=0;o<r.length&&o<n.length;++o){const i=ci(r[o],n[o]);if(i)return i}return It(r.length,n.length)}function ui(t){return lc(t)}function lc(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=ro(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return no(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return tt.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",o=!0;for(const i of r.values||[])o?o=!1:n+=",",n+=lc(i);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let o="{",i=!0;for(const a of n)i?i=!1:o+=",",o+=`${a}:${lc(r.fields[a])}`;return o+"}"}(t.mapValue):it(61005,{value:t})}function ia(t){switch(oo(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Wa(t);return e?16+ia(e):16;case 5:return 2*t.stringValue.length;case 6:return no(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((o,i)=>o+ia(i),0)}(t.arrayValue);case 10:case 11:return function(n){let o=0;return uo(n.fields,(i,a)=>{o+=i.length+ia(a)}),o}(t.mapValue);default:throw it(13486,{value:t})}}function rh(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function cc(t){return!!t&&"integerValue"in t}function Jc(t){return!!t&&"arrayValue"in t}function nh(t){return!!t&&"nullValue"in t}function oh(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function sa(t){return!!t&&"mapValue"in t}function SS(t){return(t?.mapValue?.fields||{})[cf]?.stringValue===uf}function Hi(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return uo(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Hi(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Hi(t.arrayValue.values[r]);return e}return{...t}}function PS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===_S}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(e){this.value=e}static empty(){return new Nr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!sa(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Hi(r)}setAll(e){let r=pr.emptyPath(),n={},o=[];e.forEach((a,c)=>{if(!r.isImmediateParentOf(c)){const d=this.getFieldsMap(r);this.applyChanges(d,n,o),n={},o=[],r=c.popLast()}a?n[c.lastSegment()]=Hi(a):o.push(c.lastSegment())});const i=this.getFieldsMap(r);this.applyChanges(i,n,o)}delete(e){const r=this.field(e.popLast());sa(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return pn(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let o=r.mapValue.fields[e.get(n)];sa(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=o),r=o}return r.mapValue.fields}applyChanges(e,r,n){uo(r,(o,i)=>e[o]=i);for(const o of n)delete e[o]}clone(){return new Nr(Hi(this.value))}}function df(t){const e=[];return uo(t.fields,(r,n)=>{const o=new pr([r]);if(sa(n)){const i=df(n.mapValue).fields;if(i.length===0)e.push(o);else for(const a of i)e.push(o.child(a))}else e.push(o)}),new Vr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(e,r,n,o,i,a,c){this.key=e,this.documentType=r,this.version=n,this.readTime=o,this.createTime=i,this.data=a,this.documentState=c}static newInvalidDocument(e){return new Ir(e,0,dt.min(),dt.min(),dt.min(),Nr.empty(),0)}static newFoundDocument(e,r,n,o){return new Ir(e,1,r,dt.min(),n,o,0)}static newNoDocument(e,r){return new Ir(e,2,r,dt.min(),dt.min(),Nr.empty(),0)}static newUnknownDocument(e,r){return new Ir(e,3,r,dt.min(),dt.min(),Nr.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(dt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Nr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Nr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=dt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ir&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ir(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{constructor(e,r){this.position=e,this.inclusive=r}}function ih(t,e,r){let n=0;for(let o=0;o<t.position.length;o++){const i=e[o],a=t.position[o];if(i.field.isKeyField()?n=tt.comparator(tt.fromName(a.referenceValue),r.key):n=ci(a,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function sh(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!pn(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(e,r="asc"){this.field=e,this.dir=r}}function wS(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf{}class ar extends hf{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new AS(e,r,n):r==="array-contains"?new ES(e,n):r==="in"?new $S(e,n):r==="not-in"?new TS(e,n):r==="array-contains-any"?new kS(e,n):new ar(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new xS(e,n):new IS(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(ci(r,this.value)):r!==null&&oo(this.value)===oo(r)&&this.matchesComparison(ci(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return it(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Zr extends hf{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Zr(e,r)}matches(e){return mf(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function mf(t){return t.op==="and"}function yf(t){return CS(t)&&mf(t)}function CS(t){for(const e of t.filters)if(e instanceof Zr)return!1;return!0}function uc(t){if(t instanceof ar)return t.field.canonicalString()+t.op.toString()+ui(t.value);if(yf(t))return t.filters.map(e=>uc(e)).join(",");{const e=t.filters.map(r=>uc(r)).join(",");return`${t.op}(${e})`}}function ff(t,e){return t instanceof ar?function(n,o){return o instanceof ar&&n.op===o.op&&n.field.isEqual(o.field)&&pn(n.value,o.value)}(t,e):t instanceof Zr?function(n,o){return o instanceof Zr&&n.op===o.op&&n.filters.length===o.filters.length?n.filters.reduce((i,a,c)=>i&&ff(a,o.filters[c]),!0):!1}(t,e):void it(19439)}function pf(t){return t instanceof ar?function(r){return`${r.field.canonicalString()} ${r.op} ${ui(r.value)}`}(t):t instanceof Zr?function(r){return r.op.toString()+" {"+r.getFilters().map(pf).join(" ,")+"}"}(t):"Filter"}class AS extends ar{constructor(e,r,n){super(e,r,n),this.key=tt.fromName(n.referenceValue)}matches(e){const r=tt.comparator(e.key,this.key);return this.matchesComparison(r)}}class xS extends ar{constructor(e,r){super(e,"in",r),this.keys=gf("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class IS extends ar{constructor(e,r){super(e,"not-in",r),this.keys=gf("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function gf(t,e){return(e.arrayValue?.values||[]).map(r=>tt.fromName(r.referenceValue))}class ES extends ar{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Jc(r)&&ss(r.arrayValue,this.value)}}class $S extends ar{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&ss(this.value.arrayValue,r)}}class TS extends ar{constructor(e,r){super(e,"not-in",r)}matches(e){if(ss(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!ss(this.value.arrayValue,r)}}class kS extends ar{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Jc(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>ss(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RS{constructor(e,r=null,n=[],o=[],i=null,a=null,c=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=o,this.limit=i,this.startAt=a,this.endAt=c,this.Te=null}}function ah(t,e=null,r=[],n=[],o=null,i=null,a=null){return new RS(t,e,r,n,o,i,a)}function Xc(t){const e=ht(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>uc(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),Ha(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>ui(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>ui(n)).join(",")),e.Te=r}return e.Te}function Zc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!wS(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!ff(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!sh(t.startAt,e.startAt)&&sh(t.endAt,e.endAt)}function dc(t){return tt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e,r=null,n=[],o=[],i=null,a="F",c=null,d=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=o,this.limit=i,this.limitType=a,this.startAt=c,this.endAt=d,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function DS(t,e,r,n,o,i,a,c){return new _i(t,e,r,n,o,i,a,c)}function eu(t){return new _i(t)}function lh(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function vf(t){return t.collectionGroup!==null}function Wi(t){const e=ht(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new ur(pr.comparator);return a.filters.forEach(d=>{d.getFlattenedFilters().forEach(h=>{h.isInequality()&&(c=c.add(h.field))})}),c})(e).forEach(i=>{r.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new as(i,n))}),r.has(pr.keyField().canonicalString())||e.Ie.push(new as(pr.keyField(),n))}return e.Ie}function un(t){const e=ht(t);return e.Ee||(e.Ee=NS(e,Wi(t))),e.Ee}function NS(t,e){if(t.limitType==="F")return ah(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(o=>{const i=o.dir==="desc"?"asc":"desc";return new as(o.field,i)});const r=t.endAt?new Ea(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Ea(t.startAt.position,t.startAt.inclusive):null;return ah(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function hc(t,e){const r=t.filters.concat([e]);return new _i(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function mc(t,e,r){return new _i(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Ya(t,e){return Zc(un(t),un(e))&&t.limitType===e.limitType}function bf(t){return`${Xc(un(t))}|lt:${t.limitType}`}function Qo(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(o=>pf(o)).join(", ")}]`),Ha(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(o=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(o)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(o=>ui(o)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(o=>ui(o)).join(",")),`Target(${n})`}(un(t))}; limitType=${t.limitType})`}function Ka(t,e){return e.isFoundDocument()&&function(n,o){const i=o.key.path;return n.collectionGroup!==null?o.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):tt.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,o){for(const i of Wi(n))if(!i.field.isKeyField()&&o.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,o){for(const i of n.filters)if(!i.matches(o))return!1;return!0}(t,e)&&function(n,o){return!(n.startAt&&!function(a,c,d){const h=ih(a,c,d);return a.inclusive?h<=0:h<0}(n.startAt,Wi(n),o)||n.endAt&&!function(a,c,d){const h=ih(a,c,d);return a.inclusive?h>=0:h>0}(n.endAt,Wi(n),o))}(t,e)}function LS(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function _f(t){return(e,r)=>{let n=!1;for(const o of Wi(t)){const i=MS(o,e,r);if(i!==0)return i;n=n||o.field.isKeyField()}return 0}}function MS(t,e,r){const n=t.field.isKeyField()?tt.comparator(e.key,r.key):function(i,a,c){const d=a.data.field(i),h=c.data.field(i);return d!==null&&h!==null?ci(d,h):it(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return it(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[o,i]of n)if(this.equalsFn(o,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),o=this.inner[n];if(o===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<o.length;i++)if(this.equalsFn(o[i][0],e))return void(o[i]=[e,r]);o.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let o=0;o<n.length;o++)if(this.equalsFn(n[o][0],e))return n.length===1?delete this.inner[r]:n.splice(o,1),this.innerSize--,!0;return!1}forEach(e){uo(this.inner,(r,n)=>{for(const[o,i]of n)e(o,i)})}isEmpty(){return rf(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OS=new er(tt.comparator);function Dn(){return OS}const Sf=new er(tt.comparator);function Vi(...t){let e=Sf;for(const r of t)e=e.insert(r.key,r);return e}function Pf(t){let e=Sf;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function xo(){return Yi()}function wf(){return Yi()}function Yi(){return new Lo(t=>t.toString(),(t,e)=>t.isEqual(e))}const VS=new er(tt.comparator),FS=new ur(tt.comparator);function Et(...t){let e=FS;for(const r of t)e=e.add(r);return e}const BS=new ur(It);function US(){return BS}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tu(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Aa(e)?"-0":e}}function Cf(t){return{integerValue:""+t}}function jS(t,e){return fS(e)?Cf(e):tu(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(){this._=void 0}}function zS(t,e,r){return t instanceof $a?function(o,i){const a={fields:{[sf]:{stringValue:of},[lf]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return i&&Qc(i)&&(i=Wa(i)),i&&(a.fields[af]=i),{mapValue:a}}(r,e):t instanceof ls?xf(t,e):t instanceof cs?If(t,e):function(o,i){const a=Af(o,i),c=ch(a)+ch(o.Ae);return cc(a)&&cc(o.Ae)?Cf(c):tu(o.serializer,c)}(t,e)}function qS(t,e,r){return t instanceof ls?xf(t,e):t instanceof cs?If(t,e):r}function Af(t,e){return t instanceof Ta?function(n){return cc(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class $a extends Qa{}class ls extends Qa{constructor(e){super(),this.elements=e}}function xf(t,e){const r=Ef(e);for(const n of t.elements)r.some(o=>pn(o,n))||r.push(n);return{arrayValue:{values:r}}}class cs extends Qa{constructor(e){super(),this.elements=e}}function If(t,e){let r=Ef(e);for(const n of t.elements)r=r.filter(o=>!pn(o,n));return{arrayValue:{values:r}}}class Ta extends Qa{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function ch(t){return rr(t.integerValue||t.doubleValue)}function Ef(t){return Jc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function GS(t,e){return t.field.isEqual(e.field)&&function(n,o){return n instanceof ls&&o instanceof ls||n instanceof cs&&o instanceof cs?li(n.elements,o.elements,pn):n instanceof Ta&&o instanceof Ta?pn(n.Ae,o.Ae):n instanceof $a&&o instanceof $a}(t.transform,e.transform)}class HS{constructor(e,r){this.version=e,this.transformResults=r}}class dn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new dn}static exists(e){return new dn(void 0,e)}static updateTime(e){return new dn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function aa(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Ja{}function $f(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new kf(t.key,dn.none()):new vs(t.key,t.data,dn.none());{const r=t.data,n=Nr.empty();let o=new ur(pr.comparator);for(let i of e.fields)if(!o.has(i)){let a=r.field(i);a===null&&i.length>1&&(i=i.popLast(),a=r.field(i)),a===null?n.delete(i):n.set(i,a),o=o.add(i)}return new ho(t.key,n,new Vr(o.toArray()),dn.none())}}function WS(t,e,r){t instanceof vs?function(o,i,a){const c=o.value.clone(),d=dh(o.fieldTransforms,i,a.transformResults);c.setAll(d),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,r):t instanceof ho?function(o,i,a){if(!aa(o.precondition,i))return void i.convertToUnknownDocument(a.version);const c=dh(o.fieldTransforms,i,a.transformResults),d=i.data;d.setAll(Tf(o)),d.setAll(c),i.convertToFoundDocument(a.version,d).setHasCommittedMutations()}(t,e,r):function(o,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function Ki(t,e,r,n){return t instanceof vs?function(i,a,c,d){if(!aa(i.precondition,a))return c;const h=i.value.clone(),y=hh(i.fieldTransforms,d,a);return h.setAll(y),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(t,e,r,n):t instanceof ho?function(i,a,c,d){if(!aa(i.precondition,a))return c;const h=hh(i.fieldTransforms,d,a),y=a.data;return y.setAll(Tf(i)),y.setAll(h),a.convertToFoundDocument(a.version,y).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(v=>v.field))}(t,e,r,n):function(i,a,c){return aa(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(t,e,r)}function YS(t,e){let r=null;for(const n of t.fieldTransforms){const o=e.data.field(n.field),i=Af(n.transform,o||null);i!=null&&(r===null&&(r=Nr.empty()),r.set(n.field,i))}return r||null}function uh(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,o){return n===void 0&&o===void 0||!(!n||!o)&&li(n,o,(i,a)=>GS(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class vs extends Ja{constructor(e,r,n,o=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class ho extends Ja{constructor(e,r,n,o,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=o,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Tf(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function dh(t,e,r){const n=new Map;Ut(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let o=0;o<r.length;o++){const i=t[o],a=i.transform,c=e.data.field(i.field);n.set(i.field,qS(a,c,r[o]))}return n}function hh(t,e,r){const n=new Map;for(const o of t){const i=o.transform,a=r.data.field(o.field);n.set(o.field,zS(i,a,e))}return n}class kf extends Ja{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class KS extends Ja{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(e,r,n,o){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=o}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let o=0;o<this.mutations.length;o++){const i=this.mutations[o];i.key.isEqual(e.key)&&WS(i,e,n[o])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Ki(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Ki(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=wf();return this.mutations.forEach(o=>{const i=e.get(o.key),a=i.overlayedDocument;let c=this.applyToLocalView(a,i.mutatedFields);c=r.has(o.key)?null:c;const d=$f(a,c);d!==null&&n.set(o.key,d),a.isValidDocument()||a.convertToNoDocument(dt.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Et())}isEqual(e){return this.batchId===e.batchId&&li(this.mutations,e.mutations,(r,n)=>uh(r,n))&&li(this.baseMutations,e.baseMutations,(r,n)=>uh(r,n))}}class ru{constructor(e,r,n,o){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=o}static from(e,r,n){Ut(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let o=function(){return VS}();const i=e.mutations;for(let a=0;a<i.length;a++)o=o.insert(i[a].key,n[a].version);return new ru(e,r,n,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XS{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var sr,Rt;function ZS(t){switch(t){case Te.OK:return it(64938);case Te.CANCELLED:case Te.UNKNOWN:case Te.DEADLINE_EXCEEDED:case Te.RESOURCE_EXHAUSTED:case Te.INTERNAL:case Te.UNAVAILABLE:case Te.UNAUTHENTICATED:return!1;case Te.INVALID_ARGUMENT:case Te.NOT_FOUND:case Te.ALREADY_EXISTS:case Te.PERMISSION_DENIED:case Te.FAILED_PRECONDITION:case Te.ABORTED:case Te.OUT_OF_RANGE:case Te.UNIMPLEMENTED:case Te.DATA_LOSS:return!0;default:return it(15467,{code:t})}}function Rf(t){if(t===void 0)return kn("GRPC error has no .code"),Te.UNKNOWN;switch(t){case sr.OK:return Te.OK;case sr.CANCELLED:return Te.CANCELLED;case sr.UNKNOWN:return Te.UNKNOWN;case sr.DEADLINE_EXCEEDED:return Te.DEADLINE_EXCEEDED;case sr.RESOURCE_EXHAUSTED:return Te.RESOURCE_EXHAUSTED;case sr.INTERNAL:return Te.INTERNAL;case sr.UNAVAILABLE:return Te.UNAVAILABLE;case sr.UNAUTHENTICATED:return Te.UNAUTHENTICATED;case sr.INVALID_ARGUMENT:return Te.INVALID_ARGUMENT;case sr.NOT_FOUND:return Te.NOT_FOUND;case sr.ALREADY_EXISTS:return Te.ALREADY_EXISTS;case sr.PERMISSION_DENIED:return Te.PERMISSION_DENIED;case sr.FAILED_PRECONDITION:return Te.FAILED_PRECONDITION;case sr.ABORTED:return Te.ABORTED;case sr.OUT_OF_RANGE:return Te.OUT_OF_RANGE;case sr.UNIMPLEMENTED:return Te.UNIMPLEMENTED;case sr.DATA_LOSS:return Te.DATA_LOSS;default:return it(39323,{code:t})}}(Rt=sr||(sr={}))[Rt.OK=0]="OK",Rt[Rt.CANCELLED=1]="CANCELLED",Rt[Rt.UNKNOWN=2]="UNKNOWN",Rt[Rt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Rt[Rt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Rt[Rt.NOT_FOUND=5]="NOT_FOUND",Rt[Rt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Rt[Rt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Rt[Rt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Rt[Rt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Rt[Rt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Rt[Rt.ABORTED=10]="ABORTED",Rt[Rt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Rt[Rt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Rt[Rt.INTERNAL=13]="INTERNAL",Rt[Rt.UNAVAILABLE=14]="UNAVAILABLE",Rt[Rt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e1(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t1=new Zn([4294967295,4294967295],0);function mh(t){const e=e1().encode(t),r=new Gy;return r.update(e),new Uint8Array(r.digest())}function yh(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),o=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Zn([r,n],0),new Zn([o,i],0)]}class nu{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Fi(`Invalid padding: ${r}`);if(n<0)throw new Fi(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Fi(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Fi(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Zn.fromNumber(this.ge)}ye(e,r,n){let o=e.add(r.multiply(Zn.fromNumber(n)));return o.compare(t1)===1&&(o=new Zn([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=mh(e),[n,o]=yh(r);for(let i=0;i<this.hashCount;i++){const a=this.ye(n,o,i);if(!this.we(a))return!1}return!0}static create(e,r,n){const o=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new nu(i,o,r);return n.forEach(c=>a.insert(c)),a}insert(e){if(this.ge===0)return;const r=mh(e),[n,o]=yh(r);for(let i=0;i<this.hashCount;i++){const a=this.ye(n,o,i);this.Se(a)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Fi extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xa{constructor(e,r,n,o,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=o,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const o=new Map;return o.set(e,bs.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Xa(dt.min(),o,new er(It),Dn(),Et())}}class bs{constructor(e,r,n,o,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=o,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new bs(n,r,Et(),Et(),Et())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class la{constructor(e,r,n,o){this.be=e,this.removedTargetIds=r,this.key=n,this.De=o}}class Df{constructor(e,r){this.targetId=e,this.Ce=r}}class Nf{constructor(e,r,n=br.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=o}}class fh{constructor(){this.ve=0,this.Fe=ph(),this.Me=br.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Et(),r=Et(),n=Et();return this.Fe.forEach((o,i)=>{switch(i){case 0:e=e.add(o);break;case 2:r=r.add(o);break;case 1:n=n.add(o);break;default:it(38017,{changeType:i})}}),new bs(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=ph()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ut(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class r1{constructor(e){this.Ge=e,this.ze=new Map,this.je=Dn(),this.Je=Fs(),this.He=Fs(),this.Ye=new er(It)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:it(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,o)=>{this.rt(o)&&r(o)})}st(e){const r=e.targetId,n=e.Ce.count,o=this.ot(r);if(o){const i=o.target;if(dc(i))if(n===0){const a=new tt(i.path);this.et(r,a,Ir.newNoDocument(a,dt.min()))}else Ut(n===1,20013,{expectedCount:n});else{const a=this._t(r);if(a!==n){const c=this.ut(e),d=c?this.ct(c,e,a):1;if(d!==0){this.it(r);const h=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,h)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:o=0},hashCount:i=0}=r;let a,c;try{a=no(n).toUint8Array()}catch(d){if(d instanceof nf)return ai("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{c=new nu(a,o,i)}catch(d){return ai(d instanceof Fi?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return c.ge===0?null:c}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let o=0;return n.forEach(i=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(r,i,null),o++)}),o}Tt(e){const r=new Map;this.ze.forEach((i,a)=>{const c=this.ot(a);if(c){if(i.current&&dc(c.target)){const d=new tt(c.target.path);this.It(d).has(a)||this.Et(a,d)||this.et(a,d,Ir.newNoDocument(d,e))}i.Be&&(r.set(a,i.ke()),i.qe())}});let n=Et();this.He.forEach((i,a)=>{let c=!0;a.forEachWhile(d=>{const h=this.ot(d);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(n=n.add(i))}),this.je.forEach((i,a)=>a.setReadTime(e));const o=new Xa(e,r,this.Ye,this.je,n);return this.je=Dn(),this.Je=Fs(),this.He=Fs(),this.Ye=new er(It),o}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,r)?o.Qe(r,1):o.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new fh,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new ur(It),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new ur(It),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Ye("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new fh),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function Fs(){return new er(tt.comparator)}function ph(){return new er(tt.comparator)}const n1={asc:"ASCENDING",desc:"DESCENDING"},o1={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},i1={and:"AND",or:"OR"};class s1{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function yc(t,e){return t.useProto3Json||Ha(e)?e:{value:e}}function ka(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Lf(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function a1(t,e){return ka(t,e.toTimestamp())}function hn(t){return Ut(!!t,49232),dt.fromTimestamp(function(r){const n=ro(r);return new Jt(n.seconds,n.nanos)}(t))}function ou(t,e){return fc(t,e).canonicalString()}function fc(t,e){const r=function(o){return new Yt(["projects",o.projectId,"databases",o.database])}(t).child("documents");return e===void 0?r:r.child(e)}function Mf(t){const e=Yt.fromString(t);return Ut(Uf(e),10190,{key:e.toString()}),e}function pc(t,e){return ou(t.databaseId,e.path)}function wl(t,e){const r=Mf(e);if(r.get(1)!==t.databaseId.projectId)throw new Ge(Te.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Ge(Te.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new tt(Vf(r))}function Of(t,e){return ou(t.databaseId,e)}function l1(t){const e=Mf(t);return e.length===4?Yt.emptyPath():Vf(e)}function gc(t){return new Yt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Vf(t){return Ut(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function gh(t,e,r){return{name:pc(t,e),fields:r.value.mapValue.fields}}function c1(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:it(39313,{state:h})}(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],i=function(h,y){return h.useProto3Json?(Ut(y===void 0||typeof y=="string",58123),br.fromBase64String(y||"")):(Ut(y===void 0||y instanceof Buffer||y instanceof Uint8Array,16193),br.fromUint8Array(y||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(h){const y=h.code===void 0?Te.UNKNOWN:Rf(h.code);return new Ge(y,h.message||"")}(a);r=new Nf(n,o,i,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const o=wl(t,n.document.name),i=hn(n.document.updateTime),a=n.document.createTime?hn(n.document.createTime):dt.min(),c=new Nr({mapValue:{fields:n.document.fields}}),d=Ir.newFoundDocument(o,i,a,c),h=n.targetIds||[],y=n.removedTargetIds||[];r=new la(h,y,d.key,d)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const o=wl(t,n.document),i=n.readTime?hn(n.readTime):dt.min(),a=Ir.newNoDocument(o,i),c=n.removedTargetIds||[];r=new la([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const o=wl(t,n.document),i=n.removedTargetIds||[];r=new la([],i,o,null)}else{if(!("filter"in e))return it(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:o=0,unchangedNames:i}=n,a=new XS(o,i),c=n.targetId;r=new Df(c,a)}}return r}function u1(t,e){let r;if(e instanceof vs)r={update:gh(t,e.key,e.value)};else if(e instanceof kf)r={delete:pc(t,e.key)};else if(e instanceof ho)r={update:gh(t,e.key,e.data),updateMask:b1(e.fieldMask)};else{if(!(e instanceof KS))return it(16599,{Vt:e.type});r={verify:pc(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(i,a){const c=a.transform;if(c instanceof $a)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof ls)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof cs)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Ta)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw it(20930,{transform:a.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(o,i){return i.updateTime!==void 0?{updateTime:a1(o,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:it(27497)}(t,e.precondition)),r}function d1(t,e){return t&&t.length>0?(Ut(e!==void 0,14353),t.map(r=>function(o,i){let a=o.updateTime?hn(o.updateTime):hn(i);return a.isEqual(dt.min())&&(a=hn(i)),new HS(a,o.transformResults||[])}(r,e))):[]}function h1(t,e){return{documents:[Of(t,e.path)]}}function m1(t,e){const r={structuredQuery:{}},n=e.path;let o;e.collectionGroup!==null?(o=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=Of(t,o);const i=function(h){if(h.length!==0)return Bf(Zr.create(h,"and"))}(e.filters);i&&(r.structuredQuery.where=i);const a=function(h){if(h.length!==0)return h.map(y=>function(w){return{field:Jo(w.field),direction:p1(w.dir)}}(y))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const c=yc(t,e.limit);return c!==null&&(r.structuredQuery.limit=c),e.startAt&&(r.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{ft:r,parent:o}}function y1(t){let e=l1(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let o=null;if(n>0){Ut(n===1,65062);const y=r.from[0];y.allDescendants?o=y.collectionId:e=e.child(y.collectionId)}let i=[];r.where&&(i=function(v){const w=Ff(v);return w instanceof Zr&&yf(w)?w.getFilters():[w]}(r.where));let a=[];r.orderBy&&(a=function(v){return v.map(w=>function(V){return new as(Xo(V.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(V.direction))}(w))}(r.orderBy));let c=null;r.limit&&(c=function(v){let w;return w=typeof v=="object"?v.value:v,Ha(w)?null:w}(r.limit));let d=null;r.startAt&&(d=function(v){const w=!!v.before,E=v.values||[];return new Ea(E,w)}(r.startAt));let h=null;return r.endAt&&(h=function(v){const w=!v.before,E=v.values||[];return new Ea(E,w)}(r.endAt)),DS(e,o,a,i,c,"F",d,h)}function f1(t,e){const r=function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return it(28987,{purpose:o})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function Ff(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Xo(r.unaryFilter.field);return ar.create(n,"==",{doubleValue:NaN});case"IS_NULL":const o=Xo(r.unaryFilter.field);return ar.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Xo(r.unaryFilter.field);return ar.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Xo(r.unaryFilter.field);return ar.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return it(61313);default:return it(60726)}}(t):t.fieldFilter!==void 0?function(r){return ar.create(Xo(r.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return it(58110);default:return it(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Zr.create(r.compositeFilter.filters.map(n=>Ff(n)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return it(1026)}}(r.compositeFilter.op))}(t):it(30097,{filter:t})}function p1(t){return n1[t]}function g1(t){return o1[t]}function v1(t){return i1[t]}function Jo(t){return{fieldPath:t.canonicalString()}}function Xo(t){return pr.fromServerFormat(t.fieldPath)}function Bf(t){return t instanceof ar?function(r){if(r.op==="=="){if(oh(r.value))return{unaryFilter:{field:Jo(r.field),op:"IS_NAN"}};if(nh(r.value))return{unaryFilter:{field:Jo(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(oh(r.value))return{unaryFilter:{field:Jo(r.field),op:"IS_NOT_NAN"}};if(nh(r.value))return{unaryFilter:{field:Jo(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Jo(r.field),op:g1(r.op),value:r.value}}}(t):t instanceof Zr?function(r){const n=r.getFilters().map(o=>Bf(o));return n.length===1?n[0]:{compositeFilter:{op:v1(r.op),filters:n}}}(t):it(54877,{filter:t})}function b1(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function Uf(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(e,r,n,o,i=dt.min(),a=dt.min(),c=br.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=o,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=d}withSequenceNumber(e){return new Yn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Yn(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Yn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Yn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _1{constructor(e){this.yt=e}}function S1(t){const e=y1({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?mc(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P1{constructor(){this.Cn=new w1}addToCollectionParentIndex(e,r){return this.Cn.add(r),Re.resolve()}getCollectionParents(e,r){return Re.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return Re.resolve()}deleteFieldIndex(e,r){return Re.resolve()}deleteAllFieldIndexes(e){return Re.resolve()}createTargetIndexes(e,r){return Re.resolve()}getDocumentsMatchingTarget(e,r){return Re.resolve(null)}getIndexType(e,r){return Re.resolve(0)}getFieldIndexes(e,r){return Re.resolve([])}getNextCollectionGroupToUpdate(e){return Re.resolve(null)}getMinOffset(e,r){return Re.resolve(to.min())}getMinOffsetFromCollectionGroup(e,r){return Re.resolve(to.min())}updateCollectionGroup(e,r,n){return Re.resolve()}updateIndexEntries(e,r){return Re.resolve()}}class w1{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),o=this.index[r]||new ur(Yt.comparator),i=!o.has(n);return this.index[r]=o.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),o=this.index[r];return o&&o.has(n)}getEntries(e){return(this.index[e]||new ur(Yt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vh={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},jf=41943040;class Dr{static withCacheSize(e){return new Dr(e,Dr.DEFAULT_COLLECTION_PERCENTILE,Dr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Dr.DEFAULT_COLLECTION_PERCENTILE=10,Dr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Dr.DEFAULT=new Dr(jf,Dr.DEFAULT_COLLECTION_PERCENTILE,Dr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Dr.DISABLED=new Dr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new di(0)}static cr(){return new di(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bh="LruGarbageCollector",C1=1048576;function _h([t,e],[r,n]){const o=It(t,r);return o===0?It(e,n):o}class A1{constructor(e){this.Ir=e,this.buffer=new ur(_h),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();_h(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class x1{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ye(bh,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){bi(r)?Ye(bh,"Ignoring IndexedDB error during garbage collection: ",r):await vi(r)}await this.Vr(3e5)})}}class I1{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return Re.resolve(Ga.ce);const n=new A1(r);return this.mr.forEachTarget(e,o=>n.Ar(o.sequenceNumber)).next(()=>this.mr.pr(e,o=>n.Ar(o))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Ye("LruGarbageCollector","Garbage collection skipped; disabled"),Re.resolve(vh)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Ye("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),vh):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,o,i,a,c,d,h;const y=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(v=>(v>this.params.maximumSequenceNumbersToCollect?(Ye("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),o=this.params.maximumSequenceNumbersToCollect):o=v,a=Date.now(),this.nthSequenceNumber(e,o))).next(v=>(n=v,c=Date.now(),this.removeTargets(e,n,r))).next(v=>(i=v,d=Date.now(),this.removeOrphanedDocuments(e,n))).next(v=>(h=Date.now(),Ko()<=xt.DEBUG&&Ye("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-y}ms
	Determined least recently used ${o} in `+(c-a)+`ms
	Removed ${i} targets in `+(d-c)+`ms
	Removed ${v} documents in `+(h-d)+`ms
Total Duration: ${h-y}ms`),Re.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:i,documentsRemoved:v})))}}function E1(t,e){return new I1(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $1{constructor(){this.changes=new Lo(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Ir.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Re.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T1{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k1{constructor(e,r,n,o){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=o}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(o=>(n=o,this.remoteDocumentCache.getEntry(e,r))).next(o=>(n!==null&&Ki(n.mutation,o,Vr.empty(),Jt.now()),o))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Et()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Et()){const o=xo();return this.populateOverlays(e,o,r).next(()=>this.computeViews(e,r,o,n).next(i=>{let a=Vi();return i.forEach((c,d)=>{a=a.insert(c,d.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=xo();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Et()))}populateOverlays(e,r,n){const o=[];return n.forEach(i=>{r.has(i)||o.push(i)}),this.documentOverlayCache.getOverlays(e,o).next(i=>{i.forEach((a,c)=>{r.set(a,c)})})}computeViews(e,r,n,o){let i=Dn();const a=Yi(),c=function(){return Yi()}();return r.forEach((d,h)=>{const y=n.get(h.key);o.has(h.key)&&(y===void 0||y.mutation instanceof ho)?i=i.insert(h.key,h):y!==void 0?(a.set(h.key,y.mutation.getFieldMask()),Ki(y.mutation,h,y.mutation.getFieldMask(),Jt.now())):a.set(h.key,Vr.empty())}),this.recalculateAndSaveOverlays(e,i).next(d=>(d.forEach((h,y)=>a.set(h,y)),r.forEach((h,y)=>c.set(h,new T1(y,a.get(h)??null))),c))}recalculateAndSaveOverlays(e,r){const n=Yi();let o=new er((a,c)=>a-c),i=Et();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const c of a)c.keys().forEach(d=>{const h=r.get(d);if(h===null)return;let y=n.get(d)||Vr.empty();y=c.applyToLocalView(h,y),n.set(d,y);const v=(o.get(c.batchId)||Et()).add(d);o=o.insert(c.batchId,v)})}).next(()=>{const a=[],c=o.getReverseIterator();for(;c.hasNext();){const d=c.getNext(),h=d.key,y=d.value,v=wf();y.forEach(w=>{if(!i.has(w)){const E=$f(r.get(w),n.get(w));E!==null&&v.set(w,E),i=i.add(w)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,v))}return Re.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,o){return function(a){return tt.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):vf(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,o):this.getDocumentsMatchingCollectionQuery(e,r,n,o)}getNextDocuments(e,r,n,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,o).next(i=>{const a=o-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,o-i.size):Re.resolve(xo());let c=ns,d=i;return a.next(h=>Re.forEach(h,(y,v)=>(c<v.largestBatchId&&(c=v.largestBatchId),i.get(y)?Re.resolve():this.remoteDocumentCache.getEntry(e,y).next(w=>{d=d.insert(y,w)}))).next(()=>this.populateOverlays(e,h,i)).next(()=>this.computeViews(e,d,h,Et())).next(y=>({batchId:c,changes:Pf(y)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new tt(r)).next(n=>{let o=Vi();return n.isFoundDocument()&&(o=o.insert(n.key,n)),o})}getDocumentsMatchingCollectionGroupQuery(e,r,n,o){const i=r.collectionGroup;let a=Vi();return this.indexManager.getCollectionParents(e,i).next(c=>Re.forEach(c,d=>{const h=function(v,w){return new _i(w,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)}(r,d.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,n,o).next(y=>{y.forEach((v,w)=>{a=a.insert(v,w)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,o){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,o))).next(a=>{i.forEach((d,h)=>{const y=h.getKey();a.get(y)===null&&(a=a.insert(y,Ir.newInvalidDocument(y)))});let c=Vi();return a.forEach((d,h)=>{const y=i.get(d);y!==void 0&&Ki(y.mutation,h,Vr.empty(),Jt.now()),Ka(r,h)&&(c=c.insert(d,h))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R1{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return Re.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(o){return{id:o.id,version:o.version,createTime:hn(o.createTime)}}(r)),Re.resolve()}getNamedQuery(e,r){return Re.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(o){return{name:o.name,query:S1(o.bundledQuery),readTime:hn(o.readTime)}}(r)),Re.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D1{constructor(){this.overlays=new er(tt.comparator),this.qr=new Map}getOverlay(e,r){return Re.resolve(this.overlays.get(r))}getOverlays(e,r){const n=xo();return Re.forEach(r,o=>this.getOverlay(e,o).next(i=>{i!==null&&n.set(o,i)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((o,i)=>{this.St(e,r,i)}),Re.resolve()}removeOverlaysForBatchId(e,r,n){const o=this.qr.get(n);return o!==void 0&&(o.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(n)),Re.resolve()}getOverlaysForCollection(e,r,n){const o=xo(),i=r.length+1,a=new tt(r.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const d=c.getNext().value,h=d.getKey();if(!r.isPrefixOf(h.path))break;h.path.length===i&&d.largestBatchId>n&&o.set(d.getKey(),d)}return Re.resolve(o)}getOverlaysForCollectionGroup(e,r,n,o){let i=new er((h,y)=>h-y);const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===r&&h.largestBatchId>n){let y=i.get(h.largestBatchId);y===null&&(y=xo(),i=i.insert(h.largestBatchId,y)),y.set(h.getKey(),h)}}const c=xo(),d=i.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((h,y)=>c.set(h,y)),!(c.size()>=o)););return Re.resolve(c)}St(e,r,n){const o=this.overlays.get(n.key);if(o!==null){const a=this.qr.get(o.largestBatchId).delete(n.key);this.qr.set(o.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new JS(r,n));let i=this.qr.get(r);i===void 0&&(i=Et(),this.qr.set(r,i)),this.qr.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N1{constructor(){this.sessionToken=br.EMPTY_BYTE_STRING}getSessionToken(e){return Re.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Re.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(){this.Qr=new ur(mr.$r),this.Ur=new ur(mr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new mr(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new mr(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new tt(new Yt([])),n=new mr(r,e),o=new mr(r,e+1),i=[];return this.Ur.forEachInRange([n,o],a=>{this.Gr(a),i.push(a.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new tt(new Yt([])),n=new mr(r,e),o=new mr(r,e+1);let i=Et();return this.Ur.forEachInRange([n,o],a=>{i=i.add(a.key)}),i}containsKey(e){const r=new mr(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class mr{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return tt.comparator(e.key,r.key)||It(e.Yr,r.Yr)}static Kr(e,r){return It(e.Yr,r.Yr)||tt.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L1{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new ur(mr.$r)}checkEmpty(e){return Re.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,o){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new QS(i,r,n,o);this.mutationQueue.push(a);for(const c of o)this.Zr=this.Zr.add(new mr(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return Re.resolve(a)}lookupMutationBatch(e,r){return Re.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,o=this.ei(n),i=o<0?0:o;return Re.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Re.resolve(this.mutationQueue.length===0?Kc:this.tr-1)}getAllMutationBatches(e){return Re.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new mr(r,0),o=new mr(r,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,o],a=>{const c=this.Xr(a.Yr);i.push(c)}),Re.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new ur(It);return r.forEach(o=>{const i=new mr(o,0),a=new mr(o,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],c=>{n=n.add(c.Yr)})}),Re.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,o=n.length+1;let i=n;tt.isDocumentKey(i)||(i=i.child(""));const a=new mr(new tt(i),0);let c=new ur(It);return this.Zr.forEachWhile(d=>{const h=d.key.path;return!!n.isPrefixOf(h)&&(h.length===o&&(c=c.add(d.Yr)),!0)},a),Re.resolve(this.ti(c))}ti(e){const r=[];return e.forEach(n=>{const o=this.Xr(n);o!==null&&r.push(o)}),r}removeMutationBatch(e,r){Ut(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return Re.forEach(r.mutations,o=>{const i=new mr(o.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new mr(r,0),o=this.Zr.firstAfterOrEqual(n);return Re.resolve(r.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,Re.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M1{constructor(e){this.ri=e,this.docs=function(){return new er(tt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,o=this.docs.get(n),i=o?o.size:0,a=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Re.resolve(n?n.document.mutableCopy():Ir.newInvalidDocument(r))}getEntries(e,r){let n=Dn();return r.forEach(o=>{const i=this.docs.get(o);n=n.insert(o,i?i.document.mutableCopy():Ir.newInvalidDocument(o))}),Re.resolve(n)}getDocumentsMatchingQuery(e,r,n,o){let i=Dn();const a=r.path,c=new tt(a.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(c);for(;d.hasNext();){const{key:h,value:{document:y}}=d.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||dS(uS(y),n)<=0||(o.has(y.key)||Ka(r,y))&&(i=i.insert(y.key,y.mutableCopy()))}return Re.resolve(i)}getAllFromCollectionGroup(e,r,n,o){it(9500)}ii(e,r){return Re.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new O1(this)}getSize(e){return Re.resolve(this.size)}}class O1 extends $1{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,o)=>{o.isValidDocument()?r.push(this.Nr.addEntry(e,o)):this.Nr.removeEntry(n)}),Re.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1{constructor(e){this.persistence=e,this.si=new Lo(r=>Xc(r),Zc),this.lastRemoteSnapshotVersion=dt.min(),this.highestTargetId=0,this.oi=0,this._i=new iu,this.targetCount=0,this.ai=di.ur()}forEachTarget(e,r){return this.si.forEach((n,o)=>r(o)),Re.resolve()}getLastRemoteSnapshotVersion(e){return Re.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Re.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Re.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),Re.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new di(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,Re.resolve()}updateTargetData(e,r){return this.Pr(r),Re.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,Re.resolve()}removeTargets(e,r,n){let o=0;const i=[];return this.si.forEach((a,c)=>{c.sequenceNumber<=r&&n.get(c.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),o++)}),Re.waitFor(i).next(()=>o)}getTargetCount(e){return Re.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return Re.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),Re.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const o=this.persistence.referenceDelegate,i=[];return o&&r.forEach(a=>{i.push(o.markPotentiallyOrphaned(e,a))}),Re.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),Re.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return Re.resolve(n)}containsKey(e,r){return Re.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf{constructor(e,r){this.ui={},this.overlays={},this.ci=new Ga(0),this.li=!1,this.li=!0,this.hi=new N1,this.referenceDelegate=e(this),this.Pi=new V1(this),this.indexManager=new P1,this.remoteDocumentCache=function(o){return new M1(o)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new _1(r),this.Ii=new R1(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new D1,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new L1(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Ye("MemoryPersistence","Starting transaction:",e);const o=new F1(this.ci.next());return this.referenceDelegate.Ei(),n(o).next(i=>this.referenceDelegate.di(o).next(()=>i)).toPromise().then(i=>(o.raiseOnCommittedEvent(),i))}Ai(e,r){return Re.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class F1 extends mS{constructor(e){super(),this.currentSequenceNumber=e}}class su{constructor(e){this.persistence=e,this.Ri=new iu,this.Vi=null}static mi(e){return new su(e)}get fi(){if(this.Vi)return this.Vi;throw it(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),Re.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),Re.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),Re.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(o=>this.fi.add(o.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(o=>{o.forEach(i=>this.fi.add(i.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Re.forEach(this.fi,n=>{const o=tt.fromPath(n);return this.gi(e,o).next(i=>{i||r.removeEntry(o,dt.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return Re.or([()=>Re.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class Ra{constructor(e,r){this.persistence=e,this.pi=new Lo(n=>pS(n.path),(n,o)=>n.isEqual(o)),this.garbageCollector=E1(this,r)}static mi(e,r){return new Ra(e,r)}Ei(){}di(e){return Re.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(o=>n+o))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return Re.forEach(this.pi,(n,o)=>this.br(e,n,o).next(i=>i?Re.resolve():r(o)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const o=this.persistence.getRemoteDocumentCache(),i=o.newChangeBuffer();return o.ii(e,a=>this.br(e,a,r).next(c=>{c||(n++,i.removeEntry(a,dt.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),Re.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Re.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Re.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),Re.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=ia(e.data.value)),r}br(e,r,n){return Re.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const o=this.pi.get(r);return Re.resolve(o!==void 0&&o>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class au{constructor(e,r,n,o){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=o}static As(e,r){let n=Et(),o=Et();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:o=o.add(i.doc.key)}return new au(e,r.fromCache,n,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B1{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U1{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return kv()?8:yS($r())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,o){const i={result:null};return this.ys(e,r).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.ws(e,r,o,n).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new B1;return this.Ss(e,r,a).next(c=>{if(i.result=c,this.Vs)return this.bs(e,r,a,c.size)})}).next(()=>i.result)}bs(e,r,n,o){return n.documentReadCount<this.fs?(Ko()<=xt.DEBUG&&Ye("QueryEngine","SDK will not create cache indexes for query:",Qo(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Re.resolve()):(Ko()<=xt.DEBUG&&Ye("QueryEngine","Query:",Qo(r),"scans",n.documentReadCount,"local documents and returns",o,"documents as results."),n.documentReadCount>this.gs*o?(Ko()<=xt.DEBUG&&Ye("QueryEngine","The SDK decides to create cache indexes for query:",Qo(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,un(r))):Re.resolve())}ys(e,r){if(lh(r))return Re.resolve(null);let n=un(r);return this.indexManager.getIndexType(e,n).next(o=>o===0?null:(r.limit!==null&&o===1&&(r=mc(r,null,"F"),n=un(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const a=Et(...i);return this.ps.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,n).next(d=>{const h=this.Ds(r,c);return this.Cs(r,h,a,d.readTime)?this.ys(e,mc(r,null,"F")):this.vs(e,h,r,d)}))})))}ws(e,r,n,o){return lh(r)||o.isEqual(dt.min())?Re.resolve(null):this.ps.getDocuments(e,n).next(i=>{const a=this.Ds(r,i);return this.Cs(r,a,n,o)?Re.resolve(null):(Ko()<=xt.DEBUG&&Ye("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Qo(r)),this.vs(e,a,r,cS(o,ns)).next(c=>c))})}Ds(e,r){let n=new ur(_f(e));return r.forEach((o,i)=>{Ka(e,i)&&(n=n.add(i))}),n}Cs(e,r,n,o){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(o)>0)}Ss(e,r,n){return Ko()<=xt.DEBUG&&Ye("QueryEngine","Using full collection scan to execute query:",Qo(r)),this.ps.getDocumentsMatchingQuery(e,r,to.min(),n)}vs(e,r,n,o){return this.ps.getDocumentsMatchingQuery(e,n,o).next(i=>(r.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lu="LocalStore",j1=3e8;class z1{constructor(e,r,n,o){this.persistence=e,this.Fs=r,this.serializer=o,this.Ms=new er(It),this.xs=new Lo(i=>Xc(i),Zc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new k1(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function q1(t,e,r,n){return new z1(t,e,r,n)}async function qf(t,e){const r=ht(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let o;return r.mutationQueue.getAllMutationBatches(n).next(i=>(o=i,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(i=>{const a=[],c=[];let d=Et();for(const h of o){a.push(h.batchId);for(const y of h.mutations)d=d.add(y.key)}for(const h of i){c.push(h.batchId);for(const y of h.mutations)d=d.add(y.key)}return r.localDocuments.getDocuments(n,d).next(h=>({Ls:h,removedBatchIds:a,addedBatchIds:c}))})})}function G1(t,e){const r=ht(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const o=e.batch.keys(),i=r.Ns.newChangeBuffer({trackRemovals:!0});return function(c,d,h,y){const v=h.batch,w=v.keys();let E=Re.resolve();return w.forEach(V=>{E=E.next(()=>y.getEntry(d,V)).next(N=>{const x=h.docVersions.get(V);Ut(x!==null,48541),N.version.compareTo(x)<0&&(v.applyToRemoteDocument(N,h),N.isValidDocument()&&(N.setReadTime(h.commitVersion),y.addEntry(N)))})}),E.next(()=>c.mutationQueue.removeMutationBatch(d,v))}(r,n,e,i).next(()=>i.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,o,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(c){let d=Et();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(d=d.add(c.batch.mutations[h].key));return d}(e))).next(()=>r.localDocuments.getDocuments(n,o))})}function Gf(t){const e=ht(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function H1(t,e){const r=ht(t),n=e.snapshotVersion;let o=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=r.Ns.newChangeBuffer({trackRemovals:!0});o=r.Ms;const c=[];e.targetChanges.forEach((y,v)=>{const w=o.get(v);if(!w)return;c.push(r.Pi.removeMatchingKeys(i,y.removedDocuments,v).next(()=>r.Pi.addMatchingKeys(i,y.addedDocuments,v)));let E=w.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(v)!==null?E=E.withResumeToken(br.EMPTY_BYTE_STRING,dt.min()).withLastLimboFreeSnapshotVersion(dt.min()):y.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(y.resumeToken,n)),o=o.insert(v,E),function(N,x,k){return N.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-N.snapshotVersion.toMicroseconds()>=j1?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(w,E,y)&&c.push(r.Pi.updateTargetData(i,E))});let d=Dn(),h=Et();if(e.documentUpdates.forEach(y=>{e.resolvedLimboDocuments.has(y)&&c.push(r.persistence.referenceDelegate.updateLimboDocument(i,y))}),c.push(W1(i,a,e.documentUpdates).next(y=>{d=y.ks,h=y.qs})),!n.isEqual(dt.min())){const y=r.Pi.getLastRemoteSnapshotVersion(i).next(v=>r.Pi.setTargetsMetadata(i,i.currentSequenceNumber,n));c.push(y)}return Re.waitFor(c).next(()=>a.apply(i)).next(()=>r.localDocuments.getLocalViewOfDocuments(i,d,h)).next(()=>d)}).then(i=>(r.Ms=o,i))}function W1(t,e,r){let n=Et(),o=Et();return r.forEach(i=>n=n.add(i)),e.getEntries(t,n).next(i=>{let a=Dn();return r.forEach((c,d)=>{const h=i.get(c);d.isFoundDocument()!==h.isFoundDocument()&&(o=o.add(c)),d.isNoDocument()&&d.version.isEqual(dt.min())?(e.removeEntry(c,d.readTime),a=a.insert(c,d)):!h.isValidDocument()||d.version.compareTo(h.version)>0||d.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(d),a=a.insert(c,d)):Ye(lu,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",d.version)}),{ks:a,qs:o}})}function Y1(t,e){const r=ht(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Kc),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function K1(t,e){const r=ht(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let o;return r.Pi.getTargetData(n,e).next(i=>i?(o=i,Re.resolve(o)):r.Pi.allocateTargetId(n).next(a=>(o=new Yn(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,o).next(()=>o))))}).then(n=>{const o=r.Ms.get(n.targetId);return(o===null||n.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function vc(t,e,r){const n=ht(t),o=n.Ms.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,a=>n.persistence.referenceDelegate.removeTarget(a,o))}catch(a){if(!bi(a))throw a;Ye(lu,`Failed to update sequence numbers for target ${e}: ${a}`)}n.Ms=n.Ms.remove(e),n.xs.delete(o.target)}function Sh(t,e,r){const n=ht(t);let o=dt.min(),i=Et();return n.persistence.runTransaction("Execute query","readwrite",a=>function(d,h,y){const v=ht(d),w=v.xs.get(y);return w!==void 0?Re.resolve(v.Ms.get(w)):v.Pi.getTargetData(h,y)}(n,a,un(e)).next(c=>{if(c)return o=c.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(a,c.targetId).next(d=>{i=d})}).next(()=>n.Fs.getDocumentsMatchingQuery(a,e,r?o:dt.min(),r?i:Et())).next(c=>(Q1(n,LS(e),c),{documents:c,Qs:i})))}function Q1(t,e,r){let n=t.Os.get(e)||dt.min();r.forEach((o,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),t.Os.set(e,n)}class Ph{constructor(){this.activeTargetIds=US()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class J1{constructor(){this.Mo=new Ph,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Ph,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X1{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wh="ConnectivityMonitor";class Ch{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ye(wh,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ye(wh,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bs=null;function bc(){return Bs===null?Bs=function(){return 268435456+Math.round(2147483648*Math.random())}():Bs++,"0x"+Bs.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cl="RestConnection",Z1={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class eP{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${o}`,this.Wo=this.databaseId.database===xa?`project_id=${n}`:`project_id=${n}&database_id=${o}`}Go(e,r,n,o,i){const a=bc(),c=this.zo(e,r.toUriEncodedString());Ye(Cl,`Sending RPC '${e}' ${a}:`,c,n);const d={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(d,o,i);const{host:h}=new URL(c),y=yi(h);return this.Jo(e,c,d,n,y).then(v=>(Ye(Cl,`Received RPC '${e}' ${a}: `,v),v),v=>{throw ai(Cl,`RPC '${e}' ${a} failed with error: `,v,"url: ",c,"request:",n),v})}Ho(e,r,n,o,i,a){return this.Go(e,r,n,o,i)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+gi}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,i)=>e[i]=o),n&&n.headers.forEach((o,i)=>e[i]=o)}zo(e,r){const n=Z1[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cr="WebChannelConnection";class rP extends eP{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,o,i){const a=bc();return new Promise((c,d)=>{const h=new Hy;h.setWithCredentials(!0),h.listenOnce(Wy.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case oa.NO_ERROR:const v=h.getResponseJson();Ye(Cr,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(v)),c(v);break;case oa.TIMEOUT:Ye(Cr,`RPC '${e}' ${a} timed out`),d(new Ge(Te.DEADLINE_EXCEEDED,"Request time out"));break;case oa.HTTP_ERROR:const w=h.getStatus();if(Ye(Cr,`RPC '${e}' ${a} failed with status:`,w,"response text:",h.getResponseText()),w>0){let E=h.getResponseJson();Array.isArray(E)&&(E=E[0]);const V=E?.error;if(V&&V.status&&V.message){const N=function(k){const re=k.toLowerCase().replace(/_/g,"-");return Object.values(Te).indexOf(re)>=0?re:Te.UNKNOWN}(V.status);d(new Ge(N,V.message))}else d(new Ge(Te.UNKNOWN,"Server responded with status "+h.getStatus()))}else d(new Ge(Te.UNAVAILABLE,"Connection failed."));break;default:it(9055,{l_:e,streamId:a,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{Ye(Cr,`RPC '${e}' ${a} completed.`)}});const y=JSON.stringify(o);Ye(Cr,`RPC '${e}' ${a} sending request:`,o),h.send(r,"POST",y,n,15)})}T_(e,r,n){const o=bc(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Qy(),c=Ky(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(d.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(d.useFetchStreams=!0),this.jo(d.initMessageHeaders,r,n),d.encodeInitMessageHeaders=!0;const y=i.join("");Ye(Cr,`Creating RPC '${e}' stream ${o}: ${y}`,d);const v=a.createWebChannel(y,d);this.I_(v);let w=!1,E=!1;const V=new tP({Yo:x=>{E?Ye(Cr,`Not sending because RPC '${e}' stream ${o} is closed:`,x):(w||(Ye(Cr,`Opening RPC '${e}' stream ${o} transport.`),v.open(),w=!0),Ye(Cr,`RPC '${e}' stream ${o} sending:`,x),v.send(x))},Zo:()=>v.close()}),N=(x,k,re)=>{x.listen(k,ae=>{try{re(ae)}catch(F){setTimeout(()=>{throw F},0)}})};return N(v,Oi.EventType.OPEN,()=>{E||(Ye(Cr,`RPC '${e}' stream ${o} transport opened.`),V.o_())}),N(v,Oi.EventType.CLOSE,()=>{E||(E=!0,Ye(Cr,`RPC '${e}' stream ${o} transport closed`),V.a_(),this.E_(v))}),N(v,Oi.EventType.ERROR,x=>{E||(E=!0,ai(Cr,`RPC '${e}' stream ${o} transport errored. Name:`,x.name,"Message:",x.message),V.a_(new Ge(Te.UNAVAILABLE,"The operation could not be completed")))}),N(v,Oi.EventType.MESSAGE,x=>{if(!E){const k=x.data[0];Ut(!!k,16349);const re=k,ae=re?.error||re[0]?.error;if(ae){Ye(Cr,`RPC '${e}' stream ${o} received error:`,ae);const F=ae.status;let Y=function(g){const p=sr[g];if(p!==void 0)return Rf(p)}(F),U=ae.message;Y===void 0&&(Y=Te.INTERNAL,U="Unknown error status: "+F+" with message "+ae.message),E=!0,V.a_(new Ge(Y,U)),v.close()}else Ye(Cr,`RPC '${e}' stream ${o} received:`,k),V.u_(k)}}),N(c,Yy.STAT_EVENT,x=>{x.stat===sc.PROXY?Ye(Cr,`RPC '${e}' stream ${o} detected buffering proxy`):x.stat===sc.NOPROXY&&Ye(Cr,`RPC '${e}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{V.__()},0),V}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function Al(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Za(t){return new s1(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hf{constructor(e,r,n=1e3,o=1.5,i=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=o,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),o=Math.max(0,r-n);o>0&&Ye("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,o,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ah="PersistentStream";class Wf{constructor(e,r,n,o,i,a,c,d){this.Mi=e,this.S_=n,this.b_=o,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=d,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Hf(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===Te.RESOURCE_EXHAUSTED?(kn(r.toString()),kn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===Te.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,o])=>{this.D_===r&&this.G_(n,o)},n=>{e(()=>{const o=new Ge(Te.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(o)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(o=>{n(()=>this.z_(o))}),this.stream.onMessage(o=>{n(()=>++this.F_==1?this.J_(o):this.onNext(o))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Ye(Ah,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(Ye(Ah,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class nP extends Wf{constructor(e,r,n,o,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,o,a),this.serializer=i}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=c1(this.serializer,e),n=function(i){if(!("targetChange"in i))return dt.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?dt.min():a.readTime?hn(a.readTime):dt.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=gc(this.serializer),r.addTarget=function(i,a){let c;const d=a.target;if(c=dc(d)?{documents:h1(i,d)}:{query:m1(i,d).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=Lf(i,a.resumeToken);const h=yc(i,a.expectedCount);h!==null&&(c.expectedCount=h)}else if(a.snapshotVersion.compareTo(dt.min())>0){c.readTime=ka(i,a.snapshotVersion.toTimestamp());const h=yc(i,a.expectedCount);h!==null&&(c.expectedCount=h)}return c}(this.serializer,e);const n=f1(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=gc(this.serializer),r.removeTarget=e,this.q_(r)}}class oP extends Wf{constructor(e,r,n,o,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,o,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Ut(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ut(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ut(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=d1(e.writeResults,e.commitTime),n=hn(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=gc(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>u1(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{}class sP extends iP{constructor(e,r,n,o){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new Ge(Te.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Go(e,fc(r,n),o,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===Te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ge(Te.UNKNOWN,i.toString())})}Ho(e,r,n,o,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Ho(e,fc(r,n),o,a,c,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ge(Te.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class aP{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(kn(r),this.aa=!1):Ye("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Do="RemoteStore";class lP{constructor(e,r,n,o,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(a=>{n.enqueueAndForget(async()=>{Mo(this)&&(Ye(Do,"Restarting streams for network reachability change."),await async function(d){const h=ht(d);h.Ea.add(4),await _s(h),h.Ra.set("Unknown"),h.Ea.delete(4),await el(h)}(this))})}),this.Ra=new aP(n,o)}}async function el(t){if(Mo(t))for(const e of t.da)await e(!0)}async function _s(t){for(const e of t.da)await e(!1)}function Yf(t,e){const r=ht(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),hu(r)?du(r):Si(r).O_()&&uu(r,e))}function cu(t,e){const r=ht(t),n=Si(r);r.Ia.delete(e),n.O_()&&Kf(r,e),r.Ia.size===0&&(n.O_()?n.L_():Mo(r)&&r.Ra.set("Unknown"))}function uu(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(dt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Si(t).Y_(e)}function Kf(t,e){t.Va.Ue(e),Si(t).Z_(e)}function du(t){t.Va=new r1({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Si(t).start(),t.Ra.ua()}function hu(t){return Mo(t)&&!Si(t).x_()&&t.Ia.size>0}function Mo(t){return ht(t).Ea.size===0}function Qf(t){t.Va=void 0}async function cP(t){t.Ra.set("Online")}async function uP(t){t.Ia.forEach((e,r)=>{uu(t,e)})}async function dP(t,e){Qf(t),hu(t)?(t.Ra.ha(e),du(t)):t.Ra.set("Unknown")}async function hP(t,e,r){if(t.Ra.set("Online"),e instanceof Nf&&e.state===2&&e.cause)try{await async function(o,i){const a=i.cause;for(const c of i.targetIds)o.Ia.has(c)&&(await o.remoteSyncer.rejectListen(c,a),o.Ia.delete(c),o.Va.removeTarget(c))}(t,e)}catch(n){Ye(Do,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Da(t,n)}else if(e instanceof la?t.Va.Ze(e):e instanceof Df?t.Va.st(e):t.Va.tt(e),!r.isEqual(dt.min()))try{const n=await Gf(t.localStore);r.compareTo(n)>=0&&await function(i,a){const c=i.Va.Tt(a);return c.targetChanges.forEach((d,h)=>{if(d.resumeToken.approximateByteSize()>0){const y=i.Ia.get(h);y&&i.Ia.set(h,y.withResumeToken(d.resumeToken,a))}}),c.targetMismatches.forEach((d,h)=>{const y=i.Ia.get(d);if(!y)return;i.Ia.set(d,y.withResumeToken(br.EMPTY_BYTE_STRING,y.snapshotVersion)),Kf(i,d);const v=new Yn(y.target,d,h,y.sequenceNumber);uu(i,v)}),i.remoteSyncer.applyRemoteEvent(c)}(t,r)}catch(n){Ye(Do,"Failed to raise snapshot:",n),await Da(t,n)}}async function Da(t,e,r){if(!bi(e))throw e;t.Ea.add(1),await _s(t),t.Ra.set("Offline"),r||(r=()=>Gf(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ye(Do,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await el(t)})}function Jf(t,e){return e().catch(r=>Da(t,r,e))}async function tl(t){const e=ht(t),r=io(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Kc;for(;mP(e);)try{const o=await Y1(e.localStore,n);if(o===null){e.Ta.length===0&&r.L_();break}n=o.batchId,yP(e,o)}catch(o){await Da(e,o)}Xf(e)&&Zf(e)}function mP(t){return Mo(t)&&t.Ta.length<10}function yP(t,e){t.Ta.push(e);const r=io(t);r.O_()&&r.X_&&r.ea(e.mutations)}function Xf(t){return Mo(t)&&!io(t).x_()&&t.Ta.length>0}function Zf(t){io(t).start()}async function fP(t){io(t).ra()}async function pP(t){const e=io(t);for(const r of t.Ta)e.ea(r.mutations)}async function gP(t,e,r){const n=t.Ta.shift(),o=ru.from(n,e,r);await Jf(t,()=>t.remoteSyncer.applySuccessfulWrite(o)),await tl(t)}async function vP(t,e){e&&io(t).X_&&await async function(n,o){if(function(a){return ZS(a)&&a!==Te.ABORTED}(o.code)){const i=n.Ta.shift();io(n).B_(),await Jf(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,o)),await tl(n)}}(t,e),Xf(t)&&Zf(t)}async function xh(t,e){const r=ht(t);r.asyncQueue.verifyOperationInProgress(),Ye(Do,"RemoteStore received new credentials");const n=Mo(r);r.Ea.add(3),await _s(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await el(r)}async function bP(t,e){const r=ht(t);e?(r.Ea.delete(2),await el(r)):e||(r.Ea.add(2),await _s(r),r.Ra.set("Unknown"))}function Si(t){return t.ma||(t.ma=function(r,n,o){const i=ht(r);return i.sa(),new nP(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,o)}(t.datastore,t.asyncQueue,{Xo:cP.bind(null,t),t_:uP.bind(null,t),r_:dP.bind(null,t),H_:hP.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),hu(t)?du(t):t.Ra.set("Unknown")):(await t.ma.stop(),Qf(t))})),t.ma}function io(t){return t.fa||(t.fa=function(r,n,o){const i=ht(r);return i.sa(),new oP(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,o)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:fP.bind(null,t),r_:vP.bind(null,t),ta:pP.bind(null,t),na:gP.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await tl(t)):(await t.fa.stop(),t.Ta.length>0&&(Ye(Do,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu{constructor(e,r,n,o,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=o,this.removalCallback=i,this.deferred=new En,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,o,i){const a=Date.now()+n,c=new mu(e,r,a,o,i);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ge(Te.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function yu(t,e){if(kn("AsyncQueue",`${e}: ${t}`),bi(t))return new Ge(Te.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{static emptySet(e){return new ni(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||tt.comparator(r.key,n.key):(r,n)=>tt.comparator(r.key,n.key),this.keyedMap=Vi(),this.sortedSet=new er(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof ni)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const o=r.getNext().key,i=n.getNext().key;if(!o.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new ni;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ih{constructor(){this.ga=new er(tt.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):it(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class hi{constructor(e,r,n,o,i,a,c,d,h){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=o,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=d,this.hasCachedResults=h}static fromInitialDocuments(e,r,n,o,i){const a=[];return r.forEach(c=>{a.push({type:0,doc:c})}),new hi(e,r,ni.emptySet(r),a,n,o,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ya(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let o=0;o<r.length;o++)if(r[o].type!==n[o].type||!r[o].doc.isEqual(n[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _P{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class SP{constructor(){this.queries=Eh(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const o=ht(r),i=o.queries;o.queries=Eh(),i.forEach((a,c)=>{for(const d of c.Sa)d.onError(n)})})(this,new Ge(Te.ABORTED,"Firestore shutting down"))}}function Eh(){return new Lo(t=>bf(t),Ya)}async function ep(t,e){const r=ht(t);let n=3;const o=e.query;let i=r.queries.get(o);i?!i.ba()&&e.Da()&&(n=2):(i=new _P,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await r.onListen(o,!0);break;case 1:i.wa=await r.onListen(o,!1);break;case 2:await r.onFirstRemoteStoreListen(o)}}catch(a){const c=yu(a,`Initialization of query '${Qo(e.query)}' failed`);return void e.onError(c)}r.queries.set(o,i),i.Sa.push(e),e.va(r.onlineState),i.wa&&e.Fa(i.wa)&&fu(r)}async function tp(t,e){const r=ht(t),n=e.query;let o=3;const i=r.queries.get(n);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?o=e.Da()?0:1:!i.ba()&&e.Da()&&(o=2))}switch(o){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function PP(t,e){const r=ht(t);let n=!1;for(const o of e){const i=o.query,a=r.queries.get(i);if(a){for(const c of a.Sa)c.Fa(o)&&(n=!0);a.wa=o}}n&&fu(r)}function wP(t,e,r){const n=ht(t),o=n.queries.get(e);if(o)for(const i of o.Sa)i.onError(r);n.queries.delete(e)}function fu(t){t.Ca.forEach(e=>{e.next()})}var _c,$h;($h=_c||(_c={})).Ma="default",$h.Cache="cache";class rp{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const o of e.docChanges)o.type!==3&&n.push(o);e=new hi(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=hi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==_c.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class np{constructor(e){this.key=e}}class op{constructor(e){this.key=e}}class CP{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Et(),this.mutatedKeys=Et(),this.eu=_f(e),this.tu=new ni(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new Ih,o=r?r.tu:this.tu;let i=r?r.mutatedKeys:this.mutatedKeys,a=o,c=!1;const d=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,h=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal((y,v)=>{const w=o.get(y),E=Ka(this.query,v)?v:null,V=!!w&&this.mutatedKeys.has(w.key),N=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let x=!1;w&&E?w.data.isEqual(E.data)?V!==N&&(n.track({type:3,doc:E}),x=!0):this.su(w,E)||(n.track({type:2,doc:E}),x=!0,(d&&this.eu(E,d)>0||h&&this.eu(E,h)<0)&&(c=!0)):!w&&E?(n.track({type:0,doc:E}),x=!0):w&&!E&&(n.track({type:1,doc:w}),x=!0,(d||h)&&(c=!0)),x&&(E?(a=a.add(E),i=N?i.add(y):i.delete(y)):(a=a.delete(y),i=i.delete(y)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const y=this.query.limitType==="F"?a.last():a.first();a=a.delete(y.key),i=i.delete(y.key),n.track({type:1,doc:y})}return{tu:a,iu:n,Cs:c,mutatedKeys:i}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,o){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((y,v)=>function(E,V){const N=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return it(20277,{Rt:x})}};return N(E)-N(V)}(y.type,v.type)||this.eu(y.doc,v.doc)),this.ou(n),o=o??!1;const c=r&&!o?this._u():[],d=this.Xa.size===0&&this.current&&!o?1:0,h=d!==this.Za;return this.Za=d,a.length!==0||h?{snapshot:new hi(this.query,e.tu,i,a,e.mutatedKeys,d===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Ih,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Et(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new op(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new np(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=Et();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return hi.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const pu="SyncEngine";class AP{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class xP{constructor(e){this.key=e,this.hu=!1}}class IP{constructor(e,r,n,o,i,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=o,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Lo(c=>bf(c),Ya),this.Iu=new Map,this.Eu=new Set,this.du=new er(tt.comparator),this.Au=new Map,this.Ru=new iu,this.Vu={},this.mu=new Map,this.fu=di.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function EP(t,e,r=!0){const n=up(t);let o;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),o=i.view.lu()):o=await ip(n,e,r,!0),o}async function $P(t,e){const r=up(t);await ip(r,e,!0,!1)}async function ip(t,e,r,n){const o=await K1(t.localStore,un(e)),i=o.targetId,a=t.sharedClientState.addLocalQueryTarget(i,r);let c;return n&&(c=await TP(t,e,i,a==="current",o.resumeToken)),t.isPrimaryClient&&r&&Yf(t.remoteStore,o),c}async function TP(t,e,r,n,o){t.pu=(v,w,E)=>async function(N,x,k,re){let ae=x.view.ru(k);ae.Cs&&(ae=await Sh(N.localStore,x.query,!1).then(({documents:b})=>x.view.ru(b,ae)));const F=re&&re.targetChanges.get(x.targetId),Y=re&&re.targetMismatches.get(x.targetId)!=null,U=x.view.applyChanges(ae,N.isPrimaryClient,F,Y);return kh(N,x.targetId,U.au),U.snapshot}(t,v,w,E);const i=await Sh(t.localStore,e,!0),a=new CP(e,i.Qs),c=a.ru(i.documents),d=bs.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",o),h=a.applyChanges(c,t.isPrimaryClient,d);kh(t,r,h.au);const y=new AP(e,r,a);return t.Tu.set(e,y),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),h.snapshot}async function kP(t,e,r){const n=ht(t),o=n.Tu.get(e),i=n.Iu.get(o.targetId);if(i.length>1)return n.Iu.set(o.targetId,i.filter(a=>!Ya(a,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(o.targetId),n.sharedClientState.isActiveQueryTarget(o.targetId)||await vc(n.localStore,o.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(o.targetId),r&&cu(n.remoteStore,o.targetId),Sc(n,o.targetId)}).catch(vi)):(Sc(n,o.targetId),await vc(n.localStore,o.targetId,!0))}async function RP(t,e){const r=ht(t),n=r.Tu.get(e),o=r.Iu.get(n.targetId);r.isPrimaryClient&&o.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),cu(r.remoteStore,n.targetId))}async function DP(t,e,r){const n=BP(t);try{const o=await function(a,c){const d=ht(a),h=Jt.now(),y=c.reduce((E,V)=>E.add(V.key),Et());let v,w;return d.persistence.runTransaction("Locally write mutations","readwrite",E=>{let V=Dn(),N=Et();return d.Ns.getEntries(E,y).next(x=>{V=x,V.forEach((k,re)=>{re.isValidDocument()||(N=N.add(k))})}).next(()=>d.localDocuments.getOverlayedDocuments(E,V)).next(x=>{v=x;const k=[];for(const re of c){const ae=YS(re,v.get(re.key).overlayedDocument);ae!=null&&k.push(new ho(re.key,ae,df(ae.value.mapValue),dn.exists(!0)))}return d.mutationQueue.addMutationBatch(E,h,k,c)}).next(x=>{w=x;const k=x.applyToLocalDocumentSet(v,N);return d.documentOverlayCache.saveOverlays(E,x.batchId,k)})}).then(()=>({batchId:w.batchId,changes:Pf(v)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(o.batchId),function(a,c,d){let h=a.Vu[a.currentUser.toKey()];h||(h=new er(It)),h=h.insert(c,d),a.Vu[a.currentUser.toKey()]=h}(n,o.batchId,r),await Ss(n,o.changes),await tl(n.remoteStore)}catch(o){const i=yu(o,"Failed to persist write");r.reject(i)}}async function sp(t,e){const r=ht(t);try{const n=await H1(r.localStore,e);e.targetChanges.forEach((o,i)=>{const a=r.Au.get(i);a&&(Ut(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?a.hu=!0:o.modifiedDocuments.size>0?Ut(a.hu,14607):o.removedDocuments.size>0&&(Ut(a.hu,42227),a.hu=!1))}),await Ss(r,n,e)}catch(n){await vi(n)}}function Th(t,e,r){const n=ht(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const o=[];n.Tu.forEach((i,a)=>{const c=a.view.va(e);c.snapshot&&o.push(c.snapshot)}),function(a,c){const d=ht(a);d.onlineState=c;let h=!1;d.queries.forEach((y,v)=>{for(const w of v.Sa)w.va(c)&&(h=!0)}),h&&fu(d)}(n.eventManager,e),o.length&&n.Pu.H_(o),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function NP(t,e,r){const n=ht(t);n.sharedClientState.updateQueryState(e,"rejected",r);const o=n.Au.get(e),i=o&&o.key;if(i){let a=new er(tt.comparator);a=a.insert(i,Ir.newNoDocument(i,dt.min()));const c=Et().add(i),d=new Xa(dt.min(),new Map,new er(It),a,c);await sp(n,d),n.du=n.du.remove(i),n.Au.delete(e),gu(n)}else await vc(n.localStore,e,!1).then(()=>Sc(n,e,r)).catch(vi)}async function LP(t,e){const r=ht(t),n=e.batch.batchId;try{const o=await G1(r.localStore,e);lp(r,n,null),ap(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Ss(r,o)}catch(o){await vi(o)}}async function MP(t,e,r){const n=ht(t);try{const o=await function(a,c){const d=ht(a);return d.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let y;return d.mutationQueue.lookupMutationBatch(h,c).next(v=>(Ut(v!==null,37113),y=v.keys(),d.mutationQueue.removeMutationBatch(h,v))).next(()=>d.mutationQueue.performConsistencyCheck(h)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(h,y,c)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,y)).next(()=>d.localDocuments.getDocuments(h,y))})}(n.localStore,e);lp(n,e,r),ap(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Ss(n,o)}catch(o){await vi(o)}}function ap(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function lp(t,e,r){const n=ht(t);let o=n.Vu[n.currentUser.toKey()];if(o){const i=o.get(e);i&&(r?i.reject(r):i.resolve(),o=o.remove(e)),n.Vu[n.currentUser.toKey()]=o}}function Sc(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||cp(t,n)})}function cp(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(cu(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),gu(t))}function kh(t,e,r){for(const n of r)n instanceof np?(t.Ru.addReference(n.key,e),OP(t,n)):n instanceof op?(Ye(pu,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||cp(t,n.key)):it(19791,{wu:n})}function OP(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Ye(pu,"New document in limbo: "+r),t.Eu.add(n),gu(t))}function gu(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new tt(Yt.fromString(e)),n=t.fu.next();t.Au.set(n,new xP(r)),t.du=t.du.insert(r,n),Yf(t.remoteStore,new Yn(un(eu(r.path)),n,"TargetPurposeLimboResolution",Ga.ce))}}async function Ss(t,e,r){const n=ht(t),o=[],i=[],a=[];n.Tu.isEmpty()||(n.Tu.forEach((c,d)=>{a.push(n.pu(d,e,r).then(h=>{if((h||r)&&n.isPrimaryClient){const y=h?!h.fromCache:r?.targetChanges.get(d.targetId)?.current;n.sharedClientState.updateQueryState(d.targetId,y?"current":"not-current")}if(h){o.push(h);const y=au.As(d.targetId,h);i.push(y)}}))}),await Promise.all(a),n.Pu.H_(o),await async function(d,h){const y=ht(d);try{await y.persistence.runTransaction("notifyLocalViewChanges","readwrite",v=>Re.forEach(h,w=>Re.forEach(w.Es,E=>y.persistence.referenceDelegate.addReference(v,w.targetId,E)).next(()=>Re.forEach(w.ds,E=>y.persistence.referenceDelegate.removeReference(v,w.targetId,E)))))}catch(v){if(!bi(v))throw v;Ye(lu,"Failed to update sequence numbers: "+v)}for(const v of h){const w=v.targetId;if(!v.fromCache){const E=y.Ms.get(w),V=E.snapshotVersion,N=E.withLastLimboFreeSnapshotVersion(V);y.Ms=y.Ms.insert(w,N)}}}(n.localStore,i))}async function VP(t,e){const r=ht(t);if(!r.currentUser.isEqual(e)){Ye(pu,"User change. New user:",e.toKey());const n=await qf(r.localStore,e);r.currentUser=e,function(i,a){i.mu.forEach(c=>{c.forEach(d=>{d.reject(new Ge(Te.CANCELLED,a))})}),i.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Ss(r,n.Ls)}}function FP(t,e){const r=ht(t),n=r.Au.get(e);if(n&&n.hu)return Et().add(n.key);{let o=Et();const i=r.Iu.get(e);if(!i)return o;for(const a of i){const c=r.Tu.get(a);o=o.unionWith(c.view.nu)}return o}}function up(t){const e=ht(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=sp.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=FP.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=NP.bind(null,e),e.Pu.H_=PP.bind(null,e.eventManager),e.Pu.yu=wP.bind(null,e.eventManager),e}function BP(t){const e=ht(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=LP.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=MP.bind(null,e),e}class Na{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Za(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return q1(this.persistence,new U1,e.initialUser,this.serializer)}Cu(e){return new zf(su.mi,this.serializer)}Du(e){return new J1}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Na.provider={build:()=>new Na};class UP extends Na{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Ut(this.persistence.referenceDelegate instanceof Ra,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new x1(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?Dr.withCacheSize(this.cacheSizeBytes):Dr.DEFAULT;return new zf(n=>Ra.mi(n,r),this.serializer)}}class Pc{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Th(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=VP.bind(null,this.syncEngine),await bP(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new SP}()}createDatastore(e){const r=Za(e.databaseInfo.databaseId),n=function(i){return new rP(i)}(e.databaseInfo);return function(i,a,c,d){return new sP(i,a,c,d)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,o,i,a,c){return new lP(n,o,i,a,c)}(this.localStore,this.datastore,e.asyncQueue,r=>Th(this.syncEngine,r,0),function(){return Ch.v()?new Ch:new X1}())}createSyncEngine(e,r){return function(o,i,a,c,d,h,y){const v=new IP(o,i,a,c,d,h);return y&&(v.gu=!0),v}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await async function(r){const n=ht(r);Ye(Do,"RemoteStore shutting down."),n.Ea.add(5),await _s(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Pc.provider={build:()=>new Pc};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):kn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const so="FirestoreClient";class jP{constructor(e,r,n,o,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=o,this.user=xr.UNAUTHENTICATED,this.clientId=Yc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async a=>{Ye(so,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Ye(so,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new En;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=yu(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function xl(t,e){t.asyncQueue.verifyOperationInProgress(),Ye(so,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async o=>{n.isEqual(o)||(await qf(e.localStore,o),n=o)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Rh(t,e){t.asyncQueue.verifyOperationInProgress();const r=await zP(t);Ye(so,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>xh(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,o)=>xh(e.remoteStore,o)),t._onlineComponents=e}async function zP(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ye(so,"Using user provided OfflineComponentProvider");try{await xl(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(o){return o.name==="FirebaseError"?o.code===Te.FAILED_PRECONDITION||o.code===Te.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11}(r))throw r;ai("Error using user provided cache. Falling back to memory cache: "+r),await xl(t,new Na)}}else Ye(so,"Using default OfflineComponentProvider"),await xl(t,new UP(void 0));return t._offlineComponents}async function hp(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ye(so,"Using user provided OnlineComponentProvider"),await Rh(t,t._uninitializedComponentsProvider._online)):(Ye(so,"Using default OnlineComponentProvider"),await Rh(t,new Pc))),t._onlineComponents}function qP(t){return hp(t).then(e=>e.syncEngine)}async function mp(t){const e=await hp(t),r=e.eventManager;return r.onListen=EP.bind(null,e.syncEngine),r.onUnlisten=kP.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=$P.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=RP.bind(null,e.syncEngine),r}function GP(t,e,r={}){const n=new En;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,c,d,h){const y=new dp({next:w=>{y.Nu(),a.enqueueAndForget(()=>tp(i,v));const E=w.docs.has(c);!E&&w.fromCache?h.reject(new Ge(Te.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&w.fromCache&&d&&d.source==="server"?h.reject(new Ge(Te.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(w)},error:w=>h.reject(w)}),v=new rp(eu(c.path),y,{includeMetadataChanges:!0,qa:!0});return ep(i,v)}(await mp(t),t.asyncQueue,e,r,n)),n.promise}function HP(t,e,r={}){const n=new En;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,c,d,h){const y=new dp({next:w=>{y.Nu(),a.enqueueAndForget(()=>tp(i,v)),w.fromCache&&d.source==="server"?h.reject(new Ge(Te.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(w)},error:w=>h.reject(w)}),v=new rp(c,y,{includeMetadataChanges:!0,qa:!0});return ep(i,v)}(await mp(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yp(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dh=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fp="firestore.googleapis.com",Nh=!0;class Lh{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ge(Te.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=fp,this.ssl=Nh}else this.host=e.host,this.ssl=e.ssl??Nh;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=jf;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<C1)throw new Ge(Te.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}lS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=yp(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Ge(Te.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Ge(Te.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Ge(Te.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,o){return n.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class rl{constructor(e,r,n,o){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Lh({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ge(Te.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ge(Te.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Lh(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new X_;switch(n.type){case"firstParty":return new rS(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ge(Te.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=Dh.get(r);n&&(Ye("ComponentProvider","Removing Datastore"),Dh.delete(r),n.terminate())}(this),Promise.resolve()}}function WP(t,e,r,n={}){t=Rn(t,rl);const o=yi(e),i=t._getSettings(),a={...i,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${r}`;o&&(ny(`https://${c}`),oy("Firestore",!0)),i.host!==fp&&i.host!==c&&ai("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d={...i,host:c,ssl:o,emulatorOptions:n};if(!$o(d,a)&&(t._setSettings(d),n.mockUserToken)){let h,y;if(typeof n.mockUserToken=="string")h=n.mockUserToken,y=xr.MOCK_USER;else{h=Pv(n.mockUserToken,t._app?.options.projectId);const v=n.mockUserToken.sub||n.mockUserToken.user_id;if(!v)throw new Ge(Te.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new xr(v)}t._authCredentials=new Z_(new Xy(h,y))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Oo(this.firestore,e,this._query)}}class nr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new eo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new nr(this.firestore,e,this._key)}toJSON(){return{type:nr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(gs(r,nr._jsonSchema))return new nr(e,n||null,new tt(Yt.fromString(r.referencePath)))}}nr._jsonSchemaVersion="firestore/documentReference/1.0",nr._jsonSchema={type:lr("string",nr._jsonSchemaVersion),referencePath:lr("string")};class eo extends Oo{constructor(e,r,n){super(e,r,eu(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new nr(this.firestore,null,new tt(e))}withConverter(e){return new eo(this.firestore,e,this._path)}}function YP(t,e,...r){if(t=vr(t),Zy("collection","path",e),t instanceof rl){const n=Yt.fromString(e,...r);return Yd(n),new eo(t,null,n)}{if(!(t instanceof nr||t instanceof eo))throw new Ge(Te.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Yt.fromString(e,...r));return Yd(n),new eo(t.firestore,null,n)}}function pp(t,e,...r){if(t=vr(t),arguments.length===1&&(e=Yc.newId()),Zy("doc","path",e),t instanceof rl){const n=Yt.fromString(e,...r);return Wd(n),new nr(t,null,new tt(n))}{if(!(t instanceof nr||t instanceof eo))throw new Ge(Te.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Yt.fromString(e,...r));return Wd(n),new nr(t.firestore,t instanceof eo?t.converter:null,new tt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mh="AsyncQueue";class Oh{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Hf(this,"async_queue_retry"),this._c=()=>{const n=Al();n&&Ye(Mh,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=Al();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=Al();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new En;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!bi(e))throw e;Ye(Mh,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,kn("INTERNAL UNHANDLED ERROR: ",Vh(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const o=mu.createAndSchedule(this,e,r,n,i=>this.hc(i));return this.tc.push(o),o}uc(){this.nc&&it(47125,{Pc:Vh(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function Vh(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Ps extends rl{constructor(e,r,n,o){super(e,r,n,o),this.type="firestore",this._queue=new Oh,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Oh(e),this._firestoreClient=void 0,await e}}}function KP(t,e){const r=typeof t=="object"?t:ly(),n=typeof t=="string"?t:xa,o=Mc(r,"firestore").getImmediate({identifier:n});if(!o._initialized){const i=_v("firestore");i&&WP(o,...i)}return o}function vu(t){if(t._terminated)throw new Ge(Te.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||QP(t),t._firestoreClient}function QP(t){const e=t._freezeSettings(),r=function(o,i,a,c){return new bS(o,i,a,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,yp(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)}(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new jP(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(o){const i=o?._online.build();return{_offline:o?._offline.build(i),_online:i}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new qr(br.fromBase64String(e))}catch(r){throw new Ge(Te.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new qr(br.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:qr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(gs(e,qr._jsonSchema))return qr.fromBase64String(e.bytes)}}qr._jsonSchemaVersion="firestore/bytes/1.0",qr._jsonSchema={type:lr("string",qr._jsonSchemaVersion),bytes:lr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Ge(Te.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new pr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Ge(Te.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Ge(Te.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return It(this._lat,e._lat)||It(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:mn._jsonSchemaVersion}}static fromJSON(e){if(gs(e,mn._jsonSchema))return new mn(e.latitude,e.longitude)}}mn._jsonSchemaVersion="firestore/geoPoint/1.0",mn._jsonSchema={type:lr("string",mn._jsonSchemaVersion),latitude:lr("number"),longitude:lr("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,o){if(n.length!==o.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==o[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:yn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(gs(e,yn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new yn(e.vectorValues);throw new Ge(Te.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}yn._jsonSchemaVersion="firestore/vectorValue/1.0",yn._jsonSchema={type:lr("string",yn._jsonSchemaVersion),vectorValues:lr("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JP=/^__.*__$/;class XP{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new ho(e,this.data,this.fieldMask,r,this.fieldTransforms):new vs(e,this.data,r,this.fieldTransforms)}}class gp{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new ho(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function vp(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw it(40011,{Ac:t})}}class _u{constructor(e,r,n,o,i,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=o,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new _u({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return La(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(vp(this.Ac)&&JP.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class ZP{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Za(e)}Cc(e,r,n,o=!1){return new _u({Ac:e,methodName:r,Dc:n,path:pr.emptyPath(),fc:!1,bc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Su(t){const e=t._freezeSettings(),r=Za(t._databaseId);return new ZP(t._databaseId,!!e.ignoreUndefinedProperties,r)}function ew(t,e,r,n,o,i={}){const a=t.Cc(i.merge||i.mergeFields?2:0,e,r,o);Pu("Data must be an object, but it was:",a,n);const c=bp(n,a);let d,h;if(i.merge)d=new Vr(a.fieldMask),h=a.fieldTransforms;else if(i.mergeFields){const y=[];for(const v of i.mergeFields){const w=wc(e,v,r);if(!a.contains(w))throw new Ge(Te.INVALID_ARGUMENT,`Field '${w}' is specified in your field mask but missing from your input data.`);Sp(y,w)||y.push(w)}d=new Vr(y),h=a.fieldTransforms.filter(v=>d.covers(v.field))}else d=null,h=a.fieldTransforms;return new XP(new Nr(c),d,h)}class ol extends bu{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ol}}function tw(t,e,r,n){const o=t.Cc(1,e,r);Pu("Data must be an object, but it was:",o,n);const i=[],a=Nr.empty();uo(n,(d,h)=>{const y=wu(e,d,r);h=vr(h);const v=o.yc(y);if(h instanceof ol)i.push(y);else{const w=ws(h,v);w!=null&&(i.push(y),a.set(y,w))}});const c=new Vr(i);return new gp(a,c,o.fieldTransforms)}function rw(t,e,r,n,o,i){const a=t.Cc(1,e,r),c=[wc(e,n,r)],d=[o];if(i.length%2!=0)throw new Ge(Te.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let w=0;w<i.length;w+=2)c.push(wc(e,i[w])),d.push(i[w+1]);const h=[],y=Nr.empty();for(let w=c.length-1;w>=0;--w)if(!Sp(h,c[w])){const E=c[w];let V=d[w];V=vr(V);const N=a.yc(E);if(V instanceof ol)h.push(E);else{const x=ws(V,N);x!=null&&(h.push(E),y.set(E,x))}}const v=new Vr(h);return new gp(y,v,a.fieldTransforms)}function nw(t,e,r,n=!1){return ws(r,t.Cc(n?4:3,e))}function ws(t,e){if(_p(t=vr(t)))return Pu("Unsupported field value:",e,t),bp(t,e);if(t instanceof bu)return function(n,o){if(!vp(o.Ac))throw o.Sc(`${n._methodName}() can only be used with update() and set()`);if(!o.path)throw o.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(o);i&&o.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,o){const i=[];let a=0;for(const c of n){let d=ws(c,o.wc(a));d==null&&(d={nullValue:"NULL_VALUE"}),i.push(d),a++}return{arrayValue:{values:i}}}(t,e)}return function(n,o){if((n=vr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return jS(o.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=Jt.fromDate(n);return{timestampValue:ka(o.serializer,i)}}if(n instanceof Jt){const i=new Jt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:ka(o.serializer,i)}}if(n instanceof mn)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof qr)return{bytesValue:Lf(o.serializer,n._byteString)};if(n instanceof nr){const i=o.databaseId,a=n.firestore._databaseId;if(!a.isEqual(i))throw o.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:ou(n.firestore._databaseId||o.databaseId,n._key.path)}}if(n instanceof yn)return function(a,c){return{mapValue:{fields:{[cf]:{stringValue:uf},[Ia]:{arrayValue:{values:a.toArray().map(h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return tu(c.serializer,h)})}}}}}}(n,o);throw o.Sc(`Unsupported field value: ${qa(n)}`)}(t,e)}function bp(t,e){const r={};return rf(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):uo(t,(n,o)=>{const i=ws(o,e.mc(n));i!=null&&(r[n]=i)}),{mapValue:{fields:r}}}function _p(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Jt||t instanceof mn||t instanceof qr||t instanceof nr||t instanceof bu||t instanceof yn)}function Pu(t,e,r){if(!_p(r)||!ef(r)){const n=qa(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function wc(t,e,r){if((e=vr(e))instanceof nl)return e._internalPath;if(typeof e=="string")return wu(t,e);throw La("Field path arguments must be of type string or ",t,!1,void 0,r)}const ow=new RegExp("[~\\*/\\[\\]]");function wu(t,e,r){if(e.search(ow)>=0)throw La(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new nl(...e.split("."))._internalPath}catch{throw La(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function La(t,e,r,n,o){const i=n&&!n.isEmpty(),a=o!==void 0;let c=`Function ${e}() called with invalid data`;r&&(c+=" (via `toFirestore()`)"),c+=". ";let d="";return(i||a)&&(d+=" (found",i&&(d+=` in field ${n}`),a&&(d+=` in document ${o}`),d+=")"),new Ge(Te.INVALID_ARGUMENT,c+t+d)}function Sp(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pp{constructor(e,r,n,o,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=o,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new nr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new iw(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Cu("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class iw extends Pp{data(){return super.data()}}function Cu(t,e){return typeof e=="string"?wu(t,e):e instanceof nl?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sw(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Ge(Te.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Au{}class wp extends Au{}function aw(t,e,...r){let n=[];e instanceof Au&&n.push(e),n=n.concat(r),function(i){const a=i.filter(d=>d instanceof Iu).length,c=i.filter(d=>d instanceof xu).length;if(a>1||a>0&&c>0)throw new Ge(Te.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const o of n)t=o._apply(t);return t}class xu extends wp{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new xu(e,r,n)}_apply(e){const r=this._parse(e);return Cp(e._query,r),new Oo(e.firestore,e.converter,hc(e._query,r))}_parse(e){const r=Su(e.firestore);return function(i,a,c,d,h,y,v){let w;if(h.isKeyField()){if(y==="array-contains"||y==="array-contains-any")throw new Ge(Te.INVALID_ARGUMENT,`Invalid Query. You can't perform '${y}' queries on documentId().`);if(y==="in"||y==="not-in"){Bh(v,y);const V=[];for(const N of v)V.push(Fh(d,i,N));w={arrayValue:{values:V}}}else w=Fh(d,i,v)}else y!=="in"&&y!=="not-in"&&y!=="array-contains-any"||Bh(v,y),w=nw(c,a,v,y==="in"||y==="not-in");return ar.create(h,y,w)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}class Iu extends Au{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new Iu(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Zr.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(o,i){let a=o;const c=i.getFlattenedFilters();for(const d of c)Cp(a,d),a=hc(a,d)}(e._query,r),new Oo(e.firestore,e.converter,hc(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Eu extends wp{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new Eu(e,r)}_apply(e){const r=function(o,i,a){if(o.startAt!==null)throw new Ge(Te.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new Ge(Te.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new as(i,a)}(e._query,this._field,this._direction);return new Oo(e.firestore,e.converter,function(o,i){const a=o.explicitOrderBy.concat([i]);return new _i(o.path,o.collectionGroup,a,o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt)}(e._query,r))}}function lw(t,e="asc"){const r=e,n=Cu("orderBy",t);return Eu._create(n,r)}function Fh(t,e,r){if(typeof(r=vr(r))=="string"){if(r==="")throw new Ge(Te.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!vf(e)&&r.indexOf("/")!==-1)throw new Ge(Te.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(Yt.fromString(r));if(!tt.isDocumentKey(n))throw new Ge(Te.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return rh(t,new tt(n))}if(r instanceof nr)return rh(t,r._key);throw new Ge(Te.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${qa(r)}.`)}function Bh(t,e){if(!Array.isArray(t)||t.length===0)throw new Ge(Te.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Cp(t,e){const r=function(o,i){for(const a of o)for(const c of a.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Ge(Te.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ge(Te.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class cw{convertValue(e,r="none"){switch(oo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return rr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(no(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw it(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return uo(e,(o,i)=>{n[o]=this.convertValue(i,r)}),n}convertVectorValue(e){const r=e.fields?.[Ia].arrayValue?.values?.map(n=>rr(n.doubleValue));return new yn(r)}convertGeoPoint(e){return new mn(rr(e.latitude),rr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Wa(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(os(e));default:return null}}convertTimestamp(e){const r=ro(e);return new Jt(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Yt.fromString(e);Ut(Uf(n),9688,{name:e});const o=new is(n.get(1),n.get(3)),i=new tt(n.popFirst(5));return o.isEqual(r)||kn(`Document ${i} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uw(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class Bi{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Eo extends Pp{constructor(e,r,n,o,i,a){super(e,r,n,o,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new ca(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Cu("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ge(Te.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Eo._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Eo._jsonSchemaVersion="firestore/documentSnapshot/1.0",Eo._jsonSchema={type:lr("string",Eo._jsonSchemaVersion),bundleSource:lr("string","DocumentSnapshot"),bundleName:lr("string"),bundle:lr("string")};class ca extends Eo{data(e={}){return super.data(e)}}class oi{constructor(e,r,n,o){this._firestore=e,this._userDataWriter=r,this._snapshot=o,this.metadata=new Bi(o.hasPendingWrites,o.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new ca(this._firestore,this._userDataWriter,n.key,n,new Bi(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Ge(Te.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(o,i){if(o._snapshot.oldDocs.isEmpty()){let a=0;return o._snapshot.docChanges.map(c=>{const d=new ca(o._firestore,o._userDataWriter,c.doc.key,c.doc,new Bi(o._snapshot.mutatedKeys.has(c.doc.key),o._snapshot.fromCache),o.query.converter);return c.doc,{type:"added",doc:d,oldIndex:-1,newIndex:a++}})}{let a=o._snapshot.oldDocs;return o._snapshot.docChanges.filter(c=>i||c.type!==3).map(c=>{const d=new ca(o._firestore,o._userDataWriter,c.doc.key,c.doc,new Bi(o._snapshot.mutatedKeys.has(c.doc.key),o._snapshot.fromCache),o.query.converter);let h=-1,y=-1;return c.type!==0&&(h=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),y=a.indexOf(c.doc.key)),{type:dw(c.type),doc:d,oldIndex:h,newIndex:y}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ge(Te.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=oi._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Yc.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],o=[];return this.docs.forEach(i=>{i._document!==null&&(r.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),o.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function dw(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return it(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hw(t){t=Rn(t,nr);const e=Rn(t.firestore,Ps);return GP(vu(e),t._key).then(r=>fw(e,t,r))}oi._jsonSchemaVersion="firestore/querySnapshot/1.0",oi._jsonSchema={type:lr("string",oi._jsonSchemaVersion),bundleSource:lr("string","QuerySnapshot"),bundleName:lr("string"),bundle:lr("string")};class Ap extends cw{constructor(e){super(),this.firestore=e}convertBytes(e){return new qr(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new nr(this.firestore,null,r)}}function mw(t){t=Rn(t,Oo);const e=Rn(t.firestore,Ps),r=vu(e),n=new Ap(e);return sw(t._query),HP(r,t._query).then(o=>new oi(e,n,t,o))}function yw(t,e,r){t=Rn(t,nr);const n=Rn(t.firestore,Ps),o=uw(t.converter,e);return Ip(n,[ew(Su(n),"setDoc",t._key,o,t.converter!==null,r).toMutation(t._key,dn.none())])}function xp(t,e,r,...n){t=Rn(t,nr);const o=Rn(t.firestore,Ps),i=Su(o);let a;return a=typeof(e=vr(e))=="string"||e instanceof nl?rw(i,"updateDoc",t._key,e,r,n):tw(i,"updateDoc",t._key,e),Ip(o,[a.toMutation(t._key,dn.exists(!0))])}function Ip(t,e){return function(n,o){const i=new En;return n.asyncQueue.enqueueAndForget(async()=>DP(await qP(n),o,i)),i.promise}(vu(t),e)}function fw(t,e,r){const n=r.docs.get(e._key),o=new Ap(t);return new Eo(t,o,e._key,n,new Bi(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(o){gi=o})(fi),ii(new To("firestore",(n,{instanceIdentifier:o,options:i})=>{const a=n.getProvider("app").getImmediate(),c=new Ps(new eS(n.getProvider("auth-internal")),new nS(a,n.getProvider("app-check-internal")),function(h,y){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Ge(Te.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new is(h.options.projectId,y)}(a,o),a);return i={useFetchStreams:r,...i},c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),Jn(zd,qd,e),Jn(zd,qd,"esm2020")})();let pw="eyAiYXBpS2V5IjogIkFJemFTeUJBbGN2WlRMMXRsQ05LRExENEJpTWJhR01iTnhCRjQtTSIsICAiYXV0aERvbWFpbiI6ICJocm0tMTEyOC5maXJlYmFzZWFwcC5jb20iLCAgImRhdGFiYXNlVVJMIjogImh0dHBzOi8vaHJtLTExMjguZmlyZWJhc2Vpby5jb20iLCAgInByb2plY3RJZCI6ICJocm0tMTEyOCIsICAic3RvcmFnZUJ1Y2tldCI6ICJocm0tMTEyOC5hcHBzcG90LmNvbSIsICAibWVzc2FnaW5nU2VuZGVySWQiOiAiMTA0OTI1MDU4NTI0NSIsICAiYXBwSWQiOiAiMToxMDQ5MjUwNTg1MjQ1OndlYjowZGFkMDAyMDI3MjM1MTRjY2M1Mjc0In0=";const Ep=ay(JSON.parse(lv(pw))),Co=Y_(Ep),Ma=new an,Cc=KP(Ep);Ma.addScope("profile");Ma.addScope("email");class Ui extends Error{}Ui.prototype.name="InvalidTokenError";function gw(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function vw(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return gw(e)}catch{return atob(e)}}function bw(t,e){if(typeof t!="string")throw new Ui("Invalid token specified: must be a string");e||(e={});const r=e.header===!0?0:1,n=t.split(".")[r];if(typeof n!="string")throw new Ui(`Invalid token specified: missing part #${r+1}`);let o;try{o=vw(n)}catch(i){throw new Ui(`Invalid token specified: invalid base64 for part #${r+1} (${i.message})`)}try{return JSON.parse(o)}catch(i){throw new Ui(`Invalid token specified: invalid json for part #${r+1} (${i.message})`)}}const _w={clientId:"195275085181-8ccjpgp8v1g80qhnlk6v4lpgid7n81gr.apps.googleusercontent.com"},Sw=t=>{const e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.onload=()=>{window.google&&window.google.accounts.id.initialize({client_id:_w.clientId,callback:r=>{t(r.credential)},auto_select:!1,cancel_on_tap_outside:!0})},document.head.appendChild(e)},Pw=t=>bw(t),ww=()=>{window.google&&window.google.accounts.id.disableAutoSelect()},[Cw,Aw]=Fa({}),xw=async()=>{const e=await wn({query:"qcm42351987"});if(e&&!e.error){let n=Object.assign({},{},e);Aw(n)}return 1},Iw=async t=>{let e=Cw?.[992002];e&&(e.params={tkn:t},await wn(e))},[qo,Ar]=Fa({user:null,loading:!0,error:null,authMethod:null}),[$p,Uh]=ve(null);L0(Co,t=>{t?Ar({user:t,loading:!1,error:null,authMethod:"firebase"}):$p()||Ar({user:null,loading:!1,error:null,authMethod:null})});u_(Co).then(t=>{t&&Ar({user:t.user,loading:!1,error:null,authMethod:"firebase"})}).catch(t=>{console.error("Redirect sign-in error:",t),Ar({loading:!1,error:t.message})});const St={get state(){return qo},async getUserProfile(t){try{const e=pp(Cc,"users",t),r=await hw(e);if(r.exists()){Ar("profile",r.data());let n={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1},o=r.data(),i={};return Object.keys(n).map(a=>{let c=n?.[a];o.hasOwnProperty(a)||(i[a]=c)}),Object.keys(i).length>0&&xp(e,i),r.data()}else{let n=St?.state?.user,o={uid:n?.uid,email:n?.email,displayName:n?.displayName,createdAt:new Date,stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1};return await yw(e,o),console.log("No such user profile!"),null}}catch(e){return console.error("Error fetching user profile:",e),null}},hasPermission:t=>{const e=St.state?.profile;return e?.isAdmin?!0:e?e?.[t]===!0:!1},async signInWithGoogle(){try{Ar("loading",!0),Ar("error",null);try{const t=await r_(Co,Ma);Ar({user:t.user,loading:!1,error:null,authMethod:"firebase"});try{St.getUserProfile(t.user.uid)}catch(e){console.error("firestore error:",e)}}catch(t){if(t.code==="auth/popup-blocked")await l_(Co,Ma);else throw t}}catch(t){console.error("Sign-in error:",t),Ar({loading:!1,error:t.message||"Failed to sign in with Google"})}},async signInWithGoogleP(t){const r=await wn({params:{id_token:t},query:"getGoogleUserbyToken"});if(r&&r){let n=new Date().getTime(),o=new Date(n+6e4*60*24*365),i="hrm_tkn_acc";document.cookie=`${i}=${r.data}; expires=${o}; path=/;g_state = {"i_l":1,"i_p":${o}}; ssgl_access_tkn = ${t}`,document.cookie=`ssgl_access_tkn = ${t}; expires=${o};`,await xw(),Iw(r.data)}},async signInWithGoogleCloud(t){try{Ar("loading",!0),Ar("error",null);const e=Pw(t),r={uid:e.sub,email:e.email,displayName:e.name,photoURL:e.picture};Uh(r);const n={uid:r.uid,email:r.email,displayName:r.displayName,photoURL:r.photoURL,emailVerified:!0};Ar({user:n,loading:!1,error:null,authMethod:"google-cloud"});try{const o=an.credential(t);await R0(Co,o)}catch{console.log("Firebase sign-in optional, continuing with Google Cloud auth")}}catch(e){console.error("Google Cloud sign-in error:",e),Ar({loading:!1,error:e.message||"Failed to sign in with Google Cloud"})}},async signOut(){try{Ar("loading",!0),(qo.authMethod==="firebase"||Co.currentUser)&&await M0(Co),qo.authMethod==="google-cloud"&&(ww(),Uh(null)),Ar({user:null,loading:!1,error:null,authMethod:null})}catch(t){console.error("Sign-out error:",t),Ar({loading:!1,error:t.message||"Failed to sign out"})}},get isAuthenticated(){return!!qo.user||!!$p()},get currentUser(){return qo.user},get authMethod(){return qo.authMethod}};var Ew=G("<p>"),$w=G('<div><div><div><h1>HRM Finance</h1><p>Complete Business Management Solution</p><div><div><button><svg width=24 height=24 viewBox="0 0 24 24"><path fill=#4285F4 d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"></path><path fill=#34A853 d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"></path><path fill=#FBBC05 d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"></path><path fill=#EA4335 d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"></path></svg></button><p>Firebase Authentication</p></div></div></div><div><div><div></div><h3>Financial Management</h3><p>Complete chart of accounts, balance sheets, journal entries, and invoice management in one place.</p></div><div><div></div><h3>HR Management</h3><p>Track employees, manage onboarding, and monitor your workforce with powerful analytics.</p></div><div><div></div><h3>Inventory Control</h3><p>Real-time inventory tracking, product management, and movement history across multiple locations.</p></div><div><div></div><h3>Banking Integration</h3><p>Streamline bank reconciliation with CSV imports and automated consolidation features.</p></div><div><div></div><h3>Real-time Analytics</h3><p>Get instant insights with dashboards showing revenue, cash flow, and business performance.</p></div><div><div></div><h3>Multi-language Support</h3><p>Available in multiple languages to support your global business operations.</p></div></div><div><p>Secure authentication powered by Google  Your data is encrypted and protected</p><p>Choose your preferred authentication method above');const Tw=()=>{Hr(()=>{Sw(x=>{St.signInWithGoogleP(x)}),setTimeout(()=>{},100)});const t={"min-height":"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},e={background:"white","border-radius":"1rem","box-shadow":"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","max-width":"1200px",width:"100%",overflow:"hidden"},r={padding:"3rem","text-align":"center","border-bottom":"1px solid #e2e8f0"},n={"font-size":"2.5rem","font-weight":"800",color:"#1a202c","margin-bottom":"1rem"},o={"font-size":"1.125rem",color:"#718096","margin-bottom":"2rem"},i={display:"flex","flex-direction":"column",gap:"1rem","align-items":"center","margin-bottom":"1rem"},a={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"2rem",padding:"3rem"},c={"text-align":"center",padding:"2rem","border-radius":"0.5rem",background:"#f7fafc",transition:"transform 0.2s",cursor:"default"},d={"font-size":"3rem","margin-bottom":"1rem"},h={"font-size":"1.25rem","font-weight":"600",color:"#2d3748","margin-bottom":"0.5rem"},y={color:"#718096","line-height":"1.6"},v={display:"inline-flex","align-items":"center",gap:"0.75rem",background:"white",color:"#4285f4",border:"2px solid #4285f4",padding:"0.75rem 2rem","font-size":"1.125rem","font-weight":"500","border-radius":"0.5rem",cursor:"pointer",transition:"all 0.2s","min-width":"250px","justify-content":"center"},w={color:"#e53e3e","margin-top":"1rem","font-size":"0.875rem"},E={background:"#f7fafc",padding:"2rem","text-align":"center",color:"#718096","font-size":"0.875rem"},V={"font-size":"0.75rem",color:"#718096","margin-top":"0.25rem","font-style":"italic"},N=()=>{St.signInWithGoogle()};return(()=>{var x=$w(),k=x.firstChild,re=k.firstChild,ae=re.firstChild,F=ae.nextSibling,Y=F.nextSibling,U=Y.firstChild,b=U.firstChild;b.firstChild;var g=b.nextSibling,p=re.nextSibling,C=p.firstChild,S=C.firstChild,A=S.nextSibling,m=A.nextSibling,ne=C.nextSibling,W=ne.firstChild,I=W.nextSibling,O=I.nextSibling,J=ne.nextSibling,D=J.firstChild,T=D.nextSibling,B=T.nextSibling,me=J.nextSibling,H=me.firstChild,de=H.nextSibling,$=de.nextSibling,q=me.nextSibling,Z=q.firstChild,L=Z.nextSibling,te=L.nextSibling,j=q.nextSibling,M=j.firstChild,ie=M.nextSibling,oe=ie.nextSibling,fe=p.nextSibling,ue=fe.firstChild,K=ue.nextSibling;return u(x,t),u(k,e),u(re,r),u(ae,n),u(F,o),u(Y,i),b.addEventListener("mouseleave",R=>{R.currentTarget.style.background="white",R.currentTarget.style.color="#4285f4"}),b.addEventListener("mouseenter",R=>{R.currentTarget.style.background="#4285f4",R.currentTarget.style.color="white"}),b.$$click=N,u(b,v),s(b,_(De,{get when(){return St.state.loading},fallback:"Sign in with Google",children:"Signing in..."}),null),u(g,V),s(re,_(De,{get when(){return St.state.error},get children(){var R=Ew();return u(R,w),s(R,()=>St.state.error),R}}),null),u(p,a),u(fe,E),K.style.setProperty("margin-top","0.5rem"),K.style.setProperty("font-size","0.75rem"),le(R=>{var ee=St.state.loading,X=c,ye=d,pe=h,z=y,se=c,_e=d,Pe=h,he=y,be=c,ce=d,Se=h,Ee=y,$e=c,ke=d,Me=h,Ke=y,je=c,Ce=d,Fe=h,Qe=y,We=c,Je=d,xe=h,ot=y;return ee!==R.e&&(b.disabled=R.e=ee),R.t=u(C,X,R.t),R.a=u(S,ye,R.a),R.o=u(A,pe,R.o),R.i=u(m,z,R.i),R.n=u(ne,se,R.n),R.s=u(W,_e,R.s),R.h=u(I,Pe,R.h),R.r=u(O,he,R.r),R.d=u(J,be,R.d),R.l=u(D,ce,R.l),R.u=u(T,Se,R.u),R.c=u(B,Ee,R.c),R.w=u(me,$e,R.w),R.m=u(H,ke,R.m),R.f=u(de,Me,R.f),R.y=u($,Ke,R.y),R.g=u(q,je,R.g),R.p=u(Z,Ce,R.p),R.b=u(L,Fe,R.b),R.T=u(te,Qe,R.T),R.A=u(j,We,R.A),R.O=u(M,Je,R.O),R.I=u(ie,xe,R.I),R.S=u(oe,ot,R.S),R},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0}),x})()};Pt(["click"]);var kw=G("<div><div>");const Rw=t=>{const e={"min-height":"100vh",display:"flex","align-items":"center","justify-content":"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},r={width:"50px",height:"50px",border:"3px solid rgba(255, 255, 255, 0.3)","border-top-color":"white","border-radius":"50%",animation:"spin 1s linear infinite"},n=document.createElement("style");return n.textContent=`
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  `,document.head.appendChild(n),Nn(()=>{St.state?.user?.uid&&St.getUserProfile(St.state?.user?.uid)}),Hr(()=>{}),_(De,{get when(){return!St.state.loading},get fallback(){return(()=>{var o=kw(),i=o.firstChild;return u(o,e),u(i,r),o})()},get children(){return _(De,{get when(){return St.isAuthenticated},get fallback(){return _(Tw,{})},get children(){return t.children}})}})};var Dw=G("<button>");const Le=t=>{const e=()=>{const r={"font-family":"inherit",cursor:t.disabled?"not-allowed":"pointer",border:"none","border-radius":"var(--border-radius-sm)","font-weight":"500",transition:"all 0.2s ease","text-decoration":"none",display:"inline-flex","align-items":"center","justify-content":"center",gap:"0.5rem",opacity:t.disabled?"0.6":"1"},n={sm:{padding:"0.5rem 1rem","font-size":"0.875rem"},md:{padding:"0.75rem 1.5rem","font-size":"1rem"},lg:{padding:"1rem 2rem","font-size":"1.125rem"}},o={primary:{background:"linear-gradient(135deg, var(--primary-color), var(--primary-dark))",color:"white","box-shadow":"var(--shadow-sm)"},secondary:{background:"var(--surface-color)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},outline:{background:"transparent",color:"var(--primary-color)",border:"1px solid var(--primary-color)"}};return{...r,...n[t.size||"md"],...o[t.variant||"primary"]}};return(()=>{var r=Dw();return co(r,"click",t.onClick,!0),s(r,()=>t.children),le(n=>{var o=e(),i=t.disabled,a=t.type||"button",c=`btn btn-${t.variant||"primary"} ${t.className||""}`;return n.e=u(r,o,n.e),i!==n.t&&(r.disabled=n.t=i),a!==n.a&&lt(r,"type",n.a=a),c!==n.o&&Tc(r,n.o=c),n},{e:void 0,t:void 0,a:void 0,o:void 0}),r})()};Pt(["click"]);var Nw=G("<div><div><div><h2></h2><button></button></div><div>");const _r=t=>{const e={position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","z-index":"1000"},r={background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)","max-width":"920px",width:"90%","max-height":"80vh",overflow:"auto",position:"relative"},n={padding:"1.5rem","border-bottom":"1px solid var(--border-color)",display:"flex","justify-content":"space-between","align-items":"center"},o={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},i={background:"none",border:"none","font-size":"1.5rem",cursor:"pointer",color:"var(--text-muted)",padding:"0.5rem","border-radius":"var(--border-radius-sm)"},a={padding:"1.5rem"},c=d=>{d.target===d.currentTarget&&t.onClose()};return _(De,{get when(){return t.isOpen},get children(){var d=Nw(),h=d.firstChild,y=h.firstChild,v=y.firstChild,w=v.nextSibling,E=y.nextSibling;return d.$$click=c,u(y,n),u(v,o),s(v,()=>t.title),w.addEventListener("mouseleave",V=>V.target.style.background="none"),w.addEventListener("mouseenter",V=>V.target.style.background="var(--background-color)"),co(w,"click",t.onClose,!0),u(w,i),u(E,a),s(E,()=>t.children),le(V=>{var N=e,x=r;return V.e=u(d,N,V.e),V.t=u(h,x,V.t),V},{e:void 0,t:void 0}),d}})};Pt(["click"]);var jh=G("<div>"),Lw=G("<h3>"),Mw=G("<p>");const He=t=>{const e={background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"1.5rem","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",transition:"all 0.2s ease",cursor:t.onClick?"pointer":"default"},r={"margin-bottom":"1rem"},n={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0 0 0.5rem 0"},o={"font-size":"0.875rem",color:"var(--text-muted)",margin:"0"};return(()=>{var i=jh();return co(i,"click",t.onClick,!0),s(i,(()=>{var a=ge(()=>!!(t.title||t.subtitle));return()=>a()&&(()=>{var c=jh();return u(c,r),s(c,(()=>{var d=ge(()=>!!t.title);return()=>d()&&(()=>{var h=Lw();return u(h,n),s(h,()=>t.title),h})()})(),null),s(c,(()=>{var d=ge(()=>!!t.subtitle);return()=>d()&&(()=>{var h=Mw();return u(h,o),s(h,()=>t.subtitle),h})()})(),null),c})()})(),null),s(i,()=>t.children,null),le(a=>{var c=e,d=`card ${t.className||""}`;return a.e=u(i,c,a.e),d!==a.t&&Tc(i,a.t=d),a},{e:void 0,t:void 0}),i})()};Pt(["click"]);var Ow=G("<div><label></label><input>"),Vw=G("<span>*");const Ot=t=>{const e={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},r={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},n={"margin-bottom":"1rem"};return(()=>{var o=Ow(),i=o.firstChild,a=i.nextSibling;return u(o,n),u(i,e),s(i,()=>t.label,null),s(i,(()=>{var c=ge(()=>!!t.required);return()=>c()&&(()=>{var d=Vw();return d.style.setProperty("color","var(--primary-color)"),d})()})(),null),a.addEventListener("blur",c=>c.target.style.borderColor="var(--border-color)"),a.addEventListener("focus",c=>c.target.style.borderColor="var(--primary-color)"),a.$$input=c=>t.onChange(c.target.value),u(a,r),le(c=>{var d=t.type||"text",h=t.placeholder,y=t.required,v=t.disabled;return d!==c.e&&lt(a,"type",c.e=d),h!==c.t&&lt(a,"placeholder",c.t=h),y!==c.a&&(a.required=c.a=y),v!==c.o&&(a.disabled=c.o=v),c},{e:void 0,t:void 0,a:void 0,o:void 0}),le(()=>a.value=t.value),o})()};Pt(["input"]);const Fw={en:{common:{save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",close:"Close",search:"Search",filter:"Filter",reset:"Reset",back:"Back",next:"Next",previous:"Previous",yes:"Yes",no:"No",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",confirm:"Confirm",actions:"Actions",status:"Status",active:"Active",inactive:"Inactive",date:"Date",time:"Time",description:"Description",notes:"Notes",amount:"Amount",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Language",english:"English",spanish:"Spanish",noDataFound:"No data found",required:"Required",optional:"Optional",all:"All",none:"None",select:"Select",clear:"Clear",searching:"Searching...",refresh:"Refresh",showAll:"Show All",products:"products",filtered:"Filtered",view:"View",suggested:"Suggested",clearFilters:"Clear Filters",enhanced:"Enhanced",legacy:"Legacy",email:"Email",phone:"Phone",address:"Address",name:"Name",code:"Code",category:"Category",type:"Type",quantity:"Quantity",price:"Price",cost:"Cost",value:"Value",balance:"Balance",created:"Created",modified:"Modified",details:"Details",summary:"Summary",history:"History",new:"New",addNew:"Add New",unknown:"Unknown",notAvailable:"N/A",remove:"Remove",startDate:"Start Date",endDate:"End Date",from:"From",invoice:"Invoice",invoices:"invoices",reference:"Reference",createdBy:"Created By",units:"units",invoiceDocumentId:"Invoice/Document ID",referenceNumber:"Reference Number",referenceNumberPlaceholder:"Enter reference number...",generalNotes:"General Notes",auto:"Auto",optionalNotes:"Optional notes...",showPerPage:"Show per page",first:"First",last:"Last",pageOfPages:"Page {{current}} of {{total}}",showingXofY:"Showing {{start}}-{{end}} of {{total}}",page:"Page",of:"of",print:"Print",export:"Export",pending:"Pending",completed:"Completed",customer:"Customer",store:"Store",location:"Location",reservations:"Reservations",backToDashboard:"Back to Dashboard",lbs:"pounds"},forms:{referenceNumberRequired:"Reference number is required",locationRequired:"Location is required",fromLocationRequired:"From location is required for transfers",atLeastOneProduct:"At least one product is required",itemProductRequired:"Product is required for item {{index}}",itemQuantityRequired:"Quantity must be greater than 0 for item {{index}}"},navigation:{dashboard:"Dashboard",accounts:"Chart of Accounts",balanceSheet:"Balance Sheet",inventory:"Inventory",employees:"Employees",entryBooks:"Entry Books",consolidate:"Bank Consolidation",reports:"Reports",settings:"Settings"},dashboard:{title:"Dashboard",welcome:"Welcome to HRM Finance",totalRevenue:"Total Revenue",overview:"Overview",recentActivity:"Recent Activity",quickActions:"Quick Actions",employeeCount:"Employee Count",pendingInvoices:"Pending Invoices",cashBalance:"Cash Balance",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalExpenses:"Total Expenses",netIncome:"Net Income",netLoss:"Net Loss",monthlyPayroll:"Monthly Payroll",current:"Current",newHires:"+3 new hires",outstanding:"Outstanding",totalOutstanding:"$23,450 total",lastUpdatedToday:"Last updated today",commonTasks:"Common tasks",generateReport:"Generate Report",latestUpdates:"Latest updates",invoicePaid:"Invoice #1234 paid",hoursAgo:"2 hours ago",newEmployeeOnboarded:"New employee onboarded",dayAgo:"1 day ago",monthlyReportGenerated:"Monthly report generated",daysAgo:"2 days ago"},accounts:{title:"Chart of Accounts",accountNumber:"Account Number",accountName:"Account Name",accountType:"Account Type",category:"Category",balance:"Balance",parentAccount:"Parent Account",subAccounts:"Sub-accounts",addAccount:"Add Account",editAccount:"Edit Account",deleteAccount:"Delete Account",accountDetails:"Account Details",transactions:"Transactions",accountHistory:"Account History",backToAccounts:"Back to Accounts",accountNotFound:"Account not found",accountInformation:"Account Information",accountPurpose:"Account purpose",transactionHistory:"Transaction History",noTransactions:"No transactions found for this account",createdDate:"Created Date",lastModified:"Last Modified",noDescription:"No description provided.",totalCount:"Total count",basicDetails:"Basic details",currentBalance:"Current balance",classification:"Classification",allTransactions:"All account transactions",reference:"Reference",allAccounts:"All Accounts",types:{asset:"Asset",liability:"Liability",equity:"Equity",revenue:"Revenue",expense:"Expense"},categories:{currentAssets:"Current Assets",fixedAssets:"Fixed Assets",currentLiabilities:"Current Liabilities",longTermLiabilities:"Long-term Liabilities",ownersEquity:"Owner's Equity",operatingRevenue:"Operating Revenue",operatingExpenses:"Operating Expenses"}},inventory:{title:"Inventory Management",overview:"Overview",products:"Products & Stock",movements:"Movements",locations:"Locations",bulkMovement:"Bulk Movement",addMovement:"Add Movement",addProduct:"Add Product",addLocation:"Add Location",singleMovement:"Add Single Movement",addNewItem:"Add New Item",activeProducts:"Active Products",lowStockAlert:"Low Stock Items",totalValue:"Total Stock Value",activeLocations:"Active Locations",productsNeedRestocking:"products need restocking",recentMovements:"Recent Movements",noProducts:"No products at this location",productName:"Product Name",productCode:"Product Code",sku:"SKU",unitOfMeasure:"Unit of Measure",unitCost:"Unit Cost",minStockLevel:"Min Stock Level",maxStockLevel:"Max Stock Level",locationName:"Location Name",locationType:"Location Type",locationCode:"Location Code",movementType:"Movement Type",referenceNumber:"Reference Number",invoiceNumber:"Invoice Number",fromLocation:"From Location",toLocation:"To Location",stockIn:"Stock In",stockOut:"Stock Out",transfer:"Transfer",adjustment:"Adjustment",inStock:"In Stock",lowStock:"Low Stock",outOfStock:"Out of Stock",stockLevels:"Stock Levels",stockByLocation:"Stock by Location",searchProducts:"Search products by name, SKU, or category...",searchProductsStock:"Search products and check stock levels...",searchResult:"Search Result",searchResults:"Search Results",searchFallback:"Showing local results",tryDifferentTerm:"Try a different search term or check spelling.",showingTopResults:"Showing top {{count}} results",searchLocations:"Search locations...",noMovements:"No movements found",productDetails:"Product Details",locationDetails:"Location Details",movementDetails:"Movement Details",totalProducts:"Total Products",totalLocations:"Total Locations",lastSeen:"Last seen",warehouseType:"Warehouse",storeType:"Store",supplierType:"Supplier",customerType:"Customer",currentlyManaged:"Currently managed",needAttention:"Need attention",currentWorth:"Current worth",warehousesStores:"Warehouses & stores",thisMonth:"This Month",latestActivities:"Latest inventory activities",searchMovements:"Search Movements",countingSheet:"Counting Sheet",physicalCount:"Physical Count",physicalInventoryCount:"Physical Inventory Count",setupPhysicalCount:"Setup Physical Inventory Count",setupDescription:"Configure your physical inventory count settings and begin the counting process.",countWillInclude:"This count will include {{count}} products from {{location}} in {{category}} category.",startCounting:"Start Physical Count",counted:"Counted",remaining:"Remaining",variances:"Variances",complete:"Complete",systemQty:"System Qty",variance:"Variance",addNotes:"Add notes...",reviewAndConfirm:"Review and Confirm Adjustments",reviewDescription:"Review the inventory adjustments below and confirm to update your system.",stockIncreases:"Stock Increases",stockDecreases:"Stock Decreases",totalAdjustments:"Total Adjustments",confirmAdjustments:"Confirm Adjustments",perfectCount:"Perfect Count!",noVariances:"No variances found. Your physical count matches the system exactly.",physicalCountAdjustment:"Physical count adjustment",inventoryCountingSheetTitle:"INVENTORY COUNTING SHEET",location:"Location",allCategories:"All Categories",countedBy:"Counted by",verifiedBy:"Verified by",instructions:"Instructions",countInstructions:["Count all items physically present at this location",'Write the actual count in the "Physical Count" column',"Leave blank if item is not found",'Note any discrepancies in the "Notes" column',"Sign and date when complete"],productName:"Product Name",unit:"Unit",totalProductsListed:"Total Products Listed",itemsCounted:"Items Counted",summaryFor:"SUMMARY FOR",discrepanciesFound:"Discrepancies Found",counterSignature:"Counter Signature",supervisorSignature:"Supervisor Signature",downloadCSV:"Download CSV",noAdjustmentsToDownload:"No adjustments to download",stockIncrease:"Stock Increase",stockDecrease:"Stock Decrease",purchaseReceive:"Purchase/Receive",saleIssue:"Sale/Issue",transfer:"Transfer",adjustment:"Adjustment",movementType:"Movement Type",fromLocation:"From Location",toLocation:"To Location",searchSourceLocation:"Search source location...",searchDestinationLocation:"Search destination location...",searchLocation:"Search location...",addProduct:"Add Product",searchProduct:"Search product...",unitCost:"Unit Cost",noProductsAdded:'No products added yet. Click "Add Product" to get started.',createMovement:"Create Movement",generalNotesPlaceholder:"Enter general notes for this movement...",sortBy:"Sort By",allLocations:"All Locations",searchByProduct:"Search by product, location, reference, notes, invoice...",allProducts:"All Products",allTypes:"All Types",startDate:"Start Date",endDate:"End Date",totalMovements:"Total Movements",totalItems:"Total Items",adjustMovements:"Try adjusting your filters or check back later.",inventoryMovements:"Inventory Movements",createdBy:"Created By",view:"View",enhanced:"Enhanced",legacy:"Legacy",addSingleMovement:"Add Single Movement",inStockSubtitle:"In stock",itemsBelowThreshold:"Items below threshold",inventoryWorth:"Inventory worth",quantity:"Quantity",units:"units",normal:"Normal",productsAndStock:"Products & Stock",lowStockItems:"Low Stock Items",totalStockValue:"Total Stock Value",warehousesAndStores:"Warehouses & stores",andMore:"...and {count} more",latestInventoryActivities:"Latest inventory activities",min:"Min",max:"Max",cost:"Cost",noProductsFound:"No products found matching your search.",noProductsAvailable:"No products available.",noLocationsFound:"No locations found matching your search.",noLocationsAvailable:"No locations available.",searchPlaceholder:"Search by product, location, reference, notes, invoice...",noMovementsFound:"No movements found",tryAdjustingFilters:"Try adjusting your filters or check back later.",transfers:"Transfers",adjustments:"Adjustments",bulk:"Bulk",product:"Product",location:"Location",store:"Store",supplier:"Supplier",warehouse:"Warehouse",movement:"Movement",editMovement:"Edit Movement",updateMovement:"Update Movement",movementInformation:"Movement Information",locationInformation:"Location Information",searchProductsImages:"Search products to view images...",searchForProducts:"Search for Products",startTypingToSearch:"Start typing to search and view product images",tryDifferentSearch:"Try a different search term"},employees:{title:"Employee Management",employeeList:"Employee List",addEmployee:"Add Employee",editEmployee:"Edit Employee",employeeDetails:"Employee Details",personalInfo:"Personal Information",employmentInfo:"Employment Information",payrollInfo:"Payroll Information",firstName:"First Name",lastName:"Last Name",fullName:"Full Name",email:"Email",phone:"Phone",address:"Address",dateOfBirth:"Date of Birth",employeeId:"Employee ID",department:"Department",position:"Position",hireDate:"Hire Date",employmentStatus:"Employment Status",salary:"Salary",payFrequency:"Pay Frequency",taxId:"Tax ID",bankAccount:"Bank Account",emergencyContact:"Emergency Contact",activeEmployees:"Active Employees",inactiveEmployees:"Inactive Employees",totalPayroll:"Total Payroll",searchEmployees:"Search employees...",enterFullName:"Enter employee's full name",enterPosition:"Enter job position",enterEmail:"Enter email address",enterPhone:"Enter phone number",enterSalary:"Enter annual salary",departments:{engineering:"Engineering",product:"Product",design:"Design",marketing:"Marketing",sales:"Sales",humanResources:"Human Resources",finance:"Finance",operations:"Operations",analytics:"Analytics"}},entryBooks:{title:"Entry Books",bookName:"Book Name",bookType:"Book Type",createBook:"Create Book",editBook:"Edit Book",salesBook:"Sales Book",purchaseBook:"Purchase Book",cashBook:"Cash Book",generalBook:"General Book",entries:"Entries",addEntry:"Add Entry",period:"Period",startDate:"Start Date",endDate:"End Date",bookBalance:"Book Balance",reconciledBalance:"Reconciled Balance",difference:"Difference",reconcile:"Reconcile",isReconciled:"Is Reconciled",noBooks:"No entry books found",createFirst:"Create your first entry book to get started",bookDetails:"Book Details",entriesCount:"entries",bookOverview:"Book overview and details",bookEntries:"Book Entries",allEntries:"All entries in this book",noEntries:"No entries found",addFirst:"Add your first entry to this book",entryDate:"Entry Date",entryDescription:"Entry Description",entryAmount:"Entry Amount",entryReference:"Entry Reference",subtitle:"Manage accounting entries and general ledger records",viewReconciliation:"View Reconciliation",totalEntries:"Total Entries",allJournalEntries:"All journal entries",postedEntriesOnly:"Posted entries only",fromPostedEntries:"From {count} posted entries",needBankReconciliation:"Need bank reconciliation",allReconciled:"All reconciled",sortBy:"Sort By",fromDate:"From Date",toDate:"To Date",order:"Order",newest:"Newest",oldest:"Oldest",resetFilters:"Reset Filters",activeFilters:"Active filters",from:"From",to:"To",entriesFound:"{count} entries found",noJournalEntries:"No Journal Entries",startByCreating:"Start by creating your first entry",noEntriesMatch:"No journal entries match your current filters.",createFirstEntry:"Create First Entry",void:"Void",confirmVoid:"Are you sure you want to void this journal entry?",entryBookRecords:"Entry Book Records"},banking:{title:"Bank Consolidation",bankAccount:"Bank Account",statementDate:"Statement Date",beginningBalance:"Beginning Balance",endingBalance:"Ending Balance",deposits:"Deposits",withdrawals:"Withdrawals",bankCharges:"Bank Charges",interest:"Interest",reconcile:"Reconcile",matched:"Matched",unmatched:"Unmatched",importStatement:"Import Statement",manualEntry:"Manual Entry",autoMatch:"Auto Match",clearAll:"Clear All",reconciliationStatus:"Reconciliation Status",difference:"Difference",bookBalance:"Book Balance",statementBalance:"Statement Balance",outstandingChecks:"Outstanding Checks",depositsInTransit:"Deposits in Transit",reconciled:"Reconciled",notReconciled:"Not Reconciled",unreconciled:"Unreconciled",reconciliation:"Reconciliation",compareStatements:"Compare bank statements with entry book records",importCSV:"Import CSV",startNewReconciliation:"Start New Reconciliation",bankAccountInfo:"Bank Account Info",currentAccountDetails:"Current account details",lastReconciled:"Last reconciled",bankTransactions:"Bank Transactions",selectedPeriod:"Selected period",pending:"pending",bookEntriesForComparison:"Book entries for comparison",reconciliationRate:"Reconciliation Rate",completionStatus:"Completion status",recentReconciliationSessions:"Recent Reconciliation Sessions",latestActivity:"Latest activity",noRecentSessions:"No recent reconciliation sessions found.",startFirstReconciliation:"Start First Reconciliation",entryBookRecords:"Entry Book Records",pleaseUploadCSV:"Please upload a CSV file",csvRequiresHeaderAndData:"CSV file must have at least a header and one data row",successfullyParsed:"Successfully parsed {count} rows",errorParsingCSV:"Error parsing CSV file. Please check the format.",dateDescriptionRequired:"Date and Description columns are required",importedTransaction:"Imported transaction",successfullyImported:"Successfully imported {count} bank transactions",errorImportingTransactions:"Error importing transactions. Please check your data.",importBankStatementCSV:"Import Bank Statement CSV",dropCSVHere:"Drop CSV file here",clickToUploadCSV:"Click to upload or drag and drop CSV file",supportedFormat:"Supported format: CSV with Date, Description, and Amount columns",mapCSVColumns:"Map CSV Columns",dateColumn:"Date Column",selectColumn:"Select column...",descriptionColumn:"Description Column",referenceColumn:"Reference Column",amountDebitColumn:"Amount/Debit Column",creditColumn:"Credit Column",balanceColumn:"Balance Column",andMoreRows:"... and {count} more rows",importing:"Importing...",importTransactions:"Import {count} Transactions",reconciliationComparison:"Reconciliation Comparison",bankStatements:"Bank Statements",totalTransactions:"Total transactions",totalEntries:"Total entries",unreconciledBank:"Unreconciled Bank",unreconciledBooks:"Unreconciled Books",needAttention:"Need attention",unreconcile:"Unreconcile",clickToReconcile:"Click to reconcile",potentialMatchesFound:"Potential Matches Found",clickRecordToReconcile:"Click on a record below to reconcile",exactMatch:"Exact Match",possibleMatch:"Possible Match",selected:"Selected",clearSelection:"Clear Selection"},journal:{title:"Journal Entries",entryNumber:"Entry Number",entryDate:"Entry Date",debit:"Debit",credit:"Credit",account:"Account",memo:"Memo",reference:"Reference",createEntry:"Create Entry",editEntry:"Edit Entry",deleteEntry:"Delete Entry",posted:"Posted",draft:"Draft",reversed:"Reversed",recurringEntry:"Recurring Entry",attachments:"Attachments",totalDebits:"Total Debits",totalCredits:"Total Credits",outOfBalance:"Out of Balance",balanced:"Balanced",addEntry:"Add Journal Entry",allEntries:"All Entries",totalDebit:"Total Debit",totalCredit:"Total Credit",debitShort:"Dr.",creditShort:"Cr.",noReference:"No reference",createdBy:"By",totalAmount:"Total Amount",lines:"Lines",entryNotBalancedShort:"Entry is not balanced",accountLines:"Account Lines",noDescription:"No description",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryLines:"Journal Entry Lines",addLine:"Add Line",lineDescription:"Line description",notBalanced:"Not Balanced",updateEntry:"Update Entry",saveAsDraft:"Save as Draft",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",editEntryTooltip:"Edit this journal entry",post:"Post",entryMustBeBalanced:"Entry must be balanced to post",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",journalLines:"Journal Lines",balanceStatus:"Balance Status",unbalanced:"Unbalanced",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",postEntry:"Post Entry",fixBalance:"Fix Balance",voidEntry:"Void Entry",draftEntry:"Draft Entry",draftEntryDescription:"This entry can be edited and posted.",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",postedEntry:"Posted Entry",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",minTwoLinesRequired:"At least 2 line items are required",entryNotBalanced:"Entry is not balanced. Debit: ${debit}, Credit: ${credit}",lineAccountRequired:"Line {lineNumber}: Account is required",lineAmountRequired:"Line {lineNumber}: Either debit or credit amount must be provided",lineBothAmounts:"Line {lineNumber}: Cannot have both debit and credit amounts",enterEntryDescription:"Enter journal entry description",enterReferenceNumber:"Enter reference number"},invoices:{title:"Invoice Dashboard",invoice:"Invoice",invoiceNumber:"Invoice Number",invoiceDetails:"Invoice Details",customerInformation:"Customer Information",customerName:"Customer Name",legalName:"Legal Name",contactInformation:"Contact Information",idPassport:"ID/Passport",phoneNumber:"Phone Number",altPhone:"Alt Phone",address:"Address",between:"Between",and:"and",products:"Products",reservations:"Reservations",unitPrice:"Unit Price",total:"Total",subtotal:"Subtotal",totalRevenue:"Total Revenue",totalProducts:"Total Products",totalReservations:"Total Reservations",aranceles:"Aranceles (Customs)",uniqueCustomers:"Unique Customers",averageInvoice:"Average Invoice",completed:"Completed",pending:"Pending",storesActive:"Stores Active",topProducts:"Top Products",mostSoldProducts:"Most sold products by quantity",reservationsByType:"Reservations by Type",distributionOfCategories:"Distribution of reservation categories",recentInvoices:"Recent Invoices",showingInvoices:"Showing {{count}} invoices",date:"Date",customer:"Customer",store:"Store",actions:"Actions",view:"View",status:"Status",printInvoice:"Print Invoice",exportPdf:"Export PDF",backToDashboard:"Back to Dashboard",fromInvoices:"From {{count}} invoices",value:"value",activeCustomers:"Active customers",perInvoiceValue:"Per invoice value",locations:"Locations",mostRecentActivity:"Most recent activity",storeLocation:"Store Location",allStores:"All Stores",fromDate:"From Date",toDate:"To Date",clearFilters:"Clear Filters",customsFees:"Total customs fees",salesType:"SALES",packagesOrder:"Packages Order",businessId:"Business ID",orderKey:"Order Key",reservationType:"Reservation Type",arancel:"Arancel",key:"Key",noInvoicesFound:"No invoices found",loadingInvoices:"Loading invoices...",errorLoadingInvoices:"Error loading invoices",refreshData:"Refresh Data",currentStockValue:"Current Stock Value",filterByStore:"Filter by store",filterByDate:"Filter by date range",totalCustomsFees:"Total customs fees",averageValue:"Average value",senderInformation:"Sender Information",receiptInformation:"Receipt Information",productsSubtotal:"Products Subtotal",reservationsSubtotal:"Reservations Subtotal",code:"Code",description:"Description",qty:"Qty",type:"Type",id:"ID",passport:"Passport"},forms:{requiredField:"This field is required",invalidEmail:"Invalid email address",invalidNumber:"Invalid number",invalidDate:"Invalid date",selectOption:"Please select an option",enterValue:"Please enter a value",confirmDelete:"Are you sure you want to delete this item?",unsavedChanges:"You have unsaved changes. Do you want to continue?",saveSuccess:"Saved successfully",saveError:"Error saving data",deleteSuccess:"Deleted successfully",deleteError:"Error deleting item",duplicateAccountNumber:"Account number already exists",descriptionRequired:"Description is required",errorOccurred:"An error occurred",errorPostingEntry:"An error occurred while posting the entry"},modals:{addInventory:"Add Inventory Movement",bulkMovement:"Bulk Inventory Movement",addProduct:"Add New Product",addLocation:"Add New Location",inventoryDetail:"Inventory Item Details",quickAdd:"Quick Add",selectProduct:"Select Product",selectLocation:"Select Location",enterQuantity:"Enter quantity",enterCost:"Enter unit cost",enterReference:"Enter reference number",addNotes:"Add notes (optional)",generalInformation:"General Information",stockInformation:"Stock Information",locationInformation:"Location Information",movementInformation:"Movement Information",addToInventory:"Add to Inventory",createProduct:"Create Product",createLocation:"Create Location",processing:"Processing...",addingMovement:"Adding movement...",creatingProduct:"Creating product...",creatingLocation:"Creating location..."},products:{title:"Products",addNew:"Add New Product",totalProducts:"Total Products",inCatalog:"In catalog",activeProducts:"Active Products",currentlyAvailable:"Currently available",outOfStock:"Out of Stock",needsRestock:"Needs restock",productCatalog:"Product Catalog",manageYourProducts:"Manage your products and pricing",inStock:"In Stock",furniture:"Furniture",electronics:"Electronics",supplies:"Supplies",lighting:"Lighting",searchPlaceholder:"Search products by name, SKU, or category...",allCategories:"All Categories",clearFilters:"Clear filters",noResults:"No products found matching your criteria.",noProducts:"No products available.",showing:"Showing",filtered:"Filtered results",allProducts:"All products",searchResult:"Search Result",stock:"Stock",lowStock:"Low Stock"},invoices:{title:"Invoices",createNew:"Create New Invoice",totalOutstanding:"Total Outstanding",unpaidInvoices:"Unpaid invoices",thisMonth:"This Month",revenueCollected:"Revenue collected",overdue:"Overdue",pastDueInvoices:"Past due invoices",recentInvoices:"Recent Invoices",latestBillingActivity:"Latest billing activity",paid:"Paid",pending:"Pending"},unauthorized:{title:"Access Restricted",accessDenied:"Access Denied",noPermission:"You don't have permission to access",thisFeature:"this feature",whySeeing:"Why am I seeing this?",explanation:"Your account doesn't have the necessary permissions to view this content.",requiredPermission:"Required permission:",goToDashboard:"Go to Dashboard",goBack:"Go Back",featuresCanAccess:"Features you can access:",dashboardAccess:"Dashboard and overview statistics",profileAccess:"Your profile and settings",roleBasedAccess:"Features enabled for your role",needAccess:"Need access? Contact your administrator or manager to request the appropriate permissions.",permissions:{accountAccess:"Account Management Access",inventoryAccess:"Inventory Access",employeeAccess:"HR Access",bankingAccess:"Banking Access",journalAccess:"Journal Entry Access",adminAccess:"Administrative Access",financialReporting:"Financial Reporting Access",invoiceManagement:"Invoice Management Access",productManagement:"Product Management Access"}}},es:{common:{save:"Guardar",cancel:"Cancelar",delete:"Eliminar",edit:"Editar",add:"Agregar",close:"Cerrar",search:"Buscar",filter:"Filtrar",reset:"Restablecer",back:"Atrs",next:"Siguiente",previous:"Anterior",yes:"S",no:"No",loading:"Cargando...",error:"Error",success:"xito",warning:"Advertencia",info:"Informacin",confirm:"Confirmar",actions:"Acciones",status:"Estado",active:"Activo",inactive:"Inactivo",date:"Fecha",time:"Hora",description:"Descripcin",notes:"Notas",amount:"Monto",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Idioma",english:"Ingls",spanish:"Espaol",noDataFound:"No se encontraron datos",required:"Requerido",optional:"Opcional",all:"Todos",none:"Ninguno",select:"Seleccionar",clear:"Limpiar",view:"Ver",suggested:"Sugerido",clearFilters:"Limpiar Filtros",enhanced:"Mejorado",legacy:"Clsico",email:"Correo Electrnico",phone:"Telfono",address:"Direccin",name:"Nombre",code:"Cdigo",category:"Categora",type:"Tipo",quantity:"Cantidad",price:"Precio",cost:"Costo",value:"Valor",balance:"Saldo",created:"Creado",modified:"Modificado",details:"Detalles",summary:"Resumen",history:"Historial",new:"Nuevo",addNew:"Agregar Nuevo",unknown:"Desconocido",notAvailable:"N/A",remove:"Remover",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",from:"De",invoice:"Factura",invoices:"facturas",reference:"Referencia",createdBy:"Creado Por",units:"unidades",invoiceDocumentId:"ID de Factura/Documento",referenceNumber:"Nmero de Referencia",referenceNumberPlaceholder:"Ingrese nmero de referencia...",generalNotes:"Notas Generales",auto:"Auto",optionalNotes:"Notas opcionales...",showPerPage:"Mostrar por pgina",first:"Primera",last:"ltima",pageOfPages:"Pgina {{current}} de {{total}}",showingXofY:"Mostrando {{start}}-{{end}} de {{total}}",page:"Pgina",of:"de",lbs:"libras"},forms:{referenceNumberRequired:"El nmero de referencia es requerido",locationRequired:"La ubicacin es requerida",fromLocationRequired:"La ubicacin de origen es requerida para transferencias",atLeastOneProduct:"Al menos un producto es requerido",itemProductRequired:"El producto es requerido para el artculo {{index}}",itemQuantityRequired:"La cantidad debe ser mayor que 0 para el artculo {{index}}"},navigation:{dashboard:"Panel de Control",accounts:"Plan de Cuentas",balanceSheet:"Balance General",inventory:"Inventario",employees:"Empleados",entryBooks:"Libros de Entrada",consolidate:"Consolidacin Bancaria",reports:"Reportes",settings:"Configuracin"},dashboard:{title:"Panel de Control",welcome:"Bienvenido a HRM Finance",totalRevenue:"Ingresos Totales",overview:"Resumen",recentActivity:"Actividad Reciente",quickActions:"Acciones Rpidas",employeeCount:"Nmero de Empleados",pendingInvoices:"Facturas Pendientes",cashBalance:"Saldo en Efectivo",totalAssets:"Activos Totales",totalLiabilities:"Pasivos Totales",totalExpenses:"Gastos Totales",netIncome:"Ingreso Neto",netLoss:"Prdida Neta",monthlyPayroll:"Nmina Mensual",current:"Actual",newHires:"+3 nuevas contrataciones",outstanding:"Pendiente",totalOutstanding:"$23,450 total",lastUpdatedToday:"ltima actualizacin hoy",commonTasks:"Tareas comunes",generateReport:"Generar Reporte",latestUpdates:"ltimas actualizaciones",invoicePaid:"Factura #1234 pagada",hoursAgo:"hace 2 horas",newEmployeeOnboarded:"Nuevo empleado incorporado",dayAgo:"hace 1 da",monthlyReportGenerated:"Reporte mensual generado",daysAgo:"hace 2 das"},accounts:{title:"Plan de Cuentas",accountNumber:"Nmero de Cuenta",accountName:"Nombre de Cuenta",accountType:"Tipo de Cuenta",category:"Categora",balance:"Saldo",parentAccount:"Cuenta Padre",subAccounts:"Subcuentas",addAccount:"Agregar Cuenta",editAccount:"Editar Cuenta",deleteAccount:"Eliminar Cuenta",accountDetails:"Detalles de Cuenta",transactions:"Transacciones",accountHistory:"Historial de Cuenta",backToAccounts:"Volver a Cuentas",accountNotFound:"Cuenta no encontrada",accountInformation:"Informacin de Cuenta",accountPurpose:"Propsito de la cuenta",transactionHistory:"Historial de Transacciones",noTransactions:"No se encontraron transacciones para esta cuenta",createdDate:"Fecha de Creacin",lastModified:"ltima Modificacin",noDescription:"No se proporcion descripcin.",totalCount:"Conteo total",basicDetails:"Detalles bsicos",currentBalance:"Saldo actual",classification:"Clasificacin",allTransactions:"Todas las transacciones de la cuenta",reference:"Referencia",types:{asset:"Activo",liability:"Pasivo",equity:"Patrimonio",revenue:"Ingreso",expense:"Gasto"},categories:{currentAssets:"Activos Corrientes",fixedAssets:"Activos Fijos",currentLiabilities:"Pasivos Corrientes",longTermLiabilities:"Pasivos a Largo Plazo",ownersEquity:"Patrimonio del Propietario",operatingRevenue:"Ingresos Operacionales",operatingExpenses:"Gastos Operacionales"}},inventory:{title:"Gestin de Inventario",overview:"Resumen",products:"Productos y Stock",movements:"Movimientos",locations:"Ubicaciones",bulkMovement:"Movimiento Masivo",addMovement:"Agregar Movimiento",addProduct:"Agregar Producto",addLocation:"Agregar Ubicacin",singleMovement:"Agregar Movimiento Individual",addNewItem:"Agregar Nuevo Artculo",activeProducts:"Productos Activos",lowStockAlert:"Artculos con Stock Bajo",totalValue:"Valor Total del Stock",activeLocations:"Ubicaciones Activas",productsNeedRestocking:"productos necesitan reabastecimiento",recentMovements:"Movimientos Recientes",noProducts:"No hay productos en esta ubicacin",productName:"Nombre del Producto",productCode:"Cdigo del Producto",sku:"SKU",category:"Categoria",unitOfMeasure:"Unidad de Medida",unitCost:"Costo Unitario",minStockLevel:"Nivel Mnimo de Stock",maxStockLevel:"Nivel Mximo de Stock",locationName:"Nombre de Ubicacin",locationType:"Tipo de Ubicacin",locationCode:"Cdigo de Ubicacin",movementType:"Tipo de Movimiento",referenceNumber:"Nmero de Referencia",invoiceNumber:"Nmero de Factura",fromLocation:"Desde Ubicacin",toLocation:"Hacia Ubicacin",stockIn:"Entrada de Stock",stockOut:"Salida de Stock",transfer:"Transferencia",adjustment:"Ajuste",inStock:"En Stock",lowStock:"Stock Bajo",outOfStock:"Sin Stock",stockLevels:"Niveles de Stock",stockByLocation:"Stock por Ubicacin",searchProducts:"Buscar productos...",searchLocations:"Buscar ubicaciones...",noMovements:"No se encontraron movimientos",productDetails:"Detalles del Producto",locationDetails:"Detalles de Ubicacin",movementDetails:"Detalles del Movimiento",totalProducts:"Total de Productos",totalLocations:"Total de Ubicaciones",lastSeen:"Visto por ltima vez",warehouseType:"Almacn",storeType:"Tienda",supplierType:"Proveedor",customerType:"Cliente",currentlyManaged:"Gestionados actualmente",needAttention:"Necesitan atencin",currentWorth:"Valor actual",warehousesStores:"Almacenes y tiendas",thisMonth:"Este Mes",latestActivities:"ltimas actividades de inventario",searchMovements:"Buscar Movimientos",countingSheet:"Hoja de Conteo",physicalCount:"Conteo Fsico",physicalInventoryCount:"Conteo Fsico de Inventario",setupPhysicalCount:"Configurar Conteo Fsico de Inventario",setupDescription:"Configure los ajustes de su conteo fsico de inventario y comience el proceso de conteo.",countWillInclude:"Este conteo incluir {{count}} productos de {{location}} en la categora {{category}}.",startCounting:"Iniciar Conteo Fsico",counted:"Contado",remaining:"Restante",variances:"Variaciones",complete:"Completo",systemQty:"Cant. Sistema",variance:"Variacin",addNotes:"Agregar notas...",reviewAndConfirm:"Revisar y Confirmar Ajustes",reviewDescription:"Revise los ajustes de inventario a continuacin y confirme para actualizar su sistema.",stockIncreases:"Aumentos de Stock",stockDecreases:"Disminuciones de Stock",totalAdjustments:"Ajustes Totales",confirmAdjustments:"Confirmar Ajustes",adjustment:"Ajuste",perfectCount:"Conteo Perfecto!",noVariances:"No se encontraron variaciones. Su conteo fsico coincide exactamente con el sistema.",physicalCountAdjustment:"Ajuste de conteo fsico",inventoryCountingSheetTitle:"HOJA DE CONTEO DE INVENTARIO",location:"Ubicacin",allCategories:"Todas las Categoras",countedBy:"Contado por",verifiedBy:"Verificado por",instructions:"Instrucciones",countInstructions:["Contar todos los artculos fsicamente presentes en esta ubicacin",'Escribir el conteo real en la columna "Conteo Fsico"',"Dejar en blanco si el artculo no se encuentra",'Anotar cualquier discrepancia en la columna "Notas"',"Firmar y fechar cuando est completo"],productName:"Nombre del Producto",unit:"Unidad",totalProductsListed:"Total de Productos Listados",itemsCounted:"Artculos Contados",summaryFor:"RESUMEN PARA",discrepanciesFound:"Discrepancias Encontradas",counterSignature:"Firma del Contador",supervisorSignature:"Firma del Supervisor",downloadCSV:"Descargar CSV",noAdjustmentsToDownload:"No hay ajustes para descargar",stockIncrease:"Aumento de Stock",stockDecrease:"Disminucin de Stock",purchaseReceive:"Compra/Recepcin",saleIssue:"Venta/Emisin",transfer:"Transferencia",adjustment:"Ajuste",movementType:"Tipo de Movimiento",fromLocation:"Ubicacin de Origen",toLocation:"Ubicacin de Destino",searchSourceLocation:"Buscar ubicacin de origen...",searchDestinationLocation:"Buscar ubicacin de destino...",searchLocation:"Buscar ubicacin...",addProduct:"Agregar Producto",searchProduct:"Buscar producto...",unitCost:"Costo Unitario",noProductsAdded:'No se han agregado productos an. Haga clic en "Agregar Producto" para comenzar.',createMovement:"Crear Movimiento",generalNotesPlaceholder:"Ingrese notas generales para este movimiento...",sortBy:"Ordenar Por",allLocations:"Todas las Ubicaciones",searchByProduct:"Buscar por producto, ubicacin, referencia, notas, factura...",allProducts:"Todos los Productos",allTypes:"Todos los Tipos",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",totalMovements:"Movimientos Totales",totalItems:"Artculos Totales",adjustMovements:"Intenta ajustar tus filtros o revisa ms tarde.",inventoryMovements:"Movimientos de Inventario",createdBy:"Creado Por",view:"Ver",enhanced:"Mejorado",legacy:"Clsico",addSingleMovement:"Agregar Movimiento Individual",inStockSubtitle:"En stock",itemsBelowThreshold:"Artculos bajo el umbral",inventoryWorth:"Valor del inventario",quantity:"Cantidad",units:"unidades",normal:"Normal",productsAndStock:"Productos y Stock",lowStockItems:"Artculos con Stock Bajo",totalStockValue:"Valor Total del Stock",warehousesAndStores:"Almacenes y tiendas",andMore:"...y {count} ms",latestInventoryActivities:"ltimas actividades de inventario",min:"Mn",max:"Mx",cost:"Costo",noProductsFound:"No se encontraron productos que coincidan con su bsqueda.",noProductsAvailable:"No hay productos disponibles.",noLocationsFound:"No se encontraron ubicaciones que coincidan con su bsqueda.",noLocationsAvailable:"No hay ubicaciones disponibles.",searchPlaceholder:"Buscar por producto, ubicacin, referencia, notas, factura...",noMovementsFound:"No se encontraron movimientos",tryAdjustingFilters:"Intenta ajustar tus filtros o revisa ms tarde.",transfers:"Transferencias",adjustments:"Ajustes",bulk:"Masivo",product:"Producto",location:"Ubicacin",store:"Tienda",supplier:"Proveedor",warehouse:"Almacn",movement:"Movimiento",editMovement:"Editar Movimiento",updateMovement:"Actualizar Movimiento",movementInformation:"Informacin del Movimiento",locationInformation:"Informacin de Ubicacin",searchProductsImages:"Buscar productos para ver imgenes...",searchForProducts:"Buscar Productos",startTypingToSearch:"Comienza a escribir para buscar y ver imgenes de productos",tryDifferentSearch:"Prueba con un trmino de bsqueda diferente"},employees:{title:"Gestin de Empleados",employeeList:"Lista de Empleados",addEmployee:"Agregar Empleado",editEmployee:"Editar Empleado",employeeDetails:"Detalles del Empleado",personalInfo:"Informacin Personal",employmentInfo:"Informacin Laboral",payrollInfo:"Informacin de Nmina",firstName:"Nombre",lastName:"Apellido",fullName:"Nombre Completo",email:"Correo Electrnico",phone:"Telfono",address:"Direccin",dateOfBirth:"Fecha de Nacimiento",employeeId:"ID de Empleado",department:"Departamento",position:"Puesto",hireDate:"Fecha de Contratacin",employmentStatus:"Estado Laboral",salary:"Salario",payFrequency:"Frecuencia de Pago",taxId:"ID Fiscal",bankAccount:"Cuenta Bancaria",emergencyContact:"Contacto de Emergencia",activeEmployees:"Empleados Activos",inactiveEmployees:"Empleados Inactivos",totalPayroll:"Nmina Total",searchEmployees:"Buscar empleados...",enterFullName:"Ingrese el nombre completo del empleado",enterPosition:"Ingrese el puesto de trabajo",enterEmail:"Ingrese la direccin de correo electrnico",enterPhone:"Ingrese el nmero de telfono",enterSalary:"Ingrese el salario anual",departments:{engineering:"Ingeniera",product:"Producto",design:"Diseo",marketing:"Marketing",sales:"Ventas",humanResources:"Recursos Humanos",finance:"Finanzas",operations:"Operaciones",analytics:"Analtica"}},entryBooks:{title:"Libros de Entrada",bookName:"Nombre del Libro",bookType:"Tipo de Libro",createBook:"Crear Libro",editBook:"Editar Libro",salesBook:"Libro de Ventas",purchaseBook:"Libro de Compras",cashBook:"Libro de Caja",generalBook:"Libro General",entries:"Entradas",addEntry:"Agregar Entrada",period:"Perodo",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",bookBalance:"Saldo del Libro",reconciledBalance:"Saldo Conciliado",difference:"Diferencia",reconcile:"Conciliar",isReconciled:"Est Conciliado",noBooks:"No se encontraron libros de entrada",createFirst:"Crea tu primer libro de entrada para comenzar",bookDetails:"Detalles del Libro",entriesCount:"entradas",bookOverview:"Resumen y detalles del libro",bookEntries:"Entradas del Libro",allEntries:"Todas las entradas en este libro",noEntries:"No se encontraron entradas",addFirst:"Agrega tu primera entrada a este libro",entryDate:"Fecha de Entrada",entryDescription:"Descripcin de Entrada",entryAmount:"Monto de Entrada",entryReference:"Referencia de Entrada"},banking:{title:"Consolidacin Bancaria",bankAccount:"Cuenta Bancaria",statementDate:"Fecha del Estado",beginningBalance:"Saldo Inicial",endingBalance:"Saldo Final",deposits:"Depsitos",withdrawals:"Retiros",bankCharges:"Cargos Bancarios",interest:"Intereses",reconcile:"Conciliar",matched:"Conciliado",unmatched:"No Conciliado",importStatement:"Importar Estado",manualEntry:"Entrada Manual",autoMatch:"Coincidencia Automtica",clearAll:"Limpiar Todo",reconciliationStatus:"Estado de Conciliacin",difference:"Diferencia",bookBalance:"Saldo en Libros",statementBalance:"Saldo del Estado",outstandingChecks:"Cheques Pendientes",depositsInTransit:"Depsitos en Trnsito",reconciled:"Conciliado",notReconciled:"No Conciliado",unreconciled:"No Conciliado",reconciliation:"Conciliacin",compareStatements:"Comparar estados bancarios con registros de libros de entrada",importCSV:"Importar CSV",startNewReconciliation:"Iniciar Nueva Conciliacin",bankAccountInfo:"Informacin de Cuenta Bancaria",currentAccountDetails:"Detalles de cuenta actual",lastReconciled:"ltima conciliacin",bankTransactions:"Transacciones Bancarias",selectedPeriod:"Perodo seleccionado",pending:"pendiente",bookEntriesForComparison:"Entradas de libros para comparacin",reconciliationRate:"Tasa de Conciliacin",completionStatus:"Estado de finalizacin",recentReconciliationSessions:"Sesiones de Conciliacin Recientes",latestActivity:"Actividad reciente",noRecentSessions:"No se encontraron sesiones de conciliacin recientes.",startFirstReconciliation:"Iniciar Primera Conciliacin",entryBookRecords:"Registros de Libros de Entrada",pleaseUploadCSV:"Por favor suba un archivo CSV",csvRequiresHeaderAndData:"El archivo CSV debe tener al menos un encabezado y una fila de datos",successfullyParsed:"Se analizaron exitosamente {count} filas",errorParsingCSV:"Error al analizar el archivo CSV. Verifique el formato.",dateDescriptionRequired:"Las columnas de Fecha y Descripcin son requeridas",importedTransaction:"Transaccin importada",successfullyImported:"Se importaron exitosamente {count} transacciones bancarias",errorImportingTransactions:"Error al importar transacciones. Verifique sus datos.",importBankStatementCSV:"Importar CSV de Estado Bancario",dropCSVHere:"Suelte el archivo CSV aqu",clickToUploadCSV:"Haga clic para cargar o arrastre y suelte el archivo CSV",supportedFormat:"Formato soportado: CSV con columnas de Fecha, Descripcin y Monto",mapCSVColumns:"Mapear Columnas CSV",dateColumn:"Columna de Fecha",selectColumn:"Seleccionar columna...",descriptionColumn:"Columna de Descripcin",referenceColumn:"Columna de Referencia",amountDebitColumn:"Columna de Monto/Dbito",creditColumn:"Columna de Crdito",balanceColumn:"Columna de Saldo",andMoreRows:"... y {count} filas ms",importing:"Importando...",importTransactions:"Importar {count} Transacciones",reconciliationComparison:"Comparacin de Conciliacin",bankStatements:"Estados Bancarios",totalTransactions:"Transacciones totales",totalEntries:"Entradas totales",unreconciledBank:"Banco No Conciliado",unreconciledBooks:"Libros No Conciliados",needAttention:"Necesitan atencin",unreconcile:"Desconciliar",clickToReconcile:"Hacer clic para conciliar",potentialMatchesFound:"Coincidencias Potenciales Encontradas",clickRecordToReconcile:"Haga clic en un registro a continuacin para conciliar",exactMatch:"Coincidencia Exacta",possibleMatch:"Posible Coincidencia",selected:"Seleccionado",clearSelection:"Limpiar Seleccin"},journal:{title:"Asientos Contables",entryNumber:"Nmero de Asiento",entryDate:"Fecha del Asiento",debit:"Dbito",credit:"Crdito",account:"Cuenta",memo:"Memo",reference:"Referencia",createEntry:"Crear Asiento",editEntry:"Editar Asiento",deleteEntry:"Eliminar Asiento",posted:"Registrado",draft:"Borrador",reversed:"Revertido",recurringEntry:"Asiento Recurrente",attachments:"Adjuntos",totalDebits:"Dbitos Totales",totalCredits:"Crditos Totales",outOfBalance:"Desbalanceado",balanced:"Balanceado"},forms:{requiredField:"Este campo es requerido",invalidEmail:"Direccin de correo invlida",invalidNumber:"Nmero invlido",invalidDate:"Fecha invlida",selectOption:"Por favor seleccione una opcin",enterValue:"Por favor ingrese un valor",confirmDelete:"Est seguro de que desea eliminar este elemento?",unsavedChanges:"Tiene cambios sin guardar. Desea continuar?",saveSuccess:"Guardado exitosamente",saveError:"Error al guardar datos",deleteSuccess:"Eliminado exitosamente",deleteError:"Error al eliminar elemento",duplicateAccountNumber:"El nmero de cuenta ya existe"},modals:{addInventory:"Agregar Movimiento de Inventario",bulkMovement:"Movimiento Masivo de Inventario",addProduct:"Agregar Nuevo Producto",addLocation:"Agregar Nueva Ubicacin",inventoryDetail:"Detalles del Artculo de Inventario",quickAdd:"Agregar Rpido",selectProduct:"Seleccionar Producto",selectLocation:"Seleccionar Ubicacin",enterQuantity:"Ingresar cantidad",enterCost:"Ingresar costo unitario",enterReference:"Ingresar nmero de referencia",addNotes:"Agregar notas (opcional)",generalInformation:"Informacin General",stockInformation:"Informacin de Stock",locationInformation:"Informacin de Ubicacin",movementInformation:"Informacin de Movimiento",addToInventory:"Agregar al Inventario",createProduct:"Crear Producto",createLocation:"Crear Ubicacin",processing:"Procesando...",addingMovement:"Agregando movimiento...",creatingProduct:"Creando producto...",creatingLocation:"Creando ubicacin..."},products:{title:"Productos",addNew:"Agregar Nuevo Producto",totalProducts:"Total de Productos",inCatalog:"En catlogo",activeProducts:"Productos Activos",currentlyAvailable:"Actualmente disponibles",outOfStock:"Sin Stock",needsRestock:"Necesita reabastecimiento",productCatalog:"Catlogo de Productos",manageYourProducts:"Gestiona tus productos y precios",inStock:"En Stock",furniture:"Muebles",electronics:"Electrnicos",supplies:"Suministros",lighting:"Iluminacin"},invoices:{title:"Panel de Facturas",invoice:"Factura",invoiceNumber:"Nmero de Factura",invoiceDetails:"Detalles de Factura",customerInformation:"Informacin del Cliente",customerName:"Nombre del Cliente",legalName:"Nombre Legal",contactInformation:"Informacin de Contacto",idPassport:"ID/Pasaporte",phoneNumber:"Nmero de Telfono",altPhone:"Telfono Alt.",address:"Direccin",between:"Entre",and:"y",products:"Productos",reservations:"Reservaciones",unitPrice:"Precio Unitario",total:"Total",subtotal:"Subtotal",category:"Categoria",totalRevenue:"Ingresos Totales",totalProducts:"Total de Productos",totalReservations:"Total de Reservaciones",aranceles:"Aranceles (Aduanas)",uniqueCustomers:"Clientes nicos",averageInvoice:"Factura Promedio",completed:"Completada",pending:"Pendiente",storesActive:"Tiendas Activas",topProducts:"Productos Principales",mostSoldProducts:"Productos ms vendidos por cantidad",reservationsByType:"Reservaciones por Tipo",distributionOfCategories:"Distribucin de categoras de reservaciones",recentInvoices:"Facturas Recientes",showingInvoices:"Mostrando {{count}} facturas",date:"Fecha",customer:"Cliente",store:"Tienda",actions:"Acciones",view:"Ver",status:"Estado",printInvoice:"Imprimir Factura",exportPdf:"Exportar PDF",backToDashboard:"Volver al Panel",fromInvoices:"De {{count}} facturas",value:"valor",activeCustomers:"Clientes activos",perInvoiceValue:"Valor por factura",locations:"Ubicaciones",mostRecentActivity:"Actividad ms reciente",storeLocation:"Ubicacin de Tienda",allStores:"Todas las Tiendas",fromDate:"Fecha Desde",toDate:"Fecha Hasta",clearFilters:"Limpiar Filtros",customsFees:"Aranceles totales",salesType:"VENTAS",packagesOrder:"Orden de Paquetes",businessId:"ID de Negocio",orderKey:"Clave de Orden",reservationType:"Tipo de Reservacin",arancel:"Arancel",key:"Clave",noInvoicesFound:"No se encontraron facturas",loadingInvoices:"Cargando facturas...",errorLoadingInvoices:"Error al cargar facturas",refreshData:"Actualizar Datos",currentStockValue:"Valor de Stock Actual",filterByStore:"Filtrar por tienda",filterByDate:"Filtrar por rango de fechas",totalCustomsFees:"Aranceles totales",averageValue:"Valor promedio",senderInformation:"Informacin del Remitente",receiptInformation:"Informacin del Destinatario",productsSubtotal:"Subtotal de Productos",reservationsSubtotal:"Subtotal de Reservaciones",code:"Cdigo",description:"Descripcin",qty:"Cant.",type:"Tipo",id:"ID",passport:"Pasaporte"},unauthorized:{title:"Acceso Restringido",accessDenied:"Acceso Denegado",noPermission:"No tienes permisos para acceder a",thisFeature:"esta funcionalidad",whySeeing:"Por qu veo esto?",explanation:"Tu cuenta no tiene los permisos necesarios para ver este contenido.",requiredPermission:"Permiso requerido:",goToDashboard:"Ir al Panel de Control",goBack:"Regresar",featuresCanAccess:"Funcionalidades a las que puedes acceder:",dashboardAccess:"Panel de control y estadsticas generales",profileAccess:"Tu perfil y configuraciones",roleBasedAccess:"Funcionalidades habilitadas para tu rol",needAccess:"Necesitas acceso? Contacta a tu administrador o gerente para solicitar los permisos apropiados.",permissions:{accountAccess:"Acceso a Gestin de Cuentas",inventoryAccess:"Acceso a Inventario",employeeAccess:"Acceso a Recursos Humanos",bankingAccess:"Acceso Bancario",journalAccess:"Acceso a Asientos Contables",adminAccess:"Acceso Administrativo",financialReporting:"Acceso a Reportes Financieros",invoiceManagement:"Acceso a Gestin de Facturas",productManagement:"Acceso a Gestin de Productos"}}}},Bw=()=>{if(typeof window<"u"){const t=localStorage.getItem("hrmfinance-language");if(t&&["en","es"].includes(t))return t}return"en"},[zh,Uw]=ve(Bw()),ct=()=>({t:(n,o,i)=>{const a=zh(),c=n.split(".");let d=Fw[a];for(const y of c)if(d&&typeof d=="object"&&y in d)d=d[y];else return o||n;let h=typeof d=="string"?d:o||n;return i&&typeof h=="string"&&Object.keys(i).forEach(y=>{const v=i[y],w=`{{${y}}}`;h=h.replace(new RegExp(w,"g"),String(v))}),h},language:()=>zh(),setLanguage:n=>{Uw(n),typeof window<"u"&&localStorage.setItem("hrmfinance-language",n)}});var jw=G("<div><label></label><select><option value>"),zw=G("<span>*"),qw=G("<option>");const gr=t=>{const{t:e}=ct(),r={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},n={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},o={"margin-bottom":"1rem"};return(()=>{var i=jw(),a=i.firstChild,c=a.nextSibling,d=c.firstChild;return u(i,o),u(a,r),s(a,()=>t.label,null),s(a,(()=>{var h=ge(()=>!!t.required);return()=>h()&&(()=>{var y=zw();return y.style.setProperty("color","var(--primary-color)"),y})()})(),null),c.addEventListener("blur",h=>h.target.style.borderColor="var(--border-color)"),c.addEventListener("focus",h=>h.target.style.borderColor="var(--primary-color)"),c.addEventListener("change",h=>t.onChange(h.target.value)),u(c,n),s(d,()=>e("forms.selectOption")),s(c,()=>t.options.map(h=>(()=>{var y=qw();return s(y,()=>h.label),le(()=>y.value=h.value),y})()),null),le(h=>{var y=t.required,v=t.disabled;return y!==h.e&&(c.required=h.e=y),v!==h.t&&(c.disabled=h.t=v),h},{e:void 0,t:void 0}),le(()=>c.value=t.value),i})()};var Gw=G("<main><div>"),Hw=G("<header><h1>");const Br=t=>{const e={"min-height":"100vh",background:"var(--background-color)"},r={"max-width":"1200px",margin:"0 auto",padding:"2rem"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},o={"font-size":"2rem","font-weight":"700",color:"var(--text-primary)",margin:"0"};return(()=>{var i=Gw(),a=i.firstChild;return u(i,e),u(a,r),s(a,(()=>{var c=ge(()=>!!t.title);return()=>c()&&(()=>{var d=Hw(),h=d.firstChild;return u(d,n),u(h,o),s(h,()=>t.title),d})()})(),null),s(a,()=>t.children,null),i})()};var Ww=G("<div><span></span><select><option value=en> </option><option value=es> ");const Yw=()=>{const{t,language:e,setLanguage:r}=ct(),n={display:"flex","align-items":"center",gap:"0.5rem","margin-left":"auto"},o={padding:"0.5rem 1rem","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",background:"var(--surface-color)",color:"var(--text-primary)",cursor:"pointer","font-size":"0.875rem","font-weight":"500",transition:"all 0.2s ease","min-width":"120px"},i={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},a=c=>{const d=c.target;r(d.value)};return(()=>{var c=Ww(),d=c.firstChild,h=d.nextSibling,y=h.firstChild;y.firstChild;var v=y.nextSibling;return v.firstChild,u(c,n),u(d,i),h.addEventListener("change",a),u(h,o),s(y,()=>t("common.english"),null),s(v,()=>t("common.spanish"),null),le(()=>h.value=e()),c})()};var qh=G('<img alt="User avatar">'),Kw=G("<div class=user-info-desktop><span>"),Qw=G("<button class=sign-out-desktop>Sign Out"),Jw=G("<div><div><span></span></div><button>Sign Out"),Xw=G(`<nav><div><div class=desktop-nav></div><div><button class=mobile-menu-button><svg width=24 height=24 viewBox="0 0 24 24"fill=currentColor><path></path></svg></button></div></div><div class=mobile-nav></div><style>
        .nav-active {
          background: linear-gradient(135deg, var(--primary-color), var(--primary-dark)) !important;
          color: white !important;
          box-shadow: var(--shadow-sm);
        }
        
        .desktop-nav a:hover:not(.nav-active),
        .nav-group button:hover {
          background: var(--background-color);
          color: var(--text-primary);
        }
        
        .mobile-nav a:hover:not(.nav-active) {
          background: var(--background-color);
          color: var(--text-primary);
        }

        /* Create invisible bridge to prevent gap issues */
        .nav-group::before {
          content: '';
          position: absolute;
          top: 100%;
          left: 0;
          right: 0;
          height: 0.5rem;
          z-index: 9;
        }
        
        @media (max-width: 768px) {
          .desktop-nav {
            display: none !important;
          }
          
          .mobile-menu-button {
            display: block !important;
          }
          
          .user-info-desktop,
          .sign-out-desktop {
            display: none !important;
          }
          
          nav > div:first-child {
            padding: 1rem;
          }
        }
        
        @media (min-width: 769px) {
          .mobile-nav {
            display: none !important;
          }
        }
      `),Zw=G("<div class=nav-group><button> <span></span></button><div>"),eC=G("<div>"),tC=G("<div><div><span> </span><span>");const rC=()=>{const{t}=ct(),[e,r]=ve(!1),[n,o]=ve(null),[i,a]=ve(null),c={background:"var(--surface-color)","border-bottom":"1px solid var(--border-color)","box-shadow":"var(--shadow-sm)","backdrop-filter":"blur(10px)",position:"sticky",top:"0","z-index":"100"},d={display:"flex","align-items":"center","justify-content":"space-between",padding:"1rem 2rem",margin:"0 auto",position:"relative"},h={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","text-decoration":"none"},y={display:"flex",gap:"1rem","align-items":"center",flex:"1","margin-left":"2rem"},v={display:"none",position:"absolute",top:"100%",left:"0",right:"0",background:"var(--surface-color)","border-top":"1px solid var(--border-color)","box-shadow":"var(--shadow-md)","max-height":"70vh","overflow-y":"auto"},w={position:"relative",display:"flex","align-items":"center"},E={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem",background:"transparent",border:"none",color:"var(--text-secondary)","font-weight":"500","font-size":"0.875rem",cursor:"pointer","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease","white-space":"nowrap"},V={position:"absolute",top:"100%",left:"0",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)","min-width":"200px","margin-top":"0.25rem","z-index":"10",display:"none","padding-top":"0.25rem"},N={"border-bottom":"1px solid var(--border-color)"},x={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",cursor:"pointer","font-weight":"600",color:"var(--text-primary)"},k={display:"block","text-decoration":"none",color:"var(--text-secondary)",padding:"0.75rem 1rem","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease","white-space":"nowrap"},re={...k,padding:"0.75rem 1.5rem","border-bottom":"1px solid var(--border-light)"},ae={display:"none",background:"transparent",border:"none",padding:"0.5rem",cursor:"pointer",color:"var(--text-primary)"},F={display:"flex","align-items":"center",gap:"1rem"},Y={display:"flex","align-items":"center",gap:"0.75rem",padding:"0.5rem 1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",color:"var(--text-primary)"},U={width:"32px",height:"32px","border-radius":"50%","object-fit":"cover"},b={...k,cursor:"pointer",border:"1px solid var(--border-color)",background:"transparent","border-radius":"var(--border-radius-sm)"},g=()=>{St.signOut()},p=I=>{const O=St.state?.profile;return O?O[I]===!0||O.isAdmin===!0:!1},C=()=>{r(!e())},S=I=>{o(n()===I?null:I)},A=I=>{const O=i();O&&(clearTimeout(O),a(null)),o(I)},m=()=>{const I=setTimeout(()=>{o(null)},300);a(I)},ne=[{name:"Finance",icon:"",items:[{path:"/accounts",label:t("navigation.accounts"),permission:"AccountAccess",icon:""},{path:"/entry-books",label:t("navigation.entryBooks"),permission:"JournalAccess",icon:""},{path:"/balance-sheet",label:t("navigation.balanceSheet"),permission:"AccountAccess",icon:""},{path:"/bank-consolidations",label:t("navigation.consolidate"),permission:"BankingAccess",icon:""}]},{name:"Operations",icon:"",items:[{path:"/inventory",label:t("navigation.inventory"),permission:"InventoryAccess",icon:""},{path:"/invoices",label:t("navigation.invoice"),permission:"invoiceAccess",icon:""}]},{name:"Management",icon:"",items:[{path:"/employees",label:t("navigation.employees"),permission:"EmployeeAccess",icon:""},{path:"/admin/users",label:"Admin",permission:"isAdmin",icon:"",adminOnly:!0}]}],W=()=>ne.map(I=>({...I,items:I.items.filter(O=>O.adminOnly?St.state?.profile?.isAdmin:p(O.permission))})).filter(I=>I.items.length>0);return(()=>{var I=Xw(),O=I.firstChild,J=O.firstChild,D=J.nextSibling,T=D.firstChild,B=T.firstChild,me=B.firstChild,H=O.nextSibling;return s(O,_(Yo,{href:"/",style:h,children:"HRM Finance"}),J),u(J,y),s(J,_(Yo,{href:"/",style:k,activeClass:"nav-active",get children(){return[" ",ge(()=>t("navigation.dashboard"))]}}),null),s(J,_(at,{get each(){return W()},children:de=>(()=>{var $=Zw(),q=$.firstChild,Z=q.firstChild,L=Z.nextSibling,te=q.nextSibling;return $.addEventListener("mouseleave",m),$.addEventListener("mouseenter",()=>A(de.name)),s(q,()=>de.icon,Z),s(q,()=>de.name,L),L.style.setProperty("font-size","0.75rem"),te.addEventListener("mouseleave",m),te.addEventListener("mouseenter",()=>A(de.name)),s(te,_(at,{get each(){return de.items},children:j=>_(Yo,{get href(){return j.path},style:k,activeClass:"nav-active",onClick:()=>o(null),get children(){return[ge(()=>j.icon)," ",ge(()=>j.label)]}})})),le(j=>{var M=w,ie=E,oe={...V,display:n()===de.name?"block":"none"};return j.e=u($,M,j.e),j.t=u(q,ie,j.t),j.a=u(te,oe,j.a),j},{e:void 0,t:void 0,a:void 0}),$})()}),null),u(D,F),s(D,_(Yw,{}),T),s(D,_(De,{get when(){return St.currentUser},get children(){return[(()=>{var de=Kw(),$=de.firstChild;return s(de,_(De,{get when(){return St.currentUser?.photoURL},get children(){var q=qh();return le(Z=>{var L=St.currentUser.photoURL,te=U;return L!==Z.e&&lt(q,"src",Z.e=L),Z.t=u(q,te,Z.t),Z},{e:void 0,t:void 0}),q}}),$),s($,()=>St.currentUser?.displayName||St.currentUser?.email),le(q=>u(de,Y,q)),de})(),(()=>{var de=Qw();return de.addEventListener("mouseleave",$=>{$.currentTarget.style.background="transparent",$.currentTarget.style.color="var(--text-secondary)"}),de.addEventListener("mouseenter",$=>{$.currentTarget.style.background="var(--background-color)",$.currentTarget.style.color="var(--text-primary)"}),de.$$click=g,le($=>u(de,b,$)),de})()]}}),T),T.$$click=C,u(T,ae),s(H,_(Yo,{href:"/",style:re,activeClass:"nav-active",onClick:()=>r(!1),get children(){return[" ",ge(()=>t("navigation.dashboard"))]}}),null),s(H,_(at,{get each(){return W()},children:de=>(()=>{var $=tC(),q=$.firstChild,Z=q.firstChild,L=Z.firstChild,te=Z.nextSibling;return u($,N),q.$$click=()=>S(de.name),u(q,x),s(Z,()=>de.icon,L),s(Z,()=>de.name,null),te.style.setProperty("transition","transform 0.2s"),s($,_(De,{get when(){return n()===de.name},get children(){var j=eC();return j.style.setProperty("background","var(--background-color)"),s(j,_(at,{get each(){return de.items},children:M=>_(Yo,{get href(){return M.path},get style(){return{...re,"padding-left":"3rem"}},activeClass:"nav-active",onClick:()=>r(!1),get children(){return[ge(()=>M.icon)," ",ge(()=>M.label)]}})})),j}}),null),le(j=>(j=n()===de.name?"rotate(180deg)":"none")!=null?te.style.setProperty("transform",j):te.style.removeProperty("transform")),$})()}),null),s(H,_(De,{get when(){return St.currentUser},get children(){var de=Jw(),$=de.firstChild,q=$.firstChild,Z=$.nextSibling;return de.style.setProperty("padding","1rem"),de.style.setProperty("border-top","2px solid var(--border-color)"),s($,_(De,{get when(){return St.currentUser?.photoURL},get children(){var L=qh();return le(te=>{var j=St.currentUser.photoURL,M=U;return j!==te.e&&lt(L,"src",te.e=j),te.t=u(L,M,te.t),te},{e:void 0,t:void 0}),L}}),q),s(q,()=>St.currentUser?.displayName||St.currentUser?.email),Z.$$click=()=>{g(),r(!1)},le(L=>{var te={...Y,"margin-bottom":"1rem"},j={...b,width:"100%"};return L.e=u($,te,L.e),L.t=u(Z,j,L.t),L},{e:void 0,t:void 0}),de}}),null),le(de=>{var $=c,q=d,Z=e()?"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z":"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z",L={...v,display:e()?"block":"none"};return de.e=u(I,$,de.e),de.t=u(O,q,de.t),Z!==de.a&&lt(me,"d",de.a=Z),de.o=u(H,L,de.o),de},{e:void 0,t:void 0,a:void 0,o:void 0}),I})()};Pt(["click"]);var nC=G("<div><div><div></div><h1></h1><p>.</p><div><p><strong></strong><br></p></div><div><button></button></div><div><h3></h3><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div></div><div><p>"),Gh=G("<br>"),oC=G("<strong>");const iC=t=>{const{t:e}=ct(),r={"min-height":"calc(100vh - 200px)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},n={"text-align":"center","max-width":"600px",width:"100%"},o={"font-size":"5rem",color:"#e53e3e","margin-bottom":"2rem"},i={"font-size":"2.5rem","font-weight":"700",color:"#1a202c","margin-bottom":"1rem"},a={"font-size":"1.25rem",color:"#718096","margin-bottom":"2rem","line-height":"1.6"},c={background:"#f7fafc",border:"1px solid #e2e8f0","border-radius":"0.5rem",padding:"1.5rem","margin-bottom":"2rem"},d={color:"#4a5568","font-size":"1rem","line-height":"1.6"},h={display:"flex",gap:"1rem","justify-content":"center","flex-wrap":"wrap"},y={padding:"0.75rem 2rem","border-radius":"0.5rem","text-decoration":"none","font-weight":"500",transition:"all 0.2s",display:"inline-block"},v={...y,background:"var(--primary-color)",color:"white",border:"2px solid var(--primary-color)"},w={...y,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},E={"text-align":"left","margin-top":"2rem",padding:"0 2rem"},V={display:"flex","align-items":"center",gap:"0.75rem","margin-bottom":"1rem",color:"#4a5568"},N={color:"#48bb78","font-size":"1.25rem"};return _(Br,{get title(){return e("unauthorized.title")},get children(){var x=nC(),k=x.firstChild,re=k.firstChild,ae=re.nextSibling,F=ae.nextSibling,Y=F.firstChild,U=F.nextSibling,b=U.firstChild,g=b.firstChild;g.nextSibling;var p=U.nextSibling,C=p.firstChild,S=p.nextSibling,A=S.firstChild,m=A.nextSibling,ne=m.firstChild,W=ne.nextSibling,I=m.nextSibling,O=I.firstChild,J=O.nextSibling,D=I.nextSibling,T=D.firstChild,B=T.nextSibling,me=S.nextSibling,H=me.firstChild;return u(x,r),u(k,n),u(re,o),u(ae,i),s(ae,()=>e("unauthorized.accessDenied")),u(F,a),s(F,()=>e("unauthorized.noPermission"),Y),s(F,(()=>{var de=ge(()=>!!t.featureName);return()=>de()?` ${t.featureName}`:` ${e("unauthorized.thisFeature")}`})(),Y),u(U,c),u(b,d),s(g,()=>e("unauthorized.whySeeing")),s(b,()=>e("unauthorized.explanation"),null),s(b,(()=>{var de=ge(()=>!!t.requiredPermission);return()=>de()&&[Gh(),Gh(),(()=>{var $=oC();return s($,()=>e("unauthorized.requiredPermission")),$})()," ",ge(()=>t.requiredPermission)]})(),null),u(p,h),s(p,_(Yo,{href:"/",style:v,get children(){return e("unauthorized.goToDashboard")}}),C),C.$$click=()=>window.history.back(),s(C,()=>e("unauthorized.goBack")),u(S,E),A.style.setProperty("margin-bottom","1rem"),A.style.setProperty("color","#2d3748"),s(A,()=>e("unauthorized.featuresCanAccess")),s(W,()=>e("unauthorized.dashboardAccess")),s(J,()=>e("unauthorized.profileAccess")),s(B,()=>e("unauthorized.roleBasedAccess")),me.style.setProperty("margin-top","3rem"),me.style.setProperty("padding","1.5rem"),me.style.setProperty("background","#edf2f7"),me.style.setProperty("border-radius","0.5rem"),H.style.setProperty("color","#4a5568"),H.style.setProperty("font-size","0.875rem"),s(H,()=>e("unauthorized.needAccess")),le(de=>{var $=w,q=V,Z=N,L=V,te=N,j=V,M=N;return de.e=u(C,$,de.e),de.t=u(m,q,de.t),de.a=u(ne,Z,de.a),de.o=u(I,L,de.o),de.i=u(O,te,de.i),de.n=u(D,j,de.n),de.s=u(T,M,de.s),de},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),x}})};Pt(["click"]);const rn=t=>{const{t:e}=ct(),r=()=>{if(!t.permission)return!0;const o=St.state?.profile;if(!o)return!1;if(o.isAdmin)return!0;switch(t.permission){case"AccountAccess":return o.AccountAccess===!0;case"InventoryAccess":return o.InventoryAccess===!0;case"EmployeeAccess":return o.EmployeeAccess===!0;case"BankingAccess":return o.BankingAccess===!0;case"JournalAccess":return o.JournalAccess===!0;case"AdminAccess":return o.isAdmin===!0;default:return o[t.permission]===!0}},n=()=>{if(t.requiredPermission)return t.requiredPermission;switch(t.permission){case"AccountAccess":return e("unauthorized.permissions.accountAccess");case"InventoryAccess":return e("unauthorized.permissions.inventoryAccess");case"EmployeeAccess":return e("unauthorized.permissions.employeeAccess");case"BankingAccess":return e("unauthorized.permissions.bankingAccess");case"JournalAccess":return e("unauthorized.permissions.journalAccess");case"AdminAccess":return e("unauthorized.permissions.adminAccess");default:return t.permission}};return _(De,{get when(){return r()},get fallback(){return t.fallback||_(iC,{get featureName(){return t.featureName},get requiredPermission(){return n()}})},get children(){return t.children}})};var sC=G('<button title="Open Dev Tools">'),aC=G("<span>(<!>)"),lC=G("<div><span></span><span>"),Hh=G("<div>"),cC=G("<div>Database reset only available in fake mode"),uC=G("<div><div>Loading..."),dC=G("<div><div><h3> Dev Tools</h3><button></button></div><div><div>API Mode</div><div><button>Fake Server</button><button>Real API</button><button>Hybrid</button></div><div>Current: <strong></strong></div></div><div><div>Health Status</div></div><div><div>Database Stats</div></div><div><div>Actions</div><div><button> Refresh Stats</button><button> Health Check</button></div><div><button> Reset DB</button></div></div><div><div>Info</div><div> <strong>Fake Server:</strong> Uses local mock data<br> <strong>Real API:</strong> Connects to actual backend<br> <strong>Hybrid:</strong> Real API with fake fallback<br> Settings are saved in localStorage"),hC=G("<div>Loading..."),mC=G("<div><span>:</span><span>");const yC=()=>{const[t,e]=ve(!1),[r,n]=ve(es.getMode()),[o,i]=ve({}),[a,c]=ve(null),[d,h]=ve(!1);Hr(async()=>{await y(),await v()});const y=async()=>{try{const b=await md.getStats();i(b)}catch(b){console.error("Failed to load stats:",b)}},v=async()=>{try{const b=await md.healthCheck();c(b)}catch(b){console.error("Health check failed:",b),c({status:"error",error:b.message})}},w=async b=>{h(!0);try{es.setMode(b),n(b),await y(),await v()}catch(g){console.error("Failed to change API mode:",g)}finally{h(!1)}},E=async()=>{if(confirm("Are you sure you want to reset the fake database to its initial state?")){h(!0);try{const b=await Or.utils.resetDatabase();alert(b.message),await y()}catch(b){console.error("Failed to reset database:",b),alert("Failed to reset database")}finally{h(!1)}}},V={position:"fixed",bottom:"20px",right:"20px","z-index":"10000","font-family":"monospace"},N={background:"#1a1a1a",color:"#fff",border:"1px solid #333","border-radius":"8px",padding:"16px","min-width":"300px","max-width":"400px","box-shadow":"0 4px 20px rgba(0,0,0,0.3)"},x={background:"#007acc",color:"#fff",border:"none","border-radius":"50%",width:"50px",height:"50px",cursor:"pointer","font-size":"20px","box-shadow":"0 2px 10px rgba(0,0,0,0.2)",display:"flex","align-items":"center","justify-content":"center"},k={background:"#333",color:"#fff",border:"1px solid #555","border-radius":"4px",padding:"6px 12px",cursor:"pointer","font-size":"12px","margin-right":"8px","margin-bottom":"8px"},re={...k,background:"#007acc","border-color":"#007acc"},ae={"margin-bottom":"16px","padding-bottom":"12px","border-bottom":"1px solid #333"},F={"font-size":"14px","font-weight":"bold","margin-bottom":"8px",color:"#007acc"},Y={display:"flex","justify-content":"space-between","font-size":"12px","margin-bottom":"4px"},U=b=>({display:"inline-block",width:"8px",height:"8px","border-radius":"50%","margin-right":"8px",background:b==="healthy"?"#00ff00":b==="error"?"#ff0000":"#ffff00"});return(()=>{var b=Hh();return s(b,_(De,{get when(){return!t()},get children(){var g=sC();return g.$$click=()=>e(!0),u(g,x),g}}),null),s(b,_(De,{get when(){return t()},get children(){var g=dC(),p=g.firstChild,C=p.firstChild,S=C.nextSibling,A=p.nextSibling,m=A.firstChild,ne=m.nextSibling,W=ne.firstChild,I=W.nextSibling,O=I.nextSibling,J=ne.nextSibling,D=J.firstChild,T=D.nextSibling,B=A.nextSibling,me=B.firstChild,H=B.nextSibling,de=H.firstChild,$=H.nextSibling,q=$.firstChild,Z=q.nextSibling,L=Z.firstChild,te=L.nextSibling,j=Z.nextSibling,M=j.firstChild,ie=$.nextSibling,oe=ie.firstChild,fe=oe.nextSibling;return u(g,N),p.style.setProperty("display","flex"),p.style.setProperty("justify-content","space-between"),p.style.setProperty("align-items","center"),p.style.setProperty("margin-bottom","16px"),C.style.setProperty("margin","0"),C.style.setProperty("color","#007acc"),C.style.setProperty("font-size","16px"),S.$$click=()=>e(!1),W.$$click=()=>w("fake"),I.$$click=()=>w("real"),O.$$click=()=>w("hybrid"),J.style.setProperty("font-size","11px"),J.style.setProperty("color","#888"),J.style.setProperty("margin-top","4px"),s(T,r),s(J,()=>r()==="fake"&&" (Using fake server)",null),s(J,()=>r()==="real"&&" (Using real API)",null),s(J,()=>r()==="hybrid"&&" (Real API with fallback)",null),s(B,_(De,{get when(){return a()},get fallback(){return(()=>{var ue=hC();return ue.style.setProperty("font-size","12px"),ue})()},get children(){return[(()=>{var ue=lC(),K=ue.firstChild,R=K.nextSibling;return ue.style.setProperty("display","flex"),ue.style.setProperty("align-items","center"),ue.style.setProperty("font-size","12px"),s(R,()=>a()?.status||"Unknown"),s(ue,_(De,{get when(){return a()?.timestamp},get children(){var ee=aC(),X=ee.firstChild,ye=X.nextSibling;return ye.nextSibling,ee.style.setProperty("margin-left","8px"),ee.style.setProperty("color","#888"),s(ee,()=>new Date(a().timestamp).toLocaleTimeString(),ye),ee}}),null),le(ee=>u(K,U(a()?.status||"unknown"),ee)),ue})(),_(De,{get when(){return a()?.error},get children(){var ue=Hh();return ue.style.setProperty("font-size","11px"),ue.style.setProperty("color","#ff6666"),ue.style.setProperty("margin-top","4px"),s(ue,()=>a().error),ue}})]}}),null),s(H,_(at,{get each(){return Object.entries(o())},children:([ue,K])=>(()=>{var R=mC(),ee=R.firstChild,X=ee.firstChild,ye=ee.nextSibling;return u(R,Y),ee.style.setProperty("text-transform","capitalize"),s(ee,ue,X),ye.style.setProperty("color","#00ff00"),s(ye,K),R})()}),null),L.$$click=y,te.$$click=v,j.style.setProperty("margin-top","8px"),M.$$click=E,s($,_(De,{get when(){return r()!=="fake"},get children(){var ue=cC();return ue.style.setProperty("font-size","11px"),ue.style.setProperty("color","#888"),ue.style.setProperty("margin-top","4px"),ue}}),null),fe.style.setProperty("font-size","11px"),fe.style.setProperty("color","#888"),fe.style.setProperty("line-height","1.4"),s(g,_(De,{get when(){return d()},get children(){var ue=uC(),K=ue.firstChild;return ue.style.setProperty("position","absolute"),ue.style.setProperty("top","0"),ue.style.setProperty("left","0"),ue.style.setProperty("right","0"),ue.style.setProperty("bottom","0"),ue.style.setProperty("background","rgba(0,0,0,0.7)"),ue.style.setProperty("display","flex"),ue.style.setProperty("align-items","center"),ue.style.setProperty("justify-content","center"),ue.style.setProperty("border-radius","8px"),K.style.setProperty("color","#fff"),K.style.setProperty("font-size","14px"),ue}}),null),le(ue=>{var K={...k,padding:"4px 8px"},R=ae,ee=F,X=r()==="fake"?re:k,ye=d(),pe=r()==="real"?re:k,z=d(),se=r()==="hybrid"?re:k,_e=d(),Pe=ae,he=F,be=ae,ce=F,Se=ae,Ee=F,$e=k,ke=d(),Me=k,Ke=d(),je={...k,background:"#cc4400","border-color":"#cc4400"},Ce=d()||r()!=="fake",Fe=F;return ue.e=u(S,K,ue.e),ue.t=u(A,R,ue.t),ue.a=u(m,ee,ue.a),ue.o=u(W,X,ue.o),ye!==ue.i&&(W.disabled=ue.i=ye),ue.n=u(I,pe,ue.n),z!==ue.s&&(I.disabled=ue.s=z),ue.h=u(O,se,ue.h),_e!==ue.r&&(O.disabled=ue.r=_e),ue.d=u(B,Pe,ue.d),ue.l=u(me,he,ue.l),ue.u=u(H,be,ue.u),ue.c=u(de,ce,ue.c),ue.w=u($,Se,ue.w),ue.m=u(q,Ee,ue.m),ue.f=u(L,$e,ue.f),ke!==ue.y&&(L.disabled=ue.y=ke),ue.g=u(te,Me,ue.g),Ke!==ue.p&&(te.disabled=ue.p=Ke),ue.b=u(M,je,ue.b),Ce!==ue.T&&(M.disabled=ue.T=Ce),ue.A=u(oe,Fe,ue.A),ue},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),g}}),null),le(g=>u(b,V,g)),b})()};Pt(["click"]);const fC=[{id:"1",accountNumber:"1000",name:"Cash and Cash Equivalents",type:"Asset",category:"Current Assets",description:"Cash on hand and in bank accounts",balance:45230.5,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1001",accountNumber:"1001",name:"Petty Cash",type:"Asset",category:"Current Assets",description:"Small amounts of cash for minor expenses",balance:500,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1002",accountNumber:"1002",name:"Bank - Checking Account",type:"Asset",category:"Current Assets",description:"Main operating checking account",balance:32730.5,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1003",accountNumber:"1003",name:"Bank - Savings Account",type:"Asset",category:"Current Assets",description:"Interest-bearing savings account",balance:12e3,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"2",accountNumber:"1100",name:"Accounts Receivable",type:"Asset",category:"Current Assets",description:"Money owed by customers",balance:23450.75,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2001",accountNumber:"1101",name:"Trade Receivables",type:"Asset",category:"Current Assets",description:"Receivables from regular customers",balance:18450.75,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2002",accountNumber:"1102",name:"Employee Advances",type:"Asset",category:"Current Assets",description:"Money advanced to employees",balance:5e3,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"3",accountNumber:"1200",name:"Inventory",type:"Asset",category:"Current Assets",description:"Products held for sale",balance:78920.25,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-13"},{id:"4",accountNumber:"1500",name:"Equipment",type:"Asset",category:"Fixed Assets",description:"Office equipment and machinery",balance:125e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-12"},{id:"5",accountNumber:"2000",name:"Accounts Payable",type:"Liability",category:"Current Liabilities",description:"Money owed to suppliers",balance:15670.3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-11"},{id:"6",accountNumber:"2100",name:"Accrued Expenses",type:"Liability",category:"Current Liabilities",description:"Expenses incurred but not yet paid",balance:8945.6,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-10"},{id:"7",accountNumber:"2500",name:"Long-term Debt",type:"Liability",category:"Long-term Liabilities",description:"Long-term loans and mortgages",balance:85e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-09"},{id:"8",accountNumber:"3000",name:"Owner's Equity",type:"Equity",category:"Owner's Equity",description:"Owner's investment in the business",balance:15e4,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-08"},{id:"9",accountNumber:"3100",name:"Retained Earnings",type:"Equity",category:"Owner's Equity",description:"Accumulated profits retained in business",balance:32450.8,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-07"},{id:"10",accountNumber:"4000",name:"Sales Revenue",type:"Revenue",category:"Operating Revenue",description:"Revenue from product sales",balance:245678.9,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-06"},{id:"11",accountNumber:"4100",name:"Service Revenue",type:"Revenue",category:"Operating Revenue",description:"Revenue from services provided",balance:89432.15,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-05"},{id:"12",accountNumber:"5000",name:"Cost of Goods Sold",type:"Expense",category:"Operating Expenses",description:"Direct costs of producing goods",balance:125678.45,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-04"},{id:"13",accountNumber:"5100",name:"Salaries Expense",type:"Expense",category:"Operating Expenses",description:"Employee salary expenses",balance:98765.32,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-03"},{id:"14",accountNumber:"5200",name:"Rent Expense",type:"Expense",category:"Operating Expenses",description:"Office rent expenses",balance:24e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-02"}],pC=[{id:"1",accountId:"1",date:"2024-01-15",description:"Customer payment received",debitAmount:5e3,creditAmount:0,reference:"INV-2024-001",type:"debit"},{id:"2",accountId:"2",date:"2024-01-15",description:"Customer payment received",debitAmount:0,creditAmount:5e3,reference:"INV-2024-001",type:"credit"},{id:"3",accountId:"5",date:"2024-01-14",description:"Office supplies purchased",debitAmount:0,creditAmount:1250,reference:"PO-2024-001",type:"credit"}],[nn,Us]=ve(fC),[Il,gC]=ve(pC),wt={get accounts(){return nn()},get transactions(){return Il()},fetchAllAccount(t){const e={...t,id:Date.now().toString(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return Us([...nn(),e]),e},addAccount(t){const e={...t,id:Date.now().toString(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return Us([...nn(),e]),e},updateAccount(t,e){Us(nn().map(r=>r.id===t?{...r,...e,lastModified:new Date().toISOString().split("T")[0]}:r))},deleteAccount(t){Us(nn().filter(e=>e.id!==t))},getAccountById(t){return nn().find(e=>e.id===t)},getAccountsByType(t){return nn().filter(e=>e.type===t)},getAccountTransactions(t){return Il().filter(e=>e.accountId===t)},addTransaction(t){const e={...t,id:Date.now().toString()};gC([...Il(),e]);const r=this.getAccountById(t.accountId);if(r){const n=t.type==="debit"?t.debitAmount:-t.creditAmount;this.updateAccount(t.accountId,{balance:r.balance+n})}return e},getTotalByType(t){return nn().filter(e=>e.type===t&&e.isActive).reduce((e,r)=>e+r.balance,0)},getAccountCategories(t){const e=this.getAccountsByType(t);return[...new Set(e.map(r=>r.category))]},getSubAccounts(t){return nn().filter(e=>e.parentAccountId===t)},getParentAccounts(){return nn().filter(t=>!t.parentAccountId)},getAccountHierarchy(){return this.getParentAccounts().map(e=>({...e,subAccounts:this.getSubAccounts(e.id)}))},getAccountWithSubAccounts(t){const e=this.getAccountById(t);return e?{...e,subAccounts:this.getSubAccounts(t),parentAccount:e.parentAccountId?this.getAccountById(e.parentAccountId):null}:null},getAccountPath(t){const e=this.getAccountById(t);if(!e)return[];const r=[e];let n=e;for(;n.parentAccountId;){const o=this.getAccountById(n.parentAccountId);if(o)r.unshift(o),n=o;else break}return r},getTotalBalanceWithSubAccounts(t){const e=this.getAccountById(t);if(!e)return 0;const n=this.getSubAccounts(t).reduce((o,i)=>o+this.getTotalBalanceWithSubAccounts(i.id),0);return e.balance+n},canDeleteAccount(t){const e=this.getSubAccounts(t);if(e.length>0)return{canDelete:!1,reason:`Account has ${e.length} sub-account(s). Delete or move sub-accounts first.`};const r=this.getAccountTransactions(t);return r.length>0?{canDelete:!1,reason:`Account has ${r.length} transaction(s). Cannot delete account with transaction history.`}:{canDelete:!0}}};var jn=G("<div>"),Ti=G("<div> ");const vC=()=>{const{t}=ct(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},n={"font-size":"0.875rem",color:"var(--text-muted)"},o=N=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(N),i=wt.getTotalByType("Asset"),a=wt.getTotalByType("Liability"),c=wt.getTotalByType("Equity"),d=wt.getTotalByType("Revenue"),h=wt.getTotalByType("Expense"),y=wt.getAccountsByType("Asset").length,v=wt.getAccountsByType("Liability").length,w=wt.getAccountsByType("Equity").length,E=wt.getAccountsByType("Revenue").length,V=wt.getAccountsByType("Expense").length;return(()=>{var N=jn();return u(N,e),s(N,_(He,{get title(){return t("dashboard.totalAssets")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var x=jn();return s(x,()=>o(i)),le(k=>u(x,r,k)),x})(),(()=>{var x=Ti(),k=x.firstChild;return s(x,y,k),s(x,()=>t("navigation.accounts"),null),le(re=>u(x,n,re)),x})()]}}),null),s(N,_(He,{get title(){return t("dashboard.totalLiabilities")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var x=jn();return s(x,()=>o(a)),le(k=>u(x,r,k)),x})(),(()=>{var x=Ti(),k=x.firstChild;return s(x,v,k),s(x,()=>t("navigation.accounts"),null),le(re=>u(x,n,re)),x})()]}}),null),s(N,_(He,{get title(){return t("dashboard.totalEquity")},get subtitle(){return t("accounts.categories.ownersEquity")},get children(){return[(()=>{var x=jn();return s(x,()=>o(c)),le(k=>u(x,r,k)),x})(),(()=>{var x=Ti(),k=x.firstChild;return s(x,w,k),s(x,()=>t("navigation.accounts"),null),le(re=>u(x,n,re)),x})()]}}),null),s(N,_(He,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("accounts.categories.operatingRevenue")},get children(){return[(()=>{var x=jn();return s(x,()=>o(d)),le(k=>u(x,r,k)),x})(),(()=>{var x=Ti(),k=x.firstChild;return s(x,E,k),s(x,()=>t("navigation.accounts"),null),le(re=>u(x,n,re)),x})()]}}),null),s(N,_(He,{get title(){return t("dashboard.totalExpenses")},get subtitle(){return t("accounts.categories.operatingExpenses")},get children(){return[(()=>{var x=jn();return s(x,()=>o(h)),le(k=>u(x,r,k)),x})(),(()=>{var x=Ti(),k=x.firstChild;return s(x,V,k),s(x,()=>t("navigation.accounts"),null),le(re=>u(x,n,re)),x})()]}}),null),s(N,_(He,{get title(){return t("dashboard.netIncome")},get subtitle(){return`${t("dashboard.totalRevenue")} - ${t("dashboard.totalExpenses")}`},get children(){return[(()=>{var x=jn();return s(x,()=>o(d-h)),le(k=>u(x,{...r,color:d-h>=0?"#4caf50":"#f44336"},k)),x})(),(()=>{var x=jn();return s(x,()=>d-h>=0?t("dashboard.netIncome"):t("dashboard.netLoss")),le(k=>u(x,n,k)),x})()]}}),null),N})()};var bC=G("<div><div></div><div>"),_C=G("<h3>"),ki=G("<div>");const SC=t=>{const{t:e}=ct();Dc();const r={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},o={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"},i={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},a={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},c={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem"},d={"font-size":"0.875rem",color:"var(--text-secondary)","line-height":"1.4"},h=w=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[w]||{bg:"#f5f5f5",color:"#666"},y=w=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(w),v=h(t.account.type);return _(He,{get children(){return[(()=>{var w=bC(),E=w.firstChild,V=E.nextSibling;return u(w,n),u(E,o),s(E,()=>t.account.accountNumber),s(V,()=>e(`accounts.types.${t.account.type.toLowerCase()}`)),le(N=>u(V,{...i,background:v.bg,color:v.color},N)),w})(),(()=>{var w=_C();return w.style.setProperty("margin","0 0 0.5rem 0"),w.style.setProperty("font-size","1.1rem"),s(w,()=>t.account.name),w})(),(()=>{var w=ki();return u(w,c),s(w,()=>t.account.category),w})(),(()=>{var w=ki();return u(w,a),s(w,()=>y(t.account.balance)),w})(),(()=>{var w=ki();return u(w,d),s(w,()=>t.account.description),w})(),ge(()=>ge(()=>!t.account.isActive)()&&(()=>{var w=ki();return w.style.setProperty("margin-top","0.5rem"),w.style.setProperty("padding","0.25rem 0.75rem"),w.style.setProperty("border-radius","9999px"),w.style.setProperty("font-size","0.75rem"),w.style.setProperty("font-weight","500"),w.style.setProperty("background","#ffebee"),w.style.setProperty("color","#d32f2f"),w.style.setProperty("text-align","center"),s(w,()=>e("common.inactive")),w})()),(()=>{var w=ki();return u(w,r),s(w,_(Le,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.account),get children(){return[ge(()=>e("common.view"))," ",ge(()=>e("accounts.accountDetails"))]}})),w})()]}})};var PC=G("<div><div><div><div></div><h3></h3></div></div><div><div></div><div>"),wC=G("<div>"),CC=G("<button>"),AC=G("<div><h4> (<!>)"),xC=G("<div><div><div></div><div>  </div></div><div>");const IC=t=>{const{t:e}=ct(),r=Dc(),[n,o]=ve(!0),i={"margin-bottom":"1rem"},a={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},c={display:"flex","align-items":"center",gap:"1rem"},d={background:"none",border:"none",cursor:"pointer","font-size":"1.2rem",color:"var(--text-muted)",padding:"0.25rem","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease"},h={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},y={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},v={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},w={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},E={"margin-left":"1rem","border-left":"2px solid var(--border-color)","padding-left":"1rem","margin-top":"1rem"},V={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem","margin-bottom":"0.5rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},N={flex:"1"},x={"font-weight":"500","margin-bottom":"0.25rem"},k={"font-size":"0.875rem",color:"var(--text-muted)"},re={"font-weight":"600",color:"var(--primary-color)"},ae={display:"flex",gap:"0.5rem"},F=C=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[C]||{bg:"#f5f5f5",color:"#666"},Y=C=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(C),U=C=>{t.onViewDetails?t.onViewDetails(C):r(`/accounts/${C.id}`)},b=()=>{t.onAddSubAccount&&t.onAddSubAccount(t.account)},g=t.account.balance+t.account.subAccounts.reduce((C,S)=>C+S.balance,0),p=F(t.account.type);return _(He,{className:"account-hierarchy-card",style:i,get children(){return[(()=>{var C=PC(),S=C.firstChild,A=S.firstChild,m=A.firstChild,ne=m.nextSibling,W=S.nextSibling,I=W.firstChild,O=I.nextSibling;return u(C,a),u(S,c),s(S,(()=>{var J=ge(()=>t.account.subAccounts.length>0);return()=>J()&&(()=>{var D=CC();return D.addEventListener("mouseleave",T=>T.target.style.background="none"),D.addEventListener("mouseenter",T=>T.target.style.background="var(--background-color)"),D.$$click=()=>o(!n()),u(D,d),s(D,()=>n()?"":""),D})()})(),A),A.$$click=()=>U(t.account),A.style.setProperty("cursor","pointer"),u(m,h),s(m,()=>t.account.accountNumber),u(ne,y),s(ne,()=>t.account.name),W.style.setProperty("text-align","right"),u(I,v),s(I,()=>Y(g)),s(O,()=>e(`accounts.types.${t.account.type.toLowerCase()}`)),le(J=>u(O,{...w,background:p.bg,color:p.color},J)),C})(),(()=>{var C=wC();return u(C,ae),s(C,_(Le,{variant:"secondary",size:"sm",onClick:()=>U(t.account),get children(){return[ge(()=>e("common.view"))," ",ge(()=>e("accounts.accountDetails"))]}}),null),s(C,_(Le,{variant:"outline",size:"sm",onClick:b,get children(){return[ge(()=>e("common.add"))," ",ge(()=>e("accounts.subAccounts"))]}}),null),C})(),ge(()=>ge(()=>!!(n()&&t.account.subAccounts.length>0))()&&(()=>{var C=AC(),S=C.firstChild,A=S.firstChild,m=A.nextSibling;return m.nextSibling,u(C,E),S.style.setProperty("margin","0 0 1rem 0"),S.style.setProperty("font-size","1rem"),S.style.setProperty("color","var(--text-muted)"),s(S,()=>e("accounts.subAccounts"),A),s(S,()=>t.account.subAccounts.length,m),s(C,()=>t.account.subAccounts.map(ne=>(()=>{var W=xC(),I=W.firstChild,O=I.firstChild,J=O.nextSibling,D=J.firstChild,T=I.nextSibling;return W.addEventListener("mouseleave",B=>{B.currentTarget.style.background="var(--background-color)",B.currentTarget.style.transform="translateY(0)"}),W.addEventListener("mouseenter",B=>{B.currentTarget.style.background="var(--surface-color)",B.currentTarget.style.transform="translateY(-1px)"}),W.$$click=()=>U(ne),u(W,V),u(I,N),u(O,x),s(O,()=>ne.name),u(J,k),s(J,()=>ne.accountNumber,D),s(J,()=>ne.description,null),u(T,re),s(T,()=>Y(ne.balance)),W})()),null),C})())]}})};Pt(["click"]);var EC=G("<form><div>");const $C=t=>{const{t:e}=ct(),[r,n]=ve({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),o=[{value:"Asset",label:e("accounts.types.asset"),type:"debit",classification:"real"},{value:"Liability",label:e("accounts.types.liability"),type:"credit",classification:"real"},{value:"Equity",label:e("accounts.types.equity"),type:"credit",classification:"real"},{value:"Revenue",label:e("accounts.types.revenue"),type:"credit",classification:"nominal"},{value:"Expense",label:e("accounts.types.expense"),type:"debit",classification:"nominal"}],i=()=>{const y=r().type;return y?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")},{value:"Sales Revenue",label:e("accounts.categories.salesRevenue")},{value:"Service Revenue",label:e("accounts.categories.servicesRevenue")},{value:"Subscription Revenue",label:e("accounts.categories.subscriptionRevenue")},{value:"Rental Revenue",label:e("accounts.categories.rentalRevenue")},{value:"Commission Revenue",label:e("accounts.categories.commissionRevenue")},{value:"Franchise Revenue",label:e("accounts.categories.franchiseRevenue")},{value:"Licensing Revenue",label:e("accounts.categories.licensingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[y]||[]:[]},a=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],c={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},d=y=>{y.preventDefault();const v=r();if(!v.accountNumber||!v.name||!v.type||!v.category){alert(e("forms.requiredField"));return}if(wt.accounts.find(V=>V.accountNumber===v.accountNumber)){alert(e("forms.duplicateAccountNumber"));return}const E={accountNumber:v.accountNumber,name:v.name,type:v.type,category:v.category,description:v.description,balance:parseFloat(v.balance)||0,isActive:v.isActive==="true"};wt.addAccount(E),n({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},h=(y,v)=>{n(w=>{const E={...w,[y]:v};return y==="type"&&(E.category=""),E})};return _(_r,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.addAccount")},get children(){var y=EC(),v=y.firstChild;return y.addEventListener("submit",d),s(y,_(Ot,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:w=>h("accountNumber",w),get placeholder(){return e("accounts.accountNumber")},required:!0}),v),s(y,_(Ot,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:w=>h("name",w),get placeholder(){return e("accounts.accountName")},required:!0}),v),s(y,_(gr,{get label(){return e("accounts.accountType")},get value(){return r().type},onChange:w=>h("type",w),options:o,required:!0}),v),s(y,_(gr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:w=>h("category",w),get options(){return i()},required:!0}),v),s(y,_(Ot,{get label(){return e("common.description")},get value(){return r().description},onChange:w=>h("description",w),get placeholder(){return e("common.description")}}),v),s(y,_(Ot,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:w=>h("balance",w),get placeholder(){return e("accounts.balance")}}),v),s(y,_(gr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:w=>h("isActive",w),options:a,required:!0}),v),u(v,c),s(v,_(Le,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(v,_(Le,{variant:"primary",type:"submit",get children(){return e("accounts.addAccount")}}),null),y}})};var TC=G("<form><div>"),kC=G("<div><div></div><div> - </div><div>  ");const RC=t=>{const{t:e}=ct(),[r,n]=ve({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),o=()=>t.parentAccount?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[t.parentAccount.type]||[]:[],i=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],a={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},c={background:"var(--background-color)",padding:"1rem","border-radius":"var(--border-radius-sm)","margin-bottom":"1.5rem",border:"1px solid var(--border-color)"},d={"font-size":"0.875rem","font-weight":"500",color:"var(--text-muted)","margin-bottom":"0.5rem"},h={"font-weight":"600",color:"var(--text-primary)"},y={"font-size":"0.875rem",color:"var(--text-secondary)"},v=N=>{N.preventDefault();const x=r();if(!x.accountNumber||!x.name||!x.category||!t.parentAccount){alert(e("forms.requiredField"));return}if(wt.accounts.find(ae=>ae.accountNumber===x.accountNumber)){alert(e("forms.duplicateAccountNumber"));return}const re={accountNumber:x.accountNumber,name:x.name,type:t.parentAccount.type,category:x.category,description:x.description,balance:parseFloat(x.balance)||0,isActive:x.isActive==="true",parentAccountId:t.parentAccount.id};wt.addAccount(re),n({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},w=(N,x)=>{n(k=>({...k,[N]:x}))},E=()=>{if(!t.parentAccount)return"";const N=t.parentAccount.accountNumber,k=wt.getSubAccounts(t.parentAccount.id).length+1;return(parseInt(N)+k).toString()},V=()=>r().accountNumber===""&&t.parentAccount?E():r().accountNumber;return _(_r,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return`${e("common.add")} ${e("accounts.subAccounts")}`},get children(){return[ge(()=>ge(()=>!!t.parentAccount)()&&(()=>{var N=kC(),x=N.firstChild,k=x.nextSibling,re=k.firstChild,ae=k.nextSibling,F=ae.firstChild;return u(N,c),u(x,d),s(x,()=>e("accounts.parentAccount")),u(k,h),s(k,()=>t.parentAccount.accountNumber,re),s(k,()=>t.parentAccount.name,null),u(ae,y),s(ae,()=>e(`accounts.types.${t.parentAccount.type.toLowerCase()}`),F),s(ae,()=>t.parentAccount.category,null),N})()),(()=>{var N=TC(),x=N.firstChild;return N.addEventListener("submit",v),s(N,_(Ot,{get label(){return e("accounts.accountNumber")},get value(){return V()},onChange:k=>w("accountNumber",k),get placeholder(){return`${e("common.suggested")}: ${E()}`},required:!0}),x),s(N,_(Ot,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:k=>w("name",k),get placeholder(){return e("accounts.accountName")},required:!0}),x),s(N,_(gr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:k=>w("category",k),get options(){return o()},required:!0}),x),s(N,_(Ot,{get label(){return e("common.description")},get value(){return r().description},onChange:k=>w("description",k),get placeholder(){return e("common.description")}}),x),s(N,_(Ot,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:k=>w("balance",k),get placeholder(){return e("accounts.balance")}}),x),s(N,_(gr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:k=>w("isActive",k),options:i,required:!0}),x),u(x,a),s(x,_(Le,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(x,_(Le,{variant:"primary",type:"submit",get children(){return[ge(()=>e("common.add"))," ",ge(()=>e("accounts.subAccounts"))]}}),null),N})()]}})};var DC=G("<form><div>"),NC=G("<div>");const LC=t=>{const{t:e}=ct(),[r,n]=ve({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),[o,i]=ve(null);Nn(()=>{t.account&&(n({accountNumber:t.account.accountNumber,name:t.account.name,type:t.account.type,category:t.account.category,description:t.account.description,balance:t.account.balance.toString(),isActive:t.account.isActive.toString()}),i(null))});const a=[{value:"Asset",label:e("accounts.types.asset")},{value:"Liability",label:e("accounts.types.liability")},{value:"Equity",label:e("accounts.types.equity")},{value:"Revenue",label:e("accounts.types.revenue")},{value:"Expense",label:e("accounts.types.expense")}],c=()=>{const E=r().type;return E?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[E]||[]:[]},d=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],h={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},y=E=>{if(E.preventDefault(),i(null),!t.account)return;const V=r();if(!V.accountNumber||!V.name||!V.type||!V.category){i(e("forms.requiredField"));return}if(wt.accounts.find(k=>k.accountNumber===V.accountNumber&&k.id!==t.account.id)){i(e("forms.duplicateAccountNumber"));return}const x={accountNumber:V.accountNumber,name:V.name,type:V.type,category:V.category,description:V.description,balance:parseFloat(V.balance)||0,isActive:V.isActive==="true"};try{wt.updateAccount(t.account.id,x),t.onClose()}catch(k){i(k instanceof Error?k.message:e("forms.saveError"))}},v=()=>{if(!t.account)return;const E=wt.canDeleteAccount(t.account.id);if(!E.canDelete){i(E.reason||e("forms.deleteError"));return}const V=e("forms.confirmDelete");if(confirm(V))try{wt.deleteAccount(t.account.id),t.onClose()}catch(N){i(N instanceof Error?N.message:e("forms.deleteError"))}},w=(E,V)=>{n(N=>{const x={...N,[E]:V};return E==="type"&&(x.category=""),x}),o()&&i(null)};return t.account?_(_r,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.editAccount")},get children(){var E=DC(),V=E.firstChild;return E.addEventListener("submit",y),s(E,_(Ot,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:N=>w("accountNumber",N),get placeholder(){return e("accounts.accountNumber")},required:!0}),V),s(E,_(Ot,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:N=>w("name",N),get placeholder(){return e("accounts.accountName")},required:!0}),V),s(E,_(gr,{get label(){return e("accounts.accountType")},get value(){return r().type},onChange:N=>w("type",N),options:a,required:!0}),V),s(E,_(gr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:N=>w("category",N),get options(){return c()},required:!0}),V),s(E,_(Ot,{get label(){return e("common.description")},get value(){return r().description},onChange:N=>w("description",N),get placeholder(){return e("common.description")}}),V),s(E,_(Ot,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:N=>w("balance",N),get placeholder(){return e("accounts.balance")}}),V),s(E,_(gr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:N=>w("isActive",N),options:d,required:!0}),V),s(E,(()=>{var N=ge(()=>!!o());return()=>N()&&(()=>{var x=NC();return x.style.setProperty("padding","1rem"),x.style.setProperty("border-radius","var(--border-radius-sm)"),x.style.setProperty("margin-top","1rem"),x.style.setProperty("background","#f8d7da"),x.style.setProperty("color","#721c24"),x.style.setProperty("border","1px solid #f5c6cb"),s(x,o),x})()})(),V),u(V,h),s(V,_(Le,{variant:"outline",type:"button",onClick:v,style:{color:"#dc3545","border-color":"#dc3545","margin-right":"auto"},get children(){return e("accounts.deleteAccount")}}),null),s(V,_(Le,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(V,_(Le,{variant:"primary",type:"submit",get children(){return e("common.save")}}),null),E}}):null};var MC=G("<div><div></div><div></div><div></div><div>"),OC=G("<div><div></div><div></div><div>"),VC=G("<div><button></button><button> (<!>)"),El=G("<div>"),FC=G("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),BC=G("<div><div><div></div><div>  </div></div><div>");const UC=t=>{const{t:e}=ct(),[r,n]=ve("details"),[o,i]=ve(!1),a=qe(()=>t.account?wt.getAccountById(t.account.id)||t.account:null),c={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},d={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},h={"font-weight":"600",color:"var(--text-primary)"},y={"text-align":"center","margin-bottom":"2rem"},v={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},w={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},E={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem"},V={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},N=p=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:p?"var(--primary-color)":"var(--text-muted)","border-bottom":p?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),x={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},k={flex:"1"},re={"font-size":"0.875rem",color:"var(--text-muted)"},ae={"font-weight":"500","margin-bottom":"0.25rem"},F=p=>({"font-weight":"600",color:p==="debit"?"#4caf50":"#f44336"}),Y={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},U=p=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[p]||{bg:"#f5f5f5",color:"#666"},b=p=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(p),g=p=>new Date(p).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return _(_r,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.accountDetails")},get children(){return[ge(()=>ge(()=>!a())()?(()=>{var p=MC(),C=p.firstChild,S=C.nextSibling,A=S.nextSibling,m=A.nextSibling;return p.style.setProperty("text-align","center"),p.style.setProperty("padding","3rem"),p.style.setProperty("color","var(--text-muted)"),C.style.setProperty("font-size","1.5rem"),C.style.setProperty("margin-bottom","1rem"),S.style.setProperty("font-size","1.1rem"),S.style.setProperty("margin-bottom","0.5rem"),s(S,()=>e("common.error")),A.style.setProperty("font-size","0.875rem"),s(A,()=>e("common.noDataFound")),m.style.setProperty("margin-top","2rem"),s(m,_(Le,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),p})():(()=>{const p=qe(()=>U(a().type)),C=qe(()=>wt.getAccountTransactions(a().id));return[(()=>{var S=OC(),A=S.firstChild,m=A.nextSibling,ne=m.nextSibling;return u(S,y),u(A,v),s(A,()=>a().name),u(m,w),s(m,()=>b(a().balance)),s(ne,()=>e(`accounts.types.${a().type.toLowerCase()}`)),le(W=>u(ne,{...E,background:p().bg,color:p().color},W)),S})(),(()=>{var S=VC(),A=S.firstChild,m=A.nextSibling,ne=m.firstChild,W=ne.nextSibling;return W.nextSibling,u(S,V),A.$$click=()=>n("details"),s(A,()=>e("accounts.accountDetails")),m.$$click=()=>n("transactions"),s(m,()=>e("accounts.transactions"),ne),s(m,()=>C().length,W),le(I=>{var O=N(r()==="details"),J=N(r()==="transactions");return I.e=u(A,O,I.e),I.t=u(m,J,I.t),I},{e:void 0,t:void 0}),S})(),ge(()=>ge(()=>r()==="details")()&&(()=>{var S=FC(),A=S.firstChild,m=A.firstChild,ne=m.nextSibling,W=A.nextSibling,I=W.firstChild,O=I.nextSibling,J=W.nextSibling,D=J.firstChild,T=D.nextSibling,B=J.nextSibling,me=B.firstChild,H=me.nextSibling,de=B.nextSibling,$=de.firstChild,q=$.nextSibling,Z=de.nextSibling,L=Z.firstChild,te=L.nextSibling;return s(m,()=>e("accounts.accountNumber")),s(ne,()=>a().accountNumber),s(I,()=>e("accounts.category")),s(O,()=>a().category),s(D,()=>e("common.description")),s(T,()=>a().description),s(me,()=>e("common.status")),s(H,(()=>{var j=ge(()=>!!a().isActive);return()=>j()?e("common.active"):e("common.inactive")})()),s($,()=>e("accounts.createdDate")),s(q,()=>g(a().createdDate)),s(L,()=>e("accounts.lastModified")),s(te,()=>g(a().lastModified)),le(j=>{var M=c,ie=d,oe=h,fe=c,ue=d,K=h,R=c,ee=d,X=h,ye=c,pe=d,z=h,se=c,_e=d,Pe=h,he=c,be=d,ce=h;return j.e=u(A,M,j.e),j.t=u(m,ie,j.t),j.a=u(ne,oe,j.a),j.o=u(W,fe,j.o),j.i=u(I,ue,j.i),j.n=u(O,K,j.n),j.s=u(J,R,j.s),j.h=u(D,ee,j.h),j.r=u(T,X,j.r),j.d=u(B,ye,j.d),j.l=u(me,pe,j.l),j.u=u(H,z,j.u),j.c=u(de,se,j.c),j.w=u($,_e,j.w),j.m=u(q,Pe,j.m),j.f=u(Z,he,j.f),j.y=u(L,be,j.y),j.g=u(te,ce,j.g),j},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),S})()),ge(()=>ge(()=>r()==="transactions")()&&(()=>{var S=El();return s(S,(()=>{var A=ge(()=>C().length===0);return()=>A()?(()=>{var m=El();return m.style.setProperty("text-align","center"),m.style.setProperty("color","var(--text-muted)"),m.style.setProperty("padding","2rem"),s(m,()=>e("common.noDataFound")),m})():C().map(m=>(()=>{var ne=BC(),W=ne.firstChild,I=W.firstChild,O=I.nextSibling,J=O.firstChild,D=W.nextSibling;return u(ne,x),u(W,k),u(I,ae),s(I,()=>m.description),u(O,re),s(O,()=>g(m.date),J),s(O,()=>m.reference,null),s(D,()=>m.type==="debit"?"+":"-",null),s(D,()=>b(m.type==="debit"?m.debitAmount:m.creditAmount),null),le(T=>u(D,F(m.type),T)),ne})())})()),S})()),(()=>{var S=El();return u(S,Y),s(S,_(Le,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(S,_(Le,{variant:"primary",onClick:()=>i(!0),get children(){return e("accounts.editAccount")}}),null),S})()]})()),ge(()=>ge(()=>!!a())()&&_(LC,{get isOpen(){return o()},onClose:()=>{i(!1)},get account(){return a()}}))]}})};Pt(["click"]);const jC="https://qvamarkets.com/gql_api",[zC,Wh]=ve(!1),[qC,$l]=ve(null);class GC{baseUrl;constructor(e=jC){this.baseUrl=e}async request(e,r,n,o){Wh(!0),$l(null);try{const i=r.startsWith("http")?r:`${this.baseUrl}${r}`,a={method:e,headers:{"Content-Type":"application/json",Accept:"application/json",...o}};n&&(e==="POST"||e==="PUT"||e==="PATCH")&&(a.body=JSON.stringify(n));const c=await fetch(i,a);if(!c.ok)throw new Error(`HTTP error! status: ${c.status}`);const d=await c.json();if(d.errors&&d.errors.length>0)throw new Error(d.errors[0].message);return d.data||d}catch(i){const a=i instanceof Error?i.message:"Unknown error occurred";throw $l(a),i}finally{Wh(!1)}}async graphql(e){return this.request("POST","",e)}async get(e,r){return this.request("GET",e,void 0,r)}async post(e,r,n){return this.request("POST",e,r,n)}async put(e,r,n){return this.request("PUT",e,r,n)}async patch(e,r,n){return this.request("PATCH",e,r,n)}async delete(e,r){return this.request("DELETE",e,void 0,r)}getLoadingState(){return zC()}getErrorState(){return qC()}clearError(){$l(null)}}const js=new GC,$u=`
  fragment AccountFields on Account {
    id
    accountNumber
    name
    type
    category
    description
    balance
    isActive
    parentAccountId
    createdDate
    lastModified
  }
`,HC=`
  query GetAccountById($id: ID!) {
    account(id: $id) {
      ...AccountFields
    }
  }
  ${$u}
`,WC=`
  mutation CreateAccount($input: CreateAccountInput!) {
    createAccount(input: $input) {
      ...AccountFields
    }
  }
  ${$u}
`,YC=`
  mutation UpdateAccount($id: ID!, $input: UpdateAccountInput!) {
    updateAccount(id: $id, input: $input) {
      ...AccountFields
    }
  }
  ${$u}
`,KC=`
  mutation DeleteAccount($id: ID!) {
    deleteAccount(id: $id) {
      success
      message
    }
  }
`;class QC{async getAccounts(e,r){try{if(es.isFakeMode())return await hd.getAll(e);const n=await wn({query:"getAllYabaProducts",params:{businessId:"YB100423253156428"}});return console.log("Real API accounts response:",n),n?.accounts||[]}catch(n){if(console.error("Error fetching accounts:",n),es.isHybridMode())return console.warn("Falling back to fake API for accounts"),await hd.getAll(e);throw n}}async getAccountById(e){try{return(await js.graphql({query:HC,variables:{id:e}})).account}catch(r){throw console.error("Error fetching account:",r),r}}async createAccount(e){try{return(await js.graphql({query:WC,variables:{input:e}})).createAccount}catch(r){throw console.error("Error creating account:",r),r}}async updateAccount(e,r){try{return(await js.graphql({query:YC,variables:{id:e,input:r}})).updateAccount}catch(n){throw console.error("Error updating account:",n),n}}async deleteAccount(e){try{return(await js.graphql({query:KC,variables:{id:e}})).deleteAccount}catch(r){throw console.error("Error deleting account:",r),r}}async getAccountsByType(e){return this.getAccounts({type:e})}async getAccountHierarchy(){const e=await this.getAccounts();return this.buildHierarchy(e)}buildHierarchy(e){const r=new Map,n=[];return e.forEach(o=>{r.set(o.id,{...o,subAccounts:[]})}),e.forEach(o=>{const i=r.get(o.id);if(o.parentAccountId){const a=r.get(o.parentAccountId);a&&(a.subAccounts=a.subAccounts||[],a.subAccounts.push(i))}else n.push(i)}),n}async getAccountBalance(e){const r=await this.getAccountById(e);return r?r.balance:0}async searchAccounts(e){return this.getAccounts({search:e})}}const JC=new QC;var XC=G("<div><h2></h2><div><span>:</span><button></button><button>"),ZC=G("<div><span>:"),Yh=G("<div>"),eA=G("<button>");const tA=()=>{const{t}=ct(),[e,r]=ve(!1),[n,o]=ve(!1),[i,a]=ve(!1),[c,d]=ve(null),[h,y]=ve(null),[v,w]=ve("All"),[E,V]=ve("hierarchy"),N=g=>{d(g),a(!0)},x=g=>{y(g),o(!0)},k=()=>v()==="All"?E()==="hierarchy"?wt.getAccountHierarchy():wt.accounts:E()==="hierarchy"?wt.getAccountHierarchy().filter(g=>g.type===v()):wt.getAccountsByType(v()),re={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(350px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},ae={display:"flex",gap:"1rem","margin-bottom":"2rem","align-items":"center"},F=g=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:g?"var(--primary-color)":"var(--surface-color)",color:g?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500",transition:"all 0.2s ease"}),Y={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},U={display:"flex",gap:"0.5rem","align-items":"center","margin-left":"auto","margin-right":"1rem"},b=g=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:g?"var(--primary-color)":"var(--surface-color)",color:g?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"});return _(Br,{get title(){return t("accounts.title")},get children(){return[_(vC,{}),(()=>{var g=XC(),p=g.firstChild,C=p.nextSibling,S=C.firstChild,A=S.firstChild,m=S.nextSibling,ne=m.nextSibling;return u(g,Y),p.style.setProperty("margin","0"),p.style.setProperty("font-size","1.5rem"),s(p,()=>t("accounts.title")),u(C,U),S.style.setProperty("font-weight","500"),S.style.setProperty("color","var(--text-muted)"),S.style.setProperty("font-size","0.875rem"),s(S,()=>t("common.view"),A),m.$$click=()=>V("hierarchy"),s(m,()=>t("accounts.accountHierarchy")),ne.$$click=()=>{V("flat"),JC.getAccounts()},s(ne,()=>t("common.all")),s(g,_(Le,{variant:"primary",onClick:()=>r(!0),get children(){return t("accounts.addAccount")}}),null),le(W=>{var I=b(E()==="hierarchy"),O=b(E()==="flat");return W.e=u(m,I,W.e),W.t=u(ne,O,W.t),W},{e:void 0,t:void 0}),g})(),(()=>{var g=ZC(),p=g.firstChild,C=p.firstChild;return u(g,ae),p.style.setProperty("font-weight","500"),p.style.setProperty("color","var(--text-muted)"),s(p,()=>t("common.filter"),C),s(g,()=>[t("common.all"),t("accounts.types.asset"),t("accounts.types.liability"),t("accounts.types.equity"),t("accounts.types.revenue"),t("accounts.types.expense")].map((S,A)=>{const ne=["All","Asset","Liability","Equity","Revenue","Expense"][A];return(()=>{var W=eA();return W.$$click=()=>w(ne),s(W,S),le(I=>u(W,F(v()===ne),I)),W})()}),null),g})(),(()=>{var g=Yh();return s(g,(()=>{var p=ge(()=>E()==="hierarchy");return()=>p()?k().map(C=>_(IC,{account:C,onAddSubAccount:x,onViewDetails:N})):k().map(C=>_(SC,{account:C,onViewDetails:N}))})()),le(p=>u(g,E()==="hierarchy"?{display:"flex","flex-direction":"column",gap:"1rem"}:re,p)),g})(),ge(()=>ge(()=>k().length===0)()&&(()=>{var g=Yh();return g.style.setProperty("text-align","center"),g.style.setProperty("color","var(--text-muted)"),g.style.setProperty("padding","3rem"),g.style.setProperty("font-size","1.1rem"),s(g,()=>t("common.noDataFound")),g})()),_($C,{get isOpen(){return e()},onClose:()=>r(!1)}),_(RC,{get isOpen(){return n()},onClose:()=>o(!1),get parentAccount(){return h()}}),_(UC,{get isOpen(){return i()},onClose:()=>a(!1),get account(){return c()}})]}})};Pt(["click"]);var rA=G("<div><h2>"),Go=G("<div>"),nA=G("<div><div><div></div><h1></h1><div></div></div><div>"),oA=G("<div><button></button><button> (<!>)"),zs=G("<div><span></span><span>"),iA=G("<p>"),sA=G("<div><div></div><div>"),aA=G("<div><div><div></div><div>  </div></div><div>");const lA=()=>{const{t}=ct(),e=Vg(),r=Dc(),[n,o]=ve(null),[i,a]=ve("overview");Hr(()=>{const m=wt.getAccountById(e.id);m?o(m):r("/accounts")});const c={display:"flex","align-items":"center",gap:"0.5rem","margin-bottom":"1rem"},d={display:"flex","align-items":"center",gap:"1rem","margin-bottom":"2rem"},h={"font-size":"1rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},y={"font-size":"2.5rem","font-weight":"700",color:"var(--primary-color)"},v={padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},w={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},E=m=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:m?"var(--primary-color)":"var(--text-muted)","border-bottom":m?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),V={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},N={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},x={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},k={"font-weight":"500",color:"var(--text-muted)"},re={"font-weight":"600",color:"var(--text-primary)"},ae={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},F={flex:"1"},Y={"font-weight":"500","margin-bottom":"0.25rem"},U={"font-size":"0.875rem",color:"var(--text-muted)"},b=m=>({"font-weight":"600",color:m==="debit"?"#4caf50":"#f44336"});if(!n())return _(Br,{get title(){return t("accounts.accountDetails")},get children(){var m=rA(),ne=m.firstChild;return m.style.setProperty("text-align","center"),m.style.setProperty("padding","3rem"),s(ne,()=>t("common.error")),s(m,_(Le,{variant:"primary",onClick:()=>r("/accounts"),get children(){return[ge(()=>t("common.back"))," ",ge(()=>t("navigation.accounts"))]}}),null),m}});const g=m=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[m]||{bg:"#f5f5f5",color:"#666"},p=m=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(m),C=m=>new Date(m).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),S=g(n().type),A=wt.getAccountTransactions(n().id);return _(Br,{get title(){return n().name},get children(){return[(()=>{var m=Go();return u(m,c),s(m,_(Le,{variant:"secondary",onClick:()=>r("/accounts"),get children(){return[" ",ge(()=>t("common.back"))," ",ge(()=>t("navigation.accounts"))]}})),m})(),(()=>{var m=nA(),ne=m.firstChild,W=ne.firstChild,I=W.nextSibling,O=I.nextSibling,J=ne.nextSibling;return u(m,d),u(W,h),s(W,()=>n().accountNumber),I.style.setProperty("margin","0.5rem 0"),I.style.setProperty("font-size","2rem"),s(I,()=>n().name),u(O,y),s(O,()=>p(n().balance)),s(J,()=>n().type),le(D=>u(J,{...v,background:S.bg,color:S.color},D)),m})(),(()=>{var m=oA(),ne=m.firstChild,W=ne.nextSibling,I=W.firstChild,O=I.nextSibling;return O.nextSibling,u(m,w),ne.$$click=()=>a("overview"),s(ne,()=>t("dashboard.overview")),W.$$click=()=>a("transactions"),s(W,()=>t("accounts.transactions"),I),s(W,()=>A.length,O),le(J=>{var D=E(i()==="overview"),T=E(i()==="transactions");return J.e=u(ne,D,J.e),J.t=u(W,T,J.t),J},{e:void 0,t:void 0}),m})(),ge(()=>ge(()=>i()==="overview")()&&(()=>{var m=sA(),ne=m.firstChild,W=ne.nextSibling;return u(ne,V),s(ne,_(He,{get title(){return t("accounts.balance")},get subtitle(){return t("dashboard.overview")},get children(){var I=Go();return I.style.setProperty("font-size","1.5rem"),I.style.setProperty("font-weight","600"),I.style.setProperty("color","var(--primary-color)"),s(I,()=>p(n().balance)),I}}),null),s(ne,_(He,{get title(){return t("accounts.accountType")},get subtitle(){return t("accounts.category")},get children(){var I=Go();return I.style.setProperty("font-size","1.5rem"),I.style.setProperty("font-weight","600"),I.style.setProperty("color","var(--primary-color)"),s(I,()=>t(`accounts.types.${n().type.toLowerCase()}`)),I}}),null),s(ne,_(He,{get title(){return t("common.status")},get subtitle(){return t("accounts.accountDetails")},get children(){var I=Go();return I.style.setProperty("font-size","1.5rem"),I.style.setProperty("font-weight","600"),s(I,(()=>{var O=ge(()=>!!n().isActive);return()=>O()?t("common.active"):t("common.inactive")})()),le(O=>(O=n().isActive?"#4caf50":"#f44336")!=null?I.style.setProperty("color",O):I.style.removeProperty("color")),I}}),null),s(ne,_(He,{get title(){return t("accounts.transactions")},get subtitle(){return t("common.total")},get children(){var I=Go();return I.style.setProperty("font-size","1.5rem"),I.style.setProperty("font-weight","600"),I.style.setProperty("color","var(--primary-color)"),s(I,()=>A.length),I}}),null),u(W,N),s(W,_(He,{get title(){return t("accounts.accountDetails")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var I=zs(),O=I.firstChild,J=O.nextSibling;return s(O,()=>t("accounts.accountNumber")),s(J,()=>n().accountNumber),le(D=>{var T=x,B=k,me=re;return D.e=u(I,T,D.e),D.t=u(O,B,D.t),D.a=u(J,me,D.a),D},{e:void 0,t:void 0,a:void 0}),I})(),(()=>{var I=zs(),O=I.firstChild,J=O.nextSibling;return s(O,()=>t("accounts.category")),s(J,()=>n().category),le(D=>{var T=x,B=k,me=re;return D.e=u(I,T,D.e),D.t=u(O,B,D.t),D.a=u(J,me,D.a),D},{e:void 0,t:void 0,a:void 0}),I})(),(()=>{var I=zs(),O=I.firstChild,J=O.nextSibling;return s(O,()=>t("common.date")),s(J,()=>C(n().createdDate)),le(D=>{var T=x,B=k,me=re;return D.e=u(I,T,D.e),D.t=u(O,B,D.t),D.a=u(J,me,D.a),D},{e:void 0,t:void 0,a:void 0}),I})(),(()=>{var I=zs(),O=I.firstChild,J=O.nextSibling;return s(O,()=>t("common.date")),s(J,()=>C(n().lastModified)),le(D=>{var T=x,B=k,me=re;return D.e=u(I,T,D.e),D.t=u(O,B,D.t),D.a=u(J,me,D.a),D},{e:void 0,t:void 0,a:void 0}),I})()]}}),null),s(W,_(He,{get title(){return t("common.description")},get subtitle(){return t("accounts.accountDetails")},get children(){var I=iA();return I.style.setProperty("margin","0"),I.style.setProperty("color","var(--text-secondary)"),s(I,()=>n().description||t("common.noDataFound")),I}}),null),m})()),ge(()=>ge(()=>i()==="transactions")()&&_(He,{get title(){return t("accounts.accountHistory")},get subtitle(){return t("accounts.transactions")},get children(){return ge(()=>A.length===0)()?(()=>{var m=Go();return m.style.setProperty("text-align","center"),m.style.setProperty("color","var(--text-muted)"),m.style.setProperty("padding","2rem"),s(m,()=>t("common.noDataFound")),m})():A.map(m=>(()=>{var ne=aA(),W=ne.firstChild,I=W.firstChild,O=I.nextSibling,J=O.firstChild,D=W.nextSibling;return u(ne,ae),u(W,F),u(I,Y),s(I,()=>m.description),u(O,U),s(O,()=>C(m.date),J),s(O,()=>m.reference,null),s(D,()=>m.type==="debit"?"+":"-",null),s(D,()=>p(m.type==="debit"?m.debitAmount:m.creditAmount),null),le(T=>u(D,b(m.type),T)),ne})())}}))]}})};Pt(["click"]);var cA=G("<div><div><h1></h1><p> </p></div><div><input type=date>"),_n=G("<div><span></span><span>"),uA=G("<div><div></div><div>"),dA=G("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),hA=G("<div><div> (<!> = <!> + <!>)</div><div> = "),mA=G("<span>(<!>: <!>)");const yA=()=>{const{t}=ct(),[e,r]=ve(new Date().toISOString().split("T")[0]),[n,o]=ve(0),[i,a]=ve(0),[c,d]=ve(0);Hr(()=>{h()});const h=()=>{const V=wt.getAccountsByType("Asset"),N=wt.getAccountsByType("Liability"),x=wt.getAccountsByType("Equity"),k=V.reduce((F,Y)=>F+Y.balance,0),re=N.reduce((F,Y)=>F+Y.balance,0),ae=x.reduce((F,Y)=>F+Y.balance,0);o(k),a(re),d(ae)},y=V=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(V),v={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},w={"margin-bottom":"2rem"},E={"font-weight":"bold","font-size":"1.1rem","border-top":"2px solid var(--border-color)","padding-top":"0.5rem","margin-top":"1rem"};return _(Br,{get title(){return t("balanceSheet.title")},get children(){return[(()=>{var V=cA(),N=V.firstChild,x=N.firstChild,k=x.nextSibling,re=k.firstChild,ae=N.nextSibling,F=ae.firstChild;return u(V,v),x.style.setProperty("margin","0"),s(x,()=>t("balanceSheet.title")),k.style.setProperty("margin","0.5rem 0 0 0"),k.style.setProperty("color","var(--text-muted)"),s(k,()=>t("balanceSheet.asOf"),re),s(k,()=>new Date(e()).toLocaleDateString(),null),ae.style.setProperty("display","flex"),ae.style.setProperty("gap","1rem"),F.addEventListener("change",Y=>r(Y.target.value)),F.style.setProperty("padding","0.5rem"),F.style.setProperty("border","1px solid var(--border-color)"),F.style.setProperty("border-radius","var(--border-radius-sm)"),s(ae,_(Le,{variant:"primary",onClick:h,get children(){return t("balanceSheet.generateReport")}}),null),le(()=>F.value=e()),V})(),(()=>{var V=uA(),N=V.firstChild,x=N.nextSibling;return V.style.setProperty("display","grid"),V.style.setProperty("grid-template-columns","1fr 1fr"),V.style.setProperty("gap","2rem"),s(N,_(He,{get title(){return t("balanceSheet.assets")},style:w,get children(){return[(()=>{var k=_n(),re=k.firstChild,ae=re.nextSibling;return k.style.setProperty("display","flex"),k.style.setProperty("justify-content","space-between"),k.style.setProperty("align-items","center"),s(re,()=>t("balanceSheet.currentAssets")),s(ae,()=>y(n()*.6)),k})(),(()=>{var k=_n(),re=k.firstChild,ae=re.nextSibling;return k.style.setProperty("display","flex"),k.style.setProperty("justify-content","space-between"),k.style.setProperty("align-items","center"),s(re,()=>t("balanceSheet.nonCurrentAssets")),s(ae,()=>y(n()*.4)),k})(),(()=>{var k=_n(),re=k.firstChild,ae=re.nextSibling;return s(re,()=>t("balanceSheet.totalAssets")),s(ae,()=>y(n())),le(F=>u(k,{...E,display:"flex","justify-content":"space-between"},F)),k})()]}})),s(x,_(He,{get title(){return t("balanceSheet.liabilities")},style:w,get children(){return[(()=>{var k=_n(),re=k.firstChild,ae=re.nextSibling;return k.style.setProperty("display","flex"),k.style.setProperty("justify-content","space-between"),k.style.setProperty("align-items","center"),s(re,()=>t("balanceSheet.currentLiabilities")),s(ae,()=>y(i()*.7)),k})(),(()=>{var k=_n(),re=k.firstChild,ae=re.nextSibling;return k.style.setProperty("display","flex"),k.style.setProperty("justify-content","space-between"),k.style.setProperty("align-items","center"),s(re,()=>t("balanceSheet.nonCurrentLiabilities")),s(ae,()=>y(i()*.3)),k})(),(()=>{var k=_n(),re=k.firstChild,ae=re.nextSibling;return s(re,()=>t("balanceSheet.totalLiabilities")),s(ae,()=>y(i())),le(F=>u(k,{...E,display:"flex","justify-content":"space-between"},F)),k})()]}}),null),s(x,_(He,{get title(){return t("balanceSheet.equity")},get children(){return[(()=>{var k=_n(),re=k.firstChild,ae=re.nextSibling;return k.style.setProperty("display","flex"),k.style.setProperty("justify-content","space-between"),k.style.setProperty("align-items","center"),s(re,()=>t("balanceSheet.commonStock")),s(ae,()=>y(c()*.8)),k})(),(()=>{var k=_n(),re=k.firstChild,ae=re.nextSibling;return k.style.setProperty("display","flex"),k.style.setProperty("justify-content","space-between"),k.style.setProperty("align-items","center"),s(re,()=>t("balanceSheet.retainedEarnings")),s(ae,()=>y(c()*.2)),k})(),(()=>{var k=_n(),re=k.firstChild,ae=re.nextSibling;return s(re,()=>t("balanceSheet.totalEquity")),s(ae,()=>y(c())),le(F=>u(k,{...E,display:"flex","justify-content":"space-between"},F)),k})()]}}),null),V})(),_(He,{get title(){return t("dashboard.overview")},style:{"margin-top":"2rem"},get children(){return[(()=>{var V=dA(),N=V.firstChild,x=N.firstChild,k=x.nextSibling,re=N.nextSibling,ae=re.firstChild,F=ae.nextSibling,Y=re.nextSibling,U=Y.firstChild,b=U.nextSibling;return V.style.setProperty("display","grid"),V.style.setProperty("grid-template-columns","repeat(3, 1fr)"),V.style.setProperty("gap","2rem"),N.style.setProperty("text-align","center"),x.style.setProperty("font-size","0.875rem"),x.style.setProperty("color","var(--text-muted)"),x.style.setProperty("margin-bottom","0.5rem"),s(x,()=>t("balanceSheet.totalAssets")),k.style.setProperty("font-size","1.5rem"),k.style.setProperty("font-weight","bold"),k.style.setProperty("color","var(--primary-color)"),s(k,()=>y(n())),re.style.setProperty("text-align","center"),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),ae.style.setProperty("margin-bottom","0.5rem"),s(ae,()=>t("balanceSheet.totalLiabilities")),F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","bold"),F.style.setProperty("color","#f44336"),s(F,()=>y(i())),Y.style.setProperty("text-align","center"),U.style.setProperty("font-size","0.875rem"),U.style.setProperty("color","var(--text-muted)"),U.style.setProperty("margin-bottom","0.5rem"),s(U,()=>t("balanceSheet.totalEquity")),b.style.setProperty("font-size","1.5rem"),b.style.setProperty("font-weight","bold"),b.style.setProperty("color","#4caf50"),s(b,()=>y(c())),V})(),(()=>{var V=hA(),N=V.firstChild,x=N.firstChild,k=x.nextSibling,re=k.nextSibling,ae=re.nextSibling,F=ae.nextSibling,Y=F.nextSibling;Y.nextSibling;var U=N.nextSibling,b=U.firstChild;return V.style.setProperty("margin-top","2rem"),V.style.setProperty("text-align","center"),N.style.setProperty("font-size","0.875rem"),N.style.setProperty("color","var(--text-muted)"),N.style.setProperty("margin-bottom","0.5rem"),s(N,()=>t("common.total"),x),s(N,()=>t("balanceSheet.totalAssets"),k),s(N,()=>t("balanceSheet.totalLiabilities"),ae),s(N,()=>t("balanceSheet.totalEquity"),Y),U.style.setProperty("font-size","1.2rem"),U.style.setProperty("font-weight","bold"),s(U,()=>y(n()),b),s(U,()=>y(i()+c()),null),s(U,(()=>{var g=ge(()=>Math.abs(n()-(i()+c()))>.01);return()=>g()&&(()=>{var p=mA(),C=p.firstChild,S=C.nextSibling,A=S.nextSibling,m=A.nextSibling;return m.nextSibling,p.style.setProperty("font-size","0.875rem"),p.style.setProperty("color","#f44336"),p.style.setProperty("display","block"),s(p,()=>t("common.error"),S),s(p,()=>y(n()-(i()+c())),m),p})()})(),null),le(g=>(g=Math.abs(n()-(i()+c()))<.01?"#4caf50":"#f44336")!=null?U.style.setProperty("color",g):U.style.removeProperty("color")),V})()]}})]}})};Pt(["click"]);const fA=[{id:"YY_8802",code:"YY_8802",name:"CENTER",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8803",code:"YY_8803",name:"BISSONNET",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8804",code:"YY_8804",name:"IRVIN",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8805",code:"YY_8805",name:"KATTY",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8816",code:"YY_8816",type:"store",name:"YABA GLOBAL",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8818",code:"YY_8818",type:"store",name:"YABASURAUSTIN",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8847",code:"YY_8847",type:"store",name:"YABAOFICINA AZ",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_3251",code:"YY_3251",type:"store",name:"YABA FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_32",code:"YY_32",type:"store",name:"YABA MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_76",code:"YY_76",type:"store",name:"YABA DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_79",code:"YY_79",type:"warehouse",name:"ALMACEN DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8635",code:"YY_8635",type:"store",name:"FASHION MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8665",code:"YY_8665",name:"IRVIN FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,type:"store",createdDate:"2024-01-01"},{id:"YY_8901",code:"YY_8901",name:"ALMACEN CENTRAL YABA",bussinesId:"YB100423253156428",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01"}],pA=[{id:"1",name:'MacBook Pro 16"',price:2399,quantity:75,category:"Electronics",description:"Apple MacBook Pro 16-inch with M2 Pro chip",sku:"MBP-16-M2P",supplier:"Apple Inc.",minStock:10,location:"Warehouse A",lastUpdated:"2024-01-15"},{id:"2",name:'Dell Monitor 27"',price:299,quantity:35,category:"Electronics",description:"Dell 27-inch 4K UHD Monitor",sku:"DELL-MON-27-4K",supplier:"Dell Technologies",minStock:15,location:"Warehouse B",lastUpdated:"2024-01-14"},{id:"3",name:"Wireless Mouse",price:49.99,quantity:12,category:"Accessories",description:"Ergonomic wireless mouse with precision tracking",sku:"MOUSE-WL-001",supplier:"Logitech",minStock:25,location:"Warehouse A",lastUpdated:"2024-01-13"}],qs=()=>{const t=new Map;return jr().forEach(e=>{const r=`${e.productId}-${e.locationId}`;let n=Ne.getLocationById(e.locationId),o=t.get(r);o||(o={id:r,productId:e.productId,locationId:e.locationId,locationName:n?.name,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,o)),e.movementType==="in"||e.movementType==="transfer"?(e.locationId===e.toLocationId||e.movementType==="in")&&(o.quantity+=e.quantity*1):e.movementType==="out"?o.quantity-=e.quantity*1:e.movementType==="adjustment"&&(o.quantity=e.quantity*1),new Date(e.createdDate)>new Date(o.lastMovementDate)&&(o.lastMovementDate=e.createdDate,o.lastMovementType=e.movementType),o.averageCost=e.unitCost*1,o.availableQuantity=o.quantity*1-o.reservedQuantity*1}),Array.from(t.values())},[go,Tl]=ve([]),[vo,Kh]=ve(fA),[jr,Gs]=ve([]),[zn,ji]=ve([]),gA=()=>{const t=new Map;return jr().forEach(e=>{const r=`${e.productId}-${e.locationId}`;let n=t.get(r),o=Ne.getLocationById(e.locationId);n||(n={id:r,productId:e.productId,locationId:e.locationId,locationName:o?.name,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType==="in"||e.movementType==="transfer"?(e.locationId===e.toLocationId||e.movementType==="in")&&(n.quantity+=e.quantity*1):e.movementType==="out"?n.quantity-=e.quantity*1:e.movementType==="adjustment"&&(n.quantity=e.quantity*1),new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost*1,n.availableQuantity=n.quantity*1-n.reservedQuantity*1}),Array.from(t.values())};ji(gA());const[Hs,kl]=ve(pA),vA={TRANSFER:1,transfer:1},Qh=173442384e4,Ne={get products(){return go()},get locations(){return vo()},get movements(){return jr()},get stockLevels(){return zn()},parseInventoryData:t=>{const e=Object.keys(t).slice(0,900),r=[],n=o=>{let i=t;i[o]?.products&&i[o]?.products?.map(a=>{let c=av(i[o]?.type),d=a?.price*1||a?.unitCost*1,h=a?.qty*1||a?.quantity*1;d=isNaN(d)?0:d,h=isNaN(h)?0:h;let y={id:i[o]?.ssg_inventory_key,productId:a?.product?.id,productName:a?.product?.label,productSku:a?.product?.code,locationId:i[o]?.store,locationName:i[o]?.store,location:i[o]?.store,movementType:c,quantity:h,unitCost:d,totalCost:d*1*h,minStock:10,referenceNumber:"PO-001",notes:i[o]?.description||i[o]?.notes,createdBy:"admin",createdDate:i[o]?.createDate?new Date(i[o]?.createDate).toISOString():new Date(Qh).toISOString(),invoiceId:i[o]?.invoice};if(r.push(y),vA[i[o].movementType]&&i[o]?.fromLocationId){let v=Ne.getLocationById(i[o]?.fromLocationId);const w={id:i[o]?.ssg_inventory_key,productId:a?.product?.id,productName:a?.product?.label,productSku:a?.product?.code,locationId:i[o]?.fromLocationId,locationName:v?.name||"",movementType:"out",quantity:h*-1,unitCost:d,totalCost:d*-1*h,minStock:10,referenceNumber:i[o]?.referenceNumber,notes:`Transfer to ${i[o]?.locationName}`+(i[o].notes?` - ${i[o].notes}`:""),createdBy:i[o].createdBy,createdDate:i[o]?.createDate?new Date(i[o]?.createDate).toISOString():new Date(Qh).toISOString(),invoiceId:i[o]?.invoiceId,toLocationId:i[o]?.locationId,toLocationName:i[o]?.locationName};r.push(w)}})};return e.map(n),r},fecthInventory:async t=>{const e=await ln.getInventory(t),r=Ne.parseInventoryData(e);Ne.updMovements(r)},fecthProduct:async t=>{const e=await ln.getProducts(t),r=Object.keys(e),n=i=>{let a=e;return{id:i,name:a[i].name,businessId:a[i].businessId,sku:a[i].code,UPC:a[i].UPC,numCode:a[i].codeN,category:a[i].category,unitCost:a[i].unitCost||0,unitOfMeasure:a[i].unitOfMeasure||a[i].unit,minStockLevel:a[i].minStockLevel,maxStockLevel:a[i].maxStockLevel,isActive:a[i].isActive,productImageUrl:a[i].productImageUrl,description:a[i].description||"",createdDate:a[i].createdAt||new Date().toISOString(),lastModified:a[i].updatedAt||new Date().toISOString()}},o=r.map(n);return Ne.updProduct(o),o},getProductById:t=>go().find(e=>e.id===t),updProduct:t=>{Tl(t)},getProductsBySku:t=>go().filter(e=>e.sku.toLowerCase().includes(t.toLowerCase())),getProductsByCategory:t=>go().filter(e=>e.category===t),getActiveProducts:()=>go().filter(t=>t.name),getLocationById:t=>vo().find(e=>e.id===t),getLocationsByType:t=>vo().filter(e=>e.type===t),getActiveLocations:()=>{let t=St?.state?.profile?.stores;return vo().filter(e=>t?.[e?.id])},getMovementsByProduct:t=>jr().filter(e=>e.productId===t),updMovements:t=>{Gs([...t]),ji(qs())},getMovementsByLocation:t=>jr().filter(e=>e.locationId===t),getMovementsByDateRange:(t,e)=>jr().filter(r=>r.createdDate>=t&&r.createdDate<=e),getStockByProduct:t=>zn().filter(e=>e.productId===t),getStockByLocation:t=>zn().filter(e=>e.locationId===t),getStockByProductAndLocation:(t,e)=>zn().find(r=>r.productId===t&&r.locationId===e),getTotalStockByProduct:t=>zn().filter(e=>e.productId===t).reduce((e,r)=>e*1+r.quantity*1,0),getLastLocationByProduct:t=>{const e=jr().filter(r=>r.productId===t).sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime());if(e.length>0)return vo().find(r=>r.id===e[0].locationId)},getLowStockProducts:()=>(go()||[])?.map(t=>{const e=zn().filter(r=>r.productId===t.id).reduce((r,n)=>r+n.quantity,0);return{...t,currentStock:e}}).filter(t=>t.currentStock<=t.minStockLevel),addInventoryMovement:t=>{const e={...t,id:`mov-${Date.now()}`,createdDate:new Date().toISOString()};Gs(r=>[...r,e]),ji(qs())},addBulkInventoryMovements:async t=>{const e=[],r=[],n=new Date().toISOString(),o=vo().find(c=>c.id===t.locationId);if(!o)return{success:!1,errors:["Invalid location"]};let i;if(t.movementType==="transfer"){if(!t.fromLocationId)return{success:!1,errors:["From location required for transfers"]};if(i=vo().find(c=>c.id===t.fromLocationId),!i)return{success:!1,errors:["Invalid from location"]};if(t.fromLocationId===t.locationId)return{success:!1,errors:["From and to locations cannot be the same"]}}if(t.items.forEach((c,d)=>{const h=go().find(E=>E.id===c.productId);if(!h){e.push(`Item ${d+1}: Product not found`);return}if(c.quantity<=0){e.push(`Item ${d+1}: Quantity must be greater than 0`);return}if(t.movementType==="out"){const E=zn().filter(V=>V.productId===c.productId&&V.locationId===t.locationId).reduce((V,N)=>V+N.quantity,0);if(c.quantity>E){e.push(`Item ${d+1}: Insufficient stock. Available: ${E}, Requested: ${c.quantity}`);return}}if(t.movementType==="transfer"){const E=zn().filter(V=>V.productId===c.productId&&V.locationId===t.fromLocationId).reduce((V,N)=>V+N.quantity,0);if(c.quantity>E){e.push(`Item ${d+1}: Insufficient stock at ${i?.name}. Available: ${E}, Requested: ${c.quantity}`);return}}const y=c.unitCost||h.unitCost,v=c.quantity*y,w={id:`mov-${Date.now()}-${d}`,productId:h.id,productName:h.name,productSku:h.sku,locationId:t.locationId,locationName:o.name,movementType:t.movementType,quantity:c.quantity,unitCost:y,totalCost:v,minStock:10,referenceNumber:t.referenceNumber||"",notes:c.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:i?.name};if(r.push(w),t.movementType==="transfer"&&i){const E={id:`mov-${Date.now()}-${d}-out`,productId:h.id,productName:h.name,productSku:h.sku,locationId:t.fromLocationId,locationName:i.name,movementType:"out",quantity:c.quantity,unitCost:y,totalCost:v,minStock:10,referenceNumber:t.referenceNumber||"",notes:`Transfer to ${o.name}`+(c.notes?` - ${c.notes}`:""),createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,toLocationId:t.locationId,toLocationName:o.name};r.push(E)}}),e.length>0)return{success:!1,errors:e};Gs(c=>[...c,...r]),ji(qs()),console.log({bulkRequest:t});const a=await ln.addInventory(t);return console.log({prodResults:a}),{success:!0,errors:[]}},getMovementsByInvoice:t=>jr().filter(e=>e.invoiceId===t),getInvoiceSummary:t=>{const e=jr().filter(i=>i.invoiceId===t);if(e.length===0)return null;const r=e.reduce((i,a)=>i+a.totalCost,0),n=new Set(e.map(i=>i.productId)).size,o=e[0];return{invoiceId:t,referenceNumber:o.referenceNumber,movementType:o.movementType,location:o.locationName,fromLocation:o.fromLocationName,productCount:n,totalItems:e.reduce((i,a)=>i+a.quantity,0),totalValue:r,createdDate:o.createdDate,createdBy:o.createdBy}},addProduct:t=>{const e={...t,id:`prod-${Date.now()}`,createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};Tl(r=>[...r,e])},addLocation:t=>{const e={...t,id:`loc-${Date.now()}`,createdDate:new Date().toISOString()};Kh(r=>[...r,e])},updateProduct:(t,e)=>{Tl(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n))},updateLocation:(t,e)=>{Kh(r=>r.map(n=>n.id===t?{...n,...e}:n))},updateMovement:(t,e)=>{Gs(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n)),ji(qs())},get inventory(){return Hs()},addItem(t){const e={...t,id:Date.now().toString(),lastUpdated:new Date().toISOString().split("T")[0]};return kl([...Hs(),e]),e},updateItem(t,e){kl(Hs().map(r=>r.id===t?{...r,...e,lastUpdated:new Date().toISOString().split("T")[0]}:r))},deleteItem(t){kl(Hs().filter(e=>e.id!==t))},getItemById(t){return jr().find(e=>e.id===t)},getLowStockItems(){return jr().filter(t=>t.quantity*1<=t.minStock*1)},getTotalValue(){return jr().reduce((t,e)=>t*1+e.unitCost*1*e.quantity*1,0)}};var Jh=G("<div>"),bA=G("<div><div><input type=text autocomplete=off>"),_A=G("<button type=button>+"),SA=G("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div>");const Tu=t=>{const{t:e}=ct(),[r,n]=ve(!1),[o,i]=ve(""),[a,c]=ve(-1),d=qe(()=>t.value?Ne.getProductById(t.value):null),h=qe(()=>{const W=o().toLowerCase();return W?Ne.getActiveProducts().filter(I=>I.name.toLowerCase().includes(W)||I.sku.toLowerCase().includes(W)||I?.UPC?.toLowerCase().includes(W)||I.category.toLowerCase().includes(W)):Ne.getActiveProducts()}),y=()=>{n(!0),i(""),c(-1)},v=W=>{const I=W.target;i(I.value),n(!0),c(-1)},w=W=>{t.onChange(W),n(!1),i(""),c(-1)},E=W=>{const I=h();switch(W.key){case"ArrowDown":W.preventDefault(),c(O=>Math.min(O+1,I.length-1));break;case"ArrowUp":W.preventDefault(),c(O=>Math.max(O-1,-1));break;case"Enter":W.preventDefault(),a()>=0&&I[a()]&&w(I[a()]);break;case"Escape":n(!1),i(""),c(-1);break}},V=W=>{setTimeout(()=>{n(!1),i(""),c(-1)},150)},N=W=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(W),x=W=>Ne.stockLevels.filter(I=>I.productId===W).reduce((I,O)=>I+O.quantity,0),k={position:"relative",width:"100%",...t.style},re={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},ae={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},F=W=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid "+W?"var(--primary-color)":"var(--border-color)",background:W?"var(--strip-color)":"transparent",color:W?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),Y={display:"flex","justify-content":"space-between","align-items":"center"},U={flex:"1"},b={"font-weight":"500","margin-bottom":"0.25rem"},g={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},p={"text-align":"right","font-size":"0.875rem"},C={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},S=()=>r()&&o()?o():d()?`${d().name} (${d().sku})`:"",A={display:"flex","align-items":"stretch",width:"100%"},m={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},ne={...re,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"};return(()=>{var W=bA(),I=W.firstChild,O=I.firstChild;return u(I,A),O.addEventListener("blur",V),O.$$keydown=E,O.$$click=y,O.$$input=v,s(I,(()=>{var J=ge(()=>!!t.onAddNew);return()=>J()&&(()=>{var D=_A();return D.addEventListener("mouseleave",T=>{T.currentTarget.style.background="var(--surface-color)",T.currentTarget.style.color="var(--primary-color)"}),D.addEventListener("mouseenter",T=>{T.currentTarget.style.background="var(--primary-color)",T.currentTarget.style.color="white"}),co(D,"click",t.onAddNew,!0),u(D,m),le(()=>lt(D,"title",e("inventory.addProduct","Add new product"))),D})()})(),null),s(W,_(De,{get when(){return r()},get children(){var J=Jh();return s(J,_(De,{get when(){return h().length>0},get fallback(){return(()=>{var D=Jh();return u(D,C),s(D,(()=>{var T=ge(()=>!!o());return()=>T()?e("inventory.noProductsFound","No products found matching your search."):e("inventory.noProductsAvailable","No products available.")})()),D})()},get children(){return _(at,{get each(){return h()},children:(D,T)=>{const B=x(D.id),me=B<=D.minStockLevel;return(()=>{var H=SA(),de=H.firstChild,$=de.firstChild,q=$.firstChild,Z=q.nextSibling,L=Z.firstChild,te=L.firstChild,j=L.nextSibling,M=j.nextSibling,ie=M.nextSibling,oe=ie.nextSibling,fe=$.nextSibling,ue=fe.firstChild,K=ue.firstChild,R=ue.nextSibling;return H.addEventListener("mouseenter",()=>c(T())),H.$$click=()=>w(D),u(de,Y),u($,U),u(q,b),s(q,()=>D.name),u(Z,g),s(L,()=>e("inventory.sku","SKU"),te),s(L,()=>D.sku,null),s(M,()=>D.category),s(oe,()=>N(D.unitCost)),u(fe,p),ue.style.setProperty("font-weight","600"),(me?"#f44336":"var(--text-primary)")!=null?ue.style.setProperty("color",me?"#f44336":"var(--text-primary)"):ue.style.removeProperty("color"),s(ue,B,K),s(ue,()=>D.unitOfMeasure,null),R.style.setProperty("color","var(--text-muted)"),s(R,()=>me?e("inventory.lowStock","Low Stock"):e("inventory.inStock","In Stock")),le(ee=>u(H,F(T()===a()),ee)),H})()}})}})),le(D=>u(J,ae,D)),J}}),null),le(J=>{var D=k,T=ne,B=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),me=t.disabled,H=t.required;return J.e=u(W,D,J.e),J.t=u(O,T,J.t),B!==J.a&&lt(O,"placeholder",J.a=B),me!==J.o&&(O.disabled=J.o=me),H!==J.i&&(O.required=J.i=H),J},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),le(()=>O.value=S()),W})()};Pt(["input","click","keydown"]);var Xh=G("<div>"),PA=G("<div><div><input type=text autocomplete=off>"),wA=G("<button type=button>+"),CA=G("<div><div><div><div> </div><div><span>: </span><span></span></div><div>");const Oa=t=>{const{t:e}=ct(),[r,n]=ve(!1),[o,i]=ve(""),[a,c]=ve(-1),d=qe(()=>t.value?Ne.getLocationById(t.value):null),h=qe(()=>{let W=Ne.getActiveLocations();t.filterType&&(W=W.filter(O=>O.type===t.filterType));const I=o().toLowerCase();return I?W.filter(O=>O.name.toLowerCase().includes(I)||O?.code?.toLowerCase().includes(I)||O?.type?.toLowerCase().includes(I)||O?.address?.toLowerCase().includes(I)):W}),y=()=>{n(!0),i(""),c(-1)},v=W=>{const I=W.target;i(I.value),n(!0),c(-1)},w=W=>{t.onChange(W.id),n(!1),i(""),c(-1)},E=W=>{const I=h();switch(W.key){case"ArrowDown":W.preventDefault(),c(O=>Math.min(O+1,I.length-1));break;case"ArrowUp":W.preventDefault(),c(O=>Math.max(O-1,-1));break;case"Enter":W.preventDefault(),a()>=0&&I[a()]&&w(I[a()]);break;case"Escape":n(!1),i(""),c(-1);break}},V=W=>{setTimeout(()=>{n(!1),i(""),c(-1)},150)},N=W=>({warehouse:"",store:"",supplier:"",customer:""})[W]||"",x=W=>({warehouse:"#2196F3",store:"#4CAF50",supplier:"#FF9800",customer:"#9C27B0"})[W]||"#757575",k={position:"relative",width:"100%",...t.style},re={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},ae={display:"flex","align-items":"stretch",width:"100%"},F={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},Y={...re,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"},U={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},b=W=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:W?"var(--strip-color)":"transparent",color:W?"var(--primary-dark)":"var(--text-primary)",transition:"all 0.2s ease"}),g={display:"flex","justify-content":"space-between","align-items":"center"},p={flex:"1"},C={"font-weight":"500","margin-bottom":"0.25rem"},S={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem","align-items":"center"},A=W=>({padding:"0.2rem 0.5rem","border-radius":"var(--border-radius-sm)","font-size":"0.7rem","font-weight":"500",background:x(W),color:"white","text-transform":"uppercase"}),m={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},ne=()=>r()&&o()?o():d()?`${d().name} (${d().code})`:"";return(()=>{var W=PA(),I=W.firstChild,O=I.firstChild;return u(I,ae),O.addEventListener("blur",V),O.$$keydown=E,O.$$click=y,O.$$input=v,s(I,(()=>{var J=ge(()=>!!t.onAddNew);return()=>J()&&(()=>{var D=wA();return D.addEventListener("mouseleave",T=>{T.currentTarget.style.background="var(--surface-color)",T.currentTarget.style.color="var(--primary-color)"}),D.addEventListener("mouseenter",T=>{T.currentTarget.style.background="var(--primary-color)",T.currentTarget.style.color="white"}),co(D,"click",t.onAddNew,!0),u(D,F),le(()=>lt(D,"title",e("inventory.addLocation","Add new location"))),D})()})(),null),s(W,_(De,{get when(){return r()},get children(){var J=Xh();return s(J,_(De,{get when(){return h().length>0},get fallback(){return(()=>{var D=Xh();return u(D,m),s(D,(()=>{var T=ge(()=>!!o());return()=>T()?e("inventory.noLocationsFound","No locations found matching your search."):e("inventory.noLocationsAvailable","No locations available.")})()),D})()},get children(){return _(at,{get each(){return h()},children:(D,T)=>(()=>{var B=CA(),me=B.firstChild,H=me.firstChild,de=H.firstChild,$=de.firstChild,q=de.nextSibling,Z=q.firstChild,L=Z.firstChild,te=Z.nextSibling,j=q.nextSibling;return B.addEventListener("mouseenter",()=>c(T())),B.$$click=()=>w(D),u(me,g),u(H,p),u(de,C),s(de,()=>N(D.type),$),s(de,()=>D.name,null),u(q,S),s(Z,()=>e("inventory.locationCode","Code"),L),s(Z,()=>D.code,null),s(te,()=>D.type),j.style.setProperty("font-size","0.75rem"),j.style.setProperty("color","var(--text-muted)"),j.style.setProperty("margin-top","0.25rem"),s(j,()=>D.address),le(M=>{var ie=b(T()===a()),oe=A(D.type);return M.e=u(B,ie,M.e),M.t=u(te,oe,M.t),M},{e:void 0,t:void 0}),B})()})}})),le(D=>u(J,U,D)),J}}),null),le(J=>{var D=k,T=Y,B=t.placeholder||e("inventory.searchLocations","Search locations by name, code, or type..."),me=t.disabled,H=t.required;return J.e=u(W,D,J.e),J.t=u(O,T,J.t),B!==J.a&&lt(O,"placeholder",J.a=B),me!==J.o&&(O.disabled=J.o=me),H!==J.i&&(O.required=J.i=H),J},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),le(()=>O.value=ne()),W})()};Pt(["input","click","keydown"]);var AA=G("<form><div><label> *</label><input type=text required></div><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text list=categories required><datalist id=categories><option value=Electronics></option><option value=Accessories></option><option value=Office></option><option value=Furniture></option><option value=Software></option><option value=Hardware></option></datalist></div></div><div><label></label><textarea></textarea></div><div><div><label></label><select><option value=pcs></option><option value=kg></option><option value=lbs></option><option value=m></option><option value=ft></option><option value=l></option><option value=gal></option><option value=box></option><option value=pack></option></select></div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div></div><div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div><div></div></div><div><div><label></label><input type=number min=0 step=1></div><div><label></label><input type=number min=1 step=1></div></div><div>"),xA=G("<div>");const ku=t=>{const{t:e}=ct(),[r,n]=ve(""),[o,i]=ve(""),[a,c]=ve(""),[d,h]=ve(""),[y,v]=ve("pcs"),[w,E]=ve(0),[V,N]=ve(0),[x,k]=ve(10),[re,ae]=ve(100),[F,Y]=ve(""),U=()=>{n(""),i(""),c(""),h(""),v("pcs"),E(0),N(0),k(10),ae(100),Y("")},b=I=>{if(I.preventDefault(),Y(""),!r().trim()){Y(e("forms.productNameRequired"));return}if(!o().trim()){Y(e("forms.skuRequired"));return}if(!d().trim()){Y(e("forms.categoryRequired"));return}if(w()<0){Y(e("forms.unitCostNotNegative"));return}if(V()<0){Y(e("forms.sellingPriceNotNegative"));return}if(x()<0){Y(e("forms.minStockNotNegative"));return}if(re()<=x()){Y(e("forms.maxStockGreaterThanMin"));return}if(Ne.getProductsBySku(o()).length>0){Y(e("forms.skuAlreadyExists"));return}const J={name:r().trim(),sku:o().trim().toUpperCase(),description:a().trim(),category:d().trim(),unitOfMeasure:y(),unitCost:w(),sellingPrice:V(),minStockLevel:x(),maxStockLevel:re(),isActive:!0,businessId:"default-business"};Ne.addProduct(J);const D=`prod-${Date.now()}`;t.onProductAdded&&t.onProductAdded(D),U(),t.onClose()},g=()=>{U(),t.onClose()},p={"margin-bottom":"1.5rem"},C={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},S={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},A={...S,cursor:"pointer"},m={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},ne={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},W={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"};return _(_r,{get isOpen(){return t.isOpen},onClose:g,get title(){return e("inventory.addNewProduct")},get children(){var I=AA(),O=I.firstChild,J=O.firstChild,D=J.firstChild,T=J.nextSibling,B=O.nextSibling,me=B.firstChild,H=me.firstChild,de=H.firstChild,$=H.nextSibling,q=me.nextSibling,Z=q.firstChild,L=Z.firstChild,te=Z.nextSibling,j=B.nextSibling,M=j.firstChild,ie=M.nextSibling,oe=j.nextSibling,fe=oe.firstChild,ue=fe.firstChild,K=ue.nextSibling,R=K.firstChild,ee=R.nextSibling,X=ee.nextSibling,ye=X.nextSibling,pe=ye.nextSibling,z=pe.nextSibling,se=z.nextSibling,_e=se.nextSibling,Pe=_e.nextSibling,he=fe.nextSibling,be=he.firstChild,ce=be.nextSibling,Se=oe.nextSibling,Ee=Se.firstChild,$e=Ee.firstChild,ke=$e.nextSibling,Me=Se.nextSibling,Ke=Me.firstChild,je=Ke.firstChild,Ce=je.nextSibling,Fe=Ke.nextSibling,Qe=Fe.firstChild,We=Qe.nextSibling,Je=Me.nextSibling;return I.addEventListener("submit",b),s(J,()=>e("inventory.productName"),D),T.addEventListener("change",xe=>n(xe.target.value)),s(H,()=>e("inventory.sku"),de),$.addEventListener("change",xe=>i(xe.target.value)),s(Z,()=>e("inventory.category"),L),te.addEventListener("change",xe=>h(xe.target.value)),s(M,()=>e("common.description")),ie.addEventListener("change",xe=>c(xe.target.value)),s(ue,()=>e("inventory.unitOfMeasure")),K.addEventListener("change",xe=>v(xe.target.value)),s(R,()=>e("inventory.pieces")),s(ee,()=>e("inventory.kilograms")),s(X,()=>e("inventory.pounds")),s(ye,()=>e("inventory.meters")),s(pe,()=>e("inventory.feet")),s(z,()=>e("inventory.liters")),s(se,()=>e("inventory.gallons")),s(_e,()=>e("inventory.boxes")),s(Pe,()=>e("inventory.packs")),s(be,()=>e("inventory.unitCost")),ce.addEventListener("change",xe=>E(Number(xe.target.value))),s($e,()=>e("inventory.sellingPrice")),ke.addEventListener("change",xe=>N(Number(xe.target.value))),s(je,()=>e("inventory.minimumStockLevel")),Ce.addEventListener("change",xe=>k(Number(xe.target.value))),s(Qe,()=>e("inventory.maximumStockLevel")),We.addEventListener("change",xe=>ae(Number(xe.target.value))),s(I,(()=>{var xe=ge(()=>!!F());return()=>xe()&&(()=>{var ot=xA();return u(ot,m),s(ot,F),ot})()})(),Je),u(Je,ne),s(Je,_(Le,{variant:"secondary",type:"button",onClick:g,get children(){return e("common.cancel")}}),null),s(Je,_(Le,{variant:"primary",type:"submit",get children(){return e("inventory.addProduct")}}),null),le(xe=>{var ot=p,et=C,Ct=S,mt=e("inventory.enterProductName"),Dt=W,$t=C,Tt=S,Kt=e("inventory.enterSkuCode"),rt=C,Xt=S,Ie=e("inventory.enterCategory"),gt=p,Be=C,Oe={...S,"min-height":"80px",resize:"vertical"},Ze=e("inventory.enterProductDescription"),nt=W,bt=C,Xe=A,yt=C,ut=S,At=W,Ve=C,zt=S,vt=W,Nt=C,Bt=S,ft=C,Lt=S;return xe.e=u(O,ot,xe.e),xe.t=u(J,et,xe.t),xe.a=u(T,Ct,xe.a),mt!==xe.o&&lt(T,"placeholder",xe.o=mt),xe.i=u(B,Dt,xe.i),xe.n=u(H,$t,xe.n),xe.s=u($,Tt,xe.s),Kt!==xe.h&&lt($,"placeholder",xe.h=Kt),xe.r=u(Z,rt,xe.r),xe.d=u(te,Xt,xe.d),Ie!==xe.l&&lt(te,"placeholder",xe.l=Ie),xe.u=u(j,gt,xe.u),xe.c=u(M,Be,xe.c),xe.w=u(ie,Oe,xe.w),Ze!==xe.m&&lt(ie,"placeholder",xe.m=Ze),xe.f=u(oe,nt,xe.f),xe.y=u(ue,bt,xe.y),xe.g=u(K,Xe,xe.g),xe.p=u(be,yt,xe.p),xe.b=u(ce,ut,xe.b),xe.T=u(Se,At,xe.T),xe.A=u($e,Ve,xe.A),xe.O=u(ke,zt,xe.O),xe.I=u(Me,vt,xe.I),xe.S=u(je,Nt,xe.S),xe.W=u(Ce,Bt,xe.W),xe.C=u(Qe,ft,xe.C),xe.B=u(We,Lt,xe.B),xe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),le(()=>T.value=r()),le(()=>$.value=o()),le(()=>te.value=d()),le(()=>ie.value=a()),le(()=>K.value=y()),le(()=>ce.value=w()),le(()=>ke.value=V()),le(()=>Ce.value=x()),le(()=>We.value=re()),I}})};var IA=G('<form><div><label> *</label><input type=text required></div><div><div><label> *<button type=button title="Generate code automatically"></button></label><input type=text required><div></div></div><div><label> *</label><select required><option value=warehouse> </option><option value=store> </option><option value=supplier> </option><option value=customer> </option></select><div></div></div></div><div><label> *</label><textarea required></textarea></div><div>'),EA=G("<div><div>:</div><div><span></span><div><div></div><div>"),$A=G("<div>");const Ru=t=>{const{t:e}=ct(),[r,n]=ve(""),[o,i]=ve(""),[a,c]=ve("warehouse"),[d,h]=ve(""),[y,v]=ve(""),w=()=>{n(""),i(""),c("warehouse"),h(""),v("")},E=()=>{if(r()){const S=a()==="warehouse"?"WH":a()==="store"?"ST":a()==="supplier"?"SUP":"CUST",A=r().toUpperCase().replace(/[^A-Z0-9]/g,"").substring(0,3),m=String(Math.floor(Math.random()*1e3)).padStart(3,"0");i(`${S}-${A}-${m}`)}},V=S=>{if(S.preventDefault(),v(""),!r().trim()){v(e("forms.locationNameRequired"));return}if(!o().trim()){v(e("forms.locationCodeRequired"));return}if(!d().trim()){v(e("forms.addressRequired"));return}if(Ne.locations.filter(W=>W.code.toLowerCase()===o().toLowerCase()).length>0){v(e("forms.locationCodeExists"));return}const m={name:r().trim(),code:o().trim().toUpperCase(),type:a(),address:d().trim(),isActive:!0};Ne.addLocation(m);const ne=`loc-${Date.now()}`;t.onLocationAdded&&t.onLocationAdded(ne),w(),t.onClose()},N=()=>{w(),t.onClose()},x={"margin-bottom":"1.5rem"},k={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},re={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},ae={...re,cursor:"pointer"},F={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},Y={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},U={display:"grid","grid-template-columns":"2fr 1fr",gap:"1rem"},b={"font-size":"0.875rem",color:"var(--text-muted)","margin-top":"0.25rem"},g={padding:"0.25rem 0.5rem","font-size":"0.75rem","margin-left":"0.5rem",background:"var(--background-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",color:"var(--text-muted)"},p=S=>({warehouse:"",store:"",supplier:"",customer:""})[S]||"",C=S=>({warehouse:e("inventory.warehouseDescription"),store:e("inventory.storeDescription"),supplier:e("inventory.supplierDescription"),customer:e("inventory.customerDescription")})[S]||"";return _(_r,{get isOpen(){return t.isOpen},onClose:N,get title(){return e("inventory.addNewLocation")},get children(){var S=IA(),A=S.firstChild,m=A.firstChild,ne=m.firstChild,W=m.nextSibling,I=A.nextSibling,O=I.firstChild,J=O.firstChild,D=J.firstChild,T=D.nextSibling,B=J.nextSibling,me=B.nextSibling,H=O.nextSibling,de=H.firstChild,$=de.firstChild,q=de.nextSibling,Z=q.firstChild,L=Z.firstChild,te=Z.nextSibling,j=te.firstChild,M=te.nextSibling,ie=M.firstChild,oe=M.nextSibling,fe=oe.firstChild,ue=q.nextSibling,K=I.nextSibling,R=K.firstChild,ee=R.firstChild,X=R.nextSibling,ye=K.nextSibling;return S.addEventListener("submit",V),s(m,()=>e("inventory.locationName"),ne),W.addEventListener("change",pe=>n(pe.target.value)),u(I,U),s(J,()=>e("inventory.locationCode"),D),T.$$click=E,u(T,g),s(T,()=>e("common.generate")),B.addEventListener("change",pe=>i(pe.target.value)),s(me,()=>e("inventory.uniqueIdentifierHelp")),s(de,()=>e("inventory.locationType"),$),q.addEventListener("change",pe=>c(pe.target.value)),s(Z,()=>p("warehouse"),L),s(Z,()=>e("inventory.warehouse"),null),s(te,()=>p("store"),j),s(te,()=>e("inventory.store"),null),s(M,()=>p("supplier"),ie),s(M,()=>e("inventory.supplier"),null),s(oe,()=>p("customer"),fe),s(oe,()=>e("inventory.customer"),null),s(ue,()=>C(a())),s(R,()=>e("common.address"),ee),X.addEventListener("change",pe=>h(pe.target.value)),s(S,(()=>{var pe=ge(()=>!!r());return()=>pe()&&(()=>{var z=EA(),se=z.firstChild,_e=se.firstChild,Pe=se.nextSibling,he=Pe.firstChild,be=he.nextSibling,ce=be.firstChild,Se=ce.nextSibling;return z.style.setProperty("padding","1rem"),z.style.setProperty("background","var(--background-color)"),z.style.setProperty("border-radius","var(--border-radius-sm)"),z.style.setProperty("border","1px solid var(--border-color)"),z.style.setProperty("margin-bottom","1rem"),se.style.setProperty("font-weight","500"),se.style.setProperty("margin-bottom","0.5rem"),s(se,()=>e("common.preview"),_e),Pe.style.setProperty("display","flex"),Pe.style.setProperty("align-items","center"),Pe.style.setProperty("gap","0.5rem"),he.style.setProperty("font-size","1.2rem"),s(he,()=>p(a())),ce.style.setProperty("font-weight","600"),s(ce,r),Se.style.setProperty("font-size","0.875rem"),Se.style.setProperty("color","var(--text-muted)"),s(Se,(()=>{var Ee=ge(()=>!!o());return()=>Ee()&&`${o()}  `})(),null),s(Se,a,null),z})()})(),ye),s(S,(()=>{var pe=ge(()=>!!y());return()=>pe()&&(()=>{var z=$A();return u(z,F),s(z,y),z})()})(),ye),u(ye,Y),s(ye,_(Le,{variant:"secondary",type:"button",onClick:N,get children(){return e("common.cancel")}}),null),s(ye,_(Le,{variant:"primary",type:"submit",get children(){return e("inventory.addLocation")}}),null),le(pe=>{var z=x,se=k,_e=re,Pe=e("inventory.enterLocationName"),he=k,be=re,ce=e("inventory.enterUniqueCode"),Se=b,Ee=k,$e=ae,ke=b,Me=x,Ke=k,je={...re,"min-height":"100px",resize:"vertical"},Ce=e("inventory.enterCompleteAddress");return pe.e=u(A,z,pe.e),pe.t=u(m,se,pe.t),pe.a=u(W,_e,pe.a),Pe!==pe.o&&lt(W,"placeholder",pe.o=Pe),pe.i=u(J,he,pe.i),pe.n=u(B,be,pe.n),ce!==pe.s&&lt(B,"placeholder",pe.s=ce),pe.h=u(me,Se,pe.h),pe.r=u(de,Ee,pe.r),pe.d=u(q,$e,pe.d),pe.l=u(ue,ke,pe.l),pe.u=u(K,Me,pe.u),pe.c=u(R,Ke,pe.c),pe.w=u(X,je,pe.w),Ce!==pe.m&&lt(X,"placeholder",pe.m=Ce),pe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),le(()=>W.value=r()),le(()=>B.value=o()),le(()=>q.value=a()),le(()=>X.value=d()),S}})};Pt(["click"]);var TA=G("<form><div>"),Zh=G("<div><label> *"),kA=G("<div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment>"),RA=G("<div><label>"),DA=G("<div><label> *</label><input type=number min=0 step=1 required>"),NA=G("<div><label></label><input type=number min=0 step=0.01>"),LA=G("<div><label></label><input type=text>"),MA=G("<div><label></label><textarea>"),OA=G("<div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span>:</span><span> "),VA=G("<div><div><span>:</span><span>"),FA=G("<div>");const BA=t=>{const{t:e}=ct(),[r,n]=ve({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""}),[o,i]=ve(""),[a,c]=ve(""),[d,h]=ve("in"),[y,v]=ve(0),[w,E]=ve(0),[V,N]=ve(""),[x,k]=ve(""),[re,ae]=ve(""),[F,Y]=ve(""),[U,b]=ve(!1),[g,p]=ve(!1),C=()=>t.mode==="movement",S=qe(()=>o()?Ne.getProductById(o()):null),A=qe(()=>a()?Ne.getLocationById(a()):null),m=qe(()=>re()?Ne.getLocationById(re()):null),ne=qe(()=>y()*w()),W=qe(()=>!o()||!a()?0:Ne.getStockByProductAndLocation(o(),a())?.quantity||0),I=[{value:"Electronics",label:"Electronics"},{value:"Accessories",label:"Accessories"},{value:"Furniture",label:"Furniture"},{value:"Office Supplies",label:"Office Supplies"},{value:"Software",label:"Software"},{value:"Hardware",label:"Hardware"},{value:"Consumables",label:"Consumables"}],O=[{value:"Warehouse A",label:"Warehouse A"},{value:"Warehouse B",label:"Warehouse B"},{value:"Warehouse C",label:"Warehouse C"},{value:"Storage Room",label:"Storage Room"},{value:"Main Office",label:"Main Office"}],J={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},D=()=>{i(""),c(""),h("in"),v(0),E(0),N(""),k(""),ae(""),Y("")},T=()=>{n({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""})},B=oe=>{if(oe.preventDefault(),C()){if(Y(""),!o()){Y(e("forms.selectProduct"));return}if(!a()){Y(e("forms.selectLocation"));return}if(y()<=0){Y(e("forms.quantityGreaterThanZero"));return}if(w()<0){Y(e("forms.unitCostNotNegative"));return}if(d()==="transfer"&&!re()){Y(e("forms.selectFromLocation"));return}if(d()==="transfer"&&re()===a()){Y(e("forms.sameLocationError"));return}if(d()==="out"&&y()>W()){Y(e("forms.insufficientStock",{currentStock:W()}));return}const fe=S(),ue=A(),K={productId:fe.id,productName:fe.name,productSku:fe.sku,locationId:ue.id,locationName:ue.name,movementType:d(),quantity:y(),unitCost:w()||fe.unitCost,totalCost:ne()||y()*fe.unitCost,referenceNumber:V()||`AUTO-${Date.now()}`,notes:x(),createdBy:"admin",fromLocationId:d()==="transfer"?re():void 0,fromLocationName:d()==="transfer"?m()?.name:void 0};Ne.addInventoryMovement(K),D()}else{const fe=r();if(!fe.name||!fe.price||!fe.quantity||!fe.category||!fe.sku||!fe.supplier||!fe.minStock||!fe.location){alert(e("forms.fillAllRequired"));return}const ue={name:fe.name,price:parseFloat(fe.price),quantity:parseInt(fe.quantity),category:fe.category,description:fe.description,sku:fe.sku,supplier:fe.supplier,minStock:parseInt(fe.minStock),location:fe.location};Ne.addItem(ue),T()}t.onClose()},me=(oe,fe)=>{n(ue=>({...ue,[oe]:fe}))},H=()=>{C()?D():T(),t.onClose()},de=oe=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(oe),$={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},q={...$,cursor:"pointer"},Z={color:"#f44336","font-size":"0.875rem","margin-top":"0.5rem"},L={padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},te={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},j={"font-weight":"500",color:"var(--text-muted)"},M={"font-weight":"600",color:"var(--text-primary)"},ie=()=>C()?e("inventory.addMovement"):e("inventory.addNewItem");return _(_r,{get isOpen(){return t.isOpen},onClose:H,get title(){return ie()},get children(){return[(()=>{var oe=TA(),fe=oe.firstChild;return oe.addEventListener("submit",B),s(oe,(()=>{var ue=ge(()=>!!C());return()=>ue()?[(()=>{var K=Zh(),R=K.firstChild,ee=R.firstChild;return K.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),s(R,()=>e("inventory.product"),ee),s(K,_(Tu,{get value(){return o()},onChange:X=>{i(X);const ye=Ne.getProductById(X);ye&&E(ye.unitCost)},get placeholder(){return e("inventory.searchProductsPlaceholder")},onAddNew:()=>b(!0),required:!0}),null),K})(),(()=>{var K=kA(),R=K.firstChild,ee=R.firstChild,X=R.nextSibling,ye=X.firstChild,pe=ye.nextSibling,z=pe.nextSibling,se=z.nextSibling;return K.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),s(R,()=>e("inventory.movementType"),ee),X.addEventListener("change",_e=>h(_e.target.value)),s(ye,()=>e("inventory.stockInPurchase")),s(pe,()=>e("inventory.stockOutSale")),s(z,()=>e("inventory.transferBetween")),s(se,()=>e("inventory.stockAdjustment")),le(_e=>u(X,q,_e)),le(()=>X.value=d()),K})(),ge(()=>ge(()=>d()==="transfer")()&&(()=>{var K=Zh(),R=K.firstChild,ee=R.firstChild;return K.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),s(R,()=>e("inventory.fromLocation"),ee),s(K,_(Oa,{get value(){return re()},onChange:X=>ae(X),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>p(!0),required:!0}),null),K})()),(()=>{var K=RA(),R=K.firstChild;return K.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),s(R,(()=>{var ee=ge(()=>d()==="transfer");return()=>ee()?e("inventory.toLocation")+" *":e("inventory.locationName")+" *"})()),s(K,_(Oa,{get value(){return a()},onChange:ee=>c(ee),get placeholder(){return ge(()=>d()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>p(!0),required:!0}),null),K})(),ge(()=>ge(()=>!!(S()&&A()))()&&(()=>{var K=OA(),R=K.firstChild,ee=R.firstChild,X=ee.firstChild,ye=ee.nextSibling,pe=ye.firstChild,z=R.nextSibling,se=z.firstChild,_e=se.firstChild,Pe=se.nextSibling,he=z.nextSibling,be=he.firstChild,ce=be.firstChild,Se=be.nextSibling,Ee=Se.firstChild;return s(ee,()=>e("inventory.currentStockAt",{location:A()?.name}),X),s(ye,W,pe),s(ye,()=>S()?.unitOfMeasure,null),s(se,()=>e("inventory.productCost"),_e),s(Pe,()=>de(S()?.unitCost||0)),s(be,()=>e("inventory.minStockLevel"),ce),s(Se,()=>S()?.minStockLevel,Ee),s(Se,()=>S()?.unitOfMeasure,null),le($e=>{var ke=L,Me=te,Ke=j,je=M,Ce=te,Fe=j,Qe=M,We=te,Je=j,xe=M;return $e.e=u(K,ke,$e.e),$e.t=u(R,Me,$e.t),$e.a=u(ee,Ke,$e.a),$e.o=u(ye,je,$e.o),$e.i=u(z,Ce,$e.i),$e.n=u(se,Fe,$e.n),$e.s=u(Pe,Qe,$e.s),$e.h=u(he,We,$e.h),$e.r=u(be,Je,$e.r),$e.d=u(Se,xe,$e.d),$e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),K})()),(()=>{var K=DA(),R=K.firstChild,ee=R.firstChild,X=R.nextSibling;return K.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),s(R,()=>e("inventory.quantity"),ee),X.addEventListener("change",ye=>v(Number(ye.target.value))),le(ye=>u(X,$,ye)),le(()=>X.value=y()),K})(),(()=>{var K=NA(),R=K.firstChild,ee=R.nextSibling;return K.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),s(R,()=>e("inventory.unitCost")),ee.addEventListener("change",X=>E(Number(X.target.value))),le(X=>{var ye=$,pe=e("inventory.willUseDefaultCost");return X.e=u(ee,ye,X.e),pe!==X.t&&lt(ee,"placeholder",X.t=pe),X},{e:void 0,t:void 0}),le(()=>ee.value=w()),K})(),ge(()=>ge(()=>y()>0&&w()>0)()&&(()=>{var K=VA(),R=K.firstChild,ee=R.firstChild,X=ee.firstChild,ye=ee.nextSibling;return s(ee,()=>e("inventory.totalCost"),X),s(ye,()=>de(ne())),le(pe=>{var z=L,se=te,_e=j,Pe={...M,"font-size":"1.2rem",color:"var(--primary-color)"};return pe.e=u(K,z,pe.e),pe.t=u(R,se,pe.t),pe.a=u(ee,_e,pe.a),pe.o=u(ye,Pe,pe.o),pe},{e:void 0,t:void 0,a:void 0,o:void 0}),K})()),(()=>{var K=LA(),R=K.firstChild,ee=R.nextSibling;return K.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),s(R,()=>e("common.referenceNumber")),ee.addEventListener("change",X=>N(X.target.value)),le(X=>{var ye=$,pe=e("common.referenceNumberPlaceholder");return X.e=u(ee,ye,X.e),pe!==X.t&&lt(ee,"placeholder",X.t=pe),X},{e:void 0,t:void 0}),le(()=>ee.value=V()),K})(),(()=>{var K=MA(),R=K.firstChild,ee=R.nextSibling;return K.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),s(R,()=>e("common.notes")),ee.addEventListener("change",X=>k(X.target.value)),le(X=>{var ye={...$,"min-height":"100px",resize:"vertical"},pe=e("inventory.additionalNotesPlaceholder");return X.e=u(ee,ye,X.e),pe!==X.t&&lt(ee,"placeholder",X.t=pe),X},{e:void 0,t:void 0}),le(()=>ee.value=x()),K})(),ge(()=>ge(()=>!!F())()&&(()=>{var K=FA();return u(K,Z),s(K,F),K})())]:[_(Ot,{get label(){return e("inventory.itemName")},get value(){return r().name},onChange:K=>me("name",K),get placeholder(){return e("inventory.enterItemName")},required:!0}),_(Ot,{get label(){return e("inventory.sku")},get value(){return r().sku},onChange:K=>me("sku",K),get placeholder(){return e("inventory.enterSkuCode")},required:!0}),_(gr,{get label(){return e("inventory.category")},get value(){return r().category},onChange:K=>me("category",K),options:I,required:!0}),_(Ot,{get label(){return e("common.description")},get value(){return r().description},onChange:K=>me("description",K),get placeholder(){return e("inventory.enterItemDescription")}}),_(Ot,{get label(){return e("common.price")},type:"number",get value(){return r().price},onChange:K=>me("price",K),get placeholder(){return e("common.enterPrice")},required:!0}),_(Ot,{get label(){return e("inventory.quantity")},type:"number",get value(){return r().quantity},onChange:K=>me("quantity",K),get placeholder(){return e("inventory.enterQuantity")},required:!0}),_(Ot,{get label(){return e("inventory.minimumStock")},type:"number",get value(){return r().minStock},onChange:K=>me("minStock",K),get placeholder(){return e("inventory.enterMinStockLevel")},required:!0}),_(Ot,{get label(){return e("inventory.supplier")},get value(){return r().supplier},onChange:K=>me("supplier",K),get placeholder(){return e("inventory.enterSupplierName")},required:!0}),_(gr,{get label(){return e("inventory.location")},get value(){return r().location},onChange:K=>me("location",K),options:O,required:!0})]})(),fe),u(fe,J),s(fe,_(Le,{variant:"secondary",type:"button",onClick:H,get children(){return e("common.cancel")}}),null),s(fe,_(Le,{variant:"primary",type:"submit",get children(){return ge(()=>!!C())()?e("inventory.addMovement"):e("inventory.addItem")}}),null),oe})(),_(ku,{get isOpen(){return U()},onClose:()=>b(!1),onProductAdded:oe=>{i(oe),b(!1)}}),_(Ru,{get isOpen(){return g()},onClose:()=>p(!1),onLocationAdded:oe=>{d()==="transfer"&&!re()?ae(oe):c(oe),p(!1)}})]}})};Pt(["input","keydown"]);var UA=G("<form><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text required></div></div><div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><div><label></label></div></div><div><div><h3></h3></div></div><div><label></label><textarea></textarea></div><div>"),jA=G("<div><label> *"),zA=G("<div><div></div><div></div><div></div><div></div><div>"),Rl=G("<div>"),qA=G("<div><input type=number min=0 step=1 required><input type=number min=0 step=0.01><input type=text>"),GA=G("<div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span>"),HA=G("<div> ");const WA=t=>{const{t:e}=ct(),[r,n]=ve(`INV-${Date.now()}`),[o,i]=ve(""),[a,c]=ve("in"),[d,h]=ve(""),[y,v]=ve(""),[w,E]=ve(""),[V,N]=ve([]),[x,k]=ve([]),[re,ae]=ve(!1),[F,Y]=ve(!1),U=()=>{N(L=>[...L,{productId:"",quantity:0,unitCost:0,notes:""}])},b=L=>{N(te=>te.filter((j,M)=>M!==L))},g=(L,te,j)=>{N(M=>M.map((ie,oe)=>oe===L?{...ie,[te]:j}:ie))},p=()=>{n(`INV-${Date.now()}`),i(""),c("in"),h(""),v(""),E(""),N([]),k([])},C=async L=>{L.preventDefault(),k([]);const te=[];if(o()||te.push(e("forms.referenceNumberRequired")),d()||te.push(e("forms.locationRequired")),a()==="transfer"&&!y()&&te.push(e("forms.fromLocationRequired")),V().length===0&&te.push(e("forms.atLeastOneProduct")),V().forEach((ie,oe)=>{ie.productId||te.push(e("forms.itemProductRequired","Product is required for item {{index}}",{index:oe+1})),ie.quantity<=0&&te.push(e("forms.itemQuantityRequired","Quantity must be greater than 0 for item {{index}}",{index:oe+1}))}),te.length>0){k(te);return}const j={ssg_inventory_key:Qm(),invoiceId:r(),referenceNumber:o(),movementType:a(),type:Ql(a()),locationId:d(),fromLocationId:a()==="transfer"?y():void 0,items:V(),products:V(),generalNotes:w(),description:w(),invoice:o(),store:d(),createdBy:"admin",createDate:new Date().toISOString()};console.log(j);const M=await Ne.addBulkInventoryMovements(j);console.log(M),M.success?(p(),t.onClose()):k(M.errors)},S=()=>{p(),t.onClose()},A=qe(()=>V().reduce((L,te)=>{const j=Ne.getProductById(te.productId),M=te.unitCost||j?.unitCost||0;return L+te.quantity*M},0)),m=qe(()=>V().reduce((L,te)=>L+te.quantity,0)),ne={"margin-bottom":"1.5rem"},W={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},I={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},O={...I,cursor:"pointer"},J={display:"grid",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},D={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},T={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem","padding-left":"0.75rem"},B={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},me={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},H={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},de={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},$=L=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(L),q=L=>({in:e("inventory.purchaseReceive"),out:e("inventory.saleIssue"),transfer:e("inventory.transfer"),adjustment:e("inventory.adjustment")})[L]||L,Z=async L=>{await Ne.fecthInventory(L),await Ne.fecthProduct(L)};return Hr(()=>{Z("prod")}),_(_r,{get isOpen(){return t.isOpen},onClose:S,get title(){return e("inventory.bulkMovement")},get children(){return[(()=>{var L=UA(),te=L.firstChild,j=te.firstChild,M=j.firstChild,ie=M.firstChild,oe=M.nextSibling,fe=j.nextSibling,ue=fe.firstChild,K=ue.firstChild,R=ue.nextSibling,ee=te.nextSibling,X=ee.firstChild,ye=X.firstChild,pe=X.nextSibling,z=pe.firstChild,se=z.nextSibling,_e=se.nextSibling,Pe=_e.nextSibling,he=ee.nextSibling,be=he.firstChild,ce=be.firstChild,Se=he.nextSibling,Ee=Se.firstChild,$e=Ee.firstChild,ke=Se.nextSibling,Me=ke.firstChild,Ke=Me.nextSibling,je=ke.nextSibling;return L.addEventListener("submit",C),te.style.setProperty("display","grid"),te.style.setProperty("grid-template-columns","1fr 1fr"),te.style.setProperty("gap","1rem"),te.style.setProperty("margin-bottom","1.5rem"),s(M,()=>e("common.invoiceDocumentId"),ie),oe.addEventListener("change",Ce=>n(Ce.target.value)),s(ue,()=>e("common.referenceNumber"),K),R.addEventListener("change",Ce=>i(Ce.target.value)),s(X,()=>e("inventory.movementType"),ye),pe.addEventListener("change",Ce=>c(Ce.target.value)),s(z,()=>e("inventory.purchaseReceive")),s(se,()=>e("inventory.saleIssue")),s(_e,()=>e("inventory.transfer")),s(Pe,()=>e("inventory.adjustment")),he.style.setProperty("display","grid"),he.style.setProperty("gap","1rem"),he.style.setProperty("margin-bottom","1.5rem"),s(he,(()=>{var Ce=ge(()=>a()==="transfer");return()=>Ce()&&(()=>{var Fe=jA(),Qe=Fe.firstChild,We=Qe.firstChild;return s(Qe,()=>e("inventory.fromLocation"),We),s(Fe,_(Oa,{get value(){return y()},onChange:Je=>v(Je),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>Y(!0),required:!0}),null),le(Je=>u(Qe,W,Je)),Fe})()})(),be),s(ce,(()=>{var Ce=ge(()=>a()==="transfer");return()=>Ce()?e("inventory.toLocation")+" *":e("inventory.location")+" *"})()),s(be,_(Oa,{get value(){return d()},onChange:Ce=>h(Ce),get placeholder(){return ge(()=>a()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>Y(!0),required:!0}),null),Ee.style.setProperty("display","flex"),Ee.style.setProperty("justify-content","space-between"),Ee.style.setProperty("align-items","center"),Ee.style.setProperty("margin-bottom","1rem"),$e.style.setProperty("margin","0"),$e.style.setProperty("font-size","1.1rem"),s($e,()=>e("inventory.products")),s(Ee,_(Le,{variant:"outline",type:"button",onClick:U,get children(){return e("inventory.addProduct")}}),null),s(Se,(()=>{var Ce=ge(()=>V().length>0);return()=>Ce()&&[(()=>{var Fe=zA(),Qe=Fe.firstChild,We=Qe.nextSibling,Je=We.nextSibling,xe=Je.nextSibling;return u(Fe,T),s(Qe,()=>e("inventory.product")),s(We,()=>e("inventory.quantity")),s(Je,()=>e("inventory.unitCost")),s(xe,()=>e("common.notes")),Fe})(),_(at,{get each(){return V()},children:(Fe,Qe)=>[(()=>{var We=Rl();return u(We,J),s(We,_(Tu,{get value(){return Fe.productId},onChange:Je=>{g(Qe(),"productId",Je.id);let xe={id:Je.id,label:Je.name,code:Je.sku};g(Qe(),"product",xe);const ot=Ne.getProductById(Je.id);ot&&!Fe.unitCost&&g(Qe(),"unitCost",ot.unitCost)},get placeholder(){return e("inventory.searchProduct")},onAddNew:()=>ae(!0),required:!0})),We})(),(()=>{var We=qA(),Je=We.firstChild,xe=Je.nextSibling,ot=xe.nextSibling;return u(We,D),Je.addEventListener("change",et=>g(Qe(),"quantity",Number(et.target.value))),xe.addEventListener("change",et=>g(Qe(),"unitCost",Number(et.target.value))),ot.addEventListener("change",et=>g(Qe(),"notes",et.target.value)),s(We,_(Le,{variant:"outline",size:"sm",type:"button",onClick:()=>b(Qe()),style:{color:"#f44336","border-color":"#f44336"},get children(){return e("common.remove")}}),null),le(et=>{var Ct=I,mt=I,Dt=e("common.auto"),$t=I,Tt=e("common.optionalNotes");return et.e=u(Je,Ct,et.e),et.t=u(xe,mt,et.t),Dt!==et.a&&lt(xe,"placeholder",et.a=Dt),et.o=u(ot,$t,et.o),Tt!==et.i&&lt(ot,"placeholder",et.i=Tt),et},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),le(()=>Je.value=Fe.quantity),le(()=>xe.value=Fe.unitCost),le(()=>ot.value=Fe.notes),We})()]})]})(),null),s(Se,(()=>{var Ce=ge(()=>V().length===0);return()=>Ce()&&(()=>{var Fe=Rl();return Fe.style.setProperty("text-align","center"),Fe.style.setProperty("padding","2rem"),Fe.style.setProperty("background","var(--background-color)"),Fe.style.setProperty("border-radius","var(--border-radius-sm)"),Fe.style.setProperty("border","1px solid var(--border-color)"),Fe.style.setProperty("color","var(--text-muted)"),s(Fe,()=>e("inventory.noProductsAdded")),Fe})()})(),null),s(L,(()=>{var Ce=ge(()=>V().length>0);return()=>Ce()&&(()=>{var Fe=GA(),Qe=Fe.firstChild,We=Qe.nextSibling,Je=We.firstChild,xe=Je.firstChild,ot=Je.nextSibling,et=We.nextSibling,Ct=et.firstChild,mt=Ct.firstChild,Dt=Ct.nextSibling,$t=et.nextSibling,Tt=$t.firstChild,Kt=Tt.firstChild,rt=Tt.nextSibling,Xt=$t.nextSibling,Ie=Xt.firstChild,gt=Ie.firstChild,Be=Ie.nextSibling;return u(Fe,B),Qe.style.setProperty("margin","0 0 1rem 0"),Qe.style.setProperty("font-size","1rem"),s(Qe,()=>e("common.summary")),s(Je,()=>e("inventory.totalProducts"),xe),ot.style.setProperty("font-weight","600"),s(ot,()=>V().length),s(Ct,()=>e("inventory.totalItems"),mt),Dt.style.setProperty("font-weight","600"),s(Dt,m),s(Tt,()=>e("inventory.totalValue"),Kt),rt.style.setProperty("font-weight","600"),rt.style.setProperty("color","var(--primary-color)"),s(rt,()=>$(A())),s(Ie,()=>e("inventory.movementType"),gt),Be.style.setProperty("font-weight","600"),s(Be,()=>q(a())),le(Oe=>{var Ze=me,nt=me,bt=me,Xe=me;return Oe.e=u(We,Ze,Oe.e),Oe.t=u(et,nt,Oe.t),Oe.a=u($t,bt,Oe.a),Oe.o=u(Xt,Xe,Oe.o),Oe},{e:void 0,t:void 0,a:void 0,o:void 0}),Fe})()})(),ke),s(Me,()=>e("common.generalNotes")),Ke.addEventListener("change",Ce=>E(Ce.target.value)),s(L,(()=>{var Ce=ge(()=>x().length>0);return()=>Ce()&&(()=>{var Fe=Rl();return u(Fe,H),s(Fe,_(at,{get each(){return x()},children:Qe=>(()=>{var We=HA();return We.firstChild,s(We,Qe,null),We})()})),Fe})()})(),je),u(je,de),s(je,_(Le,{variant:"secondary",type:"button",onClick:S,get children(){return e("common.cancel")}}),null),s(je,_(Le,{variant:"primary",type:"submit",get children(){return e("inventory.createMovement")}}),null),le(Ce=>{var Fe=W,Qe=I,We=W,Je=I,xe=e("common.referenceNumberPlaceholder"),ot=ne,et=W,Ct=O,mt=a()==="transfer"?"1fr 1fr":"1fr",Dt=W,$t=ne,Tt=ne,Kt=W,rt={...I,"min-height":"80px",resize:"vertical"},Xt=e("inventory.generalNotesPlaceholder");return Ce.e=u(M,Fe,Ce.e),Ce.t=u(oe,Qe,Ce.t),Ce.a=u(ue,We,Ce.a),Ce.o=u(R,Je,Ce.o),xe!==Ce.i&&lt(R,"placeholder",Ce.i=xe),Ce.n=u(ee,ot,Ce.n),Ce.s=u(X,et,Ce.s),Ce.h=u(pe,Ct,Ce.h),mt!==Ce.r&&((Ce.r=mt)!=null?he.style.setProperty("grid-template-columns",mt):he.style.removeProperty("grid-template-columns")),Ce.d=u(ce,Dt,Ce.d),Ce.l=u(Se,$t,Ce.l),Ce.u=u(ke,Tt,Ce.u),Ce.c=u(Me,Kt,Ce.c),Ce.w=u(Ke,rt,Ce.w),Xt!==Ce.m&&lt(Ke,"placeholder",Ce.m=Xt),Ce},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),le(()=>oe.value=r()),le(()=>R.value=o()),le(()=>pe.value=a()),le(()=>Ke.value=w()),L})(),_(ku,{get isOpen(){return re()},onClose:()=>ae(!1),onProductAdded:L=>{ae(!1)}}),_(Ru,{get isOpen(){return F()},onClose:()=>Y(!1),onLocationAdded:L=>{a()==="transfer"&&!y()?v(L):h(L),Y(!1)}})]}})};var YA=G("<div><div></div><div></div><div></div><div>"),KA=G("<div><strong>:</strong> "),QA=G("<div><div><span></span><span></span></div><div><span></span><span> </span></div><div><span></span><span> </span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),JA=G("<div>");const XA=t=>{const{t:e}=ct(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},o={"font-weight":"600",color:"var(--text-primary)"},i={"text-align":"center","margin-bottom":"2rem"},a={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},c={color:"var(--text-muted)","font-size":"1rem"},d={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"1rem"},h=(N,x)=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:N>x?"#d4edda":"#f8d7da",color:N>x?"#155724":"#721c24"}),y={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},v={"margin-bottom":"1.5rem",padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",color:"var(--text-secondary)"};if(!t.item)return null;const w=N=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(N),E=N=>new Date(N).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),V=t.item.price*t.item.quantity;return _(_r,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.itemDetails")},get children(){return[(()=>{var N=YA(),x=N.firstChild,k=x.nextSibling,re=k.nextSibling,ae=re.nextSibling;return u(N,i),u(x,a),s(x,()=>t.item.name),u(k,c),s(k,()=>t.item.category),u(re,d),s(re,()=>w(t.item.price)),s(ae,(()=>{var F=ge(()=>t.item.quantity>t.item.minStock);return()=>F()?e("inventory.inStock"):e("inventory.lowStockAlert")})()),le(F=>u(ae,h(t.item.quantity,t.item.minStock),F)),N})(),(()=>{var N=KA(),x=N.firstChild,k=x.firstChild;return x.nextSibling,u(N,v),s(x,()=>e("common.description"),k),s(N,()=>t.item.description,null),N})(),(()=>{var N=QA(),x=N.firstChild,k=x.firstChild,re=k.nextSibling,ae=x.nextSibling,F=ae.firstChild,Y=F.nextSibling,U=Y.firstChild,b=ae.nextSibling,g=b.firstChild,p=g.nextSibling,C=p.firstChild,S=b.nextSibling,A=S.firstChild,m=A.nextSibling,ne=S.nextSibling,W=ne.firstChild,I=W.nextSibling,O=ne.nextSibling,J=O.firstChild,D=J.nextSibling,T=O.nextSibling,B=T.firstChild,me=B.nextSibling;return s(k,()=>e("inventory.sku")),s(re,()=>t.item.sku),s(F,()=>e("inventory.quantity")),s(Y,()=>t.item.quantity,U),s(Y,()=>e("common.units"),null),s(g,()=>e("inventory.minimumStock")),s(p,()=>t.item.minStock,C),s(p,()=>e("common.units"),null),s(A,()=>e("inventory.totalValue")),s(m,()=>w(V)),s(W,()=>e("inventory.supplier")),s(I,()=>t.item.supplier),s(J,()=>e("inventory.location")),s(D,()=>t.item.location),s(B,()=>e("common.lastUpdated")),s(me,()=>E(t.item.lastUpdated)),le(H=>{var de=r,$=n,q=o,Z=r,L=n,te=o,j=r,M=n,ie=o,oe=r,fe=n,ue=o,K=r,R=n,ee=o,X=r,ye=n,pe=o,z=r,se=n,_e=o;return H.e=u(x,de,H.e),H.t=u(k,$,H.t),H.a=u(re,q,H.a),H.o=u(ae,Z,H.o),H.i=u(F,L,H.i),H.n=u(Y,te,H.n),H.s=u(b,j,H.s),H.h=u(g,M,H.h),H.r=u(p,ie,H.r),H.d=u(S,oe,H.d),H.l=u(A,fe,H.l),H.u=u(m,ue,H.u),H.c=u(ne,K,H.c),H.w=u(W,R,H.w),H.m=u(I,ee,H.m),H.f=u(O,X,H.f),H.y=u(J,ye,H.y),H.g=u(D,pe,H.g),H.p=u(T,z,H.p),H.b=u(B,se,H.b),H.T=u(me,_e,H.T),H},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),N})(),(()=>{var N=JA();return u(N,y),s(N,_(Le,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(N,_(Le,{variant:"primary",onClick:()=>{console.log("Edit item:",t.item.id)},get children(){return e("common.editItem")}}),null),N})()]}})};var ZA=G("<div>"),ex=G("<button type=button>"),tx=G("<div> "),em=G("<div>"),rx=G("<div><div><input type=text autocomplete=off>"),nx=G("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div>"),ox=G("<span> ");const ix=t=>{const{t:e}=ct(),[r,n]=ve(""),[o,i]=ve(!1),[a,c]=ve(null),[d,h]=ve([]),[y,v]=ve(!1),[w,E]=ve(-1),[V,N]=ve(null),x=t.searchDelay||300;t.maxResults;const k=async de=>{if(!de.trim()||de.trim().length<3){h([]),t.onSearchResults?.([]);return}try{i(!0),c(null);try{console.log("apiResults",de),t.onSearchResults?.(de)}catch($){console.warn("API search failed, using local fallback:",$),c("API search failed, showing local results")}}catch($){const q=$ instanceof Error?$.message:"Search failed";c(q),h([]),t.onSearchResults?.([])}finally{i(!1)}},re=de=>{const q=de.target.value;n(q),c(null),console.log(),t.showResults,V()&&clearTimeout(V());const Z=setTimeout(()=>{k(q)},x);N(Z)},ae=de=>{n(de.name),v(!1),E(-1),t.onInventorySelect?.(de)},F=de=>{if(!(!y()||d().length===0))switch(de.key){case"ArrowDown":de.preventDefault(),E($=>Math.min($+1,d().length-1));break;case"ArrowUp":de.preventDefault(),E($=>Math.max($-1,-1));break;case"Enter":de.preventDefault(),w()>=0&&d()[w()]&&ae(d()[w()]);break;case"Escape":v(!1),E(-1);break}},Y=()=>{t.showResults!==!1&&d().length>0&&v(!0)},U=()=>{setTimeout(()=>{v(!1),E(-1)},150)},b=()=>{n(""),h([]),c(null),v(!1),E(-1),t.onSearchResults?.([]),V()&&(clearTimeout(V()),N(null))},g=de=>Ne.stockLevels.filter($=>$.inventoryId===de).reduce(($,q)=>$+q.quantity,0),p=de=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(de),C={position:"relative",width:"100%",...t.style},S={position:"relative",display:"flex","align-items":"center"},A={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},m={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},ne={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},W={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},I=de=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:de?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),O={display:"flex","justify-content":"space-between","align-items":"center"},J={flex:"1"},D={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},T={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},B={"text-align":"right","font-size":"0.875rem"},me={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},H={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var de=rx(),$=de.firstChild,q=$.firstChild;return q.addEventListener("blur",U),q.addEventListener("focus",Y),q.$$keydown=F,q.$$input=re,s($,_(De,{get when(){return o()},get children(){var Z=ZA();return le(L=>u(Z,ne,L)),Z}}),null),s($,_(De,{get when(){return ge(()=>!!r())()&&!o()},get children(){var Z=ex();return Z.addEventListener("mouseleave",L=>{L.currentTarget.style.background="none",L.currentTarget.style.color="var(--text-muted)"}),Z.addEventListener("mouseenter",L=>{L.currentTarget.style.background="var(--border-color)",L.currentTarget.style.color="var(--text-primary)"}),Z.$$click=b,le(L=>{var te=m,j=e("common.clear","Clear search");return L.e=u(Z,te,L.e),j!==L.t&&lt(Z,"title",L.t=j),L},{e:void 0,t:void 0}),Z}}),null),s(de,_(De,{get when(){return y()&&t.showResults!==!1},get children(){var Z=em();return s(Z,_(De,{get when(){return a()},get children(){var L=tx();return L.firstChild,u(L,H),s(L,a,null),L}}),null),s(Z,_(De,{get when(){return d().length>0},get fallback(){return ge(()=>!!(r()&&!o()))()&&(()=>{var L=em();return u(L,me),s(L,()=>e("inventory.noInventorysFound","No inventorys found matching your search.")),L})()},get children(){return _(at,{get each(){return d()},children:(L,te)=>{const j=g(L.id),M=j<=L.minStockLevel;return(()=>{var ie=nx(),oe=ie.firstChild,fe=oe.firstChild,ue=fe.firstChild,K=ue.nextSibling,R=K.firstChild,ee=R.firstChild,X=R.nextSibling,ye=X.nextSibling,pe=ye.nextSibling,z=pe.nextSibling,se=fe.nextSibling,_e=se.firstChild,Pe=_e.firstChild,he=_e.nextSibling;return ie.addEventListener("mouseenter",()=>E(te())),ie.$$click=()=>ae(L),u(oe,O),u(fe,J),u(ue,D),s(ue,()=>L.name),u(K,T),s(R,()=>e("inventory.sku","SKU"),ee),s(R,()=>L.sku,null),s(ye,()=>L.category),s(z,()=>p(L.unitCost)),u(se,B),_e.style.setProperty("font-weight","600"),(M?"#f44336":"var(--text-primary)")!=null?_e.style.setProperty("color",M?"#f44336":"var(--text-primary)"):_e.style.removeProperty("color"),s(_e,j,Pe),s(_e,()=>L.unitOfMeasure,null),he.style.setProperty("color","var(--text-muted)"),s(he,()=>M?(()=>{var be=ox();return be.firstChild,be.style.setProperty("color","#f44336"),s(be,()=>e("inventory.lowStock","Low Stock"),null),be})():e("inventory.inStock","In Stock")),le(be=>u(ie,I(te()===w()),be)),ie})()}})}}),null),le(L=>u(Z,W,L)),Z}}),null),le(Z=>{var L=C,te=S,j=A,M=t.placeholder||e("inventory.searchInventorys","Search inventorys by name, SKU, or category..."),ie=t.disabled;return Z.e=u(de,L,Z.e),Z.t=u($,te,Z.t),Z.a=u(q,j,Z.a),M!==Z.o&&lt(q,"placeholder",Z.o=M),ie!==Z.i&&(q.disabled=Z.i=ie),Z},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),le(()=>q.value=r()),de})()};Pt(["input","keydown","click"]);var sx=G("<div>"),Dl=G("<div><span>:</span><span>"),ax=G("<div><button> "),lx=G("<div><div><div><h3></h3><div>: </div></div><div><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span> <!>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span>");const cx=t=>{const{t:e}=ct(),r=E=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(E),n=E=>new Date(E).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),o=E=>({in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}})[E]||{bg:"#f5f5f5",color:"#666"},i=E=>({in:"",out:"",transfer:"",adjustment:""})[E]||"",a=()=>t.movement,c={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},d={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},h={"font-weight":"600",color:"var(--text-primary)","text-align":"right"},y={"margin-bottom":"1.5rem"},v={"font-weight":"600","margin-bottom":"0.75rem","padding-bottom":"0.5rem","border-bottom":"2px solid var(--border-color)"},w=E=>({display:"inline-flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"600","text-transform":"uppercase","letter-spacing":"0.5px",background:o(E).bg,color:o(E).color});return _(_r,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.movementDetails")},size:"lg",get children(){return _(De,{get when(){return a()},get fallback(){return(()=>{var E=sx();return s(E,()=>e("common.noDataFound")),E})()},children:E=>(()=>{var V=lx(),N=V.firstChild,x=N.firstChild,k=x.firstChild,re=k.nextSibling,ae=re.firstChild,F=x.nextSibling,Y=F.firstChild,U=N.nextSibling,b=U.firstChild,g=b.nextSibling,p=g.firstChild,C=p.firstChild,S=p.nextSibling,A=g.nextSibling,m=A.firstChild,ne=m.firstChild,W=m.nextSibling,I=W.firstChild,O=A.nextSibling,J=O.firstChild,D=J.firstChild,T=J.nextSibling,B=O.nextSibling,me=B.firstChild,H=me.firstChild,de=H.nextSibling;de.nextSibling;var $=me.nextSibling,q=U.nextSibling,Z=q.firstChild,L=Z.nextSibling,te=L.firstChild,j=te.firstChild,M=te.nextSibling,ie=q.nextSibling,oe=ie.firstChild,fe=oe.nextSibling,ue=fe.firstChild,K=ue.firstChild,R=ue.nextSibling,ee=fe.nextSibling,X=ee.firstChild,ye=X.firstChild,pe=X.nextSibling;return N.style.setProperty("display","flex"),N.style.setProperty("justify-content","space-between"),N.style.setProperty("align-items","center"),N.style.setProperty("margin-bottom","1.5rem"),N.style.setProperty("padding-bottom","1rem"),N.style.setProperty("border-bottom","2px solid var(--border-color)"),k.style.setProperty("margin","0 0 0.5rem 0"),k.style.setProperty("font-size","1.25rem"),s(k,()=>E().productName),re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),s(re,()=>e("inventory.sku"),ae),s(re,()=>E().productSku,null),Y.style.setProperty("font-size","1.2rem"),s(Y,()=>i(E().movementType)),s(F,()=>E().movementType,null),s(b,()=>e("inventory.movementInformation")),s(p,()=>e("inventory.referenceNumber"),C),s(S,()=>E().referenceNumber),s(m,()=>e("common.quantity"),ne),s(W,()=>E().quantity,I),s(W,()=>e("common.units"),null),s(J,()=>e("inventory.unitCost"),D),s(T,()=>r(E().unitCost)),s(me,()=>e("common.total"),H),s(me,()=>e("common.value"),de),s($,()=>r(E().totalCost)),s(Z,()=>e("inventory.locationInformation")),s(te,()=>e("inventory.location"),j),s(M,()=>E().locationName),s(q,_(De,{get when(){return E().fromLocationName},get children(){var z=Dl(),se=z.firstChild,_e=se.firstChild,Pe=se.nextSibling;return s(se,()=>e("common.from"),_e),s(Pe,()=>E().fromLocationName),le(he=>{var be=c,ce=d,Se=h;return he.e=u(z,be,he.e),he.t=u(se,ce,he.t),he.a=u(Pe,Se,he.a),he},{e:void 0,t:void 0,a:void 0}),z}}),null),s(q,_(De,{get when(){return E().invoiceId},get children(){var z=Dl(),se=z.firstChild,_e=se.firstChild,Pe=se.nextSibling;return s(se,()=>e("common.invoice"),_e),s(Pe,()=>E().invoiceId),le(he=>{var be=c,ce=d,Se={...h,color:"var(--primary-color)"};return he.e=u(z,be,he.e),he.t=u(se,ce,he.t),he.a=u(Pe,Se,he.a),he},{e:void 0,t:void 0,a:void 0}),z}}),null),s(oe,()=>e("common.details")),s(ue,()=>e("common.createdBy"),K),s(R,()=>E().createdBy),s(X,()=>e("common.created"),ye),s(pe,()=>n(E().createdDate)),s(ie,_(De,{get when(){return E().notes},get children(){var z=Dl(),se=z.firstChild,_e=se.firstChild,Pe=se.nextSibling;return s(se,()=>e("common.notes"),_e),s(Pe,()=>E().notes),le(he=>{var be={...c,"border-bottom":"none"},ce=d,Se={...h,"font-style":"italic","max-width":"60%","white-space":"pre-wrap"};return he.e=u(z,be,he.e),he.t=u(se,ce,he.t),he.a=u(Pe,Se,he.a),he},{e:void 0,t:void 0,a:void 0}),z}}),null),s(V,_(De,{get when(){return t.onEdit},get children(){var z=ax(),se=z.firstChild,_e=se.firstChild;return z.style.setProperty("display","flex"),z.style.setProperty("justify-content","flex-end"),z.style.setProperty("margin-top","1.5rem"),z.style.setProperty("padding-top","1rem"),z.style.setProperty("border-top","1px solid var(--border-color)"),se.addEventListener("mouseleave",Pe=>{Pe.currentTarget.style.transform="translateY(0)",Pe.currentTarget.style.boxShadow="none"}),se.addEventListener("mouseenter",Pe=>{Pe.currentTarget.style.transform="translateY(-1px)",Pe.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)"}),se.$$click=()=>t.onEdit?.(E()),se.style.setProperty("padding","0.5rem 1.5rem"),se.style.setProperty("border-radius","var(--border-radius-sm)"),se.style.setProperty("border","1px solid var(--primary-color)"),se.style.setProperty("background","var(--primary-color)"),se.style.setProperty("color","white"),se.style.setProperty("cursor","pointer"),se.style.setProperty("font-weight","500"),se.style.setProperty("transition","all 0.2s ease"),s(se,()=>e("common.edit"),_e),s(se,()=>e("inventory.movement"),null),z}}),null),le(z=>{var se=w(E().movementType),_e=y,Pe=v,he=c,be=d,ce=h,Se=c,Ee=d,$e={...h,"font-size":"1.1rem",color:"var(--primary-color)"},ke=c,Me=d,Ke=h,je=c,Ce=d,Fe={...h,"font-size":"1.1rem",color:"var(--primary-color)"},Qe=y,We=v,Je=c,xe=d,ot=h,et=y,Ct=v,mt=c,Dt=d,$t=h,Tt=c,Kt=d,rt=h;return z.e=u(F,se,z.e),z.t=u(U,_e,z.t),z.a=u(b,Pe,z.a),z.o=u(g,he,z.o),z.i=u(p,be,z.i),z.n=u(S,ce,z.n),z.s=u(A,Se,z.s),z.h=u(m,Ee,z.h),z.r=u(W,$e,z.r),z.d=u(O,ke,z.d),z.l=u(J,Me,z.l),z.u=u(T,Ke,z.u),z.c=u(B,je,z.c),z.w=u(me,Ce,z.w),z.m=u($,Fe,z.m),z.f=u(q,Qe,z.f),z.y=u(Z,We,z.y),z.g=u(L,Je,z.g),z.p=u(te,xe,z.p),z.b=u(M,ot,z.b),z.T=u(ie,et,z.T),z.A=u(oe,Ct,z.A),z.O=u(fe,mt,z.O),z.I=u(ue,Dt,z.I),z.S=u(R,$t,z.S),z.W=u(ee,Tt,z.W),z.C=u(X,Kt,z.C),z.B=u(pe,rt,z.B),z},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),V})()})}})};Pt(["click"]);var bo=G("<div>"),ux=G("<div><label></label><select><option value>"),dx=G("<div><div><span>:</span><span>$"),hx=G("<form><div><label></label><select><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><input type=number min=0.01 step=0.01></div><div><label></label><input type=number min=0 step=0.01></div><div><label></label><input type=text></div><div><label> (<!>)</label><input type=text></div><div><label> (<!>)</label><textarea></textarea></div><div><button type=button></button><button type=submit>"),tm=G("<option> (<!>)");const mx=t=>{const{t:e}=ct(),[r,n]=ve("in"),[o,i]=ve(""),[a,c]=ve(""),[d,h]=ve(""),[y,v]=ve(""),[w,E]=ve(""),[V,N]=ve(""),[x,k]=ve(""),[re,ae]=ve(!1),[F,Y]=ve({});Nn(()=>{const ne=t.movement;ne&&t.isOpen&&(n(ne.movementType),i(ne.quantity.toString()),c(ne.unitCost.toString()),h(ne.referenceNumber),v(ne.notes),N(ne.locationId),E(ne.fromLocationId||""),k(ne.invoiceId||""),Y({}))});const U=()=>{const ne={};return(!o()||parseFloat(o())<=0)&&(ne.quantity=e("forms.requiredField")),(!a()||parseFloat(a())<0)&&(ne.unitCost=e("forms.requiredField")),d().trim()||(ne.referenceNumber=e("forms.requiredField")),V()||(ne.locationId=e("forms.requiredField")),r()==="transfer"&&!w()&&(ne.fromLocationId=e("forms.requiredField")),Y(ne),Object.keys(ne).length===0},b=async ne=>{if(ne.preventDefault(),!(!U()||!t.movement)){ae(!0);try{const W=t.movement,I=Ne.getProductById(W.productId),O=Ne.getLocationById(V()),J=w()?Ne.getLocationById(w()):null;if(!I||!O)throw new Error("Product or location not found");const D={...W,movementType:r(),quantity:parseFloat(o()),unitCost:parseFloat(a()),totalCost:parseFloat(o())*parseFloat(a()),referenceNumber:d().trim(),notes:y().trim(),locationId:V(),locationName:O.name,fromLocationId:w()||void 0,fromLocationName:J?.name,invoiceId:x().trim()||void 0,lastModified:new Date().toISOString()};Ne.updateMovement(W.id,D),t.onMovementUpdated?.(),t.onClose(),g()}catch(W){console.error("Error updating movement:",W),Y({submit:e("forms.saveError")})}finally{ae(!1)}}},g=()=>{n("in"),i(""),c(""),h(""),v(""),E(""),N(""),k(""),Y({})},p=()=>{g(),t.onClose()},C={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",transition:"border-color 0.2s ease"},S={display:"block","margin-bottom":"0.25rem","font-weight":"500","font-size":"0.875rem"},A={color:"#d32f2f","font-size":"0.75rem","margin-top":"0.25rem"},m={"margin-bottom":"1rem"};return _(_r,{get isOpen(){return t.isOpen},onClose:p,get title(){return e("inventory.editMovement","Edit Movement")},get children(){return _(De,{get when(){return t.movement},get fallback(){return(()=>{var ne=bo();return s(ne,()=>e("common.loading")),ne})()},get children(){var ne=hx(),W=ne.firstChild,I=W.firstChild,O=I.nextSibling,J=O.firstChild,D=J.nextSibling,T=D.nextSibling,B=T.nextSibling,me=W.nextSibling,H=me.firstChild,de=H.nextSibling,$=de.firstChild,q=me.nextSibling,Z=q.firstChild,L=Z.nextSibling,te=q.nextSibling,j=te.firstChild,M=j.nextSibling,ie=te.nextSibling,oe=ie.firstChild,fe=oe.nextSibling,ue=ie.nextSibling,K=ue.firstChild,R=K.firstChild,ee=R.nextSibling;ee.nextSibling;var X=K.nextSibling,ye=ue.nextSibling,pe=ye.firstChild,z=pe.firstChild,se=z.nextSibling;se.nextSibling;var _e=pe.nextSibling,Pe=ye.nextSibling,he=Pe.firstChild,be=he.nextSibling;return ne.addEventListener("submit",b),s(I,()=>e("inventory.movementType")),O.addEventListener("change",ce=>n(ce.target.value)),s(J,()=>e("inventory.stockIn")),s(D,()=>e("inventory.stockOut")),s(T,()=>e("inventory.transfer")),s(B,()=>e("inventory.adjustment")),s(H,(()=>{var ce=ge(()=>r()==="transfer");return()=>ce()?e("inventory.toLocation"):e("inventory.location")})()),de.addEventListener("change",ce=>N(ce.target.value)),s($,()=>e("modals.selectLocation")),s(de,_(at,{get each(){return Ne.getActiveLocations()},children:ce=>(()=>{var Se=tm(),Ee=Se.firstChild,$e=Ee.nextSibling;return $e.nextSibling,s(Se,()=>ce.name,Ee),s(Se,()=>ce.type,$e),le(()=>Se.value=ce.id),Se})()}),null),s(me,_(De,{get when(){return F().locationId},get children(){var ce=bo();return s(ce,()=>F().locationId),le(Se=>u(ce,A,Se)),ce}}),null),s(ne,_(De,{get when(){return r()==="transfer"},get children(){var ce=ux(),Se=ce.firstChild,Ee=Se.nextSibling,$e=Ee.firstChild;return s(Se,()=>e("inventory.fromLocation")),Ee.addEventListener("change",ke=>E(ke.target.value)),s($e,()=>e("modals.selectLocation")),s(Ee,_(at,{get each(){return Ne.getActiveLocations().filter(ke=>ke.id!==V())},children:ke=>(()=>{var Me=tm(),Ke=Me.firstChild,je=Ke.nextSibling;return je.nextSibling,s(Me,()=>ke.name,Ke),s(Me,()=>ke.type,je),le(()=>Me.value=ke.id),Me})()}),null),s(ce,_(De,{get when(){return F().fromLocationId},get children(){var ke=bo();return s(ke,()=>F().fromLocationId),le(Me=>u(ke,A,Me)),ke}}),null),le(ke=>{var Me=m,Ke=S,je={...C,"border-color":F().fromLocationId?"#d32f2f":"var(--border-color)"},Ce=re();return ke.e=u(ce,Me,ke.e),ke.t=u(Se,Ke,ke.t),ke.a=u(Ee,je,ke.a),Ce!==ke.o&&(Ee.disabled=ke.o=Ce),ke},{e:void 0,t:void 0,a:void 0,o:void 0}),le(()=>Ee.value=w()),ce}}),q),s(Z,()=>e("common.quantity")),L.$$input=ce=>i(ce.target.value),s(q,_(De,{get when(){return F().quantity},get children(){var ce=bo();return s(ce,()=>F().quantity),le(Se=>u(ce,A,Se)),ce}}),null),s(j,()=>e("inventory.unitCost")),M.$$input=ce=>c(ce.target.value),s(te,_(De,{get when(){return F().unitCost},get children(){var ce=bo();return s(ce,()=>F().unitCost),le(Se=>u(ce,A,Se)),ce}}),null),s(ne,_(De,{get when(){return ge(()=>!!o())()&&a()},get children(){var ce=dx(),Se=ce.firstChild,Ee=Se.firstChild,$e=Ee.firstChild,ke=Ee.nextSibling;return ke.firstChild,Se.style.setProperty("display","flex"),Se.style.setProperty("justify-content","space-between"),Ee.style.setProperty("font-weight","500"),s(Ee,()=>e("common.total"),$e),ke.style.setProperty("font-weight","600"),ke.style.setProperty("color","var(--primary-color)"),s(ke,()=>(parseFloat(o()||"0")*parseFloat(a()||"0")).toFixed(2),null),le(Me=>u(ce,{...m,padding:"0.75rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)"},Me)),ce}}),ie),s(oe,()=>e("inventory.referenceNumber")),fe.$$input=ce=>h(ce.target.value),s(ie,_(De,{get when(){return F().referenceNumber},get children(){var ce=bo();return s(ce,()=>F().referenceNumber),le(Se=>u(ce,A,Se)),ce}}),null),s(K,()=>e("inventory.invoiceNumber"),R),s(K,()=>e("common.optional"),ee),X.$$input=ce=>k(ce.target.value),s(pe,()=>e("common.notes"),z),s(pe,()=>e("common.optional"),se),_e.$$input=ce=>v(ce.target.value),s(ne,_(De,{get when(){return F().submit},get children(){var ce=bo();return s(ce,()=>F().submit),le(Se=>u(ce,{...A,"margin-bottom":"1rem"},Se)),ce}}),Pe),Pe.style.setProperty("display","flex"),Pe.style.setProperty("gap","1rem"),Pe.style.setProperty("justify-content","flex-end"),he.$$click=p,he.style.setProperty("padding","0.5rem 1rem"),he.style.setProperty("border","1px solid var(--border-color)"),he.style.setProperty("border-radius","var(--border-radius-sm)"),he.style.setProperty("background","white"),he.style.setProperty("cursor","pointer"),s(he,()=>e("common.cancel")),be.style.setProperty("padding","0.5rem 1rem"),be.style.setProperty("border","none"),be.style.setProperty("border-radius","var(--border-radius-sm)"),be.style.setProperty("background","var(--primary-color)"),be.style.setProperty("color","white"),be.style.setProperty("cursor","pointer"),be.style.setProperty("font-weight","500"),s(be,(()=>{var ce=ge(()=>!!re());return()=>ce()?e("modals.processing"):e("inventory.updateMovement","Update Movement")})()),le(ce=>{var Se=m,Ee=S,$e=C,ke=re(),Me=m,Ke=S,je={...C,"border-color":F().locationId?"#d32f2f":"var(--border-color)"},Ce=re(),Fe=m,Qe=S,We={...C,"border-color":F().quantity?"#d32f2f":"var(--border-color)"},Je=e("modals.enterQuantity"),xe=re(),ot=m,et=S,Ct={...C,"border-color":F().unitCost?"#d32f2f":"var(--border-color)"},mt=e("modals.enterCost"),Dt=re(),$t=m,Tt=S,Kt={...C,"border-color":F().referenceNumber?"#d32f2f":"var(--border-color)"},rt=e("modals.enterReference"),Xt=re(),Ie=m,gt=S,Be=C,Oe=e("inventory.invoiceNumber"),Ze=re(),nt=m,bt=S,Xe={...C,resize:"vertical","min-height":"80px"},yt=e("modals.addNotes"),ut=re(),At=re(),Ve=re();return ce.e=u(W,Se,ce.e),ce.t=u(I,Ee,ce.t),ce.a=u(O,$e,ce.a),ke!==ce.o&&(O.disabled=ce.o=ke),ce.i=u(me,Me,ce.i),ce.n=u(H,Ke,ce.n),ce.s=u(de,je,ce.s),Ce!==ce.h&&(de.disabled=ce.h=Ce),ce.r=u(q,Fe,ce.r),ce.d=u(Z,Qe,ce.d),ce.l=u(L,We,ce.l),Je!==ce.u&&lt(L,"placeholder",ce.u=Je),xe!==ce.c&&(L.disabled=ce.c=xe),ce.w=u(te,ot,ce.w),ce.m=u(j,et,ce.m),ce.f=u(M,Ct,ce.f),mt!==ce.y&&lt(M,"placeholder",ce.y=mt),Dt!==ce.g&&(M.disabled=ce.g=Dt),ce.p=u(ie,$t,ce.p),ce.b=u(oe,Tt,ce.b),ce.T=u(fe,Kt,ce.T),rt!==ce.A&&lt(fe,"placeholder",ce.A=rt),Xt!==ce.O&&(fe.disabled=ce.O=Xt),ce.I=u(ue,Ie,ce.I),ce.S=u(K,gt,ce.S),ce.W=u(X,Be,ce.W),Oe!==ce.C&&lt(X,"placeholder",ce.C=Oe),Ze!==ce.B&&(X.disabled=ce.B=Ze),ce.v=u(ye,nt,ce.v),ce.k=u(pe,bt,ce.k),ce.x=u(_e,Xe,ce.x),yt!==ce.j&&lt(_e,"placeholder",ce.j=yt),ut!==ce.q&&(_e.disabled=ce.q=ut),At!==ce.z&&(he.disabled=ce.z=At),Ve!==ce.P&&(be.disabled=ce.P=Ve),ce},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0,x:void 0,j:void 0,q:void 0,z:void 0,P:void 0}),le(()=>O.value=r()),le(()=>de.value=V()),le(()=>L.value=o()),le(()=>M.value=a()),le(()=>fe.value=d()),le(()=>X.value=x()),le(()=>_e.value=y()),ne}})}})};Pt(["input","click"]);var yx=G("<div><div></div><div><div><label></label><select><option value=all></option><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),fx=G("<div><h2>"),rm=G("<div><label></label><select><option value>"),px=G("<option> (<!>)"),gx=G("<option>"),vx=G("<div><div></div><div></div><div>"),bx=G("<div><div><div><div><span></span><h3></h3><span></span></div><div>  </div></div><div><div></div><div> <!> @ </div></div></div><div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div><span>:</span><span>"),_x=G("<span>"),Sx=G("<span> <!>: "),nm=G("<div><span>:</span><span>"),Px=G("<div><div><span>:</span><select><option value=10>10</option><option value=25>25</option><option value=50>50</option><option value=100>100</option></select><span></span></div><div><div><span>:</span><input type=number min=1><span> "),wx=G("<span>..."),Cx=G("<button>");const Ax=t=>{const{t:e}=ct(),[r,n]=ve(""),[o,i]=ve(""),[a,c]=ve("all"),[d,h]=ve({start:"",end:""}),[y,v]=ve(""),[w,E]=ve(""),[V,N]=ve(1),[x,k]=ve(25),[re,ae]=ve(null),[F,Y]=ve(!1),[U,b]=ve(!1),g=qe(()=>{let ee=Ne.movements;if(t.filterBy==="product"&&t.filterId?ee=ee.filter(X=>X.productId===t.filterId):t.filterBy==="location"&&t.filterId&&(ee=ee.filter(X=>X.locationId===t.filterId)),r()&&(ee=ee.filter(X=>X.productId===r())),o()&&(ee=ee.filter(X=>X.locationId===o())),a()!=="all"&&(ee=ee.filter(X=>X.movementType===a())),d().start&&(ee=ee.filter(X=>X.createdDate>=d().start)),d().end&&(ee=ee.filter(X=>X.createdDate<=d().end+"T23:59:59Z")),y()){const X=y().toLowerCase();ee=ee.filter(ye=>ye.productName.toLowerCase().includes(X)||ye.productSku.toLowerCase().includes(X)||ye.locationName.toLowerCase().includes(X)||ye.referenceNumber.toLowerCase().includes(X)||ye.notes.toLowerCase().includes(X)||ye.createdBy.toLowerCase().includes(X)||ye.invoiceId&&ye.invoiceId.toLowerCase().includes(X)||ye.fromLocationName&&ye.fromLocationName.toLowerCase().includes(X)||ye.movementType.toLowerCase().includes(X))}return ee.sort((X,ye)=>new Date(ye.createdDate).getTime()-new Date(X.createdDate).getTime())});Nn(()=>{r(),o(),a(),d(),y(),N(1)});const p=qe(()=>{const ee=(V()-1)*x(),X=ee+x();return g().slice(ee,X)}),C=qe(()=>Math.ceil(g().length/x())),S=qe(()=>{const ee=g();return{total:ee.length,stockIn:ee.filter(X=>X.movementType==="in").length,stockOut:ee.filter(X=>X.movementType==="out").length,transfers:ee.filter(X=>X.movementType==="transfer").length,adjustments:ee.filter(X=>X.movementType==="adjustment").length,totalValue:ee.reduce((X,ye)=>X+ye.totalCost,0)}}),A={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},m={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},ne={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)",cursor:"pointer"},W={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},I={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem","margin-bottom":"2rem"},O={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","text-align":"center"},J={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},D={"font-size":"0.875rem",color:"var(--text-muted)","font-weight":"500"},T={padding:"1.5rem","margin-bottom":"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",transition:"all 0.2s ease"},B={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"1rem"};function me(ee){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[ee]||{bg:"#f5f5f5",color:"#666"}}const H=ee=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:me(ee).bg,color:me(ee).color}),de={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"1rem"},$={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.5rem 0","border-bottom":"1px solid var(--border-color)"},q={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},Z={"font-weight":"600",color:"var(--text-primary)"},L={display:"flex","justify-content":"space-between","align-items":"center","margin-top":"2rem",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},te=ee=>({padding:"0.25rem 0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:ee?"var(--primary-color)":"var(--surface-color)",color:ee?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),j=ee=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ee),M=ee=>new Date(ee).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),ie=ee=>({in:"",out:"",transfer:"",adjustment:""})[ee]||"",oe=()=>{n(""),i(""),c("all"),h({start:"",end:""}),v(""),N(1)},fe=ee=>{ae(ee),Y(!0)},ue=ee=>{ae(ee),Y(!1),b(!0)},K=()=>{b(!1),ae(null)},R=async ee=>{o()&&(ee+=" "+o()),Ql(a())&&(ee+=" "+Ql(a()));const X=await ln.getInventory(ee),ye=Ne.parseInventoryData(X);Ne.updMovements(ye)};return(()=>{var ee=yx(),X=ee.firstChild,ye=X.nextSibling,pe=ye.firstChild,z=pe.firstChild,se=z.nextSibling,_e=se.firstChild,Pe=_e.nextSibling,he=Pe.nextSibling,be=he.nextSibling,ce=be.nextSibling,Se=pe.nextSibling,Ee=Se.firstChild,$e=Ee.nextSibling,ke=Se.nextSibling,Me=ke.firstChild,Ke=Me.nextSibling,je=ye.nextSibling,Ce=je.firstChild,Fe=Ce.firstChild,Qe=Fe.nextSibling,We=Ce.nextSibling,Je=We.firstChild,xe=Je.nextSibling,ot=We.nextSibling,et=ot.firstChild,Ct=et.nextSibling,mt=ot.nextSibling,Dt=mt.firstChild,$t=Dt.nextSibling,Tt=mt.nextSibling,Kt=Tt.firstChild,rt=Kt.nextSibling,Xt=Tt.nextSibling,Ie=Xt.firstChild,gt=Ie.nextSibling;return s(ee,(()=>{var Be=ge(()=>!t.filterBy);return()=>Be()&&(()=>{var Oe=fx(),Ze=Oe.firstChild;return u(Oe,A),Ze.style.setProperty("margin","0"),Ze.style.setProperty("font-size","1.5rem"),s(Ze,()=>e("inventory.movements")),s(Oe,_(Le,{variant:"outline",onClick:oe,get children(){return e("common.clearFilters")}}),null),Oe})()})(),X),s(ee,_(ix,{filters:{selectedLocation:o,movementType:a},onSearchResults:Be=>{E(Be),R(Be)},get placeholder(){return e("inventory.searchProductsStock","Search inventories...")},showResults:!1,maxResults:20}),X),X.style.setProperty("margin","20px"),u(ye,m),s(ye,(()=>{var Be=ge(()=>!t.filterBy);return()=>Be()&&[(()=>{var Oe=rm(),Ze=Oe.firstChild,nt=Ze.nextSibling,bt=nt.firstChild;return Ze.style.setProperty("display","block"),Ze.style.setProperty("margin-bottom","0.5rem"),Ze.style.setProperty("font-weight","500"),s(Ze,()=>e("inventory.product")),nt.addEventListener("change",Xe=>n(Xe.target.value)),s(bt,()=>e("inventory.allProducts")),s(nt,_(at,{get each(){return Ne.products},children:Xe=>(()=>{var yt=px(),ut=yt.firstChild,At=ut.nextSibling;return At.nextSibling,s(yt,()=>Xe.name,ut),s(yt,()=>Xe.sku,At),le(()=>yt.value=Xe.id),yt})()}),null),le(Xe=>u(nt,ne,Xe)),le(()=>nt.value=r()),Oe})(),(()=>{var Oe=rm(),Ze=Oe.firstChild,nt=Ze.nextSibling,bt=nt.firstChild;return Ze.style.setProperty("display","block"),Ze.style.setProperty("margin-bottom","0.5rem"),Ze.style.setProperty("font-weight","500"),s(Ze,()=>e("inventory.location")),nt.addEventListener("change",Xe=>i(Xe.target.value)),s(bt,()=>e("inventory.allLocations")),s(nt,_(at,{get each(){return Ne.locations},children:Xe=>(()=>{var yt=gx();return s(yt,()=>Xe.name),le(()=>yt.value=Xe.id),yt})()}),null),le(Xe=>u(nt,ne,Xe)),le(()=>nt.value=o()),Oe})()]})(),pe),z.style.setProperty("display","block"),z.style.setProperty("margin-bottom","0.5rem"),z.style.setProperty("font-weight","500"),s(z,()=>e("inventory.movementType")),se.addEventListener("change",Be=>{c(Be.target.value),R(w())}),s(_e,()=>e("inventory.allTypes")),s(Pe,()=>e("inventory.stockIn")),s(he,()=>e("inventory.stockOut")),s(be,()=>e("inventory.transfer")),s(ce,()=>e("inventory.adjustment")),Ee.style.setProperty("display","block"),Ee.style.setProperty("margin-bottom","0.5rem"),Ee.style.setProperty("font-weight","500"),s(Ee,()=>e("common.startDate")),$e.addEventListener("change",Be=>h(Oe=>({...Oe,start:Be.target.value}))),Me.style.setProperty("display","block"),Me.style.setProperty("margin-bottom","0.5rem"),Me.style.setProperty("font-weight","500"),s(Me,()=>e("common.endDate")),Ke.addEventListener("change",Be=>h(Oe=>({...Oe,end:Be.target.value}))),u(je,I),s(Fe,()=>S().total),s(Qe,()=>e("inventory.totalMovements")),s(Je,()=>S().stockIn),s(xe,()=>e("inventory.stockIn")),s(et,()=>S().stockOut),s(Ct,()=>e("inventory.stockOut")),s(Dt,()=>S().transfers),s($t,()=>e("inventory.transfers")),s(Kt,()=>S().adjustments),s(rt,()=>e("inventory.adjustments")),s(Ie,()=>j(S().totalValue)),s(gt,()=>e("inventory.totalValue")),s(ee,(()=>{var Be=ge(()=>p().length===0);return()=>Be()?(()=>{var Oe=vx(),Ze=Oe.firstChild,nt=Ze.nextSibling,bt=nt.nextSibling;return Oe.style.setProperty("text-align","center"),Oe.style.setProperty("padding","3rem"),Oe.style.setProperty("color","var(--text-muted)"),Oe.style.setProperty("background","var(--surface-color)"),Oe.style.setProperty("border-radius","var(--border-radius)"),Oe.style.setProperty("border","1px solid var(--border-color)"),Ze.style.setProperty("font-size","1.5rem"),Ze.style.setProperty("margin-bottom","1rem"),nt.style.setProperty("font-size","1.1rem"),nt.style.setProperty("margin-bottom","0.5rem"),s(nt,()=>e("inventory.noMovementsFound")),bt.style.setProperty("font-size","0.875rem"),s(bt,()=>e("inventory.tryAdjustingFilters")),Oe})():[_(at,{get each(){return p()},children:Oe=>(()=>{var Ze=bx(),nt=Ze.firstChild,bt=nt.firstChild,Xe=bt.firstChild,yt=Xe.firstChild,ut=yt.nextSibling,At=ut.nextSibling,Ve=Xe.nextSibling,zt=Ve.firstChild,vt=bt.nextSibling,Nt=vt.firstChild,Bt=Nt.nextSibling,ft=Bt.firstChild,Lt=ft.nextSibling;Lt.nextSibling;var pt=nt.nextSibling,kt=pt.firstChild,Zt=kt.firstChild,dr=Zt.firstChild,Tr=dr.firstChild,hr=dr.nextSibling,gn=Zt.nextSibling,Mn=gn.firstChild,Vo=Mn.firstChild,mo=Mn.nextSibling,yo=kt.nextSibling,On=yo.firstChild,Vn=On.firstChild,Cs=Vn.firstChild,Pi=Vn.nextSibling;return Ze.addEventListener("mouseleave",_t=>{_t.currentTarget.style.transform="translateY(0)",_t.currentTarget.style.boxShadow="none"}),Ze.addEventListener("mouseenter",_t=>{_t.currentTarget.style.transform="translateY(-2px)",_t.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),Ze.$$click=()=>fe(Oe),u(nt,B),Xe.style.setProperty("display","flex"),Xe.style.setProperty("align-items","center"),Xe.style.setProperty("gap","0.5rem"),Xe.style.setProperty("margin-bottom","0.5rem"),yt.style.setProperty("font-size","1.2rem"),s(yt,()=>ie(Oe.movementType)),ut.style.setProperty("margin","0"),ut.style.setProperty("font-size","1.1rem"),s(ut,()=>Oe.productName),s(At,()=>Oe.movementType),s(Xe,(()=>{var _t=ge(()=>!!Oe.invoiceId);return()=>_t()&&(()=>{var qt=_x();return qt.style.setProperty("padding","0.2rem 0.5rem"),qt.style.setProperty("border-radius","var(--border-radius-sm)"),qt.style.setProperty("font-size","0.7rem"),qt.style.setProperty("font-weight","500"),qt.style.setProperty("background","var(--primary-color)"),qt.style.setProperty("color","white"),s(qt,()=>e("inventory.bulk")),qt})()})(),null),Ve.style.setProperty("font-size","0.875rem"),Ve.style.setProperty("color","var(--text-muted)"),s(Ve,()=>Oe.productSku,zt),s(Ve,()=>M(Oe.createdDate),null),s(Ve,(()=>{var _t=ge(()=>!!Oe.invoiceId);return()=>_t()&&(()=>{var qt=Sx(),Sr=qt.firstChild,Wr=Sr.nextSibling;return Wr.nextSibling,qt.style.setProperty("margin-left","0.5rem"),qt.style.setProperty("font-weight","500"),s(qt,()=>e("common.invoice"),Wr),s(qt,()=>Oe.invoiceId,null),qt})()})(),null),vt.style.setProperty("text-align","right"),Nt.style.setProperty("font-size","1.25rem"),Nt.style.setProperty("font-weight","700"),Nt.style.setProperty("color","var(--primary-color)"),s(Nt,()=>j(Oe.totalCost)),Bt.style.setProperty("font-size","0.875rem"),Bt.style.setProperty("color","var(--text-muted)"),s(Bt,()=>Oe.quantity,ft),s(Bt,()=>e("common.units"),Lt),s(Bt,()=>j(Oe.unitCost),null),u(pt,de),s(dr,()=>e("inventory.location"),Tr),s(hr,()=>Oe.locationName),s(kt,(()=>{var _t=ge(()=>!!Oe.fromLocationName);return()=>_t()&&(()=>{var qt=nm(),Sr=qt.firstChild,Wr=Sr.firstChild,vn=Sr.nextSibling;return s(Sr,()=>e("common.from"),Wr),s(vn,()=>Oe.fromLocationName),le(Qt=>{var kr=$,en=q,tn=Z;return Qt.e=u(qt,kr,Qt.e),Qt.t=u(Sr,en,Qt.t),Qt.a=u(vn,tn,Qt.a),Qt},{e:void 0,t:void 0,a:void 0}),qt})()})(),gn),s(Mn,()=>e("common.reference"),Vo),s(mo,()=>Oe.referenceNumber),s(Vn,()=>e("common.createdBy"),Cs),s(Pi,()=>Oe.createdBy),s(yo,(()=>{var _t=ge(()=>!!Oe.notes);return()=>_t()&&(()=>{var qt=nm(),Sr=qt.firstChild,Wr=Sr.firstChild,vn=Sr.nextSibling;return s(Sr,()=>e("common.notes"),Wr),s(vn,()=>Oe.notes),le(Qt=>{var kr={...$,"border-bottom":"none"},en=q,tn={...Z,"max-width":"200px","text-align":"right","font-style":"italic"};return Qt.e=u(qt,kr,Qt.e),Qt.t=u(Sr,en,Qt.t),Qt.a=u(vn,tn,Qt.a),Qt},{e:void 0,t:void 0,a:void 0}),qt})()})(),null),le(_t=>{var qt={...T,"border-left":Oe.invoiceId?"4px solid var(--primary-color)":"1px solid var(--border-color)",cursor:"pointer"},Sr=H(Oe.movementType),Wr=$,vn=q,Qt=Z,kr=$,en=q,tn=Z,As=$,Gt=q,Fo=Z;return _t.e=u(Ze,qt,_t.e),_t.t=u(At,Sr,_t.t),_t.a=u(Zt,Wr,_t.a),_t.o=u(dr,vn,_t.o),_t.i=u(hr,Qt,_t.i),_t.n=u(gn,kr,_t.n),_t.s=u(Mn,en,_t.s),_t.h=u(mo,tn,_t.h),_t.r=u(On,As,_t.r),_t.d=u(Vn,Gt,_t.d),_t.l=u(Pi,Fo,_t.l),_t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),Ze})()}),ge(()=>ge(()=>C()>1)()&&(()=>{var Oe=Px(),Ze=Oe.firstChild,nt=Ze.firstChild,bt=nt.firstChild,Xe=nt.nextSibling,yt=Xe.nextSibling,ut=Ze.nextSibling,At=ut.firstChild,Ve=At.firstChild,zt=Ve.firstChild,vt=Ve.nextSibling,Nt=vt.nextSibling,Bt=Nt.firstChild;return u(Oe,L),Ze.style.setProperty("display","flex"),Ze.style.setProperty("align-items","center"),Ze.style.setProperty("gap","0.5rem"),nt.style.setProperty("font-size","0.875rem"),nt.style.setProperty("color","var(--text-muted)"),s(nt,()=>e("common.showPerPage","Show per page"),bt),Xe.addEventListener("change",ft=>{k(Number(ft.target.value)),N(1)}),Xe.style.setProperty("padding","0.25rem 0.5rem"),Xe.style.setProperty("border","1px solid var(--border-color)"),Xe.style.setProperty("border-radius","var(--border-radius-sm)"),Xe.style.setProperty("background","var(--surface-color)"),Xe.style.setProperty("cursor","pointer"),Xe.style.setProperty("font-size","0.875rem"),yt.style.setProperty("font-size","0.875rem"),yt.style.setProperty("color","var(--text-muted)"),yt.style.setProperty("margin-left","1rem"),s(yt,()=>e("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:(V()-1)*x()+1,end:Math.min(V()*x(),g().length),total:g().length})),ut.style.setProperty("display","flex"),ut.style.setProperty("align-items","center"),ut.style.setProperty("gap","0.5rem"),s(ut,_(Le,{variant:"outline",size:"sm",onClick:()=>N(1),get disabled(){return V()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.first","First")}}),At),s(ut,_(Le,{variant:"outline",size:"sm",onClick:()=>N(ft=>Math.max(1,ft-1)),get disabled(){return V()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.previous")}}),At),s(ut,()=>{const ft=[],Lt=C(),pt=V();if(Lt<=7)for(let kt=1;kt<=Lt;kt++)ft.push(kt);else{ft.push(1),pt>3&&ft.push("...");for(let kt=Math.max(2,pt-1);kt<=Math.min(Lt-1,pt+1);kt++)ft.includes(kt)||ft.push(kt);pt<Lt-2&&ft.push("..."),ft.includes(Lt)||ft.push(Lt)}return _(at,{each:ft,children:kt=>kt==="..."?(()=>{var Zt=wx();return Zt.style.setProperty("padding","0 0.5rem"),Zt.style.setProperty("color","var(--text-muted)"),Zt})():(()=>{var Zt=Cx();return Zt.$$click=()=>N(kt),s(Zt,kt),le(dr=>u(Zt,te(kt===V()),dr)),Zt})()})},At),s(ut,_(Le,{variant:"outline",size:"sm",onClick:()=>N(ft=>Math.min(C(),ft+1)),get disabled(){return V()===C()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.next")}}),At),s(ut,_(Le,{variant:"outline",size:"sm",onClick:()=>N(C()),get disabled(){return V()===C()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.last","Last")}}),At),At.style.setProperty("display","flex"),At.style.setProperty("align-items","center"),At.style.setProperty("gap","0.5rem"),At.style.setProperty("margin-left","1rem"),Ve.style.setProperty("font-size","0.875rem"),Ve.style.setProperty("color","var(--text-muted)"),s(Ve,()=>e("common.page","Page"),zt),vt.addEventListener("change",ft=>{const Lt=Number(ft.target.value);Lt>=1&&Lt<=C()&&N(Lt)}),vt.style.setProperty("width","4rem"),vt.style.setProperty("padding","0.25rem 0.5rem"),vt.style.setProperty("border","1px solid var(--border-color)"),vt.style.setProperty("border-radius","var(--border-radius-sm)"),vt.style.setProperty("background","var(--surface-color)"),vt.style.setProperty("text-align","center"),vt.style.setProperty("font-size","0.875rem"),Nt.style.setProperty("font-size","0.875rem"),Nt.style.setProperty("color","var(--text-muted)"),s(Nt,()=>e("common.of","of"),Bt),s(Nt,C,null),le(()=>lt(vt,"max",C())),le(()=>Xe.value=x()),le(()=>vt.value=V()),Oe})())]})(),null),s(ee,_(cx,{get isOpen(){return F()},onClose:()=>{Y(!1),ae(null)},get movement(){return re()},onEdit:ue}),null),s(ee,_(De,{get when(){return St.hasPermission("read_write")},get children(){return _(mx,{get isOpen(){return U()},onClose:()=>{b(!1),ae(null)},get movement(){return re()},onMovementUpdated:K})}}),null),le(Be=>{var Oe=ne,Ze=W,nt=W,bt=O,Xe=J,yt=D,ut=O,At={...J,color:"#2d7d32"},Ve=D,zt=O,vt={...J,color:"#d32f2f"},Nt=D,Bt=O,ft={...J,color:"#1976d2"},Lt=D,pt=O,kt={...J,color:"#f57c00"},Zt=D,dr=O,Tr=J,hr=D;return Be.e=u(se,Oe,Be.e),Be.t=u($e,Ze,Be.t),Be.a=u(Ke,nt,Be.a),Be.o=u(Ce,bt,Be.o),Be.i=u(Fe,Xe,Be.i),Be.n=u(Qe,yt,Be.n),Be.s=u(We,ut,Be.s),Be.h=u(Je,At,Be.h),Be.r=u(xe,Ve,Be.r),Be.d=u(ot,zt,Be.d),Be.l=u(et,vt,Be.l),Be.u=u(Ct,Nt,Be.u),Be.c=u(mt,Bt,Be.c),Be.w=u(Dt,ft,Be.w),Be.m=u($t,Lt,Be.m),Be.f=u(Tt,pt,Be.f),Be.y=u(Kt,kt,Be.y),Be.g=u(rt,Zt,Be.g),Be.p=u(Xt,dr,Be.p),Be.b=u(Ie,Tr,Be.b),Be.T=u(gt,hr,Be.T),Be},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),le(()=>se.value=a()),le(()=>$e.value=d().start),le(()=>Ke.value=d().end),ee})()};Pt(["click"]);var xx=G("<div><p> "),Ix=G("<div>"),Ex=G("<div><div></div><h3></h3><p></p><div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=name></option><option value=sku></option><option value=category>"),$x=G("<div><div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div>%</div><div></div></div></div><div></div><div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),Tx=G("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),kx=G("<div><div></div><h3></h3><p>"),Rx=G("<div><div><h3> </h3><p></p></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div></div><div>"),Dx=G("<div><div><div><h2> </h2><button>"),om=G("<option>"),Nx=G("<div>..."),Lx=G("<tr><td><div></div><div>  </div></td><td><div></div></td><td><div></div></td><td><div></div></td><td><div>"),Mx=G("<tr><td><div></div></td><td><div></div><div>  <!>  </div></td><td><div></div></td><td><input type=number placeholder=0 min=0 step=0.01></td><td><div></div></td><td><input type=text>");const Ox=t=>{const{t:e}=ct(),[r,n]=ve([]),[o,i]=ve(!1),[a,c]=ve(!1),[d,h]=ve("all"),[y,v]=ve("all"),[w,E]=ve("name"),[V,N]=ve([]),[x,k]=ve("setup"),re=async()=>{try{i(!0);const D=await ln.getProducts("prod");if(!D||typeof D!="object"){console.warn("No API results, using local store"),n(Ne.products);return}const T=Object.keys(D),B=H=>{let $=D[H];return{id:H,name:$.name||"Unknown Product",businessId:$.businessId||"",sku:$.code||$.sku||"",UPC:$.UPC||"",numCode:$.codeN||"",category:$.category||"General",unitCost:$.unitCost||0,unitOfMeasure:$.unitOfMeasure||"pcs",minStockLevel:$.minStockLevel||0,maxStockLevel:$.maxStockLevel||100,isActive:$.isActive!==!1,description:$.description||"",createdDate:$.createdAt||new Date().toISOString(),lastModified:$.updatedAt||new Date().toISOString(),sellingPrice:parseFloat($.sellingPrice||$.price||"0")}},me=T.map(B);n(me)}catch(D){console.error("Failed to load products from API:",D),n(Ne.products)}finally{i(!1)}},ae=qe(()=>[...new Set(r().map(T=>T.category).filter(T=>T))].sort()),F=qe(()=>{let D=r().filter(T=>T.isActive);return y()!=="all"&&(D=D.filter(T=>T.category===y())),D.sort((T,B)=>{switch(w()){case"name":return T.name.localeCompare(B.name);case"sku":return T.sku.localeCompare(B.sku);case"category":return T.category.localeCompare(B.category)||T.name.localeCompare(B.name);default:return 0}}),D}),Y=qe(()=>Ne.getActiveLocations()),U=(D,T)=>T&&T!=="all"?Ne.getStockByProductAndLocation(D,T)?.quantity||0:Ne.getTotalStockByProduct(D),b=()=>{const D=F().map(T=>{const B=U(T.id,d()!=="all"?d():void 0);return{productId:T.id,systemQuantity:B,physicalCount:null,notes:"",variance:0,product:T}});N(D),k("counting")},g=(D,T)=>{N(B=>B.map(me=>{if(me.productId===D){const H=T,de=H!==null?H-me.systemQuantity:0;return{...me,physicalCount:H,variance:de}}return me}))},p=(D,T)=>{N(B=>B.map(me=>me.productId===D?{...me,notes:T}:me))},C=qe(()=>{const D=V(),T=D.length,B=D.filter($=>$.physicalCount!==null).length,me=D.filter($=>$.variance!==0).length,H=D.filter($=>$.variance>0).length,de=D.filter($=>$.variance<0).length;return{totalProducts:T,countedProducts:B,remainingProducts:T-B,variances:me,positiveVariances:H,negativeVariances:de,isComplete:B===T}}),S=()=>{const D=V().filter(H=>H.physicalCount!==null&&H.variance!==0);if(D.length===0)return null;const T=[e("inventory.product","Product"),e("inventory.sku","SKU"),e("inventory.category","Category"),e("inventory.location","Location"),e("inventory.systemQty","System Qty"),e("inventory.physicalCount","Physical Count"),e("inventory.variance","Variance"),e("inventory.adjustment","Adjustment"),e("common.notes","Notes"),e("common.date","Date")],B=D.map(H=>[`"${H.product.name}"`,`"${H.product.sku}"`,`"${H.product.category}"`,`"${ne()}"`,H.systemQuantity,H.physicalCount,H.variance,H.variance>0?e("inventory.stockIncrease","Stock Increase"):e("inventory.stockDecrease","Stock Decrease"),`"${H.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")}"`,`"${W()}"`]);return[T.join(","),...B.map(H=>H.join(","))].join(`
`)},A=()=>{const D=S();if(!D){alert(e("inventory.noAdjustmentsToDownload","No adjustments to download"));return}const T=new Blob([D],{type:"text/csv;charset=utf-8;"}),B=document.createElement("a");if(B.download!==void 0){const me=URL.createObjectURL(T);B.setAttribute("href",me),B.setAttribute("download",`inventory-adjustments-${W().replace(/[/:,\s]/g,"-")}.csv`),B.style.visibility="hidden",document.body.appendChild(B),B.click(),document.body.removeChild(B)}},m=async(D=!0)=>{try{c(!0),console.log(V());const T=q=>{let Z=Ne.getProductById(q.productId),L=Ne.getStockByProductAndLocation(q.productId,d()),te=parseFloat(L?.averageCost+""),j=parseFloat(L?.quantity+"");return{product:{id:q.productId,label:Z?.name,code:Z?.code},productId:q?.productId,reason:"Physical Count Adjustment",notes:q?.notes||"Physical inventory adjustment",quantity:q?.variance,unitCost:te}},B=V().filter(q=>q.physicalCount!==null&&q.variance!==0).map(T);let me="ADJ_"+ud();const H=new Date().toISOString(),de={ssg_inventory_key:Qm(),invoiceId:me,referenceNumber:ud(),movementType:"adjustment",type:"adjustment",locationId:d(),items:B,products:B,generalNotes:"Physical inventory adjustment",description:"Physical Count Adjustment",invoice:me,store:d(),createdBy:"admin",createDate:H};console.log("Saving inventory bulkRequest:",de);const $=await ln.addInventory(de);D&&B.length>0&&A(),console.log("Saving inventory adjustments:",B),await new Promise(q=>setTimeout(q,1e3)),t.onClose()}catch(T){console.error("Failed to save inventory adjustments:",T)}finally{c(!1)}},ne=qe(()=>d()==="all"?"All Locations":Y().find(T=>T.id===d())?.name||"Unknown Location"),W=()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),I=async()=>{await Ne.fecthInventory("prod"),await re()};Hr(async()=>{t.selectedLocationId&&h(t.selectedLocationId),I()});const O=()=>{const D=window.open("","_blank");if(!D){alert("Please allow pop-ups to print the counting sheet");return}const T=J();D.document.write(T),D.document.close(),D.onload=()=>{D.print(),D.onafterprint=()=>{D.close()}}},J=()=>{const D=F().map((T,B)=>{const me=U(T.id,d()!=="all"?d():void 0);return`
        <tr>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${B+1}</td>
          <td style="border: 1px solid #000; padding: 8px; font-family: monospace;">${T.sku}</td>
          <td style="border: 1px solid #000; padding: 8px;">
            <div style="font-weight: 500;">${T.name}</div>
            ${T.UPC?`<div style="font-size: 0.8em; color: #666;">UPC: ${T.UPC}</div>`:""}
          </td>
         
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${T.unitOfMeasure}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">${me}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; background-color: #f9f9f9;"></td>
          <td style="border: 1px solid #000; padding: 8px;"></td>
        </tr>
      `}).join("");return`
      <!DOCTYPE html>
      <html>
      <head>
        <title> ${ne()}_${y()}_${e("inventory.countingSheet","Inventory Counting Sheet")} - ${W()}</title>
        <style>
          @page {
            size: letter;
            margin: 0.5in 0.8in 0.5in 0.8in;
            @top-center {
              content: "${ne()} | ${y()==="all"?e("inventory.allCategories","All Categories"):y()} | Page " counter(page);
              font-size: 10px;
              font-weight: bold;
              border-bottom: 1px solid #ccc;
              padding-bottom: 5px;
            }
          }
          body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            margin: 0;
            padding: 0;
            position: relative;
          }
          .page-identifier {
            position: fixed;
            left: 5px;
            top: 50%;
            transform: rotate(-90deg) translateX(-50%);
            transform-origin: left center;
            background: #f0f0f0;
            padding: 5px 15px;
            border: 1px solid #ccc;
            font-weight: bold;
            font-size: 10px;
            color: #333;
            z-index: 100;
          }
          .page-identifier-right {
            position: fixed;
            right: 5px;
            top: 50%;
            transform: rotate(90deg) translateX(50%);
            transform-origin: right center;
            background: #f0f0f0;
            padding: 5px 15px;
            border: 1px solid #ccc;
            font-weight: bold;
            font-size: 10px;
            color: #333;
            z-index: 100;
          }
          h1 {
            text-align: center;
            margin: 0 0 10px 0;
            font-size: 22px;
            page-break-after: avoid;
          }
          .header-info {
            text-align: center;
            margin-bottom: 20px;
            background: #f8f8f8;
            padding: 10px;
            border: 2px solid #333;
            page-break-after: avoid;
          }
          .page-header {
            display: none;
            text-align: center;
            background: #e0e0e0;
            padding: 8px;
            border: 1px solid #333;
            margin-bottom: 10px;
            font-weight: bold;
            font-size: 11px;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
          }
          th {
            background-color: #333;
            color: white;
            padding: 8px;
            text-align: left;
            font-weight: bold;
            border: 1px solid #000;
          }
          .summary-table {
            width: 50%;
            margin: 20px auto;
            /*page-break-before: auto;*/
          }
          .signature-section {
            margin-top: 40px;
            display: flex;
            justify-content: space-between;
            page-break-before: auto;
          }
          .signature-box {
            width: 45%;
            text-align: center;
          }
          .signature-line {
            border-bottom: 1px solid #000;
            margin-bottom: 5px;
            height: 30px;
          }
          @media print {
            body { margin: 0; }
            .page-identifier, .page-identifier-right { display: block; }
            .page-header { display: block; }
            tr { page-break-inside: avoid; }
            thead { display: table-header-group; }
            tfoot { display: table-footer-group; }
            .header-info { page-break-after: avoid; }
            h1 { page-break-after: avoid; }
            table { page-break-before: auto; }
            /*.summary-table { page-break-before: always; }*/
            .signature-section { page-break-before: avoid; }
            
            /* Repeat headers on each page */
            @page :first {
              @top-center { content: none; }
            }
            
            /* Force page headers to show on continuation pages */
            tbody::before {
              content: "";
              display: block;
              height: 0;
            }
          }
        </style>
      </head>
      <body>
        <!-- Page identifiers for multi-page documents -->
        <div class="page-identifier-right">
          ${ne()} - ${y()==="all"?e("inventory.allCategories","All Categories"):y()} - ${W()} 
        </div>
       
        
        <h1>${e("inventory.inventoryCountingSheetTitle","INVENTORY COUNTING SHEET")}</h1>
        <div class="header-info">
          <p><strong>${e("inventory.location","Location")}:</strong> ${ne()}</p>
          <p><strong>${e("common.category","Category")}:</strong> ${y()==="all"?e("inventory.allCategories","All Categories"):y()}</p>
          <p><strong>${e("common.date","Date")}:</strong> ${W()}</p>
          <p style="margin-top: 10px;">
            <span style="margin-right: 30px;">${e("inventory.countedBy","Counted by")}: _________________________</span>
            <span>${e("inventory.verifiedBy","Verified by")}: _________________________</span>
          </p>
        </div>

        <!-- Page header for continuation pages (hidden on first page) -->
        <div class="page-header">
          ${ne()} | ${y()==="all"?e("inventory.allCategories","All Categories"):y()} | ${W()} 
        </div>

        <table>
          <thead>
            <tr>
              <th style="width: 5%; text-align: center;">#</th>
              <th style="width: 12%;">${e("inventory.sku","SKU")}</th>
              <th style="width: 25%;">${e("inventory.productName","Product Name")}</th>
              <th style="width: 8%; text-align: center;">${e("inventory.unit","Unit")}</th>
              <th style="width: 10%; text-align: center;">${e("inventory.systemQty","System Qty")}</th>
              <th style="width: 12%; text-align: center; background-color: #f0f0f0;">${e("inventory.physicalCount","Physical Count")}</th>
              <th style="width: 28%;">${e("common.notes","Notes")}</th>
            </tr>
            <!-- Repeat header info row for clarity -->
            <tr style="background-color: #f8f8f8; font-size: 10px;">
              <td colspan="8" style="text-align: center; padding: 4px; border: 1px solid #000; font-weight: bold;">
                 ${ne()} |  ${y()==="all"?e("inventory.allCategories","All Categories"):y()} |  ${W()}
              </td>
            </tr>
          </thead>
          <tbody>
            ${D}
          </tbody>
        </table>
        
        <!-- Summary section with location/category context -->
        <div style="margin: 30px 0; padding: 15px; background: #f8f8f8;">
          <h3 style="text-align: center; margin: 0 0 15px 0; font-size: 16px;">
            ${e("inventory.summaryFor","SUMMARY FOR")}: ${ne()} - ${y()==="all"?e("inventory.allCategories","All Categories"):y()}
          </h3>
          
          <table class="summary-table">
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.totalProductsListed","Total Products Listed")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">
                ${F().length}
              </td>
            </tr>
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.itemsCounted","Items Counted")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center;">
                ___________
              </td>
            </tr>
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.discrepanciesFound","Discrepancies Found")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center;">
                ___________
              </td>
            </tr>
          </table>
        </div>
        
        <div class="signature-section">
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.counterSignature","Counter Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.supervisorSignature","Supervisor Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
        </div>
      </body>
      </html>
    `};return _(De,{get when(){return t.isOpen},get children(){var D=Dx(),T=D.firstChild,B=T.firstChild,me=B.firstChild;me.firstChild;var H=me.nextSibling;return D.style.setProperty("position","fixed"),D.style.setProperty("top","0"),D.style.setProperty("left","0"),D.style.setProperty("right","0"),D.style.setProperty("bottom","0"),D.style.setProperty("background","rgba(0, 0, 0, 0.5)"),D.style.setProperty("z-index","1000"),D.style.setProperty("display","flex"),D.style.setProperty("align-items","center"),D.style.setProperty("justify-content","center"),T.style.setProperty("background","white"),T.style.setProperty("border-radius","var(--border-radius)"),T.style.setProperty("padding","2rem"),T.style.setProperty("width","95%"),T.style.setProperty("height","95%"),T.style.setProperty("max-width","1400px"),T.style.setProperty("overflow-y","auto"),T.style.setProperty("position","relative"),B.style.setProperty("display","flex"),B.style.setProperty("justify-content","space-between"),B.style.setProperty("align-items","center"),B.style.setProperty("margin-bottom","2rem"),B.style.setProperty("border-bottom","1px solid var(--border-color)"),B.style.setProperty("padding-bottom","1rem"),me.style.setProperty("margin","0"),me.style.setProperty("font-size","1.5rem"),s(me,()=>e("inventory.physicalInventoryCount","Physical Inventory Count"),null),co(H,"click",t.onClose,!0),H.style.setProperty("background","none"),H.style.setProperty("border","none"),H.style.setProperty("font-size","1.5rem"),H.style.setProperty("cursor","pointer"),H.style.setProperty("padding","0.5rem"),s(T,_(De,{get when(){return x()==="setup"},get children(){var de=Ex(),$=de.firstChild,q=$.nextSibling,Z=q.nextSibling,L=Z.nextSibling,te=L.firstChild,j=te.firstChild,M=j.firstChild,ie=j.nextSibling,oe=ie.firstChild,fe=te.nextSibling,ue=fe.firstChild,K=ue.firstChild,R=ue.nextSibling,ee=R.firstChild,X=fe.nextSibling,ye=X.firstChild,pe=ye.firstChild,z=ye.nextSibling,se=z.firstChild,_e=se.nextSibling,Pe=_e.nextSibling;return de.style.setProperty("text-align","center"),de.style.setProperty("padding","2rem"),de.style.setProperty("max-width","600px"),de.style.setProperty("margin","0 auto"),$.style.setProperty("font-size","3rem"),$.style.setProperty("margin-bottom","1rem"),q.style.setProperty("margin-bottom","1rem"),s(q,()=>e("inventory.setupPhysicalCount","Setup Physical Inventory Count")),Z.style.setProperty("margin-bottom","2rem"),Z.style.setProperty("color","var(--text-muted)"),s(Z,()=>e("inventory.setupDescription","Configure your physical inventory count settings and begin the counting process.")),L.style.setProperty("display","grid"),L.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),L.style.setProperty("gap","1rem"),L.style.setProperty("margin-bottom","2rem"),L.style.setProperty("padding","1rem"),L.style.setProperty("background","var(--surface-color)"),L.style.setProperty("border-radius","var(--border-radius)"),L.style.setProperty("text-align","left"),j.style.setProperty("display","block"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("font-weight","500"),s(j,()=>e("inventory.location","Location"),M),ie.addEventListener("change",he=>h(he.target.value)),ie.style.setProperty("width","100%"),ie.style.setProperty("padding","0.5rem"),ie.style.setProperty("border","1px solid var(--border-color)"),ie.style.setProperty("border-radius","var(--border-radius-sm)"),s(oe,()=>e("inventory.allLocations","All Locations")),s(ie,_(at,{get each(){return Y()},children:he=>(()=>{var be=om();return s(be,()=>he.name),le(()=>be.value=he.id),be})()}),null),ue.style.setProperty("display","block"),ue.style.setProperty("margin-bottom","0.5rem"),ue.style.setProperty("font-weight","500"),s(ue,()=>e("inventory.category","Category"),K),R.addEventListener("change",he=>v(he.target.value)),R.style.setProperty("width","100%"),R.style.setProperty("padding","0.5rem"),R.style.setProperty("border","1px solid var(--border-color)"),R.style.setProperty("border-radius","var(--border-radius-sm)"),s(ee,()=>e("products.allCategories","All Categories")),s(R,_(at,{get each(){return ae()},children:he=>(()=>{var be=om();return be.value=he,s(be,he),be})()}),null),ye.style.setProperty("display","block"),ye.style.setProperty("margin-bottom","0.5rem"),ye.style.setProperty("font-weight","500"),s(ye,()=>e("inventory.sortBy","Sort By"),pe),z.addEventListener("change",he=>E(he.target.value)),z.style.setProperty("width","100%"),z.style.setProperty("padding","0.5rem"),z.style.setProperty("border","1px solid var(--border-color)"),z.style.setProperty("border-radius","var(--border-radius-sm)"),s(se,()=>e("inventory.productName","Product Name")),s(_e,()=>e("inventory.sku","SKU")),s(Pe,()=>e("inventory.category","Category")),s(de,_(De,{get when(){return!o()},get fallback(){return(()=>{var he=Nx(),be=he.firstChild;return he.style.setProperty("padding","2rem"),s(he,()=>e("common.loading","Loading"),be),he})()},get children(){return[(()=>{var he=xx(),be=he.firstChild;return be.firstChild,he.style.setProperty("padding","1rem"),he.style.setProperty("background","#fff3cd"),he.style.setProperty("border-radius","var(--border-radius-sm)"),he.style.setProperty("margin-bottom","2rem"),be.style.setProperty("margin","0"),be.style.setProperty("color","#856404"),s(be,()=>e("inventory.countWillInclude","This count will include {{count}} products from {{location}} in {{category}} category.",{count:F().length,location:ne(),category:y()==="all"?e("inventory.allCategories","all categories"):y()}),null),he})(),_(De,{get when(){return ge(()=>y()!=="all")()&&d()!=="all"},get children(){var he=Ix();return he.style.setProperty("display","grid"),he.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),he.style.setProperty("gap","1rem"),he.style.setProperty("margin-bottom","2rem"),he.style.setProperty("padding","1rem"),he.style.setProperty("background","var(--surface-color)"),he.style.setProperty("border-radius","var(--border-radius)"),s(he,_(De,{get when(){return St.hasPermission("physicalInventoryCountingForm")},get children(){return _(Le,{variant:"primary",size:"large",onClick:b,get disabled(){return o()||F().length===0},get children(){return[" ",ge(()=>e("inventory.startCounting","Start Physical Count"))]}})}}),null),s(he,_(Le,{variant:"primary",onClick:O,get disabled(){return o()},get children(){return[" ",ge(()=>e("common.print","Print"))]}}),null),he}})]}}),null),le(()=>ie.value=d()),le(()=>R.value=y()),le(()=>z.value=w()),de}}),null),s(T,_(De,{get when(){return x()==="counting"},get children(){var de=$x(),$=de.firstChild,q=$.nextSibling,Z=q.firstChild,L=Z.firstChild,te=L.nextSibling,j=Z.nextSibling,M=j.firstChild,ie=M.nextSibling,oe=j.nextSibling,fe=oe.firstChild,ue=fe.nextSibling,K=oe.nextSibling,R=K.firstChild,ee=R.firstChild,X=R.nextSibling,ye=q.nextSibling,pe=ye.nextSibling,z=pe.firstChild,se=z.firstChild,_e=se.firstChild,Pe=_e.firstChild,he=Pe.nextSibling,be=he.nextSibling,ce=be.nextSibling,Se=ce.nextSibling,Ee=Se.nextSibling,$e=se.nextSibling;return $.style.setProperty("display","grid"),$.style.setProperty("grid-template-columns","repeat(auto-fit)"),$.style.setProperty("gap","1rem"),$.style.setProperty("margin-bottom","2rem"),$.style.setProperty("padding","1rem"),$.style.setProperty("background","var(--surface-color)"),$.style.setProperty("border-radius","var(--border-radius)"),s($,ne),q.style.setProperty("display","grid"),q.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),q.style.setProperty("gap","1rem"),q.style.setProperty("margin-bottom","2rem"),q.style.setProperty("padding","1rem"),q.style.setProperty("background","var(--surface-color)"),q.style.setProperty("border-radius","var(--border-radius)"),Z.style.setProperty("text-align","center"),L.style.setProperty("font-size","1.5rem"),L.style.setProperty("font-weight","700"),L.style.setProperty("color","var(--primary-color)"),s(L,()=>C().countedProducts),te.style.setProperty("font-size","0.875rem"),te.style.setProperty("color","var(--text-muted)"),s(te,()=>e("inventory.counted","Counted")),j.style.setProperty("text-align","center"),M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","700"),M.style.setProperty("color","#ff9800"),s(M,()=>C().remainingProducts),ie.style.setProperty("font-size","0.875rem"),ie.style.setProperty("color","var(--text-muted)"),s(ie,()=>e("inventory.remaining","Remaining")),oe.style.setProperty("text-align","center"),fe.style.setProperty("font-size","1.5rem"),fe.style.setProperty("font-weight","700"),fe.style.setProperty("color","#f44336"),s(fe,()=>C().variances),ue.style.setProperty("font-size","0.875rem"),ue.style.setProperty("color","var(--text-muted)"),s(ue,()=>e("inventory.variances","Variances")),K.style.setProperty("text-align","center"),R.style.setProperty("font-size","1.5rem"),R.style.setProperty("font-weight","700"),s(R,()=>Math.round(C().countedProducts/C().totalProducts*100),ee),X.style.setProperty("font-size","0.875rem"),X.style.setProperty("color","var(--text-muted)"),s(X,()=>e("inventory.complete","Complete")),ye.style.setProperty("display","flex"),ye.style.setProperty("gap","1rem"),ye.style.setProperty("margin-bottom","2rem"),ye.style.setProperty("justify-content","center"),s(ye,_(Le,{variant:"outline",onClick:()=>k("setup"),get children(){return[" ",ge(()=>e("common.back","Back to Setup"))]}}),null),s(ye,_(Le,{variant:"primary",onClick:()=>k("review"),get children(){return[" ",ge(()=>e("inventory.reviewAdjustments","Review Adjustments"))]}}),null),pe.style.setProperty("border","1px solid var(--border-color)"),pe.style.setProperty("border-radius","var(--border-radius)"),pe.style.setProperty("overflow-x","auto"),z.style.setProperty("width","100%"),z.style.setProperty("border-collapse","collapse"),_e.style.setProperty("background","var(--surface-color)"),Pe.style.setProperty("padding","1rem"),Pe.style.setProperty("text-align","left"),Pe.style.setProperty("border-bottom","1px solid var(--border-color)"),s(Pe,()=>e("inventory.no","No")),he.style.setProperty("padding","1rem"),he.style.setProperty("text-align","left"),he.style.setProperty("border-bottom","1px solid var(--border-color)"),s(he,()=>e("inventory.product","Product")),be.style.setProperty("padding","1rem"),be.style.setProperty("text-align","center"),be.style.setProperty("border-bottom","1px solid var(--border-color)"),s(be,()=>e("inventory.systemQty","System Qty")),ce.style.setProperty("padding","1rem"),ce.style.setProperty("text-align","center"),ce.style.setProperty("border-bottom","1px solid var(--border-color)"),s(ce,()=>e("inventory.physicalCount","Physical Count")),Se.style.setProperty("padding","1rem"),Se.style.setProperty("text-align","center"),Se.style.setProperty("border-bottom","1px solid var(--border-color)"),s(Se,()=>e("inventory.variance","Variance")),Ee.style.setProperty("padding","1rem"),Ee.style.setProperty("text-align","left"),Ee.style.setProperty("border-bottom","1px solid var(--border-color)"),s(Ee,()=>e("common.notes","Notes")),s($e,_(at,{get each(){return V()},children:(ke,Me)=>_(Vx,{get index(){return Me()},updatePhysicalCount:g,entry:ke,updateNotes:p})})),le(ke=>(ke=C().isComplete?"#4caf50":"#ff9800")!=null?R.style.setProperty("color",ke):R.style.removeProperty("color")),de}}),null),s(T,_(De,{get when(){return x()==="review"},get children(){var de=Rx(),$=de.firstChild,q=$.firstChild;q.firstChild;var Z=q.nextSibling,L=$.nextSibling,te=L.firstChild,j=te.firstChild,M=j.nextSibling,ie=te.nextSibling,oe=ie.firstChild,fe=oe.nextSibling,ue=ie.nextSibling,K=ue.firstChild,R=K.nextSibling,ee=L.nextSibling;return $.style.setProperty("text-align","center"),$.style.setProperty("margin-bottom","2rem"),q.style.setProperty("margin-bottom","1rem"),s(q,()=>e("inventory.reviewAndConfirm","Review and Confirm Adjustments"),null),Z.style.setProperty("color","var(--text-muted)"),s(Z,()=>e("inventory.reviewDescription","Review the inventory adjustments below and confirm to update your system.")),L.style.setProperty("display","grid"),L.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),L.style.setProperty("gap","1rem"),L.style.setProperty("margin-bottom","2rem"),L.style.setProperty("padding","1rem"),L.style.setProperty("background","var(--surface-color)"),L.style.setProperty("border-radius","var(--border-radius)"),te.style.setProperty("text-align","center"),j.style.setProperty("font-size","1.5rem"),j.style.setProperty("font-weight","700"),j.style.setProperty("color","#4caf50"),s(j,()=>C().positiveVariances),M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","var(--text-muted)"),s(M,()=>e("inventory.stockIncreases","Stock Increases")),ie.style.setProperty("text-align","center"),oe.style.setProperty("font-size","1.5rem"),oe.style.setProperty("font-weight","700"),oe.style.setProperty("color","#f44336"),s(oe,()=>C().negativeVariances),fe.style.setProperty("font-size","0.875rem"),fe.style.setProperty("color","var(--text-muted)"),s(fe,()=>e("inventory.stockDecreases","Stock Decreases")),ue.style.setProperty("text-align","center"),K.style.setProperty("font-size","1.5rem"),K.style.setProperty("font-weight","700"),K.style.setProperty("color","var(--primary-color)"),s(K,()=>C().variances),R.style.setProperty("font-size","0.875rem"),R.style.setProperty("color","var(--text-muted)"),s(R,()=>e("inventory.totalAdjustments","Total Adjustments")),ee.style.setProperty("display","flex"),ee.style.setProperty("gap","1rem"),ee.style.setProperty("margin-bottom","2rem"),ee.style.setProperty("justify-content","center"),ee.style.setProperty("flex-wrap","wrap"),s(ee,_(Le,{variant:"outline",onClick:()=>k("counting"),get children(){return[" ",ge(()=>e("common.back","Back to Counting"))]}}),null),s(ee,_(Le,{variant:"outline",onClick:A,get disabled(){return C().variances===0},get children(){return[" ",ge(()=>e("inventory.downloadCSV","Download CSV"))]}}),null),s(ee,_(Le,{variant:"primary",onClick:m,get disabled(){return a()||C().variances===0},get children(){return ge(()=>!!a())()?" "+e("common.saving","Saving")+"...":" "+e("inventory.confirmAdjustments","Confirm Adjustments")}}),null),s(de,_(De,{get when(){return C().variances>0},get children(){var X=Tx(),ye=X.firstChild,pe=ye.firstChild,z=pe.firstChild,se=z.firstChild,_e=se.nextSibling,Pe=_e.nextSibling,he=Pe.nextSibling,be=he.nextSibling,ce=pe.nextSibling;return X.style.setProperty("border","1px solid var(--border-color)"),X.style.setProperty("border-radius","var(--border-radius)"),X.style.setProperty("overflow-x","auto"),ye.style.setProperty("width","100%"),ye.style.setProperty("border-collapse","collapse"),z.style.setProperty("background","var(--surface-color)"),se.style.setProperty("padding","1rem"),se.style.setProperty("text-align","left"),se.style.setProperty("border-bottom","1px solid var(--border-color)"),s(se,()=>e("inventory.product","Product")),_e.style.setProperty("padding","1rem"),_e.style.setProperty("text-align","center"),_e.style.setProperty("border-bottom","1px solid var(--border-color)"),s(_e,()=>e("inventory.systemQty","System Qty")),Pe.style.setProperty("padding","1rem"),Pe.style.setProperty("text-align","center"),Pe.style.setProperty("border-bottom","1px solid var(--border-color)"),s(Pe,()=>e("inventory.physicalCount","Physical Count")),he.style.setProperty("padding","1rem"),he.style.setProperty("text-align","center"),he.style.setProperty("border-bottom","1px solid var(--border-color)"),s(he,()=>e("inventory.adjustment","Adjustment")),be.style.setProperty("padding","1rem"),be.style.setProperty("text-align","left"),be.style.setProperty("border-bottom","1px solid var(--border-color)"),s(be,()=>e("common.notes","Notes")),s(ce,_(at,{get each(){return V().filter(Se=>Se.variance!==0)},children:Se=>(()=>{var Ee=Lx(),$e=Ee.firstChild,ke=$e.firstChild,Me=ke.nextSibling,Ke=Me.firstChild,je=$e.nextSibling,Ce=je.firstChild,Fe=je.nextSibling,Qe=Fe.firstChild,We=Fe.nextSibling,Je=We.firstChild,xe=We.nextSibling,ot=xe.firstChild;return Ee.style.setProperty("border-bottom","1px solid var(--border-color)"),$e.style.setProperty("padding","1rem"),ke.style.setProperty("font-weight","500"),s(ke,()=>Se.product.name),Me.style.setProperty("font-size","0.875rem"),Me.style.setProperty("color","var(--text-muted)"),s(Me,()=>Se.product.sku,Ke),s(Me,()=>Se.product.category,null),je.style.setProperty("padding","1rem"),je.style.setProperty("text-align","center"),Ce.style.setProperty("font-weight","600"),s(Ce,()=>Se.systemQuantity),Fe.style.setProperty("padding","1rem"),Fe.style.setProperty("text-align","center"),Qe.style.setProperty("font-weight","600"),s(Qe,()=>Se.physicalCount),We.style.setProperty("padding","1rem"),We.style.setProperty("text-align","center"),Je.style.setProperty("font-weight","700"),s(Je,()=>Se.variance>0?"+":"",null),s(Je,()=>Se.variance,null),xe.style.setProperty("padding","1rem"),ot.style.setProperty("font-size","0.875rem"),s(ot,()=>Se.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")),le(et=>{var Ct=Se.variance>0?"#d4edda":"#f8d7da",mt=Se.variance>0?"#4caf50":"#f44336";return Ct!==et.e&&((et.e=Ct)!=null?Ee.style.setProperty("background",Ct):Ee.style.removeProperty("background")),mt!==et.t&&((et.t=mt)!=null?Je.style.setProperty("color",mt):Je.style.removeProperty("color")),et},{e:void 0,t:void 0}),Ee})()})),X}}),null),s(de,_(De,{get when(){return C().variances===0},get children(){var X=kx(),ye=X.firstChild,pe=ye.nextSibling,z=pe.nextSibling;return X.style.setProperty("text-align","center"),X.style.setProperty("padding","3rem"),X.style.setProperty("background","var(--surface-color)"),X.style.setProperty("border-radius","var(--border-radius)"),ye.style.setProperty("font-size","3rem"),ye.style.setProperty("margin-bottom","1rem"),pe.style.setProperty("margin-bottom","0.5rem"),s(pe,()=>e("inventory.perfectCount","Perfect Count!")),z.style.setProperty("color","var(--text-muted)"),s(z,()=>e("inventory.noVariances","No variances found. Your physical count matches the system exactly.")),X}}),null),de}}),null),D}})},Vx=t=>{const{t:e}=ct(),[r,n]=ve(""),[o,i]=ve("");let{entry:a,updatePhysicalCount:c,updateNotes:d,index:h}=t;Hr(()=>{i(a?.notes),n(a?.physicalCount)});const y=()=>{let v=document.getElementById(`physicalCountInput_${h+2}`);if(console.log(yl(r()),!v),yl(r())&&!v){c(a?.productId,r()===""?null:parseFloat(r()));return}if(yl(r())&&v){v.focus(),c(a?.productId,r()===""?null:parseFloat(r()));return}};return(()=>{var v=Mx(),w=v.firstChild,E=w.firstChild,V=w.nextSibling,N=V.firstChild,x=N.nextSibling,k=x.firstChild,re=k.nextSibling;re.nextSibling;var ae=V.nextSibling,F=ae.firstChild,Y=ae.nextSibling,U=Y.firstChild,b=Y.nextSibling,g=b.firstChild,p=b.nextSibling,C=p.firstChild;return v.style.setProperty("border-bottom","1px solid var(--border-color)"),w.style.setProperty("padding","1rem"),w.style.setProperty("text-align","center"),E.style.setProperty("font-weight","600"),s(E,h+1),V.style.setProperty("padding","1rem"),N.style.setProperty("font-weight","500"),s(N,()=>a?.product.name),x.style.setProperty("font-size","0.875rem"),x.style.setProperty("color","var(--text-muted)"),s(x,()=>a?.product.sku,k),s(x,()=>a?.product.category,re),s(x,()=>a?.product.unitOfMeasure,null),ae.style.setProperty("padding","1rem"),ae.style.setProperty("text-align","center"),F.style.setProperty("font-weight","600"),s(F,()=>a?.systemQuantity),Y.style.setProperty("padding","1rem"),Y.style.setProperty("text-align","center"),U.addEventListener("blur",()=>{y()}),U.$$keydown=S=>{S.keyCode===13&&y(),S.keyCode===27&&y(),S.keyCode},U.$$input=S=>{const A=S.target.value;n(A)},lt(U,"id",`physicalCountInput_${h+1}`),lt(U,"tabindex",h),U.style.setProperty("width","100px"),U.style.setProperty("padding","0.5rem"),U.style.setProperty("border","1px solid var(--border-color)"),U.style.setProperty("border-radius","var(--border-radius-sm)"),U.style.setProperty("text-align","center"),b.style.setProperty("padding","1rem"),b.style.setProperty("text-align","center"),g.style.setProperty("font-weight","600"),s(g,()=>a?.variance>0?"+":"",null),s(g,()=>a?.variance||"",null),p.style.setProperty("padding","1rem"),C.addEventListener("blur",S=>{d(a?.productId,o())}),C.$$keydown=S=>{S.keyCode===13&&d(a?.productId,o()),S.keyCode===27&&d(a?.productId,o()),S.keyCode===9&&d(a?.productId,o())},C.$$input=S=>{const A=S.target.value;i(A)},C.style.setProperty("width","200px"),C.style.setProperty("padding","0.5rem"),C.style.setProperty("border","1px solid var(--border-color)"),C.style.setProperty("border-radius","var(--border-radius-sm)"),le(S=>{var A=a?.physicalCount!==null?a?.variance!==0?"#fff3cd":"#d4edda":"transparent",m=a?.variance>0?"#4caf50":a?.variance<0?"#f44336":"var(--text-muted)",ne=e("inventory.addNotes","Add notes...");return A!==S.e&&((S.e=A)!=null?v.style.setProperty("background",A):v.style.removeProperty("background")),m!==S.t&&((S.t=m)!=null?g.style.setProperty("color",m):g.style.removeProperty("color")),ne!==S.a&&lt(C,"placeholder",S.a=ne),S},{e:void 0,t:void 0,a:void 0}),le(()=>U.value=r()||""),le(()=>C.value=o()||""),v})()};Pt(["click","input","keydown"]);function Fx(t,e=300,r=!1){let n,o;const i=()=>{n!==void 0&&(clearTimeout(n),n=void 0),o=void 0},a=()=>{n!==void 0&&o!==void 0&&(clearTimeout(n),n=void 0,t(...o),o=void 0)},c=(...d)=>{o=d,n!==void 0&&clearTimeout(n),r&&n===void 0&&t(...d),n=window.setTimeout(()=>{r||t(...d),n=void 0,o=void 0},e)};return mi(()=>{i()}),{debounced:c,cancel:i,flush:a}}function Bx(t,e=300){const[r,n]=ve(!1);let o;const i=async h=>{if(o&&o.abort(),!h.trim()){n(!1);return}o=new AbortController,n(!0);try{await t(h)}catch(y){y instanceof Error&&y.name!=="AbortError"&&console.error("Search error:",y)}finally{o.signal.aborted||n(!1)}},{debounced:a,cancel:c}=Fx(i,e,!1),d=()=>{c(),o&&o.abort(),n(!1)};return mi(()=>{d()}),{search:a,isSearching:r,cancel:d}}var im=G("<div>"),Ux=G("<div><h3></h3><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),jx=G("<div><h3></h3><div><div><div><span></span><span></span></div><div><span></span><span></span></div></div><div><div><span></span><span></span></div><div><span></span><span>%"),zx=G("<div><h4>"),qx=G("<div><h3></h3><div><div><div><span></span><span> </span></div><div><span></span><span> </span></div></div><div><div><span></span><span> </span></div><div><span></span><span>"),Gx=G("<div><h3></h3><div><span></span><span></span></div><div><span></span><span>"),sm=G("<div><h3>"),Hx=G("<div><div><div><h2></h2><div>SKU: <!>  </div></div><div></div></div><div><button></button><button></button><button></button></div><div>"),Wx=G("<span> "),Yx=G("<span> "),Kx=G("<div><div><span><span>  </span></span><span> </span></div><div>: <!>  <!>: "),Qx=G("<div> "),Jx=G("<div>Ref: "),Xx=G("<div><div><div><span></span><span></span><span></span></div><div><span></span></div></div><div><div> </div><div>"),Zx=G("<div><h4></h4><div></div><div>"),eI=G("<div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div> <!>  </div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div>Min: <!>  Max: ");const tI=t=>{const{t:e}=ct(),[r,n]=ve("details"),o=qe(()=>{if(!t.product)return null;const p=Ne.getTotalStockByProduct(t.product.id),C=Ne.getStockByProduct(t.product.id),S=p<=t.product.minStockLevel,A=p===0,m=p>=t.product.maxStockLevel;return{total:p,byLocation:C,status:A?"out":S?"low":m?"over":"good",statusText:A?e("products.outOfStock","Out of Stock"):S?e("products.lowStock","Low Stock"):m?e("products.overStock","Over Stock"):e("products.inStock","In Stock")}}),i=p=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(p),a=p=>new Date(p).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),c=qe(()=>!t.product||t.product.unitCost===0?0:((t.product.sellingPrice-t.product.unitCost)/t.product.unitCost*100).toFixed(2)),d=qe(()=>t.product?Ne.movements.filter(p=>p.productId===t.product.id).sort((p,C)=>new Date(C.createdDate).getTime()-new Date(p.createdDate).getTime()):[]),h=qe(()=>{if(!t.product)return null;const p=d(),C=o(),S=new Date;S.setDate(S.getDate()-30);const A=p.filter(ne=>new Date(ne.createdDate)>=S),m=p.reduce((ne,W)=>{const I=W.productId===t.product.id?W:null;return ne+(I?I.quantity*I.unitCost:0)},0);return{recentMovements:p.length,movements30Days:A.length,totalValue:(C?.total||0)*t.product.unitCost,averageMovementValue:p.length>0?m/p.length:0,lastMovementDate:p.length>0?p[0].createdDate:null}}),y={"margin-bottom":"2rem"},v={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},w={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},E={"font-weight":"400",color:"var(--text-primary)","font-size":"1rem"},V=p=>({in:"",out:"",transfer:"",adjustment:""})[p]||"";function N(p){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[p]||{bg:"#f5f5f5",color:"#666"}}const x=p=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:N(p).bg,color:N(p).color}),k=p=>{const C={good:{background:"#d4edda",color:"#155724"},low:{background:"#fff3cd",color:"#856404"},out:{background:"#f8d7da",color:"#721c24"},over:{background:"#cce5ff",color:"#004085"}};return{display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500",...C[p]||C.good}},re={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"},ae={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1rem","margin-bottom":"0.75rem"},F={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1.5rem","padding-bottom":"1rem","border-bottom":"2px solid var(--border-color)"},Y={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},U=p=>({padding:"0.75rem 1.5rem",background:"none",border:"none","border-bottom":p?"2px solid var(--primary-color)":"2px solid transparent",color:p?"var(--primary-color)":"var(--text-muted)","font-weight":p?"600":"400",cursor:"pointer",transition:"all 0.2s","font-size":"0.875rem"}),b={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-bottom":"0.5rem"},g={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1.5rem","margin-bottom":"1rem"};return _(_r,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("products.productDetails","Product Details")},size:"large",get children(){return _(De,{get when(){return t.product},get fallback(){return(()=>{var p=im();return p.style.setProperty("text-align","center"),p.style.setProperty("padding","2rem"),p.style.setProperty("color","var(--text-muted)"),s(p,()=>e("products.noProductSelected","No product selected")),p})()},children:p=>(()=>{var C=Hx(),S=C.firstChild,A=S.firstChild,m=A.firstChild,ne=m.nextSibling,W=ne.firstChild,I=W.nextSibling;I.nextSibling;var O=A.nextSibling,J=S.nextSibling,D=J.firstChild,T=D.nextSibling,B=T.nextSibling,me=J.nextSibling;return s(C,()=>JSON.stringify(p),S),u(S,F),m.style.setProperty("margin","0"),m.style.setProperty("font-size","1.5rem"),m.style.setProperty("margin-bottom","0.25rem"),s(m,()=>p().name),ne.style.setProperty("color","var(--text-muted)"),s(ne,()=>p().sku,I),s(ne,()=>p().category,null),s(O,()=>o()?.statusText),u(J,Y),D.$$click=()=>n("details"),s(D,()=>e("products.details","Details")),T.$$click=()=>n("movements"),s(T,()=>e("products.movements","Movements")),B.$$click=()=>n("analytics"),s(B,()=>e("products.analytics","Analytics")),s(C,_(De,{get when(){return r()==="details"},get children(){return[(()=>{var H=Ux(),de=H.firstChild,$=de.nextSibling,q=$.firstChild,Z=q.nextSibling,L=$.nextSibling,te=L.firstChild,j=te.nextSibling,M=L.nextSibling,ie=M.firstChild,oe=ie.nextSibling;return de.style.setProperty("margin-bottom","1rem"),de.style.setProperty("font-size","1.1rem"),s(de,()=>e("products.basicInformation","Basic Information")),s(q,()=>e("products.description","Description")),s(Z,()=>p().description||e("common.notAvailable","N/A")),s(te,()=>e("products.unitOfMeasure","Unit of Measure")),s(j,()=>p().unitOfMeasure),s(ie,()=>e("products.status","Status")),s(oe,(()=>{var fe=ge(()=>!!p().isActive);return()=>fe()?(()=>{var ue=Wx();return ue.firstChild,ue.style.setProperty("color","#2e7d32"),s(ue,()=>e("common.active","Active"),null),ue})():(()=>{var ue=Yx();return ue.firstChild,ue.style.setProperty("color","#d32f2f"),s(ue,()=>e("common.inactive","Inactive"),null),ue})()})()),le(fe=>{var ue=y,K=v,R=w,ee=E,X=v,ye=w,pe=E,z=v,se=w,_e=E;return fe.e=u(H,ue,fe.e),fe.t=u($,K,fe.t),fe.a=u(q,R,fe.a),fe.o=u(Z,ee,fe.o),fe.i=u(L,X,fe.i),fe.n=u(te,ye,fe.n),fe.s=u(j,pe,fe.s),fe.h=u(M,z,fe.h),fe.r=u(ie,se,fe.r),fe.d=u(oe,_e,fe.d),fe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),H})(),(()=>{var H=jx(),de=H.firstChild,$=de.nextSibling,q=$.firstChild,Z=q.firstChild,L=Z.firstChild,te=L.nextSibling,j=Z.nextSibling,M=j.firstChild,ie=M.nextSibling,oe=q.nextSibling,fe=oe.firstChild,ue=fe.firstChild,K=ue.nextSibling,R=fe.nextSibling,ee=R.firstChild,X=ee.nextSibling,ye=X.firstChild;return de.style.setProperty("margin-bottom","1rem"),de.style.setProperty("font-size","1.1rem"),s(de,()=>e("products.pricingInformation","Pricing Information")),s(L,()=>e("products.unitCost","Unit Cost")),s(te,()=>i(p().unitCost)),s(M,()=>e("products.sellingPrice","Selling Price")),s(ie,()=>i(p().sellingPrice)),s(ue,()=>e("products.profit","Profit")),s(K,()=>i(p().sellingPrice-p().unitCost)),s(ee,()=>e("products.profitMargin","Profit Margin")),s(X,c,ye),le(pe=>{var z=y,se=re,_e=v,Pe=w,he=E,be=v,ce=w,Se=E,Ee=v,$e=w,ke=E,Me=v,Ke=w,je=E;return pe.e=u(H,z,pe.e),pe.t=u($,se,pe.t),pe.a=u(Z,_e,pe.a),pe.o=u(L,Pe,pe.o),pe.i=u(te,he,pe.i),pe.n=u(j,be,pe.n),pe.s=u(M,ce,pe.s),pe.h=u(ie,Se,pe.h),pe.r=u(fe,Ee,pe.r),pe.d=u(ue,$e,pe.d),pe.l=u(K,ke,pe.l),pe.u=u(R,Me,pe.u),pe.c=u(ee,Ke,pe.c),pe.w=u(X,je,pe.w),pe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),H})(),(()=>{var H=qx(),de=H.firstChild,$=de.nextSibling,q=$.firstChild,Z=q.firstChild,L=Z.firstChild,te=L.nextSibling,j=te.firstChild,M=Z.nextSibling,ie=M.firstChild,oe=ie.nextSibling,fe=oe.firstChild,ue=q.nextSibling,K=ue.firstChild,R=K.firstChild,ee=R.nextSibling,X=ee.firstChild,ye=K.nextSibling,pe=ye.firstChild,z=pe.nextSibling;return de.style.setProperty("margin-bottom","1rem"),de.style.setProperty("font-size","1.1rem"),s(de,()=>e("products.stockInformation","Stock Information")),s(L,()=>e("products.totalStock","Total Stock")),s(te,()=>o()?.total||0,j),s(te,()=>p().unitOfMeasure,null),s(ie,()=>e("products.minStockLevel","Min Stock Level")),s(oe,()=>p().minStockLevel,fe),s(oe,()=>p().unitOfMeasure,null),s(R,()=>e("products.maxStockLevel","Max Stock Level")),s(ee,()=>p().maxStockLevel,X),s(ee,()=>p().unitOfMeasure,null),s(pe,()=>e("products.stockValue","Stock Value")),s(z,()=>i((o()?.total||0)*p().unitCost)),s(H,_(De,{get when(){return ge(()=>!!o()?.byLocation)()&&o().byLocation.length>0},get children(){var se=zx(),_e=se.firstChild;return se.style.setProperty("margin-top","1.5rem"),_e.style.setProperty("margin-bottom","1rem"),_e.style.setProperty("font-size","1rem"),s(_e,()=>e("products.stockByLocation","Stock by Location")),s(se,()=>o().byLocation.map(Pe=>(()=>{var he=Kx(),be=he.firstChild,ce=be.firstChild,Se=ce.firstChild;Se.firstChild;var Ee=ce.nextSibling,$e=Ee.firstChild,ke=be.nextSibling,Me=ke.firstChild,Ke=Me.nextSibling,je=Ke.nextSibling,Ce=je.nextSibling;return Ce.nextSibling,u(he,ae),be.style.setProperty("display","flex"),be.style.setProperty("justify-content","space-between"),be.style.setProperty("align-items","center"),ce.style.setProperty("font-weight","500"),ce.style.setProperty("color","var(--primary-color)"),s(ce,()=>Pe.locationId,Se),Se.style.setProperty("font-weight","500"),Se.style.setProperty("color","var(--text-muted)"),s(Se,()=>Pe.locationName,null),Ee.style.setProperty("font-weight","600"),s(Ee,()=>Pe.quantity,$e),s(Ee,()=>p().unitOfMeasure,null),ke.style.setProperty("margin-top","0.5rem"),ke.style.setProperty("font-size","0.875rem"),ke.style.setProperty("color","var(--text-muted)"),s(ke,()=>e("products.available","Available"),Me),s(ke,()=>Pe.availableQuantity,Ke),s(ke,()=>e("products.reserved","Reserved"),Ce),s(ke,()=>Pe.reservedQuantity,null),le(Fe=>(Fe=Pe.quantity>0?"var(--primary-color)":"var(--text-muted)")!=null?Ee.style.setProperty("color",Fe):Ee.style.removeProperty("color")),he})()),null),se}}),null),le(se=>{var _e=y,Pe=re,he=v,be=w,ce=E,Se=v,Ee=w,$e=E,ke=v,Me=w,Ke=E,je=v,Ce=w,Fe=E;return se.e=u(H,_e,se.e),se.t=u($,Pe,se.t),se.a=u(Z,he,se.a),se.o=u(L,be,se.o),se.i=u(te,ce,se.i),se.n=u(M,Se,se.n),se.s=u(ie,Ee,se.s),se.h=u(oe,$e,se.h),se.r=u(K,ke,se.r),se.d=u(R,Me,se.d),se.l=u(ee,Ke,se.l),se.u=u(ye,je,se.u),se.c=u(pe,Ce,se.c),se.w=u(z,Fe,se.w),se},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),H})(),(()=>{var H=Gx(),de=H.firstChild,$=de.nextSibling,q=$.firstChild,Z=q.nextSibling,L=$.nextSibling,te=L.firstChild,j=te.nextSibling;return de.style.setProperty("margin-bottom","1rem"),de.style.setProperty("font-size","1.1rem"),s(de,()=>e("products.timestamps","Timestamps")),s(q,()=>e("common.createdDate","Created Date")),s(Z,()=>a(p().createdDate)),s(te,()=>e("common.lastModified","Last Modified")),s(j,()=>a(p().lastModified)),le(M=>{var ie=y,oe=v,fe=w,ue=E,K=v,R=w,ee=E;return M.e=u(H,ie,M.e),M.t=u($,oe,M.t),M.a=u(q,fe,M.a),M.o=u(Z,ue,M.o),M.i=u(L,K,M.i),M.n=u(te,R,M.n),M.s=u(j,ee,M.s),M},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),H})()]}}),me),s(C,_(De,{get when(){return r()==="movements"},get children(){var H=sm(),de=H.firstChild;return de.style.setProperty("margin-bottom","1rem"),de.style.setProperty("font-size","1.1rem"),s(de,()=>e("products.recentMovements","Recent Movements")),s(H,_(De,{get when(){return d().length>0},get fallback(){return(()=>{var $=Qx();return $.firstChild,$.style.setProperty("text-align","center"),$.style.setProperty("padding","2rem"),$.style.setProperty("color","var(--text-muted)"),$.style.setProperty("background","var(--surface-color)"),$.style.setProperty("border-radius","var(--border-radius-sm)"),$.style.setProperty("border","1px solid var(--border-color)"),s($,()=>e("products.noMovements","No movements found for this product"),null),$})()},get children(){return _(at,{get each(){return d()},children:$=>{const q=$.productId===p().id?$:null;if(!q)return null;let Z=Ne.getLocationById($.locationId);return(()=>{var L=Xx(),te=L.firstChild,j=te.firstChild,M=j.firstChild,ie=M.nextSibling,oe=ie.nextSibling,fe=j.nextSibling,ue=fe.firstChild,K=te.nextSibling,R=K.firstChild,ee=R.firstChild,X=R.nextSibling;return u(L,b),j.style.setProperty("font-weight","600"),j.style.setProperty("margin-bottom","0.25rem"),M.style.setProperty("font-size","1.2rem"),s(M,()=>V($.movementType)),ie.style.setProperty("padding","0 6px"),s(oe,()=>$.movementType),fe.style.setProperty("font-size","0.875rem"),fe.style.setProperty("color","var(--text-muted)"),s(fe,()=>` ${a($?.createdDate)}  `,ue),ue.style.setProperty("font-size","0.875rem"),ue.style.setProperty("font-weight","600"),ue.style.setProperty("color","var(--primary-color)"),s(ue,()=>$?.locationId),s(fe,()=>`  ${Z?.name}`,null),s(te,_(De,{get when(){return $.referenceNumber},get children(){var ye=Jx();return ye.firstChild,ye.style.setProperty("font-size","0.75rem"),ye.style.setProperty("color","var(--text-muted)"),ye.style.setProperty("margin-top","0.25rem"),s(ye,()=>$?.referenceNumber,null),ye}}),null),K.style.setProperty("text-align","right"),R.style.setProperty("font-weight","600"),R.style.setProperty("font-size","1rem"),s(R,()=>$?.movementType==="in"?"+":"",ee),s(R,()=>q.quantity,ee),s(R,()=>p().unitOfMeasure,null),X.style.setProperty("font-size","0.875rem"),X.style.setProperty("color","var(--text-muted)"),s(X,()=>i(q.unitCost)),le(ye=>{var pe=x($.movementType),z=$?.movementType==="in"?"#2e7d32":"#d32f2f";return ye.e=u(oe,pe,ye.e),z!==ye.t&&((ye.t=z)!=null?R.style.setProperty("color",z):R.style.removeProperty("color")),ye},{e:void 0,t:void 0}),L})()}})}}),null),le($=>u(H,y,$)),H}}),me),s(C,_(De,{get when(){return r()==="analytics"},get children(){var H=sm(),de=H.firstChild;return de.style.setProperty("margin-bottom","1rem"),de.style.setProperty("font-size","1.1rem"),s(de,()=>e("products.analytics","Analytics")),s(H,_(De,{get when(){return h()},get fallback(){return(()=>{var $=im();return $.style.setProperty("text-align","center"),$.style.setProperty("padding","2rem"),$.style.setProperty("color","var(--text-muted)"),s($,()=>e("products.noAnalytics","No analytics data available")),$})()},children:$=>(()=>{var q=eI(),Z=q.firstChild,L=Z.firstChild,te=L.nextSibling,j=te.nextSibling,M=Z.nextSibling,ie=M.firstChild,oe=ie.nextSibling,fe=oe.nextSibling,ue=M.nextSibling,K=ue.firstChild,R=K.nextSibling,ee=R.nextSibling,X=ee.firstChild,ye=X.nextSibling;ye.nextSibling;var pe=ue.nextSibling,z=pe.firstChild,se=z.nextSibling,_e=se.nextSibling,Pe=pe.nextSibling,he=Pe.firstChild,be=he.nextSibling,ce=be.nextSibling,Se=ce.firstChild,Ee=Se.nextSibling;return Ee.nextSibling,L.style.setProperty("margin","0 0 0.5rem 0"),L.style.setProperty("color","var(--primary-color)"),s(L,()=>e("products.totalMovements","Total Movements")),te.style.setProperty("font-size","1.5rem"),te.style.setProperty("font-weight","600"),s(te,()=>$().recentMovements),j.style.setProperty("font-size","0.875rem"),j.style.setProperty("color","var(--text-muted)"),j.style.setProperty("margin-top","0.25rem"),s(j,()=>e("products.allTime","All time")),ie.style.setProperty("margin","0 0 0.5rem 0"),ie.style.setProperty("color","var(--primary-color)"),s(ie,()=>e("products.last30Days","Last 30 Days")),oe.style.setProperty("font-size","1.5rem"),oe.style.setProperty("font-weight","600"),s(oe,()=>$().movements30Days),fe.style.setProperty("font-size","0.875rem"),fe.style.setProperty("color","var(--text-muted)"),fe.style.setProperty("margin-top","0.25rem"),s(fe,()=>e("products.movements","movements")),K.style.setProperty("margin","0 0 0.5rem 0"),K.style.setProperty("color","var(--primary-color)"),s(K,()=>e("products.currentValue","Current Stock Value")),R.style.setProperty("font-size","1.5rem"),R.style.setProperty("font-weight","600"),s(R,()=>i($().totalValue)),ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-muted)"),ee.style.setProperty("margin-top","0.25rem"),s(ee,()=>o()?.total||0,X),s(ee,()=>p().unitOfMeasure,ye),s(ee,()=>i(p().unitCost),null),z.style.setProperty("margin","0 0 0.5rem 0"),z.style.setProperty("color","var(--primary-color)"),s(z,()=>e("products.avgMovementValue","Avg Movement Value")),se.style.setProperty("font-size","1.5rem"),se.style.setProperty("font-weight","600"),s(se,()=>i($().averageMovementValue)),_e.style.setProperty("font-size","0.875rem"),_e.style.setProperty("color","var(--text-muted)"),_e.style.setProperty("margin-top","0.25rem"),s(_e,()=>e("products.perMovement","per movement")),s(q,_(De,{get when(){return $().lastMovementDate},get children(){var $e=Zx(),ke=$e.firstChild,Me=ke.nextSibling,Ke=Me.nextSibling;return ke.style.setProperty("margin","0 0 0.5rem 0"),ke.style.setProperty("color","var(--primary-color)"),s(ke,()=>e("products.lastMovement","Last Movement")),Me.style.setProperty("font-size","1.25rem"),Me.style.setProperty("font-weight","600"),s(Me,()=>a($().lastMovementDate)),Ke.style.setProperty("font-size","0.875rem"),Ke.style.setProperty("color","var(--text-muted)"),Ke.style.setProperty("margin-top","0.25rem"),s(Ke,()=>e("products.mostRecent","Most recent activity")),le(je=>u($e,g,je)),$e}}),Pe),he.style.setProperty("margin","0 0 0.5rem 0"),he.style.setProperty("color","var(--primary-color)"),s(he,()=>e("products.stockStatus","Stock Status")),be.style.setProperty("font-size","1.25rem"),be.style.setProperty("font-weight","600"),s(be,()=>o()?.statusText),ce.style.setProperty("font-size","0.875rem"),ce.style.setProperty("color","var(--text-muted)"),ce.style.setProperty("margin-top","0.25rem"),s(ce,()=>p().minStockLevel,Ee),s(ce,()=>p().maxStockLevel,null),le($e=>{var ke=re,Me=g,Ke=g,je=g,Ce=g,Fe=g;return $e.e=u(q,ke,$e.e),$e.t=u(Z,Me,$e.t),$e.a=u(M,Ke,$e.a),$e.o=u(ue,je,$e.o),$e.i=u(pe,Ce,$e.i),$e.n=u(Pe,Fe,$e.n),$e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),q})()}),null),le($=>u(H,y,$)),H}}),me),me.style.setProperty("display","flex"),me.style.setProperty("gap","1rem"),me.style.setProperty("justify-content","flex-end"),me.style.setProperty("margin-top","2rem"),s(me,_(Le,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close","Close")}}),null),s(me,_(De,{get when(){return t.onEdit},get children(){return _(Le,{variant:"primary",get onClick(){return t.onEdit},get children(){return e("common.edit","Edit")}})}}),null),le(H=>{var de=k(o()?.status||"good"),$=U(r()==="details"),q=U(r()==="movements"),Z=U(r()==="analytics");return H.e=u(O,de,H.e),H.t=u(D,$,H.t),H.a=u(T,q,H.a),H.o=u(B,Z,H.o),H},{e:void 0,t:void 0,a:void 0,o:void 0}),C})()})}})};Pt(["click"]);var rI=G("<div>"),nI=G("<button type=button>"),oI=G("<div> "),am=G("<div>"),iI=G("<div><div><input type=text autocomplete=off>"),sI=G("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div>"),aI=G("<span> ");const lI=t=>{const{t:e}=ct(),[r,n]=ve(""),[o,i]=ve(!1),[a,c]=ve(null),[d,h]=ve([]),[y,v]=ve(!1),[w,E]=ve(-1),[V,N]=ve(null),x=t.searchDelay||300,k=t.maxResults||900,re=async $=>{if(!$.trim()||$.trim().length<3){h([]),t.onSearchResults?.([]);return}try{i(!0),c(null);try{const q=await ln.getProducts($),Z=Object.keys(q),L=j=>{let M=q;return{id:j,name:M[j].name,businessId:M[j].businessId,sku:M[j].code,UPC:M[j].UPC,numCode:M[j].codeN,category:M[j].category,unitCost:M[j].unitCost||0,unitOfMeasure:M[j].unitOfMeasure,minStockLevel:M[j].minStockLevel,maxStockLevel:M[j].maxStockLevel,isActive:M[j].isActive,description:M[j].description||"",createdDate:M[j].createdAt||new Date().toISOString(),lastModified:M[j].updatedAt||new Date().toISOString()}},te=Z.map(L);h(te),Ne.updProduct(te),t.onSearchResults?.(te)}catch(q){console.warn("API search failed, using local fallback:",q),c("API search failed, showing local results");const Z=Ne.getActiveProducts().filter(L=>L.name.toLowerCase().includes($.toLowerCase())||L.sku.toLowerCase().includes($.toLowerCase())||L.category.toLowerCase().includes($.toLowerCase())).slice(0,k);h(Z),t.onSearchResults?.(Z)}}catch(q){const Z=q instanceof Error?q.message:"Search failed";c(Z),h([]),t.onSearchResults?.([])}finally{i(!1)}},ae=$=>{const Z=$.target.value;n(Z),c(null),t.showResults!==!1&&v(!0),V()&&clearTimeout(V());const L=setTimeout(()=>{re(Z)},x);N(L)},F=$=>{n($.name),v(!1),E(-1),t.onProductSelect?.($)},Y=$=>{if(!(!y()||d().length===0))switch($.key){case"ArrowDown":$.preventDefault(),E(q=>Math.min(q+1,d().length-1));break;case"ArrowUp":$.preventDefault(),E(q=>Math.max(q-1,-1));break;case"Enter":$.preventDefault(),w()>=0&&d()[w()]&&F(d()[w()]);break;case"Escape":v(!1),E(-1);break}},U=()=>{t.showResults!==!1&&d().length>0&&v(!0)},b=()=>{setTimeout(()=>{v(!1),E(-1)},150)},g=()=>{n(""),h([]),c(null),v(!1),E(-1),t.onSearchResults?.([]),V()&&(clearTimeout(V()),N(null))},p=$=>Ne.stockLevels.filter(q=>q.productId===$).reduce((q,Z)=>q+Z.quantity,0),C=$=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format($),S={position:"relative",width:"100%",...t.style},A={position:"relative",display:"flex","align-items":"center"},m={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},ne={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},W={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},I={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},O=$=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:$?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),J={display:"flex","justify-content":"space-between","align-items":"center"},D={flex:"1"},T={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},B={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},me={"text-align":"right","font-size":"0.875rem"},H={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},de={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var $=iI(),q=$.firstChild,Z=q.firstChild;return Z.addEventListener("blur",b),Z.addEventListener("focus",U),Z.$$keydown=Y,Z.$$input=ae,s(q,_(De,{get when(){return o()},get children(){var L=rI();return le(te=>u(L,W,te)),L}}),null),s(q,_(De,{get when(){return ge(()=>!!r())()&&!o()},get children(){var L=nI();return L.addEventListener("mouseleave",te=>{te.currentTarget.style.background="none",te.currentTarget.style.color="var(--text-muted)"}),L.addEventListener("mouseenter",te=>{te.currentTarget.style.background="var(--border-color)",te.currentTarget.style.color="var(--text-primary)"}),L.$$click=g,le(te=>{var j=ne,M=e("common.clear","Clear search");return te.e=u(L,j,te.e),M!==te.t&&lt(L,"title",te.t=M),te},{e:void 0,t:void 0}),L}}),null),s($,_(De,{get when(){return y()&&t.showResults!==!1},get children(){var L=am();return s(L,_(De,{get when(){return a()},get children(){var te=oI();return te.firstChild,u(te,de),s(te,a,null),te}}),null),s(L,_(De,{get when(){return d().length>0},get fallback(){return ge(()=>!!(r()&&!o()))()&&(()=>{var te=am();return u(te,H),s(te,()=>e("inventory.noProductsFound","No products found matching your search.")),te})()},get children(){return _(at,{get each(){return d()},children:(te,j)=>{const M=p(te.id),ie=M<=te.minStockLevel;return(()=>{var oe=sI(),fe=oe.firstChild,ue=fe.firstChild,K=ue.firstChild,R=K.nextSibling,ee=R.firstChild,X=ee.firstChild,ye=ee.nextSibling,pe=ye.nextSibling,z=pe.nextSibling,se=z.nextSibling,_e=ue.nextSibling,Pe=_e.firstChild,he=Pe.firstChild,be=Pe.nextSibling;return oe.addEventListener("mouseenter",()=>E(j())),oe.$$click=()=>F(te),u(fe,J),u(ue,D),u(K,T),s(K,()=>te.name),u(R,B),s(ee,()=>e("inventory.sku","SKU"),X),s(ee,()=>te.sku,null),s(pe,()=>te.category),s(se,()=>C(te.unitCost)),u(_e,me),Pe.style.setProperty("font-weight","600"),(ie?"#f44336":"var(--text-primary)")!=null?Pe.style.setProperty("color",ie?"#f44336":"var(--text-primary)"):Pe.style.removeProperty("color"),s(Pe,M,he),s(Pe,()=>te.unitOfMeasure,null),be.style.setProperty("color","var(--text-muted)"),s(be,()=>ie?(()=>{var ce=aI();return ce.firstChild,ce.style.setProperty("color","#f44336"),s(ce,()=>e("inventory.lowStock","Low Stock"),null),ce})():e("inventory.inStock","In Stock")),le(ce=>u(oe,O(j()===w()),ce)),oe})()}})}}),null),le(te=>u(L,I,te)),L}}),null),le(L=>{var te=S,j=A,M=m,ie=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),oe=t.disabled;return L.e=u($,te,L.e),L.t=u(q,j,L.t),L.a=u(Z,M,L.a),ie!==L.o&&lt(Z,"placeholder",L.o=ie),oe!==L.i&&(Z.disabled=L.i=oe),L},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),le(()=>Z.value=r()),$})()};Pt(["input","keydown","click"]);var cI=G("<div><div><h2></h2><div><div>"),uI=G("<div><span>"),dI=G("<span> "),hI=G("<div><div><div><div><h3></h3><span></span></div><div></div><div>: </div></div><div><div></div><div>  <!>: </div><div>: "),mI=G("<div><div>:</div><div>"),yI=G("<div>: "),fI=G("<div><div><span>:</span><select><option value=10>10</option><option value=20>20</option><option value=50>50</option><option value=100>100</option></select></div><div><div><span></span><input type=number min=1><span> </span></div></div><div>");const Tp=()=>{const{t}=ct(),[e,r]=ve(""),[n,o]=ve(""),[i,a]=ve([]),[c,d]=ve(!1),[h,y]=ve(null),[v,w]=ve(!1),[E,V]=ve(!1),[N,x]=ve(!1),[k,re]=ve(null),[ae,F]=ve(!1),[Y,U]=ve([]),[b,g]=ve(!1),[p,C]=ve(1),[S,A]=ve(20);Hr(async()=>{await m()});const m=async()=>{try{d(!0),y(null);try{const $=await dd.getAll();a($.map(q=>({id:q.id||`prod-${Date.now()}-${Math.random()}`,name:q.productName||q.name||"Unknown Product",sku:q.sku||q.productCode||"",description:q.description||"",category:q.category||"General",unitOfMeasure:q.unitOfMeasure||"pcs",unitCost:parseFloat(q.unitCost||q.cost||"0"),sellingPrice:parseFloat(q.sellingPrice||q.price||"0"),minStockLevel:parseInt(q.minStockLevel||"0"),maxStockLevel:parseInt(q.maxStockLevel||"100"),isActive:q.isActive!==!1,createdDate:q.createdDate||new Date().toISOString(),lastModified:q.lastModified||new Date().toISOString(),businessId:q.businessId||"YB100423253156428"})))}catch($){console.warn("API failed, using local store:",$),a(Ne.products)}}catch($){y($ instanceof Error?$.message:"Failed to load products")}finally{d(!1)}},ne=async()=>{try{d(!0),y(null);try{const $=await ln.getProducts("prod"),q=Object.keys($),Z=te=>{let M=$[te];return{id:M.id,name:M.name,businessId:M.businessId,sku:M.code,numCode:M.codeN,category:M.category,unitCost:M.unitCost||0,unitOfMeasure:M.unitOfMeasure,minStockLevel:M.minStockLevel,maxStockLevel:M.maxStockLevel,isActive:M.isActive,description:M.description||"",createdDate:M.createdAt||new Date().toISOString(),lastModified:M.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(M.sellingPrice||M.price||"0")}},L=q.map(Z);a(L)}catch($){console.warn("API failed, using local store:",$),a(Ne.products)}}catch($){y($ instanceof Error?$.message:"Failed to load products")}finally{d(!1)}},{cancel:W}=Bx(async $=>{if(!$.trim()){await m();return}try{y(null);const q=await dd.getAll($);a(q.map(Z=>({id:Z.id||`prod-${Date.now()}-${Math.random()}`,name:Z.productName||Z.name||"Unknown Product",sku:Z.sku||Z.productCode||"",description:Z.description||"",category:Z.category||"General",unitOfMeasure:Z.unitOfMeasure||"pcs",unitCost:parseFloat(Z.unitCost||Z.cost||"0"),sellingPrice:parseFloat(Z.sellingPrice||Z.price||"0"),minStockLevel:parseInt(Z.minStockLevel||"0"),maxStockLevel:parseInt(Z.maxStockLevel||"100"),isActive:Z.isActive!==!1,createdDate:Z.createdDate||new Date().toISOString(),lastModified:Z.lastModified||new Date().toISOString(),businessId:Z.businessId||"YB100423253156428"})))}catch(q){y(q instanceof Error?q.message:"Search failed");const Z=Ne.products.filter(L=>L.name.toLowerCase().includes($.toLowerCase())||L.sku.toLowerCase().includes($.toLowerCase())||L.category.toLowerCase().includes($.toLowerCase()));a(Z)}},300);mi(()=>{W()}),qe(()=>{let $=i();return n()&&($=$.filter(q=>q.category===n())),$}),qe(()=>[...new Set(i().map(q=>q.category))].sort()),qe(()=>{const $=i().filter(L=>L.isActive),q=i().length,Z=i().filter(L=>Ne.getTotalStockByProduct(L.id)===0);return{total:q,active:$.length,outOfStock:Z.length}});const I=$=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format($),O={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},J={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},D=$=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:$?"#ffebee":"#e8f5e8",color:$?"#d32f2f":"#2d7d32"});qe(()=>{const $=Ne.products||[],q=Ne.movements||[],Z=Ne.stockLevels||[],L=Ne.getLowStockProducts(),te=$?.length||0,j=$?.filter(oe=>oe.isActive).length,M=Z.reduce((oe,fe)=>oe*1+fe.quantity*1*fe.averageCost*1,0),ie=q?.filter(oe=>{const fe=new Date(oe.createdDate),ue=new Date;return fe.getMonth()===ue.getMonth()&&fe.getFullYear()===ue.getFullYear()}).length;return{totalProducts:te,activeProducts:j,lowStockProducts:L.length,totalStockValue:M,totalMovementsThisMonth:ie,totalLocations:Ne.locations.length,activeLocations:Ne.getActiveLocations().length}});const T=qe(()=>Ne.products.map($=>{const q=Ne.getStockByProduct($.id),Z=Ne.getTotalStockByProduct($.id),L=Ne.getLastLocationByProduct($.id);return{...$,totalStock:Z,stockByLocation:q,lastLocation:L,isLowStock:Z<=$.minStockLevel}})),B=qe(()=>Y().map($=>{const q=Ne.getStockByProduct($.id),Z=Ne.getTotalStockByProduct($.id),L=Ne.getLastLocationByProduct($.id);return{...$,totalStock:Z,stockByLocation:q,lastLocation:L,isLowStock:Z<=$.minStockLevel}})),me=qe(()=>{const $=b()?B():T(),q=(p()-1)*S(),Z=q+S();return $.slice(q,Z)}),H=qe(()=>{const $=b()?B():T();return Math.ceil($.length/S())}),de=$=>{re($),V(!0)};return _(Br,{get title(){return t("products.title","Products")},get children(){return[(()=>{var $=cI(),q=$.firstChild,Z=q.firstChild,L=Z.nextSibling,te=L.firstChild;return $.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","flex-start"),$.style.setProperty("margin-bottom","1.5rem"),$.style.setProperty("flex-wrap","wrap"),$.style.setProperty("gap","1rem"),q.style.setProperty("flex","1"),q.style.setProperty("min-width","300px"),Z.style.setProperty("margin","0 0 1rem 0"),Z.style.setProperty("font-size","1.5rem"),s(Z,()=>t("inventory.products")),L.style.setProperty("display","flex"),L.style.setProperty("gap","1rem"),L.style.setProperty("align-items","center"),L.style.setProperty("flex-wrap","wrap"),te.style.setProperty("flex","1"),te.style.setProperty("min-width","250px"),s(te,_(lI,{onSearchResults:j=>{U(j),g(j.length>0)},get placeholder(){return t("inventory.searchProductsStock","Search products and check stock levels...")},showResults:!1,maxResults:20})),s(L,_(Le,{variant:"outline",onClick:()=>{ne(),g(!1)},get children(){return[" ",ge(()=>t("common.showAll","Show All"))]}}),null),s($,_(De,{get when(){return St.hasPermission("read_write")},get children(){return _(Le,{variant:"primary",onClick:()=>F(!0),get children(){return[" ",ge(()=>t("inventory.addProduct"))]}})}}),null),$})(),(()=>{var $=uI(),q=$.firstChild;return $.style.setProperty("margin-bottom","1rem"),$.style.setProperty("font-size","0.875rem"),$.style.setProperty("color","var(--text-muted)"),$.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),s(q,(()=>{var Z=ge(()=>!!b());return()=>Z()?`${t("inventory.searchResults","Search Results")}: ${B().length} ${t("common.products","products")}`:`${t("inventory.totalProducts","Total Products")}: ${T().length} ${t("common.products","products")}`})()),s($,(()=>{var Z=ge(()=>!!b());return()=>Z()&&(()=>{var L=dI();return L.firstChild,L.style.setProperty("color","var(--primary-color)"),s(L,()=>t("inventory.filtered","Filtered view"),null),L})()})(),null),$})(),_(at,{get each(){return me()},children:$=>(()=>{var q=hI(),Z=q.firstChild,L=Z.firstChild,te=L.firstChild,j=te.firstChild,M=j.nextSibling,ie=te.nextSibling,oe=ie.nextSibling,fe=oe.firstChild,ue=L.nextSibling,K=ue.firstChild,R=K.nextSibling,ee=R.firstChild,X=ee.nextSibling;X.nextSibling;var ye=R.nextSibling,pe=ye.firstChild;return q.$$click=()=>de($),q.addEventListener("mouseleave",z=>{z.currentTarget.style.transform="translateY(0)",z.currentTarget.style.boxShadow="none"}),q.addEventListener("mouseenter",z=>{z.currentTarget.style.transform="translateY(-2px)",z.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),u(q,O),u(Z,J),te.style.setProperty("display","flex"),te.style.setProperty("align-items","center"),te.style.setProperty("gap","0.5rem"),te.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("margin","0"),j.style.setProperty("font-size","1.1rem"),s(j,()=>$.name),s(M,(()=>{var z=ge(()=>!!$.isLowStock);return()=>z()?t("inventory.lowStockAlert"):t("inventory.inStock")})()),ie.style.setProperty("font-size","0.875rem"),ie.style.setProperty("color","var(--text-muted)"),s(ie,()=>$.sku,null),s(ie,()=>$.UPC?"  "+$.UPC:"",null),s(ie,()=>$.category?"  "+$.category:"",null),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),s(oe,()=>t("inventory.lastSeen"),fe),s(oe,()=>$.lastLocation?.name||t("inventory.noMovements"),null),ue.style.setProperty("text-align","right"),K.style.setProperty("font-size","1.25rem"),K.style.setProperty("font-weight","700"),K.style.setProperty("color","var(--primary-color)"),s(K,()=>$.totalStock),R.style.setProperty("font-size","0.875rem"),R.style.setProperty("color","var(--text-muted)"),s(R,()=>$.unitOfMeasure,ee),s(R,()=>t("inventory.min"),X),s(R,()=>$.minStockLevel,null),ye.style.setProperty("font-size","0.875rem"),ye.style.setProperty("color","var(--text-muted)"),s(ye,()=>t("inventory.cost"),pe),s(ye,()=>I($.unitCost),null),s(q,(()=>{var z=ge(()=>$.stockByLocation.length>0);return()=>z()&&(()=>{var se=mI(),_e=se.firstChild,Pe=_e.firstChild,he=_e.nextSibling;return se.style.setProperty("margin-top","1rem"),_e.style.setProperty("font-weight","500"),_e.style.setProperty("margin-bottom","0.5rem"),_e.style.setProperty("font-size","0.875rem"),s(_e,()=>t("inventory.stockByLocation"),Pe),he.style.setProperty("display","flex"),he.style.setProperty("flex-wrap","wrap"),he.style.setProperty("gap","0.5rem"),s(he,_(at,{get each(){return $.stockByLocation},children:be=>{const ce=Ne.getLocationById(be.locationId);return(()=>{var Se=yI(),Ee=Se.firstChild;return Se.style.setProperty("padding","0.25rem 0.5rem"),Se.style.setProperty("background","var(--background-color)"),Se.style.setProperty("border-radius","var(--border-radius-sm)"),Se.style.setProperty("font-size","0.75rem"),Se.style.setProperty("border","1px solid var(--border-color)"),s(Se,()=>ce?.name,Ee),s(Se,()=>be.quantity,null),Se})()}})),se})()})(),null),le(z=>u(M,D($.isLowStock),z)),q})()}),ge(()=>ge(()=>H()>1)()&&(()=>{var $=fI(),q=$.firstChild,Z=q.firstChild,L=Z.firstChild,te=Z.nextSibling,j=q.nextSibling,M=j.firstChild,ie=M.firstChild,oe=ie.nextSibling,fe=oe.nextSibling,ue=fe.firstChild,K=j.nextSibling;return $.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),$.style.setProperty("margin-top","2rem"),$.style.setProperty("padding","1rem"),$.style.setProperty("background","var(--surface-color)"),$.style.setProperty("border-radius","var(--border-radius)"),$.style.setProperty("border","1px solid var(--border-color)"),q.style.setProperty("display","flex"),q.style.setProperty("align-items","center"),q.style.setProperty("gap","0.5rem"),Z.style.setProperty("font-size","0.875rem"),Z.style.setProperty("color","var(--text-muted)"),s(Z,()=>t("common.showPerPage","Show per page"),L),te.addEventListener("change",R=>{A(parseInt(R.target.value)),C(1)}),te.style.setProperty("padding","0.25rem 0.5rem"),te.style.setProperty("border","1px solid var(--border-color)"),te.style.setProperty("border-radius","var(--border-radius-sm)"),te.style.setProperty("background","var(--background-color)"),te.style.setProperty("cursor","pointer"),j.style.setProperty("display","flex"),j.style.setProperty("align-items","center"),j.style.setProperty("gap","0.5rem"),s(j,_(Le,{variant:"outline",size:"sm",onClick:()=>C(1),get disabled(){return p()===1},get children(){return t("common.first","First")}}),M),s(j,_(Le,{variant:"outline",size:"sm",onClick:()=>C(R=>Math.max(1,R-1)),get disabled(){return p()===1},get children(){return t("common.previous","Previous")}}),M),M.style.setProperty("display","flex"),M.style.setProperty("align-items","center"),M.style.setProperty("gap","0.25rem"),ie.style.setProperty("font-size","0.875rem"),s(ie,()=>t("common.page","Page")),oe.addEventListener("change",R=>{const ee=parseInt(R.target.value);ee>=1&&ee<=H()&&C(ee)}),oe.style.setProperty("width","60px"),oe.style.setProperty("padding","0.25rem 0.5rem"),oe.style.setProperty("border","1px solid var(--border-color)"),oe.style.setProperty("border-radius","var(--border-radius-sm)"),oe.style.setProperty("text-align","center"),oe.style.setProperty("font-size","0.875rem"),fe.style.setProperty("font-size","0.875rem"),s(fe,()=>t("common.of","of"),ue),s(fe,H,null),s(j,_(Le,{variant:"outline",size:"sm",onClick:()=>C(R=>Math.min(H(),R+1)),get disabled(){return p()===H()},get children(){return t("common.next","Next")}}),null),s(j,_(Le,{variant:"outline",size:"sm",onClick:()=>C(H()),get disabled(){return p()===H()},get children(){return t("common.last","Last")}}),null),K.style.setProperty("font-size","0.875rem"),K.style.setProperty("color","var(--text-muted)"),s(K,()=>{const R=b()?B():T(),ee=(p()-1)*S()+1,X=Math.min(p()*S(),R.length);return t("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:ee,end:X,total:R.length})}),le(()=>lt(oe,"max",H())),le(()=>te.value=S()),le(()=>oe.value=p()),$})()),_(ku,{get isOpen(){return v()},onClose:()=>w(!1),onProductAdded:()=>{m()}}),_(tI,{get isOpen(){return E()},onClose:()=>{V(!1),re(null)},get product(){return k()},onEdit:()=>{V(!1),x(!0)}})]}})};Pt(["click"]);var pI=G("<div><div></div><div>"),gI=G("<div><div><img></div><div>X</div><div><div><h2></h2><div></div></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),vI=G("<div>"),bI=G("<div><div></div><h3></h3><p>"),_I=G("<div><div>"),SI=G("<div>"),PI=G("<div><div><img loading=lazy></div><div><div></div><div>  </div><div></div><div>",!0,!1,!1);const wI=t=>{const{t:e}=ct(),[r,n]=ve(null),[o,i]=ve([]),[a,c]=ve(!1),d=O=>{n(O),t.onProductSelect?.(O)},h=()=>{n(null),t.onProductSelect?.(null),i([]),c(!1)},y=O=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(O),v=()=>"YABABYSSolution",w=()=>"https://qvamarkets.s3.us-east-2.amazonaws.com/V2_images/7258/",E=O=>{if(O.productImageUrl)return w()+v()+"/"+O?.productImageUrl;const J={Electronics:"https://via.placeholder.com/400x300/4F46E5/FFFFFF?text=Electronics",Furniture:"https://via.placeholder.com/400x300/059669/FFFFFF?text=Furniture",Food:"https://via.placeholder.com/400x300/DC2626/FFFFFF?text=Food",Clothing:"https://via.placeholder.com/400x300/7C3AED/FFFFFF?text=Clothing",Tools:"https://via.placeholder.com/400x300/EA580C/FFFFFF?text=Tools",General:"https://via.placeholder.com/400x300/6B7280/FFFFFF?text=Product"};return J[O.category]||J.General},V={padding:"2rem"},N={"max-width":"600px",margin:"0 auto 2rem",position:"relative"},x={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},k={background:"var(--surface-color)","border-radius":"var(--border-radius)",overflow:"hidden","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.3s ease"},re={position:"relative",width:"100%",height:"200px",overflow:"hidden",background:"#f5f5f5"},ae={width:"100%",height:"100%","object-fit":"cover",transition:"transform 0.3s ease"},F={padding:"1rem"},Y={"font-size":"1rem","font-weight":"600","margin-bottom":"0.5rem",color:"var(--text-primary)",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},U={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.25rem"},b={"font-size":"1.25rem","font-weight":"700",color:"var(--primary-color)","margin-top":"0.5rem"},g={display:"flex",gap:"2rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"2rem","box-shadow":"var(--shadow-md)","margin-bottom":"2rem",position:"relative"},p={width:"400px",height:"300px","border-radius":"var(--border-radius)",overflow:"hidden",background:"#f5f5f5"},C={flex:"1",display:"flex","flex-direction":"column",gap:"1rem"},S={display:"flex","justify-content":"space-between","padding-bottom":"0.5rem","border-bottom":"1px solid var(--border-light)"},A={"font-weight":"500",color:"var(--text-muted)"},m={"font-weight":"600",color:"var(--text-primary)"},ne=O=>({display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"600",background:"#d4edda",color:"#155724"}),W={"text-align":"center",padding:"4rem 2rem",color:"var(--text-muted)"},I={"font-size":"3rem","margin-bottom":"1rem",opacity:"0.5"};return(()=>{var O=_I(),J=O.firstChild;return u(O,V),s(J,_(Tu,{onChange:D=>{console.log(D);let T=D;c(!0),d(T)},get placeholder(){return e("inventory.searchProductsImages","Search products to view images...")}})),s(O,_(De,{get when(){return r()&&t.showDetails!==!1},get children(){var D=gI(),T=D.firstChild,B=T.firstChild,me=T.nextSibling,H=me.nextSibling,de=H.firstChild,$=de.firstChild,q=$.nextSibling,Z=de.nextSibling,L=Z.firstChild,te=L.nextSibling,j=Z.nextSibling,M=j.firstChild,ie=M.nextSibling,oe=j.nextSibling,fe=oe.firstChild,ue=fe.nextSibling,K=oe.nextSibling,R=K.firstChild,ee=R.nextSibling,X=K.nextSibling,ye=X.firstChild,pe=ye.nextSibling;return u(D,g),u(T,p),B.style.setProperty("width","100%"),B.style.setProperty("height","100%"),B.style.setProperty("object-fit","contain"),B.style.setProperty("aspect-ratio","1 / 1"),me.$$click=()=>{h()},me.style.setProperty("position","absolute"),me.style.setProperty("top","0.5rem"),me.style.setProperty("right","0.5rem"),me.style.setProperty("color","#3d3d3d"),me.style.setProperty("border-radius","50%"),me.style.setProperty("width","2rem"),me.style.setProperty("height","2rem"),me.style.setProperty("display","flex"),me.style.setProperty("align-items","center"),me.style.setProperty("justify-content","center"),me.style.setProperty("font-size","1.25rem"),me.style.setProperty("box-shadow","var(--shadow-sm)"),me.style.setProperty("cursor","pointer"),u(H,C),$.style.setProperty("margin","0 0 0.5rem 0"),$.style.setProperty("font-size","1.5rem"),s($,()=>r().name),s(q,()=>e("products.inStock","In Stock")),s(L,()=>e("products.sku","SKU")),s(te,()=>r().sku),s(M,()=>e("inventory.category","Category")),s(ie,()=>r().category),s(fe,()=>e("inventory.unitOfMeasure","Unit")),s(ue,()=>r().unitOfMeasure),s(R,()=>e("inventory.unitCost","Cost")),s(ee,()=>y(r().unitCost)),s(ye,()=>e("inventory.UPC","UPC")),s(pe,()=>r().UPC),s(H,_(De,{get when(){return r().description},get children(){var z=pI(),se=z.firstChild,_e=se.nextSibling;return z.style.setProperty("margin-top","1rem"),s(se,()=>e("common.description","Description")),_e.style.setProperty("margin-top","0.5rem"),_e.style.setProperty("color","var(--text-primary)"),s(_e,()=>r().description),le(Pe=>u(se,A,Pe)),z}}),null),le(z=>{var se=E(r()),_e=r().name,Pe=ne(),he=S,be=A,ce=m,Se=S,Ee=A,$e=m,ke=S,Me=A,Ke=m,je=S,Ce=A,Fe=m,Qe=S,We=A,Je=m;return se!==z.e&&lt(B,"src",z.e=se),_e!==z.t&&lt(B,"alt",z.t=_e),z.a=u(q,Pe,z.a),z.o=u(Z,he,z.o),z.i=u(L,be,z.i),z.n=u(te,ce,z.n),z.s=u(j,Se,z.s),z.h=u(M,Ee,z.h),z.r=u(ie,$e,z.r),z.d=u(oe,ke,z.d),z.l=u(fe,Me,z.l),z.u=u(ue,Ke,z.u),z.c=u(K,je,z.c),z.w=u(R,Ce,z.w),z.m=u(ee,Fe,z.m),z.f=u(X,Qe,z.f),z.y=u(ye,We,z.y),z.g=u(pe,Je,z.g),z},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),D}}),null),s(O,_(De,{get when(){return o().length>0},get children(){var D=vI();return u(D,x),s(D,_(at,{get each(){return o()},children:T=>(()=>{var B=PI(),me=B.firstChild,H=me.firstChild,de=me.nextSibling,$=de.firstChild,q=$.nextSibling,Z=q.firstChild,L=q.nextSibling,te=L.nextSibling;return B.addEventListener("mouseleave",j=>{j.currentTarget.style.transform="translateY(0)",j.currentTarget.style.boxShadow="var(--shadow-sm)";const M=j.currentTarget.querySelector("img");M&&(M.style.transform="scale(1)")}),B.addEventListener("mouseenter",j=>{j.currentTarget.style.transform="translateY(-4px)",j.currentTarget.style.boxShadow="var(--shadow-lg)";const M=j.currentTarget.querySelector("img");M&&(M.style.transform="scale(1.05)")}),B.$$click=()=>d(T),u(B,k),s(me,_(De,{get when(){return T===r()},get children(){var j=SI();return j.style.setProperty("position","absolute"),j.style.setProperty("top","0.5rem"),j.style.setProperty("right","0.5rem"),j.style.setProperty("background","var(--primary-color)"),j.style.setProperty("color","white"),j.style.setProperty("border-radius","50%"),j.style.setProperty("width","2rem"),j.style.setProperty("height","2rem"),j.style.setProperty("display","flex"),j.style.setProperty("align-items","center"),j.style.setProperty("justify-content","center"),j.style.setProperty("font-size","1.25rem"),j}}),null),u(de,F),s($,()=>T.name),s(q,()=>T.sku,Z),s(q,()=>T.category,null),s(L,()=>T.unitOfMeasure),u(te,b),s(te,()=>y(T.sellingPrice)),le(j=>{var M=re,ie=E(T),oe=T.name,fe=ae,ue=Y,K=T.name,R=U,ee=U;return j.e=u(me,M,j.e),ie!==j.t&&lt(H,"src",j.t=ie),oe!==j.a&&lt(H,"alt",j.a=oe),j.o=u(H,fe,j.o),j.i=u($,ue,j.i),K!==j.n&&lt($,"title",j.n=K),j.s=u(q,R,j.s),j.h=u(L,ee,j.h),j},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),B})()})),D}}),null),s(O,_(De,{get when(){return!r()},get children(){var D=bI(),T=D.firstChild,B=T.nextSibling,me=B.nextSibling;return u(T,I),B.style.setProperty("margin-bottom","0.5rem"),s(B,()=>e("inventory.noProductsFound","No Products Found")),s(me,()=>e("inventory.tryDifferentSearch","Try a different search term")),le(H=>u(D,W,H)),D}}),null),le(D=>u(J,N,D)),O})()};Pt(["click"]);var CI=G("<div><h1></h1><div>"),Rr=G("<div>"),AI=G("<div><h3></h3><div>"),xI=G("<div>: <!> "),II=G("<div><button></button><button></button><button></button><button>"),EI=G("<div><div>"),$I=G("<div><span> (<!>)</span><span> / <!> "),TI=G("<div><div><h2></h2></div><div>"),kI=G("<div><div><div><span></span><h3></h3></div><div>  </div><div></div></div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div>:"),RI=G("<div><div><div><div></div><div></div></div><div><div> </div><div></div><div>Min: "),DI=G("<span> LOW");const NI=()=>{const{t}=ct(),[e,r]=ve(!1),[n,o]=ve(!1),[i,a]=ve(!1),[c,d]=ve(null),[h,y]=ve("overview"),[v,w]=ve("new"),[E,V]=ve(""),[N,x]=ve(""),[k,re]=ve([]),[ae,F]=ve(!1),[Y,U]=ve(!1),[b,g]=ve(!1),[p,C]=ve(!1),[S,A]=ve(!1),[m,ne]=ve(1),[W,I]=ve(20),O=K=>{d(K),a(!0)},J=qe(()=>{const K=Ne.products||[],R=Ne.movements||[],ee=Ne.stockLevels||[],X=Ne.getLowStockProducts(),ye=K?.length||0,pe=K?.filter(_e=>_e.isActive).length,z=ee.reduce((_e,Pe)=>_e*1+Pe.quantity*1*Pe.averageCost*1,0),se=R?.filter(_e=>{const Pe=new Date(_e.createdDate),he=new Date;return Pe.getMonth()===he.getMonth()&&Pe.getFullYear()===he.getFullYear()}).length;return{totalProducts:ye,activeProducts:pe,lowStockProducts:X.length,totalStockValue:z,totalMovementsThisMonth:se,totalLocations:Ne.locations.length,activeLocations:Ne.getActiveLocations().length}});qe(()=>Ne.products.map(K=>{const R=Ne.getStockByProduct(K.id),ee=Ne.getTotalStockByProduct(K.id),X=Ne.getLastLocationByProduct(K.id);return{...K,totalStock:ee,stockByLocation:R,lastLocation:X,isLowStock:ee<=K.minStockLevel}})),qe(()=>{Y(),ne(1)});const D=(K,R)=>K<=R?t("inventory.lowStockAlert"):K<=R*2?t("inventory.normalStock"):t("inventory.inStock"),T=K=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(K),B=K=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(K),me=K=>{switch(K){case"warehouse":return t("inventory.warehouse");case"store":return t("inventory.store");case"supplier":return t("inventory.supplier");case"customer":return t("inventory.customer");default:return K}},H={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},de={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},$=K=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500",background:K>50?"#d4edda":K>20?"#fff3cd":"#f8d7da",color:K>50?"#155724":K>20?"#856404":"#721c24"}),q={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},Z={color:"var(--text-muted)","font-size":"0.875rem"},L={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},te={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},j={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},M=K=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:K?"var(--primary-color)":"var(--text-muted)","border-bottom":K?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),ie={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem","margin-bottom":"2rem"},oe={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},fe=qe(()=>{const K=Ne.movements;return{total:K.length,stockIn:K.filter(R=>R.movementType==="in").length,stockOut:K.filter(R=>R.movementType==="out").length,transfers:K.filter(R=>R.movementType==="transfer").length,adjustments:K.filter(R=>R.movementType==="adjustment").length,totalValue:K.reduce((R,ee)=>R+ee.totalCost,0)}}),ue=async()=>{let K="prod";await Ne.fecthInventory(K),await Ne.fecthProduct(K)};return Hr(()=>{ue()}),_(Br,{get title(){return t("inventory.title")},get children(){return[(()=>{var K=CI(),R=K.firstChild,ee=R.nextSibling;return u(K,te),R.style.setProperty("margin","0"),R.style.setProperty("font-size","1.75rem"),ee.style.setProperty("display","flex"),ee.style.setProperty("align-items","center"),ee.style.setProperty("gap","1rem"),s(ee,(()=>{var X=ge(()=>v()==="new");return()=>X()&&_(Le,{variant:"outline",onClick:()=>A(!0),get children(){return[" ",ge(()=>t("inventory.physicalCount","Physical Count"))]}})})(),null),s(ee,_(De,{get when(){return St.hasPermission("read_write")},get children(){return _(Le,{variant:"primary",onClick:()=>o(!0),get children(){return ge(()=>v()==="new")()?t("inventory.addMovement"):t("common.add")}})}}),null),K})(),_(wI,{}),_(De,{get when(){return St.hasPermission("inventoryDownsection")},get children(){return ge(()=>v()==="legacy")()?[(()=>{var K=Rr();return s(K,_(He,{get title(){return t("inventory.totalItems")},get subtitle(){return t("inventory.inStock")},get children(){var R=Rr();return R.style.setProperty("font-size","1.5rem"),R.style.setProperty("font-weight","600"),R.style.setProperty("color","var(--primary-color)"),s(R,()=>Ne.inventory.length),R}}),null),s(K,_(He,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.itemsBelowThreshold")},get children(){var R=Rr();return R.style.setProperty("font-size","1.5rem"),R.style.setProperty("font-weight","600"),R.style.setProperty("color","var(--primary-color)"),s(R,()=>Ne.getLowStockItems().length),R}}),null),s(K,_(He,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.inventoryWorth")},get children(){var R=Rr();return R.style.setProperty("font-size","1.5rem"),R.style.setProperty("font-weight","600"),R.style.setProperty("color","var(--primary-color)"),s(R,()=>T(Ne.getTotalValue())),R}}),null),le(R=>u(K,L,R)),K})(),(()=>{var K=Rr();return u(K,H),s(K,_(at,{get each(){return Ne.inventory},children:R=>{const ee=D(R.quantity,R.minStock),X=R.quantity<=R.minStock?8:R.quantity<=R.minStock*2?35:75;return _(He,{onClick:()=>O(R),get children(){return[(()=>{var ye=AI(),pe=ye.firstChild,z=pe.nextSibling;return u(ye,de),pe.style.setProperty("margin","0"),pe.style.setProperty("font-size","1.1rem"),s(pe,()=>R.name),s(z,ee),le(se=>u(z,$(X),se)),ye})(),(()=>{var ye=Rr();return u(ye,q),s(ye,()=>T(R.price)),ye})(),(()=>{var ye=xI(),pe=ye.firstChild,z=pe.nextSibling;return z.nextSibling,u(ye,Z),s(ye,()=>t("inventory.quantity"),pe),s(ye,()=>R.quantity,z),s(ye,()=>t("common.units"),null),ye})()]}})}})),K})()]:[(()=>{var K=II(),R=K.firstChild,ee=R.nextSibling,X=ee.nextSibling,ye=X.nextSibling;return u(K,j),R.$$click=()=>y("overview"),s(R,()=>t("inventory.overview")),ee.$$click=()=>y("products"),s(ee,()=>t("inventory.products")),X.$$click=()=>y("movements"),s(X,()=>t("inventory.movements")),ye.$$click=()=>y("locations"),s(ye,()=>t("inventory.locations")),le(pe=>{var z=M(h()==="overview"),se=M(h()==="products"),_e=M(h()==="movements"),Pe=M(h()==="locations");return pe.e=u(R,z,pe.e),pe.t=u(ee,se,pe.t),pe.a=u(X,_e,pe.a),pe.o=u(ye,Pe,pe.o),pe},{e:void 0,t:void 0,a:void 0,o:void 0}),K})(),ge(()=>ge(()=>h()==="overview")()&&(()=>{var K=EI(),R=K.firstChild;return s(R,_(He,{get title(){return t("inventory.activeProducts")},get subtitle(){return t("inventory.currentlyManaged")},get children(){var ee=Rr();return ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","600"),ee.style.setProperty("color","var(--primary-color)"),s(ee,()=>J().activeProducts),ee}}),null),s(R,_(He,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.needAttention")},get children(){var ee=Rr();return ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","600"),ee.style.setProperty("color","#d32f2f"),s(ee,()=>J().lowStockProducts),ee}}),null),s(R,_(He,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.currentWorth")},get children(){var ee=Rr();return ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","600"),ee.style.setProperty("color","var(--primary-color)"),s(ee,()=>B(fe().totalValue)),ee}}),null),s(R,_(He,{get title(){return t("inventory.movements")},get subtitle(){return t("inventory.thisMonth")},get children(){var ee=Rr();return ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","600"),ee.style.setProperty("color","var(--primary-color)"),s(ee,()=>J().totalMovementsThisMonth),ee}}),null),s(R,_(He,{get title(){return t("inventory.activeLocations")},get subtitle(){return t("inventory.warehousesStores")},get children(){var ee=Rr();return ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","600"),ee.style.setProperty("color","var(--primary-color)"),s(ee,()=>J().activeLocations),ee}}),null),s(K,(()=>{var ee=ge(()=>J().lowStockProducts>0);return()=>ee()&&_(He,{get title(){return` ${t("inventory.lowStockAlert")}`},get subtitle(){return`${J().lowStockProducts} ${t("inventory.productsNeedRestocking")}`},style:{"margin-bottom":"2rem","border-color":"#ffcdd2",background:"#ffebee"},get children(){var X=Rr();return X.style.setProperty("margin-top","1rem"),s(X,_(at,{get each(){return Ne.getLowStockProducts().slice(0,9)},children:ye=>(()=>{var pe=$I(),z=pe.firstChild,se=z.firstChild,_e=se.nextSibling;_e.nextSibling;var Pe=z.nextSibling,he=Pe.firstChild,be=he.nextSibling;return be.nextSibling,pe.style.setProperty("display","flex"),pe.style.setProperty("justify-content","space-between"),pe.style.setProperty("margin-bottom","0.5rem"),pe.style.setProperty("font-size","0.875rem"),s(z,()=>ye.name,se),s(z,()=>ye?.sku,_e),Pe.style.setProperty("color","#d32f2f"),Pe.style.setProperty("font-weight","600"),s(Pe,()=>ye.currentStock,he),s(Pe,()=>ye.minStockLevel,be),s(Pe,()=>t("inventory.min"),null),pe})()}),null),s(X,(()=>{var ye=ge(()=>Ne.getLowStockProducts().length>5);return()=>ye()&&(()=>{var pe=Rr();return pe.style.setProperty("font-size","0.875rem"),pe.style.setProperty("color","var(--text-muted)"),pe.style.setProperty("font-style","italic"),s(pe,()=>t("common.andMore",{count:Ne.getLowStockProducts().length-9})),pe})()})(),null),X}})})(),null),le(ee=>u(R,L,ee)),K})()),ge(()=>ge(()=>h()==="products")()&&_(Tp,{})),ge(()=>ge(()=>h()==="movements")()&&_(Ax,{})),ge(()=>ge(()=>h()==="locations")()&&(()=>{var K=TI(),R=K.firstChild,ee=R.firstChild,X=R.nextSibling;return R.style.setProperty("display","flex"),R.style.setProperty("justify-content","space-between"),R.style.setProperty("align-items","center"),R.style.setProperty("margin-bottom","1.5rem"),ee.style.setProperty("margin","0"),ee.style.setProperty("font-size","1.5rem"),s(ee,()=>t("inventory.locations")),s(R,_(De,{get when(){return St.hasPermission("read_write")},get children(){return _(Le,{variant:"primary",onClick:()=>g(!0),get children(){return[" ",ge(()=>t("inventory.addLocation"))]}})}}),null),u(X,ie),s(X,_(at,{get each(){return Ne.getActiveLocations()},children:ye=>{const pe=Ne.getStockByLocation(ye.id),z=pe.length,se=pe.reduce((Pe,he)=>Pe*1+he.quantity*1,0),_e=pe.reduce((Pe,he)=>(Ne.getProductById(he.productId),Pe+(he?.averageCost||0)),0);return(()=>{var Pe=kI(),he=Pe.firstChild,be=he.firstChild,ce=be.firstChild,Se=ce.nextSibling,Ee=be.nextSibling,$e=Ee.firstChild,ke=Ee.nextSibling,Me=he.nextSibling,Ke=Me.firstChild,je=Ke.firstChild,Ce=je.firstChild,Fe=je.nextSibling,Qe=Ke.nextSibling,We=Qe.firstChild,Je=We.firstChild,xe=We.nextSibling,ot=Qe.nextSibling,et=ot.firstChild,Ct=et.firstChild,mt=et.nextSibling,Dt=Me.nextSibling,$t=Dt.firstChild,Tt=$t.firstChild;return he.style.setProperty("margin-bottom","1rem"),he.style.setProperty("padding-bottom","1rem"),he.style.setProperty("border-bottom","1px solid var(--border-color)"),be.style.setProperty("display","flex"),be.style.setProperty("align-items","center"),be.style.setProperty("gap","0.5rem"),be.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-size","1.2rem"),s(ce,()=>ye.type==="warehouse"?"":ye.type==="store"?"":ye.type==="supplier"?"":""),Se.style.setProperty("margin","0"),Se.style.setProperty("font-size","1.1rem"),s(Se,()=>ye.name),Ee.style.setProperty("font-size","0.875rem"),Ee.style.setProperty("color","var(--text-muted)"),s(Ee,()=>ye.code,$e),s(Ee,()=>me(ye.type),null),ke.style.setProperty("font-size","0.75rem"),ke.style.setProperty("color","var(--text-muted)"),ke.style.setProperty("margin-top","0.25rem"),s(ke,()=>ye.address),Me.style.setProperty("margin-bottom","1rem"),Ke.style.setProperty("display","flex"),Ke.style.setProperty("justify-content","space-between"),Ke.style.setProperty("margin-bottom","0.5rem"),je.style.setProperty("font-size","0.875rem"),je.style.setProperty("font-weight","500"),s(je,()=>t("inventory.products"),Ce),Fe.style.setProperty("font-weight","600"),s(Fe,z),Qe.style.setProperty("display","flex"),Qe.style.setProperty("justify-content","space-between"),Qe.style.setProperty("margin-bottom","0.5rem"),We.style.setProperty("font-size","0.875rem"),We.style.setProperty("font-weight","500"),s(We,()=>t("inventory.totalItems"),Je),xe.style.setProperty("font-weight","600"),xe.style.setProperty("color","var(--primary-color)"),s(xe,se),ot.style.setProperty("display","flex"),ot.style.setProperty("justify-content","space-between"),ot.style.setProperty("margin-bottom","1rem"),et.style.setProperty("font-size","0.875rem"),et.style.setProperty("font-weight","500"),s(et,()=>t("inventory.totalValue"),Ct),mt.style.setProperty("font-weight","600"),mt.style.setProperty("color","var(--primary-color)"),s(mt,()=>B(_e)),$t.style.setProperty("font-weight","600"),$t.style.setProperty("margin-bottom","0.75rem"),$t.style.setProperty("font-size","0.875rem"),$t.style.setProperty("color","var(--text-primary)"),$t.style.setProperty("border-bottom","1px solid var(--border-color)"),$t.style.setProperty("padding-bottom","0.5rem"),s($t,()=>t("inventory.productDetails"),Tt),s(Dt,(()=>{var Kt=ge(()=>pe.length===0);return()=>Kt()?(()=>{var rt=Rr();return rt.style.setProperty("text-align","center"),rt.style.setProperty("color","var(--text-muted)"),rt.style.setProperty("font-style","italic"),rt.style.setProperty("padding","1rem"),s(rt,()=>t("inventory.noProducts")),rt})():(()=>{var rt=Rr();return rt.style.setProperty("max-height","200px"),rt.style.setProperty("overflow-y","auto"),rt.style.setProperty("border","1px solid var(--border-color)"),rt.style.setProperty("border-radius","var(--border-radius-sm)"),s(rt,_(at,{each:pe,children:Xt=>{const Ie=Ne.getProductById(Xt.productId);if(!Ie)return null;const gt=Xt.quantity<=Ie.minStockLevel,Be=Xt.averageCost;return Xt.quantity?(()=>{var Oe=RI(),Ze=Oe.firstChild,nt=Ze.firstChild,bt=nt.firstChild,Xe=bt.nextSibling,yt=nt.nextSibling,ut=yt.firstChild,At=ut.firstChild,Ve=ut.nextSibling,zt=Ve.nextSibling;return zt.firstChild,Oe.style.setProperty("padding","0.75rem"),Oe.style.setProperty("border-bottom","1px solid var(--border-color)"),(gt?"#fff5f5":"transparent")!=null?Oe.style.setProperty("background",gt?"#fff5f5":"transparent"):Oe.style.removeProperty("background"),Oe.style.setProperty("transition","background-color 0.2s ease"),Ze.style.setProperty("display","flex"),Ze.style.setProperty("justify-content","space-between"),Ze.style.setProperty("align-items","flex-start"),Ze.style.setProperty("margin-bottom","0.25rem"),nt.style.setProperty("flex","1"),bt.style.setProperty("font-weight","500"),bt.style.setProperty("font-size","0.875rem"),(gt?"#d32f2f":"var(--text-primary)")!=null?bt.style.setProperty("color",gt?"#d32f2f":"var(--text-primary)"):bt.style.removeProperty("color"),s(bt,()=>Ie.name,null),s(bt,gt&&(()=>{var vt=DI();return vt.style.setProperty("margin-left","0.5rem"),vt.style.setProperty("font-size","0.7rem"),vt.style.setProperty("color","#d32f2f"),vt})(),null),Xe.style.setProperty("font-size","0.75rem"),Xe.style.setProperty("color","var(--text-muted)"),Xe.style.setProperty("margin-top","0.1rem"),s(Xe,()=>Ie.sku,null),s(Xe,()=>Ie.UPC?"  "+Ie.UPC:"",null),s(Xe,()=>Ie.category?"  "+Ie.category:"",null),yt.style.setProperty("text-align","right"),ut.style.setProperty("font-weight","600"),ut.style.setProperty("font-size","0.875rem"),(gt?"#d32f2f":"var(--primary-color)")!=null?ut.style.setProperty("color",gt?"#d32f2f":"var(--primary-color)"):ut.style.removeProperty("color"),s(ut,()=>Xt.quantity,At),s(ut,()=>Ie.unitOfMeasure,null),Ve.style.setProperty("font-size","0.75rem"),Ve.style.setProperty("color","var(--text-muted)"),s(Ve,()=>B(Be)),zt.style.setProperty("font-size","0.7rem"),zt.style.setProperty("color","var(--text-muted)"),zt.style.setProperty("margin-top","0.1rem"),s(zt,()=>Ie.minStockLevel,null),Oe})():null}})),rt})()})(),null),le(Kt=>u(Pe,{...oe,"min-height":"400px"},Kt)),Pe})()}})),K})())]}}),_(De,{get when(){return St.hasPermission("read_write")},get children(){return[_(BA,{get isOpen(){return e()},onClose:()=>r(!1),get mode(){return v()==="new"?"movement":"legacy"}}),_(WA,{get isOpen(){return n()},onClose:()=>o(!1)}),_(XA,{get isOpen(){return i()},onClose:()=>a(!1),get item(){return c()}}),_(Ru,{get isOpen(){return b()},onClose:()=>g(!1),onLocationAdded:()=>{g(!1)}})]}}),_(Ox,{get isOpen(){return S()},onClose:()=>A(!1)})]}})};Pt(["click"]);const LI=[{id:"1",name:"John Doe",position:"Software Engineer",salary:85e3,email:"john.doe@company.com",phone:"+1 (555) 123-4567",department:"Engineering",startDate:"2023-01-15"},{id:"2",name:"Jane Smith",position:"Product Manager",salary:95e3,email:"jane.smith@company.com",phone:"+1 (555) 234-5678",department:"Product",startDate:"2022-08-20"},{id:"3",name:"Mike Brown",position:"Designer",salary:7e4,email:"mike.brown@company.com",phone:"+1 (555) 345-6789",department:"Design",startDate:"2023-03-10"},{id:"4",name:"Sarah Kim",position:"HR Manager",salary:78e3,email:"sarah.kim@company.com",phone:"+1 (555) 456-7890",department:"Human Resources",startDate:"2022-11-05"},{id:"5",name:"Alex Lee",position:"Data Analyst",salary:72e3,email:"alex.lee@company.com",phone:"+1 (555) 567-8901",department:"Analytics",startDate:"2023-02-28"},{id:"6",name:"Emma Wilson",position:"Marketing Manager",salary:82e3,email:"emma.wilson@company.com",phone:"+1 (555) 678-9012",department:"Marketing",startDate:"2022-09-15"}],[Ri,Nl]=ve(LI),kp={get employees(){return Ri()},addEmployee(t){const e={...t,id:Date.now().toString()};return Nl([...Ri(),e]),e},updateEmployee(t,e){Nl(Ri().map(r=>r.id===t?{...r,...e}:r))},deleteEmployee(t){Nl(Ri().filter(e=>e.id!==t))},getEmployeeById(t){return Ri().find(e=>e.id===t)}};var MI=G("<form><div>");const OI=t=>{const{t:e}=ct(),[r,n]=ve({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),o=[{value:"Engineering",label:e("employees.departments.engineering","Engineering")},{value:"Product",label:e("employees.departments.product","Product")},{value:"Design",label:e("employees.departments.design","Design")},{value:"Marketing",label:e("employees.departments.marketing","Marketing")},{value:"Sales",label:e("employees.departments.sales","Sales")},{value:"Human Resources",label:e("employees.departments.humanResources","Human Resources")},{value:"Finance",label:e("employees.departments.finance","Finance")},{value:"Operations",label:e("employees.departments.operations","Operations")},{value:"Analytics",label:e("employees.departments.analytics","Analytics")}],i={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},a=d=>{d.preventDefault();const h=r();if(!h.name||!h.position||!h.salary||!h.email||!h.department||!h.startDate){alert(e("forms.requiredField"));return}const y={name:h.name,position:h.position,salary:parseFloat(h.salary),email:h.email,phone:h.phone,department:h.department,startDate:h.startDate};kp.addEmployee(y),n({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),t.onClose()},c=(d,h)=>{n(y=>({...y,[d]:h}))};return _(_r,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.addEmployee")},get children(){var d=MI(),h=d.firstChild;return d.addEventListener("submit",a),s(d,_(Ot,{get label(){return e("employees.fullName")},get value(){return r().name},onChange:y=>c("name",y),get placeholder(){return e("employees.enterFullName","Enter employee's full name")},required:!0}),h),s(d,_(Ot,{get label(){return e("employees.position")},get value(){return r().position},onChange:y=>c("position",y),get placeholder(){return e("employees.enterPosition","Enter job position")},required:!0}),h),s(d,_(gr,{get label(){return e("employees.department")},get value(){return r().department},onChange:y=>c("department",y),options:o,required:!0}),h),s(d,_(Ot,{get label(){return e("employees.email")},type:"email",get value(){return r().email},onChange:y=>c("email",y),get placeholder(){return e("employees.enterEmail","Enter email address")},required:!0}),h),s(d,_(Ot,{get label(){return e("employees.phone")},type:"tel",get value(){return r().phone},onChange:y=>c("phone",y),get placeholder(){return e("employees.enterPhone","Enter phone number")}}),h),s(d,_(Ot,{get label(){return e("employees.salary")},type:"number",get value(){return r().salary},onChange:y=>c("salary",y),get placeholder(){return e("employees.enterSalary","Enter annual salary")},required:!0}),h),s(d,_(Ot,{get label(){return e("employees.hireDate")},type:"date",get value(){return r().startDate},onChange:y=>c("startDate",y),required:!0}),h),u(h,i),s(h,_(Le,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(h,_(Le,{variant:"primary",type:"submit",get children(){return e("employees.addEmployee")}}),null),d}})};var VI=G("<div><div></div><div></div><div>"),FI=G("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),BI=G("<div>");const UI=t=>{const{t:e}=ct(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},o={"font-weight":"600",color:"var(--text-primary)"},i={width:"80px",height:"80px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.5rem",margin:"0 auto 1.5rem auto"},a={"text-align":"center","margin-bottom":"2rem"},c={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},d={color:"var(--text-muted)","font-size":"1rem"},h={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"};if(!t.employee)return null;const y=E=>E.split(" ").map(V=>V[0]).join("").toUpperCase(),v=E=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(E),w=E=>new Date(E).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return _(_r,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.employeeDetails")},get children(){return[(()=>{var E=VI(),V=E.firstChild,N=V.nextSibling,x=N.nextSibling;return u(E,a),u(V,i),s(V,()=>y(t.employee.name)),u(N,c),s(N,()=>t.employee.name),u(x,d),s(x,()=>t.employee.position),E})(),(()=>{var E=FI(),V=E.firstChild,N=V.firstChild,x=N.nextSibling,k=V.nextSibling,re=k.firstChild,ae=re.nextSibling,F=k.nextSibling,Y=F.firstChild,U=Y.nextSibling,b=F.nextSibling,g=b.firstChild,p=g.nextSibling,C=b.nextSibling,S=C.firstChild,A=S.nextSibling,m=C.nextSibling,ne=m.firstChild,W=ne.nextSibling;return s(N,()=>e("employees.employeeId")),s(x,()=>t.employee.id),s(re,()=>e("employees.department")),s(ae,()=>t.employee.department),s(Y,()=>e("employees.email")),s(U,()=>t.employee.email),s(g,()=>e("employees.phone")),s(p,()=>t.employee.phone),s(S,()=>e("employees.salary")),s(A,()=>v(t.employee.salary)),s(ne,()=>e("employees.hireDate")),s(W,()=>w(t.employee.startDate)),le(I=>{var O=r,J=n,D=o,T=r,B=n,me=o,H=r,de=n,$=o,q=r,Z=n,L=o,te=r,j=n,M=o,ie=r,oe=n,fe=o;return I.e=u(V,O,I.e),I.t=u(N,J,I.t),I.a=u(x,D,I.a),I.o=u(k,T,I.o),I.i=u(re,B,I.i),I.n=u(ae,me,I.n),I.s=u(F,H,I.s),I.h=u(Y,de,I.h),I.r=u(U,$,I.r),I.d=u(b,q,I.d),I.l=u(g,Z,I.l),I.u=u(p,L,I.u),I.c=u(C,te,I.c),I.w=u(S,j,I.w),I.m=u(A,M,I.m),I.f=u(m,ie,I.f),I.y=u(ne,oe,I.y),I.g=u(W,fe,I.g),I},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),E})(),(()=>{var E=BI();return u(E,h),s(E,_(Le,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(E,_(Le,{variant:"primary",onClick:()=>{console.log("Edit employee:",t.employee.id)},get children(){return e("employees.editEmployee")}}),null),E})()]}})};var lm=G("<div>"),jI=G("<div><div></div><div><div></div><div></div><div>/year");const zI=()=>{const{t}=ct(),[e,r]=ve(!1),[n,o]=ve(!1),[i,a]=ve(null),c=N=>{a(N),o(!0)},d={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},h={display:"flex","align-items":"center",gap:"1rem"},y={width:"60px",height:"60px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.2rem"},v={flex:"1"},w={"font-weight":"600","margin-bottom":"0.25rem"},E={color:"var(--text-muted)","font-size":"0.875rem","margin-bottom":"0.5rem"},V={color:"var(--primary-color)","font-weight":"500"};return _(Br,{get title(){return t("employees.title")},get children(){return[(()=>{var N=lm();return N.style.setProperty("margin-bottom","2rem"),s(N,_(Le,{variant:"primary",onClick:()=>r(!0),get children(){return t("employees.addEmployee")}})),N})(),(()=>{var N=lm();return u(N,d),s(N,()=>kp.employees.map(x=>{const k=ae=>ae.split(" ").map(F=>F[0]).join("").toUpperCase(),re=ae=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ae);return _(He,{onClick:()=>c(x),get children(){var ae=jI(),F=ae.firstChild,Y=F.nextSibling,U=Y.firstChild,b=U.nextSibling,g=b.nextSibling,p=g.firstChild;return u(ae,h),u(F,y),s(F,()=>k(x.name)),u(Y,v),u(U,w),s(U,()=>x.name),u(b,E),s(b,()=>x.position),u(g,V),s(g,()=>re(x.salary),p),ae}})})),N})(),_(OI,{get isOpen(){return e()},onClose:()=>r(!1)}),_(UI,{get isOpen(){return n()},onClose:()=>o(!1),get employee(){return i()}})]}})},qI=[{id:"1",accountId:"1002",bankName:"First National Bank",accountNumber:"****1234",accountType:"checking",currency:"USD",currentBalance:32730.5,lastReconciledDate:"2024-01-01",lastReconciledBalance:3e4,isActive:!0},{id:"2",accountId:"1003",bankName:"First National Bank",accountNumber:"****5678",accountType:"savings",currency:"USD",currentBalance:12e3,lastReconciledDate:"2024-01-01",lastReconciledBalance:1e4,isActive:!0}],GI=[{id:"1",accountId:"1002",date:"2024-01-15",description:"Customer Payment - ABC Corp",reference:"CHK001234",debitAmount:5e3,creditAmount:0,balance:35730.5,category:"Customer Payment",isReconciled:!0,reconciledWith:"eb1",importedAt:"2024-01-16",source:"csv_import"},{id:"2",accountId:"1002",date:"2024-01-14",description:"Office Supplies - Staples",reference:"CHK001235",debitAmount:0,creditAmount:250,balance:30730.5,category:"Office Expenses",isReconciled:!0,reconciledWith:"eb2",importedAt:"2024-01-16",source:"csv_import"},{id:"3",accountId:"1002",date:"2024-01-13",description:"Monthly Rent Payment",reference:"CHK001236",debitAmount:0,creditAmount:2e3,balance:28730.5,category:"Rent",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"},{id:"4",accountId:"1002",date:"2024-01-12",description:"Wire Transfer In",reference:"WIRE001",debitAmount:1e4,creditAmount:0,balance:38730.5,category:"Wire Transfer",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"}],HI=[{id:"eb1",accountId:"1002",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",debitAmount:5e3,creditAmount:0,category:"Accounts Receivable",isReconciled:!0,reconciledWith:"1",createdAt:"2024-01-15"},{id:"eb2",accountId:"1002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",debitAmount:0,creditAmount:250,category:"Office Expenses",isReconciled:!0,reconciledWith:"2",createdAt:"2024-01-14"},{id:"eb3",accountId:"1002",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",debitAmount:0,creditAmount:3500,category:"Salary Expense",isReconciled:!1,createdAt:"2024-01-11"}],WI=[{id:"1",bankAccountId:"1",periodStart:"2024-01-01",periodEnd:"2024-01-15",startingBalance:3e4,endingBalance:35730.5,status:"in_progress",totalBankTransactions:4,totalEntryBookRecords:3,reconciledTransactions:2,unreconciledTransactions:2,discrepancyAmount:1500,createdAt:"2024-01-16",notes:"Wire transfer and rent payment need investigation"}],[Ws,cm]=ve(qI),[qn,Ll]=ve(GI),[Di,um]=ve(HI),[Ys,dm]=ve(WI),cr={get bankAccounts(){return Ws()},addBankAccount(t){const e={...t,id:Date.now().toString()};return cm([...Ws(),e]),e},updateBankAccount(t,e){cm(Ws().map(r=>r.id===t?{...r,...e}:r))},getBankAccountById(t){return Ws().find(e=>e.id===t)},get bankStatements(){return qn()},addBankStatement(t){const e={...t,id:Date.now().toString(),importedAt:new Date().toISOString()};return Ll([...qn(),e]),e},addBankStatementsFromCSV(t){const e=t.map(r=>({...r,id:`csv_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,importedAt:new Date().toISOString(),source:"csv_import",isReconciled:!1}));return Ll([...qn(),...e]),e},updateBankStatement(t,e){Ll(qn().map(r=>r.id===t?{...r,...e}:r))},getBankStatementsByAccount(t){return qn().filter(e=>e.accountId===t)},getUnreconciledBankStatements(t){return(t?this.getBankStatementsByAccount(t):qn()).filter(r=>!r.isReconciled)},get entryBookRecords(){return Di()},addEntryBookRecord(t){const e={...t,id:Date.now().toString(),createdAt:new Date().toISOString()};return um([...Di(),e]),e},updateEntryBookRecord(t,e){um(Di().map(r=>r.id===t?{...r,...e}:r))},getEntryBookRecordsByAccount(t){return Di().filter(e=>e.accountId===t)},getUnreconciledEntryBookRecords(t){return(t?this.getEntryBookRecordsByAccount(t):Di()).filter(r=>!r.isReconciled)},reconcileTransaction(t,e){this.updateBankStatement(t,{isReconciled:!0,reconciledWith:e}),this.updateEntryBookRecord(e,{isReconciled:!0,reconciledWith:t})},unreconciledTransaction(t){const e=qn().find(r=>r.id===t);e?.reconciledWith&&this.updateEntryBookRecord(e.reconciledWith,{isReconciled:!1,reconciledWith:void 0}),this.updateBankStatement(t,{isReconciled:!1,reconciledWith:void 0})},findPotentialMatches(t){const e=qn().find(n=>n.id===t);return e?this.getUnreconciledEntryBookRecords(e.accountId).filter(n=>{const o=Math.abs(e.debitAmount-n.debitAmount)<.01||Math.abs(e.creditAmount-n.creditAmount)<.01,i=new Date(e.date),a=new Date(n.date),d=Math.abs((i.getTime()-a.getTime())/(1e3*60*60*24))<=3,h=e.reference===n.reference||e.description.toLowerCase().includes(n.description.toLowerCase())||n.description.toLowerCase().includes(e.description.toLowerCase());return o&&(d||h)}).sort((n,o)=>{const i=(n.date===e.date?2:0)+(n.reference===e.reference?1:0);return(o.date===e.date?2:0)+(o.reference===e.reference?1:0)-i}):[]},get reconciliationSessions(){return Ys()},startReconciliationSession(t,e,r){const n=this.getBankStatementsByAccount(t).filter(h=>h.date>=e&&h.date<=r),o=this.getEntryBookRecordsByAccount(t).filter(h=>h.date>=e&&h.date<=r),i=n.filter(h=>h.isReconciled).length,a=this.getBankAccountById(t)?.lastReconciledBalance||0,c=this.getBankAccountById(t)?.currentBalance||0,d={id:Date.now().toString(),bankAccountId:t,periodStart:e,periodEnd:r,startingBalance:a,endingBalance:c,status:"in_progress",totalBankTransactions:n.length,totalEntryBookRecords:o.length,reconciledTransactions:i,unreconciledTransactions:n.length-i,discrepancyAmount:0,createdAt:new Date().toISOString()};return dm([...Ys(),d]),d},updateReconciliationSession(t,e){dm(Ys().map(r=>r.id===t?{...r,...e}:r))},getReconciliationSessionsByAccount(t){return Ys().filter(e=>e.bankAccountId===t)}};var Ml=G("<div>"),YI=G("<div><strong>:</strong> <!> - "),KI=G("<div><div><div></div><div></div><div></div></div><input id=csvFileInput type=file accept=.csv>"),QI=G("<div><h4></h4><div><div><label> *</label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><select><option value>"),Ho=G("<option>"),JI=G("<div><table><thead><tr></tr></thead><tbody>"),XI=G("<th>"),ZI=G("<tr>"),eE=G("<td>");const tE=t=>{const{t:e}=ct(),[r,n]=ve(!1),[o,i]=ve(!1),[a,c]=ve(null),[d,h]=ve([]),[y,v]=ve({date:"",description:"",reference:"",debit:"",credit:"",balance:""}),w={border:`2px dashed ${r()?"var(--primary-color)":"var(--border-color)"}`,"border-radius":"var(--border-radius)",padding:"2rem","text-align":"center","background-color":r()?"var(--background-color)":"transparent",transition:"all 0.2s ease",cursor:"pointer"},E={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem","margin-top":"1.5rem"},V={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-family":"inherit"},N={"max-height":"200px","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},x={width:"100%","border-collapse":"collapse","font-size":"0.875rem"},k={padding:"0.5rem","border-bottom":"1px solid var(--border-color)","text-align":"left"},re={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},ae=A=>{A.preventDefault(),n(!0)},F=A=>{A.preventDefault(),n(!1)},Y=A=>{A.preventDefault(),n(!1);const m=A.dataTransfer?.files;m&&m.length>0&&b(m[0])},U=A=>{const m=A.target;m.files&&m.files.length>0&&b(m.files[0])},b=A=>{if(!A.name.toLowerCase().endsWith(".csv")){c({success:!1,message:e("banking.pleaseUploadCSV")});return}i(!0);const m=new FileReader;m.onload=ne=>{try{const I=(ne.target?.result).split(`
`).filter(T=>T.trim());if(I.length<2){c({success:!1,message:e("banking.csvRequiresHeaderAndData")}),i(!1);return}const O=I[0].split(",").map(T=>T.trim().replace(/[\"\']/g,"")),J=I.slice(1).map(T=>{const B=T.split(",").map(H=>H.trim().replace(/[\"\']/g,"")),me={};return O.forEach((H,de)=>{me[H]=B[de]||""}),me});h(J),c({success:!0,message:e("banking.successfullyParsed").replace("{count}",J.length.toString()),count:J.length});const D={...y()};O.forEach(T=>{const B=T.toLowerCase();B.includes("date")&&(D.date=T),(B.includes("description")||B.includes("memo"))&&(D.description=T),(B.includes("reference")||B.includes("check")||B.includes("ref"))&&(D.reference=T),(B.includes("debit")||B.includes("deposit"))&&(D.debit=T),(B.includes("credit")||B.includes("withdrawal")||B.includes("amount"))&&(D.debit?D.credit=T:D.debit=T),B.includes("balance")&&(D.balance=T)}),v(D)}catch{c({success:!1,message:e("banking.errorParsingCSV")})}i(!1)},m.readAsText(A)},g=(A,m)=>{v(ne=>({...ne,[A]:m}))},p=()=>d().length===0?[]:Object.keys(d()[0]),C=()=>{if(!t.bankAccount||d().length===0)return;const A=y();if(!A.date||!A.description){c({success:!1,message:e("banking.dateDescriptionRequired")});return}i(!0);try{const m=d().map(W=>{const I=T=>T&&parseFloat(T.replace(/[^0-9.-]/g,""))||0,O=T=>{const B=new Date(T);if(isNaN(B.getTime())){const me=T.split("/");if(me.length===3)return new Date(parseInt(me[2]),parseInt(me[0])-1,parseInt(me[1])).toISOString().split("T")[0]}return B.toISOString().split("T")[0]};let J=0,D=0;if(A.debit&&A.credit)J=I(W[A.debit]),D=I(W[A.credit]);else if(A.debit){const T=I(W[A.debit]);T>0?J=T:D=Math.abs(T)}return{accountId:t.bankAccount.accountId,date:O(W[A.date]),description:W[A.description]||e("banking.importedTransaction"),reference:W[A.reference]||"",debitAmount:J,creditAmount:D,balance:A.balance?I(W[A.balance]):0,isReconciled:!1}}),ne=cr.addBankStatementsFromCSV(m);c({success:!0,message:e("banking.successfullyImported").replace("{count}",ne.length.toString()),count:ne.length}),h([]),v({date:"",description:"",reference:"",debit:"",credit:"",balance:""})}catch{c({success:!1,message:e("banking.errorImportingTransactions")})}i(!1)},S=()=>{h([]),c(null),v({date:"",description:"",reference:"",debit:"",credit:"",balance:""})};return _(_r,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("banking.importBankStatementCSV")},get children(){return[ge(()=>ge(()=>!!t.bankAccount)()&&(()=>{var A=YI(),m=A.firstChild,ne=m.firstChild,W=m.nextSibling,I=W.nextSibling;return I.nextSibling,A.style.setProperty("margin-bottom","1.5rem"),A.style.setProperty("padding","1rem"),A.style.setProperty("background","var(--background-color)"),A.style.setProperty("border-radius","var(--border-radius-sm)"),A.style.setProperty("border","1px solid var(--border-color)"),s(m,()=>e("banking.bankAccount"),ne),s(A,()=>t.bankAccount.bankName,I),s(A,()=>t.bankAccount.accountNumber,null),A})()),ge(()=>ge(()=>d().length===0)()?(()=>{var A=KI(),m=A.firstChild,ne=m.firstChild,W=ne.nextSibling,I=W.nextSibling,O=m.nextSibling;return m.$$click=()=>document.getElementById("csvFileInput")?.click(),m.addEventListener("drop",Y),m.addEventListener("dragleave",F),m.addEventListener("dragover",ae),ne.style.setProperty("font-size","2rem"),ne.style.setProperty("margin-bottom","1rem"),W.style.setProperty("font-weight","500"),W.style.setProperty("margin-bottom","0.5rem"),s(W,(()=>{var J=ge(()=>!!r());return()=>J()?e("banking.dropCSVHere"):e("banking.clickToUploadCSV")})()),I.style.setProperty("font-size","0.875rem"),I.style.setProperty("color","var(--text-muted)"),s(I,()=>e("banking.supportedFormat")),O.addEventListener("change",U),O.style.setProperty("display","none"),le(J=>u(m,w,J)),A})():(()=>{var A=QI(),m=A.firstChild,ne=m.nextSibling,W=ne.firstChild,I=W.firstChild,O=I.firstChild,J=I.nextSibling,D=J.firstChild,T=W.nextSibling,B=T.firstChild,me=B.firstChild,H=B.nextSibling,de=H.firstChild,$=T.nextSibling,q=$.firstChild,Z=q.nextSibling,L=Z.firstChild,te=$.nextSibling,j=te.firstChild,M=j.firstChild,ie=j.nextSibling,oe=ie.firstChild,fe=te.nextSibling,ue=fe.firstChild,K=ue.nextSibling,R=K.firstChild,ee=fe.nextSibling,X=ee.firstChild,ye=X.nextSibling,pe=ye.firstChild;return m.style.setProperty("margin","0 0 1rem 0"),s(m,()=>e("banking.mapCSVColumns")),u(ne,E),I.style.setProperty("display","block"),I.style.setProperty("margin-bottom","0.5rem"),I.style.setProperty("font-weight","500"),s(I,()=>e("banking.dateColumn"),O),J.addEventListener("change",z=>g("date",z.target.value)),s(D,()=>e("banking.selectColumn")),s(J,()=>p().map(z=>(()=>{var se=Ho();return se.value=z,s(se,z),se})()),null),B.style.setProperty("display","block"),B.style.setProperty("margin-bottom","0.5rem"),B.style.setProperty("font-weight","500"),s(B,()=>e("banking.descriptionColumn"),me),H.addEventListener("change",z=>g("description",z.target.value)),s(de,()=>e("banking.selectColumn")),s(H,()=>p().map(z=>(()=>{var se=Ho();return se.value=z,s(se,z),se})()),null),q.style.setProperty("display","block"),q.style.setProperty("margin-bottom","0.5rem"),q.style.setProperty("font-weight","500"),s(q,()=>e("banking.referenceColumn")),Z.addEventListener("change",z=>g("reference",z.target.value)),s(L,()=>e("banking.selectColumn")),s(Z,()=>p().map(z=>(()=>{var se=Ho();return se.value=z,s(se,z),se})()),null),j.style.setProperty("display","block"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("font-weight","500"),s(j,()=>e("banking.amountDebitColumn"),M),ie.addEventListener("change",z=>g("debit",z.target.value)),s(oe,()=>e("banking.selectColumn")),s(ie,()=>p().map(z=>(()=>{var se=Ho();return se.value=z,s(se,z),se})()),null),ue.style.setProperty("display","block"),ue.style.setProperty("margin-bottom","0.5rem"),ue.style.setProperty("font-weight","500"),s(ue,()=>e("banking.creditColumn")),K.addEventListener("change",z=>g("credit",z.target.value)),s(R,()=>e("banking.selectColumn")),s(K,()=>p().map(z=>(()=>{var se=Ho();return se.value=z,s(se,z),se})()),null),X.style.setProperty("display","block"),X.style.setProperty("margin-bottom","0.5rem"),X.style.setProperty("font-weight","500"),s(X,()=>e("banking.balanceColumn")),ye.addEventListener("change",z=>g("balance",z.target.value)),s(pe,()=>e("banking.selectColumn")),s(ye,()=>p().map(z=>(()=>{var se=Ho();return se.value=z,s(se,z),se})()),null),s(A,(()=>{var z=ge(()=>d().length>0);return()=>z()&&(()=>{var se=JI(),_e=se.firstChild,Pe=_e.firstChild,he=Pe.firstChild,be=Pe.nextSibling;return u(se,N),he.style.setProperty("background-color","var(--background-color)"),s(he,()=>p().slice(0,6).map(ce=>(()=>{var Se=XI();return s(Se,ce),le(Ee=>u(Se,k,Ee)),Se})())),s(be,()=>d().slice(0,3).map(ce=>(()=>{var Se=ZI();return s(Se,()=>p().slice(0,6).map(Ee=>(()=>{var $e=eE();return s($e,()=>ce[Ee]),le(ke=>u($e,k,ke)),$e})())),Se})())),s(se,(()=>{var ce=ge(()=>d().length>3);return()=>ce()&&(()=>{var Se=Ml();return Se.style.setProperty("padding","0.5rem"),Se.style.setProperty("text-align","center"),Se.style.setProperty("color","var(--text-muted)"),s(Se,()=>e("banking.andMoreRows").replace("{count}",(d().length-3).toString())),Se})()})(),null),le(ce=>u(_e,x,ce)),se})()})(),null),le(z=>{var se=V,_e=V,Pe=V,he=V,be=V,ce=V;return z.e=u(J,se,z.e),z.t=u(H,_e,z.t),z.a=u(Z,Pe,z.a),z.o=u(ie,he,z.o),z.i=u(K,be,z.i),z.n=u(ye,ce,z.n),z},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),le(()=>J.value=y().date),le(()=>H.value=y().description),le(()=>Z.value=y().reference),le(()=>ie.value=y().debit),le(()=>K.value=y().credit),le(()=>ye.value=y().balance),A})()),ge(()=>ge(()=>!!a())()&&(()=>{var A=Ml();return A.style.setProperty("padding","1rem"),A.style.setProperty("border-radius","var(--border-radius-sm)"),A.style.setProperty("margin-top","1rem"),s(A,()=>a().message),le(m=>{var ne=a().success?"#d4edda":"#f8d7da",W=a().success?"#155724":"#721c24",I=`1px solid ${a().success?"#c3e6cb":"#f5c6cb"}`;return ne!==m.e&&((m.e=ne)!=null?A.style.setProperty("background",ne):A.style.removeProperty("background")),W!==m.t&&((m.t=W)!=null?A.style.setProperty("color",W):A.style.removeProperty("color")),I!==m.a&&((m.a=I)!=null?A.style.setProperty("border",I):A.style.removeProperty("border")),m},{e:void 0,t:void 0,a:void 0}),A})()),(()=>{var A=Ml();return u(A,re),s(A,_(Le,{variant:"secondary",onClick:()=>{S(),t.onClose()},get children(){return e("common.cancel")}}),null),s(A,(()=>{var m=ge(()=>d().length>0);return()=>m()&&_(Le,{variant:"outline",onClick:S,get children(){return e("common.reset")}})})(),null),s(A,(()=>{var m=ge(()=>d().length>0);return()=>m()&&_(Le,{variant:"primary",onClick:C,get disabled(){return o()||!y().date||!y().description},get children(){return ge(()=>!!o())()?e("banking.importing"):e("banking.importTransactions").replace("{count}",d().length.toString())}})})(),null),A})()]}})};Pt(["click"]);var hm=G("<span>"),Ks=G("<div>"),mm=G("<div> "),rE=G("<div><div><h3></h3><div><button></button><button></button><button></button></div></div><div></div><div><div><h4></h4><div></div></div><div><h4></h4><div>"),nE=G("<div><div><div></div><div>  </div></div><div><div>"),Ol=G("<span> "),oE=G("<span>(<!>)"),iE=G("<div><strong>:</strong> "),ym=G("<div><div><div></div><div>  </div></div><div>"),sE=G("<div><div>:</div><div></div><div>");const aE=t=>{const{t:e}=ct(),[r,n]=ve([]),[o,i]=ve([]),[a,c]=ve(null),[d,h]=ve([]),[y,v]=ve("unreconciled");Nn(()=>{const I=cr.getBankAccountById(t.bankAccountId);if(I){const O=cr.getBankStatementsByAccount(I.accountId).filter(D=>D.date>=t.selectedPeriod.start&&D.date<=t.selectedPeriod.end),J=cr.getEntryBookRecordsByAccount(I.accountId).filter(D=>D.date>=t.selectedPeriod.start&&D.date<=t.selectedPeriod.end);n(O),i(J)}});const w=()=>{const I=r();switch(y()){case"reconciled":return I.filter(O=>O.isReconciled);case"unreconciled":return I.filter(O=>!O.isReconciled);default:return I}},E=()=>{const I=o();switch(y()){case"reconciled":return I.filter(O=>O.isReconciled);case"unreconciled":return I.filter(O=>!O.isReconciled);default:return I}},V=I=>{if(c(I),I.isReconciled)h([]);else{const O=cr.findPotentialMatches(I.id);h(O)}},N=I=>{const O=a();if(O){cr.reconcileTransaction(O.id,I.id);const J=cr.getBankAccountById(t.bankAccountId);if(J){const D=cr.getBankStatementsByAccount(J.accountId).filter(B=>B.date>=t.selectedPeriod.start&&B.date<=t.selectedPeriod.end),T=cr.getEntryBookRecordsByAccount(J.accountId).filter(B=>B.date>=t.selectedPeriod.start&&B.date<=t.selectedPeriod.end);n(D),i(T)}c(null),h([])}},x=I=>{cr.unreconciledTransaction(I.id);const O=cr.getBankAccountById(t.bankAccountId);if(O){const J=cr.getBankStatementsByAccount(O.accountId).filter(T=>T.date>=t.selectedPeriod.start&&T.date<=t.selectedPeriod.end),D=cr.getEntryBookRecordsByAccount(O.accountId).filter(T=>T.date>=t.selectedPeriod.start&&T.date<=t.selectedPeriod.end);n(J),i(D)}},k={display:"grid","grid-template-columns":"1fr 1fr",gap:"2rem","margin-top":"2rem"},re={height:"600px","overflow-y":"auto"},ae={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},F=I=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:I?"var(--primary-color)":"var(--surface-color)",color:I?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),Y=(I,O)=>({display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem","margin-bottom":"0.5rem",background:I?"var(--primary-color)":O?"#e8f5e8":"var(--surface-color)",color:I?"white":"var(--text-primary)","border-radius":"var(--border-radius-sm)",border:`1px solid ${I?"var(--primary-color)":O?"#c3e6cb":"var(--border-color)"}`,cursor:"pointer",transition:"all 0.2s ease"}),U={flex:"1"},b={"font-weight":"500","margin-bottom":"0.25rem"},g={"font-size":"0.875rem",opacity:"0.8"},p=I=>({"font-weight":"600",color:I?"#4caf50":"#f44336"}),C={padding:"0.25rem 0.5rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","margin-left":"0.5rem"},S=I=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(I),A=I=>new Date(I).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),m=I=>{if(!a())return null;const O=a();return(Math.abs(O.debitAmount-I.debitAmount)<.01||Math.abs(O.creditAmount-I.creditAmount)<.01)&&O.date===I.date?(()=>{var T=hm();return s(T,()=>e("banking.exactMatch")),le(B=>u(T,{...C,background:"#d4edda",color:"#155724"},B)),T})():d().includes(I)?(()=>{var T=hm();return s(T,()=>e("banking.possibleMatch")),le(B=>u(T,{...C,background:"#fff3cd",color:"#856404"},B)),T})():null},W=(()=>{const I=r(),O=o(),J=I.filter(T=>T.isReconciled).length,D=O.filter(T=>T.isReconciled).length;return{totalStatements:I.length,totalRecords:O.length,reconciledStatements:J,reconciledRecords:D,unreconciledStatements:I.length-J,unreconciledRecords:O.length-D}})();return(()=>{var I=rE(),O=I.firstChild,J=O.firstChild,D=J.nextSibling,T=D.firstChild,B=T.nextSibling,me=B.nextSibling,H=O.nextSibling,de=H.nextSibling,$=de.firstChild,q=$.firstChild,Z=q.nextSibling,L=$.nextSibling,te=L.firstChild,j=te.nextSibling;return u(O,ae),J.style.setProperty("margin","0"),J.style.setProperty("font-size","1.25rem"),s(J,()=>e("banking.reconciliationComparison")),D.style.setProperty("display","flex"),D.style.setProperty("gap","0.5rem"),T.$$click=()=>v("all"),s(T,()=>e("common.all")),B.$$click=()=>v("unreconciled"),s(B,()=>e("banking.unreconciled")),me.$$click=()=>v("reconciled"),s(me,()=>e("banking.reconciled")),H.style.setProperty("display","grid"),H.style.setProperty("grid-template-columns","repeat(4, 1fr)"),H.style.setProperty("gap","1rem"),H.style.setProperty("margin-bottom","2rem"),s(H,_(He,{get title(){return e("banking.bankStatements")},get subtitle(){return e("banking.totalTransactions")},get children(){return[(()=>{var M=Ks();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","var(--primary-color)"),s(M,()=>W.totalStatements),M})(),(()=>{var M=mm(),ie=M.firstChild;return M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","var(--text-muted)"),s(M,()=>W.reconciledStatements,ie),s(M,()=>e("banking.reconciled"),null),M})()]}}),null),s(H,_(He,{get title(){return e("banking.entryBookRecords")},get subtitle(){return e("banking.totalEntries")},get children(){return[(()=>{var M=Ks();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","var(--primary-color)"),s(M,()=>W.totalRecords),M})(),(()=>{var M=mm(),ie=M.firstChild;return M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","var(--text-muted)"),s(M,()=>W.reconciledRecords,ie),s(M,()=>e("banking.reconciled"),null),M})()]}}),null),s(H,_(He,{get title(){return e("banking.unreconciledBank")},get subtitle(){return e("banking.needAttention")},get children(){var M=Ks();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","#f44336"),s(M,()=>W.unreconciledStatements),M}}),null),s(H,_(He,{get title(){return e("banking.unreconciledBooks")},get subtitle(){return e("banking.needAttention")},get children(){var M=Ks();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","#f44336"),s(M,()=>W.unreconciledRecords),M}}),null),u(de,k),q.style.setProperty("margin","0 0 1rem 0"),s(q,()=>e("banking.bankStatements")),s(Z,()=>w().map(M=>(()=>{var ie=nE(),oe=ie.firstChild,fe=oe.firstChild,ue=fe.nextSibling,K=ue.firstChild,R=oe.nextSibling,ee=R.firstChild;return ie.$$click=()=>V(M),s(fe,()=>M.description),s(ue,()=>A(M.date),K),s(ue,()=>M.reference,null),s(ue,(()=>{var X=ge(()=>!!M.isReconciled);return()=>X()&&(()=>{var ye=Ol();return ye.firstChild,ye.style.setProperty("color","#4caf50"),ye.style.setProperty("margin-left","0.5rem"),s(ye,()=>e("banking.reconciled"),null),ye})()})(),null),s(ee,()=>M.debitAmount>0?"+":"-",null),s(ee,()=>S(M.debitAmount||M.creditAmount),null),s(R,(()=>{var X=ge(()=>!!M.isReconciled);return()=>X()&&_(Le,{variant:"outline",size:"sm",onClick:ye=>{ye.stopPropagation(),x(M)},style:{"margin-top":"0.5rem"},get children(){return e("banking.unreconcile")}})})(),null),le(X=>{var ye=Y(a()?.id===M.id,M.isReconciled),pe=U,z=b,se=g,_e=p(M.debitAmount>0);return X.e=u(ie,ye,X.e),X.t=u(oe,pe,X.t),X.a=u(fe,z,X.a),X.o=u(ue,se,X.o),X.i=u(ee,_e,X.i),X},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ie})())),te.style.setProperty("margin","0 0 1rem 0"),s(te,()=>e("banking.entryBookRecords"),null),s(te,(()=>{var M=ge(()=>!!(a()&&!a().isReconciled));return()=>M()&&(()=>{var ie=oE(),oe=ie.firstChild,fe=oe.nextSibling;return fe.nextSibling,ie.style.setProperty("font-weight","400"),ie.style.setProperty("color","var(--text-muted)"),ie.style.setProperty("margin-left","0.5rem"),s(ie,()=>e("banking.clickToReconcile"),fe),ie})()})(),null),s(j,(()=>{var M=ge(()=>!!(a()&&!a().isReconciled));return()=>M()?[ge(()=>ge(()=>d().length>0)()&&(()=>{var ie=iE(),oe=ie.firstChild,fe=oe.firstChild;return oe.nextSibling,ie.style.setProperty("margin-bottom","1rem"),ie.style.setProperty("padding","0.75rem"),ie.style.setProperty("background","#fff3cd"),ie.style.setProperty("border-radius","var(--border-radius-sm)"),s(oe,()=>e("banking.potentialMatchesFound"),fe),s(ie,()=>e("banking.clickRecordToReconcile"),null),ie})()),ge(()=>E().map(ie=>(d().includes(ie),(()=>{var oe=ym(),fe=oe.firstChild,ue=fe.firstChild,K=ue.nextSibling,R=K.firstChild,ee=fe.nextSibling;return oe.$$click=()=>{ie.isReconciled||N(ie)},s(ue,()=>ie.description,null),s(ue,()=>m(ie),null),s(K,()=>A(ie.date),R),s(K,()=>ie.reference,null),s(K,(()=>{var X=ge(()=>!!ie.isReconciled);return()=>X()&&(()=>{var ye=Ol();return ye.firstChild,ye.style.setProperty("color","#4caf50"),ye.style.setProperty("margin-left","0.5rem"),s(ye,()=>e("banking.reconciled"),null),ye})()})(),null),s(ee,()=>ie.debitAmount>0?"+":"-",null),s(ee,()=>S(ie.debitAmount||ie.creditAmount),null),le(X=>{var ye={...Y(!1,ie.isReconciled),opacity:ie.isReconciled?.6:1,cursor:ie.isReconciled?"not-allowed":"pointer"},pe=U,z=b,se=g,_e=p(ie.debitAmount>0);return X.e=u(oe,ye,X.e),X.t=u(fe,pe,X.t),X.a=u(ue,z,X.a),X.o=u(K,se,X.o),X.i=u(ee,_e,X.i),X},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),oe})())))]:E().map(ie=>(()=>{var oe=ym(),fe=oe.firstChild,ue=fe.firstChild,K=ue.nextSibling,R=K.firstChild,ee=fe.nextSibling;return s(ue,()=>ie.description),s(K,()=>A(ie.date),R),s(K,()=>ie.reference,null),s(K,(()=>{var X=ge(()=>!!ie.isReconciled);return()=>X()&&(()=>{var ye=Ol();return ye.firstChild,ye.style.setProperty("color","#4caf50"),ye.style.setProperty("margin-left","0.5rem"),s(ye,()=>e("banking.reconciled"),null),ye})()})(),null),s(ee,()=>ie.debitAmount>0?"+":"-",null),s(ee,()=>S(ie.debitAmount||ie.creditAmount),null),le(X=>{var ye=Y(!1,ie.isReconciled),pe=U,z=b,se=g,_e=p(ie.debitAmount>0);return X.e=u(oe,ye,X.e),X.t=u(fe,pe,X.t),X.a=u(ue,z,X.a),X.o=u(K,se,X.o),X.i=u(ee,_e,X.i),X},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),oe})())})()),s(I,(()=>{var M=ge(()=>!!(a()&&!a().isReconciled));return()=>M()&&(()=>{var ie=sE(),oe=ie.firstChild,fe=oe.firstChild,ue=oe.nextSibling,K=ue.nextSibling;return ie.style.setProperty("position","fixed"),ie.style.setProperty("bottom","2rem"),ie.style.setProperty("right","2rem"),ie.style.setProperty("background","var(--surface-color)"),ie.style.setProperty("padding","1rem"),ie.style.setProperty("border-radius","var(--border-radius)"),ie.style.setProperty("box-shadow","var(--shadow-lg)"),ie.style.setProperty("border","1px solid var(--border-color)"),ie.style.setProperty("max-width","300px"),oe.style.setProperty("font-weight","500"),oe.style.setProperty("margin-bottom","0.5rem"),s(oe,()=>e("banking.selected"),fe),ue.style.setProperty("font-size","0.875rem"),ue.style.setProperty("margin-bottom","0.5rem"),s(ue,()=>a().description),K.style.setProperty("font-weight","600"),K.style.setProperty("color","var(--primary-color)"),s(K,()=>S(a().debitAmount||a().creditAmount)),s(ie,_(Le,{variant:"secondary",size:"sm",onClick:()=>{c(null),h([])},style:{"margin-top":"0.5rem"},get children(){return e("banking.clearSelection")}}),null),ie})()})(),null),le(M=>{var ie=F(y()==="all"),oe=F(y()==="unreconciled"),fe=F(y()==="reconciled"),ue=re,K=re;return M.e=u(T,ie,M.e),M.t=u(B,oe,M.t),M.a=u(me,fe,M.a),M.o=u(Z,ue,M.o),M.i=u(j,K,M.i),M},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),I})()};Pt(["click"]);var lE=G("<div><div><h2></h2><p></p></div><div>"),cE=G("<div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date>"),uE=G("<div><button></button><button>"),dE=G("<div><br>"),Ni=G("<div>"),hE=G("<div><div></div><div>  </div><div>"),mE=G("<div>: "),yE=G("<div> <!>  <!> "),fE=G("<div>%"),pE=G("<div> of <!> transactions");const gE=()=>{const{t}=ct(),[e,r]=ve(null),[n,o]=ve({start:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[i,a]=ve(!1),[c,d]=ve("overview");Nn(()=>{!e()&&cr.bankAccounts.length>0&&r(cr.bankAccounts[0])});const h={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},y={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},v={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},w=ae=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:ae?"var(--primary-color)":"var(--text-muted)","border-bottom":ae?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),E={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},V=ae=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ae),N=ae=>new Date(ae).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),x=()=>cr.bankAccounts.map(ae=>({value:ae.id,label:`${ae.bankName} - ${ae.accountNumber} (${ae.accountType})`})),re=(()=>{if(!e())return null;const ae=cr.getBankStatementsByAccount(e().accountId).filter(U=>U.date>=n().start&&U.date<=n().end),F=cr.getEntryBookRecordsByAccount(e().accountId).filter(U=>U.date>=n().start&&U.date<=n().end),Y=ae.filter(U=>U.isReconciled).length;return F.filter(U=>U.isReconciled).length,{totalBankTransactions:ae.length,totalEntryBookRecords:F.length,reconciledTransactions:Y,unreconciledTransactions:ae.length-Y,reconciliationRate:ae.length>0?Y/ae.length*100:0}})();return _(Br,{get title(){return t("banking.title")},get children(){return[(()=>{var ae=lE(),F=ae.firstChild,Y=F.firstChild,U=Y.nextSibling,b=F.nextSibling;return u(ae,h),Y.style.setProperty("margin","0 0 0.5rem 0"),Y.style.setProperty("font-size","1.5rem"),s(Y,()=>t("banking.reconciliation")),U.style.setProperty("margin","0"),U.style.setProperty("color","var(--text-muted)"),s(U,()=>t("banking.compareStatements")),b.style.setProperty("display","flex"),b.style.setProperty("gap","1rem"),s(b,_(Le,{variant:"secondary",onClick:()=>a(!0),get disabled(){return!e()},get children(){return t("banking.importCSV")}}),null),s(b,_(Le,{variant:"primary",get children(){return t("banking.startNewReconciliation")}}),null),ae})(),(()=>{var ae=cE(),F=ae.firstChild,Y=F.firstChild,U=F.nextSibling,b=U.firstChild,g=b.nextSibling,p=U.nextSibling,C=p.firstChild,S=C.nextSibling;return u(ae,y),F.style.setProperty("flex","1"),Y.style.setProperty("display","block"),Y.style.setProperty("margin-bottom","0.5rem"),Y.style.setProperty("font-weight","500"),s(Y,()=>t("banking.bankAccount")),s(F,_(gr,{label:"",get value(){return e()?.id||""},onChange:A=>{const m=cr.getBankAccountById(A);r(m||null)},get options(){return x()}}),null),b.style.setProperty("display","block"),b.style.setProperty("margin-bottom","0.5rem"),b.style.setProperty("font-weight","500"),s(b,()=>t("entryBooks.startDate")),g.addEventListener("change",A=>o(m=>({...m,start:A.target.value}))),g.style.setProperty("padding","0.75rem"),g.style.setProperty("border","1px solid var(--border-color)"),g.style.setProperty("border-radius","var(--border-radius-sm)"),g.style.setProperty("font-family","inherit"),C.style.setProperty("display","block"),C.style.setProperty("margin-bottom","0.5rem"),C.style.setProperty("font-weight","500"),s(C,()=>t("entryBooks.endDate")),S.addEventListener("change",A=>o(m=>({...m,end:A.target.value}))),S.style.setProperty("padding","0.75rem"),S.style.setProperty("border","1px solid var(--border-color)"),S.style.setProperty("border-radius","var(--border-radius-sm)"),S.style.setProperty("font-family","inherit"),le(()=>g.value=n().start),le(()=>S.value=n().end),ae})(),(()=>{var ae=uE(),F=ae.firstChild,Y=F.nextSibling;return u(ae,v),F.$$click=()=>d("overview"),s(F,()=>t("common.overview")),Y.$$click=()=>d("reconciliation"),s(Y,()=>t("banking.reconciliation")),le(U=>{var b=w(c()==="overview"),g=w(c()==="reconciliation");return U.e=u(F,b,U.e),U.t=u(Y,g,U.t),U},{e:void 0,t:void 0}),ae})(),ge(()=>ge(()=>c()==="overview")()&&(()=>{var ae=Ni();return s(ae,(()=>{var F=ge(()=>!!e());return()=>F()&&(()=>{var Y=Ni();return u(Y,E),s(Y,_(He,{get title(){return t("banking.bankAccountInfo")},get subtitle(){return t("banking.currentAccountDetails")},get children(){return[(()=>{var U=hE(),b=U.firstChild,g=b.nextSibling,p=g.firstChild,C=g.nextSibling;return U.style.setProperty("margin-bottom","1rem"),b.style.setProperty("font-weight","600"),b.style.setProperty("margin-bottom","0.5rem"),s(b,()=>e().bankName),g.style.setProperty("color","var(--text-muted)"),g.style.setProperty("margin-bottom","0.5rem"),s(g,()=>e().accountNumber,p),s(g,()=>e().accountType,null),C.style.setProperty("font-size","1.25rem"),C.style.setProperty("font-weight","600"),C.style.setProperty("color","var(--primary-color)"),s(C,()=>V(e().currentBalance)),U})(),ge(()=>ge(()=>!!e().lastReconciledDate)()&&(()=>{var U=mE(),b=U.firstChild;return U.style.setProperty("font-size","0.875rem"),U.style.setProperty("color","var(--text-muted)"),s(U,()=>t("banking.lastReconciled"),b),s(U,()=>N(e().lastReconciledDate),null),U})())]}}),null),s(Y,re&&[_(He,{get title(){return t("banking.bankTransactions")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var U=Ni();return U.style.setProperty("font-size","1.5rem"),U.style.setProperty("font-weight","600"),U.style.setProperty("color","var(--primary-color)"),U.style.setProperty("margin-bottom","0.5rem"),s(U,()=>re.totalBankTransactions),U})(),(()=>{var U=yE(),b=U.firstChild,g=b.nextSibling,p=g.nextSibling,C=p.nextSibling;return C.nextSibling,U.style.setProperty("font-size","0.875rem"),U.style.setProperty("color","var(--text-muted)"),s(U,()=>re.reconciledTransactions,b),s(U,()=>t("banking.reconciled"),g),s(U,()=>re.unreconciledTransactions,C),s(U,()=>t("banking.pending"),null),U})()]}}),_(He,{get title(){return t("entryBooks.entryBookRecords")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var U=Ni();return U.style.setProperty("font-size","1.5rem"),U.style.setProperty("font-weight","600"),U.style.setProperty("color","var(--primary-color)"),U.style.setProperty("margin-bottom","0.5rem"),s(U,()=>re.totalEntryBookRecords),U})(),(()=>{var U=Ni();return U.style.setProperty("font-size","0.875rem"),U.style.setProperty("color","var(--text-muted)"),s(U,()=>t("banking.bookEntriesForComparison")),U})()]}}),_(He,{get title(){return t("banking.reconciliationRate")},get subtitle(){return t("banking.completionStatus")},get children(){return[(()=>{var U=fE(),b=U.firstChild;return U.style.setProperty("font-size","1.5rem"),U.style.setProperty("font-weight","600"),U.style.setProperty("margin-bottom","0.5rem"),s(U,()=>Math.round(re.reconciliationRate),b),le(g=>(g=re.reconciliationRate>80?"#4caf50":re.reconciliationRate>50?"#ff9800":"#f44336")!=null?U.style.setProperty("color",g):U.style.removeProperty("color")),U})(),(()=>{var U=pE(),b=U.firstChild,g=b.nextSibling;return g.nextSibling,U.style.setProperty("font-size","0.875rem"),U.style.setProperty("color","var(--text-muted)"),s(U,()=>re.reconciledTransactions,b),s(U,()=>re.totalBankTransactions,g),U})()]}})],null),Y})()})(),null),s(ae,_(He,{get title(){return t("banking.recentReconciliationSessions")},get subtitle(){return t("banking.latestActivity")},get children(){var F=dE(),Y=F.firstChild;return F.style.setProperty("text-align","center"),F.style.setProperty("color","var(--text-muted)"),F.style.setProperty("padding","2rem"),s(F,()=>t("banking.noRecentSessions"),Y),s(F,_(Le,{variant:"primary",style:{"margin-top":"1rem"},onClick:()=>d("reconciliation"),get children(){return t("banking.startFirstReconciliation")}}),null),F}}),null),ae})()),ge(()=>ge(()=>!!(c()==="reconciliation"&&e()))()&&_(aE,{get bankAccountId(){return e().id},get selectedPeriod(){return n()}})),_(tE,{get isOpen(){return i()},onClose:()=>a(!1),get bankAccount(){return e()}})]}})};Pt(["click"]);Pt(["input","click"]);var vE=G("<h2>Upload Bank Statement CSV"),bE=G("<input type=file accept=.csv>"),_E=G("<h3>Filters"),SE=G('<div><input type=text placeholder="Search transactions..."><input type=date placeholder="Start Date"><input type=date placeholder="End Date"><button>Download Detailed Report'),PE=G("<div><button>Summary</button><button>Deposits</button><button>Payments</button><button>Timeline"),wE=G("<h3>Total Deposits"),Qs=G("<p>"),fm=G("<p> transactions"),CE=G("<h3>Total Payments"),AE=G("<h3>Net Cash Flow"),xE=G("<h3>Check Payments"),IE=G("<p> checks"),Li=G("<div>"),EE=G("<h3>Accounts & Payment Methods Used"),$E=G("<h3>Monthly Cash Flow Trend"),TE=G("<div><table><thead><tr><th>Month</th><th>Deposits</th><th>Payments</th><th>Net</th></tr></thead><tbody>"),kE=G("<h2>Deposits by Type"),RE=G("<h2>Top Depositors"),DE=G("<div><table><thead><tr><th>Depositor</th><th>Total Amount</th><th>Count</th><th>Actions</th></tr></thead><tbody>"),NE=G("<h2>Payments by Category"),LE=G("<h2>Top Payees"),ME=G("<div><table><thead><tr><th>Payee</th><th>Category</th><th>Total Amount</th><th>Count</th></tr></thead><tbody>"),OE=G("<h2>Transaction Timeline"),VE=G("<div><h1>Detailed Bank Statement Analyzer"),FE=G("<span>"),BE=G("<tr><td></td><td></td><td></td><td>"),pm=G("<div><h4></h4><p></p><p> transactions"),UE=G("<tr><td></td><td></td><td></td><td><details><summary>View</summary><div>"),jE=G("<div> - "),zE=G("<tr><td></td><td><span></span></td><td></td><td>"),qE=G("<div><div><div></div><div>  </div></div><div><div>");const GE=()=>{const[t,e]=ve(""),[r,n]=ve("summary"),[o,i]=ve(""),[a,c]=ve({start:"",end:""}),[d,h]=Fa({list:[]}),y={Utilities:["AT&T","METRO BY T-MOBILE","COMCAST","STREAM ENERGY","NETFLIX","SPECTRUM"],checks:["CHECK"],JPM:["JPM","POVBR"],Transportation:["DRIVE AWAY","TRANPORT","QUICKQUACK","EXXON","SHELL","CHEVRON","UBER","LYFT","U-HAUL","UHAL","LOVE'S"],Lodging:["HOLIDAY INN","MARRIOTT","HILTON","AIRBNB","HOTEL","MOTEL"],"Food & Dining":["GOLDEN CORRAL","MOCTEZUMA","CHINA STAR","RESTAURANT","CAFE","STARBUCKS","BUFFET","GRILL","MARKET","SEAFOOD"],Shopping:["BURLINGTON","WALMART","TARGET","AMAZON","ROSS","KROGER","PUBLIC","AMZN","AMZ"],Financial:["AMERICANFIRSTFIN","LOAN","CREDIT"],Insurance:["INSURANCE","GEICO","STATE FARM"],Rent:["SHAFAII INVESTME"],Medical:["PHARMACY","CVS","WALGREENS","HOSPITAL","CLINIC"],Entertainment:["CINEMA","THEATER","CONCERT"],"Other Services":["BARBER","SALON","SPA","GYM"],Return:["RETURN ITEM "]},v=F=>{const Y=F.toUpperCase();for(const[U,b]of Object.entries(y))for(const g of b)if(Y.includes(g.toUpperCase()))return U;return"Other"},w=F=>{const Y=F.match(/Zelle payment from ([^0-9]+)/i);if(Y)return Y[1].trim().replace(/[A-Z0-9]{10,}$/,"").trim();if(F.includes("CHECK"))return"Check Payment";const U=F.match(/^([^0-9]+)/);return U?U[1].trim():F.substring(0,30)},E=F=>{const Y=F.trim().split(`
`),U=[];console.log(Y);for(let b=1;b<Y.length;b++){const g=Y[b].split(",");if(console.log(g),g.length>=3){const p=parseFloat(g[2]);let C={postingDate:g[0],description:g[1],amount:p};U.push(C)}}return console.log({transactions:U}),h("list",U),U};qe(()=>t()?E(t()):[]);const V=qe(()=>{let F=d?.list;if((a().start||a().end)&&(F=F.filter(Y=>{const U=new Date(Y.postingDate),b=a().start?new Date(a().start):new Date("2024-01-01"),g=a().end?new Date(a().end):new Date("2024-12-31");return U>=b&&U<=g})),o()){const Y=o().toLowerCase();F=F.filter(U=>U.description.toLowerCase().includes(Y)||Math.abs(U.amount).toString().includes(Y))}return F}),N=qe(()=>{const F={deposits:{total:0,count:0,byType:new Map,byPayee:new Map},payments:{total:0,count:0,byType:new Map,byPayee:new Map},checks:{total:0,count:0,transactions:[]},transfers:{total:0,count:0,transactions:[]},dailyBalances:new Map,accountsAffected:new Set};return V().forEach(Y=>{const U=w(Y.description);if(console.log({transaction:Y}),F.dailyBalances.set(Y.postingDate,Y.amount),(Y.description.includes("ZELLE")||Y.description.includes("QUICKPAY"))&&F.accountsAffected.add("Zelle Account"),Y.description.includes("ACH")&&F.accountsAffected.add("ACH Network"),Y?.description.includes("DEBIT_CARD")&&F.accountsAffected.add("Debit Card"),Y?.description.includes("CHECK")&&F.accountsAffected.add("Checking Account"),Y?.description.includes("TRANSFER")&&F.accountsAffected.add("Savings Account"),Y.amount>0){F.deposits.total+=Y.amount,F.deposits.count++,F.deposits.byType.has(Y.description)||F.deposits.byType.set(Y.description,{total:0,count:0,transactions:[]});const b=F.deposits.byType.get(Y.description);b.total+=Y.amount,b.count++,b.transactions.push(Y),F.deposits.byPayee.has(U)||F.deposits.byPayee.set(U,{name:U,totalAmount:0,transactionCount:0,transactions:[]});const g=F.deposits.byPayee.get(U);g.totalAmount+=Y.amount,g.transactionCount++,g.transactions.push(Y)}if(Y.amount<0){F.payments.total+=Math.abs(Y.amount),F.payments.count++,F.payments.byType.has(Y.description)||F.payments.byType.set(Y.description,{total:0,count:0,transactions:[]});const b=F.payments.byType.get(Y.description);b.total+=Math.abs(Y.amount),b.count++,b.transactions.push(Y);const g=v(Y.description);F.payments.byPayee.has(U)||F.payments.byPayee.set(U,{name:U,totalAmount:0,transactionCount:0,transactions:[],category:g});const p=F.payments.byPayee.get(U);p.totalAmount+=Math.abs(Y.amount),p.transactionCount++,p.transactions.push(Y)}(Y.type==="CHECK_PAID"||Y.checkNumber)&&(F.checks.total+=Math.abs(Y.amount),F.checks.count++,F.checks.transactions.push(Y)),(Y.description.includes("TRANSFER")||Y.description==="ACCT_XFER")&&(F.transfers.total+=Math.abs(Y.amount),F.transfers.count++,F.transfers.transactions.push(Y))}),console.log(F),F}),x=qe(()=>{const F=new Map;return V().forEach(Y=>{const U=Y.postingDate.substring(0,7);F.has(U)||F.set(U,{deposits:0,payments:0,net:0});const b=F.get(U);Y.amount>0?b.deposits+=Y.amount:b.payments+=Math.abs(Y.amount),b.net=b.deposits-b.payments}),Array.from(F.entries()).sort((Y,U)=>Y[0].localeCompare(U[0]))}),k=F=>{const U=F.target.files?.[0];if(U){const b=new FileReader;b.onload=g=>{console.log(g.target?.result),E(g.target?.result)},b.readAsText(U)}},re=()=>{const F=N();let Y=`# DETAILED BANK STATEMENT ANALYSIS
`;Y+=`Generated: ${new Date().toLocaleDateString()}

`,Y+=`## EXECUTIVE SUMMARY

`,Y+=`- **Total Deposits:** $${F.deposits.total.toFixed(2)} (${F.deposits.count} transactions)
`,Y+=`- **Total Payments:** $${F.payments.total.toFixed(2)} (${F.payments.count} transactions)
`,Y+=`- **Net Cash Flow:** $${(F.deposits.total-F.payments.total).toFixed(2)}
`,Y+=`- **Check Payments:** $${F.checks.total.toFixed(2)} (${F.checks.count} checks)
`,Y+=`- **Transfers:** $${F.transfers.total.toFixed(2)} (${F.transfers.count} transfers)

`,Y+=`## ACCOUNTS AFFECTED

`,F.accountsAffected.forEach(A=>{Y+=`- ${A}
`}),Y+=`
`,Y+=`## DEPOSITS DETAIL

`,Y+=`### By Type
`,F.deposits.byType.forEach((A,m)=>{Y+=`- **${m}**: $${A.total.toFixed(2)} (${A.count} transactions)
`}),Y+=`
### Top Depositors
`,Array.from(F.deposits.byPayee.entries()).sort((A,m)=>m[1].totalAmount-A[1].totalAmount).slice(0,20).forEach(([A,m])=>{Y+=`- **${A}**: $${m.totalAmount.toFixed(2)} (${m.transactionCount} transactions)
`}),Y+=`
## PAYMENTS DETAIL

`,Y+=`### By Type
`,F.payments.byType.forEach((A,m)=>{Y+=`- **${m}**: $${A.total.toFixed(2)} (${A.count} transactions)
`}),Y+=`
### By Category
`;const b=new Map;F.payments.byPayee.forEach(A=>{const m=A.category||"Other";b.set(m,(b.get(m)||0)+A.totalAmount)}),Array.from(b.entries()).sort((A,m)=>m[1]-A[1]).forEach(([A,m])=>{Y+=`- **${A}**: $${m.toFixed(2)}
`}),Y+=`
### Top Payees
`,Array.from(F.payments.byPayee.entries()).sort((A,m)=>m[1].totalAmount-A[1].totalAmount).slice(0,20).forEach(([A,m])=>{Y+=`- **${A}** (${m.category}): $${m.totalAmount.toFixed(2)} (${m.transactionCount} transactions)
`}),Y+=`
## MONTHLY CASH FLOW TREND

`,x().forEach(([A,m])=>{Y+=`- **${A}**: Deposits: $${m.deposits.toFixed(2)} | Payments: $${m.payments.toFixed(2)} | Net: $${m.net.toFixed(2)}
`}),F.checks.transactions.length>0&&(Y+=`
## CHECK PAYMENTS DETAIL

`,F.checks.transactions.forEach(A=>{Y+=`- Check #${A.checkNumber||"N/A"} - ${A.postingDate} - $${Math.abs(A.amount).toFixed(2)}
`}));const p=new Blob([Y],{type:"text/markdown"}),C=URL.createObjectURL(p),S=document.createElement("a");S.href=C,S.download=`detailed_bank_analysis_${new Date().toISOString().split("T")[0]}.md`,S.click(),URL.revokeObjectURL(C)},ae=F=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(F);return(()=>{var F=VE(),Y=F.firstChild;return F.style.setProperty("padding","2rem"),Y.style.setProperty("margin-bottom","2rem"),s(F,_(He,{style:{"margin-bottom":"2rem"},get children(){return[vE(),(()=>{var U=bE();return U.addEventListener("change",k),U.style.setProperty("margin-top","1rem"),U})()]}}),null),s(F,_(De,{get when(){return d?.list},get children(){return[_(He,{style:{"margin-bottom":"2rem"},get children(){return[_E(),(()=>{var U=SE(),b=U.firstChild,g=b.nextSibling,p=g.nextSibling,C=p.nextSibling;return U.style.setProperty("display","flex"),U.style.setProperty("gap","1rem"),U.style.setProperty("margin-top","1rem"),U.style.setProperty("flex-wrap","wrap"),b.$$input=S=>i(S.currentTarget.value),b.style.setProperty("flex","1"),b.style.setProperty("min-width","200px"),b.style.setProperty("padding","0.5rem"),g.$$input=S=>c({...a(),start:S.currentTarget.value}),p.$$input=S=>c({...a(),end:S.currentTarget.value}),C.$$click=re,C.style.setProperty("padding","0.5rem 1rem"),C.style.setProperty("background","var(--primary-color)"),C.style.setProperty("color","white"),C.style.setProperty("border","none"),C.style.setProperty("border-radius","var(--border-radius-sm)"),C.style.setProperty("cursor","pointer"),le(()=>b.value=o()),le(()=>g.value=a().start),le(()=>p.value=a().end),U})()]}}),(()=>{var U=PE(),b=U.firstChild,g=b.nextSibling,p=g.nextSibling,C=p.nextSibling;return U.style.setProperty("display","flex"),U.style.setProperty("gap","1rem"),U.style.setProperty("margin-bottom","2rem"),b.$$click=()=>n("summary"),b.style.setProperty("padding","0.5rem 1rem"),b.style.setProperty("border","none"),b.style.setProperty("border-radius","var(--border-radius-sm)"),b.style.setProperty("cursor","pointer"),g.$$click=()=>n("deposits"),g.style.setProperty("padding","0.5rem 1rem"),g.style.setProperty("border","none"),g.style.setProperty("border-radius","var(--border-radius-sm)"),g.style.setProperty("cursor","pointer"),p.$$click=()=>n("payments"),p.style.setProperty("padding","0.5rem 1rem"),p.style.setProperty("border","none"),p.style.setProperty("border-radius","var(--border-radius-sm)"),p.style.setProperty("cursor","pointer"),C.$$click=()=>n("timeline"),C.style.setProperty("padding","0.5rem 1rem"),C.style.setProperty("border","none"),C.style.setProperty("border-radius","var(--border-radius-sm)"),C.style.setProperty("cursor","pointer"),le(S=>{var A=r()==="summary"?"var(--primary-color)":"#e9ecef",m=r()==="summary"?"white":"black",ne=r()==="deposits"?"var(--primary-color)":"#e9ecef",W=r()==="deposits"?"white":"black",I=r()==="payments"?"var(--primary-color)":"#e9ecef",O=r()==="payments"?"white":"black",J=r()==="timeline"?"var(--primary-color)":"#e9ecef",D=r()==="timeline"?"white":"black";return A!==S.e&&((S.e=A)!=null?b.style.setProperty("background",A):b.style.removeProperty("background")),m!==S.t&&((S.t=m)!=null?b.style.setProperty("color",m):b.style.removeProperty("color")),ne!==S.a&&((S.a=ne)!=null?g.style.setProperty("background",ne):g.style.removeProperty("background")),W!==S.o&&((S.o=W)!=null?g.style.setProperty("color",W):g.style.removeProperty("color")),I!==S.i&&((S.i=I)!=null?p.style.setProperty("background",I):p.style.removeProperty("background")),O!==S.n&&((S.n=O)!=null?p.style.setProperty("color",O):p.style.removeProperty("color")),J!==S.s&&((S.s=J)!=null?C.style.setProperty("background",J):C.style.removeProperty("background")),D!==S.h&&((S.h=D)!=null?C.style.setProperty("color",D):C.style.removeProperty("color")),S},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),U})(),_(De,{get when(){return r()==="summary"},get children(){return[(()=>{var U=Li();return U.style.setProperty("display","grid"),U.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),U.style.setProperty("gap","1rem"),U.style.setProperty("margin-bottom","2rem"),s(U,_(He,{get children(){return[wE(),(()=>{var b=Qs();return b.style.setProperty("font-size","2rem"),b.style.setProperty("font-weight","bold"),b.style.setProperty("color","#22c55e"),s(b,()=>ae(N().deposits.total)),b})(),(()=>{var b=fm(),g=b.firstChild;return b.style.setProperty("color","#6c757d"),s(b,()=>N().deposits.count,g),b})()]}}),null),s(U,_(He,{get children(){return[CE(),(()=>{var b=Qs();return b.style.setProperty("font-size","2rem"),b.style.setProperty("font-weight","bold"),b.style.setProperty("color","#ef4444"),s(b,()=>ae(N().payments.total)),b})(),(()=>{var b=fm(),g=b.firstChild;return b.style.setProperty("color","#6c757d"),s(b,()=>N().payments.count,g),b})()]}}),null),s(U,_(He,{get children(){return[AE(),(()=>{var b=Qs();return b.style.setProperty("font-size","2rem"),b.style.setProperty("font-weight","bold"),s(b,()=>ae(N().deposits.total-N().payments.total)),le(g=>(g=N().deposits.total-N().payments.total>=0?"#22c55e":"#ef4444")!=null?b.style.setProperty("color",g):b.style.removeProperty("color")),b})()]}}),null),s(U,_(He,{get children(){return[xE(),(()=>{var b=Qs();return b.style.setProperty("font-size","2rem"),b.style.setProperty("font-weight","bold"),b.style.setProperty("color","#3b82f6"),s(b,()=>ae(N().checks.total)),b})(),(()=>{var b=IE(),g=b.firstChild;return b.style.setProperty("color","#6c757d"),s(b,()=>N().checks.count,g),b})()]}}),null),U})(),_(He,{style:{"margin-bottom":"2rem"},get children(){return[EE(),(()=>{var U=Li();return U.style.setProperty("display","flex"),U.style.setProperty("flex-wrap","wrap"),U.style.setProperty("gap","0.5rem"),U.style.setProperty("margin-top","1rem"),s(U,_(at,{get each(){return Array.from(N().accountsAffected)},children:b=>(()=>{var g=FE();return g.style.setProperty("padding","0.25rem 0.75rem"),g.style.setProperty("background","#e9ecef"),g.style.setProperty("border-radius","9999px"),g.style.setProperty("font-size","0.875rem"),s(g,b),g})()})),U})()]}}),_(He,{get children(){return[$E(),(()=>{var U=TE(),b=U.firstChild,g=b.firstChild,p=g.firstChild,C=p.firstChild,S=C.nextSibling,A=S.nextSibling,m=A.nextSibling,ne=g.nextSibling;return U.style.setProperty("overflow-x","auto"),b.style.setProperty("width","100%"),b.style.setProperty("border-collapse","collapse"),b.style.setProperty("margin-top","1rem"),p.style.setProperty("border-bottom","2px solid #dee2e6"),C.style.setProperty("padding","0.75rem"),C.style.setProperty("text-align","left"),S.style.setProperty("padding","0.75rem"),S.style.setProperty("text-align","right"),A.style.setProperty("padding","0.75rem"),A.style.setProperty("text-align","right"),m.style.setProperty("padding","0.75rem"),m.style.setProperty("text-align","right"),s(ne,_(at,{get each(){return x()},children:([W,I])=>(()=>{var O=BE(),J=O.firstChild,D=J.nextSibling,T=D.nextSibling,B=T.nextSibling;return O.style.setProperty("border-bottom","1px solid #dee2e6"),J.style.setProperty("padding","0.75rem"),s(J,W),D.style.setProperty("padding","0.75rem"),D.style.setProperty("text-align","right"),D.style.setProperty("color","#22c55e"),s(D,()=>ae(isNaN(I.deposits)?0:I.deposits)),T.style.setProperty("padding","0.75rem"),T.style.setProperty("text-align","right"),T.style.setProperty("color","#ef4444"),s(T,()=>ae(isNaN(I.payments)?0:I.payments)),B.style.setProperty("padding","0.75rem"),B.style.setProperty("text-align","right"),B.style.setProperty("font-weight","bold"),s(B,()=>ae(I.net)),le(me=>(me=I.net>=0?"#22c55e":"#ef4444")!=null?B.style.setProperty("color",me):B.style.removeProperty("color")),O})()})),U})()]}})]}}),_(De,{get when(){return r()==="deposits"},get children(){return[_(He,{style:{"margin-bottom":"2rem"},get children(){return[kE(),(()=>{var U=Li();return U.style.setProperty("display","grid"),U.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(300px, 1fr))"),U.style.setProperty("gap","1rem"),U.style.setProperty("margin-top","1rem"),s(U,_(at,{get each(){return Array.from(N().deposits.byType.entries())},children:([b,g])=>(()=>{var p=pm(),C=p.firstChild,S=C.nextSibling,A=S.nextSibling,m=A.firstChild;return p.style.setProperty("padding","1rem"),p.style.setProperty("background","#f8f9fa"),p.style.setProperty("border-radius","var(--border-radius-sm)"),p.style.setProperty("border","1px solid #e9ecef"),s(C,b),S.style.setProperty("font-size","1.5rem"),S.style.setProperty("font-weight","bold"),S.style.setProperty("color","#22c55e"),s(S,()=>ae(g.total)),A.style.setProperty("color","#6c757d"),s(A,()=>g.count,m),p})()})),U})()]}}),_(He,{get children(){return[RE(),(()=>{var U=DE(),b=U.firstChild,g=b.firstChild,p=g.firstChild,C=p.firstChild,S=C.nextSibling,A=S.nextSibling,m=A.nextSibling,ne=g.nextSibling;return U.style.setProperty("overflow-x","auto"),b.style.setProperty("width","100%"),b.style.setProperty("border-collapse","collapse"),b.style.setProperty("margin-top","1rem"),p.style.setProperty("border-bottom","2px solid #dee2e6"),C.style.setProperty("padding","0.75rem"),C.style.setProperty("text-align","left"),S.style.setProperty("padding","0.75rem"),S.style.setProperty("text-align","right"),A.style.setProperty("padding","0.75rem"),A.style.setProperty("text-align","center"),m.style.setProperty("padding","0.75rem"),m.style.setProperty("text-align","center"),s(ne,_(at,{get each(){return Array.from(N().deposits.byPayee.entries()).sort((W,I)=>I[1].totalAmount-W[1].totalAmount).slice(0,20)},children:([W,I])=>(()=>{var O=UE(),J=O.firstChild,D=J.nextSibling,T=D.nextSibling,B=T.nextSibling,me=B.firstChild,H=me.firstChild,de=H.nextSibling;return O.style.setProperty("border-bottom","1px solid #dee2e6"),J.style.setProperty("padding","0.75rem"),s(J,W),D.style.setProperty("padding","0.75rem"),D.style.setProperty("text-align","right"),D.style.setProperty("color","#22c55e"),D.style.setProperty("font-weight","bold"),s(D,()=>ae(I.totalAmount)),T.style.setProperty("padding","0.75rem"),T.style.setProperty("text-align","center"),s(T,()=>I.transactionCount),B.style.setProperty("padding","0.75rem"),B.style.setProperty("text-align","center"),H.style.setProperty("cursor","pointer"),de.style.setProperty("margin-top","0.5rem"),de.style.setProperty("font-size","0.875rem"),s(de,_(at,{get each(){return I.transactions.slice(0,5)},children:$=>(()=>{var q=jE(),Z=q.firstChild;return q.style.setProperty("padding","0.25rem"),s(q,()=>$.postingDate,Z),s(q,()=>ae($.amount),null),q})()})),O})()})),U})()]}})]}}),_(De,{get when(){return r()==="payments"},get children(){return[_(He,{style:{"margin-bottom":"2rem"},get children(){return[NE(),(()=>{var U=Li();return U.style.setProperty("display","grid"),U.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),U.style.setProperty("gap","1rem"),U.style.setProperty("margin-top","1rem"),s(U,()=>{const b=new Map;return N().payments.byPayee.forEach(g=>{const p=g.category||"Other";b.has(p)||b.set(p,{total:0,count:0});const C=b.get(p);C.total+=g.totalAmount,C.count+=g.transactionCount}),Array.from(b.entries()).sort((g,p)=>p[1].total-g[1].total).map(([g,p])=>(()=>{var C=pm(),S=C.firstChild,A=S.nextSibling,m=A.nextSibling,ne=m.firstChild;return C.style.setProperty("padding","1rem"),C.style.setProperty("background","#f8f9fa"),C.style.setProperty("border-radius","var(--border-radius-sm)"),C.style.setProperty("border","1px solid #e9ecef"),s(S,g),A.style.setProperty("font-size","1.5rem"),A.style.setProperty("font-weight","bold"),A.style.setProperty("color","#ef4444"),s(A,()=>ae(p.total)),m.style.setProperty("color","#6c757d"),s(m,()=>p.count,ne),C})())}),U})()]}}),_(He,{get children(){return[LE(),(()=>{var U=ME(),b=U.firstChild,g=b.firstChild,p=g.firstChild,C=p.firstChild,S=C.nextSibling,A=S.nextSibling,m=A.nextSibling,ne=g.nextSibling;return U.style.setProperty("overflow-x","auto"),b.style.setProperty("width","100%"),b.style.setProperty("border-collapse","collapse"),b.style.setProperty("margin-top","1rem"),p.style.setProperty("border-bottom","2px solid #dee2e6"),C.style.setProperty("padding","0.75rem"),C.style.setProperty("text-align","left"),S.style.setProperty("padding","0.75rem"),S.style.setProperty("text-align","left"),A.style.setProperty("padding","0.75rem"),A.style.setProperty("text-align","right"),m.style.setProperty("padding","0.75rem"),m.style.setProperty("text-align","center"),s(ne,_(at,{get each(){return Array.from(N().payments.byPayee.entries()).sort((W,I)=>I[1].totalAmount-W[1].totalAmount).slice(0,130)},children:([W,I])=>(()=>{var O=zE(),J=O.firstChild,D=J.nextSibling,T=D.firstChild,B=D.nextSibling,me=B.nextSibling;return O.style.setProperty("border-bottom","1px solid #dee2e6"),J.style.setProperty("padding","0.75rem"),s(J,W),D.style.setProperty("padding","0.75rem"),T.style.setProperty("padding","0.25rem 0.5rem"),T.style.setProperty("background","#e9ecef"),T.style.setProperty("border-radius","4px"),T.style.setProperty("font-size","0.875rem"),s(T,()=>I.category),B.style.setProperty("padding","0.75rem"),B.style.setProperty("text-align","right"),B.style.setProperty("color","#ef4444"),B.style.setProperty("font-weight","bold"),s(B,()=>ae(I.totalAmount)),me.style.setProperty("padding","0.75rem"),me.style.setProperty("text-align","center"),s(me,()=>I.transactionCount),O})()})),U})()]}})]}}),_(De,{get when(){return r()==="timeline"},get children(){return _(He,{get children(){return[OE(),(()=>{var U=Li();return U.style.setProperty("max-height","600px"),U.style.setProperty("overflow-y","auto"),U.style.setProperty("margin-top","1rem"),s(U,_(at,{get each(){return V().slice(0,100)},children:b=>(()=>{var g=qE(),p=g.firstChild,C=p.firstChild,S=C.nextSibling,A=S.firstChild,m=p.nextSibling,ne=m.firstChild;return g.style.setProperty("padding","1rem"),g.style.setProperty("border-bottom","1px solid #e9ecef"),g.style.setProperty("display","flex"),g.style.setProperty("justify-content","space-between"),g.style.setProperty("align-items","center"),p.style.setProperty("flex","1"),C.style.setProperty("font-weight","bold"),s(C,()=>b.description),S.style.setProperty("font-size","0.875rem"),S.style.setProperty("color","#6c757d"),s(S,()=>b.postingDate,A),s(S,()=>b.type,null),s(S,()=>b.checkNumber&&`  Check #${b.checkNumber}`,null),m.style.setProperty("text-align","right"),ne.style.setProperty("font-weight","bold"),ne.style.setProperty("font-size","1.1rem"),s(ne,()=>ae(Math.abs(b.amount)),null),s(ne,()=>b.amount>=0?" ":" ",null),le(W=>(W=b.amount>=0?"#22c55e":"#ef4444")!=null?ne.style.setProperty("color",W):ne.style.removeProperty("color")),g})()})),U})()]}})}})]}}),null),F})()};Pt(["input","click"]);var HE=G("<div><div></div><div>"),Vl=G("<div>"),WE=G("<div>  <!>  <!> "),YE=G("<div><div><div></div><div></div></div><div><div></div><div>"),KE=G("<div><div>:"),QE=G("<div> <!>: <!> <!>, <!> "),JE=G("<div><div><div></div><div></div></div><div>"),gm=G("<div> "),XE=G("<div> ");const ZE=t=>{const{t:e}=ct(),r={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},n={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},o={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},i={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)","margin-bottom":"0.5rem"},a={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"1rem"},c={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},d={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},h={"max-height":"100px","overflow-y":"auto","border-top":"1px solid var(--border-color)","padding-top":"1rem"},y={display:"flex","justify-content":"space-between","align-items":"center","font-size":"0.875rem","margin-bottom":"0.5rem"},v={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},w=k=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[k],E=k=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(k),V=k=>new Date(k).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),N=w(t.entry.status),x=Math.abs(t.entry.totalDebit-t.entry.totalCredit)<.01;return _(He,{get children(){return[(()=>{var k=HE(),re=k.firstChild,ae=re.nextSibling;return u(k,r),u(re,n),s(re,()=>t.entry.entryNumber),s(ae,()=>t.entry.status),le(F=>u(ae,{...o,background:N.bg,color:N.color},F)),k})(),(()=>{var k=Vl();return u(k,i),s(k,()=>t.entry.description),k})(),(()=>{var k=WE(),re=k.firstChild,ae=re.nextSibling,F=ae.nextSibling,Y=F.nextSibling;return Y.nextSibling,u(k,a),s(k,()=>V(t.entry.date),re),s(k,()=>t.entry.reference||e("journal.noReference","No reference"),ae),s(k,()=>e("journal.createdBy","By"),Y),s(k,()=>t.entry.createdBy,null),k})(),(()=>{var k=YE(),re=k.firstChild,ae=re.firstChild,F=ae.nextSibling,Y=re.nextSibling,U=Y.firstChild,b=U.nextSibling;return u(k,c),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),s(ae,()=>e("journal.totalAmount","Total Amount")),u(F,d),s(F,()=>E(t.entry.totalDebit)),Y.style.setProperty("text-align","right"),U.style.setProperty("font-size","0.875rem"),U.style.setProperty("color","var(--text-muted)"),s(U,()=>e("journal.lines","Lines")),b.style.setProperty("font-weight","600"),s(b,()=>t.entry.lines.length),k})(),ge(()=>!x&&(()=>{var k=QE(),re=k.firstChild,ae=re.nextSibling,F=ae.nextSibling,Y=F.nextSibling,U=Y.nextSibling,b=U.nextSibling,g=b.nextSibling,p=g.nextSibling;return p.nextSibling,k.style.setProperty("padding","0.5rem"),k.style.setProperty("border-radius","var(--border-radius-sm)"),k.style.setProperty("background","#f8d7da"),k.style.setProperty("color","#721c24"),k.style.setProperty("font-size","0.875rem"),k.style.setProperty("margin-bottom","1rem"),s(k,()=>e("journal.entryNotBalancedShort","Entry is not balanced"),ae),s(k,()=>e("journal.debit"),Y),s(k,()=>E(t.entry.totalDebit),b),s(k,()=>e("journal.credit"),p),s(k,()=>E(t.entry.totalCredit),null),k})()),(()=>{var k=KE(),re=k.firstChild,ae=re.firstChild;return u(k,h),re.style.setProperty("font-weight","500"),re.style.setProperty("margin-bottom","0.5rem"),re.style.setProperty("font-size","0.875rem"),s(re,()=>e("journal.accountLines","Account Lines"),ae),s(k,()=>t.entry.lines.slice(0,3).map(F=>(()=>{var Y=JE(),U=Y.firstChild,b=U.firstChild,g=b.nextSibling,p=U.nextSibling;return u(Y,y),U.style.setProperty("flex","1"),b.style.setProperty("font-weight","500"),s(b,()=>F.accountName),g.style.setProperty("font-size","0.75rem"),g.style.setProperty("color","var(--text-muted)"),s(g,()=>F.description||e("journal.noDescription","No description")),p.style.setProperty("text-align","right"),s(p,(()=>{var C=ge(()=>F.debitAmount>0);return()=>C()&&(()=>{var S=gm(),A=S.firstChild;return S.style.setProperty("color","#4caf50"),S.style.setProperty("font-weight","500"),s(S,()=>e("journal.debitShort","Dr."),A),s(S,()=>E(F.debitAmount),null),S})()})(),null),s(p,(()=>{var C=ge(()=>F.creditAmount>0);return()=>C()&&(()=>{var S=gm(),A=S.firstChild;return S.style.setProperty("color","#f44336"),S.style.setProperty("font-weight","500"),s(S,()=>e("journal.creditShort","Cr."),A),s(S,()=>E(F.creditAmount),null),S})()})(),null),s(p,(()=>{var C=ge(()=>!!F.reconciled);return()=>C()&&(()=>{var S=XE();return S.firstChild,S.style.setProperty("font-size","0.75rem"),S.style.setProperty("color","#4caf50"),s(S,()=>e("banking.reconciled","Reconciled"),null),S})()})(),null),Y})()),null),s(k,(()=>{var F=ge(()=>t.entry.lines.length>3);return()=>F()&&(()=>{var Y=Vl();return Y.style.setProperty("text-align","center"),Y.style.setProperty("color","var(--text-muted)"),Y.style.setProperty("font-size","0.875rem"),s(Y,()=>e("journal.andMoreLines","... and {count} more lines").replace("{count}",(t.entry.lines.length-3).toString())),Y})()})(),null),k})(),(()=>{var k=Vl();return u(k,v),s(k,_(Le,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.entry),get children(){return e("journal.viewDetails","View Details")}})),k})()]}})},e2=[{id:"je1",entryNumber:"JE-2024-001",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",status:"posted",createdBy:"John Doe",createdAt:"2024-01-15T09:00:00Z",postedAt:"2024-01-15T09:05:00Z",totalDebit:5e3,totalCredit:5e3,lines:[{id:"jel1",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment from ABC Corp",debitAmount:5e3,creditAmount:0,reconciled:!0,reconciledWith:"eb1"},{id:"jel2",accountId:"2001",accountName:"Trade Receivables",description:"Payment received for INV-2024-001",debitAmount:0,creditAmount:5e3}]},{id:"je2",entryNumber:"JE-2024-002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",status:"posted",createdBy:"Jane Smith",createdAt:"2024-01-14T10:00:00Z",postedAt:"2024-01-14T10:15:00Z",totalDebit:250,totalCredit:250,lines:[{id:"jel3",accountId:"5200",accountName:"Office Expenses",description:"Office supplies from Staples",debitAmount:250,creditAmount:0},{id:"jel4",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment to Staples",debitAmount:0,creditAmount:250,reconciled:!0,reconciledWith:"eb2"}]},{id:"je3",entryNumber:"JE-2024-003",date:"2024-01-13",description:"Monthly Rent Payment",reference:"RENT-2024-01",status:"posted",createdBy:"John Doe",createdAt:"2024-01-13T08:00:00Z",postedAt:"2024-01-13T08:30:00Z",totalDebit:2e3,totalCredit:2e3,lines:[{id:"jel5",accountId:"5200",accountName:"Rent Expense",description:"January office rent",debitAmount:2e3,creditAmount:0},{id:"jel6",accountId:"1002",accountName:"Bank - Checking Account",description:"Rent payment",debitAmount:0,creditAmount:2e3,reconciled:!1}]},{id:"je4",entryNumber:"JE-2024-004",date:"2024-01-12",description:"Wire Transfer - Capital Investment",reference:"WIRE-001",status:"posted",createdBy:"Admin",createdAt:"2024-01-12T14:00:00Z",postedAt:"2024-01-12T14:30:00Z",totalDebit:1e4,totalCredit:1e4,lines:[{id:"jel7",accountId:"1002",accountName:"Bank - Checking Account",description:"Wire transfer received",debitAmount:1e4,creditAmount:0,reconciled:!1},{id:"jel8",accountId:"8",accountName:"Owner's Equity",description:"Capital investment",debitAmount:0,creditAmount:1e4}]},{id:"je5",entryNumber:"JE-2024-005",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",status:"posted",createdBy:"HR Manager",createdAt:"2024-01-11T16:00:00Z",postedAt:"2024-01-11T16:30:00Z",totalDebit:3500,totalCredit:3500,lines:[{id:"jel9",accountId:"13",accountName:"Salaries Expense",description:"Monthly salary - John Doe",debitAmount:3500,creditAmount:0},{id:"jel10",accountId:"1002",accountName:"Bank - Checking Account",description:"Salary payment",debitAmount:0,creditAmount:3500,reconciled:!1}]},{id:"je6",entryNumber:"JE-2024-006",date:"2024-01-10",description:"Product Sales - Multiple Customers",reference:"SALES-2024-010",status:"posted",createdBy:"Sales Manager",createdAt:"2024-01-10T11:00:00Z",postedAt:"2024-01-10T11:30:00Z",totalDebit:8500,totalCredit:8500,lines:[{id:"jel11",accountId:"1001",accountName:"Petty Cash",description:"Cash sales",debitAmount:1500,creditAmount:0},{id:"jel12",accountId:"2001",accountName:"Trade Receivables",description:"Credit sales",debitAmount:7e3,creditAmount:0},{id:"jel13",accountId:"10",accountName:"Sales Revenue",description:"Product sales revenue",debitAmount:0,creditAmount:8500}]},{id:"je7",entryNumber:"JE-2024-007",date:"2024-01-09",description:"Inventory Purchase",reference:"PO-2024-002",status:"draft",createdBy:"Warehouse Manager",createdAt:"2024-01-09T15:00:00Z",totalDebit:15e3,totalCredit:15e3,lines:[{id:"jel14",accountId:"3",accountName:"Inventory",description:"Product inventory purchase",debitAmount:15e3,creditAmount:0},{id:"jel15",accountId:"5",accountName:"Accounts Payable",description:"Amount owed to supplier",debitAmount:0,creditAmount:15e3}]},{id:"je8",entryNumber:"JE-2024-008",date:"2024-01-08",description:"Utility Bills Payment",reference:"UTIL-2024-01",status:"posted",createdBy:"Admin",createdAt:"2024-01-08T09:00:00Z",postedAt:"2024-01-08T09:30:00Z",totalDebit:450,totalCredit:450,lines:[{id:"jel16",accountId:"14",accountName:"Operating Expenses",description:"Electricity and water bills",debitAmount:450,creditAmount:0},{id:"jel17",accountId:"1003",accountName:"Bank - Savings Account",description:"Utility payment",debitAmount:0,creditAmount:450}]}],[Mr,Fl]=ve(e2),vm=()=>Mr().filter(e=>e.status==="posted").flatMap(e=>e.lines.filter(r=>["1001","1002","1003"].includes(r.accountId))).map(e=>{const r=Mr().find(n=>n.lines.some(o=>o.id===e.id));return r?{id:`eb_${e.id}`,accountId:e.accountId,date:r.date,description:r.description,reference:r.reference,debitAmount:e.debitAmount,creditAmount:e.creditAmount,category:e.accountName,isReconciled:e.reconciled||!1,reconciledWith:e.reconciledWith,createdAt:r.createdAt}:null}).filter(e=>e!==null),xn={get journalEntries(){return Mr()},addJournalEntry(t){const e={...t,id:Date.now().toString()};return Fl([...Mr(),e]),e},updateJournalEntry(t,e){Fl(Mr().map(r=>r.id===t?{...r,...e}:r))},deleteJournalEntry(t){const e=Mr().find(r=>r.id===t);if(e&&e.status==="posted")throw new Error("Cannot delete posted journal entries. Void them instead.");Fl(Mr().filter(r=>r.id!==t))},voidJournalEntry(t){this.updateJournalEntry(t,{status:"void"})},postJournalEntry(t){const e=Mr().find(r=>r.id===t);if(!e)throw new Error("Journal entry not found");if(Math.abs(e.totalDebit-e.totalCredit)>.01)throw new Error("Journal entry is not balanced. Debits must equal credits.");this.updateJournalEntry(t,{status:"posted",postedAt:new Date().toISOString()}),vm()},getJournalEntryById(t){return Mr().find(e=>e.id===t)},getJournalEntriesByStatus(t){return Mr().filter(e=>e.status===t)},getJournalEntriesByDateRange(t,e){return Mr().filter(r=>r.date>=t&&r.date<=e)},getJournalEntriesByAccount(t){return Mr().filter(e=>e.lines.some(r=>r.accountId===t))},getNextEntryNumber(){const t=new Date().getFullYear(),r=Mr().filter(n=>n.entryNumber.includes(t.toString())).reduce((n,o)=>{const i=parseInt(o.entryNumber.split("-").pop()||"0");return i>n?i:n},0);return`JE-${t}-${String(r+1).padStart(3,"0")}`},validateJournalEntry(t){const e=[];if(t.date||e.push("Date is required"),t.description||e.push("Description is required"),(!t.lines||t.lines.length===0)&&e.push("At least one line item is required"),t.lines){const r=t.lines.reduce((o,i)=>o+(i.debitAmount||0),0),n=t.lines.reduce((o,i)=>o+(i.creditAmount||0),0);Math.abs(r-n)>.01&&e.push(`Entry is not balanced. Debit: ${r}, Credit: ${n}`),t.lines.forEach((o,i)=>{o.accountId||e.push(`Line ${i+1}: Account is required`),o.debitAmount===0&&o.creditAmount===0&&e.push(`Line ${i+1}: Either debit or credit amount must be provided`),o.debitAmount>0&&o.creditAmount>0&&e.push(`Line ${i+1}: Cannot have both debit and credit amounts`)})}return{isValid:e.length===0,errors:e}},getBankRelatedEntries(){return vm()}};var t2=G("<form><div></div><div><div><h4></h4></div><div><div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div></div></div><div><div><strong>: </strong></div><div><strong>: </strong></div><div></div></div></div><div>"),bm=G("<div>");const Rp=t=>{const{t:e}=ct(),[r,n]=ve({entryNumber:"",date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),[o,i]=ve([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),[a,c]=ve(null);Nn(()=>{if(t.isOpen){if(t.editEntry)n({entryNumber:t.editEntry.entryNumber,date:t.editEntry.date,description:t.editEntry.description,reference:t.editEntry.reference,createdBy:t.editEntry.createdBy}),i(t.editEntry.lines.map((F,Y)=>({...F,tempId:`line_${Date.now()}_${Y}`})));else{const F=xn.getNextEntryNumber();n({entryNumber:F,date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),i([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])}c(null)}});const d={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},h={display:"grid","grid-template-columns":"2fr 2fr 1fr 1fr 1fr",gap:"1rem","align-items":"end","margin-bottom":"1rem",padding:"1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},y={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},v=()=>wt.accounts.map(F=>({value:F.id,label:`${F.accountNumber} - ${F.name}`})),w=(F,Y)=>{n(U=>({...U,[F]:Y}))},E=(F,Y,U)=>{i(b=>b.map(g=>{if(g.tempId===F){const p={...g,[Y]:U};if(Y==="accountId"&&typeof U=="string"){const C=wt.getAccountById(U);C&&(p.accountName=C.name)}return p}return g}))},V=()=>{i(F=>[...F,{tempId:`line_${Date.now()}_${F.length}`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])},N=F=>{o().length>2&&i(Y=>Y.filter(U=>U.tempId!==F))},x=()=>{const F=o().reduce((U,b)=>U+(b.debitAmount||0),0),Y=o().reduce((U,b)=>U+(b.creditAmount||0),0);return{totalDebit:F,totalCredit:Y,isBalanced:Math.abs(F-Y)<.01}},k=F=>{F.preventDefault(),c(null);const Y=r(),U=o(),{totalDebit:b,totalCredit:g,isBalanced:p}=x();if(!Y.description){c(e("forms.descriptionRequired","Description is required"));return}if(U.length<2){c(e("journal.minTwoLinesRequired","At least 2 line items are required"));return}if(!p){c(e("journal.entryNotBalanced","Entry is not balanced. Debit: ${debit}, Credit: ${credit}").replace("${debit}",`$${b.toFixed(2)}`).replace("${credit}",`$${g.toFixed(2)}`));return}for(let S=0;S<U.length;S++){const A=U[S];if(!A.accountId){c(e("journal.lineAccountRequired","Line {lineNumber}: Account is required").replace("{lineNumber}",(S+1).toString()));return}if(A.debitAmount===0&&A.creditAmount===0){c(e("journal.lineAmountRequired","Line {lineNumber}: Either debit or credit amount must be provided").replace("{lineNumber}",(S+1).toString()));return}if((A.debitAmount||0)>0&&(A.creditAmount||0)>0){c(e("journal.lineBothAmounts","Line {lineNumber}: Cannot have both debit and credit amounts").replace("{lineNumber}",(S+1).toString()));return}}const C={entryNumber:Y.entryNumber,date:Y.date,description:Y.description,reference:Y.reference,status:"draft",createdBy:Y.createdBy,createdAt:new Date().toISOString(),totalDebit:b,totalCredit:g,lines:U.map((S,A)=>{const{tempId:m,...ne}=S;return{id:`jel_${Date.now()}_${A}`,...ne}})};try{t.editEntry?xn.updateJournalEntry(t.editEntry.id,C):xn.addJournalEntry(C),n({entryNumber:xn.getNextEntryNumber(),date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),i([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),t.onClose()}catch(S){c(S instanceof Error?S.message:e("forms.errorOccurred","An error occurred"))}},re=F=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(F),ae=x();return _(_r,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return ge(()=>!!t.editEntry)()?e("journal.editEntry"):e("journal.addEntry","Add Journal Entry")},get children(){var F=t2(),Y=F.firstChild,U=Y.nextSibling,b=U.firstChild,g=b.firstChild,p=b.nextSibling,C=p.firstChild,S=C.firstChild,A=S.firstChild,m=S.nextSibling,ne=m.firstChild,W=m.nextSibling,I=W.firstChild,O=W.nextSibling,J=O.firstChild,D=O.nextSibling,T=D.firstChild,B=p.nextSibling,me=B.firstChild,H=me.firstChild,de=H.firstChild,$=me.nextSibling,q=$.firstChild,Z=q.firstChild,L=$.nextSibling,te=U.nextSibling;return F.addEventListener("submit",k),Y.style.setProperty("display","grid"),Y.style.setProperty("grid-template-columns","1fr 1fr"),Y.style.setProperty("gap","1rem"),s(Y,_(Ot,{get label(){return e("journal.entryNumber")},get value(){return r().entryNumber},onChange:j=>w("entryNumber",j),get disabled(){return!!t.editEntry},required:!0}),null),s(Y,_(Ot,{get label(){return e("common.date")},type:"date",get value(){return r().date},onChange:j=>w("date",j),required:!0}),null),s(F,_(Ot,{get label(){return e("common.description")},get value(){return r().description},onChange:j=>w("description",j),get placeholder(){return e("journal.enterEntryDescription","Enter journal entry description")},required:!0}),U),s(F,_(Ot,{get label(){return e("journal.reference")},get value(){return r().reference},onChange:j=>w("reference",j),get placeholder(){return e("journal.enterReferenceNumber","Enter reference number")}}),U),U.style.setProperty("margin-top","2rem"),b.style.setProperty("display","flex"),b.style.setProperty("justify-content","space-between"),b.style.setProperty("align-items","center"),b.style.setProperty("margin-bottom","1rem"),g.style.setProperty("margin","0"),s(g,()=>e("journal.entryLines","Journal Entry Lines")),s(b,_(Le,{type:"button",variant:"secondary",size:"sm",onClick:V,get children(){return e("journal.addLine","Add Line")}}),null),p.style.setProperty("margin-bottom","1rem"),p.style.setProperty("font-size","0.875rem"),p.style.setProperty("color","var(--text-muted)"),C.style.setProperty("display","grid"),C.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1fr"),C.style.setProperty("gap","1rem"),s(A,()=>e("journal.account")),s(ne,()=>e("common.description")),s(I,()=>e("journal.debit")),s(J,()=>e("journal.credit")),s(T,()=>e("common.actions")),s(U,_(at,{get each(){return o()},children:j=>(()=>{var M=bm();return u(M,h),s(M,_(gr,{label:"",get value(){return j.accountId||""},onChange:ie=>E(j.tempId,"accountId",ie),get options(){return v()}}),null),s(M,_(Ot,{label:"",get value(){return j.description||""},onChange:ie=>E(j.tempId,"description",ie),get placeholder(){return e("journal.lineDescription","Line description")}}),null),s(M,_(Ot,{label:"",type:"number",get value(){return j.debitAmount?.toString()||"0"},onChange:ie=>{E(j.tempId,"debitAmount",parseFloat(ie)||0),parseFloat(ie)>0&&E(j.tempId,"creditAmount",0)},placeholder:"0.00"}),null),s(M,_(Ot,{label:"",type:"number",get value(){return j.creditAmount?.toString()||"0"},onChange:ie=>{E(j.tempId,"creditAmount",parseFloat(ie)||0),parseFloat(ie)>0&&E(j.tempId,"debitAmount",0)},placeholder:"0.00"}),null),s(M,_(Le,{type:"button",variant:"outline",size:"sm",onClick:()=>N(j.tempId),get disabled(){return o().length<=2},get children(){return e("common.remove","Remove")}}),null),M})()}),B),u(B,y),s(H,()=>e("journal.totalDebit","Total Debit"),de),s(H,()=>re(ae.totalDebit),null),s(q,()=>e("journal.totalCredit","Total Credit"),Z),s(q,()=>re(ae.totalCredit),null),L.style.setProperty("font-weight","600"),s(L,(()=>{var j=ge(()=>!!ae.isBalanced);return()=>j()?` ${e("journal.balanced")}`:` ${e("journal.notBalanced","Not Balanced")}`})()),s(F,(()=>{var j=ge(()=>!!a());return()=>j()&&(()=>{var M=bm();return M.style.setProperty("padding","1rem"),M.style.setProperty("border-radius","var(--border-radius-sm)"),M.style.setProperty("margin-top","1rem"),M.style.setProperty("background","#f8d7da"),M.style.setProperty("color","#721c24"),M.style.setProperty("border","1px solid #f5c6cb"),s(M,a),M})()})(),te),u(te,d),s(te,_(Le,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(te,_(Le,{variant:"primary",type:"submit",get disabled(){return!ae.isBalanced},get children(){return ge(()=>!!t.editEntry)()?e("journal.updateEntry","Update Entry"):e("journal.saveAsDraft","Save as Draft")}}),null),le(j=>(j=ae.isBalanced?"#4caf50":"#f44336")!=null?L.style.setProperty("color",j):L.style.removeProperty("color")),F}})};var r2=G("<div><div></div><div></div><div></div><div>"),n2=G("<div><div></div><div></div><div></div><div></div><div>"),o2=G("<div><button></button><button> (<!>)</button><button> (<!>/<!>)"),_m=G("<div>"),i2=G("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><div><h4></h4><div></div></div><div>"),Bl=G("<div><span></span><span>"),Ul=G("<div><strong>:</strong> "),s2=G("<div><div><div></div><div></div><div></div><div></div><div></div></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div></div></div><div><div><strong> Reconciliation Summary</strong></div><div><div><div><strong>Total Lines:</strong> </div><div><strong>Reconciled:</strong> </div><div><strong>Unreconciled:</strong> </div></div><div><div><strong>Bank Accounts:</strong> </div><div><strong>Bank Reconciled:</strong> "),a2=G("<div><div><div></div><div></div></div><div></div><div></div><div></div><div>"),l2=G("<div><span> "),c2=G("<span>(<!>)"),u2=G("<div><strong>Bank Pending:</strong> "),d2=G("<div><div>Reconciled Lines:"),h2=G("<div><div> Pending Bank Reconciliation:</div><div>Visit Bank Consolidations to reconcile these transactions"),m2=G("<div><div><div><span></span><h3></h3></div><div><div><div></div><div>Total Lines</div></div><div><div></div><div>Reconciled</div></div><div><div></div><div>Pending"),y2=G("<div><h4> Reconciled Lines (<!>)"),f2=G("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div> Matched"),p2=G("<div> "),g2=G("<div><h4> Unreconciled Lines (<!>)"),v2=G("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div> Pending"),b2=G("<div>Bank account"),_2=G("<div><div> Reconciliation Tip</div><div>This entry has unreconciled bank account transactions. Visit <strong>Bank Consolidations</strong> to match these with bank statements.");const S2=t=>{const{t:e}=ct(),[r,n]=ve("details"),[o,i]=ve(!1),a=qe(()=>t.entryId?xn.getJournalEntryById(t.entryId):null),c={"text-align":"center","margin-bottom":"2rem",position:"relative"},d={position:"absolute",top:"0",right:"0",display:"flex",gap:"0.5rem"},h={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","margin-bottom":"0.5rem"},y={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},v={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},w={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem",display:"inline-block"},E={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},V={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},N={"font-weight":"600",color:"var(--text-primary)"},x={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},k=m=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:m?"var(--primary-color)":"var(--text-muted)","border-bottom":m?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),re={display:"grid","grid-template-columns":"2fr 2.5fr 1fr 1fr 1.5fr",gap:"1rem",padding:"1rem 0","border-bottom":"1px solid var(--border-color)","align-items":"center"},ae={...re,"font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","border-bottom":"2px solid var(--border-color)"},F={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},Y={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},U=m=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[m],b=m=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(m),g=m=>new Date(m).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),p=m=>new Date(m).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),C=()=>{entry.status==="posted"&&!confirm(e("journal.confirmEditPosted","This entry has been posted. Editing will create a new draft copy. Continue?"))||i(!0)},S=()=>{if(a()&&confirm(e("journal.confirmPost","Are you sure you want to post this journal entry? This action cannot be undone.")))try{xn.postJournalEntry(a().id)}catch(m){alert(m instanceof Error?m.message:e("forms.errorPostingEntry","An error occurred while posting the entry"))}},A=()=>{a()&&confirm(e("journal.confirmVoid","Are you sure you want to void this journal entry?"))&&xn.voidJournalEntry(a().id)};return[_(_r,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.entryDetails","Journal Entry Details")},get children(){return ge(()=>!a())()?(()=>{var m=r2(),ne=m.firstChild,W=ne.nextSibling,I=W.nextSibling,O=I.nextSibling;return m.style.setProperty("text-align","center"),m.style.setProperty("padding","3rem"),m.style.setProperty("color","var(--text-muted)"),ne.style.setProperty("font-size","1.5rem"),ne.style.setProperty("margin-bottom","1rem"),W.style.setProperty("font-size","1.1rem"),W.style.setProperty("margin-bottom","0.5rem"),s(W,()=>e("journal.entryNotFound","Entry Not Found")),I.style.setProperty("font-size","0.875rem"),s(I,()=>e("journal.entryNotFoundMessage","The journal entry you're looking for could not be found or may have been deleted.")),O.style.setProperty("margin-top","2rem"),s(O,_(Le,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),m})():(()=>{const m=a(),ne=U(m.status),W=Math.abs(m.totalDebit-m.totalCredit)<.01;return[(()=>{var I=n2(),O=I.firstChild,J=O.nextSibling,D=J.nextSibling,T=D.nextSibling,B=T.nextSibling;return u(I,c),s(O,_(Le,{variant:"outline",size:"sm",onClick:C,get title(){return e("journal.editEntryTooltip","Edit this journal entry")},get children(){return e("common.edit")}}),null),s(O,(()=>{var me=ge(()=>m.status==="draft");return()=>me()&&_(Le,{variant:"primary",size:"sm",onClick:S,disabled:!W,get title(){return W?e("journal.postEntryTooltip","Post this journal entry"):e("journal.entryMustBeBalanced","Entry must be balanced to post")},get children(){return e("journal.post","Post")}})})(),null),s(O,(()=>{var me=ge(()=>m.status==="posted");return()=>me()&&_(Le,{variant:"outline",size:"sm",onClick:A,style:{color:"#dc3545","border-color":"#dc3545"},get title(){return e("journal.voidEntryTooltip","Void this journal entry")},get children(){return e("entryBooks.void","Void")}})})(),null),u(J,h),s(J,()=>m.entryNumber),u(D,y),s(D,()=>m.description),u(T,v),s(T,()=>b(m.totalDebit)),s(B,()=>m.status),le(me=>{var H=d,de={...w,background:ne.bg,color:ne.color};return me.e=u(O,H,me.e),me.t=u(B,de,me.t),me},{e:void 0,t:void 0}),I})(),(()=>{var I=o2(),O=I.firstChild,J=O.nextSibling,D=J.firstChild,T=D.nextSibling;T.nextSibling;var B=J.nextSibling,me=B.firstChild,H=me.nextSibling,de=H.nextSibling,$=de.nextSibling;return $.nextSibling,u(I,x),O.$$click=()=>n("details"),s(O,()=>e("common.details")),J.$$click=()=>n("lines"),s(J,()=>e("journal.journalLines","Journal Lines"),D),s(J,()=>m.lines.length,T),B.$$click=()=>n("reconciliation"),s(B,()=>e("banking.reconciliation","Reconciliation"),me),s(B,()=>m.lines.filter(q=>q.reconciled).length,H),s(B,()=>m.lines.length,$),le(q=>{var Z=k(r()==="details"),L=k(r()==="lines"),te=k(r()==="reconciliation");return q.e=u(O,Z,q.e),q.t=u(J,L,q.t),q.a=u(B,te,q.a),q},{e:void 0,t:void 0,a:void 0}),I})(),ge(()=>ge(()=>r()==="details")()&&(()=>{var I=i2(),O=I.firstChild,J=O.firstChild,D=J.nextSibling,T=O.nextSibling,B=T.firstChild,me=B.nextSibling,H=T.nextSibling,de=H.firstChild,$=de.nextSibling,q=H.nextSibling,Z=q.firstChild,L=Z.nextSibling,te=q.nextSibling,j=te.firstChild,M=j.nextSibling,ie=te.nextSibling,oe=ie.firstChild,fe=oe.nextSibling,ue=ie.nextSibling,K=ue.firstChild,R=K.nextSibling,ee=ue.nextSibling,X=ee.firstChild,ye=X.firstChild,pe=ye.nextSibling,z=X.nextSibling;return s(J,()=>e("common.date")),s(D,()=>g(m.date)),s(B,()=>e("journal.reference")),s(me,()=>m.reference||e("common.notAvailable","N/A")),s(de,()=>e("journal.totalDebit")),s($,()=>b(m.totalDebit)),s(Z,()=>e("journal.totalCredit")),s(L,()=>b(m.totalCredit)),s(j,()=>e("journal.balanceStatus","Balance Status")),s(M,()=>W?`${e("journal.balanced")} `:`${e("journal.unbalanced","Unbalanced")} (${b(Math.abs(m.totalDebit-m.totalCredit))} ${e("journal.difference","difference")})`),s(oe,()=>e("journal.createdBy")),s(fe,()=>m.createdBy),s(K,()=>e("journal.createdAt","Created At")),s(R,()=>p(m.createdAt)),s(I,(()=>{var se=ge(()=>!!m.postedAt);return()=>se()&&(()=>{var _e=Bl(),Pe=_e.firstChild,he=Pe.nextSibling;return s(Pe,()=>e("journal.postedAt","Posted At")),s(he,()=>p(m.postedAt)),le(be=>{var ce=E,Se=V,Ee=N;return be.e=u(_e,ce,be.e),be.t=u(Pe,Se,be.t),be.a=u(he,Ee,be.a),be},{e:void 0,t:void 0,a:void 0}),_e})()})(),ee),ee.style.setProperty("margin-top","2rem"),ee.style.setProperty("padding-top","1rem"),ee.style.setProperty("border-top","2px solid var(--border-color)"),X.style.setProperty("display","flex"),X.style.setProperty("justify-content","space-between"),X.style.setProperty("align-items","center"),X.style.setProperty("margin-bottom","1rem"),ye.style.setProperty("margin","0"),ye.style.setProperty("font-size","1rem"),s(ye,()=>e("journal.quickActions","Quick Actions")),pe.style.setProperty("display","flex"),pe.style.setProperty("gap","0.5rem"),s(pe,_(Le,{variant:"primary",size:"sm",onClick:C,get children(){return[" ",ge(()=>e("journal.editEntry"))]}}),null),s(pe,(()=>{var se=ge(()=>m.status==="draft");return()=>se()&&_(Le,{variant:"outline",size:"sm",onClick:S,disabled:!W,style:{"border-color":W?"#4caf50":"#f44336",color:W?"#4caf50":"#f44336"},get children(){return W?` ${e("journal.postEntry","Post Entry")}`:` ${e("journal.fixBalance","Fix Balance")}`}})})(),null),s(pe,(()=>{var se=ge(()=>m.status==="posted");return()=>se()&&_(Le,{variant:"outline",size:"sm",onClick:A,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return[" ",ge(()=>e("journal.voidEntry","Void Entry"))]}})})(),null),z.style.setProperty("padding","1rem"),z.style.setProperty("border-radius","var(--border-radius-sm)"),z.style.setProperty("font-size","0.875rem"),s(z,(()=>{var se=ge(()=>m.status==="draft");return()=>se()&&(()=>{var _e=Ul(),Pe=_e.firstChild,he=Pe.firstChild;return Pe.nextSibling,s(Pe,()=>e("journal.draftEntry","Draft Entry"),he),s(_e,()=>e("journal.draftEntryDescription","This entry can be edited and posted."),null),s(_e,()=>!W&&`  ${e("journal.entryMustBeBalancedBeforePosting","Entry must be balanced before posting.")}`,null),_e})()})(),null),s(z,(()=>{var se=ge(()=>m.status==="posted");return()=>se()&&(()=>{var _e=Ul(),Pe=_e.firstChild,he=Pe.firstChild;return Pe.nextSibling,s(Pe,()=>e("journal.postedEntry","Posted Entry"),he),s(_e,()=>e("journal.postedEntryDescription","This entry has been posted to the general ledger. Editing will create a new draft copy."),null),_e})()})(),null),s(z,(()=>{var se=ge(()=>m.status==="void");return()=>se()&&(()=>{var _e=Ul(),Pe=_e.firstChild,he=Pe.firstChild;return Pe.nextSibling,s(Pe,()=>e("journal.voidEntry"),he),s(_e,()=>e("journal.voidEntryDescription","This entry has been voided and cannot be modified."),null),_e})()})(),null),le(se=>{var _e=E,Pe=V,he=N,be=E,ce=V,Se=N,Ee=E,$e=V,ke=N,Me=E,Ke=V,je=N,Ce=E,Fe=V,Qe={...N,color:W?"#4caf50":"#f44336"},We=E,Je=V,xe=N,ot=E,et=V,Ct=N,mt=m.status==="draft"?"#fff3cd":m.status==="posted"?"#d4edda":"#f8d7da";return se.e=u(O,_e,se.e),se.t=u(J,Pe,se.t),se.a=u(D,he,se.a),se.o=u(T,be,se.o),se.i=u(B,ce,se.i),se.n=u(me,Se,se.n),se.s=u(H,Ee,se.s),se.h=u(de,$e,se.h),se.r=u($,ke,se.r),se.d=u(q,Me,se.d),se.l=u(Z,Ke,se.l),se.u=u(L,je,se.u),se.c=u(te,Ce,se.c),se.w=u(j,Fe,se.w),se.m=u(M,Qe,se.m),se.f=u(ie,We,se.f),se.y=u(oe,Je,se.y),se.g=u(fe,xe,se.g),se.p=u(ue,ot,se.p),se.b=u(K,et,se.b),se.T=u(R,Ct,se.T),mt!==se.A&&((se.A=mt)!=null?z.style.setProperty("background",mt):z.style.removeProperty("background")),se},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),I})()),ge(()=>ge(()=>r()==="lines")()&&(()=>{var I=s2(),O=I.firstChild,J=O.firstChild,D=J.nextSibling,T=D.nextSibling,B=T.nextSibling,me=B.nextSibling,H=O.nextSibling,de=H.firstChild,$=de.firstChild,q=$.firstChild;$.nextSibling;var Z=de.nextSibling,L=Z.firstChild,te=L.firstChild;L.nextSibling;var j=Z.nextSibling,M=H.nextSibling,ie=M.firstChild,oe=ie.nextSibling,fe=oe.firstChild,ue=fe.firstChild,K=ue.firstChild;K.nextSibling;var R=ue.nextSibling,ee=R.firstChild;ee.nextSibling;var X=R.nextSibling,ye=X.firstChild;ye.nextSibling;var pe=fe.nextSibling,z=pe.firstChild,se=z.firstChild;se.nextSibling;var _e=z.nextSibling,Pe=_e.firstChild;return Pe.nextSibling,s(J,()=>e("journal.account")),s(D,()=>e("common.description")),s(T,()=>e("journal.debit")),s(B,()=>e("journal.credit")),s(me,()=>e("banking.reconciliation")),s(I,_(at,{get each(){return m.lines},children:he=>(()=>{var be=a2(),ce=be.firstChild,Se=ce.firstChild,Ee=Se.nextSibling,$e=ce.nextSibling,ke=$e.nextSibling,Me=ke.nextSibling,Ke=Me.nextSibling;return Se.style.setProperty("font-weight","500"),s(Se,()=>he.accountName),Ee.style.setProperty("font-size","0.75rem"),Ee.style.setProperty("color","var(--text-muted)"),s(Ee,()=>wt.getAccountById(he.accountId)?.accountNumber||he.accountId),$e.style.setProperty("font-size","0.875rem"),s($e,()=>he.description||"-"),ke.style.setProperty("font-weight","600"),s(ke,(()=>{var je=ge(()=>he.debitAmount>0);return()=>je()?b(he.debitAmount):"-"})()),Me.style.setProperty("font-weight","600"),s(Me,(()=>{var je=ge(()=>he.creditAmount>0);return()=>je()?b(he.creditAmount):"-"})()),s(Ke,(()=>{var je=ge(()=>!!he.reconciled);return()=>je()?(()=>{var Ce=l2(),Fe=Ce.firstChild;return Fe.firstChild,Ce.style.setProperty("display","flex"),Ce.style.setProperty("align-items","center"),Ce.style.setProperty("gap","0.5rem"),Ce.style.setProperty("color","#4caf50"),Ce.style.setProperty("font-size","0.875rem"),Fe.style.setProperty("font-weight","600"),s(Fe,()=>e("banking.reconciled"),null),s(Ce,(()=>{var Qe=ge(()=>!!he.reconciledWith);return()=>Qe()&&(()=>{var We=c2(),Je=We.firstChild,xe=Je.nextSibling;return xe.nextSibling,We.style.setProperty("font-size","0.75rem"),We.style.setProperty("color","var(--text-muted)"),We.style.setProperty("font-style","italic"),s(We,()=>he.reconciledWith,xe),We})()})(),null),Ce})():(()=>{var Ce=_m();return Ce.style.setProperty("color","var(--text-muted)"),Ce.style.setProperty("font-size","0.875rem"),s(Ce,()=>e("banking.notReconciled","Not Reconciled")),Ce})()})()),le(je=>{var Ce=re,Fe=he.debitAmount>0?"#4caf50":"var(--text-muted)",Qe=he.creditAmount>0?"#f44336":"var(--text-muted)";return je.e=u(be,Ce,je.e),Fe!==je.t&&((je.t=Fe)!=null?ke.style.setProperty("color",Fe):ke.style.removeProperty("color")),Qe!==je.a&&((je.a=Qe)!=null?Me.style.setProperty("color",Qe):Me.style.removeProperty("color")),je},{e:void 0,t:void 0,a:void 0}),be})()}),H),u(H,F),s($,()=>e("journal.totalDebit"),q),s(de,()=>b(m.totalDebit),null),s(L,()=>e("journal.totalCredit"),te),s(Z,()=>b(m.totalCredit),null),(W?"#4caf50":"#f44336")!=null?j.style.setProperty("color",W?"#4caf50":"#f44336"):j.style.removeProperty("color"),j.style.setProperty("font-weight","600"),s(j,()=>W?` ${e("journal.balanced")}`:` ${e("journal.notBalanced","Not Balanced")}`),M.style.setProperty("margin-top","1rem"),M.style.setProperty("padding","1rem"),M.style.setProperty("border-radius","var(--border-radius-sm)"),M.style.setProperty("font-size","0.875rem"),ie.style.setProperty("margin-bottom","0.5rem"),oe.style.setProperty("display","grid"),oe.style.setProperty("grid-template-columns","1fr 1fr"),oe.style.setProperty("gap","1rem"),ue.style.setProperty("margin-bottom","0.25rem"),s(ue,()=>m.lines.length,null),R.style.setProperty("margin-bottom","0.25rem"),R.style.setProperty("color","#4caf50"),s(R,()=>m.lines.filter(he=>he.reconciled).length,null),X.style.setProperty("color","#f44336"),s(X,()=>m.lines.filter(he=>!he.reconciled).length,null),z.style.setProperty("margin-bottom","0.25rem"),s(z,()=>m.lines.filter(he=>["1001","1002","1003"].includes(he.accountId)).length,null),_e.style.setProperty("margin-bottom","0.25rem"),_e.style.setProperty("color","#4caf50"),s(_e,()=>m.lines.filter(he=>["1001","1002","1003"].includes(he.accountId)&&he.reconciled).length,null),s(pe,(()=>{var he=ge(()=>m.lines.filter(be=>["1001","1002","1003"].includes(be.accountId)&&!be.reconciled).length>0);return()=>he()&&(()=>{var be=u2(),ce=be.firstChild;return ce.nextSibling,be.style.setProperty("color","#f44336"),s(be,()=>m.lines.filter(Se=>["1001","1002","1003"].includes(Se.accountId)&&!Se.reconciled).length,null),be})()})(),null),s(M,(()=>{var he=ge(()=>m.lines.filter(be=>be.reconciled).length>0);return()=>he()&&(()=>{var be=d2(),ce=be.firstChild;return be.style.setProperty("margin-top","0.75rem"),be.style.setProperty("padding-top","0.75rem"),be.style.setProperty("border-top","1px solid var(--border-color)"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),s(be,()=>m.lines.filter(Se=>Se.reconciled).map(Se=>(()=>{var Ee=Bl(),$e=Ee.firstChild,ke=$e.nextSibling;return Ee.style.setProperty("display","flex"),Ee.style.setProperty("justify-content","space-between"),Ee.style.setProperty("margin-bottom","0.25rem"),Ee.style.setProperty("font-size","0.8rem"),s($e,()=>Se.accountName),ke.style.setProperty("color","var(--text-muted)"),s(ke,()=>Se.reconciledWith?` ${Se.reconciledWith}`:"Manual"),Ee})()),null),be})()})(),null),s(M,(()=>{var he=ge(()=>m.lines.filter(be=>!be.reconciled&&["1001","1002","1003"].includes(be.accountId)).length>0);return()=>he()&&(()=>{var be=h2(),ce=be.firstChild,Se=ce.nextSibling;return be.style.setProperty("margin-top","0.75rem"),be.style.setProperty("padding-top","0.75rem"),be.style.setProperty("border-top","1px solid var(--border-color)"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),ce.style.setProperty("color","#f44336"),s(be,()=>m.lines.filter(Ee=>!Ee.reconciled&&["1001","1002","1003"].includes(Ee.accountId)).map(Ee=>(()=>{var $e=Bl(),ke=$e.firstChild,Me=ke.nextSibling;return $e.style.setProperty("display","flex"),$e.style.setProperty("justify-content","space-between"),$e.style.setProperty("margin-bottom","0.25rem"),$e.style.setProperty("font-size","0.8rem"),$e.style.setProperty("color","#f44336"),s(ke,()=>Ee.accountName),s(Me,()=>b(Ee.debitAmount||Ee.creditAmount)),$e})()),Se),Se.style.setProperty("margin-top","0.5rem"),Se.style.setProperty("font-size","0.75rem"),Se.style.setProperty("color","var(--text-muted)"),Se.style.setProperty("font-style","italic"),be})()})(),null),le(he=>{var be=ae,ce=m.lines.some(Se=>Se.reconciled)?"#e8f5e8":"#fff3cd";return he.e=u(O,be,he.e),ce!==he.t&&((he.t=ce)!=null?M.style.setProperty("background",ce):M.style.removeProperty("background")),he},{e:void 0,t:void 0}),I})()),ge(()=>ge(()=>r()==="reconciliation")()&&(()=>{var I=m2(),O=I.firstChild,J=O.firstChild,D=J.firstChild,T=D.nextSibling,B=J.nextSibling,me=B.firstChild,H=me.firstChild,de=H.nextSibling,$=me.nextSibling,q=$.firstChild,Z=q.nextSibling,L=$.nextSibling,te=L.firstChild,j=te.nextSibling;return O.style.setProperty("margin-bottom","1.5rem"),O.style.setProperty("padding","1rem"),O.style.setProperty("border-radius","var(--border-radius)"),O.style.setProperty("border","1px solid var(--border-color)"),J.style.setProperty("display","flex"),J.style.setProperty("align-items","center"),J.style.setProperty("gap","0.5rem"),J.style.setProperty("margin-bottom","1rem"),D.style.setProperty("font-size","1.5rem"),s(D,(()=>{var M=ge(()=>!!m.lines.every(ie=>ie.reconciled));return()=>M()?"":m.lines.some(ie=>ie.reconciled)?"":""})()),T.style.setProperty("margin","0"),T.style.setProperty("font-size","1.2rem"),s(T,(()=>{var M=ge(()=>!!m.lines.every(ie=>ie.reconciled));return()=>M()?"Fully Reconciled":m.lines.some(ie=>ie.reconciled)?"Partially Reconciled":"Unreconciled"})()),B.style.setProperty("display","grid"),B.style.setProperty("grid-template-columns","1fr 1fr 1fr"),B.style.setProperty("gap","1rem"),me.style.setProperty("text-align","center"),H.style.setProperty("font-size","2rem"),H.style.setProperty("font-weight","700"),H.style.setProperty("color","var(--primary-color)"),s(H,()=>m.lines.length),de.style.setProperty("font-size","0.875rem"),de.style.setProperty("color","var(--text-muted)"),$.style.setProperty("text-align","center"),q.style.setProperty("font-size","2rem"),q.style.setProperty("font-weight","700"),q.style.setProperty("color","#4caf50"),s(q,()=>m.lines.filter(M=>M.reconciled).length),Z.style.setProperty("font-size","0.875rem"),Z.style.setProperty("color","var(--text-muted)"),L.style.setProperty("text-align","center"),te.style.setProperty("font-size","2rem"),te.style.setProperty("font-weight","700"),te.style.setProperty("color","#f44336"),s(te,()=>m.lines.filter(M=>!M.reconciled).length),j.style.setProperty("font-size","0.875rem"),j.style.setProperty("color","var(--text-muted)"),s(I,(()=>{var M=ge(()=>m.lines.filter(ie=>ie.reconciled).length>0);return()=>M()&&(()=>{var ie=y2(),oe=ie.firstChild,fe=oe.firstChild,ue=fe.nextSibling;return ue.nextSibling,ie.style.setProperty("margin-bottom","1.5rem"),oe.style.setProperty("margin","0 0 1rem 0"),oe.style.setProperty("font-size","1.1rem"),oe.style.setProperty("color","#4caf50"),oe.style.setProperty("display","flex"),oe.style.setProperty("align-items","center"),oe.style.setProperty("gap","0.5rem"),s(oe,()=>m.lines.filter(K=>K.reconciled).length,ue),s(ie,()=>m.lines.filter(K=>K.reconciled).map(K=>(()=>{var R=f2(),ee=R.firstChild,X=ee.firstChild,ye=X.nextSibling,pe=ee.nextSibling,z=pe.nextSibling,se=z.nextSibling,_e=se.nextSibling,Pe=_e.firstChild;return R.style.setProperty("display","grid"),R.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),R.style.setProperty("gap","1rem"),R.style.setProperty("padding","0.75rem"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("background","#f0f9f0"),R.style.setProperty("border-radius","var(--border-radius-sm)"),R.style.setProperty("align-items","center"),R.style.setProperty("font-size","0.875rem"),X.style.setProperty("font-weight","500"),s(X,()=>K.accountName),ye.style.setProperty("font-size","0.75rem"),ye.style.setProperty("color","var(--text-muted)"),s(ye,()=>wt.getAccountById(K.accountId)?.accountNumber),pe.style.setProperty("color","var(--text-muted)"),s(pe,()=>K.description||"No description"),z.style.setProperty("font-weight","600"),s(z,(()=>{var he=ge(()=>K.debitAmount>0);return()=>he()?b(K.debitAmount):"-"})()),se.style.setProperty("font-weight","600"),s(se,(()=>{var he=ge(()=>K.creditAmount>0);return()=>he()?b(K.creditAmount):"-"})()),_e.style.setProperty("color","#4caf50"),Pe.style.setProperty("font-weight","500"),s(_e,(()=>{var he=ge(()=>!!K.reconciledWith);return()=>he()&&(()=>{var be=p2();return be.firstChild,be.style.setProperty("font-size","0.75rem"),be.style.setProperty("font-style","italic"),s(be,()=>K.reconciledWith,null),be})()})(),null),le(he=>{var be=K.debitAmount>0?"#4caf50":"var(--text-muted)",ce=K.creditAmount>0?"#f44336":"var(--text-muted)";return be!==he.e&&((he.e=be)!=null?z.style.setProperty("color",be):z.style.removeProperty("color")),ce!==he.t&&((he.t=ce)!=null?se.style.setProperty("color",ce):se.style.removeProperty("color")),he},{e:void 0,t:void 0}),R})()),null),ie})()})(),null),s(I,(()=>{var M=ge(()=>m.lines.filter(ie=>!ie.reconciled).length>0);return()=>M()&&(()=>{var ie=g2(),oe=ie.firstChild,fe=oe.firstChild,ue=fe.nextSibling;return ue.nextSibling,ie.style.setProperty("margin-bottom","1.5rem"),oe.style.setProperty("margin","0 0 1rem 0"),oe.style.setProperty("font-size","1.1rem"),oe.style.setProperty("color","#f44336"),oe.style.setProperty("display","flex"),oe.style.setProperty("align-items","center"),oe.style.setProperty("gap","0.5rem"),s(oe,()=>m.lines.filter(K=>!K.reconciled).length,ue),s(ie,()=>m.lines.filter(K=>!K.reconciled).map(K=>(()=>{var R=v2(),ee=R.firstChild,X=ee.firstChild,ye=X.nextSibling,pe=ee.nextSibling,z=pe.nextSibling,se=z.nextSibling,_e=se.nextSibling,Pe=_e.firstChild;return R.style.setProperty("display","grid"),R.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),R.style.setProperty("gap","1rem"),R.style.setProperty("padding","0.75rem"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("background","#fff9f0"),R.style.setProperty("border-radius","var(--border-radius-sm)"),R.style.setProperty("align-items","center"),R.style.setProperty("font-size","0.875rem"),R.style.setProperty("border","1px solid #ffe0b3"),X.style.setProperty("font-weight","500"),s(X,()=>K.accountName),ye.style.setProperty("font-size","0.75rem"),ye.style.setProperty("color","var(--text-muted)"),s(ye,()=>wt.getAccountById(K.accountId)?.accountNumber),pe.style.setProperty("color","var(--text-muted)"),s(pe,()=>K.description||"No description"),z.style.setProperty("font-weight","600"),s(z,(()=>{var he=ge(()=>K.debitAmount>0);return()=>he()?b(K.debitAmount):"-"})()),se.style.setProperty("font-weight","600"),s(se,(()=>{var he=ge(()=>K.creditAmount>0);return()=>he()?b(K.creditAmount):"-"})()),_e.style.setProperty("color","#f44336"),Pe.style.setProperty("font-weight","500"),s(_e,(()=>{var he=ge(()=>!!["1001","1002","1003"].includes(K.accountId));return()=>he()&&(()=>{var be=b2();return be.style.setProperty("font-size","0.75rem"),be.style.setProperty("font-style","italic"),be})()})(),null),le(he=>{var be=K.debitAmount>0?"#4caf50":"var(--text-muted)",ce=K.creditAmount>0?"#f44336":"var(--text-muted)";return be!==he.e&&((he.e=be)!=null?z.style.setProperty("color",be):z.style.removeProperty("color")),ce!==he.t&&((he.t=ce)!=null?se.style.setProperty("color",ce):se.style.removeProperty("color")),he},{e:void 0,t:void 0}),R})()),null),s(ie,(()=>{var K=ge(()=>m.lines.filter(R=>!R.reconciled&&["1001","1002","1003"].includes(R.accountId)).length>0);return()=>K()&&(()=>{var R=_2(),ee=R.firstChild,X=ee.nextSibling;return R.style.setProperty("padding","0.75rem"),R.style.setProperty("background","#ffebee"),R.style.setProperty("border-radius","var(--border-radius-sm)"),R.style.setProperty("margin-top","1rem"),R.style.setProperty("border","1px solid #ffcdd2"),ee.style.setProperty("font-weight","500"),ee.style.setProperty("margin-bottom","0.5rem"),ee.style.setProperty("color","#f44336"),X.style.setProperty("font-size","0.875rem"),X.style.setProperty("color","var(--text-muted)"),R})()})(),null),ie})()})(),null),le(M=>(M=m.lines.every(ie=>ie.reconciled)?"#e8f5e8":m.lines.some(ie=>ie.reconciled)?"#fff3cd":"#ffebee")!=null?O.style.setProperty("background",M):O.style.removeProperty("background")),I})()),(()=>{var I=_m();return u(I,Y),s(I,_(Le,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(I,_(Le,{variant:"primary",onClick:C,get children(){return e("journal.editEntry")}}),null),s(I,(()=>{var O=ge(()=>m.status==="draft");return()=>O()&&_(Le,{variant:"outline",onClick:S,disabled:!W,style:{"border-color":"#4caf50",color:W?"#4caf50":"var(--text-muted)"},get children(){return W?e("journal.postEntry","Post Entry"):e("journal.entryNotBalanced","Entry Not Balanced")}})})(),null),s(I,(()=>{var O=ge(()=>m.status==="posted");return()=>O()&&_(Le,{variant:"outline",onClick:A,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return e("journal.voidEntry","Void Entry")}})})(),null),I})()]})()}}),ge(()=>ge(()=>!!a())()&&_(Rp,{get isOpen(){return o()},onClose:()=>{i(!1)},get editEntry(){return a()}}))]};Pt(["click"]);var P2=G("<div><div><h2></h2><p></p></div><div>"),Sn=G("<div>"),w2=G("<div> <!>  <!> "),C2=G("<div><div><label></label></div><div><label></label></div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label></div><div>"),A2=G("<div><span>:</span><span> "),Js=G("<span>: "),x2=G("<div><br>");const I2=()=>{const{t}=ct(),[e,r]=ve(!1),[n,o]=ve(null),[i,a]=ve(!1),[c,d]=ve(null),[h,y]=ve("all"),[v,w]=ve("all"),[E,V]=ve(""),[N,x]=ve(""),[k,re]=ve("date"),[ae,F]=ve("desc"),Y={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},U={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)","flex-wrap":"wrap"},b={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem"},g={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(400px, 1fr))",gap:"1.5rem"},p=()=>[{value:"all",label:t("journal.allEntries","All Entries")},{value:"draft",label:t("journal.draft")},{value:"posted",label:t("journal.posted")},{value:"void",label:t("entryBooks.void","Void")}],C=()=>[{value:"all",label:t("accounts.allAccounts","All Accounts")},...wt.accounts.map(T=>({value:T.id,label:`${T.accountNumber} - ${T.name}`}))],S=()=>[{value:"date",label:t("common.date")},{value:"entryNumber",label:t("journal.entryNumber")},{value:"amount",label:t("common.amount")}],A=()=>{let T=xn.journalEntries;return h()!=="all"&&(T=T.filter(B=>B.status===h())),v()!=="all"&&(T=T.filter(B=>B.lines.some(me=>me.accountId===v()))),E()&&(T=T.filter(B=>B.date>=E())),N()&&(T=T.filter(B=>B.date<=N())),T=[...T].sort((B,me)=>{let H=0;switch(k()){case"date":H=new Date(B.date).getTime()-new Date(me.date).getTime();break;case"entryNumber":H=B.entryNumber.localeCompare(me.entryNumber);break;case"amount":H=B.totalDebit-me.totalDebit;break}return ae()==="asc"?H:-H}),T},m=()=>{const T=xn.journalEntries,B=T.filter(Z=>Z.status==="draft"),me=T.filter(Z=>Z.status==="posted"),H=T.filter(Z=>Z.status==="void"),de=me.reduce((Z,L)=>Z+L.totalDebit,0),$=me.reduce((Z,L)=>Z+L.totalCredit,0),q=T.filter(Z=>Z.lines.some(L=>["1001","1002","1003"].includes(L.accountId)&&!L.reconciled)).length;return{totalEntries:T.length,draftEntries:B.length,postedEntries:me.length,voidEntries:H.length,totalDebit:de,totalCredit:$,unreconciledEntries:q}},ne=T=>{d(T.id),a(!0)},W=()=>{o(null),r(!0)},I=()=>{r(!1),o(null)},O=T=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(T),J=m(),D=A();return _(Br,{get title(){return t("entryBooks.title")},get children(){return[(()=>{var T=P2(),B=T.firstChild,me=B.firstChild,H=me.nextSibling,de=B.nextSibling;return u(T,Y),me.style.setProperty("margin","0 0 0.5rem 0"),me.style.setProperty("font-size","1.5rem"),s(me,()=>t("journal.title")),H.style.setProperty("margin","0"),H.style.setProperty("color","var(--text-muted)"),s(H,()=>t("entryBooks.subtitle","Manage accounting entries and general ledger records")),de.style.setProperty("display","flex"),de.style.setProperty("gap","1rem"),s(de,_(Le,{variant:"secondary",onClick:()=>window.location.href="/bank-consolidations",get children(){return t("entryBooks.viewReconciliation","View Reconciliation")}}),null),s(de,_(Le,{variant:"primary",onClick:W,get children(){return t("journal.addEntry","Add Journal Entry")}}),null),T})(),(()=>{var T=Sn();return u(T,b),s(T,_(He,{get title(){return t("entryBooks.totalEntries","Total Entries")},get subtitle(){return t("entryBooks.allJournalEntries","All journal entries")},get children(){return[(()=>{var B=Sn();return B.style.setProperty("font-size","1.5rem"),B.style.setProperty("font-weight","600"),B.style.setProperty("color","var(--primary-color)"),B.style.setProperty("margin-bottom","0.5rem"),s(B,()=>J.totalEntries),B})(),(()=>{var B=w2(),me=B.firstChild,H=me.nextSibling,de=H.nextSibling,$=de.nextSibling;return $.nextSibling,B.style.setProperty("font-size","0.875rem"),B.style.setProperty("color","var(--text-muted)"),s(B,()=>J.postedEntries,me),s(B,()=>t("journal.posted").toLowerCase(),H),s(B,()=>J.draftEntries,$),s(B,()=>t("journal.draft").toLowerCase(),null),s(B,(()=>{var q=ge(()=>J.voidEntries>0);return()=>q()&&`  ${J.voidEntries} ${t("entryBooks.void","void").toLowerCase()}`})(),null),B})()]}}),null),s(T,_(He,{get title(){return t("journal.totalDebits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var B=Sn();return B.style.setProperty("font-size","1.5rem"),B.style.setProperty("font-weight","600"),B.style.setProperty("color","#4caf50"),B.style.setProperty("margin-bottom","0.5rem"),s(B,()=>O(J.totalDebit)),B})(),(()=>{var B=Sn();return B.style.setProperty("font-size","0.875rem"),B.style.setProperty("color","var(--text-muted)"),s(B,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",J.postedEntries.toString())),B})()]}}),null),s(T,_(He,{get title(){return t("journal.totalCredits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var B=Sn();return B.style.setProperty("font-size","1.5rem"),B.style.setProperty("font-weight","600"),B.style.setProperty("color","#f44336"),B.style.setProperty("margin-bottom","0.5rem"),s(B,()=>O(J.totalCredit)),B})(),(()=>{var B=Sn();return B.style.setProperty("font-size","0.875rem"),B.style.setProperty("color","var(--text-muted)"),s(B,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",J.postedEntries.toString())),B})()]}}),null),s(T,_(He,{get title(){return t("banking.unreconciled","Unreconciled")},get subtitle(){return t("banking.title")},get children(){return[(()=>{var B=Sn();return B.style.setProperty("font-size","1.5rem"),B.style.setProperty("font-weight","600"),B.style.setProperty("margin-bottom","0.5rem"),s(B,()=>J.unreconciledEntries),le(me=>(me=J.unreconciledEntries>0?"#ff9800":"#4caf50")!=null?B.style.setProperty("color",me):B.style.removeProperty("color")),B})(),(()=>{var B=Sn();return B.style.setProperty("font-size","0.875rem"),B.style.setProperty("color","var(--text-muted)"),s(B,(()=>{var me=ge(()=>J.unreconciledEntries>0);return()=>me()?t("entryBooks.needBankReconciliation","Need bank reconciliation"):t("entryBooks.allReconciled","All reconciled")})()),B})()]}}),null),T})(),(()=>{var T=C2(),B=T.firstChild,me=B.firstChild,H=B.nextSibling,de=H.firstChild,$=H.nextSibling,q=$.firstChild,Z=$.nextSibling,L=Z.firstChild,te=L.nextSibling,j=Z.nextSibling,M=j.firstChild,ie=M.nextSibling,oe=j.nextSibling,fe=oe.firstChild,ue=oe.nextSibling;return u(T,U),B.style.setProperty("min-width","150px"),me.style.setProperty("display","block"),me.style.setProperty("margin-bottom","0.5rem"),me.style.setProperty("font-weight","500"),me.style.setProperty("font-size","0.875rem"),s(me,()=>t("common.status")),s(B,_(gr,{label:"",get value(){return h()},onChange:y,get options(){return p()}}),null),H.style.setProperty("min-width","200px"),de.style.setProperty("display","block"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),de.style.setProperty("font-size","0.875rem"),s(de,()=>t("journal.account")),s(H,_(gr,{label:"",get value(){return v()},onChange:w,get options(){return C()}}),null),$.style.setProperty("min-width","120px"),q.style.setProperty("display","block"),q.style.setProperty("margin-bottom","0.5rem"),q.style.setProperty("font-weight","500"),q.style.setProperty("font-size","0.875rem"),s(q,()=>t("entryBooks.sortBy","Sort By")),s($,_(gr,{label:"",get value(){return k()},onChange:re,get options(){return S()}}),null),Z.style.setProperty("min-width","130px"),L.style.setProperty("display","block"),L.style.setProperty("margin-bottom","0.5rem"),L.style.setProperty("font-weight","500"),L.style.setProperty("font-size","0.875rem"),s(L,()=>t("entryBooks.fromDate","From Date")),te.addEventListener("change",K=>V(K.target.value)),te.style.setProperty("padding","0.75rem"),te.style.setProperty("border","1px solid var(--border-color)"),te.style.setProperty("border-radius","var(--border-radius-sm)"),te.style.setProperty("font-family","inherit"),te.style.setProperty("width","100%"),j.style.setProperty("min-width","130px"),M.style.setProperty("display","block"),M.style.setProperty("margin-bottom","0.5rem"),M.style.setProperty("font-weight","500"),M.style.setProperty("font-size","0.875rem"),s(M,()=>t("entryBooks.toDate","To Date")),ie.addEventListener("change",K=>x(K.target.value)),ie.style.setProperty("padding","0.75rem"),ie.style.setProperty("border","1px solid var(--border-color)"),ie.style.setProperty("border-radius","var(--border-radius-sm)"),ie.style.setProperty("font-family","inherit"),ie.style.setProperty("width","100%"),oe.style.setProperty("min-width","100px"),fe.style.setProperty("display","block"),fe.style.setProperty("margin-bottom","0.5rem"),fe.style.setProperty("font-weight","500"),fe.style.setProperty("font-size","0.875rem"),s(fe,()=>t("entryBooks.order","Order")),s(oe,_(gr,{label:"",get value(){return ae()},onChange:F,get options(){return[{value:"desc",label:t("entryBooks.newest","Newest")},{value:"asc",label:t("entryBooks.oldest","Oldest")}]}}),null),ue.style.setProperty("display","flex"),ue.style.setProperty("align-items","end"),ue.style.setProperty("gap","0.5rem"),s(ue,_(Le,{variant:"outline",size:"sm",onClick:()=>{y("all"),w("all"),V(""),x(""),re("date"),F("desc")},get children(){return t("entryBooks.resetFilters","Reset Filters")}})),le(()=>te.value=E()),le(()=>ie.value=N()),T})(),ge(()=>ge(()=>!!(h()!=="all"||v()!=="all"||E()||N()))()&&(()=>{var T=A2(),B=T.firstChild,me=B.firstChild,H=B.nextSibling,de=H.firstChild;return T.style.setProperty("display","flex"),T.style.setProperty("gap","0.5rem"),T.style.setProperty("align-items","center"),T.style.setProperty("margin-bottom","1rem"),T.style.setProperty("padding","0.75rem"),T.style.setProperty("background","var(--surface-color)"),T.style.setProperty("border-radius","var(--border-radius-sm)"),T.style.setProperty("border","1px solid var(--border-color)"),B.style.setProperty("font-size","0.875rem"),B.style.setProperty("font-weight","500"),s(B,()=>t("entryBooks.activeFilters","Active filters"),me),s(T,(()=>{var $=ge(()=>h()!=="all");return()=>$()&&(()=>{var q=Js(),Z=q.firstChild;return q.style.setProperty("padding","0.25rem 0.5rem"),q.style.setProperty("background","var(--primary-color)"),q.style.setProperty("color","white"),q.style.setProperty("border-radius","12px"),q.style.setProperty("font-size","0.75rem"),s(q,()=>t("common.status"),Z),s(q,h,null),q})()})(),H),s(T,(()=>{var $=ge(()=>v()!=="all");return()=>$()&&(()=>{var q=Js(),Z=q.firstChild;return q.style.setProperty("padding","0.25rem 0.5rem"),q.style.setProperty("background","var(--primary-color)"),q.style.setProperty("color","white"),q.style.setProperty("border-radius","12px"),q.style.setProperty("font-size","0.75rem"),s(q,()=>t("journal.account"),Z),s(q,()=>wt.getAccountById(v())?.name||t("common.unknown","Unknown"),null),q})()})(),H),s(T,(()=>{var $=ge(()=>!!E());return()=>$()&&(()=>{var q=Js(),Z=q.firstChild;return q.style.setProperty("padding","0.25rem 0.5rem"),q.style.setProperty("background","var(--primary-color)"),q.style.setProperty("color","white"),q.style.setProperty("border-radius","12px"),q.style.setProperty("font-size","0.75rem"),s(q,()=>t("entryBooks.from","From"),Z),s(q,E,null),q})()})(),H),s(T,(()=>{var $=ge(()=>!!N());return()=>$()&&(()=>{var q=Js(),Z=q.firstChild;return q.style.setProperty("padding","0.25rem 0.5rem"),q.style.setProperty("background","var(--primary-color)"),q.style.setProperty("color","white"),q.style.setProperty("border-radius","12px"),q.style.setProperty("font-size","0.75rem"),s(q,()=>t("entryBooks.to","To"),Z),s(q,N,null),q})()})(),H),H.style.setProperty("margin-left","auto"),H.style.setProperty("font-size","0.875rem"),H.style.setProperty("color","var(--text-muted)"),s(H,()=>D.length,de),s(H,()=>t("entryBooks.entriesFound","{count} entries found").replace("{count}",D.length.toString()),null),T})()),ge(()=>ge(()=>D.length===0)()?_(He,{get title(){return t("entryBooks.noJournalEntries","No Journal Entries")},get subtitle(){return t("entryBooks.startByCreating","Start by creating your first entry")},get children(){var T=x2(),B=T.firstChild;return T.style.setProperty("text-align","center"),T.style.setProperty("color","var(--text-muted)"),T.style.setProperty("padding","2rem"),s(T,()=>t("entryBooks.noEntriesMatch","No journal entries match your current filters."),B),s(T,_(Le,{variant:"primary",style:{"margin-top":"1rem"},onClick:W,get children(){return t("entryBooks.createFirstEntry","Create First Entry")}}),null),T}}):(()=>{var T=Sn();return u(T,g),s(T,_(at,{each:D,children:B=>_(ZE,{entry:B,onViewDetails:ne})})),T})()),_(Rp,{get isOpen(){return e()},onClose:I,get editEntry(){return n()}}),_(S2,{get isOpen(){return i()},onClose:()=>{a(!1),d(null)},get entryId(){return c()}})]}})};var E2=G("<div>$124,350"),$2=G("<div>+12% from last month"),T2=G("<div>247"),Wo=G("<div>"),k2=G("<div>18"),R2=G("<div>$89,250"),D2=G("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>");const N2=()=>{const{t}=ct(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},n={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)",margin:"0.5rem 0"},o={"font-size":"0.875rem",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"};return _(Br,{get title(){return t("dashboard.title")},get children(){return[(()=>{var i=Wo();return u(i,e),s(i,_(He,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var a=E2();return le(c=>u(a,n,c)),a})(),(()=>{var a=$2();return le(c=>u(a,o,c)),a})()]}}),null),s(i,_(He,{get title(){return t("dashboard.employeeCount")},get subtitle(){return t("dashboard.current")},get children(){return[(()=>{var a=T2();return le(c=>u(a,n,c)),a})(),(()=>{var a=Wo();return s(a,()=>t("dashboard.newHires")),le(c=>u(a,o,c)),a})()]}}),null),s(i,_(He,{get title(){return t("dashboard.pendingInvoices")},get subtitle(){return t("dashboard.outstanding")},get children(){return[(()=>{var a=k2();return le(c=>u(a,n,c)),a})(),(()=>{var a=Wo();return s(a,()=>t("dashboard.totalOutstanding")),le(c=>u(a,o,c)),a})()]}}),null),s(i,_(He,{get title(){return t("dashboard.cashBalance")},get subtitle(){return t("accounts.title")},get children(){return[(()=>{var a=R2();return le(c=>u(a,n,c)),a})(),(()=>{var a=Wo();return s(a,()=>t("dashboard.lastUpdatedToday")),le(c=>u(a,o,c)),a})()]}}),null),i})(),(()=>{var i=Wo();return u(i,r),s(i,_(He,{get title(){return t("dashboard.quickActions")},get subtitle(){return t("dashboard.commonTasks")},get children(){var a=Wo();return a.style.setProperty("display","flex"),a.style.setProperty("flex-direction","column"),a.style.setProperty("gap","1rem"),s(a,_(Le,{variant:"primary",get children(){return t("invoices.createNew")}}),null),s(a,_(Le,{variant:"secondary",get children(){return t("employees.addEmployee")}}),null),s(a,_(Le,{variant:"outline",get children(){return t("dashboard.generateReport")}}),null),a}}),null),s(i,_(He,{get title(){return t("dashboard.recentActivity")},get subtitle(){return t("dashboard.latestUpdates")},get children(){var a=D2(),c=a.firstChild,d=c.firstChild,h=d.nextSibling,y=c.nextSibling,v=y.firstChild,w=v.nextSibling,E=y.nextSibling,V=E.firstChild,N=V.nextSibling;return a.style.setProperty("display","flex"),a.style.setProperty("flex-direction","column"),a.style.setProperty("gap","0.75rem"),c.style.setProperty("border-bottom","1px solid var(--border-color)"),c.style.setProperty("padding-bottom","0.5rem"),d.style.setProperty("font-weight","500"),s(d,()=>t("dashboard.invoicePaid")),h.style.setProperty("font-size","0.875rem"),h.style.setProperty("color","var(--text-muted)"),s(h,()=>t("dashboard.hoursAgo")),y.style.setProperty("border-bottom","1px solid var(--border-color)"),y.style.setProperty("padding-bottom","0.5rem"),v.style.setProperty("font-weight","500"),s(v,()=>t("dashboard.newEmployeeOnboarded")),w.style.setProperty("font-size","0.875rem"),w.style.setProperty("color","var(--text-muted)"),s(w,()=>t("dashboard.dayAgo")),V.style.setProperty("font-weight","500"),s(V,()=>t("dashboard.monthlyReportGenerated")),N.style.setProperty("font-size","0.875rem"),N.style.setProperty("color","var(--text-muted)"),s(N,()=>t("dashboard.daysAgo")),a}}),null),i})(),_(De,{get when(){return St.hasPermission("invoiceAccess")},get children(){return _(GE,{})}})]}})};var Sm=G("<div>"),L2=G("<div><div><div><strong>Display Name:</strong> </div><div><strong>UID:</strong> </div></div><div><strong>Created:</strong> "),M2=G("<div><h3>Store Access</h3><div></div><div>No store access granted"),O2=G("<div><h3>Permissions</h3><div>"),V2=G('<div><div><input type=text placeholder="Search users..."></div><div>'),F2=G("<div> You need administrator privileges to access this page."),B2=G("<div>Loading users..."),U2=G("<div><div></div><div></div><div> stores"),j2=G("<div>Select a user to view and edit their profile"),z2=G("<div><input type=checkbox><label>"),q2=G("<div><input type=checkbox><div><div></div><div>");const G2=()=>{const[t,e]=ve([]),[r,n]=ve(null),[o,i]=ve(!1),[a,c]=ve(!1),[d,h]=ve(""),[y,v]=ve(null),w=[{id:"YY_8802",name:"Store 8802"},{id:"YY_8803",name:"Store 8803"},{id:"YY_8804",name:"Store 8804"},{id:"YY_8805",name:"Store 8805"},{id:"YY_8816",name:"Store 8816"},{id:"YY_8818",name:"Store 8818"},{id:"YY_8847",name:"Store 8847"},{id:"YY_3251",name:"Store 3251"},{id:"YY_32",name:"Store 32"},{id:"YY_76",name:"Store 76"},{id:"YY_79",name:"Store 79"},{id:"YY_8635",name:"Store 8635"},{id:"YY_8665",name:"Store 8665"},{id:"YY_8901",name:"Store 8901"}],E=[{key:"AccountAccess",label:"Account Access",description:"Access to accounting features"},{key:"BankingAccess",label:"Banking Access",description:"Access to banking operations"},{key:"InventoryAccess",label:"Inventory Access",description:"Access to inventory management"},{key:"JournalAccess",label:"Journal Access",description:"Access to journal entries"},{key:"inventoryDownsection",label:"Inventory Downsection",description:"Access to inventory downsection"},{key:"onlyRead",label:"Read Only",description:"Limited to read-only access"},{key:"read_write",label:"Read/Write",description:"Full read and write permissions"},{key:"isAdmin",label:"Administrator",description:"Full system administration rights"}];let V={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,invoiceAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1};Hr(async()=>{await N()});const N=async()=>{try{i(!0);const m=YP(Cc,"users"),ne=aw(m,lw("createdAt","desc")),W=await mw(ne),I=[];W.forEach(O=>{let J=O.data();Object.keys(V).map(D=>{let T=V?.[D];J.hasOwnProperty(D)||(J[D]=T)}),I.push({uid:O.id,...J})}),e(I)}catch(m){console.error("Error loading users:",m),v({type:"error",text:"Failed to load users"})}finally{i(!1)}},x=qe(()=>{const m=d().toLowerCase();return m?t().filter(ne=>ne.email?.toLowerCase().includes(m)||ne.displayName?.toLowerCase().includes(m)||ne.uid?.toLowerCase().includes(m)):t()}),k=m=>{r()&&n(ne=>({...ne,stores:{...ne.stores,[m]:!ne.stores[m]}}))},re=m=>{r()&&n(ne=>({...ne,[m]:!ne[m]}))};qe(()=>r()?r().stores&&Object.values(r().stores).some(m=>m):!1);const ae=async()=>{if(r())try{c(!0),v(null);const m=pp(Cc,"users",r().uid);let ne={stores:r().stores,AccountAccess:r().AccountAccess,BankingAccess:r().BankingAccess,InventoryAccess:r().InventoryAccess,JournalAccess:r().JournalAccess,inventoryDownsection:r().inventoryDownsection,onlyRead:r().onlyRead,read_write:r().read_write,isAdmin:r().isAdmin||!1};await xp(m,ne),e(W=>W.map(I=>I.uid===r().uid?r():I)),v({type:"success",text:"User profile updated successfully"})}catch(m){console.error("Error saving user profile:",m),v({type:"error",text:"Failed to save user profile"})}finally{c(!1)}},F={display:"grid","grid-template-columns":"350px 1fr",gap:"2rem",height:"calc(100vh - 200px)"},Y={"max-height":"100%","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)",background:"var(--surface-color)"},U=m=>({padding:"1rem","border-bottom":"1px solid var(--border-color)",cursor:"pointer",background:m?"var(--primary-color-light)":"transparent",transition:"background 0.2s"}),b={padding:"0.75rem",border:"none","border-bottom":"1px solid var(--border-color)",background:"var(--surface-color)",width:"100%","font-size":"1rem"},g={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1rem"},p={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(200px, 1fr))",gap:"0.75rem"},C={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",transition:"all 0.2s"},S=m=>({padding:"1rem","margin-bottom":"1rem","border-radius":"var(--border-radius)",background:m==="success"?"#d4edda":"#f8d7da",color:m==="success"?"#155724":"#721c24",border:`1px solid ${m==="success"?"#c3e6cb":"#f5c6cb"}`}),A=qe(()=>St.state.profile?.isAdmin===!0);return _(Br,{title:"User Profile Administration",get children(){return _(De,{get when(){return A()},get fallback(){return _(He,{get children(){var m=F2();return m.style.setProperty("text-align","center"),m.style.setProperty("padding","2rem"),m.style.setProperty("color","var(--text-muted)"),m}})},get children(){var m=V2(),ne=m.firstChild,W=ne.firstChild,I=ne.nextSibling;return u(m,F),u(ne,Y),W.$$input=O=>h(O.currentTarget.value),u(W,b),s(ne,_(De,{get when(){return!o()},get fallback(){return(()=>{var O=B2();return O.style.setProperty("padding","2rem"),O.style.setProperty("text-align","center"),O})()},get children(){return _(at,{get each(){return x()},children:O=>(()=>{var J=U2(),D=J.firstChild,T=D.nextSibling,B=T.nextSibling,me=B.firstChild;return J.$$click=()=>n(O),D.style.setProperty("font-weight","600"),s(D,()=>O.displayName||"No Name"),T.style.setProperty("font-size","0.875rem"),T.style.setProperty("color","var(--text-muted)"),s(T,()=>O.email),B.style.setProperty("font-size","0.75rem"),B.style.setProperty("color","var(--text-muted)"),B.style.setProperty("margin-top","0.25rem"),s(B,()=>O.isAdmin&&" Admin  ",me),s(B,()=>Object.values(O.stores||{}).filter(Boolean).length,me),le(H=>u(J,U(r()?.uid===O.uid),H)),J})()})}}),null),s(I,_(De,{get when(){return r()},get fallback(){return _(He,{get children(){var O=j2();return O.style.setProperty("text-align","center"),O.style.setProperty("padding","2rem"),O.style.setProperty("color","var(--text-muted)"),O}})},get children(){return[_(De,{get when(){return y()},get children(){var O=Sm();return s(O,()=>y().text),le(J=>u(O,S(y().type),J)),O}}),_(He,{title:"User Information",get subtitle(){return r().email},get children(){return[(()=>{var O=L2(),J=O.firstChild,D=J.firstChild,T=D.firstChild;T.nextSibling;var B=D.nextSibling,me=B.firstChild;me.nextSibling;var H=J.nextSibling,de=H.firstChild;return de.nextSibling,O.style.setProperty("margin-bottom","2rem"),J.style.setProperty("display","flex"),J.style.setProperty("justify-content","space-between"),J.style.setProperty("margin-bottom","1rem"),s(D,()=>r().displayName||"Not set",null),s(B,()=>r().uid,null),s(H,()=>new Date(r().createdAt?.toDate?.()||r().createdAt).toLocaleDateString(),null),O})(),(()=>{var O=M2(),J=O.firstChild,D=J.nextSibling,T=D.nextSibling;return O.style.setProperty("margin-bottom","2rem"),J.style.setProperty("margin-bottom","1rem"),u(D,p),s(D,_(at,{each:w,children:B=>{let me=Ne.getLocationById(B?.id);return(()=>{var H=z2(),de=H.firstChild,$=de.nextSibling;return H.$$click=()=>k(B?.id),de.style.setProperty("cursor","pointer"),$.style.setProperty("cursor","pointer"),$.style.setProperty("user-select","none"),s($,()=>me?.name),le(q=>u(H,{...C,background:r().stores?.[B?.id]?"var(--primary-color-light)":"transparent"},q)),le(()=>de.checked=r().stores?.[B?.id]||!1),H})()}})),T.style.setProperty("margin-top","0.5rem"),T.style.setProperty("font-size","0.875rem"),T.style.setProperty("color","var(--text-muted)"),O})(),(()=>{var O=O2(),J=O.firstChild,D=J.nextSibling;return O.style.setProperty("margin-bottom","2rem"),J.style.setProperty("margin-bottom","1rem"),u(D,g),s(D,_(at,{each:E,children:T=>(()=>{var B=q2(),me=B.firstChild,H=me.nextSibling,de=H.firstChild,$=de.nextSibling;return B.$$click=()=>re(T.key),me.style.setProperty("cursor","pointer"),H.style.setProperty("flex","1"),H.style.setProperty("cursor","pointer"),H.style.setProperty("user-select","none"),de.style.setProperty("font-weight","500"),s(de,()=>T.label),$.style.setProperty("font-size","0.75rem"),$.style.setProperty("color","var(--text-muted)"),s($,()=>T.description),le(q=>u(B,{...C,background:r()[T.key]?"var(--primary-color-light)":"transparent"},q)),le(()=>me.checked=!!r()[T.key]),B})()})),O})(),(()=>{var O=Sm();return O.style.setProperty("display","flex"),O.style.setProperty("gap","1rem"),O.style.setProperty("justify-content","flex-end"),s(O,_(Le,{variant:"secondary",onClick:()=>n(null),children:"Cancel"}),null),s(O,_(Le,{variant:"primary",onClick:ae,get disabled(){return a()},get children(){return a()?"Saving...":"Save Changes"}}),null),O})()]}})]}})),le(()=>W.value=d()),m}})}})};Pt(["input","click"]);const H2="modulepreload",W2=function(t){return"/"+t},Pm={},Dp=function(e,r,n){let o=Promise.resolve();if(r&&r.length>0){let a=function(h){return Promise.all(h.map(y=>Promise.resolve(y).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=c?.nonce||c?.getAttribute("nonce");o=a(r.map(h=>{if(h=W2(h),h in Pm)return;Pm[h]=!0;const y=h.endsWith(".css"),v=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${v}`))return;const w=document.createElement("link");if(w.rel=y?"stylesheet":H2,y||(w.as="script"),w.crossOrigin="",w.href=h,d&&w.setAttribute("nonce",d),document.head.appendChild(w),y)return new Promise((E,V)=>{w.addEventListener("load",E),w.addEventListener("error",()=>V(new Error(`Unable to preload CSS for ${h}`)))})}))}function i(a){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=a,window.dispatchEvent(c),!c.defaultPrevented)throw a}return o.then(a=>{for(const c of a||[])c.status==="rejected"&&i(c.reason);return e().catch(i)})},Y2=async()=>{try{console.log("Testing PDF generation...");const e=(await Dp(()=>import("./jspdf.es.min-D6ryCoGz.js").then(n=>n.j),[])).default;console.log("jsPDF imported successfully");const r=new e;console.log("PDF document created"),r.setFontSize(20),r.text("Test PDF",20,20),r.setFontSize(12),r.text("This is a test PDF to verify the library works.",20,40),console.log("Text added to PDF"),r.save("test.pdf"),console.log("PDF saved successfully"),alert("Test PDF generated successfully!")}catch(t){console.error("Test PDF generation failed:",t),alert(`Test PDF failed: ${t.message}`)}},K2=(t,e)=>{try{console.log("Generating printable PDF...");const r=window.open("","_blank","width=800,height=600");if(!r){alert("Please allow popups to generate PDF");return}const n=t.shipper_consignee||{},o=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Invoice ${t.invoice||"N/A"}</title>
        <style>
          body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
          }
          .header {
            display: flex;
            justify-content: space-between;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
            margin-bottom: 20px;
          }
          .company {
            font-size: 24px;
            font-weight: bold;
            color: #2563eb;
          }
          .invoice-info {
            text-align: right;
          }
          .section {
            margin: 20px 0;
          }
          .section-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
          }
          .customer-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
          }
          th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
          }
          th {
            background-color: #f2f2f2;
            font-weight: bold;
          }
          .total-row {
            font-weight: bold;
            font-size: 16px;
            background-color: #e8f4fd;
          }
          @media print {
            body { margin: 0; }
            .no-print { display: none; }
          }
        </style>
      </head>
      <body>
        <div class="header">
          <div>
            <div class="company">HRM FINANCE</div>
            <div>Store: ${t.storeName||t.store||"N/A"}</div>
            <div>Order ID: ${t.ssg_sorder_key||"N/A"}</div>
          </div>
          <div class="invoice-info">
            <div style="font-size: 18px; font-weight: bold;">INVOICE</div>
            <div style="font-size: 16px; margin: 5px 0;">${t.invoice||"N/A"}</div>
            <div>${t.createDate?new Date(t.createDate).toLocaleDateString():"N/A"}</div>
            <div style="margin-top: 10px;">
              <span style="padding: 4px 8px; background: ${t.isCompleted?"#d4edda":"#fff3cd"}; border-radius: 10px; font-size: 12px;">
                ${t.isCompleted?"COMPLETED":"PENDING"}
              </span>
            </div>
          </div>
        </div>

        <div class="section">
          <div class="section-title">Customer Information</div>
          <div class="customer-info">
            <div><strong>Name:</strong> ${n.name||"N/A"}</div>
            <div><strong>Full Name:</strong> ${[n.firstName,n.lastName].filter(Boolean).join(" ")||"N/A"}</div>
            <div><strong>Phone:</strong> ${n.phoneNumber||"N/A"}</div>
            <div><strong>ID:</strong> ${n.cid||"N/A"}</div>
            ${n.passport?`<div><strong>Passport:</strong> ${n.passport}</div>`:""}
          </div>
        </div>

        ${t.products&&t.products.length>0?`
        <div class="section">
          <div class="section-title">Products</div>
          <table>
            <thead>
              <tr>
                <th>Code</th>
                <th>Description</th>
                <th>Quantity</th>
                <th>Unit Price</th>
                <th>Total</th>
              </tr>
            </thead>
            <tbody>
              ${t.products.map(i=>`
                <tr>
                  <td>${i.product?.code||"N/A"}</td>
                  <td>${i.product?.label||"N/A"}</td>
                  <td>${Math.abs(i.qty||0)}</td>
                  <td>$${parseFloat(i.salePrice||0).toFixed(2)}</td>
                  <td>$${(Math.abs(i.qty||0)*parseFloat(i.salePrice||0)).toFixed(2)}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
        </div>
        `:""}

        ${t.reservas&&t.reservas.length>0?`
        <div class="section">
          <div class="section-title">Reservations</div>
          <table>
            <thead>
              <tr>
                <th>Type</th>
                <th>Quantity</th>
                <th>Unit Price</th>
                <th>Arancel</th>
                <th>Total</th>
              </tr>
            </thead>
            <tbody>
              ${t.reservas.map(i=>{const a=parseInt(i.qty||0),c=parseFloat(i.price||0),d=parseFloat(i.arancel||0),h=a*c+d;return`
                  <tr>
                    <td>${i.type||"N/A"}</td>
                    <td>${i.qty||0}</td>
                    <td>$${c.toFixed(2)}</td>
                    <td>${i.arancel||"-"}</td>
                    <td>$${h.toFixed(2)}</td>
                  </tr>
                `}).join("")}
            </tbody>
          </table>
        </div>
        `:""}

        <div class="section">
          <table style="margin-left: auto; width: 300px;">
            ${t.productSubtotal?`
            <tr>
              <td><strong>Products Subtotal:</strong></td>
              <td style="text-align: right;"><strong>$${t.productSubtotal.toFixed(2)}</strong></td>
            </tr>
            `:""}
            ${t.reservaSubtotal?`
            <tr>
              <td><strong>Reservations Subtotal:</strong></td>
              <td style="text-align: right;"><strong>$${t.reservaSubtotal.toFixed(2)}</strong></td>
            </tr>
            `:""}
            <tr class="total-row">
              <td><strong>TOTAL:</strong></td>
              <td style="text-align: right;"><strong>$${(t.total||0).toFixed(2)}</strong></td>
            </tr>
          </table>
        </div>

        <div style="margin-top: 40px; text-align: center; color: #666; font-size: 12px;">
          <p>Thank you for your business!</p>
          <p>Generated on ${new Date().toLocaleDateString()}</p>
        </div>

        <div class="no-print" style="margin-top: 30px; text-align: center;">
          <button onclick="window.print()" style="padding: 10px 20px; font-size: 16px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">
            Print / Save as PDF
          </button>
          <button onclick="window.close()" style="padding: 10px 20px; font-size: 16px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer; margin-left: 10px;">
            Close
          </button>
        </div>
      </body>
      </html>
    `;r.document.write(o),r.document.close(),r.focus(),console.log("Printable PDF window opened")}catch(r){console.error("Error generating printable PDF:",r),alert("Error generating printable PDF: "+r.message)}},Q2=async(t,e)=>{try{console.log("Starting professional PDF generation...");const n=(await Dp(()=>import("./jspdf.es.min-D6ryCoGz.js").then(oe=>oe.j),[])).default,o=new n,i=210,a=297,c=15,d=i-c*2,h={r:180,g:180,b:180},y={r:80,g:80,b:80},v={r:130,g:130,b:130},w={r:248,g:248,b:248},E={r:252,g:252,b:252},V={r:120,g:120,b:120},N={r:150,g:150,b:150};let x=c;const k=oe=>{o.setTextColor(oe.r,oe.g,oe.b)},re=oe=>{o.setFillColor(oe.r,oe.g,oe.b)},ae=(oe,fe,ue,K,R,ee=!1)=>{o.roundedRect(oe,fe,ue,K,R,R,ee?"F":"S")};re(E),o.rect(0,0,i,50,"F"),o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.5),o.line(0,50,i,50),k(y),o.setFontSize(32),o.setFont("helvetica","bold"),o.text("HRM",c,25),k(v),o.setFontSize(32),o.setFont("helvetica","normal");const F=o.getTextWidth("HRM ");o.text("FINANCE",c+F,25),k(v),o.setFontSize(9),o.setFont("helvetica","normal"),o.text("Professional Business Solutions",c,35);const Y=70,U=i-c-Y;o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.5),ae(U,12,Y,26,2,!1),k(y),o.setFontSize(14),o.setFont("helvetica","bold");const b=e("common.invoice").toUpperCase(),g=o.getTextWidth(b);o.text(b,U+(Y-g)/2,22),o.setFontSize(11),o.setFont("helvetica","normal");const p=t.invoice||"N/A",C=o.getTextWidth(p);o.text(p,U+(Y-C)/2,32),x=60,re(E),o.rect(0,50,i,20,"F");const S=t.isCompleted,A=S?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase();k(S?y:v),o.setFontSize(8),o.setFont("helvetica","bold"),o.text(`STATUS: ${A}`,c,58),k(v),o.setFontSize(9),o.setFont("helvetica","normal");const ne=t.createDate?new Date(t.createDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A";o.text(ne,i-c-o.getTextWidth(ne),58),x=58,o.text(`${e(`inventory.${t?.storeType}Type`)}: ${t.storeName||t.store||"N/A"}`,c+60,x),x+=5,o.text(`Order ID: ${t.ssg_sorder_key||"N/A"}`,c+60,x),x=80,k(y),o.setFontSize(14),o.setFont("helvetica","bold"),o.text(e("invoices.customerInformation"),c,x),x+=10;const W=45,I=10,O=(d-I)/2;re(E),ae(c,x,O,W,3,!0),o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.3),ae(c,x,O,W,3);const J=t.shipper_consignee||{};let D=x+8;k(v),o.setFontSize(9),o.text(e("invoices.senderInformation"),c+5,D),D+=7,k(y),o.setFontSize(11),o.setFont("helvetica","bold"),o.text(J.name||"N/A",c+5,D),J.phoneNumberS&&(D+=6,o.setFont("helvetica","normal"),o.setFontSize(9),k(v),o.text(`${e("invoices.altPhone")}: ${J.phoneNumberS}`,c+5,D)),re(E),ae(c+O+I,x,O,W,3,!0),o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.3),ae(c+O+I,x,O,W,3),D=x+8,k(v),o.setFontSize(9),o.text(e("invoices.receiptInformation"),c+O+I+5,D),D+=7;const T=[J.firstName,J.middleName,J.lastName,J.lastName2].filter(Boolean).join(" ")||"N/A";k(y),o.setFontSize(11),o.setFont("helvetica","bold"),o.text(T,c+O+I+5,D),D+=6,o.setFont("helvetica","normal"),o.setFontSize(9),k(v),o.text(`${e("invoices.phoneNumber")}: ${J.phoneNumber||"N/A"}`,c+O+I+5,D),console.log(J),D+=5,o.text(`${e("invoices.id")}: ${J.cid||"N/A"}`,c+O+I+5,D);let B=`${J.ybstreet} #${J.ybstreetNo} ${e("invoices.between")} ${J.ybbetwen1} ${e("invoices.and")} ${J.ybbetwen2}`,me=`${J.ybreparto}, ${J.ybcity}, ${J.ybestate}`;if(D+=5,o.text(B,c+O+I+5,D),D+=5,o.text(me,c+O+I+5,D),x+=W+15,t?.products&&t?.products?.length>0){k(y),o.setFontSize(14),o.setFont("helvetica","bold"),o.text(e("invoices.products"),c,x),x+=10,re(w),o.rect(c,x-6,d,10,"F"),o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.3),o.line(c,x+4,i-c,x+4),o.setFontSize(9),o.setFont("helvetica","bold"),k(y);const oe={code:c+5,description:c+35,qty:c+115,price:c+135,total:c+160};o.text(e("invoices.code"),oe.code,x),o.text(e("invoices.description"),oe.description,x),o.text(e("invoices.qty"),oe.qty,x),o.text(e("invoices.unitPrice"),oe.price,x),o.text(e("invoices.total"),oe.total,x),x+=10,o.setFont("helvetica","normal"),o.setFontSize(9),t.products.forEach((fe,ue)=>{x>250&&(o.addPage(),x=c),ue%2===0&&(re(E),o.rect(c,x-4,d,8,"F")),k(y),o.text(fe.product?.code||"N/A",oe.code,x);let K=fe.product?.label||"N/A";o.getTextWidth(K)>70&&(K=K.substring(0,40)+"..."),o.text(K,oe.description,x);const R=Math.abs(fe.qty||0),ee=parseFloat(fe.salePrice||0),X=R*ee;o.text(R.toString(),oe.qty,x),o.text(`$${ee.toFixed(2)}`,oe.price,x),o.setFont("helvetica","bold"),o.text(`$${X.toFixed(2)}`,oe.total,x),o.setFont("helvetica","normal"),x+=8}),o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.3),o.line(c,x,i-c,x),x+=15}if(t.reservas&&t.reservas.length>0){x>200&&(o.addPage(),x=c),k(y),o.setFontSize(14),o.setFont("helvetica","bold"),o.text(e("invoices.reservations"),c,x),x+=10,re(w),o.rect(c,x-6,d,10,"F"),o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.3),o.line(c,x+4,i-c,x+4),o.setFontSize(9),o.setFont("helvetica","bold"),k(y);const oe={type:c+5,qty:c+65,price:c+95,arancel:c+125,total:c+160};o.text(e("invoices.type"),oe.type,x),o.text(e("invoices.qty"),oe.qty,x),o.text(e("invoices.unitPrice"),oe.price,x),o.text(e("invoices.arancel"),oe.arancel,x),o.text(e("invoices.total"),oe.total,x),x+=10,o.setFont("helvetica","normal"),o.setFontSize(9),t.reservas.forEach((fe,ue)=>{x>250&&(o.addPage(),x=c),ue%2===0&&(re(E),o.rect(c,x-4,d,8,"F")),k(y),o.text(fe.type||"N/A",oe.type,x);const K=parseInt(fe.qty||0),R=parseFloat(fe.price||0),ee=parseFloat(fe.arancel||0),X=K*R+ee;o.text(K.toString(),oe.qty,x),o.text(`$${R.toFixed(2)}`,oe.price,x),o.text(fe.arancel||"-",oe.arancel,x),o.setFont("helvetica","bold"),o.text(`$${X.toFixed(2)}`,oe.total,x),o.setFont("helvetica","normal"),x+=8}),o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.3),o.line(c,x,i-c,x),x+=15}x>210&&(o.addPage(),x=c);const H=i-c-80,de=80;re(E),ae(H-10,x,de+10,60,3,!0),o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.3),ae(H-10,x,de+10,60,3);let $=x+10;o.setFontSize(10),k(v),t.productSubtotal!==void 0&&t.productSubtotal>0&&(o.text(e("invoices.productsSubtotal"),H,$),o.text(`$${t.productSubtotal.toFixed(2)}`,H+de-15,$,{align:"right"}),$+=8),t.reservaSubtotal!==void 0&&t.reservaSubtotal>0&&(o.text(e("invoices.reservationsSubtotal"),H,$),o.text(`$${t.reservaSubtotal.toFixed(2)}`,H+de-15,$,{align:"right"}),$+=8),o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.3),o.line(H,$+2,H+de-10,$+2),$+=10,o.setFontSize(14),o.setFont("helvetica","bold"),k(y),o.text(e("invoices.total"),H,$),o.text(`$${(t.total||0).toFixed(2)}`,H+de-15,$,{align:"right"}),x=a-30,re(E),o.rect(0,x-10,i,40,"F"),o.setFontSize(12),o.setFont("helvetica","italic"),k(v);const q="Thank you for your business!",Z=o.getTextWidth(q);o.text(q,(i-Z)/2,x),x+=8,o.setFontSize(9),o.setFont("helvetica","normal");const L="www.hrmfinance.com | info@hrmfinance.com | +1 (555) 123-4567",te=o.getTextWidth(L);o.text(L,(i-te)/2,x),x+=8,o.setFontSize(8);const j=`Generated on ${new Date().toLocaleString("en-US")}`,M=o.getTextWidth(j);o.text(j,(i-M)/2,x);const ie=`invoice-${t.invoice||"unknown"}.pdf`;o.save(ie),console.log("Professional PDF saved successfully:",ie)}catch(r){throw console.error("Error in generateProfessionalInvoicePDF:",r),r}};var J2=G("<br>"),wm=G("<div><h3></h3><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),Cm=G("<div><span>:</span><span>"),X2=G("<div class=invoice-display><div><div><div>:<span></span></div><div>: <span></span></div></div><div><div></div><h2></h2><div></div><div></div></div></div><div><h3></h3><div><div><div></div><div></div></div></div><div></div><h3></h3><div><div><div></div><div> <!> <!> </div><div></div><div></div><div></div><div></div></div><div><div></div><div></div><div></div><div></div><div> #<br> <!> <!> <br>, <br>, </div></div></div></div><div><div><div><span>:</span><span></span></div></div></div><div></div><div><button> </button><button> Test PDF</button><button> </button></div><style>"),Am=G("<tr><td></td><td></td><td></td><td></td><td>");const Z2=t=>{const{t:e}=ct(),r=p=>new Date(p).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),n=p=>{const C=typeof p=="string"?parseFloat(p):p;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(C)},o=qe(()=>{let p=0,C=0,S=0,A=0;t.invoice?.products?.forEach(I=>{const O=Math.abs(I?.qty),J=parseFloat(I?.salePrice)||1;p+=O*J}),t.invoice?.reservas?.forEach(I=>{let O=parseInt(I?.qty);isNaN(O)&&(O=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[I.type]||I?.onlyTariff?(O=parseFloat(I.arancel)||parseFloat(I.qty)*parseFloat(I.price),S+=O):(I?.arancel&&(A+=parseFloat(I?.arancel)),C+=O*parseFloat(I?.price))});const m=p+C+A+S,ne=0,W=m+ne;return{productSubtotal:p,reservaSubtotal:C,tariffSubtotal:A,subtotal:m,tax:ne,total:W}}),i={"max-width":"800px",margin:"0 auto",padding:"2rem",background:"white","box-shadow":"0 0 20px rgba(0,0,0,0.1)","border-radius":"var(--border-radius)"},a={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"2rem","padding-bottom":"2rem","border-bottom":"2px solid #e0e0e0"},c={"text-align":"right",flex:"1"},d={display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"600","text-transform":"uppercase",background:t.invoice.isCompleted?"#d4edda":"#fff3cd",color:t.invoice.isCompleted?"#155724":"#856404","margin-bottom":"0.5rem"},h={"margin-bottom":"2rem"},y={"font-size":"1.1rem","font-weight":"600","margin-bottom":"1rem",color:"#333"},v={display:"grid","grid-template-columns":"1fr 1fr",gap:"1.5rem"},w={background:"#f8f9fa",padding:"1rem","border-radius":"var(--border-radius-sm)",border:"1px solid #e9ecef"},E={"font-size":"0.875rem",color:"#666","margin-bottom":"0.25rem"},V={"font-size":"1rem",color:"#333","font-weight":"500"},N={width:"100%","border-collapse":"collapse","margin-top":"1rem"},x={"text-align":"left",padding:"0.75rem","border-bottom":"2px solid #dee2e6","font-weight":"600",color:"#495057","font-size":"0.875rem","text-transform":"uppercase"},k={padding:"0.75rem","border-bottom":"1px solid #dee2e6",color:"#212529"},re={"font-weight":"600","font-size":"1.1rem"},ae={display:"flex",gap:"1rem","justify-content":"center","margin-top":"2rem","padding-top":"2rem","border-top":"2px solid #e0e0e0"},F={padding:"0.75rem 1.5rem","border-radius":"var(--border-radius-sm)",border:"none","font-weight":"500",cursor:"pointer",transition:"all 0.2s",display:"flex","align-items":"center",gap:"0.5rem"},Y={...F,background:"var(--primary-color)",color:"white"},U={...F,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},b=qe(()=>Ne.getLocationById(t.invoice.store)),g=async()=>{console.log("Starting PDF export...");try{if(!t.invoice){console.error("No invoice data available"),alert("No invoice data available");return}console.log("Invoice data:",t.invoice),console.log("Store info:",b()),console.log("Totals:",o());const p={...t.invoice,storeName:b()?.name||t.invoice.store,storeType:b()?.type,productSubtotal:o().productSubtotal,reservaSubtotal:o().reservaSubtotal,total:o().total};console.log("Prepared invoice data:",p),console.log("Using minimal ink PDF generator...");try{await Q2(p,e),console.log("Minimal ink PDF generation completed successfully")}catch(C){console.error("PDF generation failed:",C),console.log("Trying printable PDF fallback..."),K2(p,e),console.log("Printable PDF fallback completed")}}catch(p){console.error("Error in handleExportPDF:",p),console.error("Error stack:",p.stack),alert(`Error generating PDF: ${p.message}`)}};return(()=>{var p=X2(),C=p.firstChild,S=C.firstChild,A=S.firstChild,m=A.firstChild,ne=m.nextSibling,W=A.nextSibling,I=W.firstChild,O=I.nextSibling,J=S.nextSibling,D=J.firstChild,T=D.nextSibling,B=T.nextSibling,me=B.nextSibling,H=C.nextSibling,de=H.firstChild,$=de.nextSibling,q=$.firstChild,Z=q.firstChild,L=Z.nextSibling,te=$.nextSibling,j=te.nextSibling,M=j.nextSibling,ie=M.firstChild,oe=ie.firstChild,fe=oe.nextSibling,ue=fe.firstChild,K=ue.nextSibling,R=K.nextSibling,ee=R.nextSibling;ee.nextSibling;var X=fe.nextSibling,ye=X.nextSibling,pe=ye.nextSibling,z=pe.nextSibling,se=ie.nextSibling,_e=se.firstChild,Pe=_e.nextSibling,he=Pe.nextSibling,be=he.nextSibling,ce=be.nextSibling,Se=ce.firstChild,Ee=Se.nextSibling,$e=Ee.nextSibling,ke=$e.nextSibling,Me=ke.nextSibling,Ke=Me.nextSibling,je=Ke.nextSibling,Ce=je.nextSibling,Fe=Ce.nextSibling,Qe=Fe.nextSibling,We=Qe.nextSibling,Je=H.nextSibling,xe=Je.firstChild,ot=xe.firstChild,et=ot.firstChild,Ct=et.firstChild,mt=et.nextSibling,Dt=Je.nextSibling,$t=Dt.nextSibling,Tt=$t.firstChild;Tt.firstChild;var Kt=Tt.nextSibling,rt=Kt.nextSibling;rt.firstChild;var Xt=$t.nextSibling;return u(p,i),u(C,a),A.style.setProperty("color","#666"),A.style.setProperty("margin-top","0.25rem"),s(A,()=>e(`inventory.${b()?.type}Type`),m),ne.style.setProperty("font-size","1.1rem"),ne.style.setProperty("font-weight","600"),ne.style.setProperty("color","#444"),s(ne,()=>b()?.name),W.style.setProperty("font-size",".91rem"),W.style.setProperty("font-weight","400"),W.style.setProperty("color","#666"),s(W,()=>e("invoices.id"),I),O.style.setProperty("font-size","1.1rem"),O.style.setProperty("font-weight","600"),O.style.setProperty("color","#444"),s(O,()=>t.invoice.ssg_sorder_key),u(J,c),s(D,(()=>{var Ie=ge(()=>!!t.invoice.isCompleted);return()=>Ie()?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase()})()),T.style.setProperty("margin","0 0 0.5rem 0"),T.style.setProperty("font-size","1.5rem"),s(T,()=>e("common.invoice").toUpperCase()),B.style.setProperty("font-size","1.1rem"),B.style.setProperty("font-weight","600"),B.style.setProperty("color","#333"),s(B,()=>t.invoice.invoice),me.style.setProperty("color","#666"),me.style.setProperty("margin-top","0.5rem"),s(me,()=>r(t.invoice.createDate)),s(de,()=>e("invoices.senderInformation")),s(Z,()=>e("invoices.customerName")),s(L,()=>t.invoice.shipper_consignee.name),s(q,_(De,{get when(){return t.invoice.shipper_consignee.phoneNumberS},get children(){return[J2(),ge(()=>e("invoices.altPhone")),": ",ge(()=>t.invoice.shipper_consignee.phoneNumberS)]}}),null),te.style.setProperty("margin","20px"),s(j,()=>e("invoices.receiptInformation")),s(oe,()=>e("invoices.customerName")),s(fe,()=>t.invoice.shipper_consignee.firstName,ue),s(fe,()=>t.invoice.shipper_consignee.middleName,K),s(fe,()=>t.invoice.shipper_consignee.lastName,ee),s(fe,()=>t.invoice.shipper_consignee.lastName2,null),s(X,()=>e("invoices.id")),s(ye,()=>t.invoice.shipper_consignee.cid),s(pe,()=>e("invoices.passport")),s(z,()=>t.invoice.shipper_consignee.passport),s(_e,()=>e("invoices.contactInformation")),s(Pe,()=>e("invoices.phoneNumber")),s(he,()=>t.invoice.shipper_consignee.phoneNumber),s(be,()=>e("invoices.address")),s(ce,()=>t.invoice.shipper_consignee.ybstreet,Se),s(ce,()=>t.invoice.shipper_consignee.ybstreetNo,Ee),s(ce,()=>e("invoices.between"),$e),s(ce,()=>t.invoice.shipper_consignee.ybbetwen1,ke),s(ce,()=>e("invoices.and"),Ke),s(ce,()=>t.invoice.shipper_consignee.ybbetwen2,Ce),s(ce,()=>t.invoice.shipper_consignee.ybreparto,Fe),s(ce,()=>t.invoice.shipper_consignee.ybcity,Qe),s(ce,()=>t.invoice.shipper_consignee.ybestate,We),s(ce,()=>t.invoice.shipper_consignee.nacionality,null),s(p,_(De,{get when(){return t.invoice?.products?.length>0},get children(){var Ie=wm(),gt=Ie.firstChild,Be=gt.nextSibling,Oe=Be.firstChild,Ze=Oe.firstChild,nt=Ze.firstChild,bt=nt.nextSibling,Xe=bt.nextSibling,yt=Xe.nextSibling,ut=yt.nextSibling,At=Oe.nextSibling;return s(gt,()=>e("invoices.products")),s(nt,()=>e("invoices.code")),s(bt,()=>e("invoices.description")),s(Xe,()=>e("invoices.qty")),s(yt,()=>e("invoices.unitPrice")),s(ut,()=>e("invoices.total")),s(At,_(at,{get each(){return t.invoice?.products},children:Ve=>(()=>{var zt=Am(),vt=zt.firstChild,Nt=vt.nextSibling,Bt=Nt.nextSibling,ft=Bt.nextSibling,Lt=ft.nextSibling;return s(vt,()=>Ve.product.code),s(Nt,()=>Ve.product.label),s(Bt,()=>Math.abs(Ve.qty)),s(ft,()=>n(Ve.salePrice)),s(Lt,()=>n(Math.abs(Ve.qty)*parseFloat(Ve.salePrice))),le(pt=>{var kt=k,Zt=k,dr={...k,"text-align":"center"},Tr={...k,"text-align":"right"},hr={...k,"text-align":"right"};return pt.e=u(vt,kt,pt.e),pt.t=u(Nt,Zt,pt.t),pt.a=u(Bt,dr,pt.a),pt.o=u(ft,Tr,pt.o),pt.i=u(Lt,hr,pt.i),pt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),zt})()})),le(Ve=>{var zt=h,vt=y,Nt=N,Bt=x,ft=x,Lt={...x,"text-align":"center"},pt={...x,"text-align":"right"},kt={...x,"text-align":"right"};return Ve.e=u(Ie,zt,Ve.e),Ve.t=u(gt,vt,Ve.t),Ve.a=u(Be,Nt,Ve.a),Ve.o=u(nt,Bt,Ve.o),Ve.i=u(bt,ft,Ve.i),Ve.n=u(Xe,Lt,Ve.n),Ve.s=u(yt,pt,Ve.s),Ve.h=u(ut,kt,Ve.h),Ve},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),Ie}}),Je),s(p,_(De,{get when(){return t.invoice?.reservas?.length>0},get children(){var Ie=wm(),gt=Ie.firstChild,Be=gt.nextSibling,Oe=Be.firstChild,Ze=Oe.firstChild,nt=Ze.firstChild,bt=nt.nextSibling,Xe=bt.nextSibling,yt=Xe.nextSibling,ut=yt.nextSibling,At=Oe.nextSibling;return s(gt,()=>e("invoices.reservations")),s(nt,()=>e("invoices.type")),s(bt,()=>e("invoices.qty")),s(Xe,()=>e("invoices.unitPrice")),s(yt,()=>e("invoices.arancel")),s(ut,()=>e("invoices.total")),s(At,_(at,{get each(){return t.invoice?.reservas},children:Ve=>(()=>{var zt=Am(),vt=zt.firstChild,Nt=vt.nextSibling,Bt=Nt.nextSibling,ft=Bt.nextSibling,Lt=ft.nextSibling;return s(vt,()=>Ve.type),s(Nt,()=>Ve.qty),s(Bt,()=>n(Ve.price)),s(ft,()=>Ve.arancel||"-"),s(Lt,()=>n(parseInt(Ve.qty)*parseFloat(Ve.price)+(Ve.arancel?parseFloat(Ve.arancel):0))),le(pt=>{var kt=k,Zt={...k,"text-align":"center"},dr={...k,"text-align":"right"},Tr={...k,"text-align":"right"},hr={...k,"text-align":"right"};return pt.e=u(vt,kt,pt.e),pt.t=u(Nt,Zt,pt.t),pt.a=u(Bt,dr,pt.a),pt.o=u(ft,Tr,pt.o),pt.i=u(Lt,hr,pt.i),pt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),zt})()})),le(Ve=>{var zt=h,vt=y,Nt=N,Bt=x,ft={...x,"text-align":"center"},Lt={...x,"text-align":"right"},pt={...x,"text-align":"right"},kt={...x,"text-align":"right"};return Ve.e=u(Ie,zt,Ve.e),Ve.t=u(gt,vt,Ve.t),Ve.a=u(Be,Nt,Ve.a),Ve.o=u(nt,Bt,Ve.o),Ve.i=u(bt,ft,Ve.i),Ve.n=u(Xe,Lt,Ve.n),Ve.s=u(yt,pt,Ve.s),Ve.h=u(ut,kt,Ve.h),Ve},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),Ie}}),Je),xe.style.setProperty("display","inline-block"),xe.style.setProperty("min-width","250px"),s(xe,_(De,{get when(){return t.invoice?.products?.length>0},get children(){var Ie=Cm(),gt=Ie.firstChild,Be=gt.firstChild,Oe=gt.nextSibling;return Ie.style.setProperty("display","flex"),Ie.style.setProperty("justify-content","space-between"),Ie.style.setProperty("margin-bottom","0.5rem"),s(gt,()=>e("invoices.productsSubtotal"),Be),s(Oe,()=>n(o().productSubtotal)),Ie}}),ot),s(xe,_(De,{get when(){return t.invoice?.reservas?.length>0},get children(){var Ie=Cm(),gt=Ie.firstChild,Be=gt.firstChild,Oe=gt.nextSibling;return Ie.style.setProperty("display","flex"),Ie.style.setProperty("justify-content","space-between"),Ie.style.setProperty("margin-bottom","0.5rem"),s(gt,()=>e("invoices.subtotal"),Be),s(Oe,()=>n(o().reservaSubtotal)),Ie}}),ot),s(et,()=>e("invoices.total"),Ct),mt.style.setProperty("color","var(--primary-color)"),s(mt,()=>n(o().total)),Tt.addEventListener("mouseleave",Ie=>Ie.currentTarget.style.opacity="1"),Tt.addEventListener("mouseenter",Ie=>Ie.currentTarget.style.opacity="0.9"),Tt.$$click=()=>t.onPrint?.(),s(Tt,()=>e("invoices.printInvoice"),null),co(Kt,"click",Y2,!0),rt.addEventListener("mouseleave",Ie=>{Ie.currentTarget.style.background="white",Ie.currentTarget.style.color="var(--primary-color)"}),rt.addEventListener("mouseenter",Ie=>{Ie.currentTarget.style.background="var(--primary-color)",Ie.currentTarget.style.color="white"}),rt.$$click=g,s(rt,()=>e("invoices.exportPdf"),null),s(Xt,`
        @media print {
          .invoice-display {
            box-shadow: none !important;
            padding: 0 !important;
          }
          
          ${ae} {
            display: none !important;
          }
        }
      `),le(Ie=>{var gt=d,Be=h,Oe=y,Ze=v,nt=w,bt=E,Xe=V,yt=y,ut=v,At=w,Ve=E,zt=V,vt={...E,"margin-top":"0.75rem"},Nt=V,Bt={...E,"margin-top":"0.75rem"},ft=V,Lt=w,pt=E,kt={...E,"margin-top":"0.75rem"},Zt=V,dr={...E,"margin-top":"0.75rem"},Tr=V,hr={...h,"text-align":"right"},gn={...re,display:"flex","justify-content":"space-between","padding-top":"0.75rem","border-top":"2px solid #dee2e6"},Mn={...h,"text-align":"center",color:"#666","font-size":"0.875rem"},Vo=ae,mo=Y,yo={...Y,background:"#28a745"},On=U;return Ie.e=u(D,gt,Ie.e),Ie.t=u(H,Be,Ie.t),Ie.a=u(de,Oe,Ie.a),Ie.o=u($,Ze,Ie.o),Ie.i=u(q,nt,Ie.i),Ie.n=u(Z,bt,Ie.n),Ie.s=u(L,Xe,Ie.s),Ie.h=u(j,yt,Ie.h),Ie.r=u(M,ut,Ie.r),Ie.d=u(ie,At,Ie.d),Ie.l=u(oe,Ve,Ie.l),Ie.u=u(fe,zt,Ie.u),Ie.c=u(X,vt,Ie.c),Ie.w=u(ye,Nt,Ie.w),Ie.m=u(pe,Bt,Ie.m),Ie.f=u(z,ft,Ie.f),Ie.y=u(se,Lt,Ie.y),Ie.g=u(_e,pt,Ie.g),Ie.p=u(Pe,kt,Ie.p),Ie.b=u(he,Zt,Ie.b),Ie.T=u(be,dr,Ie.T),Ie.A=u(ce,Tr,Ie.A),Ie.O=u(Je,hr,Ie.O),Ie.I=u(ot,gn,Ie.I),Ie.S=u(Dt,Mn,Ie.S),Ie.W=u($t,Vo,Ie.W),Ie.C=u(Tt,mo,Ie.C),Ie.B=u(Kt,yo,Ie.B),Ie.v=u(rt,On,Ie.v),Ie},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0}),p})()};Pt(["click"]);const[Xs,jt]=Fa({invoices:[],selectedInvoice:null,loading:!1,error:null,lastUpdated:null}),[e$,on]=ve({fetchAll:!1,fetchById:!1,create:!1,update:!1,delete:!1}),Ur={get state(){return Xs},get loadingStates(){return e$()},async fetchInvoices(t){try{on(a=>({...a,fetchAll:!0})),jt("loading",!0),jt("error",null);let e="SALES";t?.store&&t.store!=="all"&&(e+=" "+t.store),t?.status&&t.status!=="all"&&(e+=" "+t.status);const r=e.toString(),n=await ln.getInvoice(r);let o=[];if(t?.dateFrom&&t?.dateTo){const a=c=>{let d=new Date(n[c].createDate).getTime(),h=new Date(t?.dateFrom).getTime(),y=new Date(t?.dateTo).getTime();d>=h&&d<=y&&o.push(n[c])};Object.keys(n).map(a)}else o=Jl(n);const i=Array.isArray(o)?o:o||[];return jt("invoices",i),jt("lastUpdated",new Date),i}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoices";throw jt("error",r),console.error("Error fetching invoices:",e),e}finally{jt("loading",!1),on(e=>({...e,fetchAll:!1}))}},fecthInventory:async t=>{},async fetchInvoiceById(t){try{on(n=>({...n,fetchById:!0})),jt("error",null);const e=await ln.getInvoice(t),r=Jl(e);return jt("selectedInvoice",r[0]),r}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoice";throw jt("error",r),console.error("Error fetching invoice:",e),e}finally{on(e=>({...e,fetchById:!1}))}},async createInvoice(t){try{on(r=>({...r,create:!0})),jt("error",null);const e={};return jt("invoices",r=>[e,...r]),jt("lastUpdated",new Date),e}catch(e){const r=e instanceof Error?e.message:"Failed to create invoice";throw jt("error",r),console.error("Error creating invoice:",e),e}finally{on(e=>({...e,create:!1}))}},async updateInvoice(t,e){try{on(n=>({...n,update:!0})),jt("error",null);const r={};return jt("invoices",n=>n.map(o=>o.invoice===t?r:o)),Xs.selectedInvoice?.invoice===t&&jt("selectedInvoice",r),jt("lastUpdated",new Date),r}catch(r){const n=r instanceof Error?r.message:"Failed to update invoice";throw jt("error",n),console.error("Error updating invoice:",r),r}finally{on(r=>({...r,update:!1}))}},async deleteInvoice(t){try{return on(e=>({...e,delete:!0})),jt("error",null),jt("invoices",e=>e.filter(r=>r.invoice!==t)),Xs.selectedInvoice?.invoice===t&&jt("selectedInvoice",null),jt("lastUpdated",new Date),!0}catch(e){const r=e instanceof Error?e.message:"Failed to delete invoice";throw jt("error",r),console.error("Error deleting invoice:",e),e}finally{on(e=>({...e,delete:!1}))}},async fetchInvoiceStats(t){try{jt("error",null);const e=new URLSearchParams;t?.store&&t.store!=="all"&&e.append("store",t.store),t?.dateFrom&&e.append("dateFrom",t.dateFrom),t?.dateTo&&e.append("dateTo",t.dateTo);const r=e.toString();return[]}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoice statistics";throw jt("error",r),console.error("Error fetching invoice stats:",e),e}},async fetchStores(){try{return jt("error",null),[]}catch(t){const e=t instanceof Error?t.message:"Failed to fetch stores";throw jt("error",e),console.error("Error fetching stores:",t),t}},setSelectedInvoice(t){jt("selectedInvoice",t)},clearError(){jt("error",null)},getFilteredInvoices(t){let e=Xs.invoices;if(t.store&&t.store!=="all"&&(e=e.filter(r=>r.store===t.store)),t.dateFrom){const r=new Date(t.dateFrom).getTime();e=e.filter(n=>n.createDate>=r)}if(t.dateTo){const r=new Date(t.dateTo).setHours(23,59,59,999);e=e.filter(n=>n.createDate<=r)}if(t.status&&t.status!=="all"){const r=t.status==="completed";e=e.filter(n=>n.isCompleted===r)}return e},calculateSummary(t){let e=t.length,r=t.filter(w=>w.isCompleted).length,n=0,o=0,i=0,a=0,c=0,d=0,h=new Set,y=new Set;t?.forEach(w=>{h.add(w?.shipper_consignee?.cid),y.add(w.store),w?.products?.forEach(E=>{const V=Math.abs(E?.qty);n+=V,i+=V*(parseFloat(E?.salePrice)||1)}),w?.reservas?.forEach(E=>{let V=parseInt(E?.qty);isNaN(V)&&(V=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[E.type]||E?.onlyTariff?(V=parseFloat(E.arancel)||parseFloat(E.qty)*parseFloat(E.price),d+=V):(E?.arancel&&(c+=parseFloat(E?.arancel)),o+=V,a+=V*parseFloat(E?.price))})});const v=i+a+d;return{totalInvoices:e,completedInvoices:r,pendingInvoices:e-r,totalProducts:n,totalReservas:o,totalProductAmount:i,totalReservaAmount:a,totalAranceles:c,grandTotal:v,totalOther:d,uniqueCustomers:h.size,uniqueStores:y.size,avgInvoiceValue:e>0?v/e:0}},async refreshData(t){return console.log(" fetchInvoices {queryString}"),this.fetchInvoices(t)}};var t$=G("<div><div>"),r$=G("<div> "),n$=G("<div><div><label></label><select><option value=all></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date>"),o$=G("<div><button></button><button>"),_o=G("<div>"),i$=G("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),s$=G("<button> "),a$=G("<option>"),l$=G("<div><div></div><div></div><div></div><div>"),xm=G("<div><span></span><span> "),c$=G("<div><span></span><span> $"),u$=G("<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td><span></span></td><td><button>");const d$=t=>{const{t:e}=ct(),[r,n]=ve(!1),[o,i]=ve("all"),[a,c]=ve(""),[d,h]=ve(""),[y,v]=ve(null),[w,E]=ve("dashboard"),[V,N]=ve([]),[x,k]=ve("overview");Hr(async()=>{try{t.invoices||console.log("fetchInvoices"),await Ur.fetchInvoices();try{const Z=await Ur.fetchStores();let L=Array.isArray(Z)?Z:Object.keys(Z)||[];console.log(L)}catch{const L=Ur.state.invoices||t.invoices,te=[...new Set(L.map(j=>j.store))];N(te.sort())}}catch(Z){console.error("Error loading dashboard data:",Z)}}),qe(()=>Ur.state.invoices||t.invoices);const re=qe(()=>t.invoices?Ur.getFilteredInvoices({store:o(),dateFrom:a(),dateTo:d()}):Ur.getFilteredInvoices({store:o(),dateFrom:a(),dateTo:d()})),ae=async()=>{try{t.invoices,n(!0),await Ur.refreshData({store:o()!=="all"?o():void 0,dateFrom:a()||void 0,dateTo:d()||void 0}),n(!1)}catch(Z){console.error("Error refreshing data:",Z)}},F=qe(()=>{console.log("summary",r()),r();const Z=re(),L=Ur.calculateSummary(Z);let te=new Map,j=new Map,M=new Map;return Z.forEach(ie=>{ie?.products?.forEach(oe=>{const fe=Math.abs(oe.qty),ue=oe.product.label;te.set(ue,(te.get(ue)||0)+fe)}),ie?.reservas?.forEach(oe=>{let fe=parseInt(oe.qty);isNaN(fe)&&(fe=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[oe.type]||oe?.onlyTariff?(fe=parseFloat(oe.arancel)||parseFloat(oe.qty)*parseFloat(oe.price),M.set(oe.type,(j.get(oe.type)||0)+fe)):j.set(oe.type,(j.get(oe.type)||0)+fe)})}),{...L,productsByCategory:te,reservasByType:j,othersByType:M}}),Y=Z=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Z),U=Z=>new Date(Z).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),b={padding:"2rem"},g={display:"flex",gap:"1rem","align-items":"flex-end","margin-bottom":"2rem","flex-wrap":"wrap",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)"},p={display:"flex","flex-direction":"column",gap:"0.5rem",flex:"1","min-width":"200px"},C={"font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)"},S={padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--background-color)"},A={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(280px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},m={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)"},ne={width:"48px",height:"48px","border-radius":"12px",display:"flex","align-items":"center","justify-content":"center","font-size":"1.5rem","margin-bottom":"1rem"},W={"font-size":"0.875rem",color:"var(--text-secondary)","margin-bottom":"0.5rem"},I={"font-size":"1.75rem","font-weight":"700",color:"var(--text-primary)","margin-bottom":"0.25rem"},O={"font-size":"0.75rem",color:"var(--text-muted)"},J={width:"100%",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)",overflow:"hidden"},D={padding:"1rem","text-align":"left",background:"var(--background-color)","font-weight":"600",color:"var(--text-secondary)","font-size":"0.875rem","border-bottom":"2px solid var(--border-color)"},T={padding:"1rem","border-bottom":"1px solid var(--border-color)"},B={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},me=Z=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:Z?"var(--primary-color)":"var(--text-muted)","border-bottom":Z?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),H={padding:"0.5rem 1rem",background:"var(--primary-color)",color:"white",border:"none","border-radius":"var(--border-radius-sm)",cursor:"pointer","font-size":"0.875rem",transition:"opacity 0.2s"},de={padding:"0.75rem 1.5rem",background:"var(--secondary-color)",color:"white",border:"none","border-radius":"var(--border-radius-sm)",cursor:"pointer","margin-bottom":"1rem",display:"flex","align-items":"center",gap:"0.5rem"},$=()=>[{title:e("invoices.totalRevenue"),value:F().grandTotal,icon:"",color:"#4CAF50",subtext:`${e("common.of")} ${F().totalInvoices} ${e("common.invoice")} `},{title:e("invoices.totalProducts"),value:F().totalProducts,icon:"",color:"#2196F3",subtext:`${Y(F().totalProductAmount)} ${e("invoices.value")}`,isNumber:!0},{title:e("invoices.totalReservations"),value:F().totalReservas,icon:"",color:"#FF9800",subtext:`${Y(F().totalReservaAmount)} ${e("invoices.value")}`,isNumber:!0},{title:e("invoices.aranceles"),value:F().totalAranceles,icon:"",color:"#9C27B0",subtext:e("invoices.customsFees")},{title:e("invoices.uniqueCustomers"),value:F().uniqueCustomers,icon:"",color:"#00BCD4",subtext:e("invoices.activeCustomers"),isNumber:!0},{title:e("invoices.averageInvoice"),value:F().avgInvoiceValue,icon:"",color:"#FF5722",subtext:e("invoices.perInvoiceValue")},{title:e("invoices.completed"),value:F().completedInvoices,icon:"",color:"#4CAF50",subtext:`${F().pendingInvoices} ${e("invoices.pending")}`,isNumber:!0},{title:e("invoices.storesActive"),value:V().length,icon:"",color:"#795548",subtext:e("invoices.locations"),isNumber:!0}],q=()=>Ne.getActiveLocations();return Nn(()=>{}),_(Br,{get title(){return e("invoices.title")},get children(){var Z=_o();return u(Z,b),s(Z,_(De,{get when(){return w()==="dashboard"},get children(){return[_(De,{get when(){return!t.invoices&&Ur.state.loading},get children(){var L=t$(),te=L.firstChild;return L.style.setProperty("text-align","center"),L.style.setProperty("padding","2rem"),te.style.setProperty("font-size","1.25rem"),te.style.setProperty("margin-bottom","1rem"),s(te,()=>e("invoices.loadingInvoices")),L}}),_(De,{get when(){return Ur.state.error},get children(){var L=r$();return L.firstChild,L.style.setProperty("padding","1rem"),L.style.setProperty("margin-bottom","1rem"),L.style.setProperty("background","#ffebee"),L.style.setProperty("border","1px solid #ffcdd2"),L.style.setProperty("border-radius","var(--border-radius)"),L.style.setProperty("color","#d32f2f"),s(L,()=>Ur.state.error,null),s(L,_(Le,{variant:"outline",size:"sm",onClick:ae,style:{"margin-left":"1rem"},get children(){return e("invoices.refreshData")}}),null),L}}),(()=>{var L=n$(),te=L.firstChild,j=te.firstChild,M=j.nextSibling,ie=M.firstChild,oe=te.nextSibling,fe=oe.firstChild,ue=fe.nextSibling,K=oe.nextSibling,R=K.firstChild,ee=R.nextSibling;return u(L,g),s(j,()=>e("invoices.storeLocation")),M.addEventListener("change",X=>i(X.currentTarget.value)),s(ie,()=>e("invoices.allStores")),s(M,_(at,{get each(){return q()},children:X=>(()=>{var ye=a$();return s(ye,()=>X.name),le(()=>ye.value=X.id),ye})()}),null),s(fe,()=>e("invoices.fromDate")),ue.addEventListener("change",X=>c(X.currentTarget.value)),s(R,()=>e("invoices.toDate")),ee.addEventListener("change",X=>h(X.currentTarget.value)),s(L,_(Le,{variant:"secondary",onClick:()=>{i("all"),c(""),h("")},get children(){return e("invoices.clearFilters")}}),null),s(L,_(Le,{variant:"primary",onClick:ae,get disabled(){return!t.invoices&&Ur.state.loading},get children(){return[" ",ge(()=>e("invoices.refreshData"))]}}),null),le(X=>{var ye=p,pe=C,z=S,se=p,_e=C,Pe=S,he=p,be=C,ce=S;return X.e=u(te,ye,X.e),X.t=u(j,pe,X.t),X.a=u(M,z,X.a),X.o=u(oe,se,X.o),X.i=u(fe,_e,X.i),X.n=u(ue,Pe,X.n),X.s=u(K,he,X.s),X.h=u(R,be,X.h),X.r=u(ee,ce,X.r),X},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),le(()=>M.value=o()),le(()=>ue.value=a()),le(()=>ee.value=d()),L})(),(()=>{var L=o$(),te=L.firstChild,j=te.nextSibling;return u(L,B),te.$$click=()=>k("overview"),s(te,()=>e("inventory.overview")),j.$$click=()=>k("invoices"),s(j,()=>e("common.invoices")),le(M=>{var ie=me(x()==="overview"),oe=me(x()==="invoices");return M.e=u(te,ie,M.e),M.t=u(j,oe,M.t),M},{e:void 0,t:void 0}),L})(),_(De,{get when(){return x()==="overview"},get children(){return[(()=>{var L=_o();return u(L,A),s(L,_(at,{get each(){return $()},children:te=>(()=>{var j=l$(),M=j.firstChild,ie=M.nextSibling,oe=ie.nextSibling,fe=oe.nextSibling;return u(j,m),s(M,()=>te?.icon),u(ie,W),s(ie,()=>te?.title),u(oe,I),s(oe,(()=>{var ue=ge(()=>!!te.isNumber);return()=>ue()?te.value:Y(te.value)})()),u(fe,O),s(fe,()=>te.subtext),le(ue=>u(M,{...ne,background:`${te?.color}20`,color:te?.color},ue)),j})()})),L})(),_(De,{get when(){return F()?.productsByCategory?.size>0},get children(){return _(He,{get title(){return e("invoices.topProducts")},get subtitle(){return e("invoices.mostSoldProducts")},get children(){var L=_o();return L.style.setProperty("max-height","300px"),L.style.setProperty("overflow-y","auto"),s(L,()=>Array.from(F().productsByCategory.entries()).sort((te,j)=>j[1]-te[1]).slice(0,10).map(([te,j])=>(()=>{var M=xm(),ie=M.firstChild,oe=ie.nextSibling,fe=oe.firstChild;return M.style.setProperty("display","flex"),M.style.setProperty("justify-content","space-between"),M.style.setProperty("padding","0.75rem"),M.style.setProperty("border-bottom","1px solid var(--border-color)"),s(ie,te),oe.style.setProperty("font-weight","600"),s(oe,j,fe),s(oe,()=>e("common.units"),null),M})())),L}})}}),(()=>{var L=_o();return L.style.setProperty("margin","19px"),L})(),_(De,{get when(){return F()?.reservasByType?.size>0},get children(){return _(He,{get title(){return e("invoices.reservationsByType")},get subtitle(){return e("invoices.distributionOfCategories")},style:{"margin-top":"1.5rem"},get children(){var L=_o();return L.style.setProperty("max-height","300px"),L.style.setProperty("overflow-y","auto"),s(L,()=>Array.from(F().reservasByType.entries()).sort((te,j)=>j[1]-te[1]).map(([te,j])=>(()=>{var M=xm(),ie=M.firstChild,oe=ie.nextSibling,fe=oe.firstChild;return M.style.setProperty("display","flex"),M.style.setProperty("justify-content","space-between"),M.style.setProperty("padding","0.75rem"),M.style.setProperty("border-bottom","1px solid var(--border-color)"),s(ie,te),oe.style.setProperty("font-weight","600"),s(oe,j,fe),s(oe,()=>e("common.lbs"),null),M})())),L}})}}),(()=>{var L=_o();return L.style.setProperty("margin","19px"),L})(),_(De,{get when(){return F()?.othersByType?.size>0},get children(){return _(He,{title:"Aranceles y otros servicios",get subtitle(){return e("invoices.distributionOfCategories")},style:{"margin-top":"1.5rem"},get children(){var L=_o();return L.style.setProperty("max-height","300px"),L.style.setProperty("overflow-y","auto"),s(L,()=>Array.from(F().othersByType.entries()).sort((te,j)=>j[1]-te[1]).map(([te,j])=>(()=>{var M=c$(),ie=M.firstChild,oe=ie.nextSibling,fe=oe.firstChild;return M.style.setProperty("display","flex"),M.style.setProperty("justify-content","space-between"),M.style.setProperty("padding","0.75rem"),M.style.setProperty("border-bottom","1px solid var(--border-color)"),s(ie,te),oe.style.setProperty("font-weight","600"),s(oe,j,fe),M})())),L}})}})]}})]}}),null),s(Z,_(De,{get when(){return x()==="invoices"},get children(){return[_(De,{get when(){return w()!=="detail"},get children(){return _(He,{get title(){return e("invoices.recentInvoices")},get subtitle(){return e("invoices.showingInvoices",{count:re().length})},style:{"margin-top":"1.5rem"},get children(){var L=i$(),te=L.firstChild,j=te.firstChild,M=j.firstChild,ie=M.firstChild,oe=ie.nextSibling,fe=oe.nextSibling,ue=fe.nextSibling,K=ue.nextSibling,R=K.nextSibling,ee=R.nextSibling,X=ee.nextSibling,ye=X.nextSibling,pe=j.nextSibling;return L.style.setProperty("overflow-x","auto"),u(te,J),s(ie,()=>e("invoices.invoiceNumber")),s(oe,()=>e("invoices.date")),s(fe,()=>e("invoices.customer")),s(ue,()=>e("invoices.store")),s(K,()=>e("invoices.products")),s(R,()=>e("invoices.reservations")),s(ee,()=>e("invoices.total")),s(X,()=>e("invoices.status")),s(ye,()=>e("invoices.actions")),s(pe,_(at,{get each(){return re().slice(0,50)},children:z=>{const se=()=>{console.log(z);let _e=0,Pe=0,he=0,be=0;z?.products?.forEach(ce=>{const Se=Math.abs(ce?.qty),Ee=parseFloat(ce?.salePrice)||1;_e+=Se*Ee}),z?.reservas?.forEach(ce=>{let Se=parseInt(ce?.qty);return isNaN(Se)&&(Se=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[ce.type]||ce?.onlyTariff?(Se=parseFloat(ce.arancel)||parseFloat(ce.qty)*parseFloat(ce.price),be+=Se):(ce?.arancel&&(he+=parseFloat(ce?.arancel)),Pe+=Se*parseFloat(ce?.price)),{total:_e+Pe+he+be,totalProductAmount:_e,totalReservaAmount:Pe,totalAranceles:he,totalOther:be}})};return(()=>{var _e=u$(),Pe=_e.firstChild,he=Pe.nextSibling,be=he.nextSibling,ce=be.nextSibling,Se=ce.nextSibling,Ee=Se.nextSibling,$e=Ee.nextSibling,ke=$e.nextSibling,Me=ke.firstChild,Ke=ke.nextSibling,je=Ke.firstChild;return s(Pe,()=>z?.invoice),s(he,()=>U(z?.createDate)),s(be,()=>z?.shipper_consignee?.name),s(ce,()=>z?.store),s(Se,()=>se()?.totalProductAmount),s(Ee,()=>se()?.totalReservaAmount),s($e,()=>Y(se()?.total)),Me.style.setProperty("padding","0.25rem 0.75rem"),Me.style.setProperty("border-radius","9999px"),Me.style.setProperty("font-size","0.75rem"),Me.style.setProperty("font-weight","600"),s(Me,(()=>{var Ce=ge(()=>!!z.isCompleted);return()=>Ce()?e("invoices.completed"):e("invoices.pending")})()),je.addEventListener("mouseleave",Ce=>Ce.currentTarget.style.opacity="1"),je.addEventListener("mouseenter",Ce=>Ce.currentTarget.style.opacity="0.8"),je.$$click=()=>{v(z),E("detail")},u(je,H),s(je,()=>e("invoices.view")),le(Ce=>{var Fe=T,Qe=T,We=T,Je=T,xe=T,ot=T,et={...T,"text-align":"right","font-weight":"600"},Ct=T,mt=z.isCompleted?"#d4edda":"#fff3cd",Dt=z.isCompleted?"#155724":"#856404",$t=T;return Ce.e=u(Pe,Fe,Ce.e),Ce.t=u(he,Qe,Ce.t),Ce.a=u(be,We,Ce.a),Ce.o=u(ce,Je,Ce.o),Ce.i=u(Se,xe,Ce.i),Ce.n=u(Ee,ot,Ce.n),Ce.s=u($e,et,Ce.s),Ce.h=u(ke,Ct,Ce.h),mt!==Ce.r&&((Ce.r=mt)!=null?Me.style.setProperty("background",mt):Me.style.removeProperty("background")),Dt!==Ce.d&&((Ce.d=Dt)!=null?Me.style.setProperty("color",Dt):Me.style.removeProperty("color")),Ce.l=u(Ke,$t,Ce.l),Ce},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),_e})()}})),le(z=>{var se=D,_e=D,Pe=D,he=D,be=D,ce=D,Se={...D,"text-align":"right"},Ee=D,$e=D;return z.e=u(ie,se,z.e),z.t=u(oe,_e,z.t),z.a=u(fe,Pe,z.a),z.o=u(ue,he,z.o),z.i=u(K,be,z.i),z.n=u(R,ce,z.n),z.s=u(ee,Se,z.s),z.h=u(X,Ee,z.h),z.r=u(ye,$e,z.r),z},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),L}})}}),_(De,{get when(){return ge(()=>w()==="detail")()&&y()},get children(){return[(()=>{var L=s$();return L.firstChild,L.$$click=()=>{E("dashboard"),v(null)},u(L,de),s(L,()=>e("invoices.backToDashboard"),null),L})(),_(Z2,{get invoice(){return y()},onPrint:()=>window.print()})]}})]}}),null),Z}})};Pt(["click"]);const h$=()=>_(d$,{invoices:[{type:"SALES",invoice:"20255FK6S4B43SSS",description:"",store:"YY_8816",ssg_inventory_key:"JqdrRwGBpdBfRCim",ssg_sorder_key:"JqdrRwGBpdBfRCim",createDate:1736132690425,shipper_consignee:{name:"Yudith Perez Medero",phoneNumberS:"5022408378",dob:"1982-07-23",firstName:"RAUL",lastName:"BATISTA",lastName2:"ESPOSITO",middleName:"",email:"",phoneNumber:"52393232",altPhoneNumber:"",cid:"48121007305",ybstreetNo:"9",ybstreet:"10",ybbetwen1:"CARRALERO",ybbetwen2:"3RA",ybapt:"",ybreparto:"PUEBLO NUEVO",consigneeId:"26144",ssg_consignee_key:"26144",passport:"NA",nacionality:"CUB",ybcity:"HOLGUIN",ybestate:"HOLGUIN",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534800",reservas:[{type:"UTILES DEL HOGAR",qty:"15",arancel:"10",price:"5",key:"1GB16SD80"},{type:"MISCELANEAS",qty:"19",arancel:"",price:"4",key:"0DS6K14Y2"}],products:[{product:{id:"CmrhMfVjLR9HxT6P",label:"FOGONES ELECTRICO DOBLE RESISTENCIA DE ALAMBRE",code:"978Y82K94"},qty:-1,price:23.696296296296296,salePrice:"34"},{product:{id:"ov56aPYGbXIq4XGy",label:"Caramelos",code:"C852CSKB5"},qty:-2,price:5.990000000000001,salePrice:"10"}],isCompleted:!0},{type:"SALES",invoice:"20255FK6S4B43TTT",description:"",store:"YY_8803",ssg_inventory_key:"JqdrRwGBpdBfRCin",ssg_sorder_key:"JqdrRwGBpdBfRCin",createDate:1736032690425,shipper_consignee:{name:"Maria Rodriguez Santos",phoneNumberS:"5024567890",dob:"1990-03-15",firstName:"MARIA",lastName:"RODRIGUEZ",lastName2:"SANTOS",middleName:"ELENA",email:"maria@email.com",phoneNumber:"52987654",altPhoneNumber:"",cid:"90031507890",ybstreetNo:"15",ybstreet:"23",ybbetwen1:"MARTI",ybbetwen2:"CESPEDES",ybapt:"2A",ybreparto:"CENTRO",consigneeId:"26145",ssg_consignee_key:"26145",passport:"A1234567",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534801",reservas:[{type:"ELECTRONICOS",qty:"5",arancel:"15",price:"12",key:"2GB16SD81"},{type:"ROPA Y CALZADO",qty:"8",arancel:"8",price:"7",key:"0DS6K14Y3"}],products:[{product:{id:"XmrhMfVjLR9HxT6Q",label:"TELEVISOR LED 32 PULGADAS",code:"TV32LED01"},qty:-1,price:150.5,salePrice:"220"},{product:{id:"Yv56aPYGbXIq4XGz",label:"Zapatos Deportivos Nike",code:"ZAP001"},qty:-1,price:45.99,salePrice:"75"}],isCompleted:!1},{type:"SALES",invoice:"20255FK6S4B43UUU",description:"",store:"YY_8816",ssg_inventory_key:"JqdrRwGBpdBfRCio",ssg_sorder_key:"JqdrRwGBpdBfRCio",createDate:1735932690425,shipper_consignee:{name:"Carlos Mendez Perez",phoneNumberS:"5025678901",dob:"1975-12-08",firstName:"CARLOS",lastName:"MENDEZ",lastName2:"PEREZ",middleName:"ANTONIO",email:"",phoneNumber:"52876543",altPhoneNumber:"",cid:"75120878901",ybstreetNo:"7",ybstreet:"45",ybbetwen1:"LINEA",ybbetwen2:"PASEO",ybapt:"",ybreparto:"VEDADO",consigneeId:"26146",ssg_consignee_key:"26146",passport:"NA",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534802",reservas:[{type:"ALIMENTOS",qty:"25",arancel:"5",price:"3",key:"3GB16SD82"}],products:[{product:{id:"ZmrhMfVjLR9HxT6R",label:"ARROZ ESPECIAL 5LB",code:"ARZ005"},qty:-5,price:2.5,salePrice:"4"},{product:{id:"Av56aPYGbXIq4XG1",label:"ACEITE DE COCINA 1L",code:"ACE001"},qty:-3,price:3.75,salePrice:"6"}],isCompleted:!0},{type:"SALES",invoice:"20255FK6S4B43VVV",description:"",store:"YY_8802",ssg_inventory_key:"JqdrRwGBpdBfRCip",ssg_sorder_key:"JqdrRwGBpdBfRCip",createDate:1735832690425,shipper_consignee:{name:"Ana Lucia Fernandez",phoneNumberS:"5026789012",dob:"1988-06-20",firstName:"ANA",lastName:"FERNANDEZ",lastName2:"LOPEZ",middleName:"LUCIA",email:"ana.lucia@email.com",phoneNumber:"52765432",altPhoneNumber:"52111222",cid:"88062076789",ybstreetNo:"12",ybstreet:"18",ybbetwen1:"CALZADA",ybbetwen2:"SAN LAZARO",ybapt:"3B",ybreparto:"CENTRO HABANA",consigneeId:"26147",ssg_consignee_key:"26147",passport:"B9876543",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:"Entrega en horario de oficina"},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534803",reservas:[{type:"MEDICINA Y SALUD",qty:"10",arancel:"12",price:"8",key:"4GB16SD83"},{type:"UTILES DEL HOGAR",qty:"6",arancel:"6",price:"4",key:"5GB16SD84"}],products:[{product:{id:"BmrhMfVjLR9HxT6S",label:"VITAMINAS MULTIPLES 60 CAP",code:"VIT001"},qty:-2,price:12.5,salePrice:"18"}],isCompleted:!0}]});var m$=G("<div><main>");const y$=t=>[_(rC,{}),ge(()=>t.children)],f$=()=>_(Rw,{get children(){var t=m$(),e=t.firstChild;return s(e,_(tv,{root:y$,get children(){return[_(Kr,{path:"/",component:N2}),_(Kr,{path:"/accounts",component:()=>_(rn,{permission:"AccountAccess",featureName:"Accounts",get children(){return _(tA,{})}})}),_(Kr,{path:"/accounts/:id",component:()=>_(rn,{permission:"AccountAccess",featureName:"Account Details",get children(){return _(lA,{})}})}),_(Kr,{path:"/entry-books",component:()=>_(rn,{permission:"JournalAccess",featureName:"Entry Books",get children(){return _(I2,{})}})}),_(Kr,{path:"/employees",component:()=>_(rn,{permission:"EmployeeAccess",featureName:"Employee Management",get children(){return _(zI,{})}})}),_(Kr,{path:"/bank-consolidations",component:()=>_(rn,{permission:"BankingAccess",featureName:"Bank Consolidations",get children(){return _(gE,{})}})}),_(Kr,{path:"/balance-sheet",component:()=>_(rn,{permission:"AccountAccess",featureName:"Balance Sheet",get children(){return _(yA,{})}})}),_(Kr,{path:"/invoices",component:()=>_(rn,{permission:"invoiceAccess",featureName:"Invoices",get children(){return _(h$,{})}})}),_(Kr,{path:"/inventory",component:()=>_(rn,{permission:"InventoryAccess",featureName:"Inventory Management",get children(){return _(NI,{})}})}),_(Kr,{path:"/products",component:()=>_(rn,{permission:"InventoryAccess",featureName:"Product Management",get children(){return _(Tp,{})}})}),_(Kr,{path:"/admin/users",component:()=>_(rn,{permission:"isAdmin",featureName:"User Administration",get children(){return _(G2,{})}})})]}})),s(t,(()=>{var r=ge(()=>!1);return()=>r()&&_(yC,{})})(),null),t}}),p$=document.getElementById("root");pg(()=>_(f$,{}),p$);export{Dp as _};
