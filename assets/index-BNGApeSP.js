const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/enhancedInvoicePdfGenerator-BhxIBI5e.js","assets/jspdf.es.min-5BvNmcXe.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(o){if(o.ep)return;o.ep=!0;const s=r(o);fetch(o.href,s)}})();const hg=!1,mg=(t,e)=>t===e,wn=Symbol("solid-proxy"),ey=typeof Proxy=="function",hc=Symbol("solid-track"),xa={equals:mg};let ty=cy;const xo=1,$a=2,ry={owned:null,cleanups:null,context:null,owner:null};var Zt=null;let Rl=null,yg=null,ir=null,qr=null,Wn=null,Za=0;function es(t,e){const r=ir,n=Zt,o=t.length===0,s=e===void 0?n:e,a=o?ry:{owned:null,cleanups:null,context:s?s.context:null,owner:s},l=o?t:()=>t(()=>sn(()=>cs(a)));Zt=a,ir=null;try{return $o(l,!0)}finally{ir=r,Zt=n}}function ye(t,e){e=e?Object.assign({},xa,e):xa;const r={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},n=o=>(typeof o=="function"&&(o=o(r.value)),ly(r,o));return[ay.bind(r),n]}function X(t,e,r){const n=Xc(t,e,!1,xo);Cs(n)}function fn(t,e,r){ty=vg;const n=Xc(t,e,!1,xo);n.user=!0,Wn?Wn.push(n):Cs(n)}function Ze(t,e,r){r=r?Object.assign({},xa,r):xa;const n=Xc(t,e,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=r.equals||void 0,Cs(n),ay.bind(n)}function ny(t){return $o(t,!1)}function sn(t){if(ir===null)return t();const e=ir;ir=null;try{return t()}finally{ir=e}}function Kc(t,e,r){const n=Array.isArray(t);let o,s=r&&r.defer;return a=>{let l;if(n){l=Array(t.length);for(let h=0;h<t.length;h++)l[h]=t[h]()}else l=t();if(s)return s=!1,a;const u=sn(()=>e(l,o,a));return o=l,u}}function $r(t){fn(()=>sn(t))}function Ai(t){return Zt===null||(Zt.cleanups===null?Zt.cleanups=[t]:Zt.cleanups.push(t)),t}function mc(){return ir}function oy(){return Zt}function iy(t,e){const r=Zt,n=ir;Zt=t,ir=null;try{return $o(e,!0)}catch(o){Zc(o)}finally{Zt=r,ir=n}}function pg(t){const e=ir,r=Zt;return Promise.resolve().then(()=>{ir=e,Zt=r;let n;return $o(t,!1),ir=Zt=null,n?n.done:void 0})}const[nk,ok]=ye(!1);function sy(t,e){const r=Symbol("context");return{id:r,Provider:_g(r),defaultValue:t}}function Qc(t){let e;return Zt&&Zt.context&&(e=Zt.context[t.id])!==void 0?e:t.defaultValue}function Jc(t){const e=Ze(t),r=Ze(()=>yc(e()));return r.toArray=()=>{const n=r();return Array.isArray(n)?n:n!=null?[n]:[]},r}function ay(){if(this.sources&&this.state)if(this.state===xo)Cs(this);else{const t=qr;qr=null,$o(()=>Ia(this),!1),qr=t}if(ir){const t=this.observers?this.observers.length:0;ir.sources?(ir.sources.push(this),ir.sourceSlots.push(t)):(ir.sources=[this],ir.sourceSlots=[t]),this.observers?(this.observers.push(ir),this.observerSlots.push(ir.sources.length-1)):(this.observers=[ir],this.observerSlots=[ir.sources.length-1])}return this.value}function ly(t,e,r){let n=t.value;return(!t.comparator||!t.comparator(n,e))&&(t.value=e,t.observers&&t.observers.length&&$o(()=>{for(let o=0;o<t.observers.length;o+=1){const s=t.observers[o],a=Rl&&Rl.running;a&&Rl.disposed.has(s),(a?!s.tState:!s.state)&&(s.pure?qr.push(s):Wn.push(s),s.observers&&dy(s)),a||(s.state=xo)}if(qr.length>1e6)throw qr=[],new Error},!1)),e}function Cs(t){if(!t.fn)return;cs(t);const e=Za;fg(t,t.value,e)}function fg(t,e,r){let n;const o=Zt,s=ir;ir=Zt=t;try{n=t.fn(e)}catch(a){return t.pure&&(t.state=xo,t.owned&&t.owned.forEach(cs),t.owned=null),t.updatedAt=r+1,Zc(a)}finally{ir=s,Zt=o}(!t.updatedAt||t.updatedAt<=r)&&(t.updatedAt!=null&&"observers"in t?ly(t,n):t.value=n,t.updatedAt=r)}function Xc(t,e,r,n=xo,o){const s={fn:t,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:Zt,context:Zt?Zt.context:null,pure:r};return Zt===null||Zt!==ry&&(Zt.owned?Zt.owned.push(s):Zt.owned=[s]),s}function Aa(t){if(t.state===0)return;if(t.state===$a)return Ia(t);if(t.suspense&&sn(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<Za);)t.state&&e.push(t);for(let r=e.length-1;r>=0;r--)if(t=e[r],t.state===xo)Cs(t);else if(t.state===$a){const n=qr;qr=null,$o(()=>Ia(t,e[0]),!1),qr=n}}function $o(t,e){if(qr)return t();let r=!1;e||(qr=[]),Wn?r=!0:Wn=[],Za++;try{const n=t();return gg(r),n}catch(n){r||(Wn=null),qr=null,Zc(n)}}function gg(t){if(qr&&(cy(qr),qr=null),t)return;const e=Wn;Wn=null,e.length&&$o(()=>ty(e),!1)}function cy(t){for(let e=0;e<t.length;e++)Aa(t[e])}function vg(t){let e,r=0;for(e=0;e<t.length;e++){const n=t[e];n.user?t[r++]=n:Aa(n)}for(e=0;e<r;e++)Aa(t[e])}function Ia(t,e){t.state=0;for(let r=0;r<t.sources.length;r+=1){const n=t.sources[r];if(n.sources){const o=n.state;o===xo?n!==e&&(!n.updatedAt||n.updatedAt<Za)&&Aa(n):o===$a&&Ia(n,e)}}}function dy(t){for(let e=0;e<t.observers.length;e+=1){const r=t.observers[e];r.state||(r.state=$a,r.pure?qr.push(r):Wn.push(r),r.observers&&dy(r))}}function cs(t){let e;if(t.sources)for(;t.sources.length;){const r=t.sources.pop(),n=t.sourceSlots.pop(),o=r.observers;if(o&&o.length){const s=o.pop(),a=r.observerSlots.pop();n<o.length&&(s.sourceSlots[a]=n,o[n]=s,r.observerSlots[n]=a)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)cs(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)cs(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function bg(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function Zc(t,e=Zt){throw bg(t)}function yc(t){if(typeof t=="function"&&!t.length)return yc(t());if(Array.isArray(t)){const e=[];for(let r=0;r<t.length;r++){const n=yc(t[r]);Array.isArray(n)?e.push.apply(e,n):e.push(n)}return e}return t}function _g(t,e){return function(n){let o;return X(()=>o=sn(()=>(Zt.context={...Zt.context,[t]:n.value},Jc(()=>n.children))),void 0),o}}const Sg=Symbol("fallback");function xu(t){for(let e=0;e<t.length;e++)t[e]()}function Pg(t,e,r={}){let n=[],o=[],s=[],a=0,l=e.length>1?[]:null;return Ai(()=>xu(s)),()=>{let u=t()||[],h=u.length,m,v;return u[hc],sn(()=>{let x,T,E,P,R,Y,Z,j,B;if(h===0)a!==0&&(xu(s),s=[],n=[],o=[],a=0,l&&(l=[])),r.fallback&&(n=[Sg],o[0]=es(V=>(s[0]=V,r.fallback())),a=1);else if(a===0){for(o=new Array(h),v=0;v<h;v++)n[v]=u[v],o[v]=es(_);a=h}else{for(E=new Array(h),P=new Array(h),l&&(R=new Array(h)),Y=0,Z=Math.min(a,h);Y<Z&&n[Y]===u[Y];Y++);for(Z=a-1,j=h-1;Z>=Y&&j>=Y&&n[Z]===u[j];Z--,j--)E[j]=o[Z],P[j]=s[Z],l&&(R[j]=l[Z]);for(x=new Map,T=new Array(j+1),v=j;v>=Y;v--)B=u[v],m=x.get(B),T[v]=m===void 0?-1:m,x.set(B,v);for(m=Y;m<=Z;m++)B=n[m],v=x.get(B),v!==void 0&&v!==-1?(E[v]=o[m],P[v]=s[m],l&&(R[v]=l[m]),v=T[v],x.set(B,v)):s[m]();for(v=Y;v<h;v++)v in E?(o[v]=E[v],s[v]=P[v],l&&(l[v]=R[v],l[v](v))):o[v]=es(_);o=o.slice(0,a=h),n=u.slice(0)}return o});function _(x){if(s[v]=x,l){const[T,E]=ye(v);return l[v]=E,e(u[v],T)}return e(u[v])}}}function b(t,e){return sn(()=>t(e||{}))}function Ys(){return!0}const pc={get(t,e,r){return e===wn?r:t.get(e)},has(t,e){return e===wn?!0:t.has(e)},set:Ys,deleteProperty:Ys,getOwnPropertyDescriptor(t,e){return{configurable:!0,enumerable:!0,get(){return t.get(e)},set:Ys,deleteProperty:Ys}},ownKeys(t){return t.keys()}};function Dl(t){return(t=typeof t=="function"?t():t)?t:{}}function wg(){for(let t=0,e=this.length;t<e;++t){const r=this[t]();if(r!==void 0)return r}}function fc(...t){let e=!1;for(let a=0;a<t.length;a++){const l=t[a];e=e||!!l&&wn in l,t[a]=typeof l=="function"?(e=!0,Ze(l)):l}if(ey&&e)return new Proxy({get(a){for(let l=t.length-1;l>=0;l--){const u=Dl(t[l])[a];if(u!==void 0)return u}},has(a){for(let l=t.length-1;l>=0;l--)if(a in Dl(t[l]))return!0;return!1},keys(){const a=[];for(let l=0;l<t.length;l++)a.push(...Object.keys(Dl(t[l])));return[...new Set(a)]}},pc);const r={},n=Object.create(null);for(let a=t.length-1;a>=0;a--){const l=t[a];if(!l)continue;const u=Object.getOwnPropertyNames(l);for(let h=u.length-1;h>=0;h--){const m=u[h];if(m==="__proto__"||m==="constructor")continue;const v=Object.getOwnPropertyDescriptor(l,m);if(!n[m])n[m]=v.get?{enumerable:!0,configurable:!0,get:wg.bind(r[m]=[v.get.bind(l)])}:v.value!==void 0?v:void 0;else{const _=r[m];_&&(v.get?_.push(v.get.bind(l)):v.value!==void 0&&_.push(()=>v.value))}}}const o={},s=Object.keys(n);for(let a=s.length-1;a>=0;a--){const l=s[a],u=n[l];u&&u.get?Object.defineProperty(o,l,u):o[l]=u?u.value:void 0}return o}function Cg(t,...e){if(ey&&wn in t){const o=new Set(e.length>1?e.flat():e[0]),s=e.map(a=>new Proxy({get(l){return a.includes(l)?t[l]:void 0},has(l){return a.includes(l)&&l in t},keys(){return a.filter(l=>l in t)}},pc));return s.push(new Proxy({get(a){return o.has(a)?void 0:t[a]},has(a){return o.has(a)?!1:a in t},keys(){return Object.keys(t).filter(a=>!o.has(a))}},pc)),s}const r={},n=e.map(()=>({}));for(const o of Object.getOwnPropertyNames(t)){const s=Object.getOwnPropertyDescriptor(t,o),a=!s.get&&!s.set&&s.enumerable&&s.writable&&s.configurable;let l=!1,u=0;for(const h of e)h.includes(o)&&(l=!0,a?n[u][o]=s.value:Object.defineProperty(n[u],o,s)),++u;l||(a?r[o]=s.value:Object.defineProperty(r,o,s))}return[...n,r]}const xg=t=>`Stale read from <${t}>.`;function ut(t){const e="fallback"in t&&{fallback:()=>t.fallback};return Ze(Pg(()=>t.each,t.children,e||void 0))}function Ae(t){const e=t.keyed,r=Ze(()=>t.when,void 0,void 0),n=e?r:Ze(r,void 0,{equals:(o,s)=>!o==!s});return Ze(()=>{const o=n();if(o){const s=t.children;return typeof s=="function"&&s.length>0?sn(()=>s(e?o:()=>{if(!sn(n))throw xg("Show");return r()})):s}return t.fallback},void 0,void 0)}const $g=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],Ag=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline",...$g]),Ig=new Set(["innerHTML","textContent","innerText","children"]),Eg=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),Tg=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}});function kg(t,e){const r=Tg[t];return typeof r=="object"?r[e]?r.$:void 0:r}const Rg=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),ge=t=>Ze(()=>t());function Dg(t,e,r){let n=r.length,o=e.length,s=n,a=0,l=0,u=e[o-1].nextSibling,h=null;for(;a<o||l<s;){if(e[a]===r[l]){a++,l++;continue}for(;e[o-1]===r[s-1];)o--,s--;if(o===a){const m=s<n?l?r[l-1].nextSibling:r[s-l]:u;for(;l<s;)t.insertBefore(r[l++],m)}else if(s===l)for(;a<o;)(!h||!h.has(e[a]))&&e[a].remove(),a++;else if(e[a]===r[s-1]&&r[l]===e[o-1]){const m=e[--o].nextSibling;t.insertBefore(r[l++],e[a++].nextSibling),t.insertBefore(r[--s],m),e[o]=r[s]}else{if(!h){h=new Map;let v=l;for(;v<s;)h.set(r[v],v++)}const m=h.get(e[a]);if(m!=null)if(l<m&&m<s){let v=a,_=1,x;for(;++v<o&&v<s&&!((x=h.get(e[v]))==null||x!==m+_);)_++;if(_>m-l){const T=e[a];for(;l<m;)t.insertBefore(r[l++],T)}else t.replaceChild(r[l++],e[a++])}else a++;else e[a++].remove()}}}const $u="_$DX_DELEGATE";function Ng(t,e,r,n={}){let o;return es(s=>{o=s,e===document?t():i(e,t(),e.firstChild?null:void 0,r)},n.owner),()=>{o(),e.textContent=""}}function z(t,e,r,n){let o;const s=()=>{const l=n?document.createElementNS("http://www.w3.org/1998/Math/MathML","template"):document.createElement("template");return l.innerHTML=t,r?l.content.firstChild.firstChild:n?l.firstChild:l.content.firstChild},a=e?()=>sn(()=>document.importNode(o||(o=s()),!0)):()=>(o||(o=s())).cloneNode(!0);return a.cloneNode=a,a}function wt(t,e=window.document){const r=e[$u]||(e[$u]=new Set);for(let n=0,o=t.length;n<o;n++){const s=t[n];r.has(s)||(r.add(s),e.addEventListener(s,Ug))}}function ct(t,e,r){r==null?t.removeAttribute(e):t.setAttribute(e,r)}function Lg(t,e,r){r?t.setAttribute(e,""):t.removeAttribute(e)}function ed(t,e){e==null?t.removeAttribute("class"):t.className=e}function Vn(t,e,r,n){if(n)Array.isArray(r)?(t[`$$${e}`]=r[0],t[`$$${e}Data`]=r[1]):t[`$$${e}`]=r;else if(Array.isArray(r)){const o=r[0];t.addEventListener(e,r[0]=s=>o.call(t,r[1],s))}else t.addEventListener(e,r,typeof r!="function"&&r)}function Mg(t,e,r={}){const n=Object.keys(e||{}),o=Object.keys(r);let s,a;for(s=0,a=o.length;s<a;s++){const l=o[s];!l||l==="undefined"||e[l]||(Au(t,l,!1),delete r[l])}for(s=0,a=n.length;s<a;s++){const l=n[s],u=!!e[l];!l||l==="undefined"||r[l]===u||!u||(Au(t,l,!0),r[l]=u)}return r}function d(t,e,r){if(!e)return r?ct(t,"style"):e;const n=t.style;if(typeof e=="string")return n.cssText=e;typeof r=="string"&&(n.cssText=r=void 0),r||(r={}),e||(e={});let o,s;for(s in r)e[s]==null&&n.removeProperty(s),delete r[s];for(s in e)o=e[s],o!==r[s]&&(n.setProperty(s,o),r[s]=o);return r}function Og(t,e={},r,n){const o={};return X(()=>o.children=ds(t,e.children,o.children)),X(()=>typeof e.ref=="function"&&Fg(e.ref,t)),X(()=>Vg(t,e,r,!0,o,!0)),o}function Fg(t,e,r){return sn(()=>t(e,r))}function i(t,e,r,n){if(r!==void 0&&!n&&(n=[]),typeof e!="function")return ds(t,e,n,r);X(o=>ds(t,e(),o,r),n)}function Vg(t,e,r,n,o={},s=!1){e||(e={});for(const a in o)if(!(a in e)){if(a==="children")continue;o[a]=Iu(t,a,null,o[a],r,s,e)}for(const a in e){if(a==="children")continue;const l=e[a];o[a]=Iu(t,a,l,o[a],r,s,e)}}function Bg(t){return t.toLowerCase().replace(/-([a-z])/g,(e,r)=>r.toUpperCase())}function Au(t,e,r){const n=e.trim().split(/\s+/);for(let o=0,s=n.length;o<s;o++)t.classList.toggle(n[o],r)}function Iu(t,e,r,n,o,s,a){let l,u,h,m,v;if(e==="style")return d(t,r,n);if(e==="classList")return Mg(t,r,n);if(r===n)return n;if(e==="ref")s||r(t);else if(e.slice(0,3)==="on:"){const _=e.slice(3);n&&t.removeEventListener(_,n,typeof n!="function"&&n),r&&t.addEventListener(_,r,typeof r!="function"&&r)}else if(e.slice(0,10)==="oncapture:"){const _=e.slice(10);n&&t.removeEventListener(_,n,!0),r&&t.addEventListener(_,r,!0)}else if(e.slice(0,2)==="on"){const _=e.slice(2).toLowerCase(),x=Rg.has(_);if(!x&&n){const T=Array.isArray(n)?n[0]:n;t.removeEventListener(_,T)}(x||r)&&(Vn(t,_,r,x),x&&wt([_]))}else e.slice(0,5)==="attr:"?ct(t,e.slice(5),r):e.slice(0,5)==="bool:"?Lg(t,e.slice(5),r):(v=e.slice(0,5)==="prop:")||(h=Ig.has(e))||(m=kg(e,t.tagName))||(u=Ag.has(e))||(l=t.nodeName.includes("-")||"is"in a)?(v&&(e=e.slice(5),u=!0),e==="class"||e==="className"?ed(t,r):l&&!u&&!h?t[Bg(e)]=r:t[m||e]=r):ct(t,Eg[e]||e,r);return r}function Ug(t){let e=t.target;const r=`$$${t.type}`,n=t.target,o=t.currentTarget,s=u=>Object.defineProperty(t,"target",{configurable:!0,value:u}),a=()=>{const u=e[r];if(u&&!e.disabled){const h=e[`${r}Data`];if(h!==void 0?u.call(e,h,t):u.call(e,t),t.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(t.target)&&s(e.host),!0},l=()=>{for(;a()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return e||document}}),t.composedPath){const u=t.composedPath();s(u[0]);for(let h=0;h<u.length-2&&(e=u[h],!!a());h++){if(e._$host){e=e._$host,l();break}if(e.parentNode===o)break}}else l();s(n)}function ds(t,e,r,n,o){for(;typeof r=="function";)r=r();if(e===r)return r;const s=typeof e,a=n!==void 0;if(t=a&&r[0]&&r[0].parentNode||t,s==="string"||s==="number"){if(s==="number"&&(e=e.toString(),e===r))return r;if(a){let l=r[0];l&&l.nodeType===3?l.data!==e&&(l.data=e):l=document.createTextNode(e),r=ni(t,r,n,l)}else r!==""&&typeof r=="string"?r=t.firstChild.data=e:r=t.textContent=e}else if(e==null||s==="boolean")r=ni(t,r,n);else{if(s==="function")return X(()=>{let l=e();for(;typeof l=="function";)l=l();r=ds(t,l,r,n)}),()=>r;if(Array.isArray(e)){const l=[],u=r&&Array.isArray(r);if(gc(l,e,r,o))return X(()=>r=ds(t,l,r,n,!0)),()=>r;if(l.length===0){if(r=ni(t,r,n),a)return r}else u?r.length===0?Eu(t,l,n):Dg(t,r,l):(r&&ni(t),Eu(t,l));r=l}else if(e.nodeType){if(Array.isArray(r)){if(a)return r=ni(t,r,n,e);ni(t,r,null,e)}else r==null||r===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);r=e}}return r}function gc(t,e,r,n){let o=!1;for(let s=0,a=e.length;s<a;s++){let l=e[s],u=r&&r[t.length],h;if(!(l==null||l===!0||l===!1))if((h=typeof l)=="object"&&l.nodeType)t.push(l);else if(Array.isArray(l))o=gc(t,l,u)||o;else if(h==="function")if(n){for(;typeof l=="function";)l=l();o=gc(t,Array.isArray(l)?l:[l],Array.isArray(u)?u:[u])||o}else t.push(l),o=!0;else{const m=String(l);u&&u.nodeType===3&&u.data===m?t.push(u):t.push(document.createTextNode(m))}}return o}function Eu(t,e,r=null){for(let n=0,o=e.length;n<o;n++)t.insertBefore(e[n],r)}function ni(t,e,r,n){if(r===void 0)return t.textContent="";const o=n||document.createTextNode("");if(e.length){let s=!1;for(let a=e.length-1;a>=0;a--){const l=e[a];if(o!==l){const u=l.parentNode===t;!s&&!a?u?t.replaceChild(o,l):t.insertBefore(o,r):u&&l.remove()}else s=!0}}else t.insertBefore(o,r);return[o]}const zg=!1;function uy(){let t=new Set;function e(o){return t.add(o),()=>t.delete(o)}let r=!1;function n(o,s){if(r)return!(r=!1);const a={to:o,options:s,defaultPrevented:!1,preventDefault:()=>a.defaultPrevented=!0};for(const l of t)l.listener({...a,from:l.location,retry:u=>{u&&(r=!0),l.navigate(o,{...s,resolve:!1})}});return!a.defaultPrevented}return{subscribe:e,confirm:n}}let vc;function td(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),vc=window.history.state._depth}td();function jg(t){return{...t,_depth:window.history.state&&window.history.state._depth}}function qg(t,e){let r=!1;return()=>{const n=vc;td();const o=n==null?null:vc-n;if(r){r=!1;return}o&&e(o)?(r=!0,window.history.go(-o)):t()}}const Gg=/^(?:[a-z0-9]+:)?\/\//i,Hg=/^\/+|(\/)\/+$/g,hy="http://sr";function jo(t,e=!1){const r=t.replace(Hg,"$1");return r?e||/^[?#]/.test(r)?r:"/"+r:""}function ma(t,e,r){if(Gg.test(e))return;const n=jo(t),o=r&&jo(r);let s="";return!o||e.startsWith("/")?s=n:o.toLowerCase().indexOf(n.toLowerCase())!==0?s=n+o:s=o,(s||"/")+jo(e,!s)}function Wg(t,e){if(t==null)throw new Error(e);return t}function Yg(t,e){return jo(t).replace(/\/*(\*.*)?$/g,"")+jo(e)}function my(t){const e={};return t.searchParams.forEach((r,n)=>{n in e?Array.isArray(e[n])?e[n].push(r):e[n]=[e[n],r]:e[n]=r}),e}function Kg(t,e,r){const[n,o]=t.split("/*",2),s=n.split("/").filter(Boolean),a=s.length;return l=>{const u=l.split("/").filter(Boolean),h=u.length-a;if(h<0||h>0&&o===void 0&&!e)return null;const m={path:a?"":"/",params:{}},v=_=>r===void 0?void 0:r[_];for(let _=0;_<a;_++){const x=s[_],T=x[0]===":",E=T?u[_]:u[_].toLowerCase(),P=T?x.slice(1):x.toLowerCase();if(T&&Nl(E,v(P)))m.params[P]=E;else if(T||!Nl(E,P))return null;m.path+=`/${E}`}if(o){const _=h?u.slice(-h).join("/"):"";if(Nl(_,v(o)))m.params[o]=_;else return null}return m}}function Nl(t,e){const r=n=>n===t;return e===void 0?!0:typeof e=="string"?r(e):typeof e=="function"?e(t):Array.isArray(e)?e.some(r):e instanceof RegExp?e.test(t):!1}function Qg(t){const[e,r]=t.pattern.split("/*",2),n=e.split("/").filter(Boolean);return n.reduce((o,s)=>o+(s.startsWith(":")?2:3),n.length-(r===void 0?0:1))}function yy(t){const e=new Map,r=oy();return new Proxy({},{get(n,o){return e.has(o)||iy(r,()=>e.set(o,Ze(()=>t()[o]))),e.get(o)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(t())}})}function py(t){let e=/(\/?\:[^\/]+)\?/.exec(t);if(!e)return[t];let r=t.slice(0,e.index),n=t.slice(e.index+e[0].length);const o=[r,r+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(n);)o.push(r+=e[1]),n=n.slice(e[0].length);return py(n).reduce((s,a)=>[...s,...o.map(l=>l+a)],[])}const Jg=100,fy=sy(),rd=sy(),xs=()=>Wg(Qc(fy),"<A> and 'use' router primitives can be only used inside a Route."),Xg=()=>Qc(rd)||xs().base,Zg=t=>{const e=Xg();return Ze(()=>e.resolvePath(t()))},ev=t=>{const e=xs();return Ze(()=>{const r=t();return r!==void 0?e.renderPath(r):r})},nd=()=>xs().navigatorFactory(),tv=()=>xs().location,rv=()=>xs().params;function nv(t,e=""){const{component:r,preload:n,load:o,children:s,info:a}=t,l=!s||Array.isArray(s)&&!s.length,u={key:t,component:r,preload:n||o,info:a};return gy(t.path).reduce((h,m)=>{for(const v of py(m)){const _=Yg(e,v);let x=l?_:_.split("/*",1)[0];x=x.split("/").map(T=>T.startsWith(":")||T.startsWith("*")?T:encodeURIComponent(T)).join("/"),h.push({...u,originalPath:m,pattern:x,matcher:Kg(x,!l,t.matchFilters)})}return h},[])}function ov(t,e=0){return{routes:t,score:Qg(t[t.length-1])*1e4-e,matcher(r){const n=[];for(let o=t.length-1;o>=0;o--){const s=t[o],a=s.matcher(r);if(!a)return null;n.unshift({...a,route:s})}return n}}}function gy(t){return Array.isArray(t)?t:[t]}function vy(t,e="",r=[],n=[]){const o=gy(t);for(let s=0,a=o.length;s<a;s++){const l=o[s];if(l&&typeof l=="object"){l.hasOwnProperty("path")||(l.path="");const u=nv(l,e);for(const h of u){r.push(h);const m=Array.isArray(l.children)&&l.children.length===0;if(l.children&&!m)vy(l.children,h.pattern,r,n);else{const v=ov([...r],n.length);n.push(v)}r.pop()}}}return r.length?n:n.sort((s,a)=>a.score-s.score)}function Ll(t,e){for(let r=0,n=t.length;r<n;r++){const o=t[r].matcher(e);if(o)return o}return[]}function iv(t,e,r){const n=new URL(hy),o=Ze(m=>{const v=t();try{return new URL(v,n)}catch{return console.error(`Invalid path ${v}`),m}},n,{equals:(m,v)=>m.href===v.href}),s=Ze(()=>o().pathname),a=Ze(()=>o().search,!0),l=Ze(()=>o().hash),u=()=>"",h=Kc(a,()=>my(o()));return{get pathname(){return s()},get search(){return a()},get hash(){return l()},get state(){return e()},get key(){return u()},query:r?r(h):yy(h)}}let Fo;function sv(){return Fo}function av(t,e,r,n={}){const{signal:[o,s],utils:a={}}=t,l=a.parsePath||(de=>de),u=a.renderPath||(de=>de),h=a.beforeLeave||uy(),m=ma("",n.base||"");if(m===void 0)throw new Error(`${m} is not a valid base path`);m&&!o().value&&s({value:m,replace:!0,scroll:!1});const[v,_]=ye(!1);let x;const T=(de,J)=>{J.value===E()&&J.state===R()||(x===void 0&&_(!0),Fo=de,x=J,pg(()=>{x===J&&(P(x.value),Y(x.state),B[1](O=>O.filter(N=>N.pending)))}).finally(()=>{x===J&&ny(()=>{Fo=void 0,de==="navigate"&&I(x),_(!1),x=void 0})}))},[E,P]=ye(o().value),[R,Y]=ye(o().state),Z=iv(E,R,a.queryWrapper),j=[],B=ye([]),V=Ze(()=>typeof n.transformUrl=="function"?Ll(e(),n.transformUrl(Z.pathname)):Ll(e(),Z.pathname)),f=()=>{const de=V(),J={};for(let O=0;O<de.length;O++)Object.assign(J,de[O].params);return J},g=a.paramsWrapper?a.paramsWrapper(f,e):yy(f),S={pattern:m,path:()=>m,outlet:()=>null,resolvePath(de){return ma(m,de)}};return X(Kc(o,de=>T("native",de),{defer:!0})),{base:S,location:Z,params:g,isRouting:v,renderPath:u,parsePath:l,navigatorFactory:w,matches:V,beforeLeave:h,preloadRoute:y,singleFlight:n.singleFlight===void 0?!0:n.singleFlight,submissions:B};function $(de,J,O){sn(()=>{if(typeof J=="number"){J&&(a.go?a.go(J):console.warn("Router integration does not support relative routing"));return}const N=!J||J[0]==="?",{replace:q,resolve:D,scroll:C,state:F}={replace:!1,resolve:!N,scroll:!0,...O},ee=D?de.resolvePath(J):ma(N&&Z.pathname||"",J);if(ee===void 0)throw new Error(`Path '${J}' is not a routable path`);if(j.length>=Jg)throw new Error("Too many redirects");const H=E();(ee!==H||F!==R())&&(zg||h.confirm(ee,O)&&(j.push({value:H,replace:q,scroll:C,state:R()}),T("navigate",{value:ee,state:F})))})}function w(de){return de=de||Qc(rd)||S,(J,O)=>$(de,J,O)}function I(de){const J=j[0];J&&(s({...de,replace:J.replace,scroll:J.scroll}),j.length=0)}function y(de,J){const O=Ll(e(),de.pathname),N=Fo;Fo="preload";for(let q in O){const{route:D,params:C}=O[q];D.component&&D.component.preload&&D.component.preload();const{preload:F}=D;J&&F&&iy(r(),()=>F({params:C,location:{pathname:de.pathname,search:de.search,hash:de.hash,query:my(de),state:null,key:""},intent:"preload"}))}Fo=N}}function lv(t,e,r,n){const{base:o,location:s,params:a}=t,{pattern:l,component:u,preload:h}=n().route,m=Ze(()=>n().path);u&&u.preload&&u.preload();const v=h?h({params:a,location:s,intent:Fo||"initial"}):void 0;return{parent:e,pattern:l,path:m,outlet:()=>u?b(u,{params:a,location:s,data:v,get children(){return r()}}):r(),resolvePath(x){return ma(o.path(),x,m())}}}const cv=t=>e=>{const{base:r}=e,n=Jc(()=>e.children),o=Ze(()=>vy(n(),e.base||""));let s;const a=av(t,o,()=>s,{base:r,singleFlight:e.singleFlight,transformUrl:e.transformUrl});return t.create&&t.create(a),b(fy.Provider,{value:a,get children(){return b(dv,{routerState:a,get root(){return e.root},get preload(){return e.rootPreload||e.rootLoad},get children(){return[ge(()=>(s=oy())&&null),b(uv,{routerState:a,get branches(){return o()}})]}})}})};function dv(t){const e=t.routerState.location,r=t.routerState.params,n=Ze(()=>t.preload&&sn(()=>{t.preload({params:r,location:e,intent:sv()||"initial"})}));return b(Ae,{get when(){return t.root},keyed:!0,get fallback(){return t.children},children:o=>b(o,{params:r,location:e,get data(){return n()},get children(){return t.children}})})}function uv(t){const e=[];let r;const n=Ze(Kc(t.routerState.matches,(o,s,a)=>{let l=s&&o.length===s.length;const u=[];for(let h=0,m=o.length;h<m;h++){const v=s&&s[h],_=o[h];a&&v&&_.route.key===v.route.key?u[h]=a[h]:(l=!1,e[h]&&e[h](),es(x=>{e[h]=x,u[h]=lv(t.routerState,u[h-1]||t.routerState.base,Tu(()=>n()[h+1]),()=>t.routerState.matches()[h])}))}return e.splice(o.length).forEach(h=>h()),a&&l?a:(r=u[0],u)}));return Tu(()=>n()&&r)()}const Tu=t=>()=>b(Ae,{get when(){return t()},keyed:!0,children:e=>b(rd.Provider,{value:e,get children(){return e.outlet()}})}),bn=t=>{const e=Jc(()=>t.children);return fc(t,{get children(){return e()}})};function hv([t,e],r,n){return[t,n?o=>e(n(o)):e]}function mv(t){let e=!1;const r=o=>typeof o=="string"?{value:o}:o,n=hv(ye(r(t.get()),{equals:(o,s)=>o.value===s.value&&o.state===s.state}),void 0,o=>(!e&&t.set(o),o));return t.init&&Ai(t.init((o=t.get())=>{e=!0,n[1](r(o)),e=!1})),cv({signal:n,create:t.create,utils:t.utils})}function yv(t,e,r){return t.addEventListener(e,r),()=>t.removeEventListener(e,r)}function pv(t,e){const r=t&&document.getElementById(t);r?r.scrollIntoView():e&&window.scrollTo(0,0)}const fv=new Map;function gv(t=!0,e=!1,r="/_server",n){return o=>{const s=o.base.path(),a=o.navigatorFactory(o.base);let l,u;function h(E){return E.namespaceURI==="http://www.w3.org/2000/svg"}function m(E){if(E.defaultPrevented||E.button!==0||E.metaKey||E.altKey||E.ctrlKey||E.shiftKey)return;const P=E.composedPath().find(V=>V instanceof Node&&V.nodeName.toUpperCase()==="A");if(!P||e&&!P.hasAttribute("link"))return;const R=h(P),Y=R?P.href.baseVal:P.href;if((R?P.target.baseVal:P.target)||!Y&&!P.hasAttribute("state"))return;const j=(P.getAttribute("rel")||"").split(/\s+/);if(P.hasAttribute("download")||j&&j.includes("external"))return;const B=R?new URL(Y,document.baseURI):new URL(Y);if(!(B.origin!==window.location.origin||s&&B.pathname&&!B.pathname.toLowerCase().startsWith(s.toLowerCase())))return[P,B]}function v(E){const P=m(E);if(!P)return;const[R,Y]=P,Z=o.parsePath(Y.pathname+Y.search+Y.hash),j=R.getAttribute("state");E.preventDefault(),a(Z,{resolve:!1,replace:R.hasAttribute("replace"),scroll:!R.hasAttribute("noscroll"),state:j?JSON.parse(j):void 0})}function _(E){const P=m(E);if(!P)return;const[R,Y]=P;o.preloadRoute(Y,R.getAttribute("preload")!=="false")}function x(E){clearTimeout(l);const P=m(E);if(!P)return u=null;const[R,Y]=P;u!==R&&(l=setTimeout(()=>{o.preloadRoute(Y,R.getAttribute("preload")!=="false"),u=R},20))}function T(E){if(E.defaultPrevented)return;let P=E.submitter&&E.submitter.hasAttribute("formaction")?E.submitter.getAttribute("formaction"):E.target.getAttribute("action");if(!P)return;if(!P.startsWith("https://action/")){const Y=new URL(P,hy);if(P=o.parsePath(Y.pathname+Y.search),!P.startsWith(r))return}if(E.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const R=fv.get(P);if(R){E.preventDefault();const Y=new FormData(E.target,E.submitter);R.call({r:o,f:E.target},E.target.enctype==="multipart/form-data"?Y:new URLSearchParams(Y))}}wt(["click","submit"]),document.addEventListener("click",v),t&&(document.addEventListener("mousemove",x,{passive:!0}),document.addEventListener("focusin",_,{passive:!0}),document.addEventListener("touchstart",_,{passive:!0})),document.addEventListener("submit",T),Ai(()=>{document.removeEventListener("click",v),t&&(document.removeEventListener("mousemove",x),document.removeEventListener("focusin",_),document.removeEventListener("touchstart",_)),document.removeEventListener("submit",T)})}}function vv(t){const e=t.replace(/^.*?#/,"");if(!e.startsWith("/")){const[,r="/"]=window.location.hash.split("#",2);return`${r}#${e}`}return e}function bv(t){const e=()=>window.location.hash.slice(1),r=uy();return mv({get:e,set({value:n,replace:o,scroll:s,state:a}){o?window.history.replaceState(jg(a),"","#"+n):window.history.pushState(a,"","#"+n);const l=n.indexOf("#"),u=l>=0?n.slice(l+1):"";pv(u,s),td()},init:n=>yv(window,"hashchange",qg(n,o=>!r.confirm(o&&o<0?o:e()))),create:gv(t.preload,t.explicitLinks,t.actionBase),utils:{go:n=>window.history.go(n),renderPath:n=>`#${n}`,parsePath:vv,beforeLeave:r}})(t)}var _v=z("<a>");function li(t){t=fc({inactiveClass:"inactive",activeClass:"active"},t);const[,e]=Cg(t,["href","state","class","activeClass","inactiveClass","end"]),r=Zg(()=>t.href),n=ev(r),o=tv(),s=Ze(()=>{const a=r();if(a===void 0)return[!1,!1];const l=jo(a.split(/[?#]/,1)[0]).toLowerCase(),u=decodeURI(jo(o.pathname).toLowerCase());return[t.end?l===u:u.startsWith(l+"/")||u===l,l===u]});return(()=>{var a=_v();return Og(a,fc(e,{get href(){return n()||t.href},get state(){return JSON.stringify(t.state)},get classList(){return{...t.class&&{[t.class]:!0},[t.inactiveClass]:!s()[0],[t.activeClass]:s()[0],...e.classList}},link:"",get"aria-current"(){return s()[1]?"page":void 0}}),!1),a})()}const bc=Symbol("store-raw"),mi=Symbol("store-node"),jn=Symbol("store-has"),by=Symbol("store-self");function _y(t){let e=t[wn];if(!e&&(Object.defineProperty(t,wn,{value:e=new Proxy(t,wv)}),!Array.isArray(t))){const r=Object.keys(t),n=Object.getOwnPropertyDescriptors(t);for(let o=0,s=r.length;o<s;o++){const a=r[o];n[a].get&&Object.defineProperty(t,a,{enumerable:n[a].enumerable,get:n[a].get.bind(e)})}}return e}function Ea(t){let e;return t!=null&&typeof t=="object"&&(t[wn]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function us(t,e=new Set){let r,n,o,s;if(r=t!=null&&t[bc])return r;if(!Ea(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let a=0,l=t.length;a<l;a++)o=t[a],(n=us(o,e))!==o&&(t[a]=n)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const a=Object.keys(t),l=Object.getOwnPropertyDescriptors(t);for(let u=0,h=a.length;u<h;u++)s=a[u],!l[s].get&&(o=t[s],(n=us(o,e))!==o&&(t[s]=n))}return t}function Ta(t,e){let r=t[e];return r||Object.defineProperty(t,e,{value:r=Object.create(null)}),r}function hs(t,e,r){if(t[e])return t[e];const[n,o]=ye(r,{equals:!1,internal:!0});return n.$=o,t[e]=n}function Sv(t,e){const r=Reflect.getOwnPropertyDescriptor(t,e);return!r||r.get||!r.configurable||e===wn||e===mi||(delete r.value,delete r.writable,r.get=()=>t[wn][e]),r}function Sy(t){mc()&&hs(Ta(t,mi),by)()}function Pv(t){return Sy(t),Reflect.ownKeys(t)}const wv={get(t,e,r){if(e===bc)return t;if(e===wn)return r;if(e===hc)return Sy(t),r;const n=Ta(t,mi),o=n[e];let s=o?o():t[e];if(e===mi||e===jn||e==="__proto__")return s;if(!o){const a=Object.getOwnPropertyDescriptor(t,e);mc()&&(typeof s!="function"||t.hasOwnProperty(e))&&!(a&&a.get)&&(s=hs(n,e,s)())}return Ea(s)?_y(s):s},has(t,e){return e===bc||e===wn||e===hc||e===mi||e===jn||e==="__proto__"?!0:(mc()&&hs(Ta(t,jn),e)(),e in t)},set(){return!0},deleteProperty(){return!0},ownKeys:Pv,getOwnPropertyDescriptor:Sv};function ka(t,e,r,n=!1){if(!n&&t[e]===r)return;const o=t[e],s=t.length;r===void 0?(delete t[e],t[jn]&&t[jn][e]&&o!==void 0&&t[jn][e].$()):(t[e]=r,t[jn]&&t[jn][e]&&o===void 0&&t[jn][e].$());let a=Ta(t,mi),l;if((l=hs(a,e,o))&&l.$(()=>r),Array.isArray(t)&&t.length!==s){for(let u=t.length;u<s;u++)(l=a[u])&&l.$();(l=hs(a,"length",s))&&l.$(t.length)}(l=a[by])&&l.$()}function Py(t,e){const r=Object.keys(e);for(let n=0;n<r.length;n+=1){const o=r[n];ka(t,o,e[o])}}function Cv(t,e){if(typeof e=="function"&&(e=e(t)),e=us(e),Array.isArray(e)){if(t===e)return;let r=0,n=e.length;for(;r<n;r++){const o=e[r];t[r]!==o&&ka(t,r,o)}ka(t,"length",n)}else Py(t,e)}function Yi(t,e,r=[]){let n,o=t;if(e.length>1){n=e.shift();const a=typeof n,l=Array.isArray(t);if(Array.isArray(n)){for(let u=0;u<n.length;u++)Yi(t,[n[u]].concat(e),r);return}else if(l&&a==="function"){for(let u=0;u<t.length;u++)n(t[u],u)&&Yi(t,[u].concat(e),r);return}else if(l&&a==="object"){const{from:u=0,to:h=t.length-1,by:m=1}=n;for(let v=u;v<=h;v+=m)Yi(t,[v].concat(e),r);return}else if(e.length>1){Yi(t[n],e,[n].concat(r));return}o=t[n],r=[n].concat(r)}let s=e[0];typeof s=="function"&&(s=s(o,r),s===o)||n===void 0&&s==null||(s=us(s),n===void 0||Ea(o)&&Ea(s)&&!Array.isArray(s)?Py(o,s):ka(t,n,s))}function el(...[t,e]){const r=us(t||{}),n=Array.isArray(r),o=_y(r);function s(...a){ny(()=>{n&&a.length===1?Cv(r,a[0]):Yi(r,a)})}return[o,s]}const Jt=(t=300+Math.random()*700)=>new Promise(e=>setTimeout(e,t)),Ro=(t="")=>`${t}${Date.now()}-${Math.random().toString(36).substr(2,9)}`;let tt={products:[{id:"prod-001",name:"Wireless Headphones",sku:"WH-001",productCode:"WH-001",productName:"Wireless Headphones",description:"High-quality wireless bluetooth headphones",category:"Electronics",unitOfMeasure:"pcs",unitCost:45,sellingPrice:89.99,minStockLevel:10,maxStockLevel:100,isActive:!0,createdDate:"2024-01-15T10:00:00Z",lastModified:"2024-01-15T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-002",name:"USB-C Cable",sku:"USB-001",description:"3ft USB-C charging cable",category:"Accessories",unitOfMeasure:"pcs",unitCost:8.5,sellingPrice:19.99,minStockLevel:25,maxStockLevel:200,isActive:!0,createdDate:"2024-01-16T10:00:00Z",lastModified:"2024-01-16T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-003",name:"Laptop Stand",sku:"LS-001",description:"Adjustable aluminum laptop stand",category:"Office",unitOfMeasure:"pcs",unitCost:25,sellingPrice:49.99,minStockLevel:5,maxStockLevel:50,isActive:!0,createdDate:"2024-01-17T10:00:00Z",lastModified:"2024-01-17T10:00:00Z",businessId:"YB100423253156428"}],locations:[{id:"loc-001",name:"Main Warehouse",code:"WH-001",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-002",name:"Retail Store - Downtown",code:"ST-001",type:"store",address:"456 Main St, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-003",name:"Retail Store - Mall",code:"ST-002",type:"store",address:"789 Mall Blvd, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"}],movements:[{id:"mov-001",productId:"prod-001",productName:"Wireless Headphones",productSku:"WH-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:50,unitCost:45,totalCost:2250,referenceNumber:"PO-001",notes:"Initial stock purchase",createdBy:"admin",createdDate:"2024-01-15T10:00:00Z",invoiceId:"INV-1000001"},{id:"mov-002",productId:"prod-002",productName:"USB-C Cable",productSku:"USB-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:100,unitCost:8.5,totalCost:850,referenceNumber:"PO-001",notes:"Bulk purchase",createdBy:"admin",createdDate:"2024-01-15T10:05:00Z",invoiceId:"INV-1000001"}],accounts:[{id:"acc-001",accountNumber:"1000",accountName:"Cash",accountType:"asset",category:"currentAssets",balance:5e4,parentAccountId:null,description:"Cash and cash equivalents",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"},{id:"acc-002",accountNumber:"1100",accountName:"Accounts Receivable",accountType:"asset",category:"currentAssets",balance:25e3,parentAccountId:null,description:"Money owed by customers",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"}],journalEntries:[{id:"je-001",entryNumber:"JE-001",date:"2024-01-15",description:"Initial cash deposit",reference:"DEP-001",status:"posted",createdBy:"admin",createdAt:"2024-01-15T10:00:00Z",postedAt:"2024-01-15T10:05:00Z",lines:[{id:"jel-001",accountId:"acc-001",accountName:"Cash",description:"Initial deposit",debitAmount:5e4,creditAmount:0},{id:"jel-002",accountId:"acc-003",accountName:"Owner Equity",description:"Initial capital",debitAmount:0,creditAmount:5e4}]}]};const gr=(t=.05)=>Math.random()<t,vr=()=>{const t=["Network timeout","Connection refused","Server temporarily unavailable","Invalid request"];throw new Error(t[Math.floor(Math.random()*t.length)])},Rr={products:{async getAll(t,e){await Jt(),gr()&&vr();let r=[...tt.products];if(t&&t.trim()){const n=t.toLowerCase();r=r.filter(o=>o.name.toLowerCase().includes(n)||o.sku.toLowerCase().includes(n)||o.category.toLowerCase().includes(n)||o.description.toLowerCase().includes(n))}return e?.category&&(r=r.filter(n=>n.category===e.category)),e?.isActive!==void 0&&(r=r.filter(n=>n.isActive===e.isActive)),r},async getById(t){return await Jt(),gr()&&vr(),tt.products.find(e=>e.id===t)||null},async create(t){if(await Jt(),gr()&&vr(),tt.products.some(r=>r.sku===t.sku))throw new Error("SKU already exists");const e={...t,id:Ro("prod-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return tt.products.push(e),e},async update(t,e){await Jt(),gr()&&vr();const r=tt.products.findIndex(o=>o.id===t);if(r===-1)throw new Error("Product not found");if(e.sku&&tt.products.some(o=>o.id!==t&&o.sku===e.sku))throw new Error("SKU already exists");const n={...tt.products[r],...e,lastModified:new Date().toISOString()};return tt.products[r]=n,n},async delete(t){await Jt(),gr()&&vr();const e=tt.products.findIndex(n=>n.id===t);if(e===-1)throw new Error("Product not found");return tt.movements.some(n=>n.productId===t)?{success:!1,message:"Cannot delete product with existing movements"}:(tt.products.splice(e,1),{success:!0,message:"Product deleted successfully"})}},locations:{async getAll(t){await Jt(),gr()&&vr();let e=[...tt.locations];return t?.type&&(e=e.filter(r=>r.type===t.type)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await Jt(),tt.locations.find(e=>e.id===t)||null},async create(t){if(await Jt(),gr()&&vr(),tt.locations.some(r=>r.code===t.code))throw new Error("Location code already exists");const e={...t,id:Ro("loc-"),createdDate:new Date().toISOString()};return tt.locations.push(e),e},async update(t,e){await Jt(),gr()&&vr();const r=tt.locations.findIndex(n=>n.id===t);if(r===-1)throw new Error("Location not found");if(e.code&&tt.locations.some(n=>n.id!==t&&n.code===e.code))throw new Error("Location code already exists");return tt.locations[r]={...tt.locations[r],...e},tt.locations[r]}},movements:{async getAll(t){await Jt(),gr()&&vr();let e=[...tt.movements];if(t?.productId&&(e=e.filter(r=>r.productId===t.productId)),t?.locationId&&(e=e.filter(r=>r.locationId===t.locationId)),t?.movementType&&(e=e.filter(r=>r.movementType===t.movementType)),t?.dateFrom&&(e=e.filter(r=>r.createdDate>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.createdDate<=t.dateTo)),t?.search){const r=t.search.toLowerCase();e=e.filter(n=>n.productName.toLowerCase().includes(r)||n.productSku.toLowerCase().includes(r)||n.referenceNumber.toLowerCase().includes(r)||n.notes.toLowerCase().includes(r))}return e.sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime()),e},async getById(t){return await Jt(),tt.movements.find(e=>e.id===t)||null},async create(t){if(await Jt(),gr()&&vr(),!tt.products.find(o=>o.id===t.productId))throw new Error("Product not found");if(!tt.locations.find(o=>o.id===t.locationId))throw new Error("Location not found");if(t.movementType==="out"){const o=await this.getStockLevel(t.productId,t.locationId);if(o<t.quantity)throw new Error(`Insufficient stock. Available: ${o}, Requested: ${t.quantity}`)}const n={...t,id:Ro("mov-"),createdDate:new Date().toISOString()};return tt.movements.push(n),n},async update(t,e){await Jt(),gr()&&vr();const r=tt.movements.findIndex(o=>o.id===t);if(r===-1)throw new Error("Movement not found");const n={...tt.movements[r],...e,lastModified:new Date().toISOString()};return tt.movements[r]=n,n},async delete(t){await Jt(),gr()&&vr();const e=tt.movements.findIndex(r=>r.id===t);if(e===-1)throw new Error("Movement not found");return tt.movements.splice(e,1),{success:!0,message:"Movement deleted successfully"}},async createBulk(t){await Jt(),gr()&&vr();const e=[],r=[],n=new Date().toISOString(),o=tt.locations.find(s=>s.id===t.locationId);if(!o)return{success:!1,movements:[],errors:["Invalid location"]};for(let s=0;s<t.items.length;s++){const a=t.items[s],l=tt.products.find(m=>m.id===a.productId);if(!l){e.push(`Item ${s+1}: Product not found`);continue}if(a.quantity<=0){e.push(`Item ${s+1}: Quantity must be greater than 0`);continue}if(t.movementType==="out"){const m=await this.getStockLevel(a.productId,t.locationId);if(a.quantity>m){e.push(`Item ${s+1}: Insufficient stock. Available: ${m}, Requested: ${a.quantity}`);continue}}const u=a.unitCost||l.unitCost,h={id:Ro("mov-"),productId:l.id,productName:l.name,productSku:l.sku,locationId:t.locationId,locationName:o.name,movementType:t.movementType,quantity:a.quantity,unitCost:u,totalCost:a.quantity*u,referenceNumber:t.referenceNumber,notes:a.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:t.fromLocationId?tt.locations.find(m=>m.id===t.fromLocationId)?.name:void 0};r.push(h)}return e.length>0?{success:!1,movements:[],errors:e}:(tt.movements.push(...r),{success:!0,movements:r,errors:[]})},async getStockLevel(t,e){return await Jt(50),tt.movements.filter(r=>r.productId===t&&r.locationId===e).reduce((r,n)=>{switch(n.movementType){case"in":case"adjustment":return r+n.quantity;case"out":return r-n.quantity;case"transfer":return n.locationId===e?r+n.quantity:r;default:return r}},0)},async getStockLevels(){await Jt();const t=new Map;for(const e of tt.movements){const r=`${e.productId}-${e.locationId}`;let n=t.get(r);switch(n||(n={id:r,productId:e.productId,locationId:e.locationId,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType){case"in":case"adjustment":n.quantity+=e.quantity;break;case"out":n.quantity-=e.quantity;break;case"transfer":e.locationId===e.locationId&&(n.quantity+=e.quantity);break}new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost,n.availableQuantity=n.quantity-n.reservedQuantity}return Array.from(t.values())}},accounts:{async getAll(t){await Jt(),gr()&&vr();let e=[...tt.accounts];return t?.accountType&&(e=e.filter(r=>r.accountType===t.accountType)),t?.category&&(e=e.filter(r=>r.category===t.category)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await Jt(),tt.accounts.find(e=>e.id===t)||null},async create(t){if(await Jt(),gr()&&vr(),tt.accounts.some(r=>r.accountNumber===t.accountNumber))throw new Error("Account number already exists");const e={...t,id:Ro("acc-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return tt.accounts.push(e),e},async update(t,e){await Jt(),gr()&&vr();const r=tt.accounts.findIndex(n=>n.id===t);if(r===-1)throw new Error("Account not found");if(e.accountNumber&&tt.accounts.some(n=>n.id!==t&&n.accountNumber===e.accountNumber))throw new Error("Account number already exists");return tt.accounts[r]={...tt.accounts[r],...e,lastModified:new Date().toISOString()},tt.accounts[r]}},journal:{async getAll(t){await Jt(),gr()&&vr();let e=[...tt.journalEntries];return t?.status&&(e=e.filter(r=>r.status===t.status)),t?.accountId&&(e=e.filter(r=>r.lines.some(n=>n.accountId===t.accountId))),t?.dateFrom&&(e=e.filter(r=>r.date>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.date<=t.dateTo)),e.sort((r,n)=>new Date(n.createdAt).getTime()-new Date(r.createdAt).getTime())},async getById(t){return await Jt(),tt.journalEntries.find(e=>e.id===t)||null},async create(t){await Jt(),gr()&&vr();const e=t.lines.reduce((l,u)=>l+(u.debitAmount||0),0),r=t.lines.reduce((l,u)=>l+(u.creditAmount||0),0);if(Math.abs(e-r)>.01)throw new Error(`Entry is not balanced. Debit: ${e}, Credit: ${r}`);const n=tt.journalEntries.sort((l,u)=>u.entryNumber.localeCompare(l.entryNumber))[0],s=`JE-${((n?parseInt(n.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`,a={...t,id:Ro("je-"),entryNumber:s,createdAt:new Date().toISOString(),lines:t.lines.map(l=>({...l,id:Ro("jel-")}))};return tt.journalEntries.push(a),a},async update(t,e){await Jt(),gr()&&vr();const r=tt.journalEntries.findIndex(n=>n.id===t);if(r===-1)throw new Error("Journal entry not found");if(tt.journalEntries[r].status==="posted")throw new Error("Cannot modify posted entries");return tt.journalEntries[r]={...tt.journalEntries[r],...e},tt.journalEntries[r]},async post(t){await Jt(),gr()&&vr();const e=tt.journalEntries.findIndex(s=>s.id===t);if(e===-1)throw new Error("Journal entry not found");const r=tt.journalEntries[e];if(r.status==="posted")throw new Error("Entry is already posted");const n=r.lines.reduce((s,a)=>s+(a.debitAmount||0),0),o=r.lines.reduce((s,a)=>s+(a.creditAmount||0),0);if(Math.abs(n-o)>.01)throw new Error("Entry must be balanced before posting");return tt.journalEntries[e]={...r,status:"posted",postedAt:new Date().toISOString()},r.lines.forEach(s=>{const a=tt.accounts.findIndex(l=>l.id===s.accountId);if(a!==-1){const l=tt.accounts[a],u=s.debitAmount||0,h=s.creditAmount||0;["asset","expense"].includes(l.accountType)?l.balance+=u-h:l.balance+=h-u}}),tt.journalEntries[e]}},utils:{async getNextEntryNumber(){await Jt(100);const t=tt.journalEntries.sort((r,n)=>n.entryNumber.localeCompare(r.entryNumber))[0];return`JE-${((t?parseInt(t.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`},async getNextProductCode(t){await Jt(100);const e=t.toUpperCase().slice(0,3),r=tt.products.filter(o=>o.productCode?.startsWith(e)).sort((o,s)=>(s.productCode||"").localeCompare(o.productCode||""));if(r.length===0)return`${e}001`;const n=parseInt(r[0].productCode?.slice(-3)||"0");return`${e}${(n+1).toString().padStart(3,"0")}`},async healthCheck(){return await Jt(50),{status:"healthy",timestamp:new Date().toISOString(),version:"1.0.0"}},async resetDatabase(){return await Jt(200),tt={products:[...tt.products.slice(0,3)],locations:[...tt.locations.slice(0,3)],movements:[...tt.movements.slice(0,2)],accounts:[...tt.accounts.slice(0,2)],journalEntries:[...tt.journalEntries.slice(0,1)]},{success:!0,message:"Database reset to initial state"}},async getStats(){return await Jt(100),{products:tt.products.length,locations:tt.locations.length,movements:tt.movements.length,accounts:tt.accounts.length,journalEntries:tt.journalEntries.length,totalStockValue:tt.movements.reduce((t,e)=>e.movementType==="in"?t+e.totalCost:e.movementType==="out"?t-e.totalCost:t,0)}}}},od=t=>t===null||typeof t!="object"?t:t instanceof Date?new Date(t.getTime()):Array.isArray(t)?t.map(e=>od(e)):JSON.parse(JSON.stringify(t)),wy=(t=16)=>{const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},ku=(t=16)=>{const e="123456789";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},xv=(t=4)=>{const e="0123456789BCDFGKSY";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},ts=t=>typeof t=="string"&&t.trim().length>0,mn=async t=>{const n=await fetch("https://qvamarkets.com/gql_api",{method:"POST",headers:{"Content-Type":"application/json","Accept-Encoding":"gzip, deflate, br",Authorization:"eyJhbGciOiJSUzI1NiIsImtpZCI6IjhlOGZjOGU1NTZmN2E3NmQwOGQzNTgyOWQ2ZjkwYWUyZTEyY2ZkMGQiLCJ0eXAiOiJKV1QifQ"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const o=await n.json();if(o.errors)throw new Error(o.errors[0]?.message||"GraphQL error");return o.data},$v=t=>({ENTRY:"in",in:"in",TRANSFER:"transfer",transfer:"transfer",SALES:"out",out:"out",adjustment:"adjustment"})[t],_c=t=>({ENTRY:"ENTRY",in:"ENTRY",TRANSFER:"TRANSFER",transfer:"TRANSFER",SALES:"SALES",out:"SALES",adjustment:"adjustment"})[t];function Sc(t){var e=[];return t&&Object.keys(t).map(r=>{e.push(t[r])}),e}function Av(t){if(!/^[a-z0-9+/]+={0,2}$/i.test(t)||t.length%4!=0)throw Error("Not base64 string");for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r,n,o,s,a,l,u,h,m=[],v=0;v<t.length;v+=4)s=e.indexOf(t.charAt(v)),a=e.indexOf(t.charAt(v+1)),l=e.indexOf(t.charAt(v+2)),u=e.indexOf(t.charAt(v+3)),h=s<<18|a<<12|l<<6|u,r=h>>>16&255,n=h>>>8&255,o=h&255,m[v/4]=String.fromCharCode(r,n,o),u==64&&(m[v/4]=String.fromCharCode(r,n)),l==64&&(m[v/4]=String.fromCharCode(r));return t=m.join(""),t}const Iv=async()=>({}),Ev=()=>(typeof window<"u"&&localStorage.getItem("hrmfinance-api-mode"),"real");let Vo=Ev();const ms={getMode(){return Vo},setMode(t){Vo=t,typeof window<"u"&&localStorage.setItem("hrmfinance-api-mode",t)},isFakeMode(){return Vo==="fake"},isRealMode(){return Vo==="real"},isHybridMode(){return Vo==="hybrid"}},jr=async(t,e,r=!0)=>{if(Vo==="fake")return e();if(Vo==="real")return t();try{return await t()}catch(n){if(console.warn("Real API failed, falling back to fake server:",n),r)return e();throw n}},Ru={async getAll(t,e){const r=await mn({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:{businessId:"YB100423253156428",":search0":"produ"}});return Sc(r)},async getById(t){return jr(async()=>(await this.getAll()).find(r=>r.id===t)||null,()=>Rr.products.getById(t))},async create(t){return jr(async()=>{throw console.log("Creating product via real API:",t),new Error("Real API not implemented yet")},()=>Rr.products.create(t))},async update(t,e){return jr(async()=>{throw console.log("Updating product via real API:",t,e),new Error("Real API not implemented yet")},()=>Rr.products.update(t,e))},async delete(t){return jr(async()=>{throw console.log("Deleting product via real API:",t),new Error("Real API not implemented yet")},()=>Rr.products.delete(t))}},Jr={async getInventory(t,e){if(!(t&&t?.trim()))return[];let r={businessId:"YB100423253156428"};return t&&t.split(" ").map((s,a)=>{s&&(r[":search"+a]=s.trim())}),await mn({query:"getScanYabaInventory",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async getProducts(t){if(!(t&&t?.trim()))return[];let e={businessId:"YB100423253156428"};return t&&t.split(" ").map((o,s)=>{o&&(e[":search"+s]=o.trim())}),await mn({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async getConsigee(t){if(!(t&&t?.trim()))return[];let e={businessId:"all"};t&&t.split(" ").map((o,s)=>{o&&(e[":search"+s]=o.trim())});let r={query:"getScanConsigneeYabaExpress",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e};console.log(r);const n=await mn(r);return console.log(n),n},async getShipper(t){if(!(t&&t?.trim()))return[];let e={businessId:"all"};t&&t.split(" ").map((o,s)=>{o&&(e[":search"+s]=o.trim())});let r={query:"getScanShipperYabaExpress",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e};return console.log(r),await mn(r)},async getInvoice(t,e){if(!(t&&t?.trim()))return[];let r={businessId:"YB100423253156428"};t&&t.split(" ").map((s,a)=>{s&&(r[":search"+a]=s.trim())});let n={query:"getScanYabaSalesOrders",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r};const o=await mn(n);return console.log(n),console.log(o),o},async addInventory(t){return await mn({query:"addYabaInventory",params:{businessId:"YB100423253156428"},form:t})},async updInventory(t){return await Iv()},async addInvoice(t){let r={query:"addYabaSalesOrders",params:{businessId:"YB100423253156428"},form:t};const n=await mn(r);return console.log(r),console.log(n),n}},id={async getAll(t){return Jr.getInventory("ref")},async getById(t){return jr(async()=>{throw console.log("Getting movement by ID via real API:",t),new Error("Real API not implemented yet")},()=>Rr.movements.getById(t))},async create(t){return jr(async()=>{throw console.log("Creating movement via real API:",t),new Error("Real API not implemented yet")},()=>Rr.movements.create(t))},async update(t,e){return jr(async()=>{throw console.log("Updating movement via real API:",t,e),new Error("Real API not implemented yet")},()=>Rr.movements.update(t,e))},async createBulk(t){return jr(async()=>{throw console.log("Creating bulk movements via real API:",t),new Error("Real API not implemented yet")},()=>Rr.movements.createBulk(t))},async getStockLevels(t){return await mn({query:"calculateInventoryStock",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:t})},async calcStockLevels(){return[]}},Du={async getAll(t){return jr(async()=>{throw console.log("Getting accounts via real API:",t),new Error("Real API not implemented yet")},()=>Rr.accounts.getAll(t))},async getById(t){return jr(async()=>{throw console.log("Getting account by ID via real API:",t),new Error("Real API not implemented yet")},()=>Rr.accounts.getById(t))},async create(t){return jr(async()=>{throw console.log("Creating account via real API:",t),new Error("Real API not implemented yet")},()=>Rr.accounts.create(t))},async update(t,e){return jr(async()=>{throw console.log("Updating account via real API:",t,e),new Error("Real API not implemented yet")},()=>Rr.accounts.update(t,e))}},Nu={async getNextEntryNumber(){return jr(async()=>{throw console.log("Getting next entry number via real API"),new Error("Real API not implemented yet")},()=>Rr.utils.getNextEntryNumber())},async getNextProductCode(t){return jr(async()=>{throw console.log("Getting next product code via real API:",t),new Error("Real API not implemented yet")},()=>Rr.utils.getNextProductCode(t))},async healthCheck(){return jr(async()=>{const t=await fetch("/api/health");if(!t.ok)throw new Error("Health check failed");return t.json()},()=>Rr.utils.healthCheck())},async getStats(){return jr(async()=>{throw console.log("Getting stats via real API"),new Error("Real API not implemented yet")},()=>Rr.utils.getStats())}},Tv=()=>{ms.setMode("real"),console.log(" HRM Finance initialized in REAL API mode for production")};Tv();const kv=()=>{};var Lu={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cy=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let o=t.charCodeAt(n);o<128?e[r++]=o:o<2048?(e[r++]=o>>6|192,e[r++]=o&63|128):(o&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(o=65536+((o&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=o>>18|240,e[r++]=o>>12&63|128,e[r++]=o>>6&63|128,e[r++]=o&63|128):(e[r++]=o>>12|224,e[r++]=o>>6&63|128,e[r++]=o&63|128)}return e},Rv=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const o=t[r++];if(o<128)e[n++]=String.fromCharCode(o);else if(o>191&&o<224){const s=t[r++];e[n++]=String.fromCharCode((o&31)<<6|s&63)}else if(o>239&&o<365){const s=t[r++],a=t[r++],l=t[r++],u=((o&7)<<18|(s&63)<<12|(a&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((o&15)<<12|(s&63)<<6|a&63)}}return e.join("")},xy={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let o=0;o<t.length;o+=3){const s=t[o],a=o+1<t.length,l=a?t[o+1]:0,u=o+2<t.length,h=u?t[o+2]:0,m=s>>2,v=(s&3)<<4|l>>4;let _=(l&15)<<2|h>>6,x=h&63;u||(x=64,a||(_=64)),n.push(r[m],r[v],r[_],r[x])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Cy(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Rv(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let o=0;o<t.length;){const s=r[t.charAt(o++)],l=o<t.length?r[t.charAt(o)]:0;++o;const h=o<t.length?r[t.charAt(o)]:64;++o;const v=o<t.length?r[t.charAt(o)]:64;if(++o,s==null||l==null||h==null||v==null)throw new Dv;const _=s<<2|l>>4;if(n.push(_),h!==64){const x=l<<4&240|h>>2;if(n.push(x),v!==64){const T=h<<6&192|v;n.push(T)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Dv extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Nv=function(t){const e=Cy(t);return xy.encodeByteArray(e,!0)},Ra=function(t){return Nv(t).replace(/\./g,"")},$y=function(t){try{return xy.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lv(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mv=()=>Lv().__FIREBASE_DEFAULTS__,Ov=()=>{if(typeof process>"u"||typeof Lu>"u")return;const t=Lu.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Fv=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&$y(t[1]);return e&&JSON.parse(e)},tl=()=>{try{return kv()||Mv()||Ov()||Fv()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Ay=t=>tl()?.emulatorHosts?.[t],Vv=t=>{const e=Ay(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},Iy=()=>tl()?.config,Ey=t=>tl()?.[`_${t}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bv{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ii(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Ty(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uv(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",o=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${n}`,aud:n,iat:o,exp:o+3600,auth_time:o,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Ra(JSON.stringify(r)),Ra(JSON.stringify(a)),""].join(".")}const rs={};function zv(){const t={prod:[],emulator:[]};for(const e of Object.keys(rs))rs[e]?t.emulator.push(e):t.prod.push(e);return t}function jv(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let Mu=!1;function ky(t,e){if(typeof window>"u"||typeof document>"u"||!Ii(window.location.host)||rs[t]===e||rs[t]||Mu)return;rs[t]=e;function r(_){return`__firebase__banner__${_}`}const n="__firebase__banner",s=zv().prod.length>0;function a(){const _=document.getElementById(n);_&&_.remove()}function l(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function u(_,x){_.setAttribute("width","24"),_.setAttribute("id",x),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function h(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{Mu=!0,a()},_}function m(_,x){_.setAttribute("id",x),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function v(){const _=jv(n),x=r("text"),T=document.getElementById(x)||document.createElement("span"),E=r("learnmore"),P=document.getElementById(E)||document.createElement("a"),R=r("preprendIcon"),Y=document.getElementById(R)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const Z=_.element;l(Z),m(P,E);const j=h();u(Y,R),Z.append(Y,T,P,j),document.body.appendChild(Z)}s?(T.innerText="Preview backend disconnected.",Y.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Y.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",x)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function qv(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Gr())}function Gv(){const t=tl()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Hv(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Wv(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Yv(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Kv(){const t=Gr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Qv(){return!Gv()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Jv(){try{return typeof indexedDB=="object"}catch{return!1}}function Xv(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(n);o.onsuccess=()=>{o.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},o.onupgradeneeded=()=>{r=!1},o.onerror=()=>{e(o.error?.message||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zv="FirebaseError";class eo extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=Zv,Object.setPrototypeOf(this,eo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,$s.prototype.create)}}class $s{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},o=`${this.service}/${e}`,s=this.errors[e],a=s?eb(s,n):"Error",l=`${this.serviceName}: ${a} (${o}).`;return new eo(o,l,n)}}function eb(t,e){return t.replace(tb,(r,n)=>{const o=e[n];return o!=null?String(o):`<${n}?>`})}const tb=/\{\$([^}]+)}/g;function rb(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Go(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const o of r){if(!n.includes(o))return!1;const s=t[o],a=e[o];if(Ou(s)&&Ou(a)){if(!Go(s,a))return!1}else if(s!==a)return!1}for(const o of n)if(!r.includes(o))return!1;return!0}function Ou(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function As(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(o=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function nb(t,e){const r=new ob(t,e);return r.subscribe.bind(r)}class ob{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let o;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");ib(e,["next","error","complete"])?o=e:o={next:e,error:r,complete:n},o.next===void 0&&(o.next=Ml),o.error===void 0&&(o.error=Ml),o.complete===void 0&&(o.complete=Ml);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ib(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Ml(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nr(t){return t&&t._delegate?t._delegate:t}class Ho{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sb{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new Bv;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:r});o&&n.resolve(o)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(n)return null;throw o}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(lb(e))try{this.getOrInitializeService({instanceIdentifier:Oo})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:o});n.resolve(s)}catch{}}}}clearInstance(e=Oo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Oo){return this.instances.has(e)}getOptions(e=Oo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);n===l&&a.resolve(o)}return o}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),o=this.onInitCallbacks.get(n)??new Set;o.add(e),this.onInitCallbacks.set(n,o);const s=this.instances.get(n);return s&&e(s,n),()=>{o.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const o of n)try{o(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:ab(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Oo){return this.component?this.component.multipleInstances?e:Oo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ab(t){return t===Oo?void 0:t}function lb(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cb{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new sb(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Bt||(Bt={}));const db={debug:Bt.DEBUG,verbose:Bt.VERBOSE,info:Bt.INFO,warn:Bt.WARN,error:Bt.ERROR,silent:Bt.SILENT},ub=Bt.INFO,hb={[Bt.DEBUG]:"log",[Bt.VERBOSE]:"log",[Bt.INFO]:"info",[Bt.WARN]:"warn",[Bt.ERROR]:"error"},mb=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),o=hb[e];if(o)console[o](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class sd{constructor(e){this.name=e,this._logLevel=ub,this._logHandler=mb,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Bt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?db[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Bt.DEBUG,...e),this._logHandler(this,Bt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Bt.VERBOSE,...e),this._logHandler(this,Bt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Bt.INFO,...e),this._logHandler(this,Bt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Bt.WARN,...e),this._logHandler(this,Bt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Bt.ERROR,...e),this._logHandler(this,Bt.ERROR,...e)}}const yb=(t,e)=>e.some(r=>t instanceof r);let Fu,Vu;function pb(){return Fu||(Fu=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function fb(){return Vu||(Vu=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Ry=new WeakMap,Pc=new WeakMap,Dy=new WeakMap,Ol=new WeakMap,ad=new WeakMap;function gb(t){const e=new Promise((r,n)=>{const o=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(mo(t.result)),o()},a=()=>{n(t.error),o()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&Ry.set(r,t)}).catch(()=>{}),ad.set(e,t),e}function vb(t){if(Pc.has(t))return;const e=new Promise((r,n)=>{const o=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),o()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),o()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});Pc.set(t,e)}let wc={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Pc.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Dy.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return mo(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function bb(t){wc=t(wc)}function _b(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Fl(this),e,...r);return Dy.set(n,e.sort?e.sort():[e]),mo(n)}:fb().includes(t)?function(...e){return t.apply(Fl(this),e),mo(Ry.get(this))}:function(...e){return mo(t.apply(Fl(this),e))}}function Sb(t){return typeof t=="function"?_b(t):(t instanceof IDBTransaction&&vb(t),yb(t,pb())?new Proxy(t,wc):t)}function mo(t){if(t instanceof IDBRequest)return gb(t);if(Ol.has(t))return Ol.get(t);const e=Sb(t);return e!==t&&(Ol.set(t,e),ad.set(e,t)),e}const Fl=t=>ad.get(t);function Pb(t,e,{blocked:r,upgrade:n,blocking:o,terminated:s}={}){const a=indexedDB.open(t,e),l=mo(a);return n&&a.addEventListener("upgradeneeded",u=>{n(mo(a.result),u.oldVersion,u.newVersion,mo(a.transaction),u)}),r&&a.addEventListener("blocked",u=>r(u.oldVersion,u.newVersion,u)),l.then(u=>{s&&u.addEventListener("close",()=>s()),o&&u.addEventListener("versionchange",h=>o(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const wb=["get","getKey","getAll","getAllKeys","count"],Cb=["put","add","delete","clear"],Vl=new Map;function Bu(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Vl.get(e))return Vl.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,o=Cb.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(o||wb.includes(r)))return;const s=async function(a,...l){const u=this.transaction(a,o?"readwrite":"readonly");let h=u.store;return n&&(h=h.index(l.shift())),(await Promise.all([h[r](...l),o&&u.done]))[0]};return Vl.set(e,s),s}bb(t=>({...t,get:(e,r,n)=>Bu(e,r)||t.get(e,r,n),has:(e,r)=>!!Bu(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xb{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if($b(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function $b(t){return t.getComponent()?.type==="VERSION"}const Cc="@firebase/app",Uu="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kn=new sd("@firebase/app"),Ab="@firebase/app-compat",Ib="@firebase/analytics-compat",Eb="@firebase/analytics",Tb="@firebase/app-check-compat",kb="@firebase/app-check",Rb="@firebase/auth",Db="@firebase/auth-compat",Nb="@firebase/database",Lb="@firebase/data-connect",Mb="@firebase/database-compat",Ob="@firebase/functions",Fb="@firebase/functions-compat",Vb="@firebase/installations",Bb="@firebase/installations-compat",Ub="@firebase/messaging",zb="@firebase/messaging-compat",jb="@firebase/performance",qb="@firebase/performance-compat",Gb="@firebase/remote-config",Hb="@firebase/remote-config-compat",Wb="@firebase/storage",Yb="@firebase/storage-compat",Kb="@firebase/firestore",Qb="@firebase/ai",Jb="@firebase/firestore-compat",Xb="firebase",Zb="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xc="[DEFAULT]",e0={[Cc]:"fire-core",[Ab]:"fire-core-compat",[Eb]:"fire-analytics",[Ib]:"fire-analytics-compat",[kb]:"fire-app-check",[Tb]:"fire-app-check-compat",[Rb]:"fire-auth",[Db]:"fire-auth-compat",[Nb]:"fire-rtdb",[Lb]:"fire-data-connect",[Mb]:"fire-rtdb-compat",[Ob]:"fire-fn",[Fb]:"fire-fn-compat",[Vb]:"fire-iid",[Bb]:"fire-iid-compat",[Ub]:"fire-fcm",[zb]:"fire-fcm-compat",[jb]:"fire-perf",[qb]:"fire-perf-compat",[Gb]:"fire-rc",[Hb]:"fire-rc-compat",[Wb]:"fire-gcs",[Yb]:"fire-gcs-compat",[Kb]:"fire-fst",[Jb]:"fire-fst-compat",[Qb]:"fire-vertex","fire-js":"fire-js",[Xb]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Da=new Map,t0=new Map,$c=new Map;function zu(t,e){try{t.container.addComponent(e)}catch(r){Kn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function bi(t){const e=t.name;if($c.has(e))return Kn.debug(`There were multiple attempts to register component ${e}.`),!1;$c.set(e,t);for(const r of Da.values())zu(r,t);for(const r of t0.values())zu(r,t);return!0}function ld(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function yn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r0={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},yo=new $s("app","Firebase",r0);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n0{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ho("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw yo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ei=Zb;function Ny(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:xc,automaticDataCollectionEnabled:!0,...e},o=n.name;if(typeof o!="string"||!o)throw yo.create("bad-app-name",{appName:String(o)});if(r||(r=Iy()),!r)throw yo.create("no-options");const s=Da.get(o);if(s){if(Go(r,s.options)&&Go(n,s.config))return s;throw yo.create("duplicate-app",{appName:o})}const a=new cb(o);for(const u of $c.values())a.addComponent(u);const l=new n0(r,n,a);return Da.set(o,l),l}function Ly(t=xc){const e=Da.get(t);if(!e&&t===xc&&Iy())return Ny();if(!e)throw yo.create("no-app",{appName:t});return e}function po(t,e,r){let n=e0[t]??t;r&&(n+=`-${r}`);const o=n.match(/\s|\//),s=e.match(/\s|\//);if(o||s){const a=[`Unable to register library "${n}" with version "${e}":`];o&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),o&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Kn.warn(a.join(" "));return}bi(new Ho(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o0="firebase-heartbeat-database",i0=1,ys="firebase-heartbeat-store";let Bl=null;function My(){return Bl||(Bl=Pb(o0,i0,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ys)}catch(r){console.warn(r)}}}}).catch(t=>{throw yo.create("idb-open",{originalErrorMessage:t.message})})),Bl}async function s0(t){try{const r=(await My()).transaction(ys),n=await r.objectStore(ys).get(Oy(t));return await r.done,n}catch(e){if(e instanceof eo)Kn.warn(e.message);else{const r=yo.create("idb-get",{originalErrorMessage:e?.message});Kn.warn(r.message)}}}async function ju(t,e){try{const n=(await My()).transaction(ys,"readwrite");await n.objectStore(ys).put(e,Oy(t)),await n.done}catch(r){if(r instanceof eo)Kn.warn(r.message);else{const n=yo.create("idb-set",{originalErrorMessage:r?.message});Kn.warn(n.message)}}}function Oy(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a0=1024,l0=30;class c0{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new u0(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=qu();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(o=>o.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>l0){const o=h0(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Kn.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=qu(),{heartbeatsToSend:r,unsentEntries:n}=d0(this._heartbeatsCache.heartbeats),o=Ra(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(e){return Kn.warn(e),""}}}function qu(){return new Date().toISOString().substring(0,10)}function d0(t,e=a0){const r=[];let n=t.slice();for(const o of t){const s=r.find(a=>a.agent===o.agent);if(s){if(s.dates.push(o.date),Gu(r)>e){s.dates.pop();break}}else if(r.push({agent:o.agent,dates:[o.date]}),Gu(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class u0{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Jv()?Xv().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await s0(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return ju(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return ju(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Gu(t){return Ra(JSON.stringify({version:2,heartbeats:t})).length}function h0(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m0(t){bi(new Ho("platform-logger",e=>new xb(e),"PRIVATE")),bi(new Ho("heartbeat",e=>new c0(e),"PRIVATE")),po(Cc,Uu,t),po(Cc,Uu,"esm2020"),po("fire-js","")}m0("");function Fy(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const y0=Fy,Vy=new $s("auth","Firebase",Fy());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Na=new sd("@firebase/auth");function p0(t,...e){Na.logLevel<=Bt.WARN&&Na.warn(`Auth (${Ei}): ${t}`,...e)}function ya(t,...e){Na.logLevel<=Bt.ERROR&&Na.error(`Auth (${Ei}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function On(t,...e){throw dd(t,...e)}function Pn(t,...e){return dd(t,...e)}function cd(t,e,r){const n={...y0(),[e]:r};return new $s("auth","Firebase",n).create(e,{appName:t.name})}function fo(t){return cd(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function By(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&On(t,"argument-error"),cd(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function dd(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return Vy.create(t,...e)}function St(t,e,...r){if(!t)throw dd(e,...r)}function qn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw ya(e),new Error(e)}function Qn(t,e){t||qn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ac(){return typeof self<"u"&&self.location?.href||""}function f0(){return Hu()==="http:"||Hu()==="https:"}function Hu(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g0(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(f0()||Wv()||"connection"in navigator)?navigator.onLine:!0}function v0(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is{constructor(e,r){this.shortDelay=e,this.longDelay=r,Qn(r>e,"Short delay should be less than long delay!"),this.isMobile=qv()||Yv()}get(){return g0()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ud(t,e){Qn(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uy{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;qn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;qn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;qn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b0={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _0=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],S0=new Is(3e4,6e4);function hd(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Ti(t,e,r,n,o={}){return zy(t,o,async()=>{let s={},a={};n&&(e==="GET"?a=n:s={body:JSON.stringify(n)});const l=As({key:t.config.apiKey,...a}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const h={method:e,headers:u,...s};return Hv()||(h.referrerPolicy="no-referrer"),t.emulatorConfig&&Ii(t.emulatorConfig.host)&&(h.credentials="include"),Uy.fetch()(await jy(t,t.config.apiHost,r,l),h)})}async function zy(t,e,r){t._canInitEmulator=!1;const n={...b0,...e};try{const o=new w0(t),s=await Promise.race([r(),o.promise]);o.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw Ks(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const l=s.ok?a.errorMessage:a.error.message,[u,h]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ks(t,"credential-already-in-use",a);if(u==="EMAIL_EXISTS")throw Ks(t,"email-already-in-use",a);if(u==="USER_DISABLED")throw Ks(t,"user-disabled",a);const m=n[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw cd(t,m,h);On(t,m)}}catch(o){if(o instanceof eo)throw o;On(t,"network-request-failed",{message:String(o)})}}async function P0(t,e,r,n,o={}){const s=await Ti(t,e,r,n,o);return"mfaPendingCredential"in s&&On(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function jy(t,e,r,n){const o=`${e}${r}?${n}`,s=t,a=s.config.emulator?ud(t.config,o):`${t.config.apiScheme}://${o}`;return _0.includes(r)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a}class w0{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Pn(this.auth,"network-request-failed")),S0.get())})}}function Ks(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const o=Pn(t,e,n);return o.customData._tokenResponse=r,o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C0(t,e){return Ti(t,"POST","/v1/accounts:delete",e)}async function La(t,e){return Ti(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ns(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function x0(t,e=!1){const r=Nr(t),n=await r.getIdToken(e),o=md(n);St(o&&o.exp&&o.auth_time&&o.iat,r.auth,"internal-error");const s=typeof o.firebase=="object"?o.firebase:void 0,a=s?.sign_in_provider;return{claims:o,token:n,authTime:ns(Ul(o.auth_time)),issuedAtTime:ns(Ul(o.iat)),expirationTime:ns(Ul(o.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}}function Ul(t){return Number(t)*1e3}function md(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return ya("JWT malformed, contained fewer than 3 sections"),null;try{const o=$y(r);return o?JSON.parse(o):(ya("Failed to decode base64 JWT payload"),null)}catch(o){return ya("Caught error parsing JWT payload as JSON",o?.toString()),null}}function Wu(t){const e=md(t);return St(e,"internal-error"),St(typeof e.exp<"u","internal-error"),St(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ps(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof eo&&$0(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function $0({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A0{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ic{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=ns(this.lastLoginAt),this.creationTime=ns(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ma(t){const e=t.auth,r=await t.getIdToken(),n=await ps(t,La(e,{idToken:r}));St(n?.users.length,e,"internal-error");const o=n.users[0];t._notifyReloadListener(o);const s=o.providerUserInfo?.length?qy(o.providerUserInfo):[],a=E0(t.providerData,s),l=t.isAnonymous,u=!(t.email&&o.passwordHash)&&!a?.length,h=l?u:!1,m={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new Ic(o.createdAt,o.lastLoginAt),isAnonymous:h};Object.assign(t,m)}async function I0(t){const e=Nr(t);await Ma(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function E0(t,e){return[...t.filter(n=>!e.some(o=>o.providerId===n.providerId)),...e]}function qy(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function T0(t,e){const r=await zy(t,{},async()=>{const n=As({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:s}=t.config,a=await jy(t,o,"/v1/token",`key=${s}`),l=await t._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:l,body:n};return t.emulatorConfig&&Ii(t.emulatorConfig.host)&&(u.credentials="include"),Uy.fetch()(a,u)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function k0(t,e){return Ti(t,"POST","/v2/accounts:revokeToken",hd(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){St(e.idToken,"internal-error"),St(typeof e.idToken<"u","internal-error"),St(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Wu(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){St(e.length!==0,"internal-error");const r=Wu(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(St(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:o,expiresIn:s}=await T0(e,r);this.updateTokensAndExpiration(n,o,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:o,expirationTime:s}=r,a=new yi;return n&&(St(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),o&&(St(typeof o=="string","internal-error",{appName:e}),a.accessToken=o),s&&(St(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new yi,this.toJSON())}_performRefresh(){return qn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function no(t,e){St(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class _n{constructor({uid:e,auth:r,stsTokenManager:n,...o}){this.providerId="firebase",this.proactiveRefresh=new A0(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Ic(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const r=await ps(this,this.stsTokenManager.getToken(this.auth,e));return St(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return x0(this,e)}reload(){return I0(this)}_assign(e){this!==e&&(St(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new _n({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){St(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Ma(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(yn(this.auth.app))return Promise.reject(fo(this.auth));const e=await this.getIdToken();return await ps(this,C0(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,o=r.email??void 0,s=r.phoneNumber??void 0,a=r.photoURL??void 0,l=r.tenantId??void 0,u=r._redirectEventId??void 0,h=r.createdAt??void 0,m=r.lastLoginAt??void 0,{uid:v,emailVerified:_,isAnonymous:x,providerData:T,stsTokenManager:E}=r;St(v&&E,e,"internal-error");const P=yi.fromJSON(this.name,E);St(typeof v=="string",e,"internal-error"),no(n,e.name),no(o,e.name),St(typeof _=="boolean",e,"internal-error"),St(typeof x=="boolean",e,"internal-error"),no(s,e.name),no(a,e.name),no(l,e.name),no(u,e.name),no(h,e.name),no(m,e.name);const R=new _n({uid:v,auth:e,email:o,emailVerified:_,displayName:n,isAnonymous:x,photoURL:a,phoneNumber:s,tenantId:l,stsTokenManager:P,createdAt:h,lastLoginAt:m});return T&&Array.isArray(T)&&(R.providerData=T.map(Y=>({...Y}))),u&&(R._redirectEventId=u),R}static async _fromIdTokenResponse(e,r,n=!1){const o=new yi;o.updateFromServerResponse(r);const s=new _n({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:n});return await Ma(s),s}static async _fromGetAccountInfoResponse(e,r,n){const o=r.users[0];St(o.localId!==void 0,"internal-error");const s=o.providerUserInfo!==void 0?qy(o.providerUserInfo):[],a=!(o.email&&o.passwordHash)&&!s?.length,l=new yi;l.updateFromIdToken(n);const u=new _n({uid:o.localId,auth:e,stsTokenManager:l,isAnonymous:a}),h={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:s,metadata:new Ic(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!s?.length};return Object.assign(u,h),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yu=new Map;function Gn(t){Qn(t instanceof Function,"Expected a class definition");let e=Yu.get(t);return e?(Qn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Yu.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gy{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}Gy.type="NONE";const Ku=Gy;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pa(t,e,r){return`firebase:${t}:${e}:${r}`}class pi{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:o,name:s}=this.auth;this.fullUserKey=pa(this.userKey,o.apiKey,s),this.fullPersistenceKey=pa("persistence",o.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await La(this.auth,{idToken:e}).catch(()=>{});return r?_n._fromGetAccountInfoResponse(this.auth,r,e):null}return _n._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new pi(Gn(Ku),e,n);const o=(await Promise.all(r.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=o[0]||Gn(Ku);const a=pa(n,e.config.apiKey,e.name);let l=null;for(const h of r)try{const m=await h._get(a);if(m){let v;if(typeof m=="string"){const _=await La(e,{idToken:m}).catch(()=>{});if(!_)break;v=await _n._fromGetAccountInfoResponse(e,_,m)}else v=_n._fromJSON(e,m);h!==s&&(l=v),s=h;break}}catch{}const u=o.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new pi(s,e,n):(s=u[0],l&&await s._set(a,l.toJSON()),await Promise.all(r.map(async h=>{if(h!==s)try{await h._remove(a)}catch{}})),new pi(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qu(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Ky(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Hy(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Jy(e))return"Blackberry";if(Xy(e))return"Webos";if(Wy(e))return"Safari";if((e.includes("chrome/")||Yy(e))&&!e.includes("edge/"))return"Chrome";if(Qy(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function Hy(t=Gr()){return/firefox\//i.test(t)}function Wy(t=Gr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Yy(t=Gr()){return/crios\//i.test(t)}function Ky(t=Gr()){return/iemobile/i.test(t)}function Qy(t=Gr()){return/android/i.test(t)}function Jy(t=Gr()){return/blackberry/i.test(t)}function Xy(t=Gr()){return/webos/i.test(t)}function yd(t=Gr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function R0(t=Gr()){return yd(t)&&!!window.navigator?.standalone}function D0(){return Kv()&&document.documentMode===10}function Zy(t=Gr()){return yd(t)||Qy(t)||Xy(t)||Jy(t)||/windows phone/i.test(t)||Ky(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ep(t,e=[]){let r;switch(t){case"Browser":r=Qu(Gr());break;case"Worker":r=`${Qu(Gr())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Ei}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((a,l)=>{try{const u=e(s);a(u)}catch(u){l(u)}});n.onAbort=r,this.queue.push(n);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const o of r)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L0(t,e={}){return Ti(t,"GET","/v2/passwordPolicy",hd(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M0=6;class O0{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??M0,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),o&&(r.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let o=0;o<e.length;o++)n=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,o,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F0{constructor(e,r,n,o){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ju(this),this.idTokenSubscription=new Ju(this),this.beforeStateQueue=new N0(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Vy,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Gn(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await pi.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await La(this,{idToken:e}),n=await _n._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(yn(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,a=n?._redirectEventId,l=await this.tryRedirectSignIn(e);(!s||s===a)&&l?.user&&(n=l.user,o=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(n)}catch(s){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return St(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Ma(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=v0()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(yn(this.app))return Promise.reject(fo(this));const r=e?Nr(e):null;return r&&St(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&St(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return yn(this.app)?Promise.reject(fo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return yn(this.app)?Promise.reject(fo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Gn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await L0(this),r=new O0(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new $s("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await k0(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Gn(e)||this._popupRedirectResolver;St(r,this,"argument-error"),this.redirectPersistenceManager=await pi.create(this,[Gn(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,o){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(St(l,this,"internal-error"),l.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const u=e.addObserver(r,n,o);return()=>{a=!0,u()}}else{const u=e.addObserver(r);return()=>{a=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return St(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ep(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(yn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&p0(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Qo(t){return Nr(t)}class Ju{constructor(e){this.auth=e,this.observer=null,this.addObserver=nb(r=>this.observer=r)}get next(){return St(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function V0(t){pd=t}function B0(t){return pd.loadJS(t)}function U0(){return pd.gapiScript}function z0(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j0(t,e){const r=ld(t,"auth");if(r.isInitialized()){const o=r.getImmediate(),s=r.getOptions();if(Go(s,e??{}))return o;On(o,"already-initialized")}return r.initialize({options:e})}function q0(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(Gn);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function G0(t,e,r){const n=Qo(t);St(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const o=!1,s=tp(e),{host:a,port:l}=H0(e),u=l===null?"":`:${l}`,h={url:`${s}//${a}${u}/`},m=Object.freeze({host:a,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!n._canInitEmulator){St(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),St(Go(h,n.config.emulator)&&Go(m,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=h,n.emulatorConfig=m,n.settings.appVerificationDisabledForTesting=!0,Ii(a)?(Ty(`${s}//${a}${u}`),ky("Auth",!0)):W0()}function tp(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function H0(t){const e=tp(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(n);if(o){const s=o[1];return{host:s,port:Xu(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:Xu(a)}}}function Xu(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function W0(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rp{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return qn("not implemented")}_getIdTokenResponse(e){return qn("not implemented")}_linkToIdToken(e,r){return qn("not implemented")}_getReauthenticationResolver(e){return qn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fi(t,e){return P0(t,"POST","/v1/accounts:signInWithIdp",hd(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y0="http://localhost";class Wo extends rp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Wo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):On("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:o,...s}=r;if(!n||!o)return null;const a=new Wo(n,o);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return fi(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,fi(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,fi(e,r)}buildRequest(){const e={requestUri:Y0,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=As(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es extends rl{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao extends Es{constructor(){super("facebook.com")}static credential(e){return Wo._fromParams({providerId:ao.PROVIDER_ID,signInMethod:ao.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ao.credentialFromTaggedObject(e)}static credentialFromError(e){return ao.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ao.credential(e.oauthAccessToken)}catch{return null}}}ao.FACEBOOK_SIGN_IN_METHOD="facebook.com";ao.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn extends Es{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Wo._fromParams({providerId:Tn.PROVIDER_ID,signInMethod:Tn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Tn.credentialFromTaggedObject(e)}static credentialFromError(e){return Tn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Tn.credential(r,n)}catch{return null}}}Tn.GOOGLE_SIGN_IN_METHOD="google.com";Tn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lo extends Es{constructor(){super("github.com")}static credential(e){return Wo._fromParams({providerId:lo.PROVIDER_ID,signInMethod:lo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return lo.credentialFromTaggedObject(e)}static credentialFromError(e){return lo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return lo.credential(e.oauthAccessToken)}catch{return null}}}lo.GITHUB_SIGN_IN_METHOD="github.com";lo.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co extends Es{constructor(){super("twitter.com")}static credential(e,r){return Wo._fromParams({providerId:co.PROVIDER_ID,signInMethod:co.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return co.credentialFromTaggedObject(e)}static credentialFromError(e){return co.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return co.credential(r,n)}catch{return null}}}co.TWITTER_SIGN_IN_METHOD="twitter.com";co.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,o=!1){const s=await _n._fromIdTokenResponse(e,n,o),a=Zu(n);return new _i({user:s,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const o=Zu(n);return new _i({user:e,providerId:o,_tokenResponse:n,operationType:r})}}function Zu(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa extends eo{constructor(e,r,n,o){super(r.code,r.message),this.operationType=n,this.user=o,Object.setPrototypeOf(this,Oa.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,o){return new Oa(e,r,n,o)}}function np(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Oa._fromErrorAndOperation(t,s,e,n):s})}async function K0(t,e,r=!1){const n=await ps(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return _i._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q0(t,e,r=!1){const{auth:n}=t;if(yn(n.app))return Promise.reject(fo(n));const o="reauthenticate";try{const s=await ps(t,np(n,o,e,t),r);St(s.idToken,n,"internal-error");const a=md(s.idToken);St(a,n,"internal-error");const{sub:l}=a;return St(t.uid===l,n,"user-mismatch"),_i._forOperation(t,o,s)}catch(s){throw s?.code==="auth/user-not-found"&&On(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function op(t,e,r=!1){if(yn(t.app))return Promise.reject(fo(t));const n="signIn",o=await np(t,n,e),s=await _i._fromIdTokenResponse(t,n,o);return r||await t._updateCurrentUser(s.user),s}async function J0(t,e){return op(Qo(t),e)}function X0(t,e,r,n){return Nr(t).onIdTokenChanged(e,r,n)}function Z0(t,e,r){return Nr(t).beforeAuthStateChanged(e,r)}function e_(t,e,r,n){return Nr(t).onAuthStateChanged(e,r,n)}function t_(t){return Nr(t).signOut()}const Fa="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ip{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Fa,"1"),this.storage.removeItem(Fa),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r_=1e3,n_=10;class sp extends ip{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Zy(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),o=this.localCache[r];n!==o&&e(r,o,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,l,u)=>{this.notifyListeners(a,u)});return}const n=e.key;r?this.detachListener():this.stopPolling();const o=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);D0()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,n_):o()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const o of Array.from(n))o(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},r_)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}sp.type="LOCAL";const o_=sp;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap extends ip{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}ap.type="SESSION";const lp=ap;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i_(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(o=>o.isListeningto(e));if(r)return r;const n=new nl(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:o,data:s}=r.data,a=this.handlersMap[o];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:o});const l=Array.from(a).map(async h=>h(r.origin,s)),u=await i_(l);r.ports[0].postMessage({status:"done",eventId:n,eventType:o,response:u})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}nl.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fd(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s_{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let s,a;return new Promise((l,u)=>{const h=fd("",20);o.port1.start();const m=setTimeout(()=>{u(new Error("unsupported_event"))},n);a={messageChannel:o,onMessage(v){const _=v;if(_.data.eventId===h)switch(_.data.status){case"ack":clearTimeout(m),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(_.data.response);break;default:clearTimeout(m),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(a),o.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:h,data:r},[o.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kn(){return window}function a_(t){kn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cp(){return typeof kn().WorkerGlobalScope<"u"&&typeof kn().importScripts=="function"}async function l_(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function c_(){return navigator?.serviceWorker?.controller||null}function d_(){return cp()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dp="firebaseLocalStorageDb",u_=1,Va="firebaseLocalStorage",up="fbase_key";class Ts{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function ol(t,e){return t.transaction([Va],e?"readwrite":"readonly").objectStore(Va)}function h_(){const t=indexedDB.deleteDatabase(dp);return new Ts(t).toPromise()}function Ec(){const t=indexedDB.open(dp,u_);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Va,{keyPath:up})}catch(o){r(o)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Va)?e(n):(n.close(),await h_(),e(await Ec()))})})}async function eh(t,e,r){const n=ol(t,!0).put({[up]:e,value:r});return new Ts(n).toPromise()}async function m_(t,e){const r=ol(t,!1).get(e),n=await new Ts(r).toPromise();return n===void 0?null:n.value}function th(t,e){const r=ol(t,!0).delete(e);return new Ts(r).toPromise()}const y_=800,p_=3;class hp{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ec(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>p_)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return cp()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=nl._getInstance(d_()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await l_(),!this.activeServiceWorker)return;this.sender=new s_(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||c_()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ec();return await eh(e,Fa,"1"),await th(e,Fa),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>eh(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>m_(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>th(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const s=ol(o,!1).getAll();return new Ts(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:o,value:s}of e)n.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(s)&&(this.notifyListeners(o,s),r.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!n.has(o)&&(this.notifyListeners(o,null),r.push(o));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const o of Array.from(n))o(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),y_)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}hp.type="LOCAL";const f_=hp;new Is(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gd(t,e){return e?Gn(e):(St(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vd extends rp{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return fi(e,this._buildIdpRequest())}_linkToIdToken(e,r){return fi(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return fi(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function g_(t){return op(t.auth,new vd(t),t.bypassAuthState)}function v_(t){const{auth:e,user:r}=t;return St(r,e,"internal-error"),Q0(r,new vd(t),t.bypassAuthState)}async function b_(t){const{auth:e,user:r}=t;return St(r,e,"internal-error"),K0(r,new vd(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mp{constructor(e,r,n,o,s=!1){this.auth=e,this.resolver=n,this.user=o,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:o,tenantId:s,error:a,type:l}=e;if(a){this.reject(a);return}const u={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return g_;case"linkViaPopup":case"linkViaRedirect":return b_;case"reauthViaPopup":case"reauthViaRedirect":return v_;default:On(this.auth,"internal-error")}}resolve(e){Qn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Qn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const __=new Is(2e3,1e4);async function S_(t,e,r){if(yn(t.app))return Promise.reject(Pn(t,"operation-not-supported-in-this-environment"));const n=Qo(t);By(t,e,rl);const o=gd(n,r);return new Uo(n,"signInViaPopup",e,o).executeNotNull()}class Uo extends mp{constructor(e,r,n,o,s){super(e,r,o,s),this.provider=n,this.authWindow=null,this.pollId=null,Uo.currentPopupAction&&Uo.currentPopupAction.cancel(),Uo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return St(e,this.auth,"internal-error"),e}async onExecution(){Qn(this.filter.length===1,"Popup operations only handle one event");const e=fd();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Pn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Pn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Uo.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Pn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,__.get())};e()}}Uo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P_="pendingRedirect",fa=new Map;class w_ extends mp{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=fa.get(this.auth._key());if(!e){try{const n=await C_(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}fa.set(this.auth._key(),e)}return this.bypassAuthState||fa.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function C_(t,e){const r=pp(e),n=yp(t);if(!await n._isAvailable())return!1;const o=await n._get(r)==="true";return await n._remove(r),o}async function x_(t,e){return yp(t)._set(pp(e),"true")}function $_(t,e){fa.set(t._key(),e)}function yp(t){return Gn(t._redirectPersistence)}function pp(t){return pa(P_,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A_(t,e,r){return I_(t,e,r)}async function I_(t,e,r){if(yn(t.app))return Promise.reject(fo(t));const n=Qo(t);By(t,e,rl),await n._initializationPromise;const o=gd(n,r);return await x_(o,n),o._openRedirect(n,e,"signInViaRedirect")}async function E_(t,e){return await Qo(t)._initializationPromise,fp(t,e,!1)}async function fp(t,e,r=!1){if(yn(t.app))return Promise.reject(fo(t));const n=Qo(t),o=gd(n,e),a=await new w_(n,o,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T_=10*60*1e3;class k_{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!R_(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!gp(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(Pn(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=T_&&this.cachedEventUids.clear(),this.cachedEventUids.has(rh(e))}saveEventToCache(e){this.cachedEventUids.add(rh(e)),this.lastProcessedEventTime=Date.now()}}function rh(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function gp({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function R_(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return gp(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D_(t,e={}){return Ti(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N_=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,L_=/^https?/;async function M_(t){if(t.config.emulator)return;const{authorizedDomains:e}=await D_(t);for(const r of e)try{if(O_(r))return}catch{}On(t,"unauthorized-domain")}function O_(t){const e=Ac(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!L_.test(r))return!1;if(N_.test(t))return n===t;const o=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F_=new Is(3e4,6e4);function nh(){const t=kn().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function V_(t){return new Promise((e,r)=>{function n(){nh(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{nh(),r(Pn(t,"network-request-failed"))},timeout:F_.get()})}if(kn().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(kn().gapi?.load)n();else{const o=z0("iframefcb");return kn()[o]=()=>{gapi.load?n():r(Pn(t,"network-request-failed"))},B0(`${U0()}?onload=${o}`).catch(s=>r(s))}}).catch(e=>{throw ga=null,e})}let ga=null;function B_(t){return ga=ga||V_(t),ga}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U_=new Is(5e3,15e3),z_="__/auth/iframe",j_="emulator/auth/iframe",q_={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},G_=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function H_(t){const e=t.config;St(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?ud(e,j_):`https://${t.config.authDomain}/${z_}`,n={apiKey:e.apiKey,appName:t.name,v:Ei},o=G_.get(t.config.apiHost);o&&(n.eid=o);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${As(n).slice(1)}`}async function W_(t){const e=await B_(t),r=kn().gapi;return St(r,t,"internal-error"),e.open({where:document.body,url:H_(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:q_,dontclear:!0},n=>new Promise(async(o,s)=>{await n.restyle({setHideOnLeave:!1});const a=Pn(t,"network-request-failed"),l=kn().setTimeout(()=>{s(a)},U_.get());function u(){kn().clearTimeout(l),o(n)}n.ping(u).then(u,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y_={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},K_=500,Q_=600,J_="_blank",X_="http://localhost";class oh{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Z_(t,e,r,n=K_,o=Q_){const s=Math.max((window.screen.availHeight-o)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const u={...Y_,width:n.toString(),height:o.toString(),top:s,left:a},h=Gr().toLowerCase();r&&(l=Yy(h)?J_:r),Hy(h)&&(e=e||X_,u.scrollbars="yes");const m=Object.entries(u).reduce((_,[x,T])=>`${_}${x}=${T},`,"");if(R0(h)&&l!=="_self")return e1(e||"",l),new oh(null);const v=window.open(e||"",l,m);St(v,t,"popup-blocked");try{v.focus()}catch{}return new oh(v)}function e1(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t1="__/auth/handler",r1="emulator/auth/handler",n1=encodeURIComponent("fac");async function ih(t,e,r,n,o,s){St(t.config.authDomain,t,"auth-domain-config-required"),St(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Ei,eventId:o};if(e instanceof rl){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",rb(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,v]of Object.entries({}))a[m]=v}if(e instanceof Es){const m=e.getScopes().filter(v=>v!=="");m.length>0&&(a.scopes=m.join(","))}t.tenantId&&(a.tid=t.tenantId);const l=a;for(const m of Object.keys(l))l[m]===void 0&&delete l[m];const u=await t._getAppCheckToken(),h=u?`#${n1}=${encodeURIComponent(u)}`:"";return`${o1(t)}?${As(l).slice(1)}${h}`}function o1({config:t}){return t.emulator?ud(t,r1):`https://${t.authDomain}/${t1}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zl="webStorageSupport";class i1{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=lp,this._completeRedirectFn=fp,this._overrideRedirectResult=$_}async _openPopup(e,r,n,o){Qn(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await ih(e,r,n,Ac(),o);return Z_(e,s,fd())}async _openRedirect(e,r,n,o){await this._originValidation(e);const s=await ih(e,r,n,Ac(),o);return a_(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:o,promise:s}=this.eventManagers[r];return o?Promise.resolve(o):(Qn(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await W_(e),n=new k_(e);return r.register("authEvent",o=>(St(o?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(zl,{type:zl},o=>{const s=o?.[0]?.[zl];s!==void 0&&r(!!s),On(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=M_(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return Zy()||Wy()||yd()}}const s1=i1;var sh="@firebase/auth",ah="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a1{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){St(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l1(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function c1(t){bi(new Ho("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:l}=n.options;St(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const u={apiKey:a,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ep(t)},h=new F0(n,o,s,u);return q0(h,r),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),bi(new Ho("auth-internal",e=>{const r=Qo(e.getProvider("auth").getImmediate());return(n=>new a1(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),po(sh,ah,l1(t)),po(sh,ah,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d1=5*60,u1=Ey("authIdTokenMaxAge")||d1;let lh=null;const h1=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>u1)return;const o=r?.token;lh!==o&&(lh=o,await fetch(t,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function m1(t=Ly()){const e=ld(t,"auth");if(e.isInitialized())return e.getImmediate();const r=j0(t,{popupRedirectResolver:s1,persistence:[f_,o_,lp]}),n=Ey("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=h1(s.toString());Z0(r,a,()=>a(r.currentUser)),X0(r,l=>a(l))}}const o=Ay("auth");return o&&G0(r,`http://${o}`),r}function y1(){return document.getElementsByTagName("head")?.[0]??document}V0({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=o=>{const s=Pn("internal-error");s.customData=o,r(s)},n.type="text/javascript",n.charset="UTF-8",y1().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});c1("Browser");var p1="firebase",f1="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */po(p1,f1,"app");var ch=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var go,vp;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(f,g){function S(){}S.prototype=g.prototype,f.D=g.prototype,f.prototype=new S,f.prototype.constructor=f,f.C=function($,w,I){for(var y=Array(arguments.length-2),de=2;de<arguments.length;de++)y[de-2]=arguments[de];return g.prototype[w].apply($,y)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(f,g,S){S||(S=0);var $=Array(16);if(typeof g=="string")for(var w=0;16>w;++w)$[w]=g.charCodeAt(S++)|g.charCodeAt(S++)<<8|g.charCodeAt(S++)<<16|g.charCodeAt(S++)<<24;else for(w=0;16>w;++w)$[w]=g[S++]|g[S++]<<8|g[S++]<<16|g[S++]<<24;g=f.g[0],S=f.g[1],w=f.g[2];var I=f.g[3],y=g+(I^S&(w^I))+$[0]+3614090360&4294967295;g=S+(y<<7&4294967295|y>>>25),y=I+(w^g&(S^w))+$[1]+3905402710&4294967295,I=g+(y<<12&4294967295|y>>>20),y=w+(S^I&(g^S))+$[2]+606105819&4294967295,w=I+(y<<17&4294967295|y>>>15),y=S+(g^w&(I^g))+$[3]+3250441966&4294967295,S=w+(y<<22&4294967295|y>>>10),y=g+(I^S&(w^I))+$[4]+4118548399&4294967295,g=S+(y<<7&4294967295|y>>>25),y=I+(w^g&(S^w))+$[5]+1200080426&4294967295,I=g+(y<<12&4294967295|y>>>20),y=w+(S^I&(g^S))+$[6]+2821735955&4294967295,w=I+(y<<17&4294967295|y>>>15),y=S+(g^w&(I^g))+$[7]+4249261313&4294967295,S=w+(y<<22&4294967295|y>>>10),y=g+(I^S&(w^I))+$[8]+1770035416&4294967295,g=S+(y<<7&4294967295|y>>>25),y=I+(w^g&(S^w))+$[9]+2336552879&4294967295,I=g+(y<<12&4294967295|y>>>20),y=w+(S^I&(g^S))+$[10]+4294925233&4294967295,w=I+(y<<17&4294967295|y>>>15),y=S+(g^w&(I^g))+$[11]+2304563134&4294967295,S=w+(y<<22&4294967295|y>>>10),y=g+(I^S&(w^I))+$[12]+1804603682&4294967295,g=S+(y<<7&4294967295|y>>>25),y=I+(w^g&(S^w))+$[13]+4254626195&4294967295,I=g+(y<<12&4294967295|y>>>20),y=w+(S^I&(g^S))+$[14]+2792965006&4294967295,w=I+(y<<17&4294967295|y>>>15),y=S+(g^w&(I^g))+$[15]+1236535329&4294967295,S=w+(y<<22&4294967295|y>>>10),y=g+(w^I&(S^w))+$[1]+4129170786&4294967295,g=S+(y<<5&4294967295|y>>>27),y=I+(S^w&(g^S))+$[6]+3225465664&4294967295,I=g+(y<<9&4294967295|y>>>23),y=w+(g^S&(I^g))+$[11]+643717713&4294967295,w=I+(y<<14&4294967295|y>>>18),y=S+(I^g&(w^I))+$[0]+3921069994&4294967295,S=w+(y<<20&4294967295|y>>>12),y=g+(w^I&(S^w))+$[5]+3593408605&4294967295,g=S+(y<<5&4294967295|y>>>27),y=I+(S^w&(g^S))+$[10]+38016083&4294967295,I=g+(y<<9&4294967295|y>>>23),y=w+(g^S&(I^g))+$[15]+3634488961&4294967295,w=I+(y<<14&4294967295|y>>>18),y=S+(I^g&(w^I))+$[4]+3889429448&4294967295,S=w+(y<<20&4294967295|y>>>12),y=g+(w^I&(S^w))+$[9]+568446438&4294967295,g=S+(y<<5&4294967295|y>>>27),y=I+(S^w&(g^S))+$[14]+3275163606&4294967295,I=g+(y<<9&4294967295|y>>>23),y=w+(g^S&(I^g))+$[3]+4107603335&4294967295,w=I+(y<<14&4294967295|y>>>18),y=S+(I^g&(w^I))+$[8]+1163531501&4294967295,S=w+(y<<20&4294967295|y>>>12),y=g+(w^I&(S^w))+$[13]+2850285829&4294967295,g=S+(y<<5&4294967295|y>>>27),y=I+(S^w&(g^S))+$[2]+4243563512&4294967295,I=g+(y<<9&4294967295|y>>>23),y=w+(g^S&(I^g))+$[7]+1735328473&4294967295,w=I+(y<<14&4294967295|y>>>18),y=S+(I^g&(w^I))+$[12]+2368359562&4294967295,S=w+(y<<20&4294967295|y>>>12),y=g+(S^w^I)+$[5]+4294588738&4294967295,g=S+(y<<4&4294967295|y>>>28),y=I+(g^S^w)+$[8]+2272392833&4294967295,I=g+(y<<11&4294967295|y>>>21),y=w+(I^g^S)+$[11]+1839030562&4294967295,w=I+(y<<16&4294967295|y>>>16),y=S+(w^I^g)+$[14]+4259657740&4294967295,S=w+(y<<23&4294967295|y>>>9),y=g+(S^w^I)+$[1]+2763975236&4294967295,g=S+(y<<4&4294967295|y>>>28),y=I+(g^S^w)+$[4]+1272893353&4294967295,I=g+(y<<11&4294967295|y>>>21),y=w+(I^g^S)+$[7]+4139469664&4294967295,w=I+(y<<16&4294967295|y>>>16),y=S+(w^I^g)+$[10]+3200236656&4294967295,S=w+(y<<23&4294967295|y>>>9),y=g+(S^w^I)+$[13]+681279174&4294967295,g=S+(y<<4&4294967295|y>>>28),y=I+(g^S^w)+$[0]+3936430074&4294967295,I=g+(y<<11&4294967295|y>>>21),y=w+(I^g^S)+$[3]+3572445317&4294967295,w=I+(y<<16&4294967295|y>>>16),y=S+(w^I^g)+$[6]+76029189&4294967295,S=w+(y<<23&4294967295|y>>>9),y=g+(S^w^I)+$[9]+3654602809&4294967295,g=S+(y<<4&4294967295|y>>>28),y=I+(g^S^w)+$[12]+3873151461&4294967295,I=g+(y<<11&4294967295|y>>>21),y=w+(I^g^S)+$[15]+530742520&4294967295,w=I+(y<<16&4294967295|y>>>16),y=S+(w^I^g)+$[2]+3299628645&4294967295,S=w+(y<<23&4294967295|y>>>9),y=g+(w^(S|~I))+$[0]+4096336452&4294967295,g=S+(y<<6&4294967295|y>>>26),y=I+(S^(g|~w))+$[7]+1126891415&4294967295,I=g+(y<<10&4294967295|y>>>22),y=w+(g^(I|~S))+$[14]+2878612391&4294967295,w=I+(y<<15&4294967295|y>>>17),y=S+(I^(w|~g))+$[5]+4237533241&4294967295,S=w+(y<<21&4294967295|y>>>11),y=g+(w^(S|~I))+$[12]+1700485571&4294967295,g=S+(y<<6&4294967295|y>>>26),y=I+(S^(g|~w))+$[3]+2399980690&4294967295,I=g+(y<<10&4294967295|y>>>22),y=w+(g^(I|~S))+$[10]+4293915773&4294967295,w=I+(y<<15&4294967295|y>>>17),y=S+(I^(w|~g))+$[1]+2240044497&4294967295,S=w+(y<<21&4294967295|y>>>11),y=g+(w^(S|~I))+$[8]+1873313359&4294967295,g=S+(y<<6&4294967295|y>>>26),y=I+(S^(g|~w))+$[15]+4264355552&4294967295,I=g+(y<<10&4294967295|y>>>22),y=w+(g^(I|~S))+$[6]+2734768916&4294967295,w=I+(y<<15&4294967295|y>>>17),y=S+(I^(w|~g))+$[13]+1309151649&4294967295,S=w+(y<<21&4294967295|y>>>11),y=g+(w^(S|~I))+$[4]+4149444226&4294967295,g=S+(y<<6&4294967295|y>>>26),y=I+(S^(g|~w))+$[11]+3174756917&4294967295,I=g+(y<<10&4294967295|y>>>22),y=w+(g^(I|~S))+$[2]+718787259&4294967295,w=I+(y<<15&4294967295|y>>>17),y=S+(I^(w|~g))+$[9]+3951481745&4294967295,f.g[0]=f.g[0]+g&4294967295,f.g[1]=f.g[1]+(w+(y<<21&4294967295|y>>>11))&4294967295,f.g[2]=f.g[2]+w&4294967295,f.g[3]=f.g[3]+I&4294967295}n.prototype.u=function(f,g){g===void 0&&(g=f.length);for(var S=g-this.blockSize,$=this.B,w=this.h,I=0;I<g;){if(w==0)for(;I<=S;)o(this,f,I),I+=this.blockSize;if(typeof f=="string"){for(;I<g;)if($[w++]=f.charCodeAt(I++),w==this.blockSize){o(this,$),w=0;break}}else for(;I<g;)if($[w++]=f[I++],w==this.blockSize){o(this,$),w=0;break}}this.h=w,this.o+=g},n.prototype.v=function(){var f=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);f[0]=128;for(var g=1;g<f.length-8;++g)f[g]=0;var S=8*this.o;for(g=f.length-8;g<f.length;++g)f[g]=S&255,S/=256;for(this.u(f),f=Array(16),g=S=0;4>g;++g)for(var $=0;32>$;$+=8)f[S++]=this.g[g]>>>$&255;return f};function s(f,g){var S=l;return Object.prototype.hasOwnProperty.call(S,f)?S[f]:S[f]=g(f)}function a(f,g){this.h=g;for(var S=[],$=!0,w=f.length-1;0<=w;w--){var I=f[w]|0;$&&I==g||(S[w]=I,$=!1)}this.g=S}var l={};function u(f){return-128<=f&&128>f?s(f,function(g){return new a([g|0],0>g?-1:0)}):new a([f|0],0>f?-1:0)}function h(f){if(isNaN(f)||!isFinite(f))return v;if(0>f)return P(h(-f));for(var g=[],S=1,$=0;f>=S;$++)g[$]=f/S|0,S*=4294967296;return new a(g,0)}function m(f,g){if(f.length==0)throw Error("number format error: empty string");if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(f.charAt(0)=="-")return P(m(f.substring(1),g));if(0<=f.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=h(Math.pow(g,8)),$=v,w=0;w<f.length;w+=8){var I=Math.min(8,f.length-w),y=parseInt(f.substring(w,w+I),g);8>I?(I=h(Math.pow(g,I)),$=$.j(I).add(h(y))):($=$.j(S),$=$.add(h(y)))}return $}var v=u(0),_=u(1),x=u(16777216);t=a.prototype,t.m=function(){if(E(this))return-P(this).m();for(var f=0,g=1,S=0;S<this.g.length;S++){var $=this.i(S);f+=(0<=$?$:4294967296+$)*g,g*=4294967296}return f},t.toString=function(f){if(f=f||10,2>f||36<f)throw Error("radix out of range: "+f);if(T(this))return"0";if(E(this))return"-"+P(this).toString(f);for(var g=h(Math.pow(f,6)),S=this,$="";;){var w=j(S,g).g;S=R(S,w.j(g));var I=((0<S.g.length?S.g[0]:S.h)>>>0).toString(f);if(S=w,T(S))return I+$;for(;6>I.length;)I="0"+I;$=I+$}},t.i=function(f){return 0>f?0:f<this.g.length?this.g[f]:this.h};function T(f){if(f.h!=0)return!1;for(var g=0;g<f.g.length;g++)if(f.g[g]!=0)return!1;return!0}function E(f){return f.h==-1}t.l=function(f){return f=R(this,f),E(f)?-1:T(f)?0:1};function P(f){for(var g=f.g.length,S=[],$=0;$<g;$++)S[$]=~f.g[$];return new a(S,~f.h).add(_)}t.abs=function(){return E(this)?P(this):this},t.add=function(f){for(var g=Math.max(this.g.length,f.g.length),S=[],$=0,w=0;w<=g;w++){var I=$+(this.i(w)&65535)+(f.i(w)&65535),y=(I>>>16)+(this.i(w)>>>16)+(f.i(w)>>>16);$=y>>>16,I&=65535,y&=65535,S[w]=y<<16|I}return new a(S,S[S.length-1]&-2147483648?-1:0)};function R(f,g){return f.add(P(g))}t.j=function(f){if(T(this)||T(f))return v;if(E(this))return E(f)?P(this).j(P(f)):P(P(this).j(f));if(E(f))return P(this.j(P(f)));if(0>this.l(x)&&0>f.l(x))return h(this.m()*f.m());for(var g=this.g.length+f.g.length,S=[],$=0;$<2*g;$++)S[$]=0;for($=0;$<this.g.length;$++)for(var w=0;w<f.g.length;w++){var I=this.i($)>>>16,y=this.i($)&65535,de=f.i(w)>>>16,J=f.i(w)&65535;S[2*$+2*w]+=y*J,Y(S,2*$+2*w),S[2*$+2*w+1]+=I*J,Y(S,2*$+2*w+1),S[2*$+2*w+1]+=y*de,Y(S,2*$+2*w+1),S[2*$+2*w+2]+=I*de,Y(S,2*$+2*w+2)}for($=0;$<g;$++)S[$]=S[2*$+1]<<16|S[2*$];for($=g;$<2*g;$++)S[$]=0;return new a(S,0)};function Y(f,g){for(;(f[g]&65535)!=f[g];)f[g+1]+=f[g]>>>16,f[g]&=65535,g++}function Z(f,g){this.g=f,this.h=g}function j(f,g){if(T(g))throw Error("division by zero");if(T(f))return new Z(v,v);if(E(f))return g=j(P(f),g),new Z(P(g.g),P(g.h));if(E(g))return g=j(f,P(g)),new Z(P(g.g),g.h);if(30<f.g.length){if(E(f)||E(g))throw Error("slowDivide_ only works with positive integers.");for(var S=_,$=g;0>=$.l(f);)S=B(S),$=B($);var w=V(S,1),I=V($,1);for($=V($,2),S=V(S,2);!T($);){var y=I.add($);0>=y.l(f)&&(w=w.add(S),I=y),$=V($,1),S=V(S,1)}return g=R(f,w.j(g)),new Z(w,g)}for(w=v;0<=f.l(g);){for(S=Math.max(1,Math.floor(f.m()/g.m())),$=Math.ceil(Math.log(S)/Math.LN2),$=48>=$?1:Math.pow(2,$-48),I=h(S),y=I.j(g);E(y)||0<y.l(f);)S-=$,I=h(S),y=I.j(g);T(I)&&(I=_),w=w.add(I),f=R(f,y)}return new Z(w,f)}t.A=function(f){return j(this,f).h},t.and=function(f){for(var g=Math.max(this.g.length,f.g.length),S=[],$=0;$<g;$++)S[$]=this.i($)&f.i($);return new a(S,this.h&f.h)},t.or=function(f){for(var g=Math.max(this.g.length,f.g.length),S=[],$=0;$<g;$++)S[$]=this.i($)|f.i($);return new a(S,this.h|f.h)},t.xor=function(f){for(var g=Math.max(this.g.length,f.g.length),S=[],$=0;$<g;$++)S[$]=this.i($)^f.i($);return new a(S,this.h^f.h)};function B(f){for(var g=f.g.length+1,S=[],$=0;$<g;$++)S[$]=f.i($)<<1|f.i($-1)>>>31;return new a(S,f.h)}function V(f,g){var S=g>>5;g%=32;for(var $=f.g.length-S,w=[],I=0;I<$;I++)w[I]=0<g?f.i(I+S)>>>g|f.i(I+S+1)<<32-g:f.i(I+S);return new a(w,f.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,vp=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=m,go=a}).apply(typeof ch<"u"?ch:typeof self<"u"?self:typeof window<"u"?window:{});var Qs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var bp,Ki,_p,va,Tc,Sp,Pp,wp;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,p,k){return c==Array.prototype||c==Object.prototype||(c[p]=k.value),c};function r(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Qs=="object"&&Qs];for(var p=0;p<c.length;++p){var k=c[p];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var n=r(this);function o(c,p){if(p)e:{var k=n;c=c.split(".");for(var se=0;se<c.length-1;se++){var xe=c[se];if(!(xe in k))break e;k=k[xe]}c=c[c.length-1],se=k[c],p=p(se),p!=se&&p!=null&&e(k,c,{configurable:!0,writable:!0,value:p})}}function s(c,p){c instanceof String&&(c+="");var k=0,se=!1,xe={next:function(){if(!se&&k<c.length){var Ee=k++;return{value:p(Ee,c[Ee]),done:!1}}return se=!0,{done:!0,value:void 0}}};return xe[Symbol.iterator]=function(){return xe},xe}o("Array.prototype.values",function(c){return c||function(){return s(this,function(p,k){return k})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function u(c){var p=typeof c;return p=p!="object"?p:c?Array.isArray(c)?"array":p:"null",p=="array"||p=="object"&&typeof c.length=="number"}function h(c){var p=typeof c;return p=="object"&&c!=null||p=="function"}function m(c,p,k){return c.call.apply(c.bind,arguments)}function v(c,p,k){if(!c)throw Error();if(2<arguments.length){var se=Array.prototype.slice.call(arguments,2);return function(){var xe=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(xe,se),c.apply(p,xe)}}return function(){return c.apply(p,arguments)}}function _(c,p,k){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:v,_.apply(null,arguments)}function x(c,p){var k=Array.prototype.slice.call(arguments,1);return function(){var se=k.slice();return se.push.apply(se,arguments),c.apply(this,se)}}function T(c,p){function k(){}k.prototype=p.prototype,c.aa=p.prototype,c.prototype=new k,c.prototype.constructor=c,c.Qb=function(se,xe,Ee){for(var Je=Array(arguments.length-2),or=2;or<arguments.length;or++)Je[or-2]=arguments[or];return p.prototype[xe].apply(se,Je)}}function E(c){const p=c.length;if(0<p){const k=Array(p);for(let se=0;se<p;se++)k[se]=c[se];return k}return[]}function P(c,p){for(let k=1;k<arguments.length;k++){const se=arguments[k];if(u(se)){const xe=c.length||0,Ee=se.length||0;c.length=xe+Ee;for(let Je=0;Je<Ee;Je++)c[xe+Je]=se[Je]}else c.push(se)}}class R{constructor(p,k){this.i=p,this.j=k,this.h=0,this.g=null}get(){let p;return 0<this.h?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function Y(c){return/^[\s\xa0]*$/.test(c)}function Z(){var c=l.navigator;return c&&(c=c.userAgent)?c:""}function j(c){return j[" "](c),c}j[" "]=function(){};var B=Z().indexOf("Gecko")!=-1&&!(Z().toLowerCase().indexOf("webkit")!=-1&&Z().indexOf("Edge")==-1)&&!(Z().indexOf("Trident")!=-1||Z().indexOf("MSIE")!=-1)&&Z().indexOf("Edge")==-1;function V(c,p,k){for(const se in c)p.call(k,c[se],se,c)}function f(c,p){for(const k in c)p.call(void 0,c[k],k,c)}function g(c){const p={};for(const k in c)p[k]=c[k];return p}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $(c,p){let k,se;for(let xe=1;xe<arguments.length;xe++){se=arguments[xe];for(k in se)c[k]=se[k];for(let Ee=0;Ee<S.length;Ee++)k=S[Ee],Object.prototype.hasOwnProperty.call(se,k)&&(c[k]=se[k])}}function w(c){var p=1;c=c.split(":");const k=[];for(;0<p&&c.length;)k.push(c.shift()),p--;return c.length&&k.push(c.join(":")),k}function I(c){l.setTimeout(()=>{throw c},0)}function y(){var c=D;let p=null;return c.g&&(p=c.g,c.g=c.g.next,c.g||(c.h=null),p.next=null),p}class de{constructor(){this.h=this.g=null}add(p,k){const se=J.get();se.set(p,k),this.h?this.h.next=se:this.g=se,this.h=se}}var J=new R(()=>new O,c=>c.reset());class O{constructor(){this.next=this.g=this.h=null}set(p,k){this.h=p,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let N,q=!1,D=new de,C=()=>{const c=l.Promise.resolve(void 0);N=()=>{c.then(F)}};var F=()=>{for(var c;c=y();){try{c.h.call(c.g)}catch(k){I(k)}var p=J;p.j(c),100>p.h&&(p.h++,c.next=p.g,p.g=c)}q=!1};function ee(){this.s=this.s,this.C=this.C}ee.prototype.s=!1,ee.prototype.ma=function(){this.s||(this.s=!0,this.N())},ee.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function H(c,p){this.type=c,this.g=this.target=p,this.defaultPrevented=!1}H.prototype.h=function(){this.defaultPrevented=!0};var oe=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var c=!1,p=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const k=()=>{};l.addEventListener("test",k,p),l.removeEventListener("test",k,p)}catch{}return c}();function M(c,p){if(H.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var k=this.type=c.type,se=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=p,p=c.relatedTarget){if(B){e:{try{j(p.nodeName);var xe=!0;break e}catch{}xe=!1}xe||(p=null)}}else k=="mouseover"?p=c.fromElement:k=="mouseout"&&(p=c.toElement);this.relatedTarget=p,se?(this.clientX=se.clientX!==void 0?se.clientX:se.pageX,this.clientY=se.clientY!==void 0?se.clientY:se.pageY,this.screenX=se.screenX||0,this.screenY=se.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:G[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&M.aa.h.call(this)}}T(M,H);var G={2:"touch",3:"pen",4:"mouse"};M.prototype.h=function(){M.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var le="closure_listenable_"+(1e6*Math.random()|0),ne=0;function ue(c,p,k,se,xe){this.listener=c,this.proxy=null,this.src=p,this.type=k,this.capture=!!se,this.ha=xe,this.key=++ne,this.da=this.fa=!1}function L(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function A(c){this.src=c,this.g={},this.h=0}A.prototype.add=function(c,p,k,se,xe){var Ee=c.toString();c=this.g[Ee],c||(c=this.g[Ee]=[],this.h++);var Je=te(c,p,se,xe);return-1<Je?(p=c[Je],k||(p.fa=!1)):(p=new ue(p,this.src,Ee,!!se,xe),p.fa=k,c.push(p)),p};function U(c,p){var k=p.type;if(k in c.g){var se=c.g[k],xe=Array.prototype.indexOf.call(se,p,void 0),Ee;(Ee=0<=xe)&&Array.prototype.splice.call(se,xe,1),Ee&&(L(p),c.g[k].length==0&&(delete c.g[k],c.h--))}}function te(c,p,k,se){for(var xe=0;xe<c.length;++xe){var Ee=c[xe];if(!Ee.da&&Ee.listener==p&&Ee.capture==!!k&&Ee.ha==se)return xe}return-1}var ae="closure_lm_"+(1e6*Math.random()|0),re={};function ce(c,p,k,se,xe){if(Array.isArray(p)){for(var Ee=0;Ee<p.length;Ee++)ce(c,p[Ee],k,se,xe);return null}return k=_e(k),c&&c[le]?c.K(p,k,h(se)?!!se.capture:!1,xe):Q(c,p,k,!1,se,xe)}function Q(c,p,k,se,xe,Ee){if(!p)throw Error("Invalid event type");var Je=h(xe)?!!xe.capture:!!xe,or=ie(c);if(or||(c[ae]=or=new A(c)),k=or.add(p,k,se,Je,Ee),k.proxy)return k;if(se=me(),k.proxy=se,se.src=c,se.listener=k,c.addEventListener)oe||(xe=Je),xe===void 0&&(xe=!1),c.addEventListener(p.toString(),se,xe);else if(c.attachEvent)c.attachEvent(ve(p.toString()),se);else if(c.addListener&&c.removeListener)c.addListener(se);else throw Error("addEventListener and attachEvent are unavailable.");return k}function me(){function c(k){return p.call(c.src,c.listener,k)}const p=W;return c}function K(c,p,k,se,xe){if(Array.isArray(p))for(var Ee=0;Ee<p.length;Ee++)K(c,p[Ee],k,se,xe);else se=h(se)?!!se.capture:!!se,k=_e(k),c&&c[le]?(c=c.i,p=String(p).toString(),p in c.g&&(Ee=c.g[p],k=te(Ee,k,se,xe),-1<k&&(L(Ee[k]),Array.prototype.splice.call(Ee,k,1),Ee.length==0&&(delete c.g[p],c.h--)))):c&&(c=ie(c))&&(p=c.g[p.toString()],c=-1,p&&(c=te(p,k,se,xe)),(k=-1<c?p[c]:null)&&he(k))}function he(c){if(typeof c!="number"&&c&&!c.da){var p=c.src;if(p&&p[le])U(p.i,c);else{var k=c.type,se=c.proxy;p.removeEventListener?p.removeEventListener(k,se,c.capture):p.detachEvent?p.detachEvent(ve(k),se):p.addListener&&p.removeListener&&p.removeListener(se),(k=ie(p))?(U(k,c),k.h==0&&(k.src=null,p[ae]=null)):L(c)}}}function ve(c){return c in re?re[c]:re[c]="on"+c}function W(c,p){if(c.da)c=!0;else{p=new M(p,this);var k=c.listener,se=c.ha||c.src;c.fa&&he(c),c=k.call(se,p)}return c}function ie(c){return c=c[ae],c instanceof A?c:null}var Pe="__closure_events_fn_"+(1e9*Math.random()>>>0);function _e(c){return typeof c=="function"?c:(c[Pe]||(c[Pe]=function(p){return c.handleEvent(p)}),c[Pe])}function fe(){ee.call(this),this.i=new A(this),this.M=this,this.F=null}T(fe,ee),fe.prototype[le]=!0,fe.prototype.removeEventListener=function(c,p,k,se){K(this,c,p,k,se)};function be(c,p){var k,se=c.F;if(se)for(k=[];se;se=se.F)k.push(se);if(c=c.M,se=p.type||p,typeof p=="string")p=new H(p,c);else if(p instanceof H)p.target=p.target||c;else{var xe=p;p=new H(se,c),$(p,xe)}if(xe=!0,k)for(var Ee=k.length-1;0<=Ee;Ee--){var Je=p.g=k[Ee];xe=pe(Je,se,!0,p)&&xe}if(Je=p.g=c,xe=pe(Je,se,!0,p)&&xe,xe=pe(Je,se,!1,p)&&xe,k)for(Ee=0;Ee<k.length;Ee++)Je=p.g=k[Ee],xe=pe(Je,se,!1,p)&&xe}fe.prototype.N=function(){if(fe.aa.N.call(this),this.i){var c=this.i,p;for(p in c.g){for(var k=c.g[p],se=0;se<k.length;se++)L(k[se]);delete c.g[p],c.h--}}this.F=null},fe.prototype.K=function(c,p,k,se){return this.i.add(String(c),p,!1,k,se)},fe.prototype.L=function(c,p,k,se){return this.i.add(String(c),p,!0,k,se)};function pe(c,p,k,se){if(p=c.i.g[String(p)],!p)return!0;p=p.concat();for(var xe=!0,Ee=0;Ee<p.length;++Ee){var Je=p[Ee];if(Je&&!Je.da&&Je.capture==k){var or=Je.listener,Er=Je.ha||Je.src;Je.fa&&U(c.i,Je),xe=or.call(Er,se)!==!1&&xe}}return xe&&!se.defaultPrevented}function we(c,p,k){if(typeof c=="function")k&&(c=_(c,k));else if(c&&typeof c.handleEvent=="function")c=_(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(p)?-1:l.setTimeout(c,p||0)}function De(c){c.g=we(()=>{c.g=null,c.i&&(c.i=!1,De(c))},c.l);const p=c.h;c.h=null,c.m.apply(null,p)}class ke extends ee{constructor(p,k){super(),this.m=p,this.l=k,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:De(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Te(c){ee.call(this),this.h=c,this.g={}}T(Te,ee);var Ue=[];function Xe(c){V(c.g,function(p,k){this.g.hasOwnProperty(k)&&he(p)},c),c.g={}}Te.prototype.N=function(){Te.aa.N.call(this),Xe(this)},Te.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ze=l.JSON.stringify,$e=l.JSON.parse,Ge=class{stringify(c){return l.JSON.stringify(c,void 0)}parse(c){return l.JSON.parse(c,void 0)}};function ot(){}ot.prototype.h=null;function je(c){return c.h||(c.h=c.i())}function Ce(){}var Se={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ke(){H.call(this,"d")}T(Ke,H);function He(){H.call(this,"c")}T(He,H);var Oe={},Ye=null;function pt(){return Ye=Ye||new fe}Oe.La="serverreachability";function vt(c){H.call(this,Oe.La,c)}T(vt,H);function mt(c){const p=pt();be(p,new vt(p))}Oe.STAT_EVENT="statevent";function yt(c,p){H.call(this,Oe.STAT_EVENT,c),this.stat=p}T(yt,H);function Qe(c){const p=pt();be(p,new yt(p,c))}Oe.Ma="timingevent";function Ct(c,p){H.call(this,Oe.Ma,c),this.size=p}T(Ct,H);function _t(c,p){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){c()},p)}function jt(){this.g=!0}jt.prototype.xa=function(){this.g=!1};function Mt(c,p,k,se,xe,Ee){c.info(function(){if(c.g)if(Ee)for(var Je="",or=Ee.split("&"),Er=0;Er<or.length;Er++){var Kt=or[Er].split("=");if(1<Kt.length){var Or=Kt[0];Kt=Kt[1];var Fr=Or.split("_");Je=2<=Fr.length&&Fr[1]=="type"?Je+(Or+"="+Kt+"&"):Je+(Or+"=redacted&")}}else Je=null;else Je=Ee;return"XMLHTTP REQ ("+se+") [attempt "+xe+"]: "+p+`
`+k+`
`+Je})}function Be(c,p,k,se,xe,Ee,Je){c.info(function(){return"XMLHTTP RESP ("+se+") [ attempt "+xe+"]: "+p+`
`+k+`
`+Ee+" "+Je})}function We(c,p,k,se){c.info(function(){return"XMLHTTP TEXT ("+p+"): "+lt(c,k)+(se?" "+se:"")})}function at(c,p){c.info(function(){return"TIMEOUT: "+p})}jt.prototype.info=function(){};function lt(c,p){if(!c.g)return p;if(!p)return null;try{var k=JSON.parse(p);if(k){for(c=0;c<k.length;c++)if(Array.isArray(k[c])){var se=k[c];if(!(2>se.length)){var xe=se[1];if(Array.isArray(xe)&&!(1>xe.length)){var Ee=xe[0];if(Ee!="noop"&&Ee!="stop"&&Ee!="close")for(var Je=1;Je<xe.length;Je++)xe[Je]=""}}}}return ze(k)}catch{return p}}var Tt={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ie={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ve;function st(){}T(st,ot),st.prototype.g=function(){return new XMLHttpRequest},st.prototype.i=function(){return{}},Ve=new st;function dt(c,p,k,se){this.j=c,this.i=p,this.l=k,this.R=se||1,this.U=new Te(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Gt}function Gt(){this.i=null,this.g="",this.h=!1}var Wt={},At={};function kt(c,p,k){c.L=1,c.v=ln(bt(p)),c.m=k,c.P=!0,rr(c,null)}function rr(c,p){c.F=Date.now(),et(c),c.A=bt(c.v);var k=c.A,se=c.R;Array.isArray(se)||(se=[String(se)]),Vs(k.i,"t",se),c.C=0,k=c.j.J,c.h=new Gt,c.g=Su(c.j,k?p:null,!c.m),0<c.O&&(c.M=new ke(_(c.Y,c,c.g),c.O)),p=c.U,k=c.g,se=c.ca;var xe="readystatechange";Array.isArray(xe)||(xe&&(Ue[0]=xe.toString()),xe=Ue);for(var Ee=0;Ee<xe.length;Ee++){var Je=ce(k,xe[Ee],se||p.handleEvent,!1,p.h||p);if(!Je)break;p.g[Je.key]=Je}p=c.H?g(c.H):{},c.m?(c.u||(c.u="POST"),p["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,p)):(c.u="GET",c.g.ea(c.A,c.u,null,p)),mt(),Mt(c.i,c.u,c.A,c.l,c.R,c.m)}dt.prototype.ca=function(c){c=c.target;const p=this.M;p&&Bn(c)==3?p.j():this.Y(c)},dt.prototype.Y=function(c){try{if(c==this.g)e:{const Fr=Bn(this.g);var p=this.g.Ba();const ri=this.g.Z();if(!(3>Fr)&&(Fr!=3||this.g&&(this.h.h||this.g.oa()||du(this.g)))){this.J||Fr!=4||p==7||(p==8||0>=ri?mt(3):mt(2)),Ot(this);var k=this.g.Z();this.X=k;t:if(Et(this)){var se=du(this.g);c="";var xe=se.length,Ee=Bn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ht(this),Vt(this);var Je="";break t}this.h.i=new l.TextDecoder}for(p=0;p<xe;p++)this.h.h=!0,c+=this.h.i.decode(se[p],{stream:!(Ee&&p==xe-1)});se.length=0,this.h.g+=c,this.C=0,Je=this.h.g}else Je=this.g.oa();if(this.o=k==200,Be(this.i,this.u,this.A,this.l,this.R,Fr,k),this.o){if(this.T&&!this.K){t:{if(this.g){var or,Er=this.g;if((or=Er.g?Er.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Y(or)){var Kt=or;break t}}Kt=null}if(k=Kt)We(this.i,this.l,k,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,nr(this,k);else{this.o=!1,this.s=3,Qe(12),Ht(this),Vt(this);break e}}if(this.P){k=!0;let vn;for(;!this.J&&this.C<Je.length;)if(vn=er(this,Je),vn==At){Fr==4&&(this.s=4,Qe(14),k=!1),We(this.i,this.l,null,"[Incomplete Response]");break}else if(vn==Wt){this.s=4,Qe(15),We(this.i,this.l,Je,"[Invalid Chunk]"),k=!1;break}else We(this.i,this.l,vn,null),nr(this,vn);if(Et(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Fr!=4||Je.length!=0||this.h.h||(this.s=1,Qe(16),k=!1),this.o=this.o&&k,!k)We(this.i,this.l,Je,"[Invalid Chunked Response]"),Ht(this),Vt(this);else if(0<Je.length&&!this.W){this.W=!0;var Or=this.j;Or.g==this&&Or.ba&&!Or.M&&(Or.j.info("Great, no buffering proxy detected. Bytes received: "+Je.length),Tl(Or),Or.M=!0,Qe(11))}}else We(this.i,this.l,Je,null),nr(this,Je);Fr==4&&Ht(this),this.o&&!this.J&&(Fr==4?gu(this.j,this):(this.o=!1,et(this)))}else dg(this.g),k==400&&0<Je.indexOf("Unknown SID")?(this.s=3,Qe(12)):(this.s=0,Qe(13)),Ht(this),Vt(this)}}}catch{}finally{}};function Et(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function er(c,p){var k=c.C,se=p.indexOf(`
`,k);return se==-1?At:(k=Number(p.substring(k,se)),isNaN(k)?Wt:(se+=1,se+k>p.length?At:(p=p.slice(se,se+k),c.C=se+k,p)))}dt.prototype.cancel=function(){this.J=!0,Ht(this)};function et(c){c.S=Date.now()+c.I,Rt(c,c.I)}function Rt(c,p){if(c.B!=null)throw Error("WatchDog timer not null");c.B=_t(_(c.ba,c),p)}function Ot(c){c.B&&(l.clearTimeout(c.B),c.B=null)}dt.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(at(this.i,this.A),this.L!=2&&(mt(),Qe(17)),Ht(this),this.s=2,Vt(this)):Rt(this,this.S-c)};function Vt(c){c.j.G==0||c.J||gu(c.j,c)}function Ht(c){Ot(c);var p=c.M;p&&typeof p.ma=="function"&&p.ma(),c.M=null,Xe(c.U),c.g&&(p=c.g,c.g=null,p.abort(),p.ma())}function nr(c,p){try{var k=c.j;if(k.G!=0&&(k.g==c||Ir(k.h,c))){if(!c.K&&Ir(k.h,c)&&k.G==3){try{var se=k.Da.g.parse(p)}catch{se=null}if(Array.isArray(se)&&se.length==3){var xe=se;if(xe[0]==0){e:if(!k.u){if(k.g)if(k.g.F+3e3<c.F)Gs(k),js(k);else break e;El(k),Qe(18)}}else k.za=xe[1],0<k.za-k.T&&37500>xe[2]&&k.F&&k.v==0&&!k.C&&(k.C=_t(_(k.Za,k),6e3));if(1>=Hr(k.h)&&k.ca){try{k.ca()}catch{}k.ca=void 0}}else ko(k,11)}else if((c.K||k.g==c)&&Gs(k),!Y(p))for(xe=k.Da.g.parse(p),p=0;p<xe.length;p++){let Kt=xe[p];if(k.T=Kt[0],Kt=Kt[1],k.G==2)if(Kt[0]=="c"){k.K=Kt[1],k.ia=Kt[2];const Or=Kt[3];Or!=null&&(k.la=Or,k.j.info("VER="+k.la));const Fr=Kt[4];Fr!=null&&(k.Aa=Fr,k.j.info("SVER="+k.Aa));const ri=Kt[5];ri!=null&&typeof ri=="number"&&0<ri&&(se=1.5*ri,k.L=se,k.j.info("backChannelRequestTimeoutMs_="+se)),se=k;const vn=c.g;if(vn){const Ws=vn.g?vn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ws){var Ee=se.h;Ee.g||Ws.indexOf("spdy")==-1&&Ws.indexOf("quic")==-1&&Ws.indexOf("h2")==-1||(Ee.j=Ee.l,Ee.g=new Set,Ee.h&&(Cr(Ee,Ee.h),Ee.h=null))}if(se.D){const kl=vn.g?vn.g.getResponseHeader("X-HTTP-Session-Id"):null;kl&&(se.ya=kl,Nt(se.I,se.D,kl))}}k.G=3,k.l&&k.l.ua(),k.ba&&(k.R=Date.now()-c.F,k.j.info("Handshake RTT: "+k.R+"ms")),se=k;var Je=c;if(se.qa=_u(se,se.J?se.ia:null,se.W),Je.K){Mr(se.h,Je);var or=Je,Er=se.L;Er&&(or.I=Er),or.B&&(Ot(or),et(or)),se.g=Je}else pu(se);0<k.i.length&&qs(k)}else Kt[0]!="stop"&&Kt[0]!="close"||ko(k,7);else k.G==3&&(Kt[0]=="stop"||Kt[0]=="close"?Kt[0]=="stop"?ko(k,7):Il(k):Kt[0]!="noop"&&k.l&&k.l.ta(Kt),k.v=0)}}mt(4)}catch{}}var cr=class{constructor(c,p){this.g=c,this.map=p}};function It(c){this.l=c||10,l.PerformanceNavigationTiming?(c=l.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function hr(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function Hr(c){return c.h?1:c.g?c.g.size:0}function Ir(c,p){return c.h?c.h==p:c.g?c.g.has(p):!1}function Cr(c,p){c.g?c.g.add(p):c.h=p}function Mr(c,p){c.h&&c.h==p?c.h=null:c.g&&c.g.has(p)&&c.g.delete(p)}It.prototype.cancel=function(){if(this.i=gn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function gn(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let p=c.i;for(const k of c.g.values())p=p.concat(k.D);return p}return E(c.i)}function to(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(u(c)){for(var p=[],k=c.length,se=0;se<k;se++)p.push(c[se]);return p}p=[],k=0;for(se in c)p[k++]=c[se];return p}function xt(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(u(c)||typeof c=="string"){var p=[];c=c.length;for(var k=0;k<c;k++)p.push(k);return p}p=[],k=0;for(const se in c)p[k++]=se;return p}}}function Ne(c,p){if(c.forEach&&typeof c.forEach=="function")c.forEach(p,void 0);else if(u(c)||typeof c=="string")Array.prototype.forEach.call(c,p,void 0);else for(var k=xt(c),se=to(c),xe=se.length,Ee=0;Ee<xe;Ee++)p.call(void 0,se[Ee],k&&k[Ee],c)}var Dt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ar(c,p){if(c){c=c.split("&");for(var k=0;k<c.length;k++){var se=c[k].indexOf("="),xe=null;if(0<=se){var Ee=c[k].substring(0,se);xe=c[k].substring(se+1)}else Ee=c[k];p(Ee,xe?decodeURIComponent(xe.replace(/\+/g," ")):"")}}}function Yt(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof Yt){this.h=c.h,dr(this,c.j),this.o=c.o,this.g=c.g,yr(this,c.s),this.l=c.l;var p=c.i,k=new To;k.i=p.i,p.g&&(k.g=new Map(p.g),k.h=p.h),Wr(this,k),this.m=c.m}else c&&(p=String(c).match(Dt))?(this.h=!1,dr(this,p[1]||"",!0),this.o=Yr(p[2]||""),this.g=Yr(p[3]||"",!0),yr(this,p[4]),this.l=Yr(p[5]||"",!0),Wr(this,p[6]||"",!0),this.m=Yr(p[7]||"")):(this.h=!1,this.i=new To(null,this.h))}Yt.prototype.toString=function(){var c=[],p=this.j;p&&c.push(Kr(p,cn,!0),":");var k=this.g;return(k||p=="file")&&(c.push("//"),(p=this.o)&&c.push(Kr(p,cn,!0),"@"),c.push(encodeURIComponent(String(k)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.s,k!=null&&c.push(":",String(k))),(k=this.l)&&(this.g&&k.charAt(0)!="/"&&c.push("/"),c.push(Kr(k,k.charAt(0)=="/"?Eo:xn,!0))),(k=this.i.toString())&&c.push("?",k),(k=this.m)&&c.push("#",Kr(k,Pl)),c.join("")};function bt(c){return new Yt(c)}function dr(c,p,k){c.j=k?Yr(p,!0):p,c.j&&(c.j=c.j.replace(/:$/,""))}function yr(c,p){if(p){if(p=Number(p),isNaN(p)||0>p)throw Error("Bad port number "+p);c.s=p}else c.s=null}function Wr(c,p,k){p instanceof To?(c.i=p,wl(c.i,c.h)):(k||(p=Kr(p,Sl)),c.i=new To(p,c.h))}function Nt(c,p,k){c.i.set(p,k)}function ln(c){return Nt(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function Yr(c,p){return c?p?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Kr(c,p,k){return typeof c=="string"?(c=encodeURI(c).replace(p,tn),k&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function tn(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var cn=/[#\/\?@]/g,xn=/[#\?:]/g,Eo=/[#\?]/g,Sl=/[#\?@]/g,Pl=/#/g;function To(c,p){this.h=this.g=null,this.i=c||null,this.j=!!p}function dn(c){c.g||(c.g=new Map,c.h=0,c.i&&ar(c.i,function(p,k){c.add(decodeURIComponent(p.replace(/\+/g," ")),k)}))}t=To.prototype,t.add=function(c,p){dn(this),this.i=null,c=ro(this,c);var k=this.g.get(c);return k||this.g.set(c,k=[]),k.push(p),this.h+=1,this};function ei(c,p){dn(c),p=ro(c,p),c.g.has(p)&&(c.i=null,c.h-=c.g.get(p).length,c.g.delete(p))}function Fs(c,p){return dn(c),p=ro(c,p),c.g.has(p)}t.forEach=function(c,p){dn(this),this.g.forEach(function(k,se){k.forEach(function(xe){c.call(p,xe,se,this)},this)},this)},t.na=function(){dn(this);const c=Array.from(this.g.values()),p=Array.from(this.g.keys()),k=[];for(let se=0;se<p.length;se++){const xe=c[se];for(let Ee=0;Ee<xe.length;Ee++)k.push(p[se])}return k},t.V=function(c){dn(this);let p=[];if(typeof c=="string")Fs(this,c)&&(p=p.concat(this.g.get(ro(this,c))));else{c=Array.from(this.g.values());for(let k=0;k<c.length;k++)p=p.concat(c[k])}return p},t.set=function(c,p){return dn(this),this.i=null,c=ro(this,c),Fs(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[p]),this.h+=1,this},t.get=function(c,p){return c?(c=this.V(c),0<c.length?String(c[0]):p):p};function Vs(c,p,k){ei(c,p),0<k.length&&(c.i=null,c.g.set(ro(c,p),E(k)),c.h+=k.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],p=Array.from(this.g.keys());for(var k=0;k<p.length;k++){var se=p[k];const Ee=encodeURIComponent(String(se)),Je=this.V(se);for(se=0;se<Je.length;se++){var xe=Ee;Je[se]!==""&&(xe+="="+encodeURIComponent(String(Je[se]))),c.push(xe)}}return this.i=c.join("&")};function ro(c,p){return p=String(p),c.j&&(p=p.toLowerCase()),p}function wl(c,p){p&&!c.j&&(dn(c),c.i=null,c.g.forEach(function(k,se){var xe=se.toLowerCase();se!=xe&&(ei(this,se),Vs(this,xe,k))},c)),c.j=p}function Cl(c,p){const k=new jt;if(l.Image){const se=new Image;se.onload=x($n,k,"TestLoadImage: loaded",!0,p,se),se.onerror=x($n,k,"TestLoadImage: error",!1,p,se),se.onabort=x($n,k,"TestLoadImage: abort",!1,p,se),se.ontimeout=x($n,k,"TestLoadImage: timeout",!1,p,se),l.setTimeout(function(){se.ontimeout&&se.ontimeout()},1e4),se.src=c}else p(!1)}function xl(c,p){const k=new jt,se=new AbortController,xe=setTimeout(()=>{se.abort(),$n(k,"TestPingServer: timeout",!1,p)},1e4);fetch(c,{signal:se.signal}).then(Ee=>{clearTimeout(xe),Ee.ok?$n(k,"TestPingServer: ok",!0,p):$n(k,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(xe),$n(k,"TestPingServer: error",!1,p)})}function $n(c,p,k,se,xe){try{xe&&(xe.onload=null,xe.onerror=null,xe.onabort=null,xe.ontimeout=null),se(k)}catch{}}function $l(){this.g=new Ge}function ag(c,p,k){const se=k||"";try{Ne(c,function(xe,Ee){let Je=xe;h(xe)&&(Je=ze(xe)),p.push(se+Ee+"="+encodeURIComponent(Je))})}catch(xe){throw p.push(se+"type="+encodeURIComponent("_badmap")),xe}}function Bs(c){this.l=c.Ub||null,this.j=c.eb||!1}T(Bs,ot),Bs.prototype.g=function(){return new Us(this.l,this.j)},Bs.prototype.i=function(c){return function(){return c}}({});function Us(c,p){fe.call(this),this.D=c,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}T(Us,fe),t=Us.prototype,t.open=function(c,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=p,this.readyState=1,Oi(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const p={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(p.body=c),(this.D||l).fetch(new Request(this.A,p)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Mi(this)),this.readyState=0},t.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Oi(this)),this.g&&(this.readyState=3,Oi(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ou(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function ou(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}t.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var p=c.value?c.value:new Uint8Array(0);(p=this.v.decode(p,{stream:!c.done}))&&(this.response=this.responseText+=p)}c.done?Mi(this):Oi(this),this.readyState==3&&ou(this)}},t.Ra=function(c){this.g&&(this.response=this.responseText=c,Mi(this))},t.Qa=function(c){this.g&&(this.response=c,Mi(this))},t.ga=function(){this.g&&Mi(this)};function Mi(c){c.readyState=4,c.l=null,c.j=null,c.v=null,Oi(c)}t.setRequestHeader=function(c,p){this.u.append(c,p)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],p=this.h.entries();for(var k=p.next();!k.done;)k=k.value,c.push(k[0]+": "+k[1]),k=p.next();return c.join(`\r
`)};function Oi(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Us.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function iu(c){let p="";return V(c,function(k,se){p+=se,p+=":",p+=k,p+=`\r
`}),p}function Al(c,p,k){e:{for(se in k){var se=!1;break e}se=!0}se||(k=iu(k),typeof c=="string"?k!=null&&encodeURIComponent(String(k)):Nt(c,p,k))}function mr(c){fe.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}T(mr,fe);var lg=/^https?$/i,cg=["POST","PUT"];t=mr.prototype,t.Ha=function(c){this.J=c},t.ea=function(c,p,k,se){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);p=p?p.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ve.g(),this.v=this.o?je(this.o):je(Ve),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(p,String(c),!0),this.B=!1}catch(Ee){su(this,Ee);return}if(c=k||"",k=new Map(this.headers),se)if(Object.getPrototypeOf(se)===Object.prototype)for(var xe in se)k.set(xe,se[xe]);else if(typeof se.keys=="function"&&typeof se.get=="function")for(const Ee of se.keys())k.set(Ee,se.get(Ee));else throw Error("Unknown input type for opt_headers: "+String(se));se=Array.from(k.keys()).find(Ee=>Ee.toLowerCase()=="content-type"),xe=l.FormData&&c instanceof l.FormData,!(0<=Array.prototype.indexOf.call(cg,p,void 0))||se||xe||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ee,Je]of k)this.g.setRequestHeader(Ee,Je);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{cu(this),this.u=!0,this.g.send(c),this.u=!1}catch(Ee){su(this,Ee)}};function su(c,p){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=p,c.m=5,au(c),zs(c)}function au(c){c.A||(c.A=!0,be(c,"complete"),be(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,be(this,"complete"),be(this,"abort"),zs(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),zs(this,!0)),mr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?lu(this):this.bb())},t.bb=function(){lu(this)};function lu(c){if(c.h&&typeof a<"u"&&(!c.v[1]||Bn(c)!=4||c.Z()!=2)){if(c.u&&Bn(c)==4)we(c.Ea,0,c);else if(be(c,"readystatechange"),Bn(c)==4){c.h=!1;try{const Je=c.Z();e:switch(Je){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var k;if(!(k=p)){var se;if(se=Je===0){var xe=String(c.D).match(Dt)[1]||null;!xe&&l.self&&l.self.location&&(xe=l.self.location.protocol.slice(0,-1)),se=!lg.test(xe?xe.toLowerCase():"")}k=se}if(k)be(c,"complete"),be(c,"success");else{c.m=6;try{var Ee=2<Bn(c)?c.g.statusText:""}catch{Ee=""}c.l=Ee+" ["+c.Z()+"]",au(c)}}finally{zs(c)}}}}function zs(c,p){if(c.g){cu(c);const k=c.g,se=c.v[0]?()=>{}:null;c.g=null,c.v=null,p||be(c,"ready");try{k.onreadystatechange=se}catch{}}}function cu(c){c.I&&(l.clearTimeout(c.I),c.I=null)}t.isActive=function(){return!!this.g};function Bn(c){return c.g?c.g.readyState:0}t.Z=function(){try{return 2<Bn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(c){if(this.g){var p=this.g.responseText;return c&&p.indexOf(c)==0&&(p=p.substring(c.length)),$e(p)}};function du(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function dg(c){const p={};c=(c.g&&2<=Bn(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let se=0;se<c.length;se++){if(Y(c[se]))continue;var k=w(c[se]);const xe=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const Ee=p[xe]||[];p[xe]=Ee,Ee.push(k)}f(p,function(se){return se.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Fi(c,p,k){return k&&k.internalChannelParams&&k.internalChannelParams[c]||p}function uu(c){this.Aa=0,this.i=[],this.j=new jt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Fi("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Fi("baseRetryDelayMs",5e3,c),this.cb=Fi("retryDelaySeedMs",1e4,c),this.Wa=Fi("forwardChannelMaxRetries",2,c),this.wa=Fi("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new It(c&&c.concurrentRequestLimit),this.Da=new $l,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=uu.prototype,t.la=8,t.G=1,t.connect=function(c,p,k,se){Qe(0),this.W=c,this.H=p||{},k&&se!==void 0&&(this.H.OSID=k,this.H.OAID=se),this.F=this.X,this.I=_u(this,null,this.W),qs(this)};function Il(c){if(hu(c),c.G==3){var p=c.U++,k=bt(c.I);if(Nt(k,"SID",c.K),Nt(k,"RID",p),Nt(k,"TYPE","terminate"),Vi(c,k),p=new dt(c,c.j,p),p.L=2,p.v=ln(bt(k)),k=!1,l.navigator&&l.navigator.sendBeacon)try{k=l.navigator.sendBeacon(p.v.toString(),"")}catch{}!k&&l.Image&&(new Image().src=p.v,k=!0),k||(p.g=Su(p.j,null),p.g.ea(p.v)),p.F=Date.now(),et(p)}bu(c)}function js(c){c.g&&(Tl(c),c.g.cancel(),c.g=null)}function hu(c){js(c),c.u&&(l.clearTimeout(c.u),c.u=null),Gs(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&l.clearTimeout(c.s),c.s=null)}function qs(c){if(!hr(c.h)&&!c.s){c.s=!0;var p=c.Ga;N||C(),q||(N(),q=!0),D.add(p,c),c.B=0}}function ug(c,p){return Hr(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=p.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=_t(_(c.Ga,c,p),vu(c,c.B)),c.B++,!0)}t.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const xe=new dt(this,this.j,c);let Ee=this.o;if(this.S&&(Ee?(Ee=g(Ee),$(Ee,this.S)):Ee=this.S),this.m!==null||this.O||(xe.H=Ee,Ee=null),this.P)e:{for(var p=0,k=0;k<this.i.length;k++){t:{var se=this.i[k];if("__data__"in se.map&&(se=se.map.__data__,typeof se=="string")){se=se.length;break t}se=void 0}if(se===void 0)break;if(p+=se,4096<p){p=k;break e}if(p===4096||k===this.i.length-1){p=k+1;break e}}p=1e3}else p=1e3;p=yu(this,xe,p),k=bt(this.I),Nt(k,"RID",c),Nt(k,"CVER",22),this.D&&Nt(k,"X-HTTP-Session-Id",this.D),Vi(this,k),Ee&&(this.O?p="headers="+encodeURIComponent(String(iu(Ee)))+"&"+p:this.m&&Al(k,this.m,Ee)),Cr(this.h,xe),this.Ua&&Nt(k,"TYPE","init"),this.P?(Nt(k,"$req",p),Nt(k,"SID","null"),xe.T=!0,kt(xe,k,null)):kt(xe,k,p),this.G=2}}else this.G==3&&(c?mu(this,c):this.i.length==0||hr(this.h)||mu(this))};function mu(c,p){var k;p?k=p.l:k=c.U++;const se=bt(c.I);Nt(se,"SID",c.K),Nt(se,"RID",k),Nt(se,"AID",c.T),Vi(c,se),c.m&&c.o&&Al(se,c.m,c.o),k=new dt(c,c.j,k,c.B+1),c.m===null&&(k.H=c.o),p&&(c.i=p.D.concat(c.i)),p=yu(c,k,1e3),k.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),Cr(c.h,k),kt(k,se,p)}function Vi(c,p){c.H&&V(c.H,function(k,se){Nt(p,se,k)}),c.l&&Ne({},function(k,se){Nt(p,se,k)})}function yu(c,p,k){k=Math.min(c.i.length,k);var se=c.l?_(c.l.Na,c.l,c):null;e:{var xe=c.i;let Ee=-1;for(;;){const Je=["count="+k];Ee==-1?0<k?(Ee=xe[0].g,Je.push("ofs="+Ee)):Ee=0:Je.push("ofs="+Ee);let or=!0;for(let Er=0;Er<k;Er++){let Kt=xe[Er].g;const Or=xe[Er].map;if(Kt-=Ee,0>Kt)Ee=Math.max(0,xe[Er].g-100),or=!1;else try{ag(Or,Je,"req"+Kt+"_")}catch{se&&se(Or)}}if(or){se=Je.join("&");break e}}}return c=c.i.splice(0,k),p.D=c,se}function pu(c){if(!c.g&&!c.u){c.Y=1;var p=c.Fa;N||C(),q||(N(),q=!0),D.add(p,c),c.v=0}}function El(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=_t(_(c.Fa,c),vu(c,c.v)),c.v++,!0)}t.Fa=function(){if(this.u=null,fu(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=_t(_(this.ab,this),c)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Qe(10),js(this),fu(this))};function Tl(c){c.A!=null&&(l.clearTimeout(c.A),c.A=null)}function fu(c){c.g=new dt(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var p=bt(c.qa);Nt(p,"RID","rpc"),Nt(p,"SID",c.K),Nt(p,"AID",c.T),Nt(p,"CI",c.F?"0":"1"),!c.F&&c.ja&&Nt(p,"TO",c.ja),Nt(p,"TYPE","xmlhttp"),Vi(c,p),c.m&&c.o&&Al(p,c.m,c.o),c.L&&(c.g.I=c.L);var k=c.g;c=c.ia,k.L=1,k.v=ln(bt(p)),k.m=null,k.P=!0,rr(k,c)}t.Za=function(){this.C!=null&&(this.C=null,js(this),El(this),Qe(19))};function Gs(c){c.C!=null&&(l.clearTimeout(c.C),c.C=null)}function gu(c,p){var k=null;if(c.g==p){Gs(c),Tl(c),c.g=null;var se=2}else if(Ir(c.h,p))k=p.D,Mr(c.h,p),se=1;else return;if(c.G!=0){if(p.o)if(se==1){k=p.m?p.m.length:0,p=Date.now()-p.F;var xe=c.B;se=pt(),be(se,new Ct(se,k)),qs(c)}else pu(c);else if(xe=p.s,xe==3||xe==0&&0<p.X||!(se==1&&ug(c,p)||se==2&&El(c)))switch(k&&0<k.length&&(p=c.h,p.i=p.i.concat(k)),xe){case 1:ko(c,5);break;case 4:ko(c,10);break;case 3:ko(c,6);break;default:ko(c,2)}}}function vu(c,p){let k=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(k*=2),k*p}function ko(c,p){if(c.j.info("Error code "+p),p==2){var k=_(c.fb,c),se=c.Xa;const xe=!se;se=new Yt(se||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||dr(se,"https"),ln(se),xe?Cl(se.toString(),k):xl(se.toString(),k)}else Qe(2);c.G=0,c.l&&c.l.sa(p),bu(c),hu(c)}t.fb=function(c){c?(this.j.info("Successfully pinged google.com"),Qe(2)):(this.j.info("Failed to ping google.com"),Qe(1))};function bu(c){if(c.G=0,c.ka=[],c.l){const p=gn(c.h);(p.length!=0||c.i.length!=0)&&(P(c.ka,p),P(c.ka,c.i),c.h.i.length=0,E(c.i),c.i.length=0),c.l.ra()}}function _u(c,p,k){var se=k instanceof Yt?bt(k):new Yt(k);if(se.g!="")p&&(se.g=p+"."+se.g),yr(se,se.s);else{var xe=l.location;se=xe.protocol,p=p?p+"."+xe.hostname:xe.hostname,xe=+xe.port;var Ee=new Yt(null);se&&dr(Ee,se),p&&(Ee.g=p),xe&&yr(Ee,xe),k&&(Ee.l=k),se=Ee}return k=c.D,p=c.ya,k&&p&&Nt(se,k,p),Nt(se,"VER",c.la),Vi(c,se),se}function Su(c,p,k){if(p&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return p=c.Ca&&!c.pa?new mr(new Bs({eb:k})):new mr(c.pa),p.Ha(c.J),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Pu(){}t=Pu.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Hs(){}Hs.prototype.g=function(c,p){return new rn(c,p)};function rn(c,p){fe.call(this),this.g=new uu(p),this.l=c,this.h=p&&p.messageUrlParams||null,c=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(c?c["X-WebChannel-Content-Type"]=p.messageContentType:c={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.va&&(c?c["X-WebChannel-Client-Profile"]=p.va:c={"X-WebChannel-Client-Profile":p.va}),this.g.S=c,(c=p&&p.Sb)&&!Y(c)&&(this.g.m=c),this.v=p&&p.supportsCrossDomainXhr||!1,this.u=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!Y(p)&&(this.g.D=p,c=this.h,c!==null&&p in c&&(c=this.h,p in c&&delete c[p])),this.j=new ti(this)}T(rn,fe),rn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},rn.prototype.close=function(){Il(this.g)},rn.prototype.o=function(c){var p=this.g;if(typeof c=="string"){var k={};k.__data__=c,c=k}else this.u&&(k={},k.__data__=ze(c),c=k);p.i.push(new cr(p.Ya++,c)),p.G==3&&qs(p)},rn.prototype.N=function(){this.g.l=null,delete this.j,Il(this.g),delete this.g,rn.aa.N.call(this)};function wu(c){Ke.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var p=c.__sm__;if(p){e:{for(const k in p){c=k;break e}c=void 0}(this.i=c)&&(c=this.i,p=p!==null&&c in p?p[c]:void 0),this.data=p}else this.data=c}T(wu,Ke);function Cu(){He.call(this),this.status=1}T(Cu,He);function ti(c){this.g=c}T(ti,Pu),ti.prototype.ua=function(){be(this.g,"a")},ti.prototype.ta=function(c){be(this.g,new wu(c))},ti.prototype.sa=function(c){be(this.g,new Cu)},ti.prototype.ra=function(){be(this.g,"b")},Hs.prototype.createWebChannel=Hs.prototype.g,rn.prototype.send=rn.prototype.o,rn.prototype.open=rn.prototype.m,rn.prototype.close=rn.prototype.close,wp=function(){return new Hs},Pp=function(){return pt()},Sp=Oe,Tc={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Tt.NO_ERROR=0,Tt.TIMEOUT=8,Tt.HTTP_ERROR=6,va=Tt,Ie.COMPLETE="complete",_p=Ie,Ce.EventType=Se,Se.OPEN="a",Se.CLOSE="b",Se.ERROR="c",Se.MESSAGE="d",fe.prototype.listen=fe.prototype.K,Ki=Ce,mr.prototype.listenOnce=mr.prototype.L,mr.prototype.getLastError=mr.prototype.Ka,mr.prototype.getLastErrorCode=mr.prototype.Ba,mr.prototype.getStatus=mr.prototype.Z,mr.prototype.getResponseJson=mr.prototype.Oa,mr.prototype.getResponseText=mr.prototype.oa,mr.prototype.send=mr.prototype.ea,mr.prototype.setWithCredentials=mr.prototype.Ha,bp=mr}).apply(typeof Qs<"u"?Qs:typeof self<"u"?self:typeof window<"u"?window:{});const dh="@firebase/firestore",uh="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ur.UNAUTHENTICATED=new Ur(null),Ur.GOOGLE_CREDENTIALS=new Ur("google-credentials-uid"),Ur.FIRST_PARTY=new Ur("first-party-uid"),Ur.MOCK_USER=new Ur("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ki="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yo=new sd("@firebase/firestore");function ci(){return Yo.logLevel}function it(t,...e){if(Yo.logLevel<=Bt.DEBUG){const r=e.map(bd);Yo.debug(`Firestore (${ki}): ${t}`,...r)}}function Jn(t,...e){if(Yo.logLevel<=Bt.ERROR){const r=e.map(bd);Yo.error(`Firestore (${ki}): ${t}`,...r)}}function Si(t,...e){if(Yo.logLevel<=Bt.WARN){const r=e.map(bd);Yo.warn(`Firestore (${ki}): ${t}`,...r)}}function bd(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gt(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,Cp(t,n,r)}function Cp(t,e,r){let n=`FIRESTORE (${ki}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Jn(n),new Error(n)}function tr(t,e,r,n){let o="Unexpected state";typeof r=="string"?o=r:n=r,t||Cp(e,o,n)}function $t(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Me={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class nt extends eo{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class g1{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Ur.UNAUTHENTICATED))}shutdown(){}}class v1{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class b1{constructor(e){this.t=e,this.currentUser=Ur.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){tr(this.o===void 0,42304);let n=this.i;const o=u=>this.i!==n?(n=this.i,r(u)):Promise.resolve();let s=new Yn;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Yn,e.enqueueRetryable(()=>o(this.currentUser))};const a=()=>{const u=s;e.enqueueRetryable(async()=>{await u.promise,await o(this.currentUser)})},l=u=>{it("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(it("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Yn)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(it("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(tr(typeof n.accessToken=="string",31837,{l:n}),new xp(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return tr(e===null||typeof e=="string",2055,{h:e}),new Ur(e)}}class _1{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Ur.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class S1{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new _1(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(Ur.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class hh{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class P1{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,yn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){tr(this.o===void 0,3512);const n=s=>{s.error!=null&&it("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,it("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const o=s=>{it("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>o(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?o(s):it("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new hh(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(tr(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new hh(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w1(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const o=w1(40);for(let s=0;s<o.length;++s)n.length<20&&o[s]<r&&(n+=e.charAt(o[s]%62))}return n}}function Ut(t,e){return t<e?-1:t>e?1:0}function kc(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const o=t.charAt(n),s=e.charAt(n);if(o!==s)return jl(o)===jl(s)?Ut(o,s):jl(o)?1:-1}return Ut(t.length,e.length)}const C1=55296,x1=57343;function jl(t){const e=t.charCodeAt(0);return e>=C1&&e<=x1}function Pi(t,e,r){return t.length===e.length&&t.every((n,o)=>r(n,e[o]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mh="__name__";class En{constructor(e,r,n){r===void 0?r=0:r>e.length&&gt(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&gt(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return En.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof En?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let o=0;o<n;o++){const s=En.compareSegments(e.get(o),r.get(o));if(s!==0)return s}return Ut(e.length,r.length)}static compareSegments(e,r){const n=En.isNumericId(e),o=En.isNumericId(r);return n&&!o?-1:!n&&o?1:n&&o?En.extractNumericId(e).compare(En.extractNumericId(r)):kc(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return go.fromString(e.substring(4,e.length-2))}}class sr extends En{construct(e,r,n){return new sr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new nt(Me.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(o=>o.length>0))}return new sr(r)}static emptyPath(){return new sr([])}}const $1=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class kr extends En{construct(e,r,n){return new kr(e,r,n)}static isValidIdentifier(e){return $1.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),kr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===mh}static keyField(){return new kr([mh])}static fromServerFormat(e){const r=[];let n="",o=0;const s=()=>{if(n.length===0)throw new nt(Me.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;o<e.length;){const l=e[o];if(l==="\\"){if(o+1===e.length)throw new nt(Me.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[o+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new nt(Me.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,o+=2}else l==="`"?(a=!a,o++):l!=="."||a?(n+=l,o++):(s(),o++)}if(s(),a)throw new nt(Me.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new kr(r)}static emptyPath(){return new kr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e){this.path=e}static fromPath(e){return new ht(sr.fromString(e))}static fromName(e){return new ht(sr.fromString(e).popFirst(5))}static empty(){return new ht(sr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&sr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return sr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ht(new sr(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $p(t,e,r){if(!r)throw new nt(Me.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function A1(t,e,r,n){if(e===!0&&n===!0)throw new nt(Me.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function yh(t){if(!ht.isDocumentKey(t))throw new nt(Me.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function ph(t){if(ht.isDocumentKey(t))throw new nt(Me.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Ap(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function il(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":gt(12329,{type:typeof t})}function Xn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new nt(Me.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=il(t);throw new nt(Me.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sr(t,e){const r={typeString:t};return e&&(r.value=e),r}function ks(t,e){if(!Ap(t))throw new nt(Me.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const o=e[n].typeString,s="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const a=t[n];if(o&&typeof a!==o){r=`JSON field '${n}' must be a ${o}.`;break}if(s!==void 0&&a!==s.value){r=`Expected '${n}' field to equal '${s.value}'`;break}}if(r)throw new nt(Me.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fh=-62135596800,gh=1e6;class lr{static now(){return lr.fromMillis(Date.now())}static fromDate(e){return lr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*gh);return new lr(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new nt(Me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new nt(Me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<fh)throw new nt(Me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new nt(Me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/gh}_compareTo(e){return this.seconds===e.seconds?Ut(this.nanoseconds,e.nanoseconds):Ut(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:lr._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ks(e,lr._jsonSchema))return new lr(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-fh;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}lr._jsonSchemaVersion="firestore/timestamp/1.0",lr._jsonSchema={type:Sr("string",lr._jsonSchemaVersion),seconds:Sr("number"),nanoseconds:Sr("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{static fromTimestamp(e){return new Pt(e)}static min(){return new Pt(new lr(0,0))}static max(){return new Pt(new lr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fs=-1;function I1(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,o=Pt.fromTimestamp(n===1e9?new lr(r+1,0):new lr(r,n));return new bo(o,ht.empty(),e)}function E1(t){return new bo(t.readTime,t.key,fs)}class bo{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new bo(Pt.min(),ht.empty(),fs)}static max(){return new bo(Pt.max(),ht.empty(),fs)}}function T1(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=ht.comparator(t.documentKey,e.documentKey),r!==0?r:Ut(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class R1{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ri(t){if(t.code!==Me.FAILED_PRECONDITION||t.message!==k1)throw t;it("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&gt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Fe((n,o)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,o)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,o)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Fe?r:Fe.resolve(r)}catch(r){return Fe.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Fe.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Fe.reject(r)}static resolve(e){return new Fe((r,n)=>{r(e)})}static reject(e){return new Fe((r,n)=>{n(e)})}static waitFor(e){return new Fe((r,n)=>{let o=0,s=0,a=!1;e.forEach(l=>{++o,l.next(()=>{++s,a&&s===o&&r()},u=>n(u))}),a=!0,s===o&&r()})}static or(e){let r=Fe.resolve(!1);for(const n of e)r=r.next(o=>o?Fe.resolve(o):n());return r}static forEach(e,r){const n=[];return e.forEach((o,s)=>{n.push(r.call(this,o,s))}),this.waitFor(n)}static mapArray(e,r){return new Fe((n,o)=>{const s=e.length,a=new Array(s);let l=0;for(let u=0;u<s;u++){const h=u;r(e[h]).next(m=>{a[h]=m,++l,l===s&&n(a)},m=>o(m))}})}static doWhile(e,r){return new Fe((n,o)=>{const s=()=>{e()===!0?r().next(()=>{s()},o):n()};s()})}}function D1(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Di(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sl{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}sl.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sd=-1;function al(t){return t==null}function Ba(t){return t===0&&1/t==-1/0}function N1(t){return typeof t=="number"&&Number.isInteger(t)&&!Ba(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ip="";function L1(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=vh(e)),e=M1(t.get(r),e);return vh(e)}function M1(t,e){let r=e;const n=t.length;for(let o=0;o<n;o++){const s=t.charAt(o);switch(s){case"\0":r+="";break;case Ip:r+="";break;default:r+=s}}return r}function vh(t){return t+Ip+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bh(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Ao(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function Ep(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur{constructor(e,r){this.comparator=e,this.root=r||Tr.EMPTY}insert(e,r){return new ur(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Tr.BLACK,null,null))}remove(e){return new ur(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Tr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const o=this.comparator(e,n.key);if(o===0)return r+n.left.size;o<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Js(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Js(this.root,e,this.comparator,!1)}getReverseIterator(){return new Js(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Js(this.root,e,this.comparator,!0)}}class Js{constructor(e,r,n,o){this.isReverse=o,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&o&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Tr{constructor(e,r,n,o,s){this.key=e,this.value=r,this.color=n??Tr.RED,this.left=o??Tr.EMPTY,this.right=s??Tr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,o,s){return new Tr(e??this.key,r??this.value,n??this.color,o??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let o=this;const s=n(e,o.key);return o=s<0?o.copy(null,null,null,o.left.insert(e,r,n),null):s===0?o.copy(null,r,null,null,null):o.copy(null,null,null,null,o.right.insert(e,r,n)),o.fixUp()}removeMin(){if(this.left.isEmpty())return Tr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,o=this;if(r(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,r),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),r(e,o.key)===0){if(o.right.isEmpty())return Tr.EMPTY;n=o.right.min(),o=o.copy(n.key,n.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,r))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Tr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Tr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw gt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw gt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw gt(27949);return e+(this.isRed()?0:1)}}Tr.EMPTY=null,Tr.RED=!0,Tr.BLACK=!1;Tr.EMPTY=new class{constructor(){this.size=0}get key(){throw gt(57766)}get value(){throw gt(16141)}get color(){throw gt(16727)}get left(){throw gt(29726)}get right(){throw gt(36894)}copy(e,r,n,o,s){return this}insert(e,r,n){return new Tr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(e){this.comparator=e,this.data=new ur(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const o=n.getNext();if(this.comparator(o.key,e[1])>=0)return;r(o.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new _h(this.data.getIterator())}getIteratorFrom(e){return new _h(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof wr)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const o=r.getNext().key,s=n.getNext().key;if(this.comparator(o,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new wr(this.comparator);return r.data=e,r}}class _h{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.fields=e,e.sort(kr.comparator)}static empty(){return new on([])}unionWith(e){let r=new wr(kr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new on(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Pi(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tp extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(o){try{return atob(o)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Tp("Invalid base64 string: "+s):s}}(e);return new Lr(r)}static fromUint8Array(e){const r=function(o){let s="";for(let a=0;a<o.length;++a)s+=String.fromCharCode(o[a]);return s}(e);return new Lr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let o=0;o<r.length;o++)n[o]=r.charCodeAt(o);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ut(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Lr.EMPTY_BYTE_STRING=new Lr("");const O1=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function _o(t){if(tr(!!t,39018),typeof t=="string"){let e=0;const r=O1.exec(t);if(tr(!!r,46558,{timestamp:t}),r[1]){let o=r[1];o=(o+"000000000").substr(0,9),e=Number(o)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:pr(t.seconds),nanos:pr(t.nanos)}}function pr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function So(t){return typeof t=="string"?Lr.fromBase64String(t):Lr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kp="server_timestamp",Rp="__type__",Dp="__previous_value__",Np="__local_write_time__";function Pd(t){return(t?.mapValue?.fields||{})[Rp]?.stringValue===kp}function ll(t){const e=t.mapValue.fields[Dp];return Pd(e)?ll(e):e}function gs(t){const e=_o(t.mapValue.fields[Np].timestampValue);return new lr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F1{constructor(e,r,n,o,s,a,l,u,h,m){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=o,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=m}}const Ua="(default)";class vs{constructor(e,r){this.projectId=e,this.database=r||Ua}static empty(){return new vs("","")}get isDefaultDatabase(){return this.database===Ua}isEqual(e){return e instanceof vs&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lp="__type__",V1="__max__",Xs={mapValue:{}},Mp="__vector__",za="value";function Po(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Pd(t)?4:U1(t)?9007199254740991:B1(t)?10:11:gt(28295,{value:t})}function Fn(t,e){if(t===e)return!0;const r=Po(t);if(r!==Po(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return gs(t).isEqual(gs(e));case 3:return function(o,s){if(typeof o.timestampValue=="string"&&typeof s.timestampValue=="string"&&o.timestampValue.length===s.timestampValue.length)return o.timestampValue===s.timestampValue;const a=_o(o.timestampValue),l=_o(s.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(o,s){return So(o.bytesValue).isEqual(So(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(o,s){return pr(o.geoPointValue.latitude)===pr(s.geoPointValue.latitude)&&pr(o.geoPointValue.longitude)===pr(s.geoPointValue.longitude)}(t,e);case 2:return function(o,s){if("integerValue"in o&&"integerValue"in s)return pr(o.integerValue)===pr(s.integerValue);if("doubleValue"in o&&"doubleValue"in s){const a=pr(o.doubleValue),l=pr(s.doubleValue);return a===l?Ba(a)===Ba(l):isNaN(a)&&isNaN(l)}return!1}(t,e);case 9:return Pi(t.arrayValue.values||[],e.arrayValue.values||[],Fn);case 10:case 11:return function(o,s){const a=o.mapValue.fields||{},l=s.mapValue.fields||{};if(bh(a)!==bh(l))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(l[u]===void 0||!Fn(a[u],l[u])))return!1;return!0}(t,e);default:return gt(52216,{left:t})}}function bs(t,e){return(t.values||[]).find(r=>Fn(r,e))!==void 0}function wi(t,e){if(t===e)return 0;const r=Po(t),n=Po(e);if(r!==n)return Ut(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Ut(t.booleanValue,e.booleanValue);case 2:return function(s,a){const l=pr(s.integerValue||s.doubleValue),u=pr(a.integerValue||a.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return Sh(t.timestampValue,e.timestampValue);case 4:return Sh(gs(t),gs(e));case 5:return kc(t.stringValue,e.stringValue);case 6:return function(s,a){const l=So(s),u=So(a);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const l=s.split("/"),u=a.split("/");for(let h=0;h<l.length&&h<u.length;h++){const m=Ut(l[h],u[h]);if(m!==0)return m}return Ut(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const l=Ut(pr(s.latitude),pr(a.latitude));return l!==0?l:Ut(pr(s.longitude),pr(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Ph(t.arrayValue,e.arrayValue);case 10:return function(s,a){const l=s.fields||{},u=a.fields||{},h=l[za]?.arrayValue,m=u[za]?.arrayValue,v=Ut(h?.values?.length||0,m?.values?.length||0);return v!==0?v:Ph(h,m)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===Xs.mapValue&&a===Xs.mapValue)return 0;if(s===Xs.mapValue)return 1;if(a===Xs.mapValue)return-1;const l=s.fields||{},u=Object.keys(l),h=a.fields||{},m=Object.keys(h);u.sort(),m.sort();for(let v=0;v<u.length&&v<m.length;++v){const _=kc(u[v],m[v]);if(_!==0)return _;const x=wi(l[u[v]],h[m[v]]);if(x!==0)return x}return Ut(u.length,m.length)}(t.mapValue,e.mapValue);default:throw gt(23264,{he:r})}}function Sh(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ut(t,e);const r=_o(t),n=_o(e),o=Ut(r.seconds,n.seconds);return o!==0?o:Ut(r.nanos,n.nanos)}function Ph(t,e){const r=t.values||[],n=e.values||[];for(let o=0;o<r.length&&o<n.length;++o){const s=wi(r[o],n[o]);if(s)return s}return Ut(r.length,n.length)}function Ci(t){return Rc(t)}function Rc(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=_o(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return So(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return ht.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",o=!0;for(const s of r.values||[])o?o=!1:n+=",",n+=Rc(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let o="{",s=!0;for(const a of n)s?s=!1:o+=",",o+=`${a}:${Rc(r.fields[a])}`;return o+"}"}(t.mapValue):gt(61005,{value:t})}function ba(t){switch(Po(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ll(t);return e?16+ba(e):16;case 5:return 2*t.stringValue.length;case 6:return So(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((o,s)=>o+ba(s),0)}(t.arrayValue);case 10:case 11:return function(n){let o=0;return Ao(n.fields,(s,a)=>{o+=s.length+ba(a)}),o}(t.mapValue);default:throw gt(13486,{value:t})}}function wh(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Dc(t){return!!t&&"integerValue"in t}function wd(t){return!!t&&"arrayValue"in t}function Ch(t){return!!t&&"nullValue"in t}function xh(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function _a(t){return!!t&&"mapValue"in t}function B1(t){return(t?.mapValue?.fields||{})[Lp]?.stringValue===Mp}function os(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Ao(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=os(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=os(t.arrayValue.values[r]);return e}return{...t}}function U1(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===V1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.value=e}static empty(){return new en({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!_a(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=os(r)}setAll(e){let r=kr.emptyPath(),n={},o=[];e.forEach((a,l)=>{if(!r.isImmediateParentOf(l)){const u=this.getFieldsMap(r);this.applyChanges(u,n,o),n={},o=[],r=l.popLast()}a?n[l.lastSegment()]=os(a):o.push(l.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,o)}delete(e){const r=this.field(e.popLast());_a(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Fn(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let o=r.mapValue.fields[e.get(n)];_a(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=o),r=o}return r.mapValue.fields}applyChanges(e,r,n){Ao(r,(o,s)=>e[o]=s);for(const o of n)delete e[o]}clone(){return new en(os(this.value))}}function Op(t){const e=[];return Ao(t.fields,(r,n)=>{const o=new kr([r]);if(_a(n)){const s=Op(n.mapValue).fields;if(s.length===0)e.push(o);else for(const a of s)e.push(o.child(a))}else e.push(o)}),new on(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr{constructor(e,r,n,o,s,a,l){this.key=e,this.documentType=r,this.version=n,this.readTime=o,this.createTime=s,this.data=a,this.documentState=l}static newInvalidDocument(e){return new zr(e,0,Pt.min(),Pt.min(),Pt.min(),en.empty(),0)}static newFoundDocument(e,r,n,o){return new zr(e,1,r,Pt.min(),n,o,0)}static newNoDocument(e,r){return new zr(e,2,r,Pt.min(),Pt.min(),en.empty(),0)}static newUnknownDocument(e,r){return new zr(e,3,r,Pt.min(),Pt.min(),en.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Pt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=en.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=en.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Pt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof zr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new zr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja{constructor(e,r){this.position=e,this.inclusive=r}}function $h(t,e,r){let n=0;for(let o=0;o<t.position.length;o++){const s=e[o],a=t.position[o];if(s.field.isKeyField()?n=ht.comparator(ht.fromName(a.referenceValue),r.key):n=wi(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function Ah(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Fn(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(e,r="asc"){this.field=e,this.dir=r}}function z1(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fp{}class _r extends Fp{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new q1(e,r,n):r==="array-contains"?new W1(e,n):r==="in"?new Y1(e,n):r==="not-in"?new K1(e,n):r==="array-contains-any"?new Q1(e,n):new _r(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new G1(e,n):new H1(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(wi(r,this.value)):r!==null&&Po(this.value)===Po(r)&&this.matchesComparison(wi(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return gt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Cn extends Fp{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Cn(e,r)}matches(e){return Vp(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Vp(t){return t.op==="and"}function Bp(t){return j1(t)&&Vp(t)}function j1(t){for(const e of t.filters)if(e instanceof Cn)return!1;return!0}function Nc(t){if(t instanceof _r)return t.field.canonicalString()+t.op.toString()+Ci(t.value);if(Bp(t))return t.filters.map(e=>Nc(e)).join(",");{const e=t.filters.map(r=>Nc(r)).join(",");return`${t.op}(${e})`}}function Up(t,e){return t instanceof _r?function(n,o){return o instanceof _r&&n.op===o.op&&n.field.isEqual(o.field)&&Fn(n.value,o.value)}(t,e):t instanceof Cn?function(n,o){return o instanceof Cn&&n.op===o.op&&n.filters.length===o.filters.length?n.filters.reduce((s,a,l)=>s&&Up(a,o.filters[l]),!0):!1}(t,e):void gt(19439)}function zp(t){return t instanceof _r?function(r){return`${r.field.canonicalString()} ${r.op} ${Ci(r.value)}`}(t):t instanceof Cn?function(r){return r.op.toString()+" {"+r.getFilters().map(zp).join(" ,")+"}"}(t):"Filter"}class q1 extends _r{constructor(e,r,n){super(e,r,n),this.key=ht.fromName(n.referenceValue)}matches(e){const r=ht.comparator(e.key,this.key);return this.matchesComparison(r)}}class G1 extends _r{constructor(e,r){super(e,"in",r),this.keys=jp("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class H1 extends _r{constructor(e,r){super(e,"not-in",r),this.keys=jp("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function jp(t,e){return(e.arrayValue?.values||[]).map(r=>ht.fromName(r.referenceValue))}class W1 extends _r{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return wd(r)&&bs(r.arrayValue,this.value)}}class Y1 extends _r{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&bs(this.value.arrayValue,r)}}class K1 extends _r{constructor(e,r){super(e,"not-in",r)}matches(e){if(bs(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!bs(this.value.arrayValue,r)}}class Q1 extends _r{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!wd(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>bs(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J1{constructor(e,r=null,n=[],o=[],s=null,a=null,l=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=o,this.limit=s,this.startAt=a,this.endAt=l,this.Te=null}}function Ih(t,e=null,r=[],n=[],o=null,s=null,a=null){return new J1(t,e,r,n,o,s,a)}function Cd(t){const e=$t(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Nc(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),al(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Ci(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Ci(n)).join(",")),e.Te=r}return e.Te}function xd(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!z1(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!Up(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ah(t.startAt,e.startAt)&&Ah(t.endAt,e.endAt)}function Lc(t){return ht.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(e,r=null,n=[],o=[],s=null,a="F",l=null,u=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=o,this.limit=s,this.limitType=a,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function X1(t,e,r,n,o,s,a,l){return new Ni(t,e,r,n,o,s,a,l)}function $d(t){return new Ni(t)}function Eh(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function qp(t){return t.collectionGroup!==null}function is(t){const e=$t(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new wr(kr.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(l=l.add(h.field))})}),l})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new _s(s,n))}),r.has(kr.keyField().canonicalString())||e.Ie.push(new _s(kr.keyField(),n))}return e.Ie}function Rn(t){const e=$t(t);return e.Ee||(e.Ee=Z1(e,is(t))),e.Ee}function Z1(t,e){if(t.limitType==="F")return Ih(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(o=>{const s=o.dir==="desc"?"asc":"desc";return new _s(o.field,s)});const r=t.endAt?new ja(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new ja(t.startAt.position,t.startAt.inclusive):null;return Ih(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Mc(t,e){const r=t.filters.concat([e]);return new Ni(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function Oc(t,e,r){return new Ni(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function cl(t,e){return xd(Rn(t),Rn(e))&&t.limitType===e.limitType}function Gp(t){return`${Cd(Rn(t))}|lt:${t.limitType}`}function di(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(o=>zp(o)).join(", ")}]`),al(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(o=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(o)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(o=>Ci(o)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(o=>Ci(o)).join(",")),`Target(${n})`}(Rn(t))}; limitType=${t.limitType})`}function dl(t,e){return e.isFoundDocument()&&function(n,o){const s=o.key.path;return n.collectionGroup!==null?o.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):ht.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,o){for(const s of is(n))if(!s.field.isKeyField()&&o.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,o){for(const s of n.filters)if(!s.matches(o))return!1;return!0}(t,e)&&function(n,o){return!(n.startAt&&!function(a,l,u){const h=$h(a,l,u);return a.inclusive?h<=0:h<0}(n.startAt,is(n),o)||n.endAt&&!function(a,l,u){const h=$h(a,l,u);return a.inclusive?h>=0:h>0}(n.endAt,is(n),o))}(t,e)}function eS(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Hp(t){return(e,r)=>{let n=!1;for(const o of is(t)){const s=tS(o,e,r);if(s!==0)return s;n=n||o.field.isKeyField()}return 0}}function tS(t,e,r){const n=t.field.isKeyField()?ht.comparator(e.key,r.key):function(s,a,l){const u=a.data.field(s),h=l.data.field(s);return u!==null&&h!==null?wi(u,h):gt(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return gt(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[o,s]of n)if(this.equalsFn(o,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),o=this.inner[n];if(o===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<o.length;s++)if(this.equalsFn(o[s][0],e))return void(o[s]=[e,r]);o.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let o=0;o<n.length;o++)if(this.equalsFn(n[o][0],e))return n.length===1?delete this.inner[r]:n.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Ao(this.inner,(r,n)=>{for(const[o,s]of n)e(o,s)})}isEmpty(){return Ep(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rS=new ur(ht.comparator);function Zn(){return rS}const Wp=new ur(ht.comparator);function Qi(...t){let e=Wp;for(const r of t)e=e.insert(r.key,r);return e}function Yp(t){let e=Wp;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function zo(){return ss()}function Kp(){return ss()}function ss(){return new Jo(t=>t.toString(),(t,e)=>t.isEqual(e))}const nS=new ur(ht.comparator),oS=new wr(ht.comparator);function zt(...t){let e=oS;for(const r of t)e=e.add(r);return e}const iS=new wr(Ut);function sS(){return iS}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ad(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ba(e)?"-0":e}}function Qp(t){return{integerValue:""+t}}function aS(t,e){return N1(e)?Qp(e):Ad(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{constructor(){this._=void 0}}function lS(t,e,r){return t instanceof qa?function(o,s){const a={fields:{[Rp]:{stringValue:kp},[Np]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return s&&Pd(s)&&(s=ll(s)),s&&(a.fields[Dp]=s),{mapValue:a}}(r,e):t instanceof Ss?Xp(t,e):t instanceof Ps?Zp(t,e):function(o,s){const a=Jp(o,s),l=Th(a)+Th(o.Ae);return Dc(a)&&Dc(o.Ae)?Qp(l):Ad(o.serializer,l)}(t,e)}function cS(t,e,r){return t instanceof Ss?Xp(t,e):t instanceof Ps?Zp(t,e):r}function Jp(t,e){return t instanceof Ga?function(n){return Dc(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class qa extends ul{}class Ss extends ul{constructor(e){super(),this.elements=e}}function Xp(t,e){const r=ef(e);for(const n of t.elements)r.some(o=>Fn(o,n))||r.push(n);return{arrayValue:{values:r}}}class Ps extends ul{constructor(e){super(),this.elements=e}}function Zp(t,e){let r=ef(e);for(const n of t.elements)r=r.filter(o=>!Fn(o,n));return{arrayValue:{values:r}}}class Ga extends ul{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function Th(t){return pr(t.integerValue||t.doubleValue)}function ef(t){return wd(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function dS(t,e){return t.field.isEqual(e.field)&&function(n,o){return n instanceof Ss&&o instanceof Ss||n instanceof Ps&&o instanceof Ps?Pi(n.elements,o.elements,Fn):n instanceof Ga&&o instanceof Ga?Fn(n.Ae,o.Ae):n instanceof qa&&o instanceof qa}(t.transform,e.transform)}class uS{constructor(e,r){this.version=e,this.transformResults=r}}class Dn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Dn}static exists(e){return new Dn(void 0,e)}static updateTime(e){return new Dn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Sa(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class hl{}function tf(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new nf(t.key,Dn.none()):new Rs(t.key,t.data,Dn.none());{const r=t.data,n=en.empty();let o=new wr(kr.comparator);for(let s of e.fields)if(!o.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),o=o.add(s)}return new Io(t.key,n,new on(o.toArray()),Dn.none())}}function hS(t,e,r){t instanceof Rs?function(o,s,a){const l=o.value.clone(),u=Rh(o.fieldTransforms,s,a.transformResults);l.setAll(u),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):t instanceof Io?function(o,s,a){if(!Sa(o.precondition,s))return void s.convertToUnknownDocument(a.version);const l=Rh(o.fieldTransforms,s,a.transformResults),u=s.data;u.setAll(rf(o)),u.setAll(l),s.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,r):function(o,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function as(t,e,r,n){return t instanceof Rs?function(s,a,l,u){if(!Sa(s.precondition,a))return l;const h=s.value.clone(),m=Dh(s.fieldTransforms,u,a);return h.setAll(m),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(t,e,r,n):t instanceof Io?function(s,a,l,u){if(!Sa(s.precondition,a))return l;const h=Dh(s.fieldTransforms,u,a),m=a.data;return m.setAll(rf(s)),m.setAll(h),a.convertToFoundDocument(a.version,m).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(v=>v.field))}(t,e,r,n):function(s,a,l){return Sa(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(t,e,r)}function mS(t,e){let r=null;for(const n of t.fieldTransforms){const o=e.data.field(n.field),s=Jp(n.transform,o||null);s!=null&&(r===null&&(r=en.empty()),r.set(n.field,s))}return r||null}function kh(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,o){return n===void 0&&o===void 0||!(!n||!o)&&Pi(n,o,(s,a)=>dS(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Rs extends hl{constructor(e,r,n,o=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Io extends hl{constructor(e,r,n,o,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=o,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function rf(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function Rh(t,e,r){const n=new Map;tr(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let o=0;o<r.length;o++){const s=t[o],a=s.transform,l=e.data.field(s.field);n.set(s.field,cS(a,l,r[o]))}return n}function Dh(t,e,r){const n=new Map;for(const o of t){const s=o.transform,a=r.data.field(o.field);n.set(o.field,lS(s,a,e))}return n}class nf extends hl{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class yS extends hl{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pS{constructor(e,r,n,o){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=o}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let o=0;o<this.mutations.length;o++){const s=this.mutations[o];s.key.isEqual(e.key)&&hS(s,e,n[o])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=as(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=as(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=Kp();return this.mutations.forEach(o=>{const s=e.get(o.key),a=s.overlayedDocument;let l=this.applyToLocalView(a,s.mutatedFields);l=r.has(o.key)?null:l;const u=tf(a,l);u!==null&&n.set(o.key,u),a.isValidDocument()||a.convertToNoDocument(Pt.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),zt())}isEqual(e){return this.batchId===e.batchId&&Pi(this.mutations,e.mutations,(r,n)=>kh(r,n))&&Pi(this.baseMutations,e.baseMutations,(r,n)=>kh(r,n))}}class Id{constructor(e,r,n,o){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=o}static from(e,r,n){tr(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let o=function(){return nS}();const s=e.mutations;for(let a=0;a<s.length;a++)o=o.insert(s[a].key,n[a].version);return new Id(e,r,n,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gS{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var br,qt;function vS(t){switch(t){case Me.OK:return gt(64938);case Me.CANCELLED:case Me.UNKNOWN:case Me.DEADLINE_EXCEEDED:case Me.RESOURCE_EXHAUSTED:case Me.INTERNAL:case Me.UNAVAILABLE:case Me.UNAUTHENTICATED:return!1;case Me.INVALID_ARGUMENT:case Me.NOT_FOUND:case Me.ALREADY_EXISTS:case Me.PERMISSION_DENIED:case Me.FAILED_PRECONDITION:case Me.ABORTED:case Me.OUT_OF_RANGE:case Me.UNIMPLEMENTED:case Me.DATA_LOSS:return!0;default:return gt(15467,{code:t})}}function of(t){if(t===void 0)return Jn("GRPC error has no .code"),Me.UNKNOWN;switch(t){case br.OK:return Me.OK;case br.CANCELLED:return Me.CANCELLED;case br.UNKNOWN:return Me.UNKNOWN;case br.DEADLINE_EXCEEDED:return Me.DEADLINE_EXCEEDED;case br.RESOURCE_EXHAUSTED:return Me.RESOURCE_EXHAUSTED;case br.INTERNAL:return Me.INTERNAL;case br.UNAVAILABLE:return Me.UNAVAILABLE;case br.UNAUTHENTICATED:return Me.UNAUTHENTICATED;case br.INVALID_ARGUMENT:return Me.INVALID_ARGUMENT;case br.NOT_FOUND:return Me.NOT_FOUND;case br.ALREADY_EXISTS:return Me.ALREADY_EXISTS;case br.PERMISSION_DENIED:return Me.PERMISSION_DENIED;case br.FAILED_PRECONDITION:return Me.FAILED_PRECONDITION;case br.ABORTED:return Me.ABORTED;case br.OUT_OF_RANGE:return Me.OUT_OF_RANGE;case br.UNIMPLEMENTED:return Me.UNIMPLEMENTED;case br.DATA_LOSS:return Me.DATA_LOSS;default:return gt(39323,{code:t})}}(qt=br||(br={}))[qt.OK=0]="OK",qt[qt.CANCELLED=1]="CANCELLED",qt[qt.UNKNOWN=2]="UNKNOWN",qt[qt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",qt[qt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",qt[qt.NOT_FOUND=5]="NOT_FOUND",qt[qt.ALREADY_EXISTS=6]="ALREADY_EXISTS",qt[qt.PERMISSION_DENIED=7]="PERMISSION_DENIED",qt[qt.UNAUTHENTICATED=16]="UNAUTHENTICATED",qt[qt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",qt[qt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",qt[qt.ABORTED=10]="ABORTED",qt[qt.OUT_OF_RANGE=11]="OUT_OF_RANGE",qt[qt.UNIMPLEMENTED=12]="UNIMPLEMENTED",qt[qt.INTERNAL=13]="INTERNAL",qt[qt.UNAVAILABLE=14]="UNAVAILABLE",qt[qt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bS(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _S=new go([4294967295,4294967295],0);function Nh(t){const e=bS().encode(t),r=new vp;return r.update(e),new Uint8Array(r.digest())}function Lh(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),o=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new go([r,n],0),new go([o,s],0)]}class Ed{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Ji(`Invalid padding: ${r}`);if(n<0)throw new Ji(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Ji(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Ji(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=go.fromNumber(this.ge)}ye(e,r,n){let o=e.add(r.multiply(go.fromNumber(n)));return o.compare(_S)===1&&(o=new go([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=Nh(e),[n,o]=Lh(r);for(let s=0;s<this.hashCount;s++){const a=this.ye(n,o,s);if(!this.we(a))return!1}return!0}static create(e,r,n){const o=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new Ed(s,o,r);return n.forEach(l=>a.insert(l)),a}insert(e){if(this.ge===0)return;const r=Nh(e),[n,o]=Lh(r);for(let s=0;s<this.hashCount;s++){const a=this.ye(n,o,s);this.Se(a)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Ji extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(e,r,n,o,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=o,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const o=new Map;return o.set(e,Ds.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new ml(Pt.min(),o,new ur(Ut),Zn(),zt())}}class Ds{constructor(e,r,n,o,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=o,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Ds(n,r,zt(),zt(),zt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(e,r,n,o){this.be=e,this.removedTargetIds=r,this.key=n,this.De=o}}class sf{constructor(e,r){this.targetId=e,this.Ce=r}}class af{constructor(e,r,n=Lr.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=o}}class Mh{constructor(){this.ve=0,this.Fe=Oh(),this.Me=Lr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=zt(),r=zt(),n=zt();return this.Fe.forEach((o,s)=>{switch(s){case 0:e=e.add(o);break;case 2:r=r.add(o);break;case 1:n=n.add(o);break;default:gt(38017,{changeType:s})}}),new Ds(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=Oh()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,tr(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class SS{constructor(e){this.Ge=e,this.ze=new Map,this.je=Zn(),this.Je=Zs(),this.He=Zs(),this.Ye=new ur(Ut)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:gt(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,o)=>{this.rt(o)&&r(o)})}st(e){const r=e.targetId,n=e.Ce.count,o=this.ot(r);if(o){const s=o.target;if(Lc(s))if(n===0){const a=new ht(s.path);this.et(r,a,zr.newNoDocument(a,Pt.min()))}else tr(n===1,20013,{expectedCount:n});else{const a=this._t(r);if(a!==n){const l=this.ut(e),u=l?this.ct(l,e,a):1;if(u!==0){this.it(r);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,h)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:o=0},hashCount:s=0}=r;let a,l;try{a=So(n).toUint8Array()}catch(u){if(u instanceof Tp)return Si("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new Ed(a,o,s)}catch(u){return Si(u instanceof Ji?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.ge===0?null:l}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let o=0;return n.forEach(s=>{const a=this.Ge.ht(),l=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.et(r,s,null),o++)}),o}Tt(e){const r=new Map;this.ze.forEach((s,a)=>{const l=this.ot(a);if(l){if(s.current&&Lc(l.target)){const u=new ht(l.target.path);this.It(u).has(a)||this.Et(a,u)||this.et(a,u,zr.newNoDocument(u,e))}s.Be&&(r.set(a,s.ke()),s.qe())}});let n=zt();this.He.forEach((s,a)=>{let l=!0;a.forEachWhile(u=>{const h=this.ot(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(s))}),this.je.forEach((s,a)=>a.setReadTime(e));const o=new ml(e,r,this.Ye,this.je,n);return this.je=Zn(),this.Je=Zs(),this.He=Zs(),this.Ye=new ur(Ut),o}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,r)?o.Qe(r,1):o.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new Mh,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new wr(Ut),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new wr(Ut),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||it("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Mh),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function Zs(){return new ur(ht.comparator)}function Oh(){return new ur(ht.comparator)}const PS={asc:"ASCENDING",desc:"DESCENDING"},wS={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},CS={and:"AND",or:"OR"};class xS{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Fc(t,e){return t.useProto3Json||al(e)?e:{value:e}}function Ha(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function lf(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function $S(t,e){return Ha(t,e.toTimestamp())}function Nn(t){return tr(!!t,49232),Pt.fromTimestamp(function(r){const n=_o(r);return new lr(n.seconds,n.nanos)}(t))}function Td(t,e){return Vc(t,e).canonicalString()}function Vc(t,e){const r=function(o){return new sr(["projects",o.projectId,"databases",o.database])}(t).child("documents");return e===void 0?r:r.child(e)}function cf(t){const e=sr.fromString(t);return tr(yf(e),10190,{key:e.toString()}),e}function Bc(t,e){return Td(t.databaseId,e.path)}function ql(t,e){const r=cf(e);if(r.get(1)!==t.databaseId.projectId)throw new nt(Me.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new nt(Me.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new ht(uf(r))}function df(t,e){return Td(t.databaseId,e)}function AS(t){const e=cf(t);return e.length===4?sr.emptyPath():uf(e)}function Uc(t){return new sr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function uf(t){return tr(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Fh(t,e,r){return{name:Bc(t,e),fields:r.value.mapValue.fields}}function IS(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:gt(39313,{state:h})}(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],s=function(h,m){return h.useProto3Json?(tr(m===void 0||typeof m=="string",58123),Lr.fromBase64String(m||"")):(tr(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),Lr.fromUint8Array(m||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(h){const m=h.code===void 0?Me.UNKNOWN:of(h.code);return new nt(m,h.message||"")}(a);r=new af(n,o,s,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const o=ql(t,n.document.name),s=Nn(n.document.updateTime),a=n.document.createTime?Nn(n.document.createTime):Pt.min(),l=new en({mapValue:{fields:n.document.fields}}),u=zr.newFoundDocument(o,s,a,l),h=n.targetIds||[],m=n.removedTargetIds||[];r=new Pa(h,m,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const o=ql(t,n.document),s=n.readTime?Nn(n.readTime):Pt.min(),a=zr.newNoDocument(o,s),l=n.removedTargetIds||[];r=new Pa([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const o=ql(t,n.document),s=n.removedTargetIds||[];r=new Pa([],s,o,null)}else{if(!("filter"in e))return gt(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:o=0,unchangedNames:s}=n,a=new gS(o,s),l=n.targetId;r=new sf(l,a)}}return r}function ES(t,e){let r;if(e instanceof Rs)r={update:Fh(t,e.key,e.value)};else if(e instanceof nf)r={delete:Bc(t,e.key)};else if(e instanceof Io)r={update:Fh(t,e.key,e.data),updateMask:FS(e.fieldMask)};else{if(!(e instanceof yS))return gt(16599,{Vt:e.type});r={verify:Bc(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const l=a.transform;if(l instanceof qa)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Ss)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Ps)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Ga)return{fieldPath:a.field.canonicalString(),increment:l.Ae};throw gt(20930,{transform:a.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(o,s){return s.updateTime!==void 0?{updateTime:$S(o,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:gt(27497)}(t,e.precondition)),r}function TS(t,e){return t&&t.length>0?(tr(e!==void 0,14353),t.map(r=>function(o,s){let a=o.updateTime?Nn(o.updateTime):Nn(s);return a.isEqual(Pt.min())&&(a=Nn(s)),new uS(a,o.transformResults||[])}(r,e))):[]}function kS(t,e){return{documents:[df(t,e.path)]}}function RS(t,e){const r={structuredQuery:{}},n=e.path;let o;e.collectionGroup!==null?(o=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=df(t,o);const s=function(h){if(h.length!==0)return mf(Cn.create(h,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const a=function(h){if(h.length!==0)return h.map(m=>function(_){return{field:ui(_.field),direction:LS(_.dir)}}(m))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const l=Fc(t,e.limit);return l!==null&&(r.structuredQuery.limit=l),e.startAt&&(r.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{ft:r,parent:o}}function DS(t){let e=AS(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let o=null;if(n>0){tr(n===1,65062);const m=r.from[0];m.allDescendants?o=m.collectionId:e=e.child(m.collectionId)}let s=[];r.where&&(s=function(v){const _=hf(v);return _ instanceof Cn&&Bp(_)?_.getFilters():[_]}(r.where));let a=[];r.orderBy&&(a=function(v){return v.map(_=>function(T){return new _s(hi(T.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction))}(_))}(r.orderBy));let l=null;r.limit&&(l=function(v){let _;return _=typeof v=="object"?v.value:v,al(_)?null:_}(r.limit));let u=null;r.startAt&&(u=function(v){const _=!!v.before,x=v.values||[];return new ja(x,_)}(r.startAt));let h=null;return r.endAt&&(h=function(v){const _=!v.before,x=v.values||[];return new ja(x,_)}(r.endAt)),X1(e,o,a,s,l,"F",u,h)}function NS(t,e){const r=function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return gt(28987,{purpose:o})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function hf(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=hi(r.unaryFilter.field);return _r.create(n,"==",{doubleValue:NaN});case"IS_NULL":const o=hi(r.unaryFilter.field);return _r.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=hi(r.unaryFilter.field);return _r.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=hi(r.unaryFilter.field);return _r.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return gt(61313);default:return gt(60726)}}(t):t.fieldFilter!==void 0?function(r){return _r.create(hi(r.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return gt(58110);default:return gt(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Cn.create(r.compositeFilter.filters.map(n=>hf(n)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return gt(1026)}}(r.compositeFilter.op))}(t):gt(30097,{filter:t})}function LS(t){return PS[t]}function MS(t){return wS[t]}function OS(t){return CS[t]}function ui(t){return{fieldPath:t.canonicalString()}}function hi(t){return kr.fromServerFormat(t.fieldPath)}function mf(t){return t instanceof _r?function(r){if(r.op==="=="){if(xh(r.value))return{unaryFilter:{field:ui(r.field),op:"IS_NAN"}};if(Ch(r.value))return{unaryFilter:{field:ui(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(xh(r.value))return{unaryFilter:{field:ui(r.field),op:"IS_NOT_NAN"}};if(Ch(r.value))return{unaryFilter:{field:ui(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ui(r.field),op:MS(r.op),value:r.value}}}(t):t instanceof Cn?function(r){const n=r.getFilters().map(o=>mf(o));return n.length===1?n[0]:{compositeFilter:{op:OS(r.op),filters:n}}}(t):gt(54877,{filter:t})}function FS(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function yf(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(e,r,n,o,s=Pt.min(),a=Pt.min(),l=Lr.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=o,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new uo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new uo(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new uo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new uo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VS{constructor(e){this.yt=e}}function BS(t){const e=DS({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Oc(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class US{constructor(){this.Cn=new zS}addToCollectionParentIndex(e,r){return this.Cn.add(r),Fe.resolve()}getCollectionParents(e,r){return Fe.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return Fe.resolve()}deleteFieldIndex(e,r){return Fe.resolve()}deleteAllFieldIndexes(e){return Fe.resolve()}createTargetIndexes(e,r){return Fe.resolve()}getDocumentsMatchingTarget(e,r){return Fe.resolve(null)}getIndexType(e,r){return Fe.resolve(0)}getFieldIndexes(e,r){return Fe.resolve([])}getNextCollectionGroupToUpdate(e){return Fe.resolve(null)}getMinOffset(e,r){return Fe.resolve(bo.min())}getMinOffsetFromCollectionGroup(e,r){return Fe.resolve(bo.min())}updateCollectionGroup(e,r,n){return Fe.resolve()}updateIndexEntries(e,r){return Fe.resolve()}}class zS{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),o=this.index[r]||new wr(sr.comparator),s=!o.has(n);return this.index[r]=o.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),o=this.index[r];return o&&o.has(n)}getEntries(e){return(this.index[e]||new wr(sr.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vh={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},pf=41943040;class Zr{static withCacheSize(e){return new Zr(e,Zr.DEFAULT_COLLECTION_PERCENTILE,Zr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Zr.DEFAULT_COLLECTION_PERCENTILE=10,Zr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Zr.DEFAULT=new Zr(pf,Zr.DEFAULT_COLLECTION_PERCENTILE,Zr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Zr.DISABLED=new Zr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new xi(0)}static cr(){return new xi(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bh="LruGarbageCollector",jS=1048576;function Uh([t,e],[r,n]){const o=Ut(t,r);return o===0?Ut(e,n):o}class qS{constructor(e){this.Ir=e,this.buffer=new wr(Uh),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();Uh(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class GS{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){it(Bh,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Di(r)?it(Bh,"Ignoring IndexedDB error during garbage collection: ",r):await Ri(r)}await this.Vr(3e5)})}}class HS{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return Fe.resolve(sl.ce);const n=new qS(r);return this.mr.forEachTarget(e,o=>n.Ar(o.sequenceNumber)).next(()=>this.mr.pr(e,o=>n.Ar(o))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(it("LruGarbageCollector","Garbage collection skipped; disabled"),Fe.resolve(Vh)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(it("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Vh):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,o,s,a,l,u,h;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(v=>(v>this.params.maximumSequenceNumbersToCollect?(it("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),o=this.params.maximumSequenceNumbersToCollect):o=v,a=Date.now(),this.nthSequenceNumber(e,o))).next(v=>(n=v,l=Date.now(),this.removeTargets(e,n,r))).next(v=>(s=v,u=Date.now(),this.removeOrphanedDocuments(e,n))).next(v=>(h=Date.now(),ci()<=Bt.DEBUG&&it("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-m}ms
	Determined least recently used ${o} in `+(l-a)+`ms
	Removed ${s} targets in `+(u-l)+`ms
	Removed ${v} documents in `+(h-u)+`ms
Total Duration: ${h-m}ms`),Fe.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:s,documentsRemoved:v})))}}function WS(t,e){return new HS(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YS{constructor(){this.changes=new Jo(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,zr.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Fe.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(e,r,n,o){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=o}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(o=>(n=o,this.remoteDocumentCache.getEntry(e,r))).next(o=>(n!==null&&as(n.mutation,o,on.empty(),lr.now()),o))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,zt()).next(()=>n))}getLocalViewOfDocuments(e,r,n=zt()){const o=zo();return this.populateOverlays(e,o,r).next(()=>this.computeViews(e,r,o,n).next(s=>{let a=Qi();return s.forEach((l,u)=>{a=a.insert(l,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=zo();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,zt()))}populateOverlays(e,r,n){const o=[];return n.forEach(s=>{r.has(s)||o.push(s)}),this.documentOverlayCache.getOverlays(e,o).next(s=>{s.forEach((a,l)=>{r.set(a,l)})})}computeViews(e,r,n,o){let s=Zn();const a=ss(),l=function(){return ss()}();return r.forEach((u,h)=>{const m=n.get(h.key);o.has(h.key)&&(m===void 0||m.mutation instanceof Io)?s=s.insert(h.key,h):m!==void 0?(a.set(h.key,m.mutation.getFieldMask()),as(m.mutation,h,m.mutation.getFieldMask(),lr.now())):a.set(h.key,on.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((h,m)=>a.set(h,m)),r.forEach((h,m)=>l.set(h,new KS(m,a.get(h)??null))),l))}recalculateAndSaveOverlays(e,r){const n=ss();let o=new ur((a,l)=>a-l),s=zt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const l of a)l.keys().forEach(u=>{const h=r.get(u);if(h===null)return;let m=n.get(u)||on.empty();m=l.applyToLocalView(h,m),n.set(u,m);const v=(o.get(l.batchId)||zt()).add(u);o=o.insert(l.batchId,v)})}).next(()=>{const a=[],l=o.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,m=u.value,v=Kp();m.forEach(_=>{if(!s.has(_)){const x=tf(r.get(_),n.get(_));x!==null&&v.set(_,x),s=s.add(_)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,v))}return Fe.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,o){return function(a){return ht.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):qp(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,o):this.getDocumentsMatchingCollectionQuery(e,r,n,o)}getNextDocuments(e,r,n,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,o).next(s=>{const a=o-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,o-s.size):Fe.resolve(zo());let l=fs,u=s;return a.next(h=>Fe.forEach(h,(m,v)=>(l<v.largestBatchId&&(l=v.largestBatchId),s.get(m)?Fe.resolve():this.remoteDocumentCache.getEntry(e,m).next(_=>{u=u.insert(m,_)}))).next(()=>this.populateOverlays(e,h,s)).next(()=>this.computeViews(e,u,h,zt())).next(m=>({batchId:l,changes:Yp(m)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new ht(r)).next(n=>{let o=Qi();return n.isFoundDocument()&&(o=o.insert(n.key,n)),o})}getDocumentsMatchingCollectionGroupQuery(e,r,n,o){const s=r.collectionGroup;let a=Qi();return this.indexManager.getCollectionParents(e,s).next(l=>Fe.forEach(l,u=>{const h=function(v,_){return new Ni(_,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)}(r,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,n,o).next(m=>{m.forEach((v,_)=>{a=a.insert(v,_)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,o){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,o))).next(a=>{s.forEach((u,h)=>{const m=h.getKey();a.get(m)===null&&(a=a.insert(m,zr.newInvalidDocument(m)))});let l=Qi();return a.forEach((u,h)=>{const m=s.get(u);m!==void 0&&as(m.mutation,h,on.empty(),lr.now()),dl(r,h)&&(l=l.insert(u,h))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return Fe.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(o){return{id:o.id,version:o.version,createTime:Nn(o.createTime)}}(r)),Fe.resolve()}getNamedQuery(e,r){return Fe.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(o){return{name:o.name,query:BS(o.bundledQuery),readTime:Nn(o.readTime)}}(r)),Fe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XS{constructor(){this.overlays=new ur(ht.comparator),this.qr=new Map}getOverlay(e,r){return Fe.resolve(this.overlays.get(r))}getOverlays(e,r){const n=zo();return Fe.forEach(r,o=>this.getOverlay(e,o).next(s=>{s!==null&&n.set(o,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((o,s)=>{this.St(e,r,s)}),Fe.resolve()}removeOverlaysForBatchId(e,r,n){const o=this.qr.get(n);return o!==void 0&&(o.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(n)),Fe.resolve()}getOverlaysForCollection(e,r,n){const o=zo(),s=r.length+1,a=new ht(r.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!r.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>n&&o.set(u.getKey(),u)}return Fe.resolve(o)}getOverlaysForCollectionGroup(e,r,n,o){let s=new ur((h,m)=>h-m);const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===r&&h.largestBatchId>n){let m=s.get(h.largestBatchId);m===null&&(m=zo(),s=s.insert(h.largestBatchId,m)),m.set(h.getKey(),h)}}const l=zo(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,m)=>l.set(h,m)),!(l.size()>=o)););return Fe.resolve(l)}St(e,r,n){const o=this.overlays.get(n.key);if(o!==null){const a=this.qr.get(o.largestBatchId).delete(n.key);this.qr.set(o.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new fS(r,n));let s=this.qr.get(r);s===void 0&&(s=zt(),this.qr.set(r,s)),this.qr.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS{constructor(){this.sessionToken=Lr.EMPTY_BYTE_STRING}getSessionToken(e){return Fe.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Fe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kd{constructor(){this.Qr=new wr(xr.$r),this.Ur=new wr(xr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new xr(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new xr(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new ht(new sr([])),n=new xr(r,e),o=new xr(r,e+1),s=[];return this.Ur.forEachInRange([n,o],a=>{this.Gr(a),s.push(a.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new ht(new sr([])),n=new xr(r,e),o=new xr(r,e+1);let s=zt();return this.Ur.forEachInRange([n,o],a=>{s=s.add(a.key)}),s}containsKey(e){const r=new xr(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class xr{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return ht.comparator(e.key,r.key)||Ut(e.Yr,r.Yr)}static Kr(e,r){return Ut(e.Yr,r.Yr)||ht.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eP{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new wr(xr.$r)}checkEmpty(e){return Fe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,o){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new pS(s,r,n,o);this.mutationQueue.push(a);for(const l of o)this.Zr=this.Zr.add(new xr(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Fe.resolve(a)}lookupMutationBatch(e,r){return Fe.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,o=this.ei(n),s=o<0?0:o;return Fe.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Fe.resolve(this.mutationQueue.length===0?Sd:this.tr-1)}getAllMutationBatches(e){return Fe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new xr(r,0),o=new xr(r,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([n,o],a=>{const l=this.Xr(a.Yr);s.push(l)}),Fe.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new wr(Ut);return r.forEach(o=>{const s=new xr(o,0),a=new xr(o,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,a],l=>{n=n.add(l.Yr)})}),Fe.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,o=n.length+1;let s=n;ht.isDocumentKey(s)||(s=s.child(""));const a=new xr(new ht(s),0);let l=new wr(Ut);return this.Zr.forEachWhile(u=>{const h=u.key.path;return!!n.isPrefixOf(h)&&(h.length===o&&(l=l.add(u.Yr)),!0)},a),Fe.resolve(this.ti(l))}ti(e){const r=[];return e.forEach(n=>{const o=this.Xr(n);o!==null&&r.push(o)}),r}removeMutationBatch(e,r){tr(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return Fe.forEach(r.mutations,o=>{const s=new xr(o.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new xr(r,0),o=this.Zr.firstAfterOrEqual(n);return Fe.resolve(r.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,Fe.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{constructor(e){this.ri=e,this.docs=function(){return new ur(ht.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,o=this.docs.get(n),s=o?o.size:0,a=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Fe.resolve(n?n.document.mutableCopy():zr.newInvalidDocument(r))}getEntries(e,r){let n=Zn();return r.forEach(o=>{const s=this.docs.get(o);n=n.insert(o,s?s.document.mutableCopy():zr.newInvalidDocument(o))}),Fe.resolve(n)}getDocumentsMatchingQuery(e,r,n,o){let s=Zn();const a=r.path,l=new ht(a.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:m}}=u.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||T1(E1(m),n)<=0||(o.has(m.key)||dl(r,m))&&(s=s.insert(m.key,m.mutableCopy()))}return Fe.resolve(s)}getAllFromCollectionGroup(e,r,n,o){gt(9500)}ii(e,r){return Fe.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new rP(this)}getSize(e){return Fe.resolve(this.size)}}class rP extends YS{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,o)=>{o.isValidDocument()?r.push(this.Nr.addEntry(e,o)):this.Nr.removeEntry(n)}),Fe.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nP{constructor(e){this.persistence=e,this.si=new Jo(r=>Cd(r),xd),this.lastRemoteSnapshotVersion=Pt.min(),this.highestTargetId=0,this.oi=0,this._i=new kd,this.targetCount=0,this.ai=xi.ur()}forEachTarget(e,r){return this.si.forEach((n,o)=>r(o)),Fe.resolve()}getLastRemoteSnapshotVersion(e){return Fe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Fe.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Fe.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),Fe.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new xi(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,Fe.resolve()}updateTargetData(e,r){return this.Pr(r),Fe.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,Fe.resolve()}removeTargets(e,r,n){let o=0;const s=[];return this.si.forEach((a,l)=>{l.sequenceNumber<=r&&n.get(l.targetId)===null&&(this.si.delete(a),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),o++)}),Fe.waitFor(s).next(()=>o)}getTargetCount(e){return Fe.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return Fe.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),Fe.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const o=this.persistence.referenceDelegate,s=[];return o&&r.forEach(a=>{s.push(o.markPotentiallyOrphaned(e,a))}),Fe.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),Fe.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return Fe.resolve(n)}containsKey(e,r){return Fe.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff{constructor(e,r){this.ui={},this.overlays={},this.ci=new sl(0),this.li=!1,this.li=!0,this.hi=new ZS,this.referenceDelegate=e(this),this.Pi=new nP(this),this.indexManager=new US,this.remoteDocumentCache=function(o){return new tP(o)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new VS(r),this.Ii=new JS(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new XS,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new eP(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){it("MemoryPersistence","Starting transaction:",e);const o=new oP(this.ci.next());return this.referenceDelegate.Ei(),n(o).next(s=>this.referenceDelegate.di(o).next(()=>s)).toPromise().then(s=>(o.raiseOnCommittedEvent(),s))}Ai(e,r){return Fe.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class oP extends R1{constructor(e){super(),this.currentSequenceNumber=e}}class Rd{constructor(e){this.persistence=e,this.Ri=new kd,this.Vi=null}static mi(e){return new Rd(e)}get fi(){if(this.Vi)return this.Vi;throw gt(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),Fe.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),Fe.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),Fe.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(o=>this.fi.add(o.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(o=>{o.forEach(s=>this.fi.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Fe.forEach(this.fi,n=>{const o=ht.fromPath(n);return this.gi(e,o).next(s=>{s||r.removeEntry(o,Pt.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return Fe.or([()=>Fe.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class Wa{constructor(e,r){this.persistence=e,this.pi=new Jo(n=>L1(n.path),(n,o)=>n.isEqual(o)),this.garbageCollector=WS(this,r)}static mi(e,r){return new Wa(e,r)}Ei(){}di(e){return Fe.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(o=>n+o))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return Fe.forEach(this.pi,(n,o)=>this.br(e,n,o).next(s=>s?Fe.resolve():r(o)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const o=this.persistence.getRemoteDocumentCache(),s=o.newChangeBuffer();return o.ii(e,a=>this.br(e,a,r).next(l=>{l||(n++,s.removeEntry(a,Pt.min()))})).next(()=>s.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),Fe.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Fe.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Fe.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),Fe.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=ba(e.data.value)),r}br(e,r,n){return Fe.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const o=this.pi.get(r);return Fe.resolve(o!==void 0&&o>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dd{constructor(e,r,n,o){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=o}static As(e,r){let n=zt(),o=zt();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:o=o.add(s.doc.key)}return new Dd(e,r.fromCache,n,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return Qv()?8:D1(Gr())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,o){const s={result:null};return this.ys(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ws(e,r,o,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new iP;return this.Ss(e,r,a).next(l=>{if(s.result=l,this.Vs)return this.bs(e,r,a,l.size)})}).next(()=>s.result)}bs(e,r,n,o){return n.documentReadCount<this.fs?(ci()<=Bt.DEBUG&&it("QueryEngine","SDK will not create cache indexes for query:",di(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Fe.resolve()):(ci()<=Bt.DEBUG&&it("QueryEngine","Query:",di(r),"scans",n.documentReadCount,"local documents and returns",o,"documents as results."),n.documentReadCount>this.gs*o?(ci()<=Bt.DEBUG&&it("QueryEngine","The SDK decides to create cache indexes for query:",di(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Rn(r))):Fe.resolve())}ys(e,r){if(Eh(r))return Fe.resolve(null);let n=Rn(r);return this.indexManager.getIndexType(e,n).next(o=>o===0?null:(r.limit!==null&&o===1&&(r=Oc(r,null,"F"),n=Rn(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=zt(...s);return this.ps.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,n).next(u=>{const h=this.Ds(r,l);return this.Cs(r,h,a,u.readTime)?this.ys(e,Oc(r,null,"F")):this.vs(e,h,r,u)}))})))}ws(e,r,n,o){return Eh(r)||o.isEqual(Pt.min())?Fe.resolve(null):this.ps.getDocuments(e,n).next(s=>{const a=this.Ds(r,s);return this.Cs(r,a,n,o)?Fe.resolve(null):(ci()<=Bt.DEBUG&&it("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),di(r)),this.vs(e,a,r,I1(o,fs)).next(l=>l))})}Ds(e,r){let n=new wr(Hp(e));return r.forEach((o,s)=>{dl(e,s)&&(n=n.add(s))}),n}Cs(e,r,n,o){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(o)>0)}Ss(e,r,n){return ci()<=Bt.DEBUG&&it("QueryEngine","Using full collection scan to execute query:",di(r)),this.ps.getDocumentsMatchingQuery(e,r,bo.min(),n)}vs(e,r,n,o){return this.ps.getDocumentsMatchingQuery(e,n,o).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nd="LocalStore",aP=3e8;class lP{constructor(e,r,n,o){this.persistence=e,this.Fs=r,this.serializer=o,this.Ms=new ur(Ut),this.xs=new Jo(s=>Cd(s),xd),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new QS(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function cP(t,e,r,n){return new lP(t,e,r,n)}async function gf(t,e){const r=$t(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let o;return r.mutationQueue.getAllMutationBatches(n).next(s=>(o=s,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],l=[];let u=zt();for(const h of o){a.push(h.batchId);for(const m of h.mutations)u=u.add(m.key)}for(const h of s){l.push(h.batchId);for(const m of h.mutations)u=u.add(m.key)}return r.localDocuments.getDocuments(n,u).next(h=>({Ls:h,removedBatchIds:a,addedBatchIds:l}))})})}function dP(t,e){const r=$t(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const o=e.batch.keys(),s=r.Ns.newChangeBuffer({trackRemovals:!0});return function(l,u,h,m){const v=h.batch,_=v.keys();let x=Fe.resolve();return _.forEach(T=>{x=x.next(()=>m.getEntry(u,T)).next(E=>{const P=h.docVersions.get(T);tr(P!==null,48541),E.version.compareTo(P)<0&&(v.applyToRemoteDocument(E,h),E.isValidDocument()&&(E.setReadTime(h.commitVersion),m.addEntry(E)))})}),x.next(()=>l.mutationQueue.removeMutationBatch(u,v))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,o,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let u=zt();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u}(e))).next(()=>r.localDocuments.getDocuments(n,o))})}function vf(t){const e=$t(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function uP(t,e){const r=$t(t),n=e.snapshotVersion;let o=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.Ns.newChangeBuffer({trackRemovals:!0});o=r.Ms;const l=[];e.targetChanges.forEach((m,v)=>{const _=o.get(v);if(!_)return;l.push(r.Pi.removeMatchingKeys(s,m.removedDocuments,v).next(()=>r.Pi.addMatchingKeys(s,m.addedDocuments,v)));let x=_.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(v)!==null?x=x.withResumeToken(Lr.EMPTY_BYTE_STRING,Pt.min()).withLastLimboFreeSnapshotVersion(Pt.min()):m.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(m.resumeToken,n)),o=o.insert(v,x),function(E,P,R){return E.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=aP?!0:R.addedDocuments.size+R.modifiedDocuments.size+R.removedDocuments.size>0}(_,x,m)&&l.push(r.Pi.updateTargetData(s,x))});let u=Zn(),h=zt();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&l.push(r.persistence.referenceDelegate.updateLimboDocument(s,m))}),l.push(hP(s,a,e.documentUpdates).next(m=>{u=m.ks,h=m.qs})),!n.isEqual(Pt.min())){const m=r.Pi.getLastRemoteSnapshotVersion(s).next(v=>r.Pi.setTargetsMetadata(s,s.currentSequenceNumber,n));l.push(m)}return Fe.waitFor(l).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,u,h)).next(()=>u)}).then(s=>(r.Ms=o,s))}function hP(t,e,r){let n=zt(),o=zt();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let a=Zn();return r.forEach((l,u)=>{const h=s.get(l);u.isFoundDocument()!==h.isFoundDocument()&&(o=o.add(l)),u.isNoDocument()&&u.version.isEqual(Pt.min())?(e.removeEntry(l,u.readTime),a=a.insert(l,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),a=a.insert(l,u)):it(Nd,"Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",u.version)}),{ks:a,qs:o}})}function mP(t,e){const r=$t(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Sd),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function yP(t,e){const r=$t(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let o;return r.Pi.getTargetData(n,e).next(s=>s?(o=s,Fe.resolve(o)):r.Pi.allocateTargetId(n).next(a=>(o=new uo(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,o).next(()=>o))))}).then(n=>{const o=r.Ms.get(n.targetId);return(o===null||n.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function zc(t,e,r){const n=$t(t),o=n.Ms.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,o))}catch(a){if(!Di(a))throw a;it(Nd,`Failed to update sequence numbers for target ${e}: ${a}`)}n.Ms=n.Ms.remove(e),n.xs.delete(o.target)}function zh(t,e,r){const n=$t(t);let o=Pt.min(),s=zt();return n.persistence.runTransaction("Execute query","readwrite",a=>function(u,h,m){const v=$t(u),_=v.xs.get(m);return _!==void 0?Fe.resolve(v.Ms.get(_)):v.Pi.getTargetData(h,m)}(n,a,Rn(e)).next(l=>{if(l)return o=l.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(a,l.targetId).next(u=>{s=u})}).next(()=>n.Fs.getDocumentsMatchingQuery(a,e,r?o:Pt.min(),r?s:zt())).next(l=>(pP(n,eS(e),l),{documents:l,Qs:s})))}function pP(t,e,r){let n=t.Os.get(e)||Pt.min();r.forEach((o,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.Os.set(e,n)}class jh{constructor(){this.activeTargetIds=sS()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class fP{constructor(){this.Mo=new jh,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new jh,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gP{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qh="ConnectivityMonitor";class Gh{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){it(qh,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){it(qh,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ea=null;function jc(){return ea===null?ea=function(){return 268435456+Math.round(2147483648*Math.random())}():ea++,"0x"+ea.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gl="RestConnection",vP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class bP{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${o}`,this.Wo=this.databaseId.database===Ua?`project_id=${n}`:`project_id=${n}&database_id=${o}`}Go(e,r,n,o,s){const a=jc(),l=this.zo(e,r.toUriEncodedString());it(Gl,`Sending RPC '${e}' ${a}:`,l,n);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,o,s);const{host:h}=new URL(l),m=Ii(h);return this.Jo(e,l,u,n,m).then(v=>(it(Gl,`Received RPC '${e}' ${a}: `,v),v),v=>{throw Si(Gl,`RPC '${e}' ${a} failed with error: `,v,"url: ",l,"request:",n),v})}Ho(e,r,n,o,s,a){return this.Go(e,r,n,o,s)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ki}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,s)=>e[s]=o),n&&n.headers.forEach((o,s)=>e[s]=o)}zo(e,r){const n=vP[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _P{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vr="WebChannelConnection";class SP extends bP{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,o,s){const a=jc();return new Promise((l,u)=>{const h=new bp;h.setWithCredentials(!0),h.listenOnce(_p.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case va.NO_ERROR:const v=h.getResponseJson();it(Vr,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(v)),l(v);break;case va.TIMEOUT:it(Vr,`RPC '${e}' ${a} timed out`),u(new nt(Me.DEADLINE_EXCEEDED,"Request time out"));break;case va.HTTP_ERROR:const _=h.getStatus();if(it(Vr,`RPC '${e}' ${a} failed with status:`,_,"response text:",h.getResponseText()),_>0){let x=h.getResponseJson();Array.isArray(x)&&(x=x[0]);const T=x?.error;if(T&&T.status&&T.message){const E=function(R){const Y=R.toLowerCase().replace(/_/g,"-");return Object.values(Me).indexOf(Y)>=0?Y:Me.UNKNOWN}(T.status);u(new nt(E,T.message))}else u(new nt(Me.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new nt(Me.UNAVAILABLE,"Connection failed."));break;default:gt(9055,{l_:e,streamId:a,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{it(Vr,`RPC '${e}' ${a} completed.`)}});const m=JSON.stringify(o);it(Vr,`RPC '${e}' ${a} sending request:`,o),h.send(r,"POST",m,n,15)})}T_(e,r,n){const o=jc(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=wp(),l=Pp(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,r,n),u.encodeInitMessageHeaders=!0;const m=s.join("");it(Vr,`Creating RPC '${e}' stream ${o}: ${m}`,u);const v=a.createWebChannel(m,u);this.I_(v);let _=!1,x=!1;const T=new _P({Yo:P=>{x?it(Vr,`Not sending because RPC '${e}' stream ${o} is closed:`,P):(_||(it(Vr,`Opening RPC '${e}' stream ${o} transport.`),v.open(),_=!0),it(Vr,`RPC '${e}' stream ${o} sending:`,P),v.send(P))},Zo:()=>v.close()}),E=(P,R,Y)=>{P.listen(R,Z=>{try{Y(Z)}catch(j){setTimeout(()=>{throw j},0)}})};return E(v,Ki.EventType.OPEN,()=>{x||(it(Vr,`RPC '${e}' stream ${o} transport opened.`),T.o_())}),E(v,Ki.EventType.CLOSE,()=>{x||(x=!0,it(Vr,`RPC '${e}' stream ${o} transport closed`),T.a_(),this.E_(v))}),E(v,Ki.EventType.ERROR,P=>{x||(x=!0,Si(Vr,`RPC '${e}' stream ${o} transport errored. Name:`,P.name,"Message:",P.message),T.a_(new nt(Me.UNAVAILABLE,"The operation could not be completed")))}),E(v,Ki.EventType.MESSAGE,P=>{if(!x){const R=P.data[0];tr(!!R,16349);const Y=R,Z=Y?.error||Y[0]?.error;if(Z){it(Vr,`RPC '${e}' stream ${o} received error:`,Z);const j=Z.status;let B=function(g){const S=br[g];if(S!==void 0)return of(S)}(j),V=Z.message;B===void 0&&(B=Me.INTERNAL,V="Unknown error status: "+j+" with message "+Z.message),x=!0,T.a_(new nt(B,V)),v.close()}else it(Vr,`RPC '${e}' stream ${o} received:`,R),T.u_(R)}}),E(l,Sp.STAT_EVENT,P=>{P.stat===Tc.PROXY?it(Vr,`RPC '${e}' stream ${o} detected buffering proxy`):P.stat===Tc.NOPROXY&&it(Vr,`RPC '${e}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{T.__()},0),T}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function Hl(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yl(t){return new xS(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{constructor(e,r,n=1e3,o=1.5,s=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=o,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),o=Math.max(0,r-n);o>0&&it("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,o,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hh="PersistentStream";class _f{constructor(e,r,n,o,s,a,l,u){this.Mi=e,this.S_=n,this.b_=o,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new bf(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===Me.RESOURCE_EXHAUSTED?(Jn(r.toString()),Jn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===Me.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,o])=>{this.D_===r&&this.G_(n,o)},n=>{e(()=>{const o=new nt(Me.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(o)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(o=>{n(()=>this.z_(o))}),this.stream.onMessage(o=>{n(()=>++this.F_==1?this.J_(o):this.onNext(o))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return it(Hh,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(it(Hh,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class PP extends _f{constructor(e,r,n,o,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,o,a),this.serializer=s}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=IS(this.serializer,e),n=function(s){if(!("targetChange"in s))return Pt.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Pt.min():a.readTime?Nn(a.readTime):Pt.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=Uc(this.serializer),r.addTarget=function(s,a){let l;const u=a.target;if(l=Lc(u)?{documents:kS(s,u)}:{query:RS(s,u).ft},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=lf(s,a.resumeToken);const h=Fc(s,a.expectedCount);h!==null&&(l.expectedCount=h)}else if(a.snapshotVersion.compareTo(Pt.min())>0){l.readTime=Ha(s,a.snapshotVersion.toTimestamp());const h=Fc(s,a.expectedCount);h!==null&&(l.expectedCount=h)}return l}(this.serializer,e);const n=NS(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=Uc(this.serializer),r.removeTarget=e,this.q_(r)}}class wP extends _f{constructor(e,r,n,o,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,o,a),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return tr(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,tr(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){tr(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=TS(e.writeResults,e.commitTime),n=Nn(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=Uc(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>ES(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CP{}class xP extends CP{constructor(e,r,n,o){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new nt(Me.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Go(e,Vc(r,n),o,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new nt(Me.UNKNOWN,s.toString())})}Ho(e,r,n,o,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Ho(e,Vc(r,n),o,a,l,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new nt(Me.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class $P{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Jn(r),this.aa=!1):it("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ko="RemoteStore";class AP{constructor(e,r,n,o,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(a=>{n.enqueueAndForget(async()=>{Xo(this)&&(it(Ko,"Restarting streams for network reachability change."),await async function(u){const h=$t(u);h.Ea.add(4),await Ns(h),h.Ra.set("Unknown"),h.Ea.delete(4),await pl(h)}(this))})}),this.Ra=new $P(n,o)}}async function pl(t){if(Xo(t))for(const e of t.da)await e(!0)}async function Ns(t){for(const e of t.da)await e(!1)}function Sf(t,e){const r=$t(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),Fd(r)?Od(r):Li(r).O_()&&Md(r,e))}function Ld(t,e){const r=$t(t),n=Li(r);r.Ia.delete(e),n.O_()&&Pf(r,e),r.Ia.size===0&&(n.O_()?n.L_():Xo(r)&&r.Ra.set("Unknown"))}function Md(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Pt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Li(t).Y_(e)}function Pf(t,e){t.Va.Ue(e),Li(t).Z_(e)}function Od(t){t.Va=new SS({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Li(t).start(),t.Ra.ua()}function Fd(t){return Xo(t)&&!Li(t).x_()&&t.Ia.size>0}function Xo(t){return $t(t).Ea.size===0}function wf(t){t.Va=void 0}async function IP(t){t.Ra.set("Online")}async function EP(t){t.Ia.forEach((e,r)=>{Md(t,e)})}async function TP(t,e){wf(t),Fd(t)?(t.Ra.ha(e),Od(t)):t.Ra.set("Unknown")}async function kP(t,e,r){if(t.Ra.set("Online"),e instanceof af&&e.state===2&&e.cause)try{await async function(o,s){const a=s.cause;for(const l of s.targetIds)o.Ia.has(l)&&(await o.remoteSyncer.rejectListen(l,a),o.Ia.delete(l),o.Va.removeTarget(l))}(t,e)}catch(n){it(Ko,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Ya(t,n)}else if(e instanceof Pa?t.Va.Ze(e):e instanceof sf?t.Va.st(e):t.Va.tt(e),!r.isEqual(Pt.min()))try{const n=await vf(t.localStore);r.compareTo(n)>=0&&await function(s,a){const l=s.Va.Tt(a);return l.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const m=s.Ia.get(h);m&&s.Ia.set(h,m.withResumeToken(u.resumeToken,a))}}),l.targetMismatches.forEach((u,h)=>{const m=s.Ia.get(u);if(!m)return;s.Ia.set(u,m.withResumeToken(Lr.EMPTY_BYTE_STRING,m.snapshotVersion)),Pf(s,u);const v=new uo(m.target,u,h,m.sequenceNumber);Md(s,v)}),s.remoteSyncer.applyRemoteEvent(l)}(t,r)}catch(n){it(Ko,"Failed to raise snapshot:",n),await Ya(t,n)}}async function Ya(t,e,r){if(!Di(e))throw e;t.Ea.add(1),await Ns(t),t.Ra.set("Offline"),r||(r=()=>vf(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{it(Ko,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await pl(t)})}function Cf(t,e){return e().catch(r=>Ya(t,r,e))}async function fl(t){const e=$t(t),r=wo(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Sd;for(;RP(e);)try{const o=await mP(e.localStore,n);if(o===null){e.Ta.length===0&&r.L_();break}n=o.batchId,DP(e,o)}catch(o){await Ya(e,o)}xf(e)&&$f(e)}function RP(t){return Xo(t)&&t.Ta.length<10}function DP(t,e){t.Ta.push(e);const r=wo(t);r.O_()&&r.X_&&r.ea(e.mutations)}function xf(t){return Xo(t)&&!wo(t).x_()&&t.Ta.length>0}function $f(t){wo(t).start()}async function NP(t){wo(t).ra()}async function LP(t){const e=wo(t);for(const r of t.Ta)e.ea(r.mutations)}async function MP(t,e,r){const n=t.Ta.shift(),o=Id.from(n,e,r);await Cf(t,()=>t.remoteSyncer.applySuccessfulWrite(o)),await fl(t)}async function OP(t,e){e&&wo(t).X_&&await async function(n,o){if(function(a){return vS(a)&&a!==Me.ABORTED}(o.code)){const s=n.Ta.shift();wo(n).B_(),await Cf(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,o)),await fl(n)}}(t,e),xf(t)&&$f(t)}async function Wh(t,e){const r=$t(t);r.asyncQueue.verifyOperationInProgress(),it(Ko,"RemoteStore received new credentials");const n=Xo(r);r.Ea.add(3),await Ns(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await pl(r)}async function FP(t,e){const r=$t(t);e?(r.Ea.delete(2),await pl(r)):e||(r.Ea.add(2),await Ns(r),r.Ra.set("Unknown"))}function Li(t){return t.ma||(t.ma=function(r,n,o){const s=$t(r);return s.sa(),new PP(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,o)}(t.datastore,t.asyncQueue,{Xo:IP.bind(null,t),t_:EP.bind(null,t),r_:TP.bind(null,t),H_:kP.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Fd(t)?Od(t):t.Ra.set("Unknown")):(await t.ma.stop(),wf(t))})),t.ma}function wo(t){return t.fa||(t.fa=function(r,n,o){const s=$t(r);return s.sa(),new wP(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,o)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:NP.bind(null,t),r_:OP.bind(null,t),ta:LP.bind(null,t),na:MP.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await fl(t)):(await t.fa.stop(),t.Ta.length>0&&(it(Ko,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vd{constructor(e,r,n,o,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=o,this.removalCallback=s,this.deferred=new Yn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,o,s){const a=Date.now()+n,l=new Vd(e,r,a,o,s);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new nt(Me.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Bd(t,e){if(Jn("AsyncQueue",`${e}: ${t}`),Di(t))return new nt(Me.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{static emptySet(e){return new gi(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||ht.comparator(r.key,n.key):(r,n)=>ht.comparator(r.key,n.key),this.keyedMap=Qi(),this.sortedSet=new ur(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof gi)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const o=r.getNext().key,s=n.getNext().key;if(!o.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new gi;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(){this.ga=new ur(ht.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):gt(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class $i{constructor(e,r,n,o,s,a,l,u,h){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=o,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,r,n,o,s){const a=[];return r.forEach(l=>{a.push({type:0,doc:l})}),new $i(e,r,gi.emptySet(r),a,n,o,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&cl(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let o=0;o<r.length;o++)if(r[o].type!==n[o].type||!r[o].doc.isEqual(n[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class BP{constructor(){this.queries=Kh(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const o=$t(r),s=o.queries;o.queries=Kh(),s.forEach((a,l)=>{for(const u of l.Sa)u.onError(n)})})(this,new nt(Me.ABORTED,"Firestore shutting down"))}}function Kh(){return new Jo(t=>Gp(t),cl)}async function Af(t,e){const r=$t(t);let n=3;const o=e.query;let s=r.queries.get(o);s?!s.ba()&&e.Da()&&(n=2):(s=new VP,n=e.Da()?0:1);try{switch(n){case 0:s.wa=await r.onListen(o,!0);break;case 1:s.wa=await r.onListen(o,!1);break;case 2:await r.onFirstRemoteStoreListen(o)}}catch(a){const l=Bd(a,`Initialization of query '${di(e.query)}' failed`);return void e.onError(l)}r.queries.set(o,s),s.Sa.push(e),e.va(r.onlineState),s.wa&&e.Fa(s.wa)&&Ud(r)}async function If(t,e){const r=$t(t),n=e.query;let o=3;const s=r.queries.get(n);if(s){const a=s.Sa.indexOf(e);a>=0&&(s.Sa.splice(a,1),s.Sa.length===0?o=e.Da()?0:1:!s.ba()&&e.Da()&&(o=2))}switch(o){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function UP(t,e){const r=$t(t);let n=!1;for(const o of e){const s=o.query,a=r.queries.get(s);if(a){for(const l of a.Sa)l.Fa(o)&&(n=!0);a.wa=o}}n&&Ud(r)}function zP(t,e,r){const n=$t(t),o=n.queries.get(e);if(o)for(const s of o.Sa)s.onError(r);n.queries.delete(e)}function Ud(t){t.Ca.forEach(e=>{e.next()})}var qc,Qh;(Qh=qc||(qc={})).Ma="default",Qh.Cache="cache";class Ef{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const o of e.docChanges)o.type!==3&&n.push(o);e=new $i(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=$i.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==qc.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf{constructor(e){this.key=e}}class kf{constructor(e){this.key=e}}class jP{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=zt(),this.mutatedKeys=zt(),this.eu=Hp(e),this.tu=new gi(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new Yh,o=r?r.tu:this.tu;let s=r?r.mutatedKeys:this.mutatedKeys,a=o,l=!1;const u=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,h=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal((m,v)=>{const _=o.get(m),x=dl(this.query,v)?v:null,T=!!_&&this.mutatedKeys.has(_.key),E=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let P=!1;_&&x?_.data.isEqual(x.data)?T!==E&&(n.track({type:3,doc:x}),P=!0):this.su(_,x)||(n.track({type:2,doc:x}),P=!0,(u&&this.eu(x,u)>0||h&&this.eu(x,h)<0)&&(l=!0)):!_&&x?(n.track({type:0,doc:x}),P=!0):_&&!x&&(n.track({type:1,doc:_}),P=!0,(u||h)&&(l=!0)),P&&(x?(a=a.add(x),s=E?s.add(m):s.delete(m)):(a=a.delete(m),s=s.delete(m)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const m=this.query.limitType==="F"?a.last():a.first();a=a.delete(m.key),s=s.delete(m.key),n.track({type:1,doc:m})}return{tu:a,iu:n,Cs:l,mutatedKeys:s}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,o){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((m,v)=>function(x,T){const E=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return gt(20277,{Rt:P})}};return E(x)-E(T)}(m.type,v.type)||this.eu(m.doc,v.doc)),this.ou(n),o=o??!1;const l=r&&!o?this._u():[],u=this.Xa.size===0&&this.current&&!o?1:0,h=u!==this.Za;return this.Za=u,a.length!==0||h?{snapshot:new $i(this.query,e.tu,s,a,e.mutatedKeys,u===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Yh,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=zt(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new kf(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new Tf(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=zt();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return $i.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const zd="SyncEngine";class qP{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class GP{constructor(e){this.key=e,this.hu=!1}}class HP{constructor(e,r,n,o,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=o,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Jo(l=>Gp(l),cl),this.Iu=new Map,this.Eu=new Set,this.du=new ur(ht.comparator),this.Au=new Map,this.Ru=new kd,this.Vu={},this.mu=new Map,this.fu=xi.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function WP(t,e,r=!0){const n=Of(t);let o;const s=n.Tu.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),o=s.view.lu()):o=await Rf(n,e,r,!0),o}async function YP(t,e){const r=Of(t);await Rf(r,e,!0,!1)}async function Rf(t,e,r,n){const o=await yP(t.localStore,Rn(e)),s=o.targetId,a=t.sharedClientState.addLocalQueryTarget(s,r);let l;return n&&(l=await KP(t,e,s,a==="current",o.resumeToken)),t.isPrimaryClient&&r&&Sf(t.remoteStore,o),l}async function KP(t,e,r,n,o){t.pu=(v,_,x)=>async function(E,P,R,Y){let Z=P.view.ru(R);Z.Cs&&(Z=await zh(E.localStore,P.query,!1).then(({documents:f})=>P.view.ru(f,Z)));const j=Y&&Y.targetChanges.get(P.targetId),B=Y&&Y.targetMismatches.get(P.targetId)!=null,V=P.view.applyChanges(Z,E.isPrimaryClient,j,B);return Xh(E,P.targetId,V.au),V.snapshot}(t,v,_,x);const s=await zh(t.localStore,e,!0),a=new jP(e,s.Qs),l=a.ru(s.documents),u=Ds.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",o),h=a.applyChanges(l,t.isPrimaryClient,u);Xh(t,r,h.au);const m=new qP(e,r,a);return t.Tu.set(e,m),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),h.snapshot}async function QP(t,e,r){const n=$t(t),o=n.Tu.get(e),s=n.Iu.get(o.targetId);if(s.length>1)return n.Iu.set(o.targetId,s.filter(a=>!cl(a,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(o.targetId),n.sharedClientState.isActiveQueryTarget(o.targetId)||await zc(n.localStore,o.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(o.targetId),r&&Ld(n.remoteStore,o.targetId),Gc(n,o.targetId)}).catch(Ri)):(Gc(n,o.targetId),await zc(n.localStore,o.targetId,!0))}async function JP(t,e){const r=$t(t),n=r.Tu.get(e),o=r.Iu.get(n.targetId);r.isPrimaryClient&&o.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Ld(r.remoteStore,n.targetId))}async function XP(t,e,r){const n=iw(t);try{const o=await function(a,l){const u=$t(a),h=lr.now(),m=l.reduce((x,T)=>x.add(T.key),zt());let v,_;return u.persistence.runTransaction("Locally write mutations","readwrite",x=>{let T=Zn(),E=zt();return u.Ns.getEntries(x,m).next(P=>{T=P,T.forEach((R,Y)=>{Y.isValidDocument()||(E=E.add(R))})}).next(()=>u.localDocuments.getOverlayedDocuments(x,T)).next(P=>{v=P;const R=[];for(const Y of l){const Z=mS(Y,v.get(Y.key).overlayedDocument);Z!=null&&R.push(new Io(Y.key,Z,Op(Z.value.mapValue),Dn.exists(!0)))}return u.mutationQueue.addMutationBatch(x,h,R,l)}).next(P=>{_=P;const R=P.applyToLocalDocumentSet(v,E);return u.documentOverlayCache.saveOverlays(x,P.batchId,R)})}).then(()=>({batchId:_.batchId,changes:Yp(v)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(o.batchId),function(a,l,u){let h=a.Vu[a.currentUser.toKey()];h||(h=new ur(Ut)),h=h.insert(l,u),a.Vu[a.currentUser.toKey()]=h}(n,o.batchId,r),await Ls(n,o.changes),await fl(n.remoteStore)}catch(o){const s=Bd(o,"Failed to persist write");r.reject(s)}}async function Df(t,e){const r=$t(t);try{const n=await uP(r.localStore,e);e.targetChanges.forEach((o,s)=>{const a=r.Au.get(s);a&&(tr(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?a.hu=!0:o.modifiedDocuments.size>0?tr(a.hu,14607):o.removedDocuments.size>0&&(tr(a.hu,42227),a.hu=!1))}),await Ls(r,n,e)}catch(n){await Ri(n)}}function Jh(t,e,r){const n=$t(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const o=[];n.Tu.forEach((s,a)=>{const l=a.view.va(e);l.snapshot&&o.push(l.snapshot)}),function(a,l){const u=$t(a);u.onlineState=l;let h=!1;u.queries.forEach((m,v)=>{for(const _ of v.Sa)_.va(l)&&(h=!0)}),h&&Ud(u)}(n.eventManager,e),o.length&&n.Pu.H_(o),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function ZP(t,e,r){const n=$t(t);n.sharedClientState.updateQueryState(e,"rejected",r);const o=n.Au.get(e),s=o&&o.key;if(s){let a=new ur(ht.comparator);a=a.insert(s,zr.newNoDocument(s,Pt.min()));const l=zt().add(s),u=new ml(Pt.min(),new Map,new ur(Ut),a,l);await Df(n,u),n.du=n.du.remove(s),n.Au.delete(e),jd(n)}else await zc(n.localStore,e,!1).then(()=>Gc(n,e,r)).catch(Ri)}async function ew(t,e){const r=$t(t),n=e.batch.batchId;try{const o=await dP(r.localStore,e);Lf(r,n,null),Nf(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Ls(r,o)}catch(o){await Ri(o)}}async function tw(t,e,r){const n=$t(t);try{const o=await function(a,l){const u=$t(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let m;return u.mutationQueue.lookupMutationBatch(h,l).next(v=>(tr(v!==null,37113),m=v.keys(),u.mutationQueue.removeMutationBatch(h,v))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,m,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,m)).next(()=>u.localDocuments.getDocuments(h,m))})}(n.localStore,e);Lf(n,e,r),Nf(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Ls(n,o)}catch(o){await Ri(o)}}function Nf(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function Lf(t,e,r){const n=$t(t);let o=n.Vu[n.currentUser.toKey()];if(o){const s=o.get(e);s&&(r?s.reject(r):s.resolve(),o=o.remove(e)),n.Vu[n.currentUser.toKey()]=o}}function Gc(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||Mf(t,n)})}function Mf(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(Ld(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),jd(t))}function Xh(t,e,r){for(const n of r)n instanceof Tf?(t.Ru.addReference(n.key,e),rw(t,n)):n instanceof kf?(it(zd,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||Mf(t,n.key)):gt(19791,{wu:n})}function rw(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(it(zd,"New document in limbo: "+r),t.Eu.add(n),jd(t))}function jd(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new ht(sr.fromString(e)),n=t.fu.next();t.Au.set(n,new GP(r)),t.du=t.du.insert(r,n),Sf(t.remoteStore,new uo(Rn($d(r.path)),n,"TargetPurposeLimboResolution",sl.ce))}}async function Ls(t,e,r){const n=$t(t),o=[],s=[],a=[];n.Tu.isEmpty()||(n.Tu.forEach((l,u)=>{a.push(n.pu(u,e,r).then(h=>{if((h||r)&&n.isPrimaryClient){const m=h?!h.fromCache:r?.targetChanges.get(u.targetId)?.current;n.sharedClientState.updateQueryState(u.targetId,m?"current":"not-current")}if(h){o.push(h);const m=Dd.As(u.targetId,h);s.push(m)}}))}),await Promise.all(a),n.Pu.H_(o),await async function(u,h){const m=$t(u);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",v=>Fe.forEach(h,_=>Fe.forEach(_.Es,x=>m.persistence.referenceDelegate.addReference(v,_.targetId,x)).next(()=>Fe.forEach(_.ds,x=>m.persistence.referenceDelegate.removeReference(v,_.targetId,x)))))}catch(v){if(!Di(v))throw v;it(Nd,"Failed to update sequence numbers: "+v)}for(const v of h){const _=v.targetId;if(!v.fromCache){const x=m.Ms.get(_),T=x.snapshotVersion,E=x.withLastLimboFreeSnapshotVersion(T);m.Ms=m.Ms.insert(_,E)}}}(n.localStore,s))}async function nw(t,e){const r=$t(t);if(!r.currentUser.isEqual(e)){it(zd,"User change. New user:",e.toKey());const n=await gf(r.localStore,e);r.currentUser=e,function(s,a){s.mu.forEach(l=>{l.forEach(u=>{u.reject(new nt(Me.CANCELLED,a))})}),s.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Ls(r,n.Ls)}}function ow(t,e){const r=$t(t),n=r.Au.get(e);if(n&&n.hu)return zt().add(n.key);{let o=zt();const s=r.Iu.get(e);if(!s)return o;for(const a of s){const l=r.Tu.get(a);o=o.unionWith(l.view.nu)}return o}}function Of(t){const e=$t(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Df.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=ow.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ZP.bind(null,e),e.Pu.H_=UP.bind(null,e.eventManager),e.Pu.yu=zP.bind(null,e.eventManager),e}function iw(t){const e=$t(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ew.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=tw.bind(null,e),e}class Ka{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=yl(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return cP(this.persistence,new sP,e.initialUser,this.serializer)}Cu(e){return new ff(Rd.mi,this.serializer)}Du(e){return new fP}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ka.provider={build:()=>new Ka};class sw extends Ka{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){tr(this.persistence.referenceDelegate instanceof Wa,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new GS(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?Zr.withCacheSize(this.cacheSizeBytes):Zr.DEFAULT;return new ff(n=>Wa.mi(n,r),this.serializer)}}class Hc{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Jh(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=nw.bind(null,this.syncEngine),await FP(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new BP}()}createDatastore(e){const r=yl(e.databaseInfo.databaseId),n=function(s){return new SP(s)}(e.databaseInfo);return function(s,a,l,u){return new xP(s,a,l,u)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,o,s,a,l){return new AP(n,o,s,a,l)}(this.localStore,this.datastore,e.asyncQueue,r=>Jh(this.syncEngine,r,0),function(){return Gh.v()?new Gh:new gP}())}createSyncEngine(e,r){return function(o,s,a,l,u,h,m){const v=new HP(o,s,a,l,u,h);return m&&(v.gu=!0),v}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await async function(r){const n=$t(r);it(Ko,"RemoteStore shutting down."),n.Ea.add(5),await Ns(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Hc.provider={build:()=>new Hc};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Jn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Co="FirestoreClient";class aw{constructor(e,r,n,o,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=o,this.user=Ur.UNAUTHENTICATED,this.clientId=_d.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{it(Co,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(it(Co,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Yn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Bd(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Wl(t,e){t.asyncQueue.verifyOperationInProgress(),it(Co,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async o=>{n.isEqual(o)||(await gf(e.localStore,o),n=o)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Zh(t,e){t.asyncQueue.verifyOperationInProgress();const r=await lw(t);it(Co,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>Wh(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,o)=>Wh(e.remoteStore,o)),t._onlineComponents=e}async function lw(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){it(Co,"Using user provided OfflineComponentProvider");try{await Wl(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(o){return o.name==="FirebaseError"?o.code===Me.FAILED_PRECONDITION||o.code===Me.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11}(r))throw r;Si("Error using user provided cache. Falling back to memory cache: "+r),await Wl(t,new Ka)}}else it(Co,"Using default OfflineComponentProvider"),await Wl(t,new sw(void 0));return t._offlineComponents}async function Vf(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(it(Co,"Using user provided OnlineComponentProvider"),await Zh(t,t._uninitializedComponentsProvider._online)):(it(Co,"Using default OnlineComponentProvider"),await Zh(t,new Hc))),t._onlineComponents}function cw(t){return Vf(t).then(e=>e.syncEngine)}async function Bf(t){const e=await Vf(t),r=e.eventManager;return r.onListen=WP.bind(null,e.syncEngine),r.onUnlisten=QP.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=YP.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=JP.bind(null,e.syncEngine),r}function dw(t,e,r={}){const n=new Yn;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,l,u,h){const m=new Ff({next:_=>{m.Nu(),a.enqueueAndForget(()=>If(s,v));const x=_.docs.has(l);!x&&_.fromCache?h.reject(new nt(Me.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&_.fromCache&&u&&u.source==="server"?h.reject(new nt(Me.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(_)},error:_=>h.reject(_)}),v=new Ef($d(l.path),m,{includeMetadataChanges:!0,qa:!0});return Af(s,v)}(await Bf(t),t.asyncQueue,e,r,n)),n.promise}function uw(t,e,r={}){const n=new Yn;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,l,u,h){const m=new Ff({next:_=>{m.Nu(),a.enqueueAndForget(()=>If(s,v)),_.fromCache&&u.source==="server"?h.reject(new nt(Me.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(_)},error:_=>h.reject(_)}),v=new Ef(l,m,{includeMetadataChanges:!0,qa:!0});return Af(s,v)}(await Bf(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uf(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const em=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zf="firestore.googleapis.com",tm=!0;class rm{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new nt(Me.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=zf,this.ssl=tm}else this.host=e.host,this.ssl=e.ssl??tm;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=pf;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<jS)throw new nt(Me.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}A1("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Uf(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new nt(Me.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new nt(Me.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new nt(Me.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,o){return n.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class gl{constructor(e,r,n,o){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new rm({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new nt(Me.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new nt(Me.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new rm(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new g1;switch(n.type){case"firstParty":return new S1(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new nt(Me.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=em.get(r);n&&(it("ComponentProvider","Removing Datastore"),em.delete(r),n.terminate())}(this),Promise.resolve()}}function hw(t,e,r,n={}){t=Xn(t,gl);const o=Ii(e),s=t._getSettings(),a={...s,emulatorOptions:t._getEmulatorOptions()},l=`${e}:${r}`;o&&(Ty(`https://${l}`),ky("Firestore",!0)),s.host!==zf&&s.host!==l&&Si("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...s,host:l,ssl:o,emulatorOptions:n};if(!Go(u,a)&&(t._setSettings(u),n.mockUserToken)){let h,m;if(typeof n.mockUserToken=="string")h=n.mockUserToken,m=Ur.MOCK_USER;else{h=Uv(n.mockUserToken,t._app?.options.projectId);const v=n.mockUserToken.sub||n.mockUserToken.user_id;if(!v)throw new nt(Me.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new Ur(v)}t._authCredentials=new v1(new xp(h,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Zo(this.firestore,e,this._query)}}class fr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new vo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new fr(this.firestore,e,this._key)}toJSON(){return{type:fr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(ks(r,fr._jsonSchema))return new fr(e,n||null,new ht(sr.fromString(r.referencePath)))}}fr._jsonSchemaVersion="firestore/documentReference/1.0",fr._jsonSchema={type:Sr("string",fr._jsonSchemaVersion),referencePath:Sr("string")};class vo extends Zo{constructor(e,r,n){super(e,r,$d(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new fr(this.firestore,null,new ht(e))}withConverter(e){return new vo(this.firestore,e,this._path)}}function mw(t,e,...r){if(t=Nr(t),$p("collection","path",e),t instanceof gl){const n=sr.fromString(e,...r);return ph(n),new vo(t,null,n)}{if(!(t instanceof fr||t instanceof vo))throw new nt(Me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(sr.fromString(e,...r));return ph(n),new vo(t.firestore,null,n)}}function jf(t,e,...r){if(t=Nr(t),arguments.length===1&&(e=_d.newId()),$p("doc","path",e),t instanceof gl){const n=sr.fromString(e,...r);return yh(n),new fr(t,null,new ht(n))}{if(!(t instanceof fr||t instanceof vo))throw new nt(Me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(sr.fromString(e,...r));return yh(n),new fr(t.firestore,t instanceof vo?t.converter:null,new ht(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nm="AsyncQueue";class om{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new bf(this,"async_queue_retry"),this._c=()=>{const n=Hl();n&&it(nm,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=Hl();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=Hl();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new Yn;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Di(e))throw e;it(nm,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,Jn("INTERNAL UNHANDLED ERROR: ",im(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const o=Vd.createAndSchedule(this,e,r,n,s=>this.hc(s));return this.tc.push(o),o}uc(){this.nc&&gt(47125,{Pc:im(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function im(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Ms extends gl{constructor(e,r,n,o){super(e,r,n,o),this.type="firestore",this._queue=new om,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new om(e),this._firestoreClient=void 0,await e}}}function yw(t,e){const r=typeof t=="object"?t:Ly(),n=typeof t=="string"?t:Ua,o=ld(r,"firestore").getImmediate({identifier:n});if(!o._initialized){const s=Vv("firestore");s&&hw(o,...s)}return o}function qd(t){if(t._terminated)throw new nt(Me.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||pw(t),t._firestoreClient}function pw(t){const e=t._freezeSettings(),r=function(o,s,a,l){return new F1(o,s,a,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,Uf(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)}(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new aw(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(o){const s=o?._online.build();return{_offline:o?._offline.build(s),_online:s}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new pn(Lr.fromBase64String(e))}catch(r){throw new nt(Me.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new pn(Lr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:pn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ks(e,pn._jsonSchema))return pn.fromBase64String(e.bytes)}}pn._jsonSchemaVersion="firestore/bytes/1.0",pn._jsonSchema={type:Sr("string",pn._jsonSchemaVersion),bytes:Sr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vl{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new nt(Me.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new kr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gd{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new nt(Me.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new nt(Me.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ut(this._lat,e._lat)||Ut(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ln._jsonSchemaVersion}}static fromJSON(e){if(ks(e,Ln._jsonSchema))return new Ln(e.latitude,e.longitude)}}Ln._jsonSchemaVersion="firestore/geoPoint/1.0",Ln._jsonSchema={type:Sr("string",Ln._jsonSchemaVersion),latitude:Sr("number"),longitude:Sr("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,o){if(n.length!==o.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==o[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Mn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ks(e,Mn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new Mn(e.vectorValues);throw new nt(Me.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Mn._jsonSchemaVersion="firestore/vectorValue/1.0",Mn._jsonSchema={type:Sr("string",Mn._jsonSchemaVersion),vectorValues:Sr("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fw=/^__.*__$/;class gw{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Io(e,this.data,this.fieldMask,r,this.fieldTransforms):new Rs(e,this.data,r,this.fieldTransforms)}}class qf{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Io(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function Gf(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw gt(40011,{Ac:t})}}class Hd{constructor(e,r,n,o,s,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=o,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Hd({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Qa(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Gf(this.Ac)&&fw.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class vw{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||yl(e)}Cc(e,r,n,o=!1){return new Hd({Ac:e,methodName:r,Dc:n,path:kr.emptyPath(),fc:!1,bc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Wd(t){const e=t._freezeSettings(),r=yl(t._databaseId);return new vw(t._databaseId,!!e.ignoreUndefinedProperties,r)}function bw(t,e,r,n,o,s={}){const a=t.Cc(s.merge||s.mergeFields?2:0,e,r,o);Yd("Data must be an object, but it was:",a,n);const l=Hf(n,a);let u,h;if(s.merge)u=new on(a.fieldMask),h=a.fieldTransforms;else if(s.mergeFields){const m=[];for(const v of s.mergeFields){const _=Wc(e,v,r);if(!a.contains(_))throw new nt(Me.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);Yf(m,_)||m.push(_)}u=new on(m),h=a.fieldTransforms.filter(v=>u.covers(v.field))}else u=null,h=a.fieldTransforms;return new gw(new en(l),u,h)}class bl extends Gd{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof bl}}function _w(t,e,r,n){const o=t.Cc(1,e,r);Yd("Data must be an object, but it was:",o,n);const s=[],a=en.empty();Ao(n,(u,h)=>{const m=Kd(e,u,r);h=Nr(h);const v=o.yc(m);if(h instanceof bl)s.push(m);else{const _=Os(h,v);_!=null&&(s.push(m),a.set(m,_))}});const l=new on(s);return new qf(a,l,o.fieldTransforms)}function Sw(t,e,r,n,o,s){const a=t.Cc(1,e,r),l=[Wc(e,n,r)],u=[o];if(s.length%2!=0)throw new nt(Me.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<s.length;_+=2)l.push(Wc(e,s[_])),u.push(s[_+1]);const h=[],m=en.empty();for(let _=l.length-1;_>=0;--_)if(!Yf(h,l[_])){const x=l[_];let T=u[_];T=Nr(T);const E=a.yc(x);if(T instanceof bl)h.push(x);else{const P=Os(T,E);P!=null&&(h.push(x),m.set(x,P))}}const v=new on(h);return new qf(m,v,a.fieldTransforms)}function Pw(t,e,r,n=!1){return Os(r,t.Cc(n?4:3,e))}function Os(t,e){if(Wf(t=Nr(t)))return Yd("Unsupported field value:",e,t),Hf(t,e);if(t instanceof Gd)return function(n,o){if(!Gf(o.Ac))throw o.Sc(`${n._methodName}() can only be used with update() and set()`);if(!o.path)throw o.Sc(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(o);s&&o.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,o){const s=[];let a=0;for(const l of n){let u=Os(l,o.wc(a));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),a++}return{arrayValue:{values:s}}}(t,e)}return function(n,o){if((n=Nr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return aS(o.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=lr.fromDate(n);return{timestampValue:Ha(o.serializer,s)}}if(n instanceof lr){const s=new lr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Ha(o.serializer,s)}}if(n instanceof Ln)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof pn)return{bytesValue:lf(o.serializer,n._byteString)};if(n instanceof fr){const s=o.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw o.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Td(n.firestore._databaseId||o.databaseId,n._key.path)}}if(n instanceof Mn)return function(a,l){return{mapValue:{fields:{[Lp]:{stringValue:Mp},[za]:{arrayValue:{values:a.toArray().map(h=>{if(typeof h!="number")throw l.Sc("VectorValues must only contain numeric values.");return Ad(l.serializer,h)})}}}}}}(n,o);throw o.Sc(`Unsupported field value: ${il(n)}`)}(t,e)}function Hf(t,e){const r={};return Ep(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ao(t,(n,o)=>{const s=Os(o,e.mc(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function Wf(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof lr||t instanceof Ln||t instanceof pn||t instanceof fr||t instanceof Gd||t instanceof Mn)}function Yd(t,e,r){if(!Wf(r)||!Ap(r)){const n=il(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function Wc(t,e,r){if((e=Nr(e))instanceof vl)return e._internalPath;if(typeof e=="string")return Kd(t,e);throw Qa("Field path arguments must be of type string or ",t,!1,void 0,r)}const ww=new RegExp("[~\\*/\\[\\]]");function Kd(t,e,r){if(e.search(ww)>=0)throw Qa(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new vl(...e.split("."))._internalPath}catch{throw Qa(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Qa(t,e,r,n,o){const s=n&&!n.isEmpty(),a=o!==void 0;let l=`Function ${e}() called with invalid data`;r&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(s||a)&&(u+=" (found",s&&(u+=` in field ${n}`),a&&(u+=` in document ${o}`),u+=")"),new nt(Me.INVALID_ARGUMENT,l+t+u)}function Yf(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kf{constructor(e,r,n,o,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=o,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new fr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Cw(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Qd("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class Cw extends Kf{data(){return super.data()}}function Qd(t,e){return typeof e=="string"?Kd(t,e):e instanceof vl?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xw(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new nt(Me.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Jd{}class Qf extends Jd{}function $w(t,e,...r){let n=[];e instanceof Jd&&n.push(e),n=n.concat(r),function(s){const a=s.filter(u=>u instanceof Zd).length,l=s.filter(u=>u instanceof Xd).length;if(a>1||a>0&&l>0)throw new nt(Me.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const o of n)t=o._apply(t);return t}class Xd extends Qf{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Xd(e,r,n)}_apply(e){const r=this._parse(e);return Jf(e._query,r),new Zo(e.firestore,e.converter,Mc(e._query,r))}_parse(e){const r=Wd(e.firestore);return function(s,a,l,u,h,m,v){let _;if(h.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new nt(Me.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){am(v,m);const T=[];for(const E of v)T.push(sm(u,s,E));_={arrayValue:{values:T}}}else _=sm(u,s,v)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||am(v,m),_=Pw(l,a,v,m==="in"||m==="not-in");return _r.create(h,m,_)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}class Zd extends Jd{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new Zd(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Cn.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(o,s){let a=o;const l=s.getFlattenedFilters();for(const u of l)Jf(a,u),a=Mc(a,u)}(e._query,r),new Zo(e.firestore,e.converter,Mc(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class eu extends Qf{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new eu(e,r)}_apply(e){const r=function(o,s,a){if(o.startAt!==null)throw new nt(Me.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new nt(Me.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new _s(s,a)}(e._query,this._field,this._direction);return new Zo(e.firestore,e.converter,function(o,s){const a=o.explicitOrderBy.concat([s]);return new Ni(o.path,o.collectionGroup,a,o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt)}(e._query,r))}}function Aw(t,e="asc"){const r=e,n=Qd("orderBy",t);return eu._create(n,r)}function sm(t,e,r){if(typeof(r=Nr(r))=="string"){if(r==="")throw new nt(Me.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!qp(e)&&r.indexOf("/")!==-1)throw new nt(Me.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(sr.fromString(r));if(!ht.isDocumentKey(n))throw new nt(Me.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return wh(t,new ht(n))}if(r instanceof fr)return wh(t,r._key);throw new nt(Me.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${il(r)}.`)}function am(t,e){if(!Array.isArray(t)||t.length===0)throw new nt(Me.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Jf(t,e){const r=function(o,s){for(const a of o)for(const l of a.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new nt(Me.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new nt(Me.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class Iw{convertValue(e,r="none"){switch(Po(e)){case 0:return null;case 1:return e.booleanValue;case 2:return pr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(So(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw gt(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Ao(e,(o,s)=>{n[o]=this.convertValue(s,r)}),n}convertVectorValue(e){const r=e.fields?.[za].arrayValue?.values?.map(n=>pr(n.doubleValue));return new Mn(r)}convertGeoPoint(e){return new Ln(pr(e.latitude),pr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=ll(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(gs(e));default:return null}}convertTimestamp(e){const r=_o(e);return new lr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=sr.fromString(e);tr(yf(n),9688,{name:e});const o=new vs(n.get(1),n.get(3)),s=new ht(n.popFirst(5));return o.isEqual(r)||Jn(`Document ${s} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ew(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class Xi{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class qo extends Kf{constructor(e,r,n,o,s,a){super(e,r,n,o,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new wa(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Qd("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new nt(Me.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=qo._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}qo._jsonSchemaVersion="firestore/documentSnapshot/1.0",qo._jsonSchema={type:Sr("string",qo._jsonSchemaVersion),bundleSource:Sr("string","DocumentSnapshot"),bundleName:Sr("string"),bundle:Sr("string")};class wa extends qo{data(e={}){return super.data(e)}}class vi{constructor(e,r,n,o){this._firestore=e,this._userDataWriter=r,this._snapshot=o,this.metadata=new Xi(o.hasPendingWrites,o.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new wa(this._firestore,this._userDataWriter,n.key,n,new Xi(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new nt(Me.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(o,s){if(o._snapshot.oldDocs.isEmpty()){let a=0;return o._snapshot.docChanges.map(l=>{const u=new wa(o._firestore,o._userDataWriter,l.doc.key,l.doc,new Xi(o._snapshot.mutatedKeys.has(l.doc.key),o._snapshot.fromCache),o.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=o._snapshot.oldDocs;return o._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const u=new wa(o._firestore,o._userDataWriter,l.doc.key,l.doc,new Xi(o._snapshot.mutatedKeys.has(l.doc.key),o._snapshot.fromCache),o.query.converter);let h=-1,m=-1;return l.type!==0&&(h=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),m=a.indexOf(l.doc.key)),{type:Tw(l.type),doc:u,oldIndex:h,newIndex:m}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new nt(Me.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=vi._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=_d.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],o=[];return this.docs.forEach(s=>{s._document!==null&&(r.push(s._document),n.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),o.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Tw(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return gt(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kw(t){t=Xn(t,fr);const e=Xn(t.firestore,Ms);return dw(qd(e),t._key).then(r=>Nw(e,t,r))}vi._jsonSchemaVersion="firestore/querySnapshot/1.0",vi._jsonSchema={type:Sr("string",vi._jsonSchemaVersion),bundleSource:Sr("string","QuerySnapshot"),bundleName:Sr("string"),bundle:Sr("string")};class Xf extends Iw{constructor(e){super(),this.firestore=e}convertBytes(e){return new pn(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new fr(this.firestore,null,r)}}function Rw(t){t=Xn(t,Zo);const e=Xn(t.firestore,Ms),r=qd(e),n=new Xf(e);return xw(t._query),uw(r,t._query).then(o=>new vi(e,n,t,o))}function Dw(t,e,r){t=Xn(t,fr);const n=Xn(t.firestore,Ms),o=Ew(t.converter,e);return eg(n,[bw(Wd(n),"setDoc",t._key,o,t.converter!==null,r).toMutation(t._key,Dn.none())])}function Zf(t,e,r,...n){t=Xn(t,fr);const o=Xn(t.firestore,Ms),s=Wd(o);let a;return a=typeof(e=Nr(e))=="string"||e instanceof vl?Sw(s,"updateDoc",t._key,e,r,n):_w(s,"updateDoc",t._key,e),eg(o,[a.toMutation(t._key,Dn.exists(!0))])}function eg(t,e){return function(n,o){const s=new Yn;return n.asyncQueue.enqueueAndForget(async()=>XP(await cw(n),o,s)),s.promise}(qd(t),e)}function Nw(t,e,r){const n=r.docs.get(e._key),o=new Xf(t);return new qo(t,o,e._key,n,new Xi(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(o){ki=o})(Ei),bi(new Ho("firestore",(n,{instanceIdentifier:o,options:s})=>{const a=n.getProvider("app").getImmediate(),l=new Ms(new b1(n.getProvider("auth-internal")),new P1(a,n.getProvider("app-check-internal")),function(h,m){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new nt(Me.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new vs(h.options.projectId,m)}(a,o),a);return s={useFetchStreams:r,...s},l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),po(dh,uh,e),po(dh,uh,"esm2020")})();let Lw="eyAiYXBpS2V5IjogIkFJemFTeUJBbGN2WlRMMXRsQ05LRExENEJpTWJhR01iTnhCRjQtTSIsICAiYXV0aERvbWFpbiI6ICJocm0tMTEyOC5maXJlYmFzZWFwcC5jb20iLCAgImRhdGFiYXNlVVJMIjogImh0dHBzOi8vaHJtLTExMjguZmlyZWJhc2Vpby5jb20iLCAgInByb2plY3RJZCI6ICJocm0tMTEyOCIsICAic3RvcmFnZUJ1Y2tldCI6ICJocm0tMTEyOC5hcHBzcG90LmNvbSIsICAibWVzc2FnaW5nU2VuZGVySWQiOiAiMTA0OTI1MDU4NTI0NSIsICAiYXBwSWQiOiAiMToxMDQ5MjUwNTg1MjQ1OndlYjowZGFkMDAyMDI3MjM1MTRjY2M1Mjc0In0=";const tg=Ny(JSON.parse(Av(Lw))),Bo=m1(tg),Ja=new Tn,Yc=yw(tg);Ja.addScope("profile");Ja.addScope("email");class Zi extends Error{}Zi.prototype.name="InvalidTokenError";function Mw(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function Ow(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return Mw(e)}catch{return atob(e)}}function Fw(t,e){if(typeof t!="string")throw new Zi("Invalid token specified: must be a string");e||(e={});const r=e.header===!0?0:1,n=t.split(".")[r];if(typeof n!="string")throw new Zi(`Invalid token specified: missing part #${r+1}`);let o;try{o=Ow(n)}catch(s){throw new Zi(`Invalid token specified: invalid base64 for part #${r+1} (${s.message})`)}try{return JSON.parse(o)}catch(s){throw new Zi(`Invalid token specified: invalid json for part #${r+1} (${s.message})`)}}const Vw={clientId:"195275085181-8ccjpgp8v1g80qhnlk6v4lpgid7n81gr.apps.googleusercontent.com"},Bw=t=>{const e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.onload=()=>{window.google&&window.google.accounts.id.initialize({client_id:Vw.clientId,callback:r=>{t(r.credential)},auto_select:!1,cancel_on_tap_outside:!0})},document.head.appendChild(e)},Uw=t=>Fw(t),zw=()=>{window.google&&window.google.accounts.id.disableAutoSelect()},[jw,qw]=el({}),Gw=async()=>{const e=await mn({query:"qcm42351987"});if(e&&!e.error){let n=Object.assign({},{},e);qw(n)}return 1},Hw=async t=>{let e=jw?.[992002];e&&(e.params={tkn:t})},[oi,Br]=el({user:null,loading:!0,error:null,authMethod:null}),[rg,lm]=ye(null);e_(Bo,t=>{t?Br({user:t,loading:!1,error:null,authMethod:"firebase"}):rg()||Br({user:null,loading:!1,error:null,authMethod:null})});E_(Bo).then(t=>{t&&Br({user:t.user,loading:!1,error:null,authMethod:"firebase"})}).catch(t=>{console.error("Redirect sign-in error:",t),Br({loading:!1,error:t.message})});const Lt={get state(){return oi},async getUserProfile(t){try{const e=jf(Yc,"users",t),r=await kw(e);if(r.exists()){Br("profile",r.data());let n={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1},o=r.data(),s={};return Object.keys(n).map(a=>{let l=n?.[a];o.hasOwnProperty(a)||(s[a]=l)}),Object.keys(s).length>0&&Zf(e,s),r.data()}else{let n=Lt?.state?.user,o={uid:n?.uid,email:n?.email,displayName:n?.displayName,createdAt:new Date,stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1};return await Dw(e,o),console.log("No such user profile!"),null}}catch(e){return console.error("Error fetching user profile:",e),null}},hasPermission:t=>{const e=Lt.state?.profile;return e?.isAdmin?!0:e?e?.[t]===!0:!1},async signInWithGoogle(){try{Br("loading",!0),Br("error",null);try{const t=await S_(Bo,Ja);Br({user:t.user,loading:!1,error:null,authMethod:"firebase"});try{Lt.getUserProfile(t.user.uid)}catch(e){console.error("firestore error:",e)}}catch(t){if(t.code==="auth/popup-blocked")await A_(Bo,Ja);else throw t}}catch(t){console.error("Sign-in error:",t),Br({loading:!1,error:t.message||"Failed to sign in with Google"})}},async signInWithGoogleP(t){const r=await mn({params:{id_token:t},query:"getGoogleUserbyToken"});if(r&&r){let n=new Date().getTime(),o=new Date(n+6e4*60*24*365),s="hrm_tkn_acc";document.cookie=`${s}=${r.data}; expires=${o}; path=/;g_state = {"i_l":1,"i_p":${o}}; ssgl_access_tkn = ${t}`,document.cookie=`ssgl_access_tkn = ${t}; expires=${o};`,await Gw(),Hw(r.data)}},async signInWithGoogleCloud(t){try{Br("loading",!0),Br("error",null);const e=Uw(t),r={uid:e.sub,email:e.email,displayName:e.name,photoURL:e.picture};lm(r);const n={uid:r.uid,email:r.email,displayName:r.displayName,photoURL:r.photoURL,emailVerified:!0};Br({user:n,loading:!1,error:null,authMethod:"google-cloud"});try{const o=Tn.credential(t);await J0(Bo,o)}catch{console.log("Firebase sign-in optional, continuing with Google Cloud auth")}}catch(e){console.error("Google Cloud sign-in error:",e),Br({loading:!1,error:e.message||"Failed to sign in with Google Cloud"})}},async signOut(){try{Br("loading",!0),(oi.authMethod==="firebase"||Bo.currentUser)&&await t_(Bo),oi.authMethod==="google-cloud"&&(zw(),lm(null)),Br({user:null,loading:!1,error:null,authMethod:null})}catch(t){console.error("Sign-out error:",t),Br({loading:!1,error:t.message||"Failed to sign out"})}},get isAuthenticated(){return!!oi.user||!!rg()},get currentUser(){return oi.user},get authMethod(){return oi.authMethod}};var Ww=z("<p>"),Yw=z('<div><div><div><h1>HRM Finance</h1><p>Complete Business Management Solution</p><div><div><button><svg width=24 height=24 viewBox="0 0 24 24"><path fill=#4285F4 d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"></path><path fill=#34A853 d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"></path><path fill=#FBBC05 d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"></path><path fill=#EA4335 d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"></path></svg></button><p>Firebase Authentication</p></div></div></div><div><div><div></div><h3>Financial Management</h3><p>Complete chart of accounts, balance sheets, journal entries, and invoice management in one place.</p></div><div><div></div><h3>HR Management</h3><p>Track employees, manage onboarding, and monitor your workforce with powerful analytics.</p></div><div><div></div><h3>Inventory Control</h3><p>Real-time inventory tracking, product management, and movement history across multiple locations.</p></div><div><div></div><h3>Banking Integration</h3><p>Streamline bank reconciliation with CSV imports and automated consolidation features.</p></div><div><div></div><h3>Real-time Analytics</h3><p>Get instant insights with dashboards showing revenue, cash flow, and business performance.</p></div><div><div></div><h3>Multi-language Support</h3><p>Available in multiple languages to support your global business operations.</p></div></div><div><p>Secure authentication powered by Google  Your data is encrypted and protected</p><p>Choose your preferred authentication method above');const Kw=()=>{$r(()=>{Bw(P=>{Lt.signInWithGoogleP(P)}),setTimeout(()=>{},100)});const t={"min-height":"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},e={background:"white","border-radius":"1rem","box-shadow":"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","max-width":"1200px",width:"100%",overflow:"hidden"},r={padding:"3rem","text-align":"center","border-bottom":"1px solid #e2e8f0"},n={"font-size":"2.5rem","font-weight":"800",color:"#1a202c","margin-bottom":"1rem"},o={"font-size":"1.125rem",color:"#718096","margin-bottom":"2rem"},s={display:"flex","flex-direction":"column",gap:"1rem","align-items":"center","margin-bottom":"1rem"},a={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"2rem",padding:"3rem"},l={"text-align":"center",padding:"2rem","border-radius":"0.5rem",background:"#f7fafc",transition:"transform 0.2s",cursor:"default"},u={"font-size":"3rem","margin-bottom":"1rem"},h={"font-size":"1.25rem","font-weight":"600",color:"#2d3748","margin-bottom":"0.5rem"},m={color:"#718096","line-height":"1.6"},v={display:"inline-flex","align-items":"center",gap:"0.75rem",background:"white",color:"#4285f4",border:"2px solid #4285f4",padding:"0.75rem 2rem","font-size":"1.125rem","font-weight":"500","border-radius":"0.5rem",cursor:"pointer",transition:"all 0.2s","min-width":"250px","justify-content":"center"},_={color:"#e53e3e","margin-top":"1rem","font-size":"0.875rem"},x={background:"#f7fafc",padding:"2rem","text-align":"center",color:"#718096","font-size":"0.875rem"},T={"font-size":"0.75rem",color:"#718096","margin-top":"0.25rem","font-style":"italic"},E=()=>{Lt.signInWithGoogle()};return(()=>{var P=Yw(),R=P.firstChild,Y=R.firstChild,Z=Y.firstChild,j=Z.nextSibling,B=j.nextSibling,V=B.firstChild,f=V.firstChild;f.firstChild;var g=f.nextSibling,S=Y.nextSibling,$=S.firstChild,w=$.firstChild,I=w.nextSibling,y=I.nextSibling,de=$.nextSibling,J=de.firstChild,O=J.nextSibling,N=O.nextSibling,q=de.nextSibling,D=q.firstChild,C=D.nextSibling,F=C.nextSibling,ee=q.nextSibling,H=ee.firstChild,oe=H.nextSibling,M=oe.nextSibling,G=ee.nextSibling,le=G.firstChild,ne=le.nextSibling,ue=ne.nextSibling,L=G.nextSibling,A=L.firstChild,U=A.nextSibling,te=U.nextSibling,ae=S.nextSibling,re=ae.firstChild,ce=re.nextSibling;return d(P,t),d(R,e),d(Y,r),d(Z,n),d(j,o),d(B,s),f.addEventListener("mouseleave",Q=>{Q.currentTarget.style.background="white",Q.currentTarget.style.color="#4285f4"}),f.addEventListener("mouseenter",Q=>{Q.currentTarget.style.background="#4285f4",Q.currentTarget.style.color="white"}),f.$$click=E,d(f,v),i(f,b(Ae,{get when(){return Lt.state.loading},fallback:"Sign in with Google",children:"Signing in..."}),null),d(g,T),i(Y,b(Ae,{get when(){return Lt.state.error},get children(){var Q=Ww();return d(Q,_),i(Q,()=>Lt.state.error),Q}}),null),d(S,a),d(ae,x),ce.style.setProperty("margin-top","0.5rem"),ce.style.setProperty("font-size","0.75rem"),X(Q=>{var me=Lt.state.loading,K=l,he=u,ve=h,W=m,ie=l,Pe=u,_e=h,fe=m,be=l,pe=u,we=h,De=m,ke=l,Te=u,Ue=h,Xe=m,ze=l,$e=u,Ge=h,ot=m,je=l,Ce=u,Se=h,Ke=m;return me!==Q.e&&(f.disabled=Q.e=me),Q.t=d($,K,Q.t),Q.a=d(w,he,Q.a),Q.o=d(I,ve,Q.o),Q.i=d(y,W,Q.i),Q.n=d(de,ie,Q.n),Q.s=d(J,Pe,Q.s),Q.h=d(O,_e,Q.h),Q.r=d(N,fe,Q.r),Q.d=d(q,be,Q.d),Q.l=d(D,pe,Q.l),Q.u=d(C,we,Q.u),Q.c=d(F,De,Q.c),Q.w=d(ee,ke,Q.w),Q.m=d(H,Te,Q.m),Q.f=d(oe,Ue,Q.f),Q.y=d(M,Xe,Q.y),Q.g=d(G,ze,Q.g),Q.p=d(le,$e,Q.p),Q.b=d(ne,Ge,Q.b),Q.T=d(ue,ot,Q.T),Q.A=d(L,je,Q.A),Q.O=d(A,Ce,Q.O),Q.I=d(U,Se,Q.I),Q.S=d(te,Ke,Q.S),Q},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0}),P})()};wt(["click"]);var Qw=z("<div><div>");const Jw=t=>{const e={"min-height":"100vh",display:"flex","align-items":"center","justify-content":"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},r={width:"50px",height:"50px",border:"3px solid rgba(255, 255, 255, 0.3)","border-top-color":"white","border-radius":"50%",animation:"spin 1s linear infinite"},n=document.createElement("style");return n.textContent=`
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  `,document.head.appendChild(n),fn(async()=>{Lt.state?.user?.uid&&Lt.getUserProfile(Lt.state?.user?.uid)}),$r(()=>{}),b(Ae,{get when(){return!Lt.state.loading},get fallback(){return(()=>{var o=Qw(),s=o.firstChild;return d(o,e),d(s,r),o})()},get children(){return b(Ae,{get when(){return Lt.isAuthenticated},get fallback(){return b(Kw,{})},get children(){return t.children}})}})};var Xw=z("<button>");const qe=t=>{const e=()=>{const r={"font-family":"inherit",cursor:t.disabled?"not-allowed":"pointer",border:"none","border-radius":"var(--border-radius-sm)","font-weight":"500",transition:"all 0.2s ease","text-decoration":"none",display:"inline-flex","align-items":"center","justify-content":"center",gap:"0.5rem",opacity:t.disabled?"0.6":"1"},n={sm:{padding:"0.5rem 1rem","font-size":"0.875rem"},md:{padding:"0.75rem 1.5rem","font-size":"1rem"},lg:{padding:"1rem 2rem","font-size":"1.125rem"}},o={primary:{background:"linear-gradient(135deg, var(--primary-color), var(--primary-dark))",color:"white","box-shadow":"var(--shadow-sm)"},secondary:{background:"var(--surface-color)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},outline:{background:"transparent",color:"var(--primary-color)",border:"1px solid var(--primary-color)"}};return{...r,...n[t.size||"md"],...o[t.variant||"primary"]}};return(()=>{var r=Xw();return Vn(r,"click",t.onClick,!0),i(r,()=>t.children),X(n=>{var o=e(),s=t.disabled,a=t.type||"button",l=`btn btn-${t.variant||"primary"} ${t.className||""}`;return n.e=d(r,o,n.e),s!==n.t&&(r.disabled=n.t=s),a!==n.a&&ct(r,"type",n.a=a),l!==n.o&&ed(r,n.o=l),n},{e:void 0,t:void 0,a:void 0,o:void 0}),r})()};wt(["click"]);var Zw=z("<div><div><div><h2></h2><button></button></div><div>");const Ar=t=>{const e={position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","z-index":"1000"},r={background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)","max-width":"920px",width:"90%","max-height":"80vh",overflow:"auto",position:"relative"},n={padding:"1.5rem","border-bottom":"1px solid var(--border-color)",display:"flex","justify-content":"space-between","align-items":"center"},o={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},s={background:"none",border:"none","font-size":"1.5rem",cursor:"pointer",color:"var(--text-muted)",padding:"0.5rem","border-radius":"var(--border-radius-sm)"},a={padding:"1.5rem"},l=u=>{u.target===u.currentTarget&&t.onClose()};return b(Ae,{get when(){return t.isOpen},get children(){var u=Zw(),h=u.firstChild,m=h.firstChild,v=m.firstChild,_=v.nextSibling,x=m.nextSibling;return u.$$click=l,d(m,n),d(v,o),i(v,()=>t.title),_.addEventListener("mouseleave",T=>T.target.style.background="none"),_.addEventListener("mouseenter",T=>T.target.style.background="var(--background-color)"),Vn(_,"click",t.onClose,!0),d(_,s),d(x,a),i(x,()=>t.children),X(T=>{var E=e,P=r;return T.e=d(u,E,T.e),T.t=d(h,P,T.t),T},{e:void 0,t:void 0}),u}})};wt(["click"]);var cm=z("<div>"),eC=z("<h3>"),tC=z("<p>");const rt=t=>{const e={background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"1.5rem","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",transition:"all 0.2s ease",cursor:t.onClick?"pointer":"default"},r={"margin-bottom":"1rem"},n={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0 0 0.5rem 0"},o={"font-size":"0.875rem",color:"var(--text-muted)",margin:"0"};return(()=>{var s=cm();return Vn(s,"click",t.onClick,!0),i(s,(()=>{var a=ge(()=>!!(t.title||t.subtitle));return()=>a()&&(()=>{var l=cm();return d(l,r),i(l,(()=>{var u=ge(()=>!!t.title);return()=>u()&&(()=>{var h=eC();return d(h,n),i(h,()=>t.title),h})()})(),null),i(l,(()=>{var u=ge(()=>!!t.subtitle);return()=>u()&&(()=>{var h=tC();return d(h,o),i(h,()=>t.subtitle),h})()})(),null),l})()})(),null),i(s,()=>t.children,null),X(a=>{var l=e,u=`card ${t.className||""}`;return a.e=d(s,l,a.e),u!==a.t&&ed(s,a.t=u),a},{e:void 0,t:void 0}),s})()};wt(["click"]);var rC=z("<div><label></label><input>"),nC=z("<span>*");const Qt=t=>{const e={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},r={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},n={"margin-bottom":"1rem"};return(()=>{var o=rC(),s=o.firstChild,a=s.nextSibling;return d(o,n),d(s,e),i(s,()=>t.label,null),i(s,(()=>{var l=ge(()=>!!t.required);return()=>l()&&(()=>{var u=nC();return u.style.setProperty("color","var(--primary-color)"),u})()})(),null),a.addEventListener("blur",l=>l.target.style.borderColor="var(--border-color)"),a.addEventListener("focus",l=>l.target.style.borderColor="var(--primary-color)"),a.$$input=l=>t.onChange(l.target.value),d(a,r),X(l=>{var u=t.type||"text",h=t.placeholder,m=t.required,v=t.disabled;return u!==l.e&&ct(a,"type",l.e=u),h!==l.t&&ct(a,"placeholder",l.t=h),m!==l.a&&(a.required=l.a=m),v!==l.o&&(a.disabled=l.o=v),l},{e:void 0,t:void 0,a:void 0,o:void 0}),X(()=>a.value=t.value),o})()};wt(["input"]);const oC={en:{common:{save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",close:"Close",search:"Search",filter:"Filter",reset:"Reset",back:"Back",next:"Next",previous:"Previous",yes:"Yes",no:"No",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",confirm:"Confirm",actions:"Actions",status:"Status",active:"Active",inactive:"Inactive",date:"Date",time:"Time",description:"Description",notes:"Notes",amount:"Amount",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Language",english:"English",spanish:"Spanish",noDataFound:"No data found",required:"Required",optional:"Optional",all:"All",none:"None",select:"Select",clear:"Clear",searching:"Searching...",refresh:"Refresh",showAll:"Show All",products:"products",filtered:"Filtered",view:"View",suggested:"Suggested",clearFilters:"Clear Filters",enhanced:"Enhanced",legacy:"Legacy",email:"Email",phone:"Phone",address:"Address",name:"Name",code:"Code",category:"Category",type:"Type",quantity:"Quantity",price:"Price",cost:"Cost",value:"Value",balance:"Balance",created:"Created",modified:"Modified",details:"Details",summary:"Summary",history:"History",new:"New",addNew:"Add New",unknown:"Unknown",notAvailable:"N/A",remove:"Remove",startDate:"Start Date",endDate:"End Date",from:"From",invoice:"Invoice",invoices:"invoices",reference:"Reference",createdBy:"Created By",units:"units",invoiceDocumentId:"Invoice/Document ID",referenceNumber:"Reference Number",referenceNumberPlaceholder:"Enter reference number...",generalNotes:"General Notes",auto:"Auto",optionalNotes:"Optional notes...",showPerPage:"Show per page",first:"First",last:"Last",store:"Store",orderId:"Order ID",tax:"Tax",paymentMethods:"Payment Methods",cash:"Cash",creditCard:"Credit Card",shipping:"Shipping",air:"Air",sea:"Sea",thankYouBusiness:"Thank you for your business!",taxExemptNote:"Tax exempted on cash payment.",youSaved:"You saved",generatedOn:"Generated on",printSavePDF:"Print / Save as PDF",pageOfPages:"Page {{current}} of {{total}}",showingXofY:"Showing {{start}}-{{end}} of {{total}}",page:"Page",of:"of",print:"Print",export:"Export",pending:"Pending",completed:"Completed",customer:"Customer",location:"Location",reservations:"Reservations",backToDashboard:"Back to Dashboard",lbs:"pounds"},navigation:{dashboard:"Dashboard",accounts:"Chart of Accounts",balanceSheet:"Balance Sheet",inventory:"Inventory",employees:"Employees",entryBooks:"Entry Books",consolidate:"Bank Consolidation",reports:"Reports",settings:"Settings"},dashboard:{title:"Dashboard",welcome:"Welcome to HRM Finance",totalRevenue:"Total Revenue",overview:"Overview",recentActivity:"Recent Activity",quickActions:"Quick Actions",employeeCount:"Employee Count",pendingInvoices:"Pending Invoices",cashBalance:"Cash Balance",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalExpenses:"Total Expenses",netIncome:"Net Income",netLoss:"Net Loss",monthlyPayroll:"Monthly Payroll",current:"Current",newHires:"+3 new hires",outstanding:"Outstanding",totalOutstanding:"$23,450 total",lastUpdatedToday:"Last updated today",commonTasks:"Common tasks",generateReport:"Generate Report",latestUpdates:"Latest updates",invoicePaid:"Invoice #1234 paid",hoursAgo:"2 hours ago",newEmployeeOnboarded:"New employee onboarded",dayAgo:"1 day ago",monthlyReportGenerated:"Monthly report generated",daysAgo:"2 days ago"},accounts:{title:"Chart of Accounts",accountNumber:"Account Number",accountName:"Account Name",accountType:"Account Type",category:"Category",balance:"Balance",parentAccount:"Parent Account",subAccounts:"Sub-accounts",addAccount:"Add Account",editAccount:"Edit Account",deleteAccount:"Delete Account",accountDetails:"Account Details",transactions:"Transactions",accountHistory:"Account History",backToAccounts:"Back to Accounts",accountNotFound:"Account not found",accountInformation:"Account Information",accountPurpose:"Account purpose",transactionHistory:"Transaction History",noTransactions:"No transactions found for this account",createdDate:"Created Date",lastModified:"Last Modified",noDescription:"No description provided.",totalCount:"Total count",basicDetails:"Basic details",currentBalance:"Current balance",classification:"Classification",allTransactions:"All account transactions",reference:"Reference",allAccounts:"All Accounts",types:{asset:"Asset",liability:"Liability",equity:"Equity",revenue:"Revenue",expense:"Expense"},categories:{currentAssets:"Current Assets",fixedAssets:"Fixed Assets",currentLiabilities:"Current Liabilities",longTermLiabilities:"Long-term Liabilities",ownersEquity:"Owner's Equity",operatingRevenue:"Operating Revenue",operatingExpenses:"Operating Expenses"}},inventory:{title:"Inventory Management",overview:"Overview",products:"Products & Stock",movements:"Movements",locations:"Locations",bulkMovement:"Bulk Movement",addMovement:"Add Movement",addProduct:"Add Product",addLocation:"Add Location",singleMovement:"Add Single Movement",addNewItem:"Add New Item",activeProducts:"Active Products",lowStockAlert:"Low Stock Items",totalValue:"Total Stock Value",activeLocations:"Active Locations",productsNeedRestocking:"products need restocking",recentMovements:"Recent Movements",noProducts:"No products at this location",productName:"Product Name",productCode:"Product Code",sku:"SKU",unitOfMeasure:"Unit of Measure",unitCost:"Unit Cost",minStockLevel:"Min Stock Level",maxStockLevel:"Max Stock Level",locationName:"Location Name",locationType:"Location Type",locationCode:"Location Code",movementType:"Movement Type",referenceNumber:"Reference Number",invoiceNumber:"Invoice Number",fromLocation:"From Location",toLocation:"To Location",stockIn:"Stock In",stockOut:"Stock Out",transfer:"Transfer",adjustment:"Adjustment",inStock:"In Stock",lowStock:"Low Stock",outOfStock:"Out of Stock",stockLevels:"Stock Levels",stockByLocation:"Stock by Location",searchProducts:"Search products by name, SKU, or category...",searchProductsStock:"Search products and check stock levels...",searchResult:"Search Result",searchResults:"Search Results",searchFallback:"Showing local results",tryDifferentTerm:"Try a different search term or check spelling.",showingTopResults:"Showing top {{count}} results",searchLocations:"Search locations...",noMovements:"No movements found",productDetails:"Product Details",locationDetails:"Location Details",movementDetails:"Movement Details",totalProducts:"Total Products",totalLocations:"Total Locations",lastSeen:"Last seen",warehouseType:"Warehouse",storeType:"Store",supplierType:"Supplier",customerType:"Customer",currentlyManaged:"Currently managed",needAttention:"Need attention",currentWorth:"Current worth",warehousesStores:"Warehouses & stores",thisMonth:"This Month",latestActivities:"Latest inventory activities",searchMovements:"Search Movements",countingSheet:"Counting Sheet",physicalCount:"Physical Count",physicalInventoryCount:"Physical Inventory Count",setupPhysicalCount:"Setup Physical Inventory Count",setupDescription:"Configure your physical inventory count settings and begin the counting process.",countWillInclude:"This count will include {{count}} products from {{location}} in {{category}} category.",startCounting:"Start Physical Count",counted:"Counted",remaining:"Remaining",variances:"Variances",complete:"Complete",systemQty:"System Qty",variance:"Variance",addNotes:"Add notes...",reviewAndConfirm:"Review and Confirm Adjustments",reviewDescription:"Review the inventory adjustments below and confirm to update your system.",stockIncreases:"Stock Increases",stockDecreases:"Stock Decreases",totalAdjustments:"Total Adjustments",confirmAdjustments:"Confirm Adjustments",perfectCount:"Perfect Count!",noVariances:"No variances found. Your physical count matches the system exactly.",physicalCountAdjustment:"Physical count adjustment",inventoryCountingSheetTitle:"INVENTORY COUNTING SHEET",location:"Location",allCategories:"All Categories",countedBy:"Counted by",verifiedBy:"Verified by",instructions:"Instructions",countInstructions:["Count all items physically present at this location",'Write the actual count in the "Physical Count" column',"Leave blank if item is not found",'Note any discrepancies in the "Notes" column',"Sign and date when complete"],productName:"Product Name",unit:"Unit",totalProductsListed:"Total Products Listed",itemsCounted:"Items Counted",summaryFor:"SUMMARY FOR",discrepanciesFound:"Discrepancies Found",counterSignature:"Counter Signature",supervisorSignature:"Supervisor Signature",downloadCSV:"Download CSV",noAdjustmentsToDownload:"No adjustments to download",stockIncrease:"Stock Increase",stockDecrease:"Stock Decrease",purchaseReceive:"Purchase/Receive",saleIssue:"Sale/Issue",transfer:"Transfer",adjustment:"Adjustment",movementType:"Movement Type",fromLocation:"From Location",toLocation:"To Location",searchSourceLocation:"Search source location...",searchDestinationLocation:"Search destination location...",searchLocation:"Search location...",addProduct:"Add Product",searchProduct:"Search product...",unitCost:"Unit Cost",noProductsAdded:'No products added yet. Click "Add Product" to get started.',createMovement:"Create Movement",generalNotesPlaceholder:"Enter general notes for this movement...",sortBy:"Sort By",allLocations:"All Locations",searchByProduct:"Search by product, location, reference, notes, invoice...",allProducts:"All Products",bulkMovementReport:"Bulk Movement Report",movementDetails:"Movement Details",referenceNumber:"Reference Number",invoiceId:"Invoice ID",totalItems:"Total Items",totalQuantity:"Total Quantity",estimatedValue:"Estimated Value",viewHistoricalReports:"View Historical Reports",noBulkReportsFound:"No bulk movement reports found",bulkReportsAppearHere:"Bulk movement reports will appear here after you create bulk movements",allTypes:"All Types",startDate:"Start Date",endDate:"End Date",totalMovements:"Total Movements",totalItems:"Total Items",adjustMovements:"Try adjusting your filters or check back later.",inventoryMovements:"Inventory Movements",createdBy:"Created By",view:"View",enhanced:"Enhanced",legacy:"Legacy",addSingleMovement:"Add Single Movement",inStockSubtitle:"In stock",itemsBelowThreshold:"Items below threshold",inventoryWorth:"Inventory worth",quantity:"Quantity",units:"units",normal:"Normal",productsAndStock:"Products & Stock",lowStockItems:"Low Stock Items",totalStockValue:"Total Stock Value",warehousesAndStores:"Warehouses & stores",andMore:"...and {count} more",latestInventoryActivities:"Latest inventory activities",min:"Min",max:"Max",cost:"Cost",noProductsFound:"No products found matching your search.",noProductsAvailable:"No products available.",noLocationsFound:"No locations found matching your search.",noLocationsAvailable:"No locations available.",searchPlaceholder:"Search by product, location, reference, notes, invoice...",noMovementsFound:"No movements found",tryAdjustingFilters:"Try adjusting your filters or check back later.",transfers:"Transfers",adjustments:"Adjustments",bulk:"Bulk",product:"Product",location:"Location",store:"Store",supplier:"Supplier",warehouse:"Warehouse",movement:"Movement",editMovement:"Edit Movement",updateMovement:"Update Movement",movementInformation:"Movement Information",locationInformation:"Location Information",searchProductsImages:"Search products to view images...",searchForProducts:"Search for Products",startTypingToSearch:"Start typing to search and view product images",tryDifferentSearch:"Try a different search term"},employees:{title:"Employee Management",employeeList:"Employee List",addEmployee:"Add Employee",editEmployee:"Edit Employee",employeeDetails:"Employee Details",personalInfo:"Personal Information",employmentInfo:"Employment Information",payrollInfo:"Payroll Information",firstName:"First Name",lastName:"Last Name",fullName:"Full Name",email:"Email",phone:"Phone",address:"Address",dateOfBirth:"Date of Birth",employeeId:"Employee ID",department:"Department",position:"Position",hireDate:"Hire Date",employmentStatus:"Employment Status",salary:"Salary",payFrequency:"Pay Frequency",taxId:"Tax ID",bankAccount:"Bank Account",emergencyContact:"Emergency Contact",activeEmployees:"Active Employees",inactiveEmployees:"Inactive Employees",totalPayroll:"Total Payroll",searchEmployees:"Search employees...",enterFullName:"Enter employee's full name",enterPosition:"Enter job position",enterEmail:"Enter email address",enterPhone:"Enter phone number",enterSalary:"Enter annual salary",departments:{engineering:"Engineering",product:"Product",design:"Design",marketing:"Marketing",sales:"Sales",humanResources:"Human Resources",finance:"Finance",operations:"Operations",analytics:"Analytics"}},entryBooks:{title:"Entry Books",bookName:"Book Name",bookType:"Book Type",createBook:"Create Book",editBook:"Edit Book",salesBook:"Sales Book",purchaseBook:"Purchase Book",cashBook:"Cash Book",generalBook:"General Book",entries:"Entries",addEntry:"Add Entry",period:"Period",startDate:"Start Date",endDate:"End Date",bookBalance:"Book Balance",reconciledBalance:"Reconciled Balance",difference:"Difference",reconcile:"Reconcile",isReconciled:"Is Reconciled",noBooks:"No entry books found",createFirst:"Create your first entry book to get started",bookDetails:"Book Details",entriesCount:"entries",bookOverview:"Book overview and details",bookEntries:"Book Entries",allEntries:"All entries in this book",noEntries:"No entries found",addFirst:"Add your first entry to this book",entryDate:"Entry Date",entryDescription:"Entry Description",entryAmount:"Entry Amount",entryReference:"Entry Reference",subtitle:"Manage accounting entries and general ledger records",viewReconciliation:"View Reconciliation",totalEntries:"Total Entries",allJournalEntries:"All journal entries",postedEntriesOnly:"Posted entries only",fromPostedEntries:"From {count} posted entries",needBankReconciliation:"Need bank reconciliation",allReconciled:"All reconciled",sortBy:"Sort By",fromDate:"From Date",toDate:"To Date",order:"Order",newest:"Newest",oldest:"Oldest",resetFilters:"Reset Filters",activeFilters:"Active filters",from:"From",to:"To",entriesFound:"{count} entries found",noJournalEntries:"No Journal Entries",startByCreating:"Start by creating your first entry",noEntriesMatch:"No journal entries match your current filters.",createFirstEntry:"Create First Entry",void:"Void",confirmVoid:"Are you sure you want to void this journal entry?",entryBookRecords:"Entry Book Records"},banking:{title:"Bank Consolidation",bankAccount:"Bank Account",statementDate:"Statement Date",beginningBalance:"Beginning Balance",endingBalance:"Ending Balance",deposits:"Deposits",withdrawals:"Withdrawals",bankCharges:"Bank Charges",interest:"Interest",reconcile:"Reconcile",matched:"Matched",unmatched:"Unmatched",importStatement:"Import Statement",manualEntry:"Manual Entry",autoMatch:"Auto Match",clearAll:"Clear All",reconciliationStatus:"Reconciliation Status",difference:"Difference",bookBalance:"Book Balance",statementBalance:"Statement Balance",outstandingChecks:"Outstanding Checks",depositsInTransit:"Deposits in Transit",reconciled:"Reconciled",notReconciled:"Not Reconciled",unreconciled:"Unreconciled",reconciliation:"Reconciliation",compareStatements:"Compare bank statements with entry book records",importCSV:"Import CSV",startNewReconciliation:"Start New Reconciliation",bankAccountInfo:"Bank Account Info",currentAccountDetails:"Current account details",lastReconciled:"Last reconciled",bankTransactions:"Bank Transactions",selectedPeriod:"Selected period",pending:"pending",bookEntriesForComparison:"Book entries for comparison",reconciliationRate:"Reconciliation Rate",completionStatus:"Completion status",recentReconciliationSessions:"Recent Reconciliation Sessions",latestActivity:"Latest activity",noRecentSessions:"No recent reconciliation sessions found.",startFirstReconciliation:"Start First Reconciliation",entryBookRecords:"Entry Book Records",pleaseUploadCSV:"Please upload a CSV file",csvRequiresHeaderAndData:"CSV file must have at least a header and one data row",successfullyParsed:"Successfully parsed {count} rows",errorParsingCSV:"Error parsing CSV file. Please check the format.",dateDescriptionRequired:"Date and Description columns are required",importedTransaction:"Imported transaction",successfullyImported:"Successfully imported {count} bank transactions",errorImportingTransactions:"Error importing transactions. Please check your data.",importBankStatementCSV:"Import Bank Statement CSV",dropCSVHere:"Drop CSV file here",clickToUploadCSV:"Click to upload or drag and drop CSV file",supportedFormat:"Supported format: CSV with Date, Description, and Amount columns",mapCSVColumns:"Map CSV Columns",dateColumn:"Date Column",selectColumn:"Select column...",descriptionColumn:"Description Column",referenceColumn:"Reference Column",amountDebitColumn:"Amount/Debit Column",creditColumn:"Credit Column",balanceColumn:"Balance Column",andMoreRows:"... and {count} more rows",importing:"Importing...",importTransactions:"Import {count} Transactions",reconciliationComparison:"Reconciliation Comparison",bankStatements:"Bank Statements",totalTransactions:"Total transactions",totalEntries:"Total entries",unreconciledBank:"Unreconciled Bank",unreconciledBooks:"Unreconciled Books",needAttention:"Need attention",unreconcile:"Unreconcile",clickToReconcile:"Click to reconcile",potentialMatchesFound:"Potential Matches Found",clickRecordToReconcile:"Click on a record below to reconcile",exactMatch:"Exact Match",possibleMatch:"Possible Match",selected:"Selected",clearSelection:"Clear Selection"},journal:{title:"Journal Entries",entryNumber:"Entry Number",entryDate:"Entry Date",debit:"Debit",credit:"Credit",account:"Account",memo:"Memo",reference:"Reference",createEntry:"Create Entry",editEntry:"Edit Entry",deleteEntry:"Delete Entry",posted:"Posted",draft:"Draft",reversed:"Reversed",recurringEntry:"Recurring Entry",attachments:"Attachments",totalDebits:"Total Debits",totalCredits:"Total Credits",outOfBalance:"Out of Balance",balanced:"Balanced",addEntry:"Add Journal Entry",allEntries:"All Entries",totalDebit:"Total Debit",totalCredit:"Total Credit",debitShort:"Dr.",creditShort:"Cr.",noReference:"No reference",createdBy:"By",totalAmount:"Total Amount",lines:"Lines",entryNotBalancedShort:"Entry is not balanced",accountLines:"Account Lines",noDescription:"No description",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryLines:"Journal Entry Lines",addLine:"Add Line",lineDescription:"Line description",notBalanced:"Not Balanced",updateEntry:"Update Entry",saveAsDraft:"Save as Draft",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",editEntryTooltip:"Edit this journal entry",post:"Post",entryMustBeBalanced:"Entry must be balanced to post",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",journalLines:"Journal Lines",balanceStatus:"Balance Status",unbalanced:"Unbalanced",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",postEntry:"Post Entry",fixBalance:"Fix Balance",voidEntry:"Void Entry",draftEntry:"Draft Entry",draftEntryDescription:"This entry can be edited and posted.",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",postedEntry:"Posted Entry",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",minTwoLinesRequired:"At least 2 line items are required",entryNotBalanced:"Entry is not balanced. Debit: ${debit}, Credit: ${credit}",lineAccountRequired:"Line {lineNumber}: Account is required",lineAmountRequired:"Line {lineNumber}: Either debit or credit amount must be provided",lineBothAmounts:"Line {lineNumber}: Cannot have both debit and credit amounts",enterEntryDescription:"Enter journal entry description",enterReferenceNumber:"Enter reference number"},invoices:{title:"Invoice Dashboard",invoice:"Invoice",invoices:"Invoices",invoiceNumber:"Invoice Number",invoiceDetails:"Invoice Details",customerInformation:"Customer Information",customerName:"Customer Name",legalName:"Legal Name",contactInformation:"Contact Information",idPassport:"ID/Passport",phoneNumber:"Phone Number",altPhone:"Alt Phone",address:"Address",between:"Between",and:"and",products:"Products",reservations:"Reservations",unitPrice:"Unit Price",total:"Total",subtotal:"Subtotal",totalRevenue:"Total Revenue",totalProducts:"Total Products",totalReservations:"Total Reservations",aranceles:"Aranceles (Customs)",uniqueCustomers:"Unique Customers",averageInvoice:"Average Invoice",completed:"Completed",pending:"Pending",storesActive:"Stores Active",topProducts:"Top Products",mostSoldProducts:"Most sold products by quantity",reservationsByType:"Reservations by Type",distributionOfCategories:"Distribution of reservation categories",recentInvoices:"Recent Invoices",showingInvoices:"Showing {{count}} invoices",date:"Date",customer:"Customer",store:"Store",actions:"Actions",view:"View",status:"Status",printInvoice:"Print Invoice",exportPdf:"Export PDF",backToDashboard:"Back to Dashboard",fromInvoices:"From {{count}} invoices",value:"value",activeCustomers:"Active customers",perInvoiceValue:"Per invoice value",locations:"Locations",mostRecentActivity:"Most recent activity",storeLocation:"Store Location",allStores:"All Stores",fromDate:"From Date",toDate:"To Date",clearFilters:"Clear Filters",search:"Search",searchPlaceholder:"Search by invoice #, customer, store...",customsFees:"Total customs fees",salesType:"SALES",packagesOrder:"Packages Order",businessId:"Business ID",orderKey:"Order Key",reservationType:"Reservation Type",arancel:"Arancel",key:"Key",noInvoicesFound:"No invoices found",loadingInvoices:"Loading invoices...",errorLoadingInvoices:"Error loading invoices",refreshData:"Refresh Data",currentStockValue:"Current Stock Value",filterByStore:"Filter by store",filterByDate:"Filter by date range",totalCustomsFees:"Total customs fees",averageValue:"Average value",senderInformation:"Sender Information",receiptInformation:"Receipt Information",productsSubtotal:"Products Subtotal",reservationsSubtotal:"Reservations Subtotal",code:"Code",description:"Description",qty:"Qty",type:"Type",id:"ID",passport:"Passport",createNew:"Create New Invoice",totalOutstanding:"Total Outstanding",unpaidInvoices:"Unpaid invoices",thisMonth:"This Month",revenueCollected:"Revenue collected",overdue:"Overdue",pastDueInvoices:"Past due invoices",latestBillingActivity:"Latest billing activity",paid:"Paid"},forms:{requiredField:"This field is required",invalidEmail:"Invalid email address",invalidNumber:"Invalid number",invalidDate:"Invalid date",selectOption:"Please select an option",enterValue:"Please enter a value",confirmDelete:"Are you sure you want to delete this item?",unsavedChanges:"You have unsaved changes. Do you want to continue?",saveSuccess:"Saved successfully",saveError:"Error saving data",deleteSuccess:"Deleted successfully",deleteError:"Error deleting item",duplicateAccountNumber:"Account number already exists",descriptionRequired:"Description is required",errorOccurred:"An error occurred",errorPostingEntry:"An error occurred while posting the entry",referenceNumberRequired:"Reference number is required",locationRequired:"Location is required",fromLocationRequired:"From location is required for transfers",atLeastOneProduct:"At least one product is required",itemProductRequired:"Product is required for item {{index}}",itemQuantityRequired:"Quantity must be greater than 0 for item {{index}}"},modals:{addInventory:"Add Inventory Movement",bulkMovement:"Bulk Inventory Movement",addProduct:"Add New Product",addLocation:"Add New Location",inventoryDetail:"Inventory Item Details",quickAdd:"Quick Add",selectProduct:"Select Product",selectLocation:"Select Location",enterQuantity:"Enter quantity",enterCost:"Enter unit cost",enterReference:"Enter reference number",addNotes:"Add notes (optional)",generalInformation:"General Information",stockInformation:"Stock Information",locationInformation:"Location Information",movementInformation:"Movement Information",addToInventory:"Add to Inventory",createProduct:"Create Product",createLocation:"Create Location",processing:"Processing...",addingMovement:"Adding movement...",creatingProduct:"Creating product...",creatingLocation:"Creating location..."},products:{title:"Products",addNew:"Add New Product",totalProducts:"Total Products",inCatalog:"In catalog",activeProducts:"Active Products",currentlyAvailable:"Currently available",outOfStock:"Out of Stock",needsRestock:"Needs restock",productCatalog:"Product Catalog",manageYourProducts:"Manage your products and pricing",inStock:"In Stock",furniture:"Furniture",electronics:"Electronics",supplies:"Supplies",lighting:"Lighting",searchPlaceholder:"Search products by name, SKU, or category...",allCategories:"All Categories",clearFilters:"Clear filters",noResults:"No products found matching your criteria.",noProducts:"No products available.",showing:"Showing",filtered:"Filtered results",allProducts:"All products",searchResult:"Search Result",stock:"Stock",lowStock:"Low Stock"},unauthorized:{title:"Access Restricted",accessDenied:"Access Denied",noPermission:"You don't have permission to access",thisFeature:"this feature",whySeeing:"Why am I seeing this?",explanation:"Your account doesn't have the necessary permissions to view this content.",requiredPermission:"Required permission:",goToDashboard:"Go to Dashboard",goBack:"Go Back",featuresCanAccess:"Features you can access:",dashboardAccess:"Dashboard and overview statistics",profileAccess:"Your profile and settings",roleBasedAccess:"Features enabled for your role",needAccess:"Need access? Contact your administrator or manager to request the appropriate permissions.",permissions:{accountAccess:"Account Management Access",inventoryAccess:"Inventory Access",employeeAccess:"HR Access",bankingAccess:"Banking Access",journalAccess:"Journal Entry Access",adminAccess:"Administrative Access",financialReporting:"Financial Reporting Access",invoiceManagement:"Invoice Management Access",productManagement:"Product Management Access"}}},es:{common:{save:"Guardar",cancel:"Cancelar",delete:"Eliminar",edit:"Editar",add:"Agregar",close:"Cerrar",search:"Buscar",filter:"Filtrar",reset:"Restablecer",back:"Atrs",next:"Siguiente",previous:"Anterior",yes:"S",no:"No",loading:"Cargando...",error:"Error",success:"xito",warning:"Advertencia",info:"Informacin",confirm:"Confirmar",actions:"Acciones",status:"Estado",active:"Activo",inactive:"Inactivo",date:"Fecha",time:"Hora",description:"Descripcin",notes:"Notas",amount:"Monto",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Idioma",english:"Ingls",spanish:"Espaol",noDataFound:"No se encontraron datos",required:"Requerido",optional:"Opcional",all:"Todos",none:"Ninguno",select:"Seleccionar",clear:"Limpiar",view:"Ver",suggested:"Sugerido",clearFilters:"Limpiar Filtros",enhanced:"Mejorado",legacy:"Clsico",email:"Correo Electrnico",phone:"Telfono",address:"Direccin",name:"Nombre",code:"Cdigo",category:"Categora",type:"Tipo",quantity:"Cantidad",price:"Precio",cost:"Costo",value:"Valor",balance:"Saldo",created:"Creado",modified:"Modificado",details:"Detalles",summary:"Resumen",history:"Historial",new:"Nuevo",addNew:"Agregar Nuevo",unknown:"Desconocido",notAvailable:"N/A",remove:"Remover",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",from:"De",invoice:"Factura",invoices:"facturas",reference:"Referencia",createdBy:"Creado Por",units:"unidades",invoiceDocumentId:"ID de Factura/Documento",referenceNumber:"Nmero de Referencia",referenceNumberPlaceholder:"Ingrese nmero de referencia...",generalNotes:"Notas Generales",auto:"Auto",optionalNotes:"Notas opcionales...",showPerPage:"Mostrar por pgina",first:"Primera",last:"ltima",store:"Tienda",orderId:"ID de Orden",tax:"Impuesto",paymentMethods:"Mtodos de Pago",cash:"Efectivo",creditCard:"Tarjeta de Crdito",shipping:"Envo",air:"Areo",sea:"Martimo",thankYouBusiness:"Gracias por su negocio!",taxExemptNote:"Impuesto exento en pago en efectivo.",youSaved:"Usted ahorr",generatedOn:"Generado el",printSavePDF:"Imprimir / Guardar como PDF",pageOfPages:"Pgina {{current}} de {{total}}",showingXofY:"Mostrando {{start}}-{{end}} de {{total}}",page:"Pgina",of:"de",lbs:"libras"},navigation:{dashboard:"Panel de Control",accounts:"Plan de Cuentas",balanceSheet:"Balance General",inventory:"Inventario",employees:"Empleados",entryBooks:"Libros de Entrada",consolidate:"Consolidacin Bancaria",reports:"Reportes",settings:"Configuracin"},dashboard:{title:"Panel de Control",welcome:"Bienvenido a HRM Finance",totalRevenue:"Ingresos Totales",overview:"Resumen",recentActivity:"Actividad Reciente",quickActions:"Acciones Rpidas",employeeCount:"Nmero de Empleados",pendingInvoices:"Facturas Pendientes",cashBalance:"Saldo en Efectivo",totalAssets:"Activos Totales",totalLiabilities:"Pasivos Totales",totalExpenses:"Gastos Totales",netIncome:"Ingreso Neto",netLoss:"Prdida Neta",monthlyPayroll:"Nmina Mensual",current:"Actual",newHires:"+3 nuevas contrataciones",outstanding:"Pendiente",totalOutstanding:"$23,450 total",lastUpdatedToday:"ltima actualizacin hoy",commonTasks:"Tareas comunes",generateReport:"Generar Reporte",latestUpdates:"ltimas actualizaciones",invoicePaid:"Factura #1234 pagada",hoursAgo:"hace 2 horas",newEmployeeOnboarded:"Nuevo empleado incorporado",dayAgo:"hace 1 da",monthlyReportGenerated:"Reporte mensual generado",daysAgo:"hace 2 das"},accounts:{title:"Plan de Cuentas",accountNumber:"Nmero de Cuenta",accountName:"Nombre de Cuenta",accountType:"Tipo de Cuenta",category:"Categora",balance:"Saldo",parentAccount:"Cuenta Padre",subAccounts:"Subcuentas",addAccount:"Agregar Cuenta",editAccount:"Editar Cuenta",deleteAccount:"Eliminar Cuenta",accountDetails:"Detalles de Cuenta",transactions:"Transacciones",accountHistory:"Historial de Cuenta",backToAccounts:"Volver a Cuentas",accountNotFound:"Cuenta no encontrada",accountInformation:"Informacin de Cuenta",accountPurpose:"Propsito de la cuenta",transactionHistory:"Historial de Transacciones",noTransactions:"No se encontraron transacciones para esta cuenta",createdDate:"Fecha de Creacin",lastModified:"ltima Modificacin",noDescription:"No se proporcion descripcin.",totalCount:"Conteo total",basicDetails:"Detalles bsicos",currentBalance:"Saldo actual",classification:"Clasificacin",allTransactions:"Todas las transacciones de la cuenta",reference:"Referencia",types:{asset:"Activo",liability:"Pasivo",equity:"Patrimonio",revenue:"Ingreso",expense:"Gasto"},categories:{currentAssets:"Activos Corrientes",fixedAssets:"Activos Fijos",currentLiabilities:"Pasivos Corrientes",longTermLiabilities:"Pasivos a Largo Plazo",ownersEquity:"Patrimonio del Propietario",operatingRevenue:"Ingresos Operacionales",operatingExpenses:"Gastos Operacionales"}},inventory:{title:"Gestin de Inventario",overview:"Resumen",products:"Productos y Stock",movements:"Movimientos",locations:"Ubicaciones",bulkMovement:"Movimiento Masivo",addMovement:"Agregar Movimiento",addProduct:"Agregar Producto",addLocation:"Agregar Ubicacin",singleMovement:"Agregar Movimiento Individual",addNewItem:"Agregar Nuevo Artculo",activeProducts:"Productos Activos",lowStockAlert:"Artculos con Stock Bajo",totalValue:"Valor Total del Stock",activeLocations:"Ubicaciones Activas",productsNeedRestocking:"productos necesitan reabastecimiento",recentMovements:"Movimientos Recientes",noProducts:"No hay productos en esta ubicacin",productName:"Nombre del Producto",productCode:"Cdigo del Producto",sku:"SKU",category:"Categoria",unitOfMeasure:"Unidad de Medida",unitCost:"Costo Unitario",minStockLevel:"Nivel Mnimo de Stock",maxStockLevel:"Nivel Mximo de Stock",locationName:"Nombre de Ubicacin",locationType:"Tipo de Ubicacin",locationCode:"Cdigo de Ubicacin",movementType:"Tipo de Movimiento",referenceNumber:"Nmero de Referencia",invoiceNumber:"Nmero de Factura",fromLocation:"Desde Ubicacin",toLocation:"Hacia Ubicacin",stockIn:"Entrada de Stock",stockOut:"Salida de Stock",transfer:"Transferencia",adjustment:"Ajuste",inStock:"En Stock",lowStock:"Stock Bajo",outOfStock:"Sin Stock",stockLevels:"Niveles de Stock",stockByLocation:"Stock por Ubicacin",searchProducts:"Buscar productos...",searchLocations:"Buscar ubicaciones...",noMovements:"No se encontraron movimientos",productDetails:"Detalles del Producto",locationDetails:"Detalles de Ubicacin",movementDetails:"Detalles del Movimiento",totalProducts:"Total de Productos",totalLocations:"Total de Ubicaciones",lastSeen:"Visto por ltima vez",warehouseType:"Almacn",storeType:"Tienda",supplierType:"Proveedor",customerType:"Cliente",currentlyManaged:"Gestionados actualmente",needAttention:"Necesitan atencin",currentWorth:"Valor actual",warehousesStores:"Almacenes y tiendas",thisMonth:"Este Mes",latestActivities:"ltimas actividades de inventario",searchMovements:"Buscar Movimientos",countingSheet:"Hoja de Conteo",physicalCount:"Conteo Fsico",physicalInventoryCount:"Conteo Fsico de Inventario",setupPhysicalCount:"Configurar Conteo Fsico de Inventario",setupDescription:"Configure los ajustes de su conteo fsico de inventario y comience el proceso de conteo.",countWillInclude:"Este conteo incluir {{count}} productos de {{location}} en la categora {{category}}.",startCounting:"Iniciar Conteo Fsico",counted:"Contado",remaining:"Restante",variances:"Variaciones",complete:"Completo",systemQty:"Cant. Sistema",variance:"Variacin",addNotes:"Agregar notas...",reviewAndConfirm:"Revisar y Confirmar Ajustes",reviewDescription:"Revise los ajustes de inventario a continuacin y confirme para actualizar su sistema.",stockIncreases:"Aumentos de Stock",stockDecreases:"Disminuciones de Stock",totalAdjustments:"Ajustes Totales",confirmAdjustments:"Confirmar Ajustes",adjustment:"Ajuste",perfectCount:"Conteo Perfecto!",noVariances:"No se encontraron variaciones. Su conteo fsico coincide exactamente con el sistema.",physicalCountAdjustment:"Ajuste de conteo fsico",inventoryCountingSheetTitle:"HOJA DE CONTEO DE INVENTARIO",location:"Ubicacin",allCategories:"Todas las Categoras",countedBy:"Contado por",verifiedBy:"Verificado por",instructions:"Instrucciones",countInstructions:["Contar todos los artculos fsicamente presentes en esta ubicacin",'Escribir el conteo real en la columna "Conteo Fsico"',"Dejar en blanco si el artculo no se encuentra",'Anotar cualquier discrepancia en la columna "Notas"',"Firmar y fechar cuando est completo"],productName:"Nombre del Producto",unit:"Unidad",totalProductsListed:"Total de Productos Listados",itemsCounted:"Artculos Contados",summaryFor:"RESUMEN PARA",discrepanciesFound:"Discrepancias Encontradas",counterSignature:"Firma del Contador",supervisorSignature:"Firma del Supervisor",downloadCSV:"Descargar CSV",noAdjustmentsToDownload:"No hay ajustes para descargar",stockIncrease:"Aumento de Stock",stockDecrease:"Disminucin de Stock",purchaseReceive:"Compra/Recepcin",saleIssue:"Venta/Emisin",transfer:"Transferencia",adjustment:"Ajuste",movementType:"Tipo de Movimiento",fromLocation:"Ubicacin de Origen",toLocation:"Ubicacin de Destino",searchSourceLocation:"Buscar ubicacin de origen...",searchDestinationLocation:"Buscar ubicacin de destino...",searchLocation:"Buscar ubicacin...",addProduct:"Agregar Producto",searchProduct:"Buscar producto...",unitCost:"Costo Unitario",noProductsAdded:'No se han agregado productos an. Haga clic en "Agregar Producto" para comenzar.',createMovement:"Crear Movimiento",generalNotesPlaceholder:"Ingrese notas generales para este movimiento...",sortBy:"Ordenar Por",allLocations:"Todas las Ubicaciones",searchByProduct:"Buscar por producto, ubicacin, referencia, notas, factura...",allProducts:"Todos los Productos",bulkMovementReport:"Reporte de Movimiento en Lote",movementDetails:"Detalles del Movimiento",referenceNumber:"Nmero de Referencia",invoiceId:"ID de Factura",totalItems:"Total de Artculos",totalQuantity:"Cantidad Total",estimatedValue:"Valor Estimado",viewHistoricalReports:"Ver Reportes Histricos",noBulkReportsFound:"No se encontraron reportes de movimientos en lote",bulkReportsAppearHere:"Los reportes de movimientos en lote aparecern aqu despus de crear movimientos en lote",allTypes:"Todos los Tipos",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",totalMovements:"Movimientos Totales",totalItems:"Artculos Totales",adjustMovements:"Intenta ajustar tus filtros o revisa ms tarde.",inventoryMovements:"Movimientos de Inventario",createdBy:"Creado Por",view:"Ver",enhanced:"Mejorado",legacy:"Clsico",addSingleMovement:"Agregar Movimiento Individual",inStockSubtitle:"En stock",itemsBelowThreshold:"Artculos bajo el umbral",inventoryWorth:"Valor del inventario",quantity:"Cantidad",units:"unidades",normal:"Normal",productsAndStock:"Productos y Stock",lowStockItems:"Artculos con Stock Bajo",totalStockValue:"Valor Total del Stock",warehousesAndStores:"Almacenes y tiendas",andMore:"...y {count} ms",latestInventoryActivities:"ltimas actividades de inventario",min:"Mn",max:"Mx",cost:"Costo",noProductsFound:"No se encontraron productos que coincidan con su bsqueda.",noProductsAvailable:"No hay productos disponibles.",noLocationsFound:"No se encontraron ubicaciones que coincidan con su bsqueda.",noLocationsAvailable:"No hay ubicaciones disponibles.",searchPlaceholder:"Buscar por producto, ubicacin, referencia, notas, factura...",noMovementsFound:"No se encontraron movimientos",tryAdjustingFilters:"Intenta ajustar tus filtros o revisa ms tarde.",transfers:"Transferencias",adjustments:"Ajustes",bulk:"Masivo",product:"Producto",location:"Ubicacin",store:"Tienda",supplier:"Proveedor",warehouse:"Almacn",movement:"Movimiento",editMovement:"Editar Movimiento",updateMovement:"Actualizar Movimiento",movementInformation:"Informacin del Movimiento",locationInformation:"Informacin de Ubicacin",searchProductsImages:"Buscar productos para ver imgenes...",searchForProducts:"Buscar Productos",startTypingToSearch:"Comienza a escribir para buscar y ver imgenes de productos",tryDifferentSearch:"Prueba con un trmino de bsqueda diferente"},employees:{title:"Gestin de Empleados",employeeList:"Lista de Empleados",addEmployee:"Agregar Empleado",editEmployee:"Editar Empleado",employeeDetails:"Detalles del Empleado",personalInfo:"Informacin Personal",employmentInfo:"Informacin Laboral",payrollInfo:"Informacin de Nmina",firstName:"Nombre",lastName:"Apellido",fullName:"Nombre Completo",email:"Correo Electrnico",phone:"Telfono",address:"Direccin",dateOfBirth:"Fecha de Nacimiento",employeeId:"ID de Empleado",department:"Departamento",position:"Puesto",hireDate:"Fecha de Contratacin",employmentStatus:"Estado Laboral",salary:"Salario",payFrequency:"Frecuencia de Pago",taxId:"ID Fiscal",bankAccount:"Cuenta Bancaria",emergencyContact:"Contacto de Emergencia",activeEmployees:"Empleados Activos",inactiveEmployees:"Empleados Inactivos",totalPayroll:"Nmina Total",searchEmployees:"Buscar empleados...",enterFullName:"Ingrese el nombre completo del empleado",enterPosition:"Ingrese el puesto de trabajo",enterEmail:"Ingrese la direccin de correo electrnico",enterPhone:"Ingrese el nmero de telfono",enterSalary:"Ingrese el salario anual",departments:{engineering:"Ingeniera",product:"Producto",design:"Diseo",marketing:"Marketing",sales:"Ventas",humanResources:"Recursos Humanos",finance:"Finanzas",operations:"Operaciones",analytics:"Analtica"}},entryBooks:{title:"Libros de Entrada",bookName:"Nombre del Libro",bookType:"Tipo de Libro",createBook:"Crear Libro",editBook:"Editar Libro",salesBook:"Libro de Ventas",purchaseBook:"Libro de Compras",cashBook:"Libro de Caja",generalBook:"Libro General",entries:"Entradas",addEntry:"Agregar Entrada",period:"Perodo",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",bookBalance:"Saldo del Libro",reconciledBalance:"Saldo Conciliado",difference:"Diferencia",reconcile:"Conciliar",isReconciled:"Est Conciliado",noBooks:"No se encontraron libros de entrada",createFirst:"Crea tu primer libro de entrada para comenzar",bookDetails:"Detalles del Libro",entriesCount:"entradas",bookOverview:"Resumen y detalles del libro",bookEntries:"Entradas del Libro",allEntries:"Todas las entradas en este libro",noEntries:"No se encontraron entradas",addFirst:"Agrega tu primera entrada a este libro",entryDate:"Fecha de Entrada",entryDescription:"Descripcin de Entrada",entryAmount:"Monto de Entrada",entryReference:"Referencia de Entrada"},banking:{title:"Consolidacin Bancaria",bankAccount:"Cuenta Bancaria",statementDate:"Fecha del Estado",beginningBalance:"Saldo Inicial",endingBalance:"Saldo Final",deposits:"Depsitos",withdrawals:"Retiros",bankCharges:"Cargos Bancarios",interest:"Intereses",reconcile:"Conciliar",matched:"Conciliado",unmatched:"No Conciliado",importStatement:"Importar Estado",manualEntry:"Entrada Manual",autoMatch:"Coincidencia Automtica",clearAll:"Limpiar Todo",reconciliationStatus:"Estado de Conciliacin",difference:"Diferencia",bookBalance:"Saldo en Libros",statementBalance:"Saldo del Estado",outstandingChecks:"Cheques Pendientes",depositsInTransit:"Depsitos en Trnsito",reconciled:"Conciliado",notReconciled:"No Conciliado",unreconciled:"No Conciliado",reconciliation:"Conciliacin",compareStatements:"Comparar estados bancarios con registros de libros de entrada",importCSV:"Importar CSV",startNewReconciliation:"Iniciar Nueva Conciliacin",bankAccountInfo:"Informacin de Cuenta Bancaria",currentAccountDetails:"Detalles de cuenta actual",lastReconciled:"ltima conciliacin",bankTransactions:"Transacciones Bancarias",selectedPeriod:"Perodo seleccionado",pending:"pendiente",bookEntriesForComparison:"Entradas de libros para comparacin",reconciliationRate:"Tasa de Conciliacin",completionStatus:"Estado de finalizacin",recentReconciliationSessions:"Sesiones de Conciliacin Recientes",latestActivity:"Actividad reciente",noRecentSessions:"No se encontraron sesiones de conciliacin recientes.",startFirstReconciliation:"Iniciar Primera Conciliacin",entryBookRecords:"Registros de Libros de Entrada",pleaseUploadCSV:"Por favor suba un archivo CSV",csvRequiresHeaderAndData:"El archivo CSV debe tener al menos un encabezado y una fila de datos",successfullyParsed:"Se analizaron exitosamente {count} filas",errorParsingCSV:"Error al analizar el archivo CSV. Verifique el formato.",dateDescriptionRequired:"Las columnas de Fecha y Descripcin son requeridas",importedTransaction:"Transaccin importada",successfullyImported:"Se importaron exitosamente {count} transacciones bancarias",errorImportingTransactions:"Error al importar transacciones. Verifique sus datos.",importBankStatementCSV:"Importar CSV de Estado Bancario",dropCSVHere:"Suelte el archivo CSV aqu",clickToUploadCSV:"Haga clic para cargar o arrastre y suelte el archivo CSV",supportedFormat:"Formato soportado: CSV con columnas de Fecha, Descripcin y Monto",mapCSVColumns:"Mapear Columnas CSV",dateColumn:"Columna de Fecha",selectColumn:"Seleccionar columna...",descriptionColumn:"Columna de Descripcin",referenceColumn:"Columna de Referencia",amountDebitColumn:"Columna de Monto/Dbito",creditColumn:"Columna de Crdito",balanceColumn:"Columna de Saldo",andMoreRows:"... y {count} filas ms",importing:"Importando...",importTransactions:"Importar {count} Transacciones",reconciliationComparison:"Comparacin de Conciliacin",bankStatements:"Estados Bancarios",totalTransactions:"Transacciones totales",totalEntries:"Entradas totales",unreconciledBank:"Banco No Conciliado",unreconciledBooks:"Libros No Conciliados",needAttention:"Necesitan atencin",unreconcile:"Desconciliar",clickToReconcile:"Hacer clic para conciliar",potentialMatchesFound:"Coincidencias Potenciales Encontradas",clickRecordToReconcile:"Haga clic en un registro a continuacin para conciliar",exactMatch:"Coincidencia Exacta",possibleMatch:"Posible Coincidencia",selected:"Seleccionado",clearSelection:"Limpiar Seleccin"},journal:{title:"Asientos Contables",entryNumber:"Nmero de Asiento",entryDate:"Fecha del Asiento",debit:"Dbito",credit:"Crdito",account:"Cuenta",memo:"Memo",reference:"Referencia",createEntry:"Crear Asiento",editEntry:"Editar Asiento",deleteEntry:"Eliminar Asiento",posted:"Registrado",draft:"Borrador",reversed:"Revertido",recurringEntry:"Asiento Recurrente",attachments:"Adjuntos",totalDebits:"Dbitos Totales",totalCredits:"Crditos Totales",outOfBalance:"Desbalanceado",balanced:"Balanceado"},forms:{requiredField:"Este campo es requerido",invalidEmail:"Direccin de correo invlida",invalidNumber:"Nmero invlido",invalidDate:"Fecha invlida",selectOption:"Por favor seleccione una opcin",enterValue:"Por favor ingrese un valor",confirmDelete:"Est seguro de que desea eliminar este elemento?",unsavedChanges:"Tiene cambios sin guardar. Desea continuar?",saveSuccess:"Guardado exitosamente",saveError:"Error al guardar datos",deleteSuccess:"Eliminado exitosamente",deleteError:"Error al eliminar elemento",duplicateAccountNumber:"El nmero de cuenta ya existe",referenceNumberRequired:"El nmero de referencia es requerido",locationRequired:"La ubicacin es requerida",fromLocationRequired:"La ubicacin de origen es requerida para transferencias",atLeastOneProduct:"Al menos un producto es requerido",itemProductRequired:"El producto es requerido para el artculo {{index}}",itemQuantityRequired:"La cantidad debe ser mayor que 0 para el artculo {{index}}"},modals:{addInventory:"Agregar Movimiento de Inventario",bulkMovement:"Movimiento Masivo de Inventario",addProduct:"Agregar Nuevo Producto",addLocation:"Agregar Nueva Ubicacin",inventoryDetail:"Detalles del Artculo de Inventario",quickAdd:"Agregar Rpido",selectProduct:"Seleccionar Producto",selectLocation:"Seleccionar Ubicacin",enterQuantity:"Ingresar cantidad",enterCost:"Ingresar costo unitario",enterReference:"Ingresar nmero de referencia",addNotes:"Agregar notas (opcional)",generalInformation:"Informacin General",stockInformation:"Informacin de Stock",locationInformation:"Informacin de Ubicacin",movementInformation:"Informacin de Movimiento",addToInventory:"Agregar al Inventario",createProduct:"Crear Producto",createLocation:"Crear Ubicacin",processing:"Procesando...",addingMovement:"Agregando movimiento...",creatingProduct:"Creando producto...",creatingLocation:"Creando ubicacin..."},products:{title:"Productos",addNew:"Agregar Nuevo Producto",totalProducts:"Total de Productos",inCatalog:"En catlogo",activeProducts:"Productos Activos",currentlyAvailable:"Actualmente disponibles",outOfStock:"Sin Stock",needsRestock:"Necesita reabastecimiento",productCatalog:"Catlogo de Productos",manageYourProducts:"Gestiona tus productos y precios",inStock:"En Stock",furniture:"Muebles",electronics:"Electrnicos",supplies:"Suministros",lighting:"Iluminacin"},invoices:{title:"Panel de Facturas",invoice:"Factura",invoices:"Facturas",invoiceNumber:"Nmero de Factura",invoiceDetails:"Detalles de Factura",customerInformation:"Informacin del Cliente",customerName:"Nombre del Cliente",legalName:"Nombre Legal",contactInformation:"Informacin de Contacto",idPassport:"ID/Pasaporte",phoneNumber:"Nmero de Telfono",altPhone:"Telfono Alt.",address:"Direccin",between:"Entre",and:"y",products:"Productos",reservations:"Reservaciones",unitPrice:"Precio Unitario",total:"Total",subtotal:"Subtotal",category:"Categoria",totalRevenue:"Ingresos Totales",totalProducts:"Total de Productos",totalReservations:"Total de Reservaciones",aranceles:"Aranceles (Aduanas)",uniqueCustomers:"Clientes nicos",averageInvoice:"Factura Promedio",completed:"Completada",pending:"Pendiente",storesActive:"Tiendas Activas",topProducts:"Productos Principales",mostSoldProducts:"Productos ms vendidos por cantidad",reservationsByType:"Reservaciones por Tipo",distributionOfCategories:"Distribucin de categoras de reservaciones",recentInvoices:"Facturas Recientes",showingInvoices:"Mostrando {{count}} facturas",date:"Fecha",customer:"Cliente",store:"Tienda",actions:"Acciones",view:"Ver",status:"Estado",printInvoice:"Imprimir Factura",exportPdf:"Exportar PDF",backToDashboard:"Volver al Panel",fromInvoices:"De {{count}} facturas",value:"valor",activeCustomers:"Clientes activos",perInvoiceValue:"Valor por factura",locations:"Ubicaciones",mostRecentActivity:"Actividad ms reciente",storeLocation:"Ubicacin de Tienda",allStores:"Todas las Tiendas",fromDate:"Fecha Desde",toDate:"Fecha Hasta",clearFilters:"Limpiar Filtros",search:"Buscar",searchPlaceholder:"Buscar por # factura, cliente, tienda...",customsFees:"Aranceles totales",salesType:"VENTAS",packagesOrder:"Orden de Paquetes",businessId:"ID de Negocio",orderKey:"Clave de Orden",reservationType:"Tipo de Reservacin",arancel:"Arancel",key:"Clave",noInvoicesFound:"No se encontraron facturas",loadingInvoices:"Cargando facturas...",errorLoadingInvoices:"Error al cargar facturas",refreshData:"Actualizar Datos",currentStockValue:"Valor de Stock Actual",filterByStore:"Filtrar por tienda",filterByDate:"Filtrar por rango de fechas",totalCustomsFees:"Aranceles totales",averageValue:"Valor promedio",senderInformation:"Informacin del Remitente",receiptInformation:"Informacin del Destinatario",productsSubtotal:"Subtotal de Productos",reservationsSubtotal:"Subtotal de Reservaciones",code:"Cdigo",description:"Descripcin",qty:"Cant.",type:"Tipo",id:"ID",passport:"Pasaporte"},unauthorized:{title:"Acceso Restringido",accessDenied:"Acceso Denegado",noPermission:"No tienes permisos para acceder a",thisFeature:"esta funcionalidad",whySeeing:"Por qu veo esto?",explanation:"Tu cuenta no tiene los permisos necesarios para ver este contenido.",requiredPermission:"Permiso requerido:",goToDashboard:"Ir al Panel de Control",goBack:"Regresar",featuresCanAccess:"Funcionalidades a las que puedes acceder:",dashboardAccess:"Panel de control y estadsticas generales",profileAccess:"Tu perfil y configuraciones",roleBasedAccess:"Funcionalidades habilitadas para tu rol",needAccess:"Necesitas acceso? Contacta a tu administrador o gerente para solicitar los permisos apropiados.",permissions:{accountAccess:"Acceso a Gestin de Cuentas",inventoryAccess:"Acceso a Inventario",employeeAccess:"Acceso a Recursos Humanos",bankingAccess:"Acceso Bancario",journalAccess:"Acceso a Asientos Contables",adminAccess:"Acceso Administrativo",financialReporting:"Acceso a Reportes Financieros",invoiceManagement:"Acceso a Gestin de Facturas",productManagement:"Acceso a Gestin de Productos"}}}},iC=()=>{if(typeof window<"u"){const t=localStorage.getItem("hrmfinance-language");if(t&&["en","es"].includes(t))return t}return"en"},[dm,sC]=ye(iC()),ft=()=>({t:(n,o,s)=>{const a=dm(),l=n.split(".");let u=oC[a];for(const m of l)if(u&&typeof u=="object"&&m in u)u=u[m];else return o||n;let h=typeof u=="string"?u:o||n;return s&&typeof h=="string"&&Object.keys(s).forEach(m=>{const v=s[m],_=`{{${m}}}`;h=h.replace(new RegExp(_,"g"),String(v))}),h},language:()=>dm(),setLanguage:n=>{sC(n),typeof window<"u"&&localStorage.setItem("hrmfinance-language",n)}});var aC=z("<div><label></label><select><option value>"),lC=z("<span>*"),cC=z("<option>");const Dr=t=>{const{t:e}=ft(),r={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},n={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},o={"margin-bottom":"1rem"};return(()=>{var s=aC(),a=s.firstChild,l=a.nextSibling,u=l.firstChild;return d(s,o),d(a,r),i(a,()=>t.label,null),i(a,(()=>{var h=ge(()=>!!t.required);return()=>h()&&(()=>{var m=lC();return m.style.setProperty("color","var(--primary-color)"),m})()})(),null),l.addEventListener("blur",h=>h.target.style.borderColor="var(--border-color)"),l.addEventListener("focus",h=>h.target.style.borderColor="var(--primary-color)"),l.addEventListener("change",h=>t.onChange(h.target.value)),d(l,n),i(u,()=>e("forms.selectOption")),i(l,()=>t.options.map(h=>(()=>{var m=cC();return i(m,()=>h.label),X(()=>m.value=h.value),m})()),null),X(h=>{var m=t.required,v=t.disabled;return m!==h.e&&(l.required=h.e=m),v!==h.t&&(l.disabled=h.t=v),h},{e:void 0,t:void 0}),X(()=>l.value=t.value),s})()};var dC=z("<main><div>"),uC=z("<header><h1>");const an=t=>{const e={"min-height":"100vh",background:"var(--background-color)"},r={"max-width":"1200px",margin:"0 auto",padding:"2rem"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},o={"font-size":"2rem","font-weight":"700",color:"var(--text-primary)",margin:"0"};return(()=>{var s=dC(),a=s.firstChild;return d(s,e),d(a,r),i(a,(()=>{var l=ge(()=>!!t.title);return()=>l()&&(()=>{var u=uC(),h=u.firstChild;return d(u,n),d(h,o),i(h,()=>t.title),u})()})(),null),i(a,()=>t.children,null),s})()};var hC=z("<div><span></span><select><option value=en> </option><option value=es> ");const mC=()=>{const{t,language:e,setLanguage:r}=ft(),n={display:"flex","align-items":"center",gap:"0.5rem","margin-left":"auto"},o={padding:"0.5rem 1rem","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",background:"var(--surface-color)",color:"var(--text-primary)",cursor:"pointer","font-size":"0.875rem","font-weight":"500",transition:"all 0.2s ease","min-width":"120px"},s={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},a=l=>{const u=l.target;r(u.value)};return(()=>{var l=hC(),u=l.firstChild,h=u.nextSibling,m=h.firstChild;m.firstChild;var v=m.nextSibling;return v.firstChild,d(l,n),d(u,s),h.addEventListener("change",a),d(h,o),i(m,()=>t("common.english"),null),i(v,()=>t("common.spanish"),null),X(()=>h.value=e()),l})()};var um=z('<img alt="User avatar">'),yC=z("<div class=user-info-desktop><span>"),pC=z("<button class=sign-out-desktop>Sign Out"),fC=z("<div><div><span></span></div><button>Sign Out"),gC=z(`<nav><div><div class=desktop-nav></div><div><button class=mobile-menu-button><svg width=24 height=24 viewBox="0 0 24 24"fill=currentColor><path></path></svg></button></div></div><div class=mobile-nav></div><style>
        .nav-active {
          background: linear-gradient(135deg, var(--primary-color), var(--primary-dark)) !important;
          color: white !important;
          box-shadow: var(--shadow-sm);
        }
        
        .desktop-nav a:hover:not(.nav-active),
        .nav-group button:hover {
          background: var(--background-color);
          color: var(--text-primary);
        }
        
        .mobile-nav a:hover:not(.nav-active) {
          background: var(--background-color);
          color: var(--text-primary);
        }

        /* Create invisible bridge to prevent gap issues */
        .nav-group::before {
          content: '';
          position: absolute;
          top: 100%;
          left: 0;
          right: 0;
          height: 0.5rem;
          z-index: 9;
        }
        
        @media (max-width: 768px) {
          .desktop-nav {
            display: none !important;
          }
          
          .mobile-menu-button {
            display: block !important;
          }
          
          .user-info-desktop,
          .sign-out-desktop {
            display: none !important;
          }
          
          nav > div:first-child {
            padding: 1rem;
          }
        }
        
        @media (min-width: 769px) {
          .mobile-nav {
            display: none !important;
          }
        }
      `),vC=z("<div class=nav-group><button> <span></span></button><div>"),bC=z("<div>"),_C=z("<div><div><span> </span><span>");const SC=()=>{const{t}=ft(),[e,r]=ye(!1),[n,o]=ye(null),[s,a]=ye(null),l={background:"var(--surface-color)","border-bottom":"1px solid var(--border-color)","box-shadow":"var(--shadow-sm)","backdrop-filter":"blur(10px)",position:"sticky",top:"0","z-index":"100"},u={display:"flex","align-items":"center","justify-content":"space-between",padding:"1rem 2rem",margin:"0 auto",position:"relative"},h={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","text-decoration":"none"},m={display:"flex",gap:"1rem","align-items":"center",flex:"1","margin-left":"2rem"},v={display:"none",position:"absolute",top:"100%",left:"0",right:"0",background:"var(--surface-color)","border-top":"1px solid var(--border-color)","box-shadow":"var(--shadow-md)","max-height":"70vh","overflow-y":"auto"},_={position:"relative",display:"flex","align-items":"center"},x={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem",background:"transparent",border:"none",color:"var(--text-secondary)","font-weight":"500","font-size":"0.875rem",cursor:"pointer","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease","white-space":"nowrap"},T={position:"absolute",top:"100%",left:"0",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)","min-width":"200px","margin-top":"0.25rem","z-index":"10",display:"none","padding-top":"0.25rem"},E={"border-bottom":"1px solid var(--border-color)"},P={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",cursor:"pointer","font-weight":"600",color:"var(--text-primary)"},R={display:"block","text-decoration":"none",color:"var(--text-secondary)",padding:"0.75rem 1rem","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease","white-space":"nowrap"},Y={...R,padding:"0.75rem 1.5rem","border-bottom":"1px solid var(--border-light)"},Z={display:"none",background:"transparent",border:"none",padding:"0.5rem",cursor:"pointer",color:"var(--text-primary)"},j={display:"flex","align-items":"center",gap:"1rem"},B={display:"flex","align-items":"center",gap:"0.75rem",padding:"0.5rem 1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",color:"var(--text-primary)"},V={width:"32px",height:"32px","border-radius":"50%","object-fit":"cover"},f={...R,cursor:"pointer",border:"1px solid var(--border-color)",background:"transparent","border-radius":"var(--border-radius-sm)"},g=()=>{Lt.signOut()},S=O=>{const N=Lt.state?.profile;return N?N[O]===!0||N.isAdmin===!0:!1},$=()=>{r(!e())},w=O=>{o(n()===O?null:O)},I=O=>{const N=s();N&&(clearTimeout(N),a(null)),o(O)},y=()=>{const O=setTimeout(()=>{o(null)},300);a(O)},de=[{name:"Finance",icon:"",items:[{path:"/accounts",label:t("navigation.accounts"),permission:"AccountAccess",icon:""},{path:"/entry-books",label:t("navigation.entryBooks"),permission:"JournalAccess",icon:""},{path:"/balance-sheet",label:t("navigation.balanceSheet"),permission:"AccountAccess",icon:""},{path:"/bank-consolidations",label:t("navigation.consolidate"),permission:"BankingAccess",icon:""}]},{name:"Operations",icon:"",items:[{path:"/inventory",label:t("navigation.inventory"),permission:"InventoryAccess",icon:""},{path:"/invoices",label:t("invoices.invoices"),permission:"invoiceAccess",icon:""}]},{name:"Management",icon:"",items:[{path:"/employees",label:t("navigation.employees"),permission:"EmployeeAccess",icon:""},{path:"/admin/users",label:"Admin",permission:"isAdmin",icon:"",adminOnly:!0}]}],J=()=>de.map(O=>({...O,items:O.items.filter(N=>N.adminOnly?Lt.state?.profile?.isAdmin:S(N.permission))})).filter(O=>O.items.length>0);return(()=>{var O=gC(),N=O.firstChild,q=N.firstChild,D=q.nextSibling,C=D.firstChild,F=C.firstChild,ee=F.firstChild,H=N.nextSibling;return i(N,b(li,{href:"/",style:h,children:"HRM Finance"}),q),d(q,m),i(q,b(li,{href:"/",style:R,activeClass:"nav-active",get children(){return[" ",ge(()=>t("navigation.dashboard"))]}}),null),i(q,b(ut,{get each(){return J()},children:oe=>(()=>{var M=vC(),G=M.firstChild,le=G.firstChild,ne=le.nextSibling,ue=G.nextSibling;return M.addEventListener("mouseleave",y),M.addEventListener("mouseenter",()=>I(oe.name)),i(G,()=>oe.icon,le),i(G,()=>oe.name,ne),ne.style.setProperty("font-size","0.75rem"),ue.addEventListener("mouseleave",y),ue.addEventListener("mouseenter",()=>I(oe.name)),i(ue,b(ut,{get each(){return oe.items},children:L=>b(li,{get href(){return L.path},style:R,activeClass:"nav-active",onClick:()=>o(null),get children(){return[ge(()=>L.icon)," ",ge(()=>L.label)]}})})),X(L=>{var A=_,U=x,te={...T,display:n()===oe.name?"block":"none"};return L.e=d(M,A,L.e),L.t=d(G,U,L.t),L.a=d(ue,te,L.a),L},{e:void 0,t:void 0,a:void 0}),M})()}),null),d(D,j),i(D,b(mC,{}),C),i(D,b(Ae,{get when(){return Lt.currentUser},get children(){return[(()=>{var oe=yC(),M=oe.firstChild;return i(oe,b(Ae,{get when(){return Lt.currentUser?.photoURL},get children(){var G=um();return X(le=>{var ne=Lt.currentUser.photoURL,ue=V;return ne!==le.e&&ct(G,"src",le.e=ne),le.t=d(G,ue,le.t),le},{e:void 0,t:void 0}),G}}),M),i(M,()=>Lt.currentUser?.displayName||Lt.currentUser?.email),X(G=>d(oe,B,G)),oe})(),(()=>{var oe=pC();return oe.addEventListener("mouseleave",M=>{M.currentTarget.style.background="transparent",M.currentTarget.style.color="var(--text-secondary)"}),oe.addEventListener("mouseenter",M=>{M.currentTarget.style.background="var(--background-color)",M.currentTarget.style.color="var(--text-primary)"}),oe.$$click=g,X(M=>d(oe,f,M)),oe})()]}}),C),C.$$click=$,d(C,Z),i(H,b(li,{href:"/",style:Y,activeClass:"nav-active",onClick:()=>r(!1),get children(){return[" ",ge(()=>t("navigation.dashboard"))]}}),null),i(H,b(ut,{get each(){return J()},children:oe=>(()=>{var M=_C(),G=M.firstChild,le=G.firstChild,ne=le.firstChild,ue=le.nextSibling;return d(M,E),G.$$click=()=>w(oe.name),d(G,P),i(le,()=>oe.icon,ne),i(le,()=>oe.name,null),ue.style.setProperty("transition","transform 0.2s"),i(M,b(Ae,{get when(){return n()===oe.name},get children(){var L=bC();return L.style.setProperty("background","var(--background-color)"),i(L,b(ut,{get each(){return oe.items},children:A=>b(li,{get href(){return A.path},get style(){return{...Y,"padding-left":"3rem"}},activeClass:"nav-active",onClick:()=>r(!1),get children(){return[ge(()=>A.icon)," ",ge(()=>A.label)]}})})),L}}),null),X(L=>(L=n()===oe.name?"rotate(180deg)":"none")!=null?ue.style.setProperty("transform",L):ue.style.removeProperty("transform")),M})()}),null),i(H,b(Ae,{get when(){return Lt.currentUser},get children(){var oe=fC(),M=oe.firstChild,G=M.firstChild,le=M.nextSibling;return oe.style.setProperty("padding","1rem"),oe.style.setProperty("border-top","2px solid var(--border-color)"),i(M,b(Ae,{get when(){return Lt.currentUser?.photoURL},get children(){var ne=um();return X(ue=>{var L=Lt.currentUser.photoURL,A=V;return L!==ue.e&&ct(ne,"src",ue.e=L),ue.t=d(ne,A,ue.t),ue},{e:void 0,t:void 0}),ne}}),G),i(G,()=>Lt.currentUser?.displayName||Lt.currentUser?.email),le.$$click=()=>{g(),r(!1)},X(ne=>{var ue={...B,"margin-bottom":"1rem"},L={...f,width:"100%"};return ne.e=d(M,ue,ne.e),ne.t=d(le,L,ne.t),ne},{e:void 0,t:void 0}),oe}}),null),X(oe=>{var M=l,G=u,le=e()?"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z":"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z",ne={...v,display:e()?"block":"none"};return oe.e=d(O,M,oe.e),oe.t=d(N,G,oe.t),le!==oe.a&&ct(ee,"d",oe.a=le),oe.o=d(H,ne,oe.o),oe},{e:void 0,t:void 0,a:void 0,o:void 0}),O})()};wt(["click"]);var PC=z("<div><div><div></div><h1></h1><p>.</p><div><p><strong></strong><br></p></div><div><button></button></div><div><h3></h3><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div></div><div><p>"),hm=z("<br>"),wC=z("<strong>");const CC=t=>{const{t:e}=ft(),r={"min-height":"calc(100vh - 200px)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},n={"text-align":"center","max-width":"600px",width:"100%"},o={"font-size":"5rem",color:"#e53e3e","margin-bottom":"2rem"},s={"font-size":"2.5rem","font-weight":"700",color:"#1a202c","margin-bottom":"1rem"},a={"font-size":"1.25rem",color:"#718096","margin-bottom":"2rem","line-height":"1.6"},l={background:"#f7fafc",border:"1px solid #e2e8f0","border-radius":"0.5rem",padding:"1.5rem","margin-bottom":"2rem"},u={color:"#4a5568","font-size":"1rem","line-height":"1.6"},h={display:"flex",gap:"1rem","justify-content":"center","flex-wrap":"wrap"},m={padding:"0.75rem 2rem","border-radius":"0.5rem","text-decoration":"none","font-weight":"500",transition:"all 0.2s",display:"inline-block"},v={...m,background:"var(--primary-color)",color:"white",border:"2px solid var(--primary-color)"},_={...m,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},x={"text-align":"left","margin-top":"2rem",padding:"0 2rem"},T={display:"flex","align-items":"center",gap:"0.75rem","margin-bottom":"1rem",color:"#4a5568"},E={color:"#48bb78","font-size":"1.25rem"};return b(an,{get title(){return e("unauthorized.title")},get children(){var P=PC(),R=P.firstChild,Y=R.firstChild,Z=Y.nextSibling,j=Z.nextSibling,B=j.firstChild,V=j.nextSibling,f=V.firstChild,g=f.firstChild;g.nextSibling;var S=V.nextSibling,$=S.firstChild,w=S.nextSibling,I=w.firstChild,y=I.nextSibling,de=y.firstChild,J=de.nextSibling,O=y.nextSibling,N=O.firstChild,q=N.nextSibling,D=O.nextSibling,C=D.firstChild,F=C.nextSibling,ee=w.nextSibling,H=ee.firstChild;return d(P,r),d(R,n),d(Y,o),d(Z,s),i(Z,()=>e("unauthorized.accessDenied")),d(j,a),i(j,()=>e("unauthorized.noPermission"),B),i(j,(()=>{var oe=ge(()=>!!t.featureName);return()=>oe()?` ${t.featureName}`:` ${e("unauthorized.thisFeature")}`})(),B),d(V,l),d(f,u),i(g,()=>e("unauthorized.whySeeing")),i(f,()=>e("unauthorized.explanation"),null),i(f,(()=>{var oe=ge(()=>!!t.requiredPermission);return()=>oe()&&[hm(),hm(),(()=>{var M=wC();return i(M,()=>e("unauthorized.requiredPermission")),M})()," ",ge(()=>t.requiredPermission)]})(),null),d(S,h),i(S,b(li,{href:"/",style:v,get children(){return e("unauthorized.goToDashboard")}}),$),$.$$click=()=>window.history.back(),i($,()=>e("unauthorized.goBack")),d(w,x),I.style.setProperty("margin-bottom","1rem"),I.style.setProperty("color","#2d3748"),i(I,()=>e("unauthorized.featuresCanAccess")),i(J,()=>e("unauthorized.dashboardAccess")),i(q,()=>e("unauthorized.profileAccess")),i(F,()=>e("unauthorized.roleBasedAccess")),ee.style.setProperty("margin-top","3rem"),ee.style.setProperty("padding","1.5rem"),ee.style.setProperty("background","#edf2f7"),ee.style.setProperty("border-radius","0.5rem"),H.style.setProperty("color","#4a5568"),H.style.setProperty("font-size","0.875rem"),i(H,()=>e("unauthorized.needAccess")),X(oe=>{var M=_,G=T,le=E,ne=T,ue=E,L=T,A=E;return oe.e=d($,M,oe.e),oe.t=d(y,G,oe.t),oe.a=d(de,le,oe.a),oe.o=d(O,ne,oe.o),oe.i=d(N,ue,oe.i),oe.n=d(D,L,oe.n),oe.s=d(C,A,oe.s),oe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),P}})};wt(["click"]);const An=t=>{const{t:e}=ft(),r=()=>{if(!t.permission)return!0;const o=Lt.state?.profile;if(!o)return!1;if(o.isAdmin)return!0;switch(t.permission){case"AccountAccess":return o.AccountAccess===!0;case"InventoryAccess":return o.InventoryAccess===!0;case"EmployeeAccess":return o.EmployeeAccess===!0;case"BankingAccess":return o.BankingAccess===!0;case"JournalAccess":return o.JournalAccess===!0;case"AdminAccess":return o.isAdmin===!0;default:return o[t.permission]===!0}},n=()=>{if(t.requiredPermission)return t.requiredPermission;switch(t.permission){case"AccountAccess":return e("unauthorized.permissions.accountAccess");case"InventoryAccess":return e("unauthorized.permissions.inventoryAccess");case"EmployeeAccess":return e("unauthorized.permissions.employeeAccess");case"BankingAccess":return e("unauthorized.permissions.bankingAccess");case"JournalAccess":return e("unauthorized.permissions.journalAccess");case"AdminAccess":return e("unauthorized.permissions.adminAccess");default:return t.permission}};return b(Ae,{get when(){return r()},get fallback(){return t.fallback||b(CC,{get featureName(){return t.featureName},get requiredPermission(){return n()}})},get children(){return t.children}})};var xC=z('<button title="Open Dev Tools">'),$C=z("<span>(<!>)"),AC=z("<div><span></span><span>"),mm=z("<div>"),IC=z("<div>Database reset only available in fake mode"),EC=z("<div><div>Loading..."),TC=z("<div><div><h3> Dev Tools</h3><button></button></div><div><div>API Mode</div><div><button>Fake Server</button><button>Real API</button><button>Hybrid</button></div><div>Current: <strong></strong></div></div><div><div>Health Status</div></div><div><div>Database Stats</div></div><div><div>Actions</div><div><button> Refresh Stats</button><button> Health Check</button></div><div><button> Reset DB</button></div></div><div><div>Info</div><div> <strong>Fake Server:</strong> Uses local mock data<br> <strong>Real API:</strong> Connects to actual backend<br> <strong>Hybrid:</strong> Real API with fake fallback<br> Settings are saved in localStorage"),kC=z("<div>Loading..."),RC=z("<div><span>:</span><span>");const DC=()=>{const[t,e]=ye(!1),[r,n]=ye(ms.getMode()),[o,s]=ye({}),[a,l]=ye(null),[u,h]=ye(!1);$r(async()=>{await m(),await v()});const m=async()=>{try{const f=await Nu.getStats();s(f)}catch(f){console.error("Failed to load stats:",f)}},v=async()=>{try{const f=await Nu.healthCheck();l(f)}catch(f){console.error("Health check failed:",f),l({status:"error",error:f.message})}},_=async f=>{h(!0);try{ms.setMode(f),n(f),await m(),await v()}catch(g){console.error("Failed to change API mode:",g)}finally{h(!1)}},x=async()=>{if(confirm("Are you sure you want to reset the fake database to its initial state?")){h(!0);try{const f=await Rr.utils.resetDatabase();alert(f.message),await m()}catch(f){console.error("Failed to reset database:",f),alert("Failed to reset database")}finally{h(!1)}}},T={position:"fixed",bottom:"20px",right:"20px","z-index":"10000","font-family":"monospace"},E={background:"#1a1a1a",color:"#fff",border:"1px solid #333","border-radius":"8px",padding:"16px","min-width":"300px","max-width":"400px","box-shadow":"0 4px 20px rgba(0,0,0,0.3)"},P={background:"#007acc",color:"#fff",border:"none","border-radius":"50%",width:"50px",height:"50px",cursor:"pointer","font-size":"20px","box-shadow":"0 2px 10px rgba(0,0,0,0.2)",display:"flex","align-items":"center","justify-content":"center"},R={background:"#333",color:"#fff",border:"1px solid #555","border-radius":"4px",padding:"6px 12px",cursor:"pointer","font-size":"12px","margin-right":"8px","margin-bottom":"8px"},Y={...R,background:"#007acc","border-color":"#007acc"},Z={"margin-bottom":"16px","padding-bottom":"12px","border-bottom":"1px solid #333"},j={"font-size":"14px","font-weight":"bold","margin-bottom":"8px",color:"#007acc"},B={display:"flex","justify-content":"space-between","font-size":"12px","margin-bottom":"4px"},V=f=>({display:"inline-block",width:"8px",height:"8px","border-radius":"50%","margin-right":"8px",background:f==="healthy"?"#00ff00":f==="error"?"#ff0000":"#ffff00"});return(()=>{var f=mm();return i(f,b(Ae,{get when(){return!t()},get children(){var g=xC();return g.$$click=()=>e(!0),d(g,P),g}}),null),i(f,b(Ae,{get when(){return t()},get children(){var g=TC(),S=g.firstChild,$=S.firstChild,w=$.nextSibling,I=S.nextSibling,y=I.firstChild,de=y.nextSibling,J=de.firstChild,O=J.nextSibling,N=O.nextSibling,q=de.nextSibling,D=q.firstChild,C=D.nextSibling,F=I.nextSibling,ee=F.firstChild,H=F.nextSibling,oe=H.firstChild,M=H.nextSibling,G=M.firstChild,le=G.nextSibling,ne=le.firstChild,ue=ne.nextSibling,L=le.nextSibling,A=L.firstChild,U=M.nextSibling,te=U.firstChild,ae=te.nextSibling;return d(g,E),S.style.setProperty("display","flex"),S.style.setProperty("justify-content","space-between"),S.style.setProperty("align-items","center"),S.style.setProperty("margin-bottom","16px"),$.style.setProperty("margin","0"),$.style.setProperty("color","#007acc"),$.style.setProperty("font-size","16px"),w.$$click=()=>e(!1),J.$$click=()=>_("fake"),O.$$click=()=>_("real"),N.$$click=()=>_("hybrid"),q.style.setProperty("font-size","11px"),q.style.setProperty("color","#888"),q.style.setProperty("margin-top","4px"),i(C,r),i(q,()=>r()==="fake"&&" (Using fake server)",null),i(q,()=>r()==="real"&&" (Using real API)",null),i(q,()=>r()==="hybrid"&&" (Real API with fallback)",null),i(F,b(Ae,{get when(){return a()},get fallback(){return(()=>{var re=kC();return re.style.setProperty("font-size","12px"),re})()},get children(){return[(()=>{var re=AC(),ce=re.firstChild,Q=ce.nextSibling;return re.style.setProperty("display","flex"),re.style.setProperty("align-items","center"),re.style.setProperty("font-size","12px"),i(Q,()=>a()?.status||"Unknown"),i(re,b(Ae,{get when(){return a()?.timestamp},get children(){var me=$C(),K=me.firstChild,he=K.nextSibling;return he.nextSibling,me.style.setProperty("margin-left","8px"),me.style.setProperty("color","#888"),i(me,()=>new Date(a().timestamp).toLocaleTimeString(),he),me}}),null),X(me=>d(ce,V(a()?.status||"unknown"),me)),re})(),b(Ae,{get when(){return a()?.error},get children(){var re=mm();return re.style.setProperty("font-size","11px"),re.style.setProperty("color","#ff6666"),re.style.setProperty("margin-top","4px"),i(re,()=>a().error),re}})]}}),null),i(H,b(ut,{get each(){return Object.entries(o())},children:([re,ce])=>(()=>{var Q=RC(),me=Q.firstChild,K=me.firstChild,he=me.nextSibling;return d(Q,B),me.style.setProperty("text-transform","capitalize"),i(me,re,K),he.style.setProperty("color","#00ff00"),i(he,ce),Q})()}),null),ne.$$click=m,ue.$$click=v,L.style.setProperty("margin-top","8px"),A.$$click=x,i(M,b(Ae,{get when(){return r()!=="fake"},get children(){var re=IC();return re.style.setProperty("font-size","11px"),re.style.setProperty("color","#888"),re.style.setProperty("margin-top","4px"),re}}),null),ae.style.setProperty("font-size","11px"),ae.style.setProperty("color","#888"),ae.style.setProperty("line-height","1.4"),i(g,b(Ae,{get when(){return u()},get children(){var re=EC(),ce=re.firstChild;return re.style.setProperty("position","absolute"),re.style.setProperty("top","0"),re.style.setProperty("left","0"),re.style.setProperty("right","0"),re.style.setProperty("bottom","0"),re.style.setProperty("background","rgba(0,0,0,0.7)"),re.style.setProperty("display","flex"),re.style.setProperty("align-items","center"),re.style.setProperty("justify-content","center"),re.style.setProperty("border-radius","8px"),ce.style.setProperty("color","#fff"),ce.style.setProperty("font-size","14px"),re}}),null),X(re=>{var ce={...R,padding:"4px 8px"},Q=Z,me=j,K=r()==="fake"?Y:R,he=u(),ve=r()==="real"?Y:R,W=u(),ie=r()==="hybrid"?Y:R,Pe=u(),_e=Z,fe=j,be=Z,pe=j,we=Z,De=j,ke=R,Te=u(),Ue=R,Xe=u(),ze={...R,background:"#cc4400","border-color":"#cc4400"},$e=u()||r()!=="fake",Ge=j;return re.e=d(w,ce,re.e),re.t=d(I,Q,re.t),re.a=d(y,me,re.a),re.o=d(J,K,re.o),he!==re.i&&(J.disabled=re.i=he),re.n=d(O,ve,re.n),W!==re.s&&(O.disabled=re.s=W),re.h=d(N,ie,re.h),Pe!==re.r&&(N.disabled=re.r=Pe),re.d=d(F,_e,re.d),re.l=d(ee,fe,re.l),re.u=d(H,be,re.u),re.c=d(oe,pe,re.c),re.w=d(M,we,re.w),re.m=d(G,De,re.m),re.f=d(ne,ke,re.f),Te!==re.y&&(ne.disabled=re.y=Te),re.g=d(ue,Ue,re.g),Xe!==re.p&&(ue.disabled=re.p=Xe),re.b=d(A,ze,re.b),$e!==re.T&&(A.disabled=re.T=$e),re.A=d(te,Ge,re.A),re},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),g}}),null),X(g=>d(f,T,g)),f})()};wt(["click"]);const NC=[{id:"1",accountNumber:"1000",name:"Cash and Cash Equivalents",type:"Asset",category:"Current Assets",description:"Cash on hand and in bank accounts",balance:45230.5,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1001",accountNumber:"1001",name:"Petty Cash",type:"Asset",category:"Current Assets",description:"Small amounts of cash for minor expenses",balance:500,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1002",accountNumber:"1002",name:"Bank - Checking Account",type:"Asset",category:"Current Assets",description:"Main operating checking account",balance:32730.5,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1003",accountNumber:"1003",name:"Bank - Savings Account",type:"Asset",category:"Current Assets",description:"Interest-bearing savings account",balance:12e3,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"2",accountNumber:"1100",name:"Accounts Receivable",type:"Asset",category:"Current Assets",description:"Money owed by customers",balance:23450.75,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2001",accountNumber:"1101",name:"Trade Receivables",type:"Asset",category:"Current Assets",description:"Receivables from regular customers",balance:18450.75,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2002",accountNumber:"1102",name:"Employee Advances",type:"Asset",category:"Current Assets",description:"Money advanced to employees",balance:5e3,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"3",accountNumber:"1200",name:"Inventory",type:"Asset",category:"Current Assets",description:"Products held for sale",balance:78920.25,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-13"},{id:"4",accountNumber:"1500",name:"Equipment",type:"Asset",category:"Fixed Assets",description:"Office equipment and machinery",balance:125e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-12"},{id:"5",accountNumber:"2000",name:"Accounts Payable",type:"Liability",category:"Current Liabilities",description:"Money owed to suppliers",balance:15670.3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-11"},{id:"6",accountNumber:"2100",name:"Accrued Expenses",type:"Liability",category:"Current Liabilities",description:"Expenses incurred but not yet paid",balance:8945.6,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-10"},{id:"7",accountNumber:"2500",name:"Long-term Debt",type:"Liability",category:"Long-term Liabilities",description:"Long-term loans and mortgages",balance:85e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-09"},{id:"8",accountNumber:"3000",name:"Owner's Equity",type:"Equity",category:"Owner's Equity",description:"Owner's investment in the business",balance:15e4,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-08"},{id:"9",accountNumber:"3100",name:"Retained Earnings",type:"Equity",category:"Owner's Equity",description:"Accumulated profits retained in business",balance:32450.8,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-07"},{id:"10",accountNumber:"4000",name:"Sales Revenue",type:"Revenue",category:"Operating Revenue",description:"Revenue from product sales",balance:245678.9,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-06"},{id:"11",accountNumber:"4100",name:"Service Revenue",type:"Revenue",category:"Operating Revenue",description:"Revenue from services provided",balance:89432.15,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-05"},{id:"12",accountNumber:"5000",name:"Cost of Goods Sold",type:"Expense",category:"Operating Expenses",description:"Direct costs of producing goods",balance:125678.45,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-04"},{id:"13",accountNumber:"5100",name:"Salaries Expense",type:"Expense",category:"Operating Expenses",description:"Employee salary expenses",balance:98765.32,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-03"},{id:"14",accountNumber:"5200",name:"Rent Expense",type:"Expense",category:"Operating Expenses",description:"Office rent expenses",balance:24e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-02"}],LC=[{id:"1",accountId:"1",date:"2024-01-15",description:"Customer payment received",debitAmount:5e3,creditAmount:0,reference:"INV-2024-001",type:"debit"},{id:"2",accountId:"2",date:"2024-01-15",description:"Customer payment received",debitAmount:0,creditAmount:5e3,reference:"INV-2024-001",type:"credit"},{id:"3",accountId:"5",date:"2024-01-14",description:"Office supplies purchased",debitAmount:0,creditAmount:1250,reference:"PO-2024-001",type:"credit"}],[In,ta]=ye(NC),[Yl,MC]=ye(LC),Ft={get accounts(){return In()},get transactions(){return Yl()},fetchAllAccount(t){const e={...t,id:Date.now().toString(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return ta([...In(),e]),e},addAccount(t){const e={...t,id:Date.now().toString(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return ta([...In(),e]),e},updateAccount(t,e){ta(In().map(r=>r.id===t?{...r,...e,lastModified:new Date().toISOString().split("T")[0]}:r))},deleteAccount(t){ta(In().filter(e=>e.id!==t))},getAccountById(t){return In().find(e=>e.id===t)},getAccountsByType(t){return In().filter(e=>e.type===t)},getAccountTransactions(t){return Yl().filter(e=>e.accountId===t)},addTransaction(t){const e={...t,id:Date.now().toString()};MC([...Yl(),e]);const r=this.getAccountById(t.accountId);if(r){const n=t.type==="debit"?t.debitAmount:-t.creditAmount;this.updateAccount(t.accountId,{balance:r.balance+n})}return e},getTotalByType(t){return In().filter(e=>e.type===t&&e.isActive).reduce((e,r)=>e+r.balance,0)},getAccountCategories(t){const e=this.getAccountsByType(t);return[...new Set(e.map(r=>r.category))]},getSubAccounts(t){return In().filter(e=>e.parentAccountId===t)},getParentAccounts(){return In().filter(t=>!t.parentAccountId)},getAccountHierarchy(){return this.getParentAccounts().map(e=>({...e,subAccounts:this.getSubAccounts(e.id)}))},getAccountWithSubAccounts(t){const e=this.getAccountById(t);return e?{...e,subAccounts:this.getSubAccounts(t),parentAccount:e.parentAccountId?this.getAccountById(e.parentAccountId):null}:null},getAccountPath(t){const e=this.getAccountById(t);if(!e)return[];const r=[e];let n=e;for(;n.parentAccountId;){const o=this.getAccountById(n.parentAccountId);if(o)r.unshift(o),n=o;else break}return r},getTotalBalanceWithSubAccounts(t){const e=this.getAccountById(t);if(!e)return 0;const n=this.getSubAccounts(t).reduce((o,s)=>o+this.getTotalBalanceWithSubAccounts(s.id),0);return e.balance+n},canDeleteAccount(t){const e=this.getSubAccounts(t);if(e.length>0)return{canDelete:!1,reason:`Account has ${e.length} sub-account(s). Delete or move sub-accounts first.`};const r=this.getAccountTransactions(t);return r.length>0?{canDelete:!1,reason:`Account has ${r.length} transaction(s). Cannot delete account with transaction history.`}:{canDelete:!0}}};var oo=z("<div>"),Bi=z("<div> ");const OC=()=>{const{t}=ft(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},n={"font-size":"0.875rem",color:"var(--text-muted)"},o=E=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(E),s=Ft.getTotalByType("Asset"),a=Ft.getTotalByType("Liability"),l=Ft.getTotalByType("Equity"),u=Ft.getTotalByType("Revenue"),h=Ft.getTotalByType("Expense"),m=Ft.getAccountsByType("Asset").length,v=Ft.getAccountsByType("Liability").length,_=Ft.getAccountsByType("Equity").length,x=Ft.getAccountsByType("Revenue").length,T=Ft.getAccountsByType("Expense").length;return(()=>{var E=oo();return d(E,e),i(E,b(rt,{get title(){return t("dashboard.totalAssets")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var P=oo();return i(P,()=>o(s)),X(R=>d(P,r,R)),P})(),(()=>{var P=Bi(),R=P.firstChild;return i(P,m,R),i(P,()=>t("navigation.accounts"),null),X(Y=>d(P,n,Y)),P})()]}}),null),i(E,b(rt,{get title(){return t("dashboard.totalLiabilities")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var P=oo();return i(P,()=>o(a)),X(R=>d(P,r,R)),P})(),(()=>{var P=Bi(),R=P.firstChild;return i(P,v,R),i(P,()=>t("navigation.accounts"),null),X(Y=>d(P,n,Y)),P})()]}}),null),i(E,b(rt,{get title(){return t("dashboard.totalEquity")},get subtitle(){return t("accounts.categories.ownersEquity")},get children(){return[(()=>{var P=oo();return i(P,()=>o(l)),X(R=>d(P,r,R)),P})(),(()=>{var P=Bi(),R=P.firstChild;return i(P,_,R),i(P,()=>t("navigation.accounts"),null),X(Y=>d(P,n,Y)),P})()]}}),null),i(E,b(rt,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("accounts.categories.operatingRevenue")},get children(){return[(()=>{var P=oo();return i(P,()=>o(u)),X(R=>d(P,r,R)),P})(),(()=>{var P=Bi(),R=P.firstChild;return i(P,x,R),i(P,()=>t("navigation.accounts"),null),X(Y=>d(P,n,Y)),P})()]}}),null),i(E,b(rt,{get title(){return t("dashboard.totalExpenses")},get subtitle(){return t("accounts.categories.operatingExpenses")},get children(){return[(()=>{var P=oo();return i(P,()=>o(h)),X(R=>d(P,r,R)),P})(),(()=>{var P=Bi(),R=P.firstChild;return i(P,T,R),i(P,()=>t("navigation.accounts"),null),X(Y=>d(P,n,Y)),P})()]}}),null),i(E,b(rt,{get title(){return t("dashboard.netIncome")},get subtitle(){return`${t("dashboard.totalRevenue")} - ${t("dashboard.totalExpenses")}`},get children(){return[(()=>{var P=oo();return i(P,()=>o(u-h)),X(R=>d(P,{...r,color:u-h>=0?"#4caf50":"#f44336"},R)),P})(),(()=>{var P=oo();return i(P,()=>u-h>=0?t("dashboard.netIncome"):t("dashboard.netLoss")),X(R=>d(P,n,R)),P})()]}}),null),E})()};var FC=z("<div><div></div><div>"),VC=z("<h3>"),Ui=z("<div>");const BC=t=>{const{t:e}=ft();nd();const r={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},o={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"},s={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},a={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},l={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem"},u={"font-size":"0.875rem",color:"var(--text-secondary)","line-height":"1.4"},h=_=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[_]||{bg:"#f5f5f5",color:"#666"},m=_=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(_),v=h(t.account.type);return b(rt,{get children(){return[(()=>{var _=FC(),x=_.firstChild,T=x.nextSibling;return d(_,n),d(x,o),i(x,()=>t.account.accountNumber),i(T,()=>e(`accounts.types.${t.account.type.toLowerCase()}`)),X(E=>d(T,{...s,background:v.bg,color:v.color},E)),_})(),(()=>{var _=VC();return _.style.setProperty("margin","0 0 0.5rem 0"),_.style.setProperty("font-size","1.1rem"),i(_,()=>t.account.name),_})(),(()=>{var _=Ui();return d(_,l),i(_,()=>t.account.category),_})(),(()=>{var _=Ui();return d(_,a),i(_,()=>m(t.account.balance)),_})(),(()=>{var _=Ui();return d(_,u),i(_,()=>t.account.description),_})(),ge(()=>ge(()=>!t.account.isActive)()&&(()=>{var _=Ui();return _.style.setProperty("margin-top","0.5rem"),_.style.setProperty("padding","0.25rem 0.75rem"),_.style.setProperty("border-radius","9999px"),_.style.setProperty("font-size","0.75rem"),_.style.setProperty("font-weight","500"),_.style.setProperty("background","#ffebee"),_.style.setProperty("color","#d32f2f"),_.style.setProperty("text-align","center"),i(_,()=>e("common.inactive")),_})()),(()=>{var _=Ui();return d(_,r),i(_,b(qe,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.account),get children(){return[ge(()=>e("common.view"))," ",ge(()=>e("accounts.accountDetails"))]}})),_})()]}})};var UC=z("<div><div><div><div></div><h3></h3></div></div><div><div></div><div>"),zC=z("<div>"),jC=z("<button>"),qC=z("<div><h4> (<!>)"),GC=z("<div><div><div></div><div>  </div></div><div>");const HC=t=>{const{t:e}=ft(),r=nd(),[n,o]=ye(!0),s={"margin-bottom":"1rem"},a={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},l={display:"flex","align-items":"center",gap:"1rem"},u={background:"none",border:"none",cursor:"pointer","font-size":"1.2rem",color:"var(--text-muted)",padding:"0.25rem","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease"},h={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},m={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},v={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},_={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},x={"margin-left":"1rem","border-left":"2px solid var(--border-color)","padding-left":"1rem","margin-top":"1rem"},T={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem","margin-bottom":"0.5rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},E={flex:"1"},P={"font-weight":"500","margin-bottom":"0.25rem"},R={"font-size":"0.875rem",color:"var(--text-muted)"},Y={"font-weight":"600",color:"var(--primary-color)"},Z={display:"flex",gap:"0.5rem"},j=$=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[$]||{bg:"#f5f5f5",color:"#666"},B=$=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format($),V=$=>{t.onViewDetails?t.onViewDetails($):r(`/accounts/${$.id}`)},f=()=>{t.onAddSubAccount&&t.onAddSubAccount(t.account)},g=t.account.balance+t.account.subAccounts.reduce(($,w)=>$+w.balance,0),S=j(t.account.type);return b(rt,{className:"account-hierarchy-card",style:s,get children(){return[(()=>{var $=UC(),w=$.firstChild,I=w.firstChild,y=I.firstChild,de=y.nextSibling,J=w.nextSibling,O=J.firstChild,N=O.nextSibling;return d($,a),d(w,l),i(w,(()=>{var q=ge(()=>t.account.subAccounts.length>0);return()=>q()&&(()=>{var D=jC();return D.addEventListener("mouseleave",C=>C.target.style.background="none"),D.addEventListener("mouseenter",C=>C.target.style.background="var(--background-color)"),D.$$click=()=>o(!n()),d(D,u),i(D,()=>n()?"":""),D})()})(),I),I.$$click=()=>V(t.account),I.style.setProperty("cursor","pointer"),d(y,h),i(y,()=>t.account.accountNumber),d(de,m),i(de,()=>t.account.name),J.style.setProperty("text-align","right"),d(O,v),i(O,()=>B(g)),i(N,()=>e(`accounts.types.${t.account.type.toLowerCase()}`)),X(q=>d(N,{..._,background:S.bg,color:S.color},q)),$})(),(()=>{var $=zC();return d($,Z),i($,b(qe,{variant:"secondary",size:"sm",onClick:()=>V(t.account),get children(){return[ge(()=>e("common.view"))," ",ge(()=>e("accounts.accountDetails"))]}}),null),i($,b(qe,{variant:"outline",size:"sm",onClick:f,get children(){return[ge(()=>e("common.add"))," ",ge(()=>e("accounts.subAccounts"))]}}),null),$})(),ge(()=>ge(()=>!!(n()&&t.account.subAccounts.length>0))()&&(()=>{var $=qC(),w=$.firstChild,I=w.firstChild,y=I.nextSibling;return y.nextSibling,d($,x),w.style.setProperty("margin","0 0 1rem 0"),w.style.setProperty("font-size","1rem"),w.style.setProperty("color","var(--text-muted)"),i(w,()=>e("accounts.subAccounts"),I),i(w,()=>t.account.subAccounts.length,y),i($,()=>t.account.subAccounts.map(de=>(()=>{var J=GC(),O=J.firstChild,N=O.firstChild,q=N.nextSibling,D=q.firstChild,C=O.nextSibling;return J.addEventListener("mouseleave",F=>{F.currentTarget.style.background="var(--background-color)",F.currentTarget.style.transform="translateY(0)"}),J.addEventListener("mouseenter",F=>{F.currentTarget.style.background="var(--surface-color)",F.currentTarget.style.transform="translateY(-1px)"}),J.$$click=()=>V(de),d(J,T),d(O,E),d(N,P),i(N,()=>de.name),d(q,R),i(q,()=>de.accountNumber,D),i(q,()=>de.description,null),d(C,Y),i(C,()=>B(de.balance)),J})()),null),$})())]}})};wt(["click"]);var WC=z("<form><div>");const YC=t=>{const{t:e}=ft(),[r,n]=ye({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),o=[{value:"Asset",label:e("accounts.types.asset"),type:"debit",classification:"real"},{value:"Liability",label:e("accounts.types.liability"),type:"credit",classification:"real"},{value:"Equity",label:e("accounts.types.equity"),type:"credit",classification:"real"},{value:"Revenue",label:e("accounts.types.revenue"),type:"credit",classification:"nominal"},{value:"Expense",label:e("accounts.types.expense"),type:"debit",classification:"nominal"}],s=()=>{const m=r().type;return m?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")},{value:"Sales Revenue",label:e("accounts.categories.salesRevenue")},{value:"Service Revenue",label:e("accounts.categories.servicesRevenue")},{value:"Subscription Revenue",label:e("accounts.categories.subscriptionRevenue")},{value:"Rental Revenue",label:e("accounts.categories.rentalRevenue")},{value:"Commission Revenue",label:e("accounts.categories.commissionRevenue")},{value:"Franchise Revenue",label:e("accounts.categories.franchiseRevenue")},{value:"Licensing Revenue",label:e("accounts.categories.licensingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[m]||[]:[]},a=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],l={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},u=m=>{m.preventDefault();const v=r();if(!v.accountNumber||!v.name||!v.type||!v.category){alert(e("forms.requiredField"));return}if(Ft.accounts.find(T=>T.accountNumber===v.accountNumber)){alert(e("forms.duplicateAccountNumber"));return}const x={accountNumber:v.accountNumber,name:v.name,type:v.type,category:v.category,description:v.description,balance:parseFloat(v.balance)||0,isActive:v.isActive==="true"};Ft.addAccount(x),n({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},h=(m,v)=>{n(_=>{const x={..._,[m]:v};return m==="type"&&(x.category=""),x})};return b(Ar,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.addAccount")},get children(){var m=WC(),v=m.firstChild;return m.addEventListener("submit",u),i(m,b(Qt,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:_=>h("accountNumber",_),get placeholder(){return e("accounts.accountNumber")},required:!0}),v),i(m,b(Qt,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:_=>h("name",_),get placeholder(){return e("accounts.accountName")},required:!0}),v),i(m,b(Dr,{get label(){return e("accounts.accountType")},get value(){return r().type},onChange:_=>h("type",_),options:o,required:!0}),v),i(m,b(Dr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:_=>h("category",_),get options(){return s()},required:!0}),v),i(m,b(Qt,{get label(){return e("common.description")},get value(){return r().description},onChange:_=>h("description",_),get placeholder(){return e("common.description")}}),v),i(m,b(Qt,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:_=>h("balance",_),get placeholder(){return e("accounts.balance")}}),v),i(m,b(Dr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:_=>h("isActive",_),options:a,required:!0}),v),d(v,l),i(v,b(qe,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),i(v,b(qe,{variant:"primary",type:"submit",get children(){return e("accounts.addAccount")}}),null),m}})};var KC=z("<form><div>"),QC=z("<div><div></div><div> - </div><div>  ");const JC=t=>{const{t:e}=ft(),[r,n]=ye({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),o=()=>t.parentAccount?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[t.parentAccount.type]||[]:[],s=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],a={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},l={background:"var(--background-color)",padding:"1rem","border-radius":"var(--border-radius-sm)","margin-bottom":"1.5rem",border:"1px solid var(--border-color)"},u={"font-size":"0.875rem","font-weight":"500",color:"var(--text-muted)","margin-bottom":"0.5rem"},h={"font-weight":"600",color:"var(--text-primary)"},m={"font-size":"0.875rem",color:"var(--text-secondary)"},v=E=>{E.preventDefault();const P=r();if(!P.accountNumber||!P.name||!P.category||!t.parentAccount){alert(e("forms.requiredField"));return}if(Ft.accounts.find(Z=>Z.accountNumber===P.accountNumber)){alert(e("forms.duplicateAccountNumber"));return}const Y={accountNumber:P.accountNumber,name:P.name,type:t.parentAccount.type,category:P.category,description:P.description,balance:parseFloat(P.balance)||0,isActive:P.isActive==="true",parentAccountId:t.parentAccount.id};Ft.addAccount(Y),n({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},_=(E,P)=>{n(R=>({...R,[E]:P}))},x=()=>{if(!t.parentAccount)return"";const E=t.parentAccount.accountNumber,R=Ft.getSubAccounts(t.parentAccount.id).length+1;return(parseInt(E)+R).toString()},T=()=>r().accountNumber===""&&t.parentAccount?x():r().accountNumber;return b(Ar,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return`${e("common.add")} ${e("accounts.subAccounts")}`},get children(){return[ge(()=>ge(()=>!!t.parentAccount)()&&(()=>{var E=QC(),P=E.firstChild,R=P.nextSibling,Y=R.firstChild,Z=R.nextSibling,j=Z.firstChild;return d(E,l),d(P,u),i(P,()=>e("accounts.parentAccount")),d(R,h),i(R,()=>t.parentAccount.accountNumber,Y),i(R,()=>t.parentAccount.name,null),d(Z,m),i(Z,()=>e(`accounts.types.${t.parentAccount.type.toLowerCase()}`),j),i(Z,()=>t.parentAccount.category,null),E})()),(()=>{var E=KC(),P=E.firstChild;return E.addEventListener("submit",v),i(E,b(Qt,{get label(){return e("accounts.accountNumber")},get value(){return T()},onChange:R=>_("accountNumber",R),get placeholder(){return`${e("common.suggested")}: ${x()}`},required:!0}),P),i(E,b(Qt,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:R=>_("name",R),get placeholder(){return e("accounts.accountName")},required:!0}),P),i(E,b(Dr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:R=>_("category",R),get options(){return o()},required:!0}),P),i(E,b(Qt,{get label(){return e("common.description")},get value(){return r().description},onChange:R=>_("description",R),get placeholder(){return e("common.description")}}),P),i(E,b(Qt,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:R=>_("balance",R),get placeholder(){return e("accounts.balance")}}),P),i(E,b(Dr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:R=>_("isActive",R),options:s,required:!0}),P),d(P,a),i(P,b(qe,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),i(P,b(qe,{variant:"primary",type:"submit",get children(){return[ge(()=>e("common.add"))," ",ge(()=>e("accounts.subAccounts"))]}}),null),E})()]}})};var XC=z("<form><div>"),ZC=z("<div>");const ex=t=>{const{t:e}=ft(),[r,n]=ye({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),[o,s]=ye(null);fn(()=>{t.account&&(n({accountNumber:t.account.accountNumber,name:t.account.name,type:t.account.type,category:t.account.category,description:t.account.description,balance:t.account.balance.toString(),isActive:t.account.isActive.toString()}),s(null))});const a=[{value:"Asset",label:e("accounts.types.asset")},{value:"Liability",label:e("accounts.types.liability")},{value:"Equity",label:e("accounts.types.equity")},{value:"Revenue",label:e("accounts.types.revenue")},{value:"Expense",label:e("accounts.types.expense")}],l=()=>{const x=r().type;return x?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[x]||[]:[]},u=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],h={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},m=x=>{if(x.preventDefault(),s(null),!t.account)return;const T=r();if(!T.accountNumber||!T.name||!T.type||!T.category){s(e("forms.requiredField"));return}if(Ft.accounts.find(R=>R.accountNumber===T.accountNumber&&R.id!==t.account.id)){s(e("forms.duplicateAccountNumber"));return}const P={accountNumber:T.accountNumber,name:T.name,type:T.type,category:T.category,description:T.description,balance:parseFloat(T.balance)||0,isActive:T.isActive==="true"};try{Ft.updateAccount(t.account.id,P),t.onClose()}catch(R){s(R instanceof Error?R.message:e("forms.saveError"))}},v=()=>{if(!t.account)return;const x=Ft.canDeleteAccount(t.account.id);if(!x.canDelete){s(x.reason||e("forms.deleteError"));return}const T=e("forms.confirmDelete");if(confirm(T))try{Ft.deleteAccount(t.account.id),t.onClose()}catch(E){s(E instanceof Error?E.message:e("forms.deleteError"))}},_=(x,T)=>{n(E=>{const P={...E,[x]:T};return x==="type"&&(P.category=""),P}),o()&&s(null)};return t.account?b(Ar,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.editAccount")},get children(){var x=XC(),T=x.firstChild;return x.addEventListener("submit",m),i(x,b(Qt,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:E=>_("accountNumber",E),get placeholder(){return e("accounts.accountNumber")},required:!0}),T),i(x,b(Qt,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:E=>_("name",E),get placeholder(){return e("accounts.accountName")},required:!0}),T),i(x,b(Dr,{get label(){return e("accounts.accountType")},get value(){return r().type},onChange:E=>_("type",E),options:a,required:!0}),T),i(x,b(Dr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:E=>_("category",E),get options(){return l()},required:!0}),T),i(x,b(Qt,{get label(){return e("common.description")},get value(){return r().description},onChange:E=>_("description",E),get placeholder(){return e("common.description")}}),T),i(x,b(Qt,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:E=>_("balance",E),get placeholder(){return e("accounts.balance")}}),T),i(x,b(Dr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:E=>_("isActive",E),options:u,required:!0}),T),i(x,(()=>{var E=ge(()=>!!o());return()=>E()&&(()=>{var P=ZC();return P.style.setProperty("padding","1rem"),P.style.setProperty("border-radius","var(--border-radius-sm)"),P.style.setProperty("margin-top","1rem"),P.style.setProperty("background","#f8d7da"),P.style.setProperty("color","#721c24"),P.style.setProperty("border","1px solid #f5c6cb"),i(P,o),P})()})(),T),d(T,h),i(T,b(qe,{variant:"outline",type:"button",onClick:v,style:{color:"#dc3545","border-color":"#dc3545","margin-right":"auto"},get children(){return e("accounts.deleteAccount")}}),null),i(T,b(qe,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),i(T,b(qe,{variant:"primary",type:"submit",get children(){return e("common.save")}}),null),x}}):null};var tx=z("<div><div></div><div></div><div></div><div>"),rx=z("<div><div></div><div></div><div>"),nx=z("<div><button></button><button> (<!>)"),Kl=z("<div>"),ox=z("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),ix=z("<div><div><div></div><div>  </div></div><div>");const sx=t=>{const{t:e}=ft(),[r,n]=ye("details"),[o,s]=ye(!1),a=Ze(()=>t.account?Ft.getAccountById(t.account.id)||t.account:null),l={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},u={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},h={"font-weight":"600",color:"var(--text-primary)"},m={"text-align":"center","margin-bottom":"2rem"},v={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},_={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},x={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem"},T={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},E=S=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:S?"var(--primary-color)":"var(--text-muted)","border-bottom":S?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),P={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},R={flex:"1"},Y={"font-size":"0.875rem",color:"var(--text-muted)"},Z={"font-weight":"500","margin-bottom":"0.25rem"},j=S=>({"font-weight":"600",color:S==="debit"?"#4caf50":"#f44336"}),B={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},V=S=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[S]||{bg:"#f5f5f5",color:"#666"},f=S=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(S),g=S=>new Date(S).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return b(Ar,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.accountDetails")},get children(){return[ge(()=>ge(()=>!a())()?(()=>{var S=tx(),$=S.firstChild,w=$.nextSibling,I=w.nextSibling,y=I.nextSibling;return S.style.setProperty("text-align","center"),S.style.setProperty("padding","3rem"),S.style.setProperty("color","var(--text-muted)"),$.style.setProperty("font-size","1.5rem"),$.style.setProperty("margin-bottom","1rem"),w.style.setProperty("font-size","1.1rem"),w.style.setProperty("margin-bottom","0.5rem"),i(w,()=>e("common.error")),I.style.setProperty("font-size","0.875rem"),i(I,()=>e("common.noDataFound")),y.style.setProperty("margin-top","2rem"),i(y,b(qe,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),S})():(()=>{const S=Ze(()=>V(a().type)),$=Ze(()=>Ft.getAccountTransactions(a().id));return[(()=>{var w=rx(),I=w.firstChild,y=I.nextSibling,de=y.nextSibling;return d(w,m),d(I,v),i(I,()=>a().name),d(y,_),i(y,()=>f(a().balance)),i(de,()=>e(`accounts.types.${a().type.toLowerCase()}`)),X(J=>d(de,{...x,background:S().bg,color:S().color},J)),w})(),(()=>{var w=nx(),I=w.firstChild,y=I.nextSibling,de=y.firstChild,J=de.nextSibling;return J.nextSibling,d(w,T),I.$$click=()=>n("details"),i(I,()=>e("accounts.accountDetails")),y.$$click=()=>n("transactions"),i(y,()=>e("accounts.transactions"),de),i(y,()=>$().length,J),X(O=>{var N=E(r()==="details"),q=E(r()==="transactions");return O.e=d(I,N,O.e),O.t=d(y,q,O.t),O},{e:void 0,t:void 0}),w})(),ge(()=>ge(()=>r()==="details")()&&(()=>{var w=ox(),I=w.firstChild,y=I.firstChild,de=y.nextSibling,J=I.nextSibling,O=J.firstChild,N=O.nextSibling,q=J.nextSibling,D=q.firstChild,C=D.nextSibling,F=q.nextSibling,ee=F.firstChild,H=ee.nextSibling,oe=F.nextSibling,M=oe.firstChild,G=M.nextSibling,le=oe.nextSibling,ne=le.firstChild,ue=ne.nextSibling;return i(y,()=>e("accounts.accountNumber")),i(de,()=>a().accountNumber),i(O,()=>e("accounts.category")),i(N,()=>a().category),i(D,()=>e("common.description")),i(C,()=>a().description),i(ee,()=>e("common.status")),i(H,(()=>{var L=ge(()=>!!a().isActive);return()=>L()?e("common.active"):e("common.inactive")})()),i(M,()=>e("accounts.createdDate")),i(G,()=>g(a().createdDate)),i(ne,()=>e("accounts.lastModified")),i(ue,()=>g(a().lastModified)),X(L=>{var A=l,U=u,te=h,ae=l,re=u,ce=h,Q=l,me=u,K=h,he=l,ve=u,W=h,ie=l,Pe=u,_e=h,fe=l,be=u,pe=h;return L.e=d(I,A,L.e),L.t=d(y,U,L.t),L.a=d(de,te,L.a),L.o=d(J,ae,L.o),L.i=d(O,re,L.i),L.n=d(N,ce,L.n),L.s=d(q,Q,L.s),L.h=d(D,me,L.h),L.r=d(C,K,L.r),L.d=d(F,he,L.d),L.l=d(ee,ve,L.l),L.u=d(H,W,L.u),L.c=d(oe,ie,L.c),L.w=d(M,Pe,L.w),L.m=d(G,_e,L.m),L.f=d(le,fe,L.f),L.y=d(ne,be,L.y),L.g=d(ue,pe,L.g),L},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),w})()),ge(()=>ge(()=>r()==="transactions")()&&(()=>{var w=Kl();return i(w,(()=>{var I=ge(()=>$().length===0);return()=>I()?(()=>{var y=Kl();return y.style.setProperty("text-align","center"),y.style.setProperty("color","var(--text-muted)"),y.style.setProperty("padding","2rem"),i(y,()=>e("common.noDataFound")),y})():$().map(y=>(()=>{var de=ix(),J=de.firstChild,O=J.firstChild,N=O.nextSibling,q=N.firstChild,D=J.nextSibling;return d(de,P),d(J,R),d(O,Z),i(O,()=>y.description),d(N,Y),i(N,()=>g(y.date),q),i(N,()=>y.reference,null),i(D,()=>y.type==="debit"?"+":"-",null),i(D,()=>f(y.type==="debit"?y.debitAmount:y.creditAmount),null),X(C=>d(D,j(y.type),C)),de})())})()),w})()),(()=>{var w=Kl();return d(w,B),i(w,b(qe,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),i(w,b(qe,{variant:"primary",onClick:()=>s(!0),get children(){return e("accounts.editAccount")}}),null),w})()]})()),ge(()=>ge(()=>!!a())()&&b(ex,{get isOpen(){return o()},onClose:()=>{s(!1)},get account(){return a()}}))]}})};wt(["click"]);const ax="https://qvamarkets.com/gql_api",[lx,ym]=ye(!1),[cx,Ql]=ye(null);class dx{baseUrl;constructor(e=ax){this.baseUrl=e}async request(e,r,n,o){ym(!0),Ql(null);try{const s=r.startsWith("http")?r:`${this.baseUrl}${r}`,a={method:e,headers:{"Content-Type":"application/json",Accept:"application/json",...o}};n&&(e==="POST"||e==="PUT"||e==="PATCH")&&(a.body=JSON.stringify(n));const l=await fetch(s,a);if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);const u=await l.json();if(u.errors&&u.errors.length>0)throw new Error(u.errors[0].message);return u.data||u}catch(s){const a=s instanceof Error?s.message:"Unknown error occurred";throw Ql(a),s}finally{ym(!1)}}async graphql(e){return this.request("POST","",e)}async get(e,r){return this.request("GET",e,void 0,r)}async post(e,r,n){return this.request("POST",e,r,n)}async put(e,r,n){return this.request("PUT",e,r,n)}async patch(e,r,n){return this.request("PATCH",e,r,n)}async delete(e,r){return this.request("DELETE",e,void 0,r)}getLoadingState(){return lx()}getErrorState(){return cx()}clearError(){Ql(null)}}const ra=new dx,tu=`
  fragment AccountFields on Account {
    id
    accountNumber
    name
    type
    category
    description
    balance
    isActive
    parentAccountId
    createdDate
    lastModified
  }
`,ux=`
  query GetAccountById($id: ID!) {
    account(id: $id) {
      ...AccountFields
    }
  }
  ${tu}
`,hx=`
  mutation CreateAccount($input: CreateAccountInput!) {
    createAccount(input: $input) {
      ...AccountFields
    }
  }
  ${tu}
`,mx=`
  mutation UpdateAccount($id: ID!, $input: UpdateAccountInput!) {
    updateAccount(id: $id, input: $input) {
      ...AccountFields
    }
  }
  ${tu}
`,yx=`
  mutation DeleteAccount($id: ID!) {
    deleteAccount(id: $id) {
      success
      message
    }
  }
`;class px{async getAccounts(e,r){try{if(ms.isFakeMode())return await Du.getAll(e);const n=await mn({query:"getAllYabaProducts",params:{businessId:"YB100423253156428"}});return console.log("Real API accounts response:",n),n?.accounts||[]}catch(n){if(console.error("Error fetching accounts:",n),ms.isHybridMode())return console.warn("Falling back to fake API for accounts"),await Du.getAll(e);throw n}}async getAccountById(e){try{return(await ra.graphql({query:ux,variables:{id:e}})).account}catch(r){throw console.error("Error fetching account:",r),r}}async createAccount(e){try{return(await ra.graphql({query:hx,variables:{input:e}})).createAccount}catch(r){throw console.error("Error creating account:",r),r}}async updateAccount(e,r){try{return(await ra.graphql({query:mx,variables:{id:e,input:r}})).updateAccount}catch(n){throw console.error("Error updating account:",n),n}}async deleteAccount(e){try{return(await ra.graphql({query:yx,variables:{id:e}})).deleteAccount}catch(r){throw console.error("Error deleting account:",r),r}}async getAccountsByType(e){return this.getAccounts({type:e})}async getAccountHierarchy(){const e=await this.getAccounts();return this.buildHierarchy(e)}buildHierarchy(e){const r=new Map,n=[];return e.forEach(o=>{r.set(o.id,{...o,subAccounts:[]})}),e.forEach(o=>{const s=r.get(o.id);if(o.parentAccountId){const a=r.get(o.parentAccountId);a&&(a.subAccounts=a.subAccounts||[],a.subAccounts.push(s))}else n.push(s)}),n}async getAccountBalance(e){const r=await this.getAccountById(e);return r?r.balance:0}async searchAccounts(e){return this.getAccounts({search:e})}}const fx=new px;var gx=z("<div><h2></h2><div><span>:</span><button></button><button>"),vx=z("<div><span>:"),pm=z("<div>"),bx=z("<button>");const _x=()=>{const{t}=ft(),[e,r]=ye(!1),[n,o]=ye(!1),[s,a]=ye(!1),[l,u]=ye(null),[h,m]=ye(null),[v,_]=ye("All"),[x,T]=ye("hierarchy"),E=g=>{u(g),a(!0)},P=g=>{m(g),o(!0)},R=()=>v()==="All"?x()==="hierarchy"?Ft.getAccountHierarchy():Ft.accounts:x()==="hierarchy"?Ft.getAccountHierarchy().filter(g=>g.type===v()):Ft.getAccountsByType(v()),Y={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(350px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},Z={display:"flex",gap:"1rem","margin-bottom":"2rem","align-items":"center"},j=g=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:g?"var(--primary-color)":"var(--surface-color)",color:g?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500",transition:"all 0.2s ease"}),B={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},V={display:"flex",gap:"0.5rem","align-items":"center","margin-left":"auto","margin-right":"1rem"},f=g=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:g?"var(--primary-color)":"var(--surface-color)",color:g?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"});return b(an,{get title(){return t("accounts.title")},get children(){return[b(OC,{}),(()=>{var g=gx(),S=g.firstChild,$=S.nextSibling,w=$.firstChild,I=w.firstChild,y=w.nextSibling,de=y.nextSibling;return d(g,B),S.style.setProperty("margin","0"),S.style.setProperty("font-size","1.5rem"),i(S,()=>t("accounts.title")),d($,V),w.style.setProperty("font-weight","500"),w.style.setProperty("color","var(--text-muted)"),w.style.setProperty("font-size","0.875rem"),i(w,()=>t("common.view"),I),y.$$click=()=>T("hierarchy"),i(y,()=>t("accounts.accountHierarchy")),de.$$click=()=>{T("flat"),fx.getAccounts()},i(de,()=>t("common.all")),i(g,b(qe,{variant:"primary",onClick:()=>r(!0),get children(){return t("accounts.addAccount")}}),null),X(J=>{var O=f(x()==="hierarchy"),N=f(x()==="flat");return J.e=d(y,O,J.e),J.t=d(de,N,J.t),J},{e:void 0,t:void 0}),g})(),(()=>{var g=vx(),S=g.firstChild,$=S.firstChild;return d(g,Z),S.style.setProperty("font-weight","500"),S.style.setProperty("color","var(--text-muted)"),i(S,()=>t("common.filter"),$),i(g,()=>[t("common.all"),t("accounts.types.asset"),t("accounts.types.liability"),t("accounts.types.equity"),t("accounts.types.revenue"),t("accounts.types.expense")].map((w,I)=>{const de=["All","Asset","Liability","Equity","Revenue","Expense"][I];return(()=>{var J=bx();return J.$$click=()=>_(de),i(J,w),X(O=>d(J,j(v()===de),O)),J})()}),null),g})(),(()=>{var g=pm();return i(g,(()=>{var S=ge(()=>x()==="hierarchy");return()=>S()?R().map($=>b(HC,{account:$,onAddSubAccount:P,onViewDetails:E})):R().map($=>b(BC,{account:$,onViewDetails:E}))})()),X(S=>d(g,x()==="hierarchy"?{display:"flex","flex-direction":"column",gap:"1rem"}:Y,S)),g})(),ge(()=>ge(()=>R().length===0)()&&(()=>{var g=pm();return g.style.setProperty("text-align","center"),g.style.setProperty("color","var(--text-muted)"),g.style.setProperty("padding","3rem"),g.style.setProperty("font-size","1.1rem"),i(g,()=>t("common.noDataFound")),g})()),b(YC,{get isOpen(){return e()},onClose:()=>r(!1)}),b(JC,{get isOpen(){return n()},onClose:()=>o(!1),get parentAccount(){return h()}}),b(sx,{get isOpen(){return s()},onClose:()=>a(!1),get account(){return l()}})]}})};wt(["click"]);var Sx=z("<div><h2>"),ii=z("<div>"),Px=z("<div><div><div></div><h1></h1><div></div></div><div>"),wx=z("<div><button></button><button> (<!>)"),na=z("<div><span></span><span>"),Cx=z("<p>"),xx=z("<div><div></div><div>"),$x=z("<div><div><div></div><div>  </div></div><div>");const Ax=()=>{const{t}=ft(),e=rv(),r=nd(),[n,o]=ye(null),[s,a]=ye("overview");$r(()=>{const y=Ft.getAccountById(e.id);y?o(y):r("/accounts")});const l={display:"flex","align-items":"center",gap:"0.5rem","margin-bottom":"1rem"},u={display:"flex","align-items":"center",gap:"1rem","margin-bottom":"2rem"},h={"font-size":"1rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},m={"font-size":"2.5rem","font-weight":"700",color:"var(--primary-color)"},v={padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},_={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},x=y=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:y?"var(--primary-color)":"var(--text-muted)","border-bottom":y?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),T={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},E={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},P={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},R={"font-weight":"500",color:"var(--text-muted)"},Y={"font-weight":"600",color:"var(--text-primary)"},Z={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},j={flex:"1"},B={"font-weight":"500","margin-bottom":"0.25rem"},V={"font-size":"0.875rem",color:"var(--text-muted)"},f=y=>({"font-weight":"600",color:y==="debit"?"#4caf50":"#f44336"});if(!n())return b(an,{get title(){return t("accounts.accountDetails")},get children(){var y=Sx(),de=y.firstChild;return y.style.setProperty("text-align","center"),y.style.setProperty("padding","3rem"),i(de,()=>t("common.error")),i(y,b(qe,{variant:"primary",onClick:()=>r("/accounts"),get children(){return[ge(()=>t("common.back"))," ",ge(()=>t("navigation.accounts"))]}}),null),y}});const g=y=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[y]||{bg:"#f5f5f5",color:"#666"},S=y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(y),$=y=>new Date(y).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),w=g(n().type),I=Ft.getAccountTransactions(n().id);return b(an,{get title(){return n().name},get children(){return[(()=>{var y=ii();return d(y,l),i(y,b(qe,{variant:"secondary",onClick:()=>r("/accounts"),get children(){return[" ",ge(()=>t("common.back"))," ",ge(()=>t("navigation.accounts"))]}})),y})(),(()=>{var y=Px(),de=y.firstChild,J=de.firstChild,O=J.nextSibling,N=O.nextSibling,q=de.nextSibling;return d(y,u),d(J,h),i(J,()=>n().accountNumber),O.style.setProperty("margin","0.5rem 0"),O.style.setProperty("font-size","2rem"),i(O,()=>n().name),d(N,m),i(N,()=>S(n().balance)),i(q,()=>n().type),X(D=>d(q,{...v,background:w.bg,color:w.color},D)),y})(),(()=>{var y=wx(),de=y.firstChild,J=de.nextSibling,O=J.firstChild,N=O.nextSibling;return N.nextSibling,d(y,_),de.$$click=()=>a("overview"),i(de,()=>t("dashboard.overview")),J.$$click=()=>a("transactions"),i(J,()=>t("accounts.transactions"),O),i(J,()=>I.length,N),X(q=>{var D=x(s()==="overview"),C=x(s()==="transactions");return q.e=d(de,D,q.e),q.t=d(J,C,q.t),q},{e:void 0,t:void 0}),y})(),ge(()=>ge(()=>s()==="overview")()&&(()=>{var y=xx(),de=y.firstChild,J=de.nextSibling;return d(de,T),i(de,b(rt,{get title(){return t("accounts.balance")},get subtitle(){return t("dashboard.overview")},get children(){var O=ii();return O.style.setProperty("font-size","1.5rem"),O.style.setProperty("font-weight","600"),O.style.setProperty("color","var(--primary-color)"),i(O,()=>S(n().balance)),O}}),null),i(de,b(rt,{get title(){return t("accounts.accountType")},get subtitle(){return t("accounts.category")},get children(){var O=ii();return O.style.setProperty("font-size","1.5rem"),O.style.setProperty("font-weight","600"),O.style.setProperty("color","var(--primary-color)"),i(O,()=>t(`accounts.types.${n().type.toLowerCase()}`)),O}}),null),i(de,b(rt,{get title(){return t("common.status")},get subtitle(){return t("accounts.accountDetails")},get children(){var O=ii();return O.style.setProperty("font-size","1.5rem"),O.style.setProperty("font-weight","600"),i(O,(()=>{var N=ge(()=>!!n().isActive);return()=>N()?t("common.active"):t("common.inactive")})()),X(N=>(N=n().isActive?"#4caf50":"#f44336")!=null?O.style.setProperty("color",N):O.style.removeProperty("color")),O}}),null),i(de,b(rt,{get title(){return t("accounts.transactions")},get subtitle(){return t("common.total")},get children(){var O=ii();return O.style.setProperty("font-size","1.5rem"),O.style.setProperty("font-weight","600"),O.style.setProperty("color","var(--primary-color)"),i(O,()=>I.length),O}}),null),d(J,E),i(J,b(rt,{get title(){return t("accounts.accountDetails")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var O=na(),N=O.firstChild,q=N.nextSibling;return i(N,()=>t("accounts.accountNumber")),i(q,()=>n().accountNumber),X(D=>{var C=P,F=R,ee=Y;return D.e=d(O,C,D.e),D.t=d(N,F,D.t),D.a=d(q,ee,D.a),D},{e:void 0,t:void 0,a:void 0}),O})(),(()=>{var O=na(),N=O.firstChild,q=N.nextSibling;return i(N,()=>t("accounts.category")),i(q,()=>n().category),X(D=>{var C=P,F=R,ee=Y;return D.e=d(O,C,D.e),D.t=d(N,F,D.t),D.a=d(q,ee,D.a),D},{e:void 0,t:void 0,a:void 0}),O})(),(()=>{var O=na(),N=O.firstChild,q=N.nextSibling;return i(N,()=>t("common.date")),i(q,()=>$(n().createdDate)),X(D=>{var C=P,F=R,ee=Y;return D.e=d(O,C,D.e),D.t=d(N,F,D.t),D.a=d(q,ee,D.a),D},{e:void 0,t:void 0,a:void 0}),O})(),(()=>{var O=na(),N=O.firstChild,q=N.nextSibling;return i(N,()=>t("common.date")),i(q,()=>$(n().lastModified)),X(D=>{var C=P,F=R,ee=Y;return D.e=d(O,C,D.e),D.t=d(N,F,D.t),D.a=d(q,ee,D.a),D},{e:void 0,t:void 0,a:void 0}),O})()]}}),null),i(J,b(rt,{get title(){return t("common.description")},get subtitle(){return t("accounts.accountDetails")},get children(){var O=Cx();return O.style.setProperty("margin","0"),O.style.setProperty("color","var(--text-secondary)"),i(O,()=>n().description||t("common.noDataFound")),O}}),null),y})()),ge(()=>ge(()=>s()==="transactions")()&&b(rt,{get title(){return t("accounts.accountHistory")},get subtitle(){return t("accounts.transactions")},get children(){return ge(()=>I.length===0)()?(()=>{var y=ii();return y.style.setProperty("text-align","center"),y.style.setProperty("color","var(--text-muted)"),y.style.setProperty("padding","2rem"),i(y,()=>t("common.noDataFound")),y})():I.map(y=>(()=>{var de=$x(),J=de.firstChild,O=J.firstChild,N=O.nextSibling,q=N.firstChild,D=J.nextSibling;return d(de,Z),d(J,j),d(O,B),i(O,()=>y.description),d(N,V),i(N,()=>$(y.date),q),i(N,()=>y.reference,null),i(D,()=>y.type==="debit"?"+":"-",null),i(D,()=>S(y.type==="debit"?y.debitAmount:y.creditAmount),null),X(C=>d(D,f(y.type),C)),de})())}}))]}})};wt(["click"]);var Ix=z("<div><div><h1></h1><p> </p></div><div><input type=date>"),Un=z("<div><span></span><span>"),Ex=z("<div><div></div><div>"),Tx=z("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),kx=z("<div><div> (<!> = <!> + <!>)</div><div> = "),Rx=z("<span>(<!>: <!>)");const Dx=()=>{const{t}=ft(),[e,r]=ye(new Date().toISOString().split("T")[0]),[n,o]=ye(0),[s,a]=ye(0),[l,u]=ye(0);$r(()=>{h()});const h=()=>{const T=Ft.getAccountsByType("Asset"),E=Ft.getAccountsByType("Liability"),P=Ft.getAccountsByType("Equity"),R=T.reduce((j,B)=>j+B.balance,0),Y=E.reduce((j,B)=>j+B.balance,0),Z=P.reduce((j,B)=>j+B.balance,0);o(R),a(Y),u(Z)},m=T=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(T),v={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},_={"margin-bottom":"2rem"},x={"font-weight":"bold","font-size":"1.1rem","border-top":"2px solid var(--border-color)","padding-top":"0.5rem","margin-top":"1rem"};return b(an,{get title(){return t("balanceSheet.title")},get children(){return[(()=>{var T=Ix(),E=T.firstChild,P=E.firstChild,R=P.nextSibling,Y=R.firstChild,Z=E.nextSibling,j=Z.firstChild;return d(T,v),P.style.setProperty("margin","0"),i(P,()=>t("balanceSheet.title")),R.style.setProperty("margin","0.5rem 0 0 0"),R.style.setProperty("color","var(--text-muted)"),i(R,()=>t("balanceSheet.asOf"),Y),i(R,()=>new Date(e()).toLocaleDateString(),null),Z.style.setProperty("display","flex"),Z.style.setProperty("gap","1rem"),j.addEventListener("change",B=>r(B.target.value)),j.style.setProperty("padding","0.5rem"),j.style.setProperty("border","1px solid var(--border-color)"),j.style.setProperty("border-radius","var(--border-radius-sm)"),i(Z,b(qe,{variant:"primary",onClick:h,get children(){return t("balanceSheet.generateReport")}}),null),X(()=>j.value=e()),T})(),(()=>{var T=Ex(),E=T.firstChild,P=E.nextSibling;return T.style.setProperty("display","grid"),T.style.setProperty("grid-template-columns","1fr 1fr"),T.style.setProperty("gap","2rem"),i(E,b(rt,{get title(){return t("balanceSheet.assets")},style:_,get children(){return[(()=>{var R=Un(),Y=R.firstChild,Z=Y.nextSibling;return R.style.setProperty("display","flex"),R.style.setProperty("justify-content","space-between"),R.style.setProperty("align-items","center"),i(Y,()=>t("balanceSheet.currentAssets")),i(Z,()=>m(n()*.6)),R})(),(()=>{var R=Un(),Y=R.firstChild,Z=Y.nextSibling;return R.style.setProperty("display","flex"),R.style.setProperty("justify-content","space-between"),R.style.setProperty("align-items","center"),i(Y,()=>t("balanceSheet.nonCurrentAssets")),i(Z,()=>m(n()*.4)),R})(),(()=>{var R=Un(),Y=R.firstChild,Z=Y.nextSibling;return i(Y,()=>t("balanceSheet.totalAssets")),i(Z,()=>m(n())),X(j=>d(R,{...x,display:"flex","justify-content":"space-between"},j)),R})()]}})),i(P,b(rt,{get title(){return t("balanceSheet.liabilities")},style:_,get children(){return[(()=>{var R=Un(),Y=R.firstChild,Z=Y.nextSibling;return R.style.setProperty("display","flex"),R.style.setProperty("justify-content","space-between"),R.style.setProperty("align-items","center"),i(Y,()=>t("balanceSheet.currentLiabilities")),i(Z,()=>m(s()*.7)),R})(),(()=>{var R=Un(),Y=R.firstChild,Z=Y.nextSibling;return R.style.setProperty("display","flex"),R.style.setProperty("justify-content","space-between"),R.style.setProperty("align-items","center"),i(Y,()=>t("balanceSheet.nonCurrentLiabilities")),i(Z,()=>m(s()*.3)),R})(),(()=>{var R=Un(),Y=R.firstChild,Z=Y.nextSibling;return i(Y,()=>t("balanceSheet.totalLiabilities")),i(Z,()=>m(s())),X(j=>d(R,{...x,display:"flex","justify-content":"space-between"},j)),R})()]}}),null),i(P,b(rt,{get title(){return t("balanceSheet.equity")},get children(){return[(()=>{var R=Un(),Y=R.firstChild,Z=Y.nextSibling;return R.style.setProperty("display","flex"),R.style.setProperty("justify-content","space-between"),R.style.setProperty("align-items","center"),i(Y,()=>t("balanceSheet.commonStock")),i(Z,()=>m(l()*.8)),R})(),(()=>{var R=Un(),Y=R.firstChild,Z=Y.nextSibling;return R.style.setProperty("display","flex"),R.style.setProperty("justify-content","space-between"),R.style.setProperty("align-items","center"),i(Y,()=>t("balanceSheet.retainedEarnings")),i(Z,()=>m(l()*.2)),R})(),(()=>{var R=Un(),Y=R.firstChild,Z=Y.nextSibling;return i(Y,()=>t("balanceSheet.totalEquity")),i(Z,()=>m(l())),X(j=>d(R,{...x,display:"flex","justify-content":"space-between"},j)),R})()]}}),null),T})(),b(rt,{get title(){return t("dashboard.overview")},style:{"margin-top":"2rem"},get children(){return[(()=>{var T=Tx(),E=T.firstChild,P=E.firstChild,R=P.nextSibling,Y=E.nextSibling,Z=Y.firstChild,j=Z.nextSibling,B=Y.nextSibling,V=B.firstChild,f=V.nextSibling;return T.style.setProperty("display","grid"),T.style.setProperty("grid-template-columns","repeat(3, 1fr)"),T.style.setProperty("gap","2rem"),E.style.setProperty("text-align","center"),P.style.setProperty("font-size","0.875rem"),P.style.setProperty("color","var(--text-muted)"),P.style.setProperty("margin-bottom","0.5rem"),i(P,()=>t("balanceSheet.totalAssets")),R.style.setProperty("font-size","1.5rem"),R.style.setProperty("font-weight","bold"),R.style.setProperty("color","var(--primary-color)"),i(R,()=>m(n())),Y.style.setProperty("text-align","center"),Z.style.setProperty("font-size","0.875rem"),Z.style.setProperty("color","var(--text-muted)"),Z.style.setProperty("margin-bottom","0.5rem"),i(Z,()=>t("balanceSheet.totalLiabilities")),j.style.setProperty("font-size","1.5rem"),j.style.setProperty("font-weight","bold"),j.style.setProperty("color","#f44336"),i(j,()=>m(s())),B.style.setProperty("text-align","center"),V.style.setProperty("font-size","0.875rem"),V.style.setProperty("color","var(--text-muted)"),V.style.setProperty("margin-bottom","0.5rem"),i(V,()=>t("balanceSheet.totalEquity")),f.style.setProperty("font-size","1.5rem"),f.style.setProperty("font-weight","bold"),f.style.setProperty("color","#4caf50"),i(f,()=>m(l())),T})(),(()=>{var T=kx(),E=T.firstChild,P=E.firstChild,R=P.nextSibling,Y=R.nextSibling,Z=Y.nextSibling,j=Z.nextSibling,B=j.nextSibling;B.nextSibling;var V=E.nextSibling,f=V.firstChild;return T.style.setProperty("margin-top","2rem"),T.style.setProperty("text-align","center"),E.style.setProperty("font-size","0.875rem"),E.style.setProperty("color","var(--text-muted)"),E.style.setProperty("margin-bottom","0.5rem"),i(E,()=>t("common.total"),P),i(E,()=>t("balanceSheet.totalAssets"),R),i(E,()=>t("balanceSheet.totalLiabilities"),Z),i(E,()=>t("balanceSheet.totalEquity"),B),V.style.setProperty("font-size","1.2rem"),V.style.setProperty("font-weight","bold"),i(V,()=>m(n()),f),i(V,()=>m(s()+l()),null),i(V,(()=>{var g=ge(()=>Math.abs(n()-(s()+l()))>.01);return()=>g()&&(()=>{var S=Rx(),$=S.firstChild,w=$.nextSibling,I=w.nextSibling,y=I.nextSibling;return y.nextSibling,S.style.setProperty("font-size","0.875rem"),S.style.setProperty("color","#f44336"),S.style.setProperty("display","block"),i(S,()=>t("common.error"),w),i(S,()=>m(n()-(s()+l())),y),S})()})(),null),X(g=>(g=Math.abs(n()-(s()+l()))<.01?"#4caf50":"#f44336")!=null?V.style.setProperty("color",g):V.style.removeProperty("color")),T})()]}})]}})};wt(["click"]);const Nx="modulepreload",Lx=function(t){return"/"+t},fm={},Sn=function(e,r,n){let o=Promise.resolve();if(r&&r.length>0){let a=function(h){return Promise.all(h.map(m=>Promise.resolve(m).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),u=l?.nonce||l?.getAttribute("nonce");o=a(r.map(h=>{if(h=Lx(h),h in fm)return;fm[h]=!0;const m=h.endsWith(".css"),v=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${v}`))return;const _=document.createElement("link");if(_.rel=m?"stylesheet":Nx,m||(_.as="script"),_.crossOrigin="",_.href=h,u&&_.setAttribute("nonce",u),document.head.appendChild(_),m)return new Promise((x,T)=>{_.addEventListener("load",x),_.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return o.then(a=>{for(const l of a||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})},Mx=[{id:"YY_8802",code:"YY_8802",name:"CENTER",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8803",code:"YY_8803",name:"BISSONNET",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8804",code:"YY_8804",name:"IRVIN",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8805",code:"YY_8805",name:"KATTY",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8816",code:"YY_8816",type:"store",name:"YABA GLOBAL",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8818",code:"YY_8818",type:"store",name:"YABASURAUSTIN",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8847",code:"YY_8847",type:"store",name:"YABAOFICINA AZ",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_3251",code:"YY_3251",type:"store",name:"YABA FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_32",code:"YY_32",type:"store",name:"YABA MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_76",code:"YY_76",type:"store",name:"YABA DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_79",code:"YY_79",type:"warehouse",name:"ALMACEN DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8635",code:"YY_8635",type:"store",name:"FASHION MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8665",code:"YY_8665",name:"IRVIN FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,type:"store",createdDate:"2024-01-01"},{id:"YY_8901",code:"YY_8901",name:"ALMACEN CENTRAL YABA",bussinesId:"YB100423253156428",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01"}],Ox=[{id:"1",name:'MacBook Pro 16"',price:2399,quantity:75,category:"Electronics",description:"Apple MacBook Pro 16-inch with M2 Pro chip",sku:"MBP-16-M2P",supplier:"Apple Inc.",minStock:10,location:"Warehouse A",lastUpdated:"2024-01-15"},{id:"2",name:'Dell Monitor 27"',price:299,quantity:35,category:"Electronics",description:"Dell 27-inch 4K UHD Monitor",sku:"DELL-MON-27-4K",supplier:"Dell Technologies",minStock:15,location:"Warehouse B",lastUpdated:"2024-01-14"},{id:"3",name:"Wireless Mouse",price:49.99,quantity:12,category:"Accessories",description:"Ergonomic wireless mouse with precision tracking",sku:"MOUSE-WL-001",supplier:"Logitech",minStock:25,location:"Warehouse A",lastUpdated:"2024-01-13"}],oa=()=>{const t=new Map;return Xr().forEach(e=>{const r=`${e.productId}-${e.locationId}`;let n=Le.getLocationById(e.locationId),o=t.get(r);o||(o={id:r,productId:e.productId,locationId:e.locationId,locationName:n?.name,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,o)),e.movementType==="in"||e.movementType==="transfer"?(e.locationId===e.toLocationId||e.movementType==="in")&&(o.quantity+=e.quantity*1):e.movementType==="out"?o.quantity-=e.quantity*1:e.movementType==="adjustment"&&(o.quantity=e.quantity*1),new Date(e.createdDate)>new Date(o.lastMovementDate)&&(o.lastMovementDate=e.createdDate,o.lastMovementType=e.movementType),o.averageCost=e.unitCost*1,o.availableQuantity=o.quantity*1-o.reservedQuantity*1}),Array.from(t.values())},[Do,Jl]=ye([]),[No,gm]=ye(Mx),[Xr,ia]=ye([]),[io,zi]=ye([]),[sa,Xl]=ye(Ox),Fx={TRANSFER:1,transfer:1},vm=173442384e4,Le={get products(){return Do()},get locations(){return No()},get movements(){return Xr()},get stockLevels(){return io()},parseInventoryData:t=>{const e=Object.keys(t).slice(0,900),r=[],n=o=>{let s=t;s[o]?.products&&s[o]?.products?.map(a=>{let l=$v(s[o]?.type),u=a?.price*1||a?.unitCost*1,h=a?.qty*1||a?.quantity*1;u=isNaN(u)?0:u,h=isNaN(h)?0:h;let m={id:s[o]?.ssg_inventory_key,productId:a?.product?.id,productName:a?.product?.label,productSku:a?.product?.code,locationId:s[o]?.store,locationName:s[o]?.store,location:s[o]?.store,movementType:l,quantity:h,unitCost:u,totalCost:u*1*h,minStock:10,referenceNumber:"PO-001",notes:s[o]?.description||s[o]?.notes,createdBy:"admin",createdDate:s[o]?.createDate?new Date(s[o]?.createDate).toISOString():new Date(vm).toISOString(),invoiceId:s[o]?.invoice};if(r.push(m),Fx[s[o].movementType]&&s[o]?.fromLocationId){let v=Le.getLocationById(s[o]?.fromLocationId);const _={id:s[o]?.ssg_inventory_key,productId:a?.product?.id,productName:a?.product?.label,productSku:a?.product?.code,locationId:s[o]?.fromLocationId,locationName:v?.name||"",movementType:"out",quantity:h*-1,unitCost:u,totalCost:u*-1*h,minStock:10,referenceNumber:s[o]?.referenceNumber,notes:`Transfer to ${s[o]?.locationName}`+(s[o].notes?` - ${s[o].notes}`:""),createdBy:s[o].createdBy,createdDate:s[o]?.createDate?new Date(s[o]?.createDate).toISOString():new Date(vm).toISOString(),invoiceId:s[o]?.invoiceId,toLocationId:s[o]?.locationId,toLocationName:s[o]?.locationName};r.push(_)}})};return e.map(n),r},fecthInventory:async t=>{const e=await Jr.getInventory(t),r=Le.parseInventoryData(e);Le.updMovements(r)},getStockLevels:async t=>{const e=await id.getStockLevels(t);zi(e)},fecthProduct:async t=>{const e=await Jr.getProducts(t),r=Object.keys(e),n=s=>{let a=e;return{id:s,name:a[s].name,businessId:a[s].businessId,sku:a[s].code,UPC:a[s].UPC,numCode:a[s].codeN,category:a[s].category,unitCost:a[s].unitCost||0,unitOfMeasure:a[s].unitOfMeasure||a[s].unit,minStockLevel:a[s].minStockLevel,maxStockLevel:a[s].maxStockLevel,isActive:a[s].isActive,productImageUrl:a[s].productImageUrl,description:a[s].description||"",createdDate:a[s].createdAt||new Date().toISOString(),lastModified:a[s].updatedAt||new Date().toISOString()}},o=r.map(n);return Le.updProduct(o),o},getProductById:t=>Do().find(e=>e.id===t),updProduct:t=>{Jl(t)},getProductsBySku:t=>Do().filter(e=>e.sku.toLowerCase().includes(t.toLowerCase())),getProductsByCategory:t=>Do().filter(e=>e.category===t),getActiveProducts:()=>Do().filter(t=>t.name),getLocationById:t=>No().find(e=>e.id===t),getLocationsByType:t=>No().filter(e=>e.type===t),getActiveLocations:()=>{let t=Lt?.state?.profile?.stores;return No().filter(e=>t?.[e?.id])},getMovementsByProduct:t=>Xr().filter(e=>e.productId===t),updMovements:t=>{ia([...t]),zi(oa())},getMovementsByLocation:t=>Xr().filter(e=>e.locationId===t),getMovementsByDateRange:(t,e)=>Xr().filter(r=>r.createdDate>=t&&r.createdDate<=e),getStockByProduct:t=>io().filter(e=>e.productId===t),getStockByLocation:t=>io().filter(e=>e.locationId===t),getStockByProductAndLocation:(t,e)=>io().find(r=>r.productId===t&&r.locationId===e),getTotalStockByProduct:t=>io().filter(e=>e.productId===t).reduce((e,r)=>e*1+r.quantity*1,0),getLastLocationByProduct:t=>{const e=Xr().filter(r=>r.productId===t).sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime());if(e.length>0)return No().find(r=>r.id===e[0].locationId)},getLowStockProducts:()=>(Do()||[])?.map(t=>{const e=io().filter(r=>r.productId===t.id).reduce((r,n)=>r+n.quantity,0);return{...t,currentStock:e}}).filter(t=>t.currentStock<=t.minStockLevel),generateMovementInvoice:async(t,e,r,n="compact")=>{try{const{getUserLanguage:o}=await Sn(async()=>{const{getUserLanguage:m}=await import("./languageUtils-BVmHbHaj.js");return{getUserLanguage:m}},[]),s=r||o();let a;switch(n){case"compact":const{generateCompactModernInvoicePDF:m}=await Sn(async()=>{const{generateCompactModernInvoicePDF:x}=await import("./compactModernInvoicePdfGenerator-uifKqJ1j.js");return{generateCompactModernInvoicePDF:x}},[]);a=m;break;case"modern":const{generateModernMovementInvoicePDF:v}=await Sn(async()=>{const{generateModernMovementInvoicePDF:x}=await import("./modernMovementInvoicePdfGenerator-HzX-_rnG.js");return{generateModernMovementInvoicePDF:x}},[]);a=v;break;case"classic":default:const{generateMovementInvoicePDF:_}=await Sn(async()=>{const{generateMovementInvoicePDF:x}=await import("./movementInvoicePdfGenerator-7RMy8PrG.js");return{generateMovementInvoicePDF:x}},[]);a=_;break}const l=Xr().filter(m=>m.invoiceId===t||m.id===t);if(l.length===0)throw new Error(`No movements found with ID: ${t}`);const u=l.reduce((m,v)=>{const _=v.invoiceId||v.id;return m[_]||(m[_]={invoiceId:_,movementType:v.movementType,referenceNumber:v.referenceNumber,createdBy:v.createdBy,createdDate:v.createdDate,locationName:v.locationName,fromLocationName:v.fromLocationName,toLocationName:v.toLocationName,notes:v.notes,items:[]}),m[_].items.push({productSku:v.productSku,productName:v.productName,quantity:v.quantity,unitCost:v.unitCost,totalCost:v.totalCost,receivedQuantity:v.movementType==="transfer"?null:void 0}),m},{}),h=[];for(const[m,v]of Object.entries(u)){const _=await a(v,e,s);h.push(_)}return h}catch(o){throw console.error("Error generating movement invoice:",o),o}},getMovementsByInvoiceId:t=>Xr().filter(e=>e.invoiceId===t),generateCompactMovementInvoice:async(t,e,r)=>Le.generateMovementInvoice(t,e,r,"compact"),generateModernMovementInvoice:async(t,e,r)=>Le.generateMovementInvoice(t,e,r,"modern"),generateClassicMovementInvoice:async(t,e,r)=>Le.generateMovementInvoice(t,e,r,"classic"),getMovementInvoiceData:t=>{const e=Xr().filter(o=>o.invoiceId===t||o.id===t);if(e.length===0)return null;const r=e[0],n=e.reduce((o,s)=>o+(s.totalCost||s.quantity*s.unitCost),0);return{invoiceId:r.invoiceId||r.id,movementType:r.movementType,referenceNumber:r.referenceNumber,createdBy:r.createdBy,createdDate:r.createdDate,locationName:r.locationName,fromLocationName:r.fromLocationName,toLocationName:r.toLocationName,notes:r.notes,totalValue:n,itemCount:e.length,items:e.map(o=>({productSku:o.productSku,productName:o.productName,quantity:o.quantity,unitCost:o.unitCost,totalCost:o.totalCost||o.quantity*o.unitCost}))}},addInventoryMovement:t=>{const e={...t,id:`mov-${Date.now()}`,createdDate:new Date().toISOString()};ia(r=>[...r,e]),zi(oa())},addBulkInventoryMovements:async t=>{const e=[],r=[],n=new Date().toISOString(),o=No().find(l=>l.id===t.locationId);if(!o)return{success:!1,errors:["Invalid location"]};let s;if(t.movementType==="transfer"){if(!t.fromLocationId)return{success:!1,errors:["From location required for transfers"]};if(s=No().find(l=>l.id===t.fromLocationId),!s)return{success:!1,errors:["Invalid from location"]};if(t.fromLocationId===t.locationId)return{success:!1,errors:["From and to locations cannot be the same"]}}if(t.items.forEach((l,u)=>{const h=Do().find(x=>x.id===l.productId);if(!h){e.push(`Item ${u+1}: Product not found`);return}if(l.quantity<=0){e.push(`Item ${u+1}: Quantity must be greater than 0`);return}if(t.movementType==="out"){const x=io().filter(T=>T.productId===l.productId&&T.locationId===t.locationId).reduce((T,E)=>T+E.quantity,0);if(l.quantity>x){e.push(`Item ${u+1}: Insufficient stock. Available: ${x}, Requested: ${l.quantity}`);return}}if(t.movementType==="transfer"){const x=io().filter(T=>T.productId===l.productId&&T.locationId===t.fromLocationId).reduce((T,E)=>T+E.quantity,0);if(l.quantity>x){e.push(`Item ${u+1}: Insufficient stock at ${s?.name}. Available: ${x}, Requested: ${l.quantity}`);return}}const m=l.unitCost||h.unitCost,v=l.quantity*m,_={id:`mov-${Date.now()}-${u}`,productId:h.id,productName:h.name,productSku:h.sku,locationId:t.locationId,locationName:o.name,movementType:t.movementType,quantity:l.quantity,unitCost:m,totalCost:v,minStock:10,referenceNumber:t.referenceNumber||"",notes:l.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:s?.name};if(r.push(_),t.movementType==="transfer"&&s){const x={id:`mov-${Date.now()}-${u}-out`,productId:h.id,productName:h.name,productSku:h.sku,locationId:t.fromLocationId,locationName:s.name,movementType:"out",quantity:l.quantity,unitCost:m,totalCost:v,minStock:10,referenceNumber:t.referenceNumber||"",notes:`Transfer to ${o.name}`+(l.notes?` - ${l.notes}`:""),createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,toLocationId:t.locationId,toLocationName:o.name};r.push(x)}}),e.length>0)return{success:!1,errors:e};ia(l=>[...l,...r]),zi(oa()),console.log({bulkRequest:t});const a=await Jr.addInventory(t);return console.log({prodResults:a}),{success:!0,errors:[]}},getMovementsByInvoice:t=>Xr().filter(e=>e.invoiceId===t),getInvoiceSummary:t=>{const e=Xr().filter(s=>s.invoiceId===t);if(e.length===0)return null;const r=e.reduce((s,a)=>s+a.totalCost,0),n=new Set(e.map(s=>s.productId)).size,o=e[0];return{invoiceId:t,referenceNumber:o.referenceNumber,movementType:o.movementType,location:o.locationName,fromLocation:o.fromLocationName,productCount:n,totalItems:e.reduce((s,a)=>s+a.quantity,0),totalValue:r,createdDate:o.createdDate,createdBy:o.createdBy}},addProduct:t=>{const e={...t,id:`prod-${Date.now()}`,createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};Jl(r=>[...r,e])},addLocation:t=>{const e={...t,id:`loc-${Date.now()}`,createdDate:new Date().toISOString()};gm(r=>[...r,e])},updateProduct:(t,e)=>{Jl(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n))},updateLocation:(t,e)=>{gm(r=>r.map(n=>n.id===t?{...n,...e}:n))},updateMovement:(t,e)=>{ia(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n)),zi(oa())},get inventory(){return sa()},addItem(t){const e={...t,id:Date.now().toString(),lastUpdated:new Date().toISOString().split("T")[0]};return Xl([...sa(),e]),e},updateItem(t,e){Xl(sa().map(r=>r.id===t?{...r,...e,lastUpdated:new Date().toISOString().split("T")[0]}:r))},deleteItem(t){Xl(sa().filter(e=>e.id!==t))},getItemById(t){return Xr().find(e=>e.id===t)},getLowStockItems(){return Xr().filter(t=>t.quantity*1<=t.minStock*1)},getTotalValue(){return Xr().reduce((t,e)=>t*1+e.unitCost*1*e.quantity*1,0)}};var bm=z("<div>"),Vx=z("<div><div><input type=text autocomplete=off>"),Bx=z("<button type=button>+"),Ux=z("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div>");const _l=t=>{const{t:e}=ft(),[r,n]=ye(!1),[o,s]=ye(""),[a,l]=ye(-1),u=Ze(()=>t.value?Le.getProductById(t.value):null),h=Ze(()=>{const J=o().toLowerCase();return J?Le.getActiveProducts().filter(O=>O.name.toLowerCase().includes(J)||O.sku.toLowerCase().includes(J)||O?.UPC?.toLowerCase().includes(J)||O.category.toLowerCase().includes(J)):Le.getActiveProducts()}),m=()=>{n(!0),s(""),l(-1)},v=J=>{const O=J.target;s(O.value),n(!0),l(-1)},_=J=>{t.onChange(J),n(!1),s(""),l(-1)},x=J=>{const O=h();switch(J.key){case"ArrowDown":J.preventDefault(),l(N=>Math.min(N+1,O.length-1));break;case"ArrowUp":J.preventDefault(),l(N=>Math.max(N-1,-1));break;case"Enter":J.preventDefault(),a()>=0&&O[a()]&&_(O[a()]);break;case"Escape":n(!1),s(""),l(-1);break}},T=J=>{setTimeout(()=>{n(!1),s(""),l(-1)},150)},E=J=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(J),P=J=>Le.stockLevels.filter(O=>O.productId===J).reduce((O,N)=>O+N.quantity,0),R={position:"relative",width:"100%",...t.style},Y={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},Z={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},j=J=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid "+J?"var(--primary-color)":"var(--border-color)",background:J?"var(--strip-color)":"transparent",color:J?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),B={display:"flex","justify-content":"space-between","align-items":"center"},V={flex:"1"},f={"font-weight":"500","margin-bottom":"0.25rem"},g={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},S={"text-align":"right","font-size":"0.875rem"},$={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},w=()=>r()&&o()?o():u()?`${u().name} (${u().sku})`:"",I={display:"flex","align-items":"stretch",width:"100%"},y={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},de={...Y,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"};return(()=>{var J=Vx(),O=J.firstChild,N=O.firstChild;return d(O,I),N.addEventListener("blur",T),N.$$keydown=x,N.$$click=m,N.$$input=v,i(O,(()=>{var q=ge(()=>!!t.onAddNew);return()=>q()&&(()=>{var D=Bx();return D.addEventListener("mouseleave",C=>{C.currentTarget.style.background="var(--surface-color)",C.currentTarget.style.color="var(--primary-color)"}),D.addEventListener("mouseenter",C=>{C.currentTarget.style.background="var(--primary-color)",C.currentTarget.style.color="white"}),Vn(D,"click",t.onAddNew,!0),d(D,y),X(()=>ct(D,"title",e("inventory.addProduct","Add new product"))),D})()})(),null),i(J,b(Ae,{get when(){return r()},get children(){var q=bm();return i(q,b(Ae,{get when(){return h().length>0},get fallback(){return(()=>{var D=bm();return d(D,$),i(D,(()=>{var C=ge(()=>!!o());return()=>C()?e("inventory.noProductsFound","No products found matching your search."):e("inventory.noProductsAvailable","No products available.")})()),D})()},get children(){return b(ut,{get each(){return h()},children:(D,C)=>{const F=P(D.id),ee=F<=D.minStockLevel;return(()=>{var H=Ux(),oe=H.firstChild,M=oe.firstChild,G=M.firstChild,le=G.nextSibling,ne=le.firstChild,ue=ne.firstChild,L=ne.nextSibling,A=L.nextSibling,U=A.nextSibling,te=U.nextSibling,ae=M.nextSibling,re=ae.firstChild,ce=re.firstChild,Q=re.nextSibling;return H.addEventListener("mouseenter",()=>l(C())),H.$$click=()=>_(D),d(oe,B),d(M,V),d(G,f),i(G,()=>D.name),d(le,g),i(ne,()=>e("inventory.sku","SKU"),ue),i(ne,()=>D.sku,null),i(A,()=>D.category),i(te,()=>E(D.unitCost)),d(ae,S),re.style.setProperty("font-weight","600"),(ee?"#f44336":"var(--text-primary)")!=null?re.style.setProperty("color",ee?"#f44336":"var(--text-primary)"):re.style.removeProperty("color"),i(re,F,ce),i(re,()=>D.unitOfMeasure,null),Q.style.setProperty("color","var(--text-muted)"),i(Q,()=>ee?e("inventory.lowStock","Low Stock"):e("inventory.inStock","In Stock")),X(me=>d(H,j(C()===a()),me)),H})()}})}})),X(D=>d(q,Z,D)),q}}),null),X(q=>{var D=R,C=de,F=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),ee=t.disabled,H=t.required;return q.e=d(J,D,q.e),q.t=d(N,C,q.t),F!==q.a&&ct(N,"placeholder",q.a=F),ee!==q.o&&(N.disabled=q.o=ee),H!==q.i&&(N.required=q.i=H),q},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),X(()=>N.value=w()),J})()};wt(["input","click","keydown"]);var _m=z("<div>"),zx=z("<div><div><input type=text autocomplete=off>"),jx=z("<button type=button>+"),qx=z("<div><div><div><div> </div><div><span>: </span><span></span></div><div>");const ws=t=>{const{t:e}=ft(),[r,n]=ye(!1),[o,s]=ye(""),[a,l]=ye(-1),u=Ze(()=>t.value?Le.getLocationById(t.value):null),h=Ze(()=>{let J=Le.getActiveLocations();t.filterType&&(J=J.filter(N=>N.type===t.filterType));const O=o().toLowerCase();return O?J.filter(N=>N.name.toLowerCase().includes(O)||N?.code?.toLowerCase().includes(O)||N?.type?.toLowerCase().includes(O)||N?.address?.toLowerCase().includes(O)):J}),m=()=>{n(!0),s(""),l(-1)},v=J=>{const O=J.target;s(O.value),n(!0),l(-1)},_=J=>{t.onChange(J.id),n(!1),s(""),l(-1)},x=J=>{const O=h();switch(J.key){case"ArrowDown":J.preventDefault(),l(N=>Math.min(N+1,O.length-1));break;case"ArrowUp":J.preventDefault(),l(N=>Math.max(N-1,-1));break;case"Enter":J.preventDefault(),a()>=0&&O[a()]&&_(O[a()]);break;case"Escape":n(!1),s(""),l(-1);break}},T=J=>{setTimeout(()=>{n(!1),s(""),l(-1)},150)},E=J=>({warehouse:"",store:"",supplier:"",customer:""})[J]||"",P=J=>({warehouse:"#2196F3",store:"#4CAF50",supplier:"#FF9800",customer:"#9C27B0"})[J]||"#757575",R={position:"relative",width:"100%",...t.style},Y={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},Z={display:"flex","align-items":"stretch",width:"100%"},j={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},B={...Y,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"},V={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},f=J=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:J?"var(--strip-color)":"transparent",color:J?"var(--primary-dark)":"var(--text-primary)",transition:"all 0.2s ease"}),g={display:"flex","justify-content":"space-between","align-items":"center"},S={flex:"1"},$={"font-weight":"500","margin-bottom":"0.25rem"},w={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem","align-items":"center"},I=J=>({padding:"0.2rem 0.5rem","border-radius":"var(--border-radius-sm)","font-size":"0.7rem","font-weight":"500",background:P(J),color:"white","text-transform":"uppercase"}),y={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},de=()=>r()&&o()?o():u()?`${u().name} (${u().code})`:"";return(()=>{var J=zx(),O=J.firstChild,N=O.firstChild;return d(O,Z),N.addEventListener("blur",T),N.$$keydown=x,N.$$click=m,N.$$input=v,i(O,(()=>{var q=ge(()=>!!t.onAddNew);return()=>q()&&(()=>{var D=jx();return D.addEventListener("mouseleave",C=>{C.currentTarget.style.background="var(--surface-color)",C.currentTarget.style.color="var(--primary-color)"}),D.addEventListener("mouseenter",C=>{C.currentTarget.style.background="var(--primary-color)",C.currentTarget.style.color="white"}),Vn(D,"click",t.onAddNew,!0),d(D,j),X(()=>ct(D,"title",e("inventory.addLocation","Add new location"))),D})()})(),null),i(J,b(Ae,{get when(){return r()},get children(){var q=_m();return i(q,b(Ae,{get when(){return h().length>0},get fallback(){return(()=>{var D=_m();return d(D,y),i(D,(()=>{var C=ge(()=>!!o());return()=>C()?e("inventory.noLocationsFound","No locations found matching your search."):e("inventory.noLocationsAvailable","No locations available.")})()),D})()},get children(){return b(ut,{get each(){return h()},children:(D,C)=>(()=>{var F=qx(),ee=F.firstChild,H=ee.firstChild,oe=H.firstChild,M=oe.firstChild,G=oe.nextSibling,le=G.firstChild,ne=le.firstChild,ue=le.nextSibling,L=G.nextSibling;return F.addEventListener("mouseenter",()=>l(C())),F.$$click=()=>_(D),d(ee,g),d(H,S),d(oe,$),i(oe,()=>E(D.type),M),i(oe,()=>D.name,null),d(G,w),i(le,()=>e("inventory.locationCode","Code"),ne),i(le,()=>D.code,null),i(ue,()=>D.type),L.style.setProperty("font-size","0.75rem"),L.style.setProperty("color","var(--text-muted)"),L.style.setProperty("margin-top","0.25rem"),i(L,()=>D.address),X(A=>{var U=f(C()===a()),te=I(D.type);return A.e=d(F,U,A.e),A.t=d(ue,te,A.t),A},{e:void 0,t:void 0}),F})()})}})),X(D=>d(q,V,D)),q}}),null),X(q=>{var D=R,C=B,F=t.placeholder||e("inventory.searchLocations","Search locations by name, code, or type..."),ee=t.disabled,H=t.required;return q.e=d(J,D,q.e),q.t=d(N,C,q.t),F!==q.a&&ct(N,"placeholder",q.a=F),ee!==q.o&&(N.disabled=q.o=ee),H!==q.i&&(N.required=q.i=H),q},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),X(()=>N.value=de()),J})()};wt(["input","click","keydown"]);var Gx=z("<form><div><label> *</label><input type=text required></div><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text list=categories required><datalist id=categories><option value=Electronics></option><option value=Accessories></option><option value=Office></option><option value=Furniture></option><option value=Software></option><option value=Hardware></option></datalist></div></div><div><label></label><textarea></textarea></div><div><div><label></label><select><option value=pcs></option><option value=kg></option><option value=lbs></option><option value=m></option><option value=ft></option><option value=l></option><option value=gal></option><option value=box></option><option value=pack></option></select></div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div></div><div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div><div></div></div><div><div><label></label><input type=number min=0 step=1></div><div><label></label><input type=number min=1 step=1></div></div><div>"),Hx=z("<div>");const ru=t=>{const{t:e}=ft(),[r,n]=ye(""),[o,s]=ye(""),[a,l]=ye(""),[u,h]=ye(""),[m,v]=ye("pcs"),[_,x]=ye(0),[T,E]=ye(0),[P,R]=ye(10),[Y,Z]=ye(100),[j,B]=ye(""),V=()=>{n(""),s(""),l(""),h(""),v("pcs"),x(0),E(0),R(10),Z(100),B("")},f=O=>{if(O.preventDefault(),B(""),!r().trim()){B(e("forms.productNameRequired"));return}if(!o().trim()){B(e("forms.skuRequired"));return}if(!u().trim()){B(e("forms.categoryRequired"));return}if(_()<0){B(e("forms.unitCostNotNegative"));return}if(T()<0){B(e("forms.sellingPriceNotNegative"));return}if(P()<0){B(e("forms.minStockNotNegative"));return}if(Y()<=P()){B(e("forms.maxStockGreaterThanMin"));return}if(Le.getProductsBySku(o()).length>0){B(e("forms.skuAlreadyExists"));return}const q={name:r().trim(),sku:o().trim().toUpperCase(),description:a().trim(),category:u().trim(),unitOfMeasure:m(),unitCost:_(),sellingPrice:T(),minStockLevel:P(),maxStockLevel:Y(),isActive:!0,businessId:"default-business"};Le.addProduct(q);const D=`prod-${Date.now()}`;t.onProductAdded&&t.onProductAdded(D),V(),t.onClose()},g=()=>{V(),t.onClose()},S={"margin-bottom":"1.5rem"},$={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},w={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},I={...w,cursor:"pointer"},y={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},de={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},J={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"};return b(Ar,{get isOpen(){return t.isOpen},onClose:g,get title(){return e("inventory.addNewProduct")},get children(){var O=Gx(),N=O.firstChild,q=N.firstChild,D=q.firstChild,C=q.nextSibling,F=N.nextSibling,ee=F.firstChild,H=ee.firstChild,oe=H.firstChild,M=H.nextSibling,G=ee.nextSibling,le=G.firstChild,ne=le.firstChild,ue=le.nextSibling,L=F.nextSibling,A=L.firstChild,U=A.nextSibling,te=L.nextSibling,ae=te.firstChild,re=ae.firstChild,ce=re.nextSibling,Q=ce.firstChild,me=Q.nextSibling,K=me.nextSibling,he=K.nextSibling,ve=he.nextSibling,W=ve.nextSibling,ie=W.nextSibling,Pe=ie.nextSibling,_e=Pe.nextSibling,fe=ae.nextSibling,be=fe.firstChild,pe=be.nextSibling,we=te.nextSibling,De=we.firstChild,ke=De.firstChild,Te=ke.nextSibling,Ue=we.nextSibling,Xe=Ue.firstChild,ze=Xe.firstChild,$e=ze.nextSibling,Ge=Xe.nextSibling,ot=Ge.firstChild,je=ot.nextSibling,Ce=Ue.nextSibling;return O.addEventListener("submit",f),i(q,()=>e("inventory.productName"),D),C.addEventListener("change",Se=>n(Se.target.value)),i(H,()=>e("inventory.sku"),oe),M.addEventListener("change",Se=>s(Se.target.value)),i(le,()=>e("inventory.category"),ne),ue.addEventListener("change",Se=>h(Se.target.value)),i(A,()=>e("common.description")),U.addEventListener("change",Se=>l(Se.target.value)),i(re,()=>e("inventory.unitOfMeasure")),ce.addEventListener("change",Se=>v(Se.target.value)),i(Q,()=>e("inventory.pieces")),i(me,()=>e("inventory.kilograms")),i(K,()=>e("inventory.pounds")),i(he,()=>e("inventory.meters")),i(ve,()=>e("inventory.feet")),i(W,()=>e("inventory.liters")),i(ie,()=>e("inventory.gallons")),i(Pe,()=>e("inventory.boxes")),i(_e,()=>e("inventory.packs")),i(be,()=>e("inventory.unitCost")),pe.addEventListener("change",Se=>x(Number(Se.target.value))),i(ke,()=>e("inventory.sellingPrice")),Te.addEventListener("change",Se=>E(Number(Se.target.value))),i(ze,()=>e("inventory.minimumStockLevel")),$e.addEventListener("change",Se=>R(Number(Se.target.value))),i(ot,()=>e("inventory.maximumStockLevel")),je.addEventListener("change",Se=>Z(Number(Se.target.value))),i(O,(()=>{var Se=ge(()=>!!j());return()=>Se()&&(()=>{var Ke=Hx();return d(Ke,y),i(Ke,j),Ke})()})(),Ce),d(Ce,de),i(Ce,b(qe,{variant:"secondary",type:"button",onClick:g,get children(){return e("common.cancel")}}),null),i(Ce,b(qe,{variant:"primary",type:"submit",get children(){return e("inventory.addProduct")}}),null),X(Se=>{var Ke=S,He=$,Oe=w,Ye=e("inventory.enterProductName"),pt=J,vt=$,mt=w,yt=e("inventory.enterSkuCode"),Qe=$,Ct=w,_t=e("inventory.enterCategory"),jt=S,Mt=$,Be={...w,"min-height":"80px",resize:"vertical"},We=e("inventory.enterProductDescription"),at=J,lt=$,Tt=I,Ie=$,Ve=w,st=J,dt=$,Gt=w,Wt=J,At=$,kt=w,rr=$,Et=w;return Se.e=d(N,Ke,Se.e),Se.t=d(q,He,Se.t),Se.a=d(C,Oe,Se.a),Ye!==Se.o&&ct(C,"placeholder",Se.o=Ye),Se.i=d(F,pt,Se.i),Se.n=d(H,vt,Se.n),Se.s=d(M,mt,Se.s),yt!==Se.h&&ct(M,"placeholder",Se.h=yt),Se.r=d(le,Qe,Se.r),Se.d=d(ue,Ct,Se.d),_t!==Se.l&&ct(ue,"placeholder",Se.l=_t),Se.u=d(L,jt,Se.u),Se.c=d(A,Mt,Se.c),Se.w=d(U,Be,Se.w),We!==Se.m&&ct(U,"placeholder",Se.m=We),Se.f=d(te,at,Se.f),Se.y=d(re,lt,Se.y),Se.g=d(ce,Tt,Se.g),Se.p=d(be,Ie,Se.p),Se.b=d(pe,Ve,Se.b),Se.T=d(we,st,Se.T),Se.A=d(ke,dt,Se.A),Se.O=d(Te,Gt,Se.O),Se.I=d(Ue,Wt,Se.I),Se.S=d(ze,At,Se.S),Se.W=d($e,kt,Se.W),Se.C=d(ot,rr,Se.C),Se.B=d(je,Et,Se.B),Se},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),X(()=>C.value=r()),X(()=>M.value=o()),X(()=>ue.value=u()),X(()=>U.value=a()),X(()=>ce.value=m()),X(()=>pe.value=_()),X(()=>Te.value=T()),X(()=>$e.value=P()),X(()=>je.value=Y()),O}})};var Wx=z('<form><div><label> *</label><input type=text required></div><div><div><label> *<button type=button title="Generate code automatically"></button></label><input type=text required><div></div></div><div><label> *</label><select required><option value=warehouse> </option><option value=store> </option><option value=supplier> </option><option value=customer> </option></select><div></div></div></div><div><label> *</label><textarea required></textarea></div><div>'),Yx=z("<div><div>:</div><div><span></span><div><div></div><div>"),Kx=z("<div>");const nu=t=>{const{t:e}=ft(),[r,n]=ye(""),[o,s]=ye(""),[a,l]=ye("warehouse"),[u,h]=ye(""),[m,v]=ye(""),_=()=>{n(""),s(""),l("warehouse"),h(""),v("")},x=()=>{if(r()){const w=a()==="warehouse"?"WH":a()==="store"?"ST":a()==="supplier"?"SUP":"CUST",I=r().toUpperCase().replace(/[^A-Z0-9]/g,"").substring(0,3),y=String(Math.floor(Math.random()*1e3)).padStart(3,"0");s(`${w}-${I}-${y}`)}},T=w=>{if(w.preventDefault(),v(""),!r().trim()){v(e("forms.locationNameRequired"));return}if(!o().trim()){v(e("forms.locationCodeRequired"));return}if(!u().trim()){v(e("forms.addressRequired"));return}if(Le.locations.filter(J=>J.code.toLowerCase()===o().toLowerCase()).length>0){v(e("forms.locationCodeExists"));return}const y={name:r().trim(),code:o().trim().toUpperCase(),type:a(),address:u().trim(),isActive:!0};Le.addLocation(y);const de=`loc-${Date.now()}`;t.onLocationAdded&&t.onLocationAdded(de),_(),t.onClose()},E=()=>{_(),t.onClose()},P={"margin-bottom":"1.5rem"},R={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},Y={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},Z={...Y,cursor:"pointer"},j={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},B={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},V={display:"grid","grid-template-columns":"2fr 1fr",gap:"1rem"},f={"font-size":"0.875rem",color:"var(--text-muted)","margin-top":"0.25rem"},g={padding:"0.25rem 0.5rem","font-size":"0.75rem","margin-left":"0.5rem",background:"var(--background-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",color:"var(--text-muted)"},S=w=>({warehouse:"",store:"",supplier:"",customer:""})[w]||"",$=w=>({warehouse:e("inventory.warehouseDescription"),store:e("inventory.storeDescription"),supplier:e("inventory.supplierDescription"),customer:e("inventory.customerDescription")})[w]||"";return b(Ar,{get isOpen(){return t.isOpen},onClose:E,get title(){return e("inventory.addNewLocation")},get children(){var w=Wx(),I=w.firstChild,y=I.firstChild,de=y.firstChild,J=y.nextSibling,O=I.nextSibling,N=O.firstChild,q=N.firstChild,D=q.firstChild,C=D.nextSibling,F=q.nextSibling,ee=F.nextSibling,H=N.nextSibling,oe=H.firstChild,M=oe.firstChild,G=oe.nextSibling,le=G.firstChild,ne=le.firstChild,ue=le.nextSibling,L=ue.firstChild,A=ue.nextSibling,U=A.firstChild,te=A.nextSibling,ae=te.firstChild,re=G.nextSibling,ce=O.nextSibling,Q=ce.firstChild,me=Q.firstChild,K=Q.nextSibling,he=ce.nextSibling;return w.addEventListener("submit",T),i(y,()=>e("inventory.locationName"),de),J.addEventListener("change",ve=>n(ve.target.value)),d(O,V),i(q,()=>e("inventory.locationCode"),D),C.$$click=x,d(C,g),i(C,()=>e("common.generate")),F.addEventListener("change",ve=>s(ve.target.value)),i(ee,()=>e("inventory.uniqueIdentifierHelp")),i(oe,()=>e("inventory.locationType"),M),G.addEventListener("change",ve=>l(ve.target.value)),i(le,()=>S("warehouse"),ne),i(le,()=>e("inventory.warehouse"),null),i(ue,()=>S("store"),L),i(ue,()=>e("inventory.store"),null),i(A,()=>S("supplier"),U),i(A,()=>e("inventory.supplier"),null),i(te,()=>S("customer"),ae),i(te,()=>e("inventory.customer"),null),i(re,()=>$(a())),i(Q,()=>e("common.address"),me),K.addEventListener("change",ve=>h(ve.target.value)),i(w,(()=>{var ve=ge(()=>!!r());return()=>ve()&&(()=>{var W=Yx(),ie=W.firstChild,Pe=ie.firstChild,_e=ie.nextSibling,fe=_e.firstChild,be=fe.nextSibling,pe=be.firstChild,we=pe.nextSibling;return W.style.setProperty("padding","1rem"),W.style.setProperty("background","var(--background-color)"),W.style.setProperty("border-radius","var(--border-radius-sm)"),W.style.setProperty("border","1px solid var(--border-color)"),W.style.setProperty("margin-bottom","1rem"),ie.style.setProperty("font-weight","500"),ie.style.setProperty("margin-bottom","0.5rem"),i(ie,()=>e("common.preview"),Pe),_e.style.setProperty("display","flex"),_e.style.setProperty("align-items","center"),_e.style.setProperty("gap","0.5rem"),fe.style.setProperty("font-size","1.2rem"),i(fe,()=>S(a())),pe.style.setProperty("font-weight","600"),i(pe,r),we.style.setProperty("font-size","0.875rem"),we.style.setProperty("color","var(--text-muted)"),i(we,(()=>{var De=ge(()=>!!o());return()=>De()&&`${o()}  `})(),null),i(we,a,null),W})()})(),he),i(w,(()=>{var ve=ge(()=>!!m());return()=>ve()&&(()=>{var W=Kx();return d(W,j),i(W,m),W})()})(),he),d(he,B),i(he,b(qe,{variant:"secondary",type:"button",onClick:E,get children(){return e("common.cancel")}}),null),i(he,b(qe,{variant:"primary",type:"submit",get children(){return e("inventory.addLocation")}}),null),X(ve=>{var W=P,ie=R,Pe=Y,_e=e("inventory.enterLocationName"),fe=R,be=Y,pe=e("inventory.enterUniqueCode"),we=f,De=R,ke=Z,Te=f,Ue=P,Xe=R,ze={...Y,"min-height":"100px",resize:"vertical"},$e=e("inventory.enterCompleteAddress");return ve.e=d(I,W,ve.e),ve.t=d(y,ie,ve.t),ve.a=d(J,Pe,ve.a),_e!==ve.o&&ct(J,"placeholder",ve.o=_e),ve.i=d(q,fe,ve.i),ve.n=d(F,be,ve.n),pe!==ve.s&&ct(F,"placeholder",ve.s=pe),ve.h=d(ee,we,ve.h),ve.r=d(oe,De,ve.r),ve.d=d(G,ke,ve.d),ve.l=d(re,Te,ve.l),ve.u=d(ce,Ue,ve.u),ve.c=d(Q,Xe,ve.c),ve.w=d(K,ze,ve.w),$e!==ve.m&&ct(K,"placeholder",ve.m=$e),ve},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),X(()=>J.value=r()),X(()=>F.value=o()),X(()=>G.value=a()),X(()=>K.value=u()),w}})};wt(["click"]);var Qx=z("<form><div>"),Sm=z("<div><label> *"),Jx=z("<div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment>"),Xx=z("<div><label>"),Zx=z("<div><label> *</label><input type=number min=0 step=1 required>"),e$=z("<div><label></label><input type=number min=0 step=0.01>"),t$=z("<div><label></label><input type=text>"),r$=z("<div><label></label><textarea>"),n$=z("<div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span>:</span><span> "),o$=z("<div><div><span>:</span><span>"),i$=z("<div>");const s$=t=>{const{t:e}=ft(),[r,n]=ye({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""}),[o,s]=ye(""),[a,l]=ye(""),[u,h]=ye("in"),[m,v]=ye(0),[_,x]=ye(0),[T,E]=ye(""),[P,R]=ye(""),[Y,Z]=ye(""),[j,B]=ye(""),[V,f]=ye(!1),[g,S]=ye(!1),$=()=>t.mode==="movement",w=Ze(()=>o()?Le.getProductById(o()):null),I=Ze(()=>a()?Le.getLocationById(a()):null),y=Ze(()=>Y()?Le.getLocationById(Y()):null),de=Ze(()=>m()*_()),J=Ze(()=>!o()||!a()?0:Le.getStockByProductAndLocation(o(),a())?.quantity||0),O=[{value:"Electronics",label:"Electronics"},{value:"Accessories",label:"Accessories"},{value:"Furniture",label:"Furniture"},{value:"Office Supplies",label:"Office Supplies"},{value:"Software",label:"Software"},{value:"Hardware",label:"Hardware"},{value:"Consumables",label:"Consumables"}],N=[{value:"Warehouse A",label:"Warehouse A"},{value:"Warehouse B",label:"Warehouse B"},{value:"Warehouse C",label:"Warehouse C"},{value:"Storage Room",label:"Storage Room"},{value:"Main Office",label:"Main Office"}],q={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},D=()=>{s(""),l(""),h("in"),v(0),x(0),E(""),R(""),Z(""),B("")},C=()=>{n({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""})},F=te=>{if(te.preventDefault(),$()){if(B(""),!o()){B(e("forms.selectProduct"));return}if(!a()){B(e("forms.selectLocation"));return}if(m()<=0){B(e("forms.quantityGreaterThanZero"));return}if(_()<0){B(e("forms.unitCostNotNegative"));return}if(u()==="transfer"&&!Y()){B(e("forms.selectFromLocation"));return}if(u()==="transfer"&&Y()===a()){B(e("forms.sameLocationError"));return}if(u()==="out"&&m()>J()){B(e("forms.insufficientStock",{currentStock:J()}));return}const ae=w(),re=I(),ce={productId:ae.id,productName:ae.name,productSku:ae.sku,locationId:re.id,locationName:re.name,movementType:u(),quantity:m(),unitCost:_()||ae.unitCost,totalCost:de()||m()*ae.unitCost,referenceNumber:T()||`AUTO-${Date.now()}`,notes:P(),createdBy:"admin",fromLocationId:u()==="transfer"?Y():void 0,fromLocationName:u()==="transfer"?y()?.name:void 0};Le.addInventoryMovement(ce),D()}else{const ae=r();if(!ae.name||!ae.price||!ae.quantity||!ae.category||!ae.sku||!ae.supplier||!ae.minStock||!ae.location){alert(e("forms.fillAllRequired"));return}const re={name:ae.name,price:parseFloat(ae.price),quantity:parseInt(ae.quantity),category:ae.category,description:ae.description,sku:ae.sku,supplier:ae.supplier,minStock:parseInt(ae.minStock),location:ae.location};Le.addItem(re),C()}t.onClose()},ee=(te,ae)=>{n(re=>({...re,[te]:ae}))},H=()=>{$()?D():C(),t.onClose()},oe=te=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(te),M={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},G={...M,cursor:"pointer"},le={color:"#f44336","font-size":"0.875rem","margin-top":"0.5rem"},ne={padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},ue={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},L={"font-weight":"500",color:"var(--text-muted)"},A={"font-weight":"600",color:"var(--text-primary)"},U=()=>$()?e("inventory.addMovement"):e("inventory.addNewItem");return b(Ar,{get isOpen(){return t.isOpen},onClose:H,get title(){return U()},get children(){return[(()=>{var te=Qx(),ae=te.firstChild;return te.addEventListener("submit",F),i(te,(()=>{var re=ge(()=>!!$());return()=>re()?[(()=>{var ce=Sm(),Q=ce.firstChild,me=Q.firstChild;return ce.style.setProperty("margin-bottom","1.5rem"),Q.style.setProperty("display","block"),Q.style.setProperty("margin-bottom","0.5rem"),Q.style.setProperty("font-weight","500"),i(Q,()=>e("inventory.product"),me),i(ce,b(_l,{get value(){return o()},onChange:K=>{s(K);const he=Le.getProductById(K);he&&x(he.unitCost)},get placeholder(){return e("inventory.searchProductsPlaceholder")},onAddNew:()=>f(!0),required:!0}),null),ce})(),(()=>{var ce=Jx(),Q=ce.firstChild,me=Q.firstChild,K=Q.nextSibling,he=K.firstChild,ve=he.nextSibling,W=ve.nextSibling,ie=W.nextSibling;return ce.style.setProperty("margin-bottom","1.5rem"),Q.style.setProperty("display","block"),Q.style.setProperty("margin-bottom","0.5rem"),Q.style.setProperty("font-weight","500"),i(Q,()=>e("inventory.movementType"),me),K.addEventListener("change",Pe=>h(Pe.target.value)),i(he,()=>e("inventory.stockInPurchase")),i(ve,()=>e("inventory.stockOutSale")),i(W,()=>e("inventory.transferBetween")),i(ie,()=>e("inventory.stockAdjustment")),X(Pe=>d(K,G,Pe)),X(()=>K.value=u()),ce})(),ge(()=>ge(()=>u()==="transfer")()&&(()=>{var ce=Sm(),Q=ce.firstChild,me=Q.firstChild;return ce.style.setProperty("margin-bottom","1.5rem"),Q.style.setProperty("display","block"),Q.style.setProperty("margin-bottom","0.5rem"),Q.style.setProperty("font-weight","500"),i(Q,()=>e("inventory.fromLocation"),me),i(ce,b(ws,{get value(){return Y()},onChange:K=>Z(K),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>S(!0),required:!0}),null),ce})()),(()=>{var ce=Xx(),Q=ce.firstChild;return ce.style.setProperty("margin-bottom","1.5rem"),Q.style.setProperty("display","block"),Q.style.setProperty("margin-bottom","0.5rem"),Q.style.setProperty("font-weight","500"),i(Q,(()=>{var me=ge(()=>u()==="transfer");return()=>me()?e("inventory.toLocation")+" *":e("inventory.locationName")+" *"})()),i(ce,b(ws,{get value(){return a()},onChange:me=>l(me),get placeholder(){return ge(()=>u()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>S(!0),required:!0}),null),ce})(),ge(()=>ge(()=>!!(w()&&I()))()&&(()=>{var ce=n$(),Q=ce.firstChild,me=Q.firstChild,K=me.firstChild,he=me.nextSibling,ve=he.firstChild,W=Q.nextSibling,ie=W.firstChild,Pe=ie.firstChild,_e=ie.nextSibling,fe=W.nextSibling,be=fe.firstChild,pe=be.firstChild,we=be.nextSibling,De=we.firstChild;return i(me,()=>e("inventory.currentStockAt",{location:I()?.name}),K),i(he,J,ve),i(he,()=>w()?.unitOfMeasure,null),i(ie,()=>e("inventory.productCost"),Pe),i(_e,()=>oe(w()?.unitCost||0)),i(be,()=>e("inventory.minStockLevel"),pe),i(we,()=>w()?.minStockLevel,De),i(we,()=>w()?.unitOfMeasure,null),X(ke=>{var Te=ne,Ue=ue,Xe=L,ze=A,$e=ue,Ge=L,ot=A,je=ue,Ce=L,Se=A;return ke.e=d(ce,Te,ke.e),ke.t=d(Q,Ue,ke.t),ke.a=d(me,Xe,ke.a),ke.o=d(he,ze,ke.o),ke.i=d(W,$e,ke.i),ke.n=d(ie,Ge,ke.n),ke.s=d(_e,ot,ke.s),ke.h=d(fe,je,ke.h),ke.r=d(be,Ce,ke.r),ke.d=d(we,Se,ke.d),ke},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),ce})()),(()=>{var ce=Zx(),Q=ce.firstChild,me=Q.firstChild,K=Q.nextSibling;return ce.style.setProperty("margin-bottom","1.5rem"),Q.style.setProperty("display","block"),Q.style.setProperty("margin-bottom","0.5rem"),Q.style.setProperty("font-weight","500"),i(Q,()=>e("inventory.quantity"),me),K.addEventListener("change",he=>v(Number(he.target.value))),X(he=>d(K,M,he)),X(()=>K.value=m()),ce})(),(()=>{var ce=e$(),Q=ce.firstChild,me=Q.nextSibling;return ce.style.setProperty("margin-bottom","1.5rem"),Q.style.setProperty("display","block"),Q.style.setProperty("margin-bottom","0.5rem"),Q.style.setProperty("font-weight","500"),i(Q,()=>e("inventory.unitCost")),me.addEventListener("change",K=>x(Number(K.target.value))),X(K=>{var he=M,ve=e("inventory.willUseDefaultCost");return K.e=d(me,he,K.e),ve!==K.t&&ct(me,"placeholder",K.t=ve),K},{e:void 0,t:void 0}),X(()=>me.value=_()),ce})(),ge(()=>ge(()=>m()>0&&_()>0)()&&(()=>{var ce=o$(),Q=ce.firstChild,me=Q.firstChild,K=me.firstChild,he=me.nextSibling;return i(me,()=>e("inventory.totalCost"),K),i(he,()=>oe(de())),X(ve=>{var W=ne,ie=ue,Pe=L,_e={...A,"font-size":"1.2rem",color:"var(--primary-color)"};return ve.e=d(ce,W,ve.e),ve.t=d(Q,ie,ve.t),ve.a=d(me,Pe,ve.a),ve.o=d(he,_e,ve.o),ve},{e:void 0,t:void 0,a:void 0,o:void 0}),ce})()),(()=>{var ce=t$(),Q=ce.firstChild,me=Q.nextSibling;return ce.style.setProperty("margin-bottom","1.5rem"),Q.style.setProperty("display","block"),Q.style.setProperty("margin-bottom","0.5rem"),Q.style.setProperty("font-weight","500"),i(Q,()=>e("common.referenceNumber")),me.addEventListener("change",K=>E(K.target.value)),X(K=>{var he=M,ve=e("common.referenceNumberPlaceholder");return K.e=d(me,he,K.e),ve!==K.t&&ct(me,"placeholder",K.t=ve),K},{e:void 0,t:void 0}),X(()=>me.value=T()),ce})(),(()=>{var ce=r$(),Q=ce.firstChild,me=Q.nextSibling;return ce.style.setProperty("margin-bottom","1.5rem"),Q.style.setProperty("display","block"),Q.style.setProperty("margin-bottom","0.5rem"),Q.style.setProperty("font-weight","500"),i(Q,()=>e("common.notes")),me.addEventListener("change",K=>R(K.target.value)),X(K=>{var he={...M,"min-height":"100px",resize:"vertical"},ve=e("inventory.additionalNotesPlaceholder");return K.e=d(me,he,K.e),ve!==K.t&&ct(me,"placeholder",K.t=ve),K},{e:void 0,t:void 0}),X(()=>me.value=P()),ce})(),ge(()=>ge(()=>!!j())()&&(()=>{var ce=i$();return d(ce,le),i(ce,j),ce})())]:[b(Qt,{get label(){return e("inventory.itemName")},get value(){return r().name},onChange:ce=>ee("name",ce),get placeholder(){return e("inventory.enterItemName")},required:!0}),b(Qt,{get label(){return e("inventory.sku")},get value(){return r().sku},onChange:ce=>ee("sku",ce),get placeholder(){return e("inventory.enterSkuCode")},required:!0}),b(Dr,{get label(){return e("inventory.category")},get value(){return r().category},onChange:ce=>ee("category",ce),options:O,required:!0}),b(Qt,{get label(){return e("common.description")},get value(){return r().description},onChange:ce=>ee("description",ce),get placeholder(){return e("inventory.enterItemDescription")}}),b(Qt,{get label(){return e("common.price")},type:"number",get value(){return r().price},onChange:ce=>ee("price",ce),get placeholder(){return e("common.enterPrice")},required:!0}),b(Qt,{get label(){return e("inventory.quantity")},type:"number",get value(){return r().quantity},onChange:ce=>ee("quantity",ce),get placeholder(){return e("inventory.enterQuantity")},required:!0}),b(Qt,{get label(){return e("inventory.minimumStock")},type:"number",get value(){return r().minStock},onChange:ce=>ee("minStock",ce),get placeholder(){return e("inventory.enterMinStockLevel")},required:!0}),b(Qt,{get label(){return e("inventory.supplier")},get value(){return r().supplier},onChange:ce=>ee("supplier",ce),get placeholder(){return e("inventory.enterSupplierName")},required:!0}),b(Dr,{get label(){return e("inventory.location")},get value(){return r().location},onChange:ce=>ee("location",ce),options:N,required:!0})]})(),ae),d(ae,q),i(ae,b(qe,{variant:"secondary",type:"button",onClick:H,get children(){return e("common.cancel")}}),null),i(ae,b(qe,{variant:"primary",type:"submit",get children(){return ge(()=>!!$())()?e("inventory.addMovement"):e("inventory.addItem")}}),null),te})(),b(ru,{get isOpen(){return V()},onClose:()=>f(!1),onProductAdded:te=>{s(te),f(!1)}}),b(nu,{get isOpen(){return g()},onClose:()=>S(!1),onLocationAdded:te=>{u()==="transfer"&&!Y()?Z(te):l(te),S(!1)}})]}})};wt(["input","keydown"]);var a$=z("<form><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text required></div></div><div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><div><label></label></div></div><div><div><h3></h3></div></div><div><label></label><textarea></textarea></div><div>"),l$=z("<div><label> *"),c$=z("<div><div></div><div></div><div></div><div></div><div>"),Zl=z("<div>"),d$=z("<div><input type=number min=0 step=1 required><input type=number min=0 step=0.01><input type=text>"),u$=z("<div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span>"),h$=z("<div> ");const m$=t=>{const{t:e}=ft(),[r,n]=ye(`INV-${Date.now()}`),[o,s]=ye(""),[a,l]=ye("in"),[u,h]=ye(""),[m,v]=ye(""),[_,x]=ye(""),[T,E]=ye([]),[P,R]=ye([]),[Y,Z]=ye(!1),[j,B]=ye(!1),V=()=>{E(ne=>[...ne,{productId:"",quantity:0,unitCost:0,notes:""}])},f=ne=>{E(ue=>ue.filter((L,A)=>A!==ne))},g=(ne,ue,L)=>{E(A=>A.map((U,te)=>te===ne?{...U,[ue]:L}:U))},S=()=>{n(`INV-${Date.now()}`),s(""),l("in"),h(""),v(""),x(""),E([]),R([])},$=async ne=>{ne.preventDefault(),R([]);const ue=[];if(o()||ue.push(e("forms.referenceNumberRequired")),u()||ue.push(e("forms.locationRequired")),a()==="transfer"&&!m()&&ue.push(e("forms.fromLocationRequired")),T().length===0&&ue.push(e("forms.atLeastOneProduct")),T().forEach((U,te)=>{U.productId||ue.push(e("forms.itemProductRequired","Product is required for item {{index}}",{index:te+1})),U.quantity<=0&&ue.push(e("forms.itemQuantityRequired","Quantity must be greater than 0 for item {{index}}",{index:te+1}))}),ue.length>0){R(ue);return}const L={ssg_inventory_key:wy(),invoiceId:r(),referenceNumber:o(),movementType:a(),type:_c(a()),locationId:u(),fromLocationId:a()==="transfer"?m():void 0,items:T(),products:T(),generalNotes:_(),description:_(),invoice:o(),store:u(),createdBy:"admin",createDate:new Date().toISOString()};console.log(L);const A=await Le.addBulkInventoryMovements(L);console.log(A),A.success?t.onMovementComplete?t.onMovementComplete(o()):(S(),t.onClose()):R(A.errors)},w=()=>{S(),t.onClose()},I=Ze(()=>T().reduce((ne,ue)=>{const L=Le.getProductById(ue.productId),A=ue.unitCost||L?.unitCost||0;return ne+ue.quantity*A},0)),y=Ze(()=>T().reduce((ne,ue)=>ne+ue.quantity,0)),de={"margin-bottom":"1.5rem"},J={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},O={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},N={...O,cursor:"pointer"},q={display:"grid",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},D={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},C={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem","padding-left":"0.75rem"},F={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},ee={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},H={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},oe={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},M=ne=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ne),G=ne=>({in:e("inventory.purchaseReceive"),out:e("inventory.saleIssue"),transfer:e("inventory.transfer"),adjustment:e("inventory.adjustment")})[ne]||ne,le=async ne=>{await Le.fecthInventory(ne),await Le.fecthProduct(ne)};return $r(()=>{le("prod")}),b(Ar,{get isOpen(){return t.isOpen},onClose:w,get title(){return e("inventory.bulkMovement")},get children(){return[(()=>{var ne=a$(),ue=ne.firstChild,L=ue.firstChild,A=L.firstChild,U=A.firstChild,te=A.nextSibling,ae=L.nextSibling,re=ae.firstChild,ce=re.firstChild,Q=re.nextSibling,me=ue.nextSibling,K=me.firstChild,he=K.firstChild,ve=K.nextSibling,W=ve.firstChild,ie=W.nextSibling,Pe=ie.nextSibling,_e=Pe.nextSibling,fe=me.nextSibling,be=fe.firstChild,pe=be.firstChild,we=fe.nextSibling,De=we.firstChild,ke=De.firstChild,Te=we.nextSibling,Ue=Te.firstChild,Xe=Ue.nextSibling,ze=Te.nextSibling;return ne.addEventListener("submit",$),ue.style.setProperty("display","grid"),ue.style.setProperty("grid-template-columns","1fr 1fr"),ue.style.setProperty("gap","1rem"),ue.style.setProperty("margin-bottom","1.5rem"),i(A,()=>e("common.invoiceDocumentId"),U),te.addEventListener("change",$e=>n($e.target.value)),i(re,()=>e("common.referenceNumber"),ce),Q.addEventListener("change",$e=>s($e.target.value)),i(K,()=>e("inventory.movementType"),he),ve.addEventListener("change",$e=>l($e.target.value)),i(W,()=>e("inventory.purchaseReceive")),i(ie,()=>e("inventory.saleIssue")),i(Pe,()=>e("inventory.transfer")),i(_e,()=>e("inventory.adjustment")),fe.style.setProperty("display","grid"),fe.style.setProperty("gap","1rem"),fe.style.setProperty("margin-bottom","1.5rem"),i(fe,(()=>{var $e=ge(()=>a()==="transfer");return()=>$e()&&(()=>{var Ge=l$(),ot=Ge.firstChild,je=ot.firstChild;return i(ot,()=>e("inventory.fromLocation"),je),i(Ge,b(ws,{get value(){return m()},onChange:Ce=>v(Ce),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>B(!0),required:!0}),null),X(Ce=>d(ot,J,Ce)),Ge})()})(),be),i(pe,(()=>{var $e=ge(()=>a()==="transfer");return()=>$e()?e("inventory.toLocation")+" *":e("inventory.location")+" *"})()),i(be,b(ws,{get value(){return u()},onChange:$e=>h($e),get placeholder(){return ge(()=>a()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>B(!0),required:!0}),null),De.style.setProperty("display","flex"),De.style.setProperty("justify-content","space-between"),De.style.setProperty("align-items","center"),De.style.setProperty("margin-bottom","1rem"),ke.style.setProperty("margin","0"),ke.style.setProperty("font-size","1.1rem"),i(ke,()=>e("inventory.products")),i(De,b(qe,{variant:"outline",type:"button",onClick:V,get children(){return e("inventory.addProduct")}}),null),i(we,(()=>{var $e=ge(()=>T().length>0);return()=>$e()&&[(()=>{var Ge=c$(),ot=Ge.firstChild,je=ot.nextSibling,Ce=je.nextSibling,Se=Ce.nextSibling;return d(Ge,C),i(ot,()=>e("inventory.product")),i(je,()=>e("inventory.quantity")),i(Ce,()=>e("inventory.unitCost")),i(Se,()=>e("common.notes")),Ge})(),b(ut,{get each(){return T()},children:(Ge,ot)=>[(()=>{var je=Zl();return d(je,q),i(je,b(_l,{get value(){return Ge.productId},onChange:Ce=>{g(ot(),"productId",Ce.id);let Se={id:Ce.id,label:Ce.name,code:Ce.sku};g(ot(),"product",Se);const Ke=Le.getProductById(Ce.id);Ke&&!Ge.unitCost&&g(ot(),"unitCost",Ke.unitCost)},get placeholder(){return e("inventory.searchProduct")},onAddNew:()=>Z(!0),required:!0})),je})(),(()=>{var je=d$(),Ce=je.firstChild,Se=Ce.nextSibling,Ke=Se.nextSibling;return d(je,D),Ce.addEventListener("change",He=>g(ot(),"quantity",Number(He.target.value))),Se.addEventListener("change",He=>g(ot(),"unitCost",Number(He.target.value))),Ke.addEventListener("change",He=>g(ot(),"notes",He.target.value)),i(je,b(qe,{variant:"outline",size:"sm",type:"button",onClick:()=>f(ot()),style:{color:"#f44336","border-color":"#f44336"},get children(){return e("common.remove")}}),null),X(He=>{var Oe=O,Ye=O,pt=e("common.auto"),vt=O,mt=e("common.optionalNotes");return He.e=d(Ce,Oe,He.e),He.t=d(Se,Ye,He.t),pt!==He.a&&ct(Se,"placeholder",He.a=pt),He.o=d(Ke,vt,He.o),mt!==He.i&&ct(Ke,"placeholder",He.i=mt),He},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),X(()=>Ce.value=Ge.quantity),X(()=>Se.value=Ge.unitCost),X(()=>Ke.value=Ge.notes),je})()]})]})(),null),i(we,(()=>{var $e=ge(()=>T().length===0);return()=>$e()&&(()=>{var Ge=Zl();return Ge.style.setProperty("text-align","center"),Ge.style.setProperty("padding","2rem"),Ge.style.setProperty("background","var(--background-color)"),Ge.style.setProperty("border-radius","var(--border-radius-sm)"),Ge.style.setProperty("border","1px solid var(--border-color)"),Ge.style.setProperty("color","var(--text-muted)"),i(Ge,()=>e("inventory.noProductsAdded")),Ge})()})(),null),i(ne,(()=>{var $e=ge(()=>T().length>0);return()=>$e()&&(()=>{var Ge=u$(),ot=Ge.firstChild,je=ot.nextSibling,Ce=je.firstChild,Se=Ce.firstChild,Ke=Ce.nextSibling,He=je.nextSibling,Oe=He.firstChild,Ye=Oe.firstChild,pt=Oe.nextSibling,vt=He.nextSibling,mt=vt.firstChild,yt=mt.firstChild,Qe=mt.nextSibling,Ct=vt.nextSibling,_t=Ct.firstChild,jt=_t.firstChild,Mt=_t.nextSibling;return d(Ge,F),ot.style.setProperty("margin","0 0 1rem 0"),ot.style.setProperty("font-size","1rem"),i(ot,()=>e("common.summary")),i(Ce,()=>e("inventory.totalProducts"),Se),Ke.style.setProperty("font-weight","600"),i(Ke,()=>T().length),i(Oe,()=>e("inventory.totalItems"),Ye),pt.style.setProperty("font-weight","600"),i(pt,y),i(mt,()=>e("inventory.totalValue"),yt),Qe.style.setProperty("font-weight","600"),Qe.style.setProperty("color","var(--primary-color)"),i(Qe,()=>M(I())),i(_t,()=>e("inventory.movementType"),jt),Mt.style.setProperty("font-weight","600"),i(Mt,()=>G(a())),X(Be=>{var We=ee,at=ee,lt=ee,Tt=ee;return Be.e=d(je,We,Be.e),Be.t=d(He,at,Be.t),Be.a=d(vt,lt,Be.a),Be.o=d(Ct,Tt,Be.o),Be},{e:void 0,t:void 0,a:void 0,o:void 0}),Ge})()})(),Te),i(Ue,()=>e("common.generalNotes")),Xe.addEventListener("change",$e=>x($e.target.value)),i(ne,(()=>{var $e=ge(()=>P().length>0);return()=>$e()&&(()=>{var Ge=Zl();return d(Ge,H),i(Ge,b(ut,{get each(){return P()},children:ot=>(()=>{var je=h$();return je.firstChild,i(je,ot,null),je})()})),Ge})()})(),ze),d(ze,oe),i(ze,b(qe,{variant:"secondary",type:"button",onClick:w,get children(){return e("common.cancel")}}),null),i(ze,b(qe,{variant:"primary",type:"submit",get children(){return e("inventory.createMovement")}}),null),X($e=>{var Ge=J,ot=O,je=J,Ce=O,Se=e("common.referenceNumberPlaceholder"),Ke=de,He=J,Oe=N,Ye=a()==="transfer"?"1fr 1fr":"1fr",pt=J,vt=de,mt=de,yt=J,Qe={...O,"min-height":"80px",resize:"vertical"},Ct=e("inventory.generalNotesPlaceholder");return $e.e=d(A,Ge,$e.e),$e.t=d(te,ot,$e.t),$e.a=d(re,je,$e.a),$e.o=d(Q,Ce,$e.o),Se!==$e.i&&ct(Q,"placeholder",$e.i=Se),$e.n=d(me,Ke,$e.n),$e.s=d(K,He,$e.s),$e.h=d(ve,Oe,$e.h),Ye!==$e.r&&(($e.r=Ye)!=null?fe.style.setProperty("grid-template-columns",Ye):fe.style.removeProperty("grid-template-columns")),$e.d=d(pe,pt,$e.d),$e.l=d(we,vt,$e.l),$e.u=d(Te,mt,$e.u),$e.c=d(Ue,yt,$e.c),$e.w=d(Xe,Qe,$e.w),Ct!==$e.m&&ct(Xe,"placeholder",$e.m=Ct),$e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),X(()=>te.value=r()),X(()=>Q.value=o()),X(()=>ve.value=a()),X(()=>Xe.value=_()),ne})(),b(ru,{get isOpen(){return Y()},onClose:()=>Z(!1),onProductAdded:ne=>{Z(!1)}}),b(nu,{get isOpen(){return j()},onClose:()=>B(!1),onLocationAdded:ne=>{a()==="transfer"&&!m()?v(ne):h(ne),B(!1)}})]}})};var y$=z("<button>"),p$=z("<div><h3></h3><button> "),f$=z("<div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> "),ec=z("<div><strong>:</strong> "),g$=z("<div>"),v$=z("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),b$=z("<div><div><h2></h2><div><select><option value=date></option><option value=quantity></option><option value=value></option></select></div></div><div>"),_$=z("<div><div><h3></h3><div></div></div><div><span></span><div>"),S$=z("<div><div><strong>:</strong> "),P$=z("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),w$=z("<div><button></button><button>"),C$=z("<tr><td></td><td></td><td></td><td></td><td></td><td>");const ng=t=>{const{t:e}=ft(),[r,n]=ye(null),[o,s]=ye("date"),a=Ze(()=>{const _=t.movements||Le.movements,x=new Map;return _.forEach(T=>{const E=T.referenceNumber||T.ssg_inventory_key||T.invoiceId||"UNKNOWN";if(!x.has(E)){const Y=Le.getLocationById(T.locationId);x.set(E,{referenceNumber:T.referenceNumber||"",invoiceId:T.invoiceId||"",ssg_inventory_key:T.ssg_inventory_key||"",movementType:T.movementType||"unknown",locationId:T.locationId||"",locationName:Y?.name||"Unknown Location",totalItems:0,totalQuantity:0,createDate:T.createDate||new Date().toISOString(),description:T.description||"",generalNotes:T.generalNotes||"",movements:[],totalValue:0})}const P=x.get(E);P.movements.push(T),P.totalItems++,P.totalQuantity+=Math.abs(T.quantity||0);const R=Le.getProductById(T.productId);R&&R.unitCost&&(P.totalValue+=Math.abs(T.quantity||0)*R.unitCost)}),Array.from(x.values()).sort((T,E)=>{switch(o()){case"quantity":return E.totalQuantity-T.totalQuantity;case"value":return E.totalValue-T.totalValue;case"date":default:return new Date(E.createDate).getTime()-new Date(T.createDate).getTime()}})}),l=_=>new Date(_).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),u=_=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(_),h=_=>{switch(_.toLowerCase()){case"in":case"stock_in":return"#22c55e";case"out":case"stock_out":return"#ef4444";case"transfer":return"#3b82f6";case"adjustment":return"#f59e0b";default:return"#6b7280"}},m=_=>{switch(_.toLowerCase()){case"in":case"stock_in":return"";case"out":case"stock_out":return"";case"transfer":return"";case"adjustment":return"";default:return""}},v=_=>{const x=_||r();if(!x)return;const T=window.open("","_blank");if(!T)return;const E=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Bulk Movement Report - ${x.referenceNumber||x.invoiceId}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          .header { text-align: center; border-bottom: 2px solid #333; padding-bottom: 10px; margin-bottom: 20px; }
          .group-info { background: #f8f9fa; padding: 15px; margin-bottom: 20px; border-radius: 5px; }
          .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
          table { width: 100%; border-collapse: collapse; margin-top: 15px; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background-color: #f2f2f2; font-weight: bold; }
          .summary { background: #e8f4fd; padding: 15px; margin-top: 20px; border-radius: 5px; }
          @media print { body { margin: 0; } }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>BULK MOVEMENT REPORT</h1>
          <h2>${x.referenceNumber||x.invoiceId}</h2>
          <p>Generated: ${l(new Date().toISOString())}</p>
        </div>
        
        <div class="group-info">
          <div class="info-grid">
            <div>
              <strong>Reference Number:</strong> ${x.referenceNumber||"N/A"}<br>
              <strong>Invoice ID:</strong> ${x.invoiceId||"N/A"}<br>
              <strong>Movement Type:</strong> ${x.movementType.toUpperCase()}<br>
              <strong>Location:</strong> ${x.locationName}
            </div>
            <div>
              <strong>Date:</strong> ${l(x.createDate)}<br>
              <strong>Total Items:</strong> ${x.totalItems}<br>
              <strong>Total Quantity:</strong> ${x.totalQuantity}<br>
              <strong>Estimated Value:</strong> ${u(x.totalValue)}
            </div>
          </div>
          ${x.description?`<p><strong>Description:</strong> ${x.description}</p>`:""}
          ${x.generalNotes?`<p><strong>Notes:</strong> ${x.generalNotes}</p>`:""}
        </div>
        
        <table>
          <thead>
            <tr>
              <th>Product Code</th>
              <th>Product Name</th>
              <th>Quantity</th>
              <th>Unit Cost</th>
              <th>Total Value</th>
              <th>Notes</th>
            </tr>
          </thead>
          <tbody>
            ${x.movements.map(P=>{const R=Le.getProductById(P.productId),Y=R?.unitCost||0,Z=Math.abs(P.quantity||0)*Y;return`
                <tr>
                  <td>${R?.code||P.productId}</td>
                  <td>${R?.name||"Unknown Product"}</td>
                  <td>${P.quantity||0}</td>
                  <td>${u(Y)}</td>
                  <td>${u(Z)}</td>
                  <td>${P.notes||"-"}</td>
                </tr>
              `}).join("")}
          </tbody>
        </table>
        
        <div class="summary">
          <h3>SUMMARY</h3>
          <p><strong>Total Products:</strong> ${x.totalItems}</p>
          <p><strong>Total Quantity Moved:</strong> ${x.totalQuantity}</p>
          <p><strong>Total Estimated Value:</strong> ${u(x.totalValue)}</p>
          <p><strong>Movement Impact:</strong> ${x.movementType==="in"?"Increased":x.movementType==="out"?"Decreased":"Adjusted"} inventory</p>
        </div>
      </body>
      </html>
    `;T.document.write(E),T.document.close(),T.print()};return(()=>{var _=b$(),x=_.firstChild,T=x.firstChild,E=T.nextSibling,P=E.firstChild,R=P.firstChild,Y=R.nextSibling,Z=Y.nextSibling,j=x.nextSibling;return _.style.setProperty("padding","1rem"),x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),x.style.setProperty("margin-bottom","2rem"),i(T,()=>e("inventory.bulkMovementReport","Bulk Movement Report")),E.style.setProperty("display","flex"),E.style.setProperty("gap","1rem"),P.addEventListener("change",B=>s(B.currentTarget.value)),P.style.setProperty("padding","0.5rem"),i(R,()=>e("common.sortByDate","Sort by Date")),i(Y,()=>e("common.sortByQuantity","Sort by Quantity")),i(Z,()=>e("common.sortByValue","Sort by Value")),i(E,b(Ae,{get when(){return t.onClose},get children(){var B=y$();return Vn(B,"click",t.onClose,!0),B.style.setProperty("padding","0.5rem 1rem"),B.style.setProperty("background","#6c757d"),B.style.setProperty("color","white"),B.style.setProperty("border","none"),B.style.setProperty("border-radius","var(--border-radius-sm)"),B.style.setProperty("cursor","pointer"),i(B,()=>e("common.close","Close")),B}}),null),j.style.setProperty("display","grid"),j.style.setProperty("grid-template-columns","repeat(auto-fill, minmax(400px, 1fr))"),j.style.setProperty("gap","1rem"),j.style.setProperty("margin-bottom","2rem"),i(j,b(ut,{get each(){return a()},children:B=>b(rt,{get style(){return{cursor:"pointer",border:r()===B?"2px solid var(--primary-color)":"1px solid #e9ecef",transition:"all 0.2s"}},onClick:()=>n(B),get children(){return[(()=>{var V=_$(),f=V.firstChild,g=f.firstChild,S=g.nextSibling,$=f.nextSibling,w=$.firstChild,I=w.nextSibling;return V.style.setProperty("display","flex"),V.style.setProperty("justify-content","space-between"),V.style.setProperty("align-items","flex-start"),V.style.setProperty("margin-bottom","1rem"),g.style.setProperty("margin","0 0 0.5rem 0"),g.style.setProperty("font-size","1.1rem"),i(g,()=>B.referenceNumber||B.invoiceId||"No Reference"),S.style.setProperty("font-size","0.875rem"),S.style.setProperty("color","#6c757d"),i(S,()=>l(B.createDate)),$.style.setProperty("text-align","center"),w.style.setProperty("font-size","1.5rem"),i(w,()=>m(B.movementType)),I.style.setProperty("font-size","0.75rem"),I.style.setProperty("font-weight","bold"),i(I,()=>B.movementType.toUpperCase()),X(y=>(y=h(B.movementType))!=null?I.style.setProperty("color",y):I.style.removeProperty("color")),V})(),(()=>{var V=S$(),f=V.firstChild,g=f.firstChild,S=g.firstChild;return g.nextSibling,V.style.setProperty("margin-bottom","1rem"),f.style.setProperty("font-size","0.875rem"),f.style.setProperty("margin-bottom","0.25rem"),i(g,()=>e("inventory.location","Location"),S),i(f,()=>B.locationName,null),i(V,b(Ae,{get when(){return B.description},get children(){var $=ec(),w=$.firstChild,I=w.firstChild;return w.nextSibling,$.style.setProperty("font-size","0.875rem"),$.style.setProperty("margin-bottom","0.25rem"),i(w,()=>e("common.description","Description"),I),i($,()=>B.description,null),$}}),null),V})(),(()=>{var V=P$(),f=V.firstChild,g=f.firstChild,S=g.nextSibling,$=f.nextSibling,w=$.firstChild,I=w.nextSibling,y=$.nextSibling,de=y.firstChild,J=de.nextSibling;return V.style.setProperty("display","grid"),V.style.setProperty("grid-template-columns","repeat(3, 1fr)"),V.style.setProperty("gap","0.5rem"),V.style.setProperty("margin-bottom","1rem"),f.style.setProperty("text-align","center"),f.style.setProperty("padding","0.5rem"),f.style.setProperty("background","#f8f9fa"),f.style.setProperty("border-radius","var(--border-radius-sm)"),g.style.setProperty("font-weight","bold"),g.style.setProperty("color","#3b82f6"),i(g,()=>B.totalItems),S.style.setProperty("font-size","0.75rem"),S.style.setProperty("color","#6c757d"),i(S,()=>e("inventory.items","Items")),$.style.setProperty("text-align","center"),$.style.setProperty("padding","0.5rem"),$.style.setProperty("background","#f8f9fa"),$.style.setProperty("border-radius","var(--border-radius-sm)"),w.style.setProperty("font-weight","bold"),w.style.setProperty("color","#22c55e"),i(w,()=>B.totalQuantity),I.style.setProperty("font-size","0.75rem"),I.style.setProperty("color","#6c757d"),i(I,()=>e("inventory.quantity","Quantity")),y.style.setProperty("text-align","center"),y.style.setProperty("padding","0.5rem"),y.style.setProperty("background","#f8f9fa"),y.style.setProperty("border-radius","var(--border-radius-sm)"),de.style.setProperty("font-weight","bold"),de.style.setProperty("color","#f59e0b"),i(de,()=>u(B.totalValue)),J.style.setProperty("font-size","0.75rem"),J.style.setProperty("color","#6c757d"),i(J,()=>e("common.value","Value")),V})(),(()=>{var V=w$(),f=V.firstChild,g=f.nextSibling;return V.style.setProperty("display","flex"),V.style.setProperty("gap","0.5rem"),f.$$click=S=>{S.stopPropagation(),n(B)},f.style.setProperty("flex","1"),f.style.setProperty("padding","0.5rem"),f.style.setProperty("background","var(--primary-color)"),f.style.setProperty("color","white"),f.style.setProperty("border","none"),f.style.setProperty("border-radius","var(--border-radius-sm)"),f.style.setProperty("cursor","pointer"),f.style.setProperty("font-size","0.875rem"),i(f,()=>e("common.viewDetails","View Details")),g.$$click=S=>{S.stopPropagation(),v(B)},g.style.setProperty("padding","0.5rem"),g.style.setProperty("background","#22c55e"),g.style.setProperty("color","white"),g.style.setProperty("border","none"),g.style.setProperty("border-radius","var(--border-radius-sm)"),g.style.setProperty("cursor","pointer"),g.style.setProperty("font-size","0.875rem"),V})()]}})})),i(_,b(Ae,{get when(){return r()},get children(){return b(rt,{get children(){return[(()=>{var B=p$(),V=B.firstChild,f=V.nextSibling;return f.firstChild,B.style.setProperty("display","flex"),B.style.setProperty("justify-content","space-between"),B.style.setProperty("align-items","center"),B.style.setProperty("margin-bottom","1rem"),i(V,()=>e("inventory.movementDetails","Movement Details")),f.$$click=()=>v(),f.style.setProperty("padding","0.5rem 1rem"),f.style.setProperty("background","#22c55e"),f.style.setProperty("color","white"),f.style.setProperty("border","none"),f.style.setProperty("border-radius","var(--border-radius-sm)"),f.style.setProperty("cursor","pointer"),i(f,()=>e("common.print","Print Report"),null),B})(),(()=>{var B=f$(),V=B.firstChild,f=V.firstChild,g=f.firstChild,S=g.firstChild;g.nextSibling;var $=f.nextSibling,w=$.firstChild,I=w.firstChild;w.nextSibling;var y=$.nextSibling,de=y.firstChild,J=de.firstChild;de.nextSibling;var O=y.nextSibling,N=O.firstChild,q=N.firstChild;N.nextSibling;var D=V.nextSibling,C=D.firstChild,F=C.firstChild,ee=F.firstChild;F.nextSibling;var H=C.nextSibling,oe=H.firstChild,M=oe.firstChild;oe.nextSibling;var G=H.nextSibling,le=G.firstChild,ne=le.firstChild;le.nextSibling;var ue=G.nextSibling,L=ue.firstChild,A=L.firstChild;return L.nextSibling,B.style.setProperty("display","grid"),B.style.setProperty("grid-template-columns","repeat(2, 1fr)"),B.style.setProperty("gap","1rem"),B.style.setProperty("margin-bottom","2rem"),B.style.setProperty("padding","1rem"),B.style.setProperty("background","#f8f9fa"),B.style.setProperty("border-radius","var(--border-radius-sm)"),i(g,()=>e("inventory.referenceNumber","Reference"),S),i(f,()=>r()?.referenceNumber||"N/A",null),i(w,()=>e("inventory.invoiceId","Invoice ID"),I),i($,()=>r()?.invoiceId||"N/A",null),i(de,()=>e("inventory.movementType","Type"),J),i(y,()=>r()?.movementType.toUpperCase(),null),i(N,()=>e("inventory.location","Location"),q),i(O,()=>r()?.locationName,null),i(F,()=>e("common.date","Date"),ee),i(C,(()=>{var U=ge(()=>!!r());return()=>U()?l(r().createDate):""})(),null),i(oe,()=>e("inventory.totalItems","Total Items"),M),i(H,()=>r()?.totalItems,null),i(le,()=>e("inventory.totalQuantity","Total Quantity"),ne),i(G,()=>r()?.totalQuantity,null),i(L,()=>e("common.estimatedValue","Estimated Value"),A),i(ue,(()=>{var U=ge(()=>!!r());return()=>U()?u(r().totalValue):""})(),null),B})(),b(Ae,{get when(){return r()?.description||r()?.generalNotes},get children(){var B=g$();return B.style.setProperty("margin-bottom","2rem"),B.style.setProperty("padding","1rem"),B.style.setProperty("background","#e8f4fd"),B.style.setProperty("border-radius","var(--border-radius-sm)"),i(B,b(Ae,{get when(){return r()?.description},get children(){var V=ec(),f=V.firstChild,g=f.firstChild;return f.nextSibling,i(f,()=>e("common.description","Description"),g),i(V,()=>r()?.description,null),V}}),null),i(B,b(Ae,{get when(){return r()?.generalNotes},get children(){var V=ec(),f=V.firstChild,g=f.firstChild;return f.nextSibling,i(f,()=>e("common.notes","Notes"),g),i(V,()=>r()?.generalNotes,null),V}}),null),B}}),(()=>{var B=v$(),V=B.firstChild,f=V.firstChild,g=f.firstChild,S=g.firstChild,$=S.nextSibling,w=$.nextSibling,I=w.nextSibling,y=I.nextSibling,de=y.nextSibling,J=f.nextSibling;return B.style.setProperty("overflow-x","auto"),V.style.setProperty("width","100%"),V.style.setProperty("border-collapse","collapse"),g.style.setProperty("border-bottom","2px solid #dee2e6"),S.style.setProperty("padding","0.75rem"),S.style.setProperty("text-align","left"),i(S,()=>e("inventory.productCode","Code")),$.style.setProperty("padding","0.75rem"),$.style.setProperty("text-align","left"),i($,()=>e("inventory.productName","Product")),w.style.setProperty("padding","0.75rem"),w.style.setProperty("text-align","center"),i(w,()=>e("inventory.quantity","Quantity")),I.style.setProperty("padding","0.75rem"),I.style.setProperty("text-align","right"),i(I,()=>e("inventory.unitCost","Unit Cost")),y.style.setProperty("padding","0.75rem"),y.style.setProperty("text-align","right"),i(y,()=>e("common.totalValue","Total Value")),de.style.setProperty("padding","0.75rem"),de.style.setProperty("text-align","left"),i(de,()=>e("common.notes","Notes")),i(J,b(ut,{get each(){return r()?.movements||[]},children:O=>{const N=Le.getProductById(O.productId),q=N?.unitCost||0,D=Math.abs(O.quantity||0)*q;return(()=>{var C=C$(),F=C.firstChild,ee=F.nextSibling,H=ee.nextSibling,oe=H.nextSibling,M=oe.nextSibling,G=M.nextSibling;return C.style.setProperty("border-bottom","1px solid #dee2e6"),F.style.setProperty("padding","0.75rem"),F.style.setProperty("font-family","monospace"),i(F,()=>N?.code||O.productId),ee.style.setProperty("padding","0.75rem"),i(ee,()=>N?.name||"Unknown Product"),H.style.setProperty("padding","0.75rem"),H.style.setProperty("text-align","center"),H.style.setProperty("font-weight","bold"),i(H,()=>O.quantity||0),oe.style.setProperty("padding","0.75rem"),oe.style.setProperty("text-align","right"),i(oe,()=>u(q)),M.style.setProperty("padding","0.75rem"),M.style.setProperty("text-align","right"),M.style.setProperty("font-weight","bold"),i(M,()=>u(D)),G.style.setProperty("padding","0.75rem"),G.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","#6c757d"),i(G,()=>O.notes||"-"),X(le=>(le=(O.quantity||0)>=0?"#22c55e":"#ef4444")!=null?H.style.setProperty("color",le):H.style.removeProperty("color")),C})()}})),B})()]}})}}),null),X(()=>P.value=o()),_})()};wt(["click"]);var x$=z("<div><div><div><h2>Bulk Movement Report - </h2><button></button></div><div>");const $$=t=>{const[e,r]=ye(!0),[n,o]=ye(!1),[s,a]=ye([]),[l,u]=ye(""),h=_=>{const x=Le.movements.filter(T=>T.referenceNumber===_||T.invoiceId===_||T.ssg_inventory_key===_);a(x),u(_),r(!1),o(!0)},m=()=>{r(!1),t.onClose()},v=()=>{o(!1),t.onClose()};return[b(Ae,{get when(){return e()},get children(){return b(m$,{get isOpen(){return ge(()=>!!t.isOpen)()&&e()},onClose:m,onMovementComplete:h})}}),b(Ae,{get when(){return n()},get children(){var _=x$(),x=_.firstChild,T=x.firstChild,E=T.firstChild;E.firstChild;var P=E.nextSibling,R=T.nextSibling;return _.style.setProperty("position","fixed"),_.style.setProperty("top","0"),_.style.setProperty("left","0"),_.style.setProperty("right","0"),_.style.setProperty("bottom","0"),_.style.setProperty("background","rgba(0, 0, 0, 0.5)"),_.style.setProperty("z-index","1000"),_.style.setProperty("display","flex"),_.style.setProperty("align-items","center"),_.style.setProperty("justify-content","center"),_.style.setProperty("padding","2rem"),x.style.setProperty("background","white"),x.style.setProperty("border-radius","var(--border-radius)"),x.style.setProperty("width","95%"),x.style.setProperty("max-width","1200px"),x.style.setProperty("max-height","90vh"),x.style.setProperty("overflow-y","auto"),x.style.setProperty("position","relative"),T.style.setProperty("padding","1rem 2rem"),T.style.setProperty("border-bottom","1px solid #e9ecef"),T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),T.style.setProperty("background","#f8f9fa"),E.style.setProperty("margin","0"),i(E,l,null),P.$$click=v,P.style.setProperty("background","none"),P.style.setProperty("border","none"),P.style.setProperty("font-size","1.5rem"),P.style.setProperty("cursor","pointer"),P.style.setProperty("padding","0.5rem"),P.style.setProperty("line-height","1"),R.style.setProperty("padding","1rem"),i(R,b(ng,{get movements(){return s()},onClose:v})),_}})]};wt(["click"]);var A$=z("<div><div></div><div></div><div></div><div>"),I$=z("<div><strong>:</strong> "),E$=z("<div><div><span></span><span></span></div><div><span></span><span> </span></div><div><span></span><span> </span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),T$=z("<div>");const k$=t=>{const{t:e}=ft(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},o={"font-weight":"600",color:"var(--text-primary)"},s={"text-align":"center","margin-bottom":"2rem"},a={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},l={color:"var(--text-muted)","font-size":"1rem"},u={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"1rem"},h=(E,P)=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:E>P?"#d4edda":"#f8d7da",color:E>P?"#155724":"#721c24"}),m={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},v={"margin-bottom":"1.5rem",padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",color:"var(--text-secondary)"};if(!t.item)return null;const _=E=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(E),x=E=>new Date(E).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),T=t.item.price*t.item.quantity;return b(Ar,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.itemDetails")},get children(){return[(()=>{var E=A$(),P=E.firstChild,R=P.nextSibling,Y=R.nextSibling,Z=Y.nextSibling;return d(E,s),d(P,a),i(P,()=>t.item.name),d(R,l),i(R,()=>t.item.category),d(Y,u),i(Y,()=>_(t.item.price)),i(Z,(()=>{var j=ge(()=>t.item.quantity>t.item.minStock);return()=>j()?e("inventory.inStock"):e("inventory.lowStockAlert")})()),X(j=>d(Z,h(t.item.quantity,t.item.minStock),j)),E})(),(()=>{var E=I$(),P=E.firstChild,R=P.firstChild;return P.nextSibling,d(E,v),i(P,()=>e("common.description"),R),i(E,()=>t.item.description,null),E})(),(()=>{var E=E$(),P=E.firstChild,R=P.firstChild,Y=R.nextSibling,Z=P.nextSibling,j=Z.firstChild,B=j.nextSibling,V=B.firstChild,f=Z.nextSibling,g=f.firstChild,S=g.nextSibling,$=S.firstChild,w=f.nextSibling,I=w.firstChild,y=I.nextSibling,de=w.nextSibling,J=de.firstChild,O=J.nextSibling,N=de.nextSibling,q=N.firstChild,D=q.nextSibling,C=N.nextSibling,F=C.firstChild,ee=F.nextSibling;return i(R,()=>e("inventory.sku")),i(Y,()=>t.item.sku),i(j,()=>e("inventory.quantity")),i(B,()=>t.item.quantity,V),i(B,()=>e("common.units"),null),i(g,()=>e("inventory.minimumStock")),i(S,()=>t.item.minStock,$),i(S,()=>e("common.units"),null),i(I,()=>e("inventory.totalValue")),i(y,()=>_(T)),i(J,()=>e("inventory.supplier")),i(O,()=>t.item.supplier),i(q,()=>e("inventory.location")),i(D,()=>t.item.location),i(F,()=>e("common.lastUpdated")),i(ee,()=>x(t.item.lastUpdated)),X(H=>{var oe=r,M=n,G=o,le=r,ne=n,ue=o,L=r,A=n,U=o,te=r,ae=n,re=o,ce=r,Q=n,me=o,K=r,he=n,ve=o,W=r,ie=n,Pe=o;return H.e=d(P,oe,H.e),H.t=d(R,M,H.t),H.a=d(Y,G,H.a),H.o=d(Z,le,H.o),H.i=d(j,ne,H.i),H.n=d(B,ue,H.n),H.s=d(f,L,H.s),H.h=d(g,A,H.h),H.r=d(S,U,H.r),H.d=d(w,te,H.d),H.l=d(I,ae,H.l),H.u=d(y,re,H.u),H.c=d(de,ce,H.c),H.w=d(J,Q,H.w),H.m=d(O,me,H.m),H.f=d(N,K,H.f),H.y=d(q,he,H.y),H.g=d(D,ve,H.g),H.p=d(C,W,H.p),H.b=d(F,ie,H.b),H.T=d(ee,Pe,H.T),H},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),E})(),(()=>{var E=T$();return d(E,m),i(E,b(qe,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),i(E,b(qe,{variant:"primary",onClick:()=>{console.log("Edit item:",t.item.id)},get children(){return e("common.editItem")}}),null),E})()]}})};var R$=z("<div>"),D$=z("<button type=button>"),N$=z("<div> "),Pm=z("<div>"),L$=z("<div><div><input type=text autocomplete=off>"),M$=z("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div>"),O$=z("<span> ");const F$=t=>{const{t:e}=ft(),[r,n]=ye(""),[o,s]=ye(!1),[a,l]=ye(null),[u,h]=ye([]),[m,v]=ye(!1),[_,x]=ye(-1),[T,E]=ye(null),P=t.searchDelay||300;t.maxResults;const R=async oe=>{if(!oe.trim()||oe.trim().length<3){h([]),t.onSearchResults?.([]);return}try{s(!0),l(null);try{console.log("apiResults",oe),t.onSearchResults?.(oe)}catch(M){console.warn("API search failed, using local fallback:",M),l("API search failed, showing local results")}}catch(M){const G=M instanceof Error?M.message:"Search failed";l(G),h([]),t.onSearchResults?.([])}finally{s(!1)}},Y=oe=>{const G=oe.target.value;n(G),l(null),console.log(),t.showResults,T()&&clearTimeout(T());const le=setTimeout(()=>{R(G)},P);E(le)},Z=oe=>{n(oe.name),v(!1),x(-1),t.onInventorySelect?.(oe)},j=oe=>{if(!(!m()||u().length===0))switch(oe.key){case"ArrowDown":oe.preventDefault(),x(M=>Math.min(M+1,u().length-1));break;case"ArrowUp":oe.preventDefault(),x(M=>Math.max(M-1,-1));break;case"Enter":oe.preventDefault(),_()>=0&&u()[_()]&&Z(u()[_()]);break;case"Escape":v(!1),x(-1);break}},B=()=>{t.showResults!==!1&&u().length>0&&v(!0)},V=()=>{setTimeout(()=>{v(!1),x(-1)},150)},f=()=>{n(""),h([]),l(null),v(!1),x(-1),t.onSearchResults?.([]),T()&&(clearTimeout(T()),E(null))},g=oe=>Le.stockLevels.filter(M=>M.inventoryId===oe).reduce((M,G)=>M+G.quantity,0),S=oe=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(oe),$={position:"relative",width:"100%",...t.style},w={position:"relative",display:"flex","align-items":"center"},I={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},y={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},de={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},J={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},O=oe=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:oe?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),N={display:"flex","justify-content":"space-between","align-items":"center"},q={flex:"1"},D={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},C={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},F={"text-align":"right","font-size":"0.875rem"},ee={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},H={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var oe=L$(),M=oe.firstChild,G=M.firstChild;return G.addEventListener("blur",V),G.addEventListener("focus",B),G.$$keydown=j,G.$$input=Y,i(M,b(Ae,{get when(){return o()},get children(){var le=R$();return X(ne=>d(le,de,ne)),le}}),null),i(M,b(Ae,{get when(){return ge(()=>!!r())()&&!o()},get children(){var le=D$();return le.addEventListener("mouseleave",ne=>{ne.currentTarget.style.background="none",ne.currentTarget.style.color="var(--text-muted)"}),le.addEventListener("mouseenter",ne=>{ne.currentTarget.style.background="var(--border-color)",ne.currentTarget.style.color="var(--text-primary)"}),le.$$click=f,X(ne=>{var ue=y,L=e("common.clear","Clear search");return ne.e=d(le,ue,ne.e),L!==ne.t&&ct(le,"title",ne.t=L),ne},{e:void 0,t:void 0}),le}}),null),i(oe,b(Ae,{get when(){return m()&&t.showResults!==!1},get children(){var le=Pm();return i(le,b(Ae,{get when(){return a()},get children(){var ne=N$();return ne.firstChild,d(ne,H),i(ne,a,null),ne}}),null),i(le,b(Ae,{get when(){return u().length>0},get fallback(){return ge(()=>!!(r()&&!o()))()&&(()=>{var ne=Pm();return d(ne,ee),i(ne,()=>e("inventory.noInventorysFound","No inventorys found matching your search.")),ne})()},get children(){return b(ut,{get each(){return u()},children:(ne,ue)=>{const L=g(ne.id),A=L<=ne.minStockLevel;return(()=>{var U=M$(),te=U.firstChild,ae=te.firstChild,re=ae.firstChild,ce=re.nextSibling,Q=ce.firstChild,me=Q.firstChild,K=Q.nextSibling,he=K.nextSibling,ve=he.nextSibling,W=ve.nextSibling,ie=ae.nextSibling,Pe=ie.firstChild,_e=Pe.firstChild,fe=Pe.nextSibling;return U.addEventListener("mouseenter",()=>x(ue())),U.$$click=()=>Z(ne),d(te,N),d(ae,q),d(re,D),i(re,()=>ne.name),d(ce,C),i(Q,()=>e("inventory.sku","SKU"),me),i(Q,()=>ne.sku,null),i(he,()=>ne.category),i(W,()=>S(ne.unitCost)),d(ie,F),Pe.style.setProperty("font-weight","600"),(A?"#f44336":"var(--text-primary)")!=null?Pe.style.setProperty("color",A?"#f44336":"var(--text-primary)"):Pe.style.removeProperty("color"),i(Pe,L,_e),i(Pe,()=>ne.unitOfMeasure,null),fe.style.setProperty("color","var(--text-muted)"),i(fe,()=>A?(()=>{var be=O$();return be.firstChild,be.style.setProperty("color","#f44336"),i(be,()=>e("inventory.lowStock","Low Stock"),null),be})():e("inventory.inStock","In Stock")),X(be=>d(U,O(ue()===_()),be)),U})()}})}}),null),X(ne=>d(le,J,ne)),le}}),null),X(le=>{var ne=$,ue=w,L=I,A=t.placeholder||e("inventory.searchInventorys","Search inventorys by name, SKU, or category..."),U=t.disabled;return le.e=d(oe,ne,le.e),le.t=d(M,ue,le.t),le.a=d(G,L,le.a),A!==le.o&&ct(G,"placeholder",le.o=A),U!==le.i&&(G.disabled=le.i=U),le},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),X(()=>G.value=r()),oe})()};wt(["input","keydown","click"]);var V$=z("<div>"),tc=z("<div><span>:</span><span>"),B$=z("<div><button> "),U$=z("<div><div><div><h3></h3><div>: </div></div><div><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span> <!>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span>");const z$=t=>{const{t:e}=ft(),r=x=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(x),n=x=>new Date(x).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),o=x=>({in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}})[x]||{bg:"#f5f5f5",color:"#666"},s=x=>({in:"",out:"",transfer:"",adjustment:""})[x]||"",a=()=>t.movement,l={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},u={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},h={"font-weight":"600",color:"var(--text-primary)","text-align":"right"},m={"margin-bottom":"1.5rem"},v={"font-weight":"600","margin-bottom":"0.75rem","padding-bottom":"0.5rem","border-bottom":"2px solid var(--border-color)"},_=x=>({display:"inline-flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"600","text-transform":"uppercase","letter-spacing":"0.5px",background:o(x).bg,color:o(x).color});return b(Ar,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.movementDetails")},size:"lg",get children(){return b(Ae,{get when(){return a()},get fallback(){return(()=>{var x=V$();return i(x,()=>e("common.noDataFound")),x})()},children:x=>(()=>{var T=U$(),E=T.firstChild,P=E.firstChild,R=P.firstChild,Y=R.nextSibling,Z=Y.firstChild,j=P.nextSibling,B=j.firstChild,V=E.nextSibling,f=V.firstChild,g=f.nextSibling,S=g.firstChild,$=S.firstChild,w=S.nextSibling,I=g.nextSibling,y=I.firstChild,de=y.firstChild,J=y.nextSibling,O=J.firstChild,N=I.nextSibling,q=N.firstChild,D=q.firstChild,C=q.nextSibling,F=N.nextSibling,ee=F.firstChild,H=ee.firstChild,oe=H.nextSibling;oe.nextSibling;var M=ee.nextSibling,G=V.nextSibling,le=G.firstChild,ne=le.nextSibling,ue=ne.firstChild,L=ue.firstChild,A=ue.nextSibling,U=G.nextSibling,te=U.firstChild,ae=te.nextSibling,re=ae.firstChild,ce=re.firstChild,Q=re.nextSibling,me=ae.nextSibling,K=me.firstChild,he=K.firstChild,ve=K.nextSibling;return E.style.setProperty("display","flex"),E.style.setProperty("justify-content","space-between"),E.style.setProperty("align-items","center"),E.style.setProperty("margin-bottom","1.5rem"),E.style.setProperty("padding-bottom","1rem"),E.style.setProperty("border-bottom","2px solid var(--border-color)"),R.style.setProperty("margin","0 0 0.5rem 0"),R.style.setProperty("font-size","1.25rem"),i(R,()=>x().productName),Y.style.setProperty("font-size","0.875rem"),Y.style.setProperty("color","var(--text-muted)"),i(Y,()=>e("inventory.sku"),Z),i(Y,()=>x().productSku,null),j.$$click=()=>Le.generateMovementInvoice(x().id,e),B.style.setProperty("font-size","1.2rem"),i(B,()=>s(x().movementType)),i(j,()=>x().movementType,null),i(f,()=>e("inventory.movementInformation")),i(S,()=>e("inventory.referenceNumber"),$),i(w,()=>x().referenceNumber),i(y,()=>e("common.quantity"),de),i(J,()=>x().quantity,O),i(J,()=>e("common.units"),null),i(q,()=>e("inventory.unitCost"),D),i(C,()=>r(x().unitCost)),i(ee,()=>e("common.total"),H),i(ee,()=>e("common.value"),oe),i(M,()=>r(x().totalCost)),i(le,()=>e("inventory.locationInformation")),i(ue,()=>e("inventory.location"),L),i(A,()=>x().locationName),i(G,b(Ae,{get when(){return x().fromLocationName},get children(){var W=tc(),ie=W.firstChild,Pe=ie.firstChild,_e=ie.nextSibling;return i(ie,()=>e("common.from"),Pe),i(_e,()=>x().fromLocationName),X(fe=>{var be=l,pe=u,we=h;return fe.e=d(W,be,fe.e),fe.t=d(ie,pe,fe.t),fe.a=d(_e,we,fe.a),fe},{e:void 0,t:void 0,a:void 0}),W}}),null),i(G,b(Ae,{get when(){return x().invoiceId},get children(){var W=tc(),ie=W.firstChild,Pe=ie.firstChild,_e=ie.nextSibling;return i(ie,()=>e("common.invoice"),Pe),i(_e,()=>x().invoiceId),X(fe=>{var be=l,pe=u,we={...h,color:"var(--primary-color)"};return fe.e=d(W,be,fe.e),fe.t=d(ie,pe,fe.t),fe.a=d(_e,we,fe.a),fe},{e:void 0,t:void 0,a:void 0}),W}}),null),i(te,()=>e("common.details")),i(re,()=>e("common.createdBy"),ce),i(Q,()=>x().createdBy),i(K,()=>e("common.created"),he),i(ve,()=>n(x().createdDate)),i(U,b(Ae,{get when(){return x().notes},get children(){var W=tc(),ie=W.firstChild,Pe=ie.firstChild,_e=ie.nextSibling;return i(ie,()=>e("common.notes"),Pe),i(_e,()=>x().notes),X(fe=>{var be={...l,"border-bottom":"none"},pe=u,we={...h,"font-style":"italic","max-width":"60%","white-space":"pre-wrap"};return fe.e=d(W,be,fe.e),fe.t=d(ie,pe,fe.t),fe.a=d(_e,we,fe.a),fe},{e:void 0,t:void 0,a:void 0}),W}}),null),i(T,b(Ae,{get when(){return t.onEdit},get children(){var W=B$(),ie=W.firstChild,Pe=ie.firstChild;return W.style.setProperty("display","flex"),W.style.setProperty("justify-content","flex-end"),W.style.setProperty("margin-top","1.5rem"),W.style.setProperty("padding-top","1rem"),W.style.setProperty("border-top","1px solid var(--border-color)"),ie.addEventListener("mouseleave",_e=>{_e.currentTarget.style.transform="translateY(0)",_e.currentTarget.style.boxShadow="none"}),ie.addEventListener("mouseenter",_e=>{_e.currentTarget.style.transform="translateY(-1px)",_e.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)"}),ie.$$click=()=>t.onEdit?.(x()),ie.style.setProperty("padding","0.5rem 1.5rem"),ie.style.setProperty("border-radius","var(--border-radius-sm)"),ie.style.setProperty("border","1px solid var(--primary-color)"),ie.style.setProperty("background","var(--primary-color)"),ie.style.setProperty("color","white"),ie.style.setProperty("cursor","pointer"),ie.style.setProperty("font-weight","500"),ie.style.setProperty("transition","all 0.2s ease"),i(ie,()=>e("common.edit"),Pe),i(ie,()=>e("inventory.movement"),null),W}}),null),X(W=>{var ie=_(x().movementType),Pe=m,_e=v,fe=l,be=u,pe=h,we=l,De=u,ke={...h,"font-size":"1.1rem",color:"var(--primary-color)"},Te=l,Ue=u,Xe=h,ze=l,$e=u,Ge={...h,"font-size":"1.1rem",color:"var(--primary-color)"},ot=m,je=v,Ce=l,Se=u,Ke=h,He=m,Oe=v,Ye=l,pt=u,vt=h,mt=l,yt=u,Qe=h;return W.e=d(j,ie,W.e),W.t=d(V,Pe,W.t),W.a=d(f,_e,W.a),W.o=d(g,fe,W.o),W.i=d(S,be,W.i),W.n=d(w,pe,W.n),W.s=d(I,we,W.s),W.h=d(y,De,W.h),W.r=d(J,ke,W.r),W.d=d(N,Te,W.d),W.l=d(q,Ue,W.l),W.u=d(C,Xe,W.u),W.c=d(F,ze,W.c),W.w=d(ee,$e,W.w),W.m=d(M,Ge,W.m),W.f=d(G,ot,W.f),W.y=d(le,je,W.y),W.g=d(ne,Ce,W.g),W.p=d(ue,Se,W.p),W.b=d(A,Ke,W.b),W.T=d(U,He,W.T),W.A=d(te,Oe,W.A),W.O=d(ae,Ye,W.O),W.I=d(re,pt,W.I),W.S=d(Q,vt,W.S),W.W=d(me,mt,W.W),W.C=d(K,yt,W.C),W.B=d(ve,Qe,W.B),W},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),T})()})}})};wt(["click"]);var Lo=z("<div>"),j$=z("<div><label></label><select><option value>"),q$=z("<div><div><span>:</span><span>$"),G$=z("<form><div><label></label><select><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><input type=number min=0.01 step=0.01></div><div><label></label><input type=number min=0 step=0.01></div><div><label></label><input type=text></div><div><label> (<!>)</label><input type=text></div><div><label> (<!>)</label><textarea></textarea></div><div><button type=button></button><button type=submit>"),wm=z("<option> (<!>)");const H$=t=>{const{t:e}=ft(),[r,n]=ye("in"),[o,s]=ye(""),[a,l]=ye(""),[u,h]=ye(""),[m,v]=ye(""),[_,x]=ye(""),[T,E]=ye(""),[P,R]=ye(""),[Y,Z]=ye(!1),[j,B]=ye({});fn(()=>{const de=t.movement;de&&t.isOpen&&(n(de.movementType),s(de.quantity.toString()),l(de.unitCost.toString()),h(de.referenceNumber),v(de.notes),E(de.locationId),x(de.fromLocationId||""),R(de.invoiceId||""),B({}))});const V=()=>{const de={};return(!o()||parseFloat(o())<=0)&&(de.quantity=e("forms.requiredField")),(!a()||parseFloat(a())<0)&&(de.unitCost=e("forms.requiredField")),u().trim()||(de.referenceNumber=e("forms.requiredField")),T()||(de.locationId=e("forms.requiredField")),r()==="transfer"&&!_()&&(de.fromLocationId=e("forms.requiredField")),B(de),Object.keys(de).length===0},f=async de=>{if(de.preventDefault(),!(!V()||!t.movement)){Z(!0);try{const J=t.movement,O=Le.getProductById(J.productId),N=Le.getLocationById(T()),q=_()?Le.getLocationById(_()):null;if(!O||!N)throw new Error("Product or location not found");const D={...J,movementType:r(),quantity:parseFloat(o()),unitCost:parseFloat(a()),totalCost:parseFloat(o())*parseFloat(a()),referenceNumber:u().trim(),notes:m().trim(),locationId:T(),locationName:N.name,fromLocationId:_()||void 0,fromLocationName:q?.name,invoiceId:P().trim()||void 0,lastModified:new Date().toISOString()};Le.updateMovement(J.id,D),t.onMovementUpdated?.(),t.onClose(),g()}catch(J){console.error("Error updating movement:",J),B({submit:e("forms.saveError")})}finally{Z(!1)}}},g=()=>{n("in"),s(""),l(""),h(""),v(""),x(""),E(""),R(""),B({})},S=()=>{g(),t.onClose()},$={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",transition:"border-color 0.2s ease"},w={display:"block","margin-bottom":"0.25rem","font-weight":"500","font-size":"0.875rem"},I={color:"#d32f2f","font-size":"0.75rem","margin-top":"0.25rem"},y={"margin-bottom":"1rem"};return b(Ar,{get isOpen(){return t.isOpen},onClose:S,get title(){return e("inventory.editMovement","Edit Movement")},get children(){return b(Ae,{get when(){return t.movement},get fallback(){return(()=>{var de=Lo();return i(de,()=>e("common.loading")),de})()},get children(){var de=G$(),J=de.firstChild,O=J.firstChild,N=O.nextSibling,q=N.firstChild,D=q.nextSibling,C=D.nextSibling,F=C.nextSibling,ee=J.nextSibling,H=ee.firstChild,oe=H.nextSibling,M=oe.firstChild,G=ee.nextSibling,le=G.firstChild,ne=le.nextSibling,ue=G.nextSibling,L=ue.firstChild,A=L.nextSibling,U=ue.nextSibling,te=U.firstChild,ae=te.nextSibling,re=U.nextSibling,ce=re.firstChild,Q=ce.firstChild,me=Q.nextSibling;me.nextSibling;var K=ce.nextSibling,he=re.nextSibling,ve=he.firstChild,W=ve.firstChild,ie=W.nextSibling;ie.nextSibling;var Pe=ve.nextSibling,_e=he.nextSibling,fe=_e.firstChild,be=fe.nextSibling;return de.addEventListener("submit",f),i(O,()=>e("inventory.movementType")),N.addEventListener("change",pe=>n(pe.target.value)),i(q,()=>e("inventory.stockIn")),i(D,()=>e("inventory.stockOut")),i(C,()=>e("inventory.transfer")),i(F,()=>e("inventory.adjustment")),i(H,(()=>{var pe=ge(()=>r()==="transfer");return()=>pe()?e("inventory.toLocation"):e("inventory.location")})()),oe.addEventListener("change",pe=>E(pe.target.value)),i(M,()=>e("modals.selectLocation")),i(oe,b(ut,{get each(){return Le.getActiveLocations()},children:pe=>(()=>{var we=wm(),De=we.firstChild,ke=De.nextSibling;return ke.nextSibling,i(we,()=>pe.name,De),i(we,()=>pe.type,ke),X(()=>we.value=pe.id),we})()}),null),i(ee,b(Ae,{get when(){return j().locationId},get children(){var pe=Lo();return i(pe,()=>j().locationId),X(we=>d(pe,I,we)),pe}}),null),i(de,b(Ae,{get when(){return r()==="transfer"},get children(){var pe=j$(),we=pe.firstChild,De=we.nextSibling,ke=De.firstChild;return i(we,()=>e("inventory.fromLocation")),De.addEventListener("change",Te=>x(Te.target.value)),i(ke,()=>e("modals.selectLocation")),i(De,b(ut,{get each(){return Le.getActiveLocations().filter(Te=>Te.id!==T())},children:Te=>(()=>{var Ue=wm(),Xe=Ue.firstChild,ze=Xe.nextSibling;return ze.nextSibling,i(Ue,()=>Te.name,Xe),i(Ue,()=>Te.type,ze),X(()=>Ue.value=Te.id),Ue})()}),null),i(pe,b(Ae,{get when(){return j().fromLocationId},get children(){var Te=Lo();return i(Te,()=>j().fromLocationId),X(Ue=>d(Te,I,Ue)),Te}}),null),X(Te=>{var Ue=y,Xe=w,ze={...$,"border-color":j().fromLocationId?"#d32f2f":"var(--border-color)"},$e=Y();return Te.e=d(pe,Ue,Te.e),Te.t=d(we,Xe,Te.t),Te.a=d(De,ze,Te.a),$e!==Te.o&&(De.disabled=Te.o=$e),Te},{e:void 0,t:void 0,a:void 0,o:void 0}),X(()=>De.value=_()),pe}}),G),i(le,()=>e("common.quantity")),ne.$$input=pe=>s(pe.target.value),i(G,b(Ae,{get when(){return j().quantity},get children(){var pe=Lo();return i(pe,()=>j().quantity),X(we=>d(pe,I,we)),pe}}),null),i(L,()=>e("inventory.unitCost")),A.$$input=pe=>l(pe.target.value),i(ue,b(Ae,{get when(){return j().unitCost},get children(){var pe=Lo();return i(pe,()=>j().unitCost),X(we=>d(pe,I,we)),pe}}),null),i(de,b(Ae,{get when(){return ge(()=>!!o())()&&a()},get children(){var pe=q$(),we=pe.firstChild,De=we.firstChild,ke=De.firstChild,Te=De.nextSibling;return Te.firstChild,we.style.setProperty("display","flex"),we.style.setProperty("justify-content","space-between"),De.style.setProperty("font-weight","500"),i(De,()=>e("common.total"),ke),Te.style.setProperty("font-weight","600"),Te.style.setProperty("color","var(--primary-color)"),i(Te,()=>(parseFloat(o()||"0")*parseFloat(a()||"0")).toFixed(2),null),X(Ue=>d(pe,{...y,padding:"0.75rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)"},Ue)),pe}}),U),i(te,()=>e("inventory.referenceNumber")),ae.$$input=pe=>h(pe.target.value),i(U,b(Ae,{get when(){return j().referenceNumber},get children(){var pe=Lo();return i(pe,()=>j().referenceNumber),X(we=>d(pe,I,we)),pe}}),null),i(ce,()=>e("inventory.invoiceNumber"),Q),i(ce,()=>e("common.optional"),me),K.$$input=pe=>R(pe.target.value),i(ve,()=>e("common.notes"),W),i(ve,()=>e("common.optional"),ie),Pe.$$input=pe=>v(pe.target.value),i(de,b(Ae,{get when(){return j().submit},get children(){var pe=Lo();return i(pe,()=>j().submit),X(we=>d(pe,{...I,"margin-bottom":"1rem"},we)),pe}}),_e),_e.style.setProperty("display","flex"),_e.style.setProperty("gap","1rem"),_e.style.setProperty("justify-content","flex-end"),fe.$$click=S,fe.style.setProperty("padding","0.5rem 1rem"),fe.style.setProperty("border","1px solid var(--border-color)"),fe.style.setProperty("border-radius","var(--border-radius-sm)"),fe.style.setProperty("background","white"),fe.style.setProperty("cursor","pointer"),i(fe,()=>e("common.cancel")),be.style.setProperty("padding","0.5rem 1rem"),be.style.setProperty("border","none"),be.style.setProperty("border-radius","var(--border-radius-sm)"),be.style.setProperty("background","var(--primary-color)"),be.style.setProperty("color","white"),be.style.setProperty("cursor","pointer"),be.style.setProperty("font-weight","500"),i(be,(()=>{var pe=ge(()=>!!Y());return()=>pe()?e("modals.processing"):e("inventory.updateMovement","Update Movement")})()),X(pe=>{var we=y,De=w,ke=$,Te=Y(),Ue=y,Xe=w,ze={...$,"border-color":j().locationId?"#d32f2f":"var(--border-color)"},$e=Y(),Ge=y,ot=w,je={...$,"border-color":j().quantity?"#d32f2f":"var(--border-color)"},Ce=e("modals.enterQuantity"),Se=Y(),Ke=y,He=w,Oe={...$,"border-color":j().unitCost?"#d32f2f":"var(--border-color)"},Ye=e("modals.enterCost"),pt=Y(),vt=y,mt=w,yt={...$,"border-color":j().referenceNumber?"#d32f2f":"var(--border-color)"},Qe=e("modals.enterReference"),Ct=Y(),_t=y,jt=w,Mt=$,Be=e("inventory.invoiceNumber"),We=Y(),at=y,lt=w,Tt={...$,resize:"vertical","min-height":"80px"},Ie=e("modals.addNotes"),Ve=Y(),st=Y(),dt=Y();return pe.e=d(J,we,pe.e),pe.t=d(O,De,pe.t),pe.a=d(N,ke,pe.a),Te!==pe.o&&(N.disabled=pe.o=Te),pe.i=d(ee,Ue,pe.i),pe.n=d(H,Xe,pe.n),pe.s=d(oe,ze,pe.s),$e!==pe.h&&(oe.disabled=pe.h=$e),pe.r=d(G,Ge,pe.r),pe.d=d(le,ot,pe.d),pe.l=d(ne,je,pe.l),Ce!==pe.u&&ct(ne,"placeholder",pe.u=Ce),Se!==pe.c&&(ne.disabled=pe.c=Se),pe.w=d(ue,Ke,pe.w),pe.m=d(L,He,pe.m),pe.f=d(A,Oe,pe.f),Ye!==pe.y&&ct(A,"placeholder",pe.y=Ye),pt!==pe.g&&(A.disabled=pe.g=pt),pe.p=d(U,vt,pe.p),pe.b=d(te,mt,pe.b),pe.T=d(ae,yt,pe.T),Qe!==pe.A&&ct(ae,"placeholder",pe.A=Qe),Ct!==pe.O&&(ae.disabled=pe.O=Ct),pe.I=d(re,_t,pe.I),pe.S=d(ce,jt,pe.S),pe.W=d(K,Mt,pe.W),Be!==pe.C&&ct(K,"placeholder",pe.C=Be),We!==pe.B&&(K.disabled=pe.B=We),pe.v=d(he,at,pe.v),pe.k=d(ve,lt,pe.k),pe.x=d(Pe,Tt,pe.x),Ie!==pe.j&&ct(Pe,"placeholder",pe.j=Ie),Ve!==pe.q&&(Pe.disabled=pe.q=Ve),st!==pe.z&&(fe.disabled=pe.z=st),dt!==pe.P&&(be.disabled=pe.P=dt),pe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0,x:void 0,j:void 0,q:void 0,z:void 0,P:void 0}),X(()=>N.value=r()),X(()=>oe.value=T()),X(()=>ne.value=o()),X(()=>A.value=a()),X(()=>ae.value=u()),X(()=>K.value=P()),X(()=>Pe.value=m()),de}})}})};wt(["input","click"]);var W$=z("<div><div></div><div><div><label></label><select><option value=all></option><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),Y$=z("<div><h2>"),K$=z("<div><label>"),Q$=z("<div><label></label><select><option value>"),J$=z("<option>"),X$=z("<div><div></div><div></div><div>"),Z$=z("<div><div><div><div><span></span><h3></h3><span></span></div><div>  </div></div><div><div></div><div> <!> @ </div></div></div><div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div><span>:</span><span>"),eA=z("<span>"),tA=z("<span> <!>: "),Cm=z("<div><span>:</span><span>"),rA=z("<div><div><span>:</span><select><option value=10>10</option><option value=25>25</option><option value=50>50</option><option value=100>100</option></select><span></span></div><div><div><span>:</span><input type=number min=1><span> "),nA=z("<span>..."),oA=z("<button>");const iA=t=>{const{t:e}=ft(),[r,n]=ye(""),[o,s]=ye(""),[a,l]=ye("all"),[u,h]=ye({start:"",end:""}),[m,v]=ye(""),[_,x]=ye(""),[T,E]=ye(1),[P,R]=ye(25),[Y,Z]=ye(null),[j,B]=ye(!1),[V,f]=ye(!1),g=Ze(()=>{let K=Le.movements;if(t.filterBy==="product"&&t.filterId?K=K.filter(he=>he.productId===t.filterId):t.filterBy==="location"&&t.filterId&&(K=K.filter(he=>he.locationId===t.filterId)),r()&&(K=K.filter(he=>he.productId===r())),o()&&(K=K.filter(he=>he.locationId===o())),a()!=="all"&&(K=K.filter(he=>he.movementType===a())),u().start&&(K=K.filter(he=>he.createdDate>=u().start)),u().end&&(K=K.filter(he=>he.createdDate<=u().end+"T23:59:59Z")),m()){const he=m().toLowerCase();K=K.filter(ve=>ve.productName.toLowerCase().includes(he)||ve.productSku.toLowerCase().includes(he)||ve.locationName.toLowerCase().includes(he)||ve.referenceNumber.toLowerCase().includes(he)||ve.notes.toLowerCase().includes(he)||ve.createdBy.toLowerCase().includes(he)||ve.invoiceId&&ve.invoiceId.toLowerCase().includes(he)||ve.fromLocationName&&ve.fromLocationName.toLowerCase().includes(he)||ve.movementType.toLowerCase().includes(he))}return K.sort((he,ve)=>new Date(ve.createdDate).getTime()-new Date(he.createdDate).getTime())});fn(()=>{r(),o(),a(),u(),m(),E(1)});const S=Ze(()=>{const K=(T()-1)*P(),he=K+P();return g().slice(K,he)}),$=Ze(()=>Math.ceil(g().length/P())),w=Ze(()=>{const K=g();return{total:K.length,stockIn:K.filter(he=>he.movementType==="in").length,stockOut:K.filter(he=>he.movementType==="out").length,transfers:K.filter(he=>he.movementType==="transfer").length,adjustments:K.filter(he=>he.movementType==="adjustment").length,totalValue:K.reduce((he,ve)=>he+ve.totalCost,0)}}),I={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},y={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},de={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)",cursor:"pointer"},J={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},O={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem","margin-bottom":"2rem"},N={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","text-align":"center"},q={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},D={"font-size":"0.875rem",color:"var(--text-muted)","font-weight":"500"},C={padding:"1.5rem","margin-bottom":"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",transition:"all 0.2s ease"},F={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"1rem"};function ee(K){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[K]||{bg:"#f5f5f5",color:"#666"}}const H=K=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:ee(K).bg,color:ee(K).color}),oe={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"1rem"},M={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.5rem 0","border-bottom":"1px solid var(--border-color)"},G={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},le={"font-weight":"600",color:"var(--text-primary)"},ne={display:"flex","justify-content":"space-between","align-items":"center","margin-top":"2rem",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},ue=K=>({padding:"0.25rem 0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:K?"var(--primary-color)":"var(--surface-color)",color:K?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),L=K=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(K),A=K=>new Date(K).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),U=K=>({in:"",out:"",transfer:"",adjustment:""})[K]||"",te=()=>{n(""),s(""),l("all"),h({start:"",end:""}),v(""),E(1)},ae=K=>{Z(K),B(!0)},re=K=>{Z(K),B(!1),f(!0)},ce=()=>{f(!1),Z(null)},Q=async K=>{o()&&(K+=" "+o()),_c(a())&&(K+=" "+_c(a()));const he=await Jr.getInventory(K),ve=Le.parseInventoryData(he);Le.updMovements(ve)},me=()=>{};return(()=>{var K=W$(),he=K.firstChild,ve=he.nextSibling,W=ve.firstChild,ie=W.firstChild,Pe=ie.nextSibling,_e=Pe.firstChild,fe=_e.nextSibling,be=fe.nextSibling,pe=be.nextSibling,we=pe.nextSibling,De=W.nextSibling,ke=De.firstChild,Te=ke.nextSibling,Ue=De.nextSibling,Xe=Ue.firstChild,ze=Xe.nextSibling,$e=ve.nextSibling,Ge=$e.firstChild,ot=Ge.firstChild,je=ot.nextSibling,Ce=Ge.nextSibling,Se=Ce.firstChild,Ke=Se.nextSibling,He=Ce.nextSibling,Oe=He.firstChild,Ye=Oe.nextSibling,pt=He.nextSibling,vt=pt.firstChild,mt=vt.nextSibling,yt=pt.nextSibling,Qe=yt.firstChild,Ct=Qe.nextSibling,_t=yt.nextSibling,jt=_t.firstChild,Mt=jt.nextSibling;return i(K,(()=>{var Be=ge(()=>!t.filterBy);return()=>Be()&&(()=>{var We=Y$(),at=We.firstChild;return d(We,I),at.style.setProperty("margin","0"),at.style.setProperty("font-size","1.5rem"),i(at,()=>e("inventory.movements")),i(We,b(qe,{variant:"outline",onClick:te,get children(){return e("common.clearFilters")}}),null),We})()})(),he),i(K,b(F$,{filters:{selectedLocation:o,movementType:a},onSearchResults:Be=>{x(Be),Q(Be)},get placeholder(){return e("inventory.searchProductsStock","Search inventories...")},showResults:!1,maxResults:20}),he),he.style.setProperty("margin","20px"),d(ve,y),i(ve,(()=>{var Be=ge(()=>!t.filterBy);return()=>Be()&&[(()=>{var We=K$(),at=We.firstChild;return at.style.setProperty("display","block"),at.style.setProperty("margin-bottom","0.5rem"),at.style.setProperty("font-weight","500"),i(at,()=>e("inventory.product")),i(We,b(_l,{onChange:lt=>{console.log(lt),n(lt.id)},get placeholder(){return e("inventory.searchProductsImages","Search products to view images...")}}),null),We})(),(()=>{var We=Q$(),at=We.firstChild,lt=at.nextSibling,Tt=lt.firstChild;return at.style.setProperty("display","block"),at.style.setProperty("margin-bottom","0.5rem"),at.style.setProperty("font-weight","500"),i(at,()=>e("inventory.location")),lt.addEventListener("change",Ie=>s(Ie.target.value)),i(Tt,()=>e("inventory.allLocations")),i(lt,b(ut,{get each(){return Le.locations},children:Ie=>(()=>{var Ve=J$();return i(Ve,()=>Ie.name),X(()=>Ve.value=Ie.id),Ve})()}),null),X(Ie=>d(lt,de,Ie)),X(()=>lt.value=o()),We})()]})(),W),ie.style.setProperty("display","block"),ie.style.setProperty("margin-bottom","0.5rem"),ie.style.setProperty("font-weight","500"),i(ie,()=>e("inventory.movementType")),Pe.addEventListener("change",Be=>{l(Be.target.value),Q(_())}),i(_e,()=>e("inventory.allTypes")),i(fe,()=>e("inventory.stockIn")),i(be,()=>e("inventory.stockOut")),i(pe,()=>e("inventory.transfer")),i(we,()=>e("inventory.adjustment")),ke.style.setProperty("display","block"),ke.style.setProperty("margin-bottom","0.5rem"),ke.style.setProperty("font-weight","500"),i(ke,()=>e("common.startDate")),Te.addEventListener("change",Be=>h(We=>({...We,start:Be.target.value}))),Xe.style.setProperty("display","block"),Xe.style.setProperty("margin-bottom","0.5rem"),Xe.style.setProperty("font-weight","500"),i(Xe,()=>e("common.endDate")),ze.addEventListener("change",Be=>h(We=>({...We,end:Be.target.value}))),d($e,O),i(ot,()=>w().total),i(je,()=>e("inventory.totalMovements")),i(Se,()=>w().stockIn),i(Ke,()=>e("inventory.stockIn")),i(Oe,()=>w().stockOut),i(Ye,()=>e("inventory.stockOut")),i(vt,()=>w().transfers),i(mt,()=>e("inventory.transfers")),i(Qe,()=>w().adjustments),i(Ct,()=>e("inventory.adjustments")),jt.$$click=me,i(jt,()=>L(w().totalValue)),i(Mt,()=>e("inventory.totalValue")),i(K,(()=>{var Be=ge(()=>S().length===0);return()=>Be()?(()=>{var We=X$(),at=We.firstChild,lt=at.nextSibling,Tt=lt.nextSibling;return We.style.setProperty("text-align","center"),We.style.setProperty("padding","3rem"),We.style.setProperty("color","var(--text-muted)"),We.style.setProperty("background","var(--surface-color)"),We.style.setProperty("border-radius","var(--border-radius)"),We.style.setProperty("border","1px solid var(--border-color)"),at.style.setProperty("font-size","1.5rem"),at.style.setProperty("margin-bottom","1rem"),lt.style.setProperty("font-size","1.1rem"),lt.style.setProperty("margin-bottom","0.5rem"),i(lt,()=>e("inventory.noMovementsFound")),Tt.style.setProperty("font-size","0.875rem"),i(Tt,()=>e("inventory.tryAdjustingFilters")),We})():[b(ut,{get each(){return S()},children:We=>(()=>{var at=Z$(),lt=at.firstChild,Tt=lt.firstChild,Ie=Tt.firstChild,Ve=Ie.firstChild,st=Ve.nextSibling,dt=st.nextSibling,Gt=Ie.nextSibling,Wt=Gt.firstChild,At=Tt.nextSibling,kt=At.firstChild,rr=kt.nextSibling,Et=rr.firstChild,er=Et.nextSibling;er.nextSibling;var et=lt.nextSibling,Rt=et.firstChild,Ot=Rt.firstChild,Vt=Ot.firstChild,Ht=Vt.firstChild,nr=Vt.nextSibling,cr=Ot.nextSibling,It=cr.firstChild,hr=It.firstChild,Hr=It.nextSibling,Ir=Rt.nextSibling,Cr=Ir.firstChild,Mr=Cr.firstChild,gn=Mr.firstChild,to=Mr.nextSibling;return at.addEventListener("mouseleave",xt=>{xt.currentTarget.style.transform="translateY(0)",xt.currentTarget.style.boxShadow="none"}),at.addEventListener("mouseenter",xt=>{xt.currentTarget.style.transform="translateY(-2px)",xt.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),at.$$click=()=>ae(We),d(lt,F),Ie.style.setProperty("display","flex"),Ie.style.setProperty("align-items","center"),Ie.style.setProperty("gap","0.5rem"),Ie.style.setProperty("margin-bottom","0.5rem"),Ve.style.setProperty("font-size","1.2rem"),i(Ve,()=>U(We.movementType)),st.style.setProperty("margin","0"),st.style.setProperty("font-size","1.1rem"),i(st,()=>We.productName),i(dt,()=>We.movementType),i(Ie,(()=>{var xt=ge(()=>!!We.invoiceId);return()=>xt()&&(()=>{var Ne=eA();return Ne.style.setProperty("padding","0.2rem 0.5rem"),Ne.style.setProperty("border-radius","var(--border-radius-sm)"),Ne.style.setProperty("font-size","0.7rem"),Ne.style.setProperty("font-weight","500"),Ne.style.setProperty("background","var(--primary-color)"),Ne.style.setProperty("color","white"),i(Ne,()=>e("inventory.bulk")),Ne})()})(),null),Gt.style.setProperty("font-size","0.875rem"),Gt.style.setProperty("color","var(--text-muted)"),i(Gt,()=>We.productSku,Wt),i(Gt,()=>A(We.createdDate),null),i(Gt,(()=>{var xt=ge(()=>!!We.invoiceId);return()=>xt()&&(()=>{var Ne=tA(),Dt=Ne.firstChild,ar=Dt.nextSibling;return ar.nextSibling,Ne.style.setProperty("margin-left","0.5rem"),Ne.style.setProperty("font-weight","500"),i(Ne,()=>e("common.invoice"),ar),i(Ne,()=>We.invoiceId,null),Ne})()})(),null),At.style.setProperty("text-align","right"),kt.style.setProperty("font-size","1.25rem"),kt.style.setProperty("font-weight","700"),kt.style.setProperty("color","var(--primary-color)"),i(kt,()=>L(We.totalCost)),rr.style.setProperty("font-size","0.875rem"),rr.style.setProperty("color","var(--text-muted)"),i(rr,()=>We.quantity,Et),i(rr,()=>e("common.units"),er),i(rr,()=>L(We.unitCost),null),d(et,oe),i(Vt,()=>e("inventory.location"),Ht),i(nr,()=>We.locationName),i(Rt,(()=>{var xt=ge(()=>!!We.fromLocationName);return()=>xt()&&(()=>{var Ne=Cm(),Dt=Ne.firstChild,ar=Dt.firstChild,Yt=Dt.nextSibling;return i(Dt,()=>e("common.from"),ar),i(Yt,()=>We.fromLocationName),X(bt=>{var dr=M,yr=G,Wr=le;return bt.e=d(Ne,dr,bt.e),bt.t=d(Dt,yr,bt.t),bt.a=d(Yt,Wr,bt.a),bt},{e:void 0,t:void 0,a:void 0}),Ne})()})(),cr),i(It,()=>e("common.reference"),hr),i(Hr,()=>We.referenceNumber),i(Mr,()=>e("common.createdBy"),gn),i(to,()=>We.createdBy),i(Ir,(()=>{var xt=ge(()=>!!We.notes);return()=>xt()&&(()=>{var Ne=Cm(),Dt=Ne.firstChild,ar=Dt.firstChild,Yt=Dt.nextSibling;return i(Dt,()=>e("common.notes"),ar),i(Yt,()=>We.notes),X(bt=>{var dr={...M,"border-bottom":"none"},yr=G,Wr={...le,"max-width":"200px","text-align":"right","font-style":"italic"};return bt.e=d(Ne,dr,bt.e),bt.t=d(Dt,yr,bt.t),bt.a=d(Yt,Wr,bt.a),bt},{e:void 0,t:void 0,a:void 0}),Ne})()})(),null),X(xt=>{var Ne={...C,"border-left":We.invoiceId?"4px solid var(--primary-color)":"1px solid var(--border-color)",cursor:"pointer"},Dt=H(We.movementType),ar=M,Yt=G,bt=le,dr=M,yr=G,Wr=le,Nt=M,ln=G,Yr=le;return xt.e=d(at,Ne,xt.e),xt.t=d(dt,Dt,xt.t),xt.a=d(Ot,ar,xt.a),xt.o=d(Vt,Yt,xt.o),xt.i=d(nr,bt,xt.i),xt.n=d(cr,dr,xt.n),xt.s=d(It,yr,xt.s),xt.h=d(Hr,Wr,xt.h),xt.r=d(Cr,Nt,xt.r),xt.d=d(Mr,ln,xt.d),xt.l=d(to,Yr,xt.l),xt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),at})()}),ge(()=>ge(()=>$()>1)()&&(()=>{var We=rA(),at=We.firstChild,lt=at.firstChild,Tt=lt.firstChild,Ie=lt.nextSibling,Ve=Ie.nextSibling,st=at.nextSibling,dt=st.firstChild,Gt=dt.firstChild,Wt=Gt.firstChild,At=Gt.nextSibling,kt=At.nextSibling,rr=kt.firstChild;return d(We,ne),at.style.setProperty("display","flex"),at.style.setProperty("align-items","center"),at.style.setProperty("gap","0.5rem"),lt.style.setProperty("font-size","0.875rem"),lt.style.setProperty("color","var(--text-muted)"),i(lt,()=>e("common.showPerPage","Show per page"),Tt),Ie.addEventListener("change",Et=>{R(Number(Et.target.value)),E(1)}),Ie.style.setProperty("padding","0.25rem 0.5rem"),Ie.style.setProperty("border","1px solid var(--border-color)"),Ie.style.setProperty("border-radius","var(--border-radius-sm)"),Ie.style.setProperty("background","var(--surface-color)"),Ie.style.setProperty("cursor","pointer"),Ie.style.setProperty("font-size","0.875rem"),Ve.style.setProperty("font-size","0.875rem"),Ve.style.setProperty("color","var(--text-muted)"),Ve.style.setProperty("margin-left","1rem"),i(Ve,()=>e("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:(T()-1)*P()+1,end:Math.min(T()*P(),g().length),total:g().length})),st.style.setProperty("display","flex"),st.style.setProperty("align-items","center"),st.style.setProperty("gap","0.5rem"),i(st,b(qe,{variant:"outline",size:"sm",onClick:()=>E(1),get disabled(){return T()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.first","First")}}),dt),i(st,b(qe,{variant:"outline",size:"sm",onClick:()=>E(Et=>Math.max(1,Et-1)),get disabled(){return T()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.previous")}}),dt),i(st,()=>{const Et=[],er=$(),et=T();if(er<=7)for(let Rt=1;Rt<=er;Rt++)Et.push(Rt);else{Et.push(1),et>3&&Et.push("...");for(let Rt=Math.max(2,et-1);Rt<=Math.min(er-1,et+1);Rt++)Et.includes(Rt)||Et.push(Rt);et<er-2&&Et.push("..."),Et.includes(er)||Et.push(er)}return b(ut,{each:Et,children:Rt=>Rt==="..."?(()=>{var Ot=nA();return Ot.style.setProperty("padding","0 0.5rem"),Ot.style.setProperty("color","var(--text-muted)"),Ot})():(()=>{var Ot=oA();return Ot.$$click=()=>E(Rt),i(Ot,Rt),X(Vt=>d(Ot,ue(Rt===T()),Vt)),Ot})()})},dt),i(st,b(qe,{variant:"outline",size:"sm",onClick:()=>E(Et=>Math.min($(),Et+1)),get disabled(){return T()===$()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.next")}}),dt),i(st,b(qe,{variant:"outline",size:"sm",onClick:()=>E($()),get disabled(){return T()===$()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.last","Last")}}),dt),dt.style.setProperty("display","flex"),dt.style.setProperty("align-items","center"),dt.style.setProperty("gap","0.5rem"),dt.style.setProperty("margin-left","1rem"),Gt.style.setProperty("font-size","0.875rem"),Gt.style.setProperty("color","var(--text-muted)"),i(Gt,()=>e("common.page","Page"),Wt),At.addEventListener("change",Et=>{const er=Number(Et.target.value);er>=1&&er<=$()&&E(er)}),At.style.setProperty("width","4rem"),At.style.setProperty("padding","0.25rem 0.5rem"),At.style.setProperty("border","1px solid var(--border-color)"),At.style.setProperty("border-radius","var(--border-radius-sm)"),At.style.setProperty("background","var(--surface-color)"),At.style.setProperty("text-align","center"),At.style.setProperty("font-size","0.875rem"),kt.style.setProperty("font-size","0.875rem"),kt.style.setProperty("color","var(--text-muted)"),i(kt,()=>e("common.of","of"),rr),i(kt,$,null),X(()=>ct(At,"max",$())),X(()=>Ie.value=P()),X(()=>At.value=T()),We})())]})(),null),i(K,b(z$,{get isOpen(){return j()},onClose:()=>{B(!1),Z(null)},get movement(){return Y()},onEdit:re}),null),i(K,b(Ae,{get when(){return Lt.hasPermission("read_write")},get children(){return b(H$,{get isOpen(){return V()},onClose:()=>{f(!1),Z(null)},get movement(){return Y()},onMovementUpdated:ce})}}),null),X(Be=>{var We=de,at=J,lt=J,Tt=N,Ie=q,Ve=D,st=N,dt={...q,color:"#2d7d32"},Gt=D,Wt=N,At={...q,color:"#d32f2f"},kt=D,rr=N,Et={...q,color:"#1976d2"},er=D,et=N,Rt={...q,color:"#f57c00"},Ot=D,Vt=N,Ht=q,nr=D;return Be.e=d(Pe,We,Be.e),Be.t=d(Te,at,Be.t),Be.a=d(ze,lt,Be.a),Be.o=d(Ge,Tt,Be.o),Be.i=d(ot,Ie,Be.i),Be.n=d(je,Ve,Be.n),Be.s=d(Ce,st,Be.s),Be.h=d(Se,dt,Be.h),Be.r=d(Ke,Gt,Be.r),Be.d=d(He,Wt,Be.d),Be.l=d(Oe,At,Be.l),Be.u=d(Ye,kt,Be.u),Be.c=d(pt,rr,Be.c),Be.w=d(vt,Et,Be.w),Be.m=d(mt,er,Be.m),Be.f=d(yt,et,Be.f),Be.y=d(Qe,Rt,Be.y),Be.g=d(Ct,Ot,Be.g),Be.p=d(_t,Vt,Be.p),Be.b=d(jt,Ht,Be.b),Be.T=d(Mt,nr,Be.T),Be},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),X(()=>Pe.value=a()),X(()=>Te.value=u().start),X(()=>ze.value=u().end),K})()};wt(["click"]);var sA=z("<div><p> "),aA=z("<div>"),lA=z("<div><div></div><h3></h3><p></p><div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=name></option><option value=sku></option><option value=category>"),cA=z("<div><div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div>%</div><div></div></div></div><div></div><div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),dA=z("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),uA=z("<div><div></div><h3></h3><p>"),hA=z("<div><div><h3> </h3><p></p></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div></div><div>"),mA=z("<div><div><div><h2> </h2><button>"),xm=z("<option>"),yA=z("<div>..."),pA=z("<tr><td><div></div><div>  </div></td><td><div></div></td><td><div></div></td><td><div></div></td><td><div>"),fA=z("<tr><td><div></div></td><td><div></div><div>  <!>  </div></td><td><div></div></td><td><input type=number placeholder=0 min=0 step=0.01></td><td><div></div></td><td><input type=text>");const gA=t=>{const{t:e}=ft(),[r,n]=ye([]),[o,s]=ye(!1),[a,l]=ye(!1),[u,h]=ye("all"),[m,v]=ye("all"),[_,x]=ye("name"),[T,E]=ye([]),[P,R]=ye("setup"),Y=async()=>{try{s(!0);const D=await Jr.getProducts("prod");if(!D||typeof D!="object"){console.warn("No API results, using local store"),n(Le.products);return}const C=Object.keys(D),F=H=>{let M=D[H];return{id:H,name:M.name||"Unknown Product",businessId:M.businessId||"",sku:M.code||M.sku||"",UPC:M.UPC||"",numCode:M.codeN||"",category:M.category||"General",unitCost:M.unitCost||0,unitOfMeasure:M.unitOfMeasure||"pcs",minStockLevel:M.minStockLevel||0,maxStockLevel:M.maxStockLevel||100,isActive:M.isActive!==!1,description:M.description||"",createdDate:M.createdAt||new Date().toISOString(),lastModified:M.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(M.sellingPrice||M.price||"0")}},ee=C.map(F);n(ee)}catch(D){console.error("Failed to load products from API:",D),n(Le.products)}finally{s(!1)}},Z=Ze(()=>[...new Set(r().map(C=>C.category).filter(C=>C))].sort()),j=Ze(()=>{let D=r().filter(C=>C.isActive);return m()!=="all"&&(D=D.filter(C=>C.category===m())),D.sort((C,F)=>{switch(_()){case"name":return C.name.localeCompare(F.name);case"sku":return C.sku.localeCompare(F.sku);case"category":return C.category.localeCompare(F.category)||C.name.localeCompare(F.name);default:return 0}}),D}),B=Ze(()=>Le.getActiveLocations()),V=(D,C)=>C&&C!=="all"?Le.getStockByProductAndLocation(D,C)?.quantity||0:Le.getTotalStockByProduct(D),f=()=>{const D=j().map(C=>{const F=V(C.id,u()!=="all"?u():void 0);return{productId:C.id,systemQuantity:F,physicalCount:null,notes:"",variance:0,product:C}});E(D),R("counting")},g=(D,C)=>{E(F=>F.map(ee=>{if(ee.productId===D){const H=C,oe=H!==null?H-ee.systemQuantity:0;return{...ee,physicalCount:H,variance:oe}}return ee}))},S=(D,C)=>{E(F=>F.map(ee=>ee.productId===D?{...ee,notes:C}:ee))},$=Ze(()=>{const D=T(),C=D.length,F=D.filter(M=>M.physicalCount!==null).length,ee=D.filter(M=>M.variance!==0).length,H=D.filter(M=>M.variance>0).length,oe=D.filter(M=>M.variance<0).length;return{totalProducts:C,countedProducts:F,remainingProducts:C-F,variances:ee,positiveVariances:H,negativeVariances:oe,isComplete:F===C}}),w=()=>{const D=T().filter(H=>H.physicalCount!==null&&H.variance!==0);if(D.length===0)return null;const C=[e("inventory.product","Product"),e("inventory.sku","SKU"),e("inventory.category","Category"),e("inventory.location","Location"),e("inventory.systemQty","System Qty"),e("inventory.physicalCount","Physical Count"),e("inventory.variance","Variance"),e("inventory.adjustment","Adjustment"),e("common.notes","Notes"),e("common.date","Date")],F=D.map(H=>[`"${H.product.name}"`,`"${H.product.sku}"`,`"${H.product.category}"`,`"${de()}"`,H.systemQuantity,H.physicalCount,H.variance,H.variance>0?e("inventory.stockIncrease","Stock Increase"):e("inventory.stockDecrease","Stock Decrease"),`"${H.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")}"`,`"${J()}"`]);return[C.join(","),...F.map(H=>H.join(","))].join(`
`)},I=()=>{const D=w();if(!D){alert(e("inventory.noAdjustmentsToDownload","No adjustments to download"));return}const C=new Blob([D],{type:"text/csv;charset=utf-8;"}),F=document.createElement("a");if(F.download!==void 0){const ee=URL.createObjectURL(C);F.setAttribute("href",ee),F.setAttribute("download",`inventory-adjustments-${J().replace(/[/:,\s]/g,"-")}.csv`),F.style.visibility="hidden",document.body.appendChild(F),F.click(),document.body.removeChild(F)}},y=async(D=!0)=>{try{l(!0),console.log(T());const C=G=>{let le=Le.getProductById(G.productId),ne=Le.getStockByProductAndLocation(G.productId,u()),ue=parseFloat(ne?.averageCost+""),L=parseFloat(ne?.quantity+"");return{product:{id:G.productId,label:le?.name,code:le?.code},productId:G?.productId,reason:"Physical Count Adjustment",notes:G?.notes||"Physical inventory adjustment",quantity:G?.variance,unitCost:ue}},F=T().filter(G=>G.physicalCount!==null&&G.variance!==0).map(C);let ee="ADJ_"+ku();const H=new Date().toISOString(),oe={ssg_inventory_key:wy(),invoiceId:ee,referenceNumber:ku(),movementType:"adjustment",type:"adjustment",locationId:u(),items:F,products:F,generalNotes:"Physical inventory adjustment",description:"Physical Count Adjustment",invoice:ee,store:u(),createdBy:"admin",createDate:H};console.log("Saving inventory bulkRequest:",oe);const M=await Jr.addInventory(oe);D&&F.length>0&&I(),console.log("Saving inventory adjustments:",F),await new Promise(G=>setTimeout(G,1e3)),t.onClose()}catch(C){console.error("Failed to save inventory adjustments:",C)}finally{l(!1)}},de=Ze(()=>u()==="all"?"All Locations":B().find(C=>C.id===u())?.name||"Unknown Location"),J=()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),O=async()=>{await Le.fecthInventory("prod"),await Y()};$r(async()=>{t.selectedLocationId&&h(t.selectedLocationId),O()});const N=()=>{const D=window.open("","_blank");if(!D){alert("Please allow pop-ups to print the counting sheet");return}const C=q();D.document.write(C),D.document.close(),D.onload=()=>{D.print(),D.onafterprint=()=>{D.close()}}},q=()=>{const D=j().map((C,F)=>{const ee=V(C.id,u()!=="all"?u():void 0);return`
        <tr>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${F+1}</td>
          <td style="border: 1px solid #000; padding: 8px; font-family: monospace;">${C.sku}</td>
          <td style="border: 1px solid #000; padding: 8px;">
            <div style="font-weight: 500;">${C.name}</div>
            ${C.UPC?`<div style="font-size: 0.8em; color: #666;">UPC: ${C.UPC}</div>`:""}
          </td>
         
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${C.unitOfMeasure}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">${ee}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; background-color: #f9f9f9;"></td>
          <td style="border: 1px solid #000; padding: 8px;"></td>
        </tr>
      `}).join("");return`
      <!DOCTYPE html>
      <html>
      <head>
        <title> ${de()}_${m()}_${e("inventory.countingSheet","Inventory Counting Sheet")} - ${J()}</title>
        <style>
          @page {
            size: letter;
            margin: 0.5in 0.8in 0.5in 0.8in;
            @top-center {
              content: "${de()} | ${m()==="all"?e("inventory.allCategories","All Categories"):m()} | Page " counter(page);
              font-size: 10px;
              font-weight: bold;
              border-bottom: 1px solid #ccc;
              padding-bottom: 5px;
            }
          }
          body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            margin: 0;
            padding: 0;
            position: relative;
          }
          .page-identifier {
            position: fixed;
            left: 5px;
            top: 50%;
            transform: rotate(-90deg) translateX(-50%);
            transform-origin: left center;
            background: #f0f0f0;
            padding: 5px 15px;
            border: 1px solid #ccc;
            font-weight: bold;
            font-size: 10px;
            color: #333;
            z-index: 100;
          }
          .page-identifier-right {
            position: fixed;
            right: 5px;
            top: 50%;
            transform: rotate(90deg) translateX(50%);
            transform-origin: right center;
            background: #f0f0f0;
            padding: 5px 15px;
            border: 1px solid #ccc;
            font-weight: bold;
            font-size: 10px;
            color: #333;
            z-index: 100;
          }
          h1 {
            text-align: center;
            margin: 0 0 10px 0;
            font-size: 22px;
            page-break-after: avoid;
          }
          .header-info {
            text-align: center;
            margin-bottom: 20px;
            background: #f8f8f8;
            padding: 10px;
            border: 2px solid #333;
            page-break-after: avoid;
          }
          .page-header {
            display: none;
            text-align: center;
            background: #e0e0e0;
            padding: 8px;
            border: 1px solid #333;
            margin-bottom: 10px;
            font-weight: bold;
            font-size: 11px;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
          }
          th {
            background-color: #333;
            color: white;
            padding: 8px;
            text-align: left;
            font-weight: bold;
            border: 1px solid #000;
          }
          .summary-table {
            width: 50%;
            margin: 20px auto;
            /*page-break-before: auto;*/
          }
          .signature-section {
            margin-top: 40px;
            display: flex;
            justify-content: space-between;
            page-break-before: auto;
          }
          .signature-box {
            width: 45%;
            text-align: center;
          }
          .signature-line {
            border-bottom: 1px solid #000;
            margin-bottom: 5px;
            height: 30px;
          }
          @media print {
            body { margin: 0; }
            .page-identifier, .page-identifier-right { display: block; }
            .page-header { display: block; }
            tr { page-break-inside: avoid; }
            thead { display: table-header-group; }
            tfoot { display: table-footer-group; }
            .header-info { page-break-after: avoid; }
            h1 { page-break-after: avoid; }
            table { page-break-before: auto; }
            /*.summary-table { page-break-before: always; }*/
            .signature-section { page-break-before: avoid; }
            
            /* Repeat headers on each page */
            @page :first {
              @top-center { content: none; }
            }
            
            /* Force page headers to show on continuation pages */
            tbody::before {
              content: "";
              display: block;
              height: 0;
            }
          }
        </style>
      </head>
      <body>
        <!-- Page identifiers for multi-page documents -->
        <div class="page-identifier-right">
          ${de()} - ${m()==="all"?e("inventory.allCategories","All Categories"):m()} - ${J()} 
        </div>
       
        
        <h1>${e("inventory.inventoryCountingSheetTitle","INVENTORY COUNTING SHEET")}</h1>
        <div class="header-info">
          <p><strong>${e("inventory.location","Location")}:</strong> ${de()}</p>
          <p><strong>${e("common.category","Category")}:</strong> ${m()==="all"?e("inventory.allCategories","All Categories"):m()}</p>
          <p><strong>${e("common.date","Date")}:</strong> ${J()}</p>
          <p style="margin-top: 10px;">
            <span style="margin-right: 30px;">${e("inventory.countedBy","Counted by")}: _________________________</span>
            <span>${e("inventory.verifiedBy","Verified by")}: _________________________</span>
          </p>
        </div>

        <!-- Page header for continuation pages (hidden on first page) -->
        <div class="page-header">
          ${de()} | ${m()==="all"?e("inventory.allCategories","All Categories"):m()} | ${J()} 
        </div>

        <table>
          <thead>
            <tr>
              <th style="width: 5%; text-align: center;">#</th>
              <th style="width: 12%;">${e("inventory.sku","SKU")}</th>
              <th style="width: 25%;">${e("inventory.productName","Product Name")}</th>
              <th style="width: 8%; text-align: center;">${e("inventory.unit","Unit")}</th>
              <th style="width: 10%; text-align: center;">${e("inventory.systemQty","System Qty")}</th>
              <th style="width: 12%; text-align: center; background-color: #f0f0f0;">${e("inventory.physicalCount","Physical Count")}</th>
              <th style="width: 28%;">${e("common.notes","Notes")}</th>
            </tr>
            <!-- Repeat header info row for clarity -->
            <tr style="background-color: #f8f8f8; font-size: 10px;">
              <td colspan="8" style="text-align: center; padding: 4px; border: 1px solid #000; font-weight: bold;">
                 ${de()} |  ${m()==="all"?e("inventory.allCategories","All Categories"):m()} |  ${J()}
              </td>
            </tr>
          </thead>
          <tbody>
            ${D}
          </tbody>
        </table>
        
        <!-- Summary section with location/category context -->
        <div style="margin: 30px 0; padding: 15px; background: #f8f8f8;">
          <h3 style="text-align: center; margin: 0 0 15px 0; font-size: 16px;">
            ${e("inventory.summaryFor","SUMMARY FOR")}: ${de()} - ${m()==="all"?e("inventory.allCategories","All Categories"):m()}
          </h3>
          
          <table class="summary-table">
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.totalProductsListed","Total Products Listed")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">
                ${j().length}
              </td>
            </tr>
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.itemsCounted","Items Counted")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center;">
                ___________
              </td>
            </tr>
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.discrepanciesFound","Discrepancies Found")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center;">
                ___________
              </td>
            </tr>
          </table>
        </div>
        
        <div class="signature-section">
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.counterSignature","Counter Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.supervisorSignature","Supervisor Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
        </div>
      </body>
      </html>
    `};return b(Ae,{get when(){return t.isOpen},get children(){var D=mA(),C=D.firstChild,F=C.firstChild,ee=F.firstChild;ee.firstChild;var H=ee.nextSibling;return D.style.setProperty("position","fixed"),D.style.setProperty("top","0"),D.style.setProperty("left","0"),D.style.setProperty("right","0"),D.style.setProperty("bottom","0"),D.style.setProperty("background","rgba(0, 0, 0, 0.5)"),D.style.setProperty("z-index","1000"),D.style.setProperty("display","flex"),D.style.setProperty("align-items","center"),D.style.setProperty("justify-content","center"),C.style.setProperty("background","white"),C.style.setProperty("border-radius","var(--border-radius)"),C.style.setProperty("padding","2rem"),C.style.setProperty("width","95%"),C.style.setProperty("height","95%"),C.style.setProperty("max-width","1400px"),C.style.setProperty("overflow-y","auto"),C.style.setProperty("position","relative"),F.style.setProperty("display","flex"),F.style.setProperty("justify-content","space-between"),F.style.setProperty("align-items","center"),F.style.setProperty("margin-bottom","2rem"),F.style.setProperty("border-bottom","1px solid var(--border-color)"),F.style.setProperty("padding-bottom","1rem"),ee.style.setProperty("margin","0"),ee.style.setProperty("font-size","1.5rem"),i(ee,()=>e("inventory.physicalInventoryCount","Physical Inventory Count"),null),Vn(H,"click",t.onClose,!0),H.style.setProperty("background","none"),H.style.setProperty("border","none"),H.style.setProperty("font-size","1.5rem"),H.style.setProperty("cursor","pointer"),H.style.setProperty("padding","0.5rem"),i(C,b(Ae,{get when(){return P()==="setup"},get children(){var oe=lA(),M=oe.firstChild,G=M.nextSibling,le=G.nextSibling,ne=le.nextSibling,ue=ne.firstChild,L=ue.firstChild,A=L.firstChild,U=L.nextSibling,te=U.firstChild,ae=ue.nextSibling,re=ae.firstChild,ce=re.firstChild,Q=re.nextSibling,me=Q.firstChild,K=ae.nextSibling,he=K.firstChild,ve=he.firstChild,W=he.nextSibling,ie=W.firstChild,Pe=ie.nextSibling,_e=Pe.nextSibling;return oe.style.setProperty("text-align","center"),oe.style.setProperty("padding","2rem"),oe.style.setProperty("max-width","600px"),oe.style.setProperty("margin","0 auto"),M.style.setProperty("font-size","3rem"),M.style.setProperty("margin-bottom","1rem"),G.style.setProperty("margin-bottom","1rem"),i(G,()=>e("inventory.setupPhysicalCount","Setup Physical Inventory Count")),le.style.setProperty("margin-bottom","2rem"),le.style.setProperty("color","var(--text-muted)"),i(le,()=>e("inventory.setupDescription","Configure your physical inventory count settings and begin the counting process.")),ne.style.setProperty("display","grid"),ne.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),ne.style.setProperty("gap","1rem"),ne.style.setProperty("margin-bottom","2rem"),ne.style.setProperty("padding","1rem"),ne.style.setProperty("background","var(--surface-color)"),ne.style.setProperty("border-radius","var(--border-radius)"),ne.style.setProperty("text-align","left"),L.style.setProperty("display","block"),L.style.setProperty("margin-bottom","0.5rem"),L.style.setProperty("font-weight","500"),i(L,()=>e("inventory.location","Location"),A),U.addEventListener("change",fe=>h(fe.target.value)),U.style.setProperty("width","100%"),U.style.setProperty("padding","0.5rem"),U.style.setProperty("border","1px solid var(--border-color)"),U.style.setProperty("border-radius","var(--border-radius-sm)"),i(te,()=>e("inventory.allLocations","All Locations")),i(U,b(ut,{get each(){return B()},children:fe=>(()=>{var be=xm();return i(be,()=>fe.name),X(()=>be.value=fe.id),be})()}),null),re.style.setProperty("display","block"),re.style.setProperty("margin-bottom","0.5rem"),re.style.setProperty("font-weight","500"),i(re,()=>e("inventory.category","Category"),ce),Q.addEventListener("change",fe=>v(fe.target.value)),Q.style.setProperty("width","100%"),Q.style.setProperty("padding","0.5rem"),Q.style.setProperty("border","1px solid var(--border-color)"),Q.style.setProperty("border-radius","var(--border-radius-sm)"),i(me,()=>e("products.allCategories","All Categories")),i(Q,b(ut,{get each(){return Z()},children:fe=>(()=>{var be=xm();return be.value=fe,i(be,fe),be})()}),null),he.style.setProperty("display","block"),he.style.setProperty("margin-bottom","0.5rem"),he.style.setProperty("font-weight","500"),i(he,()=>e("inventory.sortBy","Sort By"),ve),W.addEventListener("change",fe=>x(fe.target.value)),W.style.setProperty("width","100%"),W.style.setProperty("padding","0.5rem"),W.style.setProperty("border","1px solid var(--border-color)"),W.style.setProperty("border-radius","var(--border-radius-sm)"),i(ie,()=>e("inventory.productName","Product Name")),i(Pe,()=>e("inventory.sku","SKU")),i(_e,()=>e("inventory.category","Category")),i(oe,b(Ae,{get when(){return!o()},get fallback(){return(()=>{var fe=yA(),be=fe.firstChild;return fe.style.setProperty("padding","2rem"),i(fe,()=>e("common.loading","Loading"),be),fe})()},get children(){return[(()=>{var fe=sA(),be=fe.firstChild;return be.firstChild,fe.style.setProperty("padding","1rem"),fe.style.setProperty("background","#fff3cd"),fe.style.setProperty("border-radius","var(--border-radius-sm)"),fe.style.setProperty("margin-bottom","2rem"),be.style.setProperty("margin","0"),be.style.setProperty("color","#856404"),i(be,()=>e("inventory.countWillInclude","This count will include {{count}} products from {{location}} in {{category}} category.",{count:j().length,location:de(),category:m()==="all"?e("inventory.allCategories","all categories"):m()}),null),fe})(),b(Ae,{get when(){return ge(()=>m()!=="all")()&&u()!=="all"},get children(){var fe=aA();return fe.style.setProperty("display","grid"),fe.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),fe.style.setProperty("gap","1rem"),fe.style.setProperty("margin-bottom","2rem"),fe.style.setProperty("padding","1rem"),fe.style.setProperty("background","var(--surface-color)"),fe.style.setProperty("border-radius","var(--border-radius)"),i(fe,b(Ae,{get when(){return Lt.hasPermission("physicalInventoryCountingForm")},get children(){return b(qe,{variant:"primary",size:"large",onClick:f,get disabled(){return o()||j().length===0},get children(){return[" ",ge(()=>e("inventory.startCounting","Start Physical Count"))]}})}}),null),i(fe,b(qe,{variant:"primary",onClick:N,get disabled(){return o()},get children(){return[" ",ge(()=>e("common.print","Print"))]}}),null),fe}})]}}),null),X(()=>U.value=u()),X(()=>Q.value=m()),X(()=>W.value=_()),oe}}),null),i(C,b(Ae,{get when(){return P()==="counting"},get children(){var oe=cA(),M=oe.firstChild,G=M.nextSibling,le=G.firstChild,ne=le.firstChild,ue=ne.nextSibling,L=le.nextSibling,A=L.firstChild,U=A.nextSibling,te=L.nextSibling,ae=te.firstChild,re=ae.nextSibling,ce=te.nextSibling,Q=ce.firstChild,me=Q.firstChild,K=Q.nextSibling,he=G.nextSibling,ve=he.nextSibling,W=ve.firstChild,ie=W.firstChild,Pe=ie.firstChild,_e=Pe.firstChild,fe=_e.nextSibling,be=fe.nextSibling,pe=be.nextSibling,we=pe.nextSibling,De=we.nextSibling,ke=ie.nextSibling;return M.style.setProperty("display","grid"),M.style.setProperty("grid-template-columns","repeat(auto-fit)"),M.style.setProperty("gap","1rem"),M.style.setProperty("margin-bottom","2rem"),M.style.setProperty("padding","1rem"),M.style.setProperty("background","var(--surface-color)"),M.style.setProperty("border-radius","var(--border-radius)"),i(M,de),G.style.setProperty("display","grid"),G.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),G.style.setProperty("gap","1rem"),G.style.setProperty("margin-bottom","2rem"),G.style.setProperty("padding","1rem"),G.style.setProperty("background","var(--surface-color)"),G.style.setProperty("border-radius","var(--border-radius)"),le.style.setProperty("text-align","center"),ne.style.setProperty("font-size","1.5rem"),ne.style.setProperty("font-weight","700"),ne.style.setProperty("color","var(--primary-color)"),i(ne,()=>$().countedProducts),ue.style.setProperty("font-size","0.875rem"),ue.style.setProperty("color","var(--text-muted)"),i(ue,()=>e("inventory.counted","Counted")),L.style.setProperty("text-align","center"),A.style.setProperty("font-size","1.5rem"),A.style.setProperty("font-weight","700"),A.style.setProperty("color","#ff9800"),i(A,()=>$().remainingProducts),U.style.setProperty("font-size","0.875rem"),U.style.setProperty("color","var(--text-muted)"),i(U,()=>e("inventory.remaining","Remaining")),te.style.setProperty("text-align","center"),ae.style.setProperty("font-size","1.5rem"),ae.style.setProperty("font-weight","700"),ae.style.setProperty("color","#f44336"),i(ae,()=>$().variances),re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),i(re,()=>e("inventory.variances","Variances")),ce.style.setProperty("text-align","center"),Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","700"),i(Q,()=>Math.round($().countedProducts/$().totalProducts*100),me),K.style.setProperty("font-size","0.875rem"),K.style.setProperty("color","var(--text-muted)"),i(K,()=>e("inventory.complete","Complete")),he.style.setProperty("display","flex"),he.style.setProperty("gap","1rem"),he.style.setProperty("margin-bottom","2rem"),he.style.setProperty("justify-content","center"),i(he,b(qe,{variant:"outline",onClick:()=>R("setup"),get children(){return[" ",ge(()=>e("common.back","Back to Setup"))]}}),null),i(he,b(qe,{variant:"primary",onClick:()=>R("review"),get children(){return[" ",ge(()=>e("inventory.reviewAdjustments","Review Adjustments"))]}}),null),ve.style.setProperty("border","1px solid var(--border-color)"),ve.style.setProperty("border-radius","var(--border-radius)"),ve.style.setProperty("overflow-x","auto"),W.style.setProperty("width","100%"),W.style.setProperty("border-collapse","collapse"),Pe.style.setProperty("background","var(--surface-color)"),_e.style.setProperty("padding","1rem"),_e.style.setProperty("text-align","left"),_e.style.setProperty("border-bottom","1px solid var(--border-color)"),i(_e,()=>e("inventory.no","No")),fe.style.setProperty("padding","1rem"),fe.style.setProperty("text-align","left"),fe.style.setProperty("border-bottom","1px solid var(--border-color)"),i(fe,()=>e("inventory.product","Product")),be.style.setProperty("padding","1rem"),be.style.setProperty("text-align","center"),be.style.setProperty("border-bottom","1px solid var(--border-color)"),i(be,()=>e("inventory.systemQty","System Qty")),pe.style.setProperty("padding","1rem"),pe.style.setProperty("text-align","center"),pe.style.setProperty("border-bottom","1px solid var(--border-color)"),i(pe,()=>e("inventory.physicalCount","Physical Count")),we.style.setProperty("padding","1rem"),we.style.setProperty("text-align","center"),we.style.setProperty("border-bottom","1px solid var(--border-color)"),i(we,()=>e("inventory.variance","Variance")),De.style.setProperty("padding","1rem"),De.style.setProperty("text-align","left"),De.style.setProperty("border-bottom","1px solid var(--border-color)"),i(De,()=>e("common.notes","Notes")),i(ke,b(ut,{get each(){return T()},children:(Te,Ue)=>b(vA,{get index(){return Ue()},updatePhysicalCount:g,entry:Te,updateNotes:S})})),X(Te=>(Te=$().isComplete?"#4caf50":"#ff9800")!=null?Q.style.setProperty("color",Te):Q.style.removeProperty("color")),oe}}),null),i(C,b(Ae,{get when(){return P()==="review"},get children(){var oe=hA(),M=oe.firstChild,G=M.firstChild;G.firstChild;var le=G.nextSibling,ne=M.nextSibling,ue=ne.firstChild,L=ue.firstChild,A=L.nextSibling,U=ue.nextSibling,te=U.firstChild,ae=te.nextSibling,re=U.nextSibling,ce=re.firstChild,Q=ce.nextSibling,me=ne.nextSibling;return M.style.setProperty("text-align","center"),M.style.setProperty("margin-bottom","2rem"),G.style.setProperty("margin-bottom","1rem"),i(G,()=>e("inventory.reviewAndConfirm","Review and Confirm Adjustments"),null),le.style.setProperty("color","var(--text-muted)"),i(le,()=>e("inventory.reviewDescription","Review the inventory adjustments below and confirm to update your system.")),ne.style.setProperty("display","grid"),ne.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),ne.style.setProperty("gap","1rem"),ne.style.setProperty("margin-bottom","2rem"),ne.style.setProperty("padding","1rem"),ne.style.setProperty("background","var(--surface-color)"),ne.style.setProperty("border-radius","var(--border-radius)"),ue.style.setProperty("text-align","center"),L.style.setProperty("font-size","1.5rem"),L.style.setProperty("font-weight","700"),L.style.setProperty("color","#4caf50"),i(L,()=>$().positiveVariances),A.style.setProperty("font-size","0.875rem"),A.style.setProperty("color","var(--text-muted)"),i(A,()=>e("inventory.stockIncreases","Stock Increases")),U.style.setProperty("text-align","center"),te.style.setProperty("font-size","1.5rem"),te.style.setProperty("font-weight","700"),te.style.setProperty("color","#f44336"),i(te,()=>$().negativeVariances),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),i(ae,()=>e("inventory.stockDecreases","Stock Decreases")),re.style.setProperty("text-align","center"),ce.style.setProperty("font-size","1.5rem"),ce.style.setProperty("font-weight","700"),ce.style.setProperty("color","var(--primary-color)"),i(ce,()=>$().variances),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),i(Q,()=>e("inventory.totalAdjustments","Total Adjustments")),me.style.setProperty("display","flex"),me.style.setProperty("gap","1rem"),me.style.setProperty("margin-bottom","2rem"),me.style.setProperty("justify-content","center"),me.style.setProperty("flex-wrap","wrap"),i(me,b(qe,{variant:"outline",onClick:()=>R("counting"),get children(){return[" ",ge(()=>e("common.back","Back to Counting"))]}}),null),i(me,b(qe,{variant:"outline",onClick:I,get disabled(){return $().variances===0},get children(){return[" ",ge(()=>e("inventory.downloadCSV","Download CSV"))]}}),null),i(me,b(qe,{variant:"primary",onClick:y,get disabled(){return a()||$().variances===0},get children(){return ge(()=>!!a())()?" "+e("common.saving","Saving")+"...":" "+e("inventory.confirmAdjustments","Confirm Adjustments")}}),null),i(oe,b(Ae,{get when(){return $().variances>0},get children(){var K=dA(),he=K.firstChild,ve=he.firstChild,W=ve.firstChild,ie=W.firstChild,Pe=ie.nextSibling,_e=Pe.nextSibling,fe=_e.nextSibling,be=fe.nextSibling,pe=ve.nextSibling;return K.style.setProperty("border","1px solid var(--border-color)"),K.style.setProperty("border-radius","var(--border-radius)"),K.style.setProperty("overflow-x","auto"),he.style.setProperty("width","100%"),he.style.setProperty("border-collapse","collapse"),W.style.setProperty("background","var(--surface-color)"),ie.style.setProperty("padding","1rem"),ie.style.setProperty("text-align","left"),ie.style.setProperty("border-bottom","1px solid var(--border-color)"),i(ie,()=>e("inventory.product","Product")),Pe.style.setProperty("padding","1rem"),Pe.style.setProperty("text-align","center"),Pe.style.setProperty("border-bottom","1px solid var(--border-color)"),i(Pe,()=>e("inventory.systemQty","System Qty")),_e.style.setProperty("padding","1rem"),_e.style.setProperty("text-align","center"),_e.style.setProperty("border-bottom","1px solid var(--border-color)"),i(_e,()=>e("inventory.physicalCount","Physical Count")),fe.style.setProperty("padding","1rem"),fe.style.setProperty("text-align","center"),fe.style.setProperty("border-bottom","1px solid var(--border-color)"),i(fe,()=>e("inventory.adjustment","Adjustment")),be.style.setProperty("padding","1rem"),be.style.setProperty("text-align","left"),be.style.setProperty("border-bottom","1px solid var(--border-color)"),i(be,()=>e("common.notes","Notes")),i(pe,b(ut,{get each(){return T().filter(we=>we.variance!==0)},children:we=>(()=>{var De=pA(),ke=De.firstChild,Te=ke.firstChild,Ue=Te.nextSibling,Xe=Ue.firstChild,ze=ke.nextSibling,$e=ze.firstChild,Ge=ze.nextSibling,ot=Ge.firstChild,je=Ge.nextSibling,Ce=je.firstChild,Se=je.nextSibling,Ke=Se.firstChild;return De.style.setProperty("border-bottom","1px solid var(--border-color)"),ke.style.setProperty("padding","1rem"),Te.style.setProperty("font-weight","500"),i(Te,()=>we.product.name),Ue.style.setProperty("font-size","0.875rem"),Ue.style.setProperty("color","var(--text-muted)"),i(Ue,()=>we.product.sku,Xe),i(Ue,()=>we.product.category,null),ze.style.setProperty("padding","1rem"),ze.style.setProperty("text-align","center"),$e.style.setProperty("font-weight","600"),i($e,()=>we.systemQuantity),Ge.style.setProperty("padding","1rem"),Ge.style.setProperty("text-align","center"),ot.style.setProperty("font-weight","600"),i(ot,()=>we.physicalCount),je.style.setProperty("padding","1rem"),je.style.setProperty("text-align","center"),Ce.style.setProperty("font-weight","700"),i(Ce,()=>we.variance>0?"+":"",null),i(Ce,()=>we.variance,null),Se.style.setProperty("padding","1rem"),Ke.style.setProperty("font-size","0.875rem"),i(Ke,()=>we.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")),X(He=>{var Oe=we.variance>0?"#d4edda":"#f8d7da",Ye=we.variance>0?"#4caf50":"#f44336";return Oe!==He.e&&((He.e=Oe)!=null?De.style.setProperty("background",Oe):De.style.removeProperty("background")),Ye!==He.t&&((He.t=Ye)!=null?Ce.style.setProperty("color",Ye):Ce.style.removeProperty("color")),He},{e:void 0,t:void 0}),De})()})),K}}),null),i(oe,b(Ae,{get when(){return $().variances===0},get children(){var K=uA(),he=K.firstChild,ve=he.nextSibling,W=ve.nextSibling;return K.style.setProperty("text-align","center"),K.style.setProperty("padding","3rem"),K.style.setProperty("background","var(--surface-color)"),K.style.setProperty("border-radius","var(--border-radius)"),he.style.setProperty("font-size","3rem"),he.style.setProperty("margin-bottom","1rem"),ve.style.setProperty("margin-bottom","0.5rem"),i(ve,()=>e("inventory.perfectCount","Perfect Count!")),W.style.setProperty("color","var(--text-muted)"),i(W,()=>e("inventory.noVariances","No variances found. Your physical count matches the system exactly.")),K}}),null),oe}}),null),D}})},vA=t=>{const{t:e}=ft(),[r,n]=ye(""),[o,s]=ye("");let{entry:a,updatePhysicalCount:l,updateNotes:u,index:h}=t;$r(()=>{s(a?.notes),n(a?.physicalCount)});const m=()=>{let v=document.getElementById(`physicalCountInput_${h+2}`);if(console.log(ts(r()),!v),ts(r())&&!v){l(a?.productId,r()===""?null:parseFloat(r()));return}if(ts(r())&&v){v.focus(),l(a?.productId,r()===""?null:parseFloat(r()));return}};return(()=>{var v=fA(),_=v.firstChild,x=_.firstChild,T=_.nextSibling,E=T.firstChild,P=E.nextSibling,R=P.firstChild,Y=R.nextSibling;Y.nextSibling;var Z=T.nextSibling,j=Z.firstChild,B=Z.nextSibling,V=B.firstChild,f=B.nextSibling,g=f.firstChild,S=f.nextSibling,$=S.firstChild;return v.style.setProperty("border-bottom","1px solid var(--border-color)"),_.style.setProperty("padding","1rem"),_.style.setProperty("text-align","center"),x.style.setProperty("font-weight","600"),i(x,h+1),T.style.setProperty("padding","1rem"),E.style.setProperty("font-weight","500"),i(E,()=>a?.product.name),P.style.setProperty("font-size","0.875rem"),P.style.setProperty("color","var(--text-muted)"),i(P,()=>a?.product.sku,R),i(P,()=>a?.product.category,Y),i(P,()=>a?.product.unitOfMeasure,null),Z.style.setProperty("padding","1rem"),Z.style.setProperty("text-align","center"),j.style.setProperty("font-weight","600"),i(j,()=>a?.systemQuantity),B.style.setProperty("padding","1rem"),B.style.setProperty("text-align","center"),V.addEventListener("blur",()=>{m()}),V.$$keydown=w=>{w.keyCode===13&&m(),w.keyCode===27&&m(),w.keyCode},V.$$input=w=>{const I=w.target.value;n(I)},ct(V,"id",`physicalCountInput_${h+1}`),ct(V,"tabindex",h),V.style.setProperty("width","100px"),V.style.setProperty("padding","0.5rem"),V.style.setProperty("border","1px solid var(--border-color)"),V.style.setProperty("border-radius","var(--border-radius-sm)"),V.style.setProperty("text-align","center"),f.style.setProperty("padding","1rem"),f.style.setProperty("text-align","center"),g.style.setProperty("font-weight","600"),i(g,()=>a?.variance>0?"+":"",null),i(g,()=>a?.variance||"",null),S.style.setProperty("padding","1rem"),$.addEventListener("blur",w=>{u(a?.productId,o())}),$.$$keydown=w=>{w.keyCode===13&&u(a?.productId,o()),w.keyCode===27&&u(a?.productId,o()),w.keyCode===9&&u(a?.productId,o())},$.$$input=w=>{const I=w.target.value;s(I)},$.style.setProperty("width","200px"),$.style.setProperty("padding","0.5rem"),$.style.setProperty("border","1px solid var(--border-color)"),$.style.setProperty("border-radius","var(--border-radius-sm)"),X(w=>{var I=a?.physicalCount!==null?a?.variance!==0?"#fff3cd":"#d4edda":"transparent",y=a?.variance>0?"#4caf50":a?.variance<0?"#f44336":"var(--text-muted)",de=e("inventory.addNotes","Add notes...");return I!==w.e&&((w.e=I)!=null?v.style.setProperty("background",I):v.style.removeProperty("background")),y!==w.t&&((w.t=y)!=null?g.style.setProperty("color",y):g.style.removeProperty("color")),de!==w.a&&ct($,"placeholder",w.a=de),w},{e:void 0,t:void 0,a:void 0}),X(()=>V.value=r()||""),X(()=>$.value=o()||""),v})()};wt(["click","input","keydown"]);function bA(t,e=300,r=!1){let n,o;const s=()=>{n!==void 0&&(clearTimeout(n),n=void 0),o=void 0},a=()=>{n!==void 0&&o!==void 0&&(clearTimeout(n),n=void 0,t(...o),o=void 0)},l=(...u)=>{o=u,n!==void 0&&clearTimeout(n),r&&n===void 0&&t(...u),n=window.setTimeout(()=>{r||t(...u),n=void 0,o=void 0},e)};return Ai(()=>{s()}),{debounced:l,cancel:s,flush:a}}function _A(t,e=300){const[r,n]=ye(!1);let o;const s=async h=>{if(o&&o.abort(),!h.trim()){n(!1);return}o=new AbortController,n(!0);try{await t(h)}catch(m){m instanceof Error&&m.name!=="AbortError"&&console.error("Search error:",m)}finally{o.signal.aborted||n(!1)}},{debounced:a,cancel:l}=bA(s,e,!1),u=()=>{l(),o&&o.abort(),n(!1)};return Ai(()=>{u()}),{search:a,isSearching:r,cancel:u}}var $m=z("<div>"),SA=z("<div><h3></h3><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),PA=z("<div><h3></h3><div><div><div><span></span><span></span></div><div><span></span><span></span></div></div><div><div><span></span><span></span></div><div><span></span><span>%"),wA=z("<div><h4>"),CA=z("<div><h3></h3><div><div><div><span></span><span> </span></div><div><span></span><span> </span></div></div><div><div><span></span><span> </span></div><div><span></span><span>"),xA=z("<div><h3></h3><div><span></span><span></span></div><div><span></span><span>"),Am=z("<div><h3>"),$A=z("<div><div><div><h2></h2><div>SKU: <!>  </div></div><div></div></div><div><button></button><button></button><button></button></div><div>"),AA=z("<span> "),IA=z("<span> "),EA=z("<div><div><span><span>  </span></span><span> </span></div><div>: <!>  <!>: "),TA=z("<div> "),kA=z("<div>Ref: "),RA=z("<div><div><div><span></span><span></span><span></span></div><div><span></span></div></div><div><div> </div><div>"),DA=z("<div><h4></h4><div></div><div>"),NA=z("<div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div> <!>  </div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div>Min: <!>  Max: ");const LA=t=>{const{t:e}=ft(),[r,n]=ye("details"),o=Ze(()=>{if(!t.product)return null;const S=Le.getTotalStockByProduct(t.product.id),$=Le.getStockByProduct(t.product.id),w=S<=t.product.minStockLevel,I=S===0,y=S>=t.product.maxStockLevel;return{total:S,byLocation:$,status:I?"out":w?"low":y?"over":"good",statusText:I?e("products.outOfStock","Out of Stock"):w?e("products.lowStock","Low Stock"):y?e("products.overStock","Over Stock"):e("products.inStock","In Stock")}}),s=S=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(S),a=S=>new Date(S).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),l=Ze(()=>!t.product||t.product.unitCost===0?0:((t.product.sellingPrice-t.product.unitCost)/t.product.unitCost*100).toFixed(2)),u=Ze(()=>t.product?Le.movements.filter(S=>S.productId===t.product.id).sort((S,$)=>new Date($.createdDate).getTime()-new Date(S.createdDate).getTime()):[]),h=Ze(()=>{if(!t.product)return null;const S=u(),$=o(),w=new Date;w.setDate(w.getDate()-30);const I=S.filter(de=>new Date(de.createdDate)>=w),y=S.reduce((de,J)=>{const O=J.productId===t.product.id?J:null;return de+(O?O.quantity*O.unitCost:0)},0);return{recentMovements:S.length,movements30Days:I.length,totalValue:($?.total||0)*t.product.unitCost,averageMovementValue:S.length>0?y/S.length:0,lastMovementDate:S.length>0?S[0].createdDate:null}}),m={"margin-bottom":"2rem"},v={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},_={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},x={"font-weight":"400",color:"var(--text-primary)","font-size":"1rem"},T=S=>({in:"",out:"",transfer:"",adjustment:""})[S]||"";function E(S){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[S]||{bg:"#f5f5f5",color:"#666"}}const P=S=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:E(S).bg,color:E(S).color}),R=S=>{const $={good:{background:"#d4edda",color:"#155724"},low:{background:"#fff3cd",color:"#856404"},out:{background:"#f8d7da",color:"#721c24"},over:{background:"#cce5ff",color:"#004085"}};return{display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500",...$[S]||$.good}},Y={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"},Z={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1rem","margin-bottom":"0.75rem"},j={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1.5rem","padding-bottom":"1rem","border-bottom":"2px solid var(--border-color)"},B={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},V=S=>({padding:"0.75rem 1.5rem",background:"none",border:"none","border-bottom":S?"2px solid var(--primary-color)":"2px solid transparent",color:S?"var(--primary-color)":"var(--text-muted)","font-weight":S?"600":"400",cursor:"pointer",transition:"all 0.2s","font-size":"0.875rem"}),f={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-bottom":"0.5rem"},g={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1.5rem","margin-bottom":"1rem"};return b(Ar,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("products.productDetails","Product Details")},size:"large",get children(){return b(Ae,{get when(){return t.product},get fallback(){return(()=>{var S=$m();return S.style.setProperty("text-align","center"),S.style.setProperty("padding","2rem"),S.style.setProperty("color","var(--text-muted)"),i(S,()=>e("products.noProductSelected","No product selected")),S})()},children:S=>(()=>{var $=$A(),w=$.firstChild,I=w.firstChild,y=I.firstChild,de=y.nextSibling,J=de.firstChild,O=J.nextSibling;O.nextSibling;var N=I.nextSibling,q=w.nextSibling,D=q.firstChild,C=D.nextSibling,F=C.nextSibling,ee=q.nextSibling;return i($,()=>JSON.stringify(S),w),d(w,j),y.style.setProperty("margin","0"),y.style.setProperty("font-size","1.5rem"),y.style.setProperty("margin-bottom","0.25rem"),i(y,()=>S().name),de.style.setProperty("color","var(--text-muted)"),i(de,()=>S().sku,O),i(de,()=>S().category,null),i(N,()=>o()?.statusText),d(q,B),D.$$click=()=>n("details"),i(D,()=>e("products.details","Details")),C.$$click=()=>n("movements"),i(C,()=>e("products.movements","Movements")),F.$$click=()=>n("analytics"),i(F,()=>e("products.analytics","Analytics")),i($,b(Ae,{get when(){return r()==="details"},get children(){return[(()=>{var H=SA(),oe=H.firstChild,M=oe.nextSibling,G=M.firstChild,le=G.nextSibling,ne=M.nextSibling,ue=ne.firstChild,L=ue.nextSibling,A=ne.nextSibling,U=A.firstChild,te=U.nextSibling;return oe.style.setProperty("margin-bottom","1rem"),oe.style.setProperty("font-size","1.1rem"),i(oe,()=>e("products.basicInformation","Basic Information")),i(G,()=>e("products.description","Description")),i(le,()=>S().description||e("common.notAvailable","N/A")),i(ue,()=>e("products.unitOfMeasure","Unit of Measure")),i(L,()=>S().unitOfMeasure),i(U,()=>e("products.status","Status")),i(te,(()=>{var ae=ge(()=>!!S().isActive);return()=>ae()?(()=>{var re=AA();return re.firstChild,re.style.setProperty("color","#2e7d32"),i(re,()=>e("common.active","Active"),null),re})():(()=>{var re=IA();return re.firstChild,re.style.setProperty("color","#d32f2f"),i(re,()=>e("common.inactive","Inactive"),null),re})()})()),X(ae=>{var re=m,ce=v,Q=_,me=x,K=v,he=_,ve=x,W=v,ie=_,Pe=x;return ae.e=d(H,re,ae.e),ae.t=d(M,ce,ae.t),ae.a=d(G,Q,ae.a),ae.o=d(le,me,ae.o),ae.i=d(ne,K,ae.i),ae.n=d(ue,he,ae.n),ae.s=d(L,ve,ae.s),ae.h=d(A,W,ae.h),ae.r=d(U,ie,ae.r),ae.d=d(te,Pe,ae.d),ae},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),H})(),(()=>{var H=PA(),oe=H.firstChild,M=oe.nextSibling,G=M.firstChild,le=G.firstChild,ne=le.firstChild,ue=ne.nextSibling,L=le.nextSibling,A=L.firstChild,U=A.nextSibling,te=G.nextSibling,ae=te.firstChild,re=ae.firstChild,ce=re.nextSibling,Q=ae.nextSibling,me=Q.firstChild,K=me.nextSibling,he=K.firstChild;return oe.style.setProperty("margin-bottom","1rem"),oe.style.setProperty("font-size","1.1rem"),i(oe,()=>e("products.pricingInformation","Pricing Information")),i(ne,()=>e("products.unitCost","Unit Cost")),i(ue,()=>s(S().unitCost)),i(A,()=>e("products.sellingPrice","Selling Price")),i(U,()=>s(S().sellingPrice)),i(re,()=>e("products.profit","Profit")),i(ce,()=>s(S().sellingPrice-S().unitCost)),i(me,()=>e("products.profitMargin","Profit Margin")),i(K,l,he),X(ve=>{var W=m,ie=Y,Pe=v,_e=_,fe=x,be=v,pe=_,we=x,De=v,ke=_,Te=x,Ue=v,Xe=_,ze=x;return ve.e=d(H,W,ve.e),ve.t=d(M,ie,ve.t),ve.a=d(le,Pe,ve.a),ve.o=d(ne,_e,ve.o),ve.i=d(ue,fe,ve.i),ve.n=d(L,be,ve.n),ve.s=d(A,pe,ve.s),ve.h=d(U,we,ve.h),ve.r=d(ae,De,ve.r),ve.d=d(re,ke,ve.d),ve.l=d(ce,Te,ve.l),ve.u=d(Q,Ue,ve.u),ve.c=d(me,Xe,ve.c),ve.w=d(K,ze,ve.w),ve},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),H})(),(()=>{var H=CA(),oe=H.firstChild,M=oe.nextSibling,G=M.firstChild,le=G.firstChild,ne=le.firstChild,ue=ne.nextSibling,L=ue.firstChild,A=le.nextSibling,U=A.firstChild,te=U.nextSibling,ae=te.firstChild,re=G.nextSibling,ce=re.firstChild,Q=ce.firstChild,me=Q.nextSibling,K=me.firstChild,he=ce.nextSibling,ve=he.firstChild,W=ve.nextSibling;return oe.style.setProperty("margin-bottom","1rem"),oe.style.setProperty("font-size","1.1rem"),i(oe,()=>e("products.stockInformation","Stock Information")),i(ne,()=>e("products.totalStock","Total Stock")),i(ue,()=>o()?.total||0,L),i(ue,()=>S().unitOfMeasure,null),i(U,()=>e("products.minStockLevel","Min Stock Level")),i(te,()=>S().minStockLevel,ae),i(te,()=>S().unitOfMeasure,null),i(Q,()=>e("products.maxStockLevel","Max Stock Level")),i(me,()=>S().maxStockLevel,K),i(me,()=>S().unitOfMeasure,null),i(ve,()=>e("products.stockValue","Stock Value")),i(W,()=>s((o()?.total||0)*S().unitCost)),i(H,b(Ae,{get when(){return ge(()=>!!o()?.byLocation)()&&o().byLocation.length>0},get children(){var ie=wA(),Pe=ie.firstChild;return ie.style.setProperty("margin-top","1.5rem"),Pe.style.setProperty("margin-bottom","1rem"),Pe.style.setProperty("font-size","1rem"),i(Pe,()=>e("products.stockByLocation","Stock by Location")),i(ie,()=>o().byLocation.map(_e=>(()=>{var fe=EA(),be=fe.firstChild,pe=be.firstChild,we=pe.firstChild;we.firstChild;var De=pe.nextSibling,ke=De.firstChild,Te=be.nextSibling,Ue=Te.firstChild,Xe=Ue.nextSibling,ze=Xe.nextSibling,$e=ze.nextSibling;return $e.nextSibling,d(fe,Z),be.style.setProperty("display","flex"),be.style.setProperty("justify-content","space-between"),be.style.setProperty("align-items","center"),pe.style.setProperty("font-weight","500"),pe.style.setProperty("color","var(--primary-color)"),i(pe,()=>_e.locationId,we),we.style.setProperty("font-weight","500"),we.style.setProperty("color","var(--text-muted)"),i(we,()=>_e.locationName,null),De.style.setProperty("font-weight","600"),i(De,()=>_e.quantity,ke),i(De,()=>S().unitOfMeasure,null),Te.style.setProperty("margin-top","0.5rem"),Te.style.setProperty("font-size","0.875rem"),Te.style.setProperty("color","var(--text-muted)"),i(Te,()=>e("products.available","Available"),Ue),i(Te,()=>_e.availableQuantity,Xe),i(Te,()=>e("products.reserved","Reserved"),$e),i(Te,()=>_e.reservedQuantity,null),X(Ge=>(Ge=_e.quantity>0?"var(--primary-color)":"var(--text-muted)")!=null?De.style.setProperty("color",Ge):De.style.removeProperty("color")),fe})()),null),ie}}),null),X(ie=>{var Pe=m,_e=Y,fe=v,be=_,pe=x,we=v,De=_,ke=x,Te=v,Ue=_,Xe=x,ze=v,$e=_,Ge=x;return ie.e=d(H,Pe,ie.e),ie.t=d(M,_e,ie.t),ie.a=d(le,fe,ie.a),ie.o=d(ne,be,ie.o),ie.i=d(ue,pe,ie.i),ie.n=d(A,we,ie.n),ie.s=d(U,De,ie.s),ie.h=d(te,ke,ie.h),ie.r=d(ce,Te,ie.r),ie.d=d(Q,Ue,ie.d),ie.l=d(me,Xe,ie.l),ie.u=d(he,ze,ie.u),ie.c=d(ve,$e,ie.c),ie.w=d(W,Ge,ie.w),ie},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),H})(),(()=>{var H=xA(),oe=H.firstChild,M=oe.nextSibling,G=M.firstChild,le=G.nextSibling,ne=M.nextSibling,ue=ne.firstChild,L=ue.nextSibling;return oe.style.setProperty("margin-bottom","1rem"),oe.style.setProperty("font-size","1.1rem"),i(oe,()=>e("products.timestamps","Timestamps")),i(G,()=>e("common.createdDate","Created Date")),i(le,()=>a(S().createdDate)),i(ue,()=>e("common.lastModified","Last Modified")),i(L,()=>a(S().lastModified)),X(A=>{var U=m,te=v,ae=_,re=x,ce=v,Q=_,me=x;return A.e=d(H,U,A.e),A.t=d(M,te,A.t),A.a=d(G,ae,A.a),A.o=d(le,re,A.o),A.i=d(ne,ce,A.i),A.n=d(ue,Q,A.n),A.s=d(L,me,A.s),A},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),H})()]}}),ee),i($,b(Ae,{get when(){return r()==="movements"},get children(){var H=Am(),oe=H.firstChild;return oe.style.setProperty("margin-bottom","1rem"),oe.style.setProperty("font-size","1.1rem"),i(oe,()=>e("products.recentMovements","Recent Movements")),i(H,b(Ae,{get when(){return u().length>0},get fallback(){return(()=>{var M=TA();return M.firstChild,M.style.setProperty("text-align","center"),M.style.setProperty("padding","2rem"),M.style.setProperty("color","var(--text-muted)"),M.style.setProperty("background","var(--surface-color)"),M.style.setProperty("border-radius","var(--border-radius-sm)"),M.style.setProperty("border","1px solid var(--border-color)"),i(M,()=>e("products.noMovements","No movements found for this product"),null),M})()},get children(){return b(ut,{get each(){return u()},children:M=>{const G=M.productId===S().id?M:null;if(!G)return null;let le=Le.getLocationById(M.locationId);return(()=>{var ne=RA(),ue=ne.firstChild,L=ue.firstChild,A=L.firstChild,U=A.nextSibling,te=U.nextSibling,ae=L.nextSibling,re=ae.firstChild,ce=ue.nextSibling,Q=ce.firstChild,me=Q.firstChild,K=Q.nextSibling;return d(ne,f),L.style.setProperty("font-weight","600"),L.style.setProperty("margin-bottom","0.25rem"),A.style.setProperty("font-size","1.2rem"),i(A,()=>T(M.movementType)),U.style.setProperty("padding","0 6px"),i(te,()=>M.movementType),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),i(ae,()=>` ${a(M?.createdDate)}  `,re),re.style.setProperty("font-size","0.875rem"),re.style.setProperty("font-weight","600"),re.style.setProperty("color","var(--primary-color)"),i(re,()=>M?.locationId),i(ae,()=>`  ${le?.name}`,null),i(ue,b(Ae,{get when(){return M.referenceNumber},get children(){var he=kA();return he.firstChild,he.style.setProperty("font-size","0.75rem"),he.style.setProperty("color","var(--text-muted)"),he.style.setProperty("margin-top","0.25rem"),i(he,()=>M?.referenceNumber,null),he}}),null),ce.style.setProperty("text-align","right"),Q.style.setProperty("font-weight","600"),Q.style.setProperty("font-size","1rem"),i(Q,()=>M?.movementType==="in"?"+":"",me),i(Q,()=>G.quantity,me),i(Q,()=>S().unitOfMeasure,null),K.style.setProperty("font-size","0.875rem"),K.style.setProperty("color","var(--text-muted)"),i(K,()=>s(G.unitCost)),X(he=>{var ve=P(M.movementType),W=M?.movementType==="in"?"#2e7d32":"#d32f2f";return he.e=d(te,ve,he.e),W!==he.t&&((he.t=W)!=null?Q.style.setProperty("color",W):Q.style.removeProperty("color")),he},{e:void 0,t:void 0}),ne})()}})}}),null),X(M=>d(H,m,M)),H}}),ee),i($,b(Ae,{get when(){return r()==="analytics"},get children(){var H=Am(),oe=H.firstChild;return oe.style.setProperty("margin-bottom","1rem"),oe.style.setProperty("font-size","1.1rem"),i(oe,()=>e("products.analytics","Analytics")),i(H,b(Ae,{get when(){return h()},get fallback(){return(()=>{var M=$m();return M.style.setProperty("text-align","center"),M.style.setProperty("padding","2rem"),M.style.setProperty("color","var(--text-muted)"),i(M,()=>e("products.noAnalytics","No analytics data available")),M})()},children:M=>(()=>{var G=NA(),le=G.firstChild,ne=le.firstChild,ue=ne.nextSibling,L=ue.nextSibling,A=le.nextSibling,U=A.firstChild,te=U.nextSibling,ae=te.nextSibling,re=A.nextSibling,ce=re.firstChild,Q=ce.nextSibling,me=Q.nextSibling,K=me.firstChild,he=K.nextSibling;he.nextSibling;var ve=re.nextSibling,W=ve.firstChild,ie=W.nextSibling,Pe=ie.nextSibling,_e=ve.nextSibling,fe=_e.firstChild,be=fe.nextSibling,pe=be.nextSibling,we=pe.firstChild,De=we.nextSibling;return De.nextSibling,ne.style.setProperty("margin","0 0 0.5rem 0"),ne.style.setProperty("color","var(--primary-color)"),i(ne,()=>e("products.totalMovements","Total Movements")),ue.style.setProperty("font-size","1.5rem"),ue.style.setProperty("font-weight","600"),i(ue,()=>M().recentMovements),L.style.setProperty("font-size","0.875rem"),L.style.setProperty("color","var(--text-muted)"),L.style.setProperty("margin-top","0.25rem"),i(L,()=>e("products.allTime","All time")),U.style.setProperty("margin","0 0 0.5rem 0"),U.style.setProperty("color","var(--primary-color)"),i(U,()=>e("products.last30Days","Last 30 Days")),te.style.setProperty("font-size","1.5rem"),te.style.setProperty("font-weight","600"),i(te,()=>M().movements30Days),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),ae.style.setProperty("margin-top","0.25rem"),i(ae,()=>e("products.movements","movements")),ce.style.setProperty("margin","0 0 0.5rem 0"),ce.style.setProperty("color","var(--primary-color)"),i(ce,()=>e("products.currentValue","Current Stock Value")),Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","600"),i(Q,()=>s(M().totalValue)),me.style.setProperty("font-size","0.875rem"),me.style.setProperty("color","var(--text-muted)"),me.style.setProperty("margin-top","0.25rem"),i(me,()=>o()?.total||0,K),i(me,()=>S().unitOfMeasure,he),i(me,()=>s(S().unitCost),null),W.style.setProperty("margin","0 0 0.5rem 0"),W.style.setProperty("color","var(--primary-color)"),i(W,()=>e("products.avgMovementValue","Avg Movement Value")),ie.style.setProperty("font-size","1.5rem"),ie.style.setProperty("font-weight","600"),i(ie,()=>s(M().averageMovementValue)),Pe.style.setProperty("font-size","0.875rem"),Pe.style.setProperty("color","var(--text-muted)"),Pe.style.setProperty("margin-top","0.25rem"),i(Pe,()=>e("products.perMovement","per movement")),i(G,b(Ae,{get when(){return M().lastMovementDate},get children(){var ke=DA(),Te=ke.firstChild,Ue=Te.nextSibling,Xe=Ue.nextSibling;return Te.style.setProperty("margin","0 0 0.5rem 0"),Te.style.setProperty("color","var(--primary-color)"),i(Te,()=>e("products.lastMovement","Last Movement")),Ue.style.setProperty("font-size","1.25rem"),Ue.style.setProperty("font-weight","600"),i(Ue,()=>a(M().lastMovementDate)),Xe.style.setProperty("font-size","0.875rem"),Xe.style.setProperty("color","var(--text-muted)"),Xe.style.setProperty("margin-top","0.25rem"),i(Xe,()=>e("products.mostRecent","Most recent activity")),X(ze=>d(ke,g,ze)),ke}}),_e),fe.style.setProperty("margin","0 0 0.5rem 0"),fe.style.setProperty("color","var(--primary-color)"),i(fe,()=>e("products.stockStatus","Stock Status")),be.style.setProperty("font-size","1.25rem"),be.style.setProperty("font-weight","600"),i(be,()=>o()?.statusText),pe.style.setProperty("font-size","0.875rem"),pe.style.setProperty("color","var(--text-muted)"),pe.style.setProperty("margin-top","0.25rem"),i(pe,()=>S().minStockLevel,De),i(pe,()=>S().maxStockLevel,null),X(ke=>{var Te=Y,Ue=g,Xe=g,ze=g,$e=g,Ge=g;return ke.e=d(G,Te,ke.e),ke.t=d(le,Ue,ke.t),ke.a=d(A,Xe,ke.a),ke.o=d(re,ze,ke.o),ke.i=d(ve,$e,ke.i),ke.n=d(_e,Ge,ke.n),ke},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),G})()}),null),X(M=>d(H,m,M)),H}}),ee),ee.style.setProperty("display","flex"),ee.style.setProperty("gap","1rem"),ee.style.setProperty("justify-content","flex-end"),ee.style.setProperty("margin-top","2rem"),i(ee,b(qe,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close","Close")}}),null),i(ee,b(Ae,{get when(){return t.onEdit},get children(){return b(qe,{variant:"primary",get onClick(){return t.onEdit},get children(){return e("common.edit","Edit")}})}}),null),X(H=>{var oe=R(o()?.status||"good"),M=V(r()==="details"),G=V(r()==="movements"),le=V(r()==="analytics");return H.e=d(N,oe,H.e),H.t=d(D,M,H.t),H.a=d(C,G,H.a),H.o=d(F,le,H.o),H},{e:void 0,t:void 0,a:void 0,o:void 0}),$})()})}})};wt(["click"]);var MA=z("<div>"),OA=z("<button type=button>"),FA=z("<div> "),Im=z("<div>"),VA=z("<div><div><input type=text autocomplete=off>"),BA=z("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div>"),UA=z("<span> ");const zA=t=>{const{t:e}=ft(),[r,n]=ye(""),[o,s]=ye(!1),[a,l]=ye(null),[u,h]=ye([]),[m,v]=ye(!1),[_,x]=ye(-1),[T,E]=ye(null),P=t.searchDelay||300,R=t.maxResults||900,Y=async M=>{if(!M.trim()||M.trim().length<3){h([]),t.onSearchResults?.([]);return}try{s(!0),l(null);try{const G=await Jr.getProducts(M),le=Object.keys(G),ne=L=>{let A=G;return{id:L,name:A[L].name,businessId:A[L].businessId,sku:A[L].code,UPC:A[L].UPC,numCode:A[L].codeN,category:A[L].category,unitCost:A[L].unitCost||0,unitOfMeasure:A[L].unitOfMeasure,minStockLevel:A[L].minStockLevel,maxStockLevel:A[L].maxStockLevel,isActive:A[L].isActive,description:A[L].description||"",createdDate:A[L].createdAt||new Date().toISOString(),lastModified:A[L].updatedAt||new Date().toISOString()}},ue=le.map(ne);h(ue),Le.updProduct(ue),t.onSearchResults?.(ue)}catch(G){console.warn("API search failed, using local fallback:",G),l("API search failed, showing local results");const le=Le.getActiveProducts().filter(ne=>ne.name.toLowerCase().includes(M.toLowerCase())||ne.sku.toLowerCase().includes(M.toLowerCase())||ne.category.toLowerCase().includes(M.toLowerCase())).slice(0,R);h(le),t.onSearchResults?.(le)}}catch(G){const le=G instanceof Error?G.message:"Search failed";l(le),h([]),t.onSearchResults?.([])}finally{s(!1)}},Z=M=>{const le=M.target.value;n(le),l(null),t.showResults!==!1&&v(!0),T()&&clearTimeout(T());const ne=setTimeout(()=>{Y(le)},P);E(ne)},j=M=>{n(M.name),v(!1),x(-1),t.onProductSelect?.(M)},B=M=>{if(!(!m()||u().length===0))switch(M.key){case"ArrowDown":M.preventDefault(),x(G=>Math.min(G+1,u().length-1));break;case"ArrowUp":M.preventDefault(),x(G=>Math.max(G-1,-1));break;case"Enter":M.preventDefault(),_()>=0&&u()[_()]&&j(u()[_()]);break;case"Escape":v(!1),x(-1);break}},V=()=>{t.showResults!==!1&&u().length>0&&v(!0)},f=()=>{setTimeout(()=>{v(!1),x(-1)},150)},g=()=>{n(""),h([]),l(null),v(!1),x(-1),t.onSearchResults?.([]),T()&&(clearTimeout(T()),E(null))},S=M=>Le.stockLevels.filter(G=>G.productId===M).reduce((G,le)=>G+le.quantity,0),$=M=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(M),w={position:"relative",width:"100%",...t.style},I={position:"relative",display:"flex","align-items":"center"},y={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},de={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},J={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},O={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},N=M=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:M?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),q={display:"flex","justify-content":"space-between","align-items":"center"},D={flex:"1"},C={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},F={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},ee={"text-align":"right","font-size":"0.875rem"},H={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},oe={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var M=VA(),G=M.firstChild,le=G.firstChild;return le.addEventListener("blur",f),le.addEventListener("focus",V),le.$$keydown=B,le.$$input=Z,i(G,b(Ae,{get when(){return o()},get children(){var ne=MA();return X(ue=>d(ne,J,ue)),ne}}),null),i(G,b(Ae,{get when(){return ge(()=>!!r())()&&!o()},get children(){var ne=OA();return ne.addEventListener("mouseleave",ue=>{ue.currentTarget.style.background="none",ue.currentTarget.style.color="var(--text-muted)"}),ne.addEventListener("mouseenter",ue=>{ue.currentTarget.style.background="var(--border-color)",ue.currentTarget.style.color="var(--text-primary)"}),ne.$$click=g,X(ue=>{var L=de,A=e("common.clear","Clear search");return ue.e=d(ne,L,ue.e),A!==ue.t&&ct(ne,"title",ue.t=A),ue},{e:void 0,t:void 0}),ne}}),null),i(M,b(Ae,{get when(){return m()&&t.showResults!==!1},get children(){var ne=Im();return i(ne,b(Ae,{get when(){return a()},get children(){var ue=FA();return ue.firstChild,d(ue,oe),i(ue,a,null),ue}}),null),i(ne,b(Ae,{get when(){return u().length>0},get fallback(){return ge(()=>!!(r()&&!o()))()&&(()=>{var ue=Im();return d(ue,H),i(ue,()=>e("inventory.noProductsFound","No products found matching your search.")),ue})()},get children(){return b(ut,{get each(){return u()},children:(ue,L)=>{const A=S(ue.id),U=A<=ue.minStockLevel;return(()=>{var te=BA(),ae=te.firstChild,re=ae.firstChild,ce=re.firstChild,Q=ce.nextSibling,me=Q.firstChild,K=me.firstChild,he=me.nextSibling,ve=he.nextSibling,W=ve.nextSibling,ie=W.nextSibling,Pe=re.nextSibling,_e=Pe.firstChild,fe=_e.firstChild,be=_e.nextSibling;return te.addEventListener("mouseenter",()=>x(L())),te.$$click=()=>j(ue),d(ae,q),d(re,D),d(ce,C),i(ce,()=>ue.name),d(Q,F),i(me,()=>e("inventory.sku","SKU"),K),i(me,()=>ue.sku,null),i(ve,()=>ue.category),i(ie,()=>$(ue.unitCost)),d(Pe,ee),_e.style.setProperty("font-weight","600"),(U?"#f44336":"var(--text-primary)")!=null?_e.style.setProperty("color",U?"#f44336":"var(--text-primary)"):_e.style.removeProperty("color"),i(_e,A,fe),i(_e,()=>ue.unitOfMeasure,null),be.style.setProperty("color","var(--text-muted)"),i(be,()=>U?(()=>{var pe=UA();return pe.firstChild,pe.style.setProperty("color","#f44336"),i(pe,()=>e("inventory.lowStock","Low Stock"),null),pe})():e("inventory.inStock","In Stock")),X(pe=>d(te,N(L()===_()),pe)),te})()}})}}),null),X(ue=>d(ne,O,ue)),ne}}),null),X(ne=>{var ue=w,L=I,A=y,U=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),te=t.disabled;return ne.e=d(M,ue,ne.e),ne.t=d(G,L,ne.t),ne.a=d(le,A,ne.a),U!==ne.o&&ct(le,"placeholder",ne.o=U),te!==ne.i&&(le.disabled=ne.i=te),ne},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),X(()=>le.value=r()),M})()};wt(["input","keydown","click"]);var jA=z("<div><div><h2></h2><div><div>"),qA=z("<div><span>"),GA=z("<span> "),HA=z("<div><div><div><div><h3></h3><span></span></div><div></div><div>: </div></div><div><div></div><div>  <!>: </div><div>: "),WA=z("<div><div>:</div><div>"),YA=z("<div>: "),KA=z("<div><div><span>:</span><select><option value=10>10</option><option value=20>20</option><option value=50>50</option><option value=100>100</option></select></div><div><div><span></span><input type=number min=1><span> </span></div></div><div>");const og=()=>{const{t}=ft(),[e,r]=ye(""),[n,o]=ye(""),[s,a]=ye([]),[l,u]=ye(!1),[h,m]=ye(null),[v,_]=ye(!1),[x,T]=ye(!1),[E,P]=ye(!1),[R,Y]=ye(null),[Z,j]=ye(!1),[B,V]=ye([]),[f,g]=ye(!1),[S,$]=ye(1),[w,I]=ye(20);$r(async()=>{await y()});const y=async()=>{try{u(!0),m(null);try{const M=await Ru.getAll();a(M.map(G=>({id:G.id||`prod-${Date.now()}-${Math.random()}`,name:G.productName||G.name||"Unknown Product",sku:G.sku||G.productCode||"",description:G.description||"",category:G.category||"General",unitOfMeasure:G.unitOfMeasure||"pcs",unitCost:parseFloat(G.unitCost||G.cost||"0"),sellingPrice:parseFloat(G.sellingPrice||G.price||"0"),minStockLevel:parseInt(G.minStockLevel||"0"),maxStockLevel:parseInt(G.maxStockLevel||"100"),isActive:G.isActive!==!1,createdDate:G.createdDate||new Date().toISOString(),lastModified:G.lastModified||new Date().toISOString(),businessId:G.businessId||"YB100423253156428"})))}catch(M){console.warn("API failed, using local store:",M),a(Le.products)}}catch(M){m(M instanceof Error?M.message:"Failed to load products")}finally{u(!1)}},de=async()=>{try{u(!0),m(null);try{const M=await Jr.getProducts("prod"),G=Object.keys(M),le=ue=>{let A=M[ue];return{id:A.id,name:A.name,businessId:A.businessId,sku:A.code,numCode:A.codeN,category:A.category,unitCost:A.unitCost||0,unitOfMeasure:A.unitOfMeasure,minStockLevel:A.minStockLevel,maxStockLevel:A.maxStockLevel,isActive:A.isActive,description:A.description||"",createdDate:A.createdAt||new Date().toISOString(),lastModified:A.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(A.sellingPrice||A.price||"0")}},ne=G.map(le);a(ne)}catch(M){console.warn("API failed, using local store:",M),a(Le.products)}}catch(M){m(M instanceof Error?M.message:"Failed to load products")}finally{u(!1)}},{cancel:J}=_A(async M=>{if(!M.trim()){await y();return}try{m(null);const G=await Ru.getAll(M);a(G.map(le=>({id:le.id||`prod-${Date.now()}-${Math.random()}`,name:le.productName||le.name||"Unknown Product",sku:le.sku||le.productCode||"",description:le.description||"",category:le.category||"General",unitOfMeasure:le.unitOfMeasure||"pcs",unitCost:parseFloat(le.unitCost||le.cost||"0"),sellingPrice:parseFloat(le.sellingPrice||le.price||"0"),minStockLevel:parseInt(le.minStockLevel||"0"),maxStockLevel:parseInt(le.maxStockLevel||"100"),isActive:le.isActive!==!1,createdDate:le.createdDate||new Date().toISOString(),lastModified:le.lastModified||new Date().toISOString(),businessId:le.businessId||"YB100423253156428"})))}catch(G){m(G instanceof Error?G.message:"Search failed");const le=Le.products.filter(ne=>ne.name.toLowerCase().includes(M.toLowerCase())||ne.sku.toLowerCase().includes(M.toLowerCase())||ne.category.toLowerCase().includes(M.toLowerCase()));a(le)}},300);Ai(()=>{J()}),Ze(()=>{let M=s();return n()&&(M=M.filter(G=>G.category===n())),M}),Ze(()=>[...new Set(s().map(G=>G.category))].sort()),Ze(()=>{const M=s().filter(ne=>ne.isActive),G=s().length,le=s().filter(ne=>Le.getTotalStockByProduct(ne.id)===0);return{total:G,active:M.length,outOfStock:le.length}});const O=M=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(M),N={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},q={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},D=M=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:M?"#ffebee":"#e8f5e8",color:M?"#d32f2f":"#2d7d32"});Ze(()=>{const M=Le.products||[],G=Le.movements||[],le=Le.stockLevels||[],ne=Le.getLowStockProducts(),ue=M?.length||0,L=M?.filter(te=>te.isActive).length,A=le.reduce((te,ae)=>te*1+ae.quantity*1*ae.averageCost*1,0),U=G?.filter(te=>{const ae=new Date(te.createdDate),re=new Date;return ae.getMonth()===re.getMonth()&&ae.getFullYear()===re.getFullYear()}).length;return{totalProducts:ue,activeProducts:L,lowStockProducts:ne.length,totalStockValue:A,totalMovementsThisMonth:U,totalLocations:Le.locations.length,activeLocations:Le.getActiveLocations().length}});const C=Ze(()=>Le.products.map(M=>{const G=Le.getStockByProduct(M.id),le=Le.getTotalStockByProduct(M.id),ne=Le.getLastLocationByProduct(M.id);return{...M,totalStock:le,stockByLocation:G,lastLocation:ne,isLowStock:le<=M.minStockLevel}})),F=Ze(()=>B().map(M=>{const G=Le.getStockByProduct(M.id),le=Le.getTotalStockByProduct(M.id),ne=Le.getLastLocationByProduct(M.id);return{...M,totalStock:le,stockByLocation:G,lastLocation:ne,isLowStock:le<=M.minStockLevel}})),ee=Ze(()=>{const M=f()?F():C(),G=(S()-1)*w(),le=G+w();return M.slice(G,le)}),H=Ze(()=>{const M=f()?F():C();return Math.ceil(M.length/w())}),oe=M=>{Y(M),T(!0)};return b(an,{get title(){return t("products.title","Products")},get children(){return[(()=>{var M=jA(),G=M.firstChild,le=G.firstChild,ne=le.nextSibling,ue=ne.firstChild;return M.style.setProperty("display","flex"),M.style.setProperty("justify-content","space-between"),M.style.setProperty("align-items","flex-start"),M.style.setProperty("margin-bottom","1.5rem"),M.style.setProperty("flex-wrap","wrap"),M.style.setProperty("gap","1rem"),G.style.setProperty("flex","1"),G.style.setProperty("min-width","300px"),le.style.setProperty("margin","0 0 1rem 0"),le.style.setProperty("font-size","1.5rem"),i(le,()=>t("inventory.products")),ne.style.setProperty("display","flex"),ne.style.setProperty("gap","1rem"),ne.style.setProperty("align-items","center"),ne.style.setProperty("flex-wrap","wrap"),ue.style.setProperty("flex","1"),ue.style.setProperty("min-width","250px"),i(ue,b(zA,{onSearchResults:L=>{V(L),g(L.length>0)},get placeholder(){return t("inventory.searchProductsStock","Search products and check stock levels...")},showResults:!1,maxResults:20})),i(ne,b(qe,{variant:"outline",onClick:()=>{de(),g(!1)},get children(){return[" ",ge(()=>t("common.showAll","Show All"))]}}),null),i(M,b(Ae,{get when(){return Lt.hasPermission("read_write")},get children(){return b(qe,{variant:"primary",onClick:()=>j(!0),get children(){return[" ",ge(()=>t("inventory.addProduct"))]}})}}),null),M})(),(()=>{var M=qA(),G=M.firstChild;return M.style.setProperty("margin-bottom","1rem"),M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","var(--text-muted)"),M.style.setProperty("display","flex"),M.style.setProperty("justify-content","space-between"),M.style.setProperty("align-items","center"),i(G,(()=>{var le=ge(()=>!!f());return()=>le()?`${t("inventory.searchResults","Search Results")}: ${F().length} ${t("common.products","products")}`:`${t("inventory.totalProducts","Total Products")}: ${C().length} ${t("common.products","products")}`})()),i(M,(()=>{var le=ge(()=>!!f());return()=>le()&&(()=>{var ne=GA();return ne.firstChild,ne.style.setProperty("color","var(--primary-color)"),i(ne,()=>t("inventory.filtered","Filtered view"),null),ne})()})(),null),M})(),b(ut,{get each(){return ee()},children:M=>(()=>{var G=HA(),le=G.firstChild,ne=le.firstChild,ue=ne.firstChild,L=ue.firstChild,A=L.nextSibling,U=ue.nextSibling,te=U.nextSibling,ae=te.firstChild,re=ne.nextSibling,ce=re.firstChild,Q=ce.nextSibling,me=Q.firstChild,K=me.nextSibling;K.nextSibling;var he=Q.nextSibling,ve=he.firstChild;return G.$$click=()=>oe(M),G.addEventListener("mouseleave",W=>{W.currentTarget.style.transform="translateY(0)",W.currentTarget.style.boxShadow="none"}),G.addEventListener("mouseenter",W=>{W.currentTarget.style.transform="translateY(-2px)",W.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),d(G,N),d(le,q),ue.style.setProperty("display","flex"),ue.style.setProperty("align-items","center"),ue.style.setProperty("gap","0.5rem"),ue.style.setProperty("margin-bottom","0.5rem"),L.style.setProperty("margin","0"),L.style.setProperty("font-size","1.1rem"),i(L,()=>M.name),i(A,(()=>{var W=ge(()=>!!M.isLowStock);return()=>W()?t("inventory.lowStockAlert"):t("inventory.inStock")})()),U.style.setProperty("font-size","0.875rem"),U.style.setProperty("color","var(--text-muted)"),i(U,()=>M.sku,null),i(U,()=>M.UPC?"  "+M.UPC:"",null),i(U,()=>M.category?"  "+M.category:"",null),te.style.setProperty("font-size","0.875rem"),te.style.setProperty("color","var(--text-muted)"),i(te,()=>t("inventory.lastSeen"),ae),i(te,()=>M.lastLocation?.name||t("inventory.noMovements"),null),re.style.setProperty("text-align","right"),ce.style.setProperty("font-size","1.25rem"),ce.style.setProperty("font-weight","700"),ce.style.setProperty("color","var(--primary-color)"),i(ce,()=>M.totalStock),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),i(Q,()=>M.unitOfMeasure,me),i(Q,()=>t("inventory.min"),K),i(Q,()=>M.minStockLevel,null),he.style.setProperty("font-size","0.875rem"),he.style.setProperty("color","var(--text-muted)"),i(he,()=>t("inventory.cost"),ve),i(he,()=>O(M.unitCost),null),i(G,(()=>{var W=ge(()=>M.stockByLocation.length>0);return()=>W()&&(()=>{var ie=WA(),Pe=ie.firstChild,_e=Pe.firstChild,fe=Pe.nextSibling;return ie.style.setProperty("margin-top","1rem"),Pe.style.setProperty("font-weight","500"),Pe.style.setProperty("margin-bottom","0.5rem"),Pe.style.setProperty("font-size","0.875rem"),i(Pe,()=>t("inventory.stockByLocation"),_e),fe.style.setProperty("display","flex"),fe.style.setProperty("flex-wrap","wrap"),fe.style.setProperty("gap","0.5rem"),i(fe,b(ut,{get each(){return M.stockByLocation},children:be=>{const pe=Le.getLocationById(be.locationId);return(()=>{var we=YA(),De=we.firstChild;return we.style.setProperty("padding","0.25rem 0.5rem"),we.style.setProperty("background","var(--background-color)"),we.style.setProperty("border-radius","var(--border-radius-sm)"),we.style.setProperty("font-size","0.75rem"),we.style.setProperty("border","1px solid var(--border-color)"),i(we,()=>pe?.name,De),i(we,()=>be.quantity,null),we})()}})),ie})()})(),null),X(W=>d(A,D(M.isLowStock),W)),G})()}),ge(()=>ge(()=>H()>1)()&&(()=>{var M=KA(),G=M.firstChild,le=G.firstChild,ne=le.firstChild,ue=le.nextSibling,L=G.nextSibling,A=L.firstChild,U=A.firstChild,te=U.nextSibling,ae=te.nextSibling,re=ae.firstChild,ce=L.nextSibling;return M.style.setProperty("display","flex"),M.style.setProperty("justify-content","space-between"),M.style.setProperty("align-items","center"),M.style.setProperty("margin-top","2rem"),M.style.setProperty("padding","1rem"),M.style.setProperty("background","var(--surface-color)"),M.style.setProperty("border-radius","var(--border-radius)"),M.style.setProperty("border","1px solid var(--border-color)"),G.style.setProperty("display","flex"),G.style.setProperty("align-items","center"),G.style.setProperty("gap","0.5rem"),le.style.setProperty("font-size","0.875rem"),le.style.setProperty("color","var(--text-muted)"),i(le,()=>t("common.showPerPage","Show per page"),ne),ue.addEventListener("change",Q=>{I(parseInt(Q.target.value)),$(1)}),ue.style.setProperty("padding","0.25rem 0.5rem"),ue.style.setProperty("border","1px solid var(--border-color)"),ue.style.setProperty("border-radius","var(--border-radius-sm)"),ue.style.setProperty("background","var(--background-color)"),ue.style.setProperty("cursor","pointer"),L.style.setProperty("display","flex"),L.style.setProperty("align-items","center"),L.style.setProperty("gap","0.5rem"),i(L,b(qe,{variant:"outline",size:"sm",onClick:()=>$(1),get disabled(){return S()===1},get children(){return t("common.first","First")}}),A),i(L,b(qe,{variant:"outline",size:"sm",onClick:()=>$(Q=>Math.max(1,Q-1)),get disabled(){return S()===1},get children(){return t("common.previous","Previous")}}),A),A.style.setProperty("display","flex"),A.style.setProperty("align-items","center"),A.style.setProperty("gap","0.25rem"),U.style.setProperty("font-size","0.875rem"),i(U,()=>t("common.page","Page")),te.addEventListener("change",Q=>{const me=parseInt(Q.target.value);me>=1&&me<=H()&&$(me)}),te.style.setProperty("width","60px"),te.style.setProperty("padding","0.25rem 0.5rem"),te.style.setProperty("border","1px solid var(--border-color)"),te.style.setProperty("border-radius","var(--border-radius-sm)"),te.style.setProperty("text-align","center"),te.style.setProperty("font-size","0.875rem"),ae.style.setProperty("font-size","0.875rem"),i(ae,()=>t("common.of","of"),re),i(ae,H,null),i(L,b(qe,{variant:"outline",size:"sm",onClick:()=>$(Q=>Math.min(H(),Q+1)),get disabled(){return S()===H()},get children(){return t("common.next","Next")}}),null),i(L,b(qe,{variant:"outline",size:"sm",onClick:()=>$(H()),get disabled(){return S()===H()},get children(){return t("common.last","Last")}}),null),ce.style.setProperty("font-size","0.875rem"),ce.style.setProperty("color","var(--text-muted)"),i(ce,()=>{const Q=f()?F():C(),me=(S()-1)*w()+1,K=Math.min(S()*w(),Q.length);return t("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:me,end:K,total:Q.length})}),X(()=>ct(te,"max",H())),X(()=>ue.value=w()),X(()=>te.value=S()),M})()),b(ru,{get isOpen(){return v()},onClose:()=>_(!1),onProductAdded:()=>{y()}}),b(LA,{get isOpen(){return x()},onClose:()=>{T(!1),Y(null)},get product(){return R()},onEdit:()=>{T(!1),P(!0)}})]}})};wt(["click"]);var QA=z("<div><div></div><div>"),JA=z("<div><div><img></div><div>X</div><div><div><h2></h2><div></div></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),XA=z("<div>"),ZA=z("<div><div></div><h3></h3><p>"),e2=z("<div><div>"),t2=z("<div>"),r2=z("<div><div><img loading=lazy></div><div><div></div><div>  </div><div></div><div>",!0,!1,!1);const n2=t=>{const{t:e}=ft(),[r,n]=ye(null),[o,s]=ye([]),[a,l]=ye(!1),u=N=>{n(N),t.onProductSelect?.(N)},h=()=>{n(null),t.onProductSelect?.(null),s([]),l(!1)},m=N=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(N),v=()=>"YABABYSSolution",_=()=>"https://qvamarkets.s3.us-east-2.amazonaws.com/V2_images/7258/",x=N=>{if(N.productImageUrl)return _()+v()+"/"+N?.productImageUrl;const q={Electronics:"https://via.placeholder.com/400x300/4F46E5/FFFFFF?text=Electronics",Furniture:"https://via.placeholder.com/400x300/059669/FFFFFF?text=Furniture",Food:"https://via.placeholder.com/400x300/DC2626/FFFFFF?text=Food",Clothing:"https://via.placeholder.com/400x300/7C3AED/FFFFFF?text=Clothing",Tools:"https://via.placeholder.com/400x300/EA580C/FFFFFF?text=Tools",General:"https://via.placeholder.com/400x300/6B7280/FFFFFF?text=Product"};return q[N.category]||q.General},T={padding:"2rem"},E={"max-width":"600px",margin:"0 auto 2rem",position:"relative"},P={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},R={background:"var(--surface-color)","border-radius":"var(--border-radius)",overflow:"hidden","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.3s ease"},Y={position:"relative",width:"100%",height:"200px",overflow:"hidden",background:"#f5f5f5"},Z={width:"100%",height:"100%","object-fit":"cover",transition:"transform 0.3s ease"},j={padding:"1rem"},B={"font-size":"1rem","font-weight":"600","margin-bottom":"0.5rem",color:"var(--text-primary)",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},V={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.25rem"},f={"font-size":"1.25rem","font-weight":"700",color:"var(--primary-color)","margin-top":"0.5rem"},g={display:"flex",gap:"2rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"2rem","box-shadow":"var(--shadow-md)","margin-bottom":"2rem",position:"relative"},S={width:"400px",height:"300px","border-radius":"var(--border-radius)",overflow:"hidden",background:"#f5f5f5"},$={flex:"1",display:"flex","flex-direction":"column",gap:"1rem"},w={display:"flex","justify-content":"space-between","padding-bottom":"0.5rem","border-bottom":"1px solid var(--border-light)"},I={"font-weight":"500",color:"var(--text-muted)"},y={"font-weight":"600",color:"var(--text-primary)"},de=N=>({display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"600",background:"#d4edda",color:"#155724"}),J={"text-align":"center",padding:"4rem 2rem",color:"var(--text-muted)"},O={"font-size":"3rem","margin-bottom":"1rem",opacity:"0.5"};return(()=>{var N=e2(),q=N.firstChild;return d(N,T),i(q,b(_l,{onChange:D=>{console.log(D);let C=D;l(!0),u(C)},get placeholder(){return e("inventory.searchProductsImages","Search products to view images...")}})),i(N,b(Ae,{get when(){return r()&&t.showDetails!==!1},get children(){var D=JA(),C=D.firstChild,F=C.firstChild,ee=C.nextSibling,H=ee.nextSibling,oe=H.firstChild,M=oe.firstChild,G=M.nextSibling,le=oe.nextSibling,ne=le.firstChild,ue=ne.nextSibling,L=le.nextSibling,A=L.firstChild,U=A.nextSibling,te=L.nextSibling,ae=te.firstChild,re=ae.nextSibling,ce=te.nextSibling,Q=ce.firstChild,me=Q.nextSibling,K=ce.nextSibling,he=K.firstChild,ve=he.nextSibling;return d(D,g),d(C,S),F.style.setProperty("width","100%"),F.style.setProperty("height","100%"),F.style.setProperty("object-fit","contain"),F.style.setProperty("aspect-ratio","1 / 1"),ee.$$click=()=>{h()},ee.style.setProperty("position","absolute"),ee.style.setProperty("top","0.5rem"),ee.style.setProperty("right","0.5rem"),ee.style.setProperty("color","#3d3d3d"),ee.style.setProperty("border-radius","50%"),ee.style.setProperty("width","2rem"),ee.style.setProperty("height","2rem"),ee.style.setProperty("display","flex"),ee.style.setProperty("align-items","center"),ee.style.setProperty("justify-content","center"),ee.style.setProperty("font-size","1.25rem"),ee.style.setProperty("box-shadow","var(--shadow-sm)"),ee.style.setProperty("cursor","pointer"),d(H,$),M.style.setProperty("margin","0 0 0.5rem 0"),M.style.setProperty("font-size","1.5rem"),i(M,()=>r().name),i(G,()=>e("products.inStock","In Stock")),i(ne,()=>e("products.sku","SKU")),i(ue,()=>r().sku),i(A,()=>e("inventory.category","Category")),i(U,()=>r().category),i(ae,()=>e("inventory.unitOfMeasure","Unit")),i(re,()=>r().unitOfMeasure),i(Q,()=>e("inventory.unitCost","Cost")),i(me,()=>m(r().unitCost)),i(he,()=>e("inventory.UPC","UPC")),i(ve,()=>r().UPC),i(H,b(Ae,{get when(){return r().description},get children(){var W=QA(),ie=W.firstChild,Pe=ie.nextSibling;return W.style.setProperty("margin-top","1rem"),i(ie,()=>e("common.description","Description")),Pe.style.setProperty("margin-top","0.5rem"),Pe.style.setProperty("color","var(--text-primary)"),i(Pe,()=>r().description),X(_e=>d(ie,I,_e)),W}}),null),X(W=>{var ie=x(r()),Pe=r().name,_e=de(),fe=w,be=I,pe=y,we=w,De=I,ke=y,Te=w,Ue=I,Xe=y,ze=w,$e=I,Ge=y,ot=w,je=I,Ce=y;return ie!==W.e&&ct(F,"src",W.e=ie),Pe!==W.t&&ct(F,"alt",W.t=Pe),W.a=d(G,_e,W.a),W.o=d(le,fe,W.o),W.i=d(ne,be,W.i),W.n=d(ue,pe,W.n),W.s=d(L,we,W.s),W.h=d(A,De,W.h),W.r=d(U,ke,W.r),W.d=d(te,Te,W.d),W.l=d(ae,Ue,W.l),W.u=d(re,Xe,W.u),W.c=d(ce,ze,W.c),W.w=d(Q,$e,W.w),W.m=d(me,Ge,W.m),W.f=d(K,ot,W.f),W.y=d(he,je,W.y),W.g=d(ve,Ce,W.g),W},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),D}}),null),i(N,b(Ae,{get when(){return o().length>0},get children(){var D=XA();return d(D,P),i(D,b(ut,{get each(){return o()},children:C=>(()=>{var F=r2(),ee=F.firstChild,H=ee.firstChild,oe=ee.nextSibling,M=oe.firstChild,G=M.nextSibling,le=G.firstChild,ne=G.nextSibling,ue=ne.nextSibling;return F.addEventListener("mouseleave",L=>{L.currentTarget.style.transform="translateY(0)",L.currentTarget.style.boxShadow="var(--shadow-sm)";const A=L.currentTarget.querySelector("img");A&&(A.style.transform="scale(1)")}),F.addEventListener("mouseenter",L=>{L.currentTarget.style.transform="translateY(-4px)",L.currentTarget.style.boxShadow="var(--shadow-lg)";const A=L.currentTarget.querySelector("img");A&&(A.style.transform="scale(1.05)")}),F.$$click=()=>u(C),d(F,R),i(ee,b(Ae,{get when(){return C===r()},get children(){var L=t2();return L.style.setProperty("position","absolute"),L.style.setProperty("top","0.5rem"),L.style.setProperty("right","0.5rem"),L.style.setProperty("background","var(--primary-color)"),L.style.setProperty("color","white"),L.style.setProperty("border-radius","50%"),L.style.setProperty("width","2rem"),L.style.setProperty("height","2rem"),L.style.setProperty("display","flex"),L.style.setProperty("align-items","center"),L.style.setProperty("justify-content","center"),L.style.setProperty("font-size","1.25rem"),L}}),null),d(oe,j),i(M,()=>C.name),i(G,()=>C.sku,le),i(G,()=>C.category,null),i(ne,()=>C.unitOfMeasure),d(ue,f),i(ue,()=>m(C.sellingPrice)),X(L=>{var A=Y,U=x(C),te=C.name,ae=Z,re=B,ce=C.name,Q=V,me=V;return L.e=d(ee,A,L.e),U!==L.t&&ct(H,"src",L.t=U),te!==L.a&&ct(H,"alt",L.a=te),L.o=d(H,ae,L.o),L.i=d(M,re,L.i),ce!==L.n&&ct(M,"title",L.n=ce),L.s=d(G,Q,L.s),L.h=d(ne,me,L.h),L},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),F})()})),D}}),null),i(N,b(Ae,{get when(){return!r()},get children(){var D=ZA(),C=D.firstChild,F=C.nextSibling,ee=F.nextSibling;return d(C,O),F.style.setProperty("margin-bottom","0.5rem"),i(F,()=>e("inventory.noProductsFound","No Products Found")),i(ee,()=>e("inventory.tryDifferentSearch","Try a different search term")),X(H=>d(D,J,H)),D}}),null),X(D=>d(q,E,D)),N})()};wt(["click"]);var o2=z("<div><div></div><div></div><div>"),Em=z("<div>"),i2=z("<div><div><div><h2> - </h2><button></button></div><div>"),s2=z("<div><div><div><div><h3></h3><span></span></div><div></div></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>");const a2=t=>{const{t:e}=ft(),[r,n]=ye(""),[o,s]=ye(!1),a=Ze(()=>{const T=Le.movements,E=new Map;return T.forEach(P=>{const R=P.referenceNumber||P.invoiceId||P.ssg_inventory_key||"UNKNOWN";E.has(R)||E.set(R,{referenceNumber:R,movements:[],totalItems:0,totalValue:0,createdDate:P.createdDate,movementType:P.movementType});const Y=E.get(R);Y.movements.push(P),Y.totalItems+=P.quantity,Y.totalValue+=P.totalCost,new Date(P.createdDate)<new Date(Y.createdDate)&&(Y.createdDate=P.createdDate)}),Array.from(E.values()).filter(P=>P.movements.length>1).sort((P,R)=>new Date(R.createdDate).getTime()-new Date(P.createdDate).getTime())}),l=Ze(()=>{const T=a().find(E=>E.referenceNumber===r());return T?T.movements:[]}),u=T=>{n(T),s(!0)},h=()=>{s(!1),n("")},m=T=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(T),v=T=>new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),_=T=>({in:e("inventory.purchaseReceive"),out:e("inventory.saleIssue"),transfer:e("inventory.transfer"),adjustment:e("inventory.adjustment")})[T]||T,x=T=>({in:"#4caf50",out:"#f44336",transfer:"#2196f3",adjustment:"#ff9800"})[T]||"#666";return[b(Ar,{get isOpen(){return ge(()=>!!t.isOpen)()&&!o()},get onClose(){return t.onClose},get title(){return e("inventory.viewHistoricalReports")},size:"large",get children(){var T=Em();return T.style.setProperty("max-height","70vh"),T.style.setProperty("overflow-y","auto"),i(T,b(Ae,{get when(){return a().length===0},get children(){var E=o2(),P=E.firstChild,R=P.nextSibling,Y=R.nextSibling;return E.style.setProperty("text-align","center"),E.style.setProperty("padding","3rem"),E.style.setProperty("color","var(--text-muted)"),P.style.setProperty("font-size","2rem"),P.style.setProperty("margin-bottom","1rem"),R.style.setProperty("font-size","1.1rem"),R.style.setProperty("margin-bottom","0.5rem"),i(R,()=>e("inventory.noBulkReportsFound","No bulk movement reports found")),Y.style.setProperty("font-size","0.9rem"),i(Y,()=>e("inventory.bulkReportsAppearHere","Bulk movement reports will appear here after you create bulk movements")),E}}),null),i(T,b(Ae,{get when(){return a().length>0},get children(){var E=Em();return E.style.setProperty("display","grid"),E.style.setProperty("gap","1rem"),i(E,b(ut,{get each(){return a()},children:P=>(()=>{var R=s2(),Y=R.firstChild,Z=Y.firstChild,j=Z.firstChild,B=j.firstChild,V=B.nextSibling,f=j.nextSibling,g=Y.nextSibling,S=g.firstChild,$=S.firstChild,w=$.nextSibling,I=S.nextSibling,y=I.firstChild,de=y.nextSibling,J=I.nextSibling,O=J.firstChild,N=O.nextSibling;return R.style.setProperty("padding","1.5rem"),R.style.setProperty("border","1px solid var(--border-color)"),R.style.setProperty("border-radius","var(--border-radius)"),R.style.setProperty("background","var(--surface-color)"),R.style.setProperty("transition","all 0.2s ease"),Y.style.setProperty("display","flex"),Y.style.setProperty("justify-content","space-between"),Y.style.setProperty("align-items","flex-start"),Y.style.setProperty("margin-bottom","1rem"),Z.style.setProperty("flex","1"),j.style.setProperty("display","flex"),j.style.setProperty("align-items","center"),j.style.setProperty("gap","1rem"),j.style.setProperty("margin-bottom","0.5rem"),B.style.setProperty("margin","0"),B.style.setProperty("font-size","1.1rem"),B.style.setProperty("color","var(--text-primary)"),i(B,()=>P.referenceNumber),V.style.setProperty("padding","0.25rem 0.75rem"),V.style.setProperty("border-radius","1rem"),V.style.setProperty("font-size","0.75rem"),V.style.setProperty("font-weight","500"),i(V,()=>_(P.movementType)),f.style.setProperty("color","var(--text-muted)"),f.style.setProperty("font-size","0.875rem"),i(f,()=>v(P.createdDate)),i(Y,b(qe,{variant:"outline",size:"sm",onClick:()=>u(P.referenceNumber),get children(){return e("common.view")}}),null),g.style.setProperty("display","grid"),g.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),g.style.setProperty("gap","1rem"),g.style.setProperty("margin-bottom","1rem"),$.style.setProperty("font-size","0.75rem"),$.style.setProperty("font-weight","500"),$.style.setProperty("text-transform","uppercase"),$.style.setProperty("color","var(--text-muted)"),$.style.setProperty("margin-bottom","0.25rem"),i($,()=>e("inventory.totalProducts")),w.style.setProperty("font-size","1.25rem"),w.style.setProperty("font-weight","600"),w.style.setProperty("color","var(--primary-color)"),i(w,()=>P.movements.length),y.style.setProperty("font-size","0.75rem"),y.style.setProperty("font-weight","500"),y.style.setProperty("text-transform","uppercase"),y.style.setProperty("color","var(--text-muted)"),y.style.setProperty("margin-bottom","0.25rem"),i(y,()=>e("inventory.totalItems")),de.style.setProperty("font-size","1.25rem"),de.style.setProperty("font-weight","600"),de.style.setProperty("color","var(--primary-color)"),i(de,()=>P.totalItems),O.style.setProperty("font-size","0.75rem"),O.style.setProperty("font-weight","500"),O.style.setProperty("text-transform","uppercase"),O.style.setProperty("color","var(--text-muted)"),O.style.setProperty("margin-bottom","0.25rem"),i(O,()=>e("inventory.estimatedValue")),N.style.setProperty("font-size","1.25rem"),N.style.setProperty("font-weight","600"),N.style.setProperty("color","var(--primary-color)"),i(N,()=>m(P.totalValue)),X(q=>{var D=x(P.movementType)+"20",C=x(P.movementType);return D!==q.e&&((q.e=D)!=null?V.style.setProperty("background",D):V.style.removeProperty("background")),C!==q.t&&((q.t=C)!=null?V.style.setProperty("color",C):V.style.removeProperty("color")),q},{e:void 0,t:void 0}),R})()})),E}}),null),T}}),b(Ae,{get when(){return o()},get children(){var T=i2(),E=T.firstChild,P=E.firstChild,R=P.firstChild,Y=R.firstChild,Z=R.nextSibling,j=P.nextSibling;return T.style.setProperty("position","fixed"),T.style.setProperty("top","0"),T.style.setProperty("left","0"),T.style.setProperty("right","0"),T.style.setProperty("bottom","0"),T.style.setProperty("background","rgba(0, 0, 0, 0.5)"),T.style.setProperty("z-index","1000"),T.style.setProperty("display","flex"),T.style.setProperty("align-items","center"),T.style.setProperty("justify-content","center"),T.style.setProperty("padding","2rem"),E.style.setProperty("background","white"),E.style.setProperty("border-radius","var(--border-radius)"),E.style.setProperty("width","95%"),E.style.setProperty("max-width","1200px"),E.style.setProperty("max-height","90vh"),E.style.setProperty("overflow-y","auto"),E.style.setProperty("position","relative"),P.style.setProperty("padding","1rem 2rem"),P.style.setProperty("border-bottom","1px solid #e9ecef"),P.style.setProperty("display","flex"),P.style.setProperty("justify-content","space-between"),P.style.setProperty("align-items","center"),P.style.setProperty("background","#f8f9fa"),R.style.setProperty("margin","0"),i(R,()=>e("inventory.bulkMovementReport"),Y),i(R,r,null),Z.$$click=h,Z.style.setProperty("background","none"),Z.style.setProperty("border","none"),Z.style.setProperty("font-size","1.5rem"),Z.style.setProperty("cursor","pointer"),Z.style.setProperty("padding","0.5rem"),Z.style.setProperty("line-height","1"),j.style.setProperty("padding","1rem"),i(j,b(ng,{get movements(){return l()},onClose:h})),T}})]};wt(["click"]);var l2=z("<div><h1></h1><div>"),Qr=z("<div>"),c2=z("<div><h3></h3><div>"),d2=z("<div>: <!> "),u2=z("<div><button></button><button></button><button></button><button>"),h2=z("<div><div>"),m2=z("<div><span> (<!>)</span><span> / <!> "),y2=z("<div><div><h2></h2></div><div>"),p2=z("<div><div><div><span></span><h3></h3></div><div>  </div><div></div></div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div>:"),f2=z("<div><div><div><div></div><div></div></div><div><div> </div><div></div><div>Min: "),g2=z("<span> LOW");const v2=()=>{const{t}=ft(),[e,r]=ye(!1),[n,o]=ye(!1),[s,a]=ye(!1),[l,u]=ye(null),[h,m]=ye("overview"),[v,_]=ye("new"),[x,T]=ye(""),[E,P]=ye(""),[R,Y]=ye([]),[Z,j]=ye(!1),[B,V]=ye(!1),[f,g]=ye(!1),[S,$]=ye(!1),[w,I]=ye(!1),[y,de]=ye(!1),[J,O]=ye(1),[N,q]=ye(20),D=me=>{u(me),a(!0)},C=Ze(()=>{const me=Le.products||[],K=Le.movements||[],he=Le.stockLevels||[],ve=Le.getLowStockProducts(),W=me?.length||0,ie=me?.filter(fe=>fe.isActive).length,Pe=he.reduce((fe,be)=>fe*1+be.quantity*1*be.averageCost*1,0),_e=K?.filter(fe=>{const be=new Date(fe.createdDate),pe=new Date;return be.getMonth()===pe.getMonth()&&be.getFullYear()===pe.getFullYear()}).length;return{totalProducts:W,activeProducts:ie,lowStockProducts:ve.length,totalStockValue:Pe,totalMovementsThisMonth:_e,totalLocations:Le.locations.length,activeLocations:Le.getActiveLocations().length}});Ze(()=>Le.products.map(me=>{const K=Le.getStockByProduct(me.id),he=Le.getTotalStockByProduct(me.id),ve=Le.getLastLocationByProduct(me.id);return{...me,totalStock:he,stockByLocation:K,lastLocation:ve,isLowStock:he<=me.minStockLevel}})),Ze(()=>{B(),O(1)});const F=(me,K)=>me<=K?t("inventory.lowStockAlert"):me<=K*2?t("inventory.normalStock"):t("inventory.inStock"),ee=me=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(me),H=me=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(me),oe=me=>{switch(me){case"warehouse":return t("inventory.warehouse");case"store":return t("inventory.store");case"supplier":return t("inventory.supplier");case"customer":return t("inventory.customer");default:return me}},M={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},G={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},le=me=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500",background:me>50?"#d4edda":me>20?"#fff3cd":"#f8d7da",color:me>50?"#155724":me>20?"#856404":"#721c24"}),ne={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},ue={color:"var(--text-muted)","font-size":"0.875rem"},L={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},A={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},U={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},te=me=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:me?"var(--primary-color)":"var(--text-muted)","border-bottom":me?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),ae={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem","margin-bottom":"2rem"},re={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},ce=Ze(()=>{const me=Le.movements;return{total:me.length,stockIn:me.filter(K=>K.movementType==="in").length,stockOut:me.filter(K=>K.movementType==="out").length,transfers:me.filter(K=>K.movementType==="transfer").length,adjustments:me.filter(K=>K.movementType==="adjustment").length,totalValue:me.reduce((K,he)=>K+he.totalCost,0)}}),Q=async()=>{let me="prod";setTimeout(async()=>{await Le.getStockLevels("YY_")},2300),id.calcStockLevels(),await Le.fecthProduct(me),await Le.fecthInventory(me)};return $r(()=>{Q()}),b(an,{get title(){return t("inventory.title")},get children(){return[(()=>{var me=l2(),K=me.firstChild,he=K.nextSibling;return d(me,A),K.style.setProperty("margin","0"),K.style.setProperty("font-size","1.75rem"),he.style.setProperty("display","flex"),he.style.setProperty("align-items","center"),he.style.setProperty("gap","1rem"),i(he,(()=>{var ve=ge(()=>v()==="new");return()=>ve()&&b(qe,{variant:"outline",onClick:()=>I(!0),get children(){return[" ",ge(()=>t("inventory.physicalCount","Physical Count"))]}})})(),null),i(he,b(Ae,{get when(){return Lt.hasPermission("read_write")},get children(){return[b(qe,{variant:"outline",onClick:()=>de(!0),get children(){return[" ",ge(()=>t("inventory.viewHistoricalReports"))]}}),b(qe,{variant:"primary",onClick:()=>o(!0),get children(){return ge(()=>v()==="new")()?t("inventory.addMovement"):t("common.add")}})]}}),null),me})(),b(n2,{}),b(Ae,{get when(){return Lt.hasPermission("inventoryDownsection")},get children(){return ge(()=>v()==="legacy")()?[(()=>{var me=Qr();return i(me,b(rt,{get title(){return t("inventory.totalItems")},get subtitle(){return t("inventory.inStock")},get children(){var K=Qr();return K.style.setProperty("font-size","1.5rem"),K.style.setProperty("font-weight","600"),K.style.setProperty("color","var(--primary-color)"),i(K,()=>Le.inventory.length),K}}),null),i(me,b(rt,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.itemsBelowThreshold")},get children(){var K=Qr();return K.style.setProperty("font-size","1.5rem"),K.style.setProperty("font-weight","600"),K.style.setProperty("color","var(--primary-color)"),i(K,()=>Le.getLowStockItems().length),K}}),null),i(me,b(rt,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.inventoryWorth")},get children(){var K=Qr();return K.style.setProperty("font-size","1.5rem"),K.style.setProperty("font-weight","600"),K.style.setProperty("color","var(--primary-color)"),i(K,()=>ee(Le.getTotalValue())),K}}),null),X(K=>d(me,L,K)),me})(),(()=>{var me=Qr();return d(me,M),i(me,b(ut,{get each(){return Le.inventory},children:K=>{const he=F(K.quantity,K.minStock),ve=K.quantity<=K.minStock?8:K.quantity<=K.minStock*2?35:75;return b(rt,{onClick:()=>D(K),get children(){return[(()=>{var W=c2(),ie=W.firstChild,Pe=ie.nextSibling;return d(W,G),ie.style.setProperty("margin","0"),ie.style.setProperty("font-size","1.1rem"),i(ie,()=>K.name),i(Pe,he),X(_e=>d(Pe,le(ve),_e)),W})(),(()=>{var W=Qr();return d(W,ne),i(W,()=>ee(K.price)),W})(),(()=>{var W=d2(),ie=W.firstChild,Pe=ie.nextSibling;return Pe.nextSibling,d(W,ue),i(W,()=>t("inventory.quantity"),ie),i(W,()=>K.quantity,Pe),i(W,()=>t("common.units"),null),W})()]}})}})),me})()]:[(()=>{var me=u2(),K=me.firstChild,he=K.nextSibling,ve=he.nextSibling,W=ve.nextSibling;return d(me,U),K.$$click=()=>m("overview"),i(K,()=>t("inventory.overview")),he.$$click=()=>m("products"),i(he,()=>t("inventory.products")),ve.$$click=()=>m("movements"),i(ve,()=>t("inventory.movements")),W.$$click=()=>m("locations"),i(W,()=>t("inventory.locations")),X(ie=>{var Pe=te(h()==="overview"),_e=te(h()==="products"),fe=te(h()==="movements"),be=te(h()==="locations");return ie.e=d(K,Pe,ie.e),ie.t=d(he,_e,ie.t),ie.a=d(ve,fe,ie.a),ie.o=d(W,be,ie.o),ie},{e:void 0,t:void 0,a:void 0,o:void 0}),me})(),ge(()=>ge(()=>h()==="overview")()&&(()=>{var me=h2(),K=me.firstChild;return i(K,b(rt,{get title(){return t("inventory.activeProducts")},get subtitle(){return t("inventory.currentlyManaged")},get children(){var he=Qr();return he.style.setProperty("font-size","1.5rem"),he.style.setProperty("font-weight","600"),he.style.setProperty("color","var(--primary-color)"),i(he,()=>C().activeProducts),he}}),null),i(K,b(rt,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.needAttention")},get children(){var he=Qr();return he.style.setProperty("font-size","1.5rem"),he.style.setProperty("font-weight","600"),he.style.setProperty("color","#d32f2f"),i(he,()=>C().lowStockProducts),he}}),null),i(K,b(rt,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.currentWorth")},get children(){var he=Qr();return he.style.setProperty("font-size","1.5rem"),he.style.setProperty("font-weight","600"),he.style.setProperty("color","var(--primary-color)"),i(he,()=>H(ce().totalValue)),he}}),null),i(K,b(rt,{get title(){return t("inventory.movements")},get subtitle(){return t("inventory.thisMonth")},get children(){var he=Qr();return he.style.setProperty("font-size","1.5rem"),he.style.setProperty("font-weight","600"),he.style.setProperty("color","var(--primary-color)"),i(he,()=>C().totalMovementsThisMonth),he}}),null),i(K,b(rt,{get title(){return t("inventory.activeLocations")},get subtitle(){return t("inventory.warehousesStores")},get children(){var he=Qr();return he.style.setProperty("font-size","1.5rem"),he.style.setProperty("font-weight","600"),he.style.setProperty("color","var(--primary-color)"),i(he,()=>C().activeLocations),he}}),null),i(me,(()=>{var he=ge(()=>C().lowStockProducts>0);return()=>he()&&b(rt,{get title(){return` ${t("inventory.lowStockAlert")}`},get subtitle(){return`${C().lowStockProducts} ${t("inventory.productsNeedRestocking")}`},style:{"margin-bottom":"2rem","border-color":"#ffcdd2",background:"#ffebee"},get children(){var ve=Qr();return ve.style.setProperty("margin-top","1rem"),i(ve,b(ut,{get each(){return Le.getLowStockProducts().slice(0,9)},children:W=>(()=>{var ie=m2(),Pe=ie.firstChild,_e=Pe.firstChild,fe=_e.nextSibling;fe.nextSibling;var be=Pe.nextSibling,pe=be.firstChild,we=pe.nextSibling;return we.nextSibling,ie.style.setProperty("display","flex"),ie.style.setProperty("justify-content","space-between"),ie.style.setProperty("margin-bottom","0.5rem"),ie.style.setProperty("font-size","0.875rem"),i(Pe,()=>W.name,_e),i(Pe,()=>W?.sku,fe),be.style.setProperty("color","#d32f2f"),be.style.setProperty("font-weight","600"),i(be,()=>W.currentStock,pe),i(be,()=>W.minStockLevel,we),i(be,()=>t("inventory.min"),null),ie})()}),null),i(ve,(()=>{var W=ge(()=>Le.getLowStockProducts().length>5);return()=>W()&&(()=>{var ie=Qr();return ie.style.setProperty("font-size","0.875rem"),ie.style.setProperty("color","var(--text-muted)"),ie.style.setProperty("font-style","italic"),i(ie,()=>t("common.andMore",{count:Le.getLowStockProducts().length-9})),ie})()})(),null),ve}})})(),null),X(he=>d(K,L,he)),me})()),ge(()=>ge(()=>h()==="products")()&&b(og,{})),ge(()=>ge(()=>h()==="movements")()&&b(iA,{})),ge(()=>ge(()=>h()==="locations")()&&(()=>{var me=y2(),K=me.firstChild,he=K.firstChild,ve=K.nextSibling;return K.style.setProperty("display","flex"),K.style.setProperty("justify-content","space-between"),K.style.setProperty("align-items","center"),K.style.setProperty("margin-bottom","1.5rem"),he.style.setProperty("margin","0"),he.style.setProperty("font-size","1.5rem"),i(he,()=>t("inventory.locations")),i(K,b(Ae,{get when(){return Lt.hasPermission("read_write")},get children(){return b(qe,{variant:"primary",onClick:()=>g(!0),get children(){return[" ",ge(()=>t("inventory.addLocation"))]}})}}),null),d(ve,ae),i(ve,b(ut,{get each(){return Le.getActiveLocations()},children:W=>{const ie=Le.getStockByLocation(W.id),Pe=ie.length,_e=ie.reduce((be,pe)=>be*1+pe.quantity*1,0),fe=ie.reduce((be,pe)=>(Le.getProductById(pe.productId),be+(pe?.averageCost||0)),0);return(()=>{var be=p2(),pe=be.firstChild,we=pe.firstChild,De=we.firstChild,ke=De.nextSibling,Te=we.nextSibling,Ue=Te.firstChild,Xe=Te.nextSibling,ze=pe.nextSibling,$e=ze.firstChild,Ge=$e.firstChild,ot=Ge.firstChild,je=Ge.nextSibling,Ce=$e.nextSibling,Se=Ce.firstChild,Ke=Se.firstChild,He=Se.nextSibling,Oe=Ce.nextSibling,Ye=Oe.firstChild,pt=Ye.firstChild,vt=Ye.nextSibling,mt=ze.nextSibling,yt=mt.firstChild,Qe=yt.firstChild;return pe.style.setProperty("margin-bottom","1rem"),pe.style.setProperty("padding-bottom","1rem"),pe.style.setProperty("border-bottom","1px solid var(--border-color)"),we.style.setProperty("display","flex"),we.style.setProperty("align-items","center"),we.style.setProperty("gap","0.5rem"),we.style.setProperty("margin-bottom","0.5rem"),De.style.setProperty("font-size","1.2rem"),i(De,()=>W.type==="warehouse"?"":W.type==="store"?"":W.type==="supplier"?"":""),ke.style.setProperty("margin","0"),ke.style.setProperty("font-size","1.1rem"),i(ke,()=>W.name),Te.style.setProperty("font-size","0.875rem"),Te.style.setProperty("color","var(--text-muted)"),i(Te,()=>W.code,Ue),i(Te,()=>oe(W.type),null),Xe.style.setProperty("font-size","0.75rem"),Xe.style.setProperty("color","var(--text-muted)"),Xe.style.setProperty("margin-top","0.25rem"),i(Xe,()=>W.address),ze.style.setProperty("margin-bottom","1rem"),$e.style.setProperty("display","flex"),$e.style.setProperty("justify-content","space-between"),$e.style.setProperty("margin-bottom","0.5rem"),Ge.style.setProperty("font-size","0.875rem"),Ge.style.setProperty("font-weight","500"),i(Ge,()=>t("inventory.products"),ot),je.style.setProperty("font-weight","600"),i(je,Pe),Ce.style.setProperty("display","flex"),Ce.style.setProperty("justify-content","space-between"),Ce.style.setProperty("margin-bottom","0.5rem"),Se.style.setProperty("font-size","0.875rem"),Se.style.setProperty("font-weight","500"),i(Se,()=>t("inventory.totalItems"),Ke),He.style.setProperty("font-weight","600"),He.style.setProperty("color","var(--primary-color)"),i(He,_e),Oe.style.setProperty("display","flex"),Oe.style.setProperty("justify-content","space-between"),Oe.style.setProperty("margin-bottom","1rem"),Ye.style.setProperty("font-size","0.875rem"),Ye.style.setProperty("font-weight","500"),i(Ye,()=>t("inventory.totalValue"),pt),vt.style.setProperty("font-weight","600"),vt.style.setProperty("color","var(--primary-color)"),i(vt,()=>H(fe)),yt.style.setProperty("font-weight","600"),yt.style.setProperty("margin-bottom","0.75rem"),yt.style.setProperty("font-size","0.875rem"),yt.style.setProperty("color","var(--text-primary)"),yt.style.setProperty("border-bottom","1px solid var(--border-color)"),yt.style.setProperty("padding-bottom","0.5rem"),i(yt,()=>t("inventory.productDetails"),Qe),i(mt,(()=>{var Ct=ge(()=>ie.length===0);return()=>Ct()?(()=>{var _t=Qr();return _t.style.setProperty("text-align","center"),_t.style.setProperty("color","var(--text-muted)"),_t.style.setProperty("font-style","italic"),_t.style.setProperty("padding","1rem"),i(_t,()=>t("inventory.noProducts")),_t})():(()=>{var _t=Qr();return _t.style.setProperty("max-height","200px"),_t.style.setProperty("overflow-y","auto"),_t.style.setProperty("border","1px solid var(--border-color)"),_t.style.setProperty("border-radius","var(--border-radius-sm)"),i(_t,b(ut,{each:ie,children:jt=>{const Mt=Le.getProductById(jt.productId);if(!Mt)return null;const Be=jt.quantity<=Mt.minStockLevel,We=jt.averageCost;return jt.quantity?(()=>{var at=f2(),lt=at.firstChild,Tt=lt.firstChild,Ie=Tt.firstChild,Ve=Ie.nextSibling,st=Tt.nextSibling,dt=st.firstChild,Gt=dt.firstChild,Wt=dt.nextSibling,At=Wt.nextSibling;return At.firstChild,at.style.setProperty("padding","0.75rem"),at.style.setProperty("border-bottom","1px solid var(--border-color)"),(Be?"#fff5f5":"transparent")!=null?at.style.setProperty("background",Be?"#fff5f5":"transparent"):at.style.removeProperty("background"),at.style.setProperty("transition","background-color 0.2s ease"),lt.style.setProperty("display","flex"),lt.style.setProperty("justify-content","space-between"),lt.style.setProperty("align-items","flex-start"),lt.style.setProperty("margin-bottom","0.25rem"),Tt.style.setProperty("flex","1"),Ie.style.setProperty("font-weight","500"),Ie.style.setProperty("font-size","0.875rem"),(Be?"#d32f2f":"var(--text-primary)")!=null?Ie.style.setProperty("color",Be?"#d32f2f":"var(--text-primary)"):Ie.style.removeProperty("color"),i(Ie,()=>Mt.name,null),i(Ie,Be&&(()=>{var kt=g2();return kt.style.setProperty("margin-left","0.5rem"),kt.style.setProperty("font-size","0.7rem"),kt.style.setProperty("color","#d32f2f"),kt})(),null),Ve.style.setProperty("font-size","0.75rem"),Ve.style.setProperty("color","var(--text-muted)"),Ve.style.setProperty("margin-top","0.1rem"),i(Ve,()=>Mt.sku,null),i(Ve,()=>Mt.UPC?"  "+Mt.UPC:"",null),i(Ve,()=>Mt.category?"  "+Mt.category:"",null),st.style.setProperty("text-align","right"),dt.style.setProperty("font-weight","600"),dt.style.setProperty("font-size","0.875rem"),(Be?"#d32f2f":"var(--primary-color)")!=null?dt.style.setProperty("color",Be?"#d32f2f":"var(--primary-color)"):dt.style.removeProperty("color"),i(dt,()=>jt.quantity,Gt),i(dt,()=>Mt.unitOfMeasure,null),Wt.style.setProperty("font-size","0.75rem"),Wt.style.setProperty("color","var(--text-muted)"),i(Wt,()=>H(We)),At.style.setProperty("font-size","0.7rem"),At.style.setProperty("color","var(--text-muted)"),At.style.setProperty("margin-top","0.1rem"),i(At,()=>Mt.minStockLevel,null),at})():null}})),_t})()})(),null),X(Ct=>d(be,{...re,"min-height":"400px"},Ct)),be})()}})),me})())]}}),b(Ae,{get when(){return Lt.hasPermission("read_write")},get children(){return[b(s$,{get isOpen(){return e()},onClose:()=>r(!1),get mode(){return v()==="new"?"movement":"legacy"}}),b($$,{get isOpen(){return n()},onClose:()=>o(!1)}),b(k$,{get isOpen(){return s()},onClose:()=>a(!1),get item(){return l()}}),b(nu,{get isOpen(){return f()},onClose:()=>g(!1),onLocationAdded:()=>{g(!1)}})]}}),b(gA,{get isOpen(){return w()},onClose:()=>I(!1)}),b(a2,{get isOpen(){return y()},onClose:()=>de(!1)})]}})};wt(["click"]);const b2=[{id:"1",name:"John Doe",position:"Software Engineer",salary:85e3,email:"john.doe@company.com",phone:"+1 (555) 123-4567",department:"Engineering",startDate:"2023-01-15"},{id:"2",name:"Jane Smith",position:"Product Manager",salary:95e3,email:"jane.smith@company.com",phone:"+1 (555) 234-5678",department:"Product",startDate:"2022-08-20"},{id:"3",name:"Mike Brown",position:"Designer",salary:7e4,email:"mike.brown@company.com",phone:"+1 (555) 345-6789",department:"Design",startDate:"2023-03-10"},{id:"4",name:"Sarah Kim",position:"HR Manager",salary:78e3,email:"sarah.kim@company.com",phone:"+1 (555) 456-7890",department:"Human Resources",startDate:"2022-11-05"},{id:"5",name:"Alex Lee",position:"Data Analyst",salary:72e3,email:"alex.lee@company.com",phone:"+1 (555) 567-8901",department:"Analytics",startDate:"2023-02-28"},{id:"6",name:"Emma Wilson",position:"Marketing Manager",salary:82e3,email:"emma.wilson@company.com",phone:"+1 (555) 678-9012",department:"Marketing",startDate:"2022-09-15"}],[ji,rc]=ye(b2),ig={get employees(){return ji()},addEmployee(t){const e={...t,id:Date.now().toString()};return rc([...ji(),e]),e},updateEmployee(t,e){rc(ji().map(r=>r.id===t?{...r,...e}:r))},deleteEmployee(t){rc(ji().filter(e=>e.id!==t))},getEmployeeById(t){return ji().find(e=>e.id===t)}};var _2=z("<form><div>");const S2=t=>{const{t:e}=ft(),[r,n]=ye({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),o=[{value:"Engineering",label:e("employees.departments.engineering","Engineering")},{value:"Product",label:e("employees.departments.product","Product")},{value:"Design",label:e("employees.departments.design","Design")},{value:"Marketing",label:e("employees.departments.marketing","Marketing")},{value:"Sales",label:e("employees.departments.sales","Sales")},{value:"Human Resources",label:e("employees.departments.humanResources","Human Resources")},{value:"Finance",label:e("employees.departments.finance","Finance")},{value:"Operations",label:e("employees.departments.operations","Operations")},{value:"Analytics",label:e("employees.departments.analytics","Analytics")}],s={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},a=u=>{u.preventDefault();const h=r();if(!h.name||!h.position||!h.salary||!h.email||!h.department||!h.startDate){alert(e("forms.requiredField"));return}const m={name:h.name,position:h.position,salary:parseFloat(h.salary),email:h.email,phone:h.phone,department:h.department,startDate:h.startDate};ig.addEmployee(m),n({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),t.onClose()},l=(u,h)=>{n(m=>({...m,[u]:h}))};return b(Ar,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.addEmployee")},get children(){var u=_2(),h=u.firstChild;return u.addEventListener("submit",a),i(u,b(Qt,{get label(){return e("employees.fullName")},get value(){return r().name},onChange:m=>l("name",m),get placeholder(){return e("employees.enterFullName","Enter employee's full name")},required:!0}),h),i(u,b(Qt,{get label(){return e("employees.position")},get value(){return r().position},onChange:m=>l("position",m),get placeholder(){return e("employees.enterPosition","Enter job position")},required:!0}),h),i(u,b(Dr,{get label(){return e("employees.department")},get value(){return r().department},onChange:m=>l("department",m),options:o,required:!0}),h),i(u,b(Qt,{get label(){return e("employees.email")},type:"email",get value(){return r().email},onChange:m=>l("email",m),get placeholder(){return e("employees.enterEmail","Enter email address")},required:!0}),h),i(u,b(Qt,{get label(){return e("employees.phone")},type:"tel",get value(){return r().phone},onChange:m=>l("phone",m),get placeholder(){return e("employees.enterPhone","Enter phone number")}}),h),i(u,b(Qt,{get label(){return e("employees.salary")},type:"number",get value(){return r().salary},onChange:m=>l("salary",m),get placeholder(){return e("employees.enterSalary","Enter annual salary")},required:!0}),h),i(u,b(Qt,{get label(){return e("employees.hireDate")},type:"date",get value(){return r().startDate},onChange:m=>l("startDate",m),required:!0}),h),d(h,s),i(h,b(qe,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),i(h,b(qe,{variant:"primary",type:"submit",get children(){return e("employees.addEmployee")}}),null),u}})};var P2=z("<div><div></div><div></div><div>"),w2=z("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),C2=z("<div>");const x2=t=>{const{t:e}=ft(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},o={"font-weight":"600",color:"var(--text-primary)"},s={width:"80px",height:"80px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.5rem",margin:"0 auto 1.5rem auto"},a={"text-align":"center","margin-bottom":"2rem"},l={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},u={color:"var(--text-muted)","font-size":"1rem"},h={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"};if(!t.employee)return null;const m=x=>x.split(" ").map(T=>T[0]).join("").toUpperCase(),v=x=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(x),_=x=>new Date(x).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return b(Ar,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.employeeDetails")},get children(){return[(()=>{var x=P2(),T=x.firstChild,E=T.nextSibling,P=E.nextSibling;return d(x,a),d(T,s),i(T,()=>m(t.employee.name)),d(E,l),i(E,()=>t.employee.name),d(P,u),i(P,()=>t.employee.position),x})(),(()=>{var x=w2(),T=x.firstChild,E=T.firstChild,P=E.nextSibling,R=T.nextSibling,Y=R.firstChild,Z=Y.nextSibling,j=R.nextSibling,B=j.firstChild,V=B.nextSibling,f=j.nextSibling,g=f.firstChild,S=g.nextSibling,$=f.nextSibling,w=$.firstChild,I=w.nextSibling,y=$.nextSibling,de=y.firstChild,J=de.nextSibling;return i(E,()=>e("employees.employeeId")),i(P,()=>t.employee.id),i(Y,()=>e("employees.department")),i(Z,()=>t.employee.department),i(B,()=>e("employees.email")),i(V,()=>t.employee.email),i(g,()=>e("employees.phone")),i(S,()=>t.employee.phone),i(w,()=>e("employees.salary")),i(I,()=>v(t.employee.salary)),i(de,()=>e("employees.hireDate")),i(J,()=>_(t.employee.startDate)),X(O=>{var N=r,q=n,D=o,C=r,F=n,ee=o,H=r,oe=n,M=o,G=r,le=n,ne=o,ue=r,L=n,A=o,U=r,te=n,ae=o;return O.e=d(T,N,O.e),O.t=d(E,q,O.t),O.a=d(P,D,O.a),O.o=d(R,C,O.o),O.i=d(Y,F,O.i),O.n=d(Z,ee,O.n),O.s=d(j,H,O.s),O.h=d(B,oe,O.h),O.r=d(V,M,O.r),O.d=d(f,G,O.d),O.l=d(g,le,O.l),O.u=d(S,ne,O.u),O.c=d($,ue,O.c),O.w=d(w,L,O.w),O.m=d(I,A,O.m),O.f=d(y,U,O.f),O.y=d(de,te,O.y),O.g=d(J,ae,O.g),O},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),x})(),(()=>{var x=C2();return d(x,h),i(x,b(qe,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),i(x,b(qe,{variant:"primary",onClick:()=>{console.log("Edit employee:",t.employee.id)},get children(){return e("employees.editEmployee")}}),null),x})()]}})};var Tm=z("<div>"),$2=z("<div><div></div><div><div></div><div></div><div>/year");const A2=()=>{const{t}=ft(),[e,r]=ye(!1),[n,o]=ye(!1),[s,a]=ye(null),l=E=>{a(E),o(!0)},u={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},h={display:"flex","align-items":"center",gap:"1rem"},m={width:"60px",height:"60px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.2rem"},v={flex:"1"},_={"font-weight":"600","margin-bottom":"0.25rem"},x={color:"var(--text-muted)","font-size":"0.875rem","margin-bottom":"0.5rem"},T={color:"var(--primary-color)","font-weight":"500"};return b(an,{get title(){return t("employees.title")},get children(){return[(()=>{var E=Tm();return E.style.setProperty("margin-bottom","2rem"),i(E,b(qe,{variant:"primary",onClick:()=>r(!0),get children(){return t("employees.addEmployee")}})),E})(),(()=>{var E=Tm();return d(E,u),i(E,()=>ig.employees.map(P=>{const R=Z=>Z.split(" ").map(j=>j[0]).join("").toUpperCase(),Y=Z=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Z);return b(rt,{onClick:()=>l(P),get children(){var Z=$2(),j=Z.firstChild,B=j.nextSibling,V=B.firstChild,f=V.nextSibling,g=f.nextSibling,S=g.firstChild;return d(Z,h),d(j,m),i(j,()=>R(P.name)),d(B,v),d(V,_),i(V,()=>P.name),d(f,x),i(f,()=>P.position),d(g,T),i(g,()=>Y(P.salary),S),Z}})})),E})(),b(S2,{get isOpen(){return e()},onClose:()=>r(!1)}),b(x2,{get isOpen(){return n()},onClose:()=>o(!1),get employee(){return s()}})]}})},I2=[{id:"1",accountId:"1002",bankName:"First National Bank",accountNumber:"****1234",accountType:"checking",currency:"USD",currentBalance:32730.5,lastReconciledDate:"2024-01-01",lastReconciledBalance:3e4,isActive:!0},{id:"2",accountId:"1003",bankName:"First National Bank",accountNumber:"****5678",accountType:"savings",currency:"USD",currentBalance:12e3,lastReconciledDate:"2024-01-01",lastReconciledBalance:1e4,isActive:!0}],E2=[{id:"1",accountId:"1002",date:"2024-01-15",description:"Customer Payment - ABC Corp",reference:"CHK001234",debitAmount:5e3,creditAmount:0,balance:35730.5,category:"Customer Payment",isReconciled:!0,reconciledWith:"eb1",importedAt:"2024-01-16",source:"csv_import"},{id:"2",accountId:"1002",date:"2024-01-14",description:"Office Supplies - Staples",reference:"CHK001235",debitAmount:0,creditAmount:250,balance:30730.5,category:"Office Expenses",isReconciled:!0,reconciledWith:"eb2",importedAt:"2024-01-16",source:"csv_import"},{id:"3",accountId:"1002",date:"2024-01-13",description:"Monthly Rent Payment",reference:"CHK001236",debitAmount:0,creditAmount:2e3,balance:28730.5,category:"Rent",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"},{id:"4",accountId:"1002",date:"2024-01-12",description:"Wire Transfer In",reference:"WIRE001",debitAmount:1e4,creditAmount:0,balance:38730.5,category:"Wire Transfer",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"}],T2=[{id:"eb1",accountId:"1002",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",debitAmount:5e3,creditAmount:0,category:"Accounts Receivable",isReconciled:!0,reconciledWith:"1",createdAt:"2024-01-15"},{id:"eb2",accountId:"1002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",debitAmount:0,creditAmount:250,category:"Office Expenses",isReconciled:!0,reconciledWith:"2",createdAt:"2024-01-14"},{id:"eb3",accountId:"1002",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",debitAmount:0,creditAmount:3500,category:"Salary Expense",isReconciled:!1,createdAt:"2024-01-11"}],k2=[{id:"1",bankAccountId:"1",periodStart:"2024-01-01",periodEnd:"2024-01-15",startingBalance:3e4,endingBalance:35730.5,status:"in_progress",totalBankTransactions:4,totalEntryBookRecords:3,reconciledTransactions:2,unreconciledTransactions:2,discrepancyAmount:1500,createdAt:"2024-01-16",notes:"Wire transfer and rent payment need investigation"}],[aa,km]=ye(I2),[so,nc]=ye(E2),[qi,Rm]=ye(T2),[la,Dm]=ye(k2),Pr={get bankAccounts(){return aa()},addBankAccount(t){const e={...t,id:Date.now().toString()};return km([...aa(),e]),e},updateBankAccount(t,e){km(aa().map(r=>r.id===t?{...r,...e}:r))},getBankAccountById(t){return aa().find(e=>e.id===t)},get bankStatements(){return so()},addBankStatement(t){const e={...t,id:Date.now().toString(),importedAt:new Date().toISOString()};return nc([...so(),e]),e},addBankStatementsFromCSV(t){const e=t.map(r=>({...r,id:`csv_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,importedAt:new Date().toISOString(),source:"csv_import",isReconciled:!1}));return nc([...so(),...e]),e},updateBankStatement(t,e){nc(so().map(r=>r.id===t?{...r,...e}:r))},getBankStatementsByAccount(t){return so().filter(e=>e.accountId===t)},getUnreconciledBankStatements(t){return(t?this.getBankStatementsByAccount(t):so()).filter(r=>!r.isReconciled)},get entryBookRecords(){return qi()},addEntryBookRecord(t){const e={...t,id:Date.now().toString(),createdAt:new Date().toISOString()};return Rm([...qi(),e]),e},updateEntryBookRecord(t,e){Rm(qi().map(r=>r.id===t?{...r,...e}:r))},getEntryBookRecordsByAccount(t){return qi().filter(e=>e.accountId===t)},getUnreconciledEntryBookRecords(t){return(t?this.getEntryBookRecordsByAccount(t):qi()).filter(r=>!r.isReconciled)},reconcileTransaction(t,e){this.updateBankStatement(t,{isReconciled:!0,reconciledWith:e}),this.updateEntryBookRecord(e,{isReconciled:!0,reconciledWith:t})},unreconciledTransaction(t){const e=so().find(r=>r.id===t);e?.reconciledWith&&this.updateEntryBookRecord(e.reconciledWith,{isReconciled:!1,reconciledWith:void 0}),this.updateBankStatement(t,{isReconciled:!1,reconciledWith:void 0})},findPotentialMatches(t){const e=so().find(n=>n.id===t);return e?this.getUnreconciledEntryBookRecords(e.accountId).filter(n=>{const o=Math.abs(e.debitAmount-n.debitAmount)<.01||Math.abs(e.creditAmount-n.creditAmount)<.01,s=new Date(e.date),a=new Date(n.date),u=Math.abs((s.getTime()-a.getTime())/(1e3*60*60*24))<=3,h=e.reference===n.reference||e.description.toLowerCase().includes(n.description.toLowerCase())||n.description.toLowerCase().includes(e.description.toLowerCase());return o&&(u||h)}).sort((n,o)=>{const s=(n.date===e.date?2:0)+(n.reference===e.reference?1:0);return(o.date===e.date?2:0)+(o.reference===e.reference?1:0)-s}):[]},get reconciliationSessions(){return la()},startReconciliationSession(t,e,r){const n=this.getBankStatementsByAccount(t).filter(h=>h.date>=e&&h.date<=r),o=this.getEntryBookRecordsByAccount(t).filter(h=>h.date>=e&&h.date<=r),s=n.filter(h=>h.isReconciled).length,a=this.getBankAccountById(t)?.lastReconciledBalance||0,l=this.getBankAccountById(t)?.currentBalance||0,u={id:Date.now().toString(),bankAccountId:t,periodStart:e,periodEnd:r,startingBalance:a,endingBalance:l,status:"in_progress",totalBankTransactions:n.length,totalEntryBookRecords:o.length,reconciledTransactions:s,unreconciledTransactions:n.length-s,discrepancyAmount:0,createdAt:new Date().toISOString()};return Dm([...la(),u]),u},updateReconciliationSession(t,e){Dm(la().map(r=>r.id===t?{...r,...e}:r))},getReconciliationSessionsByAccount(t){return la().filter(e=>e.bankAccountId===t)}};var oc=z("<div>"),R2=z("<div><strong>:</strong> <!> - "),D2=z("<div><div><div></div><div></div><div></div></div><input id=csvFileInput type=file accept=.csv>"),N2=z("<div><h4></h4><div><div><label> *</label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><select><option value>"),si=z("<option>"),L2=z("<div><table><thead><tr></tr></thead><tbody>"),M2=z("<th>"),O2=z("<tr>"),F2=z("<td>");const V2=t=>{const{t:e}=ft(),[r,n]=ye(!1),[o,s]=ye(!1),[a,l]=ye(null),[u,h]=ye([]),[m,v]=ye({date:"",description:"",reference:"",debit:"",credit:"",balance:""}),_={border:`2px dashed ${r()?"var(--primary-color)":"var(--border-color)"}`,"border-radius":"var(--border-radius)",padding:"2rem","text-align":"center","background-color":r()?"var(--background-color)":"transparent",transition:"all 0.2s ease",cursor:"pointer"},x={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem","margin-top":"1.5rem"},T={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-family":"inherit"},E={"max-height":"200px","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},P={width:"100%","border-collapse":"collapse","font-size":"0.875rem"},R={padding:"0.5rem","border-bottom":"1px solid var(--border-color)","text-align":"left"},Y={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},Z=I=>{I.preventDefault(),n(!0)},j=I=>{I.preventDefault(),n(!1)},B=I=>{I.preventDefault(),n(!1);const y=I.dataTransfer?.files;y&&y.length>0&&f(y[0])},V=I=>{const y=I.target;y.files&&y.files.length>0&&f(y.files[0])},f=I=>{if(!I.name.toLowerCase().endsWith(".csv")){l({success:!1,message:e("banking.pleaseUploadCSV")});return}s(!0);const y=new FileReader;y.onload=de=>{try{const O=(de.target?.result).split(`
`).filter(C=>C.trim());if(O.length<2){l({success:!1,message:e("banking.csvRequiresHeaderAndData")}),s(!1);return}const N=O[0].split(",").map(C=>C.trim().replace(/[\"\']/g,"")),q=O.slice(1).map(C=>{const F=C.split(",").map(H=>H.trim().replace(/[\"\']/g,"")),ee={};return N.forEach((H,oe)=>{ee[H]=F[oe]||""}),ee});h(q),l({success:!0,message:e("banking.successfullyParsed").replace("{count}",q.length.toString()),count:q.length});const D={...m()};N.forEach(C=>{const F=C.toLowerCase();F.includes("date")&&(D.date=C),(F.includes("description")||F.includes("memo"))&&(D.description=C),(F.includes("reference")||F.includes("check")||F.includes("ref"))&&(D.reference=C),(F.includes("debit")||F.includes("deposit"))&&(D.debit=C),(F.includes("credit")||F.includes("withdrawal")||F.includes("amount"))&&(D.debit?D.credit=C:D.debit=C),F.includes("balance")&&(D.balance=C)}),v(D)}catch{l({success:!1,message:e("banking.errorParsingCSV")})}s(!1)},y.readAsText(I)},g=(I,y)=>{v(de=>({...de,[I]:y}))},S=()=>u().length===0?[]:Object.keys(u()[0]),$=()=>{if(!t.bankAccount||u().length===0)return;const I=m();if(!I.date||!I.description){l({success:!1,message:e("banking.dateDescriptionRequired")});return}s(!0);try{const y=u().map(J=>{const O=C=>C&&parseFloat(C.replace(/[^0-9.-]/g,""))||0,N=C=>{const F=new Date(C);if(isNaN(F.getTime())){const ee=C.split("/");if(ee.length===3)return new Date(parseInt(ee[2]),parseInt(ee[0])-1,parseInt(ee[1])).toISOString().split("T")[0]}return F.toISOString().split("T")[0]};let q=0,D=0;if(I.debit&&I.credit)q=O(J[I.debit]),D=O(J[I.credit]);else if(I.debit){const C=O(J[I.debit]);C>0?q=C:D=Math.abs(C)}return{accountId:t.bankAccount.accountId,date:N(J[I.date]),description:J[I.description]||e("banking.importedTransaction"),reference:J[I.reference]||"",debitAmount:q,creditAmount:D,balance:I.balance?O(J[I.balance]):0,isReconciled:!1}}),de=Pr.addBankStatementsFromCSV(y);l({success:!0,message:e("banking.successfullyImported").replace("{count}",de.length.toString()),count:de.length}),h([]),v({date:"",description:"",reference:"",debit:"",credit:"",balance:""})}catch{l({success:!1,message:e("banking.errorImportingTransactions")})}s(!1)},w=()=>{h([]),l(null),v({date:"",description:"",reference:"",debit:"",credit:"",balance:""})};return b(Ar,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("banking.importBankStatementCSV")},get children(){return[ge(()=>ge(()=>!!t.bankAccount)()&&(()=>{var I=R2(),y=I.firstChild,de=y.firstChild,J=y.nextSibling,O=J.nextSibling;return O.nextSibling,I.style.setProperty("margin-bottom","1.5rem"),I.style.setProperty("padding","1rem"),I.style.setProperty("background","var(--background-color)"),I.style.setProperty("border-radius","var(--border-radius-sm)"),I.style.setProperty("border","1px solid var(--border-color)"),i(y,()=>e("banking.bankAccount"),de),i(I,()=>t.bankAccount.bankName,O),i(I,()=>t.bankAccount.accountNumber,null),I})()),ge(()=>ge(()=>u().length===0)()?(()=>{var I=D2(),y=I.firstChild,de=y.firstChild,J=de.nextSibling,O=J.nextSibling,N=y.nextSibling;return y.$$click=()=>document.getElementById("csvFileInput")?.click(),y.addEventListener("drop",B),y.addEventListener("dragleave",j),y.addEventListener("dragover",Z),de.style.setProperty("font-size","2rem"),de.style.setProperty("margin-bottom","1rem"),J.style.setProperty("font-weight","500"),J.style.setProperty("margin-bottom","0.5rem"),i(J,(()=>{var q=ge(()=>!!r());return()=>q()?e("banking.dropCSVHere"):e("banking.clickToUploadCSV")})()),O.style.setProperty("font-size","0.875rem"),O.style.setProperty("color","var(--text-muted)"),i(O,()=>e("banking.supportedFormat")),N.addEventListener("change",V),N.style.setProperty("display","none"),X(q=>d(y,_,q)),I})():(()=>{var I=N2(),y=I.firstChild,de=y.nextSibling,J=de.firstChild,O=J.firstChild,N=O.firstChild,q=O.nextSibling,D=q.firstChild,C=J.nextSibling,F=C.firstChild,ee=F.firstChild,H=F.nextSibling,oe=H.firstChild,M=C.nextSibling,G=M.firstChild,le=G.nextSibling,ne=le.firstChild,ue=M.nextSibling,L=ue.firstChild,A=L.firstChild,U=L.nextSibling,te=U.firstChild,ae=ue.nextSibling,re=ae.firstChild,ce=re.nextSibling,Q=ce.firstChild,me=ae.nextSibling,K=me.firstChild,he=K.nextSibling,ve=he.firstChild;return y.style.setProperty("margin","0 0 1rem 0"),i(y,()=>e("banking.mapCSVColumns")),d(de,x),O.style.setProperty("display","block"),O.style.setProperty("margin-bottom","0.5rem"),O.style.setProperty("font-weight","500"),i(O,()=>e("banking.dateColumn"),N),q.addEventListener("change",W=>g("date",W.target.value)),i(D,()=>e("banking.selectColumn")),i(q,()=>S().map(W=>(()=>{var ie=si();return ie.value=W,i(ie,W),ie})()),null),F.style.setProperty("display","block"),F.style.setProperty("margin-bottom","0.5rem"),F.style.setProperty("font-weight","500"),i(F,()=>e("banking.descriptionColumn"),ee),H.addEventListener("change",W=>g("description",W.target.value)),i(oe,()=>e("banking.selectColumn")),i(H,()=>S().map(W=>(()=>{var ie=si();return ie.value=W,i(ie,W),ie})()),null),G.style.setProperty("display","block"),G.style.setProperty("margin-bottom","0.5rem"),G.style.setProperty("font-weight","500"),i(G,()=>e("banking.referenceColumn")),le.addEventListener("change",W=>g("reference",W.target.value)),i(ne,()=>e("banking.selectColumn")),i(le,()=>S().map(W=>(()=>{var ie=si();return ie.value=W,i(ie,W),ie})()),null),L.style.setProperty("display","block"),L.style.setProperty("margin-bottom","0.5rem"),L.style.setProperty("font-weight","500"),i(L,()=>e("banking.amountDebitColumn"),A),U.addEventListener("change",W=>g("debit",W.target.value)),i(te,()=>e("banking.selectColumn")),i(U,()=>S().map(W=>(()=>{var ie=si();return ie.value=W,i(ie,W),ie})()),null),re.style.setProperty("display","block"),re.style.setProperty("margin-bottom","0.5rem"),re.style.setProperty("font-weight","500"),i(re,()=>e("banking.creditColumn")),ce.addEventListener("change",W=>g("credit",W.target.value)),i(Q,()=>e("banking.selectColumn")),i(ce,()=>S().map(W=>(()=>{var ie=si();return ie.value=W,i(ie,W),ie})()),null),K.style.setProperty("display","block"),K.style.setProperty("margin-bottom","0.5rem"),K.style.setProperty("font-weight","500"),i(K,()=>e("banking.balanceColumn")),he.addEventListener("change",W=>g("balance",W.target.value)),i(ve,()=>e("banking.selectColumn")),i(he,()=>S().map(W=>(()=>{var ie=si();return ie.value=W,i(ie,W),ie})()),null),i(I,(()=>{var W=ge(()=>u().length>0);return()=>W()&&(()=>{var ie=L2(),Pe=ie.firstChild,_e=Pe.firstChild,fe=_e.firstChild,be=_e.nextSibling;return d(ie,E),fe.style.setProperty("background-color","var(--background-color)"),i(fe,()=>S().slice(0,6).map(pe=>(()=>{var we=M2();return i(we,pe),X(De=>d(we,R,De)),we})())),i(be,()=>u().slice(0,3).map(pe=>(()=>{var we=O2();return i(we,()=>S().slice(0,6).map(De=>(()=>{var ke=F2();return i(ke,()=>pe[De]),X(Te=>d(ke,R,Te)),ke})())),we})())),i(ie,(()=>{var pe=ge(()=>u().length>3);return()=>pe()&&(()=>{var we=oc();return we.style.setProperty("padding","0.5rem"),we.style.setProperty("text-align","center"),we.style.setProperty("color","var(--text-muted)"),i(we,()=>e("banking.andMoreRows").replace("{count}",(u().length-3).toString())),we})()})(),null),X(pe=>d(Pe,P,pe)),ie})()})(),null),X(W=>{var ie=T,Pe=T,_e=T,fe=T,be=T,pe=T;return W.e=d(q,ie,W.e),W.t=d(H,Pe,W.t),W.a=d(le,_e,W.a),W.o=d(U,fe,W.o),W.i=d(ce,be,W.i),W.n=d(he,pe,W.n),W},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),X(()=>q.value=m().date),X(()=>H.value=m().description),X(()=>le.value=m().reference),X(()=>U.value=m().debit),X(()=>ce.value=m().credit),X(()=>he.value=m().balance),I})()),ge(()=>ge(()=>!!a())()&&(()=>{var I=oc();return I.style.setProperty("padding","1rem"),I.style.setProperty("border-radius","var(--border-radius-sm)"),I.style.setProperty("margin-top","1rem"),i(I,()=>a().message),X(y=>{var de=a().success?"#d4edda":"#f8d7da",J=a().success?"#155724":"#721c24",O=`1px solid ${a().success?"#c3e6cb":"#f5c6cb"}`;return de!==y.e&&((y.e=de)!=null?I.style.setProperty("background",de):I.style.removeProperty("background")),J!==y.t&&((y.t=J)!=null?I.style.setProperty("color",J):I.style.removeProperty("color")),O!==y.a&&((y.a=O)!=null?I.style.setProperty("border",O):I.style.removeProperty("border")),y},{e:void 0,t:void 0,a:void 0}),I})()),(()=>{var I=oc();return d(I,Y),i(I,b(qe,{variant:"secondary",onClick:()=>{w(),t.onClose()},get children(){return e("common.cancel")}}),null),i(I,(()=>{var y=ge(()=>u().length>0);return()=>y()&&b(qe,{variant:"outline",onClick:w,get children(){return e("common.reset")}})})(),null),i(I,(()=>{var y=ge(()=>u().length>0);return()=>y()&&b(qe,{variant:"primary",onClick:$,get disabled(){return o()||!m().date||!m().description},get children(){return ge(()=>!!o())()?e("banking.importing"):e("banking.importTransactions").replace("{count}",u().length.toString())}})})(),null),I})()]}})};wt(["click"]);var Nm=z("<span>"),ca=z("<div>"),Lm=z("<div> "),B2=z("<div><div><h3></h3><div><button></button><button></button><button></button></div></div><div></div><div><div><h4></h4><div></div></div><div><h4></h4><div>"),U2=z("<div><div><div></div><div>  </div></div><div><div>"),ic=z("<span> "),z2=z("<span>(<!>)"),j2=z("<div><strong>:</strong> "),Mm=z("<div><div><div></div><div>  </div></div><div>"),q2=z("<div><div>:</div><div></div><div>");const G2=t=>{const{t:e}=ft(),[r,n]=ye([]),[o,s]=ye([]),[a,l]=ye(null),[u,h]=ye([]),[m,v]=ye("unreconciled");fn(()=>{const O=Pr.getBankAccountById(t.bankAccountId);if(O){const N=Pr.getBankStatementsByAccount(O.accountId).filter(D=>D.date>=t.selectedPeriod.start&&D.date<=t.selectedPeriod.end),q=Pr.getEntryBookRecordsByAccount(O.accountId).filter(D=>D.date>=t.selectedPeriod.start&&D.date<=t.selectedPeriod.end);n(N),s(q)}});const _=()=>{const O=r();switch(m()){case"reconciled":return O.filter(N=>N.isReconciled);case"unreconciled":return O.filter(N=>!N.isReconciled);default:return O}},x=()=>{const O=o();switch(m()){case"reconciled":return O.filter(N=>N.isReconciled);case"unreconciled":return O.filter(N=>!N.isReconciled);default:return O}},T=O=>{if(l(O),O.isReconciled)h([]);else{const N=Pr.findPotentialMatches(O.id);h(N)}},E=O=>{const N=a();if(N){Pr.reconcileTransaction(N.id,O.id);const q=Pr.getBankAccountById(t.bankAccountId);if(q){const D=Pr.getBankStatementsByAccount(q.accountId).filter(F=>F.date>=t.selectedPeriod.start&&F.date<=t.selectedPeriod.end),C=Pr.getEntryBookRecordsByAccount(q.accountId).filter(F=>F.date>=t.selectedPeriod.start&&F.date<=t.selectedPeriod.end);n(D),s(C)}l(null),h([])}},P=O=>{Pr.unreconciledTransaction(O.id);const N=Pr.getBankAccountById(t.bankAccountId);if(N){const q=Pr.getBankStatementsByAccount(N.accountId).filter(C=>C.date>=t.selectedPeriod.start&&C.date<=t.selectedPeriod.end),D=Pr.getEntryBookRecordsByAccount(N.accountId).filter(C=>C.date>=t.selectedPeriod.start&&C.date<=t.selectedPeriod.end);n(q),s(D)}},R={display:"grid","grid-template-columns":"1fr 1fr",gap:"2rem","margin-top":"2rem"},Y={height:"600px","overflow-y":"auto"},Z={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},j=O=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:O?"var(--primary-color)":"var(--surface-color)",color:O?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),B=(O,N)=>({display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem","margin-bottom":"0.5rem",background:O?"var(--primary-color)":N?"#e8f5e8":"var(--surface-color)",color:O?"white":"var(--text-primary)","border-radius":"var(--border-radius-sm)",border:`1px solid ${O?"var(--primary-color)":N?"#c3e6cb":"var(--border-color)"}`,cursor:"pointer",transition:"all 0.2s ease"}),V={flex:"1"},f={"font-weight":"500","margin-bottom":"0.25rem"},g={"font-size":"0.875rem",opacity:"0.8"},S=O=>({"font-weight":"600",color:O?"#4caf50":"#f44336"}),$={padding:"0.25rem 0.5rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","margin-left":"0.5rem"},w=O=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(O),I=O=>new Date(O).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),y=O=>{if(!a())return null;const N=a();return(Math.abs(N.debitAmount-O.debitAmount)<.01||Math.abs(N.creditAmount-O.creditAmount)<.01)&&N.date===O.date?(()=>{var C=Nm();return i(C,()=>e("banking.exactMatch")),X(F=>d(C,{...$,background:"#d4edda",color:"#155724"},F)),C})():u().includes(O)?(()=>{var C=Nm();return i(C,()=>e("banking.possibleMatch")),X(F=>d(C,{...$,background:"#fff3cd",color:"#856404"},F)),C})():null},J=(()=>{const O=r(),N=o(),q=O.filter(C=>C.isReconciled).length,D=N.filter(C=>C.isReconciled).length;return{totalStatements:O.length,totalRecords:N.length,reconciledStatements:q,reconciledRecords:D,unreconciledStatements:O.length-q,unreconciledRecords:N.length-D}})();return(()=>{var O=B2(),N=O.firstChild,q=N.firstChild,D=q.nextSibling,C=D.firstChild,F=C.nextSibling,ee=F.nextSibling,H=N.nextSibling,oe=H.nextSibling,M=oe.firstChild,G=M.firstChild,le=G.nextSibling,ne=M.nextSibling,ue=ne.firstChild,L=ue.nextSibling;return d(N,Z),q.style.setProperty("margin","0"),q.style.setProperty("font-size","1.25rem"),i(q,()=>e("banking.reconciliationComparison")),D.style.setProperty("display","flex"),D.style.setProperty("gap","0.5rem"),C.$$click=()=>v("all"),i(C,()=>e("common.all")),F.$$click=()=>v("unreconciled"),i(F,()=>e("banking.unreconciled")),ee.$$click=()=>v("reconciled"),i(ee,()=>e("banking.reconciled")),H.style.setProperty("display","grid"),H.style.setProperty("grid-template-columns","repeat(4, 1fr)"),H.style.setProperty("gap","1rem"),H.style.setProperty("margin-bottom","2rem"),i(H,b(rt,{get title(){return e("banking.bankStatements")},get subtitle(){return e("banking.totalTransactions")},get children(){return[(()=>{var A=ca();return A.style.setProperty("font-size","1.5rem"),A.style.setProperty("font-weight","600"),A.style.setProperty("color","var(--primary-color)"),i(A,()=>J.totalStatements),A})(),(()=>{var A=Lm(),U=A.firstChild;return A.style.setProperty("font-size","0.875rem"),A.style.setProperty("color","var(--text-muted)"),i(A,()=>J.reconciledStatements,U),i(A,()=>e("banking.reconciled"),null),A})()]}}),null),i(H,b(rt,{get title(){return e("banking.entryBookRecords")},get subtitle(){return e("banking.totalEntries")},get children(){return[(()=>{var A=ca();return A.style.setProperty("font-size","1.5rem"),A.style.setProperty("font-weight","600"),A.style.setProperty("color","var(--primary-color)"),i(A,()=>J.totalRecords),A})(),(()=>{var A=Lm(),U=A.firstChild;return A.style.setProperty("font-size","0.875rem"),A.style.setProperty("color","var(--text-muted)"),i(A,()=>J.reconciledRecords,U),i(A,()=>e("banking.reconciled"),null),A})()]}}),null),i(H,b(rt,{get title(){return e("banking.unreconciledBank")},get subtitle(){return e("banking.needAttention")},get children(){var A=ca();return A.style.setProperty("font-size","1.5rem"),A.style.setProperty("font-weight","600"),A.style.setProperty("color","#f44336"),i(A,()=>J.unreconciledStatements),A}}),null),i(H,b(rt,{get title(){return e("banking.unreconciledBooks")},get subtitle(){return e("banking.needAttention")},get children(){var A=ca();return A.style.setProperty("font-size","1.5rem"),A.style.setProperty("font-weight","600"),A.style.setProperty("color","#f44336"),i(A,()=>J.unreconciledRecords),A}}),null),d(oe,R),G.style.setProperty("margin","0 0 1rem 0"),i(G,()=>e("banking.bankStatements")),i(le,()=>_().map(A=>(()=>{var U=U2(),te=U.firstChild,ae=te.firstChild,re=ae.nextSibling,ce=re.firstChild,Q=te.nextSibling,me=Q.firstChild;return U.$$click=()=>T(A),i(ae,()=>A.description),i(re,()=>I(A.date),ce),i(re,()=>A.reference,null),i(re,(()=>{var K=ge(()=>!!A.isReconciled);return()=>K()&&(()=>{var he=ic();return he.firstChild,he.style.setProperty("color","#4caf50"),he.style.setProperty("margin-left","0.5rem"),i(he,()=>e("banking.reconciled"),null),he})()})(),null),i(me,()=>A.debitAmount>0?"+":"-",null),i(me,()=>w(A.debitAmount||A.creditAmount),null),i(Q,(()=>{var K=ge(()=>!!A.isReconciled);return()=>K()&&b(qe,{variant:"outline",size:"sm",onClick:he=>{he.stopPropagation(),P(A)},style:{"margin-top":"0.5rem"},get children(){return e("banking.unreconcile")}})})(),null),X(K=>{var he=B(a()?.id===A.id,A.isReconciled),ve=V,W=f,ie=g,Pe=S(A.debitAmount>0);return K.e=d(U,he,K.e),K.t=d(te,ve,K.t),K.a=d(ae,W,K.a),K.o=d(re,ie,K.o),K.i=d(me,Pe,K.i),K},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),U})())),ue.style.setProperty("margin","0 0 1rem 0"),i(ue,()=>e("banking.entryBookRecords"),null),i(ue,(()=>{var A=ge(()=>!!(a()&&!a().isReconciled));return()=>A()&&(()=>{var U=z2(),te=U.firstChild,ae=te.nextSibling;return ae.nextSibling,U.style.setProperty("font-weight","400"),U.style.setProperty("color","var(--text-muted)"),U.style.setProperty("margin-left","0.5rem"),i(U,()=>e("banking.clickToReconcile"),ae),U})()})(),null),i(L,(()=>{var A=ge(()=>!!(a()&&!a().isReconciled));return()=>A()?[ge(()=>ge(()=>u().length>0)()&&(()=>{var U=j2(),te=U.firstChild,ae=te.firstChild;return te.nextSibling,U.style.setProperty("margin-bottom","1rem"),U.style.setProperty("padding","0.75rem"),U.style.setProperty("background","#fff3cd"),U.style.setProperty("border-radius","var(--border-radius-sm)"),i(te,()=>e("banking.potentialMatchesFound"),ae),i(U,()=>e("banking.clickRecordToReconcile"),null),U})()),ge(()=>x().map(U=>(u().includes(U),(()=>{var te=Mm(),ae=te.firstChild,re=ae.firstChild,ce=re.nextSibling,Q=ce.firstChild,me=ae.nextSibling;return te.$$click=()=>{U.isReconciled||E(U)},i(re,()=>U.description,null),i(re,()=>y(U),null),i(ce,()=>I(U.date),Q),i(ce,()=>U.reference,null),i(ce,(()=>{var K=ge(()=>!!U.isReconciled);return()=>K()&&(()=>{var he=ic();return he.firstChild,he.style.setProperty("color","#4caf50"),he.style.setProperty("margin-left","0.5rem"),i(he,()=>e("banking.reconciled"),null),he})()})(),null),i(me,()=>U.debitAmount>0?"+":"-",null),i(me,()=>w(U.debitAmount||U.creditAmount),null),X(K=>{var he={...B(!1,U.isReconciled),opacity:U.isReconciled?.6:1,cursor:U.isReconciled?"not-allowed":"pointer"},ve=V,W=f,ie=g,Pe=S(U.debitAmount>0);return K.e=d(te,he,K.e),K.t=d(ae,ve,K.t),K.a=d(re,W,K.a),K.o=d(ce,ie,K.o),K.i=d(me,Pe,K.i),K},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),te})())))]:x().map(U=>(()=>{var te=Mm(),ae=te.firstChild,re=ae.firstChild,ce=re.nextSibling,Q=ce.firstChild,me=ae.nextSibling;return i(re,()=>U.description),i(ce,()=>I(U.date),Q),i(ce,()=>U.reference,null),i(ce,(()=>{var K=ge(()=>!!U.isReconciled);return()=>K()&&(()=>{var he=ic();return he.firstChild,he.style.setProperty("color","#4caf50"),he.style.setProperty("margin-left","0.5rem"),i(he,()=>e("banking.reconciled"),null),he})()})(),null),i(me,()=>U.debitAmount>0?"+":"-",null),i(me,()=>w(U.debitAmount||U.creditAmount),null),X(K=>{var he=B(!1,U.isReconciled),ve=V,W=f,ie=g,Pe=S(U.debitAmount>0);return K.e=d(te,he,K.e),K.t=d(ae,ve,K.t),K.a=d(re,W,K.a),K.o=d(ce,ie,K.o),K.i=d(me,Pe,K.i),K},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),te})())})()),i(O,(()=>{var A=ge(()=>!!(a()&&!a().isReconciled));return()=>A()&&(()=>{var U=q2(),te=U.firstChild,ae=te.firstChild,re=te.nextSibling,ce=re.nextSibling;return U.style.setProperty("position","fixed"),U.style.setProperty("bottom","2rem"),U.style.setProperty("right","2rem"),U.style.setProperty("background","var(--surface-color)"),U.style.setProperty("padding","1rem"),U.style.setProperty("border-radius","var(--border-radius)"),U.style.setProperty("box-shadow","var(--shadow-lg)"),U.style.setProperty("border","1px solid var(--border-color)"),U.style.setProperty("max-width","300px"),te.style.setProperty("font-weight","500"),te.style.setProperty("margin-bottom","0.5rem"),i(te,()=>e("banking.selected"),ae),re.style.setProperty("font-size","0.875rem"),re.style.setProperty("margin-bottom","0.5rem"),i(re,()=>a().description),ce.style.setProperty("font-weight","600"),ce.style.setProperty("color","var(--primary-color)"),i(ce,()=>w(a().debitAmount||a().creditAmount)),i(U,b(qe,{variant:"secondary",size:"sm",onClick:()=>{l(null),h([])},style:{"margin-top":"0.5rem"},get children(){return e("banking.clearSelection")}}),null),U})()})(),null),X(A=>{var U=j(m()==="all"),te=j(m()==="unreconciled"),ae=j(m()==="reconciled"),re=Y,ce=Y;return A.e=d(C,U,A.e),A.t=d(F,te,A.t),A.a=d(ee,ae,A.a),A.o=d(le,re,A.o),A.i=d(L,ce,A.i),A},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),O})()};wt(["click"]);var H2=z("<div><div><h2></h2><p></p></div><div>"),W2=z("<div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date>"),Y2=z("<div><button></button><button>"),K2=z("<div><br>"),Gi=z("<div>"),Q2=z("<div><div></div><div>  </div><div>"),J2=z("<div>: "),X2=z("<div> <!>  <!> "),Z2=z("<div>%"),eI=z("<div> of <!> transactions");const tI=()=>{const{t}=ft(),[e,r]=ye(null),[n,o]=ye({start:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[s,a]=ye(!1),[l,u]=ye("overview");fn(()=>{!e()&&Pr.bankAccounts.length>0&&r(Pr.bankAccounts[0])});const h={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},m={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},v={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},_=Z=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:Z?"var(--primary-color)":"var(--text-muted)","border-bottom":Z?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),x={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},T=Z=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Z),E=Z=>new Date(Z).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),P=()=>Pr.bankAccounts.map(Z=>({value:Z.id,label:`${Z.bankName} - ${Z.accountNumber} (${Z.accountType})`})),Y=(()=>{if(!e())return null;const Z=Pr.getBankStatementsByAccount(e().accountId).filter(V=>V.date>=n().start&&V.date<=n().end),j=Pr.getEntryBookRecordsByAccount(e().accountId).filter(V=>V.date>=n().start&&V.date<=n().end),B=Z.filter(V=>V.isReconciled).length;return j.filter(V=>V.isReconciled).length,{totalBankTransactions:Z.length,totalEntryBookRecords:j.length,reconciledTransactions:B,unreconciledTransactions:Z.length-B,reconciliationRate:Z.length>0?B/Z.length*100:0}})();return b(an,{get title(){return t("banking.title")},get children(){return[(()=>{var Z=H2(),j=Z.firstChild,B=j.firstChild,V=B.nextSibling,f=j.nextSibling;return d(Z,h),B.style.setProperty("margin","0 0 0.5rem 0"),B.style.setProperty("font-size","1.5rem"),i(B,()=>t("banking.reconciliation")),V.style.setProperty("margin","0"),V.style.setProperty("color","var(--text-muted)"),i(V,()=>t("banking.compareStatements")),f.style.setProperty("display","flex"),f.style.setProperty("gap","1rem"),i(f,b(qe,{variant:"secondary",onClick:()=>a(!0),get disabled(){return!e()},get children(){return t("banking.importCSV")}}),null),i(f,b(qe,{variant:"primary",get children(){return t("banking.startNewReconciliation")}}),null),Z})(),(()=>{var Z=W2(),j=Z.firstChild,B=j.firstChild,V=j.nextSibling,f=V.firstChild,g=f.nextSibling,S=V.nextSibling,$=S.firstChild,w=$.nextSibling;return d(Z,m),j.style.setProperty("flex","1"),B.style.setProperty("display","block"),B.style.setProperty("margin-bottom","0.5rem"),B.style.setProperty("font-weight","500"),i(B,()=>t("banking.bankAccount")),i(j,b(Dr,{label:"",get value(){return e()?.id||""},onChange:I=>{const y=Pr.getBankAccountById(I);r(y||null)},get options(){return P()}}),null),f.style.setProperty("display","block"),f.style.setProperty("margin-bottom","0.5rem"),f.style.setProperty("font-weight","500"),i(f,()=>t("entryBooks.startDate")),g.addEventListener("change",I=>o(y=>({...y,start:I.target.value}))),g.style.setProperty("padding","0.75rem"),g.style.setProperty("border","1px solid var(--border-color)"),g.style.setProperty("border-radius","var(--border-radius-sm)"),g.style.setProperty("font-family","inherit"),$.style.setProperty("display","block"),$.style.setProperty("margin-bottom","0.5rem"),$.style.setProperty("font-weight","500"),i($,()=>t("entryBooks.endDate")),w.addEventListener("change",I=>o(y=>({...y,end:I.target.value}))),w.style.setProperty("padding","0.75rem"),w.style.setProperty("border","1px solid var(--border-color)"),w.style.setProperty("border-radius","var(--border-radius-sm)"),w.style.setProperty("font-family","inherit"),X(()=>g.value=n().start),X(()=>w.value=n().end),Z})(),(()=>{var Z=Y2(),j=Z.firstChild,B=j.nextSibling;return d(Z,v),j.$$click=()=>u("overview"),i(j,()=>t("common.overview")),B.$$click=()=>u("reconciliation"),i(B,()=>t("banking.reconciliation")),X(V=>{var f=_(l()==="overview"),g=_(l()==="reconciliation");return V.e=d(j,f,V.e),V.t=d(B,g,V.t),V},{e:void 0,t:void 0}),Z})(),ge(()=>ge(()=>l()==="overview")()&&(()=>{var Z=Gi();return i(Z,(()=>{var j=ge(()=>!!e());return()=>j()&&(()=>{var B=Gi();return d(B,x),i(B,b(rt,{get title(){return t("banking.bankAccountInfo")},get subtitle(){return t("banking.currentAccountDetails")},get children(){return[(()=>{var V=Q2(),f=V.firstChild,g=f.nextSibling,S=g.firstChild,$=g.nextSibling;return V.style.setProperty("margin-bottom","1rem"),f.style.setProperty("font-weight","600"),f.style.setProperty("margin-bottom","0.5rem"),i(f,()=>e().bankName),g.style.setProperty("color","var(--text-muted)"),g.style.setProperty("margin-bottom","0.5rem"),i(g,()=>e().accountNumber,S),i(g,()=>e().accountType,null),$.style.setProperty("font-size","1.25rem"),$.style.setProperty("font-weight","600"),$.style.setProperty("color","var(--primary-color)"),i($,()=>T(e().currentBalance)),V})(),ge(()=>ge(()=>!!e().lastReconciledDate)()&&(()=>{var V=J2(),f=V.firstChild;return V.style.setProperty("font-size","0.875rem"),V.style.setProperty("color","var(--text-muted)"),i(V,()=>t("banking.lastReconciled"),f),i(V,()=>E(e().lastReconciledDate),null),V})())]}}),null),i(B,Y&&[b(rt,{get title(){return t("banking.bankTransactions")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var V=Gi();return V.style.setProperty("font-size","1.5rem"),V.style.setProperty("font-weight","600"),V.style.setProperty("color","var(--primary-color)"),V.style.setProperty("margin-bottom","0.5rem"),i(V,()=>Y.totalBankTransactions),V})(),(()=>{var V=X2(),f=V.firstChild,g=f.nextSibling,S=g.nextSibling,$=S.nextSibling;return $.nextSibling,V.style.setProperty("font-size","0.875rem"),V.style.setProperty("color","var(--text-muted)"),i(V,()=>Y.reconciledTransactions,f),i(V,()=>t("banking.reconciled"),g),i(V,()=>Y.unreconciledTransactions,$),i(V,()=>t("banking.pending"),null),V})()]}}),b(rt,{get title(){return t("entryBooks.entryBookRecords")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var V=Gi();return V.style.setProperty("font-size","1.5rem"),V.style.setProperty("font-weight","600"),V.style.setProperty("color","var(--primary-color)"),V.style.setProperty("margin-bottom","0.5rem"),i(V,()=>Y.totalEntryBookRecords),V})(),(()=>{var V=Gi();return V.style.setProperty("font-size","0.875rem"),V.style.setProperty("color","var(--text-muted)"),i(V,()=>t("banking.bookEntriesForComparison")),V})()]}}),b(rt,{get title(){return t("banking.reconciliationRate")},get subtitle(){return t("banking.completionStatus")},get children(){return[(()=>{var V=Z2(),f=V.firstChild;return V.style.setProperty("font-size","1.5rem"),V.style.setProperty("font-weight","600"),V.style.setProperty("margin-bottom","0.5rem"),i(V,()=>Math.round(Y.reconciliationRate),f),X(g=>(g=Y.reconciliationRate>80?"#4caf50":Y.reconciliationRate>50?"#ff9800":"#f44336")!=null?V.style.setProperty("color",g):V.style.removeProperty("color")),V})(),(()=>{var V=eI(),f=V.firstChild,g=f.nextSibling;return g.nextSibling,V.style.setProperty("font-size","0.875rem"),V.style.setProperty("color","var(--text-muted)"),i(V,()=>Y.reconciledTransactions,f),i(V,()=>Y.totalBankTransactions,g),V})()]}})],null),B})()})(),null),i(Z,b(rt,{get title(){return t("banking.recentReconciliationSessions")},get subtitle(){return t("banking.latestActivity")},get children(){var j=K2(),B=j.firstChild;return j.style.setProperty("text-align","center"),j.style.setProperty("color","var(--text-muted)"),j.style.setProperty("padding","2rem"),i(j,()=>t("banking.noRecentSessions"),B),i(j,b(qe,{variant:"primary",style:{"margin-top":"1rem"},onClick:()=>u("reconciliation"),get children(){return t("banking.startFirstReconciliation")}}),null),j}}),null),Z})()),ge(()=>ge(()=>!!(l()==="reconciliation"&&e()))()&&b(G2,{get bankAccountId(){return e().id},get selectedPeriod(){return n()}})),b(V2,{get isOpen(){return s()},onClose:()=>a(!1),get bankAccount(){return e()}})]}})};wt(["click"]);wt(["input","click"]);var rI=z("<h2>Upload Bank Statement CSV"),nI=z("<input type=file accept=.csv>"),oI=z("<h3>Filters"),iI=z('<div><input type=text placeholder="Search transactions..."><input type=date placeholder="Start Date"><input type=date placeholder="End Date"><button>Download Detailed Report'),sI=z("<div><button>Summary</button><button>Deposits</button><button>Payments</button><button>Timeline"),aI=z("<h3>Total Deposits"),da=z("<p>"),Om=z("<p> transactions"),lI=z("<h3>Total Payments"),cI=z("<h3>Net Cash Flow"),dI=z("<h3>Check Payments"),uI=z("<p> checks"),Hi=z("<div>"),hI=z("<h3>Accounts & Payment Methods Used"),mI=z("<h3>Monthly Cash Flow Trend"),yI=z("<div><table><thead><tr><th>Month</th><th>Deposits</th><th>Payments</th><th>Net</th></tr></thead><tbody>"),pI=z("<h2>Deposits by Type"),fI=z("<h2>Top Depositors"),gI=z("<div><table><thead><tr><th>Depositor</th><th>Total Amount</th><th>Count</th><th>Actions</th></tr></thead><tbody>"),vI=z("<h2>Payments by Category"),bI=z("<h2>Top Payees"),_I=z("<div><table><thead><tr><th>Payee</th><th>Category</th><th>Total Amount</th><th>Count</th></tr></thead><tbody>"),SI=z("<h2>Transaction Timeline"),PI=z("<div><h1>Detailed Bank Statement Analyzer"),wI=z("<span>"),CI=z("<tr><td></td><td></td><td></td><td>"),Fm=z("<div><h4></h4><p></p><p> transactions"),xI=z("<tr><td></td><td></td><td></td><td><details><summary>View</summary><div>"),$I=z("<div> - "),AI=z("<tr><td></td><td><span></span></td><td></td><td>"),II=z("<div><div><div></div><div>  </div></div><div><div>");const EI=()=>{const[t,e]=ye(""),[r,n]=ye("summary"),[o,s]=ye(""),[a,l]=ye({start:"",end:""}),[u,h]=el({list:[]}),m={Utilities:["AT&T","METRO BY T-MOBILE","COMCAST","STREAM ENERGY","NETFLIX","SPECTRUM"],checks:["CHECK"],JPM:["JPM","POVBR"],Transportation:["DRIVE AWAY","TRANPORT","QUICKQUACK","EXXON","SHELL","CHEVRON","UBER","LYFT","U-HAUL","UHAL","LOVE'S"],Lodging:["HOLIDAY INN","MARRIOTT","HILTON","AIRBNB","HOTEL","MOTEL"],"Food & Dining":["GOLDEN CORRAL","MOCTEZUMA","CHINA STAR","RESTAURANT","CAFE","STARBUCKS","BUFFET","GRILL","MARKET","SEAFOOD"],Shopping:["BURLINGTON","WALMART","TARGET","AMAZON","ROSS","KROGER","PUBLIC","AMZN","AMZ"],Financial:["AMERICANFIRSTFIN","LOAN","CREDIT"],Insurance:["INSURANCE","GEICO","STATE FARM"],Rent:["SHAFAII INVESTME"],Medical:["PHARMACY","CVS","WALGREENS","HOSPITAL","CLINIC"],Entertainment:["CINEMA","THEATER","CONCERT"],"Other Services":["BARBER","SALON","SPA","GYM"],Return:["RETURN ITEM "]},v=j=>{const B=j.toUpperCase();for(const[V,f]of Object.entries(m))for(const g of f)if(B.includes(g.toUpperCase()))return V;return"Other"},_=j=>{const B=j.match(/Zelle payment from ([^0-9]+)/i);if(B)return B[1].trim().replace(/[A-Z0-9]{10,}$/,"").trim();if(j.includes("CHECK"))return"Check Payment";const V=j.match(/^([^0-9]+)/);return V?V[1].trim():j.substring(0,30)},x=j=>{const B=j.trim().split(`
`),V=[];console.log(B);for(let f=1;f<B.length;f++){const g=B[f].split(",");if(console.log(g),g.length>=3){const S=parseFloat(g[2]);let $={postingDate:g[0],description:g[1],amount:S};V.push($)}}return console.log({transactions:V}),h("list",V),V};Ze(()=>t()?x(t()):[]);const T=Ze(()=>{let j=u?.list;if((a().start||a().end)&&(j=j.filter(B=>{const V=new Date(B.postingDate),f=a().start?new Date(a().start):new Date("2024-01-01"),g=a().end?new Date(a().end):new Date("2024-12-31");return V>=f&&V<=g})),o()){const B=o().toLowerCase();j=j.filter(V=>V.description.toLowerCase().includes(B)||Math.abs(V.amount).toString().includes(B))}return j}),E=Ze(()=>{const j={deposits:{total:0,count:0,byType:new Map,byPayee:new Map},payments:{total:0,count:0,byType:new Map,byPayee:new Map},checks:{total:0,count:0,transactions:[]},transfers:{total:0,count:0,transactions:[]},dailyBalances:new Map,accountsAffected:new Set};return T().forEach(B=>{const V=_(B.description);if(console.log({transaction:B}),j.dailyBalances.set(B.postingDate,B.amount),(B.description.includes("ZELLE")||B.description.includes("QUICKPAY"))&&j.accountsAffected.add("Zelle Account"),B.description.includes("ACH")&&j.accountsAffected.add("ACH Network"),B?.description.includes("DEBIT_CARD")&&j.accountsAffected.add("Debit Card"),B?.description.includes("CHECK")&&j.accountsAffected.add("Checking Account"),B?.description.includes("TRANSFER")&&j.accountsAffected.add("Savings Account"),B.amount>0){j.deposits.total+=B.amount,j.deposits.count++,j.deposits.byType.has(B.description)||j.deposits.byType.set(B.description,{total:0,count:0,transactions:[]});const f=j.deposits.byType.get(B.description);f.total+=B.amount,f.count++,f.transactions.push(B),j.deposits.byPayee.has(V)||j.deposits.byPayee.set(V,{name:V,totalAmount:0,transactionCount:0,transactions:[]});const g=j.deposits.byPayee.get(V);g.totalAmount+=B.amount,g.transactionCount++,g.transactions.push(B)}if(B.amount<0){j.payments.total+=Math.abs(B.amount),j.payments.count++,j.payments.byType.has(B.description)||j.payments.byType.set(B.description,{total:0,count:0,transactions:[]});const f=j.payments.byType.get(B.description);f.total+=Math.abs(B.amount),f.count++,f.transactions.push(B);const g=v(B.description);j.payments.byPayee.has(V)||j.payments.byPayee.set(V,{name:V,totalAmount:0,transactionCount:0,transactions:[],category:g});const S=j.payments.byPayee.get(V);S.totalAmount+=Math.abs(B.amount),S.transactionCount++,S.transactions.push(B)}(B.type==="CHECK_PAID"||B.checkNumber)&&(j.checks.total+=Math.abs(B.amount),j.checks.count++,j.checks.transactions.push(B)),(B.description.includes("TRANSFER")||B.description==="ACCT_XFER")&&(j.transfers.total+=Math.abs(B.amount),j.transfers.count++,j.transfers.transactions.push(B))}),console.log(j),j}),P=Ze(()=>{const j=new Map;return T().forEach(B=>{const V=B.postingDate.substring(0,7);j.has(V)||j.set(V,{deposits:0,payments:0,net:0});const f=j.get(V);B.amount>0?f.deposits+=B.amount:f.payments+=Math.abs(B.amount),f.net=f.deposits-f.payments}),Array.from(j.entries()).sort((B,V)=>B[0].localeCompare(V[0]))}),R=j=>{const V=j.target.files?.[0];if(V){const f=new FileReader;f.onload=g=>{console.log(g.target?.result),x(g.target?.result)},f.readAsText(V)}},Y=()=>{const j=E();let B=`# DETAILED BANK STATEMENT ANALYSIS
`;B+=`Generated: ${new Date().toLocaleDateString()}

`,B+=`## EXECUTIVE SUMMARY

`,B+=`- **Total Deposits:** $${j.deposits.total.toFixed(2)} (${j.deposits.count} transactions)
`,B+=`- **Total Payments:** $${j.payments.total.toFixed(2)} (${j.payments.count} transactions)
`,B+=`- **Net Cash Flow:** $${(j.deposits.total-j.payments.total).toFixed(2)}
`,B+=`- **Check Payments:** $${j.checks.total.toFixed(2)} (${j.checks.count} checks)
`,B+=`- **Transfers:** $${j.transfers.total.toFixed(2)} (${j.transfers.count} transfers)

`,B+=`## ACCOUNTS AFFECTED

`,j.accountsAffected.forEach(I=>{B+=`- ${I}
`}),B+=`
`,B+=`## DEPOSITS DETAIL

`,B+=`### By Type
`,j.deposits.byType.forEach((I,y)=>{B+=`- **${y}**: $${I.total.toFixed(2)} (${I.count} transactions)
`}),B+=`
### Top Depositors
`,Array.from(j.deposits.byPayee.entries()).sort((I,y)=>y[1].totalAmount-I[1].totalAmount).slice(0,20).forEach(([I,y])=>{B+=`- **${I}**: $${y.totalAmount.toFixed(2)} (${y.transactionCount} transactions)
`}),B+=`
## PAYMENTS DETAIL

`,B+=`### By Type
`,j.payments.byType.forEach((I,y)=>{B+=`- **${y}**: $${I.total.toFixed(2)} (${I.count} transactions)
`}),B+=`
### By Category
`;const f=new Map;j.payments.byPayee.forEach(I=>{const y=I.category||"Other";f.set(y,(f.get(y)||0)+I.totalAmount)}),Array.from(f.entries()).sort((I,y)=>y[1]-I[1]).forEach(([I,y])=>{B+=`- **${I}**: $${y.toFixed(2)}
`}),B+=`
### Top Payees
`,Array.from(j.payments.byPayee.entries()).sort((I,y)=>y[1].totalAmount-I[1].totalAmount).slice(0,20).forEach(([I,y])=>{B+=`- **${I}** (${y.category}): $${y.totalAmount.toFixed(2)} (${y.transactionCount} transactions)
`}),B+=`
## MONTHLY CASH FLOW TREND

`,P().forEach(([I,y])=>{B+=`- **${I}**: Deposits: $${y.deposits.toFixed(2)} | Payments: $${y.payments.toFixed(2)} | Net: $${y.net.toFixed(2)}
`}),j.checks.transactions.length>0&&(B+=`
## CHECK PAYMENTS DETAIL

`,j.checks.transactions.forEach(I=>{B+=`- Check #${I.checkNumber||"N/A"} - ${I.postingDate} - $${Math.abs(I.amount).toFixed(2)}
`}));const S=new Blob([B],{type:"text/markdown"}),$=URL.createObjectURL(S),w=document.createElement("a");w.href=$,w.download=`detailed_bank_analysis_${new Date().toISOString().split("T")[0]}.md`,w.click(),URL.revokeObjectURL($)},Z=j=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(j);return(()=>{var j=PI(),B=j.firstChild;return j.style.setProperty("padding","2rem"),B.style.setProperty("margin-bottom","2rem"),i(j,b(rt,{style:{"margin-bottom":"2rem"},get children(){return[rI(),(()=>{var V=nI();return V.addEventListener("change",R),V.style.setProperty("margin-top","1rem"),V})()]}}),null),i(j,b(Ae,{get when(){return u?.list},get children(){return[b(rt,{style:{"margin-bottom":"2rem"},get children(){return[oI(),(()=>{var V=iI(),f=V.firstChild,g=f.nextSibling,S=g.nextSibling,$=S.nextSibling;return V.style.setProperty("display","flex"),V.style.setProperty("gap","1rem"),V.style.setProperty("margin-top","1rem"),V.style.setProperty("flex-wrap","wrap"),f.$$input=w=>s(w.currentTarget.value),f.style.setProperty("flex","1"),f.style.setProperty("min-width","200px"),f.style.setProperty("padding","0.5rem"),g.$$input=w=>l({...a(),start:w.currentTarget.value}),S.$$input=w=>l({...a(),end:w.currentTarget.value}),$.$$click=Y,$.style.setProperty("padding","0.5rem 1rem"),$.style.setProperty("background","var(--primary-color)"),$.style.setProperty("color","white"),$.style.setProperty("border","none"),$.style.setProperty("border-radius","var(--border-radius-sm)"),$.style.setProperty("cursor","pointer"),X(()=>f.value=o()),X(()=>g.value=a().start),X(()=>S.value=a().end),V})()]}}),(()=>{var V=sI(),f=V.firstChild,g=f.nextSibling,S=g.nextSibling,$=S.nextSibling;return V.style.setProperty("display","flex"),V.style.setProperty("gap","1rem"),V.style.setProperty("margin-bottom","2rem"),f.$$click=()=>n("summary"),f.style.setProperty("padding","0.5rem 1rem"),f.style.setProperty("border","none"),f.style.setProperty("border-radius","var(--border-radius-sm)"),f.style.setProperty("cursor","pointer"),g.$$click=()=>n("deposits"),g.style.setProperty("padding","0.5rem 1rem"),g.style.setProperty("border","none"),g.style.setProperty("border-radius","var(--border-radius-sm)"),g.style.setProperty("cursor","pointer"),S.$$click=()=>n("payments"),S.style.setProperty("padding","0.5rem 1rem"),S.style.setProperty("border","none"),S.style.setProperty("border-radius","var(--border-radius-sm)"),S.style.setProperty("cursor","pointer"),$.$$click=()=>n("timeline"),$.style.setProperty("padding","0.5rem 1rem"),$.style.setProperty("border","none"),$.style.setProperty("border-radius","var(--border-radius-sm)"),$.style.setProperty("cursor","pointer"),X(w=>{var I=r()==="summary"?"var(--primary-color)":"#e9ecef",y=r()==="summary"?"white":"black",de=r()==="deposits"?"var(--primary-color)":"#e9ecef",J=r()==="deposits"?"white":"black",O=r()==="payments"?"var(--primary-color)":"#e9ecef",N=r()==="payments"?"white":"black",q=r()==="timeline"?"var(--primary-color)":"#e9ecef",D=r()==="timeline"?"white":"black";return I!==w.e&&((w.e=I)!=null?f.style.setProperty("background",I):f.style.removeProperty("background")),y!==w.t&&((w.t=y)!=null?f.style.setProperty("color",y):f.style.removeProperty("color")),de!==w.a&&((w.a=de)!=null?g.style.setProperty("background",de):g.style.removeProperty("background")),J!==w.o&&((w.o=J)!=null?g.style.setProperty("color",J):g.style.removeProperty("color")),O!==w.i&&((w.i=O)!=null?S.style.setProperty("background",O):S.style.removeProperty("background")),N!==w.n&&((w.n=N)!=null?S.style.setProperty("color",N):S.style.removeProperty("color")),q!==w.s&&((w.s=q)!=null?$.style.setProperty("background",q):$.style.removeProperty("background")),D!==w.h&&((w.h=D)!=null?$.style.setProperty("color",D):$.style.removeProperty("color")),w},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),V})(),b(Ae,{get when(){return r()==="summary"},get children(){return[(()=>{var V=Hi();return V.style.setProperty("display","grid"),V.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),V.style.setProperty("gap","1rem"),V.style.setProperty("margin-bottom","2rem"),i(V,b(rt,{get children(){return[aI(),(()=>{var f=da();return f.style.setProperty("font-size","2rem"),f.style.setProperty("font-weight","bold"),f.style.setProperty("color","#22c55e"),i(f,()=>Z(E().deposits.total)),f})(),(()=>{var f=Om(),g=f.firstChild;return f.style.setProperty("color","#6c757d"),i(f,()=>E().deposits.count,g),f})()]}}),null),i(V,b(rt,{get children(){return[lI(),(()=>{var f=da();return f.style.setProperty("font-size","2rem"),f.style.setProperty("font-weight","bold"),f.style.setProperty("color","#ef4444"),i(f,()=>Z(E().payments.total)),f})(),(()=>{var f=Om(),g=f.firstChild;return f.style.setProperty("color","#6c757d"),i(f,()=>E().payments.count,g),f})()]}}),null),i(V,b(rt,{get children(){return[cI(),(()=>{var f=da();return f.style.setProperty("font-size","2rem"),f.style.setProperty("font-weight","bold"),i(f,()=>Z(E().deposits.total-E().payments.total)),X(g=>(g=E().deposits.total-E().payments.total>=0?"#22c55e":"#ef4444")!=null?f.style.setProperty("color",g):f.style.removeProperty("color")),f})()]}}),null),i(V,b(rt,{get children(){return[dI(),(()=>{var f=da();return f.style.setProperty("font-size","2rem"),f.style.setProperty("font-weight","bold"),f.style.setProperty("color","#3b82f6"),i(f,()=>Z(E().checks.total)),f})(),(()=>{var f=uI(),g=f.firstChild;return f.style.setProperty("color","#6c757d"),i(f,()=>E().checks.count,g),f})()]}}),null),V})(),b(rt,{style:{"margin-bottom":"2rem"},get children(){return[hI(),(()=>{var V=Hi();return V.style.setProperty("display","flex"),V.style.setProperty("flex-wrap","wrap"),V.style.setProperty("gap","0.5rem"),V.style.setProperty("margin-top","1rem"),i(V,b(ut,{get each(){return Array.from(E().accountsAffected)},children:f=>(()=>{var g=wI();return g.style.setProperty("padding","0.25rem 0.75rem"),g.style.setProperty("background","#e9ecef"),g.style.setProperty("border-radius","9999px"),g.style.setProperty("font-size","0.875rem"),i(g,f),g})()})),V})()]}}),b(rt,{get children(){return[mI(),(()=>{var V=yI(),f=V.firstChild,g=f.firstChild,S=g.firstChild,$=S.firstChild,w=$.nextSibling,I=w.nextSibling,y=I.nextSibling,de=g.nextSibling;return V.style.setProperty("overflow-x","auto"),f.style.setProperty("width","100%"),f.style.setProperty("border-collapse","collapse"),f.style.setProperty("margin-top","1rem"),S.style.setProperty("border-bottom","2px solid #dee2e6"),$.style.setProperty("padding","0.75rem"),$.style.setProperty("text-align","left"),w.style.setProperty("padding","0.75rem"),w.style.setProperty("text-align","right"),I.style.setProperty("padding","0.75rem"),I.style.setProperty("text-align","right"),y.style.setProperty("padding","0.75rem"),y.style.setProperty("text-align","right"),i(de,b(ut,{get each(){return P()},children:([J,O])=>(()=>{var N=CI(),q=N.firstChild,D=q.nextSibling,C=D.nextSibling,F=C.nextSibling;return N.style.setProperty("border-bottom","1px solid #dee2e6"),q.style.setProperty("padding","0.75rem"),i(q,J),D.style.setProperty("padding","0.75rem"),D.style.setProperty("text-align","right"),D.style.setProperty("color","#22c55e"),i(D,()=>Z(isNaN(O.deposits)?0:O.deposits)),C.style.setProperty("padding","0.75rem"),C.style.setProperty("text-align","right"),C.style.setProperty("color","#ef4444"),i(C,()=>Z(isNaN(O.payments)?0:O.payments)),F.style.setProperty("padding","0.75rem"),F.style.setProperty("text-align","right"),F.style.setProperty("font-weight","bold"),i(F,()=>Z(O.net)),X(ee=>(ee=O.net>=0?"#22c55e":"#ef4444")!=null?F.style.setProperty("color",ee):F.style.removeProperty("color")),N})()})),V})()]}})]}}),b(Ae,{get when(){return r()==="deposits"},get children(){return[b(rt,{style:{"margin-bottom":"2rem"},get children(){return[pI(),(()=>{var V=Hi();return V.style.setProperty("display","grid"),V.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(300px, 1fr))"),V.style.setProperty("gap","1rem"),V.style.setProperty("margin-top","1rem"),i(V,b(ut,{get each(){return Array.from(E().deposits.byType.entries())},children:([f,g])=>(()=>{var S=Fm(),$=S.firstChild,w=$.nextSibling,I=w.nextSibling,y=I.firstChild;return S.style.setProperty("padding","1rem"),S.style.setProperty("background","#f8f9fa"),S.style.setProperty("border-radius","var(--border-radius-sm)"),S.style.setProperty("border","1px solid #e9ecef"),i($,f),w.style.setProperty("font-size","1.5rem"),w.style.setProperty("font-weight","bold"),w.style.setProperty("color","#22c55e"),i(w,()=>Z(g.total)),I.style.setProperty("color","#6c757d"),i(I,()=>g.count,y),S})()})),V})()]}}),b(rt,{get children(){return[fI(),(()=>{var V=gI(),f=V.firstChild,g=f.firstChild,S=g.firstChild,$=S.firstChild,w=$.nextSibling,I=w.nextSibling,y=I.nextSibling,de=g.nextSibling;return V.style.setProperty("overflow-x","auto"),f.style.setProperty("width","100%"),f.style.setProperty("border-collapse","collapse"),f.style.setProperty("margin-top","1rem"),S.style.setProperty("border-bottom","2px solid #dee2e6"),$.style.setProperty("padding","0.75rem"),$.style.setProperty("text-align","left"),w.style.setProperty("padding","0.75rem"),w.style.setProperty("text-align","right"),I.style.setProperty("padding","0.75rem"),I.style.setProperty("text-align","center"),y.style.setProperty("padding","0.75rem"),y.style.setProperty("text-align","center"),i(de,b(ut,{get each(){return Array.from(E().deposits.byPayee.entries()).sort((J,O)=>O[1].totalAmount-J[1].totalAmount).slice(0,20)},children:([J,O])=>(()=>{var N=xI(),q=N.firstChild,D=q.nextSibling,C=D.nextSibling,F=C.nextSibling,ee=F.firstChild,H=ee.firstChild,oe=H.nextSibling;return N.style.setProperty("border-bottom","1px solid #dee2e6"),q.style.setProperty("padding","0.75rem"),i(q,J),D.style.setProperty("padding","0.75rem"),D.style.setProperty("text-align","right"),D.style.setProperty("color","#22c55e"),D.style.setProperty("font-weight","bold"),i(D,()=>Z(O.totalAmount)),C.style.setProperty("padding","0.75rem"),C.style.setProperty("text-align","center"),i(C,()=>O.transactionCount),F.style.setProperty("padding","0.75rem"),F.style.setProperty("text-align","center"),H.style.setProperty("cursor","pointer"),oe.style.setProperty("margin-top","0.5rem"),oe.style.setProperty("font-size","0.875rem"),i(oe,b(ut,{get each(){return O.transactions.slice(0,5)},children:M=>(()=>{var G=$I(),le=G.firstChild;return G.style.setProperty("padding","0.25rem"),i(G,()=>M.postingDate,le),i(G,()=>Z(M.amount),null),G})()})),N})()})),V})()]}})]}}),b(Ae,{get when(){return r()==="payments"},get children(){return[b(rt,{style:{"margin-bottom":"2rem"},get children(){return[vI(),(()=>{var V=Hi();return V.style.setProperty("display","grid"),V.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),V.style.setProperty("gap","1rem"),V.style.setProperty("margin-top","1rem"),i(V,()=>{const f=new Map;return E().payments.byPayee.forEach(g=>{const S=g.category||"Other";f.has(S)||f.set(S,{total:0,count:0});const $=f.get(S);$.total+=g.totalAmount,$.count+=g.transactionCount}),Array.from(f.entries()).sort((g,S)=>S[1].total-g[1].total).map(([g,S])=>(()=>{var $=Fm(),w=$.firstChild,I=w.nextSibling,y=I.nextSibling,de=y.firstChild;return $.style.setProperty("padding","1rem"),$.style.setProperty("background","#f8f9fa"),$.style.setProperty("border-radius","var(--border-radius-sm)"),$.style.setProperty("border","1px solid #e9ecef"),i(w,g),I.style.setProperty("font-size","1.5rem"),I.style.setProperty("font-weight","bold"),I.style.setProperty("color","#ef4444"),i(I,()=>Z(S.total)),y.style.setProperty("color","#6c757d"),i(y,()=>S.count,de),$})())}),V})()]}}),b(rt,{get children(){return[bI(),(()=>{var V=_I(),f=V.firstChild,g=f.firstChild,S=g.firstChild,$=S.firstChild,w=$.nextSibling,I=w.nextSibling,y=I.nextSibling,de=g.nextSibling;return V.style.setProperty("overflow-x","auto"),f.style.setProperty("width","100%"),f.style.setProperty("border-collapse","collapse"),f.style.setProperty("margin-top","1rem"),S.style.setProperty("border-bottom","2px solid #dee2e6"),$.style.setProperty("padding","0.75rem"),$.style.setProperty("text-align","left"),w.style.setProperty("padding","0.75rem"),w.style.setProperty("text-align","left"),I.style.setProperty("padding","0.75rem"),I.style.setProperty("text-align","right"),y.style.setProperty("padding","0.75rem"),y.style.setProperty("text-align","center"),i(de,b(ut,{get each(){return Array.from(E().payments.byPayee.entries()).sort((J,O)=>O[1].totalAmount-J[1].totalAmount).slice(0,130)},children:([J,O])=>(()=>{var N=AI(),q=N.firstChild,D=q.nextSibling,C=D.firstChild,F=D.nextSibling,ee=F.nextSibling;return N.style.setProperty("border-bottom","1px solid #dee2e6"),q.style.setProperty("padding","0.75rem"),i(q,J),D.style.setProperty("padding","0.75rem"),C.style.setProperty("padding","0.25rem 0.5rem"),C.style.setProperty("background","#e9ecef"),C.style.setProperty("border-radius","4px"),C.style.setProperty("font-size","0.875rem"),i(C,()=>O.category),F.style.setProperty("padding","0.75rem"),F.style.setProperty("text-align","right"),F.style.setProperty("color","#ef4444"),F.style.setProperty("font-weight","bold"),i(F,()=>Z(O.totalAmount)),ee.style.setProperty("padding","0.75rem"),ee.style.setProperty("text-align","center"),i(ee,()=>O.transactionCount),N})()})),V})()]}})]}}),b(Ae,{get when(){return r()==="timeline"},get children(){return b(rt,{get children(){return[SI(),(()=>{var V=Hi();return V.style.setProperty("max-height","600px"),V.style.setProperty("overflow-y","auto"),V.style.setProperty("margin-top","1rem"),i(V,b(ut,{get each(){return T().slice(0,100)},children:f=>(()=>{var g=II(),S=g.firstChild,$=S.firstChild,w=$.nextSibling,I=w.firstChild,y=S.nextSibling,de=y.firstChild;return g.style.setProperty("padding","1rem"),g.style.setProperty("border-bottom","1px solid #e9ecef"),g.style.setProperty("display","flex"),g.style.setProperty("justify-content","space-between"),g.style.setProperty("align-items","center"),S.style.setProperty("flex","1"),$.style.setProperty("font-weight","bold"),i($,()=>f.description),w.style.setProperty("font-size","0.875rem"),w.style.setProperty("color","#6c757d"),i(w,()=>f.postingDate,I),i(w,()=>f.type,null),i(w,()=>f.checkNumber&&`  Check #${f.checkNumber}`,null),y.style.setProperty("text-align","right"),de.style.setProperty("font-weight","bold"),de.style.setProperty("font-size","1.1rem"),i(de,()=>Z(Math.abs(f.amount)),null),i(de,()=>f.amount>=0?" ":" ",null),X(J=>(J=f.amount>=0?"#22c55e":"#ef4444")!=null?de.style.setProperty("color",J):de.style.removeProperty("color")),g})()})),V})()]}})}})]}}),null),j})()};wt(["input","click"]);var TI=z("<div><div></div><div>"),sc=z("<div>"),kI=z("<div>  <!>  <!> "),RI=z("<div><div><div></div><div></div></div><div><div></div><div>"),DI=z("<div><div>:"),NI=z("<div> <!>: <!> <!>, <!> "),LI=z("<div><div><div></div><div></div></div><div>"),Vm=z("<div> "),MI=z("<div> ");const OI=t=>{const{t:e}=ft(),r={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},n={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},o={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},s={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)","margin-bottom":"0.5rem"},a={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"1rem"},l={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},u={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},h={"max-height":"100px","overflow-y":"auto","border-top":"1px solid var(--border-color)","padding-top":"1rem"},m={display:"flex","justify-content":"space-between","align-items":"center","font-size":"0.875rem","margin-bottom":"0.5rem"},v={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},_=R=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[R],x=R=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(R),T=R=>new Date(R).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),E=_(t.entry.status),P=Math.abs(t.entry.totalDebit-t.entry.totalCredit)<.01;return b(rt,{get children(){return[(()=>{var R=TI(),Y=R.firstChild,Z=Y.nextSibling;return d(R,r),d(Y,n),i(Y,()=>t.entry.entryNumber),i(Z,()=>t.entry.status),X(j=>d(Z,{...o,background:E.bg,color:E.color},j)),R})(),(()=>{var R=sc();return d(R,s),i(R,()=>t.entry.description),R})(),(()=>{var R=kI(),Y=R.firstChild,Z=Y.nextSibling,j=Z.nextSibling,B=j.nextSibling;return B.nextSibling,d(R,a),i(R,()=>T(t.entry.date),Y),i(R,()=>t.entry.reference||e("journal.noReference","No reference"),Z),i(R,()=>e("journal.createdBy","By"),B),i(R,()=>t.entry.createdBy,null),R})(),(()=>{var R=RI(),Y=R.firstChild,Z=Y.firstChild,j=Z.nextSibling,B=Y.nextSibling,V=B.firstChild,f=V.nextSibling;return d(R,l),Z.style.setProperty("font-size","0.875rem"),Z.style.setProperty("color","var(--text-muted)"),i(Z,()=>e("journal.totalAmount","Total Amount")),d(j,u),i(j,()=>x(t.entry.totalDebit)),B.style.setProperty("text-align","right"),V.style.setProperty("font-size","0.875rem"),V.style.setProperty("color","var(--text-muted)"),i(V,()=>e("journal.lines","Lines")),f.style.setProperty("font-weight","600"),i(f,()=>t.entry.lines.length),R})(),ge(()=>!P&&(()=>{var R=NI(),Y=R.firstChild,Z=Y.nextSibling,j=Z.nextSibling,B=j.nextSibling,V=B.nextSibling,f=V.nextSibling,g=f.nextSibling,S=g.nextSibling;return S.nextSibling,R.style.setProperty("padding","0.5rem"),R.style.setProperty("border-radius","var(--border-radius-sm)"),R.style.setProperty("background","#f8d7da"),R.style.setProperty("color","#721c24"),R.style.setProperty("font-size","0.875rem"),R.style.setProperty("margin-bottom","1rem"),i(R,()=>e("journal.entryNotBalancedShort","Entry is not balanced"),Z),i(R,()=>e("journal.debit"),B),i(R,()=>x(t.entry.totalDebit),f),i(R,()=>e("journal.credit"),S),i(R,()=>x(t.entry.totalCredit),null),R})()),(()=>{var R=DI(),Y=R.firstChild,Z=Y.firstChild;return d(R,h),Y.style.setProperty("font-weight","500"),Y.style.setProperty("margin-bottom","0.5rem"),Y.style.setProperty("font-size","0.875rem"),i(Y,()=>e("journal.accountLines","Account Lines"),Z),i(R,()=>t.entry.lines.slice(0,3).map(j=>(()=>{var B=LI(),V=B.firstChild,f=V.firstChild,g=f.nextSibling,S=V.nextSibling;return d(B,m),V.style.setProperty("flex","1"),f.style.setProperty("font-weight","500"),i(f,()=>j.accountName),g.style.setProperty("font-size","0.75rem"),g.style.setProperty("color","var(--text-muted)"),i(g,()=>j.description||e("journal.noDescription","No description")),S.style.setProperty("text-align","right"),i(S,(()=>{var $=ge(()=>j.debitAmount>0);return()=>$()&&(()=>{var w=Vm(),I=w.firstChild;return w.style.setProperty("color","#4caf50"),w.style.setProperty("font-weight","500"),i(w,()=>e("journal.debitShort","Dr."),I),i(w,()=>x(j.debitAmount),null),w})()})(),null),i(S,(()=>{var $=ge(()=>j.creditAmount>0);return()=>$()&&(()=>{var w=Vm(),I=w.firstChild;return w.style.setProperty("color","#f44336"),w.style.setProperty("font-weight","500"),i(w,()=>e("journal.creditShort","Cr."),I),i(w,()=>x(j.creditAmount),null),w})()})(),null),i(S,(()=>{var $=ge(()=>!!j.reconciled);return()=>$()&&(()=>{var w=MI();return w.firstChild,w.style.setProperty("font-size","0.75rem"),w.style.setProperty("color","#4caf50"),i(w,()=>e("banking.reconciled","Reconciled"),null),w})()})(),null),B})()),null),i(R,(()=>{var j=ge(()=>t.entry.lines.length>3);return()=>j()&&(()=>{var B=sc();return B.style.setProperty("text-align","center"),B.style.setProperty("color","var(--text-muted)"),B.style.setProperty("font-size","0.875rem"),i(B,()=>e("journal.andMoreLines","... and {count} more lines").replace("{count}",(t.entry.lines.length-3).toString())),B})()})(),null),R})(),(()=>{var R=sc();return d(R,v),i(R,b(qe,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.entry),get children(){return e("journal.viewDetails","View Details")}})),R})()]}})},FI=[{id:"je1",entryNumber:"JE-2024-001",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",status:"posted",createdBy:"John Doe",createdAt:"2024-01-15T09:00:00Z",postedAt:"2024-01-15T09:05:00Z",totalDebit:5e3,totalCredit:5e3,lines:[{id:"jel1",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment from ABC Corp",debitAmount:5e3,creditAmount:0,reconciled:!0,reconciledWith:"eb1"},{id:"jel2",accountId:"2001",accountName:"Trade Receivables",description:"Payment received for INV-2024-001",debitAmount:0,creditAmount:5e3}]},{id:"je2",entryNumber:"JE-2024-002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",status:"posted",createdBy:"Jane Smith",createdAt:"2024-01-14T10:00:00Z",postedAt:"2024-01-14T10:15:00Z",totalDebit:250,totalCredit:250,lines:[{id:"jel3",accountId:"5200",accountName:"Office Expenses",description:"Office supplies from Staples",debitAmount:250,creditAmount:0},{id:"jel4",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment to Staples",debitAmount:0,creditAmount:250,reconciled:!0,reconciledWith:"eb2"}]},{id:"je3",entryNumber:"JE-2024-003",date:"2024-01-13",description:"Monthly Rent Payment",reference:"RENT-2024-01",status:"posted",createdBy:"John Doe",createdAt:"2024-01-13T08:00:00Z",postedAt:"2024-01-13T08:30:00Z",totalDebit:2e3,totalCredit:2e3,lines:[{id:"jel5",accountId:"5200",accountName:"Rent Expense",description:"January office rent",debitAmount:2e3,creditAmount:0},{id:"jel6",accountId:"1002",accountName:"Bank - Checking Account",description:"Rent payment",debitAmount:0,creditAmount:2e3,reconciled:!1}]},{id:"je4",entryNumber:"JE-2024-004",date:"2024-01-12",description:"Wire Transfer - Capital Investment",reference:"WIRE-001",status:"posted",createdBy:"Admin",createdAt:"2024-01-12T14:00:00Z",postedAt:"2024-01-12T14:30:00Z",totalDebit:1e4,totalCredit:1e4,lines:[{id:"jel7",accountId:"1002",accountName:"Bank - Checking Account",description:"Wire transfer received",debitAmount:1e4,creditAmount:0,reconciled:!1},{id:"jel8",accountId:"8",accountName:"Owner's Equity",description:"Capital investment",debitAmount:0,creditAmount:1e4}]},{id:"je5",entryNumber:"JE-2024-005",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",status:"posted",createdBy:"HR Manager",createdAt:"2024-01-11T16:00:00Z",postedAt:"2024-01-11T16:30:00Z",totalDebit:3500,totalCredit:3500,lines:[{id:"jel9",accountId:"13",accountName:"Salaries Expense",description:"Monthly salary - John Doe",debitAmount:3500,creditAmount:0},{id:"jel10",accountId:"1002",accountName:"Bank - Checking Account",description:"Salary payment",debitAmount:0,creditAmount:3500,reconciled:!1}]},{id:"je6",entryNumber:"JE-2024-006",date:"2024-01-10",description:"Product Sales - Multiple Customers",reference:"SALES-2024-010",status:"posted",createdBy:"Sales Manager",createdAt:"2024-01-10T11:00:00Z",postedAt:"2024-01-10T11:30:00Z",totalDebit:8500,totalCredit:8500,lines:[{id:"jel11",accountId:"1001",accountName:"Petty Cash",description:"Cash sales",debitAmount:1500,creditAmount:0},{id:"jel12",accountId:"2001",accountName:"Trade Receivables",description:"Credit sales",debitAmount:7e3,creditAmount:0},{id:"jel13",accountId:"10",accountName:"Sales Revenue",description:"Product sales revenue",debitAmount:0,creditAmount:8500}]},{id:"je7",entryNumber:"JE-2024-007",date:"2024-01-09",description:"Inventory Purchase",reference:"PO-2024-002",status:"draft",createdBy:"Warehouse Manager",createdAt:"2024-01-09T15:00:00Z",totalDebit:15e3,totalCredit:15e3,lines:[{id:"jel14",accountId:"3",accountName:"Inventory",description:"Product inventory purchase",debitAmount:15e3,creditAmount:0},{id:"jel15",accountId:"5",accountName:"Accounts Payable",description:"Amount owed to supplier",debitAmount:0,creditAmount:15e3}]},{id:"je8",entryNumber:"JE-2024-008",date:"2024-01-08",description:"Utility Bills Payment",reference:"UTIL-2024-01",status:"posted",createdBy:"Admin",createdAt:"2024-01-08T09:00:00Z",postedAt:"2024-01-08T09:30:00Z",totalDebit:450,totalCredit:450,lines:[{id:"jel16",accountId:"14",accountName:"Operating Expenses",description:"Electricity and water bills",debitAmount:450,creditAmount:0},{id:"jel17",accountId:"1003",accountName:"Bank - Savings Account",description:"Utility payment",debitAmount:0,creditAmount:450}]}],[nn,ac]=ye(FI),Bm=()=>nn().filter(e=>e.status==="posted").flatMap(e=>e.lines.filter(r=>["1001","1002","1003"].includes(r.accountId))).map(e=>{const r=nn().find(n=>n.lines.some(o=>o.id===e.id));return r?{id:`eb_${e.id}`,accountId:e.accountId,date:r.date,description:r.description,reference:r.reference,debitAmount:e.debitAmount,creditAmount:e.creditAmount,category:e.accountName,isReconciled:e.reconciled||!1,reconciledWith:e.reconciledWith,createdAt:r.createdAt}:null}).filter(e=>e!==null),Hn={get journalEntries(){return nn()},addJournalEntry(t){const e={...t,id:Date.now().toString()};return ac([...nn(),e]),e},updateJournalEntry(t,e){ac(nn().map(r=>r.id===t?{...r,...e}:r))},deleteJournalEntry(t){const e=nn().find(r=>r.id===t);if(e&&e.status==="posted")throw new Error("Cannot delete posted journal entries. Void them instead.");ac(nn().filter(r=>r.id!==t))},voidJournalEntry(t){this.updateJournalEntry(t,{status:"void"})},postJournalEntry(t){const e=nn().find(r=>r.id===t);if(!e)throw new Error("Journal entry not found");if(Math.abs(e.totalDebit-e.totalCredit)>.01)throw new Error("Journal entry is not balanced. Debits must equal credits.");this.updateJournalEntry(t,{status:"posted",postedAt:new Date().toISOString()}),Bm()},getJournalEntryById(t){return nn().find(e=>e.id===t)},getJournalEntriesByStatus(t){return nn().filter(e=>e.status===t)},getJournalEntriesByDateRange(t,e){return nn().filter(r=>r.date>=t&&r.date<=e)},getJournalEntriesByAccount(t){return nn().filter(e=>e.lines.some(r=>r.accountId===t))},getNextEntryNumber(){const t=new Date().getFullYear(),r=nn().filter(n=>n.entryNumber.includes(t.toString())).reduce((n,o)=>{const s=parseInt(o.entryNumber.split("-").pop()||"0");return s>n?s:n},0);return`JE-${t}-${String(r+1).padStart(3,"0")}`},validateJournalEntry(t){const e=[];if(t.date||e.push("Date is required"),t.description||e.push("Description is required"),(!t.lines||t.lines.length===0)&&e.push("At least one line item is required"),t.lines){const r=t.lines.reduce((o,s)=>o+(s.debitAmount||0),0),n=t.lines.reduce((o,s)=>o+(s.creditAmount||0),0);Math.abs(r-n)>.01&&e.push(`Entry is not balanced. Debit: ${r}, Credit: ${n}`),t.lines.forEach((o,s)=>{o.accountId||e.push(`Line ${s+1}: Account is required`),o.debitAmount===0&&o.creditAmount===0&&e.push(`Line ${s+1}: Either debit or credit amount must be provided`),o.debitAmount>0&&o.creditAmount>0&&e.push(`Line ${s+1}: Cannot have both debit and credit amounts`)})}return{isValid:e.length===0,errors:e}},getBankRelatedEntries(){return Bm()}};var VI=z("<form><div></div><div><div><h4></h4></div><div><div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div></div></div><div><div><strong>: </strong></div><div><strong>: </strong></div><div></div></div></div><div>"),Um=z("<div>");const sg=t=>{const{t:e}=ft(),[r,n]=ye({entryNumber:"",date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),[o,s]=ye([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),[a,l]=ye(null);fn(()=>{if(t.isOpen){if(t.editEntry)n({entryNumber:t.editEntry.entryNumber,date:t.editEntry.date,description:t.editEntry.description,reference:t.editEntry.reference,createdBy:t.editEntry.createdBy}),s(t.editEntry.lines.map((j,B)=>({...j,tempId:`line_${Date.now()}_${B}`})));else{const j=Hn.getNextEntryNumber();n({entryNumber:j,date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),s([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])}l(null)}});const u={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},h={display:"grid","grid-template-columns":"2fr 2fr 1fr 1fr 1fr",gap:"1rem","align-items":"end","margin-bottom":"1rem",padding:"1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},m={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},v=()=>Ft.accounts.map(j=>({value:j.id,label:`${j.accountNumber} - ${j.name}`})),_=(j,B)=>{n(V=>({...V,[j]:B}))},x=(j,B,V)=>{s(f=>f.map(g=>{if(g.tempId===j){const S={...g,[B]:V};if(B==="accountId"&&typeof V=="string"){const $=Ft.getAccountById(V);$&&(S.accountName=$.name)}return S}return g}))},T=()=>{s(j=>[...j,{tempId:`line_${Date.now()}_${j.length}`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])},E=j=>{o().length>2&&s(B=>B.filter(V=>V.tempId!==j))},P=()=>{const j=o().reduce((V,f)=>V+(f.debitAmount||0),0),B=o().reduce((V,f)=>V+(f.creditAmount||0),0);return{totalDebit:j,totalCredit:B,isBalanced:Math.abs(j-B)<.01}},R=j=>{j.preventDefault(),l(null);const B=r(),V=o(),{totalDebit:f,totalCredit:g,isBalanced:S}=P();if(!B.description){l(e("forms.descriptionRequired","Description is required"));return}if(V.length<2){l(e("journal.minTwoLinesRequired","At least 2 line items are required"));return}if(!S){l(e("journal.entryNotBalanced","Entry is not balanced. Debit: ${debit}, Credit: ${credit}").replace("${debit}",`$${f.toFixed(2)}`).replace("${credit}",`$${g.toFixed(2)}`));return}for(let w=0;w<V.length;w++){const I=V[w];if(!I.accountId){l(e("journal.lineAccountRequired","Line {lineNumber}: Account is required").replace("{lineNumber}",(w+1).toString()));return}if(I.debitAmount===0&&I.creditAmount===0){l(e("journal.lineAmountRequired","Line {lineNumber}: Either debit or credit amount must be provided").replace("{lineNumber}",(w+1).toString()));return}if((I.debitAmount||0)>0&&(I.creditAmount||0)>0){l(e("journal.lineBothAmounts","Line {lineNumber}: Cannot have both debit and credit amounts").replace("{lineNumber}",(w+1).toString()));return}}const $={entryNumber:B.entryNumber,date:B.date,description:B.description,reference:B.reference,status:"draft",createdBy:B.createdBy,createdAt:new Date().toISOString(),totalDebit:f,totalCredit:g,lines:V.map((w,I)=>{const{tempId:y,...de}=w;return{id:`jel_${Date.now()}_${I}`,...de}})};try{t.editEntry?Hn.updateJournalEntry(t.editEntry.id,$):Hn.addJournalEntry($),n({entryNumber:Hn.getNextEntryNumber(),date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),s([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),t.onClose()}catch(w){l(w instanceof Error?w.message:e("forms.errorOccurred","An error occurred"))}},Y=j=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(j),Z=P();return b(Ar,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return ge(()=>!!t.editEntry)()?e("journal.editEntry"):e("journal.addEntry","Add Journal Entry")},get children(){var j=VI(),B=j.firstChild,V=B.nextSibling,f=V.firstChild,g=f.firstChild,S=f.nextSibling,$=S.firstChild,w=$.firstChild,I=w.firstChild,y=w.nextSibling,de=y.firstChild,J=y.nextSibling,O=J.firstChild,N=J.nextSibling,q=N.firstChild,D=N.nextSibling,C=D.firstChild,F=S.nextSibling,ee=F.firstChild,H=ee.firstChild,oe=H.firstChild,M=ee.nextSibling,G=M.firstChild,le=G.firstChild,ne=M.nextSibling,ue=V.nextSibling;return j.addEventListener("submit",R),B.style.setProperty("display","grid"),B.style.setProperty("grid-template-columns","1fr 1fr"),B.style.setProperty("gap","1rem"),i(B,b(Qt,{get label(){return e("journal.entryNumber")},get value(){return r().entryNumber},onChange:L=>_("entryNumber",L),get disabled(){return!!t.editEntry},required:!0}),null),i(B,b(Qt,{get label(){return e("common.date")},type:"date",get value(){return r().date},onChange:L=>_("date",L),required:!0}),null),i(j,b(Qt,{get label(){return e("common.description")},get value(){return r().description},onChange:L=>_("description",L),get placeholder(){return e("journal.enterEntryDescription","Enter journal entry description")},required:!0}),V),i(j,b(Qt,{get label(){return e("journal.reference")},get value(){return r().reference},onChange:L=>_("reference",L),get placeholder(){return e("journal.enterReferenceNumber","Enter reference number")}}),V),V.style.setProperty("margin-top","2rem"),f.style.setProperty("display","flex"),f.style.setProperty("justify-content","space-between"),f.style.setProperty("align-items","center"),f.style.setProperty("margin-bottom","1rem"),g.style.setProperty("margin","0"),i(g,()=>e("journal.entryLines","Journal Entry Lines")),i(f,b(qe,{type:"button",variant:"secondary",size:"sm",onClick:T,get children(){return e("journal.addLine","Add Line")}}),null),S.style.setProperty("margin-bottom","1rem"),S.style.setProperty("font-size","0.875rem"),S.style.setProperty("color","var(--text-muted)"),$.style.setProperty("display","grid"),$.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1fr"),$.style.setProperty("gap","1rem"),i(I,()=>e("journal.account")),i(de,()=>e("common.description")),i(O,()=>e("journal.debit")),i(q,()=>e("journal.credit")),i(C,()=>e("common.actions")),i(V,b(ut,{get each(){return o()},children:L=>(()=>{var A=Um();return d(A,h),i(A,b(Dr,{label:"",get value(){return L.accountId||""},onChange:U=>x(L.tempId,"accountId",U),get options(){return v()}}),null),i(A,b(Qt,{label:"",get value(){return L.description||""},onChange:U=>x(L.tempId,"description",U),get placeholder(){return e("journal.lineDescription","Line description")}}),null),i(A,b(Qt,{label:"",type:"number",get value(){return L.debitAmount?.toString()||"0"},onChange:U=>{x(L.tempId,"debitAmount",parseFloat(U)||0),parseFloat(U)>0&&x(L.tempId,"creditAmount",0)},placeholder:"0.00"}),null),i(A,b(Qt,{label:"",type:"number",get value(){return L.creditAmount?.toString()||"0"},onChange:U=>{x(L.tempId,"creditAmount",parseFloat(U)||0),parseFloat(U)>0&&x(L.tempId,"debitAmount",0)},placeholder:"0.00"}),null),i(A,b(qe,{type:"button",variant:"outline",size:"sm",onClick:()=>E(L.tempId),get disabled(){return o().length<=2},get children(){return e("common.remove","Remove")}}),null),A})()}),F),d(F,m),i(H,()=>e("journal.totalDebit","Total Debit"),oe),i(H,()=>Y(Z.totalDebit),null),i(G,()=>e("journal.totalCredit","Total Credit"),le),i(G,()=>Y(Z.totalCredit),null),ne.style.setProperty("font-weight","600"),i(ne,(()=>{var L=ge(()=>!!Z.isBalanced);return()=>L()?` ${e("journal.balanced")}`:` ${e("journal.notBalanced","Not Balanced")}`})()),i(j,(()=>{var L=ge(()=>!!a());return()=>L()&&(()=>{var A=Um();return A.style.setProperty("padding","1rem"),A.style.setProperty("border-radius","var(--border-radius-sm)"),A.style.setProperty("margin-top","1rem"),A.style.setProperty("background","#f8d7da"),A.style.setProperty("color","#721c24"),A.style.setProperty("border","1px solid #f5c6cb"),i(A,a),A})()})(),ue),d(ue,u),i(ue,b(qe,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),i(ue,b(qe,{variant:"primary",type:"submit",get disabled(){return!Z.isBalanced},get children(){return ge(()=>!!t.editEntry)()?e("journal.updateEntry","Update Entry"):e("journal.saveAsDraft","Save as Draft")}}),null),X(L=>(L=Z.isBalanced?"#4caf50":"#f44336")!=null?ne.style.setProperty("color",L):ne.style.removeProperty("color")),j}})};var BI=z("<div><div></div><div></div><div></div><div>"),UI=z("<div><div></div><div></div><div></div><div></div><div>"),zI=z("<div><button></button><button> (<!>)</button><button> (<!>/<!>)"),zm=z("<div>"),jI=z("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><div><h4></h4><div></div></div><div>"),lc=z("<div><span></span><span>"),cc=z("<div><strong>:</strong> "),qI=z("<div><div><div></div><div></div><div></div><div></div><div></div></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div></div></div><div><div><strong> Reconciliation Summary</strong></div><div><div><div><strong>Total Lines:</strong> </div><div><strong>Reconciled:</strong> </div><div><strong>Unreconciled:</strong> </div></div><div><div><strong>Bank Accounts:</strong> </div><div><strong>Bank Reconciled:</strong> "),GI=z("<div><div><div></div><div></div></div><div></div><div></div><div></div><div>"),HI=z("<div><span> "),WI=z("<span>(<!>)"),YI=z("<div><strong>Bank Pending:</strong> "),KI=z("<div><div>Reconciled Lines:"),QI=z("<div><div> Pending Bank Reconciliation:</div><div>Visit Bank Consolidations to reconcile these transactions"),JI=z("<div><div><div><span></span><h3></h3></div><div><div><div></div><div>Total Lines</div></div><div><div></div><div>Reconciled</div></div><div><div></div><div>Pending"),XI=z("<div><h4> Reconciled Lines (<!>)"),ZI=z("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div> Matched"),eE=z("<div> "),tE=z("<div><h4> Unreconciled Lines (<!>)"),rE=z("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div> Pending"),nE=z("<div>Bank account"),oE=z("<div><div> Reconciliation Tip</div><div>This entry has unreconciled bank account transactions. Visit <strong>Bank Consolidations</strong> to match these with bank statements.");const iE=t=>{const{t:e}=ft(),[r,n]=ye("details"),[o,s]=ye(!1),a=Ze(()=>t.entryId?Hn.getJournalEntryById(t.entryId):null),l={"text-align":"center","margin-bottom":"2rem",position:"relative"},u={position:"absolute",top:"0",right:"0",display:"flex",gap:"0.5rem"},h={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","margin-bottom":"0.5rem"},m={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},v={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},_={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem",display:"inline-block"},x={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},T={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},E={"font-weight":"600",color:"var(--text-primary)"},P={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},R=y=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:y?"var(--primary-color)":"var(--text-muted)","border-bottom":y?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),Y={display:"grid","grid-template-columns":"2fr 2.5fr 1fr 1fr 1.5fr",gap:"1rem",padding:"1rem 0","border-bottom":"1px solid var(--border-color)","align-items":"center"},Z={...Y,"font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","border-bottom":"2px solid var(--border-color)"},j={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},B={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},V=y=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[y],f=y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(y),g=y=>new Date(y).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),S=y=>new Date(y).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),$=()=>{entry.status==="posted"&&!confirm(e("journal.confirmEditPosted","This entry has been posted. Editing will create a new draft copy. Continue?"))||s(!0)},w=()=>{if(a()&&confirm(e("journal.confirmPost","Are you sure you want to post this journal entry? This action cannot be undone.")))try{Hn.postJournalEntry(a().id)}catch(y){alert(y instanceof Error?y.message:e("forms.errorPostingEntry","An error occurred while posting the entry"))}},I=()=>{a()&&confirm(e("journal.confirmVoid","Are you sure you want to void this journal entry?"))&&Hn.voidJournalEntry(a().id)};return[b(Ar,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.entryDetails","Journal Entry Details")},get children(){return ge(()=>!a())()?(()=>{var y=BI(),de=y.firstChild,J=de.nextSibling,O=J.nextSibling,N=O.nextSibling;return y.style.setProperty("text-align","center"),y.style.setProperty("padding","3rem"),y.style.setProperty("color","var(--text-muted)"),de.style.setProperty("font-size","1.5rem"),de.style.setProperty("margin-bottom","1rem"),J.style.setProperty("font-size","1.1rem"),J.style.setProperty("margin-bottom","0.5rem"),i(J,()=>e("journal.entryNotFound","Entry Not Found")),O.style.setProperty("font-size","0.875rem"),i(O,()=>e("journal.entryNotFoundMessage","The journal entry you're looking for could not be found or may have been deleted.")),N.style.setProperty("margin-top","2rem"),i(N,b(qe,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),y})():(()=>{const y=a(),de=V(y.status),J=Math.abs(y.totalDebit-y.totalCredit)<.01;return[(()=>{var O=UI(),N=O.firstChild,q=N.nextSibling,D=q.nextSibling,C=D.nextSibling,F=C.nextSibling;return d(O,l),i(N,b(qe,{variant:"outline",size:"sm",onClick:$,get title(){return e("journal.editEntryTooltip","Edit this journal entry")},get children(){return e("common.edit")}}),null),i(N,(()=>{var ee=ge(()=>y.status==="draft");return()=>ee()&&b(qe,{variant:"primary",size:"sm",onClick:w,disabled:!J,get title(){return J?e("journal.postEntryTooltip","Post this journal entry"):e("journal.entryMustBeBalanced","Entry must be balanced to post")},get children(){return e("journal.post","Post")}})})(),null),i(N,(()=>{var ee=ge(()=>y.status==="posted");return()=>ee()&&b(qe,{variant:"outline",size:"sm",onClick:I,style:{color:"#dc3545","border-color":"#dc3545"},get title(){return e("journal.voidEntryTooltip","Void this journal entry")},get children(){return e("entryBooks.void","Void")}})})(),null),d(q,h),i(q,()=>y.entryNumber),d(D,m),i(D,()=>y.description),d(C,v),i(C,()=>f(y.totalDebit)),i(F,()=>y.status),X(ee=>{var H=u,oe={..._,background:de.bg,color:de.color};return ee.e=d(N,H,ee.e),ee.t=d(F,oe,ee.t),ee},{e:void 0,t:void 0}),O})(),(()=>{var O=zI(),N=O.firstChild,q=N.nextSibling,D=q.firstChild,C=D.nextSibling;C.nextSibling;var F=q.nextSibling,ee=F.firstChild,H=ee.nextSibling,oe=H.nextSibling,M=oe.nextSibling;return M.nextSibling,d(O,P),N.$$click=()=>n("details"),i(N,()=>e("common.details")),q.$$click=()=>n("lines"),i(q,()=>e("journal.journalLines","Journal Lines"),D),i(q,()=>y.lines.length,C),F.$$click=()=>n("reconciliation"),i(F,()=>e("banking.reconciliation","Reconciliation"),ee),i(F,()=>y.lines.filter(G=>G.reconciled).length,H),i(F,()=>y.lines.length,M),X(G=>{var le=R(r()==="details"),ne=R(r()==="lines"),ue=R(r()==="reconciliation");return G.e=d(N,le,G.e),G.t=d(q,ne,G.t),G.a=d(F,ue,G.a),G},{e:void 0,t:void 0,a:void 0}),O})(),ge(()=>ge(()=>r()==="details")()&&(()=>{var O=jI(),N=O.firstChild,q=N.firstChild,D=q.nextSibling,C=N.nextSibling,F=C.firstChild,ee=F.nextSibling,H=C.nextSibling,oe=H.firstChild,M=oe.nextSibling,G=H.nextSibling,le=G.firstChild,ne=le.nextSibling,ue=G.nextSibling,L=ue.firstChild,A=L.nextSibling,U=ue.nextSibling,te=U.firstChild,ae=te.nextSibling,re=U.nextSibling,ce=re.firstChild,Q=ce.nextSibling,me=re.nextSibling,K=me.firstChild,he=K.firstChild,ve=he.nextSibling,W=K.nextSibling;return i(q,()=>e("common.date")),i(D,()=>g(y.date)),i(F,()=>e("journal.reference")),i(ee,()=>y.reference||e("common.notAvailable","N/A")),i(oe,()=>e("journal.totalDebit")),i(M,()=>f(y.totalDebit)),i(le,()=>e("journal.totalCredit")),i(ne,()=>f(y.totalCredit)),i(L,()=>e("journal.balanceStatus","Balance Status")),i(A,()=>J?`${e("journal.balanced")} `:`${e("journal.unbalanced","Unbalanced")} (${f(Math.abs(y.totalDebit-y.totalCredit))} ${e("journal.difference","difference")})`),i(te,()=>e("journal.createdBy")),i(ae,()=>y.createdBy),i(ce,()=>e("journal.createdAt","Created At")),i(Q,()=>S(y.createdAt)),i(O,(()=>{var ie=ge(()=>!!y.postedAt);return()=>ie()&&(()=>{var Pe=lc(),_e=Pe.firstChild,fe=_e.nextSibling;return i(_e,()=>e("journal.postedAt","Posted At")),i(fe,()=>S(y.postedAt)),X(be=>{var pe=x,we=T,De=E;return be.e=d(Pe,pe,be.e),be.t=d(_e,we,be.t),be.a=d(fe,De,be.a),be},{e:void 0,t:void 0,a:void 0}),Pe})()})(),me),me.style.setProperty("margin-top","2rem"),me.style.setProperty("padding-top","1rem"),me.style.setProperty("border-top","2px solid var(--border-color)"),K.style.setProperty("display","flex"),K.style.setProperty("justify-content","space-between"),K.style.setProperty("align-items","center"),K.style.setProperty("margin-bottom","1rem"),he.style.setProperty("margin","0"),he.style.setProperty("font-size","1rem"),i(he,()=>e("journal.quickActions","Quick Actions")),ve.style.setProperty("display","flex"),ve.style.setProperty("gap","0.5rem"),i(ve,b(qe,{variant:"primary",size:"sm",onClick:$,get children(){return[" ",ge(()=>e("journal.editEntry"))]}}),null),i(ve,(()=>{var ie=ge(()=>y.status==="draft");return()=>ie()&&b(qe,{variant:"outline",size:"sm",onClick:w,disabled:!J,style:{"border-color":J?"#4caf50":"#f44336",color:J?"#4caf50":"#f44336"},get children(){return J?` ${e("journal.postEntry","Post Entry")}`:` ${e("journal.fixBalance","Fix Balance")}`}})})(),null),i(ve,(()=>{var ie=ge(()=>y.status==="posted");return()=>ie()&&b(qe,{variant:"outline",size:"sm",onClick:I,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return[" ",ge(()=>e("journal.voidEntry","Void Entry"))]}})})(),null),W.style.setProperty("padding","1rem"),W.style.setProperty("border-radius","var(--border-radius-sm)"),W.style.setProperty("font-size","0.875rem"),i(W,(()=>{var ie=ge(()=>y.status==="draft");return()=>ie()&&(()=>{var Pe=cc(),_e=Pe.firstChild,fe=_e.firstChild;return _e.nextSibling,i(_e,()=>e("journal.draftEntry","Draft Entry"),fe),i(Pe,()=>e("journal.draftEntryDescription","This entry can be edited and posted."),null),i(Pe,()=>!J&&`  ${e("journal.entryMustBeBalancedBeforePosting","Entry must be balanced before posting.")}`,null),Pe})()})(),null),i(W,(()=>{var ie=ge(()=>y.status==="posted");return()=>ie()&&(()=>{var Pe=cc(),_e=Pe.firstChild,fe=_e.firstChild;return _e.nextSibling,i(_e,()=>e("journal.postedEntry","Posted Entry"),fe),i(Pe,()=>e("journal.postedEntryDescription","This entry has been posted to the general ledger. Editing will create a new draft copy."),null),Pe})()})(),null),i(W,(()=>{var ie=ge(()=>y.status==="void");return()=>ie()&&(()=>{var Pe=cc(),_e=Pe.firstChild,fe=_e.firstChild;return _e.nextSibling,i(_e,()=>e("journal.voidEntry"),fe),i(Pe,()=>e("journal.voidEntryDescription","This entry has been voided and cannot be modified."),null),Pe})()})(),null),X(ie=>{var Pe=x,_e=T,fe=E,be=x,pe=T,we=E,De=x,ke=T,Te=E,Ue=x,Xe=T,ze=E,$e=x,Ge=T,ot={...E,color:J?"#4caf50":"#f44336"},je=x,Ce=T,Se=E,Ke=x,He=T,Oe=E,Ye=y.status==="draft"?"#fff3cd":y.status==="posted"?"#d4edda":"#f8d7da";return ie.e=d(N,Pe,ie.e),ie.t=d(q,_e,ie.t),ie.a=d(D,fe,ie.a),ie.o=d(C,be,ie.o),ie.i=d(F,pe,ie.i),ie.n=d(ee,we,ie.n),ie.s=d(H,De,ie.s),ie.h=d(oe,ke,ie.h),ie.r=d(M,Te,ie.r),ie.d=d(G,Ue,ie.d),ie.l=d(le,Xe,ie.l),ie.u=d(ne,ze,ie.u),ie.c=d(ue,$e,ie.c),ie.w=d(L,Ge,ie.w),ie.m=d(A,ot,ie.m),ie.f=d(U,je,ie.f),ie.y=d(te,Ce,ie.y),ie.g=d(ae,Se,ie.g),ie.p=d(re,Ke,ie.p),ie.b=d(ce,He,ie.b),ie.T=d(Q,Oe,ie.T),Ye!==ie.A&&((ie.A=Ye)!=null?W.style.setProperty("background",Ye):W.style.removeProperty("background")),ie},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),O})()),ge(()=>ge(()=>r()==="lines")()&&(()=>{var O=qI(),N=O.firstChild,q=N.firstChild,D=q.nextSibling,C=D.nextSibling,F=C.nextSibling,ee=F.nextSibling,H=N.nextSibling,oe=H.firstChild,M=oe.firstChild,G=M.firstChild;M.nextSibling;var le=oe.nextSibling,ne=le.firstChild,ue=ne.firstChild;ne.nextSibling;var L=le.nextSibling,A=H.nextSibling,U=A.firstChild,te=U.nextSibling,ae=te.firstChild,re=ae.firstChild,ce=re.firstChild;ce.nextSibling;var Q=re.nextSibling,me=Q.firstChild;me.nextSibling;var K=Q.nextSibling,he=K.firstChild;he.nextSibling;var ve=ae.nextSibling,W=ve.firstChild,ie=W.firstChild;ie.nextSibling;var Pe=W.nextSibling,_e=Pe.firstChild;return _e.nextSibling,i(q,()=>e("journal.account")),i(D,()=>e("common.description")),i(C,()=>e("journal.debit")),i(F,()=>e("journal.credit")),i(ee,()=>e("banking.reconciliation")),i(O,b(ut,{get each(){return y.lines},children:fe=>(()=>{var be=GI(),pe=be.firstChild,we=pe.firstChild,De=we.nextSibling,ke=pe.nextSibling,Te=ke.nextSibling,Ue=Te.nextSibling,Xe=Ue.nextSibling;return we.style.setProperty("font-weight","500"),i(we,()=>fe.accountName),De.style.setProperty("font-size","0.75rem"),De.style.setProperty("color","var(--text-muted)"),i(De,()=>Ft.getAccountById(fe.accountId)?.accountNumber||fe.accountId),ke.style.setProperty("font-size","0.875rem"),i(ke,()=>fe.description||"-"),Te.style.setProperty("font-weight","600"),i(Te,(()=>{var ze=ge(()=>fe.debitAmount>0);return()=>ze()?f(fe.debitAmount):"-"})()),Ue.style.setProperty("font-weight","600"),i(Ue,(()=>{var ze=ge(()=>fe.creditAmount>0);return()=>ze()?f(fe.creditAmount):"-"})()),i(Xe,(()=>{var ze=ge(()=>!!fe.reconciled);return()=>ze()?(()=>{var $e=HI(),Ge=$e.firstChild;return Ge.firstChild,$e.style.setProperty("display","flex"),$e.style.setProperty("align-items","center"),$e.style.setProperty("gap","0.5rem"),$e.style.setProperty("color","#4caf50"),$e.style.setProperty("font-size","0.875rem"),Ge.style.setProperty("font-weight","600"),i(Ge,()=>e("banking.reconciled"),null),i($e,(()=>{var ot=ge(()=>!!fe.reconciledWith);return()=>ot()&&(()=>{var je=WI(),Ce=je.firstChild,Se=Ce.nextSibling;return Se.nextSibling,je.style.setProperty("font-size","0.75rem"),je.style.setProperty("color","var(--text-muted)"),je.style.setProperty("font-style","italic"),i(je,()=>fe.reconciledWith,Se),je})()})(),null),$e})():(()=>{var $e=zm();return $e.style.setProperty("color","var(--text-muted)"),$e.style.setProperty("font-size","0.875rem"),i($e,()=>e("banking.notReconciled","Not Reconciled")),$e})()})()),X(ze=>{var $e=Y,Ge=fe.debitAmount>0?"#4caf50":"var(--text-muted)",ot=fe.creditAmount>0?"#f44336":"var(--text-muted)";return ze.e=d(be,$e,ze.e),Ge!==ze.t&&((ze.t=Ge)!=null?Te.style.setProperty("color",Ge):Te.style.removeProperty("color")),ot!==ze.a&&((ze.a=ot)!=null?Ue.style.setProperty("color",ot):Ue.style.removeProperty("color")),ze},{e:void 0,t:void 0,a:void 0}),be})()}),H),d(H,j),i(M,()=>e("journal.totalDebit"),G),i(oe,()=>f(y.totalDebit),null),i(ne,()=>e("journal.totalCredit"),ue),i(le,()=>f(y.totalCredit),null),(J?"#4caf50":"#f44336")!=null?L.style.setProperty("color",J?"#4caf50":"#f44336"):L.style.removeProperty("color"),L.style.setProperty("font-weight","600"),i(L,()=>J?` ${e("journal.balanced")}`:` ${e("journal.notBalanced","Not Balanced")}`),A.style.setProperty("margin-top","1rem"),A.style.setProperty("padding","1rem"),A.style.setProperty("border-radius","var(--border-radius-sm)"),A.style.setProperty("font-size","0.875rem"),U.style.setProperty("margin-bottom","0.5rem"),te.style.setProperty("display","grid"),te.style.setProperty("grid-template-columns","1fr 1fr"),te.style.setProperty("gap","1rem"),re.style.setProperty("margin-bottom","0.25rem"),i(re,()=>y.lines.length,null),Q.style.setProperty("margin-bottom","0.25rem"),Q.style.setProperty("color","#4caf50"),i(Q,()=>y.lines.filter(fe=>fe.reconciled).length,null),K.style.setProperty("color","#f44336"),i(K,()=>y.lines.filter(fe=>!fe.reconciled).length,null),W.style.setProperty("margin-bottom","0.25rem"),i(W,()=>y.lines.filter(fe=>["1001","1002","1003"].includes(fe.accountId)).length,null),Pe.style.setProperty("margin-bottom","0.25rem"),Pe.style.setProperty("color","#4caf50"),i(Pe,()=>y.lines.filter(fe=>["1001","1002","1003"].includes(fe.accountId)&&fe.reconciled).length,null),i(ve,(()=>{var fe=ge(()=>y.lines.filter(be=>["1001","1002","1003"].includes(be.accountId)&&!be.reconciled).length>0);return()=>fe()&&(()=>{var be=YI(),pe=be.firstChild;return pe.nextSibling,be.style.setProperty("color","#f44336"),i(be,()=>y.lines.filter(we=>["1001","1002","1003"].includes(we.accountId)&&!we.reconciled).length,null),be})()})(),null),i(A,(()=>{var fe=ge(()=>y.lines.filter(be=>be.reconciled).length>0);return()=>fe()&&(()=>{var be=KI(),pe=be.firstChild;return be.style.setProperty("margin-top","0.75rem"),be.style.setProperty("padding-top","0.75rem"),be.style.setProperty("border-top","1px solid var(--border-color)"),pe.style.setProperty("margin-bottom","0.5rem"),pe.style.setProperty("font-weight","500"),i(be,()=>y.lines.filter(we=>we.reconciled).map(we=>(()=>{var De=lc(),ke=De.firstChild,Te=ke.nextSibling;return De.style.setProperty("display","flex"),De.style.setProperty("justify-content","space-between"),De.style.setProperty("margin-bottom","0.25rem"),De.style.setProperty("font-size","0.8rem"),i(ke,()=>we.accountName),Te.style.setProperty("color","var(--text-muted)"),i(Te,()=>we.reconciledWith?` ${we.reconciledWith}`:"Manual"),De})()),null),be})()})(),null),i(A,(()=>{var fe=ge(()=>y.lines.filter(be=>!be.reconciled&&["1001","1002","1003"].includes(be.accountId)).length>0);return()=>fe()&&(()=>{var be=QI(),pe=be.firstChild,we=pe.nextSibling;return be.style.setProperty("margin-top","0.75rem"),be.style.setProperty("padding-top","0.75rem"),be.style.setProperty("border-top","1px solid var(--border-color)"),pe.style.setProperty("margin-bottom","0.5rem"),pe.style.setProperty("font-weight","500"),pe.style.setProperty("color","#f44336"),i(be,()=>y.lines.filter(De=>!De.reconciled&&["1001","1002","1003"].includes(De.accountId)).map(De=>(()=>{var ke=lc(),Te=ke.firstChild,Ue=Te.nextSibling;return ke.style.setProperty("display","flex"),ke.style.setProperty("justify-content","space-between"),ke.style.setProperty("margin-bottom","0.25rem"),ke.style.setProperty("font-size","0.8rem"),ke.style.setProperty("color","#f44336"),i(Te,()=>De.accountName),i(Ue,()=>f(De.debitAmount||De.creditAmount)),ke})()),we),we.style.setProperty("margin-top","0.5rem"),we.style.setProperty("font-size","0.75rem"),we.style.setProperty("color","var(--text-muted)"),we.style.setProperty("font-style","italic"),be})()})(),null),X(fe=>{var be=Z,pe=y.lines.some(we=>we.reconciled)?"#e8f5e8":"#fff3cd";return fe.e=d(N,be,fe.e),pe!==fe.t&&((fe.t=pe)!=null?A.style.setProperty("background",pe):A.style.removeProperty("background")),fe},{e:void 0,t:void 0}),O})()),ge(()=>ge(()=>r()==="reconciliation")()&&(()=>{var O=JI(),N=O.firstChild,q=N.firstChild,D=q.firstChild,C=D.nextSibling,F=q.nextSibling,ee=F.firstChild,H=ee.firstChild,oe=H.nextSibling,M=ee.nextSibling,G=M.firstChild,le=G.nextSibling,ne=M.nextSibling,ue=ne.firstChild,L=ue.nextSibling;return N.style.setProperty("margin-bottom","1.5rem"),N.style.setProperty("padding","1rem"),N.style.setProperty("border-radius","var(--border-radius)"),N.style.setProperty("border","1px solid var(--border-color)"),q.style.setProperty("display","flex"),q.style.setProperty("align-items","center"),q.style.setProperty("gap","0.5rem"),q.style.setProperty("margin-bottom","1rem"),D.style.setProperty("font-size","1.5rem"),i(D,(()=>{var A=ge(()=>!!y.lines.every(U=>U.reconciled));return()=>A()?"":y.lines.some(U=>U.reconciled)?"":""})()),C.style.setProperty("margin","0"),C.style.setProperty("font-size","1.2rem"),i(C,(()=>{var A=ge(()=>!!y.lines.every(U=>U.reconciled));return()=>A()?"Fully Reconciled":y.lines.some(U=>U.reconciled)?"Partially Reconciled":"Unreconciled"})()),F.style.setProperty("display","grid"),F.style.setProperty("grid-template-columns","1fr 1fr 1fr"),F.style.setProperty("gap","1rem"),ee.style.setProperty("text-align","center"),H.style.setProperty("font-size","2rem"),H.style.setProperty("font-weight","700"),H.style.setProperty("color","var(--primary-color)"),i(H,()=>y.lines.length),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),M.style.setProperty("text-align","center"),G.style.setProperty("font-size","2rem"),G.style.setProperty("font-weight","700"),G.style.setProperty("color","#4caf50"),i(G,()=>y.lines.filter(A=>A.reconciled).length),le.style.setProperty("font-size","0.875rem"),le.style.setProperty("color","var(--text-muted)"),ne.style.setProperty("text-align","center"),ue.style.setProperty("font-size","2rem"),ue.style.setProperty("font-weight","700"),ue.style.setProperty("color","#f44336"),i(ue,()=>y.lines.filter(A=>!A.reconciled).length),L.style.setProperty("font-size","0.875rem"),L.style.setProperty("color","var(--text-muted)"),i(O,(()=>{var A=ge(()=>y.lines.filter(U=>U.reconciled).length>0);return()=>A()&&(()=>{var U=XI(),te=U.firstChild,ae=te.firstChild,re=ae.nextSibling;return re.nextSibling,U.style.setProperty("margin-bottom","1.5rem"),te.style.setProperty("margin","0 0 1rem 0"),te.style.setProperty("font-size","1.1rem"),te.style.setProperty("color","#4caf50"),te.style.setProperty("display","flex"),te.style.setProperty("align-items","center"),te.style.setProperty("gap","0.5rem"),i(te,()=>y.lines.filter(ce=>ce.reconciled).length,re),i(U,()=>y.lines.filter(ce=>ce.reconciled).map(ce=>(()=>{var Q=ZI(),me=Q.firstChild,K=me.firstChild,he=K.nextSibling,ve=me.nextSibling,W=ve.nextSibling,ie=W.nextSibling,Pe=ie.nextSibling,_e=Pe.firstChild;return Q.style.setProperty("display","grid"),Q.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),Q.style.setProperty("gap","1rem"),Q.style.setProperty("padding","0.75rem"),Q.style.setProperty("margin-bottom","0.5rem"),Q.style.setProperty("background","#f0f9f0"),Q.style.setProperty("border-radius","var(--border-radius-sm)"),Q.style.setProperty("align-items","center"),Q.style.setProperty("font-size","0.875rem"),K.style.setProperty("font-weight","500"),i(K,()=>ce.accountName),he.style.setProperty("font-size","0.75rem"),he.style.setProperty("color","var(--text-muted)"),i(he,()=>Ft.getAccountById(ce.accountId)?.accountNumber),ve.style.setProperty("color","var(--text-muted)"),i(ve,()=>ce.description||"No description"),W.style.setProperty("font-weight","600"),i(W,(()=>{var fe=ge(()=>ce.debitAmount>0);return()=>fe()?f(ce.debitAmount):"-"})()),ie.style.setProperty("font-weight","600"),i(ie,(()=>{var fe=ge(()=>ce.creditAmount>0);return()=>fe()?f(ce.creditAmount):"-"})()),Pe.style.setProperty("color","#4caf50"),_e.style.setProperty("font-weight","500"),i(Pe,(()=>{var fe=ge(()=>!!ce.reconciledWith);return()=>fe()&&(()=>{var be=eE();return be.firstChild,be.style.setProperty("font-size","0.75rem"),be.style.setProperty("font-style","italic"),i(be,()=>ce.reconciledWith,null),be})()})(),null),X(fe=>{var be=ce.debitAmount>0?"#4caf50":"var(--text-muted)",pe=ce.creditAmount>0?"#f44336":"var(--text-muted)";return be!==fe.e&&((fe.e=be)!=null?W.style.setProperty("color",be):W.style.removeProperty("color")),pe!==fe.t&&((fe.t=pe)!=null?ie.style.setProperty("color",pe):ie.style.removeProperty("color")),fe},{e:void 0,t:void 0}),Q})()),null),U})()})(),null),i(O,(()=>{var A=ge(()=>y.lines.filter(U=>!U.reconciled).length>0);return()=>A()&&(()=>{var U=tE(),te=U.firstChild,ae=te.firstChild,re=ae.nextSibling;return re.nextSibling,U.style.setProperty("margin-bottom","1.5rem"),te.style.setProperty("margin","0 0 1rem 0"),te.style.setProperty("font-size","1.1rem"),te.style.setProperty("color","#f44336"),te.style.setProperty("display","flex"),te.style.setProperty("align-items","center"),te.style.setProperty("gap","0.5rem"),i(te,()=>y.lines.filter(ce=>!ce.reconciled).length,re),i(U,()=>y.lines.filter(ce=>!ce.reconciled).map(ce=>(()=>{var Q=rE(),me=Q.firstChild,K=me.firstChild,he=K.nextSibling,ve=me.nextSibling,W=ve.nextSibling,ie=W.nextSibling,Pe=ie.nextSibling,_e=Pe.firstChild;return Q.style.setProperty("display","grid"),Q.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),Q.style.setProperty("gap","1rem"),Q.style.setProperty("padding","0.75rem"),Q.style.setProperty("margin-bottom","0.5rem"),Q.style.setProperty("background","#fff9f0"),Q.style.setProperty("border-radius","var(--border-radius-sm)"),Q.style.setProperty("align-items","center"),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("border","1px solid #ffe0b3"),K.style.setProperty("font-weight","500"),i(K,()=>ce.accountName),he.style.setProperty("font-size","0.75rem"),he.style.setProperty("color","var(--text-muted)"),i(he,()=>Ft.getAccountById(ce.accountId)?.accountNumber),ve.style.setProperty("color","var(--text-muted)"),i(ve,()=>ce.description||"No description"),W.style.setProperty("font-weight","600"),i(W,(()=>{var fe=ge(()=>ce.debitAmount>0);return()=>fe()?f(ce.debitAmount):"-"})()),ie.style.setProperty("font-weight","600"),i(ie,(()=>{var fe=ge(()=>ce.creditAmount>0);return()=>fe()?f(ce.creditAmount):"-"})()),Pe.style.setProperty("color","#f44336"),_e.style.setProperty("font-weight","500"),i(Pe,(()=>{var fe=ge(()=>!!["1001","1002","1003"].includes(ce.accountId));return()=>fe()&&(()=>{var be=nE();return be.style.setProperty("font-size","0.75rem"),be.style.setProperty("font-style","italic"),be})()})(),null),X(fe=>{var be=ce.debitAmount>0?"#4caf50":"var(--text-muted)",pe=ce.creditAmount>0?"#f44336":"var(--text-muted)";return be!==fe.e&&((fe.e=be)!=null?W.style.setProperty("color",be):W.style.removeProperty("color")),pe!==fe.t&&((fe.t=pe)!=null?ie.style.setProperty("color",pe):ie.style.removeProperty("color")),fe},{e:void 0,t:void 0}),Q})()),null),i(U,(()=>{var ce=ge(()=>y.lines.filter(Q=>!Q.reconciled&&["1001","1002","1003"].includes(Q.accountId)).length>0);return()=>ce()&&(()=>{var Q=oE(),me=Q.firstChild,K=me.nextSibling;return Q.style.setProperty("padding","0.75rem"),Q.style.setProperty("background","#ffebee"),Q.style.setProperty("border-radius","var(--border-radius-sm)"),Q.style.setProperty("margin-top","1rem"),Q.style.setProperty("border","1px solid #ffcdd2"),me.style.setProperty("font-weight","500"),me.style.setProperty("margin-bottom","0.5rem"),me.style.setProperty("color","#f44336"),K.style.setProperty("font-size","0.875rem"),K.style.setProperty("color","var(--text-muted)"),Q})()})(),null),U})()})(),null),X(A=>(A=y.lines.every(U=>U.reconciled)?"#e8f5e8":y.lines.some(U=>U.reconciled)?"#fff3cd":"#ffebee")!=null?N.style.setProperty("background",A):N.style.removeProperty("background")),O})()),(()=>{var O=zm();return d(O,B),i(O,b(qe,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),i(O,b(qe,{variant:"primary",onClick:$,get children(){return e("journal.editEntry")}}),null),i(O,(()=>{var N=ge(()=>y.status==="draft");return()=>N()&&b(qe,{variant:"outline",onClick:w,disabled:!J,style:{"border-color":"#4caf50",color:J?"#4caf50":"var(--text-muted)"},get children(){return J?e("journal.postEntry","Post Entry"):e("journal.entryNotBalanced","Entry Not Balanced")}})})(),null),i(O,(()=>{var N=ge(()=>y.status==="posted");return()=>N()&&b(qe,{variant:"outline",onClick:I,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return e("journal.voidEntry","Void Entry")}})})(),null),O})()]})()}}),ge(()=>ge(()=>!!a())()&&b(sg,{get isOpen(){return o()},onClose:()=>{s(!1)},get editEntry(){return a()}}))]};wt(["click"]);var sE=z("<div><div><h2></h2><p></p></div><div>"),zn=z("<div>"),aE=z("<div> <!>  <!> "),lE=z("<div><div><label></label></div><div><label></label></div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label></div><div>"),cE=z("<div><span>:</span><span> "),ua=z("<span>: "),dE=z("<div><br>");const uE=()=>{const{t}=ft(),[e,r]=ye(!1),[n,o]=ye(null),[s,a]=ye(!1),[l,u]=ye(null),[h,m]=ye("all"),[v,_]=ye("all"),[x,T]=ye(""),[E,P]=ye(""),[R,Y]=ye("date"),[Z,j]=ye("desc"),B={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},V={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)","flex-wrap":"wrap"},f={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem"},g={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(400px, 1fr))",gap:"1.5rem"},S=()=>[{value:"all",label:t("journal.allEntries","All Entries")},{value:"draft",label:t("journal.draft")},{value:"posted",label:t("journal.posted")},{value:"void",label:t("entryBooks.void","Void")}],$=()=>[{value:"all",label:t("accounts.allAccounts","All Accounts")},...Ft.accounts.map(C=>({value:C.id,label:`${C.accountNumber} - ${C.name}`}))],w=()=>[{value:"date",label:t("common.date")},{value:"entryNumber",label:t("journal.entryNumber")},{value:"amount",label:t("common.amount")}],I=()=>{let C=Hn.journalEntries;return h()!=="all"&&(C=C.filter(F=>F.status===h())),v()!=="all"&&(C=C.filter(F=>F.lines.some(ee=>ee.accountId===v()))),x()&&(C=C.filter(F=>F.date>=x())),E()&&(C=C.filter(F=>F.date<=E())),C=[...C].sort((F,ee)=>{let H=0;switch(R()){case"date":H=new Date(F.date).getTime()-new Date(ee.date).getTime();break;case"entryNumber":H=F.entryNumber.localeCompare(ee.entryNumber);break;case"amount":H=F.totalDebit-ee.totalDebit;break}return Z()==="asc"?H:-H}),C},y=()=>{const C=Hn.journalEntries,F=C.filter(le=>le.status==="draft"),ee=C.filter(le=>le.status==="posted"),H=C.filter(le=>le.status==="void"),oe=ee.reduce((le,ne)=>le+ne.totalDebit,0),M=ee.reduce((le,ne)=>le+ne.totalCredit,0),G=C.filter(le=>le.lines.some(ne=>["1001","1002","1003"].includes(ne.accountId)&&!ne.reconciled)).length;return{totalEntries:C.length,draftEntries:F.length,postedEntries:ee.length,voidEntries:H.length,totalDebit:oe,totalCredit:M,unreconciledEntries:G}},de=C=>{u(C.id),a(!0)},J=()=>{o(null),r(!0)},O=()=>{r(!1),o(null)},N=C=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(C),q=y(),D=I();return b(an,{get title(){return t("entryBooks.title")},get children(){return[(()=>{var C=sE(),F=C.firstChild,ee=F.firstChild,H=ee.nextSibling,oe=F.nextSibling;return d(C,B),ee.style.setProperty("margin","0 0 0.5rem 0"),ee.style.setProperty("font-size","1.5rem"),i(ee,()=>t("journal.title")),H.style.setProperty("margin","0"),H.style.setProperty("color","var(--text-muted)"),i(H,()=>t("entryBooks.subtitle","Manage accounting entries and general ledger records")),oe.style.setProperty("display","flex"),oe.style.setProperty("gap","1rem"),i(oe,b(qe,{variant:"secondary",onClick:()=>window.location.href="/bank-consolidations",get children(){return t("entryBooks.viewReconciliation","View Reconciliation")}}),null),i(oe,b(qe,{variant:"primary",onClick:J,get children(){return t("journal.addEntry","Add Journal Entry")}}),null),C})(),(()=>{var C=zn();return d(C,f),i(C,b(rt,{get title(){return t("entryBooks.totalEntries","Total Entries")},get subtitle(){return t("entryBooks.allJournalEntries","All journal entries")},get children(){return[(()=>{var F=zn();return F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("color","var(--primary-color)"),F.style.setProperty("margin-bottom","0.5rem"),i(F,()=>q.totalEntries),F})(),(()=>{var F=aE(),ee=F.firstChild,H=ee.nextSibling,oe=H.nextSibling,M=oe.nextSibling;return M.nextSibling,F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-muted)"),i(F,()=>q.postedEntries,ee),i(F,()=>t("journal.posted").toLowerCase(),H),i(F,()=>q.draftEntries,M),i(F,()=>t("journal.draft").toLowerCase(),null),i(F,(()=>{var G=ge(()=>q.voidEntries>0);return()=>G()&&`  ${q.voidEntries} ${t("entryBooks.void","void").toLowerCase()}`})(),null),F})()]}}),null),i(C,b(rt,{get title(){return t("journal.totalDebits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var F=zn();return F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("color","#4caf50"),F.style.setProperty("margin-bottom","0.5rem"),i(F,()=>N(q.totalDebit)),F})(),(()=>{var F=zn();return F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-muted)"),i(F,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",q.postedEntries.toString())),F})()]}}),null),i(C,b(rt,{get title(){return t("journal.totalCredits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var F=zn();return F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("color","#f44336"),F.style.setProperty("margin-bottom","0.5rem"),i(F,()=>N(q.totalCredit)),F})(),(()=>{var F=zn();return F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-muted)"),i(F,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",q.postedEntries.toString())),F})()]}}),null),i(C,b(rt,{get title(){return t("banking.unreconciled","Unreconciled")},get subtitle(){return t("banking.title")},get children(){return[(()=>{var F=zn();return F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("margin-bottom","0.5rem"),i(F,()=>q.unreconciledEntries),X(ee=>(ee=q.unreconciledEntries>0?"#ff9800":"#4caf50")!=null?F.style.setProperty("color",ee):F.style.removeProperty("color")),F})(),(()=>{var F=zn();return F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-muted)"),i(F,(()=>{var ee=ge(()=>q.unreconciledEntries>0);return()=>ee()?t("entryBooks.needBankReconciliation","Need bank reconciliation"):t("entryBooks.allReconciled","All reconciled")})()),F})()]}}),null),C})(),(()=>{var C=lE(),F=C.firstChild,ee=F.firstChild,H=F.nextSibling,oe=H.firstChild,M=H.nextSibling,G=M.firstChild,le=M.nextSibling,ne=le.firstChild,ue=ne.nextSibling,L=le.nextSibling,A=L.firstChild,U=A.nextSibling,te=L.nextSibling,ae=te.firstChild,re=te.nextSibling;return d(C,V),F.style.setProperty("min-width","150px"),ee.style.setProperty("display","block"),ee.style.setProperty("margin-bottom","0.5rem"),ee.style.setProperty("font-weight","500"),ee.style.setProperty("font-size","0.875rem"),i(ee,()=>t("common.status")),i(F,b(Dr,{label:"",get value(){return h()},onChange:m,get options(){return S()}}),null),H.style.setProperty("min-width","200px"),oe.style.setProperty("display","block"),oe.style.setProperty("margin-bottom","0.5rem"),oe.style.setProperty("font-weight","500"),oe.style.setProperty("font-size","0.875rem"),i(oe,()=>t("journal.account")),i(H,b(Dr,{label:"",get value(){return v()},onChange:_,get options(){return $()}}),null),M.style.setProperty("min-width","120px"),G.style.setProperty("display","block"),G.style.setProperty("margin-bottom","0.5rem"),G.style.setProperty("font-weight","500"),G.style.setProperty("font-size","0.875rem"),i(G,()=>t("entryBooks.sortBy","Sort By")),i(M,b(Dr,{label:"",get value(){return R()},onChange:Y,get options(){return w()}}),null),le.style.setProperty("min-width","130px"),ne.style.setProperty("display","block"),ne.style.setProperty("margin-bottom","0.5rem"),ne.style.setProperty("font-weight","500"),ne.style.setProperty("font-size","0.875rem"),i(ne,()=>t("entryBooks.fromDate","From Date")),ue.addEventListener("change",ce=>T(ce.target.value)),ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("border","1px solid var(--border-color)"),ue.style.setProperty("border-radius","var(--border-radius-sm)"),ue.style.setProperty("font-family","inherit"),ue.style.setProperty("width","100%"),L.style.setProperty("min-width","130px"),A.style.setProperty("display","block"),A.style.setProperty("margin-bottom","0.5rem"),A.style.setProperty("font-weight","500"),A.style.setProperty("font-size","0.875rem"),i(A,()=>t("entryBooks.toDate","To Date")),U.addEventListener("change",ce=>P(ce.target.value)),U.style.setProperty("padding","0.75rem"),U.style.setProperty("border","1px solid var(--border-color)"),U.style.setProperty("border-radius","var(--border-radius-sm)"),U.style.setProperty("font-family","inherit"),U.style.setProperty("width","100%"),te.style.setProperty("min-width","100px"),ae.style.setProperty("display","block"),ae.style.setProperty("margin-bottom","0.5rem"),ae.style.setProperty("font-weight","500"),ae.style.setProperty("font-size","0.875rem"),i(ae,()=>t("entryBooks.order","Order")),i(te,b(Dr,{label:"",get value(){return Z()},onChange:j,get options(){return[{value:"desc",label:t("entryBooks.newest","Newest")},{value:"asc",label:t("entryBooks.oldest","Oldest")}]}}),null),re.style.setProperty("display","flex"),re.style.setProperty("align-items","end"),re.style.setProperty("gap","0.5rem"),i(re,b(qe,{variant:"outline",size:"sm",onClick:()=>{m("all"),_("all"),T(""),P(""),Y("date"),j("desc")},get children(){return t("entryBooks.resetFilters","Reset Filters")}})),X(()=>ue.value=x()),X(()=>U.value=E()),C})(),ge(()=>ge(()=>!!(h()!=="all"||v()!=="all"||x()||E()))()&&(()=>{var C=cE(),F=C.firstChild,ee=F.firstChild,H=F.nextSibling,oe=H.firstChild;return C.style.setProperty("display","flex"),C.style.setProperty("gap","0.5rem"),C.style.setProperty("align-items","center"),C.style.setProperty("margin-bottom","1rem"),C.style.setProperty("padding","0.75rem"),C.style.setProperty("background","var(--surface-color)"),C.style.setProperty("border-radius","var(--border-radius-sm)"),C.style.setProperty("border","1px solid var(--border-color)"),F.style.setProperty("font-size","0.875rem"),F.style.setProperty("font-weight","500"),i(F,()=>t("entryBooks.activeFilters","Active filters"),ee),i(C,(()=>{var M=ge(()=>h()!=="all");return()=>M()&&(()=>{var G=ua(),le=G.firstChild;return G.style.setProperty("padding","0.25rem 0.5rem"),G.style.setProperty("background","var(--primary-color)"),G.style.setProperty("color","white"),G.style.setProperty("border-radius","12px"),G.style.setProperty("font-size","0.75rem"),i(G,()=>t("common.status"),le),i(G,h,null),G})()})(),H),i(C,(()=>{var M=ge(()=>v()!=="all");return()=>M()&&(()=>{var G=ua(),le=G.firstChild;return G.style.setProperty("padding","0.25rem 0.5rem"),G.style.setProperty("background","var(--primary-color)"),G.style.setProperty("color","white"),G.style.setProperty("border-radius","12px"),G.style.setProperty("font-size","0.75rem"),i(G,()=>t("journal.account"),le),i(G,()=>Ft.getAccountById(v())?.name||t("common.unknown","Unknown"),null),G})()})(),H),i(C,(()=>{var M=ge(()=>!!x());return()=>M()&&(()=>{var G=ua(),le=G.firstChild;return G.style.setProperty("padding","0.25rem 0.5rem"),G.style.setProperty("background","var(--primary-color)"),G.style.setProperty("color","white"),G.style.setProperty("border-radius","12px"),G.style.setProperty("font-size","0.75rem"),i(G,()=>t("entryBooks.from","From"),le),i(G,x,null),G})()})(),H),i(C,(()=>{var M=ge(()=>!!E());return()=>M()&&(()=>{var G=ua(),le=G.firstChild;return G.style.setProperty("padding","0.25rem 0.5rem"),G.style.setProperty("background","var(--primary-color)"),G.style.setProperty("color","white"),G.style.setProperty("border-radius","12px"),G.style.setProperty("font-size","0.75rem"),i(G,()=>t("entryBooks.to","To"),le),i(G,E,null),G})()})(),H),H.style.setProperty("margin-left","auto"),H.style.setProperty("font-size","0.875rem"),H.style.setProperty("color","var(--text-muted)"),i(H,()=>D.length,oe),i(H,()=>t("entryBooks.entriesFound","{count} entries found").replace("{count}",D.length.toString()),null),C})()),ge(()=>ge(()=>D.length===0)()?b(rt,{get title(){return t("entryBooks.noJournalEntries","No Journal Entries")},get subtitle(){return t("entryBooks.startByCreating","Start by creating your first entry")},get children(){var C=dE(),F=C.firstChild;return C.style.setProperty("text-align","center"),C.style.setProperty("color","var(--text-muted)"),C.style.setProperty("padding","2rem"),i(C,()=>t("entryBooks.noEntriesMatch","No journal entries match your current filters."),F),i(C,b(qe,{variant:"primary",style:{"margin-top":"1rem"},onClick:J,get children(){return t("entryBooks.createFirstEntry","Create First Entry")}}),null),C}}):(()=>{var C=zn();return d(C,g),i(C,b(ut,{each:D,children:F=>b(OI,{entry:F,onViewDetails:de})})),C})()),b(sg,{get isOpen(){return e()},onClose:O,get editEntry(){return n()}}),b(iE,{get isOpen(){return s()},onClose:()=>{a(!1),u(null)},get entryId(){return l()}})]}})};var hE=z("<div>$124,350"),mE=z("<div>+12% from last month"),yE=z("<div>247"),ai=z("<div>"),pE=z("<div>18"),fE=z("<div>$89,250"),gE=z("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>");const vE=()=>{const{t}=ft(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},n={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)",margin:"0.5rem 0"},o={"font-size":"0.875rem",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"};return b(an,{get title(){return t("dashboard.title")},get children(){return[(()=>{var s=ai();return d(s,e),i(s,b(rt,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var a=hE();return X(l=>d(a,n,l)),a})(),(()=>{var a=mE();return X(l=>d(a,o,l)),a})()]}}),null),i(s,b(rt,{get title(){return t("dashboard.employeeCount")},get subtitle(){return t("dashboard.current")},get children(){return[(()=>{var a=yE();return X(l=>d(a,n,l)),a})(),(()=>{var a=ai();return i(a,()=>t("dashboard.newHires")),X(l=>d(a,o,l)),a})()]}}),null),i(s,b(rt,{get title(){return t("dashboard.pendingInvoices")},get subtitle(){return t("dashboard.outstanding")},get children(){return[(()=>{var a=pE();return X(l=>d(a,n,l)),a})(),(()=>{var a=ai();return i(a,()=>t("dashboard.totalOutstanding")),X(l=>d(a,o,l)),a})()]}}),null),i(s,b(rt,{get title(){return t("dashboard.cashBalance")},get subtitle(){return t("accounts.title")},get children(){return[(()=>{var a=fE();return X(l=>d(a,n,l)),a})(),(()=>{var a=ai();return i(a,()=>t("dashboard.lastUpdatedToday")),X(l=>d(a,o,l)),a})()]}}),null),s})(),(()=>{var s=ai();return d(s,r),i(s,b(rt,{get title(){return t("dashboard.quickActions")},get subtitle(){return t("dashboard.commonTasks")},get children(){var a=ai();return a.style.setProperty("display","flex"),a.style.setProperty("flex-direction","column"),a.style.setProperty("gap","1rem"),i(a,b(qe,{variant:"primary",get children(){return t("invoices.createNew")}}),null),i(a,b(qe,{variant:"secondary",get children(){return t("employees.addEmployee")}}),null),i(a,b(qe,{variant:"outline",get children(){return t("dashboard.generateReport")}}),null),a}}),null),i(s,b(rt,{get title(){return t("dashboard.recentActivity")},get subtitle(){return t("dashboard.latestUpdates")},get children(){var a=gE(),l=a.firstChild,u=l.firstChild,h=u.nextSibling,m=l.nextSibling,v=m.firstChild,_=v.nextSibling,x=m.nextSibling,T=x.firstChild,E=T.nextSibling;return a.style.setProperty("display","flex"),a.style.setProperty("flex-direction","column"),a.style.setProperty("gap","0.75rem"),l.style.setProperty("border-bottom","1px solid var(--border-color)"),l.style.setProperty("padding-bottom","0.5rem"),u.style.setProperty("font-weight","500"),i(u,()=>t("dashboard.invoicePaid")),h.style.setProperty("font-size","0.875rem"),h.style.setProperty("color","var(--text-muted)"),i(h,()=>t("dashboard.hoursAgo")),m.style.setProperty("border-bottom","1px solid var(--border-color)"),m.style.setProperty("padding-bottom","0.5rem"),v.style.setProperty("font-weight","500"),i(v,()=>t("dashboard.newEmployeeOnboarded")),_.style.setProperty("font-size","0.875rem"),_.style.setProperty("color","var(--text-muted)"),i(_,()=>t("dashboard.dayAgo")),T.style.setProperty("font-weight","500"),i(T,()=>t("dashboard.monthlyReportGenerated")),E.style.setProperty("font-size","0.875rem"),E.style.setProperty("color","var(--text-muted)"),i(E,()=>t("dashboard.daysAgo")),a}}),null),s})(),b(Ae,{get when(){return Lt.hasPermission("invoiceAccess")},get children(){return b(EI,{})}})]}})};var jm=z("<div>"),bE=z("<div><div><div><strong>Display Name:</strong> </div><div><strong>UID:</strong> </div></div><div><strong>Created:</strong> "),_E=z("<div><h3>Store Access</h3><div></div><div>No store access granted"),SE=z("<div><h3>Permissions</h3><div>"),PE=z('<div><div><input type=text placeholder="Search users..."></div><div>'),wE=z("<div> You need administrator privileges to access this page."),CE=z("<div>Loading users..."),xE=z("<div><div></div><div></div><div> stores"),$E=z("<div>Select a user to view and edit their profile"),AE=z("<div><input type=checkbox><label>"),IE=z("<div><input type=checkbox><div><div></div><div>");const EE=()=>{const[t,e]=ye([]),[r,n]=ye(null),[o,s]=ye(!1),[a,l]=ye(!1),[u,h]=ye(""),[m,v]=ye(null),_=[{id:"YY_8802",name:"Store 8802"},{id:"YY_8803",name:"Store 8803"},{id:"YY_8804",name:"Store 8804"},{id:"YY_8805",name:"Store 8805"},{id:"YY_8816",name:"Store 8816"},{id:"YY_8818",name:"Store 8818"},{id:"YY_8847",name:"Store 8847"},{id:"YY_3251",name:"Store 3251"},{id:"YY_32",name:"Store 32"},{id:"YY_76",name:"Store 76"},{id:"YY_79",name:"Store 79"},{id:"YY_8635",name:"Store 8635"},{id:"YY_8665",name:"Store 8665"},{id:"YY_8901",name:"Store 8901"}],x=[{key:"AccountAccess",label:"Account Access",description:"Access to accounting features"},{key:"BankingAccess",label:"Banking Access",description:"Access to banking operations"},{key:"InventoryAccess",label:"Inventory Access",description:"Access to inventory management"},{key:"JournalAccess",label:"Journal Access",description:"Access to journal entries"},{key:"inventoryDownsection",label:"Inventory Downsection",description:"Access to inventory downsection"},{key:"onlyRead",label:"Read Only",description:"Limited to read-only access"},{key:"read_write",label:"Read/Write",description:"Full read and write permissions"},{key:"isAdmin",label:"Administrator",description:"Full system administration rights"}];let T={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,invoiceAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1};$r(async()=>{await E()});const E=async()=>{try{s(!0);const y=mw(Yc,"users"),de=$w(y,Aw("createdAt","desc")),J=await Rw(de),O=[];J.forEach(N=>{let q=N.data();Object.keys(T).map(D=>{let C=T?.[D];q.hasOwnProperty(D)||(q[D]=C)}),O.push({uid:N.id,...q})}),e(O)}catch(y){console.error("Error loading users:",y),v({type:"error",text:"Failed to load users"})}finally{s(!1)}},P=Ze(()=>{const y=u().toLowerCase();return y?t().filter(de=>de.email?.toLowerCase().includes(y)||de.displayName?.toLowerCase().includes(y)||de.uid?.toLowerCase().includes(y)):t()}),R=y=>{r()&&n(de=>({...de,stores:{...de.stores,[y]:!de.stores[y]}}))},Y=y=>{r()&&n(de=>({...de,[y]:!de[y]}))};Ze(()=>r()?r().stores&&Object.values(r().stores).some(y=>y):!1);const Z=async()=>{if(r())try{l(!0),v(null);const y=jf(Yc,"users",r().uid);let de={stores:r().stores,AccountAccess:r().AccountAccess,BankingAccess:r().BankingAccess,InventoryAccess:r().InventoryAccess,JournalAccess:r().JournalAccess,inventoryDownsection:r().inventoryDownsection,onlyRead:r().onlyRead,read_write:r().read_write,isAdmin:r().isAdmin||!1};await Zf(y,de),e(J=>J.map(O=>O.uid===r().uid?r():O)),v({type:"success",text:"User profile updated successfully"})}catch(y){console.error("Error saving user profile:",y),v({type:"error",text:"Failed to save user profile"})}finally{l(!1)}},j={display:"grid","grid-template-columns":"350px 1fr",gap:"2rem",height:"calc(100vh - 200px)"},B={"max-height":"100%","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)",background:"var(--surface-color)"},V=y=>({padding:"1rem","border-bottom":"1px solid var(--border-color)",cursor:"pointer",background:y?"var(--primary-color-light)":"transparent",transition:"background 0.2s"}),f={padding:"0.75rem",border:"none","border-bottom":"1px solid var(--border-color)",background:"var(--surface-color)",width:"100%","font-size":"1rem"},g={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1rem"},S={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(200px, 1fr))",gap:"0.75rem"},$={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",transition:"all 0.2s"},w=y=>({padding:"1rem","margin-bottom":"1rem","border-radius":"var(--border-radius)",background:y==="success"?"#d4edda":"#f8d7da",color:y==="success"?"#155724":"#721c24",border:`1px solid ${y==="success"?"#c3e6cb":"#f5c6cb"}`}),I=Ze(()=>Lt.state.profile?.isAdmin===!0);return b(an,{title:"User Profile Administration",get children(){return b(Ae,{get when(){return I()},get fallback(){return b(rt,{get children(){var y=wE();return y.style.setProperty("text-align","center"),y.style.setProperty("padding","2rem"),y.style.setProperty("color","var(--text-muted)"),y}})},get children(){var y=PE(),de=y.firstChild,J=de.firstChild,O=de.nextSibling;return d(y,j),d(de,B),J.$$input=N=>h(N.currentTarget.value),d(J,f),i(de,b(Ae,{get when(){return!o()},get fallback(){return(()=>{var N=CE();return N.style.setProperty("padding","2rem"),N.style.setProperty("text-align","center"),N})()},get children(){return b(ut,{get each(){return P()},children:N=>(()=>{var q=xE(),D=q.firstChild,C=D.nextSibling,F=C.nextSibling,ee=F.firstChild;return q.$$click=()=>n(N),D.style.setProperty("font-weight","600"),i(D,()=>N.displayName||"No Name"),C.style.setProperty("font-size","0.875rem"),C.style.setProperty("color","var(--text-muted)"),i(C,()=>N.email),F.style.setProperty("font-size","0.75rem"),F.style.setProperty("color","var(--text-muted)"),F.style.setProperty("margin-top","0.25rem"),i(F,()=>N.isAdmin&&" Admin  ",ee),i(F,()=>Object.values(N.stores||{}).filter(Boolean).length,ee),X(H=>d(q,V(r()?.uid===N.uid),H)),q})()})}}),null),i(O,b(Ae,{get when(){return r()},get fallback(){return b(rt,{get children(){var N=$E();return N.style.setProperty("text-align","center"),N.style.setProperty("padding","2rem"),N.style.setProperty("color","var(--text-muted)"),N}})},get children(){return[b(Ae,{get when(){return m()},get children(){var N=jm();return i(N,()=>m().text),X(q=>d(N,w(m().type),q)),N}}),b(rt,{title:"User Information",get subtitle(){return r().email},get children(){return[(()=>{var N=bE(),q=N.firstChild,D=q.firstChild,C=D.firstChild;C.nextSibling;var F=D.nextSibling,ee=F.firstChild;ee.nextSibling;var H=q.nextSibling,oe=H.firstChild;return oe.nextSibling,N.style.setProperty("margin-bottom","2rem"),q.style.setProperty("display","flex"),q.style.setProperty("justify-content","space-between"),q.style.setProperty("margin-bottom","1rem"),i(D,()=>r().displayName||"Not set",null),i(F,()=>r().uid,null),i(H,()=>new Date(r().createdAt?.toDate?.()||r().createdAt).toLocaleDateString(),null),N})(),(()=>{var N=_E(),q=N.firstChild,D=q.nextSibling,C=D.nextSibling;return N.style.setProperty("margin-bottom","2rem"),q.style.setProperty("margin-bottom","1rem"),d(D,S),i(D,b(ut,{each:_,children:F=>{let ee=Le.getLocationById(F?.id);return(()=>{var H=AE(),oe=H.firstChild,M=oe.nextSibling;return H.$$click=()=>R(F?.id),oe.style.setProperty("cursor","pointer"),M.style.setProperty("cursor","pointer"),M.style.setProperty("user-select","none"),i(M,()=>ee?.name),X(G=>d(H,{...$,background:r().stores?.[F?.id]?"var(--primary-color-light)":"transparent"},G)),X(()=>oe.checked=r().stores?.[F?.id]||!1),H})()}})),C.style.setProperty("margin-top","0.5rem"),C.style.setProperty("font-size","0.875rem"),C.style.setProperty("color","var(--text-muted)"),N})(),(()=>{var N=SE(),q=N.firstChild,D=q.nextSibling;return N.style.setProperty("margin-bottom","2rem"),q.style.setProperty("margin-bottom","1rem"),d(D,g),i(D,b(ut,{each:x,children:C=>(()=>{var F=IE(),ee=F.firstChild,H=ee.nextSibling,oe=H.firstChild,M=oe.nextSibling;return F.$$click=()=>Y(C.key),ee.style.setProperty("cursor","pointer"),H.style.setProperty("flex","1"),H.style.setProperty("cursor","pointer"),H.style.setProperty("user-select","none"),oe.style.setProperty("font-weight","500"),i(oe,()=>C.label),M.style.setProperty("font-size","0.75rem"),M.style.setProperty("color","var(--text-muted)"),i(M,()=>C.description),X(G=>d(F,{...$,background:r()[C.key]?"var(--primary-color-light)":"transparent"},G)),X(()=>ee.checked=!!r()[C.key]),F})()})),N})(),(()=>{var N=jm();return N.style.setProperty("display","flex"),N.style.setProperty("gap","1rem"),N.style.setProperty("justify-content","flex-end"),i(N,b(qe,{variant:"secondary",onClick:()=>n(null),children:"Cancel"}),null),i(N,b(qe,{variant:"primary",onClick:Z,get disabled(){return a()},get children(){return a()?"Saving...":"Save Changes"}}),null),N})()]}})]}})),X(()=>J.value=u()),y}})}})};wt(["input","click"]);const TE=async()=>{try{console.log("Testing PDF generation...");const e=(await Sn(()=>import("./jspdf.es.min-5BvNmcXe.js").then(n=>n.j),[])).default;console.log("jsPDF imported successfully");const r=new e;console.log("PDF document created"),r.setFontSize(20),r.text("Test PDF",20,20),r.setFontSize(12),r.text("This is a test PDF to verify the library works.",20,40),console.log("Text added to PDF"),r.save("test.pdf"),console.log("PDF saved successfully"),alert("Test PDF generated successfully!")}catch(t){console.error("Test PDF generation failed:",t),alert(`Test PDF failed: ${t.message}`)}},qm=(t,e)=>{try{console.log("Generating printable PDF...");const r=window.open("","_blank","width=800,height=600");if(!r){alert("Please allow popups to generate PDF");return}const n=t.shipper_consignee||{},o=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Invoice ${t.invoice||"N/A"}</title>
        <style>
          body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
          }
          .header {
            display: flex;
            justify-content: space-between;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
            margin-bottom: 20px;
          }
          .company {
            font-size: 24px;
            font-weight: bold;
            color: #2563eb;
          }
          .invoice-info {
            text-align: right;
          }
          .section {
            margin: 20px 0;
          }
          .section-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
          }
          .customer-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
             font-size: 13px;
          }
          .flex{
            display: flex;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
          }
          th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
          }
          th {
            background-color: #f2f2f2;
            font-weight: bold;
            font-size: 13px;
          }
          td{
           font-size: 12px;
          }
          .total-row {
            font-weight: bold;
            font-size: 16px;
            background-color: #e8f4fd;
          }
          @media print {
            body { margin: 0; }
            .no-print { display: none; }
          }
        </style>
      </head>
      <body>
        <div class="header">
          <div>
            <div class="company">HRM FINANCE</div>
            <div>${e("common.store")}: ${t.store||"N/A"}</div>
            <div>${e("common.orderId")}: ${t.ssg_sorder_key||"N/A"}</div>
            ${t.shippingMethod?`<div>${e("common.shipping")}: ${t.shippingMethod==="aereo"?e("common.air"):e("common.sea")}</div>`:""}
          </div>
          <div class="invoice-info">
            <div style="font-size: 18px; font-weight: bold;">${e("common.invoice").toUpperCase()}</div>
            <div style="font-size: 16px; margin: 5px 0;">${t.invoice||"N/A"}</div>
            <div>${t.createDate?new Date(t.createDate).toLocaleDateString():"N/A"}</div>
            <div style="margin-top: 10px;">
              <span style="padding: 4px 8px; background: ${t.isCompleted?"#d4edda":"#fff3cd"}; border-radius: 10px; font-size: 12px;">
                ${t.isCompleted?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase()}
              </span>
            </div>
          </div>
        </div>

        <div class="section">
          <div class="section-title">${e("invoices.customerInformation")}</div>
          <div class="customer-info">
            <div><strong>${e("invoices.senderInformation")}:</strong> ${n.name||"N/A"}</div>
            <div><strong>${e("invoices.receiptInformation")}:</strong> ${[n.firstName,n.middleName,n.lastName,n.lastName2].filter(Boolean).join(" ")||"N/A"}</div>
            <div><strong>${e("invoices.phoneNumber")}:</strong> ${n.phoneNumber||"N/A"}</div>
            <div><strong>${e("invoices.id")}:</strong> ${n.cid||"N/A"}</div>
            ${n.passport?`<div><strong>${e("invoices.passport")}:</strong> ${n.passport}</div>`:""}
            ${n.address?`<div><strong>${e("invoices.address")}:</strong> ${n.address}</div>`:""}
          </div>
        </div>

        ${t.products&&t.products.length>0?`
        <div class="section">
          <div class="section-title">${e("invoices.products")}</div>
          <table>
            <thead>
              <tr>
                <th>${e("invoices.code")}</th>
                <th>${e("invoices.description")}</th>
                <th>${e("invoices.qty")}</th>
                <th>${e("invoices.unitPrice")}</th>
                <th>${e("invoices.total")}</th>
              </tr>
            </thead>
            <tbody>
              ${t.products.map(s=>`
                <tr>
                  <td>${s.product?.code||"N/A"}</td>
                  <td>${s.product?.label||"N/A"}</td>
                  <td>${Math.abs(s.qty||0)}</td>
                  <td>$${parseFloat(s.salePrice||0).toFixed(2)}</td>
                  <td>$${(s.total||Math.abs(s.qty||0)*parseFloat(s.salePrice||0)).toFixed(2)}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
        </div>
        `:""}

        ${t.reservas&&t.reservas.length>0?`
        <div class="section">
          <div class="section-title">${e("invoices.reservations")}</div>
          <table>
            <thead>
              <tr>
                <th>${e("invoices.type")}</th>
                <th>${e("invoices.qty")}</th>
                <th>${e("invoices.unitPrice")}</th>
                <th>${e("invoices.arancel")}</th>
                <th>${e("invoices.total")}</th>
              </tr>
            </thead>
            <tbody>
              ${t.reservas.map(s=>{const a=parseFloat(s.qty||0),l=parseFloat(s.price||0),u=parseFloat(s.arancel||0),h=s.total||a*l+u;return`
                  <tr>
                    <td>${s.type||"N/A"}</td>
                    <td>${a.toFixed(2)}</td>
                    <td>$${l.toFixed(2)}</td>
                    <td>$${u.toFixed(2)}</td>
                    <td>$${h.toFixed(2)}</td>
                  </tr>
                `}).join("")}
            </tbody>
          </table>
        </div>
        `:""}

        <div class="section flex">
          ${t.paymentMethods?`
        <div class="section" style="margin-right: auto; width: 48%">
          <div class="section-title">${e("common.paymentMethods")}</div>
          <div class="customer-info">
            ${t.paymentMethods.cash>0?`<div><strong> ${e("common.cash")}:</strong> $${t.paymentMethods.cash.toFixed(2)}</div>`:""}
            ${t.paymentMethods.zelle>0?`<div><strong> Zelle:</strong> $${t.paymentMethods.zelle.toFixed(2)}</div>`:""}
            ${t.paymentMethods.creditCard>0?`<div><strong> ${e("common.creditCard")}:</strong> $${t.paymentMethods.creditCard.toFixed(2)}</div>`:""}
            ${t.paymentMethods.exemptTaxOnCash&&t.paymentMethods.cash>0&&t.taxSavings>0?`
              <div style="margin-top: 10px; padding: 8px; background-color: #e7f5ff; border-radius: 4px; font-size: 12px; font-style: italic;">
                * ${e("common.taxExemptNote")} ${e("common.youSaved")} $${t.taxSavings.toFixed(2)}!
              </div>
            `:""}
          </div>
        </div>
        `:""}
        <div class="section ">
          <table style="margin-left: auto; width: width: 48%">
            ${t.productSubtotal?`
            <tr>
              <td><strong>${e("invoices.productsSubtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${t.productSubtotal.toFixed(2)}</strong></td>
            </tr>
            `:""}
            ${t.reservaSubtotal?`
            <tr>
              <td><strong>${e("invoices.reservationsSubtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${t.reservaSubtotal.toFixed(2)}</strong></td>
            </tr>
            `:""}
            ${t.taxAmount&&t.taxAmount>0?`
            <tr>
              <td><strong>${e("common.subtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${(t.subtotalBeforeTax||0).toFixed(2)}</strong></td>
            </tr>
            <tr>
              <td><strong>${e("common.tax")} (${t.paymentMethods?.taxPercent||7}%):</strong></td>
              <td style="text-align: right;"><strong>$${t.taxAmount.toFixed(2)}</strong></td>
            </tr>
            `:""}
            <tr class="total-row">
              <td><strong>${e("invoices.total").toUpperCase()}:</strong></td>
              <td style="text-align: right;"><strong>$${(t.total||0).toFixed(2)}</strong></td>
            </tr>
          </table>
        </div>
        </div>
        
       

        <div style="margin-top: 40px; text-align: center; color: #666; font-size: 12px;">
          <p>${e("common.thankYouBusiness")}</p>
          <p>${e("common.generatedOn")} ${new Date().toLocaleDateString()}</p>
        </div>

        <div class="no-print" style="margin-top: 30px; text-align: center;">
          <button onclick="window.print()" style="padding: 10px 20px; font-size: 16px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">
            ${e("common.printSavePDF")}
          </button>
          <button onclick="window.close()" style="padding: 10px 20px; font-size: 16px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer; margin-left: 10px;">
            ${e("common.close")}
          </button>
        </div>
      </body>
      </html>
    `;r.document.write(o),r.document.close(),r.focus(),console.log("Printable PDF window opened")}catch(r){console.error("Error generating printable PDF:",r),alert("Error generating printable PDF: "+r.message)}},kE=async(t,e)=>{try{console.log("Starting professional PDF generation...");const n=(await Sn(()=>import("./jspdf.es.min-5BvNmcXe.js").then(U=>U.j),[])).default,o=new n,s=210,a=297,l=15,u=s-l*2,h={r:180,g:180,b:180},m={r:80,g:80,b:80},v={r:130,g:130,b:130},_={r:248,g:248,b:248},x={r:252,g:252,b:252},T={r:120,g:120,b:120},E={r:150,g:150,b:150};let P=l;const R=U=>{o.setTextColor(U.r,U.g,U.b)},Y=U=>{o.setFillColor(U.r,U.g,U.b)},Z=(U,te,ae,re,ce,Q=!1)=>{o.roundedRect(U,te,ae,re,ce,ce,Q?"F":"S")};Y(x),o.rect(0,0,s,50,"F"),o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.5),o.line(0,50,s,50),R(m),o.setFontSize(32),o.setFont("helvetica","bold"),o.text("HRM",l,25),R(v),o.setFontSize(32),o.setFont("helvetica","normal");const j=o.getTextWidth("HRM ");o.text("FINANCE",l+j,25),R(v),o.setFontSize(9),o.setFont("helvetica","normal"),o.text("Professional Business Solutions",l,35);const B=70,V=s-l-B;o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.5),Z(V,12,B,26,2,!1),R(m),o.setFontSize(14),o.setFont("helvetica","bold");const f=e("common.invoice").toUpperCase(),g=o.getTextWidth(f);o.text(f,V+(B-g)/2,22),o.setFontSize(11),o.setFont("helvetica","normal");const S=t.invoice||"N/A",$=o.getTextWidth(S);o.text(S,V+(B-$)/2,32),P=60,Y(x),o.rect(0,50,s,20,"F");const w=t.isCompleted,I=w?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase();R(w?m:v),o.setFontSize(8),o.setFont("helvetica","bold"),o.text(`STATUS: ${I}`,l,58),R(v),o.setFontSize(9),o.setFont("helvetica","normal");const de=t.createDate?new Date(t.createDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A";o.text(de,s-l-o.getTextWidth(de),58),P=58,o.text(`${e("common.store")}: ${t.store||"N/A"}`,l+60,P),P+=5,o.text(`${e("common.orderId")}: ${t.ssg_sorder_key||"N/A"}`,l+60,P),t.shippingMethod&&o.text(`${e("common.shipping")}: ${t.shippingMethod==="aereo"?e("common.air"):e("common.sea")}`,s-l-50,P),P=80,R(m),o.setFontSize(14),o.setFont("helvetica","bold"),o.text(e("invoices.customerInformation"),l,P),P+=10;const J=45,O=10,N=(u-O)/2;Y(x),Z(l,P,N,J,3,!0),o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.3),Z(l,P,N,J,3);const q=t.shipper_consignee||{};let D=P+8;R(v),o.setFontSize(9),o.text(e("invoices.senderInformation"),l+5,D),D+=7,R(m),o.setFontSize(11),o.setFont("helvetica","bold"),o.text(q.name||"N/A",l+5,D),q.phoneNumberS&&(D+=6,o.setFont("helvetica","normal"),o.setFontSize(9),R(v),o.text(`${e("invoices.altPhone")}: ${q.phoneNumberS}`,l+5,D)),Y(x),Z(l+N+O,P,N,J,3,!0),o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.3),Z(l+N+O,P,N,J,3),D=P+8,R(v),o.setFontSize(9),o.text(e("invoices.receiptInformation"),l+N+O+5,D),D+=7;const C=[q.firstName,q.middleName,q.lastName,q.lastName2].filter(Boolean).join(" ")||"N/A";if(R(m),o.setFontSize(11),o.setFont("helvetica","bold"),o.text(C,l+N+O+5,D),D+=6,o.setFont("helvetica","normal"),o.setFontSize(9),R(v),o.text(`${e("invoices.phoneNumber")}: ${q.phoneNumber||"N/A"}`,l+N+O+5,D),console.log(q),D+=5,o.text(`${e("invoices.id")}: ${q.cid||"N/A"}`,l+N+O+5,D),q.address)D+=5,q.address.split(",").map(te=>te.trim()).forEach((te,ae)=>{ae<2&&te&&(o.text(te,l+N+O+5,D),D+=5)});else{let U=`${q.ybstreet||""} #${q.ybstreetNo||""} ${e("invoices.between")} ${q.ybbetwen1||""} ${e("invoices.and")} ${q.ybbetwen2||""}`,te=`${q.ybreparto||""}, ${q.ybcity||""}, ${q.ybestate||""}`;D+=5,o.text(U,l+N+O+5,D),D+=5,o.text(te,l+N+O+5,D)}if(P+=J+15,t?.products&&t?.products?.length>0){R(m),o.setFontSize(14),o.setFont("helvetica","bold"),o.text(e("invoices.products"),l,P),P+=10,Y(_),o.rect(l,P-6,u,10,"F"),o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.3),o.line(l,P+4,s-l,P+4),o.setFontSize(9),o.setFont("helvetica","bold"),R(m);const U={code:l+5,description:l+35,qty:l+115,price:l+135,total:l+160};o.text(e("invoices.code"),U.code,P),o.text(e("invoices.description"),U.description,P),o.text(e("invoices.qty"),U.qty,P),o.text(e("invoices.unitPrice"),U.price,P),o.text(e("invoices.total"),U.total,P),P+=10,o.setFont("helvetica","normal"),o.setFontSize(9),t.products.forEach((te,ae)=>{P>250&&(o.addPage(),P=l),ae%2===0&&(Y(x),o.rect(l,P-4,u,8,"F")),R(m),o.text(te.product?.code||"N/A",U.code,P);let re=te.product?.label||"N/A";o.getTextWidth(re)>70&&(re=re.substring(0,40)+"..."),o.text(re,U.description,P);const ce=Math.abs(te.qty||0),Q=parseFloat(te.salePrice||0),me=te.total||ce*Q;o.text(ce.toString(),U.qty,P),o.text(`$${Q.toFixed(2)}`,U.price,P),o.setFont("helvetica","bold"),o.text(`$${me.toFixed(2)}`,U.total,P),o.setFont("helvetica","normal"),P+=8}),o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.3),o.line(l,P,s-l,P),P+=15}if(t.reservas&&t.reservas.length>0){P>200&&(o.addPage(),P=l),R(m),o.setFontSize(14),o.setFont("helvetica","bold"),o.text(e("invoices.reservations"),l,P),P+=10,Y(_),o.rect(l,P-6,u,10,"F"),o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.3),o.line(l,P+4,s-l,P+4),o.setFontSize(9),o.setFont("helvetica","bold"),R(m);const U={type:l+5,qty:l+65,price:l+95,arancel:l+125,total:l+160};o.text(e("invoices.type"),U.type,P),o.text(e("invoices.qty"),U.qty,P),o.text(e("invoices.unitPrice"),U.price,P),o.text(e("invoices.arancel"),U.arancel,P),o.text(e("invoices.total"),U.total,P),P+=10,o.setFont("helvetica","normal"),o.setFontSize(9),t.reservas.forEach((te,ae)=>{P>250&&(o.addPage(),P=l),ae%2===0&&(Y(x),o.rect(l,P-4,u,8,"F")),R(m),o.text(te.type||"N/A",U.type,P);const re=parseFloat(te.qty||0),ce=parseFloat(te.price||0),Q=parseFloat(te.arancel||0),me=te.total||re*ce+Q;o.text(re.toString(),U.qty,P),o.text(`$${ce.toFixed(2)}`,U.price,P),o.text(`$${Q.toFixed(2)}`,U.arancel,P),o.setFont("helvetica","bold"),o.text(`$${me.toFixed(2)}`,U.total,P),o.setFont("helvetica","normal"),P+=8}),o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.3),o.line(l,P,s-l,P),P+=15}P>210&&(o.addPage(),P=l);const F=s-l-80,ee=80;let H=60;t.taxAmount&&t.taxAmount>0&&(H+=16),Y(x),Z(F-10,P,ee+10,H,3,!0),o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.3),Z(F-10,P,ee+10,H,3);let oe=P+10;if(o.setFontSize(10),R(v),t.productSubtotal!==void 0&&t.productSubtotal>0&&(o.text(e("invoices.productsSubtotal"),F,oe),o.text(`$${t.productSubtotal.toFixed(2)}`,F+ee-15,oe,{align:"right"}),oe+=8),t.reservaSubtotal!==void 0&&t.reservaSubtotal>0&&(o.text(e("invoices.reservationsSubtotal"),F,oe),o.text(`$${t.reservaSubtotal.toFixed(2)}`,F+ee-15,oe,{align:"right"}),oe+=8),t.taxAmount&&t.taxAmount>0){o.text(e("common.subtotal"),F,oe),o.text(`$${(t.subtotalBeforeTax||0).toFixed(2)}`,F+ee-15,oe,{align:"right"}),oe+=8;const U=t.paymentMethods?.taxPercent||7;o.text(`${e("common.tax")} (${U}%)`,F,oe),o.text(`$${t.taxAmount.toFixed(2)}`,F+ee-15,oe,{align:"right"}),oe+=8}if(o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.3),o.line(F,oe+2,F+ee-10,oe+2),oe+=10,o.setFontSize(14),o.setFont("helvetica","bold"),R(m),o.text(e("invoices.total"),F,oe),o.text(`$${(t.total||0).toFixed(2)}`,F+ee-15,oe,{align:"right"}),t.paymentMethods){P+=H+20,R(m),o.setFontSize(12),o.setFont("helvetica","bold"),o.text(e("common.paymentMethods"),l,P),P+=10,o.setFontSize(10),o.setFont("helvetica","normal"),R(v);const U=t.paymentMethods;let te=P;U.cash&&U.cash>0&&(o.text(`${e("common.cash")}:`,l+5,te),o.text(`$${U.cash.toFixed(2)}`,l+50,te),te+=6),U.zelle&&U.zelle>0&&(o.text("Zelle:",l+5,te),o.text(`$${U.zelle.toFixed(2)}`,l+50,te),te+=6),U.creditCard&&U.creditCard>0&&(o.text(`${e("common.creditCard")}:`,l+5,te),o.text(`$${U.creditCard.toFixed(2)}`,l+50,te),te+=6),U.exemptTaxOnCash&&U.cash>0&&t.taxSavings>0&&(te+=4,o.setFontSize(9),o.setFont("helvetica","italic"),o.text(`* Tax exempted on cash payment. You saved $${t.taxSavings.toFixed(2)}!`,l+5,te)),P=te+10}P=a-30,Y(x),o.rect(0,P-10,s,40,"F"),o.setFontSize(12),o.setFont("helvetica","italic"),R(v);const M=e("common.thankYouBusiness"),G=o.getTextWidth(M);o.text(M,(s-G)/2,P),P+=8,o.setFontSize(9),o.setFont("helvetica","normal");const le="www.hrmfinance.com | info@hrmfinance.com | +1 (555) 123-4567",ne=o.getTextWidth(le);o.text(le,(s-ne)/2,P),P+=8,o.setFontSize(8);const ue=`Generated on ${new Date().toLocaleString("en-US")}`,L=o.getTextWidth(ue);o.text(ue,(s-L)/2,P);const A=`invoice-${t.invoice||"unknown"}.pdf`;o.save(A),console.log("Professional PDF saved successfully:",A)}catch(r){throw console.error("Error in generateProfessionalInvoicePDF:",r),r}},ho=t=>parseFloat(t?.toString()||"0")||0,RE=t=>{if(t.includes("/")){const[e,r,n]=t.split("/");return`${n}-${e.padStart(2,"0")}-${r.padStart(2,"0")}`}return t},DE=t=>{const e=[];return t.ybstreet&&(e.push(t.ybstreet),t.ybstreetNo&&e.push(`# ${t.ybstreetNo}`)),t.ybbetwen1&&t.ybbetwen2&&e.push(`/ ${t.ybbetwen1} y ${t.ybbetwen2}`),t.ybreparto&&e.push(`, Rpto ${t.ybreparto}`),t.ybcity&&e.push(`, ${t.ybcity}`),t.ybestate&&e.push(`, ${t.ybestate}`),e.join(" ")},Gm=t=>{const e=ho(t.qty),r=ho(t.price),n=ho(t.arancel);return t.onlyTariff?n:e*r+n},Hm=t=>{const e=Math.abs(t.qty),r=ho(t.salePrice);return e*r},NE=(t,e)=>{const r=t.split("-");if(r.length>=3){const n=r[0];return{YY_8803:"BISSONNET"}[n]||e}return e},LE=(t,e)=>{const r=Math.floor(t*.93),n=t-r;return{taxOnTotal:!1,taxPercent:7,exemptTaxOnCash:!0,cash:r,zelle:n,creditCard:0}},ME=t=>{const e=t?.products?.reduce((R,Y)=>R+Hm(Y),0),r=t?.reservas?.reduce((R,Y)=>R+Gm(Y),0),n=e+r,o=7,s=.93,l=n*(1-s)*(o/100),u=n*o/100-l,h=n+l,v=(t?.products||[])?.map((R,Y)=>({id:Date.now().toString()+Y,product:{id:R.product.id,code:R.product.code,label:R.product.label,price:0},qty:Math.abs(R.qty),salePrice:ho(R.salePrice),total:Hm(R)})),_=t?.reservas?.map((R,Y)=>({id:Date.now().toString()+Y+1e3,type:R.type,qty:ho(R.qty),price:ho(R.price),arancel:ho(R.arancel),total:Gm(R)})),x={name:t.shipper_consignee.name,firstName:t.shipper_consignee.firstName,middleName:t.shipper_consignee.middleName||"",lastName:t.shipper_consignee.lastName,lastName2:t.shipper_consignee.lastName2||"",phoneNumber:t.shipper_consignee.phoneNumber,cid:t.shipper_consignee.cid,passport:t.shipper_consignee.passport||"",address:DE(t.shipper_consignee),phoneNumberS:t.shipper_consignee.phoneNumberS,dob:RE(t.shipper_consignee.dob)},T=NE(t.invoice,t.store),E=t.shipper_consignee.shipping?.toLowerCase()==="aereo"?"aereo":"maritimo",P=LE(h);return{invoice:t.invoice,description:t.description||"",store:T,shipper_consignee:x,products:v,reservas:_,packagesOrder:t.packagesOrder,shippingMethod:E,paymentMethods:P,type:t.type,ssg_inventory_key:t.ssg_inventory_key,ssg_sorder_key:t.ssg_sorder_key,createDate:t.createDate,businessId:t.businessId,isCompleted:t.isCompleted,productSubtotal:e,reservaSubtotal:r,subtotalBeforeTax:n,taxAmount:l,taxSavings:u,total:h,taxCalculationMethod:"subtotal",cashPaymentRatio:s}};var OE=z("<br>"),Wm=z("<div><h3></h3><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),Ym=z("<div><span>:</span><span>"),FE=z("<div class=invoice-display><div><div><div>:<span></span></div><div>: <span></span></div></div><div><div></div><h2></h2><div></div><div></div></div></div><div><h3></h3><div><div><div></div><div></div></div></div><div></div><h3></h3><div><div><div></div><div> <!> <!> </div><div></div><div></div><div></div><div></div></div><div><div></div><div></div><div></div><div></div><div> #<br> <!> <!> <br>, <br>, </div></div></div></div><div><div><div><span>:</span><span></span></div></div></div><div></div><div><button> </button><button> Test PDF</button><button> </button></div><style>"),Km=z("<tr><td></td><td></td><td></td><td></td><td>");const VE=t=>{const{t:e}=ft(),[r,n]=ye(""),[o,s]=ye(!1),a=N=>new Date(N).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),l=N=>{const q=typeof N=="string"?parseFloat(N):N;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(q)},u=Ze(()=>{let N=0,q=0,D=0,C=0;t.invoice?.products?.forEach(oe=>{const M=Math.abs(oe?.qty),G=parseFloat(oe?.salePrice?.toString())||1;N+=M*G}),t.invoice?.reservas?.forEach(oe=>{let M=parseFloat(oe?.qty?.toString());isNaN(M)&&(M=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[oe.type]||oe?.onlyTariff?(M=parseFloat(oe.arancel?.toString())||parseFloat(oe.qty?.toString())*parseFloat(oe.price?.toString()),D+=M):(oe?.arancel&&(C+=parseFloat(oe?.arancel?.toString())),q+=M*parseFloat(oe?.price?.toString()))});const F=N+q+C+D,ee=0,H=F+ee;return{productSubtotal:N,reservaSubtotal:q,tariffSubtotal:C,subtotal:F,tax:ee,total:H}}),h={"max-width":"800px",margin:"0 auto",padding:"2rem",background:"white","box-shadow":"0 0 20px rgba(0,0,0,0.1)","border-radius":"var(--border-radius)"},m={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"2rem","padding-bottom":"2rem","border-bottom":"2px solid #e0e0e0"},v={"text-align":"right",flex:"1"},_={display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"600","text-transform":"uppercase",background:t.invoice.isCompleted?"#d4edda":"#fff3cd",color:t.invoice.isCompleted?"#155724":"#856404","margin-bottom":"0.5rem"},x={"margin-bottom":"2rem"},T={"font-size":"1.1rem","font-weight":"600","margin-bottom":"1rem",color:"#333"},E={display:"grid","grid-template-columns":"1fr 1fr",gap:"1.5rem"},P={background:"#f8f9fa",padding:"1rem","border-radius":"var(--border-radius-sm)",border:"1px solid #e9ecef"},R={"font-size":"0.875rem",color:"#666","margin-bottom":"0.25rem"},Y={"font-size":"1rem",color:"#333","font-weight":"500"},Z={width:"100%","border-collapse":"collapse","margin-top":"1rem"},j={"text-align":"left",padding:"0.75rem","border-bottom":"2px solid #dee2e6","font-weight":"600",color:"#495057","font-size":"0.875rem","text-transform":"uppercase"},B={padding:"0.75rem","border-bottom":"1px solid #dee2e6",color:"#212529"},V={"font-weight":"600","font-size":"1.1rem"},f={display:"flex",gap:"1rem","justify-content":"center","margin-top":"2rem","padding-top":"2rem","border-top":"2px solid #e0e0e0"},g={padding:"0.75rem 1.5rem","border-radius":"var(--border-radius-sm)",border:"none","font-weight":"500",cursor:"pointer",transition:"all 0.2s",display:"flex","align-items":"center",gap:"0.5rem"},S={...g,background:"var(--primary-color)",color:"white"},$={...g,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},w=Ze(()=>Le.getLocationById(t.invoice.store)),I=async()=>{console.log("Starting PDF export...");try{if(!t.invoice){console.error("No invoice data available"),alert("No invoice data available");return}console.log("Invoice data:",t.invoice),console.log("Store info:",w()),console.log("Totals:",u());const N={...t.invoice,storeName:w()?.name||t.invoice.store,storeType:w()?.type,productSubtotal:u().productSubtotal,reservaSubtotal:u().reservaSubtotal,total:u().total};let q=ME(t.invoice);console.log("Prepared invoice data:",q),console.log(JSON.stringify(q,null,4)),console.log("Using minimal ink PDF generator...");try{qm(q,e),await kE(q,e),console.log("Minimal ink PDF generation completed successfully")}catch(D){console.error("PDF generation failed:",D),console.log("Trying printable PDF fallback..."),qm(q,e),console.log("Printable PDF fallback completed")}}catch(N){console.error("Error in handleExportPDF:",N),console.error("Error stack:",N.stack),alert(`Error generating PDF: ${N.message}`)}},y=N=>parseFloat(N?.toString())||0,de=N=>{let q=y(N.qty),D=y(N.price),C=y(N.arancel);return`${(q*D+C)?.toFixed(2)}`},J=N=>{let q=Math.abs(N.qty),D=y(N.salePrice);return`${(q*D)?.toFixed(2)}`},O=async()=>{if(t.invoice){s(!0);try{const{generateEnhancedInvoicePDF:N}=await Sn(async()=>{const{generateEnhancedInvoicePDF:C}=await import("./enhancedInvoicePdfGenerator-BhxIBI5e.js");return{generateEnhancedInvoicePDF:C}},__vite__mapDeps([0,1]));let q=od(t.invoice);if(!(q?.paymentMethods&&q?.productSubtotal&&q?.total)){let C=0;q?.reservas.forEach(ee=>{C+=parseFloat(de(ee))});let F=0;q?.products?.forEach(ee=>{F+=parseFloat(J(ee))}),q.reservaSubtotal=C.toFixed(2),q.productSubtotal=F.toFixed(2),q.subtotalBeforeTax=(F+C).toFixed(2),q.total=q.subtotalBeforeTax,console.log(q)}const D=await N(q,"es","modern")}catch(N){console.log(N)}finally{s(!1)}}};return(()=>{var N=FE(),q=N.firstChild,D=q.firstChild,C=D.firstChild,F=C.firstChild,ee=F.nextSibling,H=C.nextSibling,oe=H.firstChild,M=oe.nextSibling,G=D.nextSibling,le=G.firstChild,ne=le.nextSibling,ue=ne.nextSibling,L=ue.nextSibling,A=q.nextSibling,U=A.firstChild,te=U.nextSibling,ae=te.firstChild,re=ae.firstChild,ce=re.nextSibling,Q=te.nextSibling,me=Q.nextSibling,K=me.nextSibling,he=K.firstChild,ve=he.firstChild,W=ve.nextSibling,ie=W.firstChild,Pe=ie.nextSibling,_e=Pe.nextSibling,fe=_e.nextSibling;fe.nextSibling;var be=W.nextSibling,pe=be.nextSibling,we=pe.nextSibling,De=we.nextSibling,ke=he.nextSibling,Te=ke.firstChild,Ue=Te.nextSibling,Xe=Ue.nextSibling,ze=Xe.nextSibling,$e=ze.nextSibling,Ge=$e.firstChild,ot=Ge.nextSibling,je=ot.nextSibling,Ce=je.nextSibling,Se=Ce.nextSibling,Ke=Se.nextSibling,He=Ke.nextSibling,Oe=He.nextSibling,Ye=Oe.nextSibling,pt=Ye.nextSibling,vt=pt.nextSibling,mt=A.nextSibling,yt=mt.firstChild,Qe=yt.firstChild,Ct=Qe.firstChild,_t=Ct.firstChild,jt=Ct.nextSibling,Mt=mt.nextSibling,Be=Mt.nextSibling,We=Be.firstChild;We.firstChild;var at=We.nextSibling,lt=at.nextSibling;lt.firstChild;var Tt=Be.nextSibling;return d(N,h),d(q,m),C.style.setProperty("color","#666"),C.style.setProperty("margin-top","0.25rem"),i(C,()=>e(`inventory.${w()?.type}Type`),F),ee.style.setProperty("font-size","1.1rem"),ee.style.setProperty("font-weight","600"),ee.style.setProperty("color","#444"),i(ee,()=>w()?.name),H.style.setProperty("font-size",".91rem"),H.style.setProperty("font-weight","400"),H.style.setProperty("color","#666"),i(H,()=>e("invoices.id"),oe),M.style.setProperty("font-size","1.1rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","#444"),i(M,()=>t.invoice.ssg_sorder_key),d(G,v),i(le,(()=>{var Ie=ge(()=>!!t.invoice.isCompleted);return()=>Ie()?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase()})()),ne.style.setProperty("margin","0 0 0.5rem 0"),ne.style.setProperty("font-size","1.5rem"),i(ne,()=>e("common.invoice").toUpperCase()),ue.style.setProperty("font-size","1.1rem"),ue.style.setProperty("font-weight","600"),ue.style.setProperty("color","#333"),i(ue,()=>t.invoice.invoice),L.style.setProperty("color","#666"),L.style.setProperty("margin-top","0.5rem"),i(L,()=>a(t.invoice.createDate)),i(U,()=>e("invoices.senderInformation")),i(re,()=>e("invoices.customerName")),i(ce,()=>t.invoice.shipper_consignee.name),i(ae,b(Ae,{get when(){return t.invoice.shipper_consignee.phoneNumberS},get children(){return[OE(),ge(()=>e("invoices.altPhone")),": ",ge(()=>t.invoice.shipper_consignee.phoneNumberS)]}}),null),Q.style.setProperty("margin","20px"),i(me,()=>e("invoices.receiptInformation")),i(ve,()=>e("invoices.customerName")),i(W,()=>t.invoice.shipper_consignee.firstName,ie),i(W,()=>t.invoice.shipper_consignee.middleName,Pe),i(W,()=>t.invoice.shipper_consignee.lastName,fe),i(W,()=>t.invoice.shipper_consignee.lastName2,null),i(be,()=>e("invoices.id")),i(pe,()=>t.invoice.shipper_consignee.cid),i(we,()=>e("invoices.passport")),i(De,()=>t.invoice.shipper_consignee.passport),i(Te,()=>e("invoices.contactInformation")),i(Ue,()=>e("invoices.phoneNumber")),i(Xe,()=>t.invoice.shipper_consignee.phoneNumber),i(ze,()=>e("invoices.address")),i($e,()=>t.invoice.shipper_consignee.ybstreet,Ge),i($e,()=>t.invoice.shipper_consignee.ybstreetNo,ot),i($e,()=>e("invoices.between"),je),i($e,()=>t.invoice.shipper_consignee.ybbetwen1,Ce),i($e,()=>e("invoices.and"),Ke),i($e,()=>t.invoice.shipper_consignee.ybbetwen2,Oe),i($e,()=>t.invoice.shipper_consignee.ybreparto,Ye),i($e,()=>t.invoice.shipper_consignee.ybcity,pt),i($e,()=>t.invoice.shipper_consignee.ybestate,vt),i($e,()=>t.invoice.shipper_consignee.nacionality,null),i(N,b(Ae,{get when(){return t.invoice?.products?.length>0},get children(){var Ie=Wm(),Ve=Ie.firstChild,st=Ve.nextSibling,dt=st.firstChild,Gt=dt.firstChild,Wt=Gt.firstChild,At=Wt.nextSibling,kt=At.nextSibling,rr=kt.nextSibling,Et=rr.nextSibling,er=dt.nextSibling;return i(Ve,()=>e("invoices.products")),i(Wt,()=>e("invoices.code")),i(At,()=>e("invoices.description")),i(kt,()=>e("invoices.qty")),i(rr,()=>e("invoices.unitPrice")),i(Et,()=>e("invoices.total")),i(er,b(ut,{get each(){return t.invoice?.products},children:et=>(()=>{var Rt=Km(),Ot=Rt.firstChild,Vt=Ot.nextSibling,Ht=Vt.nextSibling,nr=Ht.nextSibling,cr=nr.nextSibling;return i(Ot,()=>et.product.code),i(Vt,()=>et.product.label),i(Ht,()=>Math.abs(et.qty)),i(nr,()=>l(et.salePrice)),i(cr,()=>l(Math.abs(et.qty)*parseFloat(et.salePrice))),X(It=>{var hr=B,Hr=B,Ir={...B,"text-align":"center"},Cr={...B,"text-align":"right"},Mr={...B,"text-align":"right"};return It.e=d(Ot,hr,It.e),It.t=d(Vt,Hr,It.t),It.a=d(Ht,Ir,It.a),It.o=d(nr,Cr,It.o),It.i=d(cr,Mr,It.i),It},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Rt})()})),X(et=>{var Rt=x,Ot=T,Vt=Z,Ht=j,nr=j,cr={...j,"text-align":"center"},It={...j,"text-align":"right"},hr={...j,"text-align":"right"};return et.e=d(Ie,Rt,et.e),et.t=d(Ve,Ot,et.t),et.a=d(st,Vt,et.a),et.o=d(Wt,Ht,et.o),et.i=d(At,nr,et.i),et.n=d(kt,cr,et.n),et.s=d(rr,It,et.s),et.h=d(Et,hr,et.h),et},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),Ie}}),mt),i(N,b(Ae,{get when(){return t.invoice?.reservas?.length>0},get children(){var Ie=Wm(),Ve=Ie.firstChild,st=Ve.nextSibling,dt=st.firstChild,Gt=dt.firstChild,Wt=Gt.firstChild,At=Wt.nextSibling,kt=At.nextSibling,rr=kt.nextSibling,Et=rr.nextSibling,er=dt.nextSibling;return i(Ve,()=>e("invoices.reservations")),i(Wt,()=>e("invoices.type")),i(At,()=>e("invoices.qty")),i(kt,()=>e("invoices.unitPrice")),i(rr,()=>e("invoices.arancel")),i(Et,()=>e("invoices.total")),i(er,b(ut,{get each(){return t.invoice?.reservas},children:et=>(()=>{var Rt=Km(),Ot=Rt.firstChild,Vt=Ot.nextSibling,Ht=Vt.nextSibling,nr=Ht.nextSibling,cr=nr.nextSibling;return i(Ot,()=>et.type),i(Vt,()=>et.qty),i(Ht,()=>l(et.price)),i(nr,()=>et.arancel||"-"),i(cr,()=>l(parseInt(et.qty)*parseFloat(et.price)+(et.arancel?parseFloat(et.arancel):0))),X(It=>{var hr=B,Hr={...B,"text-align":"center"},Ir={...B,"text-align":"right"},Cr={...B,"text-align":"right"},Mr={...B,"text-align":"right"};return It.e=d(Ot,hr,It.e),It.t=d(Vt,Hr,It.t),It.a=d(Ht,Ir,It.a),It.o=d(nr,Cr,It.o),It.i=d(cr,Mr,It.i),It},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Rt})()})),X(et=>{var Rt=x,Ot=T,Vt=Z,Ht=j,nr={...j,"text-align":"center"},cr={...j,"text-align":"right"},It={...j,"text-align":"right"},hr={...j,"text-align":"right"};return et.e=d(Ie,Rt,et.e),et.t=d(Ve,Ot,et.t),et.a=d(st,Vt,et.a),et.o=d(Wt,Ht,et.o),et.i=d(At,nr,et.i),et.n=d(kt,cr,et.n),et.s=d(rr,It,et.s),et.h=d(Et,hr,et.h),et},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),Ie}}),mt),yt.style.setProperty("display","inline-block"),yt.style.setProperty("min-width","250px"),i(yt,b(Ae,{get when(){return t.invoice?.products?.length>0},get children(){var Ie=Ym(),Ve=Ie.firstChild,st=Ve.firstChild,dt=Ve.nextSibling;return Ie.style.setProperty("display","flex"),Ie.style.setProperty("justify-content","space-between"),Ie.style.setProperty("margin-bottom","0.5rem"),i(Ve,()=>e("invoices.productsSubtotal"),st),i(dt,()=>l(u().productSubtotal)),Ie}}),Qe),i(yt,b(Ae,{get when(){return t.invoice?.reservas?.length>0},get children(){var Ie=Ym(),Ve=Ie.firstChild,st=Ve.firstChild,dt=Ve.nextSibling;return Ie.style.setProperty("display","flex"),Ie.style.setProperty("justify-content","space-between"),Ie.style.setProperty("margin-bottom","0.5rem"),i(Ve,()=>e("invoices.subtotal"),st),i(dt,()=>l(u().reservaSubtotal)),Ie}}),Qe),i(Ct,()=>e("invoices.total"),_t),jt.style.setProperty("color","var(--primary-color)"),i(jt,()=>l(u().total)),We.addEventListener("mouseleave",Ie=>Ie.currentTarget.style.opacity="1"),We.addEventListener("mouseenter",Ie=>Ie.currentTarget.style.opacity="0.9"),We.$$click=O,i(We,()=>e("invoices.printInvoice"),null),Vn(at,"click",TE,!0),lt.addEventListener("mouseleave",Ie=>{Ie.currentTarget.style.background="white",Ie.currentTarget.style.color="var(--primary-color)"}),lt.addEventListener("mouseenter",Ie=>{Ie.currentTarget.style.background="var(--primary-color)",Ie.currentTarget.style.color="white"}),lt.$$click=I,i(lt,()=>e("invoices.exportPdf"),null),i(Tt,`
        @media print {
          .invoice-display {
            box-shadow: none !important;
            padding: 0 !important;
          }
          
          ${f} {
            display: none !important;
          }
        }
      `),X(Ie=>{var Ve=_,st=x,dt=T,Gt=E,Wt=P,At=R,kt=Y,rr=T,Et=E,er=P,et=R,Rt=Y,Ot={...R,"margin-top":"0.75rem"},Vt=Y,Ht={...R,"margin-top":"0.75rem"},nr=Y,cr=P,It=R,hr={...R,"margin-top":"0.75rem"},Hr=Y,Ir={...R,"margin-top":"0.75rem"},Cr=Y,Mr={...x,"text-align":"right"},gn={...V,display:"flex","justify-content":"space-between","padding-top":"0.75rem","border-top":"2px solid #dee2e6"},to={...x,"text-align":"center",color:"#666","font-size":"0.875rem"},xt=f,Ne=S,Dt={...S,background:"#28a745"},ar=$;return Ie.e=d(le,Ve,Ie.e),Ie.t=d(A,st,Ie.t),Ie.a=d(U,dt,Ie.a),Ie.o=d(te,Gt,Ie.o),Ie.i=d(ae,Wt,Ie.i),Ie.n=d(re,At,Ie.n),Ie.s=d(ce,kt,Ie.s),Ie.h=d(me,rr,Ie.h),Ie.r=d(K,Et,Ie.r),Ie.d=d(he,er,Ie.d),Ie.l=d(ve,et,Ie.l),Ie.u=d(W,Rt,Ie.u),Ie.c=d(be,Ot,Ie.c),Ie.w=d(pe,Vt,Ie.w),Ie.m=d(we,Ht,Ie.m),Ie.f=d(De,nr,Ie.f),Ie.y=d(ke,cr,Ie.y),Ie.g=d(Te,It,Ie.g),Ie.p=d(Ue,hr,Ie.p),Ie.b=d(Xe,Hr,Ie.b),Ie.T=d(ze,Ir,Ie.T),Ie.A=d($e,Cr,Ie.A),Ie.O=d(mt,Mr,Ie.O),Ie.I=d(Qe,gn,Ie.I),Ie.S=d(Mt,to,Ie.S),Ie.W=d(Be,xt,Ie.W),Ie.C=d(We,Ne,Ie.C),Ie.B=d(at,Dt,Ie.B),Ie.v=d(lt,ar,Ie.v),Ie},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0}),N})()};wt(["click"]);const[Wi,Xt]=el({invoices:[],selectedInvoice:null,loading:!1,error:null,lastUpdated:null}),[BE,un]=ye({fetchAll:!1,fetchById:!1,create:!1,update:!1,delete:!1,generatePDF:!1}),hn={get state(){return Wi},get loadingStates(){return BE()},async fetchInvoices(t){try{un(a=>({...a,fetchAll:!0})),Xt("loading",!0),Xt("error",null);let e="SALES";t?.store&&t.store!=="all"&&(e+=" "+t.store),t?.status&&t.status!=="all"&&(e+=" "+t.status);const r=e.toString(),n=await Jr.getInvoice(r);console.log({apiResults:n});let o=[];if(t?.dateFrom&&t?.dateTo){const a=l=>{let u=new Date(n[l].createDate).getTime(),h=new Date(t?.dateFrom).getTime(),m=new Date(t?.dateTo).getTime();u>=h&&u<=m&&o.push(n[l])};Object.keys(n).map(a)}else o=Sc(n);const s=Array.isArray(o)?o:o||[];return Xt("invoices",s),Xt("lastUpdated",new Date),s}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoices";throw Xt("error",r),console.error("Error fetching invoices:",e),e}finally{Xt("loading",!1),un(e=>({...e,fetchAll:!1}))}},fecthInventory:async t=>{},async fetchInvoiceById(t){try{un(n=>({...n,fetchById:!0})),Xt("error",null);const e=await Jr.getInvoice(t),r=Sc(e);return Xt("selectedInvoice",r[0]),r}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoice";throw Xt("error",r),console.error("Error fetching invoice:",e),e}finally{un(e=>({...e,fetchById:!1}))}},async createInvoice(t){try{un(r=>({...r,create:!0})),Xt("error",null);const e={type:t.type||"SALES",invoice:t.invoice,description:t.description||"",store:t.store||"",ssg_inventory_key:t.ssg_inventory_key||`INV-${Date.now()}`,ssg_sorder_key:t.ssg_sorder_key||`SO-${Date.now()}`,createDate:t.createDate||Date.now(),shipper_consignee:t.shipper_consignee,packagesOrder:t.packagesOrder||!1,businessId:t.businessId||"YB100423253156428",userId:t.userId||"current-user",reservas:t.reservas||[],products:t.products||[],isCompleted:t.isCompleted||!0};return e.products&&e.products.length>0&&(e.productSubtotal=e.products.reduce((r,n)=>r+n.qty*n.salePrice,0)),e.reservas&&e.reservas.length>0&&(e.reservaSubtotal=e.reservas.reduce((r,n)=>r+n.total,0)),e.total=(e.productSubtotal||0)+(e.reservaSubtotal||0),console.log("Creating invoice:",e),Xt("invoices",r=>[e,...r]),Xt("lastUpdated",new Date),e}catch(e){const r=e instanceof Error?e.message:"Failed to create invoice";throw Xt("error",r),console.error("Error creating invoice:",e),e}finally{un(e=>({...e,create:!1}))}},async generateInvoicePDF(t,e="compact",r="es"){try{un(l=>({...l,generatePDF:!0})),Xt("error",null);const n=Wi.invoices.find(l=>l.invoice===t);if(!n)throw new Error("Invoice not found");let o;switch(e){case"compact":const{generateCompactModernInvoicePDF:l}=await Sn(async()=>{const{generateCompactModernInvoicePDF:m}=await import("./compactModernInvoicePdfGenerator-uifKqJ1j.js");return{generateCompactModernInvoicePDF:m}},[]);o=l;break;case"modern":const{generateModernMovementInvoicePDF:u}=await Sn(async()=>{const{generateModernMovementInvoicePDF:m}=await import("./modernMovementInvoicePdfGenerator-HzX-_rnG.js");return{generateModernMovementInvoicePDF:m}},[]);o=u;break;case"classic":default:const{generateWorkingInvoicePDF:h}=await Sn(async()=>{const{generateWorkingInvoicePDF:m}=await import("./workingPdfGenerator-DmiO12R-.js");return{generateWorkingInvoicePDF:m}},[]);o=h;break}const s={...n,movementType:"sales",items:n.products||[],invoiceId:n.invoice,id:n.invoice};return await o(s,null,r)}catch(n){const o=n instanceof Error?n.message:"Failed to generate PDF";throw Xt("error",o),console.error("Error generating invoice PDF:",n),n}finally{un(n=>({...n,generatePDF:!1}))}},async updateInvoice(t,e){try{un(n=>({...n,update:!0})),Xt("error",null);const r={};return Xt("invoices",n=>n.map(o=>o.invoice===t?r:o)),Wi.selectedInvoice?.invoice===t&&Xt("selectedInvoice",r),Xt("lastUpdated",new Date),r}catch(r){const n=r instanceof Error?r.message:"Failed to update invoice";throw Xt("error",n),console.error("Error updating invoice:",r),r}finally{un(r=>({...r,update:!1}))}},async deleteInvoice(t){try{return un(e=>({...e,delete:!0})),Xt("error",null),Xt("invoices",e=>e.filter(r=>r.invoice!==t)),Wi.selectedInvoice?.invoice===t&&Xt("selectedInvoice",null),Xt("lastUpdated",new Date),!0}catch(e){const r=e instanceof Error?e.message:"Failed to delete invoice";throw Xt("error",r),console.error("Error deleting invoice:",e),e}finally{un(e=>({...e,delete:!1}))}},async fetchInvoiceStats(t){try{Xt("error",null);const e=new URLSearchParams;t?.store&&t.store!=="all"&&e.append("store",t.store),t?.dateFrom&&e.append("dateFrom",t.dateFrom),t?.dateTo&&e.append("dateTo",t.dateTo);const r=e.toString();return[]}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoice statistics";throw Xt("error",r),console.error("Error fetching invoice stats:",e),e}},async fetchStores(){try{return Xt("error",null),[]}catch(t){const e=t instanceof Error?t.message:"Failed to fetch stores";throw Xt("error",e),console.error("Error fetching stores:",t),t}},setSelectedInvoice(t){Xt("selectedInvoice",t)},clearError(){Xt("error",null)},getFilteredInvoices(t){let e=Wi.invoices;if(t.store&&t.store!=="all"&&(e=e.filter(r=>r.store===t.store)),t.dateFrom){const r=new Date(t.dateFrom).getTime();e=e.filter(n=>n.createDate>=r)}if(t.dateTo){const r=new Date(t.dateTo).setHours(23,59,59,999);e=e.filter(n=>n.createDate<=r)}if(t.status&&t.status!=="all"){const r=t.status==="completed";e=e.filter(n=>n.isCompleted===r)}return e},calculateSummary(t){let e=t.length,r=t.filter(_=>_.isCompleted).length,n=0,o=0,s=0,a=0,l=0,u=0,h=new Set,m=new Set;t?.forEach(_=>{h.add(_?.shipper_consignee?.cid),m.add(_.store),_?.products?.forEach(x=>{const T=Math.abs(x?.qty);n+=T,s+=T*(parseFloat(x?.salePrice)||1)}),_?.reservas?.forEach(x=>{let T=parseInt(x?.qty);isNaN(T)&&(T=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[x.type]||x?.onlyTariff?(T=parseFloat(x.arancel)||parseFloat(x.qty)*parseFloat(x.price),u+=T):(x?.arancel&&(l+=parseFloat(x?.arancel)),o+=T,a+=T*parseFloat(x?.price))})});const v=s+a+u;return{totalInvoices:e,completedInvoices:r,pendingInvoices:e-r,totalProducts:n,totalReservas:o,totalProductAmount:s,totalReservaAmount:a,totalAranceles:l,grandTotal:v,totalOther:u,uniqueCustomers:h.size,uniqueStores:m.size,avgInvoiceValue:e>0?v/e:0}},async refreshData(t){return console.log(" fetchInvoices {queryString}"),this.fetchInvoices(t)}};var UE=z("<div> "),zE=z("<div> <div>"),jE=z("<div><span></span><span>"),ha=z("<div>"),qE=z("<div><div><div><input type=text autocomplete=off>"),GE=z("<button type=button>+"),HE=z("<div><div></div><div>"),WE=z("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div></div><div>: "),YE=z("<span>"),KE=z("<span> ");const QE=t=>{const{t:e}=ft(),[r,n]=ye(!1),[o,s]=ye(""),[a,l]=ye(-1),[u,h]=ye(!1),[m,v]=ye(null),[_,x]=ye([]),[T,E]=ye(null),P=t.searchDelay||300,R=t.maxResults||40,Y=Ze(()=>{if(!t.value)return null;const ue=_().find(L=>L.id===t.value);return ue||Le.getProductById(t.value)}),Z=async ue=>{if(!ue.trim()){x([]);return}h(!0),v(null);const L=Le.getActiveProducts().filter(A=>A.name.toLowerCase().includes(ue.toLowerCase())||A.sku.toLowerCase().includes(ue.toLowerCase())||A?.UPC?.toLowerCase().includes(ue?.toLowerCase())||A.category.toLowerCase().includes(ue.toLowerCase())).slice(0,R);x(L),h(!1)},j=Ze(()=>o().toLowerCase()?_():Le.getActiveProducts().slice(0,10)),B=()=>{n(!0),s(""),l(-1),v(null),o()||x(Le.getActiveProducts().slice(0,10))},V=ue=>{const A=ue.target.value;s(A),n(!0),l(-1),v(null),T()&&clearTimeout(T());const U=setTimeout(()=>{Z(A)},P);E(U)},f=ue=>{t.onChange(ue.id),n(!1),s(""),l(-1),v(null),T()&&(clearTimeout(T()),E(null))},g=ue=>{const L=j();switch(ue.key){case"ArrowDown":ue.preventDefault(),l(A=>Math.min(A+1,L.length-1));break;case"ArrowUp":ue.preventDefault(),l(A=>Math.max(A-1,-1));break;case"Enter":ue.preventDefault(),a()>=0&&L[a()]&&f(L[a()]);break;case"Escape":n(!1),s(""),l(-1),v(null),T()&&(clearTimeout(T()),E(null));break}},S=ue=>{setTimeout(()=>{n(!1),s(""),l(-1),T()&&(clearTimeout(T()),E(null))},150)},$=ue=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ue),w=ue=>Le.stockLevels.filter(L=>L.productId===ue).reduce((L,A)=>L+A.quantity,0);$r(()=>()=>{T()&&clearTimeout(T())});const I={position:"relative",width:"100%",...t.style},y={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},de={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"400px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},J=ue=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:ue?"var(--strip-color)":"transparent",color:ue?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),O={display:"flex","justify-content":"space-between","align-items":"center"},N={flex:"1"},q={"font-weight":"500","margin-bottom":"0.25rem"},D={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem","flex-wrap":"wrap"},C={"text-align":"right","font-size":"0.875rem"},F={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},ee={padding:"1rem","text-align":"center",color:"var(--text-muted)",display:"flex","align-items":"center","justify-content":"center",gap:"0.5rem"},H={padding:"1rem","text-align":"center",color:"#d32f2f",background:"#ffebee","border-radius":"var(--border-radius-sm)",margin:"0.5rem","font-size":"0.875rem"},oe=()=>r()&&o()?o():Y()?`${Y().name} (${Y().sku})`:"",M={display:"flex","align-items":"stretch",width:"100%"},G={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},le={...y,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"},ne={position:"absolute",right:t.onAddNew?"50px":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)","pointer-events":"none"};return(()=>{var ue=qE(),L=ue.firstChild,A=L.firstChild,U=A.firstChild;return d(L,M),A.style.setProperty("position","relative"),A.style.setProperty("flex","1"),U.addEventListener("blur",S),U.$$keydown=g,U.$$click=B,U.$$input=V,i(A,b(Ae,{get when(){return u()},get children(){var te=UE();return te.firstChild,i(te,()=>e("common.searching","Searching..."),null),X(ae=>d(te,ne,ae)),te}}),null),i(L,(()=>{var te=ge(()=>!!t.onAddNew);return()=>te()&&(()=>{var ae=GE();return ae.addEventListener("mouseleave",re=>{re.currentTarget.style.background="var(--surface-color)",re.currentTarget.style.color="var(--primary-color)"}),ae.addEventListener("mouseenter",re=>{re.currentTarget.style.background="var(--primary-color)",re.currentTarget.style.color="white"}),Vn(ae,"click",t.onAddNew,!0),d(ae,G),X(()=>ct(ae,"title",e("inventory.addProduct","Add new product"))),ae})()})(),null),i(ue,b(Ae,{get when(){return r()},get children(){var te=ha();return i(te,b(Ae,{get when(){return m()},get children(){var ae=zE(),re=ae.firstChild,ce=re.nextSibling;return d(ae,H),i(ae,m,ce),ce.style.setProperty("margin-top","0.5rem"),ce.style.setProperty("font-size","0.75rem"),i(ce,()=>e("inventory.searchFallback","Showing local results")),ae}}),null),i(te,b(Ae,{get when(){return u()},get children(){var ae=jE(),re=ae.firstChild,ce=re.nextSibling;return d(ae,ee),i(ce,()=>e("common.searching","Searching products...")),ae}}),null),i(te,b(Ae,{get when(){return ge(()=>!u())()&&j().length>0},get fallback(){return ge(()=>!u())()&&(()=>{var ae=ha();return d(ae,F),i(ae,(()=>{var re=ge(()=>!!o());return()=>re()?(()=>{var ce=HE(),Q=ce.firstChild,me=Q.nextSibling;return i(Q,()=>e("inventory.noProductsFound","No products found matching your search.")),me.style.setProperty("margin-top","0.5rem"),me.style.setProperty("font-size","0.75rem"),i(me,()=>e("inventory.tryDifferentTerm","Try a different search term or check spelling.")),ce})():e("inventory.noProductsAvailable","No products available.")})()),ae})()},get children(){return[b(ut,{get each(){return j()},children:(ae,re)=>{const ce=w(ae.id),Q=ce<=ae.minStockLevel;return(()=>{var me=WE(),K=me.firstChild,he=K.firstChild,ve=he.firstChild,W=ve.nextSibling,ie=W.firstChild,Pe=ie.firstChild,_e=ie.nextSibling,fe=_e.nextSibling,be=fe.nextSibling,pe=be.nextSibling,we=he.nextSibling,De=we.firstChild,ke=De.firstChild,Te=De.nextSibling,Ue=Te.nextSibling,Xe=Ue.firstChild;return me.addEventListener("mouseenter",()=>l(re())),me.$$click=()=>f(ae),d(K,O),d(he,N),d(ve,q),i(ve,()=>ae.name,null),i(ve,(()=>{var ze=ge(()=>!!o());return()=>ze()&&(()=>{var $e=YE();return $e.style.setProperty("margin-left","0.5rem"),$e.style.setProperty("font-size","0.75rem"),$e.style.setProperty("color","var(--primary-color)"),$e.style.setProperty("font-weight","normal"),i($e,()=>_().includes(ae)?" API":" Local"),$e})()})(),null),d(W,D),i(ie,()=>e("inventory.sku","SKU"),Pe),i(ie,()=>ae.sku,null),i(fe,()=>ae.category),i(pe,()=>$(ae.unitCost)),i(he,(()=>{var ze=ge(()=>!!ae.description);return()=>ze()&&(()=>{var $e=ha();return $e.style.setProperty("font-size","0.75rem"),$e.style.setProperty("color","var(--text-muted)"),$e.style.setProperty("margin-top","0.25rem"),$e.style.setProperty("font-style","italic"),i($e,(()=>{var Ge=ge(()=>ae.description.length>60);return()=>Ge()?`${ae.description.substring(0,60)}...`:ae.description})()),$e})()})(),null),d(we,C),De.style.setProperty("font-weight","600"),(Q?"#f44336":"var(--text-primary)")!=null?De.style.setProperty("color",Q?"#f44336":"var(--text-primary)"):De.style.removeProperty("color"),i(De,ce,ke),i(De,()=>ae.unitOfMeasure,null),Te.style.setProperty("color","var(--text-muted)"),i(Te,()=>Q?(()=>{var ze=KE();return ze.firstChild,ze.style.setProperty("color","#f44336"),i(ze,()=>e("inventory.lowStock","Low Stock"),null),ze})():e("inventory.inStock","In Stock")),Ue.style.setProperty("font-size","0.75rem"),Ue.style.setProperty("color","var(--text-muted)"),Ue.style.setProperty("margin-top","0.25rem"),i(Ue,()=>e("inventory.min","Min"),Xe),i(Ue,()=>ae.minStockLevel,null),X(ze=>d(me,J(re()===a()),ze)),me})()}}),ge(()=>ge(()=>j().length===R)()&&(()=>{var ae=ha();return ae.style.setProperty("padding","0.5rem"),ae.style.setProperty("text-align","center"),ae.style.setProperty("font-size","0.75rem"),ae.style.setProperty("color","var(--text-muted)"),ae.style.setProperty("border-top","1px solid var(--border-color)"),ae.style.setProperty("font-style","italic"),i(ae,()=>e("inventory.showingTopResults","Showing top {{count}} results",{count:R})),ae})())]}}),null),X(ae=>d(te,de,ae)),te}}),null),X(te=>{var ae=I,re=le,ce=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),Q=t.disabled,me=t.required;return te.e=d(ue,ae,te.e),te.t=d(U,re,te.t),ce!==te.a&&ct(U,"placeholder",te.a=ce),Q!==te.o&&(U.disabled=te.o=Q),me!==te.i&&(U.required=te.i=me),te},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),X(()=>U.value=oe()),ue})()};wt(["input","click","keydown"]);var JE=z("<label>"),dc=z("<div>"),XE=z("<div><span></span><span>"),ZE=z("<div><input type=text autocomplete=off>"),eT=z("<span> "),tT=z("<span> "),rT=z("<span> "),nT=z("<div><div><div><div> </div><div>");const oT=t=>{const{t:e}=ft(),[r,n]=ye(!1),[o,s]=ye(""),[a,l]=ye(-1),[u,h]=ye(!1),[m,v]=ye([]),[_,x]=ye(null),T=async N=>{if(!N.trim()||N.trim().length<6){v([]);return}try{h(!0);const q=await Jr.getConsigee(N);console.log(q);const D=Object.values(q).map(C=>({id:C.consigneeId,firstName:C.firstName+(C.middleName?" "+C.middleName:""),fullName:C.firstName+(C.middleName?" "+C.middleName:"")+" "+C.lastName+" "+C.lastName2,lastName:C.lastName+" "+C.lastName2,cid:C.cid,phoneNumber:C.phoneNumber,ybbetwen1:C.ybbetwen1,ybcity:C.ybcity,ybestate:C.ybestate,ybreparto:C.ybreparto,ybstreet:C.ybstreet,ybstreetNo:C.ybstreetNo,address:`Calle ${C.ybstreet}${C.ybstreetNo?" # "+C.ybstreetNo:""}${C.ybbetwen1?" / "+C.ybbetwen1:""}${C.ybbetwen2?" y "+C.ybbetwen2:""}${C.ybreparto?", Rpto "+C.ybreparto:""}, ${C.ybcity?C.ybcity:""}, ${C.ybestate?C.ybestate:""}`}));v(D)}catch(q){console.warn("API search failed, falling back to local search:",q)}finally{h(!1)}},E=()=>{n(!0),s(""),l(-1),o()||T("")},P=N=>{const D=N.target.value;s(D),n(!0),l(-1),_()&&clearTimeout(_());const C=setTimeout(()=>{T(D)},600);x(C)},R=N=>{t.onChange(N),n(!1),s(""),l(-1),_()&&(clearTimeout(_()),x(null))},Y=N=>{const q=m();switch(N.key){case"ArrowDown":N.preventDefault(),l(D=>Math.min(D+1,q.length-1));break;case"ArrowUp":N.preventDefault(),l(D=>Math.max(D-1,-1));break;case"Enter":N.preventDefault(),a()>=0&&q[a()]&&R(q[a()]);break;case"Escape":n(!1),s(""),l(-1),_()&&(clearTimeout(_()),x(null));break}},Z=N=>{setTimeout(()=>{n(!1),s(""),l(-1),_()&&(clearTimeout(_()),x(null))},150)},j=()=>r()&&o()?o():t.value?t.value.cid:"";$r(()=>(T(""),()=>{_()&&clearTimeout(_())}));const B={position:"relative",width:"100%",...t.style},V={display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.25rem"},f={"font-size":"0.75rem",color:"var(--text-muted)","margin-bottom":"0.5rem","font-style":"italic"},g={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},S={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},$=N=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:N?"var(--strip-color)":"transparent",color:N?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),w={display:"flex","justify-content":"space-between","align-items":"flex-start"},I={flex:"1"},y={"font-weight":"500","margin-bottom":"0.25rem"},de={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex","flex-direction":"column",gap:"0.125rem"},J={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},O={padding:"1rem","text-align":"center",color:"var(--text-muted)",display:"flex","align-items":"center","justify-content":"center",gap:"0.5rem"};return(()=>{var N=ZE(),q=N.firstChild;return i(N,b(Ae,{get when(){return t.label},get children(){var D=JE();return d(D,V),i(D,()=>t.label),D}}),q),i(N,b(Ae,{get when(){return t.description},get children(){var D=dc();return d(D,f),i(D,()=>t.description),D}}),q),q.addEventListener("blur",Z),q.$$keydown=Y,q.$$click=E,q.$$input=P,i(N,b(Ae,{get when(){return r()},get children(){var D=dc();return i(D,b(Ae,{get when(){return u()},get children(){var C=XE(),F=C.firstChild,ee=F.nextSibling;return d(C,O),i(ee,()=>e("common.searching","Buscando clientes...")),C}}),null),i(D,b(Ae,{get when(){return ge(()=>!u())()&&m().length>0},get fallback(){return ge(()=>!u())()&&(()=>{var C=dc();return d(C,J),i(C,(()=>{var F=ge(()=>!!o());return()=>F()?e("customer.noCustomersFound","No se encontraron clientes. Puede crear un nuevo cliente llenando el formulario."):e("customer.noCustomersAvailable","No se encontraron clientes previos. Se crear un nuevo cliente.")})()),C})()},get children(){return b(ut,{get each(){return m()},children:(C,F)=>(()=>{var ee=nT(),H=ee.firstChild,oe=H.firstChild,M=oe.firstChild;M.firstChild;var G=M.nextSibling;return ee.addEventListener("mouseenter",()=>l(F())),ee.$$click=()=>R(C),d(H,w),d(oe,I),d(M,y),i(M,()=>C.fullName,null),d(G,de),i(G,b(Ae,{get when(){return C.phoneNumber},get children(){var le=eT();return le.firstChild,i(le,()=>C.phoneNumber,null),le}}),null),i(G,b(Ae,{get when(){return C.cid},get children(){var le=tT();return le.firstChild,i(le,()=>C.cid,null),le}}),null),i(G,b(Ae,{get when(){return C.email},get children(){var le=rT();return le.firstChild,i(le,()=>C.email,null),le}}),null),X(le=>d(ee,$(F()===a()),le)),ee})()})}}),null),X(C=>d(D,S,C)),D}}),null),X(D=>{var C=B,F=g,ee=t.placeholder||e("customer.searchPlaceholder","Buscar clientes por nombre, telfono, ID..."),H=t.disabled,oe=t.required;return D.e=d(N,C,D.e),D.t=d(q,F,D.t),ee!==D.a&&ct(q,"placeholder",D.a=ee),H!==D.o&&(q.disabled=D.o=H),oe!==D.i&&(q.required=D.i=oe),D},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),X(()=>q.value=j()),N})()};wt(["input","click","keydown"]);var iT=z("<label>"),uc=z("<div>"),sT=z("<div><span></span><span>"),aT=z("<div><input type=text autocomplete=off>"),lT=z("<span> "),cT=z("<div><div><div><div> </div><div>");const dT=t=>{const{t:e}=ft(),[r,n]=ye(!1),[o,s]=ye(""),[a,l]=ye(-1),[u,h]=ye(!1),[m,v]=ye([]),[_,x]=ye(null),T=600,E=async q=>{if(!q.trim()||q.trim().length<6){v([]);return}try{h(!0);const D=await Jr.getShipper(q),C=Object.values(D).map(F=>({id:F.shipperId,name:F.name,dob:F.dob,phoneNumberS:F.phoneNumber}));v(C)}catch(D){console.warn("API search failed, falling back to local search:",D)}finally{h(!1)}},P=q=>{const C=q.target.value;s(C),n(!0),l(-1),_()&&clearTimeout(_());const F=setTimeout(()=>{E(C)},T);x(F)},R=()=>{n(!0),s(""),l(-1),o()||E("")},Y=q=>{t.onChange(q),n(!1),s(""),l(-1),_()&&(clearTimeout(_()),x(null))},Z=q=>{const D=m();switch(q.key){case"ArrowDown":q.preventDefault(),l(C=>Math.min(C+1,D.length-1));break;case"ArrowUp":q.preventDefault(),l(C=>Math.max(C-1,-1));break;case"Enter":q.preventDefault(),a()>=0&&D[a()]&&Y(D[a()]);break;case"Escape":n(!1),s(""),l(-1),_()&&(clearTimeout(_()),x(null));break}},j=q=>{setTimeout(()=>{n(!1),s(""),l(-1),_()&&(clearTimeout(_()),x(null))},150)},B=()=>r()&&o()?o():t.value?t.value.name:"";$r(()=>(E(""),()=>{_()&&clearTimeout(_())}));const V={position:"relative",width:"100%",...t.style},f={display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.25rem"},g={"font-size":"0.75rem",color:"var(--text-muted)","margin-bottom":"0.5rem","font-style":"italic"},S={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},$={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},w=q=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:q?"var(--strip-color)":"transparent",color:q?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),I={display:"flex","justify-content":"space-between","align-items":"flex-start"},y={flex:"1"},de={"font-weight":"500","margin-bottom":"0.25rem"},J={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex","flex-direction":"column",gap:"0.125rem"},O={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},N={padding:"1rem","text-align":"center",color:"var(--text-muted)",display:"flex","align-items":"center","justify-content":"center",gap:"0.5rem"};return(()=>{var q=aT(),D=q.firstChild;return i(q,b(Ae,{get when(){return t.label},get children(){var C=iT();return d(C,f),i(C,()=>t.label),C}}),D),i(q,b(Ae,{get when(){return t.description},get children(){var C=uc();return d(C,g),i(C,()=>t.description),C}}),D),D.addEventListener("blur",j),D.$$keydown=Z,D.$$click=R,D.$$input=P,i(q,b(Ae,{get when(){return r()},get children(){var C=uc();return i(C,b(Ae,{get when(){return u()},get children(){var F=sT(),ee=F.firstChild,H=ee.nextSibling;return d(F,N),i(H,()=>e("common.searching","Buscando clientes...")),F}}),null),i(C,b(Ae,{get when(){return ge(()=>!u())()&&m().length>0},get fallback(){return ge(()=>!u())()&&(()=>{var F=uc();return d(F,O),i(F,(()=>{var ee=ge(()=>!!o());return()=>ee()?e("customer.noShippersFound","No se encontraron clientes. Puede crear un nuevo cliente llenando el formulario."):e("customer.noShippersAvailable","No se encontraron clientes previos. Se crear un nuevo cliente.")})()),F})()},get children(){return b(ut,{get each(){return m()},children:(F,ee)=>(()=>{var H=cT(),oe=H.firstChild,M=oe.firstChild,G=M.firstChild;G.firstChild;var le=G.nextSibling;return H.addEventListener("mouseenter",()=>l(ee())),H.$$click=()=>Y(F),d(oe,I),d(M,y),d(G,de),i(G,()=>F.name,null),d(le,J),i(le,b(Ae,{get when(){return F.phoneNumberS},get children(){var ne=lT();return ne.firstChild,i(ne,()=>F.phoneNumberS,null),ne}})),X(ne=>d(H,w(ee()===a()),ne)),H})()})}}),null),X(F=>d(C,$,F)),C}}),null),X(C=>{var F=V,ee=S,H=t.placeholder||e("customer.searchPlaceholder","Buscar clientes por nombre, telfono, ID..."),oe=t.disabled,M=t.required;return C.e=d(q,F,C.e),C.t=d(D,ee,C.t),H!==C.a&&ct(D,"placeholder",C.a=H),oe!==C.o&&(D.disabled=C.o=oe),M!==C.i&&(D.required=C.i=M),C},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),X(()=>D.value=B()),q})()};wt(["input","click","keydown"]);var uT=z("<div> "),Xa=z("<div>"),hT=z('<div><h3> Informacin del Cliente</h3><div></div><div><div><label>Nombre del Cliente/Empresa *</label><input type=text placeholder="ej., Juan Prez o Empresa ABC"required></div><div><label>Nmero de Telfono Principal</label><input type=tel placeholder="ej., +53-5-123-4567">'),mT=z('<div><h3> Informacin del Destinatario</h3><div></div><div><label>Primer Nombre</label><input type=text placeholder="ej., Juan"></div><div><label>Apellido</label><input type=text placeholder="ej., Prez"></div><div><label>Nmero de Identificacin</label><input type=text placeholder="ej., 12345678901 o A1234567"></div><div><label>Nmero de Pasaporte</label><input type=text placeholder="ej., AB1234567"></div><div><label>Nmero de Telfono Principal</label><input type=tel placeholder="ej., +53-5-123-4567"></div><div><label>Direccin de Entrega/Facturacin</label><textarea placeholder="ej., Calle 23 #456, Apto 4B, Vedado, La Habana, 10400">'),Qm=z("<div><strong>Subtotal: $"),yT=z("<div><div><span> Reservas y Servicios</span><button> Agregar Servicio/Reserva"),pT=z("<div><div><span> Productos y Artculos</span></div><div><label>Agregar Productos a la Factura"),fT=z("<span> Sin impuesto"),gT=z("<div><div>Vista previa del clculo:</div><div>Subtotal: $</div><div> Del Subtotal: $<!>(Total: $<!>)</div><div> Del Total: $<!>(Total: $<!>)"),vT=z("<div><div> Beneficio por Pago en Efectivo:</div><div>Efectivo: $<!> (<!>% del pago)</div><div>Ahorro en impuestos: $</div><div>Impuesto original: $<!>  Impuesto final: $"),bT=z("<div><label><input type=checkbox><span> Exencin de Impuesto por Pago en Efectivo</span></label><div>Los pagos en efectivo estarn exentos de impuestos. Mientras mayor sea el porcentaje pagado en efectivo, mayor ser la exencin."),_T=z('<div><div><span> Mtodos de Pago</span></div><div>Distribuya el pago total entre los diferentes mtodos de pago disponibles.</div><div><button type=button> Todo Efectivo</button><button type=button title="Pagar todo por Zelle"> Todo Zelle</button><button type=button title="Pagar todo con tarjeta"> Todo Tarjeta</button><button type=button title="Limpiar todos los pagos"> Limpiar</button></div><div><div><label> Efectivo</label><input type=text placeholder=0.00 min=0 step=0.01></div><div><label> Zelle</label><input type=text placeholder=0.00 min=0 step=0.01></div></div><div><label> Tarjeta de Crdito</label><input type=text placeholder=0.00 min=0 step=0.01></div><div><div><div>Total de Pagos: <strong>$</strong></div><div>Balance: <strong>$</strong></div></div><div><div>Total a Pagar: <strong>$</strong></div><div></div></div></div><div><label>Impuesto (%)</label><div>Porcentaje de impuesto. Puede aplicarse sobre el subtotal o como porcentaje del total final.</div><input type=number placeholder=0 min=0 max=99 step=0.01><div><div><label><input type=radio name=taxMethod><span>Del Subtotal (tradicional)</span></label><div>Impuesto = Subtotal  <!>%</div><label><input type=radio name=taxMethod><span>Del Total Final</span></label><div>El impuesto representa el <!>% del total final'),ST=z("<span>(Ahorro: $<!>)"),PT=z("<div>Impuesto (<!>% <!>): $"),wT=z("<div>Envo: "),CT=z("<div><div>Productos: $</div><div>Reservas: $</div><div>Subtotal: $</div><div>Total: $"),xT=z("<button>"),$T=z("<div><button></button><button> Nueva Factura"),AT=z('<div><h2> Crear Nueva Factura</h2><div><div><div><h3> Informacin de Factura</h3><div><div><label>Nmero de Factura *</label><input type=text></div><div><label>Ubicacin de Tienda *</label></div></div><div><div><label>Mtodo de Envo</label><div>Seleccione el mtodo de transporte para esta orden.</div><select><option value>Seleccionar mtodo...</option><option value=aereo> Areo (Avin)</option><option value=maritimo> Martimo (Barco)</option></select></div><div><label>fecha</label><div>Seleccione una fecha si es diferente al dia de hoy.</div><input type=date></div></div><div><label>Descripcin de Factura</label><textarea placeholder="ej., Venta regular, pedido mayorista, descuento especial aplicado..."></textarea></div><label><input type=checkbox><div><span>Orden de Paquete/Envo</span><div>Marque esto si esta factura incluye servicios de envo o manejo de paquetes.</div></div></label></div></div><div>'),Jm=z("<span> ($<!>)"),IT=z("<div>(<!><!>+<!>)"),ET=z("<div><div><button></button></div><div><div><label>Cant (lbs)</label></div><div><label>Precio</label></div><div><label>Arancel</label></div><div>$"),TT=z("<div><div><div><div></div><div></div></div><button></button></div><div><div>$"),kT=z("<input step=0.01>"),RT=z("<div><div><input type=text autocomplete=off><div>");const Xm=[" Ropa"," Zapatos"," Ventilador"," tiles del Hogar"," TV"," Telfono Mvil"," Computadora/Laptop"," Audfonos"," Reloj"," Joyera"," Productos de Belleza"," Medicamentos"," Alimentos"," Juguetes"," Libros"," Videojuegos"," Herramientas"," Repuestos de Auto"," Artculos Deportivos"," Instrumentos Musicales"," Electrnicos"," Maletas"," Lentes"," Cables y Accesorios"," Equipos Mdicos"," Materiales de Arte"," Cmaras"," Bateras"," Productos de Limpieza"," Artculos para el Hogar"],DT={padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--background-color)"},Re={container:{padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)"},header:{"font-size":"1.5rem","font-weight":"700",color:"var(--text-primary)","margin-bottom":"1.5rem"},grid:{display:"grid","grid-template-columns":"repeat(auto-fit, minmax(350px, 1fr))",gap:"1.5rem"},section:{background:"var(--background-color)",padding:"1.25rem","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},sectionTitle:{"font-size":"1.125rem","font-weight":"600",color:"var(--text-primary)","margin-bottom":"1rem",display:"flex","align-items":"center",gap:"0.5rem"},formGroup:{"margin-bottom":"1rem"},label:{display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.25rem"},fieldDescription:{"font-size":"0.75rem",color:"var(--text-muted)","margin-bottom":"0.5rem","line-height":"1.4","font-style":"italic"},input:{width:"100%",padding:"0.625rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",background:"var(--surface-color)",transition:"border-color 0.2s",outline:"none"},textarea:{width:"100%",padding:"0.625rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",background:"var(--surface-color)",resize:"vertical","min-height":"60px"},button:{padding:"0.625rem 1.25rem",border:"none","border-radius":"var(--border-radius-sm)","font-size":"0.875rem","font-weight":"500",cursor:"pointer",transition:"all 0.2s",display:"inline-flex","align-items":"center",gap:"0.5rem"},primaryButton:{background:"var(--primary-color)",color:"white"},secondaryButton:{background:"var(--secondary-color)",color:"white"},successButton:{background:"#4CAF50",color:"white"},alert:{padding:"0.75rem 1rem","border-radius":"var(--border-radius-sm)","margin-bottom":"1rem","font-size":"0.875rem",display:"flex","align-items":"center",gap:"0.5rem"},errorAlert:{background:"#ffebee",border:"1px solid #ffcdd2",color:"#d32f2f"},successAlert:{background:"#e8f5e9",border:"1px solid #c8e6c9",color:"#2e7d32"},productWrapItem:{padding:"0.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"0.5rem"},productItem:{display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem","margin-bottom":"0.5rem"},smallInput:{width:"70px",padding:"0.375rem 0.5rem","font-size":"0.8125rem"},removeButton:{background:"none",border:"none",color:"#f44336",cursor:"pointer","font-size":"1.25rem",padding:"0.25rem"},totalSection:{background:"var(--primary-color)",color:"white",padding:"1rem","border-radius":"var(--border-radius-sm)","text-align":"right"},gridTwo:{display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"}},NT=()=>{const{t}=ft(),[e,r]=ye({invoice:"",description:"",store:"",shipper_consignee:{name:"",firstName:"",middleName:"",lastName:"",lastName2:"",phoneNumber:"",cid:"",passport:"",address:""},products:[],reservas:[],packagesOrder:!1,shippingMethod:"",paymentMethods:{taxOnTotal:!1,taxPercent:0,exemptTaxOnCash:!1,cash:0,zelle:0,creditCard:0}}),[n,o]=ye(null),[s,a]=ye(""),[l,u]=ye(""),[h,m]=ye(null),[v,_]=ye(!1),[x,T]=ye(""),[E,P]=ye(""),[R,Y]=ye(""),[Z,j]=ye(!1),B=L=>{if(!L)return"";const A=Le.getLocationById(L),U=A?.code||A?.name?.substring(0,3).toUpperCase()||"INV",ae=new Date().toISOString().slice(0,10).replace(/-/g,"");return`${xv(6)}-${U}-${ae}`};fn(()=>{const L=s();if(L&&!e().invoice.trim()){const A=B(L);u(A),r(U=>({...U,invoice:A}))}}),fn(()=>{const L=n();L&&r(A=>({...A,shipper_consignee:{...A.shipper_consignee,name:L.name,firstName:L.firstName||"",lastName:L.lastName||"",phoneNumber:L.phoneNumber||"",phoneNumberS:L.phoneNumberS||"",cid:L.cid||"",dob:L.dob||"",passport:L.passport||"",address:L.address||""}}))}),fn(()=>{});const V=L=>{const A=Le.getProductById(L);if(!A)return;const U={id:Date.now().toString(),product:{id:A.id,code:A.sku||"",label:A.name||"",price:A.unitCost||0},qty:1,salePrice:A.unitCost||0,total:A.unitCost||0};r(te=>({...te,products:[...te.products,U]}))},f=L=>{a(L);const A=Le.getLocationById(L);r(U=>({...U,store:A?.name||L}))},g=L=>{o(A=>({...A,...L}))},S=L=>{m({name:L?.name}),o(A=>({...A,phoneNumberS:L?.phoneNumberS,name:L?.name,dob:L?.dob}))},$=(L,A,U)=>{r(te=>({...te,products:te.products.map(ae=>{if(ae.id===L){const re={...ae,[A]:U};return re.total=re.qty*re.salePrice,re}return ae})}))},w=L=>{r(A=>({...A,products:A.products.filter(U=>U.id!==L)}))},I=()=>{const L={id:Date.now().toString(),type:"",qty:1,price:0,arancel:0,total:0};r(A=>({...A,reservas:[...A.reservas,L]}))},y=(L,A,U)=>{r(te=>({...te,reservas:te.reservas.map(ae=>{if(ae.id===L){const re={...ae,[A]:U};return(A==="qty"||A==="price"||A==="arancel")&&(re.total=Number(re.qty)*Number(re.price)+Number(re.arancel)),re}return ae})}))},de=L=>{r(A=>({...A,reservas:A.reservas.filter(U=>U.id!==L)}))},J=()=>e().products.reduce((L,A)=>L+A.total,0),O=()=>e().reservas.reduce((L,A)=>L+A.total,0),N=()=>J()+O(),q=()=>{if(e()?.paymentMethods.taxPercent===0)return 0;if(e()?.paymentMethods.exemptTaxOnCash){const L=F()>0?e().paymentMethods.cash/F():0,A=Math.min(L,1);let U;return e()?.paymentMethods.taxOnTotal?U=N()/(1-e()?.paymentMethods.taxPercent/100)-N():U=N()*(e()?.paymentMethods.taxPercent/100),U*(1-A)}return e()?.paymentMethods.taxOnTotal?N()/(1-e()?.paymentMethods?.taxPercent/100)-N():N()*(e()?.paymentMethods?.taxPercent/100)},D=()=>{if(!e()?.paymentMethods.exemptTaxOnCash||e()?.paymentMethods.taxPercent===0)return 0;const L=F()>0?e().paymentMethods.cash/F():0,A=Math.min(L,1);let U;return e()?.paymentMethods.taxOnTotal?U=N()/(1-e()?.paymentMethods?.taxPercent/100)-N():U=N()*(e()?.paymentMethods?.taxPercent/100),U*A},C=()=>N()+q(),F=()=>{const L=e().paymentMethods;return L.cash+L.zelle+L.creditCard},ee=()=>C()-F(),H=(L,A)=>{r(U=>({...U,paymentMethods:{...U.paymentMethods,[L]:A}}))},oe=(L,A)=>{r(U=>({...U,paymentMethods:{...U.paymentMethods,[L]:A}}))},M=L=>{const A=C();let te={...e().paymentMethods,cash:L==="cash"?A:0,zelle:L==="zelle"?A:0,creditCard:L==="creditCard"?A:0};r(ae=>({...ae,paymentMethods:te}))},G=()=>{let A={...e().paymentMethods,cash:0,zelle:0,creditCard:0};r(U=>({...U,paymentMethods:A}))},le=async()=>{_(!0),T(""),P("");try{if(!e().invoice.trim())throw new Error("Nmero de factura es requerido");if(!e().shipper_consignee.name.trim())throw new Error("Nombre del cliente es requerido");if(e().products.length===0&&e().reservas.length===0)throw new Error("Al menos un producto o reserva es requerido");if(Math.round(ee())>.01)throw new Error(`El total de pagos (${F().toFixed()}) no coincide con el total de la factura (${C().toFixed()})`);const L={...e(),type:"SALES",ssg_inventory_key:`INVOICE-${Date.now()}`,ssg_sorder_key:`SO-${Date.now()}`,createDate:e().createDate||Date.now(),businessId:"YB100423253156428",isCompleted:!0,productSubtotal:J(),reservaSubtotal:O(),subtotalBeforeTax:N(),taxAmount:q(),taxSavings:D(),total:C(),shippingMethod:e().shippingMethod,taxCalculationMethod:e()?.paymentMethods.taxOnTotal?"total":"subtotal",cashPaymentRatio:F()>0?e().paymentMethods.cash/F():0,paymentMethods:e().paymentMethods};console.log("createInvoice",JSON.stringify(L,null,4));const A=await Jr.addInventory(L);Jr.addInvoice(A),Y(A.data),P(" Invoice created successfully! You can now generate a PDF.")}catch(L){T(L.message||"Error creating invoice")}finally{_(!1)}},ne=async()=>{if(R()){j(!0),T("");try{const{generateEnhancedInvoicePDF:L}=await Sn(async()=>{const{generateEnhancedInvoicePDF:ae}=await import("./enhancedInvoicePdfGenerator-BhxIBI5e.js");return{generateEnhancedInvoicePDF:ae}},__vite__mapDeps([0,1]));console.log(JSON.stringify(e()));const U={invoiceId:R(),shippingMethod:e().shippingMethod,taxPercent:e()?.paymentMethods.taxPercent,taxOnTotal:e()?.paymentMethods.taxOnTotal,exemptTaxOnCash:e()?.paymentMethods.exemptTaxOnCash,paymentMethods:e().paymentMethods,productSubtotal:J(),reservaSubtotal:O(),subtotalBeforeTax:N(),taxAmount:q(),taxSavings:e()?.paymentMethods.exemptTaxOnCash?N()*e()?.paymentMethods.taxPercent/100-q():0,total:C(),cashPaymentRatio:F()>0?e().paymentMethods.cash/F():0};console.log(JSON.stringify(U));const te=await L({...e(),...U},"es","modern");P(` PDF generated successfully: ${te}`)}catch(L){T(L.message||"Error generating PDF")}finally{j(!1)}}},ue=()=>{r({invoice:"",description:"",store:"",shipper_consignee:{name:"",firstName:"",middleName:"",lastName:"",lastName2:"",phoneNumber:"",phoneNumberS:"",cid:"",passport:"",address:""},products:[],reservas:[],packagesOrder:!1,shippingMethod:"",paymentMethods:{cash:0,zelle:0,creditCard:0,taxPercent:0,taxOnTotal:!1,exemptTaxOnCash:!1}}),Y(""),P(""),T("")};return $r(()=>{}),(()=>{var L=AT(),A=L.firstChild,U=A.nextSibling,te=U.firstChild,ae=te.firstChild,re=ae.firstChild,ce=re.nextSibling,Q=ce.firstChild,me=Q.firstChild,K=me.nextSibling,he=Q.nextSibling,ve=he.firstChild,W=ce.nextSibling,ie=W.firstChild,Pe=ie.firstChild,_e=Pe.nextSibling,fe=_e.nextSibling,be=ie.nextSibling,pe=be.firstChild,we=pe.nextSibling,De=we.nextSibling,ke=W.nextSibling,Te=ke.firstChild,Ue=Te.nextSibling,Xe=ke.nextSibling,ze=Xe.firstChild,$e=ze.nextSibling,Ge=$e.firstChild,ot=Ge.nextSibling,je=te.nextSibling;return i(L,b(Ae,{get when(){return x()},get children(){var Ce=uT();return Ce.firstChild,i(Ce,x,null),X(Se=>d(Ce,{...Re.alert,...Re.errorAlert},Se)),Ce}}),U),i(L,b(Ae,{get when(){return E()},get children(){var Ce=Xa();return i(Ce,E),X(Se=>d(Ce,{...Re.alert,...Re.successAlert},Se)),Ce}}),U),K.$$input=Ce=>r(Se=>({...Se,invoice:Ce.target.value})),i(he,b(ws,{get value(){return s()},onChange:f,get placeholder(){return t("inventory.selectStoreLocation","Buscar y seleccionar ubicacin de tienda...")},filterType:"store",required:!0}),null),fe.addEventListener("change",Ce=>r(Se=>({...Se,shippingMethod:Ce.currentTarget.value}))),De.addEventListener("change",Ce=>r(Se=>({...Se,createDate:Ce.currentTarget.value}))),d(De,DT),Ue.$$input=Ce=>r(Se=>({...Se,description:Ce.target.value})),ze.addEventListener("change",Ce=>r(Se=>({...Se,packagesOrder:Ce.target.checked}))),i(te,b(Ae,{get when(){return ge(()=>!!(e().shippingMethod&&e().invoice))()&&s()},get children(){return[(()=>{var Ce=hT(),Se=Ce.firstChild,Ke=Se.nextSibling,He=Ke.nextSibling,Oe=He.firstChild,Ye=Oe.firstChild,pt=Ye.nextSibling,vt=Oe.nextSibling,mt=vt.firstChild,yt=mt.nextSibling;return i(Ke,b(dT,{get value(){return h()},onChange:S,label:"Buscar Cliente Existente",description:"Busque clientes existentes por nombre, telfono o ID. Si no se encuentra, complete el formulario a continuacin para crear un nuevo cliente.",placeholder:"Escriba nombre del cliente, nmero de telfono o ID para buscar..."})),pt.$$input=Qe=>r(Ct=>({...Ct,shipper_consignee:{...Ct.shipper_consignee,name:Qe.target.value}})),yt.$$input=Qe=>r(Ct=>({...Ct,shipper_consignee:{...Ct.shipper_consignee,phoneNumberS:Qe.target.value}})),X(Qe=>{var Ct={...Re.section,"margin-top":"1rem"},_t=Re.sectionTitle,jt=Re.formGroup,Mt=Re.gridTwo,Be=Re.formGroup,We=Re.label,at=Re.input,lt=Re.formGroup,Tt=Re.label,Ie=Re.input;return Qe.e=d(Ce,Ct,Qe.e),Qe.t=d(Se,_t,Qe.t),Qe.a=d(Ke,jt,Qe.a),Qe.o=d(He,Mt,Qe.o),Qe.i=d(Oe,Be,Qe.i),Qe.n=d(Ye,We,Qe.n),Qe.s=d(pt,at,Qe.s),Qe.h=d(vt,lt,Qe.h),Qe.r=d(mt,Tt,Qe.r),Qe.d=d(yt,Ie,Qe.d),Qe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),X(()=>pt.value=e().shipper_consignee.name),X(()=>yt.value=e().shipper_consignee.phoneNumberS),Ce})(),(()=>{var Ce=mT(),Se=Ce.firstChild,Ke=Se.nextSibling,He=Ke.nextSibling,Oe=He.firstChild,Ye=Oe.nextSibling,pt=He.nextSibling,vt=pt.firstChild,mt=vt.nextSibling,yt=pt.nextSibling,Qe=yt.firstChild,Ct=Qe.nextSibling,_t=yt.nextSibling,jt=_t.firstChild,Mt=jt.nextSibling,Be=_t.nextSibling,We=Be.firstChild,at=We.nextSibling,lt=Be.nextSibling,Tt=lt.firstChild,Ie=Tt.nextSibling;return i(Ke,b(oT,{get value(){return n()},onChange:g,label:"Buscar Destinatario Existente",description:"Busque Destinatario existentes por telfono o ID. Si no se encuentra, complete el formulario a continuacin para crear un nuevo destinatario.",placeholder:"Escriba nombre del destinatario, nmero de telfono o ID para buscar..."})),Ye.$$input=Ve=>r(st=>({...st,shipper_consignee:{...st.shipper_consignee,firstName:Ve.target.value}})),mt.$$input=Ve=>r(st=>({...st,shipper_consignee:{...st.shipper_consignee,lastName:Ve.target.value}})),Ct.$$input=Ve=>r(st=>({...st,shipper_consignee:{...st.shipper_consignee,cid:Ve.target.value}})),Mt.$$input=Ve=>r(st=>({...st,shipper_consignee:{...st.shipper_consignee,passport:Ve.target.value}})),at.$$input=Ve=>r(st=>({...st,shipper_consignee:{...st.shipper_consignee,phoneNumber:Ve.target.value}})),Ie.$$input=Ve=>r(st=>({...st,shipper_consignee:{...st.shipper_consignee,address:Ve.target.value}})),X(Ve=>{var st={...Re.section,"margin-top":"1rem"},dt=Re.sectionTitle,Gt=Re.formGroup,Wt=Re.formGroup,At=Re.label,kt=Re.input,rr=Re.formGroup,Et=Re.label,er=Re.input,et=Re.formGroup,Rt=Re.label,Ot=Re.input,Vt=Re.formGroup,Ht=Re.label,nr=Re.input,cr=Re.formGroup,It=Re.label,hr=Re.input,Hr=Re.formGroup,Ir=Re.label,Cr=Re.textarea;return Ve.e=d(Ce,st,Ve.e),Ve.t=d(Se,dt,Ve.t),Ve.a=d(Ke,Gt,Ve.a),Ve.o=d(He,Wt,Ve.o),Ve.i=d(Oe,At,Ve.i),Ve.n=d(Ye,kt,Ve.n),Ve.s=d(pt,rr,Ve.s),Ve.h=d(vt,Et,Ve.h),Ve.r=d(mt,er,Ve.r),Ve.d=d(yt,et,Ve.d),Ve.l=d(Qe,Rt,Ve.l),Ve.u=d(Ct,Ot,Ve.u),Ve.c=d(_t,Vt,Ve.c),Ve.w=d(jt,Ht,Ve.w),Ve.m=d(Mt,nr,Ve.m),Ve.f=d(Be,cr,Ve.f),Ve.y=d(We,It,Ve.y),Ve.g=d(at,hr,Ve.g),Ve.p=d(lt,Hr,Ve.p),Ve.b=d(Tt,Ir,Ve.b),Ve.T=d(Ie,Cr,Ve.T),Ve},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),X(()=>Ye.value=e().shipper_consignee.firstName),X(()=>mt.value=e().shipper_consignee.lastName),X(()=>Ct.value=e().shipper_consignee.cid),X(()=>Mt.value=e().shipper_consignee.passport),X(()=>at.value=e().shipper_consignee.phoneNumber),X(()=>Ie.value=e().shipper_consignee.address),Ce})()]}}),null),i(je,b(Ae,{get when(){return ge(()=>!!(e().shippingMethod&&e().invoice&&e().shipper_consignee?.cid))()&&e().shipper_consignee?.name},get children(){return[(()=>{var Ce=yT(),Se=Ce.firstChild,Ke=Se.firstChild,He=Ke.nextSibling;return He.$$click=I,i(Ce,b(ut,{get each(){return e().reservas},children:Oe=>b(LT,{updateReserva:y,reserva:Oe,removeReserva:de})}),null),i(Ce,b(Ae,{get when(){return e().reservas.length>0},get children(){var Oe=Qm(),Ye=Oe.firstChild;return Ye.firstChild,Oe.style.setProperty("margin-top","0.75rem"),Oe.style.setProperty("padding-top","0.75rem"),Oe.style.setProperty("border-top","1px solid var(--border-color)"),Oe.style.setProperty("text-align","right"),i(Ye,()=>O().toFixed(),null),Oe}}),null),X(Oe=>{var Ye={...Re.section,"margin-top":"1rem"},pt={...Re.sectionTitle,"justify-content":"space-between"},vt={...Re.button,...Re.successButton};return Oe.e=d(Ce,Ye,Oe.e),Oe.t=d(Se,pt,Oe.t),Oe.a=d(He,vt,Oe.a),Oe},{e:void 0,t:void 0,a:void 0}),Ce})(),(()=>{var Ce=pT(),Se=Ce.firstChild,Ke=Se.nextSibling,He=Ke.firstChild;return i(Ke,b(QE,{value:"",onChange:V,get placeholder(){return t("inventory.searchProductsToAdd","Buscar productos por nombre, SKU o categora para agregar a la factura...")},searchDelay:300,maxResults:15}),null),i(Ce,b(ut,{get each(){return e().products},children:Oe=>b(MT,{product:Oe,updateProduct:$,removeProduct:w})}),null),i(Ce,b(Ae,{get when(){return e().products.length>0},get children(){var Oe=Qm(),Ye=Oe.firstChild;return Ye.firstChild,Oe.style.setProperty("margin-top","0.75rem"),Oe.style.setProperty("padding-top","0.75rem"),Oe.style.setProperty("border-top","1px solid var(--border-color)"),Oe.style.setProperty("text-align","right"),i(Ye,()=>J().toFixed(),null),Oe}}),null),X(Oe=>{var Ye={...Re.section,"margin-top":"1rem"},pt={...Re.sectionTitle,"justify-content":"space-between"},vt=Re.formGroup,mt=Re.label;return Oe.e=d(Ce,Ye,Oe.e),Oe.t=d(Se,pt,Oe.t),Oe.a=d(Ke,vt,Oe.a),Oe.o=d(He,mt,Oe.o),Oe},{e:void 0,t:void 0,a:void 0,o:void 0}),Ce})(),(()=>{var Ce=_T(),Se=Ce.firstChild,Ke=Se.nextSibling,He=Ke.nextSibling,Oe=He.firstChild;Oe.firstChild;var Ye=Oe.nextSibling,pt=Ye.nextSibling,vt=pt.nextSibling,mt=He.nextSibling,yt=mt.firstChild,Qe=yt.firstChild,Ct=Qe.nextSibling,_t=yt.nextSibling,jt=_t.firstChild,Mt=jt.nextSibling,Be=mt.nextSibling,We=Be.firstChild,at=We.nextSibling,lt=Be.nextSibling,Tt=lt.firstChild,Ie=Tt.firstChild,Ve=Ie.firstChild,st=Ve.nextSibling;st.firstChild;var dt=Ie.nextSibling,Gt=dt.firstChild,Wt=Gt.nextSibling;Wt.firstChild;var At=Tt.nextSibling,kt=At.firstChild,rr=kt.firstChild,Et=rr.nextSibling;Et.firstChild;var er=kt.nextSibling,et=lt.nextSibling,Rt=et.firstChild,Ot=Rt.nextSibling,Vt=Ot.nextSibling,Ht=Vt.nextSibling,nr=Ht.firstChild,cr=nr.firstChild,It=cr.firstChild,hr=cr.nextSibling,Hr=hr.firstChild,Ir=Hr.nextSibling;Ir.nextSibling;var Cr=hr.nextSibling,Mr=Cr.firstChild,gn=Cr.nextSibling,to=gn.firstChild,xt=to.nextSibling;return xt.nextSibling,He.style.setProperty("display","flex"),He.style.setProperty("gap","0.5rem"),He.style.setProperty("margin-bottom","1rem"),He.style.setProperty("flex-wrap","wrap"),Oe.$$click=()=>M("cash"),i(Oe,b(Ae,{get when(){return ge(()=>!!e()?.paymentMethods.exemptTaxOnCash)()&&e()?.paymentMethods.taxPercent>0},get children(){var Ne=fT();return Ne.style.setProperty("font-size","0.6rem"),Ne.style.setProperty("display","block"),Ne.style.setProperty("line-height","1"),Ne}}),null),Ye.$$click=()=>M("zelle"),pt.$$click=()=>M("creditCard"),vt.$$click=G,Ct.$$input=Ne=>H("cash",parseFloat(Ne.target.value)||0),Mt.$$input=Ne=>H("zelle",parseFloat(Ne.target.value)||0),at.$$input=Ne=>H("creditCard",parseFloat(Ne.target.value)||0),lt.style.setProperty("margin-top","1rem"),lt.style.setProperty("padding-top","1rem"),lt.style.setProperty("border-top","1px solid var(--border-color)"),lt.style.setProperty("display","grid"),lt.style.setProperty("grid-template-columns","1fr 1fr"),lt.style.setProperty("gap","1rem"),lt.style.setProperty("font-size","0.875rem"),i(st,()=>F().toFixed(),null),i(Wt,()=>ee().toFixed(),null),At.style.setProperty("text-align","right"),i(Et,()=>C().toFixed(),null),er.style.setProperty("font-weight","500"),i(er,(()=>{var Ne=ge(()=>Math.round(ee())===0);return()=>Ne()?" Pagado Completo":ee()>0?"Falta Pagar":"Sobrepago"})()),i(et,b(Ae,{get when(){return ge(()=>e()?.paymentMethods.taxPercent>0)()&&N()>0},get children(){var Ne=gT(),Dt=Ne.firstChild,ar=Dt.nextSibling;ar.firstChild;var Yt=ar.nextSibling,bt=Yt.firstChild,dr=bt.nextSibling,yr=dr.nextSibling,Wr=yr.nextSibling;Wr.nextSibling;var Nt=Yt.nextSibling,ln=Nt.firstChild,Yr=ln.nextSibling,Kr=Yr.nextSibling,tn=Kr.nextSibling;return tn.nextSibling,Ne.style.setProperty("margin-top","0.5rem"),Ne.style.setProperty("padding","0.5rem"),Ne.style.setProperty("background","var(--strip-color)"),Ne.style.setProperty("border-radius","var(--border-radius-sm)"),Ne.style.setProperty("font-size","0.75rem"),Ne.style.setProperty("border","1px solid var(--border-color)"),Dt.style.setProperty("font-weight","500"),Dt.style.setProperty("margin-bottom","0.25rem"),i(ar,()=>N().toFixed(2),null),i(Yt,()=>(N()*e()?.paymentMethods?.taxPercent/100).toFixed(2),dr),i(Yt,()=>(N()+N()*e()?.paymentMethods?.taxPercent/100).toFixed(2),Wr),i(Nt,()=>q().toFixed(2),Yr),i(Nt,()=>C().toFixed(2),tn),X(cn=>{var xn=e()?.paymentMethods?.taxOnTotal?"var(--primary-color)":"var(--text-muted)",Eo=e()?.paymentMethods?.taxOnTotal?"var(--text-muted)":"var(--primary-color)";return xn!==cn.e&&((cn.e=xn)!=null?Yt.style.setProperty("color",xn):Yt.style.removeProperty("color")),Eo!==cn.t&&((cn.t=Eo)!=null?Nt.style.setProperty("color",Eo):Nt.style.removeProperty("color")),cn},{e:void 0,t:void 0}),Ne}}),Vt),Vt.$$input=Ne=>H("taxPercent",parseFloat(Ne.target.value)||0),Ht.style.setProperty("margin-top","0.5rem"),Ht.style.setProperty("align-items","center"),Ht.style.setProperty("gap","0.5rem"),nr.style.setProperty("margin-top","0.5rem"),It.addEventListener("change",()=>r(Ne=>({...Ne,taxOnTotal:!1}))),i(hr,()=>e()?.paymentMethods?.taxPercent,Ir),i(hr,(()=>{var Ne=ge(()=>e()?.paymentMethods?.taxPercent>0&&!e()?.paymentMethods?.taxOnTotal);return()=>Ne()&&(()=>{var Dt=Jm(),ar=Dt.firstChild,Yt=ar.nextSibling;return Yt.nextSibling,Dt.style.setProperty("color","var(--primary-color)"),i(Dt,()=>(N()*e()?.paymentMethods?.taxPercent/100).toFixed(2),Yt),Dt})()})(),null),Mr.addEventListener("change",()=>H("taxOnTotal",!0)),i(gn,()=>e()?.paymentMethods?.taxPercent,xt),i(gn,(()=>{var Ne=ge(()=>!!(e()?.paymentMethods?.taxPercent>0&&e()?.paymentMethods?.taxOnTotal));return()=>Ne()&&(()=>{var Dt=Jm(),ar=Dt.firstChild,Yt=ar.nextSibling;return Yt.nextSibling,Dt.style.setProperty("color","var(--primary-color)"),i(Dt,()=>q().toFixed(2),Yt),Dt})()})(),null),i(Ht,b(Ae,{get when(){return e()?.paymentMethods?.taxPercent>0},get children(){var Ne=bT(),Dt=Ne.firstChild,ar=Dt.firstChild,Yt=Dt.nextSibling;return Ne.style.setProperty("margin-top","1rem"),Ne.style.setProperty("padding-top","1rem"),Ne.style.setProperty("border-top","1px solid var(--border-color)"),ar.addEventListener("change",bt=>oe("exemptTaxOnCash",bt.target.checked)),i(Ne,b(Ae,{get when(){return ge(()=>!!e()?.paymentMethods?.exemptTaxOnCash)()&&F()>0},get children(){var bt=vT(),dr=bt.firstChild,yr=dr.nextSibling,Wr=yr.firstChild,Nt=Wr.nextSibling,ln=Nt.nextSibling,Yr=ln.nextSibling;Yr.nextSibling;var Kr=yr.nextSibling;Kr.firstChild;var tn=Kr.nextSibling,cn=tn.firstChild,xn=cn.nextSibling;return xn.nextSibling,bt.style.setProperty("margin-top","0.5rem"),bt.style.setProperty("padding","0.75rem"),bt.style.setProperty("background","#e8f5e9"),bt.style.setProperty("border-radius","var(--border-radius-sm)"),bt.style.setProperty("font-size","0.875rem"),bt.style.setProperty("border","1px solid #c8e6c9"),dr.style.setProperty("font-weight","500"),dr.style.setProperty("color","#2e7d32"),dr.style.setProperty("margin-bottom","0.5rem"),i(yr,()=>e().paymentMethods.cash.toFixed(2),Nt),i(yr,()=>(e().paymentMethods.cash/F()*100).toFixed(1),Yr),Kr.style.setProperty("color","#4CAF50"),Kr.style.setProperty("font-weight","500"),i(Kr,()=>D().toFixed(2),null),tn.style.setProperty("font-size","0.8rem"),tn.style.setProperty("color","#666"),tn.style.setProperty("margin-top","0.25rem"),i(tn,()=>(q()+D()).toFixed(2),xn),i(tn,()=>q().toFixed(2),null),bt}}),null),X(bt=>{var dr={...Re.label,display:"flex","align-items":"center",gap:"0.5rem","margin-bottom":"0.5rem"},yr=Re.fieldDescription;return bt.e=d(Dt,dr,bt.e),bt.t=d(Yt,yr,bt.t),bt},{e:void 0,t:void 0}),X(()=>ar.checked=e()?.paymentMethods?.exemptTaxOnCash),Ne}}),null),X(Ne=>{var Dt={...Re.section,"margin-top":"1rem"},ar=Re.sectionTitle,Yt=Re.fieldDescription,bt={...Re.button,...e()?.paymentMethods.exemptTaxOnCash&&e()?.paymentMethods.taxPercent>0?{background:"#4CAF50",color:"white"}:Re.secondaryButton,"font-size":"0.75rem",padding:"0.5rem 0.75rem",position:"relative"},dr=e()?.paymentMethods.exemptTaxOnCash&&e()?.paymentMethods.taxPercent>0?`Pagar todo en efectivo (Ahorro: $${(N()*e()?.paymentMethods.taxPercent/100).toFixed(2)})`:"Pagar todo en efectivo",yr={...Re.button,...Re.secondaryButton,"font-size":"0.75rem",padding:"0.5rem 0.75rem"},Wr={...Re.button,...Re.secondaryButton,"font-size":"0.75rem",padding:"0.5rem 0.75rem"},Nt={...Re.button,background:"#f44336",color:"white","font-size":"0.75rem",padding:"0.5rem 0.75rem"},ln=Re.gridTwo,Yr=Re.formGroup,Kr=Re.label,tn=Re.input,cn=Re.formGroup,xn=Re.label,Eo=Re.input,Sl=Re.formGroup,Pl=Re.label,To=Re.input,dn=parseFloat(ee().toFixed())===0?"#4CAF50":ee()>0?"#f44336":"#FF9800",ei=parseFloat(ee().toFixed())===0?"#4CAF50":"#f44336",Fs=Re.formGroup,Vs=Re.label,ro=Re.fieldDescription,wl=Re.input,Cl={...Re.label,display:"flex","align-items":"center",gap:"0.5rem","font-size":"0.8rem","margin-bottom":"0.25rem"},xl={...Re.fieldDescription,"margin-left":"1.5rem","margin-bottom":"0.5rem"},$n={...Re.label,display:"flex","align-items":"center",gap:"0.5rem","font-size":"0.8rem","margin-bottom":"0.25rem"},$l={...Re.fieldDescription,"margin-left":"1.5rem"};return Ne.e=d(Ce,Dt,Ne.e),Ne.t=d(Se,ar,Ne.t),Ne.a=d(Ke,Yt,Ne.a),Ne.o=d(Oe,bt,Ne.o),dr!==Ne.i&&ct(Oe,"title",Ne.i=dr),Ne.n=d(Ye,yr,Ne.n),Ne.s=d(pt,Wr,Ne.s),Ne.h=d(vt,Nt,Ne.h),Ne.r=d(mt,ln,Ne.r),Ne.d=d(yt,Yr,Ne.d),Ne.l=d(Qe,Kr,Ne.l),Ne.u=d(Ct,tn,Ne.u),Ne.c=d(_t,cn,Ne.c),Ne.w=d(jt,xn,Ne.w),Ne.m=d(Mt,Eo,Ne.m),Ne.f=d(Be,Sl,Ne.f),Ne.y=d(We,Pl,Ne.y),Ne.g=d(at,To,Ne.g),dn!==Ne.p&&((Ne.p=dn)!=null?dt.style.setProperty("color",dn):dt.style.removeProperty("color")),ei!==Ne.b&&((Ne.b=ei)!=null?er.style.setProperty("color",ei):er.style.removeProperty("color")),Ne.T=d(et,Fs,Ne.T),Ne.A=d(Rt,Vs,Ne.A),Ne.O=d(Ot,ro,Ne.O),Ne.I=d(Vt,wl,Ne.I),Ne.S=d(cr,Cl,Ne.S),Ne.W=d(hr,xl,Ne.W),Ne.C=d(Cr,$n,Ne.C),Ne.B=d(gn,$l,Ne.B),Ne},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),X(()=>Ct.value=e().paymentMethods.cash),X(()=>Mt.value=e().paymentMethods.zelle),X(()=>at.value=e().paymentMethods.creditCard),X(()=>Vt.value=e()?.paymentMethods?.taxPercent),X(()=>It.checked=!e()?.paymentMethods?.taxOnTotal),X(()=>Mr.checked=e()?.paymentMethods?.taxOnTotal),Ce})(),(()=>{var Ce=CT(),Se=Ce.firstChild;Se.firstChild;var Ke=Se.nextSibling;Ke.firstChild;var He=Ke.nextSibling;He.firstChild;var Oe=He.nextSibling;return Oe.firstChild,Se.style.setProperty("font-size","0.875rem"),Se.style.setProperty("opacity","0.9"),i(Se,()=>J().toFixed(),null),Ke.style.setProperty("font-size","0.875rem"),Ke.style.setProperty("opacity","0.9"),i(Ke,()=>O().toFixed(),null),He.style.setProperty("font-size","0.875rem"),He.style.setProperty("opacity","0.9"),He.style.setProperty("border-top","1px solid rgba(255,255,255,0.2)"),He.style.setProperty("padding-top","0.5rem"),He.style.setProperty("margin-top","0.5rem"),i(He,()=>N().toFixed(2),null),i(Ce,b(Ae,{get when(){return e()?.paymentMethods?.taxPercent>0},get children(){var Ye=PT(),pt=Ye.firstChild,vt=pt.nextSibling,mt=vt.nextSibling,yt=mt.nextSibling;return yt.nextSibling,Ye.style.setProperty("font-size","0.875rem"),Ye.style.setProperty("opacity","0.9"),i(Ye,()=>e()?.paymentMethods?.taxPercent,vt),i(Ye,()=>e()?.paymentMethods?.taxOnTotal?"del total":"del subtotal",yt),i(Ye,()=>q().toFixed(2),null),i(Ye,b(Ae,{get when(){return ge(()=>!!e()?.paymentMethods?.exemptTaxOnCash)()&&D()>0},get children(){var Qe=ST(),Ct=Qe.firstChild,_t=Ct.nextSibling;return _t.nextSibling,Qe.style.setProperty("color","#4CAF50"),Qe.style.setProperty("margin-left","0.5rem"),i(Qe,()=>D().toFixed(2),_t),Qe}}),null),Ye}}),Oe),i(Ce,b(Ae,{get when(){return e().shippingMethod},get children(){var Ye=wT();return Ye.firstChild,Ye.style.setProperty("font-size","0.875rem"),Ye.style.setProperty("opacity","0.9"),i(Ye,()=>e().shippingMethod==="aereo"?" Areo":" Martimo",null),Ye}}),Oe),Oe.style.setProperty("font-size","1.5rem"),Oe.style.setProperty("font-weight","700"),Oe.style.setProperty("margin-top","0.5rem"),Oe.style.setProperty("border-top","1px solid rgba(255,255,255,0.3)"),Oe.style.setProperty("padding-top","0.5rem"),i(Oe,()=>C().toFixed(0),null),X(Ye=>d(Ce,Re.totalSection,Ye)),Ce})(),(()=>{var Ce=Xa();return Ce.style.setProperty("margin-top","1rem"),i(Ce,b(Ae,{get when(){return!R()},get children(){var Se=xT();return Se.$$click=le,i(Se,()=>v()?" Creando Factura...":" Crear Factura"),X(Ke=>{var He=v()||!e().invoice.trim()||!e().shipper_consignee.name.trim()||Math.round(ee())>.01,Oe={...Re.button,...Re.primaryButton,width:"100%","justify-content":"center",padding:"0.875rem","font-size":"1rem",opacity:v()||!e().invoice.trim()||!e().shipper_consignee.name.trim()||Math.round(ee())>.01?"0.6":"1"},Ye=e().invoice.trim()?e().shipper_consignee.name.trim()?Math.abs(ee())>.01?`El balance de pago debe ser $0.00 (actual: $${ee().toFixed(2)})`:"Crear esta factura":"Por favor ingrese el nombre del cliente":"Por favor ingrese un nmero de factura";return He!==Ke.e&&(Se.disabled=Ke.e=He),Ke.t=d(Se,Oe,Ke.t),Ye!==Ke.a&&ct(Se,"title",Ke.a=Ye),Ke},{e:void 0,t:void 0,a:void 0}),Se}}),null),i(Ce,b(Ae,{get when(){return R()},get children(){var Se=$T(),Ke=Se.firstChild,He=Ke.nextSibling;return Se.style.setProperty("display","grid"),Se.style.setProperty("grid-template-columns","1fr 1fr"),Se.style.setProperty("gap","0.75rem"),Ke.$$click=ne,i(Ke,()=>Z()?" Generando...":" Generar PDF"),He.$$click=ue,X(Oe=>{var Ye=Z(),pt={...Re.button,...Re.successButton,"justify-content":"center",opacity:Z()?"0.6":"1"},vt={...Re.button,...Re.secondaryButton,"justify-content":"center"};return Ye!==Oe.e&&(Ke.disabled=Oe.e=Ye),Oe.t=d(Ke,pt,Oe.t),Oe.a=d(He,vt,Oe.a),Oe},{e:void 0,t:void 0,a:void 0}),Se}}),null),Ce})()]}})),X(Ce=>{var Se=Re.container,Ke=Re.header,He=Re.grid,Oe=Re.section,Ye=Re.sectionTitle,pt=Re.gridTwo,vt=Re.formGroup,mt=Re.label,yt=Re.input,Qe=l()||"INV-20241201-1234",Ct=Re.formGroup,_t=Re.label,jt=Re.gridTwo,Mt=Re.formGroup,Be=Re.label,We=Re.fieldDescription,at=Re.input,lt=Re.formGroup,Tt=Re.label,Ie=Re.fieldDescription,Ve=Re.formGroup,st=Re.label,dt=Re.textarea,Gt={...Re.label,display:"flex","align-items":"center",gap:"0.5rem"},Wt=Re.fieldDescription;return Ce.e=d(L,Se,Ce.e),Ce.t=d(A,Ke,Ce.t),Ce.a=d(U,He,Ce.a),Ce.o=d(ae,Oe,Ce.o),Ce.i=d(re,Ye,Ce.i),Ce.n=d(ce,pt,Ce.n),Ce.s=d(Q,vt,Ce.s),Ce.h=d(me,mt,Ce.h),Ce.r=d(K,yt,Ce.r),Qe!==Ce.d&&ct(K,"placeholder",Ce.d=Qe),Ce.l=d(he,Ct,Ce.l),Ce.u=d(ve,_t,Ce.u),Ce.c=d(W,jt,Ce.c),Ce.w=d(ie,Mt,Ce.w),Ce.m=d(Pe,Be,Ce.m),Ce.f=d(_e,We,Ce.f),Ce.y=d(fe,at,Ce.y),Ce.g=d(be,lt,Ce.g),Ce.p=d(pe,Tt,Ce.p),Ce.b=d(we,Ie,Ce.b),Ce.T=d(ke,Ve,Ce.T),Ce.A=d(Te,st,Ce.A),Ce.O=d(Ue,dt,Ce.O),Ce.I=d(Xe,Gt,Ce.I),Ce.S=d(ot,Wt,Ce.S),Ce},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0}),X(()=>K.value=e().invoice),X(()=>fe.value=e().shippingMethod),X(()=>De.value=e().createDate),X(()=>Ue.value=e().description),X(()=>ze.checked=e().packagesOrder),L})()},LT=t=>{let{reserva:e,updateReserva:r,removeReserva:n}=t;return(()=>{var o=ET(),s=o.firstChild,a=s.firstChild,l=s.nextSibling,u=l.firstChild,h=u.firstChild,m=u.nextSibling,v=m.firstChild,_=m.nextSibling,x=_.firstChild,T=_.nextSibling;return T.firstChild,i(s,b(OT,{get value(){return e.type},onChange:E=>r(e.id,"type",E),placeholder:"ej., Ropa, Zapatos, TV, tiles del Hogar...",width:"80%",index:1}),a),a.$$click=()=>n(e.id),i(u,b(ls,{type:"number",get value(){return e.qty},update:E=>r(e.id,"qty",parseFloat(E)||0),get style(){return{...Re.input,...Re.smallInput,width:"60px"}},placeholder:"Cant",min:"1",step:"0.01",index:2}),null),i(m,b(ls,{type:"number",get value(){return e.price},update:E=>r(e.id,"price",parseFloat(E)||0),get style(){return{...Re.input,...Re.smallInput}},placeholder:"Precio",step:"0.01",index:3}),null),i(_,b(ls,{type:"number",get value(){return e.arancel},update:E=>r(e.id,"arancel",parseFloat(E)||0),get style(){return{...Re.input,...Re.smallInput}},placeholder:"Arancel",step:"0.01",index:4}),null),T.style.setProperty("width","80px"),T.style.setProperty("text-align","right"),T.style.setProperty("font-weight","500"),i(T,()=>e.total?.toFixed(2)||"0.00",null),i(T,b(Ae,{get when(){return!1},get children(){var E=IT(),P=E.firstChild,R=P.nextSibling,Y=R.nextSibling,Z=Y.nextSibling,j=Z.nextSibling,B=j.nextSibling;return B.nextSibling,E.style.setProperty("font-size","0.6rem"),E.style.setProperty("color","var(--text-muted)"),i(E,()=>e.qty,R),i(E,()=>e.price,Z),i(E,()=>e.arancel,B),E}}),null),X(E=>{var P=Re.productWrapItem,R={...Re.productItem,"justify-content":"space-around"},Y=Re.removeButton,Z=Re.productItem,j=Re.formGroup,B=Re.label,V=Re.formGroup,f=Re.label,g=Re.formGroup,S=Re.label;return E.e=d(o,P,E.e),E.t=d(s,R,E.t),E.a=d(a,Y,E.a),E.o=d(l,Z,E.o),E.i=d(u,j,E.i),E.n=d(h,B,E.n),E.s=d(m,V,E.s),E.h=d(v,f,E.h),E.r=d(_,g,E.r),E.d=d(x,S,E.d),E},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),o})()},MT=t=>{let{product:e,updateProduct:r,removeProduct:n}=t;return(()=>{var o=TT(),s=o.firstChild,a=s.firstChild,l=a.firstChild,u=l.nextSibling,h=a.nextSibling,m=s.nextSibling,v=m.firstChild;return v.firstChild,a.style.setProperty("flex","1"),l.style.setProperty("font-weight","500"),l.style.setProperty("font-size","0.875rem"),i(l,()=>e?.product.label),u.style.setProperty("font-size","0.75rem"),u.style.setProperty("color","var(--text-muted)"),i(u,()=>e?.product.code),h.$$click=()=>n(e?.id),i(m,b(ls,{type:"number",get value(){return e?.qty},placeholder:"Cant",update:_=>r(e?.id,"qty",parseFloat(_)||0)}),v),i(m,b(ls,{type:"number",get value(){return e?.salePrice},placeholder:"Precio",update:_=>r(e?.id,"salePrice",parseFloat(_)||0)}),v),v.style.setProperty("width","80px"),v.style.setProperty("text-align","right"),v.style.setProperty("font-weight","500"),i(v,()=>e?.total.toFixed(2),null),X(_=>{var x=Re.productWrapItem,T=Re.productItem,E=Re.removeButton,P=Re.productItem;return _.e=d(o,x,_.e),_.t=d(s,T,_.t),_.a=d(h,E,_.a),_.o=d(m,P,_.o),_},{e:void 0,t:void 0,a:void 0,o:void 0}),o})()},ls=t=>{const[e,r]=ye("");$r(()=>{t?.value!==void 0&&r(t.value.toString())});const n=s=>{(s.key==="Enter"||s.key==="Escape"||s.key==="Tab")&&t.update&&ts(e())&&t.update(e())},o=()=>{t.update&&ts(e())&&t.update(e())};return(()=>{var s=kT();return s.addEventListener("blur",o),s.$$keydown=n,s.$$input=a=>r(a.target.value),X(a=>{var l=t?.type,u={...Re.input,...Re.smallInput,width:t?.width||"90px"},h=t.placeholder,m=t.title,v=t?.index;return l!==a.e&&ct(s,"type",a.e=l),a.t=d(s,u,a.t),h!==a.a&&ct(s,"placeholder",a.a=h),m!==a.o&&ct(s,"title",a.o=m),v!==a.i&&ct(s,"tabindex",a.i=v),a},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),X(()=>s.value=e()),s})()},OT=t=>{const[e,r]=ye(!1),[n,o]=ye(""),[s,a]=ye(-1),l=()=>{const Z=n().toLowerCase();if(!Z)return Xm;const j=Xm.filter(B=>B.toLowerCase().includes(Z));return j.length===0&&Z.length>0?[` Agregar "${n()}"`]:j},u=()=>{r(!0),o(""),a(-1)},h=Z=>{const B=Z.target.value;o(B),r(B.length>0),a(-1)},m=Z=>{let j;Z.startsWith(" Agregar")?j=n():j=Z.replace(/^[\u{1F000}-\u{1F9FF}\u{2600}-\u{27BF}]\s*/u,""),t.onChange(j),r(!1),o(""),a(-1)},v=Z=>{const j=l();switch(Z.key){case"ArrowDown":Z.preventDefault(),a(B=>Math.min(B+1,j.length-1));break;case"ArrowUp":Z.preventDefault(),a(B=>Math.max(B-1,-1));break;case"Enter":Z.preventDefault(),s()>=0&&j[s()]?m(j[s()]):(t.onChange(n()||t.value),r(!1));break;case"Escape":r(!1),o(""),a(-1);break}},_=()=>{setTimeout(()=>{n()&&n()!==t.value&&t.onChange(n()),r(!1),o(""),a(-1)},150)},x=()=>e()&&n()?n():t.value||"",T={position:"relative",width:t.width||"100%",flex:t.width?void 0:"1"},E={...Re.input,width:"100%","padding-right":"2rem"},P={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"200px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},R=Z=>({padding:"0.5rem 0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:Z?"var(--strip-color)":"transparent",color:Z?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease","font-size":"0.875rem"}),Y={position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)","pointer-events":"none",color:"var(--text-muted)","font-size":"0.75rem"};return(()=>{var Z=RT(),j=Z.firstChild,B=j.firstChild,V=B.nextSibling;return j.style.setProperty("position","relative"),B.addEventListener("blur",_),B.$$keydown=v,B.$$click=u,B.$$input=h,i(V,()=>e()?"":""),i(Z,b(Ae,{get when(){return ge(()=>!!e())()&&l().length>0},get children(){var f=Xa();return i(f,b(ut,{get each(){return l()},children:(g,S)=>{const $=g.startsWith(" Agregar");return(()=>{var w=Xa();return w.addEventListener("mouseenter",()=>a(S())),w.$$click=()=>m(g),i(w,g),X(I=>d(w,{...R(S()===s()),...$&&{"font-style":"italic","border-left":"3px solid var(--primary-color)",background:S()===s()?"var(--primary-color)":"#f0f8ff",color:S()===s()?"white":"var(--primary-color)"}},I)),w})()}})),X(g=>d(f,P,g)),f}}),null),X(f=>{var g=T,S=E,$=t.placeholder,w=t?.index,I=Y;return f.e=d(Z,g,f.e),f.t=d(B,S,f.t),$!==f.a&&ct(B,"placeholder",f.a=$),w!==f.o&&ct(B,"tabindex",f.o=w),f.i=d(V,I,f.i),f},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),X(()=>B.value=x()),Z})()};wt(["input","click","keydown"]);var FT=z("<div><div>"),VT=z("<div> "),BT=z("<div><div><label></label><select><option value=all></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label><input type=text>"),UT=z("<div><button></button><button></button><button> Crear Nueva Factura"),Mo=z("<div>"),zT=z("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),jT=z("<button> "),qT=z("<option>"),GT=z("<div><div></div><div></div><div></div><div>"),Zm=z("<div><span></span><span> "),HT=z("<div><span></span><span> $"),WT=z("<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td><span></span></td><td><button>");const Ca=t=>parseFloat(t?.toString())||0,YT=t=>{let e=Ca(t.qty),r=Ca(t.price),n=Ca(t.arancel);return`${(e*r+n)?.toFixed(2)}`},KT=t=>{let e=Math.abs(t.qty),r=Ca(t.salePrice);return`${(e*r)?.toFixed(2)}`},QT=t=>{let e=0;t?.reservas?.forEach(o=>{e+=parseFloat(YT(o))});let r=0;t?.products?.forEach(o=>{r+=parseFloat(KT(o))});let n={};return n.reservaSubtotal=e.toFixed(2),n.productSubtotal=r.toFixed(2),n.subtotalBeforeTax=(r+e).toFixed(2),n.total=n.subtotalBeforeTax,n},JT=t=>{const{t:e}=ft(),[r,n]=ye(!1),[o,s]=ye("all"),[a,l]=ye(""),[u,h]=ye(""),[m,v]=ye(null),[_,x]=ye("dashboard"),[T,E]=ye([]),[P,R]=ye(""),[Y,Z]=ye("overview");$r(async()=>{try{t.invoices,await hn.fetchInvoices();try{const L=await hn.fetchStores();let A=Array.isArray(L)?L:Object.keys(L)||[]}catch{const A=hn.state.invoices||t.invoices,U=[...new Set(A.map(te=>te.store))];E(U.sort())}}catch(L){console.error("Error loading dashboard data:",L)}}),Ze(()=>hn.state.invoices||t.invoices);const j=Ze(()=>{let L;t.invoices?L=hn.getFilteredInvoices({store:o(),dateFrom:a(),dateTo:u()}):L=hn.getFilteredInvoices({store:o(),dateFrom:a(),dateTo:u()});const A=P().toLowerCase().trim();return A&&(L=L.filter(U=>!!(U.invoice?.toLowerCase().includes(A)||U.shipper_consignee?.name?.toLowerCase().includes(A)||U.description?.toLowerCase().includes(A)||U.store?.toLowerCase().includes(A)||U.shipper_consignee?.email?.toLowerCase().includes(A)||U.shipper_consignee?.phoneNumber?.includes(A)))),L}),B=async()=>{try{t.invoices,n(!0),await hn.refreshData({store:o()!=="all"?o():void 0,dateFrom:a()||void 0,dateTo:u()||void 0}),n(!1)}catch(L){console.error("Error refreshing data:",L)}},V=Ze(()=>{r();const L=j(),A=hn.calculateSummary(L);let U=new Map,te=new Map,ae=new Map;return L.forEach(re=>{re?.products?.forEach(ce=>{const Q=Math.abs(ce.qty),me=ce.product.label;U.set(me,(U.get(me)||0)+Q)}),re?.reservas?.forEach(ce=>{let Q=parseInt(ce.qty);isNaN(Q)&&(Q=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[ce.type]||ce?.onlyTariff?(Q=parseFloat(ce.arancel)||parseFloat(ce.qty)*parseFloat(ce.price),ae.set(ce.type,(te.get(ce.type)||0)+Q)):te.set(ce.type,(te.get(ce.type)||0)+Q)})}),{...A,productsByCategory:U,reservasByType:te,othersByType:ae}}),f=L=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(L),g=L=>new Date(L).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),S={padding:"2rem"},$={display:"flex",gap:"1rem","align-items":"flex-end","margin-bottom":"2rem","flex-wrap":"wrap",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)"},w={display:"flex","flex-direction":"column",gap:"0.5rem",flex:"1","min-width":"200px"},I={"font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)"},y={padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--background-color)"},de={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(280px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},J={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)"},O={width:"48px",height:"48px","border-radius":"12px",display:"flex","align-items":"center","justify-content":"center","font-size":"1.5rem","margin-bottom":"1rem"},N={"font-size":"0.875rem",color:"var(--text-secondary)","margin-bottom":"0.5rem"},q={"font-size":"1.75rem","font-weight":"700",color:"var(--text-primary)","margin-bottom":"0.25rem"},D={"font-size":"0.75rem",color:"var(--text-muted)"},C={width:"100%",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)",overflow:"hidden"},F={padding:"1rem","text-align":"left",background:"var(--background-color)","font-weight":"600",color:"var(--text-secondary)","font-size":"0.875rem","border-bottom":"2px solid var(--border-color)"},ee={padding:"1rem","border-bottom":"1px solid var(--border-color)"},H={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},oe=L=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:L?"var(--primary-color)":"var(--text-muted)","border-bottom":L?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),M={padding:"0.5rem 1rem",background:"var(--primary-color)",color:"white",border:"none","border-radius":"var(--border-radius-sm)",cursor:"pointer","font-size":"0.875rem",transition:"opacity 0.2s"},G={padding:"0.75rem 1.5rem",background:"var(--secondary-color)",color:"white",border:"none","border-radius":"var(--border-radius-sm)",cursor:"pointer","margin-bottom":"1rem",display:"flex","align-items":"center",gap:"0.5rem"},le=()=>[{title:e("invoices.totalRevenue"),value:V().grandTotal,icon:"",color:"#4CAF50",subtext:`${e("common.of")} ${V().totalInvoices} ${e("common.invoice")} `},{title:e("invoices.totalProducts"),value:V().totalProducts,icon:"",color:"#2196F3",subtext:`${f(V().totalProductAmount)} ${e("invoices.value")}`,isNumber:!0},{title:e("invoices.totalReservations"),value:V().totalReservas,icon:"",color:"#FF9800",subtext:`${f(V().totalReservaAmount)} ${e("invoices.value")}`,isNumber:!0},{title:e("invoices.aranceles"),value:V().totalAranceles,icon:"",color:"#9C27B0",subtext:e("invoices.customsFees")},{title:e("invoices.uniqueCustomers"),value:V().uniqueCustomers,icon:"",color:"#00BCD4",subtext:e("invoices.activeCustomers"),isNumber:!0},{title:e("invoices.averageInvoice"),value:V().avgInvoiceValue,icon:"",color:"#FF5722",subtext:e("invoices.perInvoiceValue")},{title:e("invoices.completed"),value:V().completedInvoices,icon:"",color:"#4CAF50",subtext:`${V().pendingInvoices} ${e("invoices.pending")}`,isNumber:!0},{title:e("invoices.storesActive"),value:T().length,icon:"",color:"#795548",subtext:e("invoices.locations"),isNumber:!0}],ne=()=>Le.getActiveLocations();fn(()=>{});const ue=async()=>{let L="YB1";id.calcStockLevels(),await Le.fecthProduct(L),await Le.fecthInventory(L)};return $r(()=>{ue()}),b(an,{get title(){return e("invoices.title")},get children(){var L=Mo();return d(L,S),i(L,b(Ae,{get when(){return _()==="dashboard"},get children(){return[b(Ae,{get when(){return!t.invoices&&hn.state.loading},get children(){var A=FT(),U=A.firstChild;return A.style.setProperty("text-align","center"),A.style.setProperty("padding","2rem"),U.style.setProperty("font-size","1.25rem"),U.style.setProperty("margin-bottom","1rem"),i(U,()=>e("invoices.loadingInvoices")),A}}),b(Ae,{get when(){return hn.state.error},get children(){var A=VT();return A.firstChild,A.style.setProperty("padding","1rem"),A.style.setProperty("margin-bottom","1rem"),A.style.setProperty("background","#ffebee"),A.style.setProperty("border","1px solid #ffcdd2"),A.style.setProperty("border-radius","var(--border-radius)"),A.style.setProperty("color","#d32f2f"),i(A,()=>hn.state.error,null),i(A,b(qe,{variant:"outline",size:"sm",onClick:B,style:{"margin-left":"1rem"},get children(){return e("invoices.refreshData")}}),null),A}}),(()=>{var A=BT(),U=A.firstChild,te=U.firstChild,ae=te.nextSibling,re=ae.firstChild,ce=U.nextSibling,Q=ce.firstChild,me=Q.nextSibling,K=ce.nextSibling,he=K.firstChild,ve=he.nextSibling,W=K.nextSibling,ie=W.firstChild,Pe=ie.nextSibling;return d(A,$),i(te,()=>e("invoices.storeLocation")),ae.addEventListener("change",_e=>s(_e.currentTarget.value)),i(re,()=>e("invoices.allStores")),i(ae,b(ut,{get each(){return ne()},children:_e=>(()=>{var fe=qT();return i(fe,()=>_e.name),X(()=>fe.value=_e.id),fe})()}),null),i(Q,()=>e("invoices.fromDate")),me.addEventListener("change",_e=>l(_e.currentTarget.value)),i(he,()=>e("invoices.toDate")),ve.addEventListener("change",_e=>h(_e.currentTarget.value)),i(ie,()=>e("invoices.search")),Pe.addEventListener("change",_e=>R(_e.currentTarget.value)),i(A,b(qe,{variant:"secondary",onClick:()=>{s("all"),l(""),h(""),R("")},get children(){return e("invoices.clearFilters")}}),null),i(A,b(qe,{variant:"primary",onClick:B,get disabled(){return!t.invoices&&hn.state.loading},get children(){return[" ",ge(()=>e("invoices.refreshData"))]}}),null),X(_e=>{var fe=w,be=I,pe=y,we=w,De=I,ke=y,Te=w,Ue=I,Xe=y,ze=w,$e=I,Ge=y,ot=e("invoices.searchPlaceholder");return _e.e=d(U,fe,_e.e),_e.t=d(te,be,_e.t),_e.a=d(ae,pe,_e.a),_e.o=d(ce,we,_e.o),_e.i=d(Q,De,_e.i),_e.n=d(me,ke,_e.n),_e.s=d(K,Te,_e.s),_e.h=d(he,Ue,_e.h),_e.r=d(ve,Xe,_e.r),_e.d=d(W,ze,_e.d),_e.l=d(ie,$e,_e.l),_e.u=d(Pe,Ge,_e.u),ot!==_e.c&&ct(Pe,"placeholder",_e.c=ot),_e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0}),X(()=>ae.value=o()),X(()=>me.value=a()),X(()=>ve.value=u()),X(()=>Pe.value=P()),A})(),(()=>{var A=UT(),U=A.firstChild,te=U.nextSibling,ae=te.nextSibling;return d(A,H),U.$$click=()=>Z("overview"),i(U,()=>e("inventory.overview")),te.$$click=()=>Z("invoices"),i(te,()=>e("invoices.invoices")),ae.$$click=()=>Z("add"),X(re=>{var ce=oe(Y()==="overview"),Q=oe(Y()==="invoices"),me=oe(Y()==="add");return re.e=d(U,ce,re.e),re.t=d(te,Q,re.t),re.a=d(ae,me,re.a),re},{e:void 0,t:void 0,a:void 0}),A})(),b(Ae,{get when(){return Y()==="overview"},get children(){return[(()=>{var A=Mo();return d(A,de),i(A,b(ut,{get each(){return le()},children:U=>(()=>{var te=GT(),ae=te.firstChild,re=ae.nextSibling,ce=re.nextSibling,Q=ce.nextSibling;return d(te,J),i(ae,()=>U?.icon),d(re,N),i(re,()=>U?.title),d(ce,q),i(ce,(()=>{var me=ge(()=>!!U.isNumber);return()=>me()?U.value:f(U.value)})()),d(Q,D),i(Q,()=>U.subtext),X(me=>d(ae,{...O,background:`${U?.color}20`,color:U?.color},me)),te})()})),A})(),b(Ae,{get when(){return V()?.productsByCategory?.size>0},get children(){return b(rt,{get title(){return e("invoices.topProducts")},get subtitle(){return e("invoices.mostSoldProducts")},get children(){var A=Mo();return A.style.setProperty("max-height","300px"),A.style.setProperty("overflow-y","auto"),i(A,()=>Array.from(V().productsByCategory.entries()).sort((U,te)=>te[1]-U[1]).slice(0,10).map(([U,te])=>(()=>{var ae=Zm(),re=ae.firstChild,ce=re.nextSibling,Q=ce.firstChild;return ae.style.setProperty("display","flex"),ae.style.setProperty("justify-content","space-between"),ae.style.setProperty("padding","0.75rem"),ae.style.setProperty("border-bottom","1px solid var(--border-color)"),i(re,U),ce.style.setProperty("font-weight","600"),i(ce,te,Q),i(ce,()=>e("common.units"),null),ae})())),A}})}}),(()=>{var A=Mo();return A.style.setProperty("margin","19px"),A})(),b(Ae,{get when(){return V()?.reservasByType?.size>0},get children(){return b(rt,{get title(){return e("invoices.reservationsByType")},get subtitle(){return e("invoices.distributionOfCategories")},style:{"margin-top":"1.5rem"},get children(){var A=Mo();return A.style.setProperty("max-height","300px"),A.style.setProperty("overflow-y","auto"),i(A,()=>Array.from(V().reservasByType.entries()).sort((U,te)=>te[1]-U[1]).map(([U,te])=>(()=>{var ae=Zm(),re=ae.firstChild,ce=re.nextSibling,Q=ce.firstChild;return ae.style.setProperty("display","flex"),ae.style.setProperty("justify-content","space-between"),ae.style.setProperty("padding","0.75rem"),ae.style.setProperty("border-bottom","1px solid var(--border-color)"),i(re,U),ce.style.setProperty("font-weight","600"),i(ce,te,Q),i(ce,()=>e("common.lbs"),null),ae})())),A}})}}),(()=>{var A=Mo();return A.style.setProperty("margin","19px"),A})(),b(Ae,{get when(){return V()?.othersByType?.size>0},get children(){return b(rt,{title:"Aranceles y otros servicios",get subtitle(){return e("invoices.distributionOfCategories")},style:{"margin-top":"1.5rem"},get children(){var A=Mo();return A.style.setProperty("max-height","300px"),A.style.setProperty("overflow-y","auto"),i(A,()=>Array.from(V().othersByType.entries()).sort((U,te)=>te[1]-U[1]).map(([U,te])=>(()=>{var ae=HT(),re=ae.firstChild,ce=re.nextSibling,Q=ce.firstChild;return ae.style.setProperty("display","flex"),ae.style.setProperty("justify-content","space-between"),ae.style.setProperty("padding","0.75rem"),ae.style.setProperty("border-bottom","1px solid var(--border-color)"),i(re,U),ce.style.setProperty("font-weight","600"),i(ce,te,Q),ae})())),A}})}})]}})]}}),null),i(L,b(Ae,{get when(){return Y()==="invoices"},get children(){return[b(Ae,{get when(){return _()!=="detail"},get children(){return b(rt,{get title(){return e("invoices.recentInvoices")},get subtitle(){return e("invoices.showingInvoices",{count:j().length})},style:{"margin-top":"1.5rem"},get children(){var A=zT(),U=A.firstChild,te=U.firstChild,ae=te.firstChild,re=ae.firstChild,ce=re.nextSibling,Q=ce.nextSibling,me=Q.nextSibling,K=me.nextSibling,he=K.nextSibling,ve=he.nextSibling,W=ve.nextSibling,ie=W.nextSibling,Pe=te.nextSibling;return A.style.setProperty("overflow-x","auto"),d(U,C),i(re,()=>e("invoices.invoiceNumber")),i(ce,()=>e("invoices.date")),i(Q,()=>e("invoices.customer")),i(me,()=>e("invoices.store")),i(K,()=>e("invoices.products")),i(he,()=>e("invoices.reservations")),i(ve,()=>e("invoices.total")),i(W,()=>e("invoices.status")),i(ie,()=>e("invoices.actions")),i(Pe,b(ut,{get each(){return j().slice(0,50)},children:_e=>{const fe=()=>{let be=QT(od(_e)),pe=be.productSubtotal,we=be.reservaSubtotal;return{total:be.total,totalProductAmount:pe,totalReservaAmount:we,totalOther:0}};return(()=>{var be=WT(),pe=be.firstChild,we=pe.nextSibling,De=we.nextSibling,ke=De.nextSibling,Te=ke.nextSibling,Ue=Te.nextSibling,Xe=Ue.nextSibling,ze=Xe.nextSibling,$e=ze.firstChild,Ge=ze.nextSibling,ot=Ge.firstChild;return i(pe,()=>_e?.invoice),i(we,()=>g(_e?.createDate)),i(De,()=>_e?.shipper_consignee?.name),i(ke,()=>_e?.store),i(Te,()=>fe()?.totalProductAmount),i(Ue,()=>fe()?.totalReservaAmount),i(Xe,()=>f(fe()?.total)),$e.style.setProperty("padding","0.25rem 0.75rem"),$e.style.setProperty("border-radius","9999px"),$e.style.setProperty("font-size","0.75rem"),$e.style.setProperty("font-weight","600"),i($e,(()=>{var je=ge(()=>!!_e.isCompleted);return()=>je()?e("invoices.completed"):e("invoices.pending")})()),ot.addEventListener("mouseleave",je=>je.currentTarget.style.opacity="1"),ot.addEventListener("mouseenter",je=>je.currentTarget.style.opacity="0.8"),ot.$$click=()=>{v(_e),x("detail")},d(ot,M),i(ot,()=>e("invoices.view")),X(je=>{var Ce=ee,Se=ee,Ke=ee,He=ee,Oe=ee,Ye=ee,pt={...ee,"text-align":"right","font-weight":"600"},vt=ee,mt=_e.isCompleted?"#d4edda":"#fff3cd",yt=_e.isCompleted?"#155724":"#856404",Qe=ee;return je.e=d(pe,Ce,je.e),je.t=d(we,Se,je.t),je.a=d(De,Ke,je.a),je.o=d(ke,He,je.o),je.i=d(Te,Oe,je.i),je.n=d(Ue,Ye,je.n),je.s=d(Xe,pt,je.s),je.h=d(ze,vt,je.h),mt!==je.r&&((je.r=mt)!=null?$e.style.setProperty("background",mt):$e.style.removeProperty("background")),yt!==je.d&&((je.d=yt)!=null?$e.style.setProperty("color",yt):$e.style.removeProperty("color")),je.l=d(Ge,Qe,je.l),je},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),be})()}})),X(_e=>{var fe=F,be=F,pe=F,we=F,De=F,ke=F,Te={...F,"text-align":"right"},Ue=F,Xe=F;return _e.e=d(re,fe,_e.e),_e.t=d(ce,be,_e.t),_e.a=d(Q,pe,_e.a),_e.o=d(me,we,_e.o),_e.i=d(K,De,_e.i),_e.n=d(he,ke,_e.n),_e.s=d(ve,Te,_e.s),_e.h=d(W,Ue,_e.h),_e.r=d(ie,Xe,_e.r),_e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),A}})}}),b(Ae,{get when(){return ge(()=>_()==="detail")()&&m()},get children(){return[(()=>{var A=jT();return A.firstChild,A.$$click=()=>{x("dashboard"),v(null)},d(A,G),i(A,()=>e("invoices.backToDashboard"),null),A})(),b(VE,{get invoice(){return m()},onPrint:()=>window.print()})]}})]}}),null),i(L,b(Ae,{get when(){return Y()==="add"},get children(){return b(NT,{})}}),null),L}})};wt(["click"]);const XT=()=>b(JT,{invoices:[{type:"SALES",invoice:"20255FK6S4B43SSS",description:"",store:"YY_8816",ssg_inventory_key:"JqdrRwGBpdBfRCim",ssg_sorder_key:"JqdrRwGBpdBfRCim",createDate:1736132690425,shipper_consignee:{name:"Yudith Perez Medero",phoneNumberS:"5022408378",dob:"1982-07-23",firstName:"RAUL",lastName:"BATISTA",lastName2:"ESPOSITO",middleName:"",email:"",phoneNumber:"52393232",altPhoneNumber:"",cid:"48121007305",ybstreetNo:"9",ybstreet:"10",ybbetwen1:"CARRALERO",ybbetwen2:"3RA",ybapt:"",ybreparto:"PUEBLO NUEVO",consigneeId:"26144",ssg_consignee_key:"26144",passport:"NA",nacionality:"CUB",ybcity:"HOLGUIN",ybestate:"HOLGUIN",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534800",reservas:[{type:"UTILES DEL HOGAR",qty:"15",arancel:"10",price:"5",key:"1GB16SD80"},{type:"MISCELANEAS",qty:"19",arancel:"",price:"4",key:"0DS6K14Y2"}],products:[{product:{id:"CmrhMfVjLR9HxT6P",label:"FOGONES ELECTRICO DOBLE RESISTENCIA DE ALAMBRE",code:"978Y82K94"},qty:-1,price:23.696296296296296,salePrice:"34"},{product:{id:"ov56aPYGbXIq4XGy",label:"Caramelos",code:"C852CSKB5"},qty:-2,price:5.990000000000001,salePrice:"10"}],isCompleted:!0},{type:"SALES",invoice:"20255FK6S4B43TTT",description:"",store:"YY_8803",ssg_inventory_key:"JqdrRwGBpdBfRCin",ssg_sorder_key:"JqdrRwGBpdBfRCin",createDate:1736032690425,shipper_consignee:{name:"Maria Rodriguez Santos",phoneNumberS:"5024567890",dob:"1990-03-15",firstName:"MARIA",lastName:"RODRIGUEZ",lastName2:"SANTOS",middleName:"ELENA",email:"maria@email.com",phoneNumber:"52987654",altPhoneNumber:"",cid:"90031507890",ybstreetNo:"15",ybstreet:"23",ybbetwen1:"MARTI",ybbetwen2:"CESPEDES",ybapt:"2A",ybreparto:"CENTRO",consigneeId:"26145",ssg_consignee_key:"26145",passport:"A1234567",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534801",reservas:[{type:"ELECTRONICOS",qty:"5",arancel:"15",price:"12",key:"2GB16SD81"},{type:"ROPA Y CALZADO",qty:"8",arancel:"8",price:"7",key:"0DS6K14Y3"}],products:[{product:{id:"XmrhMfVjLR9HxT6Q",label:"TELEVISOR LED 32 PULGADAS",code:"TV32LED01"},qty:-1,price:150.5,salePrice:"220"},{product:{id:"Yv56aPYGbXIq4XGz",label:"Zapatos Deportivos Nike",code:"ZAP001"},qty:-1,price:45.99,salePrice:"75"}],isCompleted:!1},{type:"SALES",invoice:"20255FK6S4B43UUU",description:"",store:"YY_8816",ssg_inventory_key:"JqdrRwGBpdBfRCio",ssg_sorder_key:"JqdrRwGBpdBfRCio",createDate:1735932690425,shipper_consignee:{name:"Carlos Mendez Perez",phoneNumberS:"5025678901",dob:"1975-12-08",firstName:"CARLOS",lastName:"MENDEZ",lastName2:"PEREZ",middleName:"ANTONIO",email:"",phoneNumber:"52876543",altPhoneNumber:"",cid:"75120878901",ybstreetNo:"7",ybstreet:"45",ybbetwen1:"LINEA",ybbetwen2:"PASEO",ybapt:"",ybreparto:"VEDADO",consigneeId:"26146",ssg_consignee_key:"26146",passport:"NA",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534802",reservas:[{type:"ALIMENTOS",qty:"25",arancel:"5",price:"3",key:"3GB16SD82"}],products:[{product:{id:"ZmrhMfVjLR9HxT6R",label:"ARROZ ESPECIAL 5LB",code:"ARZ005"},qty:-5,price:2.5,salePrice:"4"},{product:{id:"Av56aPYGbXIq4XG1",label:"ACEITE DE COCINA 1L",code:"ACE001"},qty:-3,price:3.75,salePrice:"6"}],isCompleted:!0},{type:"SALES",invoice:"20255FK6S4B43VVV",description:"",store:"YY_8802",ssg_inventory_key:"JqdrRwGBpdBfRCip",ssg_sorder_key:"JqdrRwGBpdBfRCip",createDate:1735832690425,shipper_consignee:{name:"Ana Lucia Fernandez",phoneNumberS:"5026789012",dob:"1988-06-20",firstName:"ANA",lastName:"FERNANDEZ",lastName2:"LOPEZ",middleName:"LUCIA",email:"ana.lucia@email.com",phoneNumber:"52765432",altPhoneNumber:"52111222",cid:"88062076789",ybstreetNo:"12",ybstreet:"18",ybbetwen1:"CALZADA",ybbetwen2:"SAN LAZARO",ybapt:"3B",ybreparto:"CENTRO HABANA",consigneeId:"26147",ssg_consignee_key:"26147",passport:"B9876543",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:"Entrega en horario de oficina"},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534803",reservas:[{type:"MEDICINA Y SALUD",qty:"10",arancel:"12",price:"8",key:"4GB16SD83"},{type:"UTILES DEL HOGAR",qty:"6",arancel:"6",price:"4",key:"5GB16SD84"}],products:[{product:{id:"BmrhMfVjLR9HxT6S",label:"VITAMINAS MULTIPLES 60 CAP",code:"VIT001"},qty:-2,price:12.5,salePrice:"18"}],isCompleted:!0}]});var ZT=z("<div><main>");const ek=t=>[b(SC,{}),ge(()=>t.children)],tk=()=>b(Jw,{get children(){var t=ZT(),e=t.firstChild;return i(e,b(bv,{root:ek,get children(){return[b(bn,{path:"/",component:vE}),b(bn,{path:"/accounts",component:()=>b(An,{permission:"AccountAccess",featureName:"Accounts",get children(){return b(_x,{})}})}),b(bn,{path:"/accounts/:id",component:()=>b(An,{permission:"AccountAccess",featureName:"Account Details",get children(){return b(Ax,{})}})}),b(bn,{path:"/entry-books",component:()=>b(An,{permission:"JournalAccess",featureName:"Entry Books",get children(){return b(uE,{})}})}),b(bn,{path:"/employees",component:()=>b(An,{permission:"EmployeeAccess",featureName:"Employee Management",get children(){return b(A2,{})}})}),b(bn,{path:"/bank-consolidations",component:()=>b(An,{permission:"BankingAccess",featureName:"Bank Consolidations",get children(){return b(tI,{})}})}),b(bn,{path:"/balance-sheet",component:()=>b(An,{permission:"AccountAccess",featureName:"Balance Sheet",get children(){return b(Dx,{})}})}),b(bn,{path:"/invoices",component:()=>b(An,{permission:"invoiceAccess",featureName:"Invoices",get children(){return b(XT,{})}})}),b(bn,{path:"/inventory",component:()=>b(An,{permission:"InventoryAccess",featureName:"Inventory Management",get children(){return b(v2,{})}})}),b(bn,{path:"/products",component:()=>b(An,{permission:"InventoryAccess",featureName:"Product Management",get children(){return b(og,{})}})}),b(bn,{path:"/admin/users",component:()=>b(An,{permission:"isAdmin",featureName:"User Administration",get children(){return b(EE,{})}})})]}})),i(t,(()=>{var r=ge(()=>!1);return()=>r()&&b(DC,{})})(),null),t}}),rk=document.getElementById("root");Ng(()=>b(tk,{}),rk);export{Sn as _};
