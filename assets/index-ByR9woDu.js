(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const aS=!1,lS=(t,e)=>t===e,ko=Symbol("solid-proxy"),Eb=typeof Proxy=="function",gh=Symbol("solid-track"),vh={equals:lS};let Tb=Ob;const Ma=1,bh=2,kb={owned:null,cleanups:null,context:null,owner:null};var Qr=null;let jp=null,cS=null,un=null,yi=null,Cs=null,Qh=0;function ml(t,e){const r=un,n=Qr,i=t.length===0,o=e===void 0?n:e,s=i?kb:{owned:null,cleanups:null,context:o?o.context:null,owner:o},l=i?t:()=>t(()=>ji(()=>Eu(s)));Qr=s,un=null;try{return Fa(l,!0)}finally{un=r,Qr=n}}function Ce(t,e){e=e?Object.assign({},vh,e):vh;const r={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},n=i=>(typeof i=="function"&&(i=i(r.value)),Fb(r,i));return[Mb.bind(r),n]}function Se(t,e,r){const n=qm(t,e,!1,Ma);Gu(n)}function gi(t,e,r){Tb=pS;const n=qm(t,e,!1,Ma);n.user=!0,Cs?Cs.push(n):Gu(n)}function Mt(t,e,r){r=r?Object.assign({},vh,r):vh;const n=qm(t,e,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=r.equals||void 0,Gu(n),Mb.bind(n)}function Nb(t){return Fa(t,!1)}function ji(t){if(un===null)return t();const e=un;un=null;try{return t()}finally{un=e}}function Bm(t,e,r){const n=Array.isArray(t);let i,o=r&&r.defer;return s=>{let l;if(n){l=Array(t.length);for(let u=0;u<t.length;u++)l[u]=t[u]()}else l=t();if(o)return o=!1,s;const c=ji(()=>e(l,i,s));return i=l,c}}function wn(t){gi(()=>ji(t))}function El(t){return Qr===null||(Qr.cleanups===null?Qr.cleanups=[t]:Qr.cleanups.push(t)),t}function Vf(){return un}function Lb(){return Qr}function Rb(t,e){const r=Qr,n=un;Qr=t,un=null;try{return Fa(e,!0)}catch(i){zm(i)}finally{Qr=r,un=n}}function uS(t){const e=un,r=Qr;return Promise.resolve().then(()=>{un=e,Qr=r;let n;return Fa(t,!1),un=Qr=null,n?n.done:void 0})}const[V8,q8]=Ce(!1);function Db(t,e){const r=Symbol("context");return{id:r,Provider:mS(r),defaultValue:t}}function jm(t){let e;return Qr&&Qr.context&&(e=Qr.context[t.id])!==void 0?e:t.defaultValue}function Vm(t){const e=Mt(t),r=Mt(()=>qf(e()));return r.toArray=()=>{const n=r();return Array.isArray(n)?n:n!=null?[n]:[]},r}function Mb(){if(this.sources&&this.state)if(this.state===Ma)Gu(this);else{const t=yi;yi=null,Fa(()=>Sh(this),!1),yi=t}if(un){const t=this.observers?this.observers.length:0;un.sources?(un.sources.push(this),un.sourceSlots.push(t)):(un.sources=[this],un.sourceSlots=[t]),this.observers?(this.observers.push(un),this.observerSlots.push(un.sources.length-1)):(this.observers=[un],this.observerSlots=[un.sources.length-1])}return this.value}function Fb(t,e,r){let n=t.value;return(!t.comparator||!t.comparator(n,e))&&(t.value=e,t.observers&&t.observers.length&&Fa(()=>{for(let i=0;i<t.observers.length;i+=1){const o=t.observers[i],s=jp&&jp.running;s&&jp.disposed.has(o),(s?!o.tState:!o.state)&&(o.pure?yi.push(o):Cs.push(o),o.observers&&Bb(o)),s||(o.state=Ma)}if(yi.length>1e6)throw yi=[],new Error},!1)),e}function Gu(t){if(!t.fn)return;Eu(t);const e=Qh;dS(t,t.value,e)}function dS(t,e,r){let n;const i=Qr,o=un;un=Qr=t;try{n=t.fn(e)}catch(s){return t.pure&&(t.state=Ma,t.owned&&t.owned.forEach(Eu),t.owned=null),t.updatedAt=r+1,zm(s)}finally{un=o,Qr=i}(!t.updatedAt||t.updatedAt<=r)&&(t.updatedAt!=null&&"observers"in t?Fb(t,n):t.value=n,t.updatedAt=r)}function qm(t,e,r,n=Ma,i){const o={fn:t,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:Qr,context:Qr?Qr.context:null,pure:r};return Qr===null||Qr!==kb&&(Qr.owned?Qr.owned.push(o):Qr.owned=[o]),o}function _h(t){if(t.state===0)return;if(t.state===bh)return Sh(t);if(t.suspense&&ji(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<Qh);)t.state&&e.push(t);for(let r=e.length-1;r>=0;r--)if(t=e[r],t.state===Ma)Gu(t);else if(t.state===bh){const n=yi;yi=null,Fa(()=>Sh(t,e[0]),!1),yi=n}}function Fa(t,e){if(yi)return t();let r=!1;e||(yi=[]),Cs?r=!0:Cs=[],Qh++;try{const n=t();return hS(r),n}catch(n){r||(Cs=null),yi=null,zm(n)}}function hS(t){if(yi&&(Ob(yi),yi=null),t)return;const e=Cs;Cs=null,e.length&&Fa(()=>Tb(e),!1)}function Ob(t){for(let e=0;e<t.length;e++)_h(t[e])}function pS(t){let e,r=0;for(e=0;e<t.length;e++){const n=t[e];n.user?t[r++]=n:_h(n)}for(e=0;e<r;e++)_h(t[e])}function Sh(t,e){t.state=0;for(let r=0;r<t.sources.length;r+=1){const n=t.sources[r];if(n.sources){const i=n.state;i===Ma?n!==e&&(!n.updatedAt||n.updatedAt<Qh)&&_h(n):i===bh&&Sh(n,e)}}}function Bb(t){for(let e=0;e<t.observers.length;e+=1){const r=t.observers[e];r.state||(r.state=bh,r.pure?yi.push(r):Cs.push(r),r.observers&&Bb(r))}}function Eu(t){let e;if(t.sources)for(;t.sources.length;){const r=t.sources.pop(),n=t.sourceSlots.pop(),i=r.observers;if(i&&i.length){const o=i.pop(),s=r.observerSlots.pop();n<i.length&&(o.sourceSlots[s]=n,i[n]=o,r.observerSlots[n]=s)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)Eu(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)Eu(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function fS(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function zm(t,e=Qr){throw fS(t)}function qf(t){if(typeof t=="function"&&!t.length)return qf(t());if(Array.isArray(t)){const e=[];for(let r=0;r<t.length;r++){const n=qf(t[r]);Array.isArray(n)?e.push.apply(e,n):e.push(n)}return e}return t}function mS(t,e){return function(n){let i;return Se(()=>i=ji(()=>(Qr.context={...Qr.context,[t]:n.value},Vm(()=>n.children))),void 0),i}}const zf=Symbol("fallback");function Ph(t){for(let e=0;e<t.length;e++)t[e]()}function yS(t,e,r={}){let n=[],i=[],o=[],s=0,l=e.length>1?[]:null;return El(()=>Ph(o)),()=>{let c=t()||[],u=c.length,h,y;return c[gh],ji(()=>{let f,x,S,w,E,q,ee,W,K;if(u===0)s!==0&&(Ph(o),o=[],n=[],i=[],s=0,l&&(l=[])),r.fallback&&(n=[zf],i[0]=ml(te=>(o[0]=te,r.fallback())),s=1);else if(s===0){for(i=new Array(u),y=0;y<u;y++)n[y]=c[y],i[y]=ml(g);s=u}else{for(S=new Array(u),w=new Array(u),l&&(E=new Array(u)),q=0,ee=Math.min(s,u);q<ee&&n[q]===c[q];q++);for(ee=s-1,W=u-1;ee>=q&&W>=q&&n[ee]===c[W];ee--,W--)S[W]=i[ee],w[W]=o[ee],l&&(E[W]=l[ee]);for(f=new Map,x=new Array(W+1),y=W;y>=q;y--)K=c[y],h=f.get(K),x[y]=h===void 0?-1:h,f.set(K,y);for(h=q;h<=ee;h++)K=n[h],y=f.get(K),y!==void 0&&y!==-1?(S[y]=i[h],w[y]=o[h],l&&(E[y]=l[h]),y=x[y],f.set(K,y)):o[h]();for(y=q;y<u;y++)y in S?(i[y]=S[y],o[y]=w[y],l&&(l[y]=E[y],l[y](y))):i[y]=ml(g);i=i.slice(0,s=u),n=c.slice(0)}return i});function g(f){if(o[y]=f,l){const[x,S]=Ce(y);return l[y]=S,e(c[y],x)}return e(c[y])}}}function gS(t,e,r={}){let n=[],i=[],o=[],s=[],l=0,c;return El(()=>Ph(o)),()=>{const u=t()||[],h=u.length;return u[gh],ji(()=>{if(h===0)return l!==0&&(Ph(o),o=[],n=[],i=[],l=0,s=[]),r.fallback&&(n=[zf],i[0]=ml(g=>(o[0]=g,r.fallback())),l=1),i;for(n[0]===zf&&(o[0](),o=[],n=[],i=[],l=0),c=0;c<h;c++)c<n.length&&n[c]!==u[c]?s[c](()=>u[c]):c>=n.length&&(i[c]=ml(y));for(;c<n.length;c++)o[c]();return l=s.length=o.length=h,n=u.slice(0),i=i.slice(0,l)});function y(g){o[c]=g;const[f,x]=Ce(u[c]);return s[c]=x,e(f,c)}}}function R(t,e){return ji(()=>t(e||{}))}function kd(){return!0}const Uf={get(t,e,r){return e===ko?r:t.get(e)},has(t,e){return e===ko?!0:t.has(e)},set:kd,deleteProperty:kd,getOwnPropertyDescriptor(t,e){return{configurable:!0,enumerable:!0,get(){return t.get(e)},set:kd,deleteProperty:kd}},ownKeys(t){return t.keys()}};function Vp(t){return(t=typeof t=="function"?t():t)?t:{}}function vS(){for(let t=0,e=this.length;t<e;++t){const r=this[t]();if(r!==void 0)return r}}function Hf(...t){let e=!1;for(let s=0;s<t.length;s++){const l=t[s];e=e||!!l&&ko in l,t[s]=typeof l=="function"?(e=!0,Mt(l)):l}if(Eb&&e)return new Proxy({get(s){for(let l=t.length-1;l>=0;l--){const c=Vp(t[l])[s];if(c!==void 0)return c}},has(s){for(let l=t.length-1;l>=0;l--)if(s in Vp(t[l]))return!0;return!1},keys(){const s=[];for(let l=0;l<t.length;l++)s.push(...Object.keys(Vp(t[l])));return[...new Set(s)]}},Uf);const r={},n=Object.create(null);for(let s=t.length-1;s>=0;s--){const l=t[s];if(!l)continue;const c=Object.getOwnPropertyNames(l);for(let u=c.length-1;u>=0;u--){const h=c[u];if(h==="__proto__"||h==="constructor")continue;const y=Object.getOwnPropertyDescriptor(l,h);if(!n[h])n[h]=y.get?{enumerable:!0,configurable:!0,get:vS.bind(r[h]=[y.get.bind(l)])}:y.value!==void 0?y:void 0;else{const g=r[h];g&&(y.get?g.push(y.get.bind(l)):y.value!==void 0&&g.push(()=>y.value))}}}const i={},o=Object.keys(n);for(let s=o.length-1;s>=0;s--){const l=o[s],c=n[l];c&&c.get?Object.defineProperty(i,l,c):i[l]=c?c.value:void 0}return i}function bS(t,...e){if(Eb&&ko in t){const i=new Set(e.length>1?e.flat():e[0]),o=e.map(s=>new Proxy({get(l){return s.includes(l)?t[l]:void 0},has(l){return s.includes(l)&&l in t},keys(){return s.filter(l=>l in t)}},Uf));return o.push(new Proxy({get(s){return i.has(s)?void 0:t[s]},has(s){return i.has(s)?!1:s in t},keys(){return Object.keys(t).filter(s=>!i.has(s))}},Uf)),o}const r={},n=e.map(()=>({}));for(const i of Object.getOwnPropertyNames(t)){const o=Object.getOwnPropertyDescriptor(t,i),s=!o.get&&!o.set&&o.enumerable&&o.writable&&o.configurable;let l=!1,c=0;for(const u of e)u.includes(i)&&(l=!0,s?n[c][i]=o.value:Object.defineProperty(n[c],i,o)),++c;l||(s?r[i]=o.value:Object.defineProperty(r,i,o))}return[...n,r]}const _S=t=>`Stale read from <${t}>.`;function Ut(t){const e="fallback"in t&&{fallback:()=>t.fallback};return Mt(yS(()=>t.each,t.children,e||void 0))}function SS(t){const e="fallback"in t&&{fallback:()=>t.fallback};return Mt(gS(()=>t.each,t.children,e||void 0))}function ze(t){const e=t.keyed,r=Mt(()=>t.when,void 0,void 0),n=e?r:Mt(r,void 0,{equals:(i,o)=>!i==!o});return Mt(()=>{const i=n();if(i){const o=t.children;return typeof o=="function"&&o.length>0?ji(()=>o(e?i:()=>{if(!ji(n))throw _S("Show");return r()})):o}return t.fallback},void 0,void 0)}const PS=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],wS=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline",...PS]),xS=new Set(["innerHTML","textContent","innerText","children"]),AS=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),CS=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}});function IS(t,e){const r=CS[t];return typeof r=="object"?r[e]?r.$:void 0:r}const $S=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),Ee=t=>Mt(()=>t());function ES(t,e,r){let n=r.length,i=e.length,o=n,s=0,l=0,c=e[i-1].nextSibling,u=null;for(;s<i||l<o;){if(e[s]===r[l]){s++,l++;continue}for(;e[i-1]===r[o-1];)i--,o--;if(i===s){const h=o<n?l?r[l-1].nextSibling:r[o-l]:c;for(;l<o;)t.insertBefore(r[l++],h)}else if(o===l)for(;s<i;)(!u||!u.has(e[s]))&&e[s].remove(),s++;else if(e[s]===r[o-1]&&r[l]===e[i-1]){const h=e[--i].nextSibling;t.insertBefore(r[l++],e[s++].nextSibling),t.insertBefore(r[--o],h),e[i]=r[o]}else{if(!u){u=new Map;let y=l;for(;y<o;)u.set(r[y],y++)}const h=u.get(e[s]);if(h!=null)if(l<h&&h<o){let y=s,g=1,f;for(;++y<i&&y<o&&!((f=u.get(e[y]))==null||f!==h+g);)g++;if(g>h-l){const x=e[s];for(;l<h;)t.insertBefore(r[l++],x)}else t.replaceChild(r[l++],e[s++])}else s++;else e[s++].remove()}}}const Cg="_$DX_DELEGATE";function TS(t,e,r,n={}){let i;return ml(o=>{i=o,e===document?t():a(e,t(),e.firstChild?null:void 0,r)},n.owner),()=>{i(),e.textContent=""}}function he(t,e,r,n){let i;const o=()=>{const l=n?document.createElementNS("http://www.w3.org/1998/Math/MathML","template"):document.createElement("template");return l.innerHTML=t,r?l.content.firstChild.firstChild:n?l.firstChild:l.content.firstChild},s=e?()=>ji(()=>document.importNode(i||(i=o()),!0)):()=>(i||(i=o())).cloneNode(!0);return s.cloneNode=s,s}function br(t,e=window.document){const r=e[Cg]||(e[Cg]=new Set);for(let n=0,i=t.length;n<i;n++){const o=t[n];r.has(o)||(r.add(o),e.addEventListener(o,FS))}}function tr(t,e,r){r==null?t.removeAttribute(e):t.setAttribute(e,r)}function kS(t,e,r){r?t.setAttribute(e,""):t.removeAttribute(e)}function Um(t,e){e==null?t.removeAttribute("class"):t.className=e}function is(t,e,r,n){if(n)Array.isArray(r)?(t[`$$${e}`]=r[0],t[`$$${e}Data`]=r[1]):t[`$$${e}`]=r;else if(Array.isArray(r)){const i=r[0];t.addEventListener(e,r[0]=o=>i.call(t,r[1],o))}else t.addEventListener(e,r,typeof r!="function"&&r)}function NS(t,e,r={}){const n=Object.keys(e||{}),i=Object.keys(r);let o,s;for(o=0,s=i.length;o<s;o++){const l=i[o];!l||l==="undefined"||e[l]||(Ig(t,l,!1),delete r[l])}for(o=0,s=n.length;o<s;o++){const l=n[o],c=!!e[l];!l||l==="undefined"||r[l]===c||!c||(Ig(t,l,!0),r[l]=c)}return r}function m(t,e,r){if(!e)return r?tr(t,"style"):e;const n=t.style;if(typeof e=="string")return n.cssText=e;typeof r=="string"&&(n.cssText=r=void 0),r||(r={}),e||(e={});let i,o;for(o in r)e[o]==null&&n.removeProperty(o),delete r[o];for(o in e)i=e[o],i!==r[o]&&(n.setProperty(o,i),r[o]=i);return r}function LS(t,e={},r,n){const i={};return Se(()=>i.children=Tu(t,e.children,i.children)),Se(()=>typeof e.ref=="function"&&RS(e.ref,t)),Se(()=>DS(t,e,r,!0,i,!0)),i}function RS(t,e,r){return ji(()=>t(e,r))}function a(t,e,r,n){if(r!==void 0&&!n&&(n=[]),typeof e!="function")return Tu(t,e,n,r);Se(i=>Tu(t,e(),i,r),n)}function DS(t,e,r,n,i={},o=!1){e||(e={});for(const s in i)if(!(s in e)){if(s==="children")continue;i[s]=$g(t,s,null,i[s],r,o,e)}for(const s in e){if(s==="children")continue;const l=e[s];i[s]=$g(t,s,l,i[s],r,o,e)}}function MS(t){return t.toLowerCase().replace(/-([a-z])/g,(e,r)=>r.toUpperCase())}function Ig(t,e,r){const n=e.trim().split(/\s+/);for(let i=0,o=n.length;i<o;i++)t.classList.toggle(n[i],r)}function $g(t,e,r,n,i,o,s){let l,c,u,h,y;if(e==="style")return m(t,r,n);if(e==="classList")return NS(t,r,n);if(r===n)return n;if(e==="ref")o||r(t);else if(e.slice(0,3)==="on:"){const g=e.slice(3);n&&t.removeEventListener(g,n,typeof n!="function"&&n),r&&t.addEventListener(g,r,typeof r!="function"&&r)}else if(e.slice(0,10)==="oncapture:"){const g=e.slice(10);n&&t.removeEventListener(g,n,!0),r&&t.addEventListener(g,r,!0)}else if(e.slice(0,2)==="on"){const g=e.slice(2).toLowerCase(),f=$S.has(g);if(!f&&n){const x=Array.isArray(n)?n[0]:n;t.removeEventListener(g,x)}(f||r)&&(is(t,g,r,f),f&&br([g]))}else e.slice(0,5)==="attr:"?tr(t,e.slice(5),r):e.slice(0,5)==="bool:"?kS(t,e.slice(5),r):(y=e.slice(0,5)==="prop:")||(u=xS.has(e))||(h=IS(e,t.tagName))||(c=wS.has(e))||(l=t.nodeName.includes("-")||"is"in s)?(y&&(e=e.slice(5),c=!0),e==="class"||e==="className"?Um(t,r):l&&!c&&!u?t[MS(e)]=r:t[h||e]=r):tr(t,AS[e]||e,r);return r}function FS(t){let e=t.target;const r=`$$${t.type}`,n=t.target,i=t.currentTarget,o=c=>Object.defineProperty(t,"target",{configurable:!0,value:c}),s=()=>{const c=e[r];if(c&&!e.disabled){const u=e[`${r}Data`];if(u!==void 0?c.call(e,u,t):c.call(e,t),t.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(t.target)&&o(e.host),!0},l=()=>{for(;s()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return e||document}}),t.composedPath){const c=t.composedPath();o(c[0]);for(let u=0;u<c.length-2&&(e=c[u],!!s());u++){if(e._$host){e=e._$host,l();break}if(e.parentNode===i)break}}else l();o(n)}function Tu(t,e,r,n,i){for(;typeof r=="function";)r=r();if(e===r)return r;const o=typeof e,s=n!==void 0;if(t=s&&r[0]&&r[0].parentNode||t,o==="string"||o==="number"){if(o==="number"&&(e=e.toString(),e===r))return r;if(s){let l=r[0];l&&l.nodeType===3?l.data!==e&&(l.data=e):l=document.createTextNode(e),r=Zl(t,r,n,l)}else r!==""&&typeof r=="string"?r=t.firstChild.data=e:r=t.textContent=e}else if(e==null||o==="boolean")r=Zl(t,r,n);else{if(o==="function")return Se(()=>{let l=e();for(;typeof l=="function";)l=l();r=Tu(t,l,r,n)}),()=>r;if(Array.isArray(e)){const l=[],c=r&&Array.isArray(r);if(Gf(l,e,r,i))return Se(()=>r=Tu(t,l,r,n,!0)),()=>r;if(l.length===0){if(r=Zl(t,r,n),s)return r}else c?r.length===0?Eg(t,l,n):ES(t,r,l):(r&&Zl(t),Eg(t,l));r=l}else if(e.nodeType){if(Array.isArray(r)){if(s)return r=Zl(t,r,n,e);Zl(t,r,null,e)}else r==null||r===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);r=e}}return r}function Gf(t,e,r,n){let i=!1;for(let o=0,s=e.length;o<s;o++){let l=e[o],c=r&&r[t.length],u;if(!(l==null||l===!0||l===!1))if((u=typeof l)=="object"&&l.nodeType)t.push(l);else if(Array.isArray(l))i=Gf(t,l,c)||i;else if(u==="function")if(n){for(;typeof l=="function";)l=l();i=Gf(t,Array.isArray(l)?l:[l],Array.isArray(c)?c:[c])||i}else t.push(l),i=!0;else{const h=String(l);c&&c.nodeType===3&&c.data===h?t.push(c):t.push(document.createTextNode(h))}}return i}function Eg(t,e,r=null){for(let n=0,i=e.length;n<i;n++)t.insertBefore(e[n],r)}function Zl(t,e,r,n){if(r===void 0)return t.textContent="";const i=n||document.createTextNode("");if(e.length){let o=!1;for(let s=e.length-1;s>=0;s--){const l=e[s];if(i!==l){const c=l.parentNode===t;!o&&!s?c?t.replaceChild(i,l):t.insertBefore(i,r):c&&l.remove()}else o=!0}}else t.insertBefore(i,r);return[i]}const OS=!1;function jb(){let t=new Set;function e(i){return t.add(i),()=>t.delete(i)}let r=!1;function n(i,o){if(r)return!(r=!1);const s={to:i,options:o,defaultPrevented:!1,preventDefault:()=>s.defaultPrevented=!0};for(const l of t)l.listener({...s,from:l.location,retry:c=>{c&&(r=!0),l.navigate(i,{...o,resolve:!1})}});return!s.defaultPrevented}return{subscribe:e,confirm:n}}let Wf;function Hm(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),Wf=window.history.state._depth}Hm();function BS(t){return{...t,_depth:window.history.state&&window.history.state._depth}}function jS(t,e){let r=!1;return()=>{const n=Wf;Hm();const i=n==null?null:Wf-n;if(r){r=!1;return}i&&e(i)?(r=!0,window.history.go(-i)):t()}}const VS=/^(?:[a-z0-9]+:)?\/\//i,qS=/^\/+|(\/)\/+$/g,Vb="http://sr";function yl(t,e=!1){const r=t.replace(qS,"$1");return r?e||/^[?#]/.test(r)?r:"/"+r:""}function rh(t,e,r){if(VS.test(e))return;const n=yl(t),i=r&&yl(r);let o="";return!i||e.startsWith("/")?o=n:i.toLowerCase().indexOf(n.toLowerCase())!==0?o=n+i:o=i,(o||"/")+yl(e,!o)}function zS(t,e){if(t==null)throw new Error(e);return t}function US(t,e){return yl(t).replace(/\/*(\*.*)?$/g,"")+yl(e)}function qb(t){const e={};return t.searchParams.forEach((r,n)=>{n in e?Array.isArray(e[n])?e[n].push(r):e[n]=[e[n],r]:e[n]=r}),e}function HS(t,e,r){const[n,i]=t.split("/*",2),o=n.split("/").filter(Boolean),s=o.length;return l=>{const c=l.split("/").filter(Boolean),u=c.length-s;if(u<0||u>0&&i===void 0&&!e)return null;const h={path:s?"":"/",params:{}},y=g=>r===void 0?void 0:r[g];for(let g=0;g<s;g++){const f=o[g],x=f[0]===":",S=x?c[g]:c[g].toLowerCase(),w=x?f.slice(1):f.toLowerCase();if(x&&qp(S,y(w)))h.params[w]=S;else if(x||!qp(S,w))return null;h.path+=`/${S}`}if(i){const g=u?c.slice(-u).join("/"):"";if(qp(g,y(i)))h.params[i]=g;else return null}return h}}function qp(t,e){const r=n=>n===t;return e===void 0?!0:typeof e=="string"?r(e):typeof e=="function"?e(t):Array.isArray(e)?e.some(r):e instanceof RegExp?e.test(t):!1}function GS(t){const[e,r]=t.pattern.split("/*",2),n=e.split("/").filter(Boolean);return n.reduce((i,o)=>i+(o.startsWith(":")?2:3),n.length-(r===void 0?0:1))}function zb(t){const e=new Map,r=Lb();return new Proxy({},{get(n,i){return e.has(i)||Rb(r,()=>e.set(i,Mt(()=>t()[i]))),e.get(i)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(t())}})}function Ub(t){let e=/(\/?\:[^\/]+)\?/.exec(t);if(!e)return[t];let r=t.slice(0,e.index),n=t.slice(e.index+e[0].length);const i=[r,r+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(n);)i.push(r+=e[1]),n=n.slice(e[0].length);return Ub(n).reduce((o,s)=>[...o,...i.map(l=>l+s)],[])}const WS=100,Hb=Db(),Gm=Db(),Wu=()=>zS(jm(Hb),"<A> and 'use' router primitives can be only used inside a Route."),YS=()=>jm(Gm)||Wu().base,KS=t=>{const e=YS();return Mt(()=>e.resolvePath(t()))},JS=t=>{const e=Wu();return Mt(()=>{const r=t();return r!==void 0?e.renderPath(r):r})},Wm=()=>Wu().navigatorFactory(),QS=()=>Wu().location,XS=()=>Wu().params;function ZS(t,e=""){const{component:r,preload:n,load:i,children:o,info:s}=t,l=!o||Array.isArray(o)&&!o.length,c={key:t,component:r,preload:n||i,info:s};return Gb(t.path).reduce((u,h)=>{for(const y of Ub(h)){const g=US(e,y);let f=l?g:g.split("/*",1)[0];f=f.split("/").map(x=>x.startsWith(":")||x.startsWith("*")?x:encodeURIComponent(x)).join("/"),u.push({...c,originalPath:h,pattern:f,matcher:HS(f,!l,t.matchFilters)})}return u},[])}function eP(t,e=0){return{routes:t,score:GS(t[t.length-1])*1e4-e,matcher(r){const n=[];for(let i=t.length-1;i>=0;i--){const o=t[i],s=o.matcher(r);if(!s)return null;n.unshift({...s,route:o})}return n}}}function Gb(t){return Array.isArray(t)?t:[t]}function Wb(t,e="",r=[],n=[]){const i=Gb(t);for(let o=0,s=i.length;o<s;o++){const l=i[o];if(l&&typeof l=="object"){l.hasOwnProperty("path")||(l.path="");const c=ZS(l,e);for(const u of c){r.push(u);const h=Array.isArray(l.children)&&l.children.length===0;if(l.children&&!h)Wb(l.children,u.pattern,r,n);else{const y=eP([...r],n.length);n.push(y)}r.pop()}}}return r.length?n:n.sort((o,s)=>s.score-o.score)}function zp(t,e){for(let r=0,n=t.length;r<n;r++){const i=t[r].matcher(e);if(i)return i}return[]}function tP(t,e,r){const n=new URL(Vb),i=Mt(h=>{const y=t();try{return new URL(y,n)}catch{return console.error(`Invalid path ${y}`),h}},n,{equals:(h,y)=>h.href===y.href}),o=Mt(()=>i().pathname),s=Mt(()=>i().search,!0),l=Mt(()=>i().hash),c=()=>"",u=Bm(s,()=>qb(i()));return{get pathname(){return o()},get search(){return s()},get hash(){return l()},get state(){return e()},get key(){return c()},query:r?r(u):zb(u)}}let al;function rP(){return al}function nP(t,e,r,n={}){const{signal:[i,o],utils:s={}}=t,l=s.parsePath||(z=>z),c=s.renderPath||(z=>z),u=s.beforeLeave||jb(),h=rh("",n.base||"");if(h===void 0)throw new Error(`${h} is not a valid base path`);h&&!i().value&&o({value:h,replace:!0,scroll:!1});const[y,g]=Ce(!1);let f;const x=(z,Z)=>{Z.value===S()&&Z.state===E()||(f===void 0&&g(!0),al=z,f=Z,uS(()=>{f===Z&&(w(f.value),q(f.state),K[1](k=>k.filter(F=>F.pending)))}).finally(()=>{f===Z&&Nb(()=>{al=void 0,z==="navigate"&&P(f),g(!1),f=void 0})}))},[S,w]=Ce(i().value),[E,q]=Ce(i().state),ee=tP(S,E,s.queryWrapper),W=[],K=Ce([]),te=Mt(()=>typeof n.transformUrl=="function"?zp(e(),n.transformUrl(ee.pathname)):zp(e(),ee.pathname)),$=()=>{const z=te(),Z={};for(let k=0;k<z.length;k++)Object.assign(Z,z[k].params);return Z},C=s.paramsWrapper?s.paramsWrapper($,e):zb($),T={pattern:h,path:()=>h,outlet:()=>null,resolvePath(z){return rh(h,z)}};return Se(Bm(i,z=>x("native",z),{defer:!0})),{base:T,location:ee,params:C,isRouting:y,renderPath:c,parsePath:l,navigatorFactory:b,matches:te,beforeLeave:u,preloadRoute:_,singleFlight:n.singleFlight===void 0?!0:n.singleFlight,submissions:K};function O(z,Z,k){ji(()=>{if(typeof Z=="number"){Z&&(s.go?s.go(Z):console.warn("Router integration does not support relative routing"));return}const F=!Z||Z[0]==="?",{replace:X,resolve:U,scroll:B,state:ce}={replace:!1,resolve:!F,scroll:!0,...k},L=U?z.resolvePath(Z):rh(F&&ee.pathname||"",Z);if(L===void 0)throw new Error(`Path '${Z}' is not a routable path`);if(W.length>=WS)throw new Error("Too many redirects");const D=S();(L!==D||ce!==E())&&(OS||u.confirm(L,k)&&(W.push({value:D,replace:X,scroll:B,state:E()}),x("navigate",{value:L,state:ce})))})}function b(z){return z=z||jm(Gm)||T,(Z,k)=>O(z,Z,k)}function P(z){const Z=W[0];Z&&(o({...z,replace:Z.replace,scroll:Z.scroll}),W.length=0)}function _(z,Z){const k=zp(e(),z.pathname),F=al;al="preload";for(let X in k){const{route:U,params:B}=k[X];U.component&&U.component.preload&&U.component.preload();const{preload:ce}=U;Z&&ce&&Rb(r(),()=>ce({params:B,location:{pathname:z.pathname,search:z.search,hash:z.hash,query:qb(z),state:null,key:""},intent:"preload"}))}al=F}}function iP(t,e,r,n){const{base:i,location:o,params:s}=t,{pattern:l,component:c,preload:u}=n().route,h=Mt(()=>n().path);c&&c.preload&&c.preload();const y=u?u({params:s,location:o,intent:al||"initial"}):void 0;return{parent:e,pattern:l,path:h,outlet:()=>c?R(c,{params:s,location:o,data:y,get children(){return r()}}):r(),resolvePath(f){return rh(i.path(),f,h())}}}const oP=t=>e=>{const{base:r}=e,n=Vm(()=>e.children),i=Mt(()=>Wb(n(),e.base||""));let o;const s=nP(t,i,()=>o,{base:r,singleFlight:e.singleFlight,transformUrl:e.transformUrl});return t.create&&t.create(s),R(Hb.Provider,{value:s,get children(){return R(sP,{routerState:s,get root(){return e.root},get preload(){return e.rootPreload||e.rootLoad},get children(){return[Ee(()=>(o=Lb())&&null),R(aP,{routerState:s,get branches(){return i()}})]}})}})};function sP(t){const e=t.routerState.location,r=t.routerState.params,n=Mt(()=>t.preload&&ji(()=>{t.preload({params:r,location:e,intent:rP()||"initial"})}));return R(ze,{get when(){return t.root},keyed:!0,get fallback(){return t.children},children:i=>R(i,{params:r,location:e,get data(){return n()},get children(){return t.children}})})}function aP(t){const e=[];let r;const n=Mt(Bm(t.routerState.matches,(i,o,s)=>{let l=o&&i.length===o.length;const c=[];for(let u=0,h=i.length;u<h;u++){const y=o&&o[u],g=i[u];s&&y&&g.route.key===y.route.key?c[u]=s[u]:(l=!1,e[u]&&e[u](),ml(f=>{e[u]=f,c[u]=iP(t.routerState,c[u-1]||t.routerState.base,Tg(()=>n()[u+1]),()=>t.routerState.matches()[u])}))}return e.splice(i.length).forEach(u=>u()),s&&l?s:(r=c[0],c)}));return Tg(()=>n()&&r)()}const Tg=t=>()=>R(ze,{get when(){return t()},keyed:!0,children:e=>R(Gm.Provider,{value:e,get children(){return e.outlet()}})}),uo=t=>{const e=Vm(()=>t.children);return Hf(t,{get children(){return e()}})};function lP([t,e],r,n){return[t,n?i=>e(n(i)):e]}function cP(t){let e=!1;const r=i=>typeof i=="string"?{value:i}:i,n=lP(Ce(r(t.get()),{equals:(i,o)=>i.value===o.value&&i.state===o.state}),void 0,i=>(!e&&t.set(i),i));return t.init&&El(t.init((i=t.get())=>{e=!0,n[1](r(i)),e=!1})),oP({signal:n,create:t.create,utils:t.utils})}function uP(t,e,r){return t.addEventListener(e,r),()=>t.removeEventListener(e,r)}function dP(t,e){const r=t&&document.getElementById(t);r?r.scrollIntoView():e&&window.scrollTo(0,0)}const hP=new Map;function pP(t=!0,e=!1,r="/_server",n){return i=>{const o=i.base.path(),s=i.navigatorFactory(i.base);let l,c;function u(S){return S.namespaceURI==="http://www.w3.org/2000/svg"}function h(S){if(S.defaultPrevented||S.button!==0||S.metaKey||S.altKey||S.ctrlKey||S.shiftKey)return;const w=S.composedPath().find(te=>te instanceof Node&&te.nodeName.toUpperCase()==="A");if(!w||e&&!w.hasAttribute("link"))return;const E=u(w),q=E?w.href.baseVal:w.href;if((E?w.target.baseVal:w.target)||!q&&!w.hasAttribute("state"))return;const W=(w.getAttribute("rel")||"").split(/\s+/);if(w.hasAttribute("download")||W&&W.includes("external"))return;const K=E?new URL(q,document.baseURI):new URL(q);if(!(K.origin!==window.location.origin||o&&K.pathname&&!K.pathname.toLowerCase().startsWith(o.toLowerCase())))return[w,K]}function y(S){const w=h(S);if(!w)return;const[E,q]=w,ee=i.parsePath(q.pathname+q.search+q.hash),W=E.getAttribute("state");S.preventDefault(),s(ee,{resolve:!1,replace:E.hasAttribute("replace"),scroll:!E.hasAttribute("noscroll"),state:W?JSON.parse(W):void 0})}function g(S){const w=h(S);if(!w)return;const[E,q]=w;i.preloadRoute(q,E.getAttribute("preload")!=="false")}function f(S){clearTimeout(l);const w=h(S);if(!w)return c=null;const[E,q]=w;c!==E&&(l=setTimeout(()=>{i.preloadRoute(q,E.getAttribute("preload")!=="false"),c=E},20))}function x(S){if(S.defaultPrevented)return;let w=S.submitter&&S.submitter.hasAttribute("formaction")?S.submitter.getAttribute("formaction"):S.target.getAttribute("action");if(!w)return;if(!w.startsWith("https://action/")){const q=new URL(w,Vb);if(w=i.parsePath(q.pathname+q.search),!w.startsWith(r))return}if(S.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const E=hP.get(w);if(E){S.preventDefault();const q=new FormData(S.target,S.submitter);E.call({r:i,f:S.target},S.target.enctype==="multipart/form-data"?q:new URLSearchParams(q))}}br(["click","submit"]),document.addEventListener("click",y),t&&(document.addEventListener("mousemove",f,{passive:!0}),document.addEventListener("focusin",g,{passive:!0}),document.addEventListener("touchstart",g,{passive:!0})),document.addEventListener("submit",x),El(()=>{document.removeEventListener("click",y),t&&(document.removeEventListener("mousemove",f),document.removeEventListener("focusin",g),document.removeEventListener("touchstart",g)),document.removeEventListener("submit",x)})}}function fP(t){const e=t.replace(/^.*?#/,"");if(!e.startsWith("/")){const[,r="/"]=window.location.hash.split("#",2);return`${r}#${e}`}return e}function mP(t){const e=()=>window.location.hash.slice(1),r=jb();return cP({get:e,set({value:n,replace:i,scroll:o,state:s}){i?window.history.replaceState(BS(s),"","#"+n):window.history.pushState(s,"","#"+n);const l=n.indexOf("#"),c=l>=0?n.slice(l+1):"";dP(c,o),Hm()},init:n=>uP(window,"hashchange",jS(n,i=>!r.confirm(i&&i<0?i:e()))),create:pP(t.preload,t.explicitLinks,t.actionBase),utils:{go:n=>window.history.go(n),renderPath:n=>`#${n}`,parsePath:fP,beforeLeave:r}})(t)}var yP=he("<a>");function sc(t){t=Hf({inactiveClass:"inactive",activeClass:"active"},t);const[,e]=bS(t,["href","state","class","activeClass","inactiveClass","end"]),r=KS(()=>t.href),n=JS(r),i=QS(),o=Mt(()=>{const s=r();if(s===void 0)return[!1,!1];const l=yl(s.split(/[?#]/,1)[0]).toLowerCase(),c=decodeURI(yl(i.pathname).toLowerCase());return[t.end?l===c:c.startsWith(l+"/")||c===l,l===c]});return(()=>{var s=yP();return LS(s,Hf(e,{get href(){return n()||t.href},get state(){return JSON.stringify(t.state)},get classList(){return{...t.class&&{[t.class]:!0},[t.inactiveClass]:!o()[0],[t.activeClass]:o()[0],...e.classList}},link:"",get"aria-current"(){return o()[1]?"page":void 0}}),!1),s})()}const Yf=Symbol("store-raw"),pc=Symbol("store-node"),Ps=Symbol("store-has"),Yb=Symbol("store-self");function Kb(t){let e=t[ko];if(!e&&(Object.defineProperty(t,ko,{value:e=new Proxy(t,bP)}),!Array.isArray(t))){const r=Object.keys(t),n=Object.getOwnPropertyDescriptors(t);for(let i=0,o=r.length;i<o;i++){const s=r[i];n[s].get&&Object.defineProperty(t,s,{enumerable:n[s].enumerable,get:n[s].get.bind(e)})}}return e}function wh(t){let e;return t!=null&&typeof t=="object"&&(t[ko]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function ku(t,e=new Set){let r,n,i,o;if(r=t!=null&&t[Yf])return r;if(!wh(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let s=0,l=t.length;s<l;s++)i=t[s],(n=ku(i,e))!==i&&(t[s]=n)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const s=Object.keys(t),l=Object.getOwnPropertyDescriptors(t);for(let c=0,u=s.length;c<u;c++)o=s[c],!l[o].get&&(i=t[o],(n=ku(i,e))!==i&&(t[o]=n))}return t}function xh(t,e){let r=t[e];return r||Object.defineProperty(t,e,{value:r=Object.create(null)}),r}function Nu(t,e,r){if(t[e])return t[e];const[n,i]=Ce(r,{equals:!1,internal:!0});return n.$=i,t[e]=n}function gP(t,e){const r=Reflect.getOwnPropertyDescriptor(t,e);return!r||r.get||!r.configurable||e===ko||e===pc||(delete r.value,delete r.writable,r.get=()=>t[ko][e]),r}function Jb(t){Vf()&&Nu(xh(t,pc),Yb)()}function vP(t){return Jb(t),Reflect.ownKeys(t)}const bP={get(t,e,r){if(e===Yf)return t;if(e===ko)return r;if(e===gh)return Jb(t),r;const n=xh(t,pc),i=n[e];let o=i?i():t[e];if(e===pc||e===Ps||e==="__proto__")return o;if(!i){const s=Object.getOwnPropertyDescriptor(t,e);Vf()&&(typeof o!="function"||t.hasOwnProperty(e))&&!(s&&s.get)&&(o=Nu(n,e,o)())}return wh(o)?Kb(o):o},has(t,e){return e===Yf||e===ko||e===gh||e===pc||e===Ps||e==="__proto__"?!0:(Vf()&&Nu(xh(t,Ps),e)(),e in t)},set(){return!0},deleteProperty(){return!0},ownKeys:vP,getOwnPropertyDescriptor:gP};function Ah(t,e,r,n=!1){if(!n&&t[e]===r)return;const i=t[e],o=t.length;r===void 0?(delete t[e],t[Ps]&&t[Ps][e]&&i!==void 0&&t[Ps][e].$()):(t[e]=r,t[Ps]&&t[Ps][e]&&i===void 0&&t[Ps][e].$());let s=xh(t,pc),l;if((l=Nu(s,e,i))&&l.$(()=>r),Array.isArray(t)&&t.length!==o){for(let c=t.length;c<o;c++)(l=s[c])&&l.$();(l=Nu(s,"length",o))&&l.$(t.length)}(l=s[Yb])&&l.$()}function Qb(t,e){const r=Object.keys(e);for(let n=0;n<r.length;n+=1){const i=r[n];Ah(t,i,e[i])}}function _P(t,e){if(typeof e=="function"&&(e=e(t)),e=ku(e),Array.isArray(e)){if(t===e)return;let r=0,n=e.length;for(;r<n;r++){const i=e[r];t[r]!==i&&Ah(t,r,i)}Ah(t,"length",n)}else Qb(t,e)}function cu(t,e,r=[]){let n,i=t;if(e.length>1){n=e.shift();const s=typeof n,l=Array.isArray(t);if(Array.isArray(n)){for(let c=0;c<n.length;c++)cu(t,[n[c]].concat(e),r);return}else if(l&&s==="function"){for(let c=0;c<t.length;c++)n(t[c],c)&&cu(t,[c].concat(e),r);return}else if(l&&s==="object"){const{from:c=0,to:u=t.length-1,by:h=1}=n;for(let y=c;y<=u;y+=h)cu(t,[y].concat(e),r);return}else if(e.length>1){cu(t[n],e,[n].concat(r));return}i=t[n],r=[n].concat(r)}let o=e[0];typeof o=="function"&&(o=o(i,r),o===i)||n===void 0&&o==null||(o=ku(o),n===void 0||wh(i)&&wh(o)&&!Array.isArray(o)?Qb(i,o):Ah(t,n,o))}function Yu(...[t,e]){const r=ku(t||{}),n=Array.isArray(r),i=Kb(r);function o(...s){Nb(()=>{n&&s.length===1?_P(r,s[0]):cu(r,s)})}return[i,o]}const Jr=(t=300+Math.random()*700)=>new Promise(e=>setTimeout(e,t)),tl=(t="")=>`${t}${Date.now()}-${Math.random().toString(36).substr(2,9)}`;let Ht={products:[{id:"prod-001",name:"Wireless Headphones",sku:"WH-001",productCode:"WH-001",productName:"Wireless Headphones",description:"High-quality wireless bluetooth headphones",category:"Electronics",unitOfMeasure:"pcs",unitCost:45,sellingPrice:89.99,minStockLevel:10,maxStockLevel:100,isActive:!0,createdDate:"2024-01-15T10:00:00Z",lastModified:"2024-01-15T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-002",name:"USB-C Cable",sku:"USB-001",description:"3ft USB-C charging cable",category:"Accessories",unitOfMeasure:"pcs",unitCost:8.5,sellingPrice:19.99,minStockLevel:25,maxStockLevel:200,isActive:!0,createdDate:"2024-01-16T10:00:00Z",lastModified:"2024-01-16T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-003",name:"Laptop Stand",sku:"LS-001",description:"Adjustable aluminum laptop stand",category:"Office",unitOfMeasure:"pcs",unitCost:25,sellingPrice:49.99,minStockLevel:5,maxStockLevel:50,isActive:!0,createdDate:"2024-01-17T10:00:00Z",lastModified:"2024-01-17T10:00:00Z",businessId:"YB100423253156428"}],locations:[{id:"loc-001",name:"Main Warehouse",code:"WH-001",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-002",name:"Retail Store - Downtown",code:"ST-001",type:"store",address:"456 Main St, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-003",name:"Retail Store - Mall",code:"ST-002",type:"store",address:"789 Mall Blvd, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"}],movements:[{id:"mov-001",productId:"prod-001",productName:"Wireless Headphones",productSku:"WH-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:50,unitCost:45,totalCost:2250,referenceNumber:"PO-001",notes:"Initial stock purchase",createdBy:"admin",createdDate:"2024-01-15T10:00:00Z",invoiceId:"INV-1000001"},{id:"mov-002",productId:"prod-002",productName:"USB-C Cable",productSku:"USB-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:100,unitCost:8.5,totalCost:850,referenceNumber:"PO-001",notes:"Bulk purchase",createdBy:"admin",createdDate:"2024-01-15T10:05:00Z",invoiceId:"INV-1000001"}],accounts:[{id:"acc-001",accountNumber:"1000",accountName:"Cash",accountType:"asset",category:"currentAssets",balance:5e4,parentAccountId:null,description:"Cash and cash equivalents",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"},{id:"acc-002",accountNumber:"1100",accountName:"Accounts Receivable",accountType:"asset",category:"currentAssets",balance:25e3,parentAccountId:null,description:"Money owed by customers",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"}],journalEntries:[{id:"je-001",entryNumber:"JE-001",date:"2024-01-15",description:"Initial cash deposit",reference:"DEP-001",status:"posted",createdBy:"admin",createdAt:"2024-01-15T10:00:00Z",postedAt:"2024-01-15T10:05:00Z",lines:[{id:"jel-001",accountId:"acc-001",accountName:"Cash",description:"Initial deposit",debitAmount:5e4,creditAmount:0},{id:"jel-002",accountId:"acc-003",accountName:"Owner Equity",description:"Initial capital",debitAmount:0,creditAmount:5e4}]}]};const Ln=(t=.05)=>Math.random()<t,Rn=()=>{const t=["Network timeout","Connection refused","Server temporarily unavailable","Invalid request"];throw new Error(t[Math.floor(Math.random()*t.length)])},Ei={products:{async getAll(t,e){await Jr(),Ln()&&Rn();let r=[...Ht.products];if(t&&t.trim()){const n=t.toLowerCase();r=r.filter(i=>i.name.toLowerCase().includes(n)||i.sku.toLowerCase().includes(n)||i.category.toLowerCase().includes(n)||i.description.toLowerCase().includes(n))}return e?.category&&(r=r.filter(n=>n.category===e.category)),e?.isActive!==void 0&&(r=r.filter(n=>n.isActive===e.isActive)),r},async getById(t){return await Jr(),Ln()&&Rn(),Ht.products.find(e=>e.id===t)||null},async create(t){if(await Jr(),Ln()&&Rn(),Ht.products.some(r=>r.sku===t.sku))throw new Error("SKU already exists");const e={...t,id:tl("prod-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return Ht.products.push(e),e},async update(t,e){await Jr(),Ln()&&Rn();const r=Ht.products.findIndex(i=>i.id===t);if(r===-1)throw new Error("Product not found");if(e.sku&&Ht.products.some(i=>i.id!==t&&i.sku===e.sku))throw new Error("SKU already exists");const n={...Ht.products[r],...e,lastModified:new Date().toISOString()};return Ht.products[r]=n,n},async delete(t){await Jr(),Ln()&&Rn();const e=Ht.products.findIndex(n=>n.id===t);if(e===-1)throw new Error("Product not found");return Ht.movements.some(n=>n.productId===t)?{success:!1,message:"Cannot delete product with existing movements"}:(Ht.products.splice(e,1),{success:!0,message:"Product deleted successfully"})}},locations:{async getAll(t){await Jr(),Ln()&&Rn();let e=[...Ht.locations];return t?.type&&(e=e.filter(r=>r.type===t.type)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await Jr(),Ht.locations.find(e=>e.id===t)||null},async create(t){if(await Jr(),Ln()&&Rn(),Ht.locations.some(r=>r.code===t.code))throw new Error("Location code already exists");const e={...t,id:tl("loc-"),createdDate:new Date().toISOString()};return Ht.locations.push(e),e},async update(t,e){await Jr(),Ln()&&Rn();const r=Ht.locations.findIndex(n=>n.id===t);if(r===-1)throw new Error("Location not found");if(e.code&&Ht.locations.some(n=>n.id!==t&&n.code===e.code))throw new Error("Location code already exists");return Ht.locations[r]={...Ht.locations[r],...e},Ht.locations[r]}},movements:{async getAll(t){await Jr(),Ln()&&Rn();let e=[...Ht.movements];if(t?.productId&&(e=e.filter(r=>r.productId===t.productId)),t?.locationId&&(e=e.filter(r=>r.locationId===t.locationId)),t?.movementType&&(e=e.filter(r=>r.movementType===t.movementType)),t?.dateFrom&&(e=e.filter(r=>r.createdDate>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.createdDate<=t.dateTo)),t?.search){const r=t.search.toLowerCase();e=e.filter(n=>n.productName.toLowerCase().includes(r)||n.productSku.toLowerCase().includes(r)||n.referenceNumber.toLowerCase().includes(r)||n.notes.toLowerCase().includes(r))}return e.sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime()),e},async getById(t){return await Jr(),Ht.movements.find(e=>e.id===t)||null},async create(t){if(await Jr(),Ln()&&Rn(),!Ht.products.find(i=>i.id===t.productId))throw new Error("Product not found");if(!Ht.locations.find(i=>i.id===t.locationId))throw new Error("Location not found");if(t.movementType==="out"){const i=await this.getStockLevel(t.productId,t.locationId);if(i<t.quantity)throw new Error(`Insufficient stock. Available: ${i}, Requested: ${t.quantity}`)}const n={...t,id:tl("mov-"),createdDate:new Date().toISOString()};return Ht.movements.push(n),n},async update(t,e){await Jr(),Ln()&&Rn();const r=Ht.movements.findIndex(i=>i.id===t);if(r===-1)throw new Error("Movement not found");const n={...Ht.movements[r],...e,lastModified:new Date().toISOString()};return Ht.movements[r]=n,n},async delete(t){await Jr(),Ln()&&Rn();const e=Ht.movements.findIndex(r=>r.id===t);if(e===-1)throw new Error("Movement not found");return Ht.movements.splice(e,1),{success:!0,message:"Movement deleted successfully"}},async createBulk(t){await Jr(),Ln()&&Rn();const e=[],r=[],n=new Date().toISOString(),i=Ht.locations.find(o=>o.id===t.locationId);if(!i)return{success:!1,movements:[],errors:["Invalid location"]};for(let o=0;o<t.items.length;o++){const s=t.items[o],l=Ht.products.find(h=>h.id===s.productId);if(!l){e.push(`Item ${o+1}: Product not found`);continue}if(s.quantity<=0){e.push(`Item ${o+1}: Quantity must be greater than 0`);continue}if(t.movementType==="out"){const h=await this.getStockLevel(s.productId,t.locationId);if(s.quantity>h){e.push(`Item ${o+1}: Insufficient stock. Available: ${h}, Requested: ${s.quantity}`);continue}}const c=s.unitCost||l.unitCost,u={id:tl("mov-"),productId:l.id,productName:l.name,productSku:l.sku,locationId:t.locationId,locationName:i.name,movementType:t.movementType,quantity:s.quantity,unitCost:c,totalCost:s.quantity*c,referenceNumber:t.referenceNumber,notes:s.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:t.fromLocationId?Ht.locations.find(h=>h.id===t.fromLocationId)?.name:void 0};r.push(u)}return e.length>0?{success:!1,movements:[],errors:e}:(Ht.movements.push(...r),{success:!0,movements:r,errors:[]})},async getStockLevel(t,e){return await Jr(50),Ht.movements.filter(r=>r.productId===t&&r.locationId===e).reduce((r,n)=>{switch(n.movementType){case"in":case"adjustment":return r+n.quantity;case"out":return r-n.quantity;case"transfer":return n.locationId===e?r+n.quantity:r;default:return r}},0)},async getStockLevels(){await Jr();const t=new Map;for(const e of Ht.movements){const r=`${e.productId}-${e.locationId}`;let n=t.get(r);switch(n||(n={id:r,productId:e.productId,locationId:e.locationId,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType){case"in":case"adjustment":n.quantity+=e.quantity;break;case"out":n.quantity-=e.quantity;break;case"transfer":e.locationId===e.locationId&&(n.quantity+=e.quantity);break}new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost,n.availableQuantity=n.quantity-n.reservedQuantity}return Array.from(t.values())}},accounts:{async getAll(t){await Jr(),Ln()&&Rn();let e=[...Ht.accounts];return t?.accountType&&(e=e.filter(r=>r.accountType===t.accountType)),t?.category&&(e=e.filter(r=>r.category===t.category)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await Jr(),Ht.accounts.find(e=>e.id===t)||null},async create(t){if(await Jr(),Ln()&&Rn(),Ht.accounts.some(r=>r.accountNumber===t.accountNumber))throw new Error("Account number already exists");const e={...t,id:tl("acc-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return Ht.accounts.push(e),e},async update(t,e){await Jr(),Ln()&&Rn();const r=Ht.accounts.findIndex(n=>n.id===t);if(r===-1)throw new Error("Account not found");if(e.accountNumber&&Ht.accounts.some(n=>n.id!==t&&n.accountNumber===e.accountNumber))throw new Error("Account number already exists");return Ht.accounts[r]={...Ht.accounts[r],...e,lastModified:new Date().toISOString()},Ht.accounts[r]}},journal:{async getAll(t){await Jr(),Ln()&&Rn();let e=[...Ht.journalEntries];return t?.status&&(e=e.filter(r=>r.status===t.status)),t?.accountId&&(e=e.filter(r=>r.lines.some(n=>n.accountId===t.accountId))),t?.dateFrom&&(e=e.filter(r=>r.date>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.date<=t.dateTo)),e.sort((r,n)=>new Date(n.createdAt).getTime()-new Date(r.createdAt).getTime())},async getById(t){return await Jr(),Ht.journalEntries.find(e=>e.id===t)||null},async create(t){await Jr(),Ln()&&Rn();const e=t.lines.reduce((l,c)=>l+(c.debitAmount||0),0),r=t.lines.reduce((l,c)=>l+(c.creditAmount||0),0);if(Math.abs(e-r)>.01)throw new Error(`Entry is not balanced. Debit: ${e}, Credit: ${r}`);const n=Ht.journalEntries.sort((l,c)=>c.entryNumber.localeCompare(l.entryNumber))[0],o=`JE-${((n?parseInt(n.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`,s={...t,id:tl("je-"),entryNumber:o,createdAt:new Date().toISOString(),lines:t.lines.map(l=>({...l,id:tl("jel-")}))};return Ht.journalEntries.push(s),s},async update(t,e){await Jr(),Ln()&&Rn();const r=Ht.journalEntries.findIndex(n=>n.id===t);if(r===-1)throw new Error("Journal entry not found");if(Ht.journalEntries[r].status==="posted")throw new Error("Cannot modify posted entries");return Ht.journalEntries[r]={...Ht.journalEntries[r],...e},Ht.journalEntries[r]},async post(t){await Jr(),Ln()&&Rn();const e=Ht.journalEntries.findIndex(o=>o.id===t);if(e===-1)throw new Error("Journal entry not found");const r=Ht.journalEntries[e];if(r.status==="posted")throw new Error("Entry is already posted");const n=r.lines.reduce((o,s)=>o+(s.debitAmount||0),0),i=r.lines.reduce((o,s)=>o+(s.creditAmount||0),0);if(Math.abs(n-i)>.01)throw new Error("Entry must be balanced before posting");return Ht.journalEntries[e]={...r,status:"posted",postedAt:new Date().toISOString()},r.lines.forEach(o=>{const s=Ht.accounts.findIndex(l=>l.id===o.accountId);if(s!==-1){const l=Ht.accounts[s],c=o.debitAmount||0,u=o.creditAmount||0;["asset","expense"].includes(l.accountType)?l.balance+=c-u:l.balance+=u-c}}),Ht.journalEntries[e]}},utils:{async getNextEntryNumber(){await Jr(100);const t=Ht.journalEntries.sort((r,n)=>n.entryNumber.localeCompare(r.entryNumber))[0];return`JE-${((t?parseInt(t.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`},async getNextProductCode(t){await Jr(100);const e=t.toUpperCase().slice(0,3),r=Ht.products.filter(i=>i.productCode?.startsWith(e)).sort((i,o)=>(o.productCode||"").localeCompare(i.productCode||""));if(r.length===0)return`${e}001`;const n=parseInt(r[0].productCode?.slice(-3)||"0");return`${e}${(n+1).toString().padStart(3,"0")}`},async healthCheck(){return await Jr(50),{status:"healthy",timestamp:new Date().toISOString(),version:"1.0.0"}},async resetDatabase(){return await Jr(200),Ht={products:[...Ht.products.slice(0,3)],locations:[...Ht.locations.slice(0,3)],movements:[...Ht.movements.slice(0,2)],accounts:[...Ht.accounts.slice(0,2)],journalEntries:[...Ht.journalEntries.slice(0,1)]},{success:!0,message:"Database reset to initial state"}},async getStats(){return await Jr(100),{products:Ht.products.length,locations:Ht.locations.length,movements:Ht.movements.length,accounts:Ht.accounts.length,journalEntries:Ht.journalEntries.length,totalStockValue:Ht.movements.reduce((t,e)=>e.movementType==="in"?t+e.totalCost:e.movementType==="out"?t-e.totalCost:t,0)}}}},Xb=t=>t===null||typeof t!="object"?t:t instanceof Date?new Date(t.getTime()):Array.isArray(t)?t.map(e=>Xb(e)):JSON.parse(JSON.stringify(t)),Lu=(t=16)=>{const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},kg=(t=16)=>{const e="123456789";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},SP=(t=4)=>{const e="0123456789BCDFGKSY";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},gl=t=>typeof t=="string"&&t.trim().length>0,hi=async t=>{const n=await fetch("https://qvamarkets.com/gql_api",{method:"POST",headers:{"Content-Type":"application/json","Accept-Encoding":"gzip, deflate, br",Authorization:"eyJhbGciOiJSUzI1NiIsImtpZCI6IjhlOGZjOGU1NTZmN2E3NmQwOGQzNTgyOWQ2ZjkwYWUyZTEyY2ZkMGQiLCJ0eXAiOiJKV1QifQ"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const i=await n.json();if(i.errors)throw new Error(i.errors[0]?.message||"GraphQL error");return i.data},PP=t=>({ENTRY:"in",in:"in",TRANSFER:"transfer",transfer:"transfer",SALES:"out",out:"out",adjustment:"adjustment"})[t],Kf=t=>({ENTRY:"ENTRY",in:"ENTRY",TRANSFER:"TRANSFER",transfer:"TRANSFER",SALES:"SALES",out:"SALES",adjustment:"adjustment"})[t];function Jf(t){var e=[];return t&&Object.keys(t).map(r=>{e.push(t[r])}),e}function wP(t){if(!/^[a-z0-9+/]+={0,2}$/i.test(t)||t.length%4!=0)throw Error("Not base64 string");for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r,n,i,o,s,l,c,u,h=[],y=0;y<t.length;y+=4)o=e.indexOf(t.charAt(y)),s=e.indexOf(t.charAt(y+1)),l=e.indexOf(t.charAt(y+2)),c=e.indexOf(t.charAt(y+3)),u=o<<18|s<<12|l<<6|c,r=u>>>16&255,n=u>>>8&255,i=u&255,h[y/4]=String.fromCharCode(r,n,i),c==64&&(h[y/4]=String.fromCharCode(r,n)),l==64&&(h[y/4]=String.fromCharCode(r));return t=h.join(""),t}const xP=(t,e,r,n)=>{let i=0,o={};return t.map(s=>{n?.[s]||Zb(e?.[s],r?.[s])||(i=1,o[s]=e[s])}),{hasChange:i,data:o}},Zb=(t,e)=>Object.prototype.toString.call(t)===Object.prototype.toString.call(e)?Object.prototype.toString.call(t)==="[object Object]"||Object.prototype.toString.call(t)==="[object Array]"?Object.keys(t).length!==Object.keys(e).length?!1:Object.keys(t).every(function(r){return Zb(t[r],e[r])}):t===e:!1,AP=()=>{};var Ng={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e1=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},CP=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[r++];e[n++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=t[r++],s=t[r++],l=t[r++],c=((i&7)<<18|(o&63)<<12|(s&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const o=t[r++],s=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(o&63)<<6|s&63)}}return e.join("")},t1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const o=t[i],s=i+1<t.length,l=s?t[i+1]:0,c=i+2<t.length,u=c?t[i+2]:0,h=o>>2,y=(o&3)<<4|l>>4;let g=(l&15)<<2|u>>6,f=u&63;c||(f=64,s||(g=64)),n.push(r[h],r[y],r[g],r[f])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(e1(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):CP(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const o=r[t.charAt(i++)],l=i<t.length?r[t.charAt(i)]:0;++i;const u=i<t.length?r[t.charAt(i)]:64;++i;const y=i<t.length?r[t.charAt(i)]:64;if(++i,o==null||l==null||u==null||y==null)throw new IP;const g=o<<2|l>>4;if(n.push(g),u!==64){const f=l<<4&240|u>>2;if(n.push(f),y!==64){const x=u<<6&192|y;n.push(x)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class IP extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const $P=function(t){const e=e1(t);return t1.encodeByteArray(e,!0)},Ch=function(t){return $P(t).replace(/\./g,"")},r1=function(t){try{return t1.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EP(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TP=()=>EP().__FIREBASE_DEFAULTS__,kP=()=>{if(typeof process>"u"||typeof Ng>"u")return;const t=Ng.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},NP=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&r1(t[1]);return e&&JSON.parse(e)},Xh=()=>{try{return AP()||TP()||kP()||NP()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},n1=t=>Xh()?.emulatorHosts?.[t],LP=t=>{const e=n1(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},i1=()=>Xh()?.config,o1=t=>Xh()?.[`_${t}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RP{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ec(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function s1(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DP(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Ch(JSON.stringify(r)),Ch(JSON.stringify(s)),""].join(".")}const gu={};function MP(){const t={prod:[],emulator:[]};for(const e of Object.keys(gu))gu[e]?t.emulator.push(e):t.prod.push(e);return t}function FP(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let Lg=!1;function a1(t,e){if(typeof window>"u"||typeof document>"u"||!Ec(window.location.host)||gu[t]===e||gu[t]||Lg)return;gu[t]=e;function r(g){return`__firebase__banner__${g}`}const n="__firebase__banner",o=MP().prod.length>0;function s(){const g=document.getElementById(n);g&&g.remove()}function l(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function c(g,f){g.setAttribute("width","24"),g.setAttribute("id",f),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function u(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{Lg=!0,s()},g}function h(g,f){g.setAttribute("id",f),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function y(){const g=FP(n),f=r("text"),x=document.getElementById(f)||document.createElement("span"),S=r("learnmore"),w=document.getElementById(S)||document.createElement("a"),E=r("preprendIcon"),q=document.getElementById(E)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const ee=g.element;l(ee),h(w,S);const W=u();c(q,E),ee.append(q,x,w,W),document.body.appendChild(ee)}o?(x.innerText="Preview backend disconnected.",q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",f)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function OP(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(bi())}function BP(){const t=Xh()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function jP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function VP(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function qP(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function zP(){const t=bi();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function UP(){return!BP()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function HP(){try{return typeof indexedDB=="object"}catch{return!1}}function GP(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WP="FirebaseError";class Rs extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=WP,Object.setPrototypeOf(this,Rs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ku.prototype.create)}}class Ku{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,o=this.errors[e],s=o?YP(o,n):"Error",l=`${this.serviceName}: ${s} (${i}).`;return new Rs(i,l,n)}}function YP(t,e){return t.replace(KP,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const KP=/\{\$([^}]+)}/g;function JP(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function xl(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const o=t[i],s=e[i];if(Rg(o)&&Rg(s)){if(!xl(o,s))return!1}else if(o!==s)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function Rg(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ju(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function QP(t,e){const r=new XP(t,e);return r.subscribe.bind(r)}class XP{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");ZP(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=Up),i.error===void 0&&(i.error=Up),i.complete===void 0&&(i.complete=Up);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ZP(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Up(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ri(t){return t&&t._delegate?t._delegate:t}class Al{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ol="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ew{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new RP;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(rw(e))try{this.getOrInitializeService({instanceIdentifier:ol})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:i});n.resolve(o)}catch{}}}}clearInstance(e=ol){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ol){return this.instances.has(e)}getOptions(e=ol){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[o,s]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(o);n===l&&s.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const o=this.instances.get(n);return o&&e(o,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:tw(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ol){return this.component?this.component.multipleInstances?e:ol:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function tw(t){return t===ol?void 0:t}function rw(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nw{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new ew(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Or;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Or||(Or={}));const iw={debug:Or.DEBUG,verbose:Or.VERBOSE,info:Or.INFO,warn:Or.WARN,error:Or.ERROR,silent:Or.SILENT},ow=Or.INFO,sw={[Or.DEBUG]:"log",[Or.VERBOSE]:"log",[Or.INFO]:"info",[Or.WARN]:"warn",[Or.ERROR]:"error"},aw=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=sw[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ym{constructor(e){this.name=e,this._logLevel=ow,this._logHandler=aw,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Or))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?iw[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Or.DEBUG,...e),this._logHandler(this,Or.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Or.VERBOSE,...e),this._logHandler(this,Or.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Or.INFO,...e),this._logHandler(this,Or.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Or.WARN,...e),this._logHandler(this,Or.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Or.ERROR,...e),this._logHandler(this,Or.ERROR,...e)}}const lw=(t,e)=>e.some(r=>t instanceof r);let Dg,Mg;function cw(){return Dg||(Dg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function uw(){return Mg||(Mg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const l1=new WeakMap,Qf=new WeakMap,c1=new WeakMap,Hp=new WeakMap,Km=new WeakMap;function dw(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",s)},o=()=>{r(Sa(t.result)),i()},s=()=>{n(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",s)});return e.then(r=>{r instanceof IDBCursor&&l1.set(r,t)}).catch(()=>{}),Km.set(e,t),e}function hw(t){if(Qf.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",s),t.removeEventListener("abort",s)},o=()=>{r(),i()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",s),t.addEventListener("abort",s)});Qf.set(t,e)}let Xf={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Qf.get(t);if(e==="objectStoreNames")return t.objectStoreNames||c1.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Sa(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function pw(t){Xf=t(Xf)}function fw(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Gp(this),e,...r);return c1.set(n,e.sort?e.sort():[e]),Sa(n)}:uw().includes(t)?function(...e){return t.apply(Gp(this),e),Sa(l1.get(this))}:function(...e){return Sa(t.apply(Gp(this),e))}}function mw(t){return typeof t=="function"?fw(t):(t instanceof IDBTransaction&&hw(t),lw(t,cw())?new Proxy(t,Xf):t)}function Sa(t){if(t instanceof IDBRequest)return dw(t);if(Hp.has(t))return Hp.get(t);const e=mw(t);return e!==t&&(Hp.set(t,e),Km.set(e,t)),e}const Gp=t=>Km.get(t);function yw(t,e,{blocked:r,upgrade:n,blocking:i,terminated:o}={}){const s=indexedDB.open(t,e),l=Sa(s);return n&&s.addEventListener("upgradeneeded",c=>{n(Sa(s.result),c.oldVersion,c.newVersion,Sa(s.transaction),c)}),r&&s.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),l.then(c=>{o&&c.addEventListener("close",()=>o()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const gw=["get","getKey","getAll","getAllKeys","count"],vw=["put","add","delete","clear"],Wp=new Map;function Fg(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Wp.get(e))return Wp.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=vw.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||gw.includes(r)))return;const o=async function(s,...l){const c=this.transaction(s,i?"readwrite":"readonly");let u=c.store;return n&&(u=u.index(l.shift())),(await Promise.all([u[r](...l),i&&c.done]))[0]};return Wp.set(e,o),o}pw(t=>({...t,get:(e,r,n)=>Fg(e,r)||t.get(e,r,n),has:(e,r)=>!!Fg(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bw{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(_w(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function _w(t){return t.getComponent()?.type==="VERSION"}const Zf="@firebase/app",Og="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $s=new Ym("@firebase/app"),Sw="@firebase/app-compat",Pw="@firebase/analytics-compat",ww="@firebase/analytics",xw="@firebase/app-check-compat",Aw="@firebase/app-check",Cw="@firebase/auth",Iw="@firebase/auth-compat",$w="@firebase/database",Ew="@firebase/data-connect",Tw="@firebase/database-compat",kw="@firebase/functions",Nw="@firebase/functions-compat",Lw="@firebase/installations",Rw="@firebase/installations-compat",Dw="@firebase/messaging",Mw="@firebase/messaging-compat",Fw="@firebase/performance",Ow="@firebase/performance-compat",Bw="@firebase/remote-config",jw="@firebase/remote-config-compat",Vw="@firebase/storage",qw="@firebase/storage-compat",zw="@firebase/firestore",Uw="@firebase/ai",Hw="@firebase/firestore-compat",Gw="firebase",Ww="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const em="[DEFAULT]",Yw={[Zf]:"fire-core",[Sw]:"fire-core-compat",[ww]:"fire-analytics",[Pw]:"fire-analytics-compat",[Aw]:"fire-app-check",[xw]:"fire-app-check-compat",[Cw]:"fire-auth",[Iw]:"fire-auth-compat",[$w]:"fire-rtdb",[Ew]:"fire-data-connect",[Tw]:"fire-rtdb-compat",[kw]:"fire-fn",[Nw]:"fire-fn-compat",[Lw]:"fire-iid",[Rw]:"fire-iid-compat",[Dw]:"fire-fcm",[Mw]:"fire-fcm-compat",[Fw]:"fire-perf",[Ow]:"fire-perf-compat",[Bw]:"fire-rc",[jw]:"fire-rc-compat",[Vw]:"fire-gcs",[qw]:"fire-gcs-compat",[zw]:"fire-fst",[Hw]:"fire-fst-compat",[Uw]:"fire-vertex","fire-js":"fire-js",[Gw]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ih=new Map,Kw=new Map,tm=new Map;function Bg(t,e){try{t.container.addComponent(e)}catch(r){$s.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function _c(t){const e=t.name;if(tm.has(e))return $s.debug(`There were multiple attempts to register component ${e}.`),!1;tm.set(e,t);for(const r of Ih.values())Bg(r,t);for(const r of Kw.values())Bg(r,t);return!0}function Jm(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function fo(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jw={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Pa=new Ku("app","Firebase",Jw);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qw{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Al("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Pa.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tc=Ww;function u1(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:em,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw Pa.create("bad-app-name",{appName:String(i)});if(r||(r=i1()),!r)throw Pa.create("no-options");const o=Ih.get(i);if(o){if(xl(r,o.options)&&xl(n,o.config))return o;throw Pa.create("duplicate-app",{appName:i})}const s=new nw(i);for(const c of tm.values())s.addComponent(c);const l=new Qw(r,n,s);return Ih.set(i,l),l}function d1(t=em){const e=Ih.get(t);if(!e&&t===em&&i1())return u1();if(!e)throw Pa.create("no-app",{appName:t});return e}function wa(t,e,r){let n=Yw[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const s=[`Unable to register library "${n}" with version "${e}":`];i&&s.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&o&&s.push("and"),o&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),$s.warn(s.join(" "));return}_c(new Al(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xw="firebase-heartbeat-database",Zw=1,Ru="firebase-heartbeat-store";let Yp=null;function h1(){return Yp||(Yp=yw(Xw,Zw,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ru)}catch(r){console.warn(r)}}}}).catch(t=>{throw Pa.create("idb-open",{originalErrorMessage:t.message})})),Yp}async function ex(t){try{const r=(await h1()).transaction(Ru),n=await r.objectStore(Ru).get(p1(t));return await r.done,n}catch(e){if(e instanceof Rs)$s.warn(e.message);else{const r=Pa.create("idb-get",{originalErrorMessage:e?.message});$s.warn(r.message)}}}async function jg(t,e){try{const n=(await h1()).transaction(Ru,"readwrite");await n.objectStore(Ru).put(e,p1(t)),await n.done}catch(r){if(r instanceof Rs)$s.warn(r.message);else{const n=Pa.create("idb-set",{originalErrorMessage:r?.message});$s.warn(n.message)}}}function p1(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tx=1024,rx=30;class nx{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new ox(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Vg();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>rx){const i=sx(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){$s.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Vg(),{heartbeatsToSend:r,unsentEntries:n}=ix(this._heartbeatsCache.heartbeats),i=Ch(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return $s.warn(e),""}}}function Vg(){return new Date().toISOString().substring(0,10)}function ix(t,e=tx){const r=[];let n=t.slice();for(const i of t){const o=r.find(s=>s.agent===i.agent);if(o){if(o.dates.push(i.date),qg(r)>e){o.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),qg(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class ox{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return HP()?GP().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await ex(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return jg(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return jg(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function qg(t){return Ch(JSON.stringify({version:2,heartbeats:t})).length}function sx(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ax(t){_c(new Al("platform-logger",e=>new bw(e),"PRIVATE")),_c(new Al("heartbeat",e=>new nx(e),"PRIVATE")),wa(Zf,Og,t),wa(Zf,Og,"esm2020"),wa("fire-js","")}ax("");function f1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const lx=f1,m1=new Ku("auth","Firebase",f1());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $h=new Ym("@firebase/auth");function cx(t,...e){$h.logLevel<=Or.WARN&&$h.warn(`Auth (${Tc}): ${t}`,...e)}function nh(t,...e){$h.logLevel<=Or.ERROR&&$h.error(`Auth (${Tc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rs(t,...e){throw Xm(t,...e)}function To(t,...e){return Xm(t,...e)}function Qm(t,e,r){const n={...lx(),[e]:r};return new Ku("auth","Firebase",n).create(e,{appName:t.name})}function xa(t){return Qm(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function y1(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&rs(t,"argument-error"),Qm(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Xm(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return m1.create(t,...e)}function Pr(t,e,...r){if(!t)throw Xm(e,...r)}function ws(t){const e="INTERNAL ASSERTION FAILED: "+t;throw nh(e),new Error(e)}function Es(t,e){t||ws(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rm(){return typeof self<"u"&&self.location?.href||""}function ux(){return zg()==="http:"||zg()==="https:"}function zg(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dx(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(ux()||VP()||"connection"in navigator)?navigator.onLine:!0}function hx(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu{constructor(e,r){this.shortDelay=e,this.longDelay=r,Es(r>e,"Short delay should be less than long delay!"),this.isMobile=OP()||qP()}get(){return dx()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zm(t,e){Es(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g1{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ws("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ws("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ws("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const px={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fx=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],mx=new Qu(3e4,6e4);function ey(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function kc(t,e,r,n,i={}){return v1(t,i,async()=>{let o={},s={};n&&(e==="GET"?s=n:o={body:JSON.stringify(n)});const l=Ju({key:t.config.apiKey,...s}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:c,...o};return jP()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&Ec(t.emulatorConfig.host)&&(u.credentials="include"),g1.fetch()(await b1(t,t.config.apiHost,r,l),u)})}async function v1(t,e,r){t._canInitEmulator=!1;const n={...px,...e};try{const i=new gx(t),o=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const s=await o.json();if("needConfirmation"in s)throw Nd(t,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{const l=o.ok?s.errorMessage:s.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Nd(t,"credential-already-in-use",s);if(c==="EMAIL_EXISTS")throw Nd(t,"email-already-in-use",s);if(c==="USER_DISABLED")throw Nd(t,"user-disabled",s);const h=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw Qm(t,h,u);rs(t,h)}}catch(i){if(i instanceof Rs)throw i;rs(t,"network-request-failed",{message:String(i)})}}async function yx(t,e,r,n,i={}){const o=await kc(t,e,r,n,i);return"mfaPendingCredential"in o&&rs(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function b1(t,e,r,n){const i=`${e}${r}?${n}`,o=t,s=o.config.emulator?Zm(t.config,i):`${t.config.apiScheme}://${i}`;return fx.includes(r)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(s).toString():s}class gx{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(To(this.auth,"network-request-failed")),mx.get())})}}function Nd(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=To(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vx(t,e){return kc(t,"POST","/v1/accounts:delete",e)}async function Eh(t,e){return kc(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function bx(t,e=!1){const r=ri(t),n=await r.getIdToken(e),i=ty(n);Pr(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,s=o?.sign_in_provider;return{claims:i,token:n,authTime:vu(Kp(i.auth_time)),issuedAtTime:vu(Kp(i.iat)),expirationTime:vu(Kp(i.exp)),signInProvider:s||null,signInSecondFactor:o?.sign_in_second_factor||null}}function Kp(t){return Number(t)*1e3}function ty(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return nh("JWT malformed, contained fewer than 3 sections"),null;try{const i=r1(r);return i?JSON.parse(i):(nh("Failed to decode base64 JWT payload"),null)}catch(i){return nh("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Ug(t){const e=ty(t);return Pr(e,"internal-error"),Pr(typeof e.exp<"u","internal-error"),Pr(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Du(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Rs&&_x(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function _x({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sx{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nm{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=vu(this.lastLoginAt),this.creationTime=vu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Th(t){const e=t.auth,r=await t.getIdToken(),n=await Du(t,Eh(e,{idToken:r}));Pr(n?.users.length,e,"internal-error");const i=n.users[0];t._notifyReloadListener(i);const o=i.providerUserInfo?.length?_1(i.providerUserInfo):[],s=wx(t.providerData,o),l=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!s?.length,u=l?c:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new nm(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function Px(t){const e=ri(t);await Th(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function wx(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function _1(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xx(t,e){const r=await v1(t,{},async()=>{const n=Ju({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=t.config,s=await b1(t,i,"/v1/token",`key=${o}`),l=await t._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:l,body:n};return t.emulatorConfig&&Ec(t.emulatorConfig.host)&&(c.credentials="include"),g1.fetch()(s,c)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function Ax(t,e){return kc(t,"POST","/v2/accounts:revokeToken",ey(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Pr(e.idToken,"internal-error"),Pr(typeof e.idToken<"u","internal-error"),Pr(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Ug(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Pr(e.length!==0,"internal-error");const r=Ug(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Pr(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:o}=await xx(e,r);this.updateTokensAndExpiration(n,i,Number(o))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:o}=r,s=new fc;return n&&(Pr(typeof n=="string","internal-error",{appName:e}),s.refreshToken=n),i&&(Pr(typeof i=="string","internal-error",{appName:e}),s.accessToken=i),o&&(Pr(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new fc,this.toJSON())}_performRefresh(){return ws("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aa(t,e){Pr(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class $o{constructor({uid:e,auth:r,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new Sx(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new nm(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await Du(this,this.stsTokenManager.getToken(this.auth,e));return Pr(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return bx(this,e)}reload(){return Px(this)}_assign(e){this!==e&&(Pr(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new $o({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){Pr(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Th(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(fo(this.auth.app))return Promise.reject(xa(this.auth));const e=await this.getIdToken();return await Du(this,vx(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,i=r.email??void 0,o=r.phoneNumber??void 0,s=r.photoURL??void 0,l=r.tenantId??void 0,c=r._redirectEventId??void 0,u=r.createdAt??void 0,h=r.lastLoginAt??void 0,{uid:y,emailVerified:g,isAnonymous:f,providerData:x,stsTokenManager:S}=r;Pr(y&&S,e,"internal-error");const w=fc.fromJSON(this.name,S);Pr(typeof y=="string",e,"internal-error"),aa(n,e.name),aa(i,e.name),Pr(typeof g=="boolean",e,"internal-error"),Pr(typeof f=="boolean",e,"internal-error"),aa(o,e.name),aa(s,e.name),aa(l,e.name),aa(c,e.name),aa(u,e.name),aa(h,e.name);const E=new $o({uid:y,auth:e,email:i,emailVerified:g,displayName:n,isAnonymous:f,photoURL:s,phoneNumber:o,tenantId:l,stsTokenManager:w,createdAt:u,lastLoginAt:h});return x&&Array.isArray(x)&&(E.providerData=x.map(q=>({...q}))),c&&(E._redirectEventId=c),E}static async _fromIdTokenResponse(e,r,n=!1){const i=new fc;i.updateFromServerResponse(r);const o=new $o({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Th(o),o}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];Pr(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?_1(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!o?.length,l=new fc;l.updateFromIdToken(n);const c=new $o({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:s}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new nm(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hg=new Map;function xs(t){Es(t instanceof Function,"Expected a class definition");let e=Hg.get(t);return e?(Es(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Hg.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S1{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}S1.type="NONE";const Gg=S1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ih(t,e,r){return`firebase:${t}:${e}:${r}`}class mc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:o}=this.auth;this.fullUserKey=ih(this.userKey,i.apiKey,o),this.fullPersistenceKey=ih("persistence",i.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await Eh(this.auth,{idToken:e}).catch(()=>{});return r?$o._fromGetAccountInfoResponse(this.auth,r,e):null}return $o._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new mc(xs(Gg),e,n);const i=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let o=i[0]||xs(Gg);const s=ih(n,e.config.apiKey,e.name);let l=null;for(const u of r)try{const h=await u._get(s);if(h){let y;if(typeof h=="string"){const g=await Eh(e,{idToken:h}).catch(()=>{});if(!g)break;y=await $o._fromGetAccountInfoResponse(e,g,h)}else y=$o._fromJSON(e,h);u!==o&&(l=y),o=u;break}}catch{}const c=i.filter(u=>u._shouldAllowMigration);return!o._shouldAllowMigration||!c.length?new mc(o,e,n):(o=c[0],l&&await o._set(s,l.toJSON()),await Promise.all(r.map(async u=>{if(u!==o)try{await u._remove(s)}catch{}})),new mc(o,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wg(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(A1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(P1(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(I1(e))return"Blackberry";if($1(e))return"Webos";if(w1(e))return"Safari";if((e.includes("chrome/")||x1(e))&&!e.includes("edge/"))return"Chrome";if(C1(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function P1(t=bi()){return/firefox\//i.test(t)}function w1(t=bi()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function x1(t=bi()){return/crios\//i.test(t)}function A1(t=bi()){return/iemobile/i.test(t)}function C1(t=bi()){return/android/i.test(t)}function I1(t=bi()){return/blackberry/i.test(t)}function $1(t=bi()){return/webos/i.test(t)}function ry(t=bi()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Cx(t=bi()){return ry(t)&&!!window.navigator?.standalone}function Ix(){return zP()&&document.documentMode===10}function E1(t=bi()){return ry(t)||C1(t)||$1(t)||I1(t)||/windows phone/i.test(t)||A1(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T1(t,e=[]){let r;switch(t){case"Browser":r=Wg(bi());break;case"Worker":r=`${Wg(bi())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Tc}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $x{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=o=>new Promise((s,l)=>{try{const c=e(o);s(c)}catch(c){l(c)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ex(t,e={}){return kc(t,"GET","/v2/passwordPolicy",ey(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tx=6;class kx{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??Tx,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nx{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Yg(this),this.idTokenSubscription=new Yg(this),this.beforeStateQueue=new $x(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=m1,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=xs(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await mc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Eh(this,{idToken:e}),n=await $o._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(fo(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(s,s))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=this.redirectUser?._redirectEventId,s=n?._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===s)&&l?.user&&(n=l.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Pr(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Th(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=hx()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(fo(this.app))return Promise.reject(xa(this));const r=e?ri(e):null;return r&&Pr(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Pr(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return fo(this.app)?Promise.reject(xa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return fo(this.app)?Promise.reject(xa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(xs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Ex(this),r=new kx(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ku("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await Ax(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&xs(e)||this._popupRedirectResolver;Pr(r,this,"argument-error"),this.redirectPersistenceManager=await mc.create(this,[xs(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const o=typeof r=="function"?r:r.next.bind(r);let s=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Pr(l,this,"internal-error"),l.then(()=>{s||o(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,i);return()=>{s=!0,c()}}else{const c=e.addObserver(r);return()=>{s=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Pr(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=T1(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(fo(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&cx(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Tl(t){return ri(t)}class Yg{constructor(e){this.auth=e,this.observer=null,this.addObserver=QP(r=>this.observer=r)}get next(){return Pr(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ny={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Lx(t){ny=t}function Rx(t){return ny.loadJS(t)}function Dx(){return ny.gapiScript}function Mx(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fx(t,e){const r=Jm(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),o=r.getOptions();if(xl(o,e??{}))return i;rs(i,"already-initialized")}return r.initialize({options:e})}function Ox(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(xs);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function Bx(t,e,r){const n=Tl(t);Pr(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,o=k1(e),{host:s,port:l}=jx(e),c=l===null?"":`:${l}`,u={url:`${o}//${s}${c}/`},h=Object.freeze({host:s,port:l,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){Pr(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),Pr(xl(u,n.config.emulator)&&xl(h,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=u,n.emulatorConfig=h,n.settings.appVerificationDisabledForTesting=!0,Ec(s)?(s1(`${o}//${s}${c}`),a1("Auth",!0)):Vx()}function k1(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function jx(t){const e=k1(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const o=i[1];return{host:o,port:Kg(n.substr(o.length+1))}}else{const[o,s]=n.split(":");return{host:o,port:Kg(s)}}}function Kg(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Vx(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N1{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return ws("not implemented")}_getIdTokenResponse(e){return ws("not implemented")}_linkToIdToken(e,r){return ws("not implemented")}_getReauthenticationResolver(e){return ws("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yc(t,e){return yx(t,"POST","/v1/accounts:signInWithIdp",ey(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qx="http://localhost";class Cl extends N1{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Cl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):rs("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...o}=r;if(!n||!i)return null;const s=new Cl(n,i);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(e){const r=this.buildRequest();return yc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,yc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,yc(e,r)}buildRequest(){const e={requestUri:qx,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Ju(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zh{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu extends Zh{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma extends Xu{constructor(){super("facebook.com")}static credential(e){return Cl._fromParams({providerId:ma.PROVIDER_ID,signInMethod:ma.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ma.credentialFromTaggedObject(e)}static credentialFromError(e){return ma.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ma.credential(e.oauthAccessToken)}catch{return null}}}ma.FACEBOOK_SIGN_IN_METHOD="facebook.com";ma.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo extends Xu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Cl._fromParams({providerId:Wo.PROVIDER_ID,signInMethod:Wo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Wo.credentialFromTaggedObject(e)}static credentialFromError(e){return Wo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Wo.credential(r,n)}catch{return null}}}Wo.GOOGLE_SIGN_IN_METHOD="google.com";Wo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya extends Xu{constructor(){super("github.com")}static credential(e){return Cl._fromParams({providerId:ya.PROVIDER_ID,signInMethod:ya.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ya.credentialFromTaggedObject(e)}static credentialFromError(e){return ya.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ya.credential(e.oauthAccessToken)}catch{return null}}}ya.GITHUB_SIGN_IN_METHOD="github.com";ya.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga extends Xu{constructor(){super("twitter.com")}static credential(e,r){return Cl._fromParams({providerId:ga.PROVIDER_ID,signInMethod:ga.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return ga.credentialFromTaggedObject(e)}static credentialFromError(e){return ga.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return ga.credential(r,n)}catch{return null}}}ga.TWITTER_SIGN_IN_METHOD="twitter.com";ga.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const o=await $o._fromIdTokenResponse(e,n,i),s=Jg(n);return new Sc({user:o,providerId:s,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=Jg(n);return new Sc({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function Jg(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh extends Rs{constructor(e,r,n,i){super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,kh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new kh(e,r,n,i)}}function L1(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?kh._fromErrorAndOperation(t,o,e,n):o})}async function zx(t,e,r=!1){const n=await Du(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Sc._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ux(t,e,r=!1){const{auth:n}=t;if(fo(n.app))return Promise.reject(xa(n));const i="reauthenticate";try{const o=await Du(t,L1(n,i,e,t),r);Pr(o.idToken,n,"internal-error");const s=ty(o.idToken);Pr(s,n,"internal-error");const{sub:l}=s;return Pr(t.uid===l,n,"user-mismatch"),Sc._forOperation(t,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&rs(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R1(t,e,r=!1){if(fo(t.app))return Promise.reject(xa(t));const n="signIn",i=await L1(t,n,e),o=await Sc._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(o.user),o}async function Hx(t,e){return R1(Tl(t),e)}function Gx(t,e,r,n){return ri(t).onIdTokenChanged(e,r,n)}function Wx(t,e,r){return ri(t).beforeAuthStateChanged(e,r)}function Yx(t,e,r,n){return ri(t).onAuthStateChanged(e,r,n)}function Kx(t){return ri(t).signOut()}const Nh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D1{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Nh,"1"),this.storage.removeItem(Nh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jx=1e3,Qx=10;class M1 extends D1{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=E1(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((s,l,c)=>{this.notifyListeners(s,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const s=this.storage.getItem(n);!r&&this.localCache[n]===s||this.notifyListeners(n,s)},o=this.storage.getItem(n);Ix()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Qx):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},Jx)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}M1.type="LOCAL";const Xx=M1;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F1 extends D1{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}F1.type="SESSION";const O1=F1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zx(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ep{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new ep(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:o}=r.data,s=this.handlersMap[i];if(!s?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const l=Array.from(s).map(async u=>u(r.origin,o)),c=await Zx(l);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ep.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iy(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eA{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,s;return new Promise((l,c)=>{const u=iy("",20);i.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},n);s={messageChannel:i,onMessage(y){const g=y;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(h),o=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),l(g.data.response);break;default:clearTimeout(h),clearTimeout(o),c(new Error("invalid_response"));break}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:u,data:r},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ko(){return window}function tA(t){Ko().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B1(){return typeof Ko().WorkerGlobalScope<"u"&&typeof Ko().importScripts=="function"}async function rA(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function nA(){return navigator?.serviceWorker?.controller||null}function iA(){return B1()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j1="firebaseLocalStorageDb",oA=1,Lh="firebaseLocalStorage",V1="fbase_key";class Zu{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function tp(t,e){return t.transaction([Lh],e?"readwrite":"readonly").objectStore(Lh)}function sA(){const t=indexedDB.deleteDatabase(j1);return new Zu(t).toPromise()}function im(){const t=indexedDB.open(j1,oA);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Lh,{keyPath:V1})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Lh)?e(n):(n.close(),await sA(),e(await im()))})})}async function Qg(t,e,r){const n=tp(t,!0).put({[V1]:e,value:r});return new Zu(n).toPromise()}async function aA(t,e){const r=tp(t,!1).get(e),n=await new Zu(r).toPromise();return n===void 0?null:n.value}function Xg(t,e){const r=tp(t,!0).delete(e);return new Zu(r).toPromise()}const lA=800,cA=3;class q1{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await im(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>cA)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return B1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ep._getInstance(iA()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await rA(),!this.activeServiceWorker)return;this.sender=new eA(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||nA()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await im();return await Qg(e,Nh,"1"),await Xg(e,Nh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>Qg(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>aA(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>Xg(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=tp(i,!1).getAll();return new Zu(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),lA)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}q1.type="LOCAL";const uA=q1;new Qu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oy(t,e){return e?xs(e):(Pr(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy extends N1{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return yc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return yc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return yc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function dA(t){return R1(t.auth,new sy(t),t.bypassAuthState)}function hA(t){const{auth:e,user:r}=t;return Pr(r,e,"internal-error"),Ux(r,new sy(t),t.bypassAuthState)}async function pA(t){const{auth:e,user:r}=t;return Pr(r,e,"internal-error"),zx(r,new sy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z1{constructor(e,r,n,i,o=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:o,error:s,type:l}=e;if(s){this.reject(s);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return dA;case"linkViaPopup":case"linkViaRedirect":return pA;case"reauthViaPopup":case"reauthViaRedirect":return hA;default:rs(this.auth,"internal-error")}}resolve(e){Es(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Es(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fA=new Qu(2e3,1e4);async function mA(t,e,r){if(fo(t.app))return Promise.reject(To(t,"operation-not-supported-in-this-environment"));const n=Tl(t);y1(t,e,Zh);const i=oy(n,r);return new hl(n,"signInViaPopup",e,i).executeNotNull()}class hl extends z1{constructor(e,r,n,i,o){super(e,r,i,o),this.provider=n,this.authWindow=null,this.pollId=null,hl.currentPopupAction&&hl.currentPopupAction.cancel(),hl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Pr(e,this.auth,"internal-error"),e}async onExecution(){Es(this.filter.length===1,"Popup operations only handle one event");const e=iy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(To(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(To(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,hl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(To(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,fA.get())};e()}}hl.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yA="pendingRedirect",oh=new Map;class gA extends z1{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=oh.get(this.auth._key());if(!e){try{const n=await vA(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}oh.set(this.auth._key(),e)}return this.bypassAuthState||oh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function vA(t,e){const r=H1(e),n=U1(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}async function bA(t,e){return U1(t)._set(H1(e),"true")}function _A(t,e){oh.set(t._key(),e)}function U1(t){return xs(t._redirectPersistence)}function H1(t){return ih(yA,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SA(t,e,r){return PA(t,e,r)}async function PA(t,e,r){if(fo(t.app))return Promise.reject(xa(t));const n=Tl(t);y1(t,e,Zh),await n._initializationPromise;const i=oy(n,r);return await bA(i,n),i._openRedirect(n,e,"signInViaRedirect")}async function wA(t,e){return await Tl(t)._initializationPromise,G1(t,e,!1)}async function G1(t,e,r=!1){if(fo(t.app))return Promise.reject(xa(t));const n=Tl(t),i=oy(n,e),s=await new gA(n,i,r).execute();return s&&!r&&(delete s.user._redirectEventId,await n._persistUserIfCurrent(s.user),await n._setRedirectUser(null,e)),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xA=10*60*1e3;class AA{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!CA(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!W1(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(To(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=xA&&this.cachedEventUids.clear(),this.cachedEventUids.has(Zg(e))}saveEventToCache(e){this.cachedEventUids.add(Zg(e)),this.lastProcessedEventTime=Date.now()}}function Zg(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function W1({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function CA(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return W1(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IA(t,e={}){return kc(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $A=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,EA=/^https?/;async function TA(t){if(t.config.emulator)return;const{authorizedDomains:e}=await IA(t);for(const r of e)try{if(kA(r))return}catch{}rs(t,"unauthorized-domain")}function kA(t){const e=rm(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const s=new URL(t);return s.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&s.hostname===n}if(!EA.test(r))return!1;if($A.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NA=new Qu(3e4,6e4);function ev(){const t=Ko().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function LA(t){return new Promise((e,r)=>{function n(){ev(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ev(),r(To(t,"network-request-failed"))},timeout:NA.get()})}if(Ko().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ko().gapi?.load)n();else{const i=Mx("iframefcb");return Ko()[i]=()=>{gapi.load?n():r(To(t,"network-request-failed"))},Rx(`${Dx()}?onload=${i}`).catch(o=>r(o))}}).catch(e=>{throw sh=null,e})}let sh=null;function RA(t){return sh=sh||LA(t),sh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DA=new Qu(5e3,15e3),MA="__/auth/iframe",FA="emulator/auth/iframe",OA={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},BA=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function jA(t){const e=t.config;Pr(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Zm(e,FA):`https://${t.config.authDomain}/${MA}`,n={apiKey:e.apiKey,appName:t.name,v:Tc},i=BA.get(t.config.apiHost);i&&(n.eid=i);const o=t._getFrameworks();return o.length&&(n.fw=o.join(",")),`${r}?${Ju(n).slice(1)}`}async function VA(t){const e=await RA(t),r=Ko().gapi;return Pr(r,t,"internal-error"),e.open({where:document.body,url:jA(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:OA,dontclear:!0},n=>new Promise(async(i,o)=>{await n.restyle({setHideOnLeave:!1});const s=To(t,"network-request-failed"),l=Ko().setTimeout(()=>{o(s)},DA.get());function c(){Ko().clearTimeout(l),i(n)}n.ping(c).then(c,()=>{o(s)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qA={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},zA=500,UA=600,HA="_blank",GA="http://localhost";class tv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function WA(t,e,r,n=zA,i=UA){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const c={...qA,width:n.toString(),height:i.toString(),top:o,left:s},u=bi().toLowerCase();r&&(l=x1(u)?HA:r),P1(u)&&(e=e||GA,c.scrollbars="yes");const h=Object.entries(c).reduce((g,[f,x])=>`${g}${f}=${x},`,"");if(Cx(u)&&l!=="_self")return YA(e||"",l),new tv(null);const y=window.open(e||"",l,h);Pr(y,t,"popup-blocked");try{y.focus()}catch{}return new tv(y)}function YA(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KA="__/auth/handler",JA="emulator/auth/handler",QA=encodeURIComponent("fac");async function rv(t,e,r,n,i,o){Pr(t.config.authDomain,t,"auth-domain-config-required"),Pr(t.config.apiKey,t,"invalid-api-key");const s={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Tc,eventId:i};if(e instanceof Zh){e.setDefaultLanguage(t.languageCode),s.providerId=e.providerId||"",JP(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,y]of Object.entries({}))s[h]=y}if(e instanceof Xu){const h=e.getScopes().filter(y=>y!=="");h.length>0&&(s.scopes=h.join(","))}t.tenantId&&(s.tid=t.tenantId);const l=s;for(const h of Object.keys(l))l[h]===void 0&&delete l[h];const c=await t._getAppCheckToken(),u=c?`#${QA}=${encodeURIComponent(c)}`:"";return`${XA(t)}?${Ju(l).slice(1)}${u}`}function XA({config:t}){return t.emulator?Zm(t,JA):`https://${t.authDomain}/${KA}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jp="webStorageSupport";class ZA{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=O1,this._completeRedirectFn=G1,this._overrideRedirectResult=_A}async _openPopup(e,r,n,i){Es(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const o=await rv(e,r,n,rm(),i);return WA(e,o,iy())}async _openRedirect(e,r,n,i){await this._originValidation(e);const o=await rv(e,r,n,rm(),i);return tA(o),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:o}=this.eventManagers[r];return i?Promise.resolve(i):(Es(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await VA(e),n=new AA(e);return r.register("authEvent",i=>(Pr(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Jp,{type:Jp},i=>{const o=i?.[0]?.[Jp];o!==void 0&&r(!!o),rs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=TA(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return E1()||w1()||ry()}}const eC=ZA;var nv="@firebase/auth",iv="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tC{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Pr(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rC(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function nC(t){_c(new Al("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:l}=n.options;Pr(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:s,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:T1(t)},u=new Nx(n,i,o,c);return Ox(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),_c(new Al("auth-internal",e=>{const r=Tl(e.getProvider("auth").getImmediate());return(n=>new tC(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),wa(nv,iv,rC(t)),wa(nv,iv,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iC=5*60,oC=o1("authIdTokenMaxAge")||iC;let ov=null;const sC=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>oC)return;const i=r?.token;ov!==i&&(ov=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function aC(t=d1()){const e=Jm(t,"auth");if(e.isInitialized())return e.getImmediate();const r=Fx(t,{popupRedirectResolver:eC,persistence:[uA,Xx,O1]}),n=o1("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const s=sC(o.toString());Wx(r,s,()=>s(r.currentUser)),Gx(r,l=>s(l))}}const i=n1("auth");return i&&Bx(r,`http://${i}`),r}function lC(){return document.getElementsByTagName("head")?.[0]??document}Lx({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const o=To("internal-error");o.customData=i,r(o)},n.type="text/javascript",n.charset="UTF-8",lC().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});nC("Browser");var cC="firebase",uC="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */wa(cC,uC,"app");var sv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Aa,Y1;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e($,C){function T(){}T.prototype=C.prototype,$.D=C.prototype,$.prototype=new T,$.prototype.constructor=$,$.C=function(O,b,P){for(var _=Array(arguments.length-2),z=2;z<arguments.length;z++)_[z-2]=arguments[z];return C.prototype[b].apply(O,_)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i($,C,T){T||(T=0);var O=Array(16);if(typeof C=="string")for(var b=0;16>b;++b)O[b]=C.charCodeAt(T++)|C.charCodeAt(T++)<<8|C.charCodeAt(T++)<<16|C.charCodeAt(T++)<<24;else for(b=0;16>b;++b)O[b]=C[T++]|C[T++]<<8|C[T++]<<16|C[T++]<<24;C=$.g[0],T=$.g[1],b=$.g[2];var P=$.g[3],_=C+(P^T&(b^P))+O[0]+3614090360&4294967295;C=T+(_<<7&4294967295|_>>>25),_=P+(b^C&(T^b))+O[1]+3905402710&4294967295,P=C+(_<<12&4294967295|_>>>20),_=b+(T^P&(C^T))+O[2]+606105819&4294967295,b=P+(_<<17&4294967295|_>>>15),_=T+(C^b&(P^C))+O[3]+3250441966&4294967295,T=b+(_<<22&4294967295|_>>>10),_=C+(P^T&(b^P))+O[4]+4118548399&4294967295,C=T+(_<<7&4294967295|_>>>25),_=P+(b^C&(T^b))+O[5]+1200080426&4294967295,P=C+(_<<12&4294967295|_>>>20),_=b+(T^P&(C^T))+O[6]+2821735955&4294967295,b=P+(_<<17&4294967295|_>>>15),_=T+(C^b&(P^C))+O[7]+4249261313&4294967295,T=b+(_<<22&4294967295|_>>>10),_=C+(P^T&(b^P))+O[8]+1770035416&4294967295,C=T+(_<<7&4294967295|_>>>25),_=P+(b^C&(T^b))+O[9]+2336552879&4294967295,P=C+(_<<12&4294967295|_>>>20),_=b+(T^P&(C^T))+O[10]+4294925233&4294967295,b=P+(_<<17&4294967295|_>>>15),_=T+(C^b&(P^C))+O[11]+2304563134&4294967295,T=b+(_<<22&4294967295|_>>>10),_=C+(P^T&(b^P))+O[12]+1804603682&4294967295,C=T+(_<<7&4294967295|_>>>25),_=P+(b^C&(T^b))+O[13]+4254626195&4294967295,P=C+(_<<12&4294967295|_>>>20),_=b+(T^P&(C^T))+O[14]+2792965006&4294967295,b=P+(_<<17&4294967295|_>>>15),_=T+(C^b&(P^C))+O[15]+1236535329&4294967295,T=b+(_<<22&4294967295|_>>>10),_=C+(b^P&(T^b))+O[1]+4129170786&4294967295,C=T+(_<<5&4294967295|_>>>27),_=P+(T^b&(C^T))+O[6]+3225465664&4294967295,P=C+(_<<9&4294967295|_>>>23),_=b+(C^T&(P^C))+O[11]+643717713&4294967295,b=P+(_<<14&4294967295|_>>>18),_=T+(P^C&(b^P))+O[0]+3921069994&4294967295,T=b+(_<<20&4294967295|_>>>12),_=C+(b^P&(T^b))+O[5]+3593408605&4294967295,C=T+(_<<5&4294967295|_>>>27),_=P+(T^b&(C^T))+O[10]+38016083&4294967295,P=C+(_<<9&4294967295|_>>>23),_=b+(C^T&(P^C))+O[15]+3634488961&4294967295,b=P+(_<<14&4294967295|_>>>18),_=T+(P^C&(b^P))+O[4]+3889429448&4294967295,T=b+(_<<20&4294967295|_>>>12),_=C+(b^P&(T^b))+O[9]+568446438&4294967295,C=T+(_<<5&4294967295|_>>>27),_=P+(T^b&(C^T))+O[14]+3275163606&4294967295,P=C+(_<<9&4294967295|_>>>23),_=b+(C^T&(P^C))+O[3]+4107603335&4294967295,b=P+(_<<14&4294967295|_>>>18),_=T+(P^C&(b^P))+O[8]+1163531501&4294967295,T=b+(_<<20&4294967295|_>>>12),_=C+(b^P&(T^b))+O[13]+2850285829&4294967295,C=T+(_<<5&4294967295|_>>>27),_=P+(T^b&(C^T))+O[2]+4243563512&4294967295,P=C+(_<<9&4294967295|_>>>23),_=b+(C^T&(P^C))+O[7]+1735328473&4294967295,b=P+(_<<14&4294967295|_>>>18),_=T+(P^C&(b^P))+O[12]+2368359562&4294967295,T=b+(_<<20&4294967295|_>>>12),_=C+(T^b^P)+O[5]+4294588738&4294967295,C=T+(_<<4&4294967295|_>>>28),_=P+(C^T^b)+O[8]+2272392833&4294967295,P=C+(_<<11&4294967295|_>>>21),_=b+(P^C^T)+O[11]+1839030562&4294967295,b=P+(_<<16&4294967295|_>>>16),_=T+(b^P^C)+O[14]+4259657740&4294967295,T=b+(_<<23&4294967295|_>>>9),_=C+(T^b^P)+O[1]+2763975236&4294967295,C=T+(_<<4&4294967295|_>>>28),_=P+(C^T^b)+O[4]+1272893353&4294967295,P=C+(_<<11&4294967295|_>>>21),_=b+(P^C^T)+O[7]+4139469664&4294967295,b=P+(_<<16&4294967295|_>>>16),_=T+(b^P^C)+O[10]+3200236656&4294967295,T=b+(_<<23&4294967295|_>>>9),_=C+(T^b^P)+O[13]+681279174&4294967295,C=T+(_<<4&4294967295|_>>>28),_=P+(C^T^b)+O[0]+3936430074&4294967295,P=C+(_<<11&4294967295|_>>>21),_=b+(P^C^T)+O[3]+3572445317&4294967295,b=P+(_<<16&4294967295|_>>>16),_=T+(b^P^C)+O[6]+76029189&4294967295,T=b+(_<<23&4294967295|_>>>9),_=C+(T^b^P)+O[9]+3654602809&4294967295,C=T+(_<<4&4294967295|_>>>28),_=P+(C^T^b)+O[12]+3873151461&4294967295,P=C+(_<<11&4294967295|_>>>21),_=b+(P^C^T)+O[15]+530742520&4294967295,b=P+(_<<16&4294967295|_>>>16),_=T+(b^P^C)+O[2]+3299628645&4294967295,T=b+(_<<23&4294967295|_>>>9),_=C+(b^(T|~P))+O[0]+4096336452&4294967295,C=T+(_<<6&4294967295|_>>>26),_=P+(T^(C|~b))+O[7]+1126891415&4294967295,P=C+(_<<10&4294967295|_>>>22),_=b+(C^(P|~T))+O[14]+2878612391&4294967295,b=P+(_<<15&4294967295|_>>>17),_=T+(P^(b|~C))+O[5]+4237533241&4294967295,T=b+(_<<21&4294967295|_>>>11),_=C+(b^(T|~P))+O[12]+1700485571&4294967295,C=T+(_<<6&4294967295|_>>>26),_=P+(T^(C|~b))+O[3]+2399980690&4294967295,P=C+(_<<10&4294967295|_>>>22),_=b+(C^(P|~T))+O[10]+4293915773&4294967295,b=P+(_<<15&4294967295|_>>>17),_=T+(P^(b|~C))+O[1]+2240044497&4294967295,T=b+(_<<21&4294967295|_>>>11),_=C+(b^(T|~P))+O[8]+1873313359&4294967295,C=T+(_<<6&4294967295|_>>>26),_=P+(T^(C|~b))+O[15]+4264355552&4294967295,P=C+(_<<10&4294967295|_>>>22),_=b+(C^(P|~T))+O[6]+2734768916&4294967295,b=P+(_<<15&4294967295|_>>>17),_=T+(P^(b|~C))+O[13]+1309151649&4294967295,T=b+(_<<21&4294967295|_>>>11),_=C+(b^(T|~P))+O[4]+4149444226&4294967295,C=T+(_<<6&4294967295|_>>>26),_=P+(T^(C|~b))+O[11]+3174756917&4294967295,P=C+(_<<10&4294967295|_>>>22),_=b+(C^(P|~T))+O[2]+718787259&4294967295,b=P+(_<<15&4294967295|_>>>17),_=T+(P^(b|~C))+O[9]+3951481745&4294967295,$.g[0]=$.g[0]+C&4294967295,$.g[1]=$.g[1]+(b+(_<<21&4294967295|_>>>11))&4294967295,$.g[2]=$.g[2]+b&4294967295,$.g[3]=$.g[3]+P&4294967295}n.prototype.u=function($,C){C===void 0&&(C=$.length);for(var T=C-this.blockSize,O=this.B,b=this.h,P=0;P<C;){if(b==0)for(;P<=T;)i(this,$,P),P+=this.blockSize;if(typeof $=="string"){for(;P<C;)if(O[b++]=$.charCodeAt(P++),b==this.blockSize){i(this,O),b=0;break}}else for(;P<C;)if(O[b++]=$[P++],b==this.blockSize){i(this,O),b=0;break}}this.h=b,this.o+=C},n.prototype.v=function(){var $=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);$[0]=128;for(var C=1;C<$.length-8;++C)$[C]=0;var T=8*this.o;for(C=$.length-8;C<$.length;++C)$[C]=T&255,T/=256;for(this.u($),$=Array(16),C=T=0;4>C;++C)for(var O=0;32>O;O+=8)$[T++]=this.g[C]>>>O&255;return $};function o($,C){var T=l;return Object.prototype.hasOwnProperty.call(T,$)?T[$]:T[$]=C($)}function s($,C){this.h=C;for(var T=[],O=!0,b=$.length-1;0<=b;b--){var P=$[b]|0;O&&P==C||(T[b]=P,O=!1)}this.g=T}var l={};function c($){return-128<=$&&128>$?o($,function(C){return new s([C|0],0>C?-1:0)}):new s([$|0],0>$?-1:0)}function u($){if(isNaN($)||!isFinite($))return y;if(0>$)return w(u(-$));for(var C=[],T=1,O=0;$>=T;O++)C[O]=$/T|0,T*=4294967296;return new s(C,0)}function h($,C){if($.length==0)throw Error("number format error: empty string");if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if($.charAt(0)=="-")return w(h($.substring(1),C));if(0<=$.indexOf("-"))throw Error('number format error: interior "-" character');for(var T=u(Math.pow(C,8)),O=y,b=0;b<$.length;b+=8){var P=Math.min(8,$.length-b),_=parseInt($.substring(b,b+P),C);8>P?(P=u(Math.pow(C,P)),O=O.j(P).add(u(_))):(O=O.j(T),O=O.add(u(_)))}return O}var y=c(0),g=c(1),f=c(16777216);t=s.prototype,t.m=function(){if(S(this))return-w(this).m();for(var $=0,C=1,T=0;T<this.g.length;T++){var O=this.i(T);$+=(0<=O?O:4294967296+O)*C,C*=4294967296}return $},t.toString=function($){if($=$||10,2>$||36<$)throw Error("radix out of range: "+$);if(x(this))return"0";if(S(this))return"-"+w(this).toString($);for(var C=u(Math.pow($,6)),T=this,O="";;){var b=W(T,C).g;T=E(T,b.j(C));var P=((0<T.g.length?T.g[0]:T.h)>>>0).toString($);if(T=b,x(T))return P+O;for(;6>P.length;)P="0"+P;O=P+O}},t.i=function($){return 0>$?0:$<this.g.length?this.g[$]:this.h};function x($){if($.h!=0)return!1;for(var C=0;C<$.g.length;C++)if($.g[C]!=0)return!1;return!0}function S($){return $.h==-1}t.l=function($){return $=E(this,$),S($)?-1:x($)?0:1};function w($){for(var C=$.g.length,T=[],O=0;O<C;O++)T[O]=~$.g[O];return new s(T,~$.h).add(g)}t.abs=function(){return S(this)?w(this):this},t.add=function($){for(var C=Math.max(this.g.length,$.g.length),T=[],O=0,b=0;b<=C;b++){var P=O+(this.i(b)&65535)+($.i(b)&65535),_=(P>>>16)+(this.i(b)>>>16)+($.i(b)>>>16);O=_>>>16,P&=65535,_&=65535,T[b]=_<<16|P}return new s(T,T[T.length-1]&-2147483648?-1:0)};function E($,C){return $.add(w(C))}t.j=function($){if(x(this)||x($))return y;if(S(this))return S($)?w(this).j(w($)):w(w(this).j($));if(S($))return w(this.j(w($)));if(0>this.l(f)&&0>$.l(f))return u(this.m()*$.m());for(var C=this.g.length+$.g.length,T=[],O=0;O<2*C;O++)T[O]=0;for(O=0;O<this.g.length;O++)for(var b=0;b<$.g.length;b++){var P=this.i(O)>>>16,_=this.i(O)&65535,z=$.i(b)>>>16,Z=$.i(b)&65535;T[2*O+2*b]+=_*Z,q(T,2*O+2*b),T[2*O+2*b+1]+=P*Z,q(T,2*O+2*b+1),T[2*O+2*b+1]+=_*z,q(T,2*O+2*b+1),T[2*O+2*b+2]+=P*z,q(T,2*O+2*b+2)}for(O=0;O<C;O++)T[O]=T[2*O+1]<<16|T[2*O];for(O=C;O<2*C;O++)T[O]=0;return new s(T,0)};function q($,C){for(;($[C]&65535)!=$[C];)$[C+1]+=$[C]>>>16,$[C]&=65535,C++}function ee($,C){this.g=$,this.h=C}function W($,C){if(x(C))throw Error("division by zero");if(x($))return new ee(y,y);if(S($))return C=W(w($),C),new ee(w(C.g),w(C.h));if(S(C))return C=W($,w(C)),new ee(w(C.g),C.h);if(30<$.g.length){if(S($)||S(C))throw Error("slowDivide_ only works with positive integers.");for(var T=g,O=C;0>=O.l($);)T=K(T),O=K(O);var b=te(T,1),P=te(O,1);for(O=te(O,2),T=te(T,2);!x(O);){var _=P.add(O);0>=_.l($)&&(b=b.add(T),P=_),O=te(O,1),T=te(T,1)}return C=E($,b.j(C)),new ee(b,C)}for(b=y;0<=$.l(C);){for(T=Math.max(1,Math.floor($.m()/C.m())),O=Math.ceil(Math.log(T)/Math.LN2),O=48>=O?1:Math.pow(2,O-48),P=u(T),_=P.j(C);S(_)||0<_.l($);)T-=O,P=u(T),_=P.j(C);x(P)&&(P=g),b=b.add(P),$=E($,_)}return new ee(b,$)}t.A=function($){return W(this,$).h},t.and=function($){for(var C=Math.max(this.g.length,$.g.length),T=[],O=0;O<C;O++)T[O]=this.i(O)&$.i(O);return new s(T,this.h&$.h)},t.or=function($){for(var C=Math.max(this.g.length,$.g.length),T=[],O=0;O<C;O++)T[O]=this.i(O)|$.i(O);return new s(T,this.h|$.h)},t.xor=function($){for(var C=Math.max(this.g.length,$.g.length),T=[],O=0;O<C;O++)T[O]=this.i(O)^$.i(O);return new s(T,this.h^$.h)};function K($){for(var C=$.g.length+1,T=[],O=0;O<C;O++)T[O]=$.i(O)<<1|$.i(O-1)>>>31;return new s(T,$.h)}function te($,C){var T=C>>5;C%=32;for(var O=$.g.length-T,b=[],P=0;P<O;P++)b[P]=0<C?$.i(P+T)>>>C|$.i(P+T+1)<<32-C:$.i(P+T);return new s(b,$.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Y1=n,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=u,s.fromString=h,Aa=s}).apply(typeof sv<"u"?sv:typeof self<"u"?self:typeof window<"u"?window:{});var Ld=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var K1,uu,J1,ah,om,Q1,X1,Z1;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(p,V,le){return p==Array.prototype||p==Object.prototype||(p[V]=le.value),p};function r(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ld=="object"&&Ld];for(var V=0;V<p.length;++V){var le=p[V];if(le&&le.Math==Math)return le}throw Error("Cannot find global object")}var n=r(this);function i(p,V){if(V)e:{var le=n;p=p.split(".");for(var we=0;we<p.length-1;we++){var Ve=p[we];if(!(Ve in le))break e;le=le[Ve]}p=p[p.length-1],we=le[p],V=V(we),V!=we&&V!=null&&e(le,p,{configurable:!0,writable:!0,value:V})}}function o(p,V){p instanceof String&&(p+="");var le=0,we=!1,Ve={next:function(){if(!we&&le<p.length){var tt=le++;return{value:V(tt,p[tt]),done:!1}}return we=!0,{done:!0,value:void 0}}};return Ve[Symbol.iterator]=function(){return Ve},Ve}i("Array.prototype.values",function(p){return p||function(){return o(this,function(V,le){return le})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},l=this||self;function c(p){var V=typeof p;return V=V!="object"?V:p?Array.isArray(p)?"array":V:"null",V=="array"||V=="object"&&typeof p.length=="number"}function u(p){var V=typeof p;return V=="object"&&p!=null||V=="function"}function h(p,V,le){return p.call.apply(p.bind,arguments)}function y(p,V,le){if(!p)throw Error();if(2<arguments.length){var we=Array.prototype.slice.call(arguments,2);return function(){var Ve=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Ve,we),p.apply(V,Ve)}}return function(){return p.apply(V,arguments)}}function g(p,V,le){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:y,g.apply(null,arguments)}function f(p,V){var le=Array.prototype.slice.call(arguments,1);return function(){var we=le.slice();return we.push.apply(we,arguments),p.apply(this,we)}}function x(p,V){function le(){}le.prototype=V.prototype,p.aa=V.prototype,p.prototype=new le,p.prototype.constructor=p,p.Qb=function(we,Ve,tt){for(var Ct=Array(arguments.length-2),Ar=2;Ar<arguments.length;Ar++)Ct[Ar-2]=arguments[Ar];return V.prototype[Ve].apply(we,Ct)}}function S(p){const V=p.length;if(0<V){const le=Array(V);for(let we=0;we<V;we++)le[we]=p[we];return le}return[]}function w(p,V){for(let le=1;le<arguments.length;le++){const we=arguments[le];if(c(we)){const Ve=p.length||0,tt=we.length||0;p.length=Ve+tt;for(let Ct=0;Ct<tt;Ct++)p[Ve+Ct]=we[Ct]}else p.push(we)}}class E{constructor(V,le){this.i=V,this.j=le,this.h=0,this.g=null}get(){let V;return 0<this.h?(this.h--,V=this.g,this.g=V.next,V.next=null):V=this.i(),V}}function q(p){return/^[\s\xa0]*$/.test(p)}function ee(){var p=l.navigator;return p&&(p=p.userAgent)?p:""}function W(p){return W[" "](p),p}W[" "]=function(){};var K=ee().indexOf("Gecko")!=-1&&!(ee().toLowerCase().indexOf("webkit")!=-1&&ee().indexOf("Edge")==-1)&&!(ee().indexOf("Trident")!=-1||ee().indexOf("MSIE")!=-1)&&ee().indexOf("Edge")==-1;function te(p,V,le){for(const we in p)V.call(le,p[we],we,p)}function $(p,V){for(const le in p)V.call(void 0,p[le],le,p)}function C(p){const V={};for(const le in p)V[le]=p[le];return V}const T="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(p,V){let le,we;for(let Ve=1;Ve<arguments.length;Ve++){we=arguments[Ve];for(le in we)p[le]=we[le];for(let tt=0;tt<T.length;tt++)le=T[tt],Object.prototype.hasOwnProperty.call(we,le)&&(p[le]=we[le])}}function b(p){var V=1;p=p.split(":");const le=[];for(;0<V&&p.length;)le.push(p.shift()),V--;return p.length&&le.push(p.join(":")),le}function P(p){l.setTimeout(()=>{throw p},0)}function _(){var p=U;let V=null;return p.g&&(V=p.g,p.g=p.g.next,p.g||(p.h=null),V.next=null),V}class z{constructor(){this.h=this.g=null}add(V,le){const we=Z.get();we.set(V,le),this.h?this.h.next=we:this.g=we,this.h=we}}var Z=new E(()=>new k,p=>p.reset());class k{constructor(){this.next=this.g=this.h=null}set(V,le){this.h=V,this.g=le,this.next=null}reset(){this.next=this.g=this.h=null}}let F,X=!1,U=new z,B=()=>{const p=l.Promise.resolve(void 0);F=()=>{p.then(ce)}};var ce=()=>{for(var p;p=_();){try{p.h.call(p.g)}catch(le){P(le)}var V=Z;V.j(p),100>V.h&&(V.h++,p.next=V.g,V.g=p)}X=!1};function L(){this.s=this.s,this.C=this.C}L.prototype.s=!1,L.prototype.ma=function(){this.s||(this.s=!0,this.N())},L.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(p,V){this.type=p,this.g=this.target=V,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var j=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var p=!1,V=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const le=()=>{};l.addEventListener("test",le,V),l.removeEventListener("test",le,V)}catch{}return p}();function I(p,V){if(D.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p){var le=this.type=p.type,we=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;if(this.target=p.target||p.srcElement,this.g=V,V=p.relatedTarget){if(K){e:{try{W(V.nodeName);var Ve=!0;break e}catch{}Ve=!1}Ve||(V=null)}}else le=="mouseover"?V=p.fromElement:le=="mouseout"&&(V=p.toElement);this.relatedTarget=V,we?(this.clientX=we.clientX!==void 0?we.clientX:we.pageX,this.clientY=we.clientY!==void 0?we.clientY:we.pageY,this.screenX=we.screenX||0,this.screenY=we.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=typeof p.pointerType=="string"?p.pointerType:M[p.pointerType]||"",this.state=p.state,this.i=p,p.defaultPrevented&&I.aa.h.call(this)}}x(I,D);var M={2:"touch",3:"pen",4:"mouse"};I.prototype.h=function(){I.aa.h.call(this);var p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var J="closure_listenable_"+(1e6*Math.random()|0),H=0;function Q(p,V,le,we,Ve){this.listener=p,this.proxy=null,this.src=V,this.type=le,this.capture=!!we,this.ha=Ve,this.key=++H,this.da=this.fa=!1}function se(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function G(p){this.src=p,this.g={},this.h=0}G.prototype.add=function(p,V,le,we,Ve){var tt=p.toString();p=this.g[tt],p||(p=this.g[tt]=[],this.h++);var Ct=oe(p,V,we,Ve);return-1<Ct?(V=p[Ct],le||(V.fa=!1)):(V=new Q(V,this.src,tt,!!we,Ve),V.fa=le,p.push(V)),V};function re(p,V){var le=V.type;if(le in p.g){var we=p.g[le],Ve=Array.prototype.indexOf.call(we,V,void 0),tt;(tt=0<=Ve)&&Array.prototype.splice.call(we,Ve,1),tt&&(se(V),p.g[le].length==0&&(delete p.g[le],p.h--))}}function oe(p,V,le,we){for(var Ve=0;Ve<p.length;++Ve){var tt=p[Ve];if(!tt.da&&tt.listener==V&&tt.capture==!!le&&tt.ha==we)return Ve}return-1}var fe="closure_lm_"+(1e6*Math.random()|0),ae={};function Y(p,V,le,we,Ve){if(Array.isArray(V)){for(var tt=0;tt<V.length;tt++)Y(p,V[tt],le,we,Ve);return null}return le=De(le),p&&p[J]?p.K(V,le,u(we)?!!we.capture:!1,Ve):ie(p,V,le,!1,we,Ve)}function ie(p,V,le,we,Ve,tt){if(!V)throw Error("Invalid event type");var Ct=u(Ve)?!!Ve.capture:!!Ve,Ar=_e(p);if(Ar||(p[fe]=Ar=new G(p)),le=Ar.add(V,le,we,Ct,tt),le.proxy)return le;if(we=de(),le.proxy=we,we.src=p,we.listener=le,p.addEventListener)j||(Ve=Ct),Ve===void 0&&(Ve=!1),p.addEventListener(V.toString(),we,Ve);else if(p.attachEvent)p.attachEvent(Pe(V.toString()),we);else if(p.addListener&&p.removeListener)p.addListener(we);else throw Error("addEventListener and attachEvent are unavailable.");return le}function de(){function p(le){return V.call(p.src,p.listener,le)}const V=pe;return p}function ue(p,V,le,we,Ve){if(Array.isArray(V))for(var tt=0;tt<V.length;tt++)ue(p,V[tt],le,we,Ve);else we=u(we)?!!we.capture:!!we,le=De(le),p&&p[J]?(p=p.i,V=String(V).toString(),V in p.g&&(tt=p.g[V],le=oe(tt,le,we,Ve),-1<le&&(se(tt[le]),Array.prototype.splice.call(tt,le,1),tt.length==0&&(delete p.g[V],p.h--)))):p&&(p=_e(p))&&(V=p.g[V.toString()],p=-1,V&&(p=oe(V,le,we,Ve)),(le=-1<p?V[p]:null)&&ge(le))}function ge(p){if(typeof p!="number"&&p&&!p.da){var V=p.src;if(V&&V[J])re(V.i,p);else{var le=p.type,we=p.proxy;V.removeEventListener?V.removeEventListener(le,we,p.capture):V.detachEvent?V.detachEvent(Pe(le),we):V.addListener&&V.removeListener&&V.removeListener(we),(le=_e(V))?(re(le,p),le.h==0&&(le.src=null,V[fe]=null)):se(p)}}}function Pe(p){return p in ae?ae[p]:ae[p]="on"+p}function pe(p,V){if(p.da)p=!0;else{V=new I(V,this);var le=p.listener,we=p.ha||p.src;p.fa&&ge(p),p=le.call(we,V)}return p}function _e(p){return p=p[fe],p instanceof G?p:null}var Le="__closure_events_fn_"+(1e9*Math.random()>>>0);function De(p){return typeof p=="function"?p:(p[Le]||(p[Le]=function(V){return p.handleEvent(V)}),p[Le])}function Te(){L.call(this),this.i=new G(this),this.M=this,this.F=null}x(Te,L),Te.prototype[J]=!0,Te.prototype.removeEventListener=function(p,V,le,we){ue(this,p,V,le,we)};function $e(p,V){var le,we=p.F;if(we)for(le=[];we;we=we.F)le.push(we);if(p=p.M,we=V.type||V,typeof V=="string")V=new D(V,p);else if(V instanceof D)V.target=V.target||p;else{var Ve=V;V=new D(we,p),O(V,Ve)}if(Ve=!0,le)for(var tt=le.length-1;0<=tt;tt--){var Ct=V.g=le[tt];Ve=Ie(Ct,we,!0,V)&&Ve}if(Ct=V.g=p,Ve=Ie(Ct,we,!0,V)&&Ve,Ve=Ie(Ct,we,!1,V)&&Ve,le)for(tt=0;tt<le.length;tt++)Ct=V.g=le[tt],Ve=Ie(Ct,we,!1,V)&&Ve}Te.prototype.N=function(){if(Te.aa.N.call(this),this.i){var p=this.i,V;for(V in p.g){for(var le=p.g[V],we=0;we<le.length;we++)se(le[we]);delete p.g[V],p.h--}}this.F=null},Te.prototype.K=function(p,V,le,we){return this.i.add(String(p),V,!1,le,we)},Te.prototype.L=function(p,V,le,we){return this.i.add(String(p),V,!0,le,we)};function Ie(p,V,le,we){if(V=p.i.g[String(V)],!V)return!0;V=V.concat();for(var Ve=!0,tt=0;tt<V.length;++tt){var Ct=V[tt];if(Ct&&!Ct.da&&Ct.capture==le){var Ar=Ct.listener,Dr=Ct.ha||Ct.src;Ct.fa&&re(p.i,Ct),Ve=Ar.call(Dr,we)!==!1&&Ve}}return Ve&&!we.defaultPrevented}function Re(p,V,le){if(typeof p=="function")le&&(p=g(p,le));else if(p&&typeof p.handleEvent=="function")p=g(p.handleEvent,p);else throw Error("Invalid listener argument");return 2147483647<Number(V)?-1:l.setTimeout(p,V||0)}function Je(p){p.g=Re(()=>{p.g=null,p.i&&(p.i=!1,Je(p))},p.l);const V=p.h;p.h=null,p.m.apply(null,V)}class Be extends L{constructor(V,le){super(),this.m=V,this.l=le,this.h=null,this.i=!1,this.g=null}j(V){this.h=arguments,this.g?this.i=!0:Je(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ke(p){L.call(this),this.h=p,this.g={}}x(Ke,L);var Xe=[];function at(p){te(p.g,function(V,le){this.g.hasOwnProperty(le)&&ge(V)},p),p.g={}}Ke.prototype.N=function(){Ke.aa.N.call(this),at(this)},Ke.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ot=l.JSON.stringify,Qe=l.JSON.parse,dt=class{stringify(p){return l.JSON.stringify(p,void 0)}parse(p){return l.JSON.parse(p,void 0)}};function ct(){}ct.prototype.h=null;function kt(p){return p.h||(p.h=p.i())}function gt(){}var qe={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Dt(){D.call(this,"d")}x(Dt,D);function Rt(){D.call(this,"c")}x(Rt,D);var St={},Bt=null;function fr(){return Bt=Bt||new Te}St.La="serverreachability";function Qt(p){D.call(this,St.La,p)}x(Qt,D);function cr(p){const V=fr();$e(V,new Qt(V))}St.STAT_EVENT="statevent";function xr(p,V){D.call(this,St.STAT_EVENT,p),this.stat=V}x(xr,D);function It(p){const V=fr();$e(V,new xr(V,p))}St.Ma="timingevent";function Ge(p,V){D.call(this,St.Ma,p),this.size=V}x(Ge,D);function Nt(p,V){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){p()},V)}function At(){this.g=!0}At.prototype.xa=function(){this.g=!1};function Lt(p,V,le,we,Ve,tt){p.info(function(){if(p.g)if(tt)for(var Ct="",Ar=tt.split("&"),Dr=0;Dr<Ar.length;Dr++){var Cr=Ar[Dr].split("=");if(1<Cr.length){var Zr=Cr[0];Cr=Cr[1];var an=Zr.split("_");Ct=2<=an.length&&an[1]=="type"?Ct+(Zr+"="+Cr+"&"):Ct+(Zr+"=redacted&")}}else Ct=null;else Ct=tt;return"XMLHTTP REQ ("+we+") [attempt "+Ve+"]: "+V+`
`+le+`
`+Ct})}function Ue(p,V,le,we,Ve,tt,Ct){p.info(function(){return"XMLHTTP RESP ("+we+") [ attempt "+Ve+"]: "+V+`
`+le+`
`+tt+" "+Ct})}function nt(p,V,le,we){p.info(function(){return"XMLHTTP TEXT ("+V+"): "+Wt(p,le)+(we?" "+we:"")})}function _t(p,V){p.info(function(){return"TIMEOUT: "+V})}At.prototype.info=function(){};function Wt(p,V){if(!p.g)return V;if(!V)return null;try{var le=JSON.parse(V);if(le){for(p=0;p<le.length;p++)if(Array.isArray(le[p])){var we=le[p];if(!(2>we.length)){var Ve=we[1];if(Array.isArray(Ve)&&!(1>Ve.length)){var tt=Ve[0];if(tt!="noop"&&tt!="stop"&&tt!="close")for(var Ct=1;Ct<Ve.length;Ct++)Ve[Ct]=""}}}}return ot(le)}catch{return V}}var We={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},vt={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Tt;function jt(){}x(jt,ct),jt.prototype.g=function(){return new XMLHttpRequest},jt.prototype.i=function(){return{}},Tt=new jt;function Kt(p,V,le,we){this.j=p,this.i=V,this.l=le,this.R=we||1,this.U=new Ke(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new rr}function rr(){this.i=null,this.g="",this.h=!1}var yr={},nr={};function ur(p,V,le){p.L=1,p.v=qi(Rr(V)),p.m=le,p.P=!0,Ft(p,null)}function Ft(p,V){p.F=Date.now(),Zt(p),p.A=Rr(p.v);var le=p.A,we=p.R;Array.isArray(we)||(we=[String(we)]),Sr(le.i,"t",we),p.C=0,le=p.j.J,p.h=new rr,p.g=me(p.j,le?V:null,!p.m),0<p.O&&(p.M=new Be(g(p.Y,p,p.g),p.O)),V=p.U,le=p.g,we=p.ca;var Ve="readystatechange";Array.isArray(Ve)||(Ve&&(Xe[0]=Ve.toString()),Ve=Xe);for(var tt=0;tt<Ve.length;tt++){var Ct=Y(le,Ve[tt],we||V.handleEvent,!1,V.h||V);if(!Ct)break;V.g[Ct.key]=Ct}V=p.H?C(p.H):{},p.m?(p.u||(p.u="POST"),V["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.A,p.u,p.m,V)):(p.u="GET",p.g.ea(p.A,p.u,null,V)),cr(),Lt(p.i,p.u,p.A,p.l,p.R,p.m)}Kt.prototype.ca=function(p){p=p.target;const V=this.M;V&&jn(p)==3?V.j():this.Y(p)},Kt.prototype.Y=function(p){try{if(p==this.g)e:{const an=jn(this.g);var V=this.g.Ba();const _o=this.g.Z();if(!(3>an)&&(an!=3||this.g&&(this.h.h||this.g.oa()||Ol(this.g)))){this.J||an!=4||V==7||(V==8||0>=_o?cr(3):cr(2)),er(this);var le=this.g.Z();this.X=le;t:if($t(this)){var we=Ol(this.g);p="";var Ve=we.length,tt=jn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){sr(this),ir(this);var Ct="";break t}this.h.i=new l.TextDecoder}for(V=0;V<Ve;V++)this.h.h=!0,p+=this.h.i.decode(we[V],{stream:!(tt&&V==Ve-1)});we.length=0,this.h.g+=p,this.C=0,Ct=this.h.g}else Ct=this.g.oa();if(this.o=le==200,Ue(this.i,this.u,this.A,this.l,this.R,an,le),this.o){if(this.T&&!this.K){t:{if(this.g){var Ar,Dr=this.g;if((Ar=Dr.g?Dr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!q(Ar)){var Cr=Ar;break t}}Cr=null}if(le=Cr)nt(this.i,this.l,le,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,_r(this,le);else{this.o=!1,this.s=3,It(12),sr(this),ir(this);break e}}if(this.P){le=!0;let Jn;for(;!this.J&&this.C<Ct.length;)if(Jn=wt(this,Ct),Jn==nr){an==4&&(this.s=4,It(14),le=!1),nt(this.i,this.l,null,"[Incomplete Response]");break}else if(Jn==yr){this.s=4,It(15),nt(this.i,this.l,Ct,"[Invalid Chunk]"),le=!1;break}else nt(this.i,this.l,Jn,null),_r(this,Jn);if($t(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),an!=4||Ct.length!=0||this.h.h||(this.s=1,It(16),le=!1),this.o=this.o&&le,!le)nt(this.i,this.l,Ct,"[Invalid Chunked Response]"),sr(this),ir(this);else if(0<Ct.length&&!this.W){this.W=!0;var Zr=this.j;Zr.g==this&&Zr.ba&&!Zr.M&&(Zr.j.info("Great, no buffering proxy detected. Bytes received: "+Ct.length),Ws(Zr),Zr.M=!0,It(11))}}else nt(this.i,this.l,Ct,null),_r(this,Ct);an==4&&sr(this),this.o&&!this.J&&(an==4?Bo(this.j,this):(this.o=!1,Zt(this)))}else Fo(this.g),le==400&&0<Ct.indexOf("Unknown SID")?(this.s=3,It(12)):(this.s=0,It(13)),sr(this),ir(this)}}}catch{}finally{}};function $t(p){return p.g?p.u=="GET"&&p.L!=2&&p.j.Ca:!1}function wt(p,V){var le=p.C,we=V.indexOf(`
`,le);return we==-1?nr:(le=Number(V.substring(le,we)),isNaN(le)?yr:(we+=1,we+le>V.length?nr:(V=V.slice(we,we+le),p.C=we+le,V)))}Kt.prototype.cancel=function(){this.J=!0,sr(this)};function Zt(p){p.S=Date.now()+p.I,lt(p,p.I)}function lt(p,V){if(p.B!=null)throw Error("WatchDog timer not null");p.B=Nt(g(p.ba,p),V)}function er(p){p.B&&(l.clearTimeout(p.B),p.B=null)}Kt.prototype.ba=function(){this.B=null;const p=Date.now();0<=p-this.S?(_t(this.i,this.A),this.L!=2&&(cr(),It(17)),sr(this),this.s=2,ir(this)):lt(this,this.S-p)};function ir(p){p.j.G==0||p.J||Bo(p.j,p)}function sr(p){er(p);var V=p.M;V&&typeof V.ma=="function"&&V.ma(),p.M=null,at(p.U),p.g&&(V=p.g,p.g=null,V.abort(),V.ma())}function _r(p,V){try{var le=p.j;if(le.G!=0&&(le.g==p||Yr(le.h,p))){if(!p.K&&Yr(le.h,p)&&le.G==3){try{var we=le.Da.g.parse(V)}catch{we=null}if(Array.isArray(we)&&we.length==3){var Ve=we;if(Ve[0]==0){e:if(!le.u){if(le.g)if(le.g.F+3e3<p.F)bo(le),zs(le);else break e;us(le),It(18)}}else le.za=Ve[1],0<le.za-le.T&&37500>Ve[2]&&le.F&&le.v==0&&!le.C&&(le.C=Nt(g(le.Za,le),6e3));if(1>=Ur(le.h)&&le.ca){try{le.ca()}catch{}le.ca=void 0}}else ii(le,11)}else if((p.K||le.g==p)&&bo(le),!q(V))for(Ve=le.Da.g.parse(V),V=0;V<Ve.length;V++){let Cr=Ve[V];if(le.T=Cr[0],Cr=Cr[1],le.G==2)if(Cr[0]=="c"){le.K=Cr[1],le.ia=Cr[2];const Zr=Cr[3];Zr!=null&&(le.la=Zr,le.j.info("VER="+le.la));const an=Cr[4];an!=null&&(le.Aa=an,le.j.info("SVER="+le.Aa));const _o=Cr[5];_o!=null&&typeof _o=="number"&&0<_o&&(we=1.5*_o,le.L=we,le.j.info("backChannelRequestTimeoutMs_="+we)),we=le;const Jn=p.g;if(Jn){const jo=Jn.g?Jn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(jo){var tt=we.h;tt.g||jo.indexOf("spdy")==-1&&jo.indexOf("quic")==-1&&jo.indexOf("h2")==-1||(tt.j=tt.l,tt.g=new Set,tt.h&&(Et(tt,tt.h),tt.h=null))}if(we.D){const Vo=Jn.g?Jn.g.getResponseHeader("X-HTTP-Session-Id"):null;Vo&&(we.ya=Vo,Hr(we.I,we.D,Vo))}}le.G=3,le.l&&le.l.ua(),le.ba&&(le.R=Date.now()-p.F,le.j.info("Handshake RTT: "+le.R+"ms")),we=le;var Ct=p;if(we.qa=A(we,we.J?we.ia:null,we.W),Ct.K){bn(we.h,Ct);var Ar=Ct,Dr=we.L;Dr&&(Ar.I=Dr),Ar.B&&(er(Ar),Zt(Ar)),we.g=Ct}else Gs(we);0<le.i.length&&Us(le)}else Cr[0]!="stop"&&Cr[0]!="close"||ii(le,7);else le.G==3&&(Cr[0]=="stop"||Cr[0]=="close"?Cr[0]=="stop"?ii(le,7):vo(le):Cr[0]!="noop"&&le.l&&le.l.ta(Cr),le.v=0)}}cr(4)}catch{}}var lr=class{constructor(p,V){this.g=p,this.map=V}};function Lr(p){this.l=p||10,l.PerformanceNavigationTiming?(p=l.performance.getEntriesByType("navigation"),p=0<p.length&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function on(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function Ur(p){return p.h?1:p.g?p.g.size:0}function Yr(p,V){return p.h?p.h==V:p.g?p.g.has(V):!1}function Et(p,V){p.g?p.g.add(V):p.h=V}function bn(p,V){p.h&&p.h==V?p.h=null:p.g&&p.g.has(V)&&p.g.delete(V)}Lr.prototype.cancel=function(){if(this.i=_i(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function _i(p){if(p.h!=null)return p.i.concat(p.h.D);if(p.g!=null&&p.g.size!==0){let V=p.i;for(const le of p.g.values())V=V.concat(le.D);return V}return S(p.i)}function Si(p){if(p.V&&typeof p.V=="function")return p.V();if(typeof Map<"u"&&p instanceof Map||typeof Set<"u"&&p instanceof Set)return Array.from(p.values());if(typeof p=="string")return p.split("");if(c(p)){for(var V=[],le=p.length,we=0;we<le;we++)V.push(p[we]);return V}V=[],le=0;for(we in p)V[le++]=p[we];return V}function mr(p){if(p.na&&typeof p.na=="function")return p.na();if(!p.V||typeof p.V!="function"){if(typeof Map<"u"&&p instanceof Map)return Array.from(p.keys());if(!(typeof Set<"u"&&p instanceof Set)){if(c(p)||typeof p=="string"){var V=[];p=p.length;for(var le=0;le<p;le++)V.push(le);return V}V=[],le=0;for(const we in p)V[le++]=we;return V}}}function Nr(p,V){if(p.forEach&&typeof p.forEach=="function")p.forEach(V,void 0);else if(c(p)||typeof p=="string")Array.prototype.forEach.call(p,V,void 0);else for(var le=mr(p),we=Si(p),Ve=we.length,tt=0;tt<Ve;tt++)V.call(void 0,we[tt],le&&le[tt],p)}var Vr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function gn(p,V){if(p){p=p.split("&");for(var le=0;le<p.length;le++){var we=p[le].indexOf("="),Ve=null;if(0<=we){var tt=p[le].substring(0,we);Ve=p[le].substring(we+1)}else tt=p[le];V(tt,Ve?decodeURIComponent(Ve.replace(/\+/g," ")):"")}}}function qr(p){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,p instanceof qr){this.h=p.h,Bn(this,p.j),this.o=p.o,this.g=p.g,Hn(this,p.s),this.l=p.l;var V=p.i,le=new Do;le.i=V.i,V.g&&(le.g=new Map(V.g),le.h=V.h),Pi(this,le),this.m=p.m}else p&&(V=String(p).match(Vr))?(this.h=!1,Bn(this,V[1]||"",!0),this.o=zi(V[2]||""),this.g=zi(V[3]||"",!0),Hn(this,V[4]),this.l=zi(V[5]||"",!0),Pi(this,V[6]||"",!0),this.m=zi(V[7]||"")):(this.h=!1,this.i=new Do(null,this.h))}qr.prototype.toString=function(){var p=[],V=this.j;V&&p.push(Ui(V,Ds,!0),":");var le=this.g;return(le||V=="file")&&(p.push("//"),(V=this.o)&&p.push(Ui(V,Ds,!0),"@"),p.push(encodeURIComponent(String(le)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),le=this.s,le!=null&&p.push(":",String(le))),(le=this.l)&&(this.g&&le.charAt(0)!="/"&&p.push("/"),p.push(Ui(le,le.charAt(0)=="/"?wi:ss,!0))),(le=this.i.toString())&&p.push("?",le),(le=this.m)&&p.push("#",Ui(le,Fs)),p.join("")};function Rr(p){return new qr(p)}function Bn(p,V,le){p.j=le?zi(V,!0):V,p.j&&(p.j=p.j.replace(/:$/,""))}function Hn(p,V){if(V){if(V=Number(V),isNaN(V)||0>V)throw Error("Bad port number "+V);p.s=V}else p.s=null}function Pi(p,V,le){V instanceof Do?(p.i=V,Fc(p.i,p.h)):(le||(V=Ui(V,Ms)),p.i=new Do(V,p.h))}function Hr(p,V,le){p.i.set(V,le)}function qi(p){return Hr(p,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),p}function zi(p,V){return p?V?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function Ui(p,V,le){return typeof p=="string"?(p=encodeURI(p).replace(V,ja),le&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function ja(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Ds=/[#\/\?@]/g,ss=/[#\?:]/g,wi=/[#\?]/g,Ms=/[#\?@]/g,Fs=/#/g;function Do(p,V){this.h=this.g=null,this.i=p||null,this.j=!!V}function fn(p){p.g||(p.g=new Map,p.h=0,p.i&&gn(p.i,function(V,le){p.add(decodeURIComponent(V.replace(/\+/g," ")),le)}))}t=Do.prototype,t.add=function(p,V){fn(this),this.i=null,p=Mo(this,p);var le=this.g.get(p);return le||this.g.set(p,le=[]),le.push(V),this.h+=1,this};function Dl(p,V){fn(p),V=Mo(p,V),p.g.has(V)&&(p.i=null,p.h-=p.g.get(V).length,p.g.delete(V))}function Va(p,V){return fn(p),V=Mo(p,V),p.g.has(V)}t.forEach=function(p,V){fn(this),this.g.forEach(function(le,we){le.forEach(function(Ve){p.call(V,Ve,we,this)},this)},this)},t.na=function(){fn(this);const p=Array.from(this.g.values()),V=Array.from(this.g.keys()),le=[];for(let we=0;we<V.length;we++){const Ve=p[we];for(let tt=0;tt<Ve.length;tt++)le.push(V[we])}return le},t.V=function(p){fn(this);let V=[];if(typeof p=="string")Va(this,p)&&(V=V.concat(this.g.get(Mo(this,p))));else{p=Array.from(this.g.values());for(let le=0;le<p.length;le++)V=V.concat(p[le])}return V},t.set=function(p,V){return fn(this),this.i=null,p=Mo(this,p),Va(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[V]),this.h+=1,this},t.get=function(p,V){return p?(p=this.V(p),0<p.length?String(p[0]):V):V};function Sr(p,V,le){Dl(p,V),0<le.length&&(p.i=null,p.g.set(Mo(p,V),S(le)),p.h+=le.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],V=Array.from(this.g.keys());for(var le=0;le<V.length;le++){var we=V[le];const tt=encodeURIComponent(String(we)),Ct=this.V(we);for(we=0;we<Ct.length;we++){var Ve=tt;Ct[we]!==""&&(Ve+="="+encodeURIComponent(String(Ct[we]))),p.push(Ve)}}return this.i=p.join("&")};function Mo(p,V){return V=String(V),p.j&&(V=V.toLowerCase()),V}function Fc(p,V){V&&!p.j&&(fn(p),p.i=null,p.g.forEach(function(le,we){var Ve=we.toLowerCase();we!=Ve&&(Dl(this,we),Sr(this,Ve,le))},p)),p.j=V}function ro(p,V){const le=new At;if(l.Image){const we=new Image;we.onload=f(Hi,le,"TestLoadImage: loaded",!0,V,we),we.onerror=f(Hi,le,"TestLoadImage: error",!1,V,we),we.onabort=f(Hi,le,"TestLoadImage: abort",!1,V,we),we.ontimeout=f(Hi,le,"TestLoadImage: timeout",!1,V,we),l.setTimeout(function(){we.ontimeout&&we.ontimeout()},1e4),we.src=p}else V(!1)}function Ml(p,V){const le=new At,we=new AbortController,Ve=setTimeout(()=>{we.abort(),Hi(le,"TestPingServer: timeout",!1,V)},1e4);fetch(p,{signal:we.signal}).then(tt=>{clearTimeout(Ve),tt.ok?Hi(le,"TestPingServer: ok",!0,V):Hi(le,"TestPingServer: server error",!1,V)}).catch(()=>{clearTimeout(Ve),Hi(le,"TestPingServer: error",!1,V)})}function Hi(p,V,le,we,Ve){try{Ve&&(Ve.onload=null,Ve.onerror=null,Ve.onabort=null,Ve.ontimeout=null),we(le)}catch{}}function Os(){this.g=new dt}function qa(p,V,le){const we=le||"";try{Nr(p,function(Ve,tt){let Ct=Ve;u(Ve)&&(Ct=ot(Ve)),V.push(we+tt+"="+encodeURIComponent(Ct))})}catch(Ve){throw V.push(we+"type="+encodeURIComponent("_badmap")),Ve}}function Bs(p){this.l=p.Ub||null,this.j=p.eb||!1}x(Bs,ct),Bs.prototype.g=function(){return new js(this.l,this.j)},Bs.prototype.i=function(p){return function(){return p}}({});function js(p,V){Te.call(this),this.D=p,this.o=V,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(js,Te),t=js.prototype,t.open=function(p,V){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=p,this.A=V,this.readyState=1,Gi(this)},t.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const V={headers:this.u,method:this.B,credentials:this.m,cache:void 0};p&&(V.body=p),(this.D||l).fetch(new Request(this.A,V)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,yo(this)),this.readyState=0},t.Sa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,Gi(this)),this.g&&(this.readyState=3,Gi(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Fl(this)}else p.text().then(this.Ra.bind(this),this.ga.bind(this))};function Fl(p){p.j.read().then(p.Pa.bind(p)).catch(p.ga.bind(p))}t.Pa=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var V=p.value?p.value:new Uint8Array(0);(V=this.v.decode(V,{stream:!p.done}))&&(this.response=this.responseText+=V)}p.done?yo(this):Gi(this),this.readyState==3&&Fl(this)}},t.Ra=function(p){this.g&&(this.response=this.responseText=p,yo(this))},t.Qa=function(p){this.g&&(this.response=p,yo(this))},t.ga=function(){this.g&&yo(this)};function yo(p){p.readyState=4,p.l=null,p.j=null,p.v=null,Gi(p)}t.setRequestHeader=function(p,V){this.u.append(p,V)},t.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],V=this.h.entries();for(var le=V.next();!le.done;)le=le.value,p.push(le[0]+": "+le[1]),le=V.next();return p.join(`\r
`)};function Gi(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(js.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function go(p){let V="";return te(p,function(le,we){V+=we,V+=":",V+=le,V+=`\r
`}),V}function za(p,V,le){e:{for(we in le){var we=!1;break e}we=!0}we||(le=go(le),typeof p=="string"?le!=null&&encodeURIComponent(String(le)):Hr(p,V,le))}function Xr(p){Te.call(this),this.headers=new Map,this.o=p||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(Xr,Te);var Ua=/^https?$/i,Vs=["POST","PUT"];t=Xr.prototype,t.Ha=function(p){this.J=p},t.ea=function(p,V,le,we){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);V=V?V.toUpperCase():"GET",this.D=p,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Tt.g(),this.v=this.o?kt(this.o):kt(Tt),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(V,String(p),!0),this.B=!1}catch(tt){Ha(this,tt);return}if(p=le||"",le=new Map(this.headers),we)if(Object.getPrototypeOf(we)===Object.prototype)for(var Ve in we)le.set(Ve,we[Ve]);else if(typeof we.keys=="function"&&typeof we.get=="function")for(const tt of we.keys())le.set(tt,we.get(tt));else throw Error("Unknown input type for opt_headers: "+String(we));we=Array.from(le.keys()).find(tt=>tt.toLowerCase()=="content-type"),Ve=l.FormData&&p instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Vs,V,void 0))||we||Ve||le.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[tt,Ct]of le)this.g.setRequestHeader(tt,Ct);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Wi(this),this.u=!0,this.g.send(p),this.u=!1}catch(tt){Ha(this,tt)}};function Ha(p,V){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=V,p.m=5,Ga(p),as(p)}function Ga(p){p.A||(p.A=!0,$e(p,"complete"),$e(p,"error"))}t.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=p||7,$e(this,"complete"),$e(this,"abort"),as(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),as(this,!0)),Xr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Wa(this):this.bb())},t.bb=function(){Wa(this)};function Wa(p){if(p.h&&typeof s<"u"&&(!p.v[1]||jn(p)!=4||p.Z()!=2)){if(p.u&&jn(p)==4)Re(p.Ea,0,p);else if($e(p,"readystatechange"),jn(p)==4){p.h=!1;try{const Ct=p.Z();e:switch(Ct){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var V=!0;break e;default:V=!1}var le;if(!(le=V)){var we;if(we=Ct===0){var Ve=String(p.D).match(Vr)[1]||null;!Ve&&l.self&&l.self.location&&(Ve=l.self.location.protocol.slice(0,-1)),we=!Ua.test(Ve?Ve.toLowerCase():"")}le=we}if(le)$e(p,"complete"),$e(p,"success");else{p.m=6;try{var tt=2<jn(p)?p.g.statusText:""}catch{tt=""}p.l=tt+" ["+p.Z()+"]",Ga(p)}}finally{as(p)}}}}function as(p,V){if(p.g){Wi(p);const le=p.g,we=p.v[0]?()=>{}:null;p.g=null,p.v=null,V||$e(p,"ready");try{le.onreadystatechange=we}catch{}}}function Wi(p){p.I&&(l.clearTimeout(p.I),p.I=null)}t.isActive=function(){return!!this.g};function jn(p){return p.g?p.g.readyState:0}t.Z=function(){try{return 2<jn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(p){if(this.g){var V=this.g.responseText;return p&&V.indexOf(p)==0&&(V=V.substring(p.length)),Qe(V)}};function Ol(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.H){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function Fo(p){const V={};p=(p.g&&2<=jn(p)&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let we=0;we<p.length;we++){if(q(p[we]))continue;var le=b(p[we]);const Ve=le[0];if(le=le[1],typeof le!="string")continue;le=le.trim();const tt=V[Ve]||[];V[Ve]=tt,tt.push(le)}$(V,function(we){return we.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Kn(p,V,le){return le&&le.internalChannelParams&&le.internalChannelParams[p]||V}function qs(p){this.Aa=0,this.i=[],this.j=new At,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Kn("failFast",!1,p),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Kn("baseRetryDelayMs",5e3,p),this.cb=Kn("retryDelaySeedMs",1e4,p),this.Wa=Kn("forwardChannelMaxRetries",2,p),this.wa=Kn("forwardChannelRequestTimeoutMs",2e4,p),this.pa=p&&p.xmlHttpFactory||void 0,this.Xa=p&&p.Tb||void 0,this.Ca=p&&p.useFetchStreams||!1,this.L=void 0,this.J=p&&p.supportsCrossDomainXhr||!1,this.K="",this.h=new Lr(p&&p.concurrentRequestLimit),this.Da=new Os,this.P=p&&p.fastHandshake||!1,this.O=p&&p.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=p&&p.Rb||!1,p&&p.xa&&this.j.xa(),p&&p.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&p&&p.detectBufferingProxy||!1,this.ja=void 0,p&&p.longPollingTimeout&&0<p.longPollingTimeout&&(this.ja=p.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=qs.prototype,t.la=8,t.G=1,t.connect=function(p,V,le,we){It(0),this.W=p,this.H=V||{},le&&we!==void 0&&(this.H.OSID=le,this.H.OAID=we),this.F=this.X,this.I=A(this,null,this.W),Us(this)};function vo(p){if(ls(p),p.G==3){var V=p.U++,le=Rr(p.I);if(Hr(le,"SID",p.K),Hr(le,"RID",V),Hr(le,"TYPE","terminate"),Oo(p,le),V=new Kt(p,p.j,V),V.L=2,V.v=qi(Rr(le)),le=!1,l.navigator&&l.navigator.sendBeacon)try{le=l.navigator.sendBeacon(V.v.toString(),"")}catch{}!le&&l.Image&&(new Image().src=V.v,le=!0),le||(V.g=me(V.j,null),V.g.ea(V.v)),V.F=Date.now(),Zt(V)}Ks(p)}function zs(p){p.g&&(Ws(p),p.g.cancel(),p.g=null)}function ls(p){zs(p),p.u&&(l.clearTimeout(p.u),p.u=null),bo(p),p.h.cancel(),p.s&&(typeof p.s=="number"&&l.clearTimeout(p.s),p.s=null)}function Us(p){if(!on(p.h)&&!p.s){p.s=!0;var V=p.Ga;F||B(),X||(F(),X=!0),U.add(V,p),p.B=0}}function Ya(p,V){return Ur(p.h)>=p.h.j-(p.s?1:0)?!1:p.s?(p.i=V.D.concat(p.i),!0):p.G==1||p.G==2||p.B>=(p.Va?0:p.Wa)?!1:(p.s=Nt(g(p.Ga,p,V),Ys(p,p.B)),p.B++,!0)}t.Ga=function(p){if(this.s)if(this.s=null,this.G==1){if(!p){this.U=Math.floor(1e5*Math.random()),p=this.U++;const Ve=new Kt(this,this.j,p);let tt=this.o;if(this.S&&(tt?(tt=C(tt),O(tt,this.S)):tt=this.S),this.m!==null||this.O||(Ve.H=tt,tt=null),this.P)e:{for(var V=0,le=0;le<this.i.length;le++){t:{var we=this.i[le];if("__data__"in we.map&&(we=we.map.__data__,typeof we=="string")){we=we.length;break t}we=void 0}if(we===void 0)break;if(V+=we,4096<V){V=le;break e}if(V===4096||le===this.i.length-1){V=le+1;break e}}V=1e3}else V=1e3;V=cs(this,Ve,V),le=Rr(this.I),Hr(le,"RID",p),Hr(le,"CVER",22),this.D&&Hr(le,"X-HTTP-Session-Id",this.D),Oo(this,le),tt&&(this.O?V="headers="+encodeURIComponent(String(go(tt)))+"&"+V:this.m&&za(le,this.m,tt)),Et(this.h,Ve),this.Ua&&Hr(le,"TYPE","init"),this.P?(Hr(le,"$req",V),Hr(le,"SID","null"),Ve.T=!0,ur(Ve,le,null)):ur(Ve,le,V),this.G=2}}else this.G==3&&(p?Hs(this,p):this.i.length==0||on(this.h)||Hs(this))};function Hs(p,V){var le;V?le=V.l:le=p.U++;const we=Rr(p.I);Hr(we,"SID",p.K),Hr(we,"RID",le),Hr(we,"AID",p.T),Oo(p,we),p.m&&p.o&&za(we,p.m,p.o),le=new Kt(p,p.j,le,p.B+1),p.m===null&&(le.H=p.o),V&&(p.i=V.D.concat(p.i)),V=cs(p,le,1e3),le.I=Math.round(.5*p.wa)+Math.round(.5*p.wa*Math.random()),Et(p.h,le),ur(le,we,V)}function Oo(p,V){p.H&&te(p.H,function(le,we){Hr(V,we,le)}),p.l&&Nr({},function(le,we){Hr(V,we,le)})}function cs(p,V,le){le=Math.min(p.i.length,le);var we=p.l?g(p.l.Na,p.l,p):null;e:{var Ve=p.i;let tt=-1;for(;;){const Ct=["count="+le];tt==-1?0<le?(tt=Ve[0].g,Ct.push("ofs="+tt)):tt=0:Ct.push("ofs="+tt);let Ar=!0;for(let Dr=0;Dr<le;Dr++){let Cr=Ve[Dr].g;const Zr=Ve[Dr].map;if(Cr-=tt,0>Cr)tt=Math.max(0,Ve[Dr].g-100),Ar=!1;else try{qa(Zr,Ct,"req"+Cr+"_")}catch{we&&we(Zr)}}if(Ar){we=Ct.join("&");break e}}}return p=p.i.splice(0,le),V.D=p,we}function Gs(p){if(!p.g&&!p.u){p.Y=1;var V=p.Fa;F||B(),X||(F(),X=!0),U.add(V,p),p.v=0}}function us(p){return p.g||p.u||3<=p.v?!1:(p.Y++,p.u=Nt(g(p.Fa,p),Ys(p,p.v)),p.v++,!0)}t.Fa=function(){if(this.u=null,Bl(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var p=2*this.R;this.j.info("BP detection timer enabled: "+p),this.A=Nt(g(this.ab,this),p)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,It(10),zs(this),Bl(this))};function Ws(p){p.A!=null&&(l.clearTimeout(p.A),p.A=null)}function Bl(p){p.g=new Kt(p,p.j,"rpc",p.Y),p.m===null&&(p.g.H=p.o),p.g.O=0;var V=Rr(p.qa);Hr(V,"RID","rpc"),Hr(V,"SID",p.K),Hr(V,"AID",p.T),Hr(V,"CI",p.F?"0":"1"),!p.F&&p.ja&&Hr(V,"TO",p.ja),Hr(V,"TYPE","xmlhttp"),Oo(p,V),p.m&&p.o&&za(V,p.m,p.o),p.L&&(p.g.I=p.L);var le=p.g;p=p.ia,le.L=1,le.v=qi(Rr(V)),le.m=null,le.P=!0,Ft(le,p)}t.Za=function(){this.C!=null&&(this.C=null,zs(this),us(this),It(19))};function bo(p){p.C!=null&&(l.clearTimeout(p.C),p.C=null)}function Bo(p,V){var le=null;if(p.g==V){bo(p),Ws(p),p.g=null;var we=2}else if(Yr(p.h,V))le=V.D,bn(p.h,V),we=1;else return;if(p.G!=0){if(V.o)if(we==1){le=V.m?V.m.length:0,V=Date.now()-V.F;var Ve=p.B;we=fr(),$e(we,new Ge(we,le)),Us(p)}else Gs(p);else if(Ve=V.s,Ve==3||Ve==0&&0<V.X||!(we==1&&Ya(p,V)||we==2&&us(p)))switch(le&&0<le.length&&(V=p.h,V.i=V.i.concat(le)),Ve){case 1:ii(p,5);break;case 4:ii(p,10);break;case 3:ii(p,6);break;default:ii(p,2)}}}function Ys(p,V){let le=p.Ta+Math.floor(Math.random()*p.cb);return p.isActive()||(le*=2),le*V}function ii(p,V){if(p.j.info("Error code "+V),V==2){var le=g(p.fb,p),we=p.Xa;const Ve=!we;we=new qr(we||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Bn(we,"https"),qi(we),Ve?ro(we.toString(),le):Ml(we.toString(),le)}else It(2);p.G=0,p.l&&p.l.sa(V),Ks(p),ls(p)}t.fb=function(p){p?(this.j.info("Successfully pinged google.com"),It(2)):(this.j.info("Failed to ping google.com"),It(1))};function Ks(p){if(p.G=0,p.ka=[],p.l){const V=_i(p.h);(V.length!=0||p.i.length!=0)&&(w(p.ka,V),w(p.ka,p.i),p.h.i.length=0,S(p.i),p.i.length=0),p.l.ra()}}function A(p,V,le){var we=le instanceof qr?Rr(le):new qr(le);if(we.g!="")V&&(we.g=V+"."+we.g),Hn(we,we.s);else{var Ve=l.location;we=Ve.protocol,V=V?V+"."+Ve.hostname:Ve.hostname,Ve=+Ve.port;var tt=new qr(null);we&&Bn(tt,we),V&&(tt.g=V),Ve&&Hn(tt,Ve),le&&(tt.l=le),we=tt}return le=p.D,V=p.ya,le&&V&&Hr(we,le,V),Hr(we,"VER",p.la),Oo(p,we),we}function me(p,V,le){if(V&&!p.J)throw Error("Can't create secondary domain capable XhrIo object.");return V=p.Ca&&!p.pa?new Xr(new Bs({eb:le})):new Xr(p.pa),V.Ha(p.J),V}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ne(){}t=Ne.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Me(){}Me.prototype.g=function(p,V){return new He(p,V)};function He(p,V){Te.call(this),this.g=new qs(V),this.l=p,this.h=V&&V.messageUrlParams||null,p=V&&V.messageHeaders||null,V&&V.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=V&&V.initMessageHeaders||null,V&&V.messageContentType&&(p?p["X-WebChannel-Content-Type"]=V.messageContentType:p={"X-WebChannel-Content-Type":V.messageContentType}),V&&V.va&&(p?p["X-WebChannel-Client-Profile"]=V.va:p={"X-WebChannel-Client-Profile":V.va}),this.g.S=p,(p=V&&V.Sb)&&!q(p)&&(this.g.m=p),this.v=V&&V.supportsCrossDomainXhr||!1,this.u=V&&V.sendRawJson||!1,(V=V&&V.httpSessionIdParam)&&!q(V)&&(this.g.D=V,p=this.h,p!==null&&V in p&&(p=this.h,V in p&&delete p[V])),this.j=new qt(this)}x(He,Te),He.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},He.prototype.close=function(){vo(this.g)},He.prototype.o=function(p){var V=this.g;if(typeof p=="string"){var le={};le.__data__=p,p=le}else this.u&&(le={},le.__data__=ot(p),p=le);V.i.push(new lr(V.Ya++,p)),V.G==3&&Us(V)},He.prototype.N=function(){this.g.l=null,delete this.j,vo(this.g),delete this.g,He.aa.N.call(this)};function st(p){Dt.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var V=p.__sm__;if(V){e:{for(const le in V){p=le;break e}p=void 0}(this.i=p)&&(p=this.i,V=V!==null&&p in V?V[p]:void 0),this.data=V}else this.data=p}x(st,Dt);function xt(){Rt.call(this),this.status=1}x(xt,Rt);function qt(p){this.g=p}x(qt,Ne),qt.prototype.ua=function(){$e(this.g,"a")},qt.prototype.ta=function(p){$e(this.g,new st(p))},qt.prototype.sa=function(p){$e(this.g,new xt)},qt.prototype.ra=function(){$e(this.g,"b")},Me.prototype.createWebChannel=Me.prototype.g,He.prototype.send=He.prototype.o,He.prototype.open=He.prototype.m,He.prototype.close=He.prototype.close,Z1=function(){return new Me},X1=function(){return fr()},Q1=St,om={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},We.NO_ERROR=0,We.TIMEOUT=8,We.HTTP_ERROR=6,ah=We,vt.COMPLETE="complete",J1=vt,gt.EventType=qe,qe.OPEN="a",qe.CLOSE="b",qe.ERROR="c",qe.MESSAGE="d",Te.prototype.listen=Te.prototype.K,uu=gt,Xr.prototype.listenOnce=Xr.prototype.L,Xr.prototype.getLastError=Xr.prototype.Ka,Xr.prototype.getLastErrorCode=Xr.prototype.Ba,Xr.prototype.getStatus=Xr.prototype.Z,Xr.prototype.getResponseJson=Xr.prototype.Oa,Xr.prototype.getResponseText=Xr.prototype.oa,Xr.prototype.send=Xr.prototype.ea,Xr.prototype.setWithCredentials=Xr.prototype.Ha,K1=Xr}).apply(typeof Ld<"u"?Ld:typeof self<"u"?self:typeof window<"u"?window:{});const av="@firebase/firestore",lv="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}pi.UNAUTHENTICATED=new pi(null),pi.GOOGLE_CREDENTIALS=new pi("google-credentials-uid"),pi.FIRST_PARTY=new pi("first-party-uid"),pi.MOCK_USER=new pi("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nc="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Il=new Ym("@firebase/firestore");function ac(){return Il.logLevel}function Jt(t,...e){if(Il.logLevel<=Or.DEBUG){const r=e.map(ay);Il.debug(`Firestore (${Nc}): ${t}`,...r)}}function Ts(t,...e){if(Il.logLevel<=Or.ERROR){const r=e.map(ay);Il.error(`Firestore (${Nc}): ${t}`,...r)}}function Pc(t,...e){if(Il.logLevel<=Or.WARN){const r=e.map(ay);Il.warn(`Firestore (${Nc}): ${t}`,...r)}}function ay(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vr(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,e2(t,n,r)}function e2(t,e,r){let n=`FIRESTORE (${Nc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Ts(n),new Error(n)}function en(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||e2(e,i,n)}function Er(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Gt extends Rs{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t2{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class dC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(pi.UNAUTHENTICATED))}shutdown(){}}class hC{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class pC{constructor(e){this.t=e,this.currentUser=pi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){en(this.o===void 0,42304);let n=this.i;const i=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let o=new Is;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Is,e.enqueueRetryable(()=>i(this.currentUser))};const s=()=>{const c=o;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},l=c=>{Jt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Jt("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Is)}},0),s()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Jt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(en(typeof n.accessToken=="string",31837,{l:n}),new t2(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return en(e===null||typeof e=="string",2055,{h:e}),new pi(e)}}class fC{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=pi.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class mC{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new fC(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(pi.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class cv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class yC{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,fo(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){en(this.o===void 0,3512);const n=o=>{o.error!=null&&Jt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const s=o.token!==this.m;return this.m=o.token,Jt("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?r(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>n(o))};const i=o=>{Jt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):Jt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new cv(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(en(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new cv(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gC(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ly{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=gC(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<r&&(n+=e.charAt(i[o]%62))}return n}}function Br(t,e){return t<e?-1:t>e?1:0}function sm(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const i=t.charAt(n),o=e.charAt(n);if(i!==o)return Qp(i)===Qp(o)?Br(i,o):Qp(i)?1:-1}return Br(t.length,e.length)}const vC=55296,bC=57343;function Qp(t){const e=t.charCodeAt(0);return e>=vC&&e<=bC}function wc(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uv="__name__";class Go{constructor(e,r,n){r===void 0?r=0:r>e.length&&vr(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&vr(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Go.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Go?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const o=Go.compareSegments(e.get(i),r.get(i));if(o!==0)return o}return Br(e.length,r.length)}static compareSegments(e,r){const n=Go.isNumericId(e),i=Go.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?Go.extractNumericId(e).compare(Go.extractNumericId(r)):sm(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Aa.fromString(e.substring(4,e.length-2))}}class pn extends Go{construct(e,r,n){return new pn(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Gt(pt.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new pn(r)}static emptyPath(){return new pn([])}}const _C=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ti extends Go{construct(e,r,n){return new ti(e,r,n)}static isValidIdentifier(e){return _C.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ti.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===uv}static keyField(){return new ti([uv])}static fromServerFormat(e){const r=[];let n="",i=0;const o=()=>{if(n.length===0)throw new Gt(pt.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let s=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new Gt(pt.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Gt(pt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else l==="`"?(s=!s,i++):l!=="."||s?(n+=l,i++):(o(),i++)}if(o(),s)throw new Gt(pt.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ti(r)}static emptyPath(){return new ti([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e){this.path=e}static fromPath(e){return new ar(pn.fromString(e))}static fromName(e){return new ar(pn.fromString(e).popFirst(5))}static empty(){return new ar(pn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return pn.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ar(new pn(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r2(t,e,r){if(!r)throw new Gt(pt.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function SC(t,e,r,n){if(e===!0&&n===!0)throw new Gt(pt.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function dv(t){if(!ar.isDocumentKey(t))throw new Gt(pt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function hv(t){if(ar.isDocumentKey(t))throw new Gt(pt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function n2(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function rp(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":vr(12329,{type:typeof t})}function ks(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Gt(pt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=rp(t);throw new Gt(pt.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fn(t,e){const r={typeString:t};return e&&(r.value=e),r}function ed(t,e){if(!n2(t))throw new Gt(pt.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const s=t[n];if(i&&typeof s!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(o!==void 0&&s!==o.value){r=`Expected '${n}' field to equal '${o.value}'`;break}}if(r)throw new Gt(pt.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pv=-62135596800,fv=1e6;class mn{static now(){return mn.fromMillis(Date.now())}static fromDate(e){return mn.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*fv);return new mn(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Gt(pt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Gt(pt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<pv)throw new Gt(pt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Gt(pt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/fv}_compareTo(e){return this.seconds===e.seconds?Br(this.nanoseconds,e.nanoseconds):Br(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:mn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ed(e,mn._jsonSchema))return new mn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-pv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}mn._jsonSchemaVersion="firestore/timestamp/1.0",mn._jsonSchema={type:Fn("string",mn._jsonSchemaVersion),seconds:Fn("number"),nanoseconds:Fn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{static fromTimestamp(e){return new wr(e)}static min(){return new wr(new mn(0,0))}static max(){return new wr(new mn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mu=-1;function PC(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=wr.fromTimestamp(n===1e9?new mn(r+1,0):new mn(r,n));return new $a(i,ar.empty(),e)}function wC(t){return new $a(t.readTime,t.key,Mu)}class $a{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new $a(wr.min(),ar.empty(),Mu)}static max(){return new $a(wr.max(),ar.empty(),Mu)}}function xC(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=ar.comparator(t.documentKey,e.documentKey),r!==0?r:Br(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class CC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lc(t){if(t.code!==pt.FAILED_PRECONDITION||t.message!==AC)throw t;Jt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&vr(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new bt((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(r,o).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof bt?r:bt.resolve(r)}catch(r){return bt.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):bt.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):bt.reject(r)}static resolve(e){return new bt((r,n)=>{r(e)})}static reject(e){return new bt((r,n)=>{n(e)})}static waitFor(e){return new bt((r,n)=>{let i=0,o=0,s=!1;e.forEach(l=>{++i,l.next(()=>{++o,s&&o===i&&r()},c=>n(c))}),s=!0,o===i&&r()})}static or(e){let r=bt.resolve(!1);for(const n of e)r=r.next(i=>i?bt.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,o)=>{n.push(r.call(this,i,o))}),this.waitFor(n)}static mapArray(e,r){return new bt((n,i)=>{const o=e.length,s=new Array(o);let l=0;for(let c=0;c<o;c++){const u=c;r(e[u]).next(h=>{s[u]=h,++l,l===o&&n(s)},h=>i(h))}})}static doWhile(e,r){return new bt((n,i)=>{const o=()=>{e()===!0?r().next(()=>{o()},i):n()};o()})}}function IC(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Rc(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class np{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}np.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cy=-1;function ip(t){return t==null}function Rh(t){return t===0&&1/t==-1/0}function $C(t){return typeof t=="number"&&Number.isInteger(t)&&!Rh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i2="";function EC(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=mv(e)),e=TC(t.get(r),e);return mv(e)}function TC(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const o=t.charAt(i);switch(o){case"\0":r+="";break;case i2:r+="";break;default:r+=o}}return r}function mv(t){return t+i2+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yv(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Oa(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function o2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e,r){this.comparator=e,this.root=r||ei.EMPTY}insert(e,r){return new vn(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,ei.BLACK,null,null))}remove(e){return new vn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ei.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Rd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Rd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Rd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Rd(this.root,e,this.comparator,!0)}}class Rd{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=r?n(e.key,r):1,r&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ei{constructor(e,r,n,i,o){this.key=e,this.value=r,this.color=n??ei.RED,this.left=i??ei.EMPTY,this.right=o??ei.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,o){return new ei(e??this.key,r??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const o=n(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,r,n),null):o===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ei.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return ei.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ei.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ei.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw vr(43730,{key:this.key,value:this.value});if(this.right.isRed())throw vr(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw vr(27949);return e+(this.isRed()?0:1)}}ei.EMPTY=null,ei.RED=!0,ei.BLACK=!1;ei.EMPTY=new class{constructor(){this.size=0}get key(){throw vr(57766)}get value(){throw vr(16141)}get color(){throw vr(16727)}get left(){throw vr(29726)}get right(){throw vr(36894)}copy(e,r,n,i,o){return this}insert(e,r,n){return new ei(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e){this.comparator=e,this.data=new vn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new gv(this.data.getIterator())}getIteratorFrom(e){return new gv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Un)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Un(this.comparator);return r.data=e,r}}class gv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e){this.fields=e,e.sort(ti.comparator)}static empty(){return new Zi([])}unionWith(e){let r=new Un(ti.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Zi(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return wc(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s2 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new s2("Invalid base64 string: "+o):o}}(e);return new ni(r)}static fromUint8Array(e){const r=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(e);return new ni(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Br(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ni.EMPTY_BYTE_STRING=new ni("");const kC=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ea(t){if(en(!!t,39018),typeof t=="string"){let e=0;const r=kC.exec(t);if(en(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Cn(t.seconds),nanos:Cn(t.nanos)}}function Cn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ta(t){return typeof t=="string"?ni.fromBase64String(t):ni.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a2="server_timestamp",l2="__type__",c2="__previous_value__",u2="__local_write_time__";function uy(t){return(t?.mapValue?.fields||{})[l2]?.stringValue===a2}function op(t){const e=t.mapValue.fields[c2];return uy(e)?op(e):e}function Fu(t){const e=Ea(t.mapValue.fields[u2].timestampValue);return new mn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NC{constructor(e,r,n,i,o,s,l,c,u,h){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=h}}const Dh="(default)";class Ou{constructor(e,r){this.projectId=e,this.database=r||Dh}static empty(){return new Ou("","")}get isDefaultDatabase(){return this.database===Dh}isEqual(e){return e instanceof Ou&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d2="__type__",LC="__max__",Dd={mapValue:{}},h2="__vector__",Mh="value";function ka(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?uy(t)?4:DC(t)?9007199254740991:RC(t)?10:11:vr(28295,{value:t})}function ns(t,e){if(t===e)return!0;const r=ka(t);if(r!==ka(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Fu(t).isEqual(Fu(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const s=Ea(i.timestampValue),l=Ea(o.timestampValue);return s.seconds===l.seconds&&s.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,o){return Ta(i.bytesValue).isEqual(Ta(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,o){return Cn(i.geoPointValue.latitude)===Cn(o.geoPointValue.latitude)&&Cn(i.geoPointValue.longitude)===Cn(o.geoPointValue.longitude)}(t,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return Cn(i.integerValue)===Cn(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const s=Cn(i.doubleValue),l=Cn(o.doubleValue);return s===l?Rh(s)===Rh(l):isNaN(s)&&isNaN(l)}return!1}(t,e);case 9:return wc(t.arrayValue.values||[],e.arrayValue.values||[],ns);case 10:case 11:return function(i,o){const s=i.mapValue.fields||{},l=o.mapValue.fields||{};if(yv(s)!==yv(l))return!1;for(const c in s)if(s.hasOwnProperty(c)&&(l[c]===void 0||!ns(s[c],l[c])))return!1;return!0}(t,e);default:return vr(52216,{left:t})}}function Bu(t,e){return(t.values||[]).find(r=>ns(r,e))!==void 0}function xc(t,e){if(t===e)return 0;const r=ka(t),n=ka(e);if(r!==n)return Br(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Br(t.booleanValue,e.booleanValue);case 2:return function(o,s){const l=Cn(o.integerValue||o.doubleValue),c=Cn(s.integerValue||s.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return vv(t.timestampValue,e.timestampValue);case 4:return vv(Fu(t),Fu(e));case 5:return sm(t.stringValue,e.stringValue);case 6:return function(o,s){const l=Ta(o),c=Ta(s);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(o,s){const l=o.split("/"),c=s.split("/");for(let u=0;u<l.length&&u<c.length;u++){const h=Br(l[u],c[u]);if(h!==0)return h}return Br(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,s){const l=Br(Cn(o.latitude),Cn(s.latitude));return l!==0?l:Br(Cn(o.longitude),Cn(s.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return bv(t.arrayValue,e.arrayValue);case 10:return function(o,s){const l=o.fields||{},c=s.fields||{},u=l[Mh]?.arrayValue,h=c[Mh]?.arrayValue,y=Br(u?.values?.length||0,h?.values?.length||0);return y!==0?y:bv(u,h)}(t.mapValue,e.mapValue);case 11:return function(o,s){if(o===Dd.mapValue&&s===Dd.mapValue)return 0;if(o===Dd.mapValue)return 1;if(s===Dd.mapValue)return-1;const l=o.fields||{},c=Object.keys(l),u=s.fields||{},h=Object.keys(u);c.sort(),h.sort();for(let y=0;y<c.length&&y<h.length;++y){const g=sm(c[y],h[y]);if(g!==0)return g;const f=xc(l[c[y]],u[h[y]]);if(f!==0)return f}return Br(c.length,h.length)}(t.mapValue,e.mapValue);default:throw vr(23264,{he:r})}}function vv(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Br(t,e);const r=Ea(t),n=Ea(e),i=Br(r.seconds,n.seconds);return i!==0?i:Br(r.nanos,n.nanos)}function bv(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const o=xc(r[i],n[i]);if(o)return o}return Br(r.length,n.length)}function Ac(t){return am(t)}function am(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Ea(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Ta(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return ar.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const o of r.values||[])i?i=!1:n+=",",n+=am(o);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const s of n)o?o=!1:i+=",",i+=`${s}:${am(r.fields[s])}`;return i+"}"}(t.mapValue):vr(61005,{value:t})}function lh(t){switch(ka(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=op(t);return e?16+lh(e):16;case 5:return 2*t.stringValue.length;case 6:return Ta(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,o)=>i+lh(o),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return Oa(n.fields,(o,s)=>{i+=o.length+lh(s)}),i}(t.mapValue);default:throw vr(13486,{value:t})}}function _v(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function lm(t){return!!t&&"integerValue"in t}function dy(t){return!!t&&"arrayValue"in t}function Sv(t){return!!t&&"nullValue"in t}function Pv(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ch(t){return!!t&&"mapValue"in t}function RC(t){return(t?.mapValue?.fields||{})[d2]?.stringValue===h2}function bu(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Oa(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=bu(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=bu(t.arrayValue.values[r]);return e}return{...t}}function DC(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===LC}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi{constructor(e){this.value=e}static empty(){return new Fi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!ch(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=bu(r)}setAll(e){let r=ti.emptyPath(),n={},i=[];e.forEach((s,l)=>{if(!r.isImmediateParentOf(l)){const c=this.getFieldsMap(r);this.applyChanges(c,n,i),n={},i=[],r=l.popLast()}s?n[l.lastSegment()]=bu(s):i.push(l.lastSegment())});const o=this.getFieldsMap(r);this.applyChanges(o,n,i)}delete(e){const r=this.field(e.popLast());ch(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return ns(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];ch(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Oa(r,(i,o)=>e[i]=o);for(const i of n)delete e[i]}clone(){return new Fi(bu(this.value))}}function p2(t){const e=[];return Oa(t.fields,(r,n)=>{const i=new ti([r]);if(ch(n)){const o=p2(n.mapValue).fields;if(o.length===0)e.push(i);else for(const s of o)e.push(i.child(s))}else e.push(i)}),new Zi(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(e,r,n,i,o,s,l){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=o,this.data=s,this.documentState=l}static newInvalidDocument(e){return new fi(e,0,wr.min(),wr.min(),wr.min(),Fi.empty(),0)}static newFoundDocument(e,r,n,i){return new fi(e,1,r,wr.min(),n,i,0)}static newNoDocument(e,r){return new fi(e,2,r,wr.min(),wr.min(),Fi.empty(),0)}static newUnknownDocument(e,r){return new fi(e,3,r,wr.min(),wr.min(),Fi.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(wr.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Fi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Fi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=wr.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof fi&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new fi(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(e,r){this.position=e,this.inclusive=r}}function wv(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const o=e[i],s=t.position[i];if(o.field.isKeyField()?n=ar.comparator(ar.fromName(s.referenceValue),r.key):n=xc(s,r.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function xv(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!ns(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e,r="asc"){this.field=e,this.dir=r}}function MC(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f2{}class Mn extends f2{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new OC(e,r,n):r==="array-contains"?new VC(e,n):r==="in"?new qC(e,n):r==="not-in"?new zC(e,n):r==="array-contains-any"?new UC(e,n):new Mn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new BC(e,n):new jC(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(xc(r,this.value)):r!==null&&ka(this.value)===ka(r)&&this.matchesComparison(xc(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return vr(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class No extends f2{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new No(e,r)}matches(e){return m2(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function m2(t){return t.op==="and"}function y2(t){return FC(t)&&m2(t)}function FC(t){for(const e of t.filters)if(e instanceof No)return!1;return!0}function cm(t){if(t instanceof Mn)return t.field.canonicalString()+t.op.toString()+Ac(t.value);if(y2(t))return t.filters.map(e=>cm(e)).join(",");{const e=t.filters.map(r=>cm(r)).join(",");return`${t.op}(${e})`}}function g2(t,e){return t instanceof Mn?function(n,i){return i instanceof Mn&&n.op===i.op&&n.field.isEqual(i.field)&&ns(n.value,i.value)}(t,e):t instanceof No?function(n,i){return i instanceof No&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((o,s,l)=>o&&g2(s,i.filters[l]),!0):!1}(t,e):void vr(19439)}function v2(t){return t instanceof Mn?function(r){return`${r.field.canonicalString()} ${r.op} ${Ac(r.value)}`}(t):t instanceof No?function(r){return r.op.toString()+" {"+r.getFilters().map(v2).join(" ,")+"}"}(t):"Filter"}class OC extends Mn{constructor(e,r,n){super(e,r,n),this.key=ar.fromName(n.referenceValue)}matches(e){const r=ar.comparator(e.key,this.key);return this.matchesComparison(r)}}class BC extends Mn{constructor(e,r){super(e,"in",r),this.keys=b2("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class jC extends Mn{constructor(e,r){super(e,"not-in",r),this.keys=b2("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function b2(t,e){return(e.arrayValue?.values||[]).map(r=>ar.fromName(r.referenceValue))}class VC extends Mn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return dy(r)&&Bu(r.arrayValue,this.value)}}class qC extends Mn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Bu(this.value.arrayValue,r)}}class zC extends Mn{constructor(e,r){super(e,"not-in",r)}matches(e){if(Bu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!Bu(this.value.arrayValue,r)}}class UC extends Mn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!dy(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Bu(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{constructor(e,r=null,n=[],i=[],o=null,s=null,l=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=s,this.endAt=l,this.Te=null}}function Av(t,e=null,r=[],n=[],i=null,o=null,s=null){return new HC(t,e,r,n,i,o,s)}function hy(t){const e=Er(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>cm(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(o){return o.field.canonicalString()+o.dir}(n)).join(","),ip(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Ac(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Ac(n)).join(",")),e.Te=r}return e.Te}function py(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!MC(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!g2(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!xv(t.startAt,e.startAt)&&xv(t.endAt,e.endAt)}function um(t){return ar.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dc{constructor(e,r=null,n=[],i=[],o=null,s="F",l=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=s,this.startAt=l,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function GC(t,e,r,n,i,o,s,l){return new Dc(t,e,r,n,i,o,s,l)}function fy(t){return new Dc(t)}function Cv(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function _2(t){return t.collectionGroup!==null}function _u(t){const e=Er(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),r.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let l=new Un(ti.comparator);return s.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(o=>{r.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new ju(o,n))}),r.has(ti.keyField().canonicalString())||e.Ie.push(new ju(ti.keyField(),n))}return e.Ie}function Jo(t){const e=Er(t);return e.Ee||(e.Ee=WC(e,_u(t))),e.Ee}function WC(t,e){if(t.limitType==="F")return Av(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const o=i.dir==="desc"?"asc":"desc";return new ju(i.field,o)});const r=t.endAt?new Fh(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Fh(t.startAt.position,t.startAt.inclusive):null;return Av(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function dm(t,e){const r=t.filters.concat([e]);return new Dc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function hm(t,e,r){return new Dc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function sp(t,e){return py(Jo(t),Jo(e))&&t.limitType===e.limitType}function S2(t){return`${hy(Jo(t))}|lt:${t.limitType}`}function lc(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>v2(i)).join(", ")}]`),ip(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>Ac(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>Ac(i)).join(",")),`Target(${n})`}(Jo(t))}; limitType=${t.limitType})`}function ap(t,e){return e.isFoundDocument()&&function(n,i){const o=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):ar.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(t,e)&&function(n,i){for(const o of _u(n))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const o of n.filters)if(!o.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(s,l,c){const u=wv(s,l,c);return s.inclusive?u<=0:u<0}(n.startAt,_u(n),i)||n.endAt&&!function(s,l,c){const u=wv(s,l,c);return s.inclusive?u>=0:u>0}(n.endAt,_u(n),i))}(t,e)}function YC(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function P2(t){return(e,r)=>{let n=!1;for(const i of _u(t)){const o=KC(i,e,r);if(o!==0)return o;n=n||i.field.isKeyField()}return 0}}function KC(t,e,r){const n=t.field.isKeyField()?ar.comparator(e.key,r.key):function(o,s,l){const c=s.data.field(o),u=l.data.field(o);return c!==null&&u!==null?xc(c,u):vr(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return vr(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,o]of n)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Oa(this.inner,(r,n)=>{for(const[i,o]of n)e(i,o)})}isEmpty(){return o2(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JC=new vn(ar.comparator);function Ns(){return JC}const w2=new vn(ar.comparator);function du(...t){let e=w2;for(const r of t)e=e.insert(r.key,r);return e}function x2(t){let e=w2;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function pl(){return Su()}function A2(){return Su()}function Su(){return new kl(t=>t.toString(),(t,e)=>t.isEqual(e))}const QC=new vn(ar.comparator),XC=new Un(ar.comparator);function jr(...t){let e=XC;for(const r of t)e=e.add(r);return e}const ZC=new Un(Br);function e3(){return ZC}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function my(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Rh(e)?"-0":e}}function C2(t){return{integerValue:""+t}}function t3(t,e){return $C(e)?C2(e):my(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lp{constructor(){this._=void 0}}function r3(t,e,r){return t instanceof Oh?function(i,o){const s={fields:{[l2]:{stringValue:a2},[u2]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&uy(o)&&(o=op(o)),o&&(s.fields[c2]=o),{mapValue:s}}(r,e):t instanceof Vu?$2(t,e):t instanceof qu?E2(t,e):function(i,o){const s=I2(i,o),l=Iv(s)+Iv(i.Ae);return lm(s)&&lm(i.Ae)?C2(l):my(i.serializer,l)}(t,e)}function n3(t,e,r){return t instanceof Vu?$2(t,e):t instanceof qu?E2(t,e):r}function I2(t,e){return t instanceof Bh?function(n){return lm(n)||function(o){return!!o&&"doubleValue"in o}(n)}(e)?e:{integerValue:0}:null}class Oh extends lp{}class Vu extends lp{constructor(e){super(),this.elements=e}}function $2(t,e){const r=T2(e);for(const n of t.elements)r.some(i=>ns(i,n))||r.push(n);return{arrayValue:{values:r}}}class qu extends lp{constructor(e){super(),this.elements=e}}function E2(t,e){let r=T2(e);for(const n of t.elements)r=r.filter(i=>!ns(i,n));return{arrayValue:{values:r}}}class Bh extends lp{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function Iv(t){return Cn(t.integerValue||t.doubleValue)}function T2(t){return dy(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function i3(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof Vu&&i instanceof Vu||n instanceof qu&&i instanceof qu?wc(n.elements,i.elements,ns):n instanceof Bh&&i instanceof Bh?ns(n.Ae,i.Ae):n instanceof Oh&&i instanceof Oh}(t.transform,e.transform)}class o3{constructor(e,r){this.version=e,this.transformResults=r}}class Qo{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Qo}static exists(e){return new Qo(void 0,e)}static updateTime(e){return new Qo(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function uh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class cp{}function k2(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new L2(t.key,Qo.none()):new td(t.key,t.data,Qo.none());{const r=t.data,n=Fi.empty();let i=new Un(ti.comparator);for(let o of e.fields)if(!i.has(o)){let s=r.field(o);s===null&&o.length>1&&(o=o.popLast(),s=r.field(o)),s===null?n.delete(o):n.set(o,s),i=i.add(o)}return new Ba(t.key,n,new Zi(i.toArray()),Qo.none())}}function s3(t,e,r){t instanceof td?function(i,o,s){const l=i.value.clone(),c=Ev(i.fieldTransforms,o,s.transformResults);l.setAll(c),o.convertToFoundDocument(s.version,l).setHasCommittedMutations()}(t,e,r):t instanceof Ba?function(i,o,s){if(!uh(i.precondition,o))return void o.convertToUnknownDocument(s.version);const l=Ev(i.fieldTransforms,o,s.transformResults),c=o.data;c.setAll(N2(i)),c.setAll(l),o.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(t,e,r):function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,r)}function Pu(t,e,r,n){return t instanceof td?function(o,s,l,c){if(!uh(o.precondition,s))return l;const u=o.value.clone(),h=Tv(o.fieldTransforms,c,s);return u.setAll(h),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),null}(t,e,r,n):t instanceof Ba?function(o,s,l,c){if(!uh(o.precondition,s))return l;const u=Tv(o.fieldTransforms,c,s),h=s.data;return h.setAll(N2(o)),h.setAll(u),s.convertToFoundDocument(s.version,h).setHasLocalMutations(),l===null?null:l.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(y=>y.field))}(t,e,r,n):function(o,s,l){return uh(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):l}(t,e,r)}function a3(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),o=I2(n.transform,i||null);o!=null&&(r===null&&(r=Fi.empty()),r.set(n.field,o))}return r||null}function $v(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&wc(n,i,(o,s)=>i3(o,s))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class td extends cp{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ba extends cp{constructor(e,r,n,i,o=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function N2(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function Ev(t,e,r){const n=new Map;en(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let i=0;i<r.length;i++){const o=t[i],s=o.transform,l=e.data.field(o.field);n.set(o.field,n3(s,l,r[i]))}return n}function Tv(t,e,r){const n=new Map;for(const i of t){const o=i.transform,s=r.data.field(i.field);n.set(i.field,r3(o,s,e))}return n}class L2 extends cp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class l3 extends cp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c3{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&s3(o,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Pu(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Pu(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=A2();return this.mutations.forEach(i=>{const o=e.get(i.key),s=o.overlayedDocument;let l=this.applyToLocalView(s,o.mutatedFields);l=r.has(i.key)?null:l;const c=k2(s,l);c!==null&&n.set(i.key,c),s.isValidDocument()||s.convertToNoDocument(wr.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),jr())}isEqual(e){return this.batchId===e.batchId&&wc(this.mutations,e.mutations,(r,n)=>$v(r,n))&&wc(this.baseMutations,e.baseMutations,(r,n)=>$v(r,n))}}class yy{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){en(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=function(){return QC}();const o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,n[s].version);return new yy(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u3{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d3{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dn,zr;function h3(t){switch(t){case pt.OK:return vr(64938);case pt.CANCELLED:case pt.UNKNOWN:case pt.DEADLINE_EXCEEDED:case pt.RESOURCE_EXHAUSTED:case pt.INTERNAL:case pt.UNAVAILABLE:case pt.UNAUTHENTICATED:return!1;case pt.INVALID_ARGUMENT:case pt.NOT_FOUND:case pt.ALREADY_EXISTS:case pt.PERMISSION_DENIED:case pt.FAILED_PRECONDITION:case pt.ABORTED:case pt.OUT_OF_RANGE:case pt.UNIMPLEMENTED:case pt.DATA_LOSS:return!0;default:return vr(15467,{code:t})}}function R2(t){if(t===void 0)return Ts("GRPC error has no .code"),pt.UNKNOWN;switch(t){case Dn.OK:return pt.OK;case Dn.CANCELLED:return pt.CANCELLED;case Dn.UNKNOWN:return pt.UNKNOWN;case Dn.DEADLINE_EXCEEDED:return pt.DEADLINE_EXCEEDED;case Dn.RESOURCE_EXHAUSTED:return pt.RESOURCE_EXHAUSTED;case Dn.INTERNAL:return pt.INTERNAL;case Dn.UNAVAILABLE:return pt.UNAVAILABLE;case Dn.UNAUTHENTICATED:return pt.UNAUTHENTICATED;case Dn.INVALID_ARGUMENT:return pt.INVALID_ARGUMENT;case Dn.NOT_FOUND:return pt.NOT_FOUND;case Dn.ALREADY_EXISTS:return pt.ALREADY_EXISTS;case Dn.PERMISSION_DENIED:return pt.PERMISSION_DENIED;case Dn.FAILED_PRECONDITION:return pt.FAILED_PRECONDITION;case Dn.ABORTED:return pt.ABORTED;case Dn.OUT_OF_RANGE:return pt.OUT_OF_RANGE;case Dn.UNIMPLEMENTED:return pt.UNIMPLEMENTED;case Dn.DATA_LOSS:return pt.DATA_LOSS;default:return vr(39323,{code:t})}}(zr=Dn||(Dn={}))[zr.OK=0]="OK",zr[zr.CANCELLED=1]="CANCELLED",zr[zr.UNKNOWN=2]="UNKNOWN",zr[zr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",zr[zr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",zr[zr.NOT_FOUND=5]="NOT_FOUND",zr[zr.ALREADY_EXISTS=6]="ALREADY_EXISTS",zr[zr.PERMISSION_DENIED=7]="PERMISSION_DENIED",zr[zr.UNAUTHENTICATED=16]="UNAUTHENTICATED",zr[zr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",zr[zr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",zr[zr.ABORTED=10]="ABORTED",zr[zr.OUT_OF_RANGE=11]="OUT_OF_RANGE",zr[zr.UNIMPLEMENTED=12]="UNIMPLEMENTED",zr[zr.INTERNAL=13]="INTERNAL",zr[zr.UNAVAILABLE=14]="UNAVAILABLE",zr[zr.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p3(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f3=new Aa([4294967295,4294967295],0);function kv(t){const e=p3().encode(t),r=new Y1;return r.update(e),new Uint8Array(r.digest())}function Nv(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Aa([r,n],0),new Aa([i,o],0)]}class gy{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new hu(`Invalid padding: ${r}`);if(n<0)throw new hu(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new hu(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new hu(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Aa.fromNumber(this.ge)}ye(e,r,n){let i=e.add(r.multiply(Aa.fromNumber(n)));return i.compare(f3)===1&&(i=new Aa([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=kv(e),[n,i]=Nv(r);for(let o=0;o<this.hashCount;o++){const s=this.ye(n,i,o);if(!this.we(s))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new gy(o,i,r);return n.forEach(l=>s.insert(l)),s}insert(e){if(this.ge===0)return;const r=kv(e),[n,i]=Nv(r);for(let o=0;o<this.hashCount;o++){const s=this.ye(n,i,o);this.Se(s)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class hu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class up{constructor(e,r,n,i,o){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,rd.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new up(wr.min(),i,new vn(Br),Ns(),jr())}}class rd{constructor(e,r,n,i,o){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new rd(n,r,jr(),jr(),jr())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dh{constructor(e,r,n,i){this.be=e,this.removedTargetIds=r,this.key=n,this.De=i}}class D2{constructor(e,r){this.targetId=e,this.Ce=r}}class M2{constructor(e,r,n=ni.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class Lv{constructor(){this.ve=0,this.Fe=Rv(),this.Me=ni.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=jr(),r=jr(),n=jr();return this.Fe.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:vr(38017,{changeType:o})}}),new rd(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=Rv()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,en(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class m3{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ns(),this.Je=Md(),this.He=Md(),this.Ye=new vn(Br)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:vr(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,i)=>{this.rt(i)&&r(i)})}st(e){const r=e.targetId,n=e.Ce.count,i=this.ot(r);if(i){const o=i.target;if(um(o))if(n===0){const s=new ar(o.path);this.et(r,s,fi.newNoDocument(s,wr.min()))}else en(n===1,20013,{expectedCount:n});else{const s=this._t(r);if(s!==n){const l=this.ut(e),c=l?this.ct(l,e,s):1;if(c!==0){this.it(r);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,u)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:o=0}=r;let s,l;try{s=Ta(n).toUint8Array()}catch(c){if(c instanceof s2)return Pc("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new gy(s,i,o)}catch(c){return Pc(c instanceof hu?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.ge===0?null:l}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let i=0;return n.forEach(o=>{const s=this.Ge.ht(),l=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(l)||(this.et(r,o,null),i++)}),i}Tt(e){const r=new Map;this.ze.forEach((o,s)=>{const l=this.ot(s);if(l){if(o.current&&um(l.target)){const c=new ar(l.target.path);this.It(c).has(s)||this.Et(s,c)||this.et(s,c,fi.newNoDocument(c,e))}o.Be&&(r.set(s,o.ke()),o.qe())}});let n=jr();this.He.forEach((o,s)=>{let l=!0;s.forEachWhile(c=>{const u=this.ot(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(o))}),this.je.forEach((o,s)=>s.setReadTime(e));const i=new up(e,r,this.Ye,this.je,n);return this.je=Ns(),this.Je=Md(),this.He=Md(),this.Ye=new vn(Br),i}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,r)?i.Qe(r,1):i.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new Lv,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new Un(Br),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new Un(Br),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Jt("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Lv),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function Md(){return new vn(ar.comparator)}function Rv(){return new vn(ar.comparator)}const y3={asc:"ASCENDING",desc:"DESCENDING"},g3={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},v3={and:"AND",or:"OR"};class b3{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function pm(t,e){return t.useProto3Json||ip(e)?e:{value:e}}function jh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function F2(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function _3(t,e){return jh(t,e.toTimestamp())}function Xo(t){return en(!!t,49232),wr.fromTimestamp(function(r){const n=Ea(r);return new mn(n.seconds,n.nanos)}(t))}function vy(t,e){return fm(t,e).canonicalString()}function fm(t,e){const r=function(i){return new pn(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function O2(t){const e=pn.fromString(t);return en(z2(e),10190,{key:e.toString()}),e}function mm(t,e){return vy(t.databaseId,e.path)}function Xp(t,e){const r=O2(e);if(r.get(1)!==t.databaseId.projectId)throw new Gt(pt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Gt(pt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new ar(j2(r))}function B2(t,e){return vy(t.databaseId,e)}function S3(t){const e=O2(t);return e.length===4?pn.emptyPath():j2(e)}function ym(t){return new pn(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function j2(t){return en(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Dv(t,e,r){return{name:mm(t,e),fields:r.value.mapValue.fields}}function P3(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:vr(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(u,h){return u.useProto3Json?(en(h===void 0||typeof h=="string",58123),ni.fromBase64String(h||"")):(en(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),ni.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,l=s&&function(u){const h=u.code===void 0?pt.UNKNOWN:R2(u.code);return new Gt(h,u.message||"")}(s);r=new M2(n,i,o,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Xp(t,n.document.name),o=Xo(n.document.updateTime),s=n.document.createTime?Xo(n.document.createTime):wr.min(),l=new Fi({mapValue:{fields:n.document.fields}}),c=fi.newFoundDocument(i,o,s,l),u=n.targetIds||[],h=n.removedTargetIds||[];r=new dh(u,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Xp(t,n.document),o=n.readTime?Xo(n.readTime):wr.min(),s=fi.newNoDocument(i,o),l=n.removedTargetIds||[];r=new dh([],l,s.key,s)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Xp(t,n.document),o=n.removedTargetIds||[];r=new dh([],o,i,null)}else{if(!("filter"in e))return vr(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:o}=n,s=new d3(i,o),l=n.targetId;r=new D2(l,s)}}return r}function w3(t,e){let r;if(e instanceof td)r={update:Dv(t,e.key,e.value)};else if(e instanceof L2)r={delete:mm(t,e.key)};else if(e instanceof Ba)r={update:Dv(t,e.key,e.data),updateMask:N3(e.fieldMask)};else{if(!(e instanceof l3))return vr(16599,{Vt:e.type});r={verify:mm(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(o,s){const l=s.transform;if(l instanceof Oh)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Vu)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof qu)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Bh)return{fieldPath:s.field.canonicalString(),increment:l.Ae};throw vr(20930,{transform:s.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:_3(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:vr(27497)}(t,e.precondition)),r}function x3(t,e){return t&&t.length>0?(en(e!==void 0,14353),t.map(r=>function(i,o){let s=i.updateTime?Xo(i.updateTime):Xo(o);return s.isEqual(wr.min())&&(s=Xo(o)),new o3(s,i.transformResults||[])}(r,e))):[]}function A3(t,e){return{documents:[B2(t,e.path)]}}function C3(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=B2(t,i);const o=function(u){if(u.length!==0)return q2(No.create(u,"and"))}(e.filters);o&&(r.structuredQuery.where=o);const s=function(u){if(u.length!==0)return u.map(h=>function(g){return{field:cc(g.field),direction:E3(g.dir)}}(h))}(e.orderBy);s&&(r.structuredQuery.orderBy=s);const l=pm(t,e.limit);return l!==null&&(r.structuredQuery.limit=l),e.startAt&&(r.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:r,parent:i}}function I3(t){let e=S3(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){en(n===1,65062);const h=r.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let o=[];r.where&&(o=function(y){const g=V2(y);return g instanceof No&&y2(g)?g.getFilters():[g]}(r.where));let s=[];r.orderBy&&(s=function(y){return y.map(g=>function(x){return new ju(uc(x.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(g))}(r.orderBy));let l=null;r.limit&&(l=function(y){let g;return g=typeof y=="object"?y.value:y,ip(g)?null:g}(r.limit));let c=null;r.startAt&&(c=function(y){const g=!!y.before,f=y.values||[];return new Fh(f,g)}(r.startAt));let u=null;return r.endAt&&(u=function(y){const g=!y.before,f=y.values||[];return new Fh(f,g)}(r.endAt)),GC(e,i,s,o,l,"F",c,u)}function $3(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return vr(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function V2(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=uc(r.unaryFilter.field);return Mn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=uc(r.unaryFilter.field);return Mn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=uc(r.unaryFilter.field);return Mn.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=uc(r.unaryFilter.field);return Mn.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return vr(61313);default:return vr(60726)}}(t):t.fieldFilter!==void 0?function(r){return Mn.create(uc(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return vr(58110);default:return vr(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return No.create(r.compositeFilter.filters.map(n=>V2(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return vr(1026)}}(r.compositeFilter.op))}(t):vr(30097,{filter:t})}function E3(t){return y3[t]}function T3(t){return g3[t]}function k3(t){return v3[t]}function cc(t){return{fieldPath:t.canonicalString()}}function uc(t){return ti.fromServerFormat(t.fieldPath)}function q2(t){return t instanceof Mn?function(r){if(r.op==="=="){if(Pv(r.value))return{unaryFilter:{field:cc(r.field),op:"IS_NAN"}};if(Sv(r.value))return{unaryFilter:{field:cc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(Pv(r.value))return{unaryFilter:{field:cc(r.field),op:"IS_NOT_NAN"}};if(Sv(r.value))return{unaryFilter:{field:cc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:cc(r.field),op:T3(r.op),value:r.value}}}(t):t instanceof No?function(r){const n=r.getFilters().map(i=>q2(i));return n.length===1?n[0]:{compositeFilter:{op:k3(r.op),filters:n}}}(t):vr(54877,{filter:t})}function N3(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function z2(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba{constructor(e,r,n,i,o=wr.min(),s=wr.min(),l=ni.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new ba(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new ba(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ba(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ba(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L3{constructor(e){this.yt=e}}function R3(t){const e=I3({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?hm(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D3{constructor(){this.Cn=new M3}addToCollectionParentIndex(e,r){return this.Cn.add(r),bt.resolve()}getCollectionParents(e,r){return bt.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return bt.resolve()}deleteFieldIndex(e,r){return bt.resolve()}deleteAllFieldIndexes(e){return bt.resolve()}createTargetIndexes(e,r){return bt.resolve()}getDocumentsMatchingTarget(e,r){return bt.resolve(null)}getIndexType(e,r){return bt.resolve(0)}getFieldIndexes(e,r){return bt.resolve([])}getNextCollectionGroupToUpdate(e){return bt.resolve(null)}getMinOffset(e,r){return bt.resolve($a.min())}getMinOffsetFromCollectionGroup(e,r){return bt.resolve($a.min())}updateCollectionGroup(e,r,n){return bt.resolve()}updateIndexEntries(e,r){return bt.resolve()}}class M3{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Un(pn.comparator),o=!i.has(n);return this.index[r]=i.add(n),o}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Un(pn.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},U2=41943040;class Mi{static withCacheSize(e){return new Mi(e,Mi.DEFAULT_COLLECTION_PERCENTILE,Mi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Mi.DEFAULT_COLLECTION_PERCENTILE=10,Mi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Mi.DEFAULT=new Mi(U2,Mi.DEFAULT_COLLECTION_PERCENTILE,Mi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Mi.DISABLED=new Mi(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Cc(0)}static cr(){return new Cc(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fv="LruGarbageCollector",F3=1048576;function Ov([t,e],[r,n]){const i=Br(t,r);return i===0?Br(e,n):i}class O3{constructor(e){this.Ir=e,this.buffer=new Un(Ov),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();Ov(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class B3{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Jt(Fv,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Rc(r)?Jt(Fv,"Ignoring IndexedDB error during garbage collection: ",r):await Lc(r)}await this.Vr(3e5)})}}class j3{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return bt.resolve(np.ce);const n=new O3(r);return this.mr.forEachTarget(e,i=>n.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>n.Ar(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Jt("LruGarbageCollector","Garbage collection skipped; disabled"),bt.resolve(Mv)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Jt("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Mv):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,i,o,s,l,c,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(y=>(y>this.params.maximumSequenceNumbersToCollect?(Jt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),i=this.params.maximumSequenceNumbersToCollect):i=y,s=Date.now(),this.nthSequenceNumber(e,i))).next(y=>(n=y,l=Date.now(),this.removeTargets(e,n,r))).next(y=>(o=y,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(y=>(u=Date.now(),ac()<=Or.DEBUG&&Jt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-h}ms
	Determined least recently used ${i} in `+(l-s)+`ms
	Removed ${o} targets in `+(c-l)+`ms
	Removed ${y} documents in `+(u-c)+`ms
Total Duration: ${u-h}ms`),bt.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:y})))}}function V3(t,e){return new j3(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q3{constructor(){this.changes=new kl(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,fi.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?bt.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z3{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U3{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Pu(n.mutation,i,Zi.empty(),mn.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,jr()).next(()=>n))}getLocalViewOfDocuments(e,r,n=jr()){const i=pl();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(o=>{let s=du();return o.forEach((l,c)=>{s=s.insert(l,c.overlayedDocument)}),s}))}getOverlayedDocuments(e,r){const n=pl();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,jr()))}populateOverlays(e,r,n){const i=[];return n.forEach(o=>{r.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,l)=>{r.set(s,l)})})}computeViews(e,r,n,i){let o=Ns();const s=Su(),l=function(){return Su()}();return r.forEach((c,u)=>{const h=n.get(u.key);i.has(u.key)&&(h===void 0||h.mutation instanceof Ba)?o=o.insert(u.key,u):h!==void 0?(s.set(u.key,h.mutation.getFieldMask()),Pu(h.mutation,u,h.mutation.getFieldMask(),mn.now())):s.set(u.key,Zi.empty())}),this.recalculateAndSaveOverlays(e,o).next(c=>(c.forEach((u,h)=>s.set(u,h)),r.forEach((u,h)=>l.set(u,new z3(h,s.get(u)??null))),l))}recalculateAndSaveOverlays(e,r){const n=Su();let i=new vn((s,l)=>s-l),o=jr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(s=>{for(const l of s)l.keys().forEach(c=>{const u=r.get(c);if(u===null)return;let h=n.get(c)||Zi.empty();h=l.applyToLocalView(u,h),n.set(c,h);const y=(i.get(l.batchId)||jr()).add(c);i=i.insert(l.batchId,y)})}).next(()=>{const s=[],l=i.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,h=c.value,y=A2();h.forEach(g=>{if(!o.has(g)){const f=k2(r.get(g),n.get(g));f!==null&&y.set(g,f),o=o.add(g)}}),s.push(this.documentOverlayCache.saveOverlays(e,u,y))}return bt.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(s){return ar.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):_2(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(o=>{const s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-o.size):bt.resolve(pl());let l=Mu,c=o;return s.next(u=>bt.forEach(u,(h,y)=>(l<y.largestBatchId&&(l=y.largestBatchId),o.get(h)?bt.resolve():this.remoteDocumentCache.getEntry(e,h).next(g=>{c=c.insert(h,g)}))).next(()=>this.populateOverlays(e,u,o)).next(()=>this.computeViews(e,c,u,jr())).next(h=>({batchId:l,changes:x2(h)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new ar(r)).next(n=>{let i=du();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const o=r.collectionGroup;let s=du();return this.indexManager.getCollectionParents(e,o).next(l=>bt.forEach(l,c=>{const u=function(y,g){return new Dc(g,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)}(r,c.child(o));return this.getDocumentsMatchingCollectionQuery(e,u,n,i).next(h=>{h.forEach((y,g)=>{s=s.insert(y,g)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,r,n,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,o,i))).next(s=>{o.forEach((c,u)=>{const h=u.getKey();s.get(h)===null&&(s=s.insert(h,fi.newInvalidDocument(h)))});let l=du();return s.forEach((c,u)=>{const h=o.get(c);h!==void 0&&Pu(h.mutation,u,Zi.empty(),mn.now()),ap(r,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H3{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return bt.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:Xo(i.createTime)}}(r)),bt.resolve()}getNamedQuery(e,r){return bt.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(i){return{name:i.name,query:R3(i.bundledQuery),readTime:Xo(i.readTime)}}(r)),bt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G3{constructor(){this.overlays=new vn(ar.comparator),this.qr=new Map}getOverlay(e,r){return bt.resolve(this.overlays.get(r))}getOverlays(e,r){const n=pl();return bt.forEach(r,i=>this.getOverlay(e,i).next(o=>{o!==null&&n.set(i,o)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,o)=>{this.St(e,r,o)}),bt.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.qr.delete(n)),bt.resolve()}getOverlaysForCollection(e,r,n){const i=pl(),o=r.length+1,s=new ar(r.child("")),l=this.overlays.getIteratorFrom(s);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===o&&c.largestBatchId>n&&i.set(c.getKey(),c)}return bt.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let o=new vn((u,h)=>u-h);const s=this.overlays.getIterator();for(;s.hasNext();){const u=s.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let h=o.get(u.largestBatchId);h===null&&(h=pl(),o=o.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const l=pl(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,h)=>l.set(u,h)),!(l.size()>=i)););return bt.resolve(l)}St(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const s=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(n.key,new u3(r,n));let o=this.qr.get(r);o===void 0&&(o=jr(),this.qr.set(r,o)),this.qr.set(r,o.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W3{constructor(){this.sessionToken=ni.EMPTY_BYTE_STRING}getSessionToken(e){return bt.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,bt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class by{constructor(){this.Qr=new Un(Yn.$r),this.Ur=new Un(Yn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new Yn(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new Yn(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new ar(new pn([])),n=new Yn(r,e),i=new Yn(r,e+1),o=[];return this.Ur.forEachInRange([n,i],s=>{this.Gr(s),o.push(s.key)}),o}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new ar(new pn([])),n=new Yn(r,e),i=new Yn(r,e+1);let o=jr();return this.Ur.forEachInRange([n,i],s=>{o=o.add(s.key)}),o}containsKey(e){const r=new Yn(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Yn{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return ar.comparator(e.key,r.key)||Br(e.Yr,r.Yr)}static Kr(e,r){return Br(e.Yr,r.Yr)||ar.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y3{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new Un(Yn.$r)}checkEmpty(e){return bt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new c3(o,r,n,i);this.mutationQueue.push(s);for(const l of i)this.Zr=this.Zr.add(new Yn(l.key,o)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return bt.resolve(s)}lookupMutationBatch(e,r){return bt.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.ei(n),o=i<0?0:i;return bt.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return bt.resolve(this.mutationQueue.length===0?cy:this.tr-1)}getAllMutationBatches(e){return bt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Yn(r,0),i=new Yn(r,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([n,i],s=>{const l=this.Xr(s.Yr);o.push(l)}),bt.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Un(Br);return r.forEach(i=>{const o=new Yn(i,0),s=new Yn(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,s],l=>{n=n.add(l.Yr)})}),bt.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let o=n;ar.isDocumentKey(o)||(o=o.child(""));const s=new Yn(new ar(o),0);let l=new Un(Br);return this.Zr.forEachWhile(c=>{const u=c.key.path;return!!n.isPrefixOf(u)&&(u.length===i&&(l=l.add(c.Yr)),!0)},s),bt.resolve(this.ti(l))}ti(e){const r=[];return e.forEach(n=>{const i=this.Xr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){en(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return bt.forEach(r.mutations,i=>{const o=new Yn(i.key,r.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new Yn(r,0),i=this.Zr.firstAfterOrEqual(n);return bt.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,bt.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K3{constructor(e){this.ri=e,this.docs=function(){return new vn(ar.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),o=i?i.size:0,s=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return bt.resolve(n?n.document.mutableCopy():fi.newInvalidDocument(r))}getEntries(e,r){let n=Ns();return r.forEach(i=>{const o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():fi.newInvalidDocument(i))}),bt.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let o=Ns();const s=r.path,l=new ar(s.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:h}}=c.getNext();if(!s.isPrefixOf(u.path))break;u.path.length>s.length+1||xC(wC(h),n)<=0||(i.has(h.key)||ap(r,h))&&(o=o.insert(h.key,h.mutableCopy()))}return bt.resolve(o)}getAllFromCollectionGroup(e,r,n,i){vr(9500)}ii(e,r){return bt.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new J3(this)}getSize(e){return bt.resolve(this.size)}}class J3 extends q3{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)}),bt.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q3{constructor(e){this.persistence=e,this.si=new kl(r=>hy(r),py),this.lastRemoteSnapshotVersion=wr.min(),this.highestTargetId=0,this.oi=0,this._i=new by,this.targetCount=0,this.ai=Cc.ur()}forEachTarget(e,r){return this.si.forEach((n,i)=>r(i)),bt.resolve()}getLastRemoteSnapshotVersion(e){return bt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return bt.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),bt.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),bt.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new Cc(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,bt.resolve()}updateTargetData(e,r){return this.Pr(r),bt.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,bt.resolve()}removeTargets(e,r,n){let i=0;const o=[];return this.si.forEach((s,l)=>{l.sequenceNumber<=r&&n.get(l.targetId)===null&&(this.si.delete(s),o.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),bt.waitFor(o).next(()=>i)}getTargetCount(e){return bt.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return bt.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),bt.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const i=this.persistence.referenceDelegate,o=[];return i&&r.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),bt.waitFor(o)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),bt.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return bt.resolve(n)}containsKey(e,r){return bt.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H2{constructor(e,r){this.ui={},this.overlays={},this.ci=new np(0),this.li=!1,this.li=!0,this.hi=new W3,this.referenceDelegate=e(this),this.Pi=new Q3(this),this.indexManager=new D3,this.remoteDocumentCache=function(i){return new K3(i)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new L3(r),this.Ii=new H3(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new G3,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new Y3(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Jt("MemoryPersistence","Starting transaction:",e);const i=new X3(this.ci.next());return this.referenceDelegate.Ei(),n(i).next(o=>this.referenceDelegate.di(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ai(e,r){return bt.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class X3 extends CC{constructor(e){super(),this.currentSequenceNumber=e}}class _y{constructor(e){this.persistence=e,this.Ri=new by,this.Vi=null}static mi(e){return new _y(e)}get fi(){if(this.Vi)return this.Vi;throw vr(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),bt.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),bt.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),bt.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(i=>this.fi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(o=>this.fi.add(o.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return bt.forEach(this.fi,n=>{const i=ar.fromPath(n);return this.gi(e,i).next(o=>{o||r.removeEntry(i,wr.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return bt.or([()=>bt.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class Vh{constructor(e,r){this.persistence=e,this.pi=new kl(n=>EC(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=V3(this,r)}static mi(e,r){return new Vh(e,r)}Ei(){}di(e){return bt.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return bt.forEach(this.pi,(n,i)=>this.br(e,n,i).next(o=>o?bt.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ii(e,s=>this.br(e,s,r).next(l=>{l||(n++,o.removeEntry(s,wr.min()))})).next(()=>o.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),bt.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),bt.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),bt.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),bt.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=lh(e.data.value)),r}br(e,r,n){return bt.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.pi.get(r);return bt.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sy{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=i}static As(e,r){let n=jr(),i=jr();for(const o of r.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new Sy(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z3{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e4{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return UP()?8:IC(bi())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,i){const o={result:null};return this.ys(e,r).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.ws(e,r,i,n).next(s=>{o.result=s})}).next(()=>{if(o.result)return;const s=new Z3;return this.Ss(e,r,s).next(l=>{if(o.result=l,this.Vs)return this.bs(e,r,s,l.size)})}).next(()=>o.result)}bs(e,r,n,i){return n.documentReadCount<this.fs?(ac()<=Or.DEBUG&&Jt("QueryEngine","SDK will not create cache indexes for query:",lc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),bt.resolve()):(ac()<=Or.DEBUG&&Jt("QueryEngine","Query:",lc(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(ac()<=Or.DEBUG&&Jt("QueryEngine","The SDK decides to create cache indexes for query:",lc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Jo(r))):bt.resolve())}ys(e,r){if(Cv(r))return bt.resolve(null);let n=Jo(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=hm(r,null,"F"),n=Jo(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(o=>{const s=jr(...o);return this.ps.getDocuments(e,s).next(l=>this.indexManager.getMinOffset(e,n).next(c=>{const u=this.Ds(r,l);return this.Cs(r,u,s,c.readTime)?this.ys(e,hm(r,null,"F")):this.vs(e,u,r,c)}))})))}ws(e,r,n,i){return Cv(r)||i.isEqual(wr.min())?bt.resolve(null):this.ps.getDocuments(e,n).next(o=>{const s=this.Ds(r,o);return this.Cs(r,s,n,i)?bt.resolve(null):(ac()<=Or.DEBUG&&Jt("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),lc(r)),this.vs(e,s,r,PC(i,Mu)).next(l=>l))})}Ds(e,r){let n=new Un(P2(e));return r.forEach((i,o)=>{ap(e,o)&&(n=n.add(o))}),n}Cs(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const o=e.limitType==="F"?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Ss(e,r,n){return ac()<=Or.DEBUG&&Jt("QueryEngine","Using full collection scan to execute query:",lc(r)),this.ps.getDocumentsMatchingQuery(e,r,$a.min(),n)}vs(e,r,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next(o=>(r.forEach(s=>{o=o.insert(s.key,s)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Py="LocalStore",t4=3e8;class r4{constructor(e,r,n,i){this.persistence=e,this.Fs=r,this.serializer=i,this.Ms=new vn(Br),this.xs=new kl(o=>hy(o),py),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new U3(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function n4(t,e,r,n){return new r4(t,e,r,n)}async function G2(t,e){const r=Er(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(o=>(i=o,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(o=>{const s=[],l=[];let c=jr();for(const u of i){s.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}for(const u of o){l.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}return r.localDocuments.getDocuments(n,c).next(u=>({Ls:u,removedBatchIds:s,addedBatchIds:l}))})})}function i4(t,e){const r=Er(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),o=r.Ns.newChangeBuffer({trackRemovals:!0});return function(l,c,u,h){const y=u.batch,g=y.keys();let f=bt.resolve();return g.forEach(x=>{f=f.next(()=>h.getEntry(c,x)).next(S=>{const w=u.docVersions.get(x);en(w!==null,48541),S.version.compareTo(w)<0&&(y.applyToRemoteDocument(S,u),S.isValidDocument()&&(S.setReadTime(u.commitVersion),h.addEntry(S)))})}),f.next(()=>l.mutationQueue.removeMutationBatch(c,y))}(r,n,e,o).next(()=>o.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let c=jr();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function W2(t){const e=Er(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function o4(t,e){const r=Er(t),n=e.snapshotVersion;let i=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const s=r.Ns.newChangeBuffer({trackRemovals:!0});i=r.Ms;const l=[];e.targetChanges.forEach((h,y)=>{const g=i.get(y);if(!g)return;l.push(r.Pi.removeMatchingKeys(o,h.removedDocuments,y).next(()=>r.Pi.addMatchingKeys(o,h.addedDocuments,y)));let f=g.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(y)!==null?f=f.withResumeToken(ni.EMPTY_BYTE_STRING,wr.min()).withLastLimboFreeSnapshotVersion(wr.min()):h.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(h.resumeToken,n)),i=i.insert(y,f),function(S,w,E){return S.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=t4?!0:E.addedDocuments.size+E.modifiedDocuments.size+E.removedDocuments.size>0}(g,f,h)&&l.push(r.Pi.updateTargetData(o,f))});let c=Ns(),u=jr();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&l.push(r.persistence.referenceDelegate.updateLimboDocument(o,h))}),l.push(s4(o,s,e.documentUpdates).next(h=>{c=h.ks,u=h.qs})),!n.isEqual(wr.min())){const h=r.Pi.getLastRemoteSnapshotVersion(o).next(y=>r.Pi.setTargetsMetadata(o,o.currentSequenceNumber,n));l.push(h)}return bt.waitFor(l).next(()=>s.apply(o)).next(()=>r.localDocuments.getLocalViewOfDocuments(o,c,u)).next(()=>c)}).then(o=>(r.Ms=i,o))}function s4(t,e,r){let n=jr(),i=jr();return r.forEach(o=>n=n.add(o)),e.getEntries(t,n).next(o=>{let s=Ns();return r.forEach((l,c)=>{const u=o.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(l)),c.isNoDocument()&&c.version.isEqual(wr.min())?(e.removeEntry(l,c.readTime),s=s.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),s=s.insert(l,c)):Jt(Py,"Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{ks:s,qs:i}})}function a4(t,e){const r=Er(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=cy),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function l4(t,e){const r=Er(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Pi.getTargetData(n,e).next(o=>o?(i=o,bt.resolve(i)):r.Pi.allocateTargetId(n).next(s=>(i=new ba(e,s,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function gm(t,e,r){const n=Er(t),i=n.Ms.get(e),o=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",o,s=>n.persistence.referenceDelegate.removeTarget(s,i))}catch(s){if(!Rc(s))throw s;Jt(Py,`Failed to update sequence numbers for target ${e}: ${s}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function Bv(t,e,r){const n=Er(t);let i=wr.min(),o=jr();return n.persistence.runTransaction("Execute query","readwrite",s=>function(c,u,h){const y=Er(c),g=y.xs.get(h);return g!==void 0?bt.resolve(y.Ms.get(g)):y.Pi.getTargetData(u,h)}(n,s,Jo(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(s,l.targetId).next(c=>{o=c})}).next(()=>n.Fs.getDocumentsMatchingQuery(s,e,r?i:wr.min(),r?o:jr())).next(l=>(c4(n,YC(e),l),{documents:l,Qs:o})))}function c4(t,e,r){let n=t.Os.get(e)||wr.min();r.forEach((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)}),t.Os.set(e,n)}class jv{constructor(){this.activeTargetIds=e3()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class u4{constructor(){this.Mo=new jv,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new jv,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d4{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vv="ConnectivityMonitor";class qv{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Jt(Vv,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Jt(Vv,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fd=null;function vm(){return Fd===null?Fd=function(){return 268435456+Math.round(2147483648*Math.random())}():Fd++,"0x"+Fd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zp="RestConnection",h4={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class p4{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===Dh?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,r,n,i,o){const s=vm(),l=this.zo(e,r.toUriEncodedString());Jt(Zp,`Sending RPC '${e}' ${s}:`,l,n);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,i,o);const{host:u}=new URL(l),h=Ec(u);return this.Jo(e,l,c,n,h).then(y=>(Jt(Zp,`Received RPC '${e}' ${s}: `,y),y),y=>{throw Pc(Zp,`RPC '${e}' ${s} failed with error: `,y,"url: ",l,"request:",n),y})}Ho(e,r,n,i,o,s){return this.Go(e,r,n,i,o)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Nc}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>e[o]=i),n&&n.headers.forEach((i,o)=>e[o]=i)}zo(e,r){const n=h4[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f4{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oi="WebChannelConnection";class m4 extends p4{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,i,o){const s=vm();return new Promise((l,c)=>{const u=new K1;u.setWithCredentials(!0),u.listenOnce(J1.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case ah.NO_ERROR:const y=u.getResponseJson();Jt(oi,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(y)),l(y);break;case ah.TIMEOUT:Jt(oi,`RPC '${e}' ${s} timed out`),c(new Gt(pt.DEADLINE_EXCEEDED,"Request time out"));break;case ah.HTTP_ERROR:const g=u.getStatus();if(Jt(oi,`RPC '${e}' ${s} failed with status:`,g,"response text:",u.getResponseText()),g>0){let f=u.getResponseJson();Array.isArray(f)&&(f=f[0]);const x=f?.error;if(x&&x.status&&x.message){const S=function(E){const q=E.toLowerCase().replace(/_/g,"-");return Object.values(pt).indexOf(q)>=0?q:pt.UNKNOWN}(x.status);c(new Gt(S,x.message))}else c(new Gt(pt.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new Gt(pt.UNAVAILABLE,"Connection failed."));break;default:vr(9055,{l_:e,streamId:s,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{Jt(oi,`RPC '${e}' ${s} completed.`)}});const h=JSON.stringify(i);Jt(oi,`RPC '${e}' ${s} sending request:`,i),u.send(r,"POST",h,n,15)})}T_(e,r,n){const i=vm(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Z1(),l=X1(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const h=o.join("");Jt(oi,`Creating RPC '${e}' stream ${i}: ${h}`,c);const y=s.createWebChannel(h,c);this.I_(y);let g=!1,f=!1;const x=new f4({Yo:w=>{f?Jt(oi,`Not sending because RPC '${e}' stream ${i} is closed:`,w):(g||(Jt(oi,`Opening RPC '${e}' stream ${i} transport.`),y.open(),g=!0),Jt(oi,`RPC '${e}' stream ${i} sending:`,w),y.send(w))},Zo:()=>y.close()}),S=(w,E,q)=>{w.listen(E,ee=>{try{q(ee)}catch(W){setTimeout(()=>{throw W},0)}})};return S(y,uu.EventType.OPEN,()=>{f||(Jt(oi,`RPC '${e}' stream ${i} transport opened.`),x.o_())}),S(y,uu.EventType.CLOSE,()=>{f||(f=!0,Jt(oi,`RPC '${e}' stream ${i} transport closed`),x.a_(),this.E_(y))}),S(y,uu.EventType.ERROR,w=>{f||(f=!0,Pc(oi,`RPC '${e}' stream ${i} transport errored. Name:`,w.name,"Message:",w.message),x.a_(new Gt(pt.UNAVAILABLE,"The operation could not be completed")))}),S(y,uu.EventType.MESSAGE,w=>{if(!f){const E=w.data[0];en(!!E,16349);const q=E,ee=q?.error||q[0]?.error;if(ee){Jt(oi,`RPC '${e}' stream ${i} received error:`,ee);const W=ee.status;let K=function(C){const T=Dn[C];if(T!==void 0)return R2(T)}(W),te=ee.message;K===void 0&&(K=pt.INTERNAL,te="Unknown error status: "+W+" with message "+ee.message),f=!0,x.a_(new Gt(K,te)),y.close()}else Jt(oi,`RPC '${e}' stream ${i} received:`,E),x.u_(E)}}),S(l,Q1.STAT_EVENT,w=>{w.stat===om.PROXY?Jt(oi,`RPC '${e}' stream ${i} detected buffering proxy`):w.stat===om.NOPROXY&&Jt(oi,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{x.__()},0),x}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function ef(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dp(t){return new b3(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y2{constructor(e,r,n=1e3,i=1.5,o=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=i,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,r-n);i>0&&Jt("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zv="PersistentStream";class K2{constructor(e,r,n,i,o,s,l,c){this.Mi=e,this.S_=n,this.b_=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Y2(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===pt.RESOURCE_EXHAUSTED?(Ts(r.toString()),Ts("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===pt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.D_===r&&this.G_(n,i)},n=>{e(()=>{const i=new Gt(pt.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{n(()=>this.z_(i))}),this.stream.onMessage(i=>{n(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Jt(zv,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(Jt(zv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class y4 extends K2{constructor(e,r,n,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,s),this.serializer=o}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=P3(this.serializer,e),n=function(o){if(!("targetChange"in o))return wr.min();const s=o.targetChange;return s.targetIds&&s.targetIds.length?wr.min():s.readTime?Xo(s.readTime):wr.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=ym(this.serializer),r.addTarget=function(o,s){let l;const c=s.target;if(l=um(c)?{documents:A3(o,c)}:{query:C3(o,c).ft},l.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){l.resumeToken=F2(o,s.resumeToken);const u=pm(o,s.expectedCount);u!==null&&(l.expectedCount=u)}else if(s.snapshotVersion.compareTo(wr.min())>0){l.readTime=jh(o,s.snapshotVersion.toTimestamp());const u=pm(o,s.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const n=$3(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=ym(this.serializer),r.removeTarget=e,this.q_(r)}}class g4 extends K2{constructor(e,r,n,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,s),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return en(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,en(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){en(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=x3(e.writeResults,e.commitTime),n=Xo(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=ym(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>w3(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v4{}class b4 extends v4{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Gt(pt.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Go(e,fm(r,n),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===pt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Gt(pt.UNKNOWN,o.toString())})}Ho(e,r,n,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,l])=>this.connection.Ho(e,fm(r,n),i,s,l,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===pt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Gt(pt.UNKNOWN,s.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class _4{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ts(r),this.aa=!1):Jt("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $l="RemoteStore";class S4{constructor(e,r,n,i,o){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo(s=>{n.enqueueAndForget(async()=>{Nl(this)&&(Jt($l,"Restarting streams for network reachability change."),await async function(c){const u=Er(c);u.Ea.add(4),await nd(u),u.Ra.set("Unknown"),u.Ea.delete(4),await hp(u)}(this))})}),this.Ra=new _4(n,i)}}async function hp(t){if(Nl(t))for(const e of t.da)await e(!0)}async function nd(t){for(const e of t.da)await e(!1)}function J2(t,e){const r=Er(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),Cy(r)?Ay(r):Mc(r).O_()&&xy(r,e))}function wy(t,e){const r=Er(t),n=Mc(r);r.Ia.delete(e),n.O_()&&Q2(r,e),r.Ia.size===0&&(n.O_()?n.L_():Nl(r)&&r.Ra.set("Unknown"))}function xy(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(wr.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Mc(t).Y_(e)}function Q2(t,e){t.Va.Ue(e),Mc(t).Z_(e)}function Ay(t){t.Va=new m3({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Mc(t).start(),t.Ra.ua()}function Cy(t){return Nl(t)&&!Mc(t).x_()&&t.Ia.size>0}function Nl(t){return Er(t).Ea.size===0}function X2(t){t.Va=void 0}async function P4(t){t.Ra.set("Online")}async function w4(t){t.Ia.forEach((e,r)=>{xy(t,e)})}async function x4(t,e){X2(t),Cy(t)?(t.Ra.ha(e),Ay(t)):t.Ra.set("Unknown")}async function A4(t,e,r){if(t.Ra.set("Online"),e instanceof M2&&e.state===2&&e.cause)try{await async function(i,o){const s=o.cause;for(const l of o.targetIds)i.Ia.has(l)&&(await i.remoteSyncer.rejectListen(l,s),i.Ia.delete(l),i.Va.removeTarget(l))}(t,e)}catch(n){Jt($l,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await qh(t,n)}else if(e instanceof dh?t.Va.Ze(e):e instanceof D2?t.Va.st(e):t.Va.tt(e),!r.isEqual(wr.min()))try{const n=await W2(t.localStore);r.compareTo(n)>=0&&await function(o,s){const l=o.Va.Tt(s);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const h=o.Ia.get(u);h&&o.Ia.set(u,h.withResumeToken(c.resumeToken,s))}}),l.targetMismatches.forEach((c,u)=>{const h=o.Ia.get(c);if(!h)return;o.Ia.set(c,h.withResumeToken(ni.EMPTY_BYTE_STRING,h.snapshotVersion)),Q2(o,c);const y=new ba(h.target,c,u,h.sequenceNumber);xy(o,y)}),o.remoteSyncer.applyRemoteEvent(l)}(t,r)}catch(n){Jt($l,"Failed to raise snapshot:",n),await qh(t,n)}}async function qh(t,e,r){if(!Rc(e))throw e;t.Ea.add(1),await nd(t),t.Ra.set("Offline"),r||(r=()=>W2(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Jt($l,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await hp(t)})}function Z2(t,e){return e().catch(r=>qh(t,r,e))}async function pp(t){const e=Er(t),r=Na(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:cy;for(;C4(e);)try{const i=await a4(e.localStore,n);if(i===null){e.Ta.length===0&&r.L_();break}n=i.batchId,I4(e,i)}catch(i){await qh(e,i)}e5(e)&&t5(e)}function C4(t){return Nl(t)&&t.Ta.length<10}function I4(t,e){t.Ta.push(e);const r=Na(t);r.O_()&&r.X_&&r.ea(e.mutations)}function e5(t){return Nl(t)&&!Na(t).x_()&&t.Ta.length>0}function t5(t){Na(t).start()}async function $4(t){Na(t).ra()}async function E4(t){const e=Na(t);for(const r of t.Ta)e.ea(r.mutations)}async function T4(t,e,r){const n=t.Ta.shift(),i=yy.from(n,e,r);await Z2(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await pp(t)}async function k4(t,e){e&&Na(t).X_&&await async function(n,i){if(function(s){return h3(s)&&s!==pt.ABORTED}(i.code)){const o=n.Ta.shift();Na(n).B_(),await Z2(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,i)),await pp(n)}}(t,e),e5(t)&&t5(t)}async function Uv(t,e){const r=Er(t);r.asyncQueue.verifyOperationInProgress(),Jt($l,"RemoteStore received new credentials");const n=Nl(r);r.Ea.add(3),await nd(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await hp(r)}async function N4(t,e){const r=Er(t);e?(r.Ea.delete(2),await hp(r)):e||(r.Ea.add(2),await nd(r),r.Ra.set("Unknown"))}function Mc(t){return t.ma||(t.ma=function(r,n,i){const o=Er(r);return o.sa(),new y4(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Xo:P4.bind(null,t),t_:w4.bind(null,t),r_:x4.bind(null,t),H_:A4.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Cy(t)?Ay(t):t.Ra.set("Unknown")):(await t.ma.stop(),X2(t))})),t.ma}function Na(t){return t.fa||(t.fa=function(r,n,i){const o=Er(r);return o.sa(),new g4(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:$4.bind(null,t),r_:k4.bind(null,t),ta:E4.bind(null,t),na:T4.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await pp(t)):(await t.fa.stop(),t.Ta.length>0&&(Jt($l,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iy{constructor(e,r,n,i,o){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new Is,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,o){const s=Date.now()+n,l=new Iy(e,r,s,i,o);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Gt(pt.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function $y(t,e){if(Ts("AsyncQueue",`${e}: ${t}`),Rc(t))return new Gt(pt.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{static emptySet(e){return new gc(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||ar.comparator(r.key,n.key):(r,n)=>ar.comparator(r.key,n.key),this.keyedMap=du(),this.sortedSet=new vn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof gc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new gc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hv{constructor(){this.ga=new vn(ar.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):vr(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class Ic{constructor(e,r,n,i,o,s,l,c,u){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,r,n,i,o){const s=[];return r.forEach(l=>{s.push({type:0,doc:l})}),new Ic(e,r,gc.emptySet(r),s,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&sp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L4{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class R4{constructor(){this.queries=Gv(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const i=Er(r),o=i.queries;i.queries=Gv(),o.forEach((s,l)=>{for(const c of l.Sa)c.onError(n)})})(this,new Gt(pt.ABORTED,"Firestore shutting down"))}}function Gv(){return new kl(t=>S2(t),sp)}async function r5(t,e){const r=Er(t);let n=3;const i=e.query;let o=r.queries.get(i);o?!o.ba()&&e.Da()&&(n=2):(o=new L4,n=e.Da()?0:1);try{switch(n){case 0:o.wa=await r.onListen(i,!0);break;case 1:o.wa=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(s){const l=$y(s,`Initialization of query '${lc(e.query)}' failed`);return void e.onError(l)}r.queries.set(i,o),o.Sa.push(e),e.va(r.onlineState),o.wa&&e.Fa(o.wa)&&Ey(r)}async function n5(t,e){const r=Er(t),n=e.query;let i=3;const o=r.queries.get(n);if(o){const s=o.Sa.indexOf(e);s>=0&&(o.Sa.splice(s,1),o.Sa.length===0?i=e.Da()?0:1:!o.ba()&&e.Da()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function D4(t,e){const r=Er(t);let n=!1;for(const i of e){const o=i.query,s=r.queries.get(o);if(s){for(const l of s.Sa)l.Fa(i)&&(n=!0);s.wa=i}}n&&Ey(r)}function M4(t,e,r){const n=Er(t),i=n.queries.get(e);if(i)for(const o of i.Sa)o.onError(r);n.queries.delete(e)}function Ey(t){t.Ca.forEach(e=>{e.next()})}var bm,Wv;(Wv=bm||(bm={})).Ma="default",Wv.Cache="cache";class i5{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Ic(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=Ic.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==bm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o5{constructor(e){this.key=e}}class s5{constructor(e){this.key=e}}class F4{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=jr(),this.mutatedKeys=jr(),this.eu=P2(e),this.tu=new gc(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new Hv,i=r?r.tu:this.tu;let o=r?r.mutatedKeys:this.mutatedKeys,s=i,l=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,y)=>{const g=i.get(h),f=ap(this.query,y)?y:null,x=!!g&&this.mutatedKeys.has(g.key),S=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let w=!1;g&&f?g.data.isEqual(f.data)?x!==S&&(n.track({type:3,doc:f}),w=!0):this.su(g,f)||(n.track({type:2,doc:f}),w=!0,(c&&this.eu(f,c)>0||u&&this.eu(f,u)<0)&&(l=!0)):!g&&f?(n.track({type:0,doc:f}),w=!0):g&&!f&&(n.track({type:1,doc:g}),w=!0,(c||u)&&(l=!0)),w&&(f?(s=s.add(f),o=S?o.add(h):o.delete(h)):(s=s.delete(h),o=o.delete(h)))}),this.query.limit!==null)for(;s.size>this.query.limit;){const h=this.query.limitType==="F"?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),n.track({type:1,doc:h})}return{tu:s,iu:n,Cs:l,mutatedKeys:o}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort((h,y)=>function(f,x){const S=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return vr(20277,{Rt:w})}};return S(f)-S(x)}(h.type,y.type)||this.eu(h.doc,y.doc)),this.ou(n),i=i??!1;const l=r&&!i?this._u():[],c=this.Xa.size===0&&this.current&&!i?1:0,u=c!==this.Za;return this.Za=c,s.length!==0||u?{snapshot:new Ic(this.query,e.tu,o,s,e.mutatedKeys,c===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Hv,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=jr(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new s5(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new o5(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=jr();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return Ic.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Ty="SyncEngine";class O4{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class B4{constructor(e){this.key=e,this.hu=!1}}class j4{constructor(e,r,n,i,o,s){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new kl(l=>S2(l),sp),this.Iu=new Map,this.Eu=new Set,this.du=new vn(ar.comparator),this.Au=new Map,this.Ru=new by,this.Vu={},this.mu=new Map,this.fu=Cc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function V4(t,e,r=!0){const n=h5(t);let i;const o=n.Tu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await a5(n,e,r,!0),i}async function q4(t,e){const r=h5(t);await a5(r,e,!0,!1)}async function a5(t,e,r,n){const i=await l4(t.localStore,Jo(e)),o=i.targetId,s=t.sharedClientState.addLocalQueryTarget(o,r);let l;return n&&(l=await z4(t,e,o,s==="current",i.resumeToken)),t.isPrimaryClient&&r&&J2(t.remoteStore,i),l}async function z4(t,e,r,n,i){t.pu=(y,g,f)=>async function(S,w,E,q){let ee=w.view.ru(E);ee.Cs&&(ee=await Bv(S.localStore,w.query,!1).then(({documents:$})=>w.view.ru($,ee)));const W=q&&q.targetChanges.get(w.targetId),K=q&&q.targetMismatches.get(w.targetId)!=null,te=w.view.applyChanges(ee,S.isPrimaryClient,W,K);return Kv(S,w.targetId,te.au),te.snapshot}(t,y,g,f);const o=await Bv(t.localStore,e,!0),s=new F4(e,o.Qs),l=s.ru(o.documents),c=rd.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),u=s.applyChanges(l,t.isPrimaryClient,c);Kv(t,r,u.au);const h=new O4(e,r,s);return t.Tu.set(e,h),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),u.snapshot}async function U4(t,e,r){const n=Er(t),i=n.Tu.get(e),o=n.Iu.get(i.targetId);if(o.length>1)return n.Iu.set(i.targetId,o.filter(s=>!sp(s,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await gm(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&wy(n.remoteStore,i.targetId),_m(n,i.targetId)}).catch(Lc)):(_m(n,i.targetId),await gm(n.localStore,i.targetId,!0))}async function H4(t,e){const r=Er(t),n=r.Tu.get(e),i=r.Iu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),wy(r.remoteStore,n.targetId))}async function G4(t,e,r){const n=Z4(t);try{const i=await function(s,l){const c=Er(s),u=mn.now(),h=l.reduce((f,x)=>f.add(x.key),jr());let y,g;return c.persistence.runTransaction("Locally write mutations","readwrite",f=>{let x=Ns(),S=jr();return c.Ns.getEntries(f,h).next(w=>{x=w,x.forEach((E,q)=>{q.isValidDocument()||(S=S.add(E))})}).next(()=>c.localDocuments.getOverlayedDocuments(f,x)).next(w=>{y=w;const E=[];for(const q of l){const ee=a3(q,y.get(q.key).overlayedDocument);ee!=null&&E.push(new Ba(q.key,ee,p2(ee.value.mapValue),Qo.exists(!0)))}return c.mutationQueue.addMutationBatch(f,u,E,l)}).next(w=>{g=w;const E=w.applyToLocalDocumentSet(y,S);return c.documentOverlayCache.saveOverlays(f,w.batchId,E)})}).then(()=>({batchId:g.batchId,changes:x2(y)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(s,l,c){let u=s.Vu[s.currentUser.toKey()];u||(u=new vn(Br)),u=u.insert(l,c),s.Vu[s.currentUser.toKey()]=u}(n,i.batchId,r),await id(n,i.changes),await pp(n.remoteStore)}catch(i){const o=$y(i,"Failed to persist write");r.reject(o)}}async function l5(t,e){const r=Er(t);try{const n=await o4(r.localStore,e);e.targetChanges.forEach((i,o)=>{const s=r.Au.get(o);s&&(en(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?s.hu=!0:i.modifiedDocuments.size>0?en(s.hu,14607):i.removedDocuments.size>0&&(en(s.hu,42227),s.hu=!1))}),await id(r,n,e)}catch(n){await Lc(n)}}function Yv(t,e,r){const n=Er(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Tu.forEach((o,s)=>{const l=s.view.va(e);l.snapshot&&i.push(l.snapshot)}),function(s,l){const c=Er(s);c.onlineState=l;let u=!1;c.queries.forEach((h,y)=>{for(const g of y.Sa)g.va(l)&&(u=!0)}),u&&Ey(c)}(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function W4(t,e,r){const n=Er(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Au.get(e),o=i&&i.key;if(o){let s=new vn(ar.comparator);s=s.insert(o,fi.newNoDocument(o,wr.min()));const l=jr().add(o),c=new up(wr.min(),new Map,new vn(Br),s,l);await l5(n,c),n.du=n.du.remove(o),n.Au.delete(e),ky(n)}else await gm(n.localStore,e,!1).then(()=>_m(n,e,r)).catch(Lc)}async function Y4(t,e){const r=Er(t),n=e.batch.batchId;try{const i=await i4(r.localStore,e);u5(r,n,null),c5(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await id(r,i)}catch(i){await Lc(i)}}async function K4(t,e,r){const n=Er(t);try{const i=await function(s,l){const c=Er(s);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return c.mutationQueue.lookupMutationBatch(u,l).next(y=>(en(y!==null,37113),h=y.keys(),c.mutationQueue.removeMutationBatch(u,y))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,h,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>c.localDocuments.getDocuments(u,h))})}(n.localStore,e);u5(n,e,r),c5(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await id(n,i)}catch(i){await Lc(i)}}function c5(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function u5(t,e,r){const n=Er(t);let i=n.Vu[n.currentUser.toKey()];if(i){const o=i.get(e);o&&(r?o.reject(r):o.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function _m(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||d5(t,n)})}function d5(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(wy(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),ky(t))}function Kv(t,e,r){for(const n of r)n instanceof o5?(t.Ru.addReference(n.key,e),J4(t,n)):n instanceof s5?(Jt(Ty,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||d5(t,n.key)):vr(19791,{wu:n})}function J4(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Jt(Ty,"New document in limbo: "+r),t.Eu.add(n),ky(t))}function ky(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new ar(pn.fromString(e)),n=t.fu.next();t.Au.set(n,new B4(r)),t.du=t.du.insert(r,n),J2(t.remoteStore,new ba(Jo(fy(r.path)),n,"TargetPurposeLimboResolution",np.ce))}}async function id(t,e,r){const n=Er(t),i=[],o=[],s=[];n.Tu.isEmpty()||(n.Tu.forEach((l,c)=>{s.push(n.pu(c,e,r).then(u=>{if((u||r)&&n.isPrimaryClient){const h=u?!u.fromCache:r?.targetChanges.get(c.targetId)?.current;n.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(u){i.push(u);const h=Sy.As(c.targetId,u);o.push(h)}}))}),await Promise.all(s),n.Pu.H_(i),await async function(c,u){const h=Er(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>bt.forEach(u,g=>bt.forEach(g.Es,f=>h.persistence.referenceDelegate.addReference(y,g.targetId,f)).next(()=>bt.forEach(g.ds,f=>h.persistence.referenceDelegate.removeReference(y,g.targetId,f)))))}catch(y){if(!Rc(y))throw y;Jt(Py,"Failed to update sequence numbers: "+y)}for(const y of u){const g=y.targetId;if(!y.fromCache){const f=h.Ms.get(g),x=f.snapshotVersion,S=f.withLastLimboFreeSnapshotVersion(x);h.Ms=h.Ms.insert(g,S)}}}(n.localStore,o))}async function Q4(t,e){const r=Er(t);if(!r.currentUser.isEqual(e)){Jt(Ty,"User change. New user:",e.toKey());const n=await G2(r.localStore,e);r.currentUser=e,function(o,s){o.mu.forEach(l=>{l.forEach(c=>{c.reject(new Gt(pt.CANCELLED,s))})}),o.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await id(r,n.Ls)}}function X4(t,e){const r=Er(t),n=r.Au.get(e);if(n&&n.hu)return jr().add(n.key);{let i=jr();const o=r.Iu.get(e);if(!o)return i;for(const s of o){const l=r.Tu.get(s);i=i.unionWith(l.view.nu)}return i}}function h5(t){const e=Er(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=l5.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=X4.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=W4.bind(null,e),e.Pu.H_=D4.bind(null,e.eventManager),e.Pu.yu=M4.bind(null,e.eventManager),e}function Z4(t){const e=Er(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Y4.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=K4.bind(null,e),e}class zh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=dp(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return n4(this.persistence,new e4,e.initialUser,this.serializer)}Cu(e){return new H2(_y.mi,this.serializer)}Du(e){return new u4}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}zh.provider={build:()=>new zh};class eI extends zh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){en(this.persistence.referenceDelegate instanceof Vh,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new B3(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?Mi.withCacheSize(this.cacheSizeBytes):Mi.DEFAULT;return new H2(n=>Vh.mi(n,r),this.serializer)}}class Sm{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Yv(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=Q4.bind(null,this.syncEngine),await N4(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new R4}()}createDatastore(e){const r=dp(e.databaseInfo.databaseId),n=function(o){return new m4(o)}(e.databaseInfo);return function(o,s,l,c){return new b4(o,s,l,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,o,s,l){return new S4(n,i,o,s,l)}(this.localStore,this.datastore,e.asyncQueue,r=>Yv(this.syncEngine,r,0),function(){return qv.v()?new qv:new d4}())}createSyncEngine(e,r){return function(i,o,s,l,c,u,h){const y=new j4(i,o,s,l,c,u);return h&&(y.gu=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await async function(r){const n=Er(r);Jt($l,"RemoteStore shutting down."),n.Ea.add(5),await nd(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Sm.provider={build:()=>new Sm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p5{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ts("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const La="FirestoreClient";class tI{constructor(e,r,n,i,o){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=pi.UNAUTHENTICATED,this.clientId=ly.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,async s=>{Jt(La,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(n,s=>(Jt(La,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Is;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=$y(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function tf(t,e){t.asyncQueue.verifyOperationInProgress(),Jt(La,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await G2(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Jv(t,e){t.asyncQueue.verifyOperationInProgress();const r=await rI(t);Jt(La,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>Uv(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>Uv(e.remoteStore,i)),t._onlineComponents=e}async function rI(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Jt(La,"Using user provided OfflineComponentProvider");try{await tf(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===pt.FAILED_PRECONDITION||i.code===pt.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Pc("Error using user provided cache. Falling back to memory cache: "+r),await tf(t,new zh)}}else Jt(La,"Using default OfflineComponentProvider"),await tf(t,new eI(void 0));return t._offlineComponents}async function f5(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Jt(La,"Using user provided OnlineComponentProvider"),await Jv(t,t._uninitializedComponentsProvider._online)):(Jt(La,"Using default OnlineComponentProvider"),await Jv(t,new Sm))),t._onlineComponents}function nI(t){return f5(t).then(e=>e.syncEngine)}async function m5(t){const e=await f5(t),r=e.eventManager;return r.onListen=V4.bind(null,e.syncEngine),r.onUnlisten=U4.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=q4.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=H4.bind(null,e.syncEngine),r}function iI(t,e,r={}){const n=new Is;return t.asyncQueue.enqueueAndForget(async()=>function(o,s,l,c,u){const h=new p5({next:g=>{h.Nu(),s.enqueueAndForget(()=>n5(o,y));const f=g.docs.has(l);!f&&g.fromCache?u.reject(new Gt(pt.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&g.fromCache&&c&&c.source==="server"?u.reject(new Gt(pt.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),y=new i5(fy(l.path),h,{includeMetadataChanges:!0,qa:!0});return r5(o,y)}(await m5(t),t.asyncQueue,e,r,n)),n.promise}function oI(t,e,r={}){const n=new Is;return t.asyncQueue.enqueueAndForget(async()=>function(o,s,l,c,u){const h=new p5({next:g=>{h.Nu(),s.enqueueAndForget(()=>n5(o,y)),g.fromCache&&c.source==="server"?u.reject(new Gt(pt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),y=new i5(l,h,{includeMetadataChanges:!0,qa:!0});return r5(o,y)}(await m5(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y5(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qv=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g5="firestore.googleapis.com",Xv=!0;class Zv{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Gt(pt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=g5,this.ssl=Xv}else this.host=e.host,this.ssl=e.ssl??Xv;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=U2;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<F3)throw new Gt(pt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}SC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=y5(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Gt(pt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Gt(pt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Gt(pt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class fp{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Zv({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Gt(pt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Gt(pt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Zv(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new dC;switch(n.type){case"firstParty":return new mC(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Gt(pt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=Qv.get(r);n&&(Jt("ComponentProvider","Removing Datastore"),Qv.delete(r),n.terminate())}(this),Promise.resolve()}}function sI(t,e,r,n={}){t=ks(t,fp);const i=Ec(e),o=t._getSettings(),s={...o,emulatorOptions:t._getEmulatorOptions()},l=`${e}:${r}`;i&&(s1(`https://${l}`),a1("Firestore",!0)),o.host!==g5&&o.host!==l&&Pc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...o,host:l,ssl:i,emulatorOptions:n};if(!xl(c,s)&&(t._setSettings(c),n.mockUserToken)){let u,h;if(typeof n.mockUserToken=="string")u=n.mockUserToken,h=pi.MOCK_USER;else{u=DP(n.mockUserToken,t._app?.options.projectId);const y=n.mockUserToken.sub||n.mockUserToken.user_id;if(!y)throw new Gt(pt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new pi(y)}t._authCredentials=new hC(new t2(u,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Ll(this.firestore,e,this._query)}}class Tn{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ca(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Tn(this.firestore,e,this._key)}toJSON(){return{type:Tn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(ed(r,Tn._jsonSchema))return new Tn(e,n||null,new ar(pn.fromString(r.referencePath)))}}Tn._jsonSchemaVersion="firestore/documentReference/1.0",Tn._jsonSchema={type:Fn("string",Tn._jsonSchemaVersion),referencePath:Fn("string")};class Ca extends Ll{constructor(e,r,n){super(e,r,fy(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Tn(this.firestore,null,new ar(e))}withConverter(e){return new Ca(this.firestore,e,this._path)}}function aI(t,e,...r){if(t=ri(t),r2("collection","path",e),t instanceof fp){const n=pn.fromString(e,...r);return hv(n),new Ca(t,null,n)}{if(!(t instanceof Tn||t instanceof Ca))throw new Gt(pt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(pn.fromString(e,...r));return hv(n),new Ca(t.firestore,null,n)}}function v5(t,e,...r){if(t=ri(t),arguments.length===1&&(e=ly.newId()),r2("doc","path",e),t instanceof fp){const n=pn.fromString(e,...r);return dv(n),new Tn(t,null,new ar(n))}{if(!(t instanceof Tn||t instanceof Ca))throw new Gt(pt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(pn.fromString(e,...r));return dv(n),new Tn(t.firestore,t instanceof Ca?t.converter:null,new ar(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e0="AsyncQueue";class t0{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Y2(this,"async_queue_retry"),this._c=()=>{const n=ef();n&&Jt(e0,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=ef();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=ef();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new Is;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Rc(e))throw e;Jt(e0,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,Ts("INTERNAL UNHANDLED ERROR: ",r0(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const i=Iy.createAndSchedule(this,e,r,n,o=>this.hc(o));return this.tc.push(i),i}uc(){this.nc&&vr(47125,{Pc:r0(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function r0(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class od extends fp{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new t0,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new t0(e),this._firestoreClient=void 0,await e}}}function lI(t,e){const r=typeof t=="object"?t:d1(),n=typeof t=="string"?t:Dh,i=Jm(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const o=LP("firestore");o&&sI(i,...o)}return i}function Ny(t){if(t._terminated)throw new Gt(pt.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||cI(t),t._firestoreClient}function cI(t){const e=t._freezeSettings(),r=function(i,o,s,l){return new NC(i,o,s,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,y5(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)}(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new tI(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(i){const o=i?._online.build();return{_offline:i?._offline.build(o),_online:o}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mo{constructor(e){this._byteString=e}static fromBase64String(e){try{return new mo(ni.fromBase64String(e))}catch(r){throw new Gt(pt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new mo(ni.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:mo._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ed(e,mo._jsonSchema))return mo.fromBase64String(e.bytes)}}mo._jsonSchemaVersion="firestore/bytes/1.0",mo._jsonSchema={type:Fn("string",mo._jsonSchemaVersion),bytes:Fn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mp{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Gt(pt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ti(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ly{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Gt(pt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Gt(pt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Br(this._lat,e._lat)||Br(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Zo._jsonSchemaVersion}}static fromJSON(e){if(ed(e,Zo._jsonSchema))return new Zo(e.latitude,e.longitude)}}Zo._jsonSchemaVersion="firestore/geoPoint/1.0",Zo._jsonSchema={type:Fn("string",Zo._jsonSchemaVersion),latitude:Fn("number"),longitude:Fn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==i[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:es._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ed(e,es._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new es(e.vectorValues);throw new Gt(pt.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}es._jsonSchemaVersion="firestore/vectorValue/1.0",es._jsonSchema={type:Fn("string",es._jsonSchemaVersion),vectorValues:Fn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uI=/^__.*__$/;class dI{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Ba(e,this.data,this.fieldMask,r,this.fieldTransforms):new td(e,this.data,r,this.fieldTransforms)}}class b5{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Ba(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function _5(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw vr(40011,{Ac:t})}}class Ry{constructor(e,r,n,i,o,s){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Ry({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Uh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(_5(this.Ac)&&uI.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class hI{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||dp(e)}Cc(e,r,n,i=!1){return new Ry({Ac:e,methodName:r,Dc:n,path:ti.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Dy(t){const e=t._freezeSettings(),r=dp(t._databaseId);return new hI(t._databaseId,!!e.ignoreUndefinedProperties,r)}function pI(t,e,r,n,i,o={}){const s=t.Cc(o.merge||o.mergeFields?2:0,e,r,i);My("Data must be an object, but it was:",s,n);const l=S5(n,s);let c,u;if(o.merge)c=new Zi(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){const h=[];for(const y of o.mergeFields){const g=Pm(e,y,r);if(!s.contains(g))throw new Gt(pt.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);w5(h,g)||h.push(g)}c=new Zi(h),u=s.fieldTransforms.filter(y=>c.covers(y.field))}else c=null,u=s.fieldTransforms;return new dI(new Fi(l),c,u)}class yp extends Ly{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof yp}}function fI(t,e,r,n){const i=t.Cc(1,e,r);My("Data must be an object, but it was:",i,n);const o=[],s=Fi.empty();Oa(n,(c,u)=>{const h=Fy(e,c,r);u=ri(u);const y=i.yc(h);if(u instanceof yp)o.push(h);else{const g=sd(u,y);g!=null&&(o.push(h),s.set(h,g))}});const l=new Zi(o);return new b5(s,l,i.fieldTransforms)}function mI(t,e,r,n,i,o){const s=t.Cc(1,e,r),l=[Pm(e,n,r)],c=[i];if(o.length%2!=0)throw new Gt(pt.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<o.length;g+=2)l.push(Pm(e,o[g])),c.push(o[g+1]);const u=[],h=Fi.empty();for(let g=l.length-1;g>=0;--g)if(!w5(u,l[g])){const f=l[g];let x=c[g];x=ri(x);const S=s.yc(f);if(x instanceof yp)u.push(f);else{const w=sd(x,S);w!=null&&(u.push(f),h.set(f,w))}}const y=new Zi(u);return new b5(h,y,s.fieldTransforms)}function yI(t,e,r,n=!1){return sd(r,t.Cc(n?4:3,e))}function sd(t,e){if(P5(t=ri(t)))return My("Unsupported field value:",e,t),S5(t,e);if(t instanceof Ly)return function(n,i){if(!_5(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,i){const o=[];let s=0;for(const l of n){let c=sd(l,i.wc(s));c==null&&(c={nullValue:"NULL_VALUE"}),o.push(c),s++}return{arrayValue:{values:o}}}(t,e)}return function(n,i){if((n=ri(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return t3(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=mn.fromDate(n);return{timestampValue:jh(i.serializer,o)}}if(n instanceof mn){const o=new mn(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:jh(i.serializer,o)}}if(n instanceof Zo)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof mo)return{bytesValue:F2(i.serializer,n._byteString)};if(n instanceof Tn){const o=i.databaseId,s=n.firestore._databaseId;if(!s.isEqual(o))throw i.Sc(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:vy(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof es)return function(s,l){return{mapValue:{fields:{[d2]:{stringValue:h2},[Mh]:{arrayValue:{values:s.toArray().map(u=>{if(typeof u!="number")throw l.Sc("VectorValues must only contain numeric values.");return my(l.serializer,u)})}}}}}}(n,i);throw i.Sc(`Unsupported field value: ${rp(n)}`)}(t,e)}function S5(t,e){const r={};return o2(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Oa(t,(n,i)=>{const o=sd(i,e.mc(n));o!=null&&(r[n]=o)}),{mapValue:{fields:r}}}function P5(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof mn||t instanceof Zo||t instanceof mo||t instanceof Tn||t instanceof Ly||t instanceof es)}function My(t,e,r){if(!P5(r)||!n2(r)){const n=rp(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function Pm(t,e,r){if((e=ri(e))instanceof mp)return e._internalPath;if(typeof e=="string")return Fy(t,e);throw Uh("Field path arguments must be of type string or ",t,!1,void 0,r)}const gI=new RegExp("[~\\*/\\[\\]]");function Fy(t,e,r){if(e.search(gI)>=0)throw Uh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new mp(...e.split("."))._internalPath}catch{throw Uh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Uh(t,e,r,n,i){const o=n&&!n.isEmpty(),s=i!==void 0;let l=`Function ${e}() called with invalid data`;r&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=` in field ${n}`),s&&(c+=` in document ${i}`),c+=")"),new Gt(pt.INVALID_ARGUMENT,l+t+c)}function w5(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x5{constructor(e,r,n,i,o){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Tn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new vI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Oy("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class vI extends x5{data(){return super.data()}}function Oy(t,e){return typeof e=="string"?Fy(t,e):e instanceof mp?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bI(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Gt(pt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class By{}class A5 extends By{}function _I(t,e,...r){let n=[];e instanceof By&&n.push(e),n=n.concat(r),function(o){const s=o.filter(c=>c instanceof Vy).length,l=o.filter(c=>c instanceof jy).length;if(s>1||s>0&&l>0)throw new Gt(pt.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)t=i._apply(t);return t}class jy extends A5{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new jy(e,r,n)}_apply(e){const r=this._parse(e);return C5(e._query,r),new Ll(e.firestore,e.converter,dm(e._query,r))}_parse(e){const r=Dy(e.firestore);return function(o,s,l,c,u,h,y){let g;if(u.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new Gt(pt.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){i0(y,h);const x=[];for(const S of y)x.push(n0(c,o,S));g={arrayValue:{values:x}}}else g=n0(c,o,y)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||i0(y,h),g=yI(l,s,y,h==="in"||h==="not-in");return Mn.create(u,h,g)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}class Vy extends By{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new Vy(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:No.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(i,o){let s=i;const l=o.getFlattenedFilters();for(const c of l)C5(s,c),s=dm(s,c)}(e._query,r),new Ll(e.firestore,e.converter,dm(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class qy extends A5{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new qy(e,r)}_apply(e){const r=function(i,o,s){if(i.startAt!==null)throw new Gt(pt.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Gt(pt.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ju(o,s)}(e._query,this._field,this._direction);return new Ll(e.firestore,e.converter,function(i,o){const s=i.explicitOrderBy.concat([o]);return new Dc(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}function SI(t,e="asc"){const r=e,n=Oy("orderBy",t);return qy._create(n,r)}function n0(t,e,r){if(typeof(r=ri(r))=="string"){if(r==="")throw new Gt(pt.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!_2(e)&&r.indexOf("/")!==-1)throw new Gt(pt.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(pn.fromString(r));if(!ar.isDocumentKey(n))throw new Gt(pt.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return _v(t,new ar(n))}if(r instanceof Tn)return _v(t,r._key);throw new Gt(pt.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${rp(r)}.`)}function i0(t,e){if(!Array.isArray(t)||t.length===0)throw new Gt(pt.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function C5(t,e){const r=function(i,o){for(const s of i)for(const l of s.getFlattenedFilters())if(o.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Gt(pt.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Gt(pt.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class PI{convertValue(e,r="none"){switch(ka(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Cn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Ta(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw vr(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Oa(e,(i,o)=>{n[i]=this.convertValue(o,r)}),n}convertVectorValue(e){const r=e.fields?.[Mh].arrayValue?.values?.map(n=>Cn(n.doubleValue));return new es(r)}convertGeoPoint(e){return new Zo(Cn(e.latitude),Cn(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=op(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Fu(e));default:return null}}convertTimestamp(e){const r=Ea(e);return new mn(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=pn.fromString(e);en(z2(n),9688,{name:e});const i=new Ou(n.get(1),n.get(3)),o=new ar(n.popFirst(5));return i.isEqual(r)||Ts(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wI(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class pu{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class vl extends x5{constructor(e,r,n,i,o,s){super(e,r,n,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new hh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Oy("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Gt(pt.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=vl._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}vl._jsonSchemaVersion="firestore/documentSnapshot/1.0",vl._jsonSchema={type:Fn("string",vl._jsonSchemaVersion),bundleSource:Fn("string","DocumentSnapshot"),bundleName:Fn("string"),bundle:Fn("string")};class hh extends vl{data(e={}){return super.data(e)}}class vc{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new pu(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new hh(this._firestore,this._userDataWriter,n.key,n,new pu(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Gt(pt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(l=>{const c=new hh(i._firestore,i._userDataWriter,l.doc.key,l.doc,new pu(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>o||l.type!==3).map(l=>{const c=new hh(i._firestore,i._userDataWriter,l.doc.key,l.doc,new pu(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,h=-1;return l.type!==0&&(u=s.indexOf(l.doc.key),s=s.delete(l.doc.key)),l.type!==1&&(s=s.add(l.doc),h=s.indexOf(l.doc.key)),{type:xI(l.type),doc:c,oldIndex:u,newIndex:h}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Gt(pt.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=vc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ly.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(r.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function xI(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return vr(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AI(t){t=ks(t,Tn);const e=ks(t.firestore,od);return iI(Ny(e),t._key).then(r=>$I(e,t,r))}vc._jsonSchemaVersion="firestore/querySnapshot/1.0",vc._jsonSchema={type:Fn("string",vc._jsonSchemaVersion),bundleSource:Fn("string","QuerySnapshot"),bundleName:Fn("string"),bundle:Fn("string")};class I5 extends PI{constructor(e){super(),this.firestore=e}convertBytes(e){return new mo(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Tn(this.firestore,null,r)}}function CI(t){t=ks(t,Ll);const e=ks(t.firestore,od),r=Ny(e),n=new I5(e);return bI(t._query),oI(r,t._query).then(i=>new vc(e,n,t,i))}function II(t,e,r){t=ks(t,Tn);const n=ks(t.firestore,od),i=wI(t.converter,e);return E5(n,[pI(Dy(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,Qo.none())])}function $5(t,e,r,...n){t=ks(t,Tn);const i=ks(t.firestore,od),o=Dy(i);let s;return s=typeof(e=ri(e))=="string"||e instanceof mp?mI(o,"updateDoc",t._key,e,r,n):fI(o,"updateDoc",t._key,e),E5(i,[s.toMutation(t._key,Qo.exists(!0))])}function E5(t,e){return function(n,i){const o=new Is;return n.asyncQueue.enqueueAndForget(async()=>G4(await nI(n),i,o)),o.promise}(Ny(t),e)}function $I(t,e,r){const n=r.docs.get(e._key),i=new I5(t);return new vl(t,i,e._key,n,new pu(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){Nc=i})(Tc),_c(new Al("firestore",(n,{instanceIdentifier:i,options:o})=>{const s=n.getProvider("app").getImmediate(),l=new od(new pC(n.getProvider("auth-internal")),new yC(s,n.getProvider("app-check-internal")),function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Gt(pt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ou(u.options.projectId,h)}(s,i),s);return o={useFetchStreams:r,...o},l._setSettings(o),l},"PUBLIC").setMultipleInstances(!0)),wa(av,lv,e),wa(av,lv,"esm2020")})();let EI="eyAiYXBpS2V5IjogIkFJemFTeUJBbGN2WlRMMXRsQ05LRExENEJpTWJhR01iTnhCRjQtTSIsICAiYXV0aERvbWFpbiI6ICJocm0tMTEyOC5maXJlYmFzZWFwcC5jb20iLCAgImRhdGFiYXNlVVJMIjogImh0dHBzOi8vaHJtLTExMjguZmlyZWJhc2Vpby5jb20iLCAgInByb2plY3RJZCI6ICJocm0tMTEyOCIsICAic3RvcmFnZUJ1Y2tldCI6ICJocm0tMTEyOC5hcHBzcG90LmNvbSIsICAibWVzc2FnaW5nU2VuZGVySWQiOiAiMTA0OTI1MDU4NTI0NSIsICAiYXBwSWQiOiAiMToxMDQ5MjUwNTg1MjQ1OndlYjowZGFkMDAyMDI3MjM1MTRjY2M1Mjc0In0=";const T5=u1(JSON.parse(wP(EI))),ll=aC(T5),Hh=new Wo,wm=lI(T5);Hh.addScope("profile");Hh.addScope("email");class fu extends Error{}fu.prototype.name="InvalidTokenError";function TI(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function kI(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return TI(e)}catch{return atob(e)}}function NI(t,e){if(typeof t!="string")throw new fu("Invalid token specified: must be a string");e||(e={});const r=e.header===!0?0:1,n=t.split(".")[r];if(typeof n!="string")throw new fu(`Invalid token specified: missing part #${r+1}`);let i;try{i=kI(n)}catch(o){throw new fu(`Invalid token specified: invalid base64 for part #${r+1} (${o.message})`)}try{return JSON.parse(i)}catch(o){throw new fu(`Invalid token specified: invalid json for part #${r+1} (${o.message})`)}}const LI={clientId:"195275085181-8ccjpgp8v1g80qhnlk6v4lpgid7n81gr.apps.googleusercontent.com"},RI=t=>{const e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.onload=()=>{window.google&&window.google.accounts.id.initialize({client_id:LI.clientId,callback:r=>{t(r.credential)},auto_select:!1,cancel_on_tap_outside:!0})},document.head.appendChild(e)},DI=t=>NI(t),MI=()=>{window.google&&window.google.accounts.id.disableAutoSelect()},[FI,OI]=Yu({}),BI=async()=>{const e=await hi({query:"qcm42351987"});if(e&&!e.error){let n=Object.assign({},{},e);OI(n)}return 1},jI=async t=>{let e=FI?.[992002];e&&(e.params={tkn:t})},[ec,ui]=Yu({user:null,loading:!0,error:null,authMethod:null}),[k5,o0]=Ce(null);Yx(ll,t=>{t?ui({user:t,loading:!1,error:null,authMethod:"firebase"}):k5()||ui({user:null,loading:!1,error:null,authMethod:null})});wA(ll).then(t=>{t&&ui({user:t.user,loading:!1,error:null,authMethod:"firebase"})}).catch(t=>{console.error("Redirect sign-in error:",t),ui({loading:!1,error:t.message})});const pr={get state(){return ec},async getUserProfile(t){try{const e=v5(wm,"users",t),r=await AI(e);if(r.exists()){ui("profile",r.data());let n={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_2376:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1},i=r.data(),o={};return Object.keys(n).map(s=>{let l=n?.[s];i.hasOwnProperty(s)||(o[s]=l)}),Object.keys(o).length>0&&$5(e,o),r.data()}else{let n=pr?.state?.user,i={uid:n?.uid,email:n?.email,displayName:n?.displayName,createdAt:new Date,stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_2376:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1};return await II(e,i),console.log("No such user profile!"),null}}catch(e){return console.error("Error fetching user profile:",e),null}},getBusinessId:()=>pr.state?.profile?.businessId,hasPermission:t=>{const e=pr.state?.profile;return e?.isAdmin?!0:e?e?.[t]===!0:!1},async signInWithGoogle(){try{ui("loading",!0),ui("error",null);try{const t=await mA(ll,Hh);ui({user:t.user,loading:!1,error:null,authMethod:"firebase"});try{pr.getUserProfile(t.user.uid)}catch(e){console.error("firestore error:",e)}}catch(t){if(t.code==="auth/popup-blocked")await SA(ll,Hh);else throw t}}catch(t){console.error("Sign-in error:",t),ui({loading:!1,error:t.message||"Failed to sign in with Google"})}},async signInWithGoogleP(t){const r=await hi({params:{id_token:t},query:"getGoogleUserbyToken"});if(r&&r){let n=new Date().getTime(),i=new Date(n+6e4*60*24*365),o="hrm_tkn_acc";document.cookie=`${o}=${r.data}; expires=${i}; path=/;g_state = {"i_l":1,"i_p":${i}}; ssgl_access_tkn = ${t}`,document.cookie=`ssgl_access_tkn = ${t}; expires=${i};`,await BI(),jI(r.data)}},async signInWithGoogleCloud(t){try{ui("loading",!0),ui("error",null);const e=DI(t),r={uid:e.sub,email:e.email,displayName:e.name,photoURL:e.picture};o0(r);const n={uid:r.uid,email:r.email,displayName:r.displayName,photoURL:r.photoURL,emailVerified:!0};ui({user:n,loading:!1,error:null,authMethod:"google-cloud"});try{const i=Wo.credential(t);await Hx(ll,i)}catch{console.log("Firebase sign-in optional, continuing with Google Cloud auth")}}catch(e){console.error("Google Cloud sign-in error:",e),ui({loading:!1,error:e.message||"Failed to sign in with Google Cloud"})}},async signOut(){try{ui("loading",!0),(ec.authMethod==="firebase"||ll.currentUser)&&await Kx(ll),ec.authMethod==="google-cloud"&&(MI(),o0(null)),ui({user:null,loading:!1,error:null,authMethod:null})}catch(t){console.error("Sign-out error:",t),ui({loading:!1,error:t.message||"Failed to sign out"})}},get isAuthenticated(){return!!ec.user||!!k5()},get currentUser(){return ec.user},get authMethod(){return ec.authMethod}},VI=async()=>({}),qI=()=>(typeof window<"u"&&localStorage.getItem("hrmfinance-api-mode"),"real");let cl=qI();const xm={getMode(){return cl},setMode(t){cl=t,typeof window<"u"&&localStorage.setItem("hrmfinance-api-mode",t)},isFakeMode(){return cl==="fake"},isRealMode(){return cl==="real"},isHybridMode(){return cl==="hybrid"}},Oi=async(t,e,r=!0)=>{if(cl==="fake")return e();if(cl==="real")return t();try{return await t()}catch(n){if(console.warn("Real API failed, falling back to fake server:",n),r)return e();throw n}},s0={async getAll(t,e){const r=await hi({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:{businessId:pr.getBusinessId(),":search0":"produ"}});return Jf(r)},async getById(t){return Oi(async()=>(await this.getAll()).find(r=>r.id===t)||null,()=>Ei.products.getById(t))},async create(t){return Oi(async()=>{throw console.log("Creating product via real API:",t),new Error("Real API not implemented yet")},()=>Ei.products.create(t))},async update(t,e){return Oi(async()=>{throw console.log("Updating product via real API:",t,e),new Error("Real API not implemented yet")},()=>Ei.products.update(t,e))},async delete(t){return Oi(async()=>{throw console.log("Deleting product via real API:",t),new Error("Real API not implemented yet")},()=>Ei.products.delete(t))}},vi={async getInventory(t,e){if(!(t&&t?.trim()))return[];let r={businessId:pr.getBusinessId()};return t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())}),await hi({query:"getScanYabaInventory",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async getProducts(t){if(!(t&&t?.trim()))return[];let e={businessId:pr.getBusinessId()};return t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())}),await hi({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async getConsigee(t){if(!(t&&t?.trim()))return[];let e={businessId:"all"};return t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())}),await hi({query:"getScanConsigneeYabaExpress",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async getShipper(t){if(!(t&&t?.trim()))return[];let e={businessId:"all"};return t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())}),await hi({query:"getScanShipperYabaExpress",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async getInvoice(t,e){if(!(t&&t?.trim()))return[];let r={businessId:pr.getBusinessId()};return t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())}),await hi({query:"getScanYabaSalesOrders",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async addInventory(t){let r={query:"addYabaInventory",params:{businessId:pr.getBusinessId()},form:t};return await hi(r)},async updInventory(t){return pr.getBusinessId(),await VI()},async addInvoice(t){let r={query:"addYabaSalesOrders",params:{businessId:pr.getBusinessId()},form:t};return await hi(r)},async getHBLS(t,e){if(!(t&&t?.trim()))return[];let r={businessId:pr.getBusinessId()};e?.search,e?.guia&&e.guia!=="all"&&(r.guia=e.guia),t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())});let n={query:"getScanYabaHbls",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4 AND guia = guia",params:r};const i=await hi(n);return console.log(n),console.log(i),i}},zy={async getAll(t){return vi.getInventory("ref")},async getById(t){return Oi(async()=>{throw console.log("Getting movement by ID via real API:",t),new Error("Real API not implemented yet")},()=>Ei.movements.getById(t))},async create(t){return Oi(async()=>{throw console.log("Creating movement via real API:",t),new Error("Real API not implemented yet")},()=>Ei.movements.create(t))},async update(t,e){return Oi(async()=>{throw console.log("Updating movement via real API:",t,e),new Error("Real API not implemented yet")},()=>Ei.movements.update(t,e))},async createBulk(t){return Oi(async()=>{throw console.log("Creating bulk movements via real API:",t),new Error("Real API not implemented yet")},()=>Ei.movements.createBulk(t))},async getStockLevels(t){return await hi({query:"calculateInventoryStock",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:t})},async calcStockLevels(){return[]}},Gh={async getAlls(t,e){if(console.log("getAlls",t),!(t&&t?.trim()))return[];let r={businessId:"hcPiDPfZFS8ymqoh"};return e?.search,t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())}),await hi({query:"getAllAccountsByUserId",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4 AND guia = guia",params:r})},async getAll(t){return Oi(async()=>{throw console.log("Getting accounts via real API:",t),new Error("Real API not implemented yet")},()=>Ei.accounts.getAll(t))},async getById(t){return Oi(async()=>{throw console.log("Getting account by ID via real API:",t),new Error("Real API not implemented yet")},()=>Ei.accounts.getById(t))},async create(t){let r={query:"addAccounts",params:{businessId:"hcPiDPfZFS8ymqoh"},form:t};console.log(r);const n=await hi(r);return console.log(n),n},async update(t,e){let n={query:"updateAccounts",params:{businessId:"hcPiDPfZFS8ymqoh",accountId:t},data2update:e};console.log(n);const i=await hi(n);return console.log(i),i}},a0={async getNextEntryNumber(){return Oi(async()=>{throw console.log("Getting next entry number via real API"),new Error("Real API not implemented yet")},()=>Ei.utils.getNextEntryNumber())},async getNextProductCode(t){return Oi(async()=>{throw console.log("Getting next product code via real API:",t),new Error("Real API not implemented yet")},()=>Ei.utils.getNextProductCode(t))},async healthCheck(){return Oi(async()=>{const t=await fetch("/api/health");if(!t.ok)throw new Error("Health check failed");return t.json()},()=>Ei.utils.healthCheck())},async getStats(){return Oi(async()=>{throw console.log("Getting stats via real API"),new Error("Real API not implemented yet")},()=>Ei.utils.getStats())}},zI=()=>{xm.setMode("real"),console.log("🚀 HRM Finance initialized in REAL API mode for production")};zI();var UI=he("<p>"),HI=he('<div><div><div><h1>HRM Finance</h1><p>Complete Business Management Solution</p><div><div><button><svg width=24 height=24 viewBox="0 0 24 24"><path fill=#4285F4 d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"></path><path fill=#34A853 d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"></path><path fill=#FBBC05 d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"></path><path fill=#EA4335 d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"></path></svg></button><p>Firebase Authentication</p></div></div></div><div><div><div>💰</div><h3>Financial Management</h3><p>Complete chart of accounts, balance sheets, journal entries, and invoice management in one place.</p></div><div><div>👥</div><h3>HR Management</h3><p>Track employees, manage onboarding, and monitor your workforce with powerful analytics.</p></div><div><div>📦</div><h3>Inventory Control</h3><p>Real-time inventory tracking, product management, and movement history across multiple locations.</p></div><div><div>🏦</div><h3>Banking Integration</h3><p>Streamline bank reconciliation with CSV imports and automated consolidation features.</p></div><div><div>📊</div><h3>Real-time Analytics</h3><p>Get instant insights with dashboards showing revenue, cash flow, and business performance.</p></div><div><div>🌐</div><h3>Multi-language Support</h3><p>Available in multiple languages to support your global business operations.</p></div></div><div><p>Secure authentication powered by Google • Your data is encrypted and protected</p><p>Choose your preferred authentication method above');const GI=()=>{wn(()=>{RI(w=>{pr.signInWithGoogleP(w)}),setTimeout(()=>{},100)});const t={"min-height":"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},e={background:"white","border-radius":"1rem","box-shadow":"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","max-width":"1200px",width:"100%",overflow:"hidden"},r={padding:"3rem","text-align":"center","border-bottom":"1px solid #e2e8f0"},n={"font-size":"2.5rem","font-weight":"800",color:"#1a202c","margin-bottom":"1rem"},i={"font-size":"1.125rem",color:"#718096","margin-bottom":"2rem"},o={display:"flex","flex-direction":"column",gap:"1rem","align-items":"center","margin-bottom":"1rem"},s={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"2rem",padding:"3rem"},l={"text-align":"center",padding:"2rem","border-radius":"0.5rem",background:"#f7fafc",transition:"transform 0.2s",cursor:"default"},c={"font-size":"3rem","margin-bottom":"1rem"},u={"font-size":"1.25rem","font-weight":"600",color:"#2d3748","margin-bottom":"0.5rem"},h={color:"#718096","line-height":"1.6"},y={display:"inline-flex","align-items":"center",gap:"0.75rem",background:"white",color:"#4285f4",border:"2px solid #4285f4",padding:"0.75rem 2rem","font-size":"1.125rem","font-weight":"500","border-radius":"0.5rem",cursor:"pointer",transition:"all 0.2s","min-width":"250px","justify-content":"center"},g={color:"#e53e3e","margin-top":"1rem","font-size":"0.875rem"},f={background:"#f7fafc",padding:"2rem","text-align":"center",color:"#718096","font-size":"0.875rem"},x={"font-size":"0.75rem",color:"#718096","margin-top":"0.25rem","font-style":"italic"},S=()=>{pr.signInWithGoogle()};return(()=>{var w=HI(),E=w.firstChild,q=E.firstChild,ee=q.firstChild,W=ee.nextSibling,K=W.nextSibling,te=K.firstChild,$=te.firstChild;$.firstChild;var C=$.nextSibling,T=q.nextSibling,O=T.firstChild,b=O.firstChild,P=b.nextSibling,_=P.nextSibling,z=O.nextSibling,Z=z.firstChild,k=Z.nextSibling,F=k.nextSibling,X=z.nextSibling,U=X.firstChild,B=U.nextSibling,ce=B.nextSibling,L=X.nextSibling,D=L.firstChild,j=D.nextSibling,I=j.nextSibling,M=L.nextSibling,J=M.firstChild,H=J.nextSibling,Q=H.nextSibling,se=M.nextSibling,G=se.firstChild,re=G.nextSibling,oe=re.nextSibling,fe=T.nextSibling,ae=fe.firstChild,Y=ae.nextSibling;return m(w,t),m(E,e),m(q,r),m(ee,n),m(W,i),m(K,o),$.addEventListener("mouseleave",ie=>{ie.currentTarget.style.background="white",ie.currentTarget.style.color="#4285f4"}),$.addEventListener("mouseenter",ie=>{ie.currentTarget.style.background="#4285f4",ie.currentTarget.style.color="white"}),$.$$click=S,m($,y),a($,R(ze,{get when(){return pr.state.loading},fallback:"Sign in with Google",children:"Signing in..."}),null),m(C,x),a(q,R(ze,{get when(){return pr.state.error},get children(){var ie=UI();return m(ie,g),a(ie,()=>pr.state.error),ie}}),null),m(T,s),m(fe,f),Y.style.setProperty("margin-top","0.5rem"),Y.style.setProperty("font-size","0.75rem"),Se(ie=>{var de=pr.state.loading,ue=l,ge=c,Pe=u,pe=h,_e=l,Le=c,De=u,Te=h,$e=l,Ie=c,Re=u,Je=h,Be=l,Ke=c,Xe=u,at=h,ot=l,Qe=c,dt=u,ct=h,kt=l,gt=c,qe=u,Dt=h;return de!==ie.e&&($.disabled=ie.e=de),ie.t=m(O,ue,ie.t),ie.a=m(b,ge,ie.a),ie.o=m(P,Pe,ie.o),ie.i=m(_,pe,ie.i),ie.n=m(z,_e,ie.n),ie.s=m(Z,Le,ie.s),ie.h=m(k,De,ie.h),ie.r=m(F,Te,ie.r),ie.d=m(X,$e,ie.d),ie.l=m(U,Ie,ie.l),ie.u=m(B,Re,ie.u),ie.c=m(ce,Je,ie.c),ie.w=m(L,Be,ie.w),ie.m=m(D,Ke,ie.m),ie.f=m(j,Xe,ie.f),ie.y=m(I,at,ie.y),ie.g=m(M,ot,ie.g),ie.p=m(J,Qe,ie.p),ie.b=m(H,dt,ie.b),ie.T=m(Q,ct,ie.T),ie.A=m(se,kt,ie.A),ie.O=m(G,gt,ie.O),ie.I=m(re,qe,ie.I),ie.S=m(oe,Dt,ie.S),ie},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0}),w})()};br(["click"]);var WI=he("<div><div>");const YI=t=>{const e={"min-height":"100vh",display:"flex","align-items":"center","justify-content":"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},r={width:"50px",height:"50px",border:"3px solid rgba(255, 255, 255, 0.3)","border-top-color":"white","border-radius":"50%",animation:"spin 1s linear infinite"},n=document.createElement("style");return n.textContent=`
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  `,document.head.appendChild(n),gi(async()=>{pr.state?.user?.uid&&pr.getUserProfile(pr.state?.user?.uid)}),wn(()=>{}),R(ze,{get when(){return!pr.state.loading},get fallback(){return(()=>{var i=WI(),o=i.firstChild;return m(i,e),m(o,r),i})()},get children(){return R(ze,{get when(){return pr.isAuthenticated},get fallback(){return R(GI,{})},get children(){return t.children}})}})};var KI=he("<button>");const ht=t=>{const e=()=>{const r={"font-family":"inherit",cursor:t.disabled?"not-allowed":"pointer",border:"none","border-radius":"var(--border-radius-sm)","font-weight":"500",transition:"all 0.2s ease","text-decoration":"none",display:"inline-flex","align-items":"center","justify-content":"center",gap:"0.5rem",opacity:t.disabled?"0.6":"1"},n={sm:{padding:"0.5rem 1rem","font-size":"0.875rem"},md:{padding:"0.75rem 1.5rem","font-size":"1rem"},lg:{padding:"1rem 2rem","font-size":"1.125rem"}},i={primary:{background:"linear-gradient(135deg, var(--primary-color), var(--primary-dark))",color:"white","box-shadow":"var(--shadow-sm)"},secondary:{background:"var(--surface-color)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},outline:{background:"transparent",color:"var(--primary-color)",border:"1px solid var(--primary-color)"}};return{...r,...n[t.size||"md"],...i[t.variant||"primary"]}};return(()=>{var r=KI();return is(r,"click",t.onClick,!0),a(r,()=>t.children),Se(n=>{var i=e(),o=t.disabled,s=t.type||"button",l=`btn btn-${t.variant||"primary"} ${t.className||""}`;return n.e=m(r,i,n.e),o!==n.t&&(r.disabled=n.t=o),s!==n.a&&tr(r,"type",n.a=s),l!==n.o&&Um(r,n.o=l),n},{e:void 0,t:void 0,a:void 0,o:void 0}),r})()};br(["click"]);var JI=he("<div><div><div><h2></h2><button>×</button></div><div>");const On=t=>{const e={position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","z-index":"1000"},r={background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)",width:"90%","max-height":"80vh",overflow:"auto",position:"relative"},n={padding:"1.5rem","border-bottom":"1px solid var(--border-color)",display:"flex","justify-content":"space-between","align-items":"center"},i={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},o={background:"none",border:"none","font-size":"1.5rem",cursor:"pointer",color:"var(--text-muted)",padding:"0.5rem","border-radius":"var(--border-radius-sm)"},s={padding:"1.5rem"},l=c=>{c.target===c.currentTarget&&t.onClose()};return R(ze,{get when(){return t.isOpen},get children(){var c=JI(),u=c.firstChild,h=u.firstChild,y=h.firstChild,g=y.nextSibling,f=h.nextSibling;return c.$$click=l,m(h,n),m(y,i),a(y,()=>t.title),g.addEventListener("mouseleave",x=>x.target.style.background="none"),g.addEventListener("mouseenter",x=>x.target.style.background="var(--background-color)"),is(g,"click",t.onClose,!0),m(g,o),m(f,s),a(f,()=>t.children),Se(x=>{var S=e,w=r;return x.e=m(c,S,x.e),x.t=m(u,w,x.t),x},{e:void 0,t:void 0}),c}})};br(["click"]);var l0=he("<div>"),QI=he("<h3>"),XI=he("<p>");const Ot=t=>{const e={background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"1.5rem","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",transition:"all 0.2s ease",cursor:t.onClick?"pointer":"default",margin:"9px"},r={"margin-bottom":"1rem"},n={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0 0 0.5rem 0"},i={"font-size":"0.875rem",color:"var(--text-muted)",margin:"0"};return(()=>{var o=l0();return is(o,"click",t.onClick,!0),a(o,(()=>{var s=Ee(()=>!!(t.title||t.subtitle));return()=>s()&&(()=>{var l=l0();return m(l,r),a(l,(()=>{var c=Ee(()=>!!t.title);return()=>c()&&(()=>{var u=QI();return m(u,n),a(u,()=>t.title),u})()})(),null),a(l,(()=>{var c=Ee(()=>!!t.subtitle);return()=>c()&&(()=>{var u=XI();return m(u,i),a(u,()=>t.subtitle),u})()})(),null),l})()})(),null),a(o,()=>t.children,null),Se(s=>{var l=e,c=`card ${t.className||""}`;return s.e=m(o,l,s.e),c!==s.t&&Um(o,s.t=c),s},{e:void 0,t:void 0}),o})()};br(["click"]);var ZI=he("<div><label></label><input>"),e$=he("<span>*");const $r=t=>{const e={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},r={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},n={"margin-bottom":"1rem"},[i,o]=Ce("");gi(()=>{t?.value!==void 0&&o(t.value.toString())});const s=c=>{(c.key==="Enter"||c.key==="Escape"||c.key==="Tab")&&t.onChange&&gl(i())&&t.onChange(i())},l=()=>{gl(i())&&t.onChange(i())};return(()=>{var c=ZI(),u=c.firstChild,h=u.nextSibling;return m(c,n),m(u,e),a(u,()=>t.label,null),a(u,(()=>{var y=Ee(()=>!!t.required);return()=>y()&&(()=>{var g=e$();return g.style.setProperty("color","var(--primary-color)"),g})()})(),null),h.addEventListener("blur",y=>{l(),y.target.style.borderColor="var(--border-color)"}),h.addEventListener("focus",y=>{y.target.style.borderColor="var(--primary-color)"}),h.$$keydown=s,h.$$input=y=>o(y.target.value),m(h,r),Se(y=>{var g=t.type||"text",f=t.placeholder,x=t.required,S=t.disabled;return g!==y.e&&tr(h,"type",y.e=g),f!==y.t&&tr(h,"placeholder",y.t=f),x!==y.a&&(h.required=y.a=x),S!==y.o&&(h.disabled=y.o=S),y},{e:void 0,t:void 0,a:void 0,o:void 0}),Se(()=>h.value=i()),c})()};br(["input","keydown"]);const t$={en:{common:{save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",close:"Close",search:"Search",filter:"Filter",reset:"Reset",back:"Back",next:"Next",previous:"Previous",yes:"Yes",no:"No",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",confirm:"Confirm",actions:"Actions",status:"Status",active:"Active",inactive:"Inactive",date:"Date",time:"Time",description:"Description",notes:"Notes",amount:"Amount",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Language",english:"English",spanish:"Spanish",noDataFound:"No data found",required:"Required",optional:"Optional",all:"All",none:"None",select:"Select",clear:"Clear",searching:"Searching...",refresh:"Refresh",showAll:"Show All",products:"products",filtered:"Filtered",view:"View",suggested:"Suggested",clearFilters:"Clear Filters",enhanced:"Enhanced",legacy:"Legacy",email:"Email",phone:"Phone",address:"Address",name:"Name",code:"Code",category:"Category",type:"Type",quantity:"Quantity",price:"Price",cost:"Cost",value:"Value",balance:"Balance",created:"Created",modified:"Modified",details:"Details",summary:"Summary",history:"History",new:"New",addNew:"Add New",unknown:"Unknown",notAvailable:"N/A",remove:"Remove",startDate:"Start Date",endDate:"End Date",from:"From",invoice:"Invoice",invoices:"invoices",reference:"Reference",createdBy:"Created By",units:"units",invoiceDocumentId:"Invoice/Document ID",referenceNumber:"Reference Number",referenceNumberPlaceholder:"Enter reference number...",generalNotes:"General Notes",auto:"Auto",optionalNotes:"Optional notes...",showPerPage:"Show per page",first:"First",last:"Last",store:"Store",orderId:"Order ID",tax:"Tax",paymentMethods:"Payment Methods",cash:"Cash",creditCard:"Credit Card",shipping:"Shipping",air:"Air",sea:"Sea",thankYouBusiness:"Thank you for your business!",thankForChoosingUs:"Thank you for choosing us!",taxExemptNote:"Tax exempted on cash payment.",youSaved:"You saved",generatedOn:"Generated on",printSavePDF:"Print / Save as PDF",pageOfPages:"Page {{current}} of {{total}}",showingXofY:"Showing {{start}}-{{end}} of {{total}}",page:"Page",of:"of",print:"Print",export:"Export",pending:"Pending",completed:"Completed",customer:"Customer",location:"Location",reservations:"Reservations",backToDashboard:"Back to Dashboard",lbs:"pounds"},navigation:{dashboard:"Dashboard",accounts:"Chart of Accounts",balanceSheet:"Balance Sheet",inventory:"Inventory",employees:"Employees",entryBooks:"Entry Books",consolidate:"Bank Consolidation",reports:"Reports",settings:"Settings"},dashboard:{title:"Dashboard",welcome:"Welcome to HRM Finance",totalRevenue:"Total Revenue",overview:"Overview",recentActivity:"Recent Activity",quickActions:"Quick Actions",employeeCount:"Employee Count",pendingInvoices:"Pending Invoices",cashBalance:"Cash Balance",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalExpenses:"Total Expenses",netIncome:"Net Income",netLoss:"Net Loss",monthlyPayroll:"Monthly Payroll",current:"Current",newHires:"+3 new hires",outstanding:"Outstanding",totalOutstanding:"$23,450 total",lastUpdatedToday:"Last updated today",commonTasks:"Common tasks",generateReport:"Generate Report",latestUpdates:"Latest updates",invoicePaid:"Invoice #1234 paid",hoursAgo:"2 hours ago",newEmployeeOnboarded:"New employee onboarded",dayAgo:"1 day ago",monthlyReportGenerated:"Monthly report generated",daysAgo:"2 days ago"},accounts:{title:"Chart of Accounts",accountNumber:"Account Number",accountName:"Account Name",accountType:"Account Type",category:"Category",balance:"Balance",parentAccount:"Parent Account",subAccounts:"Sub-accounts",addAccount:"Add Account",editAccount:"Edit Account",deleteAccount:"Delete Account",accountDetails:"Account Details",transactions:"Transactions",accountHistory:"Account History",backToAccounts:"Back to Accounts",accountNotFound:"Account not found",accountInformation:"Account Information",accountPurpose:"Account purpose",transactionHistory:"Transaction History",noTransactions:"No transactions found for this account",createdDate:"Created Date",lastModified:"Last Modified",noDescription:"No description provided.",totalCount:"Total count",basicDetails:"Basic details",currentBalance:"Current balance",classification:"Classification",allTransactions:"All account transactions",reference:"Reference",allAccounts:"All Accounts",types:{asset:"Asset",liability:"Liability",equity:"Equity",revenue:"Revenue",expense:"Expense"},categories:{currentAssets:"Current Assets",fixedAssets:"Fixed Assets",currentLiabilities:"Current Liabilities",longTermLiabilities:"Long-term Liabilities",ownersEquity:"Owner's Equity",operatingRevenue:"Operating Revenue",operatingExpenses:"Operating Expenses"}},inventory:{title:"Inventory Management",overview:"Overview",products:"Products & Stock",movements:"Movements",locations:"Locations",bulkMovement:"Bulk Movement",addMovement:"Add Movement",addProduct:"Add Product",addLocation:"Add Location",singleMovement:"Add Single Movement",addNewItem:"Add New Item",activeProducts:"Active Products",lowStockAlert:"Low Stock Items",totalValue:"Total Stock Value",activeLocations:"Active Locations",productsNeedRestocking:"products need restocking",recentMovements:"Recent Movements",noProducts:"No products at this location",productName:"Product Name",productCode:"Product Code",sku:"SKU",unitOfMeasure:"Unit of Measure",unitCost:"Unit Cost",minStockLevel:"Min Stock Level",maxStockLevel:"Max Stock Level",locationName:"Location Name",locationType:"Location Type",locationCode:"Location Code",movementType:"Movement Type",referenceNumber:"Reference Number",invoiceNumber:"Invoice Number",fromLocation:"From Location",toLocation:"To Location",stockIn:"Stock In",stockOut:"Stock Out",transfer:"Transfer",adjustment:"Adjustment",inStock:"In Stock",lowStock:"Low Stock",outOfStock:"Out of Stock",stockLevels:"Stock Levels",stockByLocation:"Stock by Location",searchProducts:"Search products by name, SKU, or category...",searchProductsStock:"Search products and check stock levels...",searchResult:"Search Result",searchResults:"Search Results",searchFallback:"Showing local results",tryDifferentTerm:"Try a different search term or check spelling.",showingTopResults:"Showing top {{count}} results",searchLocations:"Search locations...",noMovements:"No movements found",productDetails:"Product Details",locationDetails:"Location Details",movementDetails:"Movement Details",totalProducts:"Total Products",totalLocations:"Total Locations",lastSeen:"Last seen",warehouseType:"Warehouse",storeType:"Store",supplierType:"Supplier",customerType:"Customer",currentlyManaged:"Currently managed",needAttention:"Need attention",currentWorth:"Current worth",warehousesStores:"Warehouses & stores",thisMonth:"This Month",latestActivities:"Latest inventory activities",searchMovements:"Search Movements",countingSheet:"Counting Sheet",physicalCount:"Physical Count",physicalInventoryCount:"Physical Inventory Count",setupPhysicalCount:"Setup Physical Inventory Count",setupDescription:"Configure your physical inventory count settings and begin the counting process.",countWillInclude:"This count will include {{count}} products from {{location}} in {{category}} category.",startCounting:"Start Physical Count",counted:"Counted",remaining:"Remaining",variances:"Variances",complete:"Complete",systemQty:"System Qty",variance:"Variance",addNotes:"Add notes...",reviewAndConfirm:"Review and Confirm Adjustments",reviewDescription:"Review the inventory adjustments below and confirm to update your system.",stockIncreases:"Stock Increases",stockDecreases:"Stock Decreases",totalAdjustments:"Total Adjustments",confirmAdjustments:"Confirm Adjustments",perfectCount:"Perfect Count!",noVariances:"No variances found. Your physical count matches the system exactly.",physicalCountAdjustment:"Physical count adjustment",inventoryCountingSheetTitle:"INVENTORY COUNTING SHEET",location:"Location",allCategories:"All Categories",countedBy:"Counted by",verifiedBy:"Verified by",instructions:"Instructions",countInstructions:["Count all items physically present at this location",'Write the actual count in the "Physical Count" column',"Leave blank if item is not found",'Note any discrepancies in the "Notes" column',"Sign and date when complete"],unit:"Unit",totalProductsListed:"Total Products Listed",itemsCounted:"Items Counted",summaryFor:"SUMMARY FOR",discrepanciesFound:"Discrepancies Found",counterSignature:"Counter Signature",supervisorSignature:"Supervisor Signature",downloadCSV:"Download CSV",noAdjustmentsToDownload:"No adjustments to download",stockIncrease:"Stock Increase",stockDecrease:"Stock Decrease",purchaseReceive:"Purchase/Receive",saleIssue:"Sale/Issue",generalNotesPlaceholder:"Enter general notes for this movement...",sortBy:"Sort By",allLocations:"All Locations",searchByProduct:"Search by product, location, reference, notes, invoice...",allProducts:"All Products",bulkMovementReport:"Bulk Movement Report",totalQuantity:"Total Quantity",estimatedValue:"Estimated Value",viewHistoricalReports:"View Historical Reports",noBulkReportsFound:"No bulk movement reports found",bulkReportsAppearHere:"Bulk movement reports will appear here after you create bulk movements",allTypes:"All Types",startDate:"Start Date",endDate:"End Date",totalMovements:"Total Movements",totalItems:"Total Items",adjustMovements:"Try adjusting your filters or check back later.",inventoryMovements:"Inventory Movements",createdBy:"Created By",view:"View",enhanced:"Enhanced",legacy:"Legacy",addSingleMovement:"Add Single Movement",inStockSubtitle:"In stock",itemsBelowThreshold:"Items below threshold",inventoryWorth:"Inventory worth",quantity:"Quantity",units:"units",normal:"Normal",productsAndStock:"Products & Stock",lowStockItems:"Low Stock Items",totalStockValue:"Total Stock Value",warehousesAndStores:"Warehouses & stores",andMore:"...and {count} more",latestInventoryActivities:"Latest inventory activities",min:"Min",max:"Max",cost:"Cost",noProductsFound:"No products found matching your search.",noProductsAvailable:"No products available.",noLocationsFound:"No locations found matching your search.",noLocationsAvailable:"No locations available.",searchPlaceholder:"Search by product, location, reference, notes, invoice...",noMovementsFound:"No movements found",tryAdjustingFilters:"Try adjusting your filters or check back later.",transfers:"Transfers",adjustments:"Adjustments",bulk:"Bulk",product:"Product",store:"Store",supplier:"Supplier",warehouse:"Warehouse",movement:"Movement",editMovement:"Edit Movement",updateMovement:"Update Movement",movementInformation:"Movement Information",locationInformation:"Location Information",searchProductsImages:"Search products to view images...",searchForProducts:"Search for Products",startTypingToSearch:"Start typing to search and view product images",tryDifferentSearch:"Try a different search term"},employees:{title:"Employee Management",employeeList:"Employee List",addEmployee:"Add Employee",editEmployee:"Edit Employee",employeeDetails:"Employee Details",personalInfo:"Personal Information",employmentInfo:"Employment Information",payrollInfo:"Payroll Information",firstName:"First Name",lastName:"Last Name",fullName:"Full Name",email:"Email",phone:"Phone",address:"Address",dateOfBirth:"Date of Birth",employeeId:"Employee ID",department:"Department",position:"Position",hireDate:"Hire Date",employmentStatus:"Employment Status",salary:"Salary",payFrequency:"Pay Frequency",taxId:"Tax ID",bankAccount:"Bank Account",emergencyContact:"Emergency Contact",activeEmployees:"Active Employees",inactiveEmployees:"Inactive Employees",totalPayroll:"Total Payroll",searchEmployees:"Search employees...",enterFullName:"Enter employee's full name",enterPosition:"Enter job position",enterEmail:"Enter email address",enterPhone:"Enter phone number",enterSalary:"Enter annual salary",departments:{engineering:"Engineering",product:"Product",design:"Design",marketing:"Marketing",sales:"Sales",humanResources:"Human Resources",finance:"Finance",operations:"Operations",analytics:"Analytics"}},entryBooks:{title:"Entry Books",bookName:"Book Name",bookType:"Book Type",createBook:"Create Book",editBook:"Edit Book",salesBook:"Sales Book",purchaseBook:"Purchase Book",cashBook:"Cash Book",generalBook:"General Book",entries:"Entries",addEntry:"Add Entry",period:"Period",startDate:"Start Date",endDate:"End Date",bookBalance:"Book Balance",reconciledBalance:"Reconciled Balance",difference:"Difference",reconcile:"Reconcile",isReconciled:"Is Reconciled",noBooks:"No entry books found",createFirst:"Create your first entry book to get started",bookDetails:"Book Details",entriesCount:"entries",bookOverview:"Book overview and details",bookEntries:"Book Entries",allEntries:"All entries in this book",noEntries:"No entries found",addFirst:"Add your first entry to this book",entryDate:"Entry Date",entryDescription:"Entry Description",entryAmount:"Entry Amount",entryReference:"Entry Reference",subtitle:"Manage accounting entries and general ledger records",viewReconciliation:"View Reconciliation",totalEntries:"Total Entries",allJournalEntries:"All journal entries",postedEntriesOnly:"Posted entries only",fromPostedEntries:"From {count} posted entries",needBankReconciliation:"Need bank reconciliation",allReconciled:"All reconciled",sortBy:"Sort By",fromDate:"From Date",toDate:"To Date",order:"Order",newest:"Newest",oldest:"Oldest",resetFilters:"Reset Filters",activeFilters:"Active filters",from:"From",to:"To",entriesFound:"{count} entries found",noJournalEntries:"No Journal Entries",startByCreating:"Start by creating your first entry",noEntriesMatch:"No journal entries match your current filters.",createFirstEntry:"Create First Entry",void:"Void",confirmVoid:"Are you sure you want to void this journal entry?",entryBookRecords:"Entry Book Records"},banking:{title:"Bank Consolidation",bankAccount:"Bank Account",statementDate:"Statement Date",beginningBalance:"Beginning Balance",endingBalance:"Ending Balance",deposits:"Deposits",withdrawals:"Withdrawals",bankCharges:"Bank Charges",interest:"Interest",reconcile:"Reconcile",matched:"Matched",unmatched:"Unmatched",importStatement:"Import Statement",manualEntry:"Manual Entry",autoMatch:"Auto Match",clearAll:"Clear All",reconciliationStatus:"Reconciliation Status",difference:"Difference",bookBalance:"Book Balance",statementBalance:"Statement Balance",outstandingChecks:"Outstanding Checks",depositsInTransit:"Deposits in Transit",reconciled:"Reconciled",notReconciled:"Not Reconciled",unreconciled:"Unreconciled",reconciliation:"Reconciliation",compareStatements:"Compare bank statements with entry book records",importCSV:"Import CSV",startNewReconciliation:"Start New Reconciliation",bankAccountInfo:"Bank Account Info",currentAccountDetails:"Current account details",lastReconciled:"Last reconciled",bankTransactions:"Bank Transactions",selectedPeriod:"Selected period",pending:"pending",bookEntriesForComparison:"Book entries for comparison",reconciliationRate:"Reconciliation Rate",completionStatus:"Completion status",recentReconciliationSessions:"Recent Reconciliation Sessions",latestActivity:"Latest activity",noRecentSessions:"No recent reconciliation sessions found.",startFirstReconciliation:"Start First Reconciliation",entryBookRecords:"Entry Book Records",pleaseUploadCSV:"Please upload a CSV file",csvRequiresHeaderAndData:"CSV file must have at least a header and one data row",successfullyParsed:"Successfully parsed {count} rows",errorParsingCSV:"Error parsing CSV file. Please check the format.",dateDescriptionRequired:"Date and Description columns are required",importedTransaction:"Imported transaction",successfullyImported:"Successfully imported {count} bank transactions",errorImportingTransactions:"Error importing transactions. Please check your data.",importBankStatementCSV:"Import Bank Statement CSV",dropCSVHere:"Drop CSV file here",clickToUploadCSV:"Click to upload or drag and drop CSV file",supportedFormat:"Supported format: CSV with Date, Description, and Amount columns",mapCSVColumns:"Map CSV Columns",dateColumn:"Date Column",selectColumn:"Select column...",descriptionColumn:"Description Column",referenceColumn:"Reference Column",amountDebitColumn:"Amount/Debit Column",creditColumn:"Credit Column",balanceColumn:"Balance Column",andMoreRows:"... and {count} more rows",importing:"Importing...",importTransactions:"Import {count} Transactions",reconciliationComparison:"Reconciliation Comparison",bankStatements:"Bank Statements",totalTransactions:"Total transactions",totalEntries:"Total entries",unreconciledBank:"Unreconciled Bank",unreconciledBooks:"Unreconciled Books",needAttention:"Need attention",unreconcile:"Unreconcile",clickToReconcile:"Click to reconcile",potentialMatchesFound:"Potential Matches Found",clickRecordToReconcile:"Click on a record below to reconcile",exactMatch:"Exact Match",possibleMatch:"Possible Match",selected:"Selected",clearSelection:"Clear Selection"},journal:{title:"Journal Entries",entryNumber:"Entry Number",entryDate:"Entry Date",debit:"Debit",credit:"Credit",account:"Account",memo:"Memo",reference:"Reference",createEntry:"Create Entry",editEntry:"Edit Entry",deleteEntry:"Delete Entry",posted:"Posted",draft:"Draft",reversed:"Reversed",recurringEntry:"Recurring Entry",attachments:"Attachments",totalDebits:"Total Debits",totalCredits:"Total Credits",outOfBalance:"Out of Balance",balanced:"Balanced",addEntry:"Add Journal Entry",allEntries:"All Entries",totalDebit:"Total Debit",totalCredit:"Total Credit",debitShort:"Dr.",creditShort:"Cr.",noReference:"No reference",createdBy:"By",totalAmount:"Total Amount",lines:"Lines",entryNotBalancedShort:"Entry is not balanced",accountLines:"Account Lines",noDescription:"No description",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryLines:"Journal Entry Lines",addLine:"Add Line",lineDescription:"Line description",notBalanced:"Not Balanced",updateEntry:"Update Entry",saveAsDraft:"Save as Draft",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",editEntryTooltip:"Edit this journal entry",post:"Post",entryMustBeBalanced:"Entry must be balanced to post",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",journalLines:"Journal Lines",balanceStatus:"Balance Status",unbalanced:"Unbalanced",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",postEntry:"Post Entry",fixBalance:"Fix Balance",voidEntry:"Void Entry",draftEntry:"Draft Entry",draftEntryDescription:"This entry can be edited and posted.",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",postedEntry:"Posted Entry",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",minTwoLinesRequired:"At least 2 line items are required",entryNotBalanced:"Entry is not balanced. Debit: ${debit}, Credit: ${credit}",lineAccountRequired:"Line {lineNumber}: Account is required",lineAmountRequired:"Line {lineNumber}: Either debit or credit amount must be provided",lineBothAmounts:"Line {lineNumber}: Cannot have both debit and credit amounts",enterEntryDescription:"Enter journal entry description",enterReferenceNumber:"Enter reference number"},invoices:{title:"Invoice Dashboard",invoice:"Invoice",invoices:"Invoices",invoiceNumber:"Invoice Number",invoiceDetails:"Invoice Details",customerInformation:"Customer Information",customerName:"Customer Name",legalName:"Legal Name",contactInformation:"Contact Information",idPassport:"ID/Passport",phoneNumber:"Phone Number",altPhone:"Alt Phone",address:"Address",between:"Between",and:"and",products:"Products",reservations:"Reservations",services:"Services",unitPrice:"Unit Price",total:"Total",subtotal:"Subtotal",totalRevenue:"Total Revenue",totalProducts:"Total Products",totalReservations:"Total Reservations",aranceles:"Aranceles (Customs)",uniqueCustomers:"Unique Customers",averageInvoice:"Average Invoice",completed:"Completed",pending:"Pending",storesActive:"Stores Active",topProducts:"Top Products",mostSoldProducts:"Most sold products by quantity",reservationsByType:"Reservations by Type",distributionOfCategories:"Distribution of reservation categories",recentInvoices:"Recent Invoices",showingInvoices:"Showing {{count}} invoices",date:"Date",customer:"Customer",store:"Store",actions:"Actions",view:"View",status:"Status",printInvoice:"Print Invoice",exportPdf:"Export PDF",backToDashboard:"Back to Dashboard",fromInvoices:"From {{count}} invoices",value:"value",activeCustomers:"Active customers",perInvoiceValue:"Per invoice value",locations:"Locations",mostRecentActivity:"Most recent activity",storeLocation:"Store Location",allStores:"All Stores",fromDate:"From Date",toDate:"To Date",clearFilters:"Clear Filters",search:"Search",searchPlaceholder:"Search by invoice #, customer, store...",customsFees:"Total customs fees",salesType:"SALES",packagesOrder:"Packages Order",businessId:"Business ID",orderKey:"Order Key",reservationType:"Reservation Type",arancel:"Arancel",key:"Key",noInvoicesFound:"No invoices found",loadingInvoices:"Loading invoices...",errorLoadingInvoices:"Error loading invoices",refreshData:"Refresh Data",currentStockValue:"Current Stock Value",filterByStore:"Filter by store",filterByDate:"Filter by date range",totalCustomsFees:"Total customs fees",averageValue:"Average value",senderInformation:"Sender Information",receiptInformation:"Receipt Information",productsSubtotal:"Products Subtotal",reservationsSubtotal:"Reservations Subtotal",servicesSubtotal:"Services Subtotal",code:"Code",description:"Description",qty:"Qty",type:"Type",id:"ID",passport:"Passport",createNew:"Create New Invoice",totalOutstanding:"Total Outstanding",unpaidInvoices:"Unpaid invoices",thisMonth:"This Month",revenueCollected:"Revenue collected",overdue:"Overdue",pastDueInvoices:"Past due invoices",latestBillingActivity:"Latest billing activity",paid:"Paid"},forms:{requiredField:"This field is required",invalidEmail:"Invalid email address",invalidNumber:"Invalid number",invalidDate:"Invalid date",selectOption:"Please select an option",enterValue:"Please enter a value",confirmDelete:"Are you sure you want to delete this item?",unsavedChanges:"You have unsaved changes. Do you want to continue?",saveSuccess:"Saved successfully",saveError:"Error saving data",deleteSuccess:"Deleted successfully",deleteError:"Error deleting item",duplicateAccountNumber:"Account number already exists",descriptionRequired:"Description is required",errorOccurred:"An error occurred",errorPostingEntry:"An error occurred while posting the entry",referenceNumberRequired:"Reference number is required",locationRequired:"Location is required",fromLocationRequired:"From location is required for transfers",atLeastOneProduct:"At least one product is required",itemProductRequired:"Product is required for item {{index}}",itemQuantityRequired:"Quantity must be greater than 0 for item {{index}}"},modals:{addInventory:"Add Inventory Movement",bulkMovement:"Bulk Inventory Movement",addProduct:"Add New Product",addLocation:"Add New Location",inventoryDetail:"Inventory Item Details",quickAdd:"Quick Add",selectProduct:"Select Product",selectLocation:"Select Location",enterQuantity:"Enter quantity",enterCost:"Enter unit cost",enterReference:"Enter reference number",addNotes:"Add notes (optional)",generalInformation:"General Information",stockInformation:"Stock Information",locationInformation:"Location Information",movementInformation:"Movement Information",addToInventory:"Add to Inventory",createProduct:"Create Product",createLocation:"Create Location",processing:"Processing...",addingMovement:"Adding movement...",creatingProduct:"Creating product...",creatingLocation:"Creating location..."},products:{title:"Products",addNew:"Add New Product",totalProducts:"Total Products",inCatalog:"In catalog",activeProducts:"Active Products",currentlyAvailable:"Currently available",outOfStock:"Out of Stock",needsRestock:"Needs restock",productCatalog:"Product Catalog",manageYourProducts:"Manage your products and pricing",inStock:"In Stock",furniture:"Furniture",electronics:"Electronics",supplies:"Supplies",lighting:"Lighting",searchPlaceholder:"Search products by name, SKU, or category...",allCategories:"All Categories",clearFilters:"Clear filters",noResults:"No products found matching your criteria.",noProducts:"No products available.",showing:"Showing",filtered:"Filtered results",allProducts:"All products",searchResult:"Search Result",stock:"Stock",lowStock:"Low Stock"},unauthorized:{title:"Access Restricted",accessDenied:"Access Denied",noPermission:"You don't have permission to access",thisFeature:"this feature",whySeeing:"Why am I seeing this?",explanation:"Your account doesn't have the necessary permissions to view this content.",requiredPermission:"Required permission:",goToDashboard:"Go to Dashboard",goBack:"Go Back",featuresCanAccess:"Features you can access:",dashboardAccess:"Dashboard and overview statistics",profileAccess:"Your profile and settings",roleBasedAccess:"Features enabled for your role",needAccess:"Need access? Contact your administrator or manager to request the appropriate permissions.",permissions:{accountAccess:"Account Management Access",inventoryAccess:"Inventory Access",employeeAccess:"HR Access",bankingAccess:"Banking Access",journalAccess:"Journal Entry Access",adminAccess:"Administrative Access",financialReporting:"Financial Reporting Access",invoiceManagement:"Invoice Management Access",productManagement:"Product Management Access"}}},es:{common:{save:"Guardar",cancel:"Cancelar",delete:"Eliminar",edit:"Editar",add:"Agregar",close:"Cerrar",search:"Buscar",filter:"Filtrar",reset:"Restablecer",back:"Atrás",next:"Siguiente",previous:"Anterior",yes:"Sí",no:"No",loading:"Cargando...",error:"Error",success:"Éxito",warning:"Advertencia",info:"Información",confirm:"Confirmar",actions:"Acciones",status:"Estado",active:"Activo",inactive:"Inactivo",date:"Fecha",time:"Hora",description:"Descripción",notes:"Notas",amount:"Monto",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Idioma",english:"Inglés",spanish:"Español",noDataFound:"No se encontraron datos",required:"Requerido",optional:"Opcional",all:"Todos",none:"Ninguno",select:"Seleccionar",clear:"Limpiar",view:"Ver",suggested:"Sugerido",clearFilters:"Limpiar Filtros",enhanced:"Mejorado",legacy:"Clásico",email:"Correo Electrónico",phone:"Teléfono",address:"Dirección",name:"Nombre",code:"Código",category:"Categoría",type:"Tipo",quantity:"Cantidad",price:"Precio",cost:"Costo",value:"Valor",balance:"Saldo",created:"Creado",modified:"Modificado",details:"Detalles",summary:"Resumen",history:"Historial",new:"Nuevo",addNew:"Agregar Nuevo",unknown:"Desconocido",notAvailable:"N/A",remove:"Remover",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",from:"De",invoice:"Factura",invoices:"facturas",reference:"Referencia",createdBy:"Creado Por",units:"unidades",invoiceDocumentId:"ID de Factura/Documento",referenceNumber:"Número de Referencia",referenceNumberPlaceholder:"Ingrese número de referencia...",generalNotes:"Notas Generales",auto:"Auto",optionalNotes:"Notas opcionales...",showPerPage:"Mostrar por página",first:"Primera",last:"Última",store:"Tienda",orderId:"ID de Orden",tax:"Impuesto",paymentMethods:"Métodos de Pago",cash:"Efectivo",creditCard:"Tarjeta de Crédito",shipping:"Envío",air:"Aéreo",sea:"Marítimo",thankYouBusiness:"¡Gracias por su negocio!",thankForChoosingUs:"¡Gracias por elejirnos!",taxExemptNote:"Impuesto exento en pago en efectivo.",youSaved:"Usted ahorró",generatedOn:"Generado el",printSavePDF:"Imprimir / Guardar como PDF",pageOfPages:"Página {{current}} de {{total}}",showingXofY:"Mostrando {{start}}-{{end}} de {{total}}",page:"Página",of:"de",lbs:"libras"},navigation:{dashboard:"Panel de Control",accounts:"Plan de Cuentas",balanceSheet:"Balance General",inventory:"Inventario",employees:"Empleados",entryBooks:"Libros de Entrada",consolidate:"Consolidación Bancaria",reports:"Reportes",settings:"Configuración"},dashboard:{title:"Panel de Control",welcome:"Bienvenido a HRM Finance",totalRevenue:"Ingresos Totales",overview:"Resumen",recentActivity:"Actividad Reciente",quickActions:"Acciones Rápidas",employeeCount:"Número de Empleados",pendingInvoices:"Facturas Pendientes",cashBalance:"Saldo en Efectivo",totalAssets:"Activos Totales",totalLiabilities:"Pasivos Totales",totalExpenses:"Gastos Totales",netIncome:"Ingreso Neto",netLoss:"Pérdida Neta",monthlyPayroll:"Nómina Mensual",current:"Actual",newHires:"+3 nuevas contrataciones",outstanding:"Pendiente",totalOutstanding:"$23,450 total",lastUpdatedToday:"Última actualización hoy",commonTasks:"Tareas comunes",generateReport:"Generar Reporte",latestUpdates:"Últimas actualizaciones",invoicePaid:"Factura #1234 pagada",hoursAgo:"hace 2 horas",newEmployeeOnboarded:"Nuevo empleado incorporado",dayAgo:"hace 1 día",monthlyReportGenerated:"Reporte mensual generado",daysAgo:"hace 2 días"},accounts:{title:"Plan de Cuentas",accountNumber:"Número de Cuenta",accountName:"Nombre de Cuenta",accountType:"Tipo de Cuenta",category:"Categoría",balance:"Saldo",parentAccount:"Cuenta Padre",subAccounts:"Subcuentas",addAccount:"Agregar Cuenta",editAccount:"Editar Cuenta",deleteAccount:"Eliminar Cuenta",accountDetails:"Detalles de Cuenta",transactions:"Transacciones",accountHistory:"Historial de Cuenta",backToAccounts:"Volver a Cuentas",accountNotFound:"Cuenta no encontrada",accountInformation:"Información de Cuenta",accountPurpose:"Propósito de la cuenta",transactionHistory:"Historial de Transacciones",noTransactions:"No se encontraron transacciones para esta cuenta",createdDate:"Fecha de Creación",lastModified:"Última Modificación",noDescription:"No se proporcionó descripción.",totalCount:"Conteo total",basicDetails:"Detalles básicos",currentBalance:"Saldo actual",classification:"Clasificación",allTransactions:"Todas las transacciones de la cuenta",reference:"Referencia",types:{asset:"Activo",liability:"Pasivo",equity:"Patrimonio",revenue:"Ingreso",expense:"Gasto"},categories:{currentAssets:"Activos Corrientes",fixedAssets:"Activos Fijos",currentLiabilities:"Pasivos Corrientes",longTermLiabilities:"Pasivos a Largo Plazo",ownersEquity:"Patrimonio del Propietario",operatingRevenue:"Ingresos Operacionales",operatingExpenses:"Gastos Operacionales"}},inventory:{title:"Gestión de Inventario",overview:"Resumen",products:"Productos y Stock",movements:"Movimientos",locations:"Ubicaciones",bulkMovement:"Movimiento Masivo",addMovement:"Agregar Movimiento",addProduct:"Agregar Producto",addLocation:"Agregar Ubicación",singleMovement:"Agregar Movimiento Individual",addNewItem:"Agregar Nuevo Artículo",activeProducts:"Productos Activos",lowStockAlert:"Artículos con Stock Bajo",totalValue:"Valor Total del Stock",activeLocations:"Ubicaciones Activas",productsNeedRestocking:"productos necesitan reabastecimiento",recentMovements:"Movimientos Recientes",noProducts:"No hay productos en esta ubicación",productName:"Nombre del Producto",productCode:"Código del Producto",sku:"SKU",category:"Categoria",unitOfMeasure:"Unidad de Medida",unitCost:"Costo Unitario",minStockLevel:"Nivel Mínimo de Stock",maxStockLevel:"Nivel Máximo de Stock",locationName:"Nombre de Ubicación",locationType:"Tipo de Ubicación",locationCode:"Código de Ubicación",movementType:"Tipo de Movimiento",referenceNumber:"Número de Referencia",invoiceNumber:"Número de Factura",fromLocation:"Desde Ubicación",toLocation:"Hacia Ubicación",stockIn:"Entrada de Stock",stockOut:"Salida de Stock",transfer:"Transferencia",adjustment:"Ajuste",inStock:"En Stock",lowStock:"Stock Bajo",outOfStock:"Sin Stock",stockLevels:"Niveles de Stock",stockByLocation:"Stock por Ubicación",searchProducts:"Buscar productos...",searchLocations:"Buscar ubicaciones...",noMovements:"No se encontraron movimientos",productDetails:"Detalles del Producto",locationDetails:"Detalles de Ubicación",movementDetails:"Detalles del Movimiento",totalProducts:"Total de Productos",totalLocations:"Total de Ubicaciones",lastSeen:"Visto por última vez",warehouseType:"Almacén",storeType:"Tienda",supplierType:"Proveedor",customerType:"Cliente",currentlyManaged:"Gestionados actualmente",needAttention:"Necesitan atención",currentWorth:"Valor actual",warehousesStores:"Almacenes y tiendas",thisMonth:"Este Mes",latestActivities:"Últimas actividades de inventario",searchMovements:"Buscar Movimientos",countingSheet:"Hoja de Conteo",physicalCount:"Conteo Físico",physicalInventoryCount:"Conteo Físico de Inventario",setupPhysicalCount:"Configurar Conteo Físico de Inventario",setupDescription:"Configure los ajustes de su conteo físico de inventario y comience el proceso de conteo.",countWillInclude:"Este conteo incluirá {{count}} productos de {{location}} en la categoría {{category}}.",startCounting:"Iniciar Conteo Físico",counted:"Contado",remaining:"Restante",variances:"Variaciones",complete:"Completo",systemQty:"Cant. Sistema",variance:"Variación",addNotes:"Agregar notas...",reviewAndConfirm:"Revisar y Confirmar Ajustes",reviewDescription:"Revise los ajustes de inventario a continuación y confirme para actualizar su sistema.",stockIncreases:"Aumentos de Stock",stockDecreases:"Disminuciones de Stock",totalAdjustments:"Ajustes Totales",confirmAdjustments:"Confirmar Ajustes",perfectCount:"¡Conteo Perfecto!",noVariances:"No se encontraron variaciones. Su conteo físico coincide exactamente con el sistema.",physicalCountAdjustment:"Ajuste de conteo físico",inventoryCountingSheetTitle:"HOJA DE CONTEO DE INVENTARIO",location:"Ubicación",allCategories:"Todas las Categorías",countedBy:"Contado por",verifiedBy:"Verificado por",instructions:"Instrucciones",countInstructions:["Contar todos los artículos físicamente presentes en esta ubicación",'Escribir el conteo real en la columna "Conteo Físico"',"Dejar en blanco si el artículo no se encuentra",'Anotar cualquier discrepancia en la columna "Notas"',"Firmar y fechar cuando esté completo"],unit:"Unidad",totalProductsListed:"Total de Productos Listados",itemsCounted:"Artículos Contados",summaryFor:"RESUMEN PARA",discrepanciesFound:"Discrepancias Encontradas",counterSignature:"Firma del Contador",supervisorSignature:"Firma del Supervisor",downloadCSV:"Descargar CSV",noAdjustmentsToDownload:"No hay ajustes para descargar",stockIncrease:"Aumento de Stock",stockDecrease:"Disminución de Stock",purchaseReceive:"Compra/Recepción",saleIssue:"Venta/Emisión",generalNotesPlaceholder:"Ingrese notas generales para este movimiento...",sortBy:"Ordenar Por",allLocations:"Todas las Ubicaciones",searchByProduct:"Buscar por producto, ubicación, referencia, notas, factura...",allProducts:"Todos los Productos",bulkMovementReport:"Reporte de Movimiento en Lote",totalQuantity:"Cantidad Total",estimatedValue:"Valor Estimado",viewHistoricalReports:"Ver Reportes Históricos",noBulkReportsFound:"No se encontraron reportes de movimientos en lote",bulkReportsAppearHere:"Los reportes de movimientos en lote aparecerán aquí después de crear movimientos en lote",allTypes:"Todos los Tipos",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",totalMovements:"Movimientos Totales",adjustMovements:"Intenta ajustar tus filtros o revisa más tarde.",inventoryMovements:"Movimientos de Inventario",createdBy:"Creado Por",view:"Ver",enhanced:"Mejorado",legacy:"Clásico",addSingleMovement:"Agregar Movimiento Individual",inStockSubtitle:"En stock",itemsBelowThreshold:"Artículos bajo el umbral",inventoryWorth:"Valor del inventario",quantity:"Cantidad",units:"unidades",normal:"Normal",productsAndStock:"Productos y Stock",lowStockItems:"Artículos con Stock Bajo",totalStockValue:"Valor Total del Stock",warehousesAndStores:"Almacenes y tiendas",andMore:"...y {count} más",latestInventoryActivities:"Últimas actividades de inventario",min:"Mín",max:"Máx",cost:"Costo",noProductsFound:"No se encontraron productos que coincidan con su búsqueda.",noProductsAvailable:"No hay productos disponibles.",noLocationsFound:"No se encontraron ubicaciones que coincidan con su búsqueda.",noLocationsAvailable:"No hay ubicaciones disponibles.",searchPlaceholder:"Buscar por producto, ubicación, referencia, notas, factura...",noMovementsFound:"No se encontraron movimientos",tryAdjustingFilters:"Intenta ajustar tus filtros o revisa más tarde.",transfers:"Transferencias",adjustments:"Ajustes",bulk:"Masivo",product:"Producto",store:"Tienda",supplier:"Proveedor",warehouse:"Almacén",movement:"Movimiento",editMovement:"Editar Movimiento",updateMovement:"Actualizar Movimiento",movementInformation:"Información del Movimiento",locationInformation:"Información de Ubicación",searchProductsImages:"Buscar productos para ver imágenes...",searchForProducts:"Buscar Productos",startTypingToSearch:"Comienza a escribir para buscar y ver imágenes de productos",tryDifferentSearch:"Prueba con un término de búsqueda diferente"},employees:{title:"Gestión de Empleados",employeeList:"Lista de Empleados",addEmployee:"Agregar Empleado",editEmployee:"Editar Empleado",employeeDetails:"Detalles del Empleado",personalInfo:"Información Personal",employmentInfo:"Información Laboral",payrollInfo:"Información de Nómina",firstName:"Nombre",lastName:"Apellido",fullName:"Nombre Completo",email:"Correo Electrónico",phone:"Teléfono",address:"Dirección",dateOfBirth:"Fecha de Nacimiento",employeeId:"ID de Empleado",department:"Departamento",position:"Puesto",hireDate:"Fecha de Contratación",employmentStatus:"Estado Laboral",salary:"Salario",payFrequency:"Frecuencia de Pago",taxId:"ID Fiscal",bankAccount:"Cuenta Bancaria",emergencyContact:"Contacto de Emergencia",activeEmployees:"Empleados Activos",inactiveEmployees:"Empleados Inactivos",totalPayroll:"Nómina Total",searchEmployees:"Buscar empleados...",enterFullName:"Ingrese el nombre completo del empleado",enterPosition:"Ingrese el puesto de trabajo",enterEmail:"Ingrese la dirección de correo electrónico",enterPhone:"Ingrese el número de teléfono",enterSalary:"Ingrese el salario anual",departments:{engineering:"Ingeniería",product:"Producto",design:"Diseño",marketing:"Marketing",sales:"Ventas",humanResources:"Recursos Humanos",finance:"Finanzas",operations:"Operaciones",analytics:"Analítica"}},entryBooks:{title:"Libros de Entrada",bookName:"Nombre del Libro",bookType:"Tipo de Libro",createBook:"Crear Libro",editBook:"Editar Libro",salesBook:"Libro de Ventas",purchaseBook:"Libro de Compras",cashBook:"Libro de Caja",generalBook:"Libro General",entries:"Entradas",addEntry:"Agregar Entrada",period:"Período",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",bookBalance:"Saldo del Libro",reconciledBalance:"Saldo Conciliado",difference:"Diferencia",reconcile:"Conciliar",isReconciled:"Está Conciliado",noBooks:"No se encontraron libros de entrada",createFirst:"Crea tu primer libro de entrada para comenzar",bookDetails:"Detalles del Libro",entriesCount:"entradas",bookOverview:"Resumen y detalles del libro",bookEntries:"Entradas del Libro",allEntries:"Todas las entradas en este libro",noEntries:"No se encontraron entradas",addFirst:"Agrega tu primera entrada a este libro",entryDate:"Fecha de Entrada",entryDescription:"Descripción de Entrada",entryAmount:"Monto de Entrada",entryReference:"Referencia de Entrada"},banking:{title:"Consolidación Bancaria",bankAccount:"Cuenta Bancaria",statementDate:"Fecha del Estado",beginningBalance:"Saldo Inicial",endingBalance:"Saldo Final",deposits:"Depósitos",withdrawals:"Retiros",bankCharges:"Cargos Bancarios",interest:"Intereses",reconcile:"Conciliar",matched:"Conciliado",unmatched:"No Conciliado",importStatement:"Importar Estado",manualEntry:"Entrada Manual",autoMatch:"Coincidencia Automática",clearAll:"Limpiar Todo",reconciliationStatus:"Estado de Conciliación",difference:"Diferencia",bookBalance:"Saldo en Libros",statementBalance:"Saldo del Estado",outstandingChecks:"Cheques Pendientes",depositsInTransit:"Depósitos en Tránsito",reconciled:"Conciliado",notReconciled:"No Conciliado",unreconciled:"No Conciliado",reconciliation:"Conciliación",compareStatements:"Comparar estados bancarios con registros de libros de entrada",importCSV:"Importar CSV",startNewReconciliation:"Iniciar Nueva Conciliación",bankAccountInfo:"Información de Cuenta Bancaria",currentAccountDetails:"Detalles de cuenta actual",lastReconciled:"Última conciliación",bankTransactions:"Transacciones Bancarias",selectedPeriod:"Período seleccionado",pending:"pendiente",bookEntriesForComparison:"Entradas de libros para comparación",reconciliationRate:"Tasa de Conciliación",completionStatus:"Estado de finalización",recentReconciliationSessions:"Sesiones de Conciliación Recientes",latestActivity:"Actividad reciente",noRecentSessions:"No se encontraron sesiones de conciliación recientes.",startFirstReconciliation:"Iniciar Primera Conciliación",entryBookRecords:"Registros de Libros de Entrada",pleaseUploadCSV:"Por favor suba un archivo CSV",csvRequiresHeaderAndData:"El archivo CSV debe tener al menos un encabezado y una fila de datos",successfullyParsed:"Se analizaron exitosamente {count} filas",errorParsingCSV:"Error al analizar el archivo CSV. Verifique el formato.",dateDescriptionRequired:"Las columnas de Fecha y Descripción son requeridas",importedTransaction:"Transacción importada",successfullyImported:"Se importaron exitosamente {count} transacciones bancarias",errorImportingTransactions:"Error al importar transacciones. Verifique sus datos.",importBankStatementCSV:"Importar CSV de Estado Bancario",dropCSVHere:"Suelte el archivo CSV aquí",clickToUploadCSV:"Haga clic para cargar o arrastre y suelte el archivo CSV",supportedFormat:"Formato soportado: CSV con columnas de Fecha, Descripción y Monto",mapCSVColumns:"Mapear Columnas CSV",dateColumn:"Columna de Fecha",selectColumn:"Seleccionar columna...",descriptionColumn:"Columna de Descripción",referenceColumn:"Columna de Referencia",amountDebitColumn:"Columna de Monto/Débito",creditColumn:"Columna de Crédito",balanceColumn:"Columna de Saldo",andMoreRows:"... y {count} filas más",importing:"Importando...",importTransactions:"Importar {count} Transacciones",reconciliationComparison:"Comparación de Conciliación",bankStatements:"Estados Bancarios",totalTransactions:"Transacciones totales",totalEntries:"Entradas totales",unreconciledBank:"Banco No Conciliado",unreconciledBooks:"Libros No Conciliados",needAttention:"Necesitan atención",unreconcile:"Desconciliar",clickToReconcile:"Hacer clic para conciliar",potentialMatchesFound:"Coincidencias Potenciales Encontradas",clickRecordToReconcile:"Haga clic en un registro a continuación para conciliar",exactMatch:"Coincidencia Exacta",possibleMatch:"Posible Coincidencia",selected:"Seleccionado",clearSelection:"Limpiar Selección"},journal:{title:"Asientos Contables",entryNumber:"Número de Asiento",entryDate:"Fecha del Asiento",debit:"Débito",credit:"Crédito",account:"Cuenta",memo:"Memo",reference:"Referencia",createEntry:"Crear Asiento",editEntry:"Editar Asiento",deleteEntry:"Eliminar Asiento",posted:"Registrado",draft:"Borrador",reversed:"Revertido",recurringEntry:"Asiento Recurrente",attachments:"Adjuntos",totalDebits:"Débitos Totales",totalCredits:"Créditos Totales",outOfBalance:"Desbalanceado",balanced:"Balanceado"},forms:{requiredField:"Este campo es requerido",invalidEmail:"Dirección de correo inválida",invalidNumber:"Número inválido",invalidDate:"Fecha inválida",selectOption:"Por favor seleccione una opción",enterValue:"Por favor ingrese un valor",confirmDelete:"¿Está seguro de que desea eliminar este elemento?",unsavedChanges:"Tiene cambios sin guardar. ¿Desea continuar?",saveSuccess:"Guardado exitosamente",saveError:"Error al guardar datos",deleteSuccess:"Eliminado exitosamente",deleteError:"Error al eliminar elemento",duplicateAccountNumber:"El número de cuenta ya existe",referenceNumberRequired:"El número de referencia es requerido",locationRequired:"La ubicación es requerida",fromLocationRequired:"La ubicación de origen es requerida para transferencias",atLeastOneProduct:"Al menos un producto es requerido",itemProductRequired:"El producto es requerido para el artículo {{index}}",itemQuantityRequired:"La cantidad debe ser mayor que 0 para el artículo {{index}}"},modals:{addInventory:"Agregar Movimiento de Inventario",bulkMovement:"Movimiento Masivo de Inventario",addProduct:"Agregar Nuevo Producto",addLocation:"Agregar Nueva Ubicación",inventoryDetail:"Detalles del Artículo de Inventario",quickAdd:"Agregar Rápido",selectProduct:"Seleccionar Producto",selectLocation:"Seleccionar Ubicación",enterQuantity:"Ingresar cantidad",enterCost:"Ingresar costo unitario",enterReference:"Ingresar número de referencia",addNotes:"Agregar notas (opcional)",generalInformation:"Información General",stockInformation:"Información de Stock",locationInformation:"Información de Ubicación",movementInformation:"Información de Movimiento",addToInventory:"Agregar al Inventario",createProduct:"Crear Producto",createLocation:"Crear Ubicación",processing:"Procesando...",addingMovement:"Agregando movimiento...",creatingProduct:"Creando producto...",creatingLocation:"Creando ubicación..."},products:{title:"Productos",addNew:"Agregar Nuevo Producto",totalProducts:"Total de Productos",inCatalog:"En catálogo",activeProducts:"Productos Activos",currentlyAvailable:"Actualmente disponibles",outOfStock:"Sin Stock",needsRestock:"Necesita reabastecimiento",productCatalog:"Catálogo de Productos",manageYourProducts:"Gestiona tus productos y precios",inStock:"En Stock",furniture:"Muebles",electronics:"Electrónicos",supplies:"Suministros",lighting:"Iluminación"},invoices:{title:"Panel de Facturas",invoice:"Factura",invoices:"Facturas",invoiceNumber:"Número de Factura",invoiceDetails:"Detalles de Factura",customerInformation:"Información del Cliente",customerName:"Nombre del Cliente",legalName:"Nombre Legal",contactInformation:"Información de Contacto",idPassport:"ID/Pasaporte",phoneNumber:"Número de Teléfono",altPhone:"Teléfono Alt.",address:"Dirección",between:"Entre",and:"y",products:"Productos",reservations:"Reservaciones",services:"Servicios",unitPrice:"Precio Unitario",total:"Total",subtotal:"Subtotal",category:"Categoria",totalRevenue:"Ingresos Totales",totalProducts:"Total de Productos",totalReservations:"Total de Reservaciones",aranceles:"Aranceles (Aduanas)",uniqueCustomers:"Clientes Únicos",averageInvoice:"Factura Promedio",completed:"Completada",pending:"Pendiente",storesActive:"Tiendas Activas",topProducts:"Productos Principales",mostSoldProducts:"Productos más vendidos por cantidad",reservationsByType:"Reservaciones por Tipo",distributionOfCategories:"Distribución de categorías de reservaciones",recentInvoices:"Facturas Recientes",showingInvoices:"Mostrando {{count}} facturas",date:"Fecha",customer:"Cliente",store:"Tienda",actions:"Acciones",view:"Ver",status:"Estado",printInvoice:"Imprimir Factura",exportPdf:"Exportar PDF",backToDashboard:"Volver al Panel",fromInvoices:"De {{count}} facturas",value:"valor",activeCustomers:"Clientes activos",perInvoiceValue:"Valor por factura",locations:"Ubicaciones",mostRecentActivity:"Actividad más reciente",storeLocation:"Ubicación de Tienda",allStores:"Todas las Tiendas",fromDate:"Fecha Desde",toDate:"Fecha Hasta",clearFilters:"Limpiar Filtros",search:"Buscar",searchPlaceholder:"Buscar por # factura, cliente, tienda...",customsFees:"Aranceles totales",salesType:"VENTAS",packagesOrder:"Orden de Paquetes",businessId:"ID de Negocio",orderKey:"Clave de Orden",reservationType:"Tipo de Reservación",arancel:"Arancel",key:"Clave",noInvoicesFound:"No se encontraron facturas",loadingInvoices:"Cargando facturas...",errorLoadingInvoices:"Error al cargar facturas",refreshData:"Actualizar Datos",currentStockValue:"Valor de Stock Actual",filterByStore:"Filtrar por tienda",filterByDate:"Filtrar por rango de fechas",totalCustomsFees:"Aranceles totales",averageValue:"Valor promedio",senderInformation:"Información del Remitente",receiptInformation:"Información del Destinatario",productsSubtotal:"Subtotal de Productos",reservationsSubtotal:"Subtotal de Reservaciones",servicesSubtotal:"Subtotal de Servicios",code:"Código",description:"Descripción",qty:"Cant.",type:"Tipo",id:"ID",passport:"Pasaporte"},unauthorized:{title:"Acceso Restringido",accessDenied:"Acceso Denegado",noPermission:"No tienes permisos para acceder a",thisFeature:"esta funcionalidad",whySeeing:"¿Por qué veo esto?",explanation:"Tu cuenta no tiene los permisos necesarios para ver este contenido.",requiredPermission:"Permiso requerido:",goToDashboard:"Ir al Panel de Control",goBack:"Regresar",featuresCanAccess:"Funcionalidades a las que puedes acceder:",dashboardAccess:"Panel de control y estadísticas generales",profileAccess:"Tu perfil y configuraciones",roleBasedAccess:"Funcionalidades habilitadas para tu rol",needAccess:"¿Necesitas acceso? Contacta a tu administrador o gerente para solicitar los permisos apropiados.",permissions:{accountAccess:"Acceso a Gestión de Cuentas",inventoryAccess:"Acceso a Inventario",employeeAccess:"Acceso a Recursos Humanos",bankingAccess:"Acceso Bancario",journalAccess:"Acceso a Asientos Contables",adminAccess:"Acceso Administrativo",financialReporting:"Acceso a Reportes Financieros",invoiceManagement:"Acceso a Gestión de Facturas",productManagement:"Acceso a Gestión de Productos"}}}},r$=()=>{if(typeof window<"u"){const t=localStorage.getItem("hrmfinance-language");if(t&&["en","es"].includes(t))return t}return"en"},[rf,n$]=Ce(r$()),or=()=>({t:(n,i,o)=>{const s=rf(),l=n.split(".");let c=t$[s];for(const h of l)if(c&&typeof c=="object"&&h in c)c=c[h];else return i||n;let u=typeof c=="string"?c:i||n;return o&&typeof u=="string"&&Object.keys(o).forEach(h=>{const y=o[h],g=`{{${h}}}`;u=u.replace(new RegExp(g,"g"),String(y))}),u},language:()=>rf(),setLanguage:n=>{n$(n),typeof window<"u"&&localStorage.setItem("hrmfinance-language",n)},currentLanguage:rf});var i$=he("<div><label></label><select><option value>"),o$=he("<span>*"),s$=he("<option>");const Pn=t=>{const{t:e}=or(),r={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},n={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},i={"margin-bottom":"1rem"};return(()=>{var o=i$(),s=o.firstChild,l=s.nextSibling,c=l.firstChild;return m(o,i),m(s,r),a(s,()=>t.label,null),a(s,(()=>{var u=Ee(()=>!!t.required);return()=>u()&&(()=>{var h=o$();return h.style.setProperty("color","var(--primary-color)"),h})()})(),null),l.addEventListener("blur",u=>u.target.style.borderColor="var(--border-color)"),l.addEventListener("focus",u=>u.target.style.borderColor="var(--primary-color)"),l.addEventListener("change",u=>t.onChange(u.target.value)),m(l,n),a(c,()=>e("forms.selectOption")),a(l,()=>t.options.map(u=>(()=>{var h=s$();return a(h,()=>u.label),Se(()=>h.value=u.value),h})()),null),Se(u=>{var h=t.required,y=t.disabled;return h!==u.e&&(l.required=u.e=h),y!==u.t&&(l.disabled=u.t=y),u},{e:void 0,t:void 0}),Se(()=>l.value=t.value),o})()};var a$=he("<main><div>"),l$=he("<header><h1>");const to=t=>{const e={"min-height":"100vh",background:"var(--background-color)"},r={"max-width":"1200px",margin:"0 auto",padding:"2rem"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},i={"font-size":"2rem","font-weight":"700",color:"var(--text-primary)",margin:"0"};return(()=>{var o=a$(),s=o.firstChild;return m(o,e),m(s,r),a(s,(()=>{var l=Ee(()=>!!t.title);return()=>l()&&(()=>{var c=l$(),u=c.firstChild;return m(c,n),m(u,i),a(u,()=>t.title),c})()})(),null),a(s,()=>t.children,null),o})()};var c$=he("<div><span></span><select><option value=en>🇺🇸 </option><option value=es>🇪🇸 ");const u$=()=>{const{t,language:e,setLanguage:r}=or(),n={display:"flex","align-items":"center",gap:"0.5rem","margin-left":"auto"},i={padding:"0.5rem 1rem","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",background:"var(--surface-color)",color:"var(--text-primary)",cursor:"pointer","font-size":"0.875rem","font-weight":"500",transition:"all 0.2s ease","min-width":"120px"},o={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},s=l=>{const c=l.target;r(c.value)};return(()=>{var l=c$(),c=l.firstChild,u=c.nextSibling,h=u.firstChild;h.firstChild;var y=h.nextSibling;return y.firstChild,m(l,n),m(c,o),u.addEventListener("change",s),m(u,i),a(h,()=>t("common.english"),null),a(y,()=>t("common.spanish"),null),Se(()=>u.value=e()),l})()};var c0=he('<img alt="User avatar">'),d$=he("<div class=user-info-desktop><span>"),h$=he("<button class=sign-out-desktop>Sign Out"),p$=he("<div><div><span></span></div><button>Sign Out"),f$=he(`<nav><div><div class=desktop-nav></div><div><button class=mobile-menu-button><svg width=24 height=24 viewBox="0 0 24 24"fill=currentColor><path></path></svg></button></div></div><div class=mobile-nav></div><style>
        .nav-active {
          background: linear-gradient(135deg, var(--primary-color), var(--primary-dark)) !important;
          color: white !important;
          box-shadow: var(--shadow-sm);
        }
        
        .desktop-nav a:hover:not(.nav-active),
        .nav-group button:hover {
          background: var(--background-color);
          color: var(--text-primary);
        }
        
        .mobile-nav a:hover:not(.nav-active) {
          background: var(--background-color);
          color: var(--text-primary);
        }

        /* Create invisible bridge to prevent gap issues */
        .nav-group::before {
          content: '';
          position: absolute;
          top: 100%;
          left: 0;
          right: 0;
          height: 0.5rem;
          z-index: 9;
        }
        
        @media (max-width: 768px) {
          .desktop-nav {
            display: none !important;
          }
          
          .mobile-menu-button {
            display: block !important;
          }
          
          .user-info-desktop,
          .sign-out-desktop {
            display: none !important;
          }
          
          nav > div:first-child {
            padding: 1rem;
          }
        }
        
        @media (min-width: 769px) {
          .mobile-nav {
            display: none !important;
          }
        }
      `),m$=he("<div class=nav-group><button> <span>▼</span></button><div>"),y$=he("<div>"),g$=he("<div><div><span> </span><span>▼");const v$=()=>{const{t}=or(),[e,r]=Ce(!1),[n,i]=Ce(null),[o,s]=Ce(null),l={background:"var(--surface-color)","border-bottom":"1px solid var(--border-color)","box-shadow":"var(--shadow-sm)","backdrop-filter":"blur(10px)",position:"sticky",top:"0","z-index":"100"},c={display:"flex","align-items":"center","justify-content":"space-between",padding:"1rem 2rem",margin:"0 auto",position:"relative"},u={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","text-decoration":"none"},h={display:"flex",gap:"1rem","align-items":"center",flex:"1","margin-left":"2rem"},y={display:"none",position:"absolute",top:"100%",left:"0",right:"0",background:"var(--surface-color)","border-top":"1px solid var(--border-color)","box-shadow":"var(--shadow-md)","max-height":"70vh","overflow-y":"auto"},g={position:"relative",display:"flex","align-items":"center"},f={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem",background:"transparent",border:"none",color:"var(--text-secondary)","font-weight":"500","font-size":"0.875rem",cursor:"pointer","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease","white-space":"nowrap"},x={position:"absolute",top:"100%",left:"0",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)","min-width":"200px","margin-top":"0.25rem","z-index":"10",display:"none","padding-top":"0.25rem"},S={"border-bottom":"1px solid var(--border-color)"},w={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",cursor:"pointer","font-weight":"600",color:"var(--text-primary)"},E={display:"block","text-decoration":"none",color:"var(--text-secondary)",padding:"0.75rem 1rem","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease","white-space":"nowrap"},q={...E,padding:"0.75rem 1.5rem","border-bottom":"1px solid var(--border-light)"},ee={display:"none",background:"transparent",border:"none",padding:"0.5rem",cursor:"pointer",color:"var(--text-primary)"},W={display:"flex","align-items":"center",gap:"1rem"},K={display:"flex","align-items":"center",gap:"0.75rem",padding:"0.5rem 1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",color:"var(--text-primary)"},te={width:"32px",height:"32px","border-radius":"50%","object-fit":"cover"},$={...E,cursor:"pointer",border:"1px solid var(--border-color)",background:"transparent","border-radius":"var(--border-radius-sm)"},C=()=>{pr.signOut()},T=k=>{const F=pr.state?.profile;return F?F[k]===!0||F.isAdmin===!0:!1},O=()=>{r(!e())},b=k=>{i(n()===k?null:k)},P=k=>{const F=o();F&&(clearTimeout(F),s(null)),i(k)},_=()=>{const k=setTimeout(()=>{i(null)},300);s(k)},z=[{name:"Finance",icon:"💰",items:[{path:"/accounts",label:t("navigation.accounts"),permission:"AccountAccess",icon:"📊"},{path:"/entry-books",label:t("navigation.entryBooks"),permission:"JournalAccess",icon:"📚"},{path:"/balance-sheet",label:t("navigation.balanceSheet"),permission:"AccountAccess",icon:"📈"},{path:"/bank-consolidations",label:t("navigation.consolidate"),permission:"BankingAccess",icon:"🏦"}]},{name:"Operations",icon:"📦",items:[{path:"/inventory",label:t("navigation.inventory"),permission:"InventoryAccess",icon:"📦"},{path:"/invoices",label:t("invoices.invoices"),permission:"invoiceAccess",icon:"📚"},{path:"/hbl",label:t("navigation.hbl"),permission:"HBLAccess",icon:"🚢"}]},{name:"Management",icon:"👥",items:[{path:"/employees",label:t("navigation.employees"),permission:"EmployeeAccess",icon:"👷"},{path:"/admin/users",label:"Admin",permission:"isAdmin",icon:"👑",adminOnly:!0}]}],Z=()=>z.map(k=>({...k,items:k.items.filter(F=>F.adminOnly?pr.state?.profile?.isAdmin:T(F.permission))})).filter(k=>k.items.length>0);return(()=>{var k=f$(),F=k.firstChild,X=F.firstChild,U=X.nextSibling,B=U.firstChild,ce=B.firstChild,L=ce.firstChild,D=F.nextSibling;return a(F,R(sc,{href:"/",style:u,children:"HRM Finance"}),X),m(X,h),a(X,R(sc,{href:"/",style:E,activeClass:"nav-active",get children(){return["🏠 ",Ee(()=>t("navigation.dashboard"))]}}),null),a(X,R(Ut,{get each(){return Z()},children:j=>(()=>{var I=m$(),M=I.firstChild,J=M.firstChild,H=J.nextSibling,Q=M.nextSibling;return I.addEventListener("mouseleave",_),I.addEventListener("mouseenter",()=>P(j.name)),a(M,()=>j.icon,J),a(M,()=>j.name,H),H.style.setProperty("font-size","0.75rem"),Q.addEventListener("mouseleave",_),Q.addEventListener("mouseenter",()=>P(j.name)),a(Q,R(Ut,{get each(){return j.items},children:se=>R(sc,{get href(){return se.path},style:E,activeClass:"nav-active",onClick:()=>i(null),get children(){return[Ee(()=>se.icon)," ",Ee(()=>se.label)]}})})),Se(se=>{var G=g,re=f,oe={...x,display:n()===j.name?"block":"none"};return se.e=m(I,G,se.e),se.t=m(M,re,se.t),se.a=m(Q,oe,se.a),se},{e:void 0,t:void 0,a:void 0}),I})()}),null),m(U,W),a(U,R(u$,{}),B),a(U,R(ze,{get when(){return pr.currentUser},get children(){return[(()=>{var j=d$(),I=j.firstChild;return a(j,R(ze,{get when(){return pr.currentUser?.photoURL},get children(){var M=c0();return Se(J=>{var H=pr.currentUser.photoURL,Q=te;return H!==J.e&&tr(M,"src",J.e=H),J.t=m(M,Q,J.t),J},{e:void 0,t:void 0}),M}}),I),a(I,()=>pr.currentUser?.displayName||pr.currentUser?.email),Se(M=>m(j,K,M)),j})(),(()=>{var j=h$();return j.addEventListener("mouseleave",I=>{I.currentTarget.style.background="transparent",I.currentTarget.style.color="var(--text-secondary)"}),j.addEventListener("mouseenter",I=>{I.currentTarget.style.background="var(--background-color)",I.currentTarget.style.color="var(--text-primary)"}),j.$$click=C,Se(I=>m(j,$,I)),j})()]}}),B),B.$$click=O,m(B,ee),a(D,R(sc,{href:"/",style:q,activeClass:"nav-active",onClick:()=>r(!1),get children(){return["🏠 ",Ee(()=>t("navigation.dashboard"))]}}),null),a(D,R(Ut,{get each(){return Z()},children:j=>(()=>{var I=g$(),M=I.firstChild,J=M.firstChild,H=J.firstChild,Q=J.nextSibling;return m(I,S),M.$$click=()=>b(j.name),m(M,w),a(J,()=>j.icon,H),a(J,()=>j.name,null),Q.style.setProperty("transition","transform 0.2s"),a(I,R(ze,{get when(){return n()===j.name},get children(){var se=y$();return se.style.setProperty("background","var(--background-color)"),a(se,R(Ut,{get each(){return j.items},children:G=>R(sc,{get href(){return G.path},get style(){return{...q,"padding-left":"3rem"}},activeClass:"nav-active",onClick:()=>r(!1),get children(){return[Ee(()=>G.icon)," ",Ee(()=>G.label)]}})})),se}}),null),Se(se=>(se=n()===j.name?"rotate(180deg)":"none")!=null?Q.style.setProperty("transform",se):Q.style.removeProperty("transform")),I})()}),null),a(D,R(ze,{get when(){return pr.currentUser},get children(){var j=p$(),I=j.firstChild,M=I.firstChild,J=I.nextSibling;return j.style.setProperty("padding","1rem"),j.style.setProperty("border-top","2px solid var(--border-color)"),a(I,R(ze,{get when(){return pr.currentUser?.photoURL},get children(){var H=c0();return Se(Q=>{var se=pr.currentUser.photoURL,G=te;return se!==Q.e&&tr(H,"src",Q.e=se),Q.t=m(H,G,Q.t),Q},{e:void 0,t:void 0}),H}}),M),a(M,()=>pr.currentUser?.displayName||pr.currentUser?.email),J.$$click=()=>{C(),r(!1)},Se(H=>{var Q={...K,"margin-bottom":"1rem"},se={...$,width:"100%"};return H.e=m(I,Q,H.e),H.t=m(J,se,H.t),H},{e:void 0,t:void 0}),j}}),null),Se(j=>{var I=l,M=c,J=e()?"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z":"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z",H={...y,display:e()?"block":"none"};return j.e=m(k,I,j.e),j.t=m(F,M,j.t),J!==j.a&&tr(L,"d",j.a=J),j.o=m(D,H,j.o),j},{e:void 0,t:void 0,a:void 0,o:void 0}),k})()};br(["click"]);var b$=he("<div><div><div>🔒</div><h1></h1><p>.</p><div><p><strong></strong><br></p></div><div><button></button></div><div><h3></h3><div><span>✓</span><span></span></div><div><span>✓</span><span></span></div><div><span>✓</span><span></span></div></div><div><p>"),u0=he("<br>"),_$=he("<strong>");const S$=t=>{const{t:e}=or(),r={"min-height":"calc(100vh - 200px)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},n={"text-align":"center","max-width":"600px",width:"100%"},i={"font-size":"5rem",color:"#e53e3e","margin-bottom":"2rem"},o={"font-size":"2.5rem","font-weight":"700",color:"#1a202c","margin-bottom":"1rem"},s={"font-size":"1.25rem",color:"#718096","margin-bottom":"2rem","line-height":"1.6"},l={background:"#f7fafc",border:"1px solid #e2e8f0","border-radius":"0.5rem",padding:"1.5rem","margin-bottom":"2rem"},c={color:"#4a5568","font-size":"1rem","line-height":"1.6"},u={display:"flex",gap:"1rem","justify-content":"center","flex-wrap":"wrap"},h={padding:"0.75rem 2rem","border-radius":"0.5rem","text-decoration":"none","font-weight":"500",transition:"all 0.2s",display:"inline-block"},y={...h,background:"var(--primary-color)",color:"white",border:"2px solid var(--primary-color)"},g={...h,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},f={"text-align":"left","margin-top":"2rem",padding:"0 2rem"},x={display:"flex","align-items":"center",gap:"0.75rem","margin-bottom":"1rem",color:"#4a5568"},S={color:"#48bb78","font-size":"1.25rem"};return R(to,{get title(){return e("unauthorized.title")},get children(){var w=b$(),E=w.firstChild,q=E.firstChild,ee=q.nextSibling,W=ee.nextSibling,K=W.firstChild,te=W.nextSibling,$=te.firstChild,C=$.firstChild;C.nextSibling;var T=te.nextSibling,O=T.firstChild,b=T.nextSibling,P=b.firstChild,_=P.nextSibling,z=_.firstChild,Z=z.nextSibling,k=_.nextSibling,F=k.firstChild,X=F.nextSibling,U=k.nextSibling,B=U.firstChild,ce=B.nextSibling,L=b.nextSibling,D=L.firstChild;return m(w,r),m(E,n),m(q,i),m(ee,o),a(ee,()=>e("unauthorized.accessDenied")),m(W,s),a(W,()=>e("unauthorized.noPermission"),K),a(W,(()=>{var j=Ee(()=>!!t.featureName);return()=>j()?` ${t.featureName}`:` ${e("unauthorized.thisFeature")}`})(),K),m(te,l),m($,c),a(C,()=>e("unauthorized.whySeeing")),a($,()=>e("unauthorized.explanation"),null),a($,(()=>{var j=Ee(()=>!!t.requiredPermission);return()=>j()&&[u0(),u0(),(()=>{var I=_$();return a(I,()=>e("unauthorized.requiredPermission")),I})()," ",Ee(()=>t.requiredPermission)]})(),null),m(T,u),a(T,R(sc,{href:"/",style:y,get children(){return e("unauthorized.goToDashboard")}}),O),O.$$click=()=>window.history.back(),a(O,()=>e("unauthorized.goBack")),m(b,f),P.style.setProperty("margin-bottom","1rem"),P.style.setProperty("color","#2d3748"),a(P,()=>e("unauthorized.featuresCanAccess")),a(Z,()=>e("unauthorized.dashboardAccess")),a(X,()=>e("unauthorized.profileAccess")),a(ce,()=>e("unauthorized.roleBasedAccess")),L.style.setProperty("margin-top","3rem"),L.style.setProperty("padding","1.5rem"),L.style.setProperty("background","#edf2f7"),L.style.setProperty("border-radius","0.5rem"),D.style.setProperty("color","#4a5568"),D.style.setProperty("font-size","0.875rem"),a(D,()=>e("unauthorized.needAccess")),Se(j=>{var I=g,M=x,J=S,H=x,Q=S,se=x,G=S;return j.e=m(O,I,j.e),j.t=m(_,M,j.t),j.a=m(z,J,j.a),j.o=m(k,H,j.o),j.i=m(F,Q,j.i),j.n=m(U,se,j.n),j.s=m(B,G,j.s),j},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),w}})};br(["click"]);const wo=t=>{const{t:e}=or(),r=()=>{if(!t.permission)return!0;const i=pr.state?.profile;if(!i)return!1;if(i.isAdmin)return!0;switch(t.permission){case"AccountAccess":return i.AccountAccess===!0;case"InventoryAccess":return i.InventoryAccess===!0;case"EmployeeAccess":return i.EmployeeAccess===!0;case"BankingAccess":return i.BankingAccess===!0;case"JournalAccess":return i.JournalAccess===!0;case"AdminAccess":return i.isAdmin===!0;default:return i[t.permission]===!0}},n=()=>{if(t.requiredPermission)return t.requiredPermission;switch(t.permission){case"AccountAccess":return e("unauthorized.permissions.accountAccess");case"InventoryAccess":return e("unauthorized.permissions.inventoryAccess");case"EmployeeAccess":return e("unauthorized.permissions.employeeAccess");case"BankingAccess":return e("unauthorized.permissions.bankingAccess");case"JournalAccess":return e("unauthorized.permissions.journalAccess");case"AdminAccess":return e("unauthorized.permissions.adminAccess");default:return t.permission}};return R(ze,{get when(){return r()},get fallback(){return t.fallback||R(S$,{get featureName(){return t.featureName},get requiredPermission(){return n()}})},get children(){return t.children}})};var P$=he('<button title="Open Dev Tools">🛠️'),w$=he("<span>(<!>)"),x$=he("<div><span></span><span>"),d0=he("<div>"),A$=he("<div>Database reset only available in fake mode"),C$=he("<div><div>Loading..."),I$=he("<div><div><h3>🛠️ Dev Tools</h3><button>✕</button></div><div><div>API Mode</div><div><button>Fake Server</button><button>Real API</button><button>Hybrid</button></div><div>Current: <strong></strong></div></div><div><div>Health Status</div></div><div><div>Database Stats</div></div><div><div>Actions</div><div><button>🔄 Refresh Stats</button><button>💊 Health Check</button></div><div><button>🗑️ Reset DB</button></div></div><div><div>Info</div><div>• <strong>Fake Server:</strong> Uses local mock data<br>• <strong>Real API:</strong> Connects to actual backend<br>• <strong>Hybrid:</strong> Real API with fake fallback<br>• Settings are saved in localStorage"),$$=he("<div>Loading..."),E$=he("<div><span>:</span><span>");const T$=()=>{const[t,e]=Ce(!1),[r,n]=Ce(xm.getMode()),[i,o]=Ce({}),[s,l]=Ce(null),[c,u]=Ce(!1);wn(async()=>{await h(),await y()});const h=async()=>{try{const $=await a0.getStats();o($)}catch($){console.error("Failed to load stats:",$)}},y=async()=>{try{const $=await a0.healthCheck();l($)}catch($){console.error("Health check failed:",$),l({status:"error",error:$.message})}},g=async $=>{u(!0);try{xm.setMode($),n($),await h(),await y()}catch(C){console.error("Failed to change API mode:",C)}finally{u(!1)}},f=async()=>{if(confirm("Are you sure you want to reset the fake database to its initial state?")){u(!0);try{const $=await Ei.utils.resetDatabase();alert($.message),await h()}catch($){console.error("Failed to reset database:",$),alert("Failed to reset database")}finally{u(!1)}}},x={position:"fixed",bottom:"20px",right:"20px","z-index":"10000","font-family":"monospace"},S={background:"#1a1a1a",color:"#fff",border:"1px solid #333","border-radius":"8px",padding:"16px","min-width":"300px","max-width":"400px","box-shadow":"0 4px 20px rgba(0,0,0,0.3)"},w={background:"#007acc",color:"#fff",border:"none","border-radius":"50%",width:"50px",height:"50px",cursor:"pointer","font-size":"20px","box-shadow":"0 2px 10px rgba(0,0,0,0.2)",display:"flex","align-items":"center","justify-content":"center"},E={background:"#333",color:"#fff",border:"1px solid #555","border-radius":"4px",padding:"6px 12px",cursor:"pointer","font-size":"12px","margin-right":"8px","margin-bottom":"8px"},q={...E,background:"#007acc","border-color":"#007acc"},ee={"margin-bottom":"16px","padding-bottom":"12px","border-bottom":"1px solid #333"},W={"font-size":"14px","font-weight":"bold","margin-bottom":"8px",color:"#007acc"},K={display:"flex","justify-content":"space-between","font-size":"12px","margin-bottom":"4px"},te=$=>({display:"inline-block",width:"8px",height:"8px","border-radius":"50%","margin-right":"8px",background:$==="healthy"?"#00ff00":$==="error"?"#ff0000":"#ffff00"});return(()=>{var $=d0();return a($,R(ze,{get when(){return!t()},get children(){var C=P$();return C.$$click=()=>e(!0),m(C,w),C}}),null),a($,R(ze,{get when(){return t()},get children(){var C=I$(),T=C.firstChild,O=T.firstChild,b=O.nextSibling,P=T.nextSibling,_=P.firstChild,z=_.nextSibling,Z=z.firstChild,k=Z.nextSibling,F=k.nextSibling,X=z.nextSibling,U=X.firstChild,B=U.nextSibling,ce=P.nextSibling,L=ce.firstChild,D=ce.nextSibling,j=D.firstChild,I=D.nextSibling,M=I.firstChild,J=M.nextSibling,H=J.firstChild,Q=H.nextSibling,se=J.nextSibling,G=se.firstChild,re=I.nextSibling,oe=re.firstChild,fe=oe.nextSibling;return m(C,S),T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),T.style.setProperty("margin-bottom","16px"),O.style.setProperty("margin","0"),O.style.setProperty("color","#007acc"),O.style.setProperty("font-size","16px"),b.$$click=()=>e(!1),Z.$$click=()=>g("fake"),k.$$click=()=>g("real"),F.$$click=()=>g("hybrid"),X.style.setProperty("font-size","11px"),X.style.setProperty("color","#888"),X.style.setProperty("margin-top","4px"),a(B,r),a(X,()=>r()==="fake"&&" (Using fake server)",null),a(X,()=>r()==="real"&&" (Using real API)",null),a(X,()=>r()==="hybrid"&&" (Real API with fallback)",null),a(ce,R(ze,{get when(){return s()},get fallback(){return(()=>{var ae=$$();return ae.style.setProperty("font-size","12px"),ae})()},get children(){return[(()=>{var ae=x$(),Y=ae.firstChild,ie=Y.nextSibling;return ae.style.setProperty("display","flex"),ae.style.setProperty("align-items","center"),ae.style.setProperty("font-size","12px"),a(ie,()=>s()?.status||"Unknown"),a(ae,R(ze,{get when(){return s()?.timestamp},get children(){var de=w$(),ue=de.firstChild,ge=ue.nextSibling;return ge.nextSibling,de.style.setProperty("margin-left","8px"),de.style.setProperty("color","#888"),a(de,()=>new Date(s().timestamp).toLocaleTimeString(),ge),de}}),null),Se(de=>m(Y,te(s()?.status||"unknown"),de)),ae})(),R(ze,{get when(){return s()?.error},get children(){var ae=d0();return ae.style.setProperty("font-size","11px"),ae.style.setProperty("color","#ff6666"),ae.style.setProperty("margin-top","4px"),a(ae,()=>s().error),ae}})]}}),null),a(D,R(Ut,{get each(){return Object.entries(i())},children:([ae,Y])=>(()=>{var ie=E$(),de=ie.firstChild,ue=de.firstChild,ge=de.nextSibling;return m(ie,K),de.style.setProperty("text-transform","capitalize"),a(de,ae,ue),ge.style.setProperty("color","#00ff00"),a(ge,Y),ie})()}),null),H.$$click=h,Q.$$click=y,se.style.setProperty("margin-top","8px"),G.$$click=f,a(I,R(ze,{get when(){return r()!=="fake"},get children(){var ae=A$();return ae.style.setProperty("font-size","11px"),ae.style.setProperty("color","#888"),ae.style.setProperty("margin-top","4px"),ae}}),null),fe.style.setProperty("font-size","11px"),fe.style.setProperty("color","#888"),fe.style.setProperty("line-height","1.4"),a(C,R(ze,{get when(){return c()},get children(){var ae=C$(),Y=ae.firstChild;return ae.style.setProperty("position","absolute"),ae.style.setProperty("top","0"),ae.style.setProperty("left","0"),ae.style.setProperty("right","0"),ae.style.setProperty("bottom","0"),ae.style.setProperty("background","rgba(0,0,0,0.7)"),ae.style.setProperty("display","flex"),ae.style.setProperty("align-items","center"),ae.style.setProperty("justify-content","center"),ae.style.setProperty("border-radius","8px"),Y.style.setProperty("color","#fff"),Y.style.setProperty("font-size","14px"),ae}}),null),Se(ae=>{var Y={...E,padding:"4px 8px"},ie=ee,de=W,ue=r()==="fake"?q:E,ge=c(),Pe=r()==="real"?q:E,pe=c(),_e=r()==="hybrid"?q:E,Le=c(),De=ee,Te=W,$e=ee,Ie=W,Re=ee,Je=W,Be=E,Ke=c(),Xe=E,at=c(),ot={...E,background:"#cc4400","border-color":"#cc4400"},Qe=c()||r()!=="fake",dt=W;return ae.e=m(b,Y,ae.e),ae.t=m(P,ie,ae.t),ae.a=m(_,de,ae.a),ae.o=m(Z,ue,ae.o),ge!==ae.i&&(Z.disabled=ae.i=ge),ae.n=m(k,Pe,ae.n),pe!==ae.s&&(k.disabled=ae.s=pe),ae.h=m(F,_e,ae.h),Le!==ae.r&&(F.disabled=ae.r=Le),ae.d=m(ce,De,ae.d),ae.l=m(L,Te,ae.l),ae.u=m(D,$e,ae.u),ae.c=m(j,Ie,ae.c),ae.w=m(I,Re,ae.w),ae.m=m(M,Je,ae.m),ae.f=m(H,Be,ae.f),Ke!==ae.y&&(H.disabled=ae.y=Ke),ae.g=m(Q,Xe,ae.g),at!==ae.p&&(Q.disabled=ae.p=at),ae.b=m(G,ot,ae.b),Qe!==ae.T&&(G.disabled=ae.T=Qe),ae.A=m(oe,dt,ae.A),ae},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),C}}),null),Se(C=>m($,x,C)),$})()};br(["click"]);const k$=[{id:"1",accountNumber:"1000",name:"Cash and Cash Equivalents",accountType:"Asset",category:"Current Assets",description:"Cash on hand and in bank accounts",balance:45230.5,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1001",accountNumber:"1001",name:"Petty Cash",accountType:"Asset",category:"Current Assets",description:"Small amounts of cash for minor expenses",balance:500,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1002",accountNumber:"1002",name:"Bank - Checking Account",accountType:"Asset",category:"Current Assets",description:"Main operating checking account",balance:32730.5,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1003",accountNumber:"1003",name:"Bank - Savings Account",accountType:"Asset",category:"Current Assets",description:"Interest-bearing savings account",balance:12e3,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"2",accountNumber:"1100",name:"Accounts Receivable",accountType:"Asset",category:"Current Assets",description:"Money owed by customers",balance:23450.75,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2001",accountNumber:"1101",name:"Trade Receivables",accountType:"Asset",category:"Current Assets",description:"Receivables from regular customers",balance:18450.75,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2002",accountNumber:"1102",name:"Employee Advances",accountType:"Asset",category:"Current Assets",description:"Money advanced to employees",balance:5e3,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"3",accountNumber:"1200",name:"Inventory",accountType:"Asset",category:"Current Assets",description:"Products held for sale",balance:78920.25,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-13"},{id:"4",accountNumber:"1500",name:"Equipment",accountType:"Asset",category:"Fixed Assets",description:"Office equipment and machinery",balance:125e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-12"},{id:"5",accountNumber:"2000",name:"Accounts Payable",accountType:"Liability",category:"Current Liabilities",description:"Money owed to suppliers",balance:15670.3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-11"},{id:"6",accountNumber:"2100",name:"Accrued Expenses",accountType:"Liability",category:"Current Liabilities",description:"Expenses incurred but not yet paid",balance:8945.6,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-10"},{id:"7",accountNumber:"2500",name:"Long-term Debt",accountType:"Liability",category:"Long-term Liabilities",description:"Long-term loans and mortgages",balance:85e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-09"},{id:"8",accountNumber:"3000",name:"Owner's Equity",accountType:"Equity",category:"Owner's Equity",description:"Owner's investment in the business",balance:15e4,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-08"},{id:"9",accountNumber:"3100",name:"Retained Earnings",accountType:"Equity",category:"Owner's Equity",description:"Accumulated profits retained in business",balance:32450.8,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-07"},{id:"10",accountNumber:"4000",name:"Sales Revenue",accountType:"Revenue",category:"Operating Revenue",description:"Revenue from product sales",balance:245678.9,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-06"},{id:"11",accountNumber:"4100",name:"Service Revenue",accountType:"Revenue",category:"Operating Revenue",description:"Revenue from services provided",balance:89432.15,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-05"},{id:"12",accountNumber:"5000",name:"Cost of Goods Sold",accountType:"Expense",category:"Operating Expenses",description:"Direct costs of producing goods",balance:125678.45,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-04"},{id:"13",accountNumber:"5100",name:"Salaries Expense",accountType:"Expense",category:"Operating Expenses",description:"Employee salary expenses",balance:98765.32,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-03"},{id:"14",accountNumber:"5200",name:"Rent Expense",accountType:"Expense",category:"Operating Expenses",description:"Office rent expenses",balance:24e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-02"}],N$=[{id:"1",accountId:"1",date:"2024-01-15",description:"Customer payment received",debitAmount:5e3,creditAmount:0,reference:"INV-2024-001",type:"debit"},{id:"2",accountId:"2",date:"2024-01-15",description:"Customer payment received",debitAmount:0,creditAmount:5e3,reference:"INV-2024-001",type:"credit"},{id:"3",accountId:"5",date:"2024-01-14",description:"Office supplies purchased",debitAmount:0,creditAmount:1250,reference:"PO-2024-001",type:"credit"}],[zo,Xc]=Ce(k$),[nf,L$]=Ce(N$),kr={get accounts(){return zo()},get transactions(){return nf()},parseAccount(t){return{id:t.id||t?.code,accountNumber:t.accountNumber||t?.code,name:t.name,type:t.type,accountType:t.accountType,category:t.category,description:t.description,isActive:!0,accountId:t?.accountId}},updAccount(t){Xc(t.map(kr.parseAccount))},fetchAllAccount(t){const e={...t,createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return Xc([...zo(),e]),e},async addAccount(t){const e={...t,accountId:Lu(),id:Lu(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};console.log("newAccount",e);let r=await Gh.create(e);return console.log(r),Xc([...zo(),e]),e},async updateAccountServer(t,e){let r=await Gh.update(t,e);kr.updateAccount(t,e),console.log(r,t,e)},updateAccount(t,e){Xc(zo().map(r=>r.id===t?{...r,...e,lastModified:new Date().toISOString().split("T")[0]}:r))},deleteAccount(t){Xc(zo().filter(e=>e.id!==t))},getAccountById(t){return zo().find(e=>e.id===t)},getAccountsByType(t){return zo().filter(e=>e.type===t)},getAccountTransactions(t){return nf().filter(e=>e.accountId===t)},addTransaction(t){const e={...t,id:Date.now().toString()};L$([...nf(),e]);const r=this.getAccountById(t.accountId);if(r){const n=t.type==="debit"?t.debitAmount:-t.creditAmount;this.updateAccount(t.accountId,{balance:r.balance+n})}return e},getTotalByType(t){return zo().filter(e=>e.type===t&&e.isActive).reduce((e,r)=>e+r.balance,0)},getAccountCategories(t){const e=this.getAccountsByType(t);return[...new Set(e.map(r=>r.category))]},getSubAccounts(t){return zo().filter(e=>e.parentAccountId===t)},getParentAccounts(){return zo().filter(t=>!t.parentAccountId)},getAccountHierarchy(){const t=this.getParentAccounts();return console.log(this.getSubAccounts("20110")),console.log(t),t.map(e=>({...e,subAccounts:this.getSubAccounts(e?.id)}))},getAccountWithSubAccounts(t){const e=this.getAccountById(t);return e?{...e,subAccounts:this.getSubAccounts(t),parentAccount:e.parentAccountId?this.getAccountById(e.parentAccountId):null}:null},getAccountPath(t){const e=this.getAccountById(t);if(!e)return[];const r=[e];let n=e;for(;n.parentAccountId;){const i=this.getAccountById(n.parentAccountId);if(i)r.unshift(i),n=i;else break}return r},getTotalBalanceWithSubAccounts(t){const e=this.getAccountById(t);if(!e)return 0;const n=this.getSubAccounts(t).reduce((i,o)=>i+this.getTotalBalanceWithSubAccounts(o.id),0);return e.balance+n},canDeleteAccount(t){const e=this.getSubAccounts(t);if(e.length>0)return{canDelete:!1,reason:`Account has ${e.length} sub-account(s). Delete or move sub-accounts first.`};const r=this.getAccountTransactions(t);return r.length>0?{canDelete:!1,reason:`Account has ${r.length} transaction(s). Cannot delete account with transaction history.`}:{canDelete:!0}}};var la=he("<div>"),Zc=he("<div> ");const R$=()=>{const{t}=or(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},n={"font-size":"0.875rem",color:"var(--text-muted)"},i=S=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(S),o=kr.getTotalByType("Asset"),s=kr.getTotalByType("Liability"),l=kr.getTotalByType("Equity"),c=kr.getTotalByType("Revenue"),u=kr.getTotalByType("Expense"),h=kr.getAccountsByType("Asset").length,y=kr.getAccountsByType("Liability").length,g=kr.getAccountsByType("Equity").length,f=kr.getAccountsByType("Revenue").length,x=kr.getAccountsByType("Expense").length;return(()=>{var S=la();return m(S,e),a(S,R(Ot,{get title(){return t("dashboard.totalAssets")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var w=la();return a(w,()=>i(o)),Se(E=>m(w,r,E)),w})(),(()=>{var w=Zc(),E=w.firstChild;return a(w,h,E),a(w,()=>t("navigation.accounts"),null),Se(q=>m(w,n,q)),w})()]}}),null),a(S,R(Ot,{get title(){return t("dashboard.totalLiabilities")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var w=la();return a(w,()=>i(s)),Se(E=>m(w,r,E)),w})(),(()=>{var w=Zc(),E=w.firstChild;return a(w,y,E),a(w,()=>t("navigation.accounts"),null),Se(q=>m(w,n,q)),w})()]}}),null),a(S,R(Ot,{get title(){return t("dashboard.totalEquity")},get subtitle(){return t("accounts.categories.ownersEquity")},get children(){return[(()=>{var w=la();return a(w,()=>i(l)),Se(E=>m(w,r,E)),w})(),(()=>{var w=Zc(),E=w.firstChild;return a(w,g,E),a(w,()=>t("navigation.accounts"),null),Se(q=>m(w,n,q)),w})()]}}),null),a(S,R(Ot,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("accounts.categories.operatingRevenue")},get children(){return[(()=>{var w=la();return a(w,()=>i(c)),Se(E=>m(w,r,E)),w})(),(()=>{var w=Zc(),E=w.firstChild;return a(w,f,E),a(w,()=>t("navigation.accounts"),null),Se(q=>m(w,n,q)),w})()]}}),null),a(S,R(Ot,{get title(){return t("dashboard.totalExpenses")},get subtitle(){return t("accounts.categories.operatingExpenses")},get children(){return[(()=>{var w=la();return a(w,()=>i(u)),Se(E=>m(w,r,E)),w})(),(()=>{var w=Zc(),E=w.firstChild;return a(w,x,E),a(w,()=>t("navigation.accounts"),null),Se(q=>m(w,n,q)),w})()]}}),null),a(S,R(Ot,{get title(){return t("dashboard.netIncome")},get subtitle(){return`${t("dashboard.totalRevenue")} - ${t("dashboard.totalExpenses")}`},get children(){return[(()=>{var w=la();return a(w,()=>i(c-u)),Se(E=>m(w,{...r,color:c-u>=0?"#4caf50":"#f44336"},E)),w})(),(()=>{var w=la();return a(w,()=>c-u>=0?t("dashboard.netIncome"):t("dashboard.netLoss")),Se(E=>m(w,n,E)),w})()]}}),null),S})()};var D$=he("<div><div></div><div>"),M$=he("<h3>"),eu=he("<div>");const F$=t=>{const{t:e}=or();Wm();const r={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},i={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"},o={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},s={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},l={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem"},c={"font-size":"0.875rem",color:"var(--text-secondary)","line-height":"1.4"},u=g=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[g]||{bg:"#f5f5f5",color:"#666"},h=g=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(g),y=u(t.account.accountType);return R(Ot,{get children(){return[(()=>{var g=D$(),f=g.firstChild,x=f.nextSibling;return m(g,n),m(f,i),a(f,()=>t.account.accountNumber),a(x,()=>e(`accounts.types.${t.account.accountType.toLowerCase()}`)),Se(S=>m(x,{...o,background:y.bg,color:y.color},S)),g})(),(()=>{var g=M$();return g.style.setProperty("margin","0 0 0.5rem 0"),g.style.setProperty("font-size","1.1rem"),a(g,()=>t.account.name),g})(),(()=>{var g=eu();return m(g,l),a(g,()=>t.account.category),g})(),(()=>{var g=eu();return m(g,s),a(g,()=>h(t.account.balance)),g})(),(()=>{var g=eu();return m(g,c),a(g,()=>t.account.description),g})(),Ee(()=>Ee(()=>!t.account.isActive)()&&(()=>{var g=eu();return g.style.setProperty("margin-top","0.5rem"),g.style.setProperty("padding","0.25rem 0.75rem"),g.style.setProperty("border-radius","9999px"),g.style.setProperty("font-size","0.75rem"),g.style.setProperty("font-weight","500"),g.style.setProperty("background","#ffebee"),g.style.setProperty("color","#d32f2f"),g.style.setProperty("text-align","center"),a(g,()=>e("common.inactive")),g})()),(()=>{var g=eu();return m(g,r),a(g,R(ht,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.account),get children(){return[Ee(()=>e("common.view"))," ",Ee(()=>e("accounts.accountDetails"))]}})),g})()]}})};var O$=he("<div><div></div><div>"),B$=he("<div><div><div><div></div><h3>"),j$=he("<div>"),V$=he("<button>"),q$=he("<div><h4> (<!>)"),z$=he("<div><div><div></div><div> • </div></div><div>");const U$=t=>{const{t:e}=or(),r=Wm(),[n,i]=Ce(!0),o={"margin-bottom":"1rem"},s={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},l={display:"flex","align-items":"center",gap:"1rem"},c={background:"none",border:"none",cursor:"pointer","font-size":"1.2rem",color:"var(--text-muted)",padding:"0.25rem","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease"},u={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},h={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},y={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},g={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},f={"margin-left":"1rem","border-left":"2px solid var(--border-color)","padding-left":"1rem","margin-top":"1rem"},x={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem","margin-bottom":"0.5rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},S={flex:"1"},w={"font-weight":"500","margin-bottom":"0.25rem"},E={"font-size":"0.875rem",color:"var(--text-muted)"},q={"font-weight":"600",color:"var(--primary-color)"},ee={display:"flex",gap:"0.5rem"},W=O=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[O]||{bg:"#f5f5f5",color:"#666"},K=O=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(O),te=O=>{t.onViewDetails?t.onViewDetails(O):r(`/accounts/${O.id}`)},$=()=>{t.onAddSubAccount&&t.onAddSubAccount(t.account)},C=t.account.balance+t.account.subAccounts.reduce((O,b)=>O+b.balance,0),T=W(t.account.accountType);return R(Ot,{className:"account-hierarchy-card",style:o,get children(){return[(()=>{var O=B$(),b=O.firstChild,P=b.firstChild,_=P.firstChild,z=_.nextSibling;return m(O,s),m(b,l),a(b,(()=>{var Z=Ee(()=>t.account.subAccounts.length>0);return()=>Z()&&(()=>{var k=V$();return k.addEventListener("mouseleave",F=>F.target.style.background="none"),k.addEventListener("mouseenter",F=>F.target.style.background="var(--background-color)"),k.$$click=()=>i(!n()),m(k,c),a(k,()=>n()?"▼":"▶"),k})()})(),P),P.$$click=()=>te(t.account),P.style.setProperty("cursor","pointer"),m(_,u),a(_,()=>t.account.accountNumber),m(z,h),a(z,()=>t.account.name),a(O,R(ze,{get when(){return t?.account?.accountType},get children(){var Z=O$(),k=Z.firstChild,F=k.nextSibling;return Z.style.setProperty("text-align","right"),m(k,y),a(k,()=>K(C||0)),a(F,()=>e(`accounts.types.${t?.account?.accountType?.toLowerCase()}`)),Se(X=>m(F,{...g,background:T.bg,color:T.color},X)),Z}}),null),O})(),(()=>{var O=j$();return m(O,ee),a(O,R(ht,{variant:"secondary",size:"sm",onClick:()=>te(t.account),get children(){return[Ee(()=>e("common.view"))," ",Ee(()=>e("accounts.accountDetails"))]}}),null),a(O,R(ht,{variant:"outline",size:"sm",onClick:$,get children(){return[Ee(()=>e("common.add"))," ",Ee(()=>e("accounts.subAccounts"))]}}),null),O})(),Ee(()=>Ee(()=>!!(n()&&t.account.subAccounts.length>0))()&&(()=>{var O=q$(),b=O.firstChild,P=b.firstChild,_=P.nextSibling;return _.nextSibling,m(O,f),b.style.setProperty("margin","0 0 1rem 0"),b.style.setProperty("font-size","1rem"),b.style.setProperty("color","var(--text-muted)"),a(b,()=>e("accounts.subAccounts"),P),a(b,()=>t.account.subAccounts.length,_),a(O,()=>t.account.subAccounts.map(z=>(()=>{var Z=z$(),k=Z.firstChild,F=k.firstChild,X=F.nextSibling,U=X.firstChild,B=k.nextSibling;return Z.addEventListener("mouseleave",ce=>{ce.currentTarget.style.background="var(--background-color)",ce.currentTarget.style.transform="translateY(0)"}),Z.addEventListener("mouseenter",ce=>{ce.currentTarget.style.background="var(--surface-color)",ce.currentTarget.style.transform="translateY(-1px)"}),Z.$$click=()=>te(z),m(Z,x),m(k,S),m(F,w),a(F,()=>z.name),m(X,E),a(X,()=>z.accountNumber,U),a(X,()=>z.description,null),m(B,q),a(B,()=>K(z.balance)),Z})()),null),O})())]}})};br(["click"]);var H$=he("<form><div>");const G$=t=>{const{t:e}=or(),[r,n]=Ce({accountNumber:"",name:"",accountType:"",category:"",type:"",classification:"",description:"",balance:"0",isActive:"true"}),i=[{value:"Asset",label:e("accounts.types.asset"),type:"debit",classification:"real"},{value:"Liability",label:e("accounts.types.liability"),type:"credit",classification:"real"},{value:"Equity",label:e("accounts.types.equity"),type:"credit",classification:"real"},{value:"Revenue",label:e("accounts.types.revenue"),type:"credit",classification:"nominal"},{value:"Expense",label:e("accounts.types.expense"),type:"debit",classification:"nominal"}],o=()=>{const h=r().accountType;return h?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")},{value:"Sales Revenue",label:e("accounts.categories.salesRevenue")},{value:"Service Revenue",label:e("accounts.categories.servicesRevenue")},{value:"Subscription Revenue",label:e("accounts.categories.subscriptionRevenue")},{value:"Rental Revenue",label:e("accounts.categories.rentalRevenue")},{value:"Commission Revenue",label:e("accounts.categories.commissionRevenue")},{value:"Franchise Revenue",label:e("accounts.categories.franchiseRevenue")},{value:"Licensing Revenue",label:e("accounts.categories.licensingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[h]||[]:[]},s=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],l={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},c=h=>{h.preventDefault();const y=r();if(!y.accountNumber||!y.name||!y.accountType||!y.category){alert(e("forms.requiredField"));return}const g=kr.accounts.find(S=>S.accountNumber===y.accountNumber),f=i.find(S=>S.value===y.accountType);if(g){alert(e("forms.duplicateAccountNumber"));return}const x={accountNumber:y.accountNumber,name:y.name,accountType:"",classification:f?.classification,type:f?.type,category:y.category,description:y.description,balance:parseFloat(y.balance)||0,isActive:y.isActive==="true"};kr.addAccount(x),n({accountNumber:"",name:"",accountType:"",type:"",category:"",description:"",classification:"",balance:"0",isActive:"true"}),t.onClose()},u=(h,y)=>{n(g=>{const f={...g,[h]:y};return h==="type"&&(f.category=""),f})};return R(On,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.addAccount")},get children(){var h=H$(),y=h.firstChild;return h.addEventListener("submit",c),a(h,R($r,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:g=>u("accountNumber",g),get placeholder(){return e("accounts.accountNumber")},required:!0}),y),a(h,R($r,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:g=>u("name",g),get placeholder(){return e("accounts.accountName")},required:!0}),y),a(h,R(Pn,{get label(){return e("accounts.accountType")},get value(){return r().accountType},onChange:g=>u("accountType",g),options:i,required:!0}),y),a(h,R(Pn,{get label(){return e("accounts.category")},get value(){return r().category},onChange:g=>u("category",g),get options(){return o()},required:!0}),y),a(h,R($r,{get label(){return e("common.description")},get value(){return r().description},onChange:g=>u("description",g),get placeholder(){return e("common.description")}}),y),a(h,R($r,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:g=>u("balance",g),get placeholder(){return e("accounts.balance")}}),y),a(h,R(Pn,{get label(){return e("common.status")},get value(){return r().isActive},onChange:g=>u("isActive",g),options:s,required:!0}),y),m(y,l),a(y,R(ht,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(y,R(ht,{variant:"primary",type:"submit",get children(){return e("accounts.addAccount")}}),null),h}})};var W$=he("<form><div>"),Y$=he("<div><div></div><div> - </div><div> • ");const K$=t=>{const{t:e}=or(),[r,n]=Ce({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"});e("accounts.types.asset"),e("accounts.types.liability"),e("accounts.types.equity"),e("accounts.types.revenue"),e("accounts.types.expense");const i=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],o={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},s={background:"var(--background-color)",padding:"1rem","border-radius":"var(--border-radius-sm)","margin-bottom":"1.5rem",border:"1px solid var(--border-color)"},l={"font-size":"0.875rem","font-weight":"500",color:"var(--text-muted)","margin-bottom":"0.5rem"},c={"font-weight":"600",color:"var(--text-primary)"},u={"font-size":"0.875rem",color:"var(--text-secondary)"},h=x=>{x.preventDefault();const S=r();if(console.log(S),!S.accountNumber||!S.name||!t.parentAccount){alert(e("forms.requiredField"));return}const w=kr.accounts.find(q=>q.accountNumber===S.accountNumber);if(console.log(w),w){alert(e("forms.duplicateAccountNumber"));return}const E={accountNumber:S.accountNumber,name:S.name,description:S.description,accountType:t.parentAccount.accountType,category:t.parentAccount.category,classification:t.parentAccount?.classification,type:t.parentAccount?.type,isActive:S.isActive==="true",parentAccountId:t.parentAccount.id,parentAccountNumber:t.parentAccount.accountId};kr.addAccount(E),n({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},y=(x,S)=>{n(w=>({...w,[x]:S}))},g=()=>{if(!t.parentAccount)return"";const x=t.parentAccount.accountNumber,w=kr.getSubAccounts(t.parentAccount.id).length+1;return(parseInt(x)+w).toString()},f=()=>r().accountNumber===""&&t.parentAccount?g():r().accountNumber;return R(On,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return`${e("common.add")} ${e("accounts.subAccounts")}`},get children(){return[Ee(()=>Ee(()=>!!t.parentAccount)()&&(()=>{var x=Y$(),S=x.firstChild,w=S.nextSibling,E=w.firstChild,q=w.nextSibling,ee=q.firstChild;return m(x,s),m(S,l),a(S,()=>e("accounts.parentAccount")),m(w,c),a(w,()=>t.parentAccount.accountNumber,E),a(w,()=>t.parentAccount.name,null),m(q,u),a(q,()=>e(`accounts.types.${t.parentAccount?.accountType?.toLowerCase()}`),ee),a(q,()=>t.parentAccount.category,null),x})()),(()=>{var x=W$(),S=x.firstChild;return x.addEventListener("submit",h),a(x,R($r,{get label(){return e("accounts.accountNumber")},get value(){return f()},onChange:w=>y("accountNumber",w),get placeholder(){return`${e("common.suggested")}: ${g()}`},required:!0}),S),a(x,R($r,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:w=>y("name",w),get placeholder(){return e("accounts.accountName")},required:!0}),S),a(x,R($r,{get label(){return e("common.description")},get value(){return r().description},onChange:w=>y("description",w),get placeholder(){return e("common.description")}}),S),a(x,R($r,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:w=>y("balance",w),get placeholder(){return e("accounts.balance")}}),S),a(x,R(Pn,{get label(){return e("common.status")},get value(){return r().isActive},onChange:w=>y("isActive",w),options:i,required:!0}),S),m(S,o),a(S,R(ht,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(S,R(ht,{variant:"primary",type:"submit",get children(){return[Ee(()=>e("common.add"))," ",Ee(()=>e("accounts.subAccounts"))]}}),null),x})()]}})};var J$=he("<form><div>"),Q$=he("<div>");const X$=t=>{const{t:e}=or(),[r,n]=Ce({accountNumber:"",name:"",type:"",accountType:"",category:"",description:"",isActive:"true"}),[i,o]=Ce(null);gi(()=>{t.account&&(console.log(t.account),n({accountNumber:t.account.accountNumber,name:t.account.name,type:t.account.type,accountType:t.account.accountType,category:t.account.category,description:t.account.description,isActive:t.account.isActive.toString()}),o(null))});const s=[{value:"Asset",label:e("accounts.types.asset")},{value:"Liability",label:e("accounts.types.liability")},{value:"Equity",label:e("accounts.types.equity")},{value:"Revenue",label:e("accounts.types.revenue")},{value:"Expense",label:e("accounts.types.expense")}],l=()=>{const f=r().accountType;return f?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[f]||[]:[]},c=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],u={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},h=f=>{if(f.preventDefault(),o(null),!t.account)return;const x=r();if(!x.accountNumber||!x.name||!x.type||!x.category){o(e("forms.requiredField"));return}if(kr.accounts.find(q=>q.accountNumber===x.accountNumber&&q.id!==t.account.id)){o(e("forms.duplicateAccountNumber"));return}const w={accountNumber:x.accountNumber,name:x.name,type:x.type,accountType:x.accountType,category:x.category,description:x.description,isActive:x.isActive==="true"};console.log({data:x,updatedAccount:w});let E=xP(Object.keys(t.account),w,t.account,{accountId:1,id:1});try{kr.updateAccountServer(t.account?.accountId,E.data),t.onClose()}catch(q){o(q instanceof Error?q.message:e("forms.saveError"))}},y=()=>{if(!t.account)return;const f=kr.canDeleteAccount(t.account.id);if(!f.canDelete){o(f.reason||e("forms.deleteError"));return}const x=e("forms.confirmDelete");if(confirm(x))try{kr.deleteAccount(t.account.id),t.onClose()}catch(S){o(S instanceof Error?S.message:e("forms.deleteError"))}},g=(f,x)=>{n(S=>{const w={...S,[f]:x};return f==="type"&&(w.category=""),w}),i()&&o(null)};return t.account?R(On,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.editAccount")},get children(){var f=J$(),x=f.firstChild;return f.addEventListener("submit",h),a(f,R($r,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:S=>g("accountNumber",S),get placeholder(){return e("accounts.accountNumber")},required:!0}),x),a(f,R($r,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:S=>g("name",S),get placeholder(){return e("accounts.accountName")},required:!0}),x),a(f,R(Pn,{get label(){return e("accounts.accountType")},get value(){return r().accountType},onChange:S=>g("accountType",S),options:s,required:!0}),x),a(f,R(Pn,{get label(){return e("accounts.category")},get value(){return r().category},onChange:S=>g("category",S),get options(){return l()},required:!0}),x),a(f,R($r,{get label(){return e("common.description")},get value(){return r().description},onChange:S=>g("description",S),get placeholder(){return e("common.description")}}),x),a(f,R(Pn,{get label(){return e("common.status")},get value(){return r().isActive},onChange:S=>g("isActive",S),options:c,required:!0}),x),a(f,(()=>{var S=Ee(()=>!!i());return()=>S()&&(()=>{var w=Q$();return w.style.setProperty("padding","1rem"),w.style.setProperty("border-radius","var(--border-radius-sm)"),w.style.setProperty("margin-top","1rem"),w.style.setProperty("background","#f8d7da"),w.style.setProperty("color","#721c24"),w.style.setProperty("border","1px solid #f5c6cb"),a(w,i),w})()})(),x),m(x,u),a(x,R(ht,{variant:"outline",type:"button",onClick:y,style:{color:"#dc3545","border-color":"#dc3545","margin-right":"auto"},get children(){return e("accounts.deleteAccount")}}),null),a(x,R(ht,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(x,R(ht,{variant:"primary",type:"submit",get children(){return e("common.save")}}),null),f}}):null};var Z$=he("<div><div>⚠️</div><div></div><div></div><div>"),Od=he("<div>"),eE=he("<div><div></div><div>"),tE=he("<div><button></button><button> (<!>)"),rE=he("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),nE=he("<div><div><div></div><div> • </div></div><div>");const iE=t=>{const{t:e}=or(),[r,n]=Ce("details"),[i,o]=Ce(!1),s=Mt(()=>t.account?kr.getAccountById(t.account.id)||t.account:null),l={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},c={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},u={"font-weight":"600",color:"var(--text-primary)"},h={"text-align":"center","margin-bottom":"2rem"},y={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},g={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},f={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem"},x={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},S=O=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:O?"var(--primary-color)":"var(--text-muted)","border-bottom":O?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),w={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},E={flex:"1"},q={"font-size":"0.875rem",color:"var(--text-muted)"},ee={"font-weight":"500","margin-bottom":"0.25rem"},W=O=>({"font-weight":"600",color:O==="debit"?"#4caf50":"#f44336"}),K={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},te=O=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[O]||{bg:"#f5f5f5",color:"#666"},$=O=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(O),C=O=>new Date(O).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),T=O=>{console.log(t),t.onClose()};return R(On,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.accountDetails")},get children(){return[Ee(()=>Ee(()=>!s())()?(()=>{var O=Z$(),b=O.firstChild,P=b.nextSibling,_=P.nextSibling,z=_.nextSibling;return O.style.setProperty("text-align","center"),O.style.setProperty("padding","3rem"),O.style.setProperty("color","var(--text-muted)"),b.style.setProperty("font-size","1.5rem"),b.style.setProperty("margin-bottom","1rem"),P.style.setProperty("font-size","1.1rem"),P.style.setProperty("margin-bottom","0.5rem"),a(P,()=>e("common.error")),_.style.setProperty("font-size","0.875rem"),a(_,()=>e("common.noDataFound")),z.style.setProperty("margin-top","2rem"),a(z,R(ht,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),O})():(()=>{const O=Mt(()=>te(s().accountType)),b=Mt(()=>kr.getAccountTransactions(s().id));return[(()=>{var P=eE(),_=P.firstChild,z=_.nextSibling;return m(P,h),m(_,y),a(_,()=>s().name),m(z,g),a(z,()=>$(s().balance||0)),a(P,R(ze,{get when(){return s().accountType},get children(){var Z=Od();return a(Z,()=>e(`accounts.types.${s().accountType?.toLowerCase()}`)),Se(k=>m(Z,{...f,background:O().bg,color:O().color},k)),Z}}),null),P})(),(()=>{var P=tE(),_=P.firstChild,z=_.nextSibling,Z=z.firstChild,k=Z.nextSibling;return k.nextSibling,m(P,x),_.$$click=()=>n("details"),a(_,()=>e("accounts.accountDetails")),z.$$click=()=>n("transactions"),a(z,()=>e("accounts.transactions"),Z),a(z,()=>b().length,k),Se(F=>{var X=S(r()==="details"),U=S(r()==="transactions");return F.e=m(_,X,F.e),F.t=m(z,U,F.t),F},{e:void 0,t:void 0}),P})(),Ee(()=>Ee(()=>r()==="details")()&&(()=>{var P=rE(),_=P.firstChild,z=_.firstChild,Z=z.nextSibling,k=_.nextSibling,F=k.firstChild,X=F.nextSibling,U=k.nextSibling,B=U.firstChild,ce=B.nextSibling,L=U.nextSibling,D=L.firstChild,j=D.nextSibling,I=L.nextSibling,M=I.firstChild,J=M.nextSibling,H=I.nextSibling,Q=H.firstChild,se=Q.nextSibling;return a(z,()=>e("accounts.accountNumber")),a(Z,()=>s().accountNumber),a(F,()=>e("accounts.category")),a(X,()=>s().category),a(B,()=>e("common.description")),a(ce,()=>s().description),a(D,()=>e("common.status")),a(j,(()=>{var G=Ee(()=>!!s().isActive);return()=>G()?e("common.active"):e("common.inactive")})()),a(M,()=>e("accounts.createdDate")),a(J,()=>C(s().createdDate)),a(Q,()=>e("accounts.lastModified")),a(se,()=>C(s().lastModified)),Se(G=>{var re=l,oe=c,fe=u,ae=l,Y=c,ie=u,de=l,ue=c,ge=u,Pe=l,pe=c,_e=u,Le=l,De=c,Te=u,$e=l,Ie=c,Re=u;return G.e=m(_,re,G.e),G.t=m(z,oe,G.t),G.a=m(Z,fe,G.a),G.o=m(k,ae,G.o),G.i=m(F,Y,G.i),G.n=m(X,ie,G.n),G.s=m(U,de,G.s),G.h=m(B,ue,G.h),G.r=m(ce,ge,G.r),G.d=m(L,Pe,G.d),G.l=m(D,pe,G.l),G.u=m(j,_e,G.u),G.c=m(I,Le,G.c),G.w=m(M,De,G.w),G.m=m(J,Te,G.m),G.f=m(H,$e,G.f),G.y=m(Q,Ie,G.y),G.g=m(se,Re,G.g),G},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),P})()),Ee(()=>Ee(()=>r()==="transactions")()&&(()=>{var P=Od();return a(P,(()=>{var _=Ee(()=>b().length===0);return()=>_()?(()=>{var z=Od();return z.style.setProperty("text-align","center"),z.style.setProperty("color","var(--text-muted)"),z.style.setProperty("padding","2rem"),a(z,()=>e("common.noDataFound")),z})():b().map(z=>(()=>{var Z=nE(),k=Z.firstChild,F=k.firstChild,X=F.nextSibling,U=X.firstChild,B=k.nextSibling;return m(Z,w),m(k,E),m(F,ee),a(F,()=>z.description),m(X,q),a(X,()=>C(z.date),U),a(X,()=>z.reference,null),a(B,()=>z.type==="debit"?"+":"-",null),a(B,()=>$(z.type==="debit"?z.debitAmount:z.creditAmount),null),Se(ce=>m(B,W(z.type),ce)),Z})())})()),P})()),(()=>{var P=Od();return m(P,K),a(P,R(ht,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),a(P,R(ht,{variant:"primary",onClick:()=>o(!0),get children(){return e("accounts.editAccount")}}),null),a(P,R(ze,{get when(){return pr.state?.profile?.isAdmin},get children(){return R(ht,{variant:"primary",onClick:T,children:"Remove"})}}),null),P})()]})()),Ee(()=>Ee(()=>!!s())()&&R(X$,{get isOpen(){return i()},onClose:()=>{o(!1)},get account(){return s()}}))]}})};br(["click"]);var oE=he("<div><h2></h2><div><span>:</span><button></button><button>"),sE=he("<div><span>:"),h0=he("<div>"),aE=he("<button>");const lE=()=>{const{t}=or(),[e,r]=Ce(!1),[n,i]=Ce(!1),[o,s]=Ce(!1),[l,c]=Ce(null),[u,h]=Ce(null),[y,g]=Ce("All"),[f,x]=Ce("hierarchy"),S=T=>{c(T),s(!0)},w=T=>{h(T),i(!0)},E=()=>y()==="All"?f()==="hierarchy"?kr.getAccountHierarchy():kr.accounts:f()==="hierarchy"?kr.getAccountHierarchy().filter(T=>T.accountType===y()):kr.getAccountsByType(y()),q={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(350px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},ee={display:"flex",gap:"1rem","margin-bottom":"2rem","align-items":"center"},W=T=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:T?"var(--primary-color)":"var(--surface-color)",color:T?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500",transition:"all 0.2s ease"}),K={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},te={display:"flex",gap:"0.5rem","align-items":"center","margin-left":"auto","margin-right":"1rem"},$=T=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:T?"var(--primary-color)":"var(--surface-color)",color:T?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),C=async()=>{let T=await Gh.getAlls("acc");kr.updAccount(Object.values(T))};return wn(()=>{C()}),R(to,{get title(){return t("accounts.title")},get children(){return[R(R$,{}),(()=>{var T=oE(),O=T.firstChild,b=O.nextSibling,P=b.firstChild,_=P.firstChild,z=P.nextSibling,Z=z.nextSibling;return m(T,K),O.style.setProperty("margin","0"),O.style.setProperty("font-size","1.5rem"),a(O,()=>t("accounts.title")),m(b,te),P.style.setProperty("font-weight","500"),P.style.setProperty("color","var(--text-muted)"),P.style.setProperty("font-size","0.875rem"),a(P,()=>t("common.view"),_),z.$$click=()=>x("hierarchy"),a(z,()=>t("accounts.accountHierarchy")),Z.$$click=()=>{x("flat"),Gh.getAlls("iDP")},a(Z,()=>t("common.all")),a(T,R(ht,{variant:"primary",onClick:()=>r(!0),get children(){return t("accounts.addAccount")}}),null),Se(k=>{var F=$(f()==="hierarchy"),X=$(f()==="flat");return k.e=m(z,F,k.e),k.t=m(Z,X,k.t),k},{e:void 0,t:void 0}),T})(),(()=>{var T=sE(),O=T.firstChild,b=O.firstChild;return m(T,ee),O.style.setProperty("font-weight","500"),O.style.setProperty("color","var(--text-muted)"),a(O,()=>t("common.filter"),b),a(T,()=>[t("common.all"),t("accounts.types.asset"),t("accounts.types.liability"),t("accounts.types.equity"),t("accounts.types.revenue"),t("accounts.types.expense")].map((P,_)=>{const Z=["All","Asset","Liability","Equity","Revenue","Expense"][_];return(()=>{var k=aE();return k.$$click=()=>g(Z),a(k,P),Se(F=>m(k,W(y()===Z),F)),k})()}),null),T})(),(()=>{var T=h0();return a(T,(()=>{var O=Ee(()=>f()==="hierarchy");return()=>O()?E().map(b=>R(U$,{account:b,onAddSubAccount:w,onViewDetails:S})):E().map(b=>R(F$,{account:b,onViewDetails:S}))})()),Se(O=>m(T,f()==="hierarchy"?{display:"flex","flex-direction":"column",gap:"1rem"}:q,O)),T})(),Ee(()=>Ee(()=>E().length===0)()&&(()=>{var T=h0();return T.style.setProperty("text-align","center"),T.style.setProperty("color","var(--text-muted)"),T.style.setProperty("padding","3rem"),T.style.setProperty("font-size","1.1rem"),a(T,()=>t("common.noDataFound")),T})()),R(G$,{get isOpen(){return e()},onClose:()=>r(!1)}),R(K$,{get isOpen(){return n()},onClose:()=>i(!1),get parentAccount(){return u()}}),R(iE,{get isOpen(){return o()},onClose:()=>s(!1),get account(){return l()}})]}})};br(["click"]);var cE=he("<div><h2>"),tc=he("<div>"),uE=he("<div><div><div></div><h1></h1><div></div></div><div>"),dE=he("<div><button></button><button> (<!>)"),Bd=he("<div><span></span><span>"),hE=he("<p>"),pE=he("<div><div></div><div>"),fE=he("<div><div><div></div><div> • </div></div><div>");const mE=()=>{const{t}=or(),e=XS(),r=Wm(),[n,i]=Ce(null),[o,s]=Ce("overview");wn(()=>{const _=kr.getAccountById(e.id);_?i(_):r("/accounts")});const l={display:"flex","align-items":"center",gap:"0.5rem","margin-bottom":"1rem"},c={display:"flex","align-items":"center",gap:"1rem","margin-bottom":"2rem"},u={"font-size":"1rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},h={"font-size":"2.5rem","font-weight":"700",color:"var(--primary-color)"},y={padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},g={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},f=_=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:_?"var(--primary-color)":"var(--text-muted)","border-bottom":_?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),x={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},S={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},w={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},E={"font-weight":"500",color:"var(--text-muted)"},q={"font-weight":"600",color:"var(--text-primary)"},ee={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},W={flex:"1"},K={"font-weight":"500","margin-bottom":"0.25rem"},te={"font-size":"0.875rem",color:"var(--text-muted)"},$=_=>({"font-weight":"600",color:_==="debit"?"#4caf50":"#f44336"});if(!n())return R(to,{get title(){return t("accounts.accountDetails")},get children(){var _=cE(),z=_.firstChild;return _.style.setProperty("text-align","center"),_.style.setProperty("padding","3rem"),a(z,()=>t("common.error")),a(_,R(ht,{variant:"primary",onClick:()=>r("/accounts"),get children(){return[Ee(()=>t("common.back"))," ",Ee(()=>t("navigation.accounts"))]}}),null),_}});const C=_=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[_]||{bg:"#f5f5f5",color:"#666"},T=_=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(_),O=_=>new Date(_).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),b=C(n().accountType),P=kr.getAccountTransactions(n().id);return R(to,{get title(){return n().name},get children(){return[(()=>{var _=tc();return m(_,l),a(_,R(ht,{variant:"secondary",onClick:()=>r("/accounts"),get children(){return["← ",Ee(()=>t("common.back"))," ",Ee(()=>t("navigation.accounts"))]}})),_})(),(()=>{var _=uE(),z=_.firstChild,Z=z.firstChild,k=Z.nextSibling,F=k.nextSibling,X=z.nextSibling;return m(_,c),m(Z,u),a(Z,()=>n().accountNumber),k.style.setProperty("margin","0.5rem 0"),k.style.setProperty("font-size","2rem"),a(k,()=>n().name),m(F,h),a(F,()=>T(n().balance)),a(X,()=>n().accountType),Se(U=>m(X,{...y,background:b.bg,color:b.color},U)),_})(),(()=>{var _=dE(),z=_.firstChild,Z=z.nextSibling,k=Z.firstChild,F=k.nextSibling;return F.nextSibling,m(_,g),z.$$click=()=>s("overview"),a(z,()=>t("dashboard.overview")),Z.$$click=()=>s("transactions"),a(Z,()=>t("accounts.transactions"),k),a(Z,()=>P.length,F),Se(X=>{var U=f(o()==="overview"),B=f(o()==="transactions");return X.e=m(z,U,X.e),X.t=m(Z,B,X.t),X},{e:void 0,t:void 0}),_})(),Ee(()=>Ee(()=>o()==="overview")()&&(()=>{var _=pE(),z=_.firstChild,Z=z.nextSibling;return m(z,x),a(z,R(Ot,{get title(){return t("accounts.balance")},get subtitle(){return t("dashboard.overview")},get children(){var k=tc();return k.style.setProperty("font-size","1.5rem"),k.style.setProperty("font-weight","600"),k.style.setProperty("color","var(--primary-color)"),a(k,()=>T(n().balance)),k}}),null),a(z,R(Ot,{get title(){return t("accounts.accountType")},get subtitle(){return t("accounts.category")},get children(){var k=tc();return k.style.setProperty("font-size","1.5rem"),k.style.setProperty("font-weight","600"),k.style.setProperty("color","var(--primary-color)"),a(k,()=>t(`accounts.types.${n().accountType?.toLowerCase()}`)),k}}),null),a(z,R(Ot,{get title(){return t("common.status")},get subtitle(){return t("accounts.accountDetails")},get children(){var k=tc();return k.style.setProperty("font-size","1.5rem"),k.style.setProperty("font-weight","600"),a(k,(()=>{var F=Ee(()=>!!n().isActive);return()=>F()?t("common.active"):t("common.inactive")})()),Se(F=>(F=n().isActive?"#4caf50":"#f44336")!=null?k.style.setProperty("color",F):k.style.removeProperty("color")),k}}),null),a(z,R(Ot,{get title(){return t("accounts.transactions")},get subtitle(){return t("common.total")},get children(){var k=tc();return k.style.setProperty("font-size","1.5rem"),k.style.setProperty("font-weight","600"),k.style.setProperty("color","var(--primary-color)"),a(k,()=>P.length),k}}),null),m(Z,S),a(Z,R(Ot,{get title(){return t("accounts.accountDetails")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var k=Bd(),F=k.firstChild,X=F.nextSibling;return a(F,()=>t("accounts.accountNumber")),a(X,()=>n().accountNumber),Se(U=>{var B=w,ce=E,L=q;return U.e=m(k,B,U.e),U.t=m(F,ce,U.t),U.a=m(X,L,U.a),U},{e:void 0,t:void 0,a:void 0}),k})(),(()=>{var k=Bd(),F=k.firstChild,X=F.nextSibling;return a(F,()=>t("accounts.category")),a(X,()=>n().category),Se(U=>{var B=w,ce=E,L=q;return U.e=m(k,B,U.e),U.t=m(F,ce,U.t),U.a=m(X,L,U.a),U},{e:void 0,t:void 0,a:void 0}),k})(),(()=>{var k=Bd(),F=k.firstChild,X=F.nextSibling;return a(F,()=>t("common.date")),a(X,()=>O(n().createdDate)),Se(U=>{var B=w,ce=E,L=q;return U.e=m(k,B,U.e),U.t=m(F,ce,U.t),U.a=m(X,L,U.a),U},{e:void 0,t:void 0,a:void 0}),k})(),(()=>{var k=Bd(),F=k.firstChild,X=F.nextSibling;return a(F,()=>t("common.date")),a(X,()=>O(n().lastModified)),Se(U=>{var B=w,ce=E,L=q;return U.e=m(k,B,U.e),U.t=m(F,ce,U.t),U.a=m(X,L,U.a),U},{e:void 0,t:void 0,a:void 0}),k})()]}}),null),a(Z,R(Ot,{get title(){return t("common.description")},get subtitle(){return t("accounts.accountDetails")},get children(){var k=hE();return k.style.setProperty("margin","0"),k.style.setProperty("color","var(--text-secondary)"),a(k,()=>n().description||t("common.noDataFound")),k}}),null),_})()),Ee(()=>Ee(()=>o()==="transactions")()&&R(Ot,{get title(){return t("accounts.accountHistory")},get subtitle(){return t("accounts.transactions")},get children(){return Ee(()=>P.length===0)()?(()=>{var _=tc();return _.style.setProperty("text-align","center"),_.style.setProperty("color","var(--text-muted)"),_.style.setProperty("padding","2rem"),a(_,()=>t("common.noDataFound")),_})():P.map(_=>(()=>{var z=fE(),Z=z.firstChild,k=Z.firstChild,F=k.nextSibling,X=F.firstChild,U=Z.nextSibling;return m(z,ee),m(Z,W),m(k,K),a(k,()=>_.description),m(F,te),a(F,()=>O(_.date),X),a(F,()=>_.reference,null),a(U,()=>_.type==="debit"?"+":"-",null),a(U,()=>T(_.type==="debit"?_.debitAmount:_.creditAmount),null),Se(B=>m(U,$(_.type),B)),z})())}}))]}})};br(["click"]);var yE=he("<div><div><h1></h1><p> </p></div><div><input type=date>"),vs=he("<div><span></span><span>"),gE=he("<div><div></div><div>"),vE=he("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),bE=he("<div><div> (<!> = <!> + <!>)</div><div> = "),_E=he("<span>(<!>: <!>)");const SE=()=>{const{t}=or(),[e,r]=Ce(new Date().toISOString().split("T")[0]),[n,i]=Ce(0),[o,s]=Ce(0),[l,c]=Ce(0);wn(()=>{u()});const u=()=>{const x=kr.getAccountsByType("Asset"),S=kr.getAccountsByType("Liability"),w=kr.getAccountsByType("Equity"),E=x.reduce((W,K)=>W+K.balance,0),q=S.reduce((W,K)=>W+K.balance,0),ee=w.reduce((W,K)=>W+K.balance,0);i(E),s(q),c(ee)},h=x=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(x),y={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},g={"margin-bottom":"2rem"},f={"font-weight":"bold","font-size":"1.1rem","border-top":"2px solid var(--border-color)","padding-top":"0.5rem","margin-top":"1rem"};return R(to,{get title(){return t("balanceSheet.title")},get children(){return[(()=>{var x=yE(),S=x.firstChild,w=S.firstChild,E=w.nextSibling,q=E.firstChild,ee=S.nextSibling,W=ee.firstChild;return m(x,y),w.style.setProperty("margin","0"),a(w,()=>t("balanceSheet.title")),E.style.setProperty("margin","0.5rem 0 0 0"),E.style.setProperty("color","var(--text-muted)"),a(E,()=>t("balanceSheet.asOf"),q),a(E,()=>new Date(e()).toLocaleDateString(),null),ee.style.setProperty("display","flex"),ee.style.setProperty("gap","1rem"),W.addEventListener("change",K=>r(K.target.value)),W.style.setProperty("padding","0.5rem"),W.style.setProperty("border","1px solid var(--border-color)"),W.style.setProperty("border-radius","var(--border-radius-sm)"),a(ee,R(ht,{variant:"primary",onClick:u,get children(){return t("balanceSheet.generateReport")}}),null),Se(()=>W.value=e()),x})(),(()=>{var x=gE(),S=x.firstChild,w=S.nextSibling;return x.style.setProperty("display","grid"),x.style.setProperty("grid-template-columns","1fr 1fr"),x.style.setProperty("gap","2rem"),a(S,R(Ot,{get title(){return t("balanceSheet.assets")},style:g,get children(){return[(()=>{var E=vs(),q=E.firstChild,ee=q.nextSibling;return E.style.setProperty("display","flex"),E.style.setProperty("justify-content","space-between"),E.style.setProperty("align-items","center"),a(q,()=>t("balanceSheet.currentAssets")),a(ee,()=>h(n()*.6)),E})(),(()=>{var E=vs(),q=E.firstChild,ee=q.nextSibling;return E.style.setProperty("display","flex"),E.style.setProperty("justify-content","space-between"),E.style.setProperty("align-items","center"),a(q,()=>t("balanceSheet.nonCurrentAssets")),a(ee,()=>h(n()*.4)),E})(),(()=>{var E=vs(),q=E.firstChild,ee=q.nextSibling;return a(q,()=>t("balanceSheet.totalAssets")),a(ee,()=>h(n())),Se(W=>m(E,{...f,display:"flex","justify-content":"space-between"},W)),E})()]}})),a(w,R(Ot,{get title(){return t("balanceSheet.liabilities")},style:g,get children(){return[(()=>{var E=vs(),q=E.firstChild,ee=q.nextSibling;return E.style.setProperty("display","flex"),E.style.setProperty("justify-content","space-between"),E.style.setProperty("align-items","center"),a(q,()=>t("balanceSheet.currentLiabilities")),a(ee,()=>h(o()*.7)),E})(),(()=>{var E=vs(),q=E.firstChild,ee=q.nextSibling;return E.style.setProperty("display","flex"),E.style.setProperty("justify-content","space-between"),E.style.setProperty("align-items","center"),a(q,()=>t("balanceSheet.nonCurrentLiabilities")),a(ee,()=>h(o()*.3)),E})(),(()=>{var E=vs(),q=E.firstChild,ee=q.nextSibling;return a(q,()=>t("balanceSheet.totalLiabilities")),a(ee,()=>h(o())),Se(W=>m(E,{...f,display:"flex","justify-content":"space-between"},W)),E})()]}}),null),a(w,R(Ot,{get title(){return t("balanceSheet.equity")},get children(){return[(()=>{var E=vs(),q=E.firstChild,ee=q.nextSibling;return E.style.setProperty("display","flex"),E.style.setProperty("justify-content","space-between"),E.style.setProperty("align-items","center"),a(q,()=>t("balanceSheet.commonStock")),a(ee,()=>h(l()*.8)),E})(),(()=>{var E=vs(),q=E.firstChild,ee=q.nextSibling;return E.style.setProperty("display","flex"),E.style.setProperty("justify-content","space-between"),E.style.setProperty("align-items","center"),a(q,()=>t("balanceSheet.retainedEarnings")),a(ee,()=>h(l()*.2)),E})(),(()=>{var E=vs(),q=E.firstChild,ee=q.nextSibling;return a(q,()=>t("balanceSheet.totalEquity")),a(ee,()=>h(l())),Se(W=>m(E,{...f,display:"flex","justify-content":"space-between"},W)),E})()]}}),null),x})(),R(Ot,{get title(){return t("dashboard.overview")},style:{"margin-top":"2rem"},get children(){return[(()=>{var x=vE(),S=x.firstChild,w=S.firstChild,E=w.nextSibling,q=S.nextSibling,ee=q.firstChild,W=ee.nextSibling,K=q.nextSibling,te=K.firstChild,$=te.nextSibling;return x.style.setProperty("display","grid"),x.style.setProperty("grid-template-columns","repeat(3, 1fr)"),x.style.setProperty("gap","2rem"),S.style.setProperty("text-align","center"),w.style.setProperty("font-size","0.875rem"),w.style.setProperty("color","var(--text-muted)"),w.style.setProperty("margin-bottom","0.5rem"),a(w,()=>t("balanceSheet.totalAssets")),E.style.setProperty("font-size","1.5rem"),E.style.setProperty("font-weight","bold"),E.style.setProperty("color","var(--primary-color)"),a(E,()=>h(n())),q.style.setProperty("text-align","center"),ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-muted)"),ee.style.setProperty("margin-bottom","0.5rem"),a(ee,()=>t("balanceSheet.totalLiabilities")),W.style.setProperty("font-size","1.5rem"),W.style.setProperty("font-weight","bold"),W.style.setProperty("color","#f44336"),a(W,()=>h(o())),K.style.setProperty("text-align","center"),te.style.setProperty("font-size","0.875rem"),te.style.setProperty("color","var(--text-muted)"),te.style.setProperty("margin-bottom","0.5rem"),a(te,()=>t("balanceSheet.totalEquity")),$.style.setProperty("font-size","1.5rem"),$.style.setProperty("font-weight","bold"),$.style.setProperty("color","#4caf50"),a($,()=>h(l())),x})(),(()=>{var x=bE(),S=x.firstChild,w=S.firstChild,E=w.nextSibling,q=E.nextSibling,ee=q.nextSibling,W=ee.nextSibling,K=W.nextSibling;K.nextSibling;var te=S.nextSibling,$=te.firstChild;return x.style.setProperty("margin-top","2rem"),x.style.setProperty("text-align","center"),S.style.setProperty("font-size","0.875rem"),S.style.setProperty("color","var(--text-muted)"),S.style.setProperty("margin-bottom","0.5rem"),a(S,()=>t("common.total"),w),a(S,()=>t("balanceSheet.totalAssets"),E),a(S,()=>t("balanceSheet.totalLiabilities"),ee),a(S,()=>t("balanceSheet.totalEquity"),K),te.style.setProperty("font-size","1.2rem"),te.style.setProperty("font-weight","bold"),a(te,()=>h(n()),$),a(te,()=>h(o()+l()),null),a(te,(()=>{var C=Ee(()=>Math.abs(n()-(o()+l()))>.01);return()=>C()&&(()=>{var T=_E(),O=T.firstChild,b=O.nextSibling,P=b.nextSibling,_=P.nextSibling;return _.nextSibling,T.style.setProperty("font-size","0.875rem"),T.style.setProperty("color","#f44336"),T.style.setProperty("display","block"),a(T,()=>t("common.error"),b),a(T,()=>h(n()-(o()+l())),_),T})()})(),null),Se(C=>(C=Math.abs(n()-(o()+l()))<.01?"#4caf50":"#f44336")!=null?te.style.setProperty("color",C):te.style.removeProperty("color")),x})()]}})]}})};br(["click"]);const PE="modulepreload",wE=function(t){return"/"+t},p0={},Bi=function(e,r,n){let i=Promise.resolve();if(r&&r.length>0){let s=function(u){return Promise.all(u.map(h=>Promise.resolve(h).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");i=s(r.map(u=>{if(u=wE(u),u in p0)return;p0[u]=!0;const h=u.endsWith(".css"),y=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${y}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":PE,h||(g.as="script"),g.crossOrigin="",g.href=u,c&&g.setAttribute("nonce",c),document.head.appendChild(g),h)return new Promise((f,x)=>{g.addEventListener("load",f),g.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${u}`)))})}))}function o(s){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=s,window.dispatchEvent(l),!l.defaultPrevented)throw s}return i.then(s=>{for(const l of s||[])l.status==="rejected"&&o(l.reason);return e().catch(o)})},xE=[{id:"YY_8802",code:"YY_8802",name:"CENTER",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8803",code:"YY_8803",name:"BISSONNET",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8804",code:"YY_8804",name:"IRVIN",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8805",code:"YY_8805",name:"KATTY",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8816",code:"YY_8816",type:"store",name:"YABA GLOBAL",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8818",code:"YY_8818",type:"store",name:"YABASURAUSTIN",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8847",code:"YY_8847",type:"store",name:"YABAOFICINA AZ",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_3251",code:"YY_3251",type:"store",name:"YABA FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_32",code:"YY_32",type:"store",name:"YABA MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_76",code:"YY_76",type:"store",name:"YABA DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_2376",code:"YY_2376",type:"store",name:"YABA SAN ANTONIO",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2025-08-14"},{id:"YY_79",code:"YY_79",type:"warehouse",name:"ALMACEN DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8635",code:"YY_8635",type:"store",name:"FASHION MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8665",code:"YY_8665",name:"IRVIN FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,type:"store",createdDate:"2024-01-01"},{id:"YY_8901",code:"YY_8901",name:"ALMACEN CENTRAL YABA",bussinesId:"YB100423253156428",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01"}],AE=[{id:"1",name:'MacBook Pro 16"',price:2399,quantity:75,category:"Electronics",description:"Apple MacBook Pro 16-inch with M2 Pro chip",sku:"MBP-16-M2P",supplier:"Apple Inc.",minStock:10,location:"Warehouse A",lastUpdated:"2024-01-15"},{id:"2",name:'Dell Monitor 27"',price:299,quantity:35,category:"Electronics",description:"Dell 27-inch 4K UHD Monitor",sku:"DELL-MON-27-4K",supplier:"Dell Technologies",minStock:15,location:"Warehouse B",lastUpdated:"2024-01-14"},{id:"3",name:"Wireless Mouse",price:49.99,quantity:12,category:"Accessories",description:"Ergonomic wireless mouse with precision tracking",sku:"MOUSE-WL-001",supplier:"Logitech",minStock:25,location:"Warehouse A",lastUpdated:"2024-01-13"}],jd=()=>{const t=new Map;return Ri().forEach(e=>{const r=`${e.productId}-${e.locationId}`;let n=ut.getLocationById(e.locationId),i=t.get(r);i||(i={id:r,productId:e.productId,locationId:e.locationId,locationName:n?.name,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,i)),e.movementType==="in"||e.movementType==="transfer"?(e.locationId===e.toLocationId||e.movementType==="in")&&(i.quantity+=e.quantity*1):e.movementType==="out"?i.quantity-=e.quantity*1:e.movementType==="adjustment"&&(i.quantity=e.quantity*1),new Date(e.createdDate)>new Date(i.lastMovementDate)&&(i.lastMovementDate=e.createdDate,i.lastMovementType=e.movementType),i.averageCost=e.unitCost*1,i.availableQuantity=i.quantity*1-i.reservedQuantity*1}),Array.from(t.values())},[rl,of]=Ce([]),[ca,f0]=Ce(xE),[Ri,Vd]=Ce([]),[ua,tu]=Ce([]),[qd,sf]=Ce(AE),CE={TRANSFER:1,transfer:1},m0=173442384e4,ut={get products(){return rl()},get locations(){return ca()},get movements(){return Ri()},get stockLevels(){return ua()},parseInventoryData:t=>{const e=Object.keys(t).slice(0,900),r=[],n=i=>{let o=t;o[i]?.products&&o[i]?.products?.map(s=>{let l=PP(o[i]?.type),c=s?.price*1||s?.unitCost*1,u=s?.qty*1||s?.quantity*1;c=isNaN(c)?0:c,u=isNaN(u)?0:u;let h={id:o[i]?.ssg_inventory_key,productId:s?.product?.id,productName:s?.product?.label,productSku:s?.product?.code,locationId:o[i]?.store,locationName:o[i]?.store,location:o[i]?.store,movementType:l,quantity:u,unitCost:c,totalCost:c*1*u,minStock:10,referenceNumber:"PO-001",notes:o[i]?.description||o[i]?.notes,createdBy:"admin",createdDate:o[i]?.createDate?new Date(o[i]?.createDate).toISOString():new Date(m0).toISOString(),invoiceId:o[i]?.invoice};if(r.push(h),CE[o[i].movementType]&&o[i]?.fromLocationId){let y=ut.getLocationById(o[i]?.fromLocationId);const g={id:o[i]?.ssg_inventory_key,productId:s?.product?.id,productName:s?.product?.label,productSku:s?.product?.code,locationId:o[i]?.fromLocationId,locationName:y?.name||"",movementType:"out",quantity:u*-1,unitCost:c,totalCost:c*-1*u,minStock:10,referenceNumber:o[i]?.referenceNumber,notes:`Transfer to ${o[i]?.locationName}`+(o[i].notes?` - ${o[i].notes}`:""),createdBy:o[i].createdBy,createdDate:o[i]?.createDate?new Date(o[i]?.createDate).toISOString():new Date(m0).toISOString(),invoiceId:o[i]?.invoiceId,toLocationId:o[i]?.locationId,toLocationName:o[i]?.locationName};r.push(g)}})};return e.map(n),r},fecthInventory:async t=>{const e=await vi.getInventory(t),r=ut.parseInventoryData(e);ut.updMovements(r)},getStockLevels:async t=>{const e=await zy.getStockLevels(t);tu(e)},fecthProduct:async t=>{const e=await vi.getProducts(t),r=Object.keys(e),n=o=>{let s=e;return{id:o,name:s[o].name,businessId:s[o].businessId,sku:s[o].code,UPC:s[o].UPC,numCode:s[o].codeN,category:s[o].category,unitCost:s[o].unitCost||0,unitOfMeasure:s[o].unitOfMeasure||s[o].unit,minStockLevel:s[o].minStockLevel,maxStockLevel:s[o].maxStockLevel,isActive:s[o].isActive,productImageUrl:s[o].productImageUrl,description:s[o].description||"",createdDate:s[o].createdAt||new Date().toISOString(),lastModified:s[o].updatedAt||new Date().toISOString()}},i=r.map(n);return ut.updProduct(i),i},getProductById:t=>rl().find(e=>e.id===t),updProduct:t=>{of(t)},getProductsBySku:t=>rl().filter(e=>e.sku.toLowerCase().includes(t.toLowerCase())),getProductsByCategory:t=>rl().filter(e=>e.category===t),getActiveProducts:()=>rl().filter(t=>t.name),getLocationById:t=>ca().find(e=>e.id===t),getLocationsByType:t=>ca().filter(e=>e.type===t),getActiveLocations:()=>{if(pr?.state?.profile?.isAdmin)return ca();let t=pr?.state?.profile?.stores;return ca().filter(e=>t?.[e?.id])},getMovementsByProduct:t=>Ri().filter(e=>e.productId===t),updMovements:t=>{Vd([...t]),tu(jd())},getMovementsByLocation:t=>Ri()?.filter(e=>e.locationId===t),getMovementsByDateRange:(t,e)=>Ri()?.filter(r=>r.createdDate>=t&&r.createdDate<=e),getStockByProduct:t=>ua()?.filter(e=>e.productId===t),getStockByLocation:t=>ua()?.filter(e=>e.locationId===t),getStockByProductAndLocation:(t,e)=>ua()?.find(r=>r.productId===t&&r.locationId===e),getTotalStockByProduct:t=>ua()?.filter(e=>e.productId===t).reduce((e,r)=>e*1+r.quantity*1,0),getLastLocationByProduct:t=>{const e=Ri()?.filter(r=>r.productId===t).sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime());if(e.length>0)return ca().find(r=>r.id===e[0].locationId)},getLowStockProducts:()=>(rl()||[])?.map(t=>{const e=ua()?.filter(r=>r.productId===t.id).reduce((r,n)=>r+n.quantity,0)||0;return{...t,currentStock:e}}).filter(t=>t.currentStock<=t.minStockLevel),generateMovementInvoice:async(t,e,r,n="compact")=>{try{const{getUserLanguage:i}=await Bi(async()=>{const{getUserLanguage:h}=await import("./languageUtils-BVmHbHaj.js");return{getUserLanguage:h}},[]),o=r||i();let s;switch(n){case"compact":const{generateCompactModernInvoicePDF:h}=await Bi(async()=>{const{generateCompactModernInvoicePDF:f}=await import("./compactModernInvoicePdfGenerator-C-YiLG_Q.js");return{generateCompactModernInvoicePDF:f}},[]);s=h;break;case"modern":const{generateModernMovementInvoicePDF:y}=await Bi(async()=>{const{generateModernMovementInvoicePDF:f}=await import("./modernMovementInvoicePdfGenerator-B55SF2RU.js");return{generateModernMovementInvoicePDF:f}},[]);s=y;break;case"classic":default:const{generateMovementInvoicePDF:g}=await Bi(async()=>{const{generateMovementInvoicePDF:f}=await import("./movementInvoicePdfGenerator-kS0oVeW_.js");return{generateMovementInvoicePDF:f}},[]);s=g;break}const l=Ri().filter(h=>h.invoiceId===t||h.id===t);if(l.length===0)throw new Error(`No movements found with ID: ${t}`);const c=l.reduce((h,y)=>{const g=y.invoiceId||y.id;return h[g]||(h[g]={invoiceId:g,movementType:y.movementType,referenceNumber:y.referenceNumber,createdBy:y.createdBy,createdDate:y.createdDate,locationName:y.locationName,fromLocationName:y.fromLocationName,toLocationName:y.toLocationName,notes:y.notes,items:[]}),h[g].items.push({productSku:y.productSku,productName:y.productName,quantity:y.quantity,unitCost:y.unitCost,totalCost:y.totalCost,receivedQuantity:y.movementType==="transfer"?null:void 0}),h},{}),u=[];for(const[h,y]of Object.entries(c)){const g=await s(y,e,o);u.push(g)}return u}catch(i){throw console.error("Error generating movement invoice:",i),i}},getMovementsByInvoiceId:t=>Ri().filter(e=>e.invoiceId===t),generateCompactMovementInvoice:async(t,e,r)=>ut.generateMovementInvoice(t,e,r,"compact"),generateModernMovementInvoice:async(t,e,r)=>ut.generateMovementInvoice(t,e,r,"modern"),generateClassicMovementInvoice:async(t,e,r)=>ut.generateMovementInvoice(t,e,r,"classic"),getMovementInvoiceData:t=>{const e=Ri().filter(i=>i.invoiceId===t||i.id===t);if(e.length===0)return null;const r=e[0],n=e.reduce((i,o)=>i+(o.totalCost||o.quantity*o.unitCost),0);return{invoiceId:r.invoiceId||r.id,movementType:r.movementType,referenceNumber:r.referenceNumber,createdBy:r.createdBy,createdDate:r.createdDate,locationName:r.locationName,fromLocationName:r.fromLocationName,toLocationName:r.toLocationName,notes:r.notes,totalValue:n,itemCount:e.length,items:e.map(i=>({productSku:i.productSku,productName:i.productName,quantity:i.quantity,unitCost:i.unitCost,totalCost:i.totalCost||i.quantity*i.unitCost}))}},addInventoryMovement:t=>{const e={...t,id:`mov-${Date.now()}`,createdDate:new Date().toISOString()};Vd(r=>[...r,e]),tu(jd())},addBulkInventoryMovements:async t=>{const e=[],r=[],n=new Date().toISOString(),i=ca().find(l=>l.id===t.locationId);if(!i)return{success:!1,errors:["Invalid location"]};let o;if(t.movementType==="transfer"){if(!t.fromLocationId)return{success:!1,errors:["From location required for transfers"]};if(o=ca().find(l=>l.id===t.fromLocationId),!o)return{success:!1,errors:["Invalid from location"]};if(t.fromLocationId===t.locationId)return{success:!1,errors:["From and to locations cannot be the same"]}}if(t.items.forEach((l,c)=>{const u=rl().find(f=>f.id===l.productId);if(!u){e.push(`Item ${c+1}: Product not found`);return}if(l.quantity<=0){e.push(`Item ${c+1}: Quantity must be greater than 0`);return}if(t.movementType==="out"){const f=ua().filter(x=>x.productId===l.productId&&x.locationId===t.locationId).reduce((x,S)=>x+S.quantity,0);if(l.quantity>f){e.push(`Item ${c+1}: Insufficient stock. Available: ${f}, Requested: ${l.quantity}`);return}}if(t.movementType==="transfer"){const f=ua().filter(x=>x.productId===l.productId&&x.locationId===t.fromLocationId).reduce((x,S)=>x+S.quantity,0);if(l.quantity>f){e.push(`Item ${c+1}: Insufficient stock at ${o?.name}. Available: ${f}, Requested: ${l.quantity}`);return}}const h=l.unitCost||u.unitCost,y=l.quantity*h,g={id:`mov-${Date.now()}-${c}`,productId:u.id,productName:u.name,productSku:u.sku,locationId:t.locationId,locationName:i.name,movementType:t.movementType,quantity:l.quantity,unitCost:h,totalCost:y,minStock:10,referenceNumber:t.referenceNumber||"",notes:l.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:o?.name};if(r.push(g),t.movementType==="transfer"&&o){const f={id:`mov-${Date.now()}-${c}-out`,productId:u.id,productName:u.name,productSku:u.sku,locationId:t.fromLocationId,locationName:o.name,movementType:"out",quantity:l.quantity,unitCost:h,totalCost:y,minStock:10,referenceNumber:t.referenceNumber||"",notes:`Transfer to ${i.name}`+(l.notes?` - ${l.notes}`:""),createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,toLocationId:t.locationId,toLocationName:i.name};r.push(f)}}),e.length>0)return{success:!1,errors:e};Vd(l=>[...l,...r]),tu(jd()),console.log({bulkRequest:t});const s=await vi.addInventory(t);return console.log({prodResults:s}),{success:!0,errors:[]}},getMovementsByInvoice:t=>Ri().filter(e=>e.invoiceId===t),getInvoiceSummary:t=>{const e=Ri().filter(o=>o.invoiceId===t);if(e.length===0)return null;const r=e.reduce((o,s)=>o+s.totalCost,0),n=new Set(e.map(o=>o.productId)).size,i=e[0];return{invoiceId:t,referenceNumber:i.referenceNumber,movementType:i.movementType,location:i.locationName,fromLocation:i.fromLocationName,productCount:n,totalItems:e.reduce((o,s)=>o+s.quantity,0),totalValue:r,createdDate:i.createdDate,createdBy:i.createdBy}},addProduct:t=>{const e={...t,id:`prod-${Date.now()}`,createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};of(r=>[...r,e])},addLocation:t=>{const e={...t,id:`loc-${Date.now()}`,createdDate:new Date().toISOString()};f0(r=>[...r,e])},updateProduct:(t,e)=>{of(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n))},updateLocation:(t,e)=>{f0(r=>r.map(n=>n.id===t?{...n,...e}:n))},updateMovement:(t,e)=>{Vd(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n)),tu(jd())},get inventory(){return qd()},addItem(t){const e={...t,id:Date.now().toString(),lastUpdated:new Date().toISOString().split("T")[0]};return sf([...qd(),e]),e},updateItem(t,e){sf(qd().map(r=>r.id===t?{...r,...e,lastUpdated:new Date().toISOString().split("T")[0]}:r))},deleteItem(t){sf(qd().filter(e=>e.id!==t))},getItemById(t){return Ri().find(e=>e.id===t)},getLowStockItems(){return Ri().filter(t=>t.quantity*1<=t.minStock*1)},getTotalValue(){return Ri().reduce((t,e)=>t*1+e.unitCost*1*e.quantity*1,0)}};var y0=he("<div>"),IE=he("<div><div><input type=text autocomplete=off>"),$E=he("<button type=button>+"),EE=he("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>");const gp=t=>{const{t:e}=or(),[r,n]=Ce(!1),[i,o]=Ce(""),[s,l]=Ce(-1),c=Mt(()=>t.value?ut.getProductById(t.value):null),u=Mt(()=>{const Z=i().toLowerCase();return Z?ut.getActiveProducts().filter(k=>k.name.toLowerCase().includes(Z)||k.sku.toLowerCase().includes(Z)||k?.UPC?.toLowerCase().includes(Z)||k.category.toLowerCase().includes(Z)):ut.getActiveProducts()}),h=()=>{n(!0),o(""),l(-1)},y=Z=>{const k=Z.target;o(k.value),n(!0),l(-1)},g=Z=>{t.onChange(Z),n(!1),o(""),l(-1)},f=Z=>{const k=u();switch(Z.key){case"ArrowDown":Z.preventDefault(),l(F=>Math.min(F+1,k.length-1));break;case"ArrowUp":Z.preventDefault(),l(F=>Math.max(F-1,-1));break;case"Enter":Z.preventDefault(),s()>=0&&k[s()]&&g(k[s()]);break;case"Escape":n(!1),o(""),l(-1);break}},x=Z=>{setTimeout(()=>{n(!1),o(""),l(-1)},150)},S=Z=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Z),w=Z=>ut.stockLevels.filter(k=>k.productId===Z).reduce((k,F)=>k+F.quantity,0),E={position:"relative",width:"100%",...t.style},q={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},ee={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},W=Z=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid "+Z?"var(--primary-color)":"var(--border-color)",background:Z?"var(--strip-color)":"transparent",color:Z?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),K={display:"flex","justify-content":"space-between","align-items":"center"},te={flex:"1"},$={"font-weight":"500","margin-bottom":"0.25rem"},C={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},T={"text-align":"right","font-size":"0.875rem"},O={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},b=()=>r()&&i()?i():c()?`${c().name} (${c().sku})`:"",P={display:"flex","align-items":"stretch",width:"100%"},_={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},z={...q,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"};return(()=>{var Z=IE(),k=Z.firstChild,F=k.firstChild;return m(k,P),F.addEventListener("blur",x),F.$$keydown=f,F.$$click=h,F.$$input=y,a(k,(()=>{var X=Ee(()=>!!t.onAddNew);return()=>X()&&(()=>{var U=$E();return U.addEventListener("mouseleave",B=>{B.currentTarget.style.background="var(--surface-color)",B.currentTarget.style.color="var(--primary-color)"}),U.addEventListener("mouseenter",B=>{B.currentTarget.style.background="var(--primary-color)",B.currentTarget.style.color="white"}),is(U,"click",t.onAddNew,!0),m(U,_),Se(()=>tr(U,"title",e("inventory.addProduct","Add new product"))),U})()})(),null),a(Z,R(ze,{get when(){return r()},get children(){var X=y0();return a(X,R(ze,{get when(){return u().length>0},get fallback(){return(()=>{var U=y0();return m(U,O),a(U,(()=>{var B=Ee(()=>!!i());return()=>B()?e("inventory.noProductsFound","No products found matching your search."):e("inventory.noProductsAvailable","No products available.")})()),U})()},get children(){return R(Ut,{get each(){return u()},children:(U,B)=>{const ce=w(U.id),L=ce<=U.minStockLevel;return(()=>{var D=EE(),j=D.firstChild,I=j.firstChild,M=I.firstChild,J=M.nextSibling,H=J.firstChild,Q=H.firstChild,se=H.nextSibling,G=se.nextSibling,re=G.nextSibling,oe=re.nextSibling,fe=I.nextSibling,ae=fe.firstChild,Y=ae.firstChild,ie=ae.nextSibling;return D.addEventListener("mouseenter",()=>l(B())),D.$$click=()=>g(U),m(j,K),m(I,te),m(M,$),a(M,()=>U.name),m(J,C),a(H,()=>e("inventory.sku","SKU"),Q),a(H,()=>U.sku,null),a(G,()=>U.category),a(oe,()=>S(U.unitCost)),m(fe,T),ae.style.setProperty("font-weight","600"),(L?"#f44336":"var(--text-primary)")!=null?ae.style.setProperty("color",L?"#f44336":"var(--text-primary)"):ae.style.removeProperty("color"),a(ae,ce,Y),a(ae,()=>U.unitOfMeasure,null),ie.style.setProperty("color","var(--text-muted)"),a(ie,()=>L?e("inventory.lowStock","Low Stock"):e("inventory.inStock","In Stock")),Se(de=>m(D,W(B()===s()),de)),D})()}})}})),Se(U=>m(X,ee,U)),X}}),null),Se(X=>{var U=E,B=z,ce=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),L=t.disabled,D=t.required;return X.e=m(Z,U,X.e),X.t=m(F,B,X.t),ce!==X.a&&tr(F,"placeholder",X.a=ce),L!==X.o&&(F.disabled=X.o=L),D!==X.i&&(F.required=X.i=D),X},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>F.value=b()),Z})()};br(["input","click","keydown"]);var g0=he("<div>"),TE=he("<div><div><input type=text autocomplete=off>"),kE=he("<button type=button>+"),NE=he("<div><div><div><div> </div><div><span>: </span><span></span></div><div>");const zu=t=>{const{t:e}=or(),[r,n]=Ce(!1),[i,o]=Ce(""),[s,l]=Ce(-1),c=Mt(()=>t.value?ut.getLocationById(t.value):null),u=Mt(()=>{let Z=ut.getActiveLocations();t.filterType&&(Z=Z.filter(F=>F.type===t.filterType));const k=i().toLowerCase();return k?Z.filter(F=>F.name.toLowerCase().includes(k)||F?.code?.toLowerCase().includes(k)||F?.type?.toLowerCase().includes(k)||F?.address?.toLowerCase().includes(k)):Z}),h=()=>{n(!0),o(""),l(-1)},y=Z=>{const k=Z.target;o(k.value),n(!0),l(-1)},g=Z=>{t.onChange(Z.id),n(!1),o(""),l(-1)},f=Z=>{const k=u();switch(Z.key){case"ArrowDown":Z.preventDefault(),l(F=>Math.min(F+1,k.length-1));break;case"ArrowUp":Z.preventDefault(),l(F=>Math.max(F-1,-1));break;case"Enter":Z.preventDefault(),s()>=0&&k[s()]&&g(k[s()]);break;case"Escape":n(!1),o(""),l(-1);break}},x=Z=>{setTimeout(()=>{n(!1),o(""),l(-1)},150)},S=Z=>({warehouse:"🏭",store:"🏪",supplier:"🚚",customer:"👥"})[Z]||"📍",w=Z=>({warehouse:"#2196F3",store:"#4CAF50",supplier:"#FF9800",customer:"#9C27B0"})[Z]||"#757575",E={position:"relative",width:"100%",...t.style},q={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},ee={display:"flex","align-items":"stretch",width:"100%"},W={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},K={...q,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"},te={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},$=Z=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:Z?"var(--strip-color)":"transparent",color:Z?"var(--primary-dark)":"var(--text-primary)",transition:"all 0.2s ease"}),C={display:"flex","justify-content":"space-between","align-items":"center"},T={flex:"1"},O={"font-weight":"500","margin-bottom":"0.25rem"},b={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem","align-items":"center"},P=Z=>({padding:"0.2rem 0.5rem","border-radius":"var(--border-radius-sm)","font-size":"0.7rem","font-weight":"500",background:w(Z),color:"white","text-transform":"uppercase"}),_={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},z=()=>r()&&i()?i():c()?`${c().name} (${c().code})`:"";return(()=>{var Z=TE(),k=Z.firstChild,F=k.firstChild;return m(k,ee),F.addEventListener("blur",x),F.$$keydown=f,F.$$click=h,F.$$input=y,a(k,(()=>{var X=Ee(()=>!!t.onAddNew);return()=>X()&&(()=>{var U=kE();return U.addEventListener("mouseleave",B=>{B.currentTarget.style.background="var(--surface-color)",B.currentTarget.style.color="var(--primary-color)"}),U.addEventListener("mouseenter",B=>{B.currentTarget.style.background="var(--primary-color)",B.currentTarget.style.color="white"}),is(U,"click",t.onAddNew,!0),m(U,W),Se(()=>tr(U,"title",e("inventory.addLocation","Add new location"))),U})()})(),null),a(Z,R(ze,{get when(){return r()},get children(){var X=g0();return a(X,R(ze,{get when(){return u().length>0},get fallback(){return(()=>{var U=g0();return m(U,_),a(U,(()=>{var B=Ee(()=>!!i());return()=>B()?e("inventory.noLocationsFound","No locations found matching your search."):e("inventory.noLocationsAvailable","No locations available.")})()),U})()},get children(){return R(Ut,{get each(){return u()},children:(U,B)=>(()=>{var ce=NE(),L=ce.firstChild,D=L.firstChild,j=D.firstChild,I=j.firstChild,M=j.nextSibling,J=M.firstChild,H=J.firstChild,Q=J.nextSibling,se=M.nextSibling;return ce.addEventListener("mouseenter",()=>l(B())),ce.$$click=()=>g(U),m(L,C),m(D,T),m(j,O),a(j,()=>S(U.type),I),a(j,()=>U.name,null),m(M,b),a(J,()=>e("inventory.locationCode","Code"),H),a(J,()=>U.code,null),a(Q,()=>U.type),se.style.setProperty("font-size","0.75rem"),se.style.setProperty("color","var(--text-muted)"),se.style.setProperty("margin-top","0.25rem"),a(se,()=>U.address),Se(G=>{var re=$(B()===s()),oe=P(U.type);return G.e=m(ce,re,G.e),G.t=m(Q,oe,G.t),G},{e:void 0,t:void 0}),ce})()})}})),Se(U=>m(X,te,U)),X}}),null),Se(X=>{var U=E,B=K,ce=t.placeholder||e("inventory.searchLocations","Search locations by name, code, or type..."),L=t.disabled,D=t.required;return X.e=m(Z,U,X.e),X.t=m(F,B,X.t),ce!==X.a&&tr(F,"placeholder",X.a=ce),L!==X.o&&(F.disabled=X.o=L),D!==X.i&&(F.required=X.i=D),X},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>F.value=z()),Z})()};br(["input","click","keydown"]);var LE=he("<form><div><label> *</label><input type=text required></div><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text list=categories required><datalist id=categories><option value=Electronics></option><option value=Accessories></option><option value=Office></option><option value=Furniture></option><option value=Software></option><option value=Hardware></option></datalist></div></div><div><label></label><textarea></textarea></div><div><div><label></label><select><option value=pcs></option><option value=kg></option><option value=lbs></option><option value=m></option><option value=ft></option><option value=l></option><option value=gal></option><option value=box></option><option value=pack></option></select></div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div></div><div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div><div></div></div><div><div><label></label><input type=number min=0 step=1></div><div><label></label><input type=number min=1 step=1></div></div><div>"),RE=he("<div>");const Uy=t=>{const{t:e}=or(),[r,n]=Ce(""),[i,o]=Ce(""),[s,l]=Ce(""),[c,u]=Ce(""),[h,y]=Ce("pcs"),[g,f]=Ce(0),[x,S]=Ce(0),[w,E]=Ce(10),[q,ee]=Ce(100),[W,K]=Ce(""),te=()=>{n(""),o(""),l(""),u(""),y("pcs"),f(0),S(0),E(10),ee(100),K("")},$=k=>{if(k.preventDefault(),K(""),!r().trim()){K(e("forms.productNameRequired"));return}if(!i().trim()){K(e("forms.skuRequired"));return}if(!c().trim()){K(e("forms.categoryRequired"));return}if(g()<0){K(e("forms.unitCostNotNegative"));return}if(x()<0){K(e("forms.sellingPriceNotNegative"));return}if(w()<0){K(e("forms.minStockNotNegative"));return}if(q()<=w()){K(e("forms.maxStockGreaterThanMin"));return}if(ut.getProductsBySku(i()).length>0){K(e("forms.skuAlreadyExists"));return}const X={name:r().trim(),sku:i().trim().toUpperCase(),description:s().trim(),category:c().trim(),unitOfMeasure:h(),unitCost:g(),sellingPrice:x(),minStockLevel:w(),maxStockLevel:q(),isActive:!0,businessId:"default-business"};ut.addProduct(X);const U=`prod-${Date.now()}`;t.onProductAdded&&t.onProductAdded(U),te(),t.onClose()},C=()=>{te(),t.onClose()},T={"margin-bottom":"1.5rem"},O={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},b={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},P={...b,cursor:"pointer"},_={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},z={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},Z={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"};return R(On,{get isOpen(){return t.isOpen},onClose:C,get title(){return e("inventory.addNewProduct")},get children(){var k=LE(),F=k.firstChild,X=F.firstChild,U=X.firstChild,B=X.nextSibling,ce=F.nextSibling,L=ce.firstChild,D=L.firstChild,j=D.firstChild,I=D.nextSibling,M=L.nextSibling,J=M.firstChild,H=J.firstChild,Q=J.nextSibling,se=ce.nextSibling,G=se.firstChild,re=G.nextSibling,oe=se.nextSibling,fe=oe.firstChild,ae=fe.firstChild,Y=ae.nextSibling,ie=Y.firstChild,de=ie.nextSibling,ue=de.nextSibling,ge=ue.nextSibling,Pe=ge.nextSibling,pe=Pe.nextSibling,_e=pe.nextSibling,Le=_e.nextSibling,De=Le.nextSibling,Te=fe.nextSibling,$e=Te.firstChild,Ie=$e.nextSibling,Re=oe.nextSibling,Je=Re.firstChild,Be=Je.firstChild,Ke=Be.nextSibling,Xe=Re.nextSibling,at=Xe.firstChild,ot=at.firstChild,Qe=ot.nextSibling,dt=at.nextSibling,ct=dt.firstChild,kt=ct.nextSibling,gt=Xe.nextSibling;return k.addEventListener("submit",$),a(X,()=>e("inventory.productName"),U),B.addEventListener("change",qe=>n(qe.target.value)),a(D,()=>e("inventory.sku"),j),I.addEventListener("change",qe=>o(qe.target.value)),a(J,()=>e("inventory.category"),H),Q.addEventListener("change",qe=>u(qe.target.value)),a(G,()=>e("common.description")),re.addEventListener("change",qe=>l(qe.target.value)),a(ae,()=>e("inventory.unitOfMeasure")),Y.addEventListener("change",qe=>y(qe.target.value)),a(ie,()=>e("inventory.pieces")),a(de,()=>e("inventory.kilograms")),a(ue,()=>e("inventory.pounds")),a(ge,()=>e("inventory.meters")),a(Pe,()=>e("inventory.feet")),a(pe,()=>e("inventory.liters")),a(_e,()=>e("inventory.gallons")),a(Le,()=>e("inventory.boxes")),a(De,()=>e("inventory.packs")),a($e,()=>e("inventory.unitCost")),Ie.addEventListener("change",qe=>f(Number(qe.target.value))),a(Be,()=>e("inventory.sellingPrice")),Ke.addEventListener("change",qe=>S(Number(qe.target.value))),a(ot,()=>e("inventory.minimumStockLevel")),Qe.addEventListener("change",qe=>E(Number(qe.target.value))),a(ct,()=>e("inventory.maximumStockLevel")),kt.addEventListener("change",qe=>ee(Number(qe.target.value))),a(k,(()=>{var qe=Ee(()=>!!W());return()=>qe()&&(()=>{var Dt=RE();return m(Dt,_),a(Dt,W),Dt})()})(),gt),m(gt,z),a(gt,R(ht,{variant:"secondary",type:"button",onClick:C,get children(){return e("common.cancel")}}),null),a(gt,R(ht,{variant:"primary",type:"submit",get children(){return e("inventory.addProduct")}}),null),Se(qe=>{var Dt=T,Rt=O,St=b,Bt=e("inventory.enterProductName"),fr=Z,Qt=O,cr=b,xr=e("inventory.enterSkuCode"),It=O,Ge=b,Nt=e("inventory.enterCategory"),At=T,Lt=O,Ue={...b,"min-height":"80px",resize:"vertical"},nt=e("inventory.enterProductDescription"),_t=Z,Wt=O,We=P,vt=O,Tt=b,jt=Z,Kt=O,rr=b,yr=Z,nr=O,ur=b,Ft=O,$t=b;return qe.e=m(F,Dt,qe.e),qe.t=m(X,Rt,qe.t),qe.a=m(B,St,qe.a),Bt!==qe.o&&tr(B,"placeholder",qe.o=Bt),qe.i=m(ce,fr,qe.i),qe.n=m(D,Qt,qe.n),qe.s=m(I,cr,qe.s),xr!==qe.h&&tr(I,"placeholder",qe.h=xr),qe.r=m(J,It,qe.r),qe.d=m(Q,Ge,qe.d),Nt!==qe.l&&tr(Q,"placeholder",qe.l=Nt),qe.u=m(se,At,qe.u),qe.c=m(G,Lt,qe.c),qe.w=m(re,Ue,qe.w),nt!==qe.m&&tr(re,"placeholder",qe.m=nt),qe.f=m(oe,_t,qe.f),qe.y=m(ae,Wt,qe.y),qe.g=m(Y,We,qe.g),qe.p=m($e,vt,qe.p),qe.b=m(Ie,Tt,qe.b),qe.T=m(Re,jt,qe.T),qe.A=m(Be,Kt,qe.A),qe.O=m(Ke,rr,qe.O),qe.I=m(Xe,yr,qe.I),qe.S=m(ot,nr,qe.S),qe.W=m(Qe,ur,qe.W),qe.C=m(ct,Ft,qe.C),qe.B=m(kt,$t,qe.B),qe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),Se(()=>B.value=r()),Se(()=>I.value=i()),Se(()=>Q.value=c()),Se(()=>re.value=s()),Se(()=>Y.value=h()),Se(()=>Ie.value=g()),Se(()=>Ke.value=x()),Se(()=>Qe.value=w()),Se(()=>kt.value=q()),k}})};var DE=he('<form><div><label> *</label><input type=text required></div><div><div><label> *<button type=button title="Generate code automatically"></button></label><input type=text required><div></div></div><div><label> *</label><select required><option value=warehouse> </option><option value=store> </option><option value=supplier> </option><option value=customer> </option></select><div></div></div></div><div><label> *</label><textarea required></textarea></div><div>'),ME=he("<div><div>:</div><div><span></span><div><div></div><div>"),FE=he("<div>");const Hy=t=>{const{t:e}=or(),[r,n]=Ce(""),[i,o]=Ce(""),[s,l]=Ce("warehouse"),[c,u]=Ce(""),[h,y]=Ce(""),g=()=>{n(""),o(""),l("warehouse"),u(""),y("")},f=()=>{if(r()){const b=s()==="warehouse"?"WH":s()==="store"?"ST":s()==="supplier"?"SUP":"CUST",P=r().toUpperCase().replace(/[^A-Z0-9]/g,"").substring(0,3),_=String(Math.floor(Math.random()*1e3)).padStart(3,"0");o(`${b}-${P}-${_}`)}},x=b=>{if(b.preventDefault(),y(""),!r().trim()){y(e("forms.locationNameRequired"));return}if(!i().trim()){y(e("forms.locationCodeRequired"));return}if(!c().trim()){y(e("forms.addressRequired"));return}if(ut.locations.filter(Z=>Z.code.toLowerCase()===i().toLowerCase()).length>0){y(e("forms.locationCodeExists"));return}const _={name:r().trim(),code:i().trim().toUpperCase(),type:s(),address:c().trim(),isActive:!0};ut.addLocation(_);const z=`loc-${Date.now()}`;t.onLocationAdded&&t.onLocationAdded(z),g(),t.onClose()},S=()=>{g(),t.onClose()},w={"margin-bottom":"1.5rem"},E={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},q={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},ee={...q,cursor:"pointer"},W={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},K={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},te={display:"grid","grid-template-columns":"2fr 1fr",gap:"1rem"},$={"font-size":"0.875rem",color:"var(--text-muted)","margin-top":"0.25rem"},C={padding:"0.25rem 0.5rem","font-size":"0.75rem","margin-left":"0.5rem",background:"var(--background-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",color:"var(--text-muted)"},T=b=>({warehouse:"🏭",store:"🏪",supplier:"🚚",customer:"👥"})[b]||"📍",O=b=>({warehouse:e("inventory.warehouseDescription"),store:e("inventory.storeDescription"),supplier:e("inventory.supplierDescription"),customer:e("inventory.customerDescription")})[b]||"";return R(On,{get isOpen(){return t.isOpen},onClose:S,get title(){return e("inventory.addNewLocation")},get children(){var b=DE(),P=b.firstChild,_=P.firstChild,z=_.firstChild,Z=_.nextSibling,k=P.nextSibling,F=k.firstChild,X=F.firstChild,U=X.firstChild,B=U.nextSibling,ce=X.nextSibling,L=ce.nextSibling,D=F.nextSibling,j=D.firstChild,I=j.firstChild,M=j.nextSibling,J=M.firstChild,H=J.firstChild,Q=J.nextSibling,se=Q.firstChild,G=Q.nextSibling,re=G.firstChild,oe=G.nextSibling,fe=oe.firstChild,ae=M.nextSibling,Y=k.nextSibling,ie=Y.firstChild,de=ie.firstChild,ue=ie.nextSibling,ge=Y.nextSibling;return b.addEventListener("submit",x),a(_,()=>e("inventory.locationName"),z),Z.addEventListener("change",Pe=>n(Pe.target.value)),m(k,te),a(X,()=>e("inventory.locationCode"),U),B.$$click=f,m(B,C),a(B,()=>e("common.generate")),ce.addEventListener("change",Pe=>o(Pe.target.value)),a(L,()=>e("inventory.uniqueIdentifierHelp")),a(j,()=>e("inventory.locationType"),I),M.addEventListener("change",Pe=>l(Pe.target.value)),a(J,()=>T("warehouse"),H),a(J,()=>e("inventory.warehouse"),null),a(Q,()=>T("store"),se),a(Q,()=>e("inventory.store"),null),a(G,()=>T("supplier"),re),a(G,()=>e("inventory.supplier"),null),a(oe,()=>T("customer"),fe),a(oe,()=>e("inventory.customer"),null),a(ae,()=>O(s())),a(ie,()=>e("common.address"),de),ue.addEventListener("change",Pe=>u(Pe.target.value)),a(b,(()=>{var Pe=Ee(()=>!!r());return()=>Pe()&&(()=>{var pe=ME(),_e=pe.firstChild,Le=_e.firstChild,De=_e.nextSibling,Te=De.firstChild,$e=Te.nextSibling,Ie=$e.firstChild,Re=Ie.nextSibling;return pe.style.setProperty("padding","1rem"),pe.style.setProperty("background","var(--background-color)"),pe.style.setProperty("border-radius","var(--border-radius-sm)"),pe.style.setProperty("border","1px solid var(--border-color)"),pe.style.setProperty("margin-bottom","1rem"),_e.style.setProperty("font-weight","500"),_e.style.setProperty("margin-bottom","0.5rem"),a(_e,()=>e("common.preview"),Le),De.style.setProperty("display","flex"),De.style.setProperty("align-items","center"),De.style.setProperty("gap","0.5rem"),Te.style.setProperty("font-size","1.2rem"),a(Te,()=>T(s())),Ie.style.setProperty("font-weight","600"),a(Ie,r),Re.style.setProperty("font-size","0.875rem"),Re.style.setProperty("color","var(--text-muted)"),a(Re,(()=>{var Je=Ee(()=>!!i());return()=>Je()&&`${i()} • `})(),null),a(Re,s,null),pe})()})(),ge),a(b,(()=>{var Pe=Ee(()=>!!h());return()=>Pe()&&(()=>{var pe=FE();return m(pe,W),a(pe,h),pe})()})(),ge),m(ge,K),a(ge,R(ht,{variant:"secondary",type:"button",onClick:S,get children(){return e("common.cancel")}}),null),a(ge,R(ht,{variant:"primary",type:"submit",get children(){return e("inventory.addLocation")}}),null),Se(Pe=>{var pe=w,_e=E,Le=q,De=e("inventory.enterLocationName"),Te=E,$e=q,Ie=e("inventory.enterUniqueCode"),Re=$,Je=E,Be=ee,Ke=$,Xe=w,at=E,ot={...q,"min-height":"100px",resize:"vertical"},Qe=e("inventory.enterCompleteAddress");return Pe.e=m(P,pe,Pe.e),Pe.t=m(_,_e,Pe.t),Pe.a=m(Z,Le,Pe.a),De!==Pe.o&&tr(Z,"placeholder",Pe.o=De),Pe.i=m(X,Te,Pe.i),Pe.n=m(ce,$e,Pe.n),Ie!==Pe.s&&tr(ce,"placeholder",Pe.s=Ie),Pe.h=m(L,Re,Pe.h),Pe.r=m(j,Je,Pe.r),Pe.d=m(M,Be,Pe.d),Pe.l=m(ae,Ke,Pe.l),Pe.u=m(Y,Xe,Pe.u),Pe.c=m(ie,at,Pe.c),Pe.w=m(ue,ot,Pe.w),Qe!==Pe.m&&tr(ue,"placeholder",Pe.m=Qe),Pe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),Se(()=>Z.value=r()),Se(()=>ce.value=i()),Se(()=>M.value=s()),Se(()=>ue.value=c()),b}})};br(["click"]);var OE=he("<form><div>"),v0=he("<div><label> *"),BE=he("<div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment>"),jE=he("<div><label>"),VE=he("<div><label> *</label><input type=number min=0 step=1 required>"),qE=he("<div><label></label><input type=number min=0 step=0.01>"),zE=he("<div><label></label><input type=text>"),UE=he("<div><label></label><textarea>"),HE=he("<div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span>:</span><span> "),GE=he("<div><div><span>:</span><span>"),WE=he("<div>");const YE=t=>{const{t:e}=or(),[r,n]=Ce({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""}),[i,o]=Ce(""),[s,l]=Ce(""),[c,u]=Ce("in"),[h,y]=Ce(0),[g,f]=Ce(0),[x,S]=Ce(""),[w,E]=Ce(""),[q,ee]=Ce(""),[W,K]=Ce(""),[te,$]=Ce(!1),[C,T]=Ce(!1),O=()=>t.mode==="movement",b=Mt(()=>i()?ut.getProductById(i()):null),P=Mt(()=>s()?ut.getLocationById(s()):null),_=Mt(()=>q()?ut.getLocationById(q()):null),z=Mt(()=>h()*g()),Z=Mt(()=>!i()||!s()?0:ut.getStockByProductAndLocation(i(),s())?.quantity||0),k=[{value:"Electronics",label:"Electronics"},{value:"Accessories",label:"Accessories"},{value:"Furniture",label:"Furniture"},{value:"Office Supplies",label:"Office Supplies"},{value:"Software",label:"Software"},{value:"Hardware",label:"Hardware"},{value:"Consumables",label:"Consumables"}],F=[{value:"Warehouse A",label:"Warehouse A"},{value:"Warehouse B",label:"Warehouse B"},{value:"Warehouse C",label:"Warehouse C"},{value:"Storage Room",label:"Storage Room"},{value:"Main Office",label:"Main Office"}],X={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},U=()=>{o(""),l(""),u("in"),y(0),f(0),S(""),E(""),ee(""),K("")},B=()=>{n({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""})},ce=oe=>{if(oe.preventDefault(),O()){if(K(""),!i()){K(e("forms.selectProduct"));return}if(!s()){K(e("forms.selectLocation"));return}if(h()<=0){K(e("forms.quantityGreaterThanZero"));return}if(g()<0){K(e("forms.unitCostNotNegative"));return}if(c()==="transfer"&&!q()){K(e("forms.selectFromLocation"));return}if(c()==="transfer"&&q()===s()){K(e("forms.sameLocationError"));return}if(c()==="out"&&h()>Z()){K(e("forms.insufficientStock",{currentStock:Z()}));return}const fe=b(),ae=P(),Y={productId:fe.id,productName:fe.name,productSku:fe.sku,locationId:ae.id,locationName:ae.name,movementType:c(),quantity:h(),unitCost:g()||fe.unitCost,totalCost:z()||h()*fe.unitCost,referenceNumber:x()||`AUTO-${Date.now()}`,notes:w(),createdBy:"admin",fromLocationId:c()==="transfer"?q():void 0,fromLocationName:c()==="transfer"?_()?.name:void 0};ut.addInventoryMovement(Y),U()}else{const fe=r();if(!fe.name||!fe.price||!fe.quantity||!fe.category||!fe.sku||!fe.supplier||!fe.minStock||!fe.location){alert(e("forms.fillAllRequired"));return}const ae={name:fe.name,price:parseFloat(fe.price),quantity:parseInt(fe.quantity),category:fe.category,description:fe.description,sku:fe.sku,supplier:fe.supplier,minStock:parseInt(fe.minStock),location:fe.location};ut.addItem(ae),B()}t.onClose()},L=(oe,fe)=>{n(ae=>({...ae,[oe]:fe}))},D=()=>{O()?U():B(),t.onClose()},j=oe=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(oe),I={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},M={...I,cursor:"pointer"},J={color:"#f44336","font-size":"0.875rem","margin-top":"0.5rem"},H={padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},Q={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},se={"font-weight":"500",color:"var(--text-muted)"},G={"font-weight":"600",color:"var(--text-primary)"},re=()=>O()?e("inventory.addMovement"):e("inventory.addNewItem");return R(On,{get isOpen(){return t.isOpen},onClose:D,get title(){return re()},get children(){return[(()=>{var oe=OE(),fe=oe.firstChild;return oe.addEventListener("submit",ce),a(oe,(()=>{var ae=Ee(()=>!!O());return()=>ae()?[(()=>{var Y=v0(),ie=Y.firstChild,de=ie.firstChild;return Y.style.setProperty("margin-bottom","1.5rem"),ie.style.setProperty("display","block"),ie.style.setProperty("margin-bottom","0.5rem"),ie.style.setProperty("font-weight","500"),a(ie,()=>e("inventory.product"),de),a(Y,R(gp,{get value(){return i()},onChange:ue=>{o(ue);const ge=ut.getProductById(ue);ge&&f(ge.unitCost)},get placeholder(){return e("inventory.searchProductsPlaceholder")},onAddNew:()=>$(!0),required:!0}),null),Y})(),(()=>{var Y=BE(),ie=Y.firstChild,de=ie.firstChild,ue=ie.nextSibling,ge=ue.firstChild,Pe=ge.nextSibling,pe=Pe.nextSibling,_e=pe.nextSibling;return Y.style.setProperty("margin-bottom","1.5rem"),ie.style.setProperty("display","block"),ie.style.setProperty("margin-bottom","0.5rem"),ie.style.setProperty("font-weight","500"),a(ie,()=>e("inventory.movementType"),de),ue.addEventListener("change",Le=>u(Le.target.value)),a(ge,()=>e("inventory.stockInPurchase")),a(Pe,()=>e("inventory.stockOutSale")),a(pe,()=>e("inventory.transferBetween")),a(_e,()=>e("inventory.stockAdjustment")),Se(Le=>m(ue,M,Le)),Se(()=>ue.value=c()),Y})(),Ee(()=>Ee(()=>c()==="transfer")()&&(()=>{var Y=v0(),ie=Y.firstChild,de=ie.firstChild;return Y.style.setProperty("margin-bottom","1.5rem"),ie.style.setProperty("display","block"),ie.style.setProperty("margin-bottom","0.5rem"),ie.style.setProperty("font-weight","500"),a(ie,()=>e("inventory.fromLocation"),de),a(Y,R(zu,{get value(){return q()},onChange:ue=>ee(ue),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>T(!0),required:!0}),null),Y})()),(()=>{var Y=jE(),ie=Y.firstChild;return Y.style.setProperty("margin-bottom","1.5rem"),ie.style.setProperty("display","block"),ie.style.setProperty("margin-bottom","0.5rem"),ie.style.setProperty("font-weight","500"),a(ie,(()=>{var de=Ee(()=>c()==="transfer");return()=>de()?e("inventory.toLocation")+" *":e("inventory.locationName")+" *"})()),a(Y,R(zu,{get value(){return s()},onChange:de=>l(de),get placeholder(){return Ee(()=>c()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>T(!0),required:!0}),null),Y})(),Ee(()=>Ee(()=>!!(b()&&P()))()&&(()=>{var Y=HE(),ie=Y.firstChild,de=ie.firstChild,ue=de.firstChild,ge=de.nextSibling,Pe=ge.firstChild,pe=ie.nextSibling,_e=pe.firstChild,Le=_e.firstChild,De=_e.nextSibling,Te=pe.nextSibling,$e=Te.firstChild,Ie=$e.firstChild,Re=$e.nextSibling,Je=Re.firstChild;return a(de,()=>e("inventory.currentStockAt",{location:P()?.name}),ue),a(ge,Z,Pe),a(ge,()=>b()?.unitOfMeasure,null),a(_e,()=>e("inventory.productCost"),Le),a(De,()=>j(b()?.unitCost||0)),a($e,()=>e("inventory.minStockLevel"),Ie),a(Re,()=>b()?.minStockLevel,Je),a(Re,()=>b()?.unitOfMeasure,null),Se(Be=>{var Ke=H,Xe=Q,at=se,ot=G,Qe=Q,dt=se,ct=G,kt=Q,gt=se,qe=G;return Be.e=m(Y,Ke,Be.e),Be.t=m(ie,Xe,Be.t),Be.a=m(de,at,Be.a),Be.o=m(ge,ot,Be.o),Be.i=m(pe,Qe,Be.i),Be.n=m(_e,dt,Be.n),Be.s=m(De,ct,Be.s),Be.h=m(Te,kt,Be.h),Be.r=m($e,gt,Be.r),Be.d=m(Re,qe,Be.d),Be},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),Y})()),(()=>{var Y=VE(),ie=Y.firstChild,de=ie.firstChild,ue=ie.nextSibling;return Y.style.setProperty("margin-bottom","1.5rem"),ie.style.setProperty("display","block"),ie.style.setProperty("margin-bottom","0.5rem"),ie.style.setProperty("font-weight","500"),a(ie,()=>e("inventory.quantity"),de),ue.addEventListener("change",ge=>y(Number(ge.target.value))),Se(ge=>m(ue,I,ge)),Se(()=>ue.value=h()),Y})(),(()=>{var Y=qE(),ie=Y.firstChild,de=ie.nextSibling;return Y.style.setProperty("margin-bottom","1.5rem"),ie.style.setProperty("display","block"),ie.style.setProperty("margin-bottom","0.5rem"),ie.style.setProperty("font-weight","500"),a(ie,()=>e("inventory.unitCost")),de.addEventListener("change",ue=>f(Number(ue.target.value))),Se(ue=>{var ge=I,Pe=e("inventory.willUseDefaultCost");return ue.e=m(de,ge,ue.e),Pe!==ue.t&&tr(de,"placeholder",ue.t=Pe),ue},{e:void 0,t:void 0}),Se(()=>de.value=g()),Y})(),Ee(()=>Ee(()=>h()>0&&g()>0)()&&(()=>{var Y=GE(),ie=Y.firstChild,de=ie.firstChild,ue=de.firstChild,ge=de.nextSibling;return a(de,()=>e("inventory.totalCost"),ue),a(ge,()=>j(z())),Se(Pe=>{var pe=H,_e=Q,Le=se,De={...G,"font-size":"1.2rem",color:"var(--primary-color)"};return Pe.e=m(Y,pe,Pe.e),Pe.t=m(ie,_e,Pe.t),Pe.a=m(de,Le,Pe.a),Pe.o=m(ge,De,Pe.o),Pe},{e:void 0,t:void 0,a:void 0,o:void 0}),Y})()),(()=>{var Y=zE(),ie=Y.firstChild,de=ie.nextSibling;return Y.style.setProperty("margin-bottom","1.5rem"),ie.style.setProperty("display","block"),ie.style.setProperty("margin-bottom","0.5rem"),ie.style.setProperty("font-weight","500"),a(ie,()=>e("common.referenceNumber")),de.addEventListener("change",ue=>S(ue.target.value)),Se(ue=>{var ge=I,Pe=e("common.referenceNumberPlaceholder");return ue.e=m(de,ge,ue.e),Pe!==ue.t&&tr(de,"placeholder",ue.t=Pe),ue},{e:void 0,t:void 0}),Se(()=>de.value=x()),Y})(),(()=>{var Y=UE(),ie=Y.firstChild,de=ie.nextSibling;return Y.style.setProperty("margin-bottom","1.5rem"),ie.style.setProperty("display","block"),ie.style.setProperty("margin-bottom","0.5rem"),ie.style.setProperty("font-weight","500"),a(ie,()=>e("common.notes")),de.addEventListener("change",ue=>E(ue.target.value)),Se(ue=>{var ge={...I,"min-height":"100px",resize:"vertical"},Pe=e("inventory.additionalNotesPlaceholder");return ue.e=m(de,ge,ue.e),Pe!==ue.t&&tr(de,"placeholder",ue.t=Pe),ue},{e:void 0,t:void 0}),Se(()=>de.value=w()),Y})(),Ee(()=>Ee(()=>!!W())()&&(()=>{var Y=WE();return m(Y,J),a(Y,W),Y})())]:[R($r,{get label(){return e("inventory.itemName")},get value(){return r().name},onChange:Y=>L("name",Y),get placeholder(){return e("inventory.enterItemName")},required:!0}),R($r,{get label(){return e("inventory.sku")},get value(){return r().sku},onChange:Y=>L("sku",Y),get placeholder(){return e("inventory.enterSkuCode")},required:!0}),R(Pn,{get label(){return e("inventory.category")},get value(){return r().category},onChange:Y=>L("category",Y),options:k,required:!0}),R($r,{get label(){return e("common.description")},get value(){return r().description},onChange:Y=>L("description",Y),get placeholder(){return e("inventory.enterItemDescription")}}),R($r,{get label(){return e("common.price")},type:"number",get value(){return r().price},onChange:Y=>L("price",Y),get placeholder(){return e("common.enterPrice")},required:!0}),R($r,{get label(){return e("inventory.quantity")},type:"number",get value(){return r().quantity},onChange:Y=>L("quantity",Y),get placeholder(){return e("inventory.enterQuantity")},required:!0}),R($r,{get label(){return e("inventory.minimumStock")},type:"number",get value(){return r().minStock},onChange:Y=>L("minStock",Y),get placeholder(){return e("inventory.enterMinStockLevel")},required:!0}),R($r,{get label(){return e("inventory.supplier")},get value(){return r().supplier},onChange:Y=>L("supplier",Y),get placeholder(){return e("inventory.enterSupplierName")},required:!0}),R(Pn,{get label(){return e("inventory.location")},get value(){return r().location},onChange:Y=>L("location",Y),options:F,required:!0})]})(),fe),m(fe,X),a(fe,R(ht,{variant:"secondary",type:"button",onClick:D,get children(){return e("common.cancel")}}),null),a(fe,R(ht,{variant:"primary",type:"submit",get children(){return Ee(()=>!!O())()?e("inventory.addMovement"):e("inventory.addItem")}}),null),oe})(),R(Uy,{get isOpen(){return te()},onClose:()=>$(!1),onProductAdded:oe=>{o(oe),$(!1)}}),R(Hy,{get isOpen(){return C()},onClose:()=>T(!1),onLocationAdded:oe=>{c()==="transfer"&&!q()?ee(oe):l(oe),T(!1)}})]}})};br(["input","keydown"]);var KE=he("<form><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text required></div></div><div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><div><label></label></div></div><div><div><h3></h3></div></div><div><label></label><textarea></textarea></div><div>"),JE=he("<div><label> *"),QE=he("<div><div></div><div></div><div></div><div></div><div>"),af=he("<div>"),XE=he("<div><input type=number min=0 step=1 required><input type=number min=0 step=0.01><input type=text>"),ZE=he("<div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span>"),eT=he("<div>• ");const tT=t=>{const{t:e}=or(),[r,n]=Ce(`INV-${Date.now()}`),[i,o]=Ce(""),[s,l]=Ce("in"),[c,u]=Ce(""),[h,y]=Ce(""),[g,f]=Ce(""),[x,S]=Ce([]),[w,E]=Ce([]),[q,ee]=Ce(!1),[W,K]=Ce(!1),te=()=>{S(H=>[...H,{productId:"",quantity:0,unitCost:0,notes:""}])},$=H=>{S(Q=>Q.filter((se,G)=>G!==H))},C=(H,Q,se)=>{S(G=>G.map((re,oe)=>oe===H?{...re,[Q]:se}:re))},T=()=>{n(`INV-${Date.now()}`),o(""),l("in"),u(""),y(""),f(""),S([]),E([])},O=async H=>{H.preventDefault(),E([]);const Q=[];if(i()||Q.push(e("forms.referenceNumberRequired")),c()||Q.push(e("forms.locationRequired")),s()==="transfer"&&!h()&&Q.push(e("forms.fromLocationRequired")),x().length===0&&Q.push(e("forms.atLeastOneProduct")),x().forEach((re,oe)=>{re.productId||Q.push(e("forms.itemProductRequired","Product is required for item {{index}}",{index:oe+1})),re.quantity<=0&&Q.push(e("forms.itemQuantityRequired","Quantity must be greater than 0 for item {{index}}",{index:oe+1}))}),Q.length>0){E(Q);return}const se={ssg_inventory_key:Lu(),invoiceId:r(),referenceNumber:i(),movementType:s(),type:Kf(s()),locationId:c(),fromLocationId:s()==="transfer"?h():void 0,items:x(),products:x(),generalNotes:g(),description:g(),invoice:i(),store:c(),createdBy:"admin",createDate:new Date().toISOString()};console.log(se);const G=await ut.addBulkInventoryMovements(se);console.log(G),G.success?t.onMovementComplete?t.onMovementComplete(i()):(T(),t.onClose()):E(G.errors)},b=()=>{T(),t.onClose()},P=Mt(()=>x().reduce((H,Q)=>{const se=ut.getProductById(Q.productId),G=Q.unitCost||se?.unitCost||0;return H+Q.quantity*G},0)),_=Mt(()=>x().reduce((H,Q)=>H+Q.quantity,0)),z={"margin-bottom":"1.5rem"},Z={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},k={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},F={...k,cursor:"pointer"},X={display:"grid",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},U={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},B={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem","padding-left":"0.75rem"},ce={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},L={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},D={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},j={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},I=H=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(H),M=H=>({in:e("inventory.purchaseReceive"),out:e("inventory.saleIssue"),transfer:e("inventory.transfer"),adjustment:e("inventory.adjustment")})[H]||H,J=async H=>{await ut.fecthInventory(H),await ut.fecthProduct(H)};return wn(()=>{J("prod")}),R(On,{get isOpen(){return t.isOpen},onClose:b,get title(){return e("inventory.bulkMovement")},get children(){return[(()=>{var H=KE(),Q=H.firstChild,se=Q.firstChild,G=se.firstChild,re=G.firstChild,oe=G.nextSibling,fe=se.nextSibling,ae=fe.firstChild,Y=ae.firstChild,ie=ae.nextSibling,de=Q.nextSibling,ue=de.firstChild,ge=ue.firstChild,Pe=ue.nextSibling,pe=Pe.firstChild,_e=pe.nextSibling,Le=_e.nextSibling,De=Le.nextSibling,Te=de.nextSibling,$e=Te.firstChild,Ie=$e.firstChild,Re=Te.nextSibling,Je=Re.firstChild,Be=Je.firstChild,Ke=Re.nextSibling,Xe=Ke.firstChild,at=Xe.nextSibling,ot=Ke.nextSibling;return H.addEventListener("submit",O),Q.style.setProperty("display","grid"),Q.style.setProperty("grid-template-columns","1fr 1fr"),Q.style.setProperty("gap","1rem"),Q.style.setProperty("margin-bottom","1.5rem"),a(G,()=>e("common.invoiceDocumentId"),re),oe.addEventListener("change",Qe=>n(Qe.target.value)),a(ae,()=>e("common.referenceNumber"),Y),ie.addEventListener("change",Qe=>o(Qe.target.value)),a(ue,()=>e("inventory.movementType"),ge),Pe.addEventListener("change",Qe=>l(Qe.target.value)),a(pe,()=>e("inventory.purchaseReceive")),a(_e,()=>e("inventory.saleIssue")),a(Le,()=>e("inventory.transfer")),a(De,()=>e("inventory.adjustment")),Te.style.setProperty("display","grid"),Te.style.setProperty("gap","1rem"),Te.style.setProperty("margin-bottom","1.5rem"),a(Te,(()=>{var Qe=Ee(()=>s()==="transfer");return()=>Qe()&&(()=>{var dt=JE(),ct=dt.firstChild,kt=ct.firstChild;return a(ct,()=>e("inventory.fromLocation"),kt),a(dt,R(zu,{get value(){return h()},onChange:gt=>y(gt),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>K(!0),required:!0}),null),Se(gt=>m(ct,Z,gt)),dt})()})(),$e),a(Ie,(()=>{var Qe=Ee(()=>s()==="transfer");return()=>Qe()?e("inventory.toLocation")+" *":e("inventory.location")+" *"})()),a($e,R(zu,{get value(){return c()},onChange:Qe=>u(Qe),get placeholder(){return Ee(()=>s()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>K(!0),required:!0}),null),Je.style.setProperty("display","flex"),Je.style.setProperty("justify-content","space-between"),Je.style.setProperty("align-items","center"),Je.style.setProperty("margin-bottom","1rem"),Be.style.setProperty("margin","0"),Be.style.setProperty("font-size","1.1rem"),a(Be,()=>e("inventory.products")),a(Je,R(ht,{variant:"outline",type:"button",onClick:te,get children(){return e("inventory.addProduct")}}),null),a(Re,(()=>{var Qe=Ee(()=>x().length>0);return()=>Qe()&&[(()=>{var dt=QE(),ct=dt.firstChild,kt=ct.nextSibling,gt=kt.nextSibling,qe=gt.nextSibling;return m(dt,B),a(ct,()=>e("inventory.product")),a(kt,()=>e("inventory.quantity")),a(gt,()=>e("inventory.unitCost")),a(qe,()=>e("common.notes")),dt})(),R(Ut,{get each(){return x()},children:(dt,ct)=>[(()=>{var kt=af();return m(kt,X),a(kt,R(gp,{get value(){return dt.productId},onChange:gt=>{C(ct(),"productId",gt.id);let qe={id:gt.id,label:gt.name,code:gt.sku};C(ct(),"product",qe);const Dt=ut.getProductById(gt.id);Dt&&!dt.unitCost&&C(ct(),"unitCost",Dt.unitCost)},get placeholder(){return e("inventory.searchProduct")},onAddNew:()=>ee(!0),required:!0})),kt})(),(()=>{var kt=XE(),gt=kt.firstChild,qe=gt.nextSibling,Dt=qe.nextSibling;return m(kt,U),gt.addEventListener("change",Rt=>C(ct(),"quantity",Number(Rt.target.value))),qe.addEventListener("change",Rt=>C(ct(),"unitCost",Number(Rt.target.value))),Dt.addEventListener("change",Rt=>C(ct(),"notes",Rt.target.value)),a(kt,R(ht,{variant:"outline",size:"sm",type:"button",onClick:()=>$(ct()),style:{color:"#f44336","border-color":"#f44336"},get children(){return e("common.remove")}}),null),Se(Rt=>{var St=k,Bt=k,fr=e("common.auto"),Qt=k,cr=e("common.optionalNotes");return Rt.e=m(gt,St,Rt.e),Rt.t=m(qe,Bt,Rt.t),fr!==Rt.a&&tr(qe,"placeholder",Rt.a=fr),Rt.o=m(Dt,Qt,Rt.o),cr!==Rt.i&&tr(Dt,"placeholder",Rt.i=cr),Rt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>gt.value=dt.quantity),Se(()=>qe.value=dt.unitCost),Se(()=>Dt.value=dt.notes),kt})()]})]})(),null),a(Re,(()=>{var Qe=Ee(()=>x().length===0);return()=>Qe()&&(()=>{var dt=af();return dt.style.setProperty("text-align","center"),dt.style.setProperty("padding","2rem"),dt.style.setProperty("background","var(--background-color)"),dt.style.setProperty("border-radius","var(--border-radius-sm)"),dt.style.setProperty("border","1px solid var(--border-color)"),dt.style.setProperty("color","var(--text-muted)"),a(dt,()=>e("inventory.noProductsAdded")),dt})()})(),null),a(H,(()=>{var Qe=Ee(()=>x().length>0);return()=>Qe()&&(()=>{var dt=ZE(),ct=dt.firstChild,kt=ct.nextSibling,gt=kt.firstChild,qe=gt.firstChild,Dt=gt.nextSibling,Rt=kt.nextSibling,St=Rt.firstChild,Bt=St.firstChild,fr=St.nextSibling,Qt=Rt.nextSibling,cr=Qt.firstChild,xr=cr.firstChild,It=cr.nextSibling,Ge=Qt.nextSibling,Nt=Ge.firstChild,At=Nt.firstChild,Lt=Nt.nextSibling;return m(dt,ce),ct.style.setProperty("margin","0 0 1rem 0"),ct.style.setProperty("font-size","1rem"),a(ct,()=>e("common.summary")),a(gt,()=>e("inventory.totalProducts"),qe),Dt.style.setProperty("font-weight","600"),a(Dt,()=>x().length),a(St,()=>e("inventory.totalItems"),Bt),fr.style.setProperty("font-weight","600"),a(fr,_),a(cr,()=>e("inventory.totalValue"),xr),It.style.setProperty("font-weight","600"),It.style.setProperty("color","var(--primary-color)"),a(It,()=>I(P())),a(Nt,()=>e("inventory.movementType"),At),Lt.style.setProperty("font-weight","600"),a(Lt,()=>M(s())),Se(Ue=>{var nt=L,_t=L,Wt=L,We=L;return Ue.e=m(kt,nt,Ue.e),Ue.t=m(Rt,_t,Ue.t),Ue.a=m(Qt,Wt,Ue.a),Ue.o=m(Ge,We,Ue.o),Ue},{e:void 0,t:void 0,a:void 0,o:void 0}),dt})()})(),Ke),a(Xe,()=>e("common.generalNotes")),at.addEventListener("change",Qe=>f(Qe.target.value)),a(H,(()=>{var Qe=Ee(()=>w().length>0);return()=>Qe()&&(()=>{var dt=af();return m(dt,D),a(dt,R(Ut,{get each(){return w()},children:ct=>(()=>{var kt=eT();return kt.firstChild,a(kt,ct,null),kt})()})),dt})()})(),ot),m(ot,j),a(ot,R(ht,{variant:"secondary",type:"button",onClick:b,get children(){return e("common.cancel")}}),null),a(ot,R(ht,{variant:"primary",type:"submit",get children(){return e("inventory.createMovement")}}),null),Se(Qe=>{var dt=Z,ct=k,kt=Z,gt=k,qe=e("common.referenceNumberPlaceholder"),Dt=z,Rt=Z,St=F,Bt=s()==="transfer"?"1fr 1fr":"1fr",fr=Z,Qt=z,cr=z,xr=Z,It={...k,"min-height":"80px",resize:"vertical"},Ge=e("inventory.generalNotesPlaceholder");return Qe.e=m(G,dt,Qe.e),Qe.t=m(oe,ct,Qe.t),Qe.a=m(ae,kt,Qe.a),Qe.o=m(ie,gt,Qe.o),qe!==Qe.i&&tr(ie,"placeholder",Qe.i=qe),Qe.n=m(de,Dt,Qe.n),Qe.s=m(ue,Rt,Qe.s),Qe.h=m(Pe,St,Qe.h),Bt!==Qe.r&&((Qe.r=Bt)!=null?Te.style.setProperty("grid-template-columns",Bt):Te.style.removeProperty("grid-template-columns")),Qe.d=m(Ie,fr,Qe.d),Qe.l=m(Re,Qt,Qe.l),Qe.u=m(Ke,cr,Qe.u),Qe.c=m(Xe,xr,Qe.c),Qe.w=m(at,It,Qe.w),Ge!==Qe.m&&tr(at,"placeholder",Qe.m=Ge),Qe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),Se(()=>oe.value=r()),Se(()=>ie.value=i()),Se(()=>Pe.value=s()),Se(()=>at.value=g()),H})(),R(Uy,{get isOpen(){return q()},onClose:()=>ee(!1),onProductAdded:H=>{ee(!1)}}),R(Hy,{get isOpen(){return W()},onClose:()=>K(!1),onLocationAdded:H=>{s()==="transfer"&&!h()?y(H):u(H),K(!1)}})]}})};var rT=he("<button>"),nT=he("<div><h3></h3><button>🖨️ "),iT=he("<div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> "),lf=he("<div><strong>:</strong> "),oT=he("<div>"),sT=he("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),aT=he("<div><div><h2></h2><div><select><option value=date></option><option value=quantity></option><option value=value></option></select></div></div><div>"),lT=he("<div><div><h3></h3><div></div></div><div><span></span><div>"),cT=he("<div><div><strong>:</strong> "),uT=he("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),dT=he("<div><button></button><button>🖨️"),hT=he("<tr><td></td><td></td><td></td><td></td><td></td><td>");const N5=t=>{const{t:e}=or(),[r,n]=Ce(null),[i,o]=Ce("date"),s=Mt(()=>{const g=t.movements||ut.movements,f=new Map;return g.forEach(x=>{const S=x.referenceNumber||x.ssg_inventory_key||x.invoiceId||"UNKNOWN";if(!f.has(S)){const q=ut.getLocationById(x.locationId);f.set(S,{referenceNumber:x.referenceNumber||"",invoiceId:x.invoiceId||"",ssg_inventory_key:x.ssg_inventory_key||"",movementType:x.movementType||"unknown",locationId:x.locationId||"",locationName:q?.name||"Unknown Location",totalItems:0,totalQuantity:0,createDate:x.createDate||new Date().toISOString(),description:x.description||"",generalNotes:x.generalNotes||"",movements:[],totalValue:0})}const w=f.get(S);w.movements.push(x),w.totalItems++,w.totalQuantity+=Math.abs(x.quantity||0);const E=ut.getProductById(x.productId);E&&E.unitCost&&(w.totalValue+=Math.abs(x.quantity||0)*E.unitCost)}),Array.from(f.values()).sort((x,S)=>{switch(i()){case"quantity":return S.totalQuantity-x.totalQuantity;case"value":return S.totalValue-x.totalValue;case"date":default:return new Date(S.createDate).getTime()-new Date(x.createDate).getTime()}})}),l=g=>new Date(g).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),c=g=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(g),u=g=>{switch(g.toLowerCase()){case"in":case"stock_in":return"#22c55e";case"out":case"stock_out":return"#ef4444";case"transfer":return"#3b82f6";case"adjustment":return"#f59e0b";default:return"#6b7280"}},h=g=>{switch(g.toLowerCase()){case"in":case"stock_in":return"↗️";case"out":case"stock_out":return"↙️";case"transfer":return"↔️";case"adjustment":return"⚖️";default:return"📦"}},y=g=>{const f=g||r();if(!f)return;const x=window.open("","_blank");if(!x)return;const S=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Bulk Movement Report - ${f.referenceNumber||f.invoiceId}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          .header { text-align: center; border-bottom: 2px solid #333; padding-bottom: 10px; margin-bottom: 20px; }
          .group-info { background: #f8f9fa; padding: 15px; margin-bottom: 20px; border-radius: 5px; }
          .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
          table { width: 100%; border-collapse: collapse; margin-top: 15px; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background-color: #f2f2f2; font-weight: bold; }
          .summary { background: #e8f4fd; padding: 15px; margin-top: 20px; border-radius: 5px; }
          @media print { body { margin: 0; } }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>BULK MOVEMENT REPORT</h1>
          <h2>${f.referenceNumber||f.invoiceId}</h2>
          <p>Generated: ${l(new Date().toISOString())}</p>
        </div>
        
        <div class="group-info">
          <div class="info-grid">
            <div>
              <strong>Reference Number:</strong> ${f.referenceNumber||"N/A"}<br>
              <strong>Invoice ID:</strong> ${f.invoiceId||"N/A"}<br>
              <strong>Movement Type:</strong> ${f.movementType.toUpperCase()}<br>
              <strong>Location:</strong> ${f.locationName}
            </div>
            <div>
              <strong>Date:</strong> ${l(f.createDate)}<br>
              <strong>Total Items:</strong> ${f.totalItems}<br>
              <strong>Total Quantity:</strong> ${f.totalQuantity}<br>
              <strong>Estimated Value:</strong> ${c(f.totalValue)}
            </div>
          </div>
          ${f.description?`<p><strong>Description:</strong> ${f.description}</p>`:""}
          ${f.generalNotes?`<p><strong>Notes:</strong> ${f.generalNotes}</p>`:""}
        </div>
        
        <table>
          <thead>
            <tr>
              <th>Product Code</th>
              <th>Product Name</th>
              <th>Quantity</th>
              <th>Unit Cost</th>
              <th>Total Value</th>
              <th>Notes</th>
            </tr>
          </thead>
          <tbody>
            ${f.movements.map(w=>{const E=ut.getProductById(w.productId),q=E?.unitCost||0,ee=Math.abs(w.quantity||0)*q;return`
                <tr>
                  <td>${E?.code||w.productId}</td>
                  <td>${E?.name||"Unknown Product"}</td>
                  <td>${w.quantity||0}</td>
                  <td>${c(q)}</td>
                  <td>${c(ee)}</td>
                  <td>${w.notes||"-"}</td>
                </tr>
              `}).join("")}
          </tbody>
        </table>
        
        <div class="summary">
          <h3>SUMMARY</h3>
          <p><strong>Total Products:</strong> ${f.totalItems}</p>
          <p><strong>Total Quantity Moved:</strong> ${f.totalQuantity}</p>
          <p><strong>Total Estimated Value:</strong> ${c(f.totalValue)}</p>
          <p><strong>Movement Impact:</strong> ${f.movementType==="in"?"Increased":f.movementType==="out"?"Decreased":"Adjusted"} inventory</p>
        </div>
      </body>
      </html>
    `;x.document.write(S),x.document.close(),x.print()};return(()=>{var g=aT(),f=g.firstChild,x=f.firstChild,S=x.nextSibling,w=S.firstChild,E=w.firstChild,q=E.nextSibling,ee=q.nextSibling,W=f.nextSibling;return g.style.setProperty("padding","1rem"),f.style.setProperty("display","flex"),f.style.setProperty("justify-content","space-between"),f.style.setProperty("align-items","center"),f.style.setProperty("margin-bottom","2rem"),a(x,()=>e("inventory.bulkMovementReport","Bulk Movement Report")),S.style.setProperty("display","flex"),S.style.setProperty("gap","1rem"),w.addEventListener("change",K=>o(K.currentTarget.value)),w.style.setProperty("padding","0.5rem"),a(E,()=>e("common.sortByDate","Sort by Date")),a(q,()=>e("common.sortByQuantity","Sort by Quantity")),a(ee,()=>e("common.sortByValue","Sort by Value")),a(S,R(ze,{get when(){return t.onClose},get children(){var K=rT();return is(K,"click",t.onClose,!0),K.style.setProperty("padding","0.5rem 1rem"),K.style.setProperty("background","#6c757d"),K.style.setProperty("color","white"),K.style.setProperty("border","none"),K.style.setProperty("border-radius","var(--border-radius-sm)"),K.style.setProperty("cursor","pointer"),a(K,()=>e("common.close","Close")),K}}),null),W.style.setProperty("display","grid"),W.style.setProperty("grid-template-columns","repeat(auto-fill, minmax(400px, 1fr))"),W.style.setProperty("gap","1rem"),W.style.setProperty("margin-bottom","2rem"),a(W,R(Ut,{get each(){return s()},children:K=>R(Ot,{get style(){return{cursor:"pointer",border:r()===K?"2px solid var(--primary-color)":"1px solid #e9ecef",transition:"all 0.2s"}},onClick:()=>n(K),get children(){return[(()=>{var te=lT(),$=te.firstChild,C=$.firstChild,T=C.nextSibling,O=$.nextSibling,b=O.firstChild,P=b.nextSibling;return te.style.setProperty("display","flex"),te.style.setProperty("justify-content","space-between"),te.style.setProperty("align-items","flex-start"),te.style.setProperty("margin-bottom","1rem"),C.style.setProperty("margin","0 0 0.5rem 0"),C.style.setProperty("font-size","1.1rem"),a(C,()=>K.referenceNumber||K.invoiceId||"No Reference"),T.style.setProperty("font-size","0.875rem"),T.style.setProperty("color","#6c757d"),a(T,()=>l(K.createDate)),O.style.setProperty("text-align","center"),b.style.setProperty("font-size","1.5rem"),a(b,()=>h(K.movementType)),P.style.setProperty("font-size","0.75rem"),P.style.setProperty("font-weight","bold"),a(P,()=>K.movementType.toUpperCase()),Se(_=>(_=u(K.movementType))!=null?P.style.setProperty("color",_):P.style.removeProperty("color")),te})(),(()=>{var te=cT(),$=te.firstChild,C=$.firstChild,T=C.firstChild;return C.nextSibling,te.style.setProperty("margin-bottom","1rem"),$.style.setProperty("font-size","0.875rem"),$.style.setProperty("margin-bottom","0.25rem"),a(C,()=>e("inventory.location","Location"),T),a($,()=>K.locationName,null),a(te,R(ze,{get when(){return K.description},get children(){var O=lf(),b=O.firstChild,P=b.firstChild;return b.nextSibling,O.style.setProperty("font-size","0.875rem"),O.style.setProperty("margin-bottom","0.25rem"),a(b,()=>e("common.description","Description"),P),a(O,()=>K.description,null),O}}),null),te})(),(()=>{var te=uT(),$=te.firstChild,C=$.firstChild,T=C.nextSibling,O=$.nextSibling,b=O.firstChild,P=b.nextSibling,_=O.nextSibling,z=_.firstChild,Z=z.nextSibling;return te.style.setProperty("display","grid"),te.style.setProperty("grid-template-columns","repeat(3, 1fr)"),te.style.setProperty("gap","0.5rem"),te.style.setProperty("margin-bottom","1rem"),$.style.setProperty("text-align","center"),$.style.setProperty("padding","0.5rem"),$.style.setProperty("background","#f8f9fa"),$.style.setProperty("border-radius","var(--border-radius-sm)"),C.style.setProperty("font-weight","bold"),C.style.setProperty("color","#3b82f6"),a(C,()=>K.totalItems),T.style.setProperty("font-size","0.75rem"),T.style.setProperty("color","#6c757d"),a(T,()=>e("inventory.items","Items")),O.style.setProperty("text-align","center"),O.style.setProperty("padding","0.5rem"),O.style.setProperty("background","#f8f9fa"),O.style.setProperty("border-radius","var(--border-radius-sm)"),b.style.setProperty("font-weight","bold"),b.style.setProperty("color","#22c55e"),a(b,()=>K.totalQuantity),P.style.setProperty("font-size","0.75rem"),P.style.setProperty("color","#6c757d"),a(P,()=>e("inventory.quantity","Quantity")),_.style.setProperty("text-align","center"),_.style.setProperty("padding","0.5rem"),_.style.setProperty("background","#f8f9fa"),_.style.setProperty("border-radius","var(--border-radius-sm)"),z.style.setProperty("font-weight","bold"),z.style.setProperty("color","#f59e0b"),a(z,()=>c(K.totalValue)),Z.style.setProperty("font-size","0.75rem"),Z.style.setProperty("color","#6c757d"),a(Z,()=>e("common.value","Value")),te})(),(()=>{var te=dT(),$=te.firstChild,C=$.nextSibling;return te.style.setProperty("display","flex"),te.style.setProperty("gap","0.5rem"),$.$$click=T=>{T.stopPropagation(),n(K)},$.style.setProperty("flex","1"),$.style.setProperty("padding","0.5rem"),$.style.setProperty("background","var(--primary-color)"),$.style.setProperty("color","white"),$.style.setProperty("border","none"),$.style.setProperty("border-radius","var(--border-radius-sm)"),$.style.setProperty("cursor","pointer"),$.style.setProperty("font-size","0.875rem"),a($,()=>e("common.viewDetails","View Details")),C.$$click=T=>{T.stopPropagation(),y(K)},C.style.setProperty("padding","0.5rem"),C.style.setProperty("background","#22c55e"),C.style.setProperty("color","white"),C.style.setProperty("border","none"),C.style.setProperty("border-radius","var(--border-radius-sm)"),C.style.setProperty("cursor","pointer"),C.style.setProperty("font-size","0.875rem"),te})()]}})})),a(g,R(ze,{get when(){return r()},get children(){return R(Ot,{get children(){return[(()=>{var K=nT(),te=K.firstChild,$=te.nextSibling;return $.firstChild,K.style.setProperty("display","flex"),K.style.setProperty("justify-content","space-between"),K.style.setProperty("align-items","center"),K.style.setProperty("margin-bottom","1rem"),a(te,()=>e("inventory.movementDetails","Movement Details")),$.$$click=()=>y(),$.style.setProperty("padding","0.5rem 1rem"),$.style.setProperty("background","#22c55e"),$.style.setProperty("color","white"),$.style.setProperty("border","none"),$.style.setProperty("border-radius","var(--border-radius-sm)"),$.style.setProperty("cursor","pointer"),a($,()=>e("common.print","Print Report"),null),K})(),(()=>{var K=iT(),te=K.firstChild,$=te.firstChild,C=$.firstChild,T=C.firstChild;C.nextSibling;var O=$.nextSibling,b=O.firstChild,P=b.firstChild;b.nextSibling;var _=O.nextSibling,z=_.firstChild,Z=z.firstChild;z.nextSibling;var k=_.nextSibling,F=k.firstChild,X=F.firstChild;F.nextSibling;var U=te.nextSibling,B=U.firstChild,ce=B.firstChild,L=ce.firstChild;ce.nextSibling;var D=B.nextSibling,j=D.firstChild,I=j.firstChild;j.nextSibling;var M=D.nextSibling,J=M.firstChild,H=J.firstChild;J.nextSibling;var Q=M.nextSibling,se=Q.firstChild,G=se.firstChild;return se.nextSibling,K.style.setProperty("display","grid"),K.style.setProperty("grid-template-columns","repeat(2, 1fr)"),K.style.setProperty("gap","1rem"),K.style.setProperty("margin-bottom","2rem"),K.style.setProperty("padding","1rem"),K.style.setProperty("background","#f8f9fa"),K.style.setProperty("border-radius","var(--border-radius-sm)"),a(C,()=>e("inventory.referenceNumber","Reference"),T),a($,()=>r()?.referenceNumber||"N/A",null),a(b,()=>e("inventory.invoiceId","Invoice ID"),P),a(O,()=>r()?.invoiceId||"N/A",null),a(z,()=>e("inventory.movementType","Type"),Z),a(_,()=>r()?.movementType.toUpperCase(),null),a(F,()=>e("inventory.location","Location"),X),a(k,()=>r()?.locationName,null),a(ce,()=>e("common.date","Date"),L),a(B,(()=>{var re=Ee(()=>!!r());return()=>re()?l(r().createDate):""})(),null),a(j,()=>e("inventory.totalItems","Total Items"),I),a(D,()=>r()?.totalItems,null),a(J,()=>e("inventory.totalQuantity","Total Quantity"),H),a(M,()=>r()?.totalQuantity,null),a(se,()=>e("common.estimatedValue","Estimated Value"),G),a(Q,(()=>{var re=Ee(()=>!!r());return()=>re()?c(r().totalValue):""})(),null),K})(),R(ze,{get when(){return r()?.description||r()?.generalNotes},get children(){var K=oT();return K.style.setProperty("margin-bottom","2rem"),K.style.setProperty("padding","1rem"),K.style.setProperty("background","#e8f4fd"),K.style.setProperty("border-radius","var(--border-radius-sm)"),a(K,R(ze,{get when(){return r()?.description},get children(){var te=lf(),$=te.firstChild,C=$.firstChild;return $.nextSibling,a($,()=>e("common.description","Description"),C),a(te,()=>r()?.description,null),te}}),null),a(K,R(ze,{get when(){return r()?.generalNotes},get children(){var te=lf(),$=te.firstChild,C=$.firstChild;return $.nextSibling,a($,()=>e("common.notes","Notes"),C),a(te,()=>r()?.generalNotes,null),te}}),null),K}}),(()=>{var K=sT(),te=K.firstChild,$=te.firstChild,C=$.firstChild,T=C.firstChild,O=T.nextSibling,b=O.nextSibling,P=b.nextSibling,_=P.nextSibling,z=_.nextSibling,Z=$.nextSibling;return K.style.setProperty("overflow-x","auto"),te.style.setProperty("width","100%"),te.style.setProperty("border-collapse","collapse"),C.style.setProperty("border-bottom","2px solid #dee2e6"),T.style.setProperty("padding","0.75rem"),T.style.setProperty("text-align","left"),a(T,()=>e("inventory.productCode","Code")),O.style.setProperty("padding","0.75rem"),O.style.setProperty("text-align","left"),a(O,()=>e("inventory.productName","Product")),b.style.setProperty("padding","0.75rem"),b.style.setProperty("text-align","center"),a(b,()=>e("inventory.quantity","Quantity")),P.style.setProperty("padding","0.75rem"),P.style.setProperty("text-align","right"),a(P,()=>e("inventory.unitCost","Unit Cost")),_.style.setProperty("padding","0.75rem"),_.style.setProperty("text-align","right"),a(_,()=>e("common.totalValue","Total Value")),z.style.setProperty("padding","0.75rem"),z.style.setProperty("text-align","left"),a(z,()=>e("common.notes","Notes")),a(Z,R(Ut,{get each(){return r()?.movements||[]},children:k=>{const F=ut.getProductById(k.productId),X=F?.unitCost||0,U=Math.abs(k.quantity||0)*X;return(()=>{var B=hT(),ce=B.firstChild,L=ce.nextSibling,D=L.nextSibling,j=D.nextSibling,I=j.nextSibling,M=I.nextSibling;return B.style.setProperty("border-bottom","1px solid #dee2e6"),ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("font-family","monospace"),a(ce,()=>F?.code||k.productId),L.style.setProperty("padding","0.75rem"),a(L,()=>F?.name||"Unknown Product"),D.style.setProperty("padding","0.75rem"),D.style.setProperty("text-align","center"),D.style.setProperty("font-weight","bold"),a(D,()=>k.quantity||0),j.style.setProperty("padding","0.75rem"),j.style.setProperty("text-align","right"),a(j,()=>c(X)),I.style.setProperty("padding","0.75rem"),I.style.setProperty("text-align","right"),I.style.setProperty("font-weight","bold"),a(I,()=>c(U)),M.style.setProperty("padding","0.75rem"),M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","#6c757d"),a(M,()=>k.notes||"-"),Se(J=>(J=(k.quantity||0)>=0?"#22c55e":"#ef4444")!=null?D.style.setProperty("color",J):D.style.removeProperty("color")),B})()}})),K})()]}})}}),null),Se(()=>w.value=i()),g})()};br(["click"]);var pT=he("<div><div><div><h2>Bulk Movement Report - </h2><button>×</button></div><div>");const fT=t=>{const[e,r]=Ce(!0),[n,i]=Ce(!1),[o,s]=Ce([]),[l,c]=Ce(""),u=g=>{const f=ut.movements.filter(x=>x.referenceNumber===g||x.invoiceId===g||x.ssg_inventory_key===g);s(f),c(g),r(!1),i(!0)},h=()=>{r(!1),t.onClose()},y=()=>{i(!1),t.onClose()};return[R(ze,{get when(){return e()},get children(){return R(tT,{get isOpen(){return Ee(()=>!!t.isOpen)()&&e()},onClose:h,onMovementComplete:u})}}),R(ze,{get when(){return n()},get children(){var g=pT(),f=g.firstChild,x=f.firstChild,S=x.firstChild;S.firstChild;var w=S.nextSibling,E=x.nextSibling;return g.style.setProperty("position","fixed"),g.style.setProperty("top","0"),g.style.setProperty("left","0"),g.style.setProperty("right","0"),g.style.setProperty("bottom","0"),g.style.setProperty("background","rgba(0, 0, 0, 0.5)"),g.style.setProperty("z-index","1000"),g.style.setProperty("display","flex"),g.style.setProperty("align-items","center"),g.style.setProperty("justify-content","center"),g.style.setProperty("padding","2rem"),f.style.setProperty("background","white"),f.style.setProperty("border-radius","var(--border-radius)"),f.style.setProperty("width","95%"),f.style.setProperty("max-width","1200px"),f.style.setProperty("max-height","90vh"),f.style.setProperty("overflow-y","auto"),f.style.setProperty("position","relative"),x.style.setProperty("padding","1rem 2rem"),x.style.setProperty("border-bottom","1px solid #e9ecef"),x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),x.style.setProperty("background","#f8f9fa"),S.style.setProperty("margin","0"),a(S,l,null),w.$$click=y,w.style.setProperty("background","none"),w.style.setProperty("border","none"),w.style.setProperty("font-size","1.5rem"),w.style.setProperty("cursor","pointer"),w.style.setProperty("padding","0.5rem"),w.style.setProperty("line-height","1"),E.style.setProperty("padding","1rem"),a(E,R(N5,{get movements(){return o()},onClose:y})),g}})]};br(["click"]);var mT=he("<div><div></div><div></div><div></div><div>"),yT=he("<div><strong>:</strong> "),gT=he("<div><div><span></span><span></span></div><div><span></span><span> </span></div><div><span></span><span> </span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),vT=he("<div>");const bT=t=>{const{t:e}=or(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},i={"font-weight":"600",color:"var(--text-primary)"},o={"text-align":"center","margin-bottom":"2rem"},s={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},l={color:"var(--text-muted)","font-size":"1rem"},c={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"1rem"},u=(S,w)=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:S>w?"#d4edda":"#f8d7da",color:S>w?"#155724":"#721c24"}),h={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},y={"margin-bottom":"1.5rem",padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",color:"var(--text-secondary)"};if(!t.item)return null;const g=S=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(S),f=S=>new Date(S).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),x=t.item.price*t.item.quantity;return R(On,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.itemDetails")},get children(){return[(()=>{var S=mT(),w=S.firstChild,E=w.nextSibling,q=E.nextSibling,ee=q.nextSibling;return m(S,o),m(w,s),a(w,()=>t.item.name),m(E,l),a(E,()=>t.item.category),m(q,c),a(q,()=>g(t.item.price)),a(ee,(()=>{var W=Ee(()=>t.item.quantity>t.item.minStock);return()=>W()?e("inventory.inStock"):e("inventory.lowStockAlert")})()),Se(W=>m(ee,u(t.item.quantity,t.item.minStock),W)),S})(),(()=>{var S=yT(),w=S.firstChild,E=w.firstChild;return w.nextSibling,m(S,y),a(w,()=>e("common.description"),E),a(S,()=>t.item.description,null),S})(),(()=>{var S=gT(),w=S.firstChild,E=w.firstChild,q=E.nextSibling,ee=w.nextSibling,W=ee.firstChild,K=W.nextSibling,te=K.firstChild,$=ee.nextSibling,C=$.firstChild,T=C.nextSibling,O=T.firstChild,b=$.nextSibling,P=b.firstChild,_=P.nextSibling,z=b.nextSibling,Z=z.firstChild,k=Z.nextSibling,F=z.nextSibling,X=F.firstChild,U=X.nextSibling,B=F.nextSibling,ce=B.firstChild,L=ce.nextSibling;return a(E,()=>e("inventory.sku")),a(q,()=>t.item.sku),a(W,()=>e("inventory.quantity")),a(K,()=>t.item.quantity,te),a(K,()=>e("common.units"),null),a(C,()=>e("inventory.minimumStock")),a(T,()=>t.item.minStock,O),a(T,()=>e("common.units"),null),a(P,()=>e("inventory.totalValue")),a(_,()=>g(x)),a(Z,()=>e("inventory.supplier")),a(k,()=>t.item.supplier),a(X,()=>e("inventory.location")),a(U,()=>t.item.location),a(ce,()=>e("common.lastUpdated")),a(L,()=>f(t.item.lastUpdated)),Se(D=>{var j=r,I=n,M=i,J=r,H=n,Q=i,se=r,G=n,re=i,oe=r,fe=n,ae=i,Y=r,ie=n,de=i,ue=r,ge=n,Pe=i,pe=r,_e=n,Le=i;return D.e=m(w,j,D.e),D.t=m(E,I,D.t),D.a=m(q,M,D.a),D.o=m(ee,J,D.o),D.i=m(W,H,D.i),D.n=m(K,Q,D.n),D.s=m($,se,D.s),D.h=m(C,G,D.h),D.r=m(T,re,D.r),D.d=m(b,oe,D.d),D.l=m(P,fe,D.l),D.u=m(_,ae,D.u),D.c=m(z,Y,D.c),D.w=m(Z,ie,D.w),D.m=m(k,de,D.m),D.f=m(F,ue,D.f),D.y=m(X,ge,D.y),D.g=m(U,Pe,D.g),D.p=m(B,pe,D.p),D.b=m(ce,_e,D.b),D.T=m(L,Le,D.T),D},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),S})(),(()=>{var S=vT();return m(S,h),a(S,R(ht,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),a(S,R(ht,{variant:"primary",onClick:()=>{console.log("Edit item:",t.item.id)},get children(){return e("common.editItem")}}),null),S})()]}})};var _T=he("<div>🔄"),ST=he("<button type=button>×"),PT=he("<div>⚠️ "),b0=he("<div>"),wT=he("<div><div><input type=text autocomplete=off>"),xT=he("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>"),AT=he("<span>⚠️ ");const CT=t=>{const{t:e}=or(),[r,n]=Ce(""),[i,o]=Ce(!1),[s,l]=Ce(null),[c,u]=Ce([]),[h,y]=Ce(!1),[g,f]=Ce(-1),[x,S]=Ce(null),w=t.searchDelay||300;t.maxResults;const E=async j=>{if(!j.trim()||j.trim().length<3){u([]),t.onSearchResults?.([]);return}try{o(!0),l(null);try{console.log("apiResults",j),t.onSearchResults?.(j)}catch(I){console.warn("API search failed, using local fallback:",I),l("API search failed, showing local results")}}catch(I){const M=I instanceof Error?I.message:"Search failed";l(M),u([]),t.onSearchResults?.([])}finally{o(!1)}},q=j=>{const M=j.target.value;n(M),l(null),console.log(),t.showResults,x()&&clearTimeout(x());const J=setTimeout(()=>{E(M)},w);S(J)},ee=j=>{n(j.name),y(!1),f(-1),t.onInventorySelect?.(j)},W=j=>{if(!(!h()||c().length===0))switch(j.key){case"ArrowDown":j.preventDefault(),f(I=>Math.min(I+1,c().length-1));break;case"ArrowUp":j.preventDefault(),f(I=>Math.max(I-1,-1));break;case"Enter":j.preventDefault(),g()>=0&&c()[g()]&&ee(c()[g()]);break;case"Escape":y(!1),f(-1);break}},K=()=>{t.showResults!==!1&&c().length>0&&y(!0)},te=()=>{setTimeout(()=>{y(!1),f(-1)},150)},$=()=>{n(""),u([]),l(null),y(!1),f(-1),t.onSearchResults?.([]),x()&&(clearTimeout(x()),S(null))},C=j=>ut.stockLevels.filter(I=>I.inventoryId===j).reduce((I,M)=>I+M.quantity,0),T=j=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(j),O={position:"relative",width:"100%",...t.style},b={position:"relative",display:"flex","align-items":"center"},P={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},_={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},z={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},Z={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},k=j=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:j?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),F={display:"flex","justify-content":"space-between","align-items":"center"},X={flex:"1"},U={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},B={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},ce={"text-align":"right","font-size":"0.875rem"},L={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},D={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var j=wT(),I=j.firstChild,M=I.firstChild;return M.addEventListener("blur",te),M.addEventListener("focus",K),M.$$keydown=W,M.$$input=q,a(I,R(ze,{get when(){return i()},get children(){var J=_T();return Se(H=>m(J,z,H)),J}}),null),a(I,R(ze,{get when(){return Ee(()=>!!r())()&&!i()},get children(){var J=ST();return J.addEventListener("mouseleave",H=>{H.currentTarget.style.background="none",H.currentTarget.style.color="var(--text-muted)"}),J.addEventListener("mouseenter",H=>{H.currentTarget.style.background="var(--border-color)",H.currentTarget.style.color="var(--text-primary)"}),J.$$click=$,Se(H=>{var Q=_,se=e("common.clear","Clear search");return H.e=m(J,Q,H.e),se!==H.t&&tr(J,"title",H.t=se),H},{e:void 0,t:void 0}),J}}),null),a(j,R(ze,{get when(){return h()&&t.showResults!==!1},get children(){var J=b0();return a(J,R(ze,{get when(){return s()},get children(){var H=PT();return H.firstChild,m(H,D),a(H,s,null),H}}),null),a(J,R(ze,{get when(){return c().length>0},get fallback(){return Ee(()=>!!(r()&&!i()))()&&(()=>{var H=b0();return m(H,L),a(H,()=>e("inventory.noInventorysFound","No inventorys found matching your search.")),H})()},get children(){return R(Ut,{get each(){return c()},children:(H,Q)=>{const se=C(H.id),G=se<=H.minStockLevel;return(()=>{var re=xT(),oe=re.firstChild,fe=oe.firstChild,ae=fe.firstChild,Y=ae.nextSibling,ie=Y.firstChild,de=ie.firstChild,ue=ie.nextSibling,ge=ue.nextSibling,Pe=ge.nextSibling,pe=Pe.nextSibling,_e=fe.nextSibling,Le=_e.firstChild,De=Le.firstChild,Te=Le.nextSibling;return re.addEventListener("mouseenter",()=>f(Q())),re.$$click=()=>ee(H),m(oe,F),m(fe,X),m(ae,U),a(ae,()=>H.name),m(Y,B),a(ie,()=>e("inventory.sku","SKU"),de),a(ie,()=>H.sku,null),a(ge,()=>H.category),a(pe,()=>T(H.unitCost)),m(_e,ce),Le.style.setProperty("font-weight","600"),(G?"#f44336":"var(--text-primary)")!=null?Le.style.setProperty("color",G?"#f44336":"var(--text-primary)"):Le.style.removeProperty("color"),a(Le,se,De),a(Le,()=>H.unitOfMeasure,null),Te.style.setProperty("color","var(--text-muted)"),a(Te,()=>G?(()=>{var $e=AT();return $e.firstChild,$e.style.setProperty("color","#f44336"),a($e,()=>e("inventory.lowStock","Low Stock"),null),$e})():e("inventory.inStock","In Stock")),Se($e=>m(re,k(Q()===g()),$e)),re})()}})}}),null),Se(H=>m(J,Z,H)),J}}),null),Se(J=>{var H=O,Q=b,se=P,G=t.placeholder||e("inventory.searchInventorys","Search inventorys by name, SKU, or category..."),re=t.disabled;return J.e=m(j,H,J.e),J.t=m(I,Q,J.t),J.a=m(M,se,J.a),G!==J.o&&tr(M,"placeholder",J.o=G),re!==J.i&&(M.disabled=J.i=re),J},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>M.value=r()),j})()};br(["input","keydown","click"]);var IT=he("<div>"),cf=he("<div><span>:</span><span>"),$T=he("<div><button> "),ET=he("<div><div><div><h3></h3><div>: </div></div><div><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span> <!>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span>");const TT=t=>{const{t:e}=or(),r=f=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(f),n=f=>new Date(f).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),i=f=>({in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}})[f]||{bg:"#f5f5f5",color:"#666"},o=f=>({in:"📦",out:"📤",transfer:"🔄",adjustment:"⚖️"})[f]||"📋",s=()=>t.movement,l={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},c={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},u={"font-weight":"600",color:"var(--text-primary)","text-align":"right"},h={"margin-bottom":"1.5rem"},y={"font-weight":"600","margin-bottom":"0.75rem","padding-bottom":"0.5rem","border-bottom":"2px solid var(--border-color)"},g=f=>({display:"inline-flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"600","text-transform":"uppercase","letter-spacing":"0.5px",background:i(f).bg,color:i(f).color});return R(On,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.movementDetails")},size:"lg",get children(){return R(ze,{get when(){return s()},get fallback(){return(()=>{var f=IT();return a(f,()=>e("common.noDataFound")),f})()},children:f=>(()=>{var x=ET(),S=x.firstChild,w=S.firstChild,E=w.firstChild,q=E.nextSibling,ee=q.firstChild,W=w.nextSibling,K=W.firstChild,te=S.nextSibling,$=te.firstChild,C=$.nextSibling,T=C.firstChild,O=T.firstChild,b=T.nextSibling,P=C.nextSibling,_=P.firstChild,z=_.firstChild,Z=_.nextSibling,k=Z.firstChild,F=P.nextSibling,X=F.firstChild,U=X.firstChild,B=X.nextSibling,ce=F.nextSibling,L=ce.firstChild,D=L.firstChild,j=D.nextSibling;j.nextSibling;var I=L.nextSibling,M=te.nextSibling,J=M.firstChild,H=J.nextSibling,Q=H.firstChild,se=Q.firstChild,G=Q.nextSibling,re=M.nextSibling,oe=re.firstChild,fe=oe.nextSibling,ae=fe.firstChild,Y=ae.firstChild,ie=ae.nextSibling,de=fe.nextSibling,ue=de.firstChild,ge=ue.firstChild,Pe=ue.nextSibling;return S.style.setProperty("display","flex"),S.style.setProperty("justify-content","space-between"),S.style.setProperty("align-items","center"),S.style.setProperty("margin-bottom","1.5rem"),S.style.setProperty("padding-bottom","1rem"),S.style.setProperty("border-bottom","2px solid var(--border-color)"),E.style.setProperty("margin","0 0 0.5rem 0"),E.style.setProperty("font-size","1.25rem"),a(E,()=>f().productName),q.style.setProperty("font-size","0.875rem"),q.style.setProperty("color","var(--text-muted)"),a(q,()=>e("inventory.sku"),ee),a(q,()=>f().productSku,null),W.$$click=()=>ut.generateMovementInvoice(f().id,e),K.style.setProperty("font-size","1.2rem"),a(K,()=>o(f().movementType)),a(W,()=>f().movementType,null),a($,()=>e("inventory.movementInformation")),a(T,()=>e("inventory.referenceNumber"),O),a(b,()=>f().referenceNumber),a(_,()=>e("common.quantity"),z),a(Z,()=>f().quantity,k),a(Z,()=>e("common.units"),null),a(X,()=>e("inventory.unitCost"),U),a(B,()=>r(f().unitCost)),a(L,()=>e("common.total"),D),a(L,()=>e("common.value"),j),a(I,()=>r(f().totalCost)),a(J,()=>e("inventory.locationInformation")),a(Q,()=>e("inventory.location"),se),a(G,()=>f().locationName),a(M,R(ze,{get when(){return f().fromLocationName},get children(){var pe=cf(),_e=pe.firstChild,Le=_e.firstChild,De=_e.nextSibling;return a(_e,()=>e("common.from"),Le),a(De,()=>f().fromLocationName),Se(Te=>{var $e=l,Ie=c,Re=u;return Te.e=m(pe,$e,Te.e),Te.t=m(_e,Ie,Te.t),Te.a=m(De,Re,Te.a),Te},{e:void 0,t:void 0,a:void 0}),pe}}),null),a(M,R(ze,{get when(){return f().invoiceId},get children(){var pe=cf(),_e=pe.firstChild,Le=_e.firstChild,De=_e.nextSibling;return a(_e,()=>e("common.invoice"),Le),a(De,()=>f().invoiceId),Se(Te=>{var $e=l,Ie=c,Re={...u,color:"var(--primary-color)"};return Te.e=m(pe,$e,Te.e),Te.t=m(_e,Ie,Te.t),Te.a=m(De,Re,Te.a),Te},{e:void 0,t:void 0,a:void 0}),pe}}),null),a(oe,()=>e("common.details")),a(ae,()=>e("common.createdBy"),Y),a(ie,()=>f().createdBy),a(ue,()=>e("common.created"),ge),a(Pe,()=>n(f().createdDate)),a(re,R(ze,{get when(){return f().notes},get children(){var pe=cf(),_e=pe.firstChild,Le=_e.firstChild,De=_e.nextSibling;return a(_e,()=>e("common.notes"),Le),a(De,()=>f().notes),Se(Te=>{var $e={...l,"border-bottom":"none"},Ie=c,Re={...u,"font-style":"italic","max-width":"60%","white-space":"pre-wrap"};return Te.e=m(pe,$e,Te.e),Te.t=m(_e,Ie,Te.t),Te.a=m(De,Re,Te.a),Te},{e:void 0,t:void 0,a:void 0}),pe}}),null),a(x,R(ze,{get when(){return t.onEdit},get children(){var pe=$T(),_e=pe.firstChild,Le=_e.firstChild;return pe.style.setProperty("display","flex"),pe.style.setProperty("justify-content","flex-end"),pe.style.setProperty("margin-top","1.5rem"),pe.style.setProperty("padding-top","1rem"),pe.style.setProperty("border-top","1px solid var(--border-color)"),_e.addEventListener("mouseleave",De=>{De.currentTarget.style.transform="translateY(0)",De.currentTarget.style.boxShadow="none"}),_e.addEventListener("mouseenter",De=>{De.currentTarget.style.transform="translateY(-1px)",De.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)"}),_e.$$click=()=>t.onEdit?.(f()),_e.style.setProperty("padding","0.5rem 1.5rem"),_e.style.setProperty("border-radius","var(--border-radius-sm)"),_e.style.setProperty("border","1px solid var(--primary-color)"),_e.style.setProperty("background","var(--primary-color)"),_e.style.setProperty("color","white"),_e.style.setProperty("cursor","pointer"),_e.style.setProperty("font-weight","500"),_e.style.setProperty("transition","all 0.2s ease"),a(_e,()=>e("common.edit"),Le),a(_e,()=>e("inventory.movement"),null),pe}}),null),Se(pe=>{var _e=g(f().movementType),Le=h,De=y,Te=l,$e=c,Ie=u,Re=l,Je=c,Be={...u,"font-size":"1.1rem",color:"var(--primary-color)"},Ke=l,Xe=c,at=u,ot=l,Qe=c,dt={...u,"font-size":"1.1rem",color:"var(--primary-color)"},ct=h,kt=y,gt=l,qe=c,Dt=u,Rt=h,St=y,Bt=l,fr=c,Qt=u,cr=l,xr=c,It=u;return pe.e=m(W,_e,pe.e),pe.t=m(te,Le,pe.t),pe.a=m($,De,pe.a),pe.o=m(C,Te,pe.o),pe.i=m(T,$e,pe.i),pe.n=m(b,Ie,pe.n),pe.s=m(P,Re,pe.s),pe.h=m(_,Je,pe.h),pe.r=m(Z,Be,pe.r),pe.d=m(F,Ke,pe.d),pe.l=m(X,Xe,pe.l),pe.u=m(B,at,pe.u),pe.c=m(ce,ot,pe.c),pe.w=m(L,Qe,pe.w),pe.m=m(I,dt,pe.m),pe.f=m(M,ct,pe.f),pe.y=m(J,kt,pe.y),pe.g=m(H,gt,pe.g),pe.p=m(Q,qe,pe.p),pe.b=m(G,Dt,pe.b),pe.T=m(re,Rt,pe.T),pe.A=m(oe,St,pe.A),pe.O=m(fe,Bt,pe.O),pe.I=m(ae,fr,pe.I),pe.S=m(ie,Qt,pe.S),pe.W=m(de,cr,pe.W),pe.C=m(ue,xr,pe.C),pe.B=m(Pe,It,pe.B),pe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),x})()})}})};br(["click"]);var nl=he("<div>"),kT=he("<div><label></label><select><option value>"),NT=he("<div><div><span>:</span><span>$"),LT=he("<form><div><label></label><select><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><input type=number min=0.01 step=0.01></div><div><label></label><input type=number min=0 step=0.01></div><div><label></label><input type=text></div><div><label> (<!>)</label><input type=text></div><div><label> (<!>)</label><textarea></textarea></div><div><button type=button></button><button type=submit>"),_0=he("<option> (<!>)");const RT=t=>{const{t:e}=or(),[r,n]=Ce("in"),[i,o]=Ce(""),[s,l]=Ce(""),[c,u]=Ce(""),[h,y]=Ce(""),[g,f]=Ce(""),[x,S]=Ce(""),[w,E]=Ce(""),[q,ee]=Ce(!1),[W,K]=Ce({});gi(()=>{const z=t.movement;z&&t.isOpen&&(n(z.movementType),o(z.quantity.toString()),l(z.unitCost.toString()),u(z.referenceNumber),y(z.notes),S(z.locationId),f(z.fromLocationId||""),E(z.invoiceId||""),K({}))});const te=()=>{const z={};return(!i()||parseFloat(i())<=0)&&(z.quantity=e("forms.requiredField")),(!s()||parseFloat(s())<0)&&(z.unitCost=e("forms.requiredField")),c().trim()||(z.referenceNumber=e("forms.requiredField")),x()||(z.locationId=e("forms.requiredField")),r()==="transfer"&&!g()&&(z.fromLocationId=e("forms.requiredField")),K(z),Object.keys(z).length===0},$=async z=>{if(z.preventDefault(),!(!te()||!t.movement)){ee(!0);try{const Z=t.movement,k=ut.getProductById(Z.productId),F=ut.getLocationById(x()),X=g()?ut.getLocationById(g()):null;if(!k||!F)throw new Error("Product or location not found");const U={...Z,movementType:r(),quantity:parseFloat(i()),unitCost:parseFloat(s()),totalCost:parseFloat(i())*parseFloat(s()),referenceNumber:c().trim(),notes:h().trim(),locationId:x(),locationName:F.name,fromLocationId:g()||void 0,fromLocationName:X?.name,invoiceId:w().trim()||void 0,lastModified:new Date().toISOString()};ut.updateMovement(Z.id,U),t.onMovementUpdated?.(),t.onClose(),C()}catch(Z){console.error("Error updating movement:",Z),K({submit:e("forms.saveError")})}finally{ee(!1)}}},C=()=>{n("in"),o(""),l(""),u(""),y(""),f(""),S(""),E(""),K({})},T=()=>{C(),t.onClose()},O={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",transition:"border-color 0.2s ease"},b={display:"block","margin-bottom":"0.25rem","font-weight":"500","font-size":"0.875rem"},P={color:"#d32f2f","font-size":"0.75rem","margin-top":"0.25rem"},_={"margin-bottom":"1rem"};return R(On,{get isOpen(){return t.isOpen},onClose:T,get title(){return e("inventory.editMovement","Edit Movement")},get children(){return R(ze,{get when(){return t.movement},get fallback(){return(()=>{var z=nl();return a(z,()=>e("common.loading")),z})()},get children(){var z=LT(),Z=z.firstChild,k=Z.firstChild,F=k.nextSibling,X=F.firstChild,U=X.nextSibling,B=U.nextSibling,ce=B.nextSibling,L=Z.nextSibling,D=L.firstChild,j=D.nextSibling,I=j.firstChild,M=L.nextSibling,J=M.firstChild,H=J.nextSibling,Q=M.nextSibling,se=Q.firstChild,G=se.nextSibling,re=Q.nextSibling,oe=re.firstChild,fe=oe.nextSibling,ae=re.nextSibling,Y=ae.firstChild,ie=Y.firstChild,de=ie.nextSibling;de.nextSibling;var ue=Y.nextSibling,ge=ae.nextSibling,Pe=ge.firstChild,pe=Pe.firstChild,_e=pe.nextSibling;_e.nextSibling;var Le=Pe.nextSibling,De=ge.nextSibling,Te=De.firstChild,$e=Te.nextSibling;return z.addEventListener("submit",$),a(k,()=>e("inventory.movementType")),F.addEventListener("change",Ie=>n(Ie.target.value)),a(X,()=>e("inventory.stockIn")),a(U,()=>e("inventory.stockOut")),a(B,()=>e("inventory.transfer")),a(ce,()=>e("inventory.adjustment")),a(D,(()=>{var Ie=Ee(()=>r()==="transfer");return()=>Ie()?e("inventory.toLocation"):e("inventory.location")})()),j.addEventListener("change",Ie=>S(Ie.target.value)),a(I,()=>e("modals.selectLocation")),a(j,R(Ut,{get each(){return ut.getActiveLocations()},children:Ie=>(()=>{var Re=_0(),Je=Re.firstChild,Be=Je.nextSibling;return Be.nextSibling,a(Re,()=>Ie.name,Je),a(Re,()=>Ie.type,Be),Se(()=>Re.value=Ie.id),Re})()}),null),a(L,R(ze,{get when(){return W().locationId},get children(){var Ie=nl();return a(Ie,()=>W().locationId),Se(Re=>m(Ie,P,Re)),Ie}}),null),a(z,R(ze,{get when(){return r()==="transfer"},get children(){var Ie=kT(),Re=Ie.firstChild,Je=Re.nextSibling,Be=Je.firstChild;return a(Re,()=>e("inventory.fromLocation")),Je.addEventListener("change",Ke=>f(Ke.target.value)),a(Be,()=>e("modals.selectLocation")),a(Je,R(Ut,{get each(){return ut.getActiveLocations().filter(Ke=>Ke.id!==x())},children:Ke=>(()=>{var Xe=_0(),at=Xe.firstChild,ot=at.nextSibling;return ot.nextSibling,a(Xe,()=>Ke.name,at),a(Xe,()=>Ke.type,ot),Se(()=>Xe.value=Ke.id),Xe})()}),null),a(Ie,R(ze,{get when(){return W().fromLocationId},get children(){var Ke=nl();return a(Ke,()=>W().fromLocationId),Se(Xe=>m(Ke,P,Xe)),Ke}}),null),Se(Ke=>{var Xe=_,at=b,ot={...O,"border-color":W().fromLocationId?"#d32f2f":"var(--border-color)"},Qe=q();return Ke.e=m(Ie,Xe,Ke.e),Ke.t=m(Re,at,Ke.t),Ke.a=m(Je,ot,Ke.a),Qe!==Ke.o&&(Je.disabled=Ke.o=Qe),Ke},{e:void 0,t:void 0,a:void 0,o:void 0}),Se(()=>Je.value=g()),Ie}}),M),a(J,()=>e("common.quantity")),H.$$input=Ie=>o(Ie.target.value),a(M,R(ze,{get when(){return W().quantity},get children(){var Ie=nl();return a(Ie,()=>W().quantity),Se(Re=>m(Ie,P,Re)),Ie}}),null),a(se,()=>e("inventory.unitCost")),G.$$input=Ie=>l(Ie.target.value),a(Q,R(ze,{get when(){return W().unitCost},get children(){var Ie=nl();return a(Ie,()=>W().unitCost),Se(Re=>m(Ie,P,Re)),Ie}}),null),a(z,R(ze,{get when(){return Ee(()=>!!i())()&&s()},get children(){var Ie=NT(),Re=Ie.firstChild,Je=Re.firstChild,Be=Je.firstChild,Ke=Je.nextSibling;return Ke.firstChild,Re.style.setProperty("display","flex"),Re.style.setProperty("justify-content","space-between"),Je.style.setProperty("font-weight","500"),a(Je,()=>e("common.total"),Be),Ke.style.setProperty("font-weight","600"),Ke.style.setProperty("color","var(--primary-color)"),a(Ke,()=>(parseFloat(i()||"0")*parseFloat(s()||"0")).toFixed(2),null),Se(Xe=>m(Ie,{..._,padding:"0.75rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)"},Xe)),Ie}}),re),a(oe,()=>e("inventory.referenceNumber")),fe.$$input=Ie=>u(Ie.target.value),a(re,R(ze,{get when(){return W().referenceNumber},get children(){var Ie=nl();return a(Ie,()=>W().referenceNumber),Se(Re=>m(Ie,P,Re)),Ie}}),null),a(Y,()=>e("inventory.invoiceNumber"),ie),a(Y,()=>e("common.optional"),de),ue.$$input=Ie=>E(Ie.target.value),a(Pe,()=>e("common.notes"),pe),a(Pe,()=>e("common.optional"),_e),Le.$$input=Ie=>y(Ie.target.value),a(z,R(ze,{get when(){return W().submit},get children(){var Ie=nl();return a(Ie,()=>W().submit),Se(Re=>m(Ie,{...P,"margin-bottom":"1rem"},Re)),Ie}}),De),De.style.setProperty("display","flex"),De.style.setProperty("gap","1rem"),De.style.setProperty("justify-content","flex-end"),Te.$$click=T,Te.style.setProperty("padding","0.5rem 1rem"),Te.style.setProperty("border","1px solid var(--border-color)"),Te.style.setProperty("border-radius","var(--border-radius-sm)"),Te.style.setProperty("background","white"),Te.style.setProperty("cursor","pointer"),a(Te,()=>e("common.cancel")),$e.style.setProperty("padding","0.5rem 1rem"),$e.style.setProperty("border","none"),$e.style.setProperty("border-radius","var(--border-radius-sm)"),$e.style.setProperty("background","var(--primary-color)"),$e.style.setProperty("color","white"),$e.style.setProperty("cursor","pointer"),$e.style.setProperty("font-weight","500"),a($e,(()=>{var Ie=Ee(()=>!!q());return()=>Ie()?e("modals.processing"):e("inventory.updateMovement","Update Movement")})()),Se(Ie=>{var Re=_,Je=b,Be=O,Ke=q(),Xe=_,at=b,ot={...O,"border-color":W().locationId?"#d32f2f":"var(--border-color)"},Qe=q(),dt=_,ct=b,kt={...O,"border-color":W().quantity?"#d32f2f":"var(--border-color)"},gt=e("modals.enterQuantity"),qe=q(),Dt=_,Rt=b,St={...O,"border-color":W().unitCost?"#d32f2f":"var(--border-color)"},Bt=e("modals.enterCost"),fr=q(),Qt=_,cr=b,xr={...O,"border-color":W().referenceNumber?"#d32f2f":"var(--border-color)"},It=e("modals.enterReference"),Ge=q(),Nt=_,At=b,Lt=O,Ue=e("inventory.invoiceNumber"),nt=q(),_t=_,Wt=b,We={...O,resize:"vertical","min-height":"80px"},vt=e("modals.addNotes"),Tt=q(),jt=q(),Kt=q();return Ie.e=m(Z,Re,Ie.e),Ie.t=m(k,Je,Ie.t),Ie.a=m(F,Be,Ie.a),Ke!==Ie.o&&(F.disabled=Ie.o=Ke),Ie.i=m(L,Xe,Ie.i),Ie.n=m(D,at,Ie.n),Ie.s=m(j,ot,Ie.s),Qe!==Ie.h&&(j.disabled=Ie.h=Qe),Ie.r=m(M,dt,Ie.r),Ie.d=m(J,ct,Ie.d),Ie.l=m(H,kt,Ie.l),gt!==Ie.u&&tr(H,"placeholder",Ie.u=gt),qe!==Ie.c&&(H.disabled=Ie.c=qe),Ie.w=m(Q,Dt,Ie.w),Ie.m=m(se,Rt,Ie.m),Ie.f=m(G,St,Ie.f),Bt!==Ie.y&&tr(G,"placeholder",Ie.y=Bt),fr!==Ie.g&&(G.disabled=Ie.g=fr),Ie.p=m(re,Qt,Ie.p),Ie.b=m(oe,cr,Ie.b),Ie.T=m(fe,xr,Ie.T),It!==Ie.A&&tr(fe,"placeholder",Ie.A=It),Ge!==Ie.O&&(fe.disabled=Ie.O=Ge),Ie.I=m(ae,Nt,Ie.I),Ie.S=m(Y,At,Ie.S),Ie.W=m(ue,Lt,Ie.W),Ue!==Ie.C&&tr(ue,"placeholder",Ie.C=Ue),nt!==Ie.B&&(ue.disabled=Ie.B=nt),Ie.v=m(ge,_t,Ie.v),Ie.k=m(Pe,Wt,Ie.k),Ie.x=m(Le,We,Ie.x),vt!==Ie.j&&tr(Le,"placeholder",Ie.j=vt),Tt!==Ie.q&&(Le.disabled=Ie.q=Tt),jt!==Ie.z&&(Te.disabled=Ie.z=jt),Kt!==Ie.P&&($e.disabled=Ie.P=Kt),Ie},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0,x:void 0,j:void 0,q:void 0,z:void 0,P:void 0}),Se(()=>F.value=r()),Se(()=>j.value=x()),Se(()=>H.value=i()),Se(()=>G.value=s()),Se(()=>fe.value=c()),Se(()=>ue.value=w()),Se(()=>Le.value=h()),z}})}})};br(["input","click"]);var DT=he("<div><div></div><div><div><label></label><select><option value=all></option><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),MT=he("<div><h2>"),FT=he("<div><label>"),OT=he("<div><label></label><select><option value>"),BT=he("<option>"),jT=he("<div><div>📦</div><div></div><div>"),VT=he("<div><div><div><div><span></span><h3></h3><span></span></div><div> • </div></div><div><div></div><div> <!> @ </div></div></div><div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div><span>:</span><span>"),qT=he("<span>"),zT=he("<span>• <!>: "),S0=he("<div><span>:</span><span>"),UT=he("<div><div><span>:</span><select><option value=10>10</option><option value=25>25</option><option value=50>50</option><option value=100>100</option></select><span></span></div><div><div><span>:</span><input type=number min=1><span> "),HT=he("<span>..."),GT=he("<button>");const WT=t=>{const{t:e}=or(),[r,n]=Ce(""),[i,o]=Ce(""),[s,l]=Ce("all"),[c,u]=Ce({start:"",end:""}),[h,y]=Ce(""),[g,f]=Ce(""),[x,S]=Ce(1),[w,E]=Ce(25),[q,ee]=Ce(null),[W,K]=Ce(!1),[te,$]=Ce(!1),C=Mt(()=>{let ue=ut.movements;if(t.filterBy==="product"&&t.filterId?ue=ue.filter(ge=>ge.productId===t.filterId):t.filterBy==="location"&&t.filterId&&(ue=ue.filter(ge=>ge.locationId===t.filterId)),r()&&(ue=ue.filter(ge=>ge.productId===r())),i()&&(ue=ue.filter(ge=>ge.locationId===i())),s()!=="all"&&(ue=ue.filter(ge=>ge.movementType===s())),c().start&&(ue=ue.filter(ge=>ge.createdDate>=c().start)),c().end&&(ue=ue.filter(ge=>ge.createdDate<=c().end+"T23:59:59Z")),h()){const ge=h().toLowerCase();ue=ue.filter(Pe=>Pe.productName.toLowerCase().includes(ge)||Pe.productSku.toLowerCase().includes(ge)||Pe.locationName.toLowerCase().includes(ge)||Pe.referenceNumber.toLowerCase().includes(ge)||Pe.notes.toLowerCase().includes(ge)||Pe.createdBy.toLowerCase().includes(ge)||Pe.invoiceId&&Pe.invoiceId.toLowerCase().includes(ge)||Pe.fromLocationName&&Pe.fromLocationName.toLowerCase().includes(ge)||Pe.movementType.toLowerCase().includes(ge))}return ue.sort((ge,Pe)=>new Date(Pe.createdDate).getTime()-new Date(ge.createdDate).getTime())});gi(()=>{r(),i(),s(),c(),h(),S(1)});const T=Mt(()=>{const ue=(x()-1)*w(),ge=ue+w();return C().slice(ue,ge)}),O=Mt(()=>Math.ceil(C().length/w())),b=Mt(()=>{const ue=C();return{total:ue.length,stockIn:ue.filter(ge=>ge.movementType==="in").length,stockOut:ue.filter(ge=>ge.movementType==="out").length,transfers:ue.filter(ge=>ge.movementType==="transfer").length,adjustments:ue.filter(ge=>ge.movementType==="adjustment").length,totalValue:ue.reduce((ge,Pe)=>ge+Pe.totalCost,0)}}),P={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},_={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},z={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)",cursor:"pointer"},Z={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},k={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem","margin-bottom":"2rem"},F={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","text-align":"center"},X={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},U={"font-size":"0.875rem",color:"var(--text-muted)","font-weight":"500"},B={padding:"1.5rem","margin-bottom":"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",transition:"all 0.2s ease"},ce={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"1rem"};function L(ue){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[ue]||{bg:"#f5f5f5",color:"#666"}}const D=ue=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:L(ue).bg,color:L(ue).color}),j={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"1rem"},I={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.5rem 0","border-bottom":"1px solid var(--border-color)"},M={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},J={"font-weight":"600",color:"var(--text-primary)"},H={display:"flex","justify-content":"space-between","align-items":"center","margin-top":"2rem",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},Q=ue=>({padding:"0.25rem 0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:ue?"var(--primary-color)":"var(--surface-color)",color:ue?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),se=ue=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ue),G=ue=>new Date(ue).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),re=ue=>({in:"📦",out:"📤",transfer:"🔄",adjustment:"⚖️"})[ue]||"📋",oe=()=>{n(""),o(""),l("all"),u({start:"",end:""}),y(""),S(1)},fe=ue=>{ee(ue),K(!0)},ae=ue=>{ee(ue),K(!1),$(!0)},Y=()=>{$(!1),ee(null)},ie=async ue=>{i()&&(ue+=" "+i()),Kf(s())&&(ue+=" "+Kf(s()));const ge=await vi.getInventory(ue),Pe=ut.parseInventoryData(ge);ut.updMovements(Pe)},de=()=>{};return(()=>{var ue=DT(),ge=ue.firstChild,Pe=ge.nextSibling,pe=Pe.firstChild,_e=pe.firstChild,Le=_e.nextSibling,De=Le.firstChild,Te=De.nextSibling,$e=Te.nextSibling,Ie=$e.nextSibling,Re=Ie.nextSibling,Je=pe.nextSibling,Be=Je.firstChild,Ke=Be.nextSibling,Xe=Je.nextSibling,at=Xe.firstChild,ot=at.nextSibling,Qe=Pe.nextSibling,dt=Qe.firstChild,ct=dt.firstChild,kt=ct.nextSibling,gt=dt.nextSibling,qe=gt.firstChild,Dt=qe.nextSibling,Rt=gt.nextSibling,St=Rt.firstChild,Bt=St.nextSibling,fr=Rt.nextSibling,Qt=fr.firstChild,cr=Qt.nextSibling,xr=fr.nextSibling,It=xr.firstChild,Ge=It.nextSibling,Nt=xr.nextSibling,At=Nt.firstChild,Lt=At.nextSibling;return a(ue,(()=>{var Ue=Ee(()=>!t.filterBy);return()=>Ue()&&(()=>{var nt=MT(),_t=nt.firstChild;return m(nt,P),_t.style.setProperty("margin","0"),_t.style.setProperty("font-size","1.5rem"),a(_t,()=>e("inventory.movements")),a(nt,R(ht,{variant:"outline",onClick:oe,get children(){return e("common.clearFilters")}}),null),nt})()})(),ge),a(ue,R(CT,{filters:{selectedLocation:i,movementType:s},onSearchResults:Ue=>{f(Ue),ie(Ue)},get placeholder(){return e("inventory.searchProductsStock","Search inventories...")},showResults:!1,maxResults:20}),ge),ge.style.setProperty("margin","20px"),m(Pe,_),a(Pe,(()=>{var Ue=Ee(()=>!t.filterBy);return()=>Ue()&&[(()=>{var nt=FT(),_t=nt.firstChild;return _t.style.setProperty("display","block"),_t.style.setProperty("margin-bottom","0.5rem"),_t.style.setProperty("font-weight","500"),a(_t,()=>e("inventory.product")),a(nt,R(gp,{onChange:Wt=>{console.log(Wt),n(Wt.id)},get placeholder(){return e("inventory.searchProductsImages","Search products to view images...")}}),null),nt})(),(()=>{var nt=OT(),_t=nt.firstChild,Wt=_t.nextSibling,We=Wt.firstChild;return _t.style.setProperty("display","block"),_t.style.setProperty("margin-bottom","0.5rem"),_t.style.setProperty("font-weight","500"),a(_t,()=>e("inventory.location")),Wt.addEventListener("change",vt=>o(vt.target.value)),a(We,()=>e("inventory.allLocations")),a(Wt,R(Ut,{get each(){return ut.locations},children:vt=>(()=>{var Tt=BT();return a(Tt,()=>vt.name),Se(()=>Tt.value=vt.id),Tt})()}),null),Se(vt=>m(Wt,z,vt)),Se(()=>Wt.value=i()),nt})()]})(),pe),_e.style.setProperty("display","block"),_e.style.setProperty("margin-bottom","0.5rem"),_e.style.setProperty("font-weight","500"),a(_e,()=>e("inventory.movementType")),Le.addEventListener("change",Ue=>{l(Ue.target.value),ie(g())}),a(De,()=>e("inventory.allTypes")),a(Te,()=>e("inventory.stockIn")),a($e,()=>e("inventory.stockOut")),a(Ie,()=>e("inventory.transfer")),a(Re,()=>e("inventory.adjustment")),Be.style.setProperty("display","block"),Be.style.setProperty("margin-bottom","0.5rem"),Be.style.setProperty("font-weight","500"),a(Be,()=>e("common.startDate")),Ke.addEventListener("change",Ue=>u(nt=>({...nt,start:Ue.target.value}))),at.style.setProperty("display","block"),at.style.setProperty("margin-bottom","0.5rem"),at.style.setProperty("font-weight","500"),a(at,()=>e("common.endDate")),ot.addEventListener("change",Ue=>u(nt=>({...nt,end:Ue.target.value}))),m(Qe,k),a(ct,()=>b().total),a(kt,()=>e("inventory.totalMovements")),a(qe,()=>b().stockIn),a(Dt,()=>e("inventory.stockIn")),a(St,()=>b().stockOut),a(Bt,()=>e("inventory.stockOut")),a(Qt,()=>b().transfers),a(cr,()=>e("inventory.transfers")),a(It,()=>b().adjustments),a(Ge,()=>e("inventory.adjustments")),At.$$click=de,a(At,()=>se(b().totalValue)),a(Lt,()=>e("inventory.totalValue")),a(ue,(()=>{var Ue=Ee(()=>T().length===0);return()=>Ue()?(()=>{var nt=jT(),_t=nt.firstChild,Wt=_t.nextSibling,We=Wt.nextSibling;return nt.style.setProperty("text-align","center"),nt.style.setProperty("padding","3rem"),nt.style.setProperty("color","var(--text-muted)"),nt.style.setProperty("background","var(--surface-color)"),nt.style.setProperty("border-radius","var(--border-radius)"),nt.style.setProperty("border","1px solid var(--border-color)"),_t.style.setProperty("font-size","1.5rem"),_t.style.setProperty("margin-bottom","1rem"),Wt.style.setProperty("font-size","1.1rem"),Wt.style.setProperty("margin-bottom","0.5rem"),a(Wt,()=>e("inventory.noMovementsFound")),We.style.setProperty("font-size","0.875rem"),a(We,()=>e("inventory.tryAdjustingFilters")),nt})():[R(Ut,{get each(){return T()},children:nt=>(()=>{var _t=VT(),Wt=_t.firstChild,We=Wt.firstChild,vt=We.firstChild,Tt=vt.firstChild,jt=Tt.nextSibling,Kt=jt.nextSibling,rr=vt.nextSibling,yr=rr.firstChild,nr=We.nextSibling,ur=nr.firstChild,Ft=ur.nextSibling,$t=Ft.firstChild,wt=$t.nextSibling;wt.nextSibling;var Zt=Wt.nextSibling,lt=Zt.firstChild,er=lt.firstChild,ir=er.firstChild,sr=ir.firstChild,_r=ir.nextSibling,lr=er.nextSibling,Lr=lr.firstChild,on=Lr.firstChild,Ur=Lr.nextSibling,Yr=lt.nextSibling,Et=Yr.firstChild,bn=Et.firstChild,_i=bn.firstChild,Si=bn.nextSibling;return _t.addEventListener("mouseleave",mr=>{mr.currentTarget.style.transform="translateY(0)",mr.currentTarget.style.boxShadow="none"}),_t.addEventListener("mouseenter",mr=>{mr.currentTarget.style.transform="translateY(-2px)",mr.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),_t.$$click=()=>fe(nt),m(Wt,ce),vt.style.setProperty("display","flex"),vt.style.setProperty("align-items","center"),vt.style.setProperty("gap","0.5rem"),vt.style.setProperty("margin-bottom","0.5rem"),Tt.style.setProperty("font-size","1.2rem"),a(Tt,()=>re(nt.movementType)),jt.style.setProperty("margin","0"),jt.style.setProperty("font-size","1.1rem"),a(jt,()=>nt.productName),a(Kt,()=>nt.movementType),a(vt,(()=>{var mr=Ee(()=>!!nt.invoiceId);return()=>mr()&&(()=>{var Nr=qT();return Nr.style.setProperty("padding","0.2rem 0.5rem"),Nr.style.setProperty("border-radius","var(--border-radius-sm)"),Nr.style.setProperty("font-size","0.7rem"),Nr.style.setProperty("font-weight","500"),Nr.style.setProperty("background","var(--primary-color)"),Nr.style.setProperty("color","white"),a(Nr,()=>e("inventory.bulk")),Nr})()})(),null),rr.style.setProperty("font-size","0.875rem"),rr.style.setProperty("color","var(--text-muted)"),a(rr,()=>nt.productSku,yr),a(rr,()=>G(nt.createdDate),null),a(rr,(()=>{var mr=Ee(()=>!!nt.invoiceId);return()=>mr()&&(()=>{var Nr=zT(),Vr=Nr.firstChild,gn=Vr.nextSibling;return gn.nextSibling,Nr.style.setProperty("margin-left","0.5rem"),Nr.style.setProperty("font-weight","500"),a(Nr,()=>e("common.invoice"),gn),a(Nr,()=>nt.invoiceId,null),Nr})()})(),null),nr.style.setProperty("text-align","right"),ur.style.setProperty("font-size","1.25rem"),ur.style.setProperty("font-weight","700"),ur.style.setProperty("color","var(--primary-color)"),a(ur,()=>se(nt.totalCost)),Ft.style.setProperty("font-size","0.875rem"),Ft.style.setProperty("color","var(--text-muted)"),a(Ft,()=>nt.quantity,$t),a(Ft,()=>e("common.units"),wt),a(Ft,()=>se(nt.unitCost),null),m(Zt,j),a(ir,()=>e("inventory.location"),sr),a(_r,()=>nt.locationName),a(lt,(()=>{var mr=Ee(()=>!!nt.fromLocationName);return()=>mr()&&(()=>{var Nr=S0(),Vr=Nr.firstChild,gn=Vr.firstChild,qr=Vr.nextSibling;return a(Vr,()=>e("common.from"),gn),a(qr,()=>nt.fromLocationName),Se(Rr=>{var Bn=I,Hn=M,Pi=J;return Rr.e=m(Nr,Bn,Rr.e),Rr.t=m(Vr,Hn,Rr.t),Rr.a=m(qr,Pi,Rr.a),Rr},{e:void 0,t:void 0,a:void 0}),Nr})()})(),lr),a(Lr,()=>e("common.reference"),on),a(Ur,()=>nt.referenceNumber),a(bn,()=>e("common.createdBy"),_i),a(Si,()=>nt.createdBy),a(Yr,(()=>{var mr=Ee(()=>!!nt.notes);return()=>mr()&&(()=>{var Nr=S0(),Vr=Nr.firstChild,gn=Vr.firstChild,qr=Vr.nextSibling;return a(Vr,()=>e("common.notes"),gn),a(qr,()=>nt.notes),Se(Rr=>{var Bn={...I,"border-bottom":"none"},Hn=M,Pi={...J,"max-width":"200px","text-align":"right","font-style":"italic"};return Rr.e=m(Nr,Bn,Rr.e),Rr.t=m(Vr,Hn,Rr.t),Rr.a=m(qr,Pi,Rr.a),Rr},{e:void 0,t:void 0,a:void 0}),Nr})()})(),null),Se(mr=>{var Nr={...B,"border-left":nt.invoiceId?"4px solid var(--primary-color)":"1px solid var(--border-color)",cursor:"pointer"},Vr=D(nt.movementType),gn=I,qr=M,Rr=J,Bn=I,Hn=M,Pi=J,Hr=I,qi=M,zi=J;return mr.e=m(_t,Nr,mr.e),mr.t=m(Kt,Vr,mr.t),mr.a=m(er,gn,mr.a),mr.o=m(ir,qr,mr.o),mr.i=m(_r,Rr,mr.i),mr.n=m(lr,Bn,mr.n),mr.s=m(Lr,Hn,mr.s),mr.h=m(Ur,Pi,mr.h),mr.r=m(Et,Hr,mr.r),mr.d=m(bn,qi,mr.d),mr.l=m(Si,zi,mr.l),mr},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),_t})()}),Ee(()=>Ee(()=>O()>1)()&&(()=>{var nt=UT(),_t=nt.firstChild,Wt=_t.firstChild,We=Wt.firstChild,vt=Wt.nextSibling,Tt=vt.nextSibling,jt=_t.nextSibling,Kt=jt.firstChild,rr=Kt.firstChild,yr=rr.firstChild,nr=rr.nextSibling,ur=nr.nextSibling,Ft=ur.firstChild;return m(nt,H),_t.style.setProperty("display","flex"),_t.style.setProperty("align-items","center"),_t.style.setProperty("gap","0.5rem"),Wt.style.setProperty("font-size","0.875rem"),Wt.style.setProperty("color","var(--text-muted)"),a(Wt,()=>e("common.showPerPage","Show per page"),We),vt.addEventListener("change",$t=>{E(Number($t.target.value)),S(1)}),vt.style.setProperty("padding","0.25rem 0.5rem"),vt.style.setProperty("border","1px solid var(--border-color)"),vt.style.setProperty("border-radius","var(--border-radius-sm)"),vt.style.setProperty("background","var(--surface-color)"),vt.style.setProperty("cursor","pointer"),vt.style.setProperty("font-size","0.875rem"),Tt.style.setProperty("font-size","0.875rem"),Tt.style.setProperty("color","var(--text-muted)"),Tt.style.setProperty("margin-left","1rem"),a(Tt,()=>e("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:(x()-1)*w()+1,end:Math.min(x()*w(),C().length),total:C().length})),jt.style.setProperty("display","flex"),jt.style.setProperty("align-items","center"),jt.style.setProperty("gap","0.5rem"),a(jt,R(ht,{variant:"outline",size:"sm",onClick:()=>S(1),get disabled(){return x()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.first","First")}}),Kt),a(jt,R(ht,{variant:"outline",size:"sm",onClick:()=>S($t=>Math.max(1,$t-1)),get disabled(){return x()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.previous")}}),Kt),a(jt,()=>{const $t=[],wt=O(),Zt=x();if(wt<=7)for(let lt=1;lt<=wt;lt++)$t.push(lt);else{$t.push(1),Zt>3&&$t.push("...");for(let lt=Math.max(2,Zt-1);lt<=Math.min(wt-1,Zt+1);lt++)$t.includes(lt)||$t.push(lt);Zt<wt-2&&$t.push("..."),$t.includes(wt)||$t.push(wt)}return R(Ut,{each:$t,children:lt=>lt==="..."?(()=>{var er=HT();return er.style.setProperty("padding","0 0.5rem"),er.style.setProperty("color","var(--text-muted)"),er})():(()=>{var er=GT();return er.$$click=()=>S(lt),a(er,lt),Se(ir=>m(er,Q(lt===x()),ir)),er})()})},Kt),a(jt,R(ht,{variant:"outline",size:"sm",onClick:()=>S($t=>Math.min(O(),$t+1)),get disabled(){return x()===O()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.next")}}),Kt),a(jt,R(ht,{variant:"outline",size:"sm",onClick:()=>S(O()),get disabled(){return x()===O()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.last","Last")}}),Kt),Kt.style.setProperty("display","flex"),Kt.style.setProperty("align-items","center"),Kt.style.setProperty("gap","0.5rem"),Kt.style.setProperty("margin-left","1rem"),rr.style.setProperty("font-size","0.875rem"),rr.style.setProperty("color","var(--text-muted)"),a(rr,()=>e("common.page","Page"),yr),nr.addEventListener("change",$t=>{const wt=Number($t.target.value);wt>=1&&wt<=O()&&S(wt)}),nr.style.setProperty("width","4rem"),nr.style.setProperty("padding","0.25rem 0.5rem"),nr.style.setProperty("border","1px solid var(--border-color)"),nr.style.setProperty("border-radius","var(--border-radius-sm)"),nr.style.setProperty("background","var(--surface-color)"),nr.style.setProperty("text-align","center"),nr.style.setProperty("font-size","0.875rem"),ur.style.setProperty("font-size","0.875rem"),ur.style.setProperty("color","var(--text-muted)"),a(ur,()=>e("common.of","of"),Ft),a(ur,O,null),Se(()=>tr(nr,"max",O())),Se(()=>vt.value=w()),Se(()=>nr.value=x()),nt})())]})(),null),a(ue,R(TT,{get isOpen(){return W()},onClose:()=>{K(!1),ee(null)},get movement(){return q()},onEdit:ae}),null),a(ue,R(ze,{get when(){return pr.hasPermission("read_write")},get children(){return R(RT,{get isOpen(){return te()},onClose:()=>{$(!1),ee(null)},get movement(){return q()},onMovementUpdated:Y})}}),null),Se(Ue=>{var nt=z,_t=Z,Wt=Z,We=F,vt=X,Tt=U,jt=F,Kt={...X,color:"#2d7d32"},rr=U,yr=F,nr={...X,color:"#d32f2f"},ur=U,Ft=F,$t={...X,color:"#1976d2"},wt=U,Zt=F,lt={...X,color:"#f57c00"},er=U,ir=F,sr=X,_r=U;return Ue.e=m(Le,nt,Ue.e),Ue.t=m(Ke,_t,Ue.t),Ue.a=m(ot,Wt,Ue.a),Ue.o=m(dt,We,Ue.o),Ue.i=m(ct,vt,Ue.i),Ue.n=m(kt,Tt,Ue.n),Ue.s=m(gt,jt,Ue.s),Ue.h=m(qe,Kt,Ue.h),Ue.r=m(Dt,rr,Ue.r),Ue.d=m(Rt,yr,Ue.d),Ue.l=m(St,nr,Ue.l),Ue.u=m(Bt,ur,Ue.u),Ue.c=m(fr,Ft,Ue.c),Ue.w=m(Qt,$t,Ue.w),Ue.m=m(cr,wt,Ue.m),Ue.f=m(xr,Zt,Ue.f),Ue.y=m(It,lt,Ue.y),Ue.g=m(Ge,er,Ue.g),Ue.p=m(Nt,ir,Ue.p),Ue.b=m(At,sr,Ue.b),Ue.T=m(Lt,_r,Ue.T),Ue},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),Se(()=>Le.value=s()),Se(()=>Ke.value=c().start),Se(()=>ot.value=c().end),ue})()};br(["click"]);var YT=he("<div><p>📋 "),KT=he("<div>"),JT=he("<div><div>📊</div><h3></h3><p></p><div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=name></option><option value=sku></option><option value=category>"),QT=he("<div><div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div>%</div><div></div></div></div><div></div><div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),XT=he("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),ZT=he("<div><div>✅</div><h3></h3><p>"),ek=he("<div><div><h3>📋 </h3><p></p></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div></div><div>"),tk=he("<div><div><div><h2>📋 </h2><button>×"),P0=he("<option>"),rk=he("<div>..."),nk=he("<tr><td><div></div><div> • </div></td><td><div></div></td><td><div></div></td><td><div></div></td><td><div>"),ik=he("<tr><td><div></div></td><td><div></div><div> • <!> • </div></td><td><div></div></td><td><input type=number placeholder=0 min=0 step=0.01></td><td><div></div></td><td><input type=text>");const ok=t=>{const{t:e}=or(),[r,n]=Ce([]),[i,o]=Ce(!1),[s,l]=Ce(!1),[c,u]=Ce("all"),[h,y]=Ce("all"),[g,f]=Ce("name"),[x,S]=Ce([]),[w,E]=Ce("setup"),q=async()=>{try{o(!0);const U=await vi.getProducts("prod");if(!U||typeof U!="object"){console.warn("No API results, using local store"),n(ut.products);return}const B=Object.keys(U),ce=D=>{let I=U[D];return{id:D,name:I.name||"Unknown Product",businessId:I.businessId||"",sku:I.code||I.sku||"",UPC:I.UPC||"",numCode:I.codeN||"",category:I.category||"General",unitCost:I.unitCost||0,unitOfMeasure:I.unitOfMeasure||"pcs",minStockLevel:I.minStockLevel||0,maxStockLevel:I.maxStockLevel||100,isActive:I.isActive!==!1,description:I.description||"",createdDate:I.createdAt||new Date().toISOString(),lastModified:I.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(I.sellingPrice||I.price||"0")}},L=B.map(ce);n(L)}catch(U){console.error("Failed to load products from API:",U),n(ut.products)}finally{o(!1)}},ee=Mt(()=>[...new Set(r().map(B=>B.category).filter(B=>B))].sort()),W=Mt(()=>{let U=r().filter(B=>B.isActive);return h()!=="all"&&(U=U.filter(B=>B.category===h())),U.sort((B,ce)=>{switch(g()){case"name":return B.name.localeCompare(ce.name);case"sku":return B.sku.localeCompare(ce.sku);case"category":return B.category.localeCompare(ce.category)||B.name.localeCompare(ce.name);default:return 0}}),U}),K=Mt(()=>ut.getActiveLocations()),te=(U,B)=>B&&B!=="all"?ut.getStockByProductAndLocation(U,B)?.quantity||0:ut.getTotalStockByProduct(U),$=()=>{const U=W().map(B=>{const ce=te(B.id,c()!=="all"?c():void 0);return{productId:B.id,systemQuantity:ce,physicalCount:null,notes:"",variance:0,product:B}});S(U),E("counting")},C=(U,B)=>{S(ce=>ce.map(L=>{if(L.productId===U){const D=B,j=D!==null?D-L.systemQuantity:0;return{...L,physicalCount:D,variance:j}}return L}))},T=(U,B)=>{S(ce=>ce.map(L=>L.productId===U?{...L,notes:B}:L))},O=Mt(()=>{const U=x(),B=U.length,ce=U.filter(I=>I.physicalCount!==null).length,L=U.filter(I=>I.variance!==0).length,D=U.filter(I=>I.variance>0).length,j=U.filter(I=>I.variance<0).length;return{totalProducts:B,countedProducts:ce,remainingProducts:B-ce,variances:L,positiveVariances:D,negativeVariances:j,isComplete:ce===B}}),b=()=>{const U=x().filter(D=>D.physicalCount!==null&&D.variance!==0);if(U.length===0)return null;const B=[e("inventory.product","Product"),e("inventory.sku","SKU"),e("inventory.category","Category"),e("inventory.location","Location"),e("inventory.systemQty","System Qty"),e("inventory.physicalCount","Physical Count"),e("inventory.variance","Variance"),e("inventory.adjustment","Adjustment"),e("common.notes","Notes"),e("common.date","Date")],ce=U.map(D=>[`"${D.product.name}"`,`"${D.product.sku}"`,`"${D.product.category}"`,`"${z()}"`,D.systemQuantity,D.physicalCount,D.variance,D.variance>0?e("inventory.stockIncrease","Stock Increase"):e("inventory.stockDecrease","Stock Decrease"),`"${D.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")}"`,`"${Z()}"`]);return[B.join(","),...ce.map(D=>D.join(","))].join(`
`)},P=()=>{const U=b();if(!U){alert(e("inventory.noAdjustmentsToDownload","No adjustments to download"));return}const B=new Blob([U],{type:"text/csv;charset=utf-8;"}),ce=document.createElement("a");if(ce.download!==void 0){const L=URL.createObjectURL(B);ce.setAttribute("href",L),ce.setAttribute("download",`inventory-adjustments-${Z().replace(/[/:,\s]/g,"-")}.csv`),ce.style.visibility="hidden",document.body.appendChild(ce),ce.click(),document.body.removeChild(ce)}},_=async(U=!0)=>{try{l(!0),console.log(x());const B=M=>{let J=ut.getProductById(M.productId),H=ut.getStockByProductAndLocation(M.productId,c()),Q=parseFloat(H?.averageCost+""),se=parseFloat(H?.quantity+"");return{product:{id:M.productId,label:J?.name,code:J?.code},productId:M?.productId,reason:"Physical Count Adjustment",notes:M?.notes||"Physical inventory adjustment",quantity:M?.variance,unitCost:Q}},ce=x().filter(M=>M.physicalCount!==null&&M.variance!==0).map(B);let L="ADJ_"+kg();const D=new Date().toISOString(),j={ssg_inventory_key:Lu(),invoiceId:L,referenceNumber:kg(),movementType:"adjustment",type:"adjustment",locationId:c(),items:ce,products:ce,generalNotes:"Physical inventory adjustment",description:"Physical Count Adjustment",invoice:L,store:c(),createdBy:"admin",createDate:D};console.log("Saving inventory bulkRequest:",j);const I=await vi.addInventory(j);U&&ce.length>0&&P(),console.log("Saving inventory adjustments:",ce),await new Promise(M=>setTimeout(M,1e3)),t.onClose()}catch(B){console.error("Failed to save inventory adjustments:",B)}finally{l(!1)}},z=Mt(()=>c()==="all"?"All Locations":K().find(B=>B.id===c())?.name||"Unknown Location"),Z=()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),k=async()=>{await ut.fecthInventory("prod"),await q()};wn(async()=>{t.selectedLocationId&&u(t.selectedLocationId),k()});const F=()=>{const U=window.open("","_blank");if(!U){alert("Please allow pop-ups to print the counting sheet");return}const B=X();U.document.write(B),U.document.close(),U.onload=()=>{U.print(),U.onafterprint=()=>{U.close()}}},X=()=>{const U=W().map((B,ce)=>{const L=te(B.id,c()!=="all"?c():void 0);return`
        <tr>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${ce+1}</td>
          <td style="border: 1px solid #000; padding: 8px; font-family: monospace;">${B.sku}</td>
          <td style="border: 1px solid #000; padding: 8px;">
            <div style="font-weight: 500;">${B.name}</div>
            ${B.UPC?`<div style="font-size: 0.8em; color: #666;">UPC: ${B.UPC}</div>`:""}
          </td>
         
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${B.unitOfMeasure}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">${L}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; background-color: #f9f9f9;"></td>
          <td style="border: 1px solid #000; padding: 8px;"></td>
        </tr>
      `}).join("");return`
      <!DOCTYPE html>
      <html>
      <head>
        <title> ${z()}_${h()}_${e("inventory.countingSheet","Inventory Counting Sheet")} - ${Z()}</title>
        <style>
          @page {
            size: letter;
            margin: 0.5in 0.8in 0.5in 0.8in;
            @top-center {
              content: "${z()} | ${h()==="all"?e("inventory.allCategories","All Categories"):h()} | Page " counter(page);
              font-size: 10px;
              font-weight: bold;
              border-bottom: 1px solid #ccc;
              padding-bottom: 5px;
            }
          }
          body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            margin: 0;
            padding: 0;
            position: relative;
          }
          .page-identifier {
            position: fixed;
            left: 5px;
            top: 50%;
            transform: rotate(-90deg) translateX(-50%);
            transform-origin: left center;
            background: #f0f0f0;
            padding: 5px 15px;
            border: 1px solid #ccc;
            font-weight: bold;
            font-size: 10px;
            color: #333;
            z-index: 100;
          }
          .page-identifier-right {
            position: fixed;
            right: 5px;
            top: 50%;
            transform: rotate(90deg) translateX(50%);
            transform-origin: right center;
            background: #f0f0f0;
            padding: 5px 15px;
            border: 1px solid #ccc;
            font-weight: bold;
            font-size: 10px;
            color: #333;
            z-index: 100;
          }
          h1 {
            text-align: center;
            margin: 0 0 10px 0;
            font-size: 22px;
            page-break-after: avoid;
          }
          .header-info {
            text-align: center;
            margin-bottom: 20px;
            background: #f8f8f8;
            padding: 10px;
            border: 2px solid #333;
            page-break-after: avoid;
          }
          .page-header {
            display: none;
            text-align: center;
            background: #e0e0e0;
            padding: 8px;
            border: 1px solid #333;
            margin-bottom: 10px;
            font-weight: bold;
            font-size: 11px;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
          }
          th {
            background-color: #333;
            color: white;
            padding: 8px;
            text-align: left;
            font-weight: bold;
            border: 1px solid #000;
          }
          .summary-table {
            width: 50%;
            margin: 20px auto;
            /*page-break-before: auto;*/
          }
          .signature-section {
            margin-top: 40px;
            display: flex;
            justify-content: space-between;
            page-break-before: auto;
          }
          .signature-box {
            width: 45%;
            text-align: center;
          }
          .signature-line {
            border-bottom: 1px solid #000;
            margin-bottom: 5px;
            height: 30px;
          }
          @media print {
            body { margin: 0; }
            .page-identifier, .page-identifier-right { display: block; }
            .page-header { display: block; }
            tr { page-break-inside: avoid; }
            thead { display: table-header-group; }
            tfoot { display: table-footer-group; }
            .header-info { page-break-after: avoid; }
            h1 { page-break-after: avoid; }
            table { page-break-before: auto; }
            /*.summary-table { page-break-before: always; }*/
            .signature-section { page-break-before: avoid; }
            
            /* Repeat headers on each page */
            @page :first {
              @top-center { content: none; }
            }
            
            /* Force page headers to show on continuation pages */
            tbody::before {
              content: "";
              display: block;
              height: 0;
            }
          }
        </style>
      </head>
      <body>
        <!-- Page identifiers for multi-page documents -->
        <div class="page-identifier-right">
          ${z()} - ${h()==="all"?e("inventory.allCategories","All Categories"):h()} - ${Z()} 
        </div>
       
        
        <h1>${e("inventory.inventoryCountingSheetTitle","INVENTORY COUNTING SHEET")}</h1>
        <div class="header-info">
          <p><strong>${e("inventory.location","Location")}:</strong> ${z()}</p>
          <p><strong>${e("common.category","Category")}:</strong> ${h()==="all"?e("inventory.allCategories","All Categories"):h()}</p>
          <p><strong>${e("common.date","Date")}:</strong> ${Z()}</p>
          <p style="margin-top: 10px;">
            <span style="margin-right: 30px;">${e("inventory.countedBy","Counted by")}: _________________________</span>
            <span>${e("inventory.verifiedBy","Verified by")}: _________________________</span>
          </p>
        </div>

        <!-- Page header for continuation pages (hidden on first page) -->
        <div class="page-header">
          ${z()} | ${h()==="all"?e("inventory.allCategories","All Categories"):h()} | ${Z()} 
        </div>

        <table>
          <thead>
            <tr>
              <th style="width: 5%; text-align: center;">#</th>
              <th style="width: 12%;">${e("inventory.sku","SKU")}</th>
              <th style="width: 25%;">${e("inventory.productName","Product Name")}</th>
              <th style="width: 8%; text-align: center;">${e("inventory.unit","Unit")}</th>
              <th style="width: 10%; text-align: center;">${e("inventory.systemQty","System Qty")}</th>
              <th style="width: 12%; text-align: center; background-color: #f0f0f0;">${e("inventory.physicalCount","Physical Count")}</th>
              <th style="width: 28%;">${e("common.notes","Notes")}</th>
            </tr>
            <!-- Repeat header info row for clarity -->
            <tr style="background-color: #f8f8f8; font-size: 10px;">
              <td colspan="8" style="text-align: center; padding: 4px; border: 1px solid #000; font-weight: bold;">
                📍 ${z()} | 📂 ${h()==="all"?e("inventory.allCategories","All Categories"):h()} | 📅 ${Z()}
              </td>
            </tr>
          </thead>
          <tbody>
            ${U}
          </tbody>
        </table>
        
        <!-- Summary section with location/category context -->
        <div style="margin: 30px 0; padding: 15px; background: #f8f8f8;">
          <h3 style="text-align: center; margin: 0 0 15px 0; font-size: 16px;">
            ${e("inventory.summaryFor","SUMMARY FOR")}: ${z()} - ${h()==="all"?e("inventory.allCategories","All Categories"):h()}
          </h3>
          
          <table class="summary-table">
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.totalProductsListed","Total Products Listed")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">
                ${W().length}
              </td>
            </tr>
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.itemsCounted","Items Counted")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center;">
                ___________
              </td>
            </tr>
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.discrepanciesFound","Discrepancies Found")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center;">
                ___________
              </td>
            </tr>
          </table>
        </div>
        
        <div class="signature-section">
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.counterSignature","Counter Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.supervisorSignature","Supervisor Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
        </div>
      </body>
      </html>
    `};return R(ze,{get when(){return t.isOpen},get children(){var U=tk(),B=U.firstChild,ce=B.firstChild,L=ce.firstChild;L.firstChild;var D=L.nextSibling;return U.style.setProperty("position","fixed"),U.style.setProperty("top","0"),U.style.setProperty("left","0"),U.style.setProperty("right","0"),U.style.setProperty("bottom","0"),U.style.setProperty("background","rgba(0, 0, 0, 0.5)"),U.style.setProperty("z-index","1000"),U.style.setProperty("display","flex"),U.style.setProperty("align-items","center"),U.style.setProperty("justify-content","center"),B.style.setProperty("background","white"),B.style.setProperty("border-radius","var(--border-radius)"),B.style.setProperty("padding","2rem"),B.style.setProperty("width","95%"),B.style.setProperty("height","95%"),B.style.setProperty("max-width","1400px"),B.style.setProperty("overflow-y","auto"),B.style.setProperty("position","relative"),ce.style.setProperty("display","flex"),ce.style.setProperty("justify-content","space-between"),ce.style.setProperty("align-items","center"),ce.style.setProperty("margin-bottom","2rem"),ce.style.setProperty("border-bottom","1px solid var(--border-color)"),ce.style.setProperty("padding-bottom","1rem"),L.style.setProperty("margin","0"),L.style.setProperty("font-size","1.5rem"),a(L,()=>e("inventory.physicalInventoryCount","Physical Inventory Count"),null),is(D,"click",t.onClose,!0),D.style.setProperty("background","none"),D.style.setProperty("border","none"),D.style.setProperty("font-size","1.5rem"),D.style.setProperty("cursor","pointer"),D.style.setProperty("padding","0.5rem"),a(B,R(ze,{get when(){return w()==="setup"},get children(){var j=JT(),I=j.firstChild,M=I.nextSibling,J=M.nextSibling,H=J.nextSibling,Q=H.firstChild,se=Q.firstChild,G=se.firstChild,re=se.nextSibling,oe=re.firstChild,fe=Q.nextSibling,ae=fe.firstChild,Y=ae.firstChild,ie=ae.nextSibling,de=ie.firstChild,ue=fe.nextSibling,ge=ue.firstChild,Pe=ge.firstChild,pe=ge.nextSibling,_e=pe.firstChild,Le=_e.nextSibling,De=Le.nextSibling;return j.style.setProperty("text-align","center"),j.style.setProperty("padding","2rem"),j.style.setProperty("max-width","600px"),j.style.setProperty("margin","0 auto"),I.style.setProperty("font-size","3rem"),I.style.setProperty("margin-bottom","1rem"),M.style.setProperty("margin-bottom","1rem"),a(M,()=>e("inventory.setupPhysicalCount","Setup Physical Inventory Count")),J.style.setProperty("margin-bottom","2rem"),J.style.setProperty("color","var(--text-muted)"),a(J,()=>e("inventory.setupDescription","Configure your physical inventory count settings and begin the counting process.")),H.style.setProperty("display","grid"),H.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),H.style.setProperty("gap","1rem"),H.style.setProperty("margin-bottom","2rem"),H.style.setProperty("padding","1rem"),H.style.setProperty("background","var(--surface-color)"),H.style.setProperty("border-radius","var(--border-radius)"),H.style.setProperty("text-align","left"),se.style.setProperty("display","block"),se.style.setProperty("margin-bottom","0.5rem"),se.style.setProperty("font-weight","500"),a(se,()=>e("inventory.location","Location"),G),re.addEventListener("change",Te=>u(Te.target.value)),re.style.setProperty("width","100%"),re.style.setProperty("padding","0.5rem"),re.style.setProperty("border","1px solid var(--border-color)"),re.style.setProperty("border-radius","var(--border-radius-sm)"),a(oe,()=>e("inventory.allLocations","All Locations")),a(re,R(Ut,{get each(){return K()},children:Te=>(()=>{var $e=P0();return a($e,()=>Te.name),Se(()=>$e.value=Te.id),$e})()}),null),ae.style.setProperty("display","block"),ae.style.setProperty("margin-bottom","0.5rem"),ae.style.setProperty("font-weight","500"),a(ae,()=>e("inventory.category","Category"),Y),ie.addEventListener("change",Te=>y(Te.target.value)),ie.style.setProperty("width","100%"),ie.style.setProperty("padding","0.5rem"),ie.style.setProperty("border","1px solid var(--border-color)"),ie.style.setProperty("border-radius","var(--border-radius-sm)"),a(de,()=>e("products.allCategories","All Categories")),a(ie,R(Ut,{get each(){return ee()},children:Te=>(()=>{var $e=P0();return $e.value=Te,a($e,Te),$e})()}),null),ge.style.setProperty("display","block"),ge.style.setProperty("margin-bottom","0.5rem"),ge.style.setProperty("font-weight","500"),a(ge,()=>e("inventory.sortBy","Sort By"),Pe),pe.addEventListener("change",Te=>f(Te.target.value)),pe.style.setProperty("width","100%"),pe.style.setProperty("padding","0.5rem"),pe.style.setProperty("border","1px solid var(--border-color)"),pe.style.setProperty("border-radius","var(--border-radius-sm)"),a(_e,()=>e("inventory.productName","Product Name")),a(Le,()=>e("inventory.sku","SKU")),a(De,()=>e("inventory.category","Category")),a(j,R(ze,{get when(){return!i()},get fallback(){return(()=>{var Te=rk(),$e=Te.firstChild;return Te.style.setProperty("padding","2rem"),a(Te,()=>e("common.loading","Loading"),$e),Te})()},get children(){return[(()=>{var Te=YT(),$e=Te.firstChild;return $e.firstChild,Te.style.setProperty("padding","1rem"),Te.style.setProperty("background","#fff3cd"),Te.style.setProperty("border-radius","var(--border-radius-sm)"),Te.style.setProperty("margin-bottom","2rem"),$e.style.setProperty("margin","0"),$e.style.setProperty("color","#856404"),a($e,()=>e("inventory.countWillInclude","This count will include {{count}} products from {{location}} in {{category}} category.",{count:W().length,location:z(),category:h()==="all"?e("inventory.allCategories","all categories"):h()}),null),Te})(),R(ze,{get when(){return Ee(()=>h()!=="all")()&&c()!=="all"},get children(){var Te=KT();return Te.style.setProperty("display","grid"),Te.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),Te.style.setProperty("gap","1rem"),Te.style.setProperty("margin-bottom","2rem"),Te.style.setProperty("padding","1rem"),Te.style.setProperty("background","var(--surface-color)"),Te.style.setProperty("border-radius","var(--border-radius)"),a(Te,R(ze,{get when(){return pr.hasPermission("physicalInventoryCountingForm")},get children(){return R(ht,{variant:"primary",size:"large",onClick:$,get disabled(){return i()||W().length===0},get children(){return["🚀 ",Ee(()=>e("inventory.startCounting","Start Physical Count"))]}})}}),null),a(Te,R(ht,{variant:"primary",onClick:F,get disabled(){return i()},get children(){return["🖨️ ",Ee(()=>e("common.print","Print"))]}}),null),Te}})]}}),null),Se(()=>re.value=c()),Se(()=>ie.value=h()),Se(()=>pe.value=g()),j}}),null),a(B,R(ze,{get when(){return w()==="counting"},get children(){var j=QT(),I=j.firstChild,M=I.nextSibling,J=M.firstChild,H=J.firstChild,Q=H.nextSibling,se=J.nextSibling,G=se.firstChild,re=G.nextSibling,oe=se.nextSibling,fe=oe.firstChild,ae=fe.nextSibling,Y=oe.nextSibling,ie=Y.firstChild,de=ie.firstChild,ue=ie.nextSibling,ge=M.nextSibling,Pe=ge.nextSibling,pe=Pe.firstChild,_e=pe.firstChild,Le=_e.firstChild,De=Le.firstChild,Te=De.nextSibling,$e=Te.nextSibling,Ie=$e.nextSibling,Re=Ie.nextSibling,Je=Re.nextSibling,Be=_e.nextSibling;return I.style.setProperty("display","grid"),I.style.setProperty("grid-template-columns","repeat(auto-fit)"),I.style.setProperty("gap","1rem"),I.style.setProperty("margin-bottom","2rem"),I.style.setProperty("padding","1rem"),I.style.setProperty("background","var(--surface-color)"),I.style.setProperty("border-radius","var(--border-radius)"),a(I,z),M.style.setProperty("display","grid"),M.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),M.style.setProperty("gap","1rem"),M.style.setProperty("margin-bottom","2rem"),M.style.setProperty("padding","1rem"),M.style.setProperty("background","var(--surface-color)"),M.style.setProperty("border-radius","var(--border-radius)"),J.style.setProperty("text-align","center"),H.style.setProperty("font-size","1.5rem"),H.style.setProperty("font-weight","700"),H.style.setProperty("color","var(--primary-color)"),a(H,()=>O().countedProducts),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),a(Q,()=>e("inventory.counted","Counted")),se.style.setProperty("text-align","center"),G.style.setProperty("font-size","1.5rem"),G.style.setProperty("font-weight","700"),G.style.setProperty("color","#ff9800"),a(G,()=>O().remainingProducts),re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),a(re,()=>e("inventory.remaining","Remaining")),oe.style.setProperty("text-align","center"),fe.style.setProperty("font-size","1.5rem"),fe.style.setProperty("font-weight","700"),fe.style.setProperty("color","#f44336"),a(fe,()=>O().variances),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),a(ae,()=>e("inventory.variances","Variances")),Y.style.setProperty("text-align","center"),ie.style.setProperty("font-size","1.5rem"),ie.style.setProperty("font-weight","700"),a(ie,()=>Math.round(O().countedProducts/O().totalProducts*100),de),ue.style.setProperty("font-size","0.875rem"),ue.style.setProperty("color","var(--text-muted)"),a(ue,()=>e("inventory.complete","Complete")),ge.style.setProperty("display","flex"),ge.style.setProperty("gap","1rem"),ge.style.setProperty("margin-bottom","2rem"),ge.style.setProperty("justify-content","center"),a(ge,R(ht,{variant:"outline",onClick:()=>E("setup"),get children(){return["⬅️ ",Ee(()=>e("common.back","Back to Setup"))]}}),null),a(ge,R(ht,{variant:"primary",onClick:()=>E("review"),get children(){return["📋 ",Ee(()=>e("inventory.reviewAdjustments","Review Adjustments"))]}}),null),Pe.style.setProperty("border","1px solid var(--border-color)"),Pe.style.setProperty("border-radius","var(--border-radius)"),Pe.style.setProperty("overflow-x","auto"),pe.style.setProperty("width","100%"),pe.style.setProperty("border-collapse","collapse"),Le.style.setProperty("background","var(--surface-color)"),De.style.setProperty("padding","1rem"),De.style.setProperty("text-align","left"),De.style.setProperty("border-bottom","1px solid var(--border-color)"),a(De,()=>e("inventory.no","No")),Te.style.setProperty("padding","1rem"),Te.style.setProperty("text-align","left"),Te.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Te,()=>e("inventory.product","Product")),$e.style.setProperty("padding","1rem"),$e.style.setProperty("text-align","center"),$e.style.setProperty("border-bottom","1px solid var(--border-color)"),a($e,()=>e("inventory.systemQty","System Qty")),Ie.style.setProperty("padding","1rem"),Ie.style.setProperty("text-align","center"),Ie.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Ie,()=>e("inventory.physicalCount","Physical Count")),Re.style.setProperty("padding","1rem"),Re.style.setProperty("text-align","center"),Re.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Re,()=>e("inventory.variance","Variance")),Je.style.setProperty("padding","1rem"),Je.style.setProperty("text-align","left"),Je.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Je,()=>e("common.notes","Notes")),a(Be,R(Ut,{get each(){return x()},children:(Ke,Xe)=>R(sk,{get index(){return Xe()},updatePhysicalCount:C,entry:Ke,updateNotes:T})})),Se(Ke=>(Ke=O().isComplete?"#4caf50":"#ff9800")!=null?ie.style.setProperty("color",Ke):ie.style.removeProperty("color")),j}}),null),a(B,R(ze,{get when(){return w()==="review"},get children(){var j=ek(),I=j.firstChild,M=I.firstChild;M.firstChild;var J=M.nextSibling,H=I.nextSibling,Q=H.firstChild,se=Q.firstChild,G=se.nextSibling,re=Q.nextSibling,oe=re.firstChild,fe=oe.nextSibling,ae=re.nextSibling,Y=ae.firstChild,ie=Y.nextSibling,de=H.nextSibling;return I.style.setProperty("text-align","center"),I.style.setProperty("margin-bottom","2rem"),M.style.setProperty("margin-bottom","1rem"),a(M,()=>e("inventory.reviewAndConfirm","Review and Confirm Adjustments"),null),J.style.setProperty("color","var(--text-muted)"),a(J,()=>e("inventory.reviewDescription","Review the inventory adjustments below and confirm to update your system.")),H.style.setProperty("display","grid"),H.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),H.style.setProperty("gap","1rem"),H.style.setProperty("margin-bottom","2rem"),H.style.setProperty("padding","1rem"),H.style.setProperty("background","var(--surface-color)"),H.style.setProperty("border-radius","var(--border-radius)"),Q.style.setProperty("text-align","center"),se.style.setProperty("font-size","1.5rem"),se.style.setProperty("font-weight","700"),se.style.setProperty("color","#4caf50"),a(se,()=>O().positiveVariances),G.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","var(--text-muted)"),a(G,()=>e("inventory.stockIncreases","Stock Increases")),re.style.setProperty("text-align","center"),oe.style.setProperty("font-size","1.5rem"),oe.style.setProperty("font-weight","700"),oe.style.setProperty("color","#f44336"),a(oe,()=>O().negativeVariances),fe.style.setProperty("font-size","0.875rem"),fe.style.setProperty("color","var(--text-muted)"),a(fe,()=>e("inventory.stockDecreases","Stock Decreases")),ae.style.setProperty("text-align","center"),Y.style.setProperty("font-size","1.5rem"),Y.style.setProperty("font-weight","700"),Y.style.setProperty("color","var(--primary-color)"),a(Y,()=>O().variances),ie.style.setProperty("font-size","0.875rem"),ie.style.setProperty("color","var(--text-muted)"),a(ie,()=>e("inventory.totalAdjustments","Total Adjustments")),de.style.setProperty("display","flex"),de.style.setProperty("gap","1rem"),de.style.setProperty("margin-bottom","2rem"),de.style.setProperty("justify-content","center"),de.style.setProperty("flex-wrap","wrap"),a(de,R(ht,{variant:"outline",onClick:()=>E("counting"),get children(){return["⬅️ ",Ee(()=>e("common.back","Back to Counting"))]}}),null),a(de,R(ht,{variant:"outline",onClick:P,get disabled(){return O().variances===0},get children(){return["📥 ",Ee(()=>e("inventory.downloadCSV","Download CSV"))]}}),null),a(de,R(ht,{variant:"primary",onClick:_,get disabled(){return s()||O().variances===0},get children(){return Ee(()=>!!s())()?"💾 "+e("common.saving","Saving")+"...":"✅ "+e("inventory.confirmAdjustments","Confirm Adjustments")}}),null),a(j,R(ze,{get when(){return O().variances>0},get children(){var ue=XT(),ge=ue.firstChild,Pe=ge.firstChild,pe=Pe.firstChild,_e=pe.firstChild,Le=_e.nextSibling,De=Le.nextSibling,Te=De.nextSibling,$e=Te.nextSibling,Ie=Pe.nextSibling;return ue.style.setProperty("border","1px solid var(--border-color)"),ue.style.setProperty("border-radius","var(--border-radius)"),ue.style.setProperty("overflow-x","auto"),ge.style.setProperty("width","100%"),ge.style.setProperty("border-collapse","collapse"),pe.style.setProperty("background","var(--surface-color)"),_e.style.setProperty("padding","1rem"),_e.style.setProperty("text-align","left"),_e.style.setProperty("border-bottom","1px solid var(--border-color)"),a(_e,()=>e("inventory.product","Product")),Le.style.setProperty("padding","1rem"),Le.style.setProperty("text-align","center"),Le.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Le,()=>e("inventory.systemQty","System Qty")),De.style.setProperty("padding","1rem"),De.style.setProperty("text-align","center"),De.style.setProperty("border-bottom","1px solid var(--border-color)"),a(De,()=>e("inventory.physicalCount","Physical Count")),Te.style.setProperty("padding","1rem"),Te.style.setProperty("text-align","center"),Te.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Te,()=>e("inventory.adjustment","Adjustment")),$e.style.setProperty("padding","1rem"),$e.style.setProperty("text-align","left"),$e.style.setProperty("border-bottom","1px solid var(--border-color)"),a($e,()=>e("common.notes","Notes")),a(Ie,R(Ut,{get each(){return x().filter(Re=>Re.variance!==0)},children:Re=>(()=>{var Je=nk(),Be=Je.firstChild,Ke=Be.firstChild,Xe=Ke.nextSibling,at=Xe.firstChild,ot=Be.nextSibling,Qe=ot.firstChild,dt=ot.nextSibling,ct=dt.firstChild,kt=dt.nextSibling,gt=kt.firstChild,qe=kt.nextSibling,Dt=qe.firstChild;return Je.style.setProperty("border-bottom","1px solid var(--border-color)"),Be.style.setProperty("padding","1rem"),Ke.style.setProperty("font-weight","500"),a(Ke,()=>Re.product.name),Xe.style.setProperty("font-size","0.875rem"),Xe.style.setProperty("color","var(--text-muted)"),a(Xe,()=>Re.product.sku,at),a(Xe,()=>Re.product.category,null),ot.style.setProperty("padding","1rem"),ot.style.setProperty("text-align","center"),Qe.style.setProperty("font-weight","600"),a(Qe,()=>Re.systemQuantity),dt.style.setProperty("padding","1rem"),dt.style.setProperty("text-align","center"),ct.style.setProperty("font-weight","600"),a(ct,()=>Re.physicalCount),kt.style.setProperty("padding","1rem"),kt.style.setProperty("text-align","center"),gt.style.setProperty("font-weight","700"),a(gt,()=>Re.variance>0?"+":"",null),a(gt,()=>Re.variance,null),qe.style.setProperty("padding","1rem"),Dt.style.setProperty("font-size","0.875rem"),a(Dt,()=>Re.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")),Se(Rt=>{var St=Re.variance>0?"#d4edda":"#f8d7da",Bt=Re.variance>0?"#4caf50":"#f44336";return St!==Rt.e&&((Rt.e=St)!=null?Je.style.setProperty("background",St):Je.style.removeProperty("background")),Bt!==Rt.t&&((Rt.t=Bt)!=null?gt.style.setProperty("color",Bt):gt.style.removeProperty("color")),Rt},{e:void 0,t:void 0}),Je})()})),ue}}),null),a(j,R(ze,{get when(){return O().variances===0},get children(){var ue=ZT(),ge=ue.firstChild,Pe=ge.nextSibling,pe=Pe.nextSibling;return ue.style.setProperty("text-align","center"),ue.style.setProperty("padding","3rem"),ue.style.setProperty("background","var(--surface-color)"),ue.style.setProperty("border-radius","var(--border-radius)"),ge.style.setProperty("font-size","3rem"),ge.style.setProperty("margin-bottom","1rem"),Pe.style.setProperty("margin-bottom","0.5rem"),a(Pe,()=>e("inventory.perfectCount","Perfect Count!")),pe.style.setProperty("color","var(--text-muted)"),a(pe,()=>e("inventory.noVariances","No variances found. Your physical count matches the system exactly.")),ue}}),null),j}}),null),U}})},sk=t=>{const{t:e}=or(),[r,n]=Ce(""),[i,o]=Ce("");let{entry:s,updatePhysicalCount:l,updateNotes:c,index:u}=t;wn(()=>{o(s?.notes),n(s?.physicalCount)});const h=()=>{let y=document.getElementById(`physicalCountInput_${u+2}`);if(console.log(gl(r()),!y),gl(r())&&!y){l(s?.productId,r()===""?null:parseFloat(r()));return}if(gl(r())&&y){y.focus(),l(s?.productId,r()===""?null:parseFloat(r()));return}};return(()=>{var y=ik(),g=y.firstChild,f=g.firstChild,x=g.nextSibling,S=x.firstChild,w=S.nextSibling,E=w.firstChild,q=E.nextSibling;q.nextSibling;var ee=x.nextSibling,W=ee.firstChild,K=ee.nextSibling,te=K.firstChild,$=K.nextSibling,C=$.firstChild,T=$.nextSibling,O=T.firstChild;return y.style.setProperty("border-bottom","1px solid var(--border-color)"),g.style.setProperty("padding","1rem"),g.style.setProperty("text-align","center"),f.style.setProperty("font-weight","600"),a(f,u+1),x.style.setProperty("padding","1rem"),S.style.setProperty("font-weight","500"),a(S,()=>s?.product.name),w.style.setProperty("font-size","0.875rem"),w.style.setProperty("color","var(--text-muted)"),a(w,()=>s?.product.sku,E),a(w,()=>s?.product.category,q),a(w,()=>s?.product.unitOfMeasure,null),ee.style.setProperty("padding","1rem"),ee.style.setProperty("text-align","center"),W.style.setProperty("font-weight","600"),a(W,()=>s?.systemQuantity),K.style.setProperty("padding","1rem"),K.style.setProperty("text-align","center"),te.addEventListener("blur",()=>{h()}),te.$$keydown=b=>{b.keyCode===13&&h(),b.keyCode===27&&h(),b.keyCode},te.$$input=b=>{const P=b.target.value;n(P)},tr(te,"id",`physicalCountInput_${u+1}`),tr(te,"tabindex",u),te.style.setProperty("width","100px"),te.style.setProperty("padding","0.5rem"),te.style.setProperty("border","1px solid var(--border-color)"),te.style.setProperty("border-radius","var(--border-radius-sm)"),te.style.setProperty("text-align","center"),$.style.setProperty("padding","1rem"),$.style.setProperty("text-align","center"),C.style.setProperty("font-weight","600"),a(C,()=>s?.variance>0?"+":"",null),a(C,()=>s?.variance||"—",null),T.style.setProperty("padding","1rem"),O.addEventListener("blur",b=>{c(s?.productId,i())}),O.$$keydown=b=>{b.keyCode===13&&c(s?.productId,i()),b.keyCode===27&&c(s?.productId,i()),b.keyCode===9&&c(s?.productId,i())},O.$$input=b=>{const P=b.target.value;o(P)},O.style.setProperty("width","200px"),O.style.setProperty("padding","0.5rem"),O.style.setProperty("border","1px solid var(--border-color)"),O.style.setProperty("border-radius","var(--border-radius-sm)"),Se(b=>{var P=s?.physicalCount!==null?s?.variance!==0?"#fff3cd":"#d4edda":"transparent",_=s?.variance>0?"#4caf50":s?.variance<0?"#f44336":"var(--text-muted)",z=e("inventory.addNotes","Add notes...");return P!==b.e&&((b.e=P)!=null?y.style.setProperty("background",P):y.style.removeProperty("background")),_!==b.t&&((b.t=_)!=null?C.style.setProperty("color",_):C.style.removeProperty("color")),z!==b.a&&tr(O,"placeholder",b.a=z),b},{e:void 0,t:void 0,a:void 0}),Se(()=>te.value=r()||""),Se(()=>O.value=i()||""),y})()};br(["click","input","keydown"]);function ak(t,e=300,r=!1){let n,i;const o=()=>{n!==void 0&&(clearTimeout(n),n=void 0),i=void 0},s=()=>{n!==void 0&&i!==void 0&&(clearTimeout(n),n=void 0,t(...i),i=void 0)},l=(...c)=>{i=c,n!==void 0&&clearTimeout(n),r&&n===void 0&&t(...c),n=window.setTimeout(()=>{r||t(...c),n=void 0,i=void 0},e)};return El(()=>{o()}),{debounced:l,cancel:o,flush:s}}function lk(t,e=300){const[r,n]=Ce(!1);let i;const o=async u=>{if(i&&i.abort(),!u.trim()){n(!1);return}i=new AbortController,n(!0);try{await t(u)}catch(h){h instanceof Error&&h.name!=="AbortError"&&console.error("Search error:",h)}finally{i.signal.aborted||n(!1)}},{debounced:s,cancel:l}=ak(o,e,!1),c=()=>{l(),i&&i.abort(),n(!1)};return El(()=>{c()}),{search:s,isSearching:r,cancel:c}}var w0=he("<div>"),ck=he("<div><h3></h3><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),uk=he("<div><h3></h3><div><div><div><span></span><span></span></div><div><span></span><span></span></div></div><div><div><span></span><span></span></div><div><span></span><span>%"),dk=he("<div><h4>"),hk=he("<div><h3></h3><div><div><div><span></span><span> </span></div><div><span></span><span> </span></div></div><div><div><span></span><span> </span></div><div><span></span><span>"),pk=he("<div><h3></h3><div><span></span><span></span></div><div><span></span><span>"),x0=he("<div><h3>"),fk=he("<div><div><div><h2></h2><div>SKU: <!> • </div></div><div></div></div><div><button></button><button></button><button></button></div><div>"),mk=he("<span>✓ "),yk=he("<span>✗ "),gk=he("<div><div><span><span> • </span></span><span> </span></div><div>: <!> • <!>: "),vk=he("<div>📦 "),bk=he("<div>Ref: "),_k=he("<div><div><div><span></span><span></span><span></span></div><div><span></span></div></div><div><div> </div><div>"),Sk=he("<div><h4></h4><div></div><div>"),Pk=he("<div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div> <!> × </div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div>Min: <!> • Max: ");const wk=t=>{const{t:e}=or(),[r,n]=Ce("details"),i=Mt(()=>{if(!t.product)return null;const T=ut.getTotalStockByProduct(t.product.id),O=ut.getStockByProduct(t.product.id),b=T<=t.product.minStockLevel,P=T===0,_=T>=t.product.maxStockLevel;return{total:T,byLocation:O,status:P?"out":b?"low":_?"over":"good",statusText:P?e("products.outOfStock","Out of Stock"):b?e("products.lowStock","Low Stock"):_?e("products.overStock","Over Stock"):e("products.inStock","In Stock")}}),o=T=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(T),s=T=>new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),l=Mt(()=>!t.product||t.product.unitCost===0?0:((t.product.sellingPrice-t.product.unitCost)/t.product.unitCost*100).toFixed(2)),c=Mt(()=>t.product?ut.movements.filter(T=>T.productId===t.product.id).sort((T,O)=>new Date(O.createdDate).getTime()-new Date(T.createdDate).getTime()):[]),u=Mt(()=>{if(!t.product)return null;const T=c(),O=i(),b=new Date;b.setDate(b.getDate()-30);const P=T.filter(z=>new Date(z.createdDate)>=b),_=T.reduce((z,Z)=>{const k=Z.productId===t.product.id?Z:null;return z+(k?k.quantity*k.unitCost:0)},0);return{recentMovements:T.length,movements30Days:P.length,totalValue:(O?.total||0)*t.product.unitCost,averageMovementValue:T.length>0?_/T.length:0,lastMovementDate:T.length>0?T[0].createdDate:null}}),h={"margin-bottom":"2rem"},y={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},g={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},f={"font-weight":"400",color:"var(--text-primary)","font-size":"1rem"},x=T=>({in:"📦",out:"📤",transfer:"🔄",adjustment:"⚖️"})[T]||"📋";function S(T){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[T]||{bg:"#f5f5f5",color:"#666"}}const w=T=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:S(T).bg,color:S(T).color}),E=T=>{const O={good:{background:"#d4edda",color:"#155724"},low:{background:"#fff3cd",color:"#856404"},out:{background:"#f8d7da",color:"#721c24"},over:{background:"#cce5ff",color:"#004085"}};return{display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500",...O[T]||O.good}},q={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"},ee={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1rem","margin-bottom":"0.75rem"},W={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1.5rem","padding-bottom":"1rem","border-bottom":"2px solid var(--border-color)"},K={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},te=T=>({padding:"0.75rem 1.5rem",background:"none",border:"none","border-bottom":T?"2px solid var(--primary-color)":"2px solid transparent",color:T?"var(--primary-color)":"var(--text-muted)","font-weight":T?"600":"400",cursor:"pointer",transition:"all 0.2s","font-size":"0.875rem"}),$={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-bottom":"0.5rem"},C={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1.5rem","margin-bottom":"1rem"};return R(On,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("products.productDetails","Product Details")},size:"large",get children(){return R(ze,{get when(){return t.product},get fallback(){return(()=>{var T=w0();return T.style.setProperty("text-align","center"),T.style.setProperty("padding","2rem"),T.style.setProperty("color","var(--text-muted)"),a(T,()=>e("products.noProductSelected","No product selected")),T})()},children:T=>(()=>{var O=fk(),b=O.firstChild,P=b.firstChild,_=P.firstChild,z=_.nextSibling,Z=z.firstChild,k=Z.nextSibling;k.nextSibling;var F=P.nextSibling,X=b.nextSibling,U=X.firstChild,B=U.nextSibling,ce=B.nextSibling,L=X.nextSibling;return a(O,()=>JSON.stringify(T),b),m(b,W),_.style.setProperty("margin","0"),_.style.setProperty("font-size","1.5rem"),_.style.setProperty("margin-bottom","0.25rem"),a(_,()=>T().name),z.style.setProperty("color","var(--text-muted)"),a(z,()=>T().sku,k),a(z,()=>T().category,null),a(F,()=>i()?.statusText),m(X,K),U.$$click=()=>n("details"),a(U,()=>e("products.details","Details")),B.$$click=()=>n("movements"),a(B,()=>e("products.movements","Movements")),ce.$$click=()=>n("analytics"),a(ce,()=>e("products.analytics","Analytics")),a(O,R(ze,{get when(){return r()==="details"},get children(){return[(()=>{var D=ck(),j=D.firstChild,I=j.nextSibling,M=I.firstChild,J=M.nextSibling,H=I.nextSibling,Q=H.firstChild,se=Q.nextSibling,G=H.nextSibling,re=G.firstChild,oe=re.nextSibling;return j.style.setProperty("margin-bottom","1rem"),j.style.setProperty("font-size","1.1rem"),a(j,()=>e("products.basicInformation","Basic Information")),a(M,()=>e("products.description","Description")),a(J,()=>T().description||e("common.notAvailable","N/A")),a(Q,()=>e("products.unitOfMeasure","Unit of Measure")),a(se,()=>T().unitOfMeasure),a(re,()=>e("products.status","Status")),a(oe,(()=>{var fe=Ee(()=>!!T().isActive);return()=>fe()?(()=>{var ae=mk();return ae.firstChild,ae.style.setProperty("color","#2e7d32"),a(ae,()=>e("common.active","Active"),null),ae})():(()=>{var ae=yk();return ae.firstChild,ae.style.setProperty("color","#d32f2f"),a(ae,()=>e("common.inactive","Inactive"),null),ae})()})()),Se(fe=>{var ae=h,Y=y,ie=g,de=f,ue=y,ge=g,Pe=f,pe=y,_e=g,Le=f;return fe.e=m(D,ae,fe.e),fe.t=m(I,Y,fe.t),fe.a=m(M,ie,fe.a),fe.o=m(J,de,fe.o),fe.i=m(H,ue,fe.i),fe.n=m(Q,ge,fe.n),fe.s=m(se,Pe,fe.s),fe.h=m(G,pe,fe.h),fe.r=m(re,_e,fe.r),fe.d=m(oe,Le,fe.d),fe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),D})(),(()=>{var D=uk(),j=D.firstChild,I=j.nextSibling,M=I.firstChild,J=M.firstChild,H=J.firstChild,Q=H.nextSibling,se=J.nextSibling,G=se.firstChild,re=G.nextSibling,oe=M.nextSibling,fe=oe.firstChild,ae=fe.firstChild,Y=ae.nextSibling,ie=fe.nextSibling,de=ie.firstChild,ue=de.nextSibling,ge=ue.firstChild;return j.style.setProperty("margin-bottom","1rem"),j.style.setProperty("font-size","1.1rem"),a(j,()=>e("products.pricingInformation","Pricing Information")),a(H,()=>e("products.unitCost","Unit Cost")),a(Q,()=>o(T().unitCost)),a(G,()=>e("products.sellingPrice","Selling Price")),a(re,()=>o(T().sellingPrice)),a(ae,()=>e("products.profit","Profit")),a(Y,()=>o(T().sellingPrice-T().unitCost)),a(de,()=>e("products.profitMargin","Profit Margin")),a(ue,l,ge),Se(Pe=>{var pe=h,_e=q,Le=y,De=g,Te=f,$e=y,Ie=g,Re=f,Je=y,Be=g,Ke=f,Xe=y,at=g,ot=f;return Pe.e=m(D,pe,Pe.e),Pe.t=m(I,_e,Pe.t),Pe.a=m(J,Le,Pe.a),Pe.o=m(H,De,Pe.o),Pe.i=m(Q,Te,Pe.i),Pe.n=m(se,$e,Pe.n),Pe.s=m(G,Ie,Pe.s),Pe.h=m(re,Re,Pe.h),Pe.r=m(fe,Je,Pe.r),Pe.d=m(ae,Be,Pe.d),Pe.l=m(Y,Ke,Pe.l),Pe.u=m(ie,Xe,Pe.u),Pe.c=m(de,at,Pe.c),Pe.w=m(ue,ot,Pe.w),Pe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),D})(),(()=>{var D=hk(),j=D.firstChild,I=j.nextSibling,M=I.firstChild,J=M.firstChild,H=J.firstChild,Q=H.nextSibling,se=Q.firstChild,G=J.nextSibling,re=G.firstChild,oe=re.nextSibling,fe=oe.firstChild,ae=M.nextSibling,Y=ae.firstChild,ie=Y.firstChild,de=ie.nextSibling,ue=de.firstChild,ge=Y.nextSibling,Pe=ge.firstChild,pe=Pe.nextSibling;return j.style.setProperty("margin-bottom","1rem"),j.style.setProperty("font-size","1.1rem"),a(j,()=>e("products.stockInformation","Stock Information")),a(H,()=>e("products.totalStock","Total Stock")),a(Q,()=>i()?.total||0,se),a(Q,()=>T().unitOfMeasure,null),a(re,()=>e("products.minStockLevel","Min Stock Level")),a(oe,()=>T().minStockLevel,fe),a(oe,()=>T().unitOfMeasure,null),a(ie,()=>e("products.maxStockLevel","Max Stock Level")),a(de,()=>T().maxStockLevel,ue),a(de,()=>T().unitOfMeasure,null),a(Pe,()=>e("products.stockValue","Stock Value")),a(pe,()=>o((i()?.total||0)*T().unitCost)),a(D,R(ze,{get when(){return Ee(()=>!!i()?.byLocation)()&&i().byLocation.length>0},get children(){var _e=dk(),Le=_e.firstChild;return _e.style.setProperty("margin-top","1.5rem"),Le.style.setProperty("margin-bottom","1rem"),Le.style.setProperty("font-size","1rem"),a(Le,()=>e("products.stockByLocation","Stock by Location")),a(_e,()=>i().byLocation.map(De=>(()=>{var Te=gk(),$e=Te.firstChild,Ie=$e.firstChild,Re=Ie.firstChild;Re.firstChild;var Je=Ie.nextSibling,Be=Je.firstChild,Ke=$e.nextSibling,Xe=Ke.firstChild,at=Xe.nextSibling,ot=at.nextSibling,Qe=ot.nextSibling;return Qe.nextSibling,m(Te,ee),$e.style.setProperty("display","flex"),$e.style.setProperty("justify-content","space-between"),$e.style.setProperty("align-items","center"),Ie.style.setProperty("font-weight","500"),Ie.style.setProperty("color","var(--primary-color)"),a(Ie,()=>De.locationId,Re),Re.style.setProperty("font-weight","500"),Re.style.setProperty("color","var(--text-muted)"),a(Re,()=>De.locationName,null),Je.style.setProperty("font-weight","600"),a(Je,()=>De.quantity,Be),a(Je,()=>T().unitOfMeasure,null),Ke.style.setProperty("margin-top","0.5rem"),Ke.style.setProperty("font-size","0.875rem"),Ke.style.setProperty("color","var(--text-muted)"),a(Ke,()=>e("products.available","Available"),Xe),a(Ke,()=>De.availableQuantity,at),a(Ke,()=>e("products.reserved","Reserved"),Qe),a(Ke,()=>De.reservedQuantity,null),Se(dt=>(dt=De.quantity>0?"var(--primary-color)":"var(--text-muted)")!=null?Je.style.setProperty("color",dt):Je.style.removeProperty("color")),Te})()),null),_e}}),null),Se(_e=>{var Le=h,De=q,Te=y,$e=g,Ie=f,Re=y,Je=g,Be=f,Ke=y,Xe=g,at=f,ot=y,Qe=g,dt=f;return _e.e=m(D,Le,_e.e),_e.t=m(I,De,_e.t),_e.a=m(J,Te,_e.a),_e.o=m(H,$e,_e.o),_e.i=m(Q,Ie,_e.i),_e.n=m(G,Re,_e.n),_e.s=m(re,Je,_e.s),_e.h=m(oe,Be,_e.h),_e.r=m(Y,Ke,_e.r),_e.d=m(ie,Xe,_e.d),_e.l=m(de,at,_e.l),_e.u=m(ge,ot,_e.u),_e.c=m(Pe,Qe,_e.c),_e.w=m(pe,dt,_e.w),_e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),D})(),(()=>{var D=pk(),j=D.firstChild,I=j.nextSibling,M=I.firstChild,J=M.nextSibling,H=I.nextSibling,Q=H.firstChild,se=Q.nextSibling;return j.style.setProperty("margin-bottom","1rem"),j.style.setProperty("font-size","1.1rem"),a(j,()=>e("products.timestamps","Timestamps")),a(M,()=>e("common.createdDate","Created Date")),a(J,()=>s(T().createdDate)),a(Q,()=>e("common.lastModified","Last Modified")),a(se,()=>s(T().lastModified)),Se(G=>{var re=h,oe=y,fe=g,ae=f,Y=y,ie=g,de=f;return G.e=m(D,re,G.e),G.t=m(I,oe,G.t),G.a=m(M,fe,G.a),G.o=m(J,ae,G.o),G.i=m(H,Y,G.i),G.n=m(Q,ie,G.n),G.s=m(se,de,G.s),G},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),D})()]}}),L),a(O,R(ze,{get when(){return r()==="movements"},get children(){var D=x0(),j=D.firstChild;return j.style.setProperty("margin-bottom","1rem"),j.style.setProperty("font-size","1.1rem"),a(j,()=>e("products.recentMovements","Recent Movements")),a(D,R(ze,{get when(){return c().length>0},get fallback(){return(()=>{var I=vk();return I.firstChild,I.style.setProperty("text-align","center"),I.style.setProperty("padding","2rem"),I.style.setProperty("color","var(--text-muted)"),I.style.setProperty("background","var(--surface-color)"),I.style.setProperty("border-radius","var(--border-radius-sm)"),I.style.setProperty("border","1px solid var(--border-color)"),a(I,()=>e("products.noMovements","No movements found for this product"),null),I})()},get children(){return R(Ut,{get each(){return c()},children:I=>{const M=I.productId===T().id?I:null;if(!M)return null;let J=ut.getLocationById(I.locationId);return(()=>{var H=_k(),Q=H.firstChild,se=Q.firstChild,G=se.firstChild,re=G.nextSibling,oe=re.nextSibling,fe=se.nextSibling,ae=fe.firstChild,Y=Q.nextSibling,ie=Y.firstChild,de=ie.firstChild,ue=ie.nextSibling;return m(H,$),se.style.setProperty("font-weight","600"),se.style.setProperty("margin-bottom","0.25rem"),G.style.setProperty("font-size","1.2rem"),a(G,()=>x(I.movementType)),re.style.setProperty("padding","0 6px"),a(oe,()=>I.movementType),fe.style.setProperty("font-size","0.875rem"),fe.style.setProperty("color","var(--text-muted)"),a(fe,()=>` ${s(I?.createdDate)} • `,ae),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("font-weight","600"),ae.style.setProperty("color","var(--primary-color)"),a(ae,()=>I?.locationId),a(fe,()=>` • ${J?.name}`,null),a(Q,R(ze,{get when(){return I.referenceNumber},get children(){var ge=bk();return ge.firstChild,ge.style.setProperty("font-size","0.75rem"),ge.style.setProperty("color","var(--text-muted)"),ge.style.setProperty("margin-top","0.25rem"),a(ge,()=>I?.referenceNumber,null),ge}}),null),Y.style.setProperty("text-align","right"),ie.style.setProperty("font-weight","600"),ie.style.setProperty("font-size","1rem"),a(ie,()=>I?.movementType==="in"?"+":"",de),a(ie,()=>M.quantity,de),a(ie,()=>T().unitOfMeasure,null),ue.style.setProperty("font-size","0.875rem"),ue.style.setProperty("color","var(--text-muted)"),a(ue,()=>o(M.unitCost)),Se(ge=>{var Pe=w(I.movementType),pe=I?.movementType==="in"?"#2e7d32":"#d32f2f";return ge.e=m(oe,Pe,ge.e),pe!==ge.t&&((ge.t=pe)!=null?ie.style.setProperty("color",pe):ie.style.removeProperty("color")),ge},{e:void 0,t:void 0}),H})()}})}}),null),Se(I=>m(D,h,I)),D}}),L),a(O,R(ze,{get when(){return r()==="analytics"},get children(){var D=x0(),j=D.firstChild;return j.style.setProperty("margin-bottom","1rem"),j.style.setProperty("font-size","1.1rem"),a(j,()=>e("products.analytics","Analytics")),a(D,R(ze,{get when(){return u()},get fallback(){return(()=>{var I=w0();return I.style.setProperty("text-align","center"),I.style.setProperty("padding","2rem"),I.style.setProperty("color","var(--text-muted)"),a(I,()=>e("products.noAnalytics","No analytics data available")),I})()},children:I=>(()=>{var M=Pk(),J=M.firstChild,H=J.firstChild,Q=H.nextSibling,se=Q.nextSibling,G=J.nextSibling,re=G.firstChild,oe=re.nextSibling,fe=oe.nextSibling,ae=G.nextSibling,Y=ae.firstChild,ie=Y.nextSibling,de=ie.nextSibling,ue=de.firstChild,ge=ue.nextSibling;ge.nextSibling;var Pe=ae.nextSibling,pe=Pe.firstChild,_e=pe.nextSibling,Le=_e.nextSibling,De=Pe.nextSibling,Te=De.firstChild,$e=Te.nextSibling,Ie=$e.nextSibling,Re=Ie.firstChild,Je=Re.nextSibling;return Je.nextSibling,H.style.setProperty("margin","0 0 0.5rem 0"),H.style.setProperty("color","var(--primary-color)"),a(H,()=>e("products.totalMovements","Total Movements")),Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","600"),a(Q,()=>I().recentMovements),se.style.setProperty("font-size","0.875rem"),se.style.setProperty("color","var(--text-muted)"),se.style.setProperty("margin-top","0.25rem"),a(se,()=>e("products.allTime","All time")),re.style.setProperty("margin","0 0 0.5rem 0"),re.style.setProperty("color","var(--primary-color)"),a(re,()=>e("products.last30Days","Last 30 Days")),oe.style.setProperty("font-size","1.5rem"),oe.style.setProperty("font-weight","600"),a(oe,()=>I().movements30Days),fe.style.setProperty("font-size","0.875rem"),fe.style.setProperty("color","var(--text-muted)"),fe.style.setProperty("margin-top","0.25rem"),a(fe,()=>e("products.movements","movements")),Y.style.setProperty("margin","0 0 0.5rem 0"),Y.style.setProperty("color","var(--primary-color)"),a(Y,()=>e("products.currentValue","Current Stock Value")),ie.style.setProperty("font-size","1.5rem"),ie.style.setProperty("font-weight","600"),a(ie,()=>o(I().totalValue)),de.style.setProperty("font-size","0.875rem"),de.style.setProperty("color","var(--text-muted)"),de.style.setProperty("margin-top","0.25rem"),a(de,()=>i()?.total||0,ue),a(de,()=>T().unitOfMeasure,ge),a(de,()=>o(T().unitCost),null),pe.style.setProperty("margin","0 0 0.5rem 0"),pe.style.setProperty("color","var(--primary-color)"),a(pe,()=>e("products.avgMovementValue","Avg Movement Value")),_e.style.setProperty("font-size","1.5rem"),_e.style.setProperty("font-weight","600"),a(_e,()=>o(I().averageMovementValue)),Le.style.setProperty("font-size","0.875rem"),Le.style.setProperty("color","var(--text-muted)"),Le.style.setProperty("margin-top","0.25rem"),a(Le,()=>e("products.perMovement","per movement")),a(M,R(ze,{get when(){return I().lastMovementDate},get children(){var Be=Sk(),Ke=Be.firstChild,Xe=Ke.nextSibling,at=Xe.nextSibling;return Ke.style.setProperty("margin","0 0 0.5rem 0"),Ke.style.setProperty("color","var(--primary-color)"),a(Ke,()=>e("products.lastMovement","Last Movement")),Xe.style.setProperty("font-size","1.25rem"),Xe.style.setProperty("font-weight","600"),a(Xe,()=>s(I().lastMovementDate)),at.style.setProperty("font-size","0.875rem"),at.style.setProperty("color","var(--text-muted)"),at.style.setProperty("margin-top","0.25rem"),a(at,()=>e("products.mostRecent","Most recent activity")),Se(ot=>m(Be,C,ot)),Be}}),De),Te.style.setProperty("margin","0 0 0.5rem 0"),Te.style.setProperty("color","var(--primary-color)"),a(Te,()=>e("products.stockStatus","Stock Status")),$e.style.setProperty("font-size","1.25rem"),$e.style.setProperty("font-weight","600"),a($e,()=>i()?.statusText),Ie.style.setProperty("font-size","0.875rem"),Ie.style.setProperty("color","var(--text-muted)"),Ie.style.setProperty("margin-top","0.25rem"),a(Ie,()=>T().minStockLevel,Je),a(Ie,()=>T().maxStockLevel,null),Se(Be=>{var Ke=q,Xe=C,at=C,ot=C,Qe=C,dt=C;return Be.e=m(M,Ke,Be.e),Be.t=m(J,Xe,Be.t),Be.a=m(G,at,Be.a),Be.o=m(ae,ot,Be.o),Be.i=m(Pe,Qe,Be.i),Be.n=m(De,dt,Be.n),Be},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),M})()}),null),Se(I=>m(D,h,I)),D}}),L),L.style.setProperty("display","flex"),L.style.setProperty("gap","1rem"),L.style.setProperty("justify-content","flex-end"),L.style.setProperty("margin-top","2rem"),a(L,R(ht,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close","Close")}}),null),a(L,R(ze,{get when(){return t.onEdit},get children(){return R(ht,{variant:"primary",get onClick(){return t.onEdit},get children(){return e("common.edit","Edit")}})}}),null),Se(D=>{var j=E(i()?.status||"good"),I=te(r()==="details"),M=te(r()==="movements"),J=te(r()==="analytics");return D.e=m(F,j,D.e),D.t=m(U,I,D.t),D.a=m(B,M,D.a),D.o=m(ce,J,D.o),D},{e:void 0,t:void 0,a:void 0,o:void 0}),O})()})}})};br(["click"]);var xk=he("<div>🔄"),Ak=he("<button type=button>×"),Ck=he("<div>⚠️ "),A0=he("<div>"),Ik=he("<div><div><input type=text autocomplete=off>"),$k=he("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>"),Ek=he("<span>⚠️ ");const Tk=t=>{const{t:e}=or(),[r,n]=Ce(""),[i,o]=Ce(!1),[s,l]=Ce(null),[c,u]=Ce([]),[h,y]=Ce(!1),[g,f]=Ce(-1),[x,S]=Ce(null),w=t.searchDelay||300,E=t.maxResults||900,q=async I=>{if(!I.trim()||I.trim().length<3){u([]),t.onSearchResults?.([]);return}try{o(!0),l(null);try{const M=await vi.getProducts(I),J=Object.keys(M),H=se=>{let G=M;return{id:se,name:G[se].name,businessId:G[se].businessId,sku:G[se].code,UPC:G[se].UPC,numCode:G[se].codeN,category:G[se].category,unitCost:G[se].unitCost||0,unitOfMeasure:G[se].unitOfMeasure,minStockLevel:G[se].minStockLevel,maxStockLevel:G[se].maxStockLevel,isActive:G[se].isActive,description:G[se].description||"",createdDate:G[se].createdAt||new Date().toISOString(),lastModified:G[se].updatedAt||new Date().toISOString()}},Q=J.map(H);u(Q),ut.updProduct(Q),t.onSearchResults?.(Q)}catch(M){console.warn("API search failed, using local fallback:",M),l("API search failed, showing local results");const J=ut.getActiveProducts().filter(H=>H.name.toLowerCase().includes(I.toLowerCase())||H.sku.toLowerCase().includes(I.toLowerCase())||H.category.toLowerCase().includes(I.toLowerCase())).slice(0,E);u(J),t.onSearchResults?.(J)}}catch(M){const J=M instanceof Error?M.message:"Search failed";l(J),u([]),t.onSearchResults?.([])}finally{o(!1)}},ee=I=>{const J=I.target.value;n(J),l(null),t.showResults!==!1&&y(!0),x()&&clearTimeout(x());const H=setTimeout(()=>{q(J)},w);S(H)},W=I=>{n(I.name),y(!1),f(-1),t.onProductSelect?.(I)},K=I=>{if(!(!h()||c().length===0))switch(I.key){case"ArrowDown":I.preventDefault(),f(M=>Math.min(M+1,c().length-1));break;case"ArrowUp":I.preventDefault(),f(M=>Math.max(M-1,-1));break;case"Enter":I.preventDefault(),g()>=0&&c()[g()]&&W(c()[g()]);break;case"Escape":y(!1),f(-1);break}},te=()=>{t.showResults!==!1&&c().length>0&&y(!0)},$=()=>{setTimeout(()=>{y(!1),f(-1)},150)},C=()=>{n(""),u([]),l(null),y(!1),f(-1),t.onSearchResults?.([]),x()&&(clearTimeout(x()),S(null))},T=I=>ut.stockLevels.filter(M=>M.productId===I).reduce((M,J)=>M+J.quantity,0),O=I=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(I),b={position:"relative",width:"100%",...t.style},P={position:"relative",display:"flex","align-items":"center"},_={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},z={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},Z={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},k={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},F=I=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:I?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),X={display:"flex","justify-content":"space-between","align-items":"center"},U={flex:"1"},B={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},ce={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},L={"text-align":"right","font-size":"0.875rem"},D={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},j={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var I=Ik(),M=I.firstChild,J=M.firstChild;return J.addEventListener("blur",$),J.addEventListener("focus",te),J.$$keydown=K,J.$$input=ee,a(M,R(ze,{get when(){return i()},get children(){var H=xk();return Se(Q=>m(H,Z,Q)),H}}),null),a(M,R(ze,{get when(){return Ee(()=>!!r())()&&!i()},get children(){var H=Ak();return H.addEventListener("mouseleave",Q=>{Q.currentTarget.style.background="none",Q.currentTarget.style.color="var(--text-muted)"}),H.addEventListener("mouseenter",Q=>{Q.currentTarget.style.background="var(--border-color)",Q.currentTarget.style.color="var(--text-primary)"}),H.$$click=C,Se(Q=>{var se=z,G=e("common.clear","Clear search");return Q.e=m(H,se,Q.e),G!==Q.t&&tr(H,"title",Q.t=G),Q},{e:void 0,t:void 0}),H}}),null),a(I,R(ze,{get when(){return h()&&t.showResults!==!1},get children(){var H=A0();return a(H,R(ze,{get when(){return s()},get children(){var Q=Ck();return Q.firstChild,m(Q,j),a(Q,s,null),Q}}),null),a(H,R(ze,{get when(){return c().length>0},get fallback(){return Ee(()=>!!(r()&&!i()))()&&(()=>{var Q=A0();return m(Q,D),a(Q,()=>e("inventory.noProductsFound","No products found matching your search.")),Q})()},get children(){return R(Ut,{get each(){return c()},children:(Q,se)=>{const G=T(Q.id),re=G<=Q.minStockLevel;return(()=>{var oe=$k(),fe=oe.firstChild,ae=fe.firstChild,Y=ae.firstChild,ie=Y.nextSibling,de=ie.firstChild,ue=de.firstChild,ge=de.nextSibling,Pe=ge.nextSibling,pe=Pe.nextSibling,_e=pe.nextSibling,Le=ae.nextSibling,De=Le.firstChild,Te=De.firstChild,$e=De.nextSibling;return oe.addEventListener("mouseenter",()=>f(se())),oe.$$click=()=>W(Q),m(fe,X),m(ae,U),m(Y,B),a(Y,()=>Q.name),m(ie,ce),a(de,()=>e("inventory.sku","SKU"),ue),a(de,()=>Q.sku,null),a(Pe,()=>Q.category),a(_e,()=>O(Q.unitCost)),m(Le,L),De.style.setProperty("font-weight","600"),(re?"#f44336":"var(--text-primary)")!=null?De.style.setProperty("color",re?"#f44336":"var(--text-primary)"):De.style.removeProperty("color"),a(De,G,Te),a(De,()=>Q.unitOfMeasure,null),$e.style.setProperty("color","var(--text-muted)"),a($e,()=>re?(()=>{var Ie=Ek();return Ie.firstChild,Ie.style.setProperty("color","#f44336"),a(Ie,()=>e("inventory.lowStock","Low Stock"),null),Ie})():e("inventory.inStock","In Stock")),Se(Ie=>m(oe,F(se()===g()),Ie)),oe})()}})}}),null),Se(Q=>m(H,k,Q)),H}}),null),Se(H=>{var Q=b,se=P,G=_,re=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),oe=t.disabled;return H.e=m(I,Q,H.e),H.t=m(M,se,H.t),H.a=m(J,G,H.a),re!==H.o&&tr(J,"placeholder",H.o=re),oe!==H.i&&(J.disabled=H.i=oe),H},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>J.value=r()),I})()};br(["input","keydown","click"]);var kk=he("<div><div><h2></h2><div><div>"),Nk=he("<div><span>"),Lk=he("<span>🔍 "),Rk=he("<div><div><div><div><h3></h3><span></span></div><div></div><div>: </div></div><div><div></div><div> • <!>: </div><div>: "),Dk=he("<div><div>:</div><div>"),Mk=he("<div>: "),Fk=he("<div><div><span>:</span><select><option value=10>10</option><option value=20>20</option><option value=50>50</option><option value=100>100</option></select></div><div><div><span></span><input type=number min=1><span> </span></div></div><div>");const L5=()=>{const{t}=or(),[e,r]=Ce(""),[n,i]=Ce(""),[o,s]=Ce([]),[l,c]=Ce(!1),[u,h]=Ce(null),[y,g]=Ce(!1),[f,x]=Ce(!1),[S,w]=Ce(!1),[E,q]=Ce(null),[ee,W]=Ce(!1),[K,te]=Ce([]),[$,C]=Ce(!1),[T,O]=Ce(1),[b,P]=Ce(20);wn(async()=>{await _()});const _=async()=>{try{c(!0),h(null);try{const I=await s0.getAll();s(I.map(M=>({id:M.id||`prod-${Date.now()}-${Math.random()}`,name:M.productName||M.name||"Unknown Product",sku:M.sku||M.productCode||"",description:M.description||"",category:M.category||"General",unitOfMeasure:M.unitOfMeasure||"pcs",unitCost:parseFloat(M.unitCost||M.cost||"0"),sellingPrice:parseFloat(M.sellingPrice||M.price||"0"),minStockLevel:parseInt(M.minStockLevel||"0"),maxStockLevel:parseInt(M.maxStockLevel||"100"),isActive:M.isActive!==!1,createdDate:M.createdDate||new Date().toISOString(),lastModified:M.lastModified||new Date().toISOString(),businessId:M.businessId||"YB100423253156428"})))}catch(I){console.warn("API failed, using local store:",I),s(ut.products)}}catch(I){h(I instanceof Error?I.message:"Failed to load products")}finally{c(!1)}},z=async()=>{try{c(!0),h(null);try{const I=await vi.getProducts("prod"),M=Object.keys(I),J=Q=>{let G=I[Q];return{id:G.id,name:G.name,businessId:G.businessId,sku:G.code,numCode:G.codeN,category:G.category,unitCost:G.unitCost||0,unitOfMeasure:G.unitOfMeasure,minStockLevel:G.minStockLevel,maxStockLevel:G.maxStockLevel,isActive:G.isActive,description:G.description||"",createdDate:G.createdAt||new Date().toISOString(),lastModified:G.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(G.sellingPrice||G.price||"0")}},H=M.map(J);s(H)}catch(I){console.warn("API failed, using local store:",I),s(ut.products)}}catch(I){h(I instanceof Error?I.message:"Failed to load products")}finally{c(!1)}},{cancel:Z}=lk(async I=>{if(!I.trim()){await _();return}try{h(null);const M=await s0.getAll(I);s(M.map(J=>({id:J.id||`prod-${Date.now()}-${Math.random()}`,name:J.productName||J.name||"Unknown Product",sku:J.sku||J.productCode||"",description:J.description||"",category:J.category||"General",unitOfMeasure:J.unitOfMeasure||"pcs",unitCost:parseFloat(J.unitCost||J.cost||"0"),sellingPrice:parseFloat(J.sellingPrice||J.price||"0"),minStockLevel:parseInt(J.minStockLevel||"0"),maxStockLevel:parseInt(J.maxStockLevel||"100"),isActive:J.isActive!==!1,createdDate:J.createdDate||new Date().toISOString(),lastModified:J.lastModified||new Date().toISOString(),businessId:J.businessId||"YB100423253156428"})))}catch(M){h(M instanceof Error?M.message:"Search failed");const J=ut.products.filter(H=>H.name.toLowerCase().includes(I.toLowerCase())||H.sku.toLowerCase().includes(I.toLowerCase())||H.category.toLowerCase().includes(I.toLowerCase()));s(J)}},300);El(()=>{Z()}),Mt(()=>{let I=o();return n()&&(I=I.filter(M=>M.category===n())),I}),Mt(()=>[...new Set(o().map(M=>M.category))].sort()),Mt(()=>{const I=o().filter(H=>H.isActive),M=o().length,J=o().filter(H=>ut.getTotalStockByProduct(H.id)===0);return{total:M,active:I.length,outOfStock:J.length}});const k=I=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(I),F={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},X={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},U=I=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:I?"#ffebee":"#e8f5e8",color:I?"#d32f2f":"#2d7d32"});Mt(()=>{const I=ut.products||[],M=ut.movements||[],J=ut.stockLevels||[],H=ut.getLowStockProducts(),Q=I?.length||0,se=I?.filter(oe=>oe.isActive).length,G=J.reduce((oe,fe)=>oe*1+fe.quantity*1*fe.averageCost*1,0),re=M?.filter(oe=>{const fe=new Date(oe.createdDate),ae=new Date;return fe.getMonth()===ae.getMonth()&&fe.getFullYear()===ae.getFullYear()}).length;return{totalProducts:Q,activeProducts:se,lowStockProducts:H.length,totalStockValue:G,totalMovementsThisMonth:re,totalLocations:ut.locations.length,activeLocations:ut.getActiveLocations().length}});const B=Mt(()=>ut.products.map(I=>{const M=ut.getStockByProduct(I.id),J=ut.getTotalStockByProduct(I.id),H=ut.getLastLocationByProduct(I.id);return{...I,totalStock:J,stockByLocation:M,lastLocation:H,isLowStock:J<=I.minStockLevel}})),ce=Mt(()=>K().map(I=>{const M=ut.getStockByProduct(I.id),J=ut.getTotalStockByProduct(I.id),H=ut.getLastLocationByProduct(I.id);return{...I,totalStock:J,stockByLocation:M,lastLocation:H,isLowStock:J<=I.minStockLevel}})),L=Mt(()=>{const I=$()?ce():B(),M=(T()-1)*b(),J=M+b();return I.slice(M,J)}),D=Mt(()=>{const I=$()?ce():B();return Math.ceil(I.length/b())}),j=I=>{q(I),x(!0)};return R(to,{get title(){return t("products.title","Products")},get children(){return[(()=>{var I=kk(),M=I.firstChild,J=M.firstChild,H=J.nextSibling,Q=H.firstChild;return I.style.setProperty("display","flex"),I.style.setProperty("justify-content","space-between"),I.style.setProperty("align-items","flex-start"),I.style.setProperty("margin-bottom","1.5rem"),I.style.setProperty("flex-wrap","wrap"),I.style.setProperty("gap","1rem"),M.style.setProperty("flex","1"),M.style.setProperty("min-width","300px"),J.style.setProperty("margin","0 0 1rem 0"),J.style.setProperty("font-size","1.5rem"),a(J,()=>t("inventory.products")),H.style.setProperty("display","flex"),H.style.setProperty("gap","1rem"),H.style.setProperty("align-items","center"),H.style.setProperty("flex-wrap","wrap"),Q.style.setProperty("flex","1"),Q.style.setProperty("min-width","250px"),a(Q,R(Tk,{onSearchResults:se=>{te(se),C(se.length>0)},get placeholder(){return t("inventory.searchProductsStock","Search products and check stock levels...")},showResults:!1,maxResults:20})),a(H,R(ht,{variant:"outline",onClick:()=>{z(),C(!1)},get children(){return["🔄 ",Ee(()=>t("common.showAll","Show All"))]}}),null),a(I,R(ze,{get when(){return pr.hasPermission("read_write")},get children(){return R(ht,{variant:"primary",onClick:()=>W(!0),get children(){return["➕ ",Ee(()=>t("inventory.addProduct"))]}})}}),null),I})(),(()=>{var I=Nk(),M=I.firstChild;return I.style.setProperty("margin-bottom","1rem"),I.style.setProperty("font-size","0.875rem"),I.style.setProperty("color","var(--text-muted)"),I.style.setProperty("display","flex"),I.style.setProperty("justify-content","space-between"),I.style.setProperty("align-items","center"),a(M,(()=>{var J=Ee(()=>!!$());return()=>J()?`${t("inventory.searchResults","Search Results")}: ${ce().length} ${t("common.products","products")}`:`${t("inventory.totalProducts","Total Products")}: ${B().length} ${t("common.products","products")}`})()),a(I,(()=>{var J=Ee(()=>!!$());return()=>J()&&(()=>{var H=Lk();return H.firstChild,H.style.setProperty("color","var(--primary-color)"),a(H,()=>t("inventory.filtered","Filtered view"),null),H})()})(),null),I})(),R(Ut,{get each(){return L()},children:I=>(()=>{var M=Rk(),J=M.firstChild,H=J.firstChild,Q=H.firstChild,se=Q.firstChild,G=se.nextSibling,re=Q.nextSibling,oe=re.nextSibling,fe=oe.firstChild,ae=H.nextSibling,Y=ae.firstChild,ie=Y.nextSibling,de=ie.firstChild,ue=de.nextSibling;ue.nextSibling;var ge=ie.nextSibling,Pe=ge.firstChild;return M.$$click=()=>j(I),M.addEventListener("mouseleave",pe=>{pe.currentTarget.style.transform="translateY(0)",pe.currentTarget.style.boxShadow="none"}),M.addEventListener("mouseenter",pe=>{pe.currentTarget.style.transform="translateY(-2px)",pe.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),m(M,F),m(J,X),Q.style.setProperty("display","flex"),Q.style.setProperty("align-items","center"),Q.style.setProperty("gap","0.5rem"),Q.style.setProperty("margin-bottom","0.5rem"),se.style.setProperty("margin","0"),se.style.setProperty("font-size","1.1rem"),a(se,()=>I.name),a(G,(()=>{var pe=Ee(()=>!!I.isLowStock);return()=>pe()?t("inventory.lowStockAlert"):t("inventory.inStock")})()),re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),a(re,()=>I.sku,null),a(re,()=>I.UPC?" • "+I.UPC:"",null),a(re,()=>I.category?" • "+I.category:"",null),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),a(oe,()=>t("inventory.lastSeen"),fe),a(oe,()=>I.lastLocation?.name||t("inventory.noMovements"),null),ae.style.setProperty("text-align","right"),Y.style.setProperty("font-size","1.25rem"),Y.style.setProperty("font-weight","700"),Y.style.setProperty("color","var(--primary-color)"),a(Y,()=>I.totalStock),ie.style.setProperty("font-size","0.875rem"),ie.style.setProperty("color","var(--text-muted)"),a(ie,()=>I.unitOfMeasure,de),a(ie,()=>t("inventory.min"),ue),a(ie,()=>I.minStockLevel,null),ge.style.setProperty("font-size","0.875rem"),ge.style.setProperty("color","var(--text-muted)"),a(ge,()=>t("inventory.cost"),Pe),a(ge,()=>k(I.unitCost),null),a(M,(()=>{var pe=Ee(()=>I?.stockByLocation?.length>0);return()=>pe()&&(()=>{var _e=Dk(),Le=_e.firstChild,De=Le.firstChild,Te=Le.nextSibling;return _e.style.setProperty("margin-top","1rem"),Le.style.setProperty("font-weight","500"),Le.style.setProperty("margin-bottom","0.5rem"),Le.style.setProperty("font-size","0.875rem"),a(Le,()=>t("inventory.stockByLocation"),De),Te.style.setProperty("display","flex"),Te.style.setProperty("flex-wrap","wrap"),Te.style.setProperty("gap","0.5rem"),a(Te,R(Ut,{get each(){return I.stockByLocation},children:$e=>{const Ie=ut.getLocationById($e.locationId);return(()=>{var Re=Mk(),Je=Re.firstChild;return Re.style.setProperty("padding","0.25rem 0.5rem"),Re.style.setProperty("background","var(--background-color)"),Re.style.setProperty("border-radius","var(--border-radius-sm)"),Re.style.setProperty("font-size","0.75rem"),Re.style.setProperty("border","1px solid var(--border-color)"),a(Re,()=>Ie?.name,Je),a(Re,()=>$e.quantity,null),Re})()}})),_e})()})(),null),Se(pe=>m(G,U(I.isLowStock),pe)),M})()}),Ee(()=>Ee(()=>D()>1)()&&(()=>{var I=Fk(),M=I.firstChild,J=M.firstChild,H=J.firstChild,Q=J.nextSibling,se=M.nextSibling,G=se.firstChild,re=G.firstChild,oe=re.nextSibling,fe=oe.nextSibling,ae=fe.firstChild,Y=se.nextSibling;return I.style.setProperty("display","flex"),I.style.setProperty("justify-content","space-between"),I.style.setProperty("align-items","center"),I.style.setProperty("margin-top","2rem"),I.style.setProperty("padding","1rem"),I.style.setProperty("background","var(--surface-color)"),I.style.setProperty("border-radius","var(--border-radius)"),I.style.setProperty("border","1px solid var(--border-color)"),M.style.setProperty("display","flex"),M.style.setProperty("align-items","center"),M.style.setProperty("gap","0.5rem"),J.style.setProperty("font-size","0.875rem"),J.style.setProperty("color","var(--text-muted)"),a(J,()=>t("common.showPerPage","Show per page"),H),Q.addEventListener("change",ie=>{P(parseInt(ie.target.value)),O(1)}),Q.style.setProperty("padding","0.25rem 0.5rem"),Q.style.setProperty("border","1px solid var(--border-color)"),Q.style.setProperty("border-radius","var(--border-radius-sm)"),Q.style.setProperty("background","var(--background-color)"),Q.style.setProperty("cursor","pointer"),se.style.setProperty("display","flex"),se.style.setProperty("align-items","center"),se.style.setProperty("gap","0.5rem"),a(se,R(ht,{variant:"outline",size:"sm",onClick:()=>O(1),get disabled(){return T()===1},get children(){return t("common.first","First")}}),G),a(se,R(ht,{variant:"outline",size:"sm",onClick:()=>O(ie=>Math.max(1,ie-1)),get disabled(){return T()===1},get children(){return t("common.previous","Previous")}}),G),G.style.setProperty("display","flex"),G.style.setProperty("align-items","center"),G.style.setProperty("gap","0.25rem"),re.style.setProperty("font-size","0.875rem"),a(re,()=>t("common.page","Page")),oe.addEventListener("change",ie=>{const de=parseInt(ie.target.value);de>=1&&de<=D()&&O(de)}),oe.style.setProperty("width","60px"),oe.style.setProperty("padding","0.25rem 0.5rem"),oe.style.setProperty("border","1px solid var(--border-color)"),oe.style.setProperty("border-radius","var(--border-radius-sm)"),oe.style.setProperty("text-align","center"),oe.style.setProperty("font-size","0.875rem"),fe.style.setProperty("font-size","0.875rem"),a(fe,()=>t("common.of","of"),ae),a(fe,D,null),a(se,R(ht,{variant:"outline",size:"sm",onClick:()=>O(ie=>Math.min(D(),ie+1)),get disabled(){return T()===D()},get children(){return t("common.next","Next")}}),null),a(se,R(ht,{variant:"outline",size:"sm",onClick:()=>O(D()),get disabled(){return T()===D()},get children(){return t("common.last","Last")}}),null),Y.style.setProperty("font-size","0.875rem"),Y.style.setProperty("color","var(--text-muted)"),a(Y,()=>{const ie=$()?ce():B(),de=(T()-1)*b()+1,ue=Math.min(T()*b(),ie.length);return t("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:de,end:ue,total:ie.length})}),Se(()=>tr(oe,"max",D())),Se(()=>Q.value=b()),Se(()=>oe.value=T()),I})()),R(Uy,{get isOpen(){return y()},onClose:()=>g(!1),onProductAdded:()=>{_()}}),R(wk,{get isOpen(){return f()},onClose:()=>{x(!1),q(null)},get product(){return E()},onEdit:()=>{x(!1),w(!0)}})]}})};br(["click"]);var Ok=he("<div><div></div><div>"),Bk=he("<div><div><img></div><div>X</div><div><div><h2></h2><div></div></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),jk=he("<div>"),Vk=he("<div><div>📦</div><h3></h3><p>"),qk=he("<div><div>"),zk=he("<div>✓"),Uk=he("<div><div><img loading=lazy></div><div><div></div><div> • </div><div></div><div>",!0,!1,!1);const Hk=t=>{const{t:e}=or(),[r,n]=Ce(null),[i,o]=Ce([]),[s,l]=Ce(!1),c=F=>{n(F),t.onProductSelect?.(F)},u=()=>{n(null),t.onProductSelect?.(null),o([]),l(!1)},h=F=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(F),y=()=>"YABABYSSolution",g=()=>"https://qvamarkets.s3.us-east-2.amazonaws.com/V2_images/7258/",f=F=>{if(F.productImageUrl)return g()+y()+"/"+F?.productImageUrl;const X={Electronics:"https://via.placeholder.com/400x300/4F46E5/FFFFFF?text=Electronics",Furniture:"https://via.placeholder.com/400x300/059669/FFFFFF?text=Furniture",Food:"https://via.placeholder.com/400x300/DC2626/FFFFFF?text=Food",Clothing:"https://via.placeholder.com/400x300/7C3AED/FFFFFF?text=Clothing",Tools:"https://via.placeholder.com/400x300/EA580C/FFFFFF?text=Tools",General:"https://via.placeholder.com/400x300/6B7280/FFFFFF?text=Product"};return X[F.category]||X.General},x={padding:"2rem"},S={"max-width":"600px",margin:"0 auto 2rem",position:"relative"},w={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},E={background:"var(--surface-color)","border-radius":"var(--border-radius)",overflow:"hidden","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.3s ease"},q={position:"relative",width:"100%",height:"200px",overflow:"hidden",background:"#f5f5f5"},ee={width:"100%",height:"100%","object-fit":"cover",transition:"transform 0.3s ease"},W={padding:"1rem"},K={"font-size":"1rem","font-weight":"600","margin-bottom":"0.5rem",color:"var(--text-primary)",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},te={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.25rem"},$={"font-size":"1.25rem","font-weight":"700",color:"var(--primary-color)","margin-top":"0.5rem"},C={display:"flex",gap:"2rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"2rem","box-shadow":"var(--shadow-md)","margin-bottom":"2rem",position:"relative"},T={width:"400px",height:"300px","border-radius":"var(--border-radius)",overflow:"hidden",background:"#f5f5f5"},O={flex:"1",display:"flex","flex-direction":"column",gap:"1rem"},b={display:"flex","justify-content":"space-between","padding-bottom":"0.5rem","border-bottom":"1px solid var(--border-light)"},P={"font-weight":"500",color:"var(--text-muted)"},_={"font-weight":"600",color:"var(--text-primary)"},z=F=>({display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"600",background:"#d4edda",color:"#155724"}),Z={"text-align":"center",padding:"4rem 2rem",color:"var(--text-muted)"},k={"font-size":"3rem","margin-bottom":"1rem",opacity:"0.5"};return(()=>{var F=qk(),X=F.firstChild;return m(F,x),a(X,R(gp,{onChange:U=>{console.log(U);let B=U;l(!0),c(B)},get placeholder(){return e("inventory.searchProductsImages","Search products to view images...")}})),a(F,R(ze,{get when(){return r()&&t.showDetails!==!1},get children(){var U=Bk(),B=U.firstChild,ce=B.firstChild,L=B.nextSibling,D=L.nextSibling,j=D.firstChild,I=j.firstChild,M=I.nextSibling,J=j.nextSibling,H=J.firstChild,Q=H.nextSibling,se=J.nextSibling,G=se.firstChild,re=G.nextSibling,oe=se.nextSibling,fe=oe.firstChild,ae=fe.nextSibling,Y=oe.nextSibling,ie=Y.firstChild,de=ie.nextSibling,ue=Y.nextSibling,ge=ue.firstChild,Pe=ge.nextSibling;return m(U,C),m(B,T),ce.style.setProperty("width","100%"),ce.style.setProperty("height","100%"),ce.style.setProperty("object-fit","contain"),ce.style.setProperty("aspect-ratio","1 / 1"),L.$$click=()=>{u()},L.style.setProperty("position","absolute"),L.style.setProperty("top","0.5rem"),L.style.setProperty("right","0.5rem"),L.style.setProperty("color","#3d3d3d"),L.style.setProperty("border-radius","50%"),L.style.setProperty("width","2rem"),L.style.setProperty("height","2rem"),L.style.setProperty("display","flex"),L.style.setProperty("align-items","center"),L.style.setProperty("justify-content","center"),L.style.setProperty("font-size","1.25rem"),L.style.setProperty("box-shadow","var(--shadow-sm)"),L.style.setProperty("cursor","pointer"),m(D,O),I.style.setProperty("margin","0 0 0.5rem 0"),I.style.setProperty("font-size","1.5rem"),a(I,()=>r().name),a(M,()=>e("products.inStock","In Stock")),a(H,()=>e("products.sku","SKU")),a(Q,()=>r().sku),a(G,()=>e("inventory.category","Category")),a(re,()=>r().category),a(fe,()=>e("inventory.unitOfMeasure","Unit")),a(ae,()=>r().unitOfMeasure),a(ie,()=>e("inventory.unitCost","Cost")),a(de,()=>h(r().unitCost)),a(ge,()=>e("inventory.UPC","UPC")),a(Pe,()=>r().UPC),a(D,R(ze,{get when(){return r().description},get children(){var pe=Ok(),_e=pe.firstChild,Le=_e.nextSibling;return pe.style.setProperty("margin-top","1rem"),a(_e,()=>e("common.description","Description")),Le.style.setProperty("margin-top","0.5rem"),Le.style.setProperty("color","var(--text-primary)"),a(Le,()=>r().description),Se(De=>m(_e,P,De)),pe}}),null),Se(pe=>{var _e=f(r()),Le=r().name,De=z(),Te=b,$e=P,Ie=_,Re=b,Je=P,Be=_,Ke=b,Xe=P,at=_,ot=b,Qe=P,dt=_,ct=b,kt=P,gt=_;return _e!==pe.e&&tr(ce,"src",pe.e=_e),Le!==pe.t&&tr(ce,"alt",pe.t=Le),pe.a=m(M,De,pe.a),pe.o=m(J,Te,pe.o),pe.i=m(H,$e,pe.i),pe.n=m(Q,Ie,pe.n),pe.s=m(se,Re,pe.s),pe.h=m(G,Je,pe.h),pe.r=m(re,Be,pe.r),pe.d=m(oe,Ke,pe.d),pe.l=m(fe,Xe,pe.l),pe.u=m(ae,at,pe.u),pe.c=m(Y,ot,pe.c),pe.w=m(ie,Qe,pe.w),pe.m=m(de,dt,pe.m),pe.f=m(ue,ct,pe.f),pe.y=m(ge,kt,pe.y),pe.g=m(Pe,gt,pe.g),pe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),U}}),null),a(F,R(ze,{get when(){return i().length>0},get children(){var U=jk();return m(U,w),a(U,R(Ut,{get each(){return i()},children:B=>(()=>{var ce=Uk(),L=ce.firstChild,D=L.firstChild,j=L.nextSibling,I=j.firstChild,M=I.nextSibling,J=M.firstChild,H=M.nextSibling,Q=H.nextSibling;return ce.addEventListener("mouseleave",se=>{se.currentTarget.style.transform="translateY(0)",se.currentTarget.style.boxShadow="var(--shadow-sm)";const G=se.currentTarget.querySelector("img");G&&(G.style.transform="scale(1)")}),ce.addEventListener("mouseenter",se=>{se.currentTarget.style.transform="translateY(-4px)",se.currentTarget.style.boxShadow="var(--shadow-lg)";const G=se.currentTarget.querySelector("img");G&&(G.style.transform="scale(1.05)")}),ce.$$click=()=>c(B),m(ce,E),a(L,R(ze,{get when(){return B===r()},get children(){var se=zk();return se.style.setProperty("position","absolute"),se.style.setProperty("top","0.5rem"),se.style.setProperty("right","0.5rem"),se.style.setProperty("background","var(--primary-color)"),se.style.setProperty("color","white"),se.style.setProperty("border-radius","50%"),se.style.setProperty("width","2rem"),se.style.setProperty("height","2rem"),se.style.setProperty("display","flex"),se.style.setProperty("align-items","center"),se.style.setProperty("justify-content","center"),se.style.setProperty("font-size","1.25rem"),se}}),null),m(j,W),a(I,()=>B.name),a(M,()=>B.sku,J),a(M,()=>B.category,null),a(H,()=>B.unitOfMeasure),m(Q,$),a(Q,()=>h(B.sellingPrice)),Se(se=>{var G=q,re=f(B),oe=B.name,fe=ee,ae=K,Y=B.name,ie=te,de=te;return se.e=m(L,G,se.e),re!==se.t&&tr(D,"src",se.t=re),oe!==se.a&&tr(D,"alt",se.a=oe),se.o=m(D,fe,se.o),se.i=m(I,ae,se.i),Y!==se.n&&tr(I,"title",se.n=Y),se.s=m(M,ie,se.s),se.h=m(H,de,se.h),se},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),ce})()})),U}}),null),a(F,R(ze,{get when(){return!r()},get children(){var U=Vk(),B=U.firstChild,ce=B.nextSibling,L=ce.nextSibling;return m(B,k),ce.style.setProperty("margin-bottom","0.5rem"),a(ce,()=>e("inventory.noProductsFound","No Products Found")),a(L,()=>e("inventory.tryDifferentSearch","Try a different search term")),Se(D=>m(U,Z,D)),U}}),null),Se(U=>m(X,S,U)),F})()};br(["click"]);var Gk=he("<div><div>📊</div><div></div><div>"),C0=he("<div>"),Wk=he("<div><div><div><h2> - </h2><button>×</button></div><div>"),Yk=he("<div><div><div><div><h3></h3><span></span></div><div></div></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>");const Kk=t=>{const{t:e}=or(),[r,n]=Ce(""),[i,o]=Ce(!1),s=Mt(()=>{const x=ut.movements,S=new Map;return x.forEach(w=>{const E=w.referenceNumber||w.invoiceId||w.ssg_inventory_key||"UNKNOWN";S.has(E)||S.set(E,{referenceNumber:E,movements:[],totalItems:0,totalValue:0,createdDate:w.createdDate,movementType:w.movementType});const q=S.get(E);q.movements.push(w),q.totalItems+=w.quantity,q.totalValue+=w.totalCost,new Date(w.createdDate)<new Date(q.createdDate)&&(q.createdDate=w.createdDate)}),Array.from(S.values()).filter(w=>w.movements.length>1).sort((w,E)=>new Date(E.createdDate).getTime()-new Date(w.createdDate).getTime())}),l=Mt(()=>{const x=s().find(S=>S.referenceNumber===r());return x?x.movements:[]}),c=x=>{n(x),o(!0)},u=()=>{o(!1),n("")},h=x=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(x),y=x=>new Date(x).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),g=x=>({in:e("inventory.purchaseReceive"),out:e("inventory.saleIssue"),transfer:e("inventory.transfer"),adjustment:e("inventory.adjustment")})[x]||x,f=x=>({in:"#4caf50",out:"#f44336",transfer:"#2196f3",adjustment:"#ff9800"})[x]||"#666";return[R(On,{get isOpen(){return Ee(()=>!!t.isOpen)()&&!i()},get onClose(){return t.onClose},get title(){return e("inventory.viewHistoricalReports")},size:"large",get children(){var x=C0();return x.style.setProperty("max-height","70vh"),x.style.setProperty("overflow-y","auto"),a(x,R(ze,{get when(){return s().length===0},get children(){var S=Gk(),w=S.firstChild,E=w.nextSibling,q=E.nextSibling;return S.style.setProperty("text-align","center"),S.style.setProperty("padding","3rem"),S.style.setProperty("color","var(--text-muted)"),w.style.setProperty("font-size","2rem"),w.style.setProperty("margin-bottom","1rem"),E.style.setProperty("font-size","1.1rem"),E.style.setProperty("margin-bottom","0.5rem"),a(E,()=>e("inventory.noBulkReportsFound","No bulk movement reports found")),q.style.setProperty("font-size","0.9rem"),a(q,()=>e("inventory.bulkReportsAppearHere","Bulk movement reports will appear here after you create bulk movements")),S}}),null),a(x,R(ze,{get when(){return s().length>0},get children(){var S=C0();return S.style.setProperty("display","grid"),S.style.setProperty("gap","1rem"),a(S,R(Ut,{get each(){return s()},children:w=>(()=>{var E=Yk(),q=E.firstChild,ee=q.firstChild,W=ee.firstChild,K=W.firstChild,te=K.nextSibling,$=W.nextSibling,C=q.nextSibling,T=C.firstChild,O=T.firstChild,b=O.nextSibling,P=T.nextSibling,_=P.firstChild,z=_.nextSibling,Z=P.nextSibling,k=Z.firstChild,F=k.nextSibling;return E.style.setProperty("padding","1.5rem"),E.style.setProperty("border","1px solid var(--border-color)"),E.style.setProperty("border-radius","var(--border-radius)"),E.style.setProperty("background","var(--surface-color)"),E.style.setProperty("transition","all 0.2s ease"),q.style.setProperty("display","flex"),q.style.setProperty("justify-content","space-between"),q.style.setProperty("align-items","flex-start"),q.style.setProperty("margin-bottom","1rem"),ee.style.setProperty("flex","1"),W.style.setProperty("display","flex"),W.style.setProperty("align-items","center"),W.style.setProperty("gap","1rem"),W.style.setProperty("margin-bottom","0.5rem"),K.style.setProperty("margin","0"),K.style.setProperty("font-size","1.1rem"),K.style.setProperty("color","var(--text-primary)"),a(K,()=>w.referenceNumber),te.style.setProperty("padding","0.25rem 0.75rem"),te.style.setProperty("border-radius","1rem"),te.style.setProperty("font-size","0.75rem"),te.style.setProperty("font-weight","500"),a(te,()=>g(w.movementType)),$.style.setProperty("color","var(--text-muted)"),$.style.setProperty("font-size","0.875rem"),a($,()=>y(w.createdDate)),a(q,R(ht,{variant:"outline",size:"sm",onClick:()=>c(w.referenceNumber),get children(){return e("common.view")}}),null),C.style.setProperty("display","grid"),C.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),C.style.setProperty("gap","1rem"),C.style.setProperty("margin-bottom","1rem"),O.style.setProperty("font-size","0.75rem"),O.style.setProperty("font-weight","500"),O.style.setProperty("text-transform","uppercase"),O.style.setProperty("color","var(--text-muted)"),O.style.setProperty("margin-bottom","0.25rem"),a(O,()=>e("inventory.totalProducts")),b.style.setProperty("font-size","1.25rem"),b.style.setProperty("font-weight","600"),b.style.setProperty("color","var(--primary-color)"),a(b,()=>w.movements.length),_.style.setProperty("font-size","0.75rem"),_.style.setProperty("font-weight","500"),_.style.setProperty("text-transform","uppercase"),_.style.setProperty("color","var(--text-muted)"),_.style.setProperty("margin-bottom","0.25rem"),a(_,()=>e("inventory.totalItems")),z.style.setProperty("font-size","1.25rem"),z.style.setProperty("font-weight","600"),z.style.setProperty("color","var(--primary-color)"),a(z,()=>w.totalItems),k.style.setProperty("font-size","0.75rem"),k.style.setProperty("font-weight","500"),k.style.setProperty("text-transform","uppercase"),k.style.setProperty("color","var(--text-muted)"),k.style.setProperty("margin-bottom","0.25rem"),a(k,()=>e("inventory.estimatedValue")),F.style.setProperty("font-size","1.25rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("color","var(--primary-color)"),a(F,()=>h(w.totalValue)),Se(X=>{var U=f(w.movementType)+"20",B=f(w.movementType);return U!==X.e&&((X.e=U)!=null?te.style.setProperty("background",U):te.style.removeProperty("background")),B!==X.t&&((X.t=B)!=null?te.style.setProperty("color",B):te.style.removeProperty("color")),X},{e:void 0,t:void 0}),E})()})),S}}),null),x}}),R(ze,{get when(){return i()},get children(){var x=Wk(),S=x.firstChild,w=S.firstChild,E=w.firstChild,q=E.firstChild,ee=E.nextSibling,W=w.nextSibling;return x.style.setProperty("position","fixed"),x.style.setProperty("top","0"),x.style.setProperty("left","0"),x.style.setProperty("right","0"),x.style.setProperty("bottom","0"),x.style.setProperty("background","rgba(0, 0, 0, 0.5)"),x.style.setProperty("z-index","1000"),x.style.setProperty("display","flex"),x.style.setProperty("align-items","center"),x.style.setProperty("justify-content","center"),x.style.setProperty("padding","2rem"),S.style.setProperty("background","white"),S.style.setProperty("border-radius","var(--border-radius)"),S.style.setProperty("width","95%"),S.style.setProperty("max-width","1200px"),S.style.setProperty("max-height","90vh"),S.style.setProperty("overflow-y","auto"),S.style.setProperty("position","relative"),w.style.setProperty("padding","1rem 2rem"),w.style.setProperty("border-bottom","1px solid #e9ecef"),w.style.setProperty("display","flex"),w.style.setProperty("justify-content","space-between"),w.style.setProperty("align-items","center"),w.style.setProperty("background","#f8f9fa"),E.style.setProperty("margin","0"),a(E,()=>e("inventory.bulkMovementReport"),q),a(E,r,null),ee.$$click=u,ee.style.setProperty("background","none"),ee.style.setProperty("border","none"),ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("cursor","pointer"),ee.style.setProperty("padding","0.5rem"),ee.style.setProperty("line-height","1"),W.style.setProperty("padding","1rem"),a(W,R(N5,{get movements(){return l()},onClose:u})),x}})]};br(["click"]);var Jk=he("<div><h1></h1><div>"),Ii=he("<div>"),Qk=he("<div><h3></h3><div>"),Xk=he("<div>: <!> "),Zk=he("<div><button></button><button></button><button></button><button>"),eN=he("<div><div>"),tN=he("<div><span> (<!>)</span><span> / <!> "),rN=he("<div><div><h2></h2></div><div>"),nN=he("<div><div><div><span></span><h3></h3></div><div> • </div><div></div></div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div>:"),iN=he("<div><div><div><div></div><div></div></div><div><div> </div><div></div><div>Min: "),oN=he("<span>⚠️ LOW");const sN=()=>{const{t}=or(),[e,r]=Ce(!1),[n,i]=Ce(!1),[o,s]=Ce(!1),[l,c]=Ce(null),[u,h]=Ce("overview"),[y,g]=Ce("new"),[f,x]=Ce([]),[S,w]=Ce(!1),[E,q]=Ce(!1),[ee,W]=Ce(!1),[K,te]=Ce(!1),[$,C]=Ce(1),T=H=>{c(H),s(!0)},O=Mt(()=>{const H=ut.products||[],Q=ut.movements||[],se=ut.stockLevels||[],G=ut.getLowStockProducts(),re=H?.length||0,oe=H?.filter(Y=>Y.isActive).length,fe=se.reduce((Y,ie)=>Y*1+ie.quantity*1*ie.averageCost*1,0),ae=Q?.filter(Y=>{const ie=new Date(Y.createdDate),de=new Date;return ie.getMonth()===de.getMonth()&&ie.getFullYear()===de.getFullYear()}).length;return{totalProducts:re,activeProducts:oe,lowStockProducts:G.length,totalStockValue:fe,totalMovementsThisMonth:ae,totalLocations:ut.locations.length,activeLocations:ut.getActiveLocations().length}});Mt(()=>ut.products.map(H=>{const Q=ut.getStockByProduct(H.id),se=ut.getTotalStockByProduct(H.id),G=ut.getLastLocationByProduct(H.id);return{...H,totalStock:se,stockByLocation:Q,lastLocation:G,isLowStock:se<=H.minStockLevel}})),Mt(()=>{S(),C(1)});const b=(H,Q)=>H<=Q?t("inventory.lowStockAlert"):H<=Q*2?t("inventory.normalStock"):t("inventory.inStock"),P=H=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(H),_=H=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(H),z=H=>{switch(H){case"warehouse":return t("inventory.warehouse");case"store":return t("inventory.store");case"supplier":return t("inventory.supplier");case"customer":return t("inventory.customer");default:return H}},Z={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},k={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},F=H=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500",background:H>50?"#d4edda":H>20?"#fff3cd":"#f8d7da",color:H>50?"#155724":H>20?"#856404":"#721c24"}),X={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},U={color:"var(--text-muted)","font-size":"0.875rem"},B={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},ce={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},L={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},D=H=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:H?"var(--primary-color)":"var(--text-muted)","border-bottom":H?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),j={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem","margin-bottom":"2rem"},I={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},M=Mt(()=>{const H=ut.movements;return{total:H.length,stockIn:H.filter(Q=>Q.movementType==="in").length,stockOut:H.filter(Q=>Q.movementType==="out").length,transfers:H.filter(Q=>Q.movementType==="transfer").length,adjustments:H.filter(Q=>Q.movementType==="adjustment").length,totalValue:H.reduce((Q,se)=>Q+se.totalCost,0)}}),J=async()=>{let H=pr.state?.profile?.businessId;setTimeout(async()=>{await ut.getStockLevels("YY_")},2300),zy.calcStockLevels(),await ut.fecthProduct(H),await ut.fecthInventory(H)};return wn(()=>{J()}),R(to,{get title(){return t("inventory.title")},get children(){return[(()=>{var H=Jk(),Q=H.firstChild,se=Q.nextSibling;return m(H,ce),Q.style.setProperty("margin","0"),Q.style.setProperty("font-size","1.75rem"),se.style.setProperty("display","flex"),se.style.setProperty("align-items","center"),se.style.setProperty("gap","1rem"),a(se,(()=>{var G=Ee(()=>y()==="new");return()=>G()&&R(ht,{variant:"outline",onClick:()=>W(!0),get children(){return["🔢 ",Ee(()=>t("inventory.physicalCount","Physical Count"))]}})})(),null),a(se,R(ze,{get when(){return pr.hasPermission("read_write")},get children(){return[R(ht,{variant:"outline",onClick:()=>te(!0),get children(){return["📊 ",Ee(()=>t("inventory.viewHistoricalReports"))]}}),R(ht,{variant:"primary",onClick:()=>i(!0),get children(){return Ee(()=>y()==="new")()?t("inventory.addMovement"):t("common.add")}})]}}),null),H})(),R(Hk,{}),R(ze,{get when(){return pr.hasPermission("inventoryDownsection")},get children(){return Ee(()=>y()==="legacy")()?[(()=>{var H=Ii();return a(H,R(Ot,{get title(){return t("inventory.totalItems")},get subtitle(){return t("inventory.inStock")},get children(){var Q=Ii();return Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","600"),Q.style.setProperty("color","var(--primary-color)"),a(Q,()=>ut.inventory.length),Q}}),null),a(H,R(Ot,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.itemsBelowThreshold")},get children(){var Q=Ii();return Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","600"),Q.style.setProperty("color","var(--primary-color)"),a(Q,()=>ut.getLowStockItems().length),Q}}),null),a(H,R(Ot,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.inventoryWorth")},get children(){var Q=Ii();return Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","600"),Q.style.setProperty("color","var(--primary-color)"),a(Q,()=>P(ut.getTotalValue())),Q}}),null),Se(Q=>m(H,B,Q)),H})(),(()=>{var H=Ii();return m(H,Z),a(H,R(Ut,{get each(){return ut.inventory},children:Q=>{const se=b(Q.quantity,Q.minStock),G=Q.quantity<=Q.minStock?8:Q.quantity<=Q.minStock*2?35:75;return R(Ot,{onClick:()=>T(Q),get children(){return[(()=>{var re=Qk(),oe=re.firstChild,fe=oe.nextSibling;return m(re,k),oe.style.setProperty("margin","0"),oe.style.setProperty("font-size","1.1rem"),a(oe,()=>Q.name),a(fe,se),Se(ae=>m(fe,F(G),ae)),re})(),(()=>{var re=Ii();return m(re,X),a(re,()=>P(Q.price)),re})(),(()=>{var re=Xk(),oe=re.firstChild,fe=oe.nextSibling;return fe.nextSibling,m(re,U),a(re,()=>t("inventory.quantity"),oe),a(re,()=>Q.quantity,fe),a(re,()=>t("common.units"),null),re})()]}})}})),H})()]:[(()=>{var H=Zk(),Q=H.firstChild,se=Q.nextSibling,G=se.nextSibling,re=G.nextSibling;return m(H,L),Q.$$click=()=>h("overview"),a(Q,()=>t("inventory.overview")),se.$$click=()=>h("products"),a(se,()=>t("inventory.products")),G.$$click=()=>h("movements"),a(G,()=>t("inventory.movements")),re.$$click=()=>h("locations"),a(re,()=>t("inventory.locations")),Se(oe=>{var fe=D(u()==="overview"),ae=D(u()==="products"),Y=D(u()==="movements"),ie=D(u()==="locations");return oe.e=m(Q,fe,oe.e),oe.t=m(se,ae,oe.t),oe.a=m(G,Y,oe.a),oe.o=m(re,ie,oe.o),oe},{e:void 0,t:void 0,a:void 0,o:void 0}),H})(),Ee(()=>Ee(()=>u()==="overview")()&&(()=>{var H=eN(),Q=H.firstChild;return a(Q,R(Ot,{get title(){return t("inventory.activeProducts")},get subtitle(){return t("inventory.currentlyManaged")},get children(){var se=Ii();return se.style.setProperty("font-size","1.5rem"),se.style.setProperty("font-weight","600"),se.style.setProperty("color","var(--primary-color)"),a(se,()=>O().activeProducts),se}}),null),a(Q,R(Ot,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.needAttention")},get children(){var se=Ii();return se.style.setProperty("font-size","1.5rem"),se.style.setProperty("font-weight","600"),se.style.setProperty("color","#d32f2f"),a(se,()=>O().lowStockProducts),se}}),null),a(Q,R(Ot,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.currentWorth")},get children(){var se=Ii();return se.style.setProperty("font-size","1.5rem"),se.style.setProperty("font-weight","600"),se.style.setProperty("color","var(--primary-color)"),a(se,()=>_(M().totalValue)),se}}),null),a(Q,R(Ot,{get title(){return t("inventory.movements")},get subtitle(){return t("inventory.thisMonth")},get children(){var se=Ii();return se.style.setProperty("font-size","1.5rem"),se.style.setProperty("font-weight","600"),se.style.setProperty("color","var(--primary-color)"),a(se,()=>O().totalMovementsThisMonth),se}}),null),a(Q,R(Ot,{get title(){return t("inventory.activeLocations")},get subtitle(){return t("inventory.warehousesStores")},get children(){var se=Ii();return se.style.setProperty("font-size","1.5rem"),se.style.setProperty("font-weight","600"),se.style.setProperty("color","var(--primary-color)"),a(se,()=>O().activeLocations),se}}),null),a(H,(()=>{var se=Ee(()=>O().lowStockProducts>0);return()=>se()&&R(Ot,{get title(){return`⚠️ ${t("inventory.lowStockAlert")}`},get subtitle(){return`${O().lowStockProducts} ${t("inventory.productsNeedRestocking")}`},style:{"margin-bottom":"2rem","border-color":"#ffcdd2",background:"#ffebee"},get children(){var G=Ii();return G.style.setProperty("margin-top","1rem"),a(G,R(Ut,{get each(){return ut.getLowStockProducts().slice(0,9)},children:re=>(()=>{var oe=tN(),fe=oe.firstChild,ae=fe.firstChild,Y=ae.nextSibling;Y.nextSibling;var ie=fe.nextSibling,de=ie.firstChild,ue=de.nextSibling;return ue.nextSibling,oe.style.setProperty("display","flex"),oe.style.setProperty("justify-content","space-between"),oe.style.setProperty("margin-bottom","0.5rem"),oe.style.setProperty("font-size","0.875rem"),a(fe,()=>re.name,ae),a(fe,()=>re?.sku,Y),ie.style.setProperty("color","#d32f2f"),ie.style.setProperty("font-weight","600"),a(ie,()=>re.currentStock,de),a(ie,()=>re.minStockLevel,ue),a(ie,()=>t("inventory.min"),null),oe})()}),null),a(G,(()=>{var re=Ee(()=>ut.getLowStockProducts().length>5);return()=>re()&&(()=>{var oe=Ii();return oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),oe.style.setProperty("font-style","italic"),a(oe,()=>t("common.andMore",{count:ut.getLowStockProducts().length-9})),oe})()})(),null),G}})})(),null),Se(se=>m(Q,B,se)),H})()),Ee(()=>Ee(()=>u()==="products")()&&R(L5,{})),Ee(()=>Ee(()=>u()==="movements")()&&R(WT,{})),Ee(()=>Ee(()=>u()==="locations")()&&(()=>{var H=rN(),Q=H.firstChild,se=Q.firstChild,G=Q.nextSibling;return Q.style.setProperty("display","flex"),Q.style.setProperty("justify-content","space-between"),Q.style.setProperty("align-items","center"),Q.style.setProperty("margin-bottom","1.5rem"),se.style.setProperty("margin","0"),se.style.setProperty("font-size","1.5rem"),a(se,()=>t("inventory.locations")),a(Q,R(ze,{get when(){return pr.hasPermission("read_write")},get children(){return R(ht,{variant:"primary",onClick:()=>q(!0),get children(){return["🏭 ",Ee(()=>t("inventory.addLocation"))]}})}}),null),m(G,j),a(G,R(Ut,{get each(){return ut.getActiveLocations()},children:re=>{const oe=ut.getStockByLocation(re.id),fe=oe?.length,ae=oe?.reduce((ie,de)=>ie*1+de.quantity*1,0),Y=oe?.reduce((ie,de)=>(ut?.getProductById(de.productId),ie+(de?.averageCost||0)),0);return(()=>{var ie=nN(),de=ie.firstChild,ue=de.firstChild,ge=ue.firstChild,Pe=ge.nextSibling,pe=ue.nextSibling,_e=pe.firstChild,Le=pe.nextSibling,De=de.nextSibling,Te=De.firstChild,$e=Te.firstChild,Ie=$e.firstChild,Re=$e.nextSibling,Je=Te.nextSibling,Be=Je.firstChild,Ke=Be.firstChild,Xe=Be.nextSibling,at=Je.nextSibling,ot=at.firstChild,Qe=ot.firstChild,dt=ot.nextSibling,ct=De.nextSibling,kt=ct.firstChild,gt=kt.firstChild;return de.style.setProperty("margin-bottom","1rem"),de.style.setProperty("padding-bottom","1rem"),de.style.setProperty("border-bottom","1px solid var(--border-color)"),ue.style.setProperty("display","flex"),ue.style.setProperty("align-items","center"),ue.style.setProperty("gap","0.5rem"),ue.style.setProperty("margin-bottom","0.5rem"),ge.style.setProperty("font-size","1.2rem"),a(ge,()=>re.type==="warehouse"?"🏭":re.type==="store"?"🏪":re.type==="supplier"?"🚚":"👥"),Pe.style.setProperty("margin","0"),Pe.style.setProperty("font-size","1.1rem"),a(Pe,()=>re.name),pe.style.setProperty("font-size","0.875rem"),pe.style.setProperty("color","var(--text-muted)"),a(pe,()=>re.code,_e),a(pe,()=>z(re.type),null),Le.style.setProperty("font-size","0.75rem"),Le.style.setProperty("color","var(--text-muted)"),Le.style.setProperty("margin-top","0.25rem"),a(Le,()=>re.address),De.style.setProperty("margin-bottom","1rem"),Te.style.setProperty("display","flex"),Te.style.setProperty("justify-content","space-between"),Te.style.setProperty("margin-bottom","0.5rem"),$e.style.setProperty("font-size","0.875rem"),$e.style.setProperty("font-weight","500"),a($e,()=>t("inventory.products"),Ie),Re.style.setProperty("font-weight","600"),a(Re,fe),Je.style.setProperty("display","flex"),Je.style.setProperty("justify-content","space-between"),Je.style.setProperty("margin-bottom","0.5rem"),Be.style.setProperty("font-size","0.875rem"),Be.style.setProperty("font-weight","500"),a(Be,()=>t("inventory.totalItems"),Ke),Xe.style.setProperty("font-weight","600"),Xe.style.setProperty("color","var(--primary-color)"),a(Xe,ae),at.style.setProperty("display","flex"),at.style.setProperty("justify-content","space-between"),at.style.setProperty("margin-bottom","1rem"),ot.style.setProperty("font-size","0.875rem"),ot.style.setProperty("font-weight","500"),a(ot,()=>t("inventory.totalValue"),Qe),dt.style.setProperty("font-weight","600"),dt.style.setProperty("color","var(--primary-color)"),a(dt,()=>_(Y)),kt.style.setProperty("font-weight","600"),kt.style.setProperty("margin-bottom","0.75rem"),kt.style.setProperty("font-size","0.875rem"),kt.style.setProperty("color","var(--text-primary)"),kt.style.setProperty("border-bottom","1px solid var(--border-color)"),kt.style.setProperty("padding-bottom","0.5rem"),a(kt,()=>t("inventory.productDetails"),gt),a(ct,(()=>{var qe=Ee(()=>oe?.length===0);return()=>qe()?(()=>{var Dt=Ii();return Dt.style.setProperty("text-align","center"),Dt.style.setProperty("color","var(--text-muted)"),Dt.style.setProperty("font-style","italic"),Dt.style.setProperty("padding","1rem"),a(Dt,()=>t("inventory.noProducts")),Dt})():(()=>{var Dt=Ii();return Dt.style.setProperty("max-height","200px"),Dt.style.setProperty("overflow-y","auto"),Dt.style.setProperty("border","1px solid var(--border-color)"),Dt.style.setProperty("border-radius","var(--border-radius-sm)"),a(Dt,R(Ut,{each:oe,children:Rt=>{const St=ut.getProductById(Rt.productId);if(!St)return null;const Bt=Rt.quantity<=St.minStockLevel,fr=Rt.averageCost;return Rt.quantity?(()=>{var Qt=iN(),cr=Qt.firstChild,xr=cr.firstChild,It=xr.firstChild,Ge=It.nextSibling,Nt=xr.nextSibling,At=Nt.firstChild,Lt=At.firstChild,Ue=At.nextSibling,nt=Ue.nextSibling;return nt.firstChild,Qt.style.setProperty("padding","0.75rem"),Qt.style.setProperty("border-bottom","1px solid var(--border-color)"),(Bt?"#fff5f5":"transparent")!=null?Qt.style.setProperty("background",Bt?"#fff5f5":"transparent"):Qt.style.removeProperty("background"),Qt.style.setProperty("transition","background-color 0.2s ease"),cr.style.setProperty("display","flex"),cr.style.setProperty("justify-content","space-between"),cr.style.setProperty("align-items","flex-start"),cr.style.setProperty("margin-bottom","0.25rem"),xr.style.setProperty("flex","1"),It.style.setProperty("font-weight","500"),It.style.setProperty("font-size","0.875rem"),(Bt?"#d32f2f":"var(--text-primary)")!=null?It.style.setProperty("color",Bt?"#d32f2f":"var(--text-primary)"):It.style.removeProperty("color"),a(It,()=>St.name,null),a(It,Bt&&(()=>{var _t=oN();return _t.style.setProperty("margin-left","0.5rem"),_t.style.setProperty("font-size","0.7rem"),_t.style.setProperty("color","#d32f2f"),_t})(),null),Ge.style.setProperty("font-size","0.75rem"),Ge.style.setProperty("color","var(--text-muted)"),Ge.style.setProperty("margin-top","0.1rem"),a(Ge,()=>St.sku,null),a(Ge,()=>St.UPC?" • "+St.UPC:"",null),a(Ge,()=>St.category?" • "+St.category:"",null),Nt.style.setProperty("text-align","right"),At.style.setProperty("font-weight","600"),At.style.setProperty("font-size","0.875rem"),(Bt?"#d32f2f":"var(--primary-color)")!=null?At.style.setProperty("color",Bt?"#d32f2f":"var(--primary-color)"):At.style.removeProperty("color"),a(At,()=>Rt.quantity,Lt),a(At,()=>St.unitOfMeasure,null),Ue.style.setProperty("font-size","0.75rem"),Ue.style.setProperty("color","var(--text-muted)"),a(Ue,()=>_(fr)),nt.style.setProperty("font-size","0.7rem"),nt.style.setProperty("color","var(--text-muted)"),nt.style.setProperty("margin-top","0.1rem"),a(nt,()=>St.minStockLevel,null),Qt})():null}})),Dt})()})(),null),Se(qe=>m(ie,{...I,"min-height":"400px"},qe)),ie})()}})),H})())]}}),R(ze,{get when(){return pr.hasPermission("read_write")},get children(){return[R(YE,{get isOpen(){return e()},onClose:()=>r(!1),get mode(){return y()==="new"?"movement":"legacy"}}),R(fT,{get isOpen(){return n()},onClose:()=>i(!1)}),R(bT,{get isOpen(){return o()},onClose:()=>s(!1),get item(){return l()}}),R(Hy,{get isOpen(){return E()},onClose:()=>q(!1),onLocationAdded:()=>{q(!1)}})]}}),R(ok,{get isOpen(){return ee()},onClose:()=>W(!1)}),R(Kk,{get isOpen(){return K()},onClose:()=>te(!1)})]}})};br(["click"]);const aN=[{id:"1",name:"John Doe",position:"Software Engineer",salary:85e3,email:"john.doe@company.com",phone:"+1 (555) 123-4567",department:"Engineering",startDate:"2023-01-15"},{id:"2",name:"Jane Smith",position:"Product Manager",salary:95e3,email:"jane.smith@company.com",phone:"+1 (555) 234-5678",department:"Product",startDate:"2022-08-20"},{id:"3",name:"Mike Brown",position:"Designer",salary:7e4,email:"mike.brown@company.com",phone:"+1 (555) 345-6789",department:"Design",startDate:"2023-03-10"},{id:"4",name:"Sarah Kim",position:"HR Manager",salary:78e3,email:"sarah.kim@company.com",phone:"+1 (555) 456-7890",department:"Human Resources",startDate:"2022-11-05"},{id:"5",name:"Alex Lee",position:"Data Analyst",salary:72e3,email:"alex.lee@company.com",phone:"+1 (555) 567-8901",department:"Analytics",startDate:"2023-02-28"},{id:"6",name:"Emma Wilson",position:"Marketing Manager",salary:82e3,email:"emma.wilson@company.com",phone:"+1 (555) 678-9012",department:"Marketing",startDate:"2022-09-15"}],[ru,uf]=Ce(aN),R5={get employees(){return ru()},addEmployee(t){const e={...t,id:Date.now().toString()};return uf([...ru(),e]),e},updateEmployee(t,e){uf(ru().map(r=>r.id===t?{...r,...e}:r))},deleteEmployee(t){uf(ru().filter(e=>e.id!==t))},getEmployeeById(t){return ru().find(e=>e.id===t)}};var lN=he("<form><div>");const cN=t=>{const{t:e}=or(),[r,n]=Ce({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),i=[{value:"Engineering",label:e("employees.departments.engineering","Engineering")},{value:"Product",label:e("employees.departments.product","Product")},{value:"Design",label:e("employees.departments.design","Design")},{value:"Marketing",label:e("employees.departments.marketing","Marketing")},{value:"Sales",label:e("employees.departments.sales","Sales")},{value:"Human Resources",label:e("employees.departments.humanResources","Human Resources")},{value:"Finance",label:e("employees.departments.finance","Finance")},{value:"Operations",label:e("employees.departments.operations","Operations")},{value:"Analytics",label:e("employees.departments.analytics","Analytics")}],o={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},s=c=>{c.preventDefault();const u=r();if(!u.name||!u.position||!u.salary||!u.email||!u.department||!u.startDate){alert(e("forms.requiredField"));return}const h={name:u.name,position:u.position,salary:parseFloat(u.salary),email:u.email,phone:u.phone,department:u.department,startDate:u.startDate};R5.addEmployee(h),n({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),t.onClose()},l=(c,u)=>{n(h=>({...h,[c]:u}))};return R(On,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.addEmployee")},get children(){var c=lN(),u=c.firstChild;return c.addEventListener("submit",s),a(c,R($r,{get label(){return e("employees.fullName")},get value(){return r().name},onChange:h=>l("name",h),get placeholder(){return e("employees.enterFullName","Enter employee's full name")},required:!0}),u),a(c,R($r,{get label(){return e("employees.position")},get value(){return r().position},onChange:h=>l("position",h),get placeholder(){return e("employees.enterPosition","Enter job position")},required:!0}),u),a(c,R(Pn,{get label(){return e("employees.department")},get value(){return r().department},onChange:h=>l("department",h),options:i,required:!0}),u),a(c,R($r,{get label(){return e("employees.email")},type:"email",get value(){return r().email},onChange:h=>l("email",h),get placeholder(){return e("employees.enterEmail","Enter email address")},required:!0}),u),a(c,R($r,{get label(){return e("employees.phone")},type:"tel",get value(){return r().phone},onChange:h=>l("phone",h),get placeholder(){return e("employees.enterPhone","Enter phone number")}}),u),a(c,R($r,{get label(){return e("employees.salary")},type:"number",get value(){return r().salary},onChange:h=>l("salary",h),get placeholder(){return e("employees.enterSalary","Enter annual salary")},required:!0}),u),a(c,R($r,{get label(){return e("employees.hireDate")},type:"date",get value(){return r().startDate},onChange:h=>l("startDate",h),required:!0}),u),m(u,o),a(u,R(ht,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(u,R(ht,{variant:"primary",type:"submit",get children(){return e("employees.addEmployee")}}),null),c}})};var uN=he("<div><div></div><div></div><div>"),dN=he("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),hN=he("<div>");const pN=t=>{const{t:e}=or(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},i={"font-weight":"600",color:"var(--text-primary)"},o={width:"80px",height:"80px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.5rem",margin:"0 auto 1.5rem auto"},s={"text-align":"center","margin-bottom":"2rem"},l={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},c={color:"var(--text-muted)","font-size":"1rem"},u={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"};if(!t.employee)return null;const h=f=>f.split(" ").map(x=>x[0]).join("").toUpperCase(),y=f=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(f),g=f=>new Date(f).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return R(On,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.employeeDetails")},get children(){return[(()=>{var f=uN(),x=f.firstChild,S=x.nextSibling,w=S.nextSibling;return m(f,s),m(x,o),a(x,()=>h(t.employee.name)),m(S,l),a(S,()=>t.employee.name),m(w,c),a(w,()=>t.employee.position),f})(),(()=>{var f=dN(),x=f.firstChild,S=x.firstChild,w=S.nextSibling,E=x.nextSibling,q=E.firstChild,ee=q.nextSibling,W=E.nextSibling,K=W.firstChild,te=K.nextSibling,$=W.nextSibling,C=$.firstChild,T=C.nextSibling,O=$.nextSibling,b=O.firstChild,P=b.nextSibling,_=O.nextSibling,z=_.firstChild,Z=z.nextSibling;return a(S,()=>e("employees.employeeId")),a(w,()=>t.employee.id),a(q,()=>e("employees.department")),a(ee,()=>t.employee.department),a(K,()=>e("employees.email")),a(te,()=>t.employee.email),a(C,()=>e("employees.phone")),a(T,()=>t.employee.phone),a(b,()=>e("employees.salary")),a(P,()=>y(t.employee.salary)),a(z,()=>e("employees.hireDate")),a(Z,()=>g(t.employee.startDate)),Se(k=>{var F=r,X=n,U=i,B=r,ce=n,L=i,D=r,j=n,I=i,M=r,J=n,H=i,Q=r,se=n,G=i,re=r,oe=n,fe=i;return k.e=m(x,F,k.e),k.t=m(S,X,k.t),k.a=m(w,U,k.a),k.o=m(E,B,k.o),k.i=m(q,ce,k.i),k.n=m(ee,L,k.n),k.s=m(W,D,k.s),k.h=m(K,j,k.h),k.r=m(te,I,k.r),k.d=m($,M,k.d),k.l=m(C,J,k.l),k.u=m(T,H,k.u),k.c=m(O,Q,k.c),k.w=m(b,se,k.w),k.m=m(P,G,k.m),k.f=m(_,re,k.f),k.y=m(z,oe,k.y),k.g=m(Z,fe,k.g),k},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),f})(),(()=>{var f=hN();return m(f,u),a(f,R(ht,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),a(f,R(ht,{variant:"primary",onClick:()=>{console.log("Edit employee:",t.employee.id)},get children(){return e("employees.editEmployee")}}),null),f})()]}})};var I0=he("<div>"),fN=he("<div><div></div><div><div></div><div></div><div>/year");const mN=()=>{const{t}=or(),[e,r]=Ce(!1),[n,i]=Ce(!1),[o,s]=Ce(null),l=S=>{s(S),i(!0)},c={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},u={display:"flex","align-items":"center",gap:"1rem"},h={width:"60px",height:"60px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.2rem"},y={flex:"1"},g={"font-weight":"600","margin-bottom":"0.25rem"},f={color:"var(--text-muted)","font-size":"0.875rem","margin-bottom":"0.5rem"},x={color:"var(--primary-color)","font-weight":"500"};return R(to,{get title(){return t("employees.title")},get children(){return[(()=>{var S=I0();return S.style.setProperty("margin-bottom","2rem"),a(S,R(ht,{variant:"primary",onClick:()=>r(!0),get children(){return t("employees.addEmployee")}})),S})(),(()=>{var S=I0();return m(S,c),a(S,()=>R5.employees.map(w=>{const E=ee=>ee.split(" ").map(W=>W[0]).join("").toUpperCase(),q=ee=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ee);return R(Ot,{onClick:()=>l(w),get children(){var ee=fN(),W=ee.firstChild,K=W.nextSibling,te=K.firstChild,$=te.nextSibling,C=$.nextSibling,T=C.firstChild;return m(ee,u),m(W,h),a(W,()=>E(w.name)),m(K,y),m(te,g),a(te,()=>w.name),m($,f),a($,()=>w.position),m(C,x),a(C,()=>q(w.salary),T),ee}})})),S})(),R(cN,{get isOpen(){return e()},onClose:()=>r(!1)}),R(pN,{get isOpen(){return n()},onClose:()=>i(!1),get employee(){return o()}})]}})},yN=[{id:"1",accountId:"1002",bankName:"First National Bank",accountNumber:"****1234",accountType:"checking",currency:"USD",currentBalance:32730.5,lastReconciledDate:"2024-01-01",lastReconciledBalance:3e4,isActive:!0},{id:"2",accountId:"1003",bankName:"First National Bank",accountNumber:"****5678",accountType:"savings",currency:"USD",currentBalance:12e3,lastReconciledDate:"2024-01-01",lastReconciledBalance:1e4,isActive:!0}],gN=[{id:"1",accountId:"1002",date:"2024-01-15",description:"Customer Payment - ABC Corp",reference:"CHK001234",debitAmount:5e3,creditAmount:0,balance:35730.5,category:"Customer Payment",isReconciled:!0,reconciledWith:"eb1",importedAt:"2024-01-16",source:"csv_import"},{id:"2",accountId:"1002",date:"2024-01-14",description:"Office Supplies - Staples",reference:"CHK001235",debitAmount:0,creditAmount:250,balance:30730.5,category:"Office Expenses",isReconciled:!0,reconciledWith:"eb2",importedAt:"2024-01-16",source:"csv_import"},{id:"3",accountId:"1002",date:"2024-01-13",description:"Monthly Rent Payment",reference:"CHK001236",debitAmount:0,creditAmount:2e3,balance:28730.5,category:"Rent",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"},{id:"4",accountId:"1002",date:"2024-01-12",description:"Wire Transfer In",reference:"WIRE001",debitAmount:1e4,creditAmount:0,balance:38730.5,category:"Wire Transfer",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"}],vN=[{id:"eb1",accountId:"1002",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",debitAmount:5e3,creditAmount:0,category:"Accounts Receivable",isReconciled:!0,reconciledWith:"1",createdAt:"2024-01-15"},{id:"eb2",accountId:"1002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",debitAmount:0,creditAmount:250,category:"Office Expenses",isReconciled:!0,reconciledWith:"2",createdAt:"2024-01-14"},{id:"eb3",accountId:"1002",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",debitAmount:0,creditAmount:3500,category:"Salary Expense",isReconciled:!1,createdAt:"2024-01-11"}],bN=[{id:"1",bankAccountId:"1",periodStart:"2024-01-01",periodEnd:"2024-01-15",startingBalance:3e4,endingBalance:35730.5,status:"in_progress",totalBankTransactions:4,totalEntryBookRecords:3,reconciledTransactions:2,unreconciledTransactions:2,discrepancyAmount:1500,createdAt:"2024-01-16",notes:"Wire transfer and rent payment need investigation"}],[zd,$0]=Ce(yN),[da,df]=Ce(gN),[nu,E0]=Ce(vN),[Ud,T0]=Ce(bN),qn={get bankAccounts(){return zd()},addBankAccount(t){const e={...t,id:Date.now().toString()};return $0([...zd(),e]),e},updateBankAccount(t,e){$0(zd().map(r=>r.id===t?{...r,...e}:r))},getBankAccountById(t){return zd().find(e=>e.id===t)},get bankStatements(){return da()},addBankStatement(t){const e={...t,id:Date.now().toString(),importedAt:new Date().toISOString()};return df([...da(),e]),e},addBankStatementsFromCSV(t){const e=t.map(r=>({...r,id:`csv_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,importedAt:new Date().toISOString(),source:"csv_import",isReconciled:!1}));return df([...da(),...e]),e},updateBankStatement(t,e){df(da().map(r=>r.id===t?{...r,...e}:r))},getBankStatementsByAccount(t){return da().filter(e=>e.accountId===t)},getUnreconciledBankStatements(t){return(t?this.getBankStatementsByAccount(t):da()).filter(r=>!r.isReconciled)},get entryBookRecords(){return nu()},addEntryBookRecord(t){const e={...t,id:Date.now().toString(),createdAt:new Date().toISOString()};return E0([...nu(),e]),e},updateEntryBookRecord(t,e){E0(nu().map(r=>r.id===t?{...r,...e}:r))},getEntryBookRecordsByAccount(t){return nu().filter(e=>e.accountId===t)},getUnreconciledEntryBookRecords(t){return(t?this.getEntryBookRecordsByAccount(t):nu()).filter(r=>!r.isReconciled)},reconcileTransaction(t,e){this.updateBankStatement(t,{isReconciled:!0,reconciledWith:e}),this.updateEntryBookRecord(e,{isReconciled:!0,reconciledWith:t})},unreconciledTransaction(t){const e=da().find(r=>r.id===t);e?.reconciledWith&&this.updateEntryBookRecord(e.reconciledWith,{isReconciled:!1,reconciledWith:void 0}),this.updateBankStatement(t,{isReconciled:!1,reconciledWith:void 0})},findPotentialMatches(t){const e=da().find(n=>n.id===t);return e?this.getUnreconciledEntryBookRecords(e.accountId).filter(n=>{const i=Math.abs(e.debitAmount-n.debitAmount)<.01||Math.abs(e.creditAmount-n.creditAmount)<.01,o=new Date(e.date),s=new Date(n.date),c=Math.abs((o.getTime()-s.getTime())/(1e3*60*60*24))<=3,u=e.reference===n.reference||e.description.toLowerCase().includes(n.description.toLowerCase())||n.description.toLowerCase().includes(e.description.toLowerCase());return i&&(c||u)}).sort((n,i)=>{const o=(n.date===e.date?2:0)+(n.reference===e.reference?1:0);return(i.date===e.date?2:0)+(i.reference===e.reference?1:0)-o}):[]},get reconciliationSessions(){return Ud()},startReconciliationSession(t,e,r){const n=this.getBankStatementsByAccount(t).filter(u=>u.date>=e&&u.date<=r),i=this.getEntryBookRecordsByAccount(t).filter(u=>u.date>=e&&u.date<=r),o=n.filter(u=>u.isReconciled).length,s=this.getBankAccountById(t)?.lastReconciledBalance||0,l=this.getBankAccountById(t)?.currentBalance||0,c={id:Date.now().toString(),bankAccountId:t,periodStart:e,periodEnd:r,startingBalance:s,endingBalance:l,status:"in_progress",totalBankTransactions:n.length,totalEntryBookRecords:i.length,reconciledTransactions:o,unreconciledTransactions:n.length-o,discrepancyAmount:0,createdAt:new Date().toISOString()};return T0([...Ud(),c]),c},updateReconciliationSession(t,e){T0(Ud().map(r=>r.id===t?{...r,...e}:r))},getReconciliationSessionsByAccount(t){return Ud().filter(e=>e.bankAccountId===t)}};var hf=he("<div>"),_N=he("<div><strong>:</strong> <!> - "),SN=he("<div><div><div>📄</div><div></div><div></div></div><input id=csvFileInput type=file accept=.csv>"),PN=he("<div><h4></h4><div><div><label> *</label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><select><option value>"),rc=he("<option>"),wN=he("<div><table><thead><tr></tr></thead><tbody>"),xN=he("<th>"),AN=he("<tr>"),CN=he("<td>");const IN=t=>{const{t:e}=or(),[r,n]=Ce(!1),[i,o]=Ce(!1),[s,l]=Ce(null),[c,u]=Ce([]),[h,y]=Ce({date:"",description:"",reference:"",debit:"",credit:"",balance:""}),g={border:`2px dashed ${r()?"var(--primary-color)":"var(--border-color)"}`,"border-radius":"var(--border-radius)",padding:"2rem","text-align":"center","background-color":r()?"var(--background-color)":"transparent",transition:"all 0.2s ease",cursor:"pointer"},f={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem","margin-top":"1.5rem"},x={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-family":"inherit"},S={"max-height":"200px","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},w={width:"100%","border-collapse":"collapse","font-size":"0.875rem"},E={padding:"0.5rem","border-bottom":"1px solid var(--border-color)","text-align":"left"},q={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},ee=P=>{P.preventDefault(),n(!0)},W=P=>{P.preventDefault(),n(!1)},K=P=>{P.preventDefault(),n(!1);const _=P.dataTransfer?.files;_&&_.length>0&&$(_[0])},te=P=>{const _=P.target;_.files&&_.files.length>0&&$(_.files[0])},$=P=>{if(!P.name.toLowerCase().endsWith(".csv")){l({success:!1,message:e("banking.pleaseUploadCSV")});return}o(!0);const _=new FileReader;_.onload=z=>{try{const k=(z.target?.result).split(`
`).filter(B=>B.trim());if(k.length<2){l({success:!1,message:e("banking.csvRequiresHeaderAndData")}),o(!1);return}const F=k[0].split(",").map(B=>B.trim().replace(/[\"\']/g,"")),X=k.slice(1).map(B=>{const ce=B.split(",").map(D=>D.trim().replace(/[\"\']/g,"")),L={};return F.forEach((D,j)=>{L[D]=ce[j]||""}),L});u(X),l({success:!0,message:e("banking.successfullyParsed").replace("{count}",X.length.toString()),count:X.length});const U={...h()};F.forEach(B=>{const ce=B.toLowerCase();ce.includes("date")&&(U.date=B),(ce.includes("description")||ce.includes("memo"))&&(U.description=B),(ce.includes("reference")||ce.includes("check")||ce.includes("ref"))&&(U.reference=B),(ce.includes("debit")||ce.includes("deposit"))&&(U.debit=B),(ce.includes("credit")||ce.includes("withdrawal")||ce.includes("amount"))&&(U.debit?U.credit=B:U.debit=B),ce.includes("balance")&&(U.balance=B)}),y(U)}catch{l({success:!1,message:e("banking.errorParsingCSV")})}o(!1)},_.readAsText(P)},C=(P,_)=>{y(z=>({...z,[P]:_}))},T=()=>c().length===0?[]:Object.keys(c()[0]),O=()=>{if(!t.bankAccount||c().length===0)return;const P=h();if(!P.date||!P.description){l({success:!1,message:e("banking.dateDescriptionRequired")});return}o(!0);try{const _=c().map(Z=>{const k=B=>B&&parseFloat(B.replace(/[^0-9.-]/g,""))||0,F=B=>{const ce=new Date(B);if(isNaN(ce.getTime())){const L=B.split("/");if(L.length===3)return new Date(parseInt(L[2]),parseInt(L[0])-1,parseInt(L[1])).toISOString().split("T")[0]}return ce.toISOString().split("T")[0]};let X=0,U=0;if(P.debit&&P.credit)X=k(Z[P.debit]),U=k(Z[P.credit]);else if(P.debit){const B=k(Z[P.debit]);B>0?X=B:U=Math.abs(B)}return{accountId:t.bankAccount.accountId,date:F(Z[P.date]),description:Z[P.description]||e("banking.importedTransaction"),reference:Z[P.reference]||"",debitAmount:X,creditAmount:U,balance:P.balance?k(Z[P.balance]):0,isReconciled:!1}}),z=qn.addBankStatementsFromCSV(_);l({success:!0,message:e("banking.successfullyImported").replace("{count}",z.length.toString()),count:z.length}),u([]),y({date:"",description:"",reference:"",debit:"",credit:"",balance:""})}catch{l({success:!1,message:e("banking.errorImportingTransactions")})}o(!1)},b=()=>{u([]),l(null),y({date:"",description:"",reference:"",debit:"",credit:"",balance:""})};return R(On,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("banking.importBankStatementCSV")},get children(){return[Ee(()=>Ee(()=>!!t.bankAccount)()&&(()=>{var P=_N(),_=P.firstChild,z=_.firstChild,Z=_.nextSibling,k=Z.nextSibling;return k.nextSibling,P.style.setProperty("margin-bottom","1.5rem"),P.style.setProperty("padding","1rem"),P.style.setProperty("background","var(--background-color)"),P.style.setProperty("border-radius","var(--border-radius-sm)"),P.style.setProperty("border","1px solid var(--border-color)"),a(_,()=>e("banking.bankAccount"),z),a(P,()=>t.bankAccount.bankName,k),a(P,()=>t.bankAccount.accountNumber,null),P})()),Ee(()=>Ee(()=>c().length===0)()?(()=>{var P=SN(),_=P.firstChild,z=_.firstChild,Z=z.nextSibling,k=Z.nextSibling,F=_.nextSibling;return _.$$click=()=>document.getElementById("csvFileInput")?.click(),_.addEventListener("drop",K),_.addEventListener("dragleave",W),_.addEventListener("dragover",ee),z.style.setProperty("font-size","2rem"),z.style.setProperty("margin-bottom","1rem"),Z.style.setProperty("font-weight","500"),Z.style.setProperty("margin-bottom","0.5rem"),a(Z,(()=>{var X=Ee(()=>!!r());return()=>X()?e("banking.dropCSVHere"):e("banking.clickToUploadCSV")})()),k.style.setProperty("font-size","0.875rem"),k.style.setProperty("color","var(--text-muted)"),a(k,()=>e("banking.supportedFormat")),F.addEventListener("change",te),F.style.setProperty("display","none"),Se(X=>m(_,g,X)),P})():(()=>{var P=PN(),_=P.firstChild,z=_.nextSibling,Z=z.firstChild,k=Z.firstChild,F=k.firstChild,X=k.nextSibling,U=X.firstChild,B=Z.nextSibling,ce=B.firstChild,L=ce.firstChild,D=ce.nextSibling,j=D.firstChild,I=B.nextSibling,M=I.firstChild,J=M.nextSibling,H=J.firstChild,Q=I.nextSibling,se=Q.firstChild,G=se.firstChild,re=se.nextSibling,oe=re.firstChild,fe=Q.nextSibling,ae=fe.firstChild,Y=ae.nextSibling,ie=Y.firstChild,de=fe.nextSibling,ue=de.firstChild,ge=ue.nextSibling,Pe=ge.firstChild;return _.style.setProperty("margin","0 0 1rem 0"),a(_,()=>e("banking.mapCSVColumns")),m(z,f),k.style.setProperty("display","block"),k.style.setProperty("margin-bottom","0.5rem"),k.style.setProperty("font-weight","500"),a(k,()=>e("banking.dateColumn"),F),X.addEventListener("change",pe=>C("date",pe.target.value)),a(U,()=>e("banking.selectColumn")),a(X,()=>T().map(pe=>(()=>{var _e=rc();return _e.value=pe,a(_e,pe),_e})()),null),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),a(ce,()=>e("banking.descriptionColumn"),L),D.addEventListener("change",pe=>C("description",pe.target.value)),a(j,()=>e("banking.selectColumn")),a(D,()=>T().map(pe=>(()=>{var _e=rc();return _e.value=pe,a(_e,pe),_e})()),null),M.style.setProperty("display","block"),M.style.setProperty("margin-bottom","0.5rem"),M.style.setProperty("font-weight","500"),a(M,()=>e("banking.referenceColumn")),J.addEventListener("change",pe=>C("reference",pe.target.value)),a(H,()=>e("banking.selectColumn")),a(J,()=>T().map(pe=>(()=>{var _e=rc();return _e.value=pe,a(_e,pe),_e})()),null),se.style.setProperty("display","block"),se.style.setProperty("margin-bottom","0.5rem"),se.style.setProperty("font-weight","500"),a(se,()=>e("banking.amountDebitColumn"),G),re.addEventListener("change",pe=>C("debit",pe.target.value)),a(oe,()=>e("banking.selectColumn")),a(re,()=>T().map(pe=>(()=>{var _e=rc();return _e.value=pe,a(_e,pe),_e})()),null),ae.style.setProperty("display","block"),ae.style.setProperty("margin-bottom","0.5rem"),ae.style.setProperty("font-weight","500"),a(ae,()=>e("banking.creditColumn")),Y.addEventListener("change",pe=>C("credit",pe.target.value)),a(ie,()=>e("banking.selectColumn")),a(Y,()=>T().map(pe=>(()=>{var _e=rc();return _e.value=pe,a(_e,pe),_e})()),null),ue.style.setProperty("display","block"),ue.style.setProperty("margin-bottom","0.5rem"),ue.style.setProperty("font-weight","500"),a(ue,()=>e("banking.balanceColumn")),ge.addEventListener("change",pe=>C("balance",pe.target.value)),a(Pe,()=>e("banking.selectColumn")),a(ge,()=>T().map(pe=>(()=>{var _e=rc();return _e.value=pe,a(_e,pe),_e})()),null),a(P,(()=>{var pe=Ee(()=>c().length>0);return()=>pe()&&(()=>{var _e=wN(),Le=_e.firstChild,De=Le.firstChild,Te=De.firstChild,$e=De.nextSibling;return m(_e,S),Te.style.setProperty("background-color","var(--background-color)"),a(Te,()=>T().slice(0,6).map(Ie=>(()=>{var Re=xN();return a(Re,Ie),Se(Je=>m(Re,E,Je)),Re})())),a($e,()=>c().slice(0,3).map(Ie=>(()=>{var Re=AN();return a(Re,()=>T().slice(0,6).map(Je=>(()=>{var Be=CN();return a(Be,()=>Ie[Je]),Se(Ke=>m(Be,E,Ke)),Be})())),Re})())),a(_e,(()=>{var Ie=Ee(()=>c().length>3);return()=>Ie()&&(()=>{var Re=hf();return Re.style.setProperty("padding","0.5rem"),Re.style.setProperty("text-align","center"),Re.style.setProperty("color","var(--text-muted)"),a(Re,()=>e("banking.andMoreRows").replace("{count}",(c().length-3).toString())),Re})()})(),null),Se(Ie=>m(Le,w,Ie)),_e})()})(),null),Se(pe=>{var _e=x,Le=x,De=x,Te=x,$e=x,Ie=x;return pe.e=m(X,_e,pe.e),pe.t=m(D,Le,pe.t),pe.a=m(J,De,pe.a),pe.o=m(re,Te,pe.o),pe.i=m(Y,$e,pe.i),pe.n=m(ge,Ie,pe.n),pe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),Se(()=>X.value=h().date),Se(()=>D.value=h().description),Se(()=>J.value=h().reference),Se(()=>re.value=h().debit),Se(()=>Y.value=h().credit),Se(()=>ge.value=h().balance),P})()),Ee(()=>Ee(()=>!!s())()&&(()=>{var P=hf();return P.style.setProperty("padding","1rem"),P.style.setProperty("border-radius","var(--border-radius-sm)"),P.style.setProperty("margin-top","1rem"),a(P,()=>s().message),Se(_=>{var z=s().success?"#d4edda":"#f8d7da",Z=s().success?"#155724":"#721c24",k=`1px solid ${s().success?"#c3e6cb":"#f5c6cb"}`;return z!==_.e&&((_.e=z)!=null?P.style.setProperty("background",z):P.style.removeProperty("background")),Z!==_.t&&((_.t=Z)!=null?P.style.setProperty("color",Z):P.style.removeProperty("color")),k!==_.a&&((_.a=k)!=null?P.style.setProperty("border",k):P.style.removeProperty("border")),_},{e:void 0,t:void 0,a:void 0}),P})()),(()=>{var P=hf();return m(P,q),a(P,R(ht,{variant:"secondary",onClick:()=>{b(),t.onClose()},get children(){return e("common.cancel")}}),null),a(P,(()=>{var _=Ee(()=>c().length>0);return()=>_()&&R(ht,{variant:"outline",onClick:b,get children(){return e("common.reset")}})})(),null),a(P,(()=>{var _=Ee(()=>c().length>0);return()=>_()&&R(ht,{variant:"primary",onClick:O,get disabled(){return i()||!h().date||!h().description},get children(){return Ee(()=>!!i())()?e("banking.importing"):e("banking.importTransactions").replace("{count}",c().length.toString())}})})(),null),P})()]}})};br(["click"]);var k0=he("<span>"),Hd=he("<div>"),N0=he("<div> "),$N=he("<div><div><h3></h3><div><button></button><button></button><button></button></div></div><div></div><div><div><h4></h4><div></div></div><div><h4></h4><div>"),EN=he("<div><div><div></div><div> • </div></div><div><div>"),pf=he("<span>✓ "),TN=he("<span>(<!>)"),kN=he("<div><strong>:</strong> "),L0=he("<div><div><div></div><div> • </div></div><div>"),NN=he("<div><div>:</div><div></div><div>");const LN=t=>{const{t:e}=or(),[r,n]=Ce([]),[i,o]=Ce([]),[s,l]=Ce(null),[c,u]=Ce([]),[h,y]=Ce("unreconciled");gi(()=>{const k=qn.getBankAccountById(t.bankAccountId);if(k){const F=qn.getBankStatementsByAccount(k.accountId).filter(U=>U.date>=t.selectedPeriod.start&&U.date<=t.selectedPeriod.end),X=qn.getEntryBookRecordsByAccount(k.accountId).filter(U=>U.date>=t.selectedPeriod.start&&U.date<=t.selectedPeriod.end);n(F),o(X)}});const g=()=>{const k=r();switch(h()){case"reconciled":return k.filter(F=>F.isReconciled);case"unreconciled":return k.filter(F=>!F.isReconciled);default:return k}},f=()=>{const k=i();switch(h()){case"reconciled":return k.filter(F=>F.isReconciled);case"unreconciled":return k.filter(F=>!F.isReconciled);default:return k}},x=k=>{if(l(k),k.isReconciled)u([]);else{const F=qn.findPotentialMatches(k.id);u(F)}},S=k=>{const F=s();if(F){qn.reconcileTransaction(F.id,k.id);const X=qn.getBankAccountById(t.bankAccountId);if(X){const U=qn.getBankStatementsByAccount(X.accountId).filter(ce=>ce.date>=t.selectedPeriod.start&&ce.date<=t.selectedPeriod.end),B=qn.getEntryBookRecordsByAccount(X.accountId).filter(ce=>ce.date>=t.selectedPeriod.start&&ce.date<=t.selectedPeriod.end);n(U),o(B)}l(null),u([])}},w=k=>{qn.unreconciledTransaction(k.id);const F=qn.getBankAccountById(t.bankAccountId);if(F){const X=qn.getBankStatementsByAccount(F.accountId).filter(B=>B.date>=t.selectedPeriod.start&&B.date<=t.selectedPeriod.end),U=qn.getEntryBookRecordsByAccount(F.accountId).filter(B=>B.date>=t.selectedPeriod.start&&B.date<=t.selectedPeriod.end);n(X),o(U)}},E={display:"grid","grid-template-columns":"1fr 1fr",gap:"2rem","margin-top":"2rem"},q={height:"600px","overflow-y":"auto"},ee={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},W=k=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:k?"var(--primary-color)":"var(--surface-color)",color:k?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),K=(k,F)=>({display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem","margin-bottom":"0.5rem",background:k?"var(--primary-color)":F?"#e8f5e8":"var(--surface-color)",color:k?"white":"var(--text-primary)","border-radius":"var(--border-radius-sm)",border:`1px solid ${k?"var(--primary-color)":F?"#c3e6cb":"var(--border-color)"}`,cursor:"pointer",transition:"all 0.2s ease"}),te={flex:"1"},$={"font-weight":"500","margin-bottom":"0.25rem"},C={"font-size":"0.875rem",opacity:"0.8"},T=k=>({"font-weight":"600",color:k?"#4caf50":"#f44336"}),O={padding:"0.25rem 0.5rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","margin-left":"0.5rem"},b=k=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(k),P=k=>new Date(k).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),_=k=>{if(!s())return null;const F=s();return(Math.abs(F.debitAmount-k.debitAmount)<.01||Math.abs(F.creditAmount-k.creditAmount)<.01)&&F.date===k.date?(()=>{var B=k0();return a(B,()=>e("banking.exactMatch")),Se(ce=>m(B,{...O,background:"#d4edda",color:"#155724"},ce)),B})():c().includes(k)?(()=>{var B=k0();return a(B,()=>e("banking.possibleMatch")),Se(ce=>m(B,{...O,background:"#fff3cd",color:"#856404"},ce)),B})():null},Z=(()=>{const k=r(),F=i(),X=k.filter(B=>B.isReconciled).length,U=F.filter(B=>B.isReconciled).length;return{totalStatements:k.length,totalRecords:F.length,reconciledStatements:X,reconciledRecords:U,unreconciledStatements:k.length-X,unreconciledRecords:F.length-U}})();return(()=>{var k=$N(),F=k.firstChild,X=F.firstChild,U=X.nextSibling,B=U.firstChild,ce=B.nextSibling,L=ce.nextSibling,D=F.nextSibling,j=D.nextSibling,I=j.firstChild,M=I.firstChild,J=M.nextSibling,H=I.nextSibling,Q=H.firstChild,se=Q.nextSibling;return m(F,ee),X.style.setProperty("margin","0"),X.style.setProperty("font-size","1.25rem"),a(X,()=>e("banking.reconciliationComparison")),U.style.setProperty("display","flex"),U.style.setProperty("gap","0.5rem"),B.$$click=()=>y("all"),a(B,()=>e("common.all")),ce.$$click=()=>y("unreconciled"),a(ce,()=>e("banking.unreconciled")),L.$$click=()=>y("reconciled"),a(L,()=>e("banking.reconciled")),D.style.setProperty("display","grid"),D.style.setProperty("grid-template-columns","repeat(4, 1fr)"),D.style.setProperty("gap","1rem"),D.style.setProperty("margin-bottom","2rem"),a(D,R(Ot,{get title(){return e("banking.bankStatements")},get subtitle(){return e("banking.totalTransactions")},get children(){return[(()=>{var G=Hd();return G.style.setProperty("font-size","1.5rem"),G.style.setProperty("font-weight","600"),G.style.setProperty("color","var(--primary-color)"),a(G,()=>Z.totalStatements),G})(),(()=>{var G=N0(),re=G.firstChild;return G.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","var(--text-muted)"),a(G,()=>Z.reconciledStatements,re),a(G,()=>e("banking.reconciled"),null),G})()]}}),null),a(D,R(Ot,{get title(){return e("banking.entryBookRecords")},get subtitle(){return e("banking.totalEntries")},get children(){return[(()=>{var G=Hd();return G.style.setProperty("font-size","1.5rem"),G.style.setProperty("font-weight","600"),G.style.setProperty("color","var(--primary-color)"),a(G,()=>Z.totalRecords),G})(),(()=>{var G=N0(),re=G.firstChild;return G.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","var(--text-muted)"),a(G,()=>Z.reconciledRecords,re),a(G,()=>e("banking.reconciled"),null),G})()]}}),null),a(D,R(Ot,{get title(){return e("banking.unreconciledBank")},get subtitle(){return e("banking.needAttention")},get children(){var G=Hd();return G.style.setProperty("font-size","1.5rem"),G.style.setProperty("font-weight","600"),G.style.setProperty("color","#f44336"),a(G,()=>Z.unreconciledStatements),G}}),null),a(D,R(Ot,{get title(){return e("banking.unreconciledBooks")},get subtitle(){return e("banking.needAttention")},get children(){var G=Hd();return G.style.setProperty("font-size","1.5rem"),G.style.setProperty("font-weight","600"),G.style.setProperty("color","#f44336"),a(G,()=>Z.unreconciledRecords),G}}),null),m(j,E),M.style.setProperty("margin","0 0 1rem 0"),a(M,()=>e("banking.bankStatements")),a(J,()=>g().map(G=>(()=>{var re=EN(),oe=re.firstChild,fe=oe.firstChild,ae=fe.nextSibling,Y=ae.firstChild,ie=oe.nextSibling,de=ie.firstChild;return re.$$click=()=>x(G),a(fe,()=>G.description),a(ae,()=>P(G.date),Y),a(ae,()=>G.reference,null),a(ae,(()=>{var ue=Ee(()=>!!G.isReconciled);return()=>ue()&&(()=>{var ge=pf();return ge.firstChild,ge.style.setProperty("color","#4caf50"),ge.style.setProperty("margin-left","0.5rem"),a(ge,()=>e("banking.reconciled"),null),ge})()})(),null),a(de,()=>G.debitAmount>0?"+":"-",null),a(de,()=>b(G.debitAmount||G.creditAmount),null),a(ie,(()=>{var ue=Ee(()=>!!G.isReconciled);return()=>ue()&&R(ht,{variant:"outline",size:"sm",onClick:ge=>{ge.stopPropagation(),w(G)},style:{"margin-top":"0.5rem"},get children(){return e("banking.unreconcile")}})})(),null),Se(ue=>{var ge=K(s()?.id===G.id,G.isReconciled),Pe=te,pe=$,_e=C,Le=T(G.debitAmount>0);return ue.e=m(re,ge,ue.e),ue.t=m(oe,Pe,ue.t),ue.a=m(fe,pe,ue.a),ue.o=m(ae,_e,ue.o),ue.i=m(de,Le,ue.i),ue},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),re})())),Q.style.setProperty("margin","0 0 1rem 0"),a(Q,()=>e("banking.entryBookRecords"),null),a(Q,(()=>{var G=Ee(()=>!!(s()&&!s().isReconciled));return()=>G()&&(()=>{var re=TN(),oe=re.firstChild,fe=oe.nextSibling;return fe.nextSibling,re.style.setProperty("font-weight","400"),re.style.setProperty("color","var(--text-muted)"),re.style.setProperty("margin-left","0.5rem"),a(re,()=>e("banking.clickToReconcile"),fe),re})()})(),null),a(se,(()=>{var G=Ee(()=>!!(s()&&!s().isReconciled));return()=>G()?[Ee(()=>Ee(()=>c().length>0)()&&(()=>{var re=kN(),oe=re.firstChild,fe=oe.firstChild;return oe.nextSibling,re.style.setProperty("margin-bottom","1rem"),re.style.setProperty("padding","0.75rem"),re.style.setProperty("background","#fff3cd"),re.style.setProperty("border-radius","var(--border-radius-sm)"),a(oe,()=>e("banking.potentialMatchesFound"),fe),a(re,()=>e("banking.clickRecordToReconcile"),null),re})()),Ee(()=>f().map(re=>(c().includes(re),(()=>{var oe=L0(),fe=oe.firstChild,ae=fe.firstChild,Y=ae.nextSibling,ie=Y.firstChild,de=fe.nextSibling;return oe.$$click=()=>{re.isReconciled||S(re)},a(ae,()=>re.description,null),a(ae,()=>_(re),null),a(Y,()=>P(re.date),ie),a(Y,()=>re.reference,null),a(Y,(()=>{var ue=Ee(()=>!!re.isReconciled);return()=>ue()&&(()=>{var ge=pf();return ge.firstChild,ge.style.setProperty("color","#4caf50"),ge.style.setProperty("margin-left","0.5rem"),a(ge,()=>e("banking.reconciled"),null),ge})()})(),null),a(de,()=>re.debitAmount>0?"+":"-",null),a(de,()=>b(re.debitAmount||re.creditAmount),null),Se(ue=>{var ge={...K(!1,re.isReconciled),opacity:re.isReconciled?.6:1,cursor:re.isReconciled?"not-allowed":"pointer"},Pe=te,pe=$,_e=C,Le=T(re.debitAmount>0);return ue.e=m(oe,ge,ue.e),ue.t=m(fe,Pe,ue.t),ue.a=m(ae,pe,ue.a),ue.o=m(Y,_e,ue.o),ue.i=m(de,Le,ue.i),ue},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),oe})())))]:f().map(re=>(()=>{var oe=L0(),fe=oe.firstChild,ae=fe.firstChild,Y=ae.nextSibling,ie=Y.firstChild,de=fe.nextSibling;return a(ae,()=>re.description),a(Y,()=>P(re.date),ie),a(Y,()=>re.reference,null),a(Y,(()=>{var ue=Ee(()=>!!re.isReconciled);return()=>ue()&&(()=>{var ge=pf();return ge.firstChild,ge.style.setProperty("color","#4caf50"),ge.style.setProperty("margin-left","0.5rem"),a(ge,()=>e("banking.reconciled"),null),ge})()})(),null),a(de,()=>re.debitAmount>0?"+":"-",null),a(de,()=>b(re.debitAmount||re.creditAmount),null),Se(ue=>{var ge=K(!1,re.isReconciled),Pe=te,pe=$,_e=C,Le=T(re.debitAmount>0);return ue.e=m(oe,ge,ue.e),ue.t=m(fe,Pe,ue.t),ue.a=m(ae,pe,ue.a),ue.o=m(Y,_e,ue.o),ue.i=m(de,Le,ue.i),ue},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),oe})())})()),a(k,(()=>{var G=Ee(()=>!!(s()&&!s().isReconciled));return()=>G()&&(()=>{var re=NN(),oe=re.firstChild,fe=oe.firstChild,ae=oe.nextSibling,Y=ae.nextSibling;return re.style.setProperty("position","fixed"),re.style.setProperty("bottom","2rem"),re.style.setProperty("right","2rem"),re.style.setProperty("background","var(--surface-color)"),re.style.setProperty("padding","1rem"),re.style.setProperty("border-radius","var(--border-radius)"),re.style.setProperty("box-shadow","var(--shadow-lg)"),re.style.setProperty("border","1px solid var(--border-color)"),re.style.setProperty("max-width","300px"),oe.style.setProperty("font-weight","500"),oe.style.setProperty("margin-bottom","0.5rem"),a(oe,()=>e("banking.selected"),fe),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("margin-bottom","0.5rem"),a(ae,()=>s().description),Y.style.setProperty("font-weight","600"),Y.style.setProperty("color","var(--primary-color)"),a(Y,()=>b(s().debitAmount||s().creditAmount)),a(re,R(ht,{variant:"secondary",size:"sm",onClick:()=>{l(null),u([])},style:{"margin-top":"0.5rem"},get children(){return e("banking.clearSelection")}}),null),re})()})(),null),Se(G=>{var re=W(h()==="all"),oe=W(h()==="unreconciled"),fe=W(h()==="reconciled"),ae=q,Y=q;return G.e=m(B,re,G.e),G.t=m(ce,oe,G.t),G.a=m(L,fe,G.a),G.o=m(J,ae,G.o),G.i=m(se,Y,G.i),G},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),k})()};br(["click"]);var RN=he("<div><div><h2></h2><p></p></div><div>"),DN=he("<div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date>"),MN=he("<div><button></button><button>"),FN=he("<div><br>"),iu=he("<div>"),ON=he("<div><div></div><div> • </div><div>"),BN=he("<div>: "),jN=he("<div> <!> • <!> "),VN=he("<div>%"),qN=he("<div> of <!> transactions");const zN=()=>{const{t}=or(),[e,r]=Ce(null),[n,i]=Ce({start:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[o,s]=Ce(!1),[l,c]=Ce("overview");gi(()=>{!e()&&qn.bankAccounts.length>0&&r(qn.bankAccounts[0])});const u={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},h={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},y={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},g=ee=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:ee?"var(--primary-color)":"var(--text-muted)","border-bottom":ee?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),f={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},x=ee=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ee),S=ee=>new Date(ee).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),w=()=>qn.bankAccounts.map(ee=>({value:ee.id,label:`${ee.bankName} - ${ee.accountNumber} (${ee.accountType})`})),q=(()=>{if(!e())return null;const ee=qn.getBankStatementsByAccount(e().accountId).filter(te=>te.date>=n().start&&te.date<=n().end),W=qn.getEntryBookRecordsByAccount(e().accountId).filter(te=>te.date>=n().start&&te.date<=n().end),K=ee.filter(te=>te.isReconciled).length;return W.filter(te=>te.isReconciled).length,{totalBankTransactions:ee.length,totalEntryBookRecords:W.length,reconciledTransactions:K,unreconciledTransactions:ee.length-K,reconciliationRate:ee.length>0?K/ee.length*100:0}})();return R(to,{get title(){return t("banking.title")},get children(){return[(()=>{var ee=RN(),W=ee.firstChild,K=W.firstChild,te=K.nextSibling,$=W.nextSibling;return m(ee,u),K.style.setProperty("margin","0 0 0.5rem 0"),K.style.setProperty("font-size","1.5rem"),a(K,()=>t("banking.reconciliation")),te.style.setProperty("margin","0"),te.style.setProperty("color","var(--text-muted)"),a(te,()=>t("banking.compareStatements")),$.style.setProperty("display","flex"),$.style.setProperty("gap","1rem"),a($,R(ht,{variant:"secondary",onClick:()=>s(!0),get disabled(){return!e()},get children(){return t("banking.importCSV")}}),null),a($,R(ht,{variant:"primary",get children(){return t("banking.startNewReconciliation")}}),null),ee})(),(()=>{var ee=DN(),W=ee.firstChild,K=W.firstChild,te=W.nextSibling,$=te.firstChild,C=$.nextSibling,T=te.nextSibling,O=T.firstChild,b=O.nextSibling;return m(ee,h),W.style.setProperty("flex","1"),K.style.setProperty("display","block"),K.style.setProperty("margin-bottom","0.5rem"),K.style.setProperty("font-weight","500"),a(K,()=>t("banking.bankAccount")),a(W,R(Pn,{label:"",get value(){return e()?.id||""},onChange:P=>{const _=qn.getBankAccountById(P);r(_||null)},get options(){return w()}}),null),$.style.setProperty("display","block"),$.style.setProperty("margin-bottom","0.5rem"),$.style.setProperty("font-weight","500"),a($,()=>t("entryBooks.startDate")),C.addEventListener("change",P=>i(_=>({..._,start:P.target.value}))),C.style.setProperty("padding","0.75rem"),C.style.setProperty("border","1px solid var(--border-color)"),C.style.setProperty("border-radius","var(--border-radius-sm)"),C.style.setProperty("font-family","inherit"),O.style.setProperty("display","block"),O.style.setProperty("margin-bottom","0.5rem"),O.style.setProperty("font-weight","500"),a(O,()=>t("entryBooks.endDate")),b.addEventListener("change",P=>i(_=>({..._,end:P.target.value}))),b.style.setProperty("padding","0.75rem"),b.style.setProperty("border","1px solid var(--border-color)"),b.style.setProperty("border-radius","var(--border-radius-sm)"),b.style.setProperty("font-family","inherit"),Se(()=>C.value=n().start),Se(()=>b.value=n().end),ee})(),(()=>{var ee=MN(),W=ee.firstChild,K=W.nextSibling;return m(ee,y),W.$$click=()=>c("overview"),a(W,()=>t("common.overview")),K.$$click=()=>c("reconciliation"),a(K,()=>t("banking.reconciliation")),Se(te=>{var $=g(l()==="overview"),C=g(l()==="reconciliation");return te.e=m(W,$,te.e),te.t=m(K,C,te.t),te},{e:void 0,t:void 0}),ee})(),Ee(()=>Ee(()=>l()==="overview")()&&(()=>{var ee=iu();return a(ee,(()=>{var W=Ee(()=>!!e());return()=>W()&&(()=>{var K=iu();return m(K,f),a(K,R(Ot,{get title(){return t("banking.bankAccountInfo")},get subtitle(){return t("banking.currentAccountDetails")},get children(){return[(()=>{var te=ON(),$=te.firstChild,C=$.nextSibling,T=C.firstChild,O=C.nextSibling;return te.style.setProperty("margin-bottom","1rem"),$.style.setProperty("font-weight","600"),$.style.setProperty("margin-bottom","0.5rem"),a($,()=>e().bankName),C.style.setProperty("color","var(--text-muted)"),C.style.setProperty("margin-bottom","0.5rem"),a(C,()=>e().accountNumber,T),a(C,()=>e().accountType,null),O.style.setProperty("font-size","1.25rem"),O.style.setProperty("font-weight","600"),O.style.setProperty("color","var(--primary-color)"),a(O,()=>x(e().currentBalance)),te})(),Ee(()=>Ee(()=>!!e().lastReconciledDate)()&&(()=>{var te=BN(),$=te.firstChild;return te.style.setProperty("font-size","0.875rem"),te.style.setProperty("color","var(--text-muted)"),a(te,()=>t("banking.lastReconciled"),$),a(te,()=>S(e().lastReconciledDate),null),te})())]}}),null),a(K,q&&[R(Ot,{get title(){return t("banking.bankTransactions")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var te=iu();return te.style.setProperty("font-size","1.5rem"),te.style.setProperty("font-weight","600"),te.style.setProperty("color","var(--primary-color)"),te.style.setProperty("margin-bottom","0.5rem"),a(te,()=>q.totalBankTransactions),te})(),(()=>{var te=jN(),$=te.firstChild,C=$.nextSibling,T=C.nextSibling,O=T.nextSibling;return O.nextSibling,te.style.setProperty("font-size","0.875rem"),te.style.setProperty("color","var(--text-muted)"),a(te,()=>q.reconciledTransactions,$),a(te,()=>t("banking.reconciled"),C),a(te,()=>q.unreconciledTransactions,O),a(te,()=>t("banking.pending"),null),te})()]}}),R(Ot,{get title(){return t("entryBooks.entryBookRecords")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var te=iu();return te.style.setProperty("font-size","1.5rem"),te.style.setProperty("font-weight","600"),te.style.setProperty("color","var(--primary-color)"),te.style.setProperty("margin-bottom","0.5rem"),a(te,()=>q.totalEntryBookRecords),te})(),(()=>{var te=iu();return te.style.setProperty("font-size","0.875rem"),te.style.setProperty("color","var(--text-muted)"),a(te,()=>t("banking.bookEntriesForComparison")),te})()]}}),R(Ot,{get title(){return t("banking.reconciliationRate")},get subtitle(){return t("banking.completionStatus")},get children(){return[(()=>{var te=VN(),$=te.firstChild;return te.style.setProperty("font-size","1.5rem"),te.style.setProperty("font-weight","600"),te.style.setProperty("margin-bottom","0.5rem"),a(te,()=>Math.round(q.reconciliationRate),$),Se(C=>(C=q.reconciliationRate>80?"#4caf50":q.reconciliationRate>50?"#ff9800":"#f44336")!=null?te.style.setProperty("color",C):te.style.removeProperty("color")),te})(),(()=>{var te=qN(),$=te.firstChild,C=$.nextSibling;return C.nextSibling,te.style.setProperty("font-size","0.875rem"),te.style.setProperty("color","var(--text-muted)"),a(te,()=>q.reconciledTransactions,$),a(te,()=>q.totalBankTransactions,C),te})()]}})],null),K})()})(),null),a(ee,R(Ot,{get title(){return t("banking.recentReconciliationSessions")},get subtitle(){return t("banking.latestActivity")},get children(){var W=FN(),K=W.firstChild;return W.style.setProperty("text-align","center"),W.style.setProperty("color","var(--text-muted)"),W.style.setProperty("padding","2rem"),a(W,()=>t("banking.noRecentSessions"),K),a(W,R(ht,{variant:"primary",style:{"margin-top":"1rem"},onClick:()=>c("reconciliation"),get children(){return t("banking.startFirstReconciliation")}}),null),W}}),null),ee})()),Ee(()=>Ee(()=>!!(l()==="reconciliation"&&e()))()&&R(LN,{get bankAccountId(){return e().id},get selectedPeriod(){return n()}})),R(IN,{get isOpen(){return o()},onClose:()=>s(!1),get bankAccount(){return e()}})]}})};br(["click"]);br(["input","click"]);var UN=he("<h2>Upload Bank Statement CSV"),HN=he("<input type=file accept=.csv>"),GN=he("<h3>Filters"),WN=he('<div><input type=text placeholder="Search transactions..."><input type=date placeholder="Start Date"><input type=date placeholder="End Date"><button>Download Detailed Report'),YN=he("<div><button>Summary</button><button>Deposits</button><button>Payments</button><button>Timeline"),KN=he("<h3>Total Deposits"),Gd=he("<p>"),R0=he("<p> transactions"),JN=he("<h3>Total Payments"),QN=he("<h3>Net Cash Flow"),XN=he("<h3>Check Payments"),ZN=he("<p> checks"),ou=he("<div>"),e6=he("<h3>Accounts & Payment Methods Used"),t6=he("<h3>Monthly Cash Flow Trend"),r6=he("<div><table><thead><tr><th>Month</th><th>Deposits</th><th>Payments</th><th>Net</th></tr></thead><tbody>"),n6=he("<h2>Deposits by Type"),i6=he("<h2>Top Depositors"),o6=he("<div><table><thead><tr><th>Depositor</th><th>Total Amount</th><th>Count</th><th>Actions</th></tr></thead><tbody>"),s6=he("<h2>Payments by Category"),a6=he("<h2>Top Payees"),l6=he("<div><table><thead><tr><th>Payee</th><th>Category</th><th>Total Amount</th><th>Count</th></tr></thead><tbody>"),c6=he("<h2>Transaction Timeline"),u6=he("<div><h1>Detailed Bank Statement Analyzer"),d6=he("<span>"),h6=he("<tr><td></td><td></td><td></td><td>"),D0=he("<div><h4></h4><p></p><p> transactions"),p6=he("<tr><td></td><td></td><td></td><td><details><summary>View</summary><div>"),f6=he("<div> - "),m6=he("<tr><td></td><td><span></span></td><td></td><td>"),y6=he("<div><div><div></div><div> • </div></div><div><div>");const g6=()=>{const[t,e]=Ce(""),[r,n]=Ce("summary"),[i,o]=Ce(""),[s,l]=Ce({start:"",end:""}),[c,u]=Yu({list:[]}),h={Utilities:["AT&T","METRO BY T-MOBILE","COMCAST","STREAM ENERGY","NETFLIX","SPECTRUM"],checks:["CHECK"],JPM:["JPM","POVBR"],Transportation:["DRIVE AWAY","TRANPORT","QUICKQUACK","EXXON","SHELL","CHEVRON","UBER","LYFT","U-HAUL","UHAL","LOVE'S"],Lodging:["HOLIDAY INN","MARRIOTT","HILTON","AIRBNB","HOTEL","MOTEL"],"Food & Dining":["GOLDEN CORRAL","MOCTEZUMA","CHINA STAR","RESTAURANT","CAFE","STARBUCKS","BUFFET","GRILL","MARKET","SEAFOOD"],Shopping:["BURLINGTON","WALMART","TARGET","AMAZON","ROSS","KROGER","PUBLIC","AMZN","AMZ"],Financial:["AMERICANFIRSTFIN","LOAN","CREDIT"],Insurance:["INSURANCE","GEICO","STATE FARM"],Rent:["SHAFAII INVESTME"],Medical:["PHARMACY","CVS","WALGREENS","HOSPITAL","CLINIC"],Entertainment:["CINEMA","THEATER","CONCERT"],"Other Services":["BARBER","SALON","SPA","GYM"],Return:["RETURN ITEM "]},y=W=>{const K=W.toUpperCase();for(const[te,$]of Object.entries(h))for(const C of $)if(K.includes(C.toUpperCase()))return te;return"Other"},g=W=>{const K=W.match(/Zelle payment from ([^0-9]+)/i);if(K)return K[1].trim().replace(/[A-Z0-9]{10,}$/,"").trim();if(W.includes("CHECK"))return"Check Payment";const te=W.match(/^([^0-9]+)/);return te?te[1].trim():W.substring(0,30)},f=W=>{const K=W.trim().split(`
`),te=[];console.log(K);for(let $=1;$<K.length;$++){const C=K[$].split(",");if(console.log(C),C.length>=3){const T=parseFloat(C[2]);let O={postingDate:C[0],description:C[1],amount:T};te.push(O)}}return console.log({transactions:te}),u("list",te),te};Mt(()=>t()?f(t()):[]);const x=Mt(()=>{let W=c?.list;if((s().start||s().end)&&(W=W.filter(K=>{const te=new Date(K.postingDate),$=s().start?new Date(s().start):new Date("2024-01-01"),C=s().end?new Date(s().end):new Date("2024-12-31");return te>=$&&te<=C})),i()){const K=i().toLowerCase();W=W.filter(te=>te.description.toLowerCase().includes(K)||Math.abs(te.amount).toString().includes(K))}return W}),S=Mt(()=>{const W={deposits:{total:0,count:0,byType:new Map,byPayee:new Map},payments:{total:0,count:0,byType:new Map,byPayee:new Map},checks:{total:0,count:0,transactions:[]},transfers:{total:0,count:0,transactions:[]},dailyBalances:new Map,accountsAffected:new Set};return x().forEach(K=>{const te=g(K.description);if(console.log({transaction:K}),W.dailyBalances.set(K.postingDate,K.amount),(K.description.includes("ZELLE")||K.description.includes("QUICKPAY"))&&W.accountsAffected.add("Zelle Account"),K.description.includes("ACH")&&W.accountsAffected.add("ACH Network"),K?.description.includes("DEBIT_CARD")&&W.accountsAffected.add("Debit Card"),K?.description.includes("CHECK")&&W.accountsAffected.add("Checking Account"),K?.description.includes("TRANSFER")&&W.accountsAffected.add("Savings Account"),K.amount>0){W.deposits.total+=K.amount,W.deposits.count++,W.deposits.byType.has(K.description)||W.deposits.byType.set(K.description,{total:0,count:0,transactions:[]});const $=W.deposits.byType.get(K.description);$.total+=K.amount,$.count++,$.transactions.push(K),W.deposits.byPayee.has(te)||W.deposits.byPayee.set(te,{name:te,totalAmount:0,transactionCount:0,transactions:[]});const C=W.deposits.byPayee.get(te);C.totalAmount+=K.amount,C.transactionCount++,C.transactions.push(K)}if(K.amount<0){W.payments.total+=Math.abs(K.amount),W.payments.count++,W.payments.byType.has(K.description)||W.payments.byType.set(K.description,{total:0,count:0,transactions:[]});const $=W.payments.byType.get(K.description);$.total+=Math.abs(K.amount),$.count++,$.transactions.push(K);const C=y(K.description);W.payments.byPayee.has(te)||W.payments.byPayee.set(te,{name:te,totalAmount:0,transactionCount:0,transactions:[],category:C});const T=W.payments.byPayee.get(te);T.totalAmount+=Math.abs(K.amount),T.transactionCount++,T.transactions.push(K)}(K.type==="CHECK_PAID"||K.checkNumber)&&(W.checks.total+=Math.abs(K.amount),W.checks.count++,W.checks.transactions.push(K)),(K.description.includes("TRANSFER")||K.description==="ACCT_XFER")&&(W.transfers.total+=Math.abs(K.amount),W.transfers.count++,W.transfers.transactions.push(K))}),console.log(W),W}),w=Mt(()=>{const W=new Map;return x().forEach(K=>{const te=K.postingDate.substring(0,7);W.has(te)||W.set(te,{deposits:0,payments:0,net:0});const $=W.get(te);K.amount>0?$.deposits+=K.amount:$.payments+=Math.abs(K.amount),$.net=$.deposits-$.payments}),Array.from(W.entries()).sort((K,te)=>K[0].localeCompare(te[0]))}),E=W=>{const te=W.target.files?.[0];if(te){const $=new FileReader;$.onload=C=>{console.log(C.target?.result),f(C.target?.result)},$.readAsText(te)}},q=()=>{const W=S();let K=`# DETAILED BANK STATEMENT ANALYSIS
`;K+=`Generated: ${new Date().toLocaleDateString()}

`,K+=`## EXECUTIVE SUMMARY

`,K+=`- **Total Deposits:** $${W.deposits.total.toFixed(2)} (${W.deposits.count} transactions)
`,K+=`- **Total Payments:** $${W.payments.total.toFixed(2)} (${W.payments.count} transactions)
`,K+=`- **Net Cash Flow:** $${(W.deposits.total-W.payments.total).toFixed(2)}
`,K+=`- **Check Payments:** $${W.checks.total.toFixed(2)} (${W.checks.count} checks)
`,K+=`- **Transfers:** $${W.transfers.total.toFixed(2)} (${W.transfers.count} transfers)

`,K+=`## ACCOUNTS AFFECTED

`,W.accountsAffected.forEach(P=>{K+=`- ${P}
`}),K+=`
`,K+=`## DEPOSITS DETAIL

`,K+=`### By Type
`,W.deposits.byType.forEach((P,_)=>{K+=`- **${_}**: $${P.total.toFixed(2)} (${P.count} transactions)
`}),K+=`
### Top Depositors
`,Array.from(W.deposits.byPayee.entries()).sort((P,_)=>_[1].totalAmount-P[1].totalAmount).slice(0,20).forEach(([P,_])=>{K+=`- **${P}**: $${_.totalAmount.toFixed(2)} (${_.transactionCount} transactions)
`}),K+=`
## PAYMENTS DETAIL

`,K+=`### By Type
`,W.payments.byType.forEach((P,_)=>{K+=`- **${_}**: $${P.total.toFixed(2)} (${P.count} transactions)
`}),K+=`
### By Category
`;const $=new Map;W.payments.byPayee.forEach(P=>{const _=P.category||"Other";$.set(_,($.get(_)||0)+P.totalAmount)}),Array.from($.entries()).sort((P,_)=>_[1]-P[1]).forEach(([P,_])=>{K+=`- **${P}**: $${_.toFixed(2)}
`}),K+=`
### Top Payees
`,Array.from(W.payments.byPayee.entries()).sort((P,_)=>_[1].totalAmount-P[1].totalAmount).slice(0,20).forEach(([P,_])=>{K+=`- **${P}** (${_.category}): $${_.totalAmount.toFixed(2)} (${_.transactionCount} transactions)
`}),K+=`
## MONTHLY CASH FLOW TREND

`,w().forEach(([P,_])=>{K+=`- **${P}**: Deposits: $${_.deposits.toFixed(2)} | Payments: $${_.payments.toFixed(2)} | Net: $${_.net.toFixed(2)}
`}),W.checks.transactions.length>0&&(K+=`
## CHECK PAYMENTS DETAIL

`,W.checks.transactions.forEach(P=>{K+=`- Check #${P.checkNumber||"N/A"} - ${P.postingDate} - $${Math.abs(P.amount).toFixed(2)}
`}));const T=new Blob([K],{type:"text/markdown"}),O=URL.createObjectURL(T),b=document.createElement("a");b.href=O,b.download=`detailed_bank_analysis_${new Date().toISOString().split("T")[0]}.md`,b.click(),URL.revokeObjectURL(O)},ee=W=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(W);return(()=>{var W=u6(),K=W.firstChild;return W.style.setProperty("padding","2rem"),K.style.setProperty("margin-bottom","2rem"),a(W,R(Ot,{style:{"margin-bottom":"2rem"},get children(){return[UN(),(()=>{var te=HN();return te.addEventListener("change",E),te.style.setProperty("margin-top","1rem"),te})()]}}),null),a(W,R(ze,{get when(){return c?.list},get children(){return[R(Ot,{style:{"margin-bottom":"2rem"},get children(){return[GN(),(()=>{var te=WN(),$=te.firstChild,C=$.nextSibling,T=C.nextSibling,O=T.nextSibling;return te.style.setProperty("display","flex"),te.style.setProperty("gap","1rem"),te.style.setProperty("margin-top","1rem"),te.style.setProperty("flex-wrap","wrap"),$.$$input=b=>o(b.currentTarget.value),$.style.setProperty("flex","1"),$.style.setProperty("min-width","200px"),$.style.setProperty("padding","0.5rem"),C.$$input=b=>l({...s(),start:b.currentTarget.value}),T.$$input=b=>l({...s(),end:b.currentTarget.value}),O.$$click=q,O.style.setProperty("padding","0.5rem 1rem"),O.style.setProperty("background","var(--primary-color)"),O.style.setProperty("color","white"),O.style.setProperty("border","none"),O.style.setProperty("border-radius","var(--border-radius-sm)"),O.style.setProperty("cursor","pointer"),Se(()=>$.value=i()),Se(()=>C.value=s().start),Se(()=>T.value=s().end),te})()]}}),(()=>{var te=YN(),$=te.firstChild,C=$.nextSibling,T=C.nextSibling,O=T.nextSibling;return te.style.setProperty("display","flex"),te.style.setProperty("gap","1rem"),te.style.setProperty("margin-bottom","2rem"),$.$$click=()=>n("summary"),$.style.setProperty("padding","0.5rem 1rem"),$.style.setProperty("border","none"),$.style.setProperty("border-radius","var(--border-radius-sm)"),$.style.setProperty("cursor","pointer"),C.$$click=()=>n("deposits"),C.style.setProperty("padding","0.5rem 1rem"),C.style.setProperty("border","none"),C.style.setProperty("border-radius","var(--border-radius-sm)"),C.style.setProperty("cursor","pointer"),T.$$click=()=>n("payments"),T.style.setProperty("padding","0.5rem 1rem"),T.style.setProperty("border","none"),T.style.setProperty("border-radius","var(--border-radius-sm)"),T.style.setProperty("cursor","pointer"),O.$$click=()=>n("timeline"),O.style.setProperty("padding","0.5rem 1rem"),O.style.setProperty("border","none"),O.style.setProperty("border-radius","var(--border-radius-sm)"),O.style.setProperty("cursor","pointer"),Se(b=>{var P=r()==="summary"?"var(--primary-color)":"#e9ecef",_=r()==="summary"?"white":"black",z=r()==="deposits"?"var(--primary-color)":"#e9ecef",Z=r()==="deposits"?"white":"black",k=r()==="payments"?"var(--primary-color)":"#e9ecef",F=r()==="payments"?"white":"black",X=r()==="timeline"?"var(--primary-color)":"#e9ecef",U=r()==="timeline"?"white":"black";return P!==b.e&&((b.e=P)!=null?$.style.setProperty("background",P):$.style.removeProperty("background")),_!==b.t&&((b.t=_)!=null?$.style.setProperty("color",_):$.style.removeProperty("color")),z!==b.a&&((b.a=z)!=null?C.style.setProperty("background",z):C.style.removeProperty("background")),Z!==b.o&&((b.o=Z)!=null?C.style.setProperty("color",Z):C.style.removeProperty("color")),k!==b.i&&((b.i=k)!=null?T.style.setProperty("background",k):T.style.removeProperty("background")),F!==b.n&&((b.n=F)!=null?T.style.setProperty("color",F):T.style.removeProperty("color")),X!==b.s&&((b.s=X)!=null?O.style.setProperty("background",X):O.style.removeProperty("background")),U!==b.h&&((b.h=U)!=null?O.style.setProperty("color",U):O.style.removeProperty("color")),b},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),te})(),R(ze,{get when(){return r()==="summary"},get children(){return[(()=>{var te=ou();return te.style.setProperty("display","grid"),te.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),te.style.setProperty("gap","1rem"),te.style.setProperty("margin-bottom","2rem"),a(te,R(Ot,{get children(){return[KN(),(()=>{var $=Gd();return $.style.setProperty("font-size","2rem"),$.style.setProperty("font-weight","bold"),$.style.setProperty("color","#22c55e"),a($,()=>ee(S().deposits.total)),$})(),(()=>{var $=R0(),C=$.firstChild;return $.style.setProperty("color","#6c757d"),a($,()=>S().deposits.count,C),$})()]}}),null),a(te,R(Ot,{get children(){return[JN(),(()=>{var $=Gd();return $.style.setProperty("font-size","2rem"),$.style.setProperty("font-weight","bold"),$.style.setProperty("color","#ef4444"),a($,()=>ee(S().payments.total)),$})(),(()=>{var $=R0(),C=$.firstChild;return $.style.setProperty("color","#6c757d"),a($,()=>S().payments.count,C),$})()]}}),null),a(te,R(Ot,{get children(){return[QN(),(()=>{var $=Gd();return $.style.setProperty("font-size","2rem"),$.style.setProperty("font-weight","bold"),a($,()=>ee(S().deposits.total-S().payments.total)),Se(C=>(C=S().deposits.total-S().payments.total>=0?"#22c55e":"#ef4444")!=null?$.style.setProperty("color",C):$.style.removeProperty("color")),$})()]}}),null),a(te,R(Ot,{get children(){return[XN(),(()=>{var $=Gd();return $.style.setProperty("font-size","2rem"),$.style.setProperty("font-weight","bold"),$.style.setProperty("color","#3b82f6"),a($,()=>ee(S().checks.total)),$})(),(()=>{var $=ZN(),C=$.firstChild;return $.style.setProperty("color","#6c757d"),a($,()=>S().checks.count,C),$})()]}}),null),te})(),R(Ot,{style:{"margin-bottom":"2rem"},get children(){return[e6(),(()=>{var te=ou();return te.style.setProperty("display","flex"),te.style.setProperty("flex-wrap","wrap"),te.style.setProperty("gap","0.5rem"),te.style.setProperty("margin-top","1rem"),a(te,R(Ut,{get each(){return Array.from(S().accountsAffected)},children:$=>(()=>{var C=d6();return C.style.setProperty("padding","0.25rem 0.75rem"),C.style.setProperty("background","#e9ecef"),C.style.setProperty("border-radius","9999px"),C.style.setProperty("font-size","0.875rem"),a(C,$),C})()})),te})()]}}),R(Ot,{get children(){return[t6(),(()=>{var te=r6(),$=te.firstChild,C=$.firstChild,T=C.firstChild,O=T.firstChild,b=O.nextSibling,P=b.nextSibling,_=P.nextSibling,z=C.nextSibling;return te.style.setProperty("overflow-x","auto"),$.style.setProperty("width","100%"),$.style.setProperty("border-collapse","collapse"),$.style.setProperty("margin-top","1rem"),T.style.setProperty("border-bottom","2px solid #dee2e6"),O.style.setProperty("padding","0.75rem"),O.style.setProperty("text-align","left"),b.style.setProperty("padding","0.75rem"),b.style.setProperty("text-align","right"),P.style.setProperty("padding","0.75rem"),P.style.setProperty("text-align","right"),_.style.setProperty("padding","0.75rem"),_.style.setProperty("text-align","right"),a(z,R(Ut,{get each(){return w()},children:([Z,k])=>(()=>{var F=h6(),X=F.firstChild,U=X.nextSibling,B=U.nextSibling,ce=B.nextSibling;return F.style.setProperty("border-bottom","1px solid #dee2e6"),X.style.setProperty("padding","0.75rem"),a(X,Z),U.style.setProperty("padding","0.75rem"),U.style.setProperty("text-align","right"),U.style.setProperty("color","#22c55e"),a(U,()=>ee(isNaN(k.deposits)?0:k.deposits)),B.style.setProperty("padding","0.75rem"),B.style.setProperty("text-align","right"),B.style.setProperty("color","#ef4444"),a(B,()=>ee(isNaN(k.payments)?0:k.payments)),ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("text-align","right"),ce.style.setProperty("font-weight","bold"),a(ce,()=>ee(k.net)),Se(L=>(L=k.net>=0?"#22c55e":"#ef4444")!=null?ce.style.setProperty("color",L):ce.style.removeProperty("color")),F})()})),te})()]}})]}}),R(ze,{get when(){return r()==="deposits"},get children(){return[R(Ot,{style:{"margin-bottom":"2rem"},get children(){return[n6(),(()=>{var te=ou();return te.style.setProperty("display","grid"),te.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(300px, 1fr))"),te.style.setProperty("gap","1rem"),te.style.setProperty("margin-top","1rem"),a(te,R(Ut,{get each(){return Array.from(S().deposits.byType.entries())},children:([$,C])=>(()=>{var T=D0(),O=T.firstChild,b=O.nextSibling,P=b.nextSibling,_=P.firstChild;return T.style.setProperty("padding","1rem"),T.style.setProperty("background","#f8f9fa"),T.style.setProperty("border-radius","var(--border-radius-sm)"),T.style.setProperty("border","1px solid #e9ecef"),a(O,$),b.style.setProperty("font-size","1.5rem"),b.style.setProperty("font-weight","bold"),b.style.setProperty("color","#22c55e"),a(b,()=>ee(C.total)),P.style.setProperty("color","#6c757d"),a(P,()=>C.count,_),T})()})),te})()]}}),R(Ot,{get children(){return[i6(),(()=>{var te=o6(),$=te.firstChild,C=$.firstChild,T=C.firstChild,O=T.firstChild,b=O.nextSibling,P=b.nextSibling,_=P.nextSibling,z=C.nextSibling;return te.style.setProperty("overflow-x","auto"),$.style.setProperty("width","100%"),$.style.setProperty("border-collapse","collapse"),$.style.setProperty("margin-top","1rem"),T.style.setProperty("border-bottom","2px solid #dee2e6"),O.style.setProperty("padding","0.75rem"),O.style.setProperty("text-align","left"),b.style.setProperty("padding","0.75rem"),b.style.setProperty("text-align","right"),P.style.setProperty("padding","0.75rem"),P.style.setProperty("text-align","center"),_.style.setProperty("padding","0.75rem"),_.style.setProperty("text-align","center"),a(z,R(Ut,{get each(){return Array.from(S().deposits.byPayee.entries()).sort((Z,k)=>k[1].totalAmount-Z[1].totalAmount).slice(0,20)},children:([Z,k])=>(()=>{var F=p6(),X=F.firstChild,U=X.nextSibling,B=U.nextSibling,ce=B.nextSibling,L=ce.firstChild,D=L.firstChild,j=D.nextSibling;return F.style.setProperty("border-bottom","1px solid #dee2e6"),X.style.setProperty("padding","0.75rem"),a(X,Z),U.style.setProperty("padding","0.75rem"),U.style.setProperty("text-align","right"),U.style.setProperty("color","#22c55e"),U.style.setProperty("font-weight","bold"),a(U,()=>ee(k.totalAmount)),B.style.setProperty("padding","0.75rem"),B.style.setProperty("text-align","center"),a(B,()=>k.transactionCount),ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("text-align","center"),D.style.setProperty("cursor","pointer"),j.style.setProperty("margin-top","0.5rem"),j.style.setProperty("font-size","0.875rem"),a(j,R(Ut,{get each(){return k.transactions.slice(0,5)},children:I=>(()=>{var M=f6(),J=M.firstChild;return M.style.setProperty("padding","0.25rem"),a(M,()=>I.postingDate,J),a(M,()=>ee(I.amount),null),M})()})),F})()})),te})()]}})]}}),R(ze,{get when(){return r()==="payments"},get children(){return[R(Ot,{style:{"margin-bottom":"2rem"},get children(){return[s6(),(()=>{var te=ou();return te.style.setProperty("display","grid"),te.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),te.style.setProperty("gap","1rem"),te.style.setProperty("margin-top","1rem"),a(te,()=>{const $=new Map;return S().payments.byPayee.forEach(C=>{const T=C.category||"Other";$.has(T)||$.set(T,{total:0,count:0});const O=$.get(T);O.total+=C.totalAmount,O.count+=C.transactionCount}),Array.from($.entries()).sort((C,T)=>T[1].total-C[1].total).map(([C,T])=>(()=>{var O=D0(),b=O.firstChild,P=b.nextSibling,_=P.nextSibling,z=_.firstChild;return O.style.setProperty("padding","1rem"),O.style.setProperty("background","#f8f9fa"),O.style.setProperty("border-radius","var(--border-radius-sm)"),O.style.setProperty("border","1px solid #e9ecef"),a(b,C),P.style.setProperty("font-size","1.5rem"),P.style.setProperty("font-weight","bold"),P.style.setProperty("color","#ef4444"),a(P,()=>ee(T.total)),_.style.setProperty("color","#6c757d"),a(_,()=>T.count,z),O})())}),te})()]}}),R(Ot,{get children(){return[a6(),(()=>{var te=l6(),$=te.firstChild,C=$.firstChild,T=C.firstChild,O=T.firstChild,b=O.nextSibling,P=b.nextSibling,_=P.nextSibling,z=C.nextSibling;return te.style.setProperty("overflow-x","auto"),$.style.setProperty("width","100%"),$.style.setProperty("border-collapse","collapse"),$.style.setProperty("margin-top","1rem"),T.style.setProperty("border-bottom","2px solid #dee2e6"),O.style.setProperty("padding","0.75rem"),O.style.setProperty("text-align","left"),b.style.setProperty("padding","0.75rem"),b.style.setProperty("text-align","left"),P.style.setProperty("padding","0.75rem"),P.style.setProperty("text-align","right"),_.style.setProperty("padding","0.75rem"),_.style.setProperty("text-align","center"),a(z,R(Ut,{get each(){return Array.from(S().payments.byPayee.entries()).sort((Z,k)=>k[1].totalAmount-Z[1].totalAmount).slice(0,130)},children:([Z,k])=>(()=>{var F=m6(),X=F.firstChild,U=X.nextSibling,B=U.firstChild,ce=U.nextSibling,L=ce.nextSibling;return F.style.setProperty("border-bottom","1px solid #dee2e6"),X.style.setProperty("padding","0.75rem"),a(X,Z),U.style.setProperty("padding","0.75rem"),B.style.setProperty("padding","0.25rem 0.5rem"),B.style.setProperty("background","#e9ecef"),B.style.setProperty("border-radius","4px"),B.style.setProperty("font-size","0.875rem"),a(B,()=>k.category),ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("text-align","right"),ce.style.setProperty("color","#ef4444"),ce.style.setProperty("font-weight","bold"),a(ce,()=>ee(k.totalAmount)),L.style.setProperty("padding","0.75rem"),L.style.setProperty("text-align","center"),a(L,()=>k.transactionCount),F})()})),te})()]}})]}}),R(ze,{get when(){return r()==="timeline"},get children(){return R(Ot,{get children(){return[c6(),(()=>{var te=ou();return te.style.setProperty("max-height","600px"),te.style.setProperty("overflow-y","auto"),te.style.setProperty("margin-top","1rem"),a(te,R(Ut,{get each(){return x().slice(0,100)},children:$=>(()=>{var C=y6(),T=C.firstChild,O=T.firstChild,b=O.nextSibling,P=b.firstChild,_=T.nextSibling,z=_.firstChild;return C.style.setProperty("padding","1rem"),C.style.setProperty("border-bottom","1px solid #e9ecef"),C.style.setProperty("display","flex"),C.style.setProperty("justify-content","space-between"),C.style.setProperty("align-items","center"),T.style.setProperty("flex","1"),O.style.setProperty("font-weight","bold"),a(O,()=>$.description),b.style.setProperty("font-size","0.875rem"),b.style.setProperty("color","#6c757d"),a(b,()=>$.postingDate,P),a(b,()=>$.type,null),a(b,()=>$.checkNumber&&` • Check #${$.checkNumber}`,null),_.style.setProperty("text-align","right"),z.style.setProperty("font-weight","bold"),z.style.setProperty("font-size","1.1rem"),a(z,()=>ee(Math.abs($.amount)),null),a(z,()=>$.amount>=0?" ↓":" ↑",null),Se(Z=>(Z=$.amount>=0?"#22c55e":"#ef4444")!=null?z.style.setProperty("color",Z):z.style.removeProperty("color")),C})()})),te})()]}})}})]}}),null),W})()};br(["input","click"]);var v6=he("<div><div></div><div>"),ff=he("<div>"),b6=he("<div> • <!> • <!> "),_6=he("<div><div><div></div><div></div></div><div><div></div><div>"),S6=he("<div><div>:"),P6=he("<div>⚠️ <!>: <!> <!>, <!> "),w6=he("<div><div><div></div><div></div></div><div>"),M0=he("<div> "),x6=he("<div>✓ ");const A6=t=>{const{t:e}=or(),r={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},n={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},i={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},o={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)","margin-bottom":"0.5rem"},s={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"1rem"},l={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},c={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},u={"max-height":"100px","overflow-y":"auto","border-top":"1px solid var(--border-color)","padding-top":"1rem"},h={display:"flex","justify-content":"space-between","align-items":"center","font-size":"0.875rem","margin-bottom":"0.5rem"},y={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},g=E=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[E],f=E=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(E),x=E=>new Date(E).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),S=g(t.entry.status),w=Math.abs(t.entry.totalDebit-t.entry.totalCredit)<.01;return R(Ot,{get children(){return[(()=>{var E=v6(),q=E.firstChild,ee=q.nextSibling;return m(E,r),m(q,n),a(q,()=>t.entry.entryNumber),a(ee,()=>e(`journal.${t.entry.status}`,t.entry.status)),Se(W=>m(ee,{...i,background:S.bg,color:S.color},W)),E})(),(()=>{var E=ff();return m(E,o),a(E,()=>t.entry.description),E})(),(()=>{var E=b6(),q=E.firstChild,ee=q.nextSibling,W=ee.nextSibling,K=W.nextSibling;return K.nextSibling,m(E,s),a(E,()=>x(t.entry.date),q),a(E,()=>t.entry.reference||e("journal.noReference","No reference"),ee),a(E,()=>e("journal.createdBy","By"),K),a(E,()=>t.entry.createdBy,null),E})(),(()=>{var E=_6(),q=E.firstChild,ee=q.firstChild,W=ee.nextSibling,K=q.nextSibling,te=K.firstChild,$=te.nextSibling;return m(E,l),ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-muted)"),a(ee,()=>e("journal.totalAmount","Total Amount")),m(W,c),a(W,()=>f(t.entry.totalDebit)),K.style.setProperty("text-align","right"),te.style.setProperty("font-size","0.875rem"),te.style.setProperty("color","var(--text-muted)"),a(te,()=>e("journal.lines","Lines")),$.style.setProperty("font-weight","600"),a($,()=>t.entry.lines.length),E})(),Ee(()=>!w&&(()=>{var E=P6(),q=E.firstChild,ee=q.nextSibling,W=ee.nextSibling,K=W.nextSibling,te=K.nextSibling,$=te.nextSibling,C=$.nextSibling,T=C.nextSibling;return T.nextSibling,E.style.setProperty("padding","0.5rem"),E.style.setProperty("border-radius","var(--border-radius-sm)"),E.style.setProperty("background","#f8d7da"),E.style.setProperty("color","#721c24"),E.style.setProperty("font-size","0.875rem"),E.style.setProperty("margin-bottom","1rem"),a(E,()=>e("journal.entryNotBalancedShort","Entry is not balanced"),ee),a(E,()=>e("journal.debit"),K),a(E,()=>f(t.entry.totalDebit),$),a(E,()=>e("journal.credit"),T),a(E,()=>f(t.entry.totalCredit),null),E})()),(()=>{var E=S6(),q=E.firstChild,ee=q.firstChild;return m(E,u),q.style.setProperty("font-weight","500"),q.style.setProperty("margin-bottom","0.5rem"),q.style.setProperty("font-size","0.875rem"),a(q,()=>e("journal.accountLines","Account Lines"),ee),a(E,()=>t.entry.lines.slice(0,3).map(W=>(()=>{var K=w6(),te=K.firstChild,$=te.firstChild,C=$.nextSibling,T=te.nextSibling;return m(K,h),te.style.setProperty("flex","1"),$.style.setProperty("font-weight","500"),a($,()=>W.accountName),C.style.setProperty("font-size","0.75rem"),C.style.setProperty("color","var(--text-muted)"),a(C,()=>W.description||e("journal.noDescription","No description")),T.style.setProperty("text-align","right"),a(T,(()=>{var O=Ee(()=>W.debitAmount>0);return()=>O()&&(()=>{var b=M0(),P=b.firstChild;return b.style.setProperty("color","#4caf50"),b.style.setProperty("font-weight","500"),a(b,()=>e("journal.debitShort","Dr."),P),a(b,()=>f(W.debitAmount),null),b})()})(),null),a(T,(()=>{var O=Ee(()=>W.creditAmount>0);return()=>O()&&(()=>{var b=M0(),P=b.firstChild;return b.style.setProperty("color","#f44336"),b.style.setProperty("font-weight","500"),a(b,()=>e("journal.creditShort","Cr."),P),a(b,()=>f(W.creditAmount),null),b})()})(),null),a(T,(()=>{var O=Ee(()=>!!W.reconciled);return()=>O()&&(()=>{var b=x6();return b.firstChild,b.style.setProperty("font-size","0.75rem"),b.style.setProperty("color","#4caf50"),a(b,()=>e("banking.reconciled","Reconciled"),null),b})()})(),null),K})()),null),a(E,(()=>{var W=Ee(()=>t.entry.lines.length>3);return()=>W()&&(()=>{var K=ff();return K.style.setProperty("text-align","center"),K.style.setProperty("color","var(--text-muted)"),K.style.setProperty("font-size","0.875rem"),a(K,()=>e("journal.andMoreLines","... and {count} more lines").replace("{count}",(t.entry.lines.length-3).toString())),K})()})(),null),E})(),(()=>{var E=ff();return m(E,y),a(E,R(ht,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.entry),get children(){return e("journal.viewDetails","View Details")}})),E})()]}})},C6=[{id:"je1",entryNumber:"JE-2024-001",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",status:"posted",createdBy:"John Doe",createdAt:"2024-01-15T09:00:00Z",postedAt:"2024-01-15T09:05:00Z",totalDebit:5e3,totalCredit:5e3,lines:[{id:"jel1",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment from ABC Corp",debitAmount:5e3,creditAmount:0,reconciled:!0,reconciledWith:"eb1"},{id:"jel2",accountId:"2001",accountName:"Trade Receivables",description:"Payment received for INV-2024-001",debitAmount:0,creditAmount:5e3}]},{id:"je2",entryNumber:"JE-2024-002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",status:"posted",createdBy:"Jane Smith",createdAt:"2024-01-14T10:00:00Z",postedAt:"2024-01-14T10:15:00Z",totalDebit:250,totalCredit:250,lines:[{id:"jel3",accountId:"5200",accountName:"Office Expenses",description:"Office supplies from Staples",debitAmount:250,creditAmount:0},{id:"jel4",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment to Staples",debitAmount:0,creditAmount:250,reconciled:!0,reconciledWith:"eb2"}]},{id:"je3",entryNumber:"JE-2024-003",date:"2024-01-13",description:"Monthly Rent Payment",reference:"RENT-2024-01",status:"posted",createdBy:"John Doe",createdAt:"2024-01-13T08:00:00Z",postedAt:"2024-01-13T08:30:00Z",totalDebit:2e3,totalCredit:2e3,lines:[{id:"jel5",accountId:"5200",accountName:"Rent Expense",description:"January office rent",debitAmount:2e3,creditAmount:0},{id:"jel6",accountId:"1002",accountName:"Bank - Checking Account",description:"Rent payment",debitAmount:0,creditAmount:2e3,reconciled:!1}]},{id:"je4",entryNumber:"JE-2024-004",date:"2024-01-12",description:"Wire Transfer - Capital Investment",reference:"WIRE-001",status:"posted",createdBy:"Admin",createdAt:"2024-01-12T14:00:00Z",postedAt:"2024-01-12T14:30:00Z",totalDebit:1e4,totalCredit:1e4,lines:[{id:"jel7",accountId:"1002",accountName:"Bank - Checking Account",description:"Wire transfer received",debitAmount:1e4,creditAmount:0,reconciled:!1},{id:"jel8",accountId:"8",accountName:"Owner's Equity",description:"Capital investment",debitAmount:0,creditAmount:1e4}]},{id:"je5",entryNumber:"JE-2024-005",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",status:"posted",createdBy:"HR Manager",createdAt:"2024-01-11T16:00:00Z",postedAt:"2024-01-11T16:30:00Z",totalDebit:3500,totalCredit:3500,lines:[{id:"jel9",accountId:"13",accountName:"Salaries Expense",description:"Monthly salary - John Doe",debitAmount:3500,creditAmount:0},{id:"jel10",accountId:"1002",accountName:"Bank - Checking Account",description:"Salary payment",debitAmount:0,creditAmount:3500,reconciled:!1}]},{id:"je6",entryNumber:"JE-2024-006",date:"2024-01-10",description:"Product Sales - Multiple Customers",reference:"SALES-2024-010",status:"posted",createdBy:"Sales Manager",createdAt:"2024-01-10T11:00:00Z",postedAt:"2024-01-10T11:30:00Z",totalDebit:8500,totalCredit:8500,lines:[{id:"jel11",accountId:"1001",accountName:"Petty Cash",description:"Cash sales",debitAmount:1500,creditAmount:0},{id:"jel12",accountId:"2001",accountName:"Trade Receivables",description:"Credit sales",debitAmount:7e3,creditAmount:0},{id:"jel13",accountId:"10",accountName:"Sales Revenue",description:"Product sales revenue",debitAmount:0,creditAmount:8500}]},{id:"je7",entryNumber:"JE-2024-007",date:"2024-01-09",description:"Inventory Purchase",reference:"PO-2024-002",status:"draft",createdBy:"Warehouse Manager",createdAt:"2024-01-09T15:00:00Z",totalDebit:15e3,totalCredit:15e3,lines:[{id:"jel14",accountId:"3",accountName:"Inventory",description:"Product inventory purchase",debitAmount:15e3,creditAmount:0},{id:"jel15",accountId:"5",accountName:"Accounts Payable",description:"Amount owed to supplier",debitAmount:0,creditAmount:15e3}]},{id:"je8",entryNumber:"JE-2024-008",date:"2024-01-08",description:"Utility Bills Payment",reference:"UTIL-2024-01",status:"posted",createdBy:"Admin",createdAt:"2024-01-08T09:00:00Z",postedAt:"2024-01-08T09:30:00Z",totalDebit:450,totalCredit:450,lines:[{id:"jel16",accountId:"14",accountName:"Operating Expenses",description:"Electricity and water bills",debitAmount:450,creditAmount:0},{id:"jel17",accountId:"1003",accountName:"Bank - Savings Account",description:"Utility payment",debitAmount:0,creditAmount:450}]}],[Xi,mf]=Ce(C6),F0=()=>Xi().filter(e=>e.status==="posted").flatMap(e=>e.lines.filter(r=>["1001","1002","1003"].includes(r.accountId))).map(e=>{const r=Xi().find(n=>n.lines.some(i=>i.id===e.id));return r?{id:`eb_${e.id}`,accountId:e.accountId,date:r.date,description:r.description,reference:r.reference,debitAmount:e.debitAmount,creditAmount:e.creditAmount,category:e.accountName,isReconciled:e.reconciled||!1,reconciledWith:e.reconciledWith,createdAt:r.createdAt}:null}).filter(e=>e!==null),Eo={get journalEntries(){return Xi()},addJournalEntry(t){const e={...t,id:Date.now().toString()};return mf([...Xi(),e]),e},updateJournalEntry(t,e){mf(Xi().map(r=>r.id===t?{...r,...e}:r))},deleteJournalEntry(t){const e=Xi().find(r=>r.id===t);if(e&&e.status==="posted")throw new Error("Cannot delete posted journal entries. Void them instead.");mf(Xi().filter(r=>r.id!==t))},voidJournalEntry(t){this.updateJournalEntry(t,{status:"void"})},postJournalEntry(t){const e=Xi().find(r=>r.id===t);if(!e)throw new Error("Journal entry not found");if(Math.abs(e.totalDebit-e.totalCredit)>.01)throw new Error("Journal entry is not balanced. Debits must equal credits.");this.updateJournalEntry(t,{status:"posted",postedAt:new Date().toISOString()}),F0()},getJournalEntryById(t){return Xi().find(e=>e.id===t)},getJournalEntriesByStatus(t){return Xi().filter(e=>e.status===t)},getJournalEntriesByDateRange(t,e){return Xi().filter(r=>r.date>=t&&r.date<=e)},getJournalEntriesByAccount(t){return Xi().filter(e=>e.lines.some(r=>r.accountId===t))},getNextEntryNumber(){const t=new Date().getFullYear(),r=Xi().filter(n=>n.entryNumber.includes(t.toString())).reduce((n,i)=>{const o=parseInt(i.entryNumber.split("-").pop()||"0");return o>n?o:n},0);return`JE-${t}-${String(r+1).padStart(3,"0")}`},validateJournalEntry(t){const e=[];if(t.date||e.push("Date is required"),t.description||e.push("Description is required"),(!t.lines||t.lines.length===0)&&e.push("At least one line item is required"),t.lines){const r=t.lines.reduce((i,o)=>i+(o.debitAmount||0),0),n=t.lines.reduce((i,o)=>i+(o.creditAmount||0),0);Math.abs(r-n)>.01&&e.push(`Entry is not balanced. Debit: ${r}, Credit: ${n}`),t.lines.forEach((i,o)=>{i.accountId||e.push(`Line ${o+1}: Account is required`),i.debitAmount===0&&i.creditAmount===0&&e.push(`Line ${o+1}: Either debit or credit amount must be provided`),i.debitAmount>0&&i.creditAmount>0&&e.push(`Line ${o+1}: Cannot have both debit and credit amounts`)})}return{isValid:e.length===0,errors:e}},getBankRelatedEntries(){return F0()}};var I6=he("<form><div></div><div><div><h4></h4></div><div><div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div></div></div><div><div><strong>: </strong></div><div><strong>: </strong></div><div></div></div></div><div>"),yf=he("<div>");const D5=t=>{const{t:e}=or(),[r,n]=Ce({entryNumber:"",date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:e("journal.currentUser","Current User")}),[i,o]=Ce([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),[s,l]=Ce(null);gi(()=>{if(t.isOpen){if(t.editEntry)n({entryNumber:t.editEntry.entryNumber,date:t.editEntry.date,description:t.editEntry.description,reference:t.editEntry.reference,createdBy:t.editEntry.createdBy}),o(t.editEntry.lines.map((W,K)=>({...W,tempId:`line_${Date.now()}_${K}`})));else{const W=Eo.getNextEntryNumber();n({entryNumber:W,date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:e("journal.currentUser","Current User")}),o([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])}l(null)}});const c={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},u={display:"grid","grid-template-columns":"2fr 2fr 1fr 1fr 1fr",gap:"1rem","align-items":"end","margin-bottom":"1rem",padding:"1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},h={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},y=()=>kr.accounts.map(W=>({value:W.id,label:`${W.accountNumber} - ${W.name}`})),g=(W,K)=>{n(te=>({...te,[W]:K}))},f=(W,K,te)=>{o($=>$.map(C=>{if(C.tempId===W){const T={...C,[K]:te};if(K==="accountId"&&typeof te=="string"){const O=kr.getAccountById(te);O&&(T.accountName=O.name)}return T}return C}))},x=()=>{o(W=>[...W,{tempId:`line_${Date.now()}_${W.length}`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])},S=W=>{i().length>2&&o(K=>K.filter(te=>te.tempId!==W))},w=()=>{const W=i().reduce((te,$)=>te+($.debitAmount||0),0),K=i().reduce((te,$)=>te+($.creditAmount||0),0);return{totalDebit:W,totalCredit:K,isBalanced:Math.abs(W-K)<.01}},E=W=>{W.preventDefault(),l(null);const K=r(),te=i(),{totalDebit:$,totalCredit:C,isBalanced:T}=w();if(!K.description){l(e("forms.descriptionRequired","Description is required"));return}if(te.length<2){l(e("journal.minTwoLinesRequired","At least 2 line items are required"));return}if(!T){l(e("journal.entryNotBalanced","Entry is not balanced. Debit: ${debit}, Credit: ${credit}").replace("${debit}",`$${$.toFixed(2)}`).replace("${credit}",`$${C.toFixed(2)}`));return}for(let b=0;b<te.length;b++){const P=te[b];if(!P.accountId){l(e("journal.lineAccountRequired","Line {lineNumber}: Account is required").replace("{lineNumber}",(b+1).toString()));return}if(P.debitAmount===0&&P.creditAmount===0){l(e("journal.lineAmountRequired","Line {lineNumber}: Either debit or credit amount must be provided").replace("{lineNumber}",(b+1).toString()));return}if((P.debitAmount||0)>0&&(P.creditAmount||0)>0){l(e("journal.lineBothAmounts","Line {lineNumber}: Cannot have both debit and credit amounts").replace("{lineNumber}",(b+1).toString()));return}}const O={entryNumber:K.entryNumber,date:K.date,description:K.description,reference:K.reference,status:"draft",createdBy:K.createdBy,createdAt:new Date().toISOString(),totalDebit:$,totalCredit:C,lines:te.map((b,P)=>{const{tempId:_,...z}=b;return{id:`jel_${Date.now()}_${P}`,...z}})};try{t.editEntry?Eo.updateJournalEntry(t.editEntry.id,O):Eo.addJournalEntry(O),n({entryNumber:Eo.getNextEntryNumber(),date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:e("journal.currentUser","Current User")}),o([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),t.onClose()}catch(b){l(b instanceof Error?b.message:e("forms.errorOccurred","An error occurred"))}},q=W=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(W),ee=w();return R(On,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return Ee(()=>!!t.editEntry)()?e("journal.editEntry"):e("journal.addEntry","Add Journal Entry")},get children(){var W=I6(),K=W.firstChild,te=K.nextSibling,$=te.firstChild,C=$.firstChild,T=$.nextSibling,O=T.firstChild,b=O.firstChild,P=b.firstChild,_=b.nextSibling,z=_.firstChild,Z=_.nextSibling,k=Z.firstChild,F=Z.nextSibling,X=F.firstChild,U=F.nextSibling,B=U.firstChild,ce=T.nextSibling,L=ce.firstChild,D=L.firstChild,j=D.firstChild,I=L.nextSibling,M=I.firstChild,J=M.firstChild,H=I.nextSibling,Q=te.nextSibling;return W.addEventListener("submit",E),K.style.setProperty("display","grid"),K.style.setProperty("grid-template-columns","1fr 1fr"),K.style.setProperty("gap","1rem"),a(K,R($r,{get label(){return e("journal.entryNumber")},get value(){return r().entryNumber},onChange:se=>g("entryNumber",se),get disabled(){return!!t.editEntry},required:!0}),null),a(K,R($r,{get label(){return e("common.date")},type:"date",get value(){return r().date},onChange:se=>g("date",se),required:!0}),null),a(W,R($r,{get label(){return e("common.description")},get value(){return r().description},onChange:se=>g("description",se),get placeholder(){return e("journal.enterEntryDescription","Enter journal entry description")},required:!0}),te),a(W,R($r,{get label(){return e("journal.reference")},get value(){return r().reference},onChange:se=>g("reference",se),get placeholder(){return e("journal.enterReferenceNumber","Enter reference number")}}),te),te.style.setProperty("margin-top","2rem"),$.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),$.style.setProperty("margin-bottom","1rem"),C.style.setProperty("margin","0"),a(C,()=>e("journal.entryLines","Journal Entry Lines")),a($,R(ht,{type:"button",variant:"secondary",size:"sm",onClick:x,get children(){return e("journal.addLine","Add Line")}}),null),T.style.setProperty("margin-bottom","1rem"),T.style.setProperty("font-size","0.875rem"),T.style.setProperty("color","var(--text-muted)"),O.style.setProperty("display","grid"),O.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1fr"),O.style.setProperty("gap","1rem"),a(P,()=>e("journal.account")),a(z,()=>e("common.description")),a(k,()=>e("journal.debit")),a(X,()=>e("journal.credit")),a(B,()=>e("common.actions")),a(te,R(SS,{get each(){return i()},get fallback(){return(()=>{var se=yf();return a(se,()=>e("journal.noLines","No lines")),se})()},children:(se,G)=>{const re=se();return(()=>{var oe=yf();return m(oe,u),a(oe,R(Pn,{label:"",get value(){return re.accountId||""},onChange:fe=>f(re.tempId,"accountId",fe),get options(){return y()}}),null),a(oe,R($r,{label:"",get value(){return re.description||""},onChange:fe=>f(re.tempId,"description",fe),get placeholder(){return e("journal.lineDescription","Line description")}}),null),a(oe,R($r,{label:"",type:"number",get value(){return re.debitAmount?.toString()||"0"},onChange:fe=>{f(re.tempId,"debitAmount",parseFloat(fe)||0),parseFloat(fe)>0&&f(re.tempId,"creditAmount",0)},placeholder:"0.00"}),null),a(oe,R($r,{label:"",type:"number",get value(){return re.creditAmount?.toString()||"0"},onChange:fe=>{f(re.tempId,"creditAmount",parseFloat(fe)||0),parseFloat(fe)>0&&f(re.tempId,"debitAmount",0)},placeholder:"0.00"}),null),a(oe,R(ht,{type:"button",variant:"outline",size:"sm",onClick:()=>S(re.tempId),get disabled(){return i().length<=2},get children(){return e("common.remove")}}),null),oe})()}}),ce),m(ce,h),a(D,()=>e("journal.totalDebit","Total Debit"),j),a(D,()=>q(ee.totalDebit),null),a(M,()=>e("journal.totalCredit","Total Credit"),J),a(M,()=>q(ee.totalCredit),null),H.style.setProperty("font-weight","600"),a(H,(()=>{var se=Ee(()=>!!ee.isBalanced);return()=>se()?`✓ ${e("journal.balanced")}`:`⚠️ ${e("journal.notBalanced","Not Balanced")}`})()),a(W,(()=>{var se=Ee(()=>!!s());return()=>se()&&(()=>{var G=yf();return G.style.setProperty("padding","1rem"),G.style.setProperty("border-radius","var(--border-radius-sm)"),G.style.setProperty("margin-top","1rem"),G.style.setProperty("background","#f8d7da"),G.style.setProperty("color","#721c24"),G.style.setProperty("border","1px solid #f5c6cb"),a(G,s),G})()})(),Q),m(Q,c),a(Q,R(ht,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(Q,R(ht,{variant:"primary",type:"submit",get disabled(){return!ee.isBalanced},get children(){return Ee(()=>!!t.editEntry)()?e("journal.updateEntry","Update Entry"):e("journal.saveAsDraft","Save as Draft")}}),null),Se(se=>(se=ee.isBalanced?"#4caf50":"#f44336")!=null?H.style.setProperty("color",se):H.style.removeProperty("color")),W}})},$6={"Sale Amount":{en:"Sale Amount",es:"Monto de Venta"},"Payment Amount":{en:"Payment Amount",es:"Monto del Pago"},"Expense Amount":{en:"Expense Amount",es:"Monto del Gasto"},"Rent Amount":{en:"Rent Amount",es:"Monto del Alquiler"},"Salary Amount":{en:"Salary Amount",es:"Monto del Salario"},"Utility Amount":{en:"Utility Amount",es:"Monto de Servicios"},"Inventory Cost":{en:"Inventory Cost",es:"Costo del Inventario"},"Investment Amount":{en:"Investment Amount",es:"Monto de Inversión"},"Depreciation Amount":{en:"Depreciation Amount",es:"Monto de Depreciación"},"Interest Amount":{en:"Interest Amount",es:"Monto de Interés"},"Principal Amount":{en:"Principal Amount",es:"Monto Principal"},"Total Payment":{en:"Total Payment",es:"Pago Total"},Amount:{en:"Amount",es:"Monto"},Monto:{en:"Amount",es:"Monto"}},E6={"Cash Sale":{en:"Cash Sale",es:"Venta en Efectivo"},"Credit Sale":{en:"Credit Sale",es:"Venta a Crédito"},"Customer Payment Received":{en:"Customer Payment Received",es:"Pago Recibido del Cliente"},"Office Expenses":{en:"Office Expenses",es:"Gastos de Oficina"},"Rent Payment":{en:"Rent Payment",es:"Pago de Alquiler"},"Salary Payment":{en:"Salary Payment",es:"Pago de Salario"},"Utility Payment":{en:"Utility Payment",es:"Pago de Servicios"},"Inventory Purchase":{en:"Inventory Purchase",es:"Compra de Inventario"},"Supplier Payment":{en:"Supplier Payment",es:"Pago a Proveedor"},"Capital Investment":{en:"Capital Investment",es:"Inversión de Capital"},"Depreciation Expense":{en:"Depreciation Expense",es:"Gasto de Depreciación"},"Loan Payment":{en:"Loan Payment",es:"Pago de Préstamo"}},T6={"Record a cash sale transaction":{en:"Record a cash sale transaction",es:"Registrar una transacción de venta en efectivo"},"Record a sale on credit (accounts receivable)":{en:"Record a sale on credit (accounts receivable)",es:"Registrar una venta a crédito (cuentas por cobrar)"},"Record payment received from customer":{en:"Record payment received from customer",es:"Registrar pago recibido del cliente"},"Record office supplies and expenses":{en:"Record office supplies and expenses",es:"Registrar suministros y gastos de oficina"},"Record monthly rent payment":{en:"Record monthly rent payment",es:"Registrar pago mensual de alquiler"},"Record employee salary payment":{en:"Record employee salary payment",es:"Registrar pago de salario de empleado"},"Record utility bills payment":{en:"Record utility bills payment",es:"Registrar pago de servicios públicos"},"Record inventory purchase on credit":{en:"Record inventory purchase on credit",es:"Registrar compra de inventario a crédito"},"Record payment to supplier":{en:"Record payment to supplier",es:"Registrar pago a proveedor"},"Record owner capital investment":{en:"Record owner capital investment",es:"Registrar inversión de capital del propietario"},"Record monthly depreciation of assets":{en:"Record monthly depreciation of assets",es:"Registrar depreciación mensual de activos"},"Record loan principal and interest payment":{en:"Record loan principal and interest payment",es:"Registrar pago de capital e intereses del préstamo"}},k6={"Cash received from sale":{en:"Cash received from sale",es:"Efectivo recibido de venta"},"Sales revenue":{en:"Sales revenue",es:"Ingresos por ventas"},"Credit sale to customer":{en:"Credit sale to customer",es:"Venta a crédito al cliente"},"Payment received from customer":{en:"Payment received from customer",es:"Pago recibido del cliente"},"Payment applied to receivable":{en:"Payment applied to receivable",es:"Pago aplicado a cuenta por cobrar"},"Office supplies and expenses":{en:"Office supplies and expenses",es:"Suministros y gastos de oficina"},"Payment for office expenses":{en:"Payment for office expenses",es:"Pago por gastos de oficina"},"Monthly rent payment":{en:"Monthly rent payment",es:"Pago mensual de alquiler"},"Rent payment":{en:"Rent payment",es:"Pago de alquiler"},"Employee salary":{en:"Employee salary",es:"Salario de empleado"},"Salary payment":{en:"Salary payment",es:"Pago de salario"},"Utility bills payment":{en:"Utility bills payment",es:"Pago de servicios públicos"},"Utility payment":{en:"Utility payment",es:"Pago de servicios"},"Inventory purchase":{en:"Inventory purchase",es:"Compra de inventario"},"Amount owed to supplier":{en:"Amount owed to supplier",es:"Monto adeudado al proveedor"},"Payment to supplier":{en:"Payment to supplier",es:"Pago al proveedor"},"Capital investment received":{en:"Capital investment received",es:"Inversión de capital recibida"},"Capital investment":{en:"Capital investment",es:"Inversión de capital"},"Monthly depreciation expense":{en:"Monthly depreciation expense",es:"Gasto mensual de depreciación"},"Accumulated depreciation":{en:"Accumulated depreciation",es:"Depreciación acumulada"},"Interest expense":{en:"Interest expense",es:"Gasto por intereses"},"Principal payment":{en:"Principal payment",es:"Pago de capital"},"Total loan payment":{en:"Total loan payment",es:"Pago total del préstamo"}},N6=t=>$6[t]?.["es"]||t,L6=t=>E6[t]?.["es"]||t,R6=t=>T6[t]?.["es"]||t,D6=t=>k6[t]?.["es"]||t,M6=[{id:"cash_sale",name:"Cash Sale",description:"Record a cash sale transaction",category:"revenue",lines:[{id:"cs1",accountId:"1001",accountName:"Petty Cash",description:"Cash received from sale",type:"debit",isAmountField:!0,amountFieldName:"Sale Amount"},{id:"cs2",accountId:"10",accountName:"Sales Revenue",description:"Sales revenue",type:"credit",isAmountField:!0,amountFieldName:"Sale Amount"}]},{id:"credit_sale",name:"Credit Sale",description:"Record a sale on credit (accounts receivable)",category:"revenue",lines:[{id:"crs1",accountId:"2001",accountName:"Trade Receivables",description:"Credit sale to customer",type:"debit",isAmountField:!0,amountFieldName:"Sale Amount"},{id:"crs2",accountId:"10",accountName:"Sales Revenue",description:"Sales revenue",type:"credit",isAmountField:!0,amountFieldName:"Sale Amount"}]},{id:"customer_payment",name:"Customer Payment Received",description:"Record payment received from customer",category:"assets",lines:[{id:"cp1",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment received from customer",type:"debit",isAmountField:!0,amountFieldName:"Payment Amount"},{id:"cp2",accountId:"2001",accountName:"Trade Receivables",description:"Payment applied to receivable",type:"credit",isAmountField:!0,amountFieldName:"Payment Amount"}]},{id:"office_expenses",name:"Office Expenses",description:"Record office supplies and expenses",category:"expenses",lines:[{id:"oe1",accountId:"5200",accountName:"Office Expenses",description:"Office supplies and expenses",type:"debit",isAmountField:!0,amountFieldName:"Expense Amount"},{id:"oe2",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment for office expenses",type:"credit",isAmountField:!0,amountFieldName:"Expense Amount"}]},{id:"rent_payment",name:"Rent Payment",description:"Record monthly rent payment",category:"expenses",lines:[{id:"rp1",accountId:"5200",accountName:"Rent Expense",description:"Monthly rent payment",type:"debit",isAmountField:!0,amountFieldName:"Rent Amount"},{id:"rp2",accountId:"1002",accountName:"Bank - Checking Account",description:"Rent payment",type:"credit",isAmountField:!0,amountFieldName:"Rent Amount"}]},{id:"salary_payment",name:"Salary Payment",description:"Record employee salary payment",category:"expenses",lines:[{id:"sp1",accountId:"13",accountName:"Salaries Expense",description:"Employee salary",type:"debit",isAmountField:!0,amountFieldName:"Salary Amount"},{id:"sp2",accountId:"1002",accountName:"Bank - Checking Account",description:"Salary payment",type:"credit",isAmountField:!0,amountFieldName:"Salary Amount"}]},{id:"utility_payment",name:"Utility Payment",description:"Record utility bills payment",category:"expenses",lines:[{id:"up1",accountId:"14",accountName:"Operating Expenses",description:"Utility bills payment",type:"debit",isAmountField:!0,amountFieldName:"Utility Amount"},{id:"up2",accountId:"1002",accountName:"Bank - Checking Account",description:"Utility payment",type:"credit",isAmountField:!0,amountFieldName:"Utility Amount"}]},{id:"inventory_purchase",name:"Inventory Purchase",description:"Record inventory purchase on credit",category:"assets",lines:[{id:"ip1",accountId:"3",accountName:"Inventory",description:"Inventory purchase",type:"debit",isAmountField:!0,amountFieldName:"Inventory Cost"},{id:"ip2",accountId:"5",accountName:"Accounts Payable",description:"Amount owed to supplier",type:"credit",isAmountField:!0,amountFieldName:"Inventory Cost"}]},{id:"supplier_payment",name:"Supplier Payment",description:"Record payment to supplier",category:"liabilities",lines:[{id:"spp1",accountId:"5",accountName:"Accounts Payable",description:"Payment to supplier",type:"debit",isAmountField:!0,amountFieldName:"Payment Amount"},{id:"spp2",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment to supplier",type:"credit",isAmountField:!0,amountFieldName:"Payment Amount"}]},{id:"capital_investment",name:"Capital Investment",description:"Record owner capital investment",category:"equity",lines:[{id:"ci1",accountId:"1002",accountName:"Bank - Checking Account",description:"Capital investment received",type:"debit",isAmountField:!0,amountFieldName:"Investment Amount"},{id:"ci2",accountId:"8",accountName:"Owner's Equity",description:"Capital investment",type:"credit",isAmountField:!0,amountFieldName:"Investment Amount"}]},{id:"depreciation",name:"Depreciation Expense",description:"Record monthly depreciation of assets",category:"expenses",lines:[{id:"dep1",accountId:"14",accountName:"Operating Expenses",description:"Monthly depreciation expense",type:"debit",isAmountField:!0,amountFieldName:"Depreciation Amount"},{id:"dep2",accountId:"15",accountName:"Accumulated Depreciation",description:"Accumulated depreciation",type:"credit",isAmountField:!0,amountFieldName:"Depreciation Amount"}]},{id:"loan_payment",name:"Loan Payment",description:"Record loan principal and interest payment",category:"liabilities",lines:[{id:"lp1",accountId:"14",accountName:"Operating Expenses",description:"Interest expense",type:"debit",isAmountField:!0,amountFieldName:"Interest Amount"},{id:"lp2",accountId:"6",accountName:"Loans Payable",description:"Principal payment",type:"debit",isAmountField:!0,amountFieldName:"Principal Amount"},{id:"lp3",accountId:"1002",accountName:"Bank - Checking Account",description:"Total loan payment",type:"credit",isAmountField:!0,amountFieldName:"Total Payment"}]}],M5="journal_custom_templates",F6=()=>{try{const t=localStorage.getItem(M5);if(t)return JSON.parse(t)}catch(t){console.warn("Failed to load custom templates:",t)}return[]},gf=t=>{try{localStorage.setItem(M5,JSON.stringify(t))}catch(e){console.warn("Failed to save custom templates:",e)}},O6=()=>{const t=F6();return[...M6,...t]},[vf,bf]=Ce(O6()),di={get templates(){return vf()},getTemplatesByCategory(t){return vf().filter(e=>e.category===t)},getTemplateById(t){return vf().find(e=>e.id===t)},addTemplate(t){const e={...t,id:`custom_${Date.now()}`};return bf(r=>{const n=[...r,e],i=n.filter(o=>o.id.startsWith("custom_"));return gf(i),n}),e},updateTemplate(t,e){bf(r=>{const n=r.map(o=>o.id===t?{...o,...e}:o),i=n.filter(o=>o.id.startsWith("custom_"));return gf(i),n})},deleteTemplate(t){if(t.startsWith("custom_"))bf(e=>{const r=e.filter(i=>i.id!==t),n=r.filter(i=>i.id.startsWith("custom_"));return gf(n),r});else throw new Error("Cannot delete default templates")},getAllCategories(){return["revenue","expenses","assets","liabilities","equity"]},getCategoryDisplayName(t){const e="es",r={revenue:{en:"Revenue & Sales",es:"Ingresos y Ventas"},expenses:{en:"Expenses & Costs",es:"Gastos y Costos"},assets:{en:"Assets & Receipts",es:"Activos y Recibos"},liabilities:{en:"Liabilities & Payments",es:"Pasivos y Pagos"},equity:{en:"Equity & Capital",es:"Patrimonio y Capital"}};return r[t][e]||r[t].en},getTranslatedFieldName:N6,getTranslatedTemplateName:L6,getTranslatedTemplateDesc:R6,getTranslatedLineDesc:D6};var O0=he("<div>"),B6=he("<div><h4></h4><div><div><strong>: </strong><span>|</span><strong>: </strong></div><div>"),j6=he("<form><div></div><div>"),V6=he("<div><div><div></div><div></div><div></div></div><div></div><div><div> ");const q6=t=>{const{t:e}=or(),[r,n]=Ce(""),[i,o]=Yu({form:{}}),[s,l]=Ce(""),[c,u]=Ce(""),[h,y]=Ce({}),[g,f]=Ce({date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:e("journal.currentUser","Current User")}),[x,S]=Ce(null);gi(()=>{t.isOpen&&(n(""),o("form",null),l(null),u(""),f({date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:e("journal.currentUser","Current User")}),S(null))}),gi(()=>{});const w={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},E={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1rem","margin-top":"1rem"},q={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.5rem 0","border-bottom":"1px solid var(--border-color)"},ee=z=>{if(n(z),z){const Z=di.getTemplateById(z);o("form",Xb(Z)||null),l(Z?.lines),Z&&!g().description&&f(k=>({...k,description:Z.description})),Z&&Z.lines.forEach((k,F)=>{k.fixedAmount||(o("form","lines",F,"fixedAmount",0),y(X=>({...X,[k.id]:0})))})}},W=()=>di.getAllCategories().map(z=>({value:z,label:di.getCategoryDisplayName(z)})),K=()=>{const z=c();return z?di.getTemplatesByCategory(z).map(Z=>({value:Z.id,label:di.getTranslatedTemplateName(Z.name)})):[]},te=(z,Z)=>{f(k=>({...k,[z]:Z}))},$=z=>h()?.[z]||0,C=(z,Z)=>{const k=i.form;!k||!k.lines.find(X=>X.id===z)||(y(X=>({...X,[z]:Z})),k.lines.findIndex(X=>X.id===z))},T=()=>{const z=i.form;if(!z)return{totalDebit:0,totalCredit:0,isBalanced:!1};let Z=0,k=0;return z?.lines?.forEach(F=>{const X=h()?.[F.id]||F.fixedAmount||0;F.type==="debit"?Z+=X:k+=X}),{totalDebit:Z,totalCredit:k,isBalanced:Math.abs(Z-k)<.01}},O=()=>{const z=i.form;if(!z)return[];const Z=new Map;return z?.lines?.forEach(k=>{k.isAmountField&&k.amountFieldName&&Z.set(k.amountFieldName,k.id)}),Array.from(Z.entries()).map(([k,F])=>({fieldName:k,lineId:F}))},b=z=>{z.preventDefault(),S(null);const Z=i.form;if(!Z){S(e("journal.templateRequired","Please select a template"));return}const k=g(),{totalDebit:F,totalCredit:X,isBalanced:U}=T();if(!k.description){S(e("forms.descriptionRequired","Description is required"));return}if(!U){S(e("journal.entryNotBalanced","Entry is not balanced. Debit: ${debit}, Credit: ${credit}").replace("${debit}",`$${F.toFixed(2)}`).replace("${credit}",`$${X.toFixed(2)}`));return}for(const ce of Z.lines){const L=h()?.[ce.id]||0;if(ce.isAmountField&&L<=0){S(e("journal.amountRequired","Amount is required for {field}").replace("{field}",ce.amountFieldName||"line"));return}}const B={entryNumber:Eo.getNextEntryNumber(),date:k.date,description:k.description,reference:k.reference,status:"draft",createdBy:k.createdBy,createdAt:new Date().toISOString(),totalDebit:F,totalCredit:X,lines:Z.lines.map((ce,L)=>{const D=h()?.[ce.id]||0;return{id:`jel_${Date.now()}_${L}`,accountId:ce.accountId,accountName:ce.accountName,description:ce.description,debitAmount:ce.type==="debit"?D:0,creditAmount:ce.type==="credit"?D:0}})};try{Eo.addJournalEntry(B),t.onClose()}catch(ce){S(ce instanceof Error?ce.message:e("forms.errorOccurred","An error occurred"))}},P=z=>{const Z="es-ES";return new Intl.NumberFormat(Z,{style:"currency",currency:"USD"}).format(z)};O();const _=()=>i?.form?.lines||[];return R(On,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.quickEntry","Quick Journal Entry")},get children(){var z=j6(),Z=z.firstChild,k=Z.nextSibling;return z.addEventListener("submit",b),Z.style.setProperty("display","grid"),Z.style.setProperty("grid-template-columns","1fr 1fr"),Z.style.setProperty("gap","1rem"),Z.style.setProperty("margin-bottom","1rem"),a(Z,R(Pn,{get label(){return e("journal.selectCategory","Select Category")},get value(){return c()},onChange:F=>{u(F),ee("")},get options(){return[{value:"",label:e("journal.chooseCategory","Choose a category...")},...W()]},required:!0}),null),a(Z,R(Pn,{get label(){return e("journal.selectTemplate","Select Template")},get value(){return r()},onChange:ee,get options(){return[{value:"",label:e("journal.chooseTemplate","Choose a template...")},...K()]},get disabled(){return!c()},required:!0}),null),a(z,R(ze,{get when(){return i.form},get children(){return[(()=>{var F=O0();return F.style.setProperty("display","grid"),F.style.setProperty("grid-template-columns","1fr 1fr"),F.style.setProperty("gap","1rem"),a(F,R($r,{get label(){return e("common.date")},type:"date",get value(){return g().date},onChange:X=>te("date",X),required:!0}),null),a(F,R($r,{get label(){return e("journal.reference")},get value(){return g().reference},onChange:X=>te("reference",X),get placeholder(){return e("journal.enterReferenceNumber","Enter reference number")}}),null),F})(),R($r,{get label(){return e("common.description")},get value(){return g().description},onChange:F=>te("description",F),get placeholder(){return i?.form?.description||e("journal.enterEntryDescription","Enter journal entry description")},required:!0}),(()=>{var F=B6(),X=F.firstChild,U=X.nextSibling,B=U.firstChild,ce=B.firstChild,L=ce.firstChild,D=ce.nextSibling,j=D.nextSibling,I=j.firstChild,M=B.nextSibling;return m(F,E),X.style.setProperty("margin","0 0 1rem 0"),X.style.setProperty("color","var(--text-primary)"),a(X,()=>e("journal.entryPreview","Entry Preview")),a(F,R(Ut,{get each(){return _()},children:J=>(()=>{var H=V6(),Q=H.firstChild,se=Q.firstChild,G=se.nextSibling,re=G.nextSibling,oe=Q.nextSibling,fe=oe.nextSibling,ae=fe.firstChild,Y=ae.firstChild;return se.style.setProperty("font-weight","500"),a(se,()=>J.accountName),G.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","var(--text-muted)"),a(G,()=>di.getTranslatedLineDesc(J.description)),re.style.setProperty("font-size","0.75rem"),re.style.setProperty("margin-top","0.25rem"),re.style.setProperty("font-weight","500"),a(re,(()=>{var ie=Ee(()=>J.type==="debit");return()=>ie()?e("journal.debit"):e("journal.credit")})()),a(oe,R($r,{label:"",type:"number",get value(){return $(J.id).toString()},onChange:ie=>C(J.id,parseFloat(ie)||0),placeholder:"0.00",step:"0.01",min:"0",style:{"font-size":"0.875rem"}})),fe.style.setProperty("text-align","right"),ae.style.setProperty("font-weight","600"),a(ae,()=>J.type==="debit"?"DR":"CR",Y),a(ae,()=>P($(J.id)),null),Se(ie=>{var de={...q,display:"grid","grid-template-columns":"2fr 1fr 1fr",gap:"1rem","align-items":"center"},ue=J.type==="debit"?"#d32f2f":"#2e7d32",ge=J.type==="debit"?"#d32f2f":"#2e7d32";return ie.e=m(H,de,ie.e),ue!==ie.t&&((ie.t=ue)!=null?re.style.setProperty("color",ue):re.style.removeProperty("color")),ge!==ie.a&&((ie.a=ge)!=null?ae.style.setProperty("color",ge):ae.style.removeProperty("color")),ie},{e:void 0,t:void 0,a:void 0}),H})()}),U),U.style.setProperty("margin-top","1rem"),U.style.setProperty("padding-top","1rem"),U.style.setProperty("border-top","2px solid var(--border-color)"),U.style.setProperty("display","flex"),U.style.setProperty("justify-content","space-between"),U.style.setProperty("align-items","center"),a(ce,()=>e("journal.totalDebit"),L),a(ce,()=>P(T().totalDebit),null),D.style.setProperty("margin","0 1rem"),D.style.setProperty("color","var(--text-muted)"),a(j,()=>e("journal.totalCredit"),I),a(j,()=>P(T().totalCredit),null),M.style.setProperty("font-weight","600"),a(M,(()=>{var J=Ee(()=>!!T().isBalanced);return()=>J()?`✓ ${e("journal.balanced","Balanced")}`:`⚠️ ${e("journal.notBalanced","Not Balanced")}`})()),Se(J=>(J=T().isBalanced?"#4caf50":"#f44336")!=null?M.style.setProperty("color",J):M.style.removeProperty("color")),F})()]}}),k),a(z,(()=>{var F=Ee(()=>!!x());return()=>F()&&(()=>{var X=O0();return X.style.setProperty("padding","1rem"),X.style.setProperty("border-radius","var(--border-radius-sm)"),X.style.setProperty("margin-top","1rem"),X.style.setProperty("background","#f8d7da"),X.style.setProperty("color","#721c24"),X.style.setProperty("border","1px solid #f5c6cb"),a(X,x),X})()})(),k),m(k,w),a(k,R(ht,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(k,R(ht,{variant:"primary",type:"submit",get disabled(){return!i.form||!T().isBalanced},get children(){return e("journal.createQuickEntry","Create Quick Entry")}}),null),z}})};var z6=he("<div><h3></h3><div>"),U6=he("<div><div></div><div><div><h4></h4></div><div><div><div></div><div></div><div></div><div></div><div></div><div>"),H6=he("<div><p></p><p>"),B0=he("<div><div></div><div>"),G6=he("<h4>"),W6=he("<span>"),_f=he("<div>");const Y6=t=>{const{t:e}=or(),[r,n]=Ce(""),[i,o]=Ce(!1),[s,l]=Ce(!1),[c,u]=Ce({name:"",description:"",category:"expenses"}),[h,y]=Ce([{accountId:"",accountName:"",description:"",type:"debit",isAmountField:!0,amountFieldName:e("common.amount","Amount")},{accountId:"",accountName:"",description:"",type:"credit",isAmountField:!0,amountFieldName:e("common.amount","Amount")}]),[g,f]=Ce(null);gi(()=>{t.isOpen&&(n(""),o(!1),l(!1),f(null),K())});const x={display:"flex",gap:"1.5rem",height:"500px"},S={width:"300px","border-right":"1px solid var(--border-color)","padding-right":"1.5rem","overflow-y":"auto"},w={flex:"1","overflow-y":"auto"},E={padding:"0.75rem","margin-bottom":"0.5rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",transition:"all 0.2s"},q={display:"grid","grid-template-columns":"2fr 2fr 1fr 1fr 1fr 80px",gap:"0.5rem","align-items":"end","margin-bottom":"0.75rem",padding:"0.75rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)"},ee=()=>kr.accounts.map(F=>({value:F.id,label:`${F.accountNumber} - ${F.name}`})),W=()=>di.getAllCategories().map(F=>({value:F,label:di.getCategoryDisplayName(F)})),K=()=>{u({name:"",description:"",category:"expenses"}),y([{accountId:"",accountName:"",description:"",type:"debit",isAmountField:!0,amountFieldName:e("common.amount","Amount")},{accountId:"",accountName:"",description:"",type:"credit",isAmountField:!0,amountFieldName:e("common.amount","Amount")}])},te=F=>{const X=di.getTemplateById(F);X&&(u({name:X.name,description:X.description,category:X.category}),y(X.lines.map(U=>({accountId:U.accountId,accountName:U.accountName,description:U.description,type:U.type,isAmountField:U.isAmountField,amountFieldName:U.amountFieldName,fixedAmount:U.fixedAmount}))))},$=F=>{n(F),o(!1),l(!1),te(F)},C=()=>{n(""),o(!1),l(!0),K()},T=()=>{r()&&r().startsWith("custom_")&&o(!0)},O=()=>{const F=r();if(F&&F.startsWith("custom_")&&confirm(e("journal.confirmDeleteTemplate","Are you sure you want to delete this template?")))try{di.deleteTemplate(F),n(""),K()}catch(X){f(X instanceof Error?X.message:e("journal.errorDeletingTemplate","Error deleting template"))}},b=(F,X)=>{u(U=>({...U,[F]:X}))},P=(F,X,U)=>{y(B=>B.map((ce,L)=>{if(L===F){const D={...ce,[X]:U};if(X==="accountId"&&typeof U=="string"){const j=kr.getAccountById(U);j&&(D.accountName=j.name)}return D}return ce}))},_=()=>{y(F=>[...F,{accountId:"",accountName:"",description:"",type:F.length%2===0?"debit":"credit",isAmountField:!0,amountFieldName:e("common.amount","Amount")}])},z=F=>{h().length>2&&y(X=>X.filter((U,B)=>B!==F))},Z=()=>{f(null);const F=c(),X=h();if(!F.name.trim()){f(e("journal.templateNameRequired","Template name is required"));return}if(!F.description.trim()){f(e("journal.templateDescriptionRequired","Template description is required"));return}if(X.length<2){f(e("journal.minTwoLinesRequired","At least 2 lines are required"));return}for(let B=0;B<X.length;B++){const ce=X[B];if(!ce.accountId){f(e("journal.lineAccountRequired","Line {lineNumber}: Account is required").replace("{lineNumber}",(B+1).toString()));return}if(!ce.description){f(e("journal.lineDescriptionRequired","Line {lineNumber}: Description is required").replace("{lineNumber}",(B+1).toString()));return}if(ce.isAmountField&&!ce.amountFieldName){f(e("journal.amountFieldNameRequired","Line {lineNumber}: Amount field name is required").replace("{lineNumber}",(B+1).toString()));return}}const U={name:F.name,description:F.description,category:F.category,lines:X.map((B,ce)=>({id:`line_${Date.now()}_${ce}`,...B}))};try{if(i()&&r())di.updateTemplate(r(),U);else{const B=di.addTemplate(U);n(B.id)}o(!1),l(!1)}catch(B){f(B instanceof Error?B.message:e("journal.errorSavingTemplate","Error saving template"))}},k=()=>{const F=di.templates,X={};return F.forEach(U=>{X[U.category]||(X[U.category]=[]),X[U.category].push(U)}),X};return R(On,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.manageTemplates","Manage Journal Templates")},size:"large",get children(){var F=B0(),X=F.firstChild,U=X.nextSibling;return m(F,x),m(X,S),a(X,R(ht,{variant:"primary",onClick:C,style:{width:"100%","margin-bottom":"1rem"},get children(){return["+ ",Ee(()=>e("journal.addNewTemplate","Add New Template"))]}}),null),a(X,R(Ut,{get each(){return Object.entries(k())},children:([B,ce])=>[(()=>{var L=G6();return L.style.setProperty("margin","1rem 0 0.5rem 0"),L.style.setProperty("font-size","0.875rem"),L.style.setProperty("color","var(--text-muted)"),L.style.setProperty("text-transform","uppercase"),a(L,()=>di.getCategoryDisplayName(B)),L})(),R(Ut,{each:ce,children:L=>(()=>{var D=B0(),j=D.firstChild,I=j.nextSibling;return D.$$click=()=>$(L.id),j.style.setProperty("font-weight","500"),a(j,()=>di.getTranslatedTemplateName(L.name)),I.style.setProperty("font-size","0.75rem"),I.style.setProperty("opacity","0.8"),I.style.setProperty("margin-top","0.25rem"),a(I,()=>di.getTranslatedTemplateDesc(L.description)),a(D,(()=>{var M=Ee(()=>!!L.id.startsWith("custom_"));return()=>M()&&(()=>{var J=W6();return J.style.setProperty("font-size","0.625rem"),J.style.setProperty("background","rgba(255,255,255,0.2)"),J.style.setProperty("padding","0.125rem 0.5rem"),J.style.setProperty("border-radius","10px"),J.style.setProperty("margin-top","0.25rem"),J.style.setProperty("display","inline-block"),a(J,()=>e("journal.custom","Custom")),J})()})(),null),Se(M=>m(D,{...E,background:r()===L.id?"var(--primary-color)":"var(--surface-color)",color:r()===L.id?"white":"inherit"},M)),D})()})]}),null),m(U,w),a(U,R(ze,{get when(){return r()||s()},get children(){return[(()=>{var B=z6(),ce=B.firstChild,L=ce.nextSibling;return B.style.setProperty("display","flex"),B.style.setProperty("justify-content","space-between"),B.style.setProperty("align-items","center"),B.style.setProperty("margin-bottom","1rem"),ce.style.setProperty("margin","0"),a(ce,(()=>{var D=Ee(()=>!!s());return()=>D()?e("journal.newTemplate","New Template"):Ee(()=>!!i())()?e("journal.editTemplate","Edit Template"):e("journal.templateDetails","Template Details")})()),L.style.setProperty("display","flex"),L.style.setProperty("gap","0.5rem"),a(L,R(ze,{get when(){return Ee(()=>!!(r()&&r().startsWith("custom_")))()&&!i()},get children(){return[R(ht,{variant:"outline",size:"sm",onClick:T,get children(){return e("common.edit")}}),R(ht,{variant:"outline",size:"sm",onClick:O,style:{color:"var(--danger-color)"},get children(){return e("common.delete")}})]}}),null),a(L,R(ze,{get when(){return i()||s()},get children(){return[R(ht,{variant:"secondary",size:"sm",onClick:()=>{o(!1),l(!1),r()&&te(r())},get children(){return e("common.cancel")}}),R(ht,{variant:"primary",size:"sm",onClick:Z,get children(){return e("common.save")}})]}}),null),B})(),(()=>{var B=U6(),ce=B.firstChild,L=ce.nextSibling,D=L.firstChild,j=D.firstChild,I=D.nextSibling,M=I.firstChild,J=M.firstChild,H=J.nextSibling,Q=H.nextSibling,se=Q.nextSibling,G=se.nextSibling,re=G.nextSibling;return B.style.setProperty("background","var(--background-color)"),B.style.setProperty("padding","1rem"),B.style.setProperty("border-radius","var(--border-radius-sm)"),ce.style.setProperty("display","grid"),ce.style.setProperty("grid-template-columns","2fr 1fr"),ce.style.setProperty("gap","1rem"),ce.style.setProperty("margin-bottom","1rem"),a(ce,R($r,{get label(){return e("journal.templateName","Template Name")},get value(){return c().name},onChange:oe=>b("name",oe),get disabled(){return Ee(()=>!i())()&&!s()},get placeholder(){return e("journal.enterTemplateName","Enter template name")}}),null),a(ce,R(Pn,{get label(){return e("journal.category","Category")},get value(){return c().category},onChange:oe=>b("category",oe),get options(){return W()},get disabled(){return Ee(()=>!i())()&&!s()}}),null),a(B,R($r,{get label(){return e("common.description")},get value(){return c().description},onChange:oe=>b("description",oe),get disabled(){return Ee(()=>!i())()&&!s()},get placeholder(){return e("journal.enterTemplateDescription","Enter template description")}}),L),L.style.setProperty("margin-top","2rem"),D.style.setProperty("display","flex"),D.style.setProperty("justify-content","space-between"),D.style.setProperty("align-items","center"),D.style.setProperty("margin-bottom","1rem"),j.style.setProperty("margin","0"),a(j,()=>e("journal.templateLines","Template Lines")),a(D,R(ze,{get when(){return i()||s()},get children(){return R(ht,{variant:"secondary",size:"sm",onClick:_,get children(){return["+ ",Ee(()=>e("journal.addLine"))]}})}}),null),I.style.setProperty("margin-bottom","0.5rem"),I.style.setProperty("font-size","0.75rem"),I.style.setProperty("color","var(--text-muted)"),M.style.setProperty("display","grid"),M.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1fr 80px"),M.style.setProperty("gap","0.5rem"),a(J,()=>e("journal.account")),a(H,()=>e("common.description")),a(Q,()=>e("journal.type","Type")),a(se,()=>e("journal.amountType","Amount Type")),a(G,()=>e("journal.fieldName","Field Name")),a(re,()=>e("common.actions")),a(L,R(Ut,{get each(){return h()},get fallback(){return(()=>{var oe=_f();return a(oe,()=>e("journal.noTemplateLines","No template lines")),oe})()},children:(oe,fe)=>{const ae=oe,Y=fe();return(()=>{var ie=_f();return m(ie,q),a(ie,R(Pn,{label:"",get value(){return ae.accountId||""},onChange:de=>P(Y,"accountId",de),get options(){return[{value:"",label:e("journal.selectAccount","Select account...")},...ee()]},get disabled(){return Ee(()=>!i())()&&!s()}}),null),a(ie,R($r,{label:"",get value(){return ae.description||""},onChange:de=>P(Y,"description",de),get placeholder(){return e("journal.lineDescription")},get disabled(){return Ee(()=>!i())()&&!s()}}),null),a(ie,R(Pn,{label:"",get value(){return ae.type},onChange:de=>P(Y,"type",de),get options(){return[{value:"debit",label:e("journal.debit")},{value:"credit",label:e("journal.credit")}]},get disabled(){return Ee(()=>!i())()&&!s()}}),null),a(ie,R(Pn,{label:"",get value(){return ae.isAmountField?"variable":"fixed"},onChange:de=>{P(Y,"isAmountField",de==="variable"),de==="fixed"&&P(Y,"fixedAmount",0)},get options(){return[{value:"variable",label:e("journal.variable","Variable")},{value:"fixed",label:e("journal.fixed","Fixed")}]},get disabled(){return Ee(()=>!i())()&&!s()}}),null),a(ie,R(ze,{get when(){return ae.isAmountField},get fallback(){return R($r,{label:"",type:"number",get value(){return ae.fixedAmount?.toString()||"0"},onChange:de=>P(Y,"fixedAmount",parseFloat(de)||0),placeholder:"0.00",get disabled(){return Ee(()=>!i())()&&!s()}})},get children(){return R($r,{label:"",get value(){return ae.amountFieldName||""},onChange:de=>P(Y,"amountFieldName",de),get placeholder(){return e("journal.fieldNamePlaceholder","e.g., Monto")},get disabled(){return Ee(()=>!i())()&&!s()}})}}),null),a(ie,R(ze,{get when(){return i()||s()},get children(){return R(ht,{variant:"outline",size:"sm",onClick:()=>z(Y),get disabled(){return h().length<=2},style:{color:"var(--danger-color)"},get children(){return e("common.remove")}})}}),null),ie})()}}),null),B})(),Ee(()=>Ee(()=>!!g())()&&(()=>{var B=_f();return B.style.setProperty("padding","1rem"),B.style.setProperty("border-radius","var(--border-radius-sm)"),B.style.setProperty("margin-top","1rem"),B.style.setProperty("background","#f8d7da"),B.style.setProperty("color","#721c24"),B.style.setProperty("border","1px solid #f5c6cb"),a(B,g),B})())]}}),null),a(U,R(ze,{get when(){return Ee(()=>!r())()&&!s()},get children(){var B=H6(),ce=B.firstChild,L=ce.nextSibling;return B.style.setProperty("text-align","center"),B.style.setProperty("padding","3rem"),B.style.setProperty("color","var(--text-muted)"),a(ce,()=>e("journal.selectTemplateToView","Select a template from the list to view details")),a(L,()=>e("journal.orCreateNew","or create a new custom template")),B}}),null),F}})};br(["click"]);var K6=he("<div><div>⚠️</div><div></div><div></div><div>"),J6=he("<div><div></div><div></div><div></div><div></div><div>"),Q6=he("<div><button></button><button> (<!>)</button><button> (<!>/<!>)"),Sf=he("<div>"),X6=he("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><div><h4></h4><div></div></div><div>"),Pf=he("<div><span></span><span>"),Wd=he("<div><strong>:</strong> "),Z6=he("<div><div><div></div><div></div><div></div><div></div><div></div></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div></div></div><div><div><strong>🔗 </strong></div><div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div></div><div><div><strong>:</strong> </div><div><strong>:</strong> "),eL=he("<div><div><div></div><div></div></div><div></div><div></div><div></div><div>"),tL=he("<div><span>✓ "),rL=he("<span>(<!>)"),nL=he("<div><div>:"),iL=he("<div><div>⚠️ <!>:</div><div>"),oL=he("<div><div><div><span></span><h3></h3></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),sL=he("<div><h4>✅ <!> (<!>)"),aL=he("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div>✓ "),lL=he("<div>→ "),cL=he("<div><h4>⏳ <!> (<!>)"),uL=he("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div>⏳ "),dL=he("<div><div>💡 </div><div> ");const hL=t=>{const{t:e}=or(),[r,n]=Ce("details"),[i,o]=Ce(!1),s=Mt(()=>t.entryId?Eo.getJournalEntryById(t.entryId):null),l={"text-align":"center","margin-bottom":"2rem",position:"relative"},c={position:"absolute",top:"0",right:"0",display:"flex",gap:"0.5rem"},u={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","margin-bottom":"0.5rem"},h={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},y={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},g={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem",display:"inline-block"},f={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},x={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},S={"font-weight":"600",color:"var(--text-primary)"},w={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},E=_=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:_?"var(--primary-color)":"var(--text-muted)","border-bottom":_?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),q={display:"grid","grid-template-columns":"2fr 2.5fr 1fr 1fr 1.5fr",gap:"1rem",padding:"1rem 0","border-bottom":"1px solid var(--border-color)","align-items":"center"},ee={...q,"font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","border-bottom":"2px solid var(--border-color)"},W={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},K={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},te=_=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[_],$=_=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(_),C=_=>new Date(_).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),T=_=>new Date(_).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),O=()=>{s()?.status==="posted"&&!confirm(e("journal.confirmEditPosted","This entry has been posted. Editing will create a new draft copy. Continue?"))||o(!0)},b=()=>{if(s()&&confirm(e("journal.confirmPost","Are you sure you want to post this journal entry? This action cannot be undone.")))try{Eo.postJournalEntry(s().id)}catch(_){alert(_ instanceof Error?_.message:e("forms.errorPostingEntry","An error occurred while posting the entry"))}},P=()=>{s()&&confirm(e("journal.confirmVoid","Are you sure you want to void this journal entry?"))&&Eo.voidJournalEntry(s().id)};return[R(On,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.entryDetails","Journal Entry Details")},get children(){return Ee(()=>!s())()?(()=>{var _=K6(),z=_.firstChild,Z=z.nextSibling,k=Z.nextSibling,F=k.nextSibling;return _.style.setProperty("text-align","center"),_.style.setProperty("padding","3rem"),_.style.setProperty("color","var(--text-muted)"),z.style.setProperty("font-size","1.5rem"),z.style.setProperty("margin-bottom","1rem"),Z.style.setProperty("font-size","1.1rem"),Z.style.setProperty("margin-bottom","0.5rem"),a(Z,()=>e("journal.entryNotFound","Entry Not Found")),k.style.setProperty("font-size","0.875rem"),a(k,()=>e("journal.entryNotFoundMessage","The journal entry you're looking for could not be found or may have been deleted.")),F.style.setProperty("margin-top","2rem"),a(F,R(ht,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),_})():(()=>{const _=s(),z=te(_.status),Z=Math.abs(_.totalDebit-_.totalCredit)<.01;return[(()=>{var k=J6(),F=k.firstChild,X=F.nextSibling,U=X.nextSibling,B=U.nextSibling,ce=B.nextSibling;return m(k,l),a(F,R(ht,{variant:"outline",size:"sm",onClick:O,get title(){return e("journal.editEntryTooltip","Edit this journal entry")},get children(){return e("common.edit")}}),null),a(F,(()=>{var L=Ee(()=>_.status==="draft");return()=>L()&&R(ht,{variant:"primary",size:"sm",onClick:b,disabled:!Z,get title(){return Z?e("journal.postEntryTooltip","Post this journal entry"):e("journal.entryMustBeBalanced","Entry must be balanced to post")},get children(){return e("journal.post","Post")}})})(),null),a(F,(()=>{var L=Ee(()=>_.status==="posted");return()=>L()&&R(ht,{variant:"outline",size:"sm",onClick:P,style:{color:"#dc3545","border-color":"#dc3545"},get title(){return e("journal.voidEntryTooltip","Void this journal entry")},get children(){return e("entryBooks.void","Void")}})})(),null),m(X,u),a(X,()=>_.entryNumber),m(U,h),a(U,()=>_.description),m(B,y),a(B,()=>$(_.totalDebit)),a(ce,()=>e(`journal.${_.status}`,_.status)),Se(L=>{var D=c,j={...g,background:z.bg,color:z.color};return L.e=m(F,D,L.e),L.t=m(ce,j,L.t),L},{e:void 0,t:void 0}),k})(),(()=>{var k=Q6(),F=k.firstChild,X=F.nextSibling,U=X.firstChild,B=U.nextSibling;B.nextSibling;var ce=X.nextSibling,L=ce.firstChild,D=L.nextSibling,j=D.nextSibling,I=j.nextSibling;return I.nextSibling,m(k,w),F.$$click=()=>n("details"),a(F,()=>e("common.details")),X.$$click=()=>n("lines"),a(X,()=>e("journal.journalLines","Journal Lines"),U),a(X,()=>_.lines.length,B),ce.$$click=()=>n("reconciliation"),a(ce,()=>e("banking.reconciliation","Reconciliation"),L),a(ce,()=>_.lines.filter(M=>M.reconciled).length,D),a(ce,()=>_.lines.length,I),Se(M=>{var J=E(r()==="details"),H=E(r()==="lines"),Q=E(r()==="reconciliation");return M.e=m(F,J,M.e),M.t=m(X,H,M.t),M.a=m(ce,Q,M.a),M},{e:void 0,t:void 0,a:void 0}),k})(),Ee(()=>Ee(()=>r()==="details")()&&(()=>{var k=X6(),F=k.firstChild,X=F.firstChild,U=X.nextSibling,B=F.nextSibling,ce=B.firstChild,L=ce.nextSibling,D=B.nextSibling,j=D.firstChild,I=j.nextSibling,M=D.nextSibling,J=M.firstChild,H=J.nextSibling,Q=M.nextSibling,se=Q.firstChild,G=se.nextSibling,re=Q.nextSibling,oe=re.firstChild,fe=oe.nextSibling,ae=re.nextSibling,Y=ae.firstChild,ie=Y.nextSibling,de=ae.nextSibling,ue=de.firstChild,ge=ue.firstChild,Pe=ge.nextSibling,pe=ue.nextSibling;return a(X,()=>e("common.date")),a(U,()=>C(_.date)),a(ce,()=>e("journal.reference")),a(L,()=>_.reference||e("common.notAvailable","N/A")),a(j,()=>e("journal.totalDebit")),a(I,()=>$(_.totalDebit)),a(J,()=>e("journal.totalCredit")),a(H,()=>$(_.totalCredit)),a(se,()=>e("journal.balanceStatus","Balance Status")),a(G,()=>Z?`${e("journal.balanced")} ✓`:`${e("journal.unbalanced","Unbalanced")} (${$(Math.abs(_.totalDebit-_.totalCredit))} ${e("journal.difference","difference")})`),a(oe,()=>e("journal.createdBy")),a(fe,()=>_.createdBy),a(Y,()=>e("journal.createdAt","Created At")),a(ie,()=>T(_.createdAt)),a(k,(()=>{var _e=Ee(()=>!!_.postedAt);return()=>_e()&&(()=>{var Le=Pf(),De=Le.firstChild,Te=De.nextSibling;return a(De,()=>e("journal.postedAt","Posted At")),a(Te,()=>T(_.postedAt)),Se($e=>{var Ie=f,Re=x,Je=S;return $e.e=m(Le,Ie,$e.e),$e.t=m(De,Re,$e.t),$e.a=m(Te,Je,$e.a),$e},{e:void 0,t:void 0,a:void 0}),Le})()})(),de),de.style.setProperty("margin-top","2rem"),de.style.setProperty("padding-top","1rem"),de.style.setProperty("border-top","2px solid var(--border-color)"),ue.style.setProperty("display","flex"),ue.style.setProperty("justify-content","space-between"),ue.style.setProperty("align-items","center"),ue.style.setProperty("margin-bottom","1rem"),ge.style.setProperty("margin","0"),ge.style.setProperty("font-size","1rem"),a(ge,()=>e("journal.quickActions","Quick Actions")),Pe.style.setProperty("display","flex"),Pe.style.setProperty("gap","0.5rem"),a(Pe,R(ht,{variant:"primary",size:"sm",onClick:O,get children(){return["✏️ ",Ee(()=>e("journal.editEntry"))]}}),null),a(Pe,(()=>{var _e=Ee(()=>_.status==="draft");return()=>_e()&&R(ht,{variant:"outline",size:"sm",onClick:b,disabled:!Z,style:{"border-color":Z?"#4caf50":"#f44336",color:Z?"#4caf50":"#f44336"},get children(){return Z?`✓ ${e("journal.postEntry","Post Entry")}`:`⚠️ ${e("journal.fixBalance","Fix Balance")}`}})})(),null),a(Pe,(()=>{var _e=Ee(()=>_.status==="posted");return()=>_e()&&R(ht,{variant:"outline",size:"sm",onClick:P,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return["🗑️ ",Ee(()=>e("journal.voidEntry","Void Entry"))]}})})(),null),pe.style.setProperty("padding","1rem"),pe.style.setProperty("border-radius","var(--border-radius-sm)"),pe.style.setProperty("font-size","0.875rem"),a(pe,(()=>{var _e=Ee(()=>_.status==="draft");return()=>_e()&&(()=>{var Le=Wd(),De=Le.firstChild,Te=De.firstChild;return De.nextSibling,a(De,()=>e("journal.draftEntry","Draft Entry"),Te),a(Le,()=>e("journal.draftEntryDescription","This entry can be edited and posted."),null),a(Le,()=>!Z&&` ⚠️ ${e("journal.entryMustBeBalancedBeforePosting","Entry must be balanced before posting.")}`,null),Le})()})(),null),a(pe,(()=>{var _e=Ee(()=>_.status==="posted");return()=>_e()&&(()=>{var Le=Wd(),De=Le.firstChild,Te=De.firstChild;return De.nextSibling,a(De,()=>e("journal.postedEntry","Posted Entry"),Te),a(Le,()=>e("journal.postedEntryDescription","This entry has been posted to the general ledger. Editing will create a new draft copy."),null),Le})()})(),null),a(pe,(()=>{var _e=Ee(()=>_.status==="void");return()=>_e()&&(()=>{var Le=Wd(),De=Le.firstChild,Te=De.firstChild;return De.nextSibling,a(De,()=>e("journal.voidEntry"),Te),a(Le,()=>e("journal.voidEntryDescription","This entry has been voided and cannot be modified."),null),Le})()})(),null),Se(_e=>{var Le=f,De=x,Te=S,$e=f,Ie=x,Re=S,Je=f,Be=x,Ke=S,Xe=f,at=x,ot=S,Qe=f,dt=x,ct={...S,color:Z?"#4caf50":"#f44336"},kt=f,gt=x,qe=S,Dt=f,Rt=x,St=S,Bt=_.status==="draft"?"#fff3cd":_.status==="posted"?"#d4edda":"#f8d7da";return _e.e=m(F,Le,_e.e),_e.t=m(X,De,_e.t),_e.a=m(U,Te,_e.a),_e.o=m(B,$e,_e.o),_e.i=m(ce,Ie,_e.i),_e.n=m(L,Re,_e.n),_e.s=m(D,Je,_e.s),_e.h=m(j,Be,_e.h),_e.r=m(I,Ke,_e.r),_e.d=m(M,Xe,_e.d),_e.l=m(J,at,_e.l),_e.u=m(H,ot,_e.u),_e.c=m(Q,Qe,_e.c),_e.w=m(se,dt,_e.w),_e.m=m(G,ct,_e.m),_e.f=m(re,kt,_e.f),_e.y=m(oe,gt,_e.y),_e.g=m(fe,qe,_e.g),_e.p=m(ae,Dt,_e.p),_e.b=m(Y,Rt,_e.b),_e.T=m(ie,St,_e.T),Bt!==_e.A&&((_e.A=Bt)!=null?pe.style.setProperty("background",Bt):pe.style.removeProperty("background")),_e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),k})()),Ee(()=>Ee(()=>r()==="lines")()&&(()=>{var k=Z6(),F=k.firstChild,X=F.firstChild,U=X.nextSibling,B=U.nextSibling,ce=B.nextSibling,L=ce.nextSibling,D=F.nextSibling,j=D.firstChild,I=j.firstChild,M=I.firstChild;I.nextSibling;var J=j.nextSibling,H=J.firstChild,Q=H.firstChild;H.nextSibling;var se=J.nextSibling,G=D.nextSibling,re=G.firstChild,oe=re.firstChild;oe.firstChild;var fe=re.nextSibling,ae=fe.firstChild,Y=ae.firstChild,ie=Y.firstChild,de=ie.firstChild;ie.nextSibling;var ue=Y.nextSibling,ge=ue.firstChild,Pe=ge.firstChild;ge.nextSibling;var pe=ue.nextSibling,_e=pe.firstChild,Le=_e.firstChild;_e.nextSibling;var De=ae.nextSibling,Te=De.firstChild,$e=Te.firstChild,Ie=$e.firstChild;$e.nextSibling;var Re=Te.nextSibling,Je=Re.firstChild,Be=Je.firstChild;return Je.nextSibling,a(X,()=>e("journal.account")),a(U,()=>e("common.description")),a(B,()=>e("journal.debit")),a(ce,()=>e("journal.credit")),a(L,()=>e("banking.reconciliation")),a(k,R(Ut,{get each(){return _.lines},children:Ke=>(()=>{var Xe=eL(),at=Xe.firstChild,ot=at.firstChild,Qe=ot.nextSibling,dt=at.nextSibling,ct=dt.nextSibling,kt=ct.nextSibling,gt=kt.nextSibling;return ot.style.setProperty("font-weight","500"),a(ot,()=>Ke.accountName),Qe.style.setProperty("font-size","0.75rem"),Qe.style.setProperty("color","var(--text-muted)"),a(Qe,()=>kr.getAccountById(Ke.accountId)?.accountNumber||Ke.accountId),dt.style.setProperty("font-size","0.875rem"),a(dt,()=>Ke.description||"-"),ct.style.setProperty("font-weight","600"),a(ct,(()=>{var qe=Ee(()=>Ke.debitAmount>0);return()=>qe()?$(Ke.debitAmount):"-"})()),kt.style.setProperty("font-weight","600"),a(kt,(()=>{var qe=Ee(()=>Ke.creditAmount>0);return()=>qe()?$(Ke.creditAmount):"-"})()),a(gt,(()=>{var qe=Ee(()=>!!Ke.reconciled);return()=>qe()?(()=>{var Dt=tL(),Rt=Dt.firstChild;return Rt.firstChild,Dt.style.setProperty("display","flex"),Dt.style.setProperty("align-items","center"),Dt.style.setProperty("gap","0.5rem"),Dt.style.setProperty("color","#4caf50"),Dt.style.setProperty("font-size","0.875rem"),Rt.style.setProperty("font-weight","600"),a(Rt,()=>e("banking.reconciled"),null),a(Dt,(()=>{var St=Ee(()=>!!Ke.reconciledWith);return()=>St()&&(()=>{var Bt=rL(),fr=Bt.firstChild,Qt=fr.nextSibling;return Qt.nextSibling,Bt.style.setProperty("font-size","0.75rem"),Bt.style.setProperty("color","var(--text-muted)"),Bt.style.setProperty("font-style","italic"),a(Bt,()=>Ke.reconciledWith,Qt),Bt})()})(),null),Dt})():(()=>{var Dt=Sf();return Dt.style.setProperty("color","var(--text-muted)"),Dt.style.setProperty("font-size","0.875rem"),a(Dt,()=>e("banking.notReconciled","Not Reconciled")),Dt})()})()),Se(qe=>{var Dt=q,Rt=Ke.debitAmount>0?"#4caf50":"var(--text-muted)",St=Ke.creditAmount>0?"#f44336":"var(--text-muted)";return qe.e=m(Xe,Dt,qe.e),Rt!==qe.t&&((qe.t=Rt)!=null?ct.style.setProperty("color",Rt):ct.style.removeProperty("color")),St!==qe.a&&((qe.a=St)!=null?kt.style.setProperty("color",St):kt.style.removeProperty("color")),qe},{e:void 0,t:void 0,a:void 0}),Xe})()}),D),m(D,W),a(I,()=>e("journal.totalDebit"),M),a(j,()=>$(_.totalDebit),null),a(H,()=>e("journal.totalCredit"),Q),a(J,()=>$(_.totalCredit),null),(Z?"#4caf50":"#f44336")!=null?se.style.setProperty("color",Z?"#4caf50":"#f44336"):se.style.removeProperty("color"),se.style.setProperty("font-weight","600"),a(se,()=>Z?`✓ ${e("journal.balanced")}`:`⚠️ ${e("journal.notBalanced","Not Balanced")}`),G.style.setProperty("margin-top","1rem"),G.style.setProperty("padding","1rem"),G.style.setProperty("border-radius","var(--border-radius-sm)"),G.style.setProperty("font-size","0.875rem"),re.style.setProperty("margin-bottom","0.5rem"),a(oe,()=>e("journal.reconciliationSummary","Reconciliation Summary"),null),fe.style.setProperty("display","grid"),fe.style.setProperty("grid-template-columns","1fr 1fr"),fe.style.setProperty("gap","1rem"),Y.style.setProperty("margin-bottom","0.25rem"),a(ie,()=>e("journal.totalLines","Total Lines"),de),a(Y,()=>_.lines.length,null),ue.style.setProperty("margin-bottom","0.25rem"),ue.style.setProperty("color","#4caf50"),a(ge,()=>e("journal.reconciled","Reconciled"),Pe),a(ue,()=>_.lines.filter(Ke=>Ke.reconciled).length,null),pe.style.setProperty("color","#f44336"),a(_e,()=>e("journal.unreconciled","Unreconciled"),Le),a(pe,()=>_.lines.filter(Ke=>!Ke.reconciled).length,null),Te.style.setProperty("margin-bottom","0.25rem"),a($e,()=>e("journal.bankAccounts","Bank Accounts"),Ie),a(Te,()=>_.lines.filter(Ke=>["1001","1002","1003"].includes(Ke.accountId)).length,null),Re.style.setProperty("margin-bottom","0.25rem"),Re.style.setProperty("color","#4caf50"),a(Je,()=>e("journal.bankReconciled","Bank Reconciled"),Be),a(Re,()=>_.lines.filter(Ke=>["1001","1002","1003"].includes(Ke.accountId)&&Ke.reconciled).length,null),a(De,(()=>{var Ke=Ee(()=>_.lines.filter(Xe=>["1001","1002","1003"].includes(Xe.accountId)&&!Xe.reconciled).length>0);return()=>Ke()&&(()=>{var Xe=Wd(),at=Xe.firstChild,ot=at.firstChild;return at.nextSibling,Xe.style.setProperty("color","#f44336"),a(at,()=>e("journal.bankPending","Bank Pending"),ot),a(Xe,()=>_.lines.filter(Qe=>["1001","1002","1003"].includes(Qe.accountId)&&!Qe.reconciled).length,null),Xe})()})(),null),a(G,(()=>{var Ke=Ee(()=>_.lines.filter(Xe=>Xe.reconciled).length>0);return()=>Ke()&&(()=>{var Xe=nL(),at=Xe.firstChild,ot=at.firstChild;return Xe.style.setProperty("margin-top","0.75rem"),Xe.style.setProperty("padding-top","0.75rem"),Xe.style.setProperty("border-top","1px solid var(--border-color)"),at.style.setProperty("margin-bottom","0.5rem"),at.style.setProperty("font-weight","500"),a(at,()=>e("journal.reconciledLines","Reconciled Lines"),ot),a(Xe,()=>_.lines.filter(Qe=>Qe.reconciled).map(Qe=>(()=>{var dt=Pf(),ct=dt.firstChild,kt=ct.nextSibling;return dt.style.setProperty("display","flex"),dt.style.setProperty("justify-content","space-between"),dt.style.setProperty("margin-bottom","0.25rem"),dt.style.setProperty("font-size","0.8rem"),a(ct,()=>Qe.accountName),kt.style.setProperty("color","var(--text-muted)"),a(kt,(()=>{var gt=Ee(()=>!!Qe.reconciledWith);return()=>gt()?`→ ${Qe.reconciledWith}`:e("journal.manual","Manual")})()),dt})()),null),Xe})()})(),null),a(G,(()=>{var Ke=Ee(()=>_.lines.filter(Xe=>!Xe.reconciled&&["1001","1002","1003"].includes(Xe.accountId)).length>0);return()=>Ke()&&(()=>{var Xe=iL(),at=Xe.firstChild,ot=at.firstChild,Qe=ot.nextSibling;Qe.nextSibling;var dt=at.nextSibling;return Xe.style.setProperty("margin-top","0.75rem"),Xe.style.setProperty("padding-top","0.75rem"),Xe.style.setProperty("border-top","1px solid var(--border-color)"),at.style.setProperty("margin-bottom","0.5rem"),at.style.setProperty("font-weight","500"),at.style.setProperty("color","#f44336"),a(at,()=>e("journal.pendingBankReconciliation","Pending Bank Reconciliation"),Qe),a(Xe,()=>_.lines.filter(ct=>!ct.reconciled&&["1001","1002","1003"].includes(ct.accountId)).map(ct=>(()=>{var kt=Pf(),gt=kt.firstChild,qe=gt.nextSibling;return kt.style.setProperty("display","flex"),kt.style.setProperty("justify-content","space-between"),kt.style.setProperty("margin-bottom","0.25rem"),kt.style.setProperty("font-size","0.8rem"),kt.style.setProperty("color","#f44336"),a(gt,()=>ct.accountName),a(qe,()=>$(ct.debitAmount||ct.creditAmount)),kt})()),dt),dt.style.setProperty("margin-top","0.5rem"),dt.style.setProperty("font-size","0.75rem"),dt.style.setProperty("color","var(--text-muted)"),dt.style.setProperty("font-style","italic"),a(dt,()=>e("journal.visitBankConsolidations","Visit Bank Consolidations to reconcile these transactions")),Xe})()})(),null),Se(Ke=>{var Xe=ee,at=_.lines.some(ot=>ot.reconciled)?"#e8f5e8":"#fff3cd";return Ke.e=m(F,Xe,Ke.e),at!==Ke.t&&((Ke.t=at)!=null?G.style.setProperty("background",at):G.style.removeProperty("background")),Ke},{e:void 0,t:void 0}),k})()),Ee(()=>Ee(()=>r()==="reconciliation")()&&(()=>{var k=oL(),F=k.firstChild,X=F.firstChild,U=X.firstChild,B=U.nextSibling,ce=X.nextSibling,L=ce.firstChild,D=L.firstChild,j=D.nextSibling,I=L.nextSibling,M=I.firstChild,J=M.nextSibling,H=I.nextSibling,Q=H.firstChild,se=Q.nextSibling;return F.style.setProperty("margin-bottom","1.5rem"),F.style.setProperty("padding","1rem"),F.style.setProperty("border-radius","var(--border-radius)"),F.style.setProperty("border","1px solid var(--border-color)"),X.style.setProperty("display","flex"),X.style.setProperty("align-items","center"),X.style.setProperty("gap","0.5rem"),X.style.setProperty("margin-bottom","1rem"),U.style.setProperty("font-size","1.5rem"),a(U,(()=>{var G=Ee(()=>!!_.lines.every(re=>re.reconciled));return()=>G()?"✅":_.lines.some(re=>re.reconciled)?"🔄":"⏳"})()),B.style.setProperty("margin","0"),B.style.setProperty("font-size","1.2rem"),a(B,(()=>{var G=Ee(()=>!!_.lines.every(re=>re.reconciled));return()=>G()?e("journal.fullyReconciled","Fully Reconciled"):Ee(()=>!!_.lines.some(re=>re.reconciled))()?e("journal.partiallyReconciled","Partially Reconciled"):e("journal.unreconciled","Unreconciled")})()),ce.style.setProperty("display","grid"),ce.style.setProperty("grid-template-columns","1fr 1fr 1fr"),ce.style.setProperty("gap","1rem"),L.style.setProperty("text-align","center"),D.style.setProperty("font-size","2rem"),D.style.setProperty("font-weight","700"),D.style.setProperty("color","var(--primary-color)"),a(D,()=>_.lines.length),j.style.setProperty("font-size","0.875rem"),j.style.setProperty("color","var(--text-muted)"),a(j,()=>e("journal.totalLines","Total Lines")),I.style.setProperty("text-align","center"),M.style.setProperty("font-size","2rem"),M.style.setProperty("font-weight","700"),M.style.setProperty("color","#4caf50"),a(M,()=>_.lines.filter(G=>G.reconciled).length),J.style.setProperty("font-size","0.875rem"),J.style.setProperty("color","var(--text-muted)"),a(J,()=>e("journal.reconciled","Reconciled")),H.style.setProperty("text-align","center"),Q.style.setProperty("font-size","2rem"),Q.style.setProperty("font-weight","700"),Q.style.setProperty("color","#f44336"),a(Q,()=>_.lines.filter(G=>!G.reconciled).length),se.style.setProperty("font-size","0.875rem"),se.style.setProperty("color","var(--text-muted)"),a(se,()=>e("journal.pending","Pending")),a(k,(()=>{var G=Ee(()=>_.lines.filter(re=>re.reconciled).length>0);return()=>G()&&(()=>{var re=sL(),oe=re.firstChild,fe=oe.firstChild,ae=fe.nextSibling,Y=ae.nextSibling,ie=Y.nextSibling;return ie.nextSibling,re.style.setProperty("margin-bottom","1.5rem"),oe.style.setProperty("margin","0 0 1rem 0"),oe.style.setProperty("font-size","1.1rem"),oe.style.setProperty("color","#4caf50"),oe.style.setProperty("display","flex"),oe.style.setProperty("align-items","center"),oe.style.setProperty("gap","0.5rem"),a(oe,()=>e("journal.reconciledLines","Reconciled Lines"),ae),a(oe,()=>_.lines.filter(de=>de.reconciled).length,ie),a(re,()=>_.lines.filter(de=>de.reconciled).map(de=>(()=>{var ue=aL(),ge=ue.firstChild,Pe=ge.firstChild,pe=Pe.nextSibling,_e=ge.nextSibling,Le=_e.nextSibling,De=Le.nextSibling,Te=De.nextSibling,$e=Te.firstChild;return $e.firstChild,ue.style.setProperty("display","grid"),ue.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),ue.style.setProperty("gap","1rem"),ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("margin-bottom","0.5rem"),ue.style.setProperty("background","#f0f9f0"),ue.style.setProperty("border-radius","var(--border-radius-sm)"),ue.style.setProperty("align-items","center"),ue.style.setProperty("font-size","0.875rem"),Pe.style.setProperty("font-weight","500"),a(Pe,()=>de.accountName),pe.style.setProperty("font-size","0.75rem"),pe.style.setProperty("color","var(--text-muted)"),a(pe,()=>kr.getAccountById(de.accountId)?.accountNumber),_e.style.setProperty("color","var(--text-muted)"),a(_e,()=>de.description||e("journal.noDescription","No description")),Le.style.setProperty("font-weight","600"),a(Le,(()=>{var Ie=Ee(()=>de.debitAmount>0);return()=>Ie()?$(de.debitAmount):"-"})()),De.style.setProperty("font-weight","600"),a(De,(()=>{var Ie=Ee(()=>de.creditAmount>0);return()=>Ie()?$(de.creditAmount):"-"})()),Te.style.setProperty("color","#4caf50"),$e.style.setProperty("font-weight","500"),a($e,()=>e("journal.matched","Matched"),null),a(Te,(()=>{var Ie=Ee(()=>!!de.reconciledWith);return()=>Ie()&&(()=>{var Re=lL();return Re.firstChild,Re.style.setProperty("font-size","0.75rem"),Re.style.setProperty("font-style","italic"),a(Re,()=>de.reconciledWith,null),Re})()})(),null),Se(Ie=>{var Re=de.debitAmount>0?"#4caf50":"var(--text-muted)",Je=de.creditAmount>0?"#f44336":"var(--text-muted)";return Re!==Ie.e&&((Ie.e=Re)!=null?Le.style.setProperty("color",Re):Le.style.removeProperty("color")),Je!==Ie.t&&((Ie.t=Je)!=null?De.style.setProperty("color",Je):De.style.removeProperty("color")),Ie},{e:void 0,t:void 0}),ue})()),null),re})()})(),null),a(k,(()=>{var G=Ee(()=>_.lines.filter(re=>!re.reconciled).length>0);return()=>G()&&(()=>{var re=cL(),oe=re.firstChild,fe=oe.firstChild,ae=fe.nextSibling,Y=ae.nextSibling,ie=Y.nextSibling;return ie.nextSibling,re.style.setProperty("margin-bottom","1.5rem"),oe.style.setProperty("margin","0 0 1rem 0"),oe.style.setProperty("font-size","1.1rem"),oe.style.setProperty("color","#f44336"),oe.style.setProperty("display","flex"),oe.style.setProperty("align-items","center"),oe.style.setProperty("gap","0.5rem"),a(oe,()=>e("journal.unreconciledLines","Unreconciled Lines"),ae),a(oe,()=>_.lines.filter(de=>!de.reconciled).length,ie),a(re,()=>_.lines.filter(de=>!de.reconciled).map(de=>(()=>{var ue=uL(),ge=ue.firstChild,Pe=ge.firstChild,pe=Pe.nextSibling,_e=ge.nextSibling,Le=_e.nextSibling,De=Le.nextSibling,Te=De.nextSibling,$e=Te.firstChild;return $e.firstChild,ue.style.setProperty("display","grid"),ue.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),ue.style.setProperty("gap","1rem"),ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("margin-bottom","0.5rem"),ue.style.setProperty("background","#fff9f0"),ue.style.setProperty("border-radius","var(--border-radius-sm)"),ue.style.setProperty("align-items","center"),ue.style.setProperty("font-size","0.875rem"),ue.style.setProperty("border","1px solid #ffe0b3"),Pe.style.setProperty("font-weight","500"),a(Pe,()=>de.accountName),pe.style.setProperty("font-size","0.75rem"),pe.style.setProperty("color","var(--text-muted)"),a(pe,()=>kr.getAccountById(de.accountId)?.accountNumber),_e.style.setProperty("color","var(--text-muted)"),a(_e,()=>de.description||e("journal.noDescription","No description")),Le.style.setProperty("font-weight","600"),a(Le,(()=>{var Ie=Ee(()=>de.debitAmount>0);return()=>Ie()?$(de.debitAmount):"-"})()),De.style.setProperty("font-weight","600"),a(De,(()=>{var Ie=Ee(()=>de.creditAmount>0);return()=>Ie()?$(de.creditAmount):"-"})()),Te.style.setProperty("color","#f44336"),$e.style.setProperty("font-weight","500"),a($e,()=>e("journal.pending","Pending"),null),a(Te,(()=>{var Ie=Ee(()=>!!["1001","1002","1003"].includes(de.accountId));return()=>Ie()&&(()=>{var Re=Sf();return Re.style.setProperty("font-size","0.75rem"),Re.style.setProperty("font-style","italic"),a(Re,()=>e("journal.bankAccount","Bank account")),Re})()})(),null),Se(Ie=>{var Re=de.debitAmount>0?"#4caf50":"var(--text-muted)",Je=de.creditAmount>0?"#f44336":"var(--text-muted)";return Re!==Ie.e&&((Ie.e=Re)!=null?Le.style.setProperty("color",Re):Le.style.removeProperty("color")),Je!==Ie.t&&((Ie.t=Je)!=null?De.style.setProperty("color",Je):De.style.removeProperty("color")),Ie},{e:void 0,t:void 0}),ue})()),null),a(re,(()=>{var de=Ee(()=>_.lines.filter(ue=>!ue.reconciled&&["1001","1002","1003"].includes(ue.accountId)).length>0);return()=>de()&&(()=>{var ue=dL(),ge=ue.firstChild;ge.firstChild;var Pe=ge.nextSibling,pe=Pe.firstChild;return ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("background","#ffebee"),ue.style.setProperty("border-radius","var(--border-radius-sm)"),ue.style.setProperty("margin-top","1rem"),ue.style.setProperty("border","1px solid #ffcdd2"),ge.style.setProperty("font-weight","500"),ge.style.setProperty("margin-bottom","0.5rem"),ge.style.setProperty("color","#f44336"),a(ge,()=>e("journal.reconciliationTip","Reconciliation Tip"),null),Pe.style.setProperty("font-size","0.875rem"),Pe.style.setProperty("color","var(--text-muted)"),a(Pe,()=>e("journal.unreconciledBankTransactions","This entry has unreconciled bank account transactions."),pe),a(Pe,()=>e("journal.visitBankConsolidations","Visit Bank Consolidations to reconcile these transactions"),null),ue})()})(),null),re})()})(),null),Se(G=>(G=_.lines.every(re=>re.reconciled)?"#e8f5e8":_.lines.some(re=>re.reconciled)?"#fff3cd":"#ffebee")!=null?F.style.setProperty("background",G):F.style.removeProperty("background")),k})()),(()=>{var k=Sf();return m(k,K),a(k,R(ht,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),a(k,R(ht,{variant:"primary",onClick:O,get children(){return e("journal.editEntry")}}),null),a(k,(()=>{var F=Ee(()=>_.status==="draft");return()=>F()&&R(ht,{variant:"outline",onClick:b,disabled:!Z,style:{"border-color":"#4caf50",color:Z?"#4caf50":"var(--text-muted)"},get children(){return Z?e("journal.postEntry","Post Entry"):e("journal.entryNotBalanced","Entry Not Balanced")}})})(),null),a(k,(()=>{var F=Ee(()=>_.status==="posted");return()=>F()&&R(ht,{variant:"outline",onClick:P,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return e("journal.voidEntry","Void Entry")}})})(),null),k})()]})()}}),Ee(()=>Ee(()=>!!s())()&&R(D5,{get isOpen(){return i()},onClose:()=>{o(!1)},get editEntry(){return s()}}))]};br(["click"]);var pL=he("<div><div><h2></h2><p></p></div><div>"),bs=he("<div>"),fL=he("<div> <!> • <!> "),mL=he("<div><div><label></label></div><div><label></label></div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label></div><div>"),yL=he("<div><span>:</span><span> "),Yd=he("<span>: "),gL=he("<div><br>");const vL=()=>{const{t}=or(),[e,r]=Ce(!1),[n,i]=Ce(!1),[o,s]=Ce(!1),[l,c]=Ce(null),[u,h]=Ce(!1),[y,g]=Ce(null),[f,x]=Ce("all"),[S,w]=Ce("all"),[E,q]=Ce(""),[ee,W]=Ce(""),[K,te]=Ce("date"),[$,C]=Ce("desc"),T={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},O={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)","flex-wrap":"wrap"},b={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem"},P={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(400px, 1fr))",gap:"1.5rem"},_=()=>[{value:"all",label:t("journal.allEntries","All Entries")},{value:"draft",label:t("journal.draft")},{value:"posted",label:t("journal.posted")},{value:"void",label:t("entryBooks.void","Void")}],z=()=>[{value:"all",label:t("accounts.allAccounts","All Accounts")},...kr.accounts.map(I=>({value:I.id,label:`${I.accountNumber} - ${I.name}`}))],Z=()=>[{value:"date",label:t("common.date")},{value:"entryNumber",label:t("journal.entryNumber")},{value:"amount",label:t("common.amount")}],k=()=>{let I=Eo.journalEntries;return f()!=="all"&&(I=I.filter(M=>M.status===f())),S()!=="all"&&(I=I.filter(M=>M.lines.some(J=>J.accountId===S()))),E()&&(I=I.filter(M=>M.date>=E())),ee()&&(I=I.filter(M=>M.date<=ee())),I=[...I].sort((M,J)=>{let H=0;switch(K()){case"date":H=new Date(M.date).getTime()-new Date(J.date).getTime();break;case"entryNumber":H=M.entryNumber.localeCompare(J.entryNumber);break;case"amount":H=M.totalDebit-J.totalDebit;break}return $()==="asc"?H:-H}),I},F=()=>{const I=Eo.journalEntries,M=I.filter(re=>re.status==="draft"),J=I.filter(re=>re.status==="posted"),H=I.filter(re=>re.status==="void"),Q=J.reduce((re,oe)=>re+oe.totalDebit,0),se=J.reduce((re,oe)=>re+oe.totalCredit,0),G=I.filter(re=>re.lines.some(oe=>["1001","1002","1003"].includes(oe.accountId)&&!oe.reconciled)).length;return{totalEntries:I.length,draftEntries:M.length,postedEntries:J.length,voidEntries:H.length,totalDebit:Q,totalCredit:se,unreconciledEntries:G}},X=I=>{g(I.id),h(!0)},U=()=>{c(null),r(!0)},B=()=>{i(!0)},ce=()=>{r(!1),c(null)},L=I=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(I),D=F(),j=k();return R(to,{get title(){return t("entryBooks.title")},get children(){return[(()=>{var I=pL(),M=I.firstChild,J=M.firstChild,H=J.nextSibling,Q=M.nextSibling;return m(I,T),J.style.setProperty("margin","0 0 0.5rem 0"),J.style.setProperty("font-size","1.5rem"),a(J,()=>t("journal.title")),H.style.setProperty("margin","0"),H.style.setProperty("color","var(--text-muted)"),a(H,()=>t("entryBooks.subtitle","Manage accounting entries and general ledger records")),Q.style.setProperty("display","flex"),Q.style.setProperty("gap","1rem"),a(Q,R(ht,{variant:"secondary",onClick:()=>window.location.href="/bank-consolidations",get children(){return t("entryBooks.viewReconciliation","View Reconciliation")}}),null),a(Q,R(ht,{variant:"outline",onClick:B,style:{background:"#4caf50",color:"white","border-color":"#4caf50"},get children(){return["⚡ ",Ee(()=>t("journal.quickEntry","Quick Entry"))]}}),null),a(Q,R(ht,{variant:"outline",onClick:()=>s(!0),get title(){return t("journal.manageTemplates","Manage Templates")},get children(){return["⚙️ ",Ee(()=>t("journal.templates","Templates"))]}}),null),a(Q,R(ht,{variant:"primary",onClick:U,get children(){return t("journal.addEntry","Add Journal Entry")}}),null),I})(),(()=>{var I=bs();return m(I,b),a(I,R(Ot,{get title(){return t("entryBooks.totalEntries","Total Entries")},get subtitle(){return t("entryBooks.allJournalEntries","All journal entries")},get children(){return[(()=>{var M=bs();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","var(--primary-color)"),M.style.setProperty("margin-bottom","0.5rem"),a(M,()=>D.totalEntries),M})(),(()=>{var M=fL(),J=M.firstChild,H=J.nextSibling,Q=H.nextSibling,se=Q.nextSibling;return se.nextSibling,M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","var(--text-muted)"),a(M,()=>D.postedEntries,J),a(M,()=>t("journal.posted").toLowerCase(),H),a(M,()=>D.draftEntries,se),a(M,()=>t("journal.draft").toLowerCase(),null),a(M,(()=>{var G=Ee(()=>D.voidEntries>0);return()=>G()&&` • ${D.voidEntries} ${t("entryBooks.void","void").toLowerCase()}`})(),null),M})()]}}),null),a(I,R(Ot,{get title(){return t("journal.totalDebits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var M=bs();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","#4caf50"),M.style.setProperty("margin-bottom","0.5rem"),a(M,()=>L(D.totalDebit)),M})(),(()=>{var M=bs();return M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","var(--text-muted)"),a(M,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",D.postedEntries.toString())),M})()]}}),null),a(I,R(Ot,{get title(){return t("journal.totalCredits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var M=bs();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","#f44336"),M.style.setProperty("margin-bottom","0.5rem"),a(M,()=>L(D.totalCredit)),M})(),(()=>{var M=bs();return M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","var(--text-muted)"),a(M,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",D.postedEntries.toString())),M})()]}}),null),a(I,R(Ot,{get title(){return t("banking.unreconciled","Unreconciled")},get subtitle(){return t("banking.title")},get children(){return[(()=>{var M=bs();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("margin-bottom","0.5rem"),a(M,()=>D.unreconciledEntries),Se(J=>(J=D.unreconciledEntries>0?"#ff9800":"#4caf50")!=null?M.style.setProperty("color",J):M.style.removeProperty("color")),M})(),(()=>{var M=bs();return M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","var(--text-muted)"),a(M,(()=>{var J=Ee(()=>D.unreconciledEntries>0);return()=>J()?t("entryBooks.needBankReconciliation","Need bank reconciliation"):t("entryBooks.allReconciled","All reconciled")})()),M})()]}}),null),I})(),(()=>{var I=mL(),M=I.firstChild,J=M.firstChild,H=M.nextSibling,Q=H.firstChild,se=H.nextSibling,G=se.firstChild,re=se.nextSibling,oe=re.firstChild,fe=oe.nextSibling,ae=re.nextSibling,Y=ae.firstChild,ie=Y.nextSibling,de=ae.nextSibling,ue=de.firstChild,ge=de.nextSibling;return m(I,O),M.style.setProperty("min-width","150px"),J.style.setProperty("display","block"),J.style.setProperty("margin-bottom","0.5rem"),J.style.setProperty("font-weight","500"),J.style.setProperty("font-size","0.875rem"),a(J,()=>t("common.status")),a(M,R(Pn,{label:"",get value(){return f()},onChange:x,get options(){return _()}}),null),H.style.setProperty("min-width","200px"),Q.style.setProperty("display","block"),Q.style.setProperty("margin-bottom","0.5rem"),Q.style.setProperty("font-weight","500"),Q.style.setProperty("font-size","0.875rem"),a(Q,()=>t("journal.account")),a(H,R(Pn,{label:"",get value(){return S()},onChange:w,get options(){return z()}}),null),se.style.setProperty("min-width","120px"),G.style.setProperty("display","block"),G.style.setProperty("margin-bottom","0.5rem"),G.style.setProperty("font-weight","500"),G.style.setProperty("font-size","0.875rem"),a(G,()=>t("entryBooks.sortBy","Sort By")),a(se,R(Pn,{label:"",get value(){return K()},onChange:te,get options(){return Z()}}),null),re.style.setProperty("min-width","130px"),oe.style.setProperty("display","block"),oe.style.setProperty("margin-bottom","0.5rem"),oe.style.setProperty("font-weight","500"),oe.style.setProperty("font-size","0.875rem"),a(oe,()=>t("entryBooks.fromDate","From Date")),fe.addEventListener("change",Pe=>q(Pe.target.value)),fe.style.setProperty("padding","0.75rem"),fe.style.setProperty("border","1px solid var(--border-color)"),fe.style.setProperty("border-radius","var(--border-radius-sm)"),fe.style.setProperty("font-family","inherit"),fe.style.setProperty("width","100%"),ae.style.setProperty("min-width","130px"),Y.style.setProperty("display","block"),Y.style.setProperty("margin-bottom","0.5rem"),Y.style.setProperty("font-weight","500"),Y.style.setProperty("font-size","0.875rem"),a(Y,()=>t("entryBooks.toDate","To Date")),ie.addEventListener("change",Pe=>W(Pe.target.value)),ie.style.setProperty("padding","0.75rem"),ie.style.setProperty("border","1px solid var(--border-color)"),ie.style.setProperty("border-radius","var(--border-radius-sm)"),ie.style.setProperty("font-family","inherit"),ie.style.setProperty("width","100%"),de.style.setProperty("min-width","100px"),ue.style.setProperty("display","block"),ue.style.setProperty("margin-bottom","0.5rem"),ue.style.setProperty("font-weight","500"),ue.style.setProperty("font-size","0.875rem"),a(ue,()=>t("entryBooks.order","Order")),a(de,R(Pn,{label:"",get value(){return $()},onChange:C,get options(){return[{value:"desc",label:t("entryBooks.newest","Newest")},{value:"asc",label:t("entryBooks.oldest","Oldest")}]}}),null),ge.style.setProperty("display","flex"),ge.style.setProperty("align-items","end"),ge.style.setProperty("gap","0.5rem"),a(ge,R(ht,{variant:"outline",size:"sm",onClick:()=>{x("all"),w("all"),q(""),W(""),te("date"),C("desc")},get children(){return t("entryBooks.resetFilters","Reset Filters")}})),Se(()=>fe.value=E()),Se(()=>ie.value=ee()),I})(),Ee(()=>Ee(()=>!!(f()!=="all"||S()!=="all"||E()||ee()))()&&(()=>{var I=yL(),M=I.firstChild,J=M.firstChild,H=M.nextSibling,Q=H.firstChild;return I.style.setProperty("display","flex"),I.style.setProperty("gap","0.5rem"),I.style.setProperty("align-items","center"),I.style.setProperty("margin-bottom","1rem"),I.style.setProperty("padding","0.75rem"),I.style.setProperty("background","var(--surface-color)"),I.style.setProperty("border-radius","var(--border-radius-sm)"),I.style.setProperty("border","1px solid var(--border-color)"),M.style.setProperty("font-size","0.875rem"),M.style.setProperty("font-weight","500"),a(M,()=>t("entryBooks.activeFilters","Active filters"),J),a(I,(()=>{var se=Ee(()=>f()!=="all");return()=>se()&&(()=>{var G=Yd(),re=G.firstChild;return G.style.setProperty("padding","0.25rem 0.5rem"),G.style.setProperty("background","var(--primary-color)"),G.style.setProperty("color","white"),G.style.setProperty("border-radius","12px"),G.style.setProperty("font-size","0.75rem"),a(G,()=>t("common.status"),re),a(G,f,null),G})()})(),H),a(I,(()=>{var se=Ee(()=>S()!=="all");return()=>se()&&(()=>{var G=Yd(),re=G.firstChild;return G.style.setProperty("padding","0.25rem 0.5rem"),G.style.setProperty("background","var(--primary-color)"),G.style.setProperty("color","white"),G.style.setProperty("border-radius","12px"),G.style.setProperty("font-size","0.75rem"),a(G,()=>t("journal.account"),re),a(G,()=>kr.getAccountById(S())?.name||t("common.unknown","Unknown"),null),G})()})(),H),a(I,(()=>{var se=Ee(()=>!!E());return()=>se()&&(()=>{var G=Yd(),re=G.firstChild;return G.style.setProperty("padding","0.25rem 0.5rem"),G.style.setProperty("background","var(--primary-color)"),G.style.setProperty("color","white"),G.style.setProperty("border-radius","12px"),G.style.setProperty("font-size","0.75rem"),a(G,()=>t("entryBooks.from","From"),re),a(G,E,null),G})()})(),H),a(I,(()=>{var se=Ee(()=>!!ee());return()=>se()&&(()=>{var G=Yd(),re=G.firstChild;return G.style.setProperty("padding","0.25rem 0.5rem"),G.style.setProperty("background","var(--primary-color)"),G.style.setProperty("color","white"),G.style.setProperty("border-radius","12px"),G.style.setProperty("font-size","0.75rem"),a(G,()=>t("entryBooks.to","To"),re),a(G,ee,null),G})()})(),H),H.style.setProperty("margin-left","auto"),H.style.setProperty("font-size","0.875rem"),H.style.setProperty("color","var(--text-muted)"),a(H,()=>j.length,Q),a(H,()=>t("entryBooks.entriesFound","{count} entries found").replace("{count}",j.length.toString()),null),I})()),Ee(()=>Ee(()=>j.length===0)()?R(Ot,{get title(){return t("entryBooks.noJournalEntries","No Journal Entries")},get subtitle(){return t("entryBooks.startByCreating","Start by creating your first entry")},get children(){var I=gL(),M=I.firstChild;return I.style.setProperty("text-align","center"),I.style.setProperty("color","var(--text-muted)"),I.style.setProperty("padding","2rem"),a(I,()=>t("entryBooks.noEntriesMatch","No journal entries match your current filters."),M),a(I,R(ht,{variant:"primary",style:{"margin-top":"1rem"},onClick:U,get children(){return t("entryBooks.createFirstEntry","Create First Entry")}}),null),I}}):(()=>{var I=bs();return m(I,P),a(I,R(Ut,{each:j,children:M=>R(A6,{entry:M,onViewDetails:X})})),I})()),R(D5,{get isOpen(){return e()},onClose:ce,get editEntry(){return l()}}),R(q6,{get isOpen(){return n()},onClose:()=>i(!1)}),R(Y6,{get isOpen(){return o()},onClose:()=>s(!1)}),R(hL,{get isOpen(){return u()},onClose:()=>{h(!1),g(null)},get entryId(){return y()}})]}})};function nn(t){"@babel/helpers - typeof";return nn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nn(t)}var mi=Uint8Array,eo=Uint16Array,Gy=Int32Array,vp=new mi([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),bp=new mi([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Am=new mi([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),F5=function(t,e){for(var r=new eo(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var i=new Gy(r[30]),n=1;n<30;++n)for(var o=r[n];o<r[n+1];++o)i[o]=o-r[n]<<5|n;return{b:r,r:i}},O5=F5(vp,2),B5=O5.b,Cm=O5.r;B5[28]=258,Cm[258]=28;var j5=F5(bp,0),bL=j5.b,j0=j5.r,Im=new eo(32768);for(var yn=0;yn<32768;++yn){var ha=(yn&43690)>>1|(yn&21845)<<1;ha=(ha&52428)>>2|(ha&13107)<<2,ha=(ha&61680)>>4|(ha&3855)<<4,Im[yn]=((ha&65280)>>8|(ha&255)<<8)>>1}var ts=function(t,e,r){for(var n=t.length,i=0,o=new eo(e);i<n;++i)t[i]&&++o[t[i]-1];var s=new eo(e);for(i=1;i<e;++i)s[i]=s[i-1]+o[i-1]<<1;var l;if(r){l=new eo(1<<e);var c=15-e;for(i=0;i<n;++i)if(t[i])for(var u=i<<4|t[i],h=e-t[i],y=s[t[i]-1]++<<h,g=y|(1<<h)-1;y<=g;++y)l[Im[y]>>c]=u}else for(l=new eo(n),i=0;i<n;++i)t[i]&&(l[i]=Im[s[t[i]-1]++]>>15-t[i]);return l},Ra=new mi(288);for(var yn=0;yn<144;++yn)Ra[yn]=8;for(var yn=144;yn<256;++yn)Ra[yn]=9;for(var yn=256;yn<280;++yn)Ra[yn]=7;for(var yn=280;yn<288;++yn)Ra[yn]=8;var Uu=new mi(32);for(var yn=0;yn<32;++yn)Uu[yn]=5;var _L=ts(Ra,9,0),SL=ts(Ra,9,1),PL=ts(Uu,5,0),wL=ts(Uu,5,1),wf=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},xo=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},xf=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},Wy=function(t){return(t+7)/8|0},V5=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new mi(t.subarray(e,r))},xL=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Io=function(t,e,r){var n=new Error(e||xL[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,Io),!r)throw n;return n},AL=function(t,e,r,n){var i=t.length,o=0;if(!i||e.f&&!e.l)return r||new mi(0);var s=!r,l=s||e.i!=2,c=e.i;s&&(r=new mi(i*3));var u=function(G){var re=r.length;if(G>re){var oe=new mi(Math.max(re*2,G));oe.set(r),r=oe}},h=e.f||0,y=e.p||0,g=e.b||0,f=e.l,x=e.d,S=e.m,w=e.n,E=i*8;do{if(!f){h=xo(t,y,1);var q=xo(t,y+1,3);if(y+=3,q)if(q==1)f=SL,x=wL,S=9,w=5;else if(q==2){var te=xo(t,y,31)+257,$=xo(t,y+10,15)+4,C=te+xo(t,y+5,31)+1;y+=14;for(var T=new mi(C),O=new mi(19),b=0;b<$;++b)O[Am[b]]=xo(t,y+b*3,7);y+=$*3;for(var P=wf(O),_=(1<<P)-1,z=ts(O,P,1),b=0;b<C;){var Z=z[xo(t,y,_)];y+=Z&15;var ee=Z>>4;if(ee<16)T[b++]=ee;else{var k=0,F=0;for(ee==16?(F=3+xo(t,y,3),y+=2,k=T[b-1]):ee==17?(F=3+xo(t,y,7),y+=3):ee==18&&(F=11+xo(t,y,127),y+=7);F--;)T[b++]=k}}var X=T.subarray(0,te),U=T.subarray(te);S=wf(X),w=wf(U),f=ts(X,S,1),x=ts(U,w,1)}else Io(1);else{var ee=Wy(y)+4,W=t[ee-4]|t[ee-3]<<8,K=ee+W;if(K>i){c&&Io(0);break}l&&u(g+W),r.set(t.subarray(ee,K),g),e.b=g+=W,e.p=y=K*8,e.f=h;continue}if(y>E){c&&Io(0);break}}l&&u(g+131072);for(var B=(1<<S)-1,ce=(1<<w)-1,L=y;;L=y){var k=f[xf(t,y)&B],D=k>>4;if(y+=k&15,y>E){c&&Io(0);break}if(k||Io(2),D<256)r[g++]=D;else if(D==256){L=y,f=null;break}else{var j=D-254;if(D>264){var b=D-257,I=vp[b];j=xo(t,y,(1<<I)-1)+B5[b],y+=I}var M=x[xf(t,y)&ce],J=M>>4;M||Io(3),y+=M&15;var U=bL[J];if(J>3){var I=bp[J];U+=xf(t,y)&(1<<I)-1,y+=I}if(y>E){c&&Io(0);break}l&&u(g+131072);var H=g+j;if(g<U){var Q=o-U,se=Math.min(U,H);for(Q+g<0&&Io(3);g<se;++g)r[g]=n[Q+g]}for(;g<H;++g)r[g]=r[g-U]}}e.l=f,e.p=L,e.b=g,e.f=h,f&&(h=1,e.m=S,e.d=x,e.n=w)}while(!h);return g!=r.length&&s?V5(r,0,g):r.subarray(0,g)},_s=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},su=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},Af=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var i=r.length,o=r.slice();if(!i)return{t:z5,l:0};if(i==1){var s=new mi(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(K,te){return K.f-te.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],u=0,h=1,y=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};h!=i-1;)l=r[r[u].f<r[y].f?u++:y++],c=r[u!=h&&r[u].f<r[y].f?u++:y++],r[h++]={s:-1,f:l.f+c.f,l,r:c};for(var g=o[0].s,n=1;n<i;++n)o[n].s>g&&(g=o[n].s);var f=new eo(g+1),x=$m(r[h-1],f,0);if(x>e){var n=0,S=0,w=x-e,E=1<<w;for(o.sort(function(te,$){return f[$.s]-f[te.s]||te.f-$.f});n<i;++n){var q=o[n].s;if(f[q]>e)S+=E-(1<<x-f[q]),f[q]=e;else break}for(S>>=w;S>0;){var ee=o[n].s;f[ee]<e?S-=1<<e-f[ee]++-1:++n}for(;n>=0&&S;--n){var W=o[n].s;f[W]==e&&(--f[W],++S)}x=e}return{t:new mi(f),l:x}},$m=function(t,e,r){return t.s==-1?Math.max($m(t.l,e,r+1),$m(t.r,e,r+1)):e[t.s]=r},V0=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new eo(++e),n=0,i=t[0],o=1,s=function(c){r[n++]=c},l=1;l<=e;++l)if(t[l]==i&&l!=e)++o;else{if(!i&&o>2){for(;o>138;o-=138)s(32754);o>2&&(s(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(s(i),--o;o>6;o-=6)s(8304);o>2&&(s(o-3<<5|8208),o=0)}for(;o--;)s(i);o=1,i=t[l]}return{c:r.subarray(0,n),n:e}},au=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},q5=function(t,e,r){var n=r.length,i=Wy(e+2);t[i]=n&255,t[i+1]=n>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var o=0;o<n;++o)t[i+o+4]=r[o];return(i+4+n)*8},q0=function(t,e,r,n,i,o,s,l,c,u,h){_s(e,h++,r),++i[256];for(var y=Af(i,15),g=y.t,f=y.l,x=Af(o,15),S=x.t,w=x.l,E=V0(g),q=E.c,ee=E.n,W=V0(S),K=W.c,te=W.n,$=new eo(19),C=0;C<q.length;++C)++$[q[C]&31];for(var C=0;C<K.length;++C)++$[K[C]&31];for(var T=Af($,7),O=T.t,b=T.l,P=19;P>4&&!O[Am[P-1]];--P);var _=u+5<<3,z=au(i,Ra)+au(o,Uu)+s,Z=au(i,g)+au(o,S)+s+14+3*P+au($,O)+2*$[16]+3*$[17]+7*$[18];if(c>=0&&_<=z&&_<=Z)return q5(e,h,t.subarray(c,c+u));var k,F,X,U;if(_s(e,h,1+(Z<z)),h+=2,Z<z){k=ts(g,f,0),F=g,X=ts(S,w,0),U=S;var B=ts(O,b,0);_s(e,h,ee-257),_s(e,h+5,te-1),_s(e,h+10,P-4),h+=14;for(var C=0;C<P;++C)_s(e,h+3*C,O[Am[C]]);h+=3*P;for(var ce=[q,K],L=0;L<2;++L)for(var D=ce[L],C=0;C<D.length;++C){var j=D[C]&31;_s(e,h,B[j]),h+=O[j],j>15&&(_s(e,h,D[C]>>5&127),h+=D[C]>>12)}}else k=_L,F=Ra,X=PL,U=Uu;for(var C=0;C<l;++C){var I=n[C];if(I>255){var j=I>>18&31;su(e,h,k[j+257]),h+=F[j+257],j>7&&(_s(e,h,I>>23&31),h+=vp[j]);var M=I&31;su(e,h,X[M]),h+=U[M],M>3&&(su(e,h,I>>5&8191),h+=bp[M])}else su(e,h,k[I]),h+=F[I]}return su(e,h,k[256]),h+F[256]},CL=new Gy([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),z5=new mi(0),IL=function(t,e,r,n,i,o){var s=o.z||t.length,l=new mi(n+s+5*(1+Math.ceil(s/7e3))+i),c=l.subarray(n,l.length-i),u=o.l,h=(o.r||0)&7;if(e){h&&(c[0]=o.r>>3);for(var y=CL[e-1],g=y>>13,f=y&8191,x=(1<<r)-1,S=o.p||new eo(32768),w=o.h||new eo(x+1),E=Math.ceil(r/3),q=2*E,ee=function(fe){return(t[fe]^t[fe+1]<<E^t[fe+2]<<q)&x},W=new Gy(25e3),K=new eo(288),te=new eo(32),$=0,C=0,T=o.i||0,O=0,b=o.w||0,P=0;T+2<s;++T){var _=ee(T),z=T&32767,Z=w[_];if(S[z]=Z,w[_]=z,b<=T){var k=s-T;if(($>7e3||O>24576)&&(k>423||!u)){h=q0(t,c,0,W,K,te,C,O,P,T-P,h),O=$=C=0,P=T;for(var F=0;F<286;++F)K[F]=0;for(var F=0;F<30;++F)te[F]=0}var X=2,U=0,B=f,ce=z-Z&32767;if(k>2&&_==ee(T-ce))for(var L=Math.min(g,k)-1,D=Math.min(32767,T),j=Math.min(258,k);ce<=D&&--B&&z!=Z;){if(t[T+X]==t[T+X-ce]){for(var I=0;I<j&&t[T+I]==t[T+I-ce];++I);if(I>X){if(X=I,U=ce,I>L)break;for(var M=Math.min(ce,I-2),J=0,F=0;F<M;++F){var H=T-ce+F&32767,Q=S[H],se=H-Q&32767;se>J&&(J=se,Z=H)}}}z=Z,Z=S[z],ce+=z-Z&32767}if(U){W[O++]=268435456|Cm[X]<<18|j0[U];var G=Cm[X]&31,re=j0[U]&31;C+=vp[G]+bp[re],++K[257+G],++te[re],b=T+X,++$}else W[O++]=t[T],++K[t[T]]}}for(T=Math.max(T,b);T<s;++T)W[O++]=t[T],++K[t[T]];h=q0(t,c,u,W,K,te,C,O,P,T-P,h),u||(o.r=h&7|c[h/8|0]<<3,h-=7,o.h=w,o.p=S,o.i=T,o.w=b)}else{for(var T=o.w||0;T<s+u;T+=65535){var oe=T+65535;oe>=s&&(c[h/8|0]=u,oe=s),h=q5(c,h+1,t.subarray(T,oe))}o.i=s}return V5(l,0,n+Wy(h)+i)},U5=function(){var t=1,e=0;return{p:function(r){for(var n=t,i=e,o=r.length|0,s=0;s!=o;){for(var l=Math.min(s+2655,o);s<l;++s)i+=n+=r[s];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}t=n,e=i},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},$L=function(t,e,r,n,i){if(!i&&(i={l:1},e.dictionary)){var o=e.dictionary.subarray(-32768),s=new mi(o.length+t.length);s.set(o),s.set(t,o.length),t=s,i.w=o.length}return IL(t,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,i)},H5=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},EL=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var i=U5();i.p(e.dictionary),H5(t,2,i.d())}},TL=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&Io(6,"invalid zlib data"),(t[1]>>5&1)==1&&Io(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function Em(t,e){e||(e={});var r=U5();r.p(t);var n=$L(t,e,e.dictionary?6:2,4);return EL(n,e),H5(n,n.length-4,r.d()),n}function kL(t,e){return AL(t.subarray(TL(t),-4),{i:2},e,e)}var NL=typeof TextDecoder<"u"&&new TextDecoder,LL=0;try{NL.decode(z5,{stream:!0}),LL=1}catch{}var gr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Cf(){gr.console&&typeof gr.console.log=="function"&&gr.console.log.apply(gr.console,arguments)}var cn={log:Cf,warn:function(t){gr.console&&(typeof gr.console.warn=="function"?gr.console.warn.apply(gr.console,arguments):Cf.call(null,arguments))},error:function(t){gr.console&&(typeof gr.console.error=="function"?gr.console.error.apply(gr.console,arguments):Cf(t))}};function If(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){sl(n.response,e,r)},n.onerror=function(){cn.error("could not download file")},n.send()}function z0(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Kd(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var wu,Tm,sl=gr.saveAs||((typeof window>"u"?"undefined":nn(window))!=="object"||window!==gr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=gr.URL||gr.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener",typeof t=="string"?(i.href=t,i.origin!==location.origin?z0(i.href)?If(t,e,r):Kd(i,i.target="_blank"):Kd(i)):(i.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){Kd(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(z0(t))If(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){Kd(n)})}else navigator.msSaveOrOpenBlob(function(i,o){return o===void 0?o={autoBom:!1}:nn(o)!=="object"&&(cn.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return If(t,e,r);var i=t.type==="application/octet-stream",o=/constructor/i.test(gr.HTMLElement)||gr.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||i&&o)&&(typeof FileReader>"u"?"undefined":nn(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var h=l.result;h=s?h:h.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=h:location=h,n=null},l.readAsDataURL(t)}else{var c=gr.URL||gr.webkitURL,u=c.createObjectURL(t);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function G5(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,o=r[n].process,s=i.exec(t);s&&(e=o(s),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function $f(t,e){var r=t[0],n=t[1],i=t[2],o=t[3];r=si(r,n,i,o,e[0],7,-680876936),o=si(o,r,n,i,e[1],12,-389564586),i=si(i,o,r,n,e[2],17,606105819),n=si(n,i,o,r,e[3],22,-1044525330),r=si(r,n,i,o,e[4],7,-176418897),o=si(o,r,n,i,e[5],12,1200080426),i=si(i,o,r,n,e[6],17,-1473231341),n=si(n,i,o,r,e[7],22,-45705983),r=si(r,n,i,o,e[8],7,1770035416),o=si(o,r,n,i,e[9],12,-1958414417),i=si(i,o,r,n,e[10],17,-42063),n=si(n,i,o,r,e[11],22,-1990404162),r=si(r,n,i,o,e[12],7,1804603682),o=si(o,r,n,i,e[13],12,-40341101),i=si(i,o,r,n,e[14],17,-1502002290),r=ai(r,n=si(n,i,o,r,e[15],22,1236535329),i,o,e[1],5,-165796510),o=ai(o,r,n,i,e[6],9,-1069501632),i=ai(i,o,r,n,e[11],14,643717713),n=ai(n,i,o,r,e[0],20,-373897302),r=ai(r,n,i,o,e[5],5,-701558691),o=ai(o,r,n,i,e[10],9,38016083),i=ai(i,o,r,n,e[15],14,-660478335),n=ai(n,i,o,r,e[4],20,-405537848),r=ai(r,n,i,o,e[9],5,568446438),o=ai(o,r,n,i,e[14],9,-1019803690),i=ai(i,o,r,n,e[3],14,-187363961),n=ai(n,i,o,r,e[8],20,1163531501),r=ai(r,n,i,o,e[13],5,-1444681467),o=ai(o,r,n,i,e[2],9,-51403784),i=ai(i,o,r,n,e[7],14,1735328473),r=li(r,n=ai(n,i,o,r,e[12],20,-1926607734),i,o,e[5],4,-378558),o=li(o,r,n,i,e[8],11,-2022574463),i=li(i,o,r,n,e[11],16,1839030562),n=li(n,i,o,r,e[14],23,-35309556),r=li(r,n,i,o,e[1],4,-1530992060),o=li(o,r,n,i,e[4],11,1272893353),i=li(i,o,r,n,e[7],16,-155497632),n=li(n,i,o,r,e[10],23,-1094730640),r=li(r,n,i,o,e[13],4,681279174),o=li(o,r,n,i,e[0],11,-358537222),i=li(i,o,r,n,e[3],16,-722521979),n=li(n,i,o,r,e[6],23,76029189),r=li(r,n,i,o,e[9],4,-640364487),o=li(o,r,n,i,e[12],11,-421815835),i=li(i,o,r,n,e[15],16,530742520),r=ci(r,n=li(n,i,o,r,e[2],23,-995338651),i,o,e[0],6,-198630844),o=ci(o,r,n,i,e[7],10,1126891415),i=ci(i,o,r,n,e[14],15,-1416354905),n=ci(n,i,o,r,e[5],21,-57434055),r=ci(r,n,i,o,e[12],6,1700485571),o=ci(o,r,n,i,e[3],10,-1894986606),i=ci(i,o,r,n,e[10],15,-1051523),n=ci(n,i,o,r,e[1],21,-2054922799),r=ci(r,n,i,o,e[8],6,1873313359),o=ci(o,r,n,i,e[15],10,-30611744),i=ci(i,o,r,n,e[6],15,-1560198380),n=ci(n,i,o,r,e[13],21,1309151649),r=ci(r,n,i,o,e[4],6,-145523070),o=ci(o,r,n,i,e[11],10,-1120210379),i=ci(i,o,r,n,e[2],15,718787259),n=ci(n,i,o,r,e[9],21,-343485551),t[0]=_a(r,t[0]),t[1]=_a(n,t[1]),t[2]=_a(i,t[2]),t[3]=_a(o,t[3])}function _p(t,e,r,n,i,o){return e=_a(_a(e,t),_a(n,o)),_a(e<<i|e>>>32-i,r)}function si(t,e,r,n,i,o,s){return _p(e&r|~e&n,t,e,i,o,s)}function ai(t,e,r,n,i,o,s){return _p(e&n|r&~n,t,e,i,o,s)}function li(t,e,r,n,i,o,s){return _p(e^r^n,t,e,i,o,s)}function ci(t,e,r,n,i,o,s){return _p(r^(e|~n),t,e,i,o,s)}function W5(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)$f(n,RL(t.substring(e-64,e)));t=t.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for($f(n,i),e=0;e<16;e++)i[e]=0;return i[14]=8*r,$f(n,i),n}function RL(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}wu=gr.atob.bind(gr),Tm=gr.btoa.bind(gr);var U0="0123456789abcdef".split("");function DL(t){for(var e="",r=0;r<4;r++)e+=U0[t>>8*r+4&15]+U0[t>>8*r&15];return e}function ML(t){return String.fromCharCode((255&t)>>0,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function km(t){return W5(t).map(ML).join("")}var FL=function(t){for(var e=0;e<t.length;e++)t[e]=DL(t[e]);return t.join("")}(W5("hello"))!="5d41402abc4b2a76b9719d911017c592";function _a(t,e){if(FL){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Nm(t,e){var r,n,i,o;if(t!==r){for(var s=(i=t,o=1+(256/t.length>>0),new Array(o+1).join(i)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var h=l[c];u=(u+h+s.charCodeAt(c))%256,l[c]=l[u],l[u]=h}r=t,n=l}else l=n;var y=e.length,g=0,f=0,x="";for(c=0;c<y;c++)f=(f+(h=l[g=(g+1)%256]))%256,l[g]=l[f],l[f]=h,s=l[(l[g]+l[f])%256],x+=String.fromCharCode(e.charCodeAt(c)^s);return x}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var H0={print:4,modify:8,copy:16,"annot-forms":32};function dc(t,e,r,n){this.v=1,this.r=2;var i=192;t.forEach(function(l){if(H0.perm!==void 0)throw new Error("Invalid permission: "+l);i+=H0[l]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var o=(e+this.padding).substr(0,32),s=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(o,s),this.P=-(1+(255^i)),this.encryptionKey=km(o+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Nm(this.encryptionKey,this.padding)}function hc(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var i=t.charCodeAt(n);i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?e+="#"+("0"+i.toString(16)).slice(-2):e+=t[n]}return e}function G0(t){if(nn(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var o=Math.random().toString(35);return e[r][o]=[n,!!i],o},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var o in e[r]){var s=e[r][o];try{s[0].apply(t,n)}catch(l){gr.console&&cn.error("jsPDF PubSub Error",l.message,l)}s[1]&&i.push(o)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Hu(t){if(!(this instanceof Hu))return new Hu(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function Y5(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function va(t,e,r,n,i){if(!(this instanceof va))return new va(t,e,r,n,i);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,Y5.call(this,n,i)}function fl(t,e,r,n,i){if(!(this instanceof fl))return new fl(t,e,r,n,i);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,Y5.call(this,n,i)}function hr(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],o=arguments[3],s=[],l=1,c=16,u="S",h=null;nn(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,i=t.format||i,o=t.compress||t.compressPdf||o,(h=t.encryption||null)!==null&&(h.userPassword=h.userPassword||"",h.ownerPassword=h.ownerPassword||"",h.userPermissions=h.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),u=t.defaultPathOperation||"S"),s=t.filters||(o===!0?["FlateEncode"]:s),n=n||"mm",r=(""+(r||"P")).toLowerCase();var y=t.putOnlyUsedFonts||!1,g={},f={internal:{},__private__:{}};f.__private__.PubSub=G0;var x="1.3",S=f.__private__.getPdfVersion=function(){return x};f.__private__.setPdfVersion=function(A){x=A};var w={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return w};var E=f.__private__.getPageFormat=function(A){return w[A]};i=i||"a4";var q={COMPAT:"compat",ADVANCED:"advanced"},ee=q.COMPAT;function W(){this.saveGraphicsState(),Y(new It(Be,0,0,-Be,0,ii()*Be).toString()+" cm"),this.setFontSize(this.getFontSize()/Be),u="n",ee=q.ADVANCED}function K(){this.restoreGraphicsState(),u="S",ee=q.COMPAT}var te=f.__private__.combineFontStyleAndFontWeight=function(A,me){if(A=="bold"&&me=="normal"||A=="bold"&&me==400||A=="normal"&&me=="italic"||A=="bold"&&me=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return me&&(A=me==400||me==="normal"?A==="italic"?"italic":"normal":me!=700&&me!=="bold"||A!=="normal"?(me==700?"bold":me)+""+A:"bold"),A};f.advancedAPI=function(A){var me=ee===q.COMPAT;return me&&W.call(this),typeof A!="function"||(A(this),me&&K.call(this)),this},f.compatAPI=function(A){var me=ee===q.ADVANCED;return me&&K.call(this),typeof A!="function"||(A(this),me&&W.call(this)),this},f.isAdvancedAPI=function(){return ee===q.ADVANCED};var $,C=function(A){if(ee!==q.ADVANCED)throw new Error(A+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},T=f.roundToPrecision=f.__private__.roundToPrecision=function(A,me){var Ne=e||me;if(isNaN(A)||isNaN(Ne))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return A.toFixed(Ne).replace(/0+$/,"")};$=f.hpf=f.__private__.hpf=typeof c=="number"?function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.hpf");return T(A,c)}:c==="smart"?function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.hpf");return T(A,A>-1&&A<1?16:5)}:function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.hpf");return T(A,16)};var O=f.f2=f.__private__.f2=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.f2");return T(A,2)},b=f.__private__.f3=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.f3");return T(A,3)},P=f.scale=f.__private__.scale=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.scale");return ee===q.COMPAT?A*Be:ee===q.ADVANCED?A:void 0},_=function(A){return ee===q.COMPAT?ii()-A:ee===q.ADVANCED?A:void 0},z=function(A){return P(_(A))};f.__private__.setPrecision=f.setPrecision=function(A){typeof parseInt(A,10)=="number"&&(e=parseInt(A,10))};var Z,k="00000000000000000000000000000000",F=f.__private__.getFileId=function(){return k},X=f.__private__.setFileId=function(A){return k=A!==void 0&&/^[a-fA-F0-9]{32}$/.test(A)?A.toUpperCase():k.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),h!==null&&(fn=new dc(h.userPermissions,h.userPassword,h.ownerPassword,k)),k};f.setFileId=function(A){return X(A),this},f.getFileId=function(){return F()};var U=f.__private__.convertDateToPDFDate=function(A){var me=A.getTimezoneOffset(),Ne=me<0?"+":"-",Me=Math.floor(Math.abs(me/60)),He=Math.abs(me%60),st=[Ne,j(Me),"'",j(He),"'"].join("");return["D:",A.getFullYear(),j(A.getMonth()+1),j(A.getDate()),j(A.getHours()),j(A.getMinutes()),j(A.getSeconds()),st].join("")},B=f.__private__.convertPDFDateToDate=function(A){var me=parseInt(A.substr(2,4),10),Ne=parseInt(A.substr(6,2),10)-1,Me=parseInt(A.substr(8,2),10),He=parseInt(A.substr(10,2),10),st=parseInt(A.substr(12,2),10),xt=parseInt(A.substr(14,2),10);return new Date(me,Ne,Me,He,st,xt,0)},ce=f.__private__.setCreationDate=function(A){var me;if(A===void 0&&(A=new Date),A instanceof Date)me=U(A);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(A))throw new Error("Invalid argument passed to jsPDF.setCreationDate");me=A}return Z=me},L=f.__private__.getCreationDate=function(A){var me=Z;return A==="jsDate"&&(me=B(Z)),me};f.setCreationDate=function(A){return ce(A),this},f.getCreationDate=function(A){return L(A)};var D,j=f.__private__.padd2=function(A){return("0"+parseInt(A)).slice(-2)},I=f.__private__.padd2Hex=function(A){return("00"+(A=A.toString())).substr(A.length)},M=0,J=[],H=[],Q=0,se=[],G=[],re=!1,oe=H,fe=function(){M=0,Q=0,H=[],J=[],se=[],Wt=Ue(),We=Ue()};f.__private__.setCustomOutputDestination=function(A){re=!0,oe=A};var ae=function(A){re||(oe=A)};f.__private__.resetCustomOutputDestination=function(){re=!1,oe=H};var Y=f.__private__.out=function(A){return A=A.toString(),Q+=A.length+1,oe.push(A),oe},ie=f.__private__.write=function(A){return Y(arguments.length===1?A.toString():Array.prototype.join.call(arguments," "))},de=f.__private__.getArrayBuffer=function(A){for(var me=A.length,Ne=new ArrayBuffer(me),Me=new Uint8Array(Ne);me--;)Me[me]=A.charCodeAt(me);return Ne},ue=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return ue};var ge=t.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(A){return ge=ee===q.ADVANCED?A/Be:A,this};var Pe,pe=f.__private__.getFontSize=f.getFontSize=function(){return ee===q.COMPAT?ge:ge*Be},_e=t.R2L||!1;f.__private__.setR2L=f.setR2L=function(A){return _e=A,this},f.__private__.getR2L=f.getR2L=function(){return _e};var Le,De=f.__private__.setZoomMode=function(A){var me=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(A))Pe=A;else if(isNaN(A)){if(me.indexOf(A)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+A+'" is not recognized.');Pe=A}else Pe=parseInt(A,10)};f.__private__.getZoomMode=function(){return Pe};var Te,$e=f.__private__.setPageMode=function(A){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(A)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+A+'" is not recognized.');Le=A};f.__private__.getPageMode=function(){return Le};var Ie=f.__private__.setLayoutMode=function(A){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(A)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+A+'" is not recognized.');Te=A};f.__private__.getLayoutMode=function(){return Te},f.__private__.setDisplayMode=f.setDisplayMode=function(A,me,Ne){return De(A),Ie(me),$e(Ne),this};var Re={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(A){if(Object.keys(Re).indexOf(A)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Re[A]},f.__private__.getDocumentProperties=function(){return Re},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(A){for(var me in Re)Re.hasOwnProperty(me)&&A[me]&&(Re[me]=A[me]);return this},f.__private__.setDocumentProperty=function(A,me){if(Object.keys(Re).indexOf(A)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Re[A]=me};var Je,Be,Ke,Xe,at,ot={},Qe={},dt=[],ct={},kt={},gt={},qe={},Dt=null,Rt=0,St=[],Bt=new G0(f),fr=t.hotfixes||[],Qt={},cr={},xr=[],It=function A(me,Ne,Me,He,st,xt){if(!(this instanceof A))return new A(me,Ne,Me,He,st,xt);isNaN(me)&&(me=1),isNaN(Ne)&&(Ne=0),isNaN(Me)&&(Me=0),isNaN(He)&&(He=1),isNaN(st)&&(st=0),isNaN(xt)&&(xt=0),this._matrix=[me,Ne,Me,He,st,xt]};Object.defineProperty(It.prototype,"sx",{get:function(){return this._matrix[0]},set:function(A){this._matrix[0]=A}}),Object.defineProperty(It.prototype,"shy",{get:function(){return this._matrix[1]},set:function(A){this._matrix[1]=A}}),Object.defineProperty(It.prototype,"shx",{get:function(){return this._matrix[2]},set:function(A){this._matrix[2]=A}}),Object.defineProperty(It.prototype,"sy",{get:function(){return this._matrix[3]},set:function(A){this._matrix[3]=A}}),Object.defineProperty(It.prototype,"tx",{get:function(){return this._matrix[4]},set:function(A){this._matrix[4]=A}}),Object.defineProperty(It.prototype,"ty",{get:function(){return this._matrix[5]},set:function(A){this._matrix[5]=A}}),Object.defineProperty(It.prototype,"a",{get:function(){return this._matrix[0]},set:function(A){this._matrix[0]=A}}),Object.defineProperty(It.prototype,"b",{get:function(){return this._matrix[1]},set:function(A){this._matrix[1]=A}}),Object.defineProperty(It.prototype,"c",{get:function(){return this._matrix[2]},set:function(A){this._matrix[2]=A}}),Object.defineProperty(It.prototype,"d",{get:function(){return this._matrix[3]},set:function(A){this._matrix[3]=A}}),Object.defineProperty(It.prototype,"e",{get:function(){return this._matrix[4]},set:function(A){this._matrix[4]=A}}),Object.defineProperty(It.prototype,"f",{get:function(){return this._matrix[5]},set:function(A){this._matrix[5]=A}}),Object.defineProperty(It.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(It.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(It.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(It.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),It.prototype.join=function(A){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map($).join(A)},It.prototype.multiply=function(A){var me=A.sx*this.sx+A.shy*this.shx,Ne=A.sx*this.shy+A.shy*this.sy,Me=A.shx*this.sx+A.sy*this.shx,He=A.shx*this.shy+A.sy*this.sy,st=A.tx*this.sx+A.ty*this.shx+this.tx,xt=A.tx*this.shy+A.ty*this.sy+this.ty;return new It(me,Ne,Me,He,st,xt)},It.prototype.decompose=function(){var A=this.sx,me=this.shy,Ne=this.shx,Me=this.sy,He=this.tx,st=this.ty,xt=Math.sqrt(A*A+me*me),qt=(A/=xt)*Ne+(me/=xt)*Me;Ne-=A*qt,Me-=me*qt;var p=Math.sqrt(Ne*Ne+Me*Me);return qt/=p,A*(Me/=p)<me*(Ne/=p)&&(A=-A,me=-me,qt=-qt,xt=-xt),{scale:new It(xt,0,0,p,0,0),translate:new It(1,0,0,1,He,st),rotate:new It(A,me,-me,A,0,0),skew:new It(1,0,qt,1,0,0)}},It.prototype.toString=function(A){return this.join(" ")},It.prototype.inversed=function(){var A=this.sx,me=this.shy,Ne=this.shx,Me=this.sy,He=this.tx,st=this.ty,xt=1/(A*Me-me*Ne),qt=Me*xt,p=-me*xt,V=-Ne*xt,le=A*xt;return new It(qt,p,V,le,-qt*He-V*st,-p*He-le*st)},It.prototype.applyToPoint=function(A){var me=A.x*this.sx+A.y*this.shx+this.tx,Ne=A.x*this.shy+A.y*this.sy+this.ty;return new cs(me,Ne)},It.prototype.applyToRectangle=function(A){var me=this.applyToPoint(A),Ne=this.applyToPoint(new cs(A.x+A.w,A.y+A.h));return new Gs(me.x,me.y,Ne.x-me.x,Ne.y-me.y)},It.prototype.clone=function(){var A=this.sx,me=this.shy,Ne=this.shx,Me=this.sy,He=this.tx,st=this.ty;return new It(A,me,Ne,Me,He,st)},f.Matrix=It;var Ge=f.matrixMult=function(A,me){return me.multiply(A)},Nt=new It(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=Nt;var At=function(A,me){if(!kt[A]){var Ne=(me instanceof va?"Sh":"P")+(Object.keys(ct).length+1).toString(10);me.id=Ne,kt[A]=Ne,ct[Ne]=me,Bt.publish("addPattern",me)}};f.ShadingPattern=va,f.TilingPattern=fl,f.addShadingPattern=function(A,me){return C("addShadingPattern()"),At(A,me),this},f.beginTilingPattern=function(A){C("beginTilingPattern()"),Ws(A.boundingBox[0],A.boundingBox[1],A.boundingBox[2]-A.boundingBox[0],A.boundingBox[3]-A.boundingBox[1],A.matrix)},f.endTilingPattern=function(A,me){C("endTilingPattern()"),me.stream=G[D].join(`
`),At(A,me),Bt.publish("endTilingPattern",me),xr.pop().restore()};var Lt=f.__private__.newObject=function(){var A=Ue();return nt(A,!0),A},Ue=f.__private__.newObjectDeferred=function(){return M++,J[M]=function(){return Q},M},nt=function(A,me){return me=typeof me=="boolean"&&me,J[A]=Q,me&&Y(A+" 0 obj"),A},_t=f.__private__.newAdditionalObject=function(){var A={objId:Ue(),content:""};return se.push(A),A},Wt=Ue(),We=Ue(),vt=f.__private__.decodeColorString=function(A){var me=A.split(" ");if(me.length!==2||me[1]!=="g"&&me[1]!=="G")me.length===5&&(me[4]==="k"||me[4]==="K")&&(me=[(1-me[0])*(1-me[3]),(1-me[1])*(1-me[3]),(1-me[2])*(1-me[3]),"r"]);else{var Ne=parseFloat(me[0]);me=[Ne,Ne,Ne,"r"]}for(var Me="#",He=0;He<3;He++)Me+=("0"+Math.floor(255*parseFloat(me[He])).toString(16)).slice(-2);return Me},Tt=f.__private__.encodeColorString=function(A){var me;typeof A=="string"&&(A={ch1:A});var Ne=A.ch1,Me=A.ch2,He=A.ch3,st=A.ch4,xt=A.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Ne=="string"&&Ne.charAt(0)!=="#"){var qt=new G5(Ne);if(qt.ok)Ne=qt.toHex();else if(!/^\d*\.?\d*$/.test(Ne))throw new Error('Invalid color "'+Ne+'" passed to jsPDF.encodeColorString.')}if(typeof Ne=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Ne)&&(Ne="#"+Ne[1]+Ne[1]+Ne[2]+Ne[2]+Ne[3]+Ne[3]),typeof Ne=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Ne)){var p=parseInt(Ne.substr(1),16);Ne=p>>16&255,Me=p>>8&255,He=255&p}if(Me===void 0||st===void 0&&Ne===Me&&Me===He)if(typeof Ne=="string")me=Ne+" "+xt[0];else switch(A.precision){case 2:me=O(Ne/255)+" "+xt[0];break;case 3:default:me=b(Ne/255)+" "+xt[0]}else if(st===void 0||nn(st)==="object"){if(st&&!isNaN(st.a)&&st.a===0)return me=["1.","1.","1.",xt[1]].join(" ");if(typeof Ne=="string")me=[Ne,Me,He,xt[1]].join(" ");else switch(A.precision){case 2:me=[O(Ne/255),O(Me/255),O(He/255),xt[1]].join(" ");break;default:case 3:me=[b(Ne/255),b(Me/255),b(He/255),xt[1]].join(" ")}}else if(typeof Ne=="string")me=[Ne,Me,He,st,xt[2]].join(" ");else switch(A.precision){case 2:me=[O(Ne),O(Me),O(He),O(st),xt[2]].join(" ");break;case 3:default:me=[b(Ne),b(Me),b(He),b(st),xt[2]].join(" ")}return me},jt=f.__private__.getFilters=function(){return s},Kt=f.__private__.putStream=function(A){var me=(A=A||{}).data||"",Ne=A.filters||jt(),Me=A.alreadyAppliedFilters||[],He=A.addLength1||!1,st=me.length,xt=A.objectId,qt=function(Ar){return Ar};if(h!==null&&xt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");h!==null&&(qt=fn.encryptor(xt,0));var p={};Ne===!0&&(Ne=["FlateEncode"]);var V=A.additionalKeyValues||[],le=(p=hr.API.processDataByFilters!==void 0?hr.API.processDataByFilters(me,Ne):{data:me,reverseChain:[]}).reverseChain+(Array.isArray(Me)?Me.join(" "):Me.toString());if(p.data.length!==0&&(V.push({key:"Length",value:p.data.length}),He===!0&&V.push({key:"Length1",value:st})),le.length!=0)if(le.split("/").length-1==1)V.push({key:"Filter",value:le});else{V.push({key:"Filter",value:"["+le+"]"});for(var we=0;we<V.length;we+=1)if(V[we].key==="DecodeParms"){for(var Ve=[],tt=0;tt<p.reverseChain.split("/").length-1;tt+=1)Ve.push("null");Ve.push(V[we].value),V[we].value="["+Ve.join(" ")+"]"}}Y("<<");for(var Ct=0;Ct<V.length;Ct++)Y("/"+V[Ct].key+" "+V[Ct].value);Y(">>"),p.data.length!==0&&(Y("stream"),Y(qt(p.data)),Y("endstream"))},rr=f.__private__.putPage=function(A){var me=A.number,Ne=A.data,Me=A.objId,He=A.contentsObjId;nt(Me,!0),Y("<</Type /Page"),Y("/Parent "+A.rootDictionaryObjId+" 0 R"),Y("/Resources "+A.resourceDictionaryObjId+" 0 R"),Y("/MediaBox ["+parseFloat($(A.mediaBox.bottomLeftX))+" "+parseFloat($(A.mediaBox.bottomLeftY))+" "+$(A.mediaBox.topRightX)+" "+$(A.mediaBox.topRightY)+"]"),A.cropBox!==null&&Y("/CropBox ["+$(A.cropBox.bottomLeftX)+" "+$(A.cropBox.bottomLeftY)+" "+$(A.cropBox.topRightX)+" "+$(A.cropBox.topRightY)+"]"),A.bleedBox!==null&&Y("/BleedBox ["+$(A.bleedBox.bottomLeftX)+" "+$(A.bleedBox.bottomLeftY)+" "+$(A.bleedBox.topRightX)+" "+$(A.bleedBox.topRightY)+"]"),A.trimBox!==null&&Y("/TrimBox ["+$(A.trimBox.bottomLeftX)+" "+$(A.trimBox.bottomLeftY)+" "+$(A.trimBox.topRightX)+" "+$(A.trimBox.topRightY)+"]"),A.artBox!==null&&Y("/ArtBox ["+$(A.artBox.bottomLeftX)+" "+$(A.artBox.bottomLeftY)+" "+$(A.artBox.topRightX)+" "+$(A.artBox.topRightY)+"]"),typeof A.userUnit=="number"&&A.userUnit!==1&&Y("/UserUnit "+A.userUnit),Bt.publish("putPage",{objId:Me,pageContext:St[me],pageNumber:me,page:Ne}),Y("/Contents "+He+" 0 R"),Y(">>"),Y("endobj");var st=Ne.join(`
`);return ee===q.ADVANCED&&(st+=`
Q`),nt(He,!0),Kt({data:st,filters:jt(),objectId:He}),Y("endobj"),Me},yr=f.__private__.putPages=function(){var A,me,Ne=[];for(A=1;A<=Rt;A++)St[A].objId=Ue(),St[A].contentsObjId=Ue();for(A=1;A<=Rt;A++)Ne.push(rr({number:A,data:G[A],objId:St[A].objId,contentsObjId:St[A].contentsObjId,mediaBox:St[A].mediaBox,cropBox:St[A].cropBox,bleedBox:St[A].bleedBox,trimBox:St[A].trimBox,artBox:St[A].artBox,userUnit:St[A].userUnit,rootDictionaryObjId:Wt,resourceDictionaryObjId:We}));nt(Wt,!0),Y("<</Type /Pages");var Me="/Kids [";for(me=0;me<Rt;me++)Me+=Ne[me]+" 0 R ";Y(Me+"]"),Y("/Count "+Rt),Y(">>"),Y("endobj"),Bt.publish("postPutPages")},nr=function(A){Bt.publish("putFont",{font:A,out:Y,newObject:Lt,putStream:Kt}),A.isAlreadyPutted!==!0&&(A.objectNumber=Lt(),Y("<<"),Y("/Type /Font"),Y("/BaseFont /"+hc(A.postScriptName)),Y("/Subtype /Type1"),typeof A.encoding=="string"&&Y("/Encoding /"+A.encoding),Y("/FirstChar 32"),Y("/LastChar 255"),Y(">>"),Y("endobj"))},ur=function(){for(var A in ot)ot.hasOwnProperty(A)&&(y===!1||y===!0&&g.hasOwnProperty(A))&&nr(ot[A])},Ft=function(A){A.objectNumber=Lt();var me=[];me.push({key:"Type",value:"/XObject"}),me.push({key:"Subtype",value:"/Form"}),me.push({key:"BBox",value:"["+[$(A.x),$(A.y),$(A.x+A.width),$(A.y+A.height)].join(" ")+"]"}),me.push({key:"Matrix",value:"["+A.matrix.toString()+"]"});var Ne=A.pages[1].join(`
`);Kt({data:Ne,additionalKeyValues:me,objectId:A.objectNumber}),Y("endobj")},$t=function(){for(var A in Qt)Qt.hasOwnProperty(A)&&Ft(Qt[A])},wt=function(A,me){var Ne,Me=[],He=1/(me-1);for(Ne=0;Ne<1;Ne+=He)Me.push(Ne);if(Me.push(1),A[0].offset!=0){var st={offset:0,color:A[0].color};A.unshift(st)}if(A[A.length-1].offset!=1){var xt={offset:1,color:A[A.length-1].color};A.push(xt)}for(var qt="",p=0,V=0;V<Me.length;V++){for(Ne=Me[V];Ne>A[p+1].offset;)p++;var le=A[p].offset,we=(Ne-le)/(A[p+1].offset-le),Ve=A[p].color,tt=A[p+1].color;qt+=I(Math.round((1-we)*Ve[0]+we*tt[0]).toString(16))+I(Math.round((1-we)*Ve[1]+we*tt[1]).toString(16))+I(Math.round((1-we)*Ve[2]+we*tt[2]).toString(16))}return qt.trim()},Zt=function(A,me){me||(me=21);var Ne=Lt(),Me=wt(A.colors,me),He=[];He.push({key:"FunctionType",value:"0"}),He.push({key:"Domain",value:"[0.0 1.0]"}),He.push({key:"Size",value:"["+me+"]"}),He.push({key:"BitsPerSample",value:"8"}),He.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),He.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Kt({data:Me,additionalKeyValues:He,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Ne}),Y("endobj"),A.objectNumber=Lt(),Y("<< /ShadingType "+A.type),Y("/ColorSpace /DeviceRGB");var st="/Coords ["+$(parseFloat(A.coords[0]))+" "+$(parseFloat(A.coords[1]))+" ";A.type===2?st+=$(parseFloat(A.coords[2]))+" "+$(parseFloat(A.coords[3])):st+=$(parseFloat(A.coords[2]))+" "+$(parseFloat(A.coords[3]))+" "+$(parseFloat(A.coords[4]))+" "+$(parseFloat(A.coords[5])),Y(st+="]"),A.matrix&&Y("/Matrix ["+A.matrix.toString()+"]"),Y("/Function "+Ne+" 0 R"),Y("/Extend [true true]"),Y(">>"),Y("endobj")},lt=function(A,me){var Ne=Ue(),Me=Lt();me.push({resourcesOid:Ne,objectOid:Me}),A.objectNumber=Me;var He=[];He.push({key:"Type",value:"/Pattern"}),He.push({key:"PatternType",value:"1"}),He.push({key:"PaintType",value:"1"}),He.push({key:"TilingType",value:"1"}),He.push({key:"BBox",value:"["+A.boundingBox.map($).join(" ")+"]"}),He.push({key:"XStep",value:$(A.xStep)}),He.push({key:"YStep",value:$(A.yStep)}),He.push({key:"Resources",value:Ne+" 0 R"}),A.matrix&&He.push({key:"Matrix",value:"["+A.matrix.toString()+"]"}),Kt({data:A.stream,additionalKeyValues:He,objectId:A.objectNumber}),Y("endobj")},er=function(A){var me;for(me in ct)ct.hasOwnProperty(me)&&(ct[me]instanceof va?Zt(ct[me]):ct[me]instanceof fl&&lt(ct[me],A))},ir=function(A){for(var me in A.objectNumber=Lt(),Y("<<"),A)switch(me){case"opacity":Y("/ca "+O(A[me]));break;case"stroke-opacity":Y("/CA "+O(A[me]))}Y(">>"),Y("endobj")},sr=function(){var A;for(A in gt)gt.hasOwnProperty(A)&&ir(gt[A])},_r=function(){for(var A in Y("/XObject <<"),Qt)Qt.hasOwnProperty(A)&&Qt[A].objectNumber>=0&&Y("/"+A+" "+Qt[A].objectNumber+" 0 R");Bt.publish("putXobjectDict"),Y(">>")},lr=function(){fn.oid=Lt(),Y("<<"),Y("/Filter /Standard"),Y("/V "+fn.v),Y("/R "+fn.r),Y("/U <"+fn.toHexString(fn.U)+">"),Y("/O <"+fn.toHexString(fn.O)+">"),Y("/P "+fn.P),Y(">>"),Y("endobj")},Lr=function(){for(var A in Y("/Font <<"),ot)ot.hasOwnProperty(A)&&(y===!1||y===!0&&g.hasOwnProperty(A))&&Y("/"+A+" "+ot[A].objectNumber+" 0 R");Y(">>")},on=function(){if(Object.keys(ct).length>0){for(var A in Y("/Shading <<"),ct)ct.hasOwnProperty(A)&&ct[A]instanceof va&&ct[A].objectNumber>=0&&Y("/"+A+" "+ct[A].objectNumber+" 0 R");Bt.publish("putShadingPatternDict"),Y(">>")}},Ur=function(A){if(Object.keys(ct).length>0){for(var me in Y("/Pattern <<"),ct)ct.hasOwnProperty(me)&&ct[me]instanceof f.TilingPattern&&ct[me].objectNumber>=0&&ct[me].objectNumber<A&&Y("/"+me+" "+ct[me].objectNumber+" 0 R");Bt.publish("putTilingPatternDict"),Y(">>")}},Yr=function(){if(Object.keys(gt).length>0){var A;for(A in Y("/ExtGState <<"),gt)gt.hasOwnProperty(A)&&gt[A].objectNumber>=0&&Y("/"+A+" "+gt[A].objectNumber+" 0 R");Bt.publish("putGStateDict"),Y(">>")}},Et=function(A){nt(A.resourcesOid,!0),Y("<<"),Y("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Lr(),on(),Ur(A.objectOid),Yr(),_r(),Y(">>"),Y("endobj")},bn=function(){var A=[];ur(),sr(),$t(),er(A),Bt.publish("putResources"),A.forEach(Et),Et({resourcesOid:We,objectOid:Number.MAX_SAFE_INTEGER}),Bt.publish("postPutResources")},_i=function(){Bt.publish("putAdditionalObjects");for(var A=0;A<se.length;A++){var me=se[A];nt(me.objId,!0),Y(me.content),Y("endobj")}Bt.publish("postPutAdditionalObjects")},Si=function(A){Qe[A.fontName]=Qe[A.fontName]||{},Qe[A.fontName][A.fontStyle]=A.id},mr=function(A,me,Ne,Me,He){var st={id:"F"+(Object.keys(ot).length+1).toString(10),postScriptName:A,fontName:me,fontStyle:Ne,encoding:Me,isStandardFont:He||!1,metadata:{}};return Bt.publish("addFont",{font:st,instance:this}),ot[st.id]=st,Si(st),st.id},Nr=function(A){for(var me=0,Ne=ue.length;me<Ne;me++){var Me=mr.call(this,A[me][0],A[me][1],A[me][2],ue[me][3],!0);y===!1&&(g[Me]=!0);var He=A[me][0].split("-");Si({id:Me,fontName:He[0],fontStyle:He[1]||""})}Bt.publish("addFonts",{fonts:ot,dictionary:Qe})},Vr=function(A){return A.foo=function(){try{return A.apply(this,arguments)}catch(Me){var me=Me.stack||"";~me.indexOf(" at ")&&(me=me.split(" at ")[1]);var Ne="Error in function "+me.split(`
`)[0].split("<")[0]+": "+Me.message;if(!gr.console)throw new Error(Ne);gr.console.error(Ne,Me),gr.alert&&alert(Ne)}},A.foo.bar=A,A.foo},gn=function(A,me){var Ne,Me,He,st,xt,qt,p,V,le;if(He=(me=me||{}).sourceEncoding||"Unicode",xt=me.outputEncoding,(me.autoencode||xt)&&ot[Je].metadata&&ot[Je].metadata[He]&&ot[Je].metadata[He].encoding&&(st=ot[Je].metadata[He].encoding,!xt&&ot[Je].encoding&&(xt=ot[Je].encoding),!xt&&st.codePages&&(xt=st.codePages[0]),typeof xt=="string"&&(xt=st[xt]),xt)){for(p=!1,qt=[],Ne=0,Me=A.length;Ne<Me;Ne++)(V=xt[A.charCodeAt(Ne)])?qt.push(String.fromCharCode(V)):qt.push(A[Ne]),qt[Ne].charCodeAt(0)>>8&&(p=!0);A=qt.join("")}for(Ne=A.length;p===void 0&&Ne!==0;)A.charCodeAt(Ne-1)>>8&&(p=!0),Ne--;if(!p)return A;for(qt=me.noBOM?[]:[254,255],Ne=0,Me=A.length;Ne<Me;Ne++){if((le=(V=A.charCodeAt(Ne))>>8)>>8)throw new Error("Character at position "+Ne+" of string '"+A+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");qt.push(le),qt.push(V-(le<<8))}return String.fromCharCode.apply(void 0,qt)},qr=f.__private__.pdfEscape=f.pdfEscape=function(A,me){return gn(A,me).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Rr=f.__private__.beginPage=function(A){G[++Rt]=[],St[Rt]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(A[0]),topRightY:Number(A[1])}},Pi(Rt),ae(G[D])},Bn=function(A,me){var Ne,Me,He;switch(r=me||r,typeof A=="string"&&(Ne=E(A.toLowerCase()),Array.isArray(Ne)&&(Me=Ne[0],He=Ne[1])),Array.isArray(A)&&(Me=A[0]*Be,He=A[1]*Be),isNaN(Me)&&(Me=i[0],He=i[1]),(Me>14400||He>14400)&&(cn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Me=Math.min(14400,Me),He=Math.min(14400,He)),i=[Me,He],r.substr(0,1)){case"l":He>Me&&(i=[He,Me]);break;case"p":Me>He&&(i=[He,Me])}Rr(i),Ha(Ua),Y(Kn),Ya!==0&&Y(Ya+" J"),Hs!==0&&Y(Hs+" j"),Bt.publish("addPage",{pageNumber:Rt})},Hn=function(A){A>0&&A<=Rt&&(G.splice(A,1),St.splice(A,1),Rt--,D>Rt&&(D=Rt),this.setPage(D))},Pi=function(A){A>0&&A<=Rt&&(D=A)},Hr=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return G.length-1},qi=function(A,me,Ne){var Me,He=void 0;return Ne=Ne||{},A=A!==void 0?A:ot[Je].fontName,me=me!==void 0?me:ot[Je].fontStyle,Me=A.toLowerCase(),Qe[Me]!==void 0&&Qe[Me][me]!==void 0?He=Qe[Me][me]:Qe[A]!==void 0&&Qe[A][me]!==void 0?He=Qe[A][me]:Ne.disableWarning===!1&&cn.warn("Unable to look up font label for font '"+A+"', '"+me+"'. Refer to getFontList() for available fonts."),He||Ne.noFallback||(He=Qe.times[me])==null&&(He=Qe.times.normal),He},zi=f.__private__.putInfo=function(){var A=Lt(),me=function(Me){return Me};for(var Ne in h!==null&&(me=fn.encryptor(A,0)),Y("<<"),Y("/Producer ("+qr(me("jsPDF "+hr.version))+")"),Re)Re.hasOwnProperty(Ne)&&Re[Ne]&&Y("/"+Ne.substr(0,1).toUpperCase()+Ne.substr(1)+" ("+qr(me(Re[Ne]))+")");Y("/CreationDate ("+qr(me(Z))+")"),Y(">>"),Y("endobj")},Ui=f.__private__.putCatalog=function(A){var me=(A=A||{}).rootDictionaryObjId||Wt;switch(Lt(),Y("<<"),Y("/Type /Catalog"),Y("/Pages "+me+" 0 R"),Pe||(Pe="fullwidth"),Pe){case"fullwidth":Y("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Y("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Y("/OpenAction [3 0 R /Fit]");break;case"original":Y("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Ne=""+Pe;Ne.substr(Ne.length-1)==="%"&&(Pe=parseInt(Pe)/100),typeof Pe=="number"&&Y("/OpenAction [3 0 R /XYZ null null "+O(Pe)+"]")}switch(Te||(Te="continuous"),Te){case"continuous":Y("/PageLayout /OneColumn");break;case"single":Y("/PageLayout /SinglePage");break;case"two":case"twoleft":Y("/PageLayout /TwoColumnLeft");break;case"tworight":Y("/PageLayout /TwoColumnRight")}Le&&Y("/PageMode /"+Le),Bt.publish("putCatalog"),Y(">>"),Y("endobj")},ja=f.__private__.putTrailer=function(){Y("trailer"),Y("<<"),Y("/Size "+(M+1)),Y("/Root "+M+" 0 R"),Y("/Info "+(M-1)+" 0 R"),h!==null&&Y("/Encrypt "+fn.oid+" 0 R"),Y("/ID [ <"+k+"> <"+k+"> ]"),Y(">>")},Ds=f.__private__.putHeader=function(){Y("%PDF-"+x),Y("%ºß¬à")},ss=f.__private__.putXRef=function(){var A="0000000000";Y("xref"),Y("0 "+(M+1)),Y("0000000000 65535 f ");for(var me=1;me<=M;me++)typeof J[me]=="function"?Y((A+J[me]()).slice(-10)+" 00000 n "):J[me]!==void 0?Y((A+J[me]).slice(-10)+" 00000 n "):Y("0000000000 00000 n ")},wi=f.__private__.buildDocument=function(){fe(),ae(H),Bt.publish("buildDocument"),Ds(),yr(),_i(),bn(),h!==null&&lr(),zi(),Ui();var A=Q;return ss(),ja(),Y("startxref"),Y(""+A),Y("%%EOF"),ae(G[D]),H.join(`
`)},Ms=f.__private__.getBlob=function(A){return new Blob([de(A)],{type:"application/pdf"})},Fs=f.output=f.__private__.output=Vr(function(A,me){switch(typeof(me=me||{})=="string"?me={filename:me}:me.filename=me.filename||"generated.pdf",A){case void 0:return wi();case"save":f.save(me.filename);break;case"arraybuffer":return de(wi());case"blob":return Ms(wi());case"bloburi":case"bloburl":if(gr.URL!==void 0&&typeof gr.URL.createObjectURL=="function")return gr.URL&&gr.URL.createObjectURL(Ms(wi()))||void 0;cn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Ne="",Me=wi();try{Ne=Tm(Me)}catch{Ne=Tm(unescape(encodeURIComponent(Me)))}return"data:application/pdf;filename="+me.filename+";base64,"+Ne;case"pdfobjectnewwindow":if(Object.prototype.toString.call(gr)==="[object Window]"){var He="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",st=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';me.pdfObjectUrl&&(He=me.pdfObjectUrl,st="");var xt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+He+'"'+st+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(me)+");<\/script></body></html>",qt=gr.open();return qt!==null&&qt.document.write(xt),qt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(gr)==="[object Window]"){var p='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(me.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+me.filename+'" width="500px" height="400px" /></body></html>',V=gr.open();if(V!==null){V.document.write(p);var le=this;V.document.documentElement.querySelector("#pdfViewer").onload=function(){V.document.title=me.filename,V.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(le.output("bloburl"))}}return V}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(gr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var we='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",me)+'"></iframe></body></html>',Ve=gr.open();if(Ve!==null&&(Ve.document.write(we),Ve.document.title=me.filename),Ve||typeof safari>"u")return Ve;break;case"datauri":case"dataurl":return gr.document.location.href=this.output("datauristring",me);default:return null}}),Do=function(A){return Array.isArray(fr)===!0&&fr.indexOf(A)>-1};switch(n){case"pt":Be=1;break;case"mm":Be=72/25.4;break;case"cm":Be=72/2.54;break;case"in":Be=72;break;case"px":Be=Do("px_scaling")==1?.75:96/72;break;case"pc":case"em":Be=12;break;case"ex":Be=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Be=n}var fn=null;ce(),X();var Dl=function(A){return h!==null?fn.encryptor(A,0):function(me){return me}},Va=f.__private__.getPageInfo=f.getPageInfo=function(A){if(isNaN(A)||A%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:St[A].objId,pageNumber:A,pageContext:St[A]}},Sr=f.__private__.getPageInfoByObjId=function(A){if(isNaN(A)||A%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var me in St)if(St[me].objId===A)break;return Va(me)},Mo=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:St[D].objId,pageNumber:D,pageContext:St[D]}};f.addPage=function(){return Bn.apply(this,arguments),this},f.setPage=function(){return Pi.apply(this,arguments),ae.call(this,G[D]),this},f.insertPage=function(A){return this.addPage(),this.movePage(D,A),this},f.movePage=function(A,me){var Ne,Me;if(A>me){Ne=G[A],Me=St[A];for(var He=A;He>me;He--)G[He]=G[He-1],St[He]=St[He-1];G[me]=Ne,St[me]=Me,this.setPage(me)}else if(A<me){Ne=G[A],Me=St[A];for(var st=A;st<me;st++)G[st]=G[st+1],St[st]=St[st+1];G[me]=Ne,St[me]=Me,this.setPage(me)}return this},f.deletePage=function(){return Hn.apply(this,arguments),this},f.__private__.text=f.text=function(A,me,Ne,Me,He){var st,xt,qt,p,V,le,we,Ve,tt,Ct=(Me=Me||{}).scope||this;if(typeof A=="number"&&typeof me=="number"&&(typeof Ne=="string"||Array.isArray(Ne))){var Ar=Ne;Ne=me,me=A,A=Ar}if(arguments[3]instanceof It?(C("The transform parameter of text() with a Matrix value"),tt=He):(qt=arguments[4],p=arguments[5],nn(we=arguments[3])==="object"&&we!==null||(typeof qt=="string"&&(p=qt,qt=null),typeof we=="string"&&(p=we,we=null),typeof we=="number"&&(qt=we,we=null),Me={flags:we,angle:qt,align:p})),isNaN(me)||isNaN(Ne)||A==null)throw new Error("Invalid arguments passed to jsPDF.text");if(A.length===0)return Ct;var Dr="",Cr=!1,Zr=typeof Me.lineHeightFactor=="number"?Me.lineHeightFactor:Xr,an=Ct.internal.scaleFactor;function _o(dn){return dn=dn.split("	").join(Array(Me.TabLen||9).join(" ")),qr(dn,we)}function Jn(dn){for(var hn,An=dn.concat(),Vn=[],fs=An.length;fs--;)typeof(hn=An.shift())=="string"?Vn.push(hn):Array.isArray(dn)&&(hn.length===1||hn[1]===void 0&&hn[2]===void 0)?Vn.push(hn[0]):Vn.push([hn[0],hn[1],hn[2]]);return Vn}function jo(dn,hn){var An;if(typeof dn=="string")An=hn(dn)[0];else if(Array.isArray(dn)){for(var Vn,fs,Hc=dn.concat(),Yl=[],dd=Hc.length;dd--;)typeof(Vn=Hc.shift())=="string"?Yl.push(hn(Vn)[0]):Array.isArray(Vn)&&typeof Vn[0]=="string"&&(fs=hn(Vn[0],Vn[1],Vn[2]),Yl.push([fs[0],fs[1],fs[2]]));An=Yl}return An}var Vo=!1,Oc=!0;if(typeof A=="string")Vo=!0;else if(Array.isArray(A)){var Bc=A.concat();xt=[];for(var jl,Qn=Bc.length;Qn--;)(typeof(jl=Bc.shift())!="string"||Array.isArray(jl)&&typeof jl[0]!="string")&&(Oc=!1);Vo=Oc}if(Vo===!1)throw new Error('Type of text must be string or Array. "'+A+'" is not recognized.');typeof A=="string"&&(A=A.match(/[\r?\n]/)?A.split(/\r\n|\r|\n/g):[A]);var Vl=ge/Ct.internal.scaleFactor,ql=Vl*(Zr-1);switch(Me.baseline){case"bottom":Ne-=ql;break;case"top":Ne+=Vl-ql;break;case"hanging":Ne+=Vl-2*ql;break;case"middle":Ne+=Vl/2-ql}if((le=Me.maxWidth||0)>0&&(typeof A=="string"?A=Ct.splitTextToSize(A,le):Object.prototype.toString.call(A)==="[object Array]"&&(A=A.reduce(function(dn,hn){return dn.concat(Ct.splitTextToSize(hn,le))},[]))),st={text:A,x:me,y:Ne,options:Me,mutex:{pdfEscape:qr,activeFontKey:Je,fonts:ot,activeFontSize:ge}},Bt.publish("preProcessText",st),A=st.text,qt=(Me=st.options).angle,!(tt instanceof It)&&qt&&typeof qt=="number"){qt*=Math.PI/180,Me.rotationDirection===0&&(qt=-qt),ee===q.ADVANCED&&(qt=-qt);var zl=Math.cos(qt),jc=Math.sin(qt);tt=new It(zl,jc,-jc,zl,0,0)}else qt&&qt instanceof It&&(tt=qt);ee!==q.ADVANCED||tt||(tt=Nt),(V=Me.charSpace||ls)!==void 0&&(Dr+=$(P(V))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Ve=Me.horizontalScale)!==void 0&&(Dr+=$(100*Ve)+` Tz
`),Me.lang;var Ti=-1,Pp=Me.renderingMode!==void 0?Me.renderingMode:Me.stroke,Vc=Ct.internal.getCurrentPageInfo().pageContext;switch(Pp){case 0:case!1:case"fill":Ti=0;break;case 1:case!0:case"stroke":Ti=1;break;case 2:case"fillThenStroke":Ti=2;break;case 3:case"invisible":Ti=3;break;case 4:case"fillAndAddForClipping":Ti=4;break;case 5:case"strokeAndAddPathForClipping":Ti=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Ti=6;break;case 7:case"addToPathForClipping":Ti=7}var ad=Vc.usedRenderingMode!==void 0?Vc.usedRenderingMode:-1;Ti!==-1?Dr+=Ti+` Tr
`:ad!==-1&&(Dr+=`0 Tr
`),Ti!==-1&&(Vc.usedRenderingMode=Ti),p=Me.align||"left";var no,Ul=ge*Zr,ld=Ct.internal.pageSize.getWidth(),cd=ot[Je];V=Me.charSpace||ls,le=Me.maxWidth||0,we=Object.assign({autoencode:!0,noBOM:!0},Me.flags);var Js=[],Ka=function(dn){return Ct.getStringUnitWidth(dn,{font:cd,charSpace:V,fontSize:ge,doKerning:!1})*ge/an};if(Object.prototype.toString.call(A)==="[object Array]"){var ki;xt=Jn(A),p!=="left"&&(no=xt.map(Ka));var xi,Qs=0;if(p==="right"){me-=no[0],A=[],Qn=xt.length;for(var ds=0;ds<Qn;ds++)ds===0?(xi=Wi(me),ki=jn(Ne)):(xi=P(Qs-no[ds]),ki=-Ul),A.push([xt[ds],xi,ki]),Qs=no[ds]}else if(p==="center"){me-=no[0]/2,A=[],Qn=xt.length;for(var hs=0;hs<Qn;hs++)hs===0?(xi=Wi(me),ki=jn(Ne)):(xi=P((Qs-no[hs])/2),ki=-Ul),A.push([xt[hs],xi,ki]),Qs=no[hs]}else if(p==="left"){A=[],Qn=xt.length;for(var Hl=0;Hl<Qn;Hl++)A.push(xt[Hl])}else if(p==="justify"&&cd.encoding==="Identity-H"){A=[],Qn=xt.length,le=le!==0?le:ld;for(var ps=0,xn=0;xn<Qn;xn++)if(ki=xn===0?jn(Ne):-Ul,xi=xn===0?Wi(me):ps,xn<Qn-1){var qc=P((le-no[xn])/(xt[xn].split(" ").length-1)),Ai=xt[xn].split(" ");A.push([Ai[0]+" ",xi,ki]),ps=0;for(var io=1;io<Ai.length;io++){var Gl=(Ka(Ai[io-1]+" "+Ai[io])-Ka(Ai[io]))*an+qc;io==Ai.length-1?A.push([Ai[io],Gl,0]):A.push([Ai[io]+" ",Gl,0]),ps-=Gl}}else A.push([xt[xn],xi,ki]);A.push(["",ps,0])}else{if(p!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(A=[],Qn=xt.length,le=le!==0?le:ld,xn=0;xn<Qn;xn++)ki=xn===0?jn(Ne):-Ul,xi=xn===0?Wi(me):0,xn<Qn-1?Js.push($(P((le-no[xn])/(xt[xn].split(" ").length-1)))):Js.push(0),A.push([xt[xn],xi,ki])}}var ud=typeof Me.R2L=="boolean"?Me.R2L:_e;ud===!0&&(A=jo(A,function(dn,hn,An){return[dn.split("").reverse().join(""),hn,An]})),st={text:A,x:me,y:Ne,options:Me,mutex:{pdfEscape:qr,activeFontKey:Je,fonts:ot,activeFontSize:ge}},Bt.publish("postProcessText",st),A=st.text,Cr=st.mutex.isHex||!1;var zc=ot[Je].encoding;zc!=="WinAnsiEncoding"&&zc!=="StandardEncoding"||(A=jo(A,function(dn,hn,An){return[_o(dn),hn,An]})),xt=Jn(A),A=[];for(var Ja,Qa,Xs,Xa=0,Wl=1,Za=Array.isArray(xt[0])?Wl:Xa,Zs="",Uc=function(dn,hn,An){var Vn="";return An instanceof It?(An=typeof Me.angle=="number"?Ge(An,new It(1,0,0,1,dn,hn)):Ge(new It(1,0,0,1,dn,hn),An),ee===q.ADVANCED&&(An=Ge(new It(1,0,0,-1,0,0),An)),Vn=An.join(" ")+` Tm
`):Vn=$(dn)+" "+$(hn)+` Td
`,Vn},oo=0;oo<xt.length;oo++){switch(Zs="",Za){case Wl:Xs=(Cr?"<":"(")+xt[oo][0]+(Cr?">":")"),Ja=parseFloat(xt[oo][1]),Qa=parseFloat(xt[oo][2]);break;case Xa:Xs=(Cr?"<":"(")+xt[oo]+(Cr?">":")"),Ja=Wi(me),Qa=jn(Ne)}Js!==void 0&&Js[oo]!==void 0&&(Zs=Js[oo]+` Tw
`),oo===0?A.push(Zs+Uc(Ja,Qa,tt)+Xs):Za===Xa?A.push(Zs+Xs):Za===Wl&&A.push(Zs+Uc(Ja,Qa,tt)+Xs)}A=Za===Xa?A.join(` Tj
T* `):A.join(` Tj
`),A+=` Tj
`;var so=`BT
/`;return so+=Je+" "+ge+` Tf
`,so+=$(ge*Zr)+` TL
`,so+=vo+`
`,so+=Dr,so+=A,Y(so+="ET"),g[Je]=!0,Ct};var Fc=f.__private__.clip=f.clip=function(A){return Y(A==="evenodd"?"W*":"W"),this};f.clipEvenOdd=function(){return Fc("evenodd")},f.__private__.discardPath=f.discardPath=function(){return Y("n"),this};var ro=f.__private__.isValidStyle=function(A){var me=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(A)!==-1&&(me=!0),me};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(A){return ro(A)&&(u=A),this};var Ml=f.__private__.getStyle=f.getStyle=function(A){var me=u;switch(A){case"D":case"S":me="S";break;case"F":me="f";break;case"FD":case"DF":me="B";break;case"f":case"f*":case"B":case"B*":me=A}return me},Hi=f.close=function(){return Y("h"),this};f.stroke=function(){return Y("S"),this},f.fill=function(A){return Os("f",A),this},f.fillEvenOdd=function(A){return Os("f*",A),this},f.fillStroke=function(A){return Os("B",A),this},f.fillStrokeEvenOdd=function(A){return Os("B*",A),this};var Os=function(A,me){nn(me)==="object"?js(me,A):Y(A)},qa=function(A){A===null||ee===q.ADVANCED&&A===void 0||(A=Ml(A),Y(A))};function Bs(A,me,Ne,Me,He){var st=new fl(me||this.boundingBox,Ne||this.xStep,Me||this.yStep,this.gState,He||this.matrix);st.stream=this.stream;var xt=A+"$$"+this.cloneIndex+++"$$";return At(xt,st),st}var js=function(A,me){var Ne=kt[A.key],Me=ct[Ne];if(Me instanceof va)Y("q"),Y(Fl(me)),Me.gState&&f.setGState(Me.gState),Y(A.matrix.toString()+" cm"),Y("/"+Ne+" sh"),Y("Q");else if(Me instanceof fl){var He=new It(1,0,0,-1,0,ii());A.matrix&&(He=He.multiply(A.matrix||Nt),Ne=Bs.call(Me,A.key,A.boundingBox,A.xStep,A.yStep,He).id),Y("q"),Y("/Pattern cs"),Y("/"+Ne+" scn"),Me.gState&&f.setGState(Me.gState),Y(me),Y("Q")}},Fl=function(A){switch(A){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},yo=f.moveTo=function(A,me){return Y($(P(A))+" "+$(z(me))+" m"),this},Gi=f.lineTo=function(A,me){return Y($(P(A))+" "+$(z(me))+" l"),this},go=f.curveTo=function(A,me,Ne,Me,He,st){return Y([$(P(A)),$(z(me)),$(P(Ne)),$(z(Me)),$(P(He)),$(z(st)),"c"].join(" ")),this};f.__private__.line=f.line=function(A,me,Ne,Me,He){if(isNaN(A)||isNaN(me)||isNaN(Ne)||isNaN(Me)||!ro(He))throw new Error("Invalid arguments passed to jsPDF.line");return ee===q.COMPAT?this.lines([[Ne-A,Me-me]],A,me,[1,1],He||"S"):this.lines([[Ne-A,Me-me]],A,me,[1,1]).stroke()},f.__private__.lines=f.lines=function(A,me,Ne,Me,He,st){var xt,qt,p,V,le,we,Ve,tt,Ct,Ar,Dr,Cr;if(typeof A=="number"&&(Cr=Ne,Ne=me,me=A,A=Cr),Me=Me||[1,1],st=st||!1,isNaN(me)||isNaN(Ne)||!Array.isArray(A)||!Array.isArray(Me)||!ro(He)||typeof st!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(yo(me,Ne),xt=Me[0],qt=Me[1],V=A.length,Ar=me,Dr=Ne,p=0;p<V;p++)(le=A[p]).length===2?(Ar=le[0]*xt+Ar,Dr=le[1]*qt+Dr,Gi(Ar,Dr)):(we=le[0]*xt+Ar,Ve=le[1]*qt+Dr,tt=le[2]*xt+Ar,Ct=le[3]*qt+Dr,Ar=le[4]*xt+Ar,Dr=le[5]*qt+Dr,go(we,Ve,tt,Ct,Ar,Dr));return st&&Hi(),qa(He),this},f.path=function(A){for(var me=0;me<A.length;me++){var Ne=A[me],Me=Ne.c;switch(Ne.op){case"m":yo(Me[0],Me[1]);break;case"l":Gi(Me[0],Me[1]);break;case"c":go.apply(this,Me);break;case"h":Hi()}}return this},f.__private__.rect=f.rect=function(A,me,Ne,Me,He){if(isNaN(A)||isNaN(me)||isNaN(Ne)||isNaN(Me)||!ro(He))throw new Error("Invalid arguments passed to jsPDF.rect");return ee===q.COMPAT&&(Me=-Me),Y([$(P(A)),$(z(me)),$(P(Ne)),$(P(Me)),"re"].join(" ")),qa(He),this},f.__private__.triangle=f.triangle=function(A,me,Ne,Me,He,st,xt){if(isNaN(A)||isNaN(me)||isNaN(Ne)||isNaN(Me)||isNaN(He)||isNaN(st)||!ro(xt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Ne-A,Me-me],[He-Ne,st-Me],[A-He,me-st]],A,me,[1,1],xt,!0),this},f.__private__.roundedRect=f.roundedRect=function(A,me,Ne,Me,He,st,xt){if(isNaN(A)||isNaN(me)||isNaN(Ne)||isNaN(Me)||isNaN(He)||isNaN(st)||!ro(xt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var qt=4/3*(Math.SQRT2-1);return He=Math.min(He,.5*Ne),st=Math.min(st,.5*Me),this.lines([[Ne-2*He,0],[He*qt,0,He,st-st*qt,He,st],[0,Me-2*st],[0,st*qt,-He*qt,st,-He,st],[2*He-Ne,0],[-He*qt,0,-He,-st*qt,-He,-st],[0,2*st-Me],[0,-st*qt,He*qt,-st,He,-st]],A+He,me,[1,1],xt,!0),this},f.__private__.ellipse=f.ellipse=function(A,me,Ne,Me,He){if(isNaN(A)||isNaN(me)||isNaN(Ne)||isNaN(Me)||!ro(He))throw new Error("Invalid arguments passed to jsPDF.ellipse");var st=4/3*(Math.SQRT2-1)*Ne,xt=4/3*(Math.SQRT2-1)*Me;return yo(A+Ne,me),go(A+Ne,me-xt,A+st,me-Me,A,me-Me),go(A-st,me-Me,A-Ne,me-xt,A-Ne,me),go(A-Ne,me+xt,A-st,me+Me,A,me+Me),go(A+st,me+Me,A+Ne,me+xt,A+Ne,me),qa(He),this},f.__private__.circle=f.circle=function(A,me,Ne,Me){if(isNaN(A)||isNaN(me)||isNaN(Ne)||!ro(Me))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(A,me,Ne,Ne,Me)},f.setFont=function(A,me,Ne){return Ne&&(me=te(me,Ne)),Je=qi(A,me,{disableWarning:!1}),this};var za=f.__private__.getFont=f.getFont=function(){return ot[qi.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var A,me,Ne={};for(A in Qe)if(Qe.hasOwnProperty(A))for(me in Ne[A]=[],Qe[A])Qe[A].hasOwnProperty(me)&&Ne[A].push(me);return Ne},f.addFont=function(A,me,Ne,Me,He){var st=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&st.indexOf(arguments[3])!==-1?He=arguments[3]:arguments[3]&&st.indexOf(arguments[3])==-1&&(Ne=te(Ne,Me)),He=He||"Identity-H",mr.call(this,A,me,Ne,He)};var Xr,Ua=t.lineWidth||.200025,Vs=f.__private__.getLineWidth=f.getLineWidth=function(){return Ua},Ha=f.__private__.setLineWidth=f.setLineWidth=function(A){return Ua=A,Y($(P(A))+" w"),this};f.__private__.setLineDash=hr.API.setLineDash=hr.API.setLineDashPattern=function(A,me){if(A=A||[],me=me||0,isNaN(me)||!Array.isArray(A))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return A=A.map(function(Ne){return $(P(Ne))}).join(" "),me=$(P(me)),Y("["+A+"] "+me+" d"),this};var Ga=f.__private__.getLineHeight=f.getLineHeight=function(){return ge*Xr};f.__private__.getLineHeight=f.getLineHeight=function(){return ge*Xr};var Wa=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(A){return typeof(A=A||1.15)=="number"&&(Xr=A),this},as=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return Xr};Wa(t.lineHeight);var Wi=f.__private__.getHorizontalCoordinate=function(A){return P(A)},jn=f.__private__.getVerticalCoordinate=function(A){return ee===q.ADVANCED?A:St[D].mediaBox.topRightY-St[D].mediaBox.bottomLeftY-P(A)},Ol=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(A){return $(Wi(A))},Fo=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(A){return $(jn(A))},Kn=t.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return vt(Kn)},f.__private__.setStrokeColor=f.setDrawColor=function(A,me,Ne,Me){return Kn=Tt({ch1:A,ch2:me,ch3:Ne,ch4:Me,pdfColorType:"draw",precision:2}),Y(Kn),this};var qs=t.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return vt(qs)},f.__private__.setFillColor=f.setFillColor=function(A,me,Ne,Me){return qs=Tt({ch1:A,ch2:me,ch3:Ne,ch4:Me,pdfColorType:"fill",precision:2}),Y(qs),this};var vo=t.textColor||"0 g",zs=f.__private__.getTextColor=f.getTextColor=function(){return vt(vo)};f.__private__.setTextColor=f.setTextColor=function(A,me,Ne,Me){return vo=Tt({ch1:A,ch2:me,ch3:Ne,ch4:Me,pdfColorType:"text",precision:3}),this};var ls=t.charSpace,Us=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat(ls||0)};f.__private__.setCharSpace=f.setCharSpace=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return ls=A,this};var Ya=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(A){var me=f.CapJoinStyles[A];if(me===void 0)throw new Error("Line cap style of '"+A+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ya=me,Y(me+" J"),this};var Hs=0;f.__private__.setLineJoin=f.setLineJoin=function(A){var me=f.CapJoinStyles[A];if(me===void 0)throw new Error("Line join style of '"+A+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Hs=me,Y(me+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(A){if(A=A||0,isNaN(A))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Y($(P(A))+" M"),this},f.GState=Hu,f.setGState=function(A){(A=typeof A=="string"?gt[qe[A]]:Oo(null,A)).equals(Dt)||(Y("/"+A.id+" gs"),Dt=A)};var Oo=function(A,me){if(!A||!qe[A]){var Ne=!1;for(var Me in gt)if(gt.hasOwnProperty(Me)&&gt[Me].equals(me)){Ne=!0;break}if(Ne)me=gt[Me];else{var He="GS"+(Object.keys(gt).length+1).toString(10);gt[He]=me,me.id=He}return A&&(qe[A]=me.id),Bt.publish("addGState",me),me}};f.addGState=function(A,me){return Oo(A,me),this},f.saveGraphicsState=function(){return Y("q"),dt.push({key:Je,size:ge,color:vo}),this},f.restoreGraphicsState=function(){Y("Q");var A=dt.pop();return Je=A.key,ge=A.size,vo=A.color,Dt=null,this},f.setCurrentTransformationMatrix=function(A){return Y(A.toString()+" cm"),this},f.comment=function(A){return Y("#"+A),this};var cs=function(A,me){var Ne=A||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Ne},set:function(st){isNaN(st)||(Ne=parseFloat(st))}});var Me=me||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Me},set:function(st){isNaN(st)||(Me=parseFloat(st))}});var He="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return He},set:function(st){He=st.toString()}}),this},Gs=function(A,me,Ne,Me){cs.call(this,A,me),this.type="rect";var He=Ne||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return He},set:function(xt){isNaN(xt)||(He=parseFloat(xt))}});var st=Me||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return st},set:function(xt){isNaN(xt)||(st=parseFloat(xt))}}),this},us=function(){this.page=Rt,this.currentPage=D,this.pages=G.slice(0),this.pagesContext=St.slice(0),this.x=Ke,this.y=Xe,this.matrix=at,this.width=Bo(D),this.height=ii(D),this.outputDestination=oe,this.id="",this.objectNumber=-1};us.prototype.restore=function(){Rt=this.page,D=this.currentPage,St=this.pagesContext,G=this.pages,Ke=this.x,Xe=this.y,at=this.matrix,Ys(D,this.width),Ks(D,this.height),oe=this.outputDestination};var Ws=function(A,me,Ne,Me,He){xr.push(new us),Rt=D=0,G=[],Ke=A,Xe=me,at=He,Rr([Ne,Me])},Bl=function(A){if(cr[A])xr.pop().restore();else{var me=new us,Ne="Xo"+(Object.keys(Qt).length+1).toString(10);me.id=Ne,cr[A]=Ne,Qt[Ne]=me,Bt.publish("addFormObject",me),xr.pop().restore()}};for(var bo in f.beginFormObject=function(A,me,Ne,Me,He){return Ws(A,me,Ne,Me,He),this},f.endFormObject=function(A){return Bl(A),this},f.doFormObject=function(A,me){var Ne=Qt[cr[A]];return Y("q"),Y(me.toString()+" cm"),Y("/"+Ne.id+" Do"),Y("Q"),this},f.getFormObject=function(A){var me=Qt[cr[A]];return{x:me.x,y:me.y,width:me.width,height:me.height,matrix:me.matrix}},f.save=function(A,me){return A=A||"generated.pdf",(me=me||{}).returnPromise=me.returnPromise||!1,me.returnPromise===!1?(sl(Ms(wi()),A),typeof sl.unload=="function"&&gr.setTimeout&&setTimeout(sl.unload,911),this):new Promise(function(Ne,Me){try{var He=sl(Ms(wi()),A);typeof sl.unload=="function"&&gr.setTimeout&&setTimeout(sl.unload,911),Ne(He)}catch(st){Me(st.message)}})},hr.API)hr.API.hasOwnProperty(bo)&&(bo==="events"&&hr.API.events.length?function(A,me){var Ne,Me,He;for(He=me.length-1;He!==-1;He--)Ne=me[He][0],Me=me[He][1],A.subscribe.apply(A,[Ne].concat(typeof Me=="function"?[Me]:Me))}(Bt,hr.API.events):f[bo]=hr.API[bo]);var Bo=f.getPageWidth=function(A){return(St[A=A||D].mediaBox.topRightX-St[A].mediaBox.bottomLeftX)/Be},Ys=f.setPageWidth=function(A,me){St[A].mediaBox.topRightX=me*Be+St[A].mediaBox.bottomLeftX},ii=f.getPageHeight=function(A){return(St[A=A||D].mediaBox.topRightY-St[A].mediaBox.bottomLeftY)/Be},Ks=f.setPageHeight=function(A,me){St[A].mediaBox.topRightY=me*Be+St[A].mediaBox.bottomLeftY};return f.internal={pdfEscape:qr,getStyle:Ml,getFont:za,getFontSize:pe,getCharSpace:Us,getTextColor:zs,getLineHeight:Ga,getLineHeightFactor:as,getLineWidth:Vs,write:ie,getHorizontalCoordinate:Wi,getVerticalCoordinate:jn,getCoordinateString:Ol,getVerticalCoordinateString:Fo,collections:{},newObject:Lt,newAdditionalObject:_t,newObjectDeferred:Ue,newObjectDeferredBegin:nt,getFilters:jt,putStream:Kt,events:Bt,scaleFactor:Be,pageSize:{getWidth:function(){return Bo(D)},setWidth:function(A){Ys(D,A)},getHeight:function(){return ii(D)},setHeight:function(A){Ks(D,A)}},encryptionOptions:h,encryption:fn,getEncryptor:Dl,output:Fs,getNumberOfPages:Hr,pages:G,out:Y,f2:O,f3:b,getPageInfo:Va,getPageInfoByObjId:Sr,getCurrentPageInfo:Mo,getPDFVersion:S,Point:cs,Rectangle:Gs,Matrix:It,hasHotfix:Do},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return Bo(D)},set:function(A){Ys(D,A)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return ii(D)},set:function(A){Ks(D,A)},enumerable:!0,configurable:!0}),Nr.call(f,ue),Je="F1",Bn(i,r),Bt.publish("initialized"),f}dc.prototype.lsbFirstWord=function(t){return String.fromCharCode(t>>0&255,t>>8&255,t>>16&255,t>>24&255)},dc.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},dc.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},dc.prototype.processOwnerPassword=function(t,e){return Nm(km(e).substr(0,5),t)},dc.prototype.encryptor=function(t,e){var r=km(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return Nm(r,n)}},Hu.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||nn(t)!==nn(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},hr.API={events:[]},hr.version="3.0.1";var Sn=hr.API,Yy=1,Rl=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},nc=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Ir=function(t){return t.toFixed(2)},pa=function(t){return t.toFixed(5)};Sn.__acroform__={};var Vi=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},W0=function(t){return t*Yy},Ho=function(t){var e=new J5,r=Xt.internal.getHeight(t)||0,n=Xt.internal.getWidth(t)||0;return e.BBox=[0,0,Number(Ir(n)),Number(Ir(r))],e},OL=Sn.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|=1<<e},BL=Sn.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&=~(1<<e)},jL=Sn.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return(t&1<<e)==0?0:1},In=Sn.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return jL(t,e-1)},$n=Sn.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return OL(t,e-1)},En=Sn.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return BL(t,e-1)},VL=Sn.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,i=t[0],o=t[1],s=t[2],l=t[3],c={};return c.lowerLeft_X=r(i)||0,c.lowerLeft_Y=n(o+l)||0,c.upperRight_X=r(i+s)||0,c.upperRight_Y=n(o)||0,[Number(Ir(c.lowerLeft_X)),Number(Ir(c.lowerLeft_Y)),Number(Ir(c.upperRight_X)),Number(Ir(c.upperRight_Y))]},qL=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=Lm(t,r),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+i+" "+Ir(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var o=Ho(t);return o.scope=t.scope,o.stream=e.join(`
`),o}},Lm=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=t.multiline?i.map(function(b){return b.split(`
`)}):i.map(function(b){return[b]});var o=r,s=Xt.internal.getHeight(t)||0;s=s<0?-s:s;var l=Xt.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(b,P,_){if(b+1<i.length){var z=P+" "+i[b+1][0];return Jd(z,t,_).width<=l-4}return!1};o++;e:for(;o>0;){e="",o--;var u,h,y=Jd("3",t,o).height,g=t.multiline?s-o:(s-y)/2,f=g+=2,x=0,S=0,w=0;if(o<=0){e=`(...) Tj
`,e+="% Width of Text: "+Jd(e,t,o=12).width+", FieldWidth:"+l+`
`;break}for(var E="",q=0,ee=0;ee<i.length;ee++)if(i.hasOwnProperty(ee)){var W=!1;if(i[ee].length!==1&&w!==i[ee].length-1){if((y+2)*(q+2)+2>s)continue e;E+=i[ee][w],W=!0,S=ee,ee--}else{E=(E+=i[ee][w]+" ").substr(E.length-1)==" "?E.substr(0,E.length-1):E;var K=parseInt(ee),te=c(K,E,o),$=ee>=i.length-1;if(te&&!$){E+=" ",w=0;continue}if(te||$){if($)S=K;else if(t.multiline&&(y+2)*(q+2)+2>s)continue e}else{if(!t.multiline||(y+2)*(q+2)+2>s)continue e;S=K}}for(var C="",T=x;T<=S;T++){var O=i[T];if(t.multiline){if(T===S){C+=O[w]+" ",w=(w+1)%O.length;continue}if(T===x){C+=O[O.length-1]+" ";continue}}C+=O[0]+" "}switch(C=C.substr(C.length-1)==" "?C.substr(0,C.length-1):C,h=Jd(C,t,o).width,t.textAlign){case"right":u=l-h-2;break;case"center":u=(l-h)/2;break;case"left":default:u=2}e+=Ir(u)+" "+Ir(f)+` Td
`,e+="("+Rl(C)+`) Tj
`,e+=-Ir(u)+` 0 Td
`,f=-(o+2),h=0,x=W?S:S+1,q++,E=""}break}return n.text=e,n.fontSize=o,n},Jd=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},zL={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},UL=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},HL=function(t,e){for(var r in t)if(t.hasOwnProperty(r)){var n=r,i=t[r];e.internal.newObjectDeferredBegin(i.objId,!0),nn(i)==="object"&&typeof i.putStream=="function"&&i.putStream(),delete t[n]}},GL=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Lo.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(zL)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Yy=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new Q5,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var o=n[i];o.objId=void 0,o.hasAnnotation&&UL(o,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,i){var o=!n;for(var s in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var l=n[s],c=[],u=l.Rect;if(l.Rect&&(l.Rect=VL(l.Rect,i)),i.internal.newObjectDeferredBegin(l.objId,!0),l.DA=Xt.createDefaultAppearanceStream(l),nn(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var h=qL(l);c.push({key:"AP",value:"<</N "+h+">>"}),i.internal.acroformPlugin.xForms.push(h)}if(l.appearanceStreamContent){var y="";for(var g in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(g)){var f=l.appearanceStreamContent[g];if(y+="/"+g+" ",y+="<<",Object.keys(f).length>=1||Array.isArray(f)){for(var s in f)if(f.hasOwnProperty(s)){var x=f[s];typeof x=="function"&&(x=x.call(i,l)),y+="/"+s+" "+x+" ",i.internal.acroformPlugin.xForms.indexOf(x)>=0||i.internal.acroformPlugin.xForms.push(x)}}else typeof(x=f)=="function"&&(x=x.call(i,l)),y+="/"+s+" "+x,i.internal.acroformPlugin.xForms.indexOf(x)>=0||i.internal.acroformPlugin.xForms.push(x);y+=">>"}c.push({key:"AP",value:`<<
`+y+">>"})}i.internal.putStream({additionalKeyValues:c,objectId:l.objId}),i.internal.out("endobj")}o&&HL(i.internal.acroformPlugin.xForms,i)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},K5=Sn.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(s){return s};if(Array.isArray(t)){for(var i="[",o=0;o<t.length;o++)switch(o!==0&&(i+=" "),nn(t[o])){case"boolean":case"number":case"object":i+=t[o].toString();break;case"string":t[o].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),i+="("+Rl(n(t[o].toString()))+")"):i+=t[o].toString()}return i+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Ef=function(t,e,r){var n=function(i){return i};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),t="("+Rl(n(t))+")"},Yo=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Yo.prototype.toString=function(){return this.objId+" 0 R"},Yo.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},Yo.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(o){return o!="content"&&o!="appearanceStreamContent"&&o!="scope"&&o!="objId"&&o.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],i=this[n];i&&(Array.isArray(i)?t.push({key:n,value:K5(i,this.objId,this.scope)}):i instanceof Yo?(i.scope=this.scope,t.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&t.push({key:n,value:i}))}return t};var J5=function(){Yo.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};Vi(J5,Yo);var Q5=function(){Yo.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Rl(r(t))+")"}},set:function(r){t=r}})};Vi(Q5,Yo);var Lo=function t(){Yo.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(E){if(isNaN(E))throw new Error('Invalid value "'+E+'" for attribute F supplied.');e=E}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!In(e,3)},set:function(E){E?this.F=$n(e,3):this.F=En(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(E){if(isNaN(E))throw new Error('Invalid value "'+E+'" for attribute Ff supplied.');r=E}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(E){n=E!==void 0?E:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(E){n[0]=E}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(E){n[1]=E}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(E){n[2]=E}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(E){n[3]=E}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(E){switch(E){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=E;break;default:throw new Error('Invalid value "'+E+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof Wh)return;o="FieldObject"+t.FieldNum++}var E=function(q){return q};return this.scope&&(E=this.scope.internal.getEncryptor(this.objId)),"("+Rl(E(o))+")"},set:function(E){o=E.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(E){o=E}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(E){s=E}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(E){l=E}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(E){c=E}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/Yy:u},set:function(E){u=E}});var h="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return h},set:function(E){h=E}});var y="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!y||this instanceof Wh||this instanceof Ia))return Ef(y,this.objId,this.scope)},set:function(E){E=E.toString(),y=E}});var g=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof zn?g:Ef(g,this.objId,this.scope)},set:function(E){E=E.toString(),g=this instanceof zn?E:E.substr(0,1)==="("?nc(E.substr(1,E.length-2)):nc(E)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof zn?nc(g.substr(1,g.length-1)):g},set:function(E){E=E.toString(),g=this instanceof zn?"/"+E:E}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(E){this.V=E}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof zn?f:Ef(f,this.objId,this.scope)},set:function(E){E=E.toString(),f=this instanceof zn?E:E.substr(0,1)==="("?nc(E.substr(1,E.length-2)):nc(E)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof zn?nc(f.substr(1,f.length-1)):f},set:function(E){E=E.toString(),f=this instanceof zn?"/"+E:E}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var x,S=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return S},set:function(E){E=!!E,S=E}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(x)return x},set:function(E){x=E}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,1)},set:function(E){E?this.Ff=$n(this.Ff,1):this.Ff=En(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,2)},set:function(E){E?this.Ff=$n(this.Ff,2):this.Ff=En(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,3)},set:function(E){E?this.Ff=$n(this.Ff,3):this.Ff=En(this.Ff,3)}});var w=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(w!==null)return w},set:function(E){if([0,1,2].indexOf(E)===-1)throw new Error('Invalid value "'+E+'" for attribute Q supplied.');w=E}}),Object.defineProperty(this,"textAlign",{get:function(){var E;switch(w){case 0:default:E="left";break;case 1:E="center";break;case 2:E="right"}return E},configurable:!0,enumerable:!0,set:function(E){switch(E){case"right":case 2:w=2;break;case"center":case 1:w=1;break;case"left":case 0:default:w=0}}})};Vi(Lo,Yo);var bl=function(){Lo.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return K5(e,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=function(o,s,l){l||(l=1);for(var c,u=[];c=s.exec(o);)u.push(c[l]);return u}(n,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,18)},set:function(r){r?this.Ff=$n(this.Ff,18):this.Ff=En(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=$n(this.Ff,19):this.Ff=En(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,20)},set:function(r){r?(this.Ff=$n(this.Ff,20),e.sort()):this.Ff=En(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,22)},set:function(r){r?this.Ff=$n(this.Ff,22):this.Ff=En(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,23)},set:function(r){r?this.Ff=$n(this.Ff,23):this.Ff=En(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,27)},set:function(r){r?this.Ff=$n(this.Ff,27):this.Ff=En(this.Ff,27)}}),this.hasAppearanceStream=!1};Vi(bl,Lo);var _l=function(){bl.call(this),this.fontName="helvetica",this.combo=!1};Vi(_l,bl);var Sl=function(){_l.call(this),this.combo=!0};Vi(Sl,_l);var xu=function(){Sl.call(this),this.edit=!0};Vi(xu,Sl);var zn=function(){Lo.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,15)},set:function(r){r?this.Ff=$n(this.Ff,15):this.Ff=En(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,16)},set:function(r){r?this.Ff=$n(this.Ff,16):this.Ff=En(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,17)},set:function(r){r?this.Ff=$n(this.Ff,17):this.Ff=En(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,26)},set:function(r){r?this.Ff=$n(this.Ff,26):this.Ff=En(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(o){return o};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,i=[];for(n in i.push("<<"),e)i.push("/"+n+" ("+Rl(r(e[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){nn(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};Vi(zn,Lo);var Au=function(){zn.call(this),this.pushButton=!0};Vi(Au,zn);var Pl=function(){zn.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};Vi(Pl,zn);var Wh=function(){var t,e;Lo.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(l){return l};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var o,s=[];for(o in s.push("<<"),n)s.push("/"+o+" ("+Rl(i(n[o]))+")");return s.push(">>"),s.join(`
`)},set:function(i){nn(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Xt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Vi(Wh,Lo),Pl.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},Pl.prototype.createOption=function(t){var e=new Wh;return e.Parent=this,e.optionName=t,this.Kids.push(e),WL.call(this.scope,e),e};var Cu=function(){zn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Xt.CheckBox.createAppearanceStream()};Vi(Cu,zn);var Ia=function(){Lo.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,13)},set:function(e){e?this.Ff=$n(this.Ff,13):this.Ff=En(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,21)},set:function(e){e?this.Ff=$n(this.Ff,21):this.Ff=En(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,23)},set:function(e){e?this.Ff=$n(this.Ff,23):this.Ff=En(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,24)},set:function(e){e?this.Ff=$n(this.Ff,24):this.Ff=En(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,25)},set:function(e){e?this.Ff=$n(this.Ff,25):this.Ff=En(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,26)},set:function(e){e?this.Ff=$n(this.Ff,26):this.Ff=En(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Vi(Ia,Lo);var Iu=function(){Ia.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,14)},set:function(t){t?this.Ff=$n(this.Ff,14):this.Ff=En(this.Ff,14)}}),this.password=!0};Vi(Iu,Ia);var Xt={CheckBox:{createAppearanceStream:function(){return{N:{On:Xt.CheckBox.YesNormal},D:{On:Xt.CheckBox.YesPushDown,Off:Xt.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Ho(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),o=Lm(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+Ir(Xt.internal.getWidth(t))+" "+Ir(Xt.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Ir(o.fontSize)+" Tf "+i),r.push("BT"),r.push(o.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=Ho(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),i=[],o=Xt.internal.getHeight(t),s=Xt.internal.getWidth(t),l=Lm(t,t.caption);return i.push("1 g"),i.push("0 0 "+Ir(s)+" "+Ir(o)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+Ir(s-1)+" "+Ir(o-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+Ir(l.fontSize)+" Tf "+n),i.push(l.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=Ho(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Ir(Xt.internal.getWidth(t))+" "+Ir(Xt.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:Xt.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=Xt.RadioButton.Circle.YesNormal,e.D[t]=Xt.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Ho(t);e.scope=t.scope;var r=[],n=Xt.internal.getWidth(t)<=Xt.internal.getHeight(t)?Xt.internal.getWidth(t)/4:Xt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Xt.internal.Bezier_C,o=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+pa(Xt.internal.getWidth(t)/2)+" "+pa(Xt.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Ho(t);e.scope=t.scope;var r=[],n=Xt.internal.getWidth(t)<=Xt.internal.getHeight(t)?Xt.internal.getWidth(t)/4:Xt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),o=Number((i*Xt.internal.Bezier_C).toFixed(5)),s=Number((n*Xt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+pa(Xt.internal.getWidth(t)/2)+" "+pa(Xt.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),r.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),r.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),r.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+pa(Xt.internal.getWidth(t)/2)+" "+pa(Xt.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=Ho(t);e.scope=t.scope;var r=[],n=Xt.internal.getWidth(t)<=Xt.internal.getHeight(t)?Xt.internal.getWidth(t)/4:Xt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),o=Number((i*Xt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+pa(Xt.internal.getWidth(t)/2)+" "+pa(Xt.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),r.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),r.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),r.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:Xt.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=Xt.RadioButton.Cross.YesNormal,e.D[t]=Xt.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Ho(t);e.scope=t.scope;var r=[],n=Xt.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+Ir(Xt.internal.getWidth(t)-2)+" "+Ir(Xt.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(Ir(n.x1.x)+" "+Ir(n.x1.y)+" m"),r.push(Ir(n.x2.x)+" "+Ir(n.x2.y)+" l"),r.push(Ir(n.x4.x)+" "+Ir(n.x4.y)+" m"),r.push(Ir(n.x3.x)+" "+Ir(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Ho(t);e.scope=t.scope;var r=Xt.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+Ir(Xt.internal.getWidth(t))+" "+Ir(Xt.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Ir(Xt.internal.getWidth(t)-2)+" "+Ir(Xt.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(Ir(r.x1.x)+" "+Ir(r.x1.y)+" m"),n.push(Ir(r.x2.x)+" "+Ir(r.x2.y)+" l"),n.push(Ir(r.x4.x)+" "+Ir(r.x4.y)+" m"),n.push(Ir(r.x3.x)+" "+Ir(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=Ho(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Ir(Xt.internal.getWidth(t))+" "+Ir(Xt.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};Xt.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=Xt.internal.getWidth(t),r=Xt.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},Xt.internal.getWidth=function(t){var e=0;return nn(t)==="object"&&(e=W0(t.Rect[2])),e},Xt.internal.getHeight=function(t){var e=0;return nn(t)==="object"&&(e=W0(t.Rect[3])),e};var WL=Sn.addField=function(t){if(GL(this,t),!(t instanceof Lo))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Sn.AcroFormChoiceField=bl,Sn.AcroFormListBox=_l,Sn.AcroFormComboBox=Sl,Sn.AcroFormEditBox=xu,Sn.AcroFormButton=zn,Sn.AcroFormPushButton=Au,Sn.AcroFormRadioButton=Pl,Sn.AcroFormCheckBox=Cu,Sn.AcroFormTextField=Ia,Sn.AcroFormPasswordField=Iu,Sn.AcroFormAppearance=Xt,Sn.AcroForm={ChoiceField:bl,ListBox:_l,ComboBox:Sl,EditBox:xu,Button:zn,PushButton:Au,RadioButton:Pl,CheckBox:Cu,TextField:Ia,PasswordField:Iu,Appearance:Xt},hr.AcroForm={ChoiceField:bl,ListBox:_l,ComboBox:Sl,EditBox:xu,Button:zn,PushButton:Au,RadioButton:Pl,CheckBox:Cu,TextField:Ia,PasswordField:Iu,Appearance:Xt};var YL=hr.AcroForm;function X5(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){t.__addimage__={};var e="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=t.__addimage__.getImageFileTypeByImageData=function(b,P){var _,z,Z,k,F,X=e;if((P=P||e)==="RGBA"||b.data!==void 0&&b.data instanceof Uint8ClampedArray&&"height"in b&&"width"in b)return"RGBA";if(te(b))for(F in r)for(Z=r[F],_=0;_<Z.length;_+=1){for(k=!0,z=0;z<Z[_].length;z+=1)if(Z[_][z]!==void 0&&Z[_][z]!==b[z]){k=!1;break}if(k===!0){X=F;break}}else for(F in r)for(Z=r[F],_=0;_<Z.length;_+=1){for(k=!0,z=0;z<Z[_].length;z+=1)if(Z[_][z]!==void 0&&Z[_][z]!==b.charCodeAt(z)){k=!1;break}if(k===!0){X=F;break}}return X===e&&P!==e&&(X=P),X},i=function b(P){for(var _=this.internal.write,z=this.internal.putStream,Z=(0,this.internal.getFilters)();Z.indexOf("FlateEncode")!==-1;)Z.splice(Z.indexOf("FlateEncode"),1);P.objectId=this.internal.newObject();var k=[];if(k.push({key:"Type",value:"/XObject"}),k.push({key:"Subtype",value:"/Image"}),k.push({key:"Width",value:P.width}),k.push({key:"Height",value:P.height}),P.colorSpace===w.INDEXED?k.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(P.palette.length/3-1)+" "+("sMask"in P&&P.sMask!==void 0?P.objectId+2:P.objectId+1)+" 0 R]"}):(k.push({key:"ColorSpace",value:"/"+P.colorSpace}),P.colorSpace===w.DEVICE_CMYK&&k.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),k.push({key:"BitsPerComponent",value:P.bitsPerComponent}),"decodeParameters"in P&&P.decodeParameters!==void 0&&k.push({key:"DecodeParms",value:"<<"+P.decodeParameters+">>"}),"transparency"in P&&Array.isArray(P.transparency)){for(var F="",X=0,U=P.transparency.length;X<U;X++)F+=P.transparency[X]+" "+P.transparency[X]+" ";k.push({key:"Mask",value:"["+F+"]"})}P.sMask!==void 0&&k.push({key:"SMask",value:P.objectId+1+" 0 R"});var B=P.filter!==void 0?["/"+P.filter]:void 0;if(z({data:P.data,additionalKeyValues:k,alreadyAppliedFilters:B,objectId:P.objectId}),_("endobj"),"sMask"in P&&P.sMask!==void 0){var ce="/Predictor "+P.predictor+" /Colors 1 /BitsPerComponent "+P.bitsPerComponent+" /Columns "+P.width,L={width:P.width,height:P.height,colorSpace:"DeviceGray",bitsPerComponent:P.bitsPerComponent,decodeParameters:ce,data:P.sMask};"filter"in P&&(L.filter=P.filter),b.call(this,L)}if(P.colorSpace===w.INDEXED){var D=this.internal.newObject();z({data:C(new Uint8Array(P.palette)),objectId:D}),_("endobj")}},o=function(){var b=this.internal.collections.addImage_images;for(var P in b)i.call(this,b[P])},s=function(){var b,P=this.internal.collections.addImage_images,_=this.internal.write;for(var z in P)_("/I"+(b=P[z]).index,b.objectId,"0","R")},l=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",s))},c=function(){var b=this.internal.collections.addImage_images;return l.call(this),b},u=function(){return Object.keys(this.internal.collections.addImage_images).length},h=function(b){return typeof t["process"+b.toUpperCase()]=="function"},y=function(b){return nn(b)==="object"&&b.nodeType===1},g=function(b,P){if(b.nodeName==="IMG"&&b.hasAttribute("src")){var _=""+b.getAttribute("src");if(_.indexOf("data:image/")===0)return wu(unescape(_).split("base64,").pop());var z=t.loadFile(_,!0);if(z!==void 0)return z}if(b.nodeName==="CANVAS"){if(b.width===0||b.height===0)throw new Error("Given canvas must have data. Canvas width: "+b.width+", height: "+b.height);var Z;switch(P){case"PNG":Z="image/png";break;case"WEBP":Z="image/webp";break;case"JPEG":case"JPG":default:Z="image/jpeg"}return wu(b.toDataURL(Z,1).split("base64,").pop())}},f=function(b){var P=this.internal.collections.addImage_images;if(P){for(var _ in P)if(b===P[_].alias)return P[_]}},x=function(b,P,_){return b||P||(b=-96,P=-96),b<0&&(b=-1*_.width*72/b/this.internal.scaleFactor),P<0&&(P=-1*_.height*72/P/this.internal.scaleFactor),b===0&&(b=P*_.width/_.height),P===0&&(P=b*_.height/_.width),[b,P]},S=function(b,P,_,z,Z,k){var F=x.call(this,_,z,Z),X=this.internal.getCoordinateString,U=this.internal.getVerticalCoordinateString,B=c.call(this);if(_=F[0],z=F[1],B[Z.index]=Z,k){k*=Math.PI/180;var ce=Math.cos(k),L=Math.sin(k),D=function(I){return I.toFixed(4)},j=[D(ce),D(L),D(-1*L),D(ce),0,0,"cm"]}this.internal.write("q"),k?(this.internal.write([1,"0","0",1,X(b),U(P+z),"cm"].join(" ")),this.internal.write(j.join(" ")),this.internal.write([X(_),"0","0",X(z),"0","0","cm"].join(" "))):this.internal.write([X(_),"0","0",X(z),X(b),U(P+z),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+Z.index+" Do"),this.internal.write("Q")},w=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var E=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},q=t.__addimage__.sHashCode=function(b){var P,_,z=0;if(typeof b=="string")for(_=b.length,P=0;P<_;P++)z=(z<<5)-z+b.charCodeAt(P),z|=0;else if(te(b))for(_=b.byteLength/2,P=0;P<_;P++)z=(z<<5)-z+b[P],z|=0;return z},ee=t.__addimage__.validateStringAsBase64=function(b){(b=b||"").toString().trim();var P=!0;return b.length===0&&(P=!1),b.length%4!=0&&(P=!1),/^[A-Za-z0-9+/]+$/.test(b.substr(0,b.length-2))===!1&&(P=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(b.substr(-2))===!1&&(P=!1),P},W=t.__addimage__.extractImageFromDataUrl=function(b){if(b==null||!(b=b.trim()).startsWith("data:"))return null;var P=b.indexOf(",");return P<0?null:b.substring(0,P).trim().endsWith("base64")?b.substring(P+1):null},K=t.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};t.__addimage__.isArrayBuffer=function(b){return K()&&b instanceof ArrayBuffer};var te=t.__addimage__.isArrayBufferView=function(b){return K()&&typeof Uint32Array<"u"&&(b instanceof Int8Array||b instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&b instanceof Uint8ClampedArray||b instanceof Int16Array||b instanceof Uint16Array||b instanceof Int32Array||b instanceof Uint32Array||b instanceof Float32Array||b instanceof Float64Array)},$=t.__addimage__.binaryStringToUint8Array=function(b){for(var P=b.length,_=new Uint8Array(P),z=0;z<P;z++)_[z]=b.charCodeAt(z);return _},C=t.__addimage__.arrayBufferToBinaryString=function(b){for(var P="",_=te(b)?b:new Uint8Array(b),z=0;z<_.length;z+=8192)P+=String.fromCharCode.apply(null,_.subarray(z,z+8192));return P};t.addImage=function(){var b,P,_,z,Z,k,F,X,U;if(typeof arguments[1]=="number"?(P=e,_=arguments[1],z=arguments[2],Z=arguments[3],k=arguments[4],F=arguments[5],X=arguments[6],U=arguments[7]):(P=arguments[1],_=arguments[2],z=arguments[3],Z=arguments[4],k=arguments[5],F=arguments[6],X=arguments[7],U=arguments[8]),nn(b=arguments[0])==="object"&&!y(b)&&"imageData"in b){var B=b;b=B.imageData,P=B.format||P||e,_=B.x||_||0,z=B.y||z||0,Z=B.w||B.width||Z,k=B.h||B.height||k,F=B.alias||F,X=B.compression||X,U=B.rotation||B.angle||U}var ce=this.internal.getFilters();if(X===void 0&&ce.indexOf("FlateEncode")!==-1&&(X="SLOW"),isNaN(_)||isNaN(z))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var L=T.call(this,b,P,F,X);return S.call(this,_,z,Z,k,L,U),this};var T=function(b,P,_,z){var Z,k,F;if(typeof b=="string"&&n(b)===e){b=unescape(b);var X=O(b,!1);(X!==""||(X=t.loadFile(b,!0))!==void 0)&&(b=X)}if(y(b)&&(b=g(b,P)),P=n(b,P),!h(P))throw new Error("addImage does not support files of type '"+P+"', please ensure that a plugin for '"+P+"' support is added.");if(((F=_)==null||F.length===0)&&(_=function(U){return typeof U=="string"||te(U)?q(U):te(U.data)?q(U.data):null}(b)),(Z=f.call(this,_))||(K()&&(b instanceof Uint8Array||P==="RGBA"||(k=b,b=$(b))),Z=this["process"+P.toUpperCase()](b,u.call(this),_,function(U){return U&&typeof U=="string"&&(U=U.toUpperCase()),U in t.image_compression?U:E.NONE}(z),k)),!Z)throw new Error("An unknown error occurred whilst processing the image.");return Z},O=t.__addimage__.convertBase64ToBinaryString=function(b,P){P=typeof P!="boolean"||P;var _,z="";if(typeof b=="string"){var Z;_=(Z=W(b))!==null&&Z!==void 0?Z:b;try{z=wu(_)}catch(k){if(P)throw ee(_)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+k.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return z};t.getImageProperties=function(b){var P,_,z="";if(y(b)&&(b=g(b)),typeof b=="string"&&n(b)===e&&((z=O(b,!1))===""&&(z=t.loadFile(b)||""),b=z),_=n(b),!h(_))throw new Error("addImage does not support files of type '"+_+"', please ensure that a plugin for '"+_+"' support is added.");if(!K()||b instanceof Uint8Array||(b=$(b)),!(P=this["process"+_.toUpperCase()](b)))throw new Error("An unknown error occurred whilst processing the image");return P.fileType=_,P}})(hr.API),function(t){var e=function(r){if(r!==void 0&&r!="")return!0};hr.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,i,o,s=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,h=!1,y=0;y<u.length&&!h;y++)switch((n=u[y]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(h=!0);break;case"reference":case"text":case"freetext":h=!0}if(h!=0){this.internal.write("/Annots [");for(var g=0;g<u.length;g++){n=u[g];var f=this.internal.pdfEscape,x=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var S=this.internal.newAdditionalObject(),w=this.internal.newAdditionalObject(),E=this.internal.getEncryptor(S.objId),q=n.title||"Note";o="<</Type /Annot /Subtype /Text "+(i="/Rect ["+s(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+f(E(n.contents))+")",o+=" /Popup "+w.objId+" 0 R",o+=" /P "+c.objId+" 0 R",o+=" /T ("+f(E(q))+") >>",S.content=o;var ee=S.objId+" 0 R";o="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+s(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+ee,n.open&&(o+=" /Open true"),o+=" >>",w.content=o,this.internal.write(S.objId,"0 R",w.objId,"0 R");break;case"freetext":i="/Rect ["+s(n.bounds.x)+" "+l(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var W=n.color||"#000000";o="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+f(x(n.contents))+")",o+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+W+")",o+=" /Border [0 0 0]",o+=" >>",this.internal.write(o);break;case"link":if(n.options.name){var K=this.annotations._nameMap[n.options.name];n.options.pageNumber=K.page,n.options.top=K.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",o="",n.options.url)o="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+f(x(n.options.url))+") >>";else if(n.options.pageNumber)switch(o="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":o+=" /Fit]";break;case"FitH":o+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,o+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var te=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),o+=" /XYZ "+n.options.left+" "+te+" "+n.options.zoom+"]"}o!=""&&(o+=" >>",this.internal.write(o))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,i,o,s){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+i),h:u(n+o)},options:s,type:"link"})},t.textWithLink=function(r,n,i,o){var s,l,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(o.maxWidth!==void 0){l=o.maxWidth;var h=this.splitTextToSize(r,l).length;s=Math.ceil(u*h)}else l=c,s=u;return this.text(r,n,i,o),i+=.2*u,o.align==="center"&&(n-=c/2),o.align==="right"&&(n-=c),this.link(n,i-u,l,s,o),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(hr.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var o=t.__arabicParser__.isInArabicSubstitutionA=function(S){return e[S.charCodeAt(0)]!==void 0},s=t.__arabicParser__.isArabicLetter=function(S){return typeof S=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(S)},l=t.__arabicParser__.isArabicEndLetter=function(S){return s(S)&&o(S)&&e[S.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(S){return s(S)&&i.indexOf(S.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(S){return s(S)&&o(S)&&e[S.charCodeAt(0)].length>=1};var u=t.__arabicParser__.arabicLetterHasFinalForm=function(S){return s(S)&&o(S)&&e[S.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(S){return s(S)&&o(S)&&e[S.charCodeAt(0)].length>=3};var h=t.__arabicParser__.arabicLetterHasMedialForm=function(S){return s(S)&&o(S)&&e[S.charCodeAt(0)].length==4},y=t.__arabicParser__.resolveLigatures=function(S){var w=0,E=r,q="",ee=0;for(w=0;w<S.length;w+=1)E[S.charCodeAt(w)]!==void 0?(ee++,typeof(E=E[S.charCodeAt(w)])=="number"&&(q+=String.fromCharCode(E),E=r,ee=0),w===S.length-1&&(E=r,q+=S.charAt(w-(ee-1)),w-=ee-1,ee=0)):(E=r,q+=S.charAt(w-ee),w-=ee,ee=0);return q};t.__arabicParser__.isArabicDiacritic=function(S){return S!==void 0&&n[S.charCodeAt(0)]!==void 0};var g=t.__arabicParser__.getCorrectForm=function(S,w,E){return s(S)?o(S)===!1?-1:!u(S)||!s(w)&&!s(E)||!s(E)&&l(w)||l(S)&&!s(w)||l(S)&&c(w)||l(S)&&l(w)?0:h(S)&&s(w)&&!l(w)&&s(E)&&u(E)?3:l(S)||!s(E)?1:2:-1},f=function(S){var w=0,E=0,q=0,ee="",W="",K="",te=(S=S||"").split("\\s+"),$=[];for(w=0;w<te.length;w+=1){for($.push(""),E=0;E<te[w].length;E+=1)ee=te[w][E],W=te[w][E-1],K=te[w][E+1],s(ee)?(q=g(ee,W,K),$[w]+=q!==-1?String.fromCharCode(e[ee.charCodeAt(0)][q]):ee):$[w]+=ee;$[w]=y($[w])}return $.join(" ")},x=t.__arabicParser__.processArabic=t.processArabic=function(){var S,w=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,E=[];if(Array.isArray(w)){var q=0;for(E=[],q=0;q<w.length;q+=1)Array.isArray(w[q])?E.push([f(w[q][0]),w[q][1],w[q][2]]):E.push([f(w[q])]);S=E}else S=f(w);return typeof arguments[0]=="string"?S:(arguments[0].text=S,arguments[0])};t.events.push(["preProcessText",x])}(hr.API),hr.API.autoPrint=function(t){var e;switch((t=t||{}).variant=t.variant||"non-conform",t.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(l){i=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var o=[];Object.defineProperty(this,"childNodes",{get:function(){return o},set:function(l){o=l}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(l){s=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(hr.API),function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(S){c=S}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(S){u=S}});var h=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return h},set:function(S){h=S}});var y=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return y},set:function(S){y=S}});var g=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return g},set:function(S){g=S}});var f=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return f},set:function(S){f=S}});var x=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return x},set:function(S){x=S}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,u){n.call(this);var h=(u=u||{}).fontSize||this.getFontSize(),y=u.font||this.getFont(),g=u.scaleFactor||this.internal.scaleFactor,f=0,x=0,S=0,w=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var E=u.maxWidth;E>0?typeof c=="string"?c=this.splitTextToSize(c,E):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(ee,W){return ee.concat(w.splitTextToSize(W,E))},[])):c=Array.isArray(c)?c:[c];for(var q=0;q<c.length;q++)f<(S=this.getStringUnitWidth(c[q],{font:y})*h)&&(f=S);return f!==0&&(x=c.length),{w:f/=g,h:Math.max((x*h*this.getLineHeightFactor()-h*(this.getLineHeightFactor()-1))/g,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new o(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=t.cell=function(){var c;c=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var u=this.internal.__cell__.lastCell,h=this.internal.__cell__.padding,y=this.internal.__cell__.margins||e,g=this.internal.__cell__.tableHeaderRow,f=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+y.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=y.top,f&&g&&(this.printHeaderRow(c.lineNumber,!0),c.y+=g[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-h,c.y+h,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+h,{align:"center",baseline:"top",maxWidth:c.width-h-h}):this.text(c.text,c.x+h,c.y+h,{align:"left",baseline:"top",maxWidth:c.width-h-h})),this.internal.__cell__.lastCell=c,this};t.table=function(c,u,h,y,g){if(n.call(this),!h)throw new Error("No data for PDF table.");var f,x,S,w,E=[],q=[],ee=[],W={},K={},te=[],$=[],C=(g=g||{}).autoSize||!1,T=g.printHeaders!==!1,O=g.css&&g.css["font-size"]!==void 0?16*g.css["font-size"]:g.fontSize||12,b=g.margins||Object.assign({width:this.getPageWidth()},e),P=typeof g.padding=="number"?g.padding:3,_=g.headerBackgroundColor||"#c8c8c8",z=g.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=T,this.internal.__cell__.margins=b,this.internal.__cell__.table_font_size=O,this.internal.__cell__.padding=P,this.internal.__cell__.headerBackgroundColor=_,this.internal.__cell__.headerTextColor=z,this.setFontSize(O),y==null)q=E=Object.keys(h[0]),ee=E.map(function(){return"left"});else if(Array.isArray(y)&&nn(y[0])==="object")for(E=y.map(function(B){return B.name}),q=y.map(function(B){return B.prompt||B.name||""}),ee=y.map(function(B){return B.align||"left"}),f=0;f<y.length;f+=1)K[y[f].name]=y[f].width*(19.049976/25.4);else Array.isArray(y)&&typeof y[0]=="string"&&(q=E=y,ee=E.map(function(){return"left"}));if(C||Array.isArray(y)&&typeof y[0]=="string")for(f=0;f<E.length;f+=1){for(W[w=E[f]]=h.map(function(B){return B[w]}),this.setFont(void 0,"bold"),te.push(this.getTextDimensions(q[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),x=W[w],this.setFont(void 0,"normal"),S=0;S<x.length;S+=1)te.push(this.getTextDimensions(x[S],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);K[w]=Math.max.apply(null,te)+P+P,te=[]}if(T){var Z={};for(f=0;f<E.length;f+=1)Z[E[f]]={},Z[E[f]].text=q[f],Z[E[f]].align=ee[f];var k=l.call(this,Z,K);$=E.map(function(B){return new o(c,u,K[B],k,Z[B].text,void 0,Z[B].align)}),this.setTableHeaderRow($),this.printHeaderRow(1,!1)}var F=y.reduce(function(B,ce){return B[ce.name]=ce.align,B},{});for(f=0;f<h.length;f+=1){"rowStart"in g&&g.rowStart instanceof Function&&g.rowStart({row:f,data:h[f]},this);var X=l.call(this,h[f],K);for(S=0;S<E.length;S+=1){var U=h[f][E[S]];"cellStart"in g&&g.cellStart instanceof Function&&g.cellStart({row:f,col:S,data:U},this),s.call(this,new o(c,u,K[E[S]],X,U,f+2,F[E[S]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var h=this.internal.__cell__.padding,y=this.internal.__cell__.table_font_size,g=this.internal.scaleFactor;return Object.keys(c).map(function(f){var x=c[f];return this.splitTextToSize(x.hasOwnProperty("text")?x.text:x,u[f]-h-h)},this).map(function(f){return this.getLineHeightFactor()*f.length*y/g+h+h},this).reduce(function(f,x){return Math.max(f,x)},0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var h;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var y=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(y[0],y[1],y[2],y[3],void 0,-1)}this.setFont(void 0,"bold");for(var g=[],f=0;f<this.internal.__cell__.tableHeaderRow.length;f+=1){h=this.internal.__cell__.tableHeaderRow[f].clone(),u&&(h.y=this.internal.__cell__.margins.top||0,g.push(h)),h.lineNumber=c;var x=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,h),this.setTextColor(x)}g.length>0&&this.setTableHeaderRow(g),this.setFont(void 0,"normal"),r=!1}}(hr.API);var Z5={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},e_=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Rm=X5(e_),t_=[100,200,300,400,500,600,700,800,900],KL=X5(t_);function Dm(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=function(o){return Z5[o=o||"normal"]?o:"normal"}(t.style),n=function(o){if(!o)return 400;if(typeof o=="number")return o>=100&&o<=900&&o%100==0?o:400;if(/^\d00$/.test(o))return parseInt(o);switch(o){case"bold":return 700;case"normal":default:return 400}}(t.weight),i=function(o){return typeof Rm[o=o||"normal"]=="number"?o:"normal"}(t.stretch);return{family:e,style:r,weight:n,stretch:i,src:t.src||[],ref:t.ref||{name:e,style:[i,r,n].join(" ")}}}function Y0(t,e,r,n){var i;for(i=r;i>=0&&i<e.length;i+=n)if(t[e[i]])return t[e[i]];for(i=r;i>=0&&i<e.length;i-=n)if(t[e[i]])return t[e[i]]}var JL={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},K0={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function J0(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function QL(t,e,r){for(var n=(r=r||{}).defaultFontFamily||"times",i=Object.assign({},JL,r.genericFontFamilies||{}),o=null,s=null,l=0;l<e.length;++l)if(i[(o=Dm(e[l])).family]&&(o.family=i[o.family]),t.hasOwnProperty(o.family)){s=t[o.family];break}if(!(s=s||t[n]))throw new Error("Could not find a font-family for the rule '"+J0(o)+"' and default family '"+n+"'.");if(s=function(c,u){if(u[c])return u[c];var h=Rm[c],y=h<=Rm.normal?-1:1,g=Y0(u,e_,h,y);if(!g)throw new Error("Could not find a matching font-stretch value for "+c);return g}(o.stretch,s),s=function(c,u){if(u[c])return u[c];for(var h=Z5[c],y=0;y<h.length;++y)if(u[h[y]])return u[h[y]];throw new Error("Could not find a matching font-style for "+c)}(o.style,s),!(s=function(c,u){if(u[c])return u[c];if(c===400&&u[500])return u[500];if(c===500&&u[400])return u[400];var h=KL[c],y=Y0(u,t_,h,c<400?-1:1);if(!y)throw new Error("Could not find a matching font-weight for value "+c);return y}(o.weight,s)))throw new Error("Failed to resolve a font for the rule '"+J0(o)+"'.");return s}function Q0(t){return t.trimLeft()}function XL(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function ZL(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var Qd,X0,Z0,Tf=["times"];(function(t){var e,r,n,i,o,s,l,c,u,h=function(L){return L=L||{},this.isStrokeTransparent=L.isStrokeTransparent||!1,this.strokeOpacity=L.strokeOpacity||1,this.strokeStyle=L.strokeStyle||"#000000",this.fillStyle=L.fillStyle||"#000000",this.isFillTransparent=L.isFillTransparent||!1,this.fillOpacity=L.fillOpacity||1,this.font=L.font||"10px sans-serif",this.textBaseline=L.textBaseline||"alphabetic",this.textAlign=L.textAlign||"left",this.lineWidth=L.lineWidth||1,this.lineJoin=L.lineJoin||"miter",this.lineCap=L.lineCap||"butt",this.path=L.path||[],this.transform=L.transform!==void 0?L.transform.clone():new c,this.globalCompositeOperation=L.globalCompositeOperation||"normal",this.globalAlpha=L.globalAlpha||1,this.clip_path=L.clip_path||[],this.currentPoint=L.currentPoint||new s,this.miterLimit=L.miterLimit||10,this.lastPoint=L.lastPoint||new s,this.lineDashOffset=L.lineDashOffset||0,this.lineDash=L.lineDash||[],this.margin=L.margin||[0,0,0,0],this.prevPageLastElemOffset=L.prevPageLastElemOffset||0,this.ignoreClearRect=typeof L.ignoreClearRect!="boolean"||L.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new y(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,s=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new h}]);var y=function(L){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var D=L;Object.defineProperty(this,"pdf",{get:function(){return D}});var j=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return j},set:function(ae){j=!!ae}});var I=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return I},set:function(ae){I=!!ae}});var M=0;Object.defineProperty(this,"posX",{get:function(){return M},set:function(ae){isNaN(ae)||(M=ae)}});var J=0;Object.defineProperty(this,"posY",{get:function(){return J},set:function(ae){isNaN(ae)||(J=ae)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(ae){var Y;typeof ae=="number"?Y=[ae,ae,ae,ae]:((Y=new Array(4))[0]=ae[0],Y[1]=ae.length>=2?ae[1]:Y[0],Y[2]=ae.length>=3?ae[2]:Y[0],Y[3]=ae.length>=4?ae[3]:Y[1]),u.margin=Y}});var H=!1;Object.defineProperty(this,"autoPaging",{get:function(){return H},set:function(ae){H=ae}});var Q=0;Object.defineProperty(this,"lastBreak",{get:function(){return Q},set:function(ae){Q=ae}});var se=[];Object.defineProperty(this,"pageBreaks",{get:function(){return se},set:function(ae){se=ae}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(ae){ae instanceof h&&(u=ae)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(ae){u.path=ae}});var G=[];Object.defineProperty(this,"ctxStack",{get:function(){return G},set:function(ae){G=ae}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ae){var Y;Y=g(ae),this.ctx.fillStyle=Y.style,this.ctx.isFillTransparent=Y.a===0,this.ctx.fillOpacity=Y.a,this.pdf.setFillColor(Y.r,Y.g,Y.b,{a:Y.a}),this.pdf.setTextColor(Y.r,Y.g,Y.b,{a:Y.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ae){var Y=g(ae);this.ctx.strokeStyle=Y.style,this.ctx.isStrokeTransparent=Y.a===0,this.ctx.strokeOpacity=Y.a,Y.a===0?this.pdf.setDrawColor(255,255,255):(Y.a,this.pdf.setDrawColor(Y.r,Y.g,Y.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ae){["butt","round","square"].indexOf(ae)!==-1&&(this.ctx.lineCap=ae,this.pdf.setLineCap(ae))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ae){isNaN(ae)||(this.ctx.lineWidth=ae,this.pdf.setLineWidth(ae))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ae){["bevel","round","miter"].indexOf(ae)!==-1&&(this.ctx.lineJoin=ae,this.pdf.setLineJoin(ae))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ae){isNaN(ae)||(this.ctx.miterLimit=ae,this.pdf.setMiterLimit(ae))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ae){this.ctx.textBaseline=ae}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ae){["right","end","center","left","start"].indexOf(ae)!==-1&&(this.ctx.textAlign=ae)}});var re=null;function oe(ae,Y){if(re===null){var ie=function(de){var ue=[];return Object.keys(de).forEach(function(ge){de[ge].forEach(function(Pe){var pe=null;switch(Pe){case"bold":pe={family:ge,weight:"bold"};break;case"italic":pe={family:ge,style:"italic"};break;case"bolditalic":pe={family:ge,weight:"bold",style:"italic"};break;case"":case"normal":pe={family:ge}}pe!==null&&(pe.ref={name:ge,style:Pe},ue.push(pe))})}),ue}(ae.getFontList());re=function(de){for(var ue={},ge=0;ge<de.length;++ge){var Pe=Dm(de[ge]),pe=Pe.family,_e=Pe.stretch,Le=Pe.style,De=Pe.weight;ue[pe]=ue[pe]||{},ue[pe][_e]=ue[pe][_e]||{},ue[pe][_e][Le]=ue[pe][_e][Le]||{},ue[pe][_e][Le][De]=Pe}return ue}(ie.concat(Y))}return re}var fe=null;Object.defineProperty(this,"fontFaces",{get:function(){return fe},set:function(ae){re=null,fe=ae}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ae){var Y;if(this.ctx.font=ae,(Y=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(ae))!==null){var ie=Y[1];Y[2];var de=Y[3],ue=Y[4];Y[5];var ge=Y[6],Pe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ue)[2];ue=Math.floor(Pe==="px"?parseFloat(ue)*this.pdf.internal.scaleFactor:Pe==="em"?parseFloat(ue)*this.pdf.getFontSize():parseFloat(ue)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ue);var pe=function(Re){var Je,Be,Ke=[],Xe=Re.trim();if(Xe==="")return Tf;if(Xe in K0)return[K0[Xe]];for(;Xe!=="";){switch(Be=null,Je=(Xe=Q0(Xe)).charAt(0)){case'"':case"'":Be=XL(Xe.substring(1),Je);break;default:Be=ZL(Xe)}if(Be===null||(Ke.push(Be[0]),(Xe=Q0(Be[1]))!==""&&Xe.charAt(0)!==","))return Tf;Xe=Xe.replace(/^,/,"")}return Ke}(ge);if(this.fontFaces){var _e=QL(oe(this.pdf,this.fontFaces),pe.map(function(Re){return{family:Re,stretch:"normal",weight:de,style:ie}}));this.pdf.setFont(_e.ref.name,_e.ref.style)}else{var Le="";(de==="bold"||parseInt(de,10)>=700||ie==="bold")&&(Le="bold"),ie==="italic"&&(Le+="italic"),Le.length===0&&(Le="normal");for(var De="",Te={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},$e=0;$e<pe.length;$e++){if(this.pdf.internal.getFont(pe[$e],Le,{noFallback:!0,disableWarning:!0})!==void 0){De=pe[$e];break}if(Le==="bolditalic"&&this.pdf.internal.getFont(pe[$e],"bold",{noFallback:!0,disableWarning:!0})!==void 0)De=pe[$e],Le="bold";else if(this.pdf.internal.getFont(pe[$e],"normal",{noFallback:!0,disableWarning:!0})!==void 0){De=pe[$e],Le="normal";break}}if(De===""){for(var Ie=0;Ie<pe.length;Ie++)if(Te[pe[Ie]]){De=Te[pe[Ie]];break}}De=De===""?"Times":De,this.pdf.setFont(De,Le)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ae){this.ctx.globalCompositeOperation=ae}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ae){this.ctx.globalAlpha=ae}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ae){this.ctx.lineDashOffset=ae,ce.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ae){this.ctx.lineDash=ae,ce.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ae){this.ctx.ignoreClearRect=!!ae}})};y.prototype.setLineDash=function(L){this.lineDash=L},y.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},y.prototype.fill=function(){W.call(this,"fill",!1)},y.prototype.stroke=function(){W.call(this,"stroke",!1)},y.prototype.beginPath=function(){this.path=[{type:"begin"}]},y.prototype.moveTo=function(L,D){if(isNaN(L)||isNaN(D))throw cn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var j=this.ctx.transform.applyToPoint(new s(L,D));this.path.push({type:"mt",x:j.x,y:j.y}),this.ctx.lastPoint=new s(L,D)},y.prototype.closePath=function(){var L=new s(0,0),D=0;for(D=this.path.length-1;D!==-1;D--)if(this.path[D].type==="begin"&&nn(this.path[D+1])==="object"&&typeof this.path[D+1].x=="number"){L=new s(this.path[D+1].x,this.path[D+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(L.x,L.y)},y.prototype.lineTo=function(L,D){if(isNaN(L)||isNaN(D))throw cn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var j=this.ctx.transform.applyToPoint(new s(L,D));this.path.push({type:"lt",x:j.x,y:j.y}),this.ctx.lastPoint=new s(j.x,j.y)},y.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),W.call(this,null,!0)},y.prototype.quadraticCurveTo=function(L,D,j,I){if(isNaN(j)||isNaN(I)||isNaN(L)||isNaN(D))throw cn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var M=this.ctx.transform.applyToPoint(new s(j,I)),J=this.ctx.transform.applyToPoint(new s(L,D));this.path.push({type:"qct",x1:J.x,y1:J.y,x:M.x,y:M.y}),this.ctx.lastPoint=new s(M.x,M.y)},y.prototype.bezierCurveTo=function(L,D,j,I,M,J){if(isNaN(M)||isNaN(J)||isNaN(L)||isNaN(D)||isNaN(j)||isNaN(I))throw cn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var H=this.ctx.transform.applyToPoint(new s(M,J)),Q=this.ctx.transform.applyToPoint(new s(L,D)),se=this.ctx.transform.applyToPoint(new s(j,I));this.path.push({type:"bct",x1:Q.x,y1:Q.y,x2:se.x,y2:se.y,x:H.x,y:H.y}),this.ctx.lastPoint=new s(H.x,H.y)},y.prototype.arc=function(L,D,j,I,M,J){if(isNaN(L)||isNaN(D)||isNaN(j)||isNaN(I)||isNaN(M))throw cn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(J=!!J,!this.ctx.transform.isIdentity){var H=this.ctx.transform.applyToPoint(new s(L,D));L=H.x,D=H.y;var Q=this.ctx.transform.applyToPoint(new s(0,j)),se=this.ctx.transform.applyToPoint(new s(0,0));j=Math.sqrt(Math.pow(Q.x-se.x,2)+Math.pow(Q.y-se.y,2))}Math.abs(M-I)>=2*Math.PI&&(I=0,M=2*Math.PI),this.path.push({type:"arc",x:L,y:D,radius:j,startAngle:I,endAngle:M,counterclockwise:J})},y.prototype.arcTo=function(L,D,j,I,M){throw new Error("arcTo not implemented.")},y.prototype.rect=function(L,D,j,I){if(isNaN(L)||isNaN(D)||isNaN(j)||isNaN(I))throw cn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(L,D),this.lineTo(L+j,D),this.lineTo(L+j,D+I),this.lineTo(L,D+I),this.lineTo(L,D),this.lineTo(L+j,D),this.lineTo(L,D)},y.prototype.fillRect=function(L,D,j,I){if(isNaN(L)||isNaN(D)||isNaN(j)||isNaN(I))throw cn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var M={};this.lineCap!=="butt"&&(M.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(M.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(L,D,j,I),this.fill(),M.hasOwnProperty("lineCap")&&(this.lineCap=M.lineCap),M.hasOwnProperty("lineJoin")&&(this.lineJoin=M.lineJoin)}},y.prototype.strokeRect=function(L,D,j,I){if(isNaN(L)||isNaN(D)||isNaN(j)||isNaN(I))throw cn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");x.call(this)||(this.beginPath(),this.rect(L,D,j,I),this.stroke())},y.prototype.clearRect=function(L,D,j,I){if(isNaN(L)||isNaN(D)||isNaN(j)||isNaN(I))throw cn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(L,D,j,I))},y.prototype.save=function(L){L=typeof L!="boolean"||L;for(var D=this.pdf.internal.getCurrentPageInfo().pageNumber,j=0;j<this.pdf.internal.getNumberOfPages();j++)this.pdf.setPage(j+1),this.pdf.internal.out("q");if(this.pdf.setPage(D),L){this.ctx.fontSize=this.pdf.internal.getFontSize();var I=new h(this.ctx);this.ctxStack.push(this.ctx),this.ctx=I}},y.prototype.restore=function(L){L=typeof L!="boolean"||L;for(var D=this.pdf.internal.getCurrentPageInfo().pageNumber,j=0;j<this.pdf.internal.getNumberOfPages();j++)this.pdf.setPage(j+1),this.pdf.internal.out("Q");this.pdf.setPage(D),L&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},y.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var g=function(L){var D,j,I,M;if(L.isCanvasGradient===!0&&(L=L.getColor()),!L)return{r:0,g:0,b:0,a:0,style:L};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(L))D=0,j=0,I=0,M=0;else{var J=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(L);if(J!==null)D=parseInt(J[1]),j=parseInt(J[2]),I=parseInt(J[3]),M=1;else if((J=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(L))!==null)D=parseInt(J[1]),j=parseInt(J[2]),I=parseInt(J[3]),M=parseFloat(J[4]);else{if(M=1,typeof L=="string"&&L.charAt(0)!=="#"){var H=new G5(L);L=H.ok?H.toHex():"#000000"}L.length===4?(D=L.substring(1,2),D+=D,j=L.substring(2,3),j+=j,I=L.substring(3,4),I+=I):(D=L.substring(1,3),j=L.substring(3,5),I=L.substring(5,7)),D=parseInt(D,16),j=parseInt(j,16),I=parseInt(I,16)}}return{r:D,g:j,b:I,a:M,style:L}},f=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},x=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};y.prototype.fillText=function(L,D,j,I){if(isNaN(D)||isNaN(j)||typeof L!="string")throw cn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(I=isNaN(I)?void 0:I,!f.call(this)){var M=X(this.ctx.transform.rotation),J=this.ctx.transform.scaleX;P.call(this,{text:L,x:D,y:j,scale:J,angle:M,align:this.textAlign,maxWidth:I})}},y.prototype.strokeText=function(L,D,j,I){if(isNaN(D)||isNaN(j)||typeof L!="string")throw cn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!x.call(this)){I=isNaN(I)?void 0:I;var M=X(this.ctx.transform.rotation),J=this.ctx.transform.scaleX;P.call(this,{text:L,x:D,y:j,scale:J,renderingMode:"stroke",angle:M,align:this.textAlign,maxWidth:I})}},y.prototype.measureText=function(L){if(typeof L!="string")throw cn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var D=this.pdf,j=this.pdf.internal.scaleFactor,I=D.internal.getFontSize(),M=D.getStringUnitWidth(L)*I/D.internal.scaleFactor,J=function(H){var Q=(H=H||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Q}}),this};return new J({width:M*=Math.round(96*j/72*1e4)/1e4})},y.prototype.scale=function(L,D){if(isNaN(L)||isNaN(D))throw cn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var j=new c(L,0,0,D,0,0);this.ctx.transform=this.ctx.transform.multiply(j)},y.prototype.rotate=function(L){if(isNaN(L))throw cn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var D=new c(Math.cos(L),Math.sin(L),-Math.sin(L),Math.cos(L),0,0);this.ctx.transform=this.ctx.transform.multiply(D)},y.prototype.translate=function(L,D){if(isNaN(L)||isNaN(D))throw cn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var j=new c(1,0,0,1,L,D);this.ctx.transform=this.ctx.transform.multiply(j)},y.prototype.transform=function(L,D,j,I,M,J){if(isNaN(L)||isNaN(D)||isNaN(j)||isNaN(I)||isNaN(M)||isNaN(J))throw cn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var H=new c(L,D,j,I,M,J);this.ctx.transform=this.ctx.transform.multiply(H)},y.prototype.setTransform=function(L,D,j,I,M,J){L=isNaN(L)?1:L,D=isNaN(D)?0:D,j=isNaN(j)?0:j,I=isNaN(I)?1:I,M=isNaN(M)?0:M,J=isNaN(J)?0:J,this.ctx.transform=new c(L,D,j,I,M,J)};var S=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};y.prototype.drawImage=function(L,D,j,I,M,J,H,Q,se){var G=this.pdf.getImageProperties(L),re=1,oe=1,fe=1,ae=1;I!==void 0&&Q!==void 0&&(fe=Q/I,ae=se/M,re=G.width/I*Q/I,oe=G.height/M*se/M),J===void 0&&(J=D,H=j,D=0,j=0),I!==void 0&&Q===void 0&&(Q=I,se=M),I===void 0&&Q===void 0&&(Q=G.width,se=G.height);for(var Y,ie=this.ctx.transform.decompose(),de=X(ie.rotate.shx),ue=new c,ge=(ue=(ue=(ue=ue.multiply(ie.translate)).multiply(ie.skew)).multiply(ie.scale)).applyToRectangle(new l(J-D*fe,H-j*ae,I*re,M*oe)),Pe=w.call(this,ge),pe=[],_e=0;_e<Pe.length;_e+=1)pe.indexOf(Pe[_e])===-1&&pe.push(Pe[_e]);if(ee(pe),this.autoPaging)for(var Le=pe[0],De=pe[pe.length-1],Te=Le;Te<De+1;Te++){this.pdf.setPage(Te);var $e=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ie=Te===1?this.posY+this.margin[0]:this.margin[0],Re=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Je=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Be=Te===1?0:Re+(Te-2)*Je;if(this.ctx.clip_path.length!==0){var Ke=this.path;Y=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=q(Y,this.posX+this.margin[3],-Be+Ie+this.ctx.prevPageLastElemOffset),K.call(this,"fill",!0),this.path=Ke}var Xe=JSON.parse(JSON.stringify(ge));Xe=q([Xe],this.posX+this.margin[3],-Be+Ie+this.ctx.prevPageLastElemOffset)[0];var at=(Te>Le||Te<De)&&S.call(this);at&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],$e,Je,null).clip().discardPath()),this.pdf.addImage(L,"JPEG",Xe.x,Xe.y,Xe.w,Xe.h,null,null,de),at&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(L,"JPEG",ge.x,ge.y,ge.w,ge.h,null,null,de)};var w=function(L,D,j){var I=[];D=D||this.pdf.internal.pageSize.width,j=j||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var M=this.posY+this.ctx.prevPageLastElemOffset;switch(L.type){default:case"mt":case"lt":I.push(Math.floor((L.y+M)/j)+1);break;case"arc":I.push(Math.floor((L.y+M-L.radius)/j)+1),I.push(Math.floor((L.y+M+L.radius)/j)+1);break;case"qct":var J=U(this.ctx.lastPoint.x,this.ctx.lastPoint.y,L.x1,L.y1,L.x,L.y);I.push(Math.floor((J.y+M)/j)+1),I.push(Math.floor((J.y+J.h+M)/j)+1);break;case"bct":var H=B(this.ctx.lastPoint.x,this.ctx.lastPoint.y,L.x1,L.y1,L.x2,L.y2,L.x,L.y);I.push(Math.floor((H.y+M)/j)+1),I.push(Math.floor((H.y+H.h+M)/j)+1);break;case"rect":I.push(Math.floor((L.y+M)/j)+1),I.push(Math.floor((L.y+L.h+M)/j)+1)}for(var Q=0;Q<I.length;Q+=1)for(;this.pdf.internal.getNumberOfPages()<I[Q];)E.call(this);return I},E=function(){var L=this.fillStyle,D=this.strokeStyle,j=this.font,I=this.lineCap,M=this.lineWidth,J=this.lineJoin;this.pdf.addPage(),this.fillStyle=L,this.strokeStyle=D,this.font=j,this.lineCap=I,this.lineWidth=M,this.lineJoin=J},q=function(L,D,j){for(var I=0;I<L.length;I++)switch(L[I].type){case"bct":L[I].x2+=D,L[I].y2+=j;case"qct":L[I].x1+=D,L[I].y1+=j;case"mt":case"lt":case"arc":default:L[I].x+=D,L[I].y+=j}return L},ee=function(L){return L.sort(function(D,j){return D-j})},W=function(L,D){for(var j,I,M=this.fillStyle,J=this.strokeStyle,H=this.lineCap,Q=this.lineWidth,se=Math.abs(Q*this.ctx.transform.scaleX),G=this.lineJoin,re=JSON.parse(JSON.stringify(this.path)),oe=JSON.parse(JSON.stringify(this.path)),fe=[],ae=0;ae<oe.length;ae++)if(oe[ae].x!==void 0)for(var Y=w.call(this,oe[ae]),ie=0;ie<Y.length;ie+=1)fe.indexOf(Y[ie])===-1&&fe.push(Y[ie]);for(var de=0;de<fe.length;de++)for(;this.pdf.internal.getNumberOfPages()<fe[de];)E.call(this);if(ee(fe),this.autoPaging)for(var ue=fe[0],ge=fe[fe.length-1],Pe=ue;Pe<ge+1;Pe++){this.pdf.setPage(Pe),this.fillStyle=M,this.strokeStyle=J,this.lineCap=H,this.lineWidth=se,this.lineJoin=G;var pe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],_e=Pe===1?this.posY+this.margin[0]:this.margin[0],Le=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],De=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Te=Pe===1?0:Le+(Pe-2)*De;if(this.ctx.clip_path.length!==0){var $e=this.path;j=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=q(j,this.posX+this.margin[3],-Te+_e+this.ctx.prevPageLastElemOffset),K.call(this,L,!0),this.path=$e}if(I=JSON.parse(JSON.stringify(re)),this.path=q(I,this.posX+this.margin[3],-Te+_e+this.ctx.prevPageLastElemOffset),D===!1||Pe===0){var Ie=(Pe>ue||Pe<ge)&&S.call(this);Ie&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],pe,De,null).clip().discardPath()),K.call(this,L,D),Ie&&this.pdf.restoreGraphicsState()}this.lineWidth=Q}else this.lineWidth=se,K.call(this,L,D),this.lineWidth=Q;this.path=re},K=function(L,D){if((L!=="stroke"||D||!x.call(this))&&(L==="stroke"||D||!f.call(this))){for(var j,I,M=[],J=this.path,H=0;H<J.length;H++){var Q=J[H];switch(Q.type){case"begin":M.push({begin:!0});break;case"close":M.push({close:!0});break;case"mt":M.push({start:Q,deltas:[],abs:[]});break;case"lt":var se=M.length;if(J[H-1]&&!isNaN(J[H-1].x)&&(j=[Q.x-J[H-1].x,Q.y-J[H-1].y],se>0)){for(;se>=0;se--)if(M[se-1].close!==!0&&M[se-1].begin!==!0){M[se-1].deltas.push(j),M[se-1].abs.push(Q);break}}break;case"bct":j=[Q.x1-J[H-1].x,Q.y1-J[H-1].y,Q.x2-J[H-1].x,Q.y2-J[H-1].y,Q.x-J[H-1].x,Q.y-J[H-1].y],M[M.length-1].deltas.push(j);break;case"qct":var G=J[H-1].x+2/3*(Q.x1-J[H-1].x),re=J[H-1].y+2/3*(Q.y1-J[H-1].y),oe=Q.x+2/3*(Q.x1-Q.x),fe=Q.y+2/3*(Q.y1-Q.y),ae=Q.x,Y=Q.y;j=[G-J[H-1].x,re-J[H-1].y,oe-J[H-1].x,fe-J[H-1].y,ae-J[H-1].x,Y-J[H-1].y],M[M.length-1].deltas.push(j);break;case"arc":M.push({deltas:[],abs:[],arc:!0}),Array.isArray(M[M.length-1].abs)&&M[M.length-1].abs.push(Q)}}I=D?null:L==="stroke"?"stroke":"fill";for(var ie=!1,de=0;de<M.length;de++)if(M[de].arc)for(var ue=M[de].abs,ge=0;ge<ue.length;ge++){var Pe=ue[ge];Pe.type==="arc"?C.call(this,Pe.x,Pe.y,Pe.radius,Pe.startAngle,Pe.endAngle,Pe.counterclockwise,void 0,D,!ie):_.call(this,Pe.x,Pe.y),ie=!0}else if(M[de].close===!0)this.pdf.internal.out("h"),ie=!1;else if(M[de].begin!==!0){var pe=M[de].start.x,_e=M[de].start.y;z.call(this,M[de].deltas,pe,_e),ie=!0}I&&T.call(this,I),D&&O.call(this)}},te=function(L){var D=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,j=D*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return L-j;case"top":return L+D-j;case"hanging":return L+D-2*j;case"middle":return L+D/2-j;case"ideographic":return L;case"alphabetic":default:return L}},$=function(L){return L+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};y.prototype.createLinearGradient=function(){var L=function(){};return L.colorStops=[],L.addColorStop=function(D,j){this.colorStops.push([D,j])},L.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},L.isCanvasGradient=!0,L},y.prototype.createPattern=function(){return this.createLinearGradient()},y.prototype.createRadialGradient=function(){return this.createLinearGradient()};var C=function(L,D,j,I,M,J,H,Q,se){for(var G=k.call(this,j,I,M,J),re=0;re<G.length;re++){var oe=G[re];re===0&&(se?b.call(this,oe.x1+L,oe.y1+D):_.call(this,oe.x1+L,oe.y1+D)),Z.call(this,L,D,oe.x2,oe.y2,oe.x3,oe.y3,oe.x4,oe.y4)}Q?O.call(this):T.call(this,H)},T=function(L){switch(L){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},O=function(){this.pdf.clip(),this.pdf.discardPath()},b=function(L,D){this.pdf.internal.out(r(L)+" "+n(D)+" m")},P=function(L){var D;switch(L.align){case"right":case"end":D="right";break;case"center":D="center";break;case"left":case"start":default:D="left"}var j=this.pdf.getTextDimensions(L.text),I=te.call(this,L.y),M=$.call(this,I)-j.h,J=this.ctx.transform.applyToPoint(new s(L.x,I)),H=this.ctx.transform.decompose(),Q=new c;Q=(Q=(Q=Q.multiply(H.translate)).multiply(H.skew)).multiply(H.scale);for(var se,G,re,oe=this.ctx.transform.applyToRectangle(new l(L.x,I,j.w,j.h)),fe=Q.applyToRectangle(new l(L.x,M,j.w,j.h)),ae=w.call(this,fe),Y=[],ie=0;ie<ae.length;ie+=1)Y.indexOf(ae[ie])===-1&&Y.push(ae[ie]);if(ee(Y),this.autoPaging)for(var de=Y[0],ue=Y[Y.length-1],ge=de;ge<ue+1;ge++){this.pdf.setPage(ge);var Pe=ge===1?this.posY+this.margin[0]:this.margin[0],pe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],_e=this.pdf.internal.pageSize.height-this.margin[2],Le=_e-this.margin[0],De=this.pdf.internal.pageSize.width-this.margin[1],Te=De-this.margin[3],$e=ge===1?0:pe+(ge-2)*Le;if(this.ctx.clip_path.length!==0){var Ie=this.path;se=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=q(se,this.posX+this.margin[3],-1*$e+Pe),K.call(this,"fill",!0),this.path=Ie}var Re=q([JSON.parse(JSON.stringify(fe))],this.posX+this.margin[3],-$e+Pe+this.ctx.prevPageLastElemOffset)[0];L.scale>=.01&&(G=this.pdf.internal.getFontSize(),this.pdf.setFontSize(G*L.scale),re=this.lineWidth,this.lineWidth=re*L.scale);var Je=this.autoPaging!=="text";if(Je||Re.y+Re.h<=_e){if(Je||Re.y>=Pe&&Re.x<=De){var Be=Je?L.text:this.pdf.splitTextToSize(L.text,L.maxWidth||De-Re.x)[0],Ke=q([JSON.parse(JSON.stringify(oe))],this.posX+this.margin[3],-$e+Pe+this.ctx.prevPageLastElemOffset)[0],Xe=Je&&(ge>de||ge<ue)&&S.call(this);Xe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Te,Le,null).clip().discardPath()),this.pdf.text(Be,Ke.x,Ke.y,{angle:L.angle,align:D,renderingMode:L.renderingMode}),Xe&&this.pdf.restoreGraphicsState()}}else Re.y<_e&&(this.ctx.prevPageLastElemOffset+=_e-Re.y);L.scale>=.01&&(this.pdf.setFontSize(G),this.lineWidth=re)}else L.scale>=.01&&(G=this.pdf.internal.getFontSize(),this.pdf.setFontSize(G*L.scale),re=this.lineWidth,this.lineWidth=re*L.scale),this.pdf.text(L.text,J.x+this.posX,J.y+this.posY,{angle:L.angle,align:D,renderingMode:L.renderingMode,maxWidth:L.maxWidth}),L.scale>=.01&&(this.pdf.setFontSize(G),this.lineWidth=re)},_=function(L,D,j,I){j=j||0,I=I||0,this.pdf.internal.out(r(L+j)+" "+n(D+I)+" l")},z=function(L,D,j){return this.pdf.lines(L,D,j,null,null)},Z=function(L,D,j,I,M,J,H,Q){this.pdf.internal.out([e(i(j+L)),e(o(I+D)),e(i(M+L)),e(o(J+D)),e(i(H+L)),e(o(Q+D)),"c"].join(" "))},k=function(L,D,j,I){for(var M=2*Math.PI,J=Math.PI/2;D>j;)D-=M;var H=Math.abs(j-D);H<M&&I&&(H=M-H);for(var Q=[],se=I?-1:1,G=D;H>1e-5;){var re=G+se*Math.min(H,J);Q.push(F.call(this,L,G,re)),H-=Math.abs(re-G),G=re}return Q},F=function(L,D,j){var I=(j-D)/2,M=L*Math.cos(I),J=L*Math.sin(I),H=M,Q=-J,se=H*H+Q*Q,G=se+H*M+Q*J,re=4/3*(Math.sqrt(2*se*G)-G)/(H*J-Q*M),oe=H-re*Q,fe=Q+re*H,ae=oe,Y=-fe,ie=I+D,de=Math.cos(ie),ue=Math.sin(ie);return{x1:L*Math.cos(D),y1:L*Math.sin(D),x2:oe*de-fe*ue,y2:oe*ue+fe*de,x3:ae*de-Y*ue,y3:ae*ue+Y*de,x4:L*Math.cos(j),y4:L*Math.sin(j)}},X=function(L){return 180*L/Math.PI},U=function(L,D,j,I,M,J){var H=L+.5*(j-L),Q=D+.5*(I-D),se=M+.5*(j-M),G=J+.5*(I-J),re=Math.min(L,M,H,se),oe=Math.max(L,M,H,se),fe=Math.min(D,J,Q,G),ae=Math.max(D,J,Q,G);return new l(re,fe,oe-re,ae-fe)},B=function(L,D,j,I,M,J,H,Q){var se,G,re,oe,fe,ae,Y,ie,de,ue,ge,Pe,pe,_e,Le=j-L,De=I-D,Te=M-j,$e=J-I,Ie=H-M,Re=Q-J;for(G=0;G<41;G++)de=(Y=(re=L+(se=G/40)*Le)+se*((fe=j+se*Te)-re))+se*(fe+se*(M+se*Ie-fe)-Y),ue=(ie=(oe=D+se*De)+se*((ae=I+se*$e)-oe))+se*(ae+se*(J+se*Re-ae)-ie),G==0?(ge=de,Pe=ue,pe=de,_e=ue):(ge=Math.min(ge,de),Pe=Math.min(Pe,ue),pe=Math.max(pe,de),_e=Math.max(_e,ue));return new l(Math.round(ge),Math.round(Pe),Math.round(pe-ge),Math.round(_e-Pe))},ce=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var L,D,j=(L=this.ctx.lineDash,D=this.ctx.lineDashOffset,JSON.stringify({lineDash:L,lineDashOffset:D}));this.prevLineDash!==j&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=j)}}})(hr.API),function(t){var e=function(o){var s,l,c,u,h,y,g,f,x,S;for(l=[],c=0,u=(o+=s="\0\0\0\0".slice(o.length%4||4)).length;u>c;c+=4)(h=(o.charCodeAt(c)<<24)+(o.charCodeAt(c+1)<<16)+(o.charCodeAt(c+2)<<8)+o.charCodeAt(c+3))!==0?(y=(h=((h=((h=((h=(h-(S=h%85))/85)-(x=h%85))/85)-(f=h%85))/85)-(g=h%85))/85)%85,l.push(y+33,g+33,f+33,x+33,S+33)):l.push(122);return function(w,E){for(var q=E;q>0;q--)w.pop()}(l,s.length),String.fromCharCode.apply(String,l)+"~>"},r=function(o){var s,l,c,u,h,y=String,g="length",f=255,x="charCodeAt",S="slice",w="replace";for(o[S](-2),o=o[S](0,-2)[w](/\s/g,"")[w]("z","!!!!!"),c=[],u=0,h=(o+=s="uuuuu"[S](o[g]%5||5))[g];h>u;u+=5)l=52200625*(o[x](u)-33)+614125*(o[x](u+1)-33)+7225*(o[x](u+2)-33)+85*(o[x](u+3)-33)+(o[x](u+4)-33),c.push(f&l>>24,f&l>>16,f&l>>8,f&l);return function(E,q){for(var ee=q;ee>0;ee--)E.pop()}(c,s[g]),y.fromCharCode.apply(y,c)},n=function(o){var s=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),s.test(o)===!1)return"";for(var l="",c=0;c<o.length;c+=2)l+=String.fromCharCode("0x"+(o[c]+o[c+1]));return l},i=function(o){for(var s=new Uint8Array(o.length),l=o.length;l--;)s[l]=o.charCodeAt(l);return o=(s=Em(s)).reduce(function(c,u){return c+String.fromCharCode(u)},"")};t.processDataByFilters=function(o,s){var l=0,c=o||"",u=[];for(typeof(s=s||[])=="string"&&(s=[s]),l=0;l<s.length;l+=1)switch(s[l]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=e(c),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=n(c),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map(function(h){return("0"+h.charCodeAt().toString(16)).slice(-2)}).join("")+">",u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=i(c),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+s[l]+'" is not implemented')}return{data:c,reverseChain:u.reverse().join(" ")}}}(hr.API),function(t){t.loadFile=function(e,r,n){return function(i,o,s){o=o!==!1,s=typeof s=="function"?s:function(){};var l=void 0;try{l=function(c,u,h){var y=new XMLHttpRequest,g=0,f=function(x){var S=x.length,w=[],E=String.fromCharCode;for(g=0;g<S;g+=1)w.push(E(255&x.charCodeAt(g)));return w.join("")};if(y.open("GET",c,!u),y.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(y.onload=function(){y.status===200?h(f(this.responseText)):h(void 0)}),y.send(null),u&&y.status===200)return f(y.responseText)}(i,o,s)}catch{}return l}(e,r,n)},t.loadImageFile=t.loadFile}(hr.API),function(t){function e(){return(gr.html2canvas?Promise.resolve(gr.html2canvas):Bi(()=>import("./html2canvas.esm-BfxBtG_O.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load html2canvas: "+s))}).then(function(s){return s.default?s.default:s})}function r(){return(gr.DOMPurify?Promise.resolve(gr.DOMPurify):Bi(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load dompurify: "+s))}).then(function(s){return s.default?s.default:s})}var n=function(s){var l=nn(s);return l==="undefined"?"undefined":l==="string"||s instanceof String?"string":l==="number"||s instanceof Number?"number":l==="function"||s instanceof Function?"function":s&&s.constructor===Array?"array":s&&s.nodeType===1?"element":l==="object"?"object":"unknown"},i=function(s,l){var c=document.createElement(s);for(var u in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[u]=l.style[u];return c},o=function s(l){var c=Object.assign(s.convert(Promise.resolve()),JSON.parse(JSON.stringify(s.template))),u=s.convert(Promise.resolve(),c);return u=(u=u.setProgress(1,s,1,[s])).set(l)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(s,l){return s.__proto__=l||o.prototype,s},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(s,l){return this.then(function(){switch(l=l||function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(s)){case"string":return this.then(r).then(function(c){return this.set({src:i("div",{innerHTML:s,dompurify:c})})});case"element":return this.set({src:s});case"canvas":return this.set({canvas:s});case"img":return this.set({img:s});default:return this.error("Unknown source type.")}})},o.prototype.to=function(s){switch(s){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var s={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=function c(u,h){for(var y=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),g=u.firstChild;g;g=g.nextSibling)h!==!0&&g.nodeType===1&&g.nodeName==="SCRIPT"||y.appendChild(c(g,h));return u.nodeType===1&&(u.nodeName==="CANVAS"?(y.width=u.width,y.height=u.height,y.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(y.value=u.value),y.addEventListener("load",function(){y.scrollTop=u.scrollTop,y.scrollLeft=u.scrollLeft},!0)),y}(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(s.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:s}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(e).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(e).then(function(l){var c=this.opt.jsPDF,u=this.opt.fontFaces,h=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,y=Object.assign({async:!0,allowTaint:!0,scale:h,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete y.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=u,u)for(var g=0;g<u.length;++g){var f=u[g],x=f.src.find(function(S){return S.format==="truetype"});x&&c.addFont(x.url,f.ref.name,f.ref.style)}return y.windowHeight=y.windowHeight||0,y.windowHeight=y.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):y.windowHeight,c.context2d.save(!0),l(this.prop.container,y)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var s=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=s})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(s,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(s,l):this.outputPdf(s,l)},o.prototype.outputPdf=function(s,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(s,l)})},o.prototype.outputImg=function(s){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(s){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+s+'" is not supported.'}})},o.prototype.save=function(s){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(s?{filename:s}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(s){if(n(s)!=="object")return this;var l=Object.keys(s||{}).map(function(c){if(c in o.template.prop)return function(){this.prop[c]=s[c]};switch(c){case"margin":return this.setMargin.bind(this,s.margin);case"jsPDF":return function(){return this.opt.jsPDF=s.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,s.pageSize);default:return function(){this.opt[c]=s[c]}}},this);return this.then(function(){return this.thenList(l)})},o.prototype.get=function(s,l){return this.then(function(){var c=s in o.template.prop?this.prop[s]:this.opt[s];return l?l(c):c})},o.prototype.setMargin=function(s){return this.then(function(){switch(n(s)){case"number":s=[s,s,s,s];case"array":if(s.length===2&&(s=[s[0],s[1],s[0],s[1]]),s.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=s}).then(this.setPageSize)},o.prototype.setPageSize=function(s){function l(c,u){return Math.floor(c*u/72*96)}return this.then(function(){(s=s||hr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(s.inner={width:s.width-this.opt.margin[1]-this.opt.margin[3],height:s.height-this.opt.margin[0]-this.opt.margin[2]},s.inner.px={width:l(s.inner.width,s.k),height:l(s.inner.height,s.k)},s.inner.ratio=s.inner.height/s.inner.width),this.prop.pageSize=s})},o.prototype.setProgress=function(s,l,c,u){return s!=null&&(this.progress.val=s),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(s,l,c,u){return this.setProgress(s?this.progress.val+s:null,l||null,c?this.progress.n+c:null,u?this.progress.stack.concat(u):null)},o.prototype.then=function(s,l){var c=this;return this.thenCore(s,l,function(u,h){return c.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(y){return c.updateProgress(null,u),y}).then(u,h).then(function(y){return c.updateProgress(1),y})})},o.prototype.thenCore=function(s,l,c){c=c||Promise.prototype.then,s&&(s=s.bind(this)),l&&(l=l.bind(this));var u=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:o.convert(Object.assign({},this),Promise.prototype),h=c.call(u,s,l);return o.convert(h,this.__proto__)},o.prototype.thenExternal=function(s,l){return Promise.prototype.then.call(this,s,l)},o.prototype.thenList=function(s){var l=this;return s.forEach(function(c){l=l.thenCore(c)}),l},o.prototype.catch=function(s){s&&(s=s.bind(this));var l=Promise.prototype.catch.call(this,s);return o.convert(l,this)},o.prototype.catchExternal=function(s){return Promise.prototype.catch.call(this,s)},o.prototype.error=function(s){return this.then(function(){throw new Error(s)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,hr.getPageSize=function(s,l,c){if(nn(s)==="object"){var u=s;s=u.orientation,l=u.unit||l,c=u.format||c}l=l||"mm",c=c||"a4",s=(""+(s||"P")).toLowerCase();var h,y=(""+c).toLowerCase(),g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":h=1;break;case"mm":h=72/25.4;break;case"cm":h=72/2.54;break;case"in":h=72;break;case"px":h=.75;break;case"pc":case"em":h=12;break;case"ex":h=6;break;default:throw"Invalid unit: "+l}var f,x=0,S=0;if(g.hasOwnProperty(y))x=g[y][1]/h,S=g[y][0]/h;else try{x=c[1],S=c[0]}catch{throw new Error("Invalid format: "+c)}if(s==="p"||s==="portrait")s="p",S>x&&(f=S,S=x,x=f);else{if(s!=="l"&&s!=="landscape")throw"Invalid orientation: "+s;s="l",x>S&&(f=S,S=x,x=f)}return{width:S,height:x,unit:l,k:h,orientation:s}},t.html=function(s,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(Dm):null;var c=new o(l);return l.worker?c:c.from(s).doCallback()}}(hr.API),hr.API.addJS=function(t){return Z0=t,this.internal.events.subscribe("postPutResources",function(){Qd=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Qd+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),X0=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Z0+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Qd!==void 0&&X0!==void 0&&this.internal.out("/Names <</JavaScript "+Qd+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),o=0;o<i.length;o++){var s=i[o],l=n.exec(s);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(s)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,h=[];for(o=0;o<u;o++){var y=r.internal.newObject();h.push(y);var g=r.internal.getPageInfo(o+1);r.internal.write("<< /D["+g.objId+" 0 R /XYZ null null null]>> endobj")}var f=r.internal.newObject();for(r.internal.write("<< /Names [ "),o=0;o<h.length;o++)r.internal.write("(page_"+(o+1)+")"+h[o]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+f+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,o){var s={title:i,options:o,children:[]};return n==null&&(n=this.root),n.children.push(s),s},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,o=0;o<n.children.length;o++){var s=n.children[o];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),o>0&&this.line("/Prev "+this.makeRef(n.children[o-1])),o<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[o+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var l=this.count=this.count_r({count:0},s);if(l>0&&this.line("/Count "+l),s.options&&s.options.pageNumber){var c=r.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var o=0;o<i.children.length;o++)n.count++,this.count_r(n,i.children[o]);return n.count}}])}(hr.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,i,o,s,l){var c,u=this.decode.DCT_DECODE,h=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=s||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(c=function(y){for(var g,f=256*y.charCodeAt(4)+y.charCodeAt(5),x=y.length,S={width:0,height:0,numcomponents:1},w=4;w<x;w+=2){if(w+=f,e.indexOf(y.charCodeAt(w+1))!==-1){g=256*y.charCodeAt(w+5)+y.charCodeAt(w+6),S={width:256*y.charCodeAt(w+7)+y.charCodeAt(w+8),height:g,numcomponents:y.charCodeAt(w+9)};break}f=256*y.charCodeAt(w+2)+y.charCodeAt(w+3)}return S}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}h={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:n,alias:i}}return h}}(hr.API);var ic,Xd,eb,tb,rb,e7=function(){var t,e,r;function n(o){var s,l,c,u,h,y,g,f,x,S,w,E,q,ee;for(this.data=o,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},y=null;;){switch(s=this.readUInt32(),x=function(){var W,K;for(K=[],W=0;W<4;++W)K.push(String.fromCharCode(this.data[this.pos++]));return K}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(s);break;case"fcTL":y&&this.animation.frames.push(y),this.pos+=4,y={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},h=this.readUInt16(),u=this.readUInt16()||100,y.delay=1e3*h/u,y.disposeOp=this.data[this.pos++],y.blendOp=this.data[this.pos++],y.data=[];break;case"IDAT":case"fdAT":for(x==="fdAT"&&(this.pos+=4,s-=4),o=y?.data||this.imgData,E=0;0<=s?E<s:E>s;0<=s?++E:--E)o.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(s),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((S=c-this.transparency.indexed.length)>0)for(q=0;0<=S?q<S:q>S;0<=S?++q:--q)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(s)[0];break;case 2:this.transparency.rgb=this.read(s)}break;case"tEXt":g=(w=this.read(s)).indexOf(0),f=String.fromCharCode.apply(String,w.slice(0,g)),this.text[f]=String.fromCharCode.apply(String,w.slice(g+1));break;case"IEND":return y&&this.animation.frames.push(y),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=(ee=this.colorType)===4||ee===6,l=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*l,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=s}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(o){var s,l;for(l=[],s=0;0<=o?s<o:s>o;0<=o?++s:--s)l.push(this.data[this.pos++]);return l},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(o){var s=this.pixelBitlength/8,l=new Uint8Array(this.width*this.height*s),c=0,u=this;if(o==null&&(o=this.imgData),o.length===0)return new Uint8Array(0);function h(y,g,f,x){var S,w,E,q,ee,W,K,te,$,C,T,O,b,P,_,z,Z,k,F,X,U,B=Math.ceil((u.width-y)/f),ce=Math.ceil((u.height-g)/x),L=u.width==B&&u.height==ce;for(P=s*B,O=L?l:new Uint8Array(P*ce),W=o.length,b=0,w=0;b<ce&&c<W;){switch(o[c++]){case 0:for(q=Z=0;Z<P;q=Z+=1)O[w++]=o[c++];break;case 1:for(q=k=0;k<P;q=k+=1)S=o[c++],ee=q<s?0:O[w-s],O[w++]=(S+ee)%256;break;case 2:for(q=F=0;F<P;q=F+=1)S=o[c++],E=(q-q%s)/s,_=b&&O[(b-1)*P+E*s+q%s],O[w++]=(_+S)%256;break;case 3:for(q=X=0;X<P;q=X+=1)S=o[c++],E=(q-q%s)/s,ee=q<s?0:O[w-s],_=b&&O[(b-1)*P+E*s+q%s],O[w++]=(S+Math.floor((ee+_)/2))%256;break;case 4:for(q=U=0;U<P;q=U+=1)S=o[c++],E=(q-q%s)/s,ee=q<s?0:O[w-s],b===0?_=z=0:(_=O[(b-1)*P+E*s+q%s],z=E&&O[(b-1)*P+(E-1)*s+q%s]),K=ee+_-z,te=Math.abs(K-ee),C=Math.abs(K-_),T=Math.abs(K-z),$=te<=C&&te<=T?ee:C<=T?_:z,O[w++]=(S+$)%256;break;default:throw new Error("Invalid filter algorithm: "+o[c-1])}if(!L){var D=((g+b*x)*u.width+y)*s,j=b*P;for(q=0;q<B;q+=1){for(var I=0;I<s;I+=1)l[D++]=O[j++];D+=(f-1)*s}}b++}}return o=kL(o),u.interlaceMethod==1?(h(0,0,8,8),h(4,0,8,8),h(0,4,4,8),h(2,0,4,4),h(0,2,2,4),h(1,0,2,2),h(0,1,1,2)):h(0,0,1,1),l},n.prototype.decodePalette=function(){var o,s,l,c,u,h,y,g,f;for(l=this.palette,h=this.transparency.indexed||[],u=new Uint8Array((h.length||0)+l.length),c=0,o=0,s=y=0,g=l.length;y<g;s=y+=3)u[c++]=l[s],u[c++]=l[s+1],u[c++]=l[s+2],u[c++]=(f=h[o++])!=null?f:255;return u},n.prototype.copyToImageData=function(o,s){var l,c,u,h,y,g,f,x,S,w,E;if(c=this.colors,S=null,l=this.hasAlphaChannel,this.palette.length&&(S=(E=this._decodedPalette)!=null?E:this._decodedPalette=this.decodePalette(),c=4,l=!0),x=(u=o.data||o).length,y=S||s,h=g=0,c===1)for(;h<x;)f=S?4*s[h/4]:g,w=y[f++],u[h++]=w,u[h++]=w,u[h++]=w,u[h++]=l?y[f++]:255,g=f;else for(;h<x;)f=S?4*s[h/4]:g,u[h++]=y[f++],u[h++]=y[f++],u[h++]=y[f++],u[h++]=l?y[f++]:255,g=f},n.prototype.decode=function(){var o;return o=new Uint8Array(this.width*this.height*4),this.copyToImageData(o,this.decodePixels()),o};var i=function(){if(Object.prototype.toString.call(gr)==="[object Window]"){try{e=gr.document.createElement("canvas"),r=e.getContext("2d")}catch{return!1}return!0}return!1};return i(),t=function(o){var s;if(i()===!0)return r.width=o.width,r.height=o.height,r.clearRect(0,0,o.width,o.height),r.putImageData(o,0,0),(s=new Image).src=e.toDataURL(),s;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(o){var s,l,c,u,h,y,g,f;if(this.animation){for(f=[],l=h=0,y=(g=this.animation.frames).length;h<y;l=++h)s=g[l],c=o.createImageData(s.width,s.height),u=this.decodePixels(new Uint8Array(s.data)),this.copyToImageData(c,u),s.imageData=c,f.push(s.image=t(c));return f}},n.prototype.renderFrame=function(o,s){var l,c,u;return l=(c=this.animation.frames)[s],u=c[s-1],s===0&&o.clearRect(0,0,this.width,this.height),u?.disposeOp===1?o.clearRect(u.xOffset,u.yOffset,u.width,u.height):u?.disposeOp===2&&o.putImageData(u.imageData,u.xOffset,u.yOffset),l.blendOp===0&&o.clearRect(l.xOffset,l.yOffset,l.width,l.height),o.drawImage(l.image,l.xOffset,l.yOffset)},n.prototype.animate=function(o){var s,l,c,u,h,y,g=this;return l=0,y=this.animation,u=y.numFrames,c=y.frames,h=y.numPlays,(s=function(){var f,x;if(f=l++%u,x=c[f],g.renderFrame(o,f),u>1&&l/u<h)return g.animation._timeout=setTimeout(s,x.delay)})()},n.prototype.stopAnimation=function(){var o;return clearTimeout((o=this.animation)!=null?o._timeout:void 0)},n.prototype.render=function(o){var s,l;return o._png&&o._png.stopAnimation(),o._png=this,o.width=this.width,o.height=this.height,s=o.getContext("2d"),this.animation?(this.decodeFrames(s),this.animate(s)):(l=s.createImageData(this.width,this.height),this.copyToImageData(l,this.decodePixels()),s.putImageData(l,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function t7(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,i=t[e++],o=i>>7,s=1<<(7&i)+1;t[e++],t[e++];var l=null,c=null;o&&(l=e,c=s,e+=3*s);var u=!0,h=[],y=0,g=null,f=0,x=null;for(this.width=r,this.height=n;u&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,x=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((b=t[e++])>=0))throw Error("Invalid block size");if(b===0)break;e+=b}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var S=t[e++];y=t[e++]|t[e++]<<8,g=t[e++],(1&S)==0&&(g=null),f=S>>2&7,e++;break;case 254:for(;;){if(!((b=t[e++])>=0))throw Error("Invalid block size");if(b===0)break;e+=b}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var w=t[e++]|t[e++]<<8,E=t[e++]|t[e++]<<8,q=t[e++]|t[e++]<<8,ee=t[e++]|t[e++]<<8,W=t[e++],K=W>>6&1,te=1<<(7&W)+1,$=l,C=c,T=!1;W>>7&&(T=!0,$=e,C=te,e+=3*te);var O=e;for(e++;;){var b;if(!((b=t[e++])>=0))throw Error("Invalid block size");if(b===0)break;e+=b}h.push({x:w,y:E,width:q,height:ee,has_local_palette:T,palette_offset:$,palette_size:C,data_offset:O,data_length:e-O,transparent_index:g,interlaced:!!K,delay:y,disposal:f});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return h.length},this.loopCount=function(){return x},this.frameInfo=function(P){if(P<0||P>=h.length)throw new Error("Frame index out of range.");return h[P]},this.decodeAndBlitFrameBGRA=function(P,_){var z=this.frameInfo(P),Z=z.width*z.height,k=new Uint8Array(Z);nb(t,z.data_offset,k,Z);var F=z.palette_offset,X=z.transparent_index;X===null&&(X=256);var U=z.width,B=r-U,ce=U,L=4*(z.y*r+z.x),D=4*((z.y+z.height)*r+z.x),j=L,I=4*B;z.interlaced===!0&&(I+=4*r*7);for(var M=8,J=0,H=k.length;J<H;++J){var Q=k[J];if(ce===0&&(ce=U,(j+=I)>=D&&(I=4*B+4*r*(M-1),j=L+(U+B)*(M<<1),M>>=1)),Q===X)j+=4;else{var se=t[F+3*Q],G=t[F+3*Q+1],re=t[F+3*Q+2];_[j++]=re,_[j++]=G,_[j++]=se,_[j++]=255}--ce}},this.decodeAndBlitFrameRGBA=function(P,_){var z=this.frameInfo(P),Z=z.width*z.height,k=new Uint8Array(Z);nb(t,z.data_offset,k,Z);var F=z.palette_offset,X=z.transparent_index;X===null&&(X=256);var U=z.width,B=r-U,ce=U,L=4*(z.y*r+z.x),D=4*((z.y+z.height)*r+z.x),j=L,I=4*B;z.interlaced===!0&&(I+=4*r*7);for(var M=8,J=0,H=k.length;J<H;++J){var Q=k[J];if(ce===0&&(ce=U,(j+=I)>=D&&(I=4*B+4*r*(M-1),j=L+(U+B)*(M<<1),M>>=1)),Q===X)j+=4;else{var se=t[F+3*Q],G=t[F+3*Q+1],re=t[F+3*Q+2];_[j++]=se,_[j++]=G,_[j++]=re,_[j++]=255}--ce}}}function nb(t,e,r,n){for(var i=t[e++],o=1<<i,s=o+1,l=s+1,c=i+1,u=(1<<c)-1,h=0,y=0,g=0,f=t[e++],x=new Int32Array(4096),S=null;;){for(;h<16&&f!==0;)y|=t[e++]<<h,h+=8,f===1?f=t[e++]:--f;if(h<c)break;var w=y&u;if(y>>=c,h-=c,w!==o){if(w===s)break;for(var E=w<l?w:S,q=0,ee=E;ee>o;)ee=x[ee]>>8,++q;var W=ee;if(g+q+(E!==w?1:0)>n)return void cn.log("Warning, gif stream longer than expected.");r[g++]=W;var K=g+=q;for(E!==w&&(r[g++]=W),ee=E;q--;)ee=x[ee],r[--K]=255&ee,ee>>=8;S!==null&&l<4096&&(x[l++]=S<<8|W,l>=u+1&&c<12&&(++c,u=u<<1|1)),S=w}else l=s+1,u=(1<<(c=i+1))-1,S=null}return g!==n&&cn.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function kf(t){var e,r,n,i,o,s=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),h=new Array(64),y=new Array(65535),g=new Array(65535),f=new Array(64),x=new Array(64),S=[],w=0,E=7,q=new Array(64),ee=new Array(64),W=new Array(64),K=new Array(256),te=new Array(2048),$=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],C=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],T=[0,1,2,3,4,5,6,7,8,9,10,11],O=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],b=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],P=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],_=[0,1,2,3,4,5,6,7,8,9,10,11],z=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Z=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function k(L,D){for(var j=0,I=0,M=new Array,J=1;J<=16;J++){for(var H=1;H<=L[J];H++)M[D[I]]=[],M[D[I]][0]=j,M[D[I]][1]=J,I++,j++;j*=2}return M}function F(L){for(var D=L[0],j=L[1]-1;j>=0;)D&1<<j&&(w|=1<<E),j--,--E<0&&(w==255?(X(255),X(0)):X(w),E=7,w=0)}function X(L){S.push(L)}function U(L){X(L>>8&255),X(255&L)}function B(L,D,j,I,M){for(var J,H=M[0],Q=M[240],se=function(ue,ge){var Pe,pe,_e,Le,De,Te,$e,Ie,Re,Je,Be=0;for(Re=0;Re<8;++Re){Pe=ue[Be],pe=ue[Be+1],_e=ue[Be+2],Le=ue[Be+3],De=ue[Be+4],Te=ue[Be+5],$e=ue[Be+6];var Ke=Pe+(Ie=ue[Be+7]),Xe=Pe-Ie,at=pe+$e,ot=pe-$e,Qe=_e+Te,dt=_e-Te,ct=Le+De,kt=Le-De,gt=Ke+ct,qe=Ke-ct,Dt=at+Qe,Rt=at-Qe;ue[Be]=gt+Dt,ue[Be+4]=gt-Dt;var St=.707106781*(Rt+qe);ue[Be+2]=qe+St,ue[Be+6]=qe-St;var Bt=.382683433*((gt=kt+dt)-(Rt=ot+Xe)),fr=.5411961*gt+Bt,Qt=1.306562965*Rt+Bt,cr=.707106781*(Dt=dt+ot),xr=Xe+cr,It=Xe-cr;ue[Be+5]=It+fr,ue[Be+3]=It-fr,ue[Be+1]=xr+Qt,ue[Be+7]=xr-Qt,Be+=8}for(Be=0,Re=0;Re<8;++Re){Pe=ue[Be],pe=ue[Be+8],_e=ue[Be+16],Le=ue[Be+24],De=ue[Be+32],Te=ue[Be+40],$e=ue[Be+48];var Ge=Pe+(Ie=ue[Be+56]),Nt=Pe-Ie,At=pe+$e,Lt=pe-$e,Ue=_e+Te,nt=_e-Te,_t=Le+De,Wt=Le-De,We=Ge+_t,vt=Ge-_t,Tt=At+Ue,jt=At-Ue;ue[Be]=We+Tt,ue[Be+32]=We-Tt;var Kt=.707106781*(jt+vt);ue[Be+16]=vt+Kt,ue[Be+48]=vt-Kt;var rr=.382683433*((We=Wt+nt)-(jt=Lt+Nt)),yr=.5411961*We+rr,nr=1.306562965*jt+rr,ur=.707106781*(Tt=nt+Lt),Ft=Nt+ur,$t=Nt-ur;ue[Be+40]=$t+yr,ue[Be+24]=$t-yr,ue[Be+8]=Ft+nr,ue[Be+56]=Ft-nr,Be++}for(Re=0;Re<64;++Re)Je=ue[Re]*ge[Re],f[Re]=Je>0?Je+.5|0:Je-.5|0;return f}(L,D),G=0;G<64;++G)x[$[G]]=se[G];var re=x[0]-j;j=x[0],re==0?F(I[0]):(F(I[g[J=32767+re]]),F(y[J]));for(var oe=63;oe>0&&x[oe]==0;)oe--;if(oe==0)return F(H),j;for(var fe,ae=1;ae<=oe;){for(var Y=ae;x[ae]==0&&ae<=oe;)++ae;var ie=ae-Y;if(ie>=16){fe=ie>>4;for(var de=1;de<=fe;++de)F(Q);ie&=15}J=32767+x[ae],F(M[(ie<<4)+g[J]]),F(y[J]),ae++}return oe!=63&&F(H),j}function ce(L){L=Math.min(Math.max(L,1),100),o!=L&&(function(D){for(var j=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],I=0;I<64;I++){var M=s((j[I]*D+50)/100);M=Math.min(Math.max(M,1),255),l[$[I]]=M}for(var J=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],H=0;H<64;H++){var Q=s((J[H]*D+50)/100);Q=Math.min(Math.max(Q,1),255),c[$[H]]=Q}for(var se=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],G=0,re=0;re<8;re++)for(var oe=0;oe<8;oe++)u[G]=1/(l[$[G]]*se[re]*se[oe]*8),h[G]=1/(c[$[G]]*se[re]*se[oe]*8),G++}(L<50?Math.floor(5e3/L):Math.floor(200-2*L)),o=L)}this.encode=function(L,D){D&&ce(D),S=new Array,w=0,E=7,U(65496),U(65504),U(16),X(74),X(70),X(73),X(70),X(0),X(1),X(1),X(0),U(1),U(1),X(0),X(0),function(){U(65499),U(132),X(0);for(var pe=0;pe<64;pe++)X(l[pe]);X(1);for(var _e=0;_e<64;_e++)X(c[_e])}(),function(pe,_e){U(65472),U(17),X(8),U(_e),U(pe),X(3),X(1),X(17),X(0),X(2),X(17),X(1),X(3),X(17),X(1)}(L.width,L.height),function(){U(65476),U(418),X(0);for(var pe=0;pe<16;pe++)X(C[pe+1]);for(var _e=0;_e<=11;_e++)X(T[_e]);X(16);for(var Le=0;Le<16;Le++)X(O[Le+1]);for(var De=0;De<=161;De++)X(b[De]);X(1);for(var Te=0;Te<16;Te++)X(P[Te+1]);for(var $e=0;$e<=11;$e++)X(_[$e]);X(17);for(var Ie=0;Ie<16;Ie++)X(z[Ie+1]);for(var Re=0;Re<=161;Re++)X(Z[Re])}(),U(65498),U(12),X(3),X(1),X(0),X(2),X(17),X(3),X(17),X(0),X(63),X(0);var j=0,I=0,M=0;w=0,E=7,this.encode.displayName="_encode_";for(var J,H,Q,se,G,re,oe,fe,ae,Y=L.data,ie=L.width,de=L.height,ue=4*ie,ge=0;ge<de;){for(J=0;J<ue;){for(G=ue*ge+J,oe=-1,fe=0,ae=0;ae<64;ae++)re=G+(fe=ae>>3)*ue+(oe=4*(7&ae)),ge+fe>=de&&(re-=ue*(ge+1+fe-de)),J+oe>=ue&&(re-=J+oe-ue+4),H=Y[re++],Q=Y[re++],se=Y[re++],q[ae]=(te[H]+te[Q+256>>0]+te[se+512>>0]>>16)-128,ee[ae]=(te[H+768>>0]+te[Q+1024>>0]+te[se+1280>>0]>>16)-128,W[ae]=(te[H+1280>>0]+te[Q+1536>>0]+te[se+1792>>0]>>16)-128;j=B(q,u,j,e,n),I=B(ee,h,I,r,i),M=B(W,h,M,r,i),J+=32}ge+=8}if(E>=0){var Pe=[];Pe[1]=E+1,Pe[0]=(1<<E+1)-1,F(Pe)}return U(65497),new Uint8Array(S)},t=t||50,function(){for(var L=String.fromCharCode,D=0;D<256;D++)K[D]=L(D)}(),e=k(C,T),r=k(P,_),n=k(O,b),i=k(z,Z),function(){for(var L=1,D=2,j=1;j<=15;j++){for(var I=L;I<D;I++)g[32767+I]=j,y[32767+I]=[],y[32767+I][1]=j,y[32767+I][0]=I;for(var M=-(D-1);M<=-L;M++)g[32767+M]=j,y[32767+M]=[],y[32767+M][1]=j,y[32767+M][0]=D-1+M;L<<=1,D<<=1}}(),function(){for(var L=0;L<256;L++)te[L]=19595*L,te[L+256>>0]=38470*L,te[L+512>>0]=7471*L+32768,te[L+768>>0]=-11059*L,te[L+1024>>0]=-21709*L,te[L+1280>>0]=32768*L+8421375,te[L+1536>>0]=-27439*L,te[L+1792>>0]=-5329*L}(),ce(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Ao(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function ib(t){function e(C){if(!C)throw Error("assert :P")}function r(C,T,O){for(var b=0;4>b;b++)if(C[T+b]!=O.charCodeAt(b))return!0;return!1}function n(C,T,O,b,P){for(var _=0;_<P;_++)C[T+_]=O[b+_]}function i(C,T,O,b){for(var P=0;P<b;P++)C[T+P]=O}function o(C){return new Int32Array(C)}function s(C,T){for(var O=[],b=0;b<C;b++)O.push(new T);return O}function l(C,T){var O=[];return function b(P,_,z){for(var Z=z[_],k=0;k<Z&&(P.push(z.length>_+1?[]:new T),!(z.length<_+1));k++)b(P[k],_+1,z)}(O,0,C),O}var c=function(){var C=this;function T(d,v){for(var N=1<<v-1>>>0;d&N;)N>>>=1;return N?(d&N-1)+N:d}function O(d,v,N,ne,ye){e(!(ne%N));do d[v+(ne-=N)]=ye;while(0<ne)}function b(d,v,N,ne,ye){if(e(2328>=ye),512>=ye)var ve=o(512);else if((ve=o(ye))==null)return 0;return function(be,xe,Ae,ke,Fe,Ze){var et,Ye,yt=xe,it=1<<Ae,Oe=o(16),je=o(16);for(e(Fe!=0),e(ke!=null),e(be!=null),e(0<Ae),Ye=0;Ye<Fe;++Ye){if(15<ke[Ye])return 0;++Oe[ke[Ye]]}if(Oe[0]==Fe)return 0;for(je[1]=0,et=1;15>et;++et){if(Oe[et]>1<<et)return 0;je[et+1]=je[et]+Oe[et]}for(Ye=0;Ye<Fe;++Ye)et=ke[Ye],0<ke[Ye]&&(Ze[je[et]++]=Ye);if(je[15]==1)return(ke=new P).g=0,ke.value=Ze[0],O(be,yt,1,it,ke),it;var ft,Pt=-1,mt=it-1,Yt=0,Vt=1,dr=1,zt=1<<Ae;for(Ye=0,et=1,Fe=2;et<=Ae;++et,Fe<<=1){if(Vt+=dr<<=1,0>(dr-=Oe[et]))return 0;for(;0<Oe[et];--Oe[et])(ke=new P).g=et,ke.value=Ze[Ye++],O(be,yt+Yt,Fe,zt,ke),Yt=T(Yt,et)}for(et=Ae+1,Fe=2;15>=et;++et,Fe<<=1){if(Vt+=dr<<=1,0>(dr-=Oe[et]))return 0;for(;0<Oe[et];--Oe[et]){if(ke=new P,(Yt&mt)!=Pt){for(yt+=zt,ft=1<<(Pt=et)-Ae;15>Pt&&!(0>=(ft-=Oe[Pt]));)++Pt,ft<<=1;it+=zt=1<<(ft=Pt-Ae),be[xe+(Pt=Yt&mt)].g=ft+Ae,be[xe+Pt].value=yt-xe-Pt}ke.g=et-Ae,ke.value=Ze[Ye++],O(be,yt+(Yt>>Ae),Fe,zt,ke),Yt=T(Yt,et)}}return Vt!=2*je[15]-1?0:it}(d,v,N,ne,ye,ve)}function P(){this.value=this.g=0}function _(){this.value=this.g=0}function z(){this.G=s(5,P),this.H=o(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(Qn,_)}function Z(d,v,N,ne){e(d!=null),e(v!=null),e(2147483648>ne),d.Ca=254,d.I=0,d.b=-8,d.Ka=0,d.oa=v,d.pa=N,d.Jd=v,d.Yc=N+ne,d.Zc=4<=ne?N+ne-4+1:N,J(d)}function k(d,v){for(var N=0;0<v--;)N|=Q(d,128)<<v;return N}function F(d,v){var N=k(d,v);return H(d)?-N:N}function X(d,v,N,ne){var ye,ve=0;for(e(d!=null),e(v!=null),e(4294967288>ne),d.Sb=ne,d.Ra=0,d.u=0,d.h=0,4<ne&&(ne=4),ye=0;ye<ne;++ye)ve+=v[N+ye]<<8*ye;d.Ra=ve,d.bb=ne,d.oa=v,d.pa=N}function U(d){for(;8<=d.u&&d.bb<d.Sb;)d.Ra>>>=8,d.Ra+=d.oa[d.pa+d.bb]<<zl-8>>>0,++d.bb,d.u-=8;j(d)&&(d.h=1,d.u=0)}function B(d,v){if(e(0<=v),!d.h&&v<=ql){var N=D(d)&Vl[v];return d.u+=v,U(d),N}return d.h=1,d.u=0}function ce(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function L(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function D(d){return d.Ra>>>(d.u&zl-1)>>>0}function j(d){return e(d.bb<=d.Sb),d.h||d.bb==d.Sb&&d.u>zl}function I(d,v){d.u=v,d.h=j(d)}function M(d){d.u>=jc&&(e(d.u>=jc),U(d))}function J(d){e(d!=null&&d.oa!=null),d.pa<d.Zc?(d.I=(d.oa[d.pa++]|d.I<<8)>>>0,d.b+=8):(e(d!=null&&d.oa!=null),d.pa<d.Yc?(d.b+=8,d.I=d.oa[d.pa++]|d.I<<8):d.Ka?d.b=0:(d.I<<=8,d.b+=8,d.Ka=1))}function H(d){return k(d,1)}function Q(d,v){var N=d.Ca;0>d.b&&J(d);var ne=d.b,ye=N*v>>>8,ve=(d.I>>>ne>ye)+0;for(ve?(N-=ye,d.I-=ye+1<<ne>>>0):N=ye+1,ne=N,ye=0;256<=ne;)ye+=8,ne>>=8;return ne=7^ye+Ti[ne],d.b-=ne,d.Ca=(N<<ne)-1,ve}function se(d,v,N){d[v+0]=N>>24&255,d[v+1]=N>>16&255,d[v+2]=N>>8&255,d[v+3]=N>>0&255}function G(d,v){return d[v+0]<<0|d[v+1]<<8}function re(d,v){return G(d,v)|d[v+2]<<16}function oe(d,v){return G(d,v)|G(d,v+2)<<16}function fe(d,v){var N=1<<v;return e(d!=null),e(0<v),d.X=o(N),d.X==null?0:(d.Mb=32-v,d.Xa=v,1)}function ae(d,v){e(d!=null),e(v!=null),e(d.Xa==v.Xa),n(v.X,0,d.X,0,1<<v.Xa)}function Y(){this.X=[],this.Xa=this.Mb=0}function ie(d,v,N,ne){e(N!=null),e(ne!=null);var ye=N[0],ve=ne[0];return ye==0&&(ye=(d*ve+v/2)/v),ve==0&&(ve=(v*ye+d/2)/d),0>=ye||0>=ve?0:(N[0]=ye,ne[0]=ve,1)}function de(d,v){return d+(1<<v)-1>>>v}function ue(d,v){return((4278255360&d)+(4278255360&v)>>>0&4278255360)+((16711935&d)+(16711935&v)>>>0&16711935)>>>0}function ge(d,v){C[v]=function(N,ne,ye,ve,be,xe,Ae){var ke;for(ke=0;ke<be;++ke){var Fe=C[d](xe[Ae+ke-1],ye,ve+ke);xe[Ae+ke]=ue(N[ne+ke],Fe)}}}function Pe(){this.ud=this.hd=this.jd=0}function pe(d,v){return((4278124286&(d^v))>>>1)+(d&v)>>>0}function _e(d){return 0<=d&&256>d?d:0>d?0:255<d?255:void 0}function Le(d,v){return _e(d+(d-v+.5>>1))}function De(d,v,N){return Math.abs(v-N)-Math.abs(d-N)}function Te(d,v,N,ne,ye,ve,be){for(ne=ve[be-1],N=0;N<ye;++N)ve[be+N]=ne=ue(d[v+N],ne)}function $e(d,v,N,ne,ye){var ve;for(ve=0;ve<N;++ve){var be=d[v+ve],xe=be>>8&255,Ae=16711935&(Ae=(Ae=16711935&be)+((xe<<16)+xe));ne[ye+ve]=(4278255360&be)+Ae>>>0}}function Ie(d,v){v.jd=d>>0&255,v.hd=d>>8&255,v.ud=d>>16&255}function Re(d,v,N,ne,ye,ve){var be;for(be=0;be<ne;++be){var xe=v[N+be],Ae=xe>>>8,ke=xe,Fe=255&(Fe=(Fe=xe>>>16)+((d.jd<<24>>24)*(Ae<<24>>24)>>>5));ke=255&(ke=(ke=ke+((d.hd<<24>>24)*(Ae<<24>>24)>>>5))+((d.ud<<24>>24)*(Fe<<24>>24)>>>5)),ye[ve+be]=(4278255360&xe)+(Fe<<16)+ke}}function Je(d,v,N,ne,ye){C[v]=function(ve,be,xe,Ae,ke,Fe,Ze,et,Ye){for(Ae=Ze;Ae<et;++Ae)for(Ze=0;Ze<Ye;++Ze)ke[Fe++]=ye(xe[ne(ve[be++])])},C[d]=function(ve,be,xe,Ae,ke,Fe,Ze){var et=8>>ve.b,Ye=ve.Ea,yt=ve.K[0],it=ve.w;if(8>et)for(ve=(1<<ve.b)-1,it=(1<<et)-1;be<xe;++be){var Oe,je=0;for(Oe=0;Oe<Ye;++Oe)Oe&ve||(je=ne(Ae[ke++])),Fe[Ze++]=ye(yt[je&it]),je>>=et}else C["VP8LMapColor"+N](Ae,ke,yt,it,Fe,Ze,be,xe,Ye)}}function Be(d,v,N,ne,ye){for(N=v+N;v<N;){var ve=d[v++];ne[ye++]=ve>>16&255,ne[ye++]=ve>>8&255,ne[ye++]=ve>>0&255}}function Ke(d,v,N,ne,ye){for(N=v+N;v<N;){var ve=d[v++];ne[ye++]=ve>>16&255,ne[ye++]=ve>>8&255,ne[ye++]=ve>>0&255,ne[ye++]=ve>>24&255}}function Xe(d,v,N,ne,ye){for(N=v+N;v<N;){var ve=(be=d[v++])>>16&240|be>>12&15,be=be>>0&240|be>>28&15;ne[ye++]=ve,ne[ye++]=be}}function at(d,v,N,ne,ye){for(N=v+N;v<N;){var ve=(be=d[v++])>>16&248|be>>13&7,be=be>>5&224|be>>3&31;ne[ye++]=ve,ne[ye++]=be}}function ot(d,v,N,ne,ye){for(N=v+N;v<N;){var ve=d[v++];ne[ye++]=ve>>0&255,ne[ye++]=ve>>8&255,ne[ye++]=ve>>16&255}}function Qe(d,v,N,ne,ye,ve){if(ve==0)for(N=v+N;v<N;)se(ne,((ve=d[v++])[0]>>24|ve[1]>>8&65280|ve[2]<<8&16711680|ve[3]<<24)>>>0),ye+=32;else n(ne,ye,d,v,N)}function dt(d,v){C[v][0]=C[d+"0"],C[v][1]=C[d+"1"],C[v][2]=C[d+"2"],C[v][3]=C[d+"3"],C[v][4]=C[d+"4"],C[v][5]=C[d+"5"],C[v][6]=C[d+"6"],C[v][7]=C[d+"7"],C[v][8]=C[d+"8"],C[v][9]=C[d+"9"],C[v][10]=C[d+"10"],C[v][11]=C[d+"11"],C[v][12]=C[d+"12"],C[v][13]=C[d+"13"],C[v][14]=C[d+"0"],C[v][15]=C[d+"0"]}function ct(d){return d==Ap||d==Cp||d==gd||d==Ip}function kt(){this.eb=[],this.size=this.A=this.fb=0}function gt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function qe(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new kt,this.f.kb=new gt,this.sd=null}function Dt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Rt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function St(d){return alert("todo:WebPSamplerProcessPlane"),d.T}function Bt(d,v){var N=d.T,ne=v.ba.f.RGBA,ye=ne.eb,ve=ne.fb+d.ka*ne.A,be=lo[v.ba.S],xe=d.y,Ae=d.O,ke=d.f,Fe=d.N,Ze=d.ea,et=d.W,Ye=v.cc,yt=v.dc,it=v.Mc,Oe=v.Nc,je=d.ka,ft=d.ka+d.T,Pt=d.U,mt=Pt+1>>1;for(je==0?be(xe,Ae,null,null,ke,Fe,Ze,et,ke,Fe,Ze,et,ye,ve,null,null,Pt):(be(v.ec,v.fc,xe,Ae,Ye,yt,it,Oe,ke,Fe,Ze,et,ye,ve-ne.A,ye,ve,Pt),++N);je+2<ft;je+=2)Ye=ke,yt=Fe,it=Ze,Oe=et,Fe+=d.Rc,et+=d.Rc,ve+=2*ne.A,be(xe,(Ae+=2*d.fa)-d.fa,xe,Ae,Ye,yt,it,Oe,ke,Fe,Ze,et,ye,ve-ne.A,ye,ve,Pt);return Ae+=d.fa,d.j+ft<d.o?(n(v.ec,v.fc,xe,Ae,Pt),n(v.cc,v.dc,ke,Fe,mt),n(v.Mc,v.Nc,Ze,et,mt),N--):1&ft||be(xe,Ae,null,null,ke,Fe,Ze,et,ke,Fe,Ze,et,ye,ve+ne.A,null,null,Pt),N}function fr(d,v,N){var ne=d.F,ye=[d.J];if(ne!=null){var ve=d.U,be=v.ba.S,xe=be==yd||be==gd;v=v.ba.f.RGBA;var Ae=[0],ke=d.ka;Ae[0]=d.T,d.Kb&&(ke==0?--Ae[0]:(--ke,ye[0]-=d.width),d.j+d.ka+d.T==d.o&&(Ae[0]=d.o-d.j-ke));var Fe=v.eb;ke=v.fb+ke*v.A,d=hn(ne,ye[0],d.width,ve,Ae,Fe,ke+(xe?0:3),v.A),e(N==Ae),d&&ct(be)&&so(Fe,ke,xe,ve,Ae,v.A)}return 0}function Qt(d){var v=d.ma,N=v.ba.S,ne=11>N,ye=N==fd||N==md||N==yd||N==xp||N==12||ct(N);if(v.memory=null,v.Ib=null,v.Jb=null,v.Nd=null,!Oc(v.Oa,d,ye?11:12))return 0;if(ye&&ct(N)&&xt(),d.da)alert("todo:use_scaling");else{if(ne){if(v.Ib=St,d.Kb){if(N=d.U+1>>1,v.memory=o(d.U+2*N),v.memory==null)return 0;v.ec=v.memory,v.fc=0,v.cc=v.ec,v.dc=v.fc+d.U,v.Mc=v.cc,v.Nc=v.dc+N,v.Ib=Bt,xt()}}else alert("todo:EmitYUV");ye&&(v.Jb=fr,ne&&He())}if(ne&&!lg){for(d=0;256>d;++d)q_[d]=89858*(d-128)+bd>>vd,H_[d]=-22014*(d-128)+bd,U_[d]=-45773*(d-128),z_[d]=113618*(d-128)+bd>>vd;for(d=Wc;d<Tp;++d)v=76283*(d-16)+bd>>vd,G_[d-Wc]=Zr(v,255),W_[d-Wc]=Zr(v+8>>4,15);lg=1}return 1}function cr(d){var v=d.ma,N=d.U,ne=d.T;return e(!(1&d.ka)),0>=N||0>=ne?0:(N=v.Ib(d,v),v.Jb!=null&&v.Jb(d,v,N),v.Dc+=N,1)}function xr(d){d.ma.memory=null}function It(d,v,N,ne){return B(d,8)!=47?0:(v[0]=B(d,14)+1,N[0]=B(d,14)+1,ne[0]=B(d,1),B(d,3)!=0?0:!d.h)}function Ge(d,v){if(4>d)return d+1;var N=d-2>>1;return(2+(1&d)<<N)+B(v,N)+1}function Nt(d,v){return 120<v?v-120:1<=(N=((N=$_[v-1])>>4)*d+(8-(15&N)))?N:1;var N}function At(d,v,N){var ne=D(N),ye=d[v+=255&ne].g-8;return 0<ye&&(I(N,N.u+8),ne=D(N),v+=d[v].value,v+=ne&(1<<ye)-1),I(N,N.u+d[v].g),d[v].value}function Lt(d,v,N){return N.g+=d.g,N.value+=d.value<<v>>>0,e(8>=N.g),d.g}function Ue(d,v,N){var ne=d.xc;return e((v=ne==0?0:d.vc[d.md*(N>>ne)+(v>>ne)])<d.Wb),d.Ya[v]}function nt(d,v,N,ne){var ye=d.ab,ve=d.c*v,be=d.C;v=be+v;var xe=N,Ae=ne;for(ne=d.Ta,N=d.Ua;0<ye--;){var ke=d.gc[ye],Fe=be,Ze=v,et=xe,Ye=Ae,yt=(Ae=ne,xe=N,ke.Ea);switch(e(Fe<Ze),e(Ze<=ke.nc),ke.hc){case 2:ad(et,Ye,(Ze-Fe)*yt,Ae,xe);break;case 0:var it=Fe,Oe=Ze,je=Ae,ft=xe,Pt=(zt=ke).Ea;it==0&&(Pp(et,Ye,null,null,1,je,ft),Te(et,Ye+1,0,0,Pt-1,je,ft+1),Ye+=Pt,ft+=Pt,++it);for(var mt=1<<zt.b,Yt=mt-1,Vt=de(Pt,zt.b),dr=zt.K,zt=zt.w+(it>>zt.b)*Vt;it<Oe;){var Kr=dr,tn=zt,Gr=1;for(Vc(et,Ye,je,ft-Pt,1,je,ft);Gr<Pt;){var Mr=(Gr&~Yt)+mt;Mr>Pt&&(Mr=Pt),(0,Js[Kr[tn++]>>8&15])(et,Ye+ +Gr,je,ft+Gr-Pt,Mr-Gr,je,ft+Gr),Gr=Mr}Ye+=Pt,ft+=Pt,++it&Yt||(zt+=Vt)}Ze!=ke.nc&&n(Ae,xe-yt,Ae,xe+(Ze-Fe-1)*yt,yt);break;case 1:for(yt=et,Oe=Ye,Pt=(et=ke.Ea)-(ft=et&~(je=(Ye=1<<ke.b)-1)),it=de(et,ke.b),mt=ke.K,ke=ke.w+(Fe>>ke.b)*it;Fe<Ze;){for(Yt=mt,Vt=ke,dr=new Pe,zt=Oe+ft,Kr=Oe+et;Oe<zt;)Ie(Yt[Vt++],dr),Ka(dr,yt,Oe,Ye,Ae,xe),Oe+=Ye,xe+=Ye;Oe<Kr&&(Ie(Yt[Vt++],dr),Ka(dr,yt,Oe,Pt,Ae,xe),Oe+=Pt,xe+=Pt),++Fe&je||(ke+=it)}break;case 3:if(et==Ae&&Ye==xe&&0<ke.b){for(Oe=Ae,et=yt=xe+(Ze-Fe)*yt-(ft=(Ze-Fe)*de(ke.Ea,ke.b)),Ye=Ae,je=xe,it=[],ft=(Pt=ft)-1;0<=ft;--ft)it[ft]=Ye[je+ft];for(ft=Pt-1;0<=ft;--ft)Oe[et+ft]=it[ft];no(ke,Fe,Ze,Ae,yt,Ae,xe)}else no(ke,Fe,Ze,et,Ye,Ae,xe)}xe=ne,Ae=N}Ae!=N&&n(ne,N,xe,Ae,ve)}function _t(d,v){var N=d.V,ne=d.Ba+d.c*d.C,ye=v-d.C;if(e(v<=d.l.o),e(16>=ye),0<ye){var ve=d.l,be=d.Ta,xe=d.Ua,Ae=ve.width;if(nt(d,ye,N,ne),ye=xe=[xe],e((N=d.C)<(ne=v)),e(ve.v<ve.va),ne>ve.o&&(ne=ve.o),N<ve.j){var ke=ve.j-N;N=ve.j,ye[0]+=ke*Ae}if(N>=ne?N=0:(ye[0]+=4*ve.v,ve.ka=N-ve.j,ve.U=ve.va-ve.v,ve.T=ne-N,N=1),N){if(xe=xe[0],11>(N=d.ca).S){var Fe=N.f.RGBA,Ze=(ne=N.S,ye=ve.U,ve=ve.T,ke=Fe.eb,Fe.A),et=ve;for(Fe=Fe.fb+d.Ma*Fe.A;0<et--;){var Ye=be,yt=xe,it=ye,Oe=ke,je=Fe;switch(ne){case pd:ki(Ye,yt,it,Oe,je);break;case fd:xi(Ye,yt,it,Oe,je);break;case Ap:xi(Ye,yt,it,Oe,je),so(Oe,je,0,it,1,0);break;case Zy:hs(Ye,yt,it,Oe,je);break;case md:Qe(Ye,yt,it,Oe,je,1);break;case Cp:Qe(Ye,yt,it,Oe,je,1),so(Oe,je,0,it,1,0);break;case yd:Qe(Ye,yt,it,Oe,je,0);break;case gd:Qe(Ye,yt,it,Oe,je,0),so(Oe,je,1,it,1,0);break;case xp:Qs(Ye,yt,it,Oe,je);break;case Ip:Qs(Ye,yt,it,Oe,je),dn(Oe,je,it,1,0);break;case eg:ds(Ye,yt,it,Oe,je);break;default:e(0)}xe+=Ae,Fe+=Ze}d.Ma+=ve}else alert("todo:EmitRescaledRowsYUVA");e(d.Ma<=N.height)}}d.C=v,e(d.C<=d.i)}function Wt(d){var v;if(0<d.ua)return 0;for(v=0;v<d.Wb;++v){var N=d.Ya[v].G,ne=d.Ya[v].H;if(0<N[1][ne[1]+0].g||0<N[2][ne[2]+0].g||0<N[3][ne[3]+0].g)return 0}return 1}function We(d,v,N,ne,ye,ve){if(d.Z!=0){var be=d.qd,xe=d.rd;for(e(ta[d.Z]!=null);v<N;++v)ta[d.Z](be,xe,ne,ye,ne,ye,ve),be=ne,xe=ye,ye+=ve;d.qd=be,d.rd=xe}}function vt(d,v){var N=d.l.ma,ne=N.Z==0||N.Z==1?d.l.j:d.C;if(ne=d.C<ne?ne:d.C,e(v<=d.l.o),v>ne){var ye=d.l.width,ve=N.ca,be=N.tb+ye*ne,xe=d.V,Ae=d.Ba+d.c*ne,ke=d.gc;e(d.ab==1),e(ke[0].hc==3),ld(ke[0],ne,v,xe,Ae,ve,be),We(N,ne,v,ve,be,ye)}d.C=d.Ma=v}function Tt(d,v,N,ne,ye,ve,be){var xe=d.$/ne,Ae=d.$%ne,ke=d.m,Fe=d.s,Ze=N+d.$,et=Ze;ye=N+ne*ye;var Ye=N+ne*ve,yt=280+Fe.ua,it=d.Pb?xe:16777216,Oe=0<Fe.ua?Fe.Wa:null,je=Fe.wc,ft=Ze<Ye?Ue(Fe,Ae,xe):null;e(d.C<ve),e(Ye<=ye);var Pt=!1;e:for(;;){for(;Pt||Ze<Ye;){var mt=0;if(xe>=it){var Yt=Ze-N;e((it=d).Pb),it.wd=it.m,it.xd=Yt,0<it.s.ua&&ae(it.s.Wa,it.s.vb),it=xe+T_}if(Ae&je||(ft=Ue(Fe,Ae,xe)),e(ft!=null),ft.Qb&&(v[Ze]=ft.qb,Pt=!0),!Pt)if(M(ke),ft.jc){mt=ke,Yt=v;var Vt=Ze,dr=ft.pd[D(mt)&Qn-1];e(ft.jc),256>dr.g?(I(mt,mt.u+dr.g),Yt[Vt]=dr.value,mt=0):(I(mt,mt.u+dr.g-256),e(256<=dr.value),mt=dr.value),mt==0&&(Pt=!0)}else mt=At(ft.G[0],ft.H[0],ke);if(ke.h)break;if(Pt||256>mt){if(!Pt)if(ft.nd)v[Ze]=(ft.qb|mt<<8)>>>0;else{if(M(ke),Pt=At(ft.G[1],ft.H[1],ke),M(ke),Yt=At(ft.G[2],ft.H[2],ke),Vt=At(ft.G[3],ft.H[3],ke),ke.h)break;v[Ze]=(Vt<<24|Pt<<16|mt<<8|Yt)>>>0}if(Pt=!1,++Ze,++Ae>=ne&&(Ae=0,++xe,be!=null&&xe<=ve&&!(xe%16)&&be(d,xe),Oe!=null))for(;et<Ze;)mt=v[et++],Oe.X[(506832829*mt&4294967295)>>>Oe.Mb]=mt}else if(280>mt){if(mt=Ge(mt-256,ke),Yt=At(ft.G[4],ft.H[4],ke),M(ke),Yt=Nt(ne,Yt=Ge(Yt,ke)),ke.h)break;if(Ze-N<Yt||ye-Ze<mt)break e;for(Vt=0;Vt<mt;++Vt)v[Ze+Vt]=v[Ze+Vt-Yt];for(Ze+=mt,Ae+=mt;Ae>=ne;)Ae-=ne,++xe,be!=null&&xe<=ve&&!(xe%16)&&be(d,xe);if(e(Ze<=ye),Ae&je&&(ft=Ue(Fe,Ae,xe)),Oe!=null)for(;et<Ze;)mt=v[et++],Oe.X[(506832829*mt&4294967295)>>>Oe.Mb]=mt}else{if(!(mt<yt))break e;for(Pt=mt-280,e(Oe!=null);et<Ze;)mt=v[et++],Oe.X[(506832829*mt&4294967295)>>>Oe.Mb]=mt;mt=Ze,e(!(Pt>>>(Yt=Oe).Xa)),v[mt]=Yt.X[Pt],Pt=!0}Pt||e(ke.h==j(ke))}if(d.Pb&&ke.h&&Ze<ye)e(d.m.h),d.a=5,d.m=d.wd,d.$=d.xd,0<d.s.ua&&ae(d.s.vb,d.s.Wa);else{if(ke.h)break e;be?.(d,xe>ve?ve:xe),d.a=0,d.$=Ze-N}return 1}return d.a=3,0}function jt(d){e(d!=null),d.vc=null,d.yc=null,d.Ya=null;var v=d.Wa;v!=null&&(v.X=null),d.vb=null,e(d!=null)}function Kt(){var d=new Bl;return d==null?null:(d.a=0,d.xb=ng,dt("Predictor","VP8LPredictors"),dt("Predictor","VP8LPredictors_C"),dt("PredictorAdd","VP8LPredictorsAdd"),dt("PredictorAdd","VP8LPredictorsAdd_C"),ad=$e,Ka=Re,ki=Be,xi=Ke,Qs=Xe,ds=at,hs=ot,C.VP8LMapColor32b=Ul,C.VP8LMapColor8b=cd,d)}function rr(d,v,N,ne,ye){var ve=1,be=[d],xe=[v],Ae=ne.m,ke=ne.s,Fe=null,Ze=0;e:for(;;){if(N)for(;ve&&B(Ae,1);){var et=be,Ye=xe,yt=ne,it=1,Oe=yt.m,je=yt.gc[yt.ab],ft=B(Oe,2);if(yt.Oc&1<<ft)ve=0;else{switch(yt.Oc|=1<<ft,je.hc=ft,je.Ea=et[0],je.nc=Ye[0],je.K=[null],++yt.ab,e(4>=yt.ab),ft){case 0:case 1:je.b=B(Oe,3)+2,it=rr(de(je.Ea,je.b),de(je.nc,je.b),0,yt,je.K),je.K=je.K[0];break;case 3:var Pt,mt=B(Oe,8)+1,Yt=16<mt?0:4<mt?1:2<mt?2:3;if(et[0]=de(je.Ea,Yt),je.b=Yt,Pt=it=rr(mt,1,0,yt,je.K)){var Vt,dr=mt,zt=je,Kr=1<<(8>>zt.b),tn=o(Kr);if(tn==null)Pt=0;else{var Gr=zt.K[0],Mr=zt.w;for(tn[0]=zt.K[0][0],Vt=1;Vt<1*dr;++Vt)tn[Vt]=ue(Gr[Mr+Vt],tn[Vt-1]);for(;Vt<4*Kr;++Vt)tn[Vt]=0;zt.K[0]=null,zt.K[0]=tn,Pt=1}}it=Pt;break;case 2:break;default:e(0)}ve=it}}if(be=be[0],xe=xe[0],ve&&B(Ae,1)&&!(ve=1<=(Ze=B(Ae,4))&&11>=Ze)){ne.a=3;break e}var ln;if(ln=ve)t:{var sn,Tr,kn,Ni=ne,Nn=be,Li=xe,rn=Ze,Ki=N,Ji=Ni.m,Gn=Ni.s,Xn=[null],Ci=1,co=0,qo=E_[rn];r:for(;;){if(Ki&&B(Ji,1)){var Wn=B(Ji,3)+2,ys=de(Nn,Wn),el=de(Li,Wn),Kl=ys*el;if(!rr(ys,el,0,Ni,Xn))break r;for(Xn=Xn[0],Gn.xc=Wn,sn=0;sn<Kl;++sn){var ra=Xn[sn]>>8&65535;Xn[sn]=ra,ra>=Ci&&(Ci=ra+1)}}if(Ji.h)break r;for(Tr=0;5>Tr;++Tr){var _n=tg[Tr];!Tr&&0<rn&&(_n+=1<<rn),co<_n&&(co=_n)}var kp=s(Ci*qo,P),dg=Ci,hg=s(dg,z);if(hg==null)var Sd=null;else e(65536>=dg),Sd=hg;var Yc=o(co);if(Sd==null||Yc==null||kp==null){Ni.a=1;break r}var Pd=kp;for(sn=kn=0;sn<Ci;++sn){var Po=Sd[sn],Jl=Po.G,Ql=Po.H,pg=0,wd=1,fg=0;for(Tr=0;5>Tr;++Tr){_n=tg[Tr],Jl[Tr]=Pd,Ql[Tr]=kn,!Tr&&0<rn&&(_n+=1<<rn);i:{var xd,Np=_n,Ad=Ni,Kc=Yc,J_=Pd,Q_=kn,Lp=0,na=Ad.m,X_=B(na,1);if(i(Kc,0,0,Np),X_){var Z_=B(na,1)+1,eS=B(na,1),mg=B(na,eS==0?1:8);Kc[mg]=1,Z_==2&&(Kc[mg=B(na,8)]=1);var Cd=1}else{var yg=o(19),gg=B(na,4)+4;if(19<gg){Ad.a=3;var Id=0;break i}for(xd=0;xd<gg;++xd)yg[I_[xd]]=B(na,3);var Rp=void 0,Jc=void 0,vg=Ad,tS=yg,$d=Np,bg=Kc,Dp=0,ia=vg.m,_g=8,Sg=s(128,P);n:for(;b(Sg,0,7,tS,19);){if(B(ia,1)){var rS=2+2*B(ia,3);if((Rp=2+B(ia,rS))>$d)break n}else Rp=$d;for(Jc=0;Jc<$d&&Rp--;){M(ia);var Pg=Sg[0+(127&D(ia))];I(ia,ia.u+Pg.g);var Xl=Pg.value;if(16>Xl)bg[Jc++]=Xl,Xl!=0&&(_g=Xl);else{var nS=Xl==16,wg=Xl-16,iS=A_[wg],xg=B(ia,x_[wg])+iS;if(Jc+xg>$d)break n;for(var oS=nS?_g:0;0<xg--;)bg[Jc++]=oS}}Dp=1;break n}Dp||(vg.a=3),Cd=Dp}(Cd=Cd&&!na.h)&&(Lp=b(J_,Q_,8,Kc,Np)),Cd&&Lp!=0?Id=Lp:(Ad.a=3,Id=0)}if(Id==0)break r;if(wd&&C_[Tr]==1&&(wd=Pd[kn].g==0),pg+=Pd[kn].g,kn+=Id,3>=Tr){var Qc,Mp=Yc[0];for(Qc=1;Qc<_n;++Qc)Yc[Qc]>Mp&&(Mp=Yc[Qc]);fg+=Mp}}if(Po.nd=wd,Po.Qb=0,wd&&(Po.qb=(Jl[3][Ql[3]+0].value<<24|Jl[1][Ql[1]+0].value<<16|Jl[2][Ql[2]+0].value)>>>0,pg==0&&256>Jl[0][Ql[0]+0].value&&(Po.Qb=1,Po.qb+=Jl[0][Ql[0]+0].value<<8)),Po.jc=!Po.Qb&&6>fg,Po.jc){var Ed,gs=Po;for(Ed=0;Ed<Qn;++Ed){var oa=Ed,sa=gs.pd[oa],Td=gs.G[0][gs.H[0]+oa];256<=Td.value?(sa.g=Td.g+256,sa.value=Td.value):(sa.g=0,sa.value=0,oa>>=Lt(Td,8,sa),oa>>=Lt(gs.G[1][gs.H[1]+oa],16,sa),oa>>=Lt(gs.G[2][gs.H[2]+oa],0,sa),Lt(gs.G[3][gs.H[3]+oa],24,sa))}}}Gn.vc=Xn,Gn.Wb=Ci,Gn.Ya=Sd,Gn.yc=kp,ln=1;break t}ln=0}if(!(ve=ln)){ne.a=3;break e}if(0<Ze){if(ke.ua=1<<Ze,!fe(ke.Wa,Ze)){ne.a=1,ve=0;break e}}else ke.ua=0;var Fp=ne,Ag=be,sS=xe,Op=Fp.s,Bp=Op.xc;if(Fp.c=Ag,Fp.i=sS,Op.md=de(Ag,Bp),Op.wc=Bp==0?-1:(1<<Bp)-1,N){ne.xb=F_;break e}if((Fe=o(be*xe))==null){ne.a=1,ve=0;break e}ve=(ve=Tt(ne,Fe,0,be,xe,xe,null))&&!Ae.h;break e}return ve?(ye!=null?ye[0]=Fe:(e(Fe==null),e(N)),ne.$=0,N||jt(ke)):jt(ke),ve}function yr(d,v){var N=d.c*d.i,ne=N+v+16*v;return e(d.c<=v),d.V=o(ne),d.V==null?(d.Ta=null,d.Ua=0,d.a=1,0):(d.Ta=d.V,d.Ua=d.Ba+N+v,1)}function nr(d,v){var N=d.C,ne=v-N,ye=d.V,ve=d.Ba+d.c*N;for(e(v<=d.l.o);0<ne;){var be=16<ne?16:ne,xe=d.l.ma,Ae=d.l.width,ke=Ae*be,Fe=xe.ca,Ze=xe.tb+Ae*N,et=d.Ta,Ye=d.Ua;nt(d,be,ye,ve),An(et,Ye,Fe,Ze,ke),We(xe,N,N+be,Fe,Ze,Ae),ne-=be,ye+=be*d.c,N+=be}e(N==v),d.C=d.Ma=v}function ur(){this.ub=this.yd=this.td=this.Rb=0}function Ft(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function $t(){this.Fb=this.Bb=this.Cb=0,this.Zb=o(4),this.Lb=o(4)}function wt(){this.Yb=function(){var d=[];return function v(N,ne,ye){for(var ve=ye[ne],be=0;be<ve&&(N.push(ye.length>ne+1?[]:0),!(ye.length<ne+1));be++)v(N[be],ne+1,ye)}(d,0,[3,11]),d}()}function Zt(){this.jb=o(3),this.Wc=l([4,8],wt),this.Xc=l([4,17],wt)}function lt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new o(4),this.od=new o(4)}function er(){this.ld=this.La=this.dd=this.tc=0}function ir(){this.Na=this.la=0}function sr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function _r(){this.ad=o(384),this.Za=0,this.Ob=o(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function lr(){this.uc=this.M=this.Nb=0,this.wa=Array(new er),this.Y=0,this.ya=Array(new _r),this.aa=0,this.l=new Ur}function Lr(){this.y=o(16),this.f=o(8),this.ea=o(8)}function on(){this.cb=this.a=0,this.sc="",this.m=new ce,this.Od=new ur,this.Kc=new Ft,this.ed=new lt,this.Qa=new $t,this.Ic=this.$c=this.Aa=0,this.D=new lr,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,ce),this.ia=0,this.pb=s(4,sr),this.Pa=new Zt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Lr),this.Hd=0,this.rb=Array(new ir),this.sb=0,this.wa=Array(new er),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new _r),this.L=this.aa=0,this.gd=l([4,2],er),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Ur(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Yr(){var d=new on;return d!=null&&(d.a=0,d.sc="OK",d.cb=0,d.Xb=0,Gc||(Gc=Si)),d}function Et(d,v,N){return d.a==0&&(d.a=v,d.sc=N,d.cb=0),0}function bn(d,v,N){return 3<=N&&d[v+0]==157&&d[v+1]==1&&d[v+2]==42}function _i(d,v){if(d==null)return 0;if(d.a=0,d.sc="OK",v==null)return Et(d,2,"null VP8Io passed to VP8GetHeaders()");var N=v.data,ne=v.w,ye=v.ha;if(4>ye)return Et(d,7,"Truncated header.");var ve=N[ne+0]|N[ne+1]<<8|N[ne+2]<<16,be=d.Od;if(be.Rb=!(1&ve),be.td=ve>>1&7,be.yd=ve>>4&1,be.ub=ve>>5,3<be.td)return Et(d,3,"Incorrect keyframe parameters.");if(!be.yd)return Et(d,4,"Frame not displayable.");ne+=3,ye-=3;var xe=d.Kc;if(be.Rb){if(7>ye)return Et(d,7,"cannot parse picture header");if(!bn(N,ne,ye))return Et(d,3,"Bad code word");xe.c=16383&(N[ne+4]<<8|N[ne+3]),xe.Td=N[ne+4]>>6,xe.i=16383&(N[ne+6]<<8|N[ne+5]),xe.Ud=N[ne+6]>>6,ne+=7,ye-=7,d.za=xe.c+15>>4,d.Ub=xe.i+15>>4,v.width=xe.c,v.height=xe.i,v.Da=0,v.j=0,v.v=0,v.va=v.width,v.o=v.height,v.da=0,v.ib=v.width,v.hb=v.height,v.U=v.width,v.T=v.height,i((ve=d.Pa).jb,0,255,ve.jb.length),e((ve=d.Qa)!=null),ve.Cb=0,ve.Bb=0,ve.Fb=1,i(ve.Zb,0,0,ve.Zb.length),i(ve.Lb,0,0,ve.Lb)}if(be.ub>ye)return Et(d,7,"bad partition length");Z(ve=d.m,N,ne,be.ub),ne+=be.ub,ye-=be.ub,be.Rb&&(xe.Ld=H(ve),xe.Kd=H(ve)),xe=d.Qa;var Ae,ke=d.Pa;if(e(ve!=null),e(xe!=null),xe.Cb=H(ve),xe.Cb){if(xe.Bb=H(ve),H(ve)){for(xe.Fb=H(ve),Ae=0;4>Ae;++Ae)xe.Zb[Ae]=H(ve)?F(ve,7):0;for(Ae=0;4>Ae;++Ae)xe.Lb[Ae]=H(ve)?F(ve,6):0}if(xe.Bb)for(Ae=0;3>Ae;++Ae)ke.jb[Ae]=H(ve)?k(ve,8):255}else xe.Bb=0;if(ve.Ka)return Et(d,3,"cannot parse segment header");if((xe=d.ed).zd=H(ve),xe.Tb=k(ve,6),xe.wb=k(ve,3),xe.Pc=H(ve),xe.Pc&&H(ve)){for(ke=0;4>ke;++ke)H(ve)&&(xe.vd[ke]=F(ve,6));for(ke=0;4>ke;++ke)H(ve)&&(xe.od[ke]=F(ve,6))}if(d.L=xe.Tb==0?0:xe.zd?1:2,ve.Ka)return Et(d,3,"cannot parse filter header");var Fe=ye;if(ye=Ae=ne,ne=Ae+Fe,xe=Fe,d.Xb=(1<<k(d.m,2))-1,Fe<3*(ke=d.Xb))N=7;else{for(Ae+=3*ke,xe-=3*ke,Fe=0;Fe<ke;++Fe){var Ze=N[ye+0]|N[ye+1]<<8|N[ye+2]<<16;Ze>xe&&(Ze=xe),Z(d.Jc[+Fe],N,Ae,Ze),Ae+=Ze,xe-=Ze,ye+=3}Z(d.Jc[+ke],N,Ae,xe),N=Ae<ne?0:5}if(N!=0)return Et(d,N,"cannot parse partitions");for(N=k(Ae=d.m,7),ye=H(Ae)?F(Ae,4):0,ne=H(Ae)?F(Ae,4):0,xe=H(Ae)?F(Ae,4):0,ke=H(Ae)?F(Ae,4):0,Ae=H(Ae)?F(Ae,4):0,Fe=d.Qa,Ze=0;4>Ze;++Ze){if(Fe.Cb){var et=Fe.Zb[Ze];Fe.Fb||(et+=N)}else{if(0<Ze){d.pb[Ze]=d.pb[0];continue}et=N}var Ye=d.pb[Ze];Ye.Sc[0]=$p[Zr(et+ye,127)],Ye.Sc[1]=Ep[Zr(et+0,127)],Ye.Eb[0]=2*$p[Zr(et+ne,127)],Ye.Eb[1]=101581*Ep[Zr(et+xe,127)]>>16,8>Ye.Eb[1]&&(Ye.Eb[1]=8),Ye.Qc[0]=$p[Zr(et+ke,117)],Ye.Qc[1]=Ep[Zr(et+Ae,127)],Ye.lc=et+Ae}if(!be.Rb)return Et(d,4,"Not a key frame.");for(H(ve),be=d.Pa,N=0;4>N;++N){for(ye=0;8>ye;++ye)for(ne=0;3>ne;++ne)for(xe=0;11>xe;++xe)ke=Q(ve,D_[N][ye][ne][xe])?k(ve,8):L_[N][ye][ne][xe],be.Wc[N][ye].Yb[ne][xe]=ke;for(ye=0;17>ye;++ye)be.Xc[N][ye]=be.Wc[N][M_[ye]]}return d.kc=H(ve),d.kc&&(d.Bd=k(ve,8)),d.cb=1}function Si(d,v,N,ne,ye,ve,be){var xe=v[ye].Yb[N];for(N=0;16>ye;++ye){if(!Q(d,xe[N+0]))return ye;for(;!Q(d,xe[N+1]);)if(xe=v[++ye].Yb[0],N=0,ye==16)return 16;var Ae=v[ye+1].Yb;if(Q(d,xe[N+2])){var ke=d,Fe=0;if(Q(ke,(et=xe)[(Ze=N)+3]))if(Q(ke,et[Ze+6])){for(xe=0,Ze=2*(Fe=Q(ke,et[Ze+8]))+(et=Q(ke,et[Ze+9+Fe])),Fe=0,et=k_[Ze];et[xe];++xe)Fe+=Fe+Q(ke,et[xe]);Fe+=3+(8<<Ze)}else Q(ke,et[Ze+7])?(Fe=7+2*Q(ke,165),Fe+=Q(ke,145)):Fe=5+Q(ke,159);else Fe=Q(ke,et[Ze+4])?3+Q(ke,et[Ze+5]):2;xe=Ae[2]}else Fe=1,xe=Ae[1];Ae=be+N_[ye],0>(ke=d).b&&J(ke);var Ze,et=ke.b,Ye=(Ze=ke.Ca>>1)-(ke.I>>et)>>31;--ke.b,ke.Ca+=Ye,ke.Ca|=1,ke.I-=(Ze+1&Ye)<<et,ve[Ae]=((Fe^Ye)-Ye)*ne[(0<ye)+0]}return 16}function mr(d){var v=d.rb[d.sb-1];v.la=0,v.Na=0,i(d.zc,0,0,d.zc.length),d.ja=0}function Nr(d,v){if(d==null)return 0;if(v==null)return Et(d,2,"NULL VP8Io parameter in VP8Decode().");if(!d.cb&&!_i(d,v))return 0;if(e(d.cb),v.ac==null||v.ac(v)){v.ob&&(d.L=0);var N=_d[d.L];if(d.L==2?(d.yb=0,d.zb=0):(d.yb=v.v-N>>4,d.zb=v.j-N>>4,0>d.yb&&(d.yb=0),0>d.zb&&(d.zb=0)),d.Va=v.o+15+N>>4,d.Hb=v.va+15+N>>4,d.Hb>d.za&&(d.Hb=d.za),d.Va>d.Ub&&(d.Va=d.Ub),0<d.L){var ne=d.ed;for(N=0;4>N;++N){var ye;if(d.Qa.Cb){var ve=d.Qa.Lb[N];d.Qa.Fb||(ve+=ne.Tb)}else ve=ne.Tb;for(ye=0;1>=ye;++ye){var be=d.gd[N][ye],xe=ve;if(ne.Pc&&(xe+=ne.vd[0],ye&&(xe+=ne.od[0])),0<(xe=0>xe?0:63<xe?63:xe)){var Ae=xe;0<ne.wb&&(Ae=4<ne.wb?Ae>>2:Ae>>1)>9-ne.wb&&(Ae=9-ne.wb),1>Ae&&(Ae=1),be.dd=Ae,be.tc=2*xe+Ae,be.ld=40<=xe?2:15<=xe?1:0}else be.tc=0;be.La=ye}}}N=0}else Et(d,6,"Frame setup failed"),N=d.a;if(N=N==0){if(N){d.$c=0,0<d.Aa||(d.Ic=K_);e:{N=d.Ic,ne=4*(Ae=d.za);var ke=32*Ae,Fe=Ae+1,Ze=0<d.L?Ae*(0<d.Aa?2:1):0,et=(d.Aa==2?2:1)*Ae;if((be=ne+832+(ye=3*(16*N+_d[d.L])/2*ke)+(ve=d.Fa!=null&&0<d.Fa.length?d.Kc.c*d.Kc.i:0))!=be)N=0;else{if(be>d.Vb){if(d.Vb=0,d.Ec=o(be),d.Fc=0,d.Ec==null){N=Et(d,1,"no memory during frame initialization.");break e}d.Vb=be}be=d.Ec,xe=d.Fc,d.Ac=be,d.Bc=xe,xe+=ne,d.Gd=s(ke,Lr),d.Hd=0,d.rb=s(Fe+1,ir),d.sb=1,d.wa=Ze?s(Ze,er):null,d.Y=0,d.D.Nb=0,d.D.wa=d.wa,d.D.Y=d.Y,0<d.Aa&&(d.D.Y+=Ae),e(!0),d.oc=be,d.pc=xe,xe+=832,d.ya=s(et,_r),d.aa=0,d.D.ya=d.ya,d.D.aa=d.aa,d.Aa==2&&(d.D.aa+=Ae),d.R=16*Ae,d.B=8*Ae,Ae=(ke=_d[d.L])*d.R,ke=ke/2*d.B,d.sa=be,d.ta=xe+Ae,d.qa=d.sa,d.ra=d.ta+16*N*d.R+ke,d.Ha=d.qa,d.Ia=d.ra+8*N*d.B+ke,d.$c=0,xe+=ye,d.mb=ve?be:null,d.nb=ve?xe:null,e(xe+ve<=d.Fc+d.Vb),mr(d),i(d.Ac,d.Bc,0,ne),N=1}}if(N){if(v.ka=0,v.y=d.sa,v.O=d.ta,v.f=d.qa,v.N=d.ra,v.ea=d.Ha,v.Vd=d.Ia,v.fa=d.R,v.Rc=d.B,v.F=null,v.J=0,!dd){for(N=-255;255>=N;++N)Vn[255+N]=0>N?-N:N;for(N=-1020;1020>=N;++N)fs[1020+N]=-128>N?-128:127<N?127:N;for(N=-112;112>=N;++N)Hc[112+N]=-16>N?-16:15<N?15:N;for(N=-255;510>=N;++N)Yl[255+N]=0>N?0:255<N?255:N;dd=1}Hl=zi,ps=Hn,qc=Pi,Ai=Hr,io=qi,xn=Bn,Gl=qs,ud=vo,zc=Us,Ja=Ya,Qa=zs,Xs=ls,Xa=Hs,Wl=Oo,Za=as,Zs=Wi,Uc=jn,oo=Ol,So[0]=ro,So[1]=ja,So[2]=Mo,So[3]=Fc,So[4]=Ml,So[5]=Os,So[6]=Hi,So[7]=qa,So[8]=js,So[9]=Bs,ea[0]=Do,ea[1]=ss,ea[2]=wi,ea[3]=Ms,ea[4]=fn,ea[5]=Dl,ea[6]=Va,ms[0]=go,ms[1]=Ds,ms[2]=Fl,ms[3]=yo,ms[4]=Xr,ms[5]=za,ms[6]=Ua,N=1}else N=0}N&&(N=function(Ye,yt){for(Ye.M=0;Ye.M<Ye.Va;++Ye.M){var it,Oe=Ye.Jc[Ye.M&Ye.Xb],je=Ye.m,ft=Ye;for(it=0;it<ft.za;++it){var Pt=je,mt=ft,Yt=mt.Ac,Vt=mt.Bc+4*it,dr=mt.zc,zt=mt.ya[mt.aa+it];if(mt.Qa.Bb?zt.$b=Q(Pt,mt.Pa.jb[0])?2+Q(Pt,mt.Pa.jb[2]):Q(Pt,mt.Pa.jb[1]):zt.$b=0,mt.kc&&(zt.Ad=Q(Pt,mt.Bd)),zt.Za=!Q(Pt,145)+0,zt.Za){var Kr=zt.Ob,tn=0;for(mt=0;4>mt;++mt){var Gr,Mr=dr[0+mt];for(Gr=0;4>Gr;++Gr){Mr=R_[Yt[Vt+Gr]][Mr];for(var ln=rg[Q(Pt,Mr[0])];0<ln;)ln=rg[2*ln+Q(Pt,Mr[ln])];Mr=-ln,Yt[Vt+Gr]=Mr}n(Kr,tn,Yt,Vt,4),tn+=4,dr[0+mt]=Mr}}else Mr=Q(Pt,156)?Q(Pt,128)?1:3:Q(Pt,163)?2:0,zt.Ob[0]=Mr,i(Yt,Vt,Mr,4),i(dr,0,Mr,4);zt.Dd=Q(Pt,142)?Q(Pt,114)?Q(Pt,183)?1:3:2:0}if(ft.m.Ka)return Et(Ye,7,"Premature end-of-partition0 encountered.");for(;Ye.ja<Ye.za;++Ye.ja){if(ft=Oe,Pt=(je=Ye).rb[je.sb-1],Yt=je.rb[je.sb+je.ja],it=je.ya[je.aa+je.ja],Vt=je.kc?it.Ad:0)Pt.la=Yt.la=0,it.Za||(Pt.Na=Yt.Na=0),it.Hc=0,it.Gc=0,it.ia=0;else{var sn,Tr;if(Pt=Yt,Yt=ft,Vt=je.Pa.Xc,dr=je.ya[je.aa+je.ja],zt=je.pb[dr.$b],mt=dr.ad,Kr=0,tn=je.rb[je.sb-1],Mr=Gr=0,i(mt,Kr,0,384),dr.Za)var kn=0,Ni=Vt[3];else{ln=o(16);var Nn=Pt.Na+tn.Na;if(Nn=Gc(Yt,Vt[1],Nn,zt.Eb,0,ln,0),Pt.Na=tn.Na=(0<Nn)+0,1<Nn)Hl(ln,0,mt,Kr);else{var Li=ln[0]+3>>3;for(ln=0;256>ln;ln+=16)mt[Kr+ln]=Li}kn=1,Ni=Vt[0]}var rn=15&Pt.la,Ki=15&tn.la;for(ln=0;4>ln;++ln){var Ji=1&Ki;for(Li=Tr=0;4>Li;++Li)rn=rn>>1|(Ji=(Nn=Gc(Yt,Ni,Nn=Ji+(1&rn),zt.Sc,kn,mt,Kr))>kn)<<7,Tr=Tr<<2|(3<Nn?3:1<Nn?2:mt[Kr+0]!=0),Kr+=16;rn>>=4,Ki=Ki>>1|Ji<<7,Gr=(Gr<<8|Tr)>>>0}for(Ni=rn,kn=Ki>>4,sn=0;4>sn;sn+=2){for(Tr=0,rn=Pt.la>>4+sn,Ki=tn.la>>4+sn,ln=0;2>ln;++ln){for(Ji=1&Ki,Li=0;2>Li;++Li)Nn=Ji+(1&rn),rn=rn>>1|(Ji=0<(Nn=Gc(Yt,Vt[2],Nn,zt.Qc,0,mt,Kr)))<<3,Tr=Tr<<2|(3<Nn?3:1<Nn?2:mt[Kr+0]!=0),Kr+=16;rn>>=2,Ki=Ki>>1|Ji<<5}Mr|=Tr<<4*sn,Ni|=rn<<4<<sn,kn|=(240&Ki)<<sn}Pt.la=Ni,tn.la=kn,dr.Hc=Gr,dr.Gc=Mr,dr.ia=43690&Mr?0:zt.ia,Vt=!(Gr|Mr)}if(0<je.L&&(je.wa[je.Y+je.ja]=je.gd[it.$b][it.Za],je.wa[je.Y+je.ja].La|=!Vt),ft.Ka)return Et(Ye,7,"Premature end-of-file encountered.")}if(mr(Ye),je=yt,ft=1,it=(Oe=Ye).D,Pt=0<Oe.L&&Oe.M>=Oe.zb&&Oe.M<=Oe.Va,Oe.Aa==0)e:{if(it.M=Oe.M,it.uc=Pt,jo(Oe,it),ft=1,it=(Tr=Oe.D).Nb,Pt=(Mr=_d[Oe.L])*Oe.R,Yt=Mr/2*Oe.B,ln=16*it*Oe.R,Li=8*it*Oe.B,Vt=Oe.sa,dr=Oe.ta-Pt+ln,zt=Oe.qa,mt=Oe.ra-Yt+Li,Kr=Oe.Ha,tn=Oe.Ia-Yt+Li,Ki=(rn=Tr.M)==0,Gr=rn>=Oe.Va-1,Oe.Aa==2&&jo(Oe,Tr),Tr.uc)for(Ji=(Nn=Oe).D.M,e(Nn.D.uc),Tr=Nn.yb;Tr<Nn.Hb;++Tr){kn=Tr,Ni=Ji;var Gn=(Xn=(_n=Nn).D).Nb;sn=_n.R;var Xn=Xn.wa[Xn.Y+kn],Ci=_n.sa,co=_n.ta+16*Gn*sn+16*kn,qo=Xn.dd,Wn=Xn.tc;if(Wn!=0)if(e(3<=Wn),_n.L==1)0<kn&&Zs(Ci,co,sn,Wn+4),Xn.La&&oo(Ci,co,sn,Wn),0<Ni&&Za(Ci,co,sn,Wn+4),Xn.La&&Uc(Ci,co,sn,Wn);else{var ys=_n.B,el=_n.qa,Kl=_n.ra+8*Gn*ys+8*kn,ra=_n.Ha,_n=_n.Ia+8*Gn*ys+8*kn;Gn=Xn.ld,0<kn&&(ud(Ci,co,sn,Wn+4,qo,Gn),Ja(el,Kl,ra,_n,ys,Wn+4,qo,Gn)),Xn.La&&(Xs(Ci,co,sn,Wn,qo,Gn),Wl(el,Kl,ra,_n,ys,Wn,qo,Gn)),0<Ni&&(Gl(Ci,co,sn,Wn+4,qo,Gn),zc(el,Kl,ra,_n,ys,Wn+4,qo,Gn)),Xn.La&&(Qa(Ci,co,sn,Wn,qo,Gn),Xa(el,Kl,ra,_n,ys,Wn,qo,Gn))}}if(Oe.ia&&alert("todo:DitherRow"),je.put!=null){if(Tr=16*rn,rn=16*(rn+1),Ki?(je.y=Oe.sa,je.O=Oe.ta+ln,je.f=Oe.qa,je.N=Oe.ra+Li,je.ea=Oe.Ha,je.W=Oe.Ia+Li):(Tr-=Mr,je.y=Vt,je.O=dr,je.f=zt,je.N=mt,je.ea=Kr,je.W=tn),Gr||(rn-=Mr),rn>je.o&&(rn=je.o),je.F=null,je.J=null,Oe.Fa!=null&&0<Oe.Fa.length&&Tr<rn&&(je.J=Ks(Oe,je,Tr,rn-Tr),je.F=Oe.mb,je.F==null&&je.F.length==0)){ft=Et(Oe,3,"Could not decode alpha data.");break e}Tr<je.j&&(Mr=je.j-Tr,Tr=je.j,e(!(1&Mr)),je.O+=Oe.R*Mr,je.N+=Oe.B*(Mr>>1),je.W+=Oe.B*(Mr>>1),je.F!=null&&(je.J+=je.width*Mr)),Tr<rn&&(je.O+=je.v,je.N+=je.v>>1,je.W+=je.v>>1,je.F!=null&&(je.J+=je.v),je.ka=Tr-je.j,je.U=je.va-je.v,je.T=rn-Tr,ft=je.put(je))}it+1!=Oe.Ic||Gr||(n(Oe.sa,Oe.ta-Pt,Vt,dr+16*Oe.R,Pt),n(Oe.qa,Oe.ra-Yt,zt,mt+8*Oe.B,Yt),n(Oe.Ha,Oe.Ia-Yt,Kr,tn+8*Oe.B,Yt))}if(!ft)return Et(Ye,6,"Output aborted.")}return 1}(d,v)),v.bc!=null&&v.bc(v),N&=1}return N?(d.cb=0,N):0}function Vr(d,v,N,ne,ye){ye=d[v+N+32*ne]+(ye>>3),d[v+N+32*ne]=-256&ye?0>ye?0:255:ye}function gn(d,v,N,ne,ye,ve){Vr(d,v,0,N,ne+ye),Vr(d,v,1,N,ne+ve),Vr(d,v,2,N,ne-ve),Vr(d,v,3,N,ne-ye)}function qr(d){return(20091*d>>16)+d}function Rr(d,v,N,ne){var ye,ve=0,be=o(16);for(ye=0;4>ye;++ye){var xe=d[v+0]+d[v+8],Ae=d[v+0]-d[v+8],ke=(35468*d[v+4]>>16)-qr(d[v+12]),Fe=qr(d[v+4])+(35468*d[v+12]>>16);be[ve+0]=xe+Fe,be[ve+1]=Ae+ke,be[ve+2]=Ae-ke,be[ve+3]=xe-Fe,ve+=4,v++}for(ye=ve=0;4>ye;++ye)xe=(d=be[ve+0]+4)+be[ve+8],Ae=d-be[ve+8],ke=(35468*be[ve+4]>>16)-qr(be[ve+12]),Vr(N,ne,0,0,xe+(Fe=qr(be[ve+4])+(35468*be[ve+12]>>16))),Vr(N,ne,1,0,Ae+ke),Vr(N,ne,2,0,Ae-ke),Vr(N,ne,3,0,xe-Fe),ve++,ne+=32}function Bn(d,v,N,ne){var ye=d[v+0]+4,ve=35468*d[v+4]>>16,be=qr(d[v+4]),xe=35468*d[v+1]>>16;gn(N,ne,0,ye+be,d=qr(d[v+1]),xe),gn(N,ne,1,ye+ve,d,xe),gn(N,ne,2,ye-ve,d,xe),gn(N,ne,3,ye-be,d,xe)}function Hn(d,v,N,ne,ye){Rr(d,v,N,ne),ye&&Rr(d,v+16,N,ne+4)}function Pi(d,v,N,ne){ps(d,v+0,N,ne,1),ps(d,v+32,N,ne+128,1)}function Hr(d,v,N,ne){var ye;for(d=d[v+0]+4,ye=0;4>ye;++ye)for(v=0;4>v;++v)Vr(N,ne,v,ye,d)}function qi(d,v,N,ne){d[v+0]&&Ai(d,v+0,N,ne),d[v+16]&&Ai(d,v+16,N,ne+4),d[v+32]&&Ai(d,v+32,N,ne+128),d[v+48]&&Ai(d,v+48,N,ne+128+4)}function zi(d,v,N,ne){var ye,ve=o(16);for(ye=0;4>ye;++ye){var be=d[v+0+ye]+d[v+12+ye],xe=d[v+4+ye]+d[v+8+ye],Ae=d[v+4+ye]-d[v+8+ye],ke=d[v+0+ye]-d[v+12+ye];ve[0+ye]=be+xe,ve[8+ye]=be-xe,ve[4+ye]=ke+Ae,ve[12+ye]=ke-Ae}for(ye=0;4>ye;++ye)be=(d=ve[0+4*ye]+3)+ve[3+4*ye],xe=ve[1+4*ye]+ve[2+4*ye],Ae=ve[1+4*ye]-ve[2+4*ye],ke=d-ve[3+4*ye],N[ne+0]=be+xe>>3,N[ne+16]=ke+Ae>>3,N[ne+32]=be-xe>>3,N[ne+48]=ke-Ae>>3,ne+=64}function Ui(d,v,N){var ne,ye=v-32,ve=Yi,be=255-d[ye-1];for(ne=0;ne<N;++ne){var xe,Ae=ve,ke=be+d[v-1];for(xe=0;xe<N;++xe)d[v+xe]=Ae[ke+d[ye+xe]];v+=32}}function ja(d,v){Ui(d,v,4)}function Ds(d,v){Ui(d,v,8)}function ss(d,v){Ui(d,v,16)}function wi(d,v){var N;for(N=0;16>N;++N)n(d,v+32*N,d,v-32,16)}function Ms(d,v){var N;for(N=16;0<N;--N)i(d,v,d[v-1],16),v+=32}function Fs(d,v,N){var ne;for(ne=0;16>ne;++ne)i(v,N+32*ne,d,16)}function Do(d,v){var N,ne=16;for(N=0;16>N;++N)ne+=d[v-1+32*N]+d[v+N-32];Fs(ne>>5,d,v)}function fn(d,v){var N,ne=8;for(N=0;16>N;++N)ne+=d[v-1+32*N];Fs(ne>>4,d,v)}function Dl(d,v){var N,ne=8;for(N=0;16>N;++N)ne+=d[v+N-32];Fs(ne>>4,d,v)}function Va(d,v){Fs(128,d,v)}function Sr(d,v,N){return d+2*v+N+2>>2}function Mo(d,v){var N,ne=v-32;for(ne=new Uint8Array([Sr(d[ne-1],d[ne+0],d[ne+1]),Sr(d[ne+0],d[ne+1],d[ne+2]),Sr(d[ne+1],d[ne+2],d[ne+3]),Sr(d[ne+2],d[ne+3],d[ne+4])]),N=0;4>N;++N)n(d,v+32*N,ne,0,ne.length)}function Fc(d,v){var N=d[v-1],ne=d[v-1+32],ye=d[v-1+64],ve=d[v-1+96];se(d,v+0,16843009*Sr(d[v-1-32],N,ne)),se(d,v+32,16843009*Sr(N,ne,ye)),se(d,v+64,16843009*Sr(ne,ye,ve)),se(d,v+96,16843009*Sr(ye,ve,ve))}function ro(d,v){var N,ne=4;for(N=0;4>N;++N)ne+=d[v+N-32]+d[v-1+32*N];for(ne>>=3,N=0;4>N;++N)i(d,v+32*N,ne,4)}function Ml(d,v){var N=d[v-1+0],ne=d[v-1+32],ye=d[v-1+64],ve=d[v-1-32],be=d[v+0-32],xe=d[v+1-32],Ae=d[v+2-32],ke=d[v+3-32];d[v+0+96]=Sr(ne,ye,d[v-1+96]),d[v+1+96]=d[v+0+64]=Sr(N,ne,ye),d[v+2+96]=d[v+1+64]=d[v+0+32]=Sr(ve,N,ne),d[v+3+96]=d[v+2+64]=d[v+1+32]=d[v+0+0]=Sr(be,ve,N),d[v+3+64]=d[v+2+32]=d[v+1+0]=Sr(xe,be,ve),d[v+3+32]=d[v+2+0]=Sr(Ae,xe,be),d[v+3+0]=Sr(ke,Ae,xe)}function Hi(d,v){var N=d[v+1-32],ne=d[v+2-32],ye=d[v+3-32],ve=d[v+4-32],be=d[v+5-32],xe=d[v+6-32],Ae=d[v+7-32];d[v+0+0]=Sr(d[v+0-32],N,ne),d[v+1+0]=d[v+0+32]=Sr(N,ne,ye),d[v+2+0]=d[v+1+32]=d[v+0+64]=Sr(ne,ye,ve),d[v+3+0]=d[v+2+32]=d[v+1+64]=d[v+0+96]=Sr(ye,ve,be),d[v+3+32]=d[v+2+64]=d[v+1+96]=Sr(ve,be,xe),d[v+3+64]=d[v+2+96]=Sr(be,xe,Ae),d[v+3+96]=Sr(xe,Ae,Ae)}function Os(d,v){var N=d[v-1+0],ne=d[v-1+32],ye=d[v-1+64],ve=d[v-1-32],be=d[v+0-32],xe=d[v+1-32],Ae=d[v+2-32],ke=d[v+3-32];d[v+0+0]=d[v+1+64]=ve+be+1>>1,d[v+1+0]=d[v+2+64]=be+xe+1>>1,d[v+2+0]=d[v+3+64]=xe+Ae+1>>1,d[v+3+0]=Ae+ke+1>>1,d[v+0+96]=Sr(ye,ne,N),d[v+0+64]=Sr(ne,N,ve),d[v+0+32]=d[v+1+96]=Sr(N,ve,be),d[v+1+32]=d[v+2+96]=Sr(ve,be,xe),d[v+2+32]=d[v+3+96]=Sr(be,xe,Ae),d[v+3+32]=Sr(xe,Ae,ke)}function qa(d,v){var N=d[v+0-32],ne=d[v+1-32],ye=d[v+2-32],ve=d[v+3-32],be=d[v+4-32],xe=d[v+5-32],Ae=d[v+6-32],ke=d[v+7-32];d[v+0+0]=N+ne+1>>1,d[v+1+0]=d[v+0+64]=ne+ye+1>>1,d[v+2+0]=d[v+1+64]=ye+ve+1>>1,d[v+3+0]=d[v+2+64]=ve+be+1>>1,d[v+0+32]=Sr(N,ne,ye),d[v+1+32]=d[v+0+96]=Sr(ne,ye,ve),d[v+2+32]=d[v+1+96]=Sr(ye,ve,be),d[v+3+32]=d[v+2+96]=Sr(ve,be,xe),d[v+3+64]=Sr(be,xe,Ae),d[v+3+96]=Sr(xe,Ae,ke)}function Bs(d,v){var N=d[v-1+0],ne=d[v-1+32],ye=d[v-1+64],ve=d[v-1+96];d[v+0+0]=N+ne+1>>1,d[v+2+0]=d[v+0+32]=ne+ye+1>>1,d[v+2+32]=d[v+0+64]=ye+ve+1>>1,d[v+1+0]=Sr(N,ne,ye),d[v+3+0]=d[v+1+32]=Sr(ne,ye,ve),d[v+3+32]=d[v+1+64]=Sr(ye,ve,ve),d[v+3+64]=d[v+2+64]=d[v+0+96]=d[v+1+96]=d[v+2+96]=d[v+3+96]=ve}function js(d,v){var N=d[v-1+0],ne=d[v-1+32],ye=d[v-1+64],ve=d[v-1+96],be=d[v-1-32],xe=d[v+0-32],Ae=d[v+1-32],ke=d[v+2-32];d[v+0+0]=d[v+2+32]=N+be+1>>1,d[v+0+32]=d[v+2+64]=ne+N+1>>1,d[v+0+64]=d[v+2+96]=ye+ne+1>>1,d[v+0+96]=ve+ye+1>>1,d[v+3+0]=Sr(xe,Ae,ke),d[v+2+0]=Sr(be,xe,Ae),d[v+1+0]=d[v+3+32]=Sr(N,be,xe),d[v+1+32]=d[v+3+64]=Sr(ne,N,be),d[v+1+64]=d[v+3+96]=Sr(ye,ne,N),d[v+1+96]=Sr(ve,ye,ne)}function Fl(d,v){var N;for(N=0;8>N;++N)n(d,v+32*N,d,v-32,8)}function yo(d,v){var N;for(N=0;8>N;++N)i(d,v,d[v-1],8),v+=32}function Gi(d,v,N){var ne;for(ne=0;8>ne;++ne)i(v,N+32*ne,d,8)}function go(d,v){var N,ne=8;for(N=0;8>N;++N)ne+=d[v+N-32]+d[v-1+32*N];Gi(ne>>4,d,v)}function za(d,v){var N,ne=4;for(N=0;8>N;++N)ne+=d[v+N-32];Gi(ne>>3,d,v)}function Xr(d,v){var N,ne=4;for(N=0;8>N;++N)ne+=d[v-1+32*N];Gi(ne>>3,d,v)}function Ua(d,v){Gi(128,d,v)}function Vs(d,v,N){var ne=d[v-N],ye=d[v+0],ve=3*(ye-ne)+wp[1020+d[v-2*N]-d[v+N]],be=hd[112+(ve+4>>3)];d[v-N]=Yi[255+ne+hd[112+(ve+3>>3)]],d[v+0]=Yi[255+ye-be]}function Ha(d,v,N,ne){var ye=d[v+0],ve=d[v+N];return ao[255+d[v-2*N]-d[v-N]]>ne||ao[255+ve-ye]>ne}function Ga(d,v,N,ne){return 4*ao[255+d[v-N]-d[v+0]]+ao[255+d[v-2*N]-d[v+N]]<=ne}function Wa(d,v,N,ne,ye){var ve=d[v-3*N],be=d[v-2*N],xe=d[v-N],Ae=d[v+0],ke=d[v+N],Fe=d[v+2*N],Ze=d[v+3*N];return 4*ao[255+xe-Ae]+ao[255+be-ke]>ne?0:ao[255+d[v-4*N]-ve]<=ye&&ao[255+ve-be]<=ye&&ao[255+be-xe]<=ye&&ao[255+Ze-Fe]<=ye&&ao[255+Fe-ke]<=ye&&ao[255+ke-Ae]<=ye}function as(d,v,N,ne){var ye=2*ne+1;for(ne=0;16>ne;++ne)Ga(d,v+ne,N,ye)&&Vs(d,v+ne,N)}function Wi(d,v,N,ne){var ye=2*ne+1;for(ne=0;16>ne;++ne)Ga(d,v+ne*N,1,ye)&&Vs(d,v+ne*N,1)}function jn(d,v,N,ne){var ye;for(ye=3;0<ye;--ye)as(d,v+=4*N,N,ne)}function Ol(d,v,N,ne){var ye;for(ye=3;0<ye;--ye)Wi(d,v+=4,N,ne)}function Fo(d,v,N,ne,ye,ve,be,xe){for(ve=2*ve+1;0<ye--;){if(Wa(d,v,N,ve,be))if(Ha(d,v,N,xe))Vs(d,v,N);else{var Ae=d,ke=v,Fe=N,Ze=Ae[ke-2*Fe],et=Ae[ke-Fe],Ye=Ae[ke+0],yt=Ae[ke+Fe],it=Ae[ke+2*Fe],Oe=27*(ft=wp[1020+3*(Ye-et)+wp[1020+Ze-yt]])+63>>7,je=18*ft+63>>7,ft=9*ft+63>>7;Ae[ke-3*Fe]=Yi[255+Ae[ke-3*Fe]+ft],Ae[ke-2*Fe]=Yi[255+Ze+je],Ae[ke-Fe]=Yi[255+et+Oe],Ae[ke+0]=Yi[255+Ye-Oe],Ae[ke+Fe]=Yi[255+yt-je],Ae[ke+2*Fe]=Yi[255+it-ft]}v+=ne}}function Kn(d,v,N,ne,ye,ve,be,xe){for(ve=2*ve+1;0<ye--;){if(Wa(d,v,N,ve,be))if(Ha(d,v,N,xe))Vs(d,v,N);else{var Ae=d,ke=v,Fe=N,Ze=Ae[ke-Fe],et=Ae[ke+0],Ye=Ae[ke+Fe],yt=hd[112+((it=3*(et-Ze))+4>>3)],it=hd[112+(it+3>>3)],Oe=yt+1>>1;Ae[ke-2*Fe]=Yi[255+Ae[ke-2*Fe]+Oe],Ae[ke-Fe]=Yi[255+Ze+it],Ae[ke+0]=Yi[255+et-yt],Ae[ke+Fe]=Yi[255+Ye-Oe]}v+=ne}}function qs(d,v,N,ne,ye,ve){Fo(d,v,N,1,16,ne,ye,ve)}function vo(d,v,N,ne,ye,ve){Fo(d,v,1,N,16,ne,ye,ve)}function zs(d,v,N,ne,ye,ve){var be;for(be=3;0<be;--be)Kn(d,v+=4*N,N,1,16,ne,ye,ve)}function ls(d,v,N,ne,ye,ve){var be;for(be=3;0<be;--be)Kn(d,v+=4,1,N,16,ne,ye,ve)}function Us(d,v,N,ne,ye,ve,be,xe){Fo(d,v,ye,1,8,ve,be,xe),Fo(N,ne,ye,1,8,ve,be,xe)}function Ya(d,v,N,ne,ye,ve,be,xe){Fo(d,v,1,ye,8,ve,be,xe),Fo(N,ne,1,ye,8,ve,be,xe)}function Hs(d,v,N,ne,ye,ve,be,xe){Kn(d,v+4*ye,ye,1,8,ve,be,xe),Kn(N,ne+4*ye,ye,1,8,ve,be,xe)}function Oo(d,v,N,ne,ye,ve,be,xe){Kn(d,v+4,1,ye,8,ve,be,xe),Kn(N,ne+4,1,ye,8,ve,be,xe)}function cs(){this.ba=new qe,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Rt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Gs(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function us(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Ws(){this.ua=0,this.Wa=new Y,this.vb=new Y,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new z,this.yc=new P}function Bl(){this.xb=this.a=0,this.l=new Ur,this.ca=new qe,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new L,this.Pb=0,this.wd=new L,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Ws,this.ab=0,this.gc=s(4,us),this.Oc=0}function bo(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Ur,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Bo(d,v,N,ne,ye,ve,be){for(d=d==null?0:d[v+0],v=0;v<be;++v)ye[ve+v]=d+N[ne+v]&255,d=ye[ve+v]}function Ys(d,v,N,ne,ye,ve,be){var xe;if(d==null)Bo(null,null,N,ne,ye,ve,be);else for(xe=0;xe<be;++xe)ye[ve+xe]=d[v+xe]+N[ne+xe]&255}function ii(d,v,N,ne,ye,ve,be){if(d==null)Bo(null,null,N,ne,ye,ve,be);else{var xe,Ae=d[v+0],ke=Ae,Fe=Ae;for(xe=0;xe<be;++xe)ke=Fe+(Ae=d[v+xe])-ke,Fe=N[ne+xe]+(-256&ke?0>ke?0:255:ke)&255,ke=Ae,ye[ve+xe]=Fe}}function Ks(d,v,N,ne){var ye=v.width,ve=v.o;if(e(d!=null&&v!=null),0>N||0>=ne||N+ne>ve)return null;if(!d.Cc){if(d.ga==null){var be;if(d.ga=new bo,(be=d.ga==null)||(be=v.width*v.o,e(d.Gb.length==0),d.Gb=o(be),d.Uc=0,d.Gb==null?be=0:(d.mb=d.Gb,d.nb=d.Uc,d.rc=null,be=1),be=!be),!be){be=d.ga;var xe=d.Fa,Ae=d.P,ke=d.qc,Fe=d.mb,Ze=d.nb,et=Ae+1,Ye=ke-1,yt=be.l;if(e(xe!=null&&Fe!=null&&v!=null),ta[0]=null,ta[1]=Bo,ta[2]=Ys,ta[3]=ii,be.ca=Fe,be.tb=Ze,be.c=v.width,be.i=v.height,e(0<be.c&&0<be.i),1>=ke)v=0;else if(be.$a=xe[Ae+0]>>0&3,be.Z=xe[Ae+0]>>2&3,be.Lc=xe[Ae+0]>>4&3,Ae=xe[Ae+0]>>6&3,0>be.$a||1<be.$a||4<=be.Z||1<be.Lc||Ae)v=0;else if(yt.put=cr,yt.ac=Qt,yt.bc=xr,yt.ma=be,yt.width=v.width,yt.height=v.height,yt.Da=v.Da,yt.v=v.v,yt.va=v.va,yt.j=v.j,yt.o=v.o,be.$a)e:{e(be.$a==1),v=Kt();t:for(;;){if(v==null){v=0;break e}if(e(be!=null),be.mc=v,v.c=be.c,v.i=be.i,v.l=be.l,v.l.ma=be,v.l.width=be.c,v.l.height=be.i,v.a=0,X(v.m,xe,et,Ye),!rr(be.c,be.i,1,v,null)||(v.ab==1&&v.gc[0].hc==3&&Wt(v.s)?(be.ic=1,xe=v.c*v.i,v.Ta=null,v.Ua=0,v.V=o(xe),v.Ba=0,v.V==null?(v.a=1,v=0):v=1):(be.ic=0,v=yr(v,be.c)),!v))break t;v=1;break e}be.mc=null,v=0}else v=Ye>=be.c*be.i;be=!v}if(be)return null;d.ga.Lc!=1?d.Ga=0:ne=ve-N}e(d.ga!=null),e(N+ne<=ve);e:{if(v=(xe=d.ga).c,ve=xe.l.o,xe.$a==0){if(et=d.rc,Ye=d.Vc,yt=d.Fa,Ae=d.P+1+N*v,ke=d.mb,Fe=d.nb+N*v,e(Ae<=d.P+d.qc),xe.Z!=0)for(e(ta[xe.Z]!=null),be=0;be<ne;++be)ta[xe.Z](et,Ye,yt,Ae,ke,Fe,v),et=ke,Ye=Fe,Fe+=v,Ae+=v;else for(be=0;be<ne;++be)n(ke,Fe,yt,Ae,v),et=ke,Ye=Fe,Fe+=v,Ae+=v;d.rc=et,d.Vc=Ye}else{if(e(xe.mc!=null),v=N+ne,e((be=xe.mc)!=null),e(v<=be.i),be.C>=v)v=1;else if(xe.ic||He(),xe.ic){xe=be.V,et=be.Ba,Ye=be.c;var it=be.i,Oe=(yt=1,Ae=be.$/Ye,ke=be.$%Ye,Fe=be.m,Ze=be.s,be.$),je=Ye*it,ft=Ye*v,Pt=Ze.wc,mt=Oe<ft?Ue(Ze,ke,Ae):null;e(Oe<=je),e(v<=it),e(Wt(Ze));t:for(;;){for(;!Fe.h&&Oe<ft;){if(ke&Pt||(mt=Ue(Ze,ke,Ae)),e(mt!=null),M(Fe),256>(it=At(mt.G[0],mt.H[0],Fe)))xe[et+Oe]=it,++Oe,++ke>=Ye&&(ke=0,++Ae<=v&&!(Ae%16)&&vt(be,Ae));else{if(!(280>it)){yt=0;break t}it=Ge(it-256,Fe);var Yt,Vt=At(mt.G[4],mt.H[4],Fe);if(M(Fe),!(Oe>=(Vt=Nt(Ye,Vt=Ge(Vt,Fe)))&&je-Oe>=it)){yt=0;break t}for(Yt=0;Yt<it;++Yt)xe[et+Oe+Yt]=xe[et+Oe+Yt-Vt];for(Oe+=it,ke+=it;ke>=Ye;)ke-=Ye,++Ae<=v&&!(Ae%16)&&vt(be,Ae);Oe<ft&&ke&Pt&&(mt=Ue(Ze,ke,Ae))}e(Fe.h==j(Fe))}vt(be,Ae>v?v:Ae);break t}!yt||Fe.h&&Oe<je?(yt=0,be.a=Fe.h?5:3):be.$=Oe,v=yt}else v=Tt(be,be.V,be.Ba,be.c,be.i,v,nr);if(!v){ne=0;break e}}N+ne>=ve&&(d.Cc=1),ne=1}if(!ne)return null;if(d.Cc&&((ne=d.ga)!=null&&(ne.mc=null),d.ga=null,0<d.Ga))return alert("todo:WebPDequantizeLevels"),null}return d.nb+N*ye}function A(d,v,N,ne,ye,ve){for(;0<ye--;){var be,xe=d,Ae=v+(N?1:0),ke=d,Fe=v+(N?0:3);for(be=0;be<ne;++be){var Ze=ke[Fe+4*be];Ze!=255&&(Ze*=32897,xe[Ae+4*be+0]=xe[Ae+4*be+0]*Ze>>23,xe[Ae+4*be+1]=xe[Ae+4*be+1]*Ze>>23,xe[Ae+4*be+2]=xe[Ae+4*be+2]*Ze>>23)}v+=ve}}function me(d,v,N,ne,ye){for(;0<ne--;){var ve;for(ve=0;ve<N;++ve){var be=d[v+2*ve+0],xe=15&(ke=d[v+2*ve+1]),Ae=4369*xe,ke=(240&ke|ke>>4)*Ae>>16;d[v+2*ve+0]=(240&be|be>>4)*Ae>>16&240|(15&be|be<<4)*Ae>>16>>4&15,d[v+2*ve+1]=240&ke|xe}v+=ye}}function Ne(d,v,N,ne,ye,ve,be,xe){var Ae,ke,Fe=255;for(ke=0;ke<ye;++ke){for(Ae=0;Ae<ne;++Ae){var Ze=d[v+Ae];ve[be+4*Ae]=Ze,Fe&=Ze}v+=N,be+=xe}return Fe!=255}function Me(d,v,N,ne,ye){var ve;for(ve=0;ve<ye;++ve)N[ne+ve]=d[v+ve]>>8}function He(){so=A,dn=me,hn=Ne,An=Me}function st(d,v,N){C[d]=function(ne,ye,ve,be,xe,Ae,ke,Fe,Ze,et,Ye,yt,it,Oe,je,ft,Pt){var mt,Yt=Pt-1>>1,Vt=xe[Ae+0]|ke[Fe+0]<<16,dr=Ze[et+0]|Ye[yt+0]<<16;e(ne!=null);var zt=3*Vt+dr+131074>>2;for(v(ne[ye+0],255&zt,zt>>16,it,Oe),ve!=null&&(zt=3*dr+Vt+131074>>2,v(ve[be+0],255&zt,zt>>16,je,ft)),mt=1;mt<=Yt;++mt){var Kr=xe[Ae+mt]|ke[Fe+mt]<<16,tn=Ze[et+mt]|Ye[yt+mt]<<16,Gr=Vt+Kr+dr+tn+524296,Mr=Gr+2*(Kr+dr)>>3;zt=Mr+Vt>>1,Vt=(Gr=Gr+2*(Vt+tn)>>3)+Kr>>1,v(ne[ye+2*mt-1],255&zt,zt>>16,it,Oe+(2*mt-1)*N),v(ne[ye+2*mt-0],255&Vt,Vt>>16,it,Oe+(2*mt-0)*N),ve!=null&&(zt=Gr+dr>>1,Vt=Mr+tn>>1,v(ve[be+2*mt-1],255&zt,zt>>16,je,ft+(2*mt-1)*N),v(ve[be+2*mt+0],255&Vt,Vt>>16,je,ft+(2*mt+0)*N)),Vt=Kr,dr=tn}1&Pt||(zt=3*Vt+dr+131074>>2,v(ne[ye+Pt-1],255&zt,zt>>16,it,Oe+(Pt-1)*N),ve!=null&&(zt=3*dr+Vt+131074>>2,v(ve[be+Pt-1],255&zt,zt>>16,je,ft+(Pt-1)*N)))}}function xt(){lo[pd]=O_,lo[fd]=ig,lo[Zy]=B_,lo[md]=og,lo[yd]=sg,lo[xp]=ag,lo[eg]=j_,lo[Ap]=ig,lo[Cp]=og,lo[gd]=sg,lo[Ip]=ag}function qt(d){return d&-16384?0>d?0:255:d>>V_}function p(d,v){return qt((19077*d>>8)+(26149*v>>8)-14234)}function V(d,v,N){return qt((19077*d>>8)-(6419*v>>8)-(13320*N>>8)+8708)}function le(d,v){return qt((19077*d>>8)+(33050*v>>8)-17685)}function we(d,v,N,ne,ye){ne[ye+0]=p(d,N),ne[ye+1]=V(d,v,N),ne[ye+2]=le(d,v)}function Ve(d,v,N,ne,ye){ne[ye+0]=le(d,v),ne[ye+1]=V(d,v,N),ne[ye+2]=p(d,N)}function tt(d,v,N,ne,ye){var ve=V(d,v,N);v=ve<<3&224|le(d,v)>>3,ne[ye+0]=248&p(d,N)|ve>>5,ne[ye+1]=v}function Ct(d,v,N,ne,ye){var ve=240&le(d,v)|15;ne[ye+0]=240&p(d,N)|V(d,v,N)>>4,ne[ye+1]=ve}function Ar(d,v,N,ne,ye){ne[ye+0]=255,we(d,v,N,ne,ye+1)}function Dr(d,v,N,ne,ye){Ve(d,v,N,ne,ye),ne[ye+3]=255}function Cr(d,v,N,ne,ye){we(d,v,N,ne,ye),ne[ye+3]=255}function Zr(d,v){return 0>d?0:d>v?v:d}function an(d,v,N){C[d]=function(ne,ye,ve,be,xe,Ae,ke,Fe,Ze){for(var et=Fe+(-2&Ze)*N;Fe!=et;)v(ne[ye+0],ve[be+0],xe[Ae+0],ke,Fe),v(ne[ye+1],ve[be+0],xe[Ae+0],ke,Fe+N),ye+=2,++be,++Ae,Fe+=2*N;1&Ze&&v(ne[ye+0],ve[be+0],xe[Ae+0],ke,Fe)}}function _o(d,v,N){return N==0?d==0?v==0?6:5:v==0?4:0:N}function Jn(d,v,N,ne,ye){switch(d>>>30){case 3:ps(v,N,ne,ye,0);break;case 2:xn(v,N,ne,ye);break;case 1:Ai(v,N,ne,ye)}}function jo(d,v){var N,ne,ye=v.M,ve=v.Nb,be=d.oc,xe=d.pc+40,Ae=d.oc,ke=d.pc+584,Fe=d.oc,Ze=d.pc+600;for(N=0;16>N;++N)be[xe+32*N-1]=129;for(N=0;8>N;++N)Ae[ke+32*N-1]=129,Fe[Ze+32*N-1]=129;for(0<ye?be[xe-1-32]=Ae[ke-1-32]=Fe[Ze-1-32]=129:(i(be,xe-32-1,127,21),i(Ae,ke-32-1,127,9),i(Fe,Ze-32-1,127,9)),ne=0;ne<d.za;++ne){var et=v.ya[v.aa+ne];if(0<ne){for(N=-1;16>N;++N)n(be,xe+32*N-4,be,xe+32*N+12,4);for(N=-1;8>N;++N)n(Ae,ke+32*N-4,Ae,ke+32*N+4,4),n(Fe,Ze+32*N-4,Fe,Ze+32*N+4,4)}var Ye=d.Gd,yt=d.Hd+ne,it=et.ad,Oe=et.Hc;if(0<ye&&(n(be,xe-32,Ye[yt].y,0,16),n(Ae,ke-32,Ye[yt].f,0,8),n(Fe,Ze-32,Ye[yt].ea,0,8)),et.Za){var je=be,ft=xe-32+16;for(0<ye&&(ne>=d.za-1?i(je,ft,Ye[yt].y[15],4):n(je,ft,Ye[yt+1].y,0,4)),N=0;4>N;N++)je[ft+128+N]=je[ft+256+N]=je[ft+384+N]=je[ft+0+N];for(N=0;16>N;++N,Oe<<=2)je=be,ft=xe+cg[N],So[et.Ob[N]](je,ft),Jn(Oe,it,16*+N,je,ft)}else if(je=_o(ne,ye,et.Ob[0]),ea[je](be,xe),Oe!=0)for(N=0;16>N;++N,Oe<<=2)Jn(Oe,it,16*+N,be,xe+cg[N]);for(N=et.Gc,je=_o(ne,ye,et.Dd),ms[je](Ae,ke),ms[je](Fe,Ze),Oe=it,je=Ae,ft=ke,255&(et=N>>0)&&(170&et?qc(Oe,256,je,ft):io(Oe,256,je,ft)),et=Fe,Oe=Ze,255&(N>>=8)&&(170&N?qc(it,320,et,Oe):io(it,320,et,Oe)),ye<d.Ub-1&&(n(Ye[yt].y,0,be,xe+480,16),n(Ye[yt].f,0,Ae,ke+224,8),n(Ye[yt].ea,0,Fe,Ze+224,8)),N=8*ve*d.B,Ye=d.sa,yt=d.ta+16*ne+16*ve*d.R,it=d.qa,et=d.ra+8*ne+N,Oe=d.Ha,je=d.Ia+8*ne+N,N=0;16>N;++N)n(Ye,yt+N*d.R,be,xe+32*N,16);for(N=0;8>N;++N)n(it,et+N*d.B,Ae,ke+32*N,8),n(Oe,je+N*d.B,Fe,Ze+32*N,8)}}function Vo(d,v,N,ne,ye,ve,be,xe,Ae){var ke=[0],Fe=[0],Ze=0,et=Ae!=null?Ae.kd:0,Ye=Ae??new Gs;if(d==null||12>N)return 7;Ye.data=d,Ye.w=v,Ye.ha=N,v=[v],N=[N],Ye.gb=[Ye.gb];e:{var yt=v,it=N,Oe=Ye.gb;if(e(d!=null),e(it!=null),e(Oe!=null),Oe[0]=0,12<=it[0]&&!r(d,yt[0],"RIFF")){if(r(d,yt[0]+8,"WEBP")){Oe=3;break e}var je=oe(d,yt[0]+4);if(12>je||4294967286<je){Oe=3;break e}if(et&&je>it[0]-8){Oe=7;break e}Oe[0]=je,yt[0]+=12,it[0]-=12}Oe=0}if(Oe!=0)return Oe;for(je=0<Ye.gb[0],N=N[0];;){e:{var ft=d;it=v,Oe=N;var Pt=ke,mt=Fe,Yt=yt=[0];if((zt=Ze=[Ze])[0]=0,8>Oe[0])Oe=7;else{if(!r(ft,it[0],"VP8X")){if(oe(ft,it[0]+4)!=10){Oe=3;break e}if(18>Oe[0]){Oe=7;break e}var Vt=oe(ft,it[0]+8),dr=1+re(ft,it[0]+12);if(2147483648<=dr*(ft=1+re(ft,it[0]+15))){Oe=3;break e}Yt!=null&&(Yt[0]=Vt),Pt!=null&&(Pt[0]=dr),mt!=null&&(mt[0]=ft),it[0]+=18,Oe[0]-=18,zt[0]=1}Oe=0}}if(Ze=Ze[0],yt=yt[0],Oe!=0)return Oe;if(it=!!(2&yt),!je&&Ze)return 3;if(ve!=null&&(ve[0]=!!(16&yt)),be!=null&&(be[0]=it),xe!=null&&(xe[0]=0),be=ke[0],yt=Fe[0],Ze&&it&&Ae==null){Oe=0;break}if(4>N){Oe=7;break}if(je&&Ze||!je&&!Ze&&!r(d,v[0],"ALPH")){N=[N],Ye.na=[Ye.na],Ye.P=[Ye.P],Ye.Sa=[Ye.Sa];e:{Vt=d,Oe=v,je=N;var zt=Ye.gb;Pt=Ye.na,mt=Ye.P,Yt=Ye.Sa,dr=22,e(Vt!=null),e(je!=null),ft=Oe[0];var Kr=je[0];for(e(Pt!=null),e(Yt!=null),Pt[0]=null,mt[0]=null,Yt[0]=0;;){if(Oe[0]=ft,je[0]=Kr,8>Kr){Oe=7;break e}var tn=oe(Vt,ft+4);if(4294967286<tn){Oe=3;break e}var Gr=8+tn+1&-2;if(dr+=Gr,0<zt&&dr>zt){Oe=3;break e}if(!r(Vt,ft,"VP8 ")||!r(Vt,ft,"VP8L")){Oe=0;break e}if(Kr[0]<Gr){Oe=7;break e}r(Vt,ft,"ALPH")||(Pt[0]=Vt,mt[0]=ft+8,Yt[0]=tn),ft+=Gr,Kr-=Gr}}if(N=N[0],Ye.na=Ye.na[0],Ye.P=Ye.P[0],Ye.Sa=Ye.Sa[0],Oe!=0)break}N=[N],Ye.Ja=[Ye.Ja],Ye.xa=[Ye.xa];e:if(zt=d,Oe=v,je=N,Pt=Ye.gb[0],mt=Ye.Ja,Yt=Ye.xa,Vt=Oe[0],ft=!r(zt,Vt,"VP8 "),dr=!r(zt,Vt,"VP8L"),e(zt!=null),e(je!=null),e(mt!=null),e(Yt!=null),8>je[0])Oe=7;else{if(ft||dr){if(zt=oe(zt,Vt+4),12<=Pt&&zt>Pt-12){Oe=3;break e}if(et&&zt>je[0]-8){Oe=7;break e}mt[0]=zt,Oe[0]+=8,je[0]-=8,Yt[0]=dr}else Yt[0]=5<=je[0]&&zt[Vt+0]==47&&!(zt[Vt+4]>>5),mt[0]=je[0];Oe=0}if(N=N[0],Ye.Ja=Ye.Ja[0],Ye.xa=Ye.xa[0],v=v[0],Oe!=0)break;if(4294967286<Ye.Ja)return 3;if(xe==null||it||(xe[0]=Ye.xa?2:1),be=[be],yt=[yt],Ye.xa){if(5>N){Oe=7;break}xe=be,et=yt,it=ve,d==null||5>N?d=0:5<=N&&d[v+0]==47&&!(d[v+4]>>5)?(je=[0],zt=[0],Pt=[0],X(mt=new L,d,v,N),It(mt,je,zt,Pt)?(xe!=null&&(xe[0]=je[0]),et!=null&&(et[0]=zt[0]),it!=null&&(it[0]=Pt[0]),d=1):d=0):d=0}else{if(10>N){Oe=7;break}xe=yt,d==null||10>N||!bn(d,v+3,N-3)?d=0:(et=d[v+0]|d[v+1]<<8|d[v+2]<<16,it=16383&(d[v+7]<<8|d[v+6]),d=16383&(d[v+9]<<8|d[v+8]),1&et||3<(et>>1&7)||!(et>>4&1)||et>>5>=Ye.Ja||!it||!d?d=0:(be&&(be[0]=it),xe&&(xe[0]=d),d=1))}if(!d||(be=be[0],yt=yt[0],Ze&&(ke[0]!=be||Fe[0]!=yt)))return 3;Ae!=null&&(Ae[0]=Ye,Ae.offset=v-Ae.w,e(4294967286>v-Ae.w),e(Ae.offset==Ae.ha-N));break}return Oe==0||Oe==7&&Ze&&Ae==null?(ve!=null&&(ve[0]|=Ye.na!=null&&0<Ye.na.length),ne!=null&&(ne[0]=be),ye!=null&&(ye[0]=yt),0):Oe}function Oc(d,v,N){var ne=v.width,ye=v.height,ve=0,be=0,xe=ne,Ae=ye;if(v.Da=d!=null&&0<d.Da,v.Da&&(xe=d.cd,Ae=d.bd,ve=d.v,be=d.j,11>N||(ve&=-2,be&=-2),0>ve||0>be||0>=xe||0>=Ae||ve+xe>ne||be+Ae>ye))return 0;if(v.v=ve,v.j=be,v.va=ve+xe,v.o=be+Ae,v.U=xe,v.T=Ae,v.da=d!=null&&0<d.da,v.da){if(!ie(xe,Ae,N=[d.ib],ve=[d.hb]))return 0;v.ib=N[0],v.hb=ve[0]}return v.ob=d!=null&&d.ob,v.Kb=d==null||!d.Sd,v.da&&(v.ob=v.ib<3*ne/4&&v.hb<3*ye/4,v.Kb=0),1}function Bc(d){if(d==null)return 2;if(11>d.S){var v=d.f.RGBA;v.fb+=(d.height-1)*v.A,v.A=-v.A}else v=d.f.kb,d=d.height,v.O+=(d-1)*v.fa,v.fa=-v.fa,v.N+=(d-1>>1)*v.Ab,v.Ab=-v.Ab,v.W+=(d-1>>1)*v.Db,v.Db=-v.Db,v.F!=null&&(v.J+=(d-1)*v.lb,v.lb=-v.lb);return 0}function jl(d,v,N,ne){if(ne==null||0>=d||0>=v)return 2;if(N!=null){if(N.Da){var ye=N.cd,ve=N.bd,be=-2&N.v,xe=-2&N.j;if(0>be||0>xe||0>=ye||0>=ve||be+ye>d||xe+ve>v)return 2;d=ye,v=ve}if(N.da){if(!ie(d,v,ye=[N.ib],ve=[N.hb]))return 2;d=ye[0],v=ve[0]}}ne.width=d,ne.height=v;e:{var Ae=ne.width,ke=ne.height;if(d=ne.S,0>=Ae||0>=ke||!(d>=pd&&13>d))d=2;else{if(0>=ne.Rd&&ne.sd==null){be=ve=ye=v=0;var Fe=(xe=Ae*ug[d])*ke;if(11>d||(ve=(ke+1)/2*(v=(Ae+1)/2),d==12&&(be=(ye=Ae)*ke)),(ke=o(Fe+2*ve+be))==null){d=1;break e}ne.sd=ke,11>d?((Ae=ne.f.RGBA).eb=ke,Ae.fb=0,Ae.A=xe,Ae.size=Fe):((Ae=ne.f.kb).y=ke,Ae.O=0,Ae.fa=xe,Ae.Fd=Fe,Ae.f=ke,Ae.N=0+Fe,Ae.Ab=v,Ae.Cd=ve,Ae.ea=ke,Ae.W=0+Fe+ve,Ae.Db=v,Ae.Ed=ve,d==12&&(Ae.F=ke,Ae.J=0+Fe+2*ve),Ae.Tc=be,Ae.lb=ye)}if(v=1,ye=ne.S,ve=ne.width,be=ne.height,ye>=pd&&13>ye)if(11>ye)d=ne.f.RGBA,v&=(xe=Math.abs(d.A))*(be-1)+ve<=d.size,v&=xe>=ve*ug[ye],v&=d.eb!=null;else{d=ne.f.kb,xe=(ve+1)/2,Fe=(be+1)/2,Ae=Math.abs(d.fa),ke=Math.abs(d.Ab);var Ze=Math.abs(d.Db),et=Math.abs(d.lb),Ye=et*(be-1)+ve;v&=Ae*(be-1)+ve<=d.Fd,v&=ke*(Fe-1)+xe<=d.Cd,v=(v&=Ze*(Fe-1)+xe<=d.Ed)&Ae>=ve&ke>=xe&Ze>=xe,v&=d.y!=null,v&=d.f!=null,v&=d.ea!=null,ye==12&&(v&=et>=ve,v&=Ye<=d.Tc,v&=d.F!=null)}else v=0;d=v?0:2}}return d!=0||N!=null&&N.fd&&(d=Bc(ne)),d}var Qn=64,Vl=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ql=24,zl=32,jc=8,Ti=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ge("Predictor0","PredictorAdd0"),C.Predictor0=function(){return 4278190080},C.Predictor1=function(d){return d},C.Predictor2=function(d,v,N){return v[N+0]},C.Predictor3=function(d,v,N){return v[N+1]},C.Predictor4=function(d,v,N){return v[N-1]},C.Predictor5=function(d,v,N){return pe(pe(d,v[N+1]),v[N+0])},C.Predictor6=function(d,v,N){return pe(d,v[N-1])},C.Predictor7=function(d,v,N){return pe(d,v[N+0])},C.Predictor8=function(d,v,N){return pe(v[N-1],v[N+0])},C.Predictor9=function(d,v,N){return pe(v[N+0],v[N+1])},C.Predictor10=function(d,v,N){return pe(pe(d,v[N-1]),pe(v[N+0],v[N+1]))},C.Predictor11=function(d,v,N){var ne=v[N+0];return 0>=De(ne>>24&255,d>>24&255,(v=v[N-1])>>24&255)+De(ne>>16&255,d>>16&255,v>>16&255)+De(ne>>8&255,d>>8&255,v>>8&255)+De(255&ne,255&d,255&v)?ne:d},C.Predictor12=function(d,v,N){var ne=v[N+0];return(_e((d>>24&255)+(ne>>24&255)-((v=v[N-1])>>24&255))<<24|_e((d>>16&255)+(ne>>16&255)-(v>>16&255))<<16|_e((d>>8&255)+(ne>>8&255)-(v>>8&255))<<8|_e((255&d)+(255&ne)-(255&v)))>>>0},C.Predictor13=function(d,v,N){var ne=v[N-1];return(Le((d=pe(d,v[N+0]))>>24&255,ne>>24&255)<<24|Le(d>>16&255,ne>>16&255)<<16|Le(d>>8&255,ne>>8&255)<<8|Le(d>>0&255,ne>>0&255))>>>0};var Pp=C.PredictorAdd0;C.PredictorAdd1=Te,ge("Predictor2","PredictorAdd2"),ge("Predictor3","PredictorAdd3"),ge("Predictor4","PredictorAdd4"),ge("Predictor5","PredictorAdd5"),ge("Predictor6","PredictorAdd6"),ge("Predictor7","PredictorAdd7"),ge("Predictor8","PredictorAdd8"),ge("Predictor9","PredictorAdd9"),ge("Predictor10","PredictorAdd10"),ge("Predictor11","PredictorAdd11"),ge("Predictor12","PredictorAdd12"),ge("Predictor13","PredictorAdd13");var Vc=C.PredictorAdd2;Je("ColorIndexInverseTransform","MapARGB","32b",function(d){return d>>8&255},function(d){return d}),Je("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(d){return d},function(d){return d>>8&255});var ad,no=C.ColorIndexInverseTransform,Ul=C.MapARGB,ld=C.VP8LColorIndexInverseTransformAlpha,cd=C.MapAlpha,Js=C.VP8LPredictorsAdd=[];Js.length=16,(C.VP8LPredictors=[]).length=16,(C.VP8LPredictorsAdd_C=[]).length=16,(C.VP8LPredictors_C=[]).length=16;var Ka,ki,xi,Qs,ds,hs,Hl,ps,xn,qc,Ai,io,Gl,ud,zc,Ja,Qa,Xs,Xa,Wl,Za,Zs,Uc,oo,so,dn,hn,An,Vn=o(511),fs=o(2041),Hc=o(225),Yl=o(767),dd=0,wp=fs,hd=Hc,Yi=Yl,ao=Vn,pd=0,fd=1,Zy=2,md=3,yd=4,xp=5,eg=6,Ap=7,Cp=8,gd=9,Ip=10,x_=[2,3,7],A_=[3,3,11],tg=[280,256,256,256,40],C_=[0,1,1,1,0],I_=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],$_=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],E_=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],T_=8,$p=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Ep=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Gc=null,k_=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],N_=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],rg=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],L_=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],R_=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],D_=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],M_=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ea=[],So=[],ms=[],F_=1,ng=2,ta=[],lo=[];st("UpsampleRgbLinePair",we,3),st("UpsampleBgrLinePair",Ve,3),st("UpsampleRgbaLinePair",Cr,4),st("UpsampleBgraLinePair",Dr,4),st("UpsampleArgbLinePair",Ar,4),st("UpsampleRgba4444LinePair",Ct,2),st("UpsampleRgb565LinePair",tt,2);var O_=C.UpsampleRgbLinePair,B_=C.UpsampleBgrLinePair,ig=C.UpsampleRgbaLinePair,og=C.UpsampleBgraLinePair,sg=C.UpsampleArgbLinePair,ag=C.UpsampleRgba4444LinePair,j_=C.UpsampleRgb565LinePair,vd=16,bd=1<<vd-1,Wc=-227,Tp=482,V_=6,lg=0,q_=o(256),z_=o(256),U_=o(256),H_=o(256),G_=o(Tp-Wc),W_=o(Tp-Wc);an("YuvToRgbRow",we,3),an("YuvToBgrRow",Ve,3),an("YuvToRgbaRow",Cr,4),an("YuvToBgraRow",Dr,4),an("YuvToArgbRow",Ar,4),an("YuvToRgba4444Row",Ct,2),an("YuvToRgb565Row",tt,2);var cg=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],_d=[0,2,8],Y_=[8,7,6,4,4,2,2,2,1,1,1,1],K_=1;this.WebPDecodeRGBA=function(d,v,N,ne,ye){var ve=fd,be=new cs,xe=new qe;be.ba=xe,xe.S=ve,xe.width=[xe.width],xe.height=[xe.height];var Ae=xe.width,ke=xe.height,Fe=new Dt;if(Fe==null||d==null)var Ze=2;else e(Fe!=null),Ze=Vo(d,v,N,Fe.width,Fe.height,Fe.Pd,Fe.Qd,Fe.format,null);if(Ze!=0?Ae=0:(Ae!=null&&(Ae[0]=Fe.width[0]),ke!=null&&(ke[0]=Fe.height[0]),Ae=1),Ae){xe.width=xe.width[0],xe.height=xe.height[0],ne!=null&&(ne[0]=xe.width),ye!=null&&(ye[0]=xe.height);e:{if(ne=new Ur,(ye=new Gs).data=d,ye.w=v,ye.ha=N,ye.kd=1,v=[0],e(ye!=null),((d=Vo(ye.data,ye.w,ye.ha,null,null,null,v,null,ye))==0||d==7)&&v[0]&&(d=4),(v=d)==0){if(e(be!=null),ne.data=ye.data,ne.w=ye.w+ye.offset,ne.ha=ye.ha-ye.offset,ne.put=cr,ne.ac=Qt,ne.bc=xr,ne.ma=be,ye.xa){if((d=Kt())==null){be=1;break e}if(function(et,Ye){var yt=[0],it=[0],Oe=[0];t:for(;;){if(et==null)return 0;if(Ye==null)return et.a=2,0;if(et.l=Ye,et.a=0,X(et.m,Ye.data,Ye.w,Ye.ha),!It(et.m,yt,it,Oe)){et.a=3;break t}if(et.xb=ng,Ye.width=yt[0],Ye.height=it[0],!rr(yt[0],it[0],1,et,null))break t;return 1}return e(et.a!=0),0}(d,ne)){if(ne=(v=jl(ne.width,ne.height,be.Oa,be.ba))==0){t:{ne=d;r:for(;;){if(ne==null){ne=0;break t}if(e(ne.s.yc!=null),e(ne.s.Ya!=null),e(0<ne.s.Wb),e((N=ne.l)!=null),e((ye=N.ma)!=null),ne.xb!=0){if(ne.ca=ye.ba,ne.tb=ye.tb,e(ne.ca!=null),!Oc(ye.Oa,N,md)){ne.a=2;break r}if(!yr(ne,N.width)||N.da)break r;if((N.da||ct(ne.ca.S))&&He(),11>ne.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),ne.ca.f.kb.F!=null&&He()),ne.Pb&&0<ne.s.ua&&ne.s.vb.X==null&&!fe(ne.s.vb,ne.s.Wa.Xa)){ne.a=1;break r}ne.xb=0}if(!Tt(ne,ne.V,ne.Ba,ne.c,ne.i,N.o,_t))break r;ye.Dc=ne.Ma,ne=1;break t}e(ne.a!=0),ne=0}ne=!ne}ne&&(v=d.a)}else v=d.a}else{if((d=new Yr)==null){be=1;break e}if(d.Fa=ye.na,d.P=ye.P,d.qc=ye.Sa,_i(d,ne)){if((v=jl(ne.width,ne.height,be.Oa,be.ba))==0){if(d.Aa=0,N=be.Oa,e((ye=d)!=null),N!=null){if(0<(Ae=0>(Ae=N.Md)?0:100<Ae?255:255*Ae/100)){for(ke=Fe=0;4>ke;++ke)12>(Ze=ye.pb[ke]).lc&&(Ze.ia=Ae*Y_[0>Ze.lc?0:Ze.lc]>>3),Fe|=Ze.ia;Fe&&(alert("todo:VP8InitRandom"),ye.ia=1)}ye.Ga=N.Id,100<ye.Ga?ye.Ga=100:0>ye.Ga&&(ye.Ga=0)}Nr(d,ne)||(v=d.a)}}else v=d.a}v==0&&be.Oa!=null&&be.Oa.fd&&(v=Bc(be.ba))}be=v}ve=be!=0?null:11>ve?xe.f.RGBA.eb:xe.f.kb.y}else ve=null;return ve};var ug=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(C,T){for(var O="",b=0;b<4;b++)O+=String.fromCharCode(C[T++]);return O}function h(C,T){return(C[T+0]<<0|C[T+1]<<8|C[T+2]<<16)>>>0}function y(C,T){return(C[T+0]<<0|C[T+1]<<8|C[T+2]<<16|C[T+3]<<24)>>>0}new c;var g=[0],f=[0],x=[],S=new c,w=t,E=function(C,T){var O={},b=0,P=!1,_=0,z=0;if(O.frames=[],!function(D,j,I,M){for(var J=0;J<M;J++)if(D[j+J]!=I.charCodeAt(J))return!0;return!1}(C,T,"RIFF",4)){for(y(C,T+=4),T+=8;T<C.length;){var Z=u(C,T),k=y(C,T+=4);T+=4;var F=k+(1&k);switch(Z){case"VP8 ":case"VP8L":O.frames[b]===void 0&&(O.frames[b]={}),(B=O.frames[b]).src_off=P?z:T-8,B.src_size=_+k+8,b++,P&&(P=!1,_=0,z=0);break;case"VP8X":(B=O.header={}).feature_flags=C[T];var X=T+4;B.canvas_width=1+h(C,X),X+=3,B.canvas_height=1+h(C,X),X+=3;break;case"ALPH":P=!0,_=F+8,z=T-8;break;case"ANIM":(B=O.header).bgcolor=y(C,T),X=T+4,B.loop_count=(ce=C)[(L=X)+0]<<0|ce[L+1]<<8,X+=2;break;case"ANMF":var U,B;(B=O.frames[b]={}).offset_x=2*h(C,T),T+=3,B.offset_y=2*h(C,T),T+=3,B.width=1+h(C,T),T+=3,B.height=1+h(C,T),T+=3,B.duration=h(C,T),T+=3,U=C[T++],B.dispose=1&U,B.blend=U>>1&1}Z!="ANMF"&&(T+=F)}var ce,L;return O}}(w,0);E.response=w,E.rgbaoutput=!0,E.dataurl=!1;var q=E.header?E.header:null,ee=E.frames?E.frames:null;if(q){q.loop_counter=q.loop_count,g=[q.canvas_height],f=[q.canvas_width];for(var W=0;W<ee.length&&ee[W].blend!=0;W++);}var K=ee[0],te=S.WebPDecodeRGBA(w,K.src_off,K.src_size,f,g);K.rgba=te,K.imgwidth=f[0],K.imgheight=g[0];for(var $=0;$<f[0]*g[0]*4;$++)x[$]=te[$];return this.width=f,this.height=g,this.data=x,this}(function(t){var e=function(){return typeof Em=="function"},r=function(g,f,x,S){var w=4,E=s;switch(S){case t.image_compression.FAST:w=1,E=o;break;case t.image_compression.MEDIUM:w=6,E=l;break;case t.image_compression.SLOW:w=9,E=c}g=n(g,f,x,E);var q=Em(g,{level:w});return t.__addimage__.arrayBufferToBinaryString(q)},n=function(g,f,x,S){for(var w,E,q,ee=g.length/f,W=new Uint8Array(g.length+ee),K=h(),te=0;te<ee;te+=1){if(q=te*f,w=g.subarray(q,q+f),S)W.set(S(w,x,E),q+te);else{for(var $,C=K.length,T=[];$<C;$+=1)T[$]=K[$](w,x,E);var O=y(T.concat());W.set(T[O],q+te)}E=w}return W},i=function(g){var f=Array.apply([],g);return f.unshift(0),f},o=function(g,f){var x,S=[],w=g.length;S[0]=1;for(var E=0;E<w;E+=1)x=g[E-f]||0,S[E+1]=g[E]-x+256&255;return S},s=function(g,f,x){var S,w=[],E=g.length;w[0]=2;for(var q=0;q<E;q+=1)S=x&&x[q]||0,w[q+1]=g[q]-S+256&255;return w},l=function(g,f,x){var S,w,E=[],q=g.length;E[0]=3;for(var ee=0;ee<q;ee+=1)S=g[ee-f]||0,w=x&&x[ee]||0,E[ee+1]=g[ee]+256-(S+w>>>1)&255;return E},c=function(g,f,x){var S,w,E,q,ee=[],W=g.length;ee[0]=4;for(var K=0;K<W;K+=1)S=g[K-f]||0,w=x&&x[K]||0,E=x&&x[K-f]||0,q=u(S,w,E),ee[K+1]=g[K]-q+256&255;return ee},u=function(g,f,x){if(g===f&&f===x)return g;var S=Math.abs(f-x),w=Math.abs(g-x),E=Math.abs(g+f-x-x);return S<=w&&S<=E?g:w<=E?f:x},h=function(){return[i,o,s,l,c]},y=function(g){var f=g.map(function(x){return x.reduce(function(S,w){return S+Math.abs(w)},0)});return f.indexOf(Math.min.apply(null,f))};t.processPNG=function(g,f,x,S){var w,E,q,ee,W,K,te,$,C,T,O,b,P,_,z,Z=this.decode.FLATE_DECODE,k="";if(this.__addimage__.isArrayBuffer(g)&&(g=new Uint8Array(g)),this.__addimage__.isArrayBufferView(g)){if(g=(q=new e7(g)).imgData,E=q.bits,w=q.colorSpace,W=q.colors,[4,6].indexOf(q.colorType)!==-1){if(q.bits===8){C=($=q.pixelBitlength==32?new Uint32Array(q.decodePixels().buffer):q.pixelBitlength==16?new Uint16Array(q.decodePixels().buffer):new Uint8Array(q.decodePixels().buffer)).length,O=new Uint8Array(C*q.colors),T=new Uint8Array(C);var F,X=q.pixelBitlength-q.bits;for(_=0,z=0;_<C;_++){for(P=$[_],F=0;F<X;)O[z++]=P>>>F&255,F+=q.bits;T[_]=P>>>F&255}}if(q.bits===16){C=($=new Uint32Array(q.decodePixels().buffer)).length,O=new Uint8Array(C*(32/q.pixelBitlength)*q.colors),T=new Uint8Array(C*(32/q.pixelBitlength)),b=q.colors>1,_=0,z=0;for(var U=0;_<C;)P=$[_++],O[z++]=P>>>0&255,b&&(O[z++]=P>>>16&255,P=$[_++],O[z++]=P>>>0&255),T[U++]=P>>>16&255;E=8}S!==t.image_compression.NONE&&e()?(g=r(O,q.width*q.colors,q.colors,S),te=r(T,q.width,1,S)):(g=O,te=T,Z=void 0)}if(q.colorType===3&&(w=this.color_spaces.INDEXED,K=q.palette,q.transparency.indexed)){var B=q.transparency.indexed,ce=0;for(_=0,C=B.length;_<C;++_)ce+=B[_];if((ce/=255)===C-1&&B.indexOf(0)!==-1)ee=[B.indexOf(0)];else if(ce!==C){for($=q.decodePixels(),T=new Uint8Array($.length),_=0,C=$.length;_<C;_++)T[_]=B[$[_]];te=r(T,q.width,1)}}var L=function(D){var j;switch(D){case t.image_compression.FAST:j=11;break;case t.image_compression.MEDIUM:j=13;break;case t.image_compression.SLOW:j=14;break;default:j=12}return j}(S);return Z===this.decode.FLATE_DECODE&&(k="/Predictor "+L+" "),k+="/Colors "+W+" /BitsPerComponent "+E+" /Columns "+q.width,(this.__addimage__.isArrayBuffer(g)||this.__addimage__.isArrayBufferView(g))&&(g=this.__addimage__.arrayBufferToBinaryString(g)),(te&&this.__addimage__.isArrayBuffer(te)||this.__addimage__.isArrayBufferView(te))&&(te=this.__addimage__.arrayBufferToBinaryString(te)),{alias:x,data:g,index:f,filter:Z,decodeParameters:k,transparency:ee,palette:K,sMask:te,predictor:L,width:q.width,height:q.height,bitsPerComponent:E,colorSpace:w}}}})(hr.API),function(t){t.processGIF89A=function(e,r,n,i){var o=new t7(e),s=o.width,l=o.height,c=[];o.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:s,height:l},h=new kf(100).encode(u,100);return t.processJPEG.call(this,h,r,n,i)},t.processGIF87A=t.processGIF89A}(hr.API),Ao.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:n,blue:r,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Ao.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){cn.log("bit decode error:"+r)}},Ao.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,i=0;i<e;i++)for(var o=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*i*4,l=0;l<8&&8*i+l<this.width;l++){var c=this.palette[o>>7-l&1];this.data[s+4*l]=c.blue,this.data[s+4*l+1]=c.green,this.data[s+4*l+2]=c.red,this.data[s+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Ao.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<t;i++){var o=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*i*4,l=o>>4,c=15&o,u=this.palette[l];if(this.data[s]=u.blue,this.data[s+1]=u.green,this.data[s+2]=u.red,this.data[s+3]=255,2*i+1>=this.width)break;u=this.palette[c],this.data[s+4]=u.blue,this.data[s+4+1]=u.green,this.data[s+4+2]=u.red,this.data[s+4+3]=255}e!==0&&(this.pos+=4-e)}},Ao.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+4*n;if(i<this.palette.length){var s=this.palette[i];this.data[o]=s.red,this.data[o+1]=s.green,this.data[o+2]=s.blue,this.data[o+3]=255}else this.data[o]=255,this.data[o+1]=255,this.data[o+2]=255,this.data[o+3]=255}t!==0&&(this.pos+=4-t)}},Ao.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(o&e)/e*255|0,l=(o>>5&e)/e*255|0,c=(o>>10&e)/e*255|0,u=o>>15?255:0,h=n*this.width*4+4*i;this.data[h]=c,this.data[h+1]=l,this.data[h+2]=s,this.data[h+3]=u}this.pos+=t}},Ao.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,o=0;o<this.width;o++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(s&e)/e*255|0,c=(s>>5&r)/r*255|0,u=(s>>11)/e*255|0,h=i*this.width*4+4*o;this.data[h]=u,this.data[h+1]=c,this.data[h+2]=l,this.data[h+3]=255}this.pos+=t}},Ao.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*r;this.data[s]=o,this.data[s+1]=i,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},Ao.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=o,this.data[l+1]=i,this.data[l+2]=n,this.data[l+3]=s}},Ao.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,r,n,i){var o=new Ao(e,!1),s=o.width,l=o.height,c={data:o.getData(),width:s,height:l},u=new kf(100).encode(c,100);return t.processJPEG.call(this,u,r,n,i)}}(hr.API),ib.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,r,n,i){var o=new ib(e),s=o.width,l=o.height,c={data:o.getData(),width:s,height:l},u=new kf(100).encode(c,100);return t.processJPEG.call(this,u,r,n,i)}}(hr.API),hr.API.processRGBA=function(t,e,r){for(var n=t.data,i=n.length,o=new Uint8Array(i/4*3),s=new Uint8Array(i/4),l=0,c=0,u=0;u<i;u+=4){var h=n[u],y=n[u+1],g=n[u+2],f=n[u+3];o[l++]=h,o[l++]=y,o[l++]=g,s[c++]=f}var x=this.__addimage__.arrayBufferToBinaryString(o);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:x,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},hr.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},ic=hr.API,Xd=ic.getCharWidthsArray=function(t,e){var r,n,i=(e=e||{}).font||this.internal.getFont(),o=e.fontSize||this.internal.getFontSize(),s=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:i.metadata.Unicode.widths,c=l.fof?l.fof:1,u=e.kerning?e.kerning:i.metadata.Unicode.kerning,h=u.fof?u.fof:1,y=e.doKerning!==!1,g=0,f=t.length,x=0,S=l[0]||c,w=[];for(r=0;r<f;r++)n=t.charCodeAt(r),typeof i.metadata.widthOfString=="function"?w.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+s*(1e3/o)||0)/1e3):(g=y&&nn(u[n])==="object"&&!isNaN(parseInt(u[n][x],10))?u[n][x]/h:0,w.push((l[n]||S)/c+g)),x=n;return w},eb=ic.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return ic.processArabic&&(t=ic.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,i)/r:Xd.apply(this,arguments).reduce(function(o,s){return o+s},0)},tb=function(t,e,r,n){for(var i=[],o=0,s=t.length,l=0;o!==s&&l+e[o]<r;)l+=e[o],o++;i.push(t.slice(0,o));var c=o;for(l=0;o!==s;)l+e[o]>n&&(i.push(t.slice(c,o)),l=0,c=o),l+=e[o],o++;return c!==o&&i.push(t.slice(c,o)),i},rb=function(t,e,r){r||(r={});var n,i,o,s,l,c,u,h=[],y=[h],g=r.textIndent||0,f=0,x=0,S=t.split(" "),w=Xd.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?S[0].length+2:r.lineIndent||0){var E=Array(c).join(" "),q=[];S.map(function(W){(W=W.split(/\s*\n/)).length>1?q=q.concat(W.map(function(K,te){return(te&&K.length?`
`:"")+K})):q.push(W[0])}),S=q,c=eb.apply(this,[E,r])}for(o=0,s=S.length;o<s;o++){var ee=0;if(n=S[o],c&&n[0]==`
`&&(n=n.substr(1),ee=1),g+f+(x=(i=Xd.apply(this,[n,r])).reduce(function(W,K){return W+K},0))>e||ee){if(x>e){for(l=tb.apply(this,[n,i,e-(g+f),e]),h.push(l.shift()),h=[l.pop()];l.length;)y.push([l.shift()]);x=i.slice(n.length-(h[0]?h[0].length:0)).reduce(function(W,K){return W+K},0)}else h=[n];y.push(h),g=x+c,f=w}else h.push(n),g+=f+x,f=w}return u=c?function(W,K){return(K?E:"")+W.join(" ")}:function(W){return W.join(" ")},y.map(u)},ic.splitTextToSize=function(t,e,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),o=function(h){if(h.widths&&h.kerning)return{widths:h.widths,kerning:h.kerning};var y=this.internal.getFont(h.fontName,h.fontStyle);return y.metadata.Unicode?{widths:y.metadata.Unicode.widths||{0:1},kerning:y.metadata.Unicode.kerning||{}}:{font:y.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var s=1*this.internal.scaleFactor*e/i;o.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,o.lineIndent=r.lineIndent;var l,c,u=[];for(l=0,c=n.length;l<c;l++)u=u.concat(rb.apply(this,[n[l],s,o]));return u},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",r={},n={},i=0;i<e.length;i++)r[e[i]]="0123456789abcdef"[i],n["0123456789abcdef"[i]]=e[i];var o=function(y){return"0x"+parseInt(y,10).toString(16)},s=t.__fontmetrics__.compress=function(y){var g,f,x,S,w=["{"];for(var E in y){if(g=y[E],isNaN(parseInt(E,10))?f="'"+E+"'":(E=parseInt(E,10),f=(f=o(E).slice(2)).slice(0,-1)+n[f.slice(-1)]),typeof g=="number")g<0?(x=o(g).slice(3),S="-"):(x=o(g).slice(2),S=""),x=S+x.slice(0,-1)+n[x.slice(-1)];else{if(nn(g)!=="object")throw new Error("Don't know what to do with value type "+nn(g)+".");x=s(g)}w.push(f+x)}return w.push("}"),w.join("")},l=t.__fontmetrics__.uncompress=function(y){if(typeof y!="string")throw new Error("Invalid argument passed to uncompress.");for(var g,f,x,S,w={},E=1,q=w,ee=[],W="",K="",te=y.length-1,$=1;$<te;$+=1)(S=y[$])=="'"?g?(x=g.join(""),g=void 0):g=[]:g?g.push(S):S=="{"?(ee.push([q,x]),q={},x=void 0):S=="}"?((f=ee.pop())[0][f[1]]=q,x=void 0,q=f[0]):S=="-"?E=-1:x===void 0?r.hasOwnProperty(S)?(W+=r[S],x=parseInt(W,16)*E,E=1,W=""):W+=S:r.hasOwnProperty(S)?(K+=r[S],q[x]=parseInt(K,16)*E,E=1,x=void 0,K=""):K+=S;return w},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},h={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(y){var g=y.font,f=h.Unicode[g.postScriptName];f&&(g.metadata.Unicode={},g.metadata.Unicode.widths=f.widths,g.metadata.Unicode.kerning=f.kerning);var x=u.Unicode[g.postScriptName];x&&(g.metadata.Unicode.encoding=x,g.encoding=x.codePages[0])}])}(hr.API),function(t){var e=function(r){for(var n=r.length,i=new Uint8Array(n),o=0;o<n;o++)i[o]=r.charCodeAt(o);return i};t.API.events.push(["addFont",function(r){var n=void 0,i=r.font,o=r.instance;if(!i.isStandardFont){if(o===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=o.existsFileInVFS(i.postScriptName)===!1?o.loadFile(i.postScriptName):o.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(s,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(wu(l)),s.metadata=t.API.TTFFont.open(l),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(i,n)}}])}(hr),function(t){function e(){return(gr.canvg?Promise.resolve(gr.canvg):Bi(()=>import("./index.es-CAOU9FJp.js"),[])).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}hr.API.addSvgAsImage=function(r,n,i,o,s,l,c,u){if(isNaN(n)||isNaN(i))throw cn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(o)||isNaN(s))throw cn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var h=document.createElement("canvas");h.width=o,h.height=s;var y=h.getContext("2d");y.fillStyle="#fff",y.fillRect(0,0,h.width,h.height);var g={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return e().then(function(x){return x.fromString(y,r,g)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(x){return x.render(g)}).then(function(){f.addImage(h.toDataURL("image/jpeg",1),n,i,o,s,c,u)})}}(),hr.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(e,r);return this},hr.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,i,o,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(s),c=[],u=0,h=0,y=0;function g(x,S){var w,E=!1;for(w=0;w<x.length;w+=1)x[w]===S&&(E=!0);return E}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var f=l.length;for(y=0;y<f;y+=1)r[l[y]].value=r[l[y]].defaultValue,r[l[y]].explicitSet=!1}if(nn(t)==="object"){for(i in t)if(o=t[i],g(l,i)&&o!==void 0){if(r[i].type==="boolean"&&typeof o=="boolean")r[i].value=o;else if(r[i].type==="name"&&g(r[i].valueSet,o))r[i].value=o;else if(r[i].type==="integer"&&Number.isInteger(o))r[i].value=o;else if(r[i].type==="array"){for(u=0;u<o.length;u+=1)if(n=!0,o[u].length===1&&typeof o[u][0]=="number")c.push(String(o[u]-1));else if(o[u].length>1){for(h=0;h<o[u].length;h+=1)typeof o[u][h]!="number"&&(n=!1);n===!0&&c.push([o[u][0]-1,o[u][1]-1].join(" "))}r[i].value="["+c.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var x,S=[];for(x in r)r[x].explicitSet===!0&&(r[x].type==="name"?S.push("/"+x+" /"+r[x].value):S.push("/"+x+" "+r[x].value));S.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+S.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),o=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=o.length+s.length+l.length+i.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(i+o+s+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}}(hr.API),function(t){var e=t.API,r=e.pdfEscape16=function(o,s){for(var l,c=s.metadata.Unicode.widths,u=["","0","00","000","0000"],h=[""],y=0,g=o.length;y<g;++y){if(l=s.metadata.characterToGlyph(o.charCodeAt(y)),s.metadata.glyIdsUsed.push(l),s.metadata.toUnicode[l]=o.charCodeAt(y),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(s.metadata.widthOfGlyph(l),10)])),l=="0")return h.join("");l=l.toString(16),h.push(u[4-l.length],l)}return h.join("")},n=function(o){var s,l,c,u,h,y,g;for(h=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],y=0,g=(l=Object.keys(o).sort(function(f,x){return f-x})).length;y<g;y++)s=l[y],c.length>=100&&(h+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),o[s]!==void 0&&o[s]!==null&&typeof o[s].toString=="function"&&(u=("0000"+o[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),c.push("<"+s+"><"+u+">"));return c.length&&(h+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),h+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(o){(function(s){var l=s.font,c=s.out,u=s.newObject,h=s.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var y=l.metadata.Unicode.widths,g=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),f="",x=0;x<g.length;x++)f+=String.fromCharCode(g[x]);var S=u();h({data:f,addLength1:!0,objectId:S}),c("endobj");var w=u();h({data:n(l.metadata.toUnicode),addLength1:!0,objectId:w}),c("endobj");var E=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+hc(l.fontName)),c("/FontFile2 "+S+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var q=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+hc(l.fontName)),c("/FontDescriptor "+E+" 0 R"),c("/W "+t.API.PDFObject.convert(y)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+w+" 0 R"),c("/BaseFont /"+hc(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+q+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(o)}]),e.events.push(["putFont",function(o){(function(s){var l=s.font,c=s.out,u=s.newObject,h=s.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var y=l.metadata.rawData,g="",f=0;f<y.length;f++)g+=String.fromCharCode(y[f]);var x=u();h({data:g,addLength1:!0,objectId:x}),c("endobj");var S=u();h({data:n(l.metadata.toUnicode),addLength1:!0,objectId:S}),c("endobj");var w=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+x+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+hc(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var E=0;E<l.metadata.hmtx.widths.length;E++)l.metadata.hmtx.widths[E]=parseInt(l.metadata.hmtx.widths[E]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+S+" 0 R/BaseFont/"+hc(l.fontName)+"/FontDescriptor "+w+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(o)}]);var i=function(o){var s,l=o.text||"",c=o.x,u=o.y,h=o.options||{},y=o.mutex||{},g=y.pdfEscape,f=y.activeFontKey,x=y.fonts,S=f,w="",E=0,q="",ee=x[S].encoding;if(x[S].encoding!=="Identity-H")return{text:l,x:c,y:u,options:h,mutex:y};for(q=l,S=f,Array.isArray(l)&&(q=l[0]),E=0;E<q.length;E+=1)x[S].metadata.hasOwnProperty("cmap")&&(s=x[S].metadata.cmap.unicode.codeMap[q[E].charCodeAt(0)]),s||q[E].charCodeAt(0)<256&&x[S].metadata.hasOwnProperty("Unicode")?w+=q[E]:w+="";var W="";return parseInt(S.slice(1))<14||ee==="WinAnsiEncoding"?W=g(w,S).split("").map(function(K){return K.charCodeAt(0).toString(16)}).join(""):ee==="Identity-H"&&(W=r(w,x[S])),y.isHex=!0,{text:W,x:c,y:u,options:h,mutex:y}};e.events.push(["postProcessText",function(o){var s=o.text||"",l=[],c={text:s,x:o.x,y:o.y,options:o.options,mutex:o.mutex};if(Array.isArray(s)){var u=0;for(u=0;u<s.length;u+=1)Array.isArray(s[u])&&s[u].length===3?l.push([i(Object.assign({},c,{text:s[u][0]})).text,s[u][1],s[u][2]]):l.push(i(Object.assign({},c,{text:s[u]})).text);o.text=l}else o.text=i(Object.assign({},c,{text:s})).text}])}(hr),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(hr.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var i,o,s,l,c,u,h,y=e,g=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],f=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],x={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},S={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},w=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],E=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),q=!1,ee=0;this.__bidiEngine__={};var W=function(b){var P=b.charCodeAt(),_=P>>8,z=S[_];return z!==void 0?y[256*z+(255&P)]:_===252||_===253?"AL":E.test(_)?"L":_===8?"R":"N"},K=function(b){for(var P,_=0;_<b.length;_++){if((P=W(b.charAt(_)))==="L")return!1;if(P==="R")return!0}return!1},te=function(b,P,_,z){var Z,k,F,X,U=P[z];switch(U){case"L":case"R":q=!1;break;case"N":case"AN":break;case"EN":q&&(U="AN");break;case"AL":q=!0,U="R";break;case"WS":U="N";break;case"CS":z<1||z+1>=P.length||(Z=_[z-1])!=="EN"&&Z!=="AN"||(k=P[z+1])!=="EN"&&k!=="AN"?U="N":q&&(k="AN"),U=k===Z?k:"N";break;case"ES":U=(Z=z>0?_[z-1]:"B")==="EN"&&z+1<P.length&&P[z+1]==="EN"?"EN":"N";break;case"ET":if(z>0&&_[z-1]==="EN"){U="EN";break}if(q){U="N";break}for(F=z+1,X=P.length;F<X&&P[F]==="ET";)F++;U=F<X&&P[F]==="EN"?"EN":"N";break;case"NSM":if(s&&!l){for(X=P.length,F=z+1;F<X&&P[F]==="NSM";)F++;if(F<X){var B=b[z],ce=B>=1425&&B<=2303||B===64286;if(Z=P[F],ce&&(Z==="R"||Z==="AL")){U="R";break}}}U=z<1||(Z=P[z-1])==="B"?"N":_[z-1];break;case"B":q=!1,i=!0,U=ee;break;case"S":o=!0,U="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":q=!1;break;case"BN":U="N"}return U},$=function(b,P,_){var z=b.split("");return _&&C(z,_,{hiLevel:ee}),z.reverse(),P&&P.reverse(),z.join("")},C=function(b,P,_){var z,Z,k,F,X,U=-1,B=b.length,ce=0,L=[],D=ee?f:g,j=[];for(q=!1,i=!1,o=!1,Z=0;Z<B;Z++)j[Z]=W(b[Z]);for(k=0;k<B;k++){if(X=ce,L[k]=te(b,j,L,k),z=240&(ce=D[X][x[L[k]]]),ce&=15,P[k]=F=D[ce][5],z>0)if(z===16){for(Z=U;Z<k;Z++)P[Z]=1;U=-1}else U=-1;if(D[ce][6])U===-1&&(U=k);else if(U>-1){for(Z=U;Z<k;Z++)P[Z]=F;U=-1}j[k]==="B"&&(P[k]=0),_.hiLevel|=F}o&&function(I,M,J){for(var H=0;H<J;H++)if(I[H]==="S"){M[H]=ee;for(var Q=H-1;Q>=0&&I[Q]==="WS";Q--)M[Q]=ee}}(j,P,B)},T=function(b,P,_,z,Z){if(!(Z.hiLevel<b)){if(b===1&&ee===1&&!i)return P.reverse(),void(_&&_.reverse());for(var k,F,X,U,B=P.length,ce=0;ce<B;){if(z[ce]>=b){for(X=ce+1;X<B&&z[X]>=b;)X++;for(U=ce,F=X-1;U<F;U++,F--)k=P[U],P[U]=P[F],P[F]=k,_&&(k=_[U],_[U]=_[F],_[F]=k);ce=X}ce++}}},O=function(b,P,_){var z=b.split(""),Z={hiLevel:ee};return _||(_=[]),C(z,_,Z),function(k,F,X){if(X.hiLevel!==0&&h)for(var U,B=0;B<k.length;B++)F[B]===1&&(U=w.indexOf(k[B]))>=0&&(k[B]=w[U+1])}(z,_,Z),T(2,z,P,_,Z),T(1,z,P,_,Z),z.join("")};return this.__bidiEngine__.doBidiReorder=function(b,P,_){if(function(Z,k){if(k)for(var F=0;F<Z.length;F++)k[F]=F;l===void 0&&(l=K(Z)),u===void 0&&(u=K(Z))}(b,P),s||!c||u)if(s&&c&&l^u)ee=l?1:0,b=$(b,P,_);else if(!s&&c&&u)ee=l?1:0,b=O(b,P,_),b=$(b,P);else if(!s||l||c||u){if(s&&!c&&l^u)b=$(b,P),l?(ee=0,b=O(b,P,_)):(ee=1,b=O(b,P,_),b=$(b,P));else if(s&&l&&!c&&u)ee=1,b=O(b,P,_),b=$(b,P);else if(!s&&!c&&l^u){var z=h;l?(ee=1,b=O(b,P,_),ee=0,h=!1,b=O(b,P,_),h=z):(ee=0,b=O(b,P,_),b=$(b,P),ee=1,h=!1,b=O(b,P,_),h=z,b=$(b,P))}}else ee=0,b=O(b,P,_);else ee=l?1:0,b=O(b,P,_);return b},this.__bidiEngine__.setOptions=function(b){b&&(s=b.isInputVisual,c=b.isOutputVisual,l=b.isInputRtl,u=b.isOutputRtl,h=b.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var i=n.text;n.x,n.y;var o=n.options||{};n.mutex,o.lang;var s=[];if(o.isInputVisual=typeof o.isInputVisual!="boolean"||o.isInputVisual,r.setOptions(o),Object.prototype.toString.call(i)==="[object Array]"){var l=0;for(s=[],l=0;l<i.length;l+=1)Object.prototype.toString.call(i[l])==="[object Array]"?s.push([r.doBidiReorder(i[l][0]),i[l][1],i[l][2]]):s.push([r.doBidiReorder(i[l])]);n.text=s}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])}(hr),hr.API.TTFFont=function(){function t(e){var r;if(this.rawData=e,r=this.contents=new Da(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new y7(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new r7(this.contents),this.head=new i7(this),this.name=new c7(this),this.cmap=new r_(this),this.toUnicode={},this.hhea=new o7(this),this.maxp=new u7(this),this.hmtx=new d7(this),this.post=new a7(this),this.os2=new s7(this),this.loca=new m7(this),this.glyf=new h7(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,i,o;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var s,l,c,u;for(u=[],s=0,l=(c=this.bbox).length;s<l;s++)e=c[s],u.push(Math.round(e*this.scaleFactor));return u}.call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),(32768&(r=i>>16))!=0&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(o=this.familyClass)===1||o===2||o===3||o===4||o===5||o===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var i,o,s,l;for(s=0,o=0,l=(e=""+e).length;0<=l?o<l:o>l;o=0<=l?++o:--o)i=e.charCodeAt(o),s+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return s*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t}();var Ro,Da=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,i;for(i=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(e.charCodeAt(r)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,i,o,s,l,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),o=this.readByte(),s=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^o)+65536*(255^s)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*i+16777216*o+65536*s+256*l+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,i,o;for(o=[],n=0,i=e.length;n<i;n++)r=e[n],o.push(this.writeByte(r));return o},t}(),r7=function(){var t;function e(r){var n,i,o;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,o=this.tableCount;0<=o?i<o:i>o;i=0<=o?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,i,o,s,l,c,u,h,y,g,f,x,S;for(S in f=Object.keys(r).length,c=Math.log(2),y=16*Math.floor(Math.log(f)/c),s=Math.floor(y/c),h=16*f-y,(i=new Da).writeInt(this.scalarType),i.writeShort(f),i.writeShort(y),i.writeShort(s),i.writeShort(h),o=16*f,u=i.pos+o,l=null,x=[],r)for(g=r[S],i.writeString(S),i.writeInt(t(g)),i.writeInt(u),i.writeInt(g.length),x=x.concat(g),S==="head"&&(l=u),u+=g.length;u%4;)x.push(0),u++;return i.write(x),n=2981146554-t(i.data),i.pos=l+8,i.writeUInt32(n),i.data},t=function(r){var n,i,o,s;for(r=n_.call(r);r.length%4;)r.push(0);for(o=new Da(r),i=0,n=0,s=r.length;n<s;n=n+=4)i+=o.readUInt32();return 4294967295&i},e}(),n7={}.hasOwnProperty,os=function(t,e){for(var r in e)n7.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Ro=function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var i7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return os(e,Ro),e.prototype.tag="head",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},e.prototype.encode=function(r){var n;return(n=new Da).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(r),n.writeShort(this.glyphDataFormat),n.data},e}(),ob=function(){function t(e,r){var n,i,o,s,l,c,u,h,y,g,f,x,S,w,E,q,ee;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),y=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(f=e.readUInt16(),g=f/2,e.pos+=6,o=function(){var W,K;for(K=[],c=W=0;0<=g?W<g:W>g;c=0<=g?++W:--W)K.push(e.readUInt16());return K}(),e.pos+=2,S=function(){var W,K;for(K=[],c=W=0;0<=g?W<g:W>g;c=0<=g?++W:--W)K.push(e.readUInt16());return K}(),u=function(){var W,K;for(K=[],c=W=0;0<=g?W<g:W>g;c=0<=g?++W:--W)K.push(e.readUInt16());return K}(),h=function(){var W,K;for(K=[],c=W=0;0<=g?W<g:W>g;c=0<=g?++W:--W)K.push(e.readUInt16());return K}(),i=(this.length-e.pos+this.offset)/2,l=function(){var W,K;for(K=[],c=W=0;0<=i?W<i:W>i;c=0<=i?++W:--W)K.push(e.readUInt16());return K}(),c=E=0,ee=o.length;E<ee;c=++E)for(w=o[c],n=q=x=S[c];x<=w?q<=w:q>=w;n=x<=w?++q:--q)h[c]===0?s=n+u[c]:(s=l[h[c]/2+(n-x)-(g-c)]||0)!==0&&(s+=u[c]),this.codeMap[n]=65535&s}e.pos=y}return t.encode=function(e,r){var n,i,o,s,l,c,u,h,y,g,f,x,S,w,E,q,ee,W,K,te,$,C,T,O,b,P,_,z,Z,k,F,X,U,B,ce,L,D,j,I,M,J,H,Q,se,G,re;switch(z=new Da,s=Object.keys(e).sort(function(oe,fe){return oe-fe}),r){case"macroman":for(S=0,w=function(){var oe=[];for(x=0;x<256;++x)oe.push(0);return oe}(),q={0:0},o={},Z=0,U=s.length;Z<U;Z++)q[Q=e[i=s[Z]]]==null&&(q[Q]=++S),o[i]={old:e[i],new:q[e[i]]},w[i]=q[e[i]];return z.writeUInt16(1),z.writeUInt16(0),z.writeUInt32(12),z.writeUInt16(0),z.writeUInt16(262),z.writeUInt16(0),z.write(w),{charMap:o,subtable:z.data,maxGlyphID:S+1};case"unicode":for(P=[],y=[],ee=0,q={},n={},E=u=null,k=0,B=s.length;k<B;k++)q[K=e[i=s[k]]]==null&&(q[K]=++ee),n[i]={old:K,new:q[K]},l=q[K]-i,E!=null&&l===u||(E&&y.push(E),P.push(i),u=l),E=i;for(E&&y.push(E),y.push(65535),P.push(65535),O=2*(T=P.length),C=2*Math.pow(Math.log(T)/Math.LN2,2),g=Math.log(C/2)/Math.LN2,$=2*T-C,c=[],te=[],f=[],x=F=0,ce=P.length;F<ce;x=++F){if(b=P[x],h=y[x],b===65535){c.push(0),te.push(0);break}if(b-(_=n[b].new)>=32768)for(c.push(0),te.push(2*(f.length+T-x)),i=X=b;b<=h?X<=h:X>=h;i=b<=h?++X:--X)f.push(n[i].new);else c.push(_-b),te.push(0)}for(z.writeUInt16(3),z.writeUInt16(1),z.writeUInt32(12),z.writeUInt16(4),z.writeUInt16(16+8*T+2*f.length),z.writeUInt16(0),z.writeUInt16(O),z.writeUInt16(C),z.writeUInt16(g),z.writeUInt16($),J=0,L=y.length;J<L;J++)i=y[J],z.writeUInt16(i);for(z.writeUInt16(0),H=0,D=P.length;H<D;H++)i=P[H],z.writeUInt16(i);for(se=0,j=c.length;se<j;se++)l=c[se],z.writeUInt16(l);for(G=0,I=te.length;G<I;G++)W=te[G],z.writeUInt16(W);for(re=0,M=f.length;re<M;re++)S=f[re],z.writeUInt16(S);return{charMap:n,subtable:z.data,maxGlyphID:ee+1}}},t}(),r_=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return os(e,Ro),e.prototype.tag="cmap",e.prototype.parse=function(r){var n,i,o;for(r.pos=this.offset,this.version=r.readUInt16(),o=r.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=o?i<o:i>o;i=0<=o?++i:--i)n=new ob(r,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},e.encode=function(r,n){var i,o;return n==null&&(n="macroman"),i=ob.encode(r,n),(o=new Da).writeUInt16(0),o.writeUInt16(1),i.table=o.data.concat(i.subtable),i},e}(),o7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return os(e,Ro),e.prototype.tag="hhea",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},e}(),s7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return os(e,Ro),e.prototype.tag="OS/2",e.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var n,i;for(i=[],n=0;n<10;++n)i.push(r.readByte());return i}(),this.charRange=function(){var n,i;for(i=[],n=0;n<4;++n)i.push(r.readInt());return i}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var n,i;for(i=[],n=0;n<2;n=++n)i.push(r.readInt());return i}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},e}(),a7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return os(e,Ro),e.prototype.tag="post",e.prototype.parse=function(r){var n,i,o;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var s;for(i=r.readUInt16(),this.glyphNameIndex=[],s=0;0<=i?s<i:s>i;s=0<=i?++s:--s)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],o=[];r.pos<this.offset+this.length;)n=r.readByte(),o.push(this.names.push(r.readString(n)));return o;case 151552:return i=r.readUInt16(),this.offsets=r.read(i);case 196608:break;case 262144:return this.map=function(){var l,c,u;for(u=[],s=l=0,c=this.file.maxp.numGlyphs;0<=c?l<c:l>c;s=0<=c?++l:--l)u.push(r.readUInt32());return u}.call(this)}},e}(),l7=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},c7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return os(e,Ro),e.prototype.tag="name",e.prototype.parse=function(r){var n,i,o,s,l,c,u,h,y,g,f;for(r.pos=this.offset,r.readShort(),n=r.readShort(),c=r.readShort(),i=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)i.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+c+r.readShort()});for(u={},s=y=0,g=i.length;y<g;s=++y)o=i[s],r.pos=o.offset,h=r.readString(o.length),l=new l7(h,o),u[f=o.nameID]==null&&(u[f]=[]),u[o.nameID].push(l);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},e}(),u7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return os(e,Ro),e.prototype.tag="maxp",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},e}(),d7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return os(e,Ro),e.prototype.tag="hmtx",e.prototype.parse=function(r){var n,i,o,s,l,c,u;for(r.pos=this.offset,this.metrics=[],n=0,c=this.file.hhea.numberOfMetrics;0<=c?n<c:n>c;n=0<=c?++n:--n)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(o=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var h,y;for(y=[],n=h=0;0<=o?h<o:h>o;n=0<=o?++h:--h)y.push(r.readInt16());return y}(),this.widths=function(){var h,y,g,f;for(f=[],h=0,y=(g=this.metrics).length;h<y;h++)s=g[h],f.push(s.advance);return f}.call(this),i=this.widths[this.widths.length-1],u=[],n=l=0;0<=o?l<o:l>o;n=0<=o?++l:--l)u.push(this.widths.push(i));return u},e.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},e}(),n_=[].slice,h7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return os(e,Ro),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(r){var n,i,o,s,l,c,u,h,y,g;return r in this.cache?this.cache[r]:(s=this.file.loca,n=this.file.contents,i=s.indexOf(r),(o=s.lengthOf(r))===0?this.cache[r]=null:(n.pos=this.offset+i,l=(c=new Da(n.read(o))).readShort(),h=c.readShort(),g=c.readShort(),u=c.readShort(),y=c.readShort(),this.cache[r]=l===-1?new f7(c,h,g,u,y):new p7(c,l,h,g,u,y),this.cache[r]))},e.prototype.encode=function(r,n,i){var o,s,l,c,u;for(l=[],s=[],c=0,u=n.length;c<u;c++)o=r[n[c]],s.push(l.length),o&&(l=l.concat(o.encode(i)));return s.push(l.length),{table:l,offsets:s}},e}(),p7=function(){function t(e,r,n,i,o,s){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=o,this.yMax=s,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),f7=function(){function t(e,r,n,i,o){var s,l;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=o,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;l=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&l;)s.pos+=1&l?4:2,128&l?s.pos+=8:64&l?s.pos+=4:8&l&&(s.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new Da(n_.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t}(),m7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return os(e,Ro),e.prototype.tag="loca",e.prototype.parse=function(r){var n,i;return r.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?function(){var o,s;for(s=[],i=0,o=this.length;i<o;i+=2)s.push(2*r.readUInt16());return s}.call(this):function(){var o,s;for(s=[],i=0,o=this.length;i<o;i+=4)s.push(r.readUInt32());return s}.call(this)},e.prototype.indexOf=function(r){return this.offsets[r]},e.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},e.prototype.encode=function(r,n){for(var i=new Uint32Array(this.offsets.length),o=0,s=0,l=0;l<i.length;++l)if(i[l]=o,s<n.length&&n[s]==l){++s,i[l]=o;var c=this.offsets[l],u=this.offsets[l+1]-c;u>0&&(o+=u)}for(var h=new Array(4*i.length),y=0;y<i.length;++y)h[4*y+3]=255&i[y],h[4*y+2]=(65280&i[y])>>8,h[4*y+1]=(16711680&i[y])>>16,h[4*y]=(4278190080&i[y])>>24;return h},e}(),y7=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,i,o;for(r in i=this.font.cmap.tables[0].codeMap,e={},o=this.subset)n=o[r],e[r]=i[n];return e},t.prototype.glyphsFor=function(e){var r,n,i,o,s,l,c;for(i={},s=0,l=e.length;s<l;s++)i[o=e[s]]=this.font.glyf.glyphFor(o);for(o in r=[],i)(n=i[o])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(o in c=this.glyphsFor(r))n=c[o],i[o]=n;return i},t.prototype.encode=function(e,r){var n,i,o,s,l,c,u,h,y,g,f,x,S,w,E;for(i in n=r_.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(e),f={0:0},E=n.charMap)f[(c=E[i]).old]=c.new;for(x in g=n.maxGlyphID,s)x in f||(f[x]=g++);return h=function(q){var ee,W;for(ee in W={},q)W[q[ee]]=ee;return W}(f),y=Object.keys(h).sort(function(q,ee){return q-ee}),S=function(){var q,ee,W;for(W=[],q=0,ee=y.length;q<ee;q++)l=y[q],W.push(h[l]);return W}(),o=this.font.glyf.encode(s,S,f),u=this.font.loca.encode(o.offsets,S),w={cmap:this.font.cmap.raw(),glyf:o.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(w["OS/2"]=this.font.os2.raw()),this.font.directory.encode(w)},t}();hr.API.PDFObject=function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,i,o,s;if(Array.isArray(r))return"["+function(){var l,c,u;for(u=[],l=0,c=r.length;l<c;l++)n=r[l],u.push(e.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in o=["<<"],r)s=r[i],o.push("/"+i+" "+e.convert(s));return o.push(">>"),o.join(`
`)}return""+r},e}();const i_=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:YL,AcroFormAppearance:Xt,AcroFormButton:zn,AcroFormCheckBox:Cu,AcroFormChoiceField:bl,AcroFormComboBox:Sl,AcroFormEditBox:xu,AcroFormListBox:_l,AcroFormPasswordField:Iu,AcroFormPushButton:Au,AcroFormRadioButton:Pl,AcroFormTextField:Ia,GState:Hu,ShadingPattern:va,TilingPattern:fl,default:hr,jsPDF:hr},Symbol.toStringTag,{value:"Module"}));function o_(t,e,r,n,i){n=n||{};var o=1.15,s=i.internal.scaleFactor,l=i.internal.getFontSize()/s,c=i.getLineHeightFactor?i.getLineHeightFactor():o,u=l*c,h=/\r\n|\r|\n/g,y="",g=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(y=typeof t=="string"?t.split(h):t,g=y.length||1),r+=l*(2-o),n.valign==="middle"?r-=g/2*u:n.valign==="bottom"&&(r-=g*u),n.halign==="center"||n.halign==="right"){var f=l;if(n.halign==="center"&&(f*=.5),y&&g>=1){for(var x=0;x<y.length;x++)i.text(y[x],e-i.getStringUnitWidth(y[x])*f,r),r+=u;return i}e-=i.getStringUnitWidth(t)*f}return n.halign==="justify"?i.text(t,e,r,{maxWidth:n.maxWidth||100,align:"justify"}):i.text(t,e,r),i}var sb={},bc=function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=e:sb=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,r){var n,i,o;r===void 0&&(r=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var s=this.jsPDFDocument.internal.getFont(),l=s.fontStyle,c=s.fontName;if(e.font&&(c=e.font),e.fontStyle){l=e.fontStyle;var u=this.getFontList()[c];u&&u.indexOf(l)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(u[0]),l=u[0])}if(this.jsPDFDocument.setFont(c,l),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!r){var h=t.unifyColor(e.fillColor);h&&(n=this.jsPDFDocument).setFillColor.apply(n,h),h=t.unifyColor(e.textColor),h&&(i=this.jsPDFDocument).setTextColor.apply(i,h),h=t.unifyColor(e.lineColor),h&&(o=this.jsPDFDocument).setDrawColor.apply(o,h),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,r,n){return this.jsPDFDocument.splitTextToSize(e,r,n)},t.prototype.rect=function(e,r,n,i,o){return this.jsPDFDocument.rect(e,r,n,i,o)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return sb||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t}(),Mm=function(t,e){return Mm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},Mm(t,e)};function s_(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Mm(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var a_=function(t){s_(e,t);function e(r){var n=t.call(this)||this;return n._element=r,n}return e}(Array);function g7(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function v7(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function Yh(t,e,r){r.applyStyles(e,!0);var n=Array.isArray(t)?t:[t],i=n.map(function(o){return r.getTextWidth(o)}).reduce(function(o,s){return Math.max(o,s)},0);return i}function l_(t,e,r,n){var i=e.settings.tableLineWidth,o=e.settings.tableLineColor;t.applyStyles({lineWidth:i,lineColor:o});var s=c_(i,!1);s&&t.rect(r.x,r.y,e.getWidth(t.pageSize().width),n.y-r.y,s)}function c_(t,e){var r=t>0,n=e||e===0;return r&&n?"DF":r?"S":n?"F":null}function Sp(t,e){var r,n,i,o;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(r=t.left)!==null&&r!==void 0?r:e,top:(n=t.top)!==null&&n!==void 0?n:e,right:(i=t.right)!==null&&i!==void 0?i:e,bottom:(o=t.bottom)!==null&&o!==void 0?o:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function u_(t,e){var r=Sp(e.settings.margin,0);return t.pageSize().width-(r.left+r.right)}function b7(t,e,r,n,i){var o={},s=1.3333333333333333,l=Nf(e,function(ee){return i.getComputedStyle(ee).backgroundColor});l!=null&&(o.fillColor=l);var c=Nf(e,function(ee){return i.getComputedStyle(ee).color});c!=null&&(o.textColor=c);var u=S7(n,r);u&&(o.cellPadding=u);var h="borderTopColor",y=s*r,g=n.borderTopWidth;if(n.borderBottomWidth===g&&n.borderRightWidth===g&&n.borderLeftWidth===g){var f=(parseFloat(g)||0)/y;f&&(o.lineWidth=f)}else o.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/y,right:(parseFloat(n.borderRightWidth)||0)/y,bottom:(parseFloat(n.borderBottomWidth)||0)/y,left:(parseFloat(n.borderLeftWidth)||0)/y},o.lineWidth.top||(o.lineWidth.right?h="borderRightColor":o.lineWidth.bottom?h="borderBottomColor":o.lineWidth.left&&(h="borderLeftColor"));var x=Nf(e,function(ee){return i.getComputedStyle(ee)[h]});x!=null&&(o.lineColor=x);var S=["left","right","center","justify"];S.indexOf(n.textAlign)!==-1&&(o.halign=n.textAlign),S=["middle","bottom","top"],S.indexOf(n.verticalAlign)!==-1&&(o.valign=n.verticalAlign);var w=parseInt(n.fontSize||"");isNaN(w)||(o.fontSize=w/s);var E=_7(n);E&&(o.fontStyle=E);var q=(n.fontFamily||"").toLowerCase();return t.indexOf(q)!==-1&&(o.font=q),o}function _7(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function Nf(t,e){var r=d_(t,e);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var i=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],o=parseInt(n[4]);return o===0||isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:i}function d_(t,e){var r=e(t);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?t.parentElement==null?null:d_(t.parentElement,e):r}function S7(t,e){var r=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],n=96/(72/e),i=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,o=r.map(function(l){return parseInt(l||"0")/n}),s=Sp(o,0);return i>s.top&&(s.top=i),i>s.bottom&&(s.bottom=i),s}function h_(t,e,r,n,i){var o,s;n===void 0&&(n=!1),i===void 0&&(i=!1);var l;typeof e=="string"?l=r.document.querySelector(e):l=e;var c=Object.keys(t.getFontList()),u=t.scaleFactor(),h=[],y=[],g=[];if(!l)return console.error("Html table could not be found with input: ",e),{head:h,body:y,foot:g};for(var f=0;f<l.rows.length;f++){var x=l.rows[f],S=(s=(o=x?.parentElement)===null||o===void 0?void 0:o.tagName)===null||s===void 0?void 0:s.toLowerCase(),w=P7(c,u,r,x,n,i);w&&(S==="thead"?h.push(w):S==="tfoot"?g.push(w):y.push(w))}return{head:h,body:y,foot:g}}function P7(t,e,r,n,i,o){for(var s=new a_(n),l=0;l<n.cells.length;l++){var c=n.cells[l],u=r.getComputedStyle(c);if(i||u.display!=="none"){var h=void 0;o&&(h=b7(t,c,e,u,r)),s.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:h,_element:c,content:w7(c)})}}var y=r.getComputedStyle(n);if(s.length>0&&(i||y.display!=="none"))return s}function w7(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),e.innerText||e.textContent||""}function x7(t,e,r){for(var n=0,i=[t,e,r];n<i.length;n++){var o=i[n];o&&typeof o!="object"&&console.error("The options parameter should be of type object, is: "+typeof o),o.startY&&typeof o.startY!="number"&&(console.error("Invalid value for startY option",o.startY),delete o.startY)}}function As(t,e,r,n,i){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(t),s=1;s<arguments.length;s++){var l=arguments[s];if(l!=null)for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(o[c]=l[c])}return o}function p_(t,e){var r=new bc(t),n=r.getDocumentOptions(),i=r.getGlobalOptions();x7(i,n,e);var o=As({},i,n,e),s;typeof window<"u"&&(s=window);var l=A7(i,n,e),c=C7(i,n,e),u=I7(r,o),h=E7(r,o,s);return{id:e.tableId,content:h,hooks:c,styles:l,settings:u}}function A7(t,e,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},i=function(c){if(c==="columnStyles"){var u=t[c],h=e[c],y=r[c];n.columnStyles=As({},u,h,y)}else{var g=[t,e,r],f=g.map(function(x){return x[c]||{}});n[c]=As({},f[0],f[1],f[2])}},o=0,s=Object.keys(n);o<s.length;o++){var l=s[o];i(l)}return n}function C7(t,e,r){for(var n=[t,e,r],i={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},o=0,s=n;o<s.length;o++){var l=s[o];l.didParseCell&&i.didParseCell.push(l.didParseCell),l.willDrawCell&&i.willDrawCell.push(l.willDrawCell),l.didDrawCell&&i.didDrawCell.push(l.didDrawCell),l.willDrawPage&&i.willDrawPage.push(l.willDrawPage),l.didDrawPage&&i.didDrawPage.push(l.didDrawPage)}return i}function I7(t,e){var r,n,i,o,s,l,c,u,h,y,g,f,x=Sp(e.margin,40/t.scaleFactor()),S=(r=$7(t,e.startY))!==null&&r!==void 0?r:x.top,w;e.showFoot===!0?w="everyPage":e.showFoot===!1?w="never":w=(n=e.showFoot)!==null&&n!==void 0?n:"everyPage";var E;e.showHead===!0?E="everyPage":e.showHead===!1?E="never":E=(i=e.showHead)!==null&&i!==void 0?i:"everyPage";var q=(o=e.useCss)!==null&&o!==void 0?o:!1,ee=e.theme||(q?"plain":"striped"),W=!!e.horizontalPageBreak,K=(s=e.horizontalPageBreakRepeat)!==null&&s!==void 0?s:null;return{includeHiddenHtml:(l=e.includeHiddenHtml)!==null&&l!==void 0?l:!1,useCss:q,theme:ee,startY:S,margin:x,pageBreak:(c=e.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(u=e.rowPageBreak)!==null&&u!==void 0?u:"auto",tableWidth:(h=e.tableWidth)!==null&&h!==void 0?h:"auto",showHead:E,showFoot:w,tableLineWidth:(y=e.tableLineWidth)!==null&&y!==void 0?y:0,tableLineColor:(g=e.tableLineColor)!==null&&g!==void 0?g:200,horizontalPageBreak:W,horizontalPageBreakRepeat:K,horizontalPageBreakBehaviour:(f=e.horizontalPageBreakBehaviour)!==null&&f!==void 0?f:"afterAllRows"}}function $7(t,e){var r=t.getLastAutoTable(),n=t.scaleFactor(),i=t.pageNumber(),o=!1;if(r&&r.startPageNumber){var s=r.startPageNumber+r.pageNumber-1;o=s===i}return typeof e=="number"?e:(e==null||e===!1)&&o&&r?.finalY!=null?r.finalY+20/n:null}function E7(t,e,r){var n=e.head||[],i=e.body||[],o=e.foot||[];if(e.html){var s=e.includeHiddenHtml;if(r){var l=h_(t,e.html,r,s,e.useCss)||{};n=l.head||n,i=l.body||n,o=l.foot||n}else console.error("Cannot parse html in non browser environment")}var c=e.columns||T7(n,i,o);return{columns:c,head:n,body:i,foot:o}}function T7(t,e,r){var n=t[0]||e[0]||r[0]||[],i=[];return Object.keys(n).filter(function(o){return o!=="_element"}).forEach(function(o){var s=1,l;Array.isArray(n)?l=n[parseInt(o)]:l=n[o],typeof l=="object"&&!Array.isArray(l)&&(s=l?.colSpan||1);for(var c=0;c<s;c++){var u=void 0;Array.isArray(n)?u=i.length:u=o+(c>0?"_".concat(c):"");var h={dataKey:u};i.push(h)}}),i}var Fm=function(){function t(e,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=e.getDocument()}return t}(),k7=function(t){s_(e,t);function e(r,n,i,o,s,l){var c=t.call(this,r,n,l)||this;return c.cell=i,c.row=o,c.column=s,c.section=o.section,c}return e}(Fm),N7=function(){function t(e,r){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,r,n,i,o,s){for(var l=0,c=r;l<c.length;l++){var u=c[l],h=new k7(e,this,n,i,o,s),y=u(h)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],y)return!1}return!0},t.prototype.callEndPageHooks=function(e,r){e.applyStyles(e.userStyles);for(var n=0,i=this.hooks.didDrawPage;n<i.length;n++){var o=i[n];o(new Fm(e,this,r))}},t.prototype.callWillDrawPageHooks=function(e,r){for(var n=0,i=this.hooks.willDrawPage;n<i.length;n++){var o=i[n];o(new Fm(e,this,r))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(i,o){return i+o.wrappedWidth},0);return r}else{var n=this.settings.margin;return e-n.left-n.right}},t}(),f_=function(){function t(e,r,n,i,o){o===void 0&&(o=!1),this.height=0,this.raw=e,e instanceof a_&&(this.raw=e._element,this.element=e._element),this.index=r,this.section=n,this.cells=i,this.spansMultiplePages=o}return t.prototype.getMaxCellHeight=function(e){var r=this;return e.reduce(function(n,i){var o;return Math.max(n,((o=r.cells[i.index])===null||o===void 0?void 0:o.height)||0)},0)},t.prototype.hasRowSpan=function(e){var r=this;return e.filter(function(n){var i=r.cells[n.index];return i?i.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,r){return this.getMaxCellHeight(r)<=e},t.prototype.getMinimumRowHeight=function(e,r){var n=this;return e.reduce(function(i,o){var s=n.cells[o.index];if(!s)return 0;var l=r.getLineHeight(s.styles.fontSize),c=s.padding("vertical"),u=c+l;return u>i?u:i},0)},t}(),m_=function(){function t(e,r,n){var i;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=e;var o=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,o=(i=e.content)!==null&&i!==void 0?i:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var s=o!=null?""+o:"",l=/\r\n|\r|\n/g;this.text=s.split(l)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");e=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var i=this.width-this.padding("horizontal");n=this.x+i/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:e}},t.prototype.getContentHeight=function(e,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,i=this.styles.fontSize/e*r,o=n*i+this.padding("vertical");return Math.max(o,this.styles.minCellHeight)},t.prototype.padding=function(e){var r=Sp(this.styles.cellPadding,0);return e==="vertical"?r.top+r.bottom:e==="horizontal"?r.left+r.right:r[e]},t}(),L7=function(){function t(e,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=r,this.index=n}return t.prototype.getMaxCustomCellWidth=function(e){for(var r=0,n=0,i=e.allRows();n<i.length;n++){var o=i[n],s=o.cells[this.index];s&&typeof s.styles.cellWidth=="number"&&(r=Math.max(r,s.styles.cellWidth))}return r},t}();function R7(t,e){D7(t,e);var r=[],n=0;e.columns.forEach(function(o){var s=o.getMaxCustomCellWidth(e);s?o.width=s:(o.width=o.wrappedWidth,r.push(o)),n+=o.width});var i=e.getWidth(t.pageSize().width)-n;i&&(i=Om(r,i,function(o){return Math.max(o.minReadableWidth,o.minWidth)})),i&&(i=Om(r,i,function(o){return o.minWidth})),i=Math.abs(i),!e.settings.horizontalPageBreak&&i>.1/t.scaleFactor()&&(i=i<1?i:Math.round(i),console.warn("Of the table content, ".concat(i," units width could not fit page"))),F7(e),O7(e,t),M7(e)}function D7(t,e){var r=t.scaleFactor(),n=e.settings.horizontalPageBreak,i=u_(t,e);e.allRows().forEach(function(o){for(var s=0,l=e.columns;s<l.length;s++){var c=l[s],u=o.cells[c.index];if(u){var h=e.hooks.didParseCell;e.callCellHooks(t,h,u,o,c,null);var y=u.padding("horizontal");u.contentWidth=Yh(u.text,u.styles,t)+y;var g=Yh(u.text.join(" ").split(/[^\S\u00A0]+/),u.styles,t);if(u.minReadableWidth=g+u.padding("horizontal"),typeof u.styles.cellWidth=="number")u.minWidth=u.styles.cellWidth,u.wrappedWidth=u.styles.cellWidth;else if(u.styles.cellWidth==="wrap"||n===!0)u.contentWidth>i?(u.minWidth=i,u.wrappedWidth=i):(u.minWidth=u.contentWidth,u.wrappedWidth=u.contentWidth);else{var f=10/r;u.minWidth=u.styles.minCellWidth||f,u.wrappedWidth=u.contentWidth,u.minWidth>u.wrappedWidth&&(u.wrappedWidth=u.minWidth)}}}}),e.allRows().forEach(function(o){for(var s=0,l=e.columns;s<l.length;s++){var c=l[s],u=o.cells[c.index];if(u&&u.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,u.wrappedWidth),c.minWidth=Math.max(c.minWidth,u.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,u.minReadableWidth);else{var h=e.styles.columnStyles[c.dataKey]||e.styles.columnStyles[c.index]||{},y=h.cellWidth||h.minCellWidth;y&&typeof y=="number"&&(c.minWidth=y,c.wrappedWidth=y)}u&&(u.colSpan>1&&!c.minWidth&&(c.minWidth=u.minWidth),u.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=u.minWidth))}})}function Om(t,e,r){for(var n=e,i=t.reduce(function(f,x){return f+x.wrappedWidth},0),o=0;o<t.length;o++){var s=t[o],l=s.wrappedWidth/i,c=n*l,u=s.width+c,h=r(s),y=u<h?h:u;e-=y-s.width,s.width=y}if(e=Math.round(e*1e10)/1e10,e){var g=t.filter(function(f){return e<0?f.width>r(f):!0});g.length&&(e=Om(g,e,r))}return e}function M7(t){for(var e={},r=1,n=t.allRows(),i=0;i<n.length;i++)for(var o=n[i],s=0,l=t.columns;s<l.length;s++){var c=l[s],u=e[c.index];if(r>1)r--,delete o.cells[c.index];else if(u)u.cell.height+=o.height,r=u.cell.colSpan,delete o.cells[c.index],u.left--,u.left<=1&&delete e[c.index];else{var h=o.cells[c.index];if(!h)continue;if(h.height=o.height,h.rowSpan>1){var y=n.length-i,g=h.rowSpan>y?y:h.rowSpan;e[c.index]={cell:h,left:g,row:o}}}}}function F7(t){for(var e=t.allRows(),r=0;r<e.length;r++)for(var n=e[r],i=null,o=0,s=0,l=0;l<t.columns.length;l++){var c=t.columns[l];if(s-=1,s>1&&t.columns[l+1])o+=c.width,delete n.cells[c.index];else if(i){var u=i;delete n.cells[c.index],i=null,u.width=c.width+o}else{var u=n.cells[c.index];if(!u)continue;if(s=u.colSpan,o=0,u.colSpan>1){i=u,o+=c.width;continue}u.width=c.width+o}}}function O7(t,e){for(var r={count:0,height:0},n=0,i=t.allRows();n<i.length;n++){for(var o=i[n],s=0,l=t.columns;s<l.length;s++){var c=l[s],u=o.cells[c.index];if(u){e.applyStyles(u.styles,!0);var h=u.width-u.padding("horizontal");if(u.styles.overflow==="linebreak")u.text=e.splitTextToSize(u.text,h+1/e.scaleFactor(),{fontSize:u.styles.fontSize});else if(u.styles.overflow==="ellipsize")u.text=ab(u.text,h,u.styles,e,"...");else if(u.styles.overflow==="hidden")u.text=ab(u.text,h,u.styles,e,"");else if(typeof u.styles.overflow=="function"){var y=u.styles.overflow(u.text,h);typeof y=="string"?u.text=[y]:u.text=y}u.contentHeight=u.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var g=u.contentHeight/u.rowSpan;u.rowSpan>1&&r.count*r.height<g*u.rowSpan?r={height:g,count:u.rowSpan}:r&&r.count>0&&r.height>g&&(g=r.height),g>o.height&&(o.height=g)}}r.count--}}function ab(t,e,r,n,i){return t.map(function(o){return B7(o,e,r,n,i)})}function B7(t,e,r,n,i){var o=1e4*n.scaleFactor();if(e=Math.ceil(e*o)/o,e>=Yh(t,r,n))return t;for(;e<Yh(t+i,r,n)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+i}function y_(t,e){var r=new bc(t),n=j7(e,r.scaleFactor()),i=new N7(e,n);return R7(r,i),r.applyStyles(r.userStyles),i}function j7(t,e){var r=t.content,n=q7(r.columns);if(r.head.length===0){var i=lb(n,"head");i&&r.head.push(i)}if(r.foot.length===0){var i=lb(n,"foot");i&&r.foot.push(i)}var o=t.settings.theme,s=t.styles;return{columns:n,head:Lf("head",r.head,n,s,o,e),body:Lf("body",r.body,n,s,o,e),foot:Lf("foot",r.foot,n,s,o,e)}}function Lf(t,e,r,n,i,o){var s={},l=e.map(function(c,u){for(var h=0,y={},g=0,f=0,x=0,S=r;x<S.length;x++){var w=S[x];if(s[w.index]==null||s[w.index].left===0)if(f===0){var E=void 0;Array.isArray(c)?E=c[w.index-g-h]:E=c[w.dataKey];var q={};typeof E=="object"&&!Array.isArray(E)&&(q=E?.styles||{});var ee=z7(t,w,u,i,n,o,q),W=new m_(E,ee,t);y[w.dataKey]=W,y[w.index]=W,f=W.colSpan-1,s[w.index]={left:W.rowSpan-1,times:f}}else f--,g++;else s[w.index].left--,f=s[w.index].times,h++}return new f_(c,u,t,y)});return l}function lb(t,e){var r={};return t.forEach(function(n){if(n.raw!=null){var i=V7(e,n.raw);i!=null&&(r[n.dataKey]=i)}}),Object.keys(r).length>0?r:null}function V7(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function q7(t){return t.map(function(e,r){var n,i;return typeof e=="object"?i=(n=e.dataKey)!==null&&n!==void 0?n:r:i=r,new L7(i,e,r)})}function z7(t,e,r,n,i,o,s){var l=v7(n),c;t==="head"?c=i.headStyles:t==="body"?c=i.bodyStyles:t==="foot"&&(c=i.footStyles);var u=As({},l.table,l[t],i.styles,c),h=i.columnStyles[e.dataKey]||i.columnStyles[e.index]||{},y=t==="body"?h:{},g=t==="body"&&r%2===0?As({},l.alternateRow,i.alternateRowStyles):{},f=g7(o),x=As({},f,u,g,y);return As(x,s)}function U7(t,e,r){var n;r===void 0&&(r={});var i=u_(t,e),o=new Map,s=[],l=[],c=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?c=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(c=[e.settings.horizontalPageBreakRepeat]),c.forEach(function(g){var f=e.columns.find(function(x){return x.dataKey===g||x.index===g});f&&!o.has(f.index)&&(o.set(f.index,!0),s.push(f.index),l.push(e.columns[f.index]),i-=f.wrappedWidth)});for(var u=!0,h=(n=r?.start)!==null&&n!==void 0?n:0;h<e.columns.length;){if(o.has(h)){h++;continue}var y=e.columns[h].wrappedWidth;if(u||i>=y)u=!1,s.push(h),l.push(e.columns[h]),i-=y;else break;h++}return{colIndexes:s,columns:l,lastIndex:h-1}}function H7(t,e){for(var r=[],n=0;n<e.columns.length;n++){var i=U7(t,e,{start:n});i.columns.length&&(r.push(i),n=i.lastIndex)}return r}function g_(t,e){var r=e.settings,n=r.startY,i=r.margin,o={x:i.left,y:n},s=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),l=n+i.bottom+s;if(r.pageBreak==="avoid"){var c=e.body,u=c.reduce(function(g,f){return g+f.height},0);l+=u}var h=new bc(t);(r.pageBreak==="always"||r.startY!=null&&l>h.pageSize().height)&&(b_(h),o.y=i.top),e.callWillDrawPageHooks(h,o);var y=As({},o);e.startPageNumber=h.pageNumber(),r.horizontalPageBreak?G7(h,e,y,o):(h.applyStyles(h.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&e.head.forEach(function(g){return Ls(h,e,g,o,e.columns)}),h.applyStyles(h.userStyles),e.body.forEach(function(g,f){var x=f===e.body.length-1;Kh(h,e,g,x,y,o,e.columns)}),h.applyStyles(h.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&e.foot.forEach(function(g){return Ls(h,e,g,o,e.columns)})),l_(h,e,y,o),e.callEndPageHooks(h,o),e.finalY=o.y,t.lastAutoTable=e,h.applyStyles(h.userStyles)}function G7(t,e,r,n){var i=H7(t,e),o=e.settings;if(o.horizontalPageBreakBehaviour==="afterAllRows")i.forEach(function(u,h){t.applyStyles(t.userStyles),h>0?$u(t,e,r,n,u.columns,!0):cb(t,e,n,u.columns),W7(t,e,r,n,u.columns),Rf(t,e,n,u.columns)});else for(var s=-1,l=i[0],c=function(){var u=s;if(l){t.applyStyles(t.userStyles);var h=l.columns;s>=0?$u(t,e,r,n,h,!0):cb(t,e,n,h),u=ub(t,e,s+1,n,h),Rf(t,e,n,h)}var y=u-s;i.slice(1).forEach(function(g){t.applyStyles(t.userStyles),$u(t,e,r,n,g.columns,!0),ub(t,e,s+1,n,g.columns,y),Rf(t,e,n,g.columns)}),s=u};s<e.body.length-1;)c()}function cb(t,e,r,n){var i=e.settings;t.applyStyles(t.userStyles),(i.showHead==="firstPage"||i.showHead==="everyPage")&&e.head.forEach(function(o){return Ls(t,e,o,r,n)})}function W7(t,e,r,n,i){t.applyStyles(t.userStyles),e.body.forEach(function(o,s){var l=s===e.body.length-1;Kh(t,e,o,l,r,n,i)})}function ub(t,e,r,n,i,o){t.applyStyles(t.userStyles),o=o??e.body.length;var s=Math.min(r+o,e.body.length),l=-1;return e.body.slice(r,s).forEach(function(c,u){var h=r+u===e.body.length-1,y=v_(t,e,h,n);c.canEntireRowFit(y,i)&&(Ls(t,e,c,n,i),l=r+u)}),l}function Rf(t,e,r,n){var i=e.settings;t.applyStyles(t.userStyles),(i.showFoot==="lastPage"||i.showFoot==="everyPage")&&e.foot.forEach(function(o){return Ls(t,e,o,r,n)})}function Y7(t,e,r){var n=r.getLineHeight(t.styles.fontSize),i=t.padding("vertical"),o=Math.floor((e-i)/n);return Math.max(0,o)}function K7(t,e,r,n){var i={};t.spansMultiplePages=!0,t.height=0;for(var o=0,s=0,l=r.columns;s<l.length;s++){var c=l[s],u=t.cells[c.index];if(u){Array.isArray(u.text)||(u.text=[u.text]);var h=new m_(u.raw,u.styles,u.section);h=As(h,u),h.text=[];var y=Y7(u,e,n);u.text.length>y&&(h.text=u.text.splice(y,u.text.length));var g=n.scaleFactor(),f=n.getLineHeightFactor();u.contentHeight=u.getContentHeight(g,f),u.contentHeight>=e&&(u.contentHeight=e,h.styles.minCellHeight-=e),u.contentHeight>t.height&&(t.height=u.contentHeight),h.contentHeight=h.getContentHeight(g,f),h.contentHeight>o&&(o=h.contentHeight),i[c.index]=h}}var x=new f_(t.raw,-1,t.section,i,!0);x.height=o;for(var S=0,w=r.columns;S<w.length;S++){var c=w[S],h=x.cells[c.index];h&&(h.height=x.height);var u=t.cells[c.index];u&&(u.height=t.height)}return x}function J7(t,e,r,n){var i=t.pageSize().height,o=n.settings.margin,s=o.top+o.bottom,l=i-s;e.section==="body"&&(l-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=e.getMinimumRowHeight(n.columns,t),u=c<r;if(c>l)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!u)return!1;var h=e.hasRowSpan(n.columns),y=e.getMaxCellHeight(n.columns)>l;return y?(h&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(h||n.settings.rowPageBreak==="avoid")}function Kh(t,e,r,n,i,o,s){var l=v_(t,e,n,o);if(r.canEntireRowFit(l,s))Ls(t,e,r,o,s);else if(J7(t,r,l,e)){var c=K7(r,l,e,t);Ls(t,e,r,o,s),$u(t,e,i,o,s),Kh(t,e,c,n,i,o,s)}else $u(t,e,i,o,s),Kh(t,e,r,n,i,o,s)}function Ls(t,e,r,n,i){n.x=e.settings.margin.left;for(var o=0,s=i;o<s.length;o++){var l=s[o],c=r.cells[l.index];if(!c){n.x+=l.width;continue}t.applyStyles(c.styles),c.x=n.x,c.y=n.y;var u=e.callCellHooks(t,e.hooks.willDrawCell,c,r,l,n);if(u===!1){n.x+=l.width;continue}Q7(t,c,n);var h=c.getTextPos();o_(c.text,h.x,h.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,c,r,l,n),n.x+=l.width}n.y+=r.height}function Q7(t,e,r){var n=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof n.lineWidth=="number"){var i=c_(n.lineWidth,n.fillColor);i&&t.rect(e.x,r.y,e.width,e.height,i)}else typeof n.lineWidth=="object"&&(n.fillColor&&t.rect(e.x,r.y,e.width,e.height,"F"),X7(t,e,r,n.lineWidth))}function X7(t,e,r,n){var i,o,s,l;n.top&&(i=r.x,o=r.y,s=r.x+e.width,l=r.y,n.right&&(s+=.5*n.right),n.left&&(i-=.5*n.left),c(n.top,i,o,s,l)),n.bottom&&(i=r.x,o=r.y+e.height,s=r.x+e.width,l=r.y+e.height,n.right&&(s+=.5*n.right),n.left&&(i-=.5*n.left),c(n.bottom,i,o,s,l)),n.left&&(i=r.x,o=r.y,s=r.x,l=r.y+e.height,n.top&&(o-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.left,i,o,s,l)),n.right&&(i=r.x+e.width,o=r.y,s=r.x+e.width,l=r.y+e.height,n.top&&(o-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.right,i,o,s,l));function c(u,h,y,g,f){t.getDocument().setLineWidth(u),t.getDocument().line(h,y,g,f,"S")}}function v_(t,e,r,n){var i=e.settings.margin.bottom,o=e.settings.showFoot;return(o==="everyPage"||o==="lastPage"&&r)&&(i+=e.getFootHeight(e.columns)),t.pageSize().height-n.y-i}function $u(t,e,r,n,i,o){i===void 0&&(i=[]),o===void 0&&(o=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!o&&e.foot.forEach(function(l){return Ls(t,e,l,n,i)}),e.callEndPageHooks(t,n);var s=e.settings.margin;l_(t,e,r,n),b_(t),e.pageNumber++,n.x=s.left,n.y=s.top,r.y=s.top,e.callWillDrawPageHooks(t,n),e.settings.showHead==="everyPage"&&(e.head.forEach(function(l){return Ls(t,e,l,n,i)}),t.applyStyles(t.userStyles))}function b_(t){var e=t.pageNumber();t.setPage(e+1);var r=t.pageNumber();return r===e?(t.addPage(),!0):!1}function Z7(t){t.API.autoTable=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=e[0],i=p_(this,n),o=y_(this,i);return g_(this,o),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,r,n,i){o_(e,r,n,i,this)},t.API.autoTableSetDefaults=function(e){return bc.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,r){bc.setDefaults(e,r)},t.API.autoTableHtmlToJson=function(e,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var i=new bc(this),o=h_(i,e,window,r,!1),s=o.head,l=o.body,c=((n=s[0])===null||n===void 0?void 0:n.map(function(u){return u.content}))||[];return{columns:c,rows:l,data:l}}}var Df;function U8(t,e){var r=p_(t,e),n=y_(t,r);g_(t,n)}try{if(typeof window<"u"&&window){var db=window,hb=db.jsPDF||((Df=db.jspdf)===null||Df===void 0?void 0:Df.jsPDF);hb&&Z7(hb)}}catch(t){console.error("Could not apply autoTable plugin",t)}var eR=he("<div><div><label></label><select><option value=all></option></select></div><div><label></label><select><option value=all></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label></label></div><div><label>"),tR=he("<div><div><div></div></div><div><div> <!> <!> <!> </div><div>"),rR=he("<div><div>"),Zd=he("<option>"),nR=he("<div><div><div><div></div><div></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div></div><div><div></div><div></div></div></div><div><div><span>: </span><span></span></div><div><span>: </span><span></span></div><div><span>: </span><span></span></div><div><span>: </span><span> kg</span></div><div><span>: </span><span></span></div><div><span>: </span><span>");const iR=t=>{const{t:e}=or(),[r,n]=Ce(""),[i,o]=Ce("all"),[s,l]=Ce({start:"",end:""}),[c,u]=Ce(""),[h,y]=Ce(""),[g,f]=Ce(!1),[x,S]=Ce("all"),w=Mt(()=>{let b=t.hbls;var P="";if(r()&&(P+=r().toLowerCase()),r()){const _=r().toLowerCase();b=b.filter(z=>z.hbl.toLowerCase().includes(_)||z.idairguide.toLowerCase().includes(_)||z.nameshipper.toLowerCase().includes(_)||z.consigneeName.toLowerCase().includes(_)||z.namegood.toLowerCase().includes(_)||z.bagnumber.toLowerCase().includes(_)||z.cidentity.toLowerCase().includes(_))}return i()!=="all"&&(b=b.filter(_=>_.idguidestate===i())),x()!=="all"&&(b=b.filter(_=>_.idclasification===x())),(s().start||s().end)&&(b=b.filter(_=>{const z=new Date(_.datereserve),Z=s().start?new Date(s().start):new Date("1900-01-01"),k=s().end?new Date(s().end):new Date("2100-12-31");return z>=Z&&z<=k})),c()&&(b=b?.filter(_=>_.nameshipper.toLowerCase().includes(c().toLowerCase()))),h()&&(b=b?.filter(_=>_.consigneeName.toLowerCase().includes(h().toLowerCase()))),b=b?.sort((_,z)=>new Date(z.datereserve).getTime()-new Date(_.datereserve).getTime()),t.onFilterChange?.(b),b}),E=Mt(()=>{const b=new Set(t.hbls.map(P=>P.nameshipper));return Array.from(b).sort()}),q=Mt(()=>{const b=new Set(t.hbls.map(P=>P.consigneeName));return Array.from(b).sort()}),ee=Mt(()=>{const b=new Set(t.hbls.map(P=>P.idguidestate));return Array.from(b).sort()}),W=Mt(()=>{const b=new Set(t.hbls.map(P=>P.idclasification));return Array.from(b).sort()}),K=()=>{n(""),o("all"),l({start:"",end:""}),u(""),y(""),S("all")},te=()=>{const b=["HBL Number","Air Guide","Status","Classification","Shipper","Consignee","Identity","Phone","City","Commodity","Weight (kg)","Quantity","Bag Number","Reserve Date"],P=w().map(F=>[F.hbl,F.idairguide,F.idguidestate,F.idclasification,F.nameshipper,F.consigneeName,F.cidentity,F.phoneshipper,F.address.city,F.namegood,F.weight,F.quantity,F.bagnumber,new Date(F.datereserve).toLocaleDateString()]),_=[b.join(","),...P.map(F=>F.map(X=>`"${X}"`).join(","))].join(`
`),z=new Blob([_],{type:"text/csv"}),Z=URL.createObjectURL(z),k=document.createElement("a");k.href=Z,k.download=`HBL_List_${new Date().toISOString().split("T")[0]}.csv`,k.click(),URL.revokeObjectURL(Z)},$=()=>{const b=["HBL Number","Air Guide","Air Number","Status","Classification","Shipper","Consignee","Identity","Shipper Phone","Consignee Phone","Street","City","State","Commodity","Weight (kg)","Quantity","Bag Number","Agency","Guide","Reserve Date"];w().map(F=>[F.hbl,F.idairguide,F.idairnumber,F.idguidestate,F.idclasification,F.nameshipper,F.consigneeName,F.cidentity,F.phoneshipper,F.ctelephone,F.street,F.address.city,F.address.estate,F.namegood,F.weight,F.quantity,F.bagnumber,F.agency,F.guia,new Date(F.datereserve).toLocaleDateString()]);const P=w().map(F=>[F.hbl,F.idclasification,F.idairguide,F.idairnumber,F.idguidestate,F.nameshipper,F.consigneeName,F.cidentity,F.phoneshipper,F.ctelephone,F.street,F.address.city,F.address.estate,F.namegood,F.weight,F.quantity,F.bagnumber,F.agency,F.guia,new Date(F.datereserve).toLocaleDateString()]),_=[b.join("	"),...P.map(F=>F.join("	"))].join(`
`),z=new Blob([_],{type:"application/vnd.ms-excel"}),Z=URL.createObjectURL(z),k=document.createElement("a");k.href=Z,k.download=`HBL_List_${new Date().toISOString().split("T")[0]}.xls`,k.click(),URL.revokeObjectURL(Z)},C=()=>{const b=new hr;b.setFontSize(16),b.text("House Bill of Lading List",14,15),b.setFontSize(10),b.text(`Generated: ${new Date().toLocaleString()}`,14,25),b.setFontSize(10);let P=35;r()&&(b.text(`Search: ${r()}`,14,P),P+=5),i()!=="all"&&(b.text(`Status: ${i()}`,14,P),P+=5);const _=["HBL#","Status","Shipper","Consignee","City","Weight","Commodity"],z=w().map(Z=>[Z.hbl,Z.idguidestate,Z.nameshipper.substring(0,20)+(Z.nameshipper.length>20?"...":""),Z.consigneeName.substring(0,20)+(Z.consigneeName.length>20?"...":""),Z.address.city,Z.weight+" kg",Z.namegood.substring(0,15)+(Z.namegood.length>15?"...":"")]);b.autoTable({head:[_],body:z,startY:P+5,styles:{fontSize:8},headStyles:{fillColor:[0,123,255]}}),b.save(`HBL_List_${new Date().toISOString().split("T")[0]}.pdf`)},T=b=>b?new Date(b).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-",O=b=>({"EN BODEGA":"#17a2b8",ENVIADO:"#007bff",ENTREGADO:"#28a745",CANCELADO:"#dc3545",PENDIENTE:"#ffc107"})[b]||"#6c757d";return(()=>{var b=rR(),P=b.firstChild;return a(b,R(Ot,{get children(){var _=tR(),z=_.firstChild,Z=z.firstChild,k=z.nextSibling,F=k.firstChild,X=F.firstChild,U=X.nextSibling,B=U.nextSibling,ce=B.nextSibling,L=ce.nextSibling,D=L.nextSibling;D.nextSibling;var j=F.nextSibling;return _.style.setProperty("padding","1rem"),z.style.setProperty("display","grid"),z.style.setProperty("grid-template-columns","1fr auto"),z.style.setProperty("gap","1rem"),z.style.setProperty("margin-bottom","1rem"),a(z,R($r,{type:"text",get placeholder(){return e("hbl.searchPlaceholder","Search by HBL#, air guide, shipper, consignee, commodity, bag#, identity...")},get value(){return r()},onInput:I=>n(I.currentTarget.value)}),Z),Z.style.setProperty("display","flex"),Z.style.setProperty("gap","0.5rem"),a(Z,R(ht,{variant:"outline",size:"sm",onClick:()=>f(!g()),get children(){return Ee(()=>!!g())()?e("common.hideFilters","Hide Filters"):e("common.showFilters","Show Filters")}}),null),a(Z,R(ht,{variant:"outline",size:"sm",onClick:K,get children(){return e("common.clearFilters","Clear Filters")}}),null),a(_,R(ze,{get when(){return g()},get children(){var I=eR(),M=I.firstChild,J=M.firstChild,H=J.nextSibling,Q=H.firstChild,se=M.nextSibling,G=se.firstChild,re=G.nextSibling,oe=re.firstChild,fe=se.nextSibling,ae=fe.firstChild,Y=ae.nextSibling,ie=Y.firstChild,de=fe.nextSibling,ue=de.firstChild,ge=ue.nextSibling,Pe=ge.firstChild,pe=de.nextSibling,_e=pe.firstChild,Le=pe.nextSibling,De=Le.firstChild;return I.style.setProperty("display","grid"),I.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),I.style.setProperty("gap","1rem"),I.style.setProperty("margin-bottom","1rem"),I.style.setProperty("padding","1rem"),I.style.setProperty("background","var(--background-color)"),I.style.setProperty("border-radius","var(--border-radius-sm)"),J.style.setProperty("display","block"),J.style.setProperty("margin-bottom","0.25rem"),J.style.setProperty("font-size","0.875rem"),J.style.setProperty("color","var(--text-muted)"),a(J,()=>e("common.status","Status")),H.addEventListener("change",Te=>o(Te.currentTarget.value)),H.style.setProperty("width","100%"),H.style.setProperty("padding","0.5rem"),H.style.setProperty("border","1px solid var(--border-color)"),H.style.setProperty("border-radius","var(--border-radius-sm)"),H.style.setProperty("background","var(--surface-color)"),a(Q,()=>e("common.all","All")),a(H,R(Ut,{get each(){return ee()},children:Te=>(()=>{var $e=Zd();return $e.value=Te,a($e,Te),$e})()}),null),G.style.setProperty("display","block"),G.style.setProperty("margin-bottom","0.25rem"),G.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","var(--text-muted)"),a(G,()=>e("hbl.classification","Classification")),re.addEventListener("change",Te=>S(Te.currentTarget.value)),re.style.setProperty("width","100%"),re.style.setProperty("padding","0.5rem"),re.style.setProperty("border","1px solid var(--border-color)"),re.style.setProperty("border-radius","var(--border-radius-sm)"),re.style.setProperty("background","var(--surface-color)"),a(oe,()=>e("common.all","All")),a(re,R(Ut,{get each(){return W()},children:Te=>(()=>{var $e=Zd();return $e.value=Te,a($e,Te),$e})()}),null),ae.style.setProperty("display","block"),ae.style.setProperty("margin-bottom","0.25rem"),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),a(ae,()=>e("hbl.shipper","Shipper")),Y.addEventListener("change",Te=>u(Te.currentTarget.value)),Y.style.setProperty("width","100%"),Y.style.setProperty("padding","0.5rem"),Y.style.setProperty("border","1px solid var(--border-color)"),Y.style.setProperty("border-radius","var(--border-radius-sm)"),Y.style.setProperty("background","var(--surface-color)"),a(ie,()=>e("common.all","All")),a(Y,R(Ut,{get each(){return E()},children:Te=>(()=>{var $e=Zd();return $e.value=Te,a($e,Te),$e})()}),null),ue.style.setProperty("display","block"),ue.style.setProperty("margin-bottom","0.25rem"),ue.style.setProperty("font-size","0.875rem"),ue.style.setProperty("color","var(--text-muted)"),a(ue,()=>e("hbl.consignee","Consignee")),ge.addEventListener("change",Te=>y(Te.currentTarget.value)),ge.style.setProperty("width","100%"),ge.style.setProperty("padding","0.5rem"),ge.style.setProperty("border","1px solid var(--border-color)"),ge.style.setProperty("border-radius","var(--border-radius-sm)"),ge.style.setProperty("background","var(--surface-color)"),a(Pe,()=>e("common.all","All")),a(ge,R(Ut,{get each(){return q()},children:Te=>(()=>{var $e=Zd();return $e.value=Te,a($e,Te),$e})()}),null),_e.style.setProperty("display","block"),_e.style.setProperty("margin-bottom","0.25rem"),_e.style.setProperty("font-size","0.875rem"),_e.style.setProperty("color","var(--text-muted)"),a(_e,()=>e("common.dateFrom","Date From")),a(pe,R($r,{type:"date",get value(){return s().start},onInput:Te=>l({...s(),start:Te.currentTarget.value})}),null),De.style.setProperty("display","block"),De.style.setProperty("margin-bottom","0.25rem"),De.style.setProperty("font-size","0.875rem"),De.style.setProperty("color","var(--text-muted)"),a(De,()=>e("common.dateTo","Date To")),a(Le,R($r,{type:"date",get value(){return s().end},onInput:Te=>l({...s(),end:Te.currentTarget.value})}),null),Se(()=>H.value=i()),Se(()=>re.value=x()),Se(()=>Y.value=c()),Se(()=>ge.value=h()),I}}),k),k.style.setProperty("display","flex"),k.style.setProperty("justify-content","space-between"),k.style.setProperty("align-items","center"),k.style.setProperty("margin-bottom","1rem"),F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-muted)"),a(F,()=>e("common.showing","Showing"),X),a(F,()=>w().length,U),a(F,()=>e("common.of","of"),ce),a(F,()=>t.hbls.length,D),a(F,()=>e("hbl.records","records"),null),j.style.setProperty("display","flex"),j.style.setProperty("gap","0.5rem"),a(j,R(ht,{variant:"outline",size:"sm",onClick:C,get children(){return e("common.print","Print")}}),null),a(j,R(ht,{variant:"outline",size:"sm",onClick:te,get children(){return e("common.exportCSV","Export CSV")}}),null),a(j,R(ht,{variant:"outline",size:"sm",onClick:$,get children(){return e("common.exportExcel","Export Excel")}}),null),_}}),P),P.style.setProperty("margin-top","1rem"),a(P,R(Ut,{get each(){return w()},children:_=>R(Ot,{style:{"margin-bottom":"0.5rem"},get children(){var z=nR(),Z=z.firstChild,k=Z.firstChild,F=k.firstChild,X=F.nextSibling,U=k.nextSibling,B=U.firstChild,ce=B.firstChild,L=ce.nextSibling,D=B.nextSibling,j=D.firstChild,I=j.nextSibling,M=U.nextSibling,J=M.firstChild,H=J.nextSibling,Q=Z.nextSibling,se=Q.firstChild,G=se.firstChild,re=G.firstChild,oe=G.nextSibling,fe=se.nextSibling,ae=fe.firstChild,Y=ae.firstChild,ie=ae.nextSibling,de=fe.nextSibling,ue=de.firstChild,ge=ue.firstChild,Pe=ue.nextSibling,pe=de.nextSibling,_e=pe.firstChild,Le=_e.firstChild,De=_e.nextSibling,Te=De.firstChild,$e=pe.nextSibling,Ie=$e.firstChild,Re=Ie.firstChild,Je=Ie.nextSibling,Be=$e.nextSibling,Ke=Be.firstChild,Xe=Ke.firstChild,at=Ke.nextSibling;return z.addEventListener("mouseleave",ot=>{ot.currentTarget.style.backgroundColor="transparent"}),z.addEventListener("mouseenter",ot=>{ot.currentTarget.style.backgroundColor="var(--strip-color)"}),z.$$click=()=>t.onHBLSelect?.(_),z.style.setProperty("padding","1rem"),z.style.setProperty("cursor","pointer"),z.style.setProperty("transition","background-color 0.2s"),Z.style.setProperty("display","grid"),Z.style.setProperty("grid-template-columns","150px 1fr auto"),Z.style.setProperty("gap","1rem"),Z.style.setProperty("align-items","center"),F.style.setProperty("font-weight","600"),F.style.setProperty("color","var(--primary-color)"),a(F,()=>_.hbl),X.style.setProperty("font-size","0.75rem"),X.style.setProperty("color","var(--text-muted)"),a(X,()=>_.idairguide),U.style.setProperty("display","grid"),U.style.setProperty("grid-template-columns","1fr 1fr"),U.style.setProperty("gap","1rem"),ce.style.setProperty("font-size","0.75rem"),ce.style.setProperty("color","var(--text-muted)"),a(ce,()=>e("hbl.shipper","Shipper")),L.style.setProperty("font-weight","500"),a(L,()=>_.nameshipper),j.style.setProperty("font-size","0.75rem"),j.style.setProperty("color","var(--text-muted)"),a(j,()=>e("hbl.consignee","Consignee")),I.style.setProperty("font-weight","500"),a(I,()=>_.consigneeName),M.style.setProperty("text-align","right"),J.style.setProperty("display","inline-block"),J.style.setProperty("padding","0.25rem 0.75rem"),J.style.setProperty("border-radius","var(--border-radius-sm)"),J.style.setProperty("font-size","0.75rem"),J.style.setProperty("font-weight","500"),J.style.setProperty("color","white"),a(J,()=>_.idguidestate),H.style.setProperty("font-size","0.75rem"),H.style.setProperty("color","var(--text-muted)"),H.style.setProperty("margin-top","0.25rem"),a(H,()=>T(_.datereserve)),Q.style.setProperty("margin-top","0.75rem"),Q.style.setProperty("display","grid"),Q.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),Q.style.setProperty("gap","0.5rem"),Q.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","var(--text-muted)"),a(G,()=>e("hbl.city","City"),re),oe.style.setProperty("font-weight","500"),a(oe,()=>_.address.city),ae.style.setProperty("color","var(--text-muted)"),a(ae,()=>e("hbl.classification","Class"),Y),ie.style.setProperty("font-weight","500"),a(ie,()=>_.idclasification),ue.style.setProperty("color","var(--text-muted)"),a(ue,()=>e("hbl.commodity","Commodity"),ge),Pe.style.setProperty("font-weight","500"),a(Pe,()=>_.namegood),_e.style.setProperty("color","var(--text-muted)"),a(_e,()=>e("hbl.weight","Weight"),Le),De.style.setProperty("font-weight","500"),a(De,()=>_.weight,Te),Ie.style.setProperty("color","var(--text-muted)"),a(Ie,()=>e("hbl.bagNumber","Bag#"),Re),Je.style.setProperty("font-weight","500"),a(Je,()=>_.bagnumber),Ke.style.setProperty("color","var(--text-muted)"),a(Ke,()=>e("hbl.guideNo","Guide No."),Xe),at.style.setProperty("font-weight","500"),a(at,()=>_.guia),Se(ot=>(ot=O(_.idguidestate))!=null?J.style.setProperty("background-color",ot):J.style.removeProperty("background-color")),z}})})),b})()};br(["click"]);var oR=he("<div><div><label></label><select><option value=all>"),sR=he("<div><div><h2>HBL: </h2><button>×</button></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong><span></span></div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> <!>, </div><div><strong>:</strong> </div><div><strong>:</strong> <!> kg</div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> "),aR=he("<div>"),lR=he("<div><div><h1></h1><button>"),cR=he("<option> ");const uR=()=>{const{t}=or(),[e,r]=Ce([]),[n,i]=Ce(null),[o,s]=Ce([]),[l,c]=Ce("all"),[u,h]=Ce(""),y=w=>{i(w)},g=w=>{s(w)},f=w=>{c(w),x()},x=async()=>{if(!u().trim())return null;let w=await vi.getHBLS(u().trim(),{guia:l()});w?.error?r([]):r(Object.values(w))};wn(()=>{});const S=Mt(()=>{const w=new Set([2516,2517,2518,2519,2520,2521].map(E=>E));return Array.from(w).sort((E,q)=>E-q)});return(()=>{var w=lR(),E=w.firstChild,q=E.firstChild,ee=q.nextSibling;return w.style.setProperty("padding","1rem"),E.style.setProperty("margin-bottom","2rem"),E.style.setProperty("display","flex"),E.style.setProperty("justify-content","space-between"),E.style.setProperty("align-items","center"),q.style.setProperty("font-size","1.5rem"),q.style.setProperty("font-weight","600"),q.style.setProperty("color","var(--text-primary)"),a(q,()=>t("hbl.title","House Bill of Lading Management")),ee.style.setProperty("padding","0.75rem 1.5rem"),ee.style.setProperty("background","var(--primary-color)"),ee.style.setProperty("color","white"),ee.style.setProperty("border","none"),ee.style.setProperty("border-radius","var(--border-radius-sm)"),ee.style.setProperty("cursor","pointer"),ee.style.setProperty("font-weight","500"),a(ee,()=>t("hbl.addNew","Add New HBL")),a(w,R(Ot,{get children(){var W=oR(),K=W.firstChild,te=K.firstChild,$=te.nextSibling,C=$.firstChild;return W.style.setProperty("padding","1rem"),K.style.setProperty("width","13rem"),te.style.setProperty("display","block"),te.style.setProperty("margin-bottom","0.25rem"),te.style.setProperty("font-size","0.875rem"),te.style.setProperty("color","var(--text-muted)"),a(te,()=>t("hbl.guideNumber","Guide Number")),$.addEventListener("change",T=>f(T.currentTarget.value)),$.style.setProperty("width","100%"),$.style.setProperty("padding","0.5rem"),$.style.setProperty("border","1px solid var(--border-color)"),$.style.setProperty("border-radius","var(--border-radius-sm)"),$.style.setProperty("background","var(--surface-color)"),a(C,()=>t("common.all","All")),a($,R(Ut,{get each(){return S()},children:T=>(()=>{var O=cR(),b=O.firstChild;return O.value=T,a(O,()=>t("hbl.guideNo","Guide No."),b),a(O,T,null),O})()}),null),a(W,R($r,{type:"text",get placeholder(){return t("hbl.searchPlaceholder","Search by HBL#, air guide, shipper, consignee, commodity, bag#, identity...")},get value(){return u()},onChange:T=>h(T)}),null),Se(()=>$.value=l()),W}}),null),a(w,R(iR,{get hbls(){return e()},onFilterChange:g,onHBLSelect:y}),null),a(w,R(ze,{get when(){return n()},get children(){var W=aR();return W.style.setProperty("position","fixed"),W.style.setProperty("top","0"),W.style.setProperty("left","0"),W.style.setProperty("right","0"),W.style.setProperty("bottom","0"),W.style.setProperty("background","rgba(0, 0, 0, 0.5)"),W.style.setProperty("display","flex"),W.style.setProperty("align-items","center"),W.style.setProperty("justify-content","center"),W.style.setProperty("z-index","1000"),a(W,R(Ot,{style:{width:"90%","max-width":"600px","max-height":"90vh","overflow-y":"auto"},get children(){var K=sR(),te=K.firstChild,$=te.firstChild;$.firstChild;var C=$.nextSibling,T=te.nextSibling,O=T.firstChild,b=O.firstChild,P=b.firstChild;b.nextSibling;var _=O.nextSibling,z=_.firstChild,Z=z.firstChild;z.nextSibling;var k=_.nextSibling,F=k.firstChild,X=F.firstChild,U=F.nextSibling,B=k.nextSibling,ce=B.firstChild,L=ce.firstChild;ce.nextSibling;var D=B.nextSibling,j=D.firstChild,I=j.firstChild;j.nextSibling;var M=D.nextSibling,J=M.firstChild,H=J.firstChild;J.nextSibling;var Q=M.nextSibling,se=Q.firstChild,G=se.firstChild;se.nextSibling;var re=Q.nextSibling,oe=re.firstChild,fe=oe.firstChild;oe.nextSibling;var ae=re.nextSibling,Y=ae.firstChild,ie=Y.firstChild;Y.nextSibling;var de=ae.nextSibling,ue=de.firstChild,ge=ue.firstChild;ue.nextSibling;var Pe=de.nextSibling,pe=Pe.firstChild,_e=pe.firstChild,Le=pe.nextSibling,De=Le.nextSibling;De.nextSibling;var Te=Pe.nextSibling,$e=Te.firstChild,Ie=$e.firstChild;$e.nextSibling;var Re=Te.nextSibling,Je=Re.firstChild,Be=Je.firstChild,Ke=Je.nextSibling,Xe=Ke.nextSibling;Xe.nextSibling;var at=Re.nextSibling,ot=at.firstChild,Qe=ot.firstChild;ot.nextSibling;var dt=at.nextSibling,ct=dt.firstChild,kt=ct.firstChild;ct.nextSibling;var gt=dt.nextSibling,qe=gt.firstChild,Dt=qe.firstChild;qe.nextSibling;var Rt=gt.nextSibling,St=Rt.firstChild,Bt=St.firstChild;St.nextSibling;var fr=Rt.nextSibling,Qt=fr.firstChild,cr=Qt.firstChild;return Qt.nextSibling,K.style.setProperty("padding","2rem"),te.style.setProperty("display","flex"),te.style.setProperty("justify-content","space-between"),te.style.setProperty("align-items","center"),te.style.setProperty("margin-bottom","1.5rem"),$.style.setProperty("font-size","1.25rem"),$.style.setProperty("font-weight","600"),a($,()=>n().hbl,null),C.$$click=()=>i(null),C.style.setProperty("background","none"),C.style.setProperty("border","none"),C.style.setProperty("font-size","1.5rem"),C.style.setProperty("cursor","pointer"),C.style.setProperty("color","var(--text-muted)"),T.style.setProperty("display","grid"),T.style.setProperty("gap","1rem"),a(b,()=>t("hbl.airGuide","Air Guide"),P),a(O,()=>n().idairguide,null),a(z,()=>t("hbl.airNumber","Air Number"),Z),a(_,()=>n().idairnumber,null),a(F,()=>t("hbl.status","Status"),X),U.style.setProperty("margin-left","0.5rem"),U.style.setProperty("padding","0.25rem 0.75rem"),U.style.setProperty("border-radius","var(--border-radius-sm)"),U.style.setProperty("font-size","0.875rem"),U.style.setProperty("color","white"),a(U,()=>n().idguidestate),a(ce,()=>t("hbl.classification","Classification"),L),a(B,()=>n().idclasification,null),a(j,()=>t("hbl.shipper","Shipper"),I),a(D,()=>n().nameshipper,null),a(J,()=>t("hbl.shipperPhone","Shipper Phone"),H),a(M,()=>n().phoneshipper,null),a(se,()=>t("hbl.consignee","Consignee"),G),a(Q,()=>n().consigneeName,null),a(oe,()=>t("hbl.consigneePhone","Consignee Phone"),fe),a(re,()=>n().ctelephone,null),a(Y,()=>t("hbl.identity","Identity"),ie),a(ae,()=>n().cidentity,null),a(ue,()=>t("hbl.address","Address"),ge),a(de,()=>n().street,null),a(pe,()=>t("hbl.city","City"),_e),a(Pe,()=>n().address.city,De),a(Pe,()=>n().address.estate,null),a($e,()=>t("hbl.commodity","Commodity"),Ie),a(Te,()=>n().namegood,null),a(Je,()=>t("hbl.weight","Weight"),Be),a(Re,()=>n().weight,Xe),a(ot,()=>t("hbl.quantity","Quantity"),Qe),a(at,()=>n().quantity,null),a(ct,()=>t("hbl.bagNumber","Bag Number"),kt),a(dt,()=>n().bagnumber,null),a(qe,()=>t("hbl.agency","Agency"),Dt),a(gt,()=>n().agency,null),a(St,()=>t("hbl.guide","Guide"),Bt),a(Rt,()=>n().guia,null),a(Qt,()=>t("hbl.reserveDate","Reserve Date"),cr),a(fr,()=>new Date(n().datereserve).toLocaleDateString(),null),Se(xr=>(xr=n().idguidestate==="ENTREGADO"?"#28a745":n().idguidestate==="ENVIADO"?"#17a2b8":n().idguidestate==="EN BODEGA"?"#007bff":"#6c757d")!=null?U.style.setProperty("background-color",xr):U.style.removeProperty("background-color")),K}})),W}}),null),w})()};br(["click"]);var dR=he("<div>$124,350"),hR=he("<div>+12% from last month"),pR=he("<div>247"),oc=he("<div>"),fR=he("<div>18"),mR=he("<div>$89,250"),yR=he("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>");const gR=()=>{const{t}=or(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},n={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)",margin:"0.5rem 0"},i={"font-size":"0.875rem",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"};return R(to,{get title(){return t("dashboard.title")},get children(){return[(()=>{var o=oc();return m(o,e),a(o,R(Ot,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var s=dR();return Se(l=>m(s,n,l)),s})(),(()=>{var s=hR();return Se(l=>m(s,i,l)),s})()]}}),null),a(o,R(Ot,{get title(){return t("dashboard.employeeCount")},get subtitle(){return t("dashboard.current")},get children(){return[(()=>{var s=pR();return Se(l=>m(s,n,l)),s})(),(()=>{var s=oc();return a(s,()=>t("dashboard.newHires")),Se(l=>m(s,i,l)),s})()]}}),null),a(o,R(Ot,{get title(){return t("dashboard.pendingInvoices")},get subtitle(){return t("dashboard.outstanding")},get children(){return[(()=>{var s=fR();return Se(l=>m(s,n,l)),s})(),(()=>{var s=oc();return a(s,()=>t("dashboard.totalOutstanding")),Se(l=>m(s,i,l)),s})()]}}),null),a(o,R(Ot,{get title(){return t("dashboard.cashBalance")},get subtitle(){return t("accounts.title")},get children(){return[(()=>{var s=mR();return Se(l=>m(s,n,l)),s})(),(()=>{var s=oc();return a(s,()=>t("dashboard.lastUpdatedToday")),Se(l=>m(s,i,l)),s})()]}}),null),o})(),(()=>{var o=oc();return m(o,r),a(o,R(Ot,{get title(){return t("dashboard.quickActions")},get subtitle(){return t("dashboard.commonTasks")},get children(){var s=oc();return s.style.setProperty("display","flex"),s.style.setProperty("flex-direction","column"),s.style.setProperty("gap","1rem"),a(s,R(ht,{variant:"primary",get children(){return t("invoices.createNew")}}),null),a(s,R(ht,{variant:"secondary",get children(){return t("employees.addEmployee")}}),null),a(s,R(ht,{variant:"outline",get children(){return t("dashboard.generateReport")}}),null),s}}),null),a(o,R(Ot,{get title(){return t("dashboard.recentActivity")},get subtitle(){return t("dashboard.latestUpdates")},get children(){var s=yR(),l=s.firstChild,c=l.firstChild,u=c.nextSibling,h=l.nextSibling,y=h.firstChild,g=y.nextSibling,f=h.nextSibling,x=f.firstChild,S=x.nextSibling;return s.style.setProperty("display","flex"),s.style.setProperty("flex-direction","column"),s.style.setProperty("gap","0.75rem"),l.style.setProperty("border-bottom","1px solid var(--border-color)"),l.style.setProperty("padding-bottom","0.5rem"),c.style.setProperty("font-weight","500"),a(c,()=>t("dashboard.invoicePaid")),u.style.setProperty("font-size","0.875rem"),u.style.setProperty("color","var(--text-muted)"),a(u,()=>t("dashboard.hoursAgo")),h.style.setProperty("border-bottom","1px solid var(--border-color)"),h.style.setProperty("padding-bottom","0.5rem"),y.style.setProperty("font-weight","500"),a(y,()=>t("dashboard.newEmployeeOnboarded")),g.style.setProperty("font-size","0.875rem"),g.style.setProperty("color","var(--text-muted)"),a(g,()=>t("dashboard.dayAgo")),x.style.setProperty("font-weight","500"),a(x,()=>t("dashboard.monthlyReportGenerated")),S.style.setProperty("font-size","0.875rem"),S.style.setProperty("color","var(--text-muted)"),a(S,()=>t("dashboard.daysAgo")),s}}),null),o})(),R(ze,{get when(){return pr.hasPermission("invoiceAccess")},get children(){return R(g6,{})}})]}})};var pb=he("<div>"),vR=he("<div><div><div><strong>Display Name:</strong> </div><div><strong>UID:</strong> </div></div><div><strong>Created:</strong> "),bR=he("<div><h3>Store Access</h3><div></div><div>No store access granted"),_R=he("<div><select><option value=all>"),SR=he("<div><h3>Permissions</h3><div>"),PR=he('<div><div><input type=text placeholder="Search users..."></div><div>'),wR=he("<div>⚠️ You need administrator privileges to access this page."),xR=he("<div>Loading users..."),AR=he("<div><div></div><div></div><div> stores"),CR=he("<div>Select a user to view and edit their profile"),IR=he("<div><input type=checkbox><label>"),$R=he("<option>"),ER=he("<div><input type=checkbox><div><div></div><div>");const TR=()=>{const{t}=or(),[e,r]=Ce([]),[n,i]=Ce(null),[o,s]=Ce(!1),[l,c]=Ce(!1),[u,h]=Ce(""),[y,g]=Ce(null),f=[{id:"YY_8802",name:"Store 8802"},{id:"YY_8803",name:"Store 8803"},{id:"YY_8804",name:"Store 8804"},{id:"YY_8805",name:"Store 8805"},{id:"YY_8816",name:"Store 8816"},{id:"YY_8818",name:"Store 8818"},{id:"YY_8847",name:"Store 8847"},{id:"YY_3251",name:"Store 3251"},{id:"YY_32",name:"Store 32"},{id:"YY_76",name:"Store 76"},{id:"YY_2376",name:"Store 2376"},{id:"YY_79",name:"Store 79"},{id:"YY_8635",name:"Store 8635"},{id:"YY_8665",name:"Store 8665"},{id:"YY_8901",name:"Store 8901"}],x=[{key:"AccountAccess",label:"Account Access",description:"Access to accounting features"},{key:"BankingAccess",label:"Banking Access",description:"Access to banking operations"},{key:"InventoryAccess",label:"Inventory Access",description:"Access to inventory management"},{key:"JournalAccess",label:"Journal Access",description:"Access to journal entries"},{key:"invoiceAccess",label:"invoice Access",description:"Access to Invoices"},{key:"inventoryDownsection",label:"Inventory Downsection",description:"Access to inventory downsection"},{key:"onlyRead",label:"Read Only",description:"Limited to read-only access"},{key:"read_write",label:"Read/Write",description:"Full read and write permissions"},{key:"isAdmin",label:"Administrator",description:"Full system administration rights"}];let S={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_2376:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},businessId:"YB100423253156428",AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,invoiceAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1},w=[{label:"Stephanie S",id:"SS695841584167881"},{label:"YABA",id:"YB100423253156428"},{label:"GUANCHO",id:"JJCM23753J15918M"},{label:"LUISCUETO",id:"LMR470531564CT28"}];wn(async()=>{await E()});const E=async()=>{try{s(!0);const k=aI(wm,"users"),F=_I(k,SI("createdAt","desc")),X=await CI(F),U=[];X.forEach(B=>{let ce=B.data();Object.keys(S).map(L=>{let D=S?.[L];ce.hasOwnProperty(L)||(ce[L]=D)}),U.push({uid:B.id,...ce})}),r(U)}catch(k){console.error("Error loading users:",k),g({type:"error",text:"Failed to load users"})}finally{s(!1)}},q=Mt(()=>{const k=u().toLowerCase();return k?e().filter(F=>F.email?.toLowerCase().includes(k)||F.displayName?.toLowerCase().includes(k)||F.uid?.toLowerCase().includes(k)):e()}),ee=k=>{n()&&i(F=>({...F,stores:{...F.stores,[k]:!F.stores[k]}}))},W=k=>{n()&&i(F=>({...F,businessId:k}))},K=k=>{n()&&i(F=>({...F,[k]:!F[k]}))};Mt(()=>n()?n().stores&&Object.values(n().stores).some(k=>k):!1);const te=async()=>{if(n())try{c(!0),g(null);const k=v5(wm,"users",n().uid);let F={stores:n().stores,AccountAccess:n().AccountAccess,BankingAccess:n().BankingAccess,InventoryAccess:n().InventoryAccess,invoiceAccess:n().invoiceAccess,JournalAccess:n().JournalAccess,inventoryDownsection:n().inventoryDownsection,onlyRead:n().onlyRead,read_write:n().read_write,businessId:n().businessId,isAdmin:n().isAdmin||!1};await $5(k,F),r(X=>X.map(U=>U.uid===n().uid?n():U)),g({type:"success",text:"User profile updated successfully"})}catch(k){console.error("Error saving user profile:",k),g({type:"error",text:"Failed to save user profile"})}finally{c(!1)}},$={display:"grid","grid-template-columns":"350px 1fr",gap:"2rem",height:"calc(100vh - 200px)"},C={"max-height":"100%","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)",background:"var(--surface-color)"},T=k=>({padding:"1rem","border-bottom":"1px solid var(--border-color)",cursor:"pointer",background:k?"var(--primary-color-light)":"transparent",transition:"background 0.2s"}),O={padding:"0.75rem",border:"none","border-bottom":"1px solid var(--border-color)",background:"var(--surface-color)",width:"100%","font-size":"1rem"},b={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1rem"},P={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(200px, 1fr))",gap:"0.75rem"},_={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",transition:"all 0.2s"},z=k=>({padding:"1rem","margin-bottom":"1rem","border-radius":"var(--border-radius)",background:k==="success"?"#d4edda":"#f8d7da",color:k==="success"?"#155724":"#721c24",border:`1px solid ${k==="success"?"#c3e6cb":"#f5c6cb"}`}),Z=Mt(()=>pr.state.profile?.isAdmin===!0);return R(to,{title:"User Profile Administration",get children(){return R(ze,{get when(){return Z()},get fallback(){return R(Ot,{get children(){var k=wR();return k.style.setProperty("text-align","center"),k.style.setProperty("padding","2rem"),k.style.setProperty("color","var(--text-muted)"),k}})},get children(){var k=PR(),F=k.firstChild,X=F.firstChild,U=F.nextSibling;return m(k,$),m(F,C),X.$$input=B=>h(B.currentTarget.value),m(X,O),a(F,R(ze,{get when(){return!o()},get fallback(){return(()=>{var B=xR();return B.style.setProperty("padding","2rem"),B.style.setProperty("text-align","center"),B})()},get children(){return R(Ut,{get each(){return q()},children:B=>(()=>{var ce=AR(),L=ce.firstChild,D=L.nextSibling,j=D.nextSibling,I=j.firstChild;return ce.$$click=()=>i(B),L.style.setProperty("font-weight","600"),a(L,()=>B.displayName||"No Name"),D.style.setProperty("font-size","0.875rem"),D.style.setProperty("color","var(--text-muted)"),a(D,()=>B.email),j.style.setProperty("font-size","0.75rem"),j.style.setProperty("color","var(--text-muted)"),j.style.setProperty("margin-top","0.25rem"),a(j,()=>B.isAdmin&&"👑 Admin • ",I),a(j,()=>Object.values(B.stores||{}).filter(Boolean).length,I),Se(M=>m(ce,T(n()?.uid===B.uid),M)),ce})()})}}),null),a(U,R(ze,{get when(){return n()},get fallback(){return R(Ot,{get children(){var B=CR();return B.style.setProperty("text-align","center"),B.style.setProperty("padding","2rem"),B.style.setProperty("color","var(--text-muted)"),B}})},get children(){return[R(ze,{get when(){return y()},get children(){var B=pb();return a(B,()=>y().text),Se(ce=>m(B,z(y().type),ce)),B}}),R(Ot,{title:"User Information",get subtitle(){return n().email},get children(){return[(()=>{var B=vR(),ce=B.firstChild,L=ce.firstChild,D=L.firstChild;D.nextSibling;var j=L.nextSibling,I=j.firstChild;I.nextSibling;var M=ce.nextSibling,J=M.firstChild;return J.nextSibling,B.style.setProperty("margin-bottom","2rem"),ce.style.setProperty("display","flex"),ce.style.setProperty("justify-content","space-between"),ce.style.setProperty("margin-bottom","1rem"),a(L,()=>n().displayName||"Not set",null),a(j,()=>n().uid,null),a(M,()=>new Date(n().createdAt?.toDate?.()||n().createdAt).toLocaleDateString(),null),B})(),(()=>{var B=bR(),ce=B.firstChild,L=ce.nextSibling,D=L.nextSibling;return B.style.setProperty("margin-bottom","2rem"),ce.style.setProperty("margin-bottom","1rem"),m(L,P),a(L,R(Ut,{each:f,children:j=>{let I=ut.getLocationById(j?.id);return(()=>{var M=IR(),J=M.firstChild,H=J.nextSibling;return M.$$click=()=>ee(j?.id),J.style.setProperty("cursor","pointer"),H.style.setProperty("cursor","pointer"),H.style.setProperty("user-select","none"),a(H,()=>I?.name),Se(Q=>m(M,{..._,background:n().stores?.[j?.id]?"var(--primary-color-light)":"transparent"},Q)),Se(()=>J.checked=n().stores?.[j?.id]||!1),M})()}})),D.style.setProperty("margin-top","0.5rem"),D.style.setProperty("font-size","0.875rem"),D.style.setProperty("color","var(--text-muted)"),B})(),(()=>{var B=_R(),ce=B.firstChild,L=ce.firstChild;return B.style.setProperty("margin-bottom","2rem"),ce.addEventListener("change",D=>W(D.currentTarget.value)),ce.style.setProperty("width","100%"),ce.style.setProperty("padding","0.5rem"),ce.style.setProperty("border","1px solid var(--border-color)"),ce.style.setProperty("border-radius","var(--border-radius-sm)"),ce.style.setProperty("background","var(--surface-color)"),a(L,()=>t("common.all","All")),a(ce,R(Ut,{each:w,children:D=>(()=>{var j=$R();return a(j,()=>D?.label),Se(()=>j.value=D.id),j})()}),null),Se(()=>ce.value=n()?.businessId),B})(),(()=>{var B=SR(),ce=B.firstChild,L=ce.nextSibling;return B.style.setProperty("margin-bottom","2rem"),ce.style.setProperty("margin-bottom","1rem"),m(L,b),a(L,R(Ut,{each:x,children:D=>(()=>{var j=ER(),I=j.firstChild,M=I.nextSibling,J=M.firstChild,H=J.nextSibling;return j.$$click=()=>K(D.key),I.style.setProperty("cursor","pointer"),M.style.setProperty("flex","1"),M.style.setProperty("cursor","pointer"),M.style.setProperty("user-select","none"),J.style.setProperty("font-weight","500"),a(J,()=>D.label),H.style.setProperty("font-size","0.75rem"),H.style.setProperty("color","var(--text-muted)"),a(H,()=>D.description),Se(Q=>m(j,{..._,background:n()[D.key]?"var(--primary-color-light)":"transparent"},Q)),Se(()=>I.checked=!!n()[D.key]),j})()})),B})(),(()=>{var B=pb();return B.style.setProperty("display","flex"),B.style.setProperty("gap","1rem"),B.style.setProperty("justify-content","flex-end"),a(B,R(ht,{variant:"secondary",onClick:()=>i(null),children:"Cancel"}),null),a(B,R(ht,{variant:"primary",onClick:te,get disabled(){return l()},get children(){return l()?"Saving...":"Save Changes"}}),null),B})()]}})]}})),Se(()=>X.value=u()),k}})}})};br(["input","click"]);const kR=async()=>{try{console.log("Testing PDF generation...");const e=(await Bi(()=>Promise.resolve().then(()=>i_),void 0)).default;console.log("jsPDF imported successfully");const r=new e;console.log("PDF document created"),r.setFontSize(20),r.text("Test PDF",20,20),r.setFontSize(12),r.text("This is a test PDF to verify the library works.",20,40),console.log("Text added to PDF"),r.save("test.pdf"),console.log("PDF saved successfully"),alert("Test PDF generated successfully!")}catch(t){console.error("Test PDF generation failed:",t),alert(`Test PDF failed: ${t.message}`)}},Mf=(t,e)=>{try{console.log("Generating printable PDF..."),console.log(t);const r=window.open("","_blank","width=800,height=600");if(!r){alert("Please allow popups to generate PDF");return}const n=t.shipper_consignee||{};let i=ut.getLocationById(t?.store);const o=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Invoice ${t.invoice||"N/A"}</title>
        <style>
          body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
          }
          .header {
            display: flex;
            justify-content: space-between;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
            margin-bottom: 20px;
          }
          .company {
            font-size: 24px;
            font-weight: bold;
            color: #2563eb;
          }
          .invoice-info {
            text-align: right;
          }
          .section {
            margin: 20px 0;
          }
          .section-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
          }
          .customer-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
             font-size: 13px;
          }
          .flex{
            display: flex;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
          }
          th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
          }
          th {
            background-color: #f2f2f2;
            font-weight: bold;
            font-size: 13px;
          }
          td{
           font-size: 12px;
          }
          .total-row {
            font-weight: bold;
            font-size: 16px;
            background-color: #e8f4fd;
          }
          .certification-section {
            page-break-inside: avoid;
            break-inside: avoid;
            orphans: 3;
            widows: 3;
          }
          .page-break-before {
            page-break-before: always;
            break-before: page;
          }
          @media print {
            body { margin: 0; }
            .no-print { display: none; }
            .certification-section {
              page-break-inside: avoid !important;
              break-inside: avoid !important;
              orphans: 3;
              widows: 3;
            }
            .page-break-before {
              page-break-before: always !important;
              break-before: page !important;
            }
            /* Force page break if certification section would be split */
            @page {
              margin: 0.5in;
              orphans: 3;
              widows: 3;
            }
          }
        </style>
      </head>
      <body>
        <div class="header">
          <div>
            <div class="company">HRM FINANCE</div>
            <div>${e("common.store")}: ${i?.name||t?.store||"N/A"}</div>
            <div>${e("common.orderId")}: ${t.ssg_sorder_key||"N/A"}</div>
            ${t.shippingMethod?`<div>${e("common.shipping")}: ${t.shippingMethod==="aereo"?e("common.air"):e("common.sea")}</div>`:""}
          </div>
          <div class="invoice-info">
            <div style="font-size: 18px; font-weight: bold;">${e("common.invoice").toUpperCase()}</div>
            <div style="font-size: 16px; margin: 5px 0;">${t.invoice||"N/A"}</div>
            <div>${t.createDate?new Date(t.createDate).toLocaleDateString():"N/A"}</div>
            <div style="margin-top: 10px;">
              <span style="padding: 4px 8px; background: ${t.isCompleted?"#d4edda":"#fff3cd"}; border-radius: 10px; font-size: 12px;">
                ${t.isCompleted?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase()}
              </span>
            </div>
          </div>
        </div>

        <div class="section">
          <div class="customer-info">
            <div><strong>${e("invoices.senderInformation")}:</strong> ${n.name||"N/A"}</div>
            ${n.phoneNumberS?`<div><strong>${e("invoices.phoneNumber")}:</strong> ${n.phoneNumberS}</div>`:""}
          
          </div>
          <div class="customer-info">
            <div><strong>${e("invoices.receiptInformation")}:</strong> ${[n.firstName,n.middleName,n.lastName,n.lastName2].filter(Boolean).join(" ")||"N/A"}</div>
            <div><strong>${e("invoices.phoneNumber")}:</strong> ${n.phoneNumber||"N/A"}</div>
            <div><strong>${e("invoices.id")}:</strong> ${n.cid||"N/A"}</div>
            ${n.address?`<div><strong>${e("invoices.address")}:</strong> ${n.address}</div>`:""}
          </div>
        </div>

        ${t.products&&t.products.length>0?`
        <div class="section">
          <div class="section-title">${e("invoices.products")}</div>
          <table>
            <thead>
              <tr>
                <th>${e("invoices.code")}</th>
                <th>${e("invoices.description")}</th>
                <th>${e("invoices.qty")}</th>
                <th>${e("invoices.unitPrice")}</th>
                <th>${e("invoices.total")}</th>
              </tr>
            </thead>
            <tbody>
              ${t.products.map(s=>`
                <tr>
                  <td>${s.product?.code||"N/A"}</td>
                  <td>${s.product?.label||"N/A"}</td>
                  <td>${Math.abs(s.qty||0).toFixed(2)}</td>
                  <td>$${parseFloat(s.salePrice||0).toFixed(2)}</td>
                  <td>$${(s.total||Math.abs(s.qty||0)*parseFloat(s.salePrice||0)).toFixed(2)}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
        </div>
        `:""}

        ${t.reservas&&t.reservas.length>0?`
        <div class="section">
          <div class="section-title">${e("invoices.reservations")}</div>
          <table>
            <thead>
              <tr>
                <th>${e("invoices.type")}</th>
                <th>${e("invoices.qty")}</th>
                <th>${e("invoices.unitPrice")}</th>
                <th>${e("invoices.arancel")}</th>
                <th>${e("invoices.total")}</th>
              </tr>
            </thead>
            <tbody>
              ${t.reservas.map(s=>{const l=parseFloat(s.qty||0),c=parseFloat(s.price||0),u=parseFloat(s.arancel||0),h=s.total||l*c+u;return`
                  <tr>
                    <td>${s.type||"N/A"}</td>
                    <td>${l.toFixed(2)}</td>
                    <td>$${c.toFixed(2)}</td>
                    <td>${u>0?"$"+u.toFixed(2):"-"}</td>
                    <td>$${h.toFixed(2)}</td>
                  </tr>
                `}).join("")}
            </tbody>
          </table>
        </div>
        `:""}

        ${t.services&&t.services.length>0?`
        <div class="section">
          <div class="section-title">${e("invoices.services")}</div>
          <table>
            <thead>
              <tr>
                <th>${e("invoices.type")}</th>
                <th>${e("invoices.qty")}</th>
                <th>${e("invoices.arancel")}</th>
                <th>${e("invoices.total")}</th>
              </tr>
            </thead>
            <tbody>
              ${t.services.map(s=>{const l=parseFloat(s.qty||0),c=parseFloat(s.price||0),u=parseFloat(s.arancel||0),h=s.total||l*c+u;return`
                  <tr>
                    <td>${s.type||"N/A"}</td>
                    <td>${l.toFixed(2)}</td>
                    <td>${u>0?"$"+u.toFixed(2):"-"}</td>
                    <td>$${h.toFixed(2)}</td>
                  </tr>
                `}).join("")}
            </tbody>
          </table>
        </div>
        `:""}

        <div class="section flex">
          ${t.paymentMethods?`
        <div class="section" style="margin-right: auto; width: 48%">
          <div class="section-title">${e("common.paymentMethods")}</div>
          <div class="customer-info">
            ${t.paymentMethods.cash>0?`<div><strong>💵 ${e("common.cash")}:</strong> $${t.paymentMethods.cash.toFixed(2)}</div>`:""}
            ${t.paymentMethods.zelle>0?`<div><strong>📱 Zelle:</strong> $${t.paymentMethods.zelle.toFixed(2)}</div>`:""}
            ${t.paymentMethods.creditCard>0?`<div><strong>💳 ${e("common.creditCard")}:</strong> $${t.paymentMethods.creditCard.toFixed(2)}</div>`:""}
            ${t.paymentMethods.exemptTaxOnCash&&t.paymentMethods.cash>0&&t.taxSavings>0?`
              <div style="margin-top: 10px; padding: 8px; background-color: #e7f5ff; border-radius: 4px; font-size: 12px; font-style: italic;">
                * ${e("common.taxExemptNote")} ${e("common.youSaved")} $${t.taxSavings.toFixed(2)}!
              </div>
            `:""}
          </div>
        </div>
        `:""}
        <div class="section ">
          <table style="margin-left: auto; width: width: 48%">
            ${t.productSubtotal?`
            <tr>
              <td><strong>${e("invoices.productsSubtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${t.productSubtotal.toFixed(2)}</strong></td>
            </tr>
            `:""}
            ${t.reservaSubtotal?`
            <tr>
              <td><strong>${e("invoices.reservationsSubtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${t.reservaSubtotal.toFixed(2)}</strong></td>
            </tr>
            `:""}
            ${t.serviceSubtotal?`
            <tr>
              <td><strong>${e("invoices.servicesSubtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${t.serviceSubtotal.toFixed(2)}</strong></td>
            </tr>
            `:""}
            ${t.taxAmount&&t.taxAmount>0?`
            <tr>
              <td><strong>${e("common.subtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${(t.subtotalBeforeTax||0).toFixed(2)}</strong></td>
            </tr>
            <tr>
              <td><strong>${e("common.tax")} (${t.paymentMethods?.taxPercent||7}%):</strong></td>
              <td style="text-align: right;"><strong>$${t.taxAmount.toFixed(2)}</strong></td>
            </tr>
            `:""}
            <tr class="total-row">
              <td><strong>${e("invoices.total").toUpperCase()}:</strong></td>
              <td style="text-align: right;"><strong>$${(t.total||0).toFixed(2)}</strong></td>
            </tr>
          </table>
        </div>
        </div>
        
       

        <!-- Certification Section -->
        <div class="certification-section" style="margin-top: 40px; padding: 20px; border: 2px solid #333; background: #f9f9f9;">
          <div style="text-align: center; font-weight: bold; font-size: 14px; margin-bottom: 15px; text-transform: uppercase;">
            CERTIFICACIÓN DEL EMBARCADOR
          </div>
          <div style="font-size: 11px; line-height: 1.4; text-align: justify; margin-bottom: 20px;">
            <p><strong>Certifico que no envío sustancias ni productos prohibidos por las leyes y las aduanas de USA y Cuba, como por ejemplo:</strong> drogas, armas, explosivos, cigarrillos electrónicos, drones profesionales, joyas, prendas, dinero en efectivo, semillas, narcóticos, fármacos controlados, productos agrícolas de tipo herbicidas o antifúngicidas, ningún tipo de producto perecedero que necesite refrigeración.</p>
            
            <p><strong>Entiendo que al llenar este formulario, al enviar alguna de las sustancias o productos antes descritos mi carga puede ser decamisada completa o parcialmente por las aduanas de Cuba o USA sin derecho a reclamo ni compensación,</strong> de parte mía como embarcador, ni de la persona a quien envío (consignatario).</p>
            
           </div>
          
          <!-- Signature Section -->
          <div style="display: flex; justify-content: space-between; margin-top: 30px;">
            <div style="width: 45%; text-align: center;">
              <div style="border-bottom: 2px solid #333; margin-bottom: 10px; height: 40px;"></div>
              <div style="font-size: 10px; font-weight: bold;">FIRMA DEL EMBARCADOR / SHIPPER SIGNATURE</div>
              <div style="font-size: 10px; margin-top: 5px;">${n.name||"N/A"}</div>
            </div>
            <div style="width: 45%; text-align: center;">
              <div style="border-bottom: 2px solid #333; margin-bottom: 10px; height: 40px;"></div>
              <div style="font-size: 10px; font-weight: bold;">FECHA / DATE</div>
              <div style="font-size: 10px; margin-top: 5px;">${new Date().toLocaleDateString()}</div>
            </div>
          </div>
        </div>

        <div style="margin-top: 40px; text-align: center; color: #666; font-size: 12px;">
          <p>${e("common.thankForChoosingUs")}</p>
          <p>${e("common.generatedOn")} ${new Date().toLocaleDateString()}</p>
        </div>

        <script>
          // Check if certification section needs page break
          function checkCertificationPageBreak() {
            const certSection = document.querySelector('.certification-section');
            if (!certSection) return;
            
            // Reset any previous page break class to get accurate measurements
            certSection.classList.remove('page-break-before');
            
            // Force a layout recalculation
            certSection.offsetHeight;
            
            const rect = certSection.getBoundingClientRect();
            const certHeight = rect.height;
            const certTop = rect.top;
            
            // Estimate print page height (assuming standard letter size at 96 DPI)
            // Standard letter: 11 inches - 1 inch margins = 10 inches usable
            // At 96 DPI: 10 * 96 = 960px usable height per page
            const printPageHeight = 960;
            const pageMargin = 48; // 0.5 inch margins
            
            // Calculate current position on the page
            const currentPagePosition = certTop % printPageHeight;
            const remainingPageSpace = printPageHeight - currentPagePosition - pageMargin;
            
            // Add some buffer space (50px) to ensure comfortable fit
            const requiredSpace = certHeight + 50;
            
            false && console.log('Certification section analysis:', {
              certHeight,
              certTop,
              currentPagePosition,
              remainingPageSpace,
              requiredSpace,
              needsPageBreak: requiredSpace > remainingPageSpace
            });
            
            // Only add page break if certification truly won't fit
            if (requiredSpace > remainingPageSpace && remainingPageSpace < printPageHeight * 0.4) {
              // console.log('Adding page break for certification section');
              certSection.classList.add('page-break-before');
            }
          }
          
          // Run check when page loads and before printing
          document.addEventListener('DOMContentLoaded', function() {
            // Delay to ensure all content is rendered
            setTimeout(checkCertificationPageBreak, 100);
          });
          window.addEventListener('beforeprint', checkCertificationPageBreak);
        <\/script>

        <div class="no-print" style="margin-top: 30px; text-align: center;">
          <button onclick="window.print()" style="padding: 10px 20px; font-size: 16px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">
            ${e("common.printSavePDF")}
          </button>
          <button onclick="window.close()" style="padding: 10px 20px; font-size: 16px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer; margin-left: 10px;">
            ${e("common.close")}
          </button>
        </div>
      </body>
      </html>
    `;r.document.write(o),r.document.close(),r.focus(),console.log("Printable PDF window opened")}catch(r){console.error("Error generating printable PDF:",r),alert("Error generating printable PDF: "+r.message)}},NR=async(t,e)=>{try{console.log("Starting professional PDF generation...");const n=(await Bi(()=>Promise.resolve().then(()=>i_),void 0)).default,i=new n,o=210,s=297,l=15,c=o-l*2,u={r:180,g:180,b:180},h={r:80,g:80,b:80},y={r:130,g:130,b:130},g={r:248,g:248,b:248},f={r:252,g:252,b:252},x={r:120,g:120,b:120},S={r:150,g:150,b:150};let w=l;const E=re=>{i.setTextColor(re.r,re.g,re.b)},q=re=>{i.setFillColor(re.r,re.g,re.b)},ee=(re,oe,fe,ae,Y,ie=!1)=>{i.roundedRect(re,oe,fe,ae,Y,Y,ie?"F":"S")};q(f),i.rect(0,0,o,50,"F"),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.5),i.line(0,50,o,50),E(h),i.setFontSize(32),i.setFont("helvetica","bold"),i.text("HRM",l,25),E(y),i.setFontSize(32),i.setFont("helvetica","normal");const W=i.getTextWidth("HRM ");i.text("FINANCE",l+W,25),E(y),i.setFontSize(9),i.setFont("helvetica","normal"),i.text("Professional Business Solutions",l,35);const K=70,te=o-l-K;i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.5),ee(te,12,K,26,2,!1),E(h),i.setFontSize(14),i.setFont("helvetica","bold");const $=e("common.invoice").toUpperCase(),C=i.getTextWidth($);i.text($,te+(K-C)/2,22),i.setFontSize(11),i.setFont("helvetica","normal");const T=t.invoice||"N/A",O=i.getTextWidth(T);i.text(T,te+(K-O)/2,32),w=60,q(f),i.rect(0,50,o,20,"F");const b=t.isCompleted,P=b?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase();E(b?h:y),i.setFontSize(8),i.setFont("helvetica","bold"),i.text(`STATUS: ${P}`,l,58),E(y),i.setFontSize(9),i.setFont("helvetica","normal");const z=t.createDate?new Date(t.createDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A";i.text(z,o-l-i.getTextWidth(z),58),w=58,i.text(`${e("common.store")}: ${t.store||"N/A"}`,l+60,w),w+=5,i.text(`${e("common.orderId")}: ${t.ssg_sorder_key||"N/A"}`,l+60,w),t.shippingMethod&&i.text(`${e("common.shipping")}: ${t.shippingMethod==="aereo"?e("common.air"):e("common.sea")}`,o-l-50,w),w=80,E(h),i.setFontSize(14),i.setFont("helvetica","bold"),i.text(e("invoices.customerInformation"),l,w),w+=10;const Z=45,k=10,F=(c-k)/2;q(f),ee(l,w,F,Z,3,!0),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),ee(l,w,F,Z,3);const X=t.shipper_consignee||{};let U=w+8;E(y),i.setFontSize(9),i.text(e("invoices.senderInformation"),l+5,U),U+=7,E(h),i.setFontSize(11),i.setFont("helvetica","bold"),i.text(X.name||"N/A",l+5,U),X.phoneNumberS&&(U+=6,i.setFont("helvetica","normal"),i.setFontSize(9),E(y),i.text(`${e("invoices.altPhone")}: ${X.phoneNumberS}`,l+5,U)),q(f),ee(l+F+k,w,F,Z,3,!0),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),ee(l+F+k,w,F,Z,3),U=w+8,E(y),i.setFontSize(9),i.text(e("invoices.receiptInformation"),l+F+k+5,U),U+=7;const B=[X.firstName,X.middleName,X.lastName,X.lastName2].filter(Boolean).join(" ")||"N/A";if(E(h),i.setFontSize(11),i.setFont("helvetica","bold"),i.text(B,l+F+k+5,U),U+=6,i.setFont("helvetica","normal"),i.setFontSize(9),E(y),i.text(`${e("invoices.phoneNumber")}: ${X.phoneNumber||"N/A"}`,l+F+k+5,U),U+=5,i.text(`${e("invoices.id")}: ${X.cid||"N/A"}`,l+F+k+5,U),X.address)U+=5,X.address.split(",").map(oe=>oe.trim()).forEach((oe,fe)=>{fe<2&&oe&&(i.text(oe,l+F+k+5,U),U+=5)});else{let re=`${X.ybstreet||""} #${X.ybstreetNo||""} ${e("invoices.between")} ${X.ybbetwen1||""} ${e("invoices.and")} ${X.ybbetwen2||""}`,oe=`${X.ybreparto||""}, ${X.ybcity||""}, ${X.ybestate||""}`;U+=5,i.text(re,l+F+k+5,U),U+=5,i.text(oe,l+F+k+5,U)}if(w+=Z+15,t?.products&&t?.products?.length>0){E(h),i.setFontSize(14),i.setFont("helvetica","bold"),i.text(e("invoices.products"),l,w),w+=10,q(g),i.rect(l,w-6,c,10,"F"),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),i.line(l,w+4,o-l,w+4),i.setFontSize(9),i.setFont("helvetica","bold"),E(h);const re={code:l+5,description:l+35,qty:l+115,price:l+135,total:l+160};i.text(e("invoices.code"),re.code,w),i.text(e("invoices.description"),re.description,w),i.text(e("invoices.qty"),re.qty,w),i.text(e("invoices.unitPrice"),re.price,w),i.text(e("invoices.total"),re.total,w),w+=10,i.setFont("helvetica","normal"),i.setFontSize(9),t.products.forEach((oe,fe)=>{w>250&&(i.addPage(),w=l),fe%2===0&&(q(f),i.rect(l,w-4,c,8,"F")),E(h),i.text(oe.product?.code||"N/A",re.code,w);let ae=oe.product?.label||"N/A";i.getTextWidth(ae)>70&&(ae=ae.substring(0,40)+"..."),i.text(ae,re.description,w);const Y=Math.abs(oe.qty||0),ie=parseFloat(oe.salePrice||0),de=oe.total||Y*ie;i.text(Y.toString(),re.qty,w),i.text(`$${ie.toFixed(2)}`,re.price,w),i.setFont("helvetica","bold"),i.text(`$${de.toFixed(2)}`,re.total,w),i.setFont("helvetica","normal"),w+=8}),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),i.line(l,w,o-l,w),w+=15}if(t.reservas&&t.reservas.length>0){w>200&&(i.addPage(),w=l),E(h),i.setFontSize(14),i.setFont("helvetica","bold"),i.text(e("invoices.reservations"),l,w),w+=10,q(g),i.rect(l,w-6,c,10,"F"),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),i.line(l,w+4,o-l,w+4),i.setFontSize(9),i.setFont("helvetica","bold"),E(h);const re={type:l+5,qty:l+65,price:l+95,arancel:l+125,total:l+160};i.text(e("invoices.type"),re.type,w),i.text(e("invoices.qty"),re.qty,w),i.text(e("invoices.unitPrice"),re.price,w),i.text(e("invoices.arancel"),re.arancel,w),i.text(e("invoices.total"),re.total,w),w+=10,i.setFont("helvetica","normal"),i.setFontSize(9),t.reservas.forEach((oe,fe)=>{w>250&&(i.addPage(),w=l),fe%2===0&&(q(f),i.rect(l,w-4,c,8,"F")),E(h),i.text(oe.type||"N/A",re.type,w);const ae=parseFloat(oe.qty||0),Y=parseFloat(oe.price||0),ie=parseFloat(oe.arancel||0),de=oe.total||ae*Y+ie;i.text(ae.toString(),re.qty,w),i.text(`$${Y.toFixed(2)}`,re.price,w),i.text(`$${ie.toFixed(2)}`,re.arancel,w),i.setFont("helvetica","bold"),i.text(`$${de.toFixed(2)}`,re.total,w),i.setFont("helvetica","normal"),w+=8}),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),i.line(l,w,o-l,w),w+=15}w>210&&(i.addPage(),w=l);const ce=o-l-80,L=80;let D=60;t.taxAmount&&t.taxAmount>0&&(D+=16),q(f),ee(ce-10,w,L+10,D,3,!0),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),ee(ce-10,w,L+10,D,3);let j=w+10;if(i.setFontSize(10),E(y),t.productSubtotal!==void 0&&t.productSubtotal>0&&(i.text(e("invoices.productsSubtotal"),ce,j),i.text(`$${t.productSubtotal.toFixed(2)}`,ce+L-15,j,{align:"right"}),j+=8),t.reservaSubtotal!==void 0&&t.reservaSubtotal>0&&(i.text(e("invoices.reservationsSubtotal"),ce,j),i.text(`$${t.reservaSubtotal.toFixed(2)}`,ce+L-15,j,{align:"right"}),j+=8),t.taxAmount&&t.taxAmount>0){i.text(e("common.subtotal"),ce,j),i.text(`$${(t.subtotalBeforeTax||0).toFixed(2)}`,ce+L-15,j,{align:"right"}),j+=8;const re=t.paymentMethods?.taxPercent||7;i.text(`${e("common.tax")} (${re}%)`,ce,j),i.text(`$${t.taxAmount.toFixed(2)}`,ce+L-15,j,{align:"right"}),j+=8}if(i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),i.line(ce,j+2,ce+L-10,j+2),j+=10,i.setFontSize(14),i.setFont("helvetica","bold"),E(h),i.text(e("invoices.total"),ce,j),i.text(`$${(t.total||0).toFixed(2)}`,ce+L-15,j,{align:"right"}),t.paymentMethods){w+=D+20,E(h),i.setFontSize(12),i.setFont("helvetica","bold"),i.text(e("common.paymentMethods"),l,w),w+=10,i.setFontSize(10),i.setFont("helvetica","normal"),E(y);const re=t.paymentMethods;let oe=w;re.cash&&re.cash>0&&(i.text(`${e("common.cash")}:`,l+5,oe),i.text(`$${re.cash.toFixed(2)}`,l+50,oe),oe+=6),re.zelle&&re.zelle>0&&(i.text("Zelle:",l+5,oe),i.text(`$${re.zelle.toFixed(2)}`,l+50,oe),oe+=6),re.creditCard&&re.creditCard>0&&(i.text(`${e("common.creditCard")}:`,l+5,oe),i.text(`$${re.creditCard.toFixed(2)}`,l+50,oe),oe+=6),re.exemptTaxOnCash&&re.cash>0&&t.taxSavings>0&&(oe+=4,i.setFontSize(9),i.setFont("helvetica","italic"),i.text(`* Tax exempted on cash payment. You saved $${t.taxSavings.toFixed(2)}!`,l+5,oe)),w=oe+10}w=s-30,q(f),i.rect(0,w-10,o,40,"F"),i.setFontSize(12),i.setFont("helvetica","italic"),E(y);const I=e("common.thankYouBusiness"),M=i.getTextWidth(I);i.text(I,(o-M)/2,w),w+=8,i.setFontSize(9),i.setFont("helvetica","normal");const J="www.hrmfinance.com | info@hrmfinance.com | +1 (555) 123-4567",H=i.getTextWidth(J);i.text(J,(o-H)/2,w),w+=8,i.setFontSize(8);const Q=`Generated on ${new Date().toLocaleString("en-US")}`,se=i.getTextWidth(Q);i.text(Q,(o-se)/2,w);const G=`invoice-${t.invoice||"unknown"}.pdf`;i.save(G),console.log("Professional PDF saved successfully:",G)}catch(r){throw console.error("Error in generateProfessionalInvoicePDF:",r),r}},Zn=t=>parseFloat(t?.toString()||"0")||0,LR=t=>{if(t?.includes("/")){const[e,r,n]=t.split("/");return`${n}-${e.padStart(2,"0")}-${r.padStart(2,"0")}`}if(t?.includes("-")){const[e,r,n]=t.split("-");return`${n}-${e.padStart(2,"0")}-${r.padStart(2,"0")}`}return t},RR=t=>{const e=[];return t.ybstreet&&(e.push(t.ybstreet),t.ybstreetNo&&e.push(`# ${t.ybstreetNo}`)),t.ybbetwen1&&t.ybbetwen2&&e.push(`/ ${t.ybbetwen1} y ${t.ybbetwen2}`),t.ybreparto&&e.push(`, Rpto ${t.ybreparto}`),t.ybcity&&e.push(`, ${t.ybcity}`),t.ybestate&&e.push(`, ${t.ybestate}`),e.join(" ")},fb=t=>{const e=Zn(t.qty),r=Zn(t.price),n=Zn(t.arancel);return t.onlyTariff,{lbs:e*r,arancel:n,total:e*r+n}},mb=t=>{const e=Math.abs(t.qty),r=Zn(t.salePrice);return e*r},DR=(t,e)=>{const r=t.split("-");if(r.length>=3){const n=r[0];return{YY_8803:"BISSONNET"}[n]||e}return e},Jh=t=>{const e=t?.products?.reduce((ee,W)=>ee+mb(W),0),r=t?.reservas?.reduce((ee,W)=>ee+fb(W).lbs,0),n=t?.services?.reduce((ee,W)=>{const K=Zn(W.qty),te=Zn(W.arancel);return ee+K*te},0)||0,i=parseFloat(Zn(r).toFixed(2)),o=parseFloat(Zn(n).toFixed(2));var s=Zn(e)+Zn(r)+Zn(n),l=t?.TaxPercent||0,c=s*l/100,u=0,h=s+c,y=0;t?.paymentMethods&&t.subtotalBeforeTax&&(l=t?.paymentMethods?.taxPercent||0,c=t.taxAmount||0,h=t.total||0,s=t.subtotalBeforeTax||0,u=t?.taxSavings||0);const f=(t?.products||[])?.map((ee,W)=>({id:Date.now().toString()+W,product:{id:ee.product.id,code:ee.product.code,label:ee.product.label,price:0},qty:Math.abs(ee.qty),salePrice:Zn(ee.salePrice),total:mb(ee)})),x=t?.reservas?.map((ee,W)=>({id:Date.now().toString()+W+1e3,type:ee.type,qty:Zn(ee.qty),price:Zn(ee.price),arancel:Zn(ee.arancel),total:fb(ee)?.total})),S=t?.services?.map((ee,W)=>{const K=Zn(ee.qty),te=Zn(ee.arancel);return{id:Date.now().toString()+W+2e3,type:ee.type,qty:K,arancel:te,total:K*te}})||[],w={name:t.shipper_consignee.name,firstName:t.shipper_consignee.firstName,middleName:t.shipper_consignee.middleName||"",lastName:t.shipper_consignee.lastName,lastName2:t.shipper_consignee.lastName2||"",phoneNumber:t.shipper_consignee.phoneNumber,cid:t.shipper_consignee.cid,passport:t.shipper_consignee.passport||"",address:RR(t.shipper_consignee),phoneNumberS:t.shipper_consignee.phoneNumberS,dob:LR(t.shipper_consignee.dob)},E=DR(t.invoice,t.store),q=t.shippingMethod?.toLowerCase()==="aereo"?"aereo":"maritimo";return{invoice:t.invoice,description:t.description||"",store:E,shipper_consignee:w,products:f,reservas:x,services:S,packagesOrder:t.packagesOrder,shippingMethod:q,paymentMethods:t?.paymentMethods,type:t.type,ssg_inventory_key:t.ssg_inventory_key,ssg_sorder_key:t.ssg_sorder_key,createDate:t.createDate,businessId:t.businessId,isCompleted:t.isCompleted,productSubtotal:e,reservaSubtotal:i,serviceSubtotal:o,subtotalBeforeTax:s,taxAmount:c,taxSavings:u,total:h,taxCalculationMethod:"subtotal",cashPaymentRatio:y}},[lu,Wr]=Yu({invoices:[],selectedInvoice:null,loading:!1,error:null,lastUpdated:null}),[MR,ho]=Ce({fetchAll:!1,fetchById:!1,create:!1,update:!1,delete:!1,generatePDF:!1}),Di={get state(){return lu},get loadingStates(){return MR()},async fetchInvoices(t){try{ho(s=>({...s,fetchAll:!0})),Wr("loading",!0),Wr("error",null);let e="SALES";if(t?.search&&(e+=" "+t.search),t?.store&&t.store!=="all")e+=" "+t.store;else if(!pr.state?.profile?.isAdmin)return e+=" "+Lu(32),Wr("invoices",[]),Wr("lastUpdated",new Date),[];t?.status&&t.status!=="all"&&(e+=" "+t.status);const r=e.toString(),n=await vi.getInvoice(r);let i=[];if(t?.dateFrom&&t?.dateTo){const s=l=>{let c=new Date(n[l].createDate).getTime(),u=new Date(t?.dateFrom).getTime(),h=new Date(t?.dateTo).getTime();c>=u&&c<=h&&i.push(n[l])};Object.keys(n).map(s)}else i=Jf(n);const o=Array.isArray(i)?i:i||[];return Wr("invoices",o),Wr("lastUpdated",new Date),o}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoices";throw Wr("error",r),console.error("Error fetching invoices:",e),e}finally{Wr("loading",!1),ho(e=>({...e,fetchAll:!1}))}},fecthInventory:async t=>{},async fetchInvoiceById(t){try{ho(n=>({...n,fetchById:!0})),Wr("error",null);const e=await vi.getInvoice(t),r=Jf(e);return Wr("selectedInvoice",r[0]),r}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoice";throw Wr("error",r),console.error("Error fetching invoice:",e),e}finally{ho(e=>({...e,fetchById:!1}))}},async createInvoice(t){try{ho(r=>({...r,create:!0})),Wr("error",null);const e={type:t.type||"SALES",invoice:t.invoice,description:t.description||"",store:t.store||"",ssg_inventory_key:t.ssg_inventory_key||`INV-${Date.now()}`,ssg_sorder_key:t.ssg_sorder_key||`SO-${Date.now()}`,createDate:t.createDate||Date.now(),shipper_consignee:t.shipper_consignee,packagesOrder:t.packagesOrder||!1,businessId:t.businessId||"YB100423253156428",userId:t.userId||"current-user",reservas:t.reservas||[],products:t.products||[],isCompleted:t.isCompleted||!0};return e.products&&e.products.length>0&&(e.productSubtotal=e.products.reduce((r,n)=>r+n.qty*n.salePrice,0)),e.reservas&&e.reservas.length>0&&(e.reservaSubtotal=e.reservas.reduce((r,n)=>r+n.total,0)),e.total=(e.productSubtotal||0)+(e.reservaSubtotal||0),Wr("invoices",r=>[e,...r]),Wr("lastUpdated",new Date),e}catch(e){const r=e instanceof Error?e.message:"Failed to create invoice";throw Wr("error",r),console.error("Error creating invoice:",e),e}finally{ho(e=>({...e,create:!1}))}},async generateInvoicePDF(t,e="compact",r="es"){try{ho(l=>({...l,generatePDF:!0})),Wr("error",null);const n=lu.invoices.find(l=>l.invoice===t);if(!n)throw new Error("Invoice not found");let i;switch(e){case"compact":const{generateCompactModernInvoicePDF:l}=await Bi(async()=>{const{generateCompactModernInvoicePDF:h}=await import("./compactModernInvoicePdfGenerator-C-YiLG_Q.js");return{generateCompactModernInvoicePDF:h}},[]);i=l;break;case"modern":const{generateModernMovementInvoicePDF:c}=await Bi(async()=>{const{generateModernMovementInvoicePDF:h}=await import("./modernMovementInvoicePdfGenerator-B55SF2RU.js");return{generateModernMovementInvoicePDF:h}},[]);i=c;break;case"classic":default:const{generateWorkingInvoicePDF:u}=await Bi(async()=>{const{generateWorkingInvoicePDF:h}=await import("./workingPdfGenerator-BT2AXd9j.js");return{generateWorkingInvoicePDF:h}},[]);i=u;break}const o={...n,movementType:"sales",items:n.products||[],invoiceId:n.invoice,id:n.invoice};return await i(o,null,r)}catch(n){const i=n instanceof Error?n.message:"Failed to generate PDF";throw Wr("error",i),console.error("Error generating invoice PDF:",n),n}finally{ho(n=>({...n,generatePDF:!1}))}},async updateInvoice(t,e){try{ho(n=>({...n,update:!0})),Wr("error",null);const r={};return Wr("invoices",n=>n.map(i=>i.invoice===t?r:i)),lu.selectedInvoice?.invoice===t&&Wr("selectedInvoice",r),Wr("lastUpdated",new Date),r}catch(r){const n=r instanceof Error?r.message:"Failed to update invoice";throw Wr("error",n),console.error("Error updating invoice:",r),r}finally{ho(r=>({...r,update:!1}))}},async deleteInvoice(t){try{ho(i=>({...i,delete:!0})),Wr("error",null),Wr("invoices",i=>i.filter(o=>o.invoice!==t)),lu.selectedInvoice?.invoice===t&&Wr("selectedInvoice",null),Wr("lastUpdated",new Date);const n=await hi({query:"deleteYabaSalesOrders",params:{businessId:"YB100423253156428",id:t}});return!0}catch(e){const r=e instanceof Error?e.message:"Failed to delete invoice";throw Wr("error",r),console.error("Error deleting invoice:",e),e}finally{ho(e=>({...e,delete:!1}))}},async fetchInvoiceStats(t){try{Wr("error",null);const e=new URLSearchParams;t?.store&&t.store!=="all"&&e.append("store",t.store),t?.dateFrom&&e.append("dateFrom",t.dateFrom),t?.dateTo&&e.append("dateTo",t.dateTo);const r=e.toString();return[]}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoice statistics";throw Wr("error",r),console.error("Error fetching invoice stats:",e),e}},async fetchStores(){try{return Wr("error",null),[]}catch(t){const e=t instanceof Error?t.message:"Failed to fetch stores";throw Wr("error",e),console.error("Error fetching stores:",t),t}},setSelectedInvoice(t){Wr("selectedInvoice",t)},clearError(){Wr("error",null)},getFilteredInvoices(t){let e=lu.invoices;if(t.store&&t.store!=="all"&&(e=e.filter(r=>r.store===t.store)),t.dateFrom){const r=new Date(t.dateFrom).getTime();e=e.filter(n=>n.createDate>=r)}if(t.dateTo){const r=new Date(t.dateTo).setHours(23,59,59,999);e=e.filter(n=>n.createDate<=r)}if(t.status&&t.status!=="all"){const r=t.status==="completed";e=e.filter(n=>n.isCompleted===r)}return e},calculateSummary(t){let e=t.length,r=t.filter(g=>g.isCompleted).length,n=0,i=0,o=0,s=0,l=0,c=0,u=new Set,h=new Set;t?.forEach(g=>{u.add(g?.shipper_consignee?.cid),h.add(g.store),g?.products?.length>0&&g?.products?.forEach(f=>{const x=Math.abs(f?.qty);n+=x,o+=x*(parseFloat(f?.salePrice)||1)}),g?.reservas?.length>0&&g?.reservas?.forEach(f=>{let x=parseInt(f?.qty);isNaN(x)&&(x=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[f.type]||f?.onlyTariff?(x=parseFloat(f.arancel)||parseFloat(f.qty)*parseFloat(f.price),c+=x):(f?.arancel&&(l+=parseFloat(f?.arancel)),i+=x,s+=x*parseFloat(f?.price))})});const y=o+s+c;return{totalInvoices:e,completedInvoices:r,pendingInvoices:e-r,totalProducts:n,totalReservas:i,totalProductAmount:o,totalReservaAmount:s,totalAranceles:l,grandTotal:y,totalOther:c,uniqueCustomers:u.size,uniqueStores:h.size,avgInvoiceValue:e>0?y/e:0}},async refreshData(t){return this.fetchInvoices(t)}};var FR=he("<br>"),yb=he("<div><h3></h3><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),OR=he("<div><h3></h3><table><thead><tr><th></th><th></th><th></th><th></th></tr></thead><tbody>"),eh=he("<div><span>:</span><span>"),BR=he("<div><span> ($<!>%):</span><span>"),jR=he("<button>remove"),VR=he("<div class=invoice-display><div><div><div>:<span></span></div><div>: <span></span></div></div><div><div></div><h2></h2><div></div><div></div></div></div><div><h3></h3><div><div><div></div><div></div></div></div><div></div><h3></h3><div><div><div></div><div> <!> <!> </div><div></div><div></div><div></div><div></div></div><div><div></div><div></div><div></div><div></div><div> #<br> <!> <!> <br>, <br>, </div></div></div></div><div><div><div></div><div><span>:</span><span></span></div></div></div><div></div><div><button>🖨️ </button><button>🧪 Test PDF</button><button>📥 </button></div><style>"),gb=he("<tr><td></td><td></td><td></td><td></td><td>"),qR=he("<tr><td></td><td></td><td></td><td>");const Uo=t=>parseFloat(t?.toString()||"0")||0,zR=t=>{const{t:e}=or(),[r,n]=Ce(""),[i,o]=Ce(!1),s=Z=>new Date(Z).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),l=Z=>{const k=typeof Z=="string"?parseFloat(Z):Z;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(k)},c=Mt(()=>{let Z=0,k=0,F=0,X=0,U=0;t.invoice?.products?.forEach(D=>{const j=Math.abs(D?.qty),I=parseFloat(D?.salePrice?.toString())||1;Z+=j*I}),t.invoice?.reservas?.forEach(D=>{let j=parseFloat(D?.qty?.toString());isNaN(j)&&(j=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[D.type]||D?.onlyTariff?(j=parseFloat(D.arancel?.toString())||parseFloat(D.qty?.toString())*parseFloat(D.price?.toString()),X+=j):(D?.arancel&&(U+=parseFloat(D?.arancel?.toString())),k+=j*parseFloat(D?.price?.toString()))}),t.invoice?.services?.forEach(D=>{F+=Uo(D.qty)*Uo(D.price)+Uo(D.arancel)});var B=Z+k+F+U+X,ce=0,L=B+ce;return t.invoice?.paymentMethods&&(ce=t.invoice?.taxAmount,L=t.invoice?.total,B=t.invoice?.subtotalBeforeTax),{productSubtotal:Z,reservaSubtotal:k,serviceSubtotal:F,tariffSubtotal:U,subtotal:B,tax:ce,total:L}}),u={"max-width":"800px",margin:"0 auto",padding:"2rem",background:"white","box-shadow":"0 0 20px rgba(0,0,0,0.1)","border-radius":"var(--border-radius)"},h={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"2rem","padding-bottom":"2rem","border-bottom":"2px solid #e0e0e0"},y={"text-align":"right",flex:"1"},g={display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"600","text-transform":"uppercase",background:t.invoice.isCompleted?"#d4edda":"#fff3cd",color:t.invoice.isCompleted?"#155724":"#856404","margin-bottom":"0.5rem"},f={"margin-bottom":"2rem"},x={"font-size":"1.1rem","font-weight":"600","margin-bottom":"1rem",color:"#333"},S={display:"grid","grid-template-columns":"1fr 1fr",gap:"1.5rem"},w={background:"#f8f9fa",padding:"1rem","border-radius":"var(--border-radius-sm)",border:"1px solid #e9ecef"},E={"font-size":"0.875rem",color:"#666","margin-bottom":"0.25rem"},q={"font-size":"1rem",color:"#333","font-weight":"500"},ee={width:"100%","border-collapse":"collapse","margin-top":"1rem"},W={"text-align":"left",padding:"0.75rem","border-bottom":"2px solid #dee2e6","font-weight":"600",color:"#495057","font-size":"0.875rem","text-transform":"uppercase"},K={padding:"0.75rem","border-bottom":"1px solid #dee2e6",color:"#212529"},te={"font-weight":"600","font-size":"1.1rem"},$={display:"flex",gap:"1rem","justify-content":"center","margin-top":"2rem","padding-top":"2rem","border-top":"2px solid #e0e0e0"},C={padding:"0.75rem 1.5rem","border-radius":"var(--border-radius-sm)",border:"none","font-weight":"500",cursor:"pointer",transition:"all 0.2s",display:"flex","align-items":"center",gap:"0.5rem"},T={...C,background:"var(--primary-color)",color:"white"},O={...C,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},b=Mt(()=>ut.getLocationById(t.invoice.store)),P=async()=>{console.log("Starting PDF export...");try{if(!t.invoice){console.error("No invoice data available"),alert("No invoice data available");return}let Z=Jh(t.invoice);console.log("Using minimal ink PDF generator...");try{await NR(Z,e),console.log("Minimal ink PDF generation completed successfully")}catch(k){console.error("PDF generation failed:",k),console.log("Trying printable PDF fallback..."),Mf(Z,e),console.log("Printable PDF fallback completed")}}catch(Z){console.error("Error in handleExportPDF:",Z),console.error("Error stack:",Z.stack),alert(`Error generating PDF: ${Z.message}`)}},_=async()=>{console.log("Starting PDF export...");try{if(!t.invoice){console.error("No invoice data available"),alert("No invoice data available");return}const Z={...t.invoice,storeName:b()?.name||t.invoice.store,storeType:b()?.type,productSubtotal:c().productSubtotal,reservaSubtotal:c().reservaSubtotal,total:c().total};let k=Jh(t.invoice);console.log("Using minimal ink PDF generator...");try{Mf(k,e),console.log("Minimal ink PDF generation completed successfully")}catch(F){console.error("PDF generation failed:",F),console.log("Trying printable PDF fallback..."),Mf(k,e),console.log("Printable PDF fallback completed")}}catch(Z){console.error("Error in handleExportPDF:",Z),console.error("Error stack:",Z.stack),alert(`Error generating PDF: ${Z.message}`)}},z=Z=>{Di.deleteInvoice(t.invoice.ssg_sorder_key),t.goBack()};return(()=>{var Z=VR(),k=Z.firstChild,F=k.firstChild,X=F.firstChild,U=X.firstChild,B=U.nextSibling,ce=X.nextSibling,L=ce.firstChild,D=L.nextSibling,j=F.nextSibling,I=j.firstChild,M=I.nextSibling,J=M.nextSibling,H=J.nextSibling,Q=k.nextSibling,se=Q.firstChild,G=se.nextSibling,re=G.firstChild,oe=re.firstChild,fe=oe.nextSibling,ae=G.nextSibling,Y=ae.nextSibling,ie=Y.nextSibling,de=ie.firstChild,ue=de.firstChild,ge=ue.nextSibling,Pe=ge.firstChild,pe=Pe.nextSibling,_e=pe.nextSibling,Le=_e.nextSibling;Le.nextSibling;var De=ge.nextSibling,Te=De.nextSibling,$e=Te.nextSibling,Ie=$e.nextSibling,Re=de.nextSibling,Je=Re.firstChild,Be=Je.nextSibling,Ke=Be.nextSibling,Xe=Ke.nextSibling,at=Xe.nextSibling,ot=at.firstChild,Qe=ot.nextSibling,dt=Qe.nextSibling,ct=dt.nextSibling,kt=ct.nextSibling,gt=kt.nextSibling,qe=gt.nextSibling,Dt=qe.nextSibling,Rt=Dt.nextSibling,St=Rt.nextSibling,Bt=St.nextSibling,fr=Q.nextSibling,Qt=fr.firstChild,cr=Qt.firstChild,xr=cr.nextSibling,It=xr.firstChild,Ge=It.firstChild,Nt=It.nextSibling,At=fr.nextSibling,Lt=At.nextSibling,Ue=Lt.firstChild;Ue.firstChild;var nt=Ue.nextSibling,_t=nt.nextSibling;_t.firstChild;var Wt=Lt.nextSibling;return m(Z,u),m(k,h),X.style.setProperty("color","#666"),X.style.setProperty("margin-top","0.25rem"),a(X,()=>e(`inventory.${b()?.type}Type`),U),B.style.setProperty("font-size","1.1rem"),B.style.setProperty("font-weight","600"),B.style.setProperty("color","#444"),a(B,()=>b()?.name),ce.style.setProperty("font-size",".91rem"),ce.style.setProperty("font-weight","400"),ce.style.setProperty("color","#666"),a(ce,()=>e("invoices.id"),L),D.style.setProperty("font-size","1.1rem"),D.style.setProperty("font-weight","600"),D.style.setProperty("color","#444"),a(D,()=>t.invoice.ssg_sorder_key),m(j,y),a(I,(()=>{var We=Ee(()=>!!t.invoice.isCompleted);return()=>We()?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase()})()),M.style.setProperty("margin","0 0 0.5rem 0"),M.style.setProperty("font-size","1.5rem"),a(M,()=>e("common.invoice").toUpperCase()),J.style.setProperty("font-size","1.1rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("color","#333"),a(J,()=>t.invoice.invoice),H.style.setProperty("color","#666"),H.style.setProperty("margin-top","0.5rem"),a(H,()=>s(t.invoice.createDate)),a(se,()=>e("invoices.senderInformation")),a(oe,()=>e("invoices.customerName")),a(fe,()=>t.invoice.shipper_consignee.name),a(re,R(ze,{get when(){return t.invoice.shipper_consignee.phoneNumberS},get children(){return[FR(),Ee(()=>e("invoices.altPhone")),": ",Ee(()=>t.invoice.shipper_consignee.phoneNumberS)]}}),null),ae.style.setProperty("margin","20px"),a(Y,()=>e("invoices.receiptInformation")),a(ue,()=>e("invoices.customerName")),a(ge,()=>t.invoice.shipper_consignee.firstName,Pe),a(ge,()=>t.invoice.shipper_consignee.middleName,pe),a(ge,()=>t.invoice.shipper_consignee.lastName,Le),a(ge,()=>t.invoice.shipper_consignee.lastName2,null),a(De,()=>e("invoices.id")),a(Te,()=>t.invoice.shipper_consignee.cid),a($e,()=>e("invoices.passport")),a(Ie,()=>t.invoice.shipper_consignee.passport),a(Je,()=>e("invoices.contactInformation")),a(Be,()=>e("invoices.phoneNumber")),a(Ke,()=>t.invoice.shipper_consignee.phoneNumber),a(Xe,()=>e("invoices.address")),a(at,()=>t.invoice.shipper_consignee.ybstreet,ot),a(at,()=>t.invoice.shipper_consignee.ybstreetNo,Qe),a(at,()=>e("invoices.between"),dt),a(at,()=>t.invoice.shipper_consignee.ybbetwen1,ct),a(at,()=>e("invoices.and"),gt),a(at,()=>t.invoice.shipper_consignee.ybbetwen2,Dt),a(at,()=>t.invoice.shipper_consignee.ybreparto,Rt),a(at,()=>t.invoice.shipper_consignee.ybcity,St),a(at,()=>t.invoice.shipper_consignee.ybestate,Bt),a(at,()=>t.invoice.shipper_consignee.nacionality,null),a(Z,R(ze,{get when(){return t.invoice?.products?.length>0},get children(){var We=yb(),vt=We.firstChild,Tt=vt.nextSibling,jt=Tt.firstChild,Kt=jt.firstChild,rr=Kt.firstChild,yr=rr.nextSibling,nr=yr.nextSibling,ur=nr.nextSibling,Ft=ur.nextSibling,$t=jt.nextSibling;return a(vt,()=>e("invoices.products")),a(rr,()=>e("invoices.code")),a(yr,()=>e("invoices.description")),a(nr,()=>e("invoices.qty")),a(ur,()=>e("invoices.unitPrice")),a(Ft,()=>e("invoices.total")),a($t,R(Ut,{get each(){return t.invoice?.products},children:wt=>(()=>{var Zt=gb(),lt=Zt.firstChild,er=lt.nextSibling,ir=er.nextSibling,sr=ir.nextSibling,_r=sr.nextSibling;return a(lt,()=>wt.product.code),a(er,()=>wt.product.label),a(ir,()=>Math.abs(wt.qty)),a(sr,()=>l(wt.salePrice)),a(_r,()=>l(Math.abs(wt.qty)*Uo(wt.salePrice))),Se(lr=>{var Lr=K,on=K,Ur={...K,"text-align":"center"},Yr={...K,"text-align":"right"},Et={...K,"text-align":"right"};return lr.e=m(lt,Lr,lr.e),lr.t=m(er,on,lr.t),lr.a=m(ir,Ur,lr.a),lr.o=m(sr,Yr,lr.o),lr.i=m(_r,Et,lr.i),lr},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Zt})()})),Se(wt=>{var Zt=f,lt=x,er=ee,ir=W,sr=W,_r={...W,"text-align":"center"},lr={...W,"text-align":"right"},Lr={...W,"text-align":"right"};return wt.e=m(We,Zt,wt.e),wt.t=m(vt,lt,wt.t),wt.a=m(Tt,er,wt.a),wt.o=m(rr,ir,wt.o),wt.i=m(yr,sr,wt.i),wt.n=m(nr,_r,wt.n),wt.s=m(ur,lr,wt.s),wt.h=m(Ft,Lr,wt.h),wt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),We}}),fr),a(Z,R(ze,{get when(){return t.invoice?.reservas?.length>0},get children(){var We=yb(),vt=We.firstChild,Tt=vt.nextSibling,jt=Tt.firstChild,Kt=jt.firstChild,rr=Kt.firstChild,yr=rr.nextSibling,nr=yr.nextSibling,ur=nr.nextSibling,Ft=ur.nextSibling,$t=jt.nextSibling;return a(vt,()=>e("invoices.reservations")),a(rr,()=>e("invoices.type")),a(yr,()=>e("invoices.qty")),a(nr,()=>e("invoices.unitPrice")),a(ur,()=>e("invoices.arancel")),a(Ft,()=>e("invoices.total")),a($t,R(Ut,{get each(){return t.invoice?.reservas},children:wt=>(()=>{var Zt=gb(),lt=Zt.firstChild,er=lt.nextSibling,ir=er.nextSibling,sr=ir.nextSibling,_r=sr.nextSibling;return a(lt,()=>wt.type),a(er,()=>wt.qty),a(ir,()=>l(wt.price)),a(sr,()=>wt.arancel||"-"),a(_r,()=>l((Uo(wt.qty)||0)*(Uo(wt.price)||0)+(wt.arancel?Uo(wt.arancel):0))),Se(lr=>{var Lr=K,on={...K,"text-align":"center"},Ur={...K,"text-align":"right"},Yr={...K,"text-align":"right"},Et={...K,"text-align":"right"};return lr.e=m(lt,Lr,lr.e),lr.t=m(er,on,lr.t),lr.a=m(ir,Ur,lr.a),lr.o=m(sr,Yr,lr.o),lr.i=m(_r,Et,lr.i),lr},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Zt})()})),Se(wt=>{var Zt=f,lt=x,er=ee,ir=W,sr={...W,"text-align":"center"},_r={...W,"text-align":"right"},lr={...W,"text-align":"right"},Lr={...W,"text-align":"right"};return wt.e=m(We,Zt,wt.e),wt.t=m(vt,lt,wt.t),wt.a=m(Tt,er,wt.a),wt.o=m(rr,ir,wt.o),wt.i=m(yr,sr,wt.i),wt.n=m(nr,_r,wt.n),wt.s=m(ur,lr,wt.s),wt.h=m(Ft,Lr,wt.h),wt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),We}}),fr),a(Z,R(ze,{get when(){return t.invoice?.services?.length>0},get children(){var We=OR(),vt=We.firstChild,Tt=vt.nextSibling,jt=Tt.firstChild,Kt=jt.firstChild,rr=Kt.firstChild,yr=rr.nextSibling,nr=yr.nextSibling,ur=nr.nextSibling,Ft=jt.nextSibling;return a(vt,()=>e("invoices.services")),a(rr,()=>e("invoices.type")),a(yr,()=>e("invoices.qty")),a(nr,()=>e("invoices.arancel")),a(ur,()=>e("invoices.total")),a(Ft,R(Ut,{get each(){return t.invoice?.services},children:$t=>(()=>{var wt=qR(),Zt=wt.firstChild,lt=Zt.nextSibling,er=lt.nextSibling,ir=er.nextSibling;return a(Zt,()=>$t.type),a(lt,()=>Uo($t.qty).toFixed(2)),a(er,(()=>{var sr=Ee(()=>!!$t.arancel);return()=>sr()?l($t.arancel):"-"})()),a(ir,()=>l((Uo($t.qty)||0)*($t.arancel?Uo($t.arancel):0))),Se(sr=>{var _r=K,lr={...K,"text-align":"center"},Lr={...K,"text-align":"right"},on={...K,"text-align":"right"};return sr.e=m(Zt,_r,sr.e),sr.t=m(lt,lr,sr.t),sr.a=m(er,Lr,sr.a),sr.o=m(ir,on,sr.o),sr},{e:void 0,t:void 0,a:void 0,o:void 0}),wt})()})),Se($t=>{var wt=f,Zt=x,lt=ee,er=W,ir={...W,"text-align":"center"},sr={...W,"text-align":"right"},_r={...W,"text-align":"right"};return $t.e=m(We,wt,$t.e),$t.t=m(vt,Zt,$t.t),$t.a=m(Tt,lt,$t.a),$t.o=m(rr,er,$t.o),$t.i=m(yr,ir,$t.i),$t.n=m(nr,sr,$t.n),$t.s=m(ur,_r,$t.s),$t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),We}}),fr),Qt.style.setProperty("display","inline-block"),Qt.style.setProperty("min-width","350px"),a(Qt,R(ze,{get when(){return t.invoice?.products?.length>0},get children(){var We=eh(),vt=We.firstChild,Tt=vt.firstChild,jt=vt.nextSibling;return We.style.setProperty("display","flex"),We.style.setProperty("justify-content","space-between"),We.style.setProperty("margin-bottom","0.5rem"),a(vt,()=>e("invoices.productsSubtotal"),Tt),a(jt,()=>l(t?.parseData?.productSubtotal)),We}}),cr),a(Qt,R(ze,{get when(){return t.invoice?.reservas?.length>0},get children(){var We=eh(),vt=We.firstChild,Tt=vt.firstChild,jt=vt.nextSibling;return We.style.setProperty("display","flex"),We.style.setProperty("justify-content","space-between"),We.style.setProperty("margin-bottom","0.5rem"),a(vt,()=>e("invoices.reservationsSubtotal"),Tt),a(jt,()=>l(t?.parseData?.reservaSubtotal)),We}}),cr),a(Qt,R(ze,{get when(){return t.invoice?.services?.length>0},get children(){var We=eh(),vt=We.firstChild,Tt=vt.firstChild,jt=vt.nextSibling;return We.style.setProperty("display","flex"),We.style.setProperty("justify-content","space-between"),We.style.setProperty("margin-bottom","0.5rem"),a(vt,()=>e("invoices.servicesSubtotal"),Tt),a(jt,()=>l(t?.parseData?.serviceSubtotal)),We}}),cr),a(Qt,R(ze,{get when(){return t?.parseData?.subtotalBeforeTax},get children(){var We=eh(),vt=We.firstChild,Tt=vt.firstChild,jt=vt.nextSibling;return We.style.setProperty("display","flex"),We.style.setProperty("justify-content","space-between"),We.style.setProperty("margin-bottom","0.5rem"),a(vt,()=>e("common.subtotal"),Tt),a(jt,()=>l(t?.parseData?.subtotalBeforeTax)),We}}),xr),a(Qt,R(ze,{get when(){return t?.parseData?.taxAmount},get children(){var We=BR(),vt=We.firstChild,Tt=vt.firstChild,jt=Tt.nextSibling;jt.nextSibling;var Kt=vt.nextSibling;return We.style.setProperty("display","flex"),We.style.setProperty("justify-content","space-between"),We.style.setProperty("margin-bottom","0.5rem"),a(vt,()=>e("common.tax"),Tt),a(vt,()=>t?.parseData.paymentMethods?.taxPercent||7,jt),a(Kt,()=>l(t?.parseData?.taxAmount)),We}}),xr),a(It,()=>e("invoices.total"),Ge),Nt.style.setProperty("color","var(--primary-color)"),a(Nt,()=>l(c().total)),Ue.addEventListener("mouseleave",We=>We.currentTarget.style.opacity="1"),Ue.addEventListener("mouseenter",We=>We.currentTarget.style.opacity="0.9"),Ue.$$click=_,a(Ue,()=>e("invoices.printInvoice"),null),is(nt,"click",kR,!0),_t.addEventListener("mouseleave",We=>{We.currentTarget.style.background="white",We.currentTarget.style.color="var(--primary-color)"}),_t.addEventListener("mouseenter",We=>{We.currentTarget.style.background="var(--primary-color)",We.currentTarget.style.color="white"}),_t.$$click=P,a(_t,()=>e("invoices.exportPdf"),null),a(Lt,R(ze,{get when(){return pr.state?.profile?.isAdmin},get children(){var We=jR();return We.$$click=z,We.addEventListener("mouseleave",vt=>vt.currentTarget.style.opacity="1"),We.addEventListener("mouseenter",vt=>vt.currentTarget.style.opacity="0.9"),Se(vt=>m(We,T,vt)),We}}),null),a(Wt,`
        @media print {
          .invoice-display {
            box-shadow: none !important;
            padding: 0 !important;
          }
          
          ${$} {
            display: none !important;
          }
        }
      `),Se(We=>{var vt=g,Tt=f,jt=x,Kt=S,rr=w,yr=E,nr=q,ur=x,Ft=S,$t=w,wt=E,Zt=q,lt={...E,"margin-top":"0.75rem"},er=q,ir={...E,"margin-top":"0.75rem"},sr=q,_r=w,lr=E,Lr={...E,"margin-top":"0.75rem"},on=q,Ur={...E,"margin-top":"0.75rem"},Yr=q,Et={...f,"text-align":"right"},bn={...te,display:"flex","justify-content":"space-between","padding-top":"0.75rem","border-top":"2px solid #dee2e6"},_i={...te,display:"flex","justify-content":"space-between","padding-top":"0.75rem","border-top":"2px solid #dee2e6"},Si={...f,"text-align":"center",color:"#666","font-size":"0.875rem"},mr=$,Nr=T,Vr={...T,background:"#28a745"},gn=O;return We.e=m(I,vt,We.e),We.t=m(Q,Tt,We.t),We.a=m(se,jt,We.a),We.o=m(G,Kt,We.o),We.i=m(re,rr,We.i),We.n=m(oe,yr,We.n),We.s=m(fe,nr,We.s),We.h=m(Y,ur,We.h),We.r=m(ie,Ft,We.r),We.d=m(de,$t,We.d),We.l=m(ue,wt,We.l),We.u=m(ge,Zt,We.u),We.c=m(De,lt,We.c),We.w=m(Te,er,We.w),We.m=m($e,ir,We.m),We.f=m(Ie,sr,We.f),We.y=m(Re,_r,We.y),We.g=m(Je,lr,We.g),We.p=m(Be,Lr,We.p),We.b=m(Ke,on,We.b),We.T=m(Xe,Ur,We.T),We.A=m(at,Yr,We.A),We.O=m(fr,Et,We.O),We.I=m(cr,bn,We.I),We.S=m(xr,_i,We.S),We.W=m(At,Si,We.W),We.C=m(Lt,mr,We.C),We.B=m(Ue,Nr,We.B),We.v=m(nt,Vr,We.v),We.k=m(_t,gn,We.k),We},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0}),Z})()};br(["click"]);const mu={invoice:"",description:"",store:"",guide:"",shipper_consignee:{name:"",firstName:"",middleName:"",lastName:"",lastName2:"",phoneNumber:"",phoneNumberS:"",cid:"",passport:"",address:""},products:[],reservas:[],services:[],packagesOrder:!1,shippingMethod:"",paymentMethods:{taxOnTotal:!1,taxPercent:0,exemptTaxOnCash:!1,cash:0,zelle:0,creditCard:0}},Ky="invoice_styled_form_draft",UR=()=>{try{const t=localStorage.getItem(Ky);if(t){const e=JSON.parse(t);return{...mu,...e,shipper_consignee:{...mu.shipper_consignee,...e.shipper_consignee||{}},paymentMethods:{...mu.paymentMethods,...e.paymentMethods||{}},products:e.products||[],reservas:e.reservas||[],services:e.services||[]}}}catch(t){console.warn("Failed to load styled invoice form from storage:",t)}return console.log("No saved data found, using default form data"),{...mu}},Jy=t=>{try{localStorage.setItem(Ky,JSON.stringify(t))}catch(e){console.warn("Failed to save styled invoice form to storage:",e)}},vb=()=>{try{localStorage.removeItem(Ky)}catch(t){console.warn("Failed to clear styled invoice form from storage:",t)}},[ul,Qi]=Ce(UR()),[__,$i]=Ce(!1),[HR,ph]=Ce(null);let Ff=null;const po=()=>{Ff&&clearTimeout(Ff),Ff=setTimeout(()=>{const t=ul();Jy(t),ph(new Date),console.log("Styled invoice form auto-saved at",new Date().toLocaleTimeString())},1e3)},Fr={formData:ul,get isDirty(){return __()},get lastSaved(){return HR()},updateForm:t=>{Qi(e=>{const r={...e,...t};return $i(!0),po(),r})},updateShipperConsignee:t=>{Qi(e=>{const r={...e,shipper_consignee:{...e.shipper_consignee,...t}};return $i(!0),po(),r})},updatePaymentMethods:t=>{Qi(e=>{const r={...e,paymentMethods:{...e.paymentMethods,...t}};return $i(!0),po(),r})},addProduct:t=>{Qi(e=>{const r={...e,products:[...e.products,t]};return $i(!0),po(),r})},updateProduct:(t,e)=>{Qi(r=>{const n=[...r.products];n[t]={...n[t],...e};const i={...r,products:n};return $i(!0),po(),i})},removeProduct:t=>{Qi(e=>{const r=e.products.filter((i,o)=>o!==t),n={...e,products:r};return $i(!0),po(),n})},addReserva:t=>{Qi(e=>{const r={...e,reservas:[...e.reservas,t]};return $i(!0),po(),r})},updateReserva:(t,e)=>{Qi(r=>{const n=[...r.reservas];n[t]={...n[t],...e};const i={...r,reservas:n};return $i(!0),po(),i})},removeReserva:t=>{Qi(e=>{const r=e.reservas.filter((i,o)=>o!==t),n={...e,reservas:r};return $i(!0),po(),n})},addService:t=>{Qi(e=>{const r={...e,services:[...e.services,t]};return $i(!0),po(),r})},updateService:(t,e)=>{Qi(r=>{const n=[...r.services];n[t]={...n[t],...e};const i={...r,services:n};return $i(!0),po(),i})},removeService:t=>{Qi(e=>{const r=e.services.filter((i,o)=>o!==t),n={...e,services:r};return $i(!0),po(),n})},clearForm:()=>{Qi({...mu}),$i(!1),vb(),ph(null)},markCompleted:()=>{vb(),$i(!1),ph(null)},forceSave:()=>{Jy(ul()),ph(new Date),$i(!1)},hasData:()=>{const t=ul();return t.invoice!==""||t.description!==""||t.store!==""||t.shipper_consignee.name!==""||t.shipper_consignee.firstName!==""||t.shipper_consignee.cid!==""||t.products.length>0||t.reservas.length>0||t.services.length>0||t.paymentMethods.cash>0||t.paymentMethods.zelle>0||t.paymentMethods.creditCard>0},isValid:()=>{const t=ul();return t.invoice.trim()!==""&&t.shipper_consignee.firstName.trim()!==""&&t.shipper_consignee.lastName.trim()!==""&&t.shipper_consignee.cid.trim()!==""&&(t.products.length>0||t.reservas.length>0||t.services.length>0)},getFormData:()=>ul()};typeof window<"u"&&window.addEventListener("beforeunload",t=>{if(__()&&(Jy(ul()),Fr.hasData()))return t.preventDefault(),t.returnValue="You have unsaved changes in your invoice. Are you sure you want to leave?",t.returnValue});var GR=he("<div>🔄 "),WR=he("<div>⚠️ <div>"),YR=he("<div><span>🔄</span><span>"),th=he("<div>"),KR=he("<div><div><div><input type=text autocomplete=off>"),JR=he("<button type=button>+"),QR=he("<div><div></div><div>"),XR=he("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div></div><div>: "),ZR=he("<span>"),eD=he("<span>⚠️ ");const tD=t=>{const{t:e}=or(),[r,n]=Ce(!1),[i,o]=Ce(""),[s,l]=Ce(-1),[c,u]=Ce(!1),[h,y]=Ce(null),[g,f]=Ce([]),[x,S]=Ce(null),w=t.searchDelay||300,E=t.maxResults||40,q=Mt(()=>{if(!t.value)return null;const Q=g().find(se=>se.id===t.value);return Q||ut.getProductById(t.value)}),ee=async Q=>{if(!Q.trim()){f([]);return}u(!0),y(null);const se=ut.getActiveProducts().filter(G=>G.name.toLowerCase().includes(Q.toLowerCase())||G.sku.toLowerCase().includes(Q.toLowerCase())||G?.UPC?.toLowerCase().includes(Q?.toLowerCase())||G.category.toLowerCase().includes(Q.toLowerCase())).slice(0,E);f(se),u(!1)},W=Mt(()=>i().toLowerCase()?g():ut.getActiveProducts().slice(0,10)),K=()=>{n(!0),o(""),l(-1),y(null),i()||f(ut.getActiveProducts().slice(0,10))},te=Q=>{const G=Q.target.value;o(G),n(!0),l(-1),y(null),x()&&clearTimeout(x());const re=setTimeout(()=>{ee(G)},w);S(re)},$=Q=>{t.onChange(Q.id),n(!1),o(""),l(-1),y(null),x()&&(clearTimeout(x()),S(null))},C=Q=>{const se=W();switch(Q.key){case"ArrowDown":Q.preventDefault(),l(G=>Math.min(G+1,se.length-1));break;case"ArrowUp":Q.preventDefault(),l(G=>Math.max(G-1,-1));break;case"Enter":Q.preventDefault(),s()>=0&&se[s()]&&$(se[s()]);break;case"Escape":n(!1),o(""),l(-1),y(null),x()&&(clearTimeout(x()),S(null));break}},T=Q=>{setTimeout(()=>{n(!1),o(""),l(-1),x()&&(clearTimeout(x()),S(null))},150)},O=Q=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Q),b=Q=>ut.stockLevels.filter(se=>se.productId===Q).reduce((se,G)=>se+G.quantity,0);wn(()=>()=>{x()&&clearTimeout(x())});const P={position:"relative",width:"100%",...t.style},_={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},z={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"400px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},Z=Q=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:Q?"var(--strip-color)":"transparent",color:Q?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),k={display:"flex","justify-content":"space-between","align-items":"center"},F={flex:"1"},X={"font-weight":"500","margin-bottom":"0.25rem"},U={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem","flex-wrap":"wrap"},B={"text-align":"right","font-size":"0.875rem"},ce={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},L={padding:"1rem","text-align":"center",color:"var(--text-muted)",display:"flex","align-items":"center","justify-content":"center",gap:"0.5rem"},D={padding:"1rem","text-align":"center",color:"#d32f2f",background:"#ffebee","border-radius":"var(--border-radius-sm)",margin:"0.5rem","font-size":"0.875rem"},j=()=>r()&&i()?i():q()?`${q().name} (${q().sku})`:"",I={display:"flex","align-items":"stretch",width:"100%"},M={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},J={..._,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"},H={position:"absolute",right:t.onAddNew?"50px":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)","pointer-events":"none"};return(()=>{var Q=KR(),se=Q.firstChild,G=se.firstChild,re=G.firstChild;return m(se,I),G.style.setProperty("position","relative"),G.style.setProperty("flex","1"),re.addEventListener("blur",T),re.$$keydown=C,re.$$click=K,re.$$input=te,a(G,R(ze,{get when(){return c()},get children(){var oe=GR();return oe.firstChild,a(oe,()=>e("common.searching","Searching..."),null),Se(fe=>m(oe,H,fe)),oe}}),null),a(se,(()=>{var oe=Ee(()=>!!t.onAddNew);return()=>oe()&&(()=>{var fe=JR();return fe.addEventListener("mouseleave",ae=>{ae.currentTarget.style.background="var(--surface-color)",ae.currentTarget.style.color="var(--primary-color)"}),fe.addEventListener("mouseenter",ae=>{ae.currentTarget.style.background="var(--primary-color)",ae.currentTarget.style.color="white"}),is(fe,"click",t.onAddNew,!0),m(fe,M),Se(()=>tr(fe,"title",e("inventory.addProduct","Add new product"))),fe})()})(),null),a(Q,R(ze,{get when(){return r()},get children(){var oe=th();return a(oe,R(ze,{get when(){return h()},get children(){var fe=WR(),ae=fe.firstChild,Y=ae.nextSibling;return m(fe,D),a(fe,h,Y),Y.style.setProperty("margin-top","0.5rem"),Y.style.setProperty("font-size","0.75rem"),a(Y,()=>e("inventory.searchFallback","Showing local results")),fe}}),null),a(oe,R(ze,{get when(){return c()},get children(){var fe=YR(),ae=fe.firstChild,Y=ae.nextSibling;return m(fe,L),a(Y,()=>e("common.searching","Searching products...")),fe}}),null),a(oe,R(ze,{get when(){return Ee(()=>!c())()&&W().length>0},get fallback(){return Ee(()=>!c())()&&(()=>{var fe=th();return m(fe,ce),a(fe,(()=>{var ae=Ee(()=>!!i());return()=>ae()?(()=>{var Y=QR(),ie=Y.firstChild,de=ie.nextSibling;return a(ie,()=>e("inventory.noProductsFound","No products found matching your search.")),de.style.setProperty("margin-top","0.5rem"),de.style.setProperty("font-size","0.75rem"),a(de,()=>e("inventory.tryDifferentTerm","Try a different search term or check spelling.")),Y})():e("inventory.noProductsAvailable","No products available.")})()),fe})()},get children(){return[R(Ut,{get each(){return W()},children:(fe,ae)=>{const Y=b(fe.id),ie=Y<=fe.minStockLevel;return(()=>{var de=XR(),ue=de.firstChild,ge=ue.firstChild,Pe=ge.firstChild,pe=Pe.nextSibling,_e=pe.firstChild,Le=_e.firstChild,De=_e.nextSibling,Te=De.nextSibling,$e=Te.nextSibling,Ie=$e.nextSibling,Re=ge.nextSibling,Je=Re.firstChild,Be=Je.firstChild,Ke=Je.nextSibling,Xe=Ke.nextSibling,at=Xe.firstChild;return de.addEventListener("mouseenter",()=>l(ae())),de.$$click=()=>$(fe),m(ue,k),m(ge,F),m(Pe,X),a(Pe,()=>fe.name,null),a(Pe,(()=>{var ot=Ee(()=>!!i());return()=>ot()&&(()=>{var Qe=ZR();return Qe.style.setProperty("margin-left","0.5rem"),Qe.style.setProperty("font-size","0.75rem"),Qe.style.setProperty("color","var(--primary-color)"),Qe.style.setProperty("font-weight","normal"),a(Qe,()=>g().includes(fe)?"🌐 API":"💾 Local"),Qe})()})(),null),m(pe,U),a(_e,()=>e("inventory.sku","SKU"),Le),a(_e,()=>fe.sku,null),a(Te,()=>fe.category),a(Ie,()=>O(fe.unitCost)),a(ge,(()=>{var ot=Ee(()=>!!fe.description);return()=>ot()&&(()=>{var Qe=th();return Qe.style.setProperty("font-size","0.75rem"),Qe.style.setProperty("color","var(--text-muted)"),Qe.style.setProperty("margin-top","0.25rem"),Qe.style.setProperty("font-style","italic"),a(Qe,(()=>{var dt=Ee(()=>fe.description.length>60);return()=>dt()?`${fe.description.substring(0,60)}...`:fe.description})()),Qe})()})(),null),m(Re,B),Je.style.setProperty("font-weight","600"),(ie?"#f44336":"var(--text-primary)")!=null?Je.style.setProperty("color",ie?"#f44336":"var(--text-primary)"):Je.style.removeProperty("color"),a(Je,Y,Be),a(Je,()=>fe.unitOfMeasure,null),Ke.style.setProperty("color","var(--text-muted)"),a(Ke,()=>ie?(()=>{var ot=eD();return ot.firstChild,ot.style.setProperty("color","#f44336"),a(ot,()=>e("inventory.lowStock","Low Stock"),null),ot})():e("inventory.inStock","In Stock")),Xe.style.setProperty("font-size","0.75rem"),Xe.style.setProperty("color","var(--text-muted)"),Xe.style.setProperty("margin-top","0.25rem"),a(Xe,()=>e("inventory.min","Min"),at),a(Xe,()=>fe.minStockLevel,null),Se(ot=>m(de,Z(ae()===s()),ot)),de})()}}),Ee(()=>Ee(()=>W().length===E)()&&(()=>{var fe=th();return fe.style.setProperty("padding","0.5rem"),fe.style.setProperty("text-align","center"),fe.style.setProperty("font-size","0.75rem"),fe.style.setProperty("color","var(--text-muted)"),fe.style.setProperty("border-top","1px solid var(--border-color)"),fe.style.setProperty("font-style","italic"),a(fe,()=>e("inventory.showingTopResults","Showing top {{count}} results",{count:E})),fe})())]}}),null),Se(fe=>m(oe,z,fe)),oe}}),null),Se(oe=>{var fe=P,ae=J,Y=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),ie=t.disabled,de=t.required;return oe.e=m(Q,fe,oe.e),oe.t=m(re,ae,oe.t),Y!==oe.a&&tr(re,"placeholder",oe.a=Y),ie!==oe.o&&(re.disabled=oe.o=ie),de!==oe.i&&(re.required=oe.i=de),oe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>re.value=j()),Q})()};br(["input","click","keydown"]);var rD=he("<label>"),Of=he("<div>"),nD=he("<div><span>🔄</span><span>"),iD=he("<div><input type=text autocomplete=off>"),oD=he("<span>📞 "),sD=he("<span>🆔 "),aD=he("<span>📧 "),lD=he("<div><div><div><div>👤 </div><div>");const cD=t=>{const{t:e}=or(),[r,n]=Ce(!1),[i,o]=Ce(""),[s,l]=Ce(-1),[c,u]=Ce(!1),[h,y]=Ce([]),[g,f]=Ce(null),x=async F=>{if(!F.trim()||F.trim().length<6){y([]);return}try{u(!0);const X=await vi.getConsigee(F);console.log(X);const U=Object.values(X).map(B=>({id:B.consigneeId,firstName:B.firstName+(B.middleName?" "+B.middleName:""),fullName:B.firstName+(B.middleName?" "+B.middleName:"")+" "+B.lastName+" "+B.lastName2,lastName:B.lastName+" "+B.lastName2,cid:B.cid,phoneNumber:B.phoneNumber,ybbetwen1:B.ybbetwen1,ybcity:B.ybcity,ybestate:B.ybestate,ybreparto:B.ybreparto,ybstreet:B.ybstreet,ybstreetNo:B.ybstreetNo,address:`Calle ${B.ybstreet}${B.ybstreetNo?" # "+B.ybstreetNo:""}${B.ybbetwen1?" / "+B.ybbetwen1:""}${B.ybbetwen2?" y "+B.ybbetwen2:""}${B.ybreparto?", Rpto "+B.ybreparto:""}, ${B.ybcity?B.ybcity:""}, ${B.ybestate?B.ybestate:""}`}));y(U)}catch(X){console.warn("API search failed, falling back to local search:",X)}finally{u(!1)}},S=()=>{n(!0),o(""),l(-1),i()||x("")},w=F=>{const U=F.target.value;o(U),n(!0),l(-1),g()&&clearTimeout(g());const B=setTimeout(()=>{x(U)},600);f(B)},E=F=>{t.onChange(F),n(!1),o(""),l(-1),g()&&(clearTimeout(g()),f(null))},q=F=>{const X=h();switch(F.key){case"ArrowDown":F.preventDefault(),l(U=>Math.min(U+1,X.length-1));break;case"ArrowUp":F.preventDefault(),l(U=>Math.max(U-1,-1));break;case"Enter":F.preventDefault(),s()>=0&&X[s()]&&E(X[s()]);break;case"Escape":n(!1),o(""),l(-1),g()&&(clearTimeout(g()),f(null));break}},ee=F=>{setTimeout(()=>{n(!1),o(""),l(-1),g()&&(clearTimeout(g()),f(null))},150)},W=()=>r()&&i()?i():t.value?t.value.cid:"";wn(()=>(x(""),()=>{g()&&clearTimeout(g())}));const K={position:"relative",width:"100%",...t.style},te={display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.25rem"},$={"font-size":"0.75rem",color:"var(--text-muted)","margin-bottom":"0.5rem","font-style":"italic"},C={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},T={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},O=F=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:F?"var(--strip-color)":"transparent",color:F?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),b={display:"flex","justify-content":"space-between","align-items":"flex-start"},P={flex:"1"},_={"font-weight":"500","margin-bottom":"0.25rem"},z={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex","flex-direction":"column",gap:"0.125rem"},Z={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},k={padding:"1rem","text-align":"center",color:"var(--text-muted)",display:"flex","align-items":"center","justify-content":"center",gap:"0.5rem"};return(()=>{var F=iD(),X=F.firstChild;return a(F,R(ze,{get when(){return t.label},get children(){var U=rD();return m(U,te),a(U,()=>t.label),U}}),X),a(F,R(ze,{get when(){return t.description},get children(){var U=Of();return m(U,$),a(U,()=>t.description),U}}),X),X.addEventListener("blur",ee),X.$$keydown=q,X.$$click=S,X.$$input=w,a(F,R(ze,{get when(){return r()},get children(){var U=Of();return a(U,R(ze,{get when(){return c()},get children(){var B=nD(),ce=B.firstChild,L=ce.nextSibling;return m(B,k),a(L,()=>e("common.searching","Buscando clientes...")),B}}),null),a(U,R(ze,{get when(){return Ee(()=>!c())()&&h().length>0},get fallback(){return Ee(()=>!c())()&&(()=>{var B=Of();return m(B,Z),a(B,(()=>{var ce=Ee(()=>!!i());return()=>ce()?e("customer.noCustomersFound","No se encontraron clientes. Puede crear un nuevo cliente llenando el formulario."):e("customer.noCustomersAvailable","No se encontraron clientes previos. Se creará un nuevo cliente.")})()),B})()},get children(){return R(Ut,{get each(){return h()},children:(B,ce)=>(()=>{var L=lD(),D=L.firstChild,j=D.firstChild,I=j.firstChild;I.firstChild;var M=I.nextSibling;return L.addEventListener("mouseenter",()=>l(ce())),L.$$click=()=>E(B),m(D,b),m(j,P),m(I,_),a(I,()=>B.fullName,null),m(M,z),a(M,R(ze,{get when(){return B.phoneNumber},get children(){var J=oD();return J.firstChild,a(J,()=>B.phoneNumber,null),J}}),null),a(M,R(ze,{get when(){return B.cid},get children(){var J=sD();return J.firstChild,a(J,()=>B.cid,null),J}}),null),a(M,R(ze,{get when(){return B.email},get children(){var J=aD();return J.firstChild,a(J,()=>B.email,null),J}}),null),Se(J=>m(L,O(ce()===s()),J)),L})()})}}),null),Se(B=>m(U,T,B)),U}}),null),Se(U=>{var B=K,ce=C,L=t.placeholder||e("customer.searchPlaceholder","Buscar clientes por nombre, teléfono, ID..."),D=t.disabled,j=t.required;return U.e=m(F,B,U.e),U.t=m(X,ce,U.t),L!==U.a&&tr(X,"placeholder",U.a=L),D!==U.o&&(X.disabled=U.o=D),j!==U.i&&(X.required=U.i=j),U},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>X.value=W()),F})()};br(["input","click","keydown"]);var uD=he("<label>"),Bf=he("<div>"),dD=he("<div><span>🔄</span><span>"),hD=he("<div><input type=text autocomplete=off>"),pD=he("<span>📞 "),fD=he("<div><div><div><div>👤 </div><div>");const mD=t=>{const{t:e}=or(),[r,n]=Ce(!1),[i,o]=Ce(""),[s,l]=Ce(-1),[c,u]=Ce(!1),[h,y]=Ce([]),[g,f]=Ce(null),x=600,S=async X=>{if(!X.trim()||X.trim().length<6){y([]);return}try{u(!0);const U=await vi.getShipper(X),B=Object.values(U).map(ce=>({id:ce.shipperId,name:ce.name,dob:ce.dob,phoneNumberS:ce.phoneNumber}));y(B)}catch(U){console.warn("API search failed, falling back to local search:",U)}finally{u(!1)}},w=X=>{const B=X.target.value;o(B),n(!0),l(-1),g()&&clearTimeout(g());const ce=setTimeout(()=>{S(B)},x);f(ce)},E=()=>{n(!0),o(""),l(-1),i()||S("")},q=X=>{t.onChange(X),n(!1),o(""),l(-1),g()&&(clearTimeout(g()),f(null))},ee=X=>{const U=h();switch(X.key){case"ArrowDown":X.preventDefault(),l(B=>Math.min(B+1,U.length-1));break;case"ArrowUp":X.preventDefault(),l(B=>Math.max(B-1,-1));break;case"Enter":X.preventDefault(),s()>=0&&U[s()]&&q(U[s()]);break;case"Escape":n(!1),o(""),l(-1),g()&&(clearTimeout(g()),f(null));break}},W=X=>{setTimeout(()=>{n(!1),o(""),l(-1),g()&&(clearTimeout(g()),f(null))},150)},K=()=>r()&&i()?i():t.value?t.value.name:"";wn(()=>(S(""),()=>{g()&&clearTimeout(g())}));const te={position:"relative",width:"100%",...t.style},$={display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.25rem"},C={"font-size":"0.75rem",color:"var(--text-muted)","margin-bottom":"0.5rem","font-style":"italic"},T={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},O={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},b=X=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:X?"var(--strip-color)":"transparent",color:X?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),P={display:"flex","justify-content":"space-between","align-items":"flex-start"},_={flex:"1"},z={"font-weight":"500","margin-bottom":"0.25rem"},Z={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex","flex-direction":"column",gap:"0.125rem"},k={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},F={padding:"1rem","text-align":"center",color:"var(--text-muted)",display:"flex","align-items":"center","justify-content":"center",gap:"0.5rem"};return(()=>{var X=hD(),U=X.firstChild;return a(X,R(ze,{get when(){return t.label},get children(){var B=uD();return m(B,$),a(B,()=>t.label),B}}),U),a(X,R(ze,{get when(){return t.description},get children(){var B=Bf();return m(B,C),a(B,()=>t.description),B}}),U),U.addEventListener("blur",W),U.$$keydown=ee,U.$$click=E,U.$$input=w,a(X,R(ze,{get when(){return r()},get children(){var B=Bf();return a(B,R(ze,{get when(){return c()},get children(){var ce=dD(),L=ce.firstChild,D=L.nextSibling;return m(ce,F),a(D,()=>e("common.searching","Buscando clientes...")),ce}}),null),a(B,R(ze,{get when(){return Ee(()=>!c())()&&h().length>0},get fallback(){return Ee(()=>!c())()&&(()=>{var ce=Bf();return m(ce,k),a(ce,(()=>{var L=Ee(()=>!!i());return()=>L()?e("customer.noShippersFound","No se encontraron clientes. Puede crear un nuevo cliente llenando el formulario."):e("customer.noShippersAvailable","No se encontraron clientes previos. Se creará un nuevo cliente.")})()),ce})()},get children(){return R(Ut,{get each(){return h()},children:(ce,L)=>(()=>{var D=fD(),j=D.firstChild,I=j.firstChild,M=I.firstChild;M.firstChild;var J=M.nextSibling;return D.addEventListener("mouseenter",()=>l(L())),D.$$click=()=>q(ce),m(j,P),m(I,_),m(M,z),a(M,()=>ce.name,null),m(J,Z),a(J,R(ze,{get when(){return ce.phoneNumberS},get children(){var H=pD();return H.firstChild,a(H,()=>ce.phoneNumberS,null),H}})),Se(H=>m(D,b(L()===s()),H)),D})()})}}),null),Se(ce=>m(B,O,ce)),B}}),null),Se(B=>{var ce=te,L=T,D=t.placeholder||e("customer.searchPlaceholder","Buscar clientes por nombre, teléfono, ID..."),j=t.disabled,I=t.required;return B.e=m(X,ce,B.e),B.t=m(U,L,B.t),D!==B.a&&tr(U,"placeholder",B.a=D),j!==B.o&&(U.disabled=B.o=j),I!==B.i&&(U.required=B.i=I),B},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>U.value=K()),X})()};br(["input","click","keydown"]);var yD=he("<div>⚠️ "),$c=he("<div>"),gD=he('<div><h3>👤 Informacion del Cliente</h3><div></div><div><div><label>Nombre del Cliente/Empresa *</label><input type=text placeholder="ej., Juan Perez o Empresa ABC"required></div><div><label>Numero de Telefono Principal</label><input type=tel placeholder="ej., +53-5-123-4567">'),vD=he('<div><h3>👤 Informacion del Destinatario</h3><div></div><div><label>Primer Nombre</label><input type=text placeholder="ej., Juan"></div><div><label>Apellido</label><input type=text placeholder="ej., Perez"></div><div><label>Numero de Identificacion</label><input type=text placeholder="ej., 12345678901 o A1234567"></div><div><label>Numero de Pasaporte</label><input type=text placeholder="ej., AB1234567"></div><div><label>Numero de Telefono Principal</label><input type=tel placeholder="ej., +53-5-123-4567"></div><div><label>Direccion de Entrega/Facturacion</label><textarea placeholder="ej., Calle 23 #456, Apto 4B, Vedado, La Habana, 10400">'),bb=he("<div><strong>Subtotal: $"),bD=he("<div><div><span>🎫 Reservas y Servicios</span><button>➕ Agregar Servicio/Reserva"),_D=he("<div><strong>Subtotal Servicios: $"),SD=he("<div><div><span>🛠️ Servicios Adicionales</span><button>➕ Agregar Servicio</button></div><div>Servicios de transporte, cajas, rapeado y otros cargos adicionales."),PD=he("<div><div><span>📦 Productos y Articulos</span></div><div><label>Agregar Productos a la Factura"),wD=he("<div><div>Vista previa del calculo:</div><div>Subtotal: $</div><div>• Del Subtotal: $<!>(Total: $<!>)</div><div>• Del Total: $<!>(Total: $<!>)"),xD=he("<div><div>💰 Beneficio por Pago en Efectivo:</div><div>Efectivo: $<!> (<!>% del pago)</div><div>Ahorro en impuestos: $</div><div>Impuesto original: $<!> → Impuesto final: $"),AD=he("<div><label><input type=checkbox><span>💵 Exencion de Impuesto por Pago en Efectivo</span></label><div>Los pagos en efectivo estaran exentos de impuestos. Mientras mayor sea el porcentaje pagado en efectivo, mayor sera la exencion."),CD=he("<div><div><label>Impuesto (%)</label><div>Porcentaje de impuesto. Puede aplicarse sobre el subtotal o como porcentaje del total final.</div><input type=number placeholder=0 min=0 max=99 step=0.01><div><div><label><input type=radio name=taxMethod><span>Del Subtotal (tradicional)</span></label><div>Impuesto = Subtotal × <!>%</div><label><input type=radio name=taxMethod><span>Del Total Final</span></label><div>El impuesto representa el <!>% del total final"),ID=he("<span>💰 Sin impuesto"),$D=he('<div><div><span>💳 Metodos de Pago</span></div><div>Distribuya el pago total entre los diferentes metodos de pago disponibles.</div><div><button type=button>💵 Todo Efectivo</button><button type=button title="Pagar todo por Zelle">📱 Todo Zelle</button><button type=button title="Pagar todo con tarjeta">💳 Todo Tarjeta</button><button type=button title="Limpiar todos los pagos">🗑️ Limpiar</button></div><div><div><label>💵 Efectivo</label><input type=text placeholder=0.00 min=0 step=0.01></div><div><label>📱 Zelle</label><input type=text placeholder=0.00 min=0 step=0.01></div></div><div><label>💳 Tarjeta de Credito</label><input type=text placeholder=0.00 min=0 step=0.01></div><div><div><div>Total de Pagos: <strong>$</strong></div><div>Balance: <strong>$</strong></div></div><div><div>Total a Pagar: <strong>$</strong></div><div>'),ED=he("<div>Servicios: $"),TD=he("<span>(Ahorro: $<!>)"),kD=he("<div>Impuesto (<!>% <!>): $"),ND=he("<div><div><div>Productos: $</div><div>Reservas: $</div><div>Subtotal: $</div><div>Total: $"),LD=he("<span><span></span>Auto-guardando cambios..."),RD=he("<span><span></span>Guardado: "),DD=he("<button>Limpiar Formulario"),MD=he("<div><div>"),FD=he("<button>"),OD=he("<div><button></button><button>🆕 Nueva Factura"),BD=he('<div><h2>📄 Crear Nueva Factura</h2><div><div><div><h3>📋 Informacion de Factura</h3><div><div><label>Numero de Factura *</label><input type=text></div><div><label>Ubicacion de Tienda *</label></div></div><div><div><label>Metodo de Envio</label><div>Seleccione el metodo de transporte para esta orden.</div><select><option value>Seleccionar metodo...</option><option value=AEREO>✈️ Aereo (Avion)</option><option value=SEA>🚢 Maritimo (Barco)</option></select></div><div><label>fecha</label><div>Seleccione una fecha si es diferente al dia de hoy.</div><input type=date></div><div><label>No de Guia</label><select><option value=all></option></select></div></div><div><label>Descripcion de Factura</label><textarea placeholder="ej., Venta regular, pedido mayorista, descuento especial aplicado..."></textarea></div><label><input type=checkbox><div><span>Orden de Paquete/Envio</span><div>Marque esto si esta factura incluye servicios de envio o manejo de paquetes.</div></div></label></div></div><div>'),jD=he("<option>"),_b=he("<span> ($<!>)"),VD=he("<div>(<!>×<!>+<!>)"),qD=he("<div><div><button>×</button></div><div><div><label>Cant (lbs)</label></div><div><label>Precio</label></div><div><label>Arancel</label></div><div>$"),zD=he("<div><div><div><div></div><div></div></div><button>×</button></div><div><div>$"),UD=he("<input step=0.01>"),S_=he("<div><div><input type=text autocomplete=off><div>"),HD=he("<div><div><button>×</button></div><div><div><label>Cantidad</label></div><div><label>Precio/Cargo</label></div><div><label>Total</label><input type=text disabled>");const Sb=["🚛 Transportación","📦 Cajas","🔧 Servicio de Rapeado","🛠️ Otros Servicios"],Pb=["👕 Ropa y Zapatos","👕 Ropa","👞 Zapatos","👒 Sombreros y Gorras","🧥 Abrigos y Chaquetas","👖 Pantalones y Jeans","👗 Vestidos","🩱 Ropa de Baño","🧦 Calcetines y Medias","🩲 Ropa Interior","👶 Ropa de Bebe","📺 TV","📱 Telefono Movil","💻 Computadora/Laptop","⌨️ Teclados","🖱️ Mouse","🎧 Audifonos","🔌 Cables y Accesorios","🔋 Baterias","📷 Camaras","🎥 Videocamaras","📻 Radios","💾 USB y Memorias","🖨️ Impresoras","📽️ Proyectores","🕹️ Controles de Videojuegos","🎮 Consolas de Videojuegos","📡 Antenas","💡 Bombillas LED","🔦 Linternas","🏠 Utiles del Hogar","🛏️ Articulos para el Hogar","🪑 Muebles","🛋️ Sofas y Sillones","🚪 Puertas y Ventanas","🔑 Cerraduras y Llaves","🧽 Articulos de Limpieza","🧼 Productos de Limpieza","🧴 Detergentes","🕯️ Velas","🖼️ Cuadros y Decoraciones","🪴 Plantas y Macetas","🔨 Herramientas de Casa","⚡ Articulos Electricos","🌀 Ventiladores","❄️ Aires Acondicionados","🔥 Calentadores","💊 Medicamentos","🧴 Productos de Belleza","💄 Maquillaje","🧴 Shampoo y Acondicionador","🧼 Jabones","🪥 Cepillos de Dientes","🧻 Papel Higienico","🧴 Aseo Personal","💉 Equipos Medicos","🏥 Suministros Medicos","🩹 Vendas y Curitas","🌡️ Termometros","👓 Lentes Recetados","🕶️ Lentes de Sol","🍫 Alimentos","🍞 Pan y Panaderia","🥛 Lacteos","🥫 Alimentos Enlatados","🍝 Pasta y Granos","☕ Cafe y Te","🧂 Condimentos y Especias","🍯 Miel y Mermeladas","🍷 Bebidas Alcoholicas","🥤 Bebidas y Refrescos","🍬 Dulces y Golosinas","🏃 Articulos Deportivos","⚽ Balones","🏀 Equipos de Baloncesto","🎾 Equipos de Tenis","🏸 Badminton","🏊 Articulos de Natacion","🚴 Bicicletas y Accesorios","🛴 Patinetas","🎣 Equipos de Pesca","🏕️ Equipos de Camping","🎯 Juegos de Mesa","🧸 Juguetes","📚 Libros","📰 Revistas y Periodicos","🎮 Videojuegos","🎵 Instrumentos Musicales","🎸 Guitarras","🎹 Teclados Musicales","🥁 Instrumentos de Percusion","🎨 Materiales de Arte","✏️ Lapices y Boligrafos","📝 Cuadernos y Papeleria","🖍️ Crayones y Marcadores","🎭 Disfraces","🃏 Cartas y Juegos","🚗 Repuestos de Auto","🛞 Llantas","🔧 Herramientas Automotrices","🛢️ Aceites y Lubricantes","🚨 Accesorios para Auto","🗝️ Llaves de Auto","📻 Radios para Auto","🪟 Vidrios para Auto","💺 Asientos para Auto","🔧 Herramientas","🔨 Martillos","🪚 Sierras","🔩 Tornillos y Clavos","⚙️ Repuestos Mecanicos","🧰 Cajas de Herramientas","📏 Instrumentos de Medicion","🔬 Equipos de Laboratorio","📊 Equipos de Oficina","🖥️ Monitores","📠 Fax","📞 Telefonos","🧳 Maletas","🎒 Mochilas","👜 Bolsos y Carteras","🛄 Equipaje","🗺️ Mapas y Guias","🧭 Brujulas","💍 Joyeria","⌚ Relojes","📿 Collares","💎 Piedras Preciosas","👑 Accesorios de Lujo","🔗 Cadenas","💍 Anillos","👂 Aretes","♿ Sillas de Rueda","🚛 Transportacion","📦 Cajas","🔧 Servicio de Rapeado","🧼 Servicios de Aseo","📋 Servicios Profesionales","🛠️ Reparaciones","📞 Servicios de Comunicacion","💼 Servicios Empresariales","🏗️ Servicios de Construccion","🎁 Regalos","🎉 Articulos de Fiesta","🎈 Globos y Decoraciones","🕯️ Articulos Religiosos","📿 Articulos Espirituales","🧿 Amuletos","🔮 Articulos Misticos","🎪 Articulos de Entretenimiento","🎨 Manualidades","🧵 Costura y Tejido","✂️ Tijeras y Cortadores","📐 Utiles Escolares","🎓 Articulos Educativos","🔍 Lupas y Microscopios","🌡️ Instrumentos de Medicion","📡 Equipos de Comunicacion","⚖️ Balanzas","🔒 Candados y Seguridad","🚨 Alarmas","📹 Sistemas de Vigilancia"],GD={padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--background-color)"},rt={container:{padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)"},header:{"font-size":"1.5rem","font-weight":"700",color:"var(--text-primary)","margin-bottom":"1.5rem"},grid:{display:"grid","grid-template-columns":"repeat(auto-fit, minmax(350px, 1fr))",gap:"1.5rem"},section:{background:"var(--background-color)",padding:"1.25rem","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},sectionTitle:{"font-size":"1.125rem","font-weight":"600",color:"var(--text-primary)","margin-bottom":"1rem",display:"flex","align-items":"center",gap:"0.5rem"},formGroup:{"margin-bottom":"1rem"},label:{display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.25rem"},fieldDescription:{"font-size":"0.75rem",color:"var(--text-muted)","margin-bottom":"0.5rem","line-height":"1.4","font-style":"italic"},input:{width:"100%",padding:"0.625rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",background:"var(--surface-color)",transition:"border-color 0.2s",outline:"none"},textarea:{width:"100%",padding:"0.625rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",background:"var(--surface-color)",resize:"vertical","min-height":"60px"},button:{padding:"0.625rem 1.25rem",border:"none","border-radius":"var(--border-radius-sm)","font-size":"0.875rem","font-weight":"500",cursor:"pointer",transition:"all 0.2s",display:"inline-flex","align-items":"center",gap:"0.5rem"},primaryButton:{background:"var(--primary-color)",color:"white"},secondaryButton:{background:"var(--secondary-color)",color:"white"},successButton:{background:"#4CAF50",color:"white"},alert:{padding:"0.75rem 1rem","border-radius":"var(--border-radius-sm)","margin-bottom":"1rem","font-size":"0.875rem",display:"flex","align-items":"center",gap:"0.5rem"},errorAlert:{background:"#ffebee",border:"1px solid #ffcdd2",color:"#d32f2f"},successAlert:{background:"#e8f5e9",border:"1px solid #c8e6c9",color:"#2e7d32"},productWrapItem:{padding:"0.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"0.5rem"},productItem:{display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem","margin-bottom":"0.5rem"},smallInput:{width:"70px",padding:"0.375rem 0.5rem","font-size":"0.8125rem"},removeButton:{background:"none",border:"none",color:"#f44336",cursor:"pointer","font-size":"1.25rem",padding:"0.25rem"},totalSection:{padding:"1rem","border-radius":"var(--border-radius-sm)","text-align":"right"},gridTwo:{display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"}},WD=()=>{const{t}=or(),e=Fr.formData,r=ie=>Fr.updateForm(ie),[n,i]=Ce(null),[o,s]=Ce(""),[l,c]=Ce(""),[u,h]=Ce(null);wn(()=>{console.log("Styled invoice form mounted, loaded data:",e()),Fr.hasData()&&(w("Form data restored from previous session"),setTimeout(()=>w(""),3e3))});const[y,g]=Ce(!1),[f,x]=Ce(""),[S,w]=Ce(""),[E,q]=Ce(""),[ee,W]=Ce(!1),K=ie=>{if(!ie)return"";const de=ut.getLocationById(ie),ue=de?.code||de?.name?.substring(0,3).toUpperCase()||"INV",Pe=new Date().toISOString().slice(0,10).replace(/-/g,"");return`${SP(6)}-${ue}-${Pe}`};gi(()=>{const ie=o();if(ie&&!e().invoice.trim()){const de=K(ie);c(de),r({invoice:de})}}),gi(()=>{const ie=n();ie&&Fr.updateShipperConsignee({name:ie.name,firstName:ie.firstName||"",lastName:ie.lastName||"",phoneNumber:ie.phoneNumber||"",cid:ie.cid||"",passport:ie.passport||"",address:ie.address||""})}),gi(()=>{});const te=ie=>{const de=ut.getProductById(ie);if(!de)return;const ue={id:Date.now().toString(),product:{id:de.id,code:de.sku||"",label:de.name||"",price:de.unitCost||0},qty:1,salePrice:de.unitCost||0,total:de.unitCost||0};Fr.addProduct(ue)},$=ie=>{s(ie),r({store:ie})},C=ie=>{i(de=>({...de,...ie}))},T=ie=>{h({name:ie?.name}),i(de=>({...de,phoneNumberS:ie?.phoneNumberS,name:ie?.name,dob:ie?.dob}))},O=(ie,de,ue)=>{const ge=e().products,Pe=ge.findIndex(pe=>pe.id===ie);if(Pe!==-1){const pe={...ge[Pe],[de]:ue};pe.total=pe.qty*pe.salePrice,Fr.updateProduct(Pe,pe)}},b=ie=>{const de=e().products.findIndex(ue=>ue.id===ie);de!==-1&&Fr.removeProduct(de)},P=()=>{const ie={id:Date.now().toString(),type:"",qty:1,price:0,arancel:0,total:0};Fr.addReserva(ie)},_=()=>{const ie={id:Date.now().toString(),type:"",qty:0,price:0,arancel:0,total:0};Fr.addService(ie)},z=(ie,de,ue)=>{const ge=e().reservas,Pe=ge.findIndex(pe=>pe.id===ie);if(Pe!==-1){const pe={...ge[Pe],[de]:ue};(de==="qty"||de==="price"||de==="arancel")&&(pe.total=Number(pe.qty)*Number(pe.price)+Number(pe.arancel)),Fr.updateReserva(Pe,pe)}},Z=ie=>{const de=e().reservas.findIndex(ue=>ue.id===ie);de!==-1&&Fr.removeReserva(de)},k=(ie,de,ue)=>{const ge=e().services,Pe=ge.findIndex(pe=>pe.id===ie);if(Pe!==-1){const pe={...ge[Pe],[de]:ue};(de==="qty"||de==="arancel")&&(pe.total=Number(pe.qty)*Number(pe.arancel)),Fr.updateService(Pe,pe)}},F=ie=>{const de=e().services.findIndex(ue=>ue.id===ie);de!==-1&&Fr.removeService(de)},X=()=>e().products.reduce((ie,de)=>ie+de.total,0),U=()=>e().reservas.reduce((ie,de)=>ie+de.total,0),B=()=>e().services.reduce((ie,de)=>ie+de.total,0),ce=()=>X()+U()+B(),L=()=>{if(e()?.paymentMethods.taxPercent===0)return 0;if(e()?.paymentMethods.exemptTaxOnCash){const ie=I()>0?e().paymentMethods.cash/I():0,de=Math.min(ie,1);let ue;return e()?.paymentMethods.taxOnTotal?ue=ce()/(1-e()?.paymentMethods.taxPercent/100)-ce():ue=ce()*(e()?.paymentMethods.taxPercent/100),ue*(1-de)}return e()?.paymentMethods.taxOnTotal?ce()/(1-e()?.paymentMethods?.taxPercent/100)-ce():ce()*(e()?.paymentMethods?.taxPercent/100)},D=()=>{if(!e()?.paymentMethods.exemptTaxOnCash||e()?.paymentMethods.taxPercent===0)return 0;const ie=I()>0?e().paymentMethods.cash/I():0,de=Math.min(ie,1);let ue;return e()?.paymentMethods.taxOnTotal?ue=ce()/(1-e()?.paymentMethods?.taxPercent/100)-ce():ue=ce()*(e()?.paymentMethods?.taxPercent/100),ue*de},j=()=>ce()+L(),I=()=>{const ie=e().paymentMethods;return ie.cash+ie.zelle+ie.creditCard},M=()=>j()-I(),J=(ie,de)=>{Fr.updatePaymentMethods({[ie]:de})},H=(ie,de)=>{Fr.updatePaymentMethods({[ie]:de})},Q=ie=>{const de=j();Fr.updatePaymentMethods({cash:ie==="cash"?de:0,zelle:ie==="zelle"?de:0,creditCard:ie==="creditCard"?de:0})},se=()=>{Fr.updatePaymentMethods({cash:0,zelle:0,creditCard:0})},G=async()=>{g(!0),x(""),w("");try{if(!e().invoice.trim())throw new Error("Numero de factura es requerido");if(!e().shipper_consignee.name.trim())throw new Error("Nombre del cliente es requerido");if(e().products.length===0&&e().reservas.length===0&&e().services.length===0)throw new Error("Al menos un producto, reserva o servicio es requerido");if(Math.round(M())>.01)throw new Error(`El total de pagos (${I().toFixed()}) no coincide con el total de la factura (${j().toFixed()})`);const ie={...e(),type:"SALES",ssg_inventory_key:`INVOICE-${Date.now()}`,ssg_sorder_key:`SO-${Date.now()}`,createDate:e().createDate||Date.now(),businessId:"YB100423253156428",isCompleted:!0,productSubtotal:X(),reservaSubtotal:U(),serviceSubtotal:B(),subtotalBeforeTax:ce(),taxAmount:L(),taxSavings:D(),total:j(),shippingMethod:e().shippingMethod,taxCalculationMethod:e()?.paymentMethods.taxOnTotal?"total":"subtotal",cashPaymentRatio:I()>0?e().paymentMethods.cash/I():0,paymentMethods:e().paymentMethods};console.log("createInvoice",JSON.stringify(ie,null,4));const de=await vi.addInventory(ie);vi.addInvoice(de),q(de.data),w("✅ Invoice created successfully! You can now generate a PDF."),Fr.markCompleted(),oe()}catch(ie){x(ie.message||"Error creating invoice")}finally{g(!1)}},re=async()=>{if(E()){W(!0),x("");try{const{generateEnhancedInvoicePDF:ie}=await Bi(async()=>{const{generateEnhancedInvoicePDF:Pe}=await import("./enhancedInvoicePdfGenerator-BcCfFQpz.js");return{generateEnhancedInvoicePDF:Pe}},[]);console.log(JSON.stringify(e()));const ue={invoiceId:E(),shippingMethod:e().shippingMethod,taxPercent:e()?.paymentMethods.taxPercent,taxOnTotal:e()?.paymentMethods.taxOnTotal,exemptTaxOnCash:e()?.paymentMethods.exemptTaxOnCash,paymentMethods:e().paymentMethods,productSubtotal:X(),reservaSubtotal:U(),subtotalBeforeTax:ce(),taxAmount:L(),taxSavings:e()?.paymentMethods.exemptTaxOnCash?ce()*e()?.paymentMethods.taxPercent/100-L():0,total:j(),cashPaymentRatio:I()>0?e().paymentMethods.cash/I():0};console.log(JSON.stringify(ue));const ge=await ie({...e(),...ue},"es","modern");w(`📄 PDF generated successfully: ${ge}`)}catch(ie){x(ie.message||"Error generating PDF")}finally{W(!1)}}},oe=()=>{Fr.clearForm(),q(""),w(""),x("")},fe=()=>Fr.hasData()&&Fr.isDirty,ae=()=>{fe()?confirm("Are you sure you want to clear the form? All unsaved changes will be lost.")&&oe():oe()};wn(()=>{});const Y=Mt(()=>{const ie=new Set([2516,2517,2518,2519,2520,2521,2522,2523].map(de=>de));return Array.from(ie).sort((de,ue)=>de-ue)});return(()=>{var ie=BD(),de=ie.firstChild,ue=de.nextSibling,ge=ue.firstChild,Pe=ge.firstChild,pe=Pe.firstChild,_e=pe.nextSibling,Le=_e.firstChild,De=Le.firstChild,Te=De.nextSibling,$e=Le.nextSibling,Ie=$e.firstChild,Re=_e.nextSibling,Je=Re.firstChild,Be=Je.firstChild,Ke=Be.nextSibling,Xe=Ke.nextSibling,at=Je.nextSibling,ot=at.firstChild,Qe=ot.nextSibling,dt=Qe.nextSibling,ct=at.nextSibling,kt=ct.firstChild,gt=kt.nextSibling,qe=gt.firstChild,Dt=Re.nextSibling,Rt=Dt.firstChild,St=Rt.nextSibling,Bt=Dt.nextSibling,fr=Bt.firstChild,Qt=fr.nextSibling,cr=Qt.firstChild,xr=cr.nextSibling,It=ge.nextSibling;return a(ie,R(ze,{get when(){return f()},get children(){var Ge=yD();return Ge.firstChild,a(Ge,f,null),Se(Nt=>m(Ge,{...rt.alert,...rt.errorAlert},Nt)),Ge}}),ue),a(ie,R(ze,{get when(){return S()},get children(){var Ge=$c();return a(Ge,S),Se(Nt=>m(Ge,{...rt.alert,...rt.successAlert},Nt)),Ge}}),ue),Te.$$input=Ge=>r({invoice:Ge.target.value}),a($e,R(zu,{get value(){return o()},onChange:$,get placeholder(){return t("inventory.selectStoreLocation","Buscar y seleccionar ubicacion de tienda...")},filterType:"store",required:!0}),null),Xe.addEventListener("change",Ge=>r({shippingMethod:Ge.currentTarget.value})),dt.addEventListener("change",Ge=>r({createDate:Ge.currentTarget.value})),m(dt,GD),gt.addEventListener("change",Ge=>r({guide:Ge.currentTarget.value})),gt.style.setProperty("width","100%"),gt.style.setProperty("padding","0.5rem"),gt.style.setProperty("border","1px solid var(--border-color)"),gt.style.setProperty("border-radius","var(--border-radius-sm)"),gt.style.setProperty("background","var(--surface-color)"),a(qe,()=>t("common.all","All")),a(gt,R(Ut,{get each(){return Y()},children:Ge=>(()=>{var Nt=jD();return Nt.value=Ge,a(Nt,Ge),Nt})()}),null),St.$$input=Ge=>r({description:Ge.target.value}),fr.addEventListener("change",Ge=>r({packagesOrder:Ge.target.checked})),a(ge,R(ze,{get when(){return Ee(()=>!!(e().shippingMethod&&e().invoice&&e().guide))()&&o()},get children(){return[(()=>{var Ge=gD(),Nt=Ge.firstChild,At=Nt.nextSibling,Lt=At.nextSibling,Ue=Lt.firstChild,nt=Ue.firstChild,_t=nt.nextSibling,Wt=Ue.nextSibling,We=Wt.firstChild,vt=We.nextSibling;return a(At,R(mD,{get value(){return u()},onChange:T,label:"Buscar Cliente Existente",description:"Busque clientes existentes por nombre, telefono o ID. Si no se encuentra, complete el formulario a continuacion para crear un nuevo cliente.",placeholder:"Escriba nombre del cliente, numero de telefono o ID para buscar..."})),_t.$$input=Tt=>Fr.updateShipperConsignee({name:Tt.target.value}),vt.$$input=Tt=>Fr.updateShipperConsignee({phoneNumberS:Tt.target.value}),Se(Tt=>{var jt={...rt.section,"margin-top":"1rem"},Kt=rt.sectionTitle,rr=rt.formGroup,yr=rt.gridTwo,nr=rt.formGroup,ur=rt.label,Ft=rt.input,$t=rt.formGroup,wt=rt.label,Zt=rt.input;return Tt.e=m(Ge,jt,Tt.e),Tt.t=m(Nt,Kt,Tt.t),Tt.a=m(At,rr,Tt.a),Tt.o=m(Lt,yr,Tt.o),Tt.i=m(Ue,nr,Tt.i),Tt.n=m(nt,ur,Tt.n),Tt.s=m(_t,Ft,Tt.s),Tt.h=m(Wt,$t,Tt.h),Tt.r=m(We,wt,Tt.r),Tt.d=m(vt,Zt,Tt.d),Tt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),Se(()=>_t.value=e().shipper_consignee.name),Se(()=>vt.value=e().shipper_consignee.phoneNumberS||""),Ge})(),(()=>{var Ge=vD(),Nt=Ge.firstChild,At=Nt.nextSibling,Lt=At.nextSibling,Ue=Lt.firstChild,nt=Ue.nextSibling,_t=Lt.nextSibling,Wt=_t.firstChild,We=Wt.nextSibling,vt=_t.nextSibling,Tt=vt.firstChild,jt=Tt.nextSibling,Kt=vt.nextSibling,rr=Kt.firstChild,yr=rr.nextSibling,nr=Kt.nextSibling,ur=nr.firstChild,Ft=ur.nextSibling,$t=nr.nextSibling,wt=$t.firstChild,Zt=wt.nextSibling;return a(At,R(cD,{get value(){return n()},onChange:C,label:"Buscar Destinatario Existente",description:"Busque Destinatario existentes por telefono o ID. Si no se encuentra, complete el formulario a continuacion para crear un nuevo destinatario.",placeholder:"Escriba nombre del destinatario, numero de telefono o ID para buscar..."})),nt.$$input=lt=>Fr.updateShipperConsignee({firstName:lt.target.value}),We.$$input=lt=>Fr.updateShipperConsignee({lastName:lt.target.value}),jt.$$input=lt=>Fr.updateShipperConsignee({cid:lt.target.value}),yr.$$input=lt=>Fr.updateShipperConsignee({passport:lt.target.value}),Ft.$$input=lt=>Fr.updateShipperConsignee({phoneNumber:lt.target.value}),Zt.$$input=lt=>Fr.updateShipperConsignee({address:lt.target.value}),Se(lt=>{var er={...rt.section,"margin-top":"1rem"},ir=rt.sectionTitle,sr=rt.formGroup,_r=rt.formGroup,lr=rt.label,Lr=rt.input,on=rt.formGroup,Ur=rt.label,Yr=rt.input,Et=rt.formGroup,bn=rt.label,_i=rt.input,Si=rt.formGroup,mr=rt.label,Nr=rt.input,Vr=rt.formGroup,gn=rt.label,qr=rt.input,Rr=rt.formGroup,Bn=rt.label,Hn=rt.textarea;return lt.e=m(Ge,er,lt.e),lt.t=m(Nt,ir,lt.t),lt.a=m(At,sr,lt.a),lt.o=m(Lt,_r,lt.o),lt.i=m(Ue,lr,lt.i),lt.n=m(nt,Lr,lt.n),lt.s=m(_t,on,lt.s),lt.h=m(Wt,Ur,lt.h),lt.r=m(We,Yr,lt.r),lt.d=m(vt,Et,lt.d),lt.l=m(Tt,bn,lt.l),lt.u=m(jt,_i,lt.u),lt.c=m(Kt,Si,lt.c),lt.w=m(rr,mr,lt.w),lt.m=m(yr,Nr,lt.m),lt.f=m(nr,Vr,lt.f),lt.y=m(ur,gn,lt.y),lt.g=m(Ft,qr,lt.g),lt.p=m($t,Rr,lt.p),lt.b=m(wt,Bn,lt.b),lt.T=m(Zt,Hn,lt.T),lt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),Se(()=>nt.value=e().shipper_consignee.firstName||""),Se(()=>We.value=e().shipper_consignee.lastName||""),Se(()=>jt.value=e().shipper_consignee.cid||""),Se(()=>yr.value=e().shipper_consignee.passport||""),Se(()=>Ft.value=e().shipper_consignee.phoneNumber||""),Se(()=>Zt.value=e().shipper_consignee.address||""),Ge})()]}}),null),a(It,R(ze,{get when(){return Ee(()=>!!(e().shippingMethod&&e().invoice&&e().shipper_consignee?.cid))()&&e().shipper_consignee?.name},get children(){return[(()=>{var Ge=bD(),Nt=Ge.firstChild,At=Nt.firstChild,Lt=At.nextSibling;return Lt.$$click=P,a(Ge,R(Ut,{get each(){return e().reservas},children:Ue=>R(YD,{updateReserva:z,reserva:Ue,removeReserva:Z})}),null),a(Ge,R(ze,{get when(){return e().reservas.length>0},get children(){var Ue=bb(),nt=Ue.firstChild;return nt.firstChild,Ue.style.setProperty("margin-top","0.75rem"),Ue.style.setProperty("padding-top","0.75rem"),Ue.style.setProperty("border-top","1px solid var(--border-color)"),Ue.style.setProperty("text-align","right"),a(nt,()=>U().toFixed(),null),Ue}}),null),Se(Ue=>{var nt={...rt.section,"margin-top":"1rem"},_t={...rt.sectionTitle,"justify-content":"space-between"},Wt={...rt.button,...rt.successButton};return Ue.e=m(Ge,nt,Ue.e),Ue.t=m(Nt,_t,Ue.t),Ue.a=m(Lt,Wt,Ue.a),Ue},{e:void 0,t:void 0,a:void 0}),Ge})(),(()=>{var Ge=SD(),Nt=Ge.firstChild,At=Nt.firstChild,Lt=At.nextSibling,Ue=Nt.nextSibling;return Lt.$$click=_,a(Ge,R(Ut,{get each(){return e().services},children:nt=>R(QD,{updateService:k,service:nt,removeService:F})}),null),a(Ge,R(ze,{get when(){return e().services.length>0},get children(){var nt=_D(),_t=nt.firstChild;return _t.firstChild,nt.style.setProperty("margin-top","0.75rem"),nt.style.setProperty("padding-top","0.75rem"),nt.style.setProperty("border-top","1px solid var(--border-color)"),nt.style.setProperty("text-align","right"),a(_t,()=>B().toFixed(2),null),nt}}),null),Se(nt=>{var _t={...rt.section,"margin-top":"1rem"},Wt={...rt.sectionTitle,"justify-content":"space-between"},We={...rt.button,...rt.successButton},vt=rt.fieldDescription;return nt.e=m(Ge,_t,nt.e),nt.t=m(Nt,Wt,nt.t),nt.a=m(Lt,We,nt.a),nt.o=m(Ue,vt,nt.o),nt},{e:void 0,t:void 0,a:void 0,o:void 0}),Ge})(),(()=>{var Ge=PD(),Nt=Ge.firstChild,At=Nt.nextSibling,Lt=At.firstChild;return a(At,R(tD,{value:"",onChange:te,get placeholder(){return t("inventory.searchProductsToAdd","Buscar productos por nombre, SKU o categoria para agregar a la factura...")},searchDelay:300,maxResults:15}),null),a(Ge,R(Ut,{get each(){return e().products},children:Ue=>R(KD,{product:Ue,updateProduct:O,removeProduct:b})}),null),a(Ge,R(ze,{get when(){return e().products.length>0},get children(){var Ue=bb(),nt=Ue.firstChild;return nt.firstChild,Ue.style.setProperty("margin-top","0.75rem"),Ue.style.setProperty("padding-top","0.75rem"),Ue.style.setProperty("border-top","1px solid var(--border-color)"),Ue.style.setProperty("text-align","right"),a(nt,()=>X().toFixed(),null),Ue}}),null),Se(Ue=>{var nt={...rt.section,"margin-top":"1rem"},_t={...rt.sectionTitle,"justify-content":"space-between"},Wt=rt.formGroup,We=rt.label;return Ue.e=m(Ge,nt,Ue.e),Ue.t=m(Nt,_t,Ue.t),Ue.a=m(At,Wt,Ue.a),Ue.o=m(Lt,We,Ue.o),Ue},{e:void 0,t:void 0,a:void 0,o:void 0}),Ge})(),(()=>{var Ge=CD(),Nt=Ge.firstChild,At=Nt.firstChild,Lt=At.nextSibling,Ue=Lt.nextSibling,nt=Ue.nextSibling,_t=nt.firstChild,Wt=_t.firstChild,We=Wt.firstChild,vt=Wt.nextSibling,Tt=vt.firstChild,jt=Tt.nextSibling;jt.nextSibling;var Kt=vt.nextSibling,rr=Kt.firstChild,yr=Kt.nextSibling,nr=yr.firstChild,ur=nr.nextSibling;return ur.nextSibling,a(Nt,R(ze,{get when(){return Ee(()=>e()?.paymentMethods.taxPercent>0)()&&ce()>0},get children(){var Ft=wD(),$t=Ft.firstChild,wt=$t.nextSibling;wt.firstChild;var Zt=wt.nextSibling,lt=Zt.firstChild,er=lt.nextSibling,ir=er.nextSibling,sr=ir.nextSibling;sr.nextSibling;var _r=Zt.nextSibling,lr=_r.firstChild,Lr=lr.nextSibling,on=Lr.nextSibling,Ur=on.nextSibling;return Ur.nextSibling,Ft.style.setProperty("margin-top","0.5rem"),Ft.style.setProperty("padding","0.5rem"),Ft.style.setProperty("background","var(--strip-color)"),Ft.style.setProperty("border-radius","var(--border-radius-sm)"),Ft.style.setProperty("font-size","0.75rem"),Ft.style.setProperty("border","1px solid var(--border-color)"),$t.style.setProperty("font-weight","500"),$t.style.setProperty("margin-bottom","0.25rem"),a(wt,()=>ce().toFixed(2),null),a(Zt,()=>(ce()*e()?.paymentMethods?.taxPercent/100).toFixed(2),er),a(Zt,()=>(ce()+ce()*e()?.paymentMethods?.taxPercent/100).toFixed(2),sr),a(_r,()=>L().toFixed(2),Lr),a(_r,()=>j().toFixed(2),Ur),Se(Yr=>{var Et=e()?.paymentMethods?.taxOnTotal?"var(--primary-color)":"var(--text-muted)",bn=e()?.paymentMethods?.taxOnTotal?"var(--text-muted)":"var(--primary-color)";return Et!==Yr.e&&((Yr.e=Et)!=null?Zt.style.setProperty("color",Et):Zt.style.removeProperty("color")),bn!==Yr.t&&((Yr.t=bn)!=null?_r.style.setProperty("color",bn):_r.style.removeProperty("color")),Yr},{e:void 0,t:void 0}),Ft}}),Ue),Ue.$$input=Ft=>J("taxPercent",parseFloat(Ft.target.value)||0),nt.style.setProperty("margin-top","0.5rem"),nt.style.setProperty("align-items","center"),nt.style.setProperty("gap","0.5rem"),_t.style.setProperty("margin-top","0.5rem"),We.addEventListener("change",()=>J("taxOnTotal",!1)),a(vt,()=>e()?.paymentMethods?.taxPercent,jt),a(vt,(()=>{var Ft=Ee(()=>e()?.paymentMethods?.taxPercent>0&&!e()?.paymentMethods?.taxOnTotal);return()=>Ft()&&(()=>{var $t=_b(),wt=$t.firstChild,Zt=wt.nextSibling;return Zt.nextSibling,$t.style.setProperty("color","var(--primary-color)"),a($t,()=>(ce()*e()?.paymentMethods?.taxPercent/100).toFixed(2),Zt),$t})()})(),null),rr.addEventListener("change",()=>J("taxOnTotal",!0)),a(yr,()=>e()?.paymentMethods?.taxPercent,ur),a(yr,(()=>{var Ft=Ee(()=>!!(e()?.paymentMethods?.taxPercent>0&&e()?.paymentMethods?.taxOnTotal));return()=>Ft()&&(()=>{var $t=_b(),wt=$t.firstChild,Zt=wt.nextSibling;return Zt.nextSibling,$t.style.setProperty("color","var(--primary-color)"),a($t,()=>L().toFixed(2),Zt),$t})()})(),null),a(nt,R(ze,{get when(){return e()?.paymentMethods?.taxPercent>0},get children(){var Ft=AD(),$t=Ft.firstChild,wt=$t.firstChild,Zt=$t.nextSibling;return Ft.style.setProperty("margin-top","1rem"),Ft.style.setProperty("padding-top","1rem"),Ft.style.setProperty("border-top","1px solid var(--border-color)"),wt.addEventListener("change",lt=>H("exemptTaxOnCash",lt.target.checked)),a(Ft,R(ze,{get when(){return Ee(()=>!!e()?.paymentMethods?.exemptTaxOnCash)()&&I()>0},get children(){var lt=xD(),er=lt.firstChild,ir=er.nextSibling,sr=ir.firstChild,_r=sr.nextSibling,lr=_r.nextSibling,Lr=lr.nextSibling;Lr.nextSibling;var on=ir.nextSibling;on.firstChild;var Ur=on.nextSibling,Yr=Ur.firstChild,Et=Yr.nextSibling;return Et.nextSibling,lt.style.setProperty("margin-top","0.5rem"),lt.style.setProperty("padding","0.75rem"),lt.style.setProperty("background","#e8f5e9"),lt.style.setProperty("border-radius","var(--border-radius-sm)"),lt.style.setProperty("font-size","0.875rem"),lt.style.setProperty("border","1px solid #c8e6c9"),er.style.setProperty("font-weight","500"),er.style.setProperty("color","#2e7d32"),er.style.setProperty("margin-bottom","0.5rem"),a(ir,()=>e().paymentMethods.cash.toFixed(2),_r),a(ir,()=>(e().paymentMethods.cash/I()*100).toFixed(1),Lr),on.style.setProperty("color","#4CAF50"),on.style.setProperty("font-weight","500"),a(on,()=>D().toFixed(2),null),Ur.style.setProperty("font-size","0.8rem"),Ur.style.setProperty("color","#666"),Ur.style.setProperty("margin-top","0.25rem"),a(Ur,()=>(L()+D()).toFixed(2),Et),a(Ur,()=>L().toFixed(2),null),lt}}),null),Se(lt=>{var er={...rt.label,display:"flex","align-items":"center",gap:"0.5rem","margin-bottom":"0.5rem"},ir=rt.fieldDescription;return lt.e=m($t,er,lt.e),lt.t=m(Zt,ir,lt.t),lt},{e:void 0,t:void 0}),Se(()=>wt.checked=e()?.paymentMethods?.exemptTaxOnCash),Ft}}),null),Se(Ft=>{var $t={...rt.section,"margin-top":"1rem"},wt=rt.formGroup,Zt=rt.label,lt=rt.fieldDescription,er=rt.input,ir={...rt.label,display:"flex","align-items":"center",gap:"0.5rem","font-size":"0.8rem","margin-bottom":"0.25rem"},sr={...rt.fieldDescription,"margin-left":"1.5rem","margin-bottom":"0.5rem"},_r={...rt.label,display:"flex","align-items":"center",gap:"0.5rem","font-size":"0.8rem","margin-bottom":"0.25rem"},lr={...rt.fieldDescription,"margin-left":"1.5rem"};return Ft.e=m(Ge,$t,Ft.e),Ft.t=m(Nt,wt,Ft.t),Ft.a=m(At,Zt,Ft.a),Ft.o=m(Lt,lt,Ft.o),Ft.i=m(Ue,er,Ft.i),Ft.n=m(Wt,ir,Ft.n),Ft.s=m(vt,sr,Ft.s),Ft.h=m(Kt,_r,Ft.h),Ft.r=m(yr,lr,Ft.r),Ft},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),Se(()=>Ue.value=e()?.paymentMethods?.taxPercent),Se(()=>We.checked=!e()?.paymentMethods?.taxOnTotal),Se(()=>rr.checked=e()?.paymentMethods?.taxOnTotal),Ge})(),(()=>{var Ge=$D(),Nt=Ge.firstChild,At=Nt.nextSibling,Lt=At.nextSibling,Ue=Lt.firstChild;Ue.firstChild;var nt=Ue.nextSibling,_t=nt.nextSibling,Wt=_t.nextSibling,We=Lt.nextSibling,vt=We.firstChild,Tt=vt.firstChild,jt=Tt.nextSibling,Kt=vt.nextSibling,rr=Kt.firstChild,yr=rr.nextSibling,nr=We.nextSibling,ur=nr.firstChild,Ft=ur.nextSibling,$t=nr.nextSibling,wt=$t.firstChild,Zt=wt.firstChild,lt=Zt.firstChild,er=lt.nextSibling;er.firstChild;var ir=Zt.nextSibling,sr=ir.firstChild,_r=sr.nextSibling;_r.firstChild;var lr=wt.nextSibling,Lr=lr.firstChild,on=Lr.firstChild,Ur=on.nextSibling;Ur.firstChild;var Yr=Lr.nextSibling;return Lt.style.setProperty("display","flex"),Lt.style.setProperty("gap","0.5rem"),Lt.style.setProperty("margin-bottom","1rem"),Lt.style.setProperty("flex-wrap","wrap"),Ue.$$click=()=>Q("cash"),a(Ue,R(ze,{get when(){return Ee(()=>!!e()?.paymentMethods.exemptTaxOnCash)()&&e()?.paymentMethods.taxPercent>0},get children(){var Et=ID();return Et.style.setProperty("font-size","0.6rem"),Et.style.setProperty("display","block"),Et.style.setProperty("line-height","1"),Et}}),null),nt.$$click=()=>Q("zelle"),_t.$$click=()=>Q("creditCard"),Wt.$$click=se,jt.$$input=Et=>J("cash",parseFloat(Et.target.value)||0),yr.$$input=Et=>J("zelle",parseFloat(Et.target.value)||0),Ft.$$input=Et=>J("creditCard",parseFloat(Et.target.value)||0),$t.style.setProperty("margin-top","1rem"),$t.style.setProperty("padding-top","1rem"),$t.style.setProperty("border-top","1px solid var(--border-color)"),$t.style.setProperty("display","grid"),$t.style.setProperty("grid-template-columns","1fr 1fr"),$t.style.setProperty("gap","1rem"),$t.style.setProperty("font-size","0.875rem"),a(er,()=>I().toFixed(),null),a(_r,()=>M().toFixed(),null),lr.style.setProperty("text-align","right"),a(Ur,()=>j().toFixed(),null),Yr.style.setProperty("font-weight","500"),a(Yr,(()=>{var Et=Ee(()=>Math.round(M())===0);return()=>Et()?"✓ Pagado Completo":M()>0?"Falta Pagar":"Sobrepago"})()),Se(Et=>{var bn={...rt.section,"margin-top":"1rem"},_i=rt.sectionTitle,Si=rt.fieldDescription,mr={...rt.button,...e()?.paymentMethods.exemptTaxOnCash&&e()?.paymentMethods.taxPercent>0?{background:"#4CAF50",color:"white"}:rt.secondaryButton,"font-size":"0.75rem",padding:"0.5rem 0.75rem",position:"relative"},Nr=e()?.paymentMethods.exemptTaxOnCash&&e()?.paymentMethods.taxPercent>0?`Pagar todo en efectivo (Ahorro: $${(ce()*e()?.paymentMethods.taxPercent/100).toFixed(2)})`:"Pagar todo en efectivo",Vr={...rt.button,...rt.secondaryButton,"font-size":"0.75rem",padding:"0.5rem 0.75rem"},gn={...rt.button,...rt.secondaryButton,"font-size":"0.75rem",padding:"0.5rem 0.75rem"},qr={...rt.button,background:"#f44336",color:"white","font-size":"0.75rem",padding:"0.5rem 0.75rem"},Rr=rt.gridTwo,Bn=rt.formGroup,Hn=rt.label,Pi=rt.input,Hr=rt.formGroup,qi=rt.label,zi=rt.input,Ui=rt.formGroup,ja=rt.label,Ds=rt.input,ss=parseFloat(M().toFixed())===0?"#4CAF50":M()>0?"#f44336":"#FF9800",wi=parseFloat(M().toFixed())===0?"#4CAF50":"#f44336";return Et.e=m(Ge,bn,Et.e),Et.t=m(Nt,_i,Et.t),Et.a=m(At,Si,Et.a),Et.o=m(Ue,mr,Et.o),Nr!==Et.i&&tr(Ue,"title",Et.i=Nr),Et.n=m(nt,Vr,Et.n),Et.s=m(_t,gn,Et.s),Et.h=m(Wt,qr,Et.h),Et.r=m(We,Rr,Et.r),Et.d=m(vt,Bn,Et.d),Et.l=m(Tt,Hn,Et.l),Et.u=m(jt,Pi,Et.u),Et.c=m(Kt,Hr,Et.c),Et.w=m(rr,qi,Et.w),Et.m=m(yr,zi,Et.m),Et.f=m(nr,Ui,Et.f),Et.y=m(ur,ja,Et.y),Et.g=m(Ft,Ds,Et.g),ss!==Et.p&&((Et.p=ss)!=null?ir.style.setProperty("color",ss):ir.style.removeProperty("color")),wi!==Et.b&&((Et.b=wi)!=null?Yr.style.setProperty("color",wi):Yr.style.removeProperty("color")),Et},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0}),Se(()=>jt.value=e().paymentMethods.cash),Se(()=>yr.value=e().paymentMethods.zelle),Se(()=>Ft.value=e().paymentMethods.creditCard),Ge})(),(()=>{var Ge=ND(),Nt=Ge.firstChild,At=Nt.firstChild;At.firstChild;var Lt=At.nextSibling;Lt.firstChild;var Ue=Lt.nextSibling;Ue.firstChild;var nt=Ue.nextSibling;return nt.firstChild,At.style.setProperty("font-size","0.875rem"),At.style.setProperty("opacity","0.9"),a(At,()=>X().toFixed(),null),Lt.style.setProperty("font-size","0.875rem"),Lt.style.setProperty("opacity","0.9"),a(Lt,()=>U().toFixed(),null),a(Nt,R(ze,{get when(){return B()>0},get children(){var _t=ED();return _t.firstChild,_t.style.setProperty("font-size","0.875rem"),_t.style.setProperty("opacity","0.9"),a(_t,()=>B().toFixed(2),null),_t}}),Ue),Ue.style.setProperty("font-size","0.875rem"),Ue.style.setProperty("opacity","0.9"),Ue.style.setProperty("border-top","1px solid rgba(175,175,175,0.2)"),Ue.style.setProperty("padding-top","0.5rem"),Ue.style.setProperty("margin-top","0.5rem"),a(Ue,()=>ce().toFixed(2),null),a(Nt,R(ze,{get when(){return e()?.paymentMethods?.taxPercent>0},get children(){var _t=kD(),Wt=_t.firstChild,We=Wt.nextSibling,vt=We.nextSibling,Tt=vt.nextSibling;return Tt.nextSibling,_t.style.setProperty("font-size","0.875rem"),_t.style.setProperty("opacity","0.9"),a(_t,()=>e()?.paymentMethods?.taxPercent,We),a(_t,()=>e()?.paymentMethods?.taxOnTotal?"del total":"del subtotal",Tt),a(_t,()=>L().toFixed(2),null),a(_t,R(ze,{get when(){return Ee(()=>!!e()?.paymentMethods?.exemptTaxOnCash)()&&D()>0},get children(){var jt=TD(),Kt=jt.firstChild,rr=Kt.nextSibling;return rr.nextSibling,jt.style.setProperty("color","#4CAF50"),jt.style.setProperty("margin-left","0.5rem"),a(jt,()=>D().toFixed(2),rr),jt}}),null),_t}}),nt),nt.style.setProperty("font-size","1.5rem"),nt.style.setProperty("font-weight","700"),nt.style.setProperty("margin-top","0.5rem"),nt.style.setProperty("border-top","1px solid rgba(175,175,175,0.3)"),nt.style.setProperty("padding-top","0.5rem"),a(nt,()=>j().toFixed(0),null),Se(_t=>{var Wt={...rt.section,"margin-top":"1rem"},We=rt.totalSection;return _t.e=m(Ge,Wt,_t.e),_t.t=m(Nt,We,_t.t),_t},{e:void 0,t:void 0}),Ge})(),(()=>{var Ge=$c();return Ge.style.setProperty("margin-top","1rem"),Ge})(),R(ze,{get when(){return Fr.isDirty||Fr.lastSaved},get children(){var Ge=MD(),Nt=Ge.firstChild;return Ge.style.setProperty("margin-top","1rem"),Ge.style.setProperty("background","rgba(76, 175, 80, 0.1)"),Ge.style.setProperty("border","1px solid rgba(76, 175, 80, 0.3)"),Ge.style.setProperty("border-radius","var(--border-radius-sm)"),Ge.style.setProperty("padding","0.75rem"),Nt.style.setProperty("display","flex"),Nt.style.setProperty("align-items","center"),Nt.style.setProperty("justify-content","space-between"),Nt.style.setProperty("font-size","0.875rem"),a(Nt,R(ze,{get when(){return Fr.isDirty},get children(){var At=LD(),Lt=At.firstChild;return At.style.setProperty("color","#4CAF50"),At.style.setProperty("display","flex"),At.style.setProperty("align-items","center"),At.style.setProperty("gap","0.5rem"),Lt.style.setProperty("width","8px"),Lt.style.setProperty("height","8px"),Lt.style.setProperty("background","#4CAF50"),Lt.style.setProperty("border-radius","50%"),Lt.style.setProperty("display","inline-block"),Lt.style.setProperty("animation","pulse 2s infinite"),At}}),null),a(Nt,R(ze,{get when(){return!Fr.isDirty&&Fr.lastSaved},get children(){var At=RD(),Lt=At.firstChild;return Lt.nextSibling,At.style.setProperty("color","#4CAF50"),At.style.setProperty("display","flex"),At.style.setProperty("align-items","center"),At.style.setProperty("gap","0.5rem"),Lt.style.setProperty("width","8px"),Lt.style.setProperty("height","8px"),Lt.style.setProperty("background","#4CAF50"),Lt.style.setProperty("border-radius","50%"),Lt.style.setProperty("display","inline-block"),a(At,()=>Fr.lastSaved?.toLocaleTimeString(),null),At}}),null),a(Nt,R(ze,{get when(){return fe()},get children(){var At=DD();return At.$$click=ae,At.style.setProperty("background","none"),At.style.setProperty("border","none"),At.style.setProperty("color","#f44336"),At.style.setProperty("cursor","pointer"),At.style.setProperty("font-size","0.75rem"),At.style.setProperty("text-decoration","underline"),At}}),null),Ge}}),R(ze,{get when(){return Ee(()=>!E()&&j()>0)()&&!(y()||!e().invoice.trim()||!e().shipper_consignee.name.trim()||Math.round(M())>.01)},get children(){var Ge=FD();return Ge.$$click=G,a(Ge,()=>y()?"⏳ Creando Factura...":"💾 Crear Factura"),Se(Nt=>{var At=y()||!e().invoice.trim()||!e().shipper_consignee.name.trim()||Math.round(M())>.01,Lt={...rt.button,...rt.primaryButton,width:"100%","justify-content":"center",padding:"0.875rem","font-size":"1rem",opacity:y()||!e().invoice.trim()||!e().shipper_consignee.name.trim()||Math.round(M())>.01?"0.6":"1"},Ue=e().invoice.trim()?e().shipper_consignee.name.trim()?Math.abs(M())>.01?`El balance de pago debe ser $0.00 (actual: $${M().toFixed(2)})`:"Crear esta factura":"Por favor ingrese el nombre del cliente":"Por favor ingrese un numero de factura";return At!==Nt.e&&(Ge.disabled=Nt.e=At),Nt.t=m(Ge,Lt,Nt.t),Ue!==Nt.a&&tr(Ge,"title",Nt.a=Ue),Nt},{e:void 0,t:void 0,a:void 0}),Ge}}),R(ze,{get when(){return E()},get children(){var Ge=OD(),Nt=Ge.firstChild,At=Nt.nextSibling;return Ge.style.setProperty("display","grid"),Ge.style.setProperty("grid-template-columns","1fr 1fr"),Ge.style.setProperty("gap","0.75rem"),Nt.$$click=re,a(Nt,()=>ee()?"⏳ Generando...":"📄 Generar PDF"),At.$$click=ae,Se(Lt=>{var Ue=ee(),nt={...rt.button,...rt.successButton,"justify-content":"center",opacity:ee()?"0.6":"1"},_t={...rt.button,...rt.secondaryButton,"justify-content":"center"};return Ue!==Lt.e&&(Nt.disabled=Lt.e=Ue),Lt.t=m(Nt,nt,Lt.t),Lt.a=m(At,_t,Lt.a),Lt},{e:void 0,t:void 0,a:void 0}),Ge}})]}})),Se(Ge=>{var Nt=rt.container,At=rt.header,Lt=rt.grid,Ue=rt.section,nt=rt.sectionTitle,_t=rt.gridTwo,Wt=rt.formGroup,We=rt.label,vt=rt.input,Tt=l()||"INV-20241201-1234",jt=rt.formGroup,Kt=rt.label,rr=rt.gridTwo,yr=rt.formGroup,nr=rt.label,ur=rt.fieldDescription,Ft=rt.input,$t=rt.formGroup,wt=rt.label,Zt=rt.fieldDescription,lt=rt.formGroup,er=rt.label,ir=rt.formGroup,sr=rt.label,_r=rt.textarea,lr={...rt.label,display:"flex","align-items":"center",gap:"0.5rem"},Lr=rt.fieldDescription;return Ge.e=m(ie,Nt,Ge.e),Ge.t=m(de,At,Ge.t),Ge.a=m(ue,Lt,Ge.a),Ge.o=m(Pe,Ue,Ge.o),Ge.i=m(pe,nt,Ge.i),Ge.n=m(_e,_t,Ge.n),Ge.s=m(Le,Wt,Ge.s),Ge.h=m(De,We,Ge.h),Ge.r=m(Te,vt,Ge.r),Tt!==Ge.d&&tr(Te,"placeholder",Ge.d=Tt),Ge.l=m($e,jt,Ge.l),Ge.u=m(Ie,Kt,Ge.u),Ge.c=m(Re,rr,Ge.c),Ge.w=m(Je,yr,Ge.w),Ge.m=m(Be,nr,Ge.m),Ge.f=m(Ke,ur,Ge.f),Ge.y=m(Xe,Ft,Ge.y),Ge.g=m(at,$t,Ge.g),Ge.p=m(ot,wt,Ge.p),Ge.b=m(Qe,Zt,Ge.b),Ge.T=m(ct,lt,Ge.T),Ge.A=m(kt,er,Ge.A),Ge.O=m(Dt,ir,Ge.O),Ge.I=m(Rt,sr,Ge.I),Ge.S=m(St,_r,Ge.S),Ge.W=m(Bt,lr,Ge.W),Ge.C=m(xr,Lr,Ge.C),Ge},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0}),Se(()=>Te.value=e().invoice),Se(()=>Xe.value=e().shippingMethod),Se(()=>dt.value=e().createDate),Se(()=>gt.value=e().guide),Se(()=>St.value=e().description),Se(()=>fr.checked=e().packagesOrder),ie})()},YD=t=>{let{reserva:e,updateReserva:r,removeReserva:n}=t;return(()=>{var i=qD(),o=i.firstChild,s=o.firstChild,l=o.nextSibling,c=l.firstChild,u=c.firstChild,h=c.nextSibling,y=h.firstChild,g=h.nextSibling,f=g.firstChild,x=g.nextSibling;return x.firstChild,a(o,R(JD,{get value(){return e.type},onChange:S=>r(e.id,"type",S),placeholder:"ej., Ropa, Zapatos, TV, Utiles del Hogar...",width:"80%",index:1}),s),s.$$click=()=>n(e.id),a(c,R(wl,{type:"number",get value(){return e.qty},update:S=>r(e.id,"qty",parseFloat(S)||0),get style(){return{...rt.input,...rt.smallInput,width:"60px"}},placeholder:"Cant",min:"1",step:"0.01",index:2}),null),a(h,R(wl,{type:"number",get value(){return e.price},update:S=>r(e.id,"price",parseFloat(S)||0),get style(){return{...rt.input,...rt.smallInput}},placeholder:"Precio",step:"0.01",index:3}),null),a(g,R(wl,{type:"number",get value(){return e.arancel},update:S=>r(e.id,"arancel",parseFloat(S)||0),get style(){return{...rt.input,...rt.smallInput}},placeholder:"Arancel",step:"0.01",index:4}),null),x.style.setProperty("width","80px"),x.style.setProperty("text-align","right"),x.style.setProperty("font-weight","500"),a(x,()=>e.total?.toFixed(2)||"0.00",null),a(x,R(ze,{get when(){return!1},get children(){var S=VD(),w=S.firstChild,E=w.nextSibling,q=E.nextSibling,ee=q.nextSibling,W=ee.nextSibling,K=W.nextSibling;return K.nextSibling,S.style.setProperty("font-size","0.6rem"),S.style.setProperty("color","var(--text-muted)"),a(S,()=>e.qty,E),a(S,()=>e.price,ee),a(S,()=>e.arancel,K),S}}),null),Se(S=>{var w=rt.productWrapItem,E={...rt.productItem,"justify-content":"space-around"},q=rt.removeButton,ee=rt.productItem,W=rt.formGroup,K=rt.label,te=rt.formGroup,$=rt.label,C=rt.formGroup,T=rt.label;return S.e=m(i,w,S.e),S.t=m(o,E,S.t),S.a=m(s,q,S.a),S.o=m(l,ee,S.o),S.i=m(c,W,S.i),S.n=m(u,K,S.n),S.s=m(h,te,S.s),S.h=m(y,$,S.h),S.r=m(g,C,S.r),S.d=m(f,T,S.d),S},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),i})()},KD=t=>{let{product:e,updateProduct:r,removeProduct:n}=t;return(()=>{var i=zD(),o=i.firstChild,s=o.firstChild,l=s.firstChild,c=l.nextSibling,u=s.nextSibling,h=o.nextSibling,y=h.firstChild;return y.firstChild,s.style.setProperty("flex","1"),l.style.setProperty("font-weight","500"),l.style.setProperty("font-size","0.875rem"),a(l,()=>e?.product.label),c.style.setProperty("font-size","0.75rem"),c.style.setProperty("color","var(--text-muted)"),a(c,()=>e?.product.code),u.$$click=()=>n(e?.id),a(h,R(wl,{type:"number",get value(){return e?.qty},placeholder:"Cant",update:g=>r(e?.id,"qty",parseFloat(g)||0)}),y),a(h,R(wl,{type:"number",get value(){return e?.salePrice},placeholder:"Precio",update:g=>r(e?.id,"salePrice",parseFloat(g)||0)}),y),y.style.setProperty("width","80px"),y.style.setProperty("text-align","right"),y.style.setProperty("font-weight","500"),a(y,()=>e?.total.toFixed(2),null),Se(g=>{var f=rt.productWrapItem,x=rt.productItem,S=rt.removeButton,w=rt.productItem;return g.e=m(i,f,g.e),g.t=m(o,x,g.t),g.a=m(u,S,g.a),g.o=m(h,w,g.o),g},{e:void 0,t:void 0,a:void 0,o:void 0}),i})()},wl=t=>{const[e,r]=Ce("");wn(()=>{t?.value!==void 0&&r(t.value.toString())});const n=o=>{(o.key==="Enter"||o.key==="Escape"||o.key==="Tab")&&t.update&&gl(e())&&t.update(e())},i=()=>{t.update&&gl(e())&&t.update(e())};return(()=>{var o=UD();return o.addEventListener("blur",i),o.$$keydown=n,o.$$input=s=>r(s.target.value),Se(s=>{var l=t?.type,c={...rt.input,...rt.smallInput,width:t?.width||"90px"},u=t.placeholder,h=t.title,y=t?.index;return l!==s.e&&tr(o,"type",s.e=l),s.t=m(o,c,s.t),u!==s.a&&tr(o,"placeholder",s.a=u),h!==s.o&&tr(o,"title",s.o=h),y!==s.i&&tr(o,"tabindex",s.i=y),s},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>o.value=e()),o})()},JD=t=>{const[e,r]=Ce(!1),[n,i]=Ce(""),[o,s]=Ce(-1),l=()=>{const ee=n().toLowerCase();if(!ee)return Pb;const W=Pb.filter(K=>K.toLowerCase().includes(ee));return W.length===0&&ee.length>0?[`✏️ Agregar "${n()}"`]:W},c=()=>{r(!0),i(""),s(-1)},u=ee=>{const K=ee.target.value;i(K),r(K.length>0),s(-1)},h=ee=>{let W;ee.startsWith("✏️ Agregar")?W=n():W=ee.replace(/^[\u{1F000}-\u{1F9FF}\u{2600}-\u{27BF}]\s*/u,""),t.onChange(W),r(!1),i(""),s(-1)},y=ee=>{const W=l();switch(ee.key){case"ArrowDown":ee.preventDefault(),s(K=>Math.min(K+1,W.length-1));break;case"ArrowUp":ee.preventDefault(),s(K=>Math.max(K-1,-1));break;case"Enter":ee.preventDefault(),o()>=0&&W[o()]?h(W[o()]):(t.onChange(n()||t.value),r(!1));break;case"Escape":r(!1),i(""),s(-1);break}},g=()=>{setTimeout(()=>{n()&&n()!==t.value&&t.onChange(n()),r(!1),i(""),s(-1)},150)},f=()=>e()&&n()?n():t.value||"",x={position:"relative",width:t.width||"100%",flex:t.width?void 0:"1"},S={...rt.input,width:"100%","padding-right":"2rem"},w={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"200px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},E=ee=>({padding:"0.5rem 0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:ee?"var(--strip-color)":"transparent",color:ee?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease","font-size":"0.875rem"}),q={position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)","pointer-events":"none",color:"var(--text-muted)","font-size":"0.75rem"};return(()=>{var ee=S_(),W=ee.firstChild,K=W.firstChild,te=K.nextSibling;return W.style.setProperty("position","relative"),K.addEventListener("blur",g),K.$$keydown=y,K.$$click=c,K.$$input=u,a(te,()=>e()?"▲":"▼"),a(ee,R(ze,{get when(){return Ee(()=>!!e())()&&l().length>0},get children(){var $=$c();return a($,R(Ut,{get each(){return l()},children:(C,T)=>{const O=C.startsWith("✏️ Agregar");return(()=>{var b=$c();return b.addEventListener("mouseenter",()=>s(T())),b.$$click=()=>h(C),a(b,C),Se(P=>m(b,{...E(T()===o()),...O&&{"font-style":"italic","border-left":"3px solid var(--primary-color)",background:T()===o()?"var(--primary-color)":"#f0f8ff",color:T()===o()?"white":"var(--primary-color)"}},P)),b})()}})),Se(C=>m($,w,C)),$}}),null),Se($=>{var C=x,T=S,O=t.placeholder,b=t?.index,P=q;return $.e=m(ee,C,$.e),$.t=m(K,T,$.t),O!==$.a&&tr(K,"placeholder",$.a=O),b!==$.o&&tr(K,"tabindex",$.o=b),$.i=m(te,P,$.i),$},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>K.value=f()),ee})()},QD=t=>{let{service:e,updateService:r,removeService:n}=t;return(()=>{var i=HD(),o=i.firstChild,s=o.firstChild,l=o.nextSibling,c=l.firstChild,u=c.firstChild,h=c.nextSibling,y=h.firstChild,g=h.nextSibling,f=g.firstChild,x=f.nextSibling;return a(o,R(XD,{get value(){return e.type},onChange:S=>r(e.id,"type",S),placeholder:"Seleccionar tipo de servicio...",width:"80%",index:1}),s),s.$$click=()=>n(e.id),a(c,R(wl,{type:"number",get value(){return e.qty},update:S=>r(e.id,"qty",parseFloat(S)||0),get style(){return{...rt.input,...rt.smallInput,width:"60px"}},placeholder:"Cant",step:"1",min:"0",index:2}),null),a(h,R(wl,{type:"number",get value(){return e.arancel},update:S=>r(e.id,"arancel",parseFloat(S)||0),get style(){return{...rt.input,...rt.smallInput}},placeholder:"Precio",step:"0.01",index:3}),null),Se(S=>{var w=rt.productWrapItem,E={...rt.productItem,"justify-content":"space-around"},q=rt.removeButton,ee=rt.productItem,W=rt.formGroup,K=rt.label,te=rt.formGroup,$=rt.label,C=rt.formGroup,T=rt.label,O={...rt.input,...rt.smallInput,background:"var(--strip-color)"};return S.e=m(i,w,S.e),S.t=m(o,E,S.t),S.a=m(s,q,S.a),S.o=m(l,ee,S.o),S.i=m(c,W,S.i),S.n=m(u,K,S.n),S.s=m(h,te,S.s),S.h=m(y,$,S.h),S.r=m(g,C,S.r),S.d=m(f,T,S.d),S.l=m(x,O,S.l),S},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),Se(()=>x.value=`$${e.total.toFixed(2)}`),i})()},XD=t=>{const[e,r]=Ce(!1),[n,i]=Ce(""),[o,s]=Ce(-1),l=()=>{const ee=n().toLowerCase();return ee?Sb.filter(W=>W.toLowerCase().includes(ee)):Sb},c=ee=>{const W=ee.target.value;i(W),r(!0)},u=()=>{r(!0),i("")},h=ee=>{t.onChange(ee),r(!1),i(""),s(-1)},y=ee=>{const W=l();switch(ee.key){case"ArrowDown":ee.preventDefault(),s(K=>Math.min(K+1,W.length-1));break;case"ArrowUp":ee.preventDefault(),s(K=>Math.max(K-1,-1));break;case"Enter":ee.preventDefault(),o()>=0&&o()<W.length&&h(W[o()]);break;case"Escape":r(!1),i(""),s(-1);break}},g=()=>{setTimeout(()=>{r(!1),i(""),s(-1)},150)},f=()=>e()&&n()?n():t.value||"",x={position:"relative",width:t.width||"100%",flex:t.width?void 0:"1"},S={...rt.input,width:"100%","padding-right":"2rem"},w={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"200px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},E=ee=>({padding:"0.5rem 0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:ee?"var(--strip-color)":"transparent",color:ee?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease","font-size":"0.875rem"}),q={position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)","pointer-events":"none",color:"var(--text-muted)","font-size":"0.75rem"};return(()=>{var ee=S_(),W=ee.firstChild,K=W.firstChild,te=K.nextSibling;return W.style.setProperty("position","relative"),K.addEventListener("blur",g),K.$$keydown=y,K.$$click=u,K.$$input=c,a(te,()=>e()?"▲":"▼"),a(ee,R(ze,{get when(){return Ee(()=>!!e())()&&l().length>0},get children(){var $=$c();return a($,R(Ut,{get each(){return l()},children:(C,T)=>{const O=T()===o();return(()=>{var b=$c();return b.addEventListener("mouseenter",()=>s(T())),b.$$mousedown=()=>h(C),a(b,C),Se(P=>m(b,E(O),P)),b})()}})),Se(C=>m($,w,C)),$}}),null),Se($=>{var C=x,T=S,O=t.placeholder,b=t?.index,P=q;return $.e=m(ee,C,$.e),$.t=m(K,T,$.t),O!==$.a&&tr(K,"placeholder",$.a=O),b!==$.o&&tr(K,"tabindex",$.o=b),$.i=m(te,P,$.i),$},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>K.value=f()),ee})()};br(["input","click","keydown","mousedown"]);const ZD={common:{save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",close:"Close",search:"Search",filter:"Filter",reset:"Reset",back:"Back",next:"Next",previous:"Previous",yes:"Yes",no:"No",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",confirm:"Confirm",actions:"Actions",status:"Status",active:"Active",inactive:"Inactive",date:"Date",time:"Time",description:"Description",notes:"Notes",amount:"Amount",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Language",english:"English",spanish:"Spanish",noDataFound:"No data found",required:"Required",optional:"Optional",all:"All",none:"None",select:"Select",clear:"Clear",view:"View",unknown:"Unknown",details:"Details",notAvailable:"N/A",download:"Download",upload:"Upload",print:"Print",export:"Export",import:"Import",exportCSV:"Export CSV",exportExcel:"Export Excel",showing:"Showing",of:"of",dateFrom:"Date From",dateTo:"Date To",showFilters:"Show Filters",hideFilters:"Hide Filters",clearFilters:"Clear Filters"},navigation:{dashboard:"Dashboard",accounts:"Chart of Accounts",balanceSheet:"Balance Sheet",inventory:"Inventory",inventoryManagement:"Inventory Management",employees:"Employees",employeeManagement:"Employee Management",entryBooks:"Entry Books",journalEntries:"Journal Entries",consolidate:"Bank Consolidation",reports:"Reports",settings:"Settings",logout:"Logout",home:"Home",hbl:"House Bill of Lading"},dashboard:{title:"Dashboard",welcome:"Welcome to HRM Finance",overview:"Overview",recentActivity:"Recent Activity",quickActions:"Quick Actions",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalEquity:"Total Equity",totalRevenue:"Total Revenue",totalExpenses:"Total Expenses",netIncome:"Net Income",cashBalance:"Cash Balance",accountsReceivable:"Accounts Receivable",accountsPayable:"Accounts Payable",inventoryValue:"Inventory Value",lowStockItems:"Low Stock Items",pendingInvoices:"Pending Invoices",employeeCount:"Employee Count",monthlyPayroll:"Monthly Payroll"},accounts:{title:"Chart of Accounts",accountNumber:"Account Number",accountName:"Account Name",accountType:"Account Type",category:"Category",balance:"Balance",parentAccount:"Parent Account",subAccounts:"Sub-accounts",addAccount:"Add Account",editAccount:"Edit Account",deleteAccount:"Delete Account",accountDetails:"Account Details",transactions:"Transactions",accountHistory:"Account History",types:{asset:"Asset",liability:"Liability",equity:"Equity",revenue:"Revenue",expense:"Expense"},categories:{currentAssets:"Current Assets",fixedAssets:"Fixed Assets",currentLiabilities:"Current Liabilities",longTermLiabilities:"Long-term Liabilities",ownersEquity:"Owner's Equity",operatingRevenue:"Operating Revenue",operatingExpenses:"Operating Expenses"},allAccounts:"All Accounts"},banking:{title:"Banking",unreconciled:"Unreconciled",reconciled:"Reconciled",reconciliation:"Reconciliation",notReconciled:"Not Reconciled"},balanceSheet:{title:"Balance Sheet",asOf:"As of",assets:"Assets",liabilities:"Liabilities",equity:"Equity",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalEquity:"Total Equity",currentAssets:"Current Assets",nonCurrentAssets:"Non-current Assets",currentLiabilities:"Current Liabilities",nonCurrentLiabilities:"Non-current Liabilities",retainedEarnings:"Retained Earnings",commonStock:"Common Stock",generateReport:"Generate Report",exportPDF:"Export PDF",exportExcel:"Export Excel"},inventory:{title:"Inventory Management",products:"Products",locations:"Locations",movements:"Movements",overview:"Overview",addProduct:"Add Product",addLocation:"Add Location",addMovement:"Add Movement",bulkMovement:"Bulk Movement",productName:"Product Name",productCode:"Product Code",sku:"SKU",category:"Category",quantity:"Quantity",unitOfMeasure:"Unit of Measure",unitCost:"Unit Cost",totalValue:"Total Value",minStockLevel:"Min Stock Level",maxStockLevel:"Max Stock Level",reorderPoint:"Reorder Point",locationName:"Location Name",locationType:"Location Type",locationCode:"Location Code",address:"Address",movementType:"Movement Type",fromLocation:"From Location",toLocation:"To Location",referenceNumber:"Reference Number",invoiceNumber:"Invoice Number",stockIn:"Stock In",stockOut:"Stock Out",transfer:"Transfer",adjustment:"Adjustment",inStock:"In Stock",lowStock:"Low Stock",outOfStock:"Out of Stock",stockLevels:"Stock Levels",stockByLocation:"Stock by Location",recentMovements:"Recent Movements",searchProducts:"Search products...",searchLocations:"Search locations...",noMovements:"No movements found",productDetails:"Product Details",locationDetails:"Location Details",movementDetails:"Movement Details",totalProducts:"Total Products",activeProducts:"Active Products",totalLocations:"Total Locations",activeLocations:"Active Locations",lowStockAlert:"Low Stock Alert",productsNeedRestocking:"products need restocking",lastSeen:"Last seen",noProducts:"No products at this location",warehouseType:"Warehouse",storeType:"Store",supplierType:"Supplier",customerType:"Customer"},employees:{title:"Employee Management",employeeList:"Employee List",addEmployee:"Add Employee",editEmployee:"Edit Employee",employeeDetails:"Employee Details",personalInfo:"Personal Information",employmentInfo:"Employment Information",payrollInfo:"Payroll Information",firstName:"First Name",lastName:"Last Name",fullName:"Full Name",email:"Email",phone:"Phone",address:"Address",dateOfBirth:"Date of Birth",employeeId:"Employee ID",department:"Department",position:"Position",hireDate:"Hire Date",employmentStatus:"Employment Status",salary:"Salary",payFrequency:"Pay Frequency",taxId:"Tax ID",bankAccount:"Bank Account",emergencyContact:"Emergency Contact",activeEmployees:"Active Employees",inactiveEmployees:"Inactive Employees",totalPayroll:"Total Payroll",searchEmployees:"Search employees..."},journal:{title:"Journal Entries",entryNumber:"Entry Number",entryDate:"Entry Date",debit:"Debit",credit:"Credit",account:"Account",memo:"Memo",reference:"Reference",createEntry:"Create Entry",editEntry:"Edit Entry",deleteEntry:"Delete Entry",addEntry:"Add Journal Entry",updateEntry:"Update Entry",saveAsDraft:"Save as Draft",post:"Post",postEntry:"Post Entry",voidEntry:"Void Entry",posted:"Posted",draft:"Draft",reversed:"Reversed",balanced:"Balanced",notBalanced:"Not Balanced",outOfBalance:"Out of Balance",unbalanced:"Unbalanced",recurringEntry:"Recurring Entry",attachments:"Attachments",draftEntry:"Draft Entry",postedEntry:"Posted Entry",totalDebits:"Total Debits",totalCredits:"Total Credits",totalDebit:"Total Debit",totalCredit:"Total Credit",totalAmount:"Total Amount",debitShort:"Dr.",creditShort:"Cr.",allEntries:"All Entries",noReference:"No reference",createdBy:"By",lines:"Lines",entryLines:"Journal Entry Lines",journalLines:"Journal Lines",addLine:"Add Line",lineDescription:"Line description",accountLines:"Account Lines",noDescription:"No description",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",balanceStatus:"Balance Status",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",fixBalance:"Fix Balance",editEntryTooltip:"Edit this journal entry",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",draftEntryDescription:"This entry can be edited and posted.",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",entryMustBeBalanced:"Entry must be balanced to post",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",entryNotBalancedShort:"Entry is not balanced",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",minTwoLinesRequired:"At least 2 line items are required",entryNotBalanced:"Entry is not balanced. Debit: ${debit}, Credit: ${credit}",lineAccountRequired:"Line {lineNumber}: Account is required",lineAmountRequired:"Line {lineNumber}: Either debit or credit amount must be provided",lineBothAmounts:"Line {lineNumber}: Cannot have both debit and credit amounts",enterEntryDescription:"Enter journal entry description",enterReferenceNumber:"Enter reference number",quickEntry:"Quick Journal Entry",selectCategory:"Select Category",selectTemplate:"Select Template",chooseCategory:"Choose a category...",chooseTemplate:"Choose a template...",enterAmounts:"Enter Amounts",entryPreview:"Entry Preview",createQuickEntry:"Create Quick Entry",templateRequired:"Please select a template",amountRequired:"Amount is required for {field}",templates:"Templates",manageTemplates:"Manage Templates",addNewTemplate:"Add New Template",templateDetails:"Template Details",newTemplate:"New Template",editTemplate:"Edit Template",templateName:"Template Name",enterTemplateName:"Enter template name",enterTemplateDescription:"Enter template description",category:"Category",templateLines:"Template Lines",type:"Type",amountType:"Amount Type",fieldName:"Field Name",selectAccount:"Select account...",variable:"Variable",fixed:"Fixed",fieldNamePlaceholder:"e.g., Amount",custom:"Custom",templateNameRequired:"Template name is required",templateDescriptionRequired:"Template description is required",lineDescriptionRequired:"Line {lineNumber}: Description is required",amountFieldNameRequired:"Line {lineNumber}: Amount field name is required",confirmDeleteTemplate:"Are you sure you want to delete this template?",selectTemplateToView:"Select a template from the list to view details",orCreateNew:"or create a new custom template",reconciliationSummary:"Reconciliation Summary",totalLines:"Total Lines",bankAccounts:"Bank Accounts",bankReconciled:"Bank Reconciled",bankPending:"Bank Pending",reconciledLines:"Reconciled Lines",unreconciledLines:"Unreconciled Lines",fullyReconciled:"Fully Reconciled",partiallyReconciled:"Partially Reconciled",unreconciled:"Unreconciled",reconciled:"Reconciled",pending:"Pending",matched:"Matched",manual:"Manual",pendingBankReconciliation:"Pending Bank Reconciliation",visitBankConsolidations:"Visit Bank Consolidations to reconcile these transactions",reconciliationTip:"Reconciliation Tip",unreconciledBankTransactions:"This entry has unreconciled bank account transactions.",bankAccount:"bank account",currentUser:"Current User",errorDeletingTemplate:"Error deleting template",errorSavingTemplate:"Error saving template",noLines:"No lines",noTemplateLines:"No template lines"},invoiceReport:{title:"Invoice Resume Report",filters:"Filters",storeLocation:"Store Location",allStores:"All Stores",fromDate:"From Date",toDate:"To Date",paymentMethod:"Payment Method",allMethods:"All Methods",cash:"Cash",zelle:"Zelle",other:"Other",shippingType:"Shipping Type",allTypes:"All Types",maritime:"🚢 Maritime",air:"✈️ Air",generateReport:"Generate Report",loading:"Loading...",print:"🖨️ Print",exportPdf:"📄 Export PDF",generating:"📄 Generating...",close:"Close",invoiceSummary:"Invoice Summary",totalInvoices:"Total Invoices",dateRange:"Date Range",store:"Store",shippingTypeLabel:"Shipping Type",notSet:"Not Set",paymentMethods:"Payment Methods",total:"Total",additionalCharges:"Additional Charges",transport:"Transport",aranceles:"Aranceles",tax:"Tax",productsSummary:"Products Summary",productType:"Product Type",quantity:"Quantity",totalValue:"Total Value",avgPrice:"Avg Price",reservasSummary:"Reservas Summary (Grouped by Price)",reservaType:"Reserva Type",totalQtyLbs:"Total Qty (lbs)",priceGroups:"Price Groups (Price → Qty)",otherServicesTitle:"Other Services & Charges",serviceType:"Service Type",totalOtherServices:"Total Other Services",totalSummary:"Total Summary",productsTotal:"Products Total",reservasTotal:"Reservas Total",transportServices:"Transport & Services",grandTotal:"GRAND TOTAL",invoiceReferences:"Invoice References",type:"Type",pricePerPound:"Price per pound",totalInvoicesCount:"Total invoices",invoiceNumbers:"Invoice Numbers",copyInvoiceNumbers:"📋 Copy Invoice Numbers",reportPeriod:"Report Period",allTimeReport:"All Time Report",generatedOn:"Generated on",generatingReport:"Generating report...",pdfGenerationFailed:"PDF generation failed. Using print instead.",invoiceNumbersCopied:"Invoice numbers copied to clipboard!",allTypesOption:"All Types",seaOption:"🚢 Maritime",airOption:"✈️ Air",allMethodsOption:"All Methods",cashOption:"Cash",zelleOption:"Zelle",otherOption:"Other",pdf:{title:"Invoice Resume Report",subtitle:"Comprehensive Financial Summary",paymentMethodsSummary:"Payment Methods Summary",productsSummary:"Products Summary",reservasSummary:"Reservas Summary (Grouped by Price)",otherServicesTitle:"Other Services & Charges",totalSummary:"Total Summary",paymentMethod:"Payment Method",amount:"Amount",product:"Product",quantity:"Quantity",total:"Total",type:"Type",totalQty:"Total Qty",priceGroups:"Price Groups",serviceType:"Service Type",productsTotal:"Products Total",reservasTotal:"Reservas Total",transportServices:"Transport & Services",grandTotal:"GRAND TOTAL",generatedOn:"Generated on:",all:"All",reportDate:"Report Date:",dateRange:"Date Range:",totalInvoices:"Total Invoices:",allTypes:"All Types",lbs:"lbs",page:"Page",of:"of"}},entryBooks:{title:"Entry Books",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",details:"Details",journalLines:"Journal Lines",balanceStatus:"Balance Status",unbalanced:"Unbalanced",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",postEntry:"Post Entry",fixBalance:"Fix Balance",draftEntry:"Draft Entry",draftEntryDescription:"This entry can be edited and posted.",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",postedEntry:"Posted Entry",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",editEntryTooltip:"Edit this journal entry",entryMustBeBalanced:"Entry must be balanced to post",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",post:"Post",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",voidEntry:"Void Entry",entryNotBalanced:"Entry Not Balanced",reconciliationSummary:"Reconciliation Summary",totalLines:"Total Lines",bankAccounts:"Bank Accounts",bankReconciled:"Bank Reconciled",bankPending:"Bank Pending",reconciledLines:"Reconciled Lines",manual:"Manual",pendingBankReconciliation:"Pending Bank Reconciliation",visitBankConsolidations:"Visit Bank Consolidations to reconcile these transactions",reconciliationTip:"Reconciliation Tip",unreconciledBankTransactions:"This entry has unreconciled bank account transactions.",unreconciledLines:"Unreconciled Lines",fullyReconciled:"Fully Reconciled",partiallyReconciled:"Partially Reconciled",unreconciled:"Unreconciled",reconciled:"Reconciled",pending:"Pending",matched:"Matched",noDescription:"No description",bankAccount:"bank account",currentUser:"Current User",errorDeletingTemplate:"Error deleting template",errorSavingTemplate:"Error saving template",noLines:"No lines",noTemplateLines:"No template lines"},consolidation:{title:"Bank Consolidation",bankAccount:"Bank Account",statementDate:"Statement Date",beginningBalance:"Beginning Balance",endingBalance:"Ending Balance",deposits:"Deposits",withdrawals:"Withdrawals",bankCharges:"Bank Charges",interest:"Interest",reconcile:"Reconcile",matched:"Matched",unmatched:"Unmatched",importStatement:"Import Statement",manualEntry:"Manual Entry",autoMatch:"Auto Match",clearAll:"Clear All",reconciliationStatus:"Reconciliation Status",difference:"Difference",bookBalance:"Book Balance",statementBalance:"Statement Balance",outstandingChecks:"Outstanding Checks",depositsInTransit:"Deposits in Transit"},forms:{requiredField:"This field is required",invalidEmail:"Invalid email address",invalidNumber:"Invalid number",invalidDate:"Invalid date",minLength:"Minimum length is",maxLength:"Maximum length is",minValue:"Minimum value is",maxValue:"Maximum value is",passwordMismatch:"Passwords do not match",selectOption:"Please select an option",enterValue:"Please enter a value",confirmDelete:"Are you sure you want to delete this item?",unsavedChanges:"You have unsaved changes. Do you want to continue?",saveSuccess:"Saved successfully",saveError:"Error saving data",deleteSuccess:"Deleted successfully",deleteError:"Error deleting item",descriptionRequired:"Description is required",errorOccurred:"An error occurred",errorPostingEntry:"An error occurred while posting the entry"},reports:{title:"Reports",incomeStatement:"Income Statement",balanceSheet:"Balance Sheet",cashFlow:"Cash Flow Statement",trialBalance:"Trial Balance",generalLedger:"General Ledger",accountsReceivable:"Accounts Receivable",accountsPayable:"Accounts Payable",inventoryReport:"Inventory Report",payrollReport:"Payroll Report",taxReport:"Tax Report",customReport:"Custom Report",dateRange:"Date Range",fromDate:"From Date",toDate:"To Date",generateReport:"Generate Report",exportOptions:"Export Options",pdf:"PDF",excel:"Excel",csv:"CSV"},settings:{title:"Settings",general:"General",company:"Company",users:"Users",security:"Security",backup:"Backup",companyName:"Company Name",companyAddress:"Company Address",taxId:"Tax ID",fiscalYear:"Fiscal Year",currency:"Currency",dateFormat:"Date Format",timeZone:"Time Zone",language:"Language",theme:"Theme",lightTheme:"Light",darkTheme:"Dark",autoBackup:"Auto Backup",backupFrequency:"Backup Frequency",lastBackup:"Last Backup",restoreBackup:"Restore Backup",exportData:"Export Data",importData:"Import Data",changePassword:"Change Password",twoFactorAuth:"Two-factor Authentication",sessionTimeout:"Session Timeout",auditLog:"Audit Log"},unauthorized:{title:"Access Restricted",accessDenied:"Access Denied",noPermission:"You don't have permission to access",thisFeature:"this feature",whySeeing:"Why am I seeing this?",explanation:"Your account doesn't have the necessary permissions to view this content.",requiredPermission:"Required permission:",goToDashboard:"Go to Dashboard",goBack:"Go Back",featuresCanAccess:"Features you can access:",dashboardAccess:"Dashboard and overview statistics",profileAccess:"Your profile and settings",roleBasedAccess:"Features enabled for your role",needAccess:"Need access? Contact your administrator or manager to request the appropriate permissions.",permissions:{accountAccess:"Account Management Access",inventoryAccess:"Inventory Access",employeeAccess:"HR Access",bankingAccess:"Banking Access",journalAccess:"Journal Entry Access",adminAccess:"Administrative Access",financialReporting:"Financial Reporting Access",invoiceManagement:"Invoice Management Access",productManagement:"Product Management Access",HBLAccess:"HBL Management Access"}},hbl:{title:"House Bill of Lading Management",records:"records",searchPlaceholder:"Search by HBL#, air guide, shipper, consignee, commodity, bag#, identity...",addNew:"Add New HBL",hblNumber:"HBL Number",airGuide:"Air Guide",airNumber:"Air Number",shipper:"Shipper",consignee:"Consignee",shipperPhone:"Shipper Phone",consigneePhone:"Consignee Phone",identity:"Identity",classification:"Classification",address:"Address",city:"City",state:"State",street:"Street",commodity:"Commodity",weight:"Weight",quantity:"Quantity",bagNumber:"Bag Number",agency:"Agency",guide:"Guide",guideNumber:"Guide Number",guideNo:"Guide No.",reserveDate:"Reserve Date",status:{"EN BODEGA":"In Warehouse",ENVIADO:"Shipped",ENTREGADO:"Delivered",CANCELADO:"Cancelled",PENDIENTE:"Pending"}}},e8={common:{save:"Guardar",cancel:"Cancelar",delete:"Eliminar",edit:"Editar",add:"Agregar",close:"Cerrar",search:"Buscar",filter:"Filtrar",reset:"Restablecer",back:"Atrás",next:"Siguiente",previous:"Anterior",yes:"Sí",no:"No",from:"Desde",to:"Hasta",loading:"Cargando...",error:"Error",success:"Éxito",warning:"Advertencia",info:"Información",confirm:"Confirmar",actions:"Acciones",status:"Estado",active:"Activo",inactive:"Inactivo",date:"Fecha",time:"Hora",description:"Descripción",notes:"Notas",amount:"Monto",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Idioma",english:"Inglés",spanish:"Español",noDataFound:"No se encontraron datos",required:"Requerido",optional:"Opcional",all:"Todos",none:"Ninguno",select:"Seleccionar",clear:"Limpiar",view:"Ver",unknown:"Desconocido",details:"Detalles",notAvailable:"N/A",download:"Descargar",upload:"Cargar",print:"Imprimir",export:"Exportar",import:"Importar",exportCSV:"Exportar CSV",exportExcel:"Exportar Excel",showing:"Mostrando",of:"de",dateFrom:"Fecha Desde",dateTo:"Fecha Hasta",showFilters:"Mostrar Filtros",hideFilters:"Ocultar Filtros",clearFilters:"Limpiar Filtros"},navigation:{dashboard:"Panel de Control",accounts:"Plan de Cuentas",balanceSheet:"Balance General",inventory:"Inventario",inventoryManagement:"Gestión de Inventario",employees:"Empleados",employeeManagement:"Gestión de Empleados",entryBooks:"Libros de Entrada",journalEntries:"Asientos Contables",consolidate:"Consolidación Bancaria",reports:"Reportes",settings:"Configuración",logout:"Cerrar Sesión",home:"Inicio",hbl:"Conocimiento de Embarque"},dashboard:{title:"Panel de Control",welcome:"Bienvenido a HRM Finance",overview:"Resumen",recentActivity:"Actividad Reciente",quickActions:"Acciones Rápidas",totalAssets:"Activos Totales",totalLiabilities:"Pasivos Totales",totalEquity:"Patrimonio Total",totalRevenue:"Ingresos Totales",totalExpenses:"Gastos Totales",netIncome:"Ingreso Neto",cashBalance:"Saldo en Efectivo",accountsReceivable:"Cuentas por Cobrar",accountsPayable:"Cuentas por Pagar",inventoryValue:"Valor del Inventario",lowStockItems:"Artículos con Bajo Stock",pendingInvoices:"Facturas Pendientes",employeeCount:"Número de Empleados",monthlyPayroll:"Nómina Mensual"},accounts:{title:"Plan de Cuentas",accountNumber:"Número de Cuenta",accountName:"Nombre de Cuenta",accountType:"Tipo de Cuenta",category:"Categoría",balance:"Saldo",parentAccount:"Cuenta Padre",subAccounts:"Subcuentas",addAccount:"Agregar Cuenta",editAccount:"Editar Cuenta",deleteAccount:"Eliminar Cuenta",accountDetails:"Detalles de Cuenta",transactions:"Transacciones",accountHistory:"Historial de Cuenta",types:{asset:"Activo",liability:"Pasivo",equity:"Patrimonio",revenue:"Ingreso",expense:"Gasto"},categories:{currentAssets:"Activos Corrientes",fixedAssets:"Activos Fijos",currentLiabilities:"Pasivos Corrientes",longTermLiabilities:"Pasivos a Largo Plazo",ownersEquity:"Patrimonio del Propietario",operatingRevenue:"Ingresos Operativos",operatingExpenses:"Gastos Operativos"},allAccounts:"Todas las Cuentas"},banking:{title:"Bancario",unreconciled:"Sin Conciliar",reconciled:"Conciliado",reconciliation:"Conciliación",notReconciled:"No Conciliado"},balanceSheet:{title:"Balance General",asOf:"Al",assets:"Activos",liabilities:"Pasivos",equity:"Patrimonio",totalAssets:"Total de Activos",totalLiabilities:"Total de Pasivos",totalEquity:"Total de Patrimonio",currentAssets:"Activos Corrientes",nonCurrentAssets:"Activos No Corrientes",currentLiabilities:"Pasivos Corrientes",nonCurrentLiabilities:"Pasivos No Corrientes",retainedEarnings:"Utilidades Retenidas",commonStock:"Capital Social",generateReport:"Generar Reporte",exportPDF:"Exportar PDF",exportExcel:"Exportar Excel"},inventory:{title:"Gestión de Inventario",products:"Productos",locations:"Ubicaciones",movements:"Movimientos",overview:"Resumen",addProduct:"Agregar Producto",addLocation:"Agregar Ubicación",addMovement:"Agregar Movimiento",bulkMovement:"Movimiento Masivo",productName:"Nombre del Producto",productCode:"Código del Producto",sku:"SKU",category:"Categoría",quantity:"Cantidad",unitOfMeasure:"Unidad de Medida",unitCost:"Costo Unitario",totalValue:"Valor Total",minStockLevel:"Nivel Mínimo de Stock",maxStockLevel:"Nivel Máximo de Stock",reorderPoint:"Punto de Reorden",locationName:"Nombre de Ubicación",locationType:"Tipo de Ubicación",locationCode:"Código de Ubicación",address:"Dirección",movementType:"Tipo de Movimiento",fromLocation:"Desde Ubicación",toLocation:"Hacia Ubicación",referenceNumber:"Número de Referencia",invoiceNumber:"Número de Factura",stockIn:"Entrada de Stock",stockOut:"Salida de Stock",transfer:"Transferencia",adjustment:"Ajuste",inStock:"En Stock",lowStock:"Stock Bajo",outOfStock:"Sin Stock",stockLevels:"Niveles de Stock",stockByLocation:"Stock por Ubicación",recentMovements:"Movimientos Recientes",searchProducts:"Buscar productos...",searchLocations:"Buscar ubicaciones...",noMovements:"No se encontraron movimientos",productDetails:"Detalles del Producto",locationDetails:"Detalles de Ubicación",movementDetails:"Detalles del Movimiento",totalProducts:"Total de Productos",activeProducts:"Productos Activos",totalLocations:"Total de Ubicaciones",activeLocations:"Ubicaciones Activas",lowStockAlert:"Alerta de Stock Bajo",productsNeedRestocking:"productos necesitan reabastecimiento",lastSeen:"Visto por última vez",noProducts:"No hay productos en esta ubicación",warehouseType:"Almacén",storeType:"Tienda",supplierType:"Proveedor",customerType:"Cliente"},employees:{title:"Gestión de Empleados",employeeList:"Lista de Empleados",addEmployee:"Agregar Empleado",editEmployee:"Editar Empleado",employeeDetails:"Detalles del Empleado",personalInfo:"Información Personal",employmentInfo:"Información Laboral",payrollInfo:"Información de Nómina",firstName:"Nombre",lastName:"Apellido",fullName:"Nombre Completo",email:"Correo Electrónico",phone:"Teléfono",address:"Dirección",dateOfBirth:"Fecha de Nacimiento",employeeId:"ID de Empleado",department:"Departamento",position:"Puesto",hireDate:"Fecha de Contratación",employmentStatus:"Estado Laboral",salary:"Salario",payFrequency:"Frecuencia de Pago",taxId:"ID Fiscal",bankAccount:"Cuenta Bancaria",emergencyContact:"Contacto de Emergencia",activeEmployees:"Empleados Activos",inactiveEmployees:"Empleados Inactivos",totalPayroll:"Nómina Total",searchEmployees:"Buscar empleados..."},journal:{title:"Asientos Contables",entryNumber:"Número de Asiento",entryDate:"Fecha del Asiento",debit:"Débito",credit:"Crédito",account:"Cuenta",memo:"Nota",reference:"Referencia",createEntry:"Crear Asiento",editEntry:"Editar Asiento",deleteEntry:"Eliminar Asiento",addEntry:"Agregar Asiento Contable",updateEntry:"Actualizar Asiento",saveAsDraft:"Guardar como Borrador",post:"Registrar",postEntry:"Registrar Asiento",voidEntry:"Anular Asiento",posted:"Registrado",draft:"Borrador",reversed:"Revertido",balanced:"Balanceado",notBalanced:"No Balanceado",outOfBalance:"Desbalanceado",unbalanced:"Desbalanceado",recurringEntry:"Asiento Recurrente",attachments:"Archivos Adjuntos",draftEntry:"Asiento Borrador",postedEntry:"Asiento Registrado",totalDebits:"Débitos Totales",totalCredits:"Créditos Totales",totalDebit:"Débito Total",totalCredit:"Crédito Total",totalAmount:"Monto Total",debitShort:"Db.",creditShort:"Cr.",allEntries:"Todos los Asientos",noReference:"Sin referencia",createdBy:"Por",lines:"Líneas",entryLines:"Líneas del Asiento Contable",journalLines:"Líneas del Diario",addLine:"Agregar Línea",lineDescription:"Descripción de línea",accountLines:"Líneas de Cuentas",noDescription:"Sin descripción",andMoreLines:"... y {count} líneas más",viewDetails:"Ver Detalles",entryDetails:"Detalles del Asiento Contable",entryNotFound:"Asiento No Encontrado",entryNotFoundMessage:"El asiento contable que busca no se pudo encontrar o puede haber sido eliminado.",balanceStatus:"Estado del Balance",difference:"diferencia",createdAt:"Creado el",postedAt:"Registrado el",quickActions:"Acciones Rápidas",fixBalance:"Corregir Balance",editEntryTooltip:"Editar este asiento contable",postEntryTooltip:"Registrar este asiento contable",voidEntryTooltip:"Anular este asiento contable",draftEntryDescription:"Este asiento puede ser editado y registrado.",postedEntryDescription:"Este asiento ha sido registrado en el libro mayor. Editar creará una nueva copia borrador.",voidEntryDescription:"Este asiento ha sido anulado y no puede ser modificado.",entryMustBeBalanced:"El asiento debe estar balanceado para registrarse",entryMustBeBalancedBeforePosting:"El asiento debe estar balanceado antes de registrarse.",entryNotBalancedShort:"El asiento no está balanceado",confirmEditPosted:"Este asiento ha sido registrado. Editar creará una nueva copia borrador. ¿Continuar?",confirmPost:"¿Está seguro que desea registrar este asiento contable? Esta acción no se puede deshacer.",confirmVoid:"¿Está seguro que desea anular este asiento contable?",minTwoLinesRequired:"Se requieren al menos 2 líneas",entryNotBalanced:"Asiento no balanceado. Débito: ${debit}, Crédito: ${credit}",lineAccountRequired:"Línea {lineNumber}: La cuenta es requerida",lineAmountRequired:"Línea {lineNumber}: Se debe proporcionar monto en débito o crédito",lineBothAmounts:"Línea {lineNumber}: No puede tener montos en débito y crédito",enterEntryDescription:"Ingrese la descripción del asiento contable",enterReferenceNumber:"Ingrese el número de referencia",quickEntry:"Entrada Rápida de Diario",selectCategory:"Seleccionar Categoría",selectTemplate:"Seleccionar Plantilla",chooseCategory:"Elija una categoría...",chooseTemplate:"Elija una plantilla...",enterAmounts:"Ingresar Montos",entryPreview:"Vista Previa del Asiento",createQuickEntry:"Crear Entrada Rápida",templateRequired:"Por favor seleccione una plantilla",amountRequired:"Se requiere monto para {field}",templates:"Plantillas",manageTemplates:"Administrar Plantillas",addNewTemplate:"Agregar Nueva Plantilla",templateDetails:"Detalles de Plantilla",newTemplate:"Nueva Plantilla",editTemplate:"Editar Plantilla",templateName:"Nombre de Plantilla",enterTemplateName:"Ingrese nombre de plantilla",enterTemplateDescription:"Ingrese descripción de plantilla",category:"Categoría",templateLines:"Líneas de Plantilla",type:"Tipo",amountType:"Tipo de Monto",fieldName:"Nombre del Campo",selectAccount:"Seleccionar cuenta...",variable:"Variable",fixed:"Fijo",fieldNamePlaceholder:"ej., Monto",custom:"Personalizado",templateNameRequired:"El nombre de plantilla es requerido",templateDescriptionRequired:"La descripción de plantilla es requerida",lineDescriptionRequired:"Línea {lineNumber}: Se requiere descripción",amountFieldNameRequired:"Línea {lineNumber}: Se requiere nombre del campo de monto",confirmDeleteTemplate:"¿Está seguro que desea eliminar esta plantilla?",selectTemplateToView:"Seleccione una plantilla de la lista para ver detalles",orCreateNew:"o cree una nueva plantilla personalizada",reconciliationSummary:"Resumen de Conciliación",totalLines:"Líneas Totales",bankAccounts:"Cuentas Bancarias",bankReconciled:"Conciliadas Bancarias",bankPending:"Bancarias Pendientes",reconciledLines:"Líneas Conciliadas",unreconciledLines:"Líneas Sin Conciliar",fullyReconciled:"Completamente Conciliado",partiallyReconciled:"Parcialmente Conciliado",unreconciled:"Sin Conciliar",reconciled:"Conciliadas",pending:"Pendientes",matched:"Coincididas",manual:"Manual",pendingBankReconciliation:"Conciliación Bancaria Pendiente",visitBankConsolidations:"Visite Consolidaciones Bancarias para conciliar estas transacciones",reconciliationTip:"Consejo de Conciliación",unreconciledBankTransactions:"Este asiento tiene transacciones de cuentas bancarias sin conciliar.",bankAccount:"cuenta bancaria",currentUser:"Usuario Actual",errorDeletingTemplate:"Error al eliminar plantilla",errorSavingTemplate:"Error al guardar plantilla",noLines:"Sin líneas",noTemplateLines:"Sin líneas de plantilla"},invoiceReport:{title:"Reporte Resumen de Facturas",filters:"Filtros",storeLocation:"Ubicación de Tienda",allStores:"Todas las Tiendas",fromDate:"Fecha Desde",toDate:"Fecha Hasta",paymentMethod:"Método de Pago",allMethods:"Todos los Métodos",cash:"Efectivo",zelle:"Zelle",other:"Otro",shippingType:"Tipo de Envío",allTypes:"Todos los Tipos",maritime:"🚢 Marítimo",air:"✈️ Aéreo",generateReport:"Generar Reporte",loading:"Cargando...",print:"🖨️ Imprimir",exportPdf:"📄 Exportar PDF",generating:"📄 Generando...",close:"Cerrar",invoiceSummary:"Resumen de Facturas",totalInvoices:"Total de Facturas",dateRange:"Rango de Fechas",store:"Tienda",shippingTypeLabel:"Tipo de Envío",notSet:"No Establecido",paymentMethods:"Métodos de Pago",total:"Total",additionalCharges:"Cargos Adicionales",transport:"Transporte",aranceles:"Aranceles",tax:"Impuesto",productsSummary:"Resumen de Productos",productType:"Tipo de Producto",quantity:"Cantidad",totalValue:"Valor Total",avgPrice:"Precio Promedio",reservasSummary:"Resumen de Reservas (Agrupado por Precio)",reservaType:"Tipo de Reserva",totalQtyLbs:"Cantidad Total (lbs)",priceGroups:"Grupos de Precio (Precio → Cantidad)",otherServicesTitle:"Otros Servicios y Cargos",serviceType:"Tipo de Servicio",totalOtherServices:"Total Otros Servicios",totalSummary:"Resumen Total",productsTotal:"Total Productos",reservasTotal:"Total Reservas",transportServices:"Transporte y Servicios",grandTotal:"TOTAL GENERAL",invoiceReferences:"Referencias de Facturas",type:"Tipo",pricePerPound:"Precio por libra",totalInvoicesCount:"Total facturas",invoiceNumbers:"Números de Facturas",copyInvoiceNumbers:"📋 Copiar Números de Facturas",reportPeriod:"Período del Reporte",allTimeReport:"Reporte de Todo el Tiempo",generatedOn:"Generado el",generatingReport:"Generando reporte...",pdfGenerationFailed:"Falló la generación del PDF. Usando impresión en su lugar.",invoiceNumbersCopied:"¡Números de facturas copiados al portapapeles!",allTypesOption:"Todos los Tipos",seaOption:"🚢 Marítimo",airOption:"✈️ Aéreo",allMethodsOption:"Todos los Métodos",cashOption:"Efectivo",zelleOption:"Zelle",otherOption:"Otro",pdf:{title:"Reporte Resumen de Facturas",subtitle:"Resumen Financiero Completo",paymentMethodsSummary:"Resumen de Métodos de Pago",productsSummary:"Resumen de Productos",reservasSummary:"Resumen de Reservas (Agrupado por Precio)",otherServicesTitle:"Otros Servicios y Cargos",totalSummary:"Resumen Total",paymentMethod:"Método de Pago",amount:"Monto",product:"Producto",quantity:"Cantidad",total:"Total",type:"Tipo",totalQty:"Cantidad Total",priceGroups:"Grupos de Precio",serviceType:"Tipo de Servicio",productsTotal:"Total Productos",reservasTotal:"Total Reservas",transportServices:"Transporte y Servicios",grandTotal:"TOTAL GENERAL",generatedOn:"Generado el:",all:"Todo",reportDate:"Fecha del Reporte:",dateRange:"Rango de Fechas:",totalInvoices:"Total de Facturas:",allTypes:"Todos los Tipos",lbs:"lbs",page:"Página",of:"de"}},entryBooks:{title:"Libros de Entrada",subtitle:"Administrar asientos contables y registros del libro mayor",bookName:"Nombre del Libro",bookType:"Tipo de Libro",createBook:"Crear Libro",editBook:"Editar Libro",salesBook:"Libro de Ventas",purchaseBook:"Libro de Compras",cashBook:"Libro de Caja",generalBook:"Libro General",entries:"Entradas",addEntry:"Agregar Entrada",period:"Período",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",bookBalance:"Saldo del Libro",reconciledBalance:"Saldo Conciliado",difference:"Diferencia",reconcile:"Conciliar",isReconciled:"Está Conciliado",totalEntries:"Total de Asientos",allJournalEntries:"Todos los asientos contables",postedEntriesOnly:"Solo asientos registrados",fromPostedEntries:"De {count} asientos registrados",needBankReconciliation:"Necesita conciliación bancaria",allReconciled:"Todo conciliado",sortBy:"Ordenar Por",fromDate:"Fecha Desde",toDate:"Fecha Hasta",order:"Orden",newest:"Más Reciente",oldest:"Más Antiguo",resetFilters:"Restablecer Filtros",activeFilters:"Filtros activos",from:"Desde",to:"Hasta",entriesFound:"{count} asientos encontrados",noJournalEntries:"Sin Asientos Contables",startByCreating:"Comience creando su primer asiento",noEntriesMatch:"No hay asientos que coincidan con sus filtros actuales.",createFirstEntry:"Crear Primer Asiento",confirmVoid:"¿Está seguro que desea anular este asiento contable?",void:"Anulado",viewReconciliation:"Ver Conciliación"},consolidation:{title:"Consolidación Bancaria",bankAccount:"Cuenta Bancaria",statementDate:"Fecha del Estado",beginningBalance:"Saldo Inicial",endingBalance:"Saldo Final",deposits:"Depósitos",withdrawals:"Retiros",bankCharges:"Cargos Bancarios",interest:"Intereses",reconcile:"Conciliar",matched:"Conciliado",unmatched:"No Conciliado",importStatement:"Importar Estado",manualEntry:"Entrada Manual",autoMatch:"Coincidencia Automática",clearAll:"Limpiar Todo",reconciliationStatus:"Estado de Conciliación",difference:"Diferencia",bookBalance:"Saldo en Libros",statementBalance:"Saldo del Estado",outstandingChecks:"Cheques Pendientes",depositsInTransit:"Depósitos en Tránsito"},forms:{requiredField:"Este campo es requerido",invalidEmail:"Dirección de correo inválida",invalidNumber:"Número inválido",invalidDate:"Fecha inválida",minLength:"La longitud mínima es",maxLength:"La longitud máxima es",minValue:"El valor mínimo es",maxValue:"El valor máximo es",passwordMismatch:"Las contraseñas no coinciden",selectOption:"Por favor seleccione una opción",enterValue:"Por favor ingrese un valor",confirmDelete:"¿Está seguro de que desea eliminar este elemento?",unsavedChanges:"Tiene cambios sin guardar. ¿Desea continuar?",saveSuccess:"Guardado exitosamente",saveError:"Error al guardar datos",deleteSuccess:"Eliminado exitosamente",deleteError:"Error al eliminar elemento",descriptionRequired:"La descripción es requerida",errorOccurred:"Ocurrió un error",errorPostingEntry:"Ocurrió un error al registrar el asiento"},reports:{title:"Reportes",incomeStatement:"Estado de Resultados",balanceSheet:"Balance General",cashFlow:"Estado de Flujo de Efectivo",trialBalance:"Balance de Comprobación",generalLedger:"Libro Mayor",accountsReceivable:"Cuentas por Cobrar",accountsPayable:"Cuentas por Pagar",inventoryReport:"Reporte de Inventario",payrollReport:"Reporte de Nómina",taxReport:"Reporte de Impuestos",customReport:"Reporte Personalizado",dateRange:"Rango de Fechas",fromDate:"Desde",toDate:"Hasta",generateReport:"Generar Reporte",exportOptions:"Opciones de Exportación",pdf:"PDF",excel:"Excel",csv:"CSV"},settings:{title:"Configuración",general:"General",company:"Empresa",users:"Usuarios",security:"Seguridad",backup:"Respaldo",companyName:"Nombre de la Empresa",companyAddress:"Dirección de la Empresa",taxId:"ID Fiscal",fiscalYear:"Año Fiscal",currency:"Moneda",dateFormat:"Formato de Fecha",timeZone:"Zona Horaria",language:"Idioma",theme:"Tema",lightTheme:"Claro",darkTheme:"Oscuro",autoBackup:"Respaldo Automático",backupFrequency:"Frecuencia de Respaldo",lastBackup:"Último Respaldo",restoreBackup:"Restaurar Respaldo",exportData:"Exportar Datos",importData:"Importar Datos",changePassword:"Cambiar Contraseña",twoFactorAuth:"Autenticación de Dos Factores",sessionTimeout:"Tiempo de Espera de Sesión",auditLog:"Registro de Auditoría"},unauthorized:{title:"Acceso Restringido",accessDenied:"Acceso Denegado",noPermission:"No tienes permisos para acceder a",thisFeature:"esta funcionalidad",whySeeing:"¿Por qué veo esto?",explanation:"Tu cuenta no tiene los permisos necesarios para ver este contenido.",requiredPermission:"Permiso requerido:",goToDashboard:"Ir al Panel de Control",goBack:"Regresar",featuresCanAccess:"Funcionalidades a las que puedes acceder:",dashboardAccess:"Panel de control y estadísticas generales",profileAccess:"Tu perfil y configuraciones",roleBasedAccess:"Funcionalidades habilitadas para tu rol",needAccess:"¿Necesitas acceso? Contacta a tu administrador o gerente para solicitar los permisos apropiados.",permissions:{accountAccess:"Acceso a Gestión de Cuentas",inventoryAccess:"Acceso a Inventario",employeeAccess:"Acceso a Recursos Humanos",bankingAccess:"Acceso Bancario",journalAccess:"Acceso a Asientos Contables",adminAccess:"Acceso Administrativo",financialReporting:"Acceso a Reportes Financieros",invoiceManagement:"Acceso a Gestión de Facturas",productManagement:"Acceso a Gestión de Productos",HBLAccess:"Acceso a Gestión de HBL"}},hbl:{title:"Gestión de Conocimiento de Embarque",records:"registros",searchPlaceholder:"Buscar por HBL#, guía aérea, remitente, consignatario, mercancía, bolsa#, identidad...",addNew:"Agregar Nuevo HBL",hblNumber:"Número HBL",airGuide:"Guía Aérea",airNumber:"Número Aéreo",shipper:"Remitente",consignee:"Consignatario",shipperPhone:"Teléfono del Remitente",consigneePhone:"Teléfono del Consignatario",identity:"Identidad",classification:"Clasificación",address:"Dirección",city:"Ciudad",state:"Provincia",street:"Calle",commodity:"Mercancía",weight:"Peso",quantity:"Cantidad",bagNumber:"Número de Bolsa",agency:"Agencia",guide:"Guía",guideNumber:"Número de Guía",guideNo:"Guía No.",reserveDate:"Fecha de Reserva",status:{"EN BODEGA":"En Bodega",ENVIADO:"Enviado",ENTREGADO:"Entregado",CANCELADO:"Cancelado",PENDIENTE:"Pendiente"}}},t8=()=>{if(typeof window<"u"){const t=localStorage.getItem("hrmfinance-language");if(t&&["es","en"].includes(t))return t}return"en"},[wb,r8]=Ce(t8()),[xb,n8]=Ce({en:{},es:{}}),yu={get language(){return wb()},get translations(){return xb()},setLanguage(t){r8(t),typeof window<"u"&&localStorage.setItem("hrmfinance-language",t)},setTranslations(t){n8(t)},translate(t,e){const r=wb(),n=xb()[r];if(!n)return e||t;const i=t.split(".");let o=n;for(const s of i)if(o&&typeof o=="object"&&s in o)o=o[s];else return e||t;return typeof o=="string"?o:e||t},t(t,e){return this.translate(t,e)}},i8=()=>({t:yu.translate.bind(yu),language:yu.language,setLanguage:yu.setLanguage});yu.setTranslations({en:ZD,es:e8});var o8=he("<div><div><label></label><select><option value=all></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label><select><option value=all></option><option value=cash></option><option value=zelle></option><option value=other></option></select></div><div><label></label><select><option value=all></option><option value=SEA></option><option value=AEREO>"),s8=he("<div><div><strong>:</strong> </div><div><strong>:</strong> <!> <!> </div><div><strong>:</strong> </div><div><strong>:</strong> "),a8=he("<div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> "),l8=he("<div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> "),Ab=he("<div>"),Cb=he("<div><table><thead><tr><th></th><th></th><th></th><th></th></tr></thead><tbody>"),c8=he("<div><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td colspan=4><strong>:</strong></td><td>"),u8=he("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),d8=he("<div><div>"),h8=he("<div><div><div><h3></h3><button>×</button></div><div><div>: <strong></strong></div><div>: <strong></strong></div><div>: <strong></strong></div></div><div><div>:</div><div></div></div><div>"),p8=he("<div><div class=print-only><h1></h1><div></div><div>: </div></div><div class=no-print><h1></h1><div>"),f8=he("<option>"),m8=he("<tr><td></td><td></td><td></td><td>"),y8=he("<tr><td></td><td></td><td><div></div></td><td>"),g8=he("<div><span> → <!> lbs</span><button>📋 <!> invoice"),v8=he("<tr><td><div></div></td><td>");const b8=t=>{const{t:e}=i8(),[r,n]=Ce(!1),[i,o]=Ce(""),[s,l]=Ce(""),[c,u]=Ce("all"),[h,y]=Ce("all"),[g,f]=Ce("all"),[x,S]=Ce("all"),[w,E]=Ce(null),[q,ee]=Ce([]),[W,K]=Ce(!1),[te,$]=Ce(null);wn(async()=>{await T()});const C=()=>ut.getActiveLocations(),T=async()=>{n(!0);try{let Z=c()!=="all"?c():void 0;const k={store:Z,dateFrom:i()||void 0,dateTo:s()||void 0};Z&&(await Di.fetchInvoices(k),O())}catch(Z){console.error("Error loading report data:",Z)}finally{n(!1)}},O=()=>{let Z=Di.getFilteredInvoices({store:c(),dateFrom:i(),dateTo:s()});x()!=="all"&&(Z=Z.filter(J=>J.shippingType===x()||!J.shippingType&&x()==="SEA")),ee(Z);let k=0,F=0,X=0,U=new Map,B=new Map,ce=new Map,L=0,D=0,j=0;Z.forEach(J=>{const H=k8(J),Q=parseFloat(H.total);J.paymentMethods?(J?.paymentMethods?.cash&&(k+=J?.paymentMethods?.cash),J?.paymentMethods?.zelle&&(F+=J?.paymentMethods?.zelle),j+=J?.taxAmount):J.hasTax&&J?.TaxPercent?(F+=Q,j+=J?.TaxPercent/100*Q):k+=Q,J.products?.forEach(se=>{const G=se.product.label,re=Math.abs(se.qty),oe=parseFloat(P_(se));if(U.has(G)){const fe=U.get(G);U.set(G,{qty:fe.qty+re,total:fe.total+oe})}else U.set(G,{qty:re,total:oe})}),J.reservas?.forEach(se=>{const G=se.type,re=parseFloat(se.qty)||0,oe=parseFloat(se.price)||0,fe=parseFloat(se.arancel)||0;var ae=oe*re;const Y=G;if(B.has(Y)){const ie=B.get(Y);B.set(Y,{qty:ie.qty+re,price:ie.price,total:ie.total+ae,priceGroups:ie.priceGroups});const de=ie.priceGroups.get(oe)||{qty:0,invoices:[]};de.qty+=re,de.invoices.includes(J.invoice)||de.invoices.push(J.invoice),ie.priceGroups.set(oe,de)}else{const ie=new Map;ie.set(oe,{qty:re,invoices:[J.invoice]}),B.set(Y,{qty:re,price:oe,arancel:fe,total:ae,priceGroups:ie})}D+=fe}),J.services?.forEach(se=>{const G=se.type,re=parseFloat(se.qty)||0,oe=parseFloat(se.arancel)||0,fe=re*oe;if(L+=fe,ce.has(G)){const ae=ce.get(G);ce.set(G,{qty:ae.qty+re,price:ae.price,arancel:ae.arancel+oe,total:ae.total+fe})}else ce.set(G,{qty:re,price:0,arancel:oe,total:fe})})});const I=k+F+X,M={dateRange:{from:i(),to:s()},store:c(),shippingType:x(),totalInvoices:Z.length,paymentMethods:{cash:k,zelle:F,other:X,total:k+F+X},productsByType:U,reservasByTypeAndPrice:B,otherServicesByType:ce,transportTotal:L,arancelesTotal:D,taxTotal:j,grandTotal:I+j};E(M)},b=Z=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Z),P=()=>{_(),setTimeout(()=>{},100)},_=async()=>{try{const Z=z();if(Z){K(!0);const{generateInvoiceResumePDF:k}=await Bi(async()=>{const{generateInvoiceResumePDF:X}=await import("./invoiceResumePdfGenerator-BKhcE1In.js");return{generateInvoiceResumePDF:X}},[]),F=`invoice-resume-report-${new Date().toISOString().split("T")[0]}.pdf`;await k(Z,e,F),console.log(`PDF generated successfully: ${F}`)}}catch(Z){console.error("Error generating PDF:",Z),alert(e("invoiceReport.pdfGenerationFailed")),P()}finally{K(!1)}},z=Mt(()=>w());return(()=>{var Z=p8(),k=Z.firstChild,F=k.firstChild,X=F.nextSibling,U=X.nextSibling,B=U.firstChild,ce=k.nextSibling,L=ce.firstChild,D=L.nextSibling;return Z.style.setProperty("padding","2rem"),Z.style.setProperty("max-width","1200px"),Z.style.setProperty("margin","0 auto"),k.style.setProperty("text-align","center"),k.style.setProperty("margin-bottom","2rem"),k.style.setProperty("border-bottom","2px solid #333"),k.style.setProperty("padding-bottom","1rem"),a(F,()=>e("invoiceReport.title")),X.style.setProperty("font-size","12pt"),X.style.setProperty("margin-top","0.5rem"),X.style.setProperty("color","#666"),a(X,R(ze,{get when(){return Ee(()=>!!z()?.dateRange?.from)()&&z()?.dateRange?.to},get children(){return[Ee(()=>e("invoiceReport.reportPeriod")),": ",Ee(()=>z()?.dateRange?.from)," to ",Ee(()=>z()?.dateRange?.to)]}}),null),a(X,R(ze,{get when(){return!z()?.dateRange?.from||!z()?.dateRange?.to},get children(){return e("invoiceReport.allTimeReport")}}),null),U.style.setProperty("font-size","10pt"),U.style.setProperty("margin-top","0.5rem"),a(U,()=>e("invoiceReport.generatedOn"),B),a(U,()=>new Date().toLocaleDateString(),null),ce.style.setProperty("display","flex"),ce.style.setProperty("justify-content","space-between"),ce.style.setProperty("align-items","center"),ce.style.setProperty("margin-bottom","2rem"),L.style.setProperty("font-size","1.75rem"),L.style.setProperty("font-weight","bold"),a(L,()=>e("invoiceReport.title")),D.style.setProperty("display","flex"),D.style.setProperty("gap","1rem"),a(D,R(ht,{variant:"outline",onClick:P,get children(){return e("invoiceReport.print")}}),null),a(D,R(ht,{variant:"outline",onClick:_,get disabled(){return W()},get children(){return Ee(()=>!!W())()?e("invoiceReport.generating"):e("invoiceReport.exportPdf")}}),null),a(D,R(ze,{get when(){return t.onClose},get children(){return R(ht,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("invoiceReport.close")}})}}),null),a(Z,R(Ot,{get title(){return e("invoiceReport.filters")},style:{"margin-bottom":"2rem"},class:"no-print",get children(){var j=o8(),I=j.firstChild,M=I.firstChild,J=M.nextSibling,H=J.firstChild,Q=I.nextSibling,se=Q.firstChild,G=se.nextSibling,re=Q.nextSibling,oe=re.firstChild,fe=oe.nextSibling,ae=re.nextSibling,Y=ae.firstChild,ie=Y.nextSibling,de=ie.firstChild,ue=de.nextSibling,ge=ue.nextSibling,Pe=ge.nextSibling,pe=ae.nextSibling,_e=pe.firstChild,Le=_e.nextSibling,De=Le.firstChild,Te=De.nextSibling,$e=Te.nextSibling;return j.style.setProperty("display","grid"),j.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),j.style.setProperty("gap","1rem"),j.style.setProperty("align-items","end"),M.style.setProperty("display","block"),M.style.setProperty("margin-bottom","0.5rem"),M.style.setProperty("font-weight","500"),a(M,()=>e("invoiceReport.storeLocation")),J.addEventListener("change",Ie=>u(Ie.currentTarget.value)),J.style.setProperty("width","100%"),J.style.setProperty("padding","0.75rem"),J.style.setProperty("border","1px solid var(--border-color)"),J.style.setProperty("border-radius","var(--border-radius-sm)"),a(H,()=>e("invoiceReport.allStores")),a(J,R(Ut,{get each(){return C()},children:Ie=>(()=>{var Re=f8();return a(Re,()=>Ie.name),Se(()=>Re.value=Ie.id),Re})()}),null),se.style.setProperty("display","block"),se.style.setProperty("margin-bottom","0.5rem"),se.style.setProperty("font-weight","500"),a(se,()=>e("invoiceReport.fromDate")),G.addEventListener("change",Ie=>o(Ie.currentTarget.value)),G.style.setProperty("width","100%"),G.style.setProperty("padding","0.75rem"),G.style.setProperty("border","1px solid var(--border-color)"),G.style.setProperty("border-radius","var(--border-radius-sm)"),oe.style.setProperty("display","block"),oe.style.setProperty("margin-bottom","0.5rem"),oe.style.setProperty("font-weight","500"),a(oe,()=>e("invoiceReport.toDate")),fe.addEventListener("change",Ie=>l(Ie.currentTarget.value)),fe.style.setProperty("width","100%"),fe.style.setProperty("padding","0.75rem"),fe.style.setProperty("border","1px solid var(--border-color)"),fe.style.setProperty("border-radius","var(--border-radius-sm)"),Y.style.setProperty("display","block"),Y.style.setProperty("margin-bottom","0.5rem"),Y.style.setProperty("font-weight","500"),a(Y,()=>e("invoiceReport.paymentMethod")),ie.addEventListener("change",Ie=>f(Ie.currentTarget.value)),ie.style.setProperty("width","100%"),ie.style.setProperty("padding","0.75rem"),ie.style.setProperty("border","1px solid var(--border-color)"),ie.style.setProperty("border-radius","var(--border-radius-sm)"),a(de,()=>e("invoiceReport.allMethodsOption")),a(ue,()=>e("invoiceReport.cashOption")),a(ge,()=>e("invoiceReport.zelleOption")),a(Pe,()=>e("invoiceReport.otherOption")),_e.style.setProperty("display","block"),_e.style.setProperty("margin-bottom","0.5rem"),_e.style.setProperty("font-weight","500"),a(_e,()=>e("invoiceReport.shippingType")),Le.addEventListener("change",Ie=>S(Ie.currentTarget.value)),Le.style.setProperty("width","100%"),Le.style.setProperty("padding","0.75rem"),Le.style.setProperty("border","1px solid var(--border-color)"),Le.style.setProperty("border-radius","var(--border-radius-sm)"),a(De,()=>e("invoiceReport.allTypesOption")),a(Te,()=>e("invoiceReport.seaOption")),a($e,()=>e("invoiceReport.airOption")),a(j,R(ze,{get when(){return c()!=="all"},get children(){return R(ht,{variant:"primary",onClick:T,get disabled(){return Ee(()=>c()==="all")()&&r()},get children(){return Ee(()=>!!r())()?e("invoiceReport.loading"):e("invoiceReport.generateReport")}})}}),null),Se(()=>J.value=c()),Se(()=>G.value=i()),Se(()=>fe.value=s()),Se(()=>ie.value=g()),Se(()=>Le.value=x()),j}}),null),a(Z,R(ze,{get when(){return Ee(()=>!!(c()!=="all"&&z()))()&&!r()},get children(){return[(()=>{var j=Ab();return j.style.setProperty("display","grid"),j.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),j.style.setProperty("gap","1.5rem"),j.style.setProperty("margin-bottom","2rem"),a(j,R(Ot,{get title(){return e("invoiceReport.invoiceSummary")},get children(){var I=s8(),M=I.firstChild,J=M.firstChild,H=J.firstChild;J.nextSibling;var Q=M.nextSibling,se=Q.firstChild,G=se.firstChild,re=se.nextSibling,oe=re.nextSibling,fe=oe.nextSibling,ae=fe.nextSibling;ae.nextSibling;var Y=Q.nextSibling,ie=Y.firstChild,de=ie.firstChild;ie.nextSibling;var ue=Y.nextSibling,ge=ue.firstChild,Pe=ge.firstChild;return ge.nextSibling,I.style.setProperty("padding","1rem"),M.style.setProperty("margin-bottom","0.5rem"),a(J,()=>e("invoiceReport.totalInvoices"),H),a(M,()=>z().totalInvoices,null),Q.style.setProperty("margin-bottom","0.5rem"),a(se,()=>e("invoiceReport.dateRange"),G),a(Q,()=>z().dateRange.from||e("common.all"),oe),a(Q,()=>e("common.to"),ae),a(Q,()=>z().dateRange.to||e("common.all"),null),Y.style.setProperty("margin-bottom","0.5rem"),a(ie,()=>e("invoiceReport.store"),de),a(Y,(()=>{var pe=Ee(()=>z().store==="all");return()=>pe()?e("invoiceReport.allStores"):z().store})(),null),a(ge,()=>e("invoiceReport.shippingTypeLabel"),Pe),a(ue,(()=>{var pe=Ee(()=>z().shippingType==="all");return()=>pe()?e("invoiceReport.allTypes"):Ee(()=>z().shippingType==="SEA")()?e("invoiceReport.maritime"):Ee(()=>z().shippingType==="AEREO")()?e("invoiceReport.air"):e("invoiceReport.notSet")})(),null),I}}),null),a(j,R(Ot,{get title(){return e("invoiceReport.paymentMethods")},get children(){var I=a8(),M=I.firstChild,J=M.firstChild,H=J.firstChild;J.nextSibling;var Q=M.nextSibling,se=Q.firstChild,G=se.firstChild;se.nextSibling;var re=Q.nextSibling,oe=re.firstChild,fe=oe.firstChild;oe.nextSibling;var ae=re.nextSibling,Y=ae.firstChild,ie=Y.firstChild;return Y.nextSibling,I.style.setProperty("padding","1rem"),M.style.setProperty("margin-bottom","0.5rem"),a(J,()=>e("invoiceReport.cash"),H),a(M,()=>b(z().paymentMethods.cash),null),Q.style.setProperty("margin-bottom","0.5rem"),a(se,()=>e("invoiceReport.zelle"),G),a(Q,()=>b(z().paymentMethods.zelle),null),re.style.setProperty("margin-bottom","0.5rem"),a(oe,()=>e("invoiceReport.other"),fe),a(re,()=>b(z().paymentMethods.other),null),ae.style.setProperty("border-top","1px solid var(--border-color)"),ae.style.setProperty("padding-top","0.5rem"),ae.style.setProperty("font-weight","bold"),a(Y,()=>e("invoiceReport.total"),ie),a(ae,()=>b(z().paymentMethods.total),null),I}}),null),a(j,R(Ot,{get title(){return e("invoiceReport.additionalCharges")},get children(){var I=l8(),M=I.firstChild,J=M.firstChild,H=J.firstChild;J.nextSibling;var Q=M.nextSibling,se=Q.firstChild,G=se.firstChild;se.nextSibling;var re=Q.nextSibling,oe=re.firstChild,fe=oe.firstChild;return oe.nextSibling,I.style.setProperty("padding","1rem"),M.style.setProperty("margin-bottom","0.5rem"),a(J,()=>e("invoiceReport.transport"),H),a(M,()=>b(z().transportTotal),null),Q.style.setProperty("margin-bottom","0.5rem"),a(se,()=>e("invoiceReport.aranceles"),G),a(Q,()=>b(z().arancelesTotal),null),re.style.setProperty("margin-bottom","0.5rem"),a(oe,()=>e("invoiceReport.tax"),fe),a(re,()=>b(z().taxTotal),null),I}}),null),j})(),R(ze,{get when(){return z().productsByType?.size>0},get children(){return R(Ot,{get title(){return e("invoiceReport.productsSummary")},style:{"margin-bottom":"2rem"},get children(){var j=Cb(),I=j.firstChild,M=I.firstChild,J=M.firstChild,H=J.firstChild,Q=H.nextSibling,se=Q.nextSibling,G=se.nextSibling,re=M.nextSibling;return j.style.setProperty("overflow-x","auto"),I.style.setProperty("width","100%"),I.style.setProperty("border-collapse","collapse"),J.style.setProperty("background","var(--background-color)"),H.style.setProperty("padding","1rem"),H.style.setProperty("text-align","left"),H.style.setProperty("border-bottom","2px solid var(--border-color)"),a(H,()=>e("invoiceReport.productType")),Q.style.setProperty("padding","1rem"),Q.style.setProperty("text-align","right"),Q.style.setProperty("border-bottom","2px solid var(--border-color)"),a(Q,()=>e("invoiceReport.quantity")),se.style.setProperty("padding","1rem"),se.style.setProperty("text-align","right"),se.style.setProperty("border-bottom","2px solid var(--border-color)"),a(se,()=>e("invoiceReport.totalValue")),G.style.setProperty("padding","1rem"),G.style.setProperty("text-align","right"),G.style.setProperty("border-bottom","2px solid var(--border-color)"),a(G,()=>e("invoiceReport.avgPrice")),a(re,R(Ut,{get each(){return Array.from(z().productsByType.entries()).sort((oe,fe)=>fe[1].total-oe[1].total)},children:([oe,fe])=>(()=>{var ae=m8(),Y=ae.firstChild,ie=Y.nextSibling,de=ie.nextSibling,ue=de.nextSibling;return Y.style.setProperty("padding","0.75rem"),Y.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Y,oe),ie.style.setProperty("padding","0.75rem"),ie.style.setProperty("text-align","right"),ie.style.setProperty("border-bottom","1px solid var(--border-color)"),a(ie,()=>fe.qty),de.style.setProperty("padding","0.75rem"),de.style.setProperty("text-align","right"),de.style.setProperty("border-bottom","1px solid var(--border-color)"),de.style.setProperty("font-weight","600"),a(de,()=>b(fe.total)),ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("text-align","right"),ue.style.setProperty("border-bottom","1px solid var(--border-color)"),a(ue,()=>b(fe.total/fe.qty)),ae})()})),j}})}}),R(ze,{get when(){return z().reservasByTypeAndPrice?.size>0},get children(){return R(Ot,{get title(){return e("invoiceReport.reservasSummary")},style:{"margin-bottom":"2rem"},get children(){var j=Cb(),I=j.firstChild,M=I.firstChild,J=M.firstChild,H=J.firstChild,Q=H.nextSibling,se=Q.nextSibling,G=se.nextSibling,re=M.nextSibling;return j.style.setProperty("overflow-x","auto"),I.style.setProperty("width","100%"),I.style.setProperty("border-collapse","collapse"),J.style.setProperty("background","var(--background-color)"),H.style.setProperty("padding","1rem"),H.style.setProperty("text-align","left"),H.style.setProperty("border-bottom","2px solid var(--border-color)"),a(H,()=>e("invoiceReport.reservaType")),Q.style.setProperty("padding","1rem"),Q.style.setProperty("text-align","right"),Q.style.setProperty("border-bottom","2px solid var(--border-color)"),a(Q,()=>e("invoiceReport.totalQtyLbs")),se.style.setProperty("padding","1rem"),se.style.setProperty("text-align","left"),se.style.setProperty("border-bottom","2px solid var(--border-color)"),a(se,()=>e("invoiceReport.priceGroups")),G.style.setProperty("padding","1rem"),G.style.setProperty("text-align","right"),G.style.setProperty("border-bottom","2px solid var(--border-color)"),a(G,()=>e("invoiceReport.total")),a(re,R(Ut,{get each(){return Array.from(z().reservasByTypeAndPrice.entries()).sort((oe,fe)=>fe[1].total-oe[1].total)},children:([oe,fe])=>(()=>{var ae=y8(),Y=ae.firstChild,ie=Y.nextSibling,de=ie.nextSibling,ue=de.firstChild,ge=de.nextSibling;return Y.style.setProperty("padding","0.75rem"),Y.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Y,oe),ie.style.setProperty("padding","0.75rem"),ie.style.setProperty("text-align","right"),ie.style.setProperty("border-bottom","1px solid var(--border-color)"),ie.style.setProperty("font-weight","600"),a(ie,()=>fe.qty),de.style.setProperty("padding","0.75rem"),de.style.setProperty("border-bottom","1px solid var(--border-color)"),ue.style.setProperty("font-size","0.875rem"),a(ue,R(Ut,{get each(){return Array.from(fe.priceGroups.entries()).sort((Pe,pe)=>Pe[0]-pe[0])},children:([Pe,pe])=>(()=>{var _e=g8(),Le=_e.firstChild,De=Le.firstChild,Te=De.nextSibling;Te.nextSibling;var $e=Le.nextSibling,Ie=$e.firstChild,Re=Ie.nextSibling;return Re.nextSibling,_e.style.setProperty("margin-bottom","0.5rem"),_e.style.setProperty("display","flex"),_e.style.setProperty("align-items","center"),_e.style.setProperty("gap","0.5rem"),a(Le,()=>b(Pe),De),a(Le,()=>pe.qty,Te),$e.addEventListener("mouseleave",Je=>Je.currentTarget.style.background="#3498db"),$e.addEventListener("mouseenter",Je=>Je.currentTarget.style.background="#2980b9"),$e.$$click=()=>$({price:Pe,invoices:pe.invoices,type:oe}),$e.style.setProperty("background","#3498db"),$e.style.setProperty("color","white"),$e.style.setProperty("border","none"),$e.style.setProperty("border-radius","4px"),$e.style.setProperty("padding","0.25rem 0.5rem"),$e.style.setProperty("font-size","0.75rem"),$e.style.setProperty("cursor","pointer"),$e.style.setProperty("transition","background 0.2s"),a($e,()=>pe.invoices.length,Re),a($e,()=>pe.invoices.length>1?"s":"",null),_e})()})),ge.style.setProperty("padding","0.75rem"),ge.style.setProperty("text-align","right"),ge.style.setProperty("border-bottom","1px solid var(--border-color)"),ge.style.setProperty("font-weight","600"),a(ge,()=>b(fe.total)),ae})()})),j}})}}),R(ze,{get when(){return z().otherServicesByType?.size>0},get children(){return R(Ot,{get title(){return e("invoiceReport.otherServicesTitle")},style:{"margin-bottom":"2rem"},get children(){var j=c8(),I=j.firstChild,M=I.firstChild,J=M.firstChild,H=J.firstChild,Q=H.nextSibling,se=M.nextSibling,G=se.firstChild,re=G.firstChild,oe=re.firstChild,fe=oe.firstChild,ae=re.nextSibling;return j.style.setProperty("overflow-x","auto"),I.style.setProperty("width","100%"),I.style.setProperty("border-collapse","collapse"),J.style.setProperty("background","var(--background-color)"),H.style.setProperty("padding","1rem"),H.style.setProperty("text-align","left"),H.style.setProperty("border-bottom","2px solid var(--border-color)"),a(H,()=>e("invoiceReport.serviceType")),Q.style.setProperty("padding","1rem"),Q.style.setProperty("text-align","right"),Q.style.setProperty("border-bottom","2px solid var(--border-color)"),a(Q,()=>e("invoiceReport.total")),a(se,R(Ut,{get each(){return Array.from(z().otherServicesByType.entries()).sort((Y,ie)=>ie[1].total-Y[1].total)},children:([Y,ie])=>(()=>{var de=v8(),ue=de.firstChild,ge=ue.firstChild,Pe=ue.nextSibling;return ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("border-bottom","1px solid var(--border-color)"),ge.style.setProperty("display","flex"),ge.style.setProperty("align-items","center"),ge.style.setProperty("gap","0.5rem"),a(ge,Y),Pe.style.setProperty("padding","0.75rem"),Pe.style.setProperty("text-align","right"),Pe.style.setProperty("border-bottom","1px solid var(--border-color)"),Pe.style.setProperty("font-weight","600"),a(Pe,()=>b(ie.total)),de})()}),G),G.style.setProperty("background","var(--strip-color)"),G.style.setProperty("font-weight","bold"),re.style.setProperty("padding","0.75rem"),re.style.setProperty("text-align","right"),re.style.setProperty("border-top","2px solid var(--border-color)"),a(oe,()=>e("invoiceReport.totalOtherServices"),fe),ae.style.setProperty("padding","0.75rem"),ae.style.setProperty("text-align","right"),ae.style.setProperty("border-top","2px solid var(--border-color)"),ae.style.setProperty("font-weight","700"),a(ae,()=>b(z().transportTotal)),j}})}}),R(Ot,{get title(){return e("invoiceReport.totalSummary")},get children(){var j=u8(),I=j.firstChild,M=I.firstChild,J=M.nextSibling,H=I.nextSibling,Q=H.firstChild,se=Q.nextSibling,G=H.nextSibling,re=G.firstChild,oe=re.nextSibling,fe=G.nextSibling,ae=fe.firstChild,Y=ae.nextSibling;return j.style.setProperty("display","grid"),j.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),j.style.setProperty("gap","2rem"),j.style.setProperty("padding","2rem"),I.style.setProperty("text-align","center"),M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","var(--text-secondary)"),M.style.setProperty("margin-bottom","0.5rem"),a(M,()=>e("invoiceReport.productsTotal")),J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","bold"),J.style.setProperty("color","var(--primary-color)"),a(J,()=>b(Array.from(z().productsByType.values()).reduce((ie,de)=>ie+de.total,0))),H.style.setProperty("text-align","center"),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-secondary)"),Q.style.setProperty("margin-bottom","0.5rem"),a(Q,()=>e("invoiceReport.reservasTotal")),se.style.setProperty("font-size","1.5rem"),se.style.setProperty("font-weight","bold"),se.style.setProperty("color","var(--primary-color)"),a(se,()=>b(Array.from(z().reservasByTypeAndPrice.values()).reduce((ie,de)=>ie+de.total,0))),G.style.setProperty("text-align","center"),re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-secondary)"),re.style.setProperty("margin-bottom","0.5rem"),a(re,()=>e("invoiceReport.transportServices")),oe.style.setProperty("font-size","1.5rem"),oe.style.setProperty("font-weight","bold"),oe.style.setProperty("color","var(--primary-color)"),a(oe,()=>b(z().transportTotal)),fe.style.setProperty("text-align","center"),fe.style.setProperty("border-left","2px solid var(--primary-color)"),fe.style.setProperty("padding-left","2rem"),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-secondary)"),ae.style.setProperty("margin-bottom","0.5rem"),a(ae,()=>e("invoiceReport.grandTotal")),Y.style.setProperty("font-size","2rem"),Y.style.setProperty("font-weight","bold"),Y.style.setProperty("color","var(--primary-color)"),a(Y,()=>b(z().paymentMethods.total)),j}})]}}),null),a(Z,R(ze,{get when(){return r()},get children(){var j=d8(),I=j.firstChild;return j.style.setProperty("text-align","center"),j.style.setProperty("padding","3rem"),I.style.setProperty("font-size","1.25rem"),I.style.setProperty("margin-bottom","1rem"),a(I,()=>e("invoiceReport.generatingReport")),j}}),null),a(Z,R(ze,{get when(){return te()},get children(){var j=h8(),I=j.firstChild,M=I.firstChild,J=M.firstChild,H=J.nextSibling,Q=M.nextSibling,se=Q.firstChild,G=se.firstChild,re=G.nextSibling,oe=se.nextSibling,fe=oe.firstChild,ae=fe.nextSibling,Y=oe.nextSibling,ie=Y.firstChild,de=ie.nextSibling,ue=Q.nextSibling,ge=ue.firstChild,Pe=ge.firstChild,pe=ge.nextSibling,_e=ue.nextSibling;return j.$$click=()=>$(null),j.style.setProperty("position","fixed"),j.style.setProperty("top","0"),j.style.setProperty("left","0"),j.style.setProperty("right","0"),j.style.setProperty("bottom","0"),j.style.setProperty("background","rgba(0, 0, 0, 0.5)"),j.style.setProperty("display","flex"),j.style.setProperty("align-items","center"),j.style.setProperty("justify-content","center"),j.style.setProperty("z-index","1000"),I.$$click=Le=>Le.stopPropagation(),I.style.setProperty("background","white"),I.style.setProperty("padding","2rem"),I.style.setProperty("border-radius","var(--border-radius)"),I.style.setProperty("max-width","600px"),I.style.setProperty("max-height","80vh"),I.style.setProperty("overflow-y","auto"),I.style.setProperty("box-shadow","var(--shadow-lg)"),M.style.setProperty("display","flex"),M.style.setProperty("justify-content","space-between"),M.style.setProperty("align-items","center"),M.style.setProperty("margin-bottom","1.5rem"),J.style.setProperty("font-size","1.25rem"),J.style.setProperty("font-weight","bold"),a(J,()=>e("invoiceReport.invoiceReferences")),H.$$click=()=>$(null),H.style.setProperty("background","none"),H.style.setProperty("border","none"),H.style.setProperty("font-size","1.5rem"),H.style.setProperty("cursor","pointer"),H.style.setProperty("color","#666"),Q.style.setProperty("margin-bottom","1rem"),se.style.setProperty("font-size","0.875rem"),se.style.setProperty("color","var(--text-secondary)"),a(se,()=>e("invoiceReport.type"),G),a(re,()=>te().type),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-secondary)"),a(oe,()=>e("invoiceReport.pricePerPound"),fe),a(ae,()=>b(te().price)),Y.style.setProperty("font-size","0.875rem"),Y.style.setProperty("color","var(--text-secondary)"),a(Y,()=>e("invoiceReport.totalInvoicesCount"),ie),a(de,()=>te().invoices.length),ue.style.setProperty("border","1px solid var(--border-color)"),ue.style.setProperty("border-radius","var(--border-radius-sm)"),ue.style.setProperty("padding","1rem"),ue.style.setProperty("background","var(--background-color)"),ge.style.setProperty("font-weight","600"),ge.style.setProperty("margin-bottom","0.75rem"),a(ge,()=>e("invoiceReport.invoiceNumbers"),Pe),pe.style.setProperty("display","grid"),pe.style.setProperty("grid-template-columns","repeat(auto-fill, minmax(120px, 1fr))"),pe.style.setProperty("gap","0.5rem"),a(pe,R(Ut,{get each(){return te().invoices},children:Le=>(()=>{var De=Ab();return De.$$click=()=>{const Te=q().find($e=>$e.invoice===Le);Te&&console.log("Invoice details:",Te)},De.addEventListener("mouseleave",Te=>{Te.currentTarget.style.background="white",Te.currentTarget.style.borderColor="var(--border-color)"}),De.addEventListener("mouseenter",Te=>{Te.currentTarget.style.background="#e3f2fd",Te.currentTarget.style.borderColor="#2196f3"}),De.style.setProperty("padding","0.5rem"),De.style.setProperty("background","white"),De.style.setProperty("border","1px solid var(--border-color)"),De.style.setProperty("border-radius","var(--border-radius-sm)"),De.style.setProperty("font-family","monospace"),De.style.setProperty("font-size","0.875rem"),De.style.setProperty("text-align","center"),De.style.setProperty("transition","all 0.2s"),De.style.setProperty("cursor","pointer"),a(De,Le),De})()})),_e.style.setProperty("margin-top","1.5rem"),_e.style.setProperty("display","flex"),_e.style.setProperty("justify-content","flex-end"),_e.style.setProperty("gap","1rem"),a(_e,R(ht,{variant:"outline",onClick:()=>{const Le=te().invoices.join(", ");navigator.clipboard.writeText(Le).then(()=>{alert(e("invoiceReport.invoiceNumbersCopied"))})},get children(){return e("invoiceReport.copyInvoiceNumbers")}}),null),a(_e,R(ht,{variant:"primary",onClick:()=>$(null),get children(){return e("invoiceReport.close")}}),null),j}}),null),Z})()};br(["click"]);var _8=he("<div><div>"),S8=he("<div>⚠️ "),P8=he("<div><div><label></label><select><option value=all></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label><input type=text>"),w8=he("<div><button></button><button></button><button>➕ Crear Nueva Factura</button><button>📊 Resume Report"),il=he("<div>"),x8=he("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),A8=he("<button>← "),C8=he("<option>"),I8=he("<div><div></div><div></div><div></div><div>"),Ib=he("<div><span></span><span> "),$8=he("<div><span></span><span> $"),E8=he("<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td><span></span></td><td><button>");const fh=t=>parseFloat(t?.toString())||0,T8=t=>{let e=fh(t.qty),r=fh(t.price),n=fh(t.arancel);return`${(e*r+n)?.toFixed(2)}`},P_=t=>{let e=Math.abs(t.qty),r=fh(t.salePrice);return`${(e*r)?.toFixed(2)}`},k8=t=>{let e=0;t?.reservas?.forEach(i=>{e+=parseFloat(T8(i))});let r=0;t?.products?.forEach(i=>{r+=parseFloat(P_(i))});let n={};return n.reservaSubtotal=e.toFixed(2),n.productSubtotal=r.toFixed(2),n.subtotalBeforeTax=(r+e).toFixed(2),n.total=n.subtotalBeforeTax,n},N8=t=>{const{t:e}=or(),[r,n]=Ce(!1),[i,o]=Ce("all"),[s,l]=Ce(""),[c,u]=Ce(""),[h,y]=Ce(null),[g,f]=Ce(null),[x,S]=Ce("dashboard"),[w,E]=Ce([]),[q,ee]=Ce(""),[W,K]=Ce("overview");wn(async()=>{try{t.invoices;try{const re=await Di.fetchStores();let oe=Array.isArray(re)?re:Object.keys(re)||[]}catch{const oe=Di.state.invoices||t.invoices,fe=[...new Set(oe.map(ae=>ae.store))];E(fe.sort())}}catch(re){console.error("Error loading dashboard data:",re)}}),Mt(()=>Di.state.invoices||t.invoices);const te=Mt(()=>{let re;return t.invoices?re=Di.getFilteredInvoices({store:i(),dateFrom:s(),dateTo:c()}):re=Di.getFilteredInvoices({store:i(),dateFrom:s(),dateTo:c()}),re}),$=async()=>{try{t.invoices,n(!0),await Di.refreshData({store:i()!=="all"?i():void 0,dateFrom:s()||void 0,dateTo:c()||void 0,search:q()}),n(!1)}catch(re){console.error("Error refreshing data:",re)}},C=Mt(()=>{r();const re=te(),oe=Di.calculateSummary(re);let fe=new Map,ae=new Map,Y=new Map;return re.forEach(ie=>{ie?.products?.length>0&&ie?.products?.forEach(de=>{const ue=Math.abs(de.qty),ge=de.product.label;fe.set(ge,(fe.get(ge)||0)+ue)}),ie?.reservas?.length>0&&ie?.reservas?.forEach(de=>{let ue=parseInt(de.qty);isNaN(ue)&&(ue=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[de.type]||de?.onlyTariff?(ue=parseFloat(de.arancel)||parseFloat(de.qty)*parseFloat(de.price),Y.set(de.type,(ae.get(de.type)||0)+ue)):ae.set(de.type,(ae.get(de.type)||0)+ue)})}),{...oe,productsByCategory:fe,reservasByType:ae,othersByType:Y}}),T=re=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(re),O=re=>new Date(re).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),b={padding:"2rem"},P={display:"flex",gap:"1rem","align-items":"flex-end","margin-bottom":"2rem","flex-wrap":"wrap",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)"},_={display:"flex","flex-direction":"column",gap:"0.5rem",flex:"1","min-width":"200px"},z={"font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)"},Z={padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--background-color)"},k={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(280px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},F={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)"},X={width:"48px",height:"48px","border-radius":"12px",display:"flex","align-items":"center","justify-content":"center","font-size":"1.5rem","margin-bottom":"1rem"},U={"font-size":"0.875rem",color:"var(--text-secondary)","margin-bottom":"0.5rem"},B={"font-size":"1.75rem","font-weight":"700",color:"var(--text-primary)","margin-bottom":"0.25rem"},ce={"font-size":"0.75rem",color:"var(--text-muted)"},L={width:"100%",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)",overflow:"hidden"},D={padding:"1rem","text-align":"left",background:"var(--background-color)","font-weight":"600",color:"var(--text-secondary)","font-size":"0.875rem","border-bottom":"2px solid var(--border-color)"},j={padding:"1rem","border-bottom":"1px solid var(--border-color)"},I={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},M=re=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:re?"var(--primary-color)":"var(--text-muted)","border-bottom":re?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),J={padding:"0.5rem 1rem",background:"var(--primary-color)",color:"white",border:"none","border-radius":"var(--border-radius-sm)",cursor:"pointer","font-size":"0.875rem",transition:"opacity 0.2s"},H={padding:"0.75rem 1.5rem",background:"var(--secondary-color)",color:"white",border:"none","border-radius":"var(--border-radius-sm)",cursor:"pointer","margin-bottom":"1rem",display:"flex","align-items":"center",gap:"0.5rem"},Q=()=>[{title:e("invoices.totalRevenue"),value:C().grandTotal,icon:"💰",color:"#4CAF50",subtext:`${e("common.of")} ${C().totalInvoices} ${e("common.invoice")} `},{title:e("invoices.totalProducts"),value:C().totalProducts,icon:"📦",color:"#2196F3",subtext:`${T(C().totalProductAmount)} ${e("invoices.value")}`,isNumber:!0},{title:e("invoices.totalReservations"),value:C().totalReservas,icon:"🎫",color:"#FF9800",subtext:`${T(C().totalReservaAmount)} ${e("invoices.value")}`,isNumber:!0},{title:e("invoices.aranceles"),value:C().totalAranceles,icon:"🏛️",color:"#9C27B0",subtext:e("invoices.customsFees")},{title:e("invoices.uniqueCustomers"),value:C().uniqueCustomers,icon:"👥",color:"#00BCD4",subtext:e("invoices.activeCustomers"),isNumber:!0},{title:e("invoices.averageInvoice"),value:C().avgInvoiceValue,icon:"📊",color:"#FF5722",subtext:e("invoices.perInvoiceValue")},{title:e("invoices.completed"),value:C().completedInvoices,icon:"✅",color:"#4CAF50",subtext:`${C().pendingInvoices} ${e("invoices.pending")}`,isNumber:!0},{title:e("invoices.storesActive"),value:w().length,icon:"🏪",color:"#795548",subtext:e("invoices.locations"),isNumber:!0}],se=()=>ut.getActiveLocations();gi(()=>{});const G=async()=>{let re="YB1";zy.calcStockLevels(),await ut.fecthProduct(re),await ut.fecthInventory(re)};return wn(()=>{G()}),R(to,{get title(){return e("invoices.title")},get children(){var re=il();return m(re,b),a(re,R(ze,{get when(){return x()==="dashboard"},get children(){return[R(ze,{get when(){return!t.invoices&&Di.state.loading},get children(){var oe=_8(),fe=oe.firstChild;return oe.style.setProperty("text-align","center"),oe.style.setProperty("padding","2rem"),fe.style.setProperty("font-size","1.25rem"),fe.style.setProperty("margin-bottom","1rem"),a(fe,()=>e("invoices.loadingInvoices")),oe}}),R(ze,{get when(){return Di.state.error},get children(){var oe=S8();return oe.firstChild,oe.style.setProperty("padding","1rem"),oe.style.setProperty("margin-bottom","1rem"),oe.style.setProperty("background","#ffebee"),oe.style.setProperty("border","1px solid #ffcdd2"),oe.style.setProperty("border-radius","var(--border-radius)"),oe.style.setProperty("color","#d32f2f"),a(oe,()=>Di.state.error,null),a(oe,R(ht,{variant:"outline",size:"sm",onClick:$,style:{"margin-left":"1rem"},get children(){return e("invoices.refreshData")}}),null),oe}}),(()=>{var oe=P8(),fe=oe.firstChild,ae=fe.firstChild,Y=ae.nextSibling,ie=Y.firstChild,de=fe.nextSibling,ue=de.firstChild,ge=ue.nextSibling,Pe=de.nextSibling,pe=Pe.firstChild,_e=pe.nextSibling,Le=Pe.nextSibling,De=Le.firstChild,Te=De.nextSibling;return m(oe,P),a(ae,()=>e("invoices.storeLocation")),Y.addEventListener("change",$e=>o($e.currentTarget.value)),a(ie,()=>e("invoices.allStores")),a(Y,R(Ut,{get each(){return se()},children:$e=>(()=>{var Ie=C8();return a(Ie,()=>$e.name),Se(()=>Ie.value=$e.id),Ie})()}),null),a(ue,()=>e("invoices.fromDate")),ge.addEventListener("change",$e=>l($e.currentTarget.value)),a(pe,()=>e("invoices.toDate")),_e.addEventListener("change",$e=>u($e.currentTarget.value)),a(De,()=>e("invoices.search")),Te.addEventListener("change",$e=>ee($e.currentTarget.value)),a(oe,R(ht,{variant:"secondary",onClick:()=>{o("all"),l(""),u(""),ee("")},get children(){return e("invoices.clearFilters")}}),null),a(oe,R(ht,{variant:"primary",onClick:$,get disabled(){return!t.invoices&&Di.state.loading},get children(){return["🔄 ",Ee(()=>e("invoices.refreshData"))]}}),null),Se($e=>{var Ie=_,Re=z,Je=Z,Be=_,Ke=z,Xe=Z,at=_,ot=z,Qe=Z,dt=_,ct=z,kt=Z,gt=e("invoices.searchPlaceholder");return $e.e=m(fe,Ie,$e.e),$e.t=m(ae,Re,$e.t),$e.a=m(Y,Je,$e.a),$e.o=m(de,Be,$e.o),$e.i=m(ue,Ke,$e.i),$e.n=m(ge,Xe,$e.n),$e.s=m(Pe,at,$e.s),$e.h=m(pe,ot,$e.h),$e.r=m(_e,Qe,$e.r),$e.d=m(Le,dt,$e.d),$e.l=m(De,ct,$e.l),$e.u=m(Te,kt,$e.u),gt!==$e.c&&tr(Te,"placeholder",$e.c=gt),$e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0}),Se(()=>Y.value=i()),Se(()=>ge.value=s()),Se(()=>_e.value=c()),Se(()=>Te.value=q()),oe})(),(()=>{var oe=w8(),fe=oe.firstChild,ae=fe.nextSibling,Y=ae.nextSibling,ie=Y.nextSibling;return m(oe,I),fe.$$click=()=>K("overview"),a(fe,()=>e("inventory.overview")),ae.$$click=()=>K("invoices"),a(ae,()=>e("invoices.invoices")),Y.$$click=()=>K("add"),ie.$$click=()=>K("report"),Se(de=>{var ue=M(W()==="overview"),ge=M(W()==="invoices"),Pe=M(W()==="add"),pe=M(W()==="report");return de.e=m(fe,ue,de.e),de.t=m(ae,ge,de.t),de.a=m(Y,Pe,de.a),de.o=m(ie,pe,de.o),de},{e:void 0,t:void 0,a:void 0,o:void 0}),oe})(),R(ze,{get when(){return W()==="overview"},get children(){return[(()=>{var oe=il();return m(oe,k),a(oe,R(Ut,{get each(){return Q()},children:fe=>(()=>{var ae=I8(),Y=ae.firstChild,ie=Y.nextSibling,de=ie.nextSibling,ue=de.nextSibling;return m(ae,F),a(Y,()=>fe?.icon),m(ie,U),a(ie,()=>fe?.title),m(de,B),a(de,(()=>{var ge=Ee(()=>!!fe.isNumber);return()=>ge()?fe.value:T(fe.value)})()),m(ue,ce),a(ue,()=>fe.subtext),Se(ge=>m(Y,{...X,background:`${fe?.color}20`,color:fe?.color},ge)),ae})()})),oe})(),R(ze,{get when(){return C()?.productsByCategory?.size>0},get children(){return R(Ot,{get title(){return e("invoices.topProducts")},get subtitle(){return e("invoices.mostSoldProducts")},get children(){var oe=il();return oe.style.setProperty("max-height","300px"),oe.style.setProperty("overflow-y","auto"),a(oe,()=>Array.from(C().productsByCategory.entries()).sort((fe,ae)=>ae[1]-fe[1]).slice(0,10).map(([fe,ae])=>(()=>{var Y=Ib(),ie=Y.firstChild,de=ie.nextSibling,ue=de.firstChild;return Y.style.setProperty("display","flex"),Y.style.setProperty("justify-content","space-between"),Y.style.setProperty("padding","0.75rem"),Y.style.setProperty("border-bottom","1px solid var(--border-color)"),a(ie,fe),de.style.setProperty("font-weight","600"),a(de,ae,ue),a(de,()=>e("common.units"),null),Y})())),oe}})}}),(()=>{var oe=il();return oe.style.setProperty("margin","19px"),oe})(),R(ze,{get when(){return C()?.reservasByType?.size>0},get children(){return R(Ot,{get title(){return e("invoices.reservationsByType")},get subtitle(){return e("invoices.distributionOfCategories")},style:{"margin-top":"1.5rem"},get children(){var oe=il();return oe.style.setProperty("max-height","300px"),oe.style.setProperty("overflow-y","auto"),a(oe,()=>Array.from(C().reservasByType.entries()).sort((fe,ae)=>ae[1]-fe[1]).map(([fe,ae])=>(()=>{var Y=Ib(),ie=Y.firstChild,de=ie.nextSibling,ue=de.firstChild;return Y.style.setProperty("display","flex"),Y.style.setProperty("justify-content","space-between"),Y.style.setProperty("padding","0.75rem"),Y.style.setProperty("border-bottom","1px solid var(--border-color)"),a(ie,fe),de.style.setProperty("font-weight","600"),a(de,ae,ue),a(de,()=>e("common.lbs"),null),Y})())),oe}})}}),(()=>{var oe=il();return oe.style.setProperty("margin","19px"),oe})(),R(ze,{get when(){return C()?.othersByType?.size>0},get children(){return R(Ot,{title:"Aranceles y otros servicios",get subtitle(){return e("invoices.distributionOfCategories")},style:{"margin-top":"1.5rem"},get children(){var oe=il();return oe.style.setProperty("max-height","300px"),oe.style.setProperty("overflow-y","auto"),a(oe,()=>Array.from(C().othersByType.entries()).sort((fe,ae)=>ae[1]-fe[1]).map(([fe,ae])=>(()=>{var Y=$8(),ie=Y.firstChild,de=ie.nextSibling,ue=de.firstChild;return Y.style.setProperty("display","flex"),Y.style.setProperty("justify-content","space-between"),Y.style.setProperty("padding","0.75rem"),Y.style.setProperty("border-bottom","1px solid var(--border-color)"),a(ie,fe),de.style.setProperty("font-weight","600"),a(de,ae,ue),Y})())),oe}})}})]}})]}}),null),a(re,R(ze,{get when(){return W()==="invoices"},get children(){return[R(ze,{get when(){return x()!=="detail"},get children(){return R(Ot,{get title(){return e("invoices.recentInvoices")},get subtitle(){return`Mostrando ${te().length} facturas`},style:{"margin-top":"1.5rem"},get children(){var oe=x8(),fe=oe.firstChild,ae=fe.firstChild,Y=ae.firstChild,ie=Y.firstChild,de=ie.nextSibling,ue=de.nextSibling,ge=ue.nextSibling,Pe=ge.nextSibling,pe=Pe.nextSibling,_e=pe.nextSibling,Le=_e.nextSibling,De=Le.nextSibling,Te=ae.nextSibling;return oe.style.setProperty("overflow-x","auto"),m(fe,L),a(ie,()=>e("invoices.invoiceNumber")),a(de,()=>e("invoices.date")),a(ue,()=>e("invoices.customer")),a(ge,()=>e("invoices.store")),a(Pe,()=>e("invoices.products")),a(pe,()=>e("invoices.reservations")),a(_e,()=>e("invoices.total")),a(Le,()=>e("invoices.status")),a(De,()=>e("invoices.actions")),a(Te,R(Ut,{get each(){return te().slice(0,50)},children:$e=>{console.log($e);const Ie=()=>Jh($e);return(()=>{var Re=E8(),Je=Re.firstChild,Be=Je.nextSibling,Ke=Be.nextSibling,Xe=Ke.nextSibling,at=Xe.nextSibling,ot=at.nextSibling,Qe=ot.nextSibling,dt=Qe.nextSibling,ct=dt.firstChild,kt=dt.nextSibling,gt=kt.firstChild;return a(Je,()=>$e?.invoice),a(Be,()=>O($e?.createDate)),a(Ke,()=>$e?.shipper_consignee?.name),a(Xe,()=>$e?.store),a(at,()=>Ie()?.productSubtotal),a(ot,()=>Ie()?.reservaSubtotal),a(Qe,()=>T(Ie()?.total)),ct.style.setProperty("padding","0.25rem 0.75rem"),ct.style.setProperty("border-radius","9999px"),ct.style.setProperty("font-size","0.75rem"),ct.style.setProperty("font-weight","600"),a(ct,(()=>{var qe=Ee(()=>!!$e.isCompleted);return()=>qe()?e("invoices.completed"):e("invoices.pending")})()),gt.addEventListener("mouseleave",qe=>qe.currentTarget.style.opacity="1"),gt.addEventListener("mouseenter",qe=>qe.currentTarget.style.opacity="0.8"),gt.$$click=()=>{f(Jh($e)),y($e),S("detail")},m(gt,J),a(gt,()=>e("invoices.view")),Se(qe=>{var Dt=j,Rt=j,St=j,Bt=j,fr=j,Qt=j,cr={...j,"text-align":"right","font-weight":"600"},xr=j,It=$e.isCompleted?"#d4edda":"#fff3cd",Ge=$e.isCompleted?"#155724":"#856404",Nt=j;return qe.e=m(Je,Dt,qe.e),qe.t=m(Be,Rt,qe.t),qe.a=m(Ke,St,qe.a),qe.o=m(Xe,Bt,qe.o),qe.i=m(at,fr,qe.i),qe.n=m(ot,Qt,qe.n),qe.s=m(Qe,cr,qe.s),qe.h=m(dt,xr,qe.h),It!==qe.r&&((qe.r=It)!=null?ct.style.setProperty("background",It):ct.style.removeProperty("background")),Ge!==qe.d&&((qe.d=Ge)!=null?ct.style.setProperty("color",Ge):ct.style.removeProperty("color")),qe.l=m(kt,Nt,qe.l),qe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),Re})()}})),Se($e=>{var Ie=D,Re=D,Je=D,Be=D,Ke=D,Xe=D,at={...D,"text-align":"right"},ot=D,Qe=D;return $e.e=m(ie,Ie,$e.e),$e.t=m(de,Re,$e.t),$e.a=m(ue,Je,$e.a),$e.o=m(ge,Be,$e.o),$e.i=m(Pe,Ke,$e.i),$e.n=m(pe,Xe,$e.n),$e.s=m(_e,at,$e.s),$e.h=m(Le,ot,$e.h),$e.r=m(De,Qe,$e.r),$e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),oe}})}}),R(ze,{get when(){return Ee(()=>x()==="detail")()&&h()},get children(){return[(()=>{var oe=A8();return oe.firstChild,oe.$$click=()=>{S("dashboard"),y(null)},m(oe,H),a(oe,()=>e("invoices.backToDashboard"),null),oe})(),R(zR,{get invoice(){return h()},onPrint:()=>window.print(),get parseData(){return g()},goBack:()=>{S("dashboard"),y(null)}})]}})]}}),null),a(re,R(ze,{get when(){return W()==="add"},get children(){return R(WD,{})}}),null),a(re,R(ze,{get when(){return W()==="report"},get children(){return R(b8,{})}}),null),re}})};br(["click"]);const L8=()=>R(N8,{invoices:[{type:"SALES",invoice:"20255FK6S4B43SSS",description:"",store:"YY_8816",ssg_inventory_key:"JqdrRwGBpdBfRCim",ssg_sorder_key:"JqdrRwGBpdBfRCim",createDate:1736132690425,shipper_consignee:{name:"Yudith Perez Medero",phoneNumberS:"5022408378",dob:"1982-07-23",firstName:"RAUL",lastName:"BATISTA",lastName2:"ESPOSITO",middleName:"",email:"",phoneNumber:"52393232",altPhoneNumber:"",cid:"48121007305",ybstreetNo:"9",ybstreet:"10",ybbetwen1:"CARRALERO",ybbetwen2:"3RA",ybapt:"",ybreparto:"PUEBLO NUEVO",consigneeId:"26144",ssg_consignee_key:"26144",passport:"NA",nacionality:"CUB",ybcity:"HOLGUIN",ybestate:"HOLGUIN",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534800",reservas:[{type:"UTILES DEL HOGAR",qty:"15",arancel:"10",price:"5",key:"1GB16SD80"},{type:"MISCELANEAS",qty:"19",arancel:"",price:"4",key:"0DS6K14Y2"}],products:[{product:{id:"CmrhMfVjLR9HxT6P",label:"FOGONES ELECTRICO DOBLE RESISTENCIA DE ALAMBRE",code:"978Y82K94"},qty:-1,price:23.696296296296296,salePrice:"34"},{product:{id:"ov56aPYGbXIq4XGy",label:"Caramelos",code:"C852CSKB5"},qty:-2,price:5.990000000000001,salePrice:"10"}],isCompleted:!0},{type:"SALES",invoice:"20255FK6S4B43TTT",description:"",store:"YY_8803",ssg_inventory_key:"JqdrRwGBpdBfRCin",ssg_sorder_key:"JqdrRwGBpdBfRCin",createDate:1736032690425,shipper_consignee:{name:"Maria Rodriguez Santos",phoneNumberS:"5024567890",dob:"1990-03-15",firstName:"MARIA",lastName:"RODRIGUEZ",lastName2:"SANTOS",middleName:"ELENA",email:"maria@email.com",phoneNumber:"52987654",altPhoneNumber:"",cid:"90031507890",ybstreetNo:"15",ybstreet:"23",ybbetwen1:"MARTI",ybbetwen2:"CESPEDES",ybapt:"2A",ybreparto:"CENTRO",consigneeId:"26145",ssg_consignee_key:"26145",passport:"A1234567",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534801",reservas:[{type:"ELECTRONICOS",qty:"5",arancel:"15",price:"12",key:"2GB16SD81"},{type:"ROPA Y CALZADO",qty:"8",arancel:"8",price:"7",key:"0DS6K14Y3"}],products:[{product:{id:"XmrhMfVjLR9HxT6Q",label:"TELEVISOR LED 32 PULGADAS",code:"TV32LED01"},qty:-1,price:150.5,salePrice:"220"},{product:{id:"Yv56aPYGbXIq4XGz",label:"Zapatos Deportivos Nike",code:"ZAP001"},qty:-1,price:45.99,salePrice:"75"}],isCompleted:!1},{type:"SALES",invoice:"20255FK6S4B43UUU",description:"",store:"YY_8816",ssg_inventory_key:"JqdrRwGBpdBfRCio",ssg_sorder_key:"JqdrRwGBpdBfRCio",createDate:1735932690425,shipper_consignee:{name:"Carlos Mendez Perez",phoneNumberS:"5025678901",dob:"1975-12-08",firstName:"CARLOS",lastName:"MENDEZ",lastName2:"PEREZ",middleName:"ANTONIO",email:"",phoneNumber:"52876543",altPhoneNumber:"",cid:"75120878901",ybstreetNo:"7",ybstreet:"45",ybbetwen1:"LINEA",ybbetwen2:"PASEO",ybapt:"",ybreparto:"VEDADO",consigneeId:"26146",ssg_consignee_key:"26146",passport:"NA",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534802",reservas:[{type:"ALIMENTOS",qty:"25",arancel:"5",price:"3",key:"3GB16SD82"}],products:[{product:{id:"ZmrhMfVjLR9HxT6R",label:"ARROZ ESPECIAL 5LB",code:"ARZ005"},qty:-5,price:2.5,salePrice:"4"},{product:{id:"Av56aPYGbXIq4XG1",label:"ACEITE DE COCINA 1L",code:"ACE001"},qty:-3,price:3.75,salePrice:"6"}],isCompleted:!0},{type:"SALES",invoice:"20255FK6S4B43VVV",description:"",store:"YY_8802",ssg_inventory_key:"JqdrRwGBpdBfRCip",ssg_sorder_key:"JqdrRwGBpdBfRCip",createDate:1735832690425,shipper_consignee:{name:"Ana Lucia Fernandez",phoneNumberS:"5026789012",dob:"1988-06-20",firstName:"ANA",lastName:"FERNANDEZ",lastName2:"LOPEZ",middleName:"LUCIA",email:"ana.lucia@email.com",phoneNumber:"52765432",altPhoneNumber:"52111222",cid:"88062076789",ybstreetNo:"12",ybstreet:"18",ybbetwen1:"CALZADA",ybbetwen2:"SAN LAZARO",ybapt:"3B",ybreparto:"CENTRO HABANA",consigneeId:"26147",ssg_consignee_key:"26147",passport:"B9876543",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:"Entrega en horario de oficina"},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534803",reservas:[{type:"MEDICINA Y SALUD",qty:"10",arancel:"12",price:"8",key:"4GB16SD83"},{type:"UTILES DEL HOGAR",qty:"6",arancel:"6",price:"4",key:"5GB16SD84"}],products:[{product:{id:"BmrhMfVjLR9HxT6S",label:"VITAMINAS MULTIPLES 60 CAP",code:"VIT001"},qty:-2,price:12.5,salePrice:"18"}],isCompleted:!0}]}),mh={invoice:"",description:"",store:"",shipper_consignee:{name:"",firstName:"",middleName:"",lastName:"",lastName2:"",phoneNumber:"",cid:"",passport:"",address:""},products:[],reservas:[],packagesOrder:!1,shippingType:"SEA"},Qy="invoice_form_draft",R8=()=>{try{const t=localStorage.getItem(Qy);if(t){const e=JSON.parse(t),r={...mh,...e,shipper_consignee:{...mh.shipper_consignee,...e.shipper_consignee||{}},products:e.products||[],reservas:e.reservas||[]};return console.log("Loaded form data from storage:",r),r}}catch(t){console.warn("Failed to load invoice form from storage:",t)}return console.log("No saved data found, using default form data"),{...mh}},Xy=t=>{try{localStorage.setItem(Qy,JSON.stringify(t))}catch(e){console.warn("Failed to save invoice form to storage:",e)}},$b=()=>{try{localStorage.removeItem(Qy)}catch(t){console.warn("Failed to clear invoice form from storage:",t)}},[dl,Ss]=Ce(R8()),[w_,Co]=Ce(!1),[D8,yh]=Ce(null);let jf=null;const fa=()=>{jf&&clearTimeout(jf),jf=setTimeout(()=>{const t=dl();Xy(t),yh(new Date),console.log("Invoice form auto-saved at",new Date().toLocaleTimeString())},1e3)},M8={formData:dl,get isDirty(){return w_()},get lastSaved(){return D8()},updateForm:t=>{Ss(e=>{const r={...e,...t};return Co(!0),fa(),r})},updateShipperConsignee:t=>{Ss(e=>{const r={...e,shipper_consignee:{...e.shipper_consignee,...t}};return Co(!0),fa(),r})},addProduct:t=>{Ss(e=>{const r={...e,products:[...e.products,t]};return Co(!0),fa(),r})},updateProduct:(t,e)=>{Ss(r=>{const n=[...r.products];n[t]={...n[t],...e};const i={...r,products:n};return Co(!0),fa(),i})},removeProduct:t=>{Ss(e=>{const r=e.products.filter((i,o)=>o!==t),n={...e,products:r};return Co(!0),fa(),n})},addReserva:t=>{Ss(e=>{const r={...e,reservas:[...e.reservas,t]};return Co(!0),fa(),r})},updateReserva:(t,e)=>{Ss(r=>{const n=[...r.reservas];n[t]={...n[t],...e};const i={...r,reservas:n};return Co(!0),fa(),i})},removeReserva:t=>{Ss(e=>{const r=e.reservas.filter((i,o)=>o!==t),n={...e,reservas:r};return Co(!0),fa(),n})},clearForm:()=>{Ss({...mh}),Co(!1),$b(),yh(null)},markCompleted:()=>{$b(),Co(!1),yh(null)},forceSave:()=>{Xy(dl()),yh(new Date),Co(!1)},hasData:()=>{const t=dl();return t.invoice!==""||t.description!==""||t.store!==""||t.shipper_consignee.name!==""||t.shipper_consignee.firstName!==""||t.shipper_consignee.cid!==""||t.products.length>0||t.reservas.length>0},isValid:()=>{const t=dl();return t.invoice.trim()!==""&&t.shipper_consignee.firstName.trim()!==""&&t.shipper_consignee.lastName.trim()!==""&&t.shipper_consignee.cid.trim()!==""&&(t.products.length>0||t.reservas.length>0)},getFormData:()=>dl()};typeof window<"u"&&window.addEventListener("beforeunload",t=>{if(w_()&&(Xy(dl()),M8.hasData()))return t.preventDefault(),t.returnValue="You have unsaved changes in your invoice. Are you sure you want to leave?",t.returnValue});var F8=he("<div><main>");const O8=t=>[R(v$,{}),Ee(()=>t.children)],B8=()=>R(YI,{get children(){var t=F8(),e=t.firstChild;return a(e,R(mP,{root:O8,get children(){return[R(uo,{path:"/",component:gR}),R(uo,{path:"/accounts",component:()=>R(wo,{permission:"AccountAccess",featureName:"Accounts",get children(){return R(lE,{})}})}),R(uo,{path:"/accounts/:id",component:()=>R(wo,{permission:"AccountAccess",featureName:"Account Details",get children(){return R(mE,{})}})}),R(uo,{path:"/entry-books",component:()=>R(wo,{permission:"JournalAccess",featureName:"Entry Books",get children(){return R(vL,{})}})}),R(uo,{path:"/employees",component:()=>R(wo,{permission:"EmployeeAccess",featureName:"Employee Management",get children(){return R(mN,{})}})}),R(uo,{path:"/bank-consolidations",component:()=>R(wo,{permission:"BankingAccess",featureName:"Bank Consolidations",get children(){return R(zN,{})}})}),R(uo,{path:"/balance-sheet",component:()=>R(wo,{permission:"AccountAccess",featureName:"Balance Sheet",get children(){return R(SE,{})}})}),R(uo,{path:"/invoices",component:()=>R(wo,{permission:"invoiceAccess",featureName:"Invoices",get children(){return R(L8,{})}})}),R(uo,{path:"/inventory",component:()=>R(wo,{permission:"InventoryAccess",featureName:"Inventory Management",get children(){return R(sN,{})}})}),R(uo,{path:"/products",component:()=>R(wo,{permission:"InventoryAccess",featureName:"Product Management",get children(){return R(L5,{})}})}),R(uo,{path:"/hbl",component:()=>R(wo,{permission:"HBLAccess",featureName:"HBL Management",get children(){return R(uR,{})}})}),R(uo,{path:"/admin/users",component:()=>R(wo,{permission:"isAdmin",featureName:"User Administration",get children(){return R(TR,{})}})})]}})),a(t,(()=>{var r=Ee(()=>!1);return()=>r()&&R(T$,{})})(),null),t}}),j8=document.getElementById("root");TS(()=>R(B8,{}),j8);export{hr as E,Bi as _,nn as a,U8 as b,ut as i,i_ as j};
