import{u as $e,c as _,s as E,o as Be,e as Q,f as O,g as xe,a as y,S as I,t as v,h as Y,i as l,F as $,b as A,j as U,B as V,L as Ie,k as Z,l as W,q as X,m as ee,n as se,d as Le}from"./index-D9WFV0Yf.js";var te=v("<div>"),ke=v("<div><div><div><strong>Display Name:</strong> </div><div><strong>UID:</strong> </div></div><div><strong>Created:</strong> "),Ce=v("<div><h3>Store Access</h3><div></div><div>No store access granted"),we=v("<div><h3>Business Access</h3><div><label>Primary Business ID</label><select><option value=all></option></select></div><div><label>Additional Business Access</label><div></div><div>User can access data from all selected businesses"),Ne=v("<div><h3>Permissions</h3><div>"),Ee=v("<div><h3>HBL Status Location Permissions</h3><div>Control which status locations this user can update HBLs to</div><div></div><div> locations enabled"),Oe=v('<div><div><input type=text placeholder="Search users..."></div><div>'),Ue=v("<div>‚ö†Ô∏è You need administrator privileges to access this page."),Me=v("<div>Loading users..."),Te=v("<div><div></div><div></div><div> stores"),He=v("<div>Select a user to view and edit their profile"),M=v("<div><input type=checkbox><label>"),Re=v("<option>"),Fe=v("<div><input type=checkbox><div><div></div><div>");const ze=()=>{const{t:re}=$e(),[T,H]=_([]),[s,h]=_(null),[ie,R]=_(!1),[F,D]=_(!1),[z,ne]=_(""),[L,x]=_(null),[q,J]=_([]),[oe,j]=_([]),ae=async()=>{try{const t=Z(W,"stores"),o=X(t,ee("name")),g=await se(o),m=[];g.forEach(i=>{const n=i.data();n.isActive!==!1&&m.push({id:i.id,name:n.name})});const e=[{id:"YY_8802",name:"CENTER"},{id:"YY_8803",name:"BISSONNET"},{id:"YY_8804",name:"IRVIN"},{id:"YY_8805",name:"KATTY"},{id:"YY_8816",name:"YABA GLOBAL"},{id:"YY_8818",name:"YABASURAUSTIN"},{id:"YY_8847",name:"YABAOFICINA AZ"},{id:"YY_3251",name:"YABA FASHION"},{id:"YY_32",name:"YABA MESQUITE"},{id:"YY_76",name:"YABA DALLAS"},{id:"YY_79",name:"YABA 79"},{id:"YY_2376",name:"YABA SAN ANTONIO"},{id:"YY_8635",name:"YABA 8635"},{id:"YY_8665",name:"YABA 8665"},{id:"YY_8901",name:"YABA 8901"},{id:"YY_3303",name:"YABA MIAMI"},{id:"YY_3329",name:"YABA MIAMI 29"},{id:"SS_42",name:"STEPHANIE SOLUTION"}];for(const i of e)m.find(n=>n.id===i.id)||m.push(i);j(m)}catch(t){console.error("Error loading stores from Firestore:",t),j([{id:"YY_8802",name:"CENTER"},{id:"YY_8803",name:"BISSONNET"},{id:"YY_8804",name:"IRVIN"},{id:"YY_8805",name:"KATTY"},{id:"YY_8816",name:"YABA GLOBAL"},{id:"YY_8818",name:"YABASURAUSTIN"},{id:"YY_8847",name:"YABAOFICINA AZ"},{id:"YY_3251",name:"YABA FASHION"},{id:"YY_32",name:"YABA MESQUITE"},{id:"YY_76",name:"YABA DALLAS"},{id:"YY_79",name:"YABA 79"},{id:"YY_2376",name:"YABA SAN ANTONIO"},{id:"YY_8635",name:"YABA 8635"},{id:"YY_8665",name:"YABA 8665"},{id:"YY_8901",name:"YABA 8901"},{id:"YY_3303",name:"YABA MIAMI"},{id:"YY_3329",name:"YABA MIAMI 29"},{id:"SS_42",name:"STEPHANIE SOLUTION"}])}},le=[{key:"AccountAccess",label:"Account Access",description:"Access to accounting features"},{key:"BankingAccess",label:"Banking Access",description:"Access to banking operations"},{key:"InventoryAccess",label:"Inventory Access",description:"Access to inventory management"},{key:"EmployeeAccess",label:"Employee Access",description:"Access to employee management and timesheets"},{key:"JournalAccess",label:"Journal Access",description:"Access to journal entries"},{key:"invoiceAccess",label:"Invoice Access",description:"Access to Invoices"},{key:"RemittanceAccess",label:"Remittance Access",description:"Access to remittances management"},{key:"HBLAccess",label:"HBL Access",description:"Access to HBL management"},{key:"PassportAccess",label:"Passport Access",description:"Access to passport applications"},{key:"inventoryDownsection",label:"Inventory Downsection",description:"Access to inventory downsection"},{key:"onlyRead",label:"Read Only",description:"Limited to read-only access"},{key:"PurchaseRequestAccess",label:"Purchase Request Access",description:"Access to Purchase management"},{key:"read_write",label:"Read/Write",description:"Full read and write permissions"},{key:"AdminPassportAccess",label:"Passport Admin Access",description:"Access to passport applications"},{key:"HBLAccessManagement",label:"HBL Managements Access",description:"Access to HBL management"},{key:"HBLScannerAccess",label:"HBL Scanner Only",description:"Scanner access without full HBL privileges"},{key:"NotaryAccess",label:"Notary Access",description:"Access to notary customer management"},{key:"offersManagementAccess",label:"YABA Offers Management",description:"Access to manage YABA shipping offers configurations"},{key:"isAdmin",label:"Administrator",description:"Full system administration rights"}];let G={businessId:"YB100423253156428",stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_2376:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1,YY_3303:!1,YY_3329:!1,SS_42:!1},statusLocationPermissions:Object.fromEntries(E.map(t=>[t.id,!1])),permissions:{AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,EmployeeAccess:!1,JournalAccess:!1,invoiceAccess:!1,PurchaseRequestAccess:!1,RemittanceAccess:!1,HBLAccess:!1,PassportAccess:!1,AdminPassportAccess:!1,HBLAccessManagement:!1,HBLScannerAccess:!1,NotaryAccess:!1,offersManagementAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1,isAdmin:!1}};const ce=async()=>{try{const t=Z(W,"businesses"),o=X(t,ee("name")),g=await se(o),m=[];g.forEach(i=>{const n=i.data();n.isActive&&m.push({id:i.id,name:n.name})});const e=[{id:"SS695841584167881",name:"Stephanie S"},{id:"YB100423253156428",name:"YABA"},{id:"JJCM23753J15918M",name:"GUANCHO"},{id:"LMR470531564CT28",name:"LUISCUETO"}];for(const i of e)m.find(n=>n.id===i.id)||m.push(i);J(m)}catch(t){console.error("Error loading businesses:",t),J([{id:"SS695841584167881",name:"Stephanie S"},{id:"YB100423253156428",name:"YABA"},{id:"JJCM23753J15918M",name:"GUANCHO"},{id:"LMR470531564CT28",name:"LUISCUETO"}])}};Be(async()=>{await de(),await ce(),await ae()});const de=async()=>{try{R(!0),console.log("üì• Loading users via API...");const t=await Q.getAll();console.log(`‚úÖ Received ${t.length} users from API`);const o=t.map(g=>{let m={uid:g.uid,...g};return Object.keys(G).forEach(e=>{m.hasOwnProperty(e)||(m[e]=G[e])}),m});console.log(`‚úÖ Loaded and normalized ${o.length} users`),console.log(o),H(o)}catch(t){console.error("‚ùå Error loading users:",t),x({type:"error",text:"Failed to load users from server"})}finally{R(!1)}},me=O(()=>{const t=z().toLowerCase();return t?T().filter(o=>o.email?.toLowerCase().includes(t)||o.displayName?.toLowerCase().includes(t)||o.uid?.toLowerCase().includes(t)):T()}),pe=t=>{s()&&h(o=>({...o,stores:{...o.stores,[t]:!o.stores[t]}}))},ye=t=>{s()&&h(o=>({...o,businessId:t}))},ue=t=>{s()&&h(o=>({...o,permissions:{...o.permissions,[t]:!o.permissions?.[t]}}))},Ae=t=>{s()&&h(o=>({...o,statusLocationPermissions:{...o.statusLocationPermissions,[t]:!o.statusLocationPermissions?.[t]}}))};O(()=>s()?s().stores&&Object.values(s().stores).some(t=>t):!1);const ge=async()=>{if(s())try{D(!0),x(null),console.log("üíæ Saving user permissions via API..."),console.log("üîÑ Using API endpoint (NOT Firebase directly)");const t={permissions:{AccountAccess:s().permissions?.AccountAccess||!1,BankingAccess:s().permissions?.BankingAccess||!1,InventoryAccess:s().permissions?.InventoryAccess||!1,EmployeeAccess:s().permissions?.EmployeeAccess||!1,invoiceAccess:s().permissions?.invoiceAccess||!1,JournalAccess:s().permissions?.JournalAccess||!1,PassportAccess:s().permissions?.PassportAccess||!1,inventoryDownsection:s().permissions?.inventoryDownsection||!1,PurchaseRequestAccess:s().permissions?.PurchaseRequestAccess||!1,onlyRead:s().permissions?.onlyRead||!1,AdminPassportAccess:s().permissions?.AdminPassportAccess||!1,HBLAccessManagement:s().permissions?.HBLAccessManagement||!1,HBLScannerAccess:s().permissions?.HBLScannerAccess||!1,HBLAccess:s().permissions?.HBLAccess||!1,NotaryAccess:s().permissions?.NotaryAccess||!1,RemittanceAccess:s().permissions?.RemittanceAccess||!1,offersManagementAccess:s().permissions?.offersManagementAccess||!1,AppointmentAccess:s().permissions?.AppointmentAccess||!1,read_write:s().permissions?.read_write||!1,isAdmin:s().permissions?.isAdmin||!1},stores:s().stores,statusLocationPermissions:s().statusLocationPermissions||Object.fromEntries(E.map(g=>[g.id,!1])),businessId:s().businessId,businessIds:s().businessIds||[]};let o=s().id||s().uid;console.log("üì° Calling usersApi.updatePermissions (API endpoint)..."),await Q.updatePermissions(o,t),console.log("‚úÖ API call completed successfully (no direct Firebase update)"),H(g=>g.map(m=>m.uid===s().uid?s():m)),console.log("‚úÖ User permissions saved successfully via API"),x({type:"success",text:"User profile updated successfully via API (not direct Firebase)"})}catch(t){console.error("‚ùå Error saving user profile via API:",t),x({type:"error",text:"Failed to save user profile via API endpoint"})}finally{D(!1)}},fe={display:"grid","grid-template-columns":"350px 1fr",gap:"2rem",height:"calc(100vh - 200px)"},ve={"max-height":"100%","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)",background:"var(--surface-color)"},be=t=>({padding:"1rem","border-bottom":"1px solid var(--border-color)",cursor:"pointer",background:t?"var(--primary-color-light)":"transparent",transition:"background 0.2s"}),Ye={padding:"0.75rem",border:"none","border-bottom":"1px solid var(--border-color)",background:"var(--surface-color)",width:"100%","font-size":"1rem"},Pe={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1rem"},K={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(200px, 1fr))",gap:"0.75rem"},k={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",transition:"all 0.2s"},_e=t=>({padding:"1rem","margin-bottom":"1rem","border-radius":"var(--border-radius)",background:t==="success"?"#d4edda":"#f8d7da",color:t==="success"?"#155724":"#721c24",border:`1px solid ${t==="success"?"#c3e6cb":"#f5c6cb"}`}),he=O(()=>xe.state.profile?.isAdmin===!0);return y(Ie,{title:"User Profile Administration",get children(){return y(I,{get when(){return he()},get fallback(){return y(U,{get children(){var t=Ue();return t.style.setProperty("text-align","center"),t.style.setProperty("padding","2rem"),t.style.setProperty("color","var(--text-muted)"),t}})},get children(){var t=Oe(),o=t.firstChild,g=o.firstChild,m=o.nextSibling;return Y(t,fe),Y(o,ve),g.$$input=e=>ne(e.currentTarget.value),Y(g,Ye),l(o,y(I,{get when(){return!ie()},get fallback(){return(()=>{var e=Me();return e.style.setProperty("padding","2rem"),e.style.setProperty("text-align","center"),e})()},get children(){return y($,{get each(){return me()},children:e=>(()=>{var i=Te(),n=i.firstChild,a=n.nextSibling,r=a.nextSibling,p=r.firstChild;return i.$$click=()=>{console.log(e),h(e)},n.style.setProperty("font-weight","600"),l(n,()=>e.displayName||"No Name"),a.style.setProperty("font-size","0.875rem"),a.style.setProperty("color","var(--text-muted)"),l(a,()=>e.email),r.style.setProperty("font-size","0.75rem"),r.style.setProperty("color","var(--text-muted)"),r.style.setProperty("margin-top","0.25rem"),l(r,()=>e.permissions?.isAdmin&&"üëë Admin ‚Ä¢ ",p),l(r,()=>Object.values(e.stores||{}).filter(Boolean).length,p),A(c=>Y(i,be(s()?.uid===e.uid),c)),i})()})}}),null),l(m,y(I,{get when(){return s()},get fallback(){return y(U,{get children(){var e=He();return e.style.setProperty("text-align","center"),e.style.setProperty("padding","2rem"),e.style.setProperty("color","var(--text-muted)"),e}})},get children(){return[y(I,{get when(){return L()},get children(){var e=te();return l(e,()=>L().text),A(i=>Y(e,_e(L().type),i)),e}}),y(U,{title:"User Information",get subtitle(){return s().email},get children(){return[(()=>{var e=ke(),i=e.firstChild,n=i.firstChild,a=n.firstChild;a.nextSibling;var r=n.nextSibling,p=r.firstChild;p.nextSibling;var c=i.nextSibling,d=c.firstChild;return d.nextSibling,e.style.setProperty("margin-bottom","2rem"),i.style.setProperty("display","flex"),i.style.setProperty("justify-content","space-between"),i.style.setProperty("margin-bottom","1rem"),l(n,()=>s().displayName||"Not set",null),l(r,()=>s().uid,null),l(c,()=>new Date(s().createdAt?.toDate?.()||s().createdAt).toLocaleDateString(),null),e})(),(()=>{var e=Ce(),i=e.firstChild,n=i.nextSibling,a=n.nextSibling;return e.style.setProperty("margin-bottom","2rem"),i.style.setProperty("margin-bottom","1rem"),l(n,y($,{get each(){return oe()},children:r=>(()=>{var p=M(),c=p.firstChild,d=c.nextSibling;return p.$$click=()=>pe(r?.id),c.style.setProperty("cursor","pointer"),d.style.setProperty("cursor","pointer"),d.style.setProperty("user-select","none"),l(d,()=>r?.name),A(u=>Y(p,{...k,background:s().stores?.[r?.id]?"var(--primary-color-light)":"transparent"},u)),A(()=>c.checked=s().stores?.[r?.id]||!1),p})()})),a.style.setProperty("margin-top","0.5rem"),a.style.setProperty("font-size","0.875rem"),a.style.setProperty("color","var(--text-muted)"),A(r=>Y(n,K,r)),e})(),(()=>{var e=we(),i=e.firstChild,n=i.nextSibling,a=n.firstChild,r=a.nextSibling,p=r.firstChild,c=n.nextSibling,d=c.firstChild,u=d.nextSibling,P=u.nextSibling;return e.style.setProperty("margin-bottom","2rem"),i.style.setProperty("margin-bottom","1rem"),n.style.setProperty("margin-bottom","1rem"),a.style.setProperty("display","block"),a.style.setProperty("margin-bottom","0.5rem"),a.style.setProperty("font-weight","500"),r.addEventListener("change",b=>ye(b.currentTarget.value)),r.style.setProperty("width","100%"),r.style.setProperty("padding","0.5rem"),r.style.setProperty("border","1px solid var(--border-color)"),r.style.setProperty("border-radius","var(--border-radius-sm)"),r.style.setProperty("background","var(--surface-color)"),l(p,()=>re("common.all","All")),l(r,y($,{get each(){return q()},children:b=>(()=>{var S=Re();return l(S,()=>b.name),A(()=>S.value=b.id),S})()}),null),d.style.setProperty("display","block"),d.style.setProperty("margin-bottom","0.5rem"),d.style.setProperty("font-weight","500"),u.style.setProperty("display","grid"),u.style.setProperty("grid-template-columns","repeat(auto-fill, minmax(200px, 1fr))"),u.style.setProperty("gap","0.75rem"),l(u,y($,{get each(){return q()},children:b=>{const S=()=>(s()?.businessIds||[]).includes(b.id)||s()?.businessId===b.id;return(()=>{var f=M(),C=f.firstChild,w=C.nextSibling;return f.$$click=()=>{if(!s())return;const B=s().businessIds||[],Se=S()?B.filter(N=>N!==b.id):[...B,b.id];h(N=>({...N,businessIds:Se}))},f.style.setProperty("display","flex"),f.style.setProperty("align-items","center"),f.style.setProperty("gap","0.5rem"),f.style.setProperty("padding","0.5rem"),f.style.setProperty("border","1px solid var(--border-color)"),f.style.setProperty("border-radius","var(--border-radius-sm)"),f.style.setProperty("cursor","pointer"),f.style.setProperty("transition","all 0.2s"),C.style.setProperty("cursor","pointer"),w.style.setProperty("cursor","pointer"),w.style.setProperty("user-select","none"),l(w,()=>b.name),A(B=>(B=S()?"var(--primary-color-light)":"transparent")!=null?f.style.setProperty("background",B):f.style.removeProperty("background")),A(()=>C.checked=S()),f})()}})),P.style.setProperty("margin-top","0.5rem"),P.style.setProperty("font-size","0.875rem"),P.style.setProperty("color","var(--text-muted)"),A(()=>r.value=s()?.businessId),e})(),(()=>{var e=Ne(),i=e.firstChild,n=i.nextSibling;return e.style.setProperty("margin-bottom","2rem"),i.style.setProperty("margin-bottom","1rem"),Y(n,Pe),l(n,y($,{each:le,children:a=>(()=>{var r=Fe(),p=r.firstChild,c=p.nextSibling,d=c.firstChild,u=d.nextSibling;return r.$$click=()=>ue(a.key),p.style.setProperty("cursor","pointer"),c.style.setProperty("flex","1"),c.style.setProperty("cursor","pointer"),c.style.setProperty("user-select","none"),d.style.setProperty("font-weight","500"),l(d,()=>a.label),u.style.setProperty("font-size","0.75rem"),u.style.setProperty("color","var(--text-muted)"),l(u,()=>a.description),A(P=>Y(r,{...k,background:s()?.permissions?.[a.key]?"var(--primary-color-light)":"transparent"},P)),A(()=>p.checked=!!s()?.permissions?.[a.key]),r})()})),e})(),(()=>{var e=Ee(),i=e.firstChild,n=i.nextSibling,a=n.nextSibling,r=a.nextSibling,p=r.firstChild;return e.style.setProperty("margin-bottom","2rem"),i.style.setProperty("margin-bottom","1rem"),n.style.setProperty("font-size","0.875rem"),n.style.setProperty("color","var(--text-muted)"),n.style.setProperty("margin-bottom","1rem"),l(a,y($,{each:E,children:c=>(()=>{var d=M(),u=d.firstChild,P=u.nextSibling;return d.$$click=()=>Ae(c.id),u.style.setProperty("cursor","pointer"),P.style.setProperty("cursor","pointer"),P.style.setProperty("user-select","none"),P.style.setProperty("font-size","0.875rem"),l(P,()=>c.label),A(b=>Y(d,{...k,background:s().statusLocationPermissions?.[c.id]?"var(--primary-color-light)":"transparent"},b)),A(()=>u.checked=!!s().statusLocationPermissions?.[c.id]),d})()})),r.style.setProperty("margin-top","0.5rem"),r.style.setProperty("font-size","0.875rem"),r.style.setProperty("color","var(--text-muted)"),l(r,()=>Object.values(s().statusLocationPermissions||{}).filter(Boolean).length,p),A(c=>Y(a,K,c)),e})(),(()=>{var e=te();return e.style.setProperty("display","flex"),e.style.setProperty("gap","1rem"),e.style.setProperty("justify-content","flex-end"),l(e,y(V,{variant:"secondary",onClick:()=>h(null),children:"Cancel"}),null),l(e,y(V,{variant:"primary",onClick:ge,get disabled(){return F()},get children(){return F()?"Saving...":"Save Changes"}}),null),e})()]}})]}})),A(()=>g.value=z()),t}})}})};Le(["input","click"]);export{ze as default};
