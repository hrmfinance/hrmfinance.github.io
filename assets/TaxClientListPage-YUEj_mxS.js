import{E as ke,c as b,A as Le,t as h,h as o,i as a,a as d,B as z,r as k,b as L,F,S as T,v as I,M as Te,d as ze}from"./index-DsjFW37z.js";import{j as De,l as Ee}from"./taxPortalApi-BeYQIJCF.js";import"./drakeTypes-DcjcYEfx.js";var Ye=h("<div><div>Loading clients..."),Ae=h("<div><div></div><div></div><div>"),M=h("<div>"),Fe=h("<div><label>Tax Year</label><div>"),Ie=h("<div><div><div><h1>Tax Clients</h1><p>Manage your tax clients and their documents</p></div></div><div><div></div><div>"),K=h("<button>"),Me=h("<span>"),Be=h("<div><div></div><div><div><span> </span></div><div><span></span></div><div>/<!> docs</div><div>Last activity: ");const Ue=()=>{const B=ke(),[q,j]=b([]),[D,R]=b(!0),[w,Q]=b(""),[v,V]=b("all"),[X,$]=b(!1),[m,C]=b({firstName:"",lastName:"",email:"",phone:"",taxYear:2024}),[U,G]=b(!1);Le(async()=>{R(!0);try{const l=(await De()).map(n=>({...n,status:Z(n),lastActivity:n.updatedAt||n.createdAt,requiredDocs:8}));j(l)}catch(e){console.error("Error loading tax clients:",e)}finally{R(!1)}});const Z=e=>{const l=e.documentCount||0,n=e.verifiedDocumentCount||0,u=8;return n>=u?"complete":l>=u?"ready":l>0?"in_progress":"needs_docs"},E=()=>{let e=q();const l=w().toLowerCase().trim();return l&&(e=e.filter(n=>n.firstName.toLowerCase().includes(l)||n.lastName.toLowerCase().includes(l)||n.email?.toLowerCase().includes(l)||n.phone?.includes(l))),v()!=="all"&&(e=e.filter(n=>n.status===v())),e},ee=async()=>{const e=m();if(!(!e.firstName.trim()||!e.lastName.trim())){G(!0);try{const l=await Ee({firstName:e.firstName.trim(),lastName:e.lastName.trim(),email:e.email.trim(),phone:e.phone.trim(),taxYear:e.taxYear}),n={...l,status:"needs_docs",lastActivity:Date.now(),requiredDocs:8};j([n,...q()]),$(!1),C({firstName:"",lastName:"",email:"",phone:"",taxYear:2024}),B(`/accounting/tax-client/${l.id}`)}catch(l){console.error("Error creating client:",l),alert("Error creating client. Please try again.")}finally{G(!1)}}},te=e=>{B(`/accounting/tax-client/${e}`)},re=(e,l)=>`${e.charAt(0)}${l.charAt(0)}`.toUpperCase(),_=e=>{switch(e){case"complete":return"#22c55e";case"ready":return"#3b82f6";case"in_progress":return"#f59e0b";case"needs_docs":return"#ef4444";default:return"#6b7280"}},ae=e=>{switch(e){case"complete":return"Complete";case"ready":return"Ready";case"in_progress":return"In Progress";case"needs_docs":return"Needs Docs";default:return"Unknown"}},le=e=>{if(!e)return"No activity";const n=Date.now()-e,u=Math.floor(n/(1e3*60*60*24)),x=Math.floor(n/(1e3*60*60)),S=Math.floor(n/(1e3*60));return u>30?new Date(e).toLocaleDateString():u>0?`${u} day${u>1?"s":""} ago`:x>0?`${x} hour${x>1?"s":""} ago`:S>0?`${S} min ago`:"Just now"},ne=[{value:"all",label:"All",color:"#6b7280"},{value:"needs_docs",label:"Needs Docs",color:"#ef4444"},{value:"in_progress",label:"In Progress",color:"#f59e0b"},{value:"ready",label:"Ready",color:"#3b82f6"},{value:"complete",label:"Complete",color:"#22c55e"}],oe={padding:"1.5rem","max-width":"1400px",margin:"0 auto","min-height":"100vh",background:"var(--background-color)"},se={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1.5rem","flex-wrap":"wrap",gap:"1rem"},ie={display:"flex",gap:"1rem","margin-bottom":"1.5rem","flex-wrap":"wrap","align-items":"center"},de={flex:"1","min-width":"250px","max-width":"400px"},ce={display:"flex",gap:"0.5rem","flex-wrap":"wrap"},me=(e,l)=>({padding:"0.5rem 1rem",border:`1px solid ${e?l:"var(--border-color)"}`,"border-radius":"9999px",background:e?l:"transparent",color:e?"white":"var(--text-primary)",cursor:"pointer","font-size":"0.875rem","font-weight":"500",transition:"all 0.2s","white-space":"nowrap"}),ue={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(320px, 1fr))",gap:"1rem"},pe={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-md)",padding:"1.25rem",cursor:"pointer",transition:"all 0.2s ease",display:"flex",gap:"1rem","align-items":"flex-start"},ye=e=>({width:"48px",height:"48px","min-width":"48px","border-radius":"50%",background:`linear-gradient(135deg, ${_(e)}, ${_(e)}dd)`,color:"white",display:"flex","align-items":"center","justify-content":"center","font-weight":"600","font-size":"1rem"}),ge={flex:"1","min-width":"0"},fe={"font-weight":"600","font-size":"1rem",color:"var(--text-primary)",margin:"0 0 0.25rem 0",display:"flex","align-items":"center",gap:"0.5rem","flex-wrap":"wrap"},he={background:"var(--primary-color)",color:"white",padding:"0.125rem 0.5rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500"},ve=e=>({display:"inline-flex","align-items":"center",gap:"0.25rem",padding:"0.25rem 0.5rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500",background:`${_(e)}20`,color:_(e)}),xe=e=>({width:"8px",height:"8px","border-radius":"50%",background:_(e)}),be={"font-size":"0.875rem",color:"var(--text-muted)","margin-top":"0.5rem"},we={"font-size":"0.75rem",color:"var(--text-muted)","margin-top":"0.25rem"},J={"text-align":"center",padding:"4rem 2rem",color:"var(--text-muted)"},Ce={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},$e={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"1.5rem"};return(()=>{var e=Ie(),l=e.firstChild,n=l.firstChild,u=n.firstChild,x=u.nextSibling,S=l.nextSibling,Y=S.firstChild,O=Y.nextSibling;return o(e,oe),o(l,se),u.style.setProperty("font-size","1.75rem"),u.style.setProperty("font-weight","700"),u.style.setProperty("margin","0 0 0.25rem 0"),u.style.setProperty("color","var(--text-primary)"),x.style.setProperty("color","var(--text-muted)"),x.style.setProperty("margin","0"),x.style.setProperty("font-size","0.875rem"),a(l,d(z,{onClick:()=>$(!0),children:"+ New Client"}),null),o(S,ie),o(Y,de),a(Y,d(k,{label:"",placeholder:"Search clients by name, email, or phone...",get value(){return w()},onChange:r=>Q(r)})),o(O,ce),a(O,d(F,{each:ne,children:r=>(()=>{var t=K();return t.$$click=()=>V(r.value),a(t,()=>r.label),L(s=>o(t,me(v()===r.value,r.color),s)),t})()})),a(e,d(T,{get when(){return D()},get children(){var r=Ye(),t=r.firstChild;return t.style.setProperty("font-size","1.25rem"),t.style.setProperty("margin-bottom","0.5rem"),L(s=>o(r,J,s)),r}}),null),a(e,d(T,{get when(){return I(()=>!D())()&&E().length===0},get children(){var r=Ae(),t=r.firstChild,s=t.nextSibling,p=s.nextSibling;return t.style.setProperty("font-size","3rem"),t.style.setProperty("margin-bottom","1rem"),t.style.setProperty("opacity","0.5"),a(t,()=>w()||v()!=="all"?"(no results)":"(empty)"),s.style.setProperty("font-size","1.25rem"),s.style.setProperty("margin-bottom","0.5rem"),a(s,()=>w()||v()!=="all"?"No clients match your search criteria":"No tax clients yet"),p.style.setProperty("margin-bottom","1.5rem"),a(p,()=>w()||v()!=="all"?"Try adjusting your filters or search term":"Add your first client to get started"),a(r,d(T,{get when(){return I(()=>!w())()&&v()==="all"},get children(){return d(z,{onClick:()=>$(!0),children:"+ Add First Client"})}}),null),L(i=>o(r,J,i)),r}}),null),a(e,d(T,{get when(){return I(()=>!D())()&&E().length>0},get children(){var r=M();return o(r,ue),a(r,d(F,{get each(){return E()},children:t=>(()=>{var s=Be(),p=s.firstChild,i=p.nextSibling,y=i.firstChild,g=y.firstChild,P=g.firstChild,f=y.nextSibling,_e=f.firstChild,N=f.nextSibling,W=N.firstChild,H=W.nextSibling;H.nextSibling;var A=N.nextSibling;return A.firstChild,s.addEventListener("mouseleave",c=>{c.currentTarget.style.boxShadow="none",c.currentTarget.style.borderColor="var(--border-color)"}),s.addEventListener("mouseenter",c=>{c.currentTarget.style.boxShadow="var(--shadow-md)",c.currentTarget.style.borderColor="var(--primary-color)"}),s.$$click=()=>te(t.id),o(s,pe),a(p,()=>re(t.firstName,t.lastName)),o(i,ge),o(y,fe),g.style.setProperty("overflow","hidden"),g.style.setProperty("text-overflow","ellipsis"),g.style.setProperty("white-space","nowrap"),a(g,()=>t.firstName,P),a(g,()=>t.lastName,null),a(y,d(T,{get when(){return t.taxYear},get children(){var c=Me();return o(c,he),a(c,()=>t.taxYear),c}}),null),a(f,()=>ae(t.status),null),o(N,be),a(N,()=>t.documentCount||0,W),a(N,()=>t.requiredDocs||8,H),o(A,we),a(A,()=>le(t.lastActivity),null),L(c=>{var Se=ye(t.status),Pe=ve(t.status),Ne=xe(t.status);return c.e=o(p,Se,c.e),c.t=o(f,Pe,c.t),c.a=o(_e,Ne,c.a),c},{e:void 0,t:void 0,a:void 0}),s})()})),r}}),null),a(e,d(Te,{get isOpen(){return X()},onClose:()=>$(!1),title:"New Tax Client",maxWidth:"500px",get children(){return[(()=>{var r=M();return o(r,Ce),a(r,d(k,{label:"First Name",get value(){return m().firstName},onChange:t=>C({...m(),firstName:t}),required:!0,placeholder:"Enter first name"}),null),a(r,d(k,{label:"Last Name",get value(){return m().lastName},onChange:t=>C({...m(),lastName:t}),required:!0,placeholder:"Enter last name"}),null),a(r,d(k,{label:"Email",type:"email",get value(){return m().email},onChange:t=>C({...m(),email:t}),placeholder:"client@email.com"}),null),a(r,d(k,{label:"Phone",type:"tel",get value(){return m().phone},onChange:t=>C({...m(),phone:t}),placeholder:"(555) 123-4567"}),null),r})(),(()=>{var r=Fe(),t=r.firstChild,s=t.nextSibling;return r.style.setProperty("margin-top","1rem"),t.style.setProperty("display","block"),t.style.setProperty("font-weight","500"),t.style.setProperty("margin-bottom","0.5rem"),t.style.setProperty("color","var(--text-primary)"),s.style.setProperty("display","flex"),s.style.setProperty("gap","0.5rem"),a(s,d(F,{each:[2024,2025],children:p=>(()=>{var i=K();return i.$$click=()=>C({...m(),taxYear:p}),i.style.setProperty("padding","0.75rem 1.5rem"),i.style.setProperty("border-radius","var(--border-radius-md)"),i.style.setProperty("cursor","pointer"),i.style.setProperty("font-weight","600"),i.style.setProperty("transition","all 0.2s"),a(i,p),L(y=>{var g=`2px solid ${m().taxYear===p?"var(--primary-color)":"var(--border-color)"}`,P=m().taxYear===p?"var(--primary-color)":"transparent",f=m().taxYear===p?"white":"var(--text-primary)";return g!==y.e&&((y.e=g)!=null?i.style.setProperty("border",g):i.style.removeProperty("border")),P!==y.t&&((y.t=P)!=null?i.style.setProperty("background",P):i.style.removeProperty("background")),f!==y.a&&((y.a=f)!=null?i.style.setProperty("color",f):i.style.removeProperty("color")),y},{e:void 0,t:void 0,a:void 0}),i})()})),r})(),(()=>{var r=M();return o(r,$e),a(r,d(z,{variant:"secondary",onClick:()=>$(!1),children:"Cancel"}),null),a(r,d(z,{onClick:ee,get disabled(){return!m().firstName.trim()||!m().lastName.trim()||U()},get children(){return U()?"Creating...":"Create Client"}}),null),r})()]}}),null),e})()};ze(["click"]);export{Ue as default};
