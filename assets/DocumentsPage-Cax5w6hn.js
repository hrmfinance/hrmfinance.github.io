import{u as Fe,c as X,o as Ie,f as Te,t as D,i as e,a as v,B as de,F as ce,v as Y,S as k,b as R,h as c,M as Le,d as Me}from"./index-CPuBG4SZ.js";import{a as Z}from"./accountingStore-Bj4kQi2h.js";var Ne=D("<div><h3></h3><div>"),je=D("<div><div>"),qe=D("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),Be=D("<div><div><h1></h1><p></p></div><div><div>ðŸ“„</div><p></p><label><input type=file multiple accept=.pdf,.png,.jpg,.jpeg></label><p></p></div><div><select><option value=all></option><option value=pending></option><option value=processing></option><option value=completed></option><option value=failed>"),Ue=D("<span>"),Ge=D("<div><div><span></span><div><div></div><div>"),Je=D("<tr><td colspan=6>"),Oe=D("<tr><td><div><span>ðŸ“„</span><span></span></div></td><td></td><td></td><td><span></span></td><td></td><td><button>"),ye=D("<div><span></span><div>"),Re=D("<div><h4></h4><div><div><span></span><div>"),Ve=D("<div><h4></h4><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody>"),We=D("<div><div><div><h4></h4><div><div><span></span><div></div></div><div><span></span><div></div></div><div><span></span><div><span></span></div></div></div></div></div><div>"),He=D("<tr><td></td><td></td><td>");const Xe=()=>{const{t:r}=Fe(),[ue,Se]=X(!0),[pe,se]=X(!1),[ge,W]=X([]),[ne,le]=X(null),[ie,Ce]=X("all");Ie(async()=>{try{await Z.loadDocuments()}finally{Se(!1)}});const De=Te(()=>{let n=Z.documents;return ie()!=="all"&&(n=n.filter(w=>w.processingStatus===ie())),n.sort((w,h)=>new Date(h.createdAt).getTime()-new Date(w.createdAt).getTime())}),me={pending:r("accounting.pending","Pendiente"),processing:r("accounting.processing","Procesando"),completed:r("accounting.completed","Completado"),failed:r("accounting.failed","Fallido")},ee={pending:{bg:"#e5e7eb",color:"#6b7280"},processing:{bg:"#dbeafe",color:"#2563eb"},completed:{bg:"#d1fae5",color:"#059669"},failed:{bg:"#fee2e2",color:"#dc2626"}},ve=async n=>{for(const w of Array.from(n)){const h=Date.now().toString()+Math.random().toString(36).substr(2,9);W($=>[...$,{id:h,name:w.name,status:"uploading",progress:0}]);try{W(l=>l.map(i=>i.id===h?{...i,progress:50}:i));const $=await Z.uploadDocument(w);W(l=>l.map(i=>i.id===h?{...i,status:"processing",progress:100,result:$}:i)),we(h,$.id)}catch($){W(l=>l.map(i=>i.id===h?{...i,status:"failed",error:$.message}:i))}}},we=async(n,w)=>{const h=async()=>{try{const $=Z.getDocumentById(w);$?.processingStatus==="completed"?(W(l=>l.map(i=>i.id===n?{...i,status:"completed",result:$}:i)),await Z.loadDocuments()):$?.processingStatus==="failed"?W(l=>l.map(i=>i.id===n?{...i,status:"failed",error:"Procesamiento fallÃ³"}:i)):setTimeout(h,2e3)}catch{setTimeout(h,2e3)}};setTimeout(h,2e3)},Ee=n=>{n.preventDefault(),se(!1),n.dataTransfer?.files&&ve(n.dataTransfer.files)},he=n=>new Date(n).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),K=n=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(n),Pe={width:"100%","border-collapse":"collapse"},M={"text-align":"left",padding:"0.75rem","border-bottom":"2px solid var(--border-color)","font-weight":"600",color:"var(--text-muted)","font-size":"0.875rem"},F={padding:"0.75rem","border-bottom":"1px solid var(--border-color)"};return(()=>{var n=Be(),w=n.firstChild,h=w.firstChild,$=h.nextSibling,l=w.nextSibling,i=l.firstChild,te=i.nextSibling,re=te.nextSibling,fe=re.firstChild,oe=re.nextSibling,Q=l.nextSibling,G=Q.firstChild,be=G.firstChild,xe=be.nextSibling,$e=xe.nextSibling,_e=$e.nextSibling,Ae=_e.nextSibling;return n.style.setProperty("padding","1.5rem"),w.style.setProperty("margin-bottom","1.5rem"),h.style.setProperty("font-size","1.5rem"),h.style.setProperty("font-weight","700"),h.style.setProperty("margin-bottom","0.25rem"),e(h,()=>r("accounting.documents","Documentos")),$.style.setProperty("color","var(--text-muted)"),$.style.setProperty("font-size","0.875rem"),e($,()=>r("accounting.uploadProcessAI","Sube documentos para procesarlos con AI")),l.addEventListener("drop",Ee),l.addEventListener("dragleave",()=>se(!1)),l.addEventListener("dragover",t=>{t.preventDefault(),se(!0)}),l.style.setProperty("border-radius","var(--border-radius-md)"),l.style.setProperty("padding","2rem"),l.style.setProperty("text-align","center"),l.style.setProperty("margin-bottom","1.5rem"),l.style.setProperty("transition","all 0.2s"),i.style.setProperty("font-size","3rem"),i.style.setProperty("margin-bottom","1rem"),te.style.setProperty("color","var(--text-primary)"),te.style.setProperty("margin-bottom","0.5rem"),e(te,()=>r("accounting.dragDropFiles","Arrastra documentos aquÃ­ o")),re.style.setProperty("display","inline-block"),fe.addEventListener("change",t=>t.target.files&&ve(t.target.files)),fe.style.setProperty("display","none"),e(re,v(de,{as:"span",variant:"primary",get children(){return r("accounting.selectFiles","Seleccionar archivos")}}),null),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),oe.style.setProperty("margin-top","0.75rem"),e(oe,()=>r("accounting.supportedFormats","PDF, PNG, JPG - Facturas, recibos, estados de cuenta")),e(n,v(k,{get when(){return ge().length>0},get children(){var t=Ne(),P=t.firstChild,y=P.nextSibling;return t.style.setProperty("background","var(--surface-color)"),t.style.setProperty("border","1px solid var(--border-color)"),t.style.setProperty("border-radius","var(--border-radius-md)"),t.style.setProperty("padding","1rem"),t.style.setProperty("margin-bottom","1.5rem"),P.style.setProperty("font-weight","600"),P.style.setProperty("margin-bottom","1rem"),e(P,()=>r("accounting.processingWithAI","Procesando con AI")),y.style.setProperty("display","flex"),y.style.setProperty("flex-direction","column"),y.style.setProperty("gap","0.75rem"),e(y,v(ce,{get each(){return ge()},children:f=>(()=>{var p=Ge(),_=p.firstChild,S=_.firstChild,I=S.nextSibling,N=I.firstChild,A=N.nextSibling;return p.style.setProperty("display","flex"),p.style.setProperty("align-items","center"),p.style.setProperty("justify-content","space-between"),p.style.setProperty("padding","0.75rem"),p.style.setProperty("background","var(--surface-secondary)"),p.style.setProperty("border-radius","var(--border-radius-sm)"),_.style.setProperty("display","flex"),_.style.setProperty("align-items","center"),_.style.setProperty("gap","0.75rem"),S.style.setProperty("font-size","1.5rem"),e(S,()=>f.status==="uploading"&&"â³",null),e(S,()=>f.status==="processing"&&"ðŸ¤–",null),e(S,()=>f.status==="completed"&&"âœ…",null),e(S,()=>f.status==="failed"&&"âŒ",null),N.style.setProperty("font-weight","500"),e(N,()=>f.name),A.style.setProperty("font-size","0.75rem"),A.style.setProperty("color","var(--text-muted)"),e(A,(()=>{var a=Y(()=>f.status==="uploading");return()=>a()&&r("accounting.uploading","Subiendo...")})(),null),e(A,(()=>{var a=Y(()=>f.status==="processing");return()=>a()&&r("accounting.processingAI","Procesando con AI...")})(),null),e(A,(()=>{var a=Y(()=>f.status==="completed");return()=>a()&&r("accounting.completed","Completado")})(),null),e(A,()=>f.status==="failed"&&f.error,null),e(p,v(k,{get when(){return f.status==="completed"&&f.result?.aiExtractedData},get children(){var a=Ue();return a.style.setProperty("padding","0.25rem 0.75rem"),a.style.setProperty("border-radius","9999px"),a.style.setProperty("font-size","0.875rem"),a.style.setProperty("font-weight","500"),a.style.setProperty("background","#d1fae5"),a.style.setProperty("color","#059669"),e(a,()=>K(f.result.aiExtractedData.totalAmount||0)),a}}),null),p})()})),t}}),Q),Q.style.setProperty("display","flex"),Q.style.setProperty("gap","1rem"),Q.style.setProperty("margin-bottom","1rem"),G.addEventListener("change",t=>Ce(t.currentTarget.value)),G.style.setProperty("padding","0.5rem 1rem"),G.style.setProperty("border","1px solid var(--border-color)"),G.style.setProperty("border-radius","var(--border-radius-sm)"),G.style.setProperty("font-size","0.875rem"),G.style.setProperty("background","var(--surface-color)"),e(be,()=>r("accounting.allStatuses","Todos los estados")),e(xe,()=>r("accounting.pending","Pendiente")),e($e,()=>r("accounting.processing","Procesando")),e(_e,()=>r("accounting.completed","Completado")),e(Ae,()=>r("accounting.failed","Fallido")),e(n,v(k,{get when(){return ue()},get children(){var t=je(),P=t.firstChild;return t.style.setProperty("text-align","center"),t.style.setProperty("padding","3rem"),e(P,()=>r("common.loading","Cargando...")),t}}),null),e(n,v(k,{get when(){return!ue()},get children(){var t=qe(),P=t.firstChild,y=P.firstChild,f=y.firstChild,p=f.firstChild,_=p.nextSibling,S=_.nextSibling,I=S.nextSibling,N=I.nextSibling,A=N.nextSibling,a=y.nextSibling;return t.style.setProperty("background","var(--surface-color)"),t.style.setProperty("border","1px solid var(--border-color)"),t.style.setProperty("border-radius","var(--border-radius-md)"),t.style.setProperty("overflow","hidden"),e(p,()=>r("accounting.fileName","Archivo")),e(_,()=>r("accounting.type","Tipo")),e(S,()=>r("accounting.date","Fecha")),e(I,()=>r("accounting.status","Estado")),e(N,()=>r("accounting.extractedAmount","Monto")),e(a,v(ce,{get each(){return De()},get fallback(){return(()=>{var s=Je(),j=s.firstChild;return e(j,()=>r("accounting.noDocuments","No hay documentos")),R(E=>c(j,{...F,"text-align":"center",color:"var(--text-muted)",padding:"2rem"},E)),s})()},children:s=>(()=>{var j=Oe(),E=j.firstChild,J=E.firstChild,C=J.firstChild,T=C.nextSibling,g=E.nextSibling,u=g.nextSibling,m=u.nextSibling,b=m.firstChild,L=m.nextSibling,z=L.nextSibling,d=z.firstChild;return J.style.setProperty("display","flex"),J.style.setProperty("align-items","center"),J.style.setProperty("gap","0.5rem"),e(T,()=>s.fileName),e(g,()=>s.documentType||"-"),e(u,()=>he(s.createdAt)),b.style.setProperty("padding","0.25rem 0.75rem"),b.style.setProperty("border-radius","9999px"),b.style.setProperty("font-size","0.75rem"),b.style.setProperty("font-weight","500"),e(b,()=>me[s.processingStatus]),e(L,(()=>{var o=Y(()=>!!s.aiExtractedData?.totalAmount);return()=>o()?K(s.aiExtractedData.totalAmount):"-"})()),d.$$click=()=>le(s),d.style.setProperty("padding","0.25rem 0.5rem"),d.style.setProperty("border","none"),d.style.setProperty("background","transparent"),d.style.setProperty("color","var(--primary-color)"),d.style.setProperty("cursor","pointer"),d.style.setProperty("font-size","0.875rem"),e(d,()=>r("common.view","Ver")),R(o=>{var q=F,x=F,H={...F,"font-size":"0.875rem",color:"var(--text-muted)"},V=F,B=ee[s.processingStatus].bg,O=ee[s.processingStatus].color,U={...F,"font-weight":"500"},ae=F;return o.e=c(E,q,o.e),o.t=c(g,x,o.t),o.a=c(u,H,o.a),o.o=c(m,V,o.o),B!==o.i&&((o.i=B)!=null?b.style.setProperty("background",B):b.style.removeProperty("background")),O!==o.n&&((o.n=O)!=null?b.style.setProperty("color",O):b.style.removeProperty("color")),o.s=c(L,U,o.s),o.h=c(z,ae,o.h),o},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),j})()})),R(s=>{var j=Pe,E=M,J=M,C=M,T=M,g=M,u={...M,width:"100px"};return s.e=c(P,j,s.e),s.t=c(p,E,s.t),s.a=c(_,J,s.a),s.o=c(S,C,s.o),s.i=c(I,T,s.i),s.n=c(N,g,s.n),s.s=c(A,u,s.s),s},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),t}}),null),e(n,v(Le,{get isOpen(){return!!ne()},onClose:()=>le(null),get title(){return ne()?.fileName||""},size:"large",get children(){return v(k,{get when(){return ne()},children:t=>(()=>{var P=We(),y=P.firstChild,f=y.firstChild,p=f.firstChild,_=p.nextSibling,S=_.firstChild,I=S.firstChild,N=I.nextSibling,A=S.nextSibling,a=A.firstChild,s=a.nextSibling,j=A.nextSibling,E=j.firstChild,J=E.nextSibling,C=J.firstChild,T=y.nextSibling;return y.style.setProperty("display","grid"),y.style.setProperty("grid-template-columns","1fr 1fr"),y.style.setProperty("gap","1.5rem"),y.style.setProperty("margin-bottom","1.5rem"),p.style.setProperty("font-weight","600"),p.style.setProperty("margin-bottom","1rem"),e(p,()=>r("accounting.documentInfo","InformaciÃ³n del Documento")),_.style.setProperty("display","flex"),_.style.setProperty("flex-direction","column"),_.style.setProperty("gap","0.5rem"),I.style.setProperty("color","var(--text-muted)"),I.style.setProperty("font-size","0.75rem"),e(I,()=>r("accounting.type","Tipo")),e(N,()=>t().documentType||r("accounting.unknown","Desconocido")),a.style.setProperty("color","var(--text-muted)"),a.style.setProperty("font-size","0.75rem"),e(a,()=>r("accounting.uploadDate","Fecha de subida")),e(s,()=>he(t().createdAt)),E.style.setProperty("color","var(--text-muted)"),E.style.setProperty("font-size","0.75rem"),e(E,()=>r("accounting.status","Estado")),C.style.setProperty("padding","0.25rem 0.75rem"),C.style.setProperty("border-radius","9999px"),C.style.setProperty("font-size","0.75rem"),C.style.setProperty("font-weight","500"),e(C,()=>me[t().processingStatus]),e(y,v(k,{get when(){return t().aiExtractedData},get children(){var g=Re(),u=g.firstChild,m=u.nextSibling,b=m.firstChild,L=b.firstChild,z=L.nextSibling;return u.style.setProperty("font-weight","600"),u.style.setProperty("margin-bottom","1rem"),e(u,()=>r("accounting.extractedData","Datos ExtraÃ­dos por AI")),m.style.setProperty("display","flex"),m.style.setProperty("flex-direction","column"),m.style.setProperty("gap","0.5rem"),e(m,v(k,{get when(){return t().aiExtractedData?.vendor},get children(){var d=ye(),o=d.firstChild,q=o.nextSibling;return o.style.setProperty("color","var(--text-muted)"),o.style.setProperty("font-size","0.75rem"),e(o,()=>r("accounting.vendor","Proveedor")),e(q,()=>t().aiExtractedData.vendor),d}}),b),e(m,v(k,{get when(){return t().aiExtractedData?.date},get children(){var d=ye(),o=d.firstChild,q=o.nextSibling;return o.style.setProperty("color","var(--text-muted)"),o.style.setProperty("font-size","0.75rem"),e(o,()=>r("accounting.documentDate","Fecha del documento")),e(q,()=>t().aiExtractedData.date),d}}),b),L.style.setProperty("color","var(--text-muted)"),L.style.setProperty("font-size","0.75rem"),e(L,()=>r("accounting.totalAmount","Monto Total")),z.style.setProperty("font-size","1.25rem"),z.style.setProperty("font-weight","600"),z.style.setProperty("color","var(--primary-color)"),e(z,()=>K(t().aiExtractedData.totalAmount)),e(m,v(k,{get when(){return t().aiExtractedData?.taxAmount},get children(){var d=ye(),o=d.firstChild,q=o.nextSibling;return o.style.setProperty("color","var(--text-muted)"),o.style.setProperty("font-size","0.75rem"),e(o,()=>r("accounting.taxAmount","Impuestos")),e(q,()=>K(t().aiExtractedData.taxAmount)),d}}),null),g}}),null),e(P,v(k,{get when(){return Y(()=>!!t().aiExtractedData?.lineItems)()&&t().aiExtractedData.lineItems.length>0},get children(){var g=Ve(),u=g.firstChild,m=u.nextSibling,b=m.firstChild,L=b.firstChild,z=L.firstChild,d=z.nextSibling,o=d.nextSibling,q=b.nextSibling;return g.style.setProperty("margin-bottom","1.5rem"),u.style.setProperty("font-weight","600"),u.style.setProperty("margin-bottom","1rem"),e(u,()=>r("accounting.lineItems","LÃ­neas del Documento")),e(z,()=>r("accounting.description","DescripciÃ³n")),e(d,()=>r("accounting.quantity","Cantidad")),e(o,()=>r("accounting.amount","Monto")),e(q,v(ce,{get each(){return t().aiExtractedData.lineItems},children:x=>(()=>{var H=He(),V=H.firstChild,B=V.nextSibling,O=B.nextSibling;return e(V,()=>x.description),e(B,()=>x.quantity||1),e(O,()=>K(x.amount)),R(U=>{var ae=F,ze={...F,"text-align":"center"},ke={...F,"text-align":"right"};return U.e=c(V,ae,U.e),U.t=c(B,ze,U.t),U.a=c(O,ke,U.a),U},{e:void 0,t:void 0,a:void 0}),H})()})),R(x=>{var H=Pe,V=M,B={...M,"text-align":"center"},O={...M,"text-align":"right"};return x.e=c(m,H,x.e),x.t=c(z,V,x.t),x.a=c(d,B,x.a),x.o=c(o,O,x.o),x},{e:void 0,t:void 0,a:void 0,o:void 0}),g}}),T),T.style.setProperty("display","flex"),T.style.setProperty("justify-content","flex-end"),T.style.setProperty("gap","0.75rem"),e(T,v(de,{variant:"secondary",onClick:()=>le(null),get children(){return r("common.close","Cerrar")}}),null),e(T,v(k,{get when(){return t().processingStatus==="completed"},get children(){return v(de,{variant:"primary",get children(){return r("accounting.createEntry","Crear Asiento")}})}}),null),R(g=>{var u=ee[t().processingStatus].bg,m=ee[t().processingStatus].color;return u!==g.e&&((g.e=u)!=null?C.style.setProperty("background",u):C.style.removeProperty("background")),m!==g.t&&((g.t=m)!=null?C.style.setProperty("color",m):C.style.removeProperty("color")),g},{e:void 0,t:void 0}),P})()})}}),null),R(t=>{var P=`2px dashed ${pe()?"var(--primary-color)":"var(--border-color)"}`,y=pe()?"var(--primary-color)10":"var(--surface-color)";return P!==t.e&&((t.e=P)!=null?l.style.setProperty("border",P):l.style.removeProperty("border")),y!==t.t&&((t.t=y)!=null?l.style.setProperty("background",y):l.style.removeProperty("background")),t},{e:void 0,t:void 0}),R(()=>G.value=ie()),n})()};Me(["click"]);export{Xe as default};
