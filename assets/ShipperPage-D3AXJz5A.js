import{g as C,P as $e,O,u as Se,c as E,o as we,f as Ce,t as P,i as r,a as s,r as v,I as A,B as z,v as ie,b as ue,S as pe,F as _e,j as B,x as Ie,M as Ee}from"./index-QeIR2Yzv.js";class Ne{async createShipper(p){try{const o=C.state.user;if(!o)throw new Error("User not authenticated");const y=Date.now(),u={id:$e(),name:p.name,companyName:p.companyName,address:p.address,contact:p.contact,taxId:p.taxId,licenseNumber:p.licenseNumber,insuranceInfo:p.insuranceInfo,notes:p.notes,isActive:p.isActive??!0,createdBy:o.uid,createdAt:y.toString(),updatedAt:y.toString(),businessId:C.getBusinessId()},_={query:"addShipper",params:{businessId:C.getBusinessId()},form:u};return console.log("Creating shipper:",_),(await O(_))?.shipper||u}catch(o){throw console.error("Error creating shipper:",o),new Error(`Failed to create shipper: ${o instanceof Error?o.message:"Unknown error"}`)}}async getShippers(p){try{if(!C.state.user)throw new Error("User not authenticated");let y={};p&&p.trim()&&p.split(" ").map((_,N)=>{_&&(y[`:search${N}`]=_.trim())});const u={query:"getShipperYabaExpress",params:y,queryString:p?"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND user = guia":""};return console.log("Fetching shippers:",u),(await O(u))?.data||[]}catch(o){throw console.error("Error fetching shippers:",o),new Error(`Failed to fetch shippers: ${o instanceof Error?o.message:"Unknown error"}`)}}async getShipperById(p){try{if(!C.state.user)throw new Error("User not authenticated");const u={query:"getShipperById",params:{businessId:C.getBusinessId(),id:p}};return console.log("Fetching shipper by id:",u),(await O(u))?.shipper||null}catch(o){throw console.error("Error fetching shipper:",o),new Error(`Failed to fetch shipper: ${o instanceof Error?o.message:"Unknown error"}`)}}async updateShipper(p,o){try{const y=C.state.user;if(!y)throw new Error("User not authenticated");const u=Date.now(),b={...o,updatedAt:u.toString(),updatedBy:y.uid},N={query:"updateShipper",params:{businessId:C.getBusinessId(),id:p},form:b};return console.log("Updating shipper:",N),(await O(N))?.shipper||{...b,id:p}}catch(y){throw console.error("Error updating shipper:",y),new Error(`Failed to update shipper: ${y instanceof Error?y.message:"Unknown error"}`)}}async deleteShipper(p){try{if(!C.state.user)throw new Error("User not authenticated");const u={query:"deleteShipper",params:{businessId:C.getBusinessId(),id:p}};console.log("Deleting shipper:",u);const b=await O(u);if(b?.error)throw new Error(b.error)}catch(o){throw console.error("Error deleting shipper:",o),new Error(`Failed to delete shipper: ${o instanceof Error?o.message:"Unknown error"}`)}}async toggleShipperStatus(p,o){return this.updateShipper(p,{isActive:o})}}const G=new Ne;var ke=P("<div><strong></strong> "),Ae=P("<div><p>Cargando..."),ze=P("<div>"),Ue=P("<div><h3>Información Básica</h3><div>"),De=P("<div><h3>Dirección</h3><div>"),Fe=P("<div><h3>Información de Contacto</h3><div>"),Be=P("<div><h3></h3><div>"),Me=P("<div><h3>Información Adicional"),Le=P("<div><h2></h2><div>"),qe=P("<div><div><h1></h1><p></p></div><div><div>"),Re=P("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th>Estado</th><th>Acciones</th></tr></thead><tbody>"),je=P("<div><p>"),Oe=P("<tr><td></td><td></td><td></td><td></td><td>, </td><td><span></span></td><td><div>");const Ge=()=>{const{t:e}=Se(),[p,o]=E([]),[y,u]=E(!1),[b,_]=E(""),[N,T]=E(!1),[M,K]=E(null),[m,V]=E({name:"",companyName:"",address:{street:"",city:"",state:"",zipCode:"",country:""},contact:{phone:"",email:"",fax:""},taxId:"",licenseNumber:"",insuranceInfo:{provider:"",policyNumber:"",expirationDate:""},notes:"",isActive:!0}),[L,W]=E({}),[U,S]=E(null),ye=["Estados Unidos","Cuba","México","Canadá","España","Francia","Alemania","Reino Unido","Italia","China","Japón","Brasil"];we(()=>{q()});const de=Ce(()=>b()?p().filter(t=>t.name.toLowerCase().includes(b().toLowerCase())||t.companyName?.toLowerCase().includes(b().toLowerCase())||t.contact.email.toLowerCase().includes(b().toLowerCase())||t.licenseNumber?.toLowerCase().includes(b().toLowerCase())):p()),q=async()=>{try{u(!0),S(null);const t=await G.getShippers();o(t)}catch(t){console.error("Error loading shippers:",t),S({type:"error",text:e("shipper.messages.loadError")})}finally{u(!1)}},ge=()=>{const t=m(),h={};return t.name.trim()||(h.name=e("shipper.validation.nameRequired")),t.address.street.trim()||(h.street=e("shipper.validation.streetRequired")),t.address.city.trim()||(h.city=e("shipper.validation.cityRequired")),t.address.country.trim()||(h.country=e("shipper.validation.countryRequired")),t.contact.email&&!/\S+@\S+\.\S+/.test(t.contact.email)&&(h.email=e("shipper.validation.emailInvalid")),W(h),Object.keys(h).length===0},me=async()=>{if(ge())try{u(!0),S(null),M()?(await G.updateShipper(M().id,m()),S({type:"success",text:e("shipper.messages.updateSuccess")})):(await G.createShipper(m()),S({type:"success",text:e("shipper.messages.createSuccess")})),await q(),X()}catch(t){console.error("Error saving shipper:",t),S({type:"error",text:M()?e("shipper.messages.updateError"):e("shipper.messages.createError")})}finally{u(!1)}},he=t=>{K(t),V({name:t.name,companyName:t.companyName||"",address:t.address,contact:t.contact,taxId:t.taxId||"",licenseNumber:t.licenseNumber||"",insuranceInfo:t.insuranceInfo||{provider:"",policyNumber:"",expirationDate:""},notes:t.notes||"",isActive:t.isActive}),T(!0)},fe=async t=>{if(confirm(e("shipper.deleteConfirm")))try{u(!0),await G.deleteShipper(t.id),S({type:"success",text:e("shipper.messages.deleteSuccess")}),await q()}catch(h){console.error("Error deleting shipper:",h),S({type:"error",text:e("shipper.messages.deleteError")})}finally{u(!1)}},ve=async t=>{try{u(!0),await G.toggleShipperStatus(t.id,!t.isActive),S({type:"success",text:e("shipper.messages.statusChanged")}),await q()}catch(h){console.error("Error changing shipper status:",h),S({type:"error",text:e("shipper.messages.updateError")})}finally{u(!1)}},be=()=>{K(null),V({name:"",companyName:"",address:{street:"",city:"",state:"",zipCode:"",country:""},contact:{phone:"",email:"",fax:""},taxId:"",licenseNumber:"",insuranceInfo:{provider:"",policyNumber:"",expirationDate:""},notes:"",isActive:!0}),W({}),T(!0)},X=()=>{T(!1),K(null),W({})},f=(t,h)=>{V(k=>{const D={...k};let x=D;for(let w=0;w<t.length-1;w++)x=x[t[w]]={...x[t[w]]};return x[t[t.length-1]]=h,D})};return(()=>{var t=qe(),h=t.firstChild,k=h.firstChild,D=k.nextSibling,x=h.nextSibling,w=x.firstChild;return t.style.setProperty("padding","2rem"),t.style.setProperty("max-width","1200px"),t.style.setProperty("margin","0 auto"),h.style.setProperty("margin-bottom","2rem"),h.style.setProperty("text-align","center"),k.style.setProperty("font-size","2rem"),k.style.setProperty("font-weight","700"),k.style.setProperty("color","var(--text-primary)"),r(k,()=>e("shipper.pageTitle")),D.style.setProperty("color","var(--text-muted)"),D.style.setProperty("font-size","1.125rem"),r(D,()=>e("shipper.pageSubtitle")),x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),x.style.setProperty("margin-bottom","2rem"),x.style.setProperty("gap","1rem"),x.style.setProperty("flex-wrap","wrap"),w.style.setProperty("display","flex"),w.style.setProperty("gap","1rem"),w.style.setProperty("align-items","center"),r(w,s(v,{placeholder:"Buscar transportistas...",get value(){return b()},onChange:_,style:{"min-width":"300px"}}),null),r(w,s(z,{onClick:q,get disabled(){return y()},get children(){return[s(A,{name:"search",size:"1em",style:{"margin-right":"0.5rem"}}),"Buscar"]}}),null),r(x,s(z,{onClick:be,variant:"primary",get disabled(){return y()},get children(){return[s(A,{name:"add",size:"1em",style:{"margin-right":"0.5rem"}}),ie(()=>e("shipper.createNew"))]}}),null),r(t,s(pe,{get when(){return U()},get children(){var d=ke(),c=d.firstChild;return c.nextSibling,d.style.setProperty("padding","1rem"),d.style.setProperty("margin-bottom","1rem"),d.style.setProperty("border-radius","var(--border-radius)"),r(c,()=>U().type==="success"?"✓ Éxito:":"⚠ Error:"),r(d,()=>U().text,null),ue(i=>{var l=U().type==="success"?"var(--success-light)":"var(--error-light)",g=U().type==="success"?"var(--success-dark)":"var(--error-dark)",n=`1px solid ${U().type==="success"?"var(--success-color)":"var(--error-color)"}`;return l!==i.e&&((i.e=l)!=null?d.style.setProperty("background",l):d.style.removeProperty("background")),g!==i.t&&((i.t=g)!=null?d.style.setProperty("color",g):d.style.removeProperty("color")),n!==i.a&&((i.a=n)!=null?d.style.setProperty("border",n):d.style.removeProperty("border")),i},{e:void 0,t:void 0,a:void 0}),d}}),null),r(t,s(B,{get children(){var d=ze();return d.style.setProperty("padding","1.5rem"),r(d,s(pe,{get when(){return y()},get fallback(){return s(pe,{get when(){return de().length>0},get fallback(){return(()=>{var c=je(),i=c.firstChild;return c.style.setProperty("text-align","center"),c.style.setProperty("padding","2rem"),c.style.setProperty("color","var(--text-muted)"),r(c,s(A,{name:"shipping",size:"3rem",style:{opacity:"0.3","margin-bottom":"1rem"}}),i),r(i,()=>e("shipper.messages.noRecords")),c})()},get children(){var c=Re(),i=c.firstChild,l=i.firstChild,g=l.firstChild,n=g.firstChild,a=n.nextSibling,J=a.nextSibling,Q=J.nextSibling,Y=Q.nextSibling,Z=Y.nextSibling,ce=Z.nextSibling,Pe=l.nextSibling;return c.style.setProperty("overflow-x","auto"),i.style.setProperty("width","100%"),i.style.setProperty("border-collapse","collapse"),g.style.setProperty("border-bottom","2px solid var(--border-color)"),n.style.setProperty("padding","1rem"),n.style.setProperty("text-align","left"),r(n,()=>e("shipper.fields.name")),a.style.setProperty("padding","1rem"),a.style.setProperty("text-align","left"),r(a,()=>e("shipper.fields.companyName")),J.style.setProperty("padding","1rem"),J.style.setProperty("text-align","left"),r(J,()=>e("shipper.fields.licenseNumber")),Q.style.setProperty("padding","1rem"),Q.style.setProperty("text-align","left"),r(Q,()=>e("shipper.fields.email")),Y.style.setProperty("padding","1rem"),Y.style.setProperty("text-align","left"),r(Y,()=>e("shipper.fields.city")),Z.style.setProperty("padding","1rem"),Z.style.setProperty("text-align","center"),ce.style.setProperty("padding","1rem"),ce.style.setProperty("text-align","center"),r(Pe,s(_e,{get each(){return de()},children:$=>(()=>{var ee=Oe(),re=ee.firstChild,te=re.nextSibling,se=te.nextSibling,ne=se.nextSibling,R=ne.nextSibling,xe=R.firstChild,H=R.nextSibling,I=H.firstChild,ae=H.nextSibling,F=ae.firstChild;return ee.style.setProperty("border-bottom","1px solid var(--border-light)"),re.style.setProperty("padding","1rem"),r(re,()=>$.name),te.style.setProperty("padding","1rem"),r(te,()=>$.companyName||"-"),se.style.setProperty("padding","1rem"),r(se,()=>$.licenseNumber||"-"),ne.style.setProperty("padding","1rem"),r(ne,()=>$.contact.email||"-"),R.style.setProperty("padding","1rem"),r(R,()=>$.address.city,xe),r(R,()=>$.address.country,null),H.style.setProperty("padding","1rem"),H.style.setProperty("text-align","center"),I.style.setProperty("padding","0.25rem 0.5rem"),I.style.setProperty("border-radius","4px"),I.style.setProperty("font-size","0.875rem"),r(I,()=>$.isActive?"Activo":"Inactivo"),ae.style.setProperty("padding","1rem"),ae.style.setProperty("text-align","center"),F.style.setProperty("display","flex"),F.style.setProperty("gap","0.5rem"),F.style.setProperty("justify-content","center"),r(F,s(z,{size:"sm",variant:"secondary",onClick:()=>he($),get children(){return s(A,{name:"edit",size:"0.875rem"})}}),null),r(F,s(z,{size:"sm",variant:"secondary",onClick:()=>ve($),get children(){return s(A,{get name(){return $.isActive?"close":"check"},size:"0.875rem"})}}),null),r(F,s(z,{size:"sm",variant:"secondary",onClick:()=>fe($),style:{color:"var(--error-color)"},get children(){return s(A,{name:"delete",size:"0.875rem"})}}),null),ue(j=>{var le=$.isActive?"var(--success-light)":"var(--error-light)",oe=$.isActive?"var(--success-dark)":"var(--error-dark)";return le!==j.e&&((j.e=le)!=null?I.style.setProperty("background",le):I.style.removeProperty("background")),oe!==j.t&&((j.t=oe)!=null?I.style.setProperty("color",oe):I.style.removeProperty("color")),j},{e:void 0,t:void 0}),ee})()})),c}})},get children(){var c=Ae(),i=c.firstChild;return c.style.setProperty("text-align","center"),c.style.setProperty("padding","2rem"),r(c,s(A,{name:"loading",size:"2rem"}),i),c}})),d}}),null),r(t,s(Ee,{get isOpen(){return N()},onClose:X,size:"large",get children(){var d=Le(),c=d.firstChild,i=c.nextSibling;return d.style.setProperty("padding","2rem"),c.style.setProperty("margin-bottom","1.5rem"),r(c,(()=>{var l=ie(()=>!!M());return()=>l()?e("shipper.editShipper"):e("shipper.createNew")})()),r(d,s(B,{style:{"margin-bottom":"1.5rem"},get children(){var l=Ue(),g=l.firstChild,n=g.nextSibling;return l.style.setProperty("padding","1.5rem"),g.style.setProperty("margin-bottom","1rem"),n.style.setProperty("display","grid"),n.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(300px, 1fr))"),n.style.setProperty("gap","1rem"),r(n,s(v,{get label(){return`${e("shipper.fields.name")} *`},get value(){return m().name},onChange:a=>f(["name"],a),get placeholder(){return e("shipper.placeholders.name")},get error(){return L().name}}),null),r(n,s(v,{get label(){return e("shipper.fields.companyName")},get value(){return m().companyName||""},onChange:a=>f(["companyName"],a),get placeholder(){return e("shipper.placeholders.companyName")}}),null),r(n,s(v,{get label(){return e("shipper.fields.taxId")},get value(){return m().taxId||""},onChange:a=>f(["taxId"],a),get placeholder(){return e("shipper.placeholders.taxId")}}),null),r(n,s(v,{get label(){return e("shipper.fields.licenseNumber")},get value(){return m().licenseNumber||""},onChange:a=>f(["licenseNumber"],a),get placeholder(){return e("shipper.placeholders.licenseNumber")}}),null),l}}),i),r(d,s(B,{style:{"margin-bottom":"1.5rem"},get children(){var l=De(),g=l.firstChild,n=g.nextSibling;return l.style.setProperty("padding","1.5rem"),g.style.setProperty("margin-bottom","1rem"),n.style.setProperty("display","grid"),n.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(300px, 1fr))"),n.style.setProperty("gap","1rem"),r(n,s(v,{get label(){return`${e("shipper.fields.street")} *`},get value(){return m().address.street},onChange:a=>f(["address","street"],a),get placeholder(){return e("shipper.placeholders.street")},get error(){return L().street}}),null),r(n,s(v,{get label(){return`${e("shipper.fields.city")} *`},get value(){return m().address.city},onChange:a=>f(["address","city"],a),get placeholder(){return e("shipper.placeholders.city")},get error(){return L().city}}),null),r(n,s(v,{get label(){return e("shipper.fields.state")},get value(){return m().address.state},onChange:a=>f(["address","state"],a),get placeholder(){return e("shipper.placeholders.state")}}),null),r(n,s(v,{get label(){return e("shipper.fields.zipCode")},get value(){return m().address.zipCode},onChange:a=>f(["address","zipCode"],a),get placeholder(){return e("shipper.placeholders.zipCode")}}),null),r(n,s(Ie,{get label(){return`${e("shipper.fields.country")} *`},get value(){return m().address.country},onChange:a=>f(["address","country"],a),get options(){return ye.map(a=>({value:a,label:a}))},get error(){return L().country}}),null),l}}),i),r(d,s(B,{style:{"margin-bottom":"1.5rem"},get children(){var l=Fe(),g=l.firstChild,n=g.nextSibling;return l.style.setProperty("padding","1.5rem"),g.style.setProperty("margin-bottom","1rem"),n.style.setProperty("display","grid"),n.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(300px, 1fr))"),n.style.setProperty("gap","1rem"),r(n,s(v,{get label(){return e("shipper.fields.phone")},get value(){return m().contact.phone},onChange:a=>f(["contact","phone"],a),get placeholder(){return e("shipper.placeholders.phone")}}),null),r(n,s(v,{get label(){return e("shipper.fields.email")},type:"email",get value(){return m().contact.email},onChange:a=>f(["contact","email"],a),get placeholder(){return e("shipper.placeholders.email")},get error(){return L().email}}),null),r(n,s(v,{get label(){return e("shipper.fields.fax")},get value(){return m().contact.fax||""},onChange:a=>f(["contact","fax"],a),get placeholder(){return e("shipper.placeholders.fax")}}),null),l}}),i),r(d,s(B,{style:{"margin-bottom":"1.5rem"},get children(){var l=Be(),g=l.firstChild,n=g.nextSibling;return l.style.setProperty("padding","1.5rem"),g.style.setProperty("margin-bottom","1rem"),r(g,()=>e("shipper.fields.insuranceInfo")),n.style.setProperty("display","grid"),n.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(300px, 1fr))"),n.style.setProperty("gap","1rem"),r(n,s(v,{get label(){return e("shipper.fields.insuranceProvider")},get value(){return m().insuranceInfo?.provider||""},onChange:a=>f(["insuranceInfo","provider"],a),get placeholder(){return e("shipper.placeholders.insuranceProvider")}}),null),r(n,s(v,{get label(){return e("shipper.fields.policyNumber")},get value(){return m().insuranceInfo?.policyNumber||""},onChange:a=>f(["insuranceInfo","policyNumber"],a),get placeholder(){return e("shipper.placeholders.policyNumber")}}),null),r(n,s(v,{get label(){return e("shipper.fields.expirationDate")},type:"date",get value(){return m().insuranceInfo?.expirationDate||""},onChange:a=>f(["insuranceInfo","expirationDate"],a)}),null),l}}),i),r(d,s(B,{style:{"margin-bottom":"1.5rem"},get children(){var l=Me(),g=l.firstChild;return l.style.setProperty("padding","1.5rem"),g.style.setProperty("margin-bottom","1rem"),r(l,s(v,{get label(){return e("shipper.fields.notes")},get value(){return m().notes||""},onChange:n=>f(["notes"],n),get placeholder(){return e("shipper.placeholders.notes")},multiline:!0,rows:3}),null),l}}),i),i.style.setProperty("display","flex"),i.style.setProperty("gap","1rem"),i.style.setProperty("justify-content","flex-end"),r(i,s(z,{variant:"outline",onClick:X,get disabled(){return y()},children:"Cancelar"}),null),r(i,s(z,{variant:"primary",onClick:me,get disabled(){return y()},get children(){return ie(()=>!!y())()?"Guardando...":M()?"Actualizar":"Crear"}}),null),d}}),null),t})()};var Te=P("<div>");const Qe=()=>(()=>{var e=Te();return e.style.setProperty("min-height","100vh"),e.style.setProperty("background","var(--background-secondary)"),e.style.setProperty("padding","1rem 0"),r(e,s(Ge,{})),e})();export{Qe as default};
